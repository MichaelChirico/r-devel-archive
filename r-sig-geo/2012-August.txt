From ferda.e.gulel at gmail.com  Wed Aug  1 05:00:21 2012
From: ferda.e.gulel at gmail.com (=?ISO-8859-1?Q?Ferda_Esin_G=FClel?=)
Date: Tue, 31 Jul 2012 23:00:21 -0400
Subject: [R-sig-Geo] Error in solve.default(BB)
Message-ID: <CAEdf4qSOZP53EhFe+NPn28xokRcrcNNCXY8998+7DFiFkONfWw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120731/f16b5b58/attachment.pl>

From timo_schmid at hotmail.com  Wed Aug  1 11:13:07 2012
From: timo_schmid at hotmail.com (Timo Schmid)
Date: Wed, 1 Aug 2012 11:13:07 +0200
Subject: [R-sig-Geo] Linear mixed model with correlated random effects in R
Message-ID: <DUB115-W47DF53A6DBE88459E92D5397C40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120801/034c752f/attachment.pl>

From lars.bux at gmail.com  Wed Aug  1 11:20:01 2012
From: lars.bux at gmail.com (lars mewes)
Date: Wed, 1 Aug 2012 11:20:01 +0200
Subject: [R-sig-Geo] consider spatial autocorrelation in negative binomial
 regression using spatial eigenvector mapping
Message-ID: <CABjJxSAXe-LHbX11_iN8Oso_4y66=S4nB1jDQnmNr0Upe_FjnA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120801/c0eac6f7/attachment.pl>

From Thierry.ONKELINX at inbo.be  Wed Aug  1 13:44:32 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 1 Aug 2012 11:44:32 +0000
Subject: [R-sig-Geo] Linear mixed model with correlated random effects
 in R
In-Reply-To: <DUB115-W47DF53A6DBE88459E92D5397C40@phx.gbl>
References: <DUB115-W47DF53A6DBE88459E92D5397C40@phx.gbl>
Message-ID: <AA818EAD2576BC488B4F623941DA74275E390397@inbomail.inbo.be>

Dear Timo,

Have a look at the INLA package (http://www.r-inla.org/)

The correlation structures in nlme work only on the residuals, not on the random effects.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] Namens Timo Schmid
Verzonden: woensdag 1 augustus 2012 11:13
Aan: r-sig-geo at r-project.org
Onderwerp: [R-sig-Geo] Linear mixed model with correlated random effects in R


Hey,



I want to estimate a spatial linear mixed model y=X\beta+Zv+e with e\sim N(0,4) and v\sim N(0,G).

G is a covariance matrix of a simultaneously autoregressive model (SAR) and is given by

G=\sigma_v^2((I-pW)(I-pW^T))^{-1} where p is a spatial correlation parameter and W is a matrix which describes the neighbourhood structure between the random effects v.



I have already seen some R-code when the SAR model is included in the error term without area effects. This could be done with the errorsarlm-function in the spdep package. I am looking for a "sarlme" function or something similar to model between-group correlation.

Has anybody an idea?



I have also tried to incorporate the SAR model using the lme function. Here is a short example:



The first code is for a linear mixed model without spatial correlation of the random effects v. v\sim N(0,1).



library (nlme)

library(mnormt)

library(spdep)

set.seed(10)

nclusters=12 #Number of area effects

areasize=20  #Number of units in each area

test.x <- runif(areasize*nclusters) #Covariates

test.e <- rnorm(areasize*nclusters) #Error term

ClusterID <- sort(sample(rep(1:nclusters,areasize)))

v <- numeric(nclusters)

for(i in 1:nclusters){v[((i-1)*areasize+1):(areasize+(i-1)*areasize)] <- rep(rnorm(1, 0, 1), areasize)}

test.y <- 100+2*test.x+v+test.e

test.fit <- lme(test.y~test.x,random = ~1 | ClusterID) #Fitting the model



The second code should be for a linear mixed model with spatial correlation in the random effects v. v\sim N(0,G). Therefore we have to generate the matrix G.




library (nlme)

library(mnormt)

library(spdep)

set.seed(10)

nclusters=12 #Number of area effects

areasize=20  #Number of units in each area

test.x <- runif(areasize*nclusters) #Covariates

test.e <- rnorm(areasize*nclusters) #Error term

ClusterID <- sort(sample(rep(1:nclusters,areasize)))



# Generation of the neighbourhood matrix W

nb_structure <- cell2nb(3,4,type="rook")

xyccc <- attr(nb_structure, "region.id")

xycc <- matrix(as.integer(unlist(strsplit(xyccc, ":"))), ncol=2,
byrow=TRUE)

plot(nb_structure, xycc)

W_list<-nb2listw(nb_structure)

W <- nb2mat(nb_structure, glist=NULL, style="W") # Spatial Matrix W



spatial_p<-0.6 #spatial correlation parameter

G<-diag(1,nclusters)%*%solve((diag(1,nclusters)-diag(spatial_p,nclusters)%*%W)%*%(diag(1,nclusters)-diag(spatial_p,nclusters)%*%t(W)))


v1<-rmnorm(1, mean=rep(0,nclusters ), G)

v2<-v1/(sd(v1[1:nclusters]))*1

v<-rep(v2,each=areasize)

test.y <- 100+2*test.x+v+test.e



Now the problem is the estimation. I have tried the lme and I wanted to specify the correlation structure in the following way

test.fit <- lme(test.y~test.x,random = ~1 | ClusterID, correlation=G)

The point is that the correlation structure is not correct specfied with the the matrix G. I know the matrix G must be a corStruct object, but I do not know how to generate a SAR model as a corStruct object. In the corClasses there is no SAR-model available.

How can I incorporate the matrix G directly into the formula?



Thank you very much for your help.
        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From jason.lesley.robinson at gmail.com  Wed Aug  1 15:39:05 2012
From: jason.lesley.robinson at gmail.com (Jason Robinson)
Date: Wed, 1 Aug 2012 08:39:05 -0500
Subject: [R-sig-Geo] measuring map similarity?
Message-ID: <CAGiTQXFKt5+tGpgE69sbKpZKyELZ3k5rzi=r3hmGjBJwczWjDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120801/9ec06623/attachment.pl>

From Rafael.Lata.fl at ait.ac.at  Wed Aug  1 16:04:22 2012
From: Rafael.Lata.fl at ait.ac.at (Lata Rafael)
Date: Wed, 1 Aug 2012 16:04:22 +0200
Subject: [R-sig-Geo] consider spatial autocorrelation in negative
 binomial regression using spatial eigenvector mapping
In-Reply-To: <CABjJxSAXe-LHbX11_iN8Oso_4y66=S4nB1jDQnmNr0Upe_FjnA@mail.gmail.com>
References: <CABjJxSAXe-LHbX11_iN8Oso_4y66=S4nB1jDQnmNr0Upe_FjnA@mail.gmail.com>
Message-ID: <03DD2D3DC948ED4795830164EA3F302ED8700E1FD7@MAILBOX.arc.local>

Hello Lars,

Concerning your question on how to test for spatial autocorrelation in negative binomial models you should have look on the paper of Lin and Zahng (2007) that provide some log-linear test for residuals of a loglinear model under the asymptotic normality assumption, such as for instance the Poisson family and therefore also Negative Binomial. There is no function in R but can relatively easily be computed (It has also been applied in Scherngell and Lata 2012)

References:
Schergell and Lata 2012 http://onlinelibrary.wiley.com/doi/10.1111/j.1435-5957.2012.00419.x/abstract

Lin and Zhang 2007 http://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.2007.00705.x/abstract

Rafael

-----Urspr?ngliche Nachricht-----
Von: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von lars mewes
Gesendet: Mittwoch, 01. August 2012 11:20
An: r-sig-geo at r-project.org
Betreff: [R-sig-Geo] consider spatial autocorrelation in negative binomial regression using spatial eigenvector mapping

Dear list,


 I am working on my bachelor thesis in economic geography. For that reason, I'm relatively new to spatial statistics. I hope I can clearly point out, where my problem seems to be.


 I try to examine whether public funding has a significant impact on regional patenting activity or not. In this context, I'm using a cross sectional data set out of 150 German labor market regions, which contains patent counts, values of the public subsidies and some other control variables for each of the regions. Since the values of the dependent variable are counts and there exists over-dispersion, I first used glm.nb {pscl} to run a negative binomial regression.


 To generate more robust results, I want to consider the spatial effects within the data. As far as I know, doesn't exist any appropriate way to test for spatial autocorrelation (SAC) in generalized linear models, regarding the following post:


 <
http://r-sig-geo.2731867.n2.nabble.com/how-to-find-observed-Moran-s-I-value-using-moran-test-spdep-td5203212.html>



 But to check whether there is little evidence of SAC, I used lm.morantest {spdep} with a simple inverse distance calculation:


 > spamr<-readOGR(.) #reading in the *.shp file to calculate the inverse distance matrix.

> coords <- coordinates(spamr)

> spamr_knn<-knn2nb(knearneigh(coords))

> all.linked<-max(unlist(nbdists(spamr_knn,coords)))

> spamr_dn<-dnearneigh(coords,0,all.linked)

> idlist<-nbdists(spamr_dn,coords)

> idlist<-lapply(idlist,function(x) 1/x)

> idlistw<-nb2listw(spamr_dn,glist=idlist)

> nb_mach<-glm.nb(pat_mach~bmbf_mach+publ_mach+rand_mach+den+wo)

> lm.morantest(nb_mach,idlistw)



To see the results:



Global Moran's I for regression residuals



data:

model: glm.nb(formula = pat_mach ~ bmbf_mach + publ_mach + rand_mach +

den + wo, init.theta = 2.338390767, link = log)

weights: idlistw



Moran I statistic standard deviate = 2.6353, p-value = 0.004203

alternative hypothesis: greater

sample estimates:

Observed Moran's I        Expectation           Variance

       0.138220997       -0.008031996        0.003079876



To implement a spatial regression for generalized linear models, I read the article of Dorman et al. (2007) and found the spatial eigenvector mapping very interesting. For that reason I want to use the ME ( ) function {spdep} to account for the spatial effects. But  ME ( ) does not fit for negative binomial regression and the option family="binomial" only can use values of the dependent variable between 0 and 1.


 I also took notice of the following post (
http://r-sig-geo.2731867.n2.nabble.com/ME-function-for-negative-binomial-td7278253.html)
but I really don't understand it.


 So after a long discussion, my questions to the list are:


 (1) Does there exist an appropriate way to consider SAC in negative binomial models within the ME () function?


 (2) Is there another, maybe more appropriate method to consider SAC in negative binomial models?


 Any help is very appreciated. Thank you very much!


 Cheers,

Lars.

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Wed Aug  1 16:11:19 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 1 Aug 2012 15:11:19 +0100
Subject: [R-sig-Geo] measuring map similarity?
In-Reply-To: <acd390a576204e6a8a00250aa2b3c0ea@EX-1-HT0.lancs.local>
References: <acd390a576204e6a8a00250aa2b3c0ea@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNfV54LggB5ue3fciWvhmg=GvOnvX-yjnxfx6AB-Rd6pA@mail.gmail.com>

On Wed, Aug 1, 2012 at 2:39 PM, Jason Robinson
<jason.lesley.robinson at gmail.com> wrote:
> Hoping someone might be able to steer me in the right direction, not sure
> where to look
>
> I have several different modeling methods to predict patterns of species
> occurrences over the same geographic area.  I'd like to compare the shape
> and position of the predicted areas between maps, in reference to a "true
> distribution" map.  Since I have irregular polygons instead of raster cells
> this gets a little hairy for me to think about coding.
>
> I thought that epidemiologists might have some experience with this
> problem.

 Sounds like you could just use the polygon overlay methods in the
rgeos package. Should be trivial to overlay your estimates, A, on your
truth, B, and get three parts - A on its own, B on its own, and the
overlap of A and B.

 gIntersection and gDifference are probably all you need...

Barry


From shishir.mathur at sjsu.edu  Wed Aug  1 18:19:48 2012
From: shishir.mathur at sjsu.edu (Shishir Mathur)
Date: Wed, 1 Aug 2012 09:19:48 -0700
Subject: [R-sig-Geo] Help with running spatial lag model
Message-ID: <CAN3n5XzunwoF8cv9FUe56RzZT0xdt5ykiEjkPwiOJDvQcfpwaA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120801/84b0ed22/attachment.pl>

From torsten-marx at gmx.de  Wed Aug  1 20:19:32 2012
From: torsten-marx at gmx.de (Torsten Marx)
Date: Wed, 1 Aug 2012 20:19:32 +0200
Subject: [R-sig-Geo] =?iso-8859-1?q?grepl=28=29_Eingabezeichenkette_2_ung?=
	=?iso-8859-1?q?=FCltig_in_dieser_locale?=
Message-ID: <000f01cd7012$36503200$a2f09600$@de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120801/e278ae51/attachment.pl>

From Roger.Bivand at nhh.no  Wed Aug  1 22:18:43 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 1 Aug 2012 22:18:43 +0200 (CEST)
Subject: [R-sig-Geo] Help with running spatial lag model
In-Reply-To: <CAN3n5XzunwoF8cv9FUe56RzZT0xdt5ykiEjkPwiOJDvQcfpwaA@mail.gmail.com>
References: <CAN3n5XzunwoF8cv9FUe56RzZT0xdt5ykiEjkPwiOJDvQcfpwaA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208012215080.27645@reclus.nhh.no>

On Wed, 1 Aug 2012, Shishir Mathur wrote:

> Hello All:
>
>
>
> I am working on parcel-level housing dataset to estimate the impact of
> various variables on home sale prices (N is approx. 90,000).
>
> I created the spatial weight metrics using sale year of four nearest houses
> to assign weights.  Next, I ran LM tests and the spatial lag and error
> models using spdep package.
>
> I get the following error message when I try to run spatial lag or error
> models using the method "eigen".
> Error in matrix(0, nrow = n, ncol = n) : too many elements specified
>
> The code is:
>> fecurrentcombinedlag <-lagsarlm(fecurrentcombined, data = spssall,
> lw_test2.csv, na.action=na.fail, type="lag", method="eigen", quiet=TRUE,
> zero.policy=FALSE, interval = c(-1, 0.999), tol.solve=1.0e-20)
>
>
>
> Since the dataset is large, I replaced "eigen" with "LU" or "MC".  However,
> I get the following error:
>
>
>
> Error in validObject(.Object) :
>  invalid class "dgRMatrix" object: slot j is not increasing inside a
> column

You are importing the k-nearest neighbour weights into R. Please do not do 
that. For some purposes it appears to work, but almost certainly the 
sparse representation is not in the order required by functions in the 
Matrix package. Generate the same weights using knn2nb(knearneigh()) in 
spdep, or in Matlab or (open)GeoDa and import them from those versions.

Roger

>
> The traceback results are:
>
> 10: stop(msg, " ", errors, domain = NA)
> 9: validObject(.Object)
> 8: initialize(value, ...)
> 7: initialize(value, ...)
> 6: new("dgRMatrix", j = z[[1]], p = p0, Dim = as.integer(c(n, n)),
>       x = z[[2]])
> 5: as_dgRMatrix_listw(get("listw", envir = env))
> 4: .class1(object)
> 3: as(as_dgRMatrix_listw(get("listw", envir = env)), "CsparseMatrix")
> 2: LU_setup(env)
> 1: lagsarlm(fecurrentcombined, data = spssall, listw = lw_test2.csv,
> na.action = na.fail, type = "lag", method = "LU", quiet = TRUE,
> zero.policy = FALSE, interval = c(-1, 0.999), tol.solve = 1e-20)
>
> The code for creating listw, and the listw summary are as follows:
>
>
>
> test2.csv <- read.csv("C:/TIFArticle/KC Exisiting Housing/EHspwt.csv")
>
> class(test2.csv) <- c("spatial.neighbour", class(test2.csv))
>
> of <- ordered(test2.csv$OID)
>
> attr(test2.csv, "region.id") <- levels(of)
>
> test2.csv$OID <- as.integer(of)
>
> test2.csv$NID <- as.integer(ordered(test2.csv$NID))
>
> attr(test2.csv, "n") <- length(unique(test2.csv$OID))
>
>
>
> lw_test2.csv <- sn2listw(test2.csv)
>
> lw_test2.csv$style <- "W"
>
> lw_test2.csv
>
>
>
>
>
> Characteristics of weights list object:
>
> Neighbour list object:
>
> Number of regions: 87223
>
> Number of nonzero links: 348892
>
> Percentage nonzero weights: 0.004585946
>
> Average number of links: 4
>
> Non-symmetric neighbours list
>
>
>
> Weights style: W
>
> Weights constants summary:
>
>      n         nn    S0       S1       S2
>
> W 87223 7607851729 87223 27790.89 368025.1
>
>
>
>
> Million thanks in advance for your help.
> Shishm
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From smithtiffanyt at gmail.com  Thu Aug  2 00:24:09 2012
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Wed, 1 Aug 2012 18:24:09 -0400
Subject: [R-sig-Geo] Mann-Kendall test on raster data
Message-ID: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>

Hello,

I'm trying to do a Mann-Kendall test on my RasterBrick data. So far, I've been able to complete the Mann-Kendall test (via the "Kendall" package) by extracting a series like so:

onelocation<-rev(extract(myraster,SpatialPoints(cbind(-86,33))))
onelocation.mk<-MannKendall(onelocation)

I need help either figuring out a way to do the MK test with raster data, or if I loop through all points and use the above commands, how can I return that data into a Raster so I can visualize the results by making maps?

Thanks,
Tiffany

From riaarinda at gmail.com  Thu Aug  2 03:53:36 2012
From: riaarinda at gmail.com (ria arinda)
Date: Wed, 1 Aug 2012 18:53:36 -0700 (PDT)
Subject: [R-sig-Geo] what is geary.intern() in code geary() ?
Message-ID: <1343872416818-7580662.post@n2.nabble.com>

I just looked code geary function in R and see there is geary.intern() inside
the function code. I wonder what it is used for. Could anybody explain to
me?
Thanks



-----
Ria Arinda
Jakarta Institute of Statistics, Indonesia
Tel:  +62 856 1675312
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/what-is-geary-intern-in-code-geary-tp7580662.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rjadenham at gmail.com  Thu Aug  2 04:12:36 2012
From: rjadenham at gmail.com (robert denham)
Date: Thu, 2 Aug 2012 12:12:36 +1000
Subject: [R-sig-Geo] Trouble building rgeos 0.2-7 on R-2.15.1 under Suse
	Linux 64bit
In-Reply-To: <CAHMvJdSauf7XLwK23Gexbq_u0aKA_GXp+_qBzikHQo8HidXbCA@mail.gmail.com>
References: <CAHMvJdSauf7XLwK23Gexbq_u0aKA_GXp+_qBzikHQo8HidXbCA@mail.gmail.com>
Message-ID: <CAHMvJdT5hrvO94B_NH3vmjehjZz1xz8OMT2kibNWJfbEfYUxJQ@mail.gmail.com>

Dear R Users,

sorry if this is a repost, I couldn't determine if my original message
made it to the list or not.

I'm having trouble building rgeos from source under linux. I have
R-2.15.1, and rgeos 0.2-7, it appears to build ok, but fails the final
install check:


** testing if installed package can be loaded Error in dyn.load(file,
DLLpath = DLLpath, ...) :
  unable to load shared object
'/export/home/denhamrj/tmp/rgeos.Rcheck/rgeos/libs/rgeos.so':
  /export/home/denhamrj/tmp/rgeos.Rcheck/rgeos/libs/rgeos.so:
undefined symbol: GEOSUnaryUnion_r
Error: loading failed
Execution halted


I tried with geos 3.3.2, but upgraded to 3.3.5 to see if that was the
problem, but I got the same error. I've searched for other similar
problems but haven't encountered anything. We do have multiple
versions of geos on our system, but they should be installed in such a
way that they don't conflict, but it has been suggested that this
could be the problem. I'd appreciate help in diagnosing and correcting
this.

I've included a little more detail below:

denhamrj at athena2 ~/tmp
$ R CMD check rgeos_0.2-7.tar.gz
* using log directory #/export/home/denhamrj/tmp/rgeos.Rcheck#
* using R version 2.15.1 (2012-06-22)
* using platform: x86_64-unknown-linux-gnu (64-bit)
* using session charset: UTF-8
* checking for file #rgeos/DESCRIPTION# ... OK
* this is package #rgeos# version #0.2-7#
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking whether package #rgeos# can be installed ... ERROR
Installation failed.
See #/export/home/denhamrj/tmp/rgeos.Rcheck/00install.out# for details.

00install.out contents:

* installing *source* package ???rgeos??? ...
** package ???rgeos??? successfully unpacked and MD5 sums checked
checking geos-config usability... yes
configure: geos-config: geos-config
configure: GEOS version: 3.3.5
checking geos version over 3.2.1... yes
checking geos-config clibs... yes
checking for gcc... gcc -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ANSI C... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking geos_c.h usability... yes
checking geos_c.h presence... yes
checking for geos_c.h... yes
checking for initGEOS_r in -lgeos_c... yes
configure: PKG_CPPFLAGS:  -I/opt/sw/fw/rsc/geos/3.3.5/include
configure: PKG_LIBS:  -L/opt/sw/fw/rsc/geos/3.3.5/lib -lgeos
-L/opt/sw/fw/rsc/geos/3.3.5/lib -lgeos_c
configure: creating ./config.status
config.status: creating src/Makevars
** libs
g++ -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
dummy.cc -o dummy.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c init.c
-o init.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
local_stubs.c -o local_stubs.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c rgeos.c
-o rgeos.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_R2geos.c -o rgeos_R2geos.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_R2geosMP.c -o rgeos_R2geosMP.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_bbox.c -o rgeos_bbox.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_buffer.c -o rgeos_buffer.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_coord.c -o rgeos_coord.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_geos2R.c -o rgeos_geos2R.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_misc.c -o rgeos_misc.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_poly2nb.c -o rgeos_poly2nb.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_predicate_binary.c -o rgeos_predicate_binary.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_predicate_unary.c -o rgeos_predicate_unary.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_topology.c -o rgeos_topology.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_topology_binary.c -o rgeos_topology_binary.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_validate.c -o rgeos_validate.o
gcc -std=gnu99 -I/opt/sw/fw/rsc/R/2.15.1/lib64/R/include -DNDEBUG
-I/opt/sw/fw/rsc/geos/3.3.5/include
-I/opt/sw/fw/rsc/readline/readline-6.2/include
-I/opt/sw/fw/rsc/tcl/tcl-8.5.11/include
-I/opt/sw/fw/rsc/libjpeg/jpeg-8d/include
-I/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/include
-I"/opt/sw/fw/rsc/R/library/v2/sp/include"   -fpic  -g -O2  -c
rgeos_wkt.c -o rgeos_wkt.o
g++ -shared -L/opt/sw/fw/rsc/readline/readline-6.2/lib
g++ -L/opt/sw/fw/rsc/tcl/tcl-8.5.11/lib
g++ -L/opt/sw/fw/rsc/libjpeg/jpeg-8d/lib
g++ -L/opt/sw/fw/rsc/libtiff/libtiff-4.0.1/lib -o rgeos.so dummy.o
g++ init.o local_stubs.o rgeos.o rgeos_R2geos.o rgeos_R2geosMP.o
g++ rgeos_bbox.o rgeos_buffer.o rgeos_coord.o rgeos_geos2R.o
g++ rgeos_misc.o rgeos_poly2nb.o rgeos_predicate_binary.o
g++ rgeos_predicate_unary.o rgeos_topology.o rgeos_topology_binary.o
g++ rgeos_validate.o rgeos_wkt.o -L/opt/sw/fw/rsc/geos/3.3.5/lib -lgeos
g++ -L/opt/sw/fw/rsc/geos/3.3.5/lib -lgeos_c
g++ -L/opt/sw/fw/rsc/R/2.15.1/lib64/R/lib -lR
installing to /export/home/denhamrj/tmp/rgeos.Rcheck/rgeos/libs
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded Error in dyn.load(file,
DLLpath = DLLpath, ...) :
  unable to load shared object
'/export/home/denhamrj/tmp/rgeos.Rcheck/rgeos/libs/rgeos.so':
  /export/home/denhamrj/tmp/rgeos.Rcheck/rgeos/libs/rgeos.so:
undefined symbol: GEOSUnaryUnion_r
Error: loading failed
Execution halted
ERROR: loading failed
* removing ???/export/home/denhamrj/tmp/rgeos.Rcheck/rgeos???


ldd of rgeos.so produces:
    libgeos-3.3.5.so => /opt/sw/fw/rsc/geos/3.3.5/lib/libgeos-3.3.5.so
(0x00002aaaaacc3000)
    libgeos_c.so.1 => /opt/sw/fw/rsc/geos/3.3.5/lib/libgeos_c.so.1
(0x00002aaaab05e000)
    libR.so => not found
    libstdc++.so.6 => /opt/sw/fw/rsc/gcc/4.4.2/lib64/libstdc++.so.6
(0x00002aaaab2a4000)
    libm.so.6 => /lib64/libm.so.6 (0x00002aaaab5b0000)
    libgcc_s.so.1 => /opt/sw/fw/rsc/gcc/4.4.2/lib64/libgcc_s.so.1
(0x00002aaaab705000)
    libc.so.6 => /lib64/libc.so.6 (0x00002aaaab91b000)
    /lib64/ld-linux-x86-64.so.2 (0x0000555555554000)


I checked my LD_LIBRARY_PATH, the only reference to geos is
/opt/sw/fw/rsc/geos/3.3.5/lib. Similarly, my PATH variable has
/opt/sw/fw/rsc/geos/3.3.5/bin as the only geos entry.



Robert Denham
Environmental Statistician, Remote Sensing Centre Phone 07 3170 5676 (ext 26676)
Email: robert.denham at derm.qld.gov.au


From tom.gottfried at o2mail.de  Thu Aug  2 05:50:04 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Thu, 02 Aug 2012 05:50:04 +0200
Subject: [R-sig-Geo]
 =?iso-8859-1?q?grepl=28=29_Eingabezeichenkette_2_ung?=
 =?iso-8859-1?q?=FCltig_in_dieser_locale?=
In-Reply-To: <000f01cd7012$36503200$a2f09600$@de>
References: <000f01cd7012$36503200$a2f09600$@de>
Message-ID: <5019F8EC.5030401@o2mail.de>

Torsten,

Am 01.08.2012 20:19, schrieb Torsten Marx:
> Hello,
>
>
>
> I'm using the german version of R under Ubuntu. I have a script that works
> fine under Win7 but under Ubuntu I get the following error Message:
>
>
>
> In grepl("\n", lines, fixed = TRUE) :
>
>    Eingabezeichenkette 2 ung?ltig in dieser locale

please add the output of sessionInfo() and Sys.getlocale() from both 
systems.

> It looks to me that the output of the Script is the same as under Windows
> but I'm not sure.

Try to reproduce the error with a small and reproducible example which 
should probably take only a subset of your object "lines".
By the way, I wonder how the output of your script can be the same when 
it stops with an error under Ubuntu!

> Can anyone tell what to do?

Read this for details on how to make it easier for other people to 
answer this question:

http://www.r-project.org/posting-guide.html

HTH,
Tom

>
>
>
> Regards
>
> Torsten Marx
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tony333_6 at hotmail.com  Thu Aug  2 16:12:42 2012
From: tony333_6 at hotmail.com (tony333)
Date: Thu, 2 Aug 2012 07:12:42 -0700 (PDT)
Subject: [R-sig-Geo] PCA Regression
Message-ID: <1343916762026-7580665.post@n2.nabble.com>

http://r-sig-geo.2731867.n2.nabble.com/file/n7580665/pc.dat pc.dat 
http://r-sig-geo.2731867.n2.nabble.com/file/n7580665/precip.dat precip.dat 
I use PCA regression to make seasonal forecast for precipitation using PCA
of SST. 
I have 30 month of SST monthly mean data.I use the whole data (30 month) to
produce PCA .The dimension of PCA is 30*1. 
the data is attached with the e_mail.
For example i use :-
data.train=1:15 # the first 15 scores of PCs as train data 

xy.lm =  lm(Y~pc1[data.train]+pc2[data.train]+pc5[data.train] )
where Y = the predictand (precipitation) 


f =
predict(xy.lm,list(pc1[data.train]=pc1[data.train],pc2[data.train]=pc2[data.train],pc5[data.train]=pc5[data.train]))



and use the rest 15 score to verified the prediction
data.verif=16:30
ff <-
coef(xy.lm)[1]+(coef(xy.lm)[2])*pc1[data.verif]+(coef(xy.lm)[3])*pc2[data.verif]+(coef(xy.lm)[4])*pc5[data.verif]

is that the right way to predict and verified this prediction 

or i have to produce PCA for 15 month to train data and use the rest 15
month to produce another  PCA to verified the prediction .






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/PCA-Regression-tp7580665.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From smithtiffanyt at gmail.com  Thu Aug  2 20:26:28 2012
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Thu, 2 Aug 2012 14:26:28 -0400
Subject: [R-sig-Geo] Mann-Kendall test on raster data
In-Reply-To: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>
References: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>
Message-ID: <A0918AC7-D030-410B-AD0A-9ABE2E2CDD43@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120802/e572d36c/attachment.pl>

From akselkolsen at gmail.com  Thu Aug  2 22:13:18 2012
From: akselkolsen at gmail.com (Aksel Olsen)
Date: Thu, 02 Aug 2012 13:13:18 -0700
Subject: [R-sig-Geo] merge, coordinates, sort order
Message-ID: <501ADF5E.3000509@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120802/2a789ca5/attachment.pl>

From Roger.Bivand at nhh.no  Thu Aug  2 23:48:34 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 2 Aug 2012 23:48:34 +0200 (CEST)
Subject: [R-sig-Geo] what is geary.intern() in code geary() ?
In-Reply-To: <1343872416818-7580662.post@n2.nabble.com>
References: <1343872416818-7580662.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1208022340260.31092@reclus.nhh.no>

On Thu, 2 Aug 2012, ria arinda wrote:

> I just looked code geary function in R and see there is geary.intern() inside
> the function code. I wonder what it is used for. Could anybody explain to
> me?

It calls compiled code - the source is in spdep/pkg/src/gearyw.c which you 
can see on R-Forge https://r-forge.r-project.org/, SCM tab -> browse 
source. If you look in the oldest version of spdep/pkg/R/geary.R, you'll 
see the R version of what the C code does - the C code runs faster.

Roger

> Thanks
>
>
>
> -----
> Ria Arinda
> Jakarta Institute of Statistics, Indonesia
> Tel:  +62 856 1675312
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/what-is-geary-intern-in-code-geary-tp7580662.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From thi_veloso at yahoo.com.br  Fri Aug  3 03:37:46 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 2 Aug 2012 18:37:46 -0700 (PDT)
Subject: [R-sig-Geo] Mann-Kendall test on raster data
In-Reply-To: <A0918AC7-D030-410B-AD0A-9ABE2E2CDD43@gmail.com>
References: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>
	<A0918AC7-D030-410B-AD0A-9ABE2E2CDD43@gmail.com>
Message-ID: <1343957866.14821.YahooMailNeo@web121903.mail.ne1.yahoo.com>

? Tiffany,

? You can use raster's "rasterfromXYZ" function.

? And it's not necessary to write out and read in the file, unless it's convenient to you.

? Hph,
? Thiago.


----- Original Message -----
From: Tiffany Smith <smithtiffanyt at gmail.com>
To: r-sig-geo at r-project.org
Cc: 
Sent: Thursday, August 2, 2012 3:26 PM
Subject: Re: [R-sig-Geo] Mann-Kendall test on raster data

An update, I have been able to automate the MannKendall test and capture the output into a .txt file:

lat<-seq(-125,-67,0.5)
lon<-seq(25,53,0.5)

fun.mk<-function(x){
??? for (i in 1:length(lat)){
??? ??? for (j in 1:length(lon)){
??? ??? ??? v<-rev(extract(x,SpatialPoints(cbind(lat[i],lon[j]))))
??? ??? ??? mk<-MannKendall(v)
??? ??? ??? pv<-mk$sl
??? ??? ??? out<-data.frame(cbind(lat[i],lon[j],pv[1]))
??? ??? ??? write.table(out,"myraster.mk.txt",append=TRUE,col.names=FALSE,row.names=FALSE,quote=FALSE)
??? ??? ??? }}}
myraster.mk<-fun.mk(myraster)

Now, I would like to read that file back into R as a RasterLayer. So far, I can read it in as a table to get:

myraster.table<-read.table("myraster.mk.txt",header=FALSE) 
myraster.table
? ? ? ? V1? ?  V2? ? ? ? ? V3
1? -86.000 35.000 0.071539655
2? -86.000 35.125 0.004216323
3? -86.000 35.250 0.449751556
4? -86.000 35.375 0.124644011
5? -86.000 35.500 0.128179774
?

In the Raster package, there is "as.data.frame" to go from raster->data.frame but I can't find anything to go in the opposite direction, data.frame->raster. I tried using "as.raster", but that didn't work:

myraster.raster<-as.raster(myraster.table)
Error in UseMethod("as.raster") : 
? no applicable method for 'as.raster' applied to an object of class "data.frame"

Thanks,
Tiffany
On Aug 1, 2012, at 6:24 PM, Tiffany Smith wrote:

> Hello,
> 
> I'm trying to do a Mann-Kendall test on my RasterBrick data. So far, I've been able to complete the Mann-Kendall test (via the "Kendall" package) by extracting a series like so:
> 
> onelocation<-rev(extract(myraster,SpatialPoints(cbind(-86,33))))
> onelocation.mk<-MannKendall(onelocation)
> 
> I need help either figuring out a way to do the MK test with raster data, or if I loop through all points and use the above commands, how can I return that data into a Raster so I can visualize the results by making maps?
> 
> Thanks,
> Tiffany


??? [[alternative HTML version deleted]]


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From tom.gottfried at o2mail.de  Fri Aug  3 05:22:51 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Fri, 03 Aug 2012 05:22:51 +0200
Subject: [R-sig-Geo] merge, coordinates, sort order
In-Reply-To: <501ADF5E.3000509@gmail.com>
References: <501ADF5E.3000509@gmail.com>
Message-ID: <501B440B.4050503@o2mail.de>

Please try to provide a reproducible example. The object 
'correspondence' you use in merge() is unknown (at least to me). Further 
there are some syntax errors in your code that shouldn't have permitted 
you running it.

regards,
Tom

Am 02.08.2012 22:13, schrieb Aksel Olsen:
> Hi,
>
> I am having trouble mapping and labeling with ggplot, including having
> the issue is that merge() didn't work as planned for me, seemingly
> joining by the row id or FID instead of the provided key. But here I am
> trying to extract coordinates from the spatial data frame and plot them
> with a data value from another table, relating based on the FID key.
>
> Here is the essence of what I have:
>
> *load shapefile*
> geography_sp1<- readShapeSpatial(qual_shp_file)
> row.names(as(geography_sp1, "data.frame))
>
> *change ids to primary key
> *geography_sp1<- spChFIDs(geography_sp1,
> as.character(geography_sp1#superdistr))
> *
> **Extracting coordinates--my problem here is that I am not sure that the
> columns in the data frame are properly aligned--can I get FIDS out or
> other identifier when calling the coordinates function?
> * coords<-data.frame(coordinates(geography_sp1),
> row.names(sapply(slot(geography_sp1, "polygons"), function(x) slot (x,
> "ID"))
>
> *Getting the actual order of records:
>
> *coords$sort_id<- as.integer(row.names(coords))
>
> *and then, to add attributes from the correspondence table
>
> *coords<- merge(x=coords, y=correspondence, by.x="sort_id",
> by.y="superdistr", all.x=T)
>
> As noted,
> Best,
> Aksel
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rafael.wueest at wsl.ch  Fri Aug  3 09:46:07 2012
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Fri, 3 Aug 2012 09:46:07 +0200
Subject: [R-sig-Geo] Mann-Kendall test on raster data
In-Reply-To: <1343957866.14821.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>
	<A0918AC7-D030-410B-AD0A-9ABE2E2CDD43@gmail.com>
	<1343957866.14821.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <B57D1510-42A7-4195-9AB3-2B5D82B5AD33@wsl.ch>

Hi Tiffany,

If I got your initial question right, you want to apply the MannKendall test to the whole raster. If so, you may use the calc() command.

Something like

myraster.mk <- calc(myraster,function(x){MannKendall(rev(x))$sl})

may give you what you need.

HTH, Rafi

On 03.08.2012, at 03:37, Thiago Veloso wrote:

>   Tiffany,
> 
>   You can use raster's "rasterfromXYZ" function.
> 
>   And it's not necessary to write out and read in the file, unless it's convenient to you.
> 
>   Hph,
>   Thiago.
> 
> 
> ----- Original Message -----
> From: Tiffany Smith <smithtiffanyt at gmail.com>
> To: r-sig-geo at r-project.org
> Cc: 
> Sent: Thursday, August 2, 2012 3:26 PM
> Subject: Re: [R-sig-Geo] Mann-Kendall test on raster data
> 
> An update, I have been able to automate the MannKendall test and capture the output into a .txt file:
> 
> lat<-seq(-125,-67,0.5)
> lon<-seq(25,53,0.5)
> 
> fun.mk<-function(x){
>     for (i in 1:length(lat)){
>         for (j in 1:length(lon)){
>             v<-rev(extract(x,SpatialPoints(cbind(lat[i],lon[j]))))
>             mk<-MannKendall(v)
>             pv<-mk$sl
>             out<-data.frame(cbind(lat[i],lon[j],pv[1]))
>             write.table(out,"myraster.mk.txt",append=TRUE,col.names=FALSE,row.names=FALSE,quote=FALSE)
>             }}}
> myraster.mk<-fun.mk(myraster)
> 
> Now, I would like to read that file back into R as a RasterLayer. So far, I can read it in as a table to get:
> 
> myraster.table<-read.table("myraster.mk.txt",header=FALSE) 
> myraster.table
>         V1     V2          V3
> 1  -86.000 35.000 0.071539655
> 2  -86.000 35.125 0.004216323
> 3  -86.000 35.250 0.449751556
> 4  -86.000 35.375 0.124644011
> 5  -86.000 35.500 0.128179774
> ?
> 
> In the Raster package, there is "as.data.frame" to go from raster->data.frame but I can't find anything to go in the opposite direction, data.frame->raster. I tried using "as.raster", but that didn't work:
> 
> myraster.raster<-as.raster(myraster.table)
> Error in UseMethod("as.raster") : 
>   no applicable method for 'as.raster' applied to an object of class "data.frame"
> 
> Thanks,
> Tiffany
> On Aug 1, 2012, at 6:24 PM, Tiffany Smith wrote:
> 
>> Hello,
>> 
>> I'm trying to do a Mann-Kendall test on my RasterBrick data. So far, I've been able to complete the Mann-Kendall test (via the "Kendall" package) by extracting a series like so:
>> 
>> onelocation<-rev(extract(myraster,SpatialPoints(cbind(-86,33))))
>> onelocation.mk<-MannKendall(onelocation)
>> 
>> I need help either figuring out a way to do the MK test with raster data, or if I loop through all points and use the above commands, how can I return that data into a Raster so I can visualize the results by making maps?
>> 
>> Thanks,
>> Tiffany
> 
> 
>     [[alternative HTML version deleted]]
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From valentina.chiarello at gmail.com  Fri Aug  3 16:16:37 2012
From: valentina.chiarello at gmail.com (valentina chiarello)
Date: Fri, 3 Aug 2012 16:16:37 +0200
Subject: [R-sig-Geo] request of help about netprop function
Message-ID: <CAG8pdqkozYRAufJPB-CwQm27yU5nWmaYQjswiLX4Gcvo0roBxQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120803/ddb0982b/attachment.pl>

From smithtiffanyt at gmail.com  Fri Aug  3 16:58:11 2012
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Fri, 3 Aug 2012 10:58:11 -0400
Subject: [R-sig-Geo] Mann-Kendall test on raster data
In-Reply-To: <B57D1510-42A7-4195-9AB3-2B5D82B5AD33@wsl.ch>
References: <CB9E6AF1-B952-4985-9AFE-3CFE12234AB5@gmail.com>
	<A0918AC7-D030-410B-AD0A-9ABE2E2CDD43@gmail.com>
	<1343957866.14821.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<B57D1510-42A7-4195-9AB3-2B5D82B5AD33@wsl.ch>
Message-ID: <63C12598-B1BA-4C16-98DB-A112D2404091@gmail.com>

Rafi,

This is exactly what I needed, thanks so much! Obviously I was over thinking this one?

Best,
Tiffany
On Aug 3, 2012, at 3:46 AM, Rafael W?est wrote:

> Hi Tiffany,
> 
> If I got your initial question right, you want to apply the MannKendall test to the whole raster. If so, you may use the calc() command.
> 
> Something like
> 
> myraster.mk <- calc(myraster,function(x){MannKendall(rev(x))$sl})
> 
> may give you what you need.
> 
> HTH, Rafi
> 
> On 03.08.2012, at 03:37, Thiago Veloso wrote:
> 
>>  Tiffany,
>> 
>>  You can use raster's "rasterfromXYZ" function.
>> 
>>  And it's not necessary to write out and read in the file, unless it's convenient to you.
>> 
>>  Hph,
>>  Thiago.
>> 
>> 
>> ----- Original Message -----
>> From: Tiffany Smith <smithtiffanyt at gmail.com>
>> To: r-sig-geo at r-project.org
>> Cc: 
>> Sent: Thursday, August 2, 2012 3:26 PM
>> Subject: Re: [R-sig-Geo] Mann-Kendall test on raster data
>> 
>> An update, I have been able to automate the MannKendall test and capture the output into a .txt file:
>> 
>> lat<-seq(-125,-67,0.5)
>> lon<-seq(25,53,0.5)
>> 
>> fun.mk<-function(x){
>>    for (i in 1:length(lat)){
>>        for (j in 1:length(lon)){
>>            v<-rev(extract(x,SpatialPoints(cbind(lat[i],lon[j]))))
>>            mk<-MannKendall(v)
>>            pv<-mk$sl
>>            out<-data.frame(cbind(lat[i],lon[j],pv[1]))
>>            write.table(out,"myraster.mk.txt",append=TRUE,col.names=FALSE,row.names=FALSE,quote=FALSE)
>>            }}}
>> myraster.mk<-fun.mk(myraster)
>> 
>> Now, I would like to read that file back into R as a RasterLayer. So far, I can read it in as a table to get:
>> 
>> myraster.table<-read.table("myraster.mk.txt",header=FALSE) 
>> myraster.table
>>        V1     V2          V3
>> 1  -86.000 35.000 0.071539655
>> 2  -86.000 35.125 0.004216323
>> 3  -86.000 35.250 0.449751556
>> 4  -86.000 35.375 0.124644011
>> 5  -86.000 35.500 0.128179774
>> ?
>> 
>> In the Raster package, there is "as.data.frame" to go from raster->data.frame but I can't find anything to go in the opposite direction, data.frame->raster. I tried using "as.raster", but that didn't work:
>> 
>> myraster.raster<-as.raster(myraster.table)
>> Error in UseMethod("as.raster") : 
>>  no applicable method for 'as.raster' applied to an object of class "data.frame"
>> 
>> Thanks,
>> Tiffany
>> On Aug 1, 2012, at 6:24 PM, Tiffany Smith wrote:
>> 
>>> Hello,
>>> 
>>> I'm trying to do a Mann-Kendall test on my RasterBrick data. So far, I've been able to complete the Mann-Kendall test (via the "Kendall" package) by extracting a series like so:
>>> 
>>> onelocation<-rev(extract(myraster,SpatialPoints(cbind(-86,33))))
>>> onelocation.mk<-MannKendall(onelocation)
>>> 
>>> I need help either figuring out a way to do the MK test with raster data, or if I loop through all points and use the above commands, how can I return that data into a Raster so I can visualize the results by making maps?
>>> 
>>> Thanks,
>>> Tiffany
>> 
>> 
>>    [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> --
> Rafael W?est
> Swiss Federal Research Institute WSL
> Z?rcherstrasse 111
> 8903 Birmensdorf
> Switzerland
> 
> +41 44 7392126
> rafael.wueest at wsl.ch
> http://www.wsl.ch/info/mitarbeitende/wueest/index_EN
> 
> 
> 


From arnold_salvacion at yahoo.com  Fri Aug  3 18:41:17 2012
From: arnold_salvacion at yahoo.com (Arnold Salvacion)
Date: Sat, 4 Aug 2012 00:41:17 +0800 (SGT)
Subject: [R-sig-Geo] Zonal Statistics as Table
Message-ID: <1344012077.6904.YahooMailNeo@web190406.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120804/bb6baf6a/attachment.pl>

From afischbach at usgs.gov  Fri Aug  3 18:50:08 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Fri, 3 Aug 2012 09:50:08 -0700 (PDT)
Subject: [R-sig-Geo] adehabitatHR: combining estUD for kerneloverlaphr
Message-ID: <1344012608288-7580675.post@n2.nabble.com>

I wish to examine indices of home-range overlap of utitilzation distributions
generated by differing home-range estimating methods.

The *adehabitatHR* function *kerneloverlaphr* acts on an object of class
estUDm containing several home-ranges for which the overlap is to be
calculated.

Is there handy way to 'stack' several home-ranges calculated by various
methods into a single estUDm object such that the resulting estUDm object
may be handled by kerneloverlaphr?

Example code: 
require(adehabitatHR)

data(buffalo)  ## Example dataset used by Benhamou (2011)

## Example estUDm objects gererated as per the example provided in
adehabitatHR (v 0.4.2).
id <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
         hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
         grid = 200, extent=0.1)

rd <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
         hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
         grid = 200, extent=0.1)

ud <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50,
         hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
         grid = 200, extent=0.1)

x<-* 'Special stacking function'*(id, rd, ud)  ## Here is what I am wanting. 
Is it possible?
kerneloverlaphr(x, method='VI')



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-combining-estUD-for-kerneloverlaphr-tp7580675.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Fri Aug  3 19:35:09 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 3 Aug 2012 11:35:09 -0600
Subject: [R-sig-Geo] projectRaster changes the values of the new projected
	raster
Message-ID: <CABkCotShuuWXy_L8MoSPD4dMmef9tKE7pqTaiuHL3TCqPS+iLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120803/6bd6ce55/attachment.pl>

From r.hijmans at gmail.com  Sat Aug  4 00:32:46 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 3 Aug 2012 15:32:46 -0700
Subject: [R-sig-Geo] Raster Brick Iteration
In-Reply-To: <1343322204474-7580616.post@n2.nabble.com>
References: <1343322204474-7580616.post@n2.nabble.com>
Message-ID: <CANtt_hwhfmdo8uJRO814WE6pdysnxCECcC6XkcMSNKnGq=qc7A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120803/071b9213/attachment.pl>

From r.hijmans at gmail.com  Sat Aug  4 00:37:04 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 3 Aug 2012 15:37:04 -0700
Subject: [R-sig-Geo] Zonal Statistics as Table
In-Reply-To: <1344012077.6904.YahooMailNeo@web190406.mail.sg3.yahoo.com>
References: <1344012077.6904.YahooMailNeo@web190406.mail.sg3.yahoo.com>
Message-ID: <CANtt_hwdS+qoTxFOfkJ8f+datU2HomWt4HZg-7mVHr26SBu2yQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120803/8c96410f/attachment.pl>

From mmpearso at interchange.ubc.ca  Sun Aug  5 02:36:04 2012
From: mmpearso at interchange.ubc.ca (Monica Pearson)
Date: Sat, 4 Aug 2012 17:36:04 -0700
Subject: [R-sig-Geo] Eigenanalysis plot modification
Message-ID: <CAA9Tw=V4jeGycwkxLuMkTw7fZ3oH9JspvCX+7rOEoSS+bcHaQg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120804/d5822d45/attachment.pl>

From clement.calenge at oncfs.gouv.fr  Sun Aug  5 20:36:52 2012
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Sun, 5 Aug 2012 20:36:52 +0200
Subject: [R-sig-Geo] adehabitatHR: combining estUD for kerneloverlaphr
In-Reply-To: <1344012608288-7580675.post@n2.nabble.com>
References: <1344012608288-7580675.post@n2.nabble.com>
Message-ID: <501EBD44.6050403@oncfs.gouv.fr>

On 08/03/2012 06:50 PM, Anthony Fischbach wrote:
> I wish to examine indices of home-range overlap of utitilzation distributions
> generated by differing home-range estimating methods.
>
> The *adehabitatHR* function *kerneloverlaphr* acts on an object of class
> estUDm containing several home-ranges for which the overlap is to be
> calculated.
>
> Is there handy way to 'stack' several home-ranges calculated by various
> methods into a single estUDm object such that the resulting estUDm object
> may be handled by kerneloverlaphr?
>
> Example code:
> require(adehabitatHR)
>
> data(buffalo)  ## Example dataset used by Benhamou (2011)
>
> ## Example estUDm objects gererated as per the example provided in
> adehabitatHR (v 0.4.2).
> id<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> rd<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> ud<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50,
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> x<-* 'Special stacking function'*(id, rd, ud)  ## Here is what I am wanting.
> Is it possible?
> kerneloverlaphr(x, method='VI')

If you want to use kerneloverlaphr, you need to provide the same grid 
for all estimations.
Then, you can create a "fake" estUDm object. For example:

library(adehabitatHR)
data(buffalo)  ## Example dataset used by Benhamou (2011)

id <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = 200, extent=0.1)

## use the same grid for other estimations (grid=id):
rd <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = id, extent=0.1)

ud <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50,
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = id, extent=0.1)

## Convert to fake estUDm
tot <- list(id=id, rd=rd, ud=ud)
kerneloverlaphr(tot)

HTH,

Cl?ment Calenge
-- 

Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From clement.calenge at oncfs.gouv.fr  Sun Aug  5 20:41:56 2012
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Sun, 5 Aug 2012 20:41:56 +0200
Subject: [R-sig-Geo] adehabitatHR: combining estUD for kerneloverlaphr
In-Reply-To: <1344012608288-7580675.post@n2.nabble.com>
References: <1344012608288-7580675.post@n2.nabble.com>
Message-ID: <501EBE74.4060501@oncfs.gouv.fr>

Sorry, I omitted to define the class of tot (i.e. you should add
class(tot) <- "estUDm"
before the evaluation of kerneloverlaphr).
See the correct code below.
Best regards,

Cl?ment


On 08/03/2012 06:50 PM, Anthony Fischbach wrote:
> I wish to examine indices of home-range overlap of utitilzation distributions
> generated by differing home-range estimating methods.
>
> The *adehabitatHR* function *kerneloverlaphr* acts on an object of class
> estUDm containing several home-ranges for which the overlap is to be
> calculated.
>
> Is there handy way to 'stack' several home-ranges calculated by various
> methods into a single estUDm object such that the resulting estUDm object
> may be handled by kerneloverlaphr?
>
> Example code:
> require(adehabitatHR)
>
> data(buffalo)  ## Example dataset used by Benhamou (2011)
>
> ## Example estUDm objects gererated as per the example provided in
> adehabitatHR (v 0.4.2).
> id<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> rd<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> ud<- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50,
>           hmin=100, radius = 300, maxt = 2*3600, activity="act",
> filtershort=FALSE,
>           grid = 200, extent=0.1)
>
> x<-* 'Special stacking function'*(id, rd, ud)  ## Here is what I am wanting.
> Is it possible?
> kerneloverlaphr(x, method='VI')

If you want to use kerneloverlaphr, you need to provide the same grid 
for all estimations.
Then, you can create a "fake" estUDm object. For example:

library(adehabitatHR)
data(buffalo)  ## Example dataset used by Benhamou (2011)

id <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = 200, extent=0.1)

## use the same grid for other estimations (grid=id):
rd <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = id, extent=0.1)

ud <- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50,
          hmin=100, radius = 300, maxt = 2*3600, activity="act",
filtershort=FALSE,
          grid = id, extent=0.1)

## Convert to fake estUDm
tot <- list(id=id, rd=rd, ud=ud)
class(tot) <- "estUDm"
kerneloverlaphr(tot)

HTH,

Cl?ment Calenge
-- 

Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From samanmonfared1 at gmail.com  Mon Aug  6 13:15:02 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Mon, 6 Aug 2012 04:15:02 -0700
Subject: [R-sig-Geo] spatio-temporal kriging
Message-ID: <CAOytA4a4r0m-_-BVbGwqUNu-k_6r5FTUcv=S--hB0zTSbxMtPA@mail.gmail.com>

Dear all.
I try to perform spatio-temporal kriging.
I calculate empirical variogram in 9 spatial and 5 temporal lags.
I have fitted a non-seperable (Gneithing-model) spatio-temporal
covariance function as below:


h<-1:9
u<-1:5
B<-matrix(fit$variogramst,nrow=9,ncol=5)
f<-function(theta){
A<-matrix(1,length(h),length(u))
for(i in 1:length(h)){
for(j in 1:length(u)){
A[i,j]<-((theta[1]^2)/((1+theta[2]*abs(u[j])^(2*theta[3]))^(theta[4]*theta[5]/2))
*exp((-theta[6]*h[i]^(2*theta[7]))/((1+theta[2]*abs(u[j])^(2*theta[3]))^(theta[4]*theta[7]))))

}
}
z<-sum((A-B)%*%var(B)%*% t(A-B))
return(z)
}
theta1<-c(1,1,1,1,.5,.5,.5)
f(theta1)
ss<-optim(theta1,f,method ="L-BFGS-B",lower =c(0,0,0,0,0,0,0), upper
=c(Inf,Inf,1,1,Inf,Inf,1) )
theta<-ss$par
x<-h
y<-u
f1<-function(x,y){
sig<-(theta[1]^2)
r<-((theta[1]^2)/((1+theta[2]*abs(y)^(2*theta[3]))^(theta[4]*theta[5]/2))
*exp((-theta[6]*x^(2*theta[7]))/((1+theta[2]*abs(y)^(2*theta[3]))^(theta[4]*theta[7]))))
}
z<-outer(x,y,f1)
persp(x,y,z,theta=45,phi=45,nticks =10,,r = sqrt(16),d =2,expand=.5,
col = "lightblue",shade = 0.75,ltheta =20)

I have some problems:
1.How can I make a spatio-temporal grid for prediction in new space
time locations?
2.How can I perform krigimg methods?
indeed I don't know how calculate weight and covariance matrix for prediction.

thanks for your help.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From afischbach at usgs.gov  Mon Aug  6 19:08:18 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Mon, 6 Aug 2012 10:08:18 -0700 (PDT)
Subject: [R-sig-Geo] adehabitatHR: combining estUD for kerneloverlaphr
In-Reply-To: <501EBE74.4060501@oncfs.gouv.fr>
References: <1344012608288-7580675.post@n2.nabble.com>
	<501EBE74.4060501@oncfs.gouv.fr>
Message-ID: <1344272898864-7580683.post@n2.nabble.com>

Perfect!  
Clement, your conversion to a 'fake' estUDm makes it convenient to compare
kernel overlap indicies 
of UD's genereated by varous methods, provided they are generated on the
same analysis grid.
This was a great help.  Best Regards, -Tony



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-combining-estUD-for-kerneloverlaphr-tp7580675p7580683.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From julian at hafro.is  Tue Aug  7 09:29:35 2012
From: julian at hafro.is (Julian Burgos)
Date: Tue, 07 Aug 2012 07:29:35 +0000
Subject: [R-sig-Geo] measuring map similarity?
In-Reply-To: <CAGiTQXFKt5+tGpgE69sbKpZKyELZ3k5rzi=r3hmGjBJwczWjDg@mail.gmail.com>
References: <CAGiTQXFKt5+tGpgE69sbKpZKyELZ3k5rzi=r3hmGjBJwczWjDg@mail.gmail.com>
Message-ID: <5020C3DF.4010705@hafro.is>

Hi Jason,
One option is simply to rasterize the polygons (using the package 
"raster").  If your polygons have complex shapes, be sure to use a high 
resolution in the rasters.  Then you can compare them using the Syrjala 
(1996) test.  There is a function to perform it on the "ecespa" package.

Julian

On mi? 1.?g? 2012 13:39, Jason Robinson wrote:
> Hoping someone might be able to steer me in the right direction, not sure
> where to look
>
> I have several different modeling methods to predict patterns of species
> occurrences over the same geographic area.  I'd like to compare the shape
> and position of the predicted areas between maps, in reference to a "true
> distribution" map.  Since I have irregular polygons instead of raster cells
> this gets a little hairy for me to think about coding.
>
> I thought that epidemiologists might have some experience with this
> problem.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is



On mi? 1.?g? 2012 13:39, Jason Robinson wrote:
> Hoping someone might be able to steer me in the right direction, not sure
> where to look
>
> I have several different modeling methods to predict patterns of species
> occurrences over the same geographic area.  I'd like to compare the shape
> and position of the predicted areas between maps, in reference to a "true
> distribution" map.  Since I have irregular polygons instead of raster cells
> this gets a little hairy for me to think about coding.
>
> I thought that epidemiologists might have some experience with this
> problem.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From jacob.teter at gmail.com  Tue Aug  7 11:27:22 2012
From: jacob.teter at gmail.com (jacob teter)
Date: Tue, 7 Aug 2012 11:27:22 +0200
Subject: [R-sig-Geo] Aggregate CDL (CropScape) rasters without losing data
	on crops
Message-ID: <CAGWGswm5TR7WGVORp7HZWOZ_Pv0SBtX3dfUk=_m1PML7HDvHUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120807/eeebe28a/attachment.pl>

From laurence.delattre2 at gmail.com  Tue Aug  7 15:44:00 2012
From: laurence.delattre2 at gmail.com (laurence delattre)
Date: Tue, 7 Aug 2012 15:44:00 +0200
Subject: [R-sig-Geo] Problems with lm.LMtests and lm.morantest
In-Reply-To: <CAN-F-q2-M+VAEWBz6YEgVHnhQN=5QMn+FqG5risBNhuNWkHpvg@mail.gmail.com>
References: <CAN-F-q2-M+VAEWBz6YEgVHnhQN=5QMn+FqG5risBNhuNWkHpvg@mail.gmail.com>
Message-ID: <CAN-F-q0EcVRn44LW_FSOtMvSmdGXupz77YF=psim8dsuG9+rfw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120807/f61fb928/attachment.pl>

From adrian.aw.cartier at monsanto.com  Tue Aug  7 17:46:03 2012
From: adrian.aw.cartier at monsanto.com (CARTIER, ADRIAN AW (AG/1000))
Date: Tue, 7 Aug 2012 15:46:03 +0000
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial Autoregressive
	Model
Message-ID: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120807/c3583c44/attachment.pl>

From ealaca at ucdavis.edu  Tue Aug  7 21:46:42 2012
From: ealaca at ucdavis.edu (Emilio A. Laca)
Date: Tue, 7 Aug 2012 12:46:42 -0700
Subject: [R-sig-Geo] large SpatialGridDataFrame 2 SpatialPixelsDataFrame
Message-ID: <3F552DF9-F1CA-43D1-8716-099D593DE27B@ucdavis.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120807/cb7a028f/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Aug  8 15:17:27 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 8 Aug 2012 06:17:27 -0700 (PDT)
Subject: [R-sig-Geo] Create raster based on overlapping
Message-ID: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>

?Dear all,
??
?I have two rasters: r1 is a 0.5 degree netcdf file produced by a vegetation model. r2 is a 30m shapefile which I rasterized to a raster with the same 30m resolution. r2 values are all NA and 1.

?Please see below:

> r1
class ? ? ? : RasterLayer?
dimensions ?: 10, 18, 180 ?(nrow, ncol, ncell)
resolution ?: 0.5, 0.5 ?(x, y)
extent ? ? ?: -53, -44, -25, -20 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0?
values ? ? ?: in memory
layer name ?: variable?
zvar ? ? ? ?: variable?

> r2
class ? ? ? : RasterLayer?
dimensions ?: 14469, 22190, 321067110 ?(nrow, ncol, ncell)
resolution ?: 0.0002702699, 0.0002702702 ?(x, y)
extent ? ? ?: -52.60649, -46.6092, -23.7172, -19.80666 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0?
values ? ? ?: in memory
layer name ?: cs_2005spx1?
min value ? : 1?
max value ? : 1?

?Here you can see a join plot: http://img855.imageshack.us/img855/2820/plotzoom.png

?Is it possible to create a new raster, which is composed only by r1 cells which are "touched" by r2 cells?



From e.o.folmer at gmail.com  Wed Aug  8 16:09:11 2012
From: e.o.folmer at gmail.com (Eelke Folmer)
Date: Wed, 08 Aug 2012 16:09:11 +0200
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
References: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
Message-ID: <50227307.7@gmail.com>

Hi,
I think you might be interested in the function lagsarlm in the spdep 
package for a maximum likelihood way to estimate the spatial 
autoregressivemodel for continuous (normal) data. spdep has all kinds of 
ways to calculate the spatial weight matrices too.
Regards,
Eelke

Op 8/7/2012 5:46 PM, CARTIER, ADRIAN AW (AG/1000) schreef:
> Greetings:
>
>
>
> I am a relatively new user to R. I was wondering if anyone is familiar with MATLAB's far_g() function.  If yes, is there an R equivalent to this?  I would like to have the ability to input as my observation vector continuous values. I noticed that there was something close in R, sar_probit_mcmc(), but I can only use a binary vector as my observation vector.
>
>
>
> If my question sounds a bit confusing I am pasting below the MATLAB description of the function so you can see what it is that I am looking for.
>
>
>
> function results =ar_g(y,W,ndraw,nomit,prior) % PURPOSE: Bayesian estimates for the 1st-order Spatial autoregressive model
>
> %          y =ho*W*y + e,    e = N(0,sige*V),
>
> %          V =iag(v1,v2,...vn), r/vi = ID chi(r)/r, r = Gamma(m,k)
>
> %          sige =amma(nu,d0)
>
> %          rho =niform(rmin,rmax), or rho = beta(a1,a2);
>
>
>
>
>
> Thanks in advance,
>
>
>
>
> ______________________________________
> Adrian Cartier, Ph.D. (LS3428)
> Monsanto Company
> TPS/Advancement Integration and Prediction
> Strategic Scientist - Quantitative Modeler
> 800 North Lindbergh Boulevard (Mail Code: LS3A)
> Creve Coeur, MO 63167
>
> Office: 314-694-5307
>
>
> This e-mail message may contain privileged and/or confidential information, and is intended to be received only by persons entitled
> to receive such information. If you have received this e-mail in error, please notify the sender immediately. Please delete it and
> all attachments from any servers, hard drives or any other media. Other use of this e-mail by you is strictly prohibited.
>
> All e-mails and attachments sent and received are subject to monitoring, reading and archival by Monsanto, including its
> subsidiaries. The recipient of this e-mail is solely responsible for checking for the presence of "Viruses" or other "Malware".
> Monsanto, along with its subsidiaries, accepts no liability for any damage caused by any such code transmitted by or accompanying
> this e-mail or any attachment.
>
>
> The information contained in this email may be subject to the export control laws and regulations of the United States, potentially
> including but not limited to the Export Administration Regulations (EAR) and sanctions regulations issued by the U.S. Department of
> Treasury, Office of Foreign Asset Controls (OFAC).  As a recipient of this information you are obligated to comply with all
> applicable U.S. export laws and regulations.
>
> 	[[alternative HTML version deleted]]
>
>


From rafael.wueest at wsl.ch  Wed Aug  8 16:11:04 2012
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Wed, 8 Aug 2012 16:11:04 +0200
Subject: [R-sig-Geo] Create raster based on overlapping
In-Reply-To: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
References: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
Message-ID: <6571A0A5-8E46-4097-B5B5-717CF4E9A1EC@wsl.ch>

Hi Thiago

I am not exactly sure whether I understand what you need (what do you mean by 'touched'). Anyway, the resample command may help you. Something like
resample(r2,r1) may get you close. Try the different method options...

If this doesn't do the job, the less elegant option may be:

dat<-extract(r2,rasterToPolygons(r1))
cells<-sapply(dat,function(x) all(is.na(x)))
r1[cells]<-NA

HTH,
Rafi


On 08.08.2012, at 15:17, Thiago Veloso wrote:

>  Dear all,
>   
>  I have two rasters: r1 is a 0.5 degree netcdf file produced by a vegetation model. r2 is a 30m shapefile which I rasterized to a raster with the same 30m resolution. r2 values are all NA and 1.
> 
>  Please see below:
> 
>> r1
> class       : RasterLayer 
> dimensions  : 10, 18, 180  (nrow, ncol, ncell)
> resolution  : 0.5, 0.5  (x, y)
> extent      : -53, -44, -25, -20  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> values      : in memory
> layer name  : variable 
> zvar        : variable 
> 
>> r2
> class       : RasterLayer 
> dimensions  : 14469, 22190, 321067110  (nrow, ncol, ncell)
> resolution  : 0.0002702699, 0.0002702702  (x, y)
> extent      : -52.60649, -46.6092, -23.7172, -19.80666  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
> values      : in memory
> layer name  : cs_2005spx1 
> min value   : 1 
> max value   : 1 
> 
>  Here you can see a join plot: http://img855.imageshack.us/img855/2820/plotzoom.png
> 
>  Is it possible to create a new raster, which is composed only by r1 cells which are "touched" by r2 cells?
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From mathieu.rajerison at gmail.com  Wed Aug  8 16:16:39 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 8 Aug 2012 16:16:39 +0200
Subject: [R-sig-Geo] Create raster based on overlapping
In-Reply-To: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
References: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
Message-ID: <CAGfc75np01wkd+RoBaYkjRCDbKsVQod6zVSTRuYtLV1jWsoJTw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120808/8892449f/attachment.pl>

From janverbesselt at gmail.com  Wed Aug  8 16:32:36 2012
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Wed, 8 Aug 2012 16:32:36 +0200
Subject: [R-sig-Geo] Create raster based on overlapping
In-Reply-To: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
References: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
Message-ID: <CAHKDjo7V6JvDwt+EUi8tErRpzJfKby9u3kr2O0J0abSOL8QcXA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120808/eccc2874/attachment.pl>

From alemu.tadesse at gmail.com  Wed Aug  8 18:54:56 2012
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Wed, 8 Aug 2012 10:54:56 -0600
Subject: [R-sig-Geo] Create raster based on overlapping
In-Reply-To: <CAHKDjo7V6JvDwt+EUi8tErRpzJfKby9u3kr2O0J0abSOL8QcXA@mail.gmail.com>
References: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CAHKDjo7V6JvDwt+EUi8tErRpzJfKby9u3kr2O0J0abSOL8QcXA@mail.gmail.com>
Message-ID: <CACGkHROO3Eo3cLikU+VM7oKXvy-eoEstUFY2GddS6RZM6DXgXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120808/f90ac197/attachment.pl>

From janverbesselt at gmail.com  Wed Aug  8 23:32:16 2012
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Wed, 8 Aug 2012 23:32:16 +0200
Subject: [R-sig-Geo] Create raster based on overlapping
In-Reply-To: <CACGkHROO3Eo3cLikU+VM7oKXvy-eoEstUFY2GddS6RZM6DXgXQ@mail.gmail.com>
References: <1344431847.45872.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CAHKDjo7V6JvDwt+EUi8tErRpzJfKby9u3kr2O0J0abSOL8QcXA@mail.gmail.com>
	<CACGkHROO3Eo3cLikU+VM7oKXvy-eoEstUFY2GddS6RZM6DXgXQ@mail.gmail.com>
Message-ID: <CAHKDjo7HbHa754DOtfB3Djo-oEeenoPmS-BWEiYOgnyGLt6ajw@mail.gmail.com>

Hi Alemu,

The MODIS package provides

Functions to download, mosaic, re-sample, re-project, analyse and
visualise of MODIS grid data. Manual:
http://www.wuala.com/IVFL/R_MODIS/

Best,
Jan

On Wed, Aug 8, 2012 at 6:54 PM, Alemu Tadesse <alemu.tadesse at gmail.com> wrote:
>
> Dear All,
>
> I was trying to download MODIS Aerosol data and extract values for a given latitude and longitude.  I am not familiar with the  HDF file format. I am trying to familiarize myself with it and started playing with the codes on http://www.r-gis.net/?q=ModisDownload. I downloaded the example_1.r file and run it. I have downloaded RTM and run the code. While running I got the error  "Mosaic failed!". Is there anything I should do ? Or do you have an advice for me on how to read MODIS aerosol data and extract values for a given lat/lon. I also would like to extract other values like water column , albedo and etc from MODIS. I really appreciate your help on this.
>
> Best regards,
>
> Alemu
>
>
> On Wed, Aug 8, 2012 at 8:32 AM, Jan Verbesselt <janverbesselt at gmail.com> wrote:
>>
>> Hi Thiago,
>>
>> one way is to:
>> first
>>
>> rr2 <- resample(r2)  ## assuming the pixels with 1 are the ones you want to
>> select and with NA you do not want to select
>>
>> sr1 <- rr2 * r1 ## and then multiple both rasters
>>
>> There are other options too probably via the extract() function etc.
>>
>> Cheers,
>> Jan
>>
>>
>> On Wed, Aug 8, 2012 at 3:17 PM, Thiago Veloso <thi_veloso at yahoo.com.br>wrote:
>>
>> >  Dear all,
>> >
>> >  I have two rasters: r1 is a 0.5 degree netcdf file produced by a
>> > vegetation model. r2 is a 30m shapefile which I rasterized to a raster with
>> > the same 30m resolution. r2 values are all NA and 1.
>> >
>> >  Please see below:
>> >
>> > > r1
>> > class       : RasterLayer
>> > dimensions  : 10, 18, 180  (nrow, ncol, ncell)
>> > resolution  : 0.5, 0.5  (x, y)
>> > extent      : -53, -44, -25, -20  (xmin, xmax, ymin, ymax)
>> > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
>> > values      : in memory
>> > layer name  : variable
>> > zvar        : variable
>> >
>> > > r2
>> > class       : RasterLayer
>> > dimensions  : 14469, 22190, 321067110  (nrow, ncol, ncell)
>> > resolution  : 0.0002702699, 0.0002702702  (x, y)
>> > extent      : -52.60649, -46.6092, -23.7172, -19.80666  (xmin, xmax, ymin,
>> > ymax)
>> > coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
>> > +towgs84=0,0,0
>> > values      : in memory
>> > layer name  : cs_2005spx1
>> > min value   : 1
>> > max value   : 1
>> >
>> >  Here you can see a join plot:
>> > http://img855.imageshack.us/img855/2820/plotzoom.png
>> >
>> >  Is it possible to create a new raster, which is composed only by r1 cells
>> > which are "touched" by r2 cells?
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Wed Aug  8 23:57:20 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 8 Aug 2012 23:57:20 +0200 (CEST)
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
References: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
Message-ID: <alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>

On Tue, 7 Aug 2012, CARTIER, ADRIAN AW (AG/1000) wrote:

> Greetings:
>
>
>
> I am a relatively new user to R. I was wondering if anyone is familiar 
> with MATLAB's far_g() function.  If yes, is there an R equivalent to 
> this?  I would like to have the ability to input as my observation 
> vector continuous values. I noticed that there was something close in R, 
> sar_probit_mcmc(), but I can only use a binary vector as my observation 
> vector.
>

There is an on-going GSoC project to port some of the Matlab Spatial 
Econometrics toolbox MCMC code to R - early work on R-Forge, project 
spdep2. This is alpha/pre-alpha code at present, with no working package 
as yet. I'm sure the GSoC student would be grateful for helpful feedback.

Roger

>
>
> If my question sounds a bit confusing I am pasting below the MATLAB 
> description of the function so you can see what it is that I am looking 
> for.
>
>
>
> function results = far_g(y,W,ndraw,nomit,prior) % PURPOSE: Bayesian estimates for the 1st-order Spatial autoregressive model
>
> %          y = rho*W*y + e,    e = N(0,sige*V),
>
> %          V = diag(v1,v2,...vn), r/vi = ID chi(r)/r, r = Gamma(m,k)
>
> %          sige = gamma(nu,d0)
>
> %          rho = Uniform(rmin,rmax), or rho = beta(a1,a2);
>
>
>
>
>
> Thanks in advance,
>
>
>
>
> ______________________________________
> Adrian Cartier, Ph.D. (LS3428)
> Monsanto Company
> TPS/Advancement Integration and Prediction
> Strategic Scientist - Quantitative Modeler
> 800 North Lindbergh Boulevard (Mail Code: LS3A)
> Creve Coeur, MO 63167
>
> Office: 314-694-5307
>
>
> This e-mail message may contain privileged and/or confidential information, and is intended to be received only by persons entitled
> to receive such information. If you have received this e-mail in error, please notify the sender immediately. Please delete it and
> all attachments from any servers, hard drives or any other media. Other use of this e-mail by you is strictly prohibited.
>
> All e-mails and attachments sent and received are subject to monitoring, reading and archival by Monsanto, including its
> subsidiaries. The recipient of this e-mail is solely responsible for checking for the presence of "Viruses" or other "Malware".
> Monsanto, along with its subsidiaries, accepts no liability for any damage caused by any such code transmitted by or accompanying
> this e-mail or any attachment.
>
>
> The information contained in this email may be subject to the export control laws and regulations of the United States, potentially
> including but not limited to the Export Administration Regulations (EAR) and sanctions regulations issued by the U.S. Department of
> Treasury, Office of Foreign Asset Controls (OFAC).  As a recipient of this information you are obligated to comply with all
> applicable U.S. export laws and regulations.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alemu.tadesse at gmail.com  Thu Aug  9 03:28:57 2012
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Wed, 8 Aug 2012 19:28:57 -0600
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
References: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
	<alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
Message-ID: <CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120808/fd7d1020/attachment.pl>

From michela.giusti at isprambiente.it  Thu Aug  9 11:49:36 2012
From: michela.giusti at isprambiente.it (Michela Giusti)
Date: Thu, 09 Aug 2012 11:49:36 +0200
Subject: [R-sig-Geo] Monte Carlo test on ENFA results problem
Message-ID: <502387B0.40509@isprambiente.it>

Dear all,

I am doing an ENFA and MADIFA analysis and I have problems with the 
randtest.enfa command of the adehabitatHS package. It does not work even 
if the pc works for hours. I also used the command of the old adehabitat 
version but the problem is the same.

Do you know if there is an alternative command(s) that I can use to 
perfom a Monte Carlo test on ENFA results (I need to obtain the p-value)?

Another question is about the graphs of the MADIFA test that I have 
attached. Can anybody help me with the problem in the figure 
madifa284.jpg??? Any idea?
  I also attached the figure relative to the scatter plot of the same 
madifa results (scatter_mad284) where it seems that there are not problems.

Thanks in advance for any help,

Bye,

Michela

-- 
*****************************************************************
Dr. Michela Giusti
ISPRA
Istituto Superiore per la Protezione e la Ricerca Ambientale
Via Brancati, 60
00144 Roma
Tel. +390650074746
michela.giusti at isprambiente.it
*****************************************************************

-------------- next part --------------
A non-text attachment was scrubbed...
Name: madifa284.jpg
Type: image/jpeg
Size: 12585 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120809/b085ee47/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: scatter_mad284.jpg
Type: image/jpeg
Size: 12592 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120809/b085ee47/attachment-0001.jpg>

From e.o.folmer at gmail.com  Thu Aug  9 12:17:34 2012
From: e.o.folmer at gmail.com (Eelke Folmer)
Date: Thu, 09 Aug 2012 12:17:34 +0200
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
References: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
	<alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
Message-ID: <50238E3E.7090702@gmail.com>



Op 8/8/2012 11:57 PM, Roger Bivand schreef:
> On Tue, 7 Aug 2012, CARTIER, ADRIAN AW (AG/1000) wrote:
>
>> Greetings:
>>
>>
>>
>> I am a relatively new user to R. I was wondering if anyone is familiar
>> with MATLAB's far_g() function.  If yes, is there an R equivalent to
>> this?  I would like to have the ability to input as my observation
>> vector continuous values. I noticed that there was something close in
>> R, sar_probit_mcmc(), but I can only use a binary vector as my
>> observation vector.
>>
>
> There is an on-going GSoC project to port some of the Matlab Spatial
> Econometrics toolbox MCMC code to R - early work on R-Forge, project
> spdep2. This is alpha/pre-alpha code at present, with no working package
> as yet. I'm sure the GSoC student would be grateful for helpful feedback.
>
> Roger
>
Nice to hear about this development. I still have data that I did not 
analyze properly because the sampler in the the Econometrics spatial 
toolbox choked on them (which might have occurred due to my own 
mistakes). I'm happy to do some testing with some of my own data once 
there is working code.
Eelke

>>
>>
>> If my question sounds a bit confusing I am pasting below the MATLAB
>> description of the function so you can see what it is that I am
>> looking for.
>>
>>
>>
>> function results = far_g(y,W,ndraw,nomit,prior) % PURPOSE: Bayesian
>> estimates for the 1st-order Spatial autoregressive model
>>
>> %          y = rho*W*y + e,    e = N(0,sige*V),
>>
>> %          V = diag(v1,v2,...vn), r/vi = ID chi(r)/r, r = Gamma(m,k)
>>
>> %          sige = gamma(nu,d0)
>>
>> %          rho = Uniform(rmin,rmax), or rho = beta(a1,a2);
>>
>>
>>
>>
>>
>> Thanks in advance,
>>
>>
>>
>>
>> ______________________________________
>> Adrian Cartier, Ph.D. (LS3428)
>> Monsanto Company
>> TPS/Advancement Integration and Prediction
>> Strategic Scientist - Quantitative Modeler
>> 800 North Lindbergh Boulevard (Mail Code: LS3A)
>> Creve Coeur, MO 63167
>>
>> Office: 314-694-5307
>>
>>
>> This e-mail message may contain privileged and/or confidential
>> information, and is intended to be received only by persons entitled
>> to receive such information. If you have received this e-mail in
>> error, please notify the sender immediately. Please delete it and
>> all attachments from any servers, hard drives or any other media.
>> Other use of this e-mail by you is strictly prohibited.
>>
>> All e-mails and attachments sent and received are subject to
>> monitoring, reading and archival by Monsanto, including its
>> subsidiaries. The recipient of this e-mail is solely responsible for
>> checking for the presence of "Viruses" or other "Malware".
>> Monsanto, along with its subsidiaries, accepts no liability for any
>> damage caused by any such code transmitted by or accompanying
>> this e-mail or any attachment.
>>
>>
>> The information contained in this email may be subject to the export
>> control laws and regulations of the United States, potentially
>> including but not limited to the Export Administration Regulations
>> (EAR) and sanctions regulations issued by the U.S. Department of
>> Treasury, Office of Foreign Asset Controls (OFAC).  As a recipient of
>> this information you are obligated to comply with all
>> applicable U.S. export laws and regulations.
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From Maximilian.Spross at uibk.ac.at  Thu Aug  9 12:49:20 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-1?Q?Maximilian_Spro=DF?=)
Date: Thu, 09 Aug 2012 12:49:20 +0200
Subject: [R-sig-Geo] gwr, calculate hatmatrix when fit points are given
Message-ID: <502395B0.6080103@uibk.ac.at>

Dear list,


when running gwr() with given fit.points, it is not possible to 
calculate the hatmatrix. But it would be very helpful to get the fitting 
characteristics such as AIC or RMSE with the gwr output. In my case the 
fit points have to be set, as i run gwr on a cluster.

I appreciate if anyone can help!

all the best,

Max


From a.m.nuno at gmail.com  Thu Aug  9 13:28:01 2012
From: a.m.nuno at gmail.com (Ana Nuno)
Date: Thu, 9 Aug 2012 12:28:01 +0100
Subject: [R-sig-Geo] spatially correlated variable with a negative binomial
	distribution
In-Reply-To: <CAK7sxf5K-xGE+fGAMpKK9Rcw-GfPVD9oS-6_AaNzpZ_FN-wBJg@mail.gmail.com>
References: <CAK7sxf5K-xGE+fGAMpKK9Rcw-GfPVD9oS-6_AaNzpZ_FN-wBJg@mail.gmail.com>
Message-ID: <CAK7sxf5GGeZainGkSZbXV3DUVOfPhC0eTfBvAc1n4hj6asYSgA@mail.gmail.com>

Dear all,

I'd like to obtain a random spatially correlated variable with a
negative binomial distribution. The goal is to simulate random
variables in which high values are close to high values (using rho to
simulate spatial autocorrelation) but different values of aggregation
(k parameter in a NBD) can also be controlled.

I was planning to adapt the generally suggested approach below:

#From Anselin's workbook
library(spdep)
data(columbus)
attach(columbus)
c05 <- invIrM(col.gal.nb, rho=0.5)
uu <- rnorm(49)
#uu2<-rnbinom(49,size=0.5,mu=2)
mean(uu);sd(uu)
e05 <- c05 %*% uu

just replacing uu with a NBD instead of a normal distribution.

While this seems to work to generate correlated NBDs, higher values of
rho actually increase the k parameter in the obtained variable. This
means that, for example, for a given initial k parameter, I obtain
increasingly lower variance to the mean when I increase rho (which
seems contradictory to expectations).

Any suggestions on how this could be achieved or improved?

Thank you!

--
Ana Nuno


From alobolistas at gmail.com  Thu Aug  9 13:35:13 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 9 Aug 2012 13:35:13 +0200
Subject: [R-sig-Geo] raster: file not saved and data type changed
Message-ID: <CAG4NReK59YQ1TQ7cA-QRpyYuPN_yay+mk7xzMTkcbWyp4DTK9w@mail.gmail.com>

Hi!

I'm doing this:
> delme <- subset(adlstest,c("B48","B31","B21"),filename="delme",format="GTiff",dataType="INT2U")
> adlstest
class       : RasterBrick
dimensions  : 33, 33, 1089, 196  (nrow, ncol, ncell, nlayers)
resolution  : 29.9746, 29.99077  (x, y)
extent      : 643485, 644474.2, 7053615, 7054605  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0
values      : in memory
layer names : B8, B9, B10, B11, B12, B13, B14, B15, B16, B17, B18,
B19, B20, B21, B22, ...
min values  : 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
max values  : 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...

and the object is correctly created but the file is not saved to disk

If I do:

> writeRaster(delme,filename="delme",format="GTiff",dataType="INT2U")
class       : RasterBrick
dimensions  : 33, 33, 1089, 3  (nrow, ncol, ncell, nlayers)
resolution  : 29.9746, 29.99077  (x, y)
extent      : 643485, 644474.2, 7053615, 7054605  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0
values      : /media/Iomega_HDD/VOLCAN/HYPERION/RHyperion/delme.tif
layer names : delme.1, delme.2, delme.3
min values  : 0, 0, 0
max values  : 0, 0, 0

I get the file but note that the data type is not the one I set:

> GDALinfo("delme.tif")
rows        33
columns     33
bands       3
origin.x        643485
origin.y        7053615
res.x       29.9746
res.y       29.99077
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
file        delme.tif
apparent band summary:
   GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
1 Float32    0    0     0   0           TRUE    -3.4e+38
2 Float32    0    0     0   0           TRUE    -3.4e+38
3 Float32    0    0     0   0           TRUE    -3.4e+38
Metadata:
AREA_OR_POINT=Area

A bug or am I doing something wrong?
File in
http://dl.dropbox.com/u/3180464/adlstest.rda

Agus

> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99

loaded via a namespace (and not attached):
[1] grid_2.1


From r-sig-geo.20.trevva at spamgourmet.com  Thu Aug  9 14:02:45 2012
From: r-sig-geo.20.trevva at spamgourmet.com (r-sig-geo.20.trevva at spamgourmet.com)
Date: Thu, 9 Aug 2012 14:02:45 +0200
Subject: [R-sig-Geo] Extracting GSHHS global coastlines
Message-ID: <CA+PCcJN13ERbSNFxf1W43QqHw4gy-itnwACByyvtWhsF8CLH=A@mail.gmail.com>

Dear R-sig-geo,

I seem to be having problems with the GSHHS interface that I was
wondering if you could help with? I would like to extract the global,
low-resolution coastline from the database. Here's my script:

library(maptools)
xlims <- c(0,360)
ylims <- c(-90,90)
gshhs.file <- system.file("share/gshhs_c.b", package="maptools")
world <- Rgshhs(gshhs.file, xlim=xlims, ylim=ylims,level=1,checkPolygons=TRUE)

Which results in the following output:

Data are polygon data
Loading required package: rgeos
Loading required package: stringr
Loading required package: plyr
rgeos: (SVN revision 343M)
 GEOS runtime version: 3.3.2-CAPI-1.7.2
 Polygon checking: TRUE

Polygon 5 is Antarctica
  area 13956598
  dropping south edge to -90
Rgshhs: clipping 4 of 785 polygons ...
Error in slot(gI, "polygons") :
  no slot of name "polygons" for this object of class "SpatialCollections"
>

Using getRgshhsMap() instead results in a different error:

> world <- getRgshhsMap(gshhs.file, xlim=xlims, ylim=ylims,level=1)
Data are polygon data
Polygon 5 is Antarctica
  area 13956598
  dropping south edge to -90
Rgshhs: clipping 4 of 785 polygons ...
Error in slot(gI, "polygons") :
  no slot of name "polygons" for this object of class "SpatialCollections"
Data are polygon data
Polygon  is Antarctica
  area 50577991
  dropping south edge to -90
Error in polys[[which(chosen_0 == (Antarctica - 1))]] :
  attempt to select less than one element
>

Am I doing something wrong? Or is this a bug?

Am running maptools 0.8-14 with sp 0.9-99 and rgeos 0.2-6 on R 2.14.1

Best wishes,

Mark


From Roger.Bivand at nhh.no  Thu Aug  9 14:15:22 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Aug 2012 14:15:22 +0200 (CEST)
Subject: [R-sig-Geo] gwr, calculate hatmatrix when fit points are given
In-Reply-To: <502395B0.6080103@uibk.ac.at>
References: <502395B0.6080103@uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1208091359410.26060@reclus.nhh.no>

On Thu, 9 Aug 2012, Maximilian Spro? wrote:

> Dear list,
>
>
> when running gwr() with given fit.points, it is not possible to 
> calculate the hatmatrix. But it would be very helpful to get the fitting 
> characteristics such as AIC or RMSE with the gwr output. In my case the 
> fit points have to be set, as i run gwr on a cluster.

According to information from the authors, it seems that GWR3 fits without 
fit points first to generate a hat matrix for the data points. This is 
then used in a further step for the fit points, for which no covariates 
are observed. The assumption is that #data points << #fit points, as when 
making a raster. This may be done I think by doing the same, first running 
gwr() on the data points only and making the hat matrix, next fitting on 
the fit points and including the output of the first step in the 
fittedGWRobject= argument. However, the fitted object will only help in 
giving local R2 (GWR4 version), and local coefficient and prediction 
standard errors, not AIC.

Roger

>
> I appreciate if anyone can help!
>
> all the best,
>
> Max
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Thu Aug  9 14:59:59 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Aug 2012 14:59:59 +0200 (CEST)
Subject: [R-sig-Geo] Extracting GSHHS global coastlines
In-Reply-To: <CA+PCcJN13ERbSNFxf1W43QqHw4gy-itnwACByyvtWhsF8CLH=A@mail.gmail.com>
References: <CA+PCcJN13ERbSNFxf1W43QqHw4gy-itnwACByyvtWhsF8CLH=A@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208091418440.26060@reclus.nhh.no>

On Thu, 9 Aug 2012, r-sig-geo.20.trevva at spamgourmet.com wrote:

> Dear R-sig-geo,
>
> I seem to be having problems with the GSHHS interface that I was
> wondering if you could help with? I would like to extract the global,
> low-resolution coastline from the database. Here's my script:
>
> library(maptools)
> xlims <- c(0,360)
> ylims <- c(-90,90)
> gshhs.file <- system.file("share/gshhs_c.b", package="maptools")
> world <- Rgshhs(gshhs.file, xlim=xlims, ylim=ylims,level=1,checkPolygons=TRUE)
>
> Which results in the following output:
>
> Data are polygon data
> Loading required package: rgeos
> Loading required package: stringr
> Loading required package: plyr
> rgeos: (SVN revision 343M)
> GEOS runtime version: 3.3.2-CAPI-1.7.2
> Polygon checking: TRUE
>
> Polygon 5 is Antarctica
>  area 13956598
>  dropping south edge to -90
> Rgshhs: clipping 4 of 785 polygons ...
> Error in slot(gI, "polygons") :
>  no slot of name "polygons" for this object of class "SpatialCollections"
>>
>
> Using getRgshhsMap() instead results in a different error:
>
>> world <- getRgshhsMap(gshhs.file, xlim=xlims, ylim=ylims,level=1)
> Data are polygon data
> Polygon 5 is Antarctica
>  area 13956598
>  dropping south edge to -90
> Rgshhs: clipping 4 of 785 polygons ...
> Error in slot(gI, "polygons") :
>  no slot of name "polygons" for this object of class "SpatialCollections"
> Data are polygon data
> Polygon  is Antarctica
>  area 50577991
>  dropping south edge to -90
> Error in polys[[which(chosen_0 == (Antarctica - 1))]] :
>  attempt to select less than one element
>>
>
> Am I doing something wrong? Or is this a bug?

Either of:

world <- Rgshhs(gshhs.file, level=1,checkPolygons=TRUE)

or

xlims <- c(-180,360)
world <- Rgshhs(gshhs.file, xlim=xlims, ylim=ylims, level=1,
   checkPolygons=TRUE)

work. Clipping on Greenwich seems to cause problems with a sliver, 
generating a single point (a degenerate polygon) and two polygons for Kent 
and East Anglia. I've committed a fix to R-Forge SVN, but the output is 
unattractive, with polygon splitting on 180 degrees causing trouble. A few 
islands seem to flip from +180 to -180, creating havoc. In addition, 
Antarctica is -180, 180, so looks bad. Consider using the wrld_simpl 
dataset in maptools, or similar in the rworldmaps package instead if you 
need country boundaries, or merge them out with:

all_wrld <- unionSpatialPolygons(wrld_simpl, rep("land",
   nrow(wrld_simpl)), threshold=5)

which uses threshold= to filter out boundary slivers. Maybe even easier is 
the maps package and map2SpatialPolygons() in maptools if all you need is 
a background world land map.

Roger

>
> Am running maptools 0.8-14 with sp 0.9-99 and rgeos 0.2-6 on R 2.14.1
>
> Best wishes,
>
> Mark
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From macqueen1 at llnl.gov  Thu Aug  9 17:10:14 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Thu, 9 Aug 2012 08:10:14 -0700
Subject: [R-sig-Geo] How to identify unknown Coordinate systems?
In-Reply-To: <CANVKczOLTE8sVwz774TFJuoR1=BySa_GqDC7pnVdYG+xrDSAYg@mail.gmail.com>
Message-ID: <CC491D53.A5C85%macqueen1@llnl.gov>

I had data in an unknown projection -- but I knew exactly where it was
supposed to be located.

What I did was make a guess at its projection, transform it to lat/long,
export to KML, then open in Google Earth as an easy way to check whether
it was where it was supposed to be. Repeat until satisfied.

However, from other information I could limit the list of possible
projections, and that obviously helped.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 7/24/12 9:36 AM, "Barry Rowlingson" <b.rowlingson at lancaster.ac.uk>
wrote:

>On Tue, Jul 24, 2012 at 5:17 PM, Juan Tomas Sayago
><juantomas.sayago at gmail.com> wrote:
>> Hello,
>> I have data in an unknown projection  but I know where more or less
>>where
>> it is located, but I don't know from what to transform to what I want to
>> use.
>
>First of all it could be one of the global systems like UTM zones.
>Find out which UTM zone you might expect it to be and see what the
>coordinates are of the region you think it might be.
>
>Also, make sure you haven't got a .prj file with your shapefile, or
>that the CRS is hidden in some metadata file.
>
>Or try looking up the geographical area here:
>
>http://www.spatialreference.org/
>
> but you might have to be creative - searching for 'Great Britain'
>doesnt find the British national grid system, but searching for
>'British' does. That site is also good for checking UTM zones. Note
>there's a lot of unofficial CRS in there.
>
> Another useful thing is to figure out if the coordinates are metres
>or km or miles, feet and inches - how far apart are your points in the
>coordinate system?
>
> If all that fails, if you have the location of some of your points in
>a known coordinate system, you can probably work out the transform
>yourself, but it's likely to be imprecise.
>
> Finally, try beating the person who gave you the data until they tell
>you! Or being nice to them.
>
>Barry
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From adrian.aw.cartier at monsanto.com  Thu Aug  9 18:06:05 2012
From: adrian.aw.cartier at monsanto.com (adriancartier)
Date: Thu, 9 Aug 2012 09:06:05 -0700 (PDT)
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
	Autoregressive Model
In-Reply-To: <CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>
References: <1344352805037-7580687.post@n2.nabble.com>
	<C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
	<alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
	<CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>
Message-ID: <C376B5269AE7054A82BD87C218BF16BF2ADE1B@stlwexmbxprd04.na.ds.monsanto.com>

For those interested in doing a translation of MATLABs "far_g()" function. Message me and I will send you a soft copy of the MATLAB code.

______________________________________
Adrian Cartier, Ph.D. (LS3428)
Monsanto Company
TPS/Advancement Integration and Prediction
Strategic Scientist - Quantitative Modeler
800 North Lindbergh Boulevard (Mail Code: LS3A)
Creve Coeur, MO 63167

Office: 314-694-5307


From: Alemu Tadesse [via R-sig-geo] [mailto:ml-node+s2731867n7580698h96 at n2.nabble.com]
Sent: Wednesday, August 08, 2012 8:30 PM
To: CARTIER, ADRIAN A.W. [AG/1000]
Subject: Re: Bayesian Estimates for 1st-order Spatial Autoregressive Model

Dear All,

I have been trying to read MODIS Aerosol (with the MODIS package - thanks
to Jan). But, I am getting an error after the running the following command
, just to make myself familiar with the package.
> a < getHdf(HdfName="MOD13Q1.A2009209.h19v04.005.2009227222141.hdf",
wait=0)
Error in .getDef("localArcPath") :
Can't find the MODIS settings file in: 'C:/Documents and
Settings/atadesse/My Documents/.MODIS_Opts.R'
Check the location or copy and modify: 'C:/Program
Files/R/library/MODIS/external/MODIS_Opts.R' to: 'C:/Documents and
Settings/atadesse/My Documents/.MODIS_Opts.R'

I just copied the command from an example from the package. Based on the
suggestion at the end of the error message I copied the file MODIS_Opts.R
to C:/Documents and Settings/atadesse/My Documents/ directory and still got
the same error. Any idea ?

Best,

Alemu

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
[hidden email]</user/SendEmail.jtp?type=node&node=7580698&i=0>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

________________________________
If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/Bayesian-Estimates-for-1st-order-Spatial-Autoregressive-Model-tp7580687p7580698.html
To unsubscribe from Bayesian Estimates for 1st-order Spatial Autoregressive Model, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7580687&code=YWRyaWFuLmF3LmNhcnRpZXJAbW9uc2FudG8uY29tfDc1ODA2ODd8MTIwNzA5NTU4Mw==>.
NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
This e-mail message may contain privileged and/or confidential information, and is intended to be received only by persons entitled
to receive such information. If you have received this e-mail in error, please notify the sender immediately. Please delete it and
all attachments from any servers, hard drives or any other media. Other use of this e-mail by you is strictly prohibited.

All e-mails and attachments sent and received are subject to monitoring, reading and archival by Monsanto, including its
subsidiaries. The recipient of this e-mail is solely responsible for checking for the presence of "Viruses" or other "Malware".
Monsanto, along with its subsidiaries, accepts no liability for any damage caused by any such code transmitted by or accompanying
this e-mail or any attachment.


The information contained in this email may be subject to the export control laws and regulations of the United States, potentially
including but not limited to the Export Administration Regulations (EAR) and sanctions regulations issued by the U.S. Department of
Treasury, Office of Foreign Asset Controls (OFAC).  As a recipient of this information you are obligated to comply with all
applicable U.S. export laws and regulations.




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bayesian-Estimates-for-1st-order-Spatial-Autoregressive-Model-tp7580687p7580708.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jordanrwinkler at gmail.com  Thu Aug  9 18:59:01 2012
From: jordanrwinkler at gmail.com (Jordan Winkler)
Date: Thu, 9 Aug 2012 10:59:01 -0600
Subject: [R-sig-Geo] Empirical Variogram from multiple realizations
Message-ID: <CAJD8EJZxHaMAheQaebGWOhMBAnqeJOTVQasi2hxbqeKj=oYivA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120809/fe621d48/attachment.pl>

From basille at ase-research.org  Thu Aug  9 19:02:09 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Thu, 09 Aug 2012 13:02:09 -0400
Subject: [R-sig-Geo] Monte Carlo test on ENFA results problem
In-Reply-To: <502387B0.40509@isprambiente.it>
References: <502387B0.40509@isprambiente.it>
Message-ID: <5023ED11.9030407@ase-research.org>

Dear Michela,

Your graphical problem just makes me think that you have a very peculiar 
dataset. Have you most points at the exact same location, and just a few 
others? It would explain the graphs.

As for the randtest call, it's hard to tell without the code you used and 
the outputs (but I understand there is none?). Could you please provide a 
reproducible example?

Altogether, I really feel like the structure of your data will explain a lot...
Best,
Mathieu.


Le 09/08/2012 05:49, Michela Giusti a ?crit :
> Dear all,
>
> I am doing an ENFA and MADIFA analysis and I have problems with the
> randtest.enfa command of the adehabitatHS package. It does not work even if
> the pc works for hours. I also used the command of the old adehabitat
> version but the problem is the same.
>
> Do you know if there is an alternative command(s) that I can use to perfom
> a Monte Carlo test on ENFA results (I need to obtain the p-value)?
>
> Another question is about the graphs of the MADIFA test that I have
> attached. Can anybody help me with the problem in the figure
> madifa284.jpg??? Any idea?
> I also attached the figure relative to the scatter plot of the same madifa
> results (scatter_mad284) where it seems that there are not problems.
>
> Thanks in advance for any help,
>
> Bye,
>
> Michela
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From Roger.Bivand at nhh.no  Thu Aug  9 20:56:29 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Aug 2012 20:56:29 +0200 (CEST)
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>
References: <C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
	<alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
	<CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208092053170.28643@reclus.nhh.no>

You hijacked a different thread on the list, with an inappropriate 
subject. When posting, do follow the guidelines, and always begin a new 
thread/question by writing a text-only (no HTML) message to the list. 
Never reply to a message in an existing thread erasing the contents and/or 
subject as you've done here. You've also succeeded in confusing the 
original poster in this thread.

Roger


On Thu, 9 Aug 2012, Alemu Tadesse wrote:

> Dear All,
>
> I have been trying to read MODIS Aerosol (with the MODIS package - thanks
> to Jan). But, I am getting an error after the running the following command
> , just to make myself familiar with the package.
>> a < getHdf(HdfName="MOD13Q1.A2009209.h19v04.005.2009227222141.hdf",
> wait=0)
> Error in .getDef("localArcPath") :
> Can't find the MODIS settings file in: 'C:/Documents and
> Settings/atadesse/My Documents/.MODIS_Opts.R'
> Check the location or copy and modify: 'C:/Program
> Files/R/library/MODIS/external/MODIS_Opts.R' to: 'C:/Documents and
> Settings/atadesse/My Documents/.MODIS_Opts.R'
>
> I just copied the command from an example from the package. Based on the
> suggestion at the end of the error message I copied the file MODIS_Opts.R
> to C:/Documents and Settings/atadesse/My Documents/ directory and still got
> the same error. Any idea ?
>
> Best,
>
> Alemu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Thu Aug  9 21:07:02 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Aug 2012 21:07:02 +0200 (CEST)
Subject: [R-sig-Geo] Bayesian Estimates for 1st-order Spatial
 Autoregressive Model
In-Reply-To: <C376B5269AE7054A82BD87C218BF16BF2ADE1B@stlwexmbxprd04.na.ds.monsanto.com>
References: <1344352805037-7580687.post@n2.nabble.com>
	<C376B5269AE7054A82BD87C218BF16BF2AD94F@stlwexmbxprd04.na.ds.monsanto.com>
	<alpine.LRH.2.02.1208082352590.23828@reclus.nhh.no>
	<CACGkHRNg=-Xy6CAH_VH0NtqVdpmmBMA_+9oX38bCgpwXwui=wA@mail.gmail.com>
	<C376B5269AE7054A82BD87C218BF16BF2ADE1B@stlwexmbxprd04.na.ds.monsanto.com>
Message-ID: <alpine.LRH.2.02.1208092056370.28643@reclus.nhh.no>

On Thu, 9 Aug 2012, adriancartier wrote:

> For those interested in doing a translation of MATLABs "far_g()" 
> function. Message me and I will send you a soft copy of the MATLAB code.

Adrian:

Note that the message you replied to had nothing whatsoever to do with 
your question.

If you had bothered to read my reply to your question, and Eelke's 
followup, you would have gone to R-Forge:

https://r-forge.r-project.org/

and found the current draft R code for far_g() in the spdep2 project:

https://r-forge.r-project.org/scm/viewvc.php/pkg/R/far_g.R?view=markup&revision=39&root=spdep2

as I suggested. Saying you will send a copy of the Matlab code is also 
less helpful than giving the link to the Spatial Econometrics toolbox by 
James LeSage and R. Kelley Pace at:

http://www.spatial-econometrics.com/html/jplv7.zip

looking for spatial/far_models/far_g.m

One expects more attention to the run of play from questioners working in 
big business, really. I said that the spdep2 code is as yet only very 
preliminary, so a community effort to help develop it, such as by giving 
good bug reports and examples with data, is what is needed now, this is 
also an opportunity for you to add value.

Hope this helps,

Roger

>
> ______________________________________
> Adrian Cartier, Ph.D. (LS3428)
> Monsanto Company
> TPS/Advancement Integration and Prediction
> Strategic Scientist - Quantitative Modeler
> 800 North Lindbergh Boulevard (Mail Code: LS3A)
> Creve Coeur, MO 63167
>
> Office: 314-694-5307
>
>
> From: Alemu Tadesse [via R-sig-geo] [mailto:ml-node+s2731867n7580698h96 at n2.nabble.com]
> Sent: Wednesday, August 08, 2012 8:30 PM
> To: CARTIER, ADRIAN A.W. [AG/1000]
> Subject: Re: Bayesian Estimates for 1st-order Spatial Autoregressive Model
>
> Dear All,
>
> I have been trying to read MODIS Aerosol (with the MODIS package - thanks
> to Jan). But, I am getting an error after the running the following command
> , just to make myself familiar with the package.
>> a < getHdf(HdfName="MOD13Q1.A2009209.h19v04.005.2009227222141.hdf",
> wait=0)
> Error in .getDef("localArcPath") :
> Can't find the MODIS settings file in: 'C:/Documents and
> Settings/atadesse/My Documents/.MODIS_Opts.R'
> Check the location or copy and modify: 'C:/Program
> Files/R/library/MODIS/external/MODIS_Opts.R' to: 'C:/Documents and
> Settings/atadesse/My Documents/.MODIS_Opts.R'
>
> I just copied the command from an example from the package. Based on the
> suggestion at the end of the error message I copied the file MODIS_Opts.R
> to C:/Documents and Settings/atadesse/My Documents/ directory and still got
> the same error. Any idea ?
>
> Best,
>
> Alemu
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]</user/SendEmail.jtp?type=node&node=7580698&i=0>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> ________________________________
> If you reply to this email, your message will be added to the discussion below:
> http://r-sig-geo.2731867.n2.nabble.com/Bayesian-Estimates-for-1st-order-Spatial-Autoregressive-Model-tp7580687p7580698.html
> To unsubscribe from Bayesian Estimates for 1st-order Spatial Autoregressive Model, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7580687&code=YWRyaWFuLmF3LmNhcnRpZXJAbW9uc2FudG8uY29tfDc1ODA2ODd8MTIwNzA5NTU4Mw==>.
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
> This e-mail message may contain privileged and/or confidential information, and is intended to be received only by persons entitled
> to receive such information. If you have received this e-mail in error, please notify the sender immediately. Please delete it and
> all attachments from any servers, hard drives or any other media. Other use of this e-mail by you is strictly prohibited.
>
> All e-mails and attachments sent and received are subject to monitoring, reading and archival by Monsanto, including its
> subsidiaries. The recipient of this e-mail is solely responsible for checking for the presence of "Viruses" or other "Malware".
> Monsanto, along with its subsidiaries, accepts no liability for any damage caused by any such code transmitted by or accompanying
> this e-mail or any attachment.
>
>
> The information contained in this email may be subject to the export control laws and regulations of the United States, potentially
> including but not limited to the Export Administration Regulations (EAR) and sanctions regulations issued by the U.S. Department of
> Treasury, Office of Foreign Asset Controls (OFAC).  As a recipient of this information you are obligated to comply with all
> applicable U.S. export laws and regulations.
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bayesian-Estimates-for-1st-order-Spatial-Autoregressive-Model-tp7580687p7580708.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Thu Aug  9 21:48:15 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 09 Aug 2012 21:48:15 +0200
Subject: [R-sig-Geo] Empirical Variogram from multiple realizations
In-Reply-To: <CAJD8EJZxHaMAheQaebGWOhMBAnqeJOTVQasi2hxbqeKj=oYivA@mail.gmail.com>
References: <CAJD8EJZxHaMAheQaebGWOhMBAnqeJOTVQasi2hxbqeKj=oYivA@mail.gmail.com>
Message-ID: <502413FF.7010701@uni-muenster.de>

On 08/09/2012 06:59 PM, Jordan Winkler wrote:
> I am wondering if there is a methodology within R to calculate a single
> variogram based on multiple modeled realizations of the same process.  I am
> performing regressions on residual fields from multiple climate models.  I
> would like to estimate a covariance function common to all models.  I've
> tried using the variog function in geoR, however it does not work with
> multiple values at single coordinates.  Any advice would be appreciated
> 

By "common to all models" I assume you refer to "pooled", or "averaged
over all models". In that case, you can:

library(gstat)
loadMeuse()
v = fit.variogram(variogram(log(zinc)~1,meuse),vgm(1, "Sph", 900, 1))
sim = krige(log(zinc)~1, meuse, meuse.grid, v, nsim=20, nmax=30)
sim.stacked = stack(sim)
coordinates(sim.stacked) = ~x+y
v.pooled = variogram(values~ind, sim.stacked, dX = 0) # wait a while...
plot(v.pooled, v, ylim = c(0, .7))

please look into the dX argument of ?variogram (to get pooling over
different data sets), and look closely what stack() does. Note that in
~ind, in combination with dX ind is not used as predictor, but as
criterium to exclude point pairs coming from different models (those
with different values for ind).

Best regards,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From paulojus at c3sl.ufpr.br  Thu Aug  9 21:49:03 2012
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Thu, 9 Aug 2012 16:49:03 -0300 (BRT)
Subject: [R-sig-Geo] Empirical Variogram from multiple realizations
In-Reply-To: <CAJD8EJZxHaMAheQaebGWOhMBAnqeJOTVQasi2hxbqeKj=oYivA@mail.gmail.com>
References: <CAJD8EJZxHaMAheQaebGWOhMBAnqeJOTVQasi2hxbqeKj=oYivA@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1208091647330.26957@macalan.c3sl.ufpr.br>

Jordan

some (not all) functions of geoR accepts data as matrices and can compute 
variograms for multiple realizations

try organize your $data element as a matrix instead of replicate 
coordinates (in which case you could use the options realisations)

feel free to send me exemple codes if you wish


Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Thu, 9 Aug 2012, Jordan Winkler wrote:

> I am wondering if there is a methodology within R to calculate a single
> variogram based on multiple modeled realizations of the same process.  I am
> performing regressions on residual fields from multiple climate models.  I
> would like to estimate a covariance function common to all models.  I've
> tried using the variog function in geoR, however it does not work with
> multiple values at single coordinates.  Any advice would be appreciated
>
> -- 
> --
> Jordan R Winkler
> Visiting Scientist - National Center for Atmospheric Research
>
> Teaching Fellow / PhD Candidate
> Dept. of Earth and Environment
> Boston University
> 675 Commonwealth Avenue, STO 338
> Boston, MA 02215
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From ealaca at ucdavis.edu  Thu Aug  9 23:50:10 2012
From: ealaca at ucdavis.edu (Emilio A. Laca)
Date: Thu, 9 Aug 2012 14:50:10 -0700
Subject: [R-sig-Geo] large SpatialGridDataFrame 2 SpatialPixelsDataFrame
In-Reply-To: <3F552DF9-F1CA-43D1-8716-099D593DE27B@ucdavis.edu>
References: <3F552DF9-F1CA-43D1-8716-099D593DE27B@ucdavis.edu>
Message-ID: <5F5C7171-E403-4719-ADE2-3C68F7046521@ucdavis.edu>


I want to create a SpatialPixelsDataFrame from a large SpatialGridDataFrame called spbay.

> system.time(sspbay<-summary(spbay)); sspbay
   user  system elapsed 
  4.850   1.041   5.890 
Object of class SpatialGridDataFrame
Coordinates:
         min       max
[1,]  543399  552878.5
[2,] 4218224 4223463.0
Is projected: TRUE 
proj4string :
[+proj=utm +no_defs +zone=10 +a=6378137 +rf=298.257222101
+towgs84=0.000,0.000,0.000 +to_meter=1]
Grid attributes:
  cellcentre.offset cellsize cells.dim
1            543400 1.999906      4740
2           4218225 1.999658      2620
Data attributes:
  agricfxCropd      annualgrassfxCropd baresoilfxCropd   
 Min.   :  0        Min.   :  0        Min.   :  0       
 1st Qu.:  0        1st Qu.:  0        1st Qu.:  0       
 Median :  0        Median :  0        Median :  0       
 Mean   : 12        Mean   : 32        Mean   : 49       
 3rd Qu.:  0        3rd Qu.:  0        3rd Qu.:  0       
 Max.   :996        Max.   :996        Max.   :996       
 NA's   :10290347   NA's   :10290347   NA's   :10290347  
 bulrushfxCropd     channelDensityCropd cordgrassfxCropd  
 Min.   :  0        Min.   :  0         Min.   :  0       
 1st Qu.:  0        1st Qu.:  0         1st Qu.:  0       
 Median :  0        Median :  0         Median :  0       
 Mean   : 46        Mean   :  6         Mean   : 58       
 3rd Qu.:  0        3rd Qu.:  8         3rd Qu.:  0       
 Max.   :996        Max.   :132         Max.   :996       
 NA's   :10290347   NA's   :10290121    NA's   :10290347  
 dist2bayCropd      dist2channelCropd  lela2005fxCropd   
 Min.   :   0       Min.   :   0       Min.   :    0     
 1st Qu.: 180       1st Qu.: 100       1st Qu.:    0     
 Median : 454       Median : 100       Median :    0     
 Mean   : 668       Mean   : 354       Mean   :  558     
 3rd Qu.: 888       3rd Qu.: 504       3rd Qu.:    0     
 Max.   :3270       Max.   :1000       Max.   :77520     
 NA's   :10289345   NA's   :11255037   NA's   :10399863  
 lela2010Cropd      lela2005Cropd       leveefxCropd       lidar2mCropd    
 Min.   : 0         Min.   : 0         Min.   :   0       Min.   :-6       
 1st Qu.: 0         1st Qu.: 0         1st Qu.:   0       1st Qu.: 1       
 Median : 0         Median : 0         Median :   0       Median : 2       
 Mean   : 0         Mean   : 1         Mean   :  24       Mean   : 2       
 3rd Qu.: 0         3rd Qu.: 0         3rd Qu.:   0       3rd Qu.: 2       
 Max.   :17         Max.   :80         Max.   :1011       Max.   :67       
 NA's   :10290121   NA's   :10290121   NA's   :10399863   NA's   :9986331  
 pickleweedfxCropd  saltgrassfxCropd   topoindxCropd      urbanfxCropd     
 Min.   :  0        Min.   :  0        Min.   :-10       Min.   :  0       
 1st Qu.:  0        1st Qu.:  0        1st Qu.:  4       1st Qu.:  0       
 Median :209        Median :  0        Median :  5       Median :  0       
 Mean   :445        Mean   :  4        Mean   :  5       Mean   :  1       
 3rd Qu.:996        3rd Qu.:  0        3rd Qu.:  6       3rd Qu.:  0       
 Max.   :996        Max.   :996        Max.   : 18       Max.   :996       
 NA's   :10290347   NA's   :10290347   NA's   :9986190   NA's   :10290347  
  waterfxCropd     
 Min.   :  0       
 1st Qu.:  0       
 Median :  0       
 Mean   :331       
 3rd Qu.:995       
 Max.   :996       
 NA's   :10290347  

> spbay.spxldf <- as(spbay, "SpatialPixelsDataFrame")  #ran overnight; OS almost non-responsive, had to Force quit.


As indicated in my comment, my computer was not able to effect the conversion after 8 hours running (hung up?).
 Model Name:	MacBook Pro
  Model Identifier:	MacBookPro8,2
  Processor Name:	Intel Core i7
  Processor Speed:	2.4 GHz
  Number of Processors:	1
  Total Number of Cores:	4
  L2 Cache (per Core):	256 KB
  L3 Cache:	6 MB
  Memory:	16 GB

I would appreciate suggestions on how to proceed with this data set. I want to use it for geostatistical and spatial regression analyses. I hope that the size will be significantly reduced by converting to spxdf.
Many thanks,


Emilio A. Laca


From macqueen1 at llnl.gov  Fri Aug 10 01:35:29 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Thu, 9 Aug 2012 16:35:29 -0700
Subject: [R-sig-Geo] New (?) use of polypath() in package sp causing a
	problem?
Message-ID: <CC499751.A5E9B%macqueen1@llnl.gov>

I have encountered a problem I've never seen before.

The problem is:

> x11(type='Xlib')
> plot(sfbound)
Warning message:
In polypath(x = mcrds[, 1], y = mcrds[, 2], border = border, col = col, :
Path drawing not available for this device

And nothing is plotted.

The object sfbound is a SpatialPolygonsDataFrame object with one simple
polygon in it. 
Previously I have had no problem plotting such objects with
x11(type='Xlib').x11(type='cairo') succeeds.


It looks very likely that this relates to this entry in NEWS for R 2.12.0:

-- quote --
Added support for polygons with holes to the graphics
engine. This is implemented for the pdf(),
postscript(), x11(type="cairo"), windows(),
and quartz() devices (and associated raster formats),
but not for x11(type="Xlib") or xfig() or
pictex(). The user-level interface is the
polypath() function in graphics and
grid.path() in grid.
-- end quote --

That is, presuming a relatively recent change in sp in which polyplot() is
now used and previously was not, the change described in NEWS would
explain why I'm seeing this.



The problem is, I have found that for plots in which a very large number
of objects are being plotted, the Xlib version of X11() is much faster
than the cairo version. And I frequently plot spatial objects with
thousands of line segments in them, where the performance difference is
substantial, to the point of making use of the cairo version intolerable.

I guess the question is -- am I correct in this analysis?
If so, do I have any alternative when I need to plot spatial objects with
huge numbers of points/lines/polygons in them?

Thanks
-Don


> str(sfbound)
Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 1 obs. of  1 variable:
  .. ..$ name: Factor w/ 1 level "Boundary.kml": 1
  ..@ polygons   :List of 1
  .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
  .. .. .. ..@ Polygons :List of 1
  .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
  .. .. .. .. .. .. ..@ labpt  : num [1:2] -121.7 37.7
  .. .. .. .. .. .. ..@ area   : num 3.71e-06
  .. .. .. .. .. .. ..@ hole   : logi FALSE
  .. .. .. .. .. .. ..@ ringDir: int 1
  .. .. .. .. .. .. ..@ coords : num [1:8, 1:2] -122 -122 -122 -122 -122
...
  .. .. .. ..@ plotOrder: int 1
  .. .. .. ..@ labpt    : num [1:2] -121.7 37.7
  .. .. .. ..@ ID       : chr "1"
  .. .. .. ..@ area     : num 3.71e-06
  ..@ plotOrder  : int 1
  ..@ bbox       : num [1:2, 1:2] -121.7 37.7 -121.7 37.7
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x" "y"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr "+proj=longlat +ellps=GRS80 +datum=NAD83
+no_defs +towgs84=0,0,0"


> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] sp_0.9-99   rmacq_1.1-8

loaded via a namespace (and not attached):
[1] grid_2.15.1    lattice_0.20-6 tools_2.15.1

	

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062


From Maximilian.Spross at uibk.ac.at  Fri Aug 10 08:53:24 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-15?Q?Maximilian_Spro=DF?=)
Date: Fri, 10 Aug 2012 08:53:24 +0200
Subject: [R-sig-Geo] gwr, calculate hatmatrix when fit points are given
In-Reply-To: <alpine.LRH.2.02.1208091359410.26060@reclus.nhh.no>
References: <502395B0.6080103@uibk.ac.at>
	<alpine.LRH.2.02.1208091359410.26060@reclus.nhh.no>
Message-ID: <5024AFE4.4060701@uibk.ac.at>

Ok, thank you for clarifying Roger!

best wishes,

Max

On 08/09/2012 02:15 PM, Roger Bivand wrote:
> On Thu, 9 Aug 2012, Maximilian Spro? wrote:
>
>> Dear list,
>>
>>
>> when running gwr() with given fit.points, it is not possible to 
>> calculate the hatmatrix. But it would be very helpful to get the 
>> fitting characteristics such as AIC or RMSE with the gwr output. In 
>> my case the fit points have to be set, as i run gwr on a cluster.
>
> According to information from the authors, it seems that GWR3 fits 
> without fit points first to generate a hat matrix for the data points. 
> This is then used in a further step for the fit points, for which no 
> covariates are observed. The assumption is that #data points << #fit 
> points, as when making a raster. This may be done I think by doing the 
> same, first running gwr() on the data points only and making the hat 
> matrix, next fitting on the fit points and including the output of the 
> first step in the fittedGWRobject= argument. However, the fitted 
> object will only help in giving local R2 (GWR4 version), and local 
> coefficient and prediction standard errors, not AIC.
>
> Roger
>
>>
>> I appreciate if anyone can help!
>>
>> all the best,
>>
>> Max
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


-- 
Mag. J. Maximilian Spro?
Institute of Geography, University of Innsbruck
Innrain 52
A-6020 INNSBRUCK

Tel. +43 (0)512 507 5413
web: http://www.uibk.ac.at/geographie/projects/lidar/


From Roger.Bivand at nhh.no  Fri Aug 10 10:04:05 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 10 Aug 2012 10:04:05 +0200 (CEST)
Subject: [R-sig-Geo] New (?) use of polypath() in package sp causing a
 problem?
In-Reply-To: <CC499751.A5E9B%macqueen1@llnl.gov>
References: <CC499751.A5E9B%macqueen1@llnl.gov>
Message-ID: <alpine.LRH.2.02.1208100955090.30847@reclus.nhh.no>

On Fri, 10 Aug 2012, MacQueen, Don wrote:

> I have encountered a problem I've never seen before.
>
> The problem is:
>
>> x11(type='Xlib')
>> plot(sfbound)
> Warning message:
> In polypath(x = mcrds[, 1], y = mcrds[, 2], border = border, col = col, :
> Path drawing not available for this device
>
> And nothing is plotted.
>
> The object sfbound is a SpatialPolygonsDataFrame object with one simple
> polygon in it.
> Previously I have had no problem plotting such objects with
> x11(type='Xlib').x11(type='cairo') succeeds.
>
>
> It looks very likely that this relates to this entry in NEWS for R 2.12.0:
>
> -- quote --
> Added support for polygons with holes to the graphics
> engine. This is implemented for the pdf(),
> postscript(), x11(type="cairo"), windows(),
> and quartz() devices (and associated raster formats),
> but not for x11(type="Xlib") or xfig() or
> pictex(). The user-level interface is the
> polypath() function in graphics and
> grid.path() in grid.
> -- end quote --
>
> That is, presuming a relatively recent change in sp in which polyplot() is
> now used and previously was not, the change described in NEWS would
> explain why I'm seeing this.
>
>
>
> The problem is, I have found that for plots in which a very large number
> of objects are being plotted, the Xlib version of X11() is much faster
> than the cairo version. And I frequently plot spatial objects with
> thousands of line segments in them, where the performance difference is
> substantial, to the point of making use of the cairo version intolerable.
>
> I guess the question is -- am I correct in this analysis?
> If so, do I have any alternative when I need to plot spatial objects with
> huge numbers of points/lines/polygons in them?

Don,

The analysis is correct (r1248). If the hole status of Polygon objects is 
known to be correct, and the par(bg=) and pbg= values are set to match, 
the plots will be the same. polypath analyses the polygon rings itself and 
provides transparency in polygon painting - it doesn't paint in holes. The 
legacy polygon function first painted the whole exterior ring, then 
overpainted holes with the pbg= colour, which is "transparent" by default. 
For many purposes, polypath is preferable, but as you know, cairo is much 
slower than X11. So using X11 ought still to be OK, in the plot method set 
usePolypath=FALSE. We can add back an option and set the argument by 
default to that option if that would help.

The details for the plot method in the code:

https://r-forge.r-project.org/scm/viewvc.php/pkg/sp/R/SpatialPolygons-displayMethods.R?root=rspatial&view=log

and for spplot methods look in the same repository.

Hope this helps,

Roger

>
> Thanks
> -Don
>
>
>> str(sfbound)
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>  ..@ data       :'data.frame': 1 obs. of  1 variable:
>  .. ..$ name: Factor w/ 1 level "Boundary.kml": 1
>  ..@ polygons   :List of 1
>  .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
>  .. .. .. ..@ Polygons :List of 1
>  .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
>  .. .. .. .. .. .. ..@ labpt  : num [1:2] -121.7 37.7
>  .. .. .. .. .. .. ..@ area   : num 3.71e-06
>  .. .. .. .. .. .. ..@ hole   : logi FALSE
>  .. .. .. .. .. .. ..@ ringDir: int 1
>  .. .. .. .. .. .. ..@ coords : num [1:8, 1:2] -122 -122 -122 -122 -122
> ...
>  .. .. .. ..@ plotOrder: int 1
>  .. .. .. ..@ labpt    : num [1:2] -121.7 37.7
>  .. .. .. ..@ ID       : chr "1"
>  .. .. .. ..@ area     : num 3.71e-06
>  ..@ plotOrder  : int 1
>  ..@ bbox       : num [1:2, 1:2] -121.7 37.7 -121.7 37.7
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : chr [1:2] "x" "y"
>  .. .. ..$ : chr [1:2] "min" "max"
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr "+proj=longlat +ellps=GRS80 +datum=NAD83
> +no_defs +towgs84=0,0,0"
>
>
>> sessionInfo()
> R version 2.15.1 (2012-06-22)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_0.9-99   rmacq_1.1-8
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.1    lattice_0.20-6 tools_2.15.1
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Fri Aug 10 10:25:14 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 10 Aug 2012 10:25:14 +0200
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
	(through rgdal?)
Message-ID: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>

I've just noted that files created with writeRaster() have wrong stats
(which is a problem later in Qgis, for example).
Not sure if writeRaster() uses rgdal, in that case the problem might
be more general:

> delme <- subset(adlstest,c("B48","B31","B21"))
> summary(delme)
Cells:  1089
NAs  :  0 0 0

           1    2    3
Min.    2563 3491 3822
1st Qu. 2700 3636 3971
Median  2764 3691 4009
Mean    2781 3699 4014
3rd Qu. 2862 3765 4055
Max.    3629 3979 4258

> GDALinfo("delme.tif")
rows        33
columns     33
bands       3
origin.x        648490.8
origin.y        7058623
res.x       29.9746
res.y       29.99077
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
file        delme.tif
apparent band summary:
   GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
1 Float32 2563 3629     0   0           TRUE           0
2 Float32 3491 3979     0   0           TRUE           0
3 Float32 3822 4258     0   0           TRUE           0
Metadata:
AREA_OR_POINT=Area

Note the 0 means and sd !

adlstest here:
http://dl.dropbox.com/u/3180464/adlstest.rda

Agus

> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99

loaded via a namespace (and not attached):
[1] grid_2.15.1     lattice_0.19-30 tools_2.15.1


From jmblanco at ub.edu  Fri Aug 10 15:13:05 2012
From: jmblanco at ub.edu (JOSE MANUEL BLANCO MORENO)
Date: Fri, 10 Aug 2012 13:13:05 +0000
Subject: [R-sig-Geo] spatstat::affine.im
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D78C8@daumbpro03.da.ub.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120810/da0a06e4/attachment.pl>

From pep.bioalerts at gmail.com  Fri Aug 10 15:21:52 2012
From: pep.bioalerts at gmail.com (Josep M Serra diaz)
Date: Fri, 10 Aug 2012 15:21:52 +0200
Subject: [R-sig-Geo] Correlation between two variables in the presence of SA,
	dutilleul's method?
Message-ID: <CAF8H1dd8N+cEVU2gs5atdk4bUDmOmDmu6J=+fW6os4pPW6Aexw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120810/02e391d9/attachment.pl>

From jmblanco at ub.edu  Fri Aug 10 16:20:03 2012
From: jmblanco at ub.edu (JOSE MANUEL BLANCO MORENO)
Date: Fri, 10 Aug 2012 14:20:03 +0000
Subject: [R-sig-Geo] spatstat::affine.im
In-Reply-To: <BBF61FDBC9E7254991EFE852E9BC93803A9D78C8@daumbpro03.da.ub.edu>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D78C8@daumbpro03.da.ub.edu>
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D78E9@daumbpro03.da.ub.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120810/b3e69bb7/attachment.pl>

From jmblanco at ub.edu  Fri Aug 10 16:31:28 2012
From: jmblanco at ub.edu (JOSE MANUEL BLANCO MORENO)
Date: Fri, 10 Aug 2012 14:31:28 +0000
Subject: [R-sig-Geo] Correlation between two variables in the presence
	of SA
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D78F5@daumbpro03.da.ub.edu>

I implemented some time ago Dutilleul's correction in a minimal package (not submitted to R-Project, because it only contains that, Dutilleul's correction as well as accessory functions). It is a re-implementation of Pierre Legendre's fortran program. I can send it to you if interested.

Cheers,
Jos? M.


---------------------------------------
Jos? M. Blanco-Moreno
Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 643
08028 Barcelona
SPAIN
---------------------------------------
phone: (+34) 934 039 863
fax: (+34) 934 112 842
---------------------------------------


Aquest correu electr?nic i els annexos poden contenir informaci? confidencial o protegida legalment i est? adre?at exclusivament a la persona o entitat destinat?ria. Si no sou el destinatari final o la persona encarregada de rebre?l, no esteu autoritzat a llegir-lo, retenir-lo, modificar-lo, distribuir-lo, copiar-lo ni a revelar-ne el contingut. Si heu rebut aquest correu electr?nic per error, us preguem que n?informeu al remitent i que elimineu del sistema el missatge i el material annex que pugui contenir. Gr?cies per la vostra col?laboraci?.

Este correo electr?nico y sus anexos pueden contener informaci?n confidencial o legalmente protegida y est? exclusivamente dirigido a la persona o entidad destinataria. Si usted no es el destinatario final o la persona encargada de recibirlo, no est? autorizado a leerlo, retenerlo, modificarlo, distribuirlo, copiarlo ni a revelar su contenido. Si ha recibido este mensaje electr?nico por error, le rogamos que informe al remitente y elimine del sistema el mensaje y el material anexo que pueda contener. Gracias por su colaboraci?n.

This email message and any documents attached to it may contain confidential or legally protected material and are intended solely for the use of the individual or organization to whom they are addressed. We remind you that if you are not the intended recipient of this email message or the person responsible for processing it, then you are not authorized to read, save, modify, send, copy or disclose any of its contents. If you have received this email message by mistake, we kindly ask you to inform the sender of this and to eliminate both the message and any attachments it carries from your account. Thank you for your collaboration.

From macqueen1 at llnl.gov  Fri Aug 10 18:43:04 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 10 Aug 2012 09:43:04 -0700
Subject: [R-sig-Geo] New (?) use of polypath() in package sp causing a
 problem?
In-Reply-To: <alpine.LRH.2.02.1208100955090.30847@reclus.nhh.no>
Message-ID: <CC4A7DE4.A6020%macqueen1@llnl.gov>

(see below)


On 8/10/12 1:04 AM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

>On Fri, 10 Aug 2012, MacQueen, Don wrote:
>
>> I have encountered a problem I've never seen before.
>>
>> The problem is:
>>
>>> x11(type='Xlib')
>>> plot(sfbound)
>> Warning message:
>> In polypath(x = mcrds[, 1], y = mcrds[, 2], border = border, col = col,
>>:
>> Path drawing not available for this device
>>
>> And nothing is plotted.
>>
>> The object sfbound is a SpatialPolygonsDataFrame object with one simple
>> polygon in it.
>> Previously I have had no problem plotting such objects with
>> x11(type='Xlib').x11(type='cairo') succeeds.
>>
>>
>> It looks very likely that this relates to this entry in NEWS for R
>>2.12.0:
>>
>> -- quote --
>> Added support for polygons with holes to the graphics
>> engine. This is implemented for the pdf(),
>> postscript(), x11(type="cairo"), windows(),
>> and quartz() devices (and associated raster formats),
>> but not for x11(type="Xlib") or xfig() or
>> pictex(). The user-level interface is the
>> polypath() function in graphics and
>> grid.path() in grid.
>> -- end quote --
>>
>> That is, presuming a relatively recent change in sp in which polyplot()
>>is
>> now used and previously was not, the change described in NEWS would
>> explain why I'm seeing this.
>>
>>
>>
>> The problem is, I have found that for plots in which a very large number
>> of objects are being plotted, the Xlib version of X11() is much faster
>> than the cairo version. And I frequently plot spatial objects with
>> thousands of line segments in them, where the performance difference is
>> substantial, to the point of making use of the cairo version
>>intolerable.
>>
>> I guess the question is -- am I correct in this analysis?
>> If so, do I have any alternative when I need to plot spatial objects
>>with
>> huge numbers of points/lines/polygons in them?
>
>Don,
>
>The analysis is correct (r1248). If the hole status of Polygon objects is
>known to be correct, and the par(bg=) and pbg= values are set to match,
>the plots will be the same. polypath analyses the polygon rings itself
>and 
>provides transparency in polygon painting - it doesn't paint in holes.
>The 
>legacy polygon function first painted the whole exterior ring, then
>overpainted holes with the pbg= colour, which is "transparent" by
>default. 
>For many purposes, polypath is preferable, but as you know, cairo is much
>slower than X11. So using X11 ought still to be OK, in the plot method
>set 
>usePolypath=FALSE. We can add back an option and set the argument by
>default to that option if that would help.
>
>The details for the plot method in the code:
>
>https://r-forge.r-project.org/scm/viewvc.php/pkg/sp/R/SpatialPolygons-disp
>layMethods.R?root=rspatial&view=log
>
>and for spplot methods look in the same repository.
>
>Hope this helps,
>
>Roger

It does help, especially the pointer to usePolypath=FALSE, which lets me
plot with X11/Xlib. Thank you.

In terms of adding back an option, would that be a global option of some
sort, so that users like me don't have to supply usePolypath=FALSE every
time?  That would indeed be helpful, if it's not too much trouble.

-Don

>
>>
>> Thanks
>> -Don
>>
>>
>>> str(sfbound)
>> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>>  ..@ data       :'data.frame': 1 obs. of  1 variable:
>>  .. ..$ name: Factor w/ 1 level "Boundary.kml": 1
>>  ..@ polygons   :List of 1
>>  .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
>>  .. .. .. ..@ Polygons :List of 1
>>  .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
>>  .. .. .. .. .. .. ..@ labpt  : num [1:2] -121.7 37.7
>>  .. .. .. .. .. .. ..@ area   : num 3.71e-06
>>  .. .. .. .. .. .. ..@ hole   : logi FALSE
>>  .. .. .. .. .. .. ..@ ringDir: int 1
>>  .. .. .. .. .. .. ..@ coords : num [1:8, 1:2] -122 -122 -122 -122 -122
>> ...
>>  .. .. .. ..@ plotOrder: int 1
>>  .. .. .. ..@ labpt    : num [1:2] -121.7 37.7
>>  .. .. .. ..@ ID       : chr "1"
>>  .. .. .. ..@ area     : num 3.71e-06
>>  ..@ plotOrder  : int 1
>>  ..@ bbox       : num [1:2, 1:2] -121.7 37.7 -121.7 37.7
>>  .. ..- attr(*, "dimnames")=List of 2
>>  .. .. ..$ : chr [1:2] "x" "y"
>>  .. .. ..$ : chr [1:2] "min" "max"
>>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>>  .. .. ..@ projargs: chr "+proj=longlat +ellps=GRS80 +datum=NAD83
>> +no_defs +towgs84=0,0,0"
>>
>>
>>> sessionInfo()
>> R version 2.15.1 (2012-06-22)
>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>
>> locale:
>> [1] C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] sp_0.9-99   rmacq_1.1-8
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.1    lattice_0.20-6 tools_2.15.1
>>
>>
>>
>>
>
>-- 
>Roger Bivand
>Department of Economics, NHH Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no
>

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062


From marcelino.delacruz at upm.es  Fri Aug 10 20:43:57 2012
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Fri, 10 Aug 2012 19:43:57 +0100
Subject: [R-sig-Geo] spatstat::affine.im
In-Reply-To: <BBF61FDBC9E7254991EFE852E9BC93803A9D78E9@daumbpro03.da.ub.edu>
Message-ID: <ULDI3GES.1344624237.9580080.marcelino.delacruz@upm.es>

Hi Jose Manuel,

I don't think it is exactly a bug. Just try indicating the dimensions of
the resulting image:


> vec <- rnorm(1200)
> mat <- matrix(vec, nrow=30, ncol=40)
> whitenoise <- im(mat)
> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)),dimyx=c(30,40))
> whitenoise2
real-valued pixel image
30 x 40 pixel array (ny, nx)
enclosing rectangle: [1, 81] x [1.5, 91.5] units

Cheers,

Marcelino



Con fecha 10/8/2012, "JOSE MANUEL BLANCO MORENO" <jmblanco at ub.edu>
escribi?:

>Regarding my previous query, the problem is in fact in line 22-23 of function affine.im, when calling affinexy; when calling affine.im for a rectangular image but applying a non-diagonal matrix, there is no problem, because affinexy is not executed.
>
>
>
>This example does not work (as  before):
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>
>
>But this one does:
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=matrix(c(1,8,8,1), ncol=2))
>
>
>
>Looks like a bug?
>
>---------------------------------------
>Jos? M. Blanco-Moreno
>Dept. de Biologia Vegetal (Bot?nica)
>Facultat de Biologia
>Universitat de Barcelona
>Av. Diagonal 643
>08028 Barcelona
>SPAIN
>---------------------------------------
>phone: (+34) 934 039 863
>fax: (+34) 934 112 842
>---------------------------------------
>
>________________________________
>De: JOSE MANUEL BLANCO MORENO
>Enviat el: divendres, 10 / agost / 2012 15:13
>Per a: r-sig-geo at r-project.org
>Tema: spatstat::affine.im
>
>
>Dear users & experts,
>
>
>
>Does anyone know if affine transformation of images (function affine.im in spatstat) should work for non-square images? I thought it should, but I have tried:
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>
>
>But I get:
>
>
>
>Error in im(v, xcol = xcol, yrow = yrow, xrange = newbox$xrange, yrange = newbox$yrange,  :
>  Length of yrow does not match nrow(mat)
>In addition: Warning message:
>In rbind(X$x, X$y) :
>  number of columns of result is not a multiple of vector length (arg 2)
>
>
>
>However if I modify the example allowing for a square image it works perfectly:
>
>
>
>vec <- rnorm(900)
>mat <- matrix(vec, nrow=30, ncol=30)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>And the only difference that I can spot between these matrices/images is the shape of the image itself.
>
>
>
>Affine should work for non-square images, isn't it? Or I am wrong? Is there any way to circumvent this problem?
>
>
>
>These are version details:
>
>R version 2.15.1 (2012-06-22)
>Platform: i386-pc-mingw32/i386 (32-bit)
>
>locale:
>[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
>[4] LC_NUMERIC=C                           LC_TIME=English_United States1252
>
>attached base packages:
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>other attached packages:
>[1] spatstat_1.28-1 deldir_0.0-19   mgcv_1.7-18
>
>loaded via a namespace (and not attached):
>[1] grid_2.15.1    lattice_0.20-6 Matrix_1.0-6   nlme_3.1-104   tools_2.15.1
>
>
>
>---------------------------------------
>Jos? M. Blanco-Moreno
>Dept. de Biologia Vegetal (Bot?nica)
>Facultat de Biologia
>Universitat de Barcelona
>Av. Diagonal 643
>08028 Barcelona
>SPAIN
>---------------------------------------
>phone: (+34) 934 039 863
>fax: (+34) 934 112 842
>---------------------------------------
>
>
>Aquest correu electr?nic i els annexos poden contenir informaci? confidencial o protegida legalment i est? adre?at exclusivament a la persona o entitat destinat?ria. Si no sou el destinatari final o la persona encarregada de rebre'l, no esteu autoritzat a llegir-lo, retenir-lo, modificar-lo, distribuir-lo, copiar-lo ni a revelar-ne el contingut. Si heu rebut aquest correu electr?nic per error, us preguem que n'informeu al remitent i que elimineu del sistema el missatge i el material annex que pugui contenir. Gr?cies per la vostra col?laboraci?.
>
>Este correo electr?nico y sus anexos pueden contener informaci?n confidencial o legalmente protegida y est? exclusivamente dirigido a la persona o entidad destinataria. Si usted no es el destinatario final o la persona encargada de recibirlo, no est? autorizado a leerlo, retenerlo, modificarlo, distribuirlo, copiarlo ni a revelar su contenido. Si ha recibido este mensaje electr?nico por error, le rogamos que informe al remitente y elimine del sistema el mensaje y el material anexo que pueda contener. Gracias por su colaboraci?n.
>
>This email message and any documents attached to it may contain confidential or legally protected material and are intended solely for the use of the individual or organization to whom they are addressed. We remind you that if you are not the intended recipient of this email message or the person responsible for processing it, then you are not authorized to read, save, modify, send, copy or disclose any of its contents. If you have received this email message by mistake, we kindly ask you to inform the sender of this and to eliminate both the message and any attachments it carries from your account. Thank you for your collaboration.
>
>	[[alternative HTML version deleted]]
>


From jmblanco at ub.edu  Fri Aug 10 21:17:37 2012
From: jmblanco at ub.edu (JOSE MANUEL BLANCO MORENO)
Date: Fri, 10 Aug 2012 19:17:37 +0000
Subject: [R-sig-Geo] spatstat::affine.im
In-Reply-To: <ULDI3GES.1344624237.9580080.marcelino.delacruz@upm.es>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D78E9@daumbpro03.da.ub.edu>
	<ULDI3GES.1344624237.9580080.marcelino.delacruz@upm.es>
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D79F3@daumbpro03.da.ub.edu>

Well... it is curious that an optional argument for a subjacent function is needed to make the main function work...

This would not work:
> whitenoise2 <- affine(whitenoise, vec=c(-2,0))

And these would, even though the second result was not the intended!!
> whitenoise3 <- affine(whitenoise, vec=c(-20, 0), dimyx = c(30, 40))
> whitenoise4 <- affine(whitenoise, vec=c(-20, 0), dimyx = c(40, 30))

Perhaps is not a bug, but then it should be documented (?)

---------------------------------------
Jos? M. Blanco-Moreno
Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 643
08028 Barcelona
SPAIN
---------------------------------------
phone: (+34) 934 039 863
fax: (+34) 934 112 842
---------------------------------------

________________________________________
De: marcelino.delacruz at upm.es [marcelino.delacruz at upm.es]
Enviat el: divendres, 10 / agost / 2012 20:43
Per a: JOSE MANUEL BLANCO MORENO; r-sig-geo at r-project.org
Tema: Re: [R-sig-Geo] spatstat::affine.im

Hi Jose Manuel,

I don't think it is exactly a bug. Just try indicating the dimensions of
the resulting image:


> vec <- rnorm(1200)
> mat <- matrix(vec, nrow=30, ncol=40)
> whitenoise <- im(mat)
> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)),dimyx=c(30,40))
> whitenoise2
real-valued pixel image
30 x 40 pixel array (ny, nx)
enclosing rectangle: [1, 81] x [1.5, 91.5] units

Cheers,

Marcelino



Con fecha 10/8/2012, "JOSE MANUEL BLANCO MORENO" <jmblanco at ub.edu>
escribi?:

>Regarding my previous query, the problem is in fact in line 22-23 of function affine.im, when calling affinexy; when calling affine.im for a rectangular image but applying a non-diagonal matrix, there is no problem, because affinexy is not executed.
>
>
>
>This example does not work (as  before):
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>
>
>But this one does:
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=matrix(c(1,8,8,1), ncol=2))
>
>
>
>Looks like a bug?
>
>---------------------------------------
>Jos? M. Blanco-Moreno
>Dept. de Biologia Vegetal (Bot?nica)
>Facultat de Biologia
>Universitat de Barcelona
>Av. Diagonal 643
>08028 Barcelona
>SPAIN
>---------------------------------------
>phone: (+34) 934 039 863
>fax: (+34) 934 112 842
>---------------------------------------
>
>________________________________
>De: JOSE MANUEL BLANCO MORENO
>Enviat el: divendres, 10 / agost / 2012 15:13
>Per a: r-sig-geo at r-project.org
>Tema: spatstat::affine.im
>
>
>Dear users & experts,
>
>
>
>Does anyone know if affine transformation of images (function affine.im in spatstat) should work for non-square images? I thought it should, but I have tried:
>
>
>
>vec <- rnorm(1200)
>mat <- matrix(vec, nrow=30, ncol=40)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>
>
>But I get:
>
>
>
>Error in im(v, xcol = xcol, yrow = yrow, xrange = newbox$xrange, yrange = newbox$yrange,  :
>  Length of yrow does not match nrow(mat)
>In addition: Warning message:
>In rbind(X$x, X$y) :
>  number of columns of result is not a multiple of vector length (arg 2)
>
>
>
>However if I modify the example allowing for a square image it works perfectly:
>
>
>
>vec <- rnorm(900)
>mat <- matrix(vec, nrow=30, ncol=30)
>whitenoise <- im(mat)
>whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>
>And the only difference that I can spot between these matrices/images is the shape of the image itself.
>
>
>
>Affine should work for non-square images, isn't it? Or I am wrong? Is there any way to circumvent this problem?
>
>
>
>These are version details:
>
>R version 2.15.1 (2012-06-22)
>Platform: i386-pc-mingw32/i386 (32-bit)
>
>locale:
>[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
>[4] LC_NUMERIC=C                           LC_TIME=English_United States1252
>
>attached base packages:
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>other attached packages:
>[1] spatstat_1.28-1 deldir_0.0-19   mgcv_1.7-18
>
>loaded via a namespace (and not attached):
>[1] grid_2.15.1    lattice_0.20-6 Matrix_1.0-6   nlme_3.1-104   tools_2.15.1
>
>
>
>---------------------------------------
>Jos? M. Blanco-Moreno
>Dept. de Biologia Vegetal (Bot?nica)
>Facultat de Biologia
>Universitat de Barcelona
>Av. Diagonal 643
>08028 Barcelona
>SPAIN
>---------------------------------------
>phone: (+34) 934 039 863
>fax: (+34) 934 112 842
>---------------------------------------
>
>
>Aquest correu electr?nic i els annexos poden contenir informaci? confidencial o protegida legalment i est? adre?at exclusivament a la persona o entitat destinat?ria. Si no sou el destinatari final o la persona encarregada de rebre'l, no esteu autoritzat a llegir-lo, retenir-lo, modificar-lo, distribuir-lo, copiar-lo ni a revelar-ne el contingut. Si heu rebut aquest correu electr?nic per error, us preguem que n'informeu al remitent i que elimineu del sistema el missatge i el material annex que pugui contenir. Gr?cies per la vostra col?laboraci?.
>
>Este correo electr?nico y sus anexos pueden contener informaci?n confidencial o legalmente protegida y est? exclusivamente dirigido a la persona o entidad destinataria. Si usted no es el destinatario final o la persona encargada de recibirlo, no est? autorizado a leerlo, retenerlo, modificarlo, distribuirlo, copiarlo ni a revelar su contenido. Si ha recibido este mensaje electr?nico por error, le rogamos que informe al remitente y elimine del sistema el mensaje y el material anexo que pueda contener. Gracias por su colaboraci?n.
>
>This email message and any documents attached to it may contain confidential or legally protected material and are intended solely for the use of the individual or organization to whom they are addressed. We remind you that if you are not the intended recipient of this email message or the person responsible for processing it, then you are not authorized to read, save, modify, send, copy or disclose any of its contents. If you have received this email message by mistake, we kindly ask you to inform the sender of this and to eliminate both the message and any attachments it carries from your account. Thank you for your collaboration.
>
>       [[alternative HTML version deleted]]
>

From Roger.Bivand at nhh.no  Fri Aug 10 22:11:31 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 10 Aug 2012 22:11:31 +0200 (CEST)
Subject: [R-sig-Geo] New (?) use of polypath() in package sp causing a
 problem?
In-Reply-To: <CC4A7DE4.A6020%macqueen1@llnl.gov>
References: <CC4A7DE4.A6020%macqueen1@llnl.gov>
Message-ID: <alpine.LRH.2.02.1208102204460.32316@reclus.nhh.no>

On Fri, 10 Aug 2012, MacQueen, Don wrote:

> (see below)
>
>
> On 8/10/12 1:04 AM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 10 Aug 2012, MacQueen, Don wrote:
>>
>>> I have encountered a problem I've never seen before.
>>>
>>> The problem is:
>>>
>>>> x11(type='Xlib')
>>>> plot(sfbound)
>>> Warning message:
>>> In polypath(x = mcrds[, 1], y = mcrds[, 2], border = border, col = col,
>>> :
>>> Path drawing not available for this device
>>>
>>> And nothing is plotted.
>>>
>>> The object sfbound is a SpatialPolygonsDataFrame object with one simple
>>> polygon in it.
>>> Previously I have had no problem plotting such objects with
>>> x11(type='Xlib').x11(type='cairo') succeeds.
>>>
>>>
>>> It looks very likely that this relates to this entry in NEWS for R
>>> 2.12.0:
>>>
>>> -- quote --
>>> Added support for polygons with holes to the graphics
>>> engine. This is implemented for the pdf(),
>>> postscript(), x11(type="cairo"), windows(),
>>> and quartz() devices (and associated raster formats),
>>> but not for x11(type="Xlib") or xfig() or
>>> pictex(). The user-level interface is the
>>> polypath() function in graphics and
>>> grid.path() in grid.
>>> -- end quote --
>>>
>>> That is, presuming a relatively recent change in sp in which polyplot()
>>> is
>>> now used and previously was not, the change described in NEWS would
>>> explain why I'm seeing this.
>>>
>>>
>>>
>>> The problem is, I have found that for plots in which a very large number
>>> of objects are being plotted, the Xlib version of X11() is much faster
>>> than the cairo version. And I frequently plot spatial objects with
>>> thousands of line segments in them, where the performance difference is
>>> substantial, to the point of making use of the cairo version
>>> intolerable.
>>>
>>> I guess the question is -- am I correct in this analysis?
>>> If so, do I have any alternative when I need to plot spatial objects
>>> with
>>> huge numbers of points/lines/polygons in them?
>>
>> Don,
>>
>> The analysis is correct (r1248). If the hole status of Polygon objects is
>> known to be correct, and the par(bg=) and pbg= values are set to match,
>> the plots will be the same. polypath analyses the polygon rings itself
>> and
>> provides transparency in polygon painting - it doesn't paint in holes.
>> The
>> legacy polygon function first painted the whole exterior ring, then
>> overpainted holes with the pbg= colour, which is "transparent" by
>> default.
>> For many purposes, polypath is preferable, but as you know, cairo is much
>> slower than X11. So using X11 ought still to be OK, in the plot method
>> set
>> usePolypath=FALSE. We can add back an option and set the argument by
>> default to that option if that would help.
>>
>> The details for the plot method in the code:
>>
>> https://r-forge.r-project.org/scm/viewvc.php/pkg/sp/R/SpatialPolygons-disp
>> layMethods.R?root=rspatial&view=log
>>
>> and for spplot methods look in the same repository.
>>
>> Hope this helps,
>>
>> Roger
>
> It does help, especially the pointer to usePolypath=FALSE, which lets me
> plot with X11/Xlib. Thank you.
>
> In terms of adding back an option, would that be a global option of some
> sort, so that users like me don't have to supply usePolypath=FALSE every
> time?  That would indeed be helpful, if it's not too much trouble.

Committed to the sp package in the rspatial project on R-Forge as revision 
1269. If you could check and see whether this works for you, I'd be 
grateful - you would add set_Polypath(FALSE) early in your script, and it 
should work everwhere plot() is called on a SpatialPolygons object.

Roger

>
> -Don
>
>>
>>>
>>> Thanks
>>> -Don
>>>
>>>
>>>> str(sfbound)
>>> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>>>  ..@ data       :'data.frame': 1 obs. of  1 variable:
>>>  .. ..$ name: Factor w/ 1 level "Boundary.kml": 1
>>>  ..@ polygons   :List of 1
>>>  .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
>>>  .. .. .. ..@ Polygons :List of 1
>>>  .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
>>>  .. .. .. .. .. .. ..@ labpt  : num [1:2] -121.7 37.7
>>>  .. .. .. .. .. .. ..@ area   : num 3.71e-06
>>>  .. .. .. .. .. .. ..@ hole   : logi FALSE
>>>  .. .. .. .. .. .. ..@ ringDir: int 1
>>>  .. .. .. .. .. .. ..@ coords : num [1:8, 1:2] -122 -122 -122 -122 -122
>>> ...
>>>  .. .. .. ..@ plotOrder: int 1
>>>  .. .. .. ..@ labpt    : num [1:2] -121.7 37.7
>>>  .. .. .. ..@ ID       : chr "1"
>>>  .. .. .. ..@ area     : num 3.71e-06
>>>  ..@ plotOrder  : int 1
>>>  ..@ bbox       : num [1:2, 1:2] -121.7 37.7 -121.7 37.7
>>>  .. ..- attr(*, "dimnames")=List of 2
>>>  .. .. ..$ : chr [1:2] "x" "y"
>>>  .. .. ..$ : chr [1:2] "min" "max"
>>>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>>>  .. .. ..@ projargs: chr "+proj=longlat +ellps=GRS80 +datum=NAD83
>>> +no_defs +towgs84=0,0,0"
>>>
>>>
>>>> sessionInfo()
>>> R version 2.15.1 (2012-06-22)
>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>
>>> locale:
>>> [1] C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] sp_0.9-99   rmacq_1.1-8
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.15.1    lattice_0.20-6 tools_2.15.1
>>>
>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Sat Aug 11 01:08:37 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Sat, 11 Aug 2012 01:08:37 +0200
Subject: [R-sig-Geo] Extracting GSHHS global coastlines
References: <CA+PCcJN13ERbSNFxf1W43QqHw4gy-itnwACByyvtWhsF8CLH=A@mail.gmail.com>
	<alpine.LRH.2.02.1208091418440.26060@reclus.nhh.no>
Message-ID: <1427283.ztxFYZfp9x@ID-99504.news.uni-berlin.de>

Roger Bivand wrote:
> which uses threshold= to filter out boundary slivers. Maybe even easier is
> the maps package and map2SpatialPolygons() in maptools if all you need is
> a background world land map.

And even better, and almost just as easy, is to use the vector data from 
"http://www.naturalearthdata.com/". These are free (license: public domain), 
detailed, very high quality and up-to-date (whereas the maps in the maps and 
mapdata packages still contain USSR and other countries that don?t exist 
anymore).

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From r.turner at auckland.ac.nz  Sat Aug 11 01:31:07 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 11 Aug 2012 11:31:07 +1200
Subject: [R-sig-Geo] spatstat::affine.im
In-Reply-To: <ULDI3GES.1344624237.9580080.marcelino.delacruz@upm.es>
References: <ULDI3GES.1344624237.9580080.marcelino.delacruz@upm.es>
Message-ID: <502599BB.7030502@auckland.ac.nz>


This should indeed be considered a bug, and actually it has been fixed,
in version 1.28-2.  But, sad to say, that version has not yet been put up
on CRAN.  We've been getting flack from TPTB for releasing new versions
of spatstat too frequently --- so we've cut back on the update rate.

If anyone wants the debugged version of affine.im(), let me know and I
will email you the appropriate *.R file.

Marcelino's workaround should suffice for the time being if you just
want to wait until 1.28-2 is released.

     cheers,

         Rolf Turner

On 11/08/12 06:43, marcelino.delacruz at upm.es wrote:
> Hi Jose Manuel,
>
> I don't think it is exactly a bug. Just try indicating the dimensions of
> the resulting image:
>
>
>> vec <- rnorm(1200)
>> mat <- matrix(vec, nrow=30, ncol=40)
>> whitenoise <- im(mat)
>> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)),dimyx=c(30,40))
>> whitenoise2
> real-valued pixel image
> 30 x 40 pixel array (ny, nx)
> enclosing rectangle: [1, 81] x [1.5, 91.5] units
>
> Cheers,
>
> Marcelino
>
>
>
> Con fecha 10/8/2012, "JOSE MANUEL BLANCO MORENO" <jmblanco at ub.edu>
> escribi?:
>
>> Regarding my previous query, the problem is in fact in line 22-23 of function affine.im, when calling affinexy; when calling affine.im for a rectangular image but applying a non-diagonal matrix, there is no problem, because affinexy is not executed.
>>
>>
>>
>> This example does not work (as  before):
>>
>>
>>
>> vec <- rnorm(1200)
>> mat <- matrix(vec, nrow=30, ncol=40)
>> whitenoise <- im(mat)
>> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>>
>>
>>
>> But this one does:
>>
>>
>>
>> vec <- rnorm(1200)
>> mat <- matrix(vec, nrow=30, ncol=40)
>> whitenoise <- im(mat)
>> whitenoise2 <- affine(whitenoise, mat=matrix(c(1,8,8,1), ncol=2))
>>
>>
>>
>> Looks like a bug?
>>
>> ---------------------------------------
>> Jos? M. Blanco-Moreno
>> Dept. de Biologia Vegetal (Bot?nica)
>> Facultat de Biologia
>> Universitat de Barcelona
>> Av. Diagonal 643
>> 08028 Barcelona
>> SPAIN
>> ---------------------------------------
>> phone: (+34) 934 039 863
>> fax: (+34) 934 112 842
>> ---------------------------------------
>>
>> ________________________________
>> De: JOSE MANUEL BLANCO MORENO
>> Enviat el: divendres, 10 / agost / 2012 15:13
>> Per a: r-sig-geo at r-project.org
>> Tema: spatstat::affine.im
>>
>>
>> Dear users & experts,
>>
>>
>>
>> Does anyone know if affine transformation of images (function affine.im in spatstat) should work for non-square images? I thought it should, but I have tried:
>>
>>
>>
>> vec <- rnorm(1200)
>> mat <- matrix(vec, nrow=30, ncol=40)
>> whitenoise <- im(mat)
>> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>>
>>
>>
>> But I get:
>>
>>
>>
>> Error in im(v, xcol = xcol, yrow = yrow, xrange = newbox$xrange, yrange = newbox$yrange,  :
>>   Length of yrow does not match nrow(mat)
>> In addition: Warning message:
>> In rbind(X$x, X$y) :
>>   number of columns of result is not a multiple of vector length (arg 2)
>>
>>
>>
>> However if I modify the example allowing for a square image it works perfectly:
>>
>>
>>
>> vec <- rnorm(900)
>> mat <- matrix(vec, nrow=30, ncol=30)
>> whitenoise <- im(mat)
>> whitenoise2 <- affine(whitenoise, mat=diag(c(2,3)))
>>
>> And the only difference that I can spot between these matrices/images is the shape of the image itself.
>>
>>
>>
>> Affine should work for non-square images, isn't it? Or I am wrong? Is there any way to circumvent this problem?
>>
>>
>>
>> These are version details:
>>
>> R version 2.15.1 (2012-06-22)
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C                           LC_TIME=English_United States1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] spatstat_1.28-1 deldir_0.0-19   mgcv_1.7-18
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.1    lattice_0.20-6 Matrix_1.0-6   nlme_3.1-104   tools_2.15.1


From martin.ivanov at ifg.uni-tuebingen.de  Sat Aug 11 16:40:45 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Sat, 11 Aug 2012 16:40:45 +0200
Subject: [R-sig-Geo] gstat distance on a non-spherical Earth?
Message-ID: <50266EED.6020300@ifg.uni-tuebingen.de>

Hello,

The interpolation routines of gstat use great circle distance in km as 
units for the distance between two  points of unprojected data. My 
question is, if the datum is not a sphere, how is distance in gstat defined
for unprojected data? For example, how does gstat calculate the "great 
cirlce distance" between two points on the WGS84 datum?

Best regards,


-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
Keplerstra?e 17, 72074 T?bingen, Deutschland
Tel. +4970712975023


From karl at huftis.org  Sat Aug 11 17:30:52 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Sat, 11 Aug 2012 17:30:52 +0200
Subject: [R-sig-Geo] Better label placement for polygons
References: <1342712643.22466.6.camel@adrian.site>
Message-ID: <1541727.NjDCmzscXO@ID-99504.news.uni-berlin.de>

Karl Ove Hufthammer skreiv:

> I have had some problems with bad label placements for SpatialPolygons,
> so I wrote a small function for improving it. Hope it will be of use to
> someone on this list. Here?s an example of its output:
> 
>   http://huftis.org/kritikk/polygon-labels.png

I now have an alternative, which takes into account the width and height 
of the label. It?s based on a brute-force search of candidate positions, 
and selects the position where the maximum distance between the label 
rectangle and the polygon edge is the greatest. Here?s an example of the 
function applied to a long and a tall string:

  http://huftis.org/kritikk/polygon-labels-rect.png

And here?s the source code:

-----
library(rgdal)
library(rgeos)

calc.labpt.strings=function(pol, label, gridpoints=2000) {
  # Fetch the label size
  wd=strwidth(label)
  ht=strheight(label)
  
  # Sample a regular grid of points inside the polygon
  co=coordinates(spsample(pol, n=gridpoints, type="regular"))
  
  # Create a rectangular polygon with a given size and at a given position
  makerect=function(x, y, wd, ht, rectID)
      Polygons(list(Polygon(cbind(c(x,x+wd,x+wd,x,x), c(y,y,y+ht,y+ht,y)))), rectID)
  
  # Create a candidate label rectangle for each grid point
  # (Note that ?co? may have fewer than ?gridsize? rows.)
  rects=SpatialPolygons(sapply(seq_len(nrow(co)), function(i) makerect(co[i,1], co[i,2], wd, ht, i)),
                        proj4string=CRS(proj4string(pol)))
  
  # Only keep the rectangles that are fully inside the polygon
  inside=apply(gContains(pol, rects, byid=TRUE), 1, any)
  if( all(!inside)) # Abort if no candidate label positions can fit the label
    stop("Could not fit label inside polygon (with the current number of gridpoints")
  rects=rects[inside,]
  
  # Convert the polygon to lines, and then measure the distance
  # from each label rectangle to the nearest line, keeping the
  # one with the largest distance.
  pol.l=as(pol, "SpatialLines")
  ind=which.max(apply(gDistance(pol.l, rects, byid=TRUE), 1, min))
  labelpos=apply(bbox(rects[ind,]), 1, mean)
  labelpos
}
-----


Here?s an example of how to use the function. Note that we have 
to draw the polygon *before* using the function, as the function
uses coordinate information from the graphical device.

The function uses 2000 candidate grid points by default, and is
still quite fast, but one can usually get by with fewer points
(even as few as 200 usually gets good results).

-----
# Fetch an example map
library(rworldmap)
kart=getMap(projection="equalArea")
xy.sp=kart["BRA",]

# Two examples
par(mfrow=c(1,2))

# A long (wide) string
plot(xy.sp, col="khaki")
label="A very long text string"
xy=calc.labpt.strings(xy.sp, label)
text(xy[1], xy[2], label)

# A tall string
plot(xy.sp, col="khaki")
label="N\na\nr\nr\no\nw"
xy=calc.labpt.strings(xy.sp, label)
text(xy[1], xy[2], label)
-----


Two final remarks:

The function seems to give excellent results on most *natural* 
maps, but for very regular polygons, my previous label 
placement function is better. This is because the optimality
criterion only looks at the maximum distance, and it doesn?t
handle ?ties? in a smart way either (it uses the first candidate 
point which satisfies the criterion).

The function will only work properly on projected polygons
(or polygons plotted with ?asp=1?), and will warn if the
SpatialPolygons object is not projected. One good alternative 
for longlat data is to use the equirectangular projection, as
described in my previous post:

  http://article.gmane.org/gmane.comp.lang.r.geo/15170

I?d appreciate any comments and suggestions for improvements.

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From edzer.pebesma at uni-muenster.de  Sat Aug 11 20:10:44 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 11 Aug 2012 20:10:44 +0200
Subject: [R-sig-Geo] gstat distance on a non-spherical Earth?
In-Reply-To: <50266EED.6020300@ifg.uni-tuebingen.de>
References: <50266EED.6020300@ifg.uni-tuebingen.de>
Message-ID: <5026A024.7030102@uni-muenster.de>

see:

https://svn.52north.org/svn/geostatistics/main/gstat/pkg/src/gcdist.c

On 08/11/2012 04:40 PM, Martin Ivanov wrote:
> Hello,
> 
> The interpolation routines of gstat use great circle distance in km as
> units for the distance between two  points of unprojected data. My
> question is, if the datum is not a sphere, how is distance in gstat defined
> for unprojected data? For example, how does gstat calculate the "great
> cirlce distance" between two points on the WGS84 datum?
> 
> Best regards,
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From samanmonfared1 at gmail.com  Sun Aug 12 09:38:09 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Sun, 12 Aug 2012 00:38:09 -0700
Subject: [R-sig-Geo] formulas of variograms in gstat
Message-ID: <CAOytA4YP-jx_rmKaa-m9--Vkc1D6KSbVyrKBOj_oABjpYRZWQg@mail.gmail.com>

Dear all,
How can I see mathematical formulation of variogram models in gstat?
Some of them are in gstat manual but there aren't others like
("Exc,"Ste","Mat","Hol").
Thanks.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From A.Harley at bom.gov.au  Mon Aug 13 05:59:56 2012
From: A.Harley at bom.gov.au (Andrew Harley)
Date: Mon, 13 Aug 2012 13:59:56 +1000
Subject: [R-sig-Geo] rgdal compile error on RHEL5 [SEC=UNCLASSIFIED]
Message-ID: <122EC82C51E4074B995E23C4CC960017FEC8DE348A@BOM-VMBX-HO.bom.gov.au>

Hi All,
 
I'm getting an error when compiling the latest version of rgdal.
 
It's saying unable to find GDALAllRegister in libgdal. We are running gdal v1.8.0 from elgis repository. I noticed we had two versions of gdal-config (one for 64 bit), but the error remains the same not matter which one I use. Here are the ./configure options for our version of gdal (from http://wiki.osgeo.org/wiki/Enterprise_Linux_GIS <http://wiki.osgeo.org/wiki/Enterprise_Linux_GIS> ):

./configure --build=x86_64-redhat-linux-gnu --host=x86_64-redhat-linux-gnu --target=x86_64-redhat-linux-gnu --program-prefix= --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --sysconfdir=/etc --datadir=/usr/share --includedir=/usr/include --libdir=/usr/lib64 --libexecdir=/usr/libexec --localstatedir=/var --sharedstatedir=/usr/com --mandir=/usr/share/man --infodir=/usr/share/info --prefix=/usr --includedir=/usr/include/gdal/ --datadir=/usr/share/gdal/ --with-threads=yes --with-dods-root=/usr/lib64 --with-ogdi --with-cfitsio=/usr --with-geotiff=external --with-tiff=external --with-libtiff=external --with-libz --with-netcdf --with-hdf4 --with-hdf5 --with-geos --with-jasper --with-png --with-gif --with-jpeg --with-odbc --with-sqlite --with-mysql --with-curl --with-python --with-perl --with-pcraster --with-ruby --with-java --with-xerces --with-xerces-lib=-lxerces-c --with-xerces-inc=/usr/include --with-jpeg12=no --enable-shared --with-gdal-ver=1.8.0 --with-spatialite=yes

And here is the output of our install of rgdal. I've also tried pointing it to the gdalconfig by using --configure-args='--with-gdalconfig=/usr/bin/gdal-config', but the same error occurs. Any help you guys can provide would be great!

# R CMD INSTALL rgdal_0.7-12.tar.gz
* installing to library '/usr/lib64/R/library'
* installing *source* package 'rgdal' ...
** package 'rgdal' successfully unpacked and MD5 sums checked
configure: gdal-config: gdal-config
checking gdal-config usability... yes
configure: GDAL: 1.8.0
checking GDAL version > 1.5.4... yes
checking for gcc... gcc -m64 -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -m64 -std=gnu99 accepts -g... yes
checking for gcc -m64 -std=gnu99 option to accept ANSI C... none needed
checking how to run the C preprocessor... gcc -m64 -std=gnu99 -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking gdal.h usability... yes
checking gdal.h presence... yes
checking for gdal.h... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package 'rgdal'
* removing '/usr/lib64/R/library/rgdal'

gdal-config output:

# gdal-config --libs
-lgdal
# gdal-config --dep-libs
-L/usr/lib64 -lgeos_c -lodbc -lodbcinst -lexpat -lxerces-c -ljasper -lhdf5 -L/usr/lib64/hdf -L/usr/lib64/hdf -lmfhdf -ldf -logdi -lgif -ljpeg -lgeotiff -ltiff -lpng -lnetcdf -lcfitsio -L/usr/lib64 -lpq -lz -lpthread -lm -lrt -ldl -ldap -ldapclient -ldapserver -lpthread -lrx -L/usr/kerberos/lib64 -lcurl -ldl -lgssapi_krb5 -lkrb5 -lk5crypto -lcom_err -lidn -lssl -lcrypto -lz -lxml2 -lz -lm -lspatialite -L/usr/kerberos/lib64 -lcurl -ldl -lgssapi_krb5 -lkrb5 -lk5crypto -lcom_err -lidn -lssl -lcrypto -lz -rdynamic -L/usr/lib64/mysql -lmysqlclient -lz -lcrypt -lnsl -lm -L/usr/lib64 -lssl -lcrypto

Thanks,
 
Andrew Harley
Linux Systems Administrator
Climate and Water Division (ICT Operations)
Bureau of Meteorology, Australia
03 9616 8441
http://www.bom.gov.au/water/


From sglish at hotmail.com  Mon Aug 13 06:38:18 2012
From: sglish at hotmail.com (Chris English)
Date: Mon, 13 Aug 2012 00:38:18 -0400
Subject: [R-sig-Geo] Great Circles US IRS Migration mapping
Message-ID: <SNT117-W12E0A37167D4B34EE114CFC5B00@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/90999dfb/attachment.pl>

From samanmonfared1 at gmail.com  Mon Aug 13 10:25:09 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Mon, 13 Aug 2012 01:25:09 -0700
Subject: [R-sig-Geo] variogram models in gstat
Message-ID: <CAOytA4aN_yi1sT8-FJuYkrm_svg3RCVk90kjeQLttBa8wM=dAw@mail.gmail.com>

Dear all,
How can I see mathematical formulation of variogram models in gstat?
Some of them are in gstat manual but there aren't others like
("Exc,"Ste","Mat","Hol").

Thanks.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167



-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From phuong.truong at wur.nl  Mon Aug 13 11:47:13 2012
From: phuong.truong at wur.nl (Truong, Phuong)
Date: Mon, 13 Aug 2012 09:47:13 +0000
Subject: [R-sig-Geo] variogram models in gstat
In-Reply-To: <CAOytA4aN_yi1sT8-FJuYkrm_svg3RCVk90kjeQLttBa8wM=dAw@mail.gmail.com>
References: <CAOytA4aN_yi1sT8-FJuYkrm_svg3RCVk90kjeQLttBa8wM=dAw@mail.gmail.com>
Message-ID: <9E023C6910CF9F4193DAD93552E272AB0E18AC@SCOMP0935.wurnet.nl>

You might find this link useful: https://stat.ethz.ch/pipermail/r-sig-geo/2010-April/008064.html


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Saman Monfared
Sent: maandag 13 augustus 2012 10:25
To: r-sig-geo
Subject: [R-sig-Geo] variogram models in gstat

Dear all,
How can I see mathematical formulation of variogram models in gstat?
Some of them are in gstat manual but there aren't others like ("Exc,"Ste","Mat","Hol").

Thanks.

--
Saman Monfared
Msc, Department of Statistics, Shiraz University, Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167



--
Saman Monfared
Msc, Department of Statistics, Shiraz University, Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From everton.emanuel at gmail.com  Mon Aug 13 14:00:20 2012
From: everton.emanuel at gmail.com (Everton Emanuel)
Date: Mon, 13 Aug 2012 09:00:20 -0300
Subject: [R-sig-Geo] How to convert nb - neighbourhood object in matrix
	object
Message-ID: <CA+Ynvbit0+DTK0ZVrJtzUbnNLvbn+1+Y7G7yeMHMOGOrwZKxqw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/6567ef08/attachment.pl>

From Roger.Bivand at nhh.no  Mon Aug 13 14:09:38 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 13 Aug 2012 14:09:38 +0200 (CEST)
Subject: [R-sig-Geo] How to convert nb - neighbourhood object in matrix
 object
In-Reply-To: <CA+Ynvbit0+DTK0ZVrJtzUbnNLvbn+1+Y7G7yeMHMOGOrwZKxqw@mail.gmail.com>
References: <CA+Ynvbit0+DTK0ZVrJtzUbnNLvbn+1+Y7G7yeMHMOGOrwZKxqw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208131409200.12263@reclus.nhh.no>

On Mon, 13 Aug 2012, Everton Emanuel wrote:

> Dear all,
>
> I have a 'nb' neighbourhood class object and I want to convert it in a matrix
> object. I have searched for functions in the spdep library,
> without success. Does anyone know an easy way to do that?

?nb2mat perhaps?

>
> Thanks in advance,
> Everton.
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Mon Aug 13 15:15:53 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 13 Aug 2012 15:15:53 +0200
Subject: [R-sig-Geo] variogram models in gstat
In-Reply-To: <9E023C6910CF9F4193DAD93552E272AB0E18AC@SCOMP0935.wurnet.nl>
References: <CAOytA4aN_yi1sT8-FJuYkrm_svg3RCVk90kjeQLttBa8wM=dAw@mail.gmail.com>
	<9E023C6910CF9F4193DAD93552E272AB0E18AC@SCOMP0935.wurnet.nl>
Message-ID: <5028FE09.4030702@uni-muenster.de>

Thanks, Phuong. Since that posting, the appropriate source file location
has moved to:

https://svn.52north.org/cgi-bin/viewvc.cgi/main/gstat/pkg/src/vario_fn.c?view=markup&root=geostatistics

search for "exc" and "hole" to find the corresponding functions.

On 08/13/2012 11:47 AM, Truong, Phuong wrote:
> You might find this link useful: https://stat.ethz.ch/pipermail/r-sig-geo/2010-April/008064.html
> 
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Saman Monfared
> Sent: maandag 13 augustus 2012 10:25
> To: r-sig-geo
> Subject: [R-sig-Geo] variogram models in gstat
> 
> Dear all,
> How can I see mathematical formulation of variogram models in gstat?
> Some of them are in gstat manual but there aren't others like ("Exc,"Ste","Mat","Hol").
> 
> Thanks.
> 
> --
> Saman Monfared
> Msc, Department of Statistics, Shiraz University, Shiraz 71454, Iran
> Email: Samanmonfared1 at gmail.com
> 
> Tel: +98 917 5305167
> 
> 
> 
> --
> Saman Monfared
> Msc, Department of Statistics, Shiraz University, Shiraz 71454, Iran
> Email: Samanmonfared1 at gmail.com
> 
> Tel: +98 917 5305167
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mathieu.rajerison at gmail.com  Mon Aug 13 16:16:14 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 13 Aug 2012 16:16:14 +0200
Subject: [R-sig-Geo] Lines Network to Graph
Message-ID: <CAGfc75k_YAbmgFtMNVKEGDYNZTBHccXymz-eOujh=W_0WtoNkw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/96472491/attachment.pl>

From sturgeon09 at gmail.com  Mon Aug 13 17:24:24 2012
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Mon, 13 Aug 2012 11:24:24 -0400
Subject: [R-sig-Geo] predict.gam, question about resolution
Message-ID: <CAH3FZ06Z8wX4q-YSSGci96y1SGYvaPdxQ1igd17KnbkxkkE8BA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/1d11383f/attachment.pl>

From karljarvis at gmail.com  Mon Aug 13 21:12:43 2012
From: karljarvis at gmail.com (Karl Jarvis)
Date: Mon, 13 Aug 2012 12:12:43 -0700
Subject: [R-sig-Geo] crop/trim raster
Message-ID: <FC26F44B-3911-4CEC-9C21-BFEBE81D45B6@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/155af2de/attachment.pl>

From r.hijmans at gmail.com  Tue Aug 14 00:49:35 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 13 Aug 2012 15:49:35 -0700
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
Message-ID: <CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120813/9500db31/attachment.pl>

From alobolistas at gmail.com  Tue Aug 14 12:45:54 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 14 Aug 2012 12:45:54 +0200
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
Message-ID: <CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>

I think this is a real need. The tif files currently generated by
writeRaster() cannot be easily modified
with gdal utilities, beacause gdalinfo can force the calculation of
the min/max values nut not of the
mean and sd unless they do not exist:

from http://www.gdal.org/gdalinfo.html :

DESCRIPTION

The gdalinfo program lists various information about a GDAL supported
raster dataset.

-mm
Force computation of the actual min/max values for each band in the dataset.
-stats
Read and display image statistics. Force computation if no statistics
are stored in an image.

Perhaps a solution would be to let the files with "no statistics
stored" instead of the current wrong
default values. I think this would be ok for qgis also, as I think
that qgis reads the mean and sd from
the tif file if they are available (but with qgis you never know...).
If possible, I would much prefer
correct stat info than no info (but no info is better than wrong info).

By now I have to write the files again using gdal_translate -stats,
that forces stats calculation:

writeRaster(adls204_150_93,filename="adls204_150_93",format="GTiff",dataType="INT2U",NAflag=0,overwrite=T)
GDALinfo("adls204_150_93.tif") #wrong stats:
system("gdal_translate -stats adls204_150_93.tif test.tif")
system("gdal_translate -stats test.tif adls204_150_93.tif")
GDALinfo("adls204_150_93.tif")
system("rm test.tif")

Agus

2012/8/14 Robert J. Hijmans <r.hijmans at gmail.com>:
> Agus,
> raster tracks the min and max values but does not track the mean and std;
> and most file formats cannot store them. The zeros are 'default' values;
> would it help to set them to another value that QGIS recognizes; perhaps to
> the NA value? I could add an option to compute and add the mean and std
> values.
> Robert
>
> On Fri, Aug 10, 2012 at 1:25 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> I've just noted that files created with writeRaster() have wrong stats
>> (which is a problem later in Qgis, for example).
>> Not sure if writeRaster() uses rgdal, in that case the problem might
>> be more general:
>>
>> > delme <- subset(adlstest,c("B48","B31","B21"))
>> > summary(delme)
>> Cells:  1089
>> NAs  :  0 0 0
>>
>>            1    2    3
>> Min.    2563 3491 3822
>> 1st Qu. 2700 3636 3971
>> Median  2764 3691 4009
>> Mean    2781 3699 4014
>> 3rd Qu. 2862 3765 4055
>> Max.    3629 3979 4258
>>
>> > GDALinfo("delme.tif")
>> rows        33
>> columns     33
>> bands       3
>> origin.x        648490.8
>> origin.y        7058623
>> res.x       29.9746
>> res.y       29.99077
>> ysign       -1
>> oblique.x   0
>> oblique.y   0
>> driver      GTiff
>> projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
>> file        delme.tif
>> apparent band summary:
>>    GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
>> 1 Float32 2563 3629     0   0           TRUE           0
>> 2 Float32 3491 3979     0   0           TRUE           0
>> 3 Float32 3822 4258     0   0           TRUE           0
>> Metadata:
>> AREA_OR_POINT=Area
>>
>> Note the 0 means and sd !
>>
>> adlstest here:
>> http://dl.dropbox.com/u/3180464/adlstest.rda
>>
>> Agus
>>
>> > sessionInfo()
>> R version 2.15.1 (2012-06-22)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> LC_MONETARY=en_US.UTF-8
>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
>>                LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.1     lattice_0.19-30 tools_2.15.1
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Aug 14 13:20:17 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 Aug 2012 13:20:17 +0200 (CEST)
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>

On Tue, 14 Aug 2012, Agustin Lobo wrote:

> I think this is a real need. The tif files currently generated by
> writeRaster() cannot be easily modified
> with gdal utilities, beacause gdalinfo can force the calculation of
> the min/max values nut not of the
> mean and sd unless they do not exist:
>
> from http://www.gdal.org/gdalinfo.html :
>
> DESCRIPTION
>
> The gdalinfo program lists various information about a GDAL supported
> raster dataset.
>
> -mm
> Force computation of the actual min/max values for each band in the dataset.
> -stats
> Read and display image statistics. Force computation if no statistics
> are stored in an image.
>
> Perhaps a solution would be to let the files with "no statistics
> stored" instead of the current wrong
> default values. I think this would be ok for qgis also, as I think
> that qgis reads the mean and sd from
> the tif file if they are available (but with qgis you never know...).
> If possible, I would much prefer
> correct stat info than no info (but no info is better than wrong info).

Is your problem that you want min, max, mean, sd in Qgis, but cannot 
generate them there? Have you tried using the setStatistics=TRUE argument 
in writeGDAL()? I don't think that writeRaster() passes it through, but 
does call RGDAL_SetStatistics internally in raster:::.stopGDALwriting(). 
If the statistics vector did not have 0, 0, for the mean and sd, but used 
any rgdal::writeGDAL flag, maybe the extra values could be output.

If you read the code, you could have the pleasure of submitting patches!

Roger


>
> By now I have to write the files again using gdal_translate -stats,
> that forces stats calculation:
>
> writeRaster(adls204_150_93,filename="adls204_150_93",format="GTiff",dataType="INT2U",NAflag=0,overwrite=T)
> GDALinfo("adls204_150_93.tif") #wrong stats:
> system("gdal_translate -stats adls204_150_93.tif test.tif")
> system("gdal_translate -stats test.tif adls204_150_93.tif")
> GDALinfo("adls204_150_93.tif")
> system("rm test.tif")
>
> Agus
>
> 2012/8/14 Robert J. Hijmans <r.hijmans at gmail.com>:
>> Agus,
>> raster tracks the min and max values but does not track the mean and std;
>> and most file formats cannot store them. The zeros are 'default' values;
>> would it help to set them to another value that QGIS recognizes; perhaps to
>> the NA value? I could add an option to compute and add the mean and std
>> values.
>> Robert
>>
>> On Fri, Aug 10, 2012 at 1:25 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>
>>> I've just noted that files created with writeRaster() have wrong stats
>>> (which is a problem later in Qgis, for example).
>>> Not sure if writeRaster() uses rgdal, in that case the problem might
>>> be more general:
>>>
>>>> delme <- subset(adlstest,c("B48","B31","B21"))
>>>> summary(delme)
>>> Cells:  1089
>>> NAs  :  0 0 0
>>>
>>>            1    2    3
>>> Min.    2563 3491 3822
>>> 1st Qu. 2700 3636 3971
>>> Median  2764 3691 4009
>>> Mean    2781 3699 4014
>>> 3rd Qu. 2862 3765 4055
>>> Max.    3629 3979 4258
>>>
>>>> GDALinfo("delme.tif")
>>> rows        33
>>> columns     33
>>> bands       3
>>> origin.x        648490.8
>>> origin.y        7058623
>>> res.x       29.9746
>>> res.y       29.99077
>>> ysign       -1
>>> oblique.x   0
>>> oblique.y   0
>>> driver      GTiff
>>> projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
>>> file        delme.tif
>>> apparent band summary:
>>>    GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
>>> 1 Float32 2563 3629     0   0           TRUE           0
>>> 2 Float32 3491 3979     0   0           TRUE           0
>>> 3 Float32 3822 4258     0   0           TRUE           0
>>> Metadata:
>>> AREA_OR_POINT=Area
>>>
>>> Note the 0 means and sd !
>>>
>>> adlstest here:
>>> http://dl.dropbox.com/u/3180464/adlstest.rda
>>>
>>> Agus
>>>
>>>> sessionInfo()
>>> R version 2.15.1 (2012-06-22)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>> LC_MONETARY=en_US.UTF-8
>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.15.1     lattice_0.19-30 tools_2.15.1
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From robbymarrotte at gmail.com  Tue Aug 14 22:04:20 2012
From: robbymarrotte at gmail.com (Robby Marrotte)
Date: Tue, 14 Aug 2012 16:04:20 -0400
Subject: [R-sig-Geo] R version of ArcGIS's Multipart To Singlepart
Message-ID: <CABd5c446G7p0dyTxF81j7Zr9uCSjvbppugYqH4SPwfp-OQXnNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120814/f3a686cf/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Aug 15 00:05:57 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 14 Aug 2012 15:05:57 -0700 (PDT)
Subject: [R-sig-Geo] Show differences between categorical maps
Message-ID: <1344981957.90476.YahooMailNeo@web121905.mail.ne1.yahoo.com>

? Dear colleagues,

? I have two rasterbrick objects which are categorical maps, ranging from 1 to 15 (only integer numbers). Each value represents a vegetation class (tropical forest, boreal forest, savanna, grassland etc). Each brick layer represents a year which ranges from 1605 to 2005. There are lots of NA values, specially over the ocean (as the data is distributed only over land). Please see the objects below:

> library (raster)
> co2fix <-brick('~/Dropbox/web/vegtype_fix_co2.nc')
> co2dyn <-brick('~/Dropbox/web/vegtype_dyn_co2.nc')
>
> co2fix
class ? ? ? : RasterBrick?
dimensions ?: 83, 85, 7055, 401 ?(nrow, ncol, ncell, nlayers)
resolution ?: 0.5, 0.5 ?(x, y)
extent ? ? ?: -75, -32.5, -35, 6.5 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84?
values ? ? ?: /home/thiago/Dropbox/web/vegtype_fix_co2.nc?
layer names : X1605.01.01, X1606.01.01, X1607.01.01, X1608.01.01, X1609.01.01, X1610.01.01, X1611.01.01, X1612.01.01, X1613.01.01, X1614.01.01, X1615.01.01, X1616.01.01, X1617.01.01, X1618.01.01, X1619.01.01, ...?
Date ? ? ? ?: 1605-01-01, 2005-01-01 (min, max)
varname ? ? : vegtype0?

> co2dyn
class ? ? ? : RasterBrick?
dimensions ?: 83, 85, 7055, 401 ?(nrow, ncol, ncell, nlayers)
resolution ?: 0.5, 0.5 ?(x, y)
extent ? ? ?: -75, -32.5, -35, 6.5 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84?
values ? ? ?: /home/thiago/Dropbox/web/vegtype_dyn_co2.nc?
layer names : X1605.01.01, X1606.01.01, X1607.01.01, X1608.01.01, X1609.01.01, X1610.01.01, X1611.01.01, X1612.01.01, X1613.01.01, X1614.01.01, X1615.01.01, X1616.01.01, X1617.01.01, X1618.01.01, X1619.01.01, ...?
Date ? ? ? ?: 1605-01-01, 2005-01-01 (min, max)
varname ? ? : vegtype0?

? Rasters are available here (22MB each file): https://www.dropbox.com/s/9re75op7dewo2vl/vegtype_fix_co2.nc and https://www.dropbox.com/s/f06vhtl1kfq2zb2/vegtype_dyn_co2.nc.

? First raster is my projected vegetation map and the second raster is an experimental one, which I created by crossing the first raster with deforestation data. My goal is to investigate the impact of deforestation data on the vegetation map. What I would like to do to achieve this goal is:?

? ?a) for each year, count the proportion (relative frequency) of each category in both rasters. Then, I would like to subtract the proportions of each class in the second raster the proportions of each class in the first raster across the years and plot this difference as lines (one for each class) over time;

? ?b) find a way to, in each year, when comparing one raster to the other, detect and account for the transition between classes (FROM which class the map changed). For example, pixel (1,1) of first raster in first year is "1". The same pixel, in the same year, in raster two, is "2". Then, we have one transition FROM class 1. How to count ALL transitions FROM class1?

? Any help would be very appreciated. Although this is a very odd problem, I am sure its solution feasible with R. I just need some help and/or ideas! There might be a "ready" technique to display this kind of categorical information, but this is really what I have in mind...
??
? Many many thanks in advance,
? Thiago.


From jerg.gutmann at uni-hamburg.de  Wed Aug 15 01:07:52 2012
From: jerg.gutmann at uni-hamburg.de (Jerg Gutmann)
Date: Wed, 15 Aug 2012 00:07:52 +0100
Subject: [R-sig-Geo] listw spatial weights for panel data
Message-ID: <007f01cd7a71$a1b88510$e5298f30$@uni-hamburg.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120815/e778b66e/attachment.pl>

From kjjw32 at yahoo.com  Wed Aug 15 04:05:06 2012
From: kjjw32 at yahoo.com (K Jjw)
Date: Tue, 14 Aug 2012 19:05:06 -0700 (PDT)
Subject: [R-sig-Geo] interpolating
In-Reply-To: <1344987482.95534.YahooMailNeo@web121502.mail.ne1.yahoo.com>
References: <1344987482.95534.YahooMailNeo@web121502.mail.ne1.yahoo.com>
Message-ID: <1344996306.3516.YahooMailNeo@web121501.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120814/3702e749/attachment.pl>

From tom.gottfried at o2mail.de  Wed Aug 15 06:10:04 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Wed, 15 Aug 2012 06:10:04 +0200
Subject: [R-sig-Geo] interpolating
In-Reply-To: <1344996306.3516.YahooMailNeo@web121501.mail.ne1.yahoo.com>
References: <1344987482.95534.YahooMailNeo@web121502.mail.ne1.yahoo.com>
	<1344996306.3516.YahooMailNeo@web121501.mail.ne1.yahoo.com>
Message-ID: <502B211C.302@o2mail.de>

?predict
?predict.lm

HTH,
Tom

Am 15.08.2012 04:05, schrieb K Jjw:
> Hi
>
>
> I have data that are from 1990, 2040, and 2090. I need to loop through each location (defined in a grid of 240x260) and find a linear regression for each place across the 3 years. I then need to interpolate the data to get the missing years for the given location ie I need all the data for 1991, 1992, 1993 etc. I have a loop and I have figured out how to make the model ie lm(). What I am having difficulty with is interpolating the data without hardcoding in the formula of the linear regression.
>
> so basically the bit of code that is causing me problems is
>
> linr<-lm(jan_ppt~date)
> linr
>
> Call:
> lm(formula = jan_ppt ~ date)
>
> Coefficients:
> (Intercept)         date
>    1.482e+02    1.728e-03
>
> x<- 1990:2090
> y<-1.482e2 + 1.728e-3*x #this is what I have now
> y<- intercept+ grad*x #this is what I want where 'intercept' and 'grad' are defined from the model 'linr'
>
>   how do I define y without hardcoding the coefficients as they will change for every location. I basically need to do linear regressions for each location then interpolate the data to get yearly data in order to put this data in another model that requires yearly data.
>
> Thanks
>
> KJ
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed Aug 15 08:39:11 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Aug 2012 08:39:11 +0200 (CEST)
Subject: [R-sig-Geo] listw spatial weights for panel data
In-Reply-To: <007f01cd7a71$a1b88510$e5298f30$@uni-hamburg.de>
References: <007f01cd7a71$a1b88510$e5298f30$@uni-hamburg.de>
Message-ID: <alpine.LRH.2.02.1208150831290.20318@reclus.nhh.no>

On Wed, 15 Aug 2012, Jerg Gutmann wrote:

> Dear all,
>
>
>
> I would like to append a listw object to another listw object such that I
> can keep it in its format. The idea is creating a spatial weights list for
> countries and years based on cshapes.

Why? Simply appending listw objects will lead to wring indexing, won't it, 
as the listw objects only index 1:n for their sets of spatial 
observations. Your approach will not show how say France 1949 relates to 
Spain 1962 (which should have different indices), will it?

If you need a collection of listw objects, put them in a list, and access 
them from that. This is what is done for multiple lag orders, see ?nblag, 
but there the numbers and indices of spatial observations do not change, 
while yours change over time (Czechoslovakia -> Czech Republic and 
Slovakia). You need to think through the consequences of your 
representation - appending listw objects is not the right question.

Hope this clarifies,

Roger

> However, I was not able to combine two
> listw objects without turning them into a regular list. Is there any simple
> trick or is what I would like to do anyway useless for current spatial
> analysis packages (e.g. splm or spdep)? I am relatively new to both R and
> spatial analysis and would be happy about any comments!
>
>
>
> Jerg
>
>
>
> result0 <- distmatrix(as.Date("1950-6-30"), type="capdist", useGW=T)
>
> result0 <- 1/result0
>
> diag(result0) <- 0
>
> result <- mat2listw(result0)
>
> result$year <- 1950
>
> # loop
>
> for (year in 1951:1960) {
>
>   date.current <- paste(year, "6", "30", sep="-")
>
>   result.current <- distmatrix(as.Date(date.current), type="capdist",
> useGW=T)
>
>   result.current <- 1/result.current
>
>   diag(result.current) <- 0
>
>   result.current2 <- mat2listw(result.current)
>
>   result.current2$year <- year
>
>   result <- #???#(result, result.current2) }
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Aug 15 10:08:50 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 15 Aug 2012 10:08:50 +0200
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
	<alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
Message-ID: <CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>

2012/8/14 Roger Bivand <Roger.Bivand at nhh.no>:
> On Tue, 14 Aug 2012, Agustin Lobo wrote:
>
>> I think this is a real need. The tif files currently generated by
>> writeRaster() cannot be easily modified
>> with gdal utilities, beacause gdalinfo can force the calculation of
>> the min/max values nut not of the
>> mean and sd unless they do not exist:
>>
>> from http://www.gdal.org/gdalinfo.html :
>>
.../...
>
>
> Is your problem that you want min, max, mean, sd in Qgis, but cannot
> generate them there?
Not exactly.  QGIS uses the stats for stretching if that info is
available in the file, and calculates it if not available.
But currently there is no way to force recalculation in case the stats
are wrong. Thus files created with writeRaster()
cannot be correctly displayed in QGIS.

> Have you tried using the setStatistics=TRUE argument in
> writeGDAL()?
No, that option is not documented in the help page.
I've tried now but the result is the same:
> writeRaster(adls48_31_21,filename="test",format="GTiff",dataType="INT2U",NAflag=0,overwrite=TRUE,setStatistics=TRUE )
class       : RasterBrick
dimensions  : 3251, 1181, 3839431, 3  (nrow, ncol, ncell, nlayers)
resolution  : 29.9746, 29.99077  (x, y)
extent      : 643485, 678885, 7053615, 7151115  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0
values      : /media/Iomega_HDD/VOLCAN/HYPERION/RHyperion/test.tif
min values  : 148, 646, 1110
max values  : 24392, 12864, 13619
layer names : test.1, test.2, test.3

> GDALinfo("test.tif")
rows        3251
columns     1181
bands       3
origin.x        643485
origin.y        7053615
res.x       29.9746
res.y       29.99077
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
file        test.tif
apparent band summary:
   GDType Bmin  Bmax Bmean Bsd hasNoDataValue NoDataValue
1 Float32  148 24392     0   0           TRUE           0
2 Float32  646 12864     0   0           TRUE           0
3 Float32 1110 13619     0   0           TRUE           0
Metadata:
AREA_OR_POINT=Area

> I don't think that writeRaster() passes it through, but does
> call RGDAL_SetStatistics internally in raster:::.stopGDALwriting(). If the
> statistics vector did not have 0, 0, for the mean and sd, but used any
> rgdal::writeGDAL flag, maybe the extra values could be output.
>
> If you read the code, you could have the pleasure of submitting patches!
which might be counteracted by your pleasure on patching my patches.
Let's wait until Robert  will be back.

Agus

> Roger
>
>
>
>>
>> By now I have to write the files again using gdal_translate -stats,
>> that forces stats calculation:
>>
>>
>> writeRaster(adls204_150_93,filename="adls204_150_93",format="GTiff",dataType="INT2U",NAflag=0,overwrite=T)
>> GDALinfo("adls204_150_93.tif") #wrong stats:
>> system("gdal_translate -stats adls204_150_93.tif test.tif")
>> system("gdal_translate -stats test.tif adls204_150_93.tif")
>> GDALinfo("adls204_150_93.tif")
>> system("rm test.tif")
>>
>> Agus
>>
>> 2012/8/14 Robert J. Hijmans <r.hijmans at gmail.com>:
>>>
>>> Agus,
>>> raster tracks the min and max values but does not track the mean and std;
>>> and most file formats cannot store them. The zeros are 'default' values;
>>> would it help to set them to another value that QGIS recognizes; perhaps
>>> to
>>> the NA value? I could add an option to compute and add the mean and std
>>> values.
>>> Robert
>>>
>>> On Fri, Aug 10, 2012 at 1:25 AM, Agustin Lobo <alobolistas at gmail.com>
>>> wrote:
>>>
>>>> I've just noted that files created with writeRaster() have wrong stats
>>>> (which is a problem later in Qgis, for example).
>>>> Not sure if writeRaster() uses rgdal, in that case the problem might
>>>> be more general:
>>>>
>>>>> delme <- subset(adlstest,c("B48","B31","B21"))
>>>>> summary(delme)
>>>>
>>>> Cells:  1089
>>>> NAs  :  0 0 0
>>>>
>>>>            1    2    3
>>>> Min.    2563 3491 3822
>>>> 1st Qu. 2700 3636 3971
>>>> Median  2764 3691 4009
>>>> Mean    2781 3699 4014
>>>> 3rd Qu. 2862 3765 4055
>>>> Max.    3629 3979 4258
>>>>
>>>>> GDALinfo("delme.tif")
>>>>
>>>> rows        33
>>>> columns     33
>>>> bands       3
>>>> origin.x        648490.8
>>>> origin.y        7058623
>>>> res.x       29.9746
>>>> res.y       29.99077
>>>> ysign       -1
>>>> oblique.x   0
>>>> oblique.y   0
>>>> driver      GTiff
>>>> projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
>>>> file        delme.tif
>>>> apparent band summary:
>>>>    GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
>>>> 1 Float32 2563 3629     0   0           TRUE           0
>>>> 2 Float32 3491 3979     0   0           TRUE           0
>>>> 3 Float32 3822 4258     0   0           TRUE           0
>>>> Metadata:
>>>> AREA_OR_POINT=Area
>>>>
>>>> Note the 0 means and sd !
>>>>
>>>> adlstest here:
>>>> http://dl.dropbox.com/u/3180464/adlstest.rda
>>>>
>>>> Agus
>>>>
>>>>> sessionInfo()
>>>>
>>>> R version 2.15.1 (2012-06-22)
>>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>>
>>>> locale:
>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>> LC_MONETARY=en_US.UTF-8
>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> other attached packages:
>>>> [1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_2.15.1     lattice_0.19-30 tools_2.15.1
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed Aug 15 10:19:22 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Aug 2012 10:19:22 +0200 (CEST)
Subject: [R-sig-Geo] Problems with lm.LMtests and lm.morantest
In-Reply-To: <CAN-F-q0EcVRn44LW_FSOtMvSmdGXupz77YF=psim8dsuG9+rfw@mail.gmail.com>
References: <CAN-F-q2-M+VAEWBz6YEgVHnhQN=5QMn+FqG5risBNhuNWkHpvg@mail.gmail.com>
	<CAN-F-q0EcVRn44LW_FSOtMvSmdGXupz77YF=psim8dsuG9+rfw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208150957110.20318@reclus.nhh.no>

On Tue, 7 Aug 2012, laurence delattre wrote:

> Hi,
>
>     I'm a French PhD student in Economics and I would like to tests the
> existence of spatial autocorrelation in a linear model with the functions
> lm.morantest and lm.LMtest of the package spded (I'm not a specialist in
> R!).
>
>     Its seems to be ok with lm.morantest() but with lm.LMtest() I have the
> error message:
>
>   ?NOTE:  lm.LMtests(LM1, LISTW, zero.policy = NULL, test = "LMlag", spChk
> = NULL,  :   Spatial weights matrix not row standardized?
>
>
>     So, I tried to row-standardized the matrix and I nomore have this
> message when processing lm.LMtest().
>
>
>     However the results seems odd. Indeed with the initial matrix,
> converted into a listw object with ?LISTW<-mat2listw (W, row.names=NULL)?,
> I rejected the null hypothesis both with the Moran's tests and the LMtest
> (LMerr).  To the contrary, with the row-standardized matrix, I cannot
> reject the null hypothesis according the LMerr test and the Morantest gives
> me a Moran's I statistic standard deviate equal to 0 and a p-value eual to
> 0.5 (which seems odd?).
>
>
>      So I don?t know which matrix is adequate for which test and if the
> results with the row-standardized matrix are ok...
>
>
>      Maybe it comes from the characteristics of my W matrix  in which wij=
> population j * exp (-dij/h)? , so because of the population terms, its not
> a symmetric matrix?
>
>
>      Maybe it comes from the way I row-standardized it, with
> ?LISTWW<-nb2listw(LISTW$neighbours, glist=NULL, style="W",
> zero.policy=FALSE)? ?
>

Here you have thrown away the general weights implied in your initial 
representation, use the glist= argument to pass them through. I guess that 
LISTW$neighbours includes all observations except i as neighbours of i, 
flattening out the lagged variable completely, and leading to an expected 
absence of spatial autocorrelation.

Moran's I is known to work for asymmetric general weights (weights are 
made symmetric internally), but the LM tests were developed assuming row 
standardisation (but not symmetry), so their properties are not well known 
when the weights are not row standardised, hence the warning - not error.

Roger

>
>
> I thank you in advance for your help.
>
>
> Best regards,
>
>
>
> Laurence
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Aug 15 10:37:36 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Aug 2012 10:37:36 +0200 (CEST)
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
	<alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
	<CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1208151029180.20318@reclus.nhh.no>

On Wed, 15 Aug 2012, Agustin Lobo wrote:

> 2012/8/14 Roger Bivand <Roger.Bivand at nhh.no>:
>> On Tue, 14 Aug 2012, Agustin Lobo wrote:
>>
>>> I think this is a real need. The tif files currently generated by
>>> writeRaster() cannot be easily modified
>>> with gdal utilities, beacause gdalinfo can force the calculation of
>>> the min/max values nut not of the
>>> mean and sd unless they do not exist:
>>>
>>> from http://www.gdal.org/gdalinfo.html :
>>>
> .../...
>>
>>
>> Is your problem that you want min, max, mean, sd in Qgis, but cannot
>> generate them there?
> Not exactly.  QGIS uses the stats for stretching if that info is
> available in the file, and calculates it if not available.
> But currently there is no way to force recalculation in case the stats
> are wrong. Thus files created with writeRaster()
> cannot be correctly displayed in QGIS.

Because - if you read the code - the mean and sd are set to 0.0 before 
writing. It isn't "wrong", it is a design choice not to incur the cost of 
calculating them by default, I think.

>
>> Have you tried using the setStatistics=TRUE argument in
>> writeGDAL()?
> No, that option is not documented in the help page.

It has been documented since November 2010, for example bottom of p. 21 
on http://cran.r-project.org/web/packages/rgdal/rgdal.pdf.


> I've tried now but the result is the same:
>> writeRaster(adls48_31_21,filename="test",format="GTiff",dataType="INT2U",NAflag=0,overwrite=TRUE,setStatistics=TRUE )

I did say:

>
>> I don't think that writeRaster() passes it through, but does
>> call RGDAL_SetStatistics internally in raster:::.stopGDALwriting(). If the
>> statistics vector did not have 0, 0, for the mean and sd, but used any
>> rgdal::writeGDAL flag, maybe the extra values could be output.
>>
>> If you read the code, you could have the pleasure of submitting patches!

However, if you convert to a SpatialGridDataFrame and use writeGDAL(), 
they are computed and displayed. I'm unsure from your case whether the 
missing values are correctly represented - I think all data were present - 
but the mean and sd are present.

> which might be counteracted by your pleasure on patching my patches.
> Let's wait until Robert  will be back.

Contributing code is a very important learning channel for the 
contributor, because the questioner/contributor is then in a much better 
position to understand their own questions, and possibly to contribute 
back something of value to others.

Roger

>
> Agus
>
>> Roger
>>
>>
>>
>>>
>>> By now I have to write the files again using gdal_translate -stats,
>>> that forces stats calculation:
>>>
>>>
>>> writeRaster(adls204_150_93,filename="adls204_150_93",format="GTiff",dataType="INT2U",NAflag=0,overwrite=T)
>>> GDALinfo("adls204_150_93.tif") #wrong stats:
>>> system("gdal_translate -stats adls204_150_93.tif test.tif")
>>> system("gdal_translate -stats test.tif adls204_150_93.tif")
>>> GDALinfo("adls204_150_93.tif")
>>> system("rm test.tif")
>>>
>>> Agus
>>>
>>> 2012/8/14 Robert J. Hijmans <r.hijmans at gmail.com>:
>>>>
>>>> Agus,
>>>> raster tracks the min and max values but does not track the mean and std;
>>>> and most file formats cannot store them. The zeros are 'default' values;
>>>> would it help to set them to another value that QGIS recognizes; perhaps
>>>> to
>>>> the NA value? I could add an option to compute and add the mean and std
>>>> values.
>>>> Robert
>>>>
>>>> On Fri, Aug 10, 2012 at 1:25 AM, Agustin Lobo <alobolistas at gmail.com>
>>>> wrote:
>>>>
>>>>> I've just noted that files created with writeRaster() have wrong stats
>>>>> (which is a problem later in Qgis, for example).
>>>>> Not sure if writeRaster() uses rgdal, in that case the problem might
>>>>> be more general:
>>>>>
>>>>>> delme <- subset(adlstest,c("B48","B31","B21"))
>>>>>> summary(delme)
>>>>>
>>>>> Cells:  1089
>>>>> NAs  :  0 0 0
>>>>>
>>>>>            1    2    3
>>>>> Min.    2563 3491 3822
>>>>> 1st Qu. 2700 3636 3971
>>>>> Median  2764 3691 4009
>>>>> Mean    2781 3699 4014
>>>>> 3rd Qu. 2862 3765 4055
>>>>> Max.    3629 3979 4258
>>>>>
>>>>>> GDALinfo("delme.tif")
>>>>>
>>>>> rows        33
>>>>> columns     33
>>>>> bands       3
>>>>> origin.x        648490.8
>>>>> origin.y        7058623
>>>>> res.x       29.9746
>>>>> res.y       29.99077
>>>>> ysign       -1
>>>>> oblique.x   0
>>>>> oblique.y   0
>>>>> driver      GTiff
>>>>> projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
>>>>> file        delme.tif
>>>>> apparent band summary:
>>>>>    GDType Bmin Bmax Bmean Bsd hasNoDataValue NoDataValue
>>>>> 1 Float32 2563 3629     0   0           TRUE           0
>>>>> 2 Float32 3491 3979     0   0           TRUE           0
>>>>> 3 Float32 3822 4258     0   0           TRUE           0
>>>>> Metadata:
>>>>> AREA_OR_POINT=Area
>>>>>
>>>>> Note the 0 means and sd !
>>>>>
>>>>> adlstest here:
>>>>> http://dl.dropbox.com/u/3180464/adlstest.rda
>>>>>
>>>>> Agus
>>>>>
>>>>>> sessionInfo()
>>>>>
>>>>> R version 2.15.1 (2012-06-22)
>>>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>>>
>>>>> locale:
>>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>> LC_MONETARY=en_US.UTF-8
>>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
>>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] rgdal_0.7-5   raster_2.0-08 sp_0.9-99
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_2.15.1     lattice_0.19-30 tools_2.15.1
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From martin.ivanov at ifg.uni-tuebingen.de  Wed Aug 15 13:32:26 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Wed, 15 Aug 2012 13:32:26 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
Message-ID: <502B88CA.4090008@ifg.uni-tuebingen.de>

Dear R users,
I have a rotated latitude-longitude grid with coordinates of the north 
pole POLE_LAT=39.25 and POLE_LON=-162 on a sphere with radius 6371 km. 
My data are on a conventional longlat grid on the same sphere. I found 
that I can transform my data to the rotated grid by means of proj4's 
ptransform. For example:
crds <- matrix(data=c(9.05, 48.52), ncol=2); # a pair of geographical 
coordinates

rot_crds <- 180/pi*ptransform(data=crds*pi/180, dst.proj="+proj=longlat 
+ellps=sphere +no_defs",
  src.proj="+proj=ob_tran +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 
+lon_0=180 +ellps=sphere +no_defs")[1:2]
 > rot_crds
[1] -5.917698 -1.871950 # these are the correct coordinates in the 
rotated grid
You may notice that to get the correct result I have to swap the source 
and destination CRS.

I would be happy if I could reproduce that result with the sp function 
spTransform, but I have no luck:
spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=longlat 
+ellps=sphere +no_defs"));
try1 <- spTransform(spPoint, CRS("+proj=ob_tran +o_proj=longlat 
+o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"));
 > try1
SpatialPoints:
      coords.x1 coords.x2
[1,]  2.896087   1.37327# this result is not correct

  I also tried with swappped source and destination:

 > spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=ob_tran 
+o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
+no_defs"));
+ try2 <- spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"));
+ try2
SpatialPoints:
      coords.x1 coords.x2
[1,] -170.7407 -46.63283 # this is also incorrect

My question is, is it possible to use spTransform for the kind of 
coordinate conversion I need? Or do I have to stick to
ptransform of proj4?

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From Roger.Bivand at nhh.no  Wed Aug 15 17:22:16 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Aug 2012 17:22:16 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <502B88CA.4090008@ifg.uni-tuebingen.de>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>

On Wed, 15 Aug 2012, Martin Ivanov wrote:

> Dear R users,
> I have a rotated latitude-longitude grid with coordinates of the north 
> pole POLE_LAT=39.25 and POLE_LON=-162 on a sphere with radius 6371 km. 
> My data are on a conventional longlat grid on the same sphere. I found 
> that I can transform my data to the rotated grid by means of proj4's 
> ptransform. For example:
> crds <- matrix(data=c(9.05, 48.52), ncol=2); # a pair of geographical 
> coordinates
>
> rot_crds <- 180/pi*ptransform(data=crds*pi/180, dst.proj="+proj=longlat 
> +ellps=sphere +no_defs",
>  src.proj="+proj=ob_tran +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 
> +lon_0=180 +ellps=sphere +no_defs")[1:2]
> > rot_crds
> [1] -5.917698 -1.871950 # these are the correct coordinates in the 
> rotated grid
> You may notice that to get the correct result I have to swap the source 
> and destination CRS.
>
> I would be happy if I could reproduce that result with the sp function 
> spTransform, but I have no luck:
> spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=longlat 
> +ellps=sphere +no_defs"));
> try1 <- spTransform(spPoint, CRS("+proj=ob_tran +o_proj=longlat 
> +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"));
> > try1
> SpatialPoints:
>      coords.x1 coords.x2
> [1,]  2.896087   1.37327# this result is not correct
>
>  I also tried with swappped source and destination:
>
> > spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=ob_tran 
> +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
> +no_defs"));
> + try2 <- spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"));
> + try2
> SpatialPoints:
>      coords.x1 coords.x2
> [1,] -170.7407 -46.63283 # this is also incorrect
>
> My question is, is it possible to use spTransform for the kind of 
> coordinate conversion I need? Or do I have to stick to
> ptransform of proj4?

The ob_tran is indeed an awkward beast, as witnessed by a lot of traffic 
on mailing lists, for example http://trac.osgeo.org/gdal/ticket/4285. It 
is as you say counter-intuitive. It is typically used by modellers rather 
than cartographers.

I see that (using paste to try to overcome mailer linebreaks):

crds <- matrix(data=c(9.05, 48.52), ncol=2)
library(rgdal)
#Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
project(crds*(pi/180), paste("+proj=ob_tran +o_proj=longlat",
  "+o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"),
  TRUE)

gives the result you stipulate (-5.917698  -1.87195), as does:

spPoint <- SpatialPoints(coords=crds*(pi/180),
  proj4string=CRS(paste("+proj=ob_tran +o_proj=longlat +o_lon_p=-162",
  "+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs")))
spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"))

by casting the input coordinates to radians first, but I don't understand 
why. I've seen reports of the use of -m=180/pi for command line proj, but 
cannot see how to apply the scaling factor within a proj4 string.

If this needs to be done a lot, we'll need a way of multiplying the 
coordinates by (pi/180) for Spatial* objects, possibly by extending 
elide() methods in maptools.

Does this make sense?

Roger

>
> Best regards,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Aug 15 17:43:11 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Aug 2012 17:43:11 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>

On Wed, 15 Aug 2012, Roger Bivand wrote:

> On Wed, 15 Aug 2012, Martin Ivanov wrote:
>
>> Dear R users,
>> I have a rotated latitude-longitude grid with coordinates of the north pole 
>> POLE_LAT=39.25 and POLE_LON=-162 on a sphere with radius 6371 km. My data 
>> are on a conventional longlat grid on the same sphere. I found that I can 
>> transform my data to the rotated grid by means of proj4's ptransform. For 
>> example:
>> crds <- matrix(data=c(9.05, 48.52), ncol=2); # a pair of geographical 
>> coordinates
>> 
>> rot_crds <- 180/pi*ptransform(data=crds*pi/180, dst.proj="+proj=longlat 
>> +ellps=sphere +no_defs",
>>  src.proj="+proj=ob_tran +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 
>> +lon_0=180 +ellps=sphere +no_defs")[1:2]
>> > rot_crds
>> [1] -5.917698 -1.871950 # these are the correct coordinates in the rotated 
>> grid
>> You may notice that to get the correct result I have to swap the source and 
>> destination CRS.
>> 
>> I would be happy if I could reproduce that result with the sp function 
>> spTransform, but I have no luck:
>> spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=longlat 
>> +ellps=sphere +no_defs"));
>> try1 <- spTransform(spPoint, CRS("+proj=ob_tran +o_proj=longlat 
>> +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"));
>> > try1
>> SpatialPoints:
>>      coords.x1 coords.x2
>> [1,]  2.896087   1.37327# this result is not correct
>>
>>  I also tried with swappped source and destination:
>> 
>> > spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=ob_tran 
>> +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
>> +no_defs"));
>> + try2 <- spTransform(spPoint, CRS("+proj=longlat +ellps=sphere 
>> +no_defs"));
>> + try2
>> SpatialPoints:
>>      coords.x1 coords.x2
>> [1,] -170.7407 -46.63283 # this is also incorrect
>> 
>> My question is, is it possible to use spTransform for the kind of 
>> coordinate conversion I need? Or do I have to stick to
>> ptransform of proj4?
>
> The ob_tran is indeed an awkward beast, as witnessed by a lot of traffic on 
> mailing lists, for example http://trac.osgeo.org/gdal/ticket/4285. It is as 
> you say counter-intuitive. It is typically used by modellers rather than 
> cartographers.
>
> I see that (using paste to try to overcome mailer linebreaks):
>
> crds <- matrix(data=c(9.05, 48.52), ncol=2)
> library(rgdal)
> #Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> project(crds*(pi/180), paste("+proj=ob_tran +o_proj=longlat",
> "+o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"),
> TRUE)
>
> gives the result you stipulate (-5.917698  -1.87195), as does:
>
> spPoint <- SpatialPoints(coords=crds*(pi/180),
> proj4string=CRS(paste("+proj=ob_tran +o_proj=longlat +o_lon_p=-162",
> "+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs")))
> spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"))
>
> by casting the input coordinates to radians first, but I don't understand 
> why.

It is the reversal of source and destination projection definitions in 
rgdal::project() and spTransform() methods that is defeating the logic - 
since the source definition is not +proj=longlat but +proj=ob_trans, the 
input coordinates are not multiplied by DEG_TO_RAD.

I'll look at adding an argument to rgdal::project() and spTransform() 
methods to permit the user to say that +proj=ob_tran should be respected, 
which will then give a warning and be ignored if no ob_tran is found. Does 
that seem like a resolution? Can you install rgdal from source from 
R-Forge (once I'm done), or would you prefer a Windows binary from 
Win-builder?

Roger

> I've seen reports of the use of -m=180/pi for command line proj, but 
> cannot see how to apply the scaling factor within a proj4 string.
>
> If this needs to be done a lot, we'll need a way of multiplying the 
> coordinates by (pi/180) for Spatial* objects, possibly by extending elide() 
> methods in maptools.
>
> Does this make sense?
>
> Roger
>
>> 
>> Best regards,
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From martin.ivanov at ifg.uni-tuebingen.de  Thu Aug 16 11:01:47 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Thu, 16 Aug 2012 11:01:47 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
Message-ID: <502CB6FB.4060504@ifg.uni-tuebingen.de>

Dear Roger,

Thank You very much for Your swift response. I did some testing of the 
rgdal revision.
crds <- matrix(data=c(9.05, 48.52), ncol=2)
spPoint <- SpatialPoints(coords=crds,
  proj4string=CRS(paste("+proj=ob_tran +o_proj=longlat +o_lon_p=-162",
  "+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs")))

spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=TRUE)
sppdf <- SpatialPointsDataFrame(coords=spPoint, data=data.frame(100), 
proj4string=proj4string(spPoint))
  spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=TRUE)
sppdf at coords <- crds*pi/180
spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=TRUE)

1. If you run the code, you will see that the new parameter use_ob_tran 
works for the spatial point, but does not
for the SpatialPointsDataFrame. You still have to multiply the 
coordinates of the data frame by pi/180.
2. Oddly, if you run:
spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=FALSE)
Error in spTransform(spPoint, CRS("+proj=longlat +ellps=sphere 
+no_defs"),  :
   object 'use_ob_tran' not found

while with the data frame you get no such complaint:
spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=FALSE)

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From Roger.Bivand at nhh.no  Thu Aug 16 12:06:25 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Aug 2012 12:06:25 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <502CB6FB.4060504@ifg.uni-tuebingen.de>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<502CB6FB.4060504@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>

On Thu, 16 Aug 2012, Martin Ivanov wrote:

> Dear Roger,
>
> Thank You very much for Your swift response. I did some testing of the rgdal 
> revision.
> crds <- matrix(data=c(9.05, 48.52), ncol=2)
> spPoint <- SpatialPoints(coords=crds,
> proj4string=CRS(paste("+proj=ob_tran +o_proj=longlat +o_lon_p=-162",
> "+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs")))
>
> spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE)
> sppdf <- SpatialPointsDataFrame(coords=spPoint, data=data.frame(100), 
> proj4string=proj4string(spPoint))
> spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE)
> sppdf at coords <- crds*pi/180
> spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE)
>
> 1. If you run the code, you will see that the new parameter use_ob_tran works 
> for the spatial point, but does not
> for the SpatialPointsDataFrame. You still have to multiply the coordinates of 
> the data frame by pi/180.
> 2. Oddly, if you run:
> spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=FALSE)
> Error in spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"),  :
>  object 'use_ob_tran' not found
>
> while with the data frame you get no such complaint:
> spTransform(sppdf, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=FALSE)

Thanks, very helpful report - I had missed passing through the arguments 
for the Spatial*DataFrame methods. In addition, when use_ob_tran was given 
but FALSE, the internal copy wasn't created - it is now in revision 353.

Best wishes,

Roger

>
> Best regards,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From M.Kuntz at stud.uni-heidelberg.de  Thu Aug 16 14:29:28 2012
From: M.Kuntz at stud.uni-heidelberg.de (M.Kuntz at stud.uni-heidelberg.de)
Date: Thu, 16 Aug 2012 14:29:28 +0200
Subject: [R-sig-Geo] GLS/OLS
Message-ID: <20120816142928.t711nbbjsw0ow08w@wwwmail.urz.uni-heidelberg.de>


Dear List members,

after reading several old mail from R-sig-geo and checking the gstat  
manual there is still sth. confusion about the way how gstat  
calculates the Regressions.
On the on hand some mails, as the the following one, tell that GLS is  
used to estimate the Regressioncoefficients and the error:
http://mailman.geo.uu.nl/pipermail/gstat-info/2006q3/000091.html

> I am not quite clear how gls works.  Is this an iterative approach, some
> thing like
> 1) Use OLS to estimate the betas (globally)
> 2) Calcualte the residuals
> 3) Calculate and model the variogram
> 4) Get the covariance matrix
> 5) Use GLS to calculate the betas
> 6) Go back to (2) and repeat until convergence.
> The resulting betas and variogram are then used for kriging, as
> described above.  Is this right?
>
>
No, the order gstat does in a single pass is 4, 5, 2, 3: you feed it
with a variogram, this variogram is used to obtain gls residuals instead
of ols. After 3, you could repeat this, but gstat has not an automated
looping mechanism for this (the interactive menu can be used for it, but
requires the user to do the iterations).

So does the gstat manual as it tells that there is the possibility of  
calculating only the regressioncoefficients by using
> predict( ..., BLUE=TRUE), which implicates that GLS is used.

On the other hand there exists the command
> gstat( ..., set = list(gls = 1) )
and the manual reads as follows:

"By default, the residuals gstat uses are ordinary least squares residuals
(i.e. regular regression residuals), meaning that for the sake of estimating
the trend, observations are considered independent. To honour a dependence
structure present, generalised least squares residuals can be  
calculated instead.
For this, a variogram model to define the covariance structure is needed. In
the following example..."

which implicates that by default OLS is used.

So I am asking: What exactly occurs, when I use the predict.gstat command?
Is it possibly that, by default, the Trend is fitted by OLS and then  
the variogram if fitted by GLS? But why is there this BLUE=TRUE option  
for the predict.gstat command?



Any help would be appreciated.

Cheers!  Michael


From thi_veloso at yahoo.com.br  Thu Aug 16 15:02:29 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 16 Aug 2012 06:02:29 -0700 (PDT)
Subject: [R-sig-Geo] Masking a raster changes its min and max values
Message-ID: <1345122149.65429.YahooMailNeo@web121903.mail.ne1.yahoo.com>

? Dear colleagues,

? To mask this image (note max and min values):

> lai.cal
class ? ? ? : RasterLayer?
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell)
resolution ?: 0.00898, 0.00898 ?(x, y)
extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0?
values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081042_8103108.grd?
layer name ?: layer?
min value ? : 0?
max value ? : 7?

? I am using raster's mask function. Here is the raster object I am using to mask (which is composed only of 0's and NA's):

> qc.cal
class ? ? ? : RasterLayer?
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell)
resolution ?: 0.00898, 0.00898 ?(x, y)
extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0?
values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_080805_76515.grd?
layer name ?: layer?
min value ? : 1?
max value ? : 1?


? However, please see the min and max values of the resulting raster:

> laiqc <- mask (lai.cal,qc.cal
> laiqc
class ? ? ? : RasterLayer?
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell)
resolution ?: 0.00898, 0.00898 ?(x, y)
extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0?
values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081343_910828.grd?
layer name ?: layer?
min value ? : 0.1?
max value ? : 6.9?

? Does anyone know why this happens? How can I prevent this from happening?

? Latest R version running with updated packages. See below my session info:

> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C ? ? ? ? ? ? ? LC_TIME=en_US.UTF-8 ? ? ? ?LC_COLLATE=en_US.UTF-8 ? ?
?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8 ? ?LC_PAPER=C ? ? ? ? ? ? ? ? LC_NAME=C ? ? ? ? ? ? ? ??
?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C ? ? ? ? ? ? LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C ? ? ??

attached base packages:
[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

other attached packages:
[1] ncdf_1.6.6 ? ? ?raster_2.0-08 ? maptools_0.8-16 lattice_0.20-6 ?foreign_0.8-50 ?rgdal_0.7-12 ? ?sp_0.9-99 ? ? ?

loaded via a namespace (and not attached):
[1] grid_2.15.1 ?tools_2.15.1

? Thanks in advance,
? Thiago.



From martin.ivanov at ifg.uni-tuebingen.de  Thu Aug 16 15:15:35 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Thu, 16 Aug 2012 15:15:35 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<502CB6FB.4060504@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>
Message-ID: <502CF277.6010504@ifg.uni-tuebingen.de>

Dear Roger,

Thank You very much for Your responsiveness. I tested Your new revision 
with points, data frames and pixels and
everything seems to be ok. It is now only this annoying 
counter-intuitive discrepancy between source and target proj,
but it is not really an obstacle. It seems to come from proj4 itself. 
There one has to use proj to get to the unrotated coordinates from the
rotated, and invproj to get the rotated from the unrotated ones. See 
http://lists.maptools.org/pipermail/proj/2011-October/005906.html.

I would also like to answer Your question from Your first reply, if such 
transformations with rotated grids are often encountered.
In Meteorology, especially when it come to regional weather and climate 
models, the calculations are performed in a grid,
suitably adjusted for the region of interest, so that the equator of the 
grid passes through the region. Thus the
distortions from the planar representation are minimized. So all the 
data coordinates have to be first transformed to that rotated grid.
And then, when the calculations are over, one has to switch back to the 
normal coordinates to make plots ready to use.
You could take a look for example at the following document
http://cordex.dmi.dk/joomla/images/CORDEX/cordex_archive_specifications_120720.pdf
to get an idea.

Concerning the use_ob_tran parameter, yes, it is a solution. Yet I am 
not able to think of a situation where one would need it set to FALSE,
but probably people with more experience and from other disciplines can 
contradict me.

Thank You very much once again for the support.

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From simon.ohanlon at imperial.ac.uk  Thu Aug 16 15:47:46 2012
From: simon.ohanlon at imperial.ac.uk (O'Hanlon, Simon J)
Date: Thu, 16 Aug 2012 13:47:46 +0000
Subject: [R-sig-Geo] Masking a raster changes its min and max values
In-Reply-To: <1345122149.65429.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <1345122149.65429.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <7AE0828DCFFC0144817331B53EDC11A025D46D42@icexch-m5.ic.ac.uk>

Hi Thiago,
mask() simply creates a new raster which sets any cells in the calls first argument (lai.cal) to NA if they are NA in the second argument (qc.cal), the mask raster. As far as I am aware it does not otherwise manipulate values in your original raster. 

I would conclude, that since your rasters have the same extent, resolution and coordinate system, that your mask  raster qc.cal contains NA cells over all cells in your query raster which are 0 and 7. I notice that in your min/max value in qc.cal is 1 not 0 (although this wouldn't necessarily matter, only the location of NA / not NA cells matters).

I do wonder however if you are implying that your data in the lai.cal raster are supposed to be integer values between 0 and 7?

You could just try to plot both rasters to see where the mask non-NA values are and where the 0 and 7 values are in your lai.cal raster. This may show you what is happening?

As it stands it doesn't seem like anything is 'wrong'  as such. Perhaps if this is not what you want, you can outline what output you would like to achieve.

HTH,

Simon

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Thiago Veloso
Sent: 16 August 2012 14:02
To: R-SIG list
Subject: [R-sig-Geo] Masking a raster changes its min and max values

? Dear colleagues,

? To mask this image (note max and min values):

> lai.cal
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081042_8103108.grd
layer name ?: layer
min value ? : 0
max value ? : 7?

? I am using raster's mask function. Here is the raster object I am using to mask (which is composed only of 0's and NA's):

> qc.cal
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_080805_76515.grd
layer name ?: layer
min value ? : 1
max value ? : 1?


? However, please see the min and max values of the resulting raster:

> laiqc <- mask (lai.cal,qc.cal
> laiqc
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081343_910828.grd
layer name ?: layer
min value ? : 0.1
max value ? : 6.9?

? Does anyone know why this happens? How can I prevent this from happening?

? Latest R version running with updated packages. See below my session info:

> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C ? ? ? ? ? ? ? LC_TIME=en_US.UTF-8 ? ? ? ?LC_COLLATE=en_US.UTF-8
?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8 ? ?LC_PAPER=C ? ? ? ? ? ? ? ? LC_NAME=C
?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C ? ? ? ? ? ? LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C ? ? ??

attached base packages:
[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

other attached packages:
[1] ncdf_1.6.6 ? ? ?raster_2.0-08 ? maptools_0.8-16 lattice_0.20-6 ?foreign_0.8-50 ?rgdal_0.7-12 ? ?sp_0.9-99 ? ? ?

loaded via a namespace (and not attached):
[1] grid_2.15.1 ?tools_2.15.1

? Thanks in advance,
? Thiago.


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tyler.j.frazier at tu-berlin.de  Thu Aug 16 17:05:49 2012
From: tyler.j.frazier at tu-berlin.de (Frazier, Tyler James)
Date: Thu, 16 Aug 2012 15:05:49 +0000
Subject: [R-sig-Geo] interacting with plots
Message-ID: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120816/cb9927fb/attachment.pl>

From bohara at unm.edu  Thu Aug 16 17:47:07 2012
From: bohara at unm.edu (Alok K Bohara, PhD)
Date: Thu, 16 Aug 2012 09:47:07 -0600
Subject: [R-sig-Geo] exporting neighbor list to a text file...
In-Reply-To: <CAAcGz98OHEz6nZN0dQHdoLa1EDkiMZZnthU3R8jvoJcUEKt-eA@mail.gmail.com>
References: <5df6db2151cb3d5d79940be3d8614d0843b0cfda@sitemail.hostway.com>
	<CAAcGz98OHEz6nZN0dQHdoLa1EDkiMZZnthU3R8jvoJcUEKt-eA@mail.gmail.com>
Message-ID: <502D15FB.9020308@unm.edu>

(I am new to this group.)   I have a two-part question.  I have a shape 
file for the US states (excluding Alaska and Hawaii)

I am trying to export (or save)  the nearest neighbor list to a csv or 
text file.

This is what I did

***
USs <- readShapeSpatial("usa")

# Creating Neighbor List
USs.nb <- poly2nb(USs)
IDs <- row.names(as(USs, "data.frame"))

NeighMap <- nb2gra(USs.nb)
NeighList <- get.neighbor(NeighMap, IDs)
summary(NeighList)

(IDs extracted above begins from 0, 1, 2,... 50).

***

Is there any way I could save/export the neigbor list as follows where 
the first line is the  number of cells/states (49) and the rest of the 
lines as whown below:

49
1  3 4 18 21
2  2 5 4
3  2 8 12 15 32
.
.
49  3 9 11
  etc...

****

Thanks.


Sincerely,

Alok Bohara
UNM


From Roger.Bivand at nhh.no  Thu Aug 16 18:20:41 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Aug 2012 18:20:41 +0200 (CEST)
Subject: [R-sig-Geo] exporting neighbor list to a text file...
In-Reply-To: <502D15FB.9020308@unm.edu>
References: <5df6db2151cb3d5d79940be3d8614d0843b0cfda@sitemail.hostway.com>
	<CAAcGz98OHEz6nZN0dQHdoLa1EDkiMZZnthU3R8jvoJcUEKt-eA@mail.gmail.com>
	<502D15FB.9020308@unm.edu>
Message-ID: <alpine.LRH.2.02.1208161805080.27312@reclus.nhh.no>

On Thu, 16 Aug 2012, Alok K Bohara, PhD wrote:

> (I am new to this group.)   I have a two-part question.  I have a shape file 
> for the US states (excluding Alaska and Hawaii)
>
> I am trying to export (or save)  the nearest neighbor list to a csv or text 
> file.

>
> This is what I did
>
> ***
> USs <- readShapeSpatial("usa")
>
> # Creating Neighbor List
> USs.nb <- poly2nb(USs)
> IDs <- row.names(as(USs, "data.frame"))
>
> NeighMap <- nb2gra(USs.nb)
> NeighList <- get.neighbor(NeighMap, IDs)
> summary(NeighList)
>
> (IDs extracted above begins from 0, 1, 2,... 50).
>
> ***
>
> Is there any way I could save/export the neigbor list as follows where the 
> first line is the  number of cells/states (49) and the rest of the lines as 
> whown below:

Do you have a reason for using this format rather than the standard GAL 
format, which is:

n
1 #neigh1
neigh11 neigh12 ...
2 #neigh2
neigh21 neigh22 ...

etc, that is two lines per observation, the first giving its ID and the 
count of neighbours, and which can be read by many applications?

The following will do what you want, but I don't think you should:

library(spdep)
data(columbus)
tf <- tempfile()
con <- file(tf, open="wt")
n <- length(col.gal.nb)
writeLines(paste(n), con=con)
for (i in seq(along=col.gal.nb))
  writeLines(paste(i, paste(col.gal.nb[[i]], collapse=" ")), con=con)
close(con)
file.show(tf)

read.gal() and write.nb.gal() handle settings in which the observations 
have IDs which are not necessarily the integers 1:n, and do sanity 
checking.

Hope this helps,

Roger

>
> 49
> 1  3 4 18 21
> 2  2 5 4
> 3  2 8 12 15 32
> .
> .
> 49  3 9 11
> etc...
>
> ****
>
> Thanks.
>
>
> Sincerely,
>
> Alok Bohara
> UNM
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jmblanco at ub.edu  Thu Aug 16 18:23:52 2012
From: jmblanco at ub.edu (=?utf-8?B?Sm9zw6kgTS4gQmxhbmNvIE1vcmVubw==?=)
Date: Thu, 16 Aug 2012 16:23:52 +0000
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>

Dear users and experts,
I know that my question is not strictly R-related, but... Is there any good strategy (preferably already implemented in R) for estimating interaction radii of a MultiStrauss model?

I have been working with  function profilepl in spatstat, but I frequently have to evaluate I too many combinations of interaction radii (1000's) and not even then I am sure that I get the right answer, because either I have likelihood maxima that are very narrow (easy to miss; it is one of the cases that I fave faced), or two local maxima with a large separation among them, leading to very different answers (from inhibition to gamma parameters higher than one, which if I have properly understood, are not "desirable") or changing the evaluation grid slightly I get different (or very different) answers.

Should I just resign, take a deep breath and evaluate a grid of interaction radii of 10,000's?
Cheers,

Jos? M. Blanco
---------------------------------------
Jos? M. Blanco-Moreno
Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 643
08028 Barcelona
SPAIN
---------------------------------------
phone: (+34) 934 039 863
fax: (+34) 934 112 842
---------------------------------------

Currently:
National Wildlife Research Center
Environment Canada
Science & Technology
National Wildlife Research Centre
1125 Colonel By Drive, Raven Rd.
Carleton University
Ottawa, Ontario, Canada K1A 0H3


Aquest correu electr?nic i els annexos poden contenir informaci? confidencial o protegida legalment i est? adre?at exclusivament a la persona o entitat destinat?ria. Si no sou el destinatari final o la persona encarregada de rebre?l, no esteu autoritzat a llegir-lo, retenir-lo, modificar-lo, distribuir-lo, copiar-lo ni a revelar-ne el contingut. Si heu rebut aquest correu electr?nic per error, us preguem que n?informeu al remitent i que elimineu del sistema el missatge i el material annex que pugui contenir. Gr?cies per la vostra col?laboraci?.

Este correo electr?nico y sus anexos pueden contener informaci?n confidencial o legalmente protegida y est? exclusivamente dirigido a la persona o entidad destinataria. Si usted no es el destinatario final o la persona encargada de recibirlo, no est? autorizado a leerlo, retenerlo, modificarlo, distribuirlo, copiarlo ni a revelar su contenido. Si ha recibido este mensaje electr?nico por error, le rogamos que informe al remitente y elimine del sistema el mensaje y el material anexo que pueda contener. Gracias por su colaboraci?n.

This email message and any documents attached to it may contain confidential or legally protected material and are intended solely for the use of the individual or organization to whom they are addressed. We remind you that if you are not the intended recipient of this email message or the person responsible for processing it, then you are not authorized to read, save, modify, send, copy or disclose any of its contents. If you have received this email message by mistake, we kindly ask you to inform the sender of this and to eliminate both the message and any attachments it carries from your account. Thank you for your collaboration.

From 538280 at gmail.com  Thu Aug 16 18:33:10 2012
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 16 Aug 2012 10:33:10 -0600
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
Message-ID: <CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>

You could try something like:

library(rgdal)
library(sp)
scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
plot(scot_BNG)
tmp <- SpatialPoints(locator(1))
proj4string(tmp) <- proj4string(scot_BNG)
over(tmp, scot_BNG)
# or
tmp2 <- over(scot_BNG, tmp)
plot( scot_BNG[!is.na(tmp2),], add=TRUE, col='green')

Does that do what you want?

On Thu, Aug 16, 2012 at 9:05 AM, Frazier, Tyler James
<tyler.j.frazier at tu-berlin.de> wrote:
> Hello,
>
> I am new to this group and am still working to figure out many things.  I have a kind of basic question, regarding using R and interacting with plots.  I have been exploring using the spplot in the sp package as a means to interact with plots, but haven't figured out how to use the function to identify specific attributes associated with an individual polygons.  My code is really basic, I simply
>
> ea <- readOGR(".","ghana_eas_ft")
> plot(ea)
>
> is it possible to plot the map in a way where I can use the cursor in R to chose and identify attributes associated with a polygon.  Also here is the output of str(ea) which follows with a lot of information after the @polygons which I assume is part of the sp class structure.
>
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>   ..@ data       :'data.frame': 12438 obs. of  3 variables:
>   .. ..$ EA_NOS   : Factor w/ 1133 levels "001-005, 340-342",..: 1110 986 985 976 982 983 978 741 974 975 ...
>   .. ..$ REG_CODE : Factor w/ 10 levels "01","02","03",..: 1 1 1 1 1 1 1 1 1 1 ...
>   .. ..$ DIST_CODE: Factor w/ 18 levels "01","02","03",..: 9 9 9 9 9 9 9 9 9 9 ...
>   ..@ polygons   :List of 12438
>
> I am wondering if there are newer packages which provide the identify function for polygons.  Currently I am referencing the Applied Spatial Data Analysis with R text.
>
> Thanks!
> Ty
>
> ---------------------------------------------------
> Dr. Tyler Frazier, AICP
> Senior Research Scientist
> Department of Transportation System Planning and Telematics
> Technische Universit?t Berlin
> Sekretariat SG 12
> Salzufer 17-19
> 10587 Berlin
> fon:  +49 30 314 22418
> fax:  +49 30 314 26269
> www.vsp.tu-berlin.de<http://www.vsp.tu-berlin.de>
> www.matsim.org<http://www.matsim.org>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From tyler.j.frazier at tu-berlin.de  Thu Aug 16 19:09:21 2012
From: tyler.j.frazier at tu-berlin.de (Frazier, Tyler James)
Date: Thu, 16 Aug 2012 17:09:21 +0000
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
Message-ID: <9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120816/ee8c1c7b/attachment.pl>

From 538280 at gmail.com  Thu Aug 16 19:30:28 2012
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 16 Aug 2012 11:30:28 -0600
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
Message-ID: <CAFEqCdwy4W=TVgmifVs5wZaKtYiEAzk+vmvnZH6sn0rLwE-+bw@mail.gmail.com>

My example used locator(1) to get one click, but if you just use
locator() (without the 1) then you can click in as many places as you
want, then it should show you the info for all of them).  If you want
to click and see the results, then click again and see the new
results, etc. then you could put my code into a while loop.  Panning
and zooming using the mouse would be a bit more difficult, but you
might get a similar effect by setting the limits when plotting (and
you can get limits to set using the locator function again).

On Thu, Aug 16, 2012 at 11:09 AM, Frazier, Tyler James
<tyler.j.frazier at tu-berlin.de> wrote:
> Hi Greg,
>
> That works but I can only chose one polygon and have its attributes
> identified.  I want to plot my map, then be able to pan and zoom, and chose
> several polygons to have their attributes identified (one at a time would be
> fine).
>
> Should I be exploring maptools?
>
> Thanks,
> Ty
>
> On Aug 16, 2012, at 6:33 PM, Greg Snow wrote:
>
> You could try something like:
>
> library(rgdal)
> library(sp)
> scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
> plot(scot_BNG)
> tmp <- SpatialPoints(locator(1))
> proj4string(tmp) <- proj4string(scot_BNG)
> over(tmp, scot_BNG)
> # or
> tmp2 <- over(scot_BNG, tmp)
> plot( scot_BNG[!is.na(tmp2),], add=TRUE, col='green')
>
> Does that do what you want?
>
> On Thu, Aug 16, 2012 at 9:05 AM, Frazier, Tyler James
> <tyler.j.frazier at tu-berlin.de> wrote:
>
> Hello,
>
>
> I am new to this group and am still working to figure out many things.  I
> have a kind of basic question, regarding using R and interacting with plots.
> I have been exploring using the spplot in the sp package as a means to
> interact with plots, but haven't figured out how to use the function to
> identify specific attributes associated with an individual polygons.  My
> code is really basic, I simply
>
>
> ea <- readOGR(".","ghana_eas_ft")
>
> plot(ea)
>
>
> is it possible to plot the map in a way where I can use the cursor in R to
> chose and identify attributes associated with a polygon.  Also here is the
> output of str(ea) which follows with a lot of information after the
> @polygons which I assume is part of the sp class structure.
>
>
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>
>  ..@ data       :'data.frame': 12438 obs. of  3 variables:
>
>  .. ..$ EA_NOS   : Factor w/ 1133 levels "001-005, 340-342",..: 1110 986 985
> 976 982 983 978 741 974 975 ...
>
>  .. ..$ REG_CODE : Factor w/ 10 levels "01","02","03",..: 1 1 1 1 1 1 1 1 1
> 1 ...
>
>  .. ..$ DIST_CODE: Factor w/ 18 levels "01","02","03",..: 9 9 9 9 9 9 9 9 9
> 9 ...
>
>  ..@ polygons   :List of 12438
>
>
> I am wondering if there are newer packages which provide the identify
> function for polygons.  Currently I am referencing the Applied Spatial Data
> Analysis with R text.
>
>
> Thanks!
>
> Ty
>
>
>
>
>
>
>
>



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From thi_veloso at yahoo.com.br  Thu Aug 16 20:29:14 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 16 Aug 2012 11:29:14 -0700 (PDT)
Subject: [R-sig-Geo] Masking a raster changes its min and max values
In-Reply-To: <7AE0828DCFFC0144817331B53EDC11A025D46D42@icexch-m5.ic.ac.uk>
References: <1345122149.65429.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<7AE0828DCFFC0144817331B53EDC11A025D46D42@icexch-m5.ic.ac.uk>
Message-ID: <1345141754.96516.YahooMailNeo@web121905.mail.ne1.yahoo.com>

? Simon,

? Thanks for this valuable discussion. Yes, I do think that having the range changed could be an issue. In the case I showed, mask operation appears to have changed all "0" values of the original raster to "0.1" and all "7" values to "6.9", therefore creating differences in the image. This is my point of view, and please tell me if I am wrong.

? However, it seemed to be an error of the quick stats produced by R. Graphically, by plotting both original and masked images, it looks that the masking operation went ok: no changes in the range and "NA" values in the mask applied to the masked image, which is the result I expected.?To eliminate any remaining doubs, gdalinfo reports that values haven't been touched. See below:

thiago at pocoar:~/Desktop$ gdalinfo original_lai.tif?
Driver: GTiff/GeoTIFF
Files: original_lai.tif
Size is 8289, 5568
Coordinate System is:
GEOGCS["WGS 84",
? ? DATUM["WGS_1984",
? ? ? ? SPHEROID["WGS 84",6378137,298.257223563,
? ? ? ? ? ? AUTHORITY["EPSG","7030"]],
? ? ? ? AUTHORITY["EPSG","6326"]],
? ? PRIMEM["Greenwich",0],
? ? UNIT["degree",0.0174532925199433],
? ? AUTHORITY["EPSG","4326"]]
Origin = (-104.432583131000001,9.999999999000000)
Pixel Size = (0.008980000000000,-0.008980000000000)
Metadata:
? AREA_OR_POINT=Area
Image Structure Metadata:
? COMPRESSION=LZW
? INTERLEAVE=BAND
Corner Coordinates:
Upper Left ?(-104.4325831, ?10.0000000) (104d25'57.30"W, 10d 0' 0.00"N)
Lower Left ?(-104.4325831, -40.0006400) (104d25'57.30"W, 40d 0' 2.30"S)
Upper Right ( -29.9973631, ?10.0000000) ( 29d59'50.51"W, 10d 0' 0.00"N)
Lower Right ( -29.9973631, -40.0006400) ( 29d59'50.51"W, 40d 0' 2.30"S)
Center ? ? ?( -67.2149731, -15.0003200) ( 67d12'53.90"W, 15d 0' 1.15"S)
Band 1 Block=8289x1 Type=Float32, ColorInterp=Gray
? Min=0.000 Max=7.000?
? Minimum=0.000, Maximum=7.000, Mean=0.000, StdDev=0.000
? NoData Value=-999
? Metadata:
? ? STATISTICS_MAXIMUM=7
? ? STATISTICS_MEAN=0
? ? STATISTICS_MINIMUM=0
? ? STATISTICS_STDDEV=0
----------------------------------------------------

thiago at pocoar:~/Desktop$ gdalinfo masked_lai.tif?

Driver: GTiff/GeoTIFF
Files: masked_lai.tif
Size is 8289, 5568
Coordinate System is:
GEOGCS["WGS 84",
? ? DATUM["WGS_1984",
? ? ? ? SPHEROID["WGS 84",6378137,298.257223563,
? ? ? ? ? ? AUTHORITY["EPSG","7030"]],
? ? ? ? AUTHORITY["EPSG","6326"]],
? ? PRIMEM["Greenwich",0],
? ? UNIT["degree",0.0174532925199433],
? ? AUTHORITY["EPSG","4326"]]
Origin = (-104.432583131000001,9.999999999000000)
Pixel Size = (0.008980000000000,-0.008980000000000)
Metadata:
? AREA_OR_POINT=Area
Image Structure Metadata:
? COMPRESSION=LZW
? INTERLEAVE=BAND
Corner Coordinates:
Upper Left ?(-104.4325831, ?10.0000000) (104d25'57.30"W, 10d 0' 0.00"N)
Lower Left ?(-104.4325831, -40.0006400) (104d25'57.30"W, 40d 0' 2.30"S)
Upper Right ( -29.9973631, ?10.0000000) ( 29d59'50.51"W, 10d 0' 0.00"N)
Lower Right ( -29.9973631, -40.0006400) ( 29d59'50.51"W, 40d 0' 2.30"S)
Center ? ? ?( -67.2149731, -15.0003200) ( 67d12'53.90"W, 15d 0' 1.15"S)
Band 1 Block=8289x1 Type=Float32, ColorInterp=Gray
? Min=0.000 Max=7.000?
? Minimum=0.000, Maximum=7.000, Mean=0.000, StdDev=0.000
? NoData Value=-999
? Metadata:
? ? STATISTICS_MAXIMUM=7
? ? STATISTICS_MEAN=0
? ? STATISTICS_MINIMUM=0
? ? STATISTICS_STDDEV=0
----------------------------------------------------


? Regards,
? Thiago.


----- Original Message -----
From: "O'Hanlon, Simon J" <simon.ohanlon at imperial.ac.uk>
To: Thiago Veloso <thi_veloso at yahoo.com.br>; R-SIG list <r-sig-geo at r-project.org>
Cc: 
Sent: Thursday, August 16, 2012 10:47 AM
Subject: RE: [R-sig-Geo] Masking a raster changes its min and max values

Hi Thiago,
mask() simply creates a new raster which sets any cells in the calls first argument (lai.cal) to NA if they are NA in the second argument (qc.cal), the mask raster. As far as I am aware it does not otherwise manipulate values in your original raster. 

I would conclude, that since your rasters have the same extent, resolution and coordinate system, that your mask? raster qc.cal contains NA cells over all cells in your query raster which are 0 and 7. I notice that in your min/max value in qc.cal is 1 not 0 (although this wouldn't necessarily matter, only the location of NA / not NA cells matters).

I do wonder however if you are implying that your data in the lai.cal raster are supposed to be integer values between 0 and 7?

You could just try to plot both rasters to see where the mask non-NA values are and where the 0 and 7 values are in your lai.cal raster. This may show you what is happening?

As it stands it doesn't seem like anything is 'wrong'? as such. Perhaps if this is not what you want, you can outline what output you would like to achieve.

HTH,

Simon

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Thiago Veloso
Sent: 16 August 2012 14:02
To: R-SIG list
Subject: [R-sig-Geo] Masking a raster changes its min and max values

? Dear colleagues,

? To mask this image (note max and min values):

> lai.cal
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081042_8103108.grd
layer name ?: layer
min value ? : 0
max value ? : 7?

? I am using raster's mask function. Here is the raster object I am using to mask (which is composed only of 0's and NA's):

> qc.cal
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_080805_76515.grd
layer name ?: layer
min value ? : 1
max value ? : 1?


? However, please see the min and max values of the resulting raster:

> laiqc <- mask (lai.cal,qc.cal
> laiqc
class ? ? ? : RasterLayer
dimensions ?: 5568, 8289, 46153152 ?(nrow, ncol, ncell) resolution ?: 0.00898, 0.00898 ?(x, y) extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax) coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 values ? ? ?: /mnt/disco3/MODIS/original_images/temp/R_raster_tmp/thiago/raster_tmp_2012-08-16_081343_910828.grd
layer name ?: layer
min value ? : 0.1
max value ? : 6.9?

? Does anyone know why this happens? How can I prevent this from happening?

? Latest R version running with updated packages. See below my session info:

> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C ? ? ? ? ? ? ? LC_TIME=en_US.UTF-8 ? ? ? ?LC_COLLATE=en_US.UTF-8
?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8 ? ?LC_PAPER=C ? ? ? ? ? ? ? ? LC_NAME=C
?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C ? ? ? ? ? ? LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C ? ? ??

attached base packages:
[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

other attached packages:
[1] ncdf_1.6.6 ? ? ?raster_2.0-08 ? maptools_0.8-16 lattice_0.20-6 ?foreign_0.8-50 ?rgdal_0.7-12 ? ?sp_0.9-99 ? ? ?

loaded via a namespace (and not attached):
[1] grid_2.15.1 ?tools_2.15.1

? Thanks in advance,
? Thiago.


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From tyler.j.frazier at tu-berlin.de  Thu Aug 16 20:47:47 2012
From: tyler.j.frazier at tu-berlin.de (Frazier, Tyler James)
Date: Thu, 16 Aug 2012 18:47:47 +0000
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <CAFEqCdwy4W=TVgmifVs5wZaKtYiEAzk+vmvnZH6sn0rLwE-+bw@mail.gmail.com>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdwy4W=TVgmifVs5wZaKtYiEAzk+vmvnZH6sn0rLwE-+bw@mail.gmail.com>
Message-ID: <9659839B4C1FD4498B496BCEFF047B6F74A77B1F@EX-MB1.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120816/c98de99a/attachment.pl>

From karl at huftis.org  Thu Aug 16 21:57:31 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 16 Aug 2012 21:57:31 +0200
Subject: [R-sig-Geo] interacting with plots
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
Message-ID: <2804314.QDDai3i8Vr@ID-99504.news.uni-berlin.de>

Frazier, Tyler James skreiv:

> That works but I can only chose one polygon and have its attributes
> identified.  I want to plot my map, then be able to pan and zoom, and
> chose several polygons to have their attributes identified (one at a time
> would be fine).


I would recommend using QGIS instead of R for these kinds of tasks:

  http://www.qgis.org/

It?s very easy to use, and supports both panning, zooming and clicking
to show polygon attributes (and has a whole lot of other useful features).
You can even integrate QGIS and R.

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From edzer.pebesma at uni-muenster.de  Thu Aug 16 22:13:48 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 16 Aug 2012 22:13:48 +0200
Subject: [R-sig-Geo] GLS/OLS
In-Reply-To: <20120816142928.t711nbbjsw0ow08w@wwwmail.urz.uni-heidelberg.de>
References: <20120816142928.t711nbbjsw0ow08w@wwwmail.urz.uni-heidelberg.de>
Message-ID: <502D547C.3080801@uni-muenster.de>



On 08/16/2012 02:29 PM, M.Kuntz at stud.uni-heidelberg.de wrote:
> 
> Dear List members,
> 
> after reading several old mail from R-sig-geo and checking the gstat
> manual there is still sth. confusion about the way how gstat calculates
> the Regressions.
> On the on hand some mails, as the the following one, tell that GLS is
> used to estimate the Regressioncoefficients and the error:
> http://mailman.geo.uu.nl/pipermail/gstat-info/2006q3/000091.html
> 
>> I am not quite clear how gls works.  Is this an iterative approach, some
>> thing like
>> 1) Use OLS to estimate the betas (globally)
>> 2) Calcualte the residuals
>> 3) Calculate and model the variogram
>> 4) Get the covariance matrix
>> 5) Use GLS to calculate the betas
>> 6) Go back to (2) and repeat until convergence.
>> The resulting betas and variogram are then used for kriging, as
>> described above.  Is this right?
>>
>>
> No, the order gstat does in a single pass is 4, 5, 2, 3: you feed it
> with a variogram, this variogram is used to obtain gls residuals instead
> of ols. After 3, you could repeat this, but gstat has not an automated
> looping mechanism for this (the interactive menu can be used for it, but
> requires the user to do the iterations).
> 
> So does the gstat manual as it tells that there is the possibility of
> calculating only the regressioncoefficients by using
>> predict( ..., BLUE=TRUE), which implicates that GLS is used.
> 
> On the other hand there exists the command
>> gstat( ..., set = list(gls = 1) )
> and the manual reads as follows:
> 
> "By default, the residuals gstat uses are ordinary least squares residuals
> (i.e. regular regression residuals), meaning that for the sake of
> estimating
> the trend, observations are considered independent. To honour a dependence
> structure present, generalised least squares residuals can be calculated
> instead.
> For this, a variogram model to define the covariance structure is
> needed. In
> the following example..."
> 
> which implicates that by default OLS is used.
> 
> So I am asking: What exactly occurs, when I use the predict.gstat command?
> Is it possibly that, by default, the Trend is fitted by OLS and then the
> variogram if fitted by GLS? But why is there this BLUE=TRUE option for
> the predict.gstat command?
> 

predict.gstat will always use the variogram model passed, so uses GLS
unless a pure nugget model is passed (in which case GLS and OLS are
identical).

The example in ?variogram shows how you can get a variogram from GLS
residuals, by default OLS residuals are used HERE (and when dX is not set).

BLUE=TRUE is used in predict.gstat to get the trend component ONLY at
prediction locations, instead of the trend+predicted residual which what
we call kriging.

If all this is confusing from the manuals, please let me know what
exactly confused you.

> 
> 
> Any help would be appreciated.
> 
> Cheers!  Michael
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From 538280 at gmail.com  Thu Aug 16 22:19:59 2012
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 16 Aug 2012 14:19:59 -0600
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <9659839B4C1FD4498B496BCEFF047B6F74A77B1F@EX-MB1.tubit.win.tu-berlin.de>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdwy4W=TVgmifVs5wZaKtYiEAzk+vmvnZH6sn0rLwE-+bw@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77B1F@EX-MB1.tubit.win.tu-berlin.de>
Message-ID: <CAFEqCdz9GW0MzAXkf3WnBVirvGHfW0k7E2pwk6ArxeD2=J4NXg@mail.gmail.com>

Determining if a point is in a polygon is not as simple a task as
might be assumed (I can see that it is in there, why can't the
computer?).  So the computer has to do this check for all (or maybe
just some) 12,438 features, so it is not surprising if it is a little
slow.  The people who created and maintain the sp package would be
better able to address issues of how to speed it up (I am not one of
those who get that credit).  For this task it may be better to use a
tool outside of R, qgis has been mentioned and there may be others.

On Thu, Aug 16, 2012 at 12:47 PM, Frazier, Tyler James
<tyler.j.frazier at tu-berlin.de> wrote:
> Hi Greg,
>
> The example works fine, but running the
>
> tmp <- SpatialPoints(locator())
>
> takes a really long time to execute on my map of 12,438 features each with 3
> fields.
>
> Is there anyway to speed it up?
>
> BTW -- I'm running on MacOS Lion with R 2.14.0.
>
> Also, the output plots to Quartz, which doesn't seem to have a pan function
> and the zoom function is very very limited.
>
> Thanks!
> Ty
>
> On Aug 16, 2012, at 7:30 PM, Greg Snow wrote:
>
> My example used locator(1) to get one click, but if you just use
> locator() (without the 1) then you can click in as many places as you
> want, then it should show you the info for all of them).  If you want
> to click and see the results, then click again and see the new
> results, etc. then you could put my code into a while loop.  Panning
> and zooming using the mouse would be a bit more difficult, but you
> might get a similar effect by setting the limits when plotting (and
> you can get limits to set using the locator function again).
>
> On Thu, Aug 16, 2012 at 11:09 AM, Frazier, Tyler James
> <tyler.j.frazier at tu-berlin.de> wrote:
>
> Hi Greg,
>
>
> That works but I can only chose one polygon and have its attributes
>
> identified.  I want to plot my map, then be able to pan and zoom, and chose
>
> several polygons to have their attributes identified (one at a time would be
>
> fine).
>
>
> Should I be exploring maptools?
>
>
> Thanks,
>
> Ty
>
>
> On Aug 16, 2012, at 6:33 PM, Greg Snow wrote:
>
>
> You could try something like:
>
>
> library(rgdal)
>
> library(sp)
>
> scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
>
> plot(scot_BNG)
>
> tmp <- SpatialPoints(locator(1))
>
> proj4string(tmp) <- proj4string(scot_BNG)
>
> over(tmp, scot_BNG)
>
> # or
>
> tmp2 <- over(scot_BNG, tmp)
>
> plot( scot_BNG[!is.na(tmp2),], add=TRUE, col='green')
>
>
> Does that do what you want?
>
>
> On Thu, Aug 16, 2012 at 9:05 AM, Frazier, Tyler James
>
> <tyler.j.frazier at tu-berlin.de> wrote:
>
>
> Hello,
>
>
>
> I am new to this group and am still working to figure out many things.  I
>
> have a kind of basic question, regarding using R and interacting with plots.
>
> I have been exploring using the spplot in the sp package as a means to
>
> interact with plots, but haven't figured out how to use the function to
>
> identify specific attributes associated with an individual polygons.  My
>
> code is really basic, I simply
>
>
>
> ea <- readOGR(".","ghana_eas_ft")
>
>
> plot(ea)
>
>
>
> is it possible to plot the map in a way where I can use the cursor in R to
>
> chose and identify attributes associated with a polygon.  Also here is the
>
> output of str(ea) which follows with a lot of information after the
>
> @polygons which I assume is part of the sp class structure.
>
>
>
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>
>
> ..@ data       :'data.frame': 12438 obs. of  3 variables:
>
>
> .. ..$ EA_NOS   : Factor w/ 1133 levels "001-005, 340-342",..: 1110 986 985
>
> 976 982 983 978 741 974 975 ...
>
>
> .. ..$ REG_CODE : Factor w/ 10 levels "01","02","03",..: 1 1 1 1 1 1 1 1 1
>
> 1 ...
>
>
> .. ..$ DIST_CODE: Factor w/ 18 levels "01","02","03",..: 9 9 9 9 9 9 9 9 9
>
> 9 ...
>
>
> ..@ polygons   :List of 12438
>
>
>
> I am wondering if there are newer packages which provide the identify
>
> function for polygons.  Currently I am referencing the Applied Spatial Data
>
> Analysis with R text.
>
>
>
> Thanks!
>
>
> Ty
>
>
>
>
>
>
>
>
>
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com
>
>
> ---------------------------------------------------
> Dr. Tyler Frazier, AICP
> Senior Research Scientist
> Department of Transportation System Planning and Telematics
> Technische Universit?t Berlin
> Sekretariat SG 12
> Salzufer 17-19
> 10587 Berlin
> fon:  +49 30 314 22418
> fax:  +49 30 314 26269
> www.vsp.tu-berlin.de
> www.matsim.org
>
>
>
>
>



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From r.turner at auckland.ac.nz  Fri Aug 17 01:03:45 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 17 Aug 2012 11:03:45 +1200
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii
In-Reply-To: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
Message-ID: <502D7C51.6090902@auckland.ac.nz>

On 17/08/12 04:23, Jos? M. Blanco Moreno wrote:
> Dear users and experts,
> I know that my question is not strictly R-related, but... Is there any good strategy (preferably already implemented in R) for estimating interaction radii of a MultiStrauss model?
>
> I have been working with  function profilepl in spatstat, but I frequently have to evaluate I too many combinations of interaction radii (1000's) and not even then I am sure that I get the right answer, because either I have likelihood maxima that are very narrow (easy to miss; it is one of the cases that I fave faced), or two local maxima with a large separation among them, leading to very different answers (from inhibition to gamma parameters higher than one, which if I have properly understood, are not "desirable") or changing the evaluation grid slightly I get different (or very different) answers.
>
> Should I just resign, take a deep breath and evaluate a grid of interaction radii of 10,000's?

I think that your problem is a pretty thorny one.

(a) It is not clear to me just how well one can estimate "irregular" 
parameters
such as interaction radii in any circumstances.

(b) Since the parameters are *irregular*, even if you could do full-blown
maximum likelihood it's not clear that the estimators would have 
particularly
good properties.

(c) Gamma parameters greater than 1 are OK for interactions between 
points of
different type.  For points of the same type they are not just 
undesirable, they
are verboten.  The model is undefined if any gamma_{ii} > 1.

(d) I have no idea how to handle the problem of getting two local maxima
which are widely separated (and of similar heights, presumably).  My gut 
feel
is that in such instances the data are simply being recalcitrant and 
refusing
to tell you a clear story about the information they contain, and there is
nothing much you can do about it.  (But then, I am by nature a confirmed
pessimist.  Maybe there *is* something you can do .... but I haven't a clue
as to what.)

Of course if one of the local maxima leads to gamma estimates which make
the model undefined then I think that you can safely rule it out.

(e) In respect of computational strategy:  I experimented a bit, a while 
back,
with using optim() (with the --- default --- Nelder-Meade simplex algorithm
method) to maximise the profile pseudolikelihood, rather than doing a brute
force grid search.  It seemed be quite a bit faster, but I'm not sure 
I'd trust
it.  The problems you describe (a maximum at a very narrow peak, multiple
local maxima) would be even more vexatious with the optim() approach
than with the grid search approach.

I can send you more detail about how I implemented the optim() approach
if you like, but as I said I don't really trust it.

(f) In respect of grid searches, the interaction radii yielding a maximum of
the pseudolikelihood have to occur at interpoint distances  So you can
(should?) search over grids whose values consist of interpoint distances.
Rather than over regularly spaced grids. This *could* cut down the number
of points over which to search.  And it *could* keep you from missing maxima
which occur at very narrow peaks.  I think.

I am cc-ing this email to Adrian in the hope that he may have other ideas
and suggestions.

         cheers,

             Rolf


From jmblanco at ub.edu  Fri Aug 17 04:11:36 2012
From: jmblanco at ub.edu (=?UTF-8?B?Ikpvc8OpIE0uIEJsYW5jbyBNb3Jlbm8i?=)
Date: Thu, 16 Aug 2012 22:11:36 -0400
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii
In-Reply-To: <502D7C51.6090902@auckland.ac.nz>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
	<502D7C51.6090902@auckland.ac.nz>
Message-ID: <502DA858.4050405@ub.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120816/a800fa59/attachment.pl>

From r.turner at auckland.ac.nz  Fri Aug 17 05:39:10 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 17 Aug 2012 15:39:10 +1200
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii
In-Reply-To: <502DA858.4050405@ub.edu>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
	<502D7C51.6090902@auckland.ac.nz> <502DA858.4050405@ub.edu>
Message-ID: <502DBCDE.2030402@auckland.ac.nz>

On 17/08/12 14:11, "Jos? M. Blanco Moreno" wrote:

     <SNIP>
>> (c) Gamma parameters greater than 1 are OK for interactions between 
>> points of
>> different type.  For points of the same type they are not just 
>> undesirable, they
>> are verboten.  The model is undefined if any gamma_{ii} > 1.
> So if I understand it properly, I can discard any model fitting any 
> gamma_{ii} > 1. However, that seems to be happening to me/my data 
> quite often. If it is not asking too much, should I take it as an 
> indication of what? Recalcitrant data, improperly chosen model, any of 
> the previous?
If you get a gamma_{ii} estimate bigger than 1, then this is basically 
saying that
gamma_{ii} is *equal* to 1, i.e. there is no interaction amongst points 
of type i.

If there is indeed no interaction then the estimate of gamma_{ii} will 
be bigger
than 1 as often as not --- or even oftener!  E.g.:

set.seed(42)
X <- rpoispp(200)
marks(X) <- factor(sample(c("a","b"),npoints(X),TRUE))
M <- matrix(0.05,2,2)
FIT <- ppm(X,inter=MultiStrauss(radii=M))

You get gamma_{11} = 1.2386.  Which doesn't really make sense.  (You get
gamma_{22} = 0.8116, which is OK.

In such cases you should "project" the fitted model onto the valid 
parameter space:

     FIT_proj <- ppm(X,inter=MultiStrauss(radii=M),project=TRUE)

The log pseudolikelihood for FIT_proj is a wee bit smaller than the 
(essentially meaningless)
log pseudolikelihood for FIT.  (This will always happen.)

I guess that in your profiling you should set project=TRUE in your calls 
to ppm().

But I'm actually now a bit puzzled by the results that I get from using 
project=TRUE
in the forgoing artificial example.  I need to do some more checking 
into this.  I'll
get back to you on this issue ASAP.
>
>
>>
>> (d) I have no idea how to handle the problem of getting two local maxima
>> which are widely separated (and of similar heights, presumably).
> Yes, I did not make the point clear enough. Since they are about the 
> same height, changing the grid a bit can indicate one or the other, 
> depending on "alignment". But I wasn't aware (or I did not remember) 
> that they have to accour at interpoint distances (likely that I 
> haven't read enough), so I will check again.

The crucial quantity here is "s_{ij}(X)" = the number of r-close pairs 
in the pattern X
whose members are of type i and type j respectively.  As you change r, 
the values of
s_{ij}(X) will tend to change --- as r increases there will be more 
r-close pairs.  But
the number of r-close pairs can increase only when r "crosses" a 
boundary equal to
an interpoint distance.  And if none of the s_{ij}(X) change, the model 
fit doesn't
change.

     <SNIP>
> Just after sending the e-mail I experimented with optim, but not too 
> much. Anyway, the "preliminary results" were simply discouraging, but 
> yes, I would like to know how you did, because my force brute approach 
> using optim did not work, plainly, it sucks.

     I didn't try using the optim() approach on MultiStrauss models; I 
*think* I tried
     it on Geyer models, optimising over the interaction radius and the 
saturation
     constant.  .... just went away and searched for what I did, and I 
see in my notes
     the comment "Doesn't work worth a tinker's dam!"

     Now thinking on it a bit more, I have *vague* recollections that I 
tried using
     method="L-BFGS-B" and had a *bit* more success, but it wasn't 
really very
     good.  I can't find any trace of my efforts in this regard so I 
think I must have
     given it up as a bad job and scrubbed any code that I wrote.

     So basically you're right.  This idea sucks, and I don't think it's 
worth pursuing
     it any further.

         cheers,

             Rolf


From tyler.j.frazier at tu-berlin.de  Fri Aug 17 11:13:52 2012
From: tyler.j.frazier at tu-berlin.de (Frazier, Tyler James)
Date: Fri, 17 Aug 2012 09:13:52 +0000
Subject: [R-sig-Geo] interacting with plots
In-Reply-To: <2804314.QDDai3i8Vr@ID-99504.news.uni-berlin.de>
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
	<2804314.QDDai3i8Vr@ID-99504.news.uni-berlin.de>
Message-ID: <9659839B4C1FD4498B496BCEFF047B6F74A782CA@EX-MB1.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120817/41eb7ce5/attachment.pl>

From r.turner at auckland.ac.nz  Sat Aug 18 02:48:13 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 18 Aug 2012 12:48:13 +1200
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii ---
	CORRECTION
In-Reply-To: <502DA858.4050405@ub.edu>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
	<502D7C51.6090902@auckland.ac.nz> <502DA858.4050405@ub.edu>
Message-ID: <502EE64D.6010801@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120818/f777b2d9/attachment.pl>

From martin.ivanov at ifg.uni-tuebingen.de  Sat Aug 18 16:06:09 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Sat, 18 Aug 2012 16:06:09 +0200
Subject: [R-sig-Geo] cannot install rgeos
Message-ID: <502FA151.30400@ifg.uni-tuebingen.de>

Dear R users,

I am having immense trouble trying to install the rgeos package on a
Linux cluster. I have installed geos locally in the directory 
/home-link/epaiv01/system.

The command
install.packages(pkgs="rgeos", 
configure.args=c("LDFLAGS=-L/home-link/epaiv01/system/usr/lib64","PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include", 
"PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64", 
"--with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config"))

fails with the complaint:
checking for C compiler default output file name... configure: error: C 
compiler cannot create executables
See `config.log' for more details.
ERROR: configuration failed for package ?rgeos?
* removing 
?/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgeos?

Oddly, if I get *into* the rgeos directory after unpacking it, and run:
LDFLAGS=-L/home-link/epaiv01/system/usr/lib64 
PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include 
PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64 ./configure 
--with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config

the configure phase passes normally. I am attaching the two log files,
which are identical until the command :

configure:1761: gcc -std=gnu99 -march=core2 -O3 -I/usr/local/include 
-I/home-link/epaiv01/system/usr/include 
-I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/syste
m/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64 
-L/home-link/epaiv01/system/usr/lib64 -lgeos 
-L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5

which in the failed configure complains that:

/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::basic_ostream<char, std::char_traits<char> >& 
std::__ostream_insert<char, std::char_traits<char> >
(std::basic_ostream<char, std::char_traits<char> >&, char const*, 
long)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::_List_node_base::_M_unhook()@GLIBCXX_3.4.14'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::basic_ostream<char, std::char_traits<char> >& 
std::basic_ostream<char, std::char_traits<char> >::_
M_insert<void const*>(void const*)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::ctype<char>::_M_widen_init() const at GLIBCXX_3.4.11'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::basic_ostream<char, std::char_traits<char> >& 
std::basic_ostream<char, std::char_traits<char> >::_
M_insert<unsigned long>(unsigned long)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::basic_ostream<char, std::char_traits<char> >& 
std::basic_ostream<char, std::char_traits<char> >::_
M_insert<double>(double)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to 
`std::_List_node_base::_M_hook(std::_List_node_base*)@GLIBCXX_3.4.14'


I am really at a loss. I have no clue whatsoever what to try any further.
Any suggestions will be appreciated.
Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
Keplerstra?e 17, 72074 T?bingen, Deutschland
Tel. +4970712975023

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120818/f9dde4dd/attachment.html>
-------------- next part --------------
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by rgeos configure 0.2-6, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  $ ./configure --with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config

## --------- ##
## Platform. ##
## --------- ##

hostname = u-003-scfe03.uni-tuebingen.de
uname -m = x86_64
uname -r = 2.6.18-308.11.1.el5
uname -s = Linux
uname -v = #1 SMP Tue Jul 10 12:43:34 EDT 2012

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = x86_64
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
hostinfo               = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /opt/bwgrid/math/R/2.15.1-mkl-10.3.5/bin
PATH: /opt/bwgrid/devel/cmake/2.8.6/bin
PATH: /opt/bwgrid/compiler/gnu/4.5.2/bin
PATH: /opt/system/moab/7.0.1/bin
PATH: /usr/lib64/qt-3.3/bin
PATH: /usr/kerberos/bin
PATH: /usr/local/bin
PATH: /bin
PATH: /usr/bin
PATH: /home-link/epaiv01/bin


## ----------- ##
## Core tests. ##
## ----------- ##

configure:1340: checking geos-config usability
configure:1349: result: yes
configure:1361: geos-config: /home-link/epaiv01/system/usr/bin/geos-config
configure:1363: GEOS version: 3.3.5
configure:1365: checking geos version over 3.2.1
configure:1374: result: yes
configure:1378: checking geos-config clibs
configure:1386: result: yes
configure:1449: checking for gcc
configure:1475: result: gcc -std=gnu99
configure:1719: checking for C compiler version
configure:1722: gcc -std=gnu99 --version </dev/null >&5
gcc (GCC) 4.5.2
Copyright (C) 2010 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

configure:1725: $? = 0
configure:1727: gcc -std=gnu99 -v </dev/null >&5
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/lustre/opt/bwgrid/compiler/gnu/4.5.2/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.5.2/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: ../gcc-4.5.2/configure --prefix=/opt/bwgrid/compiler/gnu/4.5.2 --with-gmp=/opt/bwgrid/compiler/gnu/4.5.2 --with-mpfr=/opt/bwgrid/compiler/gnu/4.5.2 -with-mpc=/opt/bwgrid/compiler/gnu/4.5.2
Thread model: posix
gcc version 4.5.2 (GCC) 
configure:1730: $? = 0
configure:1732: gcc -std=gnu99 -V </dev/null >&5
gcc: '-V' must come at the start of the command line
configure:1735: $? = 1
configure:1758: checking for C compiler default output file name
configure:1761: gcc -std=gnu99 -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/system/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::_List_node_base::_M_unhook()@GLIBCXX_3.4.14'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::basic_ostream<char, std::char_traits<char> >& std::basic_ostream<char, std::char_traits<char> >::_M_insert<void const*>(void const*)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::ctype<char>::_M_widen_init() const at GLIBCXX_3.4.11'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::basic_ostream<char, std::char_traits<char> >& std::basic_ostream<char, std::char_traits<char> >::_M_insert<unsigned long>(unsigned long)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::basic_ostream<char, std::char_traits<char> >& std::basic_ostream<char, std::char_traits<char> >::_M_insert<double>(double)@GLIBCXX_3.4.9'
/home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to `std::_List_node_base::_M_hook(std::_List_node_base*)@GLIBCXX_3.4.14'
collect2: ld returned 1 exit status
configure:1764: $? = 1
configure: failed program was:
| /* confdefs.h.  */
| 
| #define PACKAGE_NAME "rgeos"
| #define PACKAGE_TARNAME "rgeos"
| #define PACKAGE_VERSION "0.2-6"
| #define PACKAGE_STRING "rgeos 0.2-6"
| #define PACKAGE_BUGREPORT "Roger.Bivand at nhh.no"
| /* end confdefs.h.  */
| 
| int
| main ()
| {
| 
|   ;
|   return 0;
| }
configure:1803: error: C compiler cannot create executables
See `config.log' for more details.

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_env_CC_set=
ac_cv_env_CC_value=
ac_cv_env_CFLAGS_set=
ac_cv_env_CFLAGS_value=
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_LDFLAGS_set=set
ac_cv_env_LDFLAGS_value=-L/home-link/epaiv01/system/usr/lib64
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=
ac_cv_env_host_alias_value=
ac_cv_env_target_alias_set=
ac_cv_env_target_alias_value=
ac_cv_prog_ac_ct_CC='gcc -std=gnu99'

## ----------------- ##
## Output variables. ##
## ----------------- ##

CC='gcc -std=gnu99'
CFLAGS='-march=core2 -O3'
CPP='gcc -std=gnu99 -E'
CPPFLAGS='-I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include'
DEFS=''
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP=''
EXEEXT=''
GEOS_CONFIG='/home-link/epaiv01/system/usr/bin/geos-config'
LDFLAGS='-L/home-link/epaiv01/system/usr/lib64'
LIBOBJS=''
LIBS=' -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c'
LTLIBOBJS=''
OBJEXT=''
PACKAGE_BUGREPORT='Roger.Bivand at nhh.no'
PACKAGE_NAME='rgeos'
PACKAGE_STRING='rgeos 0.2-6'
PACKAGE_TARNAME='rgeos'
PACKAGE_VERSION='0.2-6'
PATH_SEPARATOR=':'
PKG_CPPFLAGS='-I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include'
PKG_LIBS='-L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c'
SHELL='/bin/sh'
ac_ct_CC='gcc -std=gnu99'
bindir='${exec_prefix}/bin'
build_alias=''
datadir='${prefix}/share'
exec_prefix='NONE'
host_alias=''
includedir='${prefix}/include'
infodir='${prefix}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localstatedir='${prefix}/var'
mandir='${prefix}/man'
oldincludedir='/usr/include'
prefix='NONE'
program_transform_name='s,x,x,'
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target_alias=''

## ----------- ##
## confdefs.h. ##
## ----------- ##

#define PACKAGE_BUGREPORT "Roger.Bivand at nhh.no"
#define PACKAGE_NAME "rgeos"
#define PACKAGE_STRING "rgeos 0.2-6"
#define PACKAGE_TARNAME "rgeos"
#define PACKAGE_VERSION "0.2-6"

configure: exit 77
-------------- next part --------------
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by rgeos configure 0.2-6, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  $ ./configure --with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config

## --------- ##
## Platform. ##
## --------- ##

hostname = u-003-scfe03.uni-tuebingen.de
uname -m = x86_64
uname -r = 2.6.18-308.11.1.el5
uname -s = Linux
uname -v = #1 SMP Tue Jul 10 12:43:34 EDT 2012

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = x86_64
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
hostinfo               = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /opt/bwgrid/math/R/2.15.1-mkl-10.3.5/bin
PATH: /opt/bwgrid/devel/cmake/2.8.6/bin
PATH: /opt/bwgrid/compiler/gnu/4.5.2/bin
PATH: /opt/system/moab/7.0.1/bin
PATH: /usr/lib64/qt-3.3/bin
PATH: /usr/kerberos/bin
PATH: /usr/local/bin
PATH: /bin
PATH: /usr/bin
PATH: /home-link/epaiv01/bin


## ----------- ##
## Core tests. ##
## ----------- ##

configure:1340: checking geos-config usability
configure:1349: result: yes
configure:1361: geos-config: /home-link/epaiv01/system/usr/bin/geos-config
configure:1363: GEOS version: 3.3.5
configure:1365: checking geos version over 3.2.1
configure:1374: result: yes
configure:1378: checking geos-config clibs
configure:1386: result: yes
configure:1449: checking for gcc
configure:1475: result: gcc -std=gnu99
configure:1719: checking for C compiler version
configure:1722: gcc -std=gnu99 --version </dev/null >&5
gcc (GCC) 4.5.2
Copyright (C) 2010 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

configure:1725: $? = 0
configure:1727: gcc -std=gnu99 -v </dev/null >&5
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/lustre/opt/bwgrid/compiler/gnu/4.5.2/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.5.2/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: ../gcc-4.5.2/configure --prefix=/opt/bwgrid/compiler/gnu/4.5.2 --with-gmp=/opt/bwgrid/compiler/gnu/4.5.2 --with-mpfr=/opt/bwgrid/compiler/gnu/4.5.2 -with-mpc=/opt/bwgrid/compiler/gnu/4.5.2
Thread model: posix
gcc version 4.5.2 (GCC) 
configure:1730: $? = 0
configure:1732: gcc -std=gnu99 -V </dev/null >&5
gcc: '-V' must come at the start of the command line
configure:1735: $? = 1
configure:1758: checking for C compiler default output file name
configure:1761: gcc -std=gnu99 -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/system/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
configure:1764: $? = 0
configure:1810: result: a.out
configure:1815: checking whether the C compiler works
configure:1821: ./a.out
configure:1824: $? = 0
configure:1841: result: yes
configure:1848: checking whether we are cross compiling
configure:1850: result: no
configure:1853: checking for suffix of executables
configure:1855: gcc -std=gnu99 -o conftest -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/system/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
configure:1858: $? = 0
configure:1883: result: 
configure:1889: checking for suffix of object files
configure:1910: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:1913: $? = 0
configure:1935: result: o
configure:1939: checking whether we are using the GNU C compiler
configure:1963: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:1969: $? = 0
configure:1973: test -z 
			 || test ! -s conftest.err
configure:1976: $? = 0
configure:1979: test -s conftest.o
configure:1982: $? = 0
configure:1995: result: yes
configure:2001: checking whether gcc -std=gnu99 accepts -g
configure:2022: gcc -std=gnu99 -c -g -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2028: $? = 0
configure:2032: test -z 
			 || test ! -s conftest.err
configure:2035: $? = 0
configure:2038: test -s conftest.o
configure:2041: $? = 0
configure:2052: result: yes
configure:2069: checking for gcc -std=gnu99 option to accept ANSI C
configure:2139: gcc -std=gnu99  -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2145: $? = 0
configure:2149: test -z 
			 || test ! -s conftest.err
configure:2152: $? = 0
configure:2155: test -s conftest.o
configure:2158: $? = 0
configure:2176: result: none needed
configure:2194: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
conftest.c:2:9: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'me'
configure:2200: $? = 1
configure: failed program was:
| #ifndef __cplusplus
|   choke me
| #endif
configure:2339: checking how to run the C preprocessor
configure:2457: result: gcc -std=gnu99 -E
configure:2481: gcc -std=gnu99 -E -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c
configure:2487: $? = 0
configure:2519: gcc -std=gnu99 -E -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c
conftest.c:9:28: fatal error: ac_nonexistent.h: No such file or directory
compilation terminated.
configure:2525: $? = 1
configure: failed program was:
| /* confdefs.h.  */
| 
| #define PACKAGE_NAME "rgeos"
| #define PACKAGE_TARNAME "rgeos"
| #define PACKAGE_VERSION "0.2-6"
| #define PACKAGE_STRING "rgeos 0.2-6"
| #define PACKAGE_BUGREPORT "Roger.Bivand at nhh.no"
| /* end confdefs.h.  */
| #include <ac_nonexistent.h>
configure:2569: checking for egrep
configure:2579: result: grep -E
configure:2584: checking for ANSI C header files
configure:2609: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2615: $? = 0
configure:2619: test -z 
			 || test ! -s conftest.err
configure:2622: $? = 0
configure:2625: test -s conftest.o
configure:2628: $? = 0
configure:2717: gcc -std=gnu99 -o conftest -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/system/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
conftest.c: In function 'main':
conftest.c:26:7: warning: implicit declaration of function 'exit'
conftest.c:26:7: warning: incompatible implicit declaration of built-in function 'exit'
conftest.c:27:3: warning: incompatible implicit declaration of built-in function 'exit'
configure:2720: $? = 0
configure:2722: ./conftest
configure:2725: $? = 0
configure:2740: result: yes
configure:2764: checking for sys/types.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for sys/stat.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for stdlib.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for string.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for memory.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for strings.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for inttypes.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for stdint.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2764: checking for unistd.h
configure:2780: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2786: $? = 0
configure:2790: test -z 
			 || test ! -s conftest.err
configure:2793: $? = 0
configure:2796: test -s conftest.o
configure:2799: $? = 0
configure:2810: result: yes
configure:2836: checking geos_c.h usability
configure:2848: gcc -std=gnu99 -c -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c >&5
configure:2854: $? = 0
configure:2858: test -z 
			 || test ! -s conftest.err
configure:2861: $? = 0
configure:2864: test -s conftest.o
configure:2867: $? = 0
configure:2877: result: yes
configure:2881: checking geos_c.h presence
configure:2891: gcc -std=gnu99 -E -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include conftest.c
configure:2897: $? = 0
configure:2917: result: yes
configure:2952: checking for geos_c.h
configure:2959: result: yes
configure:2975: checking for initGEOS_r in -lgeos_c
configure:3005: gcc -std=gnu99 -o conftest -march=core2 -O3 -I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/system/usr/lib64 conftest.c -lgeos_c   -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
configure:3011: $? = 0
configure:3015: test -z 
			 || test ! -s conftest.err
configure:3018: $? = 0
configure:3021: test -s conftest
configure:3024: $? = 0
configure:3037: result: yes
configure:3056: PKG_CPPFLAGS: -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include
configure:3059: PKG_LIBS: -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c
configure:3195: creating ./config.status

## ---------------------- ##
## Running config.status. ##
## ---------------------- ##

This file was extended by rgeos config.status 0.2-6, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  CONFIG_FILES    = 
  CONFIG_HEADERS  = 
  CONFIG_LINKS    = 
  CONFIG_COMMANDS = 
  $ ./config.status 

on u-003-scfe03.uni-tuebingen.de

config.status:636: creating src/Makevars

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_c_compiler_gnu=yes
ac_cv_env_CC_set=
ac_cv_env_CC_value=
ac_cv_env_CFLAGS_set=
ac_cv_env_CFLAGS_value=
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_LDFLAGS_set=set
ac_cv_env_LDFLAGS_value=-L/home-link/epaiv01/system/usr/lib64
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=
ac_cv_env_host_alias_value=
ac_cv_env_target_alias_set=
ac_cv_env_target_alias_value=
ac_cv_exeext=
ac_cv_header_geos_c_h=yes
ac_cv_header_inttypes_h=yes
ac_cv_header_memory_h=yes
ac_cv_header_stdc=yes
ac_cv_header_stdint_h=yes
ac_cv_header_stdlib_h=yes
ac_cv_header_string_h=yes
ac_cv_header_strings_h=yes
ac_cv_header_sys_stat_h=yes
ac_cv_header_sys_types_h=yes
ac_cv_header_unistd_h=yes
ac_cv_lib_geos_c_initGEOS_r=yes
ac_cv_objext=o
ac_cv_prog_CPP='gcc -std=gnu99 -E'
ac_cv_prog_ac_ct_CC='gcc -std=gnu99'
ac_cv_prog_cc_g=yes
ac_cv_prog_cc_stdc=
ac_cv_prog_egrep='grep -E'

## ----------------- ##
## Output variables. ##
## ----------------- ##

CC='gcc -std=gnu99'
CFLAGS='-march=core2 -O3'
CPP='gcc -std=gnu99 -E'
CPPFLAGS='-I/usr/local/include -I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include'
DEFS='-DPACKAGE_NAME=\"rgeos\" -DPACKAGE_TARNAME=\"rgeos\" -DPACKAGE_VERSION=\"0.2-6\" -DPACKAGE_STRING=\"rgeos\ 0.2-6\" -DPACKAGE_BUGREPORT=\"Roger.Bivand at nhh.no\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_GEOS_C_H=1 -DHAVE_LIBGEOS_C=1 '
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP='grep -E'
EXEEXT=''
GEOS_CONFIG='/home-link/epaiv01/system/usr/bin/geos-config'
LDFLAGS='-L/home-link/epaiv01/system/usr/lib64'
LIBOBJS=''
LIBS='-lgeos_c  -L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c'
LTLIBOBJS=''
OBJEXT='o'
PACKAGE_BUGREPORT='Roger.Bivand at nhh.no'
PACKAGE_NAME='rgeos'
PACKAGE_STRING='rgeos 0.2-6'
PACKAGE_TARNAME='rgeos'
PACKAGE_VERSION='0.2-6'
PATH_SEPARATOR=':'
PKG_CPPFLAGS='-I/home-link/epaiv01/system/usr/include -I/home-link/epaiv01/system/usr/include'
PKG_LIBS='-L/home-link/epaiv01/system/usr/lib64 -L/home-link/epaiv01/system/usr/lib64 -lgeos -L/home-link/epaiv01/system/usr/lib64 -lgeos_c'
SHELL='/bin/sh'
ac_ct_CC='gcc -std=gnu99'
bindir='${exec_prefix}/bin'
build_alias=''
datadir='${prefix}/share'
exec_prefix='${prefix}'
host_alias=''
includedir='${prefix}/include'
infodir='${prefix}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localstatedir='${prefix}/var'
mandir='${prefix}/man'
oldincludedir='/usr/include'
prefix='/usr/local'
program_transform_name='s,x,x,'
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target_alias=''

## ----------- ##
## confdefs.h. ##
## ----------- ##

#define HAVE_GEOS_C_H 1
#define HAVE_INTTYPES_H 1
#define HAVE_LIBGEOS_C 1
#define HAVE_MEMORY_H 1
#define HAVE_STDINT_H 1
#define HAVE_STDLIB_H 1
#define HAVE_STRINGS_H 1
#define HAVE_STRING_H 1
#define HAVE_SYS_STAT_H 1
#define HAVE_SYS_TYPES_H 1
#define HAVE_UNISTD_H 1
#define PACKAGE_BUGREPORT "Roger.Bivand at nhh.no"
#define PACKAGE_NAME "rgeos"
#define PACKAGE_STRING "rgeos 0.2-6"
#define PACKAGE_TARNAME "rgeos"
#define PACKAGE_VERSION "0.2-6"
#define STDC_HEADERS 1

configure: exit 0

From martin.ivanov at ifg.uni-tuebingen.de  Sat Aug 18 17:51:12 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Sat, 18 Aug 2012 17:51:12 +0200
Subject: [R-sig-Geo] cannot install rgeos
In-Reply-To: <502FB086.8060408@uni-muenster.de>
References: <502FA151.30400@ifg.uni-tuebingen.de>
	<502FB086.8060408@uni-muenster.de>
Message-ID: <502FB9F0.70702@ifg.uni-tuebingen.de>

Dear Prof. Pebesma,

sp and proj4 install just fine. I am having trouble with rgeos and rgdal.
I try to install rgdal with:

  install.packages(pkgs="rgdal", 
configure.args=c("LDFLAGS=-L/home-link/epaiv01/system/usr/lib64","PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include", 
"PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64", 
"--with-gdal-config=/home-link/epaiv01/system/usr/bin/gdal-config", 
"--with-proj-lib=/home-link/epaiv01/system/usr/lib64", 
"--with-proj-include=/home-link/epaiv01/system/usr/include"), type="source")

it seems to compile ok, but at the testing whether the package can be 
loaded it complains:

** testing if installed package can be loaded
Error in dyn.load(file, DLLpath = DLLpath, ...) :
   unable to load shared object 
'/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgdal/libs/rgdal.so':
   /usr/java/default/jre/../lib/amd64/libstdc++.so.6: version 
`GLIBCXX_3.4.14' not found (required by 
/home-link/epaiv01/system/usr/lib64/libgdal.so.1)
Error: loading failed
Execution halted
ERROR: loading failed
* removing 
?/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgdal?

Is it possible that the compilation within R uses different compiler 
than the one I loaded in the
bash environment with:
module load compiler/gnu/4.5 ?
It seems to me that it is can be the case. How can I tell R to use 
exactly the gnu/4.5 compiler
and not something else?

Best regards,

Martin


On 08/18/2012 05:11 PM, Edzer Pebesma wrote:
> Hi,
>
> To me, this looks like an error in your gcc setup. Have you searched for
> the error message you get? Do other packages, such as sp, install fine?
>
> On 08/18/2012 04:06 PM, Martin Ivanov wrote:
>> Dear R users,
>>
>> I am having immense trouble trying to install the rgeos package on a
>> Linux cluster. I have installed geos locally in the directory
>> /home-link/epaiv01/system.
>>
>> The command
>> install.packages(pkgs="rgeos",
>> configure.args=c("LDFLAGS=-L/home-link/epaiv01/system/usr/lib64","PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include",
>> "PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64",
>> "--with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config"))
>>
>> fails with the complaint:
>> checking for C compiler default output file name... configure: error: C
>> compiler cannot create executables
>> See `config.log' for more details.
>> ERROR: configuration failed for package ?rgeos?
>> * removing
>> ?/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgeos?
>>
>> Oddly, if I get *into* the rgeos directory after unpacking it, and run:
>> LDFLAGS=-L/home-link/epaiv01/system/usr/lib64
>> PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include
>> PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64 ./configure
>> --with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config
>>
>> the configure phase passes normally. I am attaching the two log files,
>> which are identical until the command :
>>
>> configure:1761: gcc -std=gnu99 -march=core2 -O3 -I/usr/local/include
>> -I/home-link/epaiv01/system/usr/include
>> -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/syste
>> m/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64
>> -L/home-link/epaiv01/system/usr/lib64 -lgeos
>> -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
>>
>> which in the failed configure complains that:
>>
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::basic_ostream<char, std::char_traits<char> >&
>> std::__ostream_insert<char, std::char_traits<char> >
>> (std::basic_ostream<char, std::char_traits<char> >&, char const*,
>> long)@GLIBCXX_3.4.9'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::_List_node_base::_M_unhook()@GLIBCXX_3.4.14'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::basic_ostream<char, std::char_traits<char> >&
>> std::basic_ostream<char, std::char_traits<char> >::_
>> M_insert<void const*>(void const*)@GLIBCXX_3.4.9'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::ctype<char>::_M_widen_init() const at GLIBCXX_3.4.11'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::basic_ostream<char, std::char_traits<char> >&
>> std::basic_ostream<char, std::char_traits<char> >::_
>> M_insert<unsigned long>(unsigned long)@GLIBCXX_3.4.9'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::basic_ostream<char, std::char_traits<char> >&
>> std::basic_ostream<char, std::char_traits<char> >::_
>> M_insert<double>(double)@GLIBCXX_3.4.9'
>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>> `std::_List_node_base::_M_hook(std::_List_node_base*)@GLIBCXX_3.4.14'
>>
>>
>> I am really at a loss. I have no clue whatsoever what to try any further.
>> Any suggestions will be appreciated.
>> Best regards,
>>
>> -- 
>> Dr. Martin Ivanov
>> Eberhard-Karls-Universit?t T?bingen
>> Mathematisch-Naturwissenschaftliche Fakult?t
>> Fachbereich Geowissenschaften
>> Water & Earth System Science (WESS)
>> Keplerstra?e 17, 72074 T?bingen, Deutschland
>> Tel. +4970712975023
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
Keplerstra?e 17, 72074 T?bingen, Deutschland
Tel. +4970712975023


From Roger.Bivand at nhh.no  Sat Aug 18 19:11:26 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 18 Aug 2012 19:11:26 +0200 (CEST)
Subject: [R-sig-Geo] cannot install rgeos
In-Reply-To: <502FB9F0.70702@ifg.uni-tuebingen.de>
References: <502FA151.30400@ifg.uni-tuebingen.de>
	<502FB086.8060408@uni-muenster.de>
	<502FB9F0.70702@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208181851380.2730@reclus.nhh.no>

On Sat, 18 Aug 2012, Martin Ivanov wrote:

> Dear Prof. Pebesma,
>
> sp and proj4 install just fine. I am having trouble with rgeos and rgdal.

Both require C++ libraries, and require that they are the same versions as 
the GEOS and GDAL binaries, as well as the rgeos and rgdal binaries. It 
looks as though C++ isn't deployed across the cluster consistently, and 
isn't the same as on your local machine. Start by getting rgdal and rgeos 
installed and running correctly locally.

An alternative is to try to build static binary packages, by removing the 
gdal and geos shared objects, so that the rgeos and rgdal configure steps 
revert to static - read the rgdal/configure.ac file for some indications. 
You'll need GDAL only static, with PROJ.4 static-linked; the same for 
GEOS. This is what is done for OSX; Windows package binaries are also 
static, but do not use configure.ac. For rgeos, you may need to add 
-lstdc++ manually. This isn't at all easy.

For GEOS, despite our using the C API consistently, the structure of GEOS 
itself requires linkage to the C++ GEOS ABI, and to libstdc++, so without 
static linkage, care is required. With rgdal, we do use the C++ API/ABI, 
but argably should go for a GSoC next year to move it to the C API, which 
is less problematic (hopefully).

I'm also curious that cluster use is important, given that neither of the 
packages is multithreaded nor parallelizable. Are you going to run 
simulations? Won't it be easier to re-jig your workflow to pre-process and 
post-process data on a single machine?

Roger

> I try to install rgdal with:
>
>  install.packages(pkgs="rgdal", 
> configure.args=c("LDFLAGS=-L/home-link/epaiv01/system/usr/lib64","PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include", 
> "PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64", 
> "--with-gdal-config=/home-link/epaiv01/system/usr/bin/gdal-config", 
> "--with-proj-lib=/home-link/epaiv01/system/usr/lib64", 
> "--with-proj-include=/home-link/epaiv01/system/usr/include"), type="source")
>
> it seems to compile ok, but at the testing whether the package can be 
> loaded it complains:
>
> ** testing if installed package can be loaded
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>   unable to load shared object 
> '/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgdal/libs/rgdal.so':
>   /usr/java/default/jre/../lib/amd64/libstdc++.so.6: version 
> `GLIBCXX_3.4.14' not found (required by 
> /home-link/epaiv01/system/usr/lib64/libgdal.so.1)
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing 
> ?/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgdal?
>
> Is it possible that the compilation within R uses different compiler 
> than the one I loaded in the
> bash environment with:
> module load compiler/gnu/4.5 ?
> It seems to me that it is can be the case. How can I tell R to use 
> exactly the gnu/4.5 compiler
> and not something else?
>
> Best regards,
>
> Martin
>
>
> On 08/18/2012 05:11 PM, Edzer Pebesma wrote:
>> Hi,
>>
>> To me, this looks like an error in your gcc setup. Have you searched for
>> the error message you get? Do other packages, such as sp, install fine?
>>
>> On 08/18/2012 04:06 PM, Martin Ivanov wrote:
>>> Dear R users,
>>>
>>> I am having immense trouble trying to install the rgeos package on a
>>> Linux cluster. I have installed geos locally in the directory
>>> /home-link/epaiv01/system.
>>>
>>> The command
>>> install.packages(pkgs="rgeos",
>>> 
> configure.args=c("LDFLAGS=-L/home-link/epaiv01/system/usr/lib64","PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include",
>>> "PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64",
>>> "--with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config"))
>>>
>>> fails with the complaint:
>>> checking for C compiler default output file name... configure: error: C
>>> compiler cannot create executables
>>> See `config.log' for more details.
>>> ERROR: configuration failed for package ?rgeos?
>>> * removing
>>> 
> ?/lustre/home/zdv/ep/epaiv01/R/x86_64-unknown-linux-gnu-library/2.15/rgeos?
>>>
>>> Oddly, if I get *into* the rgeos directory after unpacking it, and run:
>>> LDFLAGS=-L/home-link/epaiv01/system/usr/lib64
>>> PKG_CPPFLAGS=-I/home-link/epaiv01/system/usr/include
>>> PKG_LIBS=-L/home-link/epaiv01/system/usr/lib64 ./configure
>>> --with-geos-config=/home-link/epaiv01/system/usr/bin/geos-config
>>>
>>> the configure phase passes normally. I am attaching the two log files,
>>> which are identical until the command :
>>>
>>> configure:1761: gcc -std=gnu99 -march=core2 -O3 -I/usr/local/include
>>> -I/home-link/epaiv01/system/usr/include
>>> -I/home-link/epaiv01/system/usr/include -L/home-link/epaiv01/syste
>>> m/usr/lib64 conftest.c  -L/home-link/epaiv01/system/usr/lib64
>>> -L/home-link/epaiv01/system/usr/lib64 -lgeos
>>> -L/home-link/epaiv01/system/usr/lib64 -lgeos_c >&5
>>>
>>> which in the failed configure complains that:
>>>
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::basic_ostream<char, std::char_traits<char> >&
>>> std::__ostream_insert<char, std::char_traits<char> >
>>> (std::basic_ostream<char, std::char_traits<char> >&, char const*,
>>> long)@GLIBCXX_3.4.9'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::_List_node_base::_M_unhook()@GLIBCXX_3.4.14'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::basic_ostream<char, std::char_traits<char> >&
>>> std::basic_ostream<char, std::char_traits<char> >::_
>>> M_insert<void const*>(void const*)@GLIBCXX_3.4.9'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::ctype<char>::_M_widen_init() const at GLIBCXX_3.4.11'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::basic_ostream<char, std::char_traits<char> >&
>>> std::basic_ostream<char, std::char_traits<char> >::_
>>> M_insert<unsigned long>(unsigned long)@GLIBCXX_3.4.9'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::basic_ostream<char, std::char_traits<char> >&
>>> std::basic_ostream<char, std::char_traits<char> >::_
>>> M_insert<double>(double)@GLIBCXX_3.4.9'
>>> /home-link/epaiv01/system/usr/lib64/libgeos.so: undefined reference to
>>> `std::_List_node_base::_M_hook(std::_List_node_base*)@GLIBCXX_3.4.14'
>>>
>>>
>>> I am really at a loss. I have no clue whatsoever what to try any further.
>>> Any suggestions will be appreciated.
>>> Best regards,
>>>
>>> -- 
>>> Dr. Martin Ivanov
>>> Eberhard-Karls-Universit?t T?bingen
>>> Mathematisch-Naturwissenschaftliche Fakult?t
>>> Fachbereich Geowissenschaften
>>> Water & Earth System Science (WESS)
>>> Keplerstra?e 17, 72074 T?bingen, Deutschland
>>> Tel. +4970712975023
>>>
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From karl at huftis.org  Sat Aug 18 21:43:23 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Sat, 18 Aug 2012 21:43:23 +0200
Subject: [R-sig-Geo] interacting with plots
References: <9659839B4C1FD4498B496BCEFF047B6F74A77394@EX-MB1.tubit.win.tu-berlin.de>
	<CAFEqCdxw==UfN6nx-yfmvXwASWePmjb573zxwsiOwRDKdSO3gA@mail.gmail.com>
	<9659839B4C1FD4498B496BCEFF047B6F74A77729@EX-MB1.tubit.win.tu-berlin.de>
	<2804314.QDDai3i8Vr@ID-99504.news.uni-berlin.de>
	<9659839B4C1FD4498B496BCEFF047B6F74A782CA@EX-MB1.tubit.win.tu-berlin.de>
Message-ID: <1487157.sTScjSxk4D@ID-99504.news.uni-berlin.de>

Frazier, Tyler James wrote:

> I installed QGIS and the optional GRASS 6.4.2 with the GDAL 1.9 framework
> and GSL, and agree this is much simpler than attempting to use R as a
> stand alone GIS.  Very easy to load my data, pan, zoom and identify
> attributes of polygons.
> 
> Regarding integrating QGIS and R, is there a package or plugin I need to
> add.  I noticed some comments on stackexchange regarding manageR, is this
> the best way to go?  FYI, I am running R 2.14.0 on MacOS Lion.

I haven?t used it myself, but yes, I believe mangeR is the best solution.

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From lyndon.estes at gmail.com  Sun Aug 19 00:38:49 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Sat, 18 Aug 2012 18:38:49 -0400
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
Message-ID: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>

Dear List,

I am currently trying to figure out the the proportions of two
different landcover classes (classified from Landsat imagery) that
fall within the extent of coarser MODIS pixels (I am trying to isolate
MODIS pixels associated with fairly pure cover types).  I want to do
this without changing the geometries of either raster, so the only
solution I can think of is to convert the MODIS pixels to polygons and
then use the extract function to do the work.  The code should look
something like this (adapting a solution I saw here
https://stat.ethz.ch/pipermail/r-sig-geo/2011-February/010999.html):

library(raster)
library(rgdal)

# Dummy of MODIS raster (but the actual extent I am working with),
each cell given a unique identifier
sincrs <- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs"
r <- raster(xmn = 3230680, xmx = 3671058, ymn = -1712867, ymx =
-1343839, crs = sincrs)
res(r) <- 231.6564
r[] <- 1:ncell(r)

# Dummy 30m 7 class landcover raster (nonsense numbers, but is of the
extent I am working with)
lc <- raster(xmn = 3230756, xmx = 3671006, ymn = -1712837, ymx =
-1343777, crs = sincrs)
res(lc) <- 30
lc[] <- sample(0:7, ncell(lc), replace = TRUE)  # This is very slow

bs <- blockSize(r, minblocks = 200)  # Calculate size of rows to work on
rsp <- as(r,  "SpatialPixelsDataFrame")  # Convert MODIS dataset to
spatial pixels--allows ready conversion to polygons

# Output datasets
rcl3 <- r * 0
rcl4 <- r * 0
rtot <- r * 0

rcl3 <- writeStart(rcl3, "lc_class3.tif", overwrite = TRUE)
rcl4 <- writeStart(rcl4, "lc_class4.tif", overwrite = TRUE)
rtot <- writeStart(rtot, "lc_class4.tif", overwrite = TRUE)

# Start processing loop
for(i in 1:bs$n) {
  ids <- getValues(r, row = bs$row[i], nrows = bs$nrows[i]) # Get
pixel IDs from raster
  pix <- rsp[ids, ]  # Pull out spatialpixels from first block
  pol <- as(pix, "SpatialPolygonsDataFrame")  # Coerce them to polygons
  xv  <- extract(lc, pol[1:10, ])  #  Extract values
  writeValues(rcl3, sapply(xv, function(x) length(which(x == 3))),
bs$row[i])  # Write out sum class 3
  writeValues(rcl4, sapply(xv, function(x) length(which(x == 4))),
bs$row[i])  # Write out sum class 4
  writeValues(rtot, sapply(xv, function(x) length(x)), bs$row[i])  #
Write sum total pixels
}

rcl3 <- writeStop(rcl3)
rcl4 <- writeStop(rcl4)
rtot <- writeStop(rtot)

Note that I haven't actually run this all the way through to see if it
works properly (I stopped the run on the first iteration because it
hadn't finished after about 30-45 minutes), and my actual scenes have
plenty of NA values in them, but this is more or less the approach.

I would very much appreciate any pointers as to how I can do this more
efficiently.

Many thanks, Lyndon


From cjpauw at gmail.com  Sun Aug 19 10:12:07 2012
From: cjpauw at gmail.com (christiaan pauw)
Date: Sun, 19 Aug 2012 10:12:07 +0200
Subject: [R-sig-Geo] fortify.SpatialPolygonsDataFrame error
In-Reply-To: <CAJESSmaVA9TtZy3EuZ740BPqBn+DDHLhJBOceBsXztWDxiQTSg@mail.gmail.com>
References: <DUB108-W4485F4BB70523EBA97A5B0ED650@phx.gbl>
	<4F4B5A7F.90700@knmi.nl>
	<CAJESSmaVA9TtZy3EuZ740BPqBn+DDHLhJBOceBsXztWDxiQTSg@mail.gmail.com>
Message-ID: <CAJESSmaAxMfnV1SXF1NOMs60L94+xwG_buDBSo+iumB6ZtSqgA@mail.gmail.com>

Hi everybody

I have the same problem. It seems there is no such function as
invert() . I googled quite a bit an could not find such a function?
Does anyone know of an invert() function in R?

regards
Christiaan

On 27 February 2012 12:27, Paul Hiemstra <paul.hiemstra at knmi.nl> wrote:
> On 02/23/2012 04:48 PM, marion le texier wrote:
>> Hi everyone,
>>
>> I would like to know if someone of you has already got troubles when trying to use ggplot2 with a shape file?
>> Here is what I've done:
>>
>> NUTS1<-readShapeSpatial("nuts1_2003", proj4string=CRS(projargs=("+init=epsg:3035")),IDvar="NUTS1")
>> plot(NUTS1)
>>
>> NUTS1 at data$id <- rownames(NUTS1 at data)
>>
>> # as codes are characters and not numeric values, I've changed them into:
>>
>> test<-as.numeric(seq(1:94))
>> NUTS1 at data$id<-test
>>
>> NUTS1.points <- fortify.SpatialPolygonsDataFrame(NUTS1, region="id")
>>
>> # The function doesn't want to be applied and I get this error message:
>>
>> Erreur dans unionSpatialPolygons(cp, invert(polys)) : input lengths differ
>> De plus : Message d'avis :
>> In split(as.numeric(row.names(attr)), addNA(attr[, region], TRUE)) :
>>   NAs introduits lors de la conversion automatique
>>
>> (sorry for the French comments...)
>>
>>
>> # What I would like to do at the end is :
>>
>> NUTS1.map <- ggplot()+geom_polygon(data=NUTS1.points, aes(long, lat, group=group), fill=NA, colour="black") + coord_map()
>>
>>
>> Do you have any idea of what I'm doing wrong?
>>
>> Thanks you very much for your help!!!
>> Marion
>>
>>
>>       [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

Christiaan Pauw
Nova Institute
www.nova.org.za


From martin.ivanov at ifg.uni-tuebingen.de  Sun Aug 19 12:03:45 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Sun, 19 Aug 2012 12:03:45 +0200
Subject: [R-sig-Geo] cannot install rgeos
In-Reply-To: <alpine.LRH.2.02.1208181851380.2730@reclus.nhh.no>
References: <502FA151.30400@ifg.uni-tuebingen.de>
	<502FB086.8060408@uni-muenster.de>
	<502FB9F0.70702@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208181851380.2730@reclus.nhh.no>
Message-ID: <5030BA01.4060006@ifg.uni-tuebingen.de>

Dear R users, Dear Prof. Bivand,

I am happy to inform You that I managed to solve the problem with the 
rgeos and rgdal installation on the Linux cluster in one shot. Actually 
the problem came from the lack of the binutils package. I had compiled 
the system geos and gdal packages without usage of binutils, hence those 
linker errors. After I loaded the
binutils by "module load compiler/binutils/2.19.1", compiled geos and 
gdal, the installation of
rgeos and rgdal in R went flawless.

Dear Prof. Bivand, I need the Linux cluster because I am going to do 
interpolation of monthly data
for 50 years. The interpolation of each single month on my desktop 
computer takes about 10 minutes. So one can expect that the whole 
procedure is going to take a bit more than 4 days on it, which is not 
very convenient.
That is why I am going to make use of the Linux cluster. There I have 
more RAM and CPU power available for my calculations and I hope to be 
able to submit each decade as a separate job, so that the 5 decades run 
in parallel.

Thank You very much for Your attention and responsiveness.

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
Keplerstra?e 17, 72074 T?bingen, Deutschland
Tel. +4970712975023


From simon.ohanlon at imperial.ac.uk  Sun Aug 19 14:25:58 2012
From: simon.ohanlon at imperial.ac.uk (O'Hanlon, Simon J)
Date: Sun, 19 Aug 2012 12:25:58 +0000
Subject: [R-sig-Geo] fortify.SpatialPolygonsDataFrame error
In-Reply-To: <CAJESSmaAxMfnV1SXF1NOMs60L94+xwG_buDBSo+iumB6ZtSqgA@mail.gmail.com>
References: <DUB108-W4485F4BB70523EBA97A5B0ED650@phx.gbl>
	<4F4B5A7F.90700@knmi.nl>
	<CAJESSmaVA9TtZy3EuZ740BPqBn+DDHLhJBOceBsXztWDxiQTSg@mail.gmail.com>,
	<CAJESSmaAxMfnV1SXF1NOMs60L94+xwG_buDBSo+iumB6ZtSqgA@mail.gmail.com>
Message-ID: <7AE0828DCFFC0144817331B53EDC11A025D47B42@icexch-m5.ic.ac.uk>

Hey Christian,
As your example is not reproducible (i.e. no access to NUTS1 shapefile) its a bit hard to say exactly, but perhaps this might work for you:

# Try row.names() rather than rownames()
NUTS1 at data$id <- row.names(NUTS1 at data)   
NUTS1.points <- fortify(NUTS1, region="id")
NUT1.df <- dataframe(NUTS1)

# This join operation allows you to join attribute data from the shapefile (which I assume you have as NUTS1 is a SpatialPolygonsDataFrame) to each row of the data frame used for plotting
NUTS1.map <- join(NUTS1.points, NUTS1.df , by = "id" ) 

# To ggplot2 a geom_polygon is simply a filled geom_path - if you want transparent polygons you may as well use geom_path instead
p <- ggplot() + geom_path( data=NUTS1.map , aes( long , lat , group = group ) , colour="black" ) + coord_map()
print(p)

HTH,

Simon
________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of christiaan pauw [cjpauw at gmail.com]
Sent: 19 August 2012 09:12
To: r-sig-geo
Subject: Re: [R-sig-Geo] fortify.SpatialPolygonsDataFrame error

Hi everybody

I have the same problem. It seems there is no such function as
invert() . I googled quite a bit an could not find such a function?
Does anyone know of an invert() function in R?

regards
Christiaan

On 27 February 2012 12:27, Paul Hiemstra <paul.hiemstra at knmi.nl> wrote:
> On 02/23/2012 04:48 PM, marion le texier wrote:
>> Hi everyone,
>>
>> I would like to know if someone of you has already got troubles when trying to use ggplot2 with a shape file?
>> Here is what I've done:
>>
>> NUTS1<-readShapeSpatial("nuts1_2003", proj4string=CRS(projargs=("+init=epsg:3035")),IDvar="NUTS1")
>> plot(NUTS1)
>>
>> NUTS1 at data$id <- rownames(NUTS1 at data)
>>
>> # as codes are characters and not numeric values, I've changed them into:
>>
>> test<-as.numeric(seq(1:94))
>> NUTS1 at data$id<-test
>>
>> NUTS1.points <- fortify.SpatialPolygonsDataFrame(NUTS1, region="id")
>>
>> # The function doesn't want to be applied and I get this error message:
>>
>> Erreur dans unionSpatialPolygons(cp, invert(polys)) : input lengths differ
>> De plus : Message d'avis :
>> In split(as.numeric(row.names(attr)), addNA(attr[, region], TRUE)) :
>>   NAs introduits lors de la conversion automatique
>>
>> (sorry for the French comments...)
>>
>>
>> # What I would like to do at the end is :
>>
>> NUTS1.map <- ggplot()+geom_polygon(data=NUTS1.points, aes(long, lat, group=group), fill=NA, colour="black") + coord_map()
>>
>>
>> Do you have any idea of what I'm doing wrong?
>>
>> Thanks you very much for your help!!!
>> Marion
>>
>>
>>       [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

Christiaan Pauw
Nova Institute
www.nova.org.za

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mspinola10 at gmail.com  Sun Aug 19 18:01:13 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 19 Aug 2012 10:01:13 -0600
Subject: [R-sig-Geo] fortify.SpatialPolygonsDataFrame error
In-Reply-To: <DUB108-W4485F4BB70523EBA97A5B0ED650@phx.gbl>
References: <DUB108-W4485F4BB70523EBA97A5B0ED650@phx.gbl>
Message-ID: <CABkCotSr2PyPhB-jtwB07DHjVE5XnQiM07TsR3hga3Bg-3XuDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/a7a3d3d7/attachment.pl>

From kjjw32 at yahoo.com  Mon Aug 20 05:08:29 2012
From: kjjw32 at yahoo.com (K Jjw)
Date: Sun, 19 Aug 2012 20:08:29 -0700 (PDT)
Subject: [R-sig-Geo] Interpolating
Message-ID: <1345432109.26346.YahooMailNeo@web121504.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/0eada3c9/attachment.pl>

From r.hijmans at gmail.com  Mon Aug 20 06:50:49 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 19 Aug 2012 21:50:49 -0700
Subject: [R-sig-Geo] raster: file not saved and data type changed
In-Reply-To: <CAG4NReK59YQ1TQ7cA-QRpyYuPN_yay+mk7xzMTkcbWyp4DTK9w@mail.gmail.com>
References: <CAG4NReK59YQ1TQ7cA-QRpyYuPN_yay+mk7xzMTkcbWyp4DTK9w@mail.gmail.com>
Message-ID: <CANtt_hz+bFOhhHoRyAzg+Q7Z9s75mH2N5y9VNYyhA1JO0GtkaQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/0f5e8d6e/attachment.pl>

From r.hijmans at gmail.com  Mon Aug 20 06:57:17 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 19 Aug 2012 21:57:17 -0700
Subject: [R-sig-Geo] crop/trim raster
In-Reply-To: <FC26F44B-3911-4CEC-9C21-BFEBE81D45B6@gmail.com>
References: <FC26F44B-3911-4CEC-9C21-BFEBE81D45B6@gmail.com>
Message-ID: <CANtt_hwZ4JHVy4E1ThTbEfYq-25Scx2HEjqerd3JCy7Uya2sjA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/df15d6d8/attachment.pl>

From r.hijmans at gmail.com  Mon Aug 20 07:21:14 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 19 Aug 2012 22:21:14 -0700
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <alpine.LRH.2.02.1208151029180.20318@reclus.nhh.no>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
	<alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
	<CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>
	<alpine.LRH.2.02.1208151029180.20318@reclus.nhh.no>
Message-ID: <CANtt_hzSJAC3KM+yvzyCun0kub18oG0vu-V2vi-sS=EteewOaw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/581945ef/attachment.pl>

From r.hijmans at gmail.com  Mon Aug 20 07:30:45 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 19 Aug 2012 22:30:45 -0700
Subject: [R-sig-Geo] Great Circles US IRS Migration mapping
In-Reply-To: <SNT117-W12E0A37167D4B34EE114CFC5B00@phx.gbl>
References: <SNT117-W12E0A37167D4B34EE114CFC5B00@phx.gbl>
Message-ID: <CANtt_hxFJ4ZW777Ot6T6VenJaZ2Acj8GcUYEbFaCoPzivCYYcw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120819/e7ba5a78/attachment.pl>

From tom.gottfried at o2mail.de  Mon Aug 20 10:16:23 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Mon, 20 Aug 2012 10:16:23 +0200
Subject: [R-sig-Geo] Interpolating
In-Reply-To: <1345432109.26346.YahooMailNeo@web121504.mail.ne1.yahoo.com>
References: <1345432109.26346.YahooMailNeo@web121504.mail.ne1.yahoo.com>
Message-ID: <5031F257.7060307@o2mail.de>

Am 20.08.2012 05:08, schrieb K Jjw:
> Hi
> I tried predict but I get an error. Warning message: 'newdata' had 4 rows but variable(s) found have 3 rows
> it only works if the number of rows that i am trying to predict are the same as the original number of rows (3). It does however work when I try to do the same thing for  example in ?predict (tried with 17 rows to predict when the original function is 15 rows) . Not sure what is going on. Has anyone run into the same problem before?

Not sure what is going on neither. But a reproducible example would 
surely help you and others on the list to get to know what is going on.

Regards,
Tom

> Thanks
> KJ
>
>
>
> ?predict
> ?predict.lm
>
> HTH,
> Tom
>
> Am 15.08.2012 04:05, schrieb K Jjw:
>> Hi
>>
>>
>> I have data that are from 1990, 2040, and 2090. I
> need to loop through each location (defined in a grid of 240x260) and find a
> linear regression for each place across the 3 years. I then need to interpolate
> the data to get the missing years for the given location ie I need all the data
> for 1991, 1992, 1993 etc. I have a loop and I have figured out how to make the
> model ie lm(). What I am having difficulty with is interpolating the data
> without hardcoding in the formula of the linear regression.
>>
>> so basically the bit of code that is causing me
> problems is
>>
>> linr<-lm(jan_ppt~date)
>> linr
>>
>> Call:
>> lm(formula = jan_ppt ~ date)
>>
>> Coefficients:
>> (Intercept)         date
>>      1.482e+02    1.728e-03
>>
>> x<- 1990:2090
>> y<-1.482e2 + 1.728e-3*x #this is what I have now
>> y<- intercept+ grad*x #this is what I want where
> 'intercept' and 'grad' are defined from the model 'linr'
>>
>>     how do I
> define y without hardcoding the coefficients as they will change for every
> location. I basically need to do linear regressions for each location then
> interpolate the data to get yearly data in order to put this data in another
> model that requires yearly data.
>>
>> Thanks
>>
>> KJ
>>              [[alternative
> HTML version deleted]]
>>
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From martin.ivanov at ifg.uni-tuebingen.de  Mon Aug 20 14:14:32 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Mon, 20 Aug 2012 14:14:32 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
Message-ID: <50322A28.2060106@ifg.uni-tuebingen.de>

Dear Prof. Bivand,
It is again me on the coordinate transformation problem. So far the 
transformation to the rotated grid has gone ok, as in the example
crds <- matrix(data=c(9.05, 48.52), ncol=2)
spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=ob_tran 
+o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
+no_defs"))
a <- spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
use_ob_tran=TRUE)

However:
spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs") , use_ob_tran=TRUE, 
inv=TRUE)
spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs") , 
use_ob_tran=TRUE)@coords*180/pi

You can see that for the inverse transformation back to normal 
coordinates, things are not multiplied by 180/pi. There is a warning, 
though:
In spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
+o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"),  :
   project: use_ob_tran set FALSE

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From Roger.Bivand at nhh.no  Mon Aug 20 14:22:07 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 Aug 2012 14:22:07 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <50322A28.2060106@ifg.uni-tuebingen.de>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<50322A28.2060106@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208201416130.16209@reclus.nhh.no>

On Mon, 20 Aug 2012, Martin Ivanov wrote:

> Dear Prof. Bivand,
> It is again me on the coordinate transformation problem. So far the 
> transformation to the rotated grid has gone ok, as in the example
> crds <- matrix(data=c(9.05, 48.52), ncol=2)
> spPoint <- SpatialPoints(coords=crds, proj4string=CRS("+proj=ob_tran 
> +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
> +no_defs"))
> a <- spTransform(spPoint, CRS("+proj=longlat +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE)
>
> However:
> spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
> +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs") , use_ob_tran=TRUE, 
> inv=TRUE)

There is no inv= argument to spTransform() methods. I'll add the reverse 
for the target too - we should have checked this before I submitted rgdal 
yesterday. It will mean a change in the flags to show direction.

Roger

> spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
> +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs") , 
> use_ob_tran=TRUE)@coords*180/pi
>
> You can see that for the inverse transformation back to normal coordinates, 
> things are not multiplied by 180/pi. There is a warning, though:
> In spTransform(a, CRS("+proj=ob_tran +o_proj=longlat +o_lon_p=-162 
> +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"),  :
>  project: use_ob_tran set FALSE
>
> Best regards,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From martin.ivanov at ifg.uni-tuebingen.de  Mon Aug 20 14:25:24 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Mon, 20 Aug 2012 14:25:24 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208201416130.16209@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<50322A28.2060106@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208201416130.16209@reclus.nhh.no>
Message-ID: <50322CB4.2070501@ifg.uni-tuebingen.de>

Dear Prof. Bivand,

Thank You very much for Your support. I will be looking forward to the 
new revision.

Best regards,

-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From Roger.Bivand at nhh.no  Mon Aug 20 18:01:27 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 Aug 2012 18:01:27 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <50322CB4.2070501@ifg.uni-tuebingen.de>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<50322A28.2060106@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208201416130.16209@reclus.nhh.no>
	<50322CB4.2070501@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208201759330.16209@reclus.nhh.no>

On Mon, 20 Aug 2012, Martin Ivanov wrote:

> Dear Prof. Bivand,
>
> Thank You very much for Your support. I will be looking forward to the new 
> revision.

Revision 357 should fix the problem - note that both spTransform() and 
project() do the to/from reversal internally, so please read the help 
files to see how to assign the CRS to the objects (in standard order, not 
in reversed order).

Roger

>
> Best regards,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From f.bruna at udc.es  Mon Aug 20 22:13:15 2012
From: f.bruna at udc.es (Fernando Bruna Quintas)
Date: Mon, 20 Aug 2012 22:13:15 +0200 (CEST)
Subject: [R-sig-Geo] spdep/splm: k-nearest neighbors, normalizations, listw2U,
 spatial models, methods
Message-ID: <848934942.235025.1345493595322.JavaMail.root@ms1b.correo.udc.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120820/849fad75/attachment.pl>

From tom.gottfried at o2mail.de  Mon Aug 20 23:09:38 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Mon, 20 Aug 2012 23:09:38 +0200
Subject: [R-sig-Geo] Interpolating
In-Reply-To: <1345495667.84116.YahooMailNeo@web121505.mail.ne1.yahoo.com>
References: <1345432109.26346.YahooMailNeo@web121504.mail.ne1.yahoo.com>
	<5031F257.7060307@o2mail.de>
	<1345495667.84116.YahooMailNeo@web121505.mail.ne1.yahoo.com>
Message-ID: <5032A792.4010607@o2mail.de>


 From ?predict.lm:
"Variables are first looked for in newdata and then searched for in the 
usual way (which will include the environment of the formula used in the 
fit). A warning will be given if the variables found are not of the same 
length as those in newdata if it was supplied."

The first sentence actually implies, that the columns in newdata need to 
have the names of the variables as specified in the model formula. 
Otherwise, at least in the multivariable case and if the data.frame has 
more than one column, it is impossible to recognize which data to use. Thus

x<-data.frame(day=c(1,2,3,4))

HTH,
Tom

Am 20.08.2012 22:47, schrieb K Jjw:
> Hi
> Here is some of my code
> jan_ppt_i<- structure(c(155.100006103516, 203.931690865494, 218.219503262085
> ), .Names = c("prec_clim_jan", "pr_2040a1b_jan_ukmo_hadcm3",
> "pr_2090a1b_jan_ukmo_hadcm3"))
> day<-c(1,18262,36525)
>
> #linear regression of the data
> linr_jan<-predict(lm(jan_ppt_i~day))
> #prediction where it stops working
> x<-data.frame(c(1,2,3,4))
> pred<-predict(lm(jan_ppt_i~day), x)
>
> Warning message:
> 'newdata' had 4 rows but variable(s) found have 3 rows
>
> Thanks for your help
> KJ
> *From:* Tom Gottfried <tom.gottfried at o2mail.de>
> *To:* r-sig-geo at r-project.org
> *Sent:* Monday, August 20, 2012 8:16 PM
> *Subject:* Re: [R-sig-Geo] Interpolating
>
> Am 20.08.2012 05:08, schrieb K Jjw:
>  > Hi
>  > I tried predict but I get an error. Warning message: 'newdata' had 4
> rows but variable(s) found have 3 rows
>  > it only works if the number of rows that i am trying to predict are
> the same as the original number of rows (3). It does however work when I
> try to do the same thing for example in ?predict (tried with 17 rows to
> predict when the original function is 15 rows) . Not sure what is going
> on. Has anyone run into the same problem before?
>
> Not sure what is going on neither. But a reproducible example would
> surely help you and others on the list to get to know what is going on.
>
> Regards,
> Tom
>
>  > Thanks
>  > KJ
>  >
>  >
>  >
>  > ?predict
>  > ?predict.lm
>  >
>  > HTH,
>  > Tom
>  >
>  > Am 15.08.2012 04:05, schrieb K Jjw:
>  >> Hi
>  >>
>  >>
>  >> I have data that are from 1990, 2040, and 2090. I
>  > need to loop through each location (defined in a grid of 240x260) and
> find a
>  > linear regression for each place across the 3 years. I then need to
> interpolate
>  > the data to get the missing years for the given location ie I need
> all the data
>  > for 1991, 1992, 1993 etc. I have a loop and I have figured out how to
> make the
>  > model ie lm(). What I am having difficulty with is interpolating the data
>  > without hardcoding in the formula of the linear regression.
>  >>
>  >> so basically the bit of code that is causing me
>  > problems is
>  >>
>  >> linr<-lm(jan_ppt~date)
>  >> linr
>  >>
>  >> Call:
>  >> lm(formula = jan_ppt ~ date)
>  >>
>  >> Coefficients:
>  >> (Intercept) date
>  >> 1.482e+02 1.728e-03
>  >>
>  >> x<- 1990:2090
>  >> y<-1.482e2 + 1.728e-3*x #this is what I have now
>  >> y<- intercept+ grad*x #this is what I want where
>  > 'intercept' and 'grad' are defined from the model 'linr'
>  >>
>  >> how do I
>  > define y without hardcoding the coefficients as they will change for
> every
>  > location. I basically need to do linear regressions for each location
> then
>  > interpolate the data to get yearly data in order to put this data in
> another
>  > model that requires yearly data.
>  >>
>  >> Thanks
>  >>
>  >> KJ
>  >> [[alternative
>  > HTML version deleted]]
>  >>
>  >>
>  >>
>  >>
>  >> _______________________________________________
>  >> R-sig-Geo mailing list
>  >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>  >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  > [[alternative HTML version deleted]]
>  >
>  >
>  >
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From kjjw32 at yahoo.com  Mon Aug 20 23:19:44 2012
From: kjjw32 at yahoo.com (K Jjw)
Date: Mon, 20 Aug 2012 14:19:44 -0700 (PDT)
Subject: [R-sig-Geo] Interpolating
In-Reply-To: <5032A792.4010607@o2mail.de>
References: <1345432109.26346.YahooMailNeo@web121504.mail.ne1.yahoo.com>
	<5031F257.7060307@o2mail.de>
	<1345495667.84116.YahooMailNeo@web121505.mail.ne1.yahoo.com>
	<5032A792.4010607@o2mail.de>
Message-ID: <1345497584.32365.YahooMailNeo@web121504.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120820/720b4079/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug 21 10:06:24 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Aug 2012 10:06:24 +0200 (CEST)
Subject: [R-sig-Geo] spdep/splm: k-nearest neighbors, normalizations,
 listw2U, spatial models, methods
In-Reply-To: <848934942.235025.1345493595322.JavaMail.root@ms1b.correo.udc.es>
References: <848934942.235025.1345493595322.JavaMail.root@ms1b.correo.udc.es>
Message-ID: <alpine.LRH.2.02.1208210947140.20263@reclus.nhh.no>

On Mon, 20 Aug 2012, Fernando Bruna Quintas wrote:

> Dear Prof. Bivand and listers:
>
> I started with spatial econometrics and R a few months ago and this is 
> the first time I write here. My apologies if I miss something.
>
> In am a bit confused about the final weight matrix I am using with 
> spdep. Initially I start with an inverse distance matrix to the 
> 5-nearest neighbors, so asymmetric general weights. I decided this 
> matrix as my baseline because of several reasons: I research about 
> distance, Griffith (1996) rules of thumb, inspection of the plots of 
> links...
>
> I build the listw style W (row-normalization) to apply errorsarlm or 
> lagsarlm. But at least for method eigen, theses functions use the 
> function listw2U which changes my listw.

Good that you realise that you are confused! Your conclusion is wrong. If 
(and only if) the listw object can be Ord-transformed to symmetry (an 
underlying symmetric set of neighbours and weighting scheme "W" or "S"), 
the Ord transformation is applies, and possible numerical (< 1e-16 
differences across the diagonal) fuzz removed with listw2U(). If the 
underlying neighbours are asymmetric, the can.sim variable in the model 
fitting functions is FALSE, so the eigenvalues are extracted from the 
asymmetric matrix. You missed the if() statement in the code in 
eigen_setup() (in jacobian.R), documented in ?eigen_setup

>
> I will try to write separate questions or sentences about my doubts, 
> though they are related:
>
> Q1 - I understand that the similar.listw function 
> (http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:similar.listw) is 
> the same than listw2U but I am not sure.

No, similar.listw() does the Ord transformation, listw2U does (W + W')*0.5

>
> Q2 - I see that listw2U uses the function make.sym.nb, adding the 
> neighbors that were asymmetric. If this is true, I miss the property of 
> asymmetry, so I do not see the point of starting with k-nearest 
> neighbors.

The assumption is that people know what they are doing, so if the user 
wants to impose symmetry, this is a possible choice. The function is not 
used as much as you seem to think.

>
> Q3 - Similarly, I understand that these functions are applying Ord 
> (1975) transformation, though the notation here confuses me: 
> http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:lm.morantest The 
> helper function listw2U() constructs a weights list object corresponding 
> to the sparse matrix 1/2 (W + W').

Some derivations of Moran tests are based on symmetry, and most often 
cross-products of W are involved, making the point moot (see Cliff & Ord 
1973).

>
> Q4 - The help in moran.test explains that for inherently non-symmetric 
> matrices, such as k-nearest neighbour matrices, listw2U() can be used to 
> make the matrix symmetric. Does this means that I should pass my W 
> matrix through listw2U before Moran test?. In row-normalizatization W 
> style or in B style with inverse distance weights?

I'm travelling and cannot answer more now. I think that you have confused 
youself more than necessary. There is no problem for model fitting, and as 
far as I am aware, no problem for tests. Please provide worked examples 
showing that the current code leads to results that you can show are 
incorrect (for example giving different results from OpenGeoDa, PySAL, 
Matlab Spatial Econometrics toolbox). Simplify your question to one point, 
not many as now.

Hope this clarifies,

Roger

>
> Q5 - In Elhorst (2010) (Fisher & Getis book, page 380) I see that Ord 
> transformation keeps unchanged the mutual proportions between the 
> elemets of W, which is relevant for inverse distances (Anselin 1998, 
> 23-24). I understand that if I want to keep the interpretation of 
> inverse distances I should apply this transformation to the listw style 
> B, without row-normalization, with my general spatial weights of inverse 
> distances. But the method eigen in, for instance, lagsarlm or ASDAR page 
> 284 says that Ord normalization can be used just with W matrixes. I have 
> tried this method to estimate spatial models with my listw in both B and 
> W styles, but I am not sure what I am doing at the end in each case.
>
> Q7 - Similarly to standardization, the fact of making symmetric the matrix, loses the geographical interpretation. The unit A can be the nearest neighbors of B but not the contrary so their main links would not be reciprocal. I am not sure about in which ways the issue of symmetry in the nb list is a different issue from normalization of weights. Both things usually are discussed at the same time, but they are conceptually different
>
> Q8 - If it is a problem of estimation, I can use other methods to keep my matrix asymmetric and/or with no-standardized weights. Which one would be better?.
>
> Q9 - Any idea about how the splm packages deals with some of the previous issues?
>
> Q10 - This question is more general. I am still not sure if I understand well the reasons for normalization. Maybe it is to ensure the estimation by keeping the eigen values in the right range. Right now I do not care about the easier interpretation of the parameters after row-normalization. My question is if normalization helps to correct spatial autocorrelation. If so, why does it helps if it, at least with row-normalization, loses the main information about the absolute distance to each neighbor?. Why the impact of each unit by all other unit should be equalized?. Is each unit equally open, equally close to the other ones?. Or this is just to avoid imposing structure on the spatial dependence so general spatial weights are not that useful (just relative distances)?
>
> Any thinking about these doubts would be very appreciated. Thank you very much
>
> Fernando
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From katja.flammang at tudor.lu  Tue Aug 21 10:09:07 2012
From: katja.flammang at tudor.lu (katja.flammang at tudor.lu)
Date: Tue, 21 Aug 2012 10:09:07 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <OFE07B5341.BA3B4388-ONC1257A61.002CC7CC-C1257A61.002CC7D1@tudor.lu>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120821/983409d6/attachment.html>

From b.rowlingson at lancaster.ac.uk  Tue Aug 21 12:17:45 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 21 Aug 2012 11:17:45 +0100
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <763c0bce325349f69f7966ab9bec7258@EX-1-HT0.lancs.local>
References: <763c0bce325349f69f7966ab9bec7258@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPu-R4MOtimfR918ebh-tJb_ZPNfekmcVU=HTrxVjA9Lg@mail.gmail.com>

On Tue, Aug 21, 2012 at 9:09 AM, katja.flammang at tudor.lu
<katja.flammang at tudor.lu> wrote:
> Hi,
>
> I'm new to this list so I hope I'm not missing anything.
>
> I'm trying to read a file from a database and then write it to my schema in
> the same database. The readOGR function works good but I'm having
> difficulties with writeOGR.
>
> Here is what R is telling me:
>
>> flik_crop_types <- readOGR("PG:dbname=valid host=myhost user=myusername
>> password=mypassword schemas=cbraun","flik_crop_types_08_lux_recl")
>
> OGR data source with driver: PostgreSQL Source: "PG:dbname=valid host=myhost
> user=myusername password=mypassword schemas=cbraun", layer:
> "flik_crop_types_08_lux_recl" with 75836 features and 7 fields Feature type:
> wkbPolygon with 2 dimensions
>
>> writeOGR(flik_crop_types, "PG:dbname=valid host=myhost user=myusername
>> password=mypassword schemas=myschema", "flik_crop_types_08_lux_recl",
>> "PostgreSQL")
>
> Error in writeOGR(flik_crop_types, "PG:dbname=valid host=myhost
> user=myusername password=mypassword schemas=myschema", : Layer creation
> failed

 I can think that either:

 Your PostGIS driver doesn't have write support - what does ogrDrivers() say?

 Is your 'myschema' PostGIS-enabled? Does it have a "geometry_columns" table?

 Another idea is to try writing a normal table to it using the
standard R database connection stuff. That will check you have the
right write permissions...

Barry


From jmblanco at ub.edu  Tue Aug 21 21:30:40 2012
From: jmblanco at ub.edu (=?iso-8859-1?Q?Jos=E9_M=2E_Blanco_Moreno?=)
Date: Tue, 21 Aug 2012 19:30:40 +0000
Subject: [R-sig-Geo] Estimating multiStrauss interaction radii ---
 CORRECTION
In-Reply-To: <502EE64D.6010801@auckland.ac.nz>
References: <BBF61FDBC9E7254991EFE852E9BC93803A9D8B33@daumbpro03.da.ub.edu>
	<502D7C51.6090902@auckland.ac.nz> <502DA858.4050405@ub.edu>
	<502EE64D.6010801@auckland.ac.nz>
Message-ID: <BBF61FDBC9E7254991EFE852E9BC93803A9D8FEA@daumbpro03.da.ub.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120821/540f7997/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug 21 23:30:59 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Aug 2012 23:30:59 +0200 (CEST)
Subject: [R-sig-Geo] spdep/splm: k-nearest neighbors, normalizations,
 listw2U, spatial models, methods
In-Reply-To: <alpine.LRH.2.02.1208210947140.20263@reclus.nhh.no>
References: <848934942.235025.1345493595322.JavaMail.root@ms1b.correo.udc.es>
	<alpine.LRH.2.02.1208210947140.20263@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1208212318520.24676@reclus.nhh.no>

On Tue, 21 Aug 2012, Roger Bivand wrote:

> On Mon, 20 Aug 2012, Fernando Bruna Quintas wrote:
>
>> Dear Prof. Bivand and listers:
>> 
>> I started with spatial econometrics and R a few months ago and this is the 
>> first time I write here. My apologies if I miss something.
>> 
>> In am a bit confused about the final weight matrix I am using with spdep. 
>> Initially I start with an inverse distance matrix to the 5-nearest 
>> neighbors, so asymmetric general weights. I decided this matrix as my 
>> baseline because of several reasons: I research about distance, Griffith 
>> (1996) rules of thumb, inspection of the plots of links...
>> 
>> I build the listw style W (row-normalization) to apply errorsarlm or 
>> lagsarlm. But at least for method eigen, theses functions use the function 
>> listw2U which changes my listw.

I can confirm that row-standardised k=5 asymmetric weights give the same 
regression coefficients in lagsarlm() and Stata's spreg ml. Nothing 
untoward is going on, and no changes are being made to the weights.

>
> Good that you realise that you are confused! Your conclusion is wrong. If 
> (and only if) the listw object can be Ord-transformed to symmetry (an 
> underlying symmetric set of neighbours and weighting scheme "W" or "S"), the 
> Ord transformation is applies, and possible numerical (< 1e-16 differences 
> across the diagonal) fuzz removed with listw2U(). If the underlying 
> neighbours are asymmetric, the can.sim variable in the model fitting 
> functions is FALSE, so the eigenvalues are extracted from the asymmetric 
> matrix. You missed the if() statement in the code in eigen_setup() (in 
> jacobian.R), documented in ?eigen_setup
>
>> 
>> I will try to write separate questions or sentences about my doubts, though 
>> they are related:
>> 
>> Q1 - I understand that the similar.listw function 
>> (http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:similar.listw) is the 
>> same than listw2U but I am not sure.
>
> No, similar.listw() does the Ord transformation, listw2U does (W + W')*0.5
>
>> 
>> Q2 - I see that listw2U uses the function make.sym.nb, adding the neighbors 
>> that were asymmetric. If this is true, I miss the property of asymmetry, so 
>> I do not see the point of starting with k-nearest neighbors.
>
> The assumption is that people know what they are doing, so if the user wants 
> to impose symmetry, this is a possible choice. The function is not used as 
> much as you seem to think.

Running listw2U() and 0.5*(W + t(W)) are fully equivalent for asymmetric 
neighbours:

set.seed(1) # or your choice of seed
res <- logical(500)
for (i in seq(along=res)) {
   nb5 <- knn2nb(knearneigh(cbind(runif(100), runif(100)), k=5))
   lw5 <- nb2listw(nb5, style="W")
   m5 <- listw2mat(lw5)
   MU5 <- 0.5*(m5 + t(m5))
   lwU5 <- listw2U(lw5)
   MUU5 <- listw2mat(lwU5)
   res[i] <- all.equal(MU5, MUU5)
}
table(res)

make.sym.nb() is used to find the "missing" cross-diagonal entries.

>
>> 
>> Q3 - Similarly, I understand that these functions are applying Ord (1975) 
>> transformation, though the notation here confuses me: 
>> http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:lm.morantest The helper 
>> function listw2U() constructs a weights list object corresponding to the 
>> sparse matrix 1/2 (W + W').
>
> Some derivations of Moran tests are based on symmetry, and most often 
> cross-products of W are involved, making the point moot (see Cliff & Ord 
> 1973).
>

The output of lm.morantest(), and its equivalents in PySAL and OpenGeoDa 
are identical for k=5 asymmetric weights.

>> 
>> Q4 - The help in moran.test explains that for inherently non-symmetric 
>> matrices, such as k-nearest neighbour matrices, listw2U() can be used to 
>> make the matrix symmetric. Does this means that I should pass my W matrix 
>> through listw2U before Moran test?. In row-normalizatization W style or in 
>> B style with inverse distance weights?
>
> I'm travelling and cannot answer more now. I think that you have confused 
> youself more than necessary. There is no problem for model fitting, and as 
> far as I am aware, no problem for tests. Please provide worked examples 
> showing that the current code leads to results that you can show are 
> incorrect (for example giving different results from OpenGeoDa, PySAL, Matlab 
> Spatial Econometrics toolbox). Simplify your question to one point, not many 
> as now.
>
> Hope this clarifies,
>
> Roger
>
>> 
>> Q5 - In Elhorst (2010) (Fisher & Getis book, page 380) I see that Ord 
>> transformation keeps unchanged the mutual proportions between the elemets 
>> of W, which is relevant for inverse distances (Anselin 1998, 23-24). I 
>> understand that if I want to keep the interpretation of inverse distances I 
>> should apply this transformation to the listw style B, without 
>> row-normalization, with my general spatial weights of inverse distances. 
>> But the method eigen in, for instance, lagsarlm or ASDAR page 284 says that 
>> Ord normalization can be used just with W matrixes. I have tried this 
>> method to estimate spatial models with my listw in both B and W styles, but 
>> I am not sure what I am doing at the end in each case.

Ord normalization can be used on W and S style, for underlying symmetric 
weights. If the underlying weights are not symmetric, it cannot be used, 
and the eigenvalues will be complex. For comparison use the LU method, 
which can also handle intrinsically asymmetric weights.

Roger

>> 
>> Q7 - Similarly to standardization, the fact of making symmetric the matrix, 
>> loses the geographical interpretation. The unit A can be the nearest 
>> neighbors of B but not the contrary so their main links would not be 
>> reciprocal. I am not sure about in which ways the issue of symmetry in the 
>> nb list is a different issue from normalization of weights. Both things 
>> usually are discussed at the same time, but they are conceptually different
>> 
>> Q8 - If it is a problem of estimation, I can use other methods to keep my 
>> matrix asymmetric and/or with no-standardized weights. Which one would be 
>> better?.
>> 
>> Q9 - Any idea about how the splm packages deals with some of the previous 
>> issues?
>> 
>> Q10 - This question is more general. I am still not sure if I understand 
>> well the reasons for normalization. Maybe it is to ensure the estimation by 
>> keeping the eigen values in the right range. Right now I do not care about 
>> the easier interpretation of the parameters after row-normalization. My 
>> question is if normalization helps to correct spatial autocorrelation. If 
>> so, why does it helps if it, at least with row-normalization, loses the 
>> main information about the absolute distance to each neighbor?. Why the 
>> impact of each unit by all other unit should be equalized?. Is each unit 
>> equally open, equally close to the other ones?. Or this is just to avoid 
>> imposing structure on the spatial dependence so general spatial weights are 
>> not that useful (just relative distances)?
>> 
>> Any thinking about these doubts would be very appreciated. Thank you very 
>> much
>> 
>> Fernando
>> 
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kjjw32 at yahoo.com  Wed Aug 22 06:42:30 2012
From: kjjw32 at yahoo.com (K Jjw)
Date: Tue, 21 Aug 2012 21:42:30 -0700 (PDT)
Subject: [R-sig-Geo] loop- changing varible names
Message-ID: <1345610550.79715.YahooMailNeo@web121506.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120821/110222c9/attachment.pl>

From Roger.Bivand at nhh.no  Wed Aug 22 07:29:21 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Aug 2012 07:29:21 +0200 (CEST)
Subject: [R-sig-Geo] loop- changing varible names
In-Reply-To: <1345610550.79715.YahooMailNeo@web121506.mail.ne1.yahoo.com>
References: <1345610550.79715.YahooMailNeo@web121506.mail.ne1.yahoo.com>
Message-ID: <alpine.LRH.2.02.1208220721150.26678@reclus.nhh.no>

Please do not send HTML-mail, all postings must be text-only.

Comment inline below:


On Wed, 22 Aug 2012, K Jjw wrote:

> Hi ? I am trying to loop over some data while changing the variable 
> names. ? My code right now looks like ? 
> months<-c(5,4,8,1,9,7,6,2,12,11,10,3) 
> mnth_nme<-c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec") 
> a<-1 ? for (i in months) { ? had_1990<-raster(prec,months) ? 
> had_2040<-raster(tot_40,months) ? had_2090<-raster(tot_90,months) ? #all 
> the?month data ? 
> paste(mnth_nme[a],"_ppt",sep="")<-stack(had_1990,had_2040,had_2090)### 
> this? is where it breaks down. ? a<-a+1 ? } ? Basically I want to end up 
> with each month's data stacked and called jan_ppt, feb_ppt.... ? I tried 
> to google the solution and people seem to suggest lists but when I tried 
> to make a list I got another error and I am not sure what I am doing 
> wrong ?> months<-c(5,4,8,1,9,7,6,2,12,11,10,3) > 
> mnth_nme<-c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec") 
> > a<-1 > mnth <- list() > for(i in mnth_nme) + { + 
> mnth[[paste(mnth_nme[a]"_ppt",sep="")]] Error: unexpected string 
> constant in: "{ mnth[[paste(mnth_nme[a]"_ppt"" ?

Your HTML-mail is not easy to read, and HTML misformatting may lead to 
confusion. You should read error messages carefully:

Error: unexpected string constant in: "{ mnth[[paste(mnth_nme[a]"_ppt""

seems clear enough, as you (probably) omitted a comma in the paste() call. 
When putting things in loops, do simplify and echo to console:

comp_nm <- paste(mnth_nme[a], "ppt", sep="_")
cat(comp_nm, "\n")
mnth[[comp_nm]] <- ...

to see what is going on, removing the in-loop console output when you know 
it works. Arguably the _ppt in the variable name is redundant anyway, 
isn't it?

Roger

> Any explanation would be very helpful. Thanks
> ?
> KJ
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From agus.camacho at gmail.com  Wed Aug 22 13:40:25 2012
From: agus.camacho at gmail.com (Agus Camacho)
Date: Wed, 22 Aug 2012 08:40:25 -0300
Subject: [R-sig-Geo] how to hange the size of raster maps
In-Reply-To: <CAJmQPwGjN_cH2z635TVwZcAT-meRLdWgyRxKVAN+bSKre8u7hA@mail.gmail.com>
References: <CALsJ7pTMvEyjJnmker0gKj3G2J1iv0q4245=p3tHGoRxLT0kFg@mail.gmail.com>
	<CAJmQPwGjN_cH2z635TVwZcAT-meRLdWgyRxKVAN+bSKre8u7hA@mail.gmail.com>
Message-ID: <CALsJ7pRBNyd63Md2f-5zw7YO4qB2d18g81OKFwZgH49LOt+fnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/3de45873/attachment.pl>

From adamhsparks at gmail.com  Wed Aug 22 14:17:43 2012
From: adamhsparks at gmail.com (Adam Sparks)
Date: Wed, 22 Aug 2012 13:17:43 +0100
Subject: [R-sig-Geo] how to hange the size of raster maps
In-Reply-To: <CALsJ7pRBNyd63Md2f-5zw7YO4qB2d18g81OKFwZgH49LOt+fnw@mail.gmail.com>
References: <CALsJ7pTMvEyjJnmker0gKj3G2J1iv0q4245=p3tHGoRxLT0kFg@mail.gmail.com>
	<CAJmQPwGjN_cH2z635TVwZcAT-meRLdWgyRxKVAN+bSKre8u7hA@mail.gmail.com>
	<CALsJ7pRBNyd63Md2f-5zw7YO4qB2d18g81OKFwZgH49LOt+fnw@mail.gmail.com>
Message-ID: <CAJmQPwHv5sKAK+yqa8sJV9+fWqXb1rws7Hu=Xr4USeZ+pntCdA@mail.gmail.com>

Dear Agus,
?png indicates bg="transparent in png() is supported when exporting png files.

That should give you a transparent background as desired.

> <snip>
> However, despite this script worked for plotting a phylogenetic tree with transparent background, i am still not able to generate a raster plot with transparent background.
>
> Many thanks!
> Agus
>
> 2012/7/25 Adam Sparks <adamhsparks at gmail.com>
>>
>> Dear Agus,
>> I'd suggest using the pdf() or png() functions in your script, rather than relying on RStudio's exporting.
>>
>> This way you can specify the size.
>>
>> best,
>> Adam
>>
>>
>>
>> On Wed, Jul 25, 2012 at 8:36 AM, Agus Camacho <agus.camacho at gmail.com> wrote:
>>>
>>> Dear all,
>>>
>>> I am trying to change the size to raster maps generated in R. However, the
>>> differently layers separate when i do this.
>>> Any body knows if its possible and how to avoid this?
>>> Thanks
>>> There it goes an reproducible example
>>>
>>> alt <- getData('alt', country='CHE')
>>> slope <- terrain(alt, opt='slope')
>>> aspect <- terrain(alt, opt='aspect')
>>> hill <- hillShade(slope, aspect, 40, 270)
>>> plot(hill, col=grey(0:100/100), legend=FALSE, main='Switzerland')
>>> plot(alt, col=rainbow(25, alpha=0.35), add=TRUE)
>>>
>>> Then, use image export or save in pdf, or zoom options in Rs tudio to
>>> change the size of the file.
>>>
>>> Thanks in advance.
>>> Agus
>>>
>>> --
>>> Agust?n Camacho Guerrero.
>>> Doutorando em Zoologia.
>>> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
>>> Bioci?ncias, USP.
>>> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
>>> S?o Paulo - SP, CEP: 05508-090, Brasil.
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> --
>> Adam Sparks
>> Plant Pathologist and GIS Specialist
>> IRRI
>> DAPO Box 7777, Metro Manila, Philippines
>> ph: +63(2) 580-5600
>>
>>
>
>
>
> --
> Agust?n Camacho Guerrero.
> Doutorando em Zoologia.
> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de Bioci?ncias, USP.
> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
> S?o Paulo - SP, CEP: 05508-090, Brasil.
>



--
--
Adam Sparks
Plant Pathologist and GIS Specialist
IRRI
DAPO Box 7777, Metro Manila, Philippines
ph: +63(2) 580-5600


From Andy.Bunn at wwu.edu  Wed Aug 22 20:28:28 2012
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Wed, 22 Aug 2012 18:28:28 +0000
Subject: [R-sig-Geo] raster: use extract to get data from a
 categorical/discrete/factor raster
Message-ID: <9B597DE5AF080D418509A7E9F1E93EAF0270641D@Exch2010MB-3.univ.dir.wwu.edu>

I have foo which is a SpatialPointsDataFrame and bar which is a raster containing land-cover data (i.e., bar is categorical).

The easiest way to extract the landcover for each point in foo is: 
    extract(bar, foo, method='simple')

However, I'd like to do get the majority value from the values of the four nearest raster cells - the categorical equivalent of: 
    extract(bar, foo, method='bilinear')
which is obviously the wrong move with a discrete raster.

Advice appreciated!


From r.hijmans at gmail.com  Wed Aug 22 21:09:12 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 22 Aug 2012 12:09:12 -0700
Subject: [R-sig-Geo] raster: use extract to get data from a
 categorical/discrete/factor raster
In-Reply-To: <9B597DE5AF080D418509A7E9F1E93EAF0270641D@Exch2010MB-3.univ.dir.wwu.edu>
References: <9B597DE5AF080D418509A7E9F1E93EAF0270641D@Exch2010MB-3.univ.dir.wwu.edu>
Message-ID: <CANtt_hzX3pimTcS2-=_e9_JMFPwttzOnf-FUcpjw+ZYq46rWrA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/ef0f39a1/attachment.pl>

From oliveirajc1 at gmail.com  Wed Aug 22 21:50:10 2012
From: oliveirajc1 at gmail.com (Julio Oliveira)
Date: Wed, 22 Aug 2012 16:50:10 -0300
Subject: [R-sig-Geo] load workspace by function
In-Reply-To: <mailman.9.1345629602.2139.r-sig-geo@r-project.org>
References: <mailman.9.1345629602.2139.r-sig-geo@r-project.org>
Message-ID: <978186E9-FE8A-497B-96A4-D82E221C7F8F@gmail.com>

Dear,

I would like load a saved workspace (file .Rdata) by function.

Example:

load_workspace <- function ()
{
  workspace_name <<- (tk_choose.files(default = "", caption = "Select the Workspace file (.Rdata) ")
   load(workspace_name) 
}

But, when finish the function (load_workspace) the files of the .Rdata are deleted.

Area there any command for return the files?

Thanks.

Julio

From Andy.Bunn at wwu.edu  Wed Aug 22 22:39:49 2012
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Wed, 22 Aug 2012 20:39:49 +0000
Subject: [R-sig-Geo] raster: use extract to get data from a
 categorical/discrete/factor raster
In-Reply-To: <CANtt_hzX3pimTcS2-=_e9_JMFPwttzOnf-FUcpjw+ZYq46rWrA@mail.gmail.com>
References: <9B597DE5AF080D418509A7E9F1E93EAF0270641D@Exch2010MB-3.univ.dir.wwu.edu>
	<CANtt_hzX3pimTcS2-=_e9_JMFPwttzOnf-FUcpjw+ZYq46rWrA@mail.gmail.com>
Message-ID: <9B597DE5AF080D418509A7E9F1E93EAF02706679@Exch2010MB-3.univ.dir.wwu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/ea3d5624/attachment.pl>

From f.bruna at udc.es  Wed Aug 22 22:51:30 2012
From: f.bruna at udc.es (Fernando Bruna Quintas)
Date: Wed, 22 Aug 2012 22:51:30 +0200 (CEST)
Subject: [R-sig-Geo] spdep/splm: k-nearest neighbors, normalizations,
 listw2U, spatial models, methods
In-Reply-To: <alpine.LRH.2.02.1208212318520.24676@reclus.nhh.no>
Message-ID: <1236352384.244602.1345668690026.JavaMail.root@ms1b.correo.udc.es>


Thank you very much for the detailed answer. My apologizes for asking so many things. My problem was not one of comparing results from different software but of understanding what I was doing. I was just getting crazy and with too many questions. Now I see some light. Let me to summarize just to check if I am understanding right (apologies for the extension, there were many issues involved in the same problem).

Now I see that I have to test for autocorrelation with a symmetric matrix, so maybe it is more reasonable to use that same symmetric matrix for everything and later compare spatial models with the LU method and my original asymmetric matrix. list2W does not do the job of symmetrizing in my case because with general weights the true inverse distance of asymmetric links is divided by two. So I have to use make.sym.nb or to start with a symmetric approach of neighbourhood.

On the other hand I had a confusion (fatigue and haste!) about when the word "symmetry" is used for nb objects or for weights. My second problem was one keeping the economic interpretation of the inverse distances, style B. With a symmetric nb object, the inverse distance weights are symmetric too, and they get asymmetric with row-standardization, which loses the absolute value of the distances. Trying to understand this, I paid attention to this sentence by Elhorst (2010) in Fisher and Getis Hadbook, page 380:

"If  W0 denotes the spatial weights matrix BEFORE NORMALIZATION, one may (...) normalize  W0 by  W=D^(1/2)?W0?D^(1/2), where D is a diagonal matrix containing the row sums of W0. (This) operation has been proposed by Ord (1975) and has the effect that the  characteristic roots of  W are identical to the characteristic roots of a row-normalized  W0. Importantly, THE MUTUAL PROPORTIONS BETWEEN THE ELEMENTS OF W remain unchanged as a result of these two alternative normalizations. This is an important property when W represents an inverse distance matrix, since scaling the rows or columns of an inverse distance matrix so that the weights sum to one would cause this matrix to lose its economic interpretation for this decay (Anselin 1988, pp. 23-24)."

But Ord(1975, 125) speaks of a symmetric unstandardized W0 and standardized it with DW0. So really it is:  W=D^(1/2)?(DW0)?D^(1/2). That is what similar.listw does and  you explain in ASDAR page 284.

So now I realize that my trouble was with Elhorst sentence, not with spdep explanations. I do not see that Ord-transformation would keep the mutual proportions between the elements of a B style inverse distance weighting matrix ("before normalization"). I did a few checks about the mutual proportions (I send to you if you want) and they change. I misunderstood what Elhorst seem to say. Ords transformation seems to work for W-style weights of a symmetric matrix, so the mutual proportions of elements in the B-style (absolute inverse distances) get lost.

Now I see that the spatial models use Ord-transformation if and only if the listw object can be Ord-transformed to symmetry. So my original listw (row-standardized inverse distance 5-nearest neighbours) was left untouched. Ord-transformation will be applied if now I use the row-standardized symmetrized (nb) version or a symilar matrix with symmetric neighbours.

But if I want to keep the economic interpretation of the weights I should use the B version. I made a few checks (I send you all you want). With the default method I get those weird spatial parameters (huge or negative, which makes no sense in my data). I understand that probably this is because of the eigen-value calculations. It is solved with the LU method. But I am not able to correct for the autocorrelation, contrary to the case when I use the row-standardized forms. And I get much higher AIC.

So, even if all the previous was not completely exact, now I understand better what I am doing. My last doubt remains. It is a more philosophical issue about using row-standardization to correct for spatial autocorrelation. I have a problem with the "economic interpretation" of row-standardizationt, as Anselin-Elhorst were commenting. But I understand that it is too general to ask here.

Thank you again, you helped me a lot.

Fernando Bruna




----- Mensaje original -----
De: "Roger Bivand" <Roger.Bivand at nhh.no>
Para: "Fernando Bruna Quintas" <f.bruna at udc.es>
CC: r-sig-geo at r-project.org
Enviados: Martes, 21 de Agosto 2012 23:30:59
Asunto: Re: [R-sig-Geo] spdep/splm: k-nearest neighbors, normalizations, listw2U, spatial models, methods

On Tue, 21 Aug 2012, Roger Bivand wrote:

> On Mon, 20 Aug 2012, Fernando Bruna Quintas wrote:
>
>> Dear Prof. Bivand and listers:
>> 
>> I started with spatial econometrics and R a few months ago and this is the 
>> first time I write here. My apologies if I miss something.
>> 
>> In am a bit confused about the final weight matrix I am using with spdep. 
>> Initially I start with an inverse distance matrix to the 5-nearest 
>> neighbors, so asymmetric general weights. I decided this matrix as my 
>> baseline because of several reasons: I research about distance, Griffith 
>> (1996) rules of thumb, inspection of the plots of links...
>> 
>> I build the listw style W (row-normalization) to apply errorsarlm or 
>> lagsarlm. But at least for method eigen, theses functions use the function 
>> listw2U which changes my listw.

I can confirm that row-standardised k=5 asymmetric weights give the same 
regression coefficients in lagsarlm() and Stata's spreg ml. Nothing 
untoward is going on, and no changes are being made to the weights.

>
> Good that you realise that you are confused! Your conclusion is wrong. If 
> (and only if) the listw object can be Ord-transformed to symmetry (an 
> underlying symmetric set of neighbours and weighting scheme "W" or "S"), the 
> Ord transformation is applies, and possible numerical (< 1e-16 differences 
> across the diagonal) fuzz removed with listw2U(). If the underlying 
> neighbours are asymmetric, the can.sim variable in the model fitting 
> functions is FALSE, so the eigenvalues are extracted from the asymmetric 
> matrix. You missed the if() statement in the code in eigen_setup() (in 
> jacobian.R), documented in ?eigen_setup
>
>> 
>> I will try to write separate questions or sentences about my doubts, though 
>> they are related:
>> 
>> Q1 - I understand that the similar.listw function 
>> (http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:similar.listw) is the 
>> same than listw2U but I am not sure.
>
> No, similar.listw() does the Ord transformation, listw2U does (W + W')*0.5
>
>> 
>> Q2 - I see that listw2U uses the function make.sym.nb, adding the neighbors 
>> that were asymmetric. If this is true, I miss the property of asymmetry, so 
>> I do not see the point of starting with k-nearest neighbors.
>
> The assumption is that people know what they are doing, so if the user wants 
> to impose symmetry, this is a possible choice. The function is not used as 
> much as you seem to think.

Running listw2U() and 0.5*(W + t(W)) are fully equivalent for asymmetric 
neighbours:

set.seed(1) # or your choice of seed
res <- logical(500)
for (i in seq(along=res)) {
   nb5 <- knn2nb(knearneigh(cbind(runif(100), runif(100)), k=5))
   lw5 <- nb2listw(nb5, style="W")
   m5 <- listw2mat(lw5)
   MU5 <- 0.5*(m5 + t(m5))
   lwU5 <- listw2U(lw5)
   MUU5 <- listw2mat(lwU5)
   res[i] <- all.equal(MU5, MUU5)
}
table(res)

make.sym.nb() is used to find the "missing" cross-diagonal entries.

>
>> 
>> Q3 - Similarly, I understand that these functions are applying Ord (1975) 
>> transformation, though the notation here confuses me: 
>> http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=spdep:lm.morantest The helper 
>> function listw2U() constructs a weights list object corresponding to the 
>> sparse matrix 1/2 (W + W').
>
> Some derivations of Moran tests are based on symmetry, and most often 
> cross-products of W are involved, making the point moot (see Cliff & Ord 
> 1973).
>

The output of lm.morantest(), and its equivalents in PySAL and OpenGeoDa 
are identical for k=5 asymmetric weights.

>> 
>> Q4 - The help in moran.test explains that for inherently non-symmetric 
>> matrices, such as k-nearest neighbour matrices, listw2U() can be used to 
>> make the matrix symmetric. Does this means that I should pass my W matrix 
>> through listw2U before Moran test?. In row-normalizatization W style or in 
>> B style with inverse distance weights?
>
> I'm travelling and cannot answer more now. I think that you have confused 
> youself more than necessary. There is no problem for model fitting, and as 
> far as I am aware, no problem for tests. Please provide worked examples 
> showing that the current code leads to results that you can show are 
> incorrect (for example giving different results from OpenGeoDa, PySAL, Matlab 
> Spatial Econometrics toolbox). Simplify your question to one point, not many 
> as now.
>
> Hope this clarifies,
>
> Roger
>
>> 
>> Q5 - In Elhorst (2010) (Fisher & Getis book, page 380) I see that Ord 
>> transformation keeps unchanged the mutual proportions between the elemets 
>> of W, which is relevant for inverse distances (Anselin 1998, 23-24). I 
>> understand that if I want to keep the interpretation of inverse distances I 
>> should apply this transformation to the listw style B, without 
>> row-normalization, with my general spatial weights of inverse distances. 
>> But the method eigen in, for instance, lagsarlm or ASDAR page 284 says that 
>> Ord normalization can be used just with W matrixes. I have tried this 
>> method to estimate spatial models with my listw in both B and W styles, but 
>> I am not sure what I am doing at the end in each case.

Ord normalization can be used on W and S style, for underlying symmetric 
weights. If the underlying weights are not symmetric, it cannot be used, 
and the eigenvalues will be complex. For comparison use the LU method, 
which can also handle intrinsically asymmetric weights.

Roger

>> 
>> Q7 - Similarly to standardization, the fact of making symmetric the matrix, 
>> loses the geographical interpretation. The unit A can be the nearest 
>> neighbors of B but not the contrary so their main links would not be 
>> reciprocal. I am not sure about in which ways the issue of symmetry in the 
>> nb list is a different issue from normalization of weights. Both things 
>> usually are discussed at the same time, but they are conceptually different
>> 
>> Q8 - If it is a problem of estimation, I can use other methods to keep my 
>> matrix asymmetric and/or with no-standardized weights. Which one would be 
>> better?.
>> 
>> Q9 - Any idea about how the splm packages deals with some of the previous 
>> issues?
>> 
>> Q10 - This question is more general. I am still not sure if I understand 
>> well the reasons for normalization. Maybe it is to ensure the estimation by 
>> keeping the eigen values in the right range. Right now I do not care about 
>> the easier interpretation of the parameters after row-normalization. My 
>> question is if normalization helps to correct spatial autocorrelation. If 
>> so, why does it helps if it, at least with row-normalization, loses the 
>> main information about the absolute distance to each neighbor?. Why the 
>> impact of each unit by all other unit should be equalized?. Is each unit 
>> equally open, equally close to the other ones?. Or this is just to avoid 
>> imposing structure on the spatial dependence so general spatial weights are 
>> not that useful (just relative distances)?
>> 
>> Any thinking about these doubts would be very appreciated. Thank you very 
>> much
>> 
>> Fernando
>> 
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From moshersteven at gmail.com  Wed Aug 22 23:34:51 2012
From: moshersteven at gmail.com (steven mosher)
Date: Wed, 22 Aug 2012 14:34:51 -0700
Subject: [R-sig-Geo] translating *.ige
Message-ID: <CAFFLneSsDEy1ssLV8zRm9A3YqrJbKsiqERV24S_rPrOkPVtxCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/aa2673df/attachment.pl>

From sglish at hotmail.com  Thu Aug 23 02:45:30 2012
From: sglish at hotmail.com (Chris English)
Date: Wed, 22 Aug 2012 20:45:30 -0400
Subject: [R-sig-Geo] Great Circles US IRS Migration mapping
In-Reply-To: <CANtt_hxFJ4ZW777Ot6T6VenJaZ2Acj8GcUYEbFaCoPzivCYYcw@mail.gmail.com>
References: <SNT117-W12E0A37167D4B34EE114CFC5B00@phx.gbl>,
	<CANtt_hxFJ4ZW777Ot6T6VenJaZ2Acj8GcUYEbFaCoPzivCYYcw@mail.gmail.com>
Message-ID: <SNT117-W2255FE0A905400287D4FE8C5BE0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/1c08823c/attachment.pl>

From rjadenham at gmail.com  Thu Aug 23 02:46:00 2012
From: rjadenham at gmail.com (robert denham)
Date: Thu, 23 Aug 2012 10:46:00 +1000
Subject: [R-sig-Geo] translating *.ige
In-Reply-To: <CAFFLneSsDEy1ssLV8zRm9A3YqrJbKsiqERV24S_rPrOkPVtxCA@mail.gmail.com>
References: <CAFFLneSsDEy1ssLV8zRm9A3YqrJbKsiqERV24S_rPrOkPVtxCA@mail.gmail.com>
Message-ID: <CAHMvJdRsrX_Ubrd_=-o194_aCwM0oz2Y3j5b5s_EiTMYz_PbSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120823/adcd3f60/attachment.pl>

From moshersteven at gmail.com  Thu Aug 23 04:04:23 2012
From: moshersteven at gmail.com (steven mosher)
Date: Wed, 22 Aug 2012 19:04:23 -0700
Subject: [R-sig-Geo] translating *.ige
In-Reply-To: <CAHMvJdRsrX_Ubrd_=-o194_aCwM0oz2Y3j5b5s_EiTMYz_PbSQ@mail.gmail.com>
References: <CAFFLneSsDEy1ssLV8zRm9A3YqrJbKsiqERV24S_rPrOkPVtxCA@mail.gmail.com>
	<CAHMvJdRsrX_Ubrd_=-o194_aCwM0oz2Y3j5b5s_EiTMYz_PbSQ@mail.gmail.com>
Message-ID: <CAFFLneQ2=K0nnff7vVnTJiJ5HMF69-BWkNn4tbEnGedcVbhVcg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120822/56abd7cb/attachment.pl>

From martin.ivanov at ifg.uni-tuebingen.de  Thu Aug 23 15:21:56 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Thu, 23 Aug 2012 15:21:56 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208231436100.31439@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<502CB6FB.4060504@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>
	<5036192A.4090903@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208231436100.31439@reclus.nhh.no>
Message-ID: <50362E74.20806@ifg.uni-tuebingen.de>

Dear Prof. Bivand,

Here is a minimal working example with SpatialLines and SpatialPolygons. 
With both objects spTransform does not
multiply the transformed coordinates by 180/pi:

crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51), ncol=2, byrow=TRUE, 
dimnames=list(NULL, c("lon", "lat")));
crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48), ncol=2, byrow=TRUE, 
dimnames=list(NULL, c("lon", "lat")));
crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47), ncol=2, 
byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
spLines <- SpatialLines(list(Lines(list(Line(crds1), Line(crds2), 
Line(crds3)), ID="a")));
spLines at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
bbox(spLines);
spLines_tr <- spTransform(spLines, CRS("+proj=ob_tran +o_proj=longlat 
+o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"), 
use_ob_tran=TRUE);
bbox(spLines_tr)
bbox(spLines_tr)*180/pi

crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51, 7, 51), ncol=2, 
byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48, 8, 48), ncol=2, 
byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47, 6, 47), ncol=2, 
byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
spPolygons <- SpatialPolygons(list(Polygons(list(Polygon(crds1), 
Polygon(crds2), Polygon(crds3)), ID="a")));
spPolygons at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
bbox(spPolygons);
spPolygons_tr <- spTransform(spPolygons, CRS("+proj=ob_tran 
+o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
+no_defs"), use_ob_tran=TRUE);
bbox(spPolygons_tr)
bbox(spPolygons_tr)*180/pi


The correct bounding boxes are the second ones. Hence the coordinates 
have also got to be multiplied by 180/pi.

Best regards,

Martin






On 08/23/2012 02:37 PM, Roger Bivand wrote:
> On Thu, 23 Aug 2012, Martin Ivanov wrote:
>
>> Dear Prof. Bivand,
>>
>> I tested spTransform with a SpatialLines object and it still does not 
>> multiply the coordinates by 180/pi. With SpatialPixels, SpatialPoints 
>> and SpatialGrids it works perfectly though. If necessary, I will 
>> provide a minimal working example.
>
> Please do - I may have left something out. I'm travelling now, so an 
> example would help. What about SpatialPolygons objects?
>
> Roger
>
>>
>> Best regards,
>>
>>
>


-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From Roger.Bivand at nhh.no  Thu Aug 23 19:39:59 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Aug 2012 19:39:59 +0200 (CEST)
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <50362E74.20806@ifg.uni-tuebingen.de>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<502CB6FB.4060504@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>
	<5036192A.4090903@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208231436100.31439@reclus.nhh.no>
	<50362E74.20806@ifg.uni-tuebingen.de>
Message-ID: <alpine.LRH.2.02.1208231938060.32135@reclus.nhh.no>

On Thu, 23 Aug 2012, Martin Ivanov wrote:

> Dear Prof. Bivand,
>
> Here is a minimal working example with SpatialLines and SpatialPolygons. With 
> both objects spTransform does not
> multiply the transformed coordinates by 180/pi:
>
> crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51), ncol=2, byrow=TRUE, 
> dimnames=list(NULL, c("lon", "lat")));
> crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48), ncol=2, byrow=TRUE, 
> dimnames=list(NULL, c("lon", "lat")));
> crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47), ncol=2, byrow=TRUE, 
> dimnames=list(NULL, c("lon", "lat")));
> spLines <- SpatialLines(list(Lines(list(Line(crds1), Line(crds2), 
> Line(crds3)), ID="a")));
> spLines at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
> bbox(spLines);
> spLines_tr <- spTransform(spLines, CRS("+proj=ob_tran +o_proj=longlat 
> +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE);
> bbox(spLines_tr)
> bbox(spLines_tr)*180/pi
>
> crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51, 7, 51), ncol=2, 
> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
> crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48, 8, 48), ncol=2, 
> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
> crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47, 6, 47), ncol=2, 
> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
> spPolygons <- SpatialPolygons(list(Polygons(list(Polygon(crds1), 
> Polygon(crds2), Polygon(crds3)), ID="a")));
> spPolygons at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
> bbox(spPolygons);
> spPolygons_tr <- spTransform(spPolygons, CRS("+proj=ob_tran +o_proj=longlat 
> +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"), 
> use_ob_tran=TRUE);
> bbox(spPolygons_tr)
> bbox(spPolygons_tr)*180/pi
>
>
> The correct bounding boxes are the second ones. Hence the coordinates have 
> also got to be multiplied by 180/pi.

Please check R-forge revision 360 - the argument reversal was done 
correctly for points (so for pixels and grids), but the wrong way round 
for the other two cases. Test now in help page example.

Thanks for your patience,

Roger

>
> Best regards,
>
> Martin
>
>
>
>
>
>
> On 08/23/2012 02:37 PM, Roger Bivand wrote:
>> On Thu, 23 Aug 2012, Martin Ivanov wrote:
>> 
>>> Dear Prof. Bivand,
>>> 
>>> I tested spTransform with a SpatialLines object and it still does not 
>>> multiply the coordinates by 180/pi. With SpatialPixels, SpatialPoints and 
>>> SpatialGrids it works perfectly though. If necessary, I will provide a 
>>> minimal working example.
>> 
>> Please do - I may have left something out. I'm travelling now, so an 
>> example would help. What about SpatialPolygons objects?
>> 
>> Roger
>> 
>>> 
>>> Best regards,
>>> 
>>> 
>> 
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From thi_veloso at yahoo.com.br  Thu Aug 23 20:23:36 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 23 Aug 2012 11:23:36 -0700 (PDT)
Subject: [R-sig-Geo] Count frequency of values in a rasterbrick object
Message-ID: <1345746216.29581.YahooMailNeo@web121904.mail.ne1.yahoo.com>

? Dear listers,

? I am trying to count the frequency of the values of a rasterbrick object. The raster is a categorigal map, with values ranging from 1 to 15. I know that raster package provides a 'freq' function, but it won't work directly with rasterBricks. Because of that I am trying to make a function and use it with stackApply. Below is the code I am using and the error produced:

> library (ncdf)

> library (raster)

> co2fix <- brick('~/Dropbox/web/vegtype_fix_co2.nc')

> co2fix
class ? ? ? : RasterBrick?
dimensions ?: 83, 85, 7055, 401 ?(nrow, ncol, ncell, nlayers)
resolution ?: 0.5, 0.5 ?(x, y)
extent ? ? ?: -75, -32.5, -35, 6.5 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84?
values ? ? ?: /home/thiago/Dropbox/web/vegtype_fix_co2.nc?
layer names : X1605.01.01, X1606.01.01, X1607.01.01, X1608.01.01, X1609.01.01, X1610.01.01, X1611.01.01, X1612.01.01, X1613.01.01, X1614.01.01, X1615.01.01, X1616.01.01, X1617.01.01, X1618.01.01, X1619.01.01, ...?
Date ? ? ? ?: 1605-01-01, 2005-01-01 (min, max)
varname ? ? : vegtype0?

> fun <- function(x) {x <- freq(x)}

> ind <- 1:nlayers(co2fix)

> ind
? [1] ? 1 ? 2 ? 3 ? 4 ? 5 ? 6 ? 7 ? 8 ? 9 ?10 ?11 ?12 ?13 ?14 ?15 ?16 ?17 ?18 ?19 ?20 ?21 ?22 ?23 ?24 ?25 ?26 ?27 ?28 ?29 ?30 ?31 ?32 ?33
?[34] ?34 ?35 ?36 ?37 ?38 ?39 ?40 ?41 ?42 ?43 ?44 ?45 ?46 ?47 ?48 ?49 ?50 ?51 ?52 ?53 ?54 ?55 ?56 ?57 ?58 ?59 ?60 ?61 ?62 ?63 ?64 ?65 ?66
?[67] ?67 ?68 ?69 ?70 ?71 ?72 ?73 ?74 ?75 ?76 ?77 ?78 ?79 ?80 ?81 ?82 ?83 ?84 ?85 ?86 ?87 ?88 ?89 ?90 ?91 ?92 ?93 ?94 ?95 ?96 ?97 ?98 ?99
[100] 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132
[133] 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165
[166] 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198
[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231
[232] 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264
[265] 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297
[298] 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330
[331] 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363
[364] 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396
[397] 397 398 399 400 401

> myfreq <- stackApply (co2fix,ind,fun,na.rm=T)

Error in FUN(newX[, i], ...) : unused argument(s) (na.rm = TRUE)

?What I am doing wrong?

?Many thanks,
?Thiago.


From lee.kitty at yahoo.com  Thu Aug 23 20:32:15 2012
From: lee.kitty at yahoo.com (Kitty Lee)
Date: Thu, 23 Aug 2012 11:32:15 -0700 (PDT)
Subject: [R-sig-Geo] Moran I with Edge effect correction
Message-ID: <1345746735.54752.YahooMailNeo@web142301.mail.bf1.yahoo.com>

Hi. I have some study areas that are very irregularly shaped. I wonder if there is a way to adjust for edge effect in computing Moran's I or Geary C?

Any leads would be really appreciated.

K.


From alaba.boluwade at mail.mcgill.ca  Fri Aug 24 04:20:49 2012
From: alaba.boluwade at mail.mcgill.ca (Alaba Boluwade)
Date: Fri, 24 Aug 2012 02:20:49 +0000
Subject: [R-sig-Geo] Stratified Spatial Clustering
Message-ID: <B879AF6D5CB2A040A61A6DB25A700B0510769AF5@EXMBX2010-3.campus.MCGILL.CA>

Hi Listers,

I will appreciate if anyone knows any package  in R or software that  I can apply for the following task:

I have a  soil raster map made up of unique 5 soil series in form of "polygons". I did a stratified  random sampling (proportionate to the soil polygon sizes) with a total of 210 samples. I measured basic soil physical and chemical properties such as bulk density, % clay, Ca, P, K, porosity etc.


Now, I want to do a spatial  clustering   of the multivariate properties at each of the  unique soil series. With this, I can have the dissagregation or subdivision  of the polygons based on the similarity of the multivariate properties in form of clusters. Therefore, the soil series factors will be the  contraint. 


 I have tried clustTool package. This does not allow specification of the strata. Also, all the different algorithms give different results which is confusing. 

The output can be a shapefile  or raster.  I want to use the result as an input to a distributed model.

Thanks.

Best Regards,

Alaba.

From martin.ivanov at ifg.uni-tuebingen.de  Fri Aug 24 09:26:53 2012
From: martin.ivanov at ifg.uni-tuebingen.de (Martin Ivanov)
Date: Fri, 24 Aug 2012 09:26:53 +0200
Subject: [R-sig-Geo] spTransform: unable to convert coordinates
In-Reply-To: <alpine.LRH.2.02.1208231938060.32135@reclus.nhh.no>
References: <502B88CA.4090008@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208151706180.23037@reclus.nhh.no>
	<alpine.LRH.2.02.1208151735160.23037@reclus.nhh.no>
	<502BC4F2.7010701@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208152056530.23037@reclus.nhh.no>
	<502CB6FB.4060504@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208161203080.25857@reclus.nhh.no>
	<5036192A.4090903@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208231436100.31439@reclus.nhh.no>
	<50362E74.20806@ifg.uni-tuebingen.de>
	<alpine.LRH.2.02.1208231938060.32135@reclus.nhh.no>
Message-ID: <50372CBD.4090203@ifg.uni-tuebingen.de>

Dear Prof. Bivand,

Thank You very much for the support. Now everything works like a charm.
I am happy to have been able to make my small contribution to the 
improvement of the rgdal package.

Best regards,
Martin

On 08/23/2012 07:39 PM, Roger Bivand wrote:
> On Thu, 23 Aug 2012, Martin Ivanov wrote:
>
>> Dear Prof. Bivand,
>>
>> Here is a minimal working example with SpatialLines and 
>> SpatialPolygons. With both objects spTransform does not
>> multiply the transformed coordinates by 180/pi:
>>
>> crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> spLines <- SpatialLines(list(Lines(list(Line(crds1), Line(crds2), 
>> Line(crds3)), ID="a")));
>> spLines at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
>> bbox(spLines);
>> spLines_tr <- spTransform(spLines, CRS("+proj=ob_tran +o_proj=longlat 
>> +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"), 
>> use_ob_tran=TRUE);
>> bbox(spLines_tr)
>> bbox(spLines_tr)*180/pi
>>
>> crds1 <- matrix(data=c(7, 51, 8, 52, 9, 52, 10, 51, 7, 51), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> crds2 <- matrix(data=c(8, 48, 9, 49, 11, 49, 9, 48, 8, 48), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> crds3 <- matrix(data=c(6, 47, 6, 55, 15, 55, 15, 47, 6, 47), ncol=2, 
>> byrow=TRUE, dimnames=list(NULL, c("lon", "lat")));
>> spPolygons <- SpatialPolygons(list(Polygons(list(Polygon(crds1), 
>> Polygon(crds2), Polygon(crds3)), ID="a")));
>> spPolygons at proj4string <- CRS("+proj=longlat +ellps=sphere +no_defs");
>> bbox(spPolygons);
>> spPolygons_tr <- spTransform(spPolygons, CRS("+proj=ob_tran 
>> +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere 
>> +no_defs"), use_ob_tran=TRUE);
>> bbox(spPolygons_tr)
>> bbox(spPolygons_tr)*180/pi
>>
>>
>> The correct bounding boxes are the second ones. Hence the coordinates 
>> have also got to be multiplied by 180/pi.
>
> Please check R-forge revision 360 - the argument reversal was done 
> correctly for points (so for pixels and grids), but the wrong way 
> round for the other two cases. Test now in help page example.
>
> Thanks for your patience,
>
> Roger
>
>>
>> Best regards,
>>
>> Martin
>>
>>
>>
>>
>>
>>
>> On 08/23/2012 02:37 PM, Roger Bivand wrote:
>>> On Thu, 23 Aug 2012, Martin Ivanov wrote:
>>>
>>>> Dear Prof. Bivand,
>>>>
>>>> I tested spTransform with a SpatialLines object and it still does 
>>>> not multiply the coordinates by 180/pi. With SpatialPixels, 
>>>> SpatialPoints and SpatialGrids it works perfectly though. If 
>>>> necessary, I will provide a minimal working example.
>>>
>>> Please do - I may have left something out. I'm travelling now, so an 
>>> example would help. What about SpatialPolygons objects?
>>>
>>> Roger
>>>
>>>>
>>>> Best regards,
>>>>
>>>>
>>>
>>
>>
>>
>


-- 
Dr. Martin Ivanov
Eberhard-Karls-Universit?t T?bingen
Mathematisch-Naturwissenschaftliche Fakult?t
Fachbereich Geowissenschaften
Water & Earth System Science (WESS)
H?lderlinstra?e 12, 72074 T?bingen, Deutschland
Tel. +4970712974213


From swagathnavin at gmail.com  Fri Aug 24 14:14:35 2012
From: swagathnavin at gmail.com (swagath navin)
Date: Fri, 24 Aug 2012 14:14:35 +0200
Subject: [R-sig-Geo] create data frame after spDists
Message-ID: <CALStsaa+XFzMHZW0xy8b5zjwX7UVwhw8Q-suXV5d66G4D3v1EQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/592490d0/attachment.pl>

From swagathnavin at gmail.com  Fri Aug 24 14:24:49 2012
From: swagathnavin at gmail.com (swagath navin)
Date: Fri, 24 Aug 2012 14:24:49 +0200
Subject: [R-sig-Geo] create data frame after spDists (re-posted)
Message-ID: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>

Hello all, sorry for re-posting, but i got a scrub message for my first mail.

I have two spatial points data frame df1 showing sample locations and df2
meteorological stations. I am interested in finding met stations closer to
the sample stations and creating a separate data frame with sample
locations and the nearest met station.

I calculated the distances between the stations:

library(sp)

df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))

coordinates(df1)=~ x + y
coordinates(df2)=~ x + y

dist=spDists(df1, df2, longlat = FALSE)

but  how can i create a data frame with sample locations and nearest met
station as shown below:

Sample location | Nearest Met station

(5.1, 51)             | (5.1,51)

for small number of stations i can do manually, but i have around 400
sample locations and 100 met stations.

Thanks a lot for your time.

Cheers,
Navin


From lyndon.estes at gmail.com  Fri Aug 24 21:47:23 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Fri, 24 Aug 2012 15:47:23 -0400
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
Message-ID: <CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/e511b52d/attachment.pl>

From fpb01 at health.state.ny.us  Fri Aug 24 22:11:14 2012
From: fpb01 at health.state.ny.us (Francis P. Boscoe)
Date: Fri, 24 Aug 2012 16:11:14 -0400
Subject: [R-sig-Geo] shortest path
Message-ID: <OF17B6F691.9080D441-ON85257A64.006E7B2D-85257A64.006F4524@notes.health.state.ny.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/565248c3/attachment.pl>

From r.turner at auckland.ac.nz  Fri Aug 24 22:42:21 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 25 Aug 2012 08:42:21 +1200
Subject: [R-sig-Geo] create data frame after spDists (re-posted)
In-Reply-To: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>
References: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>
Message-ID: <5037E72D.9090305@auckland.ac.nz>


I believe that you would find the tools in the "spatstat" package
(e.g. crossdist()) useful.

     cheers,

         Rolf Turner

On 25/08/12 00:24, swagath navin wrote:
> Hello all, sorry for re-posting, but i got a scrub message for my first mail.
>
> I have two spatial points data frame df1 showing sample locations and df2
> meteorological stations. I am interested in finding met stations closer to
> the sample stations and creating a separate data frame with sample
> locations and the nearest met station.
>
> I calculated the distances between the stations:
>
> library(sp)
>
> df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
> df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))
>
> coordinates(df1)=~ x + y
> coordinates(df2)=~ x + y
>
> dist=spDists(df1, df2, longlat = FALSE)
>
> but  how can i create a data frame with sample locations and nearest met
> station as shown below:
>
> Sample location | Nearest Met station
>
> (5.1, 51)             | (5.1,51)
>
> for small number of stations i can do manually, but i have around 400
> sample locations and 100 met stations.
>
> Thanks a lot for your time.


From r.hijmans at gmail.com  Fri Aug 24 23:03:32 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 24 Aug 2012 14:03:32 -0700
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
	<CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
Message-ID: <CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/cdddfd92/attachment.pl>

From lyndon.estes at gmail.com  Fri Aug 24 23:08:35 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Fri, 24 Aug 2012 17:08:35 -0400
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
	<CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
	<CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>
Message-ID: <CALuVVaZwZB+NEczHzm8sZKbbFTh3er1GOPT0U=moThfsngOukw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/6bdfba0c/attachment.pl>

From r.hijmans at gmail.com  Fri Aug 24 23:09:13 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 24 Aug 2012 14:09:13 -0700
Subject: [R-sig-Geo] Count frequency of values in a rasterbrick object
In-Reply-To: <1345746216.29581.YahooMailNeo@web121904.mail.ne1.yahoo.com>
References: <1345746216.29581.YahooMailNeo@web121904.mail.ne1.yahoo.com>
Message-ID: <CANtt_hzdP13Ck661pgQASFcgLjSgHDQuHPg7RG=AdUZhzFTf2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/08b02fc2/attachment.pl>

From r.hijmans at gmail.com  Fri Aug 24 23:16:15 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 24 Aug 2012 14:16:15 -0700
Subject: [R-sig-Geo] create data frame after spDists (re-posted)
In-Reply-To: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>
References: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>
Message-ID: <CANtt_hzLuWcSM00+AmZ4ynZj+0hZ+Vm9Kzds=M+zqSV4xt4s4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120824/76d07505/attachment.pl>

From Roger.Bivand at nhh.no  Sat Aug 25 08:39:04 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 25 Aug 2012 08:39:04 +0200 (CEST)
Subject: [R-sig-Geo] Moran I with Edge effect correction
In-Reply-To: <1345746735.54752.YahooMailNeo@web142301.mail.bf1.yahoo.com>
References: <1345746735.54752.YahooMailNeo@web142301.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.02.1208250835460.6849@reclus.nhh.no>

On Thu, 23 Aug 2012, Kitty Lee wrote:

> Hi. I have some study areas that are very irregularly shaped. I wonder 
> if there is a way to adjust for edge effect in computing Moran's I or 
> Geary C?

The typical approach would be through the weights matrix, depending on how 
W is constructed. If you row-standardise, edge observations will be 
stressed, but with binary weights they are less salient. You could also 
intervene directly to reduce weights on observations selected as members 
of an edge set, through the glist= argument in nb2listw().

Hope this helps,

Roger

>
> Any leads would be really appreciated.
>
> K.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From simon.ohanlon at imperial.ac.uk  Sat Aug 25 10:02:11 2012
From: simon.ohanlon at imperial.ac.uk (O'Hanlon, Simon J)
Date: Sat, 25 Aug 2012 08:02:11 +0000
Subject: [R-sig-Geo] create data frame after spDists (re-posted)
In-Reply-To: <5037E72D.9090305@auckland.ac.nz>
References: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>,
	<5037E72D.9090305@auckland.ac.nz>
Message-ID: <7AE0828DCFFC0144817331B53EDC11A025D5B98E@icexch-m5.ic.ac.uk>

Hi Navin,
As Rolf said spatstat does what you need, but I think for your application nncross() would be most suitable: 

>I am interested in finding met stations closer to the sample stations and creating a separate data frame with sample >locations and the nearest met station


df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))

sample <- ppp( df1$x , y = df1$y , xrange = range(df1$x) , yrange = range( df1$y) )

met <- ppp( df2$x , y = df2$y , xrange = range(df2$x) , yrange = range( df2$y ) )

nncross( sample , met )

          dist which
1 0.000000e+00     2
2 8.881784e-16     3
3 0.000000e+00     4
4 1.004988e+00     4
5 2.009975e+00     4


HTH,

Simon
________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Rolf Turner [r.turner at auckland.ac.nz]
Sent: 24 August 2012 21:42
To: swagath navin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] create data frame after spDists (re-posted)

I believe that you would find the tools in the "spatstat" package
(e.g. crossdist()) useful.

     cheers,

         Rolf Turner

On 25/08/12 00:24, swagath navin wrote:
> Hello all, sorry for re-posting, but i got a scrub message for my first mail.
>
> I have two spatial points data frame df1 showing sample locations and df2
> meteorological stations. I am interested in finding met stations closer to
> the sample stations and creating a separate data frame with sample
> locations and the nearest met station.
>
> I calculated the distances between the stations:
>
> library(sp)
>
> df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
> df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))
>
> coordinates(df1)=~ x + y
> coordinates(df2)=~ x + y
>
> dist=spDists(df1, df2, longlat = FALSE)
>
> but  how can i create a data frame with sample locations and nearest met
> station as shown below:
>
> Sample location | Nearest Met station
>
> (5.1, 51)             | (5.1,51)
>
> for small number of stations i can do manually, but i have around 400
> sample locations and 100 met stations.
>
> Thanks a lot for your time.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Sat Aug 25 10:23:27 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 25 Aug 2012 09:23:27 +0100
Subject: [R-sig-Geo] shortest path
In-Reply-To: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
Message-ID: <CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>

On Fri, Aug 24, 2012 at 9:11 PM, Francis P. Boscoe
<fpb01 at health.state.ny.us> wrote:
>
> Hi,
>
> I've been poking around  igraph and spatgraphs but have not been able to
> find a sufficiently simple example to make sense of.
>
> Suppose I have three points A, B, and C.
>
> The path from A to B is 3 units, from B to C is 4 units, and from A to C is
> 8 units.
>
> Could someone provide a simple coding example showing that A-B-C represents
> the shortest path?


using igraph, it couldn't be much simpler:

#1 make a graph, giving a two-column matrix of FROM and TO node names:
 > ABC = graph.edgelist(cbind(c("A","B","A"),c("B","C","C")))

#2 attach distances as weights:
 > E(ABC)$weight = c(3,4,8)

#3 see what we got:
 > ABC
Vertices: 3
Edges: 3
Directed: TRUE
Edges:

[0] 'A' -> 'B'
[1] 'B' -> 'C'
[2] 'A' -> 'C'

 Note this is a Directed graph. There's no way back from B to A!

#4 shortest path from A to C:

> get.shortest.paths(ABC,from="A",to="C")
[[1]]
[1] 0 1 2

And since there might be more than one shortest path, the return is a
list. Here it has one element, and the numbers are the indices of the
nodes.  Starting from zero[1]. This is computer science, after all. To
get the nodes, index the V (vertices) function:

 > V(ABC)[get.shortest.paths(ABC,from="A",to="C")[[1]]]
Vertex sequence:
[1] "A" "B" "C"

#5 just to check, lets set the distances to all 1 and see if the
algorithm figures out the direct route is quicker:

 > E(ABC)$weight = c(1,1,1)
 > V(ABC)[get.shortest.paths(ABC,from="A",to="C")[[1]]]
Vertex sequence:
[1] "A" "C"

 Happy graphing!

Barry

[1] I think the zero indexing might be changing soon, or has
changed... Recent igraphs might be different, but indexing the V
function should still work.


From karl at huftis.org  Sat Aug 25 13:10:37 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Sat, 25 Aug 2012 13:10:37 +0200
Subject: [R-sig-Geo] shortest path
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
	<CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>
Message-ID: <1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>

Barry Rowlingson skreiv:

> [1] I think the zero indexing might be changing soon, or has
> changed... Recent igraphs might be different,

Indeed. From the release notes of igraph 0.6:

,----[ http://igraph.sourceforge.net/relnotes-0.6.html ]
| The biggest change in the R interface is that starting from this version
| vertices and edges are numbered from one. This change might be painful
| for many people, because it makes already existing code incompatible with
| igraph 0.6. To make the switch easier, there is now an igraph0 package
| on CRAN; igraph0 uses 0-based vertex and edge ids, and it can be used
| to run old code. Note, however, that igraph0 will not be developed in
| the future. Please use the igraph package for current and future work.
|
| (Also note that in Python and C vertices and edges are still numbered
| from zero, as these languages traditionally use zero-based indexing.)
`----

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From gallemore.1 at osu.edu  Sun Aug 26 17:07:44 2012
From: gallemore.1 at osu.edu (Caleb Gallemore)
Date: Sun, 26 Aug 2012 11:07:44 -0400
Subject: [R-sig-Geo] Clarification on spatial weights for spatial panel
	models in package "splm"
Message-ID: <CACpZSb2kEGQLTSi6QA9kgDJcpk9jyrRB=jaKvrGam=0RJxsZAQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120826/13e5a6fa/attachment.pl>

From laurence.delattre2 at gmail.com  Mon Aug 27 10:40:09 2012
From: laurence.delattre2 at gmail.com (laurence delattre)
Date: Mon, 27 Aug 2012 10:40:09 +0200
Subject: [R-sig-Geo] Moran I with Edge effect correction
In-Reply-To: <alpine.LRH.2.02.1208250835460.6849@reclus.nhh.no>
References: <1345746735.54752.YahooMailNeo@web142301.mail.bf1.yahoo.com>
	<alpine.LRH.2.02.1208250835460.6849@reclus.nhh.no>
Message-ID: <CAN-F-q1HOiVVO-gTnqoAdERn20NCd85bfohg7sdRAVScAWN4eQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120827/83dcf431/attachment.pl>

From swagathnavin at gmail.com  Mon Aug 27 12:30:16 2012
From: swagathnavin at gmail.com (Swagath Navin)
Date: Mon, 27 Aug 2012 12:30:16 +0200
Subject: [R-sig-Geo] create data frame after spDists (re-posted)
In-Reply-To: <7AE0828DCFFC0144817331B53EDC11A025D5B98E@icexch-m5.ic.ac.uk>
References: <CALStsaYaxWeaUo4tjwfP+EKbWuRQ9M1rwnUhvM9hxMqsURDdYQ@mail.gmail.com>,
	<5037E72D.9090305@auckland.ac.nz>
	<7AE0828DCFFC0144817331B53EDC11A025D5B98E@icexch-m5.ic.ac.uk>
Message-ID: <503B4C38.3060808@gmail.com>

Hello all,

Thank you very much for your reply.


Cheers,
Navin

On 8/25/12 10:02 AM, O'Hanlon, Simon J wrote:
> Hi Navin,
> As Rolf said spatstat does what you need, but I think for your application nncross() would be most suitable:
>
>> I am interested in finding met stations closer to the sample stations and creating a separate data frame with sample>locations and the nearest met station
>
> df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
> df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))
>
> sample<- ppp( df1$x , y = df1$y , xrange = range(df1$x) , yrange = range( df1$y) )
>
> met<- ppp( df2$x , y = df2$y , xrange = range(df2$x) , yrange = range( df2$y ) )
>
> nncross( sample , met )
>
>            dist which
> 1 0.000000e+00     2
> 2 8.881784e-16     3
> 3 0.000000e+00     4
> 4 1.004988e+00     4
> 5 2.009975e+00     4
>
>
> HTH,
>
> Simon
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Rolf Turner [r.turner at auckland.ac.nz]
> Sent: 24 August 2012 21:42
> To: swagath navin
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] create data frame after spDists (re-posted)
>
> I believe that you would find the tools in the "spatstat" package
> (e.g. crossdist()) useful.
>
>       cheers,
>
>           Rolf Turner
>
> On 25/08/12 00:24, swagath navin wrote:
>> Hello all, sorry for re-posting, but i got a scrub message for my first mail.
>>
>> I have two spatial points data frame df1 showing sample locations and df2
>> meteorological stations. I am interested in finding met stations closer to
>> the sample stations and creating a separate data frame with sample
>> locations and the nearest met station.
>>
>> I calculated the distances between the stations:
>>
>> library(sp)
>>
>> df1<-data.frame(x=seq(5.1,5.5, 0.1), y=seq(51,55,1))
>> df2<-data.frame(x=seq(5,5.3, 0.1), y=seq(50,53,1))
>>
>> coordinates(df1)=~ x + y
>> coordinates(df2)=~ x + y
>>
>> dist=spDists(df1, df2, longlat = FALSE)
>>
>> but  how can i create a data frame with sample locations and nearest met
>> station as shown below:
>>
>> Sample location | Nearest Met station
>>
>> (5.1, 51)             | (5.1,51)
>>
>> for small number of stations i can do manually, but i have around 400
>> sample locations and 100 met stations.
>>
>> Thanks a lot for your time.
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tyler.j.frazier at tu-berlin.de  Mon Aug 27 12:56:47 2012
From: tyler.j.frazier at tu-berlin.de (Frazier, Tyler James)
Date: Mon, 27 Aug 2012 10:56:47 +0000
Subject: [R-sig-Geo] writeOGR
Message-ID: <9659839B4C1FD4498B496BCEFF047B6F74A83B78@EX-MB1.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120827/72650813/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Aug 27 13:28:07 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 27 Aug 2012 12:28:07 +0100
Subject: [R-sig-Geo] writeOGR
In-Reply-To: <2293eecb16ac4ba4983dc0e490aa65b7@EX-1-HT0.lancs.local>
References: <2293eecb16ac4ba4983dc0e490aa65b7@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPHS7QE0uCAjREn0fcWOxV9robmuPpgh6ezG-zoeAUL5Q@mail.gmail.com>

On Mon, Aug 27, 2012 at 11:56 AM, Frazier, Tyler James
<tyler.j.frazier at tu-berlin.de> wrote:
> Is it possible to set writeOGR so it overwrites existing files, or at least prompts?
>
> i.e.
>
> writeOGR(towns,".","towns",driver="ESRI Shapefile")

?writeOGR

overwrite_layer: default FALSE, if TRUE and ?check_exists=TRUE?, delete
          the existing layer of the same name from the data source
          before writing the new layer; this will delete data and must
          be used with extreme caution, its behaviour varies between
          drivers, and accommodates changes that may appear in GDAL 1.8

?

Barry


From alobolistas at gmail.com  Mon Aug 27 14:02:49 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 27 Aug 2012 14:02:49 +0200
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CANtt_hzSJAC3KM+yvzyCun0kub18oG0vu-V2vi-sS=EteewOaw@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
	<alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
	<CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>
	<alpine.LRH.2.02.1208151029180.20318@reclus.nhh.no>
	<CANtt_hzSJAC3KM+yvzyCun0kub18oG0vu-V2vi-sS=EteewOaw@mail.gmail.com>
Message-ID: <CAG4NReJgj19_codY-2c79x4JaFYs2t3-tz0QxhB6tne_+iO9yg@mail.gmail.com>

Robert,

On Mon, Aug 20, 2012 at 7:21 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Agus,
>
> As Roger suspected, this is a design choice; although possible, it is a
> costly to compute the mean and sd when writing in chunks (the sd in
> particular, as you need to have the mean to compute the sd) and most file
> formats cannot store this anyway, and I was not aware of any application
> using this.

I understand "this is a design choice", but I think it is a wrong one.
Having mean and sd
equal to 0 (or NaN) is not the same as having unknown mean and sd. The
point is that
gdal (not only QGIS) calculate the stats if this information is not
provided. If this info is set to 0,
gdal and QGIS cannot know that it has to be recalculated.

> I have changed raster's behavior (on R-Forge now) such that sd (denominator
> is n-1) and mean are set to their correct values for Raster objects that
> have the cell values in memory before writing the file, and to NaN (at
> least that is what GDALinfo reports), instead of zero, for other cases
> (when writing in chunks from another file). Does that help? That is, is the
> NaN understood by QGIS?
The correct values do help a lot, actually solve my problem.
Have not been able to test for the case with NaN, but I'm pessimistic.
There is no way
of just not writing the info? gdalinfo (and qgis) would automatically
calculate it if missing:
"-stats
Read and display image statistics. Force computation if no statistics
are stored in an image.
"
Thanks,

Agus


From alobolistas at gmail.com  Mon Aug 27 14:29:35 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 27 Aug 2012 14:29:35 +0200
Subject: [R-sig-Geo] wrong stats in GTiff files made with writeRaster()
 (through rgdal?)
In-Reply-To: <CAG4NReJgj19_codY-2c79x4JaFYs2t3-tz0QxhB6tne_+iO9yg@mail.gmail.com>
References: <CAG4NReLtvqur92gSxpQFtORQ8oM+2qfZqzk4Y1qEkFfHN3wybw@mail.gmail.com>
	<CANtt_hz7gb1o+bi+faCyk9gX_o-U2HsM43r44-L_R=Y1hKva+Q@mail.gmail.com>
	<CAG4NReJDBOZYc=m1qEnpiLJw3xzv2qWHaTED0L9iQeG7qwtn7w@mail.gmail.com>
	<alpine.LRH.2.02.1208141310570.17248@reclus.nhh.no>
	<CAG4NReLRMmGHmUr6kBy7C=E8QPzKDLD87j0sbNSn3Lez=pcD=w@mail.gmail.com>
	<alpine.LRH.2.02.1208151029180.20318@reclus.nhh.no>
	<CANtt_hzSJAC3KM+yvzyCun0kub18oG0vu-V2vi-sS=EteewOaw@mail.gmail.com>
	<CAG4NReJgj19_codY-2c79x4JaFYs2t3-tz0QxhB6tne_+iO9yg@mail.gmail.com>
Message-ID: <CAG4NReLXsTPn8-BOCToMoJiZVzWymtTJhCiiceh=TWqPY1wiaA@mail.gmail.com>

Tested with the Nan, gdalinfo -stat does not recalculate as expected.
Also, there is a problem
with summary()

> adls48_31_21
class       : RasterStack
dimensions  : 3251, 1181, 3839431, 3  (nrow, ncol, ncell, nlayers)
resolution  : 29.9746, 29.99077  (x, y)
extent      : 643485, 678885, 7053615, 7151115  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0
names       : antofagastasierrav2.1, antofagastasierrav2.2,
antofagastasierrav2.3
min values  : 0, 0, 0
max values  : 6396, 8295, 8216

> summary(adls48_31_21)
Error: object 'sumobj' not found

> writeRaster(adls48_31_21,filename="adls48_31_21",format="GTiff",dataType="INT2U",NAflag=0,overwrite=T)
class       : RasterBrick
dimensions  : 3251, 1181, 3839431, 3  (nrow, ncol, ncell, nlayers)
resolution  : 29.9746, 29.99077  (x, y)
extent      : 643485, 678885, 7053615, 7151115  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0
data source : /media/Iomega_HDD/VOLCAN/HYPERION/RHyperion/adls48_31_21.tif
names       : adls48_31_21.1, adls48_31_21.2, adls48_31_21.3
min values  : 148, 646, 1110
max values  : 24392, 12864, 13619

> GDALinfo("adls48_31_21.tif")
rows        3251
columns     1181
bands       3
origin.x        643485
origin.y        7053615
res.x       29.9746
res.y       29.99077
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs
file        adls48_31_21.tif
apparent band summary:
   GDType Bmin  Bmax Bmean Bsd hasNoDataValue NoDataValue
1 Float32  148 24392   NaN NaN           TRUE           0
2 Float32  646 12864   NaN NaN           TRUE           0
3 Float32 1110 13619   NaN NaN           TRUE           0
Metadata:
AREA_OR_POINT=Area

alobo at delia:/media/Iomega_HDD/VOLCAN/HYPERION/RHyperion$ gdalinfo
-stats adls48_31_21.tif
Driver: GTiff/GeoTIFF
Files: adls48_31_21.tif
Size is 1181, 3251
Coordinate System is:
PROJCS["WGS 84 / UTM zone 19S",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-69],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32719"]]
Origin = (643485.012701101019047,7151114.995386035181582)
Pixel Size = (29.974597798475870,-29.990772070132266)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  643485.013, 7151114.995) ( 67d34' 9.69"W, 25d45' 3.52"S)
Lower Left  (  643485.013, 7053614.995) ( 67d33'30.84"W, 26d37'51.92"S)
Upper Right (  678885.013, 7151114.995) ( 67d12'59.47"W, 25d44'49.50"S)
Lower Right (  678885.013, 7053614.995) ( 67d12'11.04"W, 26d37'37.34"S)
Center      (  661185.013, 7102364.995) ( 67d23'12.98"W, 26d11'21.01"S)
Band 1 Block=1181x1 Type=Float32, ColorInterp=Gray
  Min=148.000 Max=24392.000
  Minimum=148.000, Maximum=24392.000, Mean=nan, StdDev=nan
  NoData Value=0
  Metadata:
    STATISTICS_MAXIMUM=24392
    STATISTICS_MEAN=nan
    STATISTICS_MINIMUM=148
    STATISTICS_STDDEV=nan
Band 2 Block=1181x1 Type=Float32, ColorInterp=Undefined
  Min=646.000 Max=12864.000
  Minimum=646.000, Maximum=12864.000, Mean=nan, StdDev=nan
  NoData Value=0
  Metadata:
    STATISTICS_MAXIMUM=12864
    STATISTICS_MEAN=nan
    STATISTICS_MINIMUM=646
    STATISTICS_STDDEV=nan
Band 3 Block=1181x1 Type=Float32, ColorInterp=Undefined
  Min=1110.000 Max=13619.000
  Minimum=1110.000, Maximum=13619.000, Mean=nan, StdDev=nan
  NoData Value=0
  Metadata:
    STATISTICS_MAXIMUM=13619
    STATISTICS_MEAN=nan
    STATISTICS_MINIMUM=1110
    STATISTICS_STDDEV=nan

Agus

On Mon, Aug 27, 2012 at 2:02 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Robert,
>
> On Mon, Aug 20, 2012 at 7:21 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>> Agus,
>>
>> As Roger suspected, this is a design choice; although possible, it is a
>> costly to compute the mean and sd when writing in chunks (the sd in
>> particular, as you need to have the mean to compute the sd) and most file
>> formats cannot store this anyway, and I was not aware of any application
>> using this.
>
> I understand "this is a design choice", but I think it is a wrong one.
> Having mean and sd
> equal to 0 (or NaN) is not the same as having unknown mean and sd. The
> point is that
> gdal (not only QGIS) calculate the stats if this information is not
> provided. If this info is set to 0,
> gdal and QGIS cannot know that it has to be recalculated.
>
>> I have changed raster's behavior (on R-Forge now) such that sd (denominator
>> is n-1) and mean are set to their correct values for Raster objects that
>> have the cell values in memory before writing the file, and to NaN (at
>> least that is what GDALinfo reports), instead of zero, for other cases
>> (when writing in chunks from another file). Does that help? That is, is the
>> NaN understood by QGIS?
> The correct values do help a lot, actually solve my problem.
> Have not been able to test for the case with NaN, but I'm pessimistic.
> There is no way
> of just not writing the info? gdalinfo (and qgis) would automatically
> calculate it if missing:
> "-stats
> Read and display image statistics. Force computation if no statistics
> are stored in an image.
> "
> Thanks,
>
> Agus


From thi_veloso at yahoo.com.br  Tue Aug 28 13:26:33 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 28 Aug 2012 04:26:33 -0700 (PDT)
Subject: [R-sig-Geo] Count frequency of values in a rasterbrick object
In-Reply-To: <CANtt_hzdP13Ck661pgQASFcgLjSgHDQuHPg7RG=AdUZhzFTf2Q@mail.gmail.com>
References: <1345746216.29581.YahooMailNeo@web121904.mail.ne1.yahoo.com>
	<CANtt_hzdP13Ck661pgQASFcgLjSgHDQuHPg7RG=AdUZhzFTf2Q@mail.gmail.com>
Message-ID: <1346153193.47775.YahooMailNeo@web121904.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120828/d15b95cb/attachment.pl>

From cpadwick at hotmail.com  Tue Aug 28 14:27:29 2012
From: cpadwick at hotmail.com (cpadwick)
Date: Tue, 28 Aug 2012 05:27:29 -0700 (PDT)
Subject: [R-sig-Geo] problems writing a tiff file with georeferencing
Message-ID: <1346156849072-7580850.post@n2.nabble.com>

Hi, I want to read an existing geotiff file (with georeferencing info),
operate on the raster data, and write out the result to a Float32 file.  I'm
working with hyperion data which is Integer.

This code creates an outputfile, however, the output file t1.tif is Integer. 
I need it to be float.

fname = "./EO1H0420362001131100P1/EO1H0420362001131100P1_B023_L1T.TIF"
x <- GDAL.open(fname, read.only=TRUE)
tmp = getRasterData(x)
xx <- copyDataset(x, driver="GTiff")
putRasterData(xx, tmp+1)
saveDataset(xx, "t1.tif")
GDAL.close(x)
GDAL.close(xx)

This code creates a Float32 file, however, the geo referencing information
is lost:

x <- GDAL.open(fname, read.only=TRUE)
tmp = getRasterData(x)
xx <- new("GDALTransientDataset", driver=new("GDALDriver", "GTiff"), 
  rows=ncol(tmp), cols=nrow(tmp), bands=1, type="Float32")
putRasterData(xx, tmp+1)
saveDataset(xx, "t2.tif")
GDAL.close(x)
GDAL.close(xx)

This code fails with the following error:

Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "gridded", for signature
"GDALTransientDataset"

x <- GDAL.open(fname, read.only=TRUE)
tmp = getRasterData(x)
xx <- copyDataset(x, driver="GTiff")
putRasterData(xx, tmp+1)
writeGDAL(xx, "t3.tif")
GDAL.close(x)
GDAL.close(xx)

Any help will be greatly appreciated.






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problems-writing-a-tiff-file-with-georeferencing-tp7580850.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue Aug 28 17:46:55 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 28 Aug 2012 08:46:55 -0700
Subject: [R-sig-Geo] problems writing a tiff file with georeferencing
In-Reply-To: <1346156849072-7580850.post@n2.nabble.com>
References: <1346156849072-7580850.post@n2.nabble.com>
Message-ID: <CANtt_hzUZjgZqvQ8KDvz+g1X4+3X_ap_=tS9Yrcm7dObqb76Bg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120828/a253ae11/attachment.pl>

From sglish at hotmail.com  Tue Aug 28 21:32:40 2012
From: sglish at hotmail.com (Chris English)
Date: Tue, 28 Aug 2012 15:32:40 -0400
Subject: [R-sig-Geo] Geographical CRS given to non-conformant data:
Message-ID: <SNT117-W41ABDF9A9A8F9063E8DDDDC5A10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120828/d6466663/attachment.pl>

From lyndon.estes at gmail.com  Tue Aug 28 22:06:01 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Tue, 28 Aug 2012 16:06:01 -0400
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CALuVVaZwZB+NEczHzm8sZKbbFTh3er1GOPT0U=moThfsngOukw@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
	<CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
	<CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>
	<CALuVVaZwZB+NEczHzm8sZKbbFTh3er1GOPT0U=moThfsngOukw@mail.gmail.com>
Message-ID: <CALuVVaYnPrRBH5LBVQc4F2WKvPJ5_mX7LDeiBCMEBV1wZ47s=A@mail.gmail.com>

Hi Robert,

Just wanted to report back on the solution you gave me, which worked
perfectly as you wrote it.

>> library(raster)
>>
>> library(rgdal)
>>
>> r <- raster(ncol=10, nrow=10)  # EP MODIS pixels
>> eplc <- raster()
>> set.seed(0)
>> eplc[] <- round(  runif(ncell(eplc)) + 3)
>> eplc[10000:11000] <- NA
>>
>> bs <- blockSize(r, minblocks = 200)  # Calculate size of rows to work on
>>
>> # Output datasets
>> rcl3 <- writeStart(r, "lc_class3.tif", overwrite = TRUE)
>> rcl4 <- writeStart(r, "lc_class4.tif", overwrite = TRUE)
>> rtot <- writeStart(r, "lc_aall.tif", overwrite = TRUE)
>>
>> # Start processing loop
>> for(i in 1:bs$n) {
>>    print(paste("Iteration", i))
>>    # extent of this (modis) block
>>    e <- extent(xmin(r), xmax(r), yFromRow(r, bs$row[i]+bs$nrows[i]-1) - 0.5 * yres(r), yFromRow(r, bs$row[i])+0.5 * yres(r))
>>
>>    vo1 <- vo2 <- vo3 <- rep(NA, bs$nrows[i] * ncol(r))
>>
>>    int <- intersect(e, extent(eplc))
>>    if (!is.null(int)) {
>>    b <- crop(eplc, int)
>>    xy <- xyFromCell(b, 1:ncell(b))
>>    mc <- cellFromXY(r, xy)
>>
>>            # here I use table, there could be other ways (e.g. tapply) to achieve the below
>> v <- table(mc, getValues(b))
>>    cells <- as.integer(rownames(v))
>> modcells <- cellFromRowCol(r, bs$row[i], 1) : cellFromRowCol(r, bs$row[i]+bs$nrows[i]-1, ncol(r))
>> m <- match(cells, modcells)
>>
>> cn <- as.integer(colnames(v))
>> if (3 %in% cn) {
>> vo1[m] <- v[, '3']
>> }
>> if (4 %in% cn) {
>> vo2[m] <- v[, '4']
>> }
>> vo3[m] <- apply(v, 1, sum)
>> rcl3 <- writeValues(rcl3, vo1, bs$row[i])  # Write out sum class 3
>> rcl4 <- writeValues(rcl4, vo2, bs$row[i])  # Write out sum class 4
>> rtot <- writeValues(rtot, vo3, bs$row[i])  # Write sum total pixels
>>   }
>> }
>>
>> rcl3 <- writeStop(rcl3)
>> rcl4 <- writeStop(rcl4)
>> rtot <- writeStop(rtot)
>>

I tweaked it to run with my actual grids, and it took only 6 minutes
to run, producing 4 outputs each with the following characteristics:

class       : RasterLayer
dimensions  : 1593, 1901, 3028293  (nrow, ncol, ncell)
resolution  : 231.6564, 231.6564  (x, y)
extent      : 3230680, 3671058, -1712867, -1343839  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs
values      :
layer name  : eplc_ag
min value   : 0
max value   : 64

Needless to say, that is an enormous improvement on the 3 day run I
had using the extract approach.

Thanks again for the advice and for the raster package.

Cheers, Lyndon


From biomario at gmail.com  Wed Aug 29 01:38:09 2012
From: biomario at gmail.com (Mario A. Pardo)
Date: Tue, 28 Aug 2012 16:38:09 -0700
Subject: [R-sig-Geo] Coordinate interpolation keeping NAs
Message-ID: <503D5661.7090308@gmail.com>

Greetings,

I'm sorry if this question is too basic, but I just recently moved to R.

Let's say I have:

lon <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68, 
-115.66)
lat <- c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13,   
29.09)

and I need a new set of coordinates c(new.lon, new.lat) with a higher 
resolution, following some interpolation criterium, but keeping the NAs 
where they should be, according to the original data.

Is there any function similar to 'approx' that does this? I tried with 
that one but I wasn't able to avoid the interpolation over the NAs. 
Also, I would like to establish that the interpolation follows a fixed 
distance, such as a coordinate point each xx kilometers or degrees.

Thanks a lot in advance!

-- 
mario


From tom.gottfried at o2mail.de  Wed Aug 29 06:55:22 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Wed, 29 Aug 2012 06:55:22 +0200
Subject: [R-sig-Geo] Coordinate interpolation keeping NAs
In-Reply-To: <503D5661.7090308@gmail.com>
References: <503D5661.7090308@gmail.com>
Message-ID: <503DA0BA.2060008@o2mail.de>

Mario,

Am 29.08.2012 01:38, schrieb Mario A. Pardo:
> Greetings,
>
> I'm sorry if this question is too basic, but I just recently moved to R.
>
> Let's say I have:
>
> lon <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68,
> -115.66)
> lat <- c( 29.76, 29.61, NA, 29.55, 29.53, 29.41, NA, 29.13, 29.09)
>
> and I need a new set of coordinates c(new.lon, new.lat) with a higher
> resolution, following some interpolation criterium, but keeping the NAs
> where they should be, according to the original data.

Think of NA as 'not available'. Thus, a coordinate vector (NA, NA) is 
that of an unknown location. The question "where it should be" does not 
seem to have a definite answer, as far as I can see.

> Is there any function similar to 'approx' that does this? I tried with
> that one but I wasn't able to avoid the interpolation over the NAs.
> Also, I would like to establish that the interpolation follows a fixed
> distance, such as a coordinate point each xx kilometers or degrees.

e.g.

approx(lon, lat, xout=seq(from=min(lon, na.rm=TRUE),
	to=max(lon, na.rm=TRUE), by=0.01))

You might also be interested in what expand.grid does.

HTH,
Tom

> Thanks a lot in advance!
>

-- 
Indo-German Centre for Sustainability
Indian Institute of Technology Madras
600 036 Chennai, India
www.igcs-chennai.org


From biomario at gmail.com  Wed Aug 29 18:04:05 2012
From: biomario at gmail.com (Mario A. Pardo)
Date: Wed, 29 Aug 2012 09:04:05 -0700
Subject: [R-sig-Geo] Again, coordinate interpolation with NAs
Message-ID: <503E3D75.9010807@gmail.com>

Hi all,

I'm changing the way of my question, since it was missunderstood before.

Given:

lon <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68, 
-115.66)
lat <- c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13,   
29.09)

I need a new set of coordinates interpolated at a given resolution, 
let's say one data point each xx kilometers or degrees, or at a given 
proportion of the total length, etc.

BUT,

Think of this coordinates as transect points, and I need to keep the 
NAs, since they mark cut offs in my transect. The only think that I need 
is to increase the number of data points in each transect. That means 
that the new.lon would be constitued by values interpolated between the 
first two points (-115.86 and -115.83); after them, a NA should be 
placed, marking a cut off in the transect, then the interpolated data of 
the next three points (-115.78, -115.78 and -115.75), then a NA... and 
so forth. Off course, the new.lat should be the same length as new.lon 
with NAs placed at the same places. As far as I have tried, neither the 
function "approx" or "expand.grid" can do that. I know this is not a 
Matllab list, but since I recently moved from Matlab to R, I just want 
to point out that the function "interpm" does exactly that, just in case 
somebody here knows it.

Thanks! and sorry for the insistence.

-- 
mario


From karl at huftis.org  Wed Aug 29 18:15:56 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 29 Aug 2012 18:15:56 +0200
Subject: [R-sig-Geo] Coordinate interpolation keeping NAs
References: <503D5661.7090308@gmail.com>
Message-ID: <74797575.sFe96nXzHv@ID-99504.news.uni-berlin.de>

Mario A. Pardo skreiv:

> lon <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68,
> -115.66)
> lat <- c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13,
> 29.09)
> 
> and I need a new set of coordinates c(new.lon, new.lat) with a higher
> resolution, following some interpolation criterium, but keeping the NAs
> where they should be, according to the original data.

For interpolation you could try the ?makeLine? function in the ?geosphere? 
package, which also takes into account the curvature of the Earth. But I?m 
not sure I understand what the NA values in your example are supposed to 
represent. If they represent breaks in the lines, I would just split the 
vectors before running ?makeLine?.

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From karl at huftis.org  Wed Aug 29 19:04:26 2012
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 29 Aug 2012 19:04:26 +0200
Subject: [R-sig-Geo] Again, coordinate interpolation with NAs
References: <503E3D75.9010807@gmail.com>
Message-ID: <19237802.WoGjfaeObn@ID-99504.news.uni-berlin.de>

Mario A. Pardo skreiv:

> I need a new set of coordinates interpolated at a given resolution,
> let's say one data point each xx kilometers or degrees, or at a given
> proportion of the total length, etc.
>
> Think of this coordinates as transect points, and I need to keep the
> NAs, since they mark cut offs in my transect.

I would recommend using SpatialLines objects instead, which can 
easily hold polylines and multiple lines. Example:

library(sp)
library(geosphere)

lon=c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68, -115.66)
lat=c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13, 29.09)
d=data.frame(lon,lat)        # Convert to data frame
d$group=cumsum(is.na(d$lon)) # Add line ID
d=d[!is.na(d$lon),]          # Remove NA rows

d.lines=split(d,d$group)    # Split by line ID

# Convert into SpatialLines object
d.sp=SpatialLines(lapply(d.lines, function(df) Lines(Line(df[c("lon","lat")]), ID=df$group[1])),
                  proj4string=CRS("+proj=longlat"))

# Add intermediate points
d.sp.int=makeLine(d.sp, interval=1000)


# The actual coordinates are available in this list
# (though I don?t know why there are duplicates ?
# a small bug in makeLine, perhaps?):
lapply(d.sp.int at lines, function(x) x at Lines[[1]]@coords)

-- 
Karl Ove Hufthammer
E-mail: karl at huftis.org
Jabber: huftis at jabber.no


From edzer.pebesma at uni-muenster.de  Wed Aug 29 19:24:33 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 29 Aug 2012 19:24:33 +0200
Subject: [R-sig-Geo] Again, coordinate interpolation with NAs
In-Reply-To: <19237802.WoGjfaeObn@ID-99504.news.uni-berlin.de>
References: <503E3D75.9010807@gmail.com>
	<19237802.WoGjfaeObn@ID-99504.news.uni-berlin.de>
Message-ID: <503E5051.9010900@uni-muenster.de>



On 08/29/2012 07:04 PM, Karl Ove Hufthammer wrote:
> Mario A. Pardo skreiv:
> 
>> I need a new set of coordinates interpolated at a given resolution,
>> let's say one data point each xx kilometers or degrees, or at a given
>> proportion of the total length, etc.
>>
>> Think of this coordinates as transect points, and I need to keep the
>> NAs, since they mark cut offs in my transect.
> 
> I would recommend using SpatialLines objects instead, which can 
> easily hold polylines and multiple lines. Example:
> 
> library(sp)
> library(geosphere)
> 
> lon=c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68, -115.66)
> lat=c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13, 29.09)
> d=data.frame(lon,lat)        # Convert to data frame
> d$group=cumsum(is.na(d$lon)) # Add line ID
> d=d[!is.na(d$lon),]          # Remove NA rows
> 
> d.lines=split(d,d$group)    # Split by line ID
> 
> # Convert into SpatialLines object
> d.sp=SpatialLines(lapply(d.lines, function(df) Lines(Line(df[c("lon","lat")]), ID=df$group[1])),
>                   proj4string=CRS("+proj=longlat"))
> 
> # Add intermediate points
> d.sp.int=makeLine(d.sp, interval=1000)
> 
> 
> # The actual coordinates are available in this list
> # (though I don?t know why there are duplicates ?
> # a small bug in makeLine, perhaps?):
> lapply(d.sp.int at lines, function(x) x at Lines[[1]]@coords)
> 

I was thinking along the same line. I'm curious, btw, whether matlab's
interpm also interpolates along great circle lines, as makeLine does.

An alternative that interpolates along straight lines, building on your
script, is:

x = spsample(d.sp, type = "regular", n = 100)
plot(x, cex=.2, axes=TRUE)

but I'm not sure whether the first and last points are always included.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Wed Aug 29 19:48:45 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 29 Aug 2012 10:48:45 -0700
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CALuVVaYnPrRBH5LBVQc4F2WKvPJ5_mX7LDeiBCMEBV1wZ47s=A@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
	<CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
	<CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>
	<CALuVVaZwZB+NEczHzm8sZKbbFTh3er1GOPT0U=moThfsngOukw@mail.gmail.com>
	<CALuVVaYnPrRBH5LBVQc4F2WKvPJ5_mX7LDeiBCMEBV1wZ47s=A@mail.gmail.com>
Message-ID: <CANtt_hyF=VL2jRPd4V7Up_g-ZjMLxxgOKhsg-gmp890qGucxMw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120829/7b2cc926/attachment.pl>

From Roger.Bivand at nhh.no  Wed Aug 29 20:04:25 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 29 Aug 2012 20:04:25 +0200 (CEST)
Subject: [R-sig-Geo] Again, coordinate interpolation with NAs
In-Reply-To: <503E3D75.9010807@gmail.com>
References: <503E3D75.9010807@gmail.com>
Message-ID: <alpine.LRH.2.02.1208291938200.16930@reclus.nhh.no>

On Wed, 29 Aug 2012, Mario A. Pardo wrote:

> Hi all,
>
> I'm changing the way of my question, since it was missunderstood before.
>
> Given:
>
> lon <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68, 
> -115.66)
> lat <- c(  29.76,   29.61, NA,   29.55,   29.53,   29.41, NA, 29.13,   29.09)

In addition to the other comments, using NA coordinates is a legacy 
representation to split line objects, and may be converted to a 
SpatialLines object:

library(maptools)
x <- c(-115.86, -115.83, NA, -115.78, -115.78, -115.75, NA, -115.68,
  -115.66)
y <- c(29.76, 29.61, NA, 29.55, 29.53, 29.41, NA, 29.13, 29.09)
map <- list(x=x, y=y)
sp_map <- map2SpatialLines(map)
length(slot(sp_map, "lines"))
plot(sp_map, col=1:length(slot(sp_map, "lines")), axes=TRUE)
library(rgeos)
gLength(sp_map, byid=TRUE)

gives the lengths (assuming planar geometry). How you handle getting 
additional points will depend on whether the coordinates are projected or 
not. If not, you need to use Great Circle distances, and introduce points 
on the azimuth. trackAzimuth() in maptools goes the other way, from a 
matrix of coordinates to a vector of azimuths.

trackAzimuth(cbind(x=x, y=y))

It may be easier for the small distances involved here (km):

sapply(slot(sp_map, "lines"), LinesLength, longlat=TRUE)

to project and create the new points planar, then go back to longlat if 
you need GPS - for this see also export of GPX files in writeOGR() in 
rgdal.

Hope this clarifies,

Roger

>
> I need a new set of coordinates interpolated at a given resolution, let's say 
> one data point each xx kilometers or degrees, or at a given proportion of the 
> total length, etc.
>
> BUT,
>
> Think of this coordinates as transect points, and I need to keep the NAs, 
> since they mark cut offs in my transect. The only think that I need is to 
> increase the number of data points in each transect. That means that the 
> new.lon would be constitued by values interpolated between the first two 
> points (-115.86 and -115.83); after them, a NA should be placed, marking a 
> cut off in the transect, then the interpolated data of the next three points 
> (-115.78, -115.78 and -115.75), then a NA... and so forth. Off course, the 
> new.lat should be the same length as new.lon with NAs placed at the same 
> places. As far as I have tried, neither the function "approx" or 
> "expand.grid" can do that. I know this is not a Matllab list, but since I 
> recently moved from Matlab to R, I just want to point out that the function 
> "interpm" does exactly that, just in case somebody here knows it.
>
> Thanks! and sorry for the insistence.
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Aug 29 21:14:52 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 29 Aug 2012 21:14:52 +0200
Subject: [R-sig-Geo] problems writing a tiff file with georeferencing
In-Reply-To: <1346156849072-7580850.post@n2.nabble.com>
References: <1346156849072-7580850.post@n2.nabble.com>
Message-ID: <CAG4NReK34uM+th7=Q=Q4-tdgyL6ZUYt0Qgcrs1HOcFm0hD8VWA@mail.gmail.com>

As Hyperion images are too large to be processed as common R arrays,
you must use the raster package by R. Hijmans. This package creates an
small special R object
that includes the characteristics of your image but points to the
actual file on disk,
thus no overloading your RAM.
Processing is done through dedicated functions in raster.

Agus


On Tue, Aug 28, 2012 at 2:27 PM, cpadwick <cpadwick at hotmail.com> wrote:
> Hi, I want to read an existing geotiff file (with georeferencing info),
> operate on the raster data, and write out the result to a Float32 file.  I'm
> working with hyperion data which is Integer.
>
> This code creates an outputfile, however, the output file t1.tif is Integer.
> I need it to be float.
>
> fname = "./EO1H0420362001131100P1/EO1H0420362001131100P1_B023_L1T.TIF"
> x <- GDAL.open(fname, read.only=TRUE)
> tmp = getRasterData(x)
> xx <- copyDataset(x, driver="GTiff")
> putRasterData(xx, tmp+1)
> saveDataset(xx, "t1.tif")
> GDAL.close(x)
> GDAL.close(xx)
>
> This code creates a Float32 file, however, the geo referencing information
> is lost:
>
> x <- GDAL.open(fname, read.only=TRUE)
> tmp = getRasterData(x)
> xx <- new("GDALTransientDataset", driver=new("GDALDriver", "GTiff"),
>   rows=ncol(tmp), cols=nrow(tmp), bands=1, type="Float32")
> putRasterData(xx, tmp+1)
> saveDataset(xx, "t2.tif")
> GDAL.close(x)
> GDAL.close(xx)
>
> This code fails with the following error:
>
> Error in function (classes, fdef, mtable)  :
>   unable to find an inherited method for function "gridded", for signature
> "GDALTransientDataset"
>
> x <- GDAL.open(fname, read.only=TRUE)
> tmp = getRasterData(x)
> xx <- copyDataset(x, driver="GTiff")
> putRasterData(xx, tmp+1)
> writeGDAL(xx, "t3.tif")
> GDAL.close(x)
> GDAL.close(xx)
>
> Any help will be greatly appreciated.
>
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problems-writing-a-tiff-file-with-georeferencing-tp7580850.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jeckert1 at uw.edu  Wed Aug 29 23:50:12 2012
From: jeckert1 at uw.edu (Joe Eckert)
Date: Wed, 29 Aug 2012 14:50:12 -0700
Subject: [R-sig-Geo] Difficulties with Eckert IV/Mollweide projection of
 RasterLayer with global extent
Message-ID: <CABM-zB=C0y42ZWjfB-YXcA=cTAnJBxdgN0OOD8VgVEMeKzKvMg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120829/366c43b4/attachment.pl>

From lyndon.estes at gmail.com  Thu Aug 30 04:10:59 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Wed, 29 Aug 2012 22:10:59 -0400
Subject: [R-sig-Geo] How to speed up calculating proportion of landcover
 classes falling within larger pixels?
In-Reply-To: <CANtt_hyF=VL2jRPd4V7Up_g-ZjMLxxgOKhsg-gmp890qGucxMw@mail.gmail.com>
References: <CALuVVaZdMKHcbJ85gNt2rFsLwAK+vX_Pcyz6n+WVgsZBMHJgag@mail.gmail.com>
	<CALuVVabBGv7n3PE=E0fWwDqd9ToGe93mVSassxeR8E0KzXrkQw@mail.gmail.com>
	<CANtt_hzuoTwJyNF_CMyrBnja+t39UXmt8pceCAxL=8AbcjyMXg@mail.gmail.com>
	<CALuVVaZwZB+NEczHzm8sZKbbFTh3er1GOPT0U=moThfsngOukw@mail.gmail.com>
	<CALuVVaYnPrRBH5LBVQc4F2WKvPJ5_mX7LDeiBCMEBV1wZ47s=A@mail.gmail.com>
	<CANtt_hyF=VL2jRPd4V7Up_g-ZjMLxxgOKhsg-gmp890qGucxMw@mail.gmail.com>
Message-ID: <CALuVVabWrtWtErMseh-zxxdYLGSpWxUdM4pQrMLZOtoFyH-3DA@mail.gmail.com>

Hi Robert,

Excellent, many thanks for adding that.  I will give that a try when
it is released.

For a name, something like "distill" or "fractionate" might provide a
reasonable description of what the function does (or at least in terms
of how I was using the approach)?

One thing to point out, in case it is of interest to others who will
use this approach, is that if the second case is used, as I did, the
resulting raster may have a quilt-like appearance if the edges of the
cells of the coarser raster do not line up with the edges of the outer
pixels of the finer resolution raster underneath it.  In my case, I
had results ranging from the low 40s to 65 for the total counts of 30
m cells whose centers intersected each of the 232 m MODIS pixels.

Thanks again,

Lyndon


On Wed, Aug 29, 2012 at 1:48 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Hi Lyndon,
>
> I have added this approach to 'raster' under the name of 'layerize' (is
> there a better term?). There are two variations.
>
> 1) In the simple case the function transforms a RasterLayer with values
> representing classes (e.g. land cover type) into a RasterBrick with a
> presence/absence layer for each class. This is a simple wrapper around a
> call to 'calc', but I might change that to increase speed.
>
> 2) In the other (your) case you need to also provide a second RasterLayer
> that overlaps with the first, but has larger cells. The layers in the
> resulting RasterBrick will have counts for each class.
>
> Note that if the larger cell RasterLayer can be obtained by aggregation of
> the smaller cell RasterLayer it should be more efficient to use the simple
> case, followed by aggregate(x, , sum)   (( in your case, you could also
> choose to aggregate the output of the simple case to the approximate
> resolution/origin desired and then use resample to get the values where you
> want them; but that is a more approximate solution ))
>
> Robert
>
>
> On Tue, Aug 28, 2012 at 1:06 PM, Lyndon Estes <lyndon.estes at gmail.com>
> wrote:
>>
>> Hi Robert,
>>
>> Just wanted to report back on the solution you gave me, which worked
>> perfectly as you wrote it.
>>
>> >> library(raster)
>> >>
>> >> library(rgdal)
>> >>
>> >> r <- raster(ncol=10, nrow=10)  # EP MODIS pixels
>> >> eplc <- raster()
>> >> set.seed(0)
>> >> eplc[] <- round(  runif(ncell(eplc)) + 3)
>> >> eplc[10000:11000] <- NA
>> >>
>> >> bs <- blockSize(r, minblocks = 200)  # Calculate size of rows to work
>> >> on
>> >>
>> >> # Output datasets
>> >> rcl3 <- writeStart(r, "lc_class3.tif", overwrite = TRUE)
>> >> rcl4 <- writeStart(r, "lc_class4.tif", overwrite = TRUE)
>> >> rtot <- writeStart(r, "lc_aall.tif", overwrite = TRUE)
>> >>
>> >> # Start processing loop
>> >> for(i in 1:bs$n) {
>> >>    print(paste("Iteration", i))
>> >>    # extent of this (modis) block
>> >>    e <- extent(xmin(r), xmax(r), yFromRow(r, bs$row[i]+bs$nrows[i]-1) -
>> >> 0.5 * yres(r), yFromRow(r, bs$row[i])+0.5 * yres(r))
>> >>
>> >>    vo1 <- vo2 <- vo3 <- rep(NA, bs$nrows[i] * ncol(r))
>> >>
>> >>    int <- intersect(e, extent(eplc))
>> >>    if (!is.null(int)) {
>> >>    b <- crop(eplc, int)
>> >>    xy <- xyFromCell(b, 1:ncell(b))
>> >>    mc <- cellFromXY(r, xy)
>> >>
>> >>            # here I use table, there could be other ways (e.g. tapply)
>> >> to achieve the below
>> >> v <- table(mc, getValues(b))
>> >>    cells <- as.integer(rownames(v))
>> >> modcells <- cellFromRowCol(r, bs$row[i], 1) : cellFromRowCol(r,
>> >> bs$row[i]+bs$nrows[i]-1, ncol(r))
>> >> m <- match(cells, modcells)
>> >>
>> >> cn <- as.integer(colnames(v))
>> >> if (3 %in% cn) {
>> >> vo1[m] <- v[, '3']
>> >> }
>> >> if (4 %in% cn) {
>> >> vo2[m] <- v[, '4']
>> >> }
>> >> vo3[m] <- apply(v, 1, sum)
>> >> rcl3 <- writeValues(rcl3, vo1, bs$row[i])  # Write out sum class 3
>> >> rcl4 <- writeValues(rcl4, vo2, bs$row[i])  # Write out sum class 4
>> >> rtot <- writeValues(rtot, vo3, bs$row[i])  # Write sum total pixels
>> >>   }
>> >> }
>> >>
>> >> rcl3 <- writeStop(rcl3)
>> >> rcl4 <- writeStop(rcl4)
>> >> rtot <- writeStop(rtot)
>> >>
>>
>> I tweaked it to run with my actual grids, and it took only 6 minutes
>> to run, producing 4 outputs each with the following characteristics:
>>
>> class       : RasterLayer
>> dimensions  : 1593, 1901, 3028293  (nrow, ncol, ncell)
>> resolution  : 231.6564, 231.6564  (x, y)
>> extent      : 3230680, 3671058, -1712867, -1343839  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
>> +b=6371007.181 +units=m +no_defs
>> values      :
>> layer name  : eplc_ag
>> min value   : 0
>> max value   : 64
>>
>> Needless to say, that is an enormous improvement on the 3 day run I
>> had using the extract approach.
>>
>> Thanks again for the advice and for the raster package.
>>
>> Cheers, Lyndon
>
>


From r.hijmans at gmail.com  Thu Aug 30 06:18:40 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 29 Aug 2012 21:18:40 -0700
Subject: [R-sig-Geo] Difficulties with Eckert IV/Mollweide projection of
 RasterLayer with global extent
In-Reply-To: <CABM-zB=C0y42ZWjfB-YXcA=cTAnJBxdgN0OOD8VgVEMeKzKvMg@mail.gmail.com>
References: <CABM-zB=C0y42ZWjfB-YXcA=cTAnJBxdgN0OOD8VgVEMeKzKvMg@mail.gmail.com>
Message-ID: <CANtt_hw2FDRGL+_dK_J9Jh9+AKb3S4gnd19oG7PM4GOQferPaw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120829/31fef90a/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Aug 31 10:39:35 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 31 Aug 2012 10:39:35 +0200
Subject: [R-sig-Geo] shortest path
In-Reply-To: <1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
	<CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>
	<1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>
Message-ID: <CAGfc75=v80gMaRU_MTQa8UGZO0R8uP-KEne8-etzPp8BRvxQZA@mail.gmail.com>

Hi,


I've got a question which is graph-related.

Let's suppose I have a linear network.

I cut the lines at the intersections and get some vertexes and edges
connecting them

How can I turn this into a graph that I could treat in igraph?

I've put a line sample as attached file if any geohacker is interested in
facing the challenge ;)


Mat

2012/8/25 Karl Ove Hufthammer <karl at huftis.org>

> Barry Rowlingson skreiv:
>
> > [1] I think the zero indexing might be changing soon, or has
> > changed... Recent igraphs might be different,
>
> Indeed. From the release notes of igraph 0.6:
>
> ,----[ http://igraph.sourceforge.net/relnotes-0.6.html ]
> | The biggest change in the R interface is that starting from this version
> | vertices and edges are numbered from one. This change might be painful
> | for many people, because it makes already existing code incompatible with
> | igraph 0.6. To make the switch easier, there is now an igraph0 package
> | on CRAN; igraph0 uses 0-based vertex and edge ids, and it can be used
> | to run old code. Note, however, that igraph0 will not be developed in
> | the future. Please use the igraph package for current and future work.
> |
> | (Also note that in Python and C vertices and edges are still numbered
> | from zero, as these languages traditionally use zero-based indexing.)
> `----
>
> --
> Karl Ove Hufthammer
> E-mail: karl at huftis.org
> Jabber: huftis at jabber.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120831/8f398f95/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: LINE.zip
Type: application/zip
Size: 1728 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120831/8f398f95/attachment.zip>

From b.rowlingson at lancaster.ac.uk  Fri Aug 31 12:58:25 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 31 Aug 2012 11:58:25 +0100
Subject: [R-sig-Geo] shortest path
In-Reply-To: <1fb14c3c502d4a1d95c4f0a6053d097d@EX-0-HT0.lancs.local>
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
	<CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>
	<1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>
	<1fb14c3c502d4a1d95c4f0a6053d097d@EX-0-HT0.lancs.local>
Message-ID: <CANVKczP1NyAwjbQFCwK-h8iHHUi1rY0O7qfK=R0uLcUY_++OGg@mail.gmail.com>

On Fri, Aug 31, 2012 at 9:39 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hi,
>
>
> I've got a question which is graph-related.
>
> Let's suppose I have a linear network.
>
> I cut the lines at the intersections and get some vertexes and edges
> connecting them
>
> How can I turn this into a graph that I could treat in igraph?
>
> I've put a line sample as attached file if any geohacker is interested in
> facing the challenge ;)

 For complex geometry you'd probably want to feed this to one of the
GRASS modules that builds topologies. I have a hacky method which I'll
outline...

 * read lines using readOGR
 * use package rgeos to intersect the lines with themselves
 * that gives you a single object containing line segments that are
only two points.
 * create a label for each point based on the x and y coordinate,
suitably rounded
 * that gives you a node label for each point. hence the graph.

I think this will work for data that is relatively clean. It won't fix
certain data errors, for example if a point from one line is very
close to the middle of another line, since no intersection will be
found. Other topology build solutions might notice that point X is
1e-10 from the line from A to B and create an extra node there, thus
'snapping' X to that location and causing a new node in the graph...

 If I didn't have to be on a train in three hours I'd code this up...

Barry


From b.rowlingson at lancaster.ac.uk  Fri Aug 31 13:15:09 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 31 Aug 2012 12:15:09 +0100
Subject: [R-sig-Geo] shortest path
In-Reply-To: <bc1ce8d194f1409e81f9e2bfaaa9c8e8@EX-1-HT0.lancs.local>
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
	<CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>
	<1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>
	<1fb14c3c502d4a1d95c4f0a6053d097d@EX-0-HT0.lancs.local>
	<bc1ce8d194f1409e81f9e2bfaaa9c8e8@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPfRE5rgSzmZ=CMbt--A2Yq-Y0n4cj1dcRHvLmrLQuNdw@mail.gmail.com>

On Fri, Aug 31, 2012 at 11:58 AM, Rowlingson, Barry
<b.rowlingson at lancaster.ac.uk> wrote:

>  If I didn't have to be on a train in three hours I'd code this up...

 Oh who am I kidding:

buildTopo <- function(lines){
  require(rgeos)
  require(igraph)

  g = gIntersection(lines,lines)
  edges = do.call(rbind,lapply(g at lines[[1]]@Lines,function(ls){as.vector(t(ls at coords))}))
  lengths = sqrt((edges[,1]-edges[,3])^2+(edges[,2]-edges[,4])^2)

  froms = paste(edges[,1],edges[,2])
  tos = paste(edges[,3],edges[,4])

  graph = graph.edgelist(cbind(froms,tos),directed=FALSE)
  E(graph)$weight=lengths
  return(graph)

}

 > m = readOGR(".","Line")
 > gg = buildTopo(m)

compute shortest distance between two vertices (note the -1 is because
I'm still on old igraph with 0-indexing):

 > E(gg)[get.shortest.paths(gg,V(gg)[1],V(gg)[14])[[1]]-1]

Edge sequence:

[0]  0.81711193 47.57711634 -- -0.28546154 48.4287593
[1]  2.2151139 46.49728033  -- 0.81711193 47.57711634
[9]  1.57160852 45.36348513 -- 2.2151139 46.49728033
[10] 1.39973834 45.06066625 -- 1.57160852 45.36348513
[11] 1.29755246 44.88062446 -- 1.39973834 45.06066625
[12] 0.91544563 43.67971729 -- 1.29755246 44.88062446
[13] 0.88815229 43.43407719 -- 0.91544563 43.67971729

I think this could be improved by adding the coordinates to the nodes.
But anyway, 90% done.

Barry


From mathieu.rajerison at gmail.com  Fri Aug 31 14:44:08 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 31 Aug 2012 14:44:08 +0200
Subject: [R-sig-Geo] shortest path
In-Reply-To: <CANVKczPfRE5rgSzmZ=CMbt--A2Yq-Y0n4cj1dcRHvLmrLQuNdw@mail.gmail.com>
References: <9cfe9df807aa43739fb2f68647777f1d@EX-0-HT0.lancs.local>
	<CANVKczOPWeqWrr-Q94AKSv+D+-TuBPfBdAFE7G_60-jXvgDJNA@mail.gmail.com>
	<1662121.jOZdtS26z0@ID-99504.news.uni-berlin.de>
	<1fb14c3c502d4a1d95c4f0a6053d097d@EX-0-HT0.lancs.local>
	<bc1ce8d194f1409e81f9e2bfaaa9c8e8@EX-1-HT0.lancs.local>
	<CANVKczPfRE5rgSzmZ=CMbt--A2Yq-Y0n4cj1dcRHvLmrLQuNdw@mail.gmail.com>
Message-ID: <CAGfc75k7zoNo82rs=OCgoitbnZA04Lb8LVAXad0-HryBnt3WeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120831/babb6f57/attachment.pl>

From bohara at unm.edu  Fri Aug 31 17:52:48 2012
From: bohara at unm.edu (Alok K Bohara, PhD)
Date: Fri, 31 Aug 2012 09:52:48 -0600
Subject: [R-sig-Geo] layering data with different projection (or no prj)
Message-ID: <5040DDD0.3020302@unm.edu>

I am learning to layer different shape files.  In particular one 
shapefile --with point patterns-- does not have any projection info (it 
says NULL).  The other State county file has projection info. Both data 
come from the same state (New Mexico).  I can plot both separately.

!. "County"
Prj:    +proj=utm +zone=13 +datum=NAD83 +units=m +no_defs +ellps=GRS80 
+towgs84=0,0,0

2. "Disease" (for example --it does not fahe .prj file)

Prj:  NULL

Is there anyway I could  layer 2 onto 1?  Thanks.

Alok  Bohara
UNM


From tom.gottfried at o2mail.de  Fri Aug 31 18:25:23 2012
From: tom.gottfried at o2mail.de (Tom Gottfried)
Date: Fri, 31 Aug 2012 18:25:23 +0200
Subject: [R-sig-Geo] layering data with different projection (or no prj)
In-Reply-To: <5040DDD0.3020302@unm.edu>
References: <5040DDD0.3020302@unm.edu>
Message-ID: <5040E573.1070909@o2mail.de>

Am 31.08.2012 17:52, schrieb Alok K Bohara, PhD:
> I am learning to layer different shape files. In particular one
> shapefile --with point patterns-- does not have any projection info (it
> says NULL). The other State county file has projection info. Both data
> come from the same state (New Mexico). I can plot both separately.
>
> !. "County"
> Prj: +proj=utm +zone=13 +datum=NAD83 +units=m +no_defs +ellps=GRS80
> +towgs84=0,0,0
>
> 2. "Disease" (for example --it does not fahe .prj file)
>
> Prj: NULL
>
> Is there anyway I could layer 2 onto 1? Thanks.

That depends on what you actually mean with layering. Provide some code 
examples to show what you want to do and it will be possible to answer 
your question (for details see
http://www.r-project.org/posting-guide.html)

HTH,
Tom

>
> Alok Bohara
> UNM
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Indo-German Centre for Sustainability
Indian Institute of Technology Madras
600 036 Chennai, India
www.igcs-chennai.org


From biomario at gmail.com  Fri Aug 31 21:05:44 2012
From: biomario at gmail.com (Mario A. Pardo)
Date: Fri, 31 Aug 2012 12:05:44 -0700
Subject: [R-sig-Geo] distances between coordinates: alternatives?
Message-ID: <50410B08.7020709@gmail.com>

Hi,

I need to calculate the great circle distances between consecutive 
coordinates.

Let's say:

lon <- c(-115.8667, -115.8667, -115.8583, -115.8500, -115.8500, 
-115.8500, -115.8444, -115.8389, -115.8333, -115.8333, -115.8333)
lat <- c( 29.76670,  29.76670,  29.74170,  29.71670,  29.71670, 
29.71670,  29.68337,  29.65003,  29.61670,  29.61670,  29.60000)

The output vector that I need is:

 > distances

          0
     2.8990
     2.8963
          0
          0
     3.7496
     3.7493
     3.7496
          0
     1.8590

In which each value corresponds to the distance (in kilometers) between 
one coordinate and the previous. Obviously this vector is one value shorter.

I know that the function "rdist.earth" gives this result within a square 
matrix hidden as a diagonal, but it turns out that the position of that 
diagonal differs depending on the length of the coordinate vectors. 
That's a huge problem within a loop, because I'm dealing with thousands 
of sets of coordinates of different lengths and I can't extract the 
values iteratively. I just moved to R from Matlab, in which this was 
very straight forward with the "m_lldist" function.

Do you know another function to compute this?

Thanks in advance,

  
--
mario


From r.hijmans at gmail.com  Fri Aug 31 21:24:35 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 31 Aug 2012 12:24:35 -0700
Subject: [R-sig-Geo] distances between coordinates: alternatives?
In-Reply-To: <50410B08.7020709@gmail.com>
References: <50410B08.7020709@gmail.com>
Message-ID: <CANtt_hyWFy8YOV0LVr=EjpmS-NaS9VYUAjyRq5DN6prkKEGDRQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120831/2d2f624c/attachment.pl>

