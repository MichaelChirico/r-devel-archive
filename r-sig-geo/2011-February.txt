From andrewaduff at gmail.com  Tue Feb  1 00:30:59 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Mon, 31 Jan 2011 15:30:59 -0800 (PST)
Subject: [R-sig-Geo] filtering successive locations for kernelbb in
	adehabitat
In-Reply-To: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>
References: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>
Message-ID: <1296516659776-5979280.post@n2.nabble.com>


Thanks for your help Mathieu.  Once I have different UD's for each burst what
is the best way to combine and weight them and arrive at a true probabiity
distribution function?  I want to ensure that I have a true pdf which I can
use to calculate volume and volume contours.  I intend on using the output
for a quantitative comparison of home range size, disjunctness (number of
fragments due to data discretion issues), and volume overlap (VI, BA, and
UDOI).
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/filtering-successive-locations-for-kernelbb-in-adehabitat-tp5979022p5979280.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Tue Feb  1 01:25:14 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Mon, 31 Jan 2011 16:25:14 -0800 (PST)
Subject: [R-sig-Geo] filtering successive locations for kernelbb in
	adehabitat
In-Reply-To: <1296516659776-5979280.post@n2.nabble.com>
References: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>
	<1296516659776-5979280.post@n2.nabble.com>
Message-ID: <1296519914049-5979412.post@n2.nabble.com>


Seems that I found the answer to my question here...

http://www.mail-archive.com/animov at faunalia.com/msg00050.html

Thanks
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/filtering-successive-locations-for-kernelbb-in-adehabitat-tp5979022p5979412.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue Feb  1 08:58:11 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 31 Jan 2011 23:58:11 -0800 (PST)
Subject: [R-sig-Geo] how to calculate areas of shape files using R
In-Reply-To: <alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>
References: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
	<AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>
	<alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>
Message-ID: <1296547091531-5980100.post@n2.nabble.com>


> A small caveat - if the coordinates are planar, the explanation holds, if 
> geographical (degrees), it doesn't. The naive area values have been used 
> internally to plot larger Polygon objects before smaller Polygon objects, 
> to avoid overplotting in earlier versions of R that did not "identify" 
> holes automatically. So first make sure that you have planar coordinates, 
> otherwise the "area" values have no metric. If need be, project with 
> spTransform() methods in rgdal

If the coordinates are spherical (in degrees) you can compute the area of
polygons in a SpatialPolygons* object like this: 

library(geosphere)
areaPolygons(object) 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-calculate-areas-of-shape-files-using-R-tp5975749p5980100.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jeffrey.stratford at wilkes.edu  Tue Feb  1 19:14:31 2011
From: jeffrey.stratford at wilkes.edu (Stratford, Jeffrey)
Date: Tue, 1 Feb 2011 13:14:31 -0500
Subject: [R-sig-Geo] creating an adjacency matrix in spdep
In-Reply-To: <alpine.LRH.2.00.1101310919580.12919@reclus.nhh.no>
References: <72B2B2BDFE51E64DAC6381495614980006A3756B@STAFFEXCHVS3.wilkesu.wilkes.edu>
	<alpine.LRH.2.00.1101310919580.12919@reclus.nhh.no>
Message-ID: <72B2B2BDFE51E64DAC6381495614980006ABE835@STAFFEXCHVS3.wilkesu.wilkes.edu>

Thanks Roger,  I did read through I just wanted to make sure. When I
read "nearest neighbor" I think of the point closest to another point
and I think I am looking for a matrix of distances between all points -
so the two ideas (nearest neighbor and adjacency matrix) didn't jive in
my head.  Do I have it right though - is the adjacency matrix a
rectangular matrix of distances (or inverse distances) between points? I
was able to run the functions you mentioned but I don't get the matrix
I'm looking for.  Here's what I have so far:

# creating and exporting an adjacency matrix
library(spdep)
sosp09 <- read.csv("g:\\sosp\\2009\\sosp2009c.csv", header=T)
n <- nrow(sosp09)
plot(sosp09$x, sosp09$y)
coords <-cbind(sosp09$x, sosp09$y)
coordinates(sosp09) <- c("x","y")
# these are the USGS coordinates
distan <- dnearneigh(coords, 0, 100000)
distan2 <- make.sym.nb(distan)
plot(distan, coords)

# When I pull up distan and distan2 I get a summary 

Neighbour list object:
Number of regions: 53 
Number of nonzero links: 2740 
Percentage nonzero weights: 97.54361 
Average number of links: 51.69811

Thanks the help!  I'm going through your spatial book and it's really
good - lots of tips! 

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Monday, January 31, 2011 3:30 AM
To: Stratford, Jeffrey
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] creating an adjacency matrix in spdep

On Sun, 30 Jan 2011, Stratford, Jeffrey wrote:

> Hi everyone,
>
>
>
> Is it possible to create an adjacency matrix required for
> WinBUGS/GeoBUGS in spdep from a csv file containing UTM coordinates?
>
>
>
> I've gone through the spdep documentation and it looks like the
> equivalent there is col.gal.nb?  Is that right?  I see where that
object
> is used but not how it was created.
>

There is plenty of documentation in spdep on the creation of nb objects
if 
you look for it. For point support (your case), you can choose between 
dnearneigh() for distance-based neighbours, knn2nb(knearneigh()) for k 
nearest neighbours (will need making summetric with make.sym.nb() for 
WinBUGS), or the various graph2nb() variants (which may also need making

symmetric). The case you refer to from ?nb2WB refers to ?columbus, which

explains that col.gal.nb is an nb object imported from an original 
GAL-format file for compatibility with GeoDa - the example shows how, 
using read.gal(). You should also be able to read the *.gal or *.gwt
files 
you made in GeoDa with read.gal() or read.gwt2nb(), then out again with 
nb2WB().

Hope this helps,

Roger

>
>
> I also realize that I can get the same through GeoDa but I haven't
been
> able to figure out how to export the adj matrix from there.
>
>
>
> Many thanks,
>
>
>
> Jeff
>
>
>
> *****************************************
>
> Jeffrey A. Stratford, Ph.D.
>
> Department of Health and Biological Sciences
>
> 84 W. South St.
>
> Wilkes Univertsity, PA 18766
>
> 570-332-2942
>
> http://web.wilkes.edu/jeffrey.stratford/
>
> *****************************************
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Feb  1 20:06:40 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 1 Feb 2011 20:06:40 +0100 (CET)
Subject: [R-sig-Geo] creating an adjacency matrix in spdep
In-Reply-To: <72B2B2BDFE51E64DAC6381495614980006ABE835@STAFFEXCHVS3.wilkesu.wilkes.edu>
References: <72B2B2BDFE51E64DAC6381495614980006A3756B@STAFFEXCHVS3.wilkesu.wilkes.edu>
	<alpine.LRH.2.00.1101310919580.12919@reclus.nhh.no>
	<72B2B2BDFE51E64DAC6381495614980006ABE835@STAFFEXCHVS3.wilkesu.wilkes.edu>
Message-ID: <alpine.LRH.2.00.1102011953380.20528@reclus.nhh.no>

On Tue, 1 Feb 2011, Stratford, Jeffrey wrote:

> Thanks Roger,  I did read through I just wanted to make sure. When I
> read "nearest neighbor" I think of the point closest to another point
> and I think I am looking for a matrix of distances between all points -
> so the two ideas (nearest neighbor and adjacency matrix) didn't jive in
> my head.  Do I have it right though - is the adjacency matrix a
> rectangular matrix of distances (or inverse distances) between points?

No, it is not a matrix. An nb object is a list of vectors of neighbour IDs 
(taken as integer IDs in j=1,N, j!=i); a listw object pairs an nb object 
with the matching spatial weights in the same configuration, and is very 
much like a sparse matrix representation. listw2mat() converts a listw 
object into a dense matrix with mostly zero entries; sparse matrix 
representations are also used in spdep.

By definition, an adjacency matrix is a sparse matrix representing the 
graph of edges representing adjacency relationships between nodes, and 
only in very odd circumstances would it be dense (all adjacent to all). 
You are setting the distance threshold too large. The example in 
?dnearneigh shows how you can use the nearest neighbour to set the 
threshold so that all observations are linked, which is most likely needed 
in WB.

> I was able to run the functions you mentioned but I don't get the matrix 
> I'm looking for.  Here's what I have so far:
>
> # creating and exporting an adjacency matrix
> library(spdep)
> sosp09 <- read.csv("g:\\sosp\\2009\\sosp2009c.csv", header=T)
> n <- nrow(sosp09)
> plot(sosp09$x, sosp09$y)
> coords <-cbind(sosp09$x, sosp09$y)
> coordinates(sosp09) <- c("x","y")
> # these are the USGS coordinates
> distan <- dnearneigh(coords, 0, 100000)

Distance-based neighbours are necessarily symmetric by definition, so the 
next step is superfluous.

Hope this helps,

Roger

> distan2 <- make.sym.nb(distan)
> plot(distan, coords)
>
> # When I pull up distan and distan2 I get a summary
>
> Neighbour list object:
> Number of regions: 53
> Number of nonzero links: 2740
> Percentage nonzero weights: 97.54361
> Average number of links: 51.69811
>
> Thanks the help!  I'm going through your spatial book and it's really
> good - lots of tips!
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Monday, January 31, 2011 3:30 AM
> To: Stratford, Jeffrey
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] creating an adjacency matrix in spdep
>
> On Sun, 30 Jan 2011, Stratford, Jeffrey wrote:
>
>> Hi everyone,
>>
>>
>>
>> Is it possible to create an adjacency matrix required for
>> WinBUGS/GeoBUGS in spdep from a csv file containing UTM coordinates?
>>
>>
>>
>> I've gone through the spdep documentation and it looks like the
>> equivalent there is col.gal.nb?  Is that right?  I see where that
> object
>> is used but not how it was created.
>>
>
> There is plenty of documentation in spdep on the creation of nb objects
> if
> you look for it. For point support (your case), you can choose between
> dnearneigh() for distance-based neighbours, knn2nb(knearneigh()) for k
> nearest neighbours (will need making summetric with make.sym.nb() for
> WinBUGS), or the various graph2nb() variants (which may also need making
>
> symmetric). The case you refer to from ?nb2WB refers to ?columbus, which
>
> explains that col.gal.nb is an nb object imported from an original
> GAL-format file for compatibility with GeoDa - the example shows how,
> using read.gal(). You should also be able to read the *.gal or *.gwt
> files
> you made in GeoDa with read.gal() or read.gwt2nb(), then out again with
> nb2WB().
>
> Hope this helps,
>
> Roger
>
>>
>>
>> I also realize that I can get the same through GeoDa but I haven't
> been
>> able to figure out how to export the adj matrix from there.
>>
>>
>>
>> Many thanks,
>>
>>
>>
>> Jeff
>>
>>
>>
>> *****************************************
>>
>> Jeffrey A. Stratford, Ph.D.
>>
>> Department of Health and Biological Sciences
>>
>> 84 W. South St.
>>
>> Wilkes Univertsity, PA 18766
>>
>> 570-332-2942
>>
>> http://web.wilkes.edu/jeffrey.stratford/
>>
>> *****************************************
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jaimebg27 at gmail.com  Tue Feb  1 21:58:44 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 1 Feb 2011 15:58:44 -0500
Subject: [R-sig-Geo] Plot Histogram with axes inverted
Message-ID: <AANLkTi=DOV0=V=ob9Qf7a+p2eUA4tHw0qu_yYy5xnDyR@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110201/ddb9724c/attachment.pl>

From ldecola at comcast.net  Wed Feb  2 05:50:03 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Wed, 2 Feb 2011 04:50:03 +0000
Subject: [R-sig-Geo] Plot Histogram with axes inverted
In-Reply-To: <AANLkTi=DOV0=V=ob9Qf7a+p2eUA4tHw0qu_yYy5xnDyR@mail.gmail.com>
Message-ID: <1902109477.67917.1296622203142.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110202/70f3fd25/attachment.pl>

From Roger.Bivand at nhh.no  Wed Feb  2 09:14:06 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 2 Feb 2011 09:14:06 +0100 (CET)
Subject: [R-sig-Geo] R-spatial intensive PhD course 3-10 May 2011
Message-ID: <alpine.LRH.2.00.1102020903250.23950@reclus.nhh.no>

A new edition of the intensive PhD course "Analysing spatial data" will be 
held in Bergen, 3-10 May 2011; its web page has just been published, with 
details of content and how to apply:

http://www.nhh.no/en/research---faculty/department-of-economics/phd-pages/phd-courses/ecs530-analysing-spatial-data.aspx

No application deadline has yet been set, but the number of places is 
limited to about 30 by the room used. Please contact me off-list with any 
queries. Note that registration for GEOSTAT 2011 in Landau:

http://geostat-course.org/

is still open, and may be more suitable, and more fun, than the Bergen 
course for many people.

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From luca.candeloro at gmail.com  Wed Feb  2 09:14:50 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Wed, 2 Feb 2011 09:14:50 +0100
Subject: [R-sig-Geo] MODIS
Message-ID: <AANLkTi=bVJ50pNBVDO37OyO1HA8x5vKYaVEE1Uw2Fv+O@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110202/56105459/attachment.pl>

From Christian.Strobl at dlr.de  Wed Feb  2 10:23:57 2011
From: Christian.Strobl at dlr.de (Christian.Strobl at dlr.de)
Date: Wed, 2 Feb 2011 09:23:57 +0000
Subject: [R-sig-Geo] MODIS
In-Reply-To: <AANLkTi=bVJ50pNBVDO37OyO1HA8x5vKYaVEE1Uw2Fv+O@mail.gmail.com>
References: <AANLkTi=bVJ50pNBVDO37OyO1HA8x5vKYaVEE1Uw2Fv+O@mail.gmail.com>
Message-ID: <BA25E6A9A6B2B54EB96F4F12F3683E030BE00A4A@dlrexmbx02.intra.dlr.de>

 
hi luca,
you can try alternatively the following links 

https://wist.echo.nasa.gov/api/
http://oceandata.sci.gsfc.nasa.gov
http://rapidfire.sci.gsfc.nasa.gov

good luck
christian

> -----Urspr?ngliche Nachricht-----
> Von: r-sig-geo-bounces at r-project.org 
> [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von luca candeloro
> Gesendet: Mittwoch, 2. Februar 2011 09:15
> An: r-sig-geo at r-project.org
> Betreff: [R-sig-Geo] MODIS
> 
> I'd like to download MODIS hdf file for the year 2010 from 
> the ftp address:
> 
> ftp://e4ftl01u.ecs.nasa.gov/MOLT/MOD11A2.005/
> 
> But I don't find files about november and december 2010.
> 
> Does anyone know why they aren't available?
> 
> Thanks,
> Luca
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

From guy.serbin at gmail.com  Wed Feb  2 17:51:23 2011
From: guy.serbin at gmail.com (Guy Serbin)
Date: Wed, 2 Feb 2011 11:51:23 -0500
Subject: [R-sig-Geo] MODIS
In-Reply-To: <BA25E6A9A6B2B54EB96F4F12F3683E030BE00A4A@dlrexmbx02.intra.dlr.de>
References: <AANLkTi=bVJ50pNBVDO37OyO1HA8x5vKYaVEE1Uw2Fv+O@mail.gmail.com>
	<BA25E6A9A6B2B54EB96F4F12F3683E030BE00A4A@dlrexmbx02.intra.dlr.de>
Message-ID: <AANLkTimC7seuHG0hH_Xa42NoMPn_ckWOCWi2xqFjdJuG@mail.gmail.com>

You can also get MODIS tiles from glovis.usgs.gov

Best regards,
Guy Serbin

On Wed, Feb 2, 2011 at 4:23 AM,  <Christian.Strobl at dlr.de> wrote:
>
> hi luca,
> you can try alternatively the following links
>
> https://wist.echo.nasa.gov/api/
> http://oceandata.sci.gsfc.nasa.gov
> http://rapidfire.sci.gsfc.nasa.gov
>
> good luck
> christian
>
>> -----Urspr?ngliche Nachricht-----
>> Von: r-sig-geo-bounces at r-project.org
>> [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von luca candeloro
>> Gesendet: Mittwoch, 2. Februar 2011 09:15
>> An: r-sig-geo at r-project.org
>> Betreff: [R-sig-Geo] MODIS
>>
>> I'd like to download MODIS hdf file for the year 2010 from
>> the ftp address:
>>
>> ftp://e4ftl01u.ecs.nasa.gov/MOLT/MOD11A2.005/
>>
>> But I don't find files about november and december 2010.
>>
>> Does anyone know why they aren't available?
>>
>> Thanks,
>> Luca
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From luca.candeloro at gmail.com  Thu Feb  3 09:07:01 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Thu, 3 Feb 2011 09:07:01 +0100
Subject: [R-sig-Geo] MODIS
In-Reply-To: <AANLkTimC7seuHG0hH_Xa42NoMPn_ckWOCWi2xqFjdJuG@mail.gmail.com>
References: <AANLkTi=bVJ50pNBVDO37OyO1HA8x5vKYaVEE1Uw2Fv+O@mail.gmail.com>
	<BA25E6A9A6B2B54EB96F4F12F3683E030BE00A4A@dlrexmbx02.intra.dlr.de>
	<AANLkTimC7seuHG0hH_Xa42NoMPn_ckWOCWi2xqFjdJuG@mail.gmail.com>
Message-ID: <AANLkTinNKy66actP5WAS2gic7upcVreL-Riyok9+L-nN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110203/82cb9015/attachment.pl>

From ghislain.vieilledent at cirad.fr  Thu Feb  3 10:10:10 2011
From: ghislain.vieilledent at cirad.fr (Ghislain Vieilledent)
Date: Thu, 3 Feb 2011 12:10:10 +0300
Subject: [R-sig-Geo] Package sp: image() and breaks= for SpatialGridDataframe
Message-ID: <1296724210.4067.9.camel@ghislain-laptop>

Dear list,

I encountered a problem using function image() and argument breaks on a
SpatialGridDataFrame object (package sp version 0.9-76, R version 2.12.1
(2010-12-16) on Ubuntu 10.04).

I had to use function as.image.SpatialGridDataFrame before to obtain the
correct colored graphic:

# Doesn't work:
image(SDAzD.As.A2a.2080,breaks=c(seq(0,0.5,0.1),1),col=c(grey(seq(0.9,0.5,-0.1)),"dark green"))

# Works:
xyz <- as.image.SpatialGridDataFrame(SDAzD.As.A2a.2080)
image(xyz,breaks=c(seq(0,0.5,0.1),1),col=c(grey(seq(0.9,0.5,-0.1)),"dark
green"))

Is this a normal behavior ?

Best regards,

Ghislain

-- 
_________________________________________________

Ghislain VIEILLEDENT
CIRAD - UR 105 Forest Ecosystem Goods & Services
Ampandrianomby BP 853
Antananarivo - MADAGASCAR
Phone: +261.(0)32.07.235.34
Skype: ghislain.vieilledent
E-mail : ghislain.vieilledent at cirad.fr

Research unit web site: http://www.cirad.fr/ur/bsef
Personal web site: http://ghislain.vieilledent.free.fr


From Tim.Haering at lwf.bayern.de  Thu Feb  3 10:31:50 2011
From: Tim.Haering at lwf.bayern.de (=?iso-8859-1?Q?H=E4ring=2C_Tim_=28LWF=29?=)
Date: Thu, 3 Feb 2011 10:31:50 +0100
Subject: [R-sig-Geo] problems with predict() in raster package
Message-ID: <70FC67C4A585D1489E66225A4E0238BAD19755@RZS-EXC-CL06.rz-sued.bayern.de>

Hello,

I get an error message when using the predict function (raster package) with a GLM and a rasterStack. 
Did somebody have the same error message or can give me a hint what I am doing wrong.


> dv <- raster("dv.sgrd")
> fpi <- raster("fpi.sgrd")
> hut <- raster("hut.sgrd")

> train <- read.dbf("train.dbf")
> str(train)
'data.frame':	2574 obs. of  4 variables:
 $ id : int  26 32 51 71 77 82 97 110 112 118 ...
 $ dv: num  0.507 0.454 0.51 0.422 0.465 ...
 $ fpi: num  0.968 1.396 0.974 1.343 1.412 ...
 $ hut: num  0.465 0.723 0.662 0.4 0.742 ...
 - attr(*, "data_types")= chr  "N" "N" "N" "N"

> myglm <- glm(dv ~ fpi + hut, train, family=gaussian())

> r10 <- stack(fpi, hut)
> r10
class       : RasterStack 
nlayers     : 2 
nrow        : 9736 
ncol        : 7762 
ncell       : 75570832 
projection  : NA 
min value   : NA NA 
max value   : NA NA 
extent      : 4494280, 4571900, 5446480, 5543840  (xmin, xmax, ymin, ymax)
resolution  : 10, 10  (x, y)

> p <- predict(object = r10, model = myglm, filename='pr10', progress='', na.rm = FALSE, overwrite = TRUE)
Error in endrow - nrow : non-numeric argument to binary operator


Thank you very much
TIM

--------------------------------------------- 
Tim H?ring
Bavarian State Institute of Forest Research 
Department of Soil and Climate
Hans-Carl-von-Carlowitz-Platz 1
D-85354 Freising

E-Mail: tim.haering at lwf.bayern.de
http://www.lwf.bayern.de


From edzer.pebesma at uni-muenster.de  Thu Feb  3 10:45:30 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 03 Feb 2011 10:45:30 +0100
Subject: [R-sig-Geo] Package sp: image() and breaks= for
	SpatialGridDataframe
In-Reply-To: <1296724210.4067.9.camel@ghislain-laptop>
References: <1296724210.4067.9.camel@ghislain-laptop>
Message-ID: <4D4A793A.8090800@uni-muenster.de>



On 02/03/2011 10:10 AM, Ghislain Vieilledent wrote:
> Dear list,
> 
> I encountered a problem using function image() and argument breaks on a
> SpatialGridDataFrame object (package sp version 0.9-76, R version 2.12.1
> (2010-12-16) on Ubuntu 10.04).
> 
> I had to use function as.image.SpatialGridDataFrame before to obtain the
> correct colored graphic:
> 
> # Doesn't work:
> image(SDAzD.As.A2a.2080,breaks=c(seq(0,0.5,0.1),1),col=c(grey(seq(0.9,0.5,-0.1)),"dark green"))
> 
> # Works:
> xyz <- as.image.SpatialGridDataFrame(SDAzD.As.A2a.2080)
> image(xyz,breaks=c(seq(0,0.5,0.1),1),col=c(grey(seq(0.9,0.5,-0.1)),"dark
> green"))
> 
> Is this a normal behavior ?

Yes, as the image method is called with different objects, try

class(xyz)
class(SDAzD.As.A2a.2080)

to find out. You get the respective help pages by

?image
?image.SpatialGridDataFrame

> 
> Best regards,
> 
> Ghislain
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From etiennebr at gmail.com  Thu Feb  3 14:50:03 2011
From: etiennebr at gmail.com (Etienne Bellemare)
Date: Thu, 3 Feb 2011 08:50:03 -0500
Subject: [R-sig-Geo] Plot Histogram with axes inverted
In-Reply-To: <1902109477.67917.1296622203142.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
References: <AANLkTi=DOV0=V=ob9Qf7a+p2eUA4tHw0qu_yYy5xnDyR@mail.gmail.com>
	<1902109477.67917.1296622203142.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
Message-ID: <AANLkTikZMeV_=D_r2bJV8Siq84wX6NKyHppjAVpKFojO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110203/85e3c023/attachment.pl>

From Erik.Meesters at wur.nl  Thu Feb  3 16:44:10 2011
From: Erik.Meesters at wur.nl (Meesters, Erik)
Date: Thu, 3 Feb 2011 16:44:10 +0100
Subject: [R-sig-Geo] RgoogleMaps
Message-ID: <B451F396CD230E468613575D48F2EF070B36D203C1@scomp0537.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110203/5579f2a1/attachment.pl>

From hengl at spatial-analyst.net  Thu Feb  3 18:02:38 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 03 Feb 2011 18:02:38 +0100
Subject: [R-sig-Geo] RgoogleMaps
In-Reply-To: <B451F396CD230E468613575D48F2EF070B36D203C1@scomp0537.wurnet.nl>
References: <B451F396CD230E468613575D48F2EF070B36D203C1@scomp0537.wurnet.nl>
Message-ID: <4D4ADFAE.4050805@spatial-analyst.net>


Hi,

I have been breaking my head with this problem some time ago and then I 
got it running some time ago.

See p. 103-104 in [http://spatial-analyst.net/book/download?size=thumbnail]

Here is an example of a Google Earth image imported into a GIS:

[http://spatial-analyst.net/book/node/399]

HTH

T. Hengl
[http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001]

PS: As far as I understand, we are not supposed to download data from 
Google's repository.

Op 3-2-2011 16:44, Meesters, Erik schreef:
> Dear all,
> I'm using the package RgoogleMaps to import google earth maps into R. The object that is retrieved with function GetMap contains a number of slots which I think can be used to translate the google picture into a geoTiff to for example import into ArgGis.
> If anyone would have an example of how to accomplish that or what function to use, I'd be very greatful.
> Best wishes,
> Erik Meesters
>
> Researcher
> Wageningen IMARES
> Dept. Ecosystems
> The Netherlands
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jaimebg27 at gmail.com  Thu Feb  3 20:25:23 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Thu, 3 Feb 2011 14:25:23 -0500
Subject: [R-sig-Geo] Convert Polygons To Raster
Message-ID: <AANLkTikUykeMgfZQJzb1Kb_W0awanVfXrrLrwmYvQTpV@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110203/44f658a2/attachment.pl>

From a.mosnier at gmail.com  Thu Feb  3 20:40:02 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Thu, 3 Feb 2011 14:40:02 -0500
Subject: [R-sig-Geo] Spatial autocorrelation structure
Message-ID: <AANLkTinfgt3FuGfdwgAjYXmUMZ=5X8bhxP_GbzawE8ih@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110203/89c9db18/attachment.pl>

From r.hijmans at gmail.com  Thu Feb  3 21:12:50 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 3 Feb 2011 12:12:50 -0800
Subject: [R-sig-Geo] RgoogleMaps
In-Reply-To: <4D4ADFAE.4050805@spatial-analyst.net>
References: <B451F396CD230E468613575D48F2EF070B36D203C1@scomp0537.wurnet.nl>
	<4D4ADFAE.4050805@spatial-analyst.net>
Message-ID: <1296763970972-5990287.post@n2.nabble.com>


> Dear all, 
> I'm using the package RgoogleMaps to import google earth maps into R. The
> object that is retrieved with function GetMap contains a number of slots
> which I think can be used to translate the google picture into a geoTiff
> to for example import into ArgGis. 
> If anyone would have an example of how to accomplish that or what function
> to use, I'd be very greatful. 
> Best wishes, 
> Erik Meesters 
> 

Here is how you can get a single tile

library(dismo)
library(maptools)
library(rgdal)

# get a google map
g <- gmap("Australia")
plot(g)

# overlay boundaries, after projecting to Mercator
data(wrld_simpl)
w = wrld_simpl[wrld_simpl at data[,"NAME"] != "Antarctica", ]
m = spTransform(w, projection(g, asText=F))
plot(m, add=T)

# export to png
filename <- 'oz.png'
png(filename, width=ncol(g), height=nrow(g))
par(mar=c(0,0,0,0))
image(g, col=g at legend@colortable)
dev.off()

# create 'world file' for georferencing png
r <- raster(filename)
extent(r) <- extent(g)
hdr(r, 'worldfile', 'pgw')

# now open the file in ArcMap

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RgoogleMaps-tp5989261p5990287.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Feb  3 21:27:36 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 3 Feb 2011 12:27:36 -0800
Subject: [R-sig-Geo] RgoogleMaps
In-Reply-To: <1296763970972-5990287.post@n2.nabble.com>
References: <B451F396CD230E468613575D48F2EF070B36D203C1@scomp0537.wurnet.nl>
	<4D4ADFAE.4050805@spatial-analyst.net>
	<1296763970972-5990287.post@n2.nabble.com>
Message-ID: <1296764856801-5990349.post@n2.nabble.com>


> Dear all, 
> I'm using the package RgoogleMaps to import google earth maps into R. The
> object that is retrieved with function GetMap contains a number of slots
> which I think can be used to translate the google picture into a geoTiff
> to for example import into ArgGis. 
> If anyone would have an example of how to accomplish that or what function
> to use, I'd be very greatful. 
> Best wishes, 
> Erik Meesters 
> 

Erik, it is is actually much simpler:

g <- gmap("Amsterdam, Netherlands", type='satellite', filename="adam.gif")
hdr(g, 'worldfile', 'gfw')

Now open "adam.gif" in ArcMap, but set the projection of the ArcGIS
"data.frame" to Mercator.

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RgoogleMaps-tp5989261p5990349.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From carstennh at aol.com  Fri Feb  4 14:23:26 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 4 Feb 2011 14:23:26 +0100
Subject: [R-sig-Geo] Convert Polygons To Raster
In-Reply-To: <AANLkTikUykeMgfZQJzb1Kb_W0awanVfXrrLrwmYvQTpV@mail.gmail.com>
References: <AANLkTikUykeMgfZQJzb1Kb_W0awanVfXrrLrwmYvQTpV@mail.gmail.com>
Message-ID: <4D4BFDCE.1000900@aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110204/30aa275a/attachment.pl>

From gianni.lavaredo at gmail.com  Fri Feb  4 16:11:00 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Fri, 4 Feb 2011 16:11:00 +0100
Subject: [R-sig-Geo] problem to convert a complex "SpatialPolygonsDataFrame"
	to owin
Message-ID: <AANLkTin72E7TG54nBnAG1UhFy3OK=WQ5WBRsNKfH7SPz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110204/b0d934d9/attachment.pl>

From kidsmake6 at msn.com  Fri Feb  4 22:32:16 2011
From: kidsmake6 at msn.com (Brad Nesom)
Date: Fri, 4 Feb 2011 15:32:16 -0600
Subject: [R-sig-Geo] split polygons by percentage
Message-ID: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110204/f4954643/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Feb  5 11:35:52 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 5 Feb 2011 10:35:52 +0000
Subject: [R-sig-Geo] split polygons by percentage
In-Reply-To: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>
References: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>
Message-ID: <AANLkTikxXsEb3eXQpw85UBRpJqnM8R6RubRuCso8KJHE@mail.gmail.com>

On Fri, Feb 4, 2011 at 9:32 PM, Brad Nesom <kidsmake6 at msn.com> wrote:
> is there a method to split polygons into equal parts? using a divisor n or
> percentage?

 Do you mean a mathematical method or some code in R?

 There's clearly no unique solution to any case, and I can see cases
where a solution would be hard to make while retaining simple
polygons.

 Convex polygons aren't so bad, and I can see various ways of chopping
them up into equal parts. You could either slice them with parallel
slices, like bread, or cut them from the centre, like pies. I'm
feeling hungry now...


-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From kidsmake6 at msn.com  Sun Feb  6 03:37:20 2011
From: kidsmake6 at msn.com (Brad Nesom)
Date: Sat, 5 Feb 2011 20:37:20 -0600
Subject: [R-sig-Geo] split polygons by percentage
In-Reply-To: <AANLkTikxXsEb3eXQpw85UBRpJqnM8R6RubRuCso8KJHE@mail.gmail.com>
References: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>
	<AANLkTikxXsEb3eXQpw85UBRpJqnM8R6RubRuCso8KJHE@mail.gmail.com>
Message-ID: <AANLkTikP_2RZDCXbEy-Cq+0OF_ijduMMSeX+ZSQO6ghr@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110205/52c7de2c/attachment.pl>

From a.lechner at uq.edu.au  Mon Feb  7 03:31:11 2011
From: a.lechner at uq.edu.au (Alex Lechner)
Date: Mon, 7 Feb 2011 12:31:11 +1000
Subject: [R-sig-Geo] Building a grid that incorporates distance measurement
Message-ID: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5C7@UQEXMB01.soe.uq.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110207/c541ef71/attachment.pl>

From a.lechner at uq.edu.au  Mon Feb  7 03:58:53 2011
From: a.lechner at uq.edu.au (Alex Lechner)
Date: Mon, 7 Feb 2011 12:58:53 +1000
Subject: [R-sig-Geo] Incorporating boundaries into kriging
Message-ID: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5CA@UQEXMB01.soe.uq.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110207/4c02ac84/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Feb  7 08:23:17 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 07 Feb 2011 08:23:17 +0100
Subject: [R-sig-Geo] Incorporating boundaries into kriging
In-Reply-To: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5CA@UQEXMB01.soe.uq.edu.au>
References: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5CA@UQEXMB01.soe.uq.edu.au>
Message-ID: <4D4F9DE5.1010000@uni-muenster.de>



On 02/07/2011 03:58 AM, Alex Lechner wrote:
> Hi,
> 
> I have a number of point measurements of soil electrical conductivity surrounding a large pond (see http://www.flickr.com/photos/32778961 at N04/5423900854/  ) which I am trying to create a kriged surface for. Is there any way of excluding distances across the pond in the variogram calculations (see http://www.flickr.com/photos/32778961 at N04/5423901056/ ).
> 
I guess with a lot of work -- using package rgeos, check every point
pair whether the line connecting them crosses the pond, then exclude
these pairs from the variogram cloud and bin them.

I'm not sure how much it would help you. You'd not be the first if in a
next step you'd like to krige and exclude points that cross the pond --
an action that can lead to very weird interpolation surfaces, because
points suddenly appear "visible" when turning around a corner.

Have you tried including a trend with distance to the pond?

> Thanks,
> 
> Alex Lechner
> 
> Research Fellow
> Centre for Mined Land Rehabilitation
> Sustainable Minerals Institute
> Level 5, Sir James Foots Building (47A)
> Cnr Staff House and College Roads
> University of Queensland
> ST LUCIA, QLD, 4072
> w: +61 (0)7 3346 4021
> m: +61 (0)401 233 019
> f: +61 7 3346 4056
> e: a.lechner at uq.edu.au
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Adrian.Baddeley at csiro.au  Mon Feb  7 08:22:57 2011
From: Adrian.Baddeley at csiro.au (Adrian Baddeley)
Date: Mon, 7 Feb 2011 15:22:57 +0800
Subject: [R-sig-Geo] [R-sig-geo] problem to convert a complex
 "SpatialPolygonsDataFrame" to owin
In-Reply-To: <mailman.15.1296903603.24484.r-sig-geo@r-project.org>
References: <mailman.15.1296903603.24484.r-sig-geo@r-project.org>
Message-ID: <4D4F9DD1.5020302@csiro.au>

gianni lavaredo <gianni.lavaredo at gmail.com> wrote on R-sig-geo:

>  I wish to convert a really complex  "SpatialPolygonsDataFrame" to owin using

>  MyMask<- readOGR(".", "Mask")
>  MyMask.owin<- as(MyMask, "owin")

>  but I get this error massage in the end

>  Errore in matrix(FALSE, npoly, npoly) : too many elements specified

This error is flagged by the package 'spatstat' which is attempting to check whether any pair of polygons is overlapping. Apparently there are so many polygons ('npoly') that the system can't create a logical matrix of size npoly * npoly. That is indeed a lot of polygons (e.g. my laptop will accept npoly = 25,000).

To avoid this error, you could try setting

           spatstat.options(checkpolygons=FALSE)

which will simply turn off the checking. Do this if you are confident that the polygons do not overlap.

Good luck!
Adrian Baddeley


From edzer.pebesma at uni-muenster.de  Mon Feb  7 08:35:38 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 07 Feb 2011 08:35:38 +0100
Subject: [R-sig-Geo] Building a grid that incorporates distance
	measurement
In-Reply-To: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5C7@UQEXMB01.soe.uq.edu.au>
References: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5C7@UQEXMB01.soe.uq.edu.au>
Message-ID: <4D4FA0CA.3010801@uni-muenster.de>

Alex,

your comments "does not work" are slightly self-centered - they do
"work" (at least for me), and do what they actually can do.

If you want a regular grid over an irregular polygon, you have to
provide spsample with such a polygon. The meuse data set does not come
with such a polygon - would indeed be nice to have an example. You can
use ?locator to digitize a polygon on-screen.

The "dist" values are obtained by evaluating, for each (observation and
prediction) point the distance to some feature - here the river Meuse.
To compute these, you need the target points, and the feature. The most
neat way would be to use the geometry functions in package rgeos, but a
good approximation would be just use many points of the feature (e.g.
generated by spsample) and then use spDists or spDistsN1.

Hth,

On 02/07/2011 03:31 AM, Alex Lechner wrote:
> Hello,
> 
> I am trying to do some Kriging incorporating a gradient trend in the data (i.e.  krige(log(zinc)~sqrt(dist),...) based on the method described in http://r-spatial.sourceforge.net/gallery/ and Bivand's book. I have been having problems with producing the appropriate grid with a format that incorporates distance. Just to make sure there are no errors in my own data I have utilised the "meuse" dataset and adapted the example in http://r-spatial.sourceforge.net/gallery/.
> 
> In the meuse dataset the grid is loaded with the data(meuse.grid). But I can't find a way that recreates the same data with the original meuse dataset. I have tried the following:
> 
> meuse.grid = spsample(meuse, type = "regular", cellsize = c(50,50))
> gridded(meuse.grid) = TRUE
> 
> and
> 
> meuse.grid <-SpatialPixels(SpatialPoints(makegrid(meuse)))
> gridded(meuse.grid) = TRUE
> 
> Neither of the above methods work when I use a Kriging function that incorporates distance (log(zinc)~sqrt(dist)). However they work if I use ordinary kriging with the function zinc~1. I also noticed that meuse.grid includes distance measurements.
> 
> CODE
> ====================
> 
> library(sp)
> library(gstat)
> 
> data(meuse)
> coordinates(meuse)=~x+y
> 
> #Original Method - only method that works
> data(meuse.grid)
> data_grid<-meuse.grid
> coordinates(data_grid) = ~x+y
> gridded(data_grid) = TRUE
> 
> #Method 2 - does not work
> #data_grid = spsample(meuse, type = "regular", cellsize = c(50,50))
> #gridded(data_grid) = TRUE
> 
> #Method 3 - does not work
> #data_grid<-SpatialPixels(SpatialPoints(makegrid(meuse)))
> #gridded(data_grid) = TRUE
> 
> v.uk = variogram(log(zinc)~sqrt(dist), meuse)
> uk.model = fit.variogram(v.uk, vgm(1, "Exp", 300, 1))
> 
> zn.uk = krige(log(zinc)~sqrt(dist), meuse, data_grid, model = uk.model)
> 
> print(spplot(zn.uk, "var1.pred"))
> 
> =========================
> 
> Thanks for the help,
> 
> Alex Lechner
> 
> Research Fellow
> Centre for Mined Land Rehabilitation
> Sustainable Minerals Institute
> University of Queensland
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From amonleong at wanadoo.es  Mon Feb  7 16:55:04 2011
From: amonleong at wanadoo.es (TM)
Date: Mon, 7 Feb 2011 16:55:04 +0100
Subject: [R-sig-Geo] bayesian kriging
Message-ID: <C4E200AD50B24014A84136561E19E59C@TM1>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110207/8c831071/attachment.pl>

From sisoliveira at gmail.com  Mon Feb  7 17:13:49 2011
From: sisoliveira at gmail.com (Sandra Oliveira)
Date: Mon, 7 Feb 2011 17:13:49 +0100
Subject: [R-sig-Geo] mtry in Random Forest
Message-ID: <AANLkTinV=gLqay5XE2uVMmCjNgzrS+iARjJ5NZOkX447@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110207/f5c31ee9/attachment.pl>

From piero.campa at gmail.com  Mon Feb  7 19:16:41 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 7 Feb 2011 10:16:41 -0800
Subject: [R-sig-Geo] how to do a principle component analysis with
 geo-referenced points
In-Reply-To: <832A948B92E5754D9062CCF62F9ED89222A3D0@xmail01.ad.ua.ac.be>
References: <1163301764.26351.275593342@webmail.messagingengine.com>
	<832A948B92E5754D9062CCF62F9ED89222A3D0@xmail01.ad.ua.ac.be>
Message-ID: <1297102601618-6001222.post@n2.nabble.com>


Hi list,
I'm applying a PCA to a georeferences set of variables.

As in "A practical Guide to geostatistical mapping" by Hengl, I'm using the
command "prcomp" in R.
To recover the georeference of the principal components (which could have
some NA) it is suggested to use the values available in the returned x data
of the PCA as mask over a grid, which would be the numeric vector of 3103
elements in the example here below (i.e. attr(pc.obj$x, "dimnames")[[1]]).

> str(pc.obj)
[...]
$x       : num [1:3103, 1:2] -1.56 -1.56 -1.52 -1.42 -1.56 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3103] "1" "2" "3" "4" ...
  .. ..$ : chr [1:2] "PC1" "PC2"
[...]

Everything works fine with the meuse dataset, but with my own data I could
not use the mask since the returned x data of the prcomp has weird values,
whose meaning I could not catch from the ?prcomp page:
$ : chr [1:1487] "2314165" "2314215" "2314265" "2314315" ...

The original dataset that fed the PCA has 1493 samples, hence the above
array should have values ranging from 1 to 1493, but it does not, as you can
see.

Any clues about this?
Regards,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-do-a-principle-component-analysis-with-geo-referenced-points-tp2762765p6001222.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Mon Feb  7 21:25:30 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 7 Feb 2011 21:25:30 +0100
Subject: [R-sig-Geo] listw for local Moran in spdep
Message-ID: <AANLkTi=zsq4PBRxi+4nQVREnq+CNRD0sVfcG++EZRNcV@mail.gmail.com>

Hi!

I'd like to run localmoran() from spdep on a small grid (matrix). Is
there a function to calculate the spatial weights (listw) from
the grid  (defining 3x3 neighborhoods)?

(BTW: the definition of LISA in the spdep manual is unformatted)

Thanks

Agus


From Roger.Bivand at nhh.no  Mon Feb  7 21:43:28 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 7 Feb 2011 21:43:28 +0100
Subject: [R-sig-Geo] listw for local Moran in spdep
In-Reply-To: <AANLkTi=zsq4PBRxi+4nQVREnq+CNRD0sVfcG++EZRNcV@mail.gmail.com>
References: <AANLkTi=zsq4PBRxi+4nQVREnq+CNRD0sVfcG++EZRNcV@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1102072139260.16849@reclus.nhh.no>

On Mon, 7 Feb 2011, Agustin Lobo wrote:

> Hi!
>
> I'd like to run localmoran() from spdep on a small grid (matrix). Is
> there a function to calculate the spatial weights (listw) from
> the grid  (defining 3x3 neighborhoods)?

For a 3x3 neighbourhood on a grid simply defined by numbers of rows and 
columnd, see ?cell2nb. Otherwise, use dnearneigh() with the threshold set 
to the length of the diagonal distance between cell centres giving the 
cell centre coordinates as input.

>
> (BTW: the definition of LISA in the spdep manual is unformatted)
>

The LaTeX version looks fine! I'll try to repair the regular page.

Roger

> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From a.lechner at uq.edu.au  Tue Feb  8 08:36:41 2011
From: a.lechner at uq.edu.au (Alex Lechner)
Date: Tue, 8 Feb 2011 17:36:41 +1000
Subject: [R-sig-Geo] FW:  Incorporating boundaries into kriging
Message-ID: <E3876D38ECEF0E4A96FE267CE453364BB750E5A667@UQEXMB01.soe.uq.edu.au>

Thanks for the help.

I am in the process of including a trend with distance to the pond.

Alex

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: Monday, 7 February 2011 5:23 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Incorporating boundaries into kriging



On 02/07/2011 03:58 AM, Alex Lechner wrote:
> Hi,
> 
> I have a number of point measurements of soil electrical conductivity surrounding a large pond (see http://www.flickr.com/photos/32778961 at N04/5423900854/  ) which I am trying to create a kriged surface for. Is there any way of excluding distances across the pond in the variogram calculations (see http://www.flickr.com/photos/32778961 at N04/5423901056/ ).
> 
I guess with a lot of work -- using package rgeos, check every point
pair whether the line connecting them crosses the pond, then exclude
these pairs from the variogram cloud and bin them.

I'm not sure how much it would help you. You'd not be the first if in a
next step you'd like to krige and exclude points that cross the pond --
an action that can lead to very weird interpolation surfaces, because
points suddenly appear "visible" when turning around a corner.

Have you tried including a trend with distance to the pond?

> Thanks,
> 
> Alex Lechner
> 
> Research Fellow
> Centre for Mined Land Rehabilitation
> Sustainable Minerals Institute
> Level 5, Sir James Foots Building (47A)
> Cnr Staff House and College Roads
> University of Queensland
> ST LUCIA, QLD, 4072
> w: +61 (0)7 3346 4021
> m: +61 (0)401 233 019
> f: +61 7 3346 4056
> e: a.lechner at uq.edu.au
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From pierre.roudier at gmail.com  Tue Feb  8 08:38:51 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Tue, 8 Feb 2011 20:38:51 +1300
Subject: [R-sig-Geo] Incorporating boundaries into kriging
In-Reply-To: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5CA@UQEXMB01.soe.uq.edu.au>
References: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5CA@UQEXMB01.soe.uq.edu.au>
Message-ID: <AANLkTikSF3xmGS_xE7RSQFRF-6PjZ9_G=5xPfzC29-yE@mail.gmail.com>

Alex,

You may be interested by the following thread:
http://r-sig-geo.2731867.n2.nabble.com/kriging-as-fish-swim-not-as-crows-fly-td4465811.html

I'm wondering if anybody here has any experience with the "soap film"
interpolations suggested in the discussion below?

HTH,

Pierre

2011/2/7 Alex Lechner <a.lechner at uq.edu.au>:
> Hi,
>
> I have a number of point measurements of soil electrical conductivity surrounding a large pond (see http://www.flickr.com/photos/32778961 at N04/5423900854/ ?) which I am trying to create a kriged surface for. Is there any way of excluding distances across the pond in the variogram calculations (see http://www.flickr.com/photos/32778961 at N04/5423901056/ ).
>
> Thanks,
>
> Alex Lechner
>
> Research Fellow
> Centre for Mined Land Rehabilitation
> Sustainable Minerals Institute
> Level 5, Sir James Foots Building (47A)
> Cnr Staff House and College Roads
> University of Queensland
> ST LUCIA, QLD, 4072
> w: +61 (0)7 3346 4021
> m: +61 (0)401 233 019
> f: +61 7 3346 4056
> e: a.lechner at uq.edu.au
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From sisoliveira at gmail.com  Tue Feb  8 09:29:38 2011
From: sisoliveira at gmail.com (Sandra Oliveira)
Date: Tue, 8 Feb 2011 09:29:38 +0100
Subject: [R-sig-Geo] mtry in Random Forest
In-Reply-To: <AANLkTinV=gLqay5XE2uVMmCjNgzrS+iARjJ5NZOkX447@mail.gmail.com>
References: <AANLkTinV=gLqay5XE2uVMmCjNgzrS+iARjJ5NZOkX447@mail.gmail.com>
Message-ID: <AANLkTin=r5TGWPv7csY50D44xGo=7oye6FP-dJ4Uib6P@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/abfbd0a9/attachment.pl>

From aruminat at gmail.com  Tue Feb  8 09:32:56 2011
From: aruminat at gmail.com (Susumu Tanimura)
Date: Tue, 8 Feb 2011 17:32:56 +0900
Subject: [R-sig-Geo] Rshhs() import problem again
Message-ID: <20110208173256.089c9038.aruminat@gmail.com>

Hi there,

The current version of gshhs data has trouble for importing with
Rshhs().

The data was downloaded from
ftp://ftp.soest.hawaii.edu/pwessel/gshhs/gshhs_2.1.0.tbz, and the
following error was given with Rsshs().

> library(maptools)
> gpclibPermit()
> require(gpclib)
> NZx <- c(160,180)
> NZy <- c(-50,-30)
> NZ <- Rgshhs("gshhs/gshhs_c.b", xlim=NZx, ylim=NZy)
Error in Rgshhs("gshhs/gshhs_c.b", xlim = NZx, ylim = NZy) : 
  Data not same version as software

In addition, readShapeSpatial() sometimes does not work for the
shapefile version of gshhs. The shapefile version is available at
ftp://ftp.soest.hawaii.edu/pwessel/gshhs/GSHHS_shp_2.1.0.zip

> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L4")
Error in shp.lst[[i]] : subscript out of bounds
> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L3")
> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L2")
> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L1")
Error in Polygon(coords = crds) : ring not closed
> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L4")
> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L3")
> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L2")
Error in Polygon(coords = crds) : ring not closed
> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L1")
Error in Polygon(coords = crds) : ring not closed

I guess there something wrong in the shapefile format of gshhs.

> sessionInfo()
R version 2.12.1 (2010-12-16)
Platform: i686-pc-linux-gnu (32-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] gpclib_1.5-1    maptools_0.7-38 lattice_0.19-17 sp_0.9-76      
[5] foreign_0.8-41 

loaded via a namespace (and not attached):
[1] grid_2.12.1
Warning message:
'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible 

Cheers,

--
Susumu Tanimura


From Roger.Bivand at nhh.no  Tue Feb  8 09:44:51 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 Feb 2011 09:44:51 +0100
Subject: [R-sig-Geo] Rshhs() import problem again
In-Reply-To: <20110208173256.089c9038.aruminat@gmail.com>
References: <20110208173256.089c9038.aruminat@gmail.com>
Message-ID: <alpine.LRH.2.00.1102080941200.18928@reclus.nhh.no>

On Tue, 8 Feb 2011, Susumu Tanimura wrote:

> Hi there,
>
> The current version of gshhs data has trouble for importing with
> Rshhs().
>
> The data was downloaded from
> ftp://ftp.soest.hawaii.edu/pwessel/gshhs/gshhs_2.1.0.tbz, and the
> following error was given with Rsshs().
>
>> library(maptools)
>> gpclibPermit()
>> require(gpclib)
>> NZx <- c(160,180)
>> NZy <- c(-50,-30)
>> NZ <- Rgshhs("gshhs/gshhs_c.b", xlim=NZx, ylim=NZy)
> Error in Rgshhs("gshhs/gshhs_c.b", xlim = NZx, ylim = NZy) :
>  Data not same version as software

Please try the pre-release version 0.8-2 from R-forge:

https://r-forge.r-project.org/R/?group_id=943

or:

install.packages("maptools", repos="http://R-Forge.R-project.org")

which should work with the latest GSHHS files.

>
> In addition, readShapeSpatial() sometimes does not work for the
> shapefile version of gshhs. The shapefile version is available at
> ftp://ftp.soest.hawaii.edu/pwessel/gshhs/GSHHS_shp_2.1.0.zip
>
>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L4")
> Error in shp.lst[[i]] : subscript out of bounds
>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L3")
>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L2")
>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L1")
> Error in Polygon(coords = crds) : ring not closed
>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L4")
>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L3")
>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L2")
> Error in Polygon(coords = crds) : ring not closed
>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L1")
> Error in Polygon(coords = crds) : ring not closed
>
> I guess there something wrong in the shapefile format of gshhs.
>

Do the same errors occur with readOGR() in rgdal? I have not downloaded 
the GSHHS shapefiles, but will if you cannot check.

Best wishes,

Roger

>> sessionInfo()
> R version 2.12.1 (2010-12-16)
> Platform: i686-pc-linux-gnu (32-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] gpclib_1.5-1    maptools_0.7-38 lattice_0.19-17 sp_0.9-76
> [5] foreign_0.8-41
>
> loaded via a namespace (and not attached):
> [1] grid_2.12.1
> Warning message:
> 'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible
>
> Cheers,
>
> --
> Susumu Tanimura
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From aruminat at gmail.com  Tue Feb  8 10:15:28 2011
From: aruminat at gmail.com (Susumu Tanimura)
Date: Tue, 8 Feb 2011 18:15:28 +0900
Subject: [R-sig-Geo] Rshhs() import problem again
In-Reply-To: <alpine.LRH.2.00.1102080941200.18928@reclus.nhh.no>
References: <20110208173256.089c9038.aruminat@gmail.com>
	<alpine.LRH.2.00.1102080941200.18928@reclus.nhh.no>
Message-ID: <20110208181528.6a146b0d.aruminat@gmail.com>

Dear Roger,

Thank you for your usual support. Yes, you are definitely right. I
should have checked r-forge before reporting the problem.

On Tue, 8 Feb 2011 09:44:51 +0100 (CET)
Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 8 Feb 2011, Susumu Tanimura wrote:
> 
> > Hi there,
> >
> > The current version of gshhs data has trouble for importing with
> > Rshhs().
> >
> > The data was downloaded from
> > ftp://ftp.soest.hawaii.edu/pwessel/gshhs/gshhs_2.1.0.tbz, and the
> > following error was given with Rsshs().
> >
> >> library(maptools)
> >> gpclibPermit()
> >> require(gpclib)
> >> NZx <- c(160,180)
> >> NZy <- c(-50,-30)
> >> NZ <- Rgshhs("gshhs/gshhs_c.b", xlim=NZx, ylim=NZy)
> > Error in Rgshhs("gshhs/gshhs_c.b", xlim = NZx, ylim = NZy) :
> >  Data not same version as software
> 
> Please try the pre-release version 0.8-2 from R-forge:
> 
> https://r-forge.r-project.org/R/?group_id=943
> 
> or:
> 
> install.packages("maptools", repos="http://R-Forge.R-project.org")
> 
> which should work with the latest GSHHS files.
> 
> >
> > In addition, readShapeSpatial() sometimes does not work for the
> > shapefile version of gshhs. The shapefile version is available at
> > ftp://ftp.soest.hawaii.edu/pwessel/gshhs/GSHHS_shp_2.1.0.zip
> >
> >> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L4")
> > Error in shp.lst[[i]] : subscript out of bounds
> >> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L3")
> >> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L2")
> >> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L1")
> > Error in Polygon(coords = crds) : ring not closed
> >> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L4")
> >> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L3")
> >> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L2")
> > Error in Polygon(coords = crds) : ring not closed
> >> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L1")
> > Error in Polygon(coords = crds) : ring not closed
> >
> > I guess there something wrong in the shapefile format of gshhs.
> >
> 
> Do the same errors occur with readOGR() in rgdal? I have not downloaded 
> the GSHHS shapefiles, but will if you cannot check.

Yes, you are right. I should try them with rgdal package. The result was
that the errors occurred with problematic shapefiles.

> ogrInfo("GSHHS_shp/c/","GSHHS_c_L4")
Error in ogrInfo("GSHHS_shp/c/", "GSHHS_c_L4") : Multiple # dimensions: 
> M <- readOGR("GSHHS_shp/c/","GSHHS_c_L4")
Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) : 
  Multiple # dimensions: 
> ogrInfo("GSHHS_shp/c/","GSHHS_c_L1")
Source: "GSHHS_shp/c/", layer: "GSHHS_c_L1"
Driver: ESRI Shapefile number of rows 790 
Feature type: wkbPolygon with 2 dimensions
+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs  
Number of fields: 6 
        name type length typeName
1         id    4     80   String
2      level    2     11     Real
3     source    4     80   String
4  parent_id    2     11     Real
5 sibling_id    2     11     Real
6       area    2     24     Real
> M <- readOGR("GSHHS_shp/c/","GSHHS_c_L1")
OGR data source with driver: ESRI Shapefile 
Source: "GSHHS_shp/c/", layer: "GSHHS_c_L1"
with 790 features and 6 fields
Feature type: wkbPolygon with 2 dimensions
Error in is.vector(X) : ring not closed
> ogrInfo("GSHHS_shp/f/","GSHHS_f_L2")
Source: "GSHHS_shp/f/", layer: "GSHHS_f_L2"
Driver: ESRI Shapefile number of rows 6647 
Feature type: wkbPolygon with 2 dimensions
+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs  
Number of fields: 6 
        name type length typeName
1         id    4     80   String
2      level    2     11     Real
3     source    4     80   String
4  parent_id    2     11     Real
5 sibling_id    2     11     Real
6       area    2     24     Real
> M <- readOGR("GSHHS_shp/f/","GSHHS_f_L2")
OGR data source with driver: ESRI Shapefile 
Source: "GSHHS_shp/f/", layer: "GSHHS_f_L2"
with 6647 features and 6 fields
Feature type: wkbPolygon with 2 dimensions
Error in is.vector(X) : ring not closed
> ogrInfo("GSHHS_shp/f/","GSHHS_f_L1")
Source: "GSHHS_shp/f/", layer: "GSHHS_f_L1"
Driver: ESRI Shapefile number of rows 180497 
Feature type: wkbPolygon with 2 dimensions
+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs  
Number of fields: 6 
        name type length typeName
1         id    4     80   String
2      level    2     11     Real
3     source    4     80   String
4  parent_id    2     11     Real
5 sibling_id    2     11     Real
6       area    2     24     Real
> M <- readOGR("GSHHS_shp/f/","GSHHS_f_L1")
OGR data source with driver: ESRI Shapefile 
Source: "GSHHS_shp/f/", layer: "GSHHS_f_L1"
with 180497 features and 6 fields
Feature type: wkbPolygon with 2 dimensions
Error in is.vector(X) : ring not closed

Since this trial is merely from my curiosity, I give up the further
examination. But thank you very much for the comments.

Best wishes,

--
Susumu


From alobolistas at gmail.com  Tue Feb  8 10:35:41 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 8 Feb 2011 10:35:41 +0100
Subject: [R-sig-Geo] listw for local Moran in spdep
In-Reply-To: <alpine.LRH.2.00.1102072139260.16849@reclus.nhh.no>
References: <AANLkTi=zsq4PBRxi+4nQVREnq+CNRD0sVfcG++EZRNcV@mail.gmail.com>
	<alpine.LRH.2.00.1102072139260.16849@reclus.nhh.no>
Message-ID: <AANLkTiksXS39HX-s5S=o5=1kgM4bMrvYdJMLwtr+Ohmx@mail.gmail.com>

Thanks. I have problems to understand the order in which I have to
input the data from the matrix.
This is what I'm doing:

require(spdep)
gpclibPermit()
require(ncf)
#data
x <- expand.grid(1:20, 1:5)[,1]
y <- expand.grid(1:20, 1:5)[,2]
zori <- rmvn.spa(x=x, y=y, p=2, method="exp")
z = scale(zori)
dim(z)=c(20,5)
z = t(z)[5:1,]
rz = raster(z)

#weights
wrz = cell2nb(nrow=nrow(rz), ncol=ncol(rz), type="queen", torus=FALSE)
#lisa
lisarz = localmoran(x=rz at data@values, listw=nb2listw(wrz))

(but I do not know if the ordering of the data x and the weights listw
are matching)

l3r = lisarz[,1]
dim(l3r)=c(20,5)
l3r = t(l3r)[5:1,]
l3r = raster(l3r)
plot(l3r)



Agus

2011/2/7 Roger Bivand <Roger.Bivand at nhh.no>:
> On Mon, 7 Feb 2011, Agustin Lobo wrote:
>
>> Hi!
>>
>> I'd like to run localmoran() from spdep on a small grid (matrix). Is
>> there a function to calculate the spatial weights (listw) from
>> the grid ?(defining 3x3 neighborhoods)?
>
> For a 3x3 neighbourhood on a grid simply defined by numbers of rows and
> columnd, see ?cell2nb. Otherwise, use dnearneigh() with the threshold set to
> the length of the diagonal distance between cell centres giving the cell
> centre coordinates as input.
>
>>
>> (BTW: the definition of LISA in the spdep manual is unformatted)
>>
>
> The LaTeX version looks fine! I'll try to repair the regular page.
>
> Roger
>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Tue Feb  8 11:30:55 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 Feb 2011 11:30:55 +0100
Subject: [R-sig-Geo] Rshhs() import problem again
In-Reply-To: <20110208181528.6a146b0d.aruminat@gmail.com>
References: <20110208173256.089c9038.aruminat@gmail.com>
	<alpine.LRH.2.00.1102080941200.18928@reclus.nhh.no>
	<20110208181528.6a146b0d.aruminat@gmail.com>
Message-ID: <alpine.LRH.2.00.1102081128500.19684@reclus.nhh.no>

On Tue, 8 Feb 2011, Susumu Tanimura wrote:

> Dear Roger,
>
> Thank you for your usual support. Yes, you are definitely right. I
> should have checked r-forge before reporting the problem.

Because the 0.8-* release of maptools is ready for rgeos, and rgeos isn't 
yet on CRAN, there is a little slippage. As soon as rgeos gets to CRAN, 
the fresh release of maptools will follow.

Roger

>
> On Tue, 8 Feb 2011 09:44:51 +0100 (CET)
> Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 8 Feb 2011, Susumu Tanimura wrote:
>>
>>> Hi there,
>>>
>>> The current version of gshhs data has trouble for importing with
>>> Rshhs().
>>>
>>> The data was downloaded from
>>> ftp://ftp.soest.hawaii.edu/pwessel/gshhs/gshhs_2.1.0.tbz, and the
>>> following error was given with Rsshs().
>>>
>>>> library(maptools)
>>>> gpclibPermit()
>>>> require(gpclib)
>>>> NZx <- c(160,180)
>>>> NZy <- c(-50,-30)
>>>> NZ <- Rgshhs("gshhs/gshhs_c.b", xlim=NZx, ylim=NZy)
>>> Error in Rgshhs("gshhs/gshhs_c.b", xlim = NZx, ylim = NZy) :
>>>  Data not same version as software
>>
>> Please try the pre-release version 0.8-2 from R-forge:
>>
>> https://r-forge.r-project.org/R/?group_id=943
>>
>> or:
>>
>> install.packages("maptools", repos="http://R-Forge.R-project.org")
>>
>> which should work with the latest GSHHS files.
>>
>>>
>>> In addition, readShapeSpatial() sometimes does not work for the
>>> shapefile version of gshhs. The shapefile version is available at
>>> ftp://ftp.soest.hawaii.edu/pwessel/gshhs/GSHHS_shp_2.1.0.zip
>>>
>>>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L4")
>>> Error in shp.lst[[i]] : subscript out of bounds
>>>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L3")
>>>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L2")
>>>> M <- readShapeSpatial("GSHHS_shp/c/GSHHS_c_L1")
>>> Error in Polygon(coords = crds) : ring not closed
>>>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L4")
>>>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L3")
>>>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L2")
>>> Error in Polygon(coords = crds) : ring not closed
>>>> M <- readShapeSpatial("GSHHS_shp/f/GSHHS_f_L1")
>>> Error in Polygon(coords = crds) : ring not closed
>>>
>>> I guess there something wrong in the shapefile format of gshhs.
>>>
>>
>> Do the same errors occur with readOGR() in rgdal? I have not downloaded
>> the GSHHS shapefiles, but will if you cannot check.
>
> Yes, you are right. I should try them with rgdal package. The result was
> that the errors occurred with problematic shapefiles.
>
>> ogrInfo("GSHHS_shp/c/","GSHHS_c_L4")
> Error in ogrInfo("GSHHS_shp/c/", "GSHHS_c_L4") : Multiple # dimensions:
>> M <- readOGR("GSHHS_shp/c/","GSHHS_c_L4")
> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) :
>  Multiple # dimensions:
>> ogrInfo("GSHHS_shp/c/","GSHHS_c_L1")
> Source: "GSHHS_shp/c/", layer: "GSHHS_c_L1"
> Driver: ESRI Shapefile number of rows 790
> Feature type: wkbPolygon with 2 dimensions
> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> Number of fields: 6
>        name type length typeName
> 1         id    4     80   String
> 2      level    2     11     Real
> 3     source    4     80   String
> 4  parent_id    2     11     Real
> 5 sibling_id    2     11     Real
> 6       area    2     24     Real
>> M <- readOGR("GSHHS_shp/c/","GSHHS_c_L1")
> OGR data source with driver: ESRI Shapefile
> Source: "GSHHS_shp/c/", layer: "GSHHS_c_L1"
> with 790 features and 6 fields
> Feature type: wkbPolygon with 2 dimensions
> Error in is.vector(X) : ring not closed
>> ogrInfo("GSHHS_shp/f/","GSHHS_f_L2")
> Source: "GSHHS_shp/f/", layer: "GSHHS_f_L2"
> Driver: ESRI Shapefile number of rows 6647
> Feature type: wkbPolygon with 2 dimensions
> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> Number of fields: 6
>        name type length typeName
> 1         id    4     80   String
> 2      level    2     11     Real
> 3     source    4     80   String
> 4  parent_id    2     11     Real
> 5 sibling_id    2     11     Real
> 6       area    2     24     Real
>> M <- readOGR("GSHHS_shp/f/","GSHHS_f_L2")
> OGR data source with driver: ESRI Shapefile
> Source: "GSHHS_shp/f/", layer: "GSHHS_f_L2"
> with 6647 features and 6 fields
> Feature type: wkbPolygon with 2 dimensions
> Error in is.vector(X) : ring not closed
>> ogrInfo("GSHHS_shp/f/","GSHHS_f_L1")
> Source: "GSHHS_shp/f/", layer: "GSHHS_f_L1"
> Driver: ESRI Shapefile number of rows 180497
> Feature type: wkbPolygon with 2 dimensions
> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> Number of fields: 6
>        name type length typeName
> 1         id    4     80   String
> 2      level    2     11     Real
> 3     source    4     80   String
> 4  parent_id    2     11     Real
> 5 sibling_id    2     11     Real
> 6       area    2     24     Real
>> M <- readOGR("GSHHS_shp/f/","GSHHS_f_L1")
> OGR data source with driver: ESRI Shapefile
> Source: "GSHHS_shp/f/", layer: "GSHHS_f_L1"
> with 180497 features and 6 fields
> Feature type: wkbPolygon with 2 dimensions
> Error in is.vector(X) : ring not closed
>
> Since this trial is merely from my curiosity, I give up the further
> examination. But thank you very much for the comments.
>
> Best wishes,
>
> --
> Susumu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From amonleong at wanadoo.es  Tue Feb  8 12:57:40 2011
From: amonleong at wanadoo.es (TM)
Date: Tue, 8 Feb 2011 12:57:40 +0100
Subject: [R-sig-Geo] kriging and cokriging  with multiple covariate
Message-ID: <7FD8CDD6317D473F9246725989709B5B@TM1>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/52e9a0e3/attachment.pl>

From finleya at msu.edu  Tue Feb  8 13:09:07 2011
From: finleya at msu.edu (Andrew Finley)
Date: Tue, 08 Feb 2011 07:09:07 -0500
Subject: [R-sig-Geo] kriging and cokriging  with multiple covariate
In-Reply-To: <7FD8CDD6317D473F9246725989709B5B@TM1>
References: <7FD8CDD6317D473F9246725989709B5B@TM1>
Message-ID: <20110208070907.19067d31w2s0exr7@mail.msu.edu>

Hi Toni,
Check out the spMvLM function in the spBayes package (or spMvGLM  
depending on your outcome variable), there are also some illustrative  
slides and examples toward the bottom of this page  
http://blue.for.msu.edu/JBC_10/SC .
Let me know if you have any questions-
Andy

Quoting TM <amonleong at wanadoo.es>:

> Hi all,
>
> I'm trying to model some ecological data of an area to predict  
> spatially some ecological response variable  in terms of x, y, and  
> some covariates have been measured. The problem is that some of the  
> covariates are discrete (ordinal) and do not really know how to make  
> a cokriging with multiple covariates.
>
> Bayesian cokriging or perhaps a transformation based on a mixed  
> distance as the Gower?
>
> Any idea? I add below a R code with some of the data, the covariates  
> and the response variable.
>
> How  can I do a Cross-validation with used data  to determine  
> whether the estimated model fits well?
>
> Thank you very much in advance.
>
> Toni
> Department of Statistics
> University of Barcelona
>
> ###########################################################################################################
> ############################         kriging and cokriging  with  
> multiple covariate      ##########################################
> ###########################################################################################################
> ###########################################################################################################
> ###########################################################################################################
>
> data_example<-structure(list(x = c(430234, 429626, 413104, 456047,  
> 475226, 422256, 446443, 456281, 433773, 404269),
> y = c(4588887, 4579902, 4574398, 4621071, 4610062, 4587858, 4609701,  
> 4617064, 4600892, 4575527, 4587229, 4620543),
> var1 =c(1287, 131, 91, 21, 5, 311, 22, 57, 1252, 113),
> var2 =c(39.26, 68.13, 36.42, 16.06, 46.75, 34.19, 56.87, 31.04,  
> 35.19, 15.40),
> var3 =c(3, 9, 1, 1, 2, 1, 10, 2, 11, 1),
> var4 =c(1, 3, 1, 1, 1, 1, 3, 1, 1, 1),
> var5 =c(0.41, 0.89, 0.77, 0.29, 0.93, 0.31, 0.94, 0.84, 0.80, 0.60),
> var6 =c(4.02, 8.63, 6.08, 2.60, 8.64, 3.81, 7.65, 5.81, 4.31, 2.13),
> var7 =c(1.07, 1.12, 1.08, 1.10, 1.07, 1.15, 1.08, 1.07, 1.08, 1.05)),
> .Names = c("x", "y", "Cov1", "Cov2",  "Cov3", "Cov4", "Cov5",  
> "Response", "Cov6" ), class = "data.frame", row.names = c("1", "2",  
> "3", "4", "5", "6", "7", "8", "9", "10"))
>
>
> library(gstat)
> data(data_example)
> attach(data_example)
>
> # Ordinary Kriging in gstat
>
> # compute experimental variogram
> v <- variogram(response~1, ~ x+y, data_example)
> # estimated model
> m <- vgm(1.4, "Sph", 12000, 0.5)
> # fitted model
> m.f <- fit.variogram(v, m)
>
> new.locs <- data.frame(
> x = c(430334, 429726, 413204, 456147, 475326, 422356, 446543,  
> 456381, 433873, 404369, 422732),
>  y = c(4588987, 4571002, 4574498, 4621171, 4610162, 4587958,  
> 4609801, 4617164, 4600992, 4575627, 4587329))
>
> kr <- krige(response~ 1, loc=~ x+y, data=data_example,  
> newdata=new.locs, model=m.f)
>
>
> library (lattice)
> # visualize interpolation; note aspect option to get correct geometry
> levelplot(var1.pred ~ x+y, kr)
> # visualize prediction error
> levelplot(var1.var ~ x+y, data=kr,col.regions=terrain.colors(40))
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From amonleong at wanadoo.es  Tue Feb  8 13:25:44 2011
From: amonleong at wanadoo.es (TM)
Date: Tue, 8 Feb 2011 13:25:44 +0100
Subject: [R-sig-Geo] kriging and cokriging  with multiple covariate
In-Reply-To: <20110208070907.19067d31w2s0exr7@mail.msu.edu>
References: <7FD8CDD6317D473F9246725989709B5B@TM1>
	<20110208070907.19067d31w2s0exr7@mail.msu.edu>
Message-ID: <AF138F5E24444DE3BA66038E2AC9AA46@TM1>

Dear Andrew,

Thank you very much

Toni


----- Original Message ----- 
From: "Andrew Finley" <finleya at msu.edu>
To: "TM" <amonleong at wanadoo.es>
Cc: <r-sig-geo at r-project.org>
Sent: Tuesday, February 08, 2011 1:09 PM
Subject: Re: [R-sig-Geo] kriging and cokriging with multiple covariate


> Hi Toni,
> Check out the spMvLM function in the spBayes package (or spMvGLM 
> depending on your outcome variable), there are also some illustrative 
> slides and examples toward the bottom of this page 
> http://blue.for.msu.edu/JBC_10/SC .
> Let me know if you have any questions-
> Andy
>
> Quoting TM <amonleong at wanadoo.es>:
>
>> Hi all,
>>
>> I'm trying to model some ecological data of an area to predict  spatially 
>> some ecological response variable  in terms of x, y, and  some covariates 
>> have been measured. The problem is that some of the  covariates are 
>> discrete (ordinal) and do not really know how to make  a cokriging with 
>> multiple covariates.
>>
>> Bayesian cokriging or perhaps a transformation based on a mixed  distance 
>> as the Gower?
>>
>> Any idea? I add below a R code with some of the data, the covariates  and 
>> the response variable.
>>
>> How  can I do a Cross-validation with used data  to determine  whether 
>> the estimated model fits well?
>>
>> Thank you very much in advance.
>>
>> Toni
>> Department of Statistics
>> University of Barcelona
>>
>> ###########################################################################################################
>> ############################         kriging and cokriging  with 
>> multiple covariate      ##########################################
>> ###########################################################################################################
>> ###########################################################################################################
>> ###########################################################################################################
>>
>> data_example<-structure(list(x = c(430234, 429626, 413104, 456047, 
>> 475226, 422256, 446443, 456281, 433773, 404269),
>> y = c(4588887, 4579902, 4574398, 4621071, 4610062, 4587858, 4609701, 
>> 4617064, 4600892, 4575527, 4587229, 4620543),
>> var1 =c(1287, 131, 91, 21, 5, 311, 22, 57, 1252, 113),
>> var2 =c(39.26, 68.13, 36.42, 16.06, 46.75, 34.19, 56.87, 31.04,  35.19, 
>> 15.40),
>> var3 =c(3, 9, 1, 1, 2, 1, 10, 2, 11, 1),
>> var4 =c(1, 3, 1, 1, 1, 1, 3, 1, 1, 1),
>> var5 =c(0.41, 0.89, 0.77, 0.29, 0.93, 0.31, 0.94, 0.84, 0.80, 0.60),
>> var6 =c(4.02, 8.63, 6.08, 2.60, 8.64, 3.81, 7.65, 5.81, 4.31, 2.13),
>> var7 =c(1.07, 1.12, 1.08, 1.10, 1.07, 1.15, 1.08, 1.07, 1.08, 1.05)),
>> .Names = c("x", "y", "Cov1", "Cov2",  "Cov3", "Cov4", "Cov5", 
>> "Response", "Cov6" ), class = "data.frame", row.names = c("1", "2",  "3", 
>> "4", "5", "6", "7", "8", "9", "10"))
>>
>>
>> library(gstat)
>> data(data_example)
>> attach(data_example)
>>
>> # Ordinary Kriging in gstat
>>
>> # compute experimental variogram
>> v <- variogram(response~1, ~ x+y, data_example)
>> # estimated model
>> m <- vgm(1.4, "Sph", 12000, 0.5)
>> # fitted model
>> m.f <- fit.variogram(v, m)
>>
>> new.locs <- data.frame(
>> x = c(430334, 429726, 413204, 456147, 475326, 422356, 446543,  456381, 
>> 433873, 404369, 422732),
>>  y = c(4588987, 4571002, 4574498, 4621171, 4610162, 4587958,  4609801, 
>> 4617164, 4600992, 4575627, 4587329))
>>
>> kr <- krige(response~ 1, loc=~ x+y, data=data_example,  newdata=new.locs, 
>> model=m.f)
>>
>>
>> library (lattice)
>> # visualize interpolation; note aspect option to get correct geometry
>> levelplot(var1.pred ~ x+y, kr)
>> # visualize prediction error
>> levelplot(var1.var ~ x+y, data=kr,col.regions=terrain.colors(40))
>>
>>
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>


From tghoward at gw.dec.state.ny.us  Tue Feb  8 13:33:25 2011
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Tue, 08 Feb 2011 07:33:25 -0500
Subject: [R-sig-Geo] mtry in Random Forest
In-Reply-To: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
References: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
Message-ID: <4D50F1C5020000D500045E41@gwsmtp.dec.state.ny.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/902b689b/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb  8 14:29:10 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 Feb 2011 14:29:10 +0100
Subject: [R-sig-Geo] listw for local Moran in spdep
In-Reply-To: <AANLkTiksXS39HX-s5S=o5=1kgM4bMrvYdJMLwtr+Ohmx@mail.gmail.com>
References: <AANLkTi=zsq4PBRxi+4nQVREnq+CNRD0sVfcG++EZRNcV@mail.gmail.com>
	<alpine.LRH.2.00.1102072139260.16849@reclus.nhh.no>
	<AANLkTiksXS39HX-s5S=o5=1kgM4bMrvYdJMLwtr+Ohmx@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1102081415400.19684@reclus.nhh.no>

On Tue, 8 Feb 2011, Agustin Lobo wrote:

> Thanks. I have problems to understand the order in which I have to
> input the data from the matrix.
> This is what I'm doing:
>
> require(spdep)
> gpclibPermit()
> require(ncf)
> #data
> x <- expand.grid(1:20, 1:5)[,1]
> y <- expand.grid(1:20, 1:5)[,2]
> zori <- rmvn.spa(x=x, y=y, p=2, method="exp")
> z = scale(zori)
> dim(z)=c(20,5)
> z = t(z)[5:1,]
> rz = raster(z)
>
> #weights
> wrz = cell2nb(nrow=nrow(rz), ncol=ncol(rz), type="queen", torus=FALSE)
> #lisa
> lisarz = localmoran(x=rz at data@values, listw=nb2listw(wrz))
>
> (but I do not know if the ordering of the data x and the weights listw
> are matching)

Most of the use examples of cell2nb() are that one generates the nb object 
first to use in studying the properties of tests and estimators, because a 
grid on a torus has no edge effects. The positions are encoded in the 
"region.id" attribute of the nb object - the example in ?cell2nb shows 
their decoding to retreive coordinates corresponding to your case.

As I suggested, use rather dnearneigh:

require(spdep)
require(ncf)
xy <- expand.grid(x=1:20, y=1:5)
zori <- rmvn.spa(x=x, y=y, p=2, method="exp")
xy$z <- scale(zori)
coordinates(xy) <- c("x", "y")
wrz <- dnearneigh(xy, 0, sqrt(2))
wrz
lisarz = localmoran(x=xy$z, listw=nb2listw(wrz))
str(lisarz)

I'm assuming that rmvn.spa() outputs the vector in the correct order.

Roger



>
> l3r = lisarz[,1]
> dim(l3r)=c(20,5)
> l3r = t(l3r)[5:1,]
> l3r = raster(l3r)
> plot(l3r)
>
>
>
> Agus
>
> 2011/2/7 Roger Bivand <Roger.Bivand at nhh.no>:
>> On Mon, 7 Feb 2011, Agustin Lobo wrote:
>>
>>> Hi!
>>>
>>> I'd like to run localmoran() from spdep on a small grid (matrix). Is
>>> there a function to calculate the spatial weights (listw) from
>>> the grid ?(defining 3x3 neighborhoods)?
>>
>> For a 3x3 neighbourhood on a grid simply defined by numbers of rows and
>> columnd, see ?cell2nb. Otherwise, use dnearneigh() with the threshold set to
>> the length of the diagonal distance between cell centres giving the cell
>> centre coordinates as input.
>>
>>>
>>> (BTW: the definition of LISA in the spdep manual is unformatted)
>>>
>>
>> The LaTeX version looks fine! I'll try to repair the regular page.
>>
>> Roger
>>
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From aechazarra at yahoo.com  Tue Feb  8 17:00:20 2011
From: aechazarra at yahoo.com (alfonso echazarra)
Date: Tue, 8 Feb 2011 08:00:20 -0800
Subject: [R-sig-Geo] Using neighbours outside the area of analysis for
	constructing spatial weight matrices
In-Reply-To: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
References: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
Message-ID: <109198.43910.qm@web36806.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/9f9c7bf2/attachment.pl>

From a.mosnier at gmail.com  Tue Feb  8 17:02:17 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Tue, 8 Feb 2011 11:02:17 -0500
Subject: [R-sig-Geo] lme and spatial autocorrelation
Message-ID: <AANLkTi=rUjbxLW0u05fzWU-Abhs2_3ti9fphDXvi6ekF@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/8c8188ef/attachment.pl>

From ana-lee at web.de  Tue Feb  8 17:18:23 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Tue, 08 Feb 2011 17:18:23 +0100
Subject: [R-sig-Geo] variogram
Message-ID: <4D516CCF.6090306@web.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/44c23d20/attachment.pl>

From hacke78 at googlemail.com  Tue Feb  8 18:40:22 2011
From: hacke78 at googlemail.com (Jan Hackenberg)
Date: Tue, 8 Feb 2011 18:40:22 +0100
Subject: [R-sig-Geo] FFT
Message-ID: <AANLkTikQhToDUsEwe70kXz2io8_zXFDkFkSO0uJOLV=p@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/30effab9/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb  8 21:27:46 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 Feb 2011 21:27:46 +0100
Subject: [R-sig-Geo] Using neighbours outside the area of analysis for
 constructing spatial weight matrices
In-Reply-To: <109198.43910.qm@web36806.mail.mud.yahoo.com>
References: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
	<109198.43910.qm@web36806.mail.mud.yahoo.com>
Message-ID: <alpine.LRH.2.00.1102082121050.21266@reclus.nhh.no>

On Tue, 8 Feb 2011, alfonso echazarra wrote:

> Hello,
>
> I am constructing a spatial weight matrix and would like to use 
> neighbours that are not part ofthe area I am analysing. In this case, I 
> am investigating crime rates within Madrid and I would like to use 
> Madrid's adjacent census tracts to construct the spatial weights for 
> census tracts on the edge of Madrid (queen contiguity rule). Is that 
> possible? Spatial weights matrices and dataset that are analysed need to 
> be of same size?
>

With very few exceptions, they need to be of the same size. The exception 
is that localmoran.sad() and localmoran.exact() take a select= argument to 
select the zones to be tested, but even here the length of the nb object 
and the number of observations must agree - you just do not have to 
compute local Moran's I for all of the observations. My impression is that 
the distributional assumptions behind the tests would be affected if some 
of the x_j were omitted from computation but included in the spatial lags 
through w_{ij}. It may be possible to construct a lagged variable for 
inclusion in a regression, but I'm not sure whether this would address the 
edge effects you seem to be concerned about.

Roger

>
> Thanks,
> Alfonso Echazarra
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From aechazarra at yahoo.com  Tue Feb  8 22:53:18 2011
From: aechazarra at yahoo.com (alfonso echazarra)
Date: Tue, 8 Feb 2011 13:53:18 -0800
Subject: [R-sig-Geo] Using neighbours outside the area of analysis for
	constructing spatial weight matrices
In-Reply-To: <alpine.LRH.2.00.1102082121050.21266@reclus.nhh.no>
References: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
	<109198.43910.qm@web36806.mail.mud.yahoo.com>
	<alpine.LRH.2.00.1102082121050.21266@reclus.nhh.no>
Message-ID: <513190.73448.qm@web36806.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/367d9faa/attachment.pl>

From vickyqau at gmail.com  Wed Feb  9 01:50:21 2011
From: vickyqau at gmail.com (waqar younas)
Date: Tue, 8 Feb 2011 16:50:21 -0800
Subject: [R-sig-Geo] About R
Message-ID: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110208/4e60859c/attachment.pl>

From Roger.Bivand at nhh.no  Wed Feb  9 08:21:09 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 Feb 2011 08:21:09 +0100
Subject: [R-sig-Geo] Using neighbours outside the area of analysis for
 constructing spatial weight matrices
In-Reply-To: <513190.73448.qm@web36806.mail.mud.yahoo.com>
References: <mailman.13.1297162804.3057.r-sig-geo@r-project.org>
	<109198.43910.qm@web36806.mail.mud.yahoo.com>
	<alpine.LRH.2.00.1102082121050.21266@reclus.nhh.no>
	<513190.73448.qm@web36806.mail.mud.yahoo.com>
Message-ID: <alpine.LRH.2.00.1102090808380.23705@reclus.nhh.no>

On Tue, 8 Feb 2011, alfonso echazarra wrote:

> Hi, For what you have said, it seems that the problem I encountered 
> extends to selecting subsets of the area analysed. I assume that for 
> selecting a subsample only the spatial weights of that subsample are to 
> be computed and not for the whole area. Which means that if the subset 
> is based on a non-geographical variable (i.e. lets say "% of higher 
> degree"), the are would look like a gruyere cheese. Is that right?

Please don't assume. You have not established that edge effects are a 
problem, and your approach is non-standard, so needs motivation. You have 
not said if you are testing, modelling, or why this is an issue for you.

Your analysis of the implementation in localmoran.sad() and 
localmoran.exact() is wrong - one may often need I_i for just one zone in 
a set of zones 1:n, it is, after all, a local measure, and that measure 
will include all j of i's neighbours. So if you have position and 
attribute data for the whole data set, both inside and outside your city 
limits, you can select only zones belonging to the city, and their 
neighbours, also outside the city, will be used in calculating the I_i. 
The same would apply if other selection schemes were used.

You have also misunderstood where in the workflow the spatial weights 
appear in spdep - they are pre-computed as an nb object, then converted to 
a listw object, which is a sparse representation of the weights, all 
before any testing or modelling takes place. This means that the input 
listw and data/model objects must conform in all cases, not least because 
the weights and the data have the same ordering, and are matched by order 
index, and because a weight w_{ij} * NA is NA, which is a critical 
problem, and so largely barred.

Roger

>
> Thanks,
> Alfonso Echazarra
>
>
>
>
> ________________________________
> De: Roger Bivand <Roger.Bivand at nhh.no>
> Para: alfonso echazarra <aechazarra at yahoo.com>
> CC: r-sig-geo at stat.math.ethz.ch
> Enviado: mar,8 febrero, 2011 15:27
> Asunto: Re: [R-sig-Geo] Using neighbours outside the area of analysis for 
> constructing spatial weight matrices
>
> On Tue, 8 Feb 2011, alfonso echazarra wrote:
>
>> Hello,
>> 
>> I am constructing a spatial weight matrix and would like to use neighbours that 
>> are not part ofthe area I am analysing. In this case, I am investigating crime 
>> rates within Madrid and I would like to use Madrid's adjacent census tracts to 
>> construct the spatial weights for census tracts on the edge of Madrid (queen 
>> contiguity rule). Is that possible? Spatial weights matrices and dataset that 
>> are analysed need to be of same size?
>> 
>
> With very few exceptions, they need to be of the same size. The exception is 
> that localmoran.sad() and localmoran.exact() take a select= argument to select 
> the zones to be tested, but even here the length of the nb object and the number 
> of observations must agree - you just do not have to compute local Moran's I for 
> all of the observations. My impression is that the distributional assumptions 
> behind the tests would be affected if some of the x_j were omitted from 
> computation but included in the spatial lags through w_{ij}. It may be possible 
> to construct a lagged variable for inclusion in a regression, but I'm not sure 
> whether this would address the edge effects you seem to be concerned about.
>
> Roger
>
>> 
>> Thanks,
>> Alfonso Echazarra
>> 
>> 
>> 
>>
>>     [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
> -- Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From A.Lam at geo.uu.nl  Wed Feb  9 10:31:13 2011
From: A.Lam at geo.uu.nl (Arien Lam)
Date: Wed, 9 Feb 2011 10:31:13 +0100
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
Message-ID: <4D525EE1.5070800@geo.uu.nl>

Hi,

Did you read http://cran.r-project.org/doc/manuals/R-data.html ?
Have a look at the rgdal package for many supported grid formats.
For MATLAB, start with cran.r-project.org/doc/contrib/Hiebeler-matlabR.pdf , R.matlab package.
Also, http://www.rseek.org can be helpful.


On Wed, February 9, 2011 10:01, waqar younas wrote:
> Hi
> I am PhD Candidate in UNBC, Canada and working on seasonal climate
> prediction data analysis. Currently, i am using MATLAB but i also want to
> use R for probabilistic verification package. I do not know even how to read
> data in R. First of all, i read the manual of R, but it is not written
> clearly which data formats R supports? In MATLAB, i can save my data into
> grid format so i want to know, how grid data can be read able in R. There is
> interface people use so that R can be called within MATLAB, but i do not
> know how?
>

-- 

Arien Lam
Researcher / modeler
Dept. of Physical Geography
Utrecht University, NL


From luca.candeloro at gmail.com  Wed Feb  9 11:05:36 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Wed, 9 Feb 2011 11:05:36 +0100
Subject: [R-sig-Geo] Rasters average
Message-ID: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/4bc24f76/attachment.pl>

From hzambran.newsgroups at gmail.com  Wed Feb  9 11:13:47 2011
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Wed, 9 Feb 2011 11:13:47 +0100
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
Message-ID: <AANLkTiksWphX=kKbqx15aHJ1cRcb4XSQ+otVQW5d_rhQ@mail.gmail.com>

I think  r-sig-geo is not the right mailing list for this question.
However, in addition to what was pointed out by Arien, for data import
you may have a look to the following web site :

http://www.statmethods.net/input/importingdata.html

and also try within R:

> ?read.table
> ?read.csv

I hope this helps.

Kinds,

Mauricio

-- 
================================
Linux user #454569 -- Ubuntu user #17469
================================

2011/2/9 waqar younas <vickyqau at gmail.com>:
> Hi
> I am PhD Candidate in UNBC, Canada and working on seasonal climate
> prediction data analysis. Currently, i am using MATLAB but i also want to
> use R for probabilistic verification package. I do not know even how to read
> data in R. First of all, i read the manual of R, but it is not written
> clearly which data formats R supports? In MATLAB, i can save my data into
> grid format so i want to know, how grid data can be read able in R. There is
> interface people use so that R can be called within MATLAB, but i do not
> know how?
>
> --
> Best Regards
>
> Waqar Younas
> PhD Candidate
> Natural Resources and Environmental Studies (NRES)
> University of Northern British Columbia (UNBC)
> Canada
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From bart at njn.nl  Wed Feb  9 11:24:23 2011
From: bart at njn.nl (bart)
Date: Wed, 09 Feb 2011 11:24:23 +0100
Subject: [R-sig-Geo] Rasters average
In-Reply-To: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
References: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
Message-ID: <4D526B57.5030905@njn.nl>

I think the calculations could be a lot quicker if you make a raster 
stack or raster brick from your seven rasters and use that. see example 
below. Maybe you have to play around with your in memory settings and 
use a file on the disk. But i'm still able to do it using rasters upto 
200000 points easily in memory within seconds

 > (a<-brick(raster(matrix(runif(10), ncol=2)), 
raster(matrix(c(runif(8), NA, NA), ncol=2))))
class       : RasterBrick
dimensions  : 5, 2, 2  (nrow, ncol, nlayers)
ncell       : 10
resolution  : 0.5, 0.2  (x, y)
projection  : NA
extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
values      : from memory
min values  : 0.015 0.015
max values  : 0.94 0.95

 > values(a[[2]])
  [1] 0.13370844 0.94727248 0.45225123 0.16531864 0.62212769 0.01502728
  [7] 0.66552310         NA 0.72266646         NA
 > values(a[[1]])
  [1] 0.41511274 0.90717270 0.59899444 0.17772793 0.93664444 0.53157684
  [7] 0.05073588 0.91242408 0.01484997 0.29561654
 > values(mean(a, na.rm=TRUE))
  [1] 0.2744106 0.9272226 0.5256228 0.1715233 0.7793861 0.2733021 0.3581295
  [8] 0.9124241 0.3687582 0.2956165
 >


On 02/09/2011 11:05 AM, luca candeloro wrote:
> Hi all,
> I'm trying to use MODIS 1day raster (.tif file) to obtain a, say, weekly
> raster which is the average of the seven 1 day raster.
> Using the following code (library raster) I can't obtain the results due to
> computational limits.
>
> #Input files (same dimension: [1310,1391]
>
> Map.raster1=raster("C:/MOD11A2/Confronto/1d001.tif")
> Map.raster2=raster("C:/MOD11A2/Confronto/1d002.tif")
> Map.raster3=raster("C:/MOD11A2/Confronto/1d003.tif")
> Map.raster4=raster("C:/MOD11A2/Confronto/1d004.tif")
> Map.raster5=raster("C:/MOD11A2/Confronto/1d005.tif")
> Map.raster6=raster("C:/MOD11A2/Confronto/1d006.tif")
> Map.raster7=raster("C:/MOD11A2/Confronto/1d007.tif")
>
>
> for (r in 1:1310) {
> for (c in 1:1391) {
> if(Map.raster1[r,c]==0) v1=NA else v1= Map.raster1[r,c]
> if(Map.raster2[r,c]==0) v2=NA else v2= Map.raster2[r,c]
> if(Map.raster3[r,c]==0) v3=NA else v3= Map.raster3[r,c]
> if(Map.raster4[r,c]==0) v4=NA else v4= Map.raster4[r,c]
> if(Map.raster5[r,c]==0) v5=NA else v5= Map.raster5[r,c]
> if(Map.raster6[r,c]==0) v6=NA else v6= Map.raster6[r,c]
> if(Map.raster7[r,c]==0) v7=NA else v7= Map.raster7[r,c]
> media=mean(c(v1,v2,v3,v4,v5,v6,v7),na.rm=TRUE)
> if (is.na(media)) media=0
> Map.raster[r,c]=media
> }
> }
>
> Is there an easiest way to average the values of "k" raster?
> Thanks,
> Luca.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From hengl at spatial-analyst.net  Wed Feb  9 11:38:05 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 09 Feb 2011 11:38:05 +0100
Subject: [R-sig-Geo] Rasters average
In-Reply-To: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
References: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
Message-ID: <4D526E8D.6040107@spatial-analyst.net>


Try also using RSAGA. I usually process 100 millions of pixels without a 
problem. See:

 > rsaga.get.usage(lib="geostatistics_grid", module=5)
module name: Statistics for Grids

Here is an example:

[http://spatial-analyst.net/scripts/getMOD12C1.R]

HTH,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001


Op 9-2-2011 11:05, luca candeloro schreef:
> Hi all,
> I'm trying to use MODIS 1day raster (.tif file) to obtain a, say, weekly
> raster which is the average of the seven 1 day raster.
> Using the following code (library raster) I can't obtain the results due to
> computational limits.
>
> #Input files (same dimension: [1310,1391]
>
> Map.raster1=raster("C:/MOD11A2/Confronto/1d001.tif")
> Map.raster2=raster("C:/MOD11A2/Confronto/1d002.tif")
> Map.raster3=raster("C:/MOD11A2/Confronto/1d003.tif")
> Map.raster4=raster("C:/MOD11A2/Confronto/1d004.tif")
> Map.raster5=raster("C:/MOD11A2/Confronto/1d005.tif")
> Map.raster6=raster("C:/MOD11A2/Confronto/1d006.tif")
> Map.raster7=raster("C:/MOD11A2/Confronto/1d007.tif")
>
>
> for (r in 1:1310) {
> for (c in 1:1391) {
> if(Map.raster1[r,c]==0) v1=NA else v1= Map.raster1[r,c]
> if(Map.raster2[r,c]==0) v2=NA else v2= Map.raster2[r,c]
> if(Map.raster3[r,c]==0) v3=NA else v3= Map.raster3[r,c]
> if(Map.raster4[r,c]==0) v4=NA else v4= Map.raster4[r,c]
> if(Map.raster5[r,c]==0) v5=NA else v5= Map.raster5[r,c]
> if(Map.raster6[r,c]==0) v6=NA else v6= Map.raster6[r,c]
> if(Map.raster7[r,c]==0) v7=NA else v7= Map.raster7[r,c]
> media=mean(c(v1,v2,v3,v4,v5,v6,v7),na.rm=TRUE)
> if (is.na(media)) media=0
> Map.raster[r,c]=media
> }
> }
>
> Is there an easiest way to average the values of "k" raster?
> Thanks,
> Luca.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From s.cavazzi at cranfield.ac.uk  Wed Feb  9 12:14:29 2011
From: s.cavazzi at cranfield.ac.uk (Cavazzi, Stefano)
Date: Wed, 9 Feb 2011 11:14:29 +0000
Subject: [R-sig-Geo] RSAGA "ta_morphometry" methods Vs ArcGIS
Message-ID: <6E3C09D338C1BB46AD3778BB99012D6005F1DF8B8B@CCEXCHSTORE-2.central.cranfield.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/383211a7/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Feb  9 12:24:24 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 9 Feb 2011 03:24:24 -0800 (PST)
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
Message-ID: <921007.49647.qm@web161407.mail.bf1.yahoo.com>

  Younas,

  Although I don't know what are the specific data you need to analyze or the tests you need to perform, some packages can certainly be recommended. "RnetCDF" and "raster" are great to import netCDF files. NCAR's "verification" package (http://cran.r-project.org/web/packages/verification/index.html) offers useful tools for analysing probabilistic or deterministic forecasts. Package "clim.pact" (http://cran.r-project.org/web/packages/clim.pact/index.html) might be useful as well.

  Hope it helps,

  Thiago.

--- On Tue, 8/2/11, waqar younas <vickyqau at gmail.com> wrote:

> From: waqar younas <vickyqau at gmail.com>
> Subject: [R-sig-Geo] About R
> To: cmbarker at ucdavis.edu, r-sig-geo at r-project.org
> Date: Tuesday, 8 February, 2011, 22:50
> Hi
> I am PhD Candidate in UNBC, Canada and working on seasonal
> climate
> prediction data analysis. Currently, i am using MATLAB but
> i also want to
> use R for probabilistic verification package. I do not know
> even how to read
> data in R. First of all, i read the manual of R, but it is
> not written
> clearly which data formats R supports? In MATLAB, i can
> save my data into
> grid format so i want to know, how grid data can be read
> able in R. There is
> interface people use so that R can be called within MATLAB,
> but i do not
> know how?
> 
> -- 
> Best Regards
> 
> Waqar Younas
> PhD Candidate
> Natural Resources and Environmental Studies (NRES)
> University of Northern British Columbia (UNBC)
> Canada
> 
> ??? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 





From a.lechner at uq.edu.au  Wed Feb  9 12:25:21 2011
From: a.lechner at uq.edu.au (Alex Lechner)
Date: Wed, 9 Feb 2011 21:25:21 +1000
Subject: [R-sig-Geo] Building a grid that incorporates
	distance	measurement
In-Reply-To: <4D4FA0CA.3010801@uni-muenster.de>
References: <E3876D38ECEF0E4A96FE267CE453364BB750E5A5C7@UQEXMB01.soe.uq.edu.au>
	<4D4FA0CA.3010801@uni-muenster.de>
Message-ID: <99F54C247EC3944BBFA29EAF43AF1E6691D20310DA@UQEXMB01.soe.uq.edu.au>

Hi Edzer.

Thank you for your reply. After a bit of playing round I am close to a solution.

Thanks

Alex 


-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: Monday, 7 February 2011 5:36 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Building a grid that incorporates distance measurement

Alex,

your comments "does not work" are slightly self-centered - they do
"work" (at least for me), and do what they actually can do.

If you want a regular grid over an irregular polygon, you have to
provide spsample with such a polygon. The meuse data set does not come
with such a polygon - would indeed be nice to have an example. You can
use ?locator to digitize a polygon on-screen.

The "dist" values are obtained by evaluating, for each (observation and
prediction) point the distance to some feature - here the river Meuse.
To compute these, you need the target points, and the feature. The most
neat way would be to use the geometry functions in package rgeos, but a
good approximation would be just use many points of the feature (e.g.
generated by spsample) and then use spDists or spDistsN1.

Hth,

On 02/07/2011 03:31 AM, Alex Lechner wrote:
> Hello,
> 
> I am trying to do some Kriging incorporating a gradient trend in the data (i.e.  krige(log(zinc)~sqrt(dist),...) based on the method described in http://r-spatial.sourceforge.net/gallery/ and Bivand's book. I have been having problems with producing the appropriate grid with a format that incorporates distance. Just to make sure there are no errors in my own data I have utilised the "meuse" dataset and adapted the example in http://r-spatial.sourceforge.net/gallery/.
> 
> In the meuse dataset the grid is loaded with the data(meuse.grid). But I can't find a way that recreates the same data with the original meuse dataset. I have tried the following:
> 
> meuse.grid = spsample(meuse, type = "regular", cellsize = c(50,50))
> gridded(meuse.grid) = TRUE
> 
> and
> 
> meuse.grid <-SpatialPixels(SpatialPoints(makegrid(meuse)))
> gridded(meuse.grid) = TRUE
> 
> Neither of the above methods work when I use a Kriging function that incorporates distance (log(zinc)~sqrt(dist)). However they work if I use ordinary kriging with the function zinc~1. I also noticed that meuse.grid includes distance measurements.
> 
> CODE
> ====================
> 
> library(sp)
> library(gstat)
> 
> data(meuse)
> coordinates(meuse)=~x+y
> 
> #Original Method - only method that works
> data(meuse.grid)
> data_grid<-meuse.grid
> coordinates(data_grid) = ~x+y
> gridded(data_grid) = TRUE
> 
> #Method 2 - does not work
> #data_grid = spsample(meuse, type = "regular", cellsize = c(50,50))
> #gridded(data_grid) = TRUE
> 
> #Method 3 - does not work
> #data_grid<-SpatialPixels(SpatialPoints(makegrid(meuse)))
> #gridded(data_grid) = TRUE
> 
> v.uk = variogram(log(zinc)~sqrt(dist), meuse)
> uk.model = fit.variogram(v.uk, vgm(1, "Exp", 300, 1))
> 
> zn.uk = krige(log(zinc)~sqrt(dist), meuse, data_grid, model = uk.model)
> 
> print(spplot(zn.uk, "var1.pred"))
> 
> =========================
> 
> Thanks for the help,
> 
> Alex Lechner
> 
> Research Fellow
> Centre for Mined Land Rehabilitation
> Sustainable Minerals Institute
> University of Queensland
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From wul1984 at gmail.com  Wed Feb  9 15:02:17 2011
From: wul1984 at gmail.com (Marco)
Date: Wed, 9 Feb 2011 22:02:17 +0800
Subject: [R-sig-Geo] Prediction in BIOMOD
Message-ID: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/a16efedc/attachment.pl>

From wilfried.thuiller at ujf-grenoble.fr  Wed Feb  9 15:04:53 2011
From: wilfried.thuiller at ujf-grenoble.fr (Wilfried Thuiller)
Date: Wed, 9 Feb 2011 15:04:53 +0100
Subject: [R-sig-Geo] Prediction in BIOMOD
In-Reply-To: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>
References: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>
Message-ID: <0162C42B-CCEE-481B-8774-89F40D7DBA54@ujf-grenoble.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/53620781/attachment.pl>

From wul1984 at gmail.com  Wed Feb  9 15:42:41 2011
From: wul1984 at gmail.com (Marco)
Date: Wed, 9 Feb 2011 22:42:41 +0800
Subject: [R-sig-Geo] Prediction in BIOMOD
In-Reply-To: <0162C42B-CCEE-481B-8774-89F40D7DBA54@ujf-grenoble.fr>
References: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>
	<0162C42B-CCEE-481B-8774-89F40D7DBA54@ujf-grenoble.fr>
Message-ID: <AANLkTinTgERUbNeBtoGYk_zfMX0JBscASwBRiJW-t795@mail.gmail.com>

Hi, Wilfried:

Thanks very much for the rapid reply, it helps me a lot! I have been
thinking that the function Projection is for predicting of future
distribution or for another region.
Marco
On 2/9/11, Wilfried Thuiller <wilfried.thuiller at ujf-grenoble.fr> wrote:
> Dear Marco,
> You did understand correctly.
>
> For having the predictions made on all background points, use the Projection
> function after the Models function.
>
> Best
> Wilfried
>
>
> Le 9 f?vr. 2011 ? 15:02, Marco a ?crit :
>
>> Dear list:
>>
>>
>>
>> I am using package BIOMOD and have a question concerning model prediction.
>>
>>
>>
>> It seems that in BIOMOD, the default prediction of species distribution is
>> carried only on the presence and pseudo-absence points, not on the whole
>> background points. Which means, for example, if I have 100 presence
>> records,
>> and another 1000 points were selected from the background point pool (eg.
>> 5000 random points). The final prediction was only the 1100 points, not
>> 5100, when I load the ?pred_speciesname? file in the ?pred? subfolder of
>> model result. My question is: is there any direct way of getting the
>> prediction of the whole background points from the main *Models* function,
>> or did I have a totally wrong understanding of prediction?
>>
>>
>>
>> Please forgive me if the question is too silly.
>>
>>
>>
>> Best Regard~
>>
>>
>>
>> Marco
>>
>> --
>> -------------------------------------------------------
>> Chinese Ecological Research Network,
>> Institute of Geographical Sciences and Natural Resources Research,
>> Chinese Academy of Sciences,
>> 100101, Beijing
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> -------------------------
> Dr. Wilfried Thuiller
> Laboratoire d'Ecologie Alpine, UMR CNRS 5553
> Universit? Joseph Fourier
> BP53, 38041 Grenoble cedex 9, France
> tel:  33 (0)4 76 51 44 97
> fax:  33 (0)4 76 51 42 79
>
> Email: wilfried.thuiller at ujf-grenoble.fr
> Home page: http://www.will.chez-alice.fr
> Website: http://www-leca.ujf-grenoble.fr/equipes/tde.htm
>
> FP6 European MACIS project: http://www.macis-project.net
> FP6 European EcoChange project: http://www.ecochange-project.eu
>
>
>
>
>
>
>


-- 
-------------------------------------------------------
Chinese Ecological Research Network,
Institute of Geographical Sciences and Natural Resources Research,
 Chinese Academy of Sciences,
100101, Beijing
Tel: (86)-10-64880 9809


From wilfried.thuiller at ujf-grenoble.fr  Wed Feb  9 15:44:38 2011
From: wilfried.thuiller at ujf-grenoble.fr (Wilfried Thuiller)
Date: Wed, 9 Feb 2011 15:44:38 +0100
Subject: [R-sig-Geo] Prediction in BIOMOD
In-Reply-To: <AANLkTinTgERUbNeBtoGYk_zfMX0JBscASwBRiJW-t795@mail.gmail.com>
References: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>
	<0162C42B-CCEE-481B-8774-89F40D7DBA54@ujf-grenoble.fr>
	<AANLkTinTgERUbNeBtoGYk_zfMX0JBscASwBRiJW-t795@mail.gmail.com>
Message-ID: <499C3E11-1BF9-4343-937A-76FE38FAEB8A@ujf-grenoble.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/57d0e638/attachment.pl>

From wul1984 at gmail.com  Wed Feb  9 16:06:49 2011
From: wul1984 at gmail.com (Marco)
Date: Wed, 9 Feb 2011 23:06:49 +0800
Subject: [R-sig-Geo] Prediction in BIOMOD
In-Reply-To: <499C3E11-1BF9-4343-937A-76FE38FAEB8A@ujf-grenoble.fr>
References: <AANLkTi=rpz2gyVFg81kv0pMEDikTy1DhA9i6a6mY15C2@mail.gmail.com>
	<0162C42B-CCEE-481B-8774-89F40D7DBA54@ujf-grenoble.fr>
	<AANLkTinTgERUbNeBtoGYk_zfMX0JBscASwBRiJW-t795@mail.gmail.com>
	<499C3E11-1BF9-4343-937A-76FE38FAEB8A@ujf-grenoble.fr>
Message-ID: <AANLkTik3moi=M_AP=rFFuYaf=Hj8n=wDuRVyHpXp7Sxw@mail.gmail.com>

Yes, now I understand. Thank you very much!

Marco

On 2/9/11, Wilfried Thuiller <wilfried.thuiller at ujf-grenoble.fr> wrote:
> Well, this is like the "predict" function in R, it is generic. It projects
> on the data you give (could be on the original data, or in space or/and
> time)
>
> Le 9 f?vr. 2011 ? 15:42, Marco a ?crit :
>
>> Hi, Wilfried:
>>
>> Thanks very much for the rapid reply, it helps me a lot! I have been
>> thinking that the function Projection is for predicting of future
>> distribution or for another region.
>> Marco
>> On 2/9/11, Wilfried Thuiller <wilfried.thuiller at ujf-grenoble.fr> wrote:
>>> Dear Marco,
>>> You did understand correctly.
>>>
>>> For having the predictions made on all background points, use the
>>> Projection
>>> function after the Models function.
>>>
>>> Best
>>> Wilfried
>>>
>>>
>>> Le 9 f?vr. 2011 ? 15:02, Marco a ?crit :
>>>
>>>> Dear list:
>>>>
>>>>
>>>>
>>>> I am using package BIOMOD and have a question concerning model
>>>> prediction.
>>>>
>>>>
>>>>
>>>> It seems that in BIOMOD, the default prediction of species distribution
>>>> is
>>>> carried only on the presence and pseudo-absence points, not on the whole
>>>> background points. Which means, for example, if I have 100 presence
>>>> records,
>>>> and another 1000 points were selected from the background point pool
>>>> (eg.
>>>> 5000 random points). The final prediction was only the 1100 points, not
>>>> 5100, when I load the ?pred_speciesname? file in the ?pred? subfolder of
>>>> model result. My question is: is there any direct way of getting the
>>>> prediction of the whole background points from the main *Models*
>>>> function,
>>>> or did I have a totally wrong understanding of prediction?
>>>>
>>>>
>>>>
>>>> Please forgive me if the question is too silly.
>>>>
>>>>
>>>>
>>>> Best Regard~
>>>>
>>>>
>>>>
>>>> Marco
>>>>
>>>> --
>>>> -------------------------------------------------------
>>>> Chinese Ecological Research Network,
>>>> Institute of Geographical Sciences and Natural Resources Research,
>>>> Chinese Academy of Sciences,
>>>> 100101, Beijing
>>>>
>>>> 	[[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> -------------------------
>>> Dr. Wilfried Thuiller
>>> Laboratoire d'Ecologie Alpine, UMR CNRS 5553
>>> Universit? Joseph Fourier
>>> BP53, 38041 Grenoble cedex 9, France
>>> tel:  33 (0)4 76 51 44 97
>>> fax:  33 (0)4 76 51 42 79
>>>
>>> Email: wilfried.thuiller at ujf-grenoble.fr
>>> Home page: http://www.will.chez-alice.fr
>>> Website: http://www-leca.ujf-grenoble.fr/equipes/tde.htm
>>>
>>> FP6 European MACIS project: http://www.macis-project.net
>>> FP6 European EcoChange project: http://www.ecochange-project.eu
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>
>>
>> --
>> -------------------------------------------------------
>> Chinese Ecological Research Network,
>> Institute of Geographical Sciences and Natural Resources Research,
>> Chinese Academy of Sciences,
>> 100101, Beijing
>> Tel: (86)-10-64880 9809
>
> -------------------------
> Dr. Wilfried Thuiller
> Laboratoire d'Ecologie Alpine, UMR CNRS 5553
> Universit? Joseph Fourier
> BP53, 38041 Grenoble cedex 9, France
> tel: +33 (0)4 76 51 44 97
> fax: +33 (0)4 76 51 42 79
>
> Email: wilfried.thuiller at ujf-grenoble.fr
> Home page: http://www.will.chez-alice.fr
> Website: http://www-leca.ujf-grenoble.fr/equipes/tde.htm
>
> FP6 European MACIS project: http://www.macis-project.net
> FP6 European EcoChange project: http://www.ecochange-project.eu
>
>
>
>
>
>
>


-- 
-------------------------------------------------------
Chinese Ecological Research Network,
Institute of Geographical Sciences and Natural Resources Research,
 Chinese Academy of Sciences,
100101, Beijing
Tel: (86)-10-64880 9809


From r.hijmans at gmail.com  Wed Feb  9 17:08:38 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 9 Feb 2011 08:08:38 -0800
Subject: [R-sig-Geo] Rasters average
In-Reply-To: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
References: <AANLkTikLub3gOCE3Ar+iAd9OO2Zi0GLOsLWL64J2RA0h@mail.gmail.com>
Message-ID: <1297267718971-6008219.post@n2.nabble.com>



>I'm trying to use MODIS 1day raster (.tif file) to obtain a, say, weekly 
>raster which is the average of the seven 1 day raster. 
>Using the following code (library raster) I can't obtain the results due to 
>computational limits. 

Luca, 

You can do something like:

s <- stack(paste("C:/MOD11A2/Confronto/1d00", 1:7, ".tif", sep=""))
fun <- function(x, ...) { x[x==0] <- NA; mean(x, na.rm=TRUE) }
m <- calc(s, fun)


I am not sure what you mean by "computational limits"; are you saying that
this takes a long time? If so, that would be  because you are looping over
cells. Avoid that, and things will be faster. 

Robert

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Rasters-average-tp6007034p6008219.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ana-lee at web.de  Wed Feb  9 17:38:42 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Wed, 09 Feb 2011 17:38:42 +0100
Subject: [R-sig-Geo] variogram
Message-ID: <4D52C312.4040601@web.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/3509d861/attachment.pl>

From katie.stopher at ed.ac.uk  Wed Feb  9 17:42:46 2011
From: katie.stopher at ed.ac.uk (Katie Stopher)
Date: Wed, 09 Feb 2011 16:42:46 +0000
Subject: [R-sig-Geo] Using BA to estimate home range overlap
Message-ID: <4D52C406.9040801@ed.ac.uk>

Hello,

I am trying to use kerneloverlap from adehabitat to estimate overlap 
between the home ranges of red deer. For what I want to use the home 
range overlap for, I would like the overlap to take into account the UDs 
of the animals, but also to range between 0 and 1. From my reading of 
Fieberg and Kochanny (2005), using the BA method should do this.

My code is fairly straightforward:

xy<-locations[,c('Easting','Northing')]
id<-locations[,c('Code')]
overlap<-kerneloverlap(xy, id, "BA", 65)

But the results are surprising: in particular, some pairs of individuals 
have an overlap greater than one- up to above 2 in some cases. Can 
anyone explain to me why this might be?

Many thanks, and my apologies if I have missed something obvious in my 
reading of the help pages!

Thanks,

Katie Stopher

-- 
Katie Stopher

PhD Student, Wild Evolution Group,
Institute of Evolutionary Biology,
University of Edinburgh,
King's Buildings,
West Mains Road,
Edinburgh,
EH9 3JT


http://wildevolution.biology.ed.ac.uk/jpemberton/KatieStopher2.html

-- 
Katie Stopher

PhD Student, Wild Evolution Group,
Institute of Evolutionary Biology,
University of Edinburgh,
King's Buildings,
West Mains Road,
Edinburgh,
EH9 3JT


http://wildevolution.biology.ed.ac.uk/jpemberton/KatieStopher2.html


From edzer.pebesma at uni-muenster.de  Wed Feb  9 17:54:14 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 Feb 2011 17:54:14 +0100
Subject: [R-sig-Geo] variogram
In-Reply-To: <4D52C312.4040601@web.de>
References: <4D52C312.4040601@web.de>
Message-ID: <4D52C6B6.1020602@uni-muenster.de>

Anna, you didn't mention that you did a

library(spatial)

prior to this. Maybe you came to this by reading "Modern applied
statistics with S", but since package spatial was written many other
packages have arrived that do a better job for geostatistics with R. You
can find them from the Spatial task view,

http://cran.r-project.org/web/views/Spatial.html

(or from a CRAN mirror -> task views -> Spatial)

Hth,

On 02/09/2011 05:38 PM, Anna Gretschel wrote:
> 
> hi everybody!
> 
> i work with variograms. the r-functions i use are:
> 
>    
> surface<-surf.ls(1,data)                                               
> #  Trend Surface
>    v<- variogram(surface, nint||)                                        
> #  Variogram
> 
> nint ist the number of bins used. i interpreted this as the number of 
> distance classes (lag). the problem is, my data pairs are minimal 1 
> meter apart and maximal 35 meters. if i do a variogram by hand the 
> smallest lag i have is 1 meter and i have at most 20 distance classes. 
> Only i don't get it detrended by hand. if i do it in r i get it 
> detrended nicely but only if i use at least 60 for nint. that is a lot 
> though. how come that i have to use 60 bins? what exactly does r do?
> 
> thanks a lot!
> 
> Anna
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From clement.calenge at oncfs.gouv.fr  Wed Feb  9 18:25:24 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Wed, 09 Feb 2011 18:25:24 +0100
Subject: [R-sig-Geo] Using BA to estimate home range overlap
In-Reply-To: <4D52C406.9040801@ed.ac.uk>
References: <4D52C406.9040801@ed.ac.uk>
Message-ID: <4D52CE04.6000107@oncfs.gouv.fr>

[snip]
> My code is fairly straightforward:
>
> xy<-locations[,c('Easting','Northing')]
> id<-locations[,c('Code')]
> overlap<-kerneloverlap(xy, id, "BA", 65)
>
> But the results are surprising: in particular, some pairs of 
> individuals have an overlap greater than one- up to above 2 in some 
> cases. Can anyone explain to me why this might be?

This is rather strange indeed. I read the code again, but I did not find 
any bug in the implementation of the function. Could you send a 
reproducible example (e.g. two animals characterized by a BA index > 1), 
to have a better idea of what happens?
Best regards,

Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From piero.campa at gmail.com  Wed Feb  9 20:32:19 2011
From: piero.campa at gmail.com (piero campa)
Date: Wed, 9 Feb 2011 11:32:19 -0800
Subject: [R-sig-Geo] Universal Kriging with factor covariate
Message-ID: <1297279939135-6009230.post@n2.nabble.com>


Hi list,
I am applying Universal Kriging (a.k.a. Regression-kriging, etc), and
whether I use a factor variable as covariate (to feed the linear regression
model by lm() call), I get this error:

Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "krige", for signature
"call", "SpatialPointsDataFrame"

The same is for krige.cv.
I managed to run UK by manually adding to my Spatial object explicitly the
dummy 0/1 variables for each category used in the formula of the regression
model; but I wonder if I am doing something wrong or actually the krige
method does not support factor covariates.

Thank you,
Piero Campalani

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Universal-Kriging-with-factor-covariate-tp6009230p6009230.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zenlines at gmail.com  Wed Feb  9 21:03:51 2011
From: zenlines at gmail.com (Brian Oney)
Date: Wed, 9 Feb 2011 21:03:51 +0100
Subject: [R-sig-Geo] spautolm - sanity check
Message-ID: <4D52F327.5020607@gmail.com>

Hello All,

I have gone through ASDAR and hope that I have properly applied it's 
content.
I have water color data sampled from polygons, which lie at the mouths 
of a rivers around an island. Due to ocean currents, bathymetry, and 
wind etc., I have the need to account for spatial autocorrelation for 
those polygons which are near to each other. I am trying to build a 
statistical model to explain the correlations between land cover and 
water quality.

Therefore:
### Coordinates of the polygons
coords <- coordinates(outlets)
### k=2 - assume that each outlet point could be/is possibly only 
affecting the two nearest outlets
outlets.nb <- knn2nb(knearneigh(coords,k=2),row.names=outlets$BASIN_ID)
### We assume that SA is related to distance between outlets
### Calculate distance (in meters, the units of our projection)
distance.nb <- nbdists(outlets.nb, coords)
### According to ASDAR (Page 254) this shouldn't be a problem because 
these distances are not on a grid but are asymmetrically placed in space,
### but we do ignore the dynamics physical processes that might 
transport water (currents, wind, bathymetry etc.) and assume equal 
diffusion/dispersal in all directions.
### Invert the distances: the bigger the distance the smaller the 
weight. Weights are proportional to the inverse distance
invert.dist <- lapply(distance.nb, function(x) 1/x)
(outlets.lw <- nb2listw(outlets.nb, glist=invert.dist, style='B'))

OK, is this a correct structure?
It may be better to just base it on distance (dnearneigh) i.e. assume 
that beyond 50km distance a nearest neighbor has no influence.
Any comments, suggestions, insults?

## Give it a whirl.
moran.test(response, listw=outlets.lw, randomisation=F)

Moran's I test under normality

data: response
weights: outlets.lw

Moran I statistic standard deviate = 2.8826, p-value = 0.001972
alternative hypothesis: greater
sample estimates:
Moran I statistic Expectation Variance
0.48914375 -0.02325581 0.03159666
### Tweaking suggests that heteroscedasticity is present as well the 
data not being normally distributed. Then a boxcox transformation 
suggests a 1/sqrt(response) transformation but it is difficult to 
interpret so I opt for a log transformation.

 > moran.test(log(response), listw=outlets.lw, randomisation=F)

Moran's I test under normality

data: log(response)
weights: outlets.lw

Moran I statistic standard deviate = 2.0702, p-value = 0.01922
alternative hypothesis: greater
sample estimates:
Moran I statistic Expectation Variance
0.34473683 -0.02325581 0.03159666

Moran's I changed quite a bit here. This is due to non-normality, right? 
It appears the log takes most of the heteroscedasticity out and 
transforms the distribution to almost normally ditributed (seen via 
plot(model)).

### Continuing
### after narrowing down the explanatory variables while removing the 
'worst' of those that are collinear (rho>0.5).
sp.model <- spautolm(log(response) ~., data=data, listw=outlets.lw)

I used the SAR default.

Also, without narrowing my explanatory variables down to a bare minimum, 
I usually run into the error:
Error in solve.default(crossprod(X, as.matrix(IlW %*% X)), tol = 
tol.solve) :
system is computationally singular: reciprocal condition number = 
2.85163e-019

Which still exists even when the same non-spatial (just lm) model 
contains no singularities. I get this often when adding an interaction 
term to the model.
I am worried that the spatial structure has been misspecified, when 
looking at the other post which addresses this same error:
http://r-sig-geo.2731867.n2.nabble.com/error-in-spautolm-spdep-and-model-selection-td2766159.html

 > sp.model <- spautolm(form, data=borneo.data,listw=outlets.lw)
 > summary(sp.model,Nagelkerke=T)

Call: spautolm(formula = form, data = borneo.data, listw = outlets.lw)

Residuals:
Min 1Q Median 3Q Max
-1.1164557 -0.3936249 0.0074938 0.3652388 1.4859714

Coefficients:
Estimate Std. Error z value Pr(>|z|)
(Intercept) -9.2321e+00 1.6446e+00 -5.6135 1.983e-08
p_bare 1.2761e+00 2.5148e-01 5.0743 3.889e-07
mean_rfact 1.0769e-03 2.1112e-04 5.1010 3.378e-07
km_roads 8.0991e-05 3.3864e-05 2.3917 0.016772
p_bare:mean_rfact -1.5911e-04 3.1192e-05 -5.1009 3.381e-07
p_bare:km_roads -1.5490e-05 5.9758e-06 -2.5922 0.009537

Lambda: 3040.2 LR test value: 0.94862 p-value: 0.33007

Log likelihood: -44.52488
ML residual variance (sigma squared): 0.43704, (sigma: 0.66109)
Number of observations: 44
Number of parameters estimated: 8
AIC: 105.05
Nagelkerke pseudo-R-squared: 0.54572


So there seems to be little spatial autocorrelation in the residuals.

### This is how it looks in non-spatial manner.
summary(model);AIC(model)

Call:
lm(formula = response ~ p_bare + mean_rfact + km_roads + 
p_bare:mean_rfact +
p_bare:km_roads, data = borneo.data)

Residuals:
Min 1Q Median 3Q Max
-0.7111 -0.3342 -0.1216 0.3065 2.0646

Coefficients:
Estimate Std. Error t value Pr(>|t|)
(Intercept) -4.067e+00 1.378e+00 -2.951 0.00539 **
p_bare 6.878e-01 2.142e-01 3.210 0.00270 **
mean_rfact 6.132e-04 1.766e-04 3.472 0.00130 **
km_roads 6.282e-05 2.863e-05 2.194 0.03439 *
p_bare:mean_rfact -8.611e-05 2.660e-05 -3.237 0.00251 **
p_bare:km_roads -1.091e-05 5.067e-06 -2.154 0.03767 *
---
Signif. codes: 0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Residual standard error: 0.559 on 38 degrees of freedom
Multiple R-squared: 0.4248, Adjusted R-squared: 0.3491
F-statistic: 5.613 on 5 and 38 DF, p-value: 0.0005723

## and then...

lm.morantest(model.log,listw=outlets.lw)### Moran's I is big

Global Moran's I for regression residuals

data:
model: lm(formula = log(response) ~ p_bare + mean_rfact + km_roads +
p_bare:mean_rfact + p_bare:km_roads, data = borneo.data)
weights: outlets.lw

Moran I statistic standard deviate = 1.1192, p-value = 0.1315
alternative hypothesis: greater
sample estimates:
Observed Moran's I Expectation Variance
0.15521190 -0.04488877 0.03196742

So SA may or may not exist. It doesn't appear significant here, however, 
the R2 values increase in the spatial model and the AIC drops. The 
spatial model seems better, but is it overkill?

Thanks for the comments, suggestions, or insults!
Regards,
Brian


From edzer.pebesma at uni-muenster.de  Wed Feb  9 21:06:45 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 Feb 2011 21:06:45 +0100
Subject: [R-sig-Geo] Universal Kriging with factor covariate
In-Reply-To: <1297279939135-6009230.post@n2.nabble.com>
References: <1297279939135-6009230.post@n2.nabble.com>
Message-ID: <4D52F3D5.8080307@uni-muenster.de>

krige()  supports the use of factors. Mailing the error message without
the command that generated it doesn't help us forward. Most useful would
be a small reproducable example.

On 02/09/2011 08:32 PM, piero campa wrote:
> 
> Hi list,
> I am applying Universal Kriging (a.k.a. Regression-kriging, etc), and
> whether I use a factor variable as covariate (to feed the linear regression
> model by lm() call), I get this error:
> 
> Error in function (classes, fdef, mtable)  : 
>   unable to find an inherited method for function "krige", for signature
> "call", "SpatialPointsDataFrame"
> 
> The same is for krige.cv.
> I managed to run UK by manually adding to my Spatial object explicitly the
> dummy 0/1 variables for each category used in the formula of the regression
> model; but I wonder if I am doing something wrong or actually the krige
> method does not support factor covariates.
> 
> Thank you,
> Piero Campalani
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From kidsmake6 at msn.com  Wed Feb  9 21:35:42 2011
From: kidsmake6 at msn.com (Brad Nesom)
Date: Wed, 9 Feb 2011 14:35:42 -0600
Subject: [R-sig-Geo] RSAGA "ta_morphometry" methods Vs ArcGIS
In-Reply-To: <6E3C09D338C1BB46AD3778BB99012D6005F1DF8B8B@CCEXCHSTORE-2.central.cranfield.ac.uk>
References: <6E3C09D338C1BB46AD3778BB99012D6005F1DF8B8B@CCEXCHSTORE-2.central.cranfield.ac.uk>
Message-ID: <AANLkTim1=+3Y1nAQ=dHQ2izdAS=nA7iY4RULX8Nv-kRh@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/f3e1e1a6/attachment.pl>

From sotkouk at gmail.com  Wed Feb  9 22:10:49 2011
From: sotkouk at gmail.com (S. Koukoulas)
Date: Wed, 09 Feb 2011 23:10:49 +0200
Subject: [R-sig-Geo] RSAGA "ta_morphometry" methods Vs ArcGIS
In-Reply-To: <6E3C09D338C1BB46AD3778BB99012D6005F1DF8B8B@CCEXCHSTORE-2.central.cranfield.ac.uk>
References: <6E3C09D338C1BB46AD3778BB99012D6005F1DF8B8B@CCEXCHSTORE-2.central.cranfield.ac.uk>
Message-ID: <4D5302D9.6010108@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/febc9dd7/attachment.pl>

From vickyqau at gmail.com  Thu Feb 10 01:03:53 2011
From: vickyqau at gmail.com (waqar younas)
Date: Wed, 9 Feb 2011 16:03:53 -0800
Subject: [R-sig-Geo] About R
In-Reply-To: <921007.49647.qm@web161407.mail.bf1.yahoo.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
	<921007.49647.qm@web161407.mail.bf1.yahoo.com>
Message-ID: <AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110209/6c419c04/attachment.pl>

From phb4 at st-andrews.ac.uk  Thu Feb 10 01:15:09 2011
From: phb4 at st-andrews.ac.uk (Philipp Boersch-Supan)
Date: Thu, 10 Feb 2011 00:15:09 +0000
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>	<921007.49647.qm@web161407.mail.bf1.yahoo.com>
	<AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>
Message-ID: <4D532E0D.9090603@st-andrews.ac.uk>

Hi Younas,

have a look at the R-MATLAB dictionary: 
http://mathesaurus.sourceforge.net/octave-r.html
It should be a great resource for you if you are familiar with MATLAB 
commands and want to klnow the R equivalents.

Best,
Philipp

Philipp Boersch-Supan, MRes

Pelagic Ecology Research Group
University of St. Andrews

Current Address:
University of Oxford
Department of Zoology
South Parks Road
Oxford
OX1 3PS
United Kingdom


On 10/02/2011 00:03, waqar younas wrote:
> Thank you very much to all of you.
> It was very helpful. Now i am able to read the data in R in txt format. Now
> i want to know how to check the size of data and reshape the data in R? As
> in Matlab we just write size(data) and reshape(data,..). How can we do that
> in R?
> My data size (from MATLAB) is 120,396*10). I want to reshape it as
> 120,396,10.
>
> On Wed, Feb 9, 2011 at 3:24 AM, Thiago Veloso<thi_veloso at yahoo.com.br>wrote:
>
>>   Younas,
>>
>>   Although I don't know what are the specific data you need to analyze or
>> the tests you need to perform, some packages can certainly be recommended.
>> "RnetCDF" and "raster" are great to import netCDF files. NCAR's
>> "verification" package (
>> http://cran.r-project.org/web/packages/verification/index.html) offers
>> useful tools for analysing probabilistic or deterministic forecasts. Package
>> "clim.pact" (http://cran.r-project.org/web/packages/clim.pact/index.html)
>> might be useful as well.
>>
>>   Hope it helps,
>>
>>   Thiago.
>>
>> --- On Tue, 8/2/11, waqar younas<vickyqau at gmail.com>  wrote:
>>
>>> From: waqar younas<vickyqau at gmail.com>
>>> Subject: [R-sig-Geo] About R
>>> To: cmbarker at ucdavis.edu, r-sig-geo at r-project.org
>>> Date: Tuesday, 8 February, 2011, 22:50
>>> Hi
>>> I am PhD Candidate in UNBC, Canada and working on seasonal
>>> climate
>>> prediction data analysis. Currently, i am using MATLAB but
>>> i also want to
>>> use R for probabilistic verification package. I do not know
>>> even how to read
>>> data in R. First of all, i read the manual of R, but it is
>>> not written
>>> clearly which data formats R supports? In MATLAB, i can
>>> save my data into
>>> grid format so i want to know, how grid data can be read
>>> able in R. There is
>>> interface people use so that R can be called within MATLAB,
>>> but i do not
>>> know how?
>>>
>>> --
>>> Best Regards
>>>
>>> Waqar Younas
>>> PhD Candidate
>>> Natural Resources and Environmental Studies (NRES)
>>> University of Northern British Columbia (UNBC)
>>> Canada
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>


From wul1984 at gmail.com  Thu Feb 10 05:29:31 2011
From: wul1984 at gmail.com (Marco)
Date: Thu, 10 Feb 2011 12:29:31 +0800
Subject: [R-sig-Geo] Background Points in SDMs: Regular or Random
Message-ID: <AANLkTikZJMjWzJ_iTw1t0kjdL3ioisVwk30p5t2p9c4f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/1d5dcc4e/attachment.pl>

From phb4 at st-andrews.ac.uk  Thu Feb 10 10:27:56 2011
From: phb4 at st-andrews.ac.uk (Philipp Boersch-Supan)
Date: Thu, 10 Feb 2011 09:27:56 +0000
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTinAieXYWaXfD6Fhf7bo5iQzQ1W2dbzBnRxMo2Dm@mail.gmail.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>	<921007.49647.qm@web161407.mail.bf1.yahoo.com>	<AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>	<4D532F3E.70604@st-andrews.ac.uk>
	<AANLkTinAieXYWaXfD6Fhf7bo5iQzQ1W2dbzBnRxMo2Dm@mail.gmail.com>
Message-ID: <4D53AF9C.7040308@st-andrews.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4f722104/attachment.pl>

From roman.lustrik at gmail.com  Thu Feb 10 10:30:52 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 10 Feb 2011 10:30:52 +0100
Subject: [R-sig-Geo] About R
In-Reply-To: <4D53AF9C.7040308@st-andrews.ac.uk>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
	<921007.49647.qm@web161407.mail.bf1.yahoo.com>
	<AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>
	<4D532F3E.70604@st-andrews.ac.uk>
	<AANLkTinAieXYWaXfD6Fhf7bo5iQzQ1W2dbzBnRxMo2Dm@mail.gmail.com>
	<4D53AF9C.7040308@st-andrews.ac.uk>
Message-ID: <AANLkTikOHCmY_9w_qWk0rnPKyWPiEciDYYOPFeU6cTB+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/f68f1377/attachment.pl>

From piero.campa at gmail.com  Thu Feb 10 15:28:35 2011
From: piero.campa at gmail.com (piero campa)
Date: Thu, 10 Feb 2011 06:28:35 -0800
Subject: [R-sig-Geo] Universal Kriging with factor covariate
In-Reply-To: <4D52F3D5.8080307@uni-muenster.de>
References: <1297279939135-6009230.post@n2.nabble.com>
	<4D52F3D5.8080307@uni-muenster.de>
Message-ID: <1297348115312-6011444.post@n2.nabble.com>


Ok sure.
I will hereby simulate the interpolation of a target variable "points"
(whose data is attached) via a single factor predictor "classes" created
randomly over the region of interest:

# libraries
library(sp)
library(gstat)
library(automap)

# Import the point pattern from the txt file and turn it to Spatial
# (set properly the path variable)
points <- read.table(path, header=TRUE)
coordinates(points)<- ~ LON+LAT

# Create grid enclosing the points and fill it with random factor data 
grid <- GridTopology(c(9,43.5), c(.1,.1), c(40, 20))
SPgrid <- SpatialGridDataFrame(grid, data.frame(classes=round(runif(40*20,
1, 10))))
SPgrid$classes <- as.factor(SPgrid$classes)

# Overlay the factor covariate onto the points
ov <- overlay(SPgrid, points)
points$CL <- ov$classes

# Create the linear regression model
lm <- lm(pm10 ~ CL, points)
summary(lm)

# Fit the variogram of the residuals
rvar <- autofitVariogram(residuals(lm) ~ 1, points)

# Regression Kriging
pm10.rk <- krige(lm$call$formula, points, SPgrid, rvar)
--> HERE I HAVE ERROR:
Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "krige", for signature
"call", "SpatialPointsDataFrame"

Hope this helps getting closer to the problem,
Piero

http://r-sig-geo.2731867.n2.nabble.com/file/n6011444/2009-045.ARPA.txt
2009-045.ARPA.txt 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Universal-Kriging-with-factor-covariate-tp6009230p6011444.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From villers.alexandre at gmail.com  Thu Feb 10 15:44:06 2011
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Thu, 10 Feb 2011 16:44:06 +0200
Subject: [R-sig-Geo] Maptools as.SpatialPolygons.owin() behaves in a strange
	way ?
Message-ID: <4D53F9B6.5050504@gmail.com>

Dear list users and maptools mainteners,

I'm a bit confused by the behaviour of the function 
as.SpatialPolygons.owin()

library(spatstat)
library(maptools)

disc.test<-disc(radius=1, centre=c(0,0))
disc.sp<-as.SpatialPolygons.owin(disc.test) # <-- fails and return a 
error: could not find function "as.SpatialPolygons.owin"
disc.sp<-as(disc.test, "SpatialPolygons") # <-- works fine

On the other hand,  as.SpatialPoints.ppp(object.ppp) and as(object.ppp, 
"SpatialPoints") work fine. I haven't tested all the possibilities 
between spatstat and sp object, so I don't know if this "bug", if it is 
really one (everything seems to work fine on my PC), is widespread.
If not, I guess it was solely my Murphy's rule practise for today...


Alex

P.S.: sessionInfo()
sion 2.12.1 (2010-12-16)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United 
Kingdom.1252    LC_MONETARY=English_United Kingdom.1252 
LC_NUMERIC=C                            LC_TIME=English_United Kingdom.1252

attached base packages:
  [1] grid      grDevices datasets  splines   graphics  stats     
tcltk     utils     methods   base

other attached packages:
  [1] gpclib_1.5-1         maptools_0.7-38      foreign_0.8-41       
spatstat_1.21-4      deldir_0.0-13        mgcv_1.7-2           
rgdal_0.6-33         sp_0.9-76            effects_2.0-10
[10] colorspace_1.0-1     nnet_7.3-1           MASS_7.3-9           
ncf_1.1-3            gplots_2.8.0         caTools_1.11         
bitops_1.0-4.1       gdata_2.8.1          gtools_2.6.2
[19] scatterplot3d_0.3-31 lattice_0.19-13      svSocket_0.9-51      
TinnR_1.0.3          R2HTML_2.2           Hmisc_3.8-3          
survival_2.36-2

loaded via a namespace (and not attached):
[1] cluster_1.13.2     Matrix_0.999375-46 nlme_3.1-97        
svMisc_0.9-61      tools_2.12.1

-- 
Alexandre Villers, PhD.
Postdoc researcher
Spatial Ecology & Population Dynamics
Section of Ecology, Department of Biology
University of Turku
FIN-20014 Turku
Finland

@mail: alexandre.villers at utu.fi
phone: 00358 (0)2 333 5039
web page <http://vanha.sci.utu.fi/biologia/ekologia/villers_eng.htm>


Skype <skype:aquila06?call>


*Use open source and free softwares*
<http://cran.r-project.org/> <http://grass.itc.it/> 
<http://www.qgis.org/> <http://fr.openoffice.org/> 
<http://www.mozilla-europe.org/fr/> <http://www.mozilla-europe.org/fr/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Skypelogo.jpg
Type: image/jpeg
Size: 5395 bytes
Desc: Skypelogo.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rlogo.jpg
Type: image/jpeg
Size: 1753 bytes
Desc: Rlogo.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GRASSlogo.png
Type: image/png
Size: 3277 bytes
Desc: GRASSlogo.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: QGIS.png
Type: image/png
Size: 4144 bytes
Desc: QGIS.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: OOlogo.gif
Type: image/gif
Size: 4246 bytes
Desc: OOlogo.gif
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: TBlogo.jpg
Type: image/jpeg
Size: 1385 bytes
Desc: TBlogo.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FFlogo.jpg
Type: image/jpeg
Size: 1686 bytes
Desc: FFlogo.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/4210d867/attachment-0003.jpg>

From edzer.pebesma at uni-muenster.de  Thu Feb 10 15:45:06 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 10 Feb 2011 15:45:06 +0100
Subject: [R-sig-Geo] Universal Kriging with factor covariate
In-Reply-To: <1297348115312-6011444.post@n2.nabble.com>
References: <1297279939135-6009230.post@n2.nabble.com>	<4D52F3D5.8080307@uni-muenster.de>
	<1297348115312-6011444.post@n2.nabble.com>
Message-ID: <4D53F9F2.9050402@uni-muenster.de>



On 02/10/2011 03:28 PM, piero campa wrote:
> 
> Ok sure.
> I will hereby simulate the interpolation of a target variable "points"
> (whose data is attached) via a single factor predictor "classes" created
> randomly over the region of interest:
> 
> # libraries
> library(sp)
> library(gstat)
> library(automap)
> 
> # Import the point pattern from the txt file and turn it to Spatial
> # (set properly the path variable)
> points <- read.table(path, header=TRUE)
> coordinates(points)<- ~ LON+LAT
> 
> # Create grid enclosing the points and fill it with random factor data 
> grid <- GridTopology(c(9,43.5), c(.1,.1), c(40, 20))
> SPgrid <- SpatialGridDataFrame(grid, data.frame(classes=round(runif(40*20,
> 1, 10))))
> SPgrid$classes <- as.factor(SPgrid$classes)
> 
> # Overlay the factor covariate onto the points
> ov <- overlay(SPgrid, points)
> points$CL <- ov$classes
> 
> # Create the linear regression model
> lm <- lm(pm10 ~ CL, points)
> summary(lm)
> 
> # Fit the variogram of the residuals
> rvar <- autofitVariogram(residuals(lm) ~ 1, points)
> 
> # Regression Kriging
> pm10.rk <- krige(lm$call$formula, points, SPgrid, rvar)
> --> HERE I HAVE ERROR:
> Error in function (classes, fdef, mtable)  : 
>   unable to find an inherited method for function "krige", for signature
> "call", "SpatialPointsDataFrame"

You wrongly assumed that lm$call$formula is a formula. Try:

krige(as.formula(lm$call$formula), points, #etc

or simply:

krige(pm10 ~ CL, points, ...

Hth,

> 
> Hope this helps getting closer to the problem,
> Piero
> 
> http://r-sig-geo.2731867.n2.nabble.com/file/n6011444/2009-045.ARPA.txt
> 2009-045.ARPA.txt 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Thu Feb 10 16:03:21 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 10 Feb 2011 16:03:21 +0100
Subject: [R-sig-Geo] Maptools as.SpatialPolygons.owin() behaves in a
 strange way ?
In-Reply-To: <4D53F9B6.5050504@gmail.com>
References: <4D53F9B6.5050504@gmail.com>
Message-ID: <alpine.LRH.2.00.1102101557550.30604@reclus.nhh.no>

On Thu, 10 Feb 2011, Alexandre Villers wrote:

> Dear list users and maptools mainteners,
>
> I'm a bit confused by the behaviour of the function as.SpatialPolygons.owin()
>
> library(spatstat)
> library(maptools)
>
> disc.test<-disc(radius=1, centre=c(0,0))
> disc.sp<-as.SpatialPolygons.owin(disc.test) # <-- fails and return a error: 
> could not find function "as.SpatialPolygons.owin"
> disc.sp<-as(disc.test, "SpatialPolygons") # <-- works fine

Only the S4 coercion method as() for signature "owin", "SpatialPolygons" 
is exported in the package namespace, not the underlying function. In 
other cases, initially only the function was exported, also as an S3 
method, but when the method was converted from S3 to S4, the exporting of 
the underlying functions was not supressed, but maybe should have been. 
These are idiosyncracies that happen, because the sp class/spatstat class 
interface have developed over time, rather than being planned in a single 
step.

Hope this clarifies,

Roger

>
> On the other hand,  as.SpatialPoints.ppp(object.ppp) and as(object.ppp, 
> "SpatialPoints") work fine. I haven't tested all the possibilities between 
> spatstat and sp object, so I don't know if this "bug", if it is really one 
> (everything seems to work fine on my PC), is widespread.
> If not, I guess it was solely my Murphy's rule practise for today...
>
>
> Alex
>
> P.S.: sessionInfo()
> sion 2.12.1 (2010-12-16)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United 
> Kingdom.1252    LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C 
> LC_TIME=English_United Kingdom.1252
>
> attached base packages:
> [1] grid      grDevices datasets  splines   graphics  stats     tcltk 
> utils     methods   base
>
> other attached packages:
> [1] gpclib_1.5-1         maptools_0.7-38      foreign_0.8-41 
> spatstat_1.21-4      deldir_0.0-13        mgcv_1.7-2           rgdal_0.6-33 
> sp_0.9-76            effects_2.0-10
> [10] colorspace_1.0-1     nnet_7.3-1           MASS_7.3-9           ncf_1.1-3 
> gplots_2.8.0         caTools_1.11         bitops_1.0-4.1       gdata_2.8.1 
> gtools_2.6.2
> [19] scatterplot3d_0.3-31 lattice_0.19-13      svSocket_0.9-51 
> TinnR_1.0.3          R2HTML_2.2           Hmisc_3.8-3 
> survival_2.36-2
>
> loaded via a namespace (and not attached):
> [1] cluster_1.13.2     Matrix_0.999375-46 nlme_3.1-97        svMisc_0.9-61 
> tools_2.12.1
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From katie.stopher at ed.ac.uk  Thu Feb 10 16:31:30 2011
From: katie.stopher at ed.ac.uk (Katie Vivienne Stopher)
Date: Thu, 10 Feb 2011 15:31:30 +0000
Subject: [R-sig-Geo] Using BA to estimate home range overlap
Message-ID: <20110210153130.69d3fdmrb44oogwc@www.sms.ed.ac.uk>

My apologies, this was sent from the wrong address and so did not go  
the mailing list.

Dear Cl?ment,

Thanks for your reply. Firstly, I struggled to find you a dataset
which shows it, because it seems it's not consistent. For example, for
two particular animals, the overlap is 0.8 when just those animals are in the
dataset, but 2.5 when they are with the other (hundreds of) animals.
Why does this affect the estimate?

On investigation, I noticed several things I don't really understand:
here is a short part of my data which illustrate some of my concerns...

data
       HindCode     HindEasting    HindNorthing
1       MTT08 136220 803710
2       MTT08 136218 803403
3       MTT08 136211 803713
4       MTT08 136208 803617
5       MTT08 136213 803510
6       MTT08 136218 803605
7       MTT08 136103 803615
8       MTT08 136218 803718
9       MTT08 136019 803913
10      MTT08 136408 803619
11      MTT08 136208 803707
12      MTT08 136203 803714
13      MTT08 136212 803618
14      MTT08 136208 803707
15      MTT08 136215 803702
16      MTT08 136001 803915
17      MTT08 136202 803704
18      MTT08 136201 803706
19      MTT08 136207 803420
20      MTT08 136207 803619
21      MTT08 136209 803715
22      MTT08 136218 803713
23      MTT08 136103 803712
24      MTT08 136309 803517
25      MTT08 136414 803805
26      MTT08 136515 803703
27      MTT08 136202 803820
28      MTT08 136215 803708
29      MTT08 136308 803809
30      MTT08 136312 803511
31      MTT08 136111 803805
32      MTT08 136215 803715
33      MTT08 136201 803403
34      MTT08 136406 803716
35      MTT08 136315 803812
36      MTT08 136203 803608
37      MTT08 136215 803604
38      MTT08 136407 803711
39      MTT08 136204 803716
40      MTT08 136209 803519
41      MTT08 136308 803610
42      MTT08 136103 803711
43      MTT08 136306 803615
44      MTT08 136204 803604
45      MTT08 136318 803510
46      MTT08 136415 803704
47      MTT08 136209 803511
48      MTT08 136301 803615
49      MTT08 136319 803813
50      MTT08 136114 803709
51      MTT08 136210 803509
52      MTT08 136201 803706
53      MTT08 136308 803508
54      MTT08 136213 803717
55      MTT08 136201 803711
56      MTT08 136218 803704
57      MTT08 136217 803714
58      MTT08 136117 803916
59      MTT08 136201 803505
60      MTT08 136206 803711
61      MTT08 136210 803606
62      MTT08 136114 803706
63      MTT08 136213 803711
64      MTT08 136217 803616
65      MTT08 136413 803718
66      MTT08 136217 803605
67      MTT08 136103 803617
68      MTT08 136306 803401
69      MTT08 136315 803502
70      MTT08 136204 803708
71      MTT08 136211 803503
72      MTT08 136112 803602
73      MTT08 136315 803716
74      MTT08 136214 803513
75      MTT08 136217 803702
76      ZUC03 136012 803504
77      ZUC03 136101 803419
78      ZUC03 136105 803617
79      ZUC03 136211 803318
80      ZUC03 136211 803516
81      ZUC03 136316 803820
82      ZUC03 136201 803602
83      ZUC03 136508 803617
84      ZUC03 136310 803810
85      ZUC03 136205 803611
86      ZUC03 136301 803711
87      ZUC03 136117 803519
88      ZUC03 136307 803809
89      ZUC03 136219 803707
90      ZUC03 136408 803815
91      ZUC03 136206 803509
92      ZUC03 136202 803510
93      ZUC03 136302 803709
94      ZUC03 136307 803519
95      ZUC03 136216 803708
96      ZUC03 136415 803704
97      ZUC03 136220 803602
98      ZUC03 136717 803911
99      ZUC03 136301 803818
100     ZUC03 136308 803904
101     ZUC03 136208 803003
102     ZUC03 136410 803720
103     ZUC03 136402 803807
104     ZUC03 136105 803716
105     ZUC03 136110 803618
106     ZUC03 136116 803502
107     ZUC03 136205 803717
108     ZUC03 136215 803701
109     ZUC03 136316 802612
110     ZUC03 136317 803403
111     ZUC03 136114 803404
112     ZUC03 136313 802515
113     ZUC03 136301 803419
114     ZUC03 136307 803806
115     ZUC03 136204 803712
116     ZUC03 136307 803607
117     ZUC03 136202 803703
118     ZUC03 136314 803804
119     ZUC03 136119 803410
120     ZUC03 136218 803503
121     ZUC03 136113 803416
122     ZUC03 136315 803514
123     ZUC03 136215 803611
124     ZUC03 136302 803519
125     ZUC03 136108 803407
126     ZUC03 136404 803920
127     ZUC03 136213 803511
128     ZUC03 136315 802804
129     ZUC03 136217 803420
130     ZUC03 136305 803708
131     ZUC03 136718 803403
132     ZUC03 137219 802911
133     ZUC03 136120 803701
134     ZUC03 136203 803511
135     ZUC03 136420 803820
136     ZUC03 136306 803704
137     ZUC03 136407 802517
138     ZUC03 136216 803607
139     ZUC03 136314 803706
140     ZUC03 136118 803418
141     ZUC03 136406 803809
142     ZUC03 136015 803904
143     ZUC03 136315 803820
144     ZUC03 136413 803806
145     ZUC03 136303 803801
146     ZUC03 136210 803701
147     ZUC03 136305 803615
148     ZUC03 136214 803612
149     ZUC03 136314 803411
150     ZUC03 136320 803711
151     ZUC03 136108 803705
152     ZUC03 136111 803719
153     ZUC03 136212 803613
154     ZUC03 136305 803602
155     ZUC03 136317 802815
156     ZUC03 136210 803818
157     ZUC03 136202 803702
158     ZUC03 136318 802618
159     ZUC03 136417 803512
160     ZUC03 136212 803501
161     ZUC03 136417 802615
162     ZUC03 136306 803617
163     ZUC03 136414 803710
164     ZUC03 136107 803711
165     ZUC03 136207 803702
166     ZUC03 136204 803617
167     ZUC03 136319 803803
168     ZUC03 136413 803814
169     ZUC03 136318 803508
170     ZUC03 136207 803502
171     ZUC03 136204 803613
172     ZUC03 136206 803601
173     ZUC03 136211 803519
174     ZUC03 136313 803816
175     ZUC03 136218 803709
176     ZUC03 136301 802614
177     ZUC03 136018 803611
178     ZUC03 136308 803519
179     ZUC03 136412 802415
180     ZUC03 136307 803712
181     ZUC03 136406 803801
182     ZUC03 137013 802302
183     ZUC03 136309 803916
184     ZUC03 136313 803813
185     ZUC03 136320 803509
186     ZUC03 136217 803517
187     ZUC03 136708 803014
188     ZUC03 136214 803719
189     ZUC03 136204 803714
190     ZUC03 136509 803715
191     ZUC03 136310 802902
192     ZUC03 136320 803507
193     ZUC03 136205 803618
194     ZUC03 136207 803014
195     ZUC03 136211 803507
196     ZUC03 136208 803410
197     ZUC03 136210 803713
198     ZUC03 136105 803609
199     ZUC03 136208 803609
200     ZUC03 136219 803719
201     ZUC03 136211 803619
202     ZUC03 136219 803715
203     ZUC03 136207 803211
204     ZUC03 136202 803608
205     ZUC03 136203 803707
206     ZUC03 136201 803303
207     ZUC03 136212 803714
208     ZUC03 136220 803515
209     ZUC03 136209 803412
210     ZUC03 136404 802509
211     ZUC03 136211 803513
212     ZUC03 136119 803615
213     ZUC03 136218 803715
214     ZUC03 136201 803702
215     ZUC03 136218 803809
216     ZUC03 136202 803610
217     ZUC03 136402 803804
218     ZUC03 136102 803216
219     ZUC03 136204 803317
220     ZUC03 136506 803918
221     ZUC03 136201 803704
222     ZUC03 136108 803914
223     ZUC03 136520 803813
224     ZUC03 136208 803614
225     ZUC03 136215 803715
226     ZUC03 136217 803312
227     ZUC03 136207 803116
228     ZUC03 136212 803706
229     ZUC03 136117 803910
230     ZUC03 136220 803419
231     ZUC03 136304 803711
232     ZUC03 136220 803716
233     ZUC03 136215 803710
234     ZUC03 136220 803720
235     ZUC03 136202 803708
236     ZUC03 136411 803607
237     ZUC03 136203 803702
238     ZUC03 136219 803510
239     ZUC03 136216 803802
240     ZUC03 136614 803816
241     ZUC03 136610 803818
242     ZUC03 136701 803601
243     ZUC03 136202 803203
244     ZUC03 136211 803616
245     ZUC03 136207 803312
246     ZUC03 136208 803720
247     ZUC03 136209 803815
248     ZUC03 136203 803720
249     ZUC03 136212 803619
250     ZUC03 136117 803710
251     ZUC03 136214 803113
252     ZUC03 136319 803803
253     ZUC03 136207 803418
254     ZUC03 136111 803610
255     ZUC03 136202 803311
256     ZUC03 136106 803711
257     ZUC03 136208 803514
258     ZUC03 136116 803218
259     ZUC03 136209 803602
260     ZUC03 136213 803008
261     ZUC03 136617 804019
262     ZUC03 137003 803015
263     ZUC03 136202 803604
264     ZUC03 136219 803618
265     ZUC03 136304 803712
266     ZUC03 136105 803416
267     ZUC03 136209 803703
268     ZUC03 136114 803706
269     ZUC03 136117 803817
270     ZUC03 136216 803712
271     ZUC03 136403 802411
272     ZUC03 136314 803815
273     ZUC03 136213 803403
274     ZUC03 136207 803408
275     ZUC03 136203 803307
276     ZUC03 136220 803201
277     ZUC03 136314 803703
278     ZUC03 136211 803717
279     ZUC03 136301 802710
280     ZUC03 136301 803807
281     ZUC03 136216 803703
282     ZUC03 136311 803713
283     ZUC03 136212 803318
284     ZUC03 136219 803720
285     ZUC03 136211 803319
286     ZUC03 136217 803718
287     ZUC03 136203 803605
288     ZUC03 136305 802802
289     ZUC03 136204 803615
290     ZUC03 136104 803909
291     ZUC03 136209 803717
292     ZUC03 136208 803519
293     ZUC03 136401 803720
294     ZUC03 136405 803518
295     ZUC03 136208 803709
296     ZUC03 136310 803506
297     ZUC03 136219 803404
298     ZUC03 136206 803606
299     ZUC03 136205 803216
300     ZUC03 136201 803119
301     ZUC03 136302 803515
302     ZUC03 136113 803707
303     ZUC03 136220 803114
304     ZUC03 136315 803513
305     ZUC03 136304 803520
306     ZUC03 136208 803315
307     ZUC03 136307 803611
308     ZUC03 136203 803712
309     ZUC03 136220 803409
310     ZUC03 136202 803008
311     ZUC03 136216 803515
312     ZUC03 136208 803409
313     ZUC03 136304 802812
314     ZUC03 136316 802811
315     ZUC03 136212 803504
316     ZUC03 136213 803609
317     ZUC03 136213 803505
318     ZUC03 136220 803720
319     ZUC03 136202 803516
320     ZUC03 136318 803519
321     ZUC03 136320 803803
322     ZUC03 136319 803805
323     ZUC03 136218 803201
324     ZUC03 136107 803601
325     ZUC03 136216 803503
326     ZUC03 136009 803802
327     ZUC03 136202 803606
328     ZUC03 136109 803703
329     ZUC03 136306 802609
330     ZUC03 136215 803714
331     ZUC03 136204 803718
332     ZUC03 136103 803804
333     ZUC03 136207 803714
334     ZUC03 136317 803810
335     ZUC03 136106 803909
336     ZUC03 136105 803702
337     ZUC03 136212 803415
338     ZUC03 136207 803610
339     ZUC03 136217 803509
340     ZUC03 136219 803714
341     ZUC03 136314 803520
342     ZUC03 136303 803517
343     ZUC03 136609 803008
344     ZUC03 136202 803618
345     ZUC03 136310 803809
346     ZUC03 137019 802914
347     ZUC03 136302 803711
348     ZUC03 136220 803703
349     ZUC03 136305 803315
350     ZUC03 136306 803006
351     ZUC03 136208 803308
352     ZUC03 136207 803819
353     ZUC03 136205 803402
354     ZUC03 136104 803709
355     ZUC03 136407 803820
356     ZUC03 136510 803613
357     ZUC03 136215 803602
358     ZUC03 136204 803616
359     ZUC03 136920 802812
360     ZUC03 136206 803612
361     ZUC03 136109 803814
362     ZUC03 136213 803616
363     ZUC03 136416 803704
364     ZUC03 136208 803514
365     ZUC03 136113 803411
366     ZUC03 136320 803803
367     ZUC03 136609 804208
368     ZUC03 136504 803417
369     ZUC03 136317 803808
370     ZUC03 136513 803818
371     ZUC03 136208 803601
372     ZUC03 136206 803511
373     ZUC03 136603 803810
374     ZUC03 136202 803618
375     ZUC03 136302 803505
376     ZUC03 136318 803812
377     ZUC03 136408 803118
378     ZUC03 136204 803014
379     ZUC03 136614 803504
380     ZUC03 136209 803505
381     ZUC03 136309 803915
382     ZUC03 136312 803616
383     ZUC03 136219 803610
384     ZUC03 136320 802615
385     ZUC03 136303 802509
386     ZUC03 136315 803603
387     ZUC03 136215 803619
388     ZUC03 136210 803602
389     ZUC03 136313 803820
390     ZUC03 136809 802509
391     ZUC03 136211 803605
392     ZUC03 136318 803508
393     ZUC03 136210 803410
394     ZUC03 136304 803514
395     ZUC03 137106 803003
396     ZUC03 136101 803502
397     ZUC03 136218 803820
398     ZUC03 136318 803803
399     ZUC03 136309 802911
400     ZUC03 136320 803708
401     ZUC03 136801 803401
402     ZUC03 136310 802605
403     ZUC03 136408 803513
404     ZUC03 136318 803908
405     ZUC03 136405 803809
406     ZUC03 136206 803505
407     ZUC03 136314 803817
408     ZUC03 136316 802816
409     ZUC03 136203 803511
410     ZUC03 136310 803811
411     ZUC03 136304 803302
412     ZUC03 136204 803515
464     ADZ84 138204 804018
465     ADZ84 137820 804217
466     ADZ84 137820 804201
467     ADZ84 137613 804310
468     ADZ84 137809 804102
469     ADZ84 137808 804310
470     ADZ84 137820 804207
471     ADZ84 136312 800204
472     ADZ84 137720 804205
473     ADZ84 137709 804315
474     ADZ84 137711 804403
475     ADZ84 137813 804317
476     ADZ84 137810 804207
477     ADZ84 138305 804008
478     ADZ84 137802 804215
479     ADZ84 137820 804217
480     ADZ84 137817 804312
481     ADZ84 137908 804216
482     ADZ84 137806 804304
483     ADZ84 137912 804219
484     ADZ84 137719 804311
485     ADZ84 137917 804202
486     ADZ84 137918 804301
487     ADZ84 137811 804309
488     ADZ84 138303 804212
489     ADZ84 137801 804220
490     ADZ84 137609 804311
491     ADZ84 137912 804218
492     ADZ84 137808 804210
493     ADZ84 137820 804208
494     ADZ84 137805 804111
495     ADZ84 137713 804316
496     ADZ84 137813 804115
497     ADZ84 137802 804103
498     ADZ84 137702 804207
499     ADZ84 137802 804108
500     ADZ84 138006 804415
501     ADZ84 137819 804211
502     ADZ84 137711 804212
503     ADZ84 137814 804206
504     ADZ84 137815 804210
505     ADZ84 137907 804310
506     ADZ84 137816 804206
507     ADZ84 137918 804217
508     ADZ84 137508 804308
509     ADZ84 137815 804101
510     ADZ84 137911 804317
511     ADZ84 137816 804215
512     ADZ84 137911 804212
513     ADZ84 136620 803816
514     ADZ84 137707 804302
515     ADZ84 137806 804207
516     ADZ84 137804 804311
517     ADZ84 137807 804312
518     ADZ84 137709 804309
519     ADZ84 137905 804303
520     ADZ84 137816 804216
521     ADZ84 137710 804310
522     ADZ84 137813 804205
523     ADZ84 137911 804313
524     ADZ84 137615 804416
525     ADZ84 137706 804315
526     ADZ84 137912 804011
527     ADZ84 137815 804116
528     ADZ84 137817 804320
529     ADZ84 137902 804208
530     ADZ84 136817 802313
531     ADZ84 137710 804320
532     ADZ84 138013 804005
533     ADZ84 137619 804419
534     ADZ84 137717 804617
535     ADZ84 138015 804218
536     ADZ84 138201 804112
537     ADZ84 137706 804212
538     ADZ84 137917 804213
539     ADZ84 137813 804214
540     ADZ84 137808 804220
541     ADZ84 137706 804209
542     ADZ84 138320 804013
543     ADZ84 137816 804101
544     ADZ84 138216 804102
545     ADZ84 137801 804214
546     ADZ84 137809 804207
547     AGA84 139014 803511
548     AGA84 139004 803409
549     AGA84 138903 803419
550     AGA84 138908 803313
551     AGA84 138915 803507
552     ALB93 138005 804115
553     ALB93 137614 804302
554     ALB93 137916 804107
555     ALB93 137805 804317
556     ALB93 137910 804213
557     ALB93 137914 804317
558     ALB93 137908 804202
559     ALB93 137905 803517
560     ALB93 138019 804320
561     ALB93 137819 804202
562     ALB93 137801 804317
563     ALB93 137914 804220
564     ALB93 137806 804219
565     ALB93 138014 804402
566     ALB93 137702 804401
567     ALB93 137919 804212
568     ALB93 137914 804212
569     ALB93 137913 804318
570     ALB93 137514 804102
571     ALB93 138008 804108
572     ALB93 137709 804317
573     ALB93 137915 804019
574     ALB93 137715 804513
575     ALB93 137717 804312
576     ALB93 137803 804411
577     ALB93 138011 804404
578     ALB93 137710 804211
579     ALB93 137816 804401
580     ALB93 137915 804003
581     ALB93 137809 804202
582     ALB93 137702 804420
583     ALB93 137618 804218
584     ALB93 137703 804220
585     ALB93 137713 804514
586     ALB93 137902 804209
587     ALB93 137714 804307
588     ALB93 137610 804104
589     ALB93 137816 804305
590     ALB93 138011 803901
591     ALB93 138010 804203
592     ALB93 137715 804408
593     ALB93 138310 804204
594     ALB93 138001 804319
595     ALB93 137706 804320
596     ALB93 137014 804317
597     ALB93 137816 804019
598     ALB93 137711 804217
599     ALB93 137807 804405
600     ALB93 137702 804314
601     ALB93 137919 804313
602     ALB93 137801 804401
603     ALB93 137818 804412
604     ALB93 137801 804711
605     ALB93 137917 804314
606     ALB93 138020 804406
607     ALB93 137602 804309
608     ALB93 137819 804118
609     ALB93 137717 804118
610     ALB93 138013 803915
611     ALB93 138014 804411
612     ALB93 137901 804211
613     ALB93 137605 804308
614     ALB93 137817 804212
615     ALB93 137710 804314
616     ALB93 137810 804305
617     ALB93 137717 804419
618     ALB93 138010 804412
619     ALB93 137804 804305
620     ALB93 137918 804419
621     ALB93 137711 804505
622     ALB93 137820 804117
623     ALB93 137820 804206
624     ALB93 137603 804404
625     ALB93 138215 804217
626     ALB93 137804 804206
627     ALB93 137820 804205
628     ALB93 138017 804107
629     ALB93 138016 804314
630     ALB93 137801 804112
631     ALB93 138210 804120
632     ALB93 137819 804416
633     ALB93 137809 804003
634     ALB93 137917 804105
635     ALB93 137908 804309
636     ALB93 138207 804109
637     ALB93 137805 804310
638     ALB93 137720 804316
639     ALB93 138006 804312
640     ALB93 137815 804204
641     ALB93 138311 804008
642     ALB93 137920 804015
643     ALB93 138116 804505
644     ALB93 137919 804320
645     ALB93 138114 804316
646     ALB93 138017 804318
647     ALB93 138302 804015
648     ALB93 137805 804119
649     ALB93 137905 804309
650     ALB93 137915 804314
651     ALB93 137706 804402
652     ALB93 137908 804003
653     ALB93 137911 804216
654     ALB93 137803 804119
655     ALB93 137818 804217
656     ALB93 138018 804204
657     ALB93 137819 804202
658     ALB93 137904 804105
659     ALB93 138004 804207
660     ALB93 137715 804519
661     ALB93 138017 804319
662     ALB93 137806 804313
663     ALB93 138012 804313
664     ALB93 137811 804102
665     ALB93 137816 804217
666     ALB93 134611 804318
667     ALB93 137806 804402
668     ALB93 137912 804315
669     ALB93 137911 804410
670     ALB93 137815 804211
671     ALB93 137613 804314
672     ALB93 137802 804312
673     ALB93 137704 804616
674     ALB93 137802 804303
675     ALB93 137717 804309
676     ALB93 137817 804119
677     ALB93 137806 804301
678     ALB93 136305 803609
679     ALB93 137601 804309
680     ALB93 137618 804307
681     ALB93 138004 804401
682     ALB93 137714 804319
683     ALB93 137712 804502
684     ALB93 137813 804218
685     ALB93 137616 804420
686     ALB93 137713 804303
687     ALB93 137804 804309
688     ALB93 137709 804519
689     ALB93 137918 804311
690     ALB93 138006 804306
691     ALB93 137820 804206
692     ALB93 137804 804306
693     ALB93 137711 804320
694     ALB93 137818 804201
695     ALB93 137816 804415
696     ALB93 137810 804206
697     ALB93 137501 804315
698     ALB93 137702 804404
699     ALB93 137907 804209
700     ALB93 137505 804713
701     ALB93 137911 804215
702     ALB93 137801 804206
703     ALB93 137718 804405
704     ALB93 138009 804402
705     ALB94 137703 804501
706     ALB94 137811 804216
707     ALB94 137913 804304
708     ALB94 137904 804303
709     ALB94 137714 804407
710     ALB94 137602 804407
711     ALB94 137816 804415
712     ALB94 137812 804304
713     ALB94 137704 804319
714     ALB94 137813 804202
715     ALB94 137605 804210
716     ALB94 137806 804315
717     ALB94 137702 804302
718     ALB94 137710 804312
719     ALB94 137904 804316
720     ALB94 138007 804411
721     ALB94 137719 804318
722     ALB94 137814 804317
723     ALB94 137906 804214
724     ALB94 137809 804309
725     ALB94 137720 804310
726     ALB94 137711 804505
727     ALB94 137905 804004
728     ALB94 137707 804101
729     ALB94 137809 804308
730     ALB94 137818 804316
731     ALB94 137806 804320
732     ALB94 137815 804301
733     ALB94 137619 804409
734     ALB94 137712 804414
735     ALB94 137808 804418
736     ALB94 137701 804413
737     ALB94 137814 804206
738     ALB94 137819 804109
739     ALB94 137716 804308
740     ALB94 137704 804409
741     ALB94 137805 804312
742     ALB94 137916 804304
743     ALB94 138016 804312
744     ALB94 137812 804205
745     ALB94 137801 804105
746     ALB94 137410 804512
747     ALB94 137711 804312
748     ALB94 137804 804317
749     ALB94 137813 804301
750     ALB94 137713 804310
751     ALB94 137716 804211
752     ALB94 138210 804308
753     ALB94 137813 804204
754     ALB94 137811 804220
755     ALB94 138018 804410
756     ALB94 137714 804314
757     ALB94 137808 804419
758     ALB94 137703 804308
759     ALB94 138019 804411
760     ALB94 137608 804404
761     ALB94 138016 804307
762     ALB94 137607 804420
763     ALB94 138007 804316
764     ALB94 138008 804315
765     ALB94 137707 804214
766     ALB94 137707 804503
767     ALB94 137817 804312
768     ALB94 137614 804317
769     ALB94 137718 804304
770     ALB94 137702 803717
771     ALB94 137618 804302
772     ALB94 138007 804216
773     ALB94 137820 804713
774     ALB94 137813 804316
775     ALB94 137804 804220
776     ALB94 137713 804419
777     ALB94 137612 804313
778     ALB94 137909 804212
779     ALB94 137804 804208
780     ALB94 137615 804318
781     ALB94 137716 804305
782     ALB94 138020 804102
783     ALB94 137818 804307
784     ALB94 137618 804312
785     ALB94 137811 804214
786     ALB94 137914 804209
787     ALB94 138009 804113
788     ALB94 138117 804405
789     ALB94 137915 804014
790     ALB94 137807 804208
791     ALB94 137619 804317
792     ALB94 137813 804316
793     ALB94 137717 804219
794     ALB94 137905 804314
795     ALB94 137904 804303
796     ALB94 137620 804306
797     ALB94 137718 804515
798     ALB94 137617 804406
799     ALB94 137820 804411
800     ALB94 137708 804509
801     ALB94 137702 804518
802     ALB94 137819 804312
803     ALB94 137906 804219
804     ALB94 137809 804305
805     ALB94 137717 804313
806     ALB94 137911 804203
807     ALB94 137811 804219
808     ALB94 137805 804211
809     ALB94 137605 804513
810     ALB94 137902 804218
811     ALB94 137603 804302
812     ALB94 137713 804417
813     ALB94 137709 804506
814     ALB94 137811 804215
815     ALB94 137912 804314
816     ALB94 137620 804304
817     ALB94 138015 804406
818     ALB94 137802 804412
819     ALB94 138017 804313
820     ALB94 137802 804208
821     ALB94 137919 804411
822     ALB94 137811 804119
823     ALB94 137717 804307
824     ALB94 137716 804601
825     ALB94 137916 804402
826     ALB94 137709 804306
827     ALB94 137807 804416
828     ALB94 137718 804220
829     ALB94 137919 804103
830     ALB94 137920 804312
831     ALB94 137912 804319
832     ALB94 137912 804309
833     ALB94 137810 804307
834     ALB94 137820 804301
835     ALB94 137604 804301
836     ALB94 137917 804205
837     ALB94 137803 804211
838     ALB94 137912 804215
839     ALB94 137710 804416
840     ALB94 137805 804319
841     ALB94 137910 804207
842     ALB94 138018 804215
843     ALB94 137820 804201
844     ALB94 137808 804217
845     ALB94 137819 804310
846     ALB94 137720 804419
847     ALB94 138012 804215
848     ALB94 138004 804208
849     ALB94 137605 804401
850     ALB94 138012 804303
851     ALB94 137701 804301
852     ALB94 137918 804003
853     ALB94 137607 804312
854     ALB94 137316 804511
855     ALB94 137610 804514
856     ALB94 137810 804213
857     ALB94 137619 804405
858     ALB94 138013 804315
859     ALB94 137715 804507
860     ALB94 137712 804307
861     ALB94 137714 804310
862     ALB94 137707 804309
863     ALB94 137804 804204
864     ALB94 137912 804311
865     ALB94 137904 804114
866     ALB94 137807 804306
867     ALB94 137704 804414
868     ALB94 137802 804215
869     ALB94 137814 804308
870     ALB94 137815 804407
871     ALB94 137706 804313
872     ALB94 137806 804109
873     ALB94 137916 804301
874     ALB94 137819 804109
875     ALB94 137717 804615
876     ALB94 137820 804317
877     ALB94 137617 804405
878     ALB94 137707 804312
879     ALB94 137613 804410
880     ALB94 137607 804318
881     ALB94 137802 804020
882     ALB94 137809 804203
883     ALB94 137904 804118
884     ALB94 137911 804319
885     ALB94 137818 804206
886     ALB94 137717 804314
887     ALB94 137803 804211
888     ALB94 137610 804510
889     ALB94 137919 804116
890     ALB94 138005 804216
891     ALB94 137806 804217
892     ALB94 137704 804306
893     ALB94 137904 804209
894     ALB94 138007 804306
895     ALB94 137803 804408
896     ALB94 137611 804506
897     ALB94 137814 804217
898     ALB94 137917 804305
899     ALB94 137707 804604
900     ALB94 137808 804215
901     ALB94 137820 804308
902     ALB94 137716 804401
903     ALB94 137611 804509
904     ALB94 137804 804305
905     ALB94 137918 804307
906     ALB94 137804 804209
907     ALB94 137801 804307
908     ALB94 137717 804307
909     ALB94 137716 804619
910     ALB94 137920 804218
911     ALB94 137819 804205
912     ALB94 137814 804219
913     ALB94 137703 804403
914     ALB94 137820 804316
915     ALB94 137811 804409
916     ALB94 138108 804408
917     ALB94 137714 804301
918     ALB94 138102 804409
919     ALB94 137711 804616
920     ALB94 137906 804309
921     ALB94 137506 804315
922     ALB94 137705 804513
923     ALB94 137707 804404
924     ALB94 137706 804313
925     ALB94 137710 804316
926     ALB94 137913 804320
927     ALB94 137817 804416
928     ALB94 138110 804504
929     ALB94 137711 804609
930     ALB94 137817 804403
931     ALB94 138109 804501
932     ALB94 137713 804803
933     ALB94 137701 804205
934     ALB94 137804 804310
935     ALB94 137715 804516
936     ALB94 137809 804204
937     ALB94 138015 804305
938     ALB94 137804 804317
939     ALB94 137809 804214
940     ALB94 137720 804217
941     ALB94 137910 804315
942     ALB94 137818 804202
943     ALB94 137717 804520
944     ALB94 137514 804715
945     ALB94 138011 804415
946     ALB94 138014 804303
947     ALB94 138018 804010
948     ALB94 137906 804411
949     ALB94 137707 804507
950     ALB94 137108 804301
951     ALB94 138017 804413
952     ALB94 137814 804313
953     ALB94 137819 804216
954     ALB94 138019 804220
955     ALB94 138211 804310
956     ALB94 137701 804308
957     ALB94 137806 804408
958     ALB94 137708 804318
959     ALB94 137806 804210
960     ALB94 138009 804314
961     ALB94 137717 804103
962     ALB94 137720 804511
963     ALB94 137711 804408
964     ALB94 137703 804516
965     ALB94 137902 804216
966     ALB94 137911 804307
967     ALB94 137802 804305
968     ALB94 137907 804204
969     ALB94 138301 804211
970     ALB94 137717 804507
971     ALB94 138014 804404
972     ALB94 137706 804417
973     ALB94 137801 804315
974     ALB94 138011 804208
975     ALB94 137914 804211
976     ALB94 137805 804215
977     ALB94 138015 804203
978     ALB94 138009 804116
979     ALB94 137803 804301
980     ALB94 137809 804209
981     ALB94 137916 804313
982     ALB94 137906 804202
983     ALB94 138011 804217
984     ALB94 137718 804310
985     ALB94 137708 804310
986     ALB94 137913 804316
987     ALB94 137711 804305
988     ALB94 137806 804412
989     ALB94 137715 804218
990     ALB94 138003 804103
991     ALB94 137712 804610
992     ALB94 137815 804309
993     ALB94 137710 804309
994     ALB94 138004 804302
995     ALB94 137816 804208
996     ALB94 137803 804316
997     ALB94 138008 804305
998     ALD01 136017 799609
999     ALD01 135806 799607
1000    ALD01 136211 799704
1001    ALD01 136411 799703
1002    ALD01 136114 800020
1003    ALD01 135903 800112
1004    ALD01 136103 800002
1005    ALD01 136019 800412
1006    ALD01 135917 800307
1007    ALD01 136208 803308
1008    ALD01 135817 799815
1009    ALD01 135703 799615
1010    ALD01 136110 800019
1011    ALD01 136118 800214
1012    ALD01 135709 800008
1013    ALD01 135715 799820
1014    ALD01 135804 799809
1015    ALD01 135913 799712
1016    ALD01 135902 799620
1017    ALD01 135808 799917
1018    ALD01 135811 799817
1019    ALD01 135713 799912

I run the code:
attach(data)
xy<-data[,c('HindEasting','HindNorthing')]
id<-data[,c('HindCode')]
overlap<-kerneloverlap(xy, id, "BA", lev=70)
overlap

ADZ84       AGA84       ALB93        ALB94        ALD01      MTT08
     ZUC03
ADZ84 0.999849342 0.001099955 0.947550033 8.325797e-01 7.369769e-02
0.03724038 6.802129e-02
AGA84 0.001099955 0.617374973 0.000000000 0.000000e+00 0.000000e+00
0.00000000 0.000000e+00
ALB93 0.947550033 0.000000000 1.001283594 9.315747e-01 8.918488e-03
0.07345993 6.452670e-02
ALB94 0.832579743 0.000000000 0.931574726 9.982076e-01 7.085758e-05
0.00000000 1.483764e-05
ALD01 0.073697689 0.000000000 0.008918488 7.085758e-05 9.998785e-01
0.10116419 1.602841e-01
MTT08 0.037240379 0.000000000 0.073459931 0.000000e+00 1.011642e-01
1.10457210 8.746404e-01
ZUC03 0.068021294 0.000000000 0.064526705 1.483764e-05 1.602841e-01
0.87464037 9.874610e-01

Sorry if that is hard to read- not sure of a better way to show it. My
questions are:

1. Why is the overlap of AGA84 with itself much less than 1?
2. Why is the overlap of MTT08 with itself more than 1?
3. Why does the overlap not change when you change the isopleth? (it
does with UDOI)

eg

> overlap<-kerneloverlap(xy, id, "BA", lev=70) overlap
              ADZ84       AGA84       ALB93        ALB94        ALD01
     MTT08        ZUC03
ADZ84 0.999849342 0.001099955 0.947550033 8.325797e-01 7.369769e-02
0.03724038 6.802129e-02
AGA84 0.001099955 0.617374973 0.000000000 0.000000e+00 0.000000e+00
0.00000000 0.000000e+00
ALB93 0.947550033 0.000000000 1.001283594 9.315747e-01 8.918488e-03
0.07345993 6.452670e-02
ALB94 0.832579743 0.000000000 0.931574726 9.982076e-01 7.085758e-05
0.00000000 1.483764e-05
ALD01 0.073697689 0.000000000 0.008918488 7.085758e-05 9.998785e-01
0.10116419 1.602841e-01
MTT08 0.037240379 0.000000000 0.073459931 0.000000e+00 1.011642e-01
1.10457210 8.746404e-01
ZUC03 0.068021294 0.000000000 0.064526705 1.483764e-05 1.602841e-01
0.87464037 9.874610e-01
> overlap<-kerneloverlap(xy, id, "BA", lev=10) overlap
              ADZ84       AGA84       ALB93        ALB94        ALD01
     MTT08        ZUC03
ADZ84 0.999849342 0.001099955 0.947550033 8.325797e-01 7.369769e-02
0.03724038 6.802129e-02
AGA84 0.001099955 0.617374973 0.000000000 0.000000e+00 0.000000e+00
0.00000000 0.000000e+00
ALB93 0.947550033 0.000000000 1.001283594 9.315747e-01 8.918488e-03
0.07345993 6.452670e-02
ALB94 0.832579743 0.000000000 0.931574726 9.982076e-01 7.085758e-05
0.00000000 1.483764e-05
ALD01 0.073697689 0.000000000 0.008918488 7.085758e-05 9.998785e-01
0.10116419 1.602841e-01
MTT08 0.037240379 0.000000000 0.073459931 0.000000e+00 1.011642e-01
1.10457210 8.746404e-01
ZUC03 0.068021294 0.000000000 0.064526705 1.483764e-05 1.602841e-01
0.87464037 9.874610e-01

Thanks for your help, and apologies I can't find a dataset to
illustrate my first problem- perhaps if I understand why it depends on
which other animals are included I will be able to identify a small
enough dataset to send you.

Thanks,

Katie

>
   <clement.calenge at oncfs.gouv.fr>:

> [snip]
>> My code is fairly straightforward:
>>
>> xy<-locations[,c('Easting','Northing')]
>> id<-locations[,c('Code')]
>> overlap<-kerneloverlap(xy, id, "BA", 65)
>>
>> But the results are surprising: in particular, some pairs of    
>> individuals have an overlap greater than one- up to above 2 in some  
>>   cases. Can anyone explain to me why this might be?
>
> This is rather strange indeed. I read the code again, but I did not
> find any bug in the implementation of the function. Could you send a
> reproducible example (e.g. two animals characterized by a BA index >
> 1), to have a better idea of what happens?
> Best regards,
>
> Cl?ment Calenge
>
> -- 
> Cl?ment CALENGE
> Cellule d'appui ? l'analyse de donn?es
> Direction des Etudes et de la Recherche
> Office national de la chasse et de la faune sauvage
> Saint Benoist - 78610 Auffargis
> tel. (33) 01.30.46.54.14



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.





----- End forwarded message -----


-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From piero.campa at gmail.com  Thu Feb 10 16:53:42 2011
From: piero.campa at gmail.com (piero campa)
Date: Thu, 10 Feb 2011 07:53:42 -0800
Subject: [R-sig-Geo] Universal Kriging with factor covariate
In-Reply-To: <4D53F9F2.9050402@uni-muenster.de>
References: <1297279939135-6009230.post@n2.nabble.com>
	<4D52F3D5.8080307@uni-muenster.de>
	<1297348115312-6011444.post@n2.nabble.com>
	<4D53F9F2.9050402@uni-muenster.de>
Message-ID: <1297353222154-6012190.post@n2.nabble.com>


That's it. Thank you!
Piero

PS:
To let the example work actually before calling krige() you should run this
command:
names(SPgrid) <- "CL"

Moreover the right krige call is the following:
pm10.rk <- krige(as.formula(lm$call$formula), points, SPgrid,
rvar$var_model)
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Universal-Kriging-with-factor-covariate-tp6009230p6012190.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ana-lee at web.de  Thu Feb 10 17:02:23 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Thu, 10 Feb 2011 17:02:23 +0100
Subject: [R-sig-Geo] problems with loading geoR and sp
Message-ID: <4D540C0F.7020401@web.de>

hey guys, i'm trying to work with CRAN package geoR. I installed it but 
loading it needs a shared library(sp). So i downloaded sp as well and 
installed it successfully. but when i load the library(sp) it says that 
it was not found and the warnings say it was constructed under r version 
and so on. So what is going on there? Is there a different way of 
installing some packages? I attached the original error messages. only 
they are in german - mabe someone understands...

thank you! Anna

here's the error message:


 > library(sp)

Error in library.dynam(lib, package, package.lib) :
   shared library 'sp' nicht gefunden
Zus?tzlich: Warnmeldung:
Paket 'sp' wurde unter R Version 2.12.1 gebaut
Fehler: Laden von Paket/Namensraum f?r 'sp' fehlgeschlagen

 > library(geoR)

Lade n?tiges Paket: sp
Error in library.dynam(lib, package, package.lib) :
   shared library 'sp' nicht gefunden
Zus?tzlich: Warnmeldungen:
1: Paket 'geoR' wurde unter R Version 2.12.1 gebaut
2: Paket 'sp' wurde unter R Version 2.12.1 gebaut
Fehler: Paket 'sp' konnte nicht geladen werden


From roman.lustrik at gmail.com  Thu Feb 10 17:06:21 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 10 Feb 2011 17:06:21 +0100
Subject: [R-sig-Geo] problems with loading geoR and sp
In-Reply-To: <4D540C0F.7020401@web.de>
References: <4D540C0F.7020401@web.de>
Message-ID: <AANLkTimLr=153o-qeKFQJe4v1VSB_RJpchhONL_0K5xC@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/8d95c0ae/attachment.pl>

From david.depew at queensu.ca  Thu Feb 10 18:00:18 2011
From: david.depew at queensu.ca (david depew)
Date: Thu, 10 Feb 2011 12:00:18 -0500
Subject: [R-sig-Geo] Question for point pattern experts
Message-ID: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/195adc04/attachment.pl>

From r.turner at auckland.ac.nz  Thu Feb 10 21:42:05 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 11 Feb 2011 09:42:05 +1300
Subject: [R-sig-Geo] Question for point pattern experts
In-Reply-To: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>
References: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>
Message-ID: <865358BB-2C1E-478C-B914-37672033E9CF@auckland.ac.nz>


On 11/02/2011, at 6:00 AM, david depew wrote:

> Dear list,
> A brief and (hopefully) simplistic question regarding point pattern
> analysis.
>
> We have compiled a large, continental database of chemical burdens  
> in a
> model organism. Currently, the data span 40 years and covers the  
> entire
> country of Canada (including the high arctic). We have categorized the
> numeric data into categorical data (i.e. categorical marks) based  
> on risk
> thresholds. We'd like to assess whether or not there are  
> interesting spatial
> patterns ( i.e. clusters of levels of risk (high vs low)), much like a
> case/control approach. My question is as follows;
>
> Is there a "best" geographic projection for this approach?  
> Currently all
> data are in Latitude/Longitude. My inclination is to use something  
> along the
> lines of an equal area projection to maintain a reasonable  
> representation of
> spatial dispersion.

This doesn't sound to me like ***point pattern*** data.  It sounds like
you have taken measurements of ``chemical burdens'' in a particular
organism, at a number of ***chosen*** sites over a number (40) of years.

Thus the observation points are deterministic, not random, and so point
pattern analysis doesn't come into it.

It may be the case that some sort of combination of kriging and time  
series
or repeated measures analysis might be called for.  But here I speak of
that of which I know nothing.

	cheers,

		Rolf Turner


From gianni.lavaredo at gmail.com  Thu Feb 10 21:56:02 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 10 Feb 2011 21:56:02 +0100
Subject: [R-sig-Geo] help tp select points of border with spatstat
Message-ID: <AANLkTi=iKPT-puVQ10iGi6g9Ac14nchzVLyY_-Wz3qiT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/ee8bf559/attachment.pl>

From david.depew at queensu.ca  Thu Feb 10 22:14:09 2011
From: david.depew at queensu.ca (david depew)
Date: Thu, 10 Feb 2011 16:14:09 -0500
Subject: [R-sig-Geo] Question for point pattern experts
In-Reply-To: <865358BB-2C1E-478C-B914-37672033E9CF@auckland.ac.nz>
References: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>
	<865358BB-2C1E-478C-B914-37672033E9CF@auckland.ac.nz>
Message-ID: <AANLkTimoq9B9E5KaToPbNxeOsMHXi6-84oRm80pt=1vh@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110210/724896d7/attachment.pl>

From r.turner at auckland.ac.nz  Fri Feb 11 05:26:23 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 11 Feb 2011 17:26:23 +1300
Subject: [R-sig-Geo] Question for point pattern experts
In-Reply-To: <AANLkTimoq9B9E5KaToPbNxeOsMHXi6-84oRm80pt=1vh@mail.gmail.com>
References: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>
	<865358BB-2C1E-478C-B914-37672033E9CF@auckland.ac.nz>
	<AANLkTimoq9B9E5KaToPbNxeOsMHXi6-84oRm80pt=1vh@mail.gmail.com>
Message-ID: <E7A6DC67-8700-4799-B6D0-744FC1E70C4C@auckland.ac.nz>


On 11/02/2011, at 10:14 AM, david depew wrote:

> Thanks Rolf,
> I see your point, and I admit that I've waffled a bit on this  
> issue.  I'm hesitant to drive down the kriging path (although  
> indicators might be suitable), because there are many known (and  
> unknown) covariates that affect the contaminant burden, and few of  
> these are quantified at the scale or resolution we would require to  
> make such an approach useful (at least based on my experience).
> Regarding the data; the sites were not "chosen" as one would choose  
> locations to sample, rather they are a mix of quasi - synoptic and  
> randomized sampling designs from ~ 50 or so different investigators/ 
> agencies. We've simply mashed them into one large database for our  
> purposes. The habitat of the organisms is fixed in space (lakes),  
> but given that there is no real selection protocol for sites, I  
> wondered if this fit into the "grey" area.

	Well, it's pretty well all grey to me! :-)

	I'm afraid I have no insights to offer.  But let me say that whether
	or not the sites were ``chosen'' in any organised fashion, their  
locations
	are in effect given to you.  They did not arise from a random process.
	Or rather, if they did, you are not interested in studying the process
	which gave rise to the locations but rather properties of observations
	made at those locations.

	A mathematical description of the structure is, I think, that you have
	a random field, defined on a discrete set of points, an irregular  
lattice
	 --- the observation points in your data base.  There is also a time  
variable
	involved, and associated covariates are observed.  It might be  
appropriate
	to include time as a covariate.  Or not.  You might consider the  
lattice
	of points to be three dimensional, with a time dimension.

	Saying all that doesn't really help to develop an appropriate
	analysis strategy.  However it make help to focus the mind and to
	formulate clearly and precisely just what problems you are trying to
	solve.

		cheers,

			Rolf Turner
>
>
> On Thu, Feb 10, 2011 at 3:42 PM, Rolf Turner  
> <r.turner at auckland.ac.nz> wrote:
>
> On 11/02/2011, at 6:00 AM, david depew wrote:
>
> Dear list,
> A brief and (hopefully) simplistic question regarding point pattern
> analysis.
>
> We have compiled a large, continental database of chemical burdens  
> in a
> model organism. Currently, the data span 40 years and covers the  
> entire
> country of Canada (including the high arctic). We have categorized the
> numeric data into categorical data (i.e. categorical marks) based  
> on risk
> thresholds. We'd like to assess whether or not there are  
> interesting spatial
> patterns ( i.e. clusters of levels of risk (high vs low)), much like a
> case/control approach. My question is as follows;
>
> Is there a "best" geographic projection for this approach?  
> Currently all
> data are in Latitude/Longitude. My inclination is to use something  
> along the
> lines of an equal area projection to maintain a reasonable  
> representation of
> spatial dispersion.
>
> This doesn't sound to me like ***point pattern*** data.  It sounds  
> like
> you have taken measurements of ``chemical burdens'' in a particular
> organism, at a number of ***chosen*** sites over a number (40) of  
> years.
>
> Thus the observation points are deterministic, not random, and so  
> point
> pattern analysis doesn't come into it.
>
> It may be the case that some sort of combination of kriging and  
> time series
> or repeated measures analysis might be called for.  But here I  
> speak of
> that of which I know nothing.
>
>        cheers,
>
>                Rolf Turner
>
>
>
>
> -- 
> David Depew
> Postdoctoral Fellow
> School of Environmental Studies
> Queen's University
> Kingston, Ontario
> K7L 3N6
>
> david.depew at queensu.ca
> P: (613) 533-6000 x77831


From ldecola at comcast.net  Fri Feb 11 10:29:45 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Fri, 11 Feb 2011 09:29:45 +0000 (UTC)
Subject: [R-sig-Geo] Question for point pattern experts
In-Reply-To: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>
Message-ID: <1304271331.606650.1297416585988.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110211/fba890e9/attachment.pl>

From clement.calenge at oncfs.gouv.fr  Fri Feb 11 13:21:19 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Fri, 11 Feb 2011 13:21:19 +0100
Subject: [R-sig-Geo] Using BA to estimate home range overlap
In-Reply-To: <20110210153130.69d3fdmrb44oogwc@www.sms.ed.ac.uk>
References: <20110210153130.69d3fdmrb44oogwc@www.sms.ed.ac.uk>
Message-ID: <4D5529BF.5080808@oncfs.gouv.fr>


> Thanks for your reply. Firstly, I struggled to find you a dataset
> which shows it, because it seems it's not consistent. For example, for
> two particular animals, the overlap is 0.8 when just those animals are 
> in the
> dataset, but 2.5 when they are with the other (hundreds of) animals.
> Why does this affect the estimate?

OK, I now understand the problem. The point is that the overlap is 
calculated from the UD returned by kernelUD. To illustrate the issue, 
load your data and type:

kov <- kernelUD(xy, id)
## show the first animal
image(kov[[1]]$UD )

as you can see, the UD is estimated for each pixel of a grid (the extent 
of this grid is determined from the coordinates of the relocations, and 
the resolution of the grid is specified by the parameter "grid" of this 
function). So that we do not work on the continuous UD exactly, but 
rather on a discretization of the UD (i.e. necessarily imprecise). Now, 
to allow the comparison between animals, the function kerneloverlap uses 
the same grid for all animals, and therefore increases the extent of the 
grid, whereas the number of rows and columns of pixels does not change:

kov <- kernelUD(xy, id, same4all=TRUE)
## show the first animal
image(kov[[1]]$UD )

Now, the extent of the grid is changed, because it is calculated on all 
the relocations of the dataset (so that if you change the dataset, you 
also change the extent of the grid, and therefore your results). As you 
can see, in your case, the UD estimate is more imprecise... and so is 
any measure derived from this UD. A way to correct this imprecision 
would be to increase the resolution of the grid used for the estimation, 
using the parameter grid:

kov <- kernelUD(xy, id, same4all=TRUE, grid=200)
## show the first animal
image(kov[[1]]$UD )

The UD is more precise (you can increase the resolution above 200 if you 
want; the calculations will be longer, but the results will be more 
precise). Because kerneloverlap is a function designed to study the 
overlap between kernel estimates of the UD, it is always a good idea to 
have a look at these estimates before using this function (as we just 
have done). Therefore, we are now able to measure the kerneloverlap:

 > overlap<-kerneloverlap(xy, id, meth="BA", lev=70, grid=200)
 > overlap
             ADZ84        AGA84        ALB93        ALB94        ALD01
ADZ84 0.999874257 1.331033e-03 9.447368e-01 8.097720e-01 7.378722e-02
AGA84 0.001331033 9.998860e-01 1.961322e-07 0.000000e+00 0.000000e+00
ALB93 0.944736770 1.961322e-07 9.998776e-01 9.129537e-01 8.991676e-03
ALB94 0.809771977 0.000000e+00 9.129537e-01 9.998884e-01 9.977847e-05
ALD01 0.073787221 0.000000e+00 8.991676e-03 9.977847e-05 9.998756e-01
MTT08 0.037002908 0.000000e+00 7.209461e-02 0.000000e+00 9.350311e-02
ZUC03 0.068589500 0.000000e+00 6.738550e-02 8.341153e-06 1.599165e-01
            MTT08        ZUC03
ADZ84 0.03700291 6.858950e-02
AGA84 0.00000000 0.000000e+00
ALB93 0.07209461 6.738550e-02
ALB94 0.00000000 8.341153e-06
ALD01 0.09350311 1.599165e-01
MTT08 0.99991153 8.286853e-01
ZUC03 0.82868526 9.998665e-01

And everything is OK now.
Therefore,

> 1. Why is the overlap of AGA84 with itself much less than 1?
> 2. Why is the overlap of MTT08 with itself more than 1?

These are sampling fluctuations causes by imprecise UD estimation with a 
coarse grid. To change this, increase the parameter grid.



> 3. Why does the overlap not change when you change the isopleth? (it
> does with UDOI)

Because UDOI depends on the area of intersection between home ranges, 
which are defined at a given level (see equation 7 in Fieberg and 
Kochany 2005), whereas BA does not (see equation 6 in this paper). If 
you want to calculate the overlap only inside the home range, use the 
argument conditional = TRUE:

overlap<-kerneloverlap(xy, id, meth="BA", lev=90, grid=200, 
conditional=TRUE)

HTH,

Cl?ment Calenge
-- 

Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From research at georgruss.de  Fri Feb 11 15:40:16 2011
From: research at georgruss.de (Georg =?iso-8859-15?B?UnXf?=)
Date: Fri, 11 Feb 2011 15:40:16 +0100
Subject: [R-sig-Geo] help tp select points of border with spatstat
In-Reply-To: <AANLkTi=iKPT-puVQ10iGi6g9Ac14nchzVLyY_-Wz3qiT@mail.gmail.com>
References: <AANLkTi=iKPT-puVQ10iGi6g9Ac14nchzVLyY_-Wz3qiT@mail.gmail.com>
Message-ID: <20110211144015.GT455@greode>

On 10/02/11 21:56:02, gianni lavaredo wrote:
> I have a points shapefile with wave shape. I wish to select only the border
> points to create a border owin with the same wave shape. I tryed to use
> convex.hull but the final shape is not the same. Some researchers have some
> suggestions?

I once had a similar issue when I wanted to create a hull (i.e. select
only the border points) for a non-convex set of points, so-to-say. I ended
up doing some approximation and also came across the alphahull package.
Maybe "ahull" in that package with a suitable "alpha" parameter can help.

Georg.
-- 
Research Assistant
Otto-von-Guericke-Universit?t Magdeburg
research at georgruss.de
http://research.georgruss.de


From sanchez at itc.nl  Fri Feb 11 15:51:47 2011
From: sanchez at itc.nl (Juan Francisco Sanchez)
Date: Fri, 11 Feb 2011 15:51:47 +0100
Subject: [R-sig-Geo] Changing font size of graphic axis in spplot
Message-ID: <021F462EDC7F2B42A7038E9F9D47826118ABF596B6@itcnt27.itc.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110211/0df2f3cf/attachment.pl>

From clement.calenge at oncfs.gouv.fr  Fri Feb 11 16:10:01 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Fri, 11 Feb 2011 16:10:01 +0100
Subject: [R-sig-Geo] adehabitatMA, LT, HR and HS version 0.1
Message-ID: <4D555149.2010604@oncfs.gouv.fr>

Dear all,

I have just uploaded 4 new packages on CRAN, which are on the long term 
designed to replace the "old" package adehabitat:

* adehabitatMA: functions to perform spatial operations (morphology, 
buffer, etc.)
* adehabitatHS: functions for the analysis of habitat selection by wildlife
* adehabitatHR: functions for home range estimation of animals
* adehabitatLT: functions for animal movement analysis

I will still continue to maintain the "old" adehabitat, but on the 
long-term, adehabitat will be replaced by these four packages.

Detailed justification for the development of these packages is given below.

======================================================================

The R environment has changed a lot since I began the development of 
adehabitat in 2002 (development of namespace, etc.), and new classes and 
efficient methods have been developed to deal with spatial data (package 
sp). In addition, the number of functions available in the package has 
grown to more than 250 functions, implementing methods for habitat 
selection analysis, home range estimation, animal movement analysis, or 
spatial operations.

Therefore, I decided to:
(i) rewrite the package adehabitat to make it more compliant with these 
evolutions of the package R,
(ii) split adehabitat into four packages

The four new packages are:

* adehabitatMA: functions to perform spatial operations (morphology, 
buffer, etc.)
* adehabitatHS: functions for the analysis of habitat selection
* adehabitatHR: functions for home range estimation
* adehabitatLT: functions for movement analysis

I will continue to maintain the old adehabitat on CRAN for some time, 
but on the long term, this package will disappear. These four packages 
are expected to become the future of adehabitat.

I now describe several major changes:

* the functions of the packages are documented precisely in a vignette 
(there is one vignette per package). Both their use and the theory 
underlying these functions are described there. To access it, type:
vignette("packagename")

* the home range estimation methods have been homogenized and return 
classes compliant with the classes of the package sp:
- the functions kernelUD, kernelbb, BRB and kernelkc all return objects 
of class "estUDm", which are lists of objects of class "estUD". The 
class estUD extends the class SpatialPixelsDataFrame.
- the function clusthr and LoCoH return objects of class "MCHu", which 
are lists of SpatialPolygonsDataFrame
- the function mcp returns a SpatialPolygonsDataFrame

* home range estimation methods now take objects of class SpatialPoints 
as arguments

* objects of class "ltraj" are now characterized by an additional 
attribute "infolocs", which is designed to store metadata on the 
trajectories (e.g. precision on the relocations). Most functions of the 
package adehabitatLT can be used to analyse these metadata (plotltr, 
etc. see the vignette).

* the method of characteristic hulls (Downs and Horner 2009), suggested 
by Paolo Cavallini, on the list has been added to adehabitatHR, and 
returns an object of class MCHu

* the method of biased random bridges (Benhamou, 2011) has be added to 
adehabitatHR, to estimate the utilization distribution from a trajectory.

* the canonical OMI analysis, allowing exploration of habitat selection 
with radio-tracking data, has been added to the package adehabitatHS

* the autocorrelation functions described by Dray et al. (2010) for the 
analysis of movement have been added to the package adehabitatLT;

* the function rasterize.ltraj allows to rasterize a trajectory (i.e. 
useful to identify the habitat characteristics of the steps building the 
trajectory)

* all the packages have a namespace for management of internal functions.

* Two additional functions dl and ld to convert efficiently the class 
ltraj to and from data frames (thanks to Mathieu Basille for the 
suggestion).

Note that the calculations performed by most functions of adehabitat 
have not changed (e.g. the algorithm implemented in kernelUD of 
adehabitat is the same as the algorithm implemented in the function 
kernelUD of the package adehabitatHR), since they have been deeply 
discussed with users and corrected during the last six years. Only the 
input and output of the functions have been changed.

=============================================================================

Happy testing,


Cl?ment Calenge
-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From mikaela.keller at inria.fr  Fri Feb 11 16:45:14 2011
From: mikaela.keller at inria.fr (Mikaela Keller)
Date: Fri, 11 Feb 2011 16:45:14 +0100
Subject: [R-sig-Geo] raster's summary stats on polygons
Message-ID: <4D55598A.2090301@inria.fr>

Hi everyone,

I have a raster file over a certain region and a shapefile containing a 
list of polygons (> 2000) in that same region. I would like to get the 
mean value of the raster in each of the polygons.
Is there an easy way to do that using R?
Thank you in advance.
Regards,

MK


From roman.lustrik at gmail.com  Fri Feb 11 16:49:20 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 11 Feb 2011 16:49:20 +0100
Subject: [R-sig-Geo] raster's summary stats on polygons
In-Reply-To: <4D55598A.2090301@inria.fr>
References: <4D55598A.2090301@inria.fr>
Message-ID: <AANLkTindYy=XhgxqVTUynAEYtArSgxOSPGYnmbqAiYMu@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110211/85bc205e/attachment.pl>

From r.turner at auckland.ac.nz  Fri Feb 11 21:44:00 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 12 Feb 2011 09:44:00 +1300
Subject: [R-sig-Geo] help tp select points of border with spatstat
In-Reply-To: <AANLkTi=iKPT-puVQ10iGi6g9Ac14nchzVLyY_-Wz3qiT@mail.gmail.com>
References: <AANLkTi=iKPT-puVQ10iGi6g9Ac14nchzVLyY_-Wz3qiT@mail.gmail.com>
Message-ID: <C854CD05-BF46-4BE9-87EF-FAB28560894F@auckland.ac.nz>


On 11/02/2011, at 9:56 AM, gianni lavaredo wrote:

> Dear Researchers,
>
> I have a points shapefile with wave shape. I wish to select only  
> the border
> points to create a border owin with the same wave shape. I tryed to  
> use
> convex.hull but the final shape is not the same. Some researchers  
> have some
> suggestions?

If I understand your question correctly, what you should do is create
a data frame (say ``DF'') with columns "x" and "y" specifying the  
coordinates of
the points on (the border of) your ``wave shape''.  The points should  
be listed
in the ***anticlockwise*** direction, and the last point should  
***not*** repeat
the first.  Then do

	W <- owin(poly=DF)

HTH.

	cheers,

		Rolf Turner


From dan.putler at sauder.ubc.ca  Fri Feb 11 22:00:45 2011
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Fri, 11 Feb 2011 13:00:45 -0800
Subject: [R-sig-Geo] Question for point pattern experts
In-Reply-To: <6822_1297398449_1297398449_E7A6DC67-8700-4799-B6D0-744FC1E70C4C@auckland.ac.nz>
References: <AANLkTimBOWFax9xw9cG8pEiWBdkoDmqQC7h2G25qXK_X@mail.gmail.com>	<865358BB-2C1E-478C-B914-37672033E9CF@auckland.ac.nz>	<AANLkTimoq9B9E5KaToPbNxeOsMHXi6-84oRm80pt=1vh@mail.gmail.com>
	<6822_1297398449_1297398449_E7A6DC67-8700-4799-B6D0-744FC1E70C4C@auckland.ac.nz>
Message-ID: <4D55A37D.6090103@sauder.ubc.ca>

OK, I'm really slow to responding to this thread, but I've been thinking 
about it. Are there covariates available (besides time) that can be 
used? If yes, doesn't it make sense to look at this using a spatial 
autoregressive regression model? Since the lakes typically don't touch, 
then the spatial weight matrix would need to be based on distance. I'm 
not sure what the correct projection is if it goes really far north, and 
as far south as the southern Niagara Peninsula. A distance preserving 
projection would make the most sense, but UTM (the likely culprit) I 
know will breakdown if some of the lakes are too close to the north pole.

Dan

On 02/10/2011 08:26 PM, Rolf Turner wrote:
> On 11/02/2011, at 10:14 AM, david depew wrote:
>
>> Thanks Rolf,
>> I see your point, and I admit that I've waffled a bit on this
>> issue.  I'm hesitant to drive down the kriging path (although
>> indicators might be suitable), because there are many known (and
>> unknown) covariates that affect the contaminant burden, and few of
>> these are quantified at the scale or resolution we would require to
>> make such an approach useful (at least based on my experience).
>> Regarding the data; the sites were not "chosen" as one would choose
>> locations to sample, rather they are a mix of quasi - synoptic and
>> randomized sampling designs from ~ 50 or so different investigators/
>> agencies. We've simply mashed them into one large database for our
>> purposes. The habitat of the organisms is fixed in space (lakes),
>> but given that there is no real selection protocol for sites, I
>> wondered if this fit into the "grey" area.
> 	Well, it's pretty well all grey to me! :-)
>
> 	I'm afraid I have no insights to offer.  But let me say that whether
> 	or not the sites were ``chosen'' in any organised fashion, their
> locations
> 	are in effect given to you.  They did not arise from a random process.
> 	Or rather, if they did, you are not interested in studying the process
> 	which gave rise to the locations but rather properties of observations
> 	made at those locations.
>
> 	A mathematical description of the structure is, I think, that you have
> 	a random field, defined on a discrete set of points, an irregular
> lattice
> 	 --- the observation points in your data base.  There is also a time
> variable
> 	involved, and associated covariates are observed.  It might be
> appropriate
> 	to include time as a covariate.  Or not.  You might consider the
> lattice
> 	of points to be three dimensional, with a time dimension.
>
> 	Saying all that doesn't really help to develop an appropriate
> 	analysis strategy.  However it make help to focus the mind and to
> 	formulate clearly and precisely just what problems you are trying to
> 	solve.
>
> 		cheers,
>
> 			Rolf Turner
>>
>> On Thu, Feb 10, 2011 at 3:42 PM, Rolf Turner
>> <r.turner at auckland.ac.nz>  wrote:
>>
>> On 11/02/2011, at 6:00 AM, david depew wrote:
>>
>> Dear list,
>> A brief and (hopefully) simplistic question regarding point pattern
>> analysis.
>>
>> We have compiled a large, continental database of chemical burdens
>> in a
>> model organism. Currently, the data span 40 years and covers the
>> entire
>> country of Canada (including the high arctic). We have categorized the
>> numeric data into categorical data (i.e. categorical marks) based
>> on risk
>> thresholds. We'd like to assess whether or not there are
>> interesting spatial
>> patterns ( i.e. clusters of levels of risk (high vs low)), much like a
>> case/control approach. My question is as follows;
>>
>> Is there a "best" geographic projection for this approach?
>> Currently all
>> data are in Latitude/Longitude. My inclination is to use something
>> along the
>> lines of an equal area projection to maintain a reasonable
>> representation of
>> spatial dispersion.
>>
>> This doesn't sound to me like ***point pattern*** data.  It sounds
>> like
>> you have taken measurements of ``chemical burdens'' in a particular
>> organism, at a number of ***chosen*** sites over a number (40) of
>> years.
>>
>> Thus the observation points are deterministic, not random, and so
>> point
>> pattern analysis doesn't come into it.
>>
>> It may be the case that some sort of combination of kriging and
>> time series
>> or repeated measures analysis might be called for.  But here I
>> speak of
>> that of which I know nothing.
>>
>>         cheers,
>>
>>                 Rolf Turner
>>
>>
>>
>>
>> -- 
>> David Depew
>> Postdoctoral Fellow
>> School of Environmental Studies
>> Queen's University
>> Kingston, Ontario
>> K7L 3N6
>>
>> david.depew at queensu.ca
>> P: (613) 533-6000 x77831
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rahulosho at gmail.com  Sat Feb 12 06:16:40 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Sat, 12 Feb 2011 10:46:40 +0530
Subject: [R-sig-Geo] Help on extract function
Message-ID: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110212/dcfe296b/attachment.pl>

From seanpor at acm.org  Sat Feb 12 14:05:36 2011
From: seanpor at acm.org (Sean O'Riordain)
Date: Sat, 12 Feb 2011 13:05:36 +0000
Subject: [R-sig-Geo] Help on extract function
In-Reply-To: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>
References: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>
Message-ID: <AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>

Hi Rahul,

First look at
  str(polygon, max.level=2)
to understand how a shapefile is represented in R, then have a look at
  str(polygon at data)
which is a dataframe - you can add a new column to this dataframe like...
  polygon at data$newcolumn <- 1:nrow(polygon at data)
i.e you can treat this dataframe like any other as long as you're in
read-only mode or just adding columns... if you add rows or delete
rows or modify ID fields then beware!!! these rows are linked to the
actual polygons held elsewhere as arrays... don't touch for the moment
I'd suggest! :-)

then you can save out the shape file again...

cheers
Sean
Dublin
Ireland


On 12 February 2011 05:16, Rahul Raj <rahulosho at gmail.com> wrote:
> Dear all,
>
> I am using the command "extract(raster, polygon)".
>> I want to run this command in loop to extract the raster cells values by
> polygon number in each iteration.
>> I also want to attach one attribute column to shape file and write the
> shape file with added attribute.
> Please help me how can I do this in R
>
> Quick reply is highly appreciated and Thanks in advance
>
> Rahul Raj
> Indian Institute of Remote Sensing, India.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Sat Feb 12 14:16:03 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 12 Feb 2011 14:16:03 +0100
Subject: [R-sig-Geo] Help on extract function
In-Reply-To: <AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>
References: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>
	<AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>
Message-ID: <4D568813.9080105@uni-muenster.de>



On 02/12/2011 02:05 PM, Sean O'Riordain wrote:
> Hi Rahul,
> 
> First look at
>   str(polygon, max.level=2)
> to understand how a shapefile is represented in R, then have a look at
>   str(polygon at data)
> which is a dataframe - you can add a new column to this dataframe like...
>   polygon at data$newcolumn <- 1:nrow(polygon at data)
> i.e you can treat this dataframe like any other as long as you're in
> read-only mode or just adding columns... if you add rows or delete
> rows or modify ID fields then beware!!! these rows are linked to the
> actual polygons held elsewhere as arrays... don't touch for the moment
> I'd suggest! :-)

You can, if you avoid modifying object slots directly, but use the
appropriate methods. So to select the first ten polygons with their
attributes you should NEVER do something like:

polygon at data = polygon at data[1:10,] # NO!

but rather

polygonSel = polygon[1:10,]

For addressing or adding columns you can also use

polygon$existingcolumn
polygon[["existingcolumn"]]

and assigning:

polygon$newcolum  <- 1:nrow(polygon at data)

which will have the same effect as

polygon at data$newcolumn <- 1:nrow(polygon at data)

... whatever you prefer!
--
Edzer


> 
> then you can save out the shape file again...
> 
> cheers
> Sean
> Dublin
> Ireland
> 
> 
> On 12 February 2011 05:16, Rahul Raj <rahulosho at gmail.com> wrote:
>> Dear all,
>>
>> I am using the command "extract(raster, polygon)".
>>> I want to run this command in loop to extract the raster cells values by
>> polygon number in each iteration.
>>> I also want to attach one attribute column to shape file and write the
>> shape file with added attribute.
>> Please help me how can I do this in R
>>
>> Quick reply is highly appreciated and Thanks in advance
>>
>> Rahul Raj
>> Indian Institute of Remote Sensing, India.
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Sat Feb 12 16:33:35 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 12 Feb 2011 16:33:35 +0100
Subject: [R-sig-Geo] Help on extract function
In-Reply-To: <AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>
References: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>
	<AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1102121508530.8860@reclus.nhh.no>

On Sat, 12 Feb 2011, Sean O'Riordain wrote:

> Hi Rahul,
>
> First look at
>  str(polygon, max.level=2)
> to understand how a shapefile is represented in R, then have a look at
>  str(polygon at data)

One of the major strengths of the raster package is that it encapsulates 
much of the lower-level detail that experienced users find in sp. So your 
main challenge is to read and understand ?extract. If your polygon(s) are 
smaller than the raster cells, you may need a different approach.

Understanding ?aggregate in base R may also help, because you do need to 
consider what to do with the multiple raster cell values that may lie 
within each polygon. Look carefully at the example at the foot of the help 
page:

library(raster)
r <- raster(ncol=36, nrow=18)
r[] <- 1:ncell(r)
cds1 <- rbind(c(-180,-20), c(-160,5), c(-60, 0), c(-160,-60), c(-180,-20))
cds2 <- rbind(c(80,0), c(100,60), c(120,0), c(120,-55), c(80,0))
polys <- SpatialPolygons(list(Polygons(list(Polygon(cds1)), 1),
   Polygons(list(Polygon(cds2)), 2)))
plot(r)
plot(polys, add=TRUE)
v <- extract(r, polys)
str(v)
unlist(lapply(v, function(x) {
   if (!is.null(x)) mean(x, na.rm=TRUE) else NA
}))
v <- extract(r, polys, fun=mean, na.rm=TRUE)
v

So consider using the fun= argument to pass through an aggregation 
function. These aggregated values can next be made into a data frame, and 
polys promoted to a SpatialPolygonsDataFrame object, ready for writing as 
a shapefile.

It is important to understand that Spatial*DataFrame objects only look 
like shapefiles (or grids) to GIS-type people - to vanilla data analysts, 
they look like, smell like, and bark like data.frame objects (but have 
additional geometry things attached).

Hope this helps,

Roger

> which is a dataframe - you can add a new column to this dataframe like...
>  polygon at data$newcolumn <- 1:nrow(polygon at data)
> i.e you can treat this dataframe like any other as long as you're in
> read-only mode or just adding columns... if you add rows or delete
> rows or modify ID fields then beware!!! these rows are linked to the
> actual polygons held elsewhere as arrays... don't touch for the moment
> I'd suggest! :-)
>
> then you can save out the shape file again...
>
> cheers
> Sean
> Dublin
> Ireland
>
>
> On 12 February 2011 05:16, Rahul Raj <rahulosho at gmail.com> wrote:
>> Dear all,
>>
>> I am using the command "extract(raster, polygon)".
>>> I want to run this command in loop to extract the raster cells values by
>> polygon number in each iteration.
>>> I also want to attach one attribute column to shape file and write the
>> shape file with added attribute.
>> Please help me how can I do this in R
>>
>> Quick reply is highly appreciated and Thanks in advance
>>
>> Rahul Raj
>> Indian Institute of Remote Sensing, India.
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From rocknbike.stillwagon at gmail.com  Sat Feb 12 20:57:04 2011
From: rocknbike.stillwagon at gmail.com (Michael Stillwagon)
Date: Sat, 12 Feb 2011 14:57:04 -0500
Subject: [R-sig-Geo] How do you produce a output table containing distances
 between mineral grains at various azimuthal directions?
Message-ID: <AANLkTinf3xwROuyREzJsdLu01TNCww5zj4dvHwChomB8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110212/54f8a34a/attachment.pl>

From corey.chivers at mail.mcgill.ca  Sat Feb 12 23:07:54 2011
From: corey.chivers at mail.mcgill.ca (Corey Chivers)
Date: Sat, 12 Feb 2011 17:07:54 -0500
Subject: [R-sig-Geo] classify point by nearest polygon
Message-ID: <4D5704BA.5030800@mail.mcgill.ca>

I have a large number of points which I would like to associate with 
either the polygon (in my case, lake) they are in or nearest to.  I have 
succeeded in classifying the points which are actually in a polygon 
using overlay().  I have scoured around looking for a solution to 
identifying the nearest neighbor polygon of a point but have not found 
an elegant solution.

There was a thread about this issue back in 2009 ([R-sig-Geo] Finding 
the county shapefile polygon closest to along-lat position), but I was 
unable to implement the suggested workaround and wonder if there isn't a 
better solution known out there.

Thank you in advance for any help/advice you can provide!
-Corey

-- 
Corey Chivers, PhD Candidate
McGill University
Department of Biology
Stewart Biology W6/12
514-398-1833
corey.chivers at mail.mcgill.ca
http://madere.biol.mcgill.ca/cchivers/


From sarah.goslee at gmail.com  Sat Feb 12 23:24:17 2011
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Sat, 12 Feb 2011 17:24:17 -0500
Subject: [R-sig-Geo] How do you produce a output table containing
 distances between mineral grains at various azimuthal directions?
In-Reply-To: <AANLkTinf3xwROuyREzJsdLu01TNCww5zj4dvHwChomB8@mail.gmail.com>
References: <AANLkTinf3xwROuyREzJsdLu01TNCww5zj4dvHwChomB8@mail.gmail.com>
Message-ID: <AANLkTimOLbfwh8Zxj-uunPdDs-zLjkW98f8XYjB6ep0w@mail.gmail.com>

Michael,

Do you have quantitative data, or just images. If the former, seeing an
example of what you have and what you'd like the output to be would
be very helpful. If the latter, a program like ImageJ (free and Open
Source; google for it) might be more what you need.

Sarah

On Sat, Feb 12, 2011 at 2:57 PM, Michael Stillwagon
<rocknbike.stillwagon at gmail.com> wrote:
> I am using *R* and I am a senior at Western Carolina University and working
> on my senior thesis and the data set in which I have are images of mineral
> thin sections all separated into different groups of grains, magnetite,
> quartz, etc.. either being a vector layer or a raster layer or any other
> image format needed. I am wanting to calculate the distance between each
> grain or the grain spacing, boundary to boundary, *NOT* center to center and
> also have those distances given every 10 degrees on a 0 to 360 degree
> directional scale. Is there any code out there that does this very exact
> method? Or is there another program, ArcGIS 10 or Fragstats, R preferably.
>
> Thanks,
>
> -Michael Stillwagon
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From rahulosho at gmail.com  Sun Feb 13 10:07:36 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Sun, 13 Feb 2011 09:07:36 +0000
Subject: [R-sig-Geo] Help on extract function
References: <AANLkTinFXnG0spnu8To9h8NuLsm6cbtkmskhvFvH3-SK@mail.gmail.com>
	<AANLkTinMuVeo5phTSSMLaadHoAyuje8-rEM2Mna_Fpk8@mail.gmail.com>
	<4D568813.9080105@uni-muenster.de>
Message-ID: <loom.20110213T100706-506@post.gmane.org>

Dear Edzer

Thanks for suggestion. I am now able to select individual or set of polygons.
Thanks Again

Rahul Raj
Indian Institute of Remote Sensing, India.


From r.turner at auckland.ac.nz  Sun Feb 13 22:50:50 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 14 Feb 2011 10:50:50 +1300
Subject: [R-sig-Geo] classify point by nearest polygon
In-Reply-To: <4D5704BA.5030800@mail.mcgill.ca>
References: <4D5704BA.5030800@mail.mcgill.ca>
Message-ID: <33ADEA9C-B7F8-4F36-A706-AE32645B38FC@auckland.ac.nz>


On 13/02/2011, at 11:07 AM, Corey Chivers wrote:

> I have a large number of points which I would like to associate with
> either the polygon (in my case, lake) they are in or nearest to.  I  
> have
> succeeded in classifying the points which are actually in a polygon
> using overlay().  I have scoured around looking for a solution to
> identifying the nearest neighbor polygon of a point but have not found
> an elegant solution.
>
> There was a thread about this issue back in 2009 ([R-sig-Geo] Finding
> the county shapefile polygon closest to along-lat position), but I was
> unable to implement the suggested workaround and wonder if there  
> isn't a
> better solution known out there.
>
> Thank you in advance for any help/advice you can provide!

There are tools in the spatstat package that will let you accomplish
your objective quite easily.  A little bit of ``fitting together'' of
these tools is required.

Let me know if you are interested and I can give you detailed  
instructions
as to how to do the fitting together.

	cheers,

		Rolf Turner


From ireeve at une.edu.au  Mon Feb 14 02:46:41 2011
From: ireeve at une.edu.au (Ian Reeve)
Date: Mon, 14 Feb 2011 12:46:41 +1100
Subject: [R-sig-Geo] Polygons with holes have wrong fill colour
Message-ID: <2CC71F9E-CEA4-437D-92B5-C176BFDC2D54@une.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/a8530f20/attachment.pl>

From piero.campa at gmail.com  Mon Feb 14 10:20:51 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 14 Feb 2011 01:20:51 -0800
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <483AB641.1040201@uni-muenster.de>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl> <483AA4A6.2010101@uni-muenster.de>
	<483AB1F5.7000905@geo.uu.nl> <483AB641.1040201@uni-muenster.de>
Message-ID: <1297675251985-6022991.post@n2.nabble.com>


Dear list,
a slightly different scenario: what if one has a set of ubiquitous
predictors and e.g. one predictor which has a limited number of
observations?

Hengl in his book "A practical guide to geostatistical mapping" suggests
(probably) to combine RK with CK so that "additional, more densely sampled
covariates, can be used to improve spatial interpolation of the residuals.
The interpolated residuals can then be added to the deterministic part of
variation".

I cannot figure out what this do imply in detail sincerely: I have my
regression model with the ubiquitous predictors (and hence the corresponding
residuals); I have the residuals of the CK with the non-ubiquitous
predictor. How to merge the information?

Thank you in advance,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Ordinary-and-Regression-Kriging-combined-to-deal-with-missing-values-in-predictor-variables-tp2764942p6022991.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rrasterr at gmail.com  Mon Feb 14 11:02:54 2011
From: rrasterr at gmail.com (Ana)
Date: Mon, 14 Feb 2011 11:02:54 +0100
Subject: [R-sig-Geo] correlation for raster data
Message-ID: <AANLkTikeam-TF27D2WJRCFMWesG3-enfTUakFOxJk3ba@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/a9f42835/attachment.pl>

From rahulosho at gmail.com  Mon Feb 14 11:47:21 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Mon, 14 Feb 2011 16:17:21 +0530
Subject: [R-sig-Geo] Help on adding column to shape file
Message-ID: <AANLkTi=Y1bKrgoWv8FvRJnWSt4Ss_-6q7fEr6V8xmu1S@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/0119c03f/attachment.pl>

From carstennh at aol.com  Mon Feb 14 12:30:08 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Mon, 14 Feb 2011 12:30:08 +0100
Subject: [R-sig-Geo] bug writeRaster to ENVI
Message-ID: <4D591240.8090908@aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/2af7dce4/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Feb 14 13:03:27 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 14 Feb 2011 12:03:27 +0000
Subject: [R-sig-Geo] Help on adding column to shape file
In-Reply-To: <AANLkTi=Y1bKrgoWv8FvRJnWSt4Ss_-6q7fEr6V8xmu1S@mail.gmail.com>
References: <AANLkTi=Y1bKrgoWv8FvRJnWSt4Ss_-6q7fEr6V8xmu1S@mail.gmail.com>
Message-ID: <AANLkTikhrpseoNtbUTisrSYoLvfohpDdUk1yGmfsJ0Kd@mail.gmail.com>

On Mon, Feb 14, 2011 at 10:47 AM, Rahul Raj <rahulosho at gmail.com> wrote:

>> v at data$class3 <- 1:nrow(v at data) ?##where v is the object of polygon shape
> file
>
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?##class3 is the
> column to be added
>
>
>
> Now, I want to add column in loop as
>
>> v at data$classi <- 1:nrow(v at data) ## i = 1,2,3,4,?.. Supplied by loop
>
>
>
> ?i.e, I want to add column class1, class2, class3?.. so on using loop.

 Assuming v is actually a SpatialPolygonsDataFrame, you can use it in
many ways like a data frame. You can access columns by character
string using [[name]] notation. So here is an example using a point
data set - you should get the same behaviour from polygons:

 > v=data.frame(x=runif(10),y=runif(10),z1=runif(10),z2=runif(10))
 > coordinates(v)=~x+y

 v is now a spatialpointsdataframe. lets' add some columns:

 > v[["z3"]]=1:10
 > v
             coordinates          z1        z2 z3
1    (0.216765, 0.73725) 0.286275825 0.3223297  1
2   (0.171752, 0.569634) 0.606298265 0.3816816  2
3  (0.109809, 0.0321561) 0.548738532 0.2799815  3
4  (0.967817, 0.0313896) 0.662881901 0.6978231  4
5   (0.966963, 0.549404) 0.013866757 0.2950681  5
...
 - that added a column called "z3". to do this in a loop, use 'paste'
to construct the variable name:

> for(i in 1:4){v[[paste("M",i,sep="")]]=(1:10)*i}
> v
             coordinates          z1        z2 z3 M1 M2 M3 M4
1    (0.216765, 0.73725) 0.286275825 0.3223297  1  1  2  3  4
2   (0.171752, 0.569634) 0.606298265 0.3816816  2  2  4  6  8
3  (0.109809, 0.0321561) 0.548738532 0.2799815  3  3  6  9 12
4  (0.967817, 0.0313896) 0.662881901 0.6978231  4  4  8 12 16
...

 so now I have my times-tables up to 4 in M1 to M4.

> My next problem is to extract the name of shape file from selected path.
>
>> shapePath <- choose.files(caption = "Select grid file", filters =
> Filters[c("All"),])
>
> ?> shapePath
>
> [1] "H:\\file\\gridfile.shp"
>
>
>
> I want to extract ?gridfile? string (without .shp) so that it could directly
> supplied in place of layerFileName in the command written below
>
>> v <- readOGR(shapePath, layer = ?layerFileName?)
>
>
>
> Please help to resolve these two issues

 basename(mypath) will get rid off everything up to the last part (but
wont strip Windows \\-separated paths on Linux or MacOS), and then use
sub to get ridd of the extension:

 > mypath="H:/file/gridfile.shp"  # i use forward slashes because I use Linux

 > sub(".shp$","",basename(mypath))
[1] "gridfile"

 - the $ sign matches the end of the string.

Barry


From R.Catarino at MARLAB.AC.UK  Mon Feb 14 13:16:18 2011
From: R.Catarino at MARLAB.AC.UK (Rui Catarino)
Date: Mon, 14 Feb 2011 12:16:18 -0000
Subject: [R-sig-Geo] Date and Time format
Message-ID: <A0F8DAFB525DED4ABAF6841BB11C5812044E8195@mail4.marlab.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/a6388812/attachment.pl>

From rahulosho at gmail.com  Mon Feb 14 13:28:40 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Mon, 14 Feb 2011 17:58:40 +0530
Subject: [R-sig-Geo] Help on adding column to shape file
In-Reply-To: <AANLkTikhrpseoNtbUTisrSYoLvfohpDdUk1yGmfsJ0Kd@mail.gmail.com>
References: <AANLkTi=Y1bKrgoWv8FvRJnWSt4Ss_-6q7fEr6V8xmu1S@mail.gmail.com>
	<AANLkTikhrpseoNtbUTisrSYoLvfohpDdUk1yGmfsJ0Kd@mail.gmail.com>
Message-ID: <AANLkTimzF9TjZjjawTWw_R1eXzg7UzZDXxTPe=C7Tnjp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/c6bbd904/attachment.pl>

From piero.campa at gmail.com  Mon Feb 14 14:39:39 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 14 Feb 2011 05:39:39 -0800
Subject: [R-sig-Geo] R-spatial intensive PhD course 3-10 May 2011
In-Reply-To: <alpine.LRH.2.00.1102020903250.23950@reclus.nhh.no>
References: <alpine.LRH.2.00.1102020903250.23950@reclus.nhh.no>
Message-ID: <1297690779288-6023564.post@n2.nabble.com>


If any of the participants is interested in finding a shared accommodation,
please contact me.

Cheers, 
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-spatial-intensive-PhD-course-3-10-May-2011-tp5983951p6023564.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From piero.campa at gmail.com  Mon Feb 14 16:23:47 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 14 Feb 2011 07:23:47 -0800
Subject: [R-sig-Geo] how to do a principle component analysis with
 geo-referenced points
In-Reply-To: <1297102601618-6001222.post@n2.nabble.com>
References: <1163301764.26351.275593342@webmail.messagingengine.com>
	<832A948B92E5754D9062CCF62F9ED89222A3D0@xmail01.ad.ua.ac.be>
	<1297102601618-6001222.post@n2.nabble.com>
Message-ID: <1297697027406-6023928.post@n2.nabble.com>


I guess that the answer is that actually the attribute "dimnames" of the
returned x scores prcomp() can be exploited to recover the spatial reference
as far as the object has a rectangular shape in space.
My spatial object was irregularly shaped instead, then I guess that these
"dimnames" were arranged differently underneath.

Regards,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-do-a-principle-component-analysis-with-geo-referenced-points-tp2762765p6023928.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ldecola at comcast.net  Mon Feb 14 19:16:42 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Mon, 14 Feb 2011 18:16:42 +0000
Subject: [R-sig-Geo] how to do a principle component analysis with
 geo-referenced points
In-Reply-To: <1297697027406-6023928.post@n2.nabble.com>
Message-ID: <574781640.772700.1297707402016.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/3bf575f4/attachment.pl>

From jaimebg27 at gmail.com  Mon Feb 14 19:37:59 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Mon, 14 Feb 2011 13:37:59 -0500
Subject: [R-sig-Geo] Add a polygon to bubble plot
Message-ID: <AANLkTimAY3PRQL=vj37BCY7qAAUpsAjdkLusffiD2Rfp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/80d8b7fb/attachment.pl>

From sturgeon09 at gmail.com  Mon Feb 14 19:53:41 2011
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Mon, 14 Feb 2011 13:53:41 -0500
Subject: [R-sig-Geo] Add a polygon to bubble plot
In-Reply-To: <AANLkTimAY3PRQL=vj37BCY7qAAUpsAjdkLusffiD2Rfp@mail.gmail.com>
References: <AANLkTimAY3PRQL=vj37BCY7qAAUpsAjdkLusffiD2Rfp@mail.gmail.com>
Message-ID: <AANLkTins8SvFffM93SH1EW+VeQjaEwm=Zu7==YZK=03u@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110214/4c429087/attachment.pl>

From r.hijmans at gmail.com  Tue Feb 15 08:00:21 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 14 Feb 2011 23:00:21 -0800
Subject: [R-sig-Geo] bug writeRaster to ENVI
In-Reply-To: <4D591240.8090908@aol.com>
References: <4D591240.8090908@aol.com>
Message-ID: <1297753221804-6026499.post@n2.nabble.com>



> I discovered a strange behaviour of the function writeRaster in ther 
> raster package. Having a *.img or *.tiff file with a projected extend 
> object like this, 
> ...
> alway causes a wrong projection and associated coordinates when writing 
> to a envi file with the function call: 

Carsten, 

See the below for a self contained illustration of the problem, and for a
work-around. 

There appears to be a problem in gdal, or perhaps rgdal. This needs to be
looked at in more detail.

> library(raster)
Loading required package: sp
raster version 1.7-37 (7-February-2011)
> 
> r <- raster(nrow=10, ncol=10)
> r[] <- 1:ncell(r)
> 
> extent(r)
class       : Extent 
xmin        : -180 
xmax        : 180 
ymin        : -90 
ymax        : 90 
> r1 <- writeRaster(r, filename='test1.envi', format='ENVI', overwrite=TRUE)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.7.2, released 2010/04/23
Path to GDAL shared files: C:/soft/R/R-2.12.1/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009
Path to PROJ.4 shared files: C:/soft/R/R-2.12.1/library/rgdal/proj
> # not good
> extent(r1)
class       : Extent 
xmin        : 0 
xmax        : 10 
ymin        : -10 
ymax        : 0 
> 
> 
> # the problem seems to be with gdal
> # as this also occurs with writeGDAL
> sp <- as(r, 'SpatialGridDataFrame')
> bbox(sp)
    min max
s1 -180 180
s2  -90  90
> writeGDAL(sp, 'test2.envi', driver='ENVI')
> y <- readGDAL('test2.envi')
test2.envi has GDAL driver ENVI 
and has 10 rows and 10 columns
> # not good:
> bbox(y)
  min max
x   0  10
y -10   0
> 
> 
> #work around
> extent(r1) <- extent(r)
> hdr(r1, 'ENVI')
> x <- raster('test1.envi')
> # OK now:
> extent(x)
class       : Extent 
xmin        : -180 
xmax        : 180 
ymin        : -90 
ymax        : 90 
> 
> 

Hope this helps, Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/bug-writeRaster-to-ENVI-tp6023256p6026499.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Tue Feb 15 08:56:28 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 15 Feb 2011 08:56:28 +0100
Subject: [R-sig-Geo] bug writeRaster to ENVI
In-Reply-To: <1297753221804-6026499.post@n2.nabble.com>
References: <4D591240.8090908@aol.com>
	<1297753221804-6026499.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1102150851371.23789@reclus.nhh.no>

On Mon, 14 Feb 2011, Robert Hijmans wrote:

>
>
>> I discovered a strange behaviour of the function writeRaster in ther
>> raster package. Having a *.img or *.tiff file with a projected extend
>> object like this,
>> ...
>> alway causes a wrong projection and associated coordinates when writing
>> to a envi file with the function call:
>
> Carsten,
>
> See the below for a self contained illustration of the problem, and for a
> work-around.
>
> There appears to be a problem in gdal, or perhaps rgdal. This needs to be
> looked at in more detail.

It is not present in GDAL 1.8.0, but is present in 1.7.2. I think it is:

http://trac.osgeo.org/gdal/ticket/3751

so should not be present in GDAL 1.7.3 - could anyone running GDAL 1.7.3 
or 1.8.0 please check for completeness, and report to me offlist? The GDAL 
ENVI driver in 1.7.2 and earlier was defective.

I'll try to find time to move the MSYS-built Windows GDAL binaries to 
1.8.0.

Roger

>
>> library(raster)
> Loading required package: sp
> raster version 1.7-37 (7-February-2011)
>>
>> r <- raster(nrow=10, ncol=10)
>> r[] <- 1:ncell(r)
>>
>> extent(r)
> class       : Extent
> xmin        : -180
> xmax        : 180
> ymin        : -90
> ymax        : 90
>> r1 <- writeRaster(r, filename='test1.envi', format='ENVI', overwrite=TRUE)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.7.2, released 2010/04/23
> Path to GDAL shared files: C:/soft/R/R-2.12.1/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009
> Path to PROJ.4 shared files: C:/soft/R/R-2.12.1/library/rgdal/proj
>> # not good
>> extent(r1)
> class       : Extent
> xmin        : 0
> xmax        : 10
> ymin        : -10
> ymax        : 0
>>
>>
>> # the problem seems to be with gdal
>> # as this also occurs with writeGDAL
>> sp <- as(r, 'SpatialGridDataFrame')
>> bbox(sp)
>    min max
> s1 -180 180
> s2  -90  90
>> writeGDAL(sp, 'test2.envi', driver='ENVI')
>> y <- readGDAL('test2.envi')
> test2.envi has GDAL driver ENVI
> and has 10 rows and 10 columns
>> # not good:
>> bbox(y)
>  min max
> x   0  10
> y -10   0
>>
>>
>> #work around
>> extent(r1) <- extent(r)
>> hdr(r1, 'ENVI')
>> x <- raster('test1.envi')
>> # OK now:
>> extent(x)
> class       : Extent
> xmin        : -180
> xmax        : 180
> ymin        : -90
> ymax        : 90
>>
>>
>
> Hope this helps, Robert
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ronggui.huang at gmail.com  Tue Feb 15 09:31:37 2011
From: ronggui.huang at gmail.com (Wincent)
Date: Tue, 15 Feb 2011 16:31:37 +0800
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
Message-ID: <AANLkTi=f_=wSsU7uYWNE728r8704Bz004GZtp9tAtLca@mail.gmail.com>

The previous email was rejected, so I re-send it. Sorry for disturbing.

Regards

On 15 February 2011 16:23, Wincent <ronggui.huang at gmail.com> wrote:
> Dear all,
>
> According to https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
> the area of polygon can be accessed by
>> areas <- sapply(slot(scot_BNG, "polygons"), function(x) sapply(slot(x, "Polygons"), slot, "area"))
>
> My question is what is the unit of the area? Is it sq km?
> Thank you very much in advance.
>
> Regards



-- 
Wincent Ronggui HUANG (PhD)
Department of Sociology
Fudan University
http://asrr.r-forge.r-project.org/rghuang.html


From piero.campa at gmail.com  Tue Feb 15 10:09:41 2011
From: piero.campa at gmail.com (piero campa)
Date: Tue, 15 Feb 2011 01:09:41 -0800
Subject: [R-sig-Geo] how to do a principle component analysis with
 geo-referenced points
In-Reply-To: <574781640.772700.1297707402016.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
References: <1163301764.26351.275593342@webmail.messagingengine.com>
	<832A948B92E5754D9062CCF62F9ED89222A3D0@xmail01.ad.ua.ac.be>
	<1297102601618-6001222.post@n2.nabble.com>
	<1297697027406-6023928.post@n2.nabble.com>
	<574781640.772700.1297707402016.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
Message-ID: <1297760981438-6026780.post@n2.nabble.com>


I wish I could do that, but the documentation seems to lack this level of
detail:

>?prcomp
     [...]
     ?prcomp? returns a list with class ?"prcomp"? containing the
     following components:
     [...]
       x: if ?retx? is true the value of the rotated data (the centred
          (and scaled if requested) data multiplied by the ?rotation?
          matrix) is returned.  Hence, ?cov(x)? is the diagonal matrix
          ?diag(sdev^2)?.  For the formula method, ?napredict()? is
          applied to handle the treatment of values omitted by the
          ?na.action?.
     [...]

Here it seems to describe the x scores but not their dimnames.  ..?
Cheers,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-do-a-principle-component-analysis-with-geo-referenced-points-tp2762765p6026780.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From villers.alexandre at gmail.com  Tue Feb 15 12:57:26 2011
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Tue, 15 Feb 2011 13:57:26 +0200
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <AANLkTi=f_=wSsU7uYWNE728r8704Bz004GZtp9tAtLca@mail.gmail.com>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
	<AANLkTi=f_=wSsU7uYWNE728r8704Bz004GZtp9tAtLca@mail.gmail.com>
Message-ID: <4D5A6A26.6040405@gmail.com>

Good afternoon,

I guess it will be the unit of your original SpatialPolygons object. If 
you use a projected coordinate system, the unit should be in meters, 
otherwise, I'm not sure of this, but it should be in squared degrees.

HTH

Alex

Le 15/02/2011 10:31, Wincent a ?crit :
> The previous email was rejected, so I re-send it. Sorry for disturbing.
>
> Regards
>
> On 15 February 2011 16:23, Wincent<ronggui.huang at gmail.com>  wrote:
>> Dear all,
>>
>> According to https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
>> the area of polygon can be accessed by
>>> areas<- sapply(slot(scot_BNG, "polygons"), function(x) sapply(slot(x, "Polygons"), slot, "area"))
>> My question is what is the unit of the area? Is it sq km?
>> Thank you very much in advance.
>>
>> Regards
>
>


From thi_veloso at yahoo.com.br  Tue Feb 15 13:22:18 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 15 Feb 2011 04:22:18 -0800
Subject: [R-sig-Geo] How to draw grid contours within a map
Message-ID: <701436.7348.qm@web161412.mail.bf1.yahoo.com>

? Dear R-Siggers,

? In order to illustrate the spatial domain of the General Circulation Model (GCM) output data I am using, I need to display some grids within a map. They need to be 2.5?x2.5? lat-lon over specific coordinates. Actually, I am trying to partially reproduce Figure 1 inside Challinor et al., 2005 (image attached).

? To load and display the shapefile I use the following code:

library(maptools)
southern=readShapePoly("D:/Maps/papers-in-progress/regiao_sul.shp")
plot(southern)

? Following, I create the "empty" grids to draw:

library(raster)
rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25)
res(rprecip)<-2.5

? But I am stuck on the task of displaying those grids on the map.

? Could anybody please point any directions?

? Best,

? Thiago.


      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Challinor et al., 2005.gif
Type: image/gif
Size: 20495 bytes
Desc: Challinor et al., 2005.gif
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110215/0ac51361/attachment.gif>

From ronggui.huang at gmail.com  Tue Feb 15 13:43:44 2011
From: ronggui.huang at gmail.com (Wincent)
Date: Tue, 15 Feb 2011 20:43:44 +0800
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <4D5A6A26.6040405@gmail.com>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
	<AANLkTi=f_=wSsU7uYWNE728r8704Bz004GZtp9tAtLca@mail.gmail.com>
	<4D5A6A26.6040405@gmail.com>
Message-ID: <AANLkTik8dWxrfY1GO5reR+j5PPWfBKUgEJsJC6jE04hx@mail.gmail.com>

Thanks Alex.

Also, my object is projected to "Hong Kong 1980 Grid System", so the
unit of area is square meters. Is it a confirmative answer? Thanks
again.

Best
Ronggui

On 15 February 2011 19:57, Alexandre Villers
<villers.alexandre at gmail.com> wrote:
> Good afternoon,
>
> I guess it will be the unit of your original SpatialPolygons object. If you
> use a projected coordinate system, the unit should be in meters, otherwise,
> I'm not sure of this, but it should be in squared degrees.
>
> HTH
>
> Alex
>
> Le 15/02/2011 10:31, Wincent a ?crit :
>>
>> The previous email was rejected, so I re-send it. Sorry for disturbing.
>>
>> Regards
>>
>> On 15 February 2011 16:23, Wincent<ronggui.huang at gmail.com> ?wrote:
>>>
>>> Dear all,
>>>
>>> According to
>>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
>>> the area of polygon can be accessed by
>>>>
>>>> areas<- sapply(slot(scot_BNG, "polygons"), function(x) sapply(slot(x,
>>>> "Polygons"), slot, "area"))
>>>
>>> My question is what is the unit of the area? Is it sq km?
>>> Thank you very much in advance.
>>>
>>> Regards
>>
>>
>



-- 
Wincent Ronggui HUANG (PhD)
Department of Sociology
Fudan University
http://asrr.r-forge.r-project.org/rghuang.html


From ashton at msu.edu  Tue Feb 15 14:50:47 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 15 Feb 2011 08:50:47 -0500
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <AANLkTik8dWxrfY1GO5reR+j5PPWfBKUgEJsJC6jE04hx@mail.gmail.com>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
	<4D5A6A26.6040405@gmail.com>
	<AANLkTik8dWxrfY1GO5reR+j5PPWfBKUgEJsJC6jE04hx@mail.gmail.com>
Message-ID: <201102150850.47392.ashton@msu.edu>

Hi Ronggui,

the spatial units are distinct from the projection and datum component of the 
coordinate reference system.  For example, I could use data projected to 
Lambert Equal Area with particular parameters that were in meters, feet, 
miles, rods, etc.

"Hong Kong 1980 Grid System" tells me it's projected, but doesn't tell me the 
units. Your object may have a particular spatial reference ID code (SRID) 
associated with it - if you look this up on the internet, you can find out the 
units. Alternatively there may be a parameter string that includes the units. 
Finally, if you can display your data in a GIS, and you know the region fairly 
well, you can probably figure out the units (e.g. if you know your area is 
about 10 km across, and a distance check indicates the distance is 11500, then 
you have meters. If it's more like 35000, it's feet. 

Hope this helps,

Ashton

On 2011-02-15, Wincent, wrote:
> Thanks Alex.
> 
> Also, my object is projected to "Hong Kong 1980 Grid System", so the
> unit of area is square meters. Is it a confirmative answer? Thanks
> again.
> 
> Best
> Ronggui
> 
> On 15 February 2011 19:57, Alexandre Villers
> 
> <villers.alexandre at gmail.com> wrote:
> > Good afternoon,
> > 
> > I guess it will be the unit of your original SpatialPolygons object. If
> > you use a projected coordinate system, the unit should be in meters,
> > otherwise, I'm not sure of this, but it should be in squared degrees.
> > 
> > HTH
> > 
> > Alex
> > 
> > Le 15/02/2011 10:31, Wincent a ?crit :
> >> The previous email was rejected, so I re-send it. Sorry for disturbing.
> >> 
> >> Regards
> >> 
> >> On 15 February 2011 16:23, Wincent<ronggui.huang at gmail.com>  wrote:
> >>> Dear all,
> >>> 
> >>> According to
> >>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
> >>> the area of polygon can be accessed by
> >>> 
> >>>> areas<- sapply(slot(scot_BNG, "polygons"), function(x) sapply(slot(x,
> >>>> "Polygons"), slot, "area"))
> >>> 
> >>> My question is what is the unit of the area? Is it sq km?
> >>> Thank you very much in advance.
> >>> 
> >>> Regards


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From ronggui.huang at gmail.com  Tue Feb 15 15:09:34 2011
From: ronggui.huang at gmail.com (Wincent)
Date: Tue, 15 Feb 2011 22:09:34 +0800
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <201102150850.47392.ashton@msu.edu>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
	<4D5A6A26.6040405@gmail.com>
	<AANLkTik8dWxrfY1GO5reR+j5PPWfBKUgEJsJC6jE04hx@mail.gmail.com>
	<201102150850.47392.ashton@msu.edu>
Message-ID: <AANLkTi=jXQUH2g4_2Fi7SZO-8dgXx0FOXsm4uKB5anPi@mail.gmail.com>

Thans Ashton. My object is SpatialPolygonsDataFrame, which is imported
from arc GIS shapefile. It has such slots,

> slotNames(obj)
[1] "data"        "polygons"    "plotOrder"   "bbox"        "proj4string"

How can I figure out if this object has info about SRID?

Yeah, I may follow your suggestion by comparing the area attributes
and actual size of the area.

Best
Ronggui

On 15 February 2011 21:50, Ashton Shortridge <ashton at msu.edu> wrote:
> Hi Ronggui,
>
> the spatial units are distinct from the projection and datum component of the
> coordinate reference system. ?For example, I could use data projected to
> Lambert Equal Area with particular parameters that were in meters, feet,
> miles, rods, etc.
>
> "Hong Kong 1980 Grid System" tells me it's projected, but doesn't tell me the
> units. Your object may have a particular spatial reference ID code (SRID)
> associated with it - if you look this up on the internet, you can find out the
> units. Alternatively there may be a parameter string that includes the units.
> Finally, if you can display your data in a GIS, and you know the region fairly
> well, you can probably figure out the units (e.g. if you know your area is
> about 10 km across, and a distance check indicates the distance is 11500, then
> you have meters. If it's more like 35000, it's feet.
>
> Hope this helps,
>
> Ashton
>
> On 2011-02-15, Wincent, wrote:
>> Thanks Alex.
>>
>> Also, my object is projected to "Hong Kong 1980 Grid System", so the
>> unit of area is square meters. Is it a confirmative answer? Thanks
>> again.
>>
>> Best
>> Ronggui
>>
>> On 15 February 2011 19:57, Alexandre Villers
>>
>> <villers.alexandre at gmail.com> wrote:
>> > Good afternoon,
>> >
>> > I guess it will be the unit of your original SpatialPolygons object. If
>> > you use a projected coordinate system, the unit should be in meters,
>> > otherwise, I'm not sure of this, but it should be in squared degrees.
>> >
>> > HTH
>> >
>> > Alex
>> >
>> > Le 15/02/2011 10:31, Wincent a ?crit :
>> >> The previous email was rejected, so I re-send it. Sorry for disturbing.
>> >>
>> >> Regards
>> >>
>> >> On 15 February 2011 16:23, Wincent<ronggui.huang at gmail.com> ?wrote:
>> >>> Dear all,
>> >>>
>> >>> According to
>> >>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
>> >>> the area of polygon can be accessed by
>> >>>
>> >>>> areas<- sapply(slot(scot_BNG, "polygons"), function(x) sapply(slot(x,
>> >>>> "Polygons"), slot, "area"))
>> >>>
>> >>> My question is what is the unit of the area? Is it sq km?
>> >>> Thank you very much in advance.
>> >>>
>> >>> Regards
>
>
> -----
> Ashton Shortridge
> Associate Professor ? ? ? ? ? ? ? ? ? ? ashton at msu.edu
> Dept of Geography ? ? ? ? ? ? ? ? ? ? ? http://www.msu.edu/~ashton
> 235 Geography Building ? ? ? ? ?ph (517) 432-3561
> Michigan State University ? ? ? ? ? ? ? fx (517) 432-1671
>



-- 
Wincent Ronggui HUANG (PhD)
http://asrr.r-forge.r-project.org/rghuang.html


From lestes at princeton.edu  Tue Feb 15 15:43:26 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Tue, 15 Feb 2011 09:43:26 -0500
Subject: [R-sig-Geo] How to draw grid contours within a map
In-Reply-To: <701436.7348.qm@web161412.mail.bf1.yahoo.com>
References: <701436.7348.qm@web161412.mail.bf1.yahoo.com>
Message-ID: <AANLkTi=yUKqx24NVCVGXFACwfBZz9cHx-mWU374ogihY@mail.gmail.com>

Hi Thiago,

I was doing something a bit similar to what you are doing just
recently.  Instead of creating a raster of the grids, I created
polygon grids, which is then quite simple to overlay on other
polygons.

Here's a function I used to create the polygon grids:

createPolyGrid <- function(x, y, h, w, size, prj) {
# Creates a polygon grid in meters
# Args:
#   x: X coordinate of lower left corner of lower left of polygon, in meters
#   y: Y coordinate of lower left corner of lower left of polygon, in meters
#   h: The desired North-South extent of the grid
#   w: The desired East-West extent of the grid
#   size: Grid polygon cell size in meters
#   prj: Object holding the crs string for the desired projection (optional)
# Returns:
#   A SpatialPolygonsDataFrame with square grids, with North-South and
East-West distances rounded to
#   avoid fractionating grid cells. An attribute data frame of 1
column holding polygon identifiers is created

  if(missing(x)) {
    stop("missing x")
  } else if(missing(y)) {
    stop("missing y")
  } else if(missing(h)) {
    stop("missing h")
  } else if(missing(w)) {
    stop("missing w")
  } else if(missing(size)) {
    stop("missing size")
  }

  # Define numbers of row and columns in grid, rounding to nearest whole numbers
  xrow <- round(w / size, 0)
  yrow <- round(h / size, 0)

  # Define coordinates for center of lower left cell
  xcen <- x + size / 2
  ycen <- y + size / 2

  # Create grid topology
  grd <- GridTopology(c(xcen, ycen), c(size, size), c(xrow, yrow))

  # Turn it into polygons
  if(missing(prj)) {
    grd.shp <- as.SpatialPolygons.GridTopology(grd)
  } else if(!missing(prj)) {
    grd.shp <- as.SpatialPolygons.GridTopology(grd, prj)
  }

  # Create data frame and then SpatialPolygons into SpatialPolygonsDataFrame
  grd.dat <- as.data.frame(matrix(1:length(grd.shp), ncol = 1))
  colnames(grd.dat) <- "polID"
  row.names(grd.dat) <- as.character(grd.dat$polID)
  grd.out.shp <- SpatialPolygonsDataFrame(grd.shp, grd.dat, match.ID = FALSE)

  return(grd.out.shp)
}


# Here's an example of how to make the grid with the function above
and plot it over another polygon, based on
# the meuse dataset (meuse.sr example taken from
http://r-spatial.sourceforge.net/gallery/)

library(gstat)

data(meuse.riv)
meuse.sr = SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
 # Polygon of river

# Find extent of river shape and use the coordinates to create polygon grid
ex <- bbox(meuse.sr)
gr <- createPolyGrid(x = ex[1, 1], y = ex[2, 1], h = ex[2, 2] - ex[2,
1], w = ex[1, 2] - ex[1, 1], size = 500)

# Plot
plot(meuse.sr)
plot(gr, add = T)

Hope this helps.

Cheers, Lyndon
















On Tue, Feb 15, 2011 at 7:22 AM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
> ? Dear R-Siggers,
>
> ? In order to illustrate the spatial domain of the General Circulation Model (GCM) output data I am using, I need to display some grids within a map. They need to be 2.5?x2.5? lat-lon over specific coordinates. Actually, I am trying to partially reproduce Figure 1 inside Challinor et al., 2005 (image attached).
>
> ? To load and display the shapefile I use the following code:
>
> library(maptools)
> southern=readShapePoly("D:/Maps/papers-in-progress/regiao_sul.shp")
> plot(southern)
>
> ? Following, I create the "empty" grids to draw:
>
> library(raster)
> rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25)
> res(rprecip)<-2.5
>
> ? But I am stuck on the task of displaying those grids on the map.
>
> ? Could anybody please point any directions?
>
> ? Best,
>
> ? Thiago.
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From ashton at msu.edu  Tue Feb 15 16:19:06 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 15 Feb 2011 10:19:06 -0500
Subject: [R-sig-Geo] Calculating area of polygons
In-Reply-To: <AANLkTi=jXQUH2g4_2Fi7SZO-8dgXx0FOXsm4uKB5anPi@mail.gmail.com>
References: <AANLkTimP+HEt1ROPS7OmQaR_BAAH=YBUzACRaY87jQjJ@mail.gmail.com>
	<201102150850.47392.ashton@msu.edu>
	<AANLkTi=jXQUH2g4_2Fi7SZO-8dgXx0FOXsm4uKB5anPi@mail.gmail.com>
Message-ID: <201102151019.06968.ashton@msu.edu>

Hi Rongui,

the proj4string slot has projection information. One of those parameters in 
the string should be units. It is possible that the projection information is 
wrong - I advise my students to conduct the reality check indicated in the 
last email.

Yours

Ashton

On 2011-02-15, Wincent, wrote:
> Thans Ashton. My object is SpatialPolygonsDataFrame, which is imported
> from arc GIS shapefile. It has such slots,
> 
> > slotNames(obj)
> 
> [1] "data"        "polygons"    "plotOrder"   "bbox"        "proj4string"
> 
> How can I figure out if this object has info about SRID?
> 
> Yeah, I may follow your suggestion by comparing the area attributes
> and actual size of the area.
> 
> Best
> Ronggui
> 
> On 15 February 2011 21:50, Ashton Shortridge <ashton at msu.edu> wrote:
> > Hi Ronggui,
> > 
> > the spatial units are distinct from the projection and datum component of
> > the coordinate reference system.  For example, I could use data
> > projected to Lambert Equal Area with particular parameters that were in
> > meters, feet, miles, rods, etc.
> > 
> > "Hong Kong 1980 Grid System" tells me it's projected, but doesn't tell me
> > the units. Your object may have a particular spatial reference ID code
> > (SRID) associated with it - if you look this up on the internet, you can
> > find out the units. Alternatively there may be a parameter string that
> > includes the units. Finally, if you can display your data in a GIS, and
> > you know the region fairly well, you can probably figure out the units
> > (e.g. if you know your area is about 10 km across, and a distance check
> > indicates the distance is 11500, then you have meters. If it's more like
> > 35000, it's feet.
> > 
> > Hope this helps,
> > 
> > Ashton
> > 
> > On 2011-02-15, Wincent, wrote:
> >> Thanks Alex.
> >> 
> >> Also, my object is projected to "Hong Kong 1980 Grid System", so the
> >> unit of area is square meters. Is it a confirmative answer? Thanks
> >> again.
> >> 
> >> Best
> >> Ronggui
> >> 
> >> On 15 February 2011 19:57, Alexandre Villers
> >> 
> >> <villers.alexandre at gmail.com> wrote:
> >> > Good afternoon,
> >> > 
> >> > I guess it will be the unit of your original SpatialPolygons object.
> >> > If you use a projected coordinate system, the unit should be in
> >> > meters, otherwise, I'm not sure of this, but it should be in squared
> >> > degrees.
> >> > 
> >> > HTH
> >> > 
> >> > Alex
> >> > 
> >> > Le 15/02/2011 10:31, Wincent a ?crit :
> >> >> The previous email was rejected, so I re-send it. Sorry for
> >> >> disturbing.
> >> >> 
> >> >> Regards
> >> >> 
> >> >> On 15 February 2011 16:23, Wincent<ronggui.huang at gmail.com>  wrote:
> >> >>> Dear all,
> >> >>> 
> >> >>> According to
> >> >>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-May/005741.html,
> >> >>> the area of polygon can be accessed by
> >> >>> 
> >> >>>> areas<- sapply(slot(scot_BNG, "polygons"), function(x)
> >> >>>> sapply(slot(x, "Polygons"), slot, "area"))
> >> >>> 
> >> >>> My question is what is the unit of the area? Is it sq km?
> >> >>> Thank you very much in advance.
> >> >>> 
> >> >>> Regards
> > 
> > -----
> > Ashton Shortridge
> > Associate Professor                     ashton at msu.edu
> > Dept of Geography                       http://www.msu.edu/~ashton
> > 235 Geography Building          ph (517) 432-3561
> > Michigan State University               fx (517) 432-1671


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From jaimebg27 at gmail.com  Tue Feb 15 17:28:34 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 15 Feb 2011 11:28:34 -0500
Subject: [R-sig-Geo] Plot various bubble plot in the same plot window
Message-ID: <AANLkTi=w15sOPaxDKN0PQTE0yknYw3TaCKH-ax4L-9ru@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110215/198e774a/attachment.pl>

From thi_veloso at yahoo.com.br  Tue Feb 15 17:31:58 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 15 Feb 2011 08:31:58 -0800
Subject: [R-sig-Geo] How to draw grid contours within a map
Message-ID: <662715.12450.qm@web161417.mail.bf1.yahoo.com>

? Hi Lyndon,

? Thank you very much for sharing your function and for the tips as well. The code is very useful, but I'll have to make slight modifications in order to properly plot my data...

? The grids I need to draw span the following coordinates:

>fcst$lon[121:125]
>[1] -60.0 -57.5 -55.0 -52.5 -50.0
>fcstn$lat[23:27]
>[1] -35.0 -32.5 -30.0 -27.5 -25.0

? One solution could be adapting your function to use degrees instead of metres. By doing this, the arguments would be something like:
 
fcstgrid <- createPolyGrid(x = -60, y = -35, h = 10, w = 10, size = 2.5)

? "GridTopology" and related help pages don't mention how to use degrees instead of metres (or my R immaturity prevented me from finding)...

  Any tips to help me working on that adaptation?

? Best regards,

? Thiago.


--- On Tue, 15/2/11, Lyndon Estes <lestes at princeton.edu> wrote:

> From: Lyndon Estes <lestes at princeton.edu>
> Subject: Re: [R-sig-Geo] How to draw grid contours within a map
> To: "Thiago Veloso" <thi_veloso at yahoo.com.br>
> Cc: "R SIG list" <r-sig-geo at stat.math.ethz.ch>
> Date: Tuesday, 15 February, 2011, 12:43
> Hi Thiago,
> 
> I was doing something a bit similar to what you are doing
> just
> recently.? Instead of creating a raster of the grids,
> I created
> polygon grids, which is then quite simple to overlay on
> other
> polygons.
> 
> Here's a function I used to create the polygon grids:
> 
> createPolyGrid <- function(x, y, h, w, size, prj) {
> # Creates a polygon grid in meters
> # Args:
> #???x: X coordinate of lower left corner of
> lower left of polygon, in meters
> #???y: Y coordinate of lower left corner of
> lower left of polygon, in meters
> #???h: The desired North-South extent of the
> grid
> #???w: The desired East-West extent of the
> grid
> #???size: Grid polygon cell size in meters
> #???prj: Object holding the crs string for
> the desired projection (optional)
> # Returns:
> #???A SpatialPolygonsDataFrame with square
> grids, with North-South and
> East-West distances rounded to
> #???avoid fractionating grid cells. An
> attribute data frame of 1
> column holding polygon identifiers is created
> 
> ? if(missing(x)) {
> ? ? stop("missing x")
> ? } else if(missing(y)) {
> ? ? stop("missing y")
> ? } else if(missing(h)) {
> ? ? stop("missing h")
> ? } else if(missing(w)) {
> ? ? stop("missing w")
> ? } else if(missing(size)) {
> ? ? stop("missing size")
> ? }
> 
> ? # Define numbers of row and columns in grid,
> rounding to nearest whole numbers
> ? xrow <- round(w / size, 0)
> ? yrow <- round(h / size, 0)
> 
> ? # Define coordinates for center of lower left cell
> ? xcen <- x + size / 2
> ? ycen <- y + size / 2
> 
> ? # Create grid topology
> ? grd <- GridTopology(c(xcen, ycen), c(size, size),
> c(xrow, yrow))
> 
> ? # Turn it into polygons
> ? if(missing(prj)) {
> ? ? grd.shp <-
> as.SpatialPolygons.GridTopology(grd)
> ? } else if(!missing(prj)) {
> ? ? grd.shp <-
> as.SpatialPolygons.GridTopology(grd, prj)
> ? }
> 
> ? # Create data frame and then SpatialPolygons into
> SpatialPolygonsDataFrame
> ? grd.dat <-
> as.data.frame(matrix(1:length(grd.shp), ncol = 1))
> ? colnames(grd.dat) <- "polID"
> ? row.names(grd.dat) <-
> as.character(grd.dat$polID)
> ? grd.out.shp <- SpatialPolygonsDataFrame(grd.shp,
> grd.dat, match.ID = FALSE)
> 
> ? return(grd.out.shp)
> }
> 
> 
> # Here's an example of how to make the grid with the
> function above
> and plot it over another polygon, based on
> # the meuse dataset (meuse.sr example taken from
> http://r-spatial.sourceforge.net/gallery/)
> 
> library(gstat)
> 
> data(meuse.riv)
> meuse.sr =
> SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
>? # Polygon of river
> 
> # Find extent of river shape and use the coordinates to
> create polygon grid
> ex <- bbox(meuse.sr)
> gr <- createPolyGrid(x = ex[1, 1], y = ex[2, 1], h =
> ex[2, 2] - ex[2,
> 1], w = ex[1, 2] - ex[1, 1], size = 500)
> 
> # Plot
> plot(meuse.sr)
> plot(gr, add = T)
> 
> Hope this helps.
> 
> Cheers, Lyndon
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> On Tue, Feb 15, 2011 at 7:22 AM, Thiago Veloso <thi_veloso at yahoo.com.br>
> wrote:
> > ? Dear R-Siggers,
> >
> > ? In order to illustrate the spatial domain of the
> General Circulation Model (GCM) output data I am using, I
> need to display some grids within a map. They need to be
> 2.5?x2.5? lat-lon over specific coordinates. Actually, I
> am trying to partially reproduce Figure 1 inside Challinor
> et al., 2005 (image attached).
> >
> > ? To load and display the shapefile I use the
> following code:
> >
> > library(maptools)
> >
> southern=readShapePoly("D:/Maps/papers-in-progress/regiao_sul.shp")
> > plot(southern)
> >
> > ? Following, I create the "empty" grids to draw:
> >
> > library(raster)
> > rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25)
> > res(rprecip)<-2.5
> >
> > ? But I am stuck on the task of displaying those
> grids on the map.
> >
> > ? Could anybody please point any directions?
> >
> > ? Best,
> >
> > ? Thiago.
> >
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> 
> 
> 
> -- 
> Lyndon Estes
> Research Associate
> Woodrow Wilson School
> Princeton University
> +1-609-258-2392 (o)
> +1-609-258-6082 (f)
> +1-202-431-0496 (m)
> lestes at princeton.edu
>








From lestes at princeton.edu  Tue Feb 15 17:48:09 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Tue, 15 Feb 2011 11:48:09 -0500
Subject: [R-sig-Geo] How to draw grid contours within a map
In-Reply-To: <662715.12450.qm@web161417.mail.bf1.yahoo.com>
References: <662715.12450.qm@web161417.mail.bf1.yahoo.com>
Message-ID: <AANLkTikh4pUuVoKgZEUduR-ije-URG6EBX3ABbCCcrd=@mail.gmail.com>

Hi Thiago,

It seems to work just fine with geographic coordinates as well.  I am
working at the moment with a GCS WGS84 shape of Africa (af.gsc), and
the following seems to work fine:

# Africa shapefile download from
# http://www.internationalmapping.com/index/Goodies_Africa.html

p.base <- "/path/to/Africa.shp
setwd(p.base)

gcs.proj <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"

af <- readOGR(dsn = "African_Coastline.shp", layer = "African_Coastline")
af.gsc <- spTransform(af, gcs.proj)  # Transform it GSC

ex <- bbox(af.gsc)

# 10 degree grid
gr <- createPolyGrid(x = ex[1, 1], y = ex[2, 1], h = ex[2, 2] - ex[2,
1], w = ex[1, 2] - ex[1, 1], size = 10)

plot(af.gsc)
plot(gr, add = T)

You might want to check the accuracy of the grids (caveat emptor), or
perhaps a wiser person than myself can comment on the soundness of
this approach.

Cheers, Lyndon


On Tue, Feb 15, 2011 at 11:31 AM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
> ? Hi Lyndon,
>
> ? Thank you very much for sharing your function and for the tips as well. The code is very useful, but I'll have to make slight modifications in order to properly plot my data...
>
> ? The grids I need to draw span the following coordinates:
>
>>fcst$lon[121:125]
>>[1] -60.0 -57.5 -55.0 -52.5 -50.0
>>fcstn$lat[23:27]
>>[1] -35.0 -32.5 -30.0 -27.5 -25.0
>
> ? One solution could be adapting your function to use degrees instead of metres. By doing this, the arguments would be something like:
>
> fcstgrid <- createPolyGrid(x = -60, y = -35, h = 10, w = 10, size = 2.5)
>
> ? "GridTopology" and related help pages don't mention how to use degrees instead of metres (or my R immaturity prevented me from finding)...
>
> ?Any tips to help me working on that adaptation?
>
> ? Best regards,
>
> ? Thiago.
>
>
> --- On Tue, 15/2/11, Lyndon Estes <lestes at princeton.edu> wrote:
>
>> From: Lyndon Estes <lestes at princeton.edu>
>> Subject: Re: [R-sig-Geo] How to draw grid contours within a map
>> To: "Thiago Veloso" <thi_veloso at yahoo.com.br>
>> Cc: "R SIG list" <r-sig-geo at stat.math.ethz.ch>
>> Date: Tuesday, 15 February, 2011, 12:43
>> Hi Thiago,
>>
>> I was doing something a bit similar to what you are doing
>> just
>> recently.? Instead of creating a raster of the grids,
>> I created
>> polygon grids, which is then quite simple to overlay on
>> other
>> polygons.
>>
>> Here's a function I used to create the polygon grids:
>>
>> createPolyGrid <- function(x, y, h, w, size, prj) {
>> # Creates a polygon grid in meters
>> # Args:
>> #???x: X coordinate of lower left corner of
>> lower left of polygon, in meters
>> #???y: Y coordinate of lower left corner of
>> lower left of polygon, in meters
>> #???h: The desired North-South extent of the
>> grid
>> #???w: The desired East-West extent of the
>> grid
>> #???size: Grid polygon cell size in meters
>> #???prj: Object holding the crs string for
>> the desired projection (optional)
>> # Returns:
>> #???A SpatialPolygonsDataFrame with square
>> grids, with North-South and
>> East-West distances rounded to
>> #???avoid fractionating grid cells. An
>> attribute data frame of 1
>> column holding polygon identifiers is created
>>
>> ? if(missing(x)) {
>> ? ? stop("missing x")
>> ? } else if(missing(y)) {
>> ? ? stop("missing y")
>> ? } else if(missing(h)) {
>> ? ? stop("missing h")
>> ? } else if(missing(w)) {
>> ? ? stop("missing w")
>> ? } else if(missing(size)) {
>> ? ? stop("missing size")
>> ? }
>>
>> ? # Define numbers of row and columns in grid,
>> rounding to nearest whole numbers
>> ? xrow <- round(w / size, 0)
>> ? yrow <- round(h / size, 0)
>>
>> ? # Define coordinates for center of lower left cell
>> ? xcen <- x + size / 2
>> ? ycen <- y + size / 2
>>
>> ? # Create grid topology
>> ? grd <- GridTopology(c(xcen, ycen), c(size, size),
>> c(xrow, yrow))
>>
>> ? # Turn it into polygons
>> ? if(missing(prj)) {
>> ? ? grd.shp <-
>> as.SpatialPolygons.GridTopology(grd)
>> ? } else if(!missing(prj)) {
>> ? ? grd.shp <-
>> as.SpatialPolygons.GridTopology(grd, prj)
>> ? }
>>
>> ? # Create data frame and then SpatialPolygons into
>> SpatialPolygonsDataFrame
>> ? grd.dat <-
>> as.data.frame(matrix(1:length(grd.shp), ncol = 1))
>> ? colnames(grd.dat) <- "polID"
>> ? row.names(grd.dat) <-
>> as.character(grd.dat$polID)
>> ? grd.out.shp <- SpatialPolygonsDataFrame(grd.shp,
>> grd.dat, match.ID = FALSE)
>>
>> ? return(grd.out.shp)
>> }
>>
>>
>> # Here's an example of how to make the grid with the
>> function above
>> and plot it over another polygon, based on
>> # the meuse dataset (meuse.sr example taken from
>> http://r-spatial.sourceforge.net/gallery/)
>>
>> library(gstat)
>>
>> data(meuse.riv)
>> meuse.sr =
>> SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
>>? # Polygon of river
>>
>> # Find extent of river shape and use the coordinates to
>> create polygon grid
>> ex <- bbox(meuse.sr)
>> gr <- createPolyGrid(x = ex[1, 1], y = ex[2, 1], h =
>> ex[2, 2] - ex[2,
>> 1], w = ex[1, 2] - ex[1, 1], size = 500)
>>
>> # Plot
>> plot(meuse.sr)
>> plot(gr, add = T)
>>
>> Hope this helps.
>>
>> Cheers, Lyndon
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> On Tue, Feb 15, 2011 at 7:22 AM, Thiago Veloso <thi_veloso at yahoo.com.br>
>> wrote:
>> > ? Dear R-Siggers,
>> >
>> > ? In order to illustrate the spatial domain of the
>> General Circulation Model (GCM) output data I am using, I
>> need to display some grids within a map. They need to be
>> 2.5?x2.5? lat-lon over specific coordinates. Actually, I
>> am trying to partially reproduce Figure 1 inside Challinor
>> et al., 2005 (image attached).
>> >
>> > ? To load and display the shapefile I use the
>> following code:
>> >
>> > library(maptools)
>> >
>> southern=readShapePoly("D:/Maps/papers-in-progress/regiao_sul.shp")
>> > plot(southern)
>> >
>> > ? Following, I create the "empty" grids to draw:
>> >
>> > library(raster)
>> > rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25)
>> > res(rprecip)<-2.5
>> >
>> > ? But I am stuck on the task of displaying those
>> grids on the map.
>> >
>> > ? Could anybody please point any directions?
>> >
>> > ? Best,
>> >
>> > ? Thiago.
>> >
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>>
>>
>>
>> --
>> Lyndon Estes
>> Research Associate
>> Woodrow Wilson School
>> Princeton University
>> +1-609-258-2392 (o)
>> +1-609-258-6082 (f)
>> +1-202-431-0496 (m)
>> lestes at princeton.edu
>>
>
>
>
>
>
>
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From edzer.pebesma at uni-muenster.de  Tue Feb 15 18:03:24 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 15 Feb 2011 18:03:24 +0100
Subject: [R-sig-Geo] Plot various bubble plot in the same plot window
In-Reply-To: <AANLkTi=w15sOPaxDKN0PQTE0yknYw3TaCKH-ax4L-9ru@mail.gmail.com>
References: <AANLkTi=w15sOPaxDKN0PQTE0yknYw3TaCKH-ax4L-9ru@mail.gmail.com>
Message-ID: <4D5AB1DC.9090404@uni-muenster.de>



On 02/15/2011 05:28 PM, Jaime Burbano Gir?n wrote:
> Hi everybody. I want to plot various bubble plot in the same plot window,
> I?ve tried with functions "par(mfrow)" and "set.panel()", but I haven?t got
> it. Does someone know how to do this? Thanks in advance.

If you want to arrange multiple bubble plots on a single plot device
(window, pdf file etc), you can look at

library(lattice)
?print.trellis

# and try

print(bubble(...), split = ... , more = TRUE)

look for an example in

library(gstat)
demo(krige)

If, however, you want to have a multi-panel plot with a bubble plot in
each panel (which will look much nicer), this will be harder. I would
use xyplot (in package lattice) directly, with all the tricks you see
when printing function bubble (which uses xyplot) will get you there.

With best regards,
--
Edzer

> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Tue Feb 15 19:05:34 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 15 Feb 2011 10:05:34 -0800
Subject: [R-sig-Geo] How to draw grid contours within a map
In-Reply-To: <701436.7348.qm@web161412.mail.bf1.yahoo.com>
References: <701436.7348.qm@web161412.mail.bf1.yahoo.com>
Message-ID: <1297793134419-6028652.post@n2.nabble.com>


>  In order to illustrate the spatial domain of the General Circulation Model
(GCM) output data I am using, I 
> need to display some grids within a map. They need to be 2.5?x2.5? lat-lon
> over specific coordinates. 

>  Following, I create the "empty" grids to draw: 

>library(raster) 
>rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25) 
>res(rprecip)<-2.5 

Thiago, 

You can do this

rprecip[] <- 1
# (set cells you do not want to NA)
p <- rasterToPolygons(res)
plot(p)

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-draw-grid-contours-within-a-map-tp6027387p6028652.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rundel at gmail.com  Wed Feb 16 01:35:52 2011
From: rundel at gmail.com (rundel)
Date: Tue, 15 Feb 2011 16:35:52 -0800
Subject: [R-sig-Geo] classify point by nearest polygon
In-Reply-To: <4D5704BA.5030800@mail.mcgill.ca>
References: <4D5704BA.5030800@mail.mcgill.ca>
Message-ID: <1297816552305-6030040.post@n2.nabble.com>


This can also be done with rgeos, a simple example is below. The 2nd half is
relevant to what you are trying to accomplish the rest is just generating
lakelike polygons.


set.seed(1)
txt = rep("",5)
for(i in 1:5) {
	xc = floor(runif(1,1,25))
	yc = floor(runif(1,1,25))
	
	xpts = round(rnorm(10,0,0.5),3)
	ypts = round(rnorm(10,0,0.5),3)
	
	txt[i] = paste("MULTIPOINT(",paste( "(",xpts+xc,"
",ypts+yc,")",sep="",collapse="," ),")",sep="")
}

wkt = paste( "GEOMETRYCOLLECTION(",paste(txt,collapse=","),")", sep="")
z2=gConvexHull(readWKT(wkt),byid=TRUE)

lakes = gBuffer(z2,byid=TRUE,width=1,quadsegs=10)
plot(lakes,col=1:5+1)

pts = matrix( runif(100,1,25),ncol=2)

pts_wkt = paste( "GEOMETRYCOLLECTION(", paste(paste("POINT(",pts[,1],"
",pts[,2],")",sep=""),collapse=",") ,")", sep="")
pts_sp = readWKT(pts_wkt)

cols = apply(gDistance(pts_sp,z3,byid=TRUE),2,which.min)
plot(pts_sp,pch=16,col=cols+1,add=TRUE)
plot(pts_sp,pch=1,add=TRUE)

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/classify-point-by-nearest-polygon-tp6019714p6030040.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From simon.ohanlon at imperial.ac.uk  Wed Feb 16 17:43:44 2011
From: simon.ohanlon at imperial.ac.uk (O'Hanlon, Simon J)
Date: Wed, 16 Feb 2011 16:43:44 +0000
Subject: [R-sig-Geo] Calculating distance between point features and
	SpatialLines
Message-ID: <BC1C610780300542BA4CBE44AEDE37041A2055BA@icexm6.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110216/6d0a2e6a/attachment.pl>

From marcelino.delacruz at upm.es  Wed Feb 16 17:57:12 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 16 Feb 2011 17:57:12 +0100
Subject: [R-sig-Geo] Calculating distance between point features and
 SpatialLines
In-Reply-To: <BC1C610780300542BA4CBE44AEDE37041A2055BA@icexm6.ic.ac.uk>
References: <BC1C610780300542BA4CBE44AEDE37041A2055BA@icexm6.ic.ac.uk>
Message-ID: <201102161657.p1GGvS3J024150@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110216/f69ebba5/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Feb 16 18:57:46 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 16 Feb 2011 09:57:46 -0800
Subject: [R-sig-Geo] How to draw grid contours within a map
In-Reply-To: <1297793134419-6028652.post@n2.nabble.com>
Message-ID: <721678.6874.qm@web161406.mail.bf1.yahoo.com>

  Robert and Lyndon,

  Thank you very much. With little effort, both approaches worked flawlessly.

  Best,

  Thiago.
--- On Tue, 15/2/11, Robert Hijmans <r.hijmans at gmail.com> wrote:

> From: Robert Hijmans <r.hijmans at gmail.com>
> Subject: Re: [R-sig-Geo] How to draw grid contours within a map
> To: r-sig-geo at stat.math.ethz.ch
> Date: Tuesday, 15 February, 2011, 16:05
> 
> >? In order to illustrate the spatial domain of the
> General Circulation Model
> (GCM) output data I am using, I 
> > need to display some grids within a map. They need to
> be 2.5?x2.5? lat-lon
> > over specific coordinates. 
> 
> >? Following, I create the "empty" grids to draw: 
> 
> >library(raster) 
> >rprecip<-raster(xmn=-60,xmx=-50,ymn=-35,ymx=-25) 
> >res(rprecip)<-2.5 
> 
> Thiago, 
> 
> You can do this
> 
> rprecip[] <- 1
> # (set cells you do not want to NA)
> p <- rasterToPolygons(res)
> plot(p)
> 
> Robert
> -- 
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-draw-grid-contours-within-a-map-tp6027387p6028652.html
> Sent from the R-sig-geo mailing list archive at
> Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 





From nkkroy3 at gmail.com  Wed Feb 16 21:50:18 2011
From: nkkroy3 at gmail.com (Nikki roy)
Date: Wed, 16 Feb 2011 21:50:18 +0100
Subject: [R-sig-Geo] comparison (1) is possible only for atomic and list
	types
Message-ID: <AANLkTikpFJJsjfT26sOysKARCVWC4LWs6q8SgOev-Sau@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110216/4257596c/attachment.pl>

From Roger.Bivand at nhh.no  Wed Feb 16 21:56:56 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 16 Feb 2011 21:56:56 +0100
Subject: [R-sig-Geo] classify point by nearest polygon
In-Reply-To: <1297816552305-6030040.post@n2.nabble.com>
References: <4D5704BA.5030800@mail.mcgill.ca>
	<1297816552305-6030040.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1102162140140.29370@reclus.nhh.no>

On Tue, 15 Feb 2011, rundel wrote:

>
> This can also be done with rgeos, a simple example is below. The 2nd half is
> relevant to what you are trying to accomplish the rest is just generating
> lakelike polygons.
>

Maybe it was just my mailer breaking lines at the wrong places, but a 
couple of updates are needed for this to fly:

>
set.seed(1)
txt = rep("",5)
for(i in 1:5) {
 	xc = floor(runif(1,1,25))
 	yc = floor(runif(1,1,25))

 	xpts = round(rnorm(10,0,0.5),3)
 	ypts = round(rnorm(10,0,0.5),3)

# 	txt[i] = paste("MULTIPOINT(",paste( "(",xpts+xc,"
# ",ypts+yc,")",sep="",collapse="," ),")",sep="")
 	tmp <- paste("(", xpts+xc, " " ,ypts+yc,")", sep="", collapse=",")
 	txt[i] = paste("MULTIPOINT(", tmp, ")", sep="")
}

wkt = paste( "GEOMETRYCOLLECTION(",paste(txt,collapse=","),")", sep="")
z2=gConvexHull(readWKT(wkt),byid=TRUE)

lakes = gBuffer(z2,byid=TRUE,width=1,quadsegs=10)
plot(lakes,col=1:5+1)

pts = matrix( runif(100,1,25),ncol=2)

#pts_wkt = paste( "GEOMETRYCOLLECTION(",
#paste(paste("POINT(",pts[,1],"
#",pts[,2],")",sep=""),collapse=",") ,")", sep="")

tmp <- paste("POINT(",pts[,1]," ",pts[,2],")",sep="")
pts_wkt = paste("GEOMETRYCOLLECTION(", paste(tmp, collapse=",") ,")",
   sep="")
pts_sp = readWKT(pts_wkt)

#cols = apply(gDistance(pts_sp,z3,byid=TRUE),2,which.min)
cols = apply(gDistance(pts_sp, lakes, byid=TRUE), 2, which.min)

class(lakes)
class(pts_sp)

plot(pts_sp,pch=16,col=cols+1,add=TRUE)
plot(pts_sp,pch=1,add=TRUE)

with the work being done by gDistance(). The problem was that WKT wants 
coordinates as "(123.456 789.012)" in parentheses separated by a space, 
and the mailer line break (for my mailer, maybe nobody else saw this) hit 
that critical space.

The main point was actually to say that gDistance() should also handle the 
points to line question that came up today too:

gDistance(pts_sp, as(lakes, "SpatialLines"), byid=TRUE)

cols = apply(gDistance(pts_sp, as(lakes, "SpatialLines"), byid=TRUE), 2,
   which.min)
plot(as(lakes, "SpatialLines"), lwd=2, col=1:5+1)
plot(pts_sp,pch=16,col=cols+1,add=TRUE)
plot(pts_sp,pch=1,add=TRUE)


Roger

>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From vickyqau at gmail.com  Thu Feb 17 03:04:15 2011
From: vickyqau at gmail.com (waqar younas)
Date: Wed, 16 Feb 2011 18:04:15 -0800
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTikOHCmY_9w_qWk0rnPKyWPiEciDYYOPFeU6cTB+@mail.gmail.com>
References: <AANLkTikUsL0sSXLKUZi0NBsf36GgzW-HDwonobw-nA3U@mail.gmail.com>
	<921007.49647.qm@web161407.mail.bf1.yahoo.com>
	<AANLkTikb5NUoJCvOJz_rTCzkkTau45VuC9Z0OxBytmBD@mail.gmail.com>
	<4D532F3E.70604@st-andrews.ac.uk>
	<AANLkTinAieXYWaXfD6Fhf7bo5iQzQ1W2dbzBnRxMo2Dm@mail.gmail.com>
	<4D53AF9C.7040308@st-andrews.ac.uk>
	<AANLkTikOHCmY_9w_qWk0rnPKyWPiEciDYYOPFeU6cTB+@mail.gmail.com>
Message-ID: <AANLkTiki2iQfuYT2WgEBJegpSnsy2-edWWnya6tW_WJ5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110216/2789e16e/attachment.pl>

From thi_veloso at yahoo.com.br  Thu Feb 17 03:29:18 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 16 Feb 2011 18:29:18 -0800 (PST)
Subject: [R-sig-Geo] About R
In-Reply-To: <AANLkTiki2iQfuYT2WgEBJegpSnsy2-edWWnya6tW_WJ5@mail.gmail.com>
Message-ID: <401003.90793.qm@web161407.mail.bf1.yahoo.com>

  Waqar,

  Just extract the source file downloaded from CRAN and examine the contents of the "R" directory. 

  Best,

  Thiago.

--- On Thu, 17/2/11, waqar younas <vickyqau at gmail.com> wrote:

> From: waqar younas <vickyqau at gmail.com>
> Subject: Re: [R-sig-Geo] About R
> To: "Roman Lu?trik" <roman.lustrik at gmail.com>
> Cc: r-sig-geo at r-project.org
> Date: Thursday, 17 February, 2011, 0:04
> Hi all
> Thanks for your kind help.
> I solved my problem. Now i want to look at the source codes
> of different
> function used in the verification package of R for example,
> the code of the
> function verify, attribute etc. Can any one help in this
> regard?
> 
> On Thu, Feb 10, 2011 at 1:30 AM, Roman Lu?trik <roman.lustrik at gmail.com>wrote:
> 
> > I'm a big fan of StackOverflow's R tag:
> > http://stackoverflow.com/questions/tagged/r
> >
> >
> > Cheers,
> > Roman
> >
> >
> >
> > On Thu, Feb 10, 2011 at 10:27 AM, Philipp
> Boersch-Supan <
> > phb4 at st-andrews.ac.uk>
> wrote:
> >
> >> Have a look at
> >>
> >> ?array
> >>
> >> its use in comparison to MATLAB's reshape is in
> fact described in the
> >> Hiebeler-matlabR.pdf that Arien mentioned
> yesterday.? If you want to
> >> stick to MATLAB-like syntax, the matlab package
> has a function reshape
> >> that should do exactly what you want:
> >> http://cran.r-project.org/web/packages/matlab/
> >>
> >> There is a wealth of information out there on
> porting code between R and
> >> Matlab as well as basic R functionalities. http://www.rseek.org and the
> >> R-help mailing list have been mentioned before.
> >>
> >> Best,
> >> Philipp
> >>
> >> On 10.02.2011 01:07, waqar younas wrote:
> >> > Thank you very much for your kind response.
> >> > I looked at the document and found the
> alternative of size in R which
> >> > dim(). But the reshape function in the
> document for MATLAB is not
> >> > completely specified. In MATLAB when we do
> reshape, we simply use this
> >> > command,
> >> >
> >> > if my file name "data" has this dimension
> (12,396*10) and i want to
> >> > change it into three dimension then i will
> use in MATLAB as
> >> >
> >> > reshape(data,120,396,10).
> >> >
> >> > In the document you sent to me, the reshape
> function for MATLAB is
> >> > only given for 2 dimension and i think the
> script of the function is
> >> > not correct. That is why its alternative in R
> is also limited to 2
> >> > dimension.
> >> >
> >> > Can you help me in this regard?
> >> >
> >> >
> >> > On Wed, Feb 9, 2011 at 4:20 PM, Philipp
> Boersch-Supan
> >> > <phb4 at st-andrews.ac.uk
> <mailto:phb4 at st-andrews.ac.uk>>
> wrote:
> >> >
> >> >? ???Hi Younas,
> >> >
> >> >? ???have a look at the
> R-MATLAB dictionary:
> >> >? ???http://mathesaurus.sourceforge.net/octave-r.html
> >> >? ???It should be a great
> resource for you if you are familiar with
> >> >? ???MATLAB commands and
> want to klnow the R equivalents.
> >> >
> >> >? ???Best,
> >> >? ???Philipp
> >> >
> >> >? ???Philipp
> Boersch-Supan, MRes
> >> >
> >> >? ???Pelagic Ecology
> Research Group
> >> >? ???University of St.
> Andrews
> >> >
> >> >? ???Current Address:
> >> >? ???University of Oxford
> >> >? ???Department of
> Zoology
> >> >? ???South Parks Road
> >> >? ???Oxford
> >> >? ???OX1 3PS
> >> >? ???United Kingdom
> >> >
> >> >
> >> >
> >> >? ???On 10/02/2011 00:03,
> waqar younas wrote:
> >> >
> >> >? ? ? ???Thank
> you very much to all of you.
> >> >? ? ? ???It was
> very helpful. Now i am able to read the data in R in
> >> >? ? ? ???txt
> format. Now
> >> >? ? ? ???i want
> to know how to check the size of data and reshape the
> >> >? ? ? ???data in
> R? As
> >> >? ? ? ???in
> Matlab we just write size(data) and reshape(data,..). How
> >> >? ? ? ???can we
> do that
> >> >? ? ? ???in R?
> >> >? ? ? ???My data
> size (from MATLAB) is 120,396*10). I want to reshape it
> >> as
> >> >? ? ?
> ???120,396,10.
> >> >
> >> >? ? ? ???On Wed,
> Feb 9, 2011 at 3:24 AM, Thiago
> >> >? ? ?
> ???Veloso<thi_veloso at yahoo.com.br
> >> >? ? ?
> ???<mailto:thi_veloso at yahoo.com.br>>wrote:
> >>
> >> >
> >> >? ? ? ? ? ?
> ? Younas,
> >> >
> >> >? ? ? ? ? ?
> ? Although I don't know what are the specific data you
> need
> >> >? ? ? ? ?
> ???to analyze or
> >> >? ? ? ? ?
> ???the tests you need to perform, some
> packages can certainly
> >> >? ? ? ? ?
> ???be recommended.
> >> >? ? ? ? ?
> ???"RnetCDF" and "raster" are great to import
> netCDF files.
> >> >? ? ? ? ?
> ???NCAR's
> >> >? ? ? ? ?
> ???"verification" package (
> >> >
> >> http://cran.r-project.org/web/packages/verification/index.html)
> >> >? ? ? ? ?
> ???offers
> >> >? ? ? ? ?
> ???useful tools for analysing probabilistic
> or deterministic
> >> >? ? ? ? ?
> ???forecasts. Package
> >> >? ? ? ? ?
> ???"clim.pact"
> >> >? ? ? ? ?
> ???(
> >> http://cran.r-project.org/web/packages/clim.pact/index.html)
> >> >? ? ? ? ?
> ???might be useful as well.
> >> >
> >> >? ? ? ? ? ?
> ? Hope it helps,
> >> >
> >> >? ? ? ? ? ?
> ? Thiago.
> >> >
> >> >? ? ? ? ?
> ???--- On Tue, 8/2/11, waqar younas<vickyqau at gmail.com
> >> >? ? ? ? ?
> ???<mailto:vickyqau at gmail.com>>?
> wrote:
> >>
> >> >
> >> >? ? ? ? ? ?
> ? ???From: waqar younas<vickyqau at gmail.com
> >> >? ? ? ? ? ?
> ? ???<mailto:vickyqau at gmail.com>>
> >>
> >> >? ? ? ? ? ?
> ? ???Subject: [R-sig-Geo] About R
> >> >? ? ? ? ? ?
> ? ???To: cmbarker at ucdavis.edu
> >> >? ? ? ? ? ?
> ? ???<mailto:cmbarker at ucdavis.edu>,
> r-sig-geo at r-project.org
> >> >? ? ? ? ? ?
> ? ???<mailto:r-sig-geo at r-project.org>
> >>
> >> >? ? ? ? ? ?
> ? ???Date: Tuesday, 8 February, 2011,
> 22:50
> >> >? ? ? ? ? ?
> ? ???Hi
> >> >? ? ? ? ? ?
> ? ???I am PhD Candidate in UNBC, Canada
> and working on
> >> seasonal
> >> >? ? ? ? ? ?
> ? ???climate
> >> >? ? ? ? ? ?
> ? ???prediction data analysis.
> Currently, i am using MATLAB
> >> but
> >> >? ? ? ? ? ?
> ? ???i also want to
> >> >? ? ? ? ? ?
> ? ???use R for probabilistic
> verification package. I do not
> >> >? ? ? ? ? ?
> ? ???know
> >> >? ? ? ? ? ?
> ? ???even how to read
> >> >? ? ? ? ? ?
> ? ???data in R. First of all, i read the
> manual of R, but it
> >> is
> >> >? ? ? ? ? ?
> ? ???not written
> >> >? ? ? ? ? ?
> ? ???clearly which data formats R
> supports? In MATLAB, i can
> >> >? ? ? ? ? ?
> ? ???save my data into
> >> >? ? ? ? ? ?
> ? ???grid format so i want to know, how
> grid data can be read
> >> >? ? ? ? ? ?
> ? ???able in R. There is
> >> >? ? ? ? ? ?
> ? ???interface people use so that R can
> be called within
> >> >? ? ? ? ? ?
> ? ???MATLAB,
> >> >? ? ? ? ? ?
> ? ???but i do not
> >> >? ? ? ? ? ?
> ? ???know how?
> >> >
> >> >? ? ? ? ? ?
> ? ???--
> >> >? ? ? ? ? ?
> ? ???Best Regards
> >> >
> >> >? ? ? ? ? ?
> ? ???Waqar Younas
> >> >? ? ? ? ? ?
> ? ???PhD Candidate
> >> >? ? ? ? ? ?
> ? ???Natural Resources and Environmental
> Studies (NRES)
> >> >? ? ? ? ? ?
> ? ???University of Northern British
> Columbia (UNBC)
> >> >? ? ? ? ? ?
> ? ???Canada
> >> >
> >> >? ? ? ? ? ?
> ? ? ? ???[[alternative HTML
> version deleted]]
> >> >
> >> >? ? ? ? ? ?
> ?
> ???_______________________________________________
> >> >? ? ? ? ? ?
> ? ???R-sig-Geo mailing list
> >> >? ? ? ? ? ?
> ? ???R-sig-Geo at r-project.org
> <mailto:R-sig-Geo at r-project.org
> >> >
> >>
> >> >? ? ? ? ? ?
> ? ???https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >> >
> >> >
> >> >
> >> >
> >> >
> >> >
> >> >
> >> >
> >> > --
> >> > Best Regards
> >> >
> >> > Waqar Younas
> >> > PhD Candidate
> >> > Natural Resources and Environmental Studies
> (NRES)
> >> > University of Northern British Columbia
> (UNBC)
> >> > Canada
> >> >
> >>
> >>
> >> --
> >> Philipp Boersch-Supan, MRes
> >>
> >> Pelagic Ecology Research Group
> >> University of St. Andrews
> >>
> >> Current Address:
> >> University of Oxford
> >> Department of Zoology
> >> South Parks Road
> >> Oxford
> >> OX1 3PS
> >> United Kingdom
> >>
> >>
> >>
> >>? ? ? ? [[alternative HTML
> version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
> >
> > --
> > In God we trust, all others bring data.
> >
> 
> 
> 
> -- 
> Best Regards
> 
> Waqar Younas
> PhD Candidate
> Natural Resources and Environmental Studies (NRES)
> University of Northern British Columbia (UNBC)
> Canada
> 
> ??? [[alternative HTML version deleted]]
> 
> 
> -----Inline Attachment Follows-----
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 





From lestes at princeton.edu  Thu Feb 17 04:58:42 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Wed, 16 Feb 2011 22:58:42 -0500
Subject: [R-sig-Geo] Efficient way to obtain gridded count of overlapping
	polygons?
Message-ID: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>

Hello,

I am interested in creating a raster that summarizes the number of
overlapping polygons that underlie each cell (in order to display how
many species occur at that point).

I have come up with a function that seems to work, but I was wondering
if I had missed one that already exists, or if someone can recommend a
better way?

Herewith the code:


CountIntersections <- function(x, y, CID) {
# Counts number of polygons intersecting spatial points, specifically
designed for situations in which
# SpatialPolygons object contains overlapping polygons
# Args:
#   x: Input SpatialPointsDataFrame
#   y: SpatialPolygons* on which to count intersects
#   CID: Name of column containing unique polygon IDs
# Returns:
#   SpatialPointsDataFrame with column providing summary of number of
polygons with unique IDs intersected

  # Vector of unique IDs
  ids <- as.character(unique(y at data[, CID]))

  # lapply function in which each unique polygons is extracted and
overlaid by points, with 1 assigned for sp
  # presence, 0 for absence
  p.int <- lapply(ids, function(z) {
    p.ex <- y[y at data[, CID] == z, ]  # Extract polygon(s)
corresponding to unique ID extracted by lapply
    ov <- overlay(x, p.ex)  # Intersect points with sp polygon
    ov2 <- ov / ov  # Reduce intersected polygon IDs to 1
    ov2[is.na(ov2)] <- 0  # Convert NAs to 0
    return(ov2)
  })
  x$P.cnt <- Reduce("+", p.int)  # Sum list of intersect for each
species, and add value to dataframe of x
  return(x)
}

# Load spatial points (pts) and polygons of 3 species' ranges (sppX3)
extracted from IUCN mammals database
# downloaded here: http://www.iucnredlist.org/technical-documents/spatial-data
con <- url("http://sites.google.com/site/ldemisc/polygon-intersect/spp.shp.Rdata")
load(con)
close(con)

# Run function and convert to raster
pts.ct <- CountIntersections(pts, sppX3, "BINOMIAL")
pts.grd <- SpatialPixelsDataFrame(pts.ct, pts.ct at data)
pts.rst <- raster(pts.grd, layer = "P.cnt")

# Seems to work based on plots
plot(pts.rst)
plot(sppX3, add = T)

Thanks in advance for any advice.

Cheers, Lyndon


From edzer.pebesma at uni-muenster.de  Thu Feb 17 08:07:51 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 17 Feb 2011 08:07:51 +0100
Subject: [R-sig-Geo] Efficient way to obtain gridded count of
 overlapping polygons?
In-Reply-To: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
References: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
Message-ID: <4D5CC947.4020400@uni-muenster.de>

Yes, the (relatively) new method "over" does this for you, as in

pts$n = sapply(over(pts, geometry(sppX3), returnList = TRUE), length)

In the context of a running script:

require(sp)
con <- url(
"http://sites.google.com/site/ldemisc/polygon-intersect/spp.shp.Rdata")
load(con)
close(con)
proj4string(pts) = proj4string(sppX3) # otherwise over will fail here;
pts$n = sapply(over(pts, geometry(sppX3), returnList = TRUE), length)
gridded(pts)=TRUE
spplot(pts["n"], sp.layout=list("sp.polygons", sppX3, first=F))


On 02/17/2011 04:58 AM, Lyndon Estes wrote:
> Hello,
> 
> I am interested in creating a raster that summarizes the number of
> overlapping polygons that underlie each cell (in order to display how
> many species occur at that point).
> 
> I have come up with a function that seems to work, but I was wondering
> if I had missed one that already exists, or if someone can recommend a
> better way?
> 
> Herewith the code:
> 
> 
> CountIntersections <- function(x, y, CID) {
> # Counts number of polygons intersecting spatial points, specifically
> designed for situations in which
> # SpatialPolygons object contains overlapping polygons
> # Args:
> #   x: Input SpatialPointsDataFrame
> #   y: SpatialPolygons* on which to count intersects
> #   CID: Name of column containing unique polygon IDs
> # Returns:
> #   SpatialPointsDataFrame with column providing summary of number of
> polygons with unique IDs intersected
> 
>   # Vector of unique IDs
>   ids <- as.character(unique(y at data[, CID]))
> 
>   # lapply function in which each unique polygons is extracted and
> overlaid by points, with 1 assigned for sp
>   # presence, 0 for absence
>   p.int <- lapply(ids, function(z) {
>     p.ex <- y[y at data[, CID] == z, ]  # Extract polygon(s)
> corresponding to unique ID extracted by lapply
>     ov <- overlay(x, p.ex)  # Intersect points with sp polygon
>     ov2 <- ov / ov  # Reduce intersected polygon IDs to 1
>     ov2[is.na(ov2)] <- 0  # Convert NAs to 0
>     return(ov2)
>   })
>   x$P.cnt <- Reduce("+", p.int)  # Sum list of intersect for each
> species, and add value to dataframe of x
>   return(x)
> }
> 
> # Load spatial points (pts) and polygons of 3 species' ranges (sppX3)
> extracted from IUCN mammals database
> # downloaded here: http://www.iucnredlist.org/technical-documents/spatial-data
> con <- url("http://sites.google.com/site/ldemisc/polygon-intersect/spp.shp.Rdata")
> load(con)
> close(con)
> 
> # Run function and convert to raster
> pts.ct <- CountIntersections(pts, sppX3, "BINOMIAL")
> pts.grd <- SpatialPixelsDataFrame(pts.ct, pts.ct at data)
> pts.rst <- raster(pts.grd, layer = "P.cnt")
> 
> # Seems to work based on plots
> plot(pts.rst)
> plot(sppX3, add = T)
> 
> Thanks in advance for any advice.
> 
> Cheers, Lyndon
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Armelle.Rouyer at ifremer.fr  Thu Feb 17 09:38:45 2011
From: Armelle.Rouyer at ifremer.fr (Armelle ROUYER)
Date: Thu, 17 Feb 2011 09:38:45 +0100
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
Message-ID: <4D5CDE95.6080503@ifremer.fr>

Dear all,

I used the PBSmapping package to make a grid with the abundance of 
fishes. Each cell has an allocated value. I want to convert this grid 
into a shapefile in order to export it on ArcGIS.

So I tried the function "PolySet2SpatialPolygons". The grid is correctly 
transformed into polygons but the allocated value is ignored. Then I 
tried the function "SpatialPolygonsDataFrame" but it didn't work 
properly (only 13 values are associated with the 50 cells).

I am not sure that I am using the right functions. So if you have any 
idea or suggestion thank you for your help.

Regards.


-- 
Armelle Rouyer

IFREMER - Station de Lorient
Laboratoire Biologie Halieutique
8 rue Francois Toullec
56100 LORIENT
FRANCE
02 97 87 38 23


From tom.gottfried at wzw.tum.de  Thu Feb 17 13:10:24 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Thu, 17 Feb 2011 13:10:24 +0100
Subject: [R-sig-Geo] comparison (1) is possible only for atomic and list
 types
In-Reply-To: <AANLkTikpFJJsjfT26sOysKARCVWC4LWs6q8SgOev-Sau@mail.gmail.com>
References: <AANLkTikpFJJsjfT26sOysKARCVWC4LWs6q8SgOev-Sau@mail.gmail.com>
Message-ID: <4D5D1030.4050908@wzw.tum.de>

Nikki,

I'm not sure whether I understood what you are trying to do, but if you just want to replace values
in a column of a SpatialGridDataFrame, sp comes with all the methods you need. Example:

library(sp)
data(meuse.grid)
coordinates(meuse.grid) <- ~x+y
meuse.grid <- as(as(meuse.grid, "SpatialPixelsDataFrame"),"SpatialGridDataFrame")
spplot(meuse.grid[,,"soil"])

meuse.grid$soil[meuse.grid$soil==1] <- 4
meuse.grid$soil[meuse.grid$soil==2 | meuse.grid$soil==3] <- 5
spplot(meuse.grid[,,"soil"])

Hope that helps,
Tom
-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From Roger.Bivand at nhh.no  Thu Feb 17 16:18:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 Feb 2011 16:18:37 +0100 (CET)
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
In-Reply-To: <4D5CDE95.6080503@ifremer.fr>
References: <4D5CDE95.6080503@ifremer.fr>
Message-ID: <alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>

On Thu, 17 Feb 2011, Armelle ROUYER wrote:

> Dear all,
>
> I used the PBSmapping package to make a grid with the abundance of fishes. 
> Each cell has an allocated value. I want to convert this grid into a 
> shapefile in order to export it on ArcGIS.
>
> So I tried the function "PolySet2SpatialPolygons". The grid is correctly 
> transformed into polygons but the allocated value is ignored. Then I tried 
> the function "SpatialPolygonsDataFrame" but it didn't work properly (only 13 
> values are associated with the 50 cells).
>
> I am not sure that I am using the right functions. So if you have any idea or 
> suggestion thank you for your help.

library(PBSmapping)
library(maptools)
gt <- GridTopology(c(0.5, 0.5), c(1, 1), c(5, 10))
sp <- as(gt, "SpatialPolygons")
proj4string(sp) <- CRS("+proj=longlat")
PS0 <- SpatialPolygons2PolySet(sp)
PD0 <- as.PolyData(data.frame(PID=1:50, col=rep(rainbow(10), each=5),
   stringsAsFactors=FALSE))
plotPolys(PS0, polyProps=PD0, projection="LL")
# the above to set up a PolySet opject, PolyData object, and plot them
sp1 <- PolySet2SpatialPolygons(PS0)
mo <- match(as.character(PD0$PID), row.names(sp1))
# check mo - this is an easy match, in practice it may need more study
sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
   stringsAsFactors=FALSE))
plot(sp2, col=sp2$col, axes=TRUE)

seems to work. You match on the PolyData PID column and the row.names() of 
the SpatialPolygons object, which are the unique PolySet PID values. In 
this case, and probably in general, the PIDs in the PolyData and PolySet 
match by design. If there isn't an exact match, you'll need to construct 
an object of the correct length manually.

Roger

>
> Regards.
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From piero.campa at gmail.com  Thu Feb 17 16:47:37 2011
From: piero.campa at gmail.com (piero campa)
Date: Thu, 17 Feb 2011 07:47:37 -0800
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <1297675251985-6022991.post@n2.nabble.com>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl> <483AA4A6.2010101@uni-muenster.de>
	<483AB1F5.7000905@geo.uu.nl> <483AB641.1040201@uni-muenster.de>
	<1297675251985-6022991.post@n2.nabble.com>
Message-ID: <1297957657204-6036431.post@n2.nabble.com>


Any clue on this topic?
I think that the combination of RK with ordinary CK should be a spread
case.... But now I wonder whether it is the correct solution when dealing
with a set of predictors, and some of them are not ubiquitous in the
regression grid.

Thank you in any case.
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Ordinary-and-Regression-Kriging-combined-to-deal-with-missing-values-in-predictor-variables-tp2764942p6036431.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lestes at princeton.edu  Thu Feb 17 16:49:32 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Thu, 17 Feb 2011 10:49:32 -0500
Subject: [R-sig-Geo] Efficient way to obtain gridded count of
	overlapping polygons?
In-Reply-To: <4D5CC947.4020400@uni-muenster.de>
References: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
	<4D5CC947.4020400@uni-muenster.de>
Message-ID: <AANLkTi=Dd9oiTcS95ZzE6uiAsuFV3bNyJ17ibe1tO3bQ@mail.gmail.com>

Hi Edzer,

Many thanks for the pointer.

My rough function is an order of magnitude slower than the 'over' one
you showed.

Sys.time() difference for my approach = 3.65 seconds, for yours =
0.323 seconds.

That will make a big difference when I run it for several thousand species.

Thanks again, Lyndon


On Thu, Feb 17, 2011 at 2:07 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Yes, the (relatively) new method "over" does this for you, as in
>
> pts$n = sapply(over(pts, geometry(sppX3), returnList = TRUE), length)
>
> In the context of a running script:
>
> require(sp)
> con <- url(
> "http://sites.google.com/site/ldemisc/polygon-intersect/spp.shp.Rdata")
> load(con)
> close(con)
> proj4string(pts) = proj4string(sppX3) # otherwise over will fail here;
> pts$n = sapply(over(pts, geometry(sppX3), returnList = TRUE), length)
> gridded(pts)=TRUE
> spplot(pts["n"], sp.layout=list("sp.polygons", sppX3, first=F))
>
>
> On 02/17/2011 04:58 AM, Lyndon Estes wrote:
>> Hello,
>>
>> I am interested in creating a raster that summarizes the number of
>> overlapping polygons that underlie each cell (in order to display how
>> many species occur at that point).
>>
>> I have come up with a function that seems to work, but I was wondering
>> if I had missed one that already exists, or if someone can recommend a
>> better way?
>>
>> Herewith the code:
>>
>>
>> CountIntersections <- function(x, y, CID) {
>> # Counts number of polygons intersecting spatial points, specifically
>> designed for situations in which
>> # SpatialPolygons object contains overlapping polygons
>> # Args:
>> # ? x: Input SpatialPointsDataFrame
>> # ? y: SpatialPolygons* on which to count intersects
>> # ? CID: Name of column containing unique polygon IDs
>> # Returns:
>> # ? SpatialPointsDataFrame with column providing summary of number of
>> polygons with unique IDs intersected
>>
>> ? # Vector of unique IDs
>> ? ids <- as.character(unique(y at data[, CID]))
>>
>> ? # lapply function in which each unique polygons is extracted and
>> overlaid by points, with 1 assigned for sp
>> ? # presence, 0 for absence
>> ? p.int <- lapply(ids, function(z) {
>> ? ? p.ex <- y[y at data[, CID] == z, ] ?# Extract polygon(s)
>> corresponding to unique ID extracted by lapply
>> ? ? ov <- overlay(x, p.ex) ?# Intersect points with sp polygon
>> ? ? ov2 <- ov / ov ?# Reduce intersected polygon IDs to 1
>> ? ? ov2[is.na(ov2)] <- 0 ?# Convert NAs to 0
>> ? ? return(ov2)
>> ? })
>> ? x$P.cnt <- Reduce("+", p.int) ?# Sum list of intersect for each
>> species, and add value to dataframe of x
>> ? return(x)
>> }
>>
>> # Load spatial points (pts) and polygons of 3 species' ranges (sppX3)
>> extracted from IUCN mammals database
>> # downloaded here: http://www.iucnredlist.org/technical-documents/spatial-data
>> con <- url("http://sites.google.com/site/ldemisc/polygon-intersect/spp.shp.Rdata")
>> load(con)
>> close(con)
>>
>> # Run function and convert to raster
>> pts.ct <- CountIntersections(pts, sppX3, "BINOMIAL")
>> pts.grd <- SpatialPixelsDataFrame(pts.ct, pts.ct at data)
>> pts.rst <- raster(pts.grd, layer = "P.cnt")
>>
>> # Seems to work based on plots
>> plot(pts.rst)
>> plot(sppX3, add = T)
>>
>> Thanks in advance for any advice.
>>
>> Cheers, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 ?http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics ? ? ?e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From axel.hille at gmx.net  Thu Feb 17 17:07:39 2011
From: axel.hille at gmx.net (Axel Hille)
Date: Thu, 17 Feb 2011 17:07:39 +0100
Subject: [R-sig-Geo] inverse overlay combination A and (not B) of polygon
 and SpatialPixelDataFrame
In-Reply-To: <alpine.LRH.2.00.1003191126090.24170@reclus.nhh.no>
References: <20100319090228.290730@gmx.net>
	<alpine.LRH.2.00.1003191126090.24170@reclus.nhh.no>
Message-ID: <20110217160739.238510@gmx.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110217/43e1c8b1/attachment.pl>

From r.hijmans at gmail.com  Thu Feb 17 17:48:00 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 17 Feb 2011 08:48:00 -0800
Subject: [R-sig-Geo] Efficient way to obtain gridded count of
	overlapping polygons?
In-Reply-To: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
References: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
Message-ID: <1297961280208-6036670.post@n2.nabble.com>


> I am interested in creating a raster that summarizes the number of 
> overlapping polygons that underlie each cell (in order to display how 
> many species occur at that point). 

Lyndon, 

You can also do the below, with raster, see ?rasterize:

r <- rasterize(pols, r, fun='count')

or 

r <- rasterize(pols, r, fun=function(x,...)length(na.omit(x)))


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Efficient-way-to-obtain-gridded-count-of-overlapping-polygons-tp6034590p6036670.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Thu Feb 17 17:49:10 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 17 Feb 2011 17:49:10 +0100
Subject: [R-sig-Geo] inverse overlay combination A and (not B) of
 polygon and SpatialPixelDataFrame
In-Reply-To: <20110217160739.238510@gmx.net>
References: <20100319090228.290730@gmx.net>	<alpine.LRH.2.00.1003191126090.24170@reclus.nhh.no>
	<20110217160739.238510@gmx.net>
Message-ID: <4D5D5186.7040108@uni-muenster.de>



On 02/17/2011 05:07 PM, Axel Hille wrote:
> Dear OSGEO list members,

Please take a look at www.osgeo.org to find out what osgeo means.

> I have installed R-10.1 on windows XP. My problem:

The current version is 2.12.1

> I have a polygon (the border of the Zuiderzee (=IJmeer?!) in the 

Zuiderzee is the historic name of the sea that is now IJsselmeer before
the Afsluitdijk was built (zee = "sea", becoming meer = "lake"), + the
areas that have been reclaimed since and used to be sea (Flevopolders,
Noordoostpolder).

> Netherlands) and a SpatialPixelsDataFrame, containing genetic similarities 
> among watersnakes across geography, bound to the convex hull curve of the 
> sampling coordinates, around the Zuidersee). What I want, is to cut off the 
> spatial grid by the edges of the Zuiderzee.
> What I so far only got by trying the overlay function is:
> ###
> zuiderzee_union # the polygon of the Zuiderzee
> rinsl.SPix.clus.clip # the SpatialPixelDataFrame
> sel=!is.na(overlay(rinsl.SPix.clus.clip, zuiderzee_union))
> ###?  A?  %over%?  B
> rinsl.SPix.clus.union.clip <- rinsl.SPix.clus.clip[sel,]
> ##
> This operation cuts out the area, which lies in the Zuiderzee - but I just 
> need the inverse (I assume acc. to the A and (not B) boolean opeation),?  
> the area which is outside the Zuiderzee.

Have you tried:

rinsl.SPix.clus.union.clip <- rinsl.SPix.clus.clip[!sel,]

> 
> Any help is much apprecited!
> Many Thanks in advance!
> 
> 
> ########################################################################
> Axel Hille (Dr. rer. nat.)
> population genetic and geography
> D-33605 Bielefeld
> ########################################################################
>         
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From lestes at princeton.edu  Thu Feb 17 18:36:24 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Thu, 17 Feb 2011 12:36:24 -0500
Subject: [R-sig-Geo] Efficient way to obtain gridded count of
	overlapping polygons?
In-Reply-To: <1297961280208-6036670.post@n2.nabble.com>
References: <AANLkTimzd0YpfjtfaktzZhBafzLO4umkg5OY1WuGDJg+@mail.gmail.com>
	<1297961280208-6036670.post@n2.nabble.com>
Message-ID: <AANLkTikqarqO6gJA+0DDHhtoJC7Ue8m3FnxhAbM+uecg@mail.gmail.com>

Hi Robert,

Many thanks for that suggestion as well, I appreciate it, which also
does the trick.

Just to update the time differences between the 3 methods, in case
anyone else is interested:

Function I wrote: 2.07 seconds
The "over" method from Edzer: 0.612 seconds
Rasterize function: 5.61 seconds (line of code used is below)


r2 <- rasterize(sppX3, r, fun = "count")

r was created from a shape of Africa with 1 degree resolution

Thanks again, Lyndon

On Thu, Feb 17, 2011 at 11:48 AM, Robert Hijmans <r.hijmans at gmail.com> wrote:
>
>> I am interested in creating a raster that summarizes the number of
>> overlapping polygons that underlie each cell (in order to display how
>> many species occur at that point).
>
> Lyndon,
>
> You can also do the below, with raster, see ?rasterize:
>
> r <- rasterize(pols, r, fun='count')
>
> or
>
> r <- rasterize(pols, r, fun=function(x,...)length(na.omit(x)))
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Efficient-way-to-obtain-gridded-count-of-overlapping-polygons-tp6034590p6036670.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From nataliarodriguezsantos at gmail.com  Thu Feb 17 18:39:56 2011
From: nataliarodriguezsantos at gmail.com (Natalia Rodriguez Santos)
Date: Thu, 17 Feb 2011 12:39:56 -0500
Subject: [R-sig-Geo] Fix the color palette scale in a raster plot
Message-ID: <AANLkTinraFXbqR8iqz+Ye8gerowH9Jcce7t3cBDshRkw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110217/fbb374fa/attachment.pl>

From andrewaduff at gmail.com  Thu Feb 17 19:36:49 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Thu, 17 Feb 2011 10:36:49 -0800
Subject: [R-sig-Geo] kde output from ks reversed
Message-ID: <1297967809866-6037090.post@n2.nabble.com>


Im having trouble with the results from the ks package being reversed.  There
must be a simple error that I am overlooking?  Does anybody see my problem

## for testing, just the first 100 records, format x coord, y coord
curset <- curset[1:100,] 

#Calculate hpi, hpidiag
Hpi1 <- Hpi(x = curset)

## Do the kde
ud_hpi <- kde(x = curset, H = Hpi1)

im <- list(x=ud_hpi$eval.points[[1]], y=ud_hpi$eval.points[[2]],
z=ud_hpiv$estimate)
SPim <- image2Grid(im)

writeAsciiGrid(SPim,
"P:/GISProjects/Support_Projects/JimWatson/GOEA_ForJim_20110201/BBMM/TestBBMM/R/Final_KS/ud_hpi_v2.asc",
attr=ncol(SPim))


http://r-sig-geo.2731867.n2.nabble.com/file/n6037090/ReverseCapture.jpg 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6037090.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From luca.candeloro at gmail.com  Fri Feb 18 08:56:31 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Fri, 18 Feb 2011 08:56:31 +0100
Subject: [R-sig-Geo] Selecting a raster cell which contains a point of given
	coordinates
Message-ID: <AANLkTinsdYVi3qZ-Xc+SazQZSpv7nWYS3ka7oNiAgmC9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/a8cf4e8a/attachment.pl>

From tom.gottfried at wzw.tum.de  Fri Feb 18 10:51:31 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Fri, 18 Feb 2011 10:51:31 +0100
Subject: [R-sig-Geo] Selecting a raster cell which contains a point of
 given	coordinates
In-Reply-To: <AANLkTinsdYVi3qZ-Xc+SazQZSpv7nWYS3ka7oNiAgmC9@mail.gmail.com>
References: <AANLkTinsdYVi3qZ-Xc+SazQZSpv7nWYS3ka7oNiAgmC9@mail.gmail.com>
Message-ID: <4D5E4123.4050907@wzw.tum.de>

Suppose you want to know the attribute values of the grid cell:
?over
?overlay

regards,
Tom

Am 18.02.2011 08:56, schrieb luca candeloro:
> Hi all,
> I have a raster file read by:
> Map=readGDAL(paste("C:/Temperature/HDF/TERRA/TIF/Terra.",datesMOD11A1[d],".LST_Day_1km.tif",sep=""))
> 
> and a point coordinates like:
> 
> Gattia=matrix(c(x=13.66966,y=42.63941), ncol=2)
> Gattia=project(Gattia,proj4string(Map))
> 
> I would like to know which is the cell in the Map that contains the
> coordinates of the point named Gattia.
> 
> Any help?
> 
> Thanks,
> Luca.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From carstennh at aol.com  Fri Feb 18 10:54:23 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 18 Feb 2011 10:54:23 +0100
Subject: [R-sig-Geo] Fix the color palette scale in a raster plot
In-Reply-To: <AANLkTinraFXbqR8iqz+Ye8gerowH9Jcce7t3cBDshRkw@mail.gmail.com>
References: <AANLkTinraFXbqR8iqz+Ye8gerowH9Jcce7t3cBDshRkw@mail.gmail.com>
Message-ID: <4D5E41CF.70405@aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/355b2007/attachment.pl>

From Armelle.Rouyer at ifremer.fr  Fri Feb 18 11:16:08 2011
From: Armelle.Rouyer at ifremer.fr (Armelle ROUYER)
Date: Fri, 18 Feb 2011 11:16:08 +0100
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
In-Reply-To: <alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>
References: <4D5CDE95.6080503@ifremer.fr>
	<alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>
Message-ID: <4D5E46E8.3030005@ifremer.fr>

Thanks for your answer Roger but it still doesn't work...
The problem is with mo, has you said it needs more study and I don't how 
to solve the problem.

Here is the problem :

library(PBSmapping)

PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
PD=read.table("pdata.txt",header=T) # text file attach

brks=c(fivenum(PD$Z))
cols=c("white","yellow","orange","red","darkred")
PD0=makeProps(PD,breaks=brks,"col",cols)

plotPolys(PS0, polyProps=as.PolyData(PD0), projection="LL",bg="lightblue")
sp1 <- PolySet2SpatialPolygons(PS0)
mo <- match(as.character(PD0$PID), row.names(sp1))
sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
   stringsAsFactors=FALSE))
plot(sp2, col=sp2$col, axes=TRUE)


Many thanks in advance if you find a solution.
And if it is not possible I will do the same using only the sp package...

Regards.
Armelle Rouyer



Roger Bivand a ?crit :
> On Thu, 17 Feb 2011, Armelle ROUYER wrote:
> 
>> Dear all,
>>
>> I used the PBSmapping package to make a grid with the abundance of 
>> fishes. Each cell has an allocated value. I want to convert this grid 
>> into a shapefile in order to export it on ArcGIS.
>>
>> So I tried the function "PolySet2SpatialPolygons". The grid is 
>> correctly transformed into polygons but the allocated value is 
>> ignored. Then I tried the function "SpatialPolygonsDataFrame" but it 
>> didn't work properly (only 13 values are associated with the 50 cells).
>>
>> I am not sure that I am using the right functions. So if you have any 
>> idea or suggestion thank you for your help.
> 
> library(PBSmapping)
> library(maptools)
> gt <- GridTopology(c(0.5, 0.5), c(1, 1), c(5, 10))
> sp <- as(gt, "SpatialPolygons")
> proj4string(sp) <- CRS("+proj=longlat")
> PS0 <- SpatialPolygons2PolySet(sp)
> PD0 <- as.PolyData(data.frame(PID=1:50, col=rep(rainbow(10), each=5),
>   stringsAsFactors=FALSE))
> plotPolys(PS0, polyProps=PD0, projection="LL")
> # the above to set up a PolySet opject, PolyData object, and plot them
> sp1 <- PolySet2SpatialPolygons(PS0)
> mo <- match(as.character(PD0$PID), row.names(sp1))
> # check mo - this is an easy match, in practice it may need more study
> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>   stringsAsFactors=FALSE))
> plot(sp2, col=sp2$col, axes=TRUE)
> 
> seems to work. You match on the PolyData PID column and the row.names() 
> of the SpatialPolygons object, which are the unique PolySet PID values. 
> In this case, and probably in general, the PIDs in the PolyData and 
> PolySet match by design. If there isn't an exact match, you'll need to 
> construct an object of the correct length manually.
> 
> Roger
> 
>>
>> Regards.
>>
>>
>>
> 

-- 
Armelle Rouyer

IFREMER - Station de Lorient
Laboratoire Biologie Halieutique
8 rue Francois Toullec
56100 LORIENT
FRANCE
02 97 87 38 23
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: pdata.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/2ef60d6c/attachment.txt>

From Roger.Bivand at nhh.no  Fri Feb 18 14:28:08 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Feb 2011 14:28:08 +0100 (CET)
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
In-Reply-To: <4D5E46E8.3030005@ifremer.fr>
References: <4D5CDE95.6080503@ifremer.fr>
	<alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>
	<4D5E46E8.3030005@ifremer.fr>
Message-ID: <alpine.LRH.2.00.1102181130240.4998@reclus.nhh.no>

On Fri, 18 Feb 2011, Armelle ROUYER wrote:

> Thanks for your answer Roger but it still doesn't work...
> The problem is with mo, has you said it needs more study and I don't how to 
> solve the problem.
>
> Here is the problem :
>
> library(PBSmapping)
>
> PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
> PD=read.table("pdata.txt",header=T) # text file attach
>
> brks=c(fivenum(PD$Z))
> cols=c("white","yellow","orange","red","darkred")
> PD0=makeProps(PD,breaks=brks,"col",cols)
>
> plotPolys(PS0, polyProps=as.PolyData(PD0), projection="LL",bg="lightblue")
> sp1 <- PolySet2SpatialPolygons(PS0)
> mo <- match(as.character(PD0$PID), row.names(sp1))
> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>  stringsAsFactors=FALSE))
> plot(sp2, col=sp2$col, axes=TRUE)
>
>
> Many thanks in advance if you find a solution.

The underlying problem is that makeGrid() understands PolySet objects in 
its own way, with the interaction of PID and SID being a top level 
identifier. In ?PolySet, it looks as though the PID is the top level 
identifier, and SIDs within a given PID are its component parts, not 
independent top-level objects. This is how PolySet2SpatialPolygons() sees 
things too, so the multiple SIDs in a single PID are treated as member 
component polygons of a multipolygon (Polygons) object. So we need to 
disambiguate:

library(PBSmapping)
PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
PS1 <- as.PolySet(data.frame(PID=as.integer((PS0$PID*100)+PS0$SID),
   SID=1L, POS=PS0$POS, X=PS0$X, Y=PS0$Y), projection="LL")
# Be careful to ensure uniqueness in the new PID!!
PD=read.table("pdata.txt",header=T)
# text file attach
PD1 <- data.frame(PID=as.integer((PD$PID*100)+PD$SID), Z=PD$Z)
# Be careful to ensure uniqueness in the new PID!!
brks=c(fivenum(PD$Z))
cols=c("white","yellow","orange","red","darkred")
PD0=makeProps(PD1,breaks=brks,"col",cols)
plotPolys(PS1, polyProps=as.PolyData(PD0), projection="LL",bg="lightblue")
library(maptools)
sp1 <- PolySet2SpatialPolygons(PS1)
mo <- match(as.character(PD0$PID), row.names(sp1))
Z <- rep(as.numeric(NA), length(row.names(sp1)))
Z[mo] <- PD0$Z
col <- rep(as.character(NA), length(row.names(sp1)))
col[mo] <- PD0$col
df <- data.frame(Z=Z, col=col, stringsAsFactors=FALSE,
   row.names=row.names(sp1))
sp2 <- SpatialPolygonsDataFrame(sp1, data=df)
sp3 <- sp2[!is.na(sp2$Z),]
plot(sp3, col=sp3$col, bg="lightblue", axes=TRUE)

> And if it is not possible I will do the same using only the sp package...

You are right that for this data set, representation as a 
SpatialPixelDataFrame object might be best.

Roger

>
> Regards.
> Armelle Rouyer
>
>
>
> Roger Bivand a ?crit :
>> On Thu, 17 Feb 2011, Armelle ROUYER wrote:
>> 
>>> Dear all,
>>> 
>>> I used the PBSmapping package to make a grid with the abundance of fishes. 
>>> Each cell has an allocated value. I want to convert this grid into a 
>>> shapefile in order to export it on ArcGIS.
>>> 
>>> So I tried the function "PolySet2SpatialPolygons". The grid is correctly 
>>> transformed into polygons but the allocated value is ignored. Then I tried 
>>> the function "SpatialPolygonsDataFrame" but it didn't work properly (only 
>>> 13 values are associated with the 50 cells).
>>> 
>>> I am not sure that I am using the right functions. So if you have any idea 
>>> or suggestion thank you for your help.
>> 
>> library(PBSmapping)
>> library(maptools)
>> gt <- GridTopology(c(0.5, 0.5), c(1, 1), c(5, 10))
>> sp <- as(gt, "SpatialPolygons")
>> proj4string(sp) <- CRS("+proj=longlat")
>> PS0 <- SpatialPolygons2PolySet(sp)
>> PD0 <- as.PolyData(data.frame(PID=1:50, col=rep(rainbow(10), each=5),
>>   stringsAsFactors=FALSE))
>> plotPolys(PS0, polyProps=PD0, projection="LL")
>> # the above to set up a PolySet opject, PolyData object, and plot them
>> sp1 <- PolySet2SpatialPolygons(PS0)
>> mo <- match(as.character(PD0$PID), row.names(sp1))
>> # check mo - this is an easy match, in practice it may need more study
>> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>>   stringsAsFactors=FALSE))
>> plot(sp2, col=sp2$col, axes=TRUE)
>> 
>> seems to work. You match on the PolyData PID column and the row.names() of 
>> the SpatialPolygons object, which are the unique PolySet PID values. In 
>> this case, and probably in general, the PIDs in the PolyData and PolySet 
>> match by design. If there isn't an exact match, you'll need to construct an 
>> object of the correct length manually.
>> 
>> Roger
>> 
>>> 
>>> Regards.
>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From nataliarodriguezsantos at gmail.com  Fri Feb 18 14:51:12 2011
From: nataliarodriguezsantos at gmail.com (Natalia Rodriguez Santos)
Date: Fri, 18 Feb 2011 08:51:12 -0500
Subject: [R-sig-Geo] Fix the color palette scale in a raster plot
In-Reply-To: <4D5E41CF.70405@aol.com>
References: <AANLkTinraFXbqR8iqz+Ye8gerowH9Jcce7t3cBDshRkw@mail.gmail.com>
	<4D5E41CF.70405@aol.com>
Message-ID: <AANLkTikpXXRWXeFrzZ=FTWS=2BPD6XHAMSferCAyadyG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/45923bae/attachment.pl>

From Armelle.Rouyer at ifremer.fr  Fri Feb 18 16:00:10 2011
From: Armelle.Rouyer at ifremer.fr (Armelle ROUYER)
Date: Fri, 18 Feb 2011 16:00:10 +0100
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
In-Reply-To: <alpine.LRH.2.00.1102181130240.4998@reclus.nhh.no>
References: <4D5CDE95.6080503@ifremer.fr>
	<alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>
	<4D5E46E8.3030005@ifremer.fr>
	<alpine.LRH.2.00.1102181130240.4998@reclus.nhh.no>
Message-ID: <4D5E897A.5090806@ifremer.fr>

Thank you very much for your help Roger, it really helps and explains me 
how the functions work and generate polygons.
Regards.
Armelle

Roger Bivand a ?crit :
> On Fri, 18 Feb 2011, Armelle ROUYER wrote:
> 
>> Thanks for your answer Roger but it still doesn't work...
>> The problem is with mo, has you said it needs more study and I don't 
>> how to solve the problem.
>>
>> Here is the problem :
>>
>> library(PBSmapping)
>>
>> PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
>> PD=read.table("pdata.txt",header=T) # text file attach
>>
>> brks=c(fivenum(PD$Z))
>> cols=c("white","yellow","orange","red","darkred")
>> PD0=makeProps(PD,breaks=brks,"col",cols)
>>
>> plotPolys(PS0, polyProps=as.PolyData(PD0), 
>> projection="LL",bg="lightblue")
>> sp1 <- PolySet2SpatialPolygons(PS0)
>> mo <- match(as.character(PD0$PID), row.names(sp1))
>> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>>  stringsAsFactors=FALSE))
>> plot(sp2, col=sp2$col, axes=TRUE)
>>
>>
>> Many thanks in advance if you find a solution.
> 
> The underlying problem is that makeGrid() understands PolySet objects in 
> its own way, with the interaction of PID and SID being a top level 
> identifier. In ?PolySet, it looks as though the PID is the top level 
> identifier, and SIDs within a given PID are its component parts, not 
> independent top-level objects. This is how PolySet2SpatialPolygons() 
> sees things too, so the multiple SIDs in a single PID are treated as 
> member component polygons of a multipolygon (Polygons) object. So we 
> need to disambiguate:
> 
> library(PBSmapping)
> PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
> PS1 <- as.PolySet(data.frame(PID=as.integer((PS0$PID*100)+PS0$SID),
>   SID=1L, POS=PS0$POS, X=PS0$X, Y=PS0$Y), projection="LL")
> # Be careful to ensure uniqueness in the new PID!!
> PD=read.table("pdata.txt",header=T)
> # text file attach
> PD1 <- data.frame(PID=as.integer((PD$PID*100)+PD$SID), Z=PD$Z)
> # Be careful to ensure uniqueness in the new PID!!
> brks=c(fivenum(PD$Z))
> cols=c("white","yellow","orange","red","darkred")
> PD0=makeProps(PD1,breaks=brks,"col",cols)
> plotPolys(PS1, polyProps=as.PolyData(PD0), projection="LL",bg="lightblue")
> library(maptools)
> sp1 <- PolySet2SpatialPolygons(PS1)
> mo <- match(as.character(PD0$PID), row.names(sp1))
> Z <- rep(as.numeric(NA), length(row.names(sp1)))
> Z[mo] <- PD0$Z
> col <- rep(as.character(NA), length(row.names(sp1)))
> col[mo] <- PD0$col
> df <- data.frame(Z=Z, col=col, stringsAsFactors=FALSE,
>   row.names=row.names(sp1))
> sp2 <- SpatialPolygonsDataFrame(sp1, data=df)
> sp3 <- sp2[!is.na(sp2$Z),]
> plot(sp3, col=sp3$col, bg="lightblue", axes=TRUE)
> 
>> And if it is not possible I will do the same using only the sp package...
> 
> You are right that for this data set, representation as a 
> SpatialPixelDataFrame object might be best.
> 
> Roger
> 
>>
>> Regards.
>> Armelle Rouyer
>>
>>
>>
>> Roger Bivand a ?crit :
>>> On Thu, 17 Feb 2011, Armelle ROUYER wrote:
>>>
>>>> Dear all,
>>>>
>>>> I used the PBSmapping package to make a grid with the abundance of 
>>>> fishes. Each cell has an allocated value. I want to convert this 
>>>> grid into a shapefile in order to export it on ArcGIS.
>>>>
>>>> So I tried the function "PolySet2SpatialPolygons". The grid is 
>>>> correctly transformed into polygons but the allocated value is 
>>>> ignored. Then I tried the function "SpatialPolygonsDataFrame" but it 
>>>> didn't work properly (only 13 values are associated with the 50 cells).
>>>>
>>>> I am not sure that I am using the right functions. So if you have 
>>>> any idea or suggestion thank you for your help.
>>>
>>> library(PBSmapping)
>>> library(maptools)
>>> gt <- GridTopology(c(0.5, 0.5), c(1, 1), c(5, 10))
>>> sp <- as(gt, "SpatialPolygons")
>>> proj4string(sp) <- CRS("+proj=longlat")
>>> PS0 <- SpatialPolygons2PolySet(sp)
>>> PD0 <- as.PolyData(data.frame(PID=1:50, col=rep(rainbow(10), each=5),
>>>   stringsAsFactors=FALSE))
>>> plotPolys(PS0, polyProps=PD0, projection="LL")
>>> # the above to set up a PolySet opject, PolyData object, and plot them
>>> sp1 <- PolySet2SpatialPolygons(PS0)
>>> mo <- match(as.character(PD0$PID), row.names(sp1))
>>> # check mo - this is an easy match, in practice it may need more study
>>> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>>>   stringsAsFactors=FALSE))
>>> plot(sp2, col=sp2$col, axes=TRUE)
>>>
>>> seems to work. You match on the PolyData PID column and the 
>>> row.names() of the SpatialPolygons object, which are the unique 
>>> PolySet PID values. In this case, and probably in general, the PIDs 
>>> in the PolyData and PolySet match by design. If there isn't an exact 
>>> match, you'll need to construct an object of the correct length 
>>> manually.
>>>
>>> Roger
>>>
>>>>
>>>> Regards.
>>>>
>>>>
>>>>
>>>
>>
>>
> 

-- 
Armelle Rouyer

IFREMER - Station de Lorient
Laboratoire Biologie Halieutique
8 rue Francois Toullec
56100 LORIENT
FRANCE
02 97 87 38 23


From a.mosnier at gmail.com  Fri Feb 18 16:51:05 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Fri, 18 Feb 2011 10:51:05 -0500
Subject: [R-sig-Geo] Variogram (nlme) of a lme object - corSpatial element
	question
Message-ID: <AANLkTinRL7iH0VHKFv2qrO6G7=D1c3W1vin0XgsUBYqq@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/478cac75/attachment.pl>

From a.mosnier at gmail.com  Fri Feb 18 17:13:38 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Fri, 18 Feb 2011 11:13:38 -0500
Subject: [R-sig-Geo] Bug in the function Variogram (package nlme) ?
Message-ID: <AANLkTi=7-syW-2iTK2hTCLfOqYfvvsv8NCyuo8uZYjU1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110218/0b015b0d/attachment.pl>

From r.hijmans at gmail.com  Fri Feb 18 18:29:44 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 18 Feb 2011 09:29:44 -0800
Subject: [R-sig-Geo] Selecting a raster cell which contains a point of
 given coordinates
In-Reply-To: <AANLkTinsdYVi3qZ-Xc+SazQZSpv7nWYS3ka7oNiAgmC9@mail.gmail.com>
References: <AANLkTinsdYVi3qZ-Xc+SazQZSpv7nWYS3ka7oNiAgmC9@mail.gmail.com>
Message-ID: <1298050184528-6040813.post@n2.nabble.com>


> Hi all, 
> I have a raster file read by: 
> Map=readGDAL(paste("C:/Temperature/HDF/TERRA/TIF/Terra.",datesMOD11A1[d],".LST_Day_1km.tif",sep="")) 
> 
> and a point coordinates like: 
> 
> Gattia=matrix(c(x=13.66966,y=42.63941), ncol=2) 
> Gattia=project(Gattia,proj4string(Map)) 
> 
> I would like to know which is the cell in the Map that contains the 
> coordinates of the point named Gattia. 

Luca, you can do:

library(raster)
r <- raster(Map)
cellFromXY(r, Gattia)


Robert

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Selecting-a-raster-cell-which-contains-a-point-of-given-coordinates-tp6039068p6040813.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Fri Feb 18 18:45:55 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 18 Feb 2011 09:45:55 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1297967809866-6037090.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
Message-ID: <1298051155156-6040866.post@n2.nabble.com>


> Im having trouble with the results from the ks package being reversed. 
> There must be a simple error that I am overlooking?  Does anybody see my
> problem

Perhaps I could have seen what you are overlooking if you had provided a
simple self-contained example. That should be very easy to make in this
case. It is not helpful to start an example script with 

curset <- curset[1:100,] 

This can be rather confusing as you never really know if the raster is
stored from top to bottom, and/or rotated. You could try if this works (I
believe it does):

library(raster)
r <- raster(ud_hpi)
plot(r)
r <- writeRaster(r, 'test.asc')

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6040866.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Fri Feb 18 20:01:20 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Fri, 18 Feb 2011 11:01:20 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298051155156-6040866.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
Message-ID: <1298055680383-6041112.post@n2.nabble.com>


Here is a self contained sample with a different set of points, same issues
though.  When I use your suggested routines for export, I get a slightly
different issue but one I was seeing before my original post.  I avoided
this issue by using the code from my original post create the raster
manually,  Somehow the raster is getting warped in x and y???  When I use
your routines they fail, saying that the cells unequal in horizontal and
vertical dimensions.

*****************************

library(ks)
library(raster)
curset <- read.delim("sample.csv", header = TRUE, sep = ",")

#Calculate hpi
Hpi1 <- Hpi(x = curset, pre="scale")
Hpi1

## Do the kde
ud_hpi <- kde(x = curset, H=Hpi1)

library(raster)
r <- raster(ud_hpi)
plot(r)
writeRaster(r, 'test_r.asc')

*****************************
upon writeRaster I get an error - 

"Error in .startAsciiWriting(raster, filename, ...) : 
  x has unequal horizontal and vertical resolutions. Such data cannot be
stored in arc-ascii format"

http://r-sig-geo.2731867.n2.nabble.com/file/n6041112/sample.csv sample.csv 
http://r-sig-geo.2731867.n2.nabble.com/file/n6041112/sample.r sample.r 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6041112.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Fri Feb 18 20:54:08 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Fri, 18 Feb 2011 11:54:08 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298055680383-6041112.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
Message-ID: <1298058848025-6041277.post@n2.nabble.com>


The more I think about it, I feel like something is going awry with the
coordinate system of the points I am using and the routines with respect to
scaling in hpi or kde.  I can see that the points in R are not where they
are supposed to be when I plot the UD  as such

plot(ud_hpi, drawpoints=TRUE, drawlabels=FALSE, col=3, lwd=3, cex=0.1)

If the plot points to the ArcGIS representation of the points it is wrong.

Those points are formatted in NAD83 Albers...

http://r-sig-geo.2731867.n2.nabble.com/file/n6041277/CoordinateCapture.jpg 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6041277.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Sat Feb 19 01:00:59 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 18 Feb 2011 16:00:59 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298055680383-6041112.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
Message-ID: <1298073659474-6041894.post@n2.nabble.com>


> Here is a self contained sample with a different set of points, same issues
though. 
>
> curset <- read.delim("sample.csv", header = TRUE, sep = ",") 

Thanks for trying, but this is not self-contained, as it refers to a file
that only you have. 


> When I use your routines they fail, saying that the cells unequal in
> horizontal and vertical dimensions. 

That is a limitation of the ascii format, you can write to a different
format. 


Here is a self contained example that *looks* OK to me. 

library(ks) 
library(raster) 
set.seed=1
curset <- cbind(rnorm(100), rnorm(100))
Hpi1 <- Hpi(x = curset, pre="scale") 
ud_hpi <- kde(x = curset, H=Hpi1) 
r <- raster(ud_hpi) 
plot(r) 
points(curset)
writeRaster(r, 'test_r.tif') 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6041894.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Sat Feb 19 01:14:36 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Fri, 18 Feb 2011 16:14:36 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298073659474-6041894.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
Message-ID: <1298074476665-6041928.post@n2.nabble.com>


"Thanks for trying, but this is not self-contained, as it refers to a file
that only you have. "

Im not sure what the problem is Robert, my previous post included both the
code file and my albers coordinates.  I will attach them again. Simulated
data doesn't really prove anything to me if you can't apply the results back
to the earth.

http://r-sig-geo.2731867.n2.nabble.com/file/n6041928/sample.csv sample.csv 

http://r-sig-geo.2731867.n2.nabble.com/file/n6041928/sample.r sample.r 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6041928.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Sat Feb 19 02:20:06 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Fri, 18 Feb 2011 17:20:06 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298074476665-6041928.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
Message-ID: <1298078406528-6042088.post@n2.nabble.com>


and here is the coord system for the points

http://r-sig-geo.2731867.n2.nabble.com/file/n6042088/albers.prj albers.prj 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6042088.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From cmuelligann at uni-muenster.de  Sat Feb 19 06:26:54 2011
From: cmuelligann at uni-muenster.de (=?ISO-8859-15?Q?Christoph_M=FClligann?=)
Date: Sat, 19 Feb 2011 00:26:54 -0500
Subject: [R-sig-Geo] combining different plot types
Message-ID: <4D5F549E.7090602@uni-muenster.de>

Hello list(),

I'd like to combine different kinds of plots. I know how to do that with 
print() for trellis objects and for ordinary plots with par() / 
layout(). However a combination of both object types (well, 
unfortunately ordinary plots appear to be not even objects) doesn't work 
with neither one of those functions. If one of you had a solution for 
this, that would save my day.

Best,

Christoph


From Greg.Snow at imail.org  Sat Feb 19 06:56:10 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Fri, 18 Feb 2011 22:56:10 -0700
Subject: [R-sig-Geo] combining different plot types
In-Reply-To: <4D5F549E.7090602@uni-muenster.de>
References: <4D5F549E.7090602@uni-muenster.de>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC63434E9778@LP-EXMBVS10.CO.IHC.COM>

You need the gridBase package (for combining grid and base graphics).

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Christoph M?lligann
> Sent: Friday, February 18, 2011 10:27 PM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] combining different plot types
> 
> Hello list(),
> 
> I'd like to combine different kinds of plots. I know how to do that
> with
> print() for trellis objects and for ordinary plots with par() /
> layout(). However a combination of both object types (well,
> unfortunately ordinary plots appear to be not even objects) doesn't
> work
> with neither one of those functions. If one of you had a solution for
> this, that would save my day.
> 
> Best,
> 
> Christoph
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From kevinummel at gmail.com  Sat Feb 19 17:33:11 2011
From: kevinummel at gmail.com (Kevin Ummel)
Date: Sat, 19 Feb 2011 10:33:11 -0600
Subject: [R-sig-Geo] Quickly add column to raster?
Message-ID: <77493438-7391-4BAF-8E2F-096291E2D639@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110219/5efbb208/attachment.pl>

From r.hijmans at gmail.com  Sat Feb 19 18:03:27 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Sat, 19 Feb 2011 09:03:27 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298074476665-6041928.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
Message-ID: <1298135007297-6043601.post@n2.nabble.com>


> Im not sure what the problem is Robert, my previous post included both the
code file
> and my albers coordinates.  I will attach them again. 

Got them now

> Simulated data doesn't really prove anything to me if you can't apply the
> results back to the earth. 
? really?

This seems to work fine. Run your script and do 
plot(r)
points(curset)

You can create a proj.4 string from the info in your .prj file and do
projection(r) <- 'valid proj.4 string'
Or write r to a file and set the projection in ArcGIS.

r <- writeRaster(r, 'file.tif')

you cannot use ascii because the cells are not square.

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6043601.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Sat Feb 19 19:45:01 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Sat, 19 Feb 2011 10:45:01 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298135007297-6043601.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
	<1298135007297-6043601.post@n2.nabble.com>
Message-ID: <1298141101198-6043831.post@n2.nabble.com>


Got it.  Thanks Robert.  What are good raster formats and R libraries for
dealing with non-square cells?  I guess im not used to working with them
much.

With respect to the UD values and subsequent GIS analysis - Lots of resource
utilization papers have been taking the hpi values from R and apply them in
Hawthorne Beyers 'Hawth's tool's' which writes to a square cell format. Is
this proper use of the hpi values from R?  How can I effectively get these
rasters back to square cells for comparitive home range analysis (VI, BA)
and resource selection with other 30 m data without altering the structure
and values of the UD?

Thanks for all your help.


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6043831.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Sat Feb 19 20:49:05 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Sat, 19 Feb 2011 11:49:05 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298141101198-6043831.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
	<1298135007297-6043601.post@n2.nabble.com>
	<1298141101198-6043831.post@n2.nabble.com>
Message-ID: <1298144945604-6044046.post@n2.nabble.com>


> What are good raster formats and R libraries for dealing with non-square
cells?

You can use geotiff, as in my example ("file.tif").

> Is this proper use of the hpi values from R? 

I do not know that

> How can I effectively get these rasters back to square cells 

I can see two ways to make the cells square. 

1) resampling the result
 
r2 = raster(r)
res(r2) = min(res(r))
r2 <- resample(r, r2, method='bilinear')


2) A better solution is to provide equally spaced evaluation points, using a
pre-defined square-cell grid (here re-using r2):

eval <- xyFromCell(r2, 1:ncell(r2))
ud_hpi <- kde(x = curset, H=Hpi1, eval.points=eval) 
r3 <- setValues(r2, ud_hpi$estimate)


Robert

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6044046.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Sat Feb 19 22:21:56 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Sat, 19 Feb 2011 13:21:56 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298144945604-6044046.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
	<1298135007297-6043601.post@n2.nabble.com>
	<1298141101198-6043831.post@n2.nabble.com>
	<1298144945604-6044046.post@n2.nabble.com>
Message-ID: <1298150516533-6044237.post@n2.nabble.com>


Thanks for all your help Robert - I appreciate it as Im sure you a busy man!

> Is this proper use of the hpi values from R? 

> I do not know that 

Ill check with the author of that tool as it seems his conversions most
logically would have been using your resampling suggestion in ArcObjects. 
Since I am looking at a number of methods for home range analysis including
brownian bridge, fixed kernels, and others.  I want to make sure that I am
comparing the resultant surfaces correctly.

>1) resampling the result 
 
This seems less than optimal, but as long as the values were rescaled to a
true pdf it seems that it could work fine.

2) A better solution is to provide equally spaced evaluation points, using a
pre-defined square-cell grid 

I do have concern that while all three rasters (r, r2, and r3) show the same
spatial pattern, the values of the sum of the surface are different.  I
guess the key here is rescaling by the sum of the cell values so that they
sum to 1 (a true pdf) and then I can create a volume surface.

 ## Get the volume
udvol_hpi <- getvolumeUD(r)

It looks like I will have to work on getting these rasters into class
"khrud" or "kbbhrud".  Ill do some research on that and if I figure it out I
will post.  All these different software packages (within R and outside R)
can make home range comparison tricky.  Adehabitat goes a long ways to bring
everything together.
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6044237.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From andrewaduff at gmail.com  Sat Feb 19 23:00:17 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Sat, 19 Feb 2011 14:00:17 -0800
Subject: [R-sig-Geo] kde output from ks reversed
In-Reply-To: <1298150516533-6044237.post@n2.nabble.com>
References: <1297967809866-6037090.post@n2.nabble.com>
	<1298051155156-6040866.post@n2.nabble.com>
	<1298055680383-6041112.post@n2.nabble.com>
	<1298073659474-6041894.post@n2.nabble.com>
	<1298074476665-6041928.post@n2.nabble.com>
	<1298135007297-6043601.post@n2.nabble.com>
	<1298141101198-6043831.post@n2.nabble.com>
	<1298144945604-6044046.post@n2.nabble.com>
	<1298150516533-6044237.post@n2.nabble.com>
Message-ID: <1298152817157-6044314.post@n2.nabble.com>


raster library functions seem to fail on 64 bit R
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kde-output-from-ks-reversed-tp6037090p6044314.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From risemary48 at yahoo.com  Sun Feb 20 14:37:24 2011
From: risemary48 at yahoo.com (Mary Rise)
Date: Sun, 20 Feb 2011 05:37:24 -0800 (PST)
Subject: [R-sig-Geo] spatialgridataframes
Message-ID: <393069.69515.qm@web120819.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110220/dd265958/attachment.ksh>

From nkkroy3 at gmail.com  Sun Feb 20 14:57:05 2011
From: nkkroy3 at gmail.com (Nikki roy)
Date: Sun, 20 Feb 2011 14:57:05 +0100
Subject: [R-sig-Geo] comparison (1) is possible only for atomic and list
Message-ID: <AANLkTikoiKJrJi8eC5uJqNyUVr7LyU0LrG8p4Mhtama5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110220/b70bb536/attachment.asc>

From lestes at princeton.edu  Sun Feb 20 17:44:54 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Sun, 20 Feb 2011 11:44:54 -0500
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
Message-ID: <AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>

Hi Mary,

This might help answer your questions. I used the meuse dataset and
converted to raster formats, but I think the general approach should
work for what you want to do.

library(raster)
library(gstat)
data(meuse.grid)
coordinates(meuse.grid) = ~x+y
gridded(meuse.grid) = TRUE
class(meuse.grid)
m2 <- as(meuse.grid, "SpatialGridDataFrame")
m3 <- raster(m2, layer = "soil")  # Convert soil classes to raster

>
> Question1.
> How can i remove the ninth class in R because it does not have to be included in
> geostatical analysis.

m4 <- m3 * ((m3 < 3) / (m3 < 3))  # Removes class 3 from soil,
converts it to NA values (this could also
# serve as a mask)

# If you want to keep that part of the grid in the analysis, then you
might want to collapse the one class
# into another
m5 <- (m3 == 3 | m3 == 2) * 2 + (m3 == 1)  # Class 2 now includes 2 and 3

> Question 2
> how can i use the map created in Q1 to clip the other 5? aboventioned?maps (eg
> DEM etc)?or how can i create a mask from the map in Q1.
>


# Create a mask for just the area of soil class 1
sc1.mask <- (m3 == 1) / (m3 == 1)

# You then multiply your other rasters by your mask to reduce rasters
to the areas you want to analyze.

Cheers, Lyndon


From mudrak at iastate.edu  Sun Feb 20 19:12:56 2011
From: mudrak at iastate.edu (Mudrak, Erika [EEOBS])
Date: Sun, 20 Feb 2011 12:12:56 -0600
Subject: [R-sig-Geo] spatstat: confusion about Kcross.inhom
Message-ID: <1E7ADA3325202A43BC5B52A5A9A843EF0A2B74AB26@EXITS713.its.iastate.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110220/087084aa/attachment.pl>

From rahulosho at gmail.com  Sun Feb 20 21:45:51 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Mon, 21 Feb 2011 02:15:51 +0530
Subject: [R-sig-Geo] Help on slow processing of extract fuction
Message-ID: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/a1aa38cf/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Feb 20 21:50:33 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 20 Feb 2011 21:50:33 +0100
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
Message-ID: <4D617E99.4040001@uni-muenster.de>

Lyndon, the original question was about removing a particular level in a
factor variable. The answer you gave seems to work for numeric variables
only (funny enough, soil in meuse.grid is a numeric variable!), and
package raster doesn't seem to deal well with factors (although coercion
to raster does not complain). Building on your example:

meuse.grid$soilf = factor(meuse.grid$soil, labels=c("cl1","cl2","cl3"))
m2 <- as(meuse.grid, "SpatialGridDataFrame")
m3 <- raster(m2, layer = "soilf")  # Convert soilf factor to raster
plot(m3)

It seems that here, the factor levels are lost, as well as the knowledge
that this was a factor, at least it is lost when converted back to a
SpatialGridDataFrame.

Function factor can be used to change factors, or factor levels, or
remove some, as in:

meuse.grid$soilf2 = factor(meuse.grid$soilf,
levels=levels(meuse.grid$soilf)[1:2])

Working with factors converted to numeric values in linear regression
models typically leads to plain wrong results.

On 02/20/2011 05:44 PM, Lyndon Estes wrote:
> Hi Mary,
> 
> This might help answer your questions. I used the meuse dataset and
> converted to raster formats, but I think the general approach should
> work for what you want to do.
> 
> library(raster)
> library(gstat)
> data(meuse.grid)
> coordinates(meuse.grid) = ~x+y
> gridded(meuse.grid) = TRUE
> class(meuse.grid)
> m2 <- as(meuse.grid, "SpatialGridDataFrame")
> m3 <- raster(m2, layer = "soil")  # Convert soil classes to raster
> 
>>
>> Question1.
>> How can i remove the ninth class in R because it does not have to be included in
>> geostatical analysis.
> 
> m4 <- m3 * ((m3 < 3) / (m3 < 3))  # Removes class 3 from soil,
> converts it to NA values (this could also
> # serve as a mask)
> 
> # If you want to keep that part of the grid in the analysis, then you
> might want to collapse the one class
> # into another
> m5 <- (m3 == 3 | m3 == 2) * 2 + (m3 == 1)  # Class 2 now includes 2 and 3
> 
>> Question 2
>> how can i use the map created in Q1 to clip the other 5  aboventioned maps (eg
>> DEM etc) or how can i create a mask from the map in Q1.
>>
> 
> 
> # Create a mask for just the area of soil class 1
> sc1.mask <- (m3 == 1) / (m3 == 1)
> 
> # You then multiply your other rasters by your mask to reduce rasters
> to the areas you want to analyze.
> 
> Cheers, Lyndon
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Sun Feb 20 22:48:15 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 20 Feb 2011 22:48:15 +0100 (CET)
Subject: [R-sig-Geo] Help on slow processing of extract fuction
In-Reply-To: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>
References: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1102202228030.18316@reclus.nhh.no>

On Mon, 21 Feb 2011, Rahul Raj wrote:

> Dear All,
>
> I am using the "extract" command to extract the fraction of each class in
> the raster cells, falling in each grid of shape file of polygon type.
>> extract(r,v) ### where 'v' is my polygon grid of 1 km resolution and 'r'
> is my classified raster image.
>
> My polygon grid has more than 2 million polygons and I am running the
> command in 64 bit window xp operating system having quard 4 processor and 8
> GB RAM. But the extract function is taking a long time (more than 2 days) to
> generate results.
> please help me how can I speed up the processing time. Is there any other
> packages in R that can provide the fast processing for this type of
> extraction.
>
> Also, how can I read one polygon at a time in R from the polygon shape file
> stored in disk.

Please, do try to think carefully before beginning work. What are you 
actually doing? Are your polygon objects really irregular multipolygons, 
or are they rectangles? Do they overlap? If I recall, you are looping over 
the polygons - did you time a single polygon and say 100 polygons taken 
together? You are trying to use R/raster/sp for tasks that are very 
different from those they were designed for, in a very demanding way 
(loops are known to be inferior to vectorisation in R).

So you run extract() on your whole raster for each polygon, which 
internally crops your raster to the polygon, rasterises it, turns it into 
points, and extracts the values at those rasterised points from the 
raster. In large scale applications like yours, almost certainly one 
should use different data and process models.

Doing this 2 million times is not efficient, as you are experiencing. I 
don't know why you thought it would be. How to make it more efficient will 
depend on your data structures, and possibly on coding in R, or R and C. 
extract() will work perfectly well on your raster with say 500 polygons, 
but does not seem to have been written for very many polygons.

Roger

>
> Thanks in advance for the valuable suggestions.
>
> With regards
> Rahul Raj
> Indian Institute of Remote Sensing, india.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Sun Feb 20 23:00:36 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 20 Feb 2011 23:00:36 +0100
Subject: [R-sig-Geo] convert a PBSmapping grid to shapefile
In-Reply-To: <4D5E897A.5090806@ifremer.fr>
References: <4D5CDE95.6080503@ifremer.fr>	<alpine.LRH.2.00.1102171605120.1417@reclus.nhh.no>	<4D5E46E8.3030005@ifremer.fr>	<alpine.LRH.2.00.1102181130240.4998@reclus.nhh.no>
	<4D5E897A.5090806@ifremer.fr>
Message-ID: <4D618F04.9060601@uni-muenster.de>

An example using SpatialPixelsDataFrame, as suggested by Roger, is given
below. It does not work with the current sp 0.9-76 due to a small bug
introduced there, but does work again in 0.9-77 which I just submitted
to CRAN, and might work with older versions.

require(sp)
PD=read.table("pdata.txt",header=T)
x=seq(-5,-1,.2)
y=seq(43,49,.2)
PD$x = x[PD[[1]]]
PD$y = y[PD[[2]]]
coordinates(PD)=~x+y
proj4string(PD)="+proj=longlat +datum=WGS84"
gridded(PD)=TRUE
fullgrid(PD)=TRUE
spplot(PD["Z"], scales = list(draw=TRUE), at = fivenum(PD$Z))

Alternatively you could use image() for plotting. Getting the colors of
the example below is an issue that I didn't look into.

On 02/18/2011 04:00 PM, Armelle ROUYER wrote:
> Thank you very much for your help Roger, it really helps and explains me
> how the functions work and generate polygons.
> Regards.
> Armelle
> 
> Roger Bivand a ?crit :
>> On Fri, 18 Feb 2011, Armelle ROUYER wrote:
>>
>>> Thanks for your answer Roger but it still doesn't work...
>>> The problem is with mo, has you said it needs more study and I don't
>>> how to solve the problem.
>>>
>>> Here is the problem :
>>>
>>> library(PBSmapping)
>>>
>>> PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
>>> PD=read.table("pdata.txt",header=T) # text file attach
>>>
>>> brks=c(fivenum(PD$Z))
>>> cols=c("white","yellow","orange","red","darkred")
>>> PD0=makeProps(PD,breaks=brks,"col",cols)
>>>
>>> plotPolys(PS0, polyProps=as.PolyData(PD0),
>>> projection="LL",bg="lightblue")
>>> sp1 <- PolySet2SpatialPolygons(PS0)
>>> mo <- match(as.character(PD0$PID), row.names(sp1))
>>> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>>>  stringsAsFactors=FALSE))
>>> plot(sp2, col=sp2$col, axes=TRUE)
>>>
>>>
>>> Many thanks in advance if you find a solution.
>>
>> The underlying problem is that makeGrid() understands PolySet objects
>> in its own way, with the interaction of PID and SID being a top level
>> identifier. In ?PolySet, it looks as though the PID is the top level
>> identifier, and SIDs within a given PID are its component parts, not
>> independent top-level objects. This is how PolySet2SpatialPolygons()
>> sees things too, so the multiple SIDs in a single PID are treated as
>> member component polygons of a multipolygon (Polygons) object. So we
>> need to disambiguate:
>>
>> library(PBSmapping)
>> PS0=makeGrid(x=seq(-5,-1,.2),y=seq(43,49,.2),projection="LL")
>> PS1 <- as.PolySet(data.frame(PID=as.integer((PS0$PID*100)+PS0$SID),
>>   SID=1L, POS=PS0$POS, X=PS0$X, Y=PS0$Y), projection="LL")
>> # Be careful to ensure uniqueness in the new PID!!
>> PD=read.table("pdata.txt",header=T)
>> # text file attach
>> PD1 <- data.frame(PID=as.integer((PD$PID*100)+PD$SID), Z=PD$Z)
>> # Be careful to ensure uniqueness in the new PID!!
>> brks=c(fivenum(PD$Z))
>> cols=c("white","yellow","orange","red","darkred")
>> PD0=makeProps(PD1,breaks=brks,"col",cols)
>> plotPolys(PS1, polyProps=as.PolyData(PD0),
>> projection="LL",bg="lightblue")
>> library(maptools)
>> sp1 <- PolySet2SpatialPolygons(PS1)
>> mo <- match(as.character(PD0$PID), row.names(sp1))
>> Z <- rep(as.numeric(NA), length(row.names(sp1)))
>> Z[mo] <- PD0$Z
>> col <- rep(as.character(NA), length(row.names(sp1)))
>> col[mo] <- PD0$col
>> df <- data.frame(Z=Z, col=col, stringsAsFactors=FALSE,
>>   row.names=row.names(sp1))
>> sp2 <- SpatialPolygonsDataFrame(sp1, data=df)
>> sp3 <- sp2[!is.na(sp2$Z),]
>> plot(sp3, col=sp3$col, bg="lightblue", axes=TRUE)
>>
>>> And if it is not possible I will do the same using only the sp
>>> package...
>>
>> You are right that for this data set, representation as a
>> SpatialPixelDataFrame object might be best.
>>
>> Roger
>>
>>>
>>> Regards.
>>> Armelle Rouyer
>>>
>>>
>>>
>>> Roger Bivand a ?crit :
>>>> On Thu, 17 Feb 2011, Armelle ROUYER wrote:
>>>>
>>>>> Dear all,
>>>>>
>>>>> I used the PBSmapping package to make a grid with the abundance of
>>>>> fishes. Each cell has an allocated value. I want to convert this
>>>>> grid into a shapefile in order to export it on ArcGIS.
>>>>>
>>>>> So I tried the function "PolySet2SpatialPolygons". The grid is
>>>>> correctly transformed into polygons but the allocated value is
>>>>> ignored. Then I tried the function "SpatialPolygonsDataFrame" but
>>>>> it didn't work properly (only 13 values are associated with the 50
>>>>> cells).
>>>>>
>>>>> I am not sure that I am using the right functions. So if you have
>>>>> any idea or suggestion thank you for your help.
>>>>
>>>> library(PBSmapping)
>>>> library(maptools)
>>>> gt <- GridTopology(c(0.5, 0.5), c(1, 1), c(5, 10))
>>>> sp <- as(gt, "SpatialPolygons")
>>>> proj4string(sp) <- CRS("+proj=longlat")
>>>> PS0 <- SpatialPolygons2PolySet(sp)
>>>> PD0 <- as.PolyData(data.frame(PID=1:50, col=rep(rainbow(10), each=5),
>>>>   stringsAsFactors=FALSE))
>>>> plotPolys(PS0, polyProps=PD0, projection="LL")
>>>> # the above to set up a PolySet opject, PolyData object, and plot them
>>>> sp1 <- PolySet2SpatialPolygons(PS0)
>>>> mo <- match(as.character(PD0$PID), row.names(sp1))
>>>> # check mo - this is an easy match, in practice it may need more study
>>>> sp2 <- SpatialPolygonsDataFrame(sp1, data=data.frame(col=PD0$col[mo],
>>>>   stringsAsFactors=FALSE))
>>>> plot(sp2, col=sp2$col, axes=TRUE)
>>>>
>>>> seems to work. You match on the PolyData PID column and the
>>>> row.names() of the SpatialPolygons object, which are the unique
>>>> PolySet PID values. In this case, and probably in general, the PIDs
>>>> in the PolyData and PolySet match by design. If there isn't an exact
>>>> match, you'll need to construct an object of the correct length
>>>> manually.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> Regards.
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at wzw.tum.de  Sun Feb 20 23:20:51 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Sun, 20 Feb 2011 23:20:51 +0100
Subject: [R-sig-Geo] comparison (1) is possible only for atomic and list
In-Reply-To: <AANLkTikoiKJrJi8eC5uJqNyUVr7LyU0LrG8p4Mhtama5@mail.gmail.com>
References: <AANLkTikoiKJrJi8eC5uJqNyUVr7LyU0LrG8p4Mhtama5@mail.gmail.com>
Message-ID: <4D6193C3.4000903@wzw.tum.de>

Hi Nikki,

I'm myself not an expert in dealing with factors, so my approach would 
be to coerce the factor-column to character with

yourgrid$factor_column <- as.character(yourgrid$factor_column)

then perform the substitutions as in the meuse.grid example and coerce 
back to factor if needed with

yourgrid$factor_column <- factor(yourgrid$factor_column)

Maybe somebody else on the list has a cleaner/more efficient way do deal 
with this?

regards,
Tom


Am 20.02.2011 14:57, schrieb Nikki roy:
> Hi Tom,
>
> What you said here works for numbers datatype but  my data type is factor
> (levels). i am still very new to R. Please help.
>
> library(sp)
> data(meuse.grid)# "data.frame"
> coordinates(meuse.grid)<- ~x+y
> meuse.grid<- as(as(meuse.grid,
> "SpatialPixelsDataFrame"),"SpatialGridDataFrame")#"SpatialGridDataFrame"
> spplot(meuse.grid[,,"soil"])
> meuse.grid$soil[meuse.grid$soil==1]<- NA
> meuse.grid$soil[meuse.grid$soil==2 | meuse.grid$soil==3]<- 5
> spplot(meuse.grid[,,"soil"])
> summary(meuse.grid$soil)
>
> Regards,
>
> Nikki
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ldecola at comcast.net  Mon Feb 21 01:27:41 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Mon, 21 Feb 2011 00:27:41 +0000 (UTC)
Subject: [R-sig-Geo] combining different plot types
In-Reply-To: <4D5F549E.7090602@uni-muenster.de>
Message-ID: <550076222.1112607.1298248061665.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/b616364a/attachment.pl>

From leonardo.monasterio at gmail.com  Mon Feb 21 02:46:25 2011
From: leonardo.monasterio at gmail.com (Leonardo Monasterio)
Date: Sun, 20 Feb 2011 22:46:25 -0300
Subject: [R-sig-Geo] indentify the polygons that are located on the edge of
	a map
Message-ID: <AANLkTikxJmCvabRNaj1cgbTBXd9hLWj0ZtQqh6TOw4k+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110220/5f16f708/attachment.pl>

From rahulosho at gmail.com  Mon Feb 21 06:03:37 2011
From: rahulosho at gmail.com (Rahul Raj)
Date: Mon, 21 Feb 2011 10:33:37 +0530
Subject: [R-sig-Geo] Help on slow processing of extract fuction
In-Reply-To: <alpine.LRH.2.00.1102202228030.18316@reclus.nhh.no>
References: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>
	<alpine.LRH.2.00.1102202228030.18316@reclus.nhh.no>
Message-ID: <AANLkTi=M5XVkhoJRaENjdQ1Lx1fyR=C7cLWeZLj3QiB0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/a8fa6bb9/attachment.pl>

From Roger.Bivand at nhh.no  Mon Feb 21 10:50:34 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 21 Feb 2011 10:50:34 +0100 (CET)
Subject: [R-sig-Geo] Help on slow processing of extract fuction
In-Reply-To: <AANLkTi=M5XVkhoJRaENjdQ1Lx1fyR=C7cLWeZLj3QiB0@mail.gmail.com>
References: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>
	<alpine.LRH.2.00.1102202228030.18316@reclus.nhh.no>
	<AANLkTi=M5XVkhoJRaENjdQ1Lx1fyR=C7cLWeZLj3QiB0@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1102211022020.20843@reclus.nhh.no>

On Mon, 21 Feb 2011, Rahul Raj wrote:

> On Mon, Feb 21, 2011 at 3:18 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Mon, 21 Feb 2011, Rahul Raj wrote:
>>
>>  Dear All,
>>>
>>> I am using the "extract" command to extract the fraction of each class in
>>> the raster cells, falling in each grid of shape file of polygon type.
>>>
>>>> extract(r,v) ### where 'v' is my polygon grid of 1 km resolution and 'r'
>>>>
>>> is my classified raster image.
>>>
>>> My polygon grid has more than 2 million polygons and I am running the
>>> command in 64 bit window xp operating system having quard 4 processor and
>>> 8
>>> GB RAM. But the extract function is taking a long time (more than 2 days)
>>> to
>>> generate results.
>>> please help me how can I speed up the processing time. Is there any other
>>> packages in R that can provide the fast processing for this type of
>>> extraction.
>>>
>>> Also, how can I read one polygon at a time in R from the polygon shape
>>> file
>>> stored in disk.
>>>
>>
>> Please, do try to think carefully before beginning work. What are you
>> actually doing? Are your polygon objects really irregular multipolygons, or
>> are they rectangles? Do they overlap? If I recall, you are looping over the
>> polygons - did you time a single polygon and say 100 polygons taken
>> together? You are trying to use R/raster/sp for tasks that are very
>> different from those they were designed for, in a very demanding way (loops
>> are known to be inferior to vectorisation in R).
>>
>> So you run extract() on your whole raster for each polygon, which
>> internally crops your raster to the polygon, rasterises it, turns it into
>> points, and extracts the values at those rasterised points from the raster.
>> In large scale applications like yours, almost certainly one should use
>> different data and process models.
>>
>> Doing this 2 million times is not efficient, as you are experiencing. I
>> don't know why you thought it would be. How to make it more efficient will
>> depend on your data structures, and possibly on coding in R, or R and C.
>> extract() will work perfectly well on your raster with say 500 polygons, but
>> does not seem to have been written for very many polygons.
>>
>> Roger
>>
>>
>>> Thanks in advance for the valuable suggestions.
>>>
>>> With regards
>>> Rahul Raj
>>> Indian Institute of Remote Sensing, india.
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> Dear Roger
>
> I have a classified image of whole India (India measures 3,214 km (1,997 mi)
> from north to south and 2,993 km (1,860 mi) from east to west) at 56m
> resolution. I have generate a square grid  of type polygon (area of each
> square polygon in grid is 1sq km) that covers whole India. Now I have to
> extract the fraction of crop classes from classified image for each square
> polygon in the grid.

My immediate impression is that you are going to have to loop anyway, but 
that you can avoid all the cropping by using the lower-level functions in 
rgdal. The function GDAL.open() opens a handle to a dataset - you must 
close the dataset with GDAL.close() when done. Then use the offset=c(yrow, 
xrow) in the getRasterTable() function to step over the dataset in 
appropriate chunks. Train first using a part of the map you know well to 
be sure what is going on. Then just loop over your offset, and aggregate 
on the values returned by getRasterTable(), which are the cell coordinates 
and the land cover value of interest.

This is using the fact that your polygons are rectangles, so can be 
emulated by setting for example region.dim=c(20, 20), and iterating over 
offset. You can tag your output data with the centroid of the 400 cells 
retrieved each time. This gives you access to all the land cover classes 
in each 1km square. Because 20 x 56m is 1120m, you may want to choose say 
18 by 18 for region.dim=, which is 1008 by 1008.

You might also decimate your input grid with output.dim= to let you train 
on a smaller data set that is easier to visualise.

For the global landcover dataset:

> library(rgdal)
> dataset <- GDAL.open("GLOBCOVER_L4_200901_200912_V2.3.tif")
> dim(dataset)
[1]  55800 129600
> displayDataset(dataset, band = 1, output.dim=c(180, 360))

shows me the whole dataset, and:

> displayDataset(dataset, band = 1, offset=c(1000, 2000), 
+ region.dim=c(20000, 40000), output.dim=c(180, 360))

northern North America. This data set is otherwise too large to handle, 
but getRasterTable() and getRasterData() - which returns just the data as 
a matrix - are pretty fast.

Remember to do GDAL.close(dataset) when done.

Hope this helps,

Roger

PS. library(fortunes); fortune("Yoda")


>
> For this purpose I thought to use the extract command. As the computer
> memory can not handle the such a large grid, therefore I divided my grid
> according to the state of India (India has 28 states) .I have used the clip
> operation of ARC GIS to clip the state wise grid (from my large grid) using
> vector boundary of state. At the boundary of state grid (still have 0.1 to 2
> million polygons) , I am losing the square shape of polygon.
> I have used rgdal package to import this subset grid (state wise). I am
> running the 'extract' command in loop so that the extraction of class
> fraction (from classified map) runs on one polygon at a time in each loop (I
> did it to avoid the out of memory problem of computer).
>
> I knew by reading your mail that my approach is not appropriate.
> I am also getting problems like " Error in gc(): caught access violation -
> continue with care", when the looping on  extract function starts.
>
> I am a beginner in R programming and I have joined R sig geo just before few
> days. Please help me to short out my problem in handling large grid in R.
>
> Please let me know if still you have doubt in understanding my data.
>
> With regards
> Rahul Raj
> Indian Institute of Remote Sensing, India.
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From p.hiemstra at geo.uu.nl  Mon Feb 21 14:48:37 2011
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 21 Feb 2011 14:48:37 +0100
Subject: [R-sig-Geo] bayesian kriging
In-Reply-To: <C4E200AD50B24014A84136561E19E59C@TM1>
References: <C4E200AD50B24014A84136561E19E59C@TM1>
Message-ID: <4D626D35.6040406@geo.uu.nl>

On 02/07/2011 04:55 PM, TM wrote:
> Hi all,
>
> I' m searching some R codes to do a bayesian kriging and cokriging (examples). Please could you help me?
>
> Thanks
>
> Toni
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>    
Hi TM,

See the geoR package.

Paul

-- 
Paul Hiemstra, MSc
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770

currently @ KNMI
paul.hiemstra_AT_knmi.nl


From p.hiemstra at geo.uu.nl  Mon Feb 21 14:55:54 2011
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 21 Feb 2011 14:55:54 +0100
Subject: [R-sig-Geo] Function to smooth grids using n x n window moving
 average (low-pass filter)
In-Reply-To: <1295456206912-5940465.post@n2.nabble.com>
References: <485F9E02.8050403@geo.uu.nl>
	<1295456206912-5940465.post@n2.nabble.com>
Message-ID: <4D626EEA.6030500@geo.uu.nl>

On 01/19/2011 05:56 PM, piero campa wrote:
> Very quick method Paul,
> I tried on my own by simple pixel by pixel computing and the result is much
> slower.
> Good work.
>
> Anyway I was trying to understand how to yield a small modification to your
> code:
> having a SpatiaGridDataFrame with NA holes, I noticed that the borderline
> pixels turn to NA too (and that's because x + NA = NA in R by default),
> letting theholes grow proportionally to the kernel size (just like the
> border pixels in a fullgrid data frame).
>
> I was trying to do add the ability to ignore NAs (just like it's in the sum
> method with na.rm = TRUE).
> I can't find the way however.
>
> Thank for any suggestion !
> Cheers,
> Piero
>    
Hi Piero,

It can probably be done relatively fast, but I would try and use the 
functions Robert Hijmans suggested. They are much more generic than my 
approach and probably just as fast, or even faster.

cheers,
Paul

-- 
Paul Hiemstra, MSc
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770

currently @ KNMI
paul.hiemstra_AT_knmi.nl


From lestes at princeton.edu  Mon Feb 21 15:28:37 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Mon, 21 Feb 2011 09:28:37 -0500
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <4D617E99.4040001@uni-muenster.de>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
	<4D617E99.4040001@uni-muenster.de>
Message-ID: <AANLkTimALCtOnysUx2Suoy4U2vVxU5BmQ-fGSRS6DfTa@mail.gmail.com>

Hi Edzer,

Thanks for the clarification regarding factors.

Cheers, Lyndon

On Sun, Feb 20, 2011 at 3:50 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Lyndon, the original question was about removing a particular level in a
> factor variable. The answer you gave seems to work for numeric variables
> only (funny enough, soil in meuse.grid is a numeric variable!), and
> package raster doesn't seem to deal well with factors (although coercion
> to raster does not complain). Building on your example:
>
> meuse.grid$soilf = factor(meuse.grid$soil, labels=c("cl1","cl2","cl3"))
> m2 <- as(meuse.grid, "SpatialGridDataFrame")
> m3 <- raster(m2, layer = "soilf") ?# Convert soilf factor to raster
> plot(m3)
>
> It seems that here, the factor levels are lost, as well as the knowledge
> that this was a factor, at least it is lost when converted back to a
> SpatialGridDataFrame.
>
> Function factor can be used to change factors, or factor levels, or
> remove some, as in:
>
> meuse.grid$soilf2 = factor(meuse.grid$soilf,
> levels=levels(meuse.grid$soilf)[1:2])
>
> Working with factors converted to numeric values in linear regression
> models typically leads to plain wrong results.
>
> On 02/20/2011 05:44 PM, Lyndon Estes wrote:
>> Hi Mary,
>>
>> This might help answer your questions. I used the meuse dataset and
>> converted to raster formats, but I think the general approach should
>> work for what you want to do.
>>
>> library(raster)
>> library(gstat)
>> data(meuse.grid)
>> coordinates(meuse.grid) = ~x+y
>> gridded(meuse.grid) = TRUE
>> class(meuse.grid)
>> m2 <- as(meuse.grid, "SpatialGridDataFrame")
>> m3 <- raster(m2, layer = "soil") ?# Convert soil classes to raster
>>
>>>
>>> Question1.
>>> How can i remove the ninth class in R because it does not have to be included in
>>> geostatical analysis.
>>
>> m4 <- m3 * ((m3 < 3) / (m3 < 3)) ?# Removes class 3 from soil,
>> converts it to NA values (this could also
>> # serve as a mask)
>>
>> # If you want to keep that part of the grid in the analysis, then you
>> might want to collapse the one class
>> # into another
>> m5 <- (m3 == 3 | m3 == 2) * 2 + (m3 == 1) ?# Class 2 now includes 2 and 3
>>
>>> Question 2
>>> how can i use the map created in Q1 to clip the other 5 ?aboventioned maps (eg
>>> DEM etc) or how can i create a mask from the map in Q1.
>>>
>>
>>
>> # Create a mask for just the area of soil class 1
>> sc1.mask <- (m3 == 1) / (m3 == 1)
>>
>> # You then multiply your other rasters by your mask to reduce rasters
>> to the areas you want to analyze.
>>
>> Cheers, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 ?http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics ? ? ?e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From marcelino.delacruz at upm.es  Mon Feb 21 16:49:09 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 21 Feb 2011 16:49:09 +0100
Subject: [R-sig-Geo] spatstat: confusion about Kcross.inhom
In-Reply-To: <1E7ADA3325202A43BC5B52A5A9A843EF0A2B74AB26@EXITS713.its.ia
	state.edu>
References: <1E7ADA3325202A43BC5B52A5A9A843EF0A2B74AB26@EXITS713.its.iastate.edu>
Message-ID: <201102211549.p1LFnBPf005406@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/fec454f1/attachment.pl>

From a.mosnier at gmail.com  Mon Feb 21 17:05:43 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 21 Feb 2011 11:05:43 -0500
Subject: [R-sig-Geo] Need help understanding the spatial correlation
	structure applied in lme
Message-ID: <AANLkTi=fF-Z3Hn64SfqrJUkCMudCRbn72kdt8ZUX844_@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/13a04a6c/attachment.pl>

From jaimebg27 at gmail.com  Mon Feb 21 17:29:58 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Mon, 21 Feb 2011 11:29:58 -0500
Subject: [R-sig-Geo] zlim()...bubble plot
Message-ID: <AANLkTimZMsb4jrF62vYTosDGucPM88tgd9JYop99iwaU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/d0e7f71f/attachment.pl>

From risemary48 at yahoo.com  Mon Feb 21 18:07:38 2011
From: risemary48 at yahoo.com (Mary Rise)
Date: Mon, 21 Feb 2011 09:07:38 -0800 (PST)
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
Message-ID: <100115.87056.qm@web120819.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/634c47f6/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Feb 21 18:34:56 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 21 Feb 2011 18:34:56 +0100
Subject: [R-sig-Geo] zlim()...bubble plot
In-Reply-To: <AANLkTimZMsb4jrF62vYTosDGucPM88tgd9JYop99iwaU@mail.gmail.com>
References: <AANLkTimZMsb4jrF62vYTosDGucPM88tgd9JYop99iwaU@mail.gmail.com>
Message-ID: <4D62A240.7040203@uni-muenster.de>

What do you need that the arguments maxsize and key.entries in ?bubble
do not allow you to do? Perhaps sth like

library(fortunes); fortune(122)

On 02/21/2011 05:29 PM, Jaime Burbano Gir?n wrote:
> Hi every body, I need to fix the size of the scale and the bubbles plotted
> in function bubble(), I?ve tried with "zlim=c(min(x),max(x))", similar to
> function plot(), but it doesn?t work. Does any body know how can I do this?
> Thanks in advance.

plot is a method, not a function. The default does not have a zlim paramer:

> plot(1:10, zlim=c(0,5))
Warning messages:
1: In plot.window(...) : "zlim" is not a graphical parameter
2: In plot.xy(xy, type, ...) : "zlim" is not a graphical parameter
3: In axis(side = side, at = at, labels = labels, ...) :
  "zlim" is not a graphical parameter
4: In axis(side = side, at = at, labels = labels, ...) :
  "zlim" is not a graphical parameter
5: In box(...) : "zlim" is not a graphical parameter
6: In title(...) : "zlim" is not a graphical parameter

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jaimebg27 at gmail.com  Mon Feb 21 19:15:20 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Mon, 21 Feb 2011 13:15:20 -0500
Subject: [R-sig-Geo] zlim()...bubble plot
In-Reply-To: <4D62A240.7040203@uni-muenster.de>
References: <AANLkTimZMsb4jrF62vYTosDGucPM88tgd9JYop99iwaU@mail.gmail.com>
	<4D62A240.7040203@uni-muenster.de>
Message-ID: <AANLkTinVNSpgZhw52nfwbNDh51vzL37jAM3Xs1UWSCXp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/5a36beea/attachment.pl>

From lestes at princeton.edu  Mon Feb 21 20:01:15 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Mon, 21 Feb 2011 14:01:15 -0500
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <100115.87056.qm@web120819.mail.ne1.yahoo.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
	<100115.87056.qm@web120819.mail.ne1.yahoo.com>
Message-ID: <AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>

Hi Mary,

I am not sure that I totally understand how you want to mask, so my
answer will probably be confused here.

If I understand you correctly, the landcover dataset extends outside
of the country you are studying, so you just want to limit the
analysis to certain landcovers falling within that country.

It sounds to me as if you have already selected the landcovers you
want, so I would again coerce both the country and "mask" to rasters
(maybe Edzer or somebody else can correct me if this is problematic).
Since it sounds like the landcover is bigger than the country, I would
use mask's extent to define the raster for "country"

mask.r <- raster(mask)

Presumably you have a polygon for the country, so to me it's easiest to do this:

cnt.r <- rasterize(SpatialPolygons(country), mask.r)

Then to use both to make a mask, you could do something like this:

my.mask <- mask.r & cnt.r

That should give you a mask for the landcovers you want within your country.

Hope this works and is relevant.

Cheers, Lyndon





On Mon, Feb 21, 2011 at 12:07 PM, Mary Rise <risemary48 at yahoo.com> wrote:
> Hi Lyndon,
> You are right it works for my data because my data is integer as shown:
> Data attributes:
> ??? Min.? 1st Qu.?? Median???? Mean? 3rd Qu.???? Max.???? NA's
> ??? 1.00???? 4.00???? 5.00???? 5.31???? 6.00???? 9.00 20735.00
>
> Question 1 is answered i managed to remove the class 9 so my landcover map
> is now having 8 classes. but i can not collapse these 8 classes into one
> because i will loose the classes on the legend.
> What i want to do now is to create a mask? by using the new landcover which
> is now RasterLayer ( because of this script m3 <- raster(landcover, layer =
> "band1", m4 <- m3 * ((m3 < 9) / (m3 < 9)) and country. I am still a beginner
> in using R .
>
> Question
> how can i create a mask from 2 different datasets which are:
> SpatialPolygonsDataFrame(country) defining the extend of study + the
> wanted?sections?are? under the new landcover map which is a
> SpatialGridDataFrame = mask
>
> Is this possible in R?
>
> Aim of creating this mask is to clip the other 5 datasets like DEM which are
> spatialgriddataframes.
> Thanks
>
> Mary
> ________________________________
> From: Lyndon Estes <lestes at princeton.edu>
> To: Mary Rise <risemary48 at yahoo.com>
> Cc: r-sig-geo-owner at r-project.org; r-sig-geo at r-project.org
> Sent: Sun, February 20, 2011 5:44:54 PM
> Subject: Re: [R-sig-Geo] spatialgridataframes
>
> Hi Mary,
>
> This might help answer your questions. I used the meuse dataset and
> converted to raster formats, but I think the general approach should
> work for what you want to do.
>
> library(raster)
> library(gstat)
> data(meuse.grid)
> coordinates(meuse.grid) = ~x+y
> gridded(meuse.grid) = TRUE
> class(meuse.grid)
> m2 <- as(meuse.grid, "SpatialGridDataFrame")
> m3 <- raster(m2, layer = "soil")? # Convert soil classes to raster
>
>>
>> Question1.
>> How can i remove the ninth class in R because it does not have to be
>> included in
>> geostatical analysis.
>
> m4 <- m3 * ((m3 < 3) / (m3 < 3))? # Removes class 3 from soil,
> converts it to NA values (this could also
> # serve as a mask)
>
> # If you want to keep that part of the grid in the analysis, then you
> might want to collapse the one class
> # into another
> m5 <- (m3 == 3 | m3 == 2) * 2 + (m3 == 1)? # Class 2 now includes 2 and 3
>
>> Question 2
>> how can i use the map created in Q1 to clip the other 5? aboventioned?maps
>> (eg
>> DEM etc)?or how can i create a mask from the map in Q1.
>>
>
>
> # Create a mask for just the area of soil class 1
> sc1.mask <- (m3 == 1) / (m3 == 1)
>
> # You then multiply your other rasters by your mask to reduce rasters
> to the areas you want to analyze.
>
> Cheers, Lyndon
>
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From ana-lee at web.de  Mon Feb 21 20:54:29 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Mon, 21 Feb 2011 20:54:29 +0100
Subject: [R-sig-Geo] variogram trend analysis
Message-ID: <4D62C2F5.5060103@web.de>

Dear list,

is there any possibility to do a Cressie trend analysis for variogram 
data with geoR?

Thanks, Anna


From edzer.pebesma at uni-muenster.de  Mon Feb 21 20:56:35 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 21 Feb 2011 20:56:35 +0100
Subject: [R-sig-Geo] zlim()...bubble plot
In-Reply-To: <AANLkTinVNSpgZhw52nfwbNDh51vzL37jAM3Xs1UWSCXp@mail.gmail.com>
References: <AANLkTimZMsb4jrF62vYTosDGucPM88tgd9JYop99iwaU@mail.gmail.com>	<4D62A240.7040203@uni-muenster.de>
	<AANLkTinVNSpgZhw52nfwbNDh51vzL37jAM3Xs1UWSCXp@mail.gmail.com>
Message-ID: <4D62C373.1090605@uni-muenster.de>


On 02/21/2011 07:15 PM, Jaime Burbano Gir?n wrote:
> Sorry If I wasn?t clear. I want to delimit 3 bubble plots to the same scale,
> this is that for the 3 plots: the size and of course the legend of the
> bubbles were plotted between -200 and 200.

Sorry if I wasn't clear, but was

require(sp)
data(meuse)
coordinates(meuse) = ~x+y
bubble(meuse["zinc"], maxsize=3, key.entries = c(10,100,1000,10000))
bubble(meuse["lead"], maxsize=3, key.entries = c(10,100,1000,10000))
bubble(meuse["copper"], maxsize=3, key.entries = c(10,100,1000,10000))

what you were looking for?

> When I do this with a "raster" object I use the argument zlim=c(-200,200) in
> the method plot(), but I don?t know if I can do the same with the bubble
> plot.

You may find all this confusing, and there is indeed little supervision
in R development, but CRAN packages do have documentation -- although I
cound not find zlim in help(plot, raster)

> Thanks again.
> 
> On Mon, Feb 21, 2011 at 12:34 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>> What do you need that the arguments maxsize and key.entries in ?bubble
>> do not allow you to do? Perhaps sth like
>>
>> library(fortunes); fortune(122)
>>
>> On 02/21/2011 05:29 PM, Jaime Burbano Gir?n wrote:
>>> Hi every body, I need to fix the size of the scale and the bubbles
>> plotted
>>> in function bubble(), I?ve tried with "zlim=c(min(x),max(x))", similar to
>>> function plot(), but it doesn?t work. Does any body know how can I do
>> this?
>>> Thanks in advance.
>>
>> plot is a method, not a function. The default does not have a zlim paramer:
>>
>>> plot(1:10, zlim=c(0,5))
>> Warning messages:
>> 1: In plot.window(...) : "zlim" is not a graphical parameter
>> 2: In plot.xy(xy, type, ...) : "zlim" is not a graphical parameter
>> 3: In axis(side = side, at = at, labels = labels, ...) :
>>  "zlim" is not a graphical parameter
>> 4: In axis(side = side, at = at, labels = labels, ...) :
>>  "zlim" is not a graphical parameter
>> 5: In box(...) : "zlim" is not a graphical parameter
>> 6: In title(...) : "zlim" is not a graphical parameter
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From narayani at ku.edu  Mon Feb 21 21:10:55 2011
From: narayani at ku.edu (Narayani Barve)
Date: Mon, 21 Feb 2011 14:10:55 -0600
Subject: [R-sig-Geo] Non Square Pixels
Message-ID: <AANLkTik5kSNGq+_gktdr7XYJhGgsgKmLRcsrHu+D7-rg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/4a814cec/attachment.pl>

From matthias.m.hinz at googlemail.com  Mon Feb 21 21:34:44 2011
From: matthias.m.hinz at googlemail.com (Matthias Hinz)
Date: Mon, 21 Feb 2011 21:34:44 +0100
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
	<100115.87056.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>
Message-ID: <AANLkTikYEPuX3MKP_YEiytxuFSW9UA4=Rb_gMUrXn7LD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/7e2667d0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Feb 21 22:08:36 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 21 Feb 2011 22:08:36 +0100
Subject: [R-sig-Geo] variogram trend analysis
In-Reply-To: <4D62C2F5.5060103@web.de>
References: <4D62C2F5.5060103@web.de>
Message-ID: <4D62D454.7060007@uni-muenster.de>

If you mean median polish kriging, then spdep

http://cran.r-project.org/web/packages/spdep/vignettes/sids.pdf

seems to have some pointers (and functions) for median polish smoothing.
You could use geoR to work on the residuals.

On 02/21/2011 08:54 PM, Anna Gretschel wrote:
> Dear list,
> 
> is there any possibility to do a Cressie trend analysis for variogram
> data with geoR?
> 
> Thanks, Anna
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Mon Feb 21 22:32:36 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 21 Feb 2011 22:32:36 +0100
Subject: [R-sig-Geo] [52N Geostatistics] Space-time spatial variability
In-Reply-To: <201102212107.p1LL7152032507@mail09.syd.optusnet.com.au>
References: <201102212107.p1LL7152032507@mail09.syd.optusnet.com.au>
Message-ID: <4D62D9F4.4040501@uni-muenster.de>



On 02/21/2011 10:07 PM, yong.t.li at optusnet.com.au wrote:
> Dear All,
> 
> I plan to use gstat to do some 3D kriging on a spatio-temporal dataset I have collected to look at the spatio-temporal distributions of soluble nutrients in shallow groundwater.
> I did read some papers such as written by Heuvelink and De Inco, quite impressed by the outcomes and curiously want to do my own. When I ran demo(pcb) and demo(wind), found the outputs were slightly different from what I expected. they did not calculate the temporal semivariance (or maybe they did but I just did not know where they are).
> In the literature, people always talk about the combination of spatial variance and temporal variance, such product and product-sum functions, but I did not see them in the demo(pcb) and demo(wind).
> 
> Any experts in the area giving me a full procedure of using gstat to do 3D kriging is highly appreciated.
> 
py
demo(pcb) essentially uses cokriging, and sees the (4) time replicates
as correlated, but different variables. Spatial correlation is then
modelled in the direct variograms, spatio-temporal correlation in the
cross variograms.

demo(wind) in package gstat defines a separable covariance function
(function covfn) similar to the one used by Haslett and Raftery, that is
passed to krige0. You could define your own function, such as a
product-sum model, here.

In package spacetime the same example is worked out (see the vignette),
using spatio-temporal data structures.

In principle you can mimic product-sum variograms by the metric (3D)
variogram model in 3D kriging in gstat by setting the right anisotropy
ranges to values very close to zero.

> Regards,
> 
> Yong Li
> 
> ps. 
> I used to be on the list of r-sig-geo, but was knocked out by unknown reasons. wish this time I can make it.

I'll keep them informed. Maybe your questions were too hard. ;-)

>  
> _______________________________________________
> Geostatistics mailing list
> Geostatistics at 52north.org
> http://list.52north.org/mailman/listinfo/geostatistics
> http://geostatistics.forum.52north.org

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mdsumner at gmail.com  Mon Feb 21 22:36:06 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 22 Feb 2011 08:36:06 +1100
Subject: [R-sig-Geo] Non Square Pixels
In-Reply-To: <AANLkTik5kSNGq+_gktdr7XYJhGgsgKmLRcsrHu+D7-rg@mail.gmail.com>
References: <AANLkTik5kSNGq+_gktdr7XYJhGgsgKmLRcsrHu+D7-rg@mail.gmail.com>
Message-ID: <AANLkTimZ=+Nghv4O79n506sDKqam9jUWb4-e=ix=Ge1+@mail.gmail.com>

Almost any of the formats supported by rgdal will support non-square
pixels. The rgdal package defaults to GeoTIFF, which certainly can.

You probably need to determine which format is required by your ESRI
product, but if it is a recent release i.e. ArcGIS 9.2 and later reads
rasters with GDAL anyway so GeoTIFF is probably a good choice. If it's
very large consider the options for compression and tiling.

See library(raster);?writeRaster; writeFormats()  for details for that
package, writeGDAL will write a GeoTIFF by default.

See here for details on many formats, and the package docs for other details:
http://www.gdal.org/formats_list.html

Cheers, Mike.

On Tue, Feb 22, 2011 at 7:10 AM, Narayani Barve <narayani at ku.edu> wrote:
> Hi All,
>
> I have ASCII grid (ESRI) format file. This file do not have square pixel but
> has rectangular pixel. X dimension is 1 and Y dimension is 0.83333. ESRI
> product cannot read a file with rectangular pixel. Is there a way, to
> convert this file so that square pixels are generated and file can be used
> with ESRI products ? Raster package has any functions to help out ?
>
> Thanks in anticipation
> Narayani
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From fernandodelbon at yahoo.com.br  Tue Feb 22 03:54:17 2011
From: fernandodelbon at yahoo.com.br (fernando del bon)
Date: Mon, 21 Feb 2011 18:54:17 -0800 (PST)
Subject: [R-sig-Geo] Lacunarity analysis in R
Message-ID: <721009.74807.qm@web113302.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110221/dfa8b51f/attachment.pl>

From Ana-Lee at web.de  Tue Feb 22 11:07:30 2011
From: Ana-Lee at web.de (Anna Gretschel)
Date: Tue, 22 Feb 2011 11:07:30 +0100 (CET)
Subject: [R-sig-Geo] variogram trend analysis
Message-ID: <1787531806.1620496.1298369250577.JavaMail.fmail@mwmweb070>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110222/763cf45e/attachment.html>

From amonleong at wanadoo.es  Tue Feb 22 11:13:42 2011
From: amonleong at wanadoo.es (TM)
Date: Tue, 22 Feb 2011 11:13:42 +0100
Subject: [R-sig-Geo] bayesian kriging
In-Reply-To: <4D626D35.6040406@geo.uu.nl>
References: <C4E200AD50B24014A84136561E19E59C@TM1> <4D626D35.6040406@geo.uu.nl>
Message-ID: <B8909256E4E54090AB51B44B3C0B8306@TM1>

Dear Paul,

Thank you very much.

Toni


----- Original Message ----- 
From: "Paul Hiemstra" <p.hiemstra at geo.uu.nl>
To: "TM" <amonleong at wanadoo.es>
Cc: <r-sig-geo at r-project.org>
Sent: Monday, February 21, 2011 2:48 PM
Subject: Re: [R-sig-Geo] bayesian kriging


> On 02/07/2011 04:55 PM, TM wrote:
>> Hi all,
>>
>> I' m searching some R codes to do a bayesian kriging and cokriging 
>> (examples). Please could you help me?
>>
>> Thanks
>>
>> Toni
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> Hi TM,
>
> See the geoR package.
>
> Paul
>
> -- 
> Paul Hiemstra, MSc
> Department of Physical Geography
> Faculty of Geosciences
> University of Utrecht
> Heidelberglaan 2
> P.O. Box 80.115
> 3508 TC Utrecht
> Phone:  +3130 253 5773
> http://intamap.geo.uu.nl/~paul
> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
>
> currently @ KNMI
> paul.hiemstra_AT_knmi.nl
>


From calesso at fca.unl.edu.ar  Tue Feb 22 13:04:31 2011
From: calesso at fca.unl.edu.ar (Ing. Agr. =?ISO-8859-1?Q?Agust=EDn?= Alesso)
Date: Tue, 22 Feb 2011 09:04:31 -0300
Subject: [R-sig-Geo] Need help understanding the spatial correlation
 structure applied in lme
In-Reply-To: <mailman.9.1298372403.4408.r-sig-geo@r-project.org>
References: <mailman.9.1298372403.4408.r-sig-geo@r-project.org>
Message-ID: <1298376271.2181.23.camel@blackdog>

Dear Arnaud,

First at all, I'm not an expert but your question maybe help me, so my
apologies about that. 
The plot you posted is from Normalised residuals of a fitted lme.object
that already take account for correlation?
Can you submit your code for that plot?

Regards,


Agustin

El mar, 22-02-2011 a las 12:00 +0100, r-sig-geo-request at r-project.org
escribi?:
> Dear Users,
> 
> I apologize to resubmit this question to your brains, but I need to
> understand some of my results to be sure that I did not make errors
> setting
> my analysis.
> So, even (and particularly) if the answer is "You are totally wrong",
> please
> let me know !
> 
> >From previous analysis (semi-variograms using package gstat), I found
> spatial autocorrelation in my dataset.
> The best fitted model to this spatial correlation structure is the
> Gaussian
> model (Spherical, Exponential, Linear tested and comparison done by
> Sum of
> Square errors).
> So I used corGaus function to define this spatial autocorrelation in
> my lme
> model using the option "correlation".
> 
> Example: lme( Y ~ X1 + X2 + ... + X3,  random = ~ 1 | RandomFactor,
> correlation = corGaus(form = ~ X + Y | RandomFactor )
> 
> The Variogram function (package nlme) used on a lme object calculates
> the
> semi-variogram for the within-group residuals and add the
> semi-variogram of
> the corSpatial element (corGaus in my case) included in my model ...
> so far
> no problem.
> 
> I was surprised, however, to see on the plot of the semi-variogram
> issued
> from the Variogram function, (see figure at http://imm.io/3OLe) the
> low
> range value (~1600 meters) used in the corGaus structure included in
> the lme
> object.
> When I fitted the same corGaus structure manually or using the
> fit.variogram
> function (package gstat) on the data of each group defined in lme, it
> gaves
> me ranges between 2050 and 2700 meters (mean 2350 meters).
> 
> Can anyone explain me those differences ?
> 
> Note: As I mentioned in a previous message (
> http://markmail.org/message/gjgag4ohjopevgax), I tried to define a
> different
> range in the corGaus function directly in the lme function, but it is
> not
> taken into account.
> 
> Arnaud
> 
>         [[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------ 
-- 
Ing. Agr. Agust?n Alesso
Dpto. de Ciencias del Ambiente
Fac. Ciencias Agrarias - UNL
Kreder 2805 - S3080HOF - Esperanza
Tel: 03496-426400 ext 256


From risemary48 at yahoo.com  Tue Feb 22 13:49:25 2011
From: risemary48 at yahoo.com (Mary Rise)
Date: Tue, 22 Feb 2011 04:49:25 -0800 (PST)
Subject: [R-sig-Geo] spatialgridataframes
In-Reply-To: <AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
	<100115.87056.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>
Message-ID: <138258.49994.qm@web120809.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110222/828cc3b5/attachment.pl>

From roberto.bastos at itau-unibanco.com.br  Tue Feb 22 14:01:50 2011
From: roberto.bastos at itau-unibanco.com.br (Roberto Almeida Bastos)
Date: Tue, 22 Feb 2011 10:01:50 -0300
Subject: [R-sig-Geo] RES:  spatialgridataframes
In-Reply-To: <138258.49994.qm@web120809.mail.ne1.yahoo.com>
References: <393069.69515.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTimYwFirOBDdrkT1n2p6-vsBmJ3VpbkaoBD__au+@mail.gmail.com>
	<100115.87056.qm@web120819.mail.ne1.yahoo.com>
	<AANLkTin16SbfSc4xe6Zc+KBOTnsyULUsbD6NdPnMrj5P@mail.gmail.com>
	<138258.49994.qm@web120809.mail.ne1.yahoo.com>
Message-ID: <3824_1298379727_4D63B3CF_3824_61461_2_7C2AB262FB419749A5A82199A7822A29016ED91D56D8@VCMT956CTO.corp1.rc.itau>

Hello friends,

Some advice might be very helpful 

A have a shapefile from a certain region. I used the "spdep" package to obtain the objects necessary to my spatial analysis (nb, listw, etc). Now I was wondering if there is a way to split the map into several other maps (in two, three or even four parts) and repeat the study for the subregions in a separated way. Moreover, I would like to know if It is possible to break the shapefile in parts (like in little shapefiles) and apply the "spdep" functions to it?

Thanks for the help!

Roberto 



"Esta mensagem e uma correspond?ncia reservada e sua divulga??o, distribui??o, reprodu??o ou qualquer forma de utiliza??o depende de autoriza??o, sujeitando-se o respons?vel a medidas judiciais. O remetente utiliza o correio eletr?nico no exerc?cio do seu trabalho ou em raz?o dele, eximindo esta institui??o de qualquer responsabilidade por utiliza??o indevida. Se voc? a recebeu por engano, favor elimin?-la."
 

"This message is a reserved correspondence and its disclosure, distribution, reproduction or any other form of use shall depend upon proper authorization, and the recipient responsible for such disclosure, distribution, reproduction or use shall be subject to legal actions. The sender uses the electronic mail in the exercise of his/her work or by virtue thereof, and the institution accepts no liability for its undue use. If you have received this e-mail by mistake, please delete it."


From kjetil1001 at gmail.com  Tue Feb 22 19:19:44 2011
From: kjetil1001 at gmail.com (Kjetil brinchmann Halvorsen)
Date: Tue, 22 Feb 2011 15:19:44 -0300
Subject: [R-sig-Geo] Lacunarity analysis in R
In-Reply-To: <721009.74807.qm@web113302.mail.gq1.yahoo.com>
References: <721009.74807.qm@web113302.mail.gq1.yahoo.com>
Message-ID: <AANLkTinXeidQ-B=qNSLhEMQJQbaaxoN5v292oX4pyzNJ@mail.gmail.com>

Maybe not, I tried
library(sos)
> h <- ???lacunarity
found 0 matches
Warning message:
In findFn("lacunarity") : HIT not found in HTML;  processing one page only.
>

no hits.

Kjetil

On Mon, Feb 21, 2011 at 23:54, fernando del bon
<fernandodelbon at yahoo.com.br> wrote:
>
> Dear All,
> I would like any information about lacunarity analyis in R.? Does anyone know if the sliding-box lacunarity analysis of Allain and Cloitre (1991) or Plotnick et al. (1996) has been implemented by anyone in R?? Or any R package useful for that?? I have seen anything in R mail list files.
>
>
> Thanks,
>
>
> Fernando
>
> C. Allain C. and M. Cloitre, 1991. ?Phys. Rev. A 44, p. 3552.
>
>
> R.E. Plotnick, RH Gardner, WW Hargrove, K Prestergaard, M Perlmutter,
> 1996. Phys. Rev. E 55(5), p. 5461
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
"If you want a picture of the future - imagine a boot stamping on the
human face - forever."

George Orwell (1984)


From ldecola at comcast.net  Tue Feb 22 19:19:47 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Tue, 22 Feb 2011 18:19:47 +0000 (UTC)
Subject: [R-sig-Geo] tutorial for sp?
In-Reply-To: <4D2D5065.3090403@uni-muenster.de>
Message-ID: <581391860.1210518.1298398787624.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110222/bd7e1edb/attachment.pl>

From r.hijmans at gmail.com  Tue Feb 22 22:35:24 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 22 Feb 2011 13:35:24 -0800
Subject: [R-sig-Geo] Help on slow processing of extract fuction
In-Reply-To: <AANLkTi=M5XVkhoJRaENjdQ1Lx1fyR=C7cLWeZLj3QiB0@mail.gmail.com>
References: <AANLkTinCt2BSuLguRB6j6YZbuYaVV9vQ0EjertSV_DbM@mail.gmail.com>
	<alpine.LRH.2.00.1102202228030.18316@reclus.nhh.no>
	<AANLkTi=M5XVkhoJRaENjdQ1Lx1fyR=C7cLWeZLj3QiB0@mail.gmail.com>
Message-ID: <1298410524717-6054157.post@n2.nabble.com>


> I have a classified image of whole India (India measures 3,214 km (1,997
mi) 
> from north to south and 2,993 km (1,860 mi) from east to west) at 56m 
> resolution. I have generate a square grid  of type polygon (area of each 
> square polygon in grid is 1sq km) that covers whole India. Now I have to 
> extract the fraction of crop classes from classified image for each square 
> polygon in the grid. 

Presumably you have the 1 km grid also as a raster file. I think I would do
this:

library(raster)
km <- raster("1km_raster_filename")
# make an "empty" RasterLayer
km <- raster(km)
# disaggregate to 50 m
m50 <- disaggregate(km, 20)

# resample land cover data to 50 m such that it lines up with the 1 km cells
you want.
x <- raster("land cover data file")

m50 <- resample(x, m50, method="ngb", filename="lc_resampled.tif",
progress="text")

# now things line up, and you could reclassify and use zonal to extract the
fraction of each class, but that would be a bit inefficient for what you
want. So I would do something along these lines

km1 <- writeStart(km, filename='km1.tif')
km2 <- writeStart(km, filename='km2.tif')

nsteps <- ceiling(nrow(km) / 20)
for (s in 1:nsteps) {
	r <- (s-1) * 20 + 1
	v <- getValues(m50, r, r + 19)
	# v has 20 rows of values. They need to be summarized in square blocks (20
columns)
	v <- matrix(as.vector(v), nrow=400)
	# % of values that is '1'
	vv1 <- apply(v, 2, fun(x) sum(x==1))  / 4
	km1 <- writeValues(km1, vv1, s)
	# % of values that is '2'
	vv2 <- apply(v, 2, fun(x) sum(x==2))  / 4
	km2 <- writeValues(km1, vv2, s)
}
km1 <- writeStop(km1)
km2 <- writeStop(km2)

# not tested, not dealing with NA values, and probably full of small errors,
so this will take some work, but I think the general approach should work.
See the rater vignette about writing functions for more details.

Hope this helps,
Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-on-slow-processing-of-extract-fuction-tp6046528p6054157.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From cswingle at gmail.com  Wed Feb 23 00:27:18 2011
From: cswingle at gmail.com (Christopher Swingley)
Date: Tue, 22 Feb 2011 14:27:18 -0900
Subject: [R-sig-Geo] R array to TIF
Message-ID: <AANLkTi=xbTzu_8gvj3fkb7e+n-SgcufgdxUp-6m=6iR+@mail.gmail.com>

Greetings!

I'm reading in a bunch of TIF images that all have the same extent
using rgdal::readGDAL, and then aggregating the stack of $band1 data
by applying a function to the vector of image data at each pixel.  The
result is an R array.  I want to write out this array as a TIF image
with the same parameters (rows, columns, bounding box, projection,
etc.), but I haven't found the trick to creating a
SpatialGridDataFrame so I can use writeGDAL.  I'm also curious about
how one might change the data type (Byte, Int16, etc.) and nodata
value when dumping it out.

Thanks!

Chris
-- 
Christopher Swingley
Fairbanks, Alaska
http://swingleydev.com/
cswingle at gmail.com


From cswingle at gmail.com  Wed Feb 23 00:37:35 2011
From: cswingle at gmail.com (Christopher Swingley)
Date: Tue, 22 Feb 2011 14:37:35 -0900
Subject: [R-sig-Geo] R array to TIF
In-Reply-To: <AANLkTi=xbTzu_8gvj3fkb7e+n-SgcufgdxUp-6m=6iR+@mail.gmail.com>
References: <AANLkTi=xbTzu_8gvj3fkb7e+n-SgcufgdxUp-6m=6iR+@mail.gmail.com>
Message-ID: <AANLkTimnJ+5i19hPNyF-25SJTGtqmku97otVzi4v692A@mail.gmail.com>

Oops.  I apparently didn't try the simplest thing:

raster <- readGDAL(path) # a 1000 x 1000 raster
raster$band1 <- array(data = 1, dim = 1000000)
writeGDAL(raster, fname = '/tmp/foo.tif', driver = 'GTiff', type =
'Byte', mvFlag = 255)

Cheers,

Chris
-- 
Christopher Swingley
Fairbanks, Alaska
http://swingleydev.com/
cswingle at gmail.com


From Adrian.Baddeley at csiro.au  Wed Feb 23 03:03:22 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Wed, 23 Feb 2011 10:03:22 +0800
Subject: [R-sig-Geo] spatstat: confusion about Kcross.inhom
Message-ID: <57DC18C299094D4299F837570C5DF1C5362603DAB4@EXWA-MBX01.nexus.csiro.au>

Erika Mudrak asks:

>My confusion is why you get different values if you use density.ppp 
>to generate an image file with either at="points" (creating a 
>numeric vector of intensity values at the points) or at="pixels" 
>(creating an image showing intensities at every location in a fine 
>grid of the window).

The intensity estimators are different.

If 'at = "pixels"', then the algorithm computes a standard, fixed-bandwidth, kernel smoother estimate of the intensity, evaluated at a grid of pixel centres.

If 'at = "points"' then by default, leaveoneout = TRUE which means that the algorithm computes a leave-one-out estimator of the intensity. The estimate of the intensity at a particular data point x[i] is computed using only the *other* data points x[j] for j not equal to i. 

If 'at="points"' and 'leaveoneout = FALSE' then the standard fixed bandwidth kernel smoother is computed. 

The estimate with 'leaveoneout = TRUE' is preferable for use when calculaing the inhomogeneous K function (as explained in the paper Baddeley Moller and Waagepetersen cited in the help file).

Consider the following example, where X is a point pattern

     A <- density(X, sigma=0.15, at="pixels")[X]
     B <- density(X, sigma=0.15, at="points")
     C <- density(X, sigma=0.15, at="points", leaveoneout=FALSE)

Then A and C should be approximately equal; C is more accurate than A, because A involves pixel approximation, as explained by Marcelino.

B and C are different; each entry of C should be larger than the corresponding entry of B; their exact relationship is complicated due to edge corrections. 

Adrian Baddeley
----

Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
Skype: adrian.baddeley


From horning at amnh.org  Wed Feb 23 04:20:33 2011
From: horning at amnh.org (Ned Horning)
Date: Tue, 22 Feb 2011 22:20:33 -0500
Subject: [R-sig-Geo] Error in .GDALnodatavalue(dataformat)
Message-ID: <4D647D01.4080403@amnh.org>

Hi -

I am getting the following error when I run aggregate (from the raster 
package) on a raster image and output to a file.

Error in .GDALnodatavalue(dataformat) : cannot find matching nodata value

This is the command I am running:
aggregate(inImg, fact=40, fun=varPercent, filename=outImage, 
format="GTiff", datatype="INT1U", overwrite=TRUE, progress='text')

If I run this without the datatype="INT1U" it appears to work.

When I run NAvalue the result is 255. I set NAvalue to 0 but the error 
still appears. The integer data I am outputting range from 0 - 100.

This is the function I am calling from aggregate:
--
varPercent <- function(a,...) {
    x <- round(sum(a==11)/1600*100)
    return(x)
}
--

I just updated all of my packages in R today. Although I didn't try this 
script before updating I did try it on another computer that has not 
been updated for quite some time and it works fine.

Any ideas what I'm doing wrong?

Ned


From r.hijmans at gmail.com  Wed Feb 23 04:43:28 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 22 Feb 2011 19:43:28 -0800
Subject: [R-sig-Geo] Error in .GDALnodatavalue(dataformat)
In-Reply-To: <4D647D01.4080403@amnh.org>
References: <4D647D01.4080403@amnh.org>
Message-ID: <1298432608167-6055072.post@n2.nabble.com>


> I am getting the following error when I run aggregate (from the raster 
> package) on a raster image and output to a file. 

> Error in .GDALnodatavalue(dataformat) : cannot find matching nodata value 

Ned, 
I think this is something that has been fixed but had not made it to CRAN
yet. Could you try the latest version from R-Forge? I will update the CRAN
version this week.
Best, Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-GDALnodatavalue-dataformat-tp6055038p6055072.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From calamita_giuseppe at yahoo.it  Wed Feb 23 20:51:50 2011
From: calamita_giuseppe at yahoo.it (giuseppe calamita)
Date: Wed, 23 Feb 2011 19:51:50 +0000 (GMT)
Subject: [R-sig-Geo] regression kriging, newdata parameter
Message-ID: <449404.30999.qm@web25908.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110223/2a9d561e/attachment.pl>

From breitbach at uni-mainz.de  Thu Feb 24 00:09:40 2011
From: breitbach at uni-mainz.de (Breitbach, Nils)
Date: Wed, 23 Feb 2011 23:09:40 +0000
Subject: [R-sig-Geo] How to estimate sig2 attribute for functions linker and
 kernelbb from the adehabitatHR package
Message-ID: <E7F1EF063B11DA4DAD16374549B879E82AEBA50D@e14mdb-02.zdv.Uni-Mainz.DE>

Dear Community,

I just thought that it would be a good idea to have a look on the kernelbb function from the adehabitatHR package. What really puzzles me is how to estimate/calculate the sig2 attribute needed for the functions liker() and kernelbb(). Unfortunately the help for the functions refers to a PhD-thesis (Maillard, 1996, p. 63) that is written in French and I have made the mistake to choose Latin in school. Has anyone of you a solution to calculate a sensible value? 

Do I need to calculate sig2 then for each individual and/or burst separately or just pooled over all individuals and bursts?

Cheers,

Nils

From edzer.pebesma at uni-muenster.de  Thu Feb 24 00:15:22 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 Feb 2011 00:15:22 +0100
Subject: [R-sig-Geo] regression kriging, newdata parameter
In-Reply-To: <449404.30999.qm@web25908.mail.ukl.yahoo.com>
References: <449404.30999.qm@web25908.mail.ukl.yahoo.com>
Message-ID: <4D65950A.2040300@uni-muenster.de>

I would take a very good look at the regression kriging literature (or
that of universal kriging, or external drift kriging -- terms that were
there before regression kriging came up). It looks like the method
cannot be applied in your case.
--
Edzer

On 02/23/2011 08:51 PM, giuseppe calamita wrote:
> Hi, 
> I want to perform spatial interpolation of soil moisture (here named 'sm')  
> using regression kriging (RK) following the example given by Tom Hengl 
> http://spatial-analyst.net/wiki/index.php?title=Spatial_prediction_of_soil_moisture)
>  and compare results with OK. 
> 
> The covariate is the soil electrical resistivity (her named 'res') and is stored 
> in the same data.frame of the target variable.
> sm and res data were collected on a regular grid 200x60 m with a 5m sampling 
> step and the coordinates are given in ED50, UTM zone33. CRS.
> Searching on the sig-Geo archive i discovered  that other peoples had more or 
> less the same problem as mine, but there are some differences.
> All the examples i read used the meuse.grid data set which  already stores 
> covariates (dist, soils, ffreq...) and coordinates at an  higher spatial 
> resolution than the target variable sample. This is not  my case. because res is 
> sampled at the points of sm.
> I had to define the grid by myself. 
> 
> #read data 
>> casa032009  <- read.csv("C:/data/morfeo/morfeo_data/casa_032009.csv")
>> str(casa032009)
> 'data.frame':   533 obs. of  9 variables:
>  $ objectid: int  489 490 491 492 493 494 495 496 1 2 ...
>  $ row     : int  185 180 175 170 165 160 155 150 195 190 ...
>  $ col     : Factor w/ 13 levels "A","B","C","D",..: 1 1 1 1 1 1 1 1 2 2 ...
>  $ key     : Factor w/ 533 levels "A0","A10","A100",..: 21 20 19 18 17 16 15 14 
> 64 63 ...
>  $ ka      : num  23.4 19 14.4 14.5 16.6 16.8 14.2 14.8 16.7 21.5 ...
>  $ sm      : num  37.3 32 26.7  26.7 29 29.3 26.5 27.1 29.2 35.2 ...
>  $ x       : num  288097 288102 288107 288112 288117 ...
>  $ y       : num  4754051 4754051 4754052 4754052 4754053 ...
>  $ res     : num  55.1 56.3 63 62.9 57.2 ...
> #explicit spatial object
>> coordinates(casa032009) <- c("x", "y")
> # divide the data set in calibration and  validation groups
>   > dim(casa032009 at data)[1]/3
>    >valid.id <- sample(1:dim(casa032009 at data)[1], 
> 180)                            
> 
>    >casa032009.val <- casa032009[valid.id,]  #valiadtion data set
>    >str(casa032009.val)                                                      
>     >casa032009.cal <-  casa032009[!is.element(1:dim(casa032009 at data)[1], 
> valid.id),]   #calibration data set, almost 350 points
>    >str(casa032009.cal)
> #regression model
>   >lm.casa <-  lm(sm ~ res, data= as.data.frame(casa032009.cal))
>    >summary(lm.casa) 
> #variogram analysis
>> v.rk <- variogram(residuals(lm.casa)~1, casa032009.cal)
>   > plot(v.rk, pl=T)
>    >vm.rk <- vgm(psill=16, "Exp", range=9, nugget=2) #eye-ball fit
>    >plot(v.rk, pl=T, model=vm.rk)
>    >vmf.rk <- fit.variogram(v.rk, vm.rk) #statistical fit
>    >vmf.rk
>   >plot(v.rk, pl=T, model=vmf.rk)
>> bbox(casa032009)
>> (min.x <- bbox(casa032009)["x","min"]-2)
>> (min.y <- bbox(casa032009)["y","min"]-1.75)
>> (max.x  <- bbox(casa032009)["x","max"]+2)
>> (max.y <- bbox(casa032009)["y","max"]+1.75)
>> (cells.x <- (max.x - min.x)/4)
>> (cells.y <- (max.y - min.y)/4)
>> casa.grid <- (GridTopology(c(min.x+2.5, min.y+2.5), c(5, 5), c(cells.x, 
>> cells.y)))
>> casa.grid <- SpatialGrid(casa.grid)
>> str(casa.grid)
> 
> sm.rk <- krige(sm ~ res, location=casa032009.cal, newdata=casa.grid, 
> model=vmf.rk)
> 
> The problem is : I understand the 'newdata' parameter of the krige function 
> needs a SpatialGrifDataFrame containig res data at each grid node.  I don't know 
> how create a SpatialGridDataFrames storing res data on points that are different 
> from the ones that were sampled.
> 
> Thanks for any help.
> 
> Giuseppe
> 
> 
>       
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From calamita_giuseppe at yahoo.it  Thu Feb 24 12:53:23 2011
From: calamita_giuseppe at yahoo.it (giuseppe calamita)
Date: Thu, 24 Feb 2011 11:53:23 +0000 (GMT)
Subject: [R-sig-Geo] regression kriging, newdata parameter
In-Reply-To: <mailman.18.1298545203.18063.r-sig-geo@r-project.org>
References: <mailman.18.1298545203.18063.r-sig-geo@r-project.org>
Message-ID: <462642.72525.qm@web25907.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110224/50efe57c/attachment.pl>

From hengl at spatial-analyst.net  Thu Feb 24 13:53:59 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 24 Feb 2011 13:53:59 +0100
Subject: [R-sig-Geo] regression kriging, newdata parameter
In-Reply-To: <449404.30999.qm@web25908.mail.ukl.yahoo.com>
References: <449404.30999.qm@web25908.mail.ukl.yahoo.com>
Message-ID: <4D6654E7.9070602@spatial-analyst.net>


So you have values of 'sm' (target) and 'res' (covariate) at all 
sampling locations. Now you would like to predict at some other 
locations? You obviously have to have values of 'res' at those locations 
(This is why you get an error in gstat)

"krige" function needs either a SpatialGrifDataFrame or a 
SpatialPointsDataFrame, so the prediction locations do not necessarily 
have to be on a regular grid. The issue is that covariates need to be 
available at prediction locations.

Technically speaking, you could also estimate values of predictors using 
some kind of resampling method (e.g. splines), but then you would use 
estimated values (covariate) to estimate target variable, which does 
feel a bit awkward (but is doable).

PS: gstat implements the Kriging with External Drift method 
(http://dx.doi.org/10.1111/j.1467-9671.2006.01015.x), but this should be 
equivalent to RK (regression and kriging separately, then sum the maps).

HTH

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

Op 23-2-2011 20:51, giuseppe calamita schreef:
> Hi,
> I want to perform spatial interpolation of soil moisture (here named 'sm')
> using regression kriging (RK) following the example given by Tom Hengl
> http://spatial-analyst.net/wiki/index.php?title=Spatial_prediction_of_soil_moisture)
>   and compare results with OK.
>
> The covariate is the soil electrical resistivity (her named 'res') and is stored
> in the same data.frame of the target variable.
> sm and res data were collected on a regular grid 200x60 m with a 5m sampling
> step and the coordinates are given in ED50, UTM zone33. CRS.
> Searching on the sig-Geo archive i discovered  that other peoples had more or
> less the same problem as mine, but there are some differences.
> All the examples i read used the meuse.grid data set which  already stores
> covariates (dist, soils, ffreq...) and coordinates at an  higher spatial
> resolution than the target variable sample. This is not  my case. because res is
> sampled at the points of sm.
> I had to define the grid by myself.
>
> #read data
>> casa032009<- read.csv("C:/data/morfeo/morfeo_data/casa_032009.csv")
>> str(casa032009)
> 'data.frame':   533 obs. of  9 variables:
>   $ objectid: int  489 490 491 492 493 494 495 496 1 2 ...
>   $ row     : int  185 180 175 170 165 160 155 150 195 190 ...
>   $ col     : Factor w/ 13 levels "A","B","C","D",..: 1 1 1 1 1 1 1 1 2 2 ...
>   $ key     : Factor w/ 533 levels "A0","A10","A100",..: 21 20 19 18 17 16 15 14
> 64 63 ...
>   $ ka      : num  23.4 19 14.4 14.5 16.6 16.8 14.2 14.8 16.7 21.5 ...
>   $ sm      : num  37.3 32 26.7  26.7 29 29.3 26.5 27.1 29.2 35.2 ...
>   $ x       : num  288097 288102 288107 288112 288117 ...
>   $ y       : num  4754051 4754051 4754052 4754052 4754053 ...
>   $ res     : num  55.1 56.3 63 62.9 57.2 ...
> #explicit spatial object
>> coordinates(casa032009)<- c("x", "y")
> # divide the data set in calibration and  validation groups
>    >  dim(casa032009 at data)[1]/3
>     >valid.id<- sample(1:dim(casa032009 at data)[1],
> 180)
>
>     >casa032009.val<- casa032009[valid.id,]  #valiadtion data set
>     >str(casa032009.val)
>      >casa032009.cal<-  casa032009[!is.element(1:dim(casa032009 at data)[1],
> valid.id),]   #calibration data set, almost 350 points
>     >str(casa032009.cal)
> #regression model
>    >lm.casa<-  lm(sm ~ res, data= as.data.frame(casa032009.cal))
>     >summary(lm.casa)
> #variogram analysis
>> v.rk<- variogram(residuals(lm.casa)~1, casa032009.cal)
>    >  plot(v.rk, pl=T)
>     >vm.rk<- vgm(psill=16, "Exp", range=9, nugget=2) #eye-ball fit
>     >plot(v.rk, pl=T, model=vm.rk)
>     >vmf.rk<- fit.variogram(v.rk, vm.rk) #statistical fit
>     >vmf.rk
>    >plot(v.rk, pl=T, model=vmf.rk)
>> bbox(casa032009)
>> (min.x<- bbox(casa032009)["x","min"]-2)
>> (min.y<- bbox(casa032009)["y","min"]-1.75)
>> (max.x<- bbox(casa032009)["x","max"]+2)
>> (max.y<- bbox(casa032009)["y","max"]+1.75)
>> (cells.x<- (max.x - min.x)/4)
>> (cells.y<- (max.y - min.y)/4)
>> casa.grid<- (GridTopology(c(min.x+2.5, min.y+2.5), c(5, 5), c(cells.x,
>> cells.y)))
>> casa.grid<- SpatialGrid(casa.grid)
>> str(casa.grid)
>
> sm.rk<- krige(sm ~ res, location=casa032009.cal, newdata=casa.grid,
> model=vmf.rk)
>
> The problem is : I understand the 'newdata' parameter of the krige function
> needs a SpatialGrifDataFrame containig res data at each grid node.  I don't know
> how create a SpatialGridDataFrames storing res data on points that are different
> from the ones that were sampled.
>
> Thanks for any help.
>
> Giuseppe
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From piero.campa at gmail.com  Thu Feb 24 14:17:16 2011
From: piero.campa at gmail.com (piero campa)
Date: Thu, 24 Feb 2011 05:17:16 -0800
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <1297957657204-6036431.post@n2.nabble.com>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl> <483AA4A6.2010101@uni-muenster.de>
	<483AB1F5.7000905@geo.uu.nl> <483AB641.1040201@uni-muenster.de>
	<1297675251985-6022991.post@n2.nabble.com>
	<1297957657204-6036431.post@n2.nabble.com>
Message-ID: <1298553436884-6060288.post@n2.nabble.com>


Maybe this is how the combination is meant to be:

- apply regression model on the area of interest
- use the residuals at sampling location of the target variable to create
direct- and cross-variograms along with the non-ubiquitous predictors
- apply co-kriging by means of these variograms to predict residuals at all
locations and add them to the regression map.

I am sorry I focused on the idea of combining UK with CK, whereas maybe what
Hengl meant in his book was just to combine CK with regression.

Cheers,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Ordinary-and-Regression-Kriging-combined-to-deal-with-missing-values-in-predictor-variables-tp2764942p6060288.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From breitbach at uni-mainz.de  Thu Feb 24 16:44:11 2011
From: breitbach at uni-mainz.de (Breitbach, Nils)
Date: Thu, 24 Feb 2011 15:44:11 +0000
Subject: [R-sig-Geo] How to estimate sig2 attribute for functions linker
 and kernelbb from the adehabitatHR package
In-Reply-To: <079901cbd433$8c487310$a4d95930$@gmail.com>
References: <E7F1EF063B11DA4DAD16374549B879E82AEBA50D@e14mdb-02.zdv.Uni-Mainz.DE>,
	<071001cbd3c5$e0832420$a1896c60$@gmail.com>
	<E7F1EF063B11DA4DAD16374549B879E82AEBA578@e14mdb-02.zdv.Uni-Mainz.DE>,
	<079901cbd433$8c487310$a4d95930$@gmail.com>
Message-ID: <E7F1EF063B11DA4DAD16374549B879E82AEBA611@e14mdb-02.zdv.Uni-Mainz.DE>

Hi Andy,

in my study we followed the birds for the whole day from sunrise (ca. 5.15 h) until sunset (ca. 21.45 h) and recorded every change in position (if we were fast enough). So I could have a temporal resolution of one minute if want to. Of course we have gaps and the individuals have not been followed every day, but for one burst the data are indeed highly serial autocorrelated. That is why I was thinking about using the BB-Kernels to have a look on the differences to the more traditional UD-Kernels.

I know that GPS-telemetry is making progress but there are still a lot of animals out there that can not carry these heavy loads. Furthermore GPS-telemetry is maybe not always the best method; for example if one wants to additionally record a certain behavioural variables like feeding or mating along with the telemetry data - that is something a satellite cannot do. So I think it is worth to discuss the usage of new and promising methods also for such kind of data. Unfortunately I am not a mathematician and I am busy enough being a Biologist with all its sub-disciplines and meanwhile half a geographer for the necessary GIS knowledge. So I feel not able to step deep enough into the formulas to judge about some of the parameters or the best method for obtaining them. Biologists should be the all-in-one human Swiss army knife ;-)

So I thought we might start a discussion in the forum to talk about using the BB-Kernels for various kinds of data?!
Every kind of input or opinion is welcome ...

Cheers,

Nils


________________________________________
Von: Andrew Duff [andrewaduff at gmail.com]
Gesendet: Donnerstag, 24. Februar 2011 16:00
Bis: Breitbach, Nils
Betreff: RE: [R-sig-Geo] How to estimate sig2 attribute for functions linker and kernelbb from the adehabitatHR package

Hi Nils,

The Brownian bridge movement model is best suited for data with high serial
autocorrelation (locations taken within a short time period).  I am
currently applying it to GPS radiocollar hits from golden eagles recorded
every 1 hour.  I don't think that the method is best suited for VHF
telemetry, you would want to have an equal time period between fixes or you
are going to really balloon the uncertainty in your image with respect to
sig1.  I hope this helps,

Andy

-----Original Message-----
From: Breitbach, Nils [mailto:breitbach at uni-mainz.de]
Sent: Thursday, February 24, 2011 1:30 AM
To: Andrew Duff
Subject: AW: [R-sig-Geo] How to estimate sig2 attribute for functions linker
and kernelbb from the adehabitatHR package

Thank you Andy!

I just realised that I forgot to mention that I used terrestrial radio
telemetry - well it was a late-night posting. The two publications that you
referred to just describing the calculation of sig2 for radio collars. In my
case it might be not so easy or moreover I am not sure if it would make
sense at all. Of course I could place my radio tags in different habitat
types over the whole study area and try to locate them from differnt
positions and from different distances. But is locating a tag not much more
dependent on the experience of the person that is taking the relocations and
less dependent of the accuracy of the tag itself? Or at least I would think
so; especially in a project where many people with different levels of
experience are involved. However, what I do have, are comments from the
field, wheather the observer has seen the birds, heard the birds or just
located the bird by signal strength (indicated by a range fromm "++" to
"--"). We also noted an estimated radius of uncertainty based on personal
evaluation of the quality of each fix (e. g. I am sure, that the bird was
within a radius of 20 m arround the fixed coordinate).

What do you think? Could I use one of my measures or should I track my tags
again from various positions and distances in different types of landscape?
How many trials per landscape type and distance would be sufficient? Or is
sig2 only useful for GPS or ARGOS studies?

Cheers,

Nils


________________________________________
Von: Andrew Duff [andrewaduff at gmail.com]
Gesendet: Donnerstag, 24. Februar 2011 02:55
Bis: Breitbach, Nils
Betreff: RE: [R-sig-Geo] How to estimate sig2 attribute for functions linker
and kernelbb from the adehabitatHR package

Sig2 is the second smoothing parameter for the brownian bridge method which
is related to the imprecision of the relocations, supposed known.  These
values could come from previously published GPS collar error studies or from
some GPS collar testing and error evaluation.

I would also suggest reading
http://www.cnr.uidaho.edu/population_ecology/Horne,%20Garton,%20Krone%20&%20
Lewis%202007%20Ecology%20-%20BrownianBridge.pdf and
http://www.esajournals.org/doi/abs/10.1890/08-2034.1?journalCode=ecap

Are you referring to sig1 instead of sig2?

Andy


-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Breitbach, Nils
Sent: Wednesday, February 23, 2011 3:10 PM
To: R-sig-Geo at r-project.org
Subject: [R-sig-Geo] How to estimate sig2 attribute for functions linker and
kernelbb from the adehabitatHR package

Dear Community,

I just thought that it would be a good idea to have a look on the kernelbb
function from the adehabitatHR package. What really puzzles me is how to
estimate/calculate the sig2 attribute needed for the functions liker() and
kernelbb(). Unfortunately the help for the functions refers to a PhD-thesis
(Maillard, 1996, p. 63) that is written in French and I have made the
mistake to choose Latin in school. Has anyone of you a solution to calculate
a sensible value?

Do I need to calculate sig2 then for each individual and/or burst separately
or just pooled over all individuals and bursts?

Cheers,

Nils
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ana-lee at web.de  Thu Feb 24 21:40:48 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Thu, 24 Feb 2011 21:40:48 +0100
Subject: [R-sig-Geo] formula understanding
Message-ID: <4D66C250.2010909@web.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110224/37ead3bf/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Feb 24 23:19:43 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 Feb 2011 23:19:43 +0100
Subject: [R-sig-Geo] formula understanding
In-Reply-To: <4D66C250.2010909@web.de>
References: <4D66C250.2010909@web.de>
Message-ID: <4D66D97F.6030503@uni-muenster.de>



On 02/24/2011 09:40 PM, Anna Gretschel wrote:
> Dear List,
> 
> The following formula is given for a spherical model in variofit (geoR).
> 
> /rho(h) = 1 - 1.5 * (h/phi) + 0.5(h/phi)^3 if h < phi , 0 otherwise
> 
> /Could anyone explain what the term "if h<phi, 0 otherwise" means? Which 
> part of the equation becomes 0 if h>phi?

rho(h)

> And shouldn't there be a * between 0.5 and (h/phi)?

That would have been consistent, but as this is documentatation, I don't
think it is wrong.

> Thanks in advance,
> Anna
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From ana-lee at web.de  Thu Feb 24 23:38:19 2011
From: ana-lee at web.de (Anna Gretschel)
Date: Thu, 24 Feb 2011 23:38:19 +0100
Subject: [R-sig-Geo] formula understanding
In-Reply-To: <4D66D97F.6030503@uni-muenster.de>
References: <4D66C250.2010909@web.de> <4D66D97F.6030503@uni-muenster.de>
Message-ID: <4D66DDDB.2000909@web.de>

Am 24.02.2011 23:19, schrieb Edzer Pebesma:
>
> On 02/24/2011 09:40 PM, Anna Gretschel wrote:
>> Dear List,
>>
>> The following formula is given for a spherical model in variofit (geoR).
>>
>> /rho(h) = 1 - 1.5 * (h/phi) + 0.5(h/phi)^3 if h<  phi , 0 otherwise
>>
>> /Could anyone explain what the term "if h<phi, 0 otherwise" means? Which
>> part of the equation becomes 0 if h>phi?
> rho(h)
>
>> And shouldn't there be a * between 0.5 and (h/phi)?
> That would have been consistent, but as this is documentatation, I don't
> think it is wrong.
>
>> Thanks in advance,
>> Anna
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Thank you! If you don't mind I would like to ask you another question:
I want to use this function to calculate a rmse (root mean square error) 
for my fitted models.

obs beeing the observed data (in my case variog$v) and pred beeing the 
predicted data I use the following formula:

rmse <- function(obs, pred) sqrt(mean((obs-pred)^2))

pred I calculated like this:

pre<- 1 - 1.5 * (h/phi) + 0.5(h/phi)^3 if h<  phi , 0 otherwise
with phi beeing the range and h beeing the distances (variog$u)



The output however is not reliable so I think I made a mistake but 
cannot figure out what is wrong. Do you have an idea what I where the 
error is in reasoning?

Thank you so much for allways replying to my beginners questions :)
Anna


From clement.calenge at oncfs.gouv.fr  Fri Feb 25 10:33:50 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Fri, 25 Feb 2011 10:33:50 +0100
Subject: [R-sig-Geo] How to estimate sig2 attribute for functions linker
 and kernelbb from the adehabitatHR package
In-Reply-To: <E7F1EF063B11DA4DAD16374549B879E82AEBA611@e14mdb-02.zdv.Uni-Mainz.DE>
References: <E7F1EF063B11DA4DAD16374549B879E82AEBA50D@e14mdb-02.zdv.Uni-Mainz.DE>,
	<071001cbd3c5$e0832420$a1896c60$@gmail.com>	<E7F1EF063B11DA4DAD16374549B879E82AEBA578@e14mdb-02.zdv.Uni-Mainz.DE>,
	<079901cbd433$8c487310$a4d95930$@gmail.com>
	<E7F1EF063B11DA4DAD16374549B879E82AEBA611@e14mdb-02.zdv.Uni-Mainz.DE>
Message-ID: <4D67777E.3060003@oncfs.gouv.fr>

Hi all,

> in my study we followed the birds for the whole day from sunrise (ca. 5.15 h)
 > until sunset (ca. 21.45 h) and recorded every change in position (if 
we were
 > fast enough). So I could have a temporal resolution of one minute
 > if want to.  Of course we have gaps and the individuals have not
 > been followed every day, but for one burst the data are indeed
 > highly serial autocorrelated. That is why I was thinking about
 > using the BB-Kernels to have a look on the differences to the more
 > traditional UD-Kernels.

BB-kernels are not designed only for GPS data. They were developed by 
Bullard (1991), at a time when GPS monitoring was not that current in 
ecology. It was developed precisely to take into account the fact that a 
high serial autocorrelation in the successive relocations bring 
informations not only on the places where the animal was at the time of 
monitoring (the relocations), but also on the places where the animal 
might have been between successive relocations. And this is justified by 
the fact that there is a strong autocorrelation in the relocations, and 
not by the technology used to obtain them (GPS, VHF, visual 
observations, etc.). Therefore, the use of VHF does not preclude the use 
of kernelbb. As Andy noted, the important aspect is that a high serial 
autocorrelation is required, which seems to be the case with your data.

Now, the equal time intervals between successive relocations is not, in 
theory, a requirement of the method. The method uses a Brownian bridge 
to estimate the probability density that the animal used any particular 
pixel, given its relocations. Roughly, the brownian bridge supposes that 
the animal is moving completely randomly between two successive 
relocations, and under this model, it is possible to estimate the 
probability density that the animal was present in a pixel, given its 
locations. The kernelbb is an improvement of the classical kernelUD 
approach, as it takes into account the movement constraints (the animal 
has a limited maximum speed). Therefore, under this model, the "shape" 
of the Brownian bridge characterizing two successive relocations is 
adjusted as a function of the time lag separating these two relocations: 
if the time lag is short, the bridge will be narrower than if the time 
lag is long. Therefore, *in theory*, there is no need for regular 
trajectories to use this approach.

However, as all models, the brownian bridge is false: the animal is 
actually not moving completely randomly. Even though this approximation 
may be useful to account for the movement constraints (e.g. an animal 
cannot move 20 km in two minutes), its implications may be problematic 
if the time lag between successive relocations is highly variable (e.g. 
relocations separated by time lags distributed over several orders of 
magnitude, e.g. 10-20 min in some cases and 2 days in other). See this 
thread for an example of the problems that may arise in those cases:
http://www.mail-archive.com/animov at faunalia.it/msg00106.html
But for moderate variations in this time-lag, kernelbb should perform 
reasonably well.

Concerning sig2, there no particular "automatic" method to estimate it. 
It is a common procedure to set it equal to the imprecision of the 
relocations. Note that Benhamou and Cornelis (2010) and Benhamou (2011) 
proposed another approach using biased random bridge (BRB) instead of 
pure random walk in this estimation (i.e. an approach similar to 
kernelbb, but adding a "drift" component to the animal movement between 
successive relocations) leading to estimates more biologically 
consistent. Note also that this method gives you a finer control on 
biologically relevant parameters, and that the diffusion can be 
different for different habitat types. Have a look at the vignette of 
adehabitatHR, page 38:

 > vignette("adehabitatHR")

Note that the discussion concerning the hmin parameter of the BRB 
approach p. 40 and 41 of this vignette is also relevant for the problem 
of the argument sig2 of kernelbb.
Hope this helps,


Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From jaimebg27 at gmail.com  Fri Feb 25 16:52:10 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Fri, 25 Feb 2011 10:52:10 -0500
Subject: [R-sig-Geo] Problem with "autoKrige" Function
Message-ID: <AANLkTinNQ+B5VRDzSghjtR1R+GZ-MZxqdAfpFXe9CMO2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110225/6d49d826/attachment.pl>

From rshepard at appl-ecosys.com  Fri Feb 25 17:10:12 2011
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Fri, 25 Feb 2011 08:10:12 -0800 (PST)
Subject: [R-sig-Geo] Differences Between sp and spatstat?
Message-ID: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>

   I'm brand-new to R and my specific interest is spatial statistics and the
integration of R and GRASS. I just bought a copy of "Applied Spatial
Analysis with R" and have started reading it.

   I've used GRASS on linux since the mid-1990s (and Microsoft-based GIS
since the mid-1980s) and statistics in my academic and real-world work since
the the early 1970s, so my ignorance is specific to R and spatial statistics
with it. I'm a stream ecologist/fluvial geomorphologist, run my own
consultancy, and focus on the natural resource industries.

   The book references the sp package and I find another called spatstat.
What are the differences between them?

   I've also just signed up to subscribe to the R-help mail list because I
need to learn how to install packages (the instructions in the book for ctv,
and those I found on someone's Web site) aren't working for me.

   While I'll be asking a lot of questions at first I expect to be providing
answers and insights before too long.

Rich


From roman.lustrik at gmail.com  Fri Feb 25 17:35:04 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 25 Feb 2011 17:35:04 +0100
Subject: [R-sig-Geo] Differences Between sp and spatstat?
In-Reply-To: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>
References: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>
Message-ID: <AANLkTimiortObr0Zvhv5oGWW6vtwe0hUA7hCOgN1ca5s@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110225/d6c4c849/attachment.pl>

From rshepard at appl-ecosys.com  Fri Feb 25 18:00:20 2011
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Fri, 25 Feb 2011 09:00:20 -0800 (PST)
Subject: [R-sig-Geo] Differences Between sp and spatstat?
In-Reply-To: <AANLkTimiortObr0Zvhv5oGWW6vtwe0hUA7hCOgN1ca5s@mail.gmail.com>
References: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>
	<AANLkTimiortObr0Zvhv5oGWW6vtwe0hUA7hCOgN1ca5s@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.1102250857490.15437@salmo.appl-ecosys.com>

On Fri, 25 Feb 2011, Roman Lu?trik wrote:

> sp package mainly provides classes and methods for spatial data while
> spatstat provides some statistical tools for analyzing spatial phenomena
> (point processes). You can access help files for both packages by entering
> commands ?sp and ?spatstat into your R console.

Roman,

   I'll need to read more about both to understand the specific differences
germane to my needs.

> If you're having trouble installing packages, you can bet you can find a
> solution in the archives of
> R-help<http://r.789695.n4.nabble.com/R-help-f789696.html>.

   I found the solution in the R-admin manual. I could not install from the
shell but could from within R. It worked so I won't waste time wondering
why.

> I find StackOverflow <http://stackoverflow.com/questions/tagged/r> perfect
> for coding questions in general. More specific questions should probably
> be directed to specific lists like this one. Also, there's
> crossvalidated.com. You might find it interesting.

   Thanks very much for the pointers.

Rich

-- 
Richard B. Shepard, Ph.D.          |   The Plain English Science Consultant
Applied Ecosystem Services, Inc.   |   Helping Ensure Our Clients' Futures
<http://www.appl-ecosys.com>     Voice: 503-667-4517      Fax: 503-667-8863


From lestes at princeton.edu  Fri Feb 25 19:06:08 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 25 Feb 2011 13:06:08 -0500
Subject: [R-sig-Geo] Converting raster to polygons with just one polygon for
 cells with common value
Message-ID: <AANLkTinuXFyi+ZuiV7zbdLsWy84XGEQusR=gy+xOHQh7@mail.gmail.com>

Dear List,

I am trying to figure out how I can convert raster to polygons after
the fashion of ArcGIS, i.e. where contiguous raster cells with common
values are grouped into a single polygon.

Here's where I am so far:

library(raster)
library(gstat)
data(meuse.grid)
coordinates(meuse.grid) = ~x+y
gridded(meuse.grid) = TRUE
m2 <- as(meuse.grid, "SpatialGridDataFrame")
m3 <- raster(m2, layer = "soil")  # Convert soil classes to raster

m4 <- m3 == 2  # Select just class 2

# Convert to polygons
m4.shp <- rasterToPolygons(m4, fun = function(x) {x == 1})
plot(m4.shp)  # Produces a polygon for each grid cell

# To produce a single polygon, I then have to use unionSpatialPolygons
m4.shp.m <- unionSpatialPolygons(m4.shp, ID = rep(1, times =
length(m4.shp)), avoidGEOS = F)

plot(as(m4.shp.m, "SpatialLines"), add = T, col = "red")

This solution is very slow for my application, where I am trying to
merge polygons created from 0.0833 degree grids for much of Africa.

Is there a better solution than this?

A side question: even though I have rgeos installed, I cannot
circumvent gpclib, and have to set gpclibPermit() to true.  I was
under the impression that rgeos allowed one to avoid gpclib. Am I
missing something on this, or have I mistakenly loaded libraries,
etc.? I am working on a Mac OSX 10.5.

Thanks, Lyndon


From patrick.giraudoux at univ-fcomte.fr  Sat Feb 26 08:54:13 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 26 Feb 2011 08:54:13 +0100
Subject: [R-sig-Geo] neighbour patches
Message-ID: <4D68B1A5.6030603@univ-fcomte.fr>

Hi,

I am tempted to dig in graph theory and analyse connections between 
discrete landscape patches. Re-reading 'Applied Spatial Data Analysis 
with R' I was happy to find basics chapter 9. However, it reports on 
graphs where (euclidian) distance is computed between patch centroids.

Does anybody have an idea about strategies or packages permitting to use 
the shortest distance between patch borders instead (which is more 
realistic with regard to animal movement) ?

Patrick


From pierre.roudier at gmail.com  Sat Feb 26 09:26:01 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Sat, 26 Feb 2011 21:26:01 +1300
Subject: [R-sig-Geo] Problem with "autoKrige" Function
In-Reply-To: <AANLkTinNQ+B5VRDzSghjtR1R+GZ-MZxqdAfpFXe9CMO2@mail.gmail.com>
References: <AANLkTinNQ+B5VRDzSghjtR1R+GZ-MZxqdAfpFXe9CMO2@mail.gmail.com>
Message-ID: <AANLkTikd-JBrRkd1CbqWNtL=K_nO60Qg_MCwB9VGKo-3@mail.gmail.com>

Jaime,

"Prec" has to be the name of one of the columns of X. What does
names(X) gives you?

Pierre

2011/2/26 Jaime Burbano Gir?n <jaimebg27 at gmail.com>:
> Hi everybody. I?m trying to explore kriging performance for some runoff
> interpolations and I?m using "autoKrige" function from package "automap".
> Following the examples for function I?ve run Ordinary Kriging and Universal
> Kriging, but when I try to run ?"Drift, Regression or Universal Kriging"
> with variables different from "x" and "y" I get this error:
>
> "Error en eval(expr, envir, enclos) : objeto 'Prec' no encontrado" (R is in
> Spanish), which says that the object 'Prec' was not found. My code is:
>
> X=read.csv("F:/Rancheria/EscPrecDEM.csv")
> coordinates(X)=~x+y
> Grid=read.table("F:/Rancheria/puntos_prediccion.txt")
> coordinates(Grid)=~x+y
>
> autoKrige(Anual~Prec+Altura, X, Grid)
>
> I?ve tried renaming the variables to the same names of data "meuse", to
> follow exactly the example of the function:
>
> autoKrige(zinc~soil+ffreq, meuse, meuse.grid)
>
> but I still getting the same error. If someone can help me with this I?ll be
> so grateful. Thanks in advance.
>
> --
> Jaime Burbano Gir?n
> Departamento de Ecolog?a y Territorio
> Pontificia Universidad Javeriana
> Bogot? - Colombia
> (571) 3208320 Ext. 4836
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Scientist
Landcare Research, New Zealand


From tom.richardson at bristol.ac.uk  Sat Feb 26 16:56:51 2011
From: tom.richardson at bristol.ac.uk (Tom_R)
Date: Sat, 26 Feb 2011 07:56:51 -0800
Subject: [R-sig-Geo] estUDm not accepted by kerneloverlaphr
Message-ID: <1298735811164-6067843.post@n2.nabble.com>

Hi List!
I converting my script from the old adehabitat to adehabitatHR and
adehabitatTR, in order to take advantage of the Biased Random Bridge
utilisation distribution estimation techniques.
However, the BRB (in adehabitatHR) outputs an "estUDm" object, which
kerneloverlaphr doesn't accept; it only accepts khrud or kbbrud objects
(from the original adehabitat).
It seems that adehabitatHR provides the facility to  converting khrud to
estudm, using "khr2estUDm" but not the reverse. Also, adehabitatHR doesn't
seem to include a newer version of kerneloverlaphr...

So my question is simple; how do I persuade adehabitat's kerneloveraphr to
accept adehabitatHR's estUDm objects?   

Many thanks !

Reproducible code :

library(adehabitat)
library(adehabitatHR)

x<- runif(100)
y<-runif(100)
z<- seq(1:100)
xy <- as.matrix(data.frame(cbind(x,y)))
id <- as.factor(c(rep(1,50),rep(2,50)))
class(z) <- "POSIXct"	
traject <- as.ltraj( xy, z, id, typeII=TRUE )
traject <- rec(traject)

D <- BRB.D(traject, Tmax=100, Lmin=0.05)
UD <- BRB(traject, D, tau=1, Tmax=100, Lmin=0.05, hmin=0.2) ## Biased random
bridge

contr1 <- getverticeshr(UD[[1]], lev =50)
contr2 <- getverticeshr(UD[[2]], lev =50)
plot(contr1, add=TRUE, col=rgb(0,0,0,0.2))  ## plot
plot(contr2, add=TRUE, col=rgb(0,0,0,0.2))

overlap <- kerneloverlaphr(UD, method = "UDOI")   ## ERROR: need to convert
estUDm to khrud or kbbrud






-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/estUDm-not-accepted-by-kerneloverlaphr-tp6067843p6067843.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From clement.calenge at oncfs.gouv.fr  Sat Feb 26 17:55:36 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Sat, 26 Feb 2011 17:55:36 +0100
Subject: [R-sig-Geo] estUDm not accepted by kerneloverlaphr
In-Reply-To: <1298735811164-6067843.post@n2.nabble.com>
References: <1298735811164-6067843.post@n2.nabble.com>
Message-ID: <4D693088.3040500@oncfs.gouv.fr>

On 02/26/2011 04:56 PM, Tom_R wrote:
> Hi List!
> I converting my script from the old adehabitat to adehabitatHR and
> adehabitatTR, in order to take advantage of the Biased Random Bridge
> utilisation distribution estimation techniques.
> However, the BRB (in adehabitatHR) outputs an "estUDm" object, which
> kerneloverlaphr doesn't accept; it only accepts khrud or kbbrud objects
> (from the original adehabitat).
> It seems that adehabitatHR provides the facility to  converting khrud to
> estudm, using "khr2estUDm" but not the reverse. Also, adehabitatHR doesn't
> seem to include a newer version of kerneloverlaphr...
>
> So my question is simple; how do I persuade adehabitat's kerneloveraphr to
> accept adehabitatHR's estUDm objects?

You're right, I forgot to program kerneloverlaphr in the new version.
It will be in the next version of HR.
Here is the code, where x is an object of class "estUDm":

kerneloverlaphr <- function (x, method = c("HR", "PHR", "VI", "BA", 
"UDOI", "HD"),
                            percent = 95, conditional = FALSE, ...)
{
     method <- match.arg(method)
     if (!inherits(x, "estUDm"))
         stop("x should be of class estUDm")
     if (length(x)==1)
         stop("several animals are needed for this function")
     if (slot(x[[1]],"vol"))
         stop("x should not be a volume under UD")
     vol <- getvolumeUD(x)
     gp <- gridparameters(vol[[1]])
     res <- matrix(0, ncol = length(x), nrow = length(x))
     for (i in 1:length(x)) {
         for (j in 1:i) {
             if (method == "HR") {
                 vi <- as.data.frame(vol[[i]])[, 1]
                 vj <- as.data.frame(vol[[j]])[, 1]
                 vi[vi <= percent] <- 1
                 vi[vi > percent] <- 0
                 vj[vj <= percent] <- 1
                 vj[vj > percent] <- 0
                 vk <- vi * vj
                 res[i, j] <- sum(vk)/sum(vi)
                 res[j, i] <- sum(vk)/sum(vj)
             }
             if (method == "PHR") {
                 vi <- as.data.frame(x[[i]])[, 1]
                 vj <- as.data.frame(x[[j]])[, 1]
                 ai <- as.data.frame(vol[[i]])[, 1]
                 aj <- as.data.frame(vol[[j]])[, 1]
                 ai[ai <= percent] <- 1
                 ai[ai > percent] <- 0
                 aj[aj <= percent] <- 1
                 aj[aj > percent] <- 0
                 if (conditional) {
                   vi <- vi * ai
                   vj <- vj * aj
                   res[j, i] <- sum(vi * aj) * (gp[1, 2]^2)
                   res[i, j] <- sum(vj * ai) * (gp[1, 2]^2)
                 }
                 else {
                   res[j, i] <- sum(vi * aj) * (gp[1, 2]^2)
                   res[i, j] <- sum(vj * ai) * (gp[1, 2]^2)
                 }
             }
             if (method == "VI") {
                 vi <- c(as.data.frame(x[[i]])[, 1])
                 vj <- c(as.data.frame(x[[j]])[, 1])
                 ai <- as.data.frame(vol[[i]])[, 1]
                 aj <- as.data.frame(vol[[j]])[, 1]
                 ai[ai <= percent] <- 1
                 ai[ai > percent] <- 0
                 aj[aj <= percent] <- 1
                 aj[aj > percent] <- 0
                 if (conditional) {
                   vi <- vi * ai
                   vj <- vj * aj
                   res[i, j] <- res[j, i] <- sum(pmin(vi, vj)) *
                     (gp[1, 2]^2)
                 }
                 else {
                   res[i, j] <- res[j, i] <- sum(pmin(vi, vj)) *
                     (gp[1, 2]^2)
                 }
             }
             if (method == "BA") {
                 vi <- c(as.data.frame(x[[i]])[, 1])
                 vj <- c(as.data.frame(x[[j]])[, 1])
                 ai <- as.data.frame(vol[[i]])[, 1]
                 aj <- as.data.frame(vol[[j]])[, 1]
                 ai[ai <= percent] <- 1
                 ai[ai > percent] <- 0
                 aj[aj <= percent] <- 1
                 aj[aj > percent] <- 0
                 if (conditional) {
                   vi <- vi * ai
                   vj <- vj * aj
                   res[j, i] <- res[i, j] <- sum(sqrt(vi) * sqrt(vj)) *
                     (gp[1, 2]^2)
                 }
                 else {
                   res[j, i] <- res[i, j] <- sum(sqrt(vi) * sqrt(vj)) *
                     (gp[1, 2]^2)
                 }
             }
             if (method == "UDOI") {
                 vi <- c(as.data.frame(x[[i]])[, 1])
                 vj <- c(as.data.frame(x[[j]])[, 1])
                 ai <- as.data.frame(vol[[i]])[, 1]
                 aj <- as.data.frame(vol[[j]])[, 1]
                 ai[ai <= percent] <- 1
                 ai[ai > percent] <- 0
                 aj[aj <= percent] <- 1
                 aj[aj > percent] <- 0
                 if (conditional) {
                   vi <- vi * ai
                   vj <- vj * aj
                   ak <- sum(ai * aj) * (gp[1, 2]^2)
                   res[j, i] <- res[i, j] <- ak * sum(vi * vj) *
                     (gp[1, 2]^2)
                 }
                 else {
                   ak <- sum(ai * aj) * (gp[1, 2]^2)
                   res[j, i] <- res[i, j] <- ak * sum(vi * vj) *
                     (gp[1, 2]^2)
                 }
             }
             if (method == "HD") {
                 vi <- c(as.data.frame(x[[i]])[, 1])
                 vj <- c(as.data.frame(x[[j]])[, 1])
                 ai <- as.data.frame(vol[[i]])[, 1]
                 aj <- as.data.frame(vol[[j]])[, 1]
                 ai[ai <= percent] <- 1
                 ai[ai > percent] <- 0
                 aj[aj <= percent] <- 1
                 aj[aj > percent] <- 0
                 if (conditional) {
                   vi <- vi * ai
                   vj <- vj * aj
                   res[j, i] <- res[i, j] <- sqrt(sum((sqrt(vi) -
                     sqrt(vj))^2 * (gp[1, 2]^2)))
                 }
                 else {
                   res[j, i] <- res[i, j] <- sqrt(sum((sqrt(vi) -
                     sqrt(vj))^2 * (gp[1, 2]^2)))
                 }
             }
         }
     }
     rownames(res) <- names(x)
     colnames(res) <- names(x)
     return(res)
}







>
> Many thanks !
>
> Reproducible code :
>
> library(adehabitat)
> library(adehabitatHR)
>
> x<- runif(100)
> y<-runif(100)
> z<- seq(1:100)
> xy<- as.matrix(data.frame(cbind(x,y)))
> id<- as.factor(c(rep(1,50),rep(2,50)))
> class(z)<- "POSIXct"	
> traject<- as.ltraj( xy, z, id, typeII=TRUE )
> traject<- rec(traject)
>
> D<- BRB.D(traject, Tmax=100, Lmin=0.05)
> UD<- BRB(traject, D, tau=1, Tmax=100, Lmin=0.05, hmin=0.2) ## Biased random
> bridge
>
> contr1<- getverticeshr(UD[[1]], lev =50)
> contr2<- getverticeshr(UD[[2]], lev =50)
> plot(contr1, add=TRUE, col=rgb(0,0,0,0.2))  ## plot
> plot(contr2, add=TRUE, col=rgb(0,0,0,0.2))
>
> overlap<- kerneloverlaphr(UD, method = "UDOI")   ## ERROR: need to convert
> estUDm to khrud or kbbrud
>
>
>
>
>
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From tom.richardson at bristol.ac.uk  Sun Feb 27 01:00:17 2011
From: tom.richardson at bristol.ac.uk (Tom_R)
Date: Sat, 26 Feb 2011 16:00:17 -0800
Subject: [R-sig-Geo] estUDm not accepted by kerneloverlaphr
In-Reply-To: <4D693088.3040500@oncfs.gouv.fr>
References: <1298735811164-6067843.post@n2.nabble.com>
	<4D693088.3040500@oncfs.gouv.fr>
Message-ID: <1298764817262-6069066.post@n2.nabble.com>

perfect, thankyou!

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/estUDm-not-accepted-by-kerneloverlaphr-tp6067843p6069066.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From david.holstius at berkeley.edu  Sun Feb 27 01:56:13 2011
From: david.holstius at berkeley.edu (David Holstius)
Date: Sat, 26 Feb 2011 16:56:13 -0800
Subject: [R-sig-Geo] best data model for line segments with multiple
	attributes?
Message-ID: <C72882AE-5B96-4771-B69C-5D861043338C@berkeley.edu>

Dear all,

I'm in need of a suitable class for representing individual line segments with multiple attributes. It's for the public interface to a line source dispersion modeling package (on R-forge as "Rcaline"), so I'd like it to be moderately future-proof if possible.

The spatstat2::psp class is closest to what I'm looking for, except it doesn't exist (yet?). :-)

Can you offer advice? Should I build off of sp::SpatialLinesDataFrame? If so, should I rely on subclassing, delegation, or some other design pattern? Most of my experience in programming has been in Python, so I'm less familiar with best practices/idioms in R. (I'm learning about S4 and reference classes, but slowly.)

Or maybe I need a SpatialLineDataFrame (without the "s"!)?

Building on the considerable work of others in 'sp' and 'spatstat' has been of great use so far. I thank you for your time & attention, and I apologize if this has come up before. I have not been able to find anything and am new to r-sig-geo.

Very best,
David

--
David Holstius
PhD Student in Environmental Health Sciences
UC Berkeley School of Public Health


From lists at remoteinformation.com.au  Sun Feb 27 22:39:32 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Mon, 28 Feb 2011 05:39:32 +0800
Subject: [R-sig-Geo] Differences Between sp and spatstat?
In-Reply-To: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>
References: <alpine.LNX.2.00.1102250802080.11041@salmo.appl-ecosys.com>
Message-ID: <A8D719A0-107D-4388-A633-A12BCD3CF829@remoteinformation.com.au>

I'm not an expert in this, but one of the important aspects of sp is that it provides a set of classes for consistently handling spatial data. Other packages (such as spatstat) provide more specific analytic capacity. Even if the more specific packages use their own classes, there is now at least a 'common' data structure with which you can import data to R and make it available to other packages.

In a nutshell, you will probably find that many other spatial packages require sp.

I would suggest looking at http://cran.r-project.org/web/views/Spatial.html

cheers

Ben


On 26/02/2011, at 12:10 AM, Rich Shepard wrote:

>  I'm brand-new to R and my specific interest is spatial statistics and the
> integration of R and GRASS. I just bought a copy of "Applied Spatial
> Analysis with R" and have started reading it.
> 
>  I've used GRASS on linux since the mid-1990s (and Microsoft-based GIS
> since the mid-1980s) and statistics in my academic and real-world work since
> the the early 1970s, so my ignorance is specific to R and spatial statistics
> with it. I'm a stream ecologist/fluvial geomorphologist, run my own
> consultancy, and focus on the natural resource industries.
> 
>  The book references the sp package and I find another called spatstat.
> What are the differences between them?
> 
>  I've also just signed up to subscribe to the R-help mail list because I
> need to learn how to install packages (the instructions in the book for ctv,
> and those I found on someone's Web site) aren't working for me.
> 
>  While I'll be asking a lot of questions at first I expect to be providing
> answers and insights before too long.
> 
> Rich
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Sun Feb 27 23:16:47 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 27 Feb 2011 23:16:47 +0100
Subject: [R-sig-Geo] best data model for line segments with
	multiple	attributes?
In-Reply-To: <C72882AE-5B96-4771-B69C-5D861043338C@berkeley.edu>
References: <C72882AE-5B96-4771-B69C-5D861043338C@berkeley.edu>
Message-ID: <4D6ACD4F.3060504@uni-muenster.de>



On 02/27/2011 01:56 AM, David Holstius wrote:
> Or maybe I need a SpatialLineDataFrame (without the "s"!)?

If it is convenient for your problem, I would start with the
SpatialLinesDataFrame, as it is there right now and allows you to do
several things that might be useful to you or others. Then, continue
working on another, possibly derived, class, when the need arises.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jacobvanetten at yahoo.com  Sun Feb 27 23:37:20 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Sun, 27 Feb 2011 22:37:20 +0000 (GMT)
Subject: [R-sig-Geo] neighbour patches
In-Reply-To: <4D68B1A5.6030603@univ-fcomte.fr>
Message-ID: <58056.46113.qm@web29710.mail.ird.yahoo.com>

Hi Patrick,

Nice question. This would be my approach:

#------------------------

library(raster)

#make "patches"
r <- raster(ncols=10, nrows=10)
r[] <- round(runif(ncell(r))*0.7)
rc <- clump(r)

#take a look
plot(rc)

#some preparation
n <- max(getValues(rc),na.rm=TRUE)
m <- matrix(NA,n,n)

#now calculate distances
for(i in 1:n)
{
  gd <- gridDistance(rc, origin=i)
  m[,i] <- zonal(gd, rc, min)[,2]
}

#and voil?
m <- as.dist(m)
m

#------------------------

Alternatively, you could use the function distance() instead of gridDistance(). The advantage of gridDistance() is that you can indicate if animals can or cannot move through certain areas (optional argument 'omit', now not used). The disadvantage is that it is less precise than distance() -- it creates 'hexagonal' distance patterns.

Jacob.

--- On Sat, 26/2/11, Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr> wrote:

> From: Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr>
> Subject: [R-sig-Geo] neighbour patches
> To: r-sig-geo at r-project.org
> Date: Saturday, 26 February, 2011, 8:54
> Hi,
> 
> I am tempted to dig in graph theory and analyse connections
> between discrete landscape patches. Re-reading 'Applied
> Spatial Data Analysis with R' I was happy to find basics
> chapter 9. However, it reports on graphs where (euclidian)
> distance is computed between patch centroids.
> 
> Does anybody have an idea about strategies or packages
> permitting to use the shortest distance between patch
> borders instead (which is more realistic with regard to
> animal movement) ?
> 
> Patrick
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


    

From Roger.Bivand at nhh.no  Sun Feb 27 23:52:42 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 27 Feb 2011 23:52:42 +0100 (CET)
Subject: [R-sig-Geo] neighbour patches
In-Reply-To: <4D68B1A5.6030603@univ-fcomte.fr>
References: <4D68B1A5.6030603@univ-fcomte.fr>
Message-ID: <alpine.LRH.2.00.1102272347080.359@reclus.nhh.no>

On Sat, 26 Feb 2011, Patrick Giraudoux wrote:

> Hi,
>
> I am tempted to dig in graph theory and analyse connections between discrete 
> landscape patches. Re-reading 'Applied Spatial Data Analysis with R' I was 
> happy to find basics chapter 9. However, it reports on graphs where 
> (euclidian) distance is computed between patch centroids.
>
> Does anybody have an idea about strategies or packages permitting to use the 
> shortest distance between patch borders instead (which is more realistic with 
> regard to animal movement) ?
>

If the patches are Polygons objects in a SpatialPolygons object, the 
gDistance() function in rgeos on R-Forge does this for planar coordinates, 
for example:

gDistance(SP, SP, byid=TRUE)

returns a square distance matrix.

Roger

> Patrick
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From sadz_a1000 at yahoo.co.uk  Mon Feb 28 01:54:32 2011
From: sadz_a1000 at yahoo.co.uk (Sadz A)
Date: Mon, 28 Feb 2011 00:54:32 +0000 (GMT)
Subject: [R-sig-Geo] predict a map from point data
Message-ID: <63848.55332.qm@web24603.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110228/2c65c8af/attachment.pl>

From tom.gottfried at wzw.tum.de  Mon Feb 28 10:41:25 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 28 Feb 2011 10:41:25 +0100
Subject: [R-sig-Geo] predict a map from point data
In-Reply-To: <63848.55332.qm@web24603.mail.ird.yahoo.com>
References: <63848.55332.qm@web24603.mail.ird.yahoo.com>
Message-ID: <4D6B6DC5.6010401@wzw.tum.de>

Hi Sadz,

Am 28.02.2011 01:54, schrieb Sadz A:
> Hi, 
> 
> I'm trying to predict the distribution of timber over an area, I have point 
> location data- so it would make sense to use a krigging to interpolate the data 
> over the whole map. Unfortunately the krigging predictions are pretty bad. 

What does "pretty bad" mean? What did you actually do? There are many "flavours" of doing kriging
including variogram estimation and modelling. E.g. you seem to interpolate volume data, so I suppose
your "point location data" actually represent a volume too. Sounds like fitting a Gau?ian model and
doing block kriging could be appropriate.

> 
> I have now got environmental data for my study site and have used the r package 
> 'quantreg' to make a model that I can predict the volume from 
> R code:
> fit <- rqss(sum_vol~qss(env.factor1,lambda=1)+ qss(env.factor2,lambda=1), tau = 
> 0.9)
> predi<-predict(fit, new, interval = "none", level = 0.9)

Do you mean you have any covariates? Maybe multivariable geostatistics (the gstat package) are your
friend.

> 
> unfortunately this is not working either (a problem with the predict function). 
> I have also tried linear modelling, Gams and inverse interpolations. 

Any errors, traceback()?

regards,
Tom

> 
> Does anyone have any ideas on how I could get a spatial map of volume 
> distribution from the point data?
> 
> Any help is appreciated, 
> thank you
> sadz
> 
> ps- if anything is unclear I would be happy to clarify
> 
> 
> 
>       
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From rhunne at mac.com  Mon Feb 28 16:59:34 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Mon, 28 Feb 2011 15:59:34 +0000 (GMT)
Subject: [R-sig-Geo] extracting coordinates
Message-ID: <db883067-e79f-6fe7-e5a0-bfbf036efa45@me.com>

Hi,

I'm going through some initial data inspection, and working through steps in the "Applied Spatial Data analysis with R" book.?
Following steps in Ch.  2 of the "Applied Spatial Data analysis with R" book, I was able to extract a set of coordinates from my
SpatialPoints object just fine. The object returned looks right - the coordinates are extracted correctly, but my bounding box does?
not change. The same min/max for coords.x1 and x2 get returned instead of a new bounding box that reflects the selection.

Not sure what I'm missing, would appreciate any help - I apologize if this is overly simple!
thanks,
Robin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110228/46f25a6b/attachment.html>

From edzer.pebesma at uni-muenster.de  Mon Feb 28 18:04:40 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 28 Feb 2011 18:04:40 +0100
Subject: [R-sig-Geo] extracting coordinates
In-Reply-To: <db883067-e79f-6fe7-e5a0-bfbf036efa45@me.com>
References: <db883067-e79f-6fe7-e5a0-bfbf036efa45@me.com>
Message-ID: <4D6BD5A8.9020908@uni-muenster.de>



On 02/28/2011 04:59 PM, Robin W Hunnewell wrote:
> Hi,
> 
> I'm going through some initial data inspection, and working through steps in the 
> "Applied Spatial Data analysis with R" book.
> Following steps in Ch. 2 of the "Applied Spatial Data analysis with R" book, I 
> was able toextract a set of coordinates from my
> SpatialPoints object just fine. The object returned looks right - the 
> coordinates are extracted correctly, but my bounding box does
> not change. The same min/max for coords.x1 and x2 get returned instead of a new 
> bounding box that reflects the selection.

I can't reproduce this:

> library(sp)
> data(meuse)
> coordinates(meuse)=~x+y
> bbox(meuse)
     min    max
x 178605 181390
y 329714 333611
> bbox(meuse[1,])
     min    max
x 181072 181072
y 333611 333611

> 
> Not sure what I'm missing, would appreciate any help - I apologize if this is 
> overly simple!

It helps if you send us the commands that lets one can reproduce what
you did, preferably with data that are available to everyone. This helps
us to understand your question.

> thanks,
> Robin
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at wzw.tum.de  Mon Feb 28 18:05:21 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 28 Feb 2011 18:05:21 +0100
Subject: [R-sig-Geo] extracting coordinates
In-Reply-To: <db883067-e79f-6fe7-e5a0-bfbf036efa45@me.com>
References: <db883067-e79f-6fe7-e5a0-bfbf036efa45@me.com>
Message-ID: <4D6BD5D1.9000705@wzw.tum.de>

Hi Robin,

could you please post some example code (possibly self-contained, e.g. with meuse data)?
So it's less guessing what you actually did. More on this topic:
http://www.r-project.org/posting-guide.html

regards,
Tom

Am 28.02.2011 16:59, schrieb Robin W Hunnewell:
> Hi,
> 
> I'm going through some initial data inspection, and working through
> steps in the "Applied Spatial Data analysis with R" book. 
> Following steps in Ch. 2 of the "Applied Spatial Data analysis with R"
> book, I was able to extract a set of coordinates from my
> SpatialPoints object just fine. The object returned looks right - the
> coordinates are extracted correctly, but my bounding box does 
> not change. The same min/max for coords.x1 and x2 get returned instead
> of a new bounding box that reflects the selection.
> 
> Not sure what I'm missing, would appreciate any help - I apologize if
> this is overly simple!
> thanks,
> Robin
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From rhunne at mac.com  Mon Feb 28 18:33:21 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Mon, 28 Feb 2011 17:33:21 +0000 (GMT)
Subject: [R-sig-Geo] extracting coordinates
Message-ID: <e9518600-4111-62dc-c089-a6a8b904d67b@me.com>

Hi again,
Thanks, sorry about that - here is the code to illustrate what I did -?following the ASDAR book example of choosing a subset of coordinates in Brazil:

> brazil
[1] 4 5 6 7 8
> coordinates(CRAN_sp[brazil, ])
??coords.x1 coords.x2
4 -49.26667 -25.41667
5 -42.86667 -20.75000
6 -43.20000 -22.90000
7 -47.63333 -22.71667
8 -46.63333 -23.53333
> summary(CRAN_sp[brazil, ])
Object of class SpatialPoints
Coordinates:
?? ? ? ? ? ? ? ? min ? ? ?max
coords.x1 -122.95000 153.0333
coords.x2 ?-37.81667 ?57.0500
Is projected: FALSE?
proj4string : [+proj=longlat +ellps=WGS84]
Number of points: 5

> summary(CRAN_sp)
Object of class SpatialPoints
Coordinates:
?? ? ? ? ? ? ? ? min ? ? ?max
coords.x1 -122.95000 153.0333
coords.x2 ?-37.81667 ?57.0500
Is projected: FALSE?
proj4string : [+proj=longlat +ellps=WGS84]
Number of points: 54

??
My problem is: the object "brazil" should have a new bounding box -- as it does in the ASDAR book example text. But when I do it, the bounding box remains identical to the original one for CRAN_sp.
Sorry for the confusion, thanks greatly for any help.
Robin



Begin forwarded message:

From: Tom Gottfried <tom.gottfried at wzw.tum.de>
Date: February 28, 2011 1:05:21 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] extracting coordinates

Hi Robin,

could you please post some example code (possibly self-contained, e.g. with meuse data)?
So it's less guessing what you actually did. More on this topic:
http://www.r-project.org/posting-guide.html

regards,
Tom

Am 28.022011 16:59, schrieb Robin W Hunnewell:
> Hi,
> 
> I'm going through some initial data inspection, and working through
> steps in the "Applied Spatial Data analysis with R" book. 
> Following steps in Ch. 2 of the "Applied Spatial Data analysis with R"
> book, I was able to extract a set of coordinates from my
> SpatialPoints object just fine. The object returned looks right - the
> coordinates are extracted correctly, but my bounding box does 
> not change. The same min/max for coords.x1 and x2 get returned instead
> of a new bounding box that reflects the selection.
> 
> Not sure what I'm missing, would appreciate any help - I apologize if
> this is overly simple!
> thanks,
> Robin
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax: ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110228/84c6d8a9/attachment.html>

From Roger.Bivand at nhh.no  Mon Feb 28 21:35:41 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 28 Feb 2011 21:35:41 +0100 (CET)
Subject: [R-sig-Geo] extracting coordinates
In-Reply-To: <e9518600-4111-62dc-c089-a6a8b904d67b@me.com>
References: <e9518600-4111-62dc-c089-a6a8b904d67b@me.com>
Message-ID: <alpine.LRH.2.00.1102282131280.22916@reclus.nhh.no>

On Mon, 28 Feb 2011, Robin W Hunnewell wrote:

> Hi again,
> Thanks, sorry about that - here is the code to illustrate what I did 
> -?following the ASDAR book example of choosing a subset of coordinates in 
> Brazil:

Thanks for a clear report, this was a bug introduced three months ago. A 
patched sp can be downloaded from late evening tomorrow at SVN revision 
1037 from R-Forge, either

install.packages("sp", repos="http://R-Forge.R-project.org")

or visit

https://r-forge.r-project.org/R/?group_id=1014

and download manually. I'm sorry I didn't make this evening's pickup at 
20:30 CET.

Roger

>
>> brazil
> [1] 4 5 6 7 8
>> coordinates(CRAN_sp[brazil, ])
> ??coords.x1 coords.x2
> 4 -49.26667 -25.41667
> 5 -42.86667 -20.75000
> 6 -43.20000 -22.90000
> 7 -47.63333 -22.71667
> 8 -46.63333 -23.53333
>> summary(CRAN_sp[brazil, ])
> Object of class SpatialPoints
> Coordinates:
> ?? ? ? ? ? ? ? ? min ? ? ?max
> coords.x1 -122.95000 153.0333
> coords.x2 ?-37.81667 ?57.0500
> Is projected: FALSE?
> proj4string : [+proj=longlat +ellps=WGS84]
> Number of points: 5
>
>> summary(CRAN_sp)
> Object of class SpatialPoints
> Coordinates:
> ?? ? ? ? ? ? ? ? min ? ? ?max
> coords.x1 -122.95000 153.0333
> coords.x2 ?-37.81667 ?57.0500
> Is projected: FALSE?
> proj4string : [+proj=longlat +ellps=WGS84]
> Number of points: 54
>
> ??
> My problem is: the object "brazil" should have a new bounding box -- as it 
> does in the ASDAR book example text. But when I do it, the bounding box 
> remains identical to the original one for CRAN_sp.
> Sorry for the confusion, thanks greatly for any help.
> Robin
>
>
>
> Begin forwarded message:
>
> From: Tom Gottfried <tom.gottfried at wzw.tum.de>
> Date: February 28, 2011 1:05:21 PM
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] extracting coordinates
>
> Hi Robin,
>
> could you please post some example code (possibly self-contained, e.g. with 
> meuse data)?
> So it's less guessing what you actually did. More on this topic:
> http://www.r-project.org/posting-guide.html
>
> regards,
> Tom
>
> Am 28.022011 16:59, schrieb Robin W Hunnewell:
>> Hi,
>> 
>> I'm going through some initial data inspection, and working through
>> steps in the "Applied Spatial Data analysis with R" book. Following steps 
>> in Ch. 2 of the "Applied Spatial Data analysis with R"
>> book, I was able to extract a set of coordinates from my
>> SpatialPoints object just fine. The object returned looks right - the
>> coordinates are extracted correctly, but my bounding box does not change. 
>> The same min/max for coords.x1 and x2 get returned instead
>> of a new bounding box that reflects the selection.
>> 
>> Not sure what I'm missing, would appreciate any help - I apologize if
>> this is overly simple!
>> thanks,
>> Robin
>> 
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

