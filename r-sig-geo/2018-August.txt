From yu@ter0 @ending from gm@il@com  Thu Aug  2 10:53:02 2018
From: yu@ter0 @ending from gm@il@com (Yuster Ronoh)
Date: Thu, 2 Aug 2018 11:53:02 +0300
Subject: [R-sig-Geo] How to install sf r package in linux mint v 19.1 64 bit
Message-ID: <CAP6hh3-8pD5=pf57Dnz91T2RXNk6wbEbpVZVcHPA2jZy-TejJw@mail.gmail.com>

I am not making head way on installing sf package  on R vs 3.4.4

and this is the error I am getting:

configure error: libroj not found in standard or given locations

Error: configuration failed for package ?sf?

  * removing ?/home/feltp/R/x86_64-pc-linux-library/3.4.sf?

Warning in install.packages :

       installation of ?sf? had non-zero exit status


The downloaded source packages are in

        ?/tmp/RtmpSyJk3r/downloaded_packages?
Regards.

*Yuster Ronoh* | County Epidemiologists | *Nakuru County Health
Department *| Club
Road, Regional Commissioner HQs, Block 'B' 2nd Floor

P.O. Box 2060 - 20100 * Nakuru*| Mobile +254724305899/ +254733573770 |
Skype: yronoh

	[[alternative HTML version deleted]]


From engli@hchri@topher@ @ending from gm@il@com  Thu Aug  2 15:22:25 2018
From: engli@hchri@topher@ @ending from gm@il@com (chris english)
Date: Thu, 2 Aug 2018 09:22:25 -0400
Subject: [R-sig-Geo] 
 How to install sf r package in linux mint v 19.1 64 bit
In-Reply-To: <CAP6hh3-8pD5=pf57Dnz91T2RXNk6wbEbpVZVcHPA2jZy-TejJw@mail.gmail.com>
References: <CAP6hh3-8pD5=pf57Dnz91T2RXNk6wbEbpVZVcHPA2jZy-TejJw@mail.gmail.com>
Message-ID: <CAASFQpRec=iVnjYa5vDhU2ATTTUhqiE2gU63gJo2T056oF0G+g@mail.gmail.com>

Yuster,

Perhaps you don't have libproj-dev installed, though you probably do, but
if not:

sudo apt-get install libproj-dev

then help your system tell where things are located with:

export LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib

these advice from:

https://gis.stackexchange.com/questions/157059/repairing-broken-gdal-and-proj-4-on-ubuntu

HTH,

Chris

ug 2, 2018 at 4:53 AM, Yuster Ronoh <yuster0 at gmail.com> wrote:

> I am not making head way on installing sf package  on R vs 3.4.4
>
> and this is the error I am getting:
>
> configure error: libroj not found in standard or given locations
>
> Error: configuration failed for package ?sf?
>
>   * removing ?/home/feltp/R/x86_64-pc-linux-library/3.4.sf?
>
> Warning in install.packages :
>
>        installation of ?sf? had non-zero exit status
>
>
> The downloaded source packages are in
>
>         ?/tmp/RtmpSyJk3r/downloaded_packages?
> Regards.
>
> *Yuster Ronoh* | County Epidemiologists | *Nakuru County Health
> Department *| Club
> Road, Regional Commissioner HQs, Block 'B' 2nd Floor
>
> P.O. Box 2060 - 20100 * Nakuru*| Mobile +254724305899/ +254733573770 |
> Skype: yronoh
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Sun Aug  5 15:30:02 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Sun, 5 Aug 2018 15:30:02 +0200
Subject: [R-sig-Geo] CRAN OSX rgdal binaries 1.3-3 and 1.3-4
Message-ID: <alpine.LFD.2.21.1808051528520.7846@reclus.nhh.no>

The CRAN OSX rgdal binaries 1.3-3 and 1.3-4 do not include PROJ datum
metadata files. To check whether your OSX binary rgdal has the PROJ datum
metadata files, try:

library(rgdal)
projNAD()

If they are not present, consider running this snippet:

pkg <- "rgdal"
exdir <- file.path(system.file(package=pkg), "proj")
list.files(exdir)
tf <- tempfile()
fl <- "http://download.osgeo.org/proj/proj-datumgrid-1.7.zip"
download.file(fl, tf)
unzip(tf, exdir=exdir)
list.files(exdir)

Hope this helps,

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From p@trick@@chr@tz @ending from gm@il@com  Mon Aug  6 10:38:41 2018
From: p@trick@@chr@tz @ending from gm@il@com (Patrick Schratz)
Date: Mon, 6 Aug 2018 10:38:41 +0200
Subject: [R-sig-Geo] rgdal with R > 3.5.x and GDAL > 2.3.x on macOS
Message-ID: <1533543467.local-a91d34ea-ad39-v1.3.0-fd741eb7@getmailspring.com>

Hi,

desperately trying to get rgdal installed on R > 3.5.x with GDAL 2.3.0 on macOS High Sierra.
I am aware of the discussion that a suitable compiler is needed since GDAL > 2.3.0.

I've set
CC=clang
CXX=clang++
PKG_CXXFLAGS= -stdlib=libc++ -std=c++11

In ~/.R/Makevars as suggested here https://github.com/r-spatial/sf/issues/726
The automated checking during the rgdal installation shows that C++11 support is available.
But still it complains about a lacking C++11 support.
I've searched the web but could not find anything helpful. If I've overlooked something, please just point me to the link.

Everything installed via homebrew (bottles)
R 3.5.1
proj 5.1.0 (osgeo4mac)
gdal 2.3.1 (homebrew core)

macOS 10.13.1 (High Sierra)
> install.packages("rgdal")
Installing package into ?/usr/local/lib/R/3.5/site-library?
(as ?lib? is unspecified)
trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
configure: CC: clang
configure: CXX: clang++
configure: C++11 support available
configure: rgdal: 1.3-4
checking for /usr/bin/svnversion... yes
configure: svn revision: 766
checking for gdal-config... /usr/local/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.3.1
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
In file included from gdal_test.cc:1:
In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
/usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
# error Must have C++11 or newer.
^
1 error generated.
In file included from gdal_test.cc:1:
In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
/usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
# error Must have C++11 or newer.
^
1 error generated.
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/local/lib/R/3.5/site-library/rgdal?
Warning in install.packages :
installation of package ?rgdal? had non-zero exit status

The downloaded source packages are in
?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
> install.packages("rgdal")
Installing package into ?/usr/local/lib/R/3.5/site-library?
(as ?lib? is unspecified)
trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
configure: CC: clang
configure: CXX: clang++
configure: C++11 support available
configure: rgdal: 1.3-4
checking for /usr/bin/svnversion... yes
configure: svn revision: 766
checking for gdal-config... /usr/local/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.3.1
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
In file included from gdal_test.cc:1:
In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
/usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
# error Must have C++11 or newer.
^
1 error generated.
In file included from gdal_test.cc:1:
In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
/usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
# error Must have C++11 or newer.
^
1 error generated.
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/local/lib/R/3.5/site-library/rgdal?
Warning in install.packages :
installation of package ?rgdal? had non-zero exit status

The downloaded source packages are in
?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?


	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Mon Aug  6 11:05:54 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Mon, 6 Aug 2018 11:05:54 +0200
Subject: [R-sig-Geo] rgdal with R > 3.5.x and GDAL > 2.3.x on macOS
In-Reply-To: <1533543467.local-a91d34ea-ad39-v1.3.0-fd741eb7@getmailspring.com>
References: <1533543467.local-a91d34ea-ad39-v1.3.0-fd741eb7@getmailspring.com>
Message-ID: <alpine.LFD.2.21.1808061041170.12131@reclus.nhh.no>

See below inline:

On Mon, 6 Aug 2018, Patrick Schratz wrote:

> Hi,
>
> desperately trying to get rgdal installed on R > 3.5.x with GDAL 2.3.0 
> on macOS High Sierra. I am aware of the discussion that a suitable 
> compiler is needed since GDAL > 2.3.0.
>
> I've set
> CC=clang
> CXX=clang++
> PKG_CXXFLAGS= -stdlib=libc++ -std=c++11
>
> In ~/.R/Makevars as suggested here https://github.com/r-spatial/sf/issues/726

Does anyone actually know that this is a solution or rather the problem? 
Check:

$ R CMD config CXX
## clang++ -std=gnu++11
## for me with an R-devel clang build on Fedora 28

Run this and/or ./configure in the unpacked rgdal source tarball and 
report the CXX value. Is the issue advice wrong, and CXX should be 
'clang++ -std=gnu++11'?

I have no access to OSX (and no wish to have access) - the OSX users need 
to do a full bisection and not guess what is happening.

> The automated checking during the rgdal installation shows that C++11 
> support is available. But still it complains about a lacking C++11 
> support.

No, that is coming from code in GDAL itself, as you can see. You need to 
establish which --std= is actually needed.

> I've searched the web but could not find anything helpful. If I've 
> overlooked something, please just point me to the link.

Searching the web only confirms that there is very little signal there - 
search the source code instead, and bisection (which settings worked for 
which versions, and which changes provoke the issue)? Is for example the 
CRAN R binary reporting a different R CMD config CXX from your 
homebrew-built R?

>
> Everything installed via homebrew (bottles)
> R 3.5.1
> proj 5.1.0 (osgeo4mac)
> gdal 2.3.1 (homebrew core)
>
> macOS 10.13.1 (High Sierra)
>> install.packages("rgdal")
> Installing package into ?/usr/local/lib/R/3.5/site-library?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
> Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
> configure: CC: clang
> configure: CXX: clang++
> configure: C++11 support available
> configure: rgdal: 1.3-4
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 766
> checking for gdal-config... /usr/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.3.1
> checking C++11 support for GDAL >= 2.3.0... yes
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> In file included from gdal_test.cc:1:
> In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
> /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> # error Must have C++11 or newer.
> ^


From the GDAL 2.3.1 source at the given line number - your __cplusplus 
from homebrew's value needs checking:

/* MSVC fails to define a decent value of __cplusplus. Try to target 
VS2015*/
/* as a minimum */

#if defined(__cplusplus) && !defined(CPL_SUPRESS_CPLUSPLUS)
#  if !(__cplusplus >= 201103L || (defined(_MSC_VER) && _MSC_VER >= 1900))
#    error Must have C++11 or newer.
#  endif
#  if __cplusplus >= 201402L
#    define HAVE_CXX14 1
#  endif
/* TODO(schwehr): What is the correct test for C++ 17? */
#endif  /* __cplusplus */

Fallback is the CRAN OSX binary for rgdal 1.3-4 (with the addition of proj 
datum files as posted yesterday, or Kyngchaos (as on R-sig-mac).

Roger


> 1 error generated.
> In file included from gdal_test.cc:1:
> In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
> /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> # error Must have C++11 or newer.
> ^
> 1 error generated.
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
> Warning in install.packages :
> installation of package ?rgdal? had non-zero exit status
>
> The downloaded source packages are in
> ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
>> install.packages("rgdal")
> Installing package into ?/usr/local/lib/R/3.5/site-library?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
> Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
> configure: CC: clang
> configure: CXX: clang++
> configure: C++11 support available
> configure: rgdal: 1.3-4
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 766
> checking for gdal-config... /usr/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.3.1
> checking C++11 support for GDAL >= 2.3.0... yes
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> In file included from gdal_test.cc:1:
> In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
> /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> # error Must have C++11 or newer.
> ^
> 1 error generated.
> In file included from gdal_test.cc:1:
> In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
> /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> # error Must have C++11 or newer.
> ^
> 1 error generated.
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
> Warning in install.packages :
> installation of package ?rgdal? had non-zero exit status
>
> The downloaded source packages are in
> ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
>
>
> 	[[alternative HTML version deleted]]

Do not post HTML, only plain text.

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From p@trick@@chr@tz @ending from gm@il@com  Mon Aug  6 14:35:11 2018
From: p@trick@@chr@tz @ending from gm@il@com (Patrick Schratz)
Date: Mon, 6 Aug 2018 14:35:11 +0200
Subject: [R-sig-Geo] rgdal with R > 3.5.x and GDAL > 2.3.x on macOS
In-Reply-To: <alpine.LFD.2.21.1808061041170.12131@reclus.nhh.no>
References: <alpine.LFD.2.21.1808061041170.12131@reclus.nhh.no>
Message-ID: <1533548013.local-bbb84848-1076-v1.3.0-fd741eb7@getmailspring.com>

Hi Roger,

thanks for taking the time. To defend myself, I do not use macOS on a daily base and just run it in a VM for some package testing.
> Is the issue advice wrong, and CXX should be
> 'clang++ -std=gnu++11'?

This seems to be the problem. Using your configuration works!
I am aware of the small geospatial com on mac and that the osgeo4mac repo is not very stable. However I think there is a need for a short guide how to either use the kyngchaos frameworks or the osgeo4mac repo to have a stable geospatial toolset for R (starting with rgdal to sf and so on). Ideally for different R versions if major changes occured. A good place would be the README of rgdal if would be hosted on r-spatial on Github as most people would look there. As I saw in some issues, people sometimes think the cran/rgdal mirror is the place to go. But thats all just suggestions ;)
This little issue costed me at least 3h. Its really annyoing to have such issues on macOS from time to time (but ofc this is not your or anyone else fault).
Thanks again!!
Patrick

On Aug 6 2018, at 11:05 am, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> See below inline:
> On Mon, 6 Aug 2018, Patrick Schratz wrote:
> > Hi,
> > desperately trying to get rgdal installed on R > 3.5.x with GDAL 2.3.0
> > on macOS High Sierra. I am aware of the discussion that a suitable
> > compiler is needed since GDAL > 2.3.0.
> >
> > I've set
> > CC=clang
> > CXX=clang++
> > PKG_CXXFLAGS= -stdlib=libc++ -std=c++11
> >
> > In ~/.R/Makevars as suggested here https://github.com/r-spatial/sf/issues/726
> Does anyone actually know that this is a solution or rather the problem?
> Check:
>
> $ R CMD config CXX
> ## clang++ -std=gnu++11
> ## for me with an R-devel clang build on Fedora 28
>
> Run this and/or ./configure in the unpacked rgdal source tarball and
> report the CXX value. Is the issue advice wrong, and CXX should be
> 'clang++ -std=gnu++11'?
>
> I have no access to OSX (and no wish to have access) - the OSX users need
> to do a full bisection and not guess what is happening.
>
> > The automated checking during the rgdal installation shows that C++11
> > support is available. But still it complains about a lacking C++11
> > support.
>
>
> No, that is coming from code in GDAL itself, as you can see. You need to
> establish which --std= is actually needed.
>
> > I've searched the web but could not find anything helpful. If I've
> > overlooked something, please just point me to the link.
>
>
> Searching the web only confirms that there is very little signal there -
> search the source code instead, and bisection (which settings worked for
> which versions, and which changes provoke the issue)? Is for example the
> CRAN R binary reporting a different R CMD config CXX from your
> homebrew-built R?
>
> >
> > Everything installed via homebrew (bottles)
> > R 3.5.1
> > proj 5.1.0 (osgeo4mac)
> > gdal 2.3.1 (homebrew core)
> >
> > macOS 10.13.1 (High Sierra)
> > > install.packages("rgdal")
> >
> > Installing package into ?/usr/local/lib/R/3.5/site-library?
> > (as ?lib? is unspecified)
> > trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
> > Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
> > ==================================================
> > downloaded 1.6 MB
> >
> > * installing *source* package ?rgdal? ...
> > ** package ?rgdal? successfully unpacked and MD5 sums checked
> > configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
> > configure: CC: clang
> > configure: CXX: clang++
> > configure: C++11 support available
> > configure: rgdal: 1.3-4
> > checking for /usr/bin/svnversion... yes
> > configure: svn revision: 766
> > checking for gdal-config... /usr/local/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 2.3.1
> > checking C++11 support for GDAL >= 2.3.0... yes
> > checking GDAL version >= 1.11.4... yes
> > checking gdal: linking with --libs only... no
> > checking gdal: linking with --libs and --dep-libs... no
> > In file included from gdal_test.cc:1:
> > In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
> > /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> > # error Must have C++11 or newer.
> > ^
>
>
>
> From the GDAL 2.3.1 source at the given line number - your __cplusplus
> from homebrew's value needs checking:
>
> /* MSVC fails to define a decent value of __cplusplus. Try to target
> VS2015*/
> /* as a minimum */
>
> #if defined(__cplusplus) && !defined(CPL_SUPRESS_CPLUSPLUS)
> # if !(__cplusplus >= 201103L || (defined(_MSC_VER) && _MSC_VER >= 1900))
> # error Must have C++11 or newer.
> # endif
> # if __cplusplus >= 201402L
> # define HAVE_CXX14 1
> # endif
> /* TODO(schwehr): What is the correct test for C++ 17? */
> #endif /* __cplusplus */
>
> Fallback is the CRAN OSX binary for rgdal 1.3-4 (with the addition of proj
> datum files as posted yesterday, or Kyngchaos (as on R-sig-mac).
>
> Roger
>
> > 1 error generated.
> > In file included from gdal_test.cc:1:
> > In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
> > /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> > # error Must have C++11 or newer.
> > ^
> > 1 error generated.
> > configure: Install failure: compilation and/or linkage problems.
> > configure: error: GDALAllRegister not found in libgdal.
> > ERROR: configuration failed for package ?rgdal?
> > * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
> > Warning in install.packages :
> > installation of package ?rgdal? had non-zero exit status
> >
> > The downloaded source packages are in
> > ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
> > > install.packages("rgdal")
> >
> > Installing package into ?/usr/local/lib/R/3.5/site-library?
> > (as ?lib? is unspecified)
> > trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
> > Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
> > ==================================================
> > downloaded 1.6 MB
> >
> > * installing *source* package ?rgdal? ...
> > ** package ?rgdal? successfully unpacked and MD5 sums checked
> > configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
> > configure: CC: clang
> > configure: CXX: clang++
> > configure: C++11 support available
> > configure: rgdal: 1.3-4
> > checking for /usr/bin/svnversion... yes
> > configure: svn revision: 766
> > checking for gdal-config... /usr/local/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 2.3.1
> > checking C++11 support for GDAL >= 2.3.0... yes
> > checking GDAL version >= 1.11.4... yes
> > checking gdal: linking with --libs only... no
> > checking gdal: linking with --libs and --dep-libs... no
> > In file included from gdal_test.cc:1:
> > In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
> > /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> > # error Must have C++11 or newer.
> > ^
> > 1 error generated.
> > In file included from gdal_test.cc:1:
> > In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
> > /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
> > # error Must have C++11 or newer.
> > ^
> > 1 error generated.
> > configure: Install failure: compilation and/or linkage problems.
> > configure: error: GDALAllRegister not found in libgdal.
> > ERROR: configuration failed for package ?rgdal?
> > * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
> > Warning in install.packages :
> > installation of package ?rgdal? had non-zero exit status
> >
> > The downloaded source packages are in
> > ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
> >
> >
> > [[alternative HTML version deleted]]
> Do not post HTML, only plain text.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>


	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Mon Aug  6 15:28:49 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Mon, 6 Aug 2018 15:28:49 +0200
Subject: [R-sig-Geo] rgdal with R > 3.5.x and GDAL > 2.3.x on macOS
In-Reply-To: <1533548013.local-bbb84848-1076-v1.3.0-fd741eb7@getmailspring.com>
References: <alpine.LFD.2.21.1808061041170.12131@reclus.nhh.no>
 <1533548013.local-bbb84848-1076-v1.3.0-fd741eb7@getmailspring.com>
Message-ID: <alpine.LFD.2.21.1808061520440.13636@reclus.nhh.no>

On Mon, 6 Aug 2018, Patrick Schratz wrote:

> Hi Roger,
>
> thanks for taking the time. To defend myself, I do not use macOS on a 
> daily base and just run it in a VM for some package testing.

More luck you than me - I haven't repeated trying to test on OSX for 
years - regular users need to find ways of sharing information but volume 
on R-sig-mac is low.

>> Is the issue advice wrong, and CXX should be
>> 'clang++ -std=gnu++11'?
>
> This seems to be the problem. Using your configuration works!

So R CMD config CXX on your system returned 'clang++ -std=gnu++11'? Please 
let me know off-list, and I'll update the sf issue.

> I am aware of the small geospatial com on mac and that the osgeo4mac 
> repo is not very stable. However I think there is a need for a short 
> guide how to either use the kyngchaos frameworks or the osgeo4mac repo 
> to have a stable geospatial toolset for R (starting with rgdal to sf and 
> so on). Ideally for different R versions if major changes occured. A 
> good place would be the README of rgdal if would be hosted on r-spatial 
> on Github as most people would look there. As I saw in some issues, 
> people sometimes think the cran/rgdal mirror is the place to go. But 
> thats all just suggestions ;)

Volunteers welcome - it would be easiest to maintain if those doing it had 
a CI framework. I think it is also a mindset thing, OSX should be easier 
than Windows, but often isn't, partly because of Apple making changes that 
are not backward-compatible.

> This little issue costed me at least 3h. Its really annyoing to have 
> such issues on macOS from time to time (but ofc this is not your or 
> anyone else fault).

Life isn't supposed to be easy, unless one believes the sales talk ... 
thanks for contributing the issue anyway, maybe the signal will get a bit 
stronger ...

Roger

> Thanks again!!
> Patrick
>
> On Aug 6 2018, at 11:05 am, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>> See below inline:
>> On Mon, 6 Aug 2018, Patrick Schratz wrote:
>>> Hi,
>>> desperately trying to get rgdal installed on R > 3.5.x with GDAL 2.3.0
>>> on macOS High Sierra. I am aware of the discussion that a suitable
>>> compiler is needed since GDAL > 2.3.0.
>>>
>>> I've set
>>> CC=clang
>>> CXX=clang++
>>> PKG_CXXFLAGS= -stdlib=libc++ -std=c++11
>>>
>>> In ~/.R/Makevars as suggested here https://github.com/r-spatial/sf/issues/726
>> Does anyone actually know that this is a solution or rather the problem?
>> Check:
>>
>> $ R CMD config CXX
>> ## clang++ -std=gnu++11
>> ## for me with an R-devel clang build on Fedora 28
>>
>> Run this and/or ./configure in the unpacked rgdal source tarball and
>> report the CXX value. Is the issue advice wrong, and CXX should be
>> 'clang++ -std=gnu++11'?
>>
>> I have no access to OSX (and no wish to have access) - the OSX users need
>> to do a full bisection and not guess what is happening.
>>
>>> The automated checking during the rgdal installation shows that C++11
>>> support is available. But still it complains about a lacking C++11
>>> support.
>>
>>
>> No, that is coming from code in GDAL itself, as you can see. You need to
>> establish which --std= is actually needed.
>>
>>> I've searched the web but could not find anything helpful. If I've
>>> overlooked something, please just point me to the link.
>>
>>
>> Searching the web only confirms that there is very little signal there -
>> search the source code instead, and bisection (which settings worked for
>> which versions, and which changes provoke the issue)? Is for example the
>> CRAN R binary reporting a different R CMD config CXX from your
>> homebrew-built R?
>>
>>>
>>> Everything installed via homebrew (bottles)
>>> R 3.5.1
>>> proj 5.1.0 (osgeo4mac)
>>> gdal 2.3.1 (homebrew core)
>>>
>>> macOS 10.13.1 (High Sierra)
>>>> install.packages("rgdal")
>>>
>>> Installing package into ?/usr/local/lib/R/3.5/site-library?
>>> (as ?lib? is unspecified)
>>> trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
>>> Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
>>> ==================================================
>>> downloaded 1.6 MB
>>>
>>> * installing *source* package ?rgdal? ...
>>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>>> configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
>>> configure: CC: clang
>>> configure: CXX: clang++
>>> configure: C++11 support available
>>> configure: rgdal: 1.3-4
>>> checking for /usr/bin/svnversion... yes
>>> configure: svn revision: 766
>>> checking for gdal-config... /usr/local/bin/gdal-config
>>> checking gdal-config usability... yes
>>> configure: GDAL: 2.3.1
>>> checking C++11 support for GDAL >= 2.3.0... yes
>>> checking GDAL version >= 1.11.4... yes
>>> checking gdal: linking with --libs only... no
>>> checking gdal: linking with --libs and --dep-libs... no
>>> In file included from gdal_test.cc:1:
>>> In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
>>> /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
>>> # error Must have C++11 or newer.
>>> ^
>>
>>
>>
>> From the GDAL 2.3.1 source at the given line number - your __cplusplus
>> from homebrew's value needs checking:
>>
>> /* MSVC fails to define a decent value of __cplusplus. Try to target
>> VS2015*/
>> /* as a minimum */
>>
>> #if defined(__cplusplus) && !defined(CPL_SUPRESS_CPLUSPLUS)
>> # if !(__cplusplus >= 201103L || (defined(_MSC_VER) && _MSC_VER >= 1900))
>> # error Must have C++11 or newer.
>> # endif
>> # if __cplusplus >= 201402L
>> # define HAVE_CXX14 1
>> # endif
>> /* TODO(schwehr): What is the correct test for C++ 17? */
>> #endif /* __cplusplus */
>>
>> Fallback is the CRAN OSX binary for rgdal 1.3-4 (with the addition of proj
>> datum files as posted yesterday, or Kyngchaos (as on R-sig-mac).
>>
>> Roger
>>
>>> 1 error generated.
>>> In file included from gdal_test.cc:1:
>>> In file included from /usr/local/Cellar/gdal2/2.3.1/include/gdal.h:45:
>>> /usr/local/Cellar/gdal2/2.3.1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
>>> # error Must have C++11 or newer.
>>> ^
>>> 1 error generated.
>>> configure: Install failure: compilation and/or linkage problems.
>>> configure: error: GDALAllRegister not found in libgdal.
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
>>> Warning in install.packages :
>>> installation of package ?rgdal? had non-zero exit status
>>>
>>> The downloaded source packages are in
>>> ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
>>>> install.packages("rgdal")
>>>
>>> Installing package into ?/usr/local/lib/R/3.5/site-library?
>>> (as ?lib? is unspecified)
>>> trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.3-4.tar.gz'
>>> Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
>>> ==================================================
>>> downloaded 1.6 MB
>>>
>>> * installing *source* package ?rgdal? ...
>>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>>> configure: R_HOME: /usr/local/Cellar/r/3.5.1/lib/R
>>> configure: CC: clang
>>> configure: CXX: clang++
>>> configure: C++11 support available
>>> configure: rgdal: 1.3-4
>>> checking for /usr/bin/svnversion... yes
>>> configure: svn revision: 766
>>> checking for gdal-config... /usr/local/bin/gdal-config
>>> checking gdal-config usability... yes
>>> configure: GDAL: 2.3.1
>>> checking C++11 support for GDAL >= 2.3.0... yes
>>> checking GDAL version >= 1.11.4... yes
>>> checking gdal: linking with --libs only... no
>>> checking gdal: linking with --libs and --dep-libs... no
>>> In file included from gdal_test.cc:1:
>>> In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
>>> /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
>>> # error Must have C++11 or newer.
>>> ^
>>> 1 error generated.
>>> In file included from gdal_test.cc:1:
>>> In file included from /usr/local/Cellar/gdal/2.3.1_1/include/gdal.h:45:
>>> /usr/local/Cellar/gdal/2.3.1_1/include/cpl_port.h:187:6: error: Must have C++11 or newer.
>>> # error Must have C++11 or newer.
>>> ^
>>> 1 error generated.
>>> configure: Install failure: compilation and/or linkage problems.
>>> configure: error: GDALAllRegister not found in libgdal.
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/usr/local/lib/R/3.5/site-library/rgdal?
>>> Warning in install.packages :
>>> installation of package ?rgdal? had non-zero exit status
>>>
>>> The downloaded source packages are in
>>> ?/private/var/folders/nv/k87rzvfs55l6j6xt_0jwb4wm0000gn/T/Rtmp68hYW1/downloaded_packages?
>>>
>>>
>>> [[alternative HTML version deleted]]
>> Do not post HTML, only plain text.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> http://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From hugor@mo@ @ending from l@molin@@edu@pe  Mon Aug  6 16:50:08 2018
From: hugor@mo@ @ending from l@molin@@edu@pe (Hugo Ramos Inca Roca)
Date: Mon, 6 Aug 2018 09:50:08 -0500
Subject: [R-sig-Geo] Detecting change in grids cover for use land
Message-ID: <CAE+6SkKQQGro7_G-rY-EnvR9+YtCc6tsVF92=+T2ziWyxbZFNQ@mail.gmail.com>

Hi colleagues
I'm doing study about land change and changes forecast, and I want to use
the methodology of markov chains for get a forecast probability to  land
changes using software R. using grids covers and GIS. thanks for all.



*Ing. Hugo O. Ramos Inca Roca*
Mg. Sc. Producci?n Agr?cola
Dpto. de Fitotecnia ? UNALM
Cel: 971174740
RPM: #971174740

	[[alternative HTML version deleted]]


From @m@@nt@c @ending from hotm@il@com  Mon Aug  6 17:21:10 2018
From: @m@@nt@c @ending from hotm@il@com (Ali Santacruz)
Date: Mon, 6 Aug 2018 15:21:10 +0000
Subject: [R-sig-Geo] Detecting change in grids cover for use land
In-Reply-To: <CAE+6SkKQQGro7_G-rY-EnvR9+YtCc6tsVF92=+T2ziWyxbZFNQ@mail.gmail.com>
References: <CAE+6SkKQQGro7_G-rY-EnvR9+YtCc6tsVF92=+T2ziWyxbZFNQ@mail.gmail.com>
Message-ID: <BN6PR10MB16333F7B287B64262150D8A6C9200@BN6PR10MB1633.namprd10.prod.outlook.com>

Hi Hugo,

Here are some R packages that may be useful:

- r_lucc: https://github.com/simonmoulds/r_lulcc/tree/master/lulcc

- simlandeR: https://simlander.wordpress.com/

I'd also suggest you take a look at the Molusce plugin for QGIS 2.x: https://www.youtube.com/watch?v=D7hoBTKhldE

Hope this helps,

Best,

Ali

________________________________
De: R-sig-Geo <r-sig-geo-bounces at r-project.org> en nombre de Hugo Ramos Inca Roca <hugoramos at lamolina.edu.pe>
Enviado: lunes, 6 de agosto de 2018 09:50 a. m.
Para: r-sig-geo at r-project.org
Asunto: [R-sig-Geo] Detecting change in grids cover for use land

Hi colleagues
I'm doing study about land change and changes forecast, and I want to use
the methodology of markov chains for get a forecast probability to  land
changes using software R. using grids covers and GIS. thanks for all.



*Ing. Hugo O. Ramos Inca Roca*
Mg. Sc. Producci?n Agr?cola
Dpto. de Fitotecnia ? UNALM
Cel: 971174740
RPM: #971174740

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From public @ending from c@re@g@@net  Mon Aug  6 19:37:43 2018
From: public @ending from c@re@g@@net (Richard Careaga)
Date: Mon, 6 Aug 2018 10:37:43 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 180, Issue 3
In-Reply-To: <mailman.26729.5.1533549601.53300.r-sig-geo@r-project.org>
References: <mailman.26729.5.1533549601.53300.r-sig-geo@r-project.org>
Message-ID: <CAKQZOLWsC2Rw7znBZVUpA2+Y=4qW4dHLTXztyi3=Y0sQFMFcSw@mail.gmail.com>

I can confirm that the snippet works on OSX 10.136 (17G65)


On August 6, 2018 at 3:01:47 AM, r-sig-geo-request at r-project.org (
r-sig-geo-request at r-project.org) wrote:

pkg <- "rgdal"
exdir <- file.path(system.file(package=pkg), "proj")
list.files(exdir)
tf <- tempfile()
fl <- "http://download.osgeo.org/proj/proj-datumgrid-1.7.zip"
download.file(fl, tf)
unzip(tf, exdir=exdir)
list.files(exdir)

	[[alternative HTML version deleted]]


From sophie@lebl@@c m@ili@g off @euf@fr  Wed Aug  8 10:55:40 2018
From: sophie@lebl@@c m@ili@g off @euf@fr (sophie@lebl@@c m@ili@g off @euf@fr)
Date: Wed, 8 Aug 2018 10:55:40 +0200 (CEST)
Subject: [R-sig-Geo] bottom area of a lake calculation
Message-ID: <78720790.43429.1533718540302.JavaMail.www@wsfrf1415>

<span style="font-family:arial,helvetica,sans-serif; font-size:12px">?</span>Dear all,<br>
<br>
I would like to calculate the bottom area of a lake. I have already used marmap to calculate projected area, i.e. surface area.<br>
But i have not found anything to calculate a non projected area. I have the coordinates of points (longitude, latitude and depth) I can convert them into xyz. But then I don't know how to calculate the surface I have found polygonal area calculation but I have a 3D object, a polyheron and I think I can not use polygonal area.<br>
Do you have any idea? do you know an R package that could help?<br>
<br>
thanks,<br>
Sophie Leblanc<br>
<br>
<!-- +Signature --><font size="2"><em><a href="http://sophieleblanc6.wix.com/photographie">http://sophieleblanc6.wix.com/photographie</a></em></font> <!-- -Signature -->
	[[alternative HTML version deleted]]


From te@3rd @ending from gm@il@com  Wed Aug  8 16:06:20 2018
From: te@3rd @ending from gm@il@com (Thomas Adams)
Date: Wed, 8 Aug 2018 10:06:20 -0400
Subject: [R-sig-Geo] bottom area of a lake calculation
In-Reply-To: <78720790.43429.1533718540302.JavaMail.www@wsfrf1415>
References: <78720790.43429.1533718540302.JavaMail.www@wsfrf1415>
Message-ID: <CAGxgkWiZunvP1dp1=Mg+iB2krsGf8nyuBR8EvNdxKYH6JjmEew@mail.gmail.com>

Sophie,

I think a reasonable approximation might be obtained:

(1) if you were to calculate the slope at each grid point using
r.slope.aspect
(2) use r.mapcalc to calculate A/cos(slope), where A is the pixel projected
area (e.g., 100mx100m = 10000 m^2) -- lat-long coordinates will not work.

Consequently, if the slope were approximately 0, cos(slope) approaches 1
and A/cos(slope) = A; as slope approaches 90 deg, cos(slope) becomes very
small, so A becomes very large. This works where the slope direction is
orthogonal to a pixel edge, so a correction to account for other slope
directions may be needed. But, with smaller grids, the error may be
negligible for you...

Tom


On Wed, Aug 8, 2018 at 4:55 AM, <sophie.leblanc at neuf.fr> wrote:

> <span style="font-family:arial,helvetica,sans-serif;
> font-size:12px">?</span>Dear all,<br>
> <br>
> I would like to calculate the bottom area of a lake. I have already used
> marmap to calculate projected area, i.e. surface area.<br>
> But i have not found anything to calculate a non projected area. I have
> the coordinates of points (longitude, latitude and depth) I can convert
> them into xyz. But then I don't know how to calculate the surface I have
> found polygonal area calculation but I have a 3D object, a polyheron and I
> think I can not use polygonal area.<br>
> Do you have any idea? do you know an R package that could help?<br>
> <br>
> thanks,<br>
> Sophie Leblanc<br>
> <br>
> <!-- +Signature --><font size="2"><em><a href="http://sophieleblanc6.
> wix.com/photographie">http://sophieleblanc6.wix.com/photographie</a></em></font>
> <!-- -Signature -->
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From te@3rd @ending from gm@il@com  Wed Aug  8 16:07:45 2018
From: te@3rd @ending from gm@il@com (Thomas Adams)
Date: Wed, 8 Aug 2018 10:07:45 -0400
Subject: [R-sig-Geo] bottom area of a lake calculation
In-Reply-To: <CAGxgkWiZunvP1dp1=Mg+iB2krsGf8nyuBR8EvNdxKYH6JjmEew@mail.gmail.com>
References: <78720790.43429.1533718540302.JavaMail.www@wsfrf1415>
 <CAGxgkWiZunvP1dp1=Mg+iB2krsGf8nyuBR8EvNdxKYH6JjmEew@mail.gmail.com>
Message-ID: <CAGxgkWhtDOnuxVT1e8BK_gijbVh+F=_P0Ut5jktKdFxwKqhgCQ@mail.gmail.com>

Sophie,

My apologies, I was thinking in terms of using GRASS GIS... but the idea is
the same

Tom

On Wed, Aug 8, 2018 at 10:06 AM, Thomas Adams <tea3rd at gmail.com> wrote:

> Sophie,
>
> I think a reasonable approximation might be obtained:
>
> (1) if you were to calculate the slope at each grid point using
> r.slope.aspect
> (2) use r.mapcalc to calculate A/cos(slope), where A is the pixel
> projected area (e.g., 100mx100m = 10000 m^2) -- lat-long coordinates will
> not work.
>
> Consequently, if the slope were approximately 0, cos(slope) approaches 1
> and A/cos(slope) = A; as slope approaches 90 deg, cos(slope) becomes very
> small, so A becomes very large. This works where the slope direction is
> orthogonal to a pixel edge, so a correction to account for other slope
> directions may be needed. But, with smaller grids, the error may be
> negligible for you...
>
> Tom
>
>
> On Wed, Aug 8, 2018 at 4:55 AM, <sophie.leblanc at neuf.fr> wrote:
>
>> <span style="font-family:arial,helvetica,sans-serif;
>> font-size:12px">?</span>Dear all,<br>
>> <br>
>> I would like to calculate the bottom area of a lake. I have already used
>> marmap to calculate projected area, i.e. surface area.<br>
>> But i have not found anything to calculate a non projected area. I have
>> the coordinates of points (longitude, latitude and depth) I can convert
>> them into xyz. But then I don't know how to calculate the surface I have
>> found polygonal area calculation but I have a 3D object, a polyheron and I
>> think I can not use polygonal area.<br>
>> Do you have any idea? do you know an R package that could help?<br>
>> <br>
>> thanks,<br>
>> Sophie Leblanc<br>
>> <br>
>> <!-- +Signature --><font size="2"><em><a href="http://sophieleblanc6.wi
>> x.com/photographie">http://sophieleblanc6.wix.com/photographie</a></em></font>
>> <!-- -Signature -->
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From te@3rd @ending from gm@il@com  Wed Aug  8 16:49:47 2018
From: te@3rd @ending from gm@il@com (Thomas Adams)
Date: Wed, 8 Aug 2018 10:49:47 -0400
Subject: [R-sig-Geo] bottom area of a lake calculation
In-Reply-To: <432808044.110685.1533739179946.JavaMail.www@wsfrf1415>
References: <432808044.110685.1533739179946.JavaMail.www@wsfrf1415>
Message-ID: <CAGxgkWhU1fdmbTkJJdgO1d59xmtAbB2E7xDvmKu6xwWPA10hPQ@mail.gmail.com>

Hello Sophie,

Yes, what you show was my understanding. I'm sure what you want to do can
be done in R, but I'm not sure what packages to use. For doing such a
thing, I use GRASS GIS. Regardless, I think you should re-project your data
from latitude-longitude to Albers Equal Area or Lambert Conic Conformal,
etc., that is area preserving. Eventually, you need to do this to get an
area anyhow.

An additional step would be to reproject, then spatially interpolate the
point locations you have in your spreadsheet into a grid to Albers Equal
Area or Lambert Conic Conformal, etc.

I could take a stab at this and show you...

Regards,
Tom

On Wed, Aug 8, 2018 at 10:39 AM, <sophie.leblanc at neuf.fr> wrote:

> Dear Tom,
>
> thanks for your reply.
> Just to be sure I have explain correctly.
> With marmap I can get the green area but I also want to calculate the red
> one.
> I have attached the kind of data I have.
>
> ?
> I do not have any GIS software.
> I wanted to convert my spherical coordinate to cartesian ones with
>
> x = radius * cos(latitude) * cos(longitude)
> y = radius * cos(latitude) * sin(longitude)
> z = radius * sin(latitude)
> radius= earth_radius-depth : not fully sure...
> Do you think it is correct?
>
> The slope is not the same everywhere around the lake.
> Is it possible to calculate area with your first explanations?
> what R package should I use?
>
> thanks,
> Sophie Leblanc
>
>
>
>
>
>
>
> *http://sophieleblanc6.wix.com/photographie
> <http://sophieleblanc6.wix.com/photographie>*
> De : "Thomas Adams"
> A : sophie.leblanc at neuf.fr,"r-sig-Geo at r-project.org"
> Envoy?: mercredi 8 ao?t 2018 16:07
> Objet : Re: [R-sig-Geo] bottom area of a lake calculation
>
>
> Sophie,
>
> My apologies, I was thinking in terms of using GRASS GIS... but the idea
> is the same
>
> Tom
>
> On Wed, Aug 8, 2018 at 10:06 AM, Thomas Adams <tea3rd at gmail.com> wrote:
>>
>> Sophie,
>>
>> I think a reasonable approximation might be obtained:
>>
>> (1) if you were to calculate the slope at each grid point using
>> r.slope.aspect
>> (2) use r.mapcalc to calculate A/cos(slope), where A is the pixel
>> projected area (e.g., 100mx100m = 10000 m^2) -- lat-long coordinates will
>> not work.
>>
>> Consequently, if the slope were approximately 0, cos(slope) approaches 1
>> and A/cos(slope) = A; as slope approaches 90 deg, cos(slope) becomes very
>> small, so A becomes very large. This works where the slope direction is
>> orthogonal to a pixel edge, so a correction to account for other slope
>> directions may be needed. But, with smaller grids, the error may be
>> negligible for you...
>>
>> Tom
>>
>>
>> On Wed, Aug 8, 2018 at 4:55 AM, <sophie.leblanc at neuf.fr> wrote:
>>>
>>> <span style="font-family:arial,helvetica,sans-serif;
>>> font-size:12px">?</span>Dear all,<br>
>>> <br>
>>> I would like to calculate the bottom area of a lake. I have already used
>>> marmap to calculate projected area, i.e. surface area.<br>
>>> But i have not found anything to calculate a non projected area. I have
>>> the coordinates of points (longitude, latitude and depth) I can convert
>>> them into xyz. But then I don't know how to calculate the surface I have
>>> found polygonal area calculation but I have a 3D object, a polyheron and I
>>> think I can not use polygonal area.<br>
>>> Do you have any idea? do you know an R package that could help?<br>
>>> <br>
>>> thanks,<br>
>>> Sophie Leblanc<br>
>>> <br>
>>> <!-- +Signature --><font size="2"><em><a href="http://sophieleblanc6.wi
>>> x.com/photographie">http://sophieleblanc6.wix.com/photographie</a></em></font>
>>> <!-- -Signature -->
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
>>
>>
>
>
>
>
>
>



-- 
Thomas E Adams, III
1724 Sage Lane
Blacksburg, VA 24060
tea3rd at gmail.com (personal)
tea at terrapredictions.org (work)

1 (513) 739-9512 (cell)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180808/9115b88e/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pasteImage1533738760024.png
Type: image/png
Size: 14034 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180808/9115b88e/attachment.png>

From hugo@gco@t@ @ending from gm@il@com  Thu Aug  9 11:51:28 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Thu, 9 Aug 2018 11:51:28 +0200
Subject: [R-sig-Geo] raster::overlay with a function that calls a list of
 vectors
Message-ID: <CADvFi5oDy71g_6v+WNm15rhVeWTvuwuzz8zTFtYbzkTVOgcB-w@mail.gmail.com>

Dear list

I wonder if it?s possible to use overlay function of raster package with a
function that calls a list of vectors to perform some calculations based on
two rasters. So far I just saw examples of functions performing some raster
algebra without calling external data.

Hereafter I provide some toy code to illustrate what I?m trying to do, but
can also provide some context on my real problem. Specifically, I need to
classify each pixel as either zero (absence) or one (presence) of housings.
The likelihood of housing presence is related to the percentage of built-up
area covering the pixel (raster ?r1? below), and the land cover type
(raster ?r2? below). This likelihood is known based on reference data,
which is stored in a list like ?probs? below.

library(raster)
# continuous and categorical maps
r1<-r2<-raster()
r1[]<-round(runif(ncell(r1))*100)
r2[]<-1
r2[1:30000]<-2
# probability of housing presence in each stratum
prob1<-1:100/100
prob2<-log(1:100)/max(log(1:100))
# list of probabilities to be used in overlay
probs<-list(prob1,prob2)
# overlay - not working
o<-overlay(r1,r2,fun=function(x,y,...){return(rbinom(n=1, size=1,
prob=probs[[y]][x]))})

the error is
cannot use this formula, probably because it is not vectorized

Alternatively to the toy code above, I thought to process each categorical
class separately and use function calc rather than function overlay (see
below). However, this is extremely slow (if not impossible) for large
rasters, so I though overlay would be better.

# alternative: loop across categorical classes (extremely slow for
large rasters)
r<-list()for(i in 1:2){
  stratum<-r2
  stratum[Which(stratum !=i)]<-NA
  r[[i]]<-calc(r1, fun=function(x,...){return(rbinom(n=1, size=1,
prob=probs[[i]][x]))})
  r[[i]]<-mask(r[[i]],stratum)}

r<-stack(r)
r<-sum(r,na.rm=T)

par(mfrow=c(1,3))
plot(r1)
plot(r2)
plot(r)

	[[alternative HTML version deleted]]


From dechen@lh@m @ending from ieu@uzh@ch  Thu Aug  9 11:56:53 2018
From: dechen@lh@m @ending from ieu@uzh@ch (Dechen Lham)
Date: Thu, 9 Aug 2018 11:56:53 +0200
Subject: [R-sig-Geo] model predictions for spatially corrected logistic model
Message-ID: <EE5A6EA9-DAF0-4B75-9C4A-96A8C266C78B@ieu.uzh.ch>

Hi

Does any one have an idea how you make a model prediction for a model that is corrected for spatial autocorrelation? I used the cote-corrected covariate mean in the formation of new data. Is it the normal way you predict a model. I tried doing this but a lot my data gets removed and with the little data it is not able to plot.

Some advise or suggestions would be great.


From r@f@el@wuee@t @ending from gm@il@com  Thu Aug  9 14:33:34 2018
From: r@f@el@wuee@t @ending from gm@il@com (=?utf-8?Q?Rafael_W=C3=BCest?=)
Date: Thu, 9 Aug 2018 14:33:34 +0200
Subject: [R-sig-Geo] 
 raster::overlay with a function that calls a list of vectors
In-Reply-To: <CADvFi5oDy71g_6v+WNm15rhVeWTvuwuzz8zTFtYbzkTVOgcB-w@mail.gmail.com>
References: <CADvFi5oDy71g_6v+WNm15rhVeWTvuwuzz8zTFtYbzkTVOgcB-w@mail.gmail.com>
Message-ID: <541F70F3-7844-433C-9A83-0B721D9204B8@gmail.com>

Hi Hugo

Vectorize() sometimes solves this issue.

foo <- function(x,y,...) {return(rbinom(n=1, size=1, prob=probs[[y]][x]))}
fooV <- Vectorize(foo)

Using your toy example, check carefully if

o <- overlay(r1,r2,fun = fooV)

gives you what you are looking for.

HTH
Rafael


> On 9 Aug 2018, at 11:51, Hugo Costa <hugoagcosta at gmail.com> wrote:
> 
> Dear list
> 
> I wonder if it?s possible to use overlay function of raster package with a
> function that calls a list of vectors to perform some calculations based on
> two rasters. So far I just saw examples of functions performing some raster
> algebra without calling external data.
> 
> Hereafter I provide some toy code to illustrate what I?m trying to do, but
> can also provide some context on my real problem. Specifically, I need to
> classify each pixel as either zero (absence) or one (presence) of housings.
> The likelihood of housing presence is related to the percentage of built-up
> area covering the pixel (raster ?r1? below), and the land cover type
> (raster ?r2? below). This likelihood is known based on reference data,
> which is stored in a list like ?probs? below.
> 
> library(raster)
> # continuous and categorical maps
> r1<-r2<-raster()
> r1[]<-round(runif(ncell(r1))*100)
> r2[]<-1
> r2[1:30000]<-2
> # probability of housing presence in each stratum
> prob1<-1:100/100
> prob2<-log(1:100)/max(log(1:100))
> # list of probabilities to be used in overlay
> probs<-list(prob1,prob2)
> # overlay - not working
> o<-overlay(r1,r2,fun=function(x,y,...){return(rbinom(n=1, size=1,
> prob=probs[[y]][x]))})
> 
> the error is
> cannot use this formula, probably because it is not vectorized
> 
> Alternatively to the toy code above, I thought to process each categorical
> class separately and use function calc rather than function overlay (see
> below). However, this is extremely slow (if not impossible) for large
> rasters, so I though overlay would be better.
> 
> # alternative: loop across categorical classes (extremely slow for
> large rasters)
> r<-list()for(i in 1:2){
>  stratum<-r2
>  stratum[Which(stratum !=i)]<-NA
>  r[[i]]<-calc(r1, fun=function(x,...){return(rbinom(n=1, size=1,
> prob=probs[[i]][x]))})
>  r[[i]]<-mask(r[[i]],stratum)}
> 
> r<-stack(r)
> r<-sum(r,na.rm=T)
> 
> par(mfrow=c(1,3))
> plot(r1)
> plot(r2)
> plot(r)
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est Karpati
http://www.rowueest.net


From hugo@gco@t@ @ending from gm@il@com  Thu Aug  9 15:22:39 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Thu, 9 Aug 2018 15:22:39 +0200
Subject: [R-sig-Geo] 
 raster::overlay with a function that calls a list of vectors
In-Reply-To: <541F70F3-7844-433C-9A83-0B721D9204B8@gmail.com>
References: <CADvFi5oDy71g_6v+WNm15rhVeWTvuwuzz8zTFtYbzkTVOgcB-w@mail.gmail.com>
 <541F70F3-7844-433C-9A83-0B721D9204B8@gmail.com>
Message-ID: <CADvFi5qj06wrfrsNB2DfCbyxZ+yEahFK58NKvh3hEcoyp7sr8g@mail.gmail.com>

Hi Rafael.

Your suggestion works perfectly for the toy data.
For my real data, it's not that simple. I'm processing data for the entire
Europe, and thus I split data in tiles. Apparently, Vectorize does not work
when a tile includes just some of the strata (raster r2 in the toy data has
2 strata, but my real data has 7). When tiles include all my strata,
Vectorize seems to work, although slowly (it is processing while writing
this message). Anyway, your message was important to spot this behaviour, I
might need to include some workaround to process the tiles with less
strata, while trying to speed up the processing.

Thank you very much
Hugo

Rafael W?est <rafael.wueest at gmail.com> escreveu no dia quinta, 9/08/2018
?(s) 14:33:

> Hi Hugo
>
> Vectorize() sometimes solves this issue.
>
> foo <- function(x,y,...) {return(rbinom(n=1, size=1, prob=probs[[y]][x]))}
> fooV <- Vectorize(foo)
>
> Using your toy example, check carefully if
>
> o <- overlay(r1,r2,fun = fooV)
>
> gives you what you are looking for.
>
> HTH
> Rafael
>
>
> > On 9 Aug 2018, at 11:51, Hugo Costa <hugoagcosta at gmail.com> wrote:
> >
> > Dear list
> >
> > I wonder if it?s possible to use overlay function of raster package with
> a
> > function that calls a list of vectors to perform some calculations based
> on
> > two rasters. So far I just saw examples of functions performing some
> raster
> > algebra without calling external data.
> >
> > Hereafter I provide some toy code to illustrate what I?m trying to do,
> but
> > can also provide some context on my real problem. Specifically, I need to
> > classify each pixel as either zero (absence) or one (presence) of
> housings.
> > The likelihood of housing presence is related to the percentage of
> built-up
> > area covering the pixel (raster ?r1? below), and the land cover type
> > (raster ?r2? below). This likelihood is known based on reference data,
> > which is stored in a list like ?probs? below.
> >
> > library(raster)
> > # continuous and categorical maps
> > r1<-r2<-raster()
> > r1[]<-round(runif(ncell(r1))*100)
> > r2[]<-1
> > r2[1:30000]<-2
> > # probability of housing presence in each stratum
> > prob1<-1:100/100
> > prob2<-log(1:100)/max(log(1:100))
> > # list of probabilities to be used in overlay
> > probs<-list(prob1,prob2)
> > # overlay - not working
> > o<-overlay(r1,r2,fun=function(x,y,...){return(rbinom(n=1, size=1,
> > prob=probs[[y]][x]))})
> >
> > the error is
> > cannot use this formula, probably because it is not vectorized
> >
> > Alternatively to the toy code above, I thought to process each
> categorical
> > class separately and use function calc rather than function overlay (see
> > below). However, this is extremely slow (if not impossible) for large
> > rasters, so I though overlay would be better.
> >
> > # alternative: loop across categorical classes (extremely slow for
> > large rasters)
> > r<-list()for(i in 1:2){
> >  stratum<-r2
> >  stratum[Which(stratum !=i)]<-NA
> >  r[[i]]<-calc(r1, fun=function(x,...){return(rbinom(n=1, size=1,
> > prob=probs[[i]][x]))})
> >  r[[i]]<-mask(r[[i]],stratum)}
> >
> > r<-stack(r)
> > r<-sum(r,na.rm=T)
> >
> > par(mfrow=c(1,3))
> > plot(r1)
> > plot(r2)
> > plot(r)
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Rafael W?est Karpati
> http://www.rowueest.net
>
>

	[[alternative HTML version deleted]]


From monic@kunduz @ending from gm@il@com  Fri Aug 10 20:09:04 2018
From: monic@kunduz @ending from gm@il@com (Monica Kundu)
Date: Fri, 10 Aug 2018 23:39:04 +0530
Subject: [R-sig-Geo] help regarding methodology
Message-ID: <CA+UxVLpn+DznPCr+ZMZ6gDh2XVwa6PrW5+hB=SpkNua9hPLy+w@mail.gmail.com>

I want to work on conditional probability using spatial analysis. To be
more precise,  as in one event depends on the other but not vice versa and
I want to prove this relation spatially. what methodology I can use.

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Sat Aug 11 13:36:50 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Sat, 11 Aug 2018 13:36:50 +0200
Subject: [R-sig-Geo] www.asdar-book.org site issues
Message-ID: <alpine.LFD.2.21.1808111333570.10568@reclus.nhh.no>

The ASDAR book site is not being shown for viewing, but the content is 
still there. Anyone needing content (several inquiries off-list) may try:

ASDAR_BOOK <- "http://www.asdar-book.org/bundles2ed"
chapters <- c("hello", "cm", "vis", "die", "cm2", "std", "sppa", "geos",
  "lat", "dismap")
for (i in chapters) {fn <- paste(i, "bundle.zip", sep="_");
download.file(paste(ASDAR_BOOK, fn, sep = "/"), fn)}

to download the chapter bundles. Summer maintenance takes time, and we 
hope to fix the underlying problem in a week or so.

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From r@hep@rd @ending from @ppl-eco@y@@com  Sat Aug 11 16:38:19 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Sat, 11 Aug 2018 07:38:19 -0700 (PDT)
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
Message-ID: <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>

On Sat, 11 Aug 2018, Roger Bivand wrote:

> The gcc you have is ancient; I would guess that your GDAL was not built with 
> it.

Roger,

   On Slackware everything is built from source other than a few applications
that are repacked by the SlackBuild.org maintainers from .deb or .rpm
packages.

> What happens if you install GDAL from source? Very likely the decision in 
> GDAL to go with CXX11 was premature, but tardy platforms need forcing too 
> (typical problem on CentOS and RHEL too).

   Slackware stays back from the bleeding edge and upgrades slowly so the
distribution remains stable.

> Could you post on R-sig-geo - there may be someone there in your
> situation.

   Moved to the mail list with this response.

Thanks,

Rich

---------- Original message -----------
>>  Please share your thoughts on what might be going on here.
>> 
>> * installing *source* package ?rgdal? ...
>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>> configure:  R_HOME: /usr/lib/R
>> configure:  CC: gcc
>> configure:  CXX: g++
>> configure:  C++11 support available
>> configure:  rgdal: 1.3-4
>> checking for /usr/bin/svnversion... yes
>> configure: svn revision: 766
>> checking for gdal-config... /usr/bin/gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 2.3.0
>> checking C++11 support for GDAL >= 2.3.0... yes
>> checking GDAL version >= 1.11.4... yes
>> checking gdal: linking with --libs only... no
>> checking gdal: linking with --libs and --dep-libs... no
>> In file included from /usr/include/gdal.h:45:0,
>>                 from gdal_test.cc:1:
>> /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
>> #    error Must have C++11 or newer.
>>      ^
>> In file included from /usr/include/gdal.h:49:0,
>>                 from gdal_test.cc:1:
>> /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' 
>> token
>> class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, 
>> CPLXMLTreeCloserDeleter>
>>                                               ^
>> /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
>> /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before 
>> '<' token
>> In file included from /usr/include/ogr_api.h:45:0,
>>                  from /usr/include/gdal.h:50,
>>                  from gdal_test.cc:1:
>> /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
>> /usr/include/ogr_core.h:79:28: error: expected declaration before end of 
>> line
>> In file included from /usr/include/gdal.h:45:0,
>>                 from gdal_test.cc:1:
>> /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
>> #    error Must have C++11 or newer.
>>      ^
>> In file included from /usr/include/gdal.h:49:0,
>>                 from gdal_test.cc:1:
>> /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' 
>> token
>> class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, 
>> CPLXMLTreeCloserDeleter>
>>                                               ^
>> /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
>> /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before 
>> '<' token
>> In file included from /usr/include/ogr_api.h:45:0,
>>                  from /usr/include/gdal.h:50,
>>                  from gdal_test.cc:1:
>> /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
>> /usr/include/ogr_core.h:79:28: error: expected declaration before end of 
>> line
>> configure:  Install failure: compilation and/or linkage problems.
>> configure:  error: GDALAllRegister not found in libgdal.
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/usr/lib/R/library/rgdal?
>> * restoring previous ?/usr/lib/R/library/rgdal?
>> 
>> The downloaded source packages are in
>> 	?/tmp/RtmpVGIz3Q/downloaded_packages?
>> Updating HTML index of packages in '.Library'
>> Making 'packages.html' ... done
>> Warning message:
>> In install.packages("rgdal") :
>>   installation of package ?rgdal? had non-zero exit status
>>
>>  Installed here are:
>> gcc-5.5.0-i586-1_slack14.2
>> gcc-g++-5.5.0-i586-1_slack14.2
>> gcc-gfortran-5.5.0-i586-1_slack14.2
>> gcc-gnat-5.5.0-i586-1_slack14.2
>> gcc-go-5.5.0-i586-1_slack14.2
>> gcc-java-5.5.0-i586-1_slack14.2
>> gcc-objc-5.5.0-i586-1_slack14.2
>> gccmakedep-1.0.3-noarch-1
>> 
>> and
>> 
>> gdal-2.3.0-i586-1_SBo
>> 
>> Regards,
>> 
>> Rich


From brun@e@ti @ending from gm@il@com  Sun Aug 12 17:45:31 2018
From: brun@e@ti @ending from gm@il@com (Bruno Sesti)
Date: Sun, 12 Aug 2018 17:45:31 +0200
Subject: [R-sig-Geo] Autocorrelation and stationarity in spatio temporal data
Message-ID: <CAFnjcD0R3-831ZjKKDah_h4BUFDroUmbdNMHcYt5cg-TPrhyMw@mail.gmail.com>

Hi, I am working with spatio temoral data and I am experimenting spatio
temporal data analysis and interpolation. I would like to ask if there is
some technique/package/function in R to check if irregilar spatio temporal
data, in particolar air quality spatio temporal data from mobile sensors,
are stationary (second order stationary or intrinsic stationary) and if the
shows some form of (auto)correlation.

Kind regards.

	[[alternative HTML version deleted]]


From v_tutj@vi @ending from y@hoo@com  Mon Aug 13 12:24:53 2018
From: v_tutj@vi @ending from y@hoo@com (Vasana Tutjavi)
Date: Mon, 13 Aug 2018 11:24:53 +0100
Subject: [R-sig-Geo] How do i plot a graph with x axis vertically labelled?
Message-ID: <mailman.26747.5.1534156509.1175.r-sig-geo@r-project.org>

Dear R-sig-geo experts,?

I want to plot a bar graph with the labels on the x axis in a vertical format. The data is the Ages of Squid (on the Y axis) and the date of Birth on the X axis, I am struggling to change the labels on the x axis to a vertical format and I want all the dates to show at all the bars. My data is as follows:
Birth
Sex
Age
25/08/2004
F
2
26/09/2004
F
3
02/11/2004
F
3
11/11/2004
F
1
22/11/2004
F
3
04/12/2004
F
1
08/12/2004
F
4
15/12/2004
F
4
21/12/2004
F
5
24/12/2004
F
1
04/01/2005
F
1
06/01/2005
F
3
13/01/2005
F
2
18/01/2005
F
1
19/01/2005
F
3
09/02/2005
F
2
11/02/2005
F
1
13/02/2005
F
1
17/02/2005
F
1
18/02/2005
F
8
19/02/2005
F
5
24/02/2005
F
1
28/02/2005
F
42
01/03/2005
F
1
07/03/2005
F
1
08/03/2005
F
2
09/03/2005
F
1
14/03/2005
F
7
16/03/2005
F
1
25/03/2005
F
3
01/04/2005
F
1
06/04/2005
F
5
07/04/2005
F
1
08/04/2005
F
1
13/04/2005
F
1
14/04/2005
F
1
27/04/2005
F
1
01/05/2005
F
2
07/05/2005
F
1
08/05/2005
F
2
16/05/2005
F
1
30/05/2005
F
8
06/06/2005
F
1
Here is the script I tried:

barplot(Females2005$Age,  names.arg = c("25/08/2004", "26/09/2004", "02/11/2004", "11/11/2004", "22/11/2004", "04/12/2004", "08/12/2004", 
                                       "15/12/2004", "21/12/2004", "24/12/2004", "04/01/2005", "06/01/2005", "13/01/2005", "18/01/2005",
                                       "19/01/2005", "09/02/2005", "11/02/2005", "13/02/2005", "17/02/2005", "18/02/2005", "19/02/2005", 
                                      "24/02/2005", "28/02/2005", "01/03/2005", "07/03/2005", "08/03/2005", "09/03/2005", "14/03/2005", 
                                    "16/03/2005", "25/03/2005", "01/04/2005", "06/04/2005", "07/04/2005", "08/04/2005", "13/04/2005", 
                                      "14/04/2005", "27/04/2005", "01/05/2005", "07/05/2005", "08/05/2005", "16/05/2005", "30/05/2005", 
                                    "06/06/2005"), main = 'Females 2005', ylab = 'Age/Days', xlab = 'Birth/Hatch date')

Many thanks
Vasana
Sent from Mail for Windows 10


	[[alternative HTML version deleted]]


From vo@ubu1100 m@ili@g off y@hoo@com  Mon Aug 13 12:45:56 2018
From: vo@ubu1100 m@ili@g off y@hoo@com (vo@ubu1100 m@ili@g off y@hoo@com)
Date: Mon, 13 Aug 2018 10:45:56 +0000 (UTC)
Subject: [R-sig-Geo] Question: How to parametrize rstoolbox for radCor
 operations of ASTERLB1 data
References: <1541742924.6476744.1534157156790.ref@mail.yahoo.com>
Message-ID: <1541742924.6476744.1534157156790@mail.yahoo.com>

 
Hello good morning learned community of specialists. I would be glad to receive some guidance or code snippets to?help me carry out radCor operations on ASTERLB1 data.
Thank you so much.    On Monday, August 13, 2018, 6:06:32 PM GMT+8, r-sig-geo-request at r-project.org <r-sig-geo-request at r-project.org> wrote:  
 
 Send R-sig-Geo mailing list submissions to
??? r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
??? https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
??? r-sig-geo-request at r-project.org

You can reach the person managing the list at
??? r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

? 1. Autocorrelation and stationarity in spatio temporal data
? ? ? (Bruno Sesti)

----------------------------------------------------------------------

Message: 1
Date: Sun, 12 Aug 2018 17:45:31 +0200
From: Bruno Sesti <brunsesti at gmail.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Autocorrelation and stationarity in spatio
??? temporal data
Message-ID:
??? <CAFnjcD0R3-831ZjKKDah_h4BUFDroUmbdNMHcYt5cg-TPrhyMw at mail.gmail.com>
Content-Type: text/plain; charset="utf-8"

Hi, I am working with spatio temoral data and I am experimenting spatio
temporal data analysis and interpolation. I would like to ask if there is
some technique/package/function in R to check if irregilar spatio temporal
data, in particolar air quality spatio temporal data from mobile sensors,
are stationary (second order stationary or intrinsic stationary) and if the
shows some form of (auto)correlation.

Kind regards.

??? [[alternative HTML version deleted]]




------------------------------

Subject: Digest Footer

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


------------------------------

End of R-sig-Geo Digest, Vol 180, Issue 10
******************************************
  
	[[alternative HTML version deleted]]


From li@@@menez @ending from free@fr  Mon Aug 13 15:56:22 2018
From: li@@@menez @ending from free@fr (Lisa Menez)
Date: Mon, 13 Aug 2018 15:56:22 +0200
Subject: [R-sig-Geo] [localmoran.exact]
References: <CE1B9469-4F3F-4D55-B971-FA3E5BF11E01@free.fr>
Message-ID: <73110819-ECF8-48E9-AA46-E345190C8764@free.fr>


Dear all, 

I have been trying to obtain local Moran?s I with the exact approach (localmoran.exact)
 but I have some issues and would need your help. 

I am trying to bring to light how spatial patterns of wealth have evolved from 2000 to 2016 in the European Union. 

Looking at the Regional Gross Domestic Product (GDP) of European regions, my lm model looks like this : 

lm(log(EU_NUTS at data[,year[i]])~1+factor(EU_NUTS at data$NUTS_L1))

where log(EU_NUTS at data[,year[i]]) are log of regional GDPs

and factor(EU_NUTS at data$NUTS_L1) is the vector of country dummies.

Sadly, I obtain an error message that says : 

Error in integrate(integrand, lower = 0, upper = upper) : 
  a limit is missing
Moreover : Warning messages:
1: In sqrt(2 * t2 - t1^2) : production of NaN
2: In sqrt(2 * t2 - t1^2) : production of NaN 

According to the GitHub source code , 

        Vi <- listw2star <https://rdrr.io/cran/spdep/man/localmoran.sad.html>(B, select[i], style=style, n, D <https://rdrr.io/r/stats/deriv.html>, a,
	    zero.policy=zero.policy)
        Viu <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, u, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
	Ii <- c <https://rdrr.io/r/base/c.html>(crossprod <https://rdrr.io/r/base/crossprod.html>(u, Viu) / utu)
        ViX <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, X, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
        MViM <- t <https://rdrr.io/r/base/t.html>(X) %*% ViX %*% XtXinv
        t1 <- -sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM))
        sumsq.Vi <- function <https://rdrr.io/r/base/function.html>(x) {
            if <https://rdrr.io/r/base/Control.html> (is.null <https://rdrr.io/r/base/NULL.html>(x)) NA <https://rdrr.io/r/base/NA.html>
	    else <https://rdrr.io/r/base/Control.html> sum <https://rdrr.io/r/base/sum.html>(x^2)
	}
	trVi2 <- sum <https://rdrr.io/r/base/sum.html>(sapply <https://rdrr.io/r/base/lapply.html>(Vi$weights <https://rdrr.io/r/stats/weights.html>, sumsq.Vi), na.rm=TRUE <https://rdrr.io/r/base/logical.html>)
	t2a <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(t <https://rdrr.io/r/base/t.html>(ViX) %*% ViX %*% XtXinv))
	t2b <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM %*% MViM))
	t2 <- trVi2 - 2*t2a + t2b
	e1 <- 0.5 * (t1 + sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))
	en <- 0.5 * (t1 - sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))

My guess is that my setting causes (2*t2<t1^2) : Is it ? Why would it ? 

My database is available here : http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt>
and my code : http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt>

I thank you very much for your attention and your help. 

Best Regards
Lisa 

PhD Student
GREDEG, Universit? C?t? d?Azur 






	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Mon Aug 13 16:12:45 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Mon, 13 Aug 2018 16:12:45 +0200
Subject: [R-sig-Geo] [localmoran.exact]
In-Reply-To: <73110819-ECF8-48E9-AA46-E345190C8764@free.fr>
References: <CE1B9469-4F3F-4D55-B971-FA3E5BF11E01@free.fr>
 <73110819-ECF8-48E9-AA46-E345190C8764@free.fr>
Message-ID: <alpine.LFD.2.21.1808131601090.18696@reclus.nhh.no>

On Mon, 13 Aug 2018, Lisa Menez wrote:

>
> Dear all,
>
> I have been trying to obtain local Moran?s I with the exact approach 
> (localmoran.exact) but I have some issues and would need your help.

A complete reproducible example is required (script and data, data may be 
downloaded, do not attach). Does the same thing happen with 
localmoran.sad()?

>
> I am trying to bring to light how spatial patterns of wealth have 
> evolved from 2000 to 2016 in the European Union.
>
> Looking at the Regional Gross Domestic Product (GDP) of European regions, my lm model looks like this :
>
> lm(log(EU_NUTS at data[,year[i]])~1+factor(EU_NUTS at data$NUTS_L1))
>
> where log(EU_NUTS at data[,year[i]]) are log of regional GDPs
>

Never, ever use @ to access data. EU_NUTS at data$NUTS_L1 should be 
EU_NUTS$NUTS_L1 and should be (made a) factor first. It isn't clear what 
log(EU_NUTS at data[,year[i]]) will end up being - is "year" a character 
vector? If so, EU_NUTS[[year[i]]] is the correct syntax.

> and factor(EU_NUTS at data$NUTS_L1) is the vector of country dummies.
>
> Sadly, I obtain an error message that says :
>
> Error in integrate(integrand, lower = 0, upper = upper) :
>  a limit is missing
> Moreover : Warning messages:
> 1: In sqrt(2 * t2 - t1^2) : production of NaN
> 2: In sqrt(2 * t2 - t1^2) : production of NaN
>
> According to the GitHub source code ,

No, as you can see from https://cran.r-project.org/package=spdep, the 
development site of spdep is https://github.com/r-spatial/spdep/. Never 
use non-authorised copies. To see the source, simply type the function 
name. Use debug(localmoran.exact) to step through the function while it 
runs, to see the values of the objects you are in doubt about. Do not do 
this in RStudio, its debugging interface tries to be far too clever.

The following is illegible in plain text; post in plain text only.

Roger

>
>        Vi <- listw2star <https://rdrr.io/cran/spdep/man/localmoran.sad.html>(B, select[i], style=style, n, D <https://rdrr.io/r/stats/deriv.html>, a,
> 	    zero.policy=zero.policy)
>        Viu <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, u, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
> 	Ii <- c <https://rdrr.io/r/base/c.html>(crossprod <https://rdrr.io/r/base/crossprod.html>(u, Viu) / utu)
>        ViX <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, X, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
>        MViM <- t <https://rdrr.io/r/base/t.html>(X) %*% ViX %*% XtXinv
>        t1 <- -sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM))
>        sumsq.Vi <- function <https://rdrr.io/r/base/function.html>(x) {
>            if <https://rdrr.io/r/base/Control.html> (is.null <https://rdrr.io/r/base/NULL.html>(x)) NA <https://rdrr.io/r/base/NA.html>
> 	    else <https://rdrr.io/r/base/Control.html> sum <https://rdrr.io/r/base/sum.html>(x^2)
> 	}
> 	trVi2 <- sum <https://rdrr.io/r/base/sum.html>(sapply <https://rdrr.io/r/base/lapply.html>(Vi$weights <https://rdrr.io/r/stats/weights.html>, sumsq.Vi), na.rm=TRUE <https://rdrr.io/r/base/logical.html>)
> 	t2a <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(t <https://rdrr.io/r/base/t.html>(ViX) %*% ViX %*% XtXinv))
> 	t2b <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM %*% MViM))
> 	t2 <- trVi2 - 2*t2a + t2b
> 	e1 <- 0.5 * (t1 + sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))
> 	en <- 0.5 * (t1 - sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))
>
> My guess is that my setting causes (2*t2<t1^2) : Is it ? Why would it ?
>
> My database is available here : http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt>
> and my code : http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt>
>
> I thank you very much for your attention and your help.
>
> Best Regards
> Lisa
>
> PhD Student
> GREDEG, Universit? C?t? d?Azur
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From cry@n @ending from bingh@mton@edu  Mon Aug 13 16:28:03 2018
From: cry@n @ending from bingh@mton@edu (Christopher W Ryan)
Date: Mon, 13 Aug 2018 10:28:03 -0400
Subject: [R-sig-Geo] 
 How do i plot a graph with x axis vertically labelled?
In-Reply-To: <20180813102509.E59BD4F6@hypatia.math.ethz.ch>
References: <20180813102509.E59BD4F6@hypatia.math.ethz.ch>
Message-ID: <CAM+rpYmfnsiEP=yAspUAV_7Sho=9E=Kr0OfN+6toPeUwAbC6gw@mail.gmail.com>

Vasana--

May I ask why you want to produce such a graph? What relationship(s) in
your data are you trying to show?  I can't be sure from your original post,
but it seems to me that you are trying to do this the hard way.  R can help
you.

What happens when you run the code you posted? What error message do you
get, if any?

Your birthdates are not just nominal labels; they contain more information
than that--specifically, they are ordered, with certain elapsed duration
between them. Using them merely as names/labels on bars sacrifices
information. Also, if you don't have an observation for every birthdate in
a sequence of dates, then you will represent unequally-spaced dates with
equally-spaced bars--generally not a good thing. Conversely, could any of
your birthdates ever be duplicated?

Vertically-oriented bar labels can be difficult for your intended audience
to read, especially since you seem to want to put 30-40 of them along the
horizontal axis. Another option would be to flip your graph, putting
birthdates on the vertical axis so the date labels can be horizontal.

Here is a minimal working example to demonstrate one possible solution that
you might be able to modify to convey what you are trying to convey, and
that let's R do the work it is good at.

## generate some data
dd <- data.frame( birth = Sys.Date() + sort(sample(1:10, 6, replace =
TRUE)),  sex = factor(sample(c("M", "F"), 6, replace = TRUE)), age =
sample(1:9, 6, replace = TRUE) )
## show the data
dd
str(dd)
## a plot
 with(dd, plot(age ~ birth, type = "h"))

--Chris Ryan

On Mon, Aug 13, 2018 at 6:24 AM, Vasana Tutjavi via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Dear R-sig-geo experts,
>
> I want to plot a bar graph with the labels on the x axis in a vertical
> format. The data is the Ages of Squid (on the Y axis) and the date of Birth
> on the X axis, I am struggling to change the labels on the x axis to a
> vertical format and I want all the dates to show at all the bars. My data
> is as follows:
> Birth
> Sex
> Age
> 25/08/2004
> F
> 2
> 26/09/2004
> F
> 3
> 02/11/2004
> F
> 3
> 11/11/2004
> F
> 1
> 22/11/2004
> F
> 3
> 04/12/2004
> F
> 1
> 08/12/2004
> F
> 4
> 15/12/2004
> F
> 4
> 21/12/2004
> F
> 5
> 24/12/2004
> F
> 1
> 04/01/2005
> F
> 1
> 06/01/2005
> F
> 3
> 13/01/2005
> F
> 2
> 18/01/2005
> F
> 1
> 19/01/2005
> F
> 3
> 09/02/2005
> F
> 2
> 11/02/2005
> F
> 1
> 13/02/2005
> F
> 1
> 17/02/2005
> F
> 1
> 18/02/2005
> F
> 8
> 19/02/2005
> F
> 5
> 24/02/2005
> F
> 1
> 28/02/2005
> F
> 42
> 01/03/2005
> F
> 1
> 07/03/2005
> F
> 1
> 08/03/2005
> F
> 2
> 09/03/2005
> F
> 1
> 14/03/2005
> F
> 7
> 16/03/2005
> F
> 1
> 25/03/2005
> F
> 3
> 01/04/2005
> F
> 1
> 06/04/2005
> F
> 5
> 07/04/2005
> F
> 1
> 08/04/2005
> F
> 1
> 13/04/2005
> F
> 1
> 14/04/2005
> F
> 1
> 27/04/2005
> F
> 1
> 01/05/2005
> F
> 2
> 07/05/2005
> F
> 1
> 08/05/2005
> F
> 2
> 16/05/2005
> F
> 1
> 30/05/2005
> F
> 8
> 06/06/2005
> F
> 1
> Here is the script I tried:
>
> barplot(Females2005$Age,  names.arg = c("25/08/2004", "26/09/2004",
> "02/11/2004", "11/11/2004", "22/11/2004", "04/12/2004", "08/12/2004",
>                                        "15/12/2004", "21/12/2004",
> "24/12/2004", "04/01/2005", "06/01/2005", "13/01/2005", "18/01/2005",
>                                        "19/01/2005", "09/02/2005",
> "11/02/2005", "13/02/2005", "17/02/2005", "18/02/2005", "19/02/2005",
>                                       "24/02/2005", "28/02/2005",
> "01/03/2005", "07/03/2005", "08/03/2005", "09/03/2005", "14/03/2005",
>                                     "16/03/2005", "25/03/2005",
> "01/04/2005", "06/04/2005", "07/04/2005", "08/04/2005", "13/04/2005",
>                                       "14/04/2005", "27/04/2005",
> "01/05/2005", "07/05/2005", "08/05/2005", "16/05/2005", "30/05/2005",
>                                     "06/06/2005"), main = 'Females 2005',
> ylab = 'Age/Days', xlab = 'Birth/Hatch date')
>
> Many thanks
> Vasana
> Sent from Mail for Windows 10
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @@r@h@go@lee @ending from gm@il@com  Mon Aug 13 16:32:52 2018
From: @@r@h@go@lee @ending from gm@il@com (Sarah Goslee)
Date: Mon, 13 Aug 2018 10:32:52 -0400
Subject: [R-sig-Geo] 
 How do i plot a graph with x axis vertically labelled?
In-Reply-To: <20180813102510.0C114F3A@hypatia.math.ethz.ch>
References: <20180813102510.0C114F3A@hypatia.math.ethz.ch>
Message-ID: <CAM_vju=PFsdRuChzAaqapbpxGbJpmJqV2M99sEDp1aJkKGth=g@mail.gmail.com>

The graphics parameters are all in the help file for par
?par

The one you need is las.

Without trying to wade thru your mangled HTML data (dput() is the best
way to provide reproducible data), check this out:

barplot(runif(5), names.arg = c("25/08/2004", "26/09/2004",
"02/11/2004", "11/11/2004", "22/11/2004"), main = 'Females 2005', ylab
= ' Age/Days', xlab = 'Birth/Hatch date', las=2)

You'll need to mess with label positioning, and with margin size, to
get everything looking as you wish.

But I'm not sure this is the most effective way to show
irregularly-spaced dates. Why not convert your dates to Date or other
time series, and plot them to scale as points?

Sarah
On Mon, Aug 13, 2018 at 6:25 AM Vasana Tutjavi via R-sig-Geo
<r-sig-geo at r-project.org> wrote:
>
> Dear R-sig-geo experts,
>
> I want to plot a bar graph with the labels on the x axis in a vertical format. The data is the Ages of Squid (on the Y axis) and the date of Birth on the X axis, I am struggling to change the labels on the x axis to a vertical format and I want all the dates to show at all the bars. My data is as follows:
> Birth
> Sex
> Age
> 25/08/2004
> F
> 2
> 26/09/2004
> F
> 3
> 02/11/2004
> F
> 3
> 11/11/2004
> F
> 1
> 22/11/2004
> F
> 3
> 04/12/2004
> F
> 1
> 08/12/2004
> F
> 4
> 15/12/2004
> F
> 4
> 21/12/2004
> F
> 5
> 24/12/2004
> F
> 1
> 04/01/2005
> F
> 1
> 06/01/2005
> F
> 3
> 13/01/2005
> F
> 2
> 18/01/2005
> F
> 1
> 19/01/2005
> F
> 3
> 09/02/2005
> F
> 2
> 11/02/2005
> F
> 1
> 13/02/2005
> F
> 1
> 17/02/2005
> F
> 1
> 18/02/2005
> F
> 8
> 19/02/2005
> F
> 5
> 24/02/2005
> F
> 1
> 28/02/2005
> F
> 42
> 01/03/2005
> F
> 1
> 07/03/2005
> F
> 1
> 08/03/2005
> F
> 2
> 09/03/2005
> F
> 1
> 14/03/2005
> F
> 7
> 16/03/2005
> F
> 1
> 25/03/2005
> F
> 3
> 01/04/2005
> F
> 1
> 06/04/2005
> F
> 5
> 07/04/2005
> F
> 1
> 08/04/2005
> F
> 1
> 13/04/2005
> F
> 1
> 14/04/2005
> F
> 1
> 27/04/2005
> F
> 1
> 01/05/2005
> F
> 2
> 07/05/2005
> F
> 1
> 08/05/2005
> F
> 2
> 16/05/2005
> F
> 1
> 30/05/2005
> F
> 8
> 06/06/2005
> F
> 1
> Here is the script I tried:
>
> barplot(Females2005$Age,  names.arg = c("25/08/2004", "26/09/2004", "02/11/2004", "11/11/2004", "22/11/2004", "04/12/2004", "08/12/2004",
>                                        "15/12/2004", "21/12/2004", "24/12/2004", "04/01/2005", "06/01/2005", "13/01/2005", "18/01/2005",
>                                        "19/01/2005", "09/02/2005", "11/02/2005", "13/02/2005", "17/02/2005", "18/02/2005", "19/02/2005",
>                                       "24/02/2005", "28/02/2005", "01/03/2005", "07/03/2005", "08/03/2005", "09/03/2005", "14/03/2005",
>                                     "16/03/2005", "25/03/2005", "01/04/2005", "06/04/2005", "07/04/2005", "08/04/2005", "13/04/2005",
>                                       "14/04/2005", "27/04/2005", "01/05/2005", "07/05/2005", "08/05/2005", "16/05/2005", "30/05/2005",
>                                     "06/06/2005"), main = 'Females 2005', ylab = 'Age/Days', xlab = 'Birth/Hatch date')
>
> Many thanks
> Vasana
> Sent from Mail for Windows 10
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Sarah Goslee
http://www.functionaldiversity.org


From miluji@b @ending from gm@il@com  Tue Aug 14 17:03:08 2018
From: miluji@b @ending from gm@il@com (Miluji Sb)
Date: Tue, 14 Aug 2018 17:03:08 +0200
Subject: [R-sig-Geo] Extract coordinates from rasterbrick
Message-ID: <CAMLwc7OQy+2-sWrAKHqiXBXA8V5fNVL-+rQ9_3uK_q63D9grtg@mail.gmail.com>

Dear all,

I have the following rasterbrick (x);

class       : RasterBrick
dimensions  : 112, 272, 30464, 7305  (nrow, ncol, ncell, nlayers)
resolution  : 0.25, 0.25  (x, y)
extent      : -132, -64, 24, 52  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
data source : /projectnb/climpct/TEX_1986_2005.nc
names       : X1986.01.01, X1986.01.02, X1986.01.03, X1986.01.04,
X1986.01.05, X1986.01.06, X1986.01.07, X1986.01.08, X1986.01.09,
X1986.01.10, X1986.01.11, X1986.01.12, X1986.01.13, X1986.01.14,
X1986.01.15, ...
Date        : 1986-01-01, 2005-12-31 (min, max)
varname     : tex


I can obtain the values by;

as.data.frame(getValues(x))

However, I would like to extract the values by all coordinates in the file
in the form of a dataframe. Is it possible to do so? Any help will be
greatly appreciated. Thank you.

Sincerely,

Milu

	[[alternative HTML version deleted]]


From bf@levli@t @ending from gm@il@com  Tue Aug 14 17:49:28 2018
From: bf@levli@t @ending from gm@il@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Tue, 14 Aug 2018 17:49:28 +0200
Subject: [R-sig-Geo] Extract coordinates from rasterbrick
In-Reply-To: <CAMLwc7OQy+2-sWrAKHqiXBXA8V5fNVL-+rQ9_3uK_q63D9grtg@mail.gmail.com>
References: <CAMLwc7OQy+2-sWrAKHqiXBXA8V5fNVL-+rQ9_3uK_q63D9grtg@mail.gmail.com>
Message-ID: <13520323-ba3a-555d-e71b-b4a6269d3046@gmail.com>

Dear Milu,

I think that you are looking for as.data.frame(x, xy = TRUE).

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2018.08.14. 17:03 keltez?ssel, Miluji Sb ?rta:
> Dear all,
>
> I have the following rasterbrick (x);
>
> class       : RasterBrick
> dimensions  : 112, 272, 30464, 7305  (nrow, ncol, ncell, nlayers)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -132, -64, 24, 52  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : /projectnb/climpct/TEX_1986_2005.nc
> names       : X1986.01.01, X1986.01.02, X1986.01.03, X1986.01.04,
> X1986.01.05, X1986.01.06, X1986.01.07, X1986.01.08, X1986.01.09,
> X1986.01.10, X1986.01.11, X1986.01.12, X1986.01.13, X1986.01.14,
> X1986.01.15, ...
> Date        : 1986-01-01, 2005-12-31 (min, max)
> varname     : tex
>
>
> I can obtain the values by;
>
> as.data.frame(getValues(x))
>
> However, I would like to extract the values by all coordinates in the file
> in the form of a dataframe. Is it possible to do so? Any help will be
> greatly appreciated. Thank you.
>
> Sincerely,
>
> Milu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From vij@ylull@ @ending from gm@il@com  Tue Aug 14 18:12:13 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Tue, 14 Aug 2018 12:12:13 -0400
Subject: [R-sig-Geo] Extract coordinates from rasterbrick
In-Reply-To: <13520323-ba3a-555d-e71b-b4a6269d3046@gmail.com>
References: <CAMLwc7OQy+2-sWrAKHqiXBXA8V5fNVL-+rQ9_3uK_q63D9grtg@mail.gmail.com>
 <13520323-ba3a-555d-e71b-b4a6269d3046@gmail.com>
Message-ID: <CAKkiGbs8qjS5x6sb900os2QUDksKppojbt=XzhkkGmpioVQU9w@mail.gmail.com>

And if you need coordinates as part of your data frame just do
cbind(coordinates(x), as.data.frame(x, xy = TRUE))

On Tue, Aug 14, 2018 at 11:50 AM Bede-Fazekas ?kos <bfalevlist at gmail.com>
wrote:

> Dear Milu,
>
> I think that you are looking for as.data.frame(x, xy = TRUE).
>
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
>
>
> 2018.08.14. 17:03 keltez?ssel, Miluji Sb ?rta:
> > Dear all,
> >
> > I have the following rasterbrick (x);
> >
> > class       : RasterBrick
> > dimensions  : 112, 272, 30464, 7305  (nrow, ncol, ncell, nlayers)
> > resolution  : 0.25, 0.25  (x, y)
> > extent      : -132, -64, 24, 52  (xmin, xmax, ymin, ymax)
> > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > data source : /projectnb/climpct/TEX_1986_2005.nc
> > names       : X1986.01.01, X1986.01.02, X1986.01.03, X1986.01.04,
> > X1986.01.05, X1986.01.06, X1986.01.07, X1986.01.08, X1986.01.09,
> > X1986.01.10, X1986.01.11, X1986.01.12, X1986.01.13, X1986.01.14,
> > X1986.01.15, ...
> > Date        : 1986-01-01, 2005-12-31 (min, max)
> > varname     : tex
> >
> >
> > I can obtain the values by;
> >
> > as.data.frame(getValues(x))
> >
> > However, I would like to extract the values by all coordinates in the
> file
> > in the form of a dataframe. Is it possible to do so? Any help will be
> > greatly appreciated. Thank you.
> >
> > Sincerely,
> >
> > Milu
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From miluji@b @ending from gm@il@com  Tue Aug 14 21:32:33 2018
From: miluji@b @ending from gm@il@com (Miluji Sb)
Date: Tue, 14 Aug 2018 21:32:33 +0200
Subject: [R-sig-Geo] Extract coordinates from rasterbrick
In-Reply-To: <CAKkiGbs8qjS5x6sb900os2QUDksKppojbt=XzhkkGmpioVQU9w@mail.gmail.com>
References: <CAMLwc7OQy+2-sWrAKHqiXBXA8V5fNVL-+rQ9_3uK_q63D9grtg@mail.gmail.com>
 <13520323-ba3a-555d-e71b-b4a6269d3046@gmail.com>
 <CAKkiGbs8qjS5x6sb900os2QUDksKppojbt=XzhkkGmpioVQU9w@mail.gmail.com>
Message-ID: <CAMLwc7PK0H-LOxRjVJfoOLx+D2eLhQ52Ws=WeNQjkQjd2D4ezQ@mail.gmail.com>

Dear ?kos and Vijay,

Thank you very much for the solutions. They work perfectly!

Sincerely,

Milu

On Tue, Aug 14, 2018 at 6:12 PM, Vijay Lulla <vijaylulla at gmail.com> wrote:

> And if you need coordinates as part of your data frame just do
> cbind(coordinates(x), as.data.frame(x, xy = TRUE))
>
> On Tue, Aug 14, 2018 at 11:50 AM Bede-Fazekas ?kos <bfalevlist at gmail.com>
> wrote:
>
> > Dear Milu,
> >
> > I think that you are looking for as.data.frame(x, xy = TRUE).
> >
> > HTH,
> > ?kos Bede-Fazekas
> > Hungarian Academy of Sciences
> >
> >
> > 2018.08.14. 17:03 keltez?ssel, Miluji Sb ?rta:
> > > Dear all,
> > >
> > > I have the following rasterbrick (x);
> > >
> > > class       : RasterBrick
> > > dimensions  : 112, 272, 30464, 7305  (nrow, ncol, ncell, nlayers)
> > > resolution  : 0.25, 0.25  (x, y)
> > > extent      : -132, -64, 24, 52  (xmin, xmax, ymin, ymax)
> > > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > > data source : /projectnb/climpct/TEX_1986_2005.nc
> > > names       : X1986.01.01, X1986.01.02, X1986.01.03, X1986.01.04,
> > > X1986.01.05, X1986.01.06, X1986.01.07, X1986.01.08, X1986.01.09,
> > > X1986.01.10, X1986.01.11, X1986.01.12, X1986.01.13, X1986.01.14,
> > > X1986.01.15, ...
> > > Date        : 1986-01-01, 2005-12-31 (min, max)
> > > varname     : tex
> > >
> > >
> > > I can obtain the values by;
> > >
> > > as.data.frame(getValues(x))
> > >
> > > However, I would like to extract the values by all coordinates in the
> > file
> > > in the form of a dataframe. Is it possible to do so? Any help will be
> > > greatly appreciated. Thank you.
> > >
> > > Sincerely,
> > >
> > > Milu
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Tue Aug 14 22:16:38 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Tue, 14 Aug 2018 17:16:38 -0300
Subject: [R-sig-Geo] how to create several polygons from a list of vertices
Message-ID: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>

Hi,

I have a data.frame with the vertices (lon / lat) and codes from several
squares (more than 500 in the real dataset).
I want to create an object with these polygons (squares) and after this
export it as a shapefile.
With the script below I can draw one square.
library(sp)
P1 = Polygon(vertices[1:4,1:2])
Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
plot(Ps1, axes = TRUE)

Now I'm trying to create one object with all squares at once.
Is it possible?

Thanks a lot,

Ant?nio Olinto

sample data:vertices
   lon lat cod
1  -33 -23   1
2  -32 -23   1
3  -32 -22   1
4  -33 -22   1
5  -32 -23   2
6  -31 -23   2
7  -31 -22   2
8  -32 -22   2
9  -31 -23   3
10 -30 -23   3
11 -30 -22   3
12 -31 -22   3
13 -33 -22   4
14 -32 -22   4
15 -32 -21   4
16 -33 -21   4
17 -32 -22   5
18 -31 -22   5
19 -31 -21   5
20 -32 -21   5
21 -31 -22   6
22 -30 -22   6
23 -30 -21   6
24 -31 -21   6

	[[alternative HTML version deleted]]


From vij@ylull@ @ending from gm@il@com  Tue Aug 14 23:10:45 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Tue, 14 Aug 2018 17:10:45 -0400
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
Message-ID: <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>

Maybe something like this?

poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
                                             vertices$cod,
                                             function(x)
Polygon(vertices[x,1:2])), ID="1")),
                        proj4string=CRS("+proj=longlat +ellps=WGS84
+datum=WGS84 +no_defs"))


On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com> wrote:

> Hi,
>
> I have a data.frame with the vertices (lon / lat) and codes from several
> squares (more than 500 in the real dataset).
> I want to create an object with these polygons (squares) and after this
> export it as a shapefile.
> With the script below I can draw one square.
> library(sp)
> P1 = Polygon(vertices[1:4,1:2])
> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
> plot(Ps1, axes = TRUE)
>
> Now I'm trying to create one object with all squares at once.
> Is it possible?
>
> Thanks a lot,
>
> Ant?nio Olinto
>
> sample data:vertices
>    lon lat cod
> 1  -33 -23   1
> 2  -32 -23   1
> 3  -32 -22   1
> 4  -33 -22   1
> 5  -32 -23   2
> 6  -31 -23   2
> 7  -31 -22   2
> 8  -32 -22   2
> 9  -31 -23   3
> 10 -30 -23   3
> 11 -30 -22   3
> 12 -31 -22   3
> 13 -33 -22   4
> 14 -32 -22   4
> 15 -32 -21   4
> 16 -33 -21   4
> 17 -32 -22   5
> 18 -31 -22   5
> 19 -31 -21   5
> 20 -32 -21   5
> 21 -31 -22   6
> 22 -30 -22   6
> 23 -30 -21   6
> 24 -31 -21   6
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Wed Aug 15 00:03:02 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Tue, 14 Aug 2018 19:03:02 -0300
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
 <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
Message-ID: <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>

Thanks Lulla,

Nice solution. I could also export it as a shapefile after transforming it
to a spatial polygon dataframe.

The problem is that I could not "individualize" the squares in a multipart
layer. They all have the same ID. I tried to change this without success:
"Single ID required".

The attribute table of the shapefile should have 6 lines in my example and
not only one.

Any other option?

Thanks again,

Antonio Olinto


Em ter, 14 de ago de 2018 ?s 18:10, Vijay Lulla <vijaylulla at gmail.com>
escreveu:

> Maybe something like this?
>
> poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
>                                              vertices$cod,
>                                              function(x)
> Polygon(vertices[x,1:2])), ID="1")),
>                         proj4string=CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84 +no_defs"))
>
>
> On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com>
> wrote:
>
>> Hi,
>>
>> I have a data.frame with the vertices (lon / lat) and codes from several
>> squares (more than 500 in the real dataset).
>> I want to create an object with these polygons (squares) and after this
>> export it as a shapefile.
>> With the script below I can draw one square.
>> library(sp)
>> P1 = Polygon(vertices[1:4,1:2])
>> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
>> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
>> plot(Ps1, axes = TRUE)
>>
>> Now I'm trying to create one object with all squares at once.
>> Is it possible?
>>
>> Thanks a lot,
>>
>> Ant?nio Olinto
>>
>> sample data:vertices
>>    lon lat cod
>> 1  -33 -23   1
>> 2  -32 -23   1
>> 3  -32 -22   1
>> 4  -33 -22   1
>> 5  -32 -23   2
>> 6  -31 -23   2
>> 7  -31 -22   2
>> 8  -32 -22   2
>> 9  -31 -23   3
>> 10 -30 -23   3
>> 11 -30 -22   3
>> 12 -31 -22   3
>> 13 -33 -22   4
>> 14 -32 -22   4
>> 15 -32 -21   4
>> 16 -33 -21   4
>> 17 -32 -22   5
>> 18 -31 -22   5
>> 19 -31 -21   5
>> 20 -32 -21   5
>> 21 -31 -22   6
>> 22 -30 -22   6
>> 23 -30 -21   6
>> 24 -31 -21   6
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From obrl@oil@u @ending from gm@il@com  Wed Aug 15 01:25:06 2018
From: obrl@oil@u @ending from gm@il@com (obrl soil)
Date: Wed, 15 Aug 2018 09:25:06 +1000
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
 <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
 <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
Message-ID: <CALG31BX+8ciRfFtW1aymPJmEbBvCNiPe=+d8W0zuWZ4nMXEANw@mail.gmail.com>

Hi Antonio,

have you tried with sf? Like:

library(sf)

pts <-
  tibble::tribble(~ID,  ~x,  ~y, ~grp,
                   1 , -33, -23,    1,
                   2 , -32, -23,    1,
                   3 , -32, -22,    1,
                   4 , -33, -22,    1,
                   5 , -32, -23,    2,
                   6 , -31, -23,    2,
                   7 , -31, -22,    2,
                   8 , -32, -22,    2,
                   9 , -31, -23,    3,
                   10, -30, -23,    3,
                   11, -30, -22,    3,
                   12, -31, -22,    3,
                   13, -33, -22,    4,
                   14, -32, -22,    4,
                   15, -32, -21,    4,
                   16, -33, -21,    4,
                   17, -32, -22,    5,
                   18, -31, -22,    5,
                   19, -31, -21,    5,
                   20, -32, -21,    5,
                   21, -31, -22,    6,
                   22, -30, -22,    6,
                   23, -30, -21,    6,
                   24, -31, -21,    6)

squares <- split(pts, pts$grp)
squares <- lapply(squares, function(g) {
  # get just coords
  g <- as.matrix(g[, c(2,3)])
  # repeat first point last to close poly
  g <- rbind(g, g[1, ])
  # convert to an sf polygon object
  gp <- sf::st_polygon(list(g))
  # make sure the vertices are in an order
  # that complies with the simple
  # features standard
  gp <- sf::st_buffer(gp, 0L)
})
# turn list of polygons into geometry column
squares_sfc <- sf::st_sfc(squares) # can add crs = ?? to this call
# add an ID to make an sf data frame
squares_sf <- sf::st_sf('ID' = seq(6), 'geometry' = squares_sfc)

# if you still need to use sp for whatever reason
squares_sp <- as(squares_sf, "Spatial")

Regards,
@obrl_soil

On Wed, Aug 15, 2018 at 8:03 AM, Antonio Silva <aolinto.lst at gmail.com> wrote:
> Thanks Lulla,
>
> Nice solution. I could also export it as a shapefile after transforming it
> to a spatial polygon dataframe.
>
> The problem is that I could not "individualize" the squares in a multipart
> layer. They all have the same ID. I tried to change this without success:
> "Single ID required".
>
> The attribute table of the shapefile should have 6 lines in my example and
> not only one.
>
> Any other option?
>
> Thanks again,
>
> Antonio Olinto
>
>
> Em ter, 14 de ago de 2018 ?s 18:10, Vijay Lulla <vijaylulla at gmail.com>
> escreveu:
>
>> Maybe something like this?
>>
>> poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
>>                                              vertices$cod,
>>                                              function(x)
>> Polygon(vertices[x,1:2])), ID="1")),
>>                         proj4string=CRS("+proj=longlat +ellps=WGS84
>> +datum=WGS84 +no_defs"))
>>
>>
>> On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com>
>> wrote:
>>
>>> Hi,
>>>
>>> I have a data.frame with the vertices (lon / lat) and codes from several
>>> squares (more than 500 in the real dataset).
>>> I want to create an object with these polygons (squares) and after this
>>> export it as a shapefile.
>>> With the script below I can draw one square.
>>> library(sp)
>>> P1 = Polygon(vertices[1:4,1:2])
>>> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
>>> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
>>> plot(Ps1, axes = TRUE)
>>>
>>> Now I'm trying to create one object with all squares at once.
>>> Is it possible?
>>>
>>> Thanks a lot,
>>>
>>> Ant?nio Olinto
>>>
>>> sample data:vertices
>>>    lon lat cod
>>> 1  -33 -23   1
>>> 2  -32 -23   1
>>> 3  -32 -22   1
>>> 4  -33 -22   1
>>> 5  -32 -23   2
>>> 6  -31 -23   2
>>> 7  -31 -22   2
>>> 8  -32 -22   2
>>> 9  -31 -23   3
>>> 10 -30 -23   3
>>> 11 -30 -22   3
>>> 12 -31 -22   3
>>> 13 -33 -22   4
>>> 14 -32 -22   4
>>> 15 -32 -21   4
>>> 16 -33 -21   4
>>> 17 -32 -22   5
>>> 18 -31 -22   5
>>> 19 -31 -21   5
>>> 20 -32 -21   5
>>> 21 -31 -22   6
>>> 22 -30 -22   6
>>> 23 -30 -21   6
>>> 24 -31 -21   6
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From md@umner @ending from gm@il@com  Wed Aug 15 02:09:57 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Wed, 15 Aug 2018 10:09:57 +1000
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CALG31BX+8ciRfFtW1aymPJmEbBvCNiPe=+d8W0zuWZ4nMXEANw@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
 <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
 <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
 <CALG31BX+8ciRfFtW1aymPJmEbBvCNiPe=+d8W0zuWZ4nMXEANw@mail.gmail.com>
Message-ID: <CAAcGz9-dZzvSVSFhP+-VAaG=VOnEAVh7cWEsOAJ3Kuu5Qu6ptg@mail.gmail.com>

Here's another way with spbabel.


library(dplyr)
library(spbabel)
pts <-
  tibble::tribble(~ID,  ~x,  ~y, ~grp,
                   1 , -33, -23,    1,
                   2 , -32, -23,    1,
                   3 , -32, -22,    1,
                   4 , -33, -22,    1,
                   5 , -32, -23,    2,
                   6 , -31, -23,    2,
                   7 , -31, -22,    2,
                   8 , -32, -22,    2,
                   9 , -31, -23,    3,
                   10, -30, -23,    3,
                   11, -30, -22,    3,
                   12, -31, -22,    3,
                   13, -33, -22,    4,
                   14, -32, -22,    4,
                   15, -32, -21,    4,
                   16, -33, -21,    4,
                   17, -32, -22,    5,
                   18, -31, -22,    5,
                   19, -31, -21,    5,
                   20, -32, -21,    5,
                   21, -31, -22,    6,
                   22, -30, -22,    6,
                   23, -30, -21,    6,
                   24, -31, -21,    6)


## objects and branches (parts) are the same level

## objects and branches (parts) are the same level
## and we maintain "grp" as the object attribute data
x <- pts %>% transmute(grp = grp, x_ = x, y_ = y,
               object_ = grp, branch_ = grp,
               order_ = ID, island_ = TRUE) %>% spbabel::sp()





On Wed, 15 Aug 2018 at 09:25 obrl soil <obrlsoilau at gmail.com> wrote:

> Hi Antonio,
>
> have you tried with sf? Like:
>
> library(sf)
>
> pts <-
>   tibble::tribble(~ID,  ~x,  ~y, ~grp,
>                    1 , -33, -23,    1,
>                    2 , -32, -23,    1,
>                    3 , -32, -22,    1,
>                    4 , -33, -22,    1,
>                    5 , -32, -23,    2,
>                    6 , -31, -23,    2,
>                    7 , -31, -22,    2,
>                    8 , -32, -22,    2,
>                    9 , -31, -23,    3,
>                    10, -30, -23,    3,
>                    11, -30, -22,    3,
>                    12, -31, -22,    3,
>                    13, -33, -22,    4,
>                    14, -32, -22,    4,
>                    15, -32, -21,    4,
>                    16, -33, -21,    4,
>                    17, -32, -22,    5,
>                    18, -31, -22,    5,
>                    19, -31, -21,    5,
>                    20, -32, -21,    5,
>                    21, -31, -22,    6,
>                    22, -30, -22,    6,
>                    23, -30, -21,    6,
>                    24, -31, -21,    6)
>
> squares <- split(pts, pts$grp)
> squares <- lapply(squares, function(g) {
>   # get just coords
>   g <- as.matrix(g[, c(2,3)])
>   # repeat first point last to close poly
>   g <- rbind(g, g[1, ])
>   # convert to an sf polygon object
>   gp <- sf::st_polygon(list(g))
>   # make sure the vertices are in an order
>   # that complies with the simple
>   # features standard
>   gp <- sf::st_buffer(gp, 0L)
> })
> # turn list of polygons into geometry column
> squares_sfc <- sf::st_sfc(squares) # can add crs = ?? to this call
> # add an ID to make an sf data frame
> squares_sf <- sf::st_sf('ID' = seq(6), 'geometry' = squares_sfc)
>
> # if you still need to use sp for whatever reason
> squares_sp <- as(squares_sf, "Spatial")
>
> Regards,
> @obrl_soil
>
> On Wed, Aug 15, 2018 at 8:03 AM, Antonio Silva <aolinto.lst at gmail.com>
> wrote:
> > Thanks Lulla,
> >
> > Nice solution. I could also export it as a shapefile after transforming
> it
> > to a spatial polygon dataframe.
> >
> > The problem is that I could not "individualize" the squares in a
> multipart
> > layer. They all have the same ID. I tried to change this without success:
> > "Single ID required".
> >
> > The attribute table of the shapefile should have 6 lines in my example
> and
> > not only one.
> >
> > Any other option?
> >
> > Thanks again,
> >
> > Antonio Olinto
> >
> >
> > Em ter, 14 de ago de 2018 ?s 18:10, Vijay Lulla <vijaylulla at gmail.com>
> > escreveu:
> >
> >> Maybe something like this?
> >>
> >> poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
> >>                                              vertices$cod,
> >>                                              function(x)
> >> Polygon(vertices[x,1:2])), ID="1")),
> >>                         proj4string=CRS("+proj=longlat +ellps=WGS84
> >> +datum=WGS84 +no_defs"))
> >>
> >>
> >> On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com>
> >> wrote:
> >>
> >>> Hi,
> >>>
> >>> I have a data.frame with the vertices (lon / lat) and codes from
> several
> >>> squares (more than 500 in the real dataset).
> >>> I want to create an object with these polygons (squares) and after this
> >>> export it as a shapefile.
> >>> With the script below I can draw one square.
> >>> library(sp)
> >>> P1 = Polygon(vertices[1:4,1:2])
> >>> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
> >>> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
> >>> plot(Ps1, axes = TRUE)
> >>>
> >>> Now I'm trying to create one object with all squares at once.
> >>> Is it possible?
> >>>
> >>> Thanks a lot,
> >>>
> >>> Ant?nio Olinto
> >>>
> >>> sample data:vertices
> >>>    lon lat cod
> >>> 1  -33 -23   1
> >>> 2  -32 -23   1
> >>> 3  -32 -22   1
> >>> 4  -33 -22   1
> >>> 5  -32 -23   2
> >>> 6  -31 -23   2
> >>> 7  -31 -22   2
> >>> 8  -32 -22   2
> >>> 9  -31 -23   3
> >>> 10 -30 -23   3
> >>> 11 -30 -22   3
> >>> 12 -31 -22   3
> >>> 13 -33 -22   4
> >>> 14 -32 -22   4
> >>> 15 -32 -21   4
> >>> 16 -33 -21   4
> >>> 17 -32 -22   5
> >>> 18 -31 -22   5
> >>> 19 -31 -21   5
> >>> 20 -32 -21   5
> >>> 21 -31 -22   6
> >>> 22 -30 -22   6
> >>> 23 -30 -21   6
> >>> 24 -31 -21   6
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From vij@ylull@ @ending from gm@il@com  Wed Aug 15 04:19:24 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Tue, 14 Aug 2018 22:19:24 -0400
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
 <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
 <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
Message-ID: <CAKkiGbuefA=gPFbi2o9RsN+jiUsMDacwnSyVfqahcS+C4CU=Fw@mail.gmail.com>

Maybe you can try this then?

polys <- SpatialPolygons(lapply(unique(vertices$cod),
                         function(x) {
                           Polygons(list(Polygon(vertices[vertices$cod ==
x, 1:2])), ID=x)
                         } ))
HTH,
Vijay.

On Tue, Aug 14, 2018 at 6:03 PM Antonio Silva <aolinto.lst at gmail.com> wrote:

> Thanks Lulla,
>
> Nice solution. I could also export it as a shapefile after transforming it
> to a spatial polygon dataframe.
>
> The problem is that I could not "individualize" the squares in a multipart
> layer. They all have the same ID. I tried to change this without success:
> "Single ID required".
>
> The attribute table of the shapefile should have 6 lines in my example and
> not only one.
>
> Any other option?
>
> Thanks again,
>
> Antonio Olinto
>
>
> Em ter, 14 de ago de 2018 ?s 18:10, Vijay Lulla <vijaylulla at gmail.com>
> escreveu:
>
>> Maybe something like this?
>>
>> poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
>>                                              vertices$cod,
>>                                              function(x)
>> Polygon(vertices[x,1:2])), ID="1")),
>>                         proj4string=CRS("+proj=longlat +ellps=WGS84
>> +datum=WGS84 +no_defs"))
>>
>>
>> On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com>
>> wrote:
>>
>>> Hi,
>>>
>>> I have a data.frame with the vertices (lon / lat) and codes from several
>>> squares (more than 500 in the real dataset).
>>> I want to create an object with these polygons (squares) and after this
>>> export it as a shapefile.
>>> With the script below I can draw one square.
>>> library(sp)
>>> P1 = Polygon(vertices[1:4,1:2])
>>> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
>>> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
>>> plot(Ps1, axes = TRUE)
>>>
>>> Now I'm trying to create one object with all squares at once.
>>> Is it possible?
>>>
>>> Thanks a lot,
>>>
>>> Ant?nio Olinto
>>>
>>> sample data:vertices
>>>    lon lat cod
>>> 1  -33 -23   1
>>> 2  -32 -23   1
>>> 3  -32 -22   1
>>> 4  -33 -22   1
>>> 5  -32 -23   2
>>> 6  -31 -23   2
>>> 7  -31 -22   2
>>> 8  -32 -22   2
>>> 9  -31 -23   3
>>> 10 -30 -23   3
>>> 11 -30 -22   3
>>> 12 -31 -22   3
>>> 13 -33 -22   4
>>> 14 -32 -22   4
>>> 15 -32 -21   4
>>> 16 -33 -21   4
>>> 17 -32 -22   5
>>> 18 -31 -22   5
>>> 19 -31 -21   5
>>> 20 -32 -21   5
>>> 21 -31 -22   6
>>> 22 -30 -22   6
>>> 23 -30 -21   6
>>> 24 -31 -21   6
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>

-- 
Vijay Lulla

Assistant Professor,
Dept. of Geography, IUPUI
425 University Blvd, CA-207C.
Indianapolis, IN-46202
vlulla at iupui.edu
ORCID: https://orcid.org/0000-0002-0823-2522
Webpage: http://vijaylulla.com

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Wed Aug 15 10:51:35 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Wed, 15 Aug 2018 10:51:35 +0200
Subject: [R-sig-Geo] PhD course ECS530, Bergen, 3-8 December
Message-ID: <alpine.LFD.2.21.1808142030510.23064@reclus.nhh.no>

A PhD-level course in spatial data analysis (ECS530, Auditorium C) will be 
held 3-8 December 2018 in Bergen:

https://www.nhh.no/en/courses/analysing-spatial-data/

External participants should apply using this form:

https://www.nhh.no/en/study-programmes/phd-programme-at-nhh/phd-courses/application-to-follow-phd-courses-at-nhh/

For further details see the course page.

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@Biv@nd @ending from nhh@no  Wed Aug 15 11:18:35 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Wed, 15 Aug 2018 11:18:35 +0200
Subject: [R-sig-Geo] PhD course ECS530, Bergen, 3-8 December
In-Reply-To: <alpine.LFD.2.21.1808142030510.23064@reclus.nhh.no>
References: <alpine.LFD.2.21.1808142030510.23064@reclus.nhh.no>
Message-ID: <alpine.LFD.2.21.1808151117212.26052@reclus.nhh.no>

On Wed, 15 Aug 2018, Roger Bivand wrote:

> A PhD-level course in spatial data analysis (ECS530, Auditorium C) will be 
> held 3-8 December 2018 in Bergen:
>
> https://www.nhh.no/en/courses/analysing-spatial-data/
>
> External participants should apply using this form:
>
> https://www.nhh.no/en/study-programmes/phd-programme-at-nhh/phd-courses/application-to-follow-phd-courses-at-nhh/
>
> For further details see the course page.

I've already been asked about support: participants must cover their own 
travel and living costs; no support is offered, I'm afraid, apart from 
free tuition.

Roger

>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From li@@@menez @ending from free@fr  Wed Aug 15 12:50:27 2018
From: li@@@menez @ending from free@fr (Lisa Menez)
Date: Wed, 15 Aug 2018 12:50:27 +0200
Subject: [R-sig-Geo] [localmoran.exact]
In-Reply-To: <alpine.LFD.2.21.1808141947550.22972@reclus.nhh.no>
References: <CE1B9469-4F3F-4D55-B971-FA3E5BF11E01@free.fr>
 <73110819-ECF8-48E9-AA46-E345190C8764@free.fr>
 <alpine.LFD.2.21.1808131601090.18696@reclus.nhh.no>
 <F0E70D87-721C-41B2-A78D-EC8A9BCBAFF3@free.fr>
 <alpine.LFD.2.21.1808141947550.22972@reclus.nhh.no>
Message-ID: <9AF39546-FCC7-4D0D-B3E8-9215A6E9C19D@free.fr>


> Le 14 ao?t 2018 ? 20:09, Roger Bivand <Roger.Bivand at nhh.no> a ?crit :
> 
> If you post, you then reply in-thread on the list. Otherwise, nobody else knows what the resolution was. : 
Sorry. My bad. 
> 
> Your explanation below contains lots of inaccuracies - all Spatial*DataFrames have standard data.frame access methods as I showed.
No doubt about it ! I will try do better now that I know about it.  

Thank you Sir.
Lisa 

> 
> Roger Bivand
> 
> On Tue, 14 Aug 2018, Lisa Menez wrote:
> 
>> Sir Bivand,
>> 
>> The complete example was here :
>> 
>> My database is available here : http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt> and my code : http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt>
>> 
>> The localmoran.sad() actually works. Is it because ? If we assume global spatial independence, we can give for any projection matrix M the spectrum of eigenvalues as well as the saddle point approximation of local Moran?s Ii in analytical terms. This increases the computational efficiency as it avoids reverting to numerical calculations of the spectrum of eigenvalues and finding iteratively the root of the saddle point equation ? ?
>> 
>> To the best of my knowledge, I am constrained by the settings of my data (extracted from Eurostat) on calling EU_NUTS at data rather than EU_NUTS. Indeed EU_NUTS are spatial polygons and EU_NUTS at data their relative attributes. I failed to change this name.
>> 
>> for each i, EU_NUTS at data[,year[i]] is a numerical vector. year is a character vector containing the sample years, allowing to go through the corresponding EU_NUTS at data' columns.
>> 
>> On your advice, I tried to go through debug(localmoran.exact). As I could not find any good reason why (2*t2<t1^2), I turned to your last remark : Changing NUTS_L1 into a factor before using it into the loop. It actually was the issue. I miscoded the factor, keeping character chains and not transforming them into numbers.
>> 
>> 
>> Thank you very much for your help and recommandations.
>> Lisa
>> 
>> 
>>> Le 13 ao?t 2018 ? 16:12, Roger Bivand <Roger.Bivand at nhh.no> a ?crit :
>>> 
>>> On Mon, 13 Aug 2018, Lisa Menez wrote:
>>> 
>>>> 
>>>> Dear all,
>>>> 
>>>> I have been trying to obtain local Moran?s I with the exact approach (localmoran.exact) but I have some issues and would need your help.
>>> 
>>> A complete reproducible example is required (script and data, data may be downloaded, do not attach). Does the same thing happen with localmoran.sad()?
>>> 
>>>> 
>>>> I am trying to bring to light how spatial patterns of wealth have evolved from 2000 to 2016 in the European Union.
>>>> 
>>>> Looking at the Regional Gross Domestic Product (GDP) of European regions, my lm model looks like this :
>>>> 
>>>> lm(log(EU_NUTS at data[,year[i]])~1+factor(EU_NUTS at data$NUTS_L1))
>>>> 
>>>> where log(EU_NUTS at data[,year[i]]) are log of regional GDPs
>>>> 
>>> 
>>> Never, ever use @ to access data. EU_NUTS at data$NUTS_L1 should be EU_NUTS$NUTS_L1 and should be (made a) factor first. It isn't clear what log(EU_NUTS at data[,year[i]]) will end up being - is "year" a character vector? If so, EU_NUTS[[year[i]]] is the correct syntax.
>>> 
>>>> and factor(EU_NUTS at data$NUTS_L1) is the vector of country dummies.
>>>> 
>>>> Sadly, I obtain an error message that says :
>>>> 
>>>> Error in integrate(integrand, lower = 0, upper = upper) :
>>>> a limit is missing
>>>> Moreover : Warning messages:
>>>> 1: In sqrt(2 * t2 - t1^2) : production of NaN
>>>> 2: In sqrt(2 * t2 - t1^2) : production of NaN
>>>> 
>>>> According to the GitHub source code ,
>>> 
>>> No, as you can see from https://cran.r-project.org/package=spdep, the development site of spdep is https://github.com/r-spatial/spdep/. Never use non-authorised copies. To see the source, simply type the function name. Use debug(localmoran.exact) to step through the function while it runs, to see the values of the objects you are in doubt about. Do not do this in RStudio, its debugging interface tries to be far too clever.
>>> 
>>> The following is illegible in plain text; post in plain text only.
>>> 
>>> Roger
>>> 
>>>> 
>>>>      Vi <- listw2star <https://rdrr.io/cran/spdep/man/localmoran.sad.html>(B, select[i], style=style, n, D <https://rdrr.io/r/stats/deriv.html>, a,
>>>> 	    zero.policy=zero.policy)
>>>>      Viu <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, u, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
>>>> 	Ii <- c <https://rdrr.io/r/base/c.html>(crossprod <https://rdrr.io/r/base/crossprod.html>(u, Viu) / utu)
>>>>      ViX <- lag.listw <https://rdrr.io/cran/spdep/man/lag.listw.html>(Vi, X, zero.policy=TRUE <https://rdrr.io/r/base/logical.html>)
>>>>      MViM <- t <https://rdrr.io/r/base/t.html>(X) %*% ViX %*% XtXinv
>>>>      t1 <- -sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM))
>>>>      sumsq.Vi <- function <https://rdrr.io/r/base/function.html>(x) {
>>>>          if <https://rdrr.io/r/base/Control.html> (is.null <https://rdrr.io/r/base/NULL.html>(x)) NA <https://rdrr.io/r/base/NA.html>
>>>> 	    else <https://rdrr.io/r/base/Control.html> sum <https://rdrr.io/r/base/sum.html>(x^2)
>>>> 	}
>>>> 	trVi2 <- sum <https://rdrr.io/r/base/sum.html>(sapply <https://rdrr.io/r/base/lapply.html>(Vi$weights <https://rdrr.io/r/stats/weights.html>, sumsq.Vi), na.rm=TRUE <https://rdrr.io/r/base/logical.html>)
>>>> 	t2a <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(t <https://rdrr.io/r/base/t.html>(ViX) %*% ViX %*% XtXinv))
>>>> 	t2b <- sum <https://rdrr.io/r/base/sum.html>(diag <https://rdrr.io/r/base/diag.html>(MViM %*% MViM))
>>>> 	t2 <- trVi2 - 2*t2a + t2b
>>>> 	e1 <- 0.5 * (t1 + sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))
>>>> 	en <- 0.5 * (t1 - sqrt <https://rdrr.io/r/base/MathFun.html>(2*t2 - t1^2))
>>>> 
>>>> My guess is that my setting causes (2*t2<t1^2) : Is it ? Why would it ?
>>>> 
>>>> My database is available here : http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/mydata2018-1.txt>
>>>> and my code : http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt <http://hcc.cnrs.fr/wp-content/uploads/2018/08/myCode_2018.txt>
>>>> 
>>>> I thank you very much for your attention and your help.
>>>> 
>>>> Best Regards
>>>> Lisa
>>>> 
>>>> PhD Student
>>>> GREDEG, Universit? C?t? d?Azur
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 	[[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> http://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>> 
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @olinto@l@t @ending from gm@il@com  Thu Aug 16 01:36:34 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Wed, 15 Aug 2018 20:36:34 -0300
Subject: [R-sig-Geo] 
 how to create several polygons from a list of vertices
In-Reply-To: <CAKkiGbuefA=gPFbi2o9RsN+jiUsMDacwnSyVfqahcS+C4CU=Fw@mail.gmail.com>
References: <CAE8g1gPnvB5WmV1XpbrmR=GEW7TXwHHjXO8Bywqwo8hQ+m=j9g@mail.gmail.com>
 <CAKkiGbunbVqE9hvpnMNtyT2dj1+cZVnQnnPqfcMWJ4kgosEoww@mail.gmail.com>
 <CAE8g1gNpTRCqQrW+Y0crFNUminZxBbqSmch3G4Nsxq3pdBRUtg@mail.gmail.com>
 <CAKkiGbuefA=gPFbi2o9RsN+jiUsMDacwnSyVfqahcS+C4CU=Fw@mail.gmail.com>
Message-ID: <CAE8g1gNyDagbX7a-eFWaemkbfGQ39=08xtN37Y4M-RbxsFDeYA@mail.gmail.com>

Hi Vijay, Michael and Obrl

Thanks for the answers, finally I could do the job.

I learned a lot too!

Best regards

Antonio Olinto

Em Ter, 14 de ago de 2018 11:19 PM, Vijay Lulla <vijaylulla at gmail.com>
escreveu:

> Maybe you can try this then?
>
> polys <- SpatialPolygons(lapply(unique(vertices$cod),
>                          function(x) {
>                            Polygons(list(Polygon(vertices[vertices$cod ==
> x, 1:2])), ID=x)
>                          } ))
> HTH,
> Vijay.
>
> On Tue, Aug 14, 2018 at 6:03 PM Antonio Silva <aolinto.lst at gmail.com>
> wrote:
>
>> Thanks Lulla,
>>
>> Nice solution. I could also export it as a shapefile after transforming
>> it to a spatial polygon dataframe.
>>
>> The problem is that I could not "individualize" the squares in a
>> multipart layer. They all have the same ID. I tried to change this without
>> success: "Single ID required".
>>
>> The attribute table of the shapefile should have 6 lines in my example
>> and not only one.
>>
>> Any other option?
>>
>> Thanks again,
>>
>> Antonio Olinto
>>
>>
>> Em ter, 14 de ago de 2018 ?s 18:10, Vijay Lulla <vijaylulla at gmail.com>
>> escreveu:
>>
>>> Maybe something like this?
>>>
>>> poly <- SpatialPolygons(list(Polygons(tapply(seq_len(nrow(vertices)),
>>>                                              vertices$cod,
>>>                                              function(x)
>>> Polygon(vertices[x,1:2])), ID="1")),
>>>                         proj4string=CRS("+proj=longlat +ellps=WGS84
>>> +datum=WGS84 +no_defs"))
>>>
>>>
>>> On Tue, Aug 14, 2018 at 4:17 PM Antonio Silva <aolinto.lst at gmail.com>
>>> wrote:
>>>
>>>> Hi,
>>>>
>>>> I have a data.frame with the vertices (lon / lat) and codes from several
>>>> squares (more than 500 in the real dataset).
>>>> I want to create an object with these polygons (squares) and after this
>>>> export it as a shapefile.
>>>> With the script below I can draw one square.
>>>> library(sp)
>>>> P1 = Polygon(vertices[1:4,1:2])
>>>> Ps1 = SpatialPolygons(list(Polygons(list(P1), ID = "1")),
>>>> proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))
>>>> plot(Ps1, axes = TRUE)
>>>>
>>>> Now I'm trying to create one object with all squares at once.
>>>> Is it possible?
>>>>
>>>> Thanks a lot,
>>>>
>>>> Ant?nio Olinto
>>>>
>>>> sample data:vertices
>>>>    lon lat cod
>>>> 1  -33 -23   1
>>>> 2  -32 -23   1
>>>> 3  -32 -22   1
>>>> 4  -33 -22   1
>>>> 5  -32 -23   2
>>>> 6  -31 -23   2
>>>> 7  -31 -22   2
>>>> 8  -32 -22   2
>>>> 9  -31 -23   3
>>>> 10 -30 -23   3
>>>> 11 -30 -22   3
>>>> 12 -31 -22   3
>>>> 13 -33 -22   4
>>>> 14 -32 -22   4
>>>> 15 -32 -21   4
>>>> 16 -33 -21   4
>>>> 17 -32 -22   5
>>>> 18 -31 -22   5
>>>> 19 -31 -21   5
>>>> 20 -32 -21   5
>>>> 21 -31 -22   6
>>>> 22 -30 -22   6
>>>> 23 -30 -21   6
>>>> 24 -31 -21   6
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>
> --
> Vijay Lulla
>
> Assistant Professor,
> Dept. of Geography, IUPUI
> 425 University Blvd, CA-207C.
> Indianapolis, IN-46202
> vlulla at iupui.edu
> ORCID: https://orcid.org/0000-0002-0823-2522
> Webpage: http://vijaylulla.com
>

	[[alternative HTML version deleted]]


From @tef@no@@ofi@ @ending from regione@m@rche@it  Thu Aug 16 09:21:15 2018
From: @tef@no@@ofi@ @ending from regione@m@rche@it (Stefano Sofia)
Date: Thu, 16 Aug 2018 07:21:15 +0000
Subject: [R-sig-Geo] correct use of autoKrige and gstat with Digital
 Elevation Models
Message-ID: <8B435C9568170B469AE31E8891E8CC4F54CCCA86@ESINO.regionemarche.intra>

Dear R-sig-geo list users,
I am dealing with rainfall isohyet maps, I am using a DEM in order to get more accurate values.
In particular I am trying to compare Kriging method (through autoKrige) with the Inverse Distance method (through gstat).
Kriging code works fine, I think that I am not able to make a correct use of gstat.

In both cases,
- I load my rainfall cumulates in a data frame called df_prec:

Codice_sensore Cumulata Long_Cent Lat_Cent Quota
3134 177 13.22888 42.99361  1352
3135 98 13.19046 42.85843  1496
3136 40 12.81444 43.23840  1005
3137 201 13.30681 42.84369  1036
3138 145 13.32638 42.90215   980
3139 45 13.11180 42.79578  1575
3140 69 13.18538 42.91439  1800
3234 129 13.44506 42.74417   960

- I load the shape file and the DEM:

## LOAD SHAPEFILE
Shape_area5 <- readOGR(dsn="area5.shp", layer="area5")
Shape_area5_projection <- "+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
Shape_area5 <- spTransform(Shape_area5, CRS(Shape_area5_projection))
## LOADING DEM
ita_DEM <- getData('alt', country='ITA', mask=FALSE)
ita_DEM <- projectRaster(ita_DEM, crs = CRS("+init=epsg:32633"))

- I put the coordinates in the correct way, I evaluate the extracted elevation values and I create a new grid with these new values:

##
coordinates(df_prec) <- ~Long_Cent+Lat_Cent
proj4string(df_prec) <- CRS("+init=epsg:4326")
df_prec <- spTransform(df_prec, CRS("+init=epsg:32633"))
## EXTRACT THE ELEVATION VALUES TO MY POINTS; extract EXPECTS A RASTER INPUT
df_prec$ExtractedElevationValues <- extract(x=ita_DEM, y=df_prec)
## CREATE A NEW GRID
newgrid <- as(ita_DEM, "SpatialGridDataFrame")
names(newgrid) <- "ExtractedElevationValues"

- when I apply Kriging, everything works fine
## KRIGING
RegressionKriging_rainfall <- autoKrige(Cumulata~ExtractedElevationValues, df_prec, newgrid)
prec_rast <- raster(RegressionKriging_rainfall$krige_output)

- if I use gstat in the standard way

Inverse_Distance_rainfall <- gstat(formula=Cumulata~1, data=df_prec, locations=newgrid)

everything goes fine, but this code obviously does not take into consideration the elevation points. When I try to use the inverse distance method like Kriging:
Inverse_Distance_rainfall <- gstat(formula=Cumulata~ExtractedElevationValues, df_prec, newgrid)

I get the following error:

Error in (function (classes, fdef, mtable)  :
  unable to find an inherited method for function ?proj4string? for signature ?"NULL"?
  Calls: my_inversedistanceweighted_DEM -> gstat -> proj4string -> <Anonymous>


Where is my mistake?
Could please somebody help me and give me a hint for a correst use of gstat?
Thank you for your attention and your help
Stefano


         (oo)
--oOO--( )--OOo----------------
Stefano Sofia PhD
Area Meteorologica e  Area nivologica - Centro Funzionale
Servizio Protezione Civile - Regione Marche
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona
Uff: 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------

________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libra ESVA ed  risultato non infetto.
This message was scanned by Libra ESVA and is believed to be clean.


	[[alternative HTML version deleted]]


From dechen@lh@m @ending from ieu@uzh@ch  Thu Aug 16 13:44:54 2018
From: dechen@lh@m @ending from ieu@uzh@ch (Dechen Lham)
Date: Thu, 16 Aug 2018 13:44:54 +0200
Subject: [R-sig-Geo] Morans I
Message-ID: <D4554399-0016-4384-91FA-F685EE43BEFA@ieu.uzh.ch>

hi all,

is the below the correct way to access spatial autocorrelation using morans I in a glm:

#get coordinates first
coords<-as.matrix(cbind(data$long,data$lat))

#model
m1 <- glm(response~ predictor1 + predictor 2+ predictor1*predictor2, family=binomial, data=data)

# Compute Moran's I using residuals of model
lstw <- nb2listw((knn2nb(knearneigh(coords, k=1))))

moran.test(residuals(m1), lstw) 


Advise from experts using function moran.test will be much appreciated. 

From K@therine@B@nn@r-M@rtin @ending from dfo-mpo@gc@c@  Thu Aug 16 22:52:31 2018
From: K@therine@B@nn@r-M@rtin @ending from dfo-mpo@gc@c@ (Bannar-Martin, Katherine)
Date: Thu, 16 Aug 2018 20:52:31 +0000
Subject: [R-sig-Geo] st_distance to replace dist in pipes - help needed
Message-ID: <C58761628CE59340834AA8638074761A35DA62@DFBCV6CWPEXP001.ENT.dfo-mpo.ca>

Hello!

Problem:
I need to take the following code and replace dist in the "created distance matrix" pipe stream (producing object 'res') with st_distance. I'm stuck on how to play with the geometry section so that it reproduces the same distance matrix as dist.mat. (The numbers will be different because of the calculations employed, I know, but the structure of the matrices should be the same). Any help is greatly appreciated. Thanks! Katherine

Code using stats::dist:

###Dependencies####
require(tidyverse)
require(sf)

####Create sample data in decimal degrees:####

START_LONG<-round(runif(n=10,min=-135.7, max=-123.3),digits=4)
START_LAT<-round(runif(n=10,min=48.26, max=55.80),digits=4)
END_LONG<-round(runif(n=10,min=-135.7, max=-123.3),digits=4)
END_LAT<-round(runif(n=10,min=48.28, max=55.82),digits=4)
df<-as.data.frame(cbind(START_LONG,START_LAT,END_LONG,END_LAT))

###convert to utm with package sf
xy1<-df[,c("START_LONG","START_LAT")] #start locations
colnames(xy1)<-c("X", "Y")
xy2<-df[,c("END_LONG","END_LAT")] #end locations
colnames(xy2)<-c("X", "Y")
xy12 <- rbind(as.matrix(xy1), as.matrix(xy2))
df12 <- data.frame(data.frame(xy12, Attribute = rep(c("start","end"),each=nrow(df)), ID = rep(1:(nrow(df)),2)))

df.SP <- st_as_sf(df12, coords = c("X", "Y"), crs = 4326) #wgs84 long lat
df.SP<-st_transform(x = df.SP, crs = 32609) #convert to wgs84 utm zone 9
df.SP$utm_x<-st_coordinates(df.SP)[,1] # get utm coordinates
df.SP$utm_y<-st_coordinates(df.SP)[,2] # get utm coordinates
df.SP<-st_set_geometry(df.SP, NULL)# coerce back to data.frame

###create distance matrix###
res<- df.SP %>%
  dplyr::group_by(Attribute) %>%
  mutate(rows = row_number()) %>%
  left_join(df.SP, by = c('Attribute')) %>%
  rowwise() %>%
  mutate(Distance = ifelse(dist(rbind(c(utm_x.x, utm_y.x), c(utm_x.y, utm_y.y))) != 0,
                           dist(rbind(c(utm_x.x, utm_y.x), c(utm_x.y, utm_y.y))), NA))

dist.mat<-matrix(res$Distance,nrow = 20,ncol = 20)

Data prep for eventually using sf::st_distance:
pts.utm.sf <- df12 %>%
  st_as_sf(coords=c('X','Y'), crs=4326) %>% #wgs84 long lat
  st_transform(32609) #wgs84 utm zone9

#distance matrix without groups (note using group_by "Attribute" does not get me the matrix I want):
dist.utm<- pts.utm.sf %>% st_distance() #calculate distances on utm in m

	[[alternative HTML version deleted]]


From vij@ylull@ @ending from gm@il@com  Fri Aug 17 02:09:32 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Thu, 16 Aug 2018 20:09:32 -0400
Subject: [R-sig-Geo] st_distance to replace dist in pipes - help needed
In-Reply-To: <C58761628CE59340834AA8638074761A35DA62@DFBCV6CWPEXP001.ENT.dfo-mpo.ca>
References: <C58761628CE59340834AA8638074761A35DA62@DFBCV6CWPEXP001.ENT.dfo-mpo.ca>
Message-ID: <CAKkiGbsVVxb7oWhzxRX+38HDD0Q88FY-sKpsX=_frmki3ukrTg@mail.gmail.com>

Maybe like this?

dist.utm <- matrix(c(st_distance(pts.utm.sf %>%
filter(Attribute=="start")),
                     st_distance(pts.utm.sf %>% filter(Attribute=="end"))),
                     nrow=20,ncol=20)
all.equal(dist.utm, dist.mat)

On Thu, Aug 16, 2018 at 4:53 PM Bannar-Martin, Katherine <
Katherine.Bannar-Martin at dfo-mpo.gc.ca> wrote:

> Hello!
>
> Problem:
> I need to take the following code and replace dist in the "created
> distance matrix" pipe stream (producing object 'res') with st_distance. I'm
> stuck on how to play with the geometry section so that it reproduces the
> same distance matrix as dist.mat. (The numbers will be different because of
> the calculations employed, I know, but the structure of the matrices should
> be the same). Any help is greatly appreciated. Thanks! Katherine
>
> Code using stats::dist:
>
> ###Dependencies####
> require(tidyverse)
> require(sf)
>
> ####Create sample data in decimal degrees:####
>
> START_LONG<-round(runif(n=10,min=-135.7, max=-123.3),digits=4)
> START_LAT<-round(runif(n=10,min=48.26, max=55.80),digits=4)
> END_LONG<-round(runif(n=10,min=-135.7, max=-123.3),digits=4)
> END_LAT<-round(runif(n=10,min=48.28, max=55.82),digits=4)
> df<-as.data.frame(cbind(START_LONG,START_LAT,END_LONG,END_LAT))
>
> ###convert to utm with package sf
> xy1<-df[,c("START_LONG","START_LAT")] #start locations
> colnames(xy1)<-c("X", "Y")
> xy2<-df[,c("END_LONG","END_LAT")] #end locations
> colnames(xy2)<-c("X", "Y")
> xy12 <- rbind(as.matrix(xy1), as.matrix(xy2))
> df12 <- data.frame(data.frame(xy12, Attribute =
> rep(c("start","end"),each=nrow(df)), ID = rep(1:(nrow(df)),2)))
>
> df.SP <- st_as_sf(df12, coords = c("X", "Y"), crs = 4326) #wgs84 long lat
> df.SP<-st_transform(x = df.SP, crs = 32609) #convert to wgs84 utm zone 9
> df.SP$utm_x<-st_coordinates(df.SP)[,1] # get utm coordinates
> df.SP$utm_y<-st_coordinates(df.SP)[,2] # get utm coordinates
> df.SP<-st_set_geometry(df.SP, NULL)# coerce back to data.frame
>
> ###create distance matrix###
> res<- df.SP %>%
>   dplyr::group_by(Attribute) %>%
>   mutate(rows = row_number()) %>%
>   left_join(df.SP, by = c('Attribute')) %>%
>   rowwise() %>%
>   mutate(Distance = ifelse(dist(rbind(c(utm_x.x, utm_y.x), c(utm_x.y,
> utm_y.y))) != 0,
>                            dist(rbind(c(utm_x.x, utm_y.x), c(utm_x.y,
> utm_y.y))), NA))
>
> dist.mat<-matrix(res$Distance,nrow = 20,ncol = 20)
>
> Data prep for eventually using sf::st_distance:
> pts.utm.sf <- df12 %>%
>   st_as_sf(coords=c('X','Y'), crs=4326) %>% #wgs84 long lat
>   st_transform(32609) #wgs84 utm zone9
>
> #distance matrix without groups (note using group_by "Attribute" does not
> get me the matrix I want):
> dist.utm<- pts.utm.sf %>% st_distance() #calculate distances on utm in m
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Vijay Lulla

Assistant Professor,
Dept. of Geography, IUPUI
425 University Blvd, CA-207C.
Indianapolis, IN-46202
vlulla at iupui.edu
ORCID: https://orcid.org/0000-0002-0823-2522
Webpage: http://vijaylulla.com

	[[alternative HTML version deleted]]


From @tef@no@@ofi@ @ending from regione@m@rche@it  Fri Aug 17 15:56:10 2018
From: @tef@no@@ofi@ @ending from regione@m@rche@it (Stefano Sofia)
Date: Fri, 17 Aug 2018 13:56:10 +0000
Subject: [R-sig-Geo] correct use of autoKrige and gstat with Digital
 Elevation Models
In-Reply-To: <7BAB5B49-25F8-4D93-B87F-3F026AF43B16@gmail.com>
References: <8B435C9568170B469AE31E8891E8CC4F54CCCA86@ESINO.regionemarche.intra>,
 <7BAB5B49-25F8-4D93-B87F-3F026AF43B16@gmail.com>
Message-ID: <8B435C9568170B469AE31E8891E8CC4F54CCDE74@ESINO.regionemarche.intra>

Hi Zivan.
You are right. Yes, I did it:

Inverse_Distance_rainfall <- gstat(formula=Cumulata~ExtractedElevationValues, data=df_prec, locations=newgrid)

My problem is when I try to put the output in a raster. How can I do it?
Inverse_Distance_rainfall is a list, but within it I am not able to find the name to use within raster().
Any suggestion?

Thank you
Stefano




         (oo)
--oOO--( )--OOo----------------
Stefano Sofia PhD
Area Meteorologica e  Area nivologica - Centro Funzionale
Servizio Protezione Civile - Regione Marche
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona
Uff: 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------
________________________________________
Da: Zivan Karaman [zivan.karaman at gmail.com]
Inviato: venerd? 17 agosto 2018 14.50
A: Stefano Sofia
Oggetto: Re: [R-sig-Geo] correct use of autoKrige and gstat with Digital Elevation Models

Have you tried:
Inverse_Distance_rainfall <- gstat(formula=Cumulata~ExtractedElevationValues, data=df_prec, locations=newgrid)
formula, data and locations are NOT the default first 3 arguments to gstat function - see help(gstat).
HTH
Zivan

> Le 16 ao?t 2018 ? 09:21, Stefano Sofia <stefano.sofia at regione.marche.it> a ?crit :
>
> Dear R-sig-geo list users,
> I am dealing with rainfall isohyet maps, I am using a DEM in order to get more accurate values.
> In particular I am trying to compare Kriging method (through autoKrige) with the Inverse Distance method (through gstat).
> Kriging code works fine, I think that I am not able to make a correct use of gstat.
>
> In both cases,
> - I load my rainfall cumulates in a data frame called df_prec:
>
> Codice_sensore Cumulata Long_Cent Lat_Cent Quota
> 3134 177 13.22888 42.99361  1352
> 3135 98 13.19046 42.85843  1496
> 3136 40 12.81444 43.23840  1005
> 3137 201 13.30681 42.84369  1036
> 3138 145 13.32638 42.90215   980
> 3139 45 13.11180 42.79578  1575
> 3140 69 13.18538 42.91439  1800
> 3234 129 13.44506 42.74417   960
>
> - I load the shape file and the DEM:
>
> ## LOAD SHAPEFILE
> Shape_area5 <- readOGR(dsn="area5.shp", layer="area5")
> Shape_area5_projection <- "+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
> Shape_area5 <- spTransform(Shape_area5, CRS(Shape_area5_projection))
> ## LOADING DEM
> ita_DEM <- getData('alt', country='ITA', mask=FALSE)
> ita_DEM <- projectRaster(ita_DEM, crs = CRS("+init=epsg:32633"))
>
> - I put the coordinates in the correct way, I evaluate the extracted elevation values and I create a new grid with these new values:
>
> ##
> coordinates(df_prec) <- ~Long_Cent+Lat_Cent
> proj4string(df_prec) <- CRS("+init=epsg:4326")
> df_prec <- spTransform(df_prec, CRS("+init=epsg:32633"))
> ## EXTRACT THE ELEVATION VALUES TO MY POINTS; extract EXPECTS A RASTER INPUT
> df_prec$ExtractedElevationValues <- extract(x=ita_DEM, y=df_prec)
> ## CREATE A NEW GRID
> newgrid <- as(ita_DEM, "SpatialGridDataFrame")
> names(newgrid) <- "ExtractedElevationValues"
>
> - when I apply Kriging, everything works fine
> ## KRIGING
> RegressionKriging_rainfall <- autoKrige(Cumulata~ExtractedElevationValues, df_prec, newgrid)
> prec_rast <- raster(RegressionKriging_rainfall$krige_output)
>
> - if I use gstat in the standard way
>
> Inverse_Distance_rainfall <- gstat(formula=Cumulata~1, data=df_prec, locations=newgrid)
>
> everything goes fine, but this code obviously does not take into consideration the elevation points. When I try to use the inverse distance method like Kriging:
> Inverse_Distance_rainfall <- gstat(formula=Cumulata~ExtractedElevationValues, df_prec, newgrid)
>
> I get the following error:
>
> Error in (function (classes, fdef, mtable)  :
>  unable to find an inherited method for function ?proj4string? for signature ?"NULL"?
>  Calls: my_inversedistanceweighted_DEM -> gstat -> proj4string -> <Anonymous>
>
>
> Where is my mistake?
> Could please somebody help me and give me a hint for a correst use of gstat?
> Thank you for your attention and your help
> Stefano
>
>
>         (oo)
> --oOO--( )--OOo----------------
> Stefano Sofia PhD
> Area Meteorologica e  Area nivologica - Centro Funzionale
> Servizio Protezione Civile - Regione Marche
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona
> Uff: 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------
>
> ________________________________
>
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
>
> --
> Questo messaggio  stato analizzato da Libra ESVA ed  risultato non infetto.
> This message was scanned by Libra ESVA and is believed to be clean.
>
>
>    [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
>  https://urlsand.esvalabs.com/?u=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&e=52342f8a&h=f7d4a649&f=y&p=y

--

Questo messaggio  stato analizzato con Libra ESVA ed  risultato non infetto.


________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libra ESVA ed  risultato non infetto.
This message was scanned by Libra ESVA and is believed to be clean.


From r@hep@rd @ending from @ppl-eco@y@@com  Sun Aug 19 20:14:44 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Sun, 19 Aug 2018 11:14:44 -0700 (PDT)
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
Message-ID: <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>

On Sat, 11 Aug 2018, Rich Shepard wrote:

   When I update.packages() I'm told that the attempt ended with a non-zero error message:

trying URL 'https://ftp.osuosl.org/pub/cran/src/contrib/rgdal_1.3-4.tar.gz'
Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

Warning message:
In install.packages(update[instlib == l, "Package"], l, contriburl = contriburl,  :
   installation of package ?rgdal? had non-zero exit status

   The update to version 1.3-3 last May worked. What might be the reason the
upgrade to 1.3-4 fails?

   R produces contradictory messages:

configure: C++11 support available
configure: rgdal: 1.3-4
   ...
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.3.0
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes

   Looks OK, yes? But, immediately following is this:

In file included from /usr/include/gdal.h:45:0,
                  from gdal_test.cc:1:
/usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
  #    error Must have C++11 or newer.
       ^
   ...
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/lib/R/library/rgdal?
* restoring previous ?/usr/lib/R/library/rgdal?

  Yet configure found C++11 support for gdal and the version of the latter is
greater than 1.11.4.

TIA,

Rich


From edzer@pebe@m@ @ending from uni-muen@ter@de  Sun Aug 19 22:14:06 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Sun, 19 Aug 2018 22:14:06 +0200
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
Message-ID: <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>

please report the entire output you see when trying to install rgdal.

On 08/19/2018 08:14 PM, Rich Shepard wrote:
> On Sat, 11 Aug 2018, Rich Shepard wrote:
> 
> ? When I update.packages() I'm told that the attempt ended with a
> non-zero error message:
> 
> trying URL 'https://ftp.osuosl.org/pub/cran/src/contrib/rgdal_1.3-4.tar.gz'
> Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
> 
> Warning message:
> In install.packages(update[instlib == l, "Package"], l, contriburl =
> contriburl,? :
> ? installation of package ?rgdal? had non-zero exit status
> 
> ? The update to version 1.3-3 last May worked. What might be the reason the
> upgrade to 1.3-4 fails?
> 
> ? R produces contradictory messages:
> 
> configure: C++11 support available
> configure: rgdal: 1.3-4
> ? ...
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.3.0
> checking C++11 support for GDAL >= 2.3.0... yes
> checking GDAL version >= 1.11.4... yes
> 
> ? Looks OK, yes? But, immediately following is this:
> 
> In file included from /usr/include/gdal.h:45:0,
> ???????????????? from gdal_test.cc:1:
> /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
> ?#??? error Must have C++11 or newer.
> ????? ^
> ? ...
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/lib/R/library/rgdal?
> * restoring previous ?/usr/lib/R/library/rgdal?
> 
> ?Yet configure found C++11 support for gdal and the version of the
> latter is
> greater than 1.11.4.
> 
> TIA,
> 
> Rich
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From r@hep@rd @ending from @ppl-eco@y@@com  Sun Aug 19 22:49:38 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Sun, 19 Aug 2018 13:49:38 -0700 (PDT)
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
 <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
Message-ID: <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>

On Sun, 19 Aug 2018, Edzer Pebesma wrote:

> please report the entire output you see when trying to install rgdal.

Edzer,

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/lib/R
configure: CC: gcc
configure: CXX: g++
configure: C++11 support available
configure: rgdal: 1.3-4
checking for /usr/bin/svnversion... yes
configure: svn revision: 766
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.3.0
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
In file included from /usr/include/gdal.h:45:0,
                  from gdal_test.cc:1:
/usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
  #    error Must have C++11 or newer.
       ^
In file included from /usr/include/gdal.h:49:0,
                  from gdal_test.cc:1:
/usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
  class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                ^
/usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
/usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
In file included from /usr/include/ogr_api.h:45:0,
                  from /usr/include/gdal.h:50,
                  from gdal_test.cc:1:
/usr/include/ogr_core.h:79:28: error: expected '}' before end of line
/usr/include/ogr_core.h:79:28: error: expected declaration before end of line
In file included from /usr/include/gdal.h:45:0,
                  from gdal_test.cc:1:
/usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
  #    error Must have C++11 or newer.
       ^
In file included from /usr/include/gdal.h:49:0,
                  from gdal_test.cc:1:
/usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
  class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                ^
/usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
/usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
In file included from /usr/include/ogr_api.h:45:0,
                  from /usr/include/gdal.h:50,
                  from gdal_test.cc:1:
/usr/include/ogr_core.h:79:28: error: expected '}' before end of line
/usr/include/ogr_core.h:79:28: error: expected declaration before end of line
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/lib/R/library/rgdal?
* restoring previous ?/usr/lib/R/library/rgdal?

Regards,

Rich


From Roger@Biv@nd @ending from nhh@no  Mon Aug 20 09:03:44 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Mon, 20 Aug 2018 09:03:44 +0200
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
 <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
 <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>
Message-ID: <alpine.LFD.2.21.1808200901040.13105@reclus.nhh.no>

And the output of sessionInfo() - we don't know your platform. How was 
GDAL itself installed: from source or binary? Was that binary built on the 
same platform? Are there multiple GDAL installations on your system? If 
so, the configure step may see one version but install sees another.

Roger

On Sun, 19 Aug 2018, Rich Shepard wrote:

> On Sun, 19 Aug 2018, Edzer Pebesma wrote:
>
>>  please report the entire output you see when trying to install rgdal.
>
> Edzer,
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure:  R_HOME: /usr/lib/R
> configure:  CC: gcc
> configure:  CXX: g++
> configure:  C++11 support available
> configure:  rgdal: 1.3-4
> checking for /usr/bin/svnversion... yes
> configure:  svn revision: 766
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure:  GDAL: 2.3.0
> checking C++11 support for GDAL >= 2.3.0... yes
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> In file included from /usr/include/gdal.h:45:0,
>                 from gdal_test.cc:1:
> /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
> #    error Must have C++11 or newer.
>      ^
> In file included from /usr/include/gdal.h:49:0,
>                 from gdal_test.cc:1:
> /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' 
> token
> class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, 
> CPLXMLTreeCloserDeleter>
>                                               ^
> /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
> /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' 
> token
> In file included from /usr/include/ogr_api.h:45:0,
>                  from /usr/include/gdal.h:50,
>                  from gdal_test.cc:1:
> /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
> /usr/include/ogr_core.h:79:28: error: expected declaration before end of line
> In file included from /usr/include/gdal.h:45:0,
>                 from gdal_test.cc:1:
> /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
> #    error Must have C++11 or newer.
>      ^
> In file included from /usr/include/gdal.h:49:0,
>                 from gdal_test.cc:1:
> /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' 
> token
> class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, 
> CPLXMLTreeCloserDeleter>
>                                               ^
> /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
> /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' 
> token
> In file included from /usr/include/ogr_api.h:45:0,
>                  from /usr/include/gdal.h:50,
>                  from gdal_test.cc:1:
> /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
> /usr/include/ogr_core.h:79:28: error: expected declaration before end of line
> configure:  Install failure: compilation and/or linkage problems.
> configure:  error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/lib/R/library/rgdal?
> * restoring previous ?/usr/lib/R/library/rgdal?
>
> Regards,
>
> Rich
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From r@hep@rd @ending from @ppl-eco@y@@com  Mon Aug 20 17:28:32 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Mon, 20 Aug 2018 08:28:32 -0700 (PDT)
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LFD.2.21.1808200901040.13105@reclus.nhh.no>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
 <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
 <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808200901040.13105@reclus.nhh.no>
Message-ID: <alpine.LNX.2.20.1808200523050.20746@salmo.appl-ecosys.com>

On Mon, 20 Aug 2018, Roger Bivand wrote:

> And the output of sessionInfo() - we don't know your platform. How was
> GDAL itself installed: from source or binary? Was that binary built on the
> same platform? Are there multiple GDAL installations on your system? If
> so, the configure step may see one version but install sees another.

Roger,

> sessionInfo()
R version 3.5.1 (2018-07-02)
Platform: i586-slackware-linux-gnu (32-bit)
Running under: Slackware 14.2

Matrix products: default
BLAS: /usr/lib/R/lib/libRblas.so
LAPACK: /usr/lib/R/lib/libRlapack.so

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C 
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_3.5.1 tools_3.5.1    tcltk_3.5.1

   gdal is built from source using the SlackBuiilds.org
<https://www.slackbuilds.org/> build script.

   gdal-2.3.1 is the only gdal package installed.

   With the upgraded (2.3.0 -> 2.3.1) gdal version installed fails the same
way in response to both update.packages() and install.packages('rgdal'):

> install.packages('rgdal')
trying URL 'https://ftp.osuosl.org/pub/cran/src/contrib/rgdal_1.3-4.tar.gz'
Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/lib/R
configure: CC: gcc
configure: CXX: g++
configure: C++11 support available
configure: rgdal: 1.3-4
checking for /usr/bin/svnversion... yes
configure: svn revision: 766
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.3.1
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
In file included from /usr/include/gdal.h:45:0,
                  from gdal_test.cc:1:
/usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
  #    error Must have C++11 or newer.
       ^
In file included from /usr/include/gdal.h:49:0,
                  from gdal_test.cc:1:
/usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
  class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                ^
/usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
/usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
In file included from /usr/include/ogr_api.h:45:0,
                  from /usr/include/gdal.h:50,
                  from gdal_test.cc:1:
/usr/include/ogr_core.h:79:28: error: expected '}' before end of line
/usr/include/ogr_core.h:79:28: error: expected declaration before end of line
In file included from /usr/include/gdal.h:45:0,
                  from gdal_test.cc:1:
/usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
  #    error Must have C++11 or newer.
       ^
In file included from /usr/include/gdal.h:49:0,
                  from gdal_test.cc:1:
/usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
  class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                ^
/usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
/usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
In file included from /usr/include/ogr_api.h:45:0,
                  from /usr/include/gdal.h:50,
                  from gdal_test.cc:1:
/usr/include/ogr_core.h:79:28: error: expected '}' before end of line
/usr/include/ogr_core.h:79:28: error: expected declaration before end of line
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/lib/R/library/rgdal?
* restoring previous ?/usr/lib/R/library/rgdal?

The downloaded source packages are in
 	?/tmp/RtmpfJQHZG/downloaded_packages?
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
Warning message:
In install.packages("rgdal") :
   installation of package ?rgdal? had non-zero exit status

   What other information can I provide?

Regards,

Rich


From SW@lbridge @ending from e@ri@com  Mon Aug 20 17:37:38 2018
From: SW@lbridge @ending from e@ri@com (Shaun Walbridge)
Date: Mon, 20 Aug 2018 15:37:38 +0000
Subject: [R-sig-Geo] rgdal compile confusion
In-Reply-To: <alpine.LNX.2.20.1808200523050.20746@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
 <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
 <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808200901040.13105@reclus.nhh.no>
 <alpine.LNX.2.20.1808200523050.20746@salmo.appl-ecosys.com>
Message-ID: <2964E1D9-207B-4ABE-B9C3-AF7B2094582C@esri.com>

It looks like the maintainer of the slackbuild recently downgraded GDAL back to the 2.2.4 version because of the problems with the 2.3.0 release:
  https://urldefense.proofpoint.com/v2/url?u=https-3A__git.slackbuilds.org_slackbuilds_commit_gis_gdal-3Fh-3D14.2-26id-3Dc97bd17ac886c33fb90b3954945e2c3b07907acc&d=DwIGaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=fCPRb7QX-vd5bnO9gIJHCiX852SVUtyYX--xtCKtpfk&m=vscOV_5PwQCvnbNef9uvIzp5QCsmoJ43pg4dGDIoXfM&s=FGqho_qYJ7kdidW3uV6ru6kZrzlMbMBU4ujJC0cq4NY&e=

With the line "The update to version 2.3.0 broke lots of dependent packages that don't use c++11. Sorry!"

I'd recommend you reinstall the newest (2.2.4) slackbuild version of the package, and try rebuilding rgdal while using that. 

?On 8/20/18, 11:28 AM, "R-sig-Geo on behalf of Rich Shepard" <r-sig-geo-bounces at r-project.org on behalf of rshepard at appl-ecosys.com> wrote:

    On Mon, 20 Aug 2018, Roger Bivand wrote:
    
    > And the output of sessionInfo() - we don't know your platform. How was
    > GDAL itself installed: from source or binary? Was that binary built on the
    > same platform? Are there multiple GDAL installations on your system? If
    > so, the configure step may see one version but install sees another.
    
    Roger,
    
    > sessionInfo()
    R version 3.5.1 (2018-07-02)
    Platform: i586-slackware-linux-gnu (32-bit)
    Running under: Slackware 14.2
    
    Matrix products: default
    BLAS: /usr/lib/R/lib/libRblas.so
    LAPACK: /usr/lib/R/lib/libRlapack.so
    
    locale:
      [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
      [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C
      [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
      [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
      [9] LC_ADDRESS=C               LC_TELEPHONE=C 
    [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
    
    attached base packages:
    [1] stats     graphics  grDevices utils     datasets  methods   base
    
    loaded via a namespace (and not attached):
    [1] compiler_3.5.1 tools_3.5.1    tcltk_3.5.1
    
       gdal is built from source using the SlackBuiilds.org
    <https://urldefense.proofpoint.com/v2/url?u=https-3A__www.slackbuilds.org_&d=DwIGAA&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkcUCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=wxTHWsd_1Dg_NP86zMVoYKF9rSG2FjVW_DFJf3-svAU&s=CGzyyiturMPUgBqnwm8a991UlrEj6v7Greh6EUG9L1U&e=> build script.
    
       gdal-2.3.1 is the only gdal package installed.
    
       With the upgraded (2.3.0 -> 2.3.1) gdal version installed fails the same
    way in response to both update.packages() and install.packages('rgdal'):
    
    > install.packages('rgdal')
    trying URL 'https://urldefense.proofpoint.com/v2/url?u=https-3A__ftp.osuosl.org_pub_cran_src_contrib_rgdal-5F1.3-2D4.tar.gz&d=DwIGAA&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkcUCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=wxTHWsd_1Dg_NP86zMVoYKF9rSG2FjVW_DFJf3-svAU&s=FgWPmtd9KO4To56icX1JJSQCZ8DGlUHxUCdkHjzY7X0&e='
    Content type 'application/x-gzip' length 1664774 bytes (1.6 MB)
    ==================================================
    downloaded 1.6 MB
    
    * installing *source* package ?rgdal? ...
    ** package ?rgdal? successfully unpacked and MD5 sums checked
    configure: R_HOME: /usr/lib/R
    configure: CC: gcc
    configure: CXX: g++
    configure: C++11 support available
    configure: rgdal: 1.3-4
    checking for /usr/bin/svnversion... yes
    configure: svn revision: 766
    checking for gdal-config... /usr/bin/gdal-config
    checking gdal-config usability... yes
    configure: GDAL: 2.3.1
    checking C++11 support for GDAL >= 2.3.0... yes
    checking GDAL version >= 1.11.4... yes
    checking gdal: linking with --libs only... no
    checking gdal: linking with --libs and --dep-libs... no
    In file included from /usr/include/gdal.h:45:0,
                      from gdal_test.cc:1:
    /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
      #    error Must have C++11 or newer.
           ^
    In file included from /usr/include/gdal.h:49:0,
                      from gdal_test.cc:1:
    /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
      class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                    ^
    /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
    /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
    In file included from /usr/include/ogr_api.h:45:0,
                      from /usr/include/gdal.h:50,
                      from gdal_test.cc:1:
    /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
    /usr/include/ogr_core.h:79:28: error: expected declaration before end of line
    In file included from /usr/include/gdal.h:45:0,
                      from gdal_test.cc:1:
    /usr/include/cpl_port.h:187:6: error: #error Must have C++11 or newer.
      #    error Must have C++11 or newer.
           ^
    In file included from /usr/include/gdal.h:49:0,
                      from gdal_test.cc:1:
    /usr/include/cpl_minixml.h:202:47: error: expected template-name before '<' token
      class CPLXMLTreeCloser: public std::unique_ptr<CPLXMLNode, CPLXMLTreeCloserDeleter>
                                                    ^
    /usr/include/cpl_minixml.h:202:47: error: expected '{' before '<' token
    /usr/include/cpl_minixml.h:202:47: error: expected unqualified-id before '<' token
    In file included from /usr/include/ogr_api.h:45:0,
                      from /usr/include/gdal.h:50,
                      from gdal_test.cc:1:
    /usr/include/ogr_core.h:79:28: error: expected '}' before end of line
    /usr/include/ogr_core.h:79:28: error: expected declaration before end of line
    configure: Install failure: compilation and/or linkage problems.
    configure: error: GDALAllRegister not found in libgdal.
    ERROR: configuration failed for package ?rgdal?
    * removing ?/usr/lib/R/library/rgdal?
    * restoring previous ?/usr/lib/R/library/rgdal?
    
    The downloaded source packages are in
     	?/tmp/RtmpfJQHZG/downloaded_packages?
    Updating HTML index of packages in '.Library'
    Making 'packages.html' ... done
    Warning message:
    In install.packages("rgdal") :
       installation of package ?rgdal? had non-zero exit status
    
       What other information can I provide?
    
    Regards,
    
    Rich
    
    _______________________________________________
    R-sig-Geo mailing list
    R-sig-Geo at r-project.org
    https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=DwIGAA&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkcUCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=wxTHWsd_1Dg_NP86zMVoYKF9rSG2FjVW_DFJf3-svAU&s=jvOPSfwlAz48alb_wKku-UEk-ob5pOUZ5WHG6BIgn1w&e=
    



From r@hep@rd @ending from @ppl-eco@y@@com  Mon Aug 20 18:19:41 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Mon, 20 Aug 2018 09:19:41 -0700 (PDT)
Subject: [R-sig-Geo] rgdal compile confusion [RESOLVED]
In-Reply-To: <2964E1D9-207B-4ABE-B9C3-AF7B2094582C@esri.com>
References: <alpine.LNX.2.20.1808101443140.14707@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808111048040.9263@reclus.nhh.no>
 <alpine.LNX.2.20.1808110733350.31888@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808191059440.8446@salmo.appl-ecosys.com>
 <05624cf1-5933-70c6-3e50-103cb31d01c8@uni-muenster.de>
 <alpine.LNX.2.20.1808191348160.8446@salmo.appl-ecosys.com>
 <alpine.LFD.2.21.1808200901040.13105@reclus.nhh.no>
 <alpine.LNX.2.20.1808200523050.20746@salmo.appl-ecosys.com>
 <2964E1D9-207B-4ABE-B9C3-AF7B2094582C@esri.com>
Message-ID: <alpine.LNX.2.20.1808200915520.20746@salmo.appl-ecosys.com>

On Mon, 20 Aug 2018, Shaun Walbridge wrote:

> It looks like the maintainer of the slackbuild recently downgraded GDAL
>  back to the 2.2.4 version because of the problems with the 2.3.0 release:
>  https://urldefense.proofpoint.com/v2/url?u=https-3A__git.slackbuilds.org_slackbuilds_commit_gis_gdal-3Fh-3D14.2-26id-3Dc97bd17ac886c33fb90b3954945e2c3b07907acc&d=DwIGaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=nxHWzsbFn4X_N0ruafqevZE4LSBsSvWC_0wkjR1NVTY&m=ATemW5xbQSNOMLNPRJ7Qhs2z8VgsMWup3KQpGwj65HU&s=V_lu-cvt5T7I-SaxG-5K3zvdqiCDT8vQ-VDgV0r4_Ak&e=

> I'd recommend you reinstall the newest (2.2.4) slackbuild version of the
> package, and try rebuilding rgdal while using that.

Shaun,

   How interesting. I did not see that notice on the SBo mail list and David
did not point me to it when I wrote him about the problem.

   Yes, gdal-2.2.4 supports the building of rgdal-1.3-4. The compatibilty
problem must be subtle as configure finds C++11 on my system yet does not
build the latest gdal or rgdal.

Thanks very much,

Rich


From jeromem@le@ki @ending from gm@il@com  Mon Aug 20 22:06:27 2018
From: jeromem@le@ki @ending from gm@il@com (Jerome Maleski)
Date: Mon, 20 Aug 2018 16:06:27 -0400
Subject: [R-sig-Geo] [jobs] postdoc in remote sensing with USDA-ARS
Message-ID: <CAOUwmAbK+r-afXMY4oQYi8sVV0E0yeEQR7its_zA=hJreP9eeg@mail.gmail.com>

The USDA-Agricultural Research Service, Southeast Watershed Research Unit
in Tifton, GA, is seeking a postdoctoral research associate for a
full-time, 2 year appointment. The research associate will develop,
calibrate, and validate a semi-empirical model for estimating cotton
biomass from fields within the southeastern United States. Model
development will involve the use of optical and radar remote sensing
products along with field data for calibration and validation. The research
associate will conduct field work and will collaborate with model
developers in Agriculture and Agri-Food Canada (AAFC) as well as other
partners in ARS and within the Long Term Agroecosystems Research (LTAR)
network.



Qualifications include a recent Ph.D. (within the last 4 years) in
Agricultural Engineering, Agronomy, Geography or a related discipline;
ability to participate as a team member in the collection of field data of
soil moisture, biomass, phenology and leaf area index (LAI); and knowledge
of remote sensing and geospatial analysis for using radar and optical data
from earth orbiting satellites. This job is open to U.S. Citizens and
Permanent Residents seeking US Citizenship.



The vacancy announcement (number RA-18-001-HA) can be accessed by visiting:
https://www.usajobs.gov/GetJob/ViewDetails/507599500 .



Please direct any questions about this position to Dr. Alisa Coffin,
alisa.coffin at ars.usda.gov, 229-386-3665.



Please distribute this announcement or the attached advertisement to
interested contacts and potential candidates.

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @ending from uni-muen@ter@de  Tue Aug 21 14:22:31 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Tue, 21 Aug 2018 14:22:31 +0200
Subject: [R-sig-Geo] www.asdar-book.org site issues
In-Reply-To: <alpine.LFD.2.21.1808111333570.10568@reclus.nhh.no>
References: <alpine.LFD.2.21.1808111333570.10568@reclus.nhh.no>
Message-ID: <a570cb0b-ac2b-9f15-d05a-982d066c0f56@uni-muenster.de>

The website seems to be up again.

On 08/11/2018 01:36 PM, Roger Bivand wrote:
> The ASDAR book site is not being shown for viewing, but the content is
> still there. Anyone needing content (several inquiries off-list) may try:
> 
> ASDAR_BOOK <- "http://www.asdar-book.org/bundles2ed"
> chapters <- c("hello", "cm", "vis", "die", "cm2", "std", "sppa", "geos",
> ?"lat", "dismap")
> for (i in chapters) {fn <- paste(i, "bundle.zip", sep="_");
> download.file(paste(ASDAR_BOOK, fn, sep = "/"), fn)}
> 
> to download the chapter bundles. Summer maintenance takes time, and we
> hope to fix the underlying problem in a week or so.
> 
> Roger
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From @riel@fuente@di @ending from u@@ch@cl  Tue Aug 21 20:15:08 2018
From: @riel@fuente@di @ending from u@@ch@cl (Ariel Fuentesdi)
Date: Tue, 21 Aug 2018 15:15:08 -0300
Subject: [R-sig-Geo] parallelize distance matrix
Message-ID: <CAD0a9KhxFnsem4HdKJn5MQFZS5Av+jN=ZZ0fAUYf18mMAKF-YQ@mail.gmail.com>

Hi, I want to parallelize the calculation of a distance matrix, I've tried
but I wasn't succesful, this is what I did with a training data.

My data set is:

ll <- matrix(c(5, 6, 60, 60), ncol=2)

And I use the function *spDistsN1* from the library *"sp"* to obtain a
distance matrix with *apply*:

apply(ll, 1, function(x) spDistsN1(as.matrix(ll), x, longlat = T))

But I want to do it with parallelization, so for that:

library(parallel)
ncore <- detectCores()
cl <- makeCluster(ncore)
clusterEvalQ(cl = cl, expr = c(library(sp)))
parRapply(cl = cl, x = ll, FUN =  function(x) spDistsN1(as.matrix(ll), x,
longlat = T))

It shows the following error:

*Error in checkForRemoteErrors(val) : 4 nodes produced errors; first error:
object 'll' not found*

How do I fix it?
Regards,
Ariel Fuentes

	[[alternative HTML version deleted]]


From rom@n@lu@trik @ending from gm@il@com  Tue Aug 21 20:53:32 2018
From: rom@n@lu@trik @ending from gm@il@com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 21 Aug 2018 20:53:32 +0200
Subject: [R-sig-Geo] parallelize distance matrix
In-Reply-To: <CAD0a9KhxFnsem4HdKJn5MQFZS5Av+jN=ZZ0fAUYf18mMAKF-YQ@mail.gmail.com>
References: <CAD0a9KhxFnsem4HdKJn5MQFZS5Av+jN=ZZ0fAUYf18mMAKF-YQ@mail.gmail.com>
Message-ID: <CAHT1vpgd80LcW9LsLNH0a5EJLJzFJeZ1GJFKS_a7-NwQpc-3TQ@mail.gmail.com>

Cross posted on SO:
https://stackoverflow.com/questions/51952776/parallelization-apply-to-parrapply

On Tue, Aug 21, 2018 at 8:15 PM Ariel Fuentesdi <ariel.fuentesdi at usach.cl>
wrote:

> Hi, I want to parallelize the calculation of a distance matrix, I've tried
> but I wasn't succesful, this is what I did with a training data.
>
> My data set is:
>
> ll <- matrix(c(5, 6, 60, 60), ncol=2)
>
> And I use the function *spDistsN1* from the library *"sp"* to obtain a
> distance matrix with *apply*:
>
> apply(ll, 1, function(x) spDistsN1(as.matrix(ll), x, longlat = T))
>
> But I want to do it with parallelization, so for that:
>
> library(parallel)
> ncore <- detectCores()
> cl <- makeCluster(ncore)
> clusterEvalQ(cl = cl, expr = c(library(sp)))
> parRapply(cl = cl, x = ll, FUN =  function(x) spDistsN1(as.matrix(ll), x,
> longlat = T))
>
> It shows the following error:
>
> *Error in checkForRemoteErrors(val) : 4 nodes produced errors; first error:
> object 'll' not found*
>
> How do I fix it?
> Regards,
> Ariel Fuentes
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From vij@ylull@ @ending from gm@il@com  Wed Aug 22 00:12:03 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Tue, 21 Aug 2018 18:12:03 -0400
Subject: [R-sig-Geo] parallelize distance matrix
In-Reply-To: <CAHT1vpgd80LcW9LsLNH0a5EJLJzFJeZ1GJFKS_a7-NwQpc-3TQ@mail.gmail.com>
References: <CAD0a9KhxFnsem4HdKJn5MQFZS5Av+jN=ZZ0fAUYf18mMAKF-YQ@mail.gmail.com>
 <CAHT1vpgd80LcW9LsLNH0a5EJLJzFJeZ1GJFKS_a7-NwQpc-3TQ@mail.gmail.com>
Message-ID: <CAKkiGbsqsxnA3C=B4OocdYmX7GQEy5J6KJBYxu9DSv_Ajrhgiw@mail.gmail.com>

You'll have to do clusterExport(cl, c("ll")) before you call parRapply.
Please see ?`parRapply` and pages 10 and 11 of the parallel::parallel
vignette.
HTH,
Vijay.

On Tue, Aug 21, 2018 at 2:54 PM Roman Lu?trik <roman.lustrik at gmail.com>
wrote:

> Cross posted on SO:
>
> https://stackoverflow.com/questions/51952776/parallelization-apply-to-parrapply
>
> On Tue, Aug 21, 2018 at 8:15 PM Ariel Fuentesdi <ariel.fuentesdi at usach.cl>
> wrote:
>
> > Hi, I want to parallelize the calculation of a distance matrix, I've
> tried
> > but I wasn't succesful, this is what I did with a training data.
> >
> > My data set is:
> >
> > ll <- matrix(c(5, 6, 60, 60), ncol=2)
> >
> > And I use the function *spDistsN1* from the library *"sp"* to obtain a
> > distance matrix with *apply*:
> >
> > apply(ll, 1, function(x) spDistsN1(as.matrix(ll), x, longlat = T))
> >
> > But I want to do it with parallelization, so for that:
> >
> > library(parallel)
> > ncore <- detectCores()
> > cl <- makeCluster(ncore)
> > clusterEvalQ(cl = cl, expr = c(library(sp)))
> > parRapply(cl = cl, x = ll, FUN =  function(x) spDistsN1(as.matrix(ll), x,
> > longlat = T))
> >
> > It shows the following error:
> >
> > *Error in checkForRemoteErrors(val) : 4 nodes produced errors; first
> error:
> > object 'll' not found*
> >
> > How do I fix it?
> > Regards,
> > Ariel Fuentes
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> In God we trust, all others bring data.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Wed Aug 22 23:34:39 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Wed, 22 Aug 2018 18:34:39 -0300
Subject: [R-sig-Geo] drawing a polygon from several lines
Message-ID: <CAE8g1gO7JXvV4sFLAqXHoL7OtyapiJbq++sSnVdH_8G4UNPWFA@mail.gmail.com>

Hello all,

I want to select the cells of a grid that in a range of latitudes and
depths.
Latitudes limits are indicated by two lines and the depths by two isobaths
from a shapefile.
The shapefile can be downloaded at
https://www.dropbox.com/sh/us859uyijns36r9/AAC9N4OSwweLuW-fdsBWUy-ra?dl=0

Below are the steps I've already taken. I could not find a way to create a
polygon from the lines of depth and latitude. With this polygon I could
easily select the overlapped cells.

I would really appreciate any help. Best regards

----
library(rgeos)
library(sp)
rm(list = ls())

# import shape
isobaths <- readOGR(".","isobath")
isobaths <- spTransform(bath, CRS("+proj=longlat +datum=WGS84"))
proj4string(isobaths)
summary(isobaths)

# create a spatial grid and polygons
grd <-
GridTopology(cellcentre.offset=c(-47.75,-25.416667),cellsize=c(10/60,10/60),cells.dim=c(23,12))
polys <- as.SpatialPolygons.GridTopology(grd)
proj4string(polys) <- CRS("+proj=longlat +datum=WGS84")
summary(polys)
IDs <- sapply(slot(polys, "polygons"), function(x) slot(x, "ID"))

# create spatial lines
# southern limit
x <- c(-47.5,-45.5)
y <- c(-24.8,-24.8)
ls <- SpatialLines(list(Lines(Line(cbind(x,y)),
ID="b")),proj4string=CRS("+proj=longlat +datum=WGS84"))

# northern limit
x <- c(-46.2,-44.5)
y <- c(-24.02,-24.02)
ln <- SpatialLines(list(Lines(Line(cbind(x,y)),
ID="c")),proj4string=CRS("+proj=longlat +datum=WGS84"))

# plot isolines polygons and lines
plot(polys)
axis(1);axis(4)
text(coordinates(polys), labels=IDs, cex=0.7)
plot(isobaths,add=T)
plot(ls,add=T,col="blue",lwd=2)
plot(ln,add=T,col="orange",lwd=2)

# select isobaths
summary(isobaths)
dmin <- subset(isobaths, ID %in% "-25")
proj4string(dmin) <- CRS("+proj=longlat +datum=WGS84")

dmax <- subset(isobaths, ID %in% "-60")
proj4string(dmax) <- CRS("+proj=longlat +datum=WGS84")

plot(dmin,add=T,col="red",lwd=2)
plot(dmax,add=T,col="red",lwd=2)

# from here I'd like to have a polygon to select the cells.
na.omit(over(polys,dmin))

-- 
Antonio Olinto ?vila da Silva
Instituto de Pesca (Fisheries Institute)
S?o Paulo, Brasil

	[[alternative HTML version deleted]]


From rocio@joo @ending from ufl@edu  Thu Aug 23 16:59:28 2018
From: rocio@joo @ending from ufl@edu (Rocio Joo)
Date: Thu, 23 Aug 2018 09:59:28 -0500
Subject: [R-sig-Geo] R-movement packages survey
Message-ID: <414c74e3-8abb-52d3-5db7-b75e42a4b82a@ufl.edu>

Hi everybody,

I'm preparing a review on R packages related to biologging and movement. 
If you have used a package related to those subjects please participate 
in this survey https://urldefense.proofpoint.com/v2/url?u=https-3A__mablab.org_survey_index.php_759774-3Flang-3Den&d=DwIDaQ&c=pZJPUDQ3SB9JplYbifm4nt2lEVG5pWx2KikqINpWlZM&r=OnBRYbn-fPC7OCR-yjUnqiUnj2gfCrtQn15ueJyGfIM&m=xGMFhejJGmRHQO806DDAuDcHsu0xqrrQOb1f-ZUdOro&s=ApjY8blfgbDLnrphzCM4BJGRd_4-hBqHhwwI9Kzyxbg&e= that 
will be very useful for the review.

Thanks in advance.

Best,

-- 
Roc?o Joo


From nevil@@mo@ @ending from gm@il@com  Fri Aug 24 08:44:44 2018
From: nevil@@mo@ @ending from gm@il@com (nevil amos)
Date: Fri, 24 Aug 2018 16:44:44 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
Message-ID: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>

I have a large number of rasters ( tiffs) that contain whole number values
between 0 and 100, and NA values. or 0,1,and NA
they are currently in Float format, I am trying to rewrite them as integer
rasters, firstly to save space, and secondly so that I can later read the
values stack of all the rasters into an integer array. using getValues().

To do this I am setting the dataType to INT2U in writeRaster, however when
I read the save file back into R the format is not INT2U but FLT8S

toy example:

v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
m<-matrix(v,10,10)
r<-raster(m)
dataType(r)
writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
s<-raster("test_int.tif")
dataType(s)

the result I get:

> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
> m<-matrix(v,10,10)
> r<-raster(m)
> dataType(r)
[1] "FLT4S"
> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
> s<-raster("test_int.tif")
> dataType(s)
[1] "FLT8S"
>


Can you suggest how I ensure the values are stored as integer?

Many thanks

	[[alternative HTML version deleted]]


From md@umner @ending from gm@il@com  Fri Aug 24 09:13:58 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 24 Aug 2018 17:13:58 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
Message-ID: <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>

I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
integers, so you can build an empty raster and copy the values over. But
will need to derive from the rgdal version to catch all the metadata
(structure, extent, and crs).

I think it's doable and will try later. There are other options but nothing
trivial afaik.

Cheers, Mike

On Fri, 24 Aug 2018, 16:45 nevil amos <nevil.amos at gmail.com> wrote:

> I have a large number of rasters ( tiffs) that contain whole number values
> between 0 and 100, and NA values. or 0,1,and NA
> they are currently in Float format, I am trying to rewrite them as integer
> rasters, firstly to save space, and secondly so that I can later read the
> values stack of all the rasters into an integer array. using getValues().
>
> To do this I am setting the dataType to INT2U in writeRaster, however when
> I read the save file back into R the format is not INT2U but FLT8S
>
> toy example:
>
> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
> m<-matrix(v,10,10)
> r<-raster(m)
> dataType(r)
> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
> s<-raster("test_int.tif")
> dataType(s)
>
> the result I get:
>
> > v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
> > m<-matrix(v,10,10)
> > r<-raster(m)
> > dataType(r)
> [1] "FLT4S"
> > writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
> > s<-raster("test_int.tif")
> > dataType(s)
> [1] "FLT8S"
> >
>
>
> Can you suggest how I ensure the values are stored as integer?
>
> Many thanks
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Fri Aug 24 10:05:25 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Fri, 24 Aug 2018 08:05:25 +0000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>,
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
Message-ID: <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>

Thanks, Mike. I agree that the lower level interface in rgdal is flexible enough, but as you say non-trivial. Nevil: could you please provide a small reproducible example to point people in the right direction?

Roger

Roger Bivand
Norwegian School of Economics
Bergen, Norway



Fra: Michael Sumner
Sendt: fredag 24. august, 09.14
Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
Til: nevil amos
Kopi: r-sig-geo at r-project.org


I'm pretty sure readGDAL from rgdal (that raster uses) will keep as integers, so you can build an empty raster and copy the values over. But will need to derive from the rgdal version to catch all the metadata (structure, extent, and crs). I think it's doable and will try later. There are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs) that contain whole number values > between 0 and 100, and NA values. or 0,1,and NA > they are currently in Float format, I am trying to rewrite them as integer > rasters, firstly to save space, and secondly so that I can later read the > values stack of all the rasters into an integer array. using getValues(). > > To do this I am setting the dataType to INT2U in writeRaster, however when > I read the save file back into R the format is not INT2U but FLT8S > > toy example: > > v m r dataType(r) > writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s) > > the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > > writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s > dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values are stored as integer? > > Many thanks > > [[alternative HTML version deleted]] > > _______________________________________________ > R-sig-Geo mailing list > R-sig-Geo at r-project.org > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael Sumner Software and Database Engineer Australian Antarctic Division 203 Channel Highway Kingston Tasmania 7050 Australia [[alternative HTML version deleted]] _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From nevil@@mo@ @ending from gm@il@com  Fri Aug 24 10:26:22 2018
From: nevil@@mo@ @ending from gm@il@com (nevil amos)
Date: Fri, 24 Aug 2018 18:26:22 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
 <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
Message-ID: <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>

Roger,

there was a reproducible example in my post:  it seems to have got a bit
scrambled in your reply.

from the help in raster I thought that if I included  datatype="INT2S" in
the writeRaster() command the values would be formatted in the output file
( and the subsequent reading using raster() of that file) as integer  is
this not the case?

Here it is the reproducible example

v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
m<-matrix(v,10,10)
r<-raster(m)
dataType(r)
writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
s<-raster("test_int.tif")
dataType(s)

On Fri, 24 Aug 2018 at 18:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> Thanks, Mike. I agree that the lower level interface in rgdal is flexible
> enough, but as you say non-trivial. Nevil: could you please provide a small
> reproducible example to point people in the right direction?
>
> Roger
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
>
>
> Fra: Michael Sumner
> Sendt: fredag 24. august, 09.14
> Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
> Til: nevil amos
> Kopi: r-sig-geo at r-project.org
>
>
> I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
> integers, so you can build an empty raster and copy the values over. But
> will need to derive from the rgdal version to catch all the metadata
> (structure, extent, and crs). I think it's doable and will try later. There
> are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug
> 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs)
> that contain whole number values > between 0 and 100, and NA values. or
> 0,1,and NA > they are currently in Float format, I am trying to rewrite
> them as integer > rasters, firstly to save space, and secondly so that I
> can later read the > values stack of all the rasters into an integer array.
> using getValues(). > > To do this I am setting the dataType to INT2U in
> writeRaster, however when > I read the save file back into R the format is
> not INT2U but FLT8S > > toy example: > > v m r dataType(r) >
> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s)
> > > the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > >
> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s >
> dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values
> are stored as integer? > > Many thanks > > [[alternative HTML version
> deleted]] > > _______________________________________________ > R-sig-Geo
> mailing list > R-sig-Geo at r-project.org >
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael Sumner
> Software and Database Engineer Australian Antarctic Division 203 Channel
> Highway Kingston Tasmania 7050 Australia [[alternative HTML version
> deleted]] _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From md@umner @ending from gm@il@com  Fri Aug 24 14:00:04 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 24 Aug 2018 22:00:04 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
 <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
 <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>
Message-ID: <CAAcGz99Yd_FYsA2-yM48sa-V4Hg2n9nEdC7NUR-8srDeDtuwZw@mail.gmail.com>

Sorry, I was wrong - the actual issue is that the writeRaster argument is
"datatype", it gets conflated with the function that is dataType().

f <- "test_int.tif"
writeRaster(r, f, datatype = "INT2U", overwrite = TRUE)
s <- raster(f)
dataType(s)

[1] "INT2U"

Not the first time this has caught me out. I found it by checking
mode(readGDAL(f)[[1]]) and realizing that the TIFF type was Float32, prior
to the next steps.

HTH

:)

Cheers, Mike

On Fri, 24 Aug 2018 at 18:26 nevil amos <nevil.amos at gmail.com> wrote:

> Roger,
>
> there was a reproducible example in my post:  it seems to have got a bit
> scrambled in your reply.
>
> from the help in raster I thought that if I included  datatype="INT2S" in
> the writeRaster() command the values would be formatted in the output file
> ( and the subsequent reading using raster() of that file) as integer  is
> this not the case?
>
> Here it is the reproducible example
>
> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
> m<-matrix(v,10,10)
> r<-raster(m)
> dataType(r)
> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
> s<-raster("test_int.tif")
> dataType(s)
>
> On Fri, 24 Aug 2018 at 18:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> Thanks, Mike. I agree that the lower level interface in rgdal is flexible
>> enough, but as you say non-trivial. Nevil: could you please provide a small
>> reproducible example to point people in the right direction?
>>
>> Roger
>>
>> Roger Bivand
>> Norwegian School of Economics
>> Bergen, Norway
>>
>>
>>
>> Fra: Michael Sumner
>> Sendt: fredag 24. august, 09.14
>> Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
>> Til: nevil amos
>> Kopi: r-sig-geo at r-project.org
>>
>>
>> I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
>> integers, so you can build an empty raster and copy the values over. But
>> will need to derive from the rgdal version to catch all the metadata
>> (structure, extent, and crs). I think it's doable and will try later. There
>> are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug
>> 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs)
>> that contain whole number values > between 0 and 100, and NA values. or
>> 0,1,and NA > they are currently in Float format, I am trying to rewrite
>> them as integer > rasters, firstly to save space, and secondly so that I
>> can later read the > values stack of all the rasters into an integer array.
>> using getValues(). > > To do this I am setting the dataType to INT2U in
>> writeRaster, however when > I read the save file back into R the format is
>> not INT2U but FLT8S > > toy example: > > v m r dataType(r) >
>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s)
>> > > the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > >
>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s >
>> dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values
>> are stored as integer? > > Many thanks > > [[alternative HTML version
>> deleted]] > > _______________________________________________ > R-sig-Geo
>> mailing list > R-sig-Geo at r-project.org >
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael Sumner
>> Software and Database Engineer Australian Antarctic Division 203 Channel
>> Highway Kingston Tasmania 7050 Australia
>> <https://maps.google.com/?q=203+Channel%0D%0A+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>> [[alternative HTML version deleted]]
>> _______________________________________________ R-sig-Geo mailing list
>> R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From md@umner @ending from gm@il@com  Fri Aug 24 14:13:50 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 24 Aug 2018 22:13:50 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAAcGz99Yd_FYsA2-yM48sa-V4Hg2n9nEdC7NUR-8srDeDtuwZw@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
 <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
 <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>
 <CAAcGz99Yd_FYsA2-yM48sa-V4Hg2n9nEdC7NUR-8srDeDtuwZw@mail.gmail.com>
Message-ID: <CAAcGz9-jyuy3hjnMUDTWrD1gA5Uz2Ge_Z6b=F4eFJarS2v20Pg@mail.gmail.com>

That doesn't help though!

Sorry, I thought that was it, will sleep on it.

Cheers, Mike

On Fri, 24 Aug 2018 at 22:00 Michael Sumner <mdsumner at gmail.com> wrote:

> Sorry, I was wrong - the actual issue is that the writeRaster argument is
> "datatype", it gets conflated with the function that is dataType().
>
> f <- "test_int.tif"
> writeRaster(r, f, datatype = "INT2U", overwrite = TRUE)
> s <- raster(f)
> dataType(s)
>
> [1] "INT2U"
>
> Not the first time this has caught me out. I found it by checking
> mode(readGDAL(f)[[1]]) and realizing that the TIFF type was Float32, prior
> to the next steps.
>
> HTH
>
> :)
>
> Cheers, Mike
>
> On Fri, 24 Aug 2018 at 18:26 nevil amos <nevil.amos at gmail.com> wrote:
>
>> Roger,
>>
>> there was a reproducible example in my post:  it seems to have got a bit
>> scrambled in your reply.
>>
>> from the help in raster I thought that if I included  datatype="INT2S" in
>> the writeRaster() command the values would be formatted in the output file
>> ( and the subsequent reading using raster() of that file) as integer  is
>> this not the case?
>>
>> Here it is the reproducible example
>>
>> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
>> m<-matrix(v,10,10)
>> r<-raster(m)
>> dataType(r)
>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
>> s<-raster("test_int.tif")
>> dataType(s)
>>
>> On Fri, 24 Aug 2018 at 18:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> Thanks, Mike. I agree that the lower level interface in rgdal is
>>> flexible enough, but as you say non-trivial. Nevil: could you please
>>> provide a small reproducible example to point people in the right direction?
>>>
>>> Roger
>>>
>>> Roger Bivand
>>> Norwegian School of Economics
>>> Bergen, Norway
>>>
>>>
>>>
>>> Fra: Michael Sumner
>>> Sendt: fredag 24. august, 09.14
>>> Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
>>> Til: nevil amos
>>> Kopi: r-sig-geo at r-project.org
>>>
>>>
>>> I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
>>> integers, so you can build an empty raster and copy the values over. But
>>> will need to derive from the rgdal version to catch all the metadata
>>> (structure, extent, and crs). I think it's doable and will try later. There
>>> are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug
>>> 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs)
>>> that contain whole number values > between 0 and 100, and NA values. or
>>> 0,1,and NA > they are currently in Float format, I am trying to rewrite
>>> them as integer > rasters, firstly to save space, and secondly so that I
>>> can later read the > values stack of all the rasters into an integer array.
>>> using getValues(). > > To do this I am setting the dataType to INT2U in
>>> writeRaster, however when > I read the save file back into R the format is
>>> not INT2U but FLT8S > > toy example: > > v m r dataType(r) >
>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s)
>>> > > the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > >
>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s >
>>> dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values
>>> are stored as integer? > > Many thanks > > [[alternative HTML version
>>> deleted]] > > _______________________________________________ > R-sig-Geo
>>> mailing list > R-sig-Geo at r-project.org >
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael Sumner
>>> Software and Database Engineer Australian Antarctic Division 203
>>> Channel Highway Kingston Tasmania 7050 Australia
>>> <https://maps.google.com/?q=203+Channel%0D%0A+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>>> [[alternative HTML version deleted]]
>>> _______________________________________________ R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Fri Aug 24 15:15:29 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Fri, 24 Aug 2018 10:15:29 -0300
Subject: [R-sig-Geo] drawing a polygon from several lines
In-Reply-To: <CAE8g1gO7JXvV4sFLAqXHoL7OtyapiJbq++sSnVdH_8G4UNPWFA@mail.gmail.com>
References: <CAE8g1gO7JXvV4sFLAqXHoL7OtyapiJbq++sSnVdH_8G4UNPWFA@mail.gmail.com>
Message-ID: <CAE8g1gNpepZ4wj_e4XbCafM2H_KYS4vrHgMvg53T9xh3e=ZNOw@mail.gmail.com>

Dear colleagues

I finally could select the squares (cells) under the polygon. I extract the
points from the selected isobaths that fell within lat / lon limits and
with them I created a spatial polygon.

Bellow I share the script I wrote. Considering that I don't know much about
mapping in R, I would appreciate to hear suggestions to improve the code.

Best regards.

-- 
Ant?nio Olinto ?vila da Silva
Instituto de Pesca (Fisheries Institute)
S?o Paulo, Brasil

===================

library(rgdal)
library(rgeos)
rm(list = ls())

# import shapes
# isobath
https://www.dropbox.com/sh/us859uyijns36r9/AAC9N4OSwweLuW-fdsBWUy-ra?dl=0
isobaths <- readOGR(".","isobath")
isobaths <- spTransform(isobaths, CRS("+proj=longlat +datum=WGS84"))
proj4string(isobaths)
summary(isobaths)

# create a spatial grid and polygons
grd <-
GridTopology(cellcentre.offset=c(-47.75,-25.416667),cellsize=c(10/60,10/60),cells.dim=c(23,12))
squares <- as.SpatialPolygons.GridTopology(grd)
proj4string(squares) <- CRS("+proj=longlat +datum=WGS84")
summary(squares)
IDs <- sapply(slot(squares, "polygons"), function(x) slot(x, "ID"))

# set limits
latmin <- -24.8
latmax <- -24.02
lonmin <- -47.2
lonmax <- -44.8
depmin <- -25
depmax <- -60

# bounding box
mat.area <-
matrix(c(lonmin,latmax,lonmax,latmax,lonmax,latmin,lonmin,latmin),ncol=2,byrow=T)
spp.area <- SpatialPolygons(list(Polygons(list(Polygon(mat.area)) ,
ID='1')))
proj4string(spp.area) <- CRS("+proj=longlat +datum=WGS84")

# plot polygons isolines and bounding box
plot(squares, axes=T)
#~ text(coordinates(squares),labels=IDs, cex=0.7)
plot(isobaths,add=T)
plot(spp.area,border="red",add=T)

# select isobaths
summary(isobaths)
isomin <- subset(isobaths, ID %in% depmin)
proj4string(isomin) <- CRS("+proj=longlat +datum=WGS84")
isomax <- subset(isobaths, ID %in% depmax)
proj4string(isomax) <- CRS("+proj=longlat +datum=WGS84")

plot(isomin,add=T,col="deepskyblue3",lwd=2)
plot(isomax,add=T,col="dodgerblue4",lwd=2)

# cut isobaths
limmin <- subset(coordinates(isomin)[[1]][[1]],
          coordinates(isomin)[[1]][[1]][,2]<=latmax &
coordinates(isomin)[[1]][[1]][,2]>=latmin &
          coordinates(isomin)[[1]][[1]][,1]<=lonmax &
coordinates(isomin)[[1]][[1]][,1]>=lonmin)
limmax <- subset(coordinates(isomax)[[1]][[1]],
          coordinates(isomax)[[1]][[1]][,2]<=latmax &
coordinates(isomax)[[1]][[1]][,2]>=latmin &
          coordinates(isomax)[[1]][[1]][,1]<=lonmax &
coordinates(isomax)[[1]][[1]][,1]>=lonmin)

points(limmin,col="chartreuse3")
points(limmax,col="chartreuse4")

# create the polygon
spp.farea <-
SpatialPolygons(list(Polygons(list(Polygon(rbind(limmin,limmax))),ID='1')))
proj4string(spp.farea) <- CRS("+proj=longlat +datum=WGS84")

plot(spp.farea,col="chocolate3",lwd=2,add=T)

# select the squares under the polygon
fareasq <- squares[spp.farea,]
fareace <- gCentroid(fareasq,byid=TRUE)

# final plot
plot(fareasq,axes=T)
points(fareace,pch=10,col="darkgreen",cex=4)
text(coordinates(squares), labels=IDs, cex=0.7)
plot(isomin,add=T,col="deepskyblue3",lwd=2)
plot(isomax,add=T,col="dodgerblue4",lwd=2)
plot(spp.area,border="red",add=T,lty=2)

	[[alternative HTML version deleted]]


From nevil@@mo@ @ending from gm@il@com  Fri Aug 24 15:18:16 2018
From: nevil@@mo@ @ending from gm@il@com (nevil amos)
Date: Fri, 24 Aug 2018 23:18:16 +1000
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAAcGz9-jyuy3hjnMUDTWrD1gA5Uz2Ge_Z6b=F4eFJarS2v20Pg@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
 <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
 <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>
 <CAAcGz99Yd_FYsA2-yM48sa-V4Hg2n9nEdC7NUR-8srDeDtuwZw@mail.gmail.com>
 <CAAcGz9-jyuy3hjnMUDTWrD1gA5Uz2Ge_Z6b=F4eFJarS2v20Pg@mail.gmail.com>
Message-ID: <CAN9eD7mCejRtXtjZTjB-opKqDt_2R4UsYFTUXO_WJgx01WSvPA@mail.gmail.com>

Thanks,

I think it did help
datatype vs dataType was indeed the problem!

On Fri, 24 Aug 2018 at 22:14, Michael Sumner <mdsumner at gmail.com> wrote:

> That doesn't help though!
>
> Sorry, I thought that was it, will sleep on it.
>
> Cheers, Mike
>
> On Fri, 24 Aug 2018 at 22:00 Michael Sumner <mdsumner at gmail.com> wrote:
>
>> Sorry, I was wrong - the actual issue is that the writeRaster argument is
>> "datatype", it gets conflated with the function that is dataType().
>>
>> f <- "test_int.tif"
>> writeRaster(r, f, datatype = "INT2U", overwrite = TRUE)
>> s <- raster(f)
>> dataType(s)
>>
>> [1] "INT2U"
>>
>> Not the first time this has caught me out. I found it by checking
>> mode(readGDAL(f)[[1]]) and realizing that the TIFF type was Float32, prior
>> to the next steps.
>>
>> HTH
>>
>> :)
>>
>> Cheers, Mike
>>
>> On Fri, 24 Aug 2018 at 18:26 nevil amos <nevil.amos at gmail.com> wrote:
>>
>>> Roger,
>>>
>>> there was a reproducible example in my post:  it seems to have got a bit
>>> scrambled in your reply.
>>>
>>> from the help in raster I thought that if I included  datatype="INT2S"
>>> in the writeRaster() command the values would be formatted in the output
>>> file ( and the subsequent reading using raster() of that file) as integer
>>> is this not the case?
>>>
>>> Here it is the reproducible example
>>>
>>> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
>>> m<-matrix(v,10,10)
>>> r<-raster(m)
>>> dataType(r)
>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
>>> s<-raster("test_int.tif")
>>> dataType(s)
>>>
>>> On Fri, 24 Aug 2018 at 18:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> Thanks, Mike. I agree that the lower level interface in rgdal is
>>>> flexible enough, but as you say non-trivial. Nevil: could you please
>>>> provide a small reproducible example to point people in the right direction?
>>>>
>>>> Roger
>>>>
>>>> Roger Bivand
>>>> Norwegian School of Economics
>>>> Bergen, Norway
>>>>
>>>>
>>>>
>>>> Fra: Michael Sumner
>>>> Sendt: fredag 24. august, 09.14
>>>> Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
>>>> Til: nevil amos
>>>> Kopi: r-sig-geo at r-project.org
>>>>
>>>>
>>>> I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
>>>> integers, so you can build an empty raster and copy the values over. But
>>>> will need to derive from the rgdal version to catch all the metadata
>>>> (structure, extent, and crs). I think it's doable and will try later. There
>>>> are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug
>>>> 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs)
>>>> that contain whole number values > between 0 and 100, and NA values. or
>>>> 0,1,and NA > they are currently in Float format, I am trying to rewrite
>>>> them as integer > rasters, firstly to save space, and secondly so that I
>>>> can later read the > values stack of all the rasters into an integer array.
>>>> using getValues(). > > To do this I am setting the dataType to INT2U in
>>>> writeRaster, however when > I read the save file back into R the format is
>>>> not INT2U but FLT8S > > toy example: > > v m r dataType(r) >
>>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s)
>>>> > > the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > >
>>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s >
>>>> dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values
>>>> are stored as integer? > > Many thanks > > [[alternative HTML version
>>>> deleted]] > > _______________________________________________ > R-sig-Geo
>>>> mailing list > R-sig-Geo at r-project.org >
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael
>>>> Sumner Software and Database Engineer Australian Antarctic Division 203
>>>> Channel Highway Kingston Tasmania 7050 Australia
>>>> <https://maps.google.com/?q=203+Channel%0D%0A+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>>>> [[alternative HTML version deleted]]
>>>> _______________________________________________ R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>

	[[alternative HTML version deleted]]


From vij@ylull@ @ending from gm@il@com  Fri Aug 24 15:58:43 2018
From: vij@ylull@ @ending from gm@il@com (Vijay Lulla)
Date: Fri, 24 Aug 2018 09:58:43 -0400
Subject: [R-sig-Geo] drawing a polygon from several lines
In-Reply-To: <CAE8g1gNpepZ4wj_e4XbCafM2H_KYS4vrHgMvg53T9xh3e=ZNOw@mail.gmail.com>
References: <CAE8g1gO7JXvV4sFLAqXHoL7OtyapiJbq++sSnVdH_8G4UNPWFA@mail.gmail.com>
 <CAE8g1gNpepZ4wj_e4XbCafM2H_KYS4vrHgMvg53T9xh3e=ZNOw@mail.gmail.com>
Message-ID: <CAKkiGbvEeaMSDw2+b5pVExhSGpWbsdpmHVz2SzkU6TbuSAmWqg@mail.gmail.com>

Very nice, Antonio!!  Thanks for sharing your script.  The only minor
suggestion I have to offer is that you can make your "cut isobath" portion
easier to read (at least IMO) by using `with` and `between` (either
dplyr::between or data.table::between).  Below is how I would've done it.

limmin <- with(list(coords = coordinates(isomin)[[1]][[1]]),
               subset(coords, between(coords[, 1], lonmin, lonmax) &
                              between(coords[, 2], latmin, latmax)))

Again, thanks for sharing your problem and solution.  I found it
instructive!
Cordially,
Vijay.


On Fri, Aug 24, 2018 at 9:16 AM Antonio Silva <aolinto.lst at gmail.com> wrote:

> Dear colleagues
>
> I finally could select the squares (cells) under the polygon. I extract the
> points from the selected isobaths that fell within lat / lon limits and
> with them I created a spatial polygon.
>
> Bellow I share the script I wrote. Considering that I don't know much about
> mapping in R, I would appreciate to hear suggestions to improve the code.
>
> Best regards.
>
> --
> Ant?nio Olinto ?vila da Silva
> Instituto de Pesca (Fisheries Institute)
> S?o Paulo, Brasil
>
> ===================
>
> library(rgdal)
> library(rgeos)
> rm(list = ls())
>
> # import shapes
> # isobath
> https://www.dropbox.com/sh/us859uyijns36r9/AAC9N4OSwweLuW-fdsBWUy-ra?dl=0
> isobaths <- readOGR(".","isobath")
> isobaths <- spTransform(isobaths, CRS("+proj=longlat +datum=WGS84"))
> proj4string(isobaths)
> summary(isobaths)
>
> # create a spatial grid and polygons
> grd <-
>
> GridTopology(cellcentre.offset=c(-47.75,-25.416667),cellsize=c(10/60,10/60),cells.dim=c(23,12))
> squares <- as.SpatialPolygons.GridTopology(grd)
> proj4string(squares) <- CRS("+proj=longlat +datum=WGS84")
> summary(squares)
> IDs <- sapply(slot(squares, "polygons"), function(x) slot(x, "ID"))
>
> # set limits
> latmin <- -24.8
> latmax <- -24.02
> lonmin <- -47.2
> lonmax <- -44.8
> depmin <- -25
> depmax <- -60
>
> # bounding box
> mat.area <-
>
> matrix(c(lonmin,latmax,lonmax,latmax,lonmax,latmin,lonmin,latmin),ncol=2,byrow=T)
> spp.area <- SpatialPolygons(list(Polygons(list(Polygon(mat.area)) ,
> ID='1')))
> proj4string(spp.area) <- CRS("+proj=longlat +datum=WGS84")
>
> # plot polygons isolines and bounding box
> plot(squares, axes=T)
> #~ text(coordinates(squares),labels=IDs, cex=0.7)
> plot(isobaths,add=T)
> plot(spp.area,border="red",add=T)
>
> # select isobaths
> summary(isobaths)
> isomin <- subset(isobaths, ID %in% depmin)
> proj4string(isomin) <- CRS("+proj=longlat +datum=WGS84")
> isomax <- subset(isobaths, ID %in% depmax)
> proj4string(isomax) <- CRS("+proj=longlat +datum=WGS84")
>
> plot(isomin,add=T,col="deepskyblue3",lwd=2)
> plot(isomax,add=T,col="dodgerblue4",lwd=2)
>
> # cut isobaths
> limmin <- subset(coordinates(isomin)[[1]][[1]],
>           coordinates(isomin)[[1]][[1]][,2]<=latmax &
> coordinates(isomin)[[1]][[1]][,2]>=latmin &
>           coordinates(isomin)[[1]][[1]][,1]<=lonmax &
> coordinates(isomin)[[1]][[1]][,1]>=lonmin)
> limmax <- subset(coordinates(isomax)[[1]][[1]],
>           coordinates(isomax)[[1]][[1]][,2]<=latmax &
> coordinates(isomax)[[1]][[1]][,2]>=latmin &
>           coordinates(isomax)[[1]][[1]][,1]<=lonmax &
> coordinates(isomax)[[1]][[1]][,1]>=lonmin)
>
> points(limmin,col="chartreuse3")
> points(limmax,col="chartreuse4")
>
> # create the polygon
> spp.farea <-
> SpatialPolygons(list(Polygons(list(Polygon(rbind(limmin,limmax))),ID='1')))
> proj4string(spp.farea) <- CRS("+proj=longlat +datum=WGS84")
>
> plot(spp.farea,col="chocolate3",lwd=2,add=T)
>
> # select the squares under the polygon
> fareasq <- squares[spp.farea,]
> fareace <- gCentroid(fareasq,byid=TRUE)
>
> # final plot
> plot(fareasq,axes=T)
> points(fareace,pch=10,col="darkgreen",cex=4)
> text(coordinates(squares), labels=IDs, cex=0.7)
> plot(isomin,add=T,col="deepskyblue3",lwd=2)
> plot(isomax,add=T,col="dodgerblue4",lwd=2)
> plot(spp.area,border="red",add=T,lty=2)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Vijay Lulla

Assistant Professor,
Dept. of Geography, IUPUI
425 University Blvd, CA-207C.
Indianapolis, IN-46202
vlulla at iupui.edu
ORCID: https://orcid.org/0000-0002-0823-2522
Webpage: http://vijaylulla.com

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Fri Aug 24 16:16:30 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Fri, 24 Aug 2018 16:16:30 +0200
Subject: [R-sig-Geo] Problems converting rasters from float to integer.
In-Reply-To: <CAN9eD7mCejRtXtjZTjB-opKqDt_2R4UsYFTUXO_WJgx01WSvPA@mail.gmail.com>
References: <CAN9eD7=fbhK695ZnD_GdDbwpmOcUnSoC3H3QdtPZn6yyLkzaWg@mail.gmail.com>
 <CAAcGz99HbnO92J+tJOQw-DveWM+JUK2QuaLtcsfuBLeuTmmZ+Q@mail.gmail.com>
 <BDBEEBC63E3A2C25.1f3b40f8-9ede-473d-81b4-255e55e2c1af@mail.outlook.com>
 <CAN9eD7mL=G3n9B3Gn4KVL1=xXPzSZ2RV=rw+0+S9p47r_+TuZw@mail.gmail.com>
 <CAAcGz99Yd_FYsA2-yM48sa-V4Hg2n9nEdC7NUR-8srDeDtuwZw@mail.gmail.com>
 <CAAcGz9-jyuy3hjnMUDTWrD1gA5Uz2Ge_Z6b=F4eFJarS2v20Pg@mail.gmail.com>
 <CAN9eD7mCejRtXtjZTjB-opKqDt_2R4UsYFTUXO_WJgx01WSvPA@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1808241611550.28997@reclus.nhh.no>

On Fri, 24 Aug 2018, nevil amos wrote:

> Thanks,
>
> I think it did help
> datatype vs dataType was indeed the problem!

The underlying problem is that dataType= is going into ..., and because 
nothing needs it, it isn't spotted. Could someone contribute a PR to trap 
this, from https://github.com/rspatial/raster?

Roger

>
> On Fri, 24 Aug 2018 at 22:14, Michael Sumner <mdsumner at gmail.com> wrote:
>
>> That doesn't help though!
>>
>> Sorry, I thought that was it, will sleep on it.
>>
>> Cheers, Mike
>>
>> On Fri, 24 Aug 2018 at 22:00 Michael Sumner <mdsumner at gmail.com> wrote:
>>
>>> Sorry, I was wrong - the actual issue is that the writeRaster argument is
>>> "datatype", it gets conflated with the function that is dataType().
>>>
>>> f <- "test_int.tif"
>>> writeRaster(r, f, datatype = "INT2U", overwrite = TRUE)
>>> s <- raster(f)
>>> dataType(s)
>>>
>>> [1] "INT2U"
>>>
>>> Not the first time this has caught me out. I found it by checking
>>> mode(readGDAL(f)[[1]]) and realizing that the TIFF type was Float32, prior
>>> to the next steps.
>>>
>>> HTH
>>>
>>> :)
>>>
>>> Cheers, Mike
>>>
>>> On Fri, 24 Aug 2018 at 18:26 nevil amos <nevil.amos at gmail.com> wrote:
>>>
>>>> Roger,
>>>>
>>>> there was a reproducible example in my post:  it seems to have got a bit
>>>> scrambled in your reply.
>>>>
>>>> from the help in raster I thought that if I included  datatype="INT2S"
>>>> in the writeRaster() command the values would be formatted in the output
>>>> file ( and the subsequent reading using raster() of that file) as integer
>>>> is this not the case?
>>>>
>>>> Here it is the reproducible example
>>>>
>>>> v<-c(rep(1.00000,25),rep(0.00000,50),rep(NA,25))
>>>> m<-matrix(v,10,10)
>>>> r<-raster(m)
>>>> dataType(r)
>>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T)
>>>> s<-raster("test_int.tif")
>>>> dataType(s)
>>>>
>>>> On Fri, 24 Aug 2018 at 18:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>
>>>>> Thanks, Mike. I agree that the lower level interface in rgdal is
>>>>> flexible enough, but as you say non-trivial. Nevil: could you please
>>>>> provide a small reproducible example to point people in the right direction?
>>>>>
>>>>> Roger
>>>>>
>>>>> Roger Bivand
>>>>> Norwegian School of Economics
>>>>> Bergen, Norway
>>>>>
>>>>>
>>>>>
>>>>> Fra: Michael Sumner
>>>>> Sendt: fredag 24. august, 09.14
>>>>> Emne: Re: [R-sig-Geo] Problems converting rasters from float to integer.
>>>>> Til: nevil amos
>>>>> Kopi: r-sig-geo at r-project.org
>>>>>
>>>>>
>>>>> I'm pretty sure readGDAL from rgdal (that raster uses) will keep as
>>>>> integers, so you can build an empty raster and copy the values over. But
>>>>> will need to derive from the rgdal version to catch all the metadata
>>>>> (structure, extent, and crs). I think it's doable and will try later. There
>>>>> are other options but nothing trivial afaik. Cheers, Mike On Fri, 24 Aug
>>>>> 2018, 16:45 nevil amos wrote: > I have a large number of rasters ( tiffs)
>>>>> that contain whole number values > between 0 and 100, and NA values. or
>>>>> 0,1,and NA > they are currently in Float format, I am trying to rewrite
>>>>> them as integer > rasters, firstly to save space, and secondly so that I
>>>>> can later read the > values stack of all the rasters into an integer array.
>>>>> using getValues(). > > To do this I am setting the dataType to INT2U in
>>>>> writeRaster, however when > I read the save file back into R the format is
>>>>> not INT2U but FLT8S > > toy example: > > v m r dataType(r) >
>>>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > s dataType(s)
>>>>>>> the result I get: > > > v > m > r > dataType(r) > [1] "FLT4S" > >
>>>>> writeRaster(r,"test_int.tif",dataType="INT2U",overwrite=T) > > s >
>>>>> dataType(s) > [1] "FLT8S" > > > > > Can you suggest how I ensure the values
>>>>> are stored as integer? > > Many thanks > > [[alternative HTML version
>>>>> deleted]] > > _______________________________________________ > R-sig-Geo
>>>>> mailing list > R-sig-Geo at r-project.org >
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael
>>>>> Sumner Software and Database Engineer Australian Antarctic Division 203
>>>>> Channel Highway Kingston Tasmania 7050 Australia
>>>>> <https://maps.google.com/?q=203+Channel%0D%0A+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>>>>> [[alternative HTML version deleted]]
>>>>> _______________________________________________ R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>> --
>>> Dr. Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> 203 Channel Highway
>>> Kingston Tasmania 7050 Australia
>>>
>>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @olinto@l@t @ending from gm@il@com  Fri Aug 24 16:30:22 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Fri, 24 Aug 2018 11:30:22 -0300
Subject: [R-sig-Geo] drawing a polygon from several lines
In-Reply-To: <CAKkiGbvEeaMSDw2+b5pVExhSGpWbsdpmHVz2SzkU6TbuSAmWqg@mail.gmail.com>
References: <CAE8g1gO7JXvV4sFLAqXHoL7OtyapiJbq++sSnVdH_8G4UNPWFA@mail.gmail.com>
 <CAE8g1gNpepZ4wj_e4XbCafM2H_KYS4vrHgMvg53T9xh3e=ZNOw@mail.gmail.com>
 <CAKkiGbvEeaMSDw2+b5pVExhSGpWbsdpmHVz2SzkU6TbuSAmWqg@mail.gmail.com>
Message-ID: <CAE8g1gP33CpD6hPK2uwzptQQ-CYtHuJE7eVcjx4BgYa8o+k7RA@mail.gmail.com>

It's my pleasure to share Lulla. Thanks for the suggestion, I will adopt it.

Regards,

Antonio

Em sex, 24 de ago de 2018 ?s 10:58, Vijay Lulla <vijaylulla at gmail.com>
escreveu:

> Very nice, Antonio!!  Thanks for sharing your script.  The only minor
> suggestion I have to offer is that you can make your "cut isobath" portion
> easier to read (at least IMO) by using `with` and `between` (either
> dplyr::between or data.table::between).  Below is how I would've done it.
>
> limmin <- with(list(coords = coordinates(isomin)[[1]][[1]]),
>                subset(coords, between(coords[, 1], lonmin, lonmax) &
>                               between(coords[, 2], latmin, latmax)))
>
> Again, thanks for sharing your problem and solution.  I found it
> instructive!
> Cordially,
> Vijay.
>
>
> On Fri, Aug 24, 2018 at 9:16 AM Antonio Silva <aolinto.lst at gmail.com>
> wrote:
>
>> Dear colleagues
>>
>> I finally could select the squares (cells) under the polygon. I extract
>> the
>> points from the selected isobaths that fell within lat / lon limits and
>> with them I created a spatial polygon.
>>
>> Bellow I share the script I wrote. Considering that I don't know much
>> about
>> mapping in R, I would appreciate to hear suggestions to improve the code.
>>
>> Best regards.
>>
>> --
>> Ant?nio Olinto ?vila da Silva
>> Instituto de Pesca (Fisheries Institute)
>> S?o Paulo, Brasil
>>
>> ===================
>>
>> library(rgdal)
>> library(rgeos)
>> rm(list = ls())
>>
>> # import shapes
>> # isobath
>> https://www.dropbox.com/sh/us859uyijns36r9/AAC9N4OSwweLuW-fdsBWUy-ra?dl=0
>> isobaths <- readOGR(".","isobath")
>> isobaths <- spTransform(isobaths, CRS("+proj=longlat +datum=WGS84"))
>> proj4string(isobaths)
>> summary(isobaths)
>>
>> # create a spatial grid and polygons
>> grd <-
>>
>> GridTopology(cellcentre.offset=c(-47.75,-25.416667),cellsize=c(10/60,10/60),cells.dim=c(23,12))
>> squares <- as.SpatialPolygons.GridTopology(grd)
>> proj4string(squares) <- CRS("+proj=longlat +datum=WGS84")
>> summary(squares)
>> IDs <- sapply(slot(squares, "polygons"), function(x) slot(x, "ID"))
>>
>> # set limits
>> latmin <- -24.8
>> latmax <- -24.02
>> lonmin <- -47.2
>> lonmax <- -44.8
>> depmin <- -25
>> depmax <- -60
>>
>> # bounding box
>> mat.area <-
>>
>> matrix(c(lonmin,latmax,lonmax,latmax,lonmax,latmin,lonmin,latmin),ncol=2,byrow=T)
>> spp.area <- SpatialPolygons(list(Polygons(list(Polygon(mat.area)) ,
>> ID='1')))
>> proj4string(spp.area) <- CRS("+proj=longlat +datum=WGS84")
>>
>> # plot polygons isolines and bounding box
>> plot(squares, axes=T)
>> #~ text(coordinates(squares),labels=IDs, cex=0.7)
>> plot(isobaths,add=T)
>> plot(spp.area,border="red",add=T)
>>
>> # select isobaths
>> summary(isobaths)
>> isomin <- subset(isobaths, ID %in% depmin)
>> proj4string(isomin) <- CRS("+proj=longlat +datum=WGS84")
>> isomax <- subset(isobaths, ID %in% depmax)
>> proj4string(isomax) <- CRS("+proj=longlat +datum=WGS84")
>>
>> plot(isomin,add=T,col="deepskyblue3",lwd=2)
>> plot(isomax,add=T,col="dodgerblue4",lwd=2)
>>
>> # cut isobaths
>> limmin <- subset(coordinates(isomin)[[1]][[1]],
>>           coordinates(isomin)[[1]][[1]][,2]<=latmax &
>> coordinates(isomin)[[1]][[1]][,2]>=latmin &
>>           coordinates(isomin)[[1]][[1]][,1]<=lonmax &
>> coordinates(isomin)[[1]][[1]][,1]>=lonmin)
>> limmax <- subset(coordinates(isomax)[[1]][[1]],
>>           coordinates(isomax)[[1]][[1]][,2]<=latmax &
>> coordinates(isomax)[[1]][[1]][,2]>=latmin &
>>           coordinates(isomax)[[1]][[1]][,1]<=lonmax &
>> coordinates(isomax)[[1]][[1]][,1]>=lonmin)
>>
>> points(limmin,col="chartreuse3")
>> points(limmax,col="chartreuse4")
>>
>> # create the polygon
>> spp.farea <-
>>
>> SpatialPolygons(list(Polygons(list(Polygon(rbind(limmin,limmax))),ID='1')))
>> proj4string(spp.farea) <- CRS("+proj=longlat +datum=WGS84")
>>
>> plot(spp.farea,col="chocolate3",lwd=2,add=T)
>>
>> # select the squares under the polygon
>> fareasq <- squares[spp.farea,]
>> fareace <- gCentroid(fareasq,byid=TRUE)
>>
>> # final plot
>> plot(fareasq,axes=T)
>> points(fareace,pch=10,col="darkgreen",cex=4)
>> text(coordinates(squares), labels=IDs, cex=0.7)
>> plot(isomin,add=T,col="deepskyblue3",lwd=2)
>> plot(isomax,add=T,col="dodgerblue4",lwd=2)
>> plot(spp.area,border="red",add=T,lty=2)
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Vijay Lulla
>
> Assistant Professor,
> Dept. of Geography, IUPUI
> 425 University Blvd, CA-207C.
> Indianapolis, IN-46202
> vlulla at iupui.edu
> ORCID: https://orcid.org/0000-0002-0823-2522
> Webpage: http://vijaylulla.com
>

	[[alternative HTML version deleted]]


From ol@tunde@mo@ob@l@je @ending from coven@ntuniver@ity@edu@ng  Fri Aug 24 22:50:12 2018
From: ol@tunde@mo@ob@l@je @ending from coven@ntuniver@ity@edu@ng (Olatunde Mosobalaje)
Date: Fri, 24 Aug 2018 21:50:12 +0100
Subject: [R-sig-Geo] How do I sample a synthetic random field at specified
 points?
Message-ID: <CAO1OqVQy7o_YQTvoky5KYjD4DfQyV9QLuqUW2Y_O4Ng7HkyyEg@mail.gmail.com>

Hail, all.

I have been able to generate a 3D synthetic random field (via unconditional
Gaussian simulation) using gstat package. I now need to sample the fields
at some specified coordinate points (not random points). I have not been
able to find a function to do this. Kindly note that my specified sample
points also come in 3D as I would need to sample at multiple depths for
each x-y coordinates.

Thank you, all.

Olatunde

	[[alternative HTML version deleted]]


From @riel@fuente@di @ending from u@@ch@cl  Mon Aug 27 22:53:01 2018
From: @riel@fuente@di @ending from u@@ch@cl (Ariel Fuentesdi)
Date: Mon, 27 Aug 2018 17:53:01 -0300
Subject: [R-sig-Geo] Spatial Query (Selection) with Apply
Message-ID: <CAD0a9Ki0WBK4C9-PVVYM35jS_3rDZSAL6PiiMHZX1YLRZZanJg@mail.gmail.com>

Hi,

I want to do multiple selections of a point shapefile based on polygons on
other layers, I can do this in a for loop, but I desire to do this in a
function of the apply family.

I named the point shapefile "nodes" and the polygons shapefile "zones".

This is what I did:

tmp <- list()
for (i in 1:nrow(zones at data)) {
    tmp[[i]] <- nodes[subset(zones, ESTUDIO == i),]
    tmp
  }

But I have no clue how to change it to the apply family, can you provide
an example of this?

Thanks in advance.

Regards,
Ariel Fuentes

	[[alternative HTML version deleted]]


From rob00x @ending from gm@il@com  Tue Aug 28 00:32:34 2018
From: rob00x @ending from gm@il@com (Robin Lovelace)
Date: Mon, 27 Aug 2018 23:32:34 +0100
Subject: [R-sig-Geo] Spatial Query (Selection) with Apply
In-Reply-To: <CAD0a9Ki0WBK4C9-PVVYM35jS_3rDZSAL6PiiMHZX1YLRZZanJg@mail.gmail.com>
References: <CAD0a9Ki0WBK4C9-PVVYM35jS_3rDZSAL6PiiMHZX1YLRZZanJg@mail.gmail.com>
Message-ID: <CAF16KkUQ8Jg3EkQdxuAYX+_V9KKskAiEbRKincPhWNkNhuY7yg@mail.gmail.com>

Hi Ariel,

It helps when asking for help with code to produce a reproducible example.
To understand your input data I've created nodes and zones based on the
spData data nz_height and nz_elev. Based on the assumption you want to find
all the nodes in each zone I think the direct answer to your question is
something like the following:

tmp2 = lapply(s, function(x) {
  nodes[zones[x, ], ]
})

The longer answer is that aggregate(), st_join() + aggregate()/summarize()
may provide quicker solutions, depending on what you want to do with the
points after grouping them by which zone they fall in.
Note: I've used sf objects based on the explanation here https://geocompr.
robinlovelace.net/spatial-operations.html#spatial-vec which may not work
with sp data but the aggregate code should work roughly the same:

# install.packages("sf")
# install.packages("spData")
library(spData)
library(sf)
#> Linking to GEOS 3.6.2, GDAL 2.2.3, proj.4 4.9.3
zones = nz
nodes = nz_height
tmp = list()
s = 1:nrow(nz)

for(i in s) {
  tmp[[i]] = nodes[nz[i, ], ]
}

# understand what's going on with plots (not shown)
# plot(st_geometry(nz))
# plot(st_geometry(tmp[[i]]), add = TRUE, col = "red")
# plot(nz[i, ], col = "green", add = TRUE)

tmp2 = lapply(s, function(x) {
  nz_height[nz[x, ], ]
})

identical(tmp, tmp2)
#> [1] TRUE

Created on 2018-08-27 by the [reprex package](http://reprex.tidyverse.org)
(v0.2.0).

I've also pasted the reprex into the geocompr github tracker so the plots
can be seen and the code formatted: https://github.com/
Robinlovelace/geocompr/issues/294

Hope this helps,

Robin


On Mon, Aug 27, 2018 at 9:53 PM, Ariel Fuentesdi <ariel.fuentesdi at usach.cl>
wrote:

> Hi,
>
> I want to do multiple selections of a point shapefile based on polygons on
> other layers, I can do this in a for loop, but I desire to do this in a
> function of the apply family.
>
> I named the point shapefile "nodes" and the polygons shapefile "zones".
>
> This is what I did:
>
> tmp <- list()
> for (i in 1:nrow(zones at data)) {
>     tmp[[i]] <- nodes[subset(zones, ESTUDIO == i),]
>     tmp
>   }
>
> But I have no clue how to change it to the apply family, can you provide
> an example of this?
>
> Thanks in advance.
>
> Regards,
> Ariel Fuentes
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @riel@fuente@di @ending from u@@ch@cl  Tue Aug 28 22:13:23 2018
From: @riel@fuente@di @ending from u@@ch@cl (Ariel Fuentesdi)
Date: Tue, 28 Aug 2018 17:13:23 -0300
Subject: [R-sig-Geo] Spatial Query (Selection) with Apply
In-Reply-To: <CAF16KkUQ8Jg3EkQdxuAYX+_V9KKskAiEbRKincPhWNkNhuY7yg@mail.gmail.com>
References: <CAD0a9Ki0WBK4C9-PVVYM35jS_3rDZSAL6PiiMHZX1YLRZZanJg@mail.gmail.com>
 <CAF16KkUQ8Jg3EkQdxuAYX+_V9KKskAiEbRKincPhWNkNhuY7yg@mail.gmail.com>
Message-ID: <CAD0a9KiKNTZ-3tmBMVqr8=fYVzs71KhHq85E+dP0kHAkUh9oxA@mail.gmail.com>

Thanks, Robin

It worked perfectly, although I transformed the data from sf to
SpatialDataFrame objects with:

zones <- as(zones, "Spatial")
nodes <- as(nodes, "Spatial")

The next step I will follow is to create Distance Matrix like this:

coord <- tmp2[[1]]@coords
dist1 <- apply(X = coord, MARGIN = 1, FUN = function(x) spDistsN1(coord, x,
longlat = T))

obviously, the task is a distance matrix for every selection. ?What would
you recommend, the aggregate function as you talked before or something
like a nested apply?

Regards,
Ariel



2018-08-27 19:32 GMT-03:00 Robin Lovelace <rob00x at gmail.com>:

> Hi Ariel,
>
> It helps when asking for help with code to produce a reproducible example.
> To understand your input data I've created nodes and zones based on the
> spData data nz_height and nz_elev. Based on the assumption you want to find
> all the nodes in each zone I think the direct answer to your question is
> something like the following:
>
> tmp2 = lapply(s, function(x) {
>   nodes[zones[x, ], ]
> })
>
> The longer answer is that aggregate(), st_join() + aggregate()/summarize()
> may provide quicker solutions, depending on what you want to do with the
> points after grouping them by which zone they fall in.
> Note: I've used sf objects based on the explanation here
> https://geocompr.robinlovelace.net/spatial-operations.html#spatial-vec
> which may not work with sp data but the aggregate code should work roughly
> the same:
>
> # install.packages("sf")
> # install.packages("spData")
> library(spData)
> library(sf)
> #> Linking to GEOS 3.6.2, GDAL 2.2.3, proj.4 4.9.3
> zones = nz
> nodes = nz_height
> tmp = list()
> s = 1:nrow(nz)
>
> for(i in s) {
>   tmp[[i]] = nodes[nz[i, ], ]
> }
>
> # understand what's going on with plots (not shown)
> # plot(st_geometry(nz))
> # plot(st_geometry(tmp[[i]]), add = TRUE, col = "red")
> # plot(nz[i, ], col = "green", add = TRUE)
>
> tmp2 = lapply(s, function(x) {
>   nz_height[nz[x, ], ]
> })
>
> identical(tmp, tmp2)
> #> [1] TRUE
>
> Created on 2018-08-27 by the [reprex package](http://reprex.tidyverse.org)
> (v0.2.0).
>
> I've also pasted the reprex into the geocompr github tracker so the plots
> can be seen and the code formatted: https://github.com/Robinlovela
> ce/geocompr/issues/294
>
> Hope this helps,
>
> Robin
>
>
> On Mon, Aug 27, 2018 at 9:53 PM, Ariel Fuentesdi <ariel.fuentesdi at usach.cl
> > wrote:
>
>> Hi,
>>
>> I want to do multiple selections of a point shapefile based on polygons on
>> other layers, I can do this in a for loop, but I desire to do this in a
>> function of the apply family.
>>
>> I named the point shapefile "nodes" and the polygons shapefile "zones".
>>
>> This is what I did:
>>
>> tmp <- list()
>> for (i in 1:nrow(zones at data)) {
>>     tmp[[i]] <- nodes[subset(zones, ESTUDIO == i),]
>>     tmp
>>   }
>>
>> But I have no clue how to change it to the apply family, can you provide
>> an example of this?
>>
>> Thanks in advance.
>>
>> Regards,
>> Ariel Fuentes
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From erinm@hodge@@ @ending from gm@il@com  Tue Aug 28 23:45:49 2018
From: erinm@hodge@@ @ending from gm@il@com (Erin Hodgess)
Date: Tue, 28 Aug 2018 15:45:49 -0600
Subject: [R-sig-Geo] spatial-temporal variograms
Message-ID: <CACxE24=-63iuy=FYkKsuexhFwdNiHebUgdjjA_y9zXOWcsWQrQ@mail.gmail.com>

Hello everyone!

Hope you are having a good day.

This is an opinion question, please:  Typically, we think of the separable
model for s/t variograms as not realistic.  Which ones are better, as a
rule, please?  I know the correct answer is "It depends".  But would we
consider metric, or sum-metric (or some of the others) more realistic,
please?

Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From rob00x @ending from gm@il@com  Wed Aug 29 09:15:29 2018
From: rob00x @ending from gm@il@com (Robin Lovelace)
Date: Wed, 29 Aug 2018 08:15:29 +0100
Subject: [R-sig-Geo] Spatial Query (Selection) with Apply
In-Reply-To: <CAD0a9KiKNTZ-3tmBMVqr8=fYVzs71KhHq85E+dP0kHAkUh9oxA@mail.gmail.com>
References: <CAD0a9Ki0WBK4C9-PVVYM35jS_3rDZSAL6PiiMHZX1YLRZZanJg@mail.gmail.com>
 <CAF16KkUQ8Jg3EkQdxuAYX+_V9KKskAiEbRKincPhWNkNhuY7yg@mail.gmail.com>
 <CAD0a9KiKNTZ-3tmBMVqr8=fYVzs71KhHq85E+dP0kHAkUh9oxA@mail.gmail.com>
Message-ID: <CAF16KkWdvi-to8U_sNv54gxmRT5U5QV9+1R-h23MRxJrY3Etdw@mail.gmail.com>

Hi Ariel,

Glad it helped.

Yes you could place your apply command into a lapply to get a list of
matrices.

Something like this should work:

dist_list <- lapply(tmp, function(coord) {

   apply(X = coord, MARGIN = 1, FUN = function(x) spDistsN1(coord, x,
longlat = T)

}

Robin



On Tue, Aug 28, 2018 at 9:13 PM, Ariel Fuentesdi <ariel.fuentesdi at usach.cl>
wrote:

> Thanks, Robin
>
> It worked perfectly, although I transformed the data from sf to
> SpatialDataFrame objects with:
>
> zones <- as(zones, "Spatial")
> nodes <- as(nodes, "Spatial")
>
> The next step I will follow is to create Distance Matrix like this:
>
> coord <- tmp2[[1]]@coords
> dist1 <- apply(X = coord, MARGIN = 1, FUN = function(x) spDistsN1(coord,
> x, longlat = T))
>
> obviously, the task is a distance matrix for every selection. ?What would
> you recommend, the aggregate function as you talked before or something
> like a nested apply?
>
> Regards,
> Ariel
>
>
>
> 2018-08-27 19:32 GMT-03:00 Robin Lovelace <rob00x at gmail.com>:
>
>> Hi Ariel,
>>
>> It helps when asking for help with code to produce a reproducible
>> example. To understand your input data I've created nodes and zones based
>> on the spData data nz_height and nz_elev. Based on the assumption you want
>> to find all the nodes in each zone I think the direct answer to your
>> question is something like the following:
>>
>> tmp2 = lapply(s, function(x) {
>>   nodes[zones[x, ], ]
>> })
>>
>> The longer answer is that aggregate(), st_join() +
>> aggregate()/summarize() may provide quicker solutions, depending on what
>> you want to do with the points after grouping them by which zone they fall
>> in.
>> Note: I've used sf objects based on the explanation here
>> https://geocompr.robinlovelace.net/spatial-operations.html#spatial-vec
>> which may not work with sp data but the aggregate code should work roughly
>> the same:
>>
>> # install.packages("sf")
>> # install.packages("spData")
>> library(spData)
>> library(sf)
>> #> Linking to GEOS 3.6.2, GDAL 2.2.3, proj.4 4.9.3
>> zones = nz
>> nodes = nz_height
>> tmp = list()
>> s = 1:nrow(nz)
>>
>> for(i in s) {
>>   tmp[[i]] = nodes[nz[i, ], ]
>> }
>>
>> # understand what's going on with plots (not shown)
>> # plot(st_geometry(nz))
>> # plot(st_geometry(tmp[[i]]), add = TRUE, col = "red")
>> # plot(nz[i, ], col = "green", add = TRUE)
>>
>> tmp2 = lapply(s, function(x) {
>>   nz_height[nz[x, ], ]
>> })
>>
>> identical(tmp, tmp2)
>> #> [1] TRUE
>>
>> Created on 2018-08-27 by the [reprex package](http://reprex.tidyverse.org)
>> (v0.2.0).
>>
>> I've also pasted the reprex into the geocompr github tracker so the plots
>> can be seen and the code formatted: https://github.com/Robinlovela
>> ce/geocompr/issues/294
>>
>> Hope this helps,
>>
>> Robin
>>
>>
>> On Mon, Aug 27, 2018 at 9:53 PM, Ariel Fuentesdi <
>> ariel.fuentesdi at usach.cl> wrote:
>>
>>> Hi,
>>>
>>> I want to do multiple selections of a point shapefile based on polygons
>>> on
>>> other layers, I can do this in a for loop, but I desire to do this in a
>>> function of the apply family.
>>>
>>> I named the point shapefile "nodes" and the polygons shapefile "zones".
>>>
>>> This is what I did:
>>>
>>> tmp <- list()
>>> for (i in 1:nrow(zones at data)) {
>>>     tmp[[i]] <- nodes[subset(zones, ESTUDIO == i),]
>>>     tmp
>>>   }
>>>
>>> But I have no clue how to change it to the apply family, can you provide
>>> an example of this?
>>>
>>> Thanks in advance.
>>>
>>> Regards,
>>> Ariel Fuentes
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>

	[[alternative HTML version deleted]]


From jeremieju@te @ending from gm@il@com  Thu Aug 30 12:27:18 2018
From: jeremieju@te @ending from gm@il@com (=?UTF-8?B?SsOpcsOpbWllIEp1c3Rl?=)
Date: Thu, 30 Aug 2018 12:27:18 +0200
Subject: [R-sig-Geo] unbalanced panel
Message-ID: <CAPHJcdAOkA6d=oYtT+aOJS95apQ48XpvtDQUegQ2N=N3WmAQiw@mail.gmail.com>

Hello,

I was wondering if there are any plans to allow the estimation of
unbalanced panel in spdep or splm. I am not fortunate enough to have
balanced spatial data and I think this woud be a valuable input to the
community.

Is there a way to compute direct and indirect effects when estimating an
unbalanced panel spatial durbin model ?

Best regards,
Jeremie Juste

	[[alternative HTML version deleted]]


From r@hep@rd @ending from @ppl-eco@y@@com  Thu Aug 30 22:43:58 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Thu, 30 Aug 2018 13:43:58 -0700 (PDT)
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
Message-ID: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>

   Received my printed copy of Tom Hengl's book yesterday. The web site has
one page noting it was recently modified, but the most recent material I
find there is from 2011. And some of the links on the data and R code tabs
are broken.

   Have there been additions or changes to the book since then? Is this still
an active project?

   I'm finding this a great addition to Goovaert's book which I read a long
time ago and still reference.

Rich


From tom@hengl @ending from gm@il@com  Fri Aug 31 09:43:34 2018
From: tom@hengl @ending from gm@il@com (Tomislav Hengl)
Date: Fri, 31 Aug 2018 09:43:34 +0200
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
In-Reply-To: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
Message-ID: <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>


Dear Rich,

I am working on a rmarkdown update of the practical guide to GM (the 
working title is "A practical guide to spatial prediction with R"). As 
soon as I clean up these reports on my desk I will get on it (in about 2 
months should be online). My apologies to you and all other users for 
untidy website / my tardiness.

In the meantime you might also find this useful:

https://envirometrix.github.io/PredictiveSoilMapping/

BR,

-- 
T. (Tom) Hengl
https://envirometrix.net/staff/tomislav-hengl


On 08/30/2018 10:43 PM, Rich Shepard wrote:
>  ? Received my printed copy of Tom Hengl's book yesterday. The web site has
> one page noting it was recently modified, but the most recent material I
> find there is from 2011. And some of the links on the data and R code tabs
> are broken.
> 
>  ? Have there been additions or changes to the book since then? Is this 
> still
> an active project?
> 
>  ? I'm finding this a great addition to Goovaert's book which I read a long
> time ago and still reference.
> 
> Rich
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r@hep@rd @ending from @ppl-eco@y@@com  Fri Aug 31 15:14:48 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Fri, 31 Aug 2018 06:14:48 -0700 (PDT)
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
In-Reply-To: <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>
References: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
 <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>
Message-ID: <alpine.LNX.2.20.1808310558590.29881@salmo.appl-ecosys.com>

On Fri, 31 Aug 2018, Tomislav Hengl wrote:

> I am working on a rmarkdown update of the practical guide to GM (the
> working title is "A practical guide to spatial prediction with R"). As
> soon as I clean up these reports on my desk I will get on it (in about 2
> months should be online). My apologies to you and all other users for
> untidy website / my tardiness.

Tom,

   This is excellent news!

   I sent you a message yesterday at the e-mail address on the web site only
to have it bounce as 'user known in this domain.'

> In the meantime you might also find this useful:
> https://envirometrix.github.io/PredictiveSoilMapping/

   Thank you.

   I don't know if r-sig-geo is an appropriate forum for my questions that
are not specific to applying R packages, but to geostatistics themselves. If
not, I'd appreciate a pointer to a more appropriate place.

   One thing I've noticed in my readings about geostatistics is that (quite
appropriately) most are research oriented and written by academic
geostatisticians and ecologists. My work as an environmental science
consultant, an applied aqutic ecologist who left academia for the private
sector several decades ago, means that all data available to me are
generated by regulatory requirements, not by the needs for a research
project. And, the overwhelming number involve aquatic chemistry (and biota
such as fish) which adds the constant movement of the medium into
consideration.

   This makes it difficult for me to translate examples such as the Meuse
example in Chapter 5 to my projects. Currently I'm looking at mercury
concentrations in a river system and the sampling locations have an
intereesting pattern of clumps on the mainstem by major tributaries and are
otherwise quite dispersed. As a non-mathemtical statistician I've currently
no idea how to conduct exploratory analyses on such data. And, there's the
temporal aspct to be considered, too.

   I've much to learn because there's a real need for the application of
spatio-temporal statistics in regulatory environmental science instead of
the deterministic, differential equation models currently demanded by
regulators.

Best regards,

Rich


From r@hep@rd @ending from @ppl-eco@y@@com  Fri Aug 31 17:02:50 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Fri, 31 Aug 2018 08:02:50 -0700 (PDT)
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
In-Reply-To: <alpine.LNX.2.20.1808310558590.29881@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
 <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>
 <alpine.LNX.2.20.1808310558590.29881@salmo.appl-ecosys.com>
Message-ID: <alpine.LNX.2.20.1808310758390.29881@salmo.appl-ecosys.com>

On Fri, 31 Aug 2018, Rich Shepard wrote:

> My work as an environmental science consultant, ... means that all data
> available to me are generated by regulatory requirements, not by the needs
> for a research project. And, the overwhelming number involve aquatic
> chemistry (and biota such as fish) which adds the constant movement of the
> medium into consideration.

   I did two web searches this morning, one for 'aquatic geochemistry' the
other for 'water quality geochemistry'. They both returned many hits on
soils and ground waters, but only two related to surface waters.

   There is a need to improve on this.

   If anyone knows of documentation relevant to surface water quality,
particularly flowing waters, please point me to them.

Regards,

Rich


From @@r@h@go@lee @ending from gm@il@com  Fri Aug 31 18:12:13 2018
From: @@r@h@go@lee @ending from gm@il@com (Sarah Goslee)
Date: Fri, 31 Aug 2018 12:12:13 -0400
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
In-Reply-To: <alpine.LNX.2.20.1808310758390.29881@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
 <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>
 <alpine.LNX.2.20.1808310558590.29881@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808310758390.29881@salmo.appl-ecosys.com>
Message-ID: <CAM_vjukM=xSB4vaHW6+rgQYqrPPSUtMrrH3+ym5sBRMTwame=Q@mail.gmail.com>

Assuming you're looking for relevant R information, it seems like
packages such as EGRET, dbhydroR, waterData, and RSAlgaeR are
potentially relevant. My lab uses R extensively, including EGRET and
in-house code.

There's a lot of information out there, including case studies:

Try a search for water quality on the incredibly useful rseek.org

Most research uses the same data sources you bemoan - we sometimes
have our own data, but largely rely on USGS etc.

Sarah

On Fri, Aug 31, 2018 at 11:03 AM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> On Fri, 31 Aug 2018, Rich Shepard wrote:
>
> > My work as an environmental science consultant, ... means that all data
> > available to me are generated by regulatory requirements, not by the needs
> > for a research project. And, the overwhelming number involve aquatic
> > chemistry (and biota such as fish) which adds the constant movement of the
> > medium into consideration.
>
>    I did two web searches this morning, one for 'aquatic geochemistry' the
> other for 'water quality geochemistry'. They both returned many hits on
> soils and ground waters, but only two related to surface waters.
>
>    There is a need to improve on this.
>
>    If anyone knows of documentation relevant to surface water quality,
> particularly flowing waters, please point me to them.
>
> Regards,
>
> Rich
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Sarah Goslee
http://www.functionaldiversity.org


From r@hep@rd @ending from @ppl-eco@y@@com  Fri Aug 31 18:16:06 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Fri, 31 Aug 2018 09:16:06 -0700 (PDT)
Subject: [R-sig-Geo] A practical guide to geostatistical mapping
In-Reply-To: <CAM_vjukM=xSB4vaHW6+rgQYqrPPSUtMrrH3+ym5sBRMTwame=Q@mail.gmail.com>
References: <alpine.LNX.2.20.1808301339330.18905@salmo.appl-ecosys.com>
 <30a297c9-121d-ce0a-2e18-9e3f4bfb840a@gmail.com>
 <alpine.LNX.2.20.1808310558590.29881@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1808310758390.29881@salmo.appl-ecosys.com>
 <CAM_vjukM=xSB4vaHW6+rgQYqrPPSUtMrrH3+ym5sBRMTwame=Q@mail.gmail.com>
Message-ID: <alpine.LNX.2.20.1808310914340.29881@salmo.appl-ecosys.com>

On Fri, 31 Aug 2018, Sarah Goslee wrote:

> Assuming you're looking for relevant R information, it seems like packages
> such as EGRET, dbhydroR, waterData, and RSAlgaeR are potentially relevant.
> My lab uses R extensively, including EGRET and in-house code.
>
> There's a lot of information out there, including case studies:
> Try a search for water quality on the incredibly useful rseek.org
>
> Most research uses the same data sources you bemoan - we sometimes have
> our own data, but largely rely on USGS etc.

Sarah,

   Thanks very much for the pointers!

   Good thing there's a long weekend coming: I have a lot of R reading to do
in addition to other put-off tasks. :-)

Best regards,

Rich


