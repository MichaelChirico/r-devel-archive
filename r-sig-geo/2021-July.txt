From r@m@n@m|@hr@10 @end|ng |rom gm@||@com  Sat Jul  3 14:27:24 2021
From: r@m@n@m|@hr@10 @end|ng |rom gm@||@com (Raman Mishra)
Date: Sat, 3 Jul 2021 17:57:24 +0530
Subject: [R-sig-Geo] Reverse the legend
Message-ID: <CAGmiv2+T5ACXQ0=CJNYvRAU9BsQe6xWxv=4k8RJ==07tQuKvGQ@mail.gmail.com>

Dear All,
I am using tmap package to create maps. I want to reverse the order of
legend in my polygon map. I tried tm_fill(legend.reverse=T) but it is
not working.
Please provide a solution for this.
Thanks,

	[[alternative HTML version deleted]]


From m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt  Sat Jul  3 19:11:54 2021
From: m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt (mr)
Date: Sat, 3 Jul 2021 18:11:54 +0100
Subject: [R-sig-Geo] Gwmodel an spgwr return too different local
 coefficients?
Message-ID: <mailman.28699.2.1625332935.1337.r-sig-geo@r-project.org>

Dear all, 
I am using spgwr::ggwr() and GWmodel::ggwr.basic to fit a generalized geographically weighted regression with Poisson model and log-link function.
Local coefficients between packages are very different, but i couldn't find out why. If any body can point me what am i missing, i apreciate a lot.

Below is an example using spData::nc.sids.  I would expect local coefficents will be around the observed mean, but this doesnt occur using the GWmodel::ggwr.basic function:

library (spData)
library(GWmodel)
library(spgwr)
library(sp)

data(nc.sids)
nc.sids$SID79 <- nc.sids$SID79 + 1 
# formula of glm poisson model
f1 <- SID79 ~ offset(log(BIR79))

# GWmodel
sp::coordinates(nc.sids) <- ~ x + y
dM <- gw.dist(dp.locat = coordinates(nc.sids))
bw_gw <- bw.ggwr(formula(f1), nc.sids, family ="poisson", approach="AIC",
                  kernel="gaussian", adaptive = T, p = 2, theta = 0, longlat=F, dMat = dM)
m_gw <- ggwr.basic(formula(f1), data = nc.sids, 
                    regression.points = nc.sids, bw = bw_gw, 
                    family = "poisson", kernel = "gaussian", 
                    adaptive = T, cv = F, tol = 1e-5, 
                    maxiter = 1000, dMat = dM)

# spgwr
dfsids <- as.data.frame(nc.sids)
xycoord <- cbind(dfsids$x,dfsids$y)
bw_sp <- ggwr.sel(formula(f1), data = dfsids , family = poisson(link = "log"), 
                   gweight = gwr.Gauss, adapt = T, coords = xycoord, 
                   tol = 1e-5 , verbose = T) 
m_sp <- ggwr(formula(f1), data = dfsids, gweight = gwr.Gauss,
             adapt = bw_sp, family = poisson(link="log"),  
             type="working", coords = xycoord) 

# compare results
obs <- mean(log(nc.sids$SID79 / nc.sids$BIR79))
gw <- mean(m_gw$SDF$Intercept)
sp <- mean(m_sp$SDF$X.Intercept.)

cbind(obs, sp, gw)

Sent from Mail for Windows 10


	[[alternative HTML version deleted]]


From yud @end|ng |rom m@||@montc|@|r@edu  Sun Jul  4 07:35:16 2021
From: yud @end|ng |rom m@||@montc|@|r@edu (Danlin Yu)
Date: Sun, 4 Jul 2021 01:35:16 -0400
Subject: [R-sig-Geo] Gwmodel an spgwr return too different local
 coefficients?
In-Reply-To: <20210703171215.D9EB62E5@hypatia.math.ethz.ch>
References: <20210703171215.D9EB62E5@hypatia.math.ethz.ch>
Message-ID: <055b1d12-a21f-6793-cc21-c142b3bb43b4@mail.montclair.edu>

Hi,

Have you checked the bandwidth vector between the two packages (bw_gw 
and bw_sp)? If these two are different then the estimated coefficients 
will be different, too.

Hope this helps.

Danlin

On 2021/7/3 13:11, mr via R-sig-Geo wrote:
> Dear all,
> I am using spgwr::ggwr() and GWmodel::ggwr.basic to fit a generalized geographically weighted regression with Poisson model and log-link function.
> Local coefficients between packages are very different, but i couldn't find out why. If any body can point me what am i missing, i apreciate a lot.
>
> Below is an example using spData::nc.sids.  I would expect local coefficents will be around the observed mean, but this doesnt occur using the GWmodel::ggwr.basic function:
>
> library (spData)
> library(GWmodel)
> library(spgwr)
> library(sp)
>
> data(nc.sids)
> nc.sids$SID79 <- nc.sids$SID79 + 1
> # formula of glm poisson model
> f1 <- SID79 ~ offset(log(BIR79))
>
> # GWmodel
> sp::coordinates(nc.sids) <- ~ x + y
> dM <- gw.dist(dp.locat = coordinates(nc.sids))
> bw_gw <- bw.ggwr(formula(f1), nc.sids, family ="poisson", approach="AIC",
>                    kernel="gaussian", adaptive = T, p = 2, theta = 0, longlat=F, dMat = dM)
> m_gw <- ggwr.basic(formula(f1), data = nc.sids,
>                      regression.points = nc.sids, bw = bw_gw,
>                      family = "poisson", kernel = "gaussian",
>                      adaptive = T, cv = F, tol = 1e-5,
>                      maxiter = 1000, dMat = dM)
>
> # spgwr
> dfsids <- as.data.frame(nc.sids)
> xycoord <- cbind(dfsids$x,dfsids$y)
> bw_sp <- ggwr.sel(formula(f1), data = dfsids , family = poisson(link = "log"),
>                     gweight = gwr.Gauss, adapt = T, coords = xycoord,
>                     tol = 1e-5 , verbose = T)
> m_sp <- ggwr(formula(f1), data = dfsids, gweight = gwr.Gauss,
>               adapt = bw_sp, family = poisson(link="log"),
>               type="working", coords = xycoord)
>
> # compare results
> obs <- mean(log(nc.sids$SID79 / nc.sids$BIR79))
> gw <- mean(m_gw$SDF$Intercept)
> sp <- mean(m_sp$SDF$X.Intercept.)
>
> cbind(obs, sp, gw)
>
> Sent from Mail for Windows 10
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
___________________________________________
Danlin Yu, Ph.D.
Professor of GIS and Urban Geography
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
Office: CELS 314
Email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu


From bi@bi@iu m@iii@g oii whu@edu@c@  Sun Jul  4 10:23:49 2021
From: bi@bi@iu m@iii@g oii whu@edu@c@ (bi@bi@iu m@iii@g oii whu@edu@c@)
Date: Sun, 4 Jul 2021 16:23:49 +0800
Subject: [R-sig-Geo] Gwmodel an spgwr return too different local
 coefficients?
References: <20210703171216.559801298@hypatia.math.ethz.ch>
Message-ID: <202107041623476292723@whu.edu.cn>

Hi,

In GWmodel, we didn't process the offset term, and that's why the results are very different from each other.

Moreover, the bandwidths for them are also different, but this won't cause a big difference.

Cheers,
Binbin



binbinlu at whu.edu.cn
 
From: mr via R-sig-Geo
Date: 2021-07-04 01:11
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Gwmodel an spgwr return too different local coefficients?
Dear all, 
I am using spgwr::ggwr() and GWmodel::ggwr.basic to fit a generalized geographically weighted regression with Poisson model and log-link function.
Local coefficients between packages are very different, but i couldn't find out why. If any body can point me what am i missing, i apreciate a lot.
 
Below is an example using spData::nc.sids.  I would expect local coefficents will be around the observed mean, but this doesnt occur using the GWmodel::ggwr.basic function:
 
library (spData)
library(GWmodel)
library(spgwr)
library(sp)
 
data(nc.sids)
nc.sids$SID79 <- nc.sids$SID79 + 1 
# formula of glm poisson model
f1 <- SID79 ~ offset(log(BIR79))
 
# GWmodel
sp::coordinates(nc.sids) <- ~ x + y
dM <- gw.dist(dp.locat = coordinates(nc.sids))
bw_gw <- bw.ggwr(formula(f1), nc.sids, family ="poisson", approach="AIC",
                  kernel="gaussian", adaptive = T, p = 2, theta = 0, longlat=F, dMat = dM)
m_gw <- ggwr.basic(formula(f1), data = nc.sids, 
                    regression.points = nc.sids, bw = bw_gw, 
                    family = "poisson", kernel = "gaussian", 
                    adaptive = T, cv = F, tol = 1e-5, 
                    maxiter = 1000, dMat = dM)
 
# spgwr
dfsids <- as.data.frame(nc.sids)
xycoord <- cbind(dfsids$x,dfsids$y)
bw_sp <- ggwr.sel(formula(f1), data = dfsids , family = poisson(link = "log"), 
                   gweight = gwr.Gauss, adapt = T, coords = xycoord, 
                   tol = 1e-5 , verbose = T) 
m_sp <- ggwr(formula(f1), data = dfsids, gweight = gwr.Gauss,
             adapt = bw_sp, family = poisson(link="log"),  
             type="working", coords = xycoord) 
 
# compare results
obs <- mean(log(nc.sids$SID79 / nc.sids$BIR79))
gw <- mean(m_gw$SDF$Intercept)
sp <- mean(m_sp$SDF$X.Intercept.)
 
cbind(obs, sp, gw)
 
Sent from Mail for Windows 10
 
 
[[alternative HTML version deleted]]
 
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt  Mon Jul  5 15:58:10 2021
From: m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt (mr)
Date: Mon, 5 Jul 2021 14:58:10 +0100
Subject: [R-sig-Geo] Gwmodel an spgwr return too different local
 coefficients?
In-Reply-To: <202107041623476292723@whu.edu.cn>
References: <20210703171216.559801298@hypatia.math.ethz.ch>
 <202107041623476292723@whu.edu.cn>
Message-ID: <mailman.28702.3.1625494714.1337.r-sig-geo@r-project.org>

Ok, thank you for your comments.
Regards, Manuel

Sent from Mail for Windows 10

From: binbinlu at whu.edu.cn
Sent: 4 de julho de 2021 09:24
To: mr; r-sig-geo
Subject: Re: [R-sig-Geo] Gwmodel an spgwr return too different local coefficients?

Hi,

In GWmodel, we didn't process the offset term, and that's why the results are very different from each other.

Moreover, the bandwidths for them are also different, but this won't cause a big difference.

Cheers,
Binbin


binbinlu at whu.edu.cn
?
From:?mr via R-sig-Geo
Date:?2021-07-04?01:11
To:?r-sig-geo at r-project.org
Subject:?[R-sig-Geo] Gwmodel an spgwr return too different local coefficients?
Dear all, 
I am using spgwr::ggwr() and GWmodel::ggwr.basic to fit a generalized geographically weighted regression with Poisson model and log-link function.
Local coefficients between packages are very different, but i couldn't find out why. If any body can point me what am i missing, i apreciate a lot.
?
Below is an example using spData::nc.sids.? I would expect local coefficents will be around the observed mean, but this doesnt occur using the GWmodel::ggwr.basic function:
?
library (spData)
library(GWmodel)
library(spgwr)
library(sp)
?
data(nc.sids)
nc.sids$SID79 <- nc.sids$SID79 + 1 
# formula of glm poisson model
f1 <- SID79 ~ offset(log(BIR79))
?
# GWmodel
sp::coordinates(nc.sids) <- ~ x + y
dM <- gw.dist(dp.locat = coordinates(nc.sids))
bw_gw <- bw.ggwr(formula(f1), nc.sids, family ="poisson", approach="AIC",
????????????????? kernel="gaussian", adaptive = T, p = 2, theta = 0, longlat=F, dMat = dM)
m_gw <- ggwr.basic(formula(f1), data = nc.sids, 
??????????????????? regression.points = nc.sids, bw = bw_gw, 
??????????????????? family = "poisson", kernel = "gaussian", 
??????????????????? adaptive = T, cv = F, tol = 1e-5, 
??????????????????? maxiter = 1000, dMat = dM)
?
# spgwr
dfsids <- as.data.frame(nc.sids)
xycoord <- cbind(dfsids$x,dfsids$y)
bw_sp <- ggwr.sel(formula(f1), data = dfsids , family = poisson(link = "log"), 
?????????????????? gweight = gwr.Gauss, adapt = T, coords = xycoord, 
?????????????????? tol = 1e-5 , verbose = T) 
m_sp <- ggwr(formula(f1), data = dfsids, gweight = gwr.Gauss,
???????????? adapt = bw_sp, family = poisson(link="log"),? 
???????????? type="working", coords = xycoord) 
?
# compare results
obs <- mean(log(nc.sids$SID79 / nc.sids$BIR79))
gw <- mean(m_gw$SDF$Intercept)
sp <- mean(m_sp$SDF$X.Intercept.)
?
cbind(obs, sp, gw)
?
Sent from Mail for Windows 10
?
?
[[alternative HTML version deleted]]
?
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210705/52b24ead/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 44B618F6EBBA4A9787CC8D4514D9167B.png
Type: image/png
Size: 129 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210705/52b24ead/attachment.png>

From @bo @end|ng |rom e|r|ck@de  Mon Jul  5 22:14:01 2021
From: @bo @end|ng |rom e|r|ck@de (Tim Elrick)
Date: Mon, 5 Jul 2021 22:14:01 +0200
Subject: [R-sig-Geo] How to project a SpatExtent object?
Message-ID: <e219561e-d0b3-04e2-4d22-fa348394fe1c@elrick.de>

Hi all,

Does anyone know how to (re-)project a SpatExtent object from the terra 
package?

project() only works on SpatVector or SpatRaster, but vect() doesn't 
work on a SpatExtent either to convert a SpatExtent to a SpatVector.

Thanks,

Tim


From md@umner @end|ng |rom gm@||@com  Tue Jul  6 02:00:18 2021
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Tue, 6 Jul 2021 10:00:18 +1000
Subject: [R-sig-Geo] How to project a SpatExtent object?
In-Reply-To: <e219561e-d0b3-04e2-4d22-fa348394fe1c@elrick.de>
References: <e219561e-d0b3-04e2-4d22-fa348394fe1c@elrick.de>
Message-ID: <CAAcGz98VZ3F=WEyJLufmAMunatitx4u+EMz7REPMFz=2bTD3jw@mail.gmail.com>

I think you can project the empty rast() object, using the same idiom as
{raster} to create an empty version:

 f <- system.file("ex/elev.tif", package="terra", mustWork = TRUE)
 r <- rast(f)
terra::project(terra::rast(r), "+proj=laea")

that seems analogous to what raster::projectExtent does.

HTH, Mike



On Tue, Jul 6, 2021 at 6:14 AM Tim Elrick <abo at elrick.de> wrote:

> Hi all,
>
> Does anyone know how to (re-)project a SpatExtent object from the terra
> package?
>
> project() only works on SpatVector or SpatRaster, but vect() doesn't
> work on a SpatExtent either to convert a SpatExtent to a SpatVector.
>
> Thanks,
>
> Tim
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


From ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@  Tue Jul  6 15:29:51 2021
From: ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@ (Julian M. Burgos)
Date: Tue, 06 Jul 2021 13:29:51 +0000
Subject: [R-sig-Geo] Issue with st_warp, gdal and NAs
Message-ID: <xgz1r8ba7u8.fsf@hafogvatn.is>

Dear list,

I am having a bit of trouble using st_warp() to aggregate star objects with the option "use_gdal = TRUE".  I am using the "average" method, and I want cells with NA values to be ignored.  To demonstrate, I will make a small raster for testing, and will include cells with NA values:

#-------------------------------------------------
  
library(raster)

# Create raster for testing
myfile <- "~/myraster.tif"
myraster <- raster(xmn = 0, ymn = 0, xmx = 10, ymx = 10, resolution = 0.1,
                   crs = 4326, vals = sample(1:20, size = 10000, replace = TRUE))
myraster[sample(1:10000, 200)] <- NA
writeRaster(myraster, filename = myfile, overwrite = TRUE)

#-------------------------------------------------

With the raster package, I can aggergate the cells ignoring the NA values like this:


r1 <- raster(myfile)
ag1 <- raster::aggregate(x = raster(myfile), fact = 10,
                         fun = mean, na.rm = TRUE)

...which is what I want.  I can also aggregate the cells including the NAs, like this:
                                                                                   
ag2 <- raster::aggregate(x = raster(myfile), fact = 10,
                         fun = mean, na.rm = FALSE)

.... which produces a raster with a lots of gaps.  Now, to do a similar aggregation with the stars package I can do this:

s1 <-  read_stars(myfile)

ag3 <- st_warp(src = s1,
              dest = st_as_stars(st_bbox(s1), dx = 1, dy = 1),
              use_gdal = TRUE,
              method = "average")

The resulting raster (ag3) has gaps like ag2, which means that the NAs are not being ignored when computing the averages.  With use_gdal_TRUE and method="average" we are using gdalwarp with the average resampling method, which according to the documentation "computes the weighted average of all non-NODATA contributing pixels.".  So I guess the problem is that the NAs are not being recognized as NODATA pixels.

Does anybody know how to solve this?

Many thanks,

Julian
 


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnun, ranns?kna- og r??gjafarstofnun hafs og vatna/
Marine and Freshwater Research Institute
Botnsj?varsvi?s / Demersal Division
  Fornub??ir 5, IS-220 Hafnarfj?r?ur, Iceland
www.hafogvatn.is
S?mi/Telephone : +354-5752037
Netfang/Email: julian.burgos at hafogvatn.is


From @bo @end|ng |rom e|r|ck@de  Tue Jul  6 17:47:10 2021
From: @bo @end|ng |rom e|r|ck@de (Tim Elrick)
Date: Tue, 6 Jul 2021 17:47:10 +0200
Subject: [R-sig-Geo] How to project a SpatExtent object?
In-Reply-To: <CAAcGz98VZ3F=WEyJLufmAMunatitx4u+EMz7REPMFz=2bTD3jw@mail.gmail.com>
References: <e219561e-d0b3-04e2-4d22-fa348394fe1c@elrick.de>
 <CAAcGz98VZ3F=WEyJLufmAMunatitx4u+EMz7REPMFz=2bTD3jw@mail.gmail.com>
Message-ID: <ff05ccab-e119-7faa-7d63-00dab34ae081@elrick.de>

Hi Mike,

Thanks. Your code didn't take into account that I was interested in 
SpatExtent instead of SpatRaster. So, I modified the code:

library(terra)
f <- system.file("ex/elev.tif", package="terra", mustWork = TRUE)
f
r <- rast(f)

e <- ext(c(6.0, 6.2, 49.7, 49.8))
plot(r, ext = e)

r2 <- project(r, "+proj=utm +zone=31")
r2
# the following is the line that re-projects the SpatExtent
e2 <- ext(project(rast(e, crs = crs(r)), "+proj=utm +zone=31"))
plot(r2, ext = e2)

 From the example it is difficult to judge if it worked out (as I am not 
too familiar with the DEM of the example). When I try to apply it my 
case (reprojecting a SpatExtent from UTM zone 18N to WGS84), this code 
doesn't work. The resulting extent will select the whole raster image 
instead of the previously defined extent. Due to the large file sizes, I 
cannot offer a reproducible example based on my data unfortunately. I 
will look into it further and try to understand, why it doesn't work.

Thanks anyway,
Tim

On 2021-07-06 02:00, Michael Sumner wrote:
I think you can project the empty rast() object, using the same idiom as

{raster} to create an empty version:

   f <- system.file("ex/elev.tif", package="terra", mustWork = TRUE)
   r <- rast(f)
terra::project(terra::rast(r), "+proj=laea")

that seems analogous to what raster::projectExtent does.

HTH, Mike



On Tue, Jul 6, 2021 at 6:14 AM Tim Elrick <abo at elrick.de
<mailto:abo at elrick.de>> wrote:

     Hi all,

     Does anyone know how to (re-)project a SpatExtent object from the terra
     package?

     project() only works on SpatVector or SpatRaster, but vect() doesn't
     work on a SpatExtent either to convert a SpatExtent to a SpatVector.

     Thanks,

     Tim

     _______________________________________________
     R-sig-Geo mailing list
     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>



-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>


From r|@@|d@nh@ @end|ng |rom gm@||@com  Wed Jul  7 23:09:50 2021
From: r|@@|d@nh@ @end|ng |rom gm@||@com (Raphael Saldanha)
Date: Wed, 7 Jul 2021 18:09:50 -0300
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
Message-ID: <6D5B8D0A-9997-4306-BAE2-F632C4CE3009@gmail.com>

Hello all!

Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R Shiny app for Spatial Econometric classes. The app is called Tobler and currently offers some tests and estimation of cross-section and panel models.

The app is hosted at shinyapps: https://rfsaldanha.shinyapps.io/tobler/ 

The code is open at GitHub: https://github.com/rfsaldanha/tobler 

All suggestions are welcome!


Best regards,

Raphael Saldanha
Funda??o Oswaldo Cruz - Brazil
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4908 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210707/2d413a11/attachment.p7s>

From r@turner @end|ng |rom @uck|@nd@@c@nz  Thu Jul  8 04:20:08 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Thu, 8 Jul 2021 14:20:08 +1200
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <6D5B8D0A-9997-4306-BAE2-F632C4CE3009@gmail.com>
References: <6D5B8D0A-9997-4306-BAE2-F632C4CE3009@gmail.com>
Message-ID: <20210708142008.5738ef1a@rolf-Latitude-E7470>


On Wed, 7 Jul 2021 18:09:50 -0300
Raphael Saldanha <rfsaldanha at gmail.com> wrote:

> Hello all!
> 
> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
> Shiny app for Spatial Econometric classes. 

<SNIP>

I hope that you won't find this comment offensive, but I could not
resist sending it to you, since I am rather fanatical (pedantic?) about
correct English usage.

The expression "Me and Professor Eduardo Almeida" is both (a) bad
grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative or
objective case) you should use "I" (nominative or subjective case), since
this expression is the subject of the sentence.  (b) It is "bad form"
(it sounds vaguely self-promoting)  to put a first person pronoun before the
names of others to which it is linked.  You should say "Professor
Eduardo Almeida and I are creating ....".

I realise that English is surely a second language for you, and your
English is infinitely better than my non-existent Portuguese.  Your
English is actually quite good, probably better than that of many
native English speakers.  Nevertheless the expression that you use is
not correct and you should strive to avoid such usage.

Again let me express the hope that you won't take offence at this
comment.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From r|@@|d@nh@ @end|ng |rom gm@||@com  Thu Jul  8 12:32:35 2021
From: r|@@|d@nh@ @end|ng |rom gm@||@com (Raphael Saldanha)
Date: Thu, 8 Jul 2021 07:32:35 -0300
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <20210708142008.5738ef1a@rolf-Latitude-E7470>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
Message-ID: <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>

No offense taken. Thanks for the remark and opportunity to learn.


Cheers,

Raphael 

> Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz> escreveu:
> 
> ?
>> On Wed, 7 Jul 2021 18:09:50 -0300
>> Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>> 
>> Hello all!
>> 
>> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>> Shiny app for Spatial Econometric classes. 
> 
> <SNIP>
> 
> I hope that you won't find this comment offensive, but I could not
> resist sending it to you, since I am rather fanatical (pedantic?) about
> correct English usage.
> 
> The expression "Me and Professor Eduardo Almeida" is both (a) bad
> grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative or
> objective case) you should use "I" (nominative or subjective case), since
> this expression is the subject of the sentence.  (b) It is "bad form"
> (it sounds vaguely self-promoting)  to put a first person pronoun before the
> names of others to which it is linked.  You should say "Professor
> Eduardo Almeida and I are creating ....".
> 
> I realise that English is surely a second language for you, and your
> English is infinitely better than my non-existent Portuguese.  Your
> English is actually quite good, probably better than that of many
> native English speakers.  Nevertheless the expression that you use is
> not correct and you should strive to avoid such usage.
> 
> Again let me express the hope that you won't take offence at this
> comment.
> 
> cheers,
> 
> Rolf Turner
> 
> -- 
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Thu Jul  8 13:45:42 2021
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Thu, 8 Jul 2021 06:45:42 -0500
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
 <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
Message-ID: <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>

Estimado Raphael:


	  I don't know any Portuguese either, and I'm very grateful that you've 
made the effort to ask this group in a language not your own.


	  In primary school, I learned that constructions like, "Me and 
Professor ..." too often sounded like, "Mean Professor ...".


	  Un fuerte abrazo ("A big hug", as a Uruguayan man whom I had not 
previously met ended a letter inviting me to talk at a conference).


	  Spencer Graves


On 7/8/21 5:32 AM, Raphael Saldanha wrote:
> No offense taken. Thanks for the remark and opportunity to learn.
> 
> 
> Cheers,
> 
> Raphael
> 
>> Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz> escreveu:
>>
>> ?
>>> On Wed, 7 Jul 2021 18:09:50 -0300
>>> Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>>>
>>> Hello all!
>>>
>>> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>>> Shiny app for Spatial Econometric classes.
>>
>> <SNIP>
>>
>> I hope that you won't find this comment offensive, but I could not
>> resist sending it to you, since I am rather fanatical (pedantic?) about
>> correct English usage.
>>
>> The expression "Me and Professor Eduardo Almeida" is both (a) bad
>> grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative or
>> objective case) you should use "I" (nominative or subjective case), since
>> this expression is the subject of the sentence.  (b) It is "bad form"
>> (it sounds vaguely self-promoting)  to put a first person pronoun before the
>> names of others to which it is linked.  You should say "Professor
>> Eduardo Almeida and I are creating ....".
>>
>> I realise that English is surely a second language for you, and your
>> English is infinitely better than my non-existent Portuguese.  Your
>> English is actually quite good, probably better than that of many
>> native English speakers.  Nevertheless the expression that you use is
>> not correct and you should strive to avoid such usage.
>>
>> Again let me express the hope that you won't take offence at this
>> comment.
>>
>> cheers,
>>
>> Rolf Turner
>>
>> -- 
>> Honorary Research Fellow
>> Department of Statistics
>> University of Auckland
>> Phone: +64-9-373-7599 ext. 88276
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r|@@|d@nh@ @end|ng |rom gm@||@com  Thu Jul  8 15:00:48 2021
From: r|@@|d@nh@ @end|ng |rom gm@||@com (Raphael Saldanha)
Date: Thu, 8 Jul 2021 10:00:48 -0300
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
 <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
 <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>
Message-ID: <0A32F3A1-0B40-4C41-A9F9-3CE1BE73CF7F@gmail.com>

Estimado Spencer,

Thanks for your kind words. Actually, that construction is not standard in Portuguese also (although that does not sound pedant or with some bad intention for our ears). I revised the text three times and used an app for grammar correction before sending. Anyway, it was a mistake by all means. 

To learn Spatial Econometrics and other fields require from us additional efforts. There is just a few books or materials in Portuguese. But I try to approach this difficult as an opportunity to learn.

Indeed, one of the reasons for building the app was to facilitate the use of the methods for people that are learning R. *Professor Eduardo and I* teach annually a course on that field and we face this challenge. With the pandemics and Zoom classes, we hope that the app and our scripts will help the students to learn R.


Um forte abra?o,

Raphael Saldanha

> Em 8 de jul. de 2021, ?(s) 08:45, Spencer Graves <spencer.graves at prodsyse.com> escreveu:
> 
> Estimado Raphael:
> 
> 
> 	  I don't know any Portuguese either, and I'm very grateful that you've made the effort to ask this group in a language not your own.
> 
> 
> 	  In primary school, I learned that constructions like, "Me and Professor ..." too often sounded like, "Mean Professor ...".
> 
> 
> 	  Un fuerte abrazo ("A big hug", as a Uruguayan man whom I had not previously met ended a letter inviting me to talk at a conference).
> 
> 
> 	  Spencer Graves
> 
> 
> On 7/8/21 5:32 AM, Raphael Saldanha wrote:
>> No offense taken. Thanks for the remark and opportunity to learn.
>> Cheers,
>> Raphael
>>> Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz> escreveu:
>>> 
>>> ?
>>>> On Wed, 7 Jul 2021 18:09:50 -0300
>>>> Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>>>> 
>>>> Hello all!
>>>> 
>>>> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>>>> Shiny app for Spatial Econometric classes.
>>> 
>>> <SNIP>
>>> 
>>> I hope that you won't find this comment offensive, but I could not
>>> resist sending it to you, since I am rather fanatical (pedantic?) about
>>> correct English usage.
>>> 
>>> The expression "Me and Professor Eduardo Almeida" is both (a) bad
>>> grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative or
>>> objective case) you should use "I" (nominative or subjective case), since
>>> this expression is the subject of the sentence.  (b) It is "bad form"
>>> (it sounds vaguely self-promoting)  to put a first person pronoun before the
>>> names of others to which it is linked.  You should say "Professor
>>> Eduardo Almeida and I are creating ....".
>>> 
>>> I realise that English is surely a second language for you, and your
>>> English is infinitely better than my non-existent Portuguese.  Your
>>> English is actually quite good, probably better than that of many
>>> native English speakers.  Nevertheless the expression that you use is
>>> not correct and you should strive to avoid such usage.
>>> 
>>> Again let me express the hope that you won't take offence at this
>>> comment.
>>> 
>>> cheers,
>>> 
>>> Rolf Turner
>>> 
>>> -- 
>>> Honorary Research Fellow
>>> Department of Statistics
>>> University of Auckland
>>> Phone: +64-9-373-7599 ext. 88276
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4908 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210708/e8a99ebb/attachment.p7s>

From Roger@B|v@nd @end|ng |rom nhh@no  Fri Jul  9 16:30:14 2021
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 9 Jul 2021 16:30:14 +0200
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <0A32F3A1-0B40-4C41-A9F9-3CE1BE73CF7F@gmail.com>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
 <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
 <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>
 <0A32F3A1-0B40-4C41-A9F9-3CE1BE73CF7F@gmail.com>
Message-ID: <878971ed-bceb-8a77-fef-8956e2313853@reclus2.nhh.no>

Returning to the "Tobler" shiny app:

The main serious weakness is the name and the approach. It is not and has 
never been the case that "Everything is related to everything else, but 
near things are more related than distant things." This is and has always 
been an oversimplification, disguising the underlying entitation/support 
problem. Are the units of observation appropriate for the scale of the 
unobserved spatial process?

Tobler (1970) https://doi.org/10.2307/143141 was published in the same SI 
as Olsson (1970) https://doi.org/10.2307/143140 (Olsson precedes Tobler), 
but Olsson does grasp the important point that spatial autocorrelation is 
not immanent in spatial phenomena, but often is engendered by 
inappropriate entitation, by omitted variables and/or inappropriate 
functional form. The key quote from Olsson is on p. 228:

"The existence of such autocorrelations makes it tempting to agree with 
Tobler (1970, 236 [my interpolation, the original refers to a conference 
paper]) that 'everything is related to everything else, but near things 
are more related than distant things.' On the other hand, the fact that 
the autocorrelations seem to hide systematic specification errors suggests 
that the elevation of this statement to the status of 'the first law of 
geography' is at best premature. At worst, the statement may represent the 
spatial variant of the post hoc fallacy, which would mean  that 
coinincidence has been mistaken for a causal relation."

The status of the "first law" is very similar to the belief that John Snow 
induced the cause of cholera as water-borne from a map. It may be a good 
way of selling GIS, but it isn't accurate; Snow had a strong working 
microbiological hypothesis prior to visiting Soho, and the map was 
prepared after the Broad street pump was disabled as documentation that 
the hypothesis held (see https://doi.org/10.1016/s0140-6736(00)02442-9 
Brody et al. 2000).

So the framing of the shiny app is unfortunate, and spatial econometrics 
is not a toolbox, rather a way of loooking at mis-specification when space 
is involved, I think.

Hope this isn't too critical,

Roger

On Thu, 8 Jul 2021, Raphael Saldanha wrote:

> Estimado Spencer,
>
> Thanks for your kind words. Actually, that construction is not standard 
> in Portuguese also (although that does not sound pedant or with some bad 
> intention for our ears). I revised the text three times and used an app 
> for grammar correction before sending. Anyway, it was a mistake by all 
> means.
>
> To learn Spatial Econometrics and other fields require from us 
> additional efforts. There is just a few books or materials in 
> Portuguese. But I try to approach this difficult as an opportunity to 
> learn.
>
> Indeed, one of the reasons for building the app was to facilitate the 
> use of the methods for people that are learning R. *Professor Eduardo 
> and I* teach annually a course on that field and we face this challenge. 
> With the pandemics and Zoom classes, we hope that the app and our 
> scripts will help the students to learn R.
>
>
> Um forte abra?o,
>
> Raphael Saldanha
>
>> Em 8 de jul. de 2021, ?(s) 08:45, Spencer Graves <spencer.graves at prodsyse.com> escreveu:
>>
>> Estimado Raphael:
>>
>>
>> 	  I don't know any Portuguese either, and I'm very grateful that you've made the effort to ask this group in a language not your own.
>>
>>
>> 	  In primary school, I learned that constructions like, "Me and Professor ..." too often sounded like, "Mean Professor ...".
>>
>>
>> 	  Un fuerte abrazo ("A big hug", as a Uruguayan man whom I had not previously met ended a letter inviting me to talk at a conference).
>>
>>
>> 	  Spencer Graves
>>
>>
>> On 7/8/21 5:32 AM, Raphael Saldanha wrote:
>>> No offense taken. Thanks for the remark and opportunity to learn.
>>> Cheers,
>>> Raphael
>>>> Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz> escreveu:
>>>>
>>>> ?
>>>>> On Wed, 7 Jul 2021 18:09:50 -0300
>>>>> Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>>>>>
>>>>> Hello all!
>>>>>
>>>>> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>>>>> Shiny app for Spatial Econometric classes.
>>>>
>>>> <SNIP>
>>>>
>>>> I hope that you won't find this comment offensive, but I could not
>>>> resist sending it to you, since I am rather fanatical (pedantic?) about
>>>> correct English usage.
>>>>
>>>> The expression "Me and Professor Eduardo Almeida" is both (a) bad
>>>> grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative or
>>>> objective case) you should use "I" (nominative or subjective case), since
>>>> this expression is the subject of the sentence.  (b) It is "bad form"
>>>> (it sounds vaguely self-promoting)  to put a first person pronoun before the
>>>> names of others to which it is linked.  You should say "Professor
>>>> Eduardo Almeida and I are creating ....".
>>>>
>>>> I realise that English is surely a second language for you, and your
>>>> English is infinitely better than my non-existent Portuguese.  Your
>>>> English is actually quite good, probably better than that of many
>>>> native English speakers.  Nevertheless the expression that you use is
>>>> not correct and you should strive to avoid such usage.
>>>>
>>>> Again let me express the hope that you won't take offence at this
>>>> comment.
>>>>
>>>> cheers,
>>>>
>>>> Rolf Turner
>>>>
>>>> --
>>>> Honorary Research Fellow
>>>> Department of Statistics
>>>> University of Auckland
>>>> Phone: +64-9-373-7599 ext. 88276
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jul 12 11:16:16 2021
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 12 Jul 2021 11:16:16 +0200
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <878971ed-bceb-8a77-fef-8956e2313853@reclus2.nhh.no>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
 <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
 <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>
 <0A32F3A1-0B40-4C41-A9F9-3CE1BE73CF7F@gmail.com>
 <878971ed-bceb-8a77-fef-8956e2313853@reclus2.nhh.no>
Message-ID: <5478436-d93a-89c0-827e-b63d925369e@reclus2.nhh.no>

Perhaps it is just my connection, but it is not possible to load any data, 
so I cannot evaluate the other components in practice.

I do however think that you need to acknowledge the results of Piras and 
Prucha, https://doi.org/10.1016/j.regsciurbeco.2014.03.002, and try to 
point out the dangers of pre-testing, rather than estimating the most 
inclusive model first, and simplifying from there.

Roger

On Fri, 9 Jul 2021, Roger Bivand wrote:

> Returning to the "Tobler" shiny app:
>
> The main serious weakness is the name and the approach. It is not and has 
> never been the case that "Everything is related to everything else, but near 
> things are more related than distant things." This is and has always been an 
> oversimplification, disguising the underlying entitation/support problem. Are 
> the units of observation appropriate for the scale of the unobserved spatial 
> process?
>
> Tobler (1970) https://doi.org/10.2307/143141 was published in the same SI as 
> Olsson (1970) https://doi.org/10.2307/143140 (Olsson precedes Tobler), but 
> Olsson does grasp the important point that spatial autocorrelation is not 
> immanent in spatial phenomena, but often is engendered by inappropriate 
> entitation, by omitted variables and/or inappropriate functional form. The 
> key quote from Olsson is on p. 228:
>
> "The existence of such autocorrelations makes it tempting to agree with 
> Tobler (1970, 236 [my interpolation, the original refers to a conference 
> paper]) that 'everything is related to everything else, but near things are 
> more related than distant things.' On the other hand, the fact that the 
> autocorrelations seem to hide systematic specification errors suggests that 
> the elevation of this statement to the status of 'the first law of geography' 
> is at best premature. At worst, the statement may represent the spatial 
> variant of the post hoc fallacy, which would mean  that coinincidence has 
> been mistaken for a causal relation."
>
> The status of the "first law" is very similar to the belief that John Snow 
> induced the cause of cholera as water-borne from a map. It may be a good way 
> of selling GIS, but it isn't accurate; Snow had a strong working 
> microbiological hypothesis prior to visiting Soho, and the map was prepared 
> after the Broad street pump was disabled as documentation that the hypothesis 
> held (see https://doi.org/10.1016/s0140-6736(00)02442-9 Brody et al. 2000).
>
> So the framing of the shiny app is unfortunate, and spatial econometrics is 
> not a toolbox, rather a way of loooking at mis-specification when space is 
> involved, I think.
>
> Hope this isn't too critical,
>
> Roger
>
> On Thu, 8 Jul 2021, Raphael Saldanha wrote:
>
>>  Estimado Spencer,
>>
>>  Thanks for your kind words. Actually, that construction is not standard in
>>  Portuguese also (although that does not sound pedant or with some bad
>>  intention for our ears). I revised the text three times and used an app
>>  for grammar correction before sending. Anyway, it was a mistake by all
>>  means.
>>
>>  To learn Spatial Econometrics and other fields require from us additional
>>  efforts. There is just a few books or materials in Portuguese. But I try
>>  to approach this difficult as an opportunity to learn.
>>
>>  Indeed, one of the reasons for building the app was to facilitate the use
>>  of the methods for people that are learning R. *Professor Eduardo and I*
>>  teach annually a course on that field and we face this challenge. With the
>>  pandemics and Zoom classes, we hope that the app and our scripts will help
>>  the students to learn R.
>> 
>>
>>  Um forte abra?o,
>>
>>  Raphael Saldanha
>>
>>>  Em 8 de jul. de 2021, ?(s) 08:45, Spencer Graves
>>>  <spencer.graves at prodsyse.com> escreveu:
>>>
>>>  Estimado Raphael:
>>> 
>>>
>>>     I don't know any Portuguese either, and I'm very grateful that you've
>>>     made the effort to ask this group in a language not your own.
>>> 
>>>
>>>     In primary school, I learned that constructions like, "Me and
>>>     Professor ..." too often sounded like, "Mean Professor ...".
>>> 
>>>
>>>     Un fuerte abrazo ("A big hug", as a Uruguayan man whom I had not
>>>     previously met ended a letter inviting me to talk at a conference).
>>> 
>>>
>>>     Spencer Graves
>>> 
>>>
>>>  On 7/8/21 5:32 AM, Raphael Saldanha wrote:
>>>>  No offense taken. Thanks for the remark and opportunity to learn.
>>>>  Cheers,
>>>>  Raphael
>>>>>  Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz>
>>>>>  escreveu:
>>>>>
>>>>>
>>>>>>  On Wed, 7 Jul 2021 18:09:50 -0300
>>>>>>  Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>>>>>>
>>>>>>  Hello all!
>>>>>>
>>>>>>  Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>>>>>>  Shiny app for Spatial Econometric classes.
>>>>>
>>>>>  <SNIP>
>>>>>
>>>>>  I hope that you won't find this comment offensive, but I could not
>>>>>  resist sending it to you, since I am rather fanatical (pedantic?) about
>>>>>  correct English usage.
>>>>>
>>>>>  The expression "Me and Professor Eduardo Almeida" is both (a) bad
>>>>>  grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative
>>>>>  or
>>>>>  objective case) you should use "I" (nominative or subjective case),
>>>>>  since
>>>>>  this expression is the subject of the sentence.  (b) It is "bad form"
>>>>>  (it sounds vaguely self-promoting)  to put a first person pronoun
>>>>>  before the
>>>>>  names of others to which it is linked.  You should say "Professor
>>>>>  Eduardo Almeida and I are creating ....".
>>>>>
>>>>>  I realise that English is surely a second language for you, and your
>>>>>  English is infinitely better than my non-existent Portuguese.  Your
>>>>>  English is actually quite good, probably better than that of many
>>>>>  native English speakers.  Nevertheless the expression that you use is
>>>>>  not correct and you should strive to avoid such usage.
>>>>>
>>>>>  Again let me express the hope that you won't take offence at this
>>>>>  comment.
>>>>>
>>>>>  cheers,
>>>>>
>>>>>  Rolf Turner
>>>>>
>>>>>  --
>>>>>  Honorary Research Fellow
>>>>>  Department of Statistics
>>>>>  University of Auckland
>>>>>  Phone: +64-9-373-7599 ext. 88276
>>>>>
>>>>>  _______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>  _______________________________________________
>>>>  R-sig-Geo mailing list
>>>>  R-sig-Geo at r-project.org
>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From mw@n|@hwyc|||| @end|ng |rom gm@||@com  Mon Jul 12 15:25:50 2021
From: mw@n|@hwyc|||| @end|ng |rom gm@||@com (wycliff mwania)
Date: Mon, 12 Jul 2021 16:25:50 +0300
Subject: [R-sig-Geo] Spatio Temporal Kriging
Message-ID: <CAK6w6NNy8-FfMKhBUyrzF68BmMxuAjO6f_dLoP817Pi+3HdUoQ@mail.gmail.com>

Hey there,
I am doing kriging in R language and am facing some problems when I reach
the for using the grid.
When I run this code:
```{r}
coordinates(grid.ST) <- c("Long", "Lat")
july.kriged <- krige(log(WaterLevel) ~ 1, July, grid.ST, model=july.fit)
```
I get this error:
Error in (function (classes, fdef, mtable) : unable to find an inherited
method for function ?coordinates<-? for signature ?"STF"?
I really do not understand what is happening.
Also, when I plot my interpolation results, I get blank plot but the scale
is shown.
Kindly help.
Thank you in advance.

	[[alternative HTML version deleted]]


From r|@@|d@nh@ @end|ng |rom gm@||@com  Mon Jul 12 15:35:19 2021
From: r|@@|d@nh@ @end|ng |rom gm@||@com (Raphael Saldanha)
Date: Mon, 12 Jul 2021 10:35:19 -0300
Subject: [R-sig-Geo] Spatio Temporal Kriging
In-Reply-To: <CAK6w6NNy8-FfMKhBUyrzF68BmMxuAjO6f_dLoP817Pi+3HdUoQ@mail.gmail.com>
References: <CAK6w6NNy8-FfMKhBUyrzF68BmMxuAjO6f_dLoP817Pi+3HdUoQ@mail.gmail.com>
Message-ID: <C5B0FD81-8139-4B22-BBF5-B6021B46AD08@gmail.com>

Hi!

Assuming that you are using the gstat package, looks like that the error occurs when you try to attribute c("Long", "Lat?) to coordinates function.

Try to follow the example from the ?krige function (bellow) with your data:

library(gstat)
library(sp)

data(meuse)
coordinates(meuse) = ~x+y
data(meuse.grid)
gridded(meuse.grid) = ~x+y
m <- vgm(.59, "Sph", 874, .04)

# ordinary kriging:
x <- krige(log(zinc)~1, meuse, meuse.grid, model = m)



Best,

Raphael Saldanha

> Em 12 de jul. de 2021, ?(s) 10:25, wycliff mwania <mwaniahwycliff at gmail.com> escreveu:
> 
> Hey there,
> I am doing kriging in R language and am facing some problems when I reach
> the for using the grid.
> When I run this code:
> ```{r}
> coordinates(grid.ST) <- c("Long", "Lat")
> july.kriged <- krige(log(WaterLevel) ~ 1, July, grid.ST, model=july.fit)
> ```
> I get this error:
> Error in (function (classes, fdef, mtable) : unable to find an inherited
> method for function ?coordinates<-? for signature ?"STF"?
> I really do not understand what is happening.
> Also, when I plot my interpolation results, I get blank plot but the scale
> is shown.
> Kindly help.
> Thank you in advance.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4908 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210712/24ed5ea3/attachment.p7s>

From |r@|d@redondog@r @end|ng |rom gm@||@com  Mon Jul 12 17:48:28 2021
From: |r@|d@redondog@r @end|ng |rom gm@||@com (Iraida Redondo)
Date: Mon, 12 Jul 2021 17:48:28 +0200
Subject: [R-sig-Geo] Trying to compute Moran's I for the first time.
Message-ID: <CAKqeJZAJbH9kCyVDgbAsG3Lt34Za+=ayi_qNd=xVkjd=0iztTw@mail.gmail.com>

Hi everyone.

My name is Iraida. It's my first time joining a mail list and also doing
spatial analysis, so sorry if any of my issues are basic. I've spent a lot
of time searching the internet and contacting researchers that made
analyses on spatial autocorrelation but any of my attempts seems to work.

Just for a little background, I work with a wild population of birds that
prospect a lot into their conspecific nest boxes. We want to know if this
prospecting behaviour has to do with breeding habitat selection. After
reading the literature, I see that is mandatory and very recurrent to check
for spatial and temporal autocorrelation of reproductive success in wild
populations. This reproductive success is thought to integrate
environmental factors. So, patchiness and predictability of reproductive
success would act as a proxy of habitat heterogeneity and information
reliability, thus both are needed for individuals to be able to make a
habitat choice and use information. I would like to compute a Moran's Index
to check for spatial autocorrelation, however I can't find the solution!

We have a nest box (N= ~250) population in a colony and I have collected
the reproductive success of the last 7 years for each of the nest boxes.

I have used this code for calculating Moran's I for a single year and
making a correlogram, by advice of a researcher who I asked for help. In
this script, the spantree function is a procedure to find the smallest
distance keeping all unit sampling linked. And I used it because it's being
difficult to decide the lag distance.

















*starling <- read.csv("starling.csv", header = TRUE, sep =
";")str(starling)geo=starlingcoordinates(geo) <-
~longitude+latitudeXYstarling=coordinates(geo)xy.dl=rdist.earth(XYstarling,
miles = FALSE)diag(xy.dl) <- 0
spanning=spantree(xy.dl)dmin=max(spanning$dist)dmax=max(xy.dl)plot(coordinates(geo))nb1
=dnearneigh(as.matrix(XYstarling), 0, dmin, longlat = TRUE)correloresm1 =
sp.correlogram(nb1, starling$rs, order = (dmax/dmin), method = "I",
zero.policy = TRUE)plot(correloresm1)*

However, the sp.correlogram function tells me the following: "too few
included observations in higher lags: reduce order'. But I can't make it
work. I think that the distribution of my nest boxes has to do with this
error, as a great number of them are distributed in trios and at low
densities, while the rest are uniformly distributed and closer to each
other.

I am new at spatial analysis and my advisor can't help me on this and this
is just an assumption check that I have to do to continue with my research.
I would like to know if there is any way to keep it as simple as possible
to keep moving forward.


Thank you so much in advance.

Kind regards.



Iraida

	[[alternative HTML version deleted]]


From r|@@|d@nh@ @end|ng |rom gm@||@com  Thu Jul 15 01:21:48 2021
From: r|@@|d@nh@ @end|ng |rom gm@||@com (Raphael Saldanha)
Date: Wed, 14 Jul 2021 20:21:48 -0300
Subject: [R-sig-Geo] Shiny app for Spatial Econometric classes
In-Reply-To: <5478436-d93a-89c0-827e-b63d925369e@reclus2.nhh.no>
References: <20210708142008.5738ef1a@rolf-Latitude-E7470>
 <C7F33BC4-4107-4DAE-B3AA-BBB68EF049D9@gmail.com>
 <853e3554-5071-1704-e174-1f5ab1f45c3b@prodsyse.com>
 <0A32F3A1-0B40-4C41-A9F9-3CE1BE73CF7F@gmail.com>
 <878971ed-bceb-8a77-fef-8956e2313853@reclus2.nhh.no>
 <5478436-d93a-89c0-827e-b63d925369e@reclus2.nhh.no>
Message-ID: <330F78AA-BB73-4F2D-8CAA-03483AE3E568@gmail.com>

Thanks Prof. Bivand for your considerations about name and approach. We will debate your points on our next meeting about the project. 

Additionally, I want to thank you for your extensive contribution to the field. Without your packages and publications (and from others), this project would be unthinkable. 


Best regards,

Raphael Saldanha

> Em 12 de jul. de 2021, ?(s) 06:16, Roger Bivand <Roger.Bivand at nhh.no> escreveu:
> 
> Perhaps it is just my connection, but it is not possible to load any data, so I cannot evaluate the other components in practice.
> 
> I do however think that you need to acknowledge the results of Piras and Prucha, https://doi.org/10.1016/j.regsciurbeco.2014.03.002, and try to point out the dangers of pre-testing, rather than estimating the most inclusive model first, and simplifying from there.
> 
> Roger
> 
> On Fri, 9 Jul 2021, Roger Bivand wrote:
> 
>> Returning to the "Tobler" shiny app:
>> 
>> The main serious weakness is the name and the approach. It is not and has never been the case that "Everything is related to everything else, but near things are more related than distant things." This is and has always been an oversimplification, disguising the underlying entitation/support problem. Are the units of observation appropriate for the scale of the unobserved spatial process?
>> 
>> Tobler (1970) https://doi.org/10.2307/143141 was published in the same SI as Olsson (1970) https://doi.org/10.2307/143140 (Olsson precedes Tobler), but Olsson does grasp the important point that spatial autocorrelation is not immanent in spatial phenomena, but often is engendered by inappropriate entitation, by omitted variables and/or inappropriate functional form. The key quote from Olsson is on p. 228:
>> 
>> "The existence of such autocorrelations makes it tempting to agree with Tobler (1970, 236 [my interpolation, the original refers to a conference paper]) that 'everything is related to everything else, but near things are more related than distant things.' On the other hand, the fact that the autocorrelations seem to hide systematic specification errors suggests that the elevation of this statement to the status of 'the first law of geography' is at best premature. At worst, the statement may represent the spatial variant of the post hoc fallacy, which would mean  that coinincidence has been mistaken for a causal relation."
>> 
>> The status of the "first law" is very similar to the belief that John Snow induced the cause of cholera as water-borne from a map. It may be a good way of selling GIS, but it isn't accurate; Snow had a strong working microbiological hypothesis prior to visiting Soho, and the map was prepared after the Broad street pump was disabled as documentation that the hypothesis held (see https://doi.org/10.1016/s0140-6736(00)02442-9 Brody et al. 2000).
>> 
>> So the framing of the shiny app is unfortunate, and spatial econometrics is not a toolbox, rather a way of loooking at mis-specification when space is involved, I think.
>> 
>> Hope this isn't too critical,
>> 
>> Roger
>> 
>> On Thu, 8 Jul 2021, Raphael Saldanha wrote:
>> 
>>> Estimado Spencer,
>>> 
>>> Thanks for your kind words. Actually, that construction is not standard in
>>> Portuguese also (although that does not sound pedant or with some bad
>>> intention for our ears). I revised the text three times and used an app
>>> for grammar correction before sending. Anyway, it was a mistake by all
>>> means.
>>> 
>>> To learn Spatial Econometrics and other fields require from us additional
>>> efforts. There is just a few books or materials in Portuguese. But I try
>>> to approach this difficult as an opportunity to learn.
>>> 
>>> Indeed, one of the reasons for building the app was to facilitate the use
>>> of the methods for people that are learning R. *Professor Eduardo and I*
>>> teach annually a course on that field and we face this challenge. With the
>>> pandemics and Zoom classes, we hope that the app and our scripts will help
>>> the students to learn R.
>>> 
>>> Um forte abra?o,
>>> 
>>> Raphael Saldanha
>>> 
>>>> Em 8 de jul. de 2021, ?(s) 08:45, Spencer Graves
>>>> <spencer.graves at prodsyse.com> escreveu:
>>>> 
>>>> Estimado Raphael:
>>>> 
>>>>    I don't know any Portuguese either, and I'm very grateful that you've
>>>>    made the effort to ask this group in a language not your own.
>>>> 
>>>>    In primary school, I learned that constructions like, "Me and
>>>>    Professor ..." too often sounded like, "Mean Professor ...".
>>>> 
>>>>    Un fuerte abrazo ("A big hug", as a Uruguayan man whom I had not
>>>>    previously met ended a letter inviting me to talk at a conference).
>>>> 
>>>>    Spencer Graves
>>>> 
>>>> On 7/8/21 5:32 AM, Raphael Saldanha wrote:
>>>>> No offense taken. Thanks for the remark and opportunity to learn.
>>>>> Cheers,
>>>>> Raphael
>>>>>> Em 7 de jul. de 2021, ?(s) 23:20, Rolf Turner <r.turner at auckland.ac.nz>
>>>>>> escreveu:
>>>>>> 
>>>>>> 
>>>>>>> On Wed, 7 Jul 2021 18:09:50 -0300
>>>>>>> Raphael Saldanha <rfsaldanha at gmail.com> wrote:
>>>>>>> 
>>>>>>> Hello all!
>>>>>>> 
>>>>>>> Me and Professor Eduardo Almeida (UFJF, Brazil) are creating an R
>>>>>>> Shiny app for Spatial Econometric classes.
>>>>>> 
>>>>>> <SNIP>
>>>>>> 
>>>>>> I hope that you won't find this comment offensive, but I could not
>>>>>> resist sending it to you, since I am rather fanatical (pedantic?) about
>>>>>> correct English usage.
>>>>>> 
>>>>>> The expression "Me and Professor Eduardo Almeida" is both (a) bad
>>>>>> grammar and (b) bad form.  (a) Instead of the pronoun "Me" (accusative
>>>>>> or
>>>>>> objective case) you should use "I" (nominative or subjective case),
>>>>>> since
>>>>>> this expression is the subject of the sentence.  (b) It is "bad form"
>>>>>> (it sounds vaguely self-promoting)  to put a first person pronoun
>>>>>> before the
>>>>>> names of others to which it is linked.  You should say "Professor
>>>>>> Eduardo Almeida and I are creating ....".
>>>>>> 
>>>>>> I realise that English is surely a second language for you, and your
>>>>>> English is infinitely better than my non-existent Portuguese.  Your
>>>>>> English is actually quite good, probably better than that of many
>>>>>> native English speakers.  Nevertheless the expression that you use is
>>>>>> not correct and you should strive to avoid such usage.
>>>>>> 
>>>>>> Again let me express the hope that you won't take offence at this
>>>>>> comment.
>>>>>> 
>>>>>> cheers,
>>>>>> 
>>>>>> Rolf Turner
>>>>>> 
>>>>>> --
>>>>>> Honorary Research Fellow
>>>>>> Department of Statistics
>>>>>> University of Auckland
>>>>>> Phone: +64-9-373-7599 ext. 88276
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
> 
> -- 
> Roger Bivand
> Emeritus Professor
> Department of Economics, Norwegian School of Economics,
> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
> e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4908 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20210714/cfe29104/attachment.p7s>

From jru85yebe @end|ng |rom hotm@||@com  Thu Jul 15 09:55:22 2021
From: jru85yebe @end|ng |rom hotm@||@com (=?utf-8?Q?Jes=C3=BAs_Rojo?=)
Date: Thu, 15 Jul 2021 09:55:22 +0200
Subject: [R-sig-Geo] Cropping Large RasterStack
Message-ID: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>

Hello everyone
I have a Large RasterStack (8501485725 elements, 336.8 Mb) compounded by 23750 raster layers (0.1 degree of resolution)
I would like to do a crop based on an extent

'tmax <- crop(tmax, extent(0, 20, 40, 55))?

It seems to be very time-consuming, and even it seems that my pc is not able to crop after a long time
Do you know another efficient way to do this task without parallelizing?
I think that I did this task with large stacks in the past with ?crop? and it run well, but now I do not know if it is possible
Thanks for your help
Kind regards

Jes?s Rojo

From @@eed@kh@n @end|ng |rom un|-b@yreuth@de  Thu Jul 15 10:04:05 2021
From: @@eed@kh@n @end|ng |rom un|-b@yreuth@de (Khan, Saeed Akhtar)
Date: Thu, 15 Jul 2021 08:04:05 +0000
Subject: [R-sig-Geo] Cropping Large RasterStack
In-Reply-To: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>
References: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>
Message-ID: <671a3a4282e748e8a07f319fa4185db4@uni-bayreuth.de>

Hi Rojo, 

I think you should crop individual rasters through a loop and stack the results at the end. 

Best, 
Saeed

-----Original Message-----
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Jes?s Rojo
Sent: Thursday, July 15, 2021 9:55 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Cropping Large RasterStack

Hello everyone
I have a Large RasterStack (8501485725 elements, 336.8 Mb) compounded by 23750 raster layers (0.1 degree of resolution) I would like to do a crop based on an extent

'tmax <- crop(tmax, extent(0, 20, 40, 55))?

It seems to be very time-consuming, and even it seems that my pc is not able to crop after a long time Do you know another efficient way to do this task without parallelizing?
I think that I did this task with large stacks in the past with ?crop? and it run well, but now I do not know if it is possible Thanks for your help Kind regards

Jes?s Rojo
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From |ukp@w||k @end|ng |rom gm@||@com  Thu Jul 15 10:08:59 2021
From: |ukp@w||k @end|ng |rom gm@||@com (=?UTF-8?Q?=C5=81ukasz_Pawlik?=)
Date: Thu, 15 Jul 2021 10:08:59 +0200
Subject: [R-sig-Geo] Cropping Large RasterStack
In-Reply-To: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>
References: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>
Message-ID: <CAH8k9Q=NhPAFsSU10MxKRdWU6thu3NNyhVK8gA_pQNBrDy0vvw@mail.gmail.com>

Hi,
I normally use this simple function and for loop to automate the process.

get_file <- function(x){
  mask1 <- st_read('XXXXXXXXXXXXXXXXX.shp')
  raster1 <- terra::rast(paste0('file_path',
                                list_of_files[x],'.tif'))
  terra::crop(raster1, mask1,
              filename=paste0('file_path',
                                        list_of_files_new[x],'.tif'))
  unlink(paste0('file_path',
                list_of_files_new[x],'.tif'))
}

get_chelsa(x)

numbers <- 1:420

for(i in numbers){
  get_chelsa(i)
}

If files are large, I use a computer cluster, for instance,
http://www.plgrid.pl/en.

Hope this helps.

Best,
Lukasz

czw., 15 lip 2021 o 09:56 Jes?s Rojo <jru85yebe at hotmail.com> napisa?(a):

> Hello everyone
> I have a Large RasterStack (8501485725 elements, 336.8 Mb) compounded by
> 23750 raster layers (0.1 degree of resolution)
> I would like to do a crop based on an extent
>
> 'tmax <- crop(tmax, extent(0, 20, 40, 55))?
>
> It seems to be very time-consuming, and even it seems that my pc is not
> able to crop after a long time
> Do you know another efficient way to do this task without parallelizing?
> I think that I did this task with large stacks in the past with ?crop? and
> it run well, but now I do not know if it is possible
> Thanks for your help
> Kind regards
>
> Jes?s Rojo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
WWW: https://www.biomorpho.us.edu.pl/
ResearchGate: https://www.researchgate.net/profile/ukasz_Pawlik
Twitter: @BMGResearchTea1

	[[alternative HTML version deleted]]


From b|@|ev||@t @end|ng |rom gm@||@com  Thu Jul 15 10:14:45 2021
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Thu, 15 Jul 2021 10:14:45 +0200
Subject: [R-sig-Geo] Cropping Large RasterStack
In-Reply-To: <671a3a4282e748e8a07f319fa4185db4@uni-bayreuth.de>
References: <VI1PR08MB3392508920C8EA9EBAA6F1F6B4129@VI1PR08MB3392.eurprd08.prod.outlook.com>
 <671a3a4282e748e8a07f319fa4185db4@uni-bayreuth.de>
Message-ID: <b32777de-2d6d-a397-d18f-213c28fdb213@gmail.com>

Hello Jes?s,
also you can try terra::crop(), it might be faster and/or more 
memory-efficient.
Have a nice week,
?kos
---
?kos Bede-Fazekas
Centre for Ecological Research, Hungary

2021.07.15. 10:04 keltez?ssel, Khan, Saeed Akhtar ?rta:
> Hi Rojo,
>
> I think you should crop individual rasters through a loop and stack the results at the end.
>
> Best,
> Saeed
>
> -----Original Message-----
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Jes?s Rojo
> Sent: Thursday, July 15, 2021 9:55 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Cropping Large RasterStack
>
> Hello everyone
> I have a Large RasterStack (8501485725 elements, 336.8 Mb) compounded by 23750 raster layers (0.1 degree of resolution) I would like to do a crop based on an extent
>
> 'tmax <- crop(tmax, extent(0, 20, 40, 55))?
>
> It seems to be very time-consuming, and even it seems that my pc is not able to crop after a long time Do you know another efficient way to do this task without parallelizing?
> I think that I did this task with large stacks in the past with ?crop? and it run well, but now I do not know if it is possible Thanks for your help Kind regards
>
> Jes?s Rojo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@  Fri Jul 16 12:17:50 2021
From: ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@ (Julian M. Burgos)
Date: Fri, 16 Jul 2021 10:17:50 +0000
Subject: [R-sig-Geo] Issue with st_warp, gdal and NAs
Message-ID: <xgzh7gumuk1.fsf@hafogvatn.is>

Dear list,

My apologies for posting this again.  I am not sure if it went through the first time.

I am having a bit of trouble using st_warp() to aggregate star objects with the option "use_gdal = TRUE".  I am using the "average" method, and I want cells with NA values to be ignored when computing the averages.  To demonstrate, I will make a small raster for testing, and will include cells with NA values:

#-------------------------------------------------
  
library(raster)

# Create raster for testing
myfile <- "~/myraster.tif"
myraster <- raster(xmn = 0, ymn = 0, xmx = 10, ymx = 10, resolution = 0.1,
                   crs = 4326, vals = sample(1:20, size = 10000, replace = TRUE))
myraster[sample(1:10000, 200)] <- NA
writeRaster(myraster, filename = myfile, overwrite = TRUE)

#-------------------------------------------------

With the raster package, I can aggregate the cells ignoring the NA values like this:


r1 <- raster(myfile)
ag1 <- raster::aggregate(x = raster(myfile), fact = 10,
                         fun = mean, na.rm = TRUE)

...which is what I want.  I can also aggregate the cells including the NAs, like this:
                                                                                   
ag2 <- raster::aggregate(x = raster(myfile), fact = 10,
                         fun = mean, na.rm = FALSE)

.... which produces a raster with a lots of gaps.  Now, to do a similar aggregation with the stars package I can do this:

s1 <-  read_stars(myfile)

ag3 <- st_warp(src = s1,
              dest = st_as_stars(st_bbox(s1), dx = 1, dy = 1),
              use_gdal = TRUE,
              method = "average")

The resulting raster (ag3) has gaps like ag2, which means that the NAs are not being ignored when computing the averages.  With use_gdal_TRUE and method="average" we are using gdalwarp with the average resampling method, which according to the documentation "computes the weighted average of all non-NODATA contributing pixels.".  So I guess the problem is that the NAs are not being recognized as NODATA pixels.

Does anybody know how to solve this?

Many thanks,

Julian

-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnun, ranns?kna- og r??gjafarstofnun hafs og vatna/
Marine and Freshwater Research Institute
Botnsj?varsvi?s / Demersal Division
  Fornub??ir 5, IS-220 Hafnarfj?r?ur, Iceland
www.hafogvatn.is
S?mi/Telephone : +354-5752037
Netfang/Email: julian.burgos at hafogvatn.is


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Thu Jul 22 15:20:01 2021
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Thu, 22 Jul 2021 15:20:01 +0200
Subject: [R-sig-Geo] Issue with st_warp, gdal and NAs
In-Reply-To: <xgzh7gumuk1.fsf@hafogvatn.is>
References: <xgzh7gumuk1.fsf@hafogvatn.is>
Message-ID: <d8fe3342-1f4a-d03c-4187-25db395372fd@uni-muenster.de>

Dear Julian, you can do that by passing a non-NA value as no_data_value, 
e.g. by

ag3 <- st_warp(src = s1,
               dest = st_as_stars(st_bbox(s1), dx = 1, dy = 1),
               use_gdal = TRUE,
               method = "average",
               no_data_value = -9999)


On 16/07/2021 12:17, Julian M. Burgos wrote:
> Dear list,
> 
> My apologies for posting this again.  I am not sure if it went through the first time.
> 
> I am having a bit of trouble using st_warp() to aggregate star objects with the option "use_gdal = TRUE".  I am using the "average" method, and I want cells with NA values to be ignored when computing the averages.  To demonstrate, I will make a small raster for testing, and will include cells with NA values:
> 
> #-------------------------------------------------
>    
> library(raster)
> 
> # Create raster for testing
> myfile <- "~/myraster.tif"
> myraster <- raster(xmn = 0, ymn = 0, xmx = 10, ymx = 10, resolution = 0.1,
>                     crs = 4326, vals = sample(1:20, size = 10000, replace = TRUE))
> myraster[sample(1:10000, 200)] <- NA
> writeRaster(myraster, filename = myfile, overwrite = TRUE)
> 
> #-------------------------------------------------
> 
> With the raster package, I can aggregate the cells ignoring the NA values like this:
> 
> 
> r1 <- raster(myfile)
> ag1 <- raster::aggregate(x = raster(myfile), fact = 10,
>                           fun = mean, na.rm = TRUE)
> 
> ...which is what I want.  I can also aggregate the cells including the NAs, like this:
>                                                                                     
> ag2 <- raster::aggregate(x = raster(myfile), fact = 10,
>                           fun = mean, na.rm = FALSE)
> 
> .... which produces a raster with a lots of gaps.  Now, to do a similar aggregation with the stars package I can do this:
> 
> s1 <-  read_stars(myfile)
> 
> ag3 <- st_warp(src = s1,
>                dest = st_as_stars(st_bbox(s1), dx = 1, dy = 1),
>                use_gdal = TRUE,
>                method = "average")
> 
> The resulting raster (ag3) has gaps like ag2, which means that the NAs are not being ignored when computing the averages.  With use_gdal_TRUE and method="average" we are using gdalwarp with the average resampling method, which according to the documentation "computes the weighted average of all non-NODATA contributing pixels.".  So I guess the problem is that the NAs are not being recognized as NODATA pixels.
> 
> Does anybody know how to solve this?
> 
> Many thanks,
> 
> Julian
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From b@y@t194 @end|ng |rom y@hoo@com  Tue Jul 27 05:28:34 2021
From: b@y@t194 @end|ng |rom y@hoo@com (Javad Bayat)
Date: Tue, 27 Jul 2021 03:28:34 +0000 (UTC)
Subject: [R-sig-Geo] Satellite Image
References: <908483446.33504.1627356514767.ref@mail.yahoo.com>
Message-ID: <908483446.33504.1627356514767@mail.yahoo.com>

Dear all; 
I want to extract special wavelength of landsat8 image, 470nm, and 570nm. 
Is there any way to do this?Sincerely

	[[alternative HTML version deleted]]


From johnw@@|ge @end|ng |rom gm@||@com  Wed Jul 28 21:36:13 2021
From: johnw@@|ge @end|ng |rom gm@||@com (John Wasige)
Date: Wed, 28 Jul 2021 22:36:13 +0300
Subject: [R-sig-Geo] Adding a regression line on time series plot
Message-ID: <CAJgdCD7rOiQWwOF62FVByrrd+xKCKDr96hQ0EWJ-xuaKAKuaug@mail.gmail.com>

Dear all,
Greetings!

I need help. How can I add a regression line on this plot:

MODIS.filt.ts = ts(l, start=c(2001,1), end=c(2020,23), frequency=23)
plot(MODIS.filt.ts)

Thanks for your help

John

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Wed Jul 28 23:31:05 2021
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Wed, 28 Jul 2021 15:31:05 -0600
Subject: [R-sig-Geo] Adding a regression line on time series plot
In-Reply-To: <CAJgdCD7rOiQWwOF62FVByrrd+xKCKDr96hQ0EWJ-xuaKAKuaug@mail.gmail.com>
References: <CAJgdCD7rOiQWwOF62FVByrrd+xKCKDr96hQ0EWJ-xuaKAKuaug@mail.gmail.com>
Message-ID: <CACxE24mv+V=Y0Ch_ufMvryWy27YjFOMYDPB6AsPBktmju-Y5Pw@mail.gmail.com>

How about something like this:

MODIS.filt.ts <- ts(rnorm(460),start=c(2001,1),end=c(2020,23),freq=23)
abline(lm(MODIS.filt.ts~c(1:460)))


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Wed, Jul 28, 2021 at 1:37 PM John Wasige <johnwasige at gmail.com> wrote:

> Dear all,
> Greetings!
>
> I need help. How can I add a regression line on this plot:
>
> MODIS.filt.ts = ts(l, start=c(2001,1), end=c(2020,23), frequency=23)
> plot(MODIS.filt.ts)
>
> Thanks for your help
>
> John
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br  Fri Jul 30 00:20:27 2021
From: @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br (Alexandre Santos)
Date: Thu, 29 Jul 2021 22:20:27 +0000 (UTC)
Subject: [R-sig-Geo] Create a ppp object in UTM with mixture of zones
References: <395417256.470075.1627597227265.ref@mail.yahoo.com>
Message-ID: <395417256.470075.1627597227265@mail.yahoo.com>

Dear?Members,


I'd?like?to?use?my?spatial?data?set?("sp_ds")?as?ppp?(spatstat?Point?Pattern?object),?an?I?try?to?do:



#?Open?spatial?data?set?in?GitHub
library(spatstat)
library(sf)
library(sp)


sp_ds<-read.csv("https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
str(sp_ds)
#'data.frame':??4458?obs.?of??2?variables:
#?$?Lat?:?num??9.17?9.71?9.12?9.12?9.71?...
#?$?Long:?num??35.8?35.5?35.8?35.8?35.5?...


#?Create?boudaries?using?sf
sfds?=?st_as_sf(sp_ds,?coords=c("Long","Lat"),?crs=4326)
traps<-sp_ds
ch?<-?chull(traps[,c(2,1)])
coords?<-?traps[c(ch,?ch[1]),?]?
coordinates(coords)?<-?c("Long","Lat")
proj4string(coords)?<-?CRS("+init=epsg:4326")
W?<-?owin(poly=cbind(coordinates(coords)[,2],coordinates(coords)[,1]))?



#?Create?a?ppp?Point?Pattern?object
out.ppp<-ppp(x=sp_ds$Lat,y=sp_ds$Long,window=W)
plot(out.ppp)


f1?<-?ppm(out.ppp~1)?
E?<-envelope(f1,?Kinhom,?nsim?=?19,?global?=?TRUE,?correction?=?"border")
plot(E)


#But?I'd?like?to?r?distance (x axis) in?kilometers?and?for?this?I?need?to?convert?the?coordinate?reference?system?of?4326?to
UTM,?a?have?3?UTM?zones:
#34N?bounds:?(18.0,?0.0,?24.0,?84.0)
#35N?bounds:?(24.0,?0.0,?30.0,?84.0)
#36N?bounds:?(30.0,?0.0,?36.0,?84.0)


Please?the?area?a?simple?way?to?create?a?ppp?object?in?UTM?with a mixture?of?zones?


Thanks?in?advance,


Alexandre


From md@umner @end|ng |rom gm@||@com  Fri Jul 30 20:40:53 2021
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Sat, 31 Jul 2021 04:40:53 +1000
Subject: [R-sig-Geo] Create a ppp object in UTM with mixture of zones
In-Reply-To: <395417256.470075.1627597227265@mail.yahoo.com>
References: <395417256.470075.1627597227265.ref@mail.yahoo.com>
 <395417256.470075.1627597227265@mail.yahoo.com>
Message-ID: <CAAcGz9_u8PMOpM-UCekzu9EXzhEqr1FT9pSY0ovgKT77nNx=Og@mail.gmail.com>

Don't use UTM, it's a legacy of a bygone era. Use a local custom projection
such as laea:

https://twitter.com/mdsumner/status/1136794870113218561?s=19

I know it's common advice, utm for projection choice but it's trash
propagated by folks who should know better. Traversing zones for projection
choice for basic distance properties is unnecessary.

Best, Mike

On Fri, 30 Jul 2021, 08:21 Alexandre Santos via R-sig-Geo, <
r-sig-geo at r-project.org> wrote:

> Dear Members,
>
>
>
> I'd like to use my spatial data set ("sp_ds") as ppp (spatstat Point Pattern object), an I try to do:
>
>
>
> # Open spatial data set in GitHub
> library(spatstat)
> library(sf)
> library(sp)
>
>
> sp_ds<-read.csv("
> https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
> str(sp_ds)
> #'data.frame':  4458 obs. of  2 variables:
> # $ Lat : num  9.17 9.71 9.12 9.12 9.71 ...
> # $ Long: num  35.8 35.5 35.8 35.8 35.5 ...
>
>
> # Create boudaries using sf
> sfds = st_as_sf(sp_ds, coords=c("Long","Lat"), crs=4326)
> traps<-sp_ds
> ch <- chull(traps[,c(2,1)])
> coords <- traps[c(ch, ch[1]), ]
> coordinates(coords) <- c("Long","Lat")
> proj4string(coords) <- CRS("+init=epsg:4326")
> W <- owin(poly=cbind(coordinates(coords)[,2],coordinates(coords)[,1]))
>
>
>
> # Create a ppp Point Pattern object
> out.ppp<-ppp(x=sp_ds$Lat,y=sp_ds$Long,window=W)
> plot(out.ppp)
>
>
> f1 <- ppm(out.ppp~1)
> E <-envelope(f1, Kinhom, nsim = 19, global = TRUE, correction = "border")
> plot(E)
>
>
> #But I'd like to r distance (x axis)
> in kilometers and for this I need to convert the coordinate reference system of 4326 to
> UTM, a have 3 UTM zones:
> #34N bounds: (18.0, 0.0, 24.0, 84.0)
> #35N bounds: (24.0, 0.0, 30.0, 84.0)
> #36N bounds: (30.0, 0.0, 36.0, 84.0)
>
>
> Please the area a simple way to create a ppp object in UTM with a
> mixture of zones?
>
>
> Thanks in advance,
>
>
> Alexandre
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br  Fri Jul 30 22:09:44 2021
From: @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br (Alexandre Santos)
Date: Fri, 30 Jul 2021 20:09:44 +0000 (UTC)
Subject: [R-sig-Geo] Create a ppp object in UTM with mixture of zones
In-Reply-To: <CAAcGz9_u8PMOpM-UCekzu9EXzhEqr1FT9pSY0ovgKT77nNx=Og@mail.gmail.com>
References: <395417256.470075.1627597227265.ref@mail.yahoo.com>
 <395417256.470075.1627597227265@mail.yahoo.com>
 <CAAcGz9_u8PMOpM-UCekzu9EXzhEqr1FT9pSY0ovgKT77nNx=Og@mail.gmail.com>
Message-ID: <2025620979.1667490.1627675784053@mail.yahoo.com>

Thanks, Mike

Problem solved with a transformation of to Lambert azimuthal equal-area projection centred on longitude and latitude of?0:

# Packages
library(spatstat)
library(sf)
library(sp)
library(raster)


# Open spatial data set in GitHub
sp_ds<-read.csv("https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
str(sp_ds)
#'data.frame':? 4458 obs. of? 2 variables:
# $ Lat : num? 9.17 9.71 9.12 9.12 9.71 ...
# $ Long: num? 35.8 35.5 35.8 35.8 35.5 ...


sp_ds <- st_read("https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
sp_ds_sf <- st_as_sf(sp_ds, coords = c("Lat", "Long"), crs = 4326)


# Here the Mike tip!!
sp_ds_laea = st_transform(sp_ds_sf,?
? ? ? ? ? ? ? ? ? ? ? ? ? ?crs = "+proj=laea +x_0=0 +y_0=0 +lon_0=0 +lat_0=0")
# Create boudaries using sf
ch_ds <- st_convex_hull(st_union(sp_ds_laea))
W<- as.owin(ch_ds)?


# Create a ppp Point Pattern with sf object
out.ppp <- as.ppp(X=st_coordinates(sp_ds_laea),W=W)
plot(out.ppp)




# Make a CRS test
f1 <- ppm(out.ppp~1)?
E <-envelope(f1, Kinhom, nsim = 19, global = TRUE, correction = "border")
plot(E)

Best wishes,

Alexandre








Em sexta-feira, 30 de julho de 2021 15:41:08 BRT, Michael Sumner <mdsumner at gmail.com> escreveu: 





Don't use UTM, it's a legacy of a bygone era. Use a local custom projection such as laea:

https://twitter.com/mdsumner/status/1136794870113218561?s=19

I know it's common advice, utm for projection choice but it's trash propagated by folks who should know better. Traversing zones for projection choice for basic distance properties is unnecessary.

Best, Mike

On Fri, 30 Jul 2021, 08:21 Alexandre Santos via R-sig-Geo, <r-sig-geo at r-project.org> wrote:
> Dear?Members,
> 
> 
> I'd?like?to?use?my?spatial?data?set?("sp_ds")?as?ppp?(spatstat?Point?Pattern?object),?an?I?try?to?do:
> 
> 
> 
> #?Open?spatial?data?set?in?GitHub
> library(spatstat)
> library(sf)
> library(sp)
> 
> 
> sp_ds<-read.csv("https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
> str(sp_ds)
> #'data.frame':??4458?obs.?of??2?variables:
> #?$?Lat?:?num??9.17?9.71?9.12?9.12?9.71?...
> #?$?Long:?num??35.8?35.5?35.8?35.8?35.5?...
> 
> 
> #?Create?boudaries?using?sf
> sfds?=?st_as_sf(sp_ds,?coords=c("Long","Lat"),?crs=4326)
> traps<-sp_ds
> ch?<-?chull(traps[,c(2,1)])
> coords?<-?traps[c(ch,?ch[1]),?]?
> coordinates(coords)?<-?c("Long","Lat")
> proj4string(coords)?<-?CRS("+init=epsg:4326")
> W?<-?owin(poly=cbind(coordinates(coords)[,2],coordinates(coords)[,1]))?
> 
> 
> 
> #?Create?a?ppp?Point?Pattern?object
> out.ppp<-ppp(x=sp_ds$Lat,y=sp_ds$Long,window=W)
> plot(out.ppp)
> 
> 
> f1?<-?ppm(out.ppp~1)?
> E?<-envelope(f1,?Kinhom,?nsim?=?19,?global?=?TRUE,?correction?=?"border")
> plot(E)
> 
> 
> #But?I'd?like?to?r?distance (x axis) in?kilometers?and?for?this?I?need?to?convert?the?coordinate?reference?system?of?4326?to
> UTM,?a?have?3?UTM?zones:
> #34N?bounds:?(18.0,?0.0,?24.0,?84.0)
> #35N?bounds:?(24.0,?0.0,?30.0,?84.0)
> #36N?bounds:?(30.0,?0.0,?36.0,?84.0)
> 
> 
> Please?the?area?a?simple?way?to?create?a?ppp?object?in?UTM?with a mixture?of?zones?
> 
> 
> Thanks?in?advance,
> 
> 
> Alexandre
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 


From md@umner @end|ng |rom gm@||@com  Sat Jul 31 02:13:37 2021
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Sat, 31 Jul 2021 10:13:37 +1000
Subject: [R-sig-Geo] Create a ppp object in UTM with mixture of zones
In-Reply-To: <2025620979.1667490.1627675784053@mail.yahoo.com>
References: <395417256.470075.1627597227265.ref@mail.yahoo.com>
 <395417256.470075.1627597227265@mail.yahoo.com>
 <CAAcGz9_u8PMOpM-UCekzu9EXzhEqr1FT9pSY0ovgKT77nNx=Og@mail.gmail.com>
 <2025620979.1667490.1627675784053@mail.yahoo.com>
Message-ID: <CAAcGz9_BVPuiBHYTpD2zMsXVQfPyzdo1GnJ7M1+iDQD9RPrKkg@mail.gmail.com>

On Sat, Jul 31, 2021 at 6:09 AM Alexandre Santos <
alexandresantosbr at yahoo.com.br> wrote:
>
> Thanks, Mike
>
> Problem solved with a transformation of to Lambert azimuthal equal-area
projection centred on longitude and latitude of 0:
>
> # Packages
> library(spatstat)
> library(sf)
> library(sp)
> library(raster)
>
>
> # Open spatial data set in GitHub
> sp_ds<-read.csv("
https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
> str(sp_ds)
> #'data.frame':  4458 obs. of  2 variables:
> # $ Lat : num  9.17 9.71 9.12 9.12 9.71 ...
> # $ Long: num  35.8 35.5 35.8 35.8 35.5 ...
>
>
> sp_ds <- st_read("
https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
> sp_ds_sf <- st_as_sf(sp_ds, coords = c("Lat", "Long"), crs = 4326)
>
>
> # Here the Mike tip!!
> sp_ds_laea = st_transform(sp_ds_sf,
>                            crs = "+proj=laea +x_0=0 +y_0=0 +lon_0=0
+lat_0=0")


  great, but you should centre the projection for your data - +lon_0 and
+lat_0 specify a central-ish point for your longitude,latitude values. Plot
the data on a map in long lat, and then plot them once projected - it looks
pretty weird with centre lon,lat at 0,0 . - you want more like "+proj=laea
+lon_0=29.9 +lat_0=13.4 +datum=WGS84" - the x_0 and y_0 may be specified,
they just move the 0,0 of the projection away from the centre of your map
(nice to not have negative values). It's likely you could find a local
authority projection that is defined for general use (laea, lcc, aeqd are
common).

Also, you are using Lat,Long order which is technically correct for
EPSG:4326, other variants of longitude,latitude specifications use the more
straightforward coordinate order, it's configurable and sf handles it etc.
but you should definitely check :)

Finally, it's probably worth saying in this case for these data you could
probably choose the central (of the 3) UTM zones involved and get just as
good properties ( I never see that said in the wild). But, it's not really
possible to have overarching advice here because your data and your context
and your distances can be a very broad set of cases, that's why different
families of projections exist, for options. You can calculate distance and
area in long,lat with geodist, geosphere, sf and many other packages - and
sf is incorporating s2 to enable that always for data in long,lat - but I
assume you need an actual coordinate system for spatstat to operate in its
own context (so your approach is exactly right). The choice of projection
can be subtle and require expertise, but a local central laea for smallish
regions is pretty fail safe.  Over a small area like this, most projections
will be exactly the same in terms of distance, area, shape  - but not
knowing the broader case of data you might want to deal with means such
advice needs to be issued with care. :)

HTH



> # Create boudaries using sf
> ch_ds <- st_convex_hull(st_union(sp_ds_laea))
> W<- as.owin(ch_ds)
>
>
> # Create a ppp Point Pattern with sf object
> out.ppp <- as.ppp(X=st_coordinates(sp_ds_laea),W=W)
> plot(out.ppp)
>
>
>
>
> # Make a CRS test
> f1 <- ppm(out.ppp~1)
> E <-envelope(f1, Kinhom, nsim = 19, global = TRUE, correction = "border")
> plot(E)
>
> Best wishes,
>
> Alexandre
>
>
>
>
>
>
>
>
> Em sexta-feira, 30 de julho de 2021 15:41:08 BRT, Michael Sumner <
mdsumner at gmail.com> escreveu:
>
>
>
>
>
> Don't use UTM, it's a legacy of a bygone era. Use a local custom
projection such as laea:
>
> https://twitter.com/mdsumner/status/1136794870113218561?s=19
>
> I know it's common advice, utm for projection choice but it's trash
propagated by folks who should know better. Traversing zones for projection
choice for basic distance properties is unnecessary.
>
> Best, Mike
>
> On Fri, 30 Jul 2021, 08:21 Alexandre Santos via R-sig-Geo, <
r-sig-geo at r-project.org> wrote:
> > Dear Members,
> >
> >
> > I'd like to use my spatial data set ("sp_ds") as ppp (spatstat Point
Pattern object), an I try to do:
> >
> >
> >
> > # Open spatial data set in GitHub
> > library(spatstat)
> > library(sf)
> > library(sp)
> >
> >
> > sp_ds<-read.csv("
https://raw.githubusercontent.com/Leprechault/trash/master/myspds.csv")
> > str(sp_ds)
> > #'data.frame':  4458 obs. of  2 variables:
> > # $ Lat : num  9.17 9.71 9.12 9.12 9.71 ...
> > # $ Long: num  35.8 35.5 35.8 35.8 35.5 ...
> >
> >
> > # Create boudaries using sf
> > sfds = st_as_sf(sp_ds, coords=c("Long","Lat"), crs=4326)
> > traps<-sp_ds
> > ch <- chull(traps[,c(2,1)])
> > coords <- traps[c(ch, ch[1]), ]
> > coordinates(coords) <- c("Long","Lat")
> > proj4string(coords) <- CRS("+init=epsg:4326")
> > W <- owin(poly=cbind(coordinates(coords)[,2],coordinates(coords)[,1]))
> >
> >
> >
> > # Create a ppp Point Pattern object
> > out.ppp<-ppp(x=sp_ds$Lat,y=sp_ds$Long,window=W)
> > plot(out.ppp)
> >
> >
> > f1 <- ppm(out.ppp~1)
> > E <-envelope(f1, Kinhom, nsim = 19, global = TRUE, correction =
"border")
> > plot(E)
> >
> >
> > #But I'd like to r distance (x axis) in kilometers and for this I need
to convert the coordinate reference system of 4326 to
> > UTM, a have 3 UTM zones:
> > #34N bounds: (18.0, 0.0, 24.0, 84.0)
> > #35N bounds: (24.0, 0.0, 30.0, 84.0)
> > #36N bounds: (30.0, 0.0, 36.0, 84.0)
> >
> >
> > Please the area a simple way to create a ppp object in UTM with a
mixture of zones?
> >
> >
> > Thanks in advance,
> >
> >
> > Alexandre
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
>


--
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


