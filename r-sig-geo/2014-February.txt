From b.rowlingson at lancaster.ac.uk  Sat Feb  1 13:14:25 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 1 Feb 2014 12:14:25 +0000
Subject: [R-sig-Geo] writeRaster do not take the coordinate reference
 from the raster
In-Reply-To: <4f38846cd24b47cd80e5f4c7a1545d83@EX-0-HT0.lancs.local>
References: <4f38846cd24b47cd80e5f4c7a1545d83@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMndiSkjDK19M5u0sk2S-LLBZhV8V8bGOQ=+vd=+pHjwg@mail.gmail.com>

Some raster file types don't let you store the coordinate reference
system. Arc/Info Ascii Grid files are just the grid size and shape in
a header and the values, with no provision for a CRS field. (Unless
esri updated the file spec since I last used them...)

Saving as a GeoTIFF should preserve it in the file's metadata.

Barry


On Fri, Jan 31, 2014 at 10:13 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Dear list members,
>
> When using the function writeRaster (raster package) the coord. ref shows
> NA, even when the raster has a coord. ref.
>
> How can I keep the coord. ref. in my output raster?
>
>> show(distAc_gam)
> class       : RasterLayer
> dimensions  : 477, 746, 355842  (nrow, ncol, ncell)
> resolution  : 100, 100  (x, y)
> extent      : 450664.7, 525264.7, 1076344, 1124044  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=tmerc +lon_0=-84 +lat_0=0 +x_0=500000 +k=0.9999
> +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : in memory
> names       : layer
> values      : 0, 12081.39  (min, max)
>
>
>> writeRaster(distAc_gam, filename = "Raster_distAc.asc", overwrite = TRUE)
> class       : RasterLayer
> dimensions  : 477, 746, 355842  (nrow, ncol, ncell)
> resolution  : 100, 100  (x, y)
> extent      : 450664.7, 525264.7, 1076344, 1124044  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> data source :
> /Users/manuelspinola/Dropbox/Proyectos_en_R/Viviana_Narvaez/Raster_distAc.asc
> names       : Raster_distAc
>
>
>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>         [[alternative HTML version deleted]]
>


From mspinola10 at gmail.com  Sat Feb  1 16:43:51 2014
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 1 Feb 2014 09:43:51 -0600
Subject: [R-sig-Geo] writeRaster do not take the coordinate reference
 from the raster
In-Reply-To: <CANVKczMndiSkjDK19M5u0sk2S-LLBZhV8V8bGOQ=+vd=+pHjwg@mail.gmail.com>
References: <4f38846cd24b47cd80e5f4c7a1545d83@EX-0-HT0.lancs.local>
	<CANVKczMndiSkjDK19M5u0sk2S-LLBZhV8V8bGOQ=+vd=+pHjwg@mail.gmail.com>
Message-ID: <CABkCotS9pnV3iW5dGNuKZn4PE3not96vjUHui3iAxMEQNzCHBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140201/a7a34e34/attachment.pl>

From pingyang.whu at gmail.com  Sun Feb  2 20:09:24 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Sun, 2 Feb 2014 13:09:24 -0600
Subject: [R-sig-Geo] How to parallize my code?
Message-ID: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140202/482cac48/attachment.pl>

From julian at hafro.is  Sun Feb  2 20:45:56 2014
From: julian at hafro.is (Julian Burgos)
Date: Sun, 2 Feb 2014 19:45:56 -0000
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
Message-ID: <e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>

A clear explanation of what you are trying to do would help.  I cannot
figure out why you need to generate such a huge amount of files!  Writing
data into a disk is a very slow step.

> Hi r-sig-geo,
>
>
>
> I am using the following script to extraction weather information for each
> point (from a rasterized shapefile for the COUS) which generate about
> 460,000 files:
>
> Originally I read the coordinates from a shapefile:
>
> Library(rgdal)
>
> pl <- readOGR(".","US_2_points")
>
>
>
> then I used the following code to extract the information from three
> NetCDF
> files that contains the tmin,tmax and pr for each year :
>
> for (year in 1981:2012)
>
>   {
>
>     #get the combined netCDF file
>
>     tminfile <- paste("tmin","_",year,".nc",sep='')
>
>     b_tmin <- brick(tminfile,varname='tmin')
>
>     pptfile <- paste("ppt","_",year,".nc",sep='')
>
>     b_ppt <- brick(pptfile,varname='ppt')
>
>     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>
>     b_tmax <- brick(tmaxfile,varname='tmax')
>
>     #Get the first year here!!!
>
>     print(paste("processing year :",year,sep=''))
>
>     for(l in 1:length(pl))
>
>     {
>
>       v <- NULL
>
>       #generate file with the name convention with
> t_n(latitude)w(longitude).txt, 5 digits after point should be work
>
>       filename <-
> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>
>
>       print(paste("processing file :",filename,sep=''))
>
>       tmin <-
> as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>
>       tmax <-
> as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>
>       ppt <-
> as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>
>       v <- cbind(tmax,tmin,ppt)
>
>       tablename <- c("tmin","tmax","ppt")
>
>       v <- data.frame(v)
>
>       colnames(v) <- tablename
>
>       v["default"] <- 0
>
>       v["year"] <- year
>
>       date <-
> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>
>       month <- as.numeric(substr(date,6,7))
>
>       day   <- as.numeric(substr(date,9,10))
>
>       v["month"] <- month
>
>       v["day"]  <-  day
>
>       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>
>       #write into a file with the fixed wide format
>
>       if(file.existes(filename))
>
>       {
>
>
> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>
>       }
>
>       else
>
>       {
>
>
> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>
>       }
>
>
>
> I found it will takes weeks to finish, then I divide the points from the
> shape file into each State(to generate a shape file for each state for the
> points), and using the following function:
>
>
>
> weather4Point <- function(state)
>
> {
>
>   #get the point file for the state
>
>   setwd("c:/PRISM/US1Points/")
>
>   pl <- readOGR(".",paste("points4_",state,sep=''))
>
>   setwd("e:/PRISM/NetCDF/")
>
>   for (year in 1981:2012)
>
>   {
>
>     #get the combined netCDF file
>
>     tminfile <- paste("tmin","_",year,".nc",sep='')
>
>     b_tmin <- brick(tminfile,varname='tmin')
>
>     pptfile <- paste("ppt","_",year,".nc",sep='')
>
>     b_ppt <- brick(pptfile,varname='ppt')
>
>     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>
>     b_tmax <- brick(tmaxfile,varname='tmax')
>
>     #Get the first year here!!!
>
>     print(paste("processing year :",year,sep=''))
>
>     for(l in 1:length(pl))
>
>     {
>
>       v <- NULL
>
>       #generate file with the name convention with
> t_n(latitude)w(longitude).txt, 5 digits after point should be work
>
>       filename <-
> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>
>
>       print(paste("processing file :",filename,sep=''))
>
>       tmin <-
> as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>
>       tmax <-
> as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>
>       ppt <-
> as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>
>       v <- cbind(tmax,tmin,ppt)
>
>       tablename <- c("tmin","tmax","ppt")
>
>       v <- data.frame(v)
>
>       colnames(v) <- tablename
>
>       v["default"] <- 0
>
>       v["year"] <- year
>
>       date <-
> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>
>       month <- as.numeric(substr(date,6,7))
>
>       day   <- as.numeric(substr(date,9,10))
>
>       v["month"] <- month
>
>       v["day"]  <-  day
>
>       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>
>       v
>
>       #print(paste(v), zero.print = ".")
>
>       #write into a file with the APEX format
>
>       if(file.existes(filename))
>
>       {
>
>
> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>
>       }
>
>       else
>
>       {
>
>
> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>
>       }
>
>     }
>
>   }
>
> }
>
>
>
> Then using the following code by opening several R session to make this
> process "parallel".
>
>
>
> States <- c("AL","AZ","AR","CO","CT","DC","FL","GA","ID","IA",
>
>             "IN","KS","KY","LA","MA","ME","MI","MN","MT","NC")
>
> for (state in States)
>
> {
>
>   weather4Point(state)
>
> }
>
>
>
> However, I still feel slow when I plan to do for the whole US. I am asking
> here is there a better solution to speed up this process(any possibility
> to
> employ parallel programming in R) ?
>
>
>
> Environment information:
>
> R version 3.0.1 (2013-05-16)
>
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> Memory: 16 GB
>
> Processor: Intel(R) Core(tm) i7-3770 CPU @ 3.4Ghz 3.4Ghz
>
>
>
> Looking forward to any suggestions?
>
>
>
> Regards,
>
>
>
> Ping
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From pingyang.whu at gmail.com  Sun Feb  2 20:55:29 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Sun, 2 Feb 2014 13:55:29 -0600
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
	<e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
Message-ID: <CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140202/6aa0f5da/attachment.pl>

From milan.kili11 at gmail.com  Mon Feb  3 12:59:39 2014
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Mon, 3 Feb 2014 12:59:39 +0100
Subject: [R-sig-Geo] plotGoogleMaps pie chart and SpatialLines
Message-ID: <CAPSaU-9JN7EpNbJXrtcHK8LEUK8UA5sBcrvdnt56Ek=wBt+AUQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140203/448b076f/attachment.pl>

From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Mon Feb  3 14:21:08 2014
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien Ferland-Raymond)
Date: Mon, 3 Feb 2014 05:21:08 -0800 (PST)
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
	<e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
	<CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
Message-ID: <1391433668606-7585676.post@n2.nabble.com>

Hello Ping,

Your code is very long and I saddly don't have time to read it all. 
However, I'll show you one short example of my favourite way to parallelise. 
It may not be the best, but it works fine. 

The trick is to replace your "for" loop by a function and call this function
with a parLapply.

Here is my example:

##  function to calculate mean and sd of rapidEye satellite band:
stat.par.bande <- function(band, stack.re){
  library(raster); library(rgdal)
  re <- stack.re[[band]]
  re.agg.mean <- aggregate(re,4, fun=mean)
  re.agg.sd <- aggregate(re,4, fun=sd)
  stack(re.agg.mean, re.agg.sd)
}
##

## and then run it.
library(parallel)
cl <- makeCluster(6)
res.lap <- parLapply(cl,1:nlayers(the.re), stat.par.bande,the.re)   
res.stat <- do.call("stack",res.lap)
stopCluster(cl)
###############

Important points to remember:  You have to pass through every objects and
functions used by your main function (in my case "stat.par.bande()") into
your worker.  You also have to call your packages. 

Good luck, 

Bastien






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-parallize-my-code-tp7585672p7585676.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From julian at hafro.is  Mon Feb  3 15:58:24 2014
From: julian at hafro.is (Julian M. Burgos)
Date: Mon, 03 Feb 2014 14:58:24 +0000
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
	<e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
	<CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
Message-ID: <xgz7g9cckfj.fsf@hafnfirdingur.hafro.is>

Yes, but why you are quering each point individually (one by one) in a
loop, and why you are writing every single data point in a different
file?  Loops are very slow in R, and reading/writing from/to a
disk file is also a very slow process.  Do it several hundred thousand
times and it is no surprise that this takes forever.  I do not have time to examine
your code either (next time provide a minimally reproducible example,
not a long script), but it seems that you have some netCDF files with
environmental data and a shapefile with locations, and you want to get
the environmental data for each location.  If this is what you want to
do, you should:

a) Read the shapefiles into a SpatialPoints object.
b) Use the raster package and read the netCDF rasters into a rasterbrick
object.
c) Use the over function and do an overlay between the points and the
rasterbrick.  You will get a SpaitalPointsDataFrame object, with the
data associated to each point.
d) Save the data into a single file.

This should take some time, say 20-30 minutes perhaps, maybe much less, depending on your
machine speed.

Julian


ping yang writes:

> Hi,
>
> The purpose is to generate weather information(tmin,tmim,prcp) for every 4
> KM (every 4KM there is a point represent that grid) for 32 years throughout
> Contingent U.S.
> I want to run several states simultaneously which I want it run them
> parallel.
>
> Thanks,
>
> Ping
>
>
> On Sun, Feb 2, 2014 at 1:45 PM, Julian Burgos <julian at hafro.is> wrote:
>
>> A clear explanation of what you are trying to do would help.  I cannot
>> figure out why you need to generate such a huge amount of files!  Writing
>> data into a disk is a very slow step.
>>
>> > Hi r-sig-geo,
>> >
>> >
>> >
>> > I am using the following script to extraction weather information for
>> each
>> > point (from a rasterized shapefile for the COUS) which generate about
>> > 460,000 files:
>> >
>> > Originally I read the coordinates from a shapefile:
>> >
>> > Library(rgdal)
>> >
>> > pl <- readOGR(".","US_2_points")
>> >
>> >
>> >
>> > then I used the following code to extract the information from three
>> > NetCDF
>> > files that contains the tmin,tmax and pr for each year :
>> >
>> > for (year in 1981:2012)
>> >
>> >   {
>> >
>> >     #get the combined netCDF file
>> >
>> >     tminfile <- paste("tmin","_",year,".nc",sep='')
>> >
>> >     b_tmin <- brick(tminfile,varname='tmin')
>> >
>> >     pptfile <- paste("ppt","_",year,".nc",sep='')
>> >
>> >     b_ppt <- brick(pptfile,varname='ppt')
>> >
>> >     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>> >
>> >     b_tmax <- brick(tmaxfile,varname='tmax')
>> >
>> >     #Get the first year here!!!
>> >
>> >     print(paste("processing year :",year,sep=''))
>> >
>> >     for(l in 1:length(pl))
>> >
>> >     {
>> >
>> >       v <- NULL
>> >
>> >       #generate file with the name convention with
>> > t_n(latitude)w(longitude).txt, 5 digits after point should be work
>> >
>> >       filename <-
>> >
>> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>> >
>> >
>> >       print(paste("processing file :",filename,sep=''))
>> >
>> >       tmin <-
>> > as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>> >
>> >       tmax <-
>> > as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>> >
>> >       ppt <-
>> > as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>> >
>> >       v <- cbind(tmax,tmin,ppt)
>> >
>> >       tablename <- c("tmin","tmax","ppt")
>> >
>> >       v <- data.frame(v)
>> >
>> >       colnames(v) <- tablename
>> >
>> >       v["default"] <- 0
>> >
>> >       v["year"] <- year
>> >
>> >       date <-
>> >
>> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>> >
>> >       month <- as.numeric(substr(date,6,7))
>> >
>> >       day   <- as.numeric(substr(date,9,10))
>> >
>> >       v["month"] <- month
>> >
>> >       v["day"]  <-  day
>> >
>> >       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>> >
>> >       #write into a file with the fixed wide format
>> >
>> >       if(file.existes(filename))
>> >
>> >       {
>> >
>> >
>> >
>> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>> >
>> >       }
>> >
>> >       else
>> >
>> >       {
>> >
>> >
>> >
>> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>> >
>> >       }
>> >
>> >
>> >
>> > I found it will takes weeks to finish, then I divide the points from the
>> > shape file into each State(to generate a shape file for each state for
>> the
>> > points), and using the following function:
>> >
>> >
>> >
>> > weather4Point <- function(state)
>> >
>> > {
>> >
>> >   #get the point file for the state
>> >
>> >   setwd("c:/PRISM/US1Points/")
>> >
>> >   pl <- readOGR(".",paste("points4_",state,sep=''))
>> >
>> >   setwd("e:/PRISM/NetCDF/")
>> >
>> >   for (year in 1981:2012)
>> >
>> >   {
>> >
>> >     #get the combined netCDF file
>> >
>> >     tminfile <- paste("tmin","_",year,".nc",sep='')
>> >
>> >     b_tmin <- brick(tminfile,varname='tmin')
>> >
>> >     pptfile <- paste("ppt","_",year,".nc",sep='')
>> >
>> >     b_ppt <- brick(pptfile,varname='ppt')
>> >
>> >     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>> >
>> >     b_tmax <- brick(tmaxfile,varname='tmax')
>> >
>> >     #Get the first year here!!!
>> >
>> >     print(paste("processing year :",year,sep=''))
>> >
>> >     for(l in 1:length(pl))
>> >
>> >     {
>> >
>> >       v <- NULL
>> >
>> >       #generate file with the name convention with
>> > t_n(latitude)w(longitude).txt, 5 digits after point should be work
>> >
>> >       filename <-
>> >
>> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>> >
>> >
>> >       print(paste("processing file :",filename,sep=''))
>> >
>> >       tmin <-
>> > as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>> >
>> >       tmax <-
>> > as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>> >
>> >       ppt <-
>> > as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>> >
>> >       v <- cbind(tmax,tmin,ppt)
>> >
>> >       tablename <- c("tmin","tmax","ppt")
>> >
>> >       v <- data.frame(v)
>> >
>> >       colnames(v) <- tablename
>> >
>> >       v["default"] <- 0
>> >
>> >       v["year"] <- year
>> >
>> >       date <-
>> >
>> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>> >
>> >       month <- as.numeric(substr(date,6,7))
>> >
>> >       day   <- as.numeric(substr(date,9,10))
>> >
>> >       v["month"] <- month
>> >
>> >       v["day"]  <-  day
>> >
>> >       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>> >
>> >       v
>> >
>> >       #print(paste(v), zero.print = ".")
>> >
>> >       #write into a file with the APEX format
>> >
>> >       if(file.existes(filename))
>> >
>> >       {
>> >
>> >
>> >
>> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>> >
>> >       }
>> >
>> >       else
>> >
>> >       {
>> >
>> >
>> >
>> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>> >
>> >       }
>> >
>> >     }
>> >
>> >   }
>> >
>> > }
>> >
>> >
>> >
>> > Then using the following code by opening several R session to make this
>> > process "parallel".
>> >
>> >
>> >
>> > States <- c("AL","AZ","AR","CO","CT","DC","FL","GA","ID","IA",
>> >
>> >             "IN","KS","KY","LA","MA","ME","MI","MN","MT","NC")
>> >
>> > for (state in States)
>> >
>> > {
>> >
>> >   weather4Point(state)
>> >
>> > }
>> >
>> >
>> >
>> > However, I still feel slow when I plan to do for the whole US. I am
>> asking
>> > here is there a better solution to speed up this process(any possibility
>> > to
>> > employ parallel programming in R) ?
>> >
>> >
>> >
>> > Environment information:
>> >
>> > R version 3.0.1 (2013-05-16)
>> >
>> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >
>> > Memory: 16 GB
>> >
>> > Processor: Intel(R) Core(tm) i7-3770 CPU @ 3.4Ghz 3.4Ghz
>> >
>> >
>> >
>> > Looking forward to any suggestions?
>> >
>> >
>> >
>> > Regards,
>> >
>> >
>> >
>> > Ping
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>
>>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnun/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From andre.stumpf at unistra.fr  Mon Feb  3 17:02:39 2014
From: andre.stumpf at unistra.fr (andre.stumpf at unistra.fr)
Date: Mon, 3 Feb 2014 17:02:39 +0100
Subject: [R-sig-Geo] vectorplot rasterVis adjust length of arrows
Message-ID: <000c01cf20f9$5ce1c840$16a558c0$@unistra.fr>

Hi,

I use rasterVis's vectorplot function to visualize vector fields
(rasterVis_0.27, R version 3.0.2, Platform: x86_64-w64-mingw32/x64 (64-bit))
from a raster stack in UTM coordinates. 

The example from the vectorplot help to illustrate the issue:

u <- v <- raster(xmn=0, xmx=2, ymn=0, ymx=2, ncol=1e3, nrow=1e3)
x <- init(u, v='x')
y <- init(u, v='y')
u <- y * cos(x)
v <- y * sin(x)
field <- stack(u, v)
names(field) <- c('u', 'v')

vectorplot(field, isField='dXY', narrows=5e2)
# Works as expected

# However when the raster is in projected coordinates with high absolute
coordinate values (UTM in m) the arrows disappear or
# are at least infinitely small
projection(field) <- "+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0"
extent(field) <- c(314420, 314420+1000, 4912697, 4912697+1000)
vectorplot(field, isField='dXY', narrows=5e2)

Is there any way to adjust the length of the arrows (not arrow heads) as
needed?
My plotting script worked fine in this context with a previous rasterVis
version (0.21 I think) so maybe I miss some fundamental changes?

Best regards,
Andr?


From jgrn at illinois.edu  Mon Feb  3 17:46:51 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 3 Feb 2014 10:46:51 -0600
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <xgz7g9cckfj.fsf@hafnfirdingur.hafro.is>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
	<e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
	<CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
	<xgz7g9cckfj.fsf@hafnfirdingur.hafro.is>
Message-ID: <CABG0rfvDyjV=d-bPtn+ow=4Q9T6=ahy88FA5jkNjVPWOt=u4MA@mail.gmail.com>

Ping:

First: For anyone getting started with parallel programming in R, you
should really read:
http://trg.apbionet.org/euasiagrid/docs/parallelR.notes.pdf

Note that wherever it says "snow" you should swap in the package
"parallel".  I'm a big proponent of the "foreach" package, which
generalizes parallel processing across different parallel
infrastructures, and more clearly follows "for" - type looping (*apply
statement are, in general, much more difficult to understand).

Second: if you are doing high I/O, low CPU processes (lots of
read/write), in general parallel processing doesn't help unless you
are on a RAIDed or a parallel filesystem.

Third, as Julian points out: it is easier to start with what you are
trying to do, rather than "fix my script".  What do you mean by:

"The purpose is to generate weather information(tmin,tmim,prcp) for every 4
KM (every 4KM there is a point represent that grid) for 32 years throughout
Contingent U.S."

?

Are you interpolating data?  Downscaling it?  Extracting statistics
per-state?  Summarizing it?  All of these have very different
interpretations, and different approaches (not all of which are
parallel processing).

--j

On Mon, Feb 3, 2014 at 8:58 AM, Julian M. Burgos <julian at hafro.is> wrote:
> Yes, but why you are quering each point individually (one by one) in a
> loop, and why you are writing every single data point in a different
> file?  Loops are very slow in R, and reading/writing from/to a
> disk file is also a very slow process.  Do it several hundred thousand
> times and it is no surprise that this takes forever.  I do not have time to examine
> your code either (next time provide a minimally reproducible example,
> not a long script), but it seems that you have some netCDF files with
> environmental data and a shapefile with locations, and you want to get
> the environmental data for each location.  If this is what you want to
> do, you should:
>
> a) Read the shapefiles into a SpatialPoints object.
> b) Use the raster package and read the netCDF rasters into a rasterbrick
> object.
> c) Use the over function and do an overlay between the points and the
> rasterbrick.  You will get a SpaitalPointsDataFrame object, with the
> data associated to each point.
> d) Save the data into a single file.
>
> This should take some time, say 20-30 minutes perhaps, maybe much less, depending on your
> machine speed.
>
> Julian
>
>
> ping yang writes:
>
>> Hi,
>>
>> The purpose is to generate weather information(tmin,tmim,prcp) for every 4
>> KM (every 4KM there is a point represent that grid) for 32 years throughout
>> Contingent U.S.
>> I want to run several states simultaneously which I want it run them
>> parallel.
>>
>> Thanks,
>>
>> Ping
>>
>>
>> On Sun, Feb 2, 2014 at 1:45 PM, Julian Burgos <julian at hafro.is> wrote:
>>
>>> A clear explanation of what you are trying to do would help.  I cannot
>>> figure out why you need to generate such a huge amount of files!  Writing
>>> data into a disk is a very slow step.
>>>
>>> > Hi r-sig-geo,
>>> >
>>> >
>>> >
>>> > I am using the following script to extraction weather information for
>>> each
>>> > point (from a rasterized shapefile for the COUS) which generate about
>>> > 460,000 files:
>>> >
>>> > Originally I read the coordinates from a shapefile:
>>> >
>>> > Library(rgdal)
>>> >
>>> > pl <- readOGR(".","US_2_points")
>>> >
>>> >
>>> >
>>> > then I used the following code to extract the information from three
>>> > NetCDF
>>> > files that contains the tmin,tmax and pr for each year :
>>> >
>>> > for (year in 1981:2012)
>>> >
>>> >   {
>>> >
>>> >     #get the combined netCDF file
>>> >
>>> >     tminfile <- paste("tmin","_",year,".nc",sep='')
>>> >
>>> >     b_tmin <- brick(tminfile,varname='tmin')
>>> >
>>> >     pptfile <- paste("ppt","_",year,".nc",sep='')
>>> >
>>> >     b_ppt <- brick(pptfile,varname='ppt')
>>> >
>>> >     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>>> >
>>> >     b_tmax <- brick(tmaxfile,varname='tmax')
>>> >
>>> >     #Get the first year here!!!
>>> >
>>> >     print(paste("processing year :",year,sep=''))
>>> >
>>> >     for(l in 1:length(pl))
>>> >
>>> >     {
>>> >
>>> >       v <- NULL
>>> >
>>> >       #generate file with the name convention with
>>> > t_n(latitude)w(longitude).txt, 5 digits after point should be work
>>> >
>>> >       filename <-
>>> >
>>> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>>> >
>>> >
>>> >       print(paste("processing file :",filename,sep=''))
>>> >
>>> >       tmin <-
>>> > as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>>> >
>>> >       tmax <-
>>> > as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>>> >
>>> >       ppt <-
>>> > as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>>> >
>>> >       v <- cbind(tmax,tmin,ppt)
>>> >
>>> >       tablename <- c("tmin","tmax","ppt")
>>> >
>>> >       v <- data.frame(v)
>>> >
>>> >       colnames(v) <- tablename
>>> >
>>> >       v["default"] <- 0
>>> >
>>> >       v["year"] <- year
>>> >
>>> >       date <-
>>> >
>>> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>>> >
>>> >       month <- as.numeric(substr(date,6,7))
>>> >
>>> >       day   <- as.numeric(substr(date,9,10))
>>> >
>>> >       v["month"] <- month
>>> >
>>> >       v["day"]  <-  day
>>> >
>>> >       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>>> >
>>> >       #write into a file with the fixed wide format
>>> >
>>> >       if(file.existes(filename))
>>> >
>>> >       {
>>> >
>>> >
>>> >
>>> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>>> >
>>> >       }
>>> >
>>> >       else
>>> >
>>> >       {
>>> >
>>> >
>>> >
>>> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>>> >
>>> >       }
>>> >
>>> >
>>> >
>>> > I found it will takes weeks to finish, then I divide the points from the
>>> > shape file into each State(to generate a shape file for each state for
>>> the
>>> > points), and using the following function:
>>> >
>>> >
>>> >
>>> > weather4Point <- function(state)
>>> >
>>> > {
>>> >
>>> >   #get the point file for the state
>>> >
>>> >   setwd("c:/PRISM/US1Points/")
>>> >
>>> >   pl <- readOGR(".",paste("points4_",state,sep=''))
>>> >
>>> >   setwd("e:/PRISM/NetCDF/")
>>> >
>>> >   for (year in 1981:2012)
>>> >
>>> >   {
>>> >
>>> >     #get the combined netCDF file
>>> >
>>> >     tminfile <- paste("tmin","_",year,".nc",sep='')
>>> >
>>> >     b_tmin <- brick(tminfile,varname='tmin')
>>> >
>>> >     pptfile <- paste("ppt","_",year,".nc",sep='')
>>> >
>>> >     b_ppt <- brick(pptfile,varname='ppt')
>>> >
>>> >     tmaxfile <- paste("tmax","_",year,".nc",sep='')
>>> >
>>> >     b_tmax <- brick(tmaxfile,varname='tmax')
>>> >
>>> >     #Get the first year here!!!
>>> >
>>> >     print(paste("processing year :",year,sep=''))
>>> >
>>> >     for(l in 1:length(pl))
>>> >
>>> >     {
>>> >
>>> >       v <- NULL
>>> >
>>> >       #generate file with the name convention with
>>> > t_n(latitude)w(longitude).txt, 5 digits after point should be work
>>> >
>>> >       filename <-
>>> >
>>> paste("e:/PRISM/US3/N",round(coordinates(pl[l,])[2],5),"W",abs(round(coordinates(pl[l,])[1],5)),".wth",sep='')
>>> >
>>> >
>>> >       print(paste("processing file :",filename,sep=''))
>>> >
>>> >       tmin <-
>>> > as.numeric(round(extract(b_tmin,coordinates(pl[l,])),digits=1))
>>> >
>>> >       tmax <-
>>> > as.numeric(round(extract(b_tmax,coordinates(pl[l,])),digits=1))
>>> >
>>> >       ppt <-
>>> > as.numeric(round(extract(b_ppt,coordinates(pl[l,])),digits=2))
>>> >
>>> >       v <- cbind(tmax,tmin,ppt)
>>> >
>>> >       tablename <- c("tmin","tmax","ppt")
>>> >
>>> >       v <- data.frame(v)
>>> >
>>> >       colnames(v) <- tablename
>>> >
>>> >       v["default"] <- 0
>>> >
>>> >       v["year"] <- year
>>> >
>>> >       date <-
>>> >
>>> seq(as.Date(paste(year,"/1/1",sep='')),as.Date(paste(year,"/12/31",sep='')),"days")
>>> >
>>> >       month <- as.numeric(substr(date,6,7))
>>> >
>>> >       day   <- as.numeric(substr(date,9,10))
>>> >
>>> >       v["month"] <- month
>>> >
>>> >       v["day"]  <-  day
>>> >
>>> >       v <- v[c("year","month","day","default","tmin","tmax","ppt")]
>>> >
>>> >       v
>>> >
>>> >       #print(paste(v), zero.print = ".")
>>> >
>>> >       #write into a file with the APEX format
>>> >
>>> >       if(file.existes(filename))
>>> >
>>> >       {
>>> >
>>> >
>>> >
>>> write.fwf(x=v,filename,append=TRUE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>>> >
>>> >       }
>>> >
>>> >       else
>>> >
>>> >       {
>>> >
>>> >
>>> >
>>> write.fwf(x=v,filename,append=FALSE,na="NA",rownames=FALSE,colnames=FALSE,width=c(6,3,3,5,5,5,6))
>>> >
>>> >       }
>>> >
>>> >     }
>>> >
>>> >   }
>>> >
>>> > }
>>> >
>>> >
>>> >
>>> > Then using the following code by opening several R session to make this
>>> > process "parallel".
>>> >
>>> >
>>> >
>>> > States <- c("AL","AZ","AR","CO","CT","DC","FL","GA","ID","IA",
>>> >
>>> >             "IN","KS","KY","LA","MA","ME","MI","MN","MT","NC")
>>> >
>>> > for (state in States)
>>> >
>>> > {
>>> >
>>> >   weather4Point(state)
>>> >
>>> > }
>>> >
>>> >
>>> >
>>> > However, I still feel slow when I plan to do for the whole US. I am
>>> asking
>>> > here is there a better solution to speed up this process(any possibility
>>> > to
>>> > employ parallel programming in R) ?
>>> >
>>> >
>>> >
>>> > Environment information:
>>> >
>>> > R version 3.0.1 (2013-05-16)
>>> >
>>> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> >
>>> > Memory: 16 GB
>>> >
>>> > Processor: Intel(R) Core(tm) i7-3770 CPU @ 3.4Ghz 3.4Ghz
>>> >
>>> >
>>> >
>>> > Looking forward to any suggestions?
>>> >
>>> >
>>> >
>>> > Regards,
>>> >
>>> >
>>> >
>>> > Ping
>>> >
>>> >       [[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >
>>>
>>>
>>>
>
>
> --
> Julian Mariano Burgos, PhD
> Hafranns?knastofnun/Marine Research Institute
> Sk?lagata 4, 121 Reykjav?k, Iceland
> S?mi/Telephone : +354-5752037
> Br?fs?mi/Telefax:  +354-5752001
> Netfang/Email: julian at hafro.is
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From andre.stumpf at unistra.fr  Mon Feb  3 18:04:34 2014
From: andre.stumpf at unistra.fr (andre.stumpf at unistra.fr)
Date: Mon, 3 Feb 2014 18:04:34 +0100
Subject: [R-sig-Geo] vectorplot rasterVis adjust length of arrows
In-Reply-To: <000c01cf20f9$5ce1c840$16a558c0$@unistra.fr>
References: <000c01cf20f9$5ce1c840$16a558c0$@unistra.fr>
Message-ID: <001801cf2102$039a9fb0$0acfdf10$@unistra.fr>

I answer my own question. aspX and aspY are the parameters for fine tuning:

vectorplot(field, isField='dXY', narrows=5e2, aspX=2,aspY=2)

Sorry for the premature post,
Andr?




-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
andre.stumpf at unistra.fr
Sent: Monday, February 03, 2014 5:03 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] vectorplot rasterVis adjust length of arrows

Hi,

I use rasterVis's vectorplot function to visualize vector fields
(rasterVis_0.27, R version 3.0.2, Platform: x86_64-w64-mingw32/x64 (64-bit))
from a raster stack in UTM coordinates. 

The example from the vectorplot help to illustrate the issue:

u <- v <- raster(xmn=0, xmx=2, ymn=0, ymx=2, ncol=1e3, nrow=1e3) x <-
init(u, v='x') y <- init(u, v='y') u <- y * cos(x) v <- y * sin(x) field <-
stack(u, v)
names(field) <- c('u', 'v')

vectorplot(field, isField='dXY', narrows=5e2) # Works as expected

# However when the raster is in projected coordinates with high absolute
coordinate values (UTM in m) the arrows disappear or # are at least
infinitely small
projection(field) <- "+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0"
extent(field) <- c(314420, 314420+1000, 4912697, 4912697+1000)
vectorplot(field, isField='dXY', narrows=5e2)

Is there any way to adjust the length of the arrows (not arrow heads) as
needed?
My plotting script worked fine in this context with a previous rasterVis
version (0.21 I think) so maybe I miss some fundamental changes?

Best regards,
Andr?

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pingyang.whu at gmail.com  Mon Feb  3 18:18:45 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 3 Feb 2014 11:18:45 -0600
Subject: [R-sig-Geo] How to parallize my code?
In-Reply-To: <CABG0rfvDyjV=d-bPtn+ow=4Q9T6=ahy88FA5jkNjVPWOt=u4MA@mail.gmail.com>
References: <CAK8gSG9uir55O_tvTwpywNsdCZ7Wt0ixLwjoReJwho-uyo-+DA@mail.gmail.com>
	<e7cc850237e399548b2ade5ede34311b.squirrel@webmail.hafro.is>
	<CAK8gSG9U-sA6e9Yv7MJBvJjRy5UHLT+QNtYgsU0VoYqqhqZpNg@mail.gmail.com>
	<xgz7g9cckfj.fsf@hafnfirdingur.hafro.is>
	<CABG0rfvDyjV=d-bPtn+ow=4Q9T6=ahy88FA5jkNjVPWOt=u4MA@mail.gmail.com>
Message-ID: <CAK8gSG_1cUgtjMpyqcxMMia-8JG8WJQVKZf0dhPEytwpozyk9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140203/d2e436fc/attachment.pl>

From mspinola10 at gmail.com  Mon Feb  3 18:28:36 2014
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Mon, 3 Feb 2014 11:28:36 -0600
Subject: [R-sig-Geo] Error message when projecting a raster with
	projectRaster
Message-ID: <CABkCotQxceDW_wt6P6WvWbLHVkKFhWaaLBcQ6BU+Ew+7k6Pveg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140203/8d16656f/attachment.pl>

From r.hijmans at gmail.com  Mon Feb  3 18:58:37 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 3 Feb 2014 09:58:37 -0800
Subject: [R-sig-Geo] Error message when projecting a raster with
	projectRaster
In-Reply-To: <CABkCotQxceDW_wt6P6WvWbLHVkKFhWaaLBcQ6BU+Ew+7k6Pveg@mail.gmail.com>
References: <CABkCotQxceDW_wt6P6WvWbLHVkKFhWaaLBcQ6BU+Ew+7k6Pveg@mail.gmail.com>
Message-ID: <CANtt_hwAKXOo0crXb894D4igyzXShcKQxPsuDrfPX_QD5G+wrA@mail.gmail.com>

Manuel,
This error goes away after you update package rgdal.
Robert

On Mon, Feb 3, 2014 at 9:28 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Dear list memebers,
>
> I am trying to project a raster but I got the following error:
>
> newProj <- "+proj=tmerc +lon_0=-84 +lat_0=0 +x_0=500000 +k=0.9999
> +datum=WGS84"
>
>> bio1_acpc = raster("bio1_acpc.asc")
>> projection(bio1_acpc) = "+proj=longlat +datum=WGS84"
>> bio1_acpc_p <- projectRaster(bio1_acpc, crs=newProj)
> Error in projectExtent(from, projto) :
>   could not find function "rawTransform"
>
> Thank you very much
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From carolina.lang at ifop.cl  Mon Feb  3 19:20:01 2014
From: carolina.lang at ifop.cl (carolina.lang at ifop.cl)
Date: Mon, 3 Feb 2014 15:20:01 -0300 (CLST)
Subject: [R-sig-Geo] GSLM in binary data set
In-Reply-To: <1817522531.3566884.1391450198280.JavaMail.zimbra@ifop.cl>
Message-ID: <1055169489.3570084.1391451601933.JavaMail.zimbra@ifop.cl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140203/ae93a0fd/attachment.pl>

From mspinola10 at gmail.com  Mon Feb  3 21:35:27 2014
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Mon, 3 Feb 2014 14:35:27 -0600
Subject: [R-sig-Geo] Error message when projecting a raster with
	projectRaster
In-Reply-To: <CANtt_hwAKXOo0crXb894D4igyzXShcKQxPsuDrfPX_QD5G+wrA@mail.gmail.com>
References: <CABkCotQxceDW_wt6P6WvWbLHVkKFhWaaLBcQ6BU+Ew+7k6Pveg@mail.gmail.com>
	<CANtt_hwAKXOo0crXb894D4igyzXShcKQxPsuDrfPX_QD5G+wrA@mail.gmail.com>
Message-ID: <CABkCotSpRgHKERCGKY0zO+FDqdFD6ZLav3Dw1w+78xeiebNsKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140203/ed79058e/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Tue Feb  4 10:47:07 2014
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 04 Feb 2014 10:47:07 +0100
Subject: [R-sig-Geo] =?utf-8?q?Statistician_at_UNODC_Vienna_=28Fwd=3A_Stat?=
 =?utf-8?q?istiker_f=C3=BCr_consultancy_gesucht=29?=
Message-ID: <52F0C52B020000270001F02C@gwia2.boku.ac.at>

Dear List,
please find here an interesting job opportunity at the UNODC (SASS) in Vienna. If you are interested contact directly Ms. Irmgard Zeiler (Irmgard.ZEILER at unodc.org).


good luck
Matteo Mattiuzzi
   


>>> Irmgard ZEILER <Irmgard.ZEILER at unodc.org> 02/03/14 5:02 PM >>>
 Dear all, 
I would like to kindly ask your assistance in my search for a consultant (short term employee) for about 6 months to be based in Vienna. I look for somebody to start as soon as possible, who knows R and has ideally experience with survey statistics and sampling.  A draft job advertisement is attached. 
The position is not advertised yet, I would highly appreciate it if you could forward the email to persons who might be interested to contact me. As soon as we advertise I would then invite for applications. 
Thank you very much, 
Irmgard 

 Specific tasks to be performed by the consultant:
  Under the overall guidance of the Chief of the Statistics and Surveys Section (SASS) and direct supervision of the Officer assigned by the Chief, the consultant will:
 
1. Draw spatial samples for the satellite image survey in Afghanistan according to the instructions provided by SASS based on existing R scripts;
 2. Improve the technical implementation and documentation in R of the existing spatial models and sampling methods used in SASS illicit crop surveys with applications in Afghanistan;
 3. Carry out research and assist in the preparation of statistical inputs on area estimation methods for inclusion in UNODC illicit crop reports and studies; statistical inputs include preparation of input data, quality assessments, treatment of missing values and estimation of variance.
 4. Compose a manual directed at national counterparts and UNODC field office staff in Afghanistan on the various spatial sampling and estimation methods employed. The manual should include examples and easy-to-use methods for applying sampling and estimation techniques using R scripts (sampling) and Excel sheets (estimation);
 
 Expected tangible and measurable output(s): 
 The consultant will provide: A) Spatial samples drawn 
 B) Well documented and technically improved scripts for the spatial sampling methods used in SASS illicit crop surveys
 C) Statistical inputs on the area estimation for inclusion in UNODC illicit crop reports and studies including preparation of input data, on quality assessments, treatment of missing values and estimation of variance. 
 
 D) A manual directed at national counterparts and UNODC field office staff in Afghanistan on the various spatial sampling and estimation methods employed. The manual includes examples and easy-to-use methods for applying sampling and estimation techniques; 
 Working time is indicative and may vary according to the needs of SASS.
 
 Qualifications/expertise sought (required educational background, years of relevant work experience, other special skills or knowledge required): University degree in statistics, social sciences, economics or in a related field. Experience in conducting statistical surveys and managing large datasets through statistical packages. Good record of analytical work based on quantitative methods, preferably in surveys statistics and sampling methods. Very good programming skills in the statistical software R. Experience in producing analytical publications according to UN standards desired. Good planning and organisational skills. Fluency in English, with excellent drafting and communication skills, with attention to detail. Knowledge of Spanish an asset. 

 
 -- 
 Irmgard Zeiler (Ms.), Research Expert
 Statistics and Surveys Section
 United Nations Office on Drugs and Crime (UNODC)
 
 PO Box 500 
 1400 Vienna
 Austria
 
 Tel:  (+43-1) 26060-5289
 Email: irmgard.ZEILER at unodc.org
 Websites: http://www.unodc.org/


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140204/247efa9c/attachment.html>

From markpayneatwork at gmail.com  Tue Feb  4 13:23:59 2014
From: markpayneatwork at gmail.com (Mark Payne)
Date: Tue, 4 Feb 2014 13:23:59 +0100
Subject: [R-sig-Geo] Linking problem with rgdal
Message-ID: <CAGBzUO-XmNJ=5DE3mCvJ7Ahj1CmJWpKuCSb+mOd40mdUaY6ieA@mail.gmail.com>

Hi,

I'm trying to install rgdal on a Scientific LInux cluster  which I do
not have administrator rights. So far, I have done the following
* Downloaded and installed gdal from source into my home directory ie
configured with
./configure --prefix=$HOME/R/gdal
*Downloaded and install proj4 from source with a similar configuration
./configure --prefix=$HOME/R/proj4/

Next, I try to install the rgdal package specifying the various locations

R CMD INSTALL rgdal_0.8-14.tar.gz
--configure-args='--with-proj-lib=$HOME/R/proj4/lib
--with-proj-include=$HOME/R/proj4/include
--with-gdal-config=$HOME/R/gdal/bin/gdal-config' --preclean
--no-clean-on-error

This generally works up to the point where it tries to do a test load,
giving the message:
....
** testing if installed package can be loaded
Error in dyn.load(file, DLLpath = DLLpath, ...) :
  unable to load shared object
'/zhome/39/c/38865/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so':
  libgdal.so.1: cannot open shared object file: No such file or directory
Error: loading failed
Execution halted
ERROR: loading failed

If I check the contents of the shared object:
ldd ~/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so
    linux-vdso.so.1 =>  (0x00007fff74dff000)
    libgdal.so.1 => not found
    libproj.so.0 => not found
    libR.so => not found
    libstdc++.so.6 => /usr/lib64/libstdc++.so.6 (0x00007f59fe330000)
    libm.so.6 => /lib64/libm.so.6 (0x00007f59fe0ab000)
    libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f59fde95000)
    libc.so.6 => /lib64/libc.so.6 (0x00007f59fdb01000)
    /lib64/ld-linux-x86-64.so.2 (0x00000039b3600000)

So for some reason although the build process is recognising the
libraries, it is not storing their location  in the shared object.

This is where my knowledge breaks down. I wonder if I need to force
the build to make static libraries, rather than dynamically linked
ones. But I'm not sure I know what I'm talking about.

Any suggestions would be appreciated.

Mark


From subbu_843 at yahoo.co.in  Tue Feb  4 13:29:52 2014
From: subbu_843 at yahoo.co.in (subash)
Date: Tue, 4 Feb 2014 04:29:52 -0800 (PST)
Subject: [R-sig-Geo] point support variogram in area to point kriging
Message-ID: <1391516992521-7585688.post@n2.nabble.com>

Hi Group,

I am trying to disaggregate remote sensed image data. All the pixels are of
the same size. I understand inorder to disaggregate we need th point support
variogram.

How is it calculated from from the experimental semivariogram of areal data
in R


Thankyou in advance.

Subash



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/point-support-variogram-in-area-to-point-kriging-tp7585688.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Rainer at krugs.de  Tue Feb  4 14:22:08 2014
From: Rainer at krugs.de (Rainer M Krug)
Date: Tue, 04 Feb 2014 14:22:08 +0100
Subject: [R-sig-Geo] Linking problem with rgdal
In-Reply-To: <CAGBzUO-XmNJ=5DE3mCvJ7Ahj1CmJWpKuCSb+mOd40mdUaY6ieA@mail.gmail.com>
References: <CAGBzUO-XmNJ=5DE3mCvJ7Ahj1CmJWpKuCSb+mOd40mdUaY6ieA@mail.gmail.com>
Message-ID: <52F0E980.40809@krugs.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/04/14, 13:23 , Mark Payne wrote:
> Hi,
> 
> I'm trying to install rgdal on a Scientific LInux cluster  which I
> do not have administrator rights. So far, I have done the
> following * Downloaded and installed gdal from source into my home
> directory ie configured with ./configure --prefix=$HOME/R/gdal 
> *Downloaded and install proj4 from source with a similar
> configuration ./configure --prefix=$HOME/R/proj4/
> 
> Next, I try to install the rgdal package specifying the various
> locations
> 
> R CMD INSTALL rgdal_0.8-14.tar.gz 
> --configure-args='--with-proj-lib=$HOME/R/proj4/lib 
> --with-proj-include=$HOME/R/proj4/include 
> --with-gdal-config=$HOME/R/gdal/bin/gdal-config' --preclean 
> --no-clean-on-error
> 
> This generally works up to the point where it tries to do a test
> load, giving the message: .... ** testing if installed package can
> be loaded Error in dyn.load(file, DLLpath = DLLpath, ...) : unable
> to load shared object 
> '/zhome/39/c/38865/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so':
>
> 
libgdal.so.1: cannot open shared object file: No such file or directory
> Error: loading failed Execution halted ERROR: loading failed
> 
> If I check the contents of the shared object: ldd
> ~/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so 
> linux-vdso.so.1 =>  (0x00007fff74dff000) libgdal.so.1 => not found 
> libproj.so.0 => not found libR.so => not found libstdc++.so.6 =>
> /usr/lib64/libstdc++.so.6 (0x00007f59fe330000) libm.so.6 =>
> /lib64/libm.so.6 (0x00007f59fe0ab000) libgcc_s.so.1 =>
> /lib64/libgcc_s.so.1 (0x00007f59fde95000) libc.so.6 =>
> /lib64/libc.so.6 (0x00007f59fdb01000) /lib64/ld-linux-x86-64.so.2
> (0x00000039b3600000)
> 
> So for some reason although the build process is recognising the 
> libraries, it is not storing their location  in the shared object.

I stand to be corrected, as I haven't done this for quite some time:

The paths you specify are for compile time, the ones missing are for
run time. So you have to add the library path of gdal to your library
paths, e.g. via setting the variable LD_LIBRARY_PATH

Hope this helps,

Rainer

> 
> This is where my knowledge breaks down. I wonder if I need to
> force the build to make static libraries, rather than dynamically
> linked ones. But I'm not sure I know what I'm talking about.
> 
> Any suggestions would be appreciated.
> 
> Mark
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJS8OmAAAoJENvXNx4PUvmC/MkH/Am6KkAqbyTf6FukxDrVGKft
3wyHA/Rnb/ujlkVt4/+okjIadE0N9FnKHCFshudDEqvZl2CJdvKedmAE5cERhFS7
actXf8iJKiFklRYlAXIscJ2A7AyKUqIL5NjvDXwiRNLThOvPQ5b4iuv4e9AP18A5
NAfY/zz7pOA2Q2aBvZFFxEX6YC3sLDo2cf8hxZoBpqaTeUpvZ5k0i0ND1FGE82mE
T5mRBfndDnCZ+7f4IMrVxWJ67J55/0DUaisOno2o+zboUckySmYrjLlLQ/q7FcaX
1pRgSPjgff/KLTnYkJgnU4gkvyg50Re5gStzPT3KMJvZhbxpjIIo8zYj3nOEx38=
=Xloy
-----END PGP SIGNATURE-----


From Rainer at krugs.de  Tue Feb  4 15:32:52 2014
From: Rainer at krugs.de (Rainer M Krug)
Date: Tue, 4 Feb 2014 15:32:52 +0100
Subject: [R-sig-Geo] Linking problem with rgdal
In-Reply-To: <CAGBzUO_+fo4KpXHpDFYSu24jbdCjpWeFbnCFijkgaaedBP-Oqg@mail.gmail.com>
References: <CAGBzUO-XmNJ=5DE3mCvJ7Ahj1CmJWpKuCSb+mOd40mdUaY6ieA@mail.gmail.com>	<52F0E980.40809@krugs.de>
	<CAGBzUO_+fo4KpXHpDFYSu24jbdCjpWeFbnCFijkgaaedBP-Oqg@mail.gmail.com>
Message-ID: <52F0FA14.8080302@krugs.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



On 02/04/14, 15:15 , Mark Payne wrote:
> Hi Rainer,
> 
> Thanks for the reply - your memory clearly serves you well,
> although I had to add both proj.4 and gdal to the LD_LIBRARY_PATH
> to get it to work fully ie.
> 
> export
> LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HOME/R/gdal/lib/:$HOME/R/proj4/lib
>
>  I clearly owe you a beer :-)

Great that it works.

When you are in Paris, just let me know...

> 
> I can add this to my .bashrc, so that it is loaded every time I
> login but is there any other "more permanent" solution?

What do you mean by "permanent"?

The advantage of the .bashrc is that it is user specific, i.e.
different users can have different settings and you don't need
administrator privileges. Check out

http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html

for details on shared libraries.

I used the LD_LIBRARY_PATH approach all the time on a cluster as it is
easy and transparent (you see in your .bashrc what you are doing and
not in some other files and can even specify this in your submit
script of the jobs - that is what I did).

A (slightly) different approach would be to install all user installed
libraries into a folder ~/myProgs/lib and then simply add these to the
LD_LIBRARY_PATH. Then you have to specify this when compiling gdal and
proj (if I remember correctly -prefix=$HOME/myProgs will do it). But
then you still have to add $HOME/myProgs/lib to LD_LIBRARY_PATH - but
then only that one.

Cheers,

Rainer

> 
> Best wishes,
> 
> Mark
> 
> 
> On 4 February 2014 14:22, Rainer M Krug <Rainer at krugs.de> wrote: On
> 02/04/14, 13:23 , Mark Payne wrote:
>>>> Hi,
>>>> 
>>>> I'm trying to install rgdal on a Scientific LInux cluster
>>>> which I do not have administrator rights. So far, I have done
>>>> the following * Downloaded and installed gdal from source
>>>> into my home directory ie configured with ./configure
>>>> --prefix=$HOME/R/gdal *Downloaded and install proj4 from
>>>> source with a similar configuration ./configure
>>>> --prefix=$HOME/R/proj4/
>>>> 
>>>> Next, I try to install the rgdal package specifying the
>>>> various locations
>>>> 
>>>> R CMD INSTALL rgdal_0.8-14.tar.gz 
>>>> --configure-args='--with-proj-lib=$HOME/R/proj4/lib 
>>>> --with-proj-include=$HOME/R/proj4/include 
>>>> --with-gdal-config=$HOME/R/gdal/bin/gdal-config' --preclean 
>>>> --no-clean-on-error
>>>> 
>>>> This generally works up to the point where it tries to do a
>>>> test load, giving the message: .... ** testing if installed
>>>> package can be loaded Error in dyn.load(file, DLLpath =
>>>> DLLpath, ...) : unable to load shared object 
>>>> '/zhome/39/c/38865/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so':
>>>>
>>>>
>
>>>> 
libgdal.so.1: cannot open shared object file: No such file or directory
>>>> Error: loading failed Execution halted ERROR: loading failed
>>>> 
>>>> If I check the contents of the shared object: ldd 
>>>> ~/R/x86_64-unknown-linux-gnu-library/3.0/rgdal/libs/rgdal.so 
>>>> linux-vdso.so.1 =>  (0x00007fff74dff000) libgdal.so.1 => not
>>>> found libproj.so.0 => not found libR.so => not found
>>>> libstdc++.so.6 => /usr/lib64/libstdc++.so.6
>>>> (0x00007f59fe330000) libm.so.6 => /lib64/libm.so.6
>>>> (0x00007f59fe0ab000) libgcc_s.so.1 => /lib64/libgcc_s.so.1
>>>> (0x00007f59fde95000) libc.so.6 => /lib64/libc.so.6
>>>> (0x00007f59fdb01000) /lib64/ld-linux-x86-64.so.2 
>>>> (0x00000039b3600000)
>>>> 
>>>> So for some reason although the build process is recognising
>>>> the libraries, it is not storing their location  in the
>>>> shared object.
> 
> I stand to be corrected, as I haven't done this for quite some
> time:
> 
> The paths you specify are for compile time, the ones missing are
> for run time. So you have to add the library path of gdal to your
> library paths, e.g. via setting the variable LD_LIBRARY_PATH
> 
> Hope this helps,
> 
> Rainer
> 
>>>> 
>>>> This is where my knowledge breaks down. I wonder if I need
>>>> to force the build to make static libraries, rather than
>>>> dynamically linked ones. But I'm not sure I know what I'm
>>>> talking about.
>>>> 
>>>> Any suggestions would be appreciated.
>>>> 
>>>> Mark
>>>> 
>>>> _______________________________________________ R-sig-Geo
>>>> mailing list R-sig-Geo at r-project.org 
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
> 

- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJS8PoUAAoJENvXNx4PUvmCN/YH/1dHnCXWeXiPJtXr0zO4czng
ptYstz/wsyDoRlUQsWRyum3BZ/edMDi3rlsS1+Z3Tp1QayS/o8s7Ri5pwee4dbqQ
7ezLpfz2pnmavhRJGPM6lxX+MbrJSgRxZpJ71x4GUVU5jjPE7mehR1mt7XhpCFOV
zj1/5Yp0fO3ilP6/fwDtn8x7fUwpi9iUHU7Dvq0pzq+tAr7WqLtG+39K8WqoyYBP
4vrf/iARFFHV93RPePvIljFH/7nS3GxvcLKnZU15QtqnECGaEBzq1Um0O7c7nTgB
lPIO0WDvkaD/lCExAVg/qyz4CblDZ+aMIhZi40evYn8gFcWzmH6AqV6KsRuLS5c=
=Z8Oe
-----END PGP SIGNATURE-----


From mauriziomarchi85 at gmail.com  Wed Feb  5 10:01:54 2014
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Wed, 5 Feb 2014 10:01:54 +0100
Subject: [R-sig-Geo] BIOMOD or biomod2
Message-ID: <CANJhsN1uTdQS4mmbaX=SnXSsC0Qg+1Mw4m8sL-5hVCSRkAgwYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140205/1e777c10/attachment.pl>

From eddieatr at gmail.com  Wed Feb  5 10:07:49 2014
From: eddieatr at gmail.com (eddie)
Date: Wed, 5 Feb 2014 01:07:49 -0800 (PST)
Subject: [R-sig-Geo] Batch conver from img to rst
In-Reply-To: <1382791202974-7584972.post@n2.nabble.com>
References: <CABaJH7838Gv9D7t3S+rd+WFkjtpWvA__TN2GbWUDXK5eDTJZ5w@mail.gmail.com>
	<1382791202974-7584972.post@n2.nabble.com>
Message-ID: <1391591269624-7585693.post@n2.nabble.com>

Dear Amcilwee,

Thank you very much!

The script works.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Batch-conver-from-img-to-rst-tp7584636p7585693.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From wilfried.thuiller at ujf-grenoble.fr  Wed Feb  5 10:08:08 2014
From: wilfried.thuiller at ujf-grenoble.fr (Wilfried Thuiller)
Date: Wed, 5 Feb 2014 10:08:08 +0100
Subject: [R-sig-Geo] BIOMOD or biomod2
In-Reply-To: <CANJhsN1uTdQS4mmbaX=SnXSsC0Qg+1Mw4m8sL-5hVCSRkAgwYQ@mail.gmail.com>
References: <CANJhsN1uTdQS4mmbaX=SnXSsC0Qg+1Mw4m8sL-5hVCSRkAgwYQ@mail.gmail.com>
Message-ID: <90F5A255-B885-4799-9AC4-A044E6F11395@ujf-grenoble.fr>

Dear Maurizio,

biomod2 is the upgrade of BIOMOD. Both are available on R-Forge, biomod2 is also available on CRAN. 
biomod2 is completely object-oriented and the only package maintained (BIOMOD is not anymore). 

https://r-forge.r-project.org/projects/biomod/
http://cran.r-project.org/web/packages/biomod2/biomod2.pdf

Hope it helps,

Wilfried






Le 5 f?vr. 2014 ? 10:01, Maurizio Marchi <mauriziomarchi85 at gmail.com> a ?crit :

> Hi everybody,
> I performed some species distribution models with many different methods
> and libraries (dismo, mgcv, rpart, randomForest, maxent, gbm, earth, e1071,
> ecc..) but in many papers the BIOMOD package is sed for the same methods
> and also for consensus projection.
> I tried to find information about BIOMOD package but I didn't find what are
> differences with biomod2 package. Are the same?
> 
> THANKS,
> ----------
> Maurizio Marchi, Ph.D student
> CRA-SEL, Centro di Ricerca per la Selvicoltura
> (Forestry Research Centre)
> http://www.selvicoltura.eu/cont_E_5079_20554.phtml
> ID skype: maurizioxyz
> Ubuntu 12.04 LTS - linux user 552.742
> ###
> www.trees4future.eu/about/project-structure/wp8.html
> www.eufgis.org
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-----------------------------
Dr. Wilfried Thuiller
Laboratoire d'Ecologie Alpine, UMR CNRS 5553
Universit? Joseph Fourier
BP53, 38041 Grenoble cedex 9, France
tel: +33 (0)4 76 51 44 97
fax: +33 (0)4 76 51 42 79

Email: wilfried.thuiller at ujf-grenoble.fr
Personal website: http://www.will.chez-alice.fr
Team website: http://www-leca.ujf-grenoble.fr/equipes/emabio.htm

ERC Starting Grant TEEMBIO project: http://www.will.chez-alice.fr/Research.html


From paulojus at c3sl.ufpr.br  Wed Feb  5 14:03:40 2014
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 5 Feb 2014 11:03:40 -0200 (BRST)
Subject: [R-sig-Geo] GSLM in binary data set
In-Reply-To: <1055169489.3570084.1391451601933.JavaMail.zimbra@ifop.cl>
References: <1055169489.3570084.1391451601933.JavaMail.zimbra@ifop.cl>
Message-ID: <alpine.DEB.2.02.1402051059150.6650@macalan.c3sl.ufpr.br>

Carolina

The MCMC engine behind geoRglm
needs to be tunned.
S.scale is the tunning parameter for the spatial random effects.
It need to be choosen such that acceptence rates (reported by the 
following functions to be used) are about 60-65%.
So don't expect to get it right at a first try, this is a try and error 
exercise

The other parameters are initial guesses and it would be better of 
compatible with your data.
For instance you could use values from a standard GLM to set beta,
the overdispersion to set sigmasq and a variogram of the residuals
for phi.
The latter needs to be compatible with the distances within 
the study area so alternativelly you could try something
  1/10 of the maximum interpoints distances




On Mon, 3 Feb 2014, carolina.lang at ifop.cl wrote:

> Hello everybody,
> I??m new in this forus and first i will like to congratulate for this space where people share opinions and knowledge. Well, i??m working with a binary spatial data set that were collected in an hydroacustic survey, and i want to apply GLSM, but i have some queries i took this example routine:
>
> 1#require(geoR);require(geoRglm)
> 2#van10<-as.geodata(area11,coords.col=8:9,data.col=10)
> 3#model.5 = list(cov.pars=c(1,1),cov.model='exponential',beta=1,family="binomial")
> 4#mcmc.5 = mcmc.control(S.scale = 0.25, n.iter = 30000, burn.in=50000, thin = 100)
>
> How do i define the parameters in thirth line (cov.pars and beta) and fourth line ( s.scale, burn.in and thin). I suppose that change in this parameters affects final results. Anyway i don??t have any graphics about spatial correlation in data and estimate a priori parameters like in classical geostatistics (experimental variogram).
>
> greetings, Carolina
>
>
>
>
> ------------------------------------------------------------------------------------------------
> Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica, Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco, pesquer?as industriales y artesanales)
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>


From carolina.lang at ifop.cl  Wed Feb  5 15:35:05 2014
From: carolina.lang at ifop.cl (carolina.lang at ifop.cl)
Date: Wed, 5 Feb 2014 11:35:05 -0300 (CLST)
Subject: [R-sig-Geo] GSLM in binary data set
In-Reply-To: <alpine.DEB.2.02.1402051059150.6650@macalan.c3sl.ufpr.br>
References: <1055169489.3570084.1391451601933.JavaMail.zimbra@ifop.cl>
	<alpine.DEB.2.02.1402051059150.6650@macalan.c3sl.ufpr.br>
Message-ID: <512310474.3735338.1391610905824.JavaMail.zimbra@ifop.cl>

Ok Paulo, i really appreciate your time and your answer was very helpful!!!

	

Carolina Lang Abarz??a 
Investigador 
Instituto de Fomento Pesquero 
Av. Blanco #839, Valparaiso, Chile. 
Fono: (32) 2151572 

www.ifop.cl 



----- Mensaje original -----
De: "Paulo Justiniano Ribeiro Jr" <paulojus at c3sl.ufpr.br>
Para: "carolina lang" <carolina.lang at ifop.cl>
CC: r-sig-geo at r-project.org
Enviados: Mi??rcoles, 5 de Febrero 2014 9:03:40
Asunto: Re: [R-sig-Geo] GSLM in binary data set

Carolina

The MCMC engine behind geoRglm
needs to be tunned.
S.scale is the tunning parameter for the spatial random effects.
It need to be choosen such that acceptence rates (reported by the 
following functions to be used) are about 60-65%.
So don't expect to get it right at a first try, this is a try and error 
exercise

The other parameters are initial guesses and it would be better of 
compatible with your data.
For instance you could use values from a standard GLM to set beta,
the overdispersion to set sigmasq and a variogram of the residuals
for phi.
The latter needs to be compatible with the distances within 
the study area so alternativelly you could try something
  1/10 of the maximum interpoints distances




On Mon, 3 Feb 2014, carolina.lang at ifop.cl wrote:

> Hello everybody,
> I??m new in this forus and first i will like to congratulate for this space where people share opinions and knowledge. Well, i??m working with a binary spatial data set that were collected in an hydroacustic survey, and i want to apply GLSM, but i have some queries i took this example routine:
>
> 1#require(geoR);require(geoRglm)
> 2#van10<-as.geodata(area11,coords.col=8:9,data.col=10)
> 3#model.5 = list(cov.pars=c(1,1),cov.model='exponential',beta=1,family="binomial")
> 4#mcmc.5 = mcmc.control(S.scale = 0.25, n.iter = 30000, burn.in=50000, thin = 100)
>
> How do i define the parameters in thirth line (cov.pars and beta) and fourth line ( s.scale, burn.in and thin). I suppose that change in this parameters affects final results. Anyway i don??t have any graphics about spatial correlation in data and estimate a priori parameters like in classical geostatistics (experimental variogram).
>
> greetings, Carolina
>
>
>
>
> ------------------------------------------------------------------------------------------------
> Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica, Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco, pesquer?as industriales y artesanales)
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>


------------------------------------------------------------------------------------------------
Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica, Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco, pesquer?as industriales y artesanales)


     


From tkeitt at utexas.edu  Wed Feb  5 17:47:39 2014
From: tkeitt at utexas.edu (Tim Keitt)
Date: Wed, 5 Feb 2014 10:47:39 -0600
Subject: [R-sig-Geo] Short course at UT Austin
Message-ID: <CANnL8go3PWZbAzPTTeKL9ar5ZFikk_ggK==Y_sDzjNUMV4hVpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140205/06f13530/attachment.pl>

From jgrn at illinois.edu  Thu Feb  6 06:14:32 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 5 Feb 2014 23:14:32 -0600
Subject: [R-sig-Geo] Batch conver from img to rst
In-Reply-To: <1391591269624-7585693.post@n2.nabble.com>
References: <CABaJH7838Gv9D7t3S+rd+WFkjtpWvA__TN2GbWUDXK5eDTJZ5w@mail.gmail.com>
	<1382791202974-7584972.post@n2.nabble.com>
	<1391591269624-7585693.post@n2.nabble.com>
Message-ID: <CABG0rftF23Qs33=uDNPK=FmnkgYXVJ22i1PWd4H7n684piLhyg@mail.gmail.com>

Eddie:

You can also use my batch_gdal_translate function in the gdalUtils
package to do more rapid translation of a lot of files.

--j

On Wed, Feb 5, 2014 at 3:07 AM, eddie <eddieatr at gmail.com> wrote:
> Dear Amcilwee,
>
> Thank you very much!
>
> The script works.
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Batch-conver-from-img-to-rst-tp7584636p7585693.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From Roger.Bivand at nhh.no  Thu Feb  6 10:22:13 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 6 Feb 2014 10:22:13 +0100
Subject: [R-sig-Geo] error in compiling rgdal 0.8-14
In-Reply-To: <alpine.LRH.2.03.1401241739150.15688@reclus.nhh.no>
References: <CAHeOUhwzRvmawzsCus=yMB9xjXbKOBGMKe1uR2oKFjNLWyJfPQ@mail.gmail.com>
	<CAHeOUhwcPE6WOPDf6-PYMaJkDahWQwQi7j893iJYRrdUwjm03Q@mail.gmail.com>
	<alpine.LRH.2.03.1401241739150.15688@reclus.nhh.no>
Message-ID: <alpine.LRH.2.03.1402061019510.30368@reclus.nhh.no>

rgdal 0.8-15 just accepted on CRAN now works with the forthcoming PROJ 
4.9.0. It has been tested with 4.7.1 and 4.8.0 too, so should be backward 
compatible.

Roger

On Fri, 24 Jan 2014, Roger Bivand wrote:

> On Fri, 24 Jan 2014, Annalisa Minelli wrote:
>
>> I correct myself anch close the task.
>
> But a very useful heads-up, so that rgdal can be prepared for use with the 
> development version of proj, so at its next release, rgdal should also 
> support > 4.8.
>
> Roger
>
>> I was working on proj trunk  when I experienced this problem. I parallel
>> have another installation where rgdal had no problem and it was compiled
>> under PROJ 4.8 instead.
>> So I downloaded and recompiled the proj 4.8, added the right paths and now
>> it works.
>> 
>> Sorry for the mail.
>> 
>> Annalisa
>> 
>> 
>> 2014/1/24 Annalisa Minelli <annagfoss at gmail.com>
>> 
>>> Dear all,
>>> I freshly compiled my SIG tools on my fresh linux installation (Ubuntu
>>> 12.04 LTS).
>>> I compiled GDAL and PROJ (v.4.9) too.
>>> The problem is that when I install rgdal by package using the command:
>>> 
>>> R CMD INSTALL --configure-args='--with-proj-include=/usr/local/includes/
>>> --with-proj-lib=/usr/local/lib/proj --with-proj-share=/usr/share/proj/'
>>> /home/infolab/Downloads/rgdal
>>> 
>>> I receive the following error:
>>> 
>>> ...
>>> checking PROJ.4 Version 4.7 or earlier... no
>>> configure: PROJ_LIB: /usr/share/proj/
>>> proj_conf_test.c:3:7: error: conflicting types for 'pj_open_lib'
>>> /usr/local/include/proj_api.h:146:8: note: previous declaration of
>>> 'pj_open_lib' was here
>>> ...
>>> 
>>> so not only seems not to find PROJ library (despite of the arguments
>>> passed), but it seems encoutering an internal conflict with the file
>>> proj_api.h
>>> 
>>> I compiled both proj and gdal, and no other conflicting copies are
>>> installed (e.g. by package).
>>> 
>>> Here there's the url to the complete output of the command:
>>> http://pastebin.com/embed_iframe.php?i=KqhPyTiy
>>> 
>>> 
>>> Any idea/suggestion is well accepted.
>>> Annalisa
>>> 
>>> 
>>> 
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From abdoulayesar at gmail.com  Thu Feb  6 12:12:02 2014
From: abdoulayesar at gmail.com (Abdoulaye Sarr)
Date: Thu, 6 Feb 2014 11:12:02 +0000
Subject: [R-sig-Geo] call a fortan prog into R
Message-ID: <CAN=6O0+XY76q43vjZn1_UZ=EorBAB7SN36kMr_4e-F9ye+O9Fg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140206/0057638a/attachment.pl>

From dicko.ahmadou at gmail.com  Thu Feb  6 12:48:24 2014
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Thu, 6 Feb 2014 11:48:24 +0000
Subject: [R-sig-Geo] call a fortan prog into R
In-Reply-To: <CAN=6O0+XY76q43vjZn1_UZ=EorBAB7SN36kMr_4e-F9ye+O9Fg@mail.gmail.com>
References: <CAN=6O0+XY76q43vjZn1_UZ=EorBAB7SN36kMr_4e-F9ye+O9Fg@mail.gmail.com>
Message-ID: <CAP8THHXG9eMCWZURs2iHoZfjJVbTfYFbZ_2g7BtycQa8ZvEWBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140206/74c8d364/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Feb  6 12:50:38 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 06 Feb 2014 12:50:38 +0100
Subject: [R-sig-Geo] call a fortan prog into R
In-Reply-To: <CAN=6O0+XY76q43vjZn1_UZ=EorBAB7SN36kMr_4e-F9ye+O9Fg@mail.gmail.com>
References: <CAN=6O0+XY76q43vjZn1_UZ=EorBAB7SN36kMr_4e-F9ye+O9Fg@mail.gmail.com>
Message-ID: <52F3770E.9030500@uni-muenster.de>

In the manuals,

http://cran.r-project.org/manuals.html

look for and read "Writing R extensions".

On 02/06/2014 12:12 PM, Abdoulaye Sarr wrote:
> Hi all,
> 
> I have a fortan program to compute a climate index at point and is
> wondering if it is possible to call this function into R and apply to a
> gridded dataset in netcdf.
> 
> Guidance highly appreciate from someone with basic knowledge in R.
> 
> Best,
> 
> as
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140206/70393d12/attachment.bin>

From michel.arnaud at cirad.fr  Thu Feb  6 14:21:25 2014
From: michel.arnaud at cirad.fr (Arnaud Michel)
Date: Thu, 6 Feb 2014 14:21:25 +0100
Subject: [R-sig-Geo] To map population of European countries from Eurostat
Message-ID: <52F38C55.8010709@cirad.fr>

Hello
I would like to map the population of the European countries in 2011.
I am using the spatial shapefiles of Europe published by EUROSTAT.
I applyed the script below of Markus Kainubut but I had a problem with 
the map.

Any ideas ?
Thanks for your help

#########################################
# Importing the data
library(SmarterPoland)
df <- getEurostatRaw(kod = "tps00001")

# rename 1ere variable
names(df) <- c("xx", 2002:2013)

# new variable df$unit et df$geo.time
df$unit <- lapply(strsplit(as.character(df$xx), ","), "[", 1)
df$geo.time <- lapply(strsplit(as.character(df$xx), ","), "[", 2)

# file df.l
df.l <- melt(data = df, id.vars = "geo.time", measure.vars = c("2002", 
"2003",
"2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", 
"2013"))

df.l$geo.time <- unlist(df.l$geo.time)  # unlist the geo.time variable

# Load the shapefile GISCO, subset it to NUTS2-level
# and merge the Eurostat
# attribute data with it into single SpatialPolygonDataFrame

Filetodownload <- 
"http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/NUTS_2010_60M_SH.zip"
download.file(Filetodownload, destfile = "NUTS_2010_60M_SH.zip")
rm(Filetodownload)

# Unzip NUTS_2010_60M_SH.zip to SpatialPolygonsDataFrame
unzip("NUTS_2010_60M_SH.zip")

library(rgdal)
# Lecture du fichier
map <- readOGR(dsn = "./NUTS_2010_60M_SH/data", layer = "NUTS_RG_60M_2010")
# OGR data source with driver: ESRI Shapefile
# Source: "./NUTS_2010_60M_SH/data", layer: "NUTS_RG_60M_2010"
# with 1920 features and 4 fields
# Feature type: wkbPolygon with 2 dimensions

names(map)
#[1] "NUTS_ID"    "STAT_LEVL_" "SHAPE_Leng" "SHAPE_Area"

# as the data is at NUTS2-level, we subset the
# spatialpolygondataframe
map_nuts2 <- subset(map, STAT_LEVL_ <= 2)

# dim show how many regions are in the spatialpolygondataframe
dim(map_nuts2)
## [1] 467   4

# dim show how many regions are in the data.frame
dim(df)
## [1] 43  15

################################################################
# Spatial dataframe has 467 rows and attribute data 43.  We need to make
# attribute data to have similar number of rows
NUTS_ID <- as.character(map_nuts2$NUTS_ID)
VarX <- rep("empty", 467)
dat <- data.frame(NUTS_ID, VarX)

# then we shall merge this with Eurostat data.frame
dat2 <- merge(dat, df, by.x = "NUTS_ID", by.y = "geo.time", all.x = TRUE)

## merge this manipulated attribute data with the spatialpolygondataframe
## there are still duplicates in the data, remove them
dat2$dup <- duplicated(dat2$NUTS_ID)
dat3 <- subset(dat2, dup == FALSE)

## rownames
row.names(dat3) <- dat3$NUTS_ID
row.names(map_nuts2) <- as.character(map_nuts2$NUTS_ID)

## order data
dat3 <- dat3[order(row.names(dat3)), ]
map_nuts2 <- map_nuts2[order(row.names(map_nuts2)), ]

## join
library(maptools)
shape <- spCbind(map_nuts2, dat3)

##########################################################################
# Munging the shapefile into data.frame and ready for ggplot-plotting

## fortify spatialpolygondataframe into data.frame
library(ggplot2)
library(rgeos)
shape$id <- rownames(shape at data)
map.points <- fortify(shape, region = "id")
map.df <- merge(map.points, shape, by = "id")

###############################################################
# Only year 2011
# As we want to plot map faceted by years from 2003 to 2011 we have to
# melt it into long format
map.df <- map.df[, -c(15:23,25,26)]
library(reshape2)

map.df.l <- melt(data = map.df, id.vars = c("id", "long", "lat", 
"group"), measure.vars = c("X2011"))

# year variable (variable) is class string and type X20xx.  Lets remove
# the X and convert it to numerical

library(stringr)
map.df.l$variable <- str_replace_all(map.df.l$variable, "X", "")
map.df.l$variable <- factor(map.df.l$variable)
map.df.l$variable <- 
as.numeric(levels(map.df.l$variable))[map.df.l$variable]

# And finally the plot using ggplot2
#Map shows proportion of materially deprived households at the NUTS2 level.
#Grey color indicates missing data.


library(ggplot2)

ggplot(map.df.l, aes(long,lat,group=group)) +
geom_polygon(aes(fill = value)) +
geom_polygon(data = map.df.l, aes(long,lat),
fill=NA, color = "white",
size=0.1) + # white borders
coord_map(project="orthographic", xlim=c(-22,34), ylim=c(35,70)) + # proj
labs(title = "Cartographie") +
theme_minimal()

-- 
Michel ARNAUD
Charg? de mission aupr?s du DRH
DGDRD-Drh - TA 174/04
Av Agropolis 34398 Montpellier cedex 5
tel : 04.67.61.75.38
fax : 04.67.61.57.87
port: 06.47.43.55.31


From michel.arnaud at cirad.fr  Thu Feb  6 14:21:25 2014
From: michel.arnaud at cirad.fr (Arnaud Michel)
Date: Thu, 06 Feb 2014 14:21:25 +0100
Subject: [R-sig-Geo] To map population of European countries from Eurostat
Message-ID: <52F38C55.8010709@cirad.fr>

Hello
I would like to map the population of the European countries in 2011.
I am using the spatial shapefiles of Europe published by EUROSTAT.
I applyed the script below of Markus Kainubut but I had a problem with 
the map.

Any ideas ?
Thanks for your help

#########################################
# Importing the data
library(SmarterPoland)
df <- getEurostatRaw(kod = "tps00001")

# rename 1ere variable
names(df) <- c("xx", 2002:2013)

# new variable df$unit et df$geo.time
df$unit <- lapply(strsplit(as.character(df$xx), ","), "[", 1)
df$geo.time <- lapply(strsplit(as.character(df$xx), ","), "[", 2)

# file df.l
df.l <- melt(data = df, id.vars = "geo.time", measure.vars = c("2002", 
"2003",
"2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", 
"2013"))

df.l$geo.time <- unlist(df.l$geo.time)  # unlist the geo.time variable

# Load the shapefile GISCO, subset it to NUTS2-level
# and merge the Eurostat
# attribute data with it into single SpatialPolygonDataFrame

Filetodownload <- 
"http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/NUTS_2010_60M_SH.zip"
download.file(Filetodownload, destfile = "NUTS_2010_60M_SH.zip")
rm(Filetodownload)

# Unzip NUTS_2010_60M_SH.zip to SpatialPolygonsDataFrame
unzip("NUTS_2010_60M_SH.zip")

library(rgdal)
# Lecture du fichier
map <- readOGR(dsn = "./NUTS_2010_60M_SH/data", layer = "NUTS_RG_60M_2010")
# OGR data source with driver: ESRI Shapefile
# Source: "./NUTS_2010_60M_SH/data", layer: "NUTS_RG_60M_2010"
# with 1920 features and 4 fields
# Feature type: wkbPolygon with 2 dimensions

names(map)
#[1] "NUTS_ID"    "STAT_LEVL_" "SHAPE_Leng" "SHAPE_Area"

# as the data is at NUTS2-level, we subset the
# spatialpolygondataframe
map_nuts2 <- subset(map, STAT_LEVL_ <= 2)

# dim show how many regions are in the spatialpolygondataframe
dim(map_nuts2)
## [1] 467   4

# dim show how many regions are in the data.frame
dim(df)
## [1] 43  15

################################################################
# Spatial dataframe has 467 rows and attribute data 43.  We need to make
# attribute data to have similar number of rows
NUTS_ID <- as.character(map_nuts2$NUTS_ID)
VarX <- rep("empty", 467)
dat <- data.frame(NUTS_ID, VarX)

# then we shall merge this with Eurostat data.frame
dat2 <- merge(dat, df, by.x = "NUTS_ID", by.y = "geo.time", all.x = TRUE)

## merge this manipulated attribute data with the spatialpolygondataframe
## there are still duplicates in the data, remove them
dat2$dup <- duplicated(dat2$NUTS_ID)
dat3 <- subset(dat2, dup == FALSE)

## rownames
row.names(dat3) <- dat3$NUTS_ID
row.names(map_nuts2) <- as.character(map_nuts2$NUTS_ID)

## order data
dat3 <- dat3[order(row.names(dat3)), ]
map_nuts2 <- map_nuts2[order(row.names(map_nuts2)), ]

## join
library(maptools)
shape <- spCbind(map_nuts2, dat3)

##########################################################################
# Munging the shapefile into data.frame and ready for ggplot-plotting

## fortify spatialpolygondataframe into data.frame
library(ggplot2)
library(rgeos)
shape$id <- rownames(shape at data)
map.points <- fortify(shape, region = "id")
map.df <- merge(map.points, shape, by = "id")

###############################################################
# Only year 2011
# As we want to plot map faceted by years from 2003 to 2011 we have to
# melt it into long format
map.df <- map.df[, -c(15:23,25,26)]
library(reshape2)

map.df.l <- melt(data = map.df, id.vars = c("id", "long", "lat", 
"group"), measure.vars = c("X2011"))

# year variable (variable) is class string and type X20xx.  Lets remove
# the X and convert it to numerical

library(stringr)
map.df.l$variable <- str_replace_all(map.df.l$variable, "X", "")
map.df.l$variable <- factor(map.df.l$variable)
map.df.l$variable <- 
as.numeric(levels(map.df.l$variable))[map.df.l$variable]

# And finally the plot using ggplot2
#Map shows proportion of materially deprived households at the NUTS2 level.
#Grey color indicates missing data.


library(ggplot2)

ggplot(map.df.l, aes(long,lat,group=group)) +
geom_polygon(aes(fill = value)) +
geom_polygon(data = map.df.l, aes(long,lat),
fill=NA, color = "white",
size=0.1) + # white borders
coord_map(project="orthographic", xlim=c(-22,34), ylim=c(35,70)) + # proj
labs(title = "Cartographie") +
theme_minimal()

-- 
Michel ARNAUD
Charg? de mission aupr?s du DRH
DGDRD-Drh - TA 174/04
Av Agropolis 34398 Montpellier cedex 5
tel : 04.67.61.75.38
fax : 04.67.61.57.87
port: 06.47.43.55.31


From agus.camacho at gmail.com  Thu Feb  6 21:46:57 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 6 Feb 2014 18:46:57 -0200
Subject: [R-sig-Geo] maxent function from dismo package does not find
	maxent.jar file
Message-ID: <CALsJ7pSe1EAPurdO+oQnpwTYZ8ezEBpV-AvGFFTy2B_+7XPSAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140206/c6fda7ca/attachment.pl>

From afischbach at usgs.gov  Fri Feb  7 00:24:50 2014
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Thu, 6 Feb 2014 15:24:50 -0800 (PST)
Subject: [R-sig-Geo] plotKML with multi-lingual output
Message-ID: <1391729090085-7585705.post@n2.nabble.com>

I wish to produce a KML containing point and line features that have field
names and field contents in both the Latin and Cyrillic alphabets.  
Below is a toy example showing the problem.

require(plotKML)
setwd('D:/Temp')  ## house keeping specify working directory
data(bigfoot) ## Load a data frame with point features
big<-bigfoot[1:3,]  ## take just the first 3 rows
Sys.setlocale(category='LC_CTYPE', locale='Russian_Russia.1251')  ## Enable
Cyrillic encoding
big$???????.????????<-paste('????', seq(1:3))  ## create a column using
Cyrillic encoding
coordinates(big)<-c('Lon','Lat') ## Cast as SpatialPointsDataFrame
proj4string(big)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs") 
## assign a coordinate reference system
## Take a quick look at it
plot(big)
text(big$Lon, big$Lat, big$???????.????????)
## I can see the points and the new Cyrillic names

kml_open(file.name='Big.kml', folder.name = '????', kml_visibility=TRUE )
	## Build the point haulouts
	kml_layer.SpatialPoints(obj=big, points_names=big at data$???????.????????, 
	colour='green',  LabelScale=0.8,
shape='http://plotkml.r-forge.r-project.org/3Dballyellow.png',
	alpha=0.6, balloon=TRUE) ##  
	## Build the line feature haulouts
	##kml_layer.Spatial
kml_close(file.name='Big.kml')
## End Example Code

Below is an excerpt of the resulting kml file.
Please note the Cyrillic has been garbled.

      <Placemark>
        <name>???????? 1</name>
        <styleUrl>#pnt1</styleUrl>
        <description></description>
        <Point>
          <extrude>1</extrude>
          <altitudeMode>clampToGround</altitudeMode>
          <coordinates>-142.90000,61.50000,0</coordinates>
        </Point>
      </Placemark>

> sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: i386-w64-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=Russian_Russia.1251          
LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United
States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_1.0-14     plotKML_0.4-2

loaded via a namespace (and not attached):
 [1] aqp_1.6             class_7.3-9         classInt_0.1-21    
cluster_1.14.4      colorRamps_2.3      colorspace_1.2-4   
 [7] dichromat_2.0-0     dismo_0.9-3         e1071_1.6-2        
Formula_1.1-1       grid_3.0.1          gstat_1.0-18       
[13] Hmisc_3.14-0        intervals_0.14.0    labeling_0.2       
lattice_0.20-24     latticeExtra_0.6-26 munsell_0.4.2      
[19] pixmap_0.4-11       plotrix_3.5-3       plyr_1.8           
raster_2.2-12       RColorBrewer_1.0-5  reshape_0.8.4      
[25] rgdal_0.8-13        RSAGA_0.93-6        scales_0.2.3       
spacetime_1.0-9     splines_3.0.1       stringr_0.6.2      
[31] survival_2.37-7     tools_3.0.1         XML_3.98-1.1        xts_0.9-7          
zoo_1.7-10  




-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotKML-with-multi-lingual-output-tp7585705.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From kji2080 at gmail.com  Fri Feb  7 02:52:09 2014
From: kji2080 at gmail.com (Jooil Kim)
Date: Thu, 6 Feb 2014 17:52:09 -0800
Subject: [R-sig-Geo] Layering text outside the plot region in a levelplot
Message-ID: <CANOSwXx7hBi3gTA58qs5kavhwHs2O7aPPbHPmhnkPfb+khAhCQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140206/5188271e/attachment.pl>

From r.hijmans at gmail.com  Fri Feb  7 07:35:50 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 6 Feb 2014 22:35:50 -0800
Subject: [R-sig-Geo] maxent function from dismo package does not find
 maxent.jar file
In-Reply-To: <CALsJ7pSe1EAPurdO+oQnpwTYZ8ezEBpV-AvGFFTy2B_+7XPSAg@mail.gmail.com>
References: <CALsJ7pSe1EAPurdO+oQnpwTYZ8ezEBpV-AvGFFTy2B_+7XPSAg@mail.gmail.com>
Message-ID: <CANtt_hy9pVacG26W4euFRGC-JAMS=z0RuQrUt171sVxxr4K4vw@mail.gmail.com>

HI Agus,

The obvious answer is that you should copy maxent.jar from
C:\Users\User\Documents\R\win-library\3.0\dismo\java to
C:/Users/User/Documents/Documents/R/win-library/3.0/dismo/java/

Or are you saying that this folder does not exist? That would be odd. What does

system.file(package = "dismo")

return? Apparently this:

"C:/Users/User/Documents/Documents/R/win-library/3.0/dismo"

Always include sessionInfo() when asking questions about apparent bugs.

Robert

On Thu, Feb 6, 2014 at 12:46 PM, Agus Camacho <agus.camacho at gmail.com> wrote:
> Dear list,
>
> When using maxent from the dismo package, Im recently finding the following
> error:
>
> Error in .getMeVersion() : file missing:
> C:/Users/User/Documents/Documents/R/win-library/3.0/dismo/java/maxent.jar.
> Please download it here: http://www.cs.princeton.edu/~schapire/maxent/
>
> The "missing" file is actually located at:
> C:\Users\User\Documents\R\win-library\3.0\dismo\java
>
> Note that R is searching for the file using"../Documents/Documents/.."
> instead of "... /Documents/..."
>
> Anybody could tell me how avoid this?
>
> Thanks in advance.
> Agus
>
>
> --
> Agust?n Camacho Guerrero.
> Doutor em Zoologia.
> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
> Bioci?ncias, USP.
> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
> S?o Paulo - SP, CEP: 05508-090, Brasil.
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jon.skoien at jrc.ec.europa.eu  Fri Feb  7 10:38:38 2014
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Fri, 07 Feb 2014 10:38:38 +0100
Subject: [R-sig-Geo] [R] To map population of European countries from
	Eurostat
In-Reply-To: <52F38C55.8010709@cirad.fr>
References: <52F38C55.8010709@cirad.fr>
Message-ID: <52F4A99E.4010001@jrc.ec.europa.eu>

Michel,

I am no expert on ggplot2 and cannot explain why, but it seems the NAs 
in map.df.l$value cause some problems. Try to remove them before 
plotting or examine your code to figure out why you get them. They seem 
to be on the borders between NUTS2-level objects.

Best wishes,
Jon


On 06-Feb-14 14:21, Arnaud Michel wrote:
> Hello
> I would like to map the population of the European countries in 2011.
> I am using the spatial shapefiles of Europe published by EUROSTAT.
> I applyed the script below of Markus Kainubut but I had a problem with 
> the map.
>
> Any ideas ?
> Thanks for your help
>
> #########################################
> # Importing the data
> library(SmarterPoland)
> df <- getEurostatRaw(kod = "tps00001")
>
> # rename 1ere variable
> names(df) <- c("xx", 2002:2013)
>
> # new variable df$unit et df$geo.time
> df$unit <- lapply(strsplit(as.character(df$xx), ","), "[", 1)
> df$geo.time <- lapply(strsplit(as.character(df$xx), ","), "[", 2)
>
> # file df.l
> df.l <- melt(data = df, id.vars = "geo.time", measure.vars = c("2002", 
> "2003",
> "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", 
> "2012", "2013"))
>
> df.l$geo.time <- unlist(df.l$geo.time)  # unlist the geo.time variable
>
> # Load the shapefile GISCO, subset it to NUTS2-level
> # and merge the Eurostat
> # attribute data with it into single SpatialPolygonDataFrame
>
> Filetodownload <- 
> "http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/NUTS_2010_60M_SH.zip"
> download.file(Filetodownload, destfile = "NUTS_2010_60M_SH.zip")
> rm(Filetodownload)
>
> # Unzip NUTS_2010_60M_SH.zip to SpatialPolygonsDataFrame
> unzip("NUTS_2010_60M_SH.zip")
>
> library(rgdal)
> # Lecture du fichier
> map <- readOGR(dsn = "./NUTS_2010_60M_SH/data", layer = 
> "NUTS_RG_60M_2010")
> # OGR data source with driver: ESRI Shapefile
> # Source: "./NUTS_2010_60M_SH/data", layer: "NUTS_RG_60M_2010"
> # with 1920 features and 4 fields
> # Feature type: wkbPolygon with 2 dimensions
>
> names(map)
> #[1] "NUTS_ID"    "STAT_LEVL_" "SHAPE_Leng" "SHAPE_Area"
>
> # as the data is at NUTS2-level, we subset the
> # spatialpolygondataframe
> map_nuts2 <- subset(map, STAT_LEVL_ <= 2)
>
> # dim show how many regions are in the spatialpolygondataframe
> dim(map_nuts2)
> ## [1] 467   4
>
> # dim show how many regions are in the data.frame
> dim(df)
> ## [1] 43  15
>
> ################################################################
> # Spatial dataframe has 467 rows and attribute data 43.  We need to make
> # attribute data to have similar number of rows
> NUTS_ID <- as.character(map_nuts2$NUTS_ID)
> VarX <- rep("empty", 467)
> dat <- data.frame(NUTS_ID, VarX)
>
> # then we shall merge this with Eurostat data.frame
> dat2 <- merge(dat, df, by.x = "NUTS_ID", by.y = "geo.time", all.x = TRUE)
>
> ## merge this manipulated attribute data with the spatialpolygondataframe
> ## there are still duplicates in the data, remove them
> dat2$dup <- duplicated(dat2$NUTS_ID)
> dat3 <- subset(dat2, dup == FALSE)
>
> ## rownames
> row.names(dat3) <- dat3$NUTS_ID
> row.names(map_nuts2) <- as.character(map_nuts2$NUTS_ID)
>
> ## order data
> dat3 <- dat3[order(row.names(dat3)), ]
> map_nuts2 <- map_nuts2[order(row.names(map_nuts2)), ]
>
> ## join
> library(maptools)
> shape <- spCbind(map_nuts2, dat3)
>
> ########################################################################## 
>
> # Munging the shapefile into data.frame and ready for ggplot-plotting
>
> ## fortify spatialpolygondataframe into data.frame
> library(ggplot2)
> library(rgeos)
> shape$id <- rownames(shape at data)
> map.points <- fortify(shape, region = "id")
> map.df <- merge(map.points, shape, by = "id")
>
> ###############################################################
> # Only year 2011
> # As we want to plot map faceted by years from 2003 to 2011 we have to
> # melt it into long format
> map.df <- map.df[, -c(15:23,25,26)]
> library(reshape2)
>
> map.df.l <- melt(data = map.df, id.vars = c("id", "long", "lat", 
> "group"), measure.vars = c("X2011"))
>
> # year variable (variable) is class string and type X20xx.  Lets remove
> # the X and convert it to numerical
>
> library(stringr)
> map.df.l$variable <- str_replace_all(map.df.l$variable, "X", "")
> map.df.l$variable <- factor(map.df.l$variable)
> map.df.l$variable <- 
> as.numeric(levels(map.df.l$variable))[map.df.l$variable]
>
> # And finally the plot using ggplot2
> #Map shows proportion of materially deprived households at the NUTS2 
> level.
> #Grey color indicates missing data.
>
>
> library(ggplot2)
>
> ggplot(map.df.l, aes(long,lat,group=group)) +
> geom_polygon(aes(fill = value)) +
> geom_polygon(data = map.df.l, aes(long,lat),
> fill=NA, color = "white",
> size=0.1) + # white borders
> coord_map(project="orthographic", xlim=c(-22,34), ylim=c(35,70)) + # proj
> labs(title = "Cartographie") +
> theme_minimal()
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789205

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From lazyhydra at gmail.com  Fri Feb  7 12:12:03 2014
From: lazyhydra at gmail.com (Miriam Lo)
Date: Fri, 7 Feb 2014 11:12:03 +0000
Subject: [R-sig-Geo] Problem with China GADM map data?
Message-ID: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/c459a96f/attachment.pl>

From oscar.perpinan at upm.es  Fri Feb  7 12:58:55 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 7 Feb 2014 12:58:55 +0100
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
Message-ID: <CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>

Hello,

I have cleaned some parts of your code. It runs ok in my computer. The
error message you get is related to the conversion of non-ascii
characters. What is the result of sessionInfo() in your computer?

Best,

Oscar.

library(sp)
library(raster)
library(RColorBrewer)

chn1 <- getData('GADM', country="CHN", level=1)

# Creating my (artificial) groupings of Chinese admin units:
nrofunits <- length(chn1$NAME_1)

groups <- c(rep(1:3,(nrofunits%/%3)),rep(1,2))[order(c(rep(1:3,(nrofunits
%/% 3)),rep(1,2)))]

chn1$groups <- as.factor(groups)


mypalette <- brewer.pal(3,"Reds")
spplot(chn1, zcol="groups", col.regions=mypalette,
       colorkey=FALSE,
       par.settings=list(axis.line=list(col='transparent')))
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-07 Miriam Lo <lazyhydra at gmail.com>:
> Dear all
>
> I've recently tried coloring different provinces in different colours for a
> given country.  While I could do this on countries like US and UK, I came
> across a problem when colouring China.  Would anybody know what's wrong
> with the code/ any ways to get around the issue? Does this have anything to
> do with Chinese language support in R? Many thanks.
>
> Regards
> Miriam
>
> *Code:*
>
> library(raster)
> library(RColorBrewer)
> library(ggplot2)
>
> # Getting the data:
>
> chn1<-getData('GADM', country="CHN", level=1)
> class(chn1)
>
> # Creating my (artificial) groupings of Chinese admin units:
> nrofunits<-length(chn1$NAME_1)
> print(chn1$NAME_1)
> groups<-c(rep(1:3,(nrofunits %/%3)),rep(1,2))[order(c(rep(1:3,(nrofunits
> %/% 3)),rep(1,2)))]
>
> # adding values (grouping values) to "data" and calling this new variables
> "groups"
> chn1 at data["groups"]<-groups
> chn1 at data$groups<-as.factor(chn1 at data$groups)
>
> mypalette<-brewer.pal(3,"Reds")
> spplot(chn1,zcol="groups",col.regions=mypalette,colorkey
> =FALSE,par.settings=list(axis.line=list(col='transparent')))
>
>
> *Error:*
>
> Error in sort.list(y) :
>   invalid input '???????????????????????  ?????????? ' in 'utf8towcs'
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From hengl at spatial-analyst.net  Fri Feb  7 13:11:10 2014
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 07 Feb 2014 13:11:10 +0100
Subject: [R-sig-Geo] plotKML with multi-lingual output
In-Reply-To: <1391729090085-7585705.post@n2.nabble.com>
References: <1391729090085-7585705.post@n2.nabble.com>
Message-ID: <52F4CD5E.2080408@spatial-analyst.net>


I think that KML works only with UTF-8 encoding (http://gadm.org/node/400).

Try maybe setting the Sys.setlocale to:

Sys.setlocale(category='LC_CTYPE', locale='ru_RU.UTF-8')

Otherwise you can also try converting the Russian text to UTF-8 via 
http://stat.ethz.ch/R-manual/R-patched/library/base/html/utf8Conversion.html

HTH,

T. (Tom) Hengl
Url: http://www.wageningenur.nl/en/Persons/dr.-T-Tom-Hengl.htm
Network: http://profiles.google.com/tom.hengl
Publications: http://scholar.google.com/citations?user=2oYU7S8AAAAJ


On 7-2-2014 0:24, Anthony Fischbach wrote:
> I wish to produce a KML containing point and line features that have field
> names and field contents in both the Latin and Cyrillic alphabets.
> Below is a toy example showing the problem.
>
> require(plotKML)
> setwd('D:/Temp')  ## house keeping specify working directory
> data(bigfoot) ## Load a data frame with point features
> big<-bigfoot[1:3,]  ## take just the first 3 rows
> Sys.setlocale(category='LC_CTYPE', locale='Russian_Russia.1251')  ## Enable
> Cyrillic encoding
> big$???????.????????<-paste('????', seq(1:3))  ## create a column using
> Cyrillic encoding
> coordinates(big)<-c('Lon','Lat') ## Cast as SpatialPointsDataFrame
> proj4string(big)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")
> ## assign a coordinate reference system
> ## Take a quick look at it
> plot(big)
> text(big$Lon, big$Lat, big$???????.????????)
> ## I can see the points and the new Cyrillic names
>
> kml_open(file.name='Big.kml', folder.name = '????', kml_visibility=TRUE )
> 	## Build the point haulouts
> 	kml_layer.SpatialPoints(obj=big, points_names=big at data$???????.????????,
> 	colour='green',  LabelScale=0.8,
> shape='http://plotkml.r-forge.r-project.org/3Dballyellow.png',
> 	alpha=0.6, balloon=TRUE) ##
> 	## Build the line feature haulouts
> 	##kml_layer.Spatial
> kml_close(file.name='Big.kml')
> ## End Example Code
>
> Below is an excerpt of the resulting kml file.
> Please note the Cyrillic has been garbled.
>
>        <Placemark>
>          <name>???????? 1</name>
>          <styleUrl>#pnt1</styleUrl>
>          <description></description>
>          <Point>
>            <extrude>1</extrude>
>            <altitudeMode>clampToGround</altitudeMode>
>            <coordinates>-142.90000,61.50000,0</coordinates>
>          </Point>
>        </Placemark>
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: i386-w64-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=Russian_Russia.1251
> LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C                           LC_TIME=English_United
> States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_1.0-14     plotKML_0.4-2
>
> loaded via a namespace (and not attached):
>   [1] aqp_1.6             class_7.3-9         classInt_0.1-21
> cluster_1.14.4      colorRamps_2.3      colorspace_1.2-4
>   [7] dichromat_2.0-0     dismo_0.9-3         e1071_1.6-2
> Formula_1.1-1       grid_3.0.1          gstat_1.0-18
> [13] Hmisc_3.14-0        intervals_0.14.0    labeling_0.2
> lattice_0.20-24     latticeExtra_0.6-26 munsell_0.4.2
> [19] pixmap_0.4-11       plotrix_3.5-3       plyr_1.8
> raster_2.2-12       RColorBrewer_1.0-5  reshape_0.8.4
> [25] rgdal_0.8-13        RSAGA_0.93-6        scales_0.2.3
> spacetime_1.0-9     splines_3.0.1       stringr_0.6.2
> [31] survival_2.37-7     tools_3.0.1         XML_3.98-1.1        xts_0.9-7
> zoo_1.7-10
>
>
>
>
> -----
> Tony Fischbach, Wildlife Biologist
> Walrus Research Program
> Alaska Science Center
> U.S. Geological Survey
> 4210 University Drive
> Anchorage, AK 99508-4650
>
> AFischbach at usgs.gov
> http://alaska.usgs.gov/science/biology/walrus
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotKML-with-multi-lingual-output-tp7585705.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From lazyhydra at gmail.com  Fri Feb  7 13:16:19 2014
From: lazyhydra at gmail.com (Miriam Lo)
Date: Fri, 7 Feb 2014 12:16:19 +0000
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
Message-ID: <CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/1a36452d/attachment.pl>

From oscar.perpinan at upm.es  Fri Feb  7 13:31:22 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 7 Feb 2014 13:31:22 +0100
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
Message-ID: <CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>

I think you have to change your locale configuration with
Sys.setlocale. For example, try Sys.setlocale('LC_ALL', 'C').
I have found a post in stackoverflow that describes a problem (with
solution) very similar to yours:
http://stackoverflow.com/questions/5031630/how-to-source-r-file-saved-using-utf-8-encoding
Best,

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-07 Miriam Lo <lazyhydra at gmail.com>:
> Hi Oscar
>
> Many thanks for your help! I've tried running the cleaned code but still
> couldn't get it to work.  The results of running sessionInfo() is as
> follows.  Is there anything that I could adjust the settings such that it
> converted the non-ASCII characters correctly?
>
> Regards
> Miriam
>
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United
> Kingdom.1252    LC_MONETARY=English_United Kingdom.1252
> [4] LC_NUMERIC=C                            LC_TIME=English_United
> Kingdom.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.2-12      sp_1.0-14          RColorBrewer_1.0-5
> MASS_7.3-29        mapproj_1.2-2      maps_2.3-6
> [7] ggmap_2.3          ggplot2_0.9.3.1
>
> loaded via a namespace (and not attached):
>  [1] colorspace_1.2-4    dichromat_2.0-0     digest_0.6.4
> grid_3.0.2          gtable_0.1.2        labeling_0.2
>  [7] lattice_0.20-23     munsell_0.4.2       plyr_1.8
> png_0.1-7           proto_0.3-10        reshape2_1.2.2
> [13] RgoogleMaps_1.2.0.5 rjson_0.2.13        RJSONIO_1.0-3
> scales_0.2.3        stringr_0.6.2       tools_3.0.2
>
>>
>
>
> On Fri, Feb 7, 2014 at 11:58 AM, Oscar Perpi?an <oscar.perpinan at upm.es>wrote:
>
>> Hello,
>>
>> I have cleaned some parts of your code. It runs ok in my computer. The
>> error message you get is related to the conversion of non-ascii
>> characters. What is the result of sessionInfo() in your computer?
>>
>> Best,
>>
>> Oscar.
>>
>> library(sp)
>> library(raster)
>> library(RColorBrewer)
>>
>> chn1 <- getData('GADM', country="CHN", level=1)
>>
>> # Creating my (artificial) groupings of Chinese admin units:
>> nrofunits <- length(chn1$NAME_1)
>>
>> groups <- c(rep(1:3,(nrofunits%/%3)),rep(1,2))[order(c(rep(1:3,(nrofunits
>> %/% 3)),rep(1,2)))]
>>
>> chn1$groups <- as.factor(groups)
>>
>>
>> mypalette <- brewer.pal(3,"Reds")
>> spplot(chn1, zcol="groups", col.regions=mypalette,
>>        colorkey=FALSE,
>>        par.settings=list(axis.line=list(col='transparent')))
>> -----------------------------------------------------------------
>> Oscar Perpi??n Lamigueiro
>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>> URL: http://oscarperpinan.github.io
>> Twitter: @oscarperpinan
>>
>>
>> 2014-02-07 Miriam Lo <lazyhydra at gmail.com>:
>> > Dear all
>> >
>> > I've recently tried coloring different provinces in different colours
>> for a
>> > given country.  While I could do this on countries like US and UK, I came
>> > across a problem when colouring China.  Would anybody know what's wrong
>> > with the code/ any ways to get around the issue? Does this have anything
>> to
>> > do with Chinese language support in R? Many thanks.
>> >
>> > Regards
>> > Miriam
>> >
>> > *Code:*
>> >
>> > library(raster)
>> > library(RColorBrewer)
>> > library(ggplot2)
>> >
>> > # Getting the data:
>> >
>> > chn1<-getData('GADM', country="CHN", level=1)
>> > class(chn1)
>> >
>> > # Creating my (artificial) groupings of Chinese admin units:
>> > nrofunits<-length(chn1$NAME_1)
>> > print(chn1$NAME_1)
>> > groups<-c(rep(1:3,(nrofunits %/%3)),rep(1,2))[order(c(rep(1:3,(nrofunits
>> > %/% 3)),rep(1,2)))]
>> >
>> > # adding values (grouping values) to "data" and calling this new
>> variables
>> > "groups"
>> > chn1 at data["groups"]<-groups
>> > chn1 at data$groups<-as.factor(chn1 at data$groups)
>> >
>> > mypalette<-brewer.pal(3,"Reds")
>> > spplot(chn1,zcol="groups",col.regions=mypalette,colorkey
>> > =FALSE,par.settings=list(axis.line=list(col='transparent')))
>> >
>> >
>> > *Error:*
>> >
>> > Error in sort.list(y) :
>> >   invalid input '???????????????????????  ?????????? ' in 'utf8towcs'
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From oscar.perpinan at upm.es  Fri Feb  7 14:14:06 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 7 Feb 2014 14:14:06 +0100
Subject: [R-sig-Geo] Layering text outside the plot region in a levelplot
In-Reply-To: <CANOSwXx7hBi3gTA58qs5kavhwHs2O7aPPbHPmhnkPfb+khAhCQ@mail.gmail.com>
References: <CANOSwXx7hBi3gTA58qs5kavhwHs2O7aPPbHPmhnkPfb+khAhCQ@mail.gmail.com>
Message-ID: <CAMLL7bnohk3z7qz8cSBDf+b53Bc+6LoP+i_bNCu+TML2z4-w2g@mail.gmail.com>

Hi, Jooil

You are using a mailing list devoted to spatial data. You should use
R-help (https://stat.ethz.ch/mailman/listinfo/r-help) or stackoverflow
(http://stackoverflow.com/tags/r) for this kind of questions.
Regarding your question, latticeExtra::layer modifies the panel
function used by levelplot. Therefore, what you include in layer()
will be displayed inside the panel area. This should work:

png("output.png")
p
grid.text('here and there', x=.98, y=.5, rot=-90,
          gp = gpar(col=4,
              fontfamily="HersheyGothicEnglish", cex=2))
dev.off()


Best,

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-07 Jooil Kim <kji2080 at gmail.com>:
> Hello list,
>
> I've always wanted to figure out how to put legend captions in my
> levelplots, and so when I came across this example today (from
> http://r.789695.n4.nabble.com/scale-caption-on-levelplot-td3072400.html):
>
>    library(grid)
>    x <- sort(rnorm(100,50,10))
>    y <- sort(runif(100,0,20))
>    d <- expand.grid(x=x, y=y)
>    d$z <- x + y
>    graphics.off()
>    p <- levelplot(z ~ x*y, d,
>              par.settings=list(
>                layout.widths=list(right.padding=4),
>                layout.heights=list(top.padding=6)),
>              colorkey = TRUE)
>    print(p)
>
>    ## now add the text
>    grid.text('here and there', x=.98, y=.5, rot=-90,
>      gp = gpar(col=4,
>          fontfamily="HersheyGothicEnglish", cex=2))
>
> This works and is fine, except in my code I use the layer() function and
> save to a png, which changes the code as such:
>
>    library(grid)
>    library(latticeExtra)
>    x <- sort(rnorm(100,50,10))
>    y <- sort(runif(100,0,20))
>    d <- expand.grid(x=x, y=y)
>    d$z <- x + y
>    graphics.off()
>    p <- levelplot(z ~ x*y, d,
>              par.settings=list(
>                layout.widths=list(right.padding=4),
>                layout.heights=list(top.padding=6)),
>              colorkey = TRUE)
>    #print(p)
>
>    ## now add the text layer
>    p <- p + layer(grid.text('here and there', x=.98, y=.5, rot=-90,
>      gp = gpar(col=4,
>          fontfamily="HersheyGothicEnglish", cex=2)))
>
>    png("output.png")
>    plot(p)
>    dev.off()
>
> Now, with these changes, the text moves inside the plot region, instead of
> outside in the margins. It seems like once the grid.text is  converted by
> the layer(), the x and y positions become relative to the plot region
> instead of the whole graph, and any values of x and y larger than 1 will
> move the text out of view.
>
> So, is there a way I can use layer() to add text in the margins outside the
> plot region? Or are there suggestions on other ways in which I could add
> text to a plot margin?
>
> Thanks,
>
> Jooil
>
>
> --
> #############################################
> Jooil Kim
> Postdoc Fellow
> Scripps Institution of Oceanography, UC San Diego
> Mailing address:
> 9500 Gilman Drive # 0244
> La Jolla, CA 92093-0244, USA
> For FedEx/UPS:
> 8675 Discovery Way, Vaughan Hall Rm. 447
> La Jolla, CA 92037, USA
> jooilkim at ucsd.edu (kji2080 at gmail.com)
> tel)+1-858-534-2599
> fax)+1-858-455-8306
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From agus.camacho at gmail.com  Fri Feb  7 14:44:29 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Fri, 7 Feb 2014 11:44:29 -0200
Subject: [R-sig-Geo] maxent function from dismo package does not find
 maxent.jar file
In-Reply-To: <CANtt_hy9pVacG26W4euFRGC-JAMS=z0RuQrUt171sVxxr4K4vw@mail.gmail.com>
References: <CALsJ7pSe1EAPurdO+oQnpwTYZ8ezEBpV-AvGFFTy2B_+7XPSAg@mail.gmail.com>
	<CANtt_hy9pVacG26W4euFRGC-JAMS=z0RuQrUt171sVxxr4K4vw@mail.gmail.com>
Message-ID: <CALsJ7pSLfQSor4NuY1wPbPGRu2qdd3OOvoFQtSChH48-jLnnvQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/02c906b1/attachment.pl>

From tvh110 at alumni.ku.dk  Fri Feb  7 14:56:18 2014
From: tvh110 at alumni.ku.dk (Gregor Ratzmann)
Date: Fri, 7 Feb 2014 13:56:18 +0000
Subject: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with
	attribute table
Message-ID: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/175911f7/attachment.pl>

From agus.camacho at gmail.com  Fri Feb  7 15:22:58 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Fri, 7 Feb 2014 12:22:58 -0200
Subject: [R-sig-Geo] error with dismo::randomPoints only at high number of
	points
Message-ID: <CALsJ7pSU+FDY_2aGS+tHEJSu2aNPq5cbu=BK4qS79yuGB90uJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/7f70139b/attachment.pl>

From lazyhydra at gmail.com  Fri Feb  7 15:52:57 2014
From: lazyhydra at gmail.com (Miriam Lo)
Date: Fri, 7 Feb 2014 14:52:57 +0000
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
	<CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
Message-ID: <CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/d77b653a/attachment.pl>

From oscar.perpinan at upm.es  Fri Feb  7 17:21:32 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 7 Feb 2014 17:21:32 +0100
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
	<CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
	<CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>
Message-ID: <CAMLL7bk=wVh=kadePizcHRi1rzeBFg1iDLD8OB94krT9cNuqbA@mail.gmail.com>

> However, running on the original code I now get this slightly different
> error as below.  Just out of interest are you running R on Windows?

No, I run R on Linux.

Sorry, I don't know how to solve your problem.

Best,

Oscar.


From r.hijmans at gmail.com  Fri Feb  7 17:31:30 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 7 Feb 2014 08:31:30 -0800
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAMLL7bk=wVh=kadePizcHRi1rzeBFg1iDLD8OB94krT9cNuqbA@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
	<CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
	<CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>
	<CAMLL7bk=wVh=kadePizcHRi1rzeBFg1iDLD8OB94krT9cNuqbA@mail.gmail.com>
Message-ID: <CANtt_hxNB=9Zv-KpehvANHq7-92XV3mAq358ZWhus9+cd5Sdgg@mail.gmail.com>

The chinese characters are in

chn1$NL_NAME_1

It is not a pretty solution, but the problem should go away if you
remove that field

chn1$NL_NAME_1 <- NULL

Robert



On Fri, Feb 7, 2014 at 8:21 AM, Oscar Perpi?an <oscar.perpinan at upm.es> wrote:
>> However, running on the original code I now get this slightly different
>> error as below.  Just out of interest are you running R on Windows?
>
> No, I run R on Linux.
>
> Sorry, I don't know how to solve your problem.
>
> Best,
>
> Oscar.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From lazyhydra at gmail.com  Fri Feb  7 17:36:01 2014
From: lazyhydra at gmail.com (Miriam Lo)
Date: Fri, 7 Feb 2014 16:36:01 +0000
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CANtt_hxNB=9Zv-KpehvANHq7-92XV3mAq358ZWhus9+cd5Sdgg@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
	<CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
	<CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>
	<CAMLL7bk=wVh=kadePizcHRi1rzeBFg1iDLD8OB94krT9cNuqbA@mail.gmail.com>
	<CANtt_hxNB=9Zv-KpehvANHq7-92XV3mAq358ZWhus9+cd5Sdgg@mail.gmail.com>
Message-ID: <CAKrkpwGk=F=N3GpczaKLaEdEnCMVrQad-3JNCe37_=JuyfAyXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/ed88d2c1/attachment.pl>

From lazyhydra at gmail.com  Fri Feb  7 18:19:35 2014
From: lazyhydra at gmail.com (Miriam Lo)
Date: Fri, 7 Feb 2014 17:19:35 +0000
Subject: [R-sig-Geo] Problem with China GADM map data?
In-Reply-To: <CAKrkpwGk=F=N3GpczaKLaEdEnCMVrQad-3JNCe37_=JuyfAyXg@mail.gmail.com>
References: <CAKrkpwHkVk-6uPc165ii9pYpDhk7W20dbX=L+THZw6LDVwLuDw@mail.gmail.com>
	<CAMLL7bnyXh9ZQEW_WAPSpR26rFq9GZTOXqXz9A=JU_pRV9PB-Q@mail.gmail.com>
	<CAKrkpwGCeLsU_QhJh9jP0Ni50Rn7XKSowwgt6qcCeBoeSKxPtg@mail.gmail.com>
	<CAMLL7b=C85bre2WYamiMVJUTRMq3DwXxiq1fpWQVivOEcHQN8g@mail.gmail.com>
	<CAKrkpwH5VQw2msSEiG-3bjOFq0RwGocH973zGeepFDiSwtotWw@mail.gmail.com>
	<CAMLL7bk=wVh=kadePizcHRi1rzeBFg1iDLD8OB94krT9cNuqbA@mail.gmail.com>
	<CANtt_hxNB=9Zv-KpehvANHq7-92XV3mAq358ZWhus9+cd5Sdgg@mail.gmail.com>
	<CAKrkpwGk=F=N3GpczaKLaEdEnCMVrQad-3JNCe37_=JuyfAyXg@mail.gmail.com>
Message-ID: <CAKrkpwGq-CqHV+gSc-M=i-H3DjGTqGjQ7rEa2GZHyj+bw8c2cg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/7c4862fb/attachment.pl>

From kji2080 at gmail.com  Fri Feb  7 19:05:47 2014
From: kji2080 at gmail.com (Jooil Kim)
Date: Fri, 7 Feb 2014 10:05:47 -0800
Subject: [R-sig-Geo] Layering text outside the plot region in a levelplot
In-Reply-To: <CAMLL7bnohk3z7qz8cSBDf+b53Bc+6LoP+i_bNCu+TML2z4-w2g@mail.gmail.com>
References: <CANOSwXx7hBi3gTA58qs5kavhwHs2O7aPPbHPmhnkPfb+khAhCQ@mail.gmail.com>
	<CAMLL7bnohk3z7qz8cSBDf+b53Bc+6LoP+i_bNCu+TML2z4-w2g@mail.gmail.com>
Message-ID: <CANOSwXyDvqTPkpN8wybY0P0HZBMKgC4OHdHQmpt-uf_EkGq1gQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140207/7fa92e6a/attachment.pl>

From oscar.perpinan at upm.es  Fri Feb  7 19:40:39 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 7 Feb 2014 19:40:39 +0100
Subject: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with
 attribute table
In-Reply-To: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>
References: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>
Message-ID: <CAMLL7bmw9Yb7n4xaje1cCx-Avo-OGNc-PCF7wvjG+wqT1feQhw@mail.gmail.com>

Hello,

> I am trying to plot a raster which comes with an attribute table and a colortable using the rasterVis levelplot function.
>
> Here is my first question: is it possible to address the colortable slot directly in the levelplot function (as is possible for the plot3D through the useLegend argument)?

Not yet. It is still in my To-do list.

> Since I did not find a way to do it, I tried the below. Note that the original attribute table is not arranged as is neccessary for levelplot to read it so I first create a new raster and assign to it the attributes which are needed:
> I know the procedure is improvable but for now I think it should do. The problem: Everything is plotted fine as expected, except that the last two classes of the raster are assigned the same color. Since there are the same number of classes as number of colors I do not really understand why this happens and, strange enough, in the color key all colors are plotted fine with the correct labels....additionally, when i do it using the plot() function it is working fine. When I used a different color ramp for levelplot it worked out for all classes and everything was well differentiated... Is there maybe some hex color code which levelplot can't read? Please appologize if I didn't express clearly what I want but I am still at the beginning of using R.

I don't understand what you are trying to do with your code. Could you
provide a reproducible example? Try the examples of the ratify help
page.

Best,

Oscar.


From Nathaniel.L.Mikle-1 at ou.edu  Fri Feb  7 19:46:08 2014
From: Nathaniel.L.Mikle-1 at ou.edu (nate_m)
Date: Fri, 7 Feb 2014 10:46:08 -0800 (PST)
Subject: [R-sig-Geo] Breakpoint analysis with two variables
In-Reply-To: <CANtt_hxCk5Ru30JSXY=jEiCVRk3hyC6gA4e1V3dT2Mvp-HFc-w@mail.gmail.com>
References: <1390423738606-7585607.post@n2.nabble.com>
	<CANtt_hz-qhKk1uYdQ6C7KxbDdmEUYE_dxN+BoEVJV1sjnO1nyw@mail.gmail.com>
	<1390940428080-7585654.post@n2.nabble.com>
	<CANtt_hxCk5Ru30JSXY=jEiCVRk3hyC6gA4e1V3dT2Mvp-HFc-w@mail.gmail.com>
Message-ID: <1391798768467-7585725.post@n2.nabble.com>

Hi Robert,
I have gotten the script to work on real data. Segmented was adding an extra
value to the vector after they went through lm. Defining the variables
inside the function side-steps this. Also, some data does not converge so
the try() function allows us to skip those. Thanks for your help! Here is
the basic script if anybody needs help in the future.

fun <- function(z) { 
  x <- (z[1:11])
  b <- (z[12:22])
  min_x <- min(z[1:11])
  if ( all(is.na(z)) ) { 
    return( c(NA,NA,NA) ) 
  } else { 
    coef <- lm(b ~ x)
    coef1 <- try(segmented(coef, ~x, psi=min_x), silent = TRUE)
    if(class(coef1)=="segmented") {
      y <- confint(coef1)$x
    } else {
      return( c(NA,NA,NA) )
    }
    y
  } 
} 

ex1 <- calc(z, fun)



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Breakpoint-analysis-with-two-variables-tp7585607p7585725.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From hans at 013.net  Fri Feb  7 21:29:06 2014
From: hans at 013.net (dooshra)
Date: Fri, 7 Feb 2014 12:29:06 -0800 (PST)
Subject: [R-sig-Geo] How to define +towgs84 based on LCL TO WGS84 definitions
Message-ID: <1391804946811-7585726.post@n2.nabble.com>

Hello
I have a list of coordinates written in local grid ITM (Israel Tarns
Mercator). The coordinates were  manually recorded from a  Magellan GPS
device.  The
GPS device was using this  kind of datum definition: LCL  TO WGS84 DELTA A,
DELTA F (X 10,000), DELTA X,   DELTA Y, DELTA Z. I want to write a proj
definition to convert these coordinates back to WGS84 lat/lon coordinates.
How do I use these parameters in the "+towgs84=" string?. I know that the
first 3 parameters are translation parameters: delta z, delta y, delta z but
then there are 3
rotation parameters and one scaling parameter while in the GPS definition
there are additional 2 translation parameters: delta A and delta F. 
Thank you.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-define-towgs84-based-on-LCL-TO-WGS84-definitions-tp7585726.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From afischbach at usgs.gov  Fri Feb  7 22:05:02 2014
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Fri, 7 Feb 2014 13:05:02 -0800 (PST)
Subject: [R-sig-Geo] plotKML with multi-lingual output
In-Reply-To: <52F4CD5E.2080408@spatial-analyst.net>
References: <1391729090085-7585705.post@n2.nabble.com>
	<52F4CD5E.2080408@spatial-analyst.net>
Message-ID: <1391807102313-7585727.post@n2.nabble.com>

Tom, 
Trying to set the locale to 'ru_RU.UTF-8' seems to hit a Windows specific
issue.
When I enter
>Sys.setlocale(category='LC_CTYPE', locale='ru_RU.UTF-8')
I receive this error.
[1] ""
Warning message:
In Sys.setlocale(category = "LC_CTYPE", locale = "ru_RU.UTF-8") :
   OS reports request to set locale to "ru_RU.UTF-8" cannot be honored

Yet, when I enter
>Sys.setlocale(category='LC_CTYPE', locale='Russian_Russia.1251')  
I recieve this.
[1] "Russian_Russia.1251"

Yet, I still am unable to write the Cyrillic characters.
In my toy example posted above, I may see the field name 
> names(big)[6]
I see the following on my screen.
[1] "???????.????????"
Yet, when I write this to a text file using the sink() function, I get the
following in my text file.
[1] "???????.????????"
>From this I deduce that my problem is not with plotKML, but with locale
encoding handling within R on my Windows machine.

When I try to set the encoding directly using the 
Encoding(names(big)[6])<-'UTF-8'
Then send the result (names(big)[6]) to a text file using the sink()
function, I get
[1] "<d0><f3><f1><f1><ea><ee><e5>.<ed><e0><e7><e2><e0><ed><e8><e5>"

Is see that use of a file connection
(http://stat.ethz.ch/R-manual/R-patched/library/base/html/connections.html)
may enable direct handling of the encoding.
Would it be possible to utilize the encoding flag within the file function
to enable encoding of non-Roman letters written to a KML?  Or would this
require reference to the function XML::saveXML(tr, f, encoding = "UTF-8")
within your plotKML functions?



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotKML-with-multi-lingual-output-tp7585705p7585727.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Sat Feb  8 15:10:52 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 8 Feb 2014 15:10:52 +0100
Subject: [R-sig-Geo] rgdal: please vote on proj4 requirement change
Message-ID: <alpine.LRH.2.03.1402081500300.14333@reclus.nhh.no>

If you install rgdal as a source package, your input would be helpful.

Because of ongoing changes in the PROJ.4 library, it is desirable to 
change the requirement in rgdal from the current >= 4.4.9 to >= 4.8.0. 
Please vote on whether such a change would inconvenience your workflow - 
no if you cannot upgrade to PROJ.4 >= 4.8.0, yes if this is OK for you, 
using this doodle:

http://www.doodle.com/rt5nuginrgyucdgi

I'll try to respect no votes if there are relatively many, but branching 
on PROJ.4 version is creating many maintenance problems.

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Sat Feb  8 17:44:40 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 8 Feb 2014 16:44:40 +0000
Subject: [R-sig-Geo] rgdal: please vote on proj4 requirement change
In-Reply-To: <edd5d746ac974741915f41d169011b05@EX-1-HT0.lancs.local>
References: <edd5d746ac974741915f41d169011b05@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMWEvC==8o5aB20gCsy3BSGVZX9SGz_WBJVgrUCgszUvA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140208/79f0f46c/attachment.pl>

From Roger.Bivand at nhh.no  Sat Feb  8 18:18:23 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 8 Feb 2014 18:18:23 +0100
Subject: [R-sig-Geo] rgdal: please vote on proj4 requirement change
In-Reply-To: <CANVKczMWEvC==8o5aB20gCsy3BSGVZX9SGz_WBJVgrUCgszUvA@mail.gmail.com>
References: <edd5d746ac974741915f41d169011b05@EX-1-HT0.lancs.local>
	<CANVKczMWEvC==8o5aB20gCsy3BSGVZX9SGz_WBJVgrUCgszUvA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1402081807000.15707@reclus.nhh.no>

On Sat, 8 Feb 2014, Barry Rowlingson wrote:

> On Sat, Feb 8, 2014 at 2:10 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> If you install rgdal as a source package, your input would be helpful.
>>
>> Because of ongoing changes in the PROJ.4 library, it is desirable to
>> change the requirement in rgdal from the current >= 4.4.9 to >= 4.8.0.
>>
>
> Which version of libproj-dev is currently supported with the major Linux
> distributions?
>
> If I'm reading this page right:
>
> http://packages.ubuntu.com/search?suite=saucy&section=all&arch=any&keywords=libproj&searchon=names
>
> it looks like 4.7.0-2 is current for Ubuntu Saucy. Would that mean having
> to get a version 4.8.0 and compile from source so I can link it with rgdal?
> And now I have two problems...
>
> Alternatively, Ubuntugis unstable has 4.8.0 for Saucy, Ubuntugis stable has
> 4.8.0. for Lucid, Precise and Quantal. But Ubuntugis stable only has QGIS
> 1.8...
>
> So I think the implications of rgdal needing PROJ.4 >=4.8.0 are:
>
> 1. Compile PROJ.4 4.8.0 from source and try not to confuse your system
> with the version from packages
> 2. Use Ubuntu Saucy and Ubuntugis Unstable package
> 3. Use Ubuntu L, P, Q and an outdated QGIS....
> 4. On one box I have handy I have qgis from the qgis.org repository, and
> libproj 4.8.0 from a downloaded .deb file. I'm not sure where I got that
> from....
>
> So would requiring 4.8.0 inconvenience my workflow? Probably no more than
> the usual chase round the repositories I seem to do every time I try and
> get Qgis + Python + gdal + rgdal working on a new install :)

Right, so that even with so far unanimous yes on doodle, you are actually 
at best a (maybe), because it does make a difference until ubuntu and 
debian get their packages sorted out. Thanks, helpful ...

>From Fedora 16 (20 is current) the rpm is 4.8.0, and for Readhat 4/5/6, 
CentOS 5/6 and OpenSuSE, 4.7.0 was last provided for Fedora 17.

Roger

>
> Barry
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From aydiney at hotmail.com  Mon Feb 10 09:04:57 2014
From: aydiney at hotmail.com (=?iso-8859-9?Q?Emre_Ayd=FDn?=)
Date: Mon, 10 Feb 2014 10:04:57 +0200
Subject: [R-sig-Geo] property value estimation
Message-ID: <DUB405-EAS282AAF1303012729D793176A8900@phx.gbl>


Hello 

I found R in my internet search to solve my regression analysis problem.
Let's say I have point cloud data which geographic coordinates and some
attribute values. Most of you probably be familiar with the property value
estimation methods for a given coordinate position and attribute values.  

Let's say each point has attributes like m2, room count, bath count, house
age and price.
In GIS you do interpolation for each point with one value. As you see here I
have more than one value. So I think I cannot do it in GIS unless I group
each data set with similar attributes to reach one single value for
interpolation. 

Is there a similar problem walkthrough or example in R which does not
implement an inefficient solution like grouping similar attributes to reach
a single value? 
My statistical knowledge only tells me that somehow I can use all of the
attributes together to perform property value estimation. I found that multi
variate regression analysis is the solution but each data has coordinates so
there must be a solution in R to use the dataset coordinates and attribute
values together. 

Thank you.
Emre


From juantomas.sayago at gmail.com  Tue Feb 11 16:42:15 2014
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Tue, 11 Feb 2014 10:42:15 -0500
Subject: [R-sig-Geo] Moran's I Weight Matrix in R (error: objects of
 different length)
In-Reply-To: <alpine.LRH.2.03.1401300822590.9210@reclus.nhh.no>
References: <CAJXq52mVA7HVORGYRDy1=JsNQxzBf-CH=LGqeSwsRLLKatct2Q@mail.gmail.com>
	<alpine.LRH.2.03.1401300822590.9210@reclus.nhh.no>
Message-ID: <CAEOXpNBWiJjssFW4WUA1UhiBj+fSn081k6j3ZKn+foRhOkzEFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140211/1c89ecf7/attachment.pl>

From tvh110 at alumni.ku.dk  Wed Feb 12 08:52:41 2014
From: tvh110 at alumni.ku.dk (Gregor Ratzmann)
Date: Wed, 12 Feb 2014 07:52:41 +0000
Subject: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with
 attribute table
In-Reply-To: <CAMLL7bmw9Yb7n4xaje1cCx-Avo-OGNc-PCF7wvjG+wqT1feQhw@mail.gmail.com>
References: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>,
	<CAMLL7bmw9Yb7n4xaje1cCx-Avo-OGNc-PCF7wvjG+wqT1feQhw@mail.gmail.com>
Message-ID: <759254E7AC2B1A4D834095DE4D652AA253AE6B2D@P2KITMBX02WC01.unicph.domain>

Thanks for your reply, Oscar,

I'm sorry if the code appears somewhat confusing so I try to explain what it is supposed to do.

So if I use the example from the ratify function help:

r <- raster(nrow=10, ncol=10)
r[] = 1
r[51:100] = 2
r[3:6, 1:5] = 3
r <- ratify(r)

rat <- levels(r)[[1]]
rat$landcover <- c('Pine', 'Oak', 'Meadow')
rat$code <- c(12,25,30)
levels(r) <- rat

cols=c("red","green","blue")

levelplot(r,col.regions=cols)


everything works fine as expected.

So I will try to explain what my code is supposed to do. I have a thematic raster with attribute table. The raster takes on values between 1 and 28 each value representing one class. The value and corresponding class name are stored in the attribute tables column 5 and 4, respectively.

#First I load the raster with the attribute table and color table

r<-raster(##some raster with attribute and colortable##))

#then I create a data frame from the levels of the thematic raster

ratdf<-as.data.frame(levels(r))


#now I extract column 5 of the RAT df which holds the IDs

rat<-as.data.frame(ratdf[[5]])

#Next step: create a vector with the classnames from RAT df col 4

nvec<-as.character(ratdf[[4]])

#then join the class names vector with the ID data frame 

rat$classes<-nvec

#assign the column names of rat 
names(rat)<-c("ID","classes")

#create an empty raster r1 from the r template

r1<-raster(r)

#assign the values of r to r1

r1[]<-r[]

#make a thematic raster of r1
 
r1<-ratify(r1)

#assign the levels to r1 from rat

levels(r1)<-rat


#next steps are to create a color ramp with only the valid colors (since the original raster is 8 bit it could contain up to 256 #colors but I only need colors 2 to 29) and plot the thing

cols<-r at legend@colortable
cols<-cols[2:29]

levelplot(r1,col.regions=cols)

####


What puzzles me is that after I created the new thematic raster with ratify, and I call the raster, it is displayed but under attributes appears the error: Error in 1:ncol(r) : argument of length 0. Maybe this has something to do with the problems plotting that raster. Btw, the same error appears as well when I use as.factor instead of ratify...

Cheers

greg

________________________________________
Von: oscar.perpinan at gmail.com [oscar.perpinan at gmail.com]&quot; im Auftrag von &quot;Oscar Perpi?an [oscar.perpinan at upm.es]
Gesendet: Freitag, 7. Februar 2014 19:40
An: Gregor Ratzmann
Cc: r-sig-geo at r-project.org
Betreff: Re: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with attribute table

Hello,

> I am trying to plot a raster which comes with an attribute table and a colortable using the rasterVis levelplot function.
>
> Here is my first question: is it possible to address the colortable slot directly in the levelplot function (as is possible for the plot3D through the useLegend argument)?

Not yet. It is still in my To-do list.

> Since I did not find a way to do it, I tried the below. Note that the original attribute table is not arranged as is neccessary for levelplot to read it so I first create a new raster and assign to it the attributes which are needed:
> I know the procedure is improvable but for now I think it should do. The problem: Everything is plotted fine as expected, except that the last two classes of the raster are assigned the same color. Since there are the same number of classes as number of colors I do not really understand why this happens and, strange enough, in the color key all colors are plotted fine with the correct labels....additionally, when i do it using the plot() function it is working fine. When I used a different color ramp for levelplot it worked out for all classes and everything was well differentiated... Is there maybe some hex color code which levelplot can't read? Please appologize if I didn't express clearly what I want but I am still at the beginning of using R.

I don't understand what you are trying to do with your code. Could you
provide a reproducible example? Try the examples of the ratify help
page.

Best,

Oscar.


From pickering at penguin.kobe-u.ac.jp  Thu Feb 13 06:55:36 2014
From: pickering at penguin.kobe-u.ac.jp (Steve Pickering)
Date: Thu, 13 Feb 2014 14:55:36 +0900
Subject: [R-sig-Geo] Interrupted Goode Homolosine forest data
Message-ID: <CAEdPBsFZAFKaER46USBHNxPVXq8Ged5OTLfbOrmwTZ=iPUTwBQ@mail.gmail.com>

Hi, all,

I'm working with Global Forest Canopy Density data (specifications
here: http://edc2.usgs.gov/glcc/fao/data_specifications.php).

The data are in Interrupted Goode Homolosine projection.  I need to
use R to display them in unprojected lat lng format.

So far, I can display the projected version as follows:

First, create a test.vrt file with the following markup:

    <VRTDataset rasterXSize="36543" rasterYSize="15059">
    <VRTRasterBand dataType="Byte" band="1" subClass="VRTRawRasterBand">
        <SourceFilename
relativetoVRT="1">global_forest_density.img</SourceFilename>
        <ImageOffset>0</ImageOffset>
        <PixelOffset>1</PixelOffset>
        <LineOffset>36543</LineOffset>
        <ByteOrder>MSB</ByteOrder>
      </VRTRasterBand>
    </VRTDataset>

Then, display a sample of the map (it's a big old beastie) as follows:

require(raster)
forestCanopyIGH = raster("test.vrt")
plot(forestCanopyIGH,maxpixels=100*100)

I need help with the next step of displaying the unprojected version!

Many thanks,

 - Steve.


Steve Pickering
Assistant Professor
Kobe University
2-1 Rokkodai-cho
Nada-ku, Kobe
657-8501 Japan
pickering at penguin.kobe-u.ac.jp
http://www.stevepickering.net


From roelofcoster at gmail.com  Thu Feb 13 13:30:04 2014
From: roelofcoster at gmail.com (Roelof Coster)
Date: Thu, 13 Feb 2014 13:30:04 +0100
Subject: [R-sig-Geo] Spacetime regression
Message-ID: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/9feb599b/attachment.pl>

From azvoleff at conservation.org  Thu Feb 13 13:54:05 2014
From: azvoleff at conservation.org (Alex Zvoleff)
Date: Thu, 13 Feb 2014 07:54:05 -0500
Subject: [R-sig-Geo] New "glcm" package for calculating co-occurrence
	textures now on CRAN
Message-ID: <CACwzsXEy3OjZ9Yx1Bo0QXZwvAF-bBs2nyRdCX=yiaS_8pUoVXw@mail.gmail.com>

Hi all,

I just released the new "glcm" package to CRAN. The glcm package
enables calculating image textures derived from grey-level
co-occurrence matrices (GLCMs) in R. The underlying texture
calculation code is implemented in C++ using RcppArmadillo.

I have tested the calculated textures versus other implementations,
but let me know if you notice anything unexpected.

Also, I just pushed out another package to CRAN that may be of
interest to some in this group. The "wrspathrow" package has several
functions for working with path and row numbers from the World
Reference System (WRS, the system used by NASA for the Landsat
satellites). The package supports calculating the path(s) and row(s)
needed to cover a given sp or raster object, or, conversely, can
calculate the polygon for a given path and row.

Cheers,
Alex


-- 
Alex Zvoleff
Postdoctoral Associate
Tropical Ecology Assessment and Monitoring (TEAM) Network
Conservation International
2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
http://www.teamnetwork.org | http://www.conservation.org


From edzer.pebesma at uni-muenster.de  Thu Feb 13 14:00:28 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 13 Feb 2014 14:00:28 +0100
Subject: [R-sig-Geo] Spacetime regression
In-Reply-To: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>
References: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>
Message-ID: <52FCC1EC.60406@uni-muenster.de>



On 02/13/2014 01:30 PM, Roelof Coster wrote:
> Hi all,
> 
> I want to do a spatio-temporal regression on a quite large dataset. I have
>> 100 k records. These correspond to measurements taken at 3000 locations,
> approximately every half year. The geographic area is all of the
> Netherlands (240 x 300 km).

Sample variograms are a quadratic form, meaning that all pairs of your
100K records are evaluated; that makes 10^10 pairs. Are you a patient
person?

> Is spatio-temporal kriging advisable for a dataset that is so large?
> 
> When I make the sample space-time variogram (with variogramST), it
> automatically chooses a time-lag difference of about 2 days. This is much
> too small to be meaningful for my data; half-year periods would be
> interesting. Is there a way to tell this to the variogramST function?

variogramST (in package gstat) assumes that the time gap between
observations is constant. If you have "approximately every half year"
observations, are some of them only a few days apart? Did you see a
warning printed?

If the time differences are very un-even, the whole activity may be
pretty meaningless (with current implementation), and a mapping to
stricter regularity might help. We have coding Friday tomorrow, drop by
or send something useful and we might be able to work it out.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/dab2c88e/attachment.bin>

From ben.graeler at uni-muenster.de  Thu Feb 13 14:33:03 2014
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Thu, 13 Feb 2014 14:33:03 +0100
Subject: [R-sig-Geo] Spacetime regression
In-Reply-To: <52FCC1EC.60406@uni-muenster.de>
References: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>
	<52FCC1EC.60406@uni-muenster.de>
Message-ID: <52FCC98F.7020608@uni-muenster.de>

On 13.02.2014 14:00, Edzer Pebesma wrote:
> On 02/13/2014 01:30 PM, Roelof Coster wrote:
>> When I make the sample space-time variogram (with variogramST), it
>> automatically chooses a time-lag difference of about 2 days. This is much
>> too small to be meaningful for my data; half-year periods would be
>> interesting. Is there a way to tell this to the variogramST function?
> 
> variogramST (in package gstat) assumes that the time gap between
> observations is constant. If you have "approximately every half year"
> observations, are some of them only a few days apart? Did you see a
> warning printed?
> 
> If the time differences are very un-even, the whole activity may be
> pretty meaningless (with current implementation), and a mapping to
> stricter regularity might help. We have coding Friday tomorrow, drop by
> or send something useful and we might be able to work it out.
A "quick" work around along Edzer's suggestion could be the following:
Currently, variogramST calculates the empirical variogram per temporal
lag tlag for pairs of spatial slices such as (STFDF[,i], STFDF[,i+tlag])
while tlag is from a vector like tlags=0:5.
Given your data has been collected within a couple of days every half
year and encoded as such, you might want to use fake dates that set all
these entries to the same point in time, i.e. the same temporal index.
This way, STFDF[,i] and STFDF[,i+1] would return two time slices half a
year (in fake dates) apart from each other and that would be the
temporal width variorgamST would be using as well.
Otherwise, lets say your data has continuously be recorded while a
sensor moved across the Netherlands revisiting each point every half
year, some more careful thinking would be needed.

However, the usefulness of spatio-temporal kriging depends on the
spatio-temporal properties of the process you are looking at (i.e. will
there be any explanatory value between observations separated half a year).

HTH,

 Ben

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 560 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/6607db38/attachment.bin>

From ldecola at comcast.net  Thu Feb 13 17:54:20 2014
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Thu, 13 Feb 2014 16:54:20 +0000 (UTC)
Subject: [R-sig-Geo] Spacetime regression
In-Reply-To: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>
Message-ID: <1704560105.87964.1392310460593.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/81517c17/attachment.pl>

From tkeitt at utexas.edu  Thu Feb 13 19:26:30 2014
From: tkeitt at utexas.edu (Tim Keitt)
Date: Thu, 13 Feb 2014 12:26:30 -0600
Subject: [R-sig-Geo] A bit of new code
Message-ID: <CANnL8godyKXHSK3g2XUd7CGKEpFFUm8348KsC6yhBMJK5XgTSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/f061e768/attachment.pl>

From roelofcoster at gmail.com  Thu Feb 13 21:57:24 2014
From: roelofcoster at gmail.com (Roelof Coster)
Date: Thu, 13 Feb 2014 21:57:24 +0100
Subject: [R-sig-Geo] Spacetime regression
In-Reply-To: <1704560105.87964.1392310460593.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
References: <CAPTd6_t_5k=a2YXkS6uhc4Uu=t-DJHdmnRzY0-AS6nC22GSa3A@mail.gmail.com>
	<1704560105.87964.1392310460593.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
Message-ID: <CAPTd6_s5=sKKkvsCUVDqyHZXr47+mpu9pNZLycgLyTQpzGr+dg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140213/72b2afbf/attachment.pl>

From Roger.Bivand at nhh.no  Fri Feb 14 09:59:12 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 14 Feb 2014 09:59:12 +0100
Subject: [R-sig-Geo] A bit of new code
In-Reply-To: <CANnL8godyKXHSK3g2XUd7CGKEpFFUm8348KsC6yhBMJK5XgTSA@mail.gmail.com>
References: <CANnL8godyKXHSK3g2XUd7CGKEpFFUm8348KsC6yhBMJK5XgTSA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1402140941001.3345@reclus.nhh.no>

Tim,

Thanks for taking the initiative on this, re:

https://stat.ethz.ch/pipermail/r-sig-geo/2014-January/020241.html

Your choice of Rcpp is one that the extension of R to include reference 
classes recently, provoked by Rcpp, makes possible and attractive.

Would you prefer to use this list for postings with regard to rgdal2, or 
gdal-dev, the wiki on the github repository, or some alternative?

Would you consider perhaps aligning rgdal2 with GDAL 2.0, rather than the 
GDAL 1.* series? In GDAL 2, breaking changes will be introduced - as Even 
writes: "this will require projects using GDAL to adapt multiple times":

http://lists.osgeo.org/pipermail/gdal-dev/2014-February/038126.html

This would give rgdal2 the advantage of being ready when GDAL 2 is ready, 
and puts GDAL 1.* and rgdal in "maintenance mode" while GDAL 1.* is still 
with us?

I see many issues with clang and gcc 4.8.2 in the present code, but this 
isn't the right forum to take them up. Probably also building with clang 
is sensible future-proofing. On the R side, I've recently been running CMD 
check with pqR too (but some pqR efficiency changes are being applied to 
R-devel anyway, so other R-like engines are maybe not so important.

Finally, do you know whether Julia supports an Rcpp-like interface, in 
which case jgdal2 might also be a personality of what you are proposing?

I'll post this on gdal-dev too.

Roger

On Thu, 13 Feb 2014, Tim Keitt wrote:

> Hi All,
>
> I've made a start on a rewrite of rgdal. You can find it at
> https://github.com/thk686/rgdal2.
>
> There is still lots to do. I would be happy to have a GSOC student work on
> this project if anyone is interested (via R or OSGeo). In particular I
> would really like to have a test suite. Writing the examples is what is
> slowing me down at this point.
>
> I do not store the auto-generated files in git, so you need roxygen2 and
> Rcpp to build.
>
> Some of the goals of the project are to expose GDAL/OGR facilities through
> a native R interface emulating arrays, lists, etc; to make it easy to
> iterate over raster blocks and vector features; and to provide support for
> raster-vector operations.
>
> It is semi-useable at this point; I'd be happy to have folks test it out.
>
> THK
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From oscar.perpinan at upm.es  Fri Feb 14 13:10:00 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Fri, 14 Feb 2014 13:10:00 +0100
Subject: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with
 attribute table
In-Reply-To: <759254E7AC2B1A4D834095DE4D652AA253AE6B2D@P2KITMBX02WC01.unicph.domain>
References: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>
	<CAMLL7bmw9Yb7n4xaje1cCx-Avo-OGNc-PCF7wvjG+wqT1feQhw@mail.gmail.com>
	<759254E7AC2B1A4D834095DE4D652AA253AE6B2D@P2KITMBX02WC01.unicph.domain>
Message-ID: <CAMLL7bmoo+4QA3Cm4jP7yzZE8oMpts8+CXWCuK+M03EYPPJD5g@mail.gmail.com>

I can't reproduce your error. What version of raster are you using?

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-12 8:52 GMT+01:00 Gregor Ratzmann <tvh110 at alumni.ku.dk>:
> Thanks for your reply, Oscar,
>
> I'm sorry if the code appears somewhat confusing so I try to explain what it is supposed to do.
>
> So if I use the example from the ratify function help:
>
> r <- raster(nrow=10, ncol=10)
> r[] = 1
> r[51:100] = 2
> r[3:6, 1:5] = 3
> r <- ratify(r)
>
> rat <- levels(r)[[1]]
> rat$landcover <- c('Pine', 'Oak', 'Meadow')
> rat$code <- c(12,25,30)
> levels(r) <- rat
>
> cols=c("red","green","blue")
>
> levelplot(r,col.regions=cols)
>
>
> everything works fine as expected.
>
> So I will try to explain what my code is supposed to do. I have a thematic raster with attribute table. The raster takes on values between 1 and 28 each value representing one class. The value and corresponding class name are stored in the attribute tables column 5 and 4, respectively.
>
> #First I load the raster with the attribute table and color table
>
> r<-raster(##some raster with attribute and colortable##))
>
> #then I create a data frame from the levels of the thematic raster
>
> ratdf<-as.data.frame(levels(r))
>
>
> #now I extract column 5 of the RAT df which holds the IDs
>
> rat<-as.data.frame(ratdf[[5]])
>
> #Next step: create a vector with the classnames from RAT df col 4
>
> nvec<-as.character(ratdf[[4]])
>
> #then join the class names vector with the ID data frame
>
> rat$classes<-nvec
>
> #assign the column names of rat
> names(rat)<-c("ID","classes")
>
> #create an empty raster r1 from the r template
>
> r1<-raster(r)
>
> #assign the values of r to r1
>
> r1[]<-r[]
>
> #make a thematic raster of r1
>
> r1<-ratify(r1)
>
> #assign the levels to r1 from rat
>
> levels(r1)<-rat
>
>
> #next steps are to create a color ramp with only the valid colors (since the original raster is 8 bit it could contain up to 256 #colors but I only need colors 2 to 29) and plot the thing
>
> cols<-r at legend@colortable
> cols<-cols[2:29]
>
> levelplot(r1,col.regions=cols)
>
> ####
>
>
> What puzzles me is that after I created the new thematic raster with ratify, and I call the raster, it is displayed but under attributes appears the error: Error in 1:ncol(r) : argument of length 0. Maybe this has something to do with the problems plotting that raster. Btw, the same error appears as well when I use as.factor instead of ratify...
>
> Cheers
>
> greg
>
> ________________________________________
> Von: oscar.perpinan at gmail.com [oscar.perpinan at gmail.com]&quot; im Auftrag von &quot;Oscar Perpi?an [oscar.perpinan at upm.es]
> Gesendet: Freitag, 7. Februar 2014 19:40
> An: Gregor Ratzmann
> Cc: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with attribute table
>
> Hello,
>
>> I am trying to plot a raster which comes with an attribute table and a colortable using the rasterVis levelplot function.
>>
>> Here is my first question: is it possible to address the colortable slot directly in the levelplot function (as is possible for the plot3D through the useLegend argument)?
>
> Not yet. It is still in my To-do list.
>
>> Since I did not find a way to do it, I tried the below. Note that the original attribute table is not arranged as is neccessary for levelplot to read it so I first create a new raster and assign to it the attributes which are needed:
>> I know the procedure is improvable but for now I think it should do. The problem: Everything is plotted fine as expected, except that the last two classes of the raster are assigned the same color. Since there are the same number of classes as number of colors I do not really understand why this happens and, strange enough, in the color key all colors are plotted fine with the correct labels....additionally, when i do it using the plot() function it is working fine. When I used a different color ramp for levelplot it worked out for all classes and everything was well differentiated... Is there maybe some hex color code which levelplot can't read? Please appologize if I didn't express clearly what I want but I am still at the beginning of using R.
>
> I don't understand what you are trying to do with your code. Could you
> provide a reproducible example? Try the examples of the ratify help
> page.
>
> Best,
>
> Oscar.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tvh110 at alumni.ku.dk  Fri Feb 14 13:25:21 2014
From: tvh110 at alumni.ku.dk (Gregor Ratzmann)
Date: Fri, 14 Feb 2014 12:25:21 +0000
Subject: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with
 attribute table
In-Reply-To: <CAMLL7bmoo+4QA3Cm4jP7yzZE8oMpts8+CXWCuK+M03EYPPJD5g@mail.gmail.com>
References: <759254E7AC2B1A4D834095DE4D652AA253AE430E@P2KITMBX02WC01.unicph.domain>
	<CAMLL7bmw9Yb7n4xaje1cCx-Avo-OGNc-PCF7wvjG+wqT1feQhw@mail.gmail.com>
	<759254E7AC2B1A4D834095DE4D652AA253AE6B2D@P2KITMBX02WC01.unicph.domain>,
	<CAMLL7bmoo+4QA3Cm4jP7yzZE8oMpts8+CXWCuK+M03EYPPJD5g@mail.gmail.com>
Message-ID: <759254E7AC2B1A4D834095DE4D652AA253AE7B42@P2KITMBX02WC01.unicph.domain>

Here are all versions of packages which are loaded during the session:

[1] rgdal_0.8-16        rasterVis_0.27      hexbin_1.26.3       latticeExtra_0.6-26 RColorBrewer_1.0-5 
[6] lattice_0.20-23     raster_2.2-12       sp_1.0-14    

Think should be the latest?

I looked a little bit into that error which is returned by ratify() and as.factor() when I used my rasters ( Error in 1:ncol(r) : argument of length 0) and found this: https://stat.ethz.ch/pipermail/r-help/2013-December/364489.html 

Maybe it has something to do with that error? I tried to do the plotting using spplot, and there it works perfectly...

Greg 
________________________________________
Von: oscar.perpinan at gmail.com [oscar.perpinan at gmail.com]&quot; im Auftrag von &quot;Oscar Perpi?an [oscar.perpinan at upm.es]
Gesendet: Freitag, 14. Februar 2014 13:10
An: Gregor Ratzmann
Cc: r-sig-geo at r-project.org
Betreff: Re: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with attribute table

I can't reproduce your error. What version of raster are you using?

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-12 8:52 GMT+01:00 Gregor Ratzmann <tvh110 at alumni.ku.dk>:
> Thanks for your reply, Oscar,
>
> I'm sorry if the code appears somewhat confusing so I try to explain what it is supposed to do.
>
> So if I use the example from the ratify function help:
>
> r <- raster(nrow=10, ncol=10)
> r[] = 1
> r[51:100] = 2
> r[3:6, 1:5] = 3
> r <- ratify(r)
>
> rat <- levels(r)[[1]]
> rat$landcover <- c('Pine', 'Oak', 'Meadow')
> rat$code <- c(12,25,30)
> levels(r) <- rat
>
> cols=c("red","green","blue")
>
> levelplot(r,col.regions=cols)
>
>
> everything works fine as expected.
>
> So I will try to explain what my code is supposed to do. I have a thematic raster with attribute table. The raster takes on values between 1 and 28 each value representing one class. The value and corresponding class name are stored in the attribute tables column 5 and 4, respectively.
>
> #First I load the raster with the attribute table and color table
>
> r<-raster(##some raster with attribute and colortable##))
>
> #then I create a data frame from the levels of the thematic raster
>
> ratdf<-as.data.frame(levels(r))
>
>
> #now I extract column 5 of the RAT df which holds the IDs
>
> rat<-as.data.frame(ratdf[[5]])
>
> #Next step: create a vector with the classnames from RAT df col 4
>
> nvec<-as.character(ratdf[[4]])
>
> #then join the class names vector with the ID data frame
>
> rat$classes<-nvec
>
> #assign the column names of rat
> names(rat)<-c("ID","classes")
>
> #create an empty raster r1 from the r template
>
> r1<-raster(r)
>
> #assign the values of r to r1
>
> r1[]<-r[]
>
> #make a thematic raster of r1
>
> r1<-ratify(r1)
>
> #assign the levels to r1 from rat
>
> levels(r1)<-rat
>
>
> #next steps are to create a color ramp with only the valid colors (since the original raster is 8 bit it could contain up to 256 #colors but I only need colors 2 to 29) and plot the thing
>
> cols<-r at legend@colortable
> cols<-cols[2:29]
>
> levelplot(r1,col.regions=cols)
>
> ####
>
>
> What puzzles me is that after I created the new thematic raster with ratify, and I call the raster, it is displayed but under attributes appears the error: Error in 1:ncol(r) : argument of length 0. Maybe this has something to do with the problems plotting that raster. Btw, the same error appears as well when I use as.factor instead of ratify...
>
> Cheers
>
> greg
>
> ________________________________________
> Von: oscar.perpinan at gmail.com [oscar.perpinan at gmail.com]&quot; im Auftrag von &quot;Oscar Perpi?an [oscar.perpinan at upm.es]
> Gesendet: Freitag, 7. Februar 2014 19:40
> An: Gregor Ratzmann
> Cc: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] rasterVis levelplot: Use colortable in raster with attribute table
>
> Hello,
>
>> I am trying to plot a raster which comes with an attribute table and a colortable using the rasterVis levelplot function.
>>
>> Here is my first question: is it possible to address the colortable slot directly in the levelplot function (as is possible for the plot3D through the useLegend argument)?
>
> Not yet. It is still in my To-do list.
>
>> Since I did not find a way to do it, I tried the below. Note that the original attribute table is not arranged as is neccessary for levelplot to read it so I first create a new raster and assign to it the attributes which are needed:
>> I know the procedure is improvable but for now I think it should do. The problem: Everything is plotted fine as expected, except that the last two classes of the raster are assigned the same color. Since there are the same number of classes as number of colors I do not really understand why this happens and, strange enough, in the color key all colors are plotted fine with the correct labels....additionally, when i do it using the plot() function it is working fine. When I used a different color ramp for levelplot it worked out for all classes and everything was well differentiated... Is there maybe some hex color code which levelplot can't read? Please appologize if I didn't express clearly what I want but I am still at the beginning of using R.
>
> I don't understand what you are trying to do with your code. Could you
> provide a reproducible example? Try the examples of the ratify help
> page.
>
> Best,
>
> Oscar.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Fri Feb 14 15:31:02 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 14 Feb 2014 14:31:02 +0000
Subject: [R-sig-Geo] Interrupted Goode Homolosine forest data
In-Reply-To: <be71cb1d8a874ebbbb376d9694ca1113@EX-0-HT0.lancs.local>
References: <be71cb1d8a874ebbbb376d9694ca1113@EX-0-HT0.lancs.local>
Message-ID: <CANVKczM5J141wjc=EMfPTGzoqSmp5=MKEVVKYhpYH14fRy4g5Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140214/2cf67801/attachment.pl>

From subbu_843 at yahoo.co.in  Fri Feb 14 16:01:44 2014
From: subbu_843 at yahoo.co.in (subash)
Date: Fri, 14 Feb 2014 07:01:44 -0800 (PST)
Subject: [R-sig-Geo] spsample creates more or less number of points
Message-ID: <1392390104688-7585747.post@n2.nabble.com>

Dear Group,

I am trying to create a points inside a spatial pixel data frame. I would
like create 100 points. Why are the number of created more than or sometimes
less than 100.


data(meuse.grid)
gridded(meuse.grid) = ~x+y
pnts = spsample(meuse.grid,type = "regular",n=100,offset = c(0.5,0.5))
spplot(meuse.grid, "dist",sp.layout = list("sp.points", pnts))

Similarly I am create a fixed 25 points in all polygon of sptial polygon
data frame . How would I achieve it?

Thanks in advance.

Subash



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spsample-creates-more-or-less-number-of-points-tp7585747.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tkeitt at utexas.edu  Fri Feb 14 16:48:52 2014
From: tkeitt at utexas.edu (Tim Keitt)
Date: Fri, 14 Feb 2014 09:48:52 -0600
Subject: [R-sig-Geo] A bit of new code
In-Reply-To: <alpine.LRH.2.03.1402140941001.3345@reclus.nhh.no>
References: <CANnL8godyKXHSK3g2XUd7CGKEpFFUm8348KsC6yhBMJK5XgTSA@mail.gmail.com>
	<alpine.LRH.2.03.1402140941001.3345@reclus.nhh.no>
Message-ID: <CANnL8gq0U71EeC__p=nT1h6cn=ewA-BYF8FeqVhGqtjwG+fUZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140214/34f80722/attachment.pl>

From mdsumner at gmail.com  Fri Feb 14 21:46:55 2014
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 15 Feb 2014 07:46:55 +1100
Subject: [R-sig-Geo] Interrupted Goode Homolosine forest data
In-Reply-To: <CANVKczM5J141wjc=EMfPTGzoqSmp5=MKEVVKYhpYH14fRy4g5Q@mail.gmail.com>
References: <be71cb1d8a874ebbbb376d9694ca1113@EX-0-HT0.lancs.local>
	<CANVKczM5J141wjc=EMfPTGzoqSmp5=MKEVVKYhpYH14fRy4g5Q@mail.gmail.com>
Message-ID: <CAAcGz99k8xHrUXckLVuTceRTCPzMJc4=v1Puj7COq-DF1DLMNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140215/4ea83b29/attachment.pl>

From brianbuma at gmail.com  Sat Feb 15 06:42:58 2014
From: brianbuma at gmail.com (Brian Buma)
Date: Fri, 14 Feb 2014 20:42:58 -0900
Subject: [R-sig-Geo] Speeding raster processing function
Message-ID: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140214/cf5b37ec/attachment.pl>

From FloBetz at web.de  Sat Feb 15 11:10:23 2014
From: FloBetz at web.de (Florian Betz)
Date: Sat, 15 Feb 2014 11:10:23 +0100
Subject: [R-sig-Geo] Speeding raster processing function
In-Reply-To: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
References: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
Message-ID: <52FF3D0F.5010809@web.de>

Hi Brian,

maybe you could also have a look at the wind.shelter function in the 
RSAGA package? It gives you an index for the exposure/shelter of a 
surface to the wind and works quite well.
Of course, this does not really solve your code problem, but might be a 
faster alternative...

Regards,

Flo


> Hey all, I have a challenge that I'm fairly stuck on.  There is likely a
> fast solution, but I don't know what it is.  I'm trying to create a fast
> function to calculate exposure to wind based on topography (similar to
> Boose et al.).  It's conceptually simple, in that it's similar to a
> viewshed - if you're sheltered from a higher elevation down wind, you
> aren't exposed.  But, the wind is allowed to "bend" down at a given angle.
> So I need to calculate exposure to wind that bends down a bit (like a
> viewshed, but the light can bend down a tad).  That bending distance is the
> "threshold."
>
> I've got a function that works, but it's very slow.  I know why - it's slow
> because it's running cell by cell.  But I'm at a loss as to how to
> calculate exposure for the whole raster at a time - mainly because of that
> bending.
>
> I've tried translating the raster via the shift function, but haven't
> gotten that to work.  Currently, I have a function to extract the
> elevations over a line at a given angle/distance.  Then I calculate the
> angles, and if any angle is larger than the threshold angle, the point is
> sheltered.  If not angles are less, it's not.
>
> There must be a faster way, however.  I imagine there's a clever way to
> take advantage of rasters decent computing speed, but my function is the
> bottleneck.  Any thoughts?  I've tried working on this for a while, and I'm
> at the point where it's just fast enough for what I need, if I run it over
> the weekend (64bit, 8mb ram, i7 intel).  Code is pasted below.  I've put
> off posting this here hoping to figure it out myself, but I'm not making a
> lot of headway, and it's easier to explain by posting code than anything
> else.
>
> Thanks in advance!
>
>
> #Code#
>
> ###################
> require(rgeos)
> library(raster)
> library(rgdal)
>
> #parameters for later
> angle.list <- c(90,180)   #180is south
> dem <- dem    #any dem in UTM coordinates
>
> #function to extract location at given angle and distance.  0 is due
> north.  angle in degrees.  I found this online somewhere- would love to
> attribute it to the right person but don't remember where I found it.
>
> ####
> retPoCordinates <- function(center,angle,distance){
>      angle <- (angle+90)*.0174532925    #convert to radians.
>      x <- round(center at coords[1,1] + distance * cos(angle),0)
>      y <- round(center at coords[1,2] + distance * sin(angle),0)
>      result <- as.data.frame(cbind(x,y));names(result) <- c("x","y")
>      return(result)
>      }
>
> ################
> #Main function
> #
> ################
> out <- function(dem, deflect, angle.list,max.dist) {
> #note that the dem raster must be in UTM
>
> #direction
> num.angle <- length(angle.list)
> start.ang <- 1
>
> while (start.ang <= num.angle) {                    #for multiple angles,
> single deflection degree
>
>      angle <- angle.list[start.ang]
>
>      num.dist <- round(max.dist/res(dem)[1]/2)            #number of
> distances to check, basically goes every other cell for speed.
>      distance <- seq(res(dem)[1],max.dist,length.out=num.dist)
>
>      #temp storage
>      dist.store <- matrix(nrow=length(distance),ncol=1)
>      output <- dem*0
>      output <- as.matrix(output)
>      output <- as.vector(output)
>
>      #initial elevation vector
>      temp.elev <- extract(dem, 1:ncell(dem), df = TRUE)
>      temp.elev[is.na(temp.elev)==T] <- 0
>
>      #initial xy coordinates vector
>      cells <- temp.elev$ID
>      cells <- temp.elev$ID[which(temp.elev[,2]>0)]
>      coords <- xyFromCell(dem,cells,spatial=T)
>
>      #for each cell in matrix
>      index <- length(cells)
>      s <- 1
>      d <- res(dem)[1]
>
>      while (s <= index) {                             #bottleneck.
>
>          i <- cells[s]
>
>          #remove NA
>          g.elev <- ifelse(is.na(temp.elev[i,2]),0,temp.elev[i,2])
>
>          #if g.elev = 0,
>          if (g.elev == 0) {
>              temp.out <- -1
>              } else {
>
>              #calculate location at distance
>              out <- retPoCordinates(coords[s],angle,distance)
>
>              out <- SpatialPoints(out,proj4string=CRS(projection(dem)))
>              comp.elev <- extract(dem,out)
>
>              diff <- comp.elev - g.elev
>              temp <- diff/distance
>              ang <- atan(temp)*57.2958
>
>              #elminate NA's
>              ang <- ifelse(is.na(ang)==T,-100,ang)
>
>              #testing
>              #print(ang)
>              #plot(out,add=T)
>
>              temp.out <- ifelse(max(ang)>deflect,0,1)
>              }
>
>          output[i] <- temp.out
>          print(s/length(cells))
>          s <- s+1
>      }
>
>      #save output
>      t <- matrix(output,nrow=nrow(dem),ncol=ncol(dem),byrow=T)
>      t <- raster(t)
>      projection(t) <- projection(dem)
>      extent(t) <- extent(dem)
>      nam <- paste("angle",angle,deflect,"search",max.dist,sep="_")
>      assign(nam,t)
>
>      temp <- get(nam)
>      writeRaster(temp,nam,format="ascii",overwrite=T)
>      rm(temp)
>      gc()
>
>
>      start.ang <- start.ang + 1
>      }
> }
>
> #to execute
> out(dem,1,angle.list,3000)   #this would calculate the exposure with a
> threshold of 1 degree bending (so not much), for the angle list (3 angles),
> and search out 3000m
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From liov2067 at gmail.com  Sat Feb 15 15:45:12 2014
From: liov2067 at gmail.com (=?ISO-8859-1?Q?Luis_Iv=E1n_Ortiz_Valencia?=)
Date: Sat, 15 Feb 2014 12:45:12 -0200
Subject: [R-sig-Geo] Question off topic
Message-ID: <CAJ+S-MEMA0Dtri5m2XiejLYFSN3ADqzXEBqvbyh1sLnAtDxTxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140215/5fe4acef/attachment.pl>

From Roger.Bivand at nhh.no  Sat Feb 15 16:24:03 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 15 Feb 2014 16:24:03 +0100
Subject: [R-sig-Geo] Question off topic
In-Reply-To: <CAJ+S-MEMA0Dtri5m2XiejLYFSN3ADqzXEBqvbyh1sLnAtDxTxA@mail.gmail.com>
References: <CAJ+S-MEMA0Dtri5m2XiejLYFSN3ADqzXEBqvbyh1sLnAtDxTxA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1402151620530.11736@reclus.nhh.no>

On Sat, 15 Feb 2014, Luis Iv?n Ortiz Valencia wrote:

> Sorry for simple question.
>
> Is it correct to say that a CAR model is a spatial lag model and a SAR
> model is a error spatial model.?

No, it is not. The spatial lag and spatial error models are both SAR - 
simultaneous autoregressive, while CAR is conditional autoregressive and 
is not directly comparable. See books by Ripley (1981) or Haining (2003).

Roger

>
> I revised some literature where these concepts  are not changed.
>
> Ivan
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jgrn at illinois.edu  Sat Feb 15 19:52:44 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 15 Feb 2014 12:52:44 -0600
Subject: [R-sig-Geo] Speeding raster processing function
In-Reply-To: <52FF3D0F.5010809@web.de>
References: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
	<52FF3D0F.5010809@web.de>
Message-ID: <CABG0rfsNqC+ak7pPT4teHT5KDjhpRv5nZMx2q-DxRgWdpAk9Vw@mail.gmail.com>

Hi Brian:

Couple of things: first, viewshed analyses are notoriously complicated
and result in decidedly non-embarassingly parallel problem.  A lot of
the most efficient solutions I've seen involve GPU processing.

With that said, you might want to try to port this to my rasterEngine
framework (part of the "spatial.tools" package), where you can define
a local window size and write your function so it processes the output
for that single window (the maximum distance to search for a horizon
would be the window size).  rasterEngine will then run that function
in parallel (use sfQuickInit(cpus=however many cpus you have on your
computer)), alleviating some of the common slow-downs with
local-window processing (e.g. it will only read a pixel from your
input ONCE -- a lot of local window analyses that aren't optimized
will end up re-reading regions over and over again).

I have a tutorial at:
http://publish.illinois.edu/jgrn/software-and-datasets/rasterengine-tutorial/

I have some examples of local-window analyses on that page.  I haven't
updated the tutorial for use with some of rasterEngine's new features
you may want to also use, e.g. debugging, byte-compiling your
function, and multiple-file outputs, but you can look at those
features in the help (?rasterEngine) if you grab the latest from
r-forge:

http://r-forge.r-project.org/R/?group_id=1492

--j


On Sat, Feb 15, 2014 at 4:10 AM, Florian Betz <FloBetz at web.de> wrote:
> Hi Brian,
>
> maybe you could also have a look at the wind.shelter function in the RSAGA
> package? It gives you an index for the exposure/shelter of a surface to the
> wind and works quite well.
> Of course, this does not really solve your code problem, but might be a
> faster alternative...
>
> Regards,
>
> Flo
>
>
>
>> Hey all, I have a challenge that I'm fairly stuck on.  There is likely a
>> fast solution, but I don't know what it is.  I'm trying to create a fast
>> function to calculate exposure to wind based on topography (similar to
>> Boose et al.).  It's conceptually simple, in that it's similar to a
>> viewshed - if you're sheltered from a higher elevation down wind, you
>> aren't exposed.  But, the wind is allowed to "bend" down at a given angle.
>> So I need to calculate exposure to wind that bends down a bit (like a
>> viewshed, but the light can bend down a tad).  That bending distance is
>> the
>> "threshold."
>>
>> I've got a function that works, but it's very slow.  I know why - it's
>> slow
>> because it's running cell by cell.  But I'm at a loss as to how to
>> calculate exposure for the whole raster at a time - mainly because of that
>> bending.
>>
>> I've tried translating the raster via the shift function, but haven't
>> gotten that to work.  Currently, I have a function to extract the
>> elevations over a line at a given angle/distance.  Then I calculate the
>> angles, and if any angle is larger than the threshold angle, the point is
>> sheltered.  If not angles are less, it's not.
>>
>> There must be a faster way, however.  I imagine there's a clever way to
>> take advantage of rasters decent computing speed, but my function is the
>> bottleneck.  Any thoughts?  I've tried working on this for a while, and
>> I'm
>> at the point where it's just fast enough for what I need, if I run it over
>> the weekend (64bit, 8mb ram, i7 intel).  Code is pasted below.  I've put
>> off posting this here hoping to figure it out myself, but I'm not making a
>> lot of headway, and it's easier to explain by posting code than anything
>> else.
>>
>> Thanks in advance!
>>
>>
>> #Code#
>>
>> ###################
>> require(rgeos)
>> library(raster)
>> library(rgdal)
>>
>> #parameters for later
>> angle.list <- c(90,180)   #180is south
>> dem <- dem    #any dem in UTM coordinates
>>
>> #function to extract location at given angle and distance.  0 is due
>> north.  angle in degrees.  I found this online somewhere- would love to
>> attribute it to the right person but don't remember where I found it.
>>
>> ####
>> retPoCordinates <- function(center,angle,distance){
>>      angle <- (angle+90)*.0174532925    #convert to radians.
>>      x <- round(center at coords[1,1] + distance * cos(angle),0)
>>      y <- round(center at coords[1,2] + distance * sin(angle),0)
>>      result <- as.data.frame(cbind(x,y));names(result) <- c("x","y")
>>      return(result)
>>      }
>>
>> ################
>> #Main function
>> #
>> ################
>> out <- function(dem, deflect, angle.list,max.dist) {
>> #note that the dem raster must be in UTM
>>
>> #direction
>> num.angle <- length(angle.list)
>> start.ang <- 1
>>
>> while (start.ang <= num.angle) {                    #for multiple angles,
>> single deflection degree
>>
>>      angle <- angle.list[start.ang]
>>
>>      num.dist <- round(max.dist/res(dem)[1]/2)            #number of
>> distances to check, basically goes every other cell for speed.
>>      distance <- seq(res(dem)[1],max.dist,length.out=num.dist)
>>
>>      #temp storage
>>      dist.store <- matrix(nrow=length(distance),ncol=1)
>>      output <- dem*0
>>      output <- as.matrix(output)
>>      output <- as.vector(output)
>>
>>      #initial elevation vector
>>      temp.elev <- extract(dem, 1:ncell(dem), df = TRUE)
>>      temp.elev[is.na(temp.elev)==T] <- 0
>>
>>      #initial xy coordinates vector
>>      cells <- temp.elev$ID
>>      cells <- temp.elev$ID[which(temp.elev[,2]>0)]
>>      coords <- xyFromCell(dem,cells,spatial=T)
>>
>>      #for each cell in matrix
>>      index <- length(cells)
>>      s <- 1
>>      d <- res(dem)[1]
>>
>>      while (s <= index) {                             #bottleneck.
>>
>>          i <- cells[s]
>>
>>          #remove NA
>>          g.elev <- ifelse(is.na(temp.elev[i,2]),0,temp.elev[i,2])
>>
>>          #if g.elev = 0,
>>          if (g.elev == 0) {
>>              temp.out <- -1
>>              } else {
>>
>>              #calculate location at distance
>>              out <- retPoCordinates(coords[s],angle,distance)
>>
>>              out <- SpatialPoints(out,proj4string=CRS(projection(dem)))
>>              comp.elev <- extract(dem,out)
>>
>>              diff <- comp.elev - g.elev
>>              temp <- diff/distance
>>              ang <- atan(temp)*57.2958
>>
>>              #elminate NA's
>>              ang <- ifelse(is.na(ang)==T,-100,ang)
>>
>>              #testing
>>              #print(ang)
>>              #plot(out,add=T)
>>
>>              temp.out <- ifelse(max(ang)>deflect,0,1)
>>              }
>>
>>          output[i] <- temp.out
>>          print(s/length(cells))
>>          s <- s+1
>>      }
>>
>>      #save output
>>      t <- matrix(output,nrow=nrow(dem),ncol=ncol(dem),byrow=T)
>>      t <- raster(t)
>>      projection(t) <- projection(dem)
>>      extent(t) <- extent(dem)
>>      nam <- paste("angle",angle,deflect,"search",max.dist,sep="_")
>>      assign(nam,t)
>>
>>      temp <- get(nam)
>>      writeRaster(temp,nam,format="ascii",overwrite=T)
>>      rm(temp)
>>      gc()
>>
>>
>>      start.ang <- start.ang + 1
>>      }
>> }
>>
>> #to execute
>> out(dem,1,angle.list,3000)   #this would calculate the exposure with a
>> threshold of 1 degree bending (so not much), for the angle list (3
>> angles),
>> and search out 3000m
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From oscar.perpinan at gmail.com  Sat Feb 15 20:58:44 2014
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sat, 15 Feb 2014 20:58:44 +0100
Subject: [R-sig-Geo] Speeding raster processing function
In-Reply-To: <CABG0rfsNqC+ak7pPT4teHT5KDjhpRv5nZMx2q-DxRgWdpAk9Vw@mail.gmail.com>
References: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
	<52FF3D0F.5010809@web.de>
	<CABG0rfsNqC+ak7pPT4teHT5KDjhpRv5nZMx2q-DxRgWdpAk9Vw@mail.gmail.com>
Message-ID: <CAMLL7bndP7XfsEELXOK53F48N9Axgbd65anUe_M1GRs_9oLUSA@mail.gmail.com>

Hello,

Although it is a different problem, maybe our solution for downscaling
of global solar irradiation is useful for you. It is documented in
this arXiv paper: http://arxiv.org/abs/1311.7235. The code is here:
https://github.com/EDMANSolar/downscaling/blob/master/code.R (horizon
blocking with parallel computing begins at line 263).

Best,

Oscar.

-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-02-15 19:52 GMT+01:00 Jonathan Greenberg <jgrn at illinois.edu>:
> Hi Brian:
>
> Couple of things: first, viewshed analyses are notoriously complicated
> and result in decidedly non-embarassingly parallel problem.  A lot of
> the most efficient solutions I've seen involve GPU processing.
>
> With that said, you might want to try to port this to my rasterEngine
> framework (part of the "spatial.tools" package), where you can define
> a local window size and write your function so it processes the output
> for that single window (the maximum distance to search for a horizon
> would be the window size).  rasterEngine will then run that function
> in parallel (use sfQuickInit(cpus=however many cpus you have on your
> computer)), alleviating some of the common slow-downs with
> local-window processing (e.g. it will only read a pixel from your
> input ONCE -- a lot of local window analyses that aren't optimized
> will end up re-reading regions over and over again).
>
> I have a tutorial at:
> http://publish.illinois.edu/jgrn/software-and-datasets/rasterengine-tutorial/
>
> I have some examples of local-window analyses on that page.  I haven't
> updated the tutorial for use with some of rasterEngine's new features
> you may want to also use, e.g. debugging, byte-compiling your
> function, and multiple-file outputs, but you can look at those
> features in the help (?rasterEngine) if you grab the latest from
> r-forge:
>
> http://r-forge.r-project.org/R/?group_id=1492
>
> --j
>
>
> On Sat, Feb 15, 2014 at 4:10 AM, Florian Betz <FloBetz at web.de> wrote:
>> Hi Brian,
>>
>> maybe you could also have a look at the wind.shelter function in the RSAGA
>> package? It gives you an index for the exposure/shelter of a surface to the
>> wind and works quite well.
>> Of course, this does not really solve your code problem, but might be a
>> faster alternative...
>>
>> Regards,
>>
>> Flo
>>
>>
>>
>>> Hey all, I have a challenge that I'm fairly stuck on.  There is likely a
>>> fast solution, but I don't know what it is.  I'm trying to create a fast
>>> function to calculate exposure to wind based on topography (similar to
>>> Boose et al.).  It's conceptually simple, in that it's similar to a
>>> viewshed - if you're sheltered from a higher elevation down wind, you
>>> aren't exposed.  But, the wind is allowed to "bend" down at a given angle.
>>> So I need to calculate exposure to wind that bends down a bit (like a
>>> viewshed, but the light can bend down a tad).  That bending distance is
>>> the
>>> "threshold."
>>>
>>> I've got a function that works, but it's very slow.  I know why - it's
>>> slow
>>> because it's running cell by cell.  But I'm at a loss as to how to
>>> calculate exposure for the whole raster at a time - mainly because of that
>>> bending.
>>>
>>> I've tried translating the raster via the shift function, but haven't
>>> gotten that to work.  Currently, I have a function to extract the
>>> elevations over a line at a given angle/distance.  Then I calculate the
>>> angles, and if any angle is larger than the threshold angle, the point is
>>> sheltered.  If not angles are less, it's not.
>>>
>>> There must be a faster way, however.  I imagine there's a clever way to
>>> take advantage of rasters decent computing speed, but my function is the
>>> bottleneck.  Any thoughts?  I've tried working on this for a while, and
>>> I'm
>>> at the point where it's just fast enough for what I need, if I run it over
>>> the weekend (64bit, 8mb ram, i7 intel).  Code is pasted below.  I've put
>>> off posting this here hoping to figure it out myself, but I'm not making a
>>> lot of headway, and it's easier to explain by posting code than anything
>>> else.
>>>
>>> Thanks in advance!
>>>
>>>
>>> #Code#
>>>
>>> ###################
>>> require(rgeos)
>>> library(raster)
>>> library(rgdal)
>>>
>>> #parameters for later
>>> angle.list <- c(90,180)   #180is south
>>> dem <- dem    #any dem in UTM coordinates
>>>
>>> #function to extract location at given angle and distance.  0 is due
>>> north.  angle in degrees.  I found this online somewhere- would love to
>>> attribute it to the right person but don't remember where I found it.
>>>
>>> ####
>>> retPoCordinates <- function(center,angle,distance){
>>>      angle <- (angle+90)*.0174532925    #convert to radians.
>>>      x <- round(center at coords[1,1] + distance * cos(angle),0)
>>>      y <- round(center at coords[1,2] + distance * sin(angle),0)
>>>      result <- as.data.frame(cbind(x,y));names(result) <- c("x","y")
>>>      return(result)
>>>      }
>>>
>>> ################
>>> #Main function
>>> #
>>> ################
>>> out <- function(dem, deflect, angle.list,max.dist) {
>>> #note that the dem raster must be in UTM
>>>
>>> #direction
>>> num.angle <- length(angle.list)
>>> start.ang <- 1
>>>
>>> while (start.ang <= num.angle) {                    #for multiple angles,
>>> single deflection degree
>>>
>>>      angle <- angle.list[start.ang]
>>>
>>>      num.dist <- round(max.dist/res(dem)[1]/2)            #number of
>>> distances to check, basically goes every other cell for speed.
>>>      distance <- seq(res(dem)[1],max.dist,length.out=num.dist)
>>>
>>>      #temp storage
>>>      dist.store <- matrix(nrow=length(distance),ncol=1)
>>>      output <- dem*0
>>>      output <- as.matrix(output)
>>>      output <- as.vector(output)
>>>
>>>      #initial elevation vector
>>>      temp.elev <- extract(dem, 1:ncell(dem), df = TRUE)
>>>      temp.elev[is.na(temp.elev)==T] <- 0
>>>
>>>      #initial xy coordinates vector
>>>      cells <- temp.elev$ID
>>>      cells <- temp.elev$ID[which(temp.elev[,2]>0)]
>>>      coords <- xyFromCell(dem,cells,spatial=T)
>>>
>>>      #for each cell in matrix
>>>      index <- length(cells)
>>>      s <- 1
>>>      d <- res(dem)[1]
>>>
>>>      while (s <= index) {                             #bottleneck.
>>>
>>>          i <- cells[s]
>>>
>>>          #remove NA
>>>          g.elev <- ifelse(is.na(temp.elev[i,2]),0,temp.elev[i,2])
>>>
>>>          #if g.elev = 0,
>>>          if (g.elev == 0) {
>>>              temp.out <- -1
>>>              } else {
>>>
>>>              #calculate location at distance
>>>              out <- retPoCordinates(coords[s],angle,distance)
>>>
>>>              out <- SpatialPoints(out,proj4string=CRS(projection(dem)))
>>>              comp.elev <- extract(dem,out)
>>>
>>>              diff <- comp.elev - g.elev
>>>              temp <- diff/distance
>>>              ang <- atan(temp)*57.2958
>>>
>>>              #elminate NA's
>>>              ang <- ifelse(is.na(ang)==T,-100,ang)
>>>
>>>              #testing
>>>              #print(ang)
>>>              #plot(out,add=T)
>>>
>>>              temp.out <- ifelse(max(ang)>deflect,0,1)
>>>              }
>>>
>>>          output[i] <- temp.out
>>>          print(s/length(cells))
>>>          s <- s+1
>>>      }
>>>
>>>      #save output
>>>      t <- matrix(output,nrow=nrow(dem),ncol=ncol(dem),byrow=T)
>>>      t <- raster(t)
>>>      projection(t) <- projection(dem)
>>>      extent(t) <- extent(dem)
>>>      nam <- paste("angle",angle,deflect,"search",max.dist,sep="_")
>>>      assign(nam,t)
>>>
>>>      temp <- get(nam)
>>>      writeRaster(temp,nam,format="ascii",overwrite=T)
>>>      rm(temp)
>>>      gc()
>>>
>>>
>>>      start.ang <- start.ang + 1
>>>      }
>>> }
>>>
>>> #to execute
>>> out(dem,1,angle.list,3000)   #this would calculate the exposure with a
>>> threshold of 1 degree bending (so not much), for the angle list (3
>>> angles),
>>> and search out 3000m
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jecogeo at gmail.com  Sat Feb 15 22:33:25 2014
From: jecogeo at gmail.com (Jefferson Ferreira Ferreira)
Date: Sat, 15 Feb 2014 17:33:25 -0400
Subject: [R-sig-Geo] adehabitatLT | Patterns in Missing Values in Trajects
Message-ID: <CAFFT+Y7jDgmZgPS6qe0gVRxitVaNP=ttu9XTYzRRjQgGnfGmpA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140215/1c84c648/attachment.pl>

From r.hijmans at gmail.com  Sun Feb 16 02:01:08 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 15 Feb 2014 17:01:08 -0800
Subject: [R-sig-Geo] Speeding raster processing function
In-Reply-To: <CAMLL7bndP7XfsEELXOK53F48N9Axgbd65anUe_M1GRs_9oLUSA@mail.gmail.com>
References: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
	<52FF3D0F.5010809@web.de>
	<CABG0rfsNqC+ak7pPT4teHT5KDjhpRv5nZMx2q-DxRgWdpAk9Vw@mail.gmail.com>
	<CAMLL7bndP7XfsEELXOK53F48N9Axgbd65anUe_M1GRs_9oLUSA@mail.gmail.com>
Message-ID: <CANtt_hyA-bBHPqPcCVH-bJDCuW0M2JTpks3ip6CnWS6g1D7uTA@mail.gmail.com>

Brian,
Here is, I think, an improved version. Your code had many steps that
could be simplified; but removing the inner loop was key, as you
indicated. For the one example I used, this one is > 150 times faster.
More could be done (e.g. by using data.table) and it could be made
memory safe for large rasters.
Robert


library(raster)

windout <- function(dem, deflect, angles, max.dist) {
#note that the dem raster must be in planar coordinates

#for smaller datasets:
dem <- readAll(dem)
res <- res(dem)
# you are ignoring the case where x and y resolution are not equal
stopifnot(all.equal(res[1], res[2]))
xr <- res[1]
#number of distances to check, basically goes every other cell for speed.
num.dist <- round(max.dist / xr / 2)
distance <- seq(xr, max.dist, length.out=num.dist)
result <- list()
for (angle in angles) {
elev <- na.omit(data.frame(ID=1:ncell(dem), value=getValues(dem)))
coords <- xyFromCell(dem, elev$ID)

radangle <- (angle+90) * pi/180  #convert to radians.
dcosangle <- cos(radangle) * distance
dsinangle <- sin(radangle) * distance
x <- apply(coords[,1,drop=FALSE], 1, function(j) j + dcosangle)
y <- apply(coords[,2,drop=FALSE], 1, function(j) j + dsinangle)
xy <- cbind(as.vector(x), as.vector(y))

comp.elev <- extract(dem, xy)
comp.elev <- matrix(comp.elev, ncol=num.dist, byrow=TRUE)
comp.elev <- comp.elev - elev$value
comp.elev <- t(t(comp.elev) / distance)
notAllNA <- rowSums(is.na(comp.elev)) != num.dist
ang <- atan(comp.elev[notAllNA, ]) * (180 / pi)

output <- rep(NA, ncell(dem))
output[elev[notAllNA,1]] <- apply(ang, 1, max, na.rm=TRUE)

r <- setValues( dem, output <= deflect )
fname <- paste("angle", angle, deflect, "search", max.dist, sep="_")
result[as.character(angle)] <- writeRaster(r, fname, format="GTiff",
overwrite=TRUE)
}
result
}


f <- system.file("external/test.grd", package="raster")
r <- raster(f)
system.time( x <- windout(r,1,c(90,180),300) )
plot(stack(x))


On Sat, Feb 15, 2014 at 11:58 AM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> Hello,
>
> Although it is a different problem, maybe our solution for downscaling
> of global solar irradiation is useful for you. It is documented in
> this arXiv paper: http://arxiv.org/abs/1311.7235. The code is here:
> https://github.com/EDMANSolar/downscaling/blob/master/code.R (horizon
> blocking with parallel computing begins at line 263).
>
> Best,
>
> Oscar.
>
> -----------------------------------------------------------------
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
> URL: http://oscarperpinan.github.io
> Twitter: @oscarperpinan
>
>
> 2014-02-15 19:52 GMT+01:00 Jonathan Greenberg <jgrn at illinois.edu>:
>> Hi Brian:
>>
>> Couple of things: first, viewshed analyses are notoriously complicated
>> and result in decidedly non-embarassingly parallel problem.  A lot of
>> the most efficient solutions I've seen involve GPU processing.
>>
>> With that said, you might want to try to port this to my rasterEngine
>> framework (part of the "spatial.tools" package), where you can define
>> a local window size and write your function so it processes the output
>> for that single window (the maximum distance to search for a horizon
>> would be the window size).  rasterEngine will then run that function
>> in parallel (use sfQuickInit(cpus=however many cpus you have on your
>> computer)), alleviating some of the common slow-downs with
>> local-window processing (e.g. it will only read a pixel from your
>> input ONCE -- a lot of local window analyses that aren't optimized
>> will end up re-reading regions over and over again).
>>
>> I have a tutorial at:
>> http://publish.illinois.edu/jgrn/software-and-datasets/rasterengine-tutorial/
>>
>> I have some examples of local-window analyses on that page.  I haven't
>> updated the tutorial for use with some of rasterEngine's new features
>> you may want to also use, e.g. debugging, byte-compiling your
>> function, and multiple-file outputs, but you can look at those
>> features in the help (?rasterEngine) if you grab the latest from
>> r-forge:
>>
>> http://r-forge.r-project.org/R/?group_id=1492
>>
>> --j
>>
>>
>> On Sat, Feb 15, 2014 at 4:10 AM, Florian Betz <FloBetz at web.de> wrote:
>>> Hi Brian,
>>>
>>> maybe you could also have a look at the wind.shelter function in the RSAGA
>>> package? It gives you an index for the exposure/shelter of a surface to the
>>> wind and works quite well.
>>> Of course, this does not really solve your code problem, but might be a
>>> faster alternative...
>>>
>>> Regards,
>>>
>>> Flo
>>>
>>>
>>>
>>>> Hey all, I have a challenge that I'm fairly stuck on.  There is likely a
>>>> fast solution, but I don't know what it is.  I'm trying to create a fast
>>>> function to calculate exposure to wind based on topography (similar to
>>>> Boose et al.).  It's conceptually simple, in that it's similar to a
>>>> viewshed - if you're sheltered from a higher elevation down wind, you
>>>> aren't exposed.  But, the wind is allowed to "bend" down at a given angle.
>>>> So I need to calculate exposure to wind that bends down a bit (like a
>>>> viewshed, but the light can bend down a tad).  That bending distance is
>>>> the
>>>> "threshold."
>>>>
>>>> I've got a function that works, but it's very slow.  I know why - it's
>>>> slow
>>>> because it's running cell by cell.  But I'm at a loss as to how to
>>>> calculate exposure for the whole raster at a time - mainly because of that
>>>> bending.
>>>>
>>>> I've tried translating the raster via the shift function, but haven't
>>>> gotten that to work.  Currently, I have a function to extract the
>>>> elevations over a line at a given angle/distance.  Then I calculate the
>>>> angles, and if any angle is larger than the threshold angle, the point is
>>>> sheltered.  If not angles are less, it's not.
>>>>
>>>> There must be a faster way, however.  I imagine there's a clever way to
>>>> take advantage of rasters decent computing speed, but my function is the
>>>> bottleneck.  Any thoughts?  I've tried working on this for a while, and
>>>> I'm
>>>> at the point where it's just fast enough for what I need, if I run it over
>>>> the weekend (64bit, 8mb ram, i7 intel).  Code is pasted below.  I've put
>>>> off posting this here hoping to figure it out myself, but I'm not making a
>>>> lot of headway, and it's easier to explain by posting code than anything
>>>> else.
>>>>
>>>> Thanks in advance!
>>>>
>>>>
>>>> #Code#
>>>>
>>>> ###################
>>>> require(rgeos)
>>>> library(raster)
>>>> library(rgdal)
>>>>
>>>> #parameters for later
>>>> angle.list <- c(90,180)   #180is south
>>>> dem <- dem    #any dem in UTM coordinates
>>>>
>>>> #function to extract location at given angle and distance.  0 is due
>>>> north.  angle in degrees.  I found this online somewhere- would love to
>>>> attribute it to the right person but don't remember where I found it.
>>>>
>>>> ####
>>>> retPoCordinates <- function(center,angle,distance){
>>>>      angle <- (angle+90)*.0174532925    #convert to radians.
>>>>      x <- round(center at coords[1,1] + distance * cos(angle),0)
>>>>      y <- round(center at coords[1,2] + distance * sin(angle),0)
>>>>      result <- as.data.frame(cbind(x,y));names(result) <- c("x","y")
>>>>      return(result)
>>>>      }
>>>>
>>>> ################
>>>> #Main function
>>>> #
>>>> ################
>>>> out <- function(dem, deflect, angle.list,max.dist) {
>>>> #note that the dem raster must be in UTM
>>>>
>>>> #direction
>>>> num.angle <- length(angle.list)
>>>> start.ang <- 1
>>>>
>>>> while (start.ang <= num.angle) {                    #for multiple angles,
>>>> single deflection degree
>>>>
>>>>      angle <- angle.list[start.ang]
>>>>
>>>>      num.dist <- round(max.dist/res(dem)[1]/2)            #number of
>>>> distances to check, basically goes every other cell for speed.
>>>>      distance <- seq(res(dem)[1],max.dist,length.out=num.dist)
>>>>
>>>>      #temp storage
>>>>      dist.store <- matrix(nrow=length(distance),ncol=1)
>>>>      output <- dem*0
>>>>      output <- as.matrix(output)
>>>>      output <- as.vector(output)
>>>>
>>>>      #initial elevation vector
>>>>      temp.elev <- extract(dem, 1:ncell(dem), df = TRUE)
>>>>      temp.elev[is.na(temp.elev)==T] <- 0
>>>>
>>>>      #initial xy coordinates vector
>>>>      cells <- temp.elev$ID
>>>>      cells <- temp.elev$ID[which(temp.elev[,2]>0)]
>>>>      coords <- xyFromCell(dem,cells,spatial=T)
>>>>
>>>>      #for each cell in matrix
>>>>      index <- length(cells)
>>>>      s <- 1
>>>>      d <- res(dem)[1]
>>>>
>>>>      while (s <= index) {                             #bottleneck.
>>>>
>>>>          i <- cells[s]
>>>>
>>>>          #remove NA
>>>>          g.elev <- ifelse(is.na(temp.elev[i,2]),0,temp.elev[i,2])
>>>>
>>>>          #if g.elev = 0,
>>>>          if (g.elev == 0) {
>>>>              temp.out <- -1
>>>>              } else {
>>>>
>>>>              #calculate location at distance
>>>>              out <- retPoCordinates(coords[s],angle,distance)
>>>>
>>>>              out <- SpatialPoints(out,proj4string=CRS(projection(dem)))
>>>>              comp.elev <- extract(dem,out)
>>>>
>>>>              diff <- comp.elev - g.elev
>>>>              temp <- diff/distance
>>>>              ang <- atan(temp)*57.2958
>>>>
>>>>              #elminate NA's
>>>>              ang <- ifelse(is.na(ang)==T,-100,ang)
>>>>
>>>>              #testing
>>>>              #print(ang)
>>>>              #plot(out,add=T)
>>>>
>>>>              temp.out <- ifelse(max(ang)>deflect,0,1)
>>>>              }
>>>>
>>>>          output[i] <- temp.out
>>>>          print(s/length(cells))
>>>>          s <- s+1
>>>>      }
>>>>
>>>>      #save output
>>>>      t <- matrix(output,nrow=nrow(dem),ncol=ncol(dem),byrow=T)
>>>>      t <- raster(t)
>>>>      projection(t) <- projection(dem)
>>>>      extent(t) <- extent(dem)
>>>>      nam <- paste("angle",angle,deflect,"search",max.dist,sep="_")
>>>>      assign(nam,t)
>>>>
>>>>      temp <- get(nam)
>>>>      writeRaster(temp,nam,format="ascii",overwrite=T)
>>>>      rm(temp)
>>>>      gc()
>>>>
>>>>
>>>>      start.ang <- start.ang + 1
>>>>      }
>>>> }
>>>>
>>>> #to execute
>>>> out(dem,1,angle.list,3000)   #this would calculate the exposure with a
>>>> threshold of 1 degree bending (so not much), for the angle list (3
>>>> angles),
>>>> and search out 3000m
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Sun Feb 16 03:30:43 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 16 Feb 2014 02:30:43 +0000
Subject: [R-sig-Geo] question about unique in lon/lat
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B13566@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140216/ded863dd/attachment.pl>

From HodgessE at uhd.edu  Sun Feb 16 03:34:03 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 16 Feb 2014 02:34:03 +0000
Subject: [R-sig-Geo] question about unique in lon/lat
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217B13566@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217B13566@challenger.uhd.campus>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B13579@challenger.uhd.campus>

Just figured it out:

 unique(cbind(bigz$lon,bigz$lat))

Nothing like posting to the list to help you solve a problem.

thanks,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Hodgess, Erin [HodgessE at uhd.edu]
Sent: Saturday, February 15, 2014 8:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] question about unique in lon/lat

Hello!

I have space-time data frame.  Here are the first few rows:

              name   index        lon      lat
1   Abilene    ,TX  95.285  -99.73314 32.44874
2   Abilene    ,TX  98.603  -99.73314 32.44874
3   Abilene    ,TX 100.197  -99.73314 32.44874
4   Abilene    ,TX 102.016  -99.73314 32.44874
5   Abilene    ,TX 100.000  -99.73314 32.44874
6   Abilene    ,TX 102.822  -99.73314 32.44874
7   Abilene    ,TX 107.988  -99.73314 32.44874
8   Abilene    ,TX 110.546  -99.73314 32.44874
9   Abilene    ,TX 105.897  -99.73314 32.44874
10  Abilene    ,TX 107.642  -99.73314 32.44874
11  Abilene    ,TX 108.523  -99.73314 32.44874
12 Amarillo    ,TX  92.486 -101.83130 35.22200
13 Amarillo    ,TX  95.431 -101.83130 35.22200
14 Amarillo    ,TX  97.485 -101.83130 35.22200
15 Amarillo    ,TX  99.714 -101.83130 35.22200
16 Amarillo    ,TX 100.000 -101.83130 35.22200
17 Amarillo    ,TX 103.649 -101.83130 35.22200
18 Amarillo    ,TX 105.998 -101.83130 35.22200
19 Amarillo    ,TX 109.965 -101.83130 35.22200
20 Amarillo    ,TX 109.325 -101.83130 35.22200
21 Amarillo    ,TX 112.550 -101.83130 35.22200
22 Amarillo    ,TX 112.541 -101.83130 35.22200
23     Austin  ,TX  83.228  -97.74306 30.26715
24     Austin  ,TX  83.232  -97.74306 30.26715
25     Austin  ,TX  86.072  -97.74306 30.26715
26     Austin  ,TX  93.592  -97.74306 30.26715
>

My question is:  is there a way to get the "unique" values from lon/lat for each city, please?

Thanks,
Erin


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From brianbuma at gmail.com  Sun Feb 16 04:58:23 2014
From: brianbuma at gmail.com (Brian Buma)
Date: Sat, 15 Feb 2014 18:58:23 -0900
Subject: [R-sig-Geo] Speeding raster processing function
In-Reply-To: <CANtt_hyA-bBHPqPcCVH-bJDCuW0M2JTpks3ip6CnWS6g1D7uTA@mail.gmail.com>
References: <CAM25M7o0hrJiURdzo18jy=fZg04qTnCtnd1ZFwB9mHtCRPCCCw@mail.gmail.com>
	<52FF3D0F.5010809@web.de>
	<CABG0rfsNqC+ak7pPT4teHT5KDjhpRv5nZMx2q-DxRgWdpAk9Vw@mail.gmail.com>
	<CAMLL7bndP7XfsEELXOK53F48N9Axgbd65anUe_M1GRs_9oLUSA@mail.gmail.com>
	<CANtt_hyA-bBHPqPcCVH-bJDCuW0M2JTpks3ip6CnWS6g1D7uTA@mail.gmail.com>
Message-ID: <CAM25M7rBgWFiFvdf29m-_u7O99ExajEjuZLEcOGbE1cOGrJ-rA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140215/d5316e42/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sun Feb 16 09:38:49 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 16 Feb 2014 08:38:49 +0000
Subject: [R-sig-Geo] Interrupted Goode Homolosine forest data
In-Reply-To: <ae49ed32c4074b5aa6c37681ff8c2831@EX-0-HT0.lancs.local>
References: <be71cb1d8a874ebbbb376d9694ca1113@EX-0-HT0.lancs.local>
	<CANVKczM5J141wjc=EMfPTGzoqSmp5=MKEVVKYhpYH14fRy4g5Q@mail.gmail.com>
	<ae49ed32c4074b5aa6c37681ff8c2831@EX-0-HT0.lancs.local>
Message-ID: <CANVKczNh29LUE+_Bd13f6yG=CYtXUXnSjbzvoZQBKdzSyeecgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140216/45f935e6/attachment.pl>

From mauriziomarchi85 at gmail.com  Sun Feb 16 12:45:12 2014
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Sun, 16 Feb 2014 12:45:12 +0100
Subject: [R-sig-Geo] Presence/absence ratio: how many for SDM?
Message-ID: <CANJhsN0eFT1dj+JWpj3T8=19DaOYZUWfqo2i9tSC43urd1aGtw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140216/447baf6b/attachment.pl>

From HodgessE at uhd.edu  Mon Feb 17 01:36:36 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 17 Feb 2014 00:36:36 +0000
Subject: [R-sig-Geo] a goofy question
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B139CA@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/6cf288ee/attachment.pl>

From mdsumner at gmail.com  Mon Feb 17 01:53:40 2014
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 17 Feb 2014 11:53:40 +1100
Subject: [R-sig-Geo] a goofy question
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217B139CA@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217B139CA@challenger.uhd.campus>
Message-ID: <CAAcGz9_z6Hkm1Uon0fhTG1jx3ueT1ig_4Pv0moncYvyZd5Ygtw@mail.gmail.com>

Well, with a reproducible example this is what I (expect and) get:

coal2 <- data.frame(x1 = rnorm(10), y1 = rnorm(10), var1.pred = 10)
library(sp)
buzz <- function(x, y, u) {coordinates(u) <- ~x+y; print(str(u))}
buzz(x=coal2$x1,y=coal2$y1,u=coal2)
Error in `[.data.frame`(object, , -coord.numbers, drop = FALSE) :
  undefined columns selected


I'm not sure the formula method for "coordinates<-" is the best idea
here, try with the actual names (and think about what ~x+y is vs.
coal2$x1 and coal2$x2):

buzz <- function(x, y, u) {coordinates(u) <- c(x, y); print(str(u))}
buzz("x1", "y1", coal2)

Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 10 obs. of  1 variable:
  .. ..$ var1.pred: num [1:10] 10 10 10 10 10 10 10 10 10 10
  ..@ coords.nrs : int [1:2] 1 2
  ..@ coords     : num [1:10, 1:2] -1.112 -0.933 0.485 -0.104 -0.369 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "x1" "y1"
  ..@ bbox       : num [1:2, 1:2] -2.08 -1.15 3.19 2.04
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x1" "y1"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr NA
NULL


HTH


On Mon, Feb 17, 2014 at 11:36 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi!
>
> I have a data frame and I'm passing the column names and the df name itself into the function.  Here is my code:
>
>
>> str(coal2)
> 'data.frame':    5006 obs. of  5 variables:
>  $ x1        : num  3.99 4.2 4.41 4.62 4.83 ...
>  $ x2        : num  1.13 1.13 1.13 1.13 1.13 ...
>  $ var1.pred : num  9.91 9.87 9.83 9.79 9.77 ...
>  $ var1.var  : num  1.26 1.25 1.25 1.25 1.24 ...
>  $ var1.stdev: num  1.12 1.12 1.12 1.12 1.11 ...
>> buzz
> function(x,y,u) {
>     coordinates(u) <- ~x+y
>     print(str(u))
>     }
>> buzz(x=coal2$x1,y=coal2$x2,u=coal2)
>
>
> Shouldn't I get a print statement, please?
>
> Thanks,
> Erin
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From HodgessE at uhd.edu  Mon Feb 17 02:00:11 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 17 Feb 2014 01:00:11 +0000
Subject: [R-sig-Geo] a goofy question
In-Reply-To: <CAAcGz9_z6Hkm1Uon0fhTG1jx3ueT1ig_4Pv0moncYvyZd5Ygtw@mail.gmail.com>
References: <FF9DB805FC41CC4E95825A50F680630217B139CA@challenger.uhd.campus>,
	<CAAcGz9_z6Hkm1Uon0fhTG1jx3ueT1ig_4Pv0moncYvyZd5Ygtw@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B139FD@challenger.uhd.campus>

That's exactly perfect!  I've been working on this dumb thing all afternoon!  Thanks SO much!

Erin
________________________________________
From: Michael Sumner [mdsumner at gmail.com]
Sent: Sunday, February 16, 2014 6:53 PM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] a goofy question

Well, with a reproducible example this is what I (expect and) get:

coal2 <- data.frame(x1 = rnorm(10), y1 = rnorm(10), var1.pred = 10)
library(sp)
buzz <- function(x, y, u) {coordinates(u) <- ~x+y; print(str(u))}
buzz(x=coal2$x1,y=coal2$y1,u=coal2)
Error in `[.data.frame`(object, , -coord.numbers, drop = FALSE) :
  undefined columns selected


I'm not sure the formula method for "coordinates<-" is the best idea
here, try with the actual names (and think about what ~x+y is vs.
coal2$x1 and coal2$x2):

buzz <- function(x, y, u) {coordinates(u) <- c(x, y); print(str(u))}
buzz("x1", "y1", coal2)

Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 10 obs. of  1 variable:
  .. ..$ var1.pred: num [1:10] 10 10 10 10 10 10 10 10 10 10
  ..@ coords.nrs : int [1:2] 1 2
  ..@ coords     : num [1:10, 1:2] -1.112 -0.933 0.485 -0.104 -0.369 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "x1" "y1"
  ..@ bbox       : num [1:2, 1:2] -2.08 -1.15 3.19 2.04
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x1" "y1"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr NA
NULL


HTH


On Mon, Feb 17, 2014 at 11:36 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi!
>
> I have a data frame and I'm passing the column names and the df name itself into the function.  Here is my code:
>
>
>> str(coal2)
> 'data.frame':    5006 obs. of  5 variables:
>  $ x1        : num  3.99 4.2 4.41 4.62 4.83 ...
>  $ x2        : num  1.13 1.13 1.13 1.13 1.13 ...
>  $ var1.pred : num  9.91 9.87 9.83 9.79 9.77 ...
>  $ var1.var  : num  1.26 1.25 1.25 1.25 1.24 ...
>  $ var1.stdev: num  1.12 1.12 1.12 1.12 1.11 ...
>> buzz
> function(x,y,u) {
>     coordinates(u) <- ~x+y
>     print(str(u))
>     }
>> buzz(x=coal2$x1,y=coal2$x2,u=coal2)
>
>
> Shouldn't I get a print statement, please?
>
> Thanks,
> Erin
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Clement.Calenge at oncfs.gouv.fr  Mon Feb 17 10:03:13 2014
From: Clement.Calenge at oncfs.gouv.fr (Calenge Clement)
Date: Mon, 17 Feb 2014 09:03:13 +0000
Subject: [R-sig-Geo] adehabitatLT | Patterns in Missing Values in
 Trajects
References: <CAFFT+Y7jDgmZgPS6qe0gVRxitVaNP=ttu9XTYzRRjQgGnfGmpA@mail.gmail.com>
Message-ID: <EF5D3065747CC8438B3B16856EF7F7B7333528F5@SVRDSI078MBX01V>

Dear Jefferson,

> I'm using adehabitatLT for the first time analyzing jaguar movements in
> amazon. I'm running runsNAltraj to detect any autocorrelation in the
> location of missing relocations. But I'm a beginner in this task and I'm
> not knowing to how to interpret the graph generated by this function.

This function tests whether the missing values are randomly distributed
in the trajectories using a runs test. See
http://en.wikipedia.org/wiki/Wald%E2%80%93Wolfowitz_runs_test for an
explanation. Using the same notations as on this wikipedia page, this
test calculates the criterion:

C=(N-mu)/sigma

Where N is the number of runs in the sequence, mu and sigma are
respectivel the expected mean number of runs and the expected standard
deviation of this number of runs  under the hypothesis of a random
distribution of the missing values. The criterion C takes a high
positive value if the missing values are more regular than expected
under H0, and a highly negative value if the missing values are clustered.

The histogram corresponds to the statistical distribution of C expected
under the null hypothesis of a random distribution of the missing
values. The "arrow" indicates the actual value of the criterion. This
graph allows to see if the actual value is far from the distribution
expected under the null hypothesis. A p-value is derived from this
graph, and is returned by the function,
Hope this helps,

Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14



From tiagoandremarques at gmail.com  Mon Feb 17 14:09:58 2014
From: tiagoandremarques at gmail.com (Tiago Marques)
Date: Mon, 17 Feb 2014 13:09:58 +0000
Subject: [R-sig-Geo] projecting data from decimal degrees to meters
Message-ID: <53020A26.40004@gmail.com>

Dear List,

Sorry if this is a very basic question, I've searched around and could 
not find a simple answer to it. I am familiar with R, but not with 
geo/GIS stuff. I have a matrix zs containing 3 columns, longitude, 
latitude and depth. Depth is available at a regular grid of points 
covering approximately 200 by 200 km in the Bahamas. The first few lines 
of the data are below:

head(zs)
         lat        long    z
1 23.2383 -78.3133 4.01
2 23.2383 -78.3100 4.00
3 23.2383 -78.3066 4.00
4 23.2383 -78.3033 4.00
5 23.2383 -78.3000 4.00

I would like to implement some animal movement simulations, and my 
movement model is parametrized in terms of displacement, in meters. How 
can I project zs to a matrix containing say x,y,z in which the x,y are 
in meters.

Best, and many thanks in advance for any advice coming this way.

Tiago


From Thierry.ONKELINX at inbo.be  Mon Feb 17 14:23:27 2014
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Mon, 17 Feb 2014 13:23:27 +0000
Subject: [R-sig-Geo] projecting data from decimal degrees to meters
In-Reply-To: <53020A26.40004@gmail.com>
References: <53020A26.40004@gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA7427F073DB2B@inbomail.inbo.be>

Dear Tiago,

You can use spTransform from the sp package. Note that you need to know what the current and new projection and datum of your data is.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] Namens Tiago Marques
Verzonden: maandag 17 februari 2014 14:10
Aan: r-sig-geo at r-project.org
Onderwerp: [R-sig-Geo] projecting data from decimal degrees to meters

Dear List,

Sorry if this is a very basic question, I've searched around and could not find a simple answer to it. I am familiar with R, but not with geo/GIS stuff. I have a matrix zs containing 3 columns, longitude, latitude and depth. Depth is available at a regular grid of points covering approximately 200 by 200 km in the Bahamas. The first few lines of the data are below:

head(zs)
         lat        long    z
1 23.2383 -78.3133 4.01
2 23.2383 -78.3100 4.00
3 23.2383 -78.3066 4.00
4 23.2383 -78.3033 4.00
5 23.2383 -78.3000 4.00

I would like to implement some animal movement simulations, and my movement model is parametrized in terms of displacement, in meters. How can I project zs to a matrix containing say x,y,z in which the x,y are in meters.

Best, and many thanks in advance for any advice coming this way.

Tiago

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From babuawara at gmail.com  Mon Feb 17 14:32:05 2014
From: babuawara at gmail.com (vikram ranga)
Date: Mon, 17 Feb 2014 19:02:05 +0530
Subject: [R-sig-Geo] projecting data from decimal degrees to meters
In-Reply-To: <AA818EAD2576BC488B4F623941DA7427F073DB2B@inbomail.inbo.be>
References: <53020A26.40004@gmail.com>
	<AA818EAD2576BC488B4F623941DA7427F073DB2B@inbomail.inbo.be>
Message-ID: <CAL-ALVHjQEHL0H6iZ1dOcVfNxo0k7S9qCGnd31x3fLNRkwW8dw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/1d8b5215/attachment.pl>

From ldecola at comcast.net  Mon Feb 17 17:42:18 2014
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Mon, 17 Feb 2014 16:42:18 +0000 (UTC)
Subject: [R-sig-Geo] projecting data from decimal degrees to meters
In-Reply-To: <53020A26.40004@gmail.com>
Message-ID: <10044443.39607.1392655338775.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/ebda9587/attachment.pl>

From eddieatr at gmail.com  Mon Feb 17 20:19:21 2014
From: eddieatr at gmail.com (Eddie Smith)
Date: Mon, 17 Feb 2014 19:19:21 +0000
Subject: [R-sig-Geo] R crashed when running calc
Message-ID: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/8c657a6c/attachment.pl>

From eddieatr at gmail.com  Mon Feb 17 22:11:40 2014
From: eddieatr at gmail.com (Eddie Smith)
Date: Mon, 17 Feb 2014 21:11:40 +0000
Subject: [R-sig-Geo] R crashed when running calc
In-Reply-To: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
References: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
Message-ID: <CABaJH7_4Jm22y1cOUPQyekxQfcHww1t2H1GqRYpATfNaxX=1QQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/c1665dae/attachment.pl>

From r.hijmans at gmail.com  Tue Feb 18 03:59:48 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 17 Feb 2014 18:59:48 -0800
Subject: [R-sig-Geo] R crashed when running calc
In-Reply-To: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
References: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
Message-ID: <CANtt_hwHLOtjC4XVTFKa59GEYmZO24Bi8oBHADbmkFz=2LonxA@mail.gmail.com>

Eddie,
The function does not work (maxsst is not defined). You are not
providing sessionInfo()
You should be able to avoid memory problems (if that is what causes
this) via rasterOptions(chunksize=___)

E.g.,

rasterOptions(chunksize=1e+05)

Robert


On Mon, Feb 17, 2014 at 11:19 AM, Eddie Smith <eddieatr at gmail.com> wrote:
> Hi guys,
>
> Everytime I tried to run calc(), R crashed. Any advice?
> Here is my code:
>
> #clear memory/remove all R objects
> rm(list=ls())
>
> #check memory size and set memory limit
> memory.size()
> memory.limit(10000)
>
> #Load related packages library
> library(raster)
> library(rgdal)
>
> #Load all raster data in a folder
> img <- list.files(pattern='\\.img$')
>
> #Check rasters
> list(img)
>
> #Stack layers into one file
> flag7 <- stack(img)
>
> #2 CReate fun
> time <- 1:nlayers(flag7)
> fun <- function(x) {
> if (all(is.na(x))) {
> return(cbind(NA,NA,NA))
> }
> xcost<-cos(2*pi*time/366)
> xsine<-sin(2*pi*time/366)
> m = lm(x~xcost+xsine)
> s  <- summary(m)
> maxval <- max(predict(m))
> r2 <- s$r.squared
> sigma <- s$sigma
> cbind(maxsst, r2, sigma)
> }
>
> #3 Run function with rasterstack
> r <- calc(flag7, fun)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Tue Feb 18 04:40:08 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 18 Feb 2014 03:40:08 +0000
Subject: [R-sig-Geo] question about STFDF time component
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B14DF9@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/486ff40d/attachment.pl>

From arilamstein at gmail.com  Tue Feb 18 04:54:32 2014
From: arilamstein at gmail.com (arilamstein at gmail.com)
Date: Mon, 17 Feb 2014 19:54:32 -0800
Subject: [R-sig-Geo] Rendering a map of all zip codes (ZCTAs)
Message-ID: <CAEO2kuKQ3L-bBnMXznJjQm6w_sm9O_qgcOK4zv46ZD=HOkuL1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140217/157fea71/attachment.pl>

From HodgessE at uhd.edu  Tue Feb 18 07:46:13 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 18 Feb 2014 06:46:13 +0000
Subject: [R-sig-Geo] another krigeST question
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B14E76@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/9fd335ac/attachment.pl>

From ben.graeler at uni-muenster.de  Tue Feb 18 08:18:03 2014
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Tue, 18 Feb 2014 08:18:03 +0100
Subject: [R-sig-Geo] another krigeST question
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217B14E76@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217B14E76@challenger.uhd.campus>
Message-ID: <29503d74-cb69-4a9c-9f32-4c277c4e6ae4@email.android.com>

Dear Erin,

as this warning indicates, krigeST could not automatically check whether the temporal distances used in the variogram model and your data set coinside (eg. being both reported in days). KrigeST would in case of a mismatch correct for it.

In the later package versions, variogramST stores the temporal unit as an attribute. The attribute is then used by the fitting routine an passed to the variogram model, allowing krigeST to compare it with temporal distances used in the prediction. In the case when no attribute is found, the below warning is issued and the model is evaluted as is. 

HTH, 

 Ben

On February 18, 2014 7:46:13 AM CET, "Hodgess, Erin" <HodgessE at uhd.edu> wrote:
>Hi again:
>
>Now I'm getting the following:
>
>
>Warning message:
>In krigeST(index.index ~ 1, w, newdata = pred.grd, modelList = stv) :
>The spatio-temporal variogram model does not carry a time unit
>attribute: krisgeST cannot check whether the temporal distance metrics
>coincide.
>>
>
>
>Here is the code to generate the model:
>    stv <- vgmST("sumMetric",
>    space=vgm(spsil1,smod1,sran1),
>    time=vgm(epsil1,emod1,eran1),
>    joint=vgm(60,"Exp",100),
>    stAni=20)
>
>Any help much appreciated.
>
>Thanks,
>Erin
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Benedikt Gr?ler

Institute for Geoinformatics
University of M?nster

http://www.ifgi.de/graeler

+49 251 83 33082


From Jose.M.Pavia at uv.es  Tue Feb 18 09:50:25 2014
From: Jose.M.Pavia at uv.es (Jose M. Pavia)
Date: Tue, 18 Feb 2014 09:50:25 +0100 (CET)
Subject: [R-sig-Geo] create cartogram shape files in R
Message-ID: <2391758612pavia@uv.es>

Dear list,

I have a shape file (~6000 polygons). The areas of the polygons in 
the shape file are really different, despite having be all of them 
designed to have similar population sizes. To perform posterior 
analyses using wavelets, I am interested in transforming these shape 
file in a cartogram shape file with (almost) equal density population 
in all of the resulting polygons. I wonder if somebody knows how we 
can solve this in R? Can anybody help?

best regards
jm

--
Jose M. Pavia
Quantitative Methods' Professor
Universitat de Valencia
Av Tarongers, s/n
46022 Valencia, Spain
Phone: +34 963 828 404
Fax: +34 963 828 415
e-mail: pavia at uv.es


From Roger.Bivand at nhh.no  Tue Feb 18 10:41:51 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 18 Feb 2014 10:41:51 +0100
Subject: [R-sig-Geo] create cartogram shape files in R
In-Reply-To: <2391758612pavia@uv.es>
References: <2391758612pavia@uv.es>
Message-ID: <alpine.LRH.2.03.1402181039240.10837@reclus.nhh.no>

On Tue, 18 Feb 2014, Jose M. Pavia wrote:

> Dear list,
>
> I have a shape file (~6000 polygons). The areas of the polygons in
> the shape file are really different, despite having be all of them
> designed to have similar population sizes. To perform posterior
> analyses using wavelets, I am interested in transforming these shape
> file in a cartogram shape file with (almost) equal density population
> in all of the resulting polygons. I wonder if somebody knows how we
> can solve this in R? Can anybody help?

Please see comments in:

http://spatial.ly/2013/06/r_activity/

James Cheshire's blog is certainly worth following!

Roger

>
> best regards
> jm
>
> --
> Jose M. Pavia
> Quantitative Methods' Professor
> Universitat de Valencia
> Av Tarongers, s/n
> 46022 Valencia, Spain
> Phone: +34 963 828 404
> Fax: +34 963 828 415
> e-mail: pavia at uv.es
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Feb 18 11:06:07 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 18 Feb 2014 11:06:07 +0100
Subject: [R-sig-Geo] Rendering a map of all zip codes (ZCTAs)
In-Reply-To: <CAEO2kuKQ3L-bBnMXznJjQm6w_sm9O_qgcOK4zv46ZD=HOkuL1A@mail.gmail.com>
References: <CAEO2kuKQ3L-bBnMXznJjQm6w_sm9O_qgcOK4zv46ZD=HOkuL1A@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1402181042070.10837@reclus.nhh.no>

On Tue, 18 Feb 2014, arilamstein at gmail.com wrote:

> I recenty posted<https://groups.google.com/forum/#!topic/ggplot2/5ZTGjl_Guvo)>this
> question on the ggplot2 mailing list and did not hear back, so I
> thought that reposting to sig-geo might be better.
>
> I have recently released an R package called
> choroplethr<http://tech.truliablog.com/2014/01/15/the-choroplethr-package-for-r/>that
> attempts to facilitate the creation of choropleth maps in R at the
> state, county and ZIP code level of detail.  It uses the state and county
> maps that come with the ggplot2 package (or is the it the maps package?).
> For zip maps it just renders a scatterplot against the state boundaries.

Your "blog" points to github - the package is on CRAN, point to that; 
install.github() tries to install from source, and most users need binary 
installs; it is also not >= GPL-2. Note that the boundary data in the maps 
package do not have clear pedigrees, and the zipcode package only ships 
points (so why would you be surprised if only points are displayed?) - 
they are also without clear authority.

>
> I would like to render zip code choropleths using the ZIP Code Tabulated
> Area (ZCTA) shapefile that the census distributes
> here<http://www.census.gov/cgi-bin/geo/shapefiles2013/main>.
> Hadley has a nice tutorial on how to work with shapefiles in ggplot2
> here<https://github.com/hadley/ggplot2/wiki/plotting-polygon-shapefiles>.
> However, those directions do not work for me, and I think that it might be
> due to the size of the shapefile (501 MB zipped).  As I mentioned on the
> ggplot2 mailing list, the call to "fortify" will run all night and still
> not finish.

You can choose to use ggplot2 and fortify, but you go from fish to fish 
soup without the possibility of getting the fish back (in reasonable 
time, fish paste best option). However, converting all the coordinates to 
data.frame format is time-consuming, and creates very many copies of 
attrribute data.

>
> Can anyone give me pointers on how to work with this file effectively in R?
> Ideally I would be able to distribute this map as part of my package as
> well, but clearly the current size of the shapefile makes that prohibitive.
>

Firstly, do study thematic cartography. You'll find that many of the 30K 
geometries are invisible on most available screen resolutions, so that 
visualising more than a small subset isn't very sensible anyway (single 
pixels belonging to different class intervals from their neighbours are 
very hard to pick out, even with transparent borders). So choosing the 
subset of your imported SpatialPolygonsDataFrame object you need and only 
fortifying that subset will make things more tractable.

You should drop the idea of shipping the US Census shapefile of ZCTA, CRAN 
and its mirrors do not need to duplicate files that are available online 
elsewhere; if the boundaries were on a WFS (Web Feature Server), it might 
be possible to download just the subset needed.

Roger

> Thanks.
>
> Ari
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From eddieatr at gmail.com  Tue Feb 18 14:08:12 2014
From: eddieatr at gmail.com (Eddie Smith)
Date: Tue, 18 Feb 2014 13:08:12 +0000
Subject: [R-sig-Geo] R crashed when running calc
In-Reply-To: <CANtt_hwHLOtjC4XVTFKa59GEYmZO24Bi8oBHADbmkFz=2LonxA@mail.gmail.com>
References: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
	<CANtt_hwHLOtjC4XVTFKa59GEYmZO24Bi8oBHADbmkFz=2LonxA@mail.gmail.com>
Message-ID: <CABaJH7-iRCDXkL6z+09-63Ooe8oM8afb5dCdf9aBp_P_5iGCUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/5df92ad6/attachment.pl>

From gustavodalposso at hotmail.com  Tue Feb 18 14:28:40 2014
From: gustavodalposso at hotmail.com (Gustavo Dalposso)
Date: Tue, 18 Feb 2014 13:28:40 +0000
Subject: [R-sig-Geo] problems creating shapefile
Message-ID: <SNT151-W56F5A55B65A97651E9BD86BB980@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/84fd6b1e/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb 18 14:37:49 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 18 Feb 2014 14:37:49 +0100
Subject: [R-sig-Geo] problems creating shapefile
In-Reply-To: <SNT151-W56F5A55B65A97651E9BD86BB980@phx.gbl>
References: <SNT151-W56F5A55B65A97651E9BD86BB980@phx.gbl>
Message-ID: <alpine.LRH.2.03.1402181433080.10837@reclus.nhh.no>

On Tue, 18 Feb 2014, Gustavo Dalposso wrote:

> 1. I created a raster in R
> require(raster)raster<-rasterFromXYZ(dados)
> 2. I converted the raster into polygons
> pol <- rasterToPolygons(raster)
> 3. I want to export to shapefile.
> shapefile('polygon.shp',pol)
> Error: file.exists(extension(x, ".shp")) is not TRUE
> Can anyone tell me what happens. Some time I used this command and it created the shapefile


library(raster)
?shapefile

If you get confused by the reversed arguments in the method, do use 
rgdal::readOGR() and rgdal::writeOGR() directly, rather than from the 
raster::shapefile() method wrapper. Probably:

shapefile(x=pol, filename='polygon.shp') # Spatial method

not

shapefile(x='polygon.shp', stringsAsFactors=pol) # character method

Roger

> 	[[alternative HTML version deleted]]

Please do not post in HTML, only plain text.

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jgrn at illinois.edu  Tue Feb 18 15:55:31 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 18 Feb 2014 08:55:31 -0600
Subject: [R-sig-Geo] R crashed when running calc
In-Reply-To: <CABaJH7-iRCDXkL6z+09-63Ooe8oM8afb5dCdf9aBp_P_5iGCUw@mail.gmail.com>
References: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
	<CANtt_hwHLOtjC4XVTFKa59GEYmZO24Bi8oBHADbmkFz=2LonxA@mail.gmail.com>
	<CABaJH7-iRCDXkL6z+09-63Ooe8oM8afb5dCdf9aBp_P_5iGCUw@mail.gmail.com>
Message-ID: <CABG0rft7YRN0pjQGR9o-LAnCSp1_0FqH0h4vmfvP5eLCo+JihQ@mail.gmail.com>

Eddie:

This is the Windows x64 version of R 3.0.2, right?  I found that the
x64 release for whatever reason R needs to be launched with the
--max-mem-size=XXXM flag if you want more than 2gb available to R.

XXX is the number of megabytes to give it access to.  This seemed to
have been a change from 3.0.1 (which seemed to set the memory to be
the max available on the system).  Give this a shot when you launch
it.  Check http://stackoverflow.com/questions/1395229/increasing-the-memory-available-to-r-processes
for some hints on this (you can append the setting to your GUI
shortcut).

You should also follow Robert's suggestion and set the chunkSize to be
VERY small if the max-mem-size doesn't work.

--j



On Tue, Feb 18, 2014 at 7:08 AM, Eddie Smith <eddieatr at gmail.com> wrote:
> Thank you very much Robert.
>
> Tried to increase to set the chunksize as suggested(
> rasterOptions(chunksize=1e+05))  but still no luck.
>
> The full session is:
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> locale:
> [1] LC_COLLATE=English_United Kingdom.1252
> [2] LC_CTYPE=English_United Kingdom.1252
> [3] LC_MONETARY=English_United Kingdom.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United Kingdom.1252
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> other attached packages:
> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
> loaded via a namespace (and not attached):
> [1] grid_3.0.2      lattice_0.20-24
> My rasterstack is huge but I haven't got any problem with this rasterstack
> before.
>
>> flag7
> class       : RasterStack
> dimensions  : 1032, 1656, 1708992, 10592  (nrow, ncol, ncell, nlayers)
>
> Thanks.
>
>
>
> On Tue, Feb 18, 2014 at 2:59 AM, Robert J. Hijmans <r.hijmans at gmail.com>wrote:
>
>> Eddie,
>> The function does not work (maxsst is not defined). You are not
>> providing sessionInfo()
>> You should be able to avoid memory problems (if that is what causes
>> this) via rasterOptions(chunksize=___)
>>
>> E.g.,
>>
>> rasterOptions(chunksize=1e+05)
>>
>> Robert
>>
>>
>> On Mon, Feb 17, 2014 at 11:19 AM, Eddie Smith <eddieatr at gmail.com> wrote:
>> > Hi guys,
>> >
>> > Everytime I tried to run calc(), R crashed. Any advice?
>> > Here is my code:
>> >
>> > #clear memory/remove all R objects
>> > rm(list=ls())
>> >
>> > #check memory size and set memory limit
>> > memory.size()
>> > memory.limit(10000)
>> >
>> > #Load related packages library
>> > library(raster)
>> > library(rgdal)
>> >
>> > #Load all raster data in a folder
>> > img <- list.files(pattern='\\.img$')
>> >
>> > #Check rasters
>> > list(img)
>> >
>> > #Stack layers into one file
>> > flag7 <- stack(img)
>> >
>> > #2 CReate fun
>> > time <- 1:nlayers(flag7)
>> > fun <- function(x) {
>> > if (all(is.na(x))) {
>> > return(cbind(NA,NA,NA))
>> > }
>> > xcost<-cos(2*pi*time/366)
>> > xsine<-sin(2*pi*time/366)
>> > m = lm(x~xcost+xsine)
>> > s  <- summary(m)
>> > maxval <- max(predict(m))
>> > r2 <- s$r.squared
>> > sigma <- s$sigma
>> > cbind(maxsst, r2, sigma)
>> > }
>> >
>> > #3 Run function with rasterstack
>> > r <- calc(flag7, fun)
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From eddieatr at gmail.com  Tue Feb 18 15:59:36 2014
From: eddieatr at gmail.com (Eddie Smith)
Date: Tue, 18 Feb 2014 14:59:36 +0000
Subject: [R-sig-Geo] R crashed when running calc
In-Reply-To: <CABG0rft7YRN0pjQGR9o-LAnCSp1_0FqH0h4vmfvP5eLCo+JihQ@mail.gmail.com>
References: <CABaJH7_roA9zdDKXXLoQotU7gzT3SYk_z9GpEB4RGrhd=s7zFA@mail.gmail.com>
	<CANtt_hwHLOtjC4XVTFKa59GEYmZO24Bi8oBHADbmkFz=2LonxA@mail.gmail.com>
	<CABaJH7-iRCDXkL6z+09-63Ooe8oM8afb5dCdf9aBp_P_5iGCUw@mail.gmail.com>
	<CABG0rft7YRN0pjQGR9o-LAnCSp1_0FqH0h4vmfvP5eLCo+JihQ@mail.gmail.com>
Message-ID: <CABaJH79ZJGHqCWtDS+DEvnFZK_qobg1U0=+QcZQUfaHFzUt7Lg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/44fe50c8/attachment.pl>

From bakare at ualberta.ca  Tue Feb 18 18:11:33 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 18 Feb 2014 10:11:33 -0700
Subject: [R-sig-Geo] Variogram modeling
Message-ID: <CAJRR3XMXU39AiGpAh61zE4=f_ujd3p0rLryUPaqLk5g4RrSuVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/31f910d7/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Feb 18 18:19:03 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 18 Feb 2014 18:19:03 +0100
Subject: [R-sig-Geo] Variogram modeling
In-Reply-To: <CAJRR3XMXU39AiGpAh61zE4=f_ujd3p0rLryUPaqLk5g4RrSuVw@mail.gmail.com>
References: <CAJRR3XMXU39AiGpAh61zE4=f_ujd3p0rLryUPaqLk5g4RrSuVw@mail.gmail.com>
Message-ID: <53039607.20405@uni-muenster.de>



On 02/18/2014 06:11 PM, Moshood Agba Bakare wrote:
> Dear All,
> In my yield data, I have longitude and latitude as spherical coordinates
> which are converted into projected coordinates - easting and northing for
> variogram modelling, yield as attribute variable, and elevation.
> I fitted my empirical variogram as
> empvar<-variogram(yield~1,canmod.sp,cutoff=600,width=3, cressie=TRUE).
> In some documents I come across, some fitted the model using easting and
> northing as covariate to yield as
> yield ~easting+northing rather than yield ~1.
> which one do you advise me to use yield ~easting+northing or yield ~1.

If there is a strong spatial trend, general advice is to work on the
residuals (~easting+northing), and use the same equation in the kriging
step (universal or regression kriging).

You could try both, if the difference is small, I'd suggest to not
detrend (ie., use ~1)

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/0663deb7/attachment.bin>

From au232 at medschl.cam.ac.uk  Tue Feb 18 18:38:14 2014
From: au232 at medschl.cam.ac.uk (Alvaro Ullrich)
Date: Tue, 18 Feb 2014 17:38:14 +0000
Subject: [R-sig-Geo] Clustering long-lat points
Message-ID: <4F295760B4047D40A4B655C13B8B57B7461E3A1F@me-mbx1.medschl.cam.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/cb930886/attachment.pl>

From bakare at ualberta.ca  Tue Feb 18 18:43:28 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 18 Feb 2014 10:43:28 -0700
Subject: [R-sig-Geo] Variogram modeling
In-Reply-To: <53039607.20405@uni-muenster.de>
References: <CAJRR3XMXU39AiGpAh61zE4=f_ujd3p0rLryUPaqLk5g4RrSuVw@mail.gmail.com>
	<53039607.20405@uni-muenster.de>
Message-ID: <CAJRR3XOTPLOJf6DSby_R_f_scWcwJT5PaWiM=F5VPfdoengexw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/1a3e194b/attachment.pl>

From horning at amnh.org  Tue Feb 18 18:47:54 2014
From: horning at amnh.org (Ned Horning)
Date: Tue, 18 Feb 2014 12:47:54 -0500
Subject: [R-sig-Geo] Error with disaggregate
Message-ID: <53039CCA.2070007@amnh.org>

Hi -

I am trying calculate the sum of blocks of Landsat pixels (30m 
resolution) that fit within MODIS pixels 960m resolution) and store that 
values at the Landsat cell size. To accomplish that I am running 
aggregate with the "sum" function on a Landsat band and then I run 
disaggregate on the result to get the resolution back to the Landsat 
pixel size. When I do this the disaggregate function gives me the 
following error:
--
Error in writeBin(v, x at file@con, size = x at file@dsize) :   only 2^31-1 
bytes can be written in a single writeBin() call
--

I can recreate the error with this script:
--
a <- raster(nrows=7776, ncols=7616, xmn=718335, xmx=946815, ymn=-757485, 
ymx=-524205, crs="+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs 
+ellps=WGS84 +towgs84=0,0,0")
a[] <- 1
b <- aggregate(a, fact=32, fun=sum)
c <- disaggregate(b, fact=32)
--

I am running R 3.0.2 on Ubuntu 12.04 with version 2.2-12 of the raster 
package.

Please let me know if you see any problems with my code.

Thanks.

Ned


From edzer.pebesma at uni-muenster.de  Tue Feb 18 19:06:31 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 18 Feb 2014 19:06:31 +0100
Subject: [R-sig-Geo] Variogram modeling
In-Reply-To: <CAJRR3XOTPLOJf6DSby_R_f_scWcwJT5PaWiM=F5VPfdoengexw@mail.gmail.com>
References: <CAJRR3XMXU39AiGpAh61zE4=f_ujd3p0rLryUPaqLk5g4RrSuVw@mail.gmail.com>	<53039607.20405@uni-muenster.de>
	<CAJRR3XOTPLOJf6DSby_R_f_scWcwJT5PaWiM=F5VPfdoengexw@mail.gmail.com>
Message-ID: <5303A127.2050300@uni-muenster.de>

I would say that strong spatial trends can be seen, by eye, when you
plot your data in a map.

On 02/18/2014 06:43 PM, Moshood Agba Bakare wrote:
> Thanks for the response. I used to determine the presence of strong spatial
> trend by visualizing the semivariogram plot of empirical data. If the plot
> increases without level off, then I assume there is a strong spatial trend.
> Am I right with this approach? Is there a better way of detecting if there
> is a *strong spatial trend*?
> 
> Thank you.
> 
> 
> On Tue, Feb 18, 2014 at 10:19 AM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>>
>>
>> On 02/18/2014 06:11 PM, Moshood Agba Bakare wrote:
>>> Dear All,
>>> In my yield data, I have longitude and latitude as spherical coordinates
>>> which are converted into projected coordinates - easting and northing for
>>> variogram modelling, yield as attribute variable, and elevation.
>>> I fitted my empirical variogram as
>>> empvar<-variogram(yield~1,canmod.sp,cutoff=600,width=3, cressie=TRUE).
>>> In some documents I come across, some fitted the model using easting and
>>> northing as covariate to yield as
>>> yield ~easting+northing rather than yield ~1.
>>> which one do you advise me to use yield ~easting+northing or yield ~1.
>>
>> If there is a strong spatial trend, general advice is to work on the
>> residuals (~easting+northing), and use the same equation in the kriging
>> step (universal or regression kriging).
>>
>> You could try both, if the difference is small, I'd suggest to not
>> detrend (ie., use ~1)
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
>> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/d02e8993/attachment.bin>

From r.hijmans at gmail.com  Tue Feb 18 19:12:00 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 18 Feb 2014 10:12:00 -0800
Subject: [R-sig-Geo] Error with disaggregate
In-Reply-To: <53039CCA.2070007@amnh.org>
References: <53039CCA.2070007@amnh.org>
Message-ID: <CANtt_hxKx9kEirj1v0-7norUZPY7uBaTwcbc+7EfY-CfpN18oQ@mail.gmail.com>

Ned,

I see nothing wrong with your code. Works for me on Win7.  Perhaps
because of a fix in the chunk size (blockSize) computation in the
development version.
Can you check if it works with that version?

 install.packages("raster", repos="http://R-Forge.R-project.org")


I do not understand the error message though, as you should be writing
fewer bytes then 2^31
> 2^31 / (8*ncell(c))
[1] 4.532697

This may go away if you add a filename, and perhaps a datatype (FLT4S)  argument

c <- disaggregate(b, fact=32, filename='dis.tif', datatype='FLT4S')

Or if you set
rasterOptions(chunksize= ) temporarily to something lower.

I note that I should add a "block_fun" method to do this in one step

Robert

On Tue, Feb 18, 2014 at 9:47 AM, Ned Horning <horning at amnh.org> wrote:
> Hi -
>
> I am trying calculate the sum of blocks of Landsat pixels (30m resolution)
> that fit within MODIS pixels 960m resolution) and store that values at the
> Landsat cell size. To accomplish that I am running aggregate with the "sum"
> function on a Landsat band and then I run disaggregate on the result to get
> the resolution back to the Landsat pixel size. When I do this the
> disaggregate function gives me the following error:
> --
> Error in writeBin(v, x at file@con, size = x at file@dsize) :   only 2^31-1 bytes
> can be written in a single writeBin() call
> --
>
> I can recreate the error with this script:
> --
> a <- raster(nrows=7776, ncols=7616, xmn=718335, xmx=946815, ymn=-757485,
> ymx=-524205, crs="+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs
> +ellps=WGS84 +towgs84=0,0,0")
> a[] <- 1
> b <- aggregate(a, fact=32, fun=sum)
> c <- disaggregate(b, fact=32)
> --
>
> I am running R 3.0.2 on Ubuntu 12.04 with version 2.2-12 of the raster
> package.
>
> Please let me know if you see any problems with my code.
>
> Thanks.
>
> Ned
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From horning at amnh.org  Tue Feb 18 19:42:27 2014
From: horning at amnh.org (Ned Horning)
Date: Tue, 18 Feb 2014 13:42:27 -0500
Subject: [R-sig-Geo] Error with disaggregate
In-Reply-To: <CANtt_hxKx9kEirj1v0-7norUZPY7uBaTwcbc+7EfY-CfpN18oQ@mail.gmail.com>
References: <53039CCA.2070007@amnh.org>
	<CANtt_hxKx9kEirj1v0-7norUZPY7uBaTwcbc+7EfY-CfpN18oQ@mail.gmail.com>
Message-ID: <5303A993.6060309@amnh.org>

Robert,

I downloaded the development version and now it's working fine - thanks.

Ned

On 02/18/2014 01:12 PM, Robert J. Hijmans wrote:
> Ned,
>
> I see nothing wrong with your code. Works for me on Win7.  Perhaps
> because of a fix in the chunk size (blockSize) computation in the
> development version.
> Can you check if it works with that version?
>
>   install.packages("raster", repos="http://R-Forge.R-project.org")
>
>
> I do not understand the error message though, as you should be writing
> fewer bytes then 2^31
>> 2^31 / (8*ncell(c))
> [1] 4.532697
>
> This may go away if you add a filename, and perhaps a datatype (FLT4S)  argument
>
> c <- disaggregate(b, fact=32, filename='dis.tif', datatype='FLT4S')
>
> Or if you set
> rasterOptions(chunksize= ) temporarily to something lower.
>
> I note that I should add a "block_fun" method to do this in one step
>
> Robert
>
> On Tue, Feb 18, 2014 at 9:47 AM, Ned Horning <horning at amnh.org> wrote:
>> Hi -
>>
>> I am trying calculate the sum of blocks of Landsat pixels (30m resolution)
>> that fit within MODIS pixels 960m resolution) and store that values at the
>> Landsat cell size. To accomplish that I am running aggregate with the "sum"
>> function on a Landsat band and then I run disaggregate on the result to get
>> the resolution back to the Landsat pixel size. When I do this the
>> disaggregate function gives me the following error:
>> --
>> Error in writeBin(v, x at file@con, size = x at file@dsize) :   only 2^31-1 bytes
>> can be written in a single writeBin() call
>> --
>>
>> I can recreate the error with this script:
>> --
>> a <- raster(nrows=7776, ncols=7616, xmn=718335, xmx=946815, ymn=-757485,
>> ymx=-524205, crs="+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs
>> +ellps=WGS84 +towgs84=0,0,0")
>> a[] <- 1
>> b <- aggregate(a, fact=32, fun=sum)
>> c <- disaggregate(b, fact=32)
>> --
>>
>> I am running R 3.0.2 on Ubuntu 12.04 with version 2.2-12 of the raster
>> package.
>>
>> Please let me know if you see any problems with my code.
>>
>> Thanks.
>>
>> Ned
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From andreasft at gmail.com  Tue Feb 18 20:05:23 2014
From: andreasft at gmail.com (=?ISO-8859-1?Q?Andreas_For=F8_Tollefsen?=)
Date: Tue, 18 Feb 2014 20:05:23 +0100
Subject: [R-sig-Geo] Aggregate Polygon in Polygon
Message-ID: <CAGMz7Dn9O9D=hXVuHFJa-3=r8pxXVLH8_k6v5B5Skc-5PqCNfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140218/f727e140/attachment.pl>

From r.hijmans at gmail.com  Tue Feb 18 21:07:41 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 18 Feb 2014 12:07:41 -0800
Subject: [R-sig-Geo] Aggregate Polygon in Polygon
In-Reply-To: <CAGMz7Dn9O9D=hXVuHFJa-3=r8pxXVLH8_k6v5B5Skc-5PqCNfA@mail.gmail.com>
References: <CAGMz7Dn9O9D=hXVuHFJa-3=r8pxXVLH8_k6v5B5Skc-5PqCNfA@mail.gmail.com>
Message-ID: <CANtt_hzjc6T7dtUHB+ZO=gYGC3ez4hXYb3-_evxeup+LQe6uwQ@mail.gmail.com>

Andreas,

>From what I can see I think this can be accomplished with (raster,
calling rgeos) functions intersect and aggregate.
It would be much easier to help you if your script were self contained
(that is use some of the example data, or generate some data).
It is bad style to send scripts that refer to data that we do not have.

Robert

On Tue, Feb 18, 2014 at 11:05 AM, Andreas For? Tollefsen
<andreasft at gmail.com> wrote:
> Hi,
>
> I have one spdf (polygons) that represent the unit of analysis (gadmpoly).
> In addition I have one spdf of polygons with containing attribute levels of
> various variables (r3mergepolys).
>
> What I want to accomplish is to aggregate the mean of one or more variables
> from the 3mergepolys spdf, intersecting with each of the unit of analysis
> polygons (gadmpolys).
>
> I believe the over and/or aggregate function are my friends, but I cannot
> seem to figure out how to write the code.
>
> I managed to find a solution using the raster package. This script uses a
> for loop, to loop through the names of the variables in r3mergepolys I want
> to aggregate from.
>
> Then I use extract to get the mean raster pixel value within the gadmpoly
> spdf. What I would like to know if this could be done using polygons
> operations in sp and/or geos without the raster conversion?
>
> Thanks,
>
> Andreas
>
> CODE:
> # Select the variables from Afrobarometer to include:
> afrovars <- as.character(names(r3mergepoly)[16:21])
>
> # Select from gadmpoly only for countries in Afrobarometer
> gadmpoly_afro <- gadmpoly_simple[gadmpoly_simple$GWNO %in% r3polys$GWNO,]
>
> # Select extent for rasters
> rasterextent <- extent(r3mergepoly)
>
> # Create empty raster
> testrast <- raster(nrows=500, ncols=500, ext=rasterextent)
>
> # Create an empty list
> rasterlist <- list()
>
> # For each variable, create raster, summarize the mean raster values within
> the polygon, and add to rasterlist
> for (name in afrovars){
>   print(name)
>   rasterized <- rasterize(r3mergepoly, testrast, name)
>   rasterlist[[name]] <- extract(rasterized,
> y=gadmpoly_afro,method="simple",fun=mean,
>   na.rm=TRUE, df=TRUE)
>   colnames(rasterlist[[name]]) <- name
> }
>
> # Create data frame with all the raster summary
>
> catdf <- data.frame(id=seq(1,length(gadmpoly_afro),1))
>
> counter <- 1 # The id column
>
> for (name in afrovars){
>
>   catdf <- cbind(catdf, rasterlist[[name]][2])
>
>   counter <- counter + 1
>
>   colnames(catdf)[counter] <- name
>
> }
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rahmannorthampton at gmail.com  Wed Feb 19 10:06:22 2014
From: rahmannorthampton at gmail.com (Lutfor)
Date: Wed, 19 Feb 2014 01:06:22 -0800 (PST)
Subject: [R-sig-Geo] spatial distribution of two species and nest design
Message-ID: <1392800781964-7585799.post@n2.nabble.com>

Dear Forum members, I was trying to find a thread to solve problem using
"spatstat" but it will not be possible without getting help from help. My
research question? Is species "A" occupancy is dependent on nest design only
or interaction of other species "B". I got a data set where about 200 nest
of 4 different designs were erected in a random pattern of a square block
about 3 km apart from each other. I would like to test whether species "A"
prefer a particular design and how it related to distribution of other
species "B". Will highly appreciated any suggestions. Best regards Lutfor 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-distribution-of-two-species-and-nest-design-tp7585799.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ben.graeler at uni-muenster.de  Wed Feb 19 10:35:40 2014
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Wed, 19 Feb 2014 10:35:40 +0100
Subject: [R-sig-Geo] Spatial Copula Workshop, 22-23 Sep. 2014
Message-ID: <53047AEC.5000008@uni-muenster.de>

Dear list,

I would like to announce the "Spatial Copula Workshop" to be held at the
Institute for Geoinformatics, Muenster, Germany, on 22nd and 23rd
September 2014:

http://ifgi.de/spatialcopulaworkshop/

Copula based models have been developed for various spatial applications
in recent years. In hydrology, copulas are for instance used to model
dependencies among storm variables or to interpolate precipitation
across space. Copulas can be found as well in weather prediction,
interpolation of radioactive radiation, air quality assessments, disease
mapping, or risk evaluation of infectious disease. Some of these models
are based on classical multivariate elliptical copulas with the Matern
class of spatial dependencies,  while other allow for the more flexible
class of vine copulas.

This workshop aims at gathering researchers across different domains
developing and using spatial copulas. During these two days recent
theoretical developments of spatial copulas and their applications will
be presented and discussed. This exchange of ideas will contribute to
the future development of spatial copulas for many application scenarios
and provides opportunities for collaboration in this exciting and
fast-growing research topic.

The abstract submission (~ 500 words) is now open and will close on 18th
May 2014.

Please see the workshop's website for further details:

http://ifgi.de/spatialcopulaworkshop/

I would be thankful if you could forward this call to potentially
interested colleagues.

Best wishes,

 Ben

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 560 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140219/3732687f/attachment.bin>

From marcelino.delacruz at upm.es  Wed Feb 19 11:21:03 2014
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 19 Feb 2014 11:21:03 +0100
Subject: [R-sig-Geo] spatial distribution of two species and nest design
In-Reply-To: <1392800781964-7585799.post@n2.nabble.com>
References: <1392800781964-7585799.post@n2.nabble.com>
Message-ID: <5304858F.2050401@upm.es>

Hi Lutfor,

This seems to me as an instance of what has been called "independent 
labelling" (De la Cruz et al. 2008) or "trivariate random labelling" 
(Biganzoli et al. 2009, Xu et al. 2009).

You can find an old implementation of this approach in function K012 in 
the package ecespa (which depends on spatstat).

Best,

Marcelino



Biganzoli, F., T. Wiegand, and W. B. Batista. 2009. Firemediated
interactions between shrubs in a South American temperate savannah. 
Oikos 118:1383?1395.

De la Cruz, M., R. L. Romao, A. Escudero, and F. T. Maestre.
2008. Where do seedlings go? A spatio-temporal analysis of
seedling mortality in a semi-arid gypsophyte. Ecography 31:
1?11.

Xu, X., T. D. Harwood, M. Pautasso, and M. J. Jeger. 2009.
Spatio-temporal analysis of an invasive plant pathogen
(Phytophthora ramorum) in England and Wales. Ecography
32:504?516.



El 19/02/2014 10:06, Lutfor escribi?:
> Dear Forum members, I was trying to find a thread to solve problem using
> "spatstat" but it will not be possible without getting help from help. My
> research question? Is species "A" occupancy is dependent on nest design only
> or interaction of other species "B". I got a data set where about 200 nest
> of 4 different designs were erected in a random pattern of a square block
> about 3 km apart from each other. I would like to test whether species "A"
> prefer a particular design and how it related to distribution of other
> species "B". Will highly appreciated any suggestions. Best regards Lutfor
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-distribution-of-two-species-and-nest-design-tp7585799.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From rotundo.jose at gmail.com  Wed Feb 19 19:27:18 2014
From: rotundo.jose at gmail.com (rotundo)
Date: Wed, 19 Feb 2014 10:27:18 -0800 (PST)
Subject: [R-sig-Geo] Bivand book chapter 2 Auckland example
Message-ID: <1392834438031-7585802.post@n2.nabble.com>

Hello, 

When attempting to open the file "auckland_mapgen.dat" I got the following
message:

Error in file(file, "r") : cannot open the connection
In addition: Warning message:
In file(file, "r") :
  cannot open file 'auckland_mapgen.dat': No such file or directory

I am using R studio and the auckland_mapgen.dat file is currently loaded in
the workspace. I am really new at using R so I am surely doing something
(very basic) wrong.

If someone can help me, I really appreciate it. 

Best regards,

Jose

 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bivand-book-chapter-2-Auckland-example-tp7585802.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ldecola at comcast.net  Wed Feb 19 20:34:41 2014
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Wed, 19 Feb 2014 19:34:41 +0000 (UTC)
Subject: [R-sig-Geo] spatial distribution of two species and nest design
In-Reply-To: <1392800781964-7585799.post@n2.nabble.com>
Message-ID: <57753270.82146.1392838481078.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140219/f8897884/attachment.pl>

From pauloeducardoso at gmail.com  Thu Feb 20 11:33:02 2014
From: pauloeducardoso at gmail.com (pecardoso)
Date: Thu, 20 Feb 2014 02:33:02 -0800 (PST)
Subject: [R-sig-Geo] Re :  convert Raster object to bigmatrix object
In-Reply-To: <1313049525.21683.YahooMailNeo@web29304.mail.ird.yahoo.com>
References: <1312899357.86634.YahooMailRC@web29309.mail.ird.yahoo.com>
	<CANtt_hy2ZLs82T0qd-+OM_bUR+FKuyPMfn5kZJdJ+fZhfb5J2g@mail.gmail.com>
	<1313049525.21683.YahooMailNeo@web29304.mail.ird.yahoo.com>
Message-ID: <1392892382529-7585804.post@n2.nabble.com>

Simon,
Please let me ask you if the function will return a z object for each
rasterLayer as required for use with bigmemory version of kmeans? May I ask
you how did you proceed with the kmeans?
All the best
Paulo



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/convert-Raster-object-to-bigmatrix-object-tp6668252p7585804.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rotundo.jose at gmail.com  Thu Feb 20 16:18:49 2014
From: rotundo.jose at gmail.com (rotundo)
Date: Thu, 20 Feb 2014 07:18:49 -0800 (PST)
Subject: [R-sig-Geo] Bivand book chapter 2 Auckland example
In-Reply-To: <1392902007656-7585805.post@n2.nabble.com>
References: <1392834438031-7585802.post@n2.nabble.com>
	<1392902007656-7585805.post@n2.nabble.com>
Message-ID: <CADBY2prqFxoOXXWeUyEfaisvQYXP+LGbiATthuSAhPQ4DSDKSA@mail.gmail.com>

Hello Mathias,

Thanks a lot for your response. I tried what you suggested but it didn?t
work.

I don?t think the error is in the file path, since I am using R studio, and
the file auckland_mapgen.dat is already imported to the workspace. So,
after loading the file, I run three different  codes, but still have the
same error message:

library(maps)
library(maptools)

#Example Page 41 as in the book
llCRS <- CRS("+proj=longlat +ellps=WGS84")
auck_shore <- MapGen2SL("auckland_mapgen.dat", llCRS)

# without .dat
llCRS <- CRS("+proj=longlat +ellps=WGS84")
auck_shore <- MapGen2SL("auckland_mapgen", llCRS)

# Creating another data set
llCRS <- CRS("+proj=longlat +ellps=WGS84")
auck_data <-auckland_mapgen
auck_shore <- MapGen2SL("auck_data", llCRS)

I attached a print screen of the R workplace so you can see what I did.

Thanks a lot for your help.

Jose



2014-02-20 10:13 GMT-03:00 matsei [via R-sig-geo] <
ml-node+s2731867n7585805h93 at n2.nabble.com>:

> Hello Jose,
>
> This error message indicates, that you used the wrong file path. Check
> this and correct the path you're using.
>
> Alternatively, try this:
> yourfilepath <- "C:/Master_Bivand/auckland_mapgen.dat" # adapt this to
> your file path
> auckshore <- read.table(yourfilepath)
>
> If this does not solve you problem, please first have a thorough look at
> the posting guide.
> http://www.r-project.org/posting-guide.html
>
> Best regards,
> Mathias
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://r-sig-geo.2731867.n2.nabble.com/Bivand-book-chapter-2-Auckland-example-tp7585802p7585805.html
>  To unsubscribe from Bivand book chapter 2 Auckland example, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7585802&code=cm90dW5kby5qb3NlQGdtYWlsLmNvbXw3NTg1ODAyfC0xMjQ4MzI2Mzk=>
> .
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>



-- 


Jos? L. Rotundo
CONICET
Facultad de Ciencias Agrarias
Univ. Nacional de Rosario
Zavalla, Santa Fe
Argentina


Print screen example Bivand Book2.pdf (174K) <http://r-sig-geo.2731867.n2.nabble.com/attachment/7585806/0/Print%20screen%20example%20Bivand%20Book2.pdf>




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bivand-book-chapter-2-Auckland-example-tp7585802p7585806.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Feb 20 16:40:09 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 20 Feb 2014 16:40:09 +0100
Subject: [R-sig-Geo] Bivand book chapter 2 Auckland example
In-Reply-To: <CADBY2prqFxoOXXWeUyEfaisvQYXP+LGbiATthuSAhPQ4DSDKSA@mail.gmail.com>
References: <1392834438031-7585802.post@n2.nabble.com>
	<1392902007656-7585805.post@n2.nabble.com>
	<CADBY2prqFxoOXXWeUyEfaisvQYXP+LGbiATthuSAhPQ4DSDKSA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1402201632140.27706@reclus.nhh.no>

On Thu, 20 Feb 2014, rotundo wrote:

> Hello Mathias,
>
> Thanks a lot for your response. I tried what you suggested but it didn?t
> work.

I don't think that you did. Do:

list.files(pattern="auckland_mapgen")

before:

auck_shore <- MapGen2SL("auckland_mapgen.dat", llCRS)

If you see:

> list.files(pattern="auckland_mapgen")
character(0)

then the file is not in your working directory. If you cannot resolve this 
by pointing the R session at the correct directory (see ?setwd), simply 
run R outside RStudio, which is getting between you and the data.

The general advice is that if anything doesn't work in RStudio, use R, not 
RStudio. All of the code from the book is available for download from 
www.asdar-book.org and is run nightly to check for problems arising from 
updates of packages.

Roger

>
> I don?t think the error is in the file path, since I am using R studio, and
> the file auckland_mapgen.dat is already imported to the workspace. So,
> after loading the file, I run three different  codes, but still have the
> same error message:
>
> library(maps)
> library(maptools)
>
> #Example Page 41 as in the book
> llCRS <- CRS("+proj=longlat +ellps=WGS84")
> auck_shore <- MapGen2SL("auckland_mapgen.dat", llCRS)
>
> # without .dat
> llCRS <- CRS("+proj=longlat +ellps=WGS84")
> auck_shore <- MapGen2SL("auckland_mapgen", llCRS)
>
> # Creating another data set
> llCRS <- CRS("+proj=longlat +ellps=WGS84")
> auck_data <-auckland_mapgen
> auck_shore <- MapGen2SL("auck_data", llCRS)
>
> I attached a print screen of the R workplace so you can see what I did.
>
> Thanks a lot for your help.
>
> Jose
>
>
>
> 2014-02-20 10:13 GMT-03:00 matsei [via R-sig-geo] <
> ml-node+s2731867n7585805h93 at n2.nabble.com>:
>
>> Hello Jose,
>>
>> This error message indicates, that you used the wrong file path. Check
>> this and correct the path you're using.
>>
>> Alternatively, try this:
>> yourfilepath <- "C:/Master_Bivand/auckland_mapgen.dat" # adapt this to
>> your file path
>> auckshore <- read.table(yourfilepath)
>>
>> If this does not solve you problem, please first have a thorough look at
>> the posting guide.
>> http://www.r-project.org/posting-guide.html
>>
>> Best regards,
>> Mathias
>>
>> ------------------------------
>>  If you reply to this email, your message will be added to the discussion
>> below:
>>
>> http://r-sig-geo.2731867.n2.nabble.com/Bivand-book-chapter-2-Auckland-example-tp7585802p7585805.html
>>  To unsubscribe from Bivand book chapter 2 Auckland example, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7585802&code=cm90dW5kby5qb3NlQGdtYWlsLmNvbXw3NTg1ODAyfC0xMjQ4MzI2Mzk=>
>> .
>> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>>
>
>
>
> -- 
>
>
> Jos? L. Rotundo
> CONICET
> Facultad de Ciencias Agrarias
> Univ. Nacional de Rosario
> Zavalla, Santa Fe
> Argentina
>
>
> Print screen example Bivand Book2.pdf (174K) <http://r-sig-geo.2731867.n2.nabble.com/attachment/7585806/0/Print%20screen%20example%20Bivand%20Book2.pdf>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bivand-book-chapter-2-Auckland-example-tp7585802p7585806.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From narayani at ku.edu  Thu Feb 20 16:58:58 2014
From: narayani at ku.edu (Narayani Barve)
Date: Thu, 20 Feb 2014 09:58:58 -0600
Subject: [R-sig-Geo] Error maxentResults.csv not found
Message-ID: <CAE=+0-+7oT1jek7gArNFBJK4ePH6V7AVEde5rFVcymdsT5AtGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140220/031a1b49/attachment.pl>

From s6lihert at uni-bonn.de  Thu Feb 20 17:11:23 2014
From: s6lihert at uni-bonn.de (Lionel)
Date: Thu, 20 Feb 2014 17:11:23 +0100
Subject: [R-sig-Geo] Error maxentResults.csv not found
In-Reply-To: <CAE=+0-+7oT1jek7gArNFBJK4ePH6V7AVEde5rFVcymdsT5AtGw@mail.gmail.com>
References: <CAE=+0-+7oT1jek7gArNFBJK4ePH6V7AVEde5rFVcymdsT5AtGw@mail.gmail.com>
Message-ID: <5306292B.8080400@uni-bonn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140220/60c1eb06/attachment.pl>

From narayani at ku.edu  Thu Feb 20 17:59:57 2014
From: narayani at ku.edu (Narayani Barve)
Date: Thu, 20 Feb 2014 10:59:57 -0600
Subject: [R-sig-Geo] Error maxentResults.csv not found
In-Reply-To: <5306292B.8080400@uni-bonn.de>
References: <CAE=+0-+7oT1jek7gArNFBJK4ePH6V7AVEde5rFVcymdsT5AtGw@mail.gmail.com>
	<5306292B.8080400@uni-bonn.de>
Message-ID: <CAE=+0-LTMBP_7oyzwv0fU+T63a4Cg9+DBFSKgSkrvUikZ=Aiig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140220/b598bc7c/attachment.pl>

From jmunoz at rjb.csic.es  Thu Feb 20 19:51:25 2014
From: jmunoz at rjb.csic.es (=?iso-8859-1?B?SmVz+nMgTXXxb3o=?=)
Date: Thu, 20 Feb 2014 19:51:25 +0100
Subject: [R-sig-Geo] correlation betwee two grids acounting for univariate
	spatial autocorrelation, how to do it?
Message-ID: <025b01cf2e6c$c1a25260$44e6f720$@csic.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140220/e15142d2/attachment.pl>

From flaxman at gmail.com  Thu Feb 20 19:59:31 2014
From: flaxman at gmail.com (Seth Flaxman)
Date: Thu, 20 Feb 2014 13:59:31 -0500
Subject: [R-sig-Geo] correlation betwee two grids acounting for
 univariate spatial autocorrelation, how to do it?
In-Reply-To: <025b01cf2e6c$c1a25260$44e6f720$@csic.es>
References: <025b01cf2e6c$c1a25260$44e6f720$@csic.es>
Message-ID: <CAPGk9pesTTY-M7-X7nfns14tAxc=Lv4YFf7oW_EOTm3OWV2brA@mail.gmail.com>

Hi Jes?s.

I think of this as something of an open research problem, so I'm
curious to hear what others have to say. I looked at the reference you
sent (which is new to me, looks interesting!)

Is your original data a spatial point pattern which you've smoothed
into a map (as in spatial point processes)? Or do you have variables
observed for spatial regions (as in geostatistics)?

Seth

On Thu, Feb 20, 2014 at 1:51 PM, Jes?s Mu?oz <jmunoz at rjb.csic.es> wrote:
> Dear colleagues,
>
> I needed to measure the association degree (and ideally its p-value) between
> two maps, one representing richness of European bryophytes and the other
> vascular plant richeness. From the maps it is clear the two patterns are
> reversed: bryophytes 'rule' in the north, and vascular plant richness is
> higher in  southern Europe.
>
> I have used isodata algorithm followed by a Maximum-likelihood
> classification to generate a map showing four different areas in Europe
> (lowbryo-lowvasc, lowbryo-highvasc, highbryo-lowvasc, and
> highbryo-highvasc). Additionally, I would like to run a correlation analysis
> but corrected for the univariate spatial correlation of each variable
> (bryophytes and vascular plant richness); a global correlation map-to-map is
> meaningless here.
>
> I found a statistic that would suit my needs (Lee, S.-I. 2001. Developing a
> bivariate spatial association measure: An integration of Pearson's r and
> Moran's I. Journal of Geographical Systems 3(4): 369-385). It is implemented
> in 'The Map Comparison Kit' (http://www.riks.nl/mck/), but it return values
> outside the -1 to 1 values, which makes me think there is something wrong in
> the code or the statistic.
>
> Can somebody guide me to a R package allowing me to measure the association
> between these two grids?
>
> thanks in advance,
>
> Jes?s
>
>
>
>
>
> *************************************************************************
>
> Jes?s Mu?oz PhD            e-mail: jmunoz at rjb.csic.es
>
> Real Jard?n Bot?nico (CSIC)
>
> C/ Claudio Moyano 1        tlf. +34 91 420 3017
>
> E-28014 Madrid             fax. +34 91 420 0157
>
> ESPA?A (Spain)
>
>
>
> http://www.masterenbiodiversidad.org
>
>
>
> http://www.rjb.csic.es/jardinbotanico/jardin/contenido.php?Pag=413&tipo=cien
> tifico&cod=66
>
>
>
> KRAKEN research group (environmental modelling, data processing & analysis):
>
>                             http://www.unex.es/investigacion/grupos/kraken
>
>
>
> SYNTHESYS: EU funds short visits to our institution:
>
> http://www.synthesys.info/index.htm
>
> *************************************************************************
>
>
>
>
>
> __________ Informaci?n de ESET Endpoint Security, versi?n de la base de
> firmas de virus 9449 (20140220) __________
>
> ESET Endpoint Security ha comprobado este mensaje.
>
> http://www.eset.com
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From marcelino.delacruz at upm.es  Thu Feb 20 20:40:08 2014
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 20 Feb 2014 20:40:08 +0100
Subject: [R-sig-Geo] correlation betwee two grids acounting for
 univariate spatial autocorrelation, how to do it?
In-Reply-To: <025b01cf2e6c$c1a25260$44e6f720$@csic.es>
References: <025b01cf2e6c$c1a25260$44e6f720$@csic.es>
Message-ID: <53065A18.5010000@upm.es>

Hi Jes?s,

If you are talking about gridded maps, you could consider Syrjala's test 
(Stephen E. Syrjala 1996. A Statistical Test for a Difference between 
the Spatial Distributions of Two Populations. Ecology 77:75?80. 
http://dx.doi.org/10.2307/2265656). It is implemented in the ecespa package.


Cheers,

Marcelino



El 20/02/2014 19:51, Jes?s Mu?oz escribi?:
> Dear colleagues,
>
> I needed to measure the association degree (and ideally its p-value) between
> two maps, one representing richness of European bryophytes and the other
> vascular plant richeness. From the maps it is clear the two patterns are
> reversed: bryophytes 'rule' in the north, and vascular plant richness is
> higher in  southern Europe.
>
> I have used isodata algorithm followed by a Maximum-likelihood
> classification to generate a map showing four different areas in Europe
> (lowbryo-lowvasc, lowbryo-highvasc, highbryo-lowvasc, and
> highbryo-highvasc). Additionally, I would like to run a correlation analysis
> but corrected for the univariate spatial correlation of each variable
> (bryophytes and vascular plant richness); a global correlation map-to-map is
> meaningless here.
>
> I found a statistic that would suit my needs (Lee, S.-I. 2001. Developing a
> bivariate spatial association measure: An integration of Pearson's r and
> Moran's I. Journal of Geographical Systems 3(4): 369-385). It is implemented
> in 'The Map Comparison Kit' (http://www.riks.nl/mck/), but it return values
> outside the -1 to 1 values, which makes me think there is something wrong in
> the code or the statistic.
>
> Can somebody guide me to a R package allowing me to measure the association
> between these two grids?
>
> thanks in advance,
>
> Jes?s
>
>
>
>
>
> *************************************************************************
>
> Jes?s Mu?oz PhD            e-mail: jmunoz at rjb.csic.es
>
> Real Jard?n Bot?nico (CSIC)
>
> C/ Claudio Moyano 1        tlf. +34 91 420 3017
>
> E-28014 Madrid             fax. +34 91 420 0157
>
> ESPA?A (Spain)
>
>
>
> http://www.masterenbiodiversidad.org
>
>
>
> http://www.rjb.csic.es/jardinbotanico/jardin/contenido.php?Pag=413&tipo=cien
> tifico&cod=66
>
>
>
> KRAKEN research group (environmental modelling, data processing & analysis):
>
>                              http://www.unex.es/investigacion/grupos/kraken
>
>
>
> SYNTHESYS: EU funds short visits to our institution:
>
> http://www.synthesys.info/index.htm
>
> *************************************************************************
>
>
>
>
>
> __________ Informaci?n de ESET Endpoint Security, versi?n de la base de
> firmas de virus 9449 (20140220) __________
>
> ESET Endpoint Security ha comprobado este mensaje.
>
> http://www.eset.com
>
>
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Thu Feb 20 21:53:21 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 20 Feb 2014 12:53:21 -0800
Subject: [R-sig-Geo] Error maxentResults.csv not found
In-Reply-To: <CAE=+0-LTMBP_7oyzwv0fU+T63a4Cg9+DBFSKgSkrvUikZ=Aiig@mail.gmail.com>
References: <CAE=+0-+7oT1jek7gArNFBJK4ePH6V7AVEde5rFVcymdsT5AtGw@mail.gmail.com>
	<5306292B.8080400@uni-bonn.de>
	<CAE=+0-LTMBP_7oyzwv0fU+T63a4Cg9+DBFSKgSkrvUikZ=Aiig@mail.gmail.com>
Message-ID: <CANtt_hz2ozjPvTco16TscZJZABgU_4k0BQs36v5+Hioqngt0JA@mail.gmail.com>

Narayani:

There is not much to add to what Lionel said. In R, model fitting and
prediction are separate steps. I would suggest studying the manual,
and following the examples. See:

library(dismo)
?maxent
vignette('sdm')

Robert

On Thu, Feb 20, 2014 at 8:59 AM, Narayani Barve <narayani at ku.edu> wrote:
> Hi Lionel,
>
> Thank you very much for the input. But I was thinking the first two
> arguments is for fitting the model and then the projectionlayers and
> environmentallayers arguments are for predicting the model? Because if we
> pass only two arguments viz, predictors and occurrences, it only only fits
> the model. To get the actual prediction, predict function is required. I am
> not very sure about this. May be expert can shade some light on this.
>
> Regards,
> Narayani
>
>
> On Thu, Feb 20, 2014 at 10:11 AM, Lionel <s6lihert at uni-bonn.de> wrote:
>
>> Hi Narayani,
>>
>> The maxent function in R do not need all the arguments you provided, try
>> giving first only the Rasters (predictors) and the occurrence points
>> (occur), check that your predictors and occur object are not empty and
>> contain the environmental variables and the location and then run maxent
>> only with these two arguments. Then you could try to build on this and
>> add some of the arguments that you provided like "nowarnings", but in
>> the code that you gave below some arguments are redundant, for example
>> you give two times the environmental layers, the first time when you
>> pass them to the function through the predictors object and the second
>> time by specifying in the args a path to the environmental layers. I
>> guess this might cause some errors.
>>
>> Hope this helps,
>> Lionel
>>
>> On 02/20/2014 04:58 PM, Narayani Barve wrote:
>> > Hi All,
>> >
>> > I would like to run maxent models for 100's of species. Hence, I am
>> running
>> > maxent using "dismo" package in R. I have to pass many arguments to
>> maxent,
>> > so call I have given to maxent is as given below
>> >
>> > xm2 <- maxent(predictors, occur, args=c("nowarnings",
>> >                                             "noprefixes",
>> >                                             "responsecurves",
>> >                                             "jackknife",
>> >                                             "outputformat=raw",
>> >
>> > "outputdirectory=F:\\ModelOutputCli\\MOD1\\test",
>> >
>> > "projectionlayers=F:\\maxent_test\\env_layers_fut\\CC2650"),
>> >
>> > "samplesfile=F:\\DistFilt\\5minutes\\Aca_cia.csv",
>> >
>> > "environmentallayers=F:\\crop_rasters_Ms_5\\Aca_cia"),
>> >                                             "randomseed",
>> >                                             "replicates=3",
>> >                                             "replicatetype=bootstrap",
>> >                                             "nodoclamp"))
>> >
>> > Unfortunately, the function does not execute and I get following message.
>> > Can anyone shade light on this error? I have given sessionInfo() below
>> the
>> > error message
>> >
>> > Any help is appreciated,
>> >
>> > Regards,
>> > Narayani
>> >
>> > Warning messages:
>> > 1: In .local(x, p, ...) :
>> >    5 (7.81%) of the presence points have NA predictor values
>> > 2: In file(file, "rt") :
>> >    cannot open file
>> >
>> 'C:/Users/Narayani/AppData/Local/Temp/R_raster_Narayani/maxent/1826517661/maxentResults.csv':
>> > No such file or directory
>> > Error in t(read.csv(paste(dirout, "/maxentResults.csv", sep = ""))) :
>> >    error in evaluating the argument 'x' in selecting a method for
>> function
>> > 't': Error in file(file, "rt") : cannot open the connection
>> >
>> >
>> >
>> >> sessionInfo()
>> > R version 3.0.2 (2013-09-25)
>> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >
>> > locale:
>> > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> > States.1252    LC_MONETARY=English_United States.1252
>> > [4] LC_NUMERIC=C                           LC_TIME=English_United
>> > States.1252
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> > [1] rJava_0.9-6  rgdal_0.8-14 dismo_0.9-3  raster_2.2-5 sp_1.0-14
>> >
>> > loaded via a namespace (and not attached):
>> > [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rahmannorthampton at gmail.com  Fri Feb 21 12:58:30 2014
From: rahmannorthampton at gmail.com (Lutfor)
Date: Fri, 21 Feb 2014 03:58:30 -0800 (PST)
Subject: [R-sig-Geo] spatial distribution of two species and nest design
In-Reply-To: <1392800781964-7585799.post@n2.nabble.com>
References: <1392800781964-7585799.post@n2.nabble.com>
Message-ID: <1392983910355-7585815.post@n2.nabble.com>

Thanks for your help and valuable suggestions. I am getting into "ecespa"
package. But I think I still have starting hurdle with my data. When I draw
my spatial data points it appear as diagonal with my spatial points and
consequently when I do quadrats counts, some quadrats appear as "0"
(specially corner one). Those corners counts might have unnecessary
influence on my analysis. Could you please help to how I could make square
box with my spatial points.
<http://r-sig-geo.2731867.n2.nabble.com/file/n7585815/Rplot.jpeg> Kind
regardsLutfor



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-distribution-of-two-species-and-nest-design-tp7585799p7585815.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Fri Feb 21 13:39:28 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 21 Feb 2014 13:39:28 +0100
Subject: [R-sig-Geo] overlay method in sp package
In-Reply-To: <CAL09-Eek2yUdqGO9BZcskrZOaV51QOyvwCEbpQVvJEFNwp2ZAg@mail.gmail.com>
References: <CAL09-Eexwh7Pi25vezdWwnbrKxNygi4_tPP0tt4wWivxuF75uA@mail.gmail.com>	<53038EB0.3000008@uni-muenster.de>
	<CAL09-Eek2yUdqGO9BZcskrZOaV51QOyvwCEbpQVvJEFNwp2ZAg@mail.gmail.com>
Message-ID: <53074900.9030102@uni-muenster.de>

Luis,

Running your script on the data attached gives me the following error,
that has nothing to do with your problem:

> coordinates(linuData) = ~ longd + breidd
Error in coordinates(linuData) = ~longd + breidd :
  object 'linuData' not found

Also, the script below does not work on the data you supplied.

Please verify posts carefully before you press send.

On 02/19/2014 11:22 AM, Luis Ridao wrote:
> Dear Edzer,
> 
> A script and a workspace are attached (tried 'over' but still not working)
> 
> thanks for your prompt response
> 
> best,
> Luis
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> Luis Ridao Cruz
> Faroe Marine Research Institute
> N?at?n 1, P.O. Box 3051
> FO-110 T?rshavn
> Faroe Islands
> Tel   : (+298) 353900
> Fax: : (+298) 353901
> e-mail: luisr at hav.fo
>            luridao at gmail.com
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> 
> 
> 
> On Tue, Feb 18, 2014 at 4:47 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>> Dear Luis,
>>
>> overlay is deprecated and you should use "over" now. Please provide a
>> reproducible example if you want me to understand what happens, and
>> consider posting to r-sig-geo.
>>
>> With best regards,
>>
>> On 02/18/2014 04:16 PM, Luis Ridao wrote:
>>> Dear Edzer,
>>>
>>> I'm using the "overlay" method to detect the presence of some points onto
>>> a "GridTopology" object but i keep on bumping with errors:
>>>
>>>
>>> fbgrid <- GridTopology(c(-9.5, 60.4), c(0.05, 0.05),c(40,
>>> 20))
>>> yy <- SpatialGrid(grid =
>>> fbgrid)
>>> fish <-
>>> SpatialPoints(linu$coords)
>>> out  <- overlay(yy,
>>> fish)
>>> out1 <- formatC(out, width=4, format="d", flag="0")
>>>
>>> res  <- aggregate(rep(1, length(out)), list(out1), sum)     # res$x are
>> the
>>> counts in cells
>>> res1 <- numeric(nrow(coordinates(yy)))                      # res1 are
>> the
>>> counts on every cell even in
>>>
>>>> res1[as.integer(as.character(res$Group.1))] <- res$x     # those with 0
>>> counts
>>> Error in res1[as.integer(as.character(res$Group.1))] <- res$x :
>>>   NAs are not allowed in subscripted assignments
>>> In addition: Warning message:
>>> In res1[as.integer(as.character(res$Group.1))] <- res$x :
>>>   NAs introduced by coercion
>>>
>>>
>>> and if i try :
>>>
>>>> res1[!(is.na(as.integer(as.character(res$Group.1))))] <-
>>> res$x
>>> Warning messages:
>>> 1: In res1[!(is.na(as.integer(as.character(res$Group.1))))] <- res$x :
>>>   NAs introduced by coercion
>>> 2: In res1[!(is.na(as.integer(as.character(res$Group.1))))] <- res$x :
>>>   number of items to replace is not a multiple of replacement length
>>>
>>>> tail(res)
>>>     Group.1  x
>>> 344 0733 2
>>> 345 0737 1
>>> 346 0767 1
>>> 347 0768 2
>>> 348 0775 1
>>> 349      NA 14
>>>
>>>> dim(res)
>>> [1] 349   2
>>>
>>>> length(res1)
>>> [1] 800
>>>
>>>
>>> how can i solve this problem?
>>>
>>> best,
>>> Luis
>>>
>>> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>>> Luis Ridao Cruz
>>> Faroe Marine Research Institute
>>> N?at?n 1, P.O. Box 3051
>>> FO-110 T?rshavn
>>> Faroe Islands
>>> Tel   : (+298) 353900
>>> Fax: : (+298) 353901
>>> e-mail: luisr at hav.fo
>>>            luridao at gmail.com
>>> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>>>
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
>> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140221/28fc529f/attachment.bin>

From nolde at geographie.uni-kiel.de  Fri Feb 21 14:41:31 2014
From: nolde at geographie.uni-kiel.de (Michael Nolde)
Date: Fri, 21 Feb 2014 14:41:31 +0100
Subject: [R-sig-Geo] how to write a netCDF with irregular grid
Message-ID: <5307578B.90403@geographie.uni-kiel.de>

Hello there,

I've got a netCDF file which I want to read, modify, and save, which works
well with 'ncdf4'-package.
The problem is, that the grid representing the data (temperature values) is
irregular, and I am not able to output an irregular grid. In the original
file I have two variables ('lat' and 'lon'), which are both two-dimensional
(356 x 236), with each entry representing the latitude or longitude,
respectively, of each cell in the original grid (356 x 236 x 365 [days]).

In the input file, the data grid (TMAX_2M, please see blow) references the
'lat' and 'lon' variables by the argument 'coordinates = "lon lat"', which,
as far as I understood, make my viewer application (Panoply) make the data
appear in the correct locations.
However, I am not able to hand this argument to the 'ncvar_def' method (the
error is: 'unused argument'), so at the moment I use only one dimension of
the 'lat' and 'lon' variables and hand them to the 'ncvar_def'-method, which
produces an distorted (regular) output.

I would love to know how to make the netCDF file aware that the
latitude/longitude coordinates of the data grid cells are stored in the
"external" 'lat' and 'lon' variables, and not in the grid object itself.
Below I'm posting the structure of my input file, which I hope to reproduce,
as well as my source code so far.
Any help is highly appreciated, thank you very much in advance.

Best regards, Michael


this is the structure of the source netCDF file:
-----------------------------------------------------

dimensions:
     x = 356;
     y = 236;
     height_2m = 1;
     time = UNLIMITED; // (365 currently
     nb2 = 2;

variables:
     float lon(y=236, x=356);
         :standard_name = "longitude";
         :long_name = "longitude";
         :units = "degrees_east";
         :_CoordinateAxisType = "Lon";

     float lat(y=236, x=356);
         :standard_name = "latitude";
         :long_name = "latitude";
         :units = "degrees_north";
         :_CoordinateAxisType = "Lat";

     float height_2m(height_2m=1);
         :standard_name = "height";
         :long_name = "height above the surface";
         :units = "m";
         :positive = "up";
         :axis = "Z";

     double time(time=365);
         :standard_name = "time";
         :long_name = "time";
         :bounds = "time_bnds";
         :units = "seconds since 1979-01-01 00:00:00";
         :calendar = "proleptic_gregorian";

     double time_bnds(time=365, nb2=2);
         :units = "seconds since 1979-01-01 00:00:00";
         :calendar = "proleptic_gregorian";

     float TMAX_2M(time=365, height_2m=1, y=236, x=356);
         :standard_name = "air_temperature";
         :long_name = "2m maximum temperature";
         :units = "K";
         :coordinates = "lon lat";
         :cell_methods = "time: maximum";
         :_FillValue = -9.0E33f; // float


this is my source code so far:
---------------------------------

library(ncdf4)
library(maptools)
library(sp)

ncdfname <- "TMAX_2M.nc"
ncdffile <- nc_open(ncdfname)
latorig <- ncvar_get(ncdffile,"lat",verbose=F)
lonorig <- ncvar_get(ncdffile,"lon")
timeorig <- ncvar_get(ncdffile,"time",verbose=F)
tunits <- ncatt_get(ncdffile,"time","units")

# get global attributes
titleorig <- ncatt_get(ncdffile,0,"title")
institutionorig <- ncatt_get(ncdffile,0,"institution")
datasourceorig <- ncatt_get(ncdffile,0,"source")
referencesorig <- ncatt_get(ncdffile,0,"references")
historyorig <- ncatt_get(ncdffile,0,"history")
Conventionsorig <- ncatt_get(ncdffile,0,"Conventions")

temp.array <- ncvar_get(ncdffile,"TMAX_2M")
dlname <- ncatt_get(ncdffile,"TMAX_2M","long_name")
dunits <- ncatt_get(ncdffile,"TMAX_2M","units")
fillvalue <- ncatt_get(ncdffile,"TMAX_2M","_FillValue")
temp.array[temp.array==fillvalue$value] <- NA
temp.array[temp.array==NULL] <- NA
nc_close(ncdffile)
temp.slice <- temp.array[,,1]


lonorig1d = lonorig[,1]
latorig1d = latorig[1,]

lonorig1d_sort = sort(lonorig1d, decreasing=FALSE)
latorig1d_sort = sort(latorig1d, decreasing=FALSE)

dim_lon  <- ncdim_def('x', 'degrees_east', as.double(lonorig1d_sort),
create_dimvar=TRUE)
dim_lat  <- ncdim_def('y', 'degrees_north', as.double(latorig1d_sort),
create_dimvar=TRUE)

dim_height  <- ncdim_def('height_2m', 'height', c(0:0))
dim_time <- ncdim_def('time', "seconds since 1979-01-01 00:00:00",
calendar="proleptic_gregorian", unlim=T, c(364:0))

var_out_lon <- ncvar_def('lon', 'degrees_east', list(dim_lon),
longname="longitude")
var_out_lat <- ncvar_def('lat', 'degrees_north', list(dim_lat),
longname="latitude")
var_out_timebnds <- ncvar_def('time_bnds', "seconds since 1979-01-01
00:00:00", list(dim_time))

var_out <- ncvar_def('TMAX_2M', 'K', list(dim_lon,dim_lat,dim_time), 9.e20,
longname="2m maximum temperature")

ncid_out <- nc_create('updated_netcdf.nc', list(var_out, var_out_lon,
var_out_lat))

ncvar_put(ncid_out, var_out, temp.array[,,])
nc_close(ncid_out)


From markpayneatwork at gmail.com  Fri Feb 21 15:59:17 2014
From: markpayneatwork at gmail.com (Mark Payne)
Date: Fri, 21 Feb 2014 15:59:17 +0100
Subject: [R-sig-Geo] Problem with raster
Message-ID: <CAGBzUO-H7Vf2C81qdsP6Q+Q-tJ0LOOfDE4_mz74uFEu7HejnWw@mail.gmail.com>

Hi,

I am having a problem with the following code - I'm trying to create a
raster from a SpatialGrid, but there seems to be something going wrong
along the way - the problem pops up when I try to build two
rasterlayers into a brick:

> halfrect.grd <- GridTopology(c(-22.75,36.75),
+                              c(0.5,0.5),
+                              c(46,55))
> grd.sp <- SpatialGrid(halfrect.grd,proj4string=CRS("+longlat"))
> grd.r <- raster(grd.sp)
> brick(grd.r,grd.r)
class       : RasterBrick
dimensions  : 55, 46, 2530, 1  (nrow, ncol, ncell, nlayers)
resolution  : 0.5, 0.5  (x, y)
extent      : -23, 0, 36.5, 64  (xmin, xmax, ymin, ymax)
coord. ref. : +longlat

This works ok so far. But then if I try to change the value, it fails

> EP.r <- grd.r
> EP.r[] <- NA
> brick(EP.r,EP.r)  #Doesn't
Error in x[, 2] : subscript out of bounds
> values(EP.r) <- NA
> brick(EP.r,EP.r)  #Doesn't
Error in x[, 2] : subscript out of bounds
>

My package details are below. Does anyone have any ideas what could be
going wrong?

Mark

> packageDescription("raster")
Package: raster
Type: Package
Title: raster: Geographic data analysis and modeling
Version: 2.2-12
Date: 2014-1-17
<snip>

> R.version
               _
platform       x86_64-pc-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status
major          3
minor          0.1
year           2013
month          05
day            16
svn rev        62743
language       R
version.string R version 3.0.1 (2013-05-16)
nickname       Good Sport
>


From r.hijmans at gmail.com  Fri Feb 21 18:15:01 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 21 Feb 2014 09:15:01 -0800
Subject: [R-sig-Geo] Problem with raster
In-Reply-To: <CAGBzUO-H7Vf2C81qdsP6Q+Q-tJ0LOOfDE4_mz74uFEu7HejnWw@mail.gmail.com>
References: <CAGBzUO-H7Vf2C81qdsP6Q+Q-tJ0LOOfDE4_mz74uFEu7HejnWw@mail.gmail.com>
Message-ID: <CANtt_hzE=2hc6G+V7_4WAbVz-_2oiNJQEtBXxpVYq-D7oFCorw@mail.gmail.com>

Mark,

You would not be tell from the error message, but the error occurs
because you are using an invalid CRS.
It should be:

proj4string=CRS("+proj=longlat")

instead of this:

proj4string=CRS("longlat")

Robert


On Fri, Feb 21, 2014 at 6:59 AM, Mark Payne <markpayneatwork at gmail.com> wrote:
> Hi,
>
> I am having a problem with the following code - I'm trying to create a
> raster from a SpatialGrid, but there seems to be something going wrong
> along the way - the problem pops up when I try to build two
> rasterlayers into a brick:
>
>> halfrect.grd <- GridTopology(c(-22.75,36.75),
> +                              c(0.5,0.5),
> +                              c(46,55))
>> grd.sp <- SpatialGrid(halfrect.grd,proj4string=CRS("+longlat"))
>> grd.r <- raster(grd.sp)
>> brick(grd.r,grd.r)
> class       : RasterBrick
> dimensions  : 55, 46, 2530, 1  (nrow, ncol, ncell, nlayers)
> resolution  : 0.5, 0.5  (x, y)
> extent      : -23, 0, 36.5, 64  (xmin, xmax, ymin, ymax)
> coord. ref. : +longlat
>
> This works ok so far. But then if I try to change the value, it fails
>
>> EP.r <- grd.r
>> EP.r[] <- NA
>> brick(EP.r,EP.r)  #Doesn't
> Error in x[, 2] : subscript out of bounds
>> values(EP.r) <- NA
>> brick(EP.r,EP.r)  #Doesn't
> Error in x[, 2] : subscript out of bounds
>>
>
> My package details are below. Does anyone have any ideas what could be
> going wrong?
>
> Mark
>
>> packageDescription("raster")
> Package: raster
> Type: Package
> Title: raster: Geographic data analysis and modeling
> Version: 2.2-12
> Date: 2014-1-17
> <snip>
>
>> R.version
>                _
> platform       x86_64-pc-linux-gnu
> arch           x86_64
> os             linux-gnu
> system         x86_64, linux-gnu
> status
> major          3
> minor          0.1
> year           2013
> month          05
> day            16
> svn rev        62743
> language       R
> version.string R version 3.0.1 (2013-05-16)
> nickname       Good Sport
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From laura.poggio at gmail.com  Mon Feb 24 15:15:22 2014
From: laura.poggio at gmail.com (Laura Poggio)
Date: Mon, 24 Feb 2014 14:15:22 +0000
Subject: [R-sig-Geo] ifelse with multiple rasters
Message-ID: <CAKmfgFPL1PKzx0DGBYRGQXM5gGhzbAzB8fDceYoT8vW6JmeFLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140224/4ad453c8/attachment.pl>

From laura.poggio at gmail.com  Mon Feb 24 15:16:33 2014
From: laura.poggio at gmail.com (Laura Poggio)
Date: Mon, 24 Feb 2014 14:16:33 +0000
Subject: [R-sig-Geo] Fwd: ifelse with multiple rasters
In-Reply-To: <CAKmfgFPL1PKzx0DGBYRGQXM5gGhzbAzB8fDceYoT8vW6JmeFLA@mail.gmail.com>
References: <CAKmfgFPL1PKzx0DGBYRGQXM5gGhzbAzB8fDceYoT8vW6JmeFLA@mail.gmail.com>
Message-ID: <CAKmfgFNOZpi0QR4KPrCddAf9O12rYKv0EAeSu5Rom7qVfPWRSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140224/53b4696f/attachment.pl>

From jgrn at illinois.edu  Mon Feb 24 15:50:06 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 24 Feb 2014 08:50:06 -0600
Subject: [R-sig-Geo] Fwd: ifelse with multiple rasters
In-Reply-To: <CAKmfgFNOZpi0QR4KPrCddAf9O12rYKv0EAeSu5Rom7qVfPWRSA@mail.gmail.com>
References: <CAKmfgFPL1PKzx0DGBYRGQXM5gGhzbAzB8fDceYoT8vW6JmeFLA@mail.gmail.com>
	<CAKmfgFNOZpi0QR4KPrCddAf9O12rYKv0EAeSu5Rom7qVfPWRSA@mail.gmail.com>
Message-ID: <CABG0rfuEW28tOCMm841mAjVgZaZHkTBBJdSn9Lein1i75byrXw@mail.gmail.com>

Laura:

If this is a straight masking procedure, you can do some
multiplication tricks in raster like:

output = rst_a*rst_B*2

or look at
?overlay

or take a look at
?mask

I suspect mask and overlay are faster than the raster algebra
statement (Robert, is this correct?)

If you want to use rasterEngine for parallel processing, you can do
something like this:

library(spatial.tools)

# Set X to the number of CPUs you want top use and uncomment this for
parallel processing:
# sfQuickInit(cpus=X)

rst_test <- function(rst_a,rst_B)
{
return(ifelse(rst_a==0 & rst_B==1,2,0))
}

# Fill in the rasters you intend to use here:
raster_check <-
rasterEngine(rst_a=someraster,rst_B=someotherraster,fun=rst_test)

# Uncomment to stop the parallel engine if need be:
# sfQuickStop()

--j

On Mon, Feb 24, 2014 at 8:16 AM, Laura Poggio <laura.poggio at gmail.com> wrote:
> Dear list,
> I am struggling to find a way to do a simple if statement with multiple
> rasters in raster.
>
> For example:
> ifelse(rst_a==0 & rst_B=1,2,0)
>
> Which is the simplest and most efficient way to implement it? especially
> when considering large (>10,000,000 cells) rasters?
>
> Thank you in advance
>
> Laura
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From gbl1 at hi.is  Mon Feb 24 16:24:35 2014
From: gbl1 at hi.is (Gilles Benjamin Leduc)
Date: Mon, 24 Feb 2014 15:24:35 +0000
Subject: [R-sig-Geo] =?utf-8?q?How_to_do_an_anamorphosis_on_R=3F?=
Message-ID: <3011-530b6400-7f-7f728600@71854736>

Hi all, 

I would like to make an anamorphosis map, id est, a map where some other distance measurement are used instead geographical distance. In my case I would like to plot an anamorphosis of Iceland using genetical distence insteand of geographical distence. 
I have got .shp maps and equivalents. 
How to make such a distortion? 
Best regards 
Benjamin


From laura.poggio at gmail.com  Mon Feb 24 16:50:10 2014
From: laura.poggio at gmail.com (Laura Poggio)
Date: Mon, 24 Feb 2014 15:50:10 +0000
Subject: [R-sig-Geo] Fwd: ifelse with multiple rasters
In-Reply-To: <CABG0rfuEW28tOCMm841mAjVgZaZHkTBBJdSn9Lein1i75byrXw@mail.gmail.com>
References: <CAKmfgFPL1PKzx0DGBYRGQXM5gGhzbAzB8fDceYoT8vW6JmeFLA@mail.gmail.com>
	<CAKmfgFNOZpi0QR4KPrCddAf9O12rYKv0EAeSu5Rom7qVfPWRSA@mail.gmail.com>
	<CABG0rfuEW28tOCMm841mAjVgZaZHkTBBJdSn9Lein1i75byrXw@mail.gmail.com>
Message-ID: <CAKmfgFPBUrzqa9PS26R62YEP8EtNWUqz9fuaXjYwR-eQZWzZXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140224/389b4006/attachment.pl>

From pingyang.whu at gmail.com  Tue Feb 25 04:27:55 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 24 Feb 2014 21:27:55 -0600
Subject: [R-sig-Geo] Extract time series value for a given coodinate from an
 unusual NetCDF file
Message-ID: <CAK8gSG9+gqx6W=496oHysYnm9qiPdkAkt5UcGwL6opxsDY18QA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140224/9bdac620/attachment.pl>

From senator at ecotoxicology.de  Tue Feb 25 13:44:46 2014
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Tue, 25 Feb 2014 13:44:46 +0100
Subject: [R-sig-Geo] Summeracademy on Spatial Ecotoxicology
In-Reply-To: <mailman.13.1393326005.19947.r-sig-geo@r-project.org>
References: <mailman.13.1393326005.19947.r-sig-geo@r-project.org>
Message-ID: <386CB171-3FB7-4A2A-985D-5C7EBF3A065C@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140225/13e9e4c8/attachment.pl>

From mathieu.rajerison at gmail.com  Tue Feb 25 14:44:58 2014
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 25 Feb 2014 14:44:58 +0100
Subject: [R-sig-Geo] How to do an anamorphosis on R?
In-Reply-To: <3011-530b6400-7f-7f728600@71854736>
References: <3011-530b6400-7f-7f728600@71854736>
Message-ID: <CAGfc75kiPoYe5k6ZH2ugqKj6YAM3m3VU8veYP0Hz2iwirQ84dg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140225/fbf5fce0/attachment.pl>

From patrick.meyfroidt at uclouvain.be  Tue Feb 25 14:53:35 2014
From: patrick.meyfroidt at uclouvain.be (Patrick Meyfroidt)
Date: Tue, 25 Feb 2014 13:53:35 +0000
Subject: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum
	Likelihood
Message-ID: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140225/9e61d178/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb 25 15:11:35 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 25 Feb 2014 15:11:35 +0100
Subject: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum
 Likelihood
In-Reply-To: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>
References: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>
Message-ID: <alpine.LRH.2.03.1402251505510.29426@reclus.nhh.no>

On Tue, 25 Feb 2014, Patrick Meyfroidt wrote:

> Dear List,
>
> I have a problem using splm package: across various datasets and models, 
> the sphtest function never works when I try to calculate the Hausman 
> test with a model using Maximum Likelihood. I always receive the 
> following error message:
>
> Error in match.arg(spatial.error) :
>  'arg' must be NULL or a character vector
>
> I see that several other people posted the same problem before, but 
> apparently there was not solution proposed on the list: in September 
> 2011: 
> https://stat.ethz.ch/pipermail/r-sig-geo/2011-September/012826.html and 
> in May 2013: 
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-May/018256.html
>
> Does anyone have a solution?

Please never guess, it only misleads you and readers of your posting.

Please always state the output of sessionInfo() - we don't know which 
version of splm you are using.

Please always include a reproducible example of the code leading to the 
error with a built in data set.

Do check that the problem is not already resolved in the development 
version on R-forge, here:

https://r-forge.r-project.org/R/?group_id=352

>
> Thank you very much,
>
>
> Patrick Meyfroidt ------ F.R.S. - FNRS and Universit? catholique de 
> Louvain - UCLouvain
>
>
> 	[[alternative HTML version deleted]]

Finally, do not post HTML, much of the extensive carbon footprint of lists 
like this comes from scanning HTML postings for unwanted and/or dangerous 
payloads.

Hope this helps,

Roger

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From bakare at ualberta.ca  Tue Feb 25 19:26:55 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 25 Feb 2014 11:26:55 -0700
Subject: [R-sig-Geo] fitting nested structure model variogram using gstat
Message-ID: <CAJRR3XMQQNv9smABWVDEztz8xmaHBcNyLgqSsYCckkRxOjMpyg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140225/70559bf6/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Feb 26 10:09:19 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 26 Feb 2014 10:09:19 +0100
Subject: [R-sig-Geo] fitting nested structure model variogram using gstat
In-Reply-To: <CAJRR3XMQQNv9smABWVDEztz8xmaHBcNyLgqSsYCckkRxOjMpyg@mail.gmail.com>
References: <CAJRR3XMQQNv9smABWVDEztz8xmaHBcNyLgqSsYCckkRxOjMpyg@mail.gmail.com>
Message-ID: <530DAF3F.8070805@uni-muenster.de>



On 02/25/2014 07:26 PM, Moshood Agba Bakare wrote:
> Dear All,
> I have fitted basic model such as spherical, Gaussian, exponential, and
> linear to empirical variogram using gstat library in R. The models were
> fitted in omnidirectional and different directions to detect if the data
> exhibit anisotropy.
> 
> mpvar<-variogram(yield~1,canmod.sp,cutoff=300,width = 7 , cressie=TRUE)
> plot(empvar, xlab = "Lag distance (m)", ylab = "Semivariance", main =
> "Omnidirectional empirical Variogram for Yield")
> 
> 
> ### directional variogram
> empvar<-variogram(yield ~ 1,canmod.sp,cutoff=300,width =
> 7,alpha=c(0,45,90,135),cressie=TRUE)
> plot(empvar,xlab = "Lag distance (m)", ylab = "Semivariance", main =
> "Directional empirical Variogram
> 
> without defining the lag tolerance in my script, hope this would not have
> negative impact on my result.
> 
> secondly, I intend to fit nested structure model by looking at the linear

Your "firstly" just escaped me.

> combination of those basic model (spherical, gaussian, exponential, and
> linear). Please how do I modify my R script in gstat to model such a
> complex nested structure?

?vgm

> 
> Thirdly, if it is a must to define my lag tolerance, will it be 1.5 times
> whatever I use as my lag distance as specified by width=7?
> 

I don't know what you mean by "lag tolerance" -- does this term come
from the GSLIB literature? gstat::variogram does allow lags to overlap;
if you'd want this you'd need to write your own smoother for variogram
clouds.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140226/20f1ac04/attachment.bin>

From jecogeo at gmail.com  Wed Feb 26 14:43:20 2014
From: jecogeo at gmail.com (Jefferson Ferreira Ferreira)
Date: Wed, 26 Feb 2014 09:43:20 -0400
Subject: [R-sig-Geo] Guidance on adehabitat usage
Message-ID: <CAFFT+Y5_jPsAqxNTkvJMkyAvH8vuwhWYV4J7KjvTxXTx99SUKg@mail.gmail.com>

Dear forum members

I had successful use adehabitatHR R package to estimate home ranges for
jaguar based on collar data. Now I'm trying to analyse relocations with
adehabitatLT package following the vignette (
http://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf).
But some doubts emerged and if some of you could clarify me I'll be pleased
to hear your suggestions.

My collar data have +/- 19% of missing data due to problems related to
receiving GPS signal from collar. So, I've filtered the data:

#re-subseting to exclude rows with no coordinates
coto_nonas2 <- subset(coto, coto$GPS_Latitude != 'NA')

(1) In your opinion, is this procedure correct?

Well, after this i've execute

#Placing the missing values in the trajectory
# The relocations have been collected daily, but there are many days during
which
# this relocation was not possible (storm, lack of field workers, etc.).
# We need to add missing values to define a regular trajectory.
# We have to define a reference date that will be used to check that each
date in
# the object of class ltraj is separated from this reference by an integer
multiple
# of the theoretical dt (here, one day), and place the missing values at
the times
# when relocations should theoretically have been collected.

refdata <- strptime('2013-02-13 00:00:00', '%Y-%m-%d %H:%M:%S')

# function setNA to place the missing values with theoretical collects
every 6 hours
coto_moves2 <- setNA(coto_moves, refdata, 6, units = 'hour')

# Even when filling the gaps with NAs, the trajectory is still not regular.
# The function sett0 can be used to 'round' the timing of the coordinates.
coto_moves3 <- sett0(coto_moves2, refdata, 6, units = "hour")


And from then, I filled with doubts.
My wawotest returned any correlation among the variables.

            dx           dy        dist
a   24.6905441  42.29083967  24.6541496
ea  -1.0000000  -1.00000000  -1.0000000
va 403.9675822 405.47166447 409.2888978
za   1.2782036   2.14988760   1.2680683
p    0.1005888   0.01578205   0.1023868


(2) should I discretize the the data in space? Or in time?

As say in other message in r-sig-geo forum, I'm a begginer and
unfortunately working alone. Could you please provide me some guidance with
this?
Any suggestions will be appreciated.
Follows attached a snippet of my data and my script if it can be useful.

Best regards



-- 

*Jefferson Ferreira-Ferreira*

Ge?grafo - GEOPROCESSAMENTO IDSM | Coordenadoria de TI


Jefferson.ferreira at mamiraua.org.br

*Instituto de Desenvolvimento Sustent?vel Mamirau?*

Minist?rio da Ci?ncia, Tecnologia e Inova??o

Telefone: +55 97 3343-9710

*Google Maps* - Mapas deste e-mail:

Exibir mapa ampliado<https://maps.google.com.br/maps?q=-3.355557,-64.731151&ll=-3.355471,-64.731145&spn=0.004632,0.006968&num=1&t=h&z=18>


*Contatos particulares:*
*(55) 9615-0100 <%2855%29%209615-0100>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140226/d0746c03/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jaguar.zip
Type: application/zip
Size: 18235 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140226/d0746c03/attachment.zip>

From javier.martinez at um.es  Wed Feb 26 18:40:10 2014
From: javier.martinez at um.es (Javier =?iso-8859-1?b?TWFydO1uZXog?= =?iso-8859-1?b?TPNwZXo=?=)
Date: Wed, 26 Feb 2014 18:40:10 +0100
Subject: [R-sig-Geo] rPython installation problem
Message-ID: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>

Hello all,

I need to combine R and Python to process large raster files and I  
would like to use the "rPython" library for direct transformation of  
the data objects created using those environments. However, when I try  
to install it, it produces the following error related to the python  
libraries (see below). I just installed the Anaconda python  
distribution locally (no admin rights) in my home folder (Linux  
CentOS), which might be causing the problem, but I do not know how to  
deal with this issue, so any help is welcome!

Thank you very much and cheers,

Javier

> install.packages('rPython')
Installing package into /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
(as lib is unspecified)
trying URL  
'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
Content type 'text/plain' length 37034 bytes (36 Kb)
opened URL
==================================================
downloaded 36 Kb

* installing *source* package rPython ...
** package rPython successfully unpacked and MD5 sums checked
a specific python version to use was not provided
defaulting to the standard python in the system
checking for gcc... gcc -m64 -std=gnu99
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -m64 -std=gnu99 accepts -g... yes
checking for gcc -m64 -std=gnu99 option to accept ISO C89... none needed
configure: creating ./config.status
config.status: creating src/Makevars
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
-I/home/majavie/anaconda/include/python2.7
-I/home/majavie/anaconda/include/python2.7 -D
PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
-Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
--param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
-lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
-L/usr/lib64/R/lib -lR
/usr/bin/ld: cannot find -lpython2.7
collect2: ld returned 1 exit status
make: *** [rPython.so] Error 1
ERROR: compilation failed for package rPython
* removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
* restoring previous  
/home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython

The downloaded source packages are in
     /tmp/RtmpfPBtPF/downloaded_packages
Warning message:
In install.packages("rPython") :
   installation of package rPython had non-zero exit status


From Roger.Bivand at nhh.no  Wed Feb 26 18:59:10 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 26 Feb 2014 18:59:10 +0100
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
Message-ID: <alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>

On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:

> Hello all,
>
> I need to combine R and Python to process large raster files and I would like 
> to use the "rPython" library for direct transformation of the data objects 
> created using those environments. However, when I try to install it, it 
> produces the following error related to the python libraries (see below). I 
> just installed the Anaconda python distribution locally (no admin rights) in 
> my home folder (Linux CentOS), which might be causing the problem, but I do 
> not know how to deal with this issue, so any help is welcome!

This is not a specific question for this list, but there may be interest 
in this fresh and as yet unproven package. What does:

locate libpython2.7

say on your system? On current Fedora, I see:

/usr/lib64/libpython2.7.so

with:

$ python --version
Python 2.7.5

as per the advice in:

http://cran.r-project.org/web/packages/rPython/INSTALL

Your system should provide python, but may have only the python, not both 
that and the python-devel RPMs installed. If you have installed 
libpython2.7.so locally, you may need to adjust your LD_LIBRARY_PATH so 
that the library is visible. If you can get your sysadmin to add the 
python-devel RPM, life may be easier. Also, write to the package 
maintainer suggesting that libpython be checked in configure.

Hope this helps,

Roger

>
> Thank you very much and cheers,
>
> Javier
>
>> install.packages('rPython')
> Installing package into /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
> (as lib is unspecified)
> trying URL 
> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
> Content type 'text/plain' length 37034 bytes (36 Kb)
> opened URL
> ==================================================
> downloaded 36 Kb
>
> * installing *source* package rPython ...
> ** package rPython successfully unpacked and MD5 sums checked
> a specific python version to use was not provided
> defaulting to the standard python in the system
> checking for gcc... gcc -m64 -std=gnu99
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -m64 -std=gnu99 accepts -g... yes
> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none needed
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
> -I/home/majavie/anaconda/include/python2.7
> -I/home/majavie/anaconda/include/python2.7 -D
> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
> -L/usr/lib64/R/lib -lR
> /usr/bin/ld: cannot find -lpython2.7
> collect2: ld returned 1 exit status
> make: *** [rPython.so] Error 1
> ERROR: compilation failed for package rPython
> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
> * restoring previous 
> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>
> The downloaded source packages are in
>   /tmp/RtmpfPBtPF/downloaded_packages
> Warning message:
> In install.packages("rPython") :
> installation of package rPython had non-zero exit status
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From afischbach at usgs.gov  Wed Feb 26 22:22:37 2014
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Wed, 26 Feb 2014 13:22:37 -0800 (PST)
Subject: [R-sig-Geo] Guidance on adehabitat usage
In-Reply-To: <CAFFT+Y5_jPsAqxNTkvJMkyAvH8vuwhWYV4J7KjvTxXTx99SUKg@mail.gmail.com>
References: <CAFFT+Y5_jPsAqxNTkvJMkyAvH8vuwhWYV4J7KjvTxXTx99SUKg@mail.gmail.com>
Message-ID: <1393449757537-7585836.post@n2.nabble.com>

Jefferson, 
With your missing relocation data you are now faced with broad decisions
about how to work with these trajectories, but you are not alone with this
problem -- most projects that track animals suffer this problem.  I would
start by asking what biological questions you are trying to answer.  From
there you may consider your options.  As you seek to generate a regular
trjecotries, you may consider the use of a correlated random walk algorithms
(http://cran.r-project.org/web/packages/crawl), which will require
considerable thought on how to tune these algorithms to the unquique
problems of your tracking dataset.





-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Guidance-on-adehabitat-usage-tp7585833p7585836.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From pauloeducardoso at gmail.com  Thu Feb 27 00:11:01 2014
From: pauloeducardoso at gmail.com (pecardoso)
Date: Wed, 26 Feb 2014 15:11:01 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <1393300433872-7585826.post@n2.nabble.com>
References: <1393300433872-7585826.post@n2.nabble.com>
Message-ID: <1393456261449-7585837.post@n2.nabble.com>

The value range of your rasterLayer refers to the object dataType. You are
reading a raster as 16 bits signed and integer values. Try
?raster::dataType. You'll find further details there.
Reading a raster with INT2S will create an object with values ranging from
-32,767 to 32,767.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585837.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From wclaster at apu.ac.jp  Thu Feb 27 02:50:52 2014
From: wclaster at apu.ac.jp (william claster)
Date: Thu, 27 Feb 2014 14:50:52 +1300
Subject: [R-sig-Geo] longitude, latitude, and heat value
Message-ID: <CAJnbHtKz-fi=HqDsoOrtWsBpAQvpBs_b9z8yi5EWVzuY3cu4NQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/060b350a/attachment.pl>

From cyndyh at nmsu.edu  Thu Feb 27 04:49:35 2014
From: cyndyh at nmsu.edu (Cynthia Hart)
Date: Wed, 26 Feb 2014 20:49:35 -0700
Subject: [R-sig-Geo] strange trouble with writeOGR call
Message-ID: <530EB5CF.1070202@nmsu.edu>

I am working on an application that uses 'Shiny'; which allows for 
basically running R through a web browser.  My application is tested on 
my Windows laptop then ported to a Linux server.   My application 
analyzes spatial data, and uses the rgdal library.

I am getting s strange error from writeOGR from a recent version of my 
application, and I don't understand why, as the error did not occur 
before on either platform, and the changes should not have effected the 
call to write.

'Error:  Layer Creation failed'

is the error I am getting.  Which seems to imply a permissions problem, 
but I've analyzed that angle to death, and I cannot see a problem (I 
even saved a temporary variable to disk right before the writeOGR call, 
to the same intended directory, and that works fine).   Is there some 
other cause for this error, some other possible problem I should be 
looking for?  Thanks!


From upimple at gmail.com  Thu Feb 27 05:16:00 2014
From: upimple at gmail.com (Uday)
Date: Wed, 26 Feb 2014 20:16:00 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <1393456261449-7585837.post@n2.nabble.com>
References: <1393300433872-7585826.post@n2.nabble.com>
	<1393456261449-7585837.post@n2.nabble.com>
Message-ID: <1393474560376-7585840.post@n2.nabble.com>

Thank you for reply 

Could you please tell me how I can convert then to NDVI ratio ?




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585840.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ndcNS at hampshire.edu  Thu Feb 27 07:28:12 2014
From: ndcNS at hampshire.edu (Noah D. Charney)
Date: Thu, 27 Feb 2014 01:28:12 -0500
Subject: [R-sig-Geo] dismo:maxent() outputformat issue
Message-ID: <CAEogV+TstCqSVq-Z0Sogn9ru5a98TaTOZYfqZNxxsEFj1CecFA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/6db404f1/attachment.pl>

From tech_dev at wildintellect.com  Thu Feb 27 08:14:54 2014
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Wed, 26 Feb 2014 23:14:54 -0800
Subject: [R-sig-Geo] longitude, latitude, and heat value
In-Reply-To: <CAJnbHtKz-fi=HqDsoOrtWsBpAQvpBs_b9z8yi5EWVzuY3cu4NQ@mail.gmail.com>
References: <CAJnbHtKz-fi=HqDsoOrtWsBpAQvpBs_b9z8yi5EWVzuY3cu4NQ@mail.gmail.com>
Message-ID: <530EE5EE.3070100@wildintellect.com>

gstat

In general this is called interpolation, where you create a raster based
on known point values that is a continuous surface. Once you generate
the surface you can plot it applying an appropriate color ramp.

There are many types of interpolation, start with IDW as it's easiest to
understand. Depending on the distribution of your points you may need to
move onto more advanced algorithms.

Outside of R this can also be done easily with SAGA, GRASS, or QGIS.

Enjoy,
Alex

On 02/26/2014 05:50 PM, william claster wrote:
> I am resending this, since I did not confirm my subscription before mailing
> it before:
> 
> Hi. I have data like that below. In particular I have Latitude, Longitude,
> and Value. I want to make a "heat map" of this data. The data points are in
> Japan and I want to have a map of Japan and then a color overlay of the
> Value variable as the heat. Can anyone suggest a package and an "easy" way
> to do this?
> Thanks!
> 
> 
> 
> 
> 
>          X       Captured.Time Latitude Longitude Value Unit Location.Name
> 1 12696963 2012-08-07 11:00:51 39.16094  140.4883    45  cpm
> 2  2056198 2013-11-10 03:14:19 32.84428 -117.2240    47  cpm
> 3   727957 2014-01-28 04:47:54 35.80605  139.3789    28  cpm
> 4  2864220 2013-10-22 19:41:53 35.07816 -106.6123    50  cpm
> 5  5787688 2013-06-13 04:13:57 35.83174  136.2027    35  cpm
> 6  6191345 2013-05-28 06:48:34 34.78944  137.9496    32  cpm
>   Device.ID                           MD5Sum Height Surface Radiation
> 1        NA b0465019b46289b82450c39ce1397b98     NA                NA
> 2        NA 8fa14a1227d23e6cf286785e8843cc39     NA                NA
> 3        NA c72cd7f9cedd59cf6e6892049dfbf9a0     NA                NA
> 4        NA aca82e39ff9098e45eea04f661f68dc7     NA                NA
> 5        NA cc9394e6dceb91f0e0de97cc2db57e19     NA                NA
> 6        NA f18d194a41e1448c7776dbeba8b351af     NA                NA
>                Uploaded.Time Loader.ID
> 1  2012-08-13 19:16:10.18555     10832
> 2 2013-12-05 01:47:24.154971     13958
> 3 2014-01-29 22:55:39.138043     14451
> 4 2013-10-26 13:50:17.629869     13743
> 5 2013-06-16 16:17:21.148239     12930
> 6 2013-06-04 23:31:55.455323     12841
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Thu Feb 27 08:33:51 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 27 Feb 2014 08:33:51 +0100
Subject: [R-sig-Geo] strange trouble with writeOGR call
In-Reply-To: <530EB5CF.1070202@nmsu.edu>
References: <530EB5CF.1070202@nmsu.edu>
Message-ID: <530EEA5F.6030302@uni-muenster.de>

The first thing I would try is let the application print the complete
file name (path+file) where it wants to create a layer, and then verify
by hand that under the permissions of the application you can actually
do this (you have write permission, there is disk space).

On 02/27/2014 04:49 AM, Cynthia Hart wrote:
> I am working on an application that uses 'Shiny'; which allows for
> basically running R through a web browser.  My application is tested on
> my Windows laptop then ported to a Linux server.   My application
> analyzes spatial data, and uses the rgdal library.
> 
> I am getting s strange error from writeOGR from a recent version of my
> application, and I don't understand why, as the error did not occur
> before on either platform, and the changes should not have effected the
> call to write.
> 
> 'Error:  Layer Creation failed'
> 
> is the error I am getting.  Which seems to imply a permissions problem,
> but I've analyzed that angle to death, and I cannot see a problem (I
> even saved a temporary variable to disk right before the writeOGR call,
> to the same intended directory, and that works fine).   Is there some
> other cause for this error, some other possible problem I should be
> looking for?  Thanks!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/5089dffd/attachment.bin>

From Roger.Bivand at nhh.no  Thu Feb 27 09:02:32 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 27 Feb 2014 09:02:32 +0100
Subject: [R-sig-Geo] strange trouble with writeOGR call
In-Reply-To: <530EEA5F.6030302@uni-muenster.de>
References: <530EB5CF.1070202@nmsu.edu> <530EEA5F.6030302@uni-muenster.de>
Message-ID: <alpine.LRH.2.03.1402270844080.15575@reclus.nhh.no>

On Thu, 27 Feb 2014, Edzer Pebesma wrote:

> The first thing I would try is let the application print the complete
> file name (path+file) where it wants to create a layer, and then verify
> by hand that under the permissions of the application you can actually
> do this (you have write permission, there is disk space).

The test is:

library(rgdal)
td <- tempdir()
cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")
writeOGR(cities, td, "cities", driver="ESRI Shapefile") # works first time
writeOGR(cities, td, "cities", driver="ESRI Shapefile") #fails with
#layer exists, use a new layer name (not this case - overwriting can
#be done using the appropriate argument)
td <- "<a directory to which I do not have write permissions>"
writeOGR(cities, td, "cities", driver="ESRI Shapefile")
#Layer creation failed, error message from within GDAL/OGR

So follow Edzer's advice and determine where Shiny is trying to write 
stuff, inserting:

print(file.info(td)[c("mode", "uname")])

where td is your dsn= argument. For my failing case I see 755 and root, if 
I do the same on R's tempdir:

td <- tempdir()

I see 700 and my user name, so R is giving me (alone) full writes (read 4, 
write 2, and execute 1 to the directory).

I suspect that Shiny is not putting things where you think on the server. 
Indeed, it may well be trying to behave in a secure way on the server, by 
locking down permissions - I would certainly do this on any service facing 
the internet. If in doubt, create a small reproducible example and send it 
to the Shiny people or ask wherever they accept questions.

Roger

>
> On 02/27/2014 04:49 AM, Cynthia Hart wrote:
>> I am working on an application that uses 'Shiny'; which allows for
>> basically running R through a web browser.  My application is tested on
>> my Windows laptop then ported to a Linux server.   My application
>> analyzes spatial data, and uses the rgdal library.
>>
>> I am getting s strange error from writeOGR from a recent version of my
>> application, and I don't understand why, as the error did not occur
>> before on either platform, and the changes should not have effected the
>> call to write.
>>
>> 'Error:  Layer Creation failed'
>>
>> is the error I am getting.  Which seems to imply a permissions problem,
>> but I've analyzed that angle to death, and I cannot see a problem (I
>> even saved a temporary variable to disk right before the writeOGR call,
>> to the same intended directory, and that works fine).   Is there some
>> other cause for this error, some other possible problem I should be
>> looking for?  Thanks!
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From wclaster at apu.ac.jp  Thu Feb 27 09:23:40 2014
From: wclaster at apu.ac.jp (william claster)
Date: Thu, 27 Feb 2014 21:23:40 +1300
Subject: [R-sig-Geo] longitude, latitude, and heat value
In-Reply-To: <530EE5EE.3070100@wildintellect.com>
References: <CAJnbHtKz-fi=HqDsoOrtWsBpAQvpBs_b9z8yi5EWVzuY3cu4NQ@mail.gmail.com>
	<530EE5EE.3070100@wildintellect.com>
Message-ID: <CAJnbHtJgHOR2NOatL8B3aQmOcnsHoBGsyGSnLsSWNZqgmGzocQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/d3a0318d/attachment.pl>

From pauloeducardoso at gmail.com  Thu Feb 27 10:06:02 2014
From: pauloeducardoso at gmail.com (pecardoso)
Date: Thu, 27 Feb 2014 01:06:02 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <1393474560376-7585840.post@n2.nabble.com>
References: <1393300433872-7585826.post@n2.nabble.com>
	<1393456261449-7585837.post@n2.nabble.com>
	<1393474560376-7585840.post@n2.nabble.com>
Message-ID: <1393491962427-7585846.post@n2.nabble.com>

Hi.
MOD13A1 uses a scaling factor = 10000. To get the [-1, 1] range just divide
the raster by 10000. The same apply to EVI vegetation index.
It is described elsewhere but a brief explanation can be found  here
<http://nrm.salrm.uaf.edu/~dverbyla/MODIS_Land_Products/pdf_documents/users_guides/mod13_veg_indices-16_day_500m.pdf>  

All the best!



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585846.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From upimple at gmail.com  Thu Feb 27 10:23:03 2014
From: upimple at gmail.com (Uday)
Date: Thu, 27 Feb 2014 01:23:03 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <1393491962427-7585846.post@n2.nabble.com>
References: <1393300433872-7585826.post@n2.nabble.com>
	<1393456261449-7585837.post@n2.nabble.com>
	<1393474560376-7585840.post@n2.nabble.com>
	<1393491962427-7585846.post@n2.nabble.com>
Message-ID: <1393492983444-7585847.post@n2.nabble.com>

Hello Pecardoso, 

Thank you for reply 
Scaling factor is absolutely perfect solution  

but I found that it can be done using package "tiff"

library(tiff)
out <- readTIFF("mosaic_test.500m_16_days_NDVI.tif",convert=TRUE)
class(out)
[1] "matrix"

But the min and max values are more precise using scaling factor 





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585847.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From pauloeducardoso at gmail.com  Thu Feb 27 10:29:59 2014
From: pauloeducardoso at gmail.com (pecardoso)
Date: Thu, 27 Feb 2014 01:29:59 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <1393492983444-7585847.post@n2.nabble.com>
References: <1393300433872-7585826.post@n2.nabble.com>
	<1393456261449-7585837.post@n2.nabble.com>
	<1393474560376-7585840.post@n2.nabble.com>
	<1393491962427-7585846.post@n2.nabble.com>
	<1393492983444-7585847.post@n2.nabble.com>
Message-ID: <CAF7LwDZWoy8NtJBnJzZ6Ea=WPA3ei23pbqLgz2cbyrFA0a8EMA@mail.gmail.com>

Can't you use package raster? and operate on rasterLayers?
Paulo Eduardo Cardoso



2014-02-27 9:23 GMT+00:00 Uday [via R-sig-geo]
<ml-node+s2731867n7585847h61 at n2.nabble.com>:
> Hello Pecardoso,
>
> Thank you for reply
> Scaling factor is absolutely perfect solution
>
> but I found that it can be done using package "tiff"
>
> library(tiff)
> out <- readTIFF("mosaic_test.500m_16_days_NDVI.tif",convert=TRUE)
> class(out)
> [1] "matrix"
>
> But the min and max values are more precise using scaling factor
>
>
>
> ________________________________
> If you reply to this email, your message will be added to the discussion
> below:
> http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585847.html
> To unsubscribe from MODIS data NDVI values, click here.
> NAML




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585848.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From upimple at gmail.com  Thu Feb 27 10:37:28 2014
From: upimple at gmail.com (Uday)
Date: Thu, 27 Feb 2014 01:37:28 -0800 (PST)
Subject: [R-sig-Geo] MODIS data NDVI values
In-Reply-To: <CAF7LwDZWoy8NtJBnJzZ6Ea=WPA3ei23pbqLgz2cbyrFA0a8EMA@mail.gmail.com>
References: <1393300433872-7585826.post@n2.nabble.com>
	<1393456261449-7585837.post@n2.nabble.com>
	<1393474560376-7585840.post@n2.nabble.com>
	<1393491962427-7585846.post@n2.nabble.com>
	<1393492983444-7585847.post@n2.nabble.com>
	<CAF7LwDZWoy8NtJBnJzZ6Ea=WPA3ei23pbqLgz2cbyrFA0a8EMA@mail.gmail.com>
Message-ID: <1393493848813-7585849.post@n2.nabble.com>

I will use package raster 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/MODIS-data-NDVI-values-tp7585826p7585849.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From javier.martinez at um.es  Thu Feb 27 11:24:03 2014
From: javier.martinez at um.es (Javier =?utf-8?b?TWFydMOtbmV6IA==?= =?utf-8?b?TMOzcGV6?=)
Date: Thu, 27 Feb 2014 11:24:03 +0100
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
	<alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
Message-ID: <20140227112403.31684c5muvzcff43@webmail.atica.um.es>

Dear Roger,

your help is very much appreciated! When I try to locate libpython2.7  
is does not come up, but the file is present in my $HOME/anaconda/lib.  
Systemwide only python 2.6 is present due to a conflict with 2.7 in  
CentOS.

I tried something like:

R CMD INSTALL rPython_0.0-4.tar.gz  
--configure-args='LD_LIBRARY_PATH=/home/majavie/anaconda/lib/'

and

R CMD INSTALL rPython_0.0-4.tar.gz  
--configure-args='PYTHONLIBFILE=/home/majavie/anaconda/lib/libpython2.7.so'

but still getting the same error, and when try:

export LD_LIBRARY_PATH=/home/majavie/anaconda/lib/:$PATH

then I cannot even start R!... so, I might try to install a local  
version of R from source, just to try if this one works!

Thank you again and cheers,

Javier




Quoting Roger Bivand <Roger.Bivand at nhh.no>:

> On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:
>
>> Hello all,
>>
>> I need to combine R and Python to process large raster files and I  
>> would like to use the "rPython" library for direct transformation  
>> of the data objects created using those environments. However, when  
>> I try to install it, it produces the following error related to the  
>> python libraries (see below). I just installed the Anaconda python  
>> distribution locally (no admin rights) in my home folder (Linux  
>> CentOS), which might be causing the problem, but I do not know how  
>> to deal with this issue, so any help is welcome!
>
> This is not a specific question for this list, but there may be  
> interest in this fresh and as yet unproven package. What does:
>
> locate libpython2.7
>
> say on your system? On current Fedora, I see:
>
> /usr/lib64/libpython2.7.so
>
> with:
>
> $ python --version
> Python 2.7.5
>
> as per the advice in:
>
> http://cran.r-project.org/web/packages/rPython/INSTALL
>
> Your system should provide python, but may have only the python, not  
> both that and the python-devel RPMs installed. If you have installed  
> libpython2.7.so locally, you may need to adjust your LD_LIBRARY_PATH  
> so that the library is visible. If you can get your sysadmin to add  
> the python-devel RPM, life may be easier. Also, write to the package  
> maintainer suggesting that libpython be checked in configure.
>
> Hope this helps,
>
> Roger
>
>>
>> Thank you very much and cheers,
>>
>> Javier
>>
>>> install.packages('rPython')
>> Installing package into /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
>> (as lib is unspecified)
>> trying URL  
>> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
>> Content type 'text/plain' length 37034 bytes (36 Kb)
>> opened URL
>> ==================================================
>> downloaded 36 Kb
>>
>> * installing *source* package rPython ...
>> ** package rPython successfully unpacked and MD5 sums checked
>> a specific python version to use was not provided
>> defaulting to the standard python in the system
>> checking for gcc... gcc -m64 -std=gnu99
>> checking whether the C compiler works... yes
>> checking for C compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... no
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -m64 -std=gnu99 accepts -g... yes
>> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none needed
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
>> -I/home/majavie/anaconda/include/python2.7
>> -I/home/majavie/anaconda/include/python2.7 -D
>> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
>> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
>> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
>> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
>> -L/usr/lib64/R/lib -lR
>> /usr/bin/ld: cannot find -lpython2.7
>> collect2: ld returned 1 exit status
>> make: *** [rPython.so] Error 1
>> ERROR: compilation failed for package rPython
>> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>> * restoring previous  
>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>
>> The downloaded source packages are in
>>  /tmp/RtmpfPBtPF/downloaded_packages
>> Warning message:
>> In install.packages("rPython") :
>> installation of package rPython had non-zero exit status
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>



-- 
Javier Mart?nez-L?pez
Ecology and Hydrology Department
Biology Faculty
University of Murcia
Espinardo E-30100
Murcia - Spain

E-mail: javier.martinez at um.es
web: http://webs.um.es/javier.martinez


From b.rowlingson at lancaster.ac.uk  Thu Feb 27 11:47:25 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 27 Feb 2014 10:47:25 +0000
Subject: [R-sig-Geo] longitude, latitude, and heat value
In-Reply-To: <0bcea633c1574d9287ceca9d3a9bab70@EX-0-HT0.lancs.local>
References: <CAJnbHtKz-fi=HqDsoOrtWsBpAQvpBs_b9z8yi5EWVzuY3cu4NQ@mail.gmail.com>
	<530EE5EE.3070100@wildintellect.com>
	<0bcea633c1574d9287ceca9d3a9bab70@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMnhH0xdJL4CYQPj0-d9e_OY0ZqxJYPeZ6LzdVKShmxeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/b77682bb/attachment.pl>

From Alexander.Sommer at tu-dortmund.de  Thu Feb 27 12:18:21 2014
From: Alexander.Sommer at tu-dortmund.de (Alexander Sommer)
Date: Thu, 27 Feb 2014 12:18:21 +0100
Subject: [R-sig-Geo] Scaling the scale bar
Message-ID: <000001cf33ad$a2e35540$e8a9ffc0$@Sommer@tu-dortmund.de>

Dear list members,

I have got the feeling, that I missed something substantial about /layout.scale.bar/.

For example (not a pretty one, but might clarify my point)

> URL      <- "http://www.geodatenzentrum.de/auftrag1/archiv/vektor/vg250_ebenen/2012/vg250_2012-01-01.utm32s.shape.ebenen.zip"
> td       <- tempdir()
> setwd(td)
> temp     <- tempfile(fileext = ".zip")
> download.file(URL, temp)
> unzip(temp)
> dir_temp <- paste(tempdir(),
+                   "\\vg250_0101.utm32s.shape.ebenen",
+                   "\\vg250_ebenen",
+                   sep = "")
> 
> require(rgdal)
> States <- readOGR(dsn      = dir_temp,
+                   layer    = "vg250_bld",
+                   encoding = "UTF8")
> Scale  <- list("SpatialPolygonsRescale",
+           layout.scale.bar(),
+           offset = c(mean(States at bbox[1, ]), mean(States at bbox[2, ])),
+           scale  = 0.1 * mean(States at bbox),
+           fill   = c("white", "black"))
> 
> spplot(States, "GEN", sp.layout = Scale)

draws a map of Germany?s States. Now, I would like to change the scale bar, so that it shows a distance of 100 kilometers. How can I assure that the length of the scale bar on the map corresponds with 100 kilometers in reality? (It might be too obvious or some other reason I do not get it. It feels already like the dumbest question to myself. So, my apologies in advance.)

Cheers,

Alex


-- 
Alexander Sommer
Forschungsverbund Deutsches Jugendinstitut/Technische Universit?t Dortmund


From virgilio.gomez at uclm.es  Thu Feb 27 12:34:22 2014
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Thu, 27 Feb 2014 12:34:22 +0100
Subject: [R-sig-Geo] R Project in Google Summer of Code 2014
Message-ID: <1393500862.4358.20.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Dear list members,

This e-mail is to let you know that the R Project has been accepted as a
participating organisation for Google Summer of Code 2014. This is an
initiative by Google and it funds students for a few months in the
summer time to develop open source software. You can find more
information here:

http://www.google-melange.com/gsoc/homepage/google/gsoc2014

The R Project has participated in the last years and will do this year
as well. The page to propose projects for students is

http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2014

There is an R specific mailing list (where you can discuss ideas for
proposals) here:

https://groups.google.com/forum/#!forum/gsoc-r


Best wishes,


-- 
Virgilio G?mez Rubio
Departamento de Matem?ticas
Escuela de Ingenieros Industriales - Albacete
Avda. Espa?a s/n - 02071 Albacete - SPAIN
Tlf: (+34) 967 59 92 00 ext. 8291


From edzer.pebesma at uni-muenster.de  Thu Feb 27 15:38:28 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 27 Feb 2014 15:38:28 +0100
Subject: [R-sig-Geo] Scaling the scale bar
In-Reply-To: <000001cf33ad$a2e35540$e8a9ffc0$@Sommer@tu-dortmund.de>
References: <000001cf33ad$a2e35540$e8a9ffc0$@Sommer@tu-dortmund.de>
Message-ID: <530F4DE4.40900@uni-muenster.de>

Alex, thanks for the reproducible example -- please try:

 bb = bbox(States)
 Scale  <- list("SpatialPolygonsRescale",
           layout.scale.bar(),
           offset = c(bb[1,1] + 20000, bb[2,1] + 20000),
           scale  = 100000,
           fill   = c("white", "black"))
 l4 = list("sp.text", c(bb[1,1] + 20000, bb[2,1] + 10000), "0")
 l5 = list("sp.text", c(bb[1,1] + 120000, bb[2,1] + 10000), "100 km")
 spplot(States, "GEN", sp.layout = list(Scale, l4, l5))

For the next time, send a clean script (without the > and + in it), and
remember that as path separator "\\" only works on some operating
systems, "/" on all (I believe).

On 02/27/2014 12:18 PM, Alexander Sommer wrote:
> Dear list members,
> 
> I have got the feeling, that I missed something substantial about /layout.scale.bar/.
> 
> For example (not a pretty one, but might clarify my point)
> 
>> URL      <- "http://www.geodatenzentrum.de/auftrag1/archiv/vektor/vg250_ebenen/2012/vg250_2012-01-01.utm32s.shape.ebenen.zip"
>> td       <- tempdir()
>> setwd(td)
>> temp     <- tempfile(fileext = ".zip")
>> download.file(URL, temp)
>> unzip(temp)
>> dir_temp <- paste(tempdir(),
> +                   "\\vg250_0101.utm32s.shape.ebenen",
> +                   "\\vg250_ebenen",
> +                   sep = "")
>>
>> require(rgdal)
>> States <- readOGR(dsn      = dir_temp,
> +                   layer    = "vg250_bld",
> +                   encoding = "UTF8")
>> Scale  <- list("SpatialPolygonsRescale",
> +           layout.scale.bar(),
> +           offset = c(mean(States at bbox[1, ]), mean(States at bbox[2, ])),
> +           scale  = 0.1 * mean(States at bbox),
> +           fill   = c("white", "black"))
>>
>> spplot(States, "GEN", sp.layout = Scale)
> 
> draws a map of Germany?s States. Now, I would like to change the scale bar, so that it shows a distance of 100 kilometers. How can I assure that the length of the scale bar on the map corresponds with 100 kilometers in reality? (It might be too obvious or some other reason I do not get it. It feels already like the dumbest question to myself. So, my apologies in advance.)
> 
> Cheers,
> 
> Alex
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/93c6f064/attachment.bin>

From jgrn at illinois.edu  Thu Feb 27 16:41:17 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 27 Feb 2014 09:41:17 -0600
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <20140227112403.31684c5muvzcff43@webmail.atica.um.es>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
	<alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
	<20140227112403.31684c5muvzcff43@webmail.atica.um.es>
Message-ID: <CABG0rftMjD3mf6YphPHG6mHJERU3Ok9J+i9PAiKKaUSzfCHtag@mail.gmail.com>

Javier:

If you don't mind me asking -- when you said "I need to combine R and
Python to process large raster files" is there a particular function
in python you need to apply to the rasters, or are you specifically
referring to some benefit in python of working with arbitrarily large
raster files?

--j

On Thu, Feb 27, 2014 at 4:24 AM, Javier Mart?nez L?pez
<javier.martinez at um.es> wrote:
> Dear Roger,
>
> your help is very much appreciated! When I try to locate libpython2.7 is
> does not come up, but the file is present in my $HOME/anaconda/lib.
> Systemwide only python 2.6 is present due to a conflict with 2.7 in CentOS.
>
> I tried something like:
>
> R CMD INSTALL rPython_0.0-4.tar.gz
> --configure-args='LD_LIBRARY_PATH=/home/majavie/anaconda/lib/'
>
> and
>
> R CMD INSTALL rPython_0.0-4.tar.gz
> --configure-args='PYTHONLIBFILE=/home/majavie/anaconda/lib/libpython2.7.so'
>
> but still getting the same error, and when try:
>
> export LD_LIBRARY_PATH=/home/majavie/anaconda/lib/:$PATH
>
> then I cannot even start R!... so, I might try to install a local version of
> R from source, just to try if this one works!
>
> Thank you again and cheers,
>
> Javier
>
>
>
>
>
> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
>
>> On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:
>>
>>> Hello all,
>>>
>>> I need to combine R and Python to process large raster files and I would
>>> like to use the "rPython" library for direct transformation of the data
>>> objects created using those environments. However, when I try to install it,
>>> it produces the following error related to the python libraries (see below).
>>> I just installed the Anaconda python distribution locally (no admin rights)
>>> in my home folder (Linux CentOS), which might be causing the problem, but I
>>> do not know how to deal with this issue, so any help is welcome!
>>
>>
>> This is not a specific question for this list, but there may be interest
>> in this fresh and as yet unproven package. What does:
>>
>> locate libpython2.7
>>
>> say on your system? On current Fedora, I see:
>>
>> /usr/lib64/libpython2.7.so
>>
>> with:
>>
>> $ python --version
>> Python 2.7.5
>>
>> as per the advice in:
>>
>> http://cran.r-project.org/web/packages/rPython/INSTALL
>>
>> Your system should provide python, but may have only the python, not both
>> that and the python-devel RPMs installed. If you have installed
>> libpython2.7.so locally, you may need to adjust your LD_LIBRARY_PATH so that
>> the library is visible. If you can get your sysadmin to add the python-devel
>> RPM, life may be easier. Also, write to the package maintainer suggesting
>> that libpython be checked in configure.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> Thank you very much and cheers,
>>>
>>> Javier
>>>
>>>> install.packages('rPython')
>>>
>>> Installing package into
>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
>>> (as lib is unspecified)
>>> trying URL
>>> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
>>> Content type 'text/plain' length 37034 bytes (36 Kb)
>>> opened URL
>>> ==================================================
>>> downloaded 36 Kb
>>>
>>> * installing *source* package rPython ...
>>> ** package rPython successfully unpacked and MD5 sums checked
>>> a specific python version to use was not provided
>>> defaulting to the standard python in the system
>>> checking for gcc... gcc -m64 -std=gnu99
>>> checking whether the C compiler works... yes
>>> checking for C compiler default output file name... a.out
>>> checking for suffix of executables...
>>> checking whether we are cross compiling... no
>>> checking for suffix of object files... o
>>> checking whether we are using the GNU C compiler... yes
>>> checking whether gcc -m64 -std=gnu99 accepts -g... yes
>>> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none needed
>>> configure: creating ./config.status
>>> config.status: creating src/Makevars
>>> ** libs
>>> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
>>> -I/home/majavie/anaconda/include/python2.7
>>> -I/home/majavie/anaconda/include/python2.7 -D
>>> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
>>> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>>> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
>>> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
>>> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
>>> -L/usr/lib64/R/lib -lR
>>> /usr/bin/ld: cannot find -lpython2.7
>>> collect2: ld returned 1 exit status
>>> make: *** [rPython.so] Error 1
>>> ERROR: compilation failed for package rPython
>>> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>> * restoring previous
>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>
>>> The downloaded source packages are in
>>>  /tmp/RtmpfPBtPF/downloaded_packages
>>> Warning message:
>>> In install.packages("rPython") :
>>> installation of package rPython had non-zero exit status
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>
>
> --
> Javier Mart?nez-L?pez
> Ecology and Hydrology Department
> Biology Faculty
> University of Murcia
> Espinardo E-30100
> Murcia - Spain
>
> E-mail: javier.martinez at um.es
> web: http://webs.um.es/javier.martinez
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From Alexander.Sommer at tu-dortmund.de  Thu Feb 27 16:55:13 2014
From: Alexander.Sommer at tu-dortmund.de (Alexander Sommer)
Date: Thu, 27 Feb 2014 16:55:13 +0100
Subject: [R-sig-Geo] Scaling the scale bar
Message-ID: <000301cf33d4$4ff7b1b0$efe71510$@Sommer@tu-dortmund.de>

Wow, that was a quick response. Thank you, Edzer!

My apologies for adding /+/ and />/ to the code, I was not sure how to mark R code as such and separate it from the rest of the text. And I always get puzzled which operating system accepts which separator. Thought Windows rejects slashes, but that turned out wrong. Sorry.

The code works just fine for that example, but my question was rather how do I know the scale? And how can I make sure it is the correct one? (In the example: How do I know it is 100000 and not something else? Is the bar really representing 100 km?) For example, when I run

 States <- spTransform(States, CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"))

after /readOGR/
 
 scale  = 100000

seems to be wrong. How can I find out the correct scale? In a perfect world I would like to have some formula like /Length, I like to represent ? Something from projection, bbox or whatever/. 

Once again, thanks for your help

Alex


-- 
Alexander Sommer
Forschungsverbund Deutsches Jugendinstitut/Technische Universit?t Dortmund


From javier.martinez at um.es  Thu Feb 27 18:55:32 2014
From: javier.martinez at um.es (Javier =?iso-8859-1?b?TWFydO1uZXog?= =?iso-8859-1?b?TPNwZXo=?=)
Date: Thu, 27 Feb 2014 18:55:32 +0100
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <CABG0rftMjD3mf6YphPHG6mHJERU3Ok9J+i9PAiKKaUSzfCHtag@mail.gmail.com>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
	<alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
	<20140227112403.31684c5muvzcff43@webmail.atica.um.es>
	<CABG0rftMjD3mf6YphPHG6mHJERU3Ok9J+i9PAiKKaUSzfCHtag@mail.gmail.com>
Message-ID: <20140227185532.429054fl2miyhhck@webmail.atica.um.es>

Dear Jonathan,

That is a nice question! I need to repetitively apply the Mahalanobis  
distance to a stack of eleven raster maps comprising very large areas  
in order to compare the similarity of different areas (see the  
eHabitat R library [1] which is used for the DOPA explorer [2]). I am  
just trying to speed up the processing by hosting the maps in GRASS  
GIS, using the Pygrass module for importing them as numpy arrays,  
using a parallel processing script for calculating the mahalanobis  
distance which also benefits from MKL enhancements, and eventually  
continue some processing in R, if I find a fast way, in combination  
with the existent eHabitat library, or directly producing the  
resulting tiff and csv files... Does it make sense to you at all? I  
plan to upload a first working version of the code to github [3] this  
or next week, as soon as I solve some errors.

Thank you for your interest!

Cheers,

Javier


[1](https://github.com/javimarlop/eHabitat)
[2](http://ehabitat-wps.jrc.ec.europa.eu/dopa_explorer/)
[3](https://github.com/javimarlop/eHab_grasspy)

Quoting Jonathan Greenberg <jgrn at illinois.edu>:

> Javier:
>
> If you don't mind me asking -- when you said "I need to combine R and
> Python to process large raster files" is there a particular function
> in python you need to apply to the rasters, or are you specifically
> referring to some benefit in python of working with arbitrarily large
> raster files?
>
> --j
>
> On Thu, Feb 27, 2014 at 4:24 AM, Javier Mart?nez L?pez
> <javier.martinez at um.es> wrote:
>> Dear Roger,
>>
>> your help is very much appreciated! When I try to locate libpython2.7 is
>> does not come up, but the file is present in my $HOME/anaconda/lib.
>> Systemwide only python 2.6 is present due to a conflict with 2.7 in CentOS.
>>
>> I tried something like:
>>
>> R CMD INSTALL rPython_0.0-4.tar.gz
>> --configure-args='LD_LIBRARY_PATH=/home/majavie/anaconda/lib/'
>>
>> and
>>
>> R CMD INSTALL rPython_0.0-4.tar.gz
>> --configure-args='PYTHONLIBFILE=/home/majavie/anaconda/lib/libpython2.7.so'
>>
>> but still getting the same error, and when try:
>>
>> export LD_LIBRARY_PATH=/home/majavie/anaconda/lib/:$PATH
>>
>> then I cannot even start R!... so, I might try to install a local version of
>> R from source, just to try if this one works!
>>
>> Thank you again and cheers,
>>
>> Javier
>>
>>
>>
>>
>>
>> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
>>
>>> On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:
>>>
>>>> Hello all,
>>>>
>>>> I need to combine R and Python to process large raster files and I would
>>>> like to use the "rPython" library for direct transformation of the data
>>>> objects created using those environments. However, when I try to  
>>>> install it,
>>>> it produces the following error related to the python libraries  
>>>> (see below).
>>>> I just installed the Anaconda python distribution locally (no  
>>>> admin rights)
>>>> in my home folder (Linux CentOS), which might be causing the  
>>>> problem, but I
>>>> do not know how to deal with this issue, so any help is welcome!
>>>
>>>
>>> This is not a specific question for this list, but there may be interest
>>> in this fresh and as yet unproven package. What does:
>>>
>>> locate libpython2.7
>>>
>>> say on your system? On current Fedora, I see:
>>>
>>> /usr/lib64/libpython2.7.so
>>>
>>> with:
>>>
>>> $ python --version
>>> Python 2.7.5
>>>
>>> as per the advice in:
>>>
>>> http://cran.r-project.org/web/packages/rPython/INSTALL
>>>
>>> Your system should provide python, but may have only the python, not both
>>> that and the python-devel RPMs installed. If you have installed
>>> libpython2.7.so locally, you may need to adjust your  
>>> LD_LIBRARY_PATH so that
>>> the library is visible. If you can get your sysadmin to add the  
>>> python-devel
>>> RPM, life may be easier. Also, write to the package maintainer suggesting
>>> that libpython be checked in configure.
>>>
>>> Hope this helps,
>>>
>>> Roger
>>>
>>>>
>>>> Thank you very much and cheers,
>>>>
>>>> Javier
>>>>
>>>>> install.packages('rPython')
>>>>
>>>> Installing package into
>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
>>>> (as lib is unspecified)
>>>> trying URL
>>>> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
>>>> Content type 'text/plain' length 37034 bytes (36 Kb)
>>>> opened URL
>>>> ==================================================
>>>> downloaded 36 Kb
>>>>
>>>> * installing *source* package rPython ...
>>>> ** package rPython successfully unpacked and MD5 sums checked
>>>> a specific python version to use was not provided
>>>> defaulting to the standard python in the system
>>>> checking for gcc... gcc -m64 -std=gnu99
>>>> checking whether the C compiler works... yes
>>>> checking for C compiler default output file name... a.out
>>>> checking for suffix of executables...
>>>> checking whether we are cross compiling... no
>>>> checking for suffix of object files... o
>>>> checking whether we are using the GNU C compiler... yes
>>>> checking whether gcc -m64 -std=gnu99 accepts -g... yes
>>>> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none needed
>>>> configure: creating ./config.status
>>>> config.status: creating src/Makevars
>>>> ** libs
>>>> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
>>>> -I/home/majavie/anaconda/include/python2.7
>>>> -I/home/majavie/anaconda/include/python2.7 -D
>>>> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
>>>> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>>>> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
>>>> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
>>>> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
>>>> -L/usr/lib64/R/lib -lR
>>>> /usr/bin/ld: cannot find -lpython2.7
>>>> collect2: ld returned 1 exit status
>>>> make: *** [rPython.so] Error 1
>>>> ERROR: compilation failed for package rPython
>>>> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>> * restoring previous
>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>>
>>>> The downloaded source packages are in
>>>>  /tmp/RtmpfPBtPF/downloaded_packages
>>>> Warning message:
>>>> In install.packages("rPython") :
>>>> installation of package rPython had non-zero exit status
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>
>>
>>
>> --
>> Javier Mart?nez-L?pez
>> Ecology and Hydrology Department
>> Biology Faculty
>> University of Murcia
>> Espinardo E-30100
>> Murcia - Spain
>>
>> E-mail: javier.martinez at um.es
>> web: http://webs.um.es/javier.martinez
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>



-- 
Javier Mart?nez-L?pez
Ecology and Hydrology Department
Biology Faculty
University of Murcia
Espinardo E-30100
Murcia - Spain

E-mail: javier.martinez at um.es
web: http://webs.um.es/javier.martinez


From bakare at ualberta.ca  Thu Feb 27 20:40:13 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Thu, 27 Feb 2014 12:40:13 -0700
Subject: [R-sig-Geo] Assess spatial pattern over year through variogram model
Message-ID: <CAJRR3XNwX3X18qCkC8QJ=RuSULu4z214uTDD15DzoLph-fg2HA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140227/1523950c/attachment.pl>

From jgrn at illinois.edu  Thu Feb 27 21:42:03 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 27 Feb 2014 14:42:03 -0600
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <20140227185532.429054fl2miyhhck@webmail.atica.um.es>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
	<alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
	<20140227112403.31684c5muvzcff43@webmail.atica.um.es>
	<CABG0rftMjD3mf6YphPHG6mHJERU3Ok9J+i9PAiKKaUSzfCHtag@mail.gmail.com>
	<20140227185532.429054fl2miyhhck@webmail.atica.um.es>
Message-ID: <CABG0rfuvi8+0y5QTmppDgxTb-RQGFj3bYb9A1CgFCdLRfbRZaw@mail.gmail.com>

Javier:

I guess my first suggestion is to try out my rasterEngine function in
the spatial.tools package -- it is designed to perform parallel
processing of raster images entirely within R.  I have a tutorial
here:

http://www.geog.illinois.edu/~jgrn/software-and-datasets/rasterengine-tutorial/

You might want to look at the more complex randomForest example.  I
have a bunch of updates to rasterEngine that haven't made it into the
tutorial yet, that might also be useful, including having > 1 output
file.  The help for rasterEngine has some of these updates.

Let me know how it goes!

--j

On Thu, Feb 27, 2014 at 11:55 AM, Javier Mart?nez L?pez
<javier.martinez at um.es> wrote:
> Dear Jonathan,
>
> That is a nice question! I need to repetitively apply the Mahalanobis
> distance to a stack of eleven raster maps comprising very large areas in
> order to compare the similarity of different areas (see the eHabitat R
> library [1] which is used for the DOPA explorer [2]). I am just trying to
> speed up the processing by hosting the maps in GRASS GIS, using the Pygrass
> module for importing them as numpy arrays, using a parallel processing
> script for calculating the mahalanobis distance which also benefits from MKL
> enhancements, and eventually continue some processing in R, if I find a fast
> way, in combination with the existent eHabitat library, or directly
> producing the resulting tiff and csv files... Does it make sense to you at
> all? I plan to upload a first working version of the code to github [3] this
> or next week, as soon as I solve some errors.
>
> Thank you for your interest!
>
> Cheers,
>
> Javier
>
>
> [1](https://github.com/javimarlop/eHabitat)
> [2](http://ehabitat-wps.jrc.ec.europa.eu/dopa_explorer/)
> [3](https://github.com/javimarlop/eHab_grasspy)
>
>
> Quoting Jonathan Greenberg <jgrn at illinois.edu>:
>
>> Javier:
>>
>> If you don't mind me asking -- when you said "I need to combine R and
>> Python to process large raster files" is there a particular function
>> in python you need to apply to the rasters, or are you specifically
>> referring to some benefit in python of working with arbitrarily large
>> raster files?
>>
>> --j
>>
>> On Thu, Feb 27, 2014 at 4:24 AM, Javier Mart?nez L?pez
>> <javier.martinez at um.es> wrote:
>>>
>>> Dear Roger,
>>>
>>> your help is very much appreciated! When I try to locate libpython2.7 is
>>> does not come up, but the file is present in my $HOME/anaconda/lib.
>>> Systemwide only python 2.6 is present due to a conflict with 2.7 in
>>> CentOS.
>>>
>>> I tried something like:
>>>
>>> R CMD INSTALL rPython_0.0-4.tar.gz
>>> --configure-args='LD_LIBRARY_PATH=/home/majavie/anaconda/lib/'
>>>
>>> and
>>>
>>> R CMD INSTALL rPython_0.0-4.tar.gz
>>>
>>> --configure-args='PYTHONLIBFILE=/home/majavie/anaconda/lib/libpython2.7.so'
>>>
>>> but still getting the same error, and when try:
>>>
>>> export LD_LIBRARY_PATH=/home/majavie/anaconda/lib/:$PATH
>>>
>>> then I cannot even start R!... so, I might try to install a local version
>>> of
>>> R from source, just to try if this one works!
>>>
>>> Thank you again and cheers,
>>>
>>> Javier
>>>
>>>
>>>
>>>
>>>
>>> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
>>>
>>>> On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:
>>>>
>>>>> Hello all,
>>>>>
>>>>> I need to combine R and Python to process large raster files and I
>>>>> would
>>>>> like to use the "rPython" library for direct transformation of the data
>>>>> objects created using those environments. However, when I try to
>>>>> install it,
>>>>> it produces the following error related to the python libraries (see
>>>>> below).
>>>>> I just installed the Anaconda python distribution locally (no admin
>>>>> rights)
>>>>> in my home folder (Linux CentOS), which might be causing the problem,
>>>>> but I
>>>>> do not know how to deal with this issue, so any help is welcome!
>>>>
>>>>
>>>>
>>>> This is not a specific question for this list, but there may be interest
>>>> in this fresh and as yet unproven package. What does:
>>>>
>>>> locate libpython2.7
>>>>
>>>> say on your system? On current Fedora, I see:
>>>>
>>>> /usr/lib64/libpython2.7.so
>>>>
>>>> with:
>>>>
>>>> $ python --version
>>>> Python 2.7.5
>>>>
>>>> as per the advice in:
>>>>
>>>> http://cran.r-project.org/web/packages/rPython/INSTALL
>>>>
>>>> Your system should provide python, but may have only the python, not
>>>> both
>>>> that and the python-devel RPMs installed. If you have installed
>>>> libpython2.7.so locally, you may need to adjust your LD_LIBRARY_PATH so
>>>> that
>>>> the library is visible. If you can get your sysadmin to add the
>>>> python-devel
>>>> RPM, life may be easier. Also, write to the package maintainer
>>>> suggesting
>>>> that libpython be checked in configure.
>>>>
>>>> Hope this helps,
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> Thank you very much and cheers,
>>>>>
>>>>> Javier
>>>>>
>>>>>> install.packages('rPython')
>>>>>
>>>>>
>>>>> Installing package into
>>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
>>>>> (as lib is unspecified)
>>>>> trying URL
>>>>>
>>>>> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
>>>>> Content type 'text/plain' length 37034 bytes (36 Kb)
>>>>> opened URL
>>>>> ==================================================
>>>>> downloaded 36 Kb
>>>>>
>>>>> * installing *source* package rPython ...
>>>>> ** package rPython successfully unpacked and MD5 sums checked
>>>>> a specific python version to use was not provided
>>>>> defaulting to the standard python in the system
>>>>> checking for gcc... gcc -m64 -std=gnu99
>>>>> checking whether the C compiler works... yes
>>>>> checking for C compiler default output file name... a.out
>>>>> checking for suffix of executables...
>>>>> checking whether we are cross compiling... no
>>>>> checking for suffix of object files... o
>>>>> checking whether we are using the GNU C compiler... yes
>>>>> checking whether gcc -m64 -std=gnu99 accepts -g... yes
>>>>> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none
>>>>> needed
>>>>> configure: creating ./config.status
>>>>> config.status: creating src/Makevars
>>>>> ** libs
>>>>> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
>>>>> -I/home/majavie/anaconda/include/python2.7
>>>>> -I/home/majavie/anaconda/include/python2.7 -D
>>>>> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
>>>>> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>>>>> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
>>>>> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
>>>>> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
>>>>> -L/usr/lib64/R/lib -lR
>>>>> /usr/bin/ld: cannot find -lpython2.7
>>>>> collect2: ld returned 1 exit status
>>>>> make: *** [rPython.so] Error 1
>>>>> ERROR: compilation failed for package rPython
>>>>> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>>> * restoring previous
>>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>>>
>>>>> The downloaded source packages are in
>>>>>  /tmp/RtmpfPBtPF/downloaded_packages
>>>>> Warning message:
>>>>> In install.packages("rPython") :
>>>>> installation of package rPython had non-zero exit status
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>
>>>
>>>
>>> --
>>> Javier Mart?nez-L?pez
>>> Ecology and Hydrology Department
>>> Biology Faculty
>>> University of Murcia
>>> Espinardo E-30100
>>> Murcia - Spain
>>>
>>> E-mail: javier.martinez at um.es
>>> web: http://webs.um.es/javier.martinez
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>
>
>
> --
> Javier Mart?nez-L?pez
> Ecology and Hydrology Department
> Biology Faculty
> University of Murcia
> Espinardo E-30100
> Murcia - Spain
>
> E-mail: javier.martinez at um.es
> web: http://webs.um.es/javier.martinez
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From javier.martinez at um.es  Fri Feb 28 09:08:40 2014
From: javier.martinez at um.es (Javier =?iso-8859-1?b?TWFydO1uZXog?= =?iso-8859-1?b?TPNwZXo=?=)
Date: Fri, 28 Feb 2014 09:08:40 +0100
Subject: [R-sig-Geo] rPython installation problem
In-Reply-To: <CABG0rfuvi8+0y5QTmppDgxTb-RQGFj3bYb9A1CgFCdLRfbRZaw@mail.gmail.com>
References: <20140226184010.3499138j9gmvn01m@webmail.atica.um.es>
	<alpine.LRH.2.03.1402261851040.12297@reclus.nhh.no>
	<20140227112403.31684c5muvzcff43@webmail.atica.um.es>
	<CABG0rftMjD3mf6YphPHG6mHJERU3Ok9J+i9PAiKKaUSzfCHtag@mail.gmail.com>
	<20140227185532.429054fl2miyhhck@webmail.atica.um.es>
	<CABG0rfuvi8+0y5QTmppDgxTb-RQGFj3bYb9A1CgFCdLRfbRZaw@mail.gmail.com>
Message-ID: <20140228090840.29592fcsj83ld9u0@webmail.atica.um.es>

I will try it! Thanks! Cheers, Javier

Quoting Jonathan Greenberg <jgrn at illinois.edu>:

> Javier:
>
> I guess my first suggestion is to try out my rasterEngine function in
> the spatial.tools package -- it is designed to perform parallel
> processing of raster images entirely within R.  I have a tutorial
> here:
>
> http://www.geog.illinois.edu/~jgrn/software-and-datasets/rasterengine-tutorial/
>
> You might want to look at the more complex randomForest example.  I
> have a bunch of updates to rasterEngine that haven't made it into the
> tutorial yet, that might also be useful, including having > 1 output
> file.  The help for rasterEngine has some of these updates.
>
> Let me know how it goes!
>
> --j
>
> On Thu, Feb 27, 2014 at 11:55 AM, Javier Mart?nez L?pez
> <javier.martinez at um.es> wrote:
>> Dear Jonathan,
>>
>> That is a nice question! I need to repetitively apply the Mahalanobis
>> distance to a stack of eleven raster maps comprising very large areas in
>> order to compare the similarity of different areas (see the eHabitat R
>> library [1] which is used for the DOPA explorer [2]). I am just trying to
>> speed up the processing by hosting the maps in GRASS GIS, using the Pygrass
>> module for importing them as numpy arrays, using a parallel processing
>> script for calculating the mahalanobis distance which also benefits from MKL
>> enhancements, and eventually continue some processing in R, if I find a fast
>> way, in combination with the existent eHabitat library, or directly
>> producing the resulting tiff and csv files... Does it make sense to you at
>> all? I plan to upload a first working version of the code to github [3] this
>> or next week, as soon as I solve some errors.
>>
>> Thank you for your interest!
>>
>> Cheers,
>>
>> Javier
>>
>>
>> [1](https://github.com/javimarlop/eHabitat)
>> [2](http://ehabitat-wps.jrc.ec.europa.eu/dopa_explorer/)
>> [3](https://github.com/javimarlop/eHab_grasspy)
>>
>>
>> Quoting Jonathan Greenberg <jgrn at illinois.edu>:
>>
>>> Javier:
>>>
>>> If you don't mind me asking -- when you said "I need to combine R and
>>> Python to process large raster files" is there a particular function
>>> in python you need to apply to the rasters, or are you specifically
>>> referring to some benefit in python of working with arbitrarily large
>>> raster files?
>>>
>>> --j
>>>
>>> On Thu, Feb 27, 2014 at 4:24 AM, Javier Mart?nez L?pez
>>> <javier.martinez at um.es> wrote:
>>>>
>>>> Dear Roger,
>>>>
>>>> your help is very much appreciated! When I try to locate libpython2.7 is
>>>> does not come up, but the file is present in my $HOME/anaconda/lib.
>>>> Systemwide only python 2.6 is present due to a conflict with 2.7 in
>>>> CentOS.
>>>>
>>>> I tried something like:
>>>>
>>>> R CMD INSTALL rPython_0.0-4.tar.gz
>>>> --configure-args='LD_LIBRARY_PATH=/home/majavie/anaconda/lib/'
>>>>
>>>> and
>>>>
>>>> R CMD INSTALL rPython_0.0-4.tar.gz
>>>>
>>>> --configure-args='PYTHONLIBFILE=/home/majavie/anaconda/lib/libpython2.7.so'
>>>>
>>>> but still getting the same error, and when try:
>>>>
>>>> export LD_LIBRARY_PATH=/home/majavie/anaconda/lib/:$PATH
>>>>
>>>> then I cannot even start R!... so, I might try to install a local version
>>>> of
>>>> R from source, just to try if this one works!
>>>>
>>>> Thank you again and cheers,
>>>>
>>>> Javier
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
>>>>
>>>>> On Wed, 26 Feb 2014, Javier Mart?nez L?pez wrote:
>>>>>
>>>>>> Hello all,
>>>>>>
>>>>>> I need to combine R and Python to process large raster files and I
>>>>>> would
>>>>>> like to use the "rPython" library for direct transformation of the data
>>>>>> objects created using those environments. However, when I try to
>>>>>> install it,
>>>>>> it produces the following error related to the python libraries (see
>>>>>> below).
>>>>>> I just installed the Anaconda python distribution locally (no admin
>>>>>> rights)
>>>>>> in my home folder (Linux CentOS), which might be causing the problem,
>>>>>> but I
>>>>>> do not know how to deal with this issue, so any help is welcome!
>>>>>
>>>>>
>>>>>
>>>>> This is not a specific question for this list, but there may be interest
>>>>> in this fresh and as yet unproven package. What does:
>>>>>
>>>>> locate libpython2.7
>>>>>
>>>>> say on your system? On current Fedora, I see:
>>>>>
>>>>> /usr/lib64/libpython2.7.so
>>>>>
>>>>> with:
>>>>>
>>>>> $ python --version
>>>>> Python 2.7.5
>>>>>
>>>>> as per the advice in:
>>>>>
>>>>> http://cran.r-project.org/web/packages/rPython/INSTALL
>>>>>
>>>>> Your system should provide python, but may have only the python, not
>>>>> both
>>>>> that and the python-devel RPMs installed. If you have installed
>>>>> libpython2.7.so locally, you may need to adjust your LD_LIBRARY_PATH so
>>>>> that
>>>>> the library is visible. If you can get your sysadmin to add the
>>>>> python-devel
>>>>> RPM, life may be easier. Also, write to the package maintainer
>>>>> suggesting
>>>>> that libpython be checked in configure.
>>>>>
>>>>> Hope this helps,
>>>>>
>>>>> Roger
>>>>>
>>>>>>
>>>>>> Thank you very much and cheers,
>>>>>>
>>>>>> Javier
>>>>>>
>>>>>>> install.packages('rPython')
>>>>>>
>>>>>>
>>>>>> Installing package into
>>>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0
>>>>>> (as lib is unspecified)
>>>>>> trying URL
>>>>>>
>>>>>> 'http://cran.mirror.garr.it/mirrors/CRAN/src/contrib/rPython_0.0-4.tar.gz'
>>>>>> Content type 'text/plain' length 37034 bytes (36 Kb)
>>>>>> opened URL
>>>>>> ==================================================
>>>>>> downloaded 36 Kb
>>>>>>
>>>>>> * installing *source* package rPython ...
>>>>>> ** package rPython successfully unpacked and MD5 sums checked
>>>>>> a specific python version to use was not provided
>>>>>> defaulting to the standard python in the system
>>>>>> checking for gcc... gcc -m64 -std=gnu99
>>>>>> checking whether the C compiler works... yes
>>>>>> checking for C compiler default output file name... a.out
>>>>>> checking for suffix of executables...
>>>>>> checking whether we are cross compiling... no
>>>>>> checking for suffix of object files... o
>>>>>> checking whether we are using the GNU C compiler... yes
>>>>>> checking whether gcc -m64 -std=gnu99 accepts -g... yes
>>>>>> checking for gcc -m64 -std=gnu99 option to accept ISO C89... none
>>>>>> needed
>>>>>> configure: creating ./config.status
>>>>>> config.status: creating src/Makevars
>>>>>> ** libs
>>>>>> gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include
>>>>>> -I/home/majavie/anaconda/include/python2.7
>>>>>> -I/home/majavie/anaconda/include/python2.7 -D
>>>>>> PYTHONLIBFILE=libpython2.7.so -fpic  -O2 -g -pipe -Wall
>>>>>> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>>>>>> --param=ssp-buffer-size=4 -m64 -mtune=generic  -c pycall.c -o pycall.o
>>>>>> gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o rPython.so pycall.o
>>>>>> -lpthread -ldl -lutil -lm -lpython2.7 -Xlinker -export-dynamic
>>>>>> -L/usr/lib64/R/lib -lR
>>>>>> /usr/bin/ld: cannot find -lpython2.7
>>>>>> collect2: ld returned 1 exit status
>>>>>> make: *** [rPython.so] Error 1
>>>>>> ERROR: compilation failed for package rPython
>>>>>> * removing /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>>>> * restoring previous
>>>>>> /home/majavie/R/x86_64-redhat-linux-gnu-library/3.0/rPython
>>>>>>
>>>>>> The downloaded source packages are in
>>>>>>  /tmp/RtmpfPBtPF/downloaded_packages
>>>>>> Warning message:
>>>>>> In install.packages("rPython") :
>>>>>> installation of package rPython had non-zero exit status
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Javier Mart?nez-L?pez
>>>> Ecology and Hydrology Department
>>>> Biology Faculty
>>>> University of Murcia
>>>> Espinardo E-30100
>>>> Murcia - Spain
>>>>
>>>> E-mail: javier.martinez at um.es
>>>> web: http://webs.um.es/javier.martinez
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>
>>
>>
>> --
>> Javier Mart?nez-L?pez
>> Ecology and Hydrology Department
>> Biology Faculty
>> University of Murcia
>> Espinardo E-30100
>> Murcia - Spain
>>
>> E-mail: javier.martinez at um.es
>> web: http://webs.um.es/javier.martinez
>>
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>



-- 
Javier Mart?nez-L?pez
Ecology and Hydrology Department
Biology Faculty
University of Murcia
Espinardo E-30100
Murcia - Spain

E-mail: javier.martinez at um.es
web: http://webs.um.es/javier.martinez


From patrick.meyfroidt at uclouvain.be  Fri Feb 28 15:07:34 2014
From: patrick.meyfroidt at uclouvain.be (Patrick Meyfroidt)
Date: Fri, 28 Feb 2014 14:07:34 +0000
Subject: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum
 Likelihood
In-Reply-To: <alpine.LRH.2.03.1402251505510.29426@reclus.nhh.no>
References: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>,
	<alpine.LRH.2.03.1402251505510.29426@reclus.nhh.no>
Message-ID: <7a5aa9a714744c3fbff08e9b71b95622@ucl-mbx04.OASIS.UCLOUVAIN.BE>

Thanks Roger, and sorry. 

My code and data are a bit long to put here, but thanks to Caleb Gallemore which had a similar problem, I can post here a test code that he made for students, which uses data from Ecdat package. 

This code below, as well as my code, were tested with:
R 2.15.1 and splm_1.1-0 (the current stable version)
and R 3.0.2 and splm_1.2-0 (the development version)

I hope that this addresses your rightful concerns,

Now, if anyone has a suggestion (other than moving to Matlab..), that would be very welcome? 

Patrick 


# CODE OF REPRODUCIBLE EXAMPLE:
#-------------------------------------------------------------------------------

#FOR THIS LAB, WE WILL BE USING A BUILT-IN DATA PACKAGE IN R.  WE'RE GOING TO BE 
#ADHERING PRETTY CLOSELY TO THE APPROACH USED IN THE ARTICLE ON SPATIAL PANEL MODELS
#YOU LOOKED AT FOR CLASS.
install.packages("Ecdat") #THIS IS WHERE THE DATA ARE FOUND.
library(Ecdat)
install.packages("plm") #THIS IS THE PANEL MODEL PACKAGE
library(plm)
 
#THE DATA WE WILL BE USING IS DATA ON ECONOMIC PRODUCTIVITY IN THE UNITED STATES.
data(Produc) #THIS IS THE DATA
 
#MAYBE IT'S TIME FOR THE SPATIAL PANEL MODEL!
#IN ADDITION TO THE PACKAGES WE USED FOR THE PANEL MODEL, WE'LL NEED THESE:
install.packages("splm") #THIS IS THE SPATIAL PANEL MODEL PACKAGE
library(splm)
install.packages("spdep") #TO HELP US WITH OUR SPATIAL DATA
library(spdep)
 
#THE Ecdat LIBRARY CONVENIENTLY HAS A NEIGHBOR'S MATRIX FOR CONTIGUOUS US STATES:
data(usaww) #THIS IS THE ROW-STANDARDIZED QUEEN'S CASE CONTIGUITY WEIGHTS MATRIX FOR 
#THE CONTIGUOUS US STATES
 
prod.panel <- pdata.frame(Produc, index = c("state", "year"))
 
#FIRST, LET'S CONVERT THAT REGULAR MATRIX INTO A SPATIAL WEIGHTS MATRIX:
usa.sp <- mat2listw(usaww) #JUST WHAT IT SOUNDS LIKE; TURNS A MATRIX INTO A SPATIAL
#WEIGHTS MATRIX.
 
#OKAY, SO THESE SUGGEST WE HAVE SOME ISSUES WITH SPATIAL AUTOCORRELATION AND 
#INDIVIDUAL EFFECTS.  BUT WE STILL NEET TO DETERMINE WHETHER WE CAN USE FIXED OR
#RANDOM EFFECTS.  FORTUNATELY, WE HAVE A SPATIAL VERSION OF THE HAUSMAN TEST TO 
#HELP US WITH THIS:
prod.fm <- log(gsp) ~ 1 + log(pcap) + log(pc) + log(emp)
sphtest(prod.fm, 
        data=prod.panel,
        listw=usa.sp,
        spatial.model="sarar",
        method="ML"
        ) 

# HERE IS THE PROBLEM: THE TEST RETURNS: 
# "Error in match.arg(spatial.error) :   'arg' must be NULL or a character vector"

# JUST TO CHECK: THE RANDOM EFFECTS AND FIXED EFFECTS MODELS DO WORK PROPERLY:
prod.fm.rd <- spml(formula = prod.fm, 
			data = prod.panel, 
			listw = usa.sp, 
			listw2 = usa.sp, 
			model = "random", 
			effect = "individual", 
			lag = TRUE, 
			spatial.error = "b")
summary.splm(prod.fm.rd)
prod.fm.fe <- spml(formula = prod.fm, 
			data = prod.panel, 
			listw = usa.sp, 
			listw2 = usa.sp, 
			model = "within", 
			effect = "individual", 
			lag = TRUE, 
			spatial.error = "b")
summary.splm(prod.fm.fe)

#-------------------------------------------------------------------------------




________________________________________
De : Roger Bivand <Roger.Bivand at nhh.no>
Envoy? : mardi 25 f?vrier 2014 15:11
? : Patrick Meyfroidt
Cc : r-sig-geo at r-project.org
Objet : Re: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum Likelihood

On Tue, 25 Feb 2014, Patrick Meyfroidt wrote:

> Dear List,
>
> I have a problem using splm package: across various datasets and models,
> the sphtest function never works when I try to calculate the Hausman
> test with a model using Maximum Likelihood. I always receive the
> following error message:
>
> Error in match.arg(spatial.error) :
>  'arg' must be NULL or a character vector
>
> I see that several other people posted the same problem before, but
> apparently there was not solution proposed on the list: in September
> 2011:
> https://stat.ethz.ch/pipermail/r-sig-geo/2011-September/012826.html and
> in May 2013:
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-May/018256.html
>
> Does anyone have a solution?

Please never guess, it only misleads you and readers of your posting.

Please always state the output of sessionInfo() - we don't know which
version of splm you are using.

Please always include a reproducible example of the code leading to the
error with a built in data set.

Do check that the problem is not already resolved in the development
version on R-forge, here:

https://r-forge.r-project.org/R/?group_id=352

>
> Thank you very much,
>
>
> Patrick Meyfroidt ------ F.R.S. - FNRS and Universit? catholique de
> Louvain - UCLouvain
>
>
>       [[alternative HTML version deleted]]

Finally, do not post HTML, much of the extensive carbon footprint of lists
like this comes from scanning HTML postings for unwanted and/or dangerous
payloads.

Hope this helps,

Roger

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Feb 28 15:58:32 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 28 Feb 2014 15:58:32 +0100
Subject: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum
 Likelihood
In-Reply-To: <7a5aa9a714744c3fbff08e9b71b95622@ucl-mbx04.OASIS.UCLOUVAIN.BE>
References: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>,
	<alpine.LRH.2.03.1402251505510.29426@reclus.nhh.no>
	<7a5aa9a714744c3fbff08e9b71b95622@ucl-mbx04.OASIS.UCLOUVAIN.BE>
Message-ID: <alpine.LRH.2.03.1402281518140.22470@reclus.nhh.no>

On Fri, 28 Feb 2014, Patrick Meyfroidt wrote:

> Thanks Roger, and sorry. 
>
> My code and data are a bit long to put here, but thanks to Caleb 
> Gallemore which had a similar problem, I can post here a test code that 
> he made for students, which uses data from Ecdat package.
>
> This code below, as well as my code, were tested with:
> R 2.15.1 and splm_1.1-0 (the current stable version)
> and R 3.0.2 and splm_1.2-0 (the development version)
>
> I hope that this addresses your rightful concerns,
>
> Now, if anyone has a suggestion (other than moving to Matlab..), that 
> would be very welcome?

<flare>Feel free, silly remarks really motivate us to improve the 
software</flare>, seriously, have you any idea how much of their own time 
R and package developers use to keep all this running?

The actual response below - if you want to benefit from community effort, 
do try to understand how things work. If you are "above that", just keep 
to our rules here and keep your jokes to yourself.

>
> Patrick 
>
>
> # CODE OF REPRODUCIBLE EXAMPLE:
> #-------------------------------------------------------------------------------
>

library(Ecdat)
library(plm)
data(Produc) #THIS IS THE DATA
library(splm)
library(spdep)
data(usaww) #THIS IS THE ROW-STANDARDIZED QUEEN'S CASE CONTIGUITY WEIGHTS MATRIX FOR 
prod.panel <- pdata.frame(Produc, index = c("state", "year"))
usa.sp <- mat2listw(usaww) #JUST WHAT IT SOUNDS LIKE; TURNS A MATRIX INTO A SPATIAL
prod.fm <- log(gsp) ~ 1 + log(pcap) + log(pc) + log(emp)
sphtest(prod.fm, data=prod.panel, listw=usa.sp, spatial.model="sarar",
   method="ML")

shortens this somewhat, the rest is superfluous and is not a big deal. The 
error is reproducible with 1.1-0 and 1.2-0. I've CC'd the maintainer.

Standard practice is to run traceback() to identify the failing function:

> traceback()
5: stop("'arg' must be NULL or a character vector")
4: match.arg(spatial.error)
3: spml(x, data = data, index = index, listw = listw, lag = lag,
        spatial.error = spatial.error, model = "within", errors = errors)
2: sphtest.formula(prod.fm, data = prod.panel, listw = usa.sp, 
spatial.model = "sarar", method = "ML")
1: sphtest(prod.fm, data = prod.panel, listw = usa.sp, spatial.model = 
"sarar", method = "ML")

here spml.

Running inside debug(spml) shows that match.arg(spatial.error) occurs in a 
context where it has been given a logical value TRUE by sphtest.formula, 
but should be one of c("b","kkp","none").

The package has been being simplified and the arguments have got mixed up, 
it happens. The examples for sphtest() only check its performance with 
method="GM" - they work OK, so additional checks with method="ML" are 
needed, but perhaps within a \donttest block, once the problem has been 
resolved.

Users who find issues with software are expected to help developers 
promptly, in a case like this by doing as much of the debugging as 
possible themselves, and then at least contacting the maintainer of the 
involved package.

From viewing the SVN repository, it isn't immediately obvious where the 
bug has come from, but spatial.error is used in sphtest.formula with lag 
to pass through the kind of model rather than the type of spatial error. 
The authors of the package would welcome further analysis and patches.

Roger

>
> # HERE IS THE PROBLEM: THE TEST RETURNS: 
> # "Error in match.arg(spatial.error) :   'arg' must be NULL or a character vector"
>
> # JUST TO CHECK: THE RANDOM EFFECTS AND FIXED EFFECTS MODELS DO WORK PROPERLY:
> prod.fm.rd <- spml(formula = prod.fm,
> 			data = prod.panel,
> 			listw = usa.sp,
> 			listw2 = usa.sp,
> 			model = "random",
> 			effect = "individual",
> 			lag = TRUE,
> 			spatial.error = "b")
> summary.splm(prod.fm.rd)
> prod.fm.fe <- spml(formula = prod.fm,
> 			data = prod.panel,
> 			listw = usa.sp,
> 			listw2 = usa.sp,
> 			model = "within",
> 			effect = "individual",
> 			lag = TRUE,
> 			spatial.error = "b")
> summary.splm(prod.fm.fe)
>
> #-------------------------------------------------------------------------------
>
>
>
>
> ________________________________________
> De : Roger Bivand <Roger.Bivand at nhh.no>
> Envoy? : mardi 25 f?vrier 2014 15:11
> ? : Patrick Meyfroidt
> Cc : r-sig-geo at r-project.org
> Objet : Re: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum Likelihood
>
> On Tue, 25 Feb 2014, Patrick Meyfroidt wrote:
>
>> Dear List,
>>
>> I have a problem using splm package: across various datasets and models,
>> the sphtest function never works when I try to calculate the Hausman
>> test with a model using Maximum Likelihood. I always receive the
>> following error message:
>>
>> Error in match.arg(spatial.error) :
>>  'arg' must be NULL or a character vector
>>
>> I see that several other people posted the same problem before, but
>> apparently there was not solution proposed on the list: in September
>> 2011:
>> https://stat.ethz.ch/pipermail/r-sig-geo/2011-September/012826.html and
>> in May 2013:
>> https://stat.ethz.ch/pipermail/r-sig-geo/2013-May/018256.html
>>
>> Does anyone have a solution?
>
> Please never guess, it only misleads you and readers of your posting.
>
> Please always state the output of sessionInfo() - we don't know which
> version of splm you are using.
>
> Please always include a reproducible example of the code leading to the
> error with a built in data set.
>
> Do check that the problem is not already resolved in the development
> version on R-forge, here:
>
> https://r-forge.r-project.org/R/?group_id=352
>
>>
>> Thank you very much,
>>
>>
>> Patrick Meyfroidt ------ F.R.S. - FNRS and Universit? catholique de
>> Louvain - UCLouvain
>>
>>
>>       [[alternative HTML version deleted]]
>
> Finally, do not post HTML, much of the extensive carbon footprint of lists
> like this comes from scanning HTML postings for unwanted and/or dangerous
> payloads.
>
> Hope this helps,
>
> Roger
>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jgrn at illinois.edu  Fri Feb 28 16:13:09 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 28 Feb 2014 09:13:09 -0600
Subject: [R-sig-Geo] [R-sig-hpc] Out-of-control SOCK/PSOCK cluster
In-Reply-To: <87C052AE97CD72429646BBAF27107194123FD4F0@SKADE.uib.no>
References: <CABG0rftnRK+QVda5MKEiz5TFmdXzTFzG16PeostQpAbaHrz54w@mail.gmail.com>
	<87C052AE97CD72429646BBAF27107194123FD4C6@SKADE.uib.no>
	<CABG0rfusnCHw7uA6C8BNRqCh2qiP2E+8OjPu1qv5isQ2t-m9Kw@mail.gmail.com>
	<87C052AE97CD72429646BBAF27107194123FD4F0@SKADE.uib.no>
Message-ID: <CABG0rft7SJb7nWueZVXft+eg1C533k=wR_x2xafk1y5Y9ysLYg@mail.gmail.com>

Hi Truc:

If I'm understanding the code, you need to get the PID from a cluster
call BEFORE it gets out of control, correct?  Is there a way to get
the PIDs from the cluster object running on the master process
directly (e.g. a parallel PSOCK cluster)?  I see it prints the PID (I
suppose I can parse the text), but is there a "cleaner" way to get the
PIDs from this object?

--j

On Tue, Feb 25, 2014 at 3:02 PM, Truc Nguyen Trung
<Truc.Trung at igs.uib.no> wrote:
> Hi again !
> Sorry I should explain a little more clearly about your problem.
> 1 Try to download package called "Haplin"
> 2. library(Haplin)
>     write   haplinSlide
> By reading line by line you will see how we do it
>
> ################################################
> if (.para == "parallel") {
>             w <- makeCluster(spec = cpus, outfile = slaveOutfile)
>             .plat <- .Platform$OS.type
>             if (.plat == "windows")
>                 .cmds <- "taskkill /pid "
>             if (.plat == "unix")
>                 .cmds <- "kill "
>             .pids <- sapply(w, function(x) {
>                 parallel:::sendCall(x, eval, list(quote(Sys.getpid())))
>                 parallel:::recvResult(x)
>             })
>             .cmds <- paste(.cmds, .pids, sep = "")
>             on.exit({
>                 if (!missing(slaveOutfile)) sink(file = slaveOutfile,
>                   append = T)
>                 sapply(.cmds, system)
>                 for (.w in w) {
>                   try(parallel:::postNode(.w, "DONE"), silent = T)
>                   try(parallel:::closeNode(.w), silent = T)
>                 }
>                 if (!missing(slaveOutfile)) sink()
>             })
>         }
> #####################################################
> We have developed a Haplin GUI which you can see the sock PID .....
> I hope this can help you.
> Truc
> ________________________________________
> From: jgrn307 at gmail.com [jgrn307 at gmail.com] on behalf of Jonathan Greenberg [jgrn at illinois.edu]
> Sent: Tuesday, February 25, 2014 7:17 PM
> To: Truc Nguyen Trung
> Subject: Re: [R-sig-hpc] Out-of-control SOCK/PSOCK cluster
>
> Truc:
>
> Did you send this to the wrong person?  I'm not sure what that
> software has to do with killing parallel workers.
>
> --j
>
> On Tue, Feb 25, 2014 at 12:09 PM, Truc Nguyen Trung
> <Truc.Trung at igs.uib.no> wrote:
>> Please take a look at http://haplin.fhi.no.
>> I think it may help ....
>> Truc
>> ________________________________________
>> From: r-sig-hpc-bounces at r-project.org [r-sig-hpc-bounces at r-project.org] on behalf of Jonathan Greenberg [jgrn at illinois.edu]
>> Sent: Tuesday, February 25, 2014 7:00 PM
>> To: r-sig-hpc at r-project.org
>> Subject: [R-sig-hpc] Out-of-control SOCK/PSOCK cluster
>>
>> R-sig-hpc'ers:
>>
>> I was curious if there are any "safe" ways to kill an out-of-control
>> SOCK/PSOCK workers on Windows/Macs.  Thus far, on a Windows box I've
>> been having to force-quit them from the task manager or by running a
>> command line "Taskkill".  On Mac, I use a kill -9 or the Activity
>> Monitor.  I'd like to write an R script to do this, but right now all
>> I can do is kill ALL R workers via name matching, which may kill
>> non-cluster R instances.  Is there a way to get the PIDs or is there
>> an existing function to safely kill a cluster, specifically one
>> created via the parallel package?  Cheers!
>>
>> --j
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>> _______________________________________________
>> R-sig-hpc mailing list
>> R-sig-hpc at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-hpc
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From patrick.meyfroidt at uclouvain.be  Fri Feb 28 16:15:22 2014
From: patrick.meyfroidt at uclouvain.be (Patrick Meyfroidt)
Date: Fri, 28 Feb 2014 15:15:22 +0000
Subject: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum
 Likelihood
In-Reply-To: <alpine.LRH.2.03.1402281518140.22470@reclus.nhh.no>
References: <f8bf4ebd185e4415b2ef8a5c2b87d092@ucl-mbx04.OASIS.UCLOUVAIN.BE>,
	<alpine.LRH.2.03.1402251505510.29426@reclus.nhh.no>
	<7a5aa9a714744c3fbff08e9b71b95622@ucl-mbx04.OASIS.UCLOUVAIN.BE>,
	<alpine.LRH.2.03.1402281518140.22470@reclus.nhh.no>
Message-ID: <b44f8867729a447fa95a203b07feb9e6@ucl-mbx04.OASIS.UCLOUVAIN.BE>

Apologies Roger, I really was not making a silly remark, and I'm very sorry that it was taken as such.
At the contrary, I wrote that because several people already suggested me to move to Matlab for doing this spatial Hausman test, so, thereby I wanted to indicate that, OK, I was aware of that possible solution, but that ws not my option. Indeed, I wanted to see if raising that issue here could help to move further with splm. 

I'm extremely aware of the tremendous efforts done by developers here, and I could not be more grateful. And indeed especially to Giovanni Millo who's been already very helpful trough direct contacts for previous issues. And to be honest, because I was not sure whether this was a issue with the package itself or an error of my own, I preferred to ask the list precisely to not disturb the package's maintainers again. 

So, apologies again for the misunderstanding, that was really the meaning of what I wrote, and I'll do my best to learn how to debug. 

Thank you very much,

Patrick





________________________________________
De : Roger Bivand <Roger.Bivand at nhh.no>
Envoy? : vendredi 28 f?vrier 2014 15:58
? : Patrick Meyfroidt
Cc : r-sig-geo at r-project.org; giovanni_millo at generali.com; gpiras at mac.com
Objet : RE: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum Likelihood

On Fri, 28 Feb 2014, Patrick Meyfroidt wrote:

> Thanks Roger, and sorry.
>
> My code and data are a bit long to put here, but thanks to Caleb
> Gallemore which had a similar problem, I can post here a test code that
> he made for students, which uses data from Ecdat package.
>
> This code below, as well as my code, were tested with:
> R 2.15.1 and splm_1.1-0 (the current stable version)
> and R 3.0.2 and splm_1.2-0 (the development version)
>
> I hope that this addresses your rightful concerns,
>
> Now, if anyone has a suggestion (other than moving to Matlab..), that
> would be very welcome?

<flare>Feel free, silly remarks really motivate us to improve the
software</flare>, seriously, have you any idea how much of their own time
R and package developers use to keep all this running?

The actual response below - if you want to benefit from community effort,
do try to understand how things work. If you are "above that", just keep
to our rules here and keep your jokes to yourself.

>
> Patrick
>
>
> # CODE OF REPRODUCIBLE EXAMPLE:
> #-------------------------------------------------------------------------------
>

library(Ecdat)
library(plm)
data(Produc) #THIS IS THE DATA
library(splm)
library(spdep)
data(usaww) #THIS IS THE ROW-STANDARDIZED QUEEN'S CASE CONTIGUITY WEIGHTS MATRIX FOR
prod.panel <- pdata.frame(Produc, index = c("state", "year"))
usa.sp <- mat2listw(usaww) #JUST WHAT IT SOUNDS LIKE; TURNS A MATRIX INTO A SPATIAL
prod.fm <- log(gsp) ~ 1 + log(pcap) + log(pc) + log(emp)
sphtest(prod.fm, data=prod.panel, listw=usa.sp, spatial.model="sarar",
   method="ML")

shortens this somewhat, the rest is superfluous and is not a big deal. The
error is reproducible with 1.1-0 and 1.2-0. I've CC'd the maintainer.

Standard practice is to run traceback() to identify the failing function:

> traceback()
5: stop("'arg' must be NULL or a character vector")
4: match.arg(spatial.error)
3: spml(x, data = data, index = index, listw = listw, lag = lag,
        spatial.error = spatial.error, model = "within", errors = errors)
2: sphtest.formula(prod.fm, data = prod.panel, listw = usa.sp,
spatial.model = "sarar", method = "ML")
1: sphtest(prod.fm, data = prod.panel, listw = usa.sp, spatial.model =
"sarar", method = "ML")

here spml.

Running inside debug(spml) shows that match.arg(spatial.error) occurs in a
context where it has been given a logical value TRUE by sphtest.formula,
but should be one of c("b","kkp","none").

The package has been being simplified and the arguments have got mixed up,
it happens. The examples for sphtest() only check its performance with
method="GM" - they work OK, so additional checks with method="ML" are
needed, but perhaps within a \donttest block, once the problem has been
resolved.

Users who find issues with software are expected to help developers
promptly, in a case like this by doing as much of the debugging as
possible themselves, and then at least contacting the maintainer of the
involved package.

>From viewing the SVN repository, it isn't immediately obvious where the
bug has come from, but spatial.error is used in sphtest.formula with lag
to pass through the kind of model rather than the type of spatial error.
The authors of the package would welcome further analysis and patches.

Roger

>
> # HERE IS THE PROBLEM: THE TEST RETURNS:
> # "Error in match.arg(spatial.error) :   'arg' must be NULL or a character vector"
>
> # JUST TO CHECK: THE RANDOM EFFECTS AND FIXED EFFECTS MODELS DO WORK PROPERLY:
> prod.fm.rd <- spml(formula = prod.fm,
>                       data = prod.panel,
>                       listw = usa.sp,
>                       listw2 = usa.sp,
>                       model = "random",
>                       effect = "individual",
>                       lag = TRUE,
>                       spatial.error = "b")
> summary.splm(prod.fm.rd)
> prod.fm.fe <- spml(formula = prod.fm,
>                       data = prod.panel,
>                       listw = usa.sp,
>                       listw2 = usa.sp,
>                       model = "within",
>                       effect = "individual",
>                       lag = TRUE,
>                       spatial.error = "b")
> summary.splm(prod.fm.fe)
>
> #-------------------------------------------------------------------------------
>
>
>
>
> ________________________________________
> De : Roger Bivand <Roger.Bivand at nhh.no>
> Envoy? : mardi 25 f?vrier 2014 15:11
> ? : Patrick Meyfroidt
> Cc : r-sig-geo at r-project.org
> Objet : Re: [R-sig-Geo] SPLM sphtest Hausman test not working with Maximum Likelihood
>
> On Tue, 25 Feb 2014, Patrick Meyfroidt wrote:
>
>> Dear List,
>>
>> I have a problem using splm package: across various datasets and models,
>> the sphtest function never works when I try to calculate the Hausman
>> test with a model using Maximum Likelihood. I always receive the
>> following error message:
>>
>> Error in match.arg(spatial.error) :
>>  'arg' must be NULL or a character vector
>>
>> I see that several other people posted the same problem before, but
>> apparently there was not solution proposed on the list: in September
>> 2011:
>> https://stat.ethz.ch/pipermail/r-sig-geo/2011-September/012826.html and
>> in May 2013:
>> https://stat.ethz.ch/pipermail/r-sig-geo/2013-May/018256.html
>>
>> Does anyone have a solution?
>
> Please never guess, it only misleads you and readers of your posting.
>
> Please always state the output of sessionInfo() - we don't know which
> version of splm you are using.
>
> Please always include a reproducible example of the code leading to the
> error with a built in data set.
>
> Do check that the problem is not already resolved in the development
> version on R-forge, here:
>
> https://r-forge.r-project.org/R/?group_id=352
>
>>
>> Thank you very much,
>>
>>
>> Patrick Meyfroidt ------ F.R.S. - FNRS and Universit? catholique de
>> Louvain - UCLouvain
>>
>>
>>       [[alternative HTML version deleted]]
>
> Finally, do not post HTML, much of the extensive carbon footprint of lists
> like this comes from scanning HTML postings for unwanted and/or dangerous
> payloads.
>
> Hope this helps,
>
> Roger
>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From bakare at ualberta.ca  Fri Feb 28 20:29:31 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Fri, 28 Feb 2014 12:29:31 -0700
Subject: [R-sig-Geo] GSTAT ordinary kriging prediction with large observation
Message-ID: <CAJRR3XOQz12yBaK3oRX9piVNFuX9Ey7nyG6DUG3YDihBJiwj3Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140228/7e364286/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Feb 28 21:25:41 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 28 Feb 2014 21:25:41 +0100
Subject: [R-sig-Geo] GSTAT ordinary kriging prediction with large
	observation
In-Reply-To: <CAJRR3XOQz12yBaK3oRX9piVNFuX9Ey7nyG6DUG3YDihBJiwj3Q@mail.gmail.com>
References: <CAJRR3XOQz12yBaK3oRX9piVNFuX9Ey7nyG6DUG3YDihBJiwj3Q@mail.gmail.com>
Message-ID: <5310F0C5.3020509@uni-muenster.de>



On 02/28/2014 08:29 PM, Moshood Agba Bakare wrote:
> Dear All,
> 
> The R script below is to generate interpolation grid for prediction using
> ordinary kriging. I encountered error message " R  encountered a fatal
> error, the session was terminated". This is as a result of large obervation
> I have 116,818.  I have no problem in fitting my variogram model with this
> large observation using GSTAT but encountered error  message above during
> interpolation using ordinary kriging.When I used few observations, the
> script ran successfully. Please advise me on how to rectify this problem.
> Does it mean we can use the entire observations for prediction?
> 

Possibly, we'd need more information to be sure. You can set nmax = 100
(or any other value) to constrain the number of nearest observation used
for prediction.

> 
> This is my script
> 
> ### Create grid for the interpolation (prediction) through ordinary kriging
> 
> easting.range <- as.integer(range(canmod.sp at coords[,1]))
> northing.range <-as.integer(range(canmod.sp at coords[,2]))
> 
> ## now expand to a grid with 100 meter spacing:
> grd <- expand.grid(x=seq(from=easting.range[1], to=easting.range[2],
> by=100),
>                    y=seq(from=northing.range[1], to=northing.range[2],
> by=100))
> names(grd)<-c("easting","northing")
> 
> coordinates(grd)<-~easting+northing
> proj4string(grd)<-CRS("+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84
> +units=m +no_defs +towgs84=0,0,0")
> Pred_ok <- krige(id="yield",yield ~ 1, canmod.sp, newdata = grd,
> model=exp.mod)
> 
> 
> Thanks while looking forward to reading your response please.
> 
> Moshood
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140228/bf87a5be/attachment.bin>

