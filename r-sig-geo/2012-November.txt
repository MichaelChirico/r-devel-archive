From salmaaries at hotmail.com  Thu Nov  1 06:22:19 2012
From: salmaaries at hotmail.com (salma anwar)
Date: Thu, 1 Nov 2012 05:22:19 +0000
Subject: [R-sig-Geo] countingweights?
Message-ID: <SNT124-W605AF49D168096D62AD14BD1600@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121101/2465962c/attachment.pl>

From Tom_Roche at pobox.com  Thu Nov  1 07:07:17 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Thu, 01 Nov 2012 02:07:17 -0400
Subject: [R-sig-Geo] how to plot Raster*? problems with raster::plot,
 fields::image.plot
In-Reply-To: <87zk3bcdr0.fsf@pobox.com>
References: <87zk3bcdr0.fsf@pobox.com> <87k3ufxhz0.fsf@pobox.com>
	<87wqyf5myv.fsf@pobox.com>
	<CANtt_hzWj4JQsuKjNB5K4r8F9pw2wVP5L=hXHPADQepTP6m3Hg@mail.gmail.com>
	<87txtl7s8k.fsf@pobox.com>
	<CANtt_hx1dB+iJ7KjDtESMMNAR_EeLzBPuQar26NNjmTTLx6ROQ@mail.gmail.com>
	<87391378jj.fsf@pobox.com>
Message-ID: <87r4odrh4a.fsf@pobox.com>


Both sets of problems (with raster::plot and fields::image.plot) are now
essentially solved. My main raster-related problems proved to be

* confusing the template Raster* produced by projectExtent(...) with
  the Extent object that the template Raster* contains

* using a cited CRS, rather than querying the template input file
  for its CRS

See details in the answer @ end of

http://stackoverflow.com/questions/13005181/r-how-to-set-the-display-bounds-of-a-rasterplot/

A minor problem with the map I'm using for raster::plot remains (details
at the end of the answer), as does the problem with setting the CRS
previously described @

https://stat.ethz.ch/pipermail/r-sig-geo/2012-October/016524.html

Reversing the column order of the data solves the fields::image.plot
problem completely: see function=plot.raster in

https://github.com/TomRoche/GEIA_to_netCDF/blob/master/plotLayersForTimestep.r

All code (including drivers providing a test fixture), data, downloads,
and README are available @

https://github.com/TomRoche/GEIA_to_netCDF

HTH, Tom Roche <Tom_Roche at pobox.com>


From Tom_Roche at pobox.com  Thu Nov  1 07:21:28 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Thu, 01 Nov 2012 02:21:28 -0400
Subject: [R-sig-Geo] "regridding" netCDF?
In-Reply-To: <CAK8gSG-7VFTN9zQTjU+cWGKti0-HMyFmYLwssS1q7i=aaxvWOw@mail.gmail.com>
References: <CAK8gSG-7VFTN9zQTjU+cWGKti0-HMyFmYLwssS1q7i=aaxvWOw@mail.gmail.com>
	<87mx3ew372.fsf@pobox.com>
Message-ID: <87objhrggn.fsf@pobox.com>


ping yang Thu, 18 Oct 2012 22:47:07 -0400
> I want to do a transform (re-projection) from a Lambert Conformal
> Conic (grid, Daymet netCDF data) to Lat/lon grid. Has here someone
> already done this kind of transformation?

No, but I have done a reverse regridding (from lon-lat to LCC), which
could be quite similar. See code @

https://github.com/TomRoche/GEIA_to_NetCDF

esp

https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r

HTH, Tom Roche <Tom_Roche at pobox.com>


From Tom_Roche at pobox.com  Thu Nov  1 07:44:17 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Thu, 01 Nov 2012 02:44:17 -0400
Subject: [R-sig-Geo] reboxing, or 3D interpolation?
Message-ID: <87lielrfem.fsf@pobox.com>


Having done "regridding" (aka 2D interpolation), I'd like to know
how to do "reboxing" (aka 3D interpolation) in R. Can anyone point me
to docs explaining how to do this, or example code that does this?
What I mean, why I ask:

I'm a student attempting to incorporate N2O emissions inventories
(EIs), initial conditions (ICs), and boundary conditions (BCs) from
relatively coarse-scaled global inventories (with horizontal grids on
the order of degrees lon-lat) into a relatively fine-scaled regional
atmospheric model (12-km LCC horizontal). The emissions are all from
surface, hence effectively 2D, and I now know how to "regrid," or
interpolate from one 2D grid to another.

However the model and the N2O IC/BCs are 3D: the cells are boxes,
not just grids. And of course the model (on the one hand) and the
N2O IC/BCs have different vertical layering (i.e., numbers of layers,
and top height, or maximum vertical extent), as well as different
horizontal grids. I'd like to know: is there R code available that
will "rebox," i.e., interpolate vertically as well as horizontally?

thanks in advance, and feel free to forward, Tom Roche <Tom_Roche at pobox.com>


From edzer.pebesma at uni-muenster.de  Thu Nov  1 10:04:08 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 01 Nov 2012 10:04:08 +0100
Subject: [R-sig-Geo] reboxing, or 3D interpolation?
In-Reply-To: <87lielrfem.fsf@pobox.com>
References: <87lielrfem.fsf@pobox.com>
Message-ID: <50923B08.7070804@uni-muenster.de>

Package gstat provides 3D interpolation:

library(gstat)
demo(gstat3D)

in this case, if you'd leave out the variogram model, inverse distance
is used for interpolation.

An typical issue is, independent whether the third dimension represents
z (vertical space) or time, that variability, or spatial correlation, in
x/y differs from that in z for the same distance unit (where "same" is
only meaningful when z is vertical space). You can then rescale z, or
use anisotropic variogram models.

On 11/01/2012 07:44 AM, Tom Roche wrote:
> 
> Having done "regridding" (aka 2D interpolation), I'd like to know
> how to do "reboxing" (aka 3D interpolation) in R. Can anyone point me
> to docs explaining how to do this, or example code that does this?
> What I mean, why I ask:
> 
> I'm a student attempting to incorporate N2O emissions inventories
> (EIs), initial conditions (ICs), and boundary conditions (BCs) from
> relatively coarse-scaled global inventories (with horizontal grids on
> the order of degrees lon-lat) into a relatively fine-scaled regional
> atmospheric model (12-km LCC horizontal). The emissions are all from
> surface, hence effectively 2D, and I now know how to "regrid," or
> interpolate from one 2D grid to another.
> 
> However the model and the N2O IC/BCs are 3D: the cells are boxes,
> not just grids. And of course the model (on the one hand) and the
> N2O IC/BCs have different vertical layering (i.e., numbers of layers,
> and top height, or maximum vertical extent), as well as different
> horizontal grids. I'd like to know: is there R code available that
> will "rebox," i.e., interpolate vertically as well as horizontally?
> 
> thanks in advance, and feel free to forward, Tom Roche <Tom_Roche at pobox.com>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From a.mosnier at gmail.com  Thu Nov  1 13:48:14 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Thu, 1 Nov 2012 08:48:14 -0400
Subject: [R-sig-Geo] spatial regression model
Message-ID: <CANkFkEeMuxORQtbJ5LxLeH65BZran54JLkRE6rvRHPG57yZS0Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121101/59ab7097/attachment.pl>

From zua3 at cornell.edu  Thu Nov  1 14:58:39 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Thu, 01 Nov 2012 09:58:39 -0400
Subject: [R-sig-Geo] spatial regression model
In-Reply-To: <CANkFkEeMuxORQtbJ5LxLeH65BZran54JLkRE6rvRHPG57yZS0Q@mail.gmail.com>
References: <CANkFkEeMuxORQtbJ5LxLeH65BZran54JLkRE6rvRHPG57yZS0Q@mail.gmail.com>
Message-ID: <5092800F.9090900@cornell.edu>

You can evaluate the proportion of the variance explained by spatial 
structure by  log-likelihood test-  between spatial model and a model 
with intercept:
suppose:

library(lnlme)

M1<-lme(response~ predictots+...., method="REML", correlation=corExp(form=~x+y, nugget=T), data=yourdata) # model with spatial structure
Mo<-gls(response~1,method = "REML",data=yourdata) # model with intercept only
anova(M1, Mo) # Compare two models

a<-logLiklehood value of M1
b<-logLiklehood value of Mo
n<- nrow(yourdata)

R2<- (1 - exp((-2/n)*( -a -b)))   # log-likelihood R^2 for M1


On 11/1/2012 8:48 AM, Arnaud Mosnier wrote:
> Paolo,
>
> Using GLS seems a good approach for what you want to do.
> However, as its names indicates GLS models does not use the OLS approach,
> so you can't use the "classic" R square interpretation.
>
> I would follow these steps (but if I am wrong please feel free to correct
> me !!).
> 1) Run your model in GLS without the spatial structure.
> 2) Make a variogram with your residuals (in order to see what kind of
> spatial structure you need)
> 3) Run your model in GLS with the spatial structure (using corStruct)
> 4) Compare AICs to see if including the spatial structure improve your
> model (you can also use AICs to test several spatial structures and find
> the best).
>
> However, I don't know how to evaluate the proportion of the variance
> explained by the spatial structure. If someone have the information, I
> would be pleased to learn !
>
> Arnaud
>
>
> ------------------------------------------------------
>
> Dear community
>
> I write to pose a question about the best way to incorporate spatial non
> independence in a regression model that has multivariate responses and
> multiple predictors. I would like to estimate the global R-sq under OLS and
> its significance (no problem for that..) and compare it when incorporating
> spatial non independence.
> My response are PCs (about 6 or 7)  of trait measured (actually coming from
> Geometric Morhometrics data) on teeh shape on 16 populations. I will use
> population means for my analyses. I'm not interested in exploring single
> spatial structure of single responses or single predictors (that could be
> different); rather I look for  for a GLOBAL assessment of the model in term
> of significance and, POSSIBLY, in term of variance explained by spatial
> structure. However, I would prefer to avoid the eigenvector filtering on
> the basis of some seminal literature:
>
> (i.e:
> Beale, C. M., J. J. Lennon, J. M. Yearsley, M. J. Brewer, and D. A. Elston.
> 2010. Regression analysis of spatial data. Ecology Letters 13:246
> Rob P. Freckleton, Natalie Cooper, Walter Jetz, Associate Editor: Gregory
> D. D Comparative Methods as a Statistical Fix: The Dangers of Ignoring an
> Evolutionary Model. 2011. The American Naturalist)
>
> My predictors are climatic and soil variables.Multicollinearities are
> controlled performing within each block a PCA and retaining all PCs
> explaining at least 90% of variance.
> So...I thought  to use a gls procedure with a spatial covariance as
> corStructure term or to the package spgwr; however, I'm not sure about the
> possibility to include multivariate response in spgwr.
> Being relatively new in this type of analyses I wrote you in order to have
> some useful suggestions about my model.
> Thankyou in advance
> Paolo Piras
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
---------------------
Zia Ahmed, PhD
Research Associate
Department of Crop and Soil Sciences
1002 Bradfield Hall, Cornell University
Ithaca, NY 14853-4203
t. 607.255.9387
f. 607.255.3207
email zua3 at cornell.edu


From corey.sparks at UTSA.EDU  Thu Nov  1 15:21:14 2012
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Thu, 1 Nov 2012 07:21:14 -0700 (PDT)
Subject: [R-sig-Geo] Question about space-time analysis routines
Message-ID: <1351779673999-7581537.post@n2.nabble.com>

Dear List,
I've recently began doing more spatio-temporal analysis using hierarchical
Bayesian methods, mostly in Win/OpenBUGS and INLA.  

I really like the capabilities of the spacetime package in terms of building
data that incorporate multiple temporal observations of the same units (I
work  mostly with county and census geographies in the US). 

I am curious if the list can point me to some other libraries in R, besides
INLA, that are capable of using the spacetime data directly in a regression
framework, or perhaps in a spatio-temporal disease clustering framework. I
know about the DCluster library and use it some, but would be very grateful
for any other ideas.
Best, 
Corey



-----
Corey Sparks
Assistant professor
Department of Demography
The University of Texas at San Antonio
501 West Cesar E Chavez Blvd
San Antonio TX 78207
Corey.sparks 'at' utsa.edu
210 458 3166 &lt;tel:210%20458%203166&gt;
Latitude: 29.423614  /  Longitude: -98.504282
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Question-about-space-time-analysis-routines-tp7581537.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From hengl at spatial-analyst.net  Thu Nov  1 18:26:55 2012
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 01 Nov 2012 18:26:55 +0100
Subject: [R-sig-Geo] "regridding" netCDF?
In-Reply-To: <87objhrggn.fsf@pobox.com>
References: <CAK8gSG-7VFTN9zQTjU+cWGKti0-HMyFmYLwssS1q7i=aaxvWOw@mail.gmail.com>
	<87mx3ew372.fsf@pobox.com> <87objhrggn.fsf@pobox.com>
Message-ID: <5092B0DF.4050204@spatial-analyst.net>


I've produced some 3D interpolation examples in the experimental package 
GSIF (under construction). You can actually create some kind of voxels 
via the SpatialPixelsDataFrame class 
[http://gsif.r-forge.r-project.org/make.3Dgrid-method.html] and then 
predict at those locations. Here are some examples:

http://gsif.r-forge.r-project.org/tutorial_eberg.php

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

On 01/11/2012 07:21, Tom Roche wrote:
>
> ping yang Thu, 18 Oct 2012 22:47:07 -0400
>> I want to do a transform (re-projection) from a Lambert Conformal
>> Conic (grid, Daymet netCDF data) to Lat/lon grid. Has here someone
>> already done this kind of transformation?
>
> No, but I have done a reverse regridding (from lon-lat to LCC), which
> could be quite similar. See code @
>
> https://github.com/TomRoche/GEIA_to_NetCDF
>
> esp
>
> https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r
>
> HTH, Tom Roche <Tom_Roche at pobox.com>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From giuseppe.amatulli at gmail.com  Fri Nov  2 00:23:01 2012
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Thu, 1 Nov 2012 18:23:01 -0500
Subject: [R-sig-Geo] Introduction to WELD Products Using Open Source Software
Message-ID: <CAKoiDHJhkvSc2G1ThqtzEUVWvTUHGS-Xbb1AsJW0ppBN4T35pA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121101/4838d8dc/attachment.pl>

From r.turner at auckland.ac.nz  Fri Nov  2 08:25:44 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 02 Nov 2012 20:25:44 +1300
Subject: [R-sig-Geo] countingweights?
In-Reply-To: <SNT124-W605AF49D168096D62AD14BD1600@phx.gbl>
References: <SNT124-W605AF49D168096D62AD14BD1600@phx.gbl>
Message-ID: <50937578.4020207@auckland.ac.nz>

On 01/11/12 18:22, salma anwar wrote:
>
> Hi, I am trying  to fit a "Area-Interaction" point process model to my data consisting of log-landing locations in a forest. I get the following warning message alongwith the result of the fitting: "1: In countingweights(id, areas) :
>    Some tiles with zero area contain points
> 2: In countingweights(id, areas) : Some weights are zero" Could you please guide me as to what error this message indicates? Thanks!                		 	   		
>

They aren't errors, they are warnings.  *Usually* they are not anything 
to really
worry about.  They arise when the observation window of the pattern has some
peculiarities; either it is a very "irregular" polygon (usually with 
many edges) or
a window of type "mask".

*Sometimes* the warnings can be made to go away by using a finer grid 
--- set
the argument "nd" of ppm() to a large value --- larger than the default; 
e.g.
to 256 or 512.  (This will have the impact of slowing down the calculations
substantially.)  Sometimes refining the pixellation of the mask type window
(or converting a polygonal window to a mask type window, with a fine 
pixellation)
will make the warnings go away.

However, as I said initially, it *usually* doesn't matter.

Note that the fact that you are fitting an area-interaction model is of no
relevance.  You'd get the same warnings fitting any model, including a
Poisson model if you set forcefit=TRUE.

     cheers,

         Rolf Turner


From osoong+r at gmail.com  Fri Nov  2 09:03:25 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Fri, 2 Nov 2012 01:03:25 -0700
Subject: [R-sig-Geo] readGDAL loses datum
Message-ID: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>

R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.

grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
+x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
+towgs84=0,0,0")
img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
img1.file <- file.path(tempdir(), "img1.tif")
writeGDAL(img1, img1.file)
img2 <- readGDAL(img1.file)
img2.file <- file.path(tempdir(), "img2.tif")
writeGDAL(img2, img2.file)
img1 at proj4string
img2 at proj4string

For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
not.  Not surprisingly, if I look at both files in Arc, img1 has a
defined datum and img2 does not.

Am I doing anything wrong?

Oliver


From Adrian.Baddeley at csiro.au  Fri Nov  2 09:36:21 2012
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 2 Nov 2012 16:36:21 +0800
Subject: [R-sig-Geo] countingweights?
In-Reply-To: <mailman.17.1351767603.28095.r-sig-geo@r-project.org>
References: <mailman.17.1351767603.28095.r-sig-geo@r-project.org>
Message-ID: <57DC18C299094D4299F837570C5DF1C50103F4EB896B@EXWA-MBX01.nexus.csiro.au>

salma anwar <salmaaries at hotmail.com> writes:

> Hi, I am trying  to fit a "Area-Interaction" point process model 
> to my data consisting of log-landing locations in a forest. 
> I get the following warning message along with the result of 
> the fitting: 
> "1: In countingweights(id, areas) :   Some tiles with zero area contain points
> 2: In countingweights(id, areas) : Some weights are zero" 
> Could you please guide me as to what error this message indicates? Thanks!   

This is about the package 'spatstat' and specifically about the model-fitting function for point processes, 'ppm'.

Basically this warning means that there might be some inaccuracy in the fitted model and you should consider whether to use a finer resolution.

'ppm' uses a discrete approximation to the likelihood or composite likelihood that involves a set of 'dummy' or sample points in the study region (called the "quadrature scheme"). By default, this approximation uses 'counting weights' which are computed by dividing the study region into pieces called 'tiles' and counting the number of data or dummy points that fall in each tile. 

If this process is performed using the default settings without any control, then it can happen that one of the tiles is very small - for example if your study region is an irregular shape, or if you use a spatial covariate on a very irregular region. In the latter case, it can happen that one of the tiles has zero digital area (digital area is the number of pixels in the tile) but nevertheless is not empty. Then you can get this error message.

The default settings for the discrete approximation are set to a relatively coarse approximation so that the package can be checked in a reasonable time (otherwise CRAN complains). These settings are not necessarily appropriate for every dataset. 

To increase the resolution of the discrete approximation you can increase the argument 'nd' in the call to ppm, or you can set the value of spatstat.options(ndummy.min). Alternatively you can use quadscheme() to control the approximation completely.

Adrian Baddeley

Prof Adrian Baddeley FAA
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Skype: adrian.baddeley
 


From edzer.pebesma at uni-muenster.de  Fri Nov  2 10:07:42 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 02 Nov 2012 10:07:42 +0100
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <1351779673999-7581537.post@n2.nabble.com>
References: <1351779673999-7581537.post@n2.nabble.com>
Message-ID: <50938D5E.9010004@uni-muenster.de>

Corey, we've reported some work on ST geostatistics in:

http://cran.r-project.org/web/packages/sp/vignettes/st.pdf

and air quality interpolations in

http://acm.eionet.europa.eu/reports/ETCACM_TP_2011_10_spatio-temp_AQinterpolation
which has data and scripts in
http://ifgi.uni-muenster.de/~b_grae02/ETC-ACM/

Further, some work on spatio-temporal regression models in:

Giovana M. de Espindola, Edzer Pebesma, Gilberto C?mara, 2011.
Spatio-temporal regression models for deforestation in the Brazilian
Amazon. STDM 2011, The International Symposium on Spatial-Temporal
Analysis and Data Mining, University College London - 18th-20th July 2011
http://ifgi.uni-muenster.de/~epebe_01/sar.pdf

for the latter, I didn't publish scripts so far.

On 11/01/2012 03:21 PM, Corey Sparks wrote:
> Dear List,
> I've recently began doing more spatio-temporal analysis using hierarchical
> Bayesian methods, mostly in Win/OpenBUGS and INLA.  
> 
> I really like the capabilities of the spacetime package in terms of building
> data that incorporate multiple temporal observations of the same units (I
> work  mostly with county and census geographies in the US). 
> 
> I am curious if the list can point me to some other libraries in R, besides
> INLA, that are capable of using the spacetime data directly in a regression
> framework, or perhaps in a spatio-temporal disease clustering framework. I
> know about the DCluster library and use it some, but would be very grateful
> for any other ideas.
> Best, 
> Corey
> 
> 
> 
> -----
> Corey Sparks
> Assistant professor
> Department of Demography
> The University of Texas at San Antonio
> 501 West Cesar E Chavez Blvd
> San Antonio TX 78207
> Corey.sparks 'at' utsa.edu
> 210 458 3166 &lt;tel:210%20458%203166&gt;
> Latitude: 29.423614  /  Longitude: -98.504282
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Question-about-space-time-analysis-routines-tp7581537.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Nov  2 10:24:46 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 Nov 2012 10:24:46 +0100
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>

On Fri, 2 Nov 2012, Oliver Soong wrote:

> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>
> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
> +towgs84=0,0,0")
> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
> img1.file <- file.path(tempdir(), "img1.tif")
> writeGDAL(img1, img1.file)
> img2 <- readGDAL(img1.file)
> img2.file <- file.path(tempdir(), "img2.tif")
> writeGDAL(img2, img2.file)
> img1 at proj4string
> img2 at proj4string
>
> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
> not.  Not surprisingly, if I look at both files in Arc, img1 has a
> defined datum and img2 does not.
>
> Am I doing anything wrong?

No, but it isn't obvious:

p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
+x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs")

gives on re-reading:

> img2 at proj4string
CRS arguments:
  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
+datum=NAD27 +units=m +no_defs +ellps=clrk66
+nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat

So:

   oSRS.importFromWkt( &pszSRS_WKT );
   oSRS.exportToProj4( &pszSRS_WKT );

in RGDAL_GetProjectionRef() in src/gdal-bindings.cpp sees that input 
+datum=NAD83 is equivalent to +towgs84=0,0,0,0,0,0,0 on output. So the 
descriptions are not string-equivalent, but are equivalent through 
+towgs84=0,0,0,0,0,0,0. If you run with your p4s, on a system with 
gdalinfo:

> system(paste("gdalinfo", img1.file))
Driver: GTiff/GeoTIFF
Files: /tmp/Rtmp9j2vOr/img1.tif
Size is 1, 1
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.2572221010002,
                 AUTHORITY["EPSG","7019"]],
             TOWGS84[0,0,0,0,0,0,0],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4269"]],
     PROJECTION["Albers_Conic_Equal_Area"],
     PARAMETER["standard_parallel_1",29.5],
     PARAMETER["standard_parallel_2",45.5],
     PARAMETER["latitude_of_center",23],
     PARAMETER["longitude_of_center",-96],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]

...

so the simplification is happening on conversion to Proj4 on reading.

I agree that on re-export that the WKT and Proj4 versions diverge, so:

> system(paste("gdalinfo", img2.file))
Driver: GTiff/GeoTIFF
Files: /tmp/RtmpMhPgqf/img2.tif
Size is 1, 1
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["GRS 1980(IUGG, 1980)",
         DATUM["unknown",
             SPHEROID["GRS80",6378137,298.257222101],
             TOWGS84[0,0,0,0,0,0,0]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Albers_Conic_Equal_Area"],
     PARAMETER["standard_parallel_1",29.5],
     PARAMETER["standard_parallel_2",45.5],
     PARAMETER["latitude_of_center",23],
     PARAMETER["longitude_of_center",-96],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]

with the correct parameters, but no datum name tag. You get around this 
manually by adding the +datum= back in:

proj4string(img2) <- CRS(paste(proj4string(img2), "+datum=NAD83"))
writeGDAL(img2, img2.file)

> system(paste("gdalinfo", img2.file))
Driver: GTiff/GeoTIFF
Files: /tmp/RtmpMhPgqf/img2.tif
Size is 1, 1
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.2572221010002,
                 AUTHORITY["EPSG","7019"]],
             TOWGS84[0,0,0,0,0,0,0],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4269"]],
     PROJECTION["Albers_Conic_Equal_Area"],
     PARAMETER["standard_parallel_1",29.5],
     PARAMETER["standard_parallel_2",45.5],
     PARAMETER["latitude_of_center",23],
     PARAMETER["longitude_of_center",-96],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]

I would appeal to any programmer with a little time to see how the step 
between:

   oSRS.importFromWkt( &pszSRS_WKT );
   oSRS.exportToProj4( &pszSRS_WKT );

and the R output might be checked. The content of pszSRS_WKT is OK before 
entering importFromWkt(), but is simplified on exit from exportToProj4(). 
The comparable part of gdal/gdal-1.9.2/apps/gdalinfo.c is around lines 
263-274.

The writing operation appears to be OK from your example.

Roger


>
> Oliver
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From corey.sparks at UTSA.EDU  Fri Nov  2 12:29:13 2012
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Fri, 2 Nov 2012 04:29:13 -0700 (PDT)
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <50938D5E.9010004@uni-muenster.de>
References: <1351779673999-7581537.post@n2.nabble.com>
	<50938D5E.9010004@uni-muenster.de>
Message-ID: <1351855753073-7581553.post@n2.nabble.com>

Thanks Edzer,
The latter was really what I was looking for, specifically the
spatio-temporal SAR models you describe. I assume that in order to generate
the weights, you take the traditional neighbor lists generated by:

nbs<-poly2nb(shapefile)

and modify them to incorporate time as well?
Best,

Corey



-----
Corey Sparks
Assistant professor
Department of Demography
The University of Texas at San Antonio
501 West Cesar E Chavez Blvd
San Antonio TX 78207
Corey.sparks 'at' utsa.edu
210 458 3166 &lt;tel:210%20458%203166&gt;
Latitude: 29.423614  /  Longitude: -98.504282
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Question-about-space-time-analysis-routines-tp7581537p7581553.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From nnagle at utk.edu  Fri Nov  2 12:34:53 2012
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Fri, 2 Nov 2012 11:34:53 +0000
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <mailman.13.1351854003.9519.r-sig-geo@r-project.org>
References: <mailman.13.1351854003.9519.r-sig-geo@r-project.org>
Message-ID: <4291537D-DE50-4381-BFF6-62837E6F80FD@utk.edu>

Corey,

You might also look at Simon Wood's mgcv package.  It is a general purpose Generalized Additive Model package.  There is a way to specify a Conditional Autoregressive Model in space.  And you can interact this with temporal autocorrelation (or equivalently, with temporal splines).  And, since it is based on generalized linear modeling, You can easily specify Poisson type models, which might be important to you in disease rate modeling.

Of course, the problem with this much flexibility is that you can easily create poorly specified models.

Nicholas Nagle

Assistant Professor
Department of Geography
University of Tennessee, Knoxville

On Nov 2, 2012, at 7:07 AM, "r-sig-geo-request at r-project.org" <r-sig-geo-request at r-project.org> wrote:

> Question about space-time analysis routines


From paolo.piras at uniroma3.it  Fri Nov  2 12:57:55 2012
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Fri, 2 Nov 2012 11:57:55 +0000
Subject: [R-sig-Geo] spatial regression model
In-Reply-To: <5092800F.9090900@cornell.edu>
References: <CANkFkEeMuxORQtbJ5LxLeH65BZran54JLkRE6rvRHPG57yZS0Q@mail.gmail.com>,
	<5092800F.9090900@cornell.edu>
Message-ID: <A7557249237BD449977E3AEE33C62AD317D8BEF9@DBXPRD0410MB394.eurprd04.prod.outlook.com>

Dear Zia and all those that answered me,
thankyou very much for your advices; I will surely include them  in my analyses
thankyou again
paolo
________________________________________
Da: Zia Ahmed [zua3 at cornell.edu]
Inviato: gioved? 1 novembre 2012 14.58
A: Arnaud Mosnier
Cc: Paolo Piras; r-sig-geo at r-project.org
Oggetto: Re: [R-sig-Geo] spatial regression model

You can evaluate the proportion of the variance explained by spatial
structure by  log-likelihood test-  between spatial model and a model
with intercept:
suppose:

library(lnlme)

M1<-lme(response~ predictots+...., method="REML", correlation=corExp(form=~x+y, nugget=T), data=yourdata) # model with spatial structure
Mo<-gls(response~1,method = "REML",data=yourdata) # model with intercept only
anova(M1, Mo) # Compare two models

a<-logLiklehood value of M1
b<-logLiklehood value of Mo
n<- nrow(yourdata)

R2<- (1 - exp((-2/n)*( -a -b)))   # log-likelihood R^2 for M1


On 11/1/2012 8:48 AM, Arnaud Mosnier wrote:
> Paolo,
>
> Using GLS seems a good approach for what you want to do.
> However, as its names indicates GLS models does not use the OLS approach,
> so you can't use the "classic" R square interpretation.
>
> I would follow these steps (but if I am wrong please feel free to correct
> me !!).
> 1) Run your model in GLS without the spatial structure.
> 2) Make a variogram with your residuals (in order to see what kind of
> spatial structure you need)
> 3) Run your model in GLS with the spatial structure (using corStruct)
> 4) Compare AICs to see if including the spatial structure improve your
> model (you can also use AICs to test several spatial structures and find
> the best).
>
> However, I don't know how to evaluate the proportion of the variance
> explained by the spatial structure. If someone have the information, I
> would be pleased to learn !
>
> Arnaud
>
>
> ------------------------------------------------------
>
> Dear community
>
> I write to pose a question about the best way to incorporate spatial non
> independence in a regression model that has multivariate responses and
> multiple predictors. I would like to estimate the global R-sq under OLS and
> its significance (no problem for that..) and compare it when incorporating
> spatial non independence.
> My response are PCs (about 6 or 7)  of trait measured (actually coming from
> Geometric Morhometrics data) on teeh shape on 16 populations. I will use
> population means for my analyses. I'm not interested in exploring single
> spatial structure of single responses or single predictors (that could be
> different); rather I look for  for a GLOBAL assessment of the model in term
> of significance and, POSSIBLY, in term of variance explained by spatial
> structure. However, I would prefer to avoid the eigenvector filtering on
> the basis of some seminal literature:
>
> (i.e:
> Beale, C. M., J. J. Lennon, J. M. Yearsley, M. J. Brewer, and D. A. Elston.
> 2010. Regression analysis of spatial data. Ecology Letters 13:246
> Rob P. Freckleton, Natalie Cooper, Walter Jetz, Associate Editor: Gregory
> D. D Comparative Methods as a Statistical Fix: The Dangers of Ignoring an
> Evolutionary Model. 2011. The American Naturalist)
>
> My predictors are climatic and soil variables.Multicollinearities are
> controlled performing within each block a PCA and retaining all PCs
> explaining at least 90% of variance.
> So...I thought  to use a gls procedure with a spatial covariance as
> corStructure term or to the package spgwr; however, I'm not sure about the
> possibility to include multivariate response in spgwr.
> Being relatively new in this type of analyses I wrote you in order to have
> some useful suggestions about my model.
> Thankyou in advance
> Paolo Piras
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
---------------------
Zia Ahmed, PhD
Research Associate
Department of Crop and Soil Sciences
1002 Bradfield Hall, Cornell University
Ithaca, NY 14853-4203
t. 607.255.9387
f. 607.255.3207
email zua3 at cornell.edu





From zbynek.janoska at centrum.cz  Fri Nov  2 14:04:31 2012
From: zbynek.janoska at centrum.cz (zbynek.janoska at centrum.cz)
Date: Fri, 2 Nov 2012 06:04:31 -0700 (PDT)
Subject: [R-sig-Geo] Kriging of values distributed on line
Message-ID: <1351861471210-7581559.post@n2.nabble.com>

Hello,

perhaps I am asking for something obvious, but I would like to perform
interpolation of values, which are distributed on the line. my dataset
consists of two vectors: stationing (distance from origin) and values.
I would like to krige the values to obtain smooothed curve with variance
estimates.

First thing I would thing of doing, is to transform stationing into two
dimensional points (x=stationing, y=zeros) and to perform kriging as usual.
However, I am not sure, if this procedure is correct, and I can not find a
way to perform kriging of points on the line using packages gstat or rgeo,
which I usually use.

Any help or direction where to look would be appreciated.

Below is example of my data

Thanks,
Zbynek

> dput(linedata[1:50,])
structure(list(dist = c(0, 11.2800709216506, 22.0504005359196, 
34.490657768126, 47.3296608447357, 62.2641846066267, 76.2888058138145, 
92.6607330062524, 109.936149065093, 121.724278687636, 134.66298032256, 
151.482314435605, 171.706062851761, 196.025602320903, 218.497807375147, 
240.858487150145, 290.944014001843, 336.594862843896, 368.801228674272, 
385.537118253217, 411.595514213105, 451.732280400594, 497.242828628585, 
520.615676123105, 542.359870750547, 621.08089716662, 693.351499765505, 
733.295961208736, 767.154638087923, 812.663318578618, 838.17880407268, 
866.77880407254, 894.949888538801, 947.5878976196, 964.187897619693, 
976.363693281579, 986.73480701161, 998.052492287232, 1027.60735652313, 
1050.68570135112, 1063.82381384872, 1075.09501609169, 1086.18374911208, 
1115.63353688717, 1139.86657219042, 1159.27301441961, 1179.15365827232, 
1198.9213086133, 1225.76176315483, 1272.772400249), val = c(NA, 
NA, 0.908160651409972, 0.871501182963617, 0.918368640158739, 
0.535216008816336, 0.949021011317396, 0.973433687159185, 0.976070428632721, 
0.802086031449843, 0.961906084900447, 0.967220590046406, 0.97692016190632, 
0.73837288344605, 0.803375801850693, 0.96357872833355, 0.944930467022756, 
0.523655970604211, 0.00738153445264014, 0.0768875597281344,
0.445633626058785, 
0.920272743496457, 0.486084005381625, 0.0267197415075827, 0.161488140793818, 
0.533492819032941, 0.780736244753444, 0.117253233499661, 0.349786014519948, 
0.853346494457695, 0.615928981211447, 0.38897304499115, 0.887739425294155, 
0.748869234397016, 0.204990476432674, 0.963361133937722, 0.914181073306763, 
0.878624741707031, 0.907694604916518, 0.95382032345456, 0.964164531499797, 
0.962783600058143, 0.90797701844016, 0.890780300868731, 0.931906872733242, 
0.856026387027286, 0.68907649322984, 0.638278881901186, 0.681647064000946, 
0.649443287250305)), .Names = c("dist", "val"), row.names = c(NA, 
50L), class = "data.frame")



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Kriging-of-values-distributed-on-line-tp7581559.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From christian.levers at geo.hu-berlin.de  Fri Nov  2 18:35:52 2012
From: christian.levers at geo.hu-berlin.de (Christian Levers)
Date: Fri, 02 Nov 2012 18:35:52 +0100
Subject: [R-sig-Geo] raster package - zonal - standard deviations
Message-ID: <50940478.5000504@geo.hu-berlin.de>

Hello,

I am using the raster package to calculate zonal statistics for my stack 
of ca. 50 rasters (each raster is about 33 mio. pixels) and I am 
wondering if there is a simple way to calculate standard deviations for 
the zones since "sd" is not implemented in the presets for the "stat" 
argument. If not, I guess defining a function which calculates std.dev 
is the easiest solution.

Thanks in advance and a nice weekend,
Christian

-- 
MSc Geogr. Christian Levers
Doctoral Researcher

Biogeography & Conservation Biology
Geography Department | Humboldt-Universitaet zu Berlin

eMail:  christian.levers at geo.hu-berlin.de
phone:  +49 (0) 30 2093 9341
fax:    +49 (0) 30 2093 6848
mail:   Unter den Linden 6 | 10099 Berlin | Germany
web:    http://www.geographie.hu-berlin.de


From adrian.aw.cartier at monsanto.com  Fri Nov  2 19:39:17 2012
From: adrian.aw.cartier at monsanto.com (CARTIER, ADRIAN AW (AG/1000))
Date: Fri, 2 Nov 2012 18:39:17 +0000
Subject: [R-sig-Geo] searching a Delaunay triangulation for nearest neighbor
Message-ID: <C376B5269AE7054A82BD87C218BF16BF33473F@stlwexmbxprd04.na.ds.monsanto.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121102/eec30213/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Nov  2 20:38:27 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 2 Nov 2012 19:38:27 +0000
Subject: [R-sig-Geo] searching a Delaunay triangulation for nearest
	neighbor
In-Reply-To: <b4071ecdeb2448e9acbf48684729a37a@EX-0-HT0.lancs.local>
References: <b4071ecdeb2448e9acbf48684729a37a@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMNMbeg5es129P6pRx+A3t6kE1w01U=8zm5EBif7rc+TQ@mail.gmail.com>

On Fri, Nov 2, 2012 at 6:39 PM, CARTIER, ADRIAN AW (AG/1000)
<adrian.aw.cartier at monsanto.com> wrote:
> All,
>
> I am looking for a solution to search a triangulation for the point closest to a centroid of a collection of polygons. MATLAB has functionality called dsearch. I was wondering if there was a similar.
>
> Here is the set up vector xcoord of x-coordinates, ycoord of y coordinates, Tri, the Delaunay triangulation of those (3X3 matrix), cent_x,vector of x coordinates of the centroid of polygons, cent_y vector of y coordinates of polygons.
>
> I want a list of the nearest neighbors (x,y) to (cent_x,cent_y) but I want to search the triangulation to find this.
>
> I hope this makes sense. Thanks in advance.

 Doesn't make any sense to me... Let's try again...

 You have one set of points, (xcoord,ycoord), and another set of
points (cent_x, cent_y). Yes? It seems irrelevant that cent_x and
cent_y are polygon centroids. Yes?

 You want the nearest neighbours to each of cent_x, cent_y, but you
don't say what set of points the neighbours are from. From
xcoord,ycoord? From cent_x, cent_y? You don't say. You also don't say
how many nearest neighbours you want or if there's any other
threshold.

 And then you say 'search the triangulation' which is pretty
meaningless. Do you want the nearest points on the lines of the
triangulation? Are we talking about nearest point-to-line distance? So
that would be just one distance per cent_x,cent_y?

 Care to clarify?

Barry


From osoong+r at gmail.com  Fri Nov  2 21:14:58 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Fri, 2 Nov 2012 13:14:58 -0700
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
	<alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
Message-ID: <CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>

I agree it seems to be happening when converting WKT to Proj4.
However, is this more of a GDAL bug?

> system(paste("gdalinfo -proj4", img1.file))
[...]
PROJ.4 string is:
'+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs '

It looks to me like the datum is getting dropped by:
 OSRExportToProj4( hSRS, &pszProj4 );
This being what rgdal seems to use.

I'm sadly less familiar with Proj4 than I ought to be to be talking
about this, but it strikes me that if this is indeed a bug and not a
"feature", then it would make more sense to fix
OSRExportToProj4/OGRSpatialReference::exportToProj4.

Oliver


On Fri, Nov 2, 2012 at 2:24 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Fri, 2 Nov 2012, Oliver Soong wrote:
>
>> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>>
>> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
>> +towgs84=0,0,0")
>> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
>> img1.file <- file.path(tempdir(), "img1.tif")
>> writeGDAL(img1, img1.file)
>> img2 <- readGDAL(img1.file)
>> img2.file <- file.path(tempdir(), "img2.tif")
>> writeGDAL(img2, img2.file)
>> img1 at proj4string
>> img2 at proj4string
>>
>> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
>> not.  Not surprisingly, if I look at both files in Arc, img1 has a
>> defined datum and img2 does not.
>>
>> Am I doing anything wrong?
>
>
> No, but it isn't obvious:
>
>
> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
> +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs")
>
> gives on re-reading:
>
>> img2 at proj4string
>
> CRS arguments:
>
>  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
> +datum=NAD27 +units=m +no_defs +ellps=clrk66
> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>
> So:
>
>   oSRS.importFromWkt( &pszSRS_WKT );
>   oSRS.exportToProj4( &pszSRS_WKT );
>
> in RGDAL_GetProjectionRef() in src/gdal-bindings.cpp sees that input
> +datum=NAD83 is equivalent to +towgs84=0,0,0,0,0,0,0 on output. So the
> descriptions are not string-equivalent, but are equivalent through
> +towgs84=0,0,0,0,0,0,0. If you run with your p4s, on a system with gdalinfo:
>
>> system(paste("gdalinfo", img1.file))
>
> Driver: GTiff/GeoTIFF
> Files: /tmp/Rtmp9j2vOr/img1.tif
> Size is 1, 1
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             TOWGS84[0,0,0,0,0,0,0],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Albers_Conic_Equal_Area"],
>     PARAMETER["standard_parallel_1",29.5],
>     PARAMETER["standard_parallel_2",45.5],
>     PARAMETER["latitude_of_center",23],
>     PARAMETER["longitude_of_center",-96],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
>
> ...
>
> so the simplification is happening on conversion to Proj4 on reading.
>
> I agree that on re-export that the WKT and Proj4 versions diverge, so:
>
>> system(paste("gdalinfo", img2.file))
>
> Driver: GTiff/GeoTIFF
> Files: /tmp/RtmpMhPgqf/img2.tif
> Size is 1, 1
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["GRS 1980(IUGG, 1980)",
>         DATUM["unknown",
>             SPHEROID["GRS80",6378137,298.257222101],
>             TOWGS84[0,0,0,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Albers_Conic_Equal_Area"],
>     PARAMETER["standard_parallel_1",29.5],
>     PARAMETER["standard_parallel_2",45.5],
>     PARAMETER["latitude_of_center",23],
>     PARAMETER["longitude_of_center",-96],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
>
> with the correct parameters, but no datum name tag. You get around this
> manually by adding the +datum= back in:
>
> proj4string(img2) <- CRS(paste(proj4string(img2), "+datum=NAD83"))
> writeGDAL(img2, img2.file)
>
>> system(paste("gdalinfo", img2.file))
>
> Driver: GTiff/GeoTIFF
> Files: /tmp/RtmpMhPgqf/img2.tif
> Size is 1, 1
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             TOWGS84[0,0,0,0,0,0,0],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Albers_Conic_Equal_Area"],
>     PARAMETER["standard_parallel_1",29.5],
>     PARAMETER["standard_parallel_2",45.5],
>     PARAMETER["latitude_of_center",23],
>     PARAMETER["longitude_of_center",-96],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
>
> I would appeal to any programmer with a little time to see how the step
> between:
>
>   oSRS.importFromWkt( &pszSRS_WKT );
>   oSRS.exportToProj4( &pszSRS_WKT );
>
> and the R output might be checked. The content of pszSRS_WKT is OK before
> entering importFromWkt(), but is simplified on exit from exportToProj4().
> The comparable part of gdal/gdal-1.9.2/apps/gdalinfo.c is around lines
> 263-274.
>
> The writing operation appears to be OK from your example.
>
> Roger
>
>
>>
>> Oliver
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>


From Roger.Bivand at nhh.no  Fri Nov  2 22:51:04 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 Nov 2012 22:51:04 +0100
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
	<alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
	<CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211022232480.20436@reclus.nhh.no>

On Fri, 2 Nov 2012, Oliver Soong wrote:

> I agree it seems to be happening when converting WKT to Proj4.
> However, is this more of a GDAL bug?
>
>> system(paste("gdalinfo -proj4", img1.file))
> [...]
> PROJ.4 string is:
> '+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
> +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs '
>
> It looks to me like the datum is getting dropped by:
> OSRExportToProj4( hSRS, &pszProj4 );
> This being what rgdal seems to use.

Yes, but do we know that hSRS contains these tags, since they have been 
imported from WKT to the internal representation? The description of the 
import from WKT process suggests that it will terminate before processing 
the whole string if the description is already "complete":

http://www.gdal.org/ogr/classOGRSpatialReference.html#ab74cfc985bd05404a4c61d2d633a6343

I tried adding morphFromESRI() before exporting to Proj4, but the problem 
is not resolved. Perhaps the gdal-dev list is where to ask?

Roger

>
> I'm sadly less familiar with Proj4 than I ought to be to be talking
> about this, but it strikes me that if this is indeed a bug and not a
> "feature", then it would make more sense to fix
> OSRExportToProj4/OGRSpatialReference::exportToProj4.
>
> Oliver
>
>
> On Fri, Nov 2, 2012 at 2:24 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Fri, 2 Nov 2012, Oliver Soong wrote:
>>
>>> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>>>
>>> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
>>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>>> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
>>> +towgs84=0,0,0")
>>> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
>>> img1.file <- file.path(tempdir(), "img1.tif")
>>> writeGDAL(img1, img1.file)
>>> img2 <- readGDAL(img1.file)
>>> img2.file <- file.path(tempdir(), "img2.tif")
>>> writeGDAL(img2, img2.file)
>>> img1 at proj4string
>>> img2 at proj4string
>>>
>>> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
>>> not.  Not surprisingly, if I look at both files in Arc, img1 has a
>>> defined datum and img2 does not.
>>>
>>> Am I doing anything wrong?
>>
>>
>> No, but it isn't obvious:
>>
>>
>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>> +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs")
>>
>> gives on re-reading:
>>
>>> img2 at proj4string
>>
>> CRS arguments:
>>
>>  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>> +datum=NAD27 +units=m +no_defs +ellps=clrk66
>> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>>
>> So:
>>
>>   oSRS.importFromWkt( &pszSRS_WKT );
>>   oSRS.exportToProj4( &pszSRS_WKT );
>>
>> in RGDAL_GetProjectionRef() in src/gdal-bindings.cpp sees that input
>> +datum=NAD83 is equivalent to +towgs84=0,0,0,0,0,0,0 on output. So the
>> descriptions are not string-equivalent, but are equivalent through
>> +towgs84=0,0,0,0,0,0,0. If you run with your p4s, on a system with gdalinfo:
>>
>>> system(paste("gdalinfo", img1.file))
>>
>> Driver: GTiff/GeoTIFF
>> Files: /tmp/Rtmp9j2vOr/img1.tif
>> Size is 1, 1
>> Coordinate System is:
>> PROJCS["unnamed",
>>     GEOGCS["NAD83",
>>         DATUM["North_American_Datum_1983",
>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>                 AUTHORITY["EPSG","7019"]],
>>             TOWGS84[0,0,0,0,0,0,0],
>>             AUTHORITY["EPSG","6269"]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433],
>>         AUTHORITY["EPSG","4269"]],
>>     PROJECTION["Albers_Conic_Equal_Area"],
>>     PARAMETER["standard_parallel_1",29.5],
>>     PARAMETER["standard_parallel_2",45.5],
>>     PARAMETER["latitude_of_center",23],
>>     PARAMETER["longitude_of_center",-96],
>>     PARAMETER["false_easting",0],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]]]
>>
>> ...
>>
>> so the simplification is happening on conversion to Proj4 on reading.
>>
>> I agree that on re-export that the WKT and Proj4 versions diverge, so:
>>
>>> system(paste("gdalinfo", img2.file))
>>
>> Driver: GTiff/GeoTIFF
>> Files: /tmp/RtmpMhPgqf/img2.tif
>> Size is 1, 1
>> Coordinate System is:
>> PROJCS["unnamed",
>>     GEOGCS["GRS 1980(IUGG, 1980)",
>>         DATUM["unknown",
>>             SPHEROID["GRS80",6378137,298.257222101],
>>             TOWGS84[0,0,0,0,0,0,0]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433]],
>>     PROJECTION["Albers_Conic_Equal_Area"],
>>     PARAMETER["standard_parallel_1",29.5],
>>     PARAMETER["standard_parallel_2",45.5],
>>     PARAMETER["latitude_of_center",23],
>>     PARAMETER["longitude_of_center",-96],
>>     PARAMETER["false_easting",0],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]]]
>>
>> with the correct parameters, but no datum name tag. You get around this
>> manually by adding the +datum= back in:
>>
>> proj4string(img2) <- CRS(paste(proj4string(img2), "+datum=NAD83"))
>> writeGDAL(img2, img2.file)
>>
>>> system(paste("gdalinfo", img2.file))
>>
>> Driver: GTiff/GeoTIFF
>> Files: /tmp/RtmpMhPgqf/img2.tif
>> Size is 1, 1
>> Coordinate System is:
>> PROJCS["unnamed",
>>     GEOGCS["NAD83",
>>         DATUM["North_American_Datum_1983",
>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>                 AUTHORITY["EPSG","7019"]],
>>             TOWGS84[0,0,0,0,0,0,0],
>>             AUTHORITY["EPSG","6269"]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433],
>>         AUTHORITY["EPSG","4269"]],
>>     PROJECTION["Albers_Conic_Equal_Area"],
>>     PARAMETER["standard_parallel_1",29.5],
>>     PARAMETER["standard_parallel_2",45.5],
>>     PARAMETER["latitude_of_center",23],
>>     PARAMETER["longitude_of_center",-96],
>>     PARAMETER["false_easting",0],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]]]
>>
>> I would appeal to any programmer with a little time to see how the step
>> between:
>>
>>   oSRS.importFromWkt( &pszSRS_WKT );
>>   oSRS.exportToProj4( &pszSRS_WKT );
>>
>> and the R output might be checked. The content of pszSRS_WKT is OK before
>> entering importFromWkt(), but is simplified on exit from exportToProj4().
>> The comparable part of gdal/gdal-1.9.2/apps/gdalinfo.c is around lines
>> 263-274.
>>
>> The writing operation appears to be OK from your example.
>>
>> Roger
>>
>>
>>>
>>> Oliver
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pazurrobert at gmail.com  Sat Nov  3 00:23:32 2012
From: pazurrobert at gmail.com (Robert Pazur)
Date: Sat, 3 Nov 2012 00:23:32 +0100
Subject: [R-sig-Geo] polygon to raster -"adjusted" method
In-Reply-To: <CANtt_hwpENYQ2q8Jadb-H-SYEPpqncd+WzBaN3EhQE2se-RNZg@mail.gmail.com>
References: <CAJP9LR7XuEd_jxE8g1f8fmaO6LicSYHXDtFWfhyxm57FVqkchg@mail.gmail.com>
	<CANtt_hwai6fcK3fp9H_ADKgq5Wd6rYnKCRk3Bx2_8xzvbvfAFA@mail.gmail.com>
	<CAJP9LR49zWMMR_d0PmBXU2u3U3w3E_N4A4GcFGwpYiZe6E-h2g@mail.gmail.com>
	<CANtt_hwpENYQ2q8Jadb-H-SYEPpqncd+WzBaN3EhQE2se-RNZg@mail.gmail.com>
Message-ID: <CAJP9LR6uSi3b9+MnDDHNnBRtAb-oQQ05CKxy2HS0csA=-i1m7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121103/68236b13/attachment.pl>

From Roger.Bivand at nhh.no  Sat Nov  3 14:59:08 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 Nov 2012 14:59:08 +0100
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <alpine.LRH.2.02.1211022232480.20436@reclus.nhh.no>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
	<alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
	<CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>
	<alpine.LRH.2.02.1211022232480.20436@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1211031449570.22561@reclus.nhh.no>

On Fri, 2 Nov 2012, Roger Bivand wrote:

> On Fri, 2 Nov 2012, Oliver Soong wrote:
>
>> I agree it seems to be happening when converting WKT to Proj4.
>> However, is this more of a GDAL bug?
>> 
>>> system(paste("gdalinfo -proj4", img1.file))
>> [...]
>> PROJ.4 string is:
>> '+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>> +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs '
>> 
>> It looks to me like the datum is getting dropped by:
>> OSRExportToProj4( hSRS, &pszProj4 );
>> This being what rgdal seems to use.
>
> Yes, but do we know that hSRS contains these tags, since they have been 
> imported from WKT to the internal representation? The description of the 
> import from WKT process suggests that it will terminate before processing the 
> whole string if the description is already "complete":
>
> http://www.gdal.org/ogr/classOGRSpatialReference.html#ab74cfc985bd05404a4c61d2d633a6343
>
> I tried adding morphFromESRI() before exporting to Proj4, but the problem is 
> not resolved. Perhaps the gdal-dev list is where to ask?

I've committed to the rgdal R-Forge project a user argument to relevant 
functions in rgdal for setting the behaviour to datum-preserving, either 
on a case-by-case or global level. If the environment variable is present, 
it will have precedence and will not be overwritten. I'd welcome reports 
from those who can try out the source checked out from R-forge.

In your case, I now see:

> proj4string(readGDAL("img1.tif"))
img1.tif has GDAL driver GTiff
and has 1 rows and 1 columns
[1] " +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
> proj4string(readGDAL("img1.tif", 
OVERRIDE_PROJ_DATUM_WITH_TOWGS84=FALSE))
img1.tif has GDAL driver GTiff
and has 1 rows and 1 columns
[1] " +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 
+datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"

However, there does not seem to be a clear way to auto-detect and set the 
switch. The package also has a cached variable, so setting:

set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)

in an R session will use that value when raster projections are read until 
the setting is changed. The argument will not be used for GDAL < 1.8.0, 
because its use first appeared there. It will also not be used if an 
environment variable "OVERRIDE_PROJ_DATUM_WITH_TOWGS84" is found, to avoid 
overwriting its value.

This is the result of discussions on the gdal-dev list, thread starting 
at:

http://lists.osgeo.org/pipermail/gdal-dev/2012-November/034550.html

and details in:

http://trac.osgeo.org/gdal/ticket/4880

Roger

>
> Roger
>
>> 
>> I'm sadly less familiar with Proj4 than I ought to be to be talking
>> about this, but it strikes me that if this is indeed a bug and not a
>> "feature", then it would make more sense to fix
>> OSRExportToProj4/OGRSpatialReference::exportToProj4.
>> 
>> Oliver
>> 
>> 
>> On Fri, Nov 2, 2012 at 2:24 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>> On Fri, 2 Nov 2012, Oliver Soong wrote:
>>> 
>>>> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>>>> 
>>>> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
>>>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>>>> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
>>>> +towgs84=0,0,0")
>>>> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
>>>> img1.file <- file.path(tempdir(), "img1.tif")
>>>> writeGDAL(img1, img1.file)
>>>> img2 <- readGDAL(img1.file)
>>>> img2.file <- file.path(tempdir(), "img2.tif")
>>>> writeGDAL(img2, img2.file)
>>>> img1 at proj4string
>>>> img2 at proj4string
>>>> 
>>>> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
>>>> not.  Not surprisingly, if I look at both files in Arc, img1 has a
>>>> defined datum and img2 does not.
>>>> 
>>>> Am I doing anything wrong?
>>> 
>>> 
>>> No, but it isn't obvious:
>>> 
>>> 
>>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>>> +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs")
>>> 
>>> gives on re-reading:
>>> 
>>>> img2 at proj4string
>>> 
>>> CRS arguments:
>>>
>>>  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>>> +datum=NAD27 +units=m +no_defs +ellps=clrk66
>>> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>>> 
>>> So:
>>>
>>>   oSRS.importFromWkt( &pszSRS_WKT );
>>>   oSRS.exportToProj4( &pszSRS_WKT );
>>> 
>>> in RGDAL_GetProjectionRef() in src/gdal-bindings.cpp sees that input
>>> +datum=NAD83 is equivalent to +towgs84=0,0,0,0,0,0,0 on output. So the
>>> descriptions are not string-equivalent, but are equivalent through
>>> +towgs84=0,0,0,0,0,0,0. If you run with your p4s, on a system with 
>>> gdalinfo:
>>> 
>>>> system(paste("gdalinfo", img1.file))
>>> 
>>> Driver: GTiff/GeoTIFF
>>> Files: /tmp/Rtmp9j2vOr/img1.tif
>>> Size is 1, 1
>>> Coordinate System is:
>>> PROJCS["unnamed",
>>>     GEOGCS["NAD83",
>>>         DATUM["North_American_Datum_1983",
>>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>>                 AUTHORITY["EPSG","7019"]],
>>>             TOWGS84[0,0,0,0,0,0,0],
>>>             AUTHORITY["EPSG","6269"]],
>>>         PRIMEM["Greenwich",0],
>>>         UNIT["degree",0.0174532925199433],
>>>         AUTHORITY["EPSG","4269"]],
>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>     PARAMETER["standard_parallel_1",29.5],
>>>     PARAMETER["standard_parallel_2",45.5],
>>>     PARAMETER["latitude_of_center",23],
>>>     PARAMETER["longitude_of_center",-96],
>>>     PARAMETER["false_easting",0],
>>>     PARAMETER["false_northing",0],
>>>     UNIT["metre",1,
>>>         AUTHORITY["EPSG","9001"]]]
>>> 
>>> ...
>>> 
>>> so the simplification is happening on conversion to Proj4 on reading.
>>> 
>>> I agree that on re-export that the WKT and Proj4 versions diverge, so:
>>> 
>>>> system(paste("gdalinfo", img2.file))
>>> 
>>> Driver: GTiff/GeoTIFF
>>> Files: /tmp/RtmpMhPgqf/img2.tif
>>> Size is 1, 1
>>> Coordinate System is:
>>> PROJCS["unnamed",
>>>     GEOGCS["GRS 1980(IUGG, 1980)",
>>>         DATUM["unknown",
>>>             SPHEROID["GRS80",6378137,298.257222101],
>>>             TOWGS84[0,0,0,0,0,0,0]],
>>>         PRIMEM["Greenwich",0],
>>>         UNIT["degree",0.0174532925199433]],
>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>     PARAMETER["standard_parallel_1",29.5],
>>>     PARAMETER["standard_parallel_2",45.5],
>>>     PARAMETER["latitude_of_center",23],
>>>     PARAMETER["longitude_of_center",-96],
>>>     PARAMETER["false_easting",0],
>>>     PARAMETER["false_northing",0],
>>>     UNIT["metre",1,
>>>         AUTHORITY["EPSG","9001"]]]
>>> 
>>> with the correct parameters, but no datum name tag. You get around this
>>> manually by adding the +datum= back in:
>>> 
>>> proj4string(img2) <- CRS(paste(proj4string(img2), "+datum=NAD83"))
>>> writeGDAL(img2, img2.file)
>>> 
>>>> system(paste("gdalinfo", img2.file))
>>> 
>>> Driver: GTiff/GeoTIFF
>>> Files: /tmp/RtmpMhPgqf/img2.tif
>>> Size is 1, 1
>>> Coordinate System is:
>>> PROJCS["unnamed",
>>>     GEOGCS["NAD83",
>>>         DATUM["North_American_Datum_1983",
>>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>>                 AUTHORITY["EPSG","7019"]],
>>>             TOWGS84[0,0,0,0,0,0,0],
>>>             AUTHORITY["EPSG","6269"]],
>>>         PRIMEM["Greenwich",0],
>>>         UNIT["degree",0.0174532925199433],
>>>         AUTHORITY["EPSG","4269"]],
>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>     PARAMETER["standard_parallel_1",29.5],
>>>     PARAMETER["standard_parallel_2",45.5],
>>>     PARAMETER["latitude_of_center",23],
>>>     PARAMETER["longitude_of_center",-96],
>>>     PARAMETER["false_easting",0],
>>>     PARAMETER["false_northing",0],
>>>     UNIT["metre",1,
>>>         AUTHORITY["EPSG","9001"]]]
>>> 
>>> I would appeal to any programmer with a little time to see how the step
>>> between:
>>>
>>>   oSRS.importFromWkt( &pszSRS_WKT );
>>>   oSRS.exportToProj4( &pszSRS_WKT );
>>> 
>>> and the R output might be checked. The content of pszSRS_WKT is OK before
>>> entering importFromWkt(), but is simplified on exit from exportToProj4().
>>> The comparable part of gdal/gdal-1.9.2/apps/gdalinfo.c is around lines
>>> 263-274.
>>> 
>>> The writing operation appears to be OK from your example.
>>> 
>>> Roger
>>> 
>>> 
>>>> 
>>>> Oliver
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From osoong+r at gmail.com  Sat Nov  3 20:33:40 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Sat, 3 Nov 2012 12:33:40 -0700
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <CAPQ=hVKkjjyeT+bsTk_vzuP6U67k3oDy1=25euiuPvkuOHVE0Q@mail.gmail.com>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
	<alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
	<CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>
	<alpine.LRH.2.02.1211022232480.20436@reclus.nhh.no>
	<alpine.LRH.2.02.1211031449570.22561@reclus.nhh.no>
	<CAPQ=hVKkjjyeT+bsTk_vzuP6U67k3oDy1=25euiuPvkuOHVE0Q@mail.gmail.com>
Message-ID: <CAPQ=hVKHqY1d_Gcgbbzg1D89QYJocTbY0HMCqEsm_pVoLrrBQA@mail.gmail.com>

I did notice another thing.  I've attached the .prj file I've been
using along with a raster exported in that projection using ArcGIS.

> system("gdalinfo -proj4 Arc.tif")
[...]
PROJ.4 string is:
'+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
+datum=NAD83 +units=m +no_defs '
[...]
> readGDAL("Arc.tif")@proj4string
CRS arguments:
 +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
+datum=NAD83
+units=m +no_defs +ellps=GRS80 +towgs84=0,0,0

There are similar issues with extra Proj4 parameters showing up with
+proj=longlat +datum=WGS84 +no_defs, although these seem to be added
on read and stripped on write, somehow.

wgs84_1 <- SpatialGridDataFrame(GridTopology(c(0, 0), c(1, 1), c(1,
1)), data.frame(band = 1), CRS("+proj=longlat +datum=WGS84 +no_defs"))
writeGDAL(wgs84_1, "wgs84_1.tif")
system("gdalinfo -proj4 wgs84_1.tif")
wgs84_2 <- readGDAL("wgs84_1.tif")
wgs84_2 at proj4string
writeGDAL(wgs84_2, "wgs84_2.tif")
system("gdalinfo -proj4 wgs84_2.tif")

Any idea where the extra +ellps +towgs84 terms are coming from?

Oliver
-------------- next part --------------
A non-text attachment was scrubbed...
Name: attachments.zip
Type: application/zip
Size: 1045 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121103/1e8e9702/attachment.zip>

From Roger.Bivand at nhh.no  Sat Nov  3 20:36:03 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 Nov 2012 20:36:03 +0100
Subject: [R-sig-Geo] readGDAL loses datum
In-Reply-To: <CAPQ=hVKkjjyeT+bsTk_vzuP6U67k3oDy1=25euiuPvkuOHVE0Q@mail.gmail.com>
References: <CAPQ=hVJ3tG9biv-vfjRh=6NyiTXoNa4BeaS9JS_QzwN2DufWCw@mail.gmail.com>
	<alpine.LRH.2.02.1211020942310.18454@reclus.nhh.no>
	<CAPQ=hV+O-b-W785yU_GO4MVbLy2Ngjj-eHtpUMdk=y1M4+gWfw@mail.gmail.com>
	<alpine.LRH.2.02.1211022232480.20436@reclus.nhh.no>
	<alpine.LRH.2.02.1211031449570.22561@reclus.nhh.no>
	<CAPQ=hVKkjjyeT+bsTk_vzuP6U67k3oDy1=25euiuPvkuOHVE0Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211032033001.23775@reclus.nhh.no>

On Sat, 3 Nov 2012, Oliver Soong wrote:

> I did notice another thing.  I've attached the .prj file I've been
> using along with a raster exported in that projection using ArcGIS.
>
>> system("gdalinfo -proj4 Arc.tif")
> [...]
> PROJ.4 string is:
> '+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
> +datum=NAD83 +units=m +no_defs '
> [...]
>> readGDAL("Arc.tif")@proj4string
> CRS arguments:
> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
> +datum=NAD83
> +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0
>
> There are similar issues with extra Proj4 parameters showing up with
> +proj=longlat +datum=WGS84 +no_defs, although these seem to be added
> on read and stripped on write, somehow.
>
> wgs84_1 <- SpatialGridDataFrame(GridTopology(c(0, 0), c(1, 1), c(1,
> 1)), data.frame(band = 1), CRS("+proj=longlat +datum=WGS84 +no_defs"))
> writeGDAL(wgs84_1, "wgs84_1.tif")
> system("gdalinfo -proj4 wgs84_1.tif")
> wgs84_2 <- readGDAL("wgs84_1.tif")
> wgs84_2 at proj4string
> writeGDAL(wgs84_2, "wgs84_2.tif")
> system("gdalinfo -proj4 wgs84_2.tif")
>
> Any idea where the extra +ellps +towgs84 terms are coming from?

Yes - they are part of the safety improvements made in GDAL 1.8.0 to make 
sure that the spatial reference definitions are unambiguous. Extra tags 
are not a problem as long as they are consistent - your problem was that 
Arc doesn't like not being given a datum. Now we know how to do that, even 
though +towgs84=0,0,0 implies both of NAD83 and WGS84.

Roger

>
> Oliver
>
>
> On Sat, Nov 3, 2012 at 6:59 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Fri, 2 Nov 2012, Roger Bivand wrote:
>>
>>> On Fri, 2 Nov 2012, Oliver Soong wrote:
>>>
>>>> I agree it seems to be happening when converting WKT to Proj4.
>>>> However, is this more of a GDAL bug?
>>>>
>>>>> system(paste("gdalinfo -proj4", img1.file))
>>>>
>>>> [...]
>>>> PROJ.4 string is:
>>>> '+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>>>> +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs '
>>>>
>>>> It looks to me like the datum is getting dropped by:
>>>> OSRExportToProj4( hSRS, &pszProj4 );
>>>> This being what rgdal seems to use.
>>>
>>>
>>> Yes, but do we know that hSRS contains these tags, since they have been
>>> imported from WKT to the internal representation? The description of the
>>> import from WKT process suggests that it will terminate before processing
>>> the whole string if the description is already "complete":
>>>
>>>
>>> http://www.gdal.org/ogr/classOGRSpatialReference.html#ab74cfc985bd05404a4c61d2d633a6343
>>>
>>> I tried adding morphFromESRI() before exporting to Proj4, but the problem
>>> is not resolved. Perhaps the gdal-dev list is where to ask?
>>
>>
>> I've committed to the rgdal R-Forge project a user argument to relevant
>> functions in rgdal for setting the behaviour to datum-preserving, either on
>> a case-by-case or global level. If the environment variable is present, it
>> will have precedence and will not be overwritten. I'd welcome reports from
>> those who can try out the source checked out from R-forge.
>>
>> In your case, I now see:
>>
>>> proj4string(readGDAL("img1.tif"))
>>
>> img1.tif has GDAL driver GTiff
>> and has 1 rows and 1 columns
>> [1] " +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>> +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>>>
>>> proj4string(readGDAL("img1.tif",
>>
>> OVERRIDE_PROJ_DATUM_WITH_TOWGS84=FALSE))
>> img1.tif has GDAL driver GTiff
>> and has 1 rows and 1 columns
>> [1] " +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>> +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"
>>
>> However, there does not seem to be a clear way to auto-detect and set the
>> switch. The package also has a cached variable, so setting:
>>
>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>>
>> in an R session will use that value when raster projections are read until
>> the setting is changed. The argument will not be used for GDAL < 1.8.0,
>> because its use first appeared there. It will also not be used if an
>> environment variable "OVERRIDE_PROJ_DATUM_WITH_TOWGS84" is found, to avoid
>> overwriting its value.
>>
>> This is the result of discussions on the gdal-dev list, thread starting at:
>>
>> http://lists.osgeo.org/pipermail/gdal-dev/2012-November/034550.html
>>
>> and details in:
>>
>> http://trac.osgeo.org/gdal/ticket/4880
>>
>> Roger
>>
>>
>>>
>>> Roger
>>>
>>>>
>>>> I'm sadly less familiar with Proj4 than I ought to be to be talking
>>>> about this, but it strikes me that if this is indeed a bug and not a
>>>> "feature", then it would make more sense to fix
>>>> OSRExportToProj4/OGRSpatialReference::exportToProj4.
>>>>
>>>> Oliver
>>>>
>>>>
>>>> On Fri, Nov 2, 2012 at 2:24 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>>
>>>>> On Fri, 2 Nov 2012, Oliver Soong wrote:
>>>>>
>>>>>> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>>>>>>
>>>>>> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
>>>>>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>>>>>> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
>>>>>> +towgs84=0,0,0")
>>>>>> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
>>>>>> img1.file <- file.path(tempdir(), "img1.tif")
>>>>>> writeGDAL(img1, img1.file)
>>>>>> img2 <- readGDAL(img1.file)
>>>>>> img2.file <- file.path(tempdir(), "img2.tif")
>>>>>> writeGDAL(img2, img2.file)
>>>>>> img1 at proj4string
>>>>>> img2 at proj4string
>>>>>>
>>>>>> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
>>>>>> not.  Not surprisingly, if I look at both files in Arc, img1 has a
>>>>>> defined datum and img2 does not.
>>>>>>
>>>>>> Am I doing anything wrong?
>>>>>
>>>>>
>>>>>
>>>>> No, but it isn't obvious:
>>>>>
>>>>>
>>>>> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
>>>>> +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs")
>>>>>
>>>>> gives on re-reading:
>>>>>
>>>>>> img2 at proj4string
>>>>>
>>>>>
>>>>> CRS arguments:
>>>>>
>>>>>  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0
>>>>> +datum=NAD27 +units=m +no_defs +ellps=clrk66
>>>>> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>>>>>
>>>>> So:
>>>>>
>>>>>   oSRS.importFromWkt( &pszSRS_WKT );
>>>>>   oSRS.exportToProj4( &pszSRS_WKT );
>>>>>
>>>>> in RGDAL_GetProjectionRef() in src/gdal-bindings.cpp sees that input
>>>>> +datum=NAD83 is equivalent to +towgs84=0,0,0,0,0,0,0 on output. So the
>>>>> descriptions are not string-equivalent, but are equivalent through
>>>>> +towgs84=0,0,0,0,0,0,0. If you run with your p4s, on a system with
>>>>> gdalinfo:
>>>>>
>>>>>> system(paste("gdalinfo", img1.file))
>>>>>
>>>>>
>>>>> Driver: GTiff/GeoTIFF
>>>>> Files: /tmp/Rtmp9j2vOr/img1.tif
>>>>> Size is 1, 1
>>>>> Coordinate System is:
>>>>> PROJCS["unnamed",
>>>>>     GEOGCS["NAD83",
>>>>>         DATUM["North_American_Datum_1983",
>>>>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>>>>                 AUTHORITY["EPSG","7019"]],
>>>>>             TOWGS84[0,0,0,0,0,0,0],
>>>>>             AUTHORITY["EPSG","6269"]],
>>>>>         PRIMEM["Greenwich",0],
>>>>>         UNIT["degree",0.0174532925199433],
>>>>>         AUTHORITY["EPSG","4269"]],
>>>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>>>     PARAMETER["standard_parallel_1",29.5],
>>>>>     PARAMETER["standard_parallel_2",45.5],
>>>>>     PARAMETER["latitude_of_center",23],
>>>>>     PARAMETER["longitude_of_center",-96],
>>>>>     PARAMETER["false_easting",0],
>>>>>     PARAMETER["false_northing",0],
>>>>>     UNIT["metre",1,
>>>>>         AUTHORITY["EPSG","9001"]]]
>>>>>
>>>>> ...
>>>>>
>>>>> so the simplification is happening on conversion to Proj4 on reading.
>>>>>
>>>>> I agree that on re-export that the WKT and Proj4 versions diverge, so:
>>>>>
>>>>>> system(paste("gdalinfo", img2.file))
>>>>>
>>>>>
>>>>> Driver: GTiff/GeoTIFF
>>>>> Files: /tmp/RtmpMhPgqf/img2.tif
>>>>> Size is 1, 1
>>>>> Coordinate System is:
>>>>> PROJCS["unnamed",
>>>>>     GEOGCS["GRS 1980(IUGG, 1980)",
>>>>>         DATUM["unknown",
>>>>>             SPHEROID["GRS80",6378137,298.257222101],
>>>>>             TOWGS84[0,0,0,0,0,0,0]],
>>>>>         PRIMEM["Greenwich",0],
>>>>>         UNIT["degree",0.0174532925199433]],
>>>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>>>     PARAMETER["standard_parallel_1",29.5],
>>>>>     PARAMETER["standard_parallel_2",45.5],
>>>>>     PARAMETER["latitude_of_center",23],
>>>>>     PARAMETER["longitude_of_center",-96],
>>>>>     PARAMETER["false_easting",0],
>>>>>     PARAMETER["false_northing",0],
>>>>>     UNIT["metre",1,
>>>>>         AUTHORITY["EPSG","9001"]]]
>>>>>
>>>>> with the correct parameters, but no datum name tag. You get around this
>>>>> manually by adding the +datum= back in:
>>>>>
>>>>> proj4string(img2) <- CRS(paste(proj4string(img2), "+datum=NAD83"))
>>>>> writeGDAL(img2, img2.file)
>>>>>
>>>>>> system(paste("gdalinfo", img2.file))
>>>>>
>>>>>
>>>>> Driver: GTiff/GeoTIFF
>>>>> Files: /tmp/RtmpMhPgqf/img2.tif
>>>>> Size is 1, 1
>>>>> Coordinate System is:
>>>>> PROJCS["unnamed",
>>>>>     GEOGCS["NAD83",
>>>>>         DATUM["North_American_Datum_1983",
>>>>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>>>>                 AUTHORITY["EPSG","7019"]],
>>>>>             TOWGS84[0,0,0,0,0,0,0],
>>>>>             AUTHORITY["EPSG","6269"]],
>>>>>         PRIMEM["Greenwich",0],
>>>>>         UNIT["degree",0.0174532925199433],
>>>>>         AUTHORITY["EPSG","4269"]],
>>>>>     PROJECTION["Albers_Conic_Equal_Area"],
>>>>>     PARAMETER["standard_parallel_1",29.5],
>>>>>     PARAMETER["standard_parallel_2",45.5],
>>>>>     PARAMETER["latitude_of_center",23],
>>>>>     PARAMETER["longitude_of_center",-96],
>>>>>     PARAMETER["false_easting",0],
>>>>>     PARAMETER["false_northing",0],
>>>>>     UNIT["metre",1,
>>>>>         AUTHORITY["EPSG","9001"]]]
>>>>>
>>>>> I would appeal to any programmer with a little time to see how the step
>>>>> between:
>>>>>
>>>>>   oSRS.importFromWkt( &pszSRS_WKT );
>>>>>   oSRS.exportToProj4( &pszSRS_WKT );
>>>>>
>>>>> and the R output might be checked. The content of pszSRS_WKT is OK
>>>>> before
>>>>> entering importFromWkt(), but is simplified on exit from
>>>>> exportToProj4().
>>>>> The comparable part of gdal/gdal-1.9.2/apps/gdalinfo.c is around lines
>>>>> 263-274.
>>>>>
>>>>> The writing operation appears to be OK from your example.
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>>
>>>>>> Oliver
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From annamac_80 at hotmail.com  Sun Nov  4 00:15:51 2012
From: annamac_80 at hotmail.com (WillM)
Date: Sat, 3 Nov 2012 16:15:51 -0700 (PDT)
Subject: [R-sig-Geo] Problem with categorical variable coefficients and se
	in glm
Message-ID: <1351984551587-7581579.post@n2.nabble.com>

Hi all

I'm hoping that this is something that people deal with regularly and you
can help me out quickly even though it is a bit more of a stats question
than R.

I have a dataset where data$Resp is a count response variable (lots of 0s)
so I used a negative binomial glm with a categorical response variable. The
categories are the types of vegetation that I stratified my sampling by - so
they are not an arbitrary post hoc decision.

The UM category only has 0's for a response and produces a large coefficient
and large standard error (see output below). So I added a small number (1)
to one row of the UM category to explore what was happening and get a better
result. With a continuous response variable you can add a very small number
(say 0.001) so that it is still representative of 0, but with this count
data, 1 is the minimum.

I get a better estimate, but is there some better way of dealing with this
type of situation? I could possibly combine UM and UB categories, but I did
want to keep them separate.

Thanks alot :)

>data

   Resp Cat
1     0   D
2     0   D
3     0   D
4     0   D
5     3   D
6     0   D
7     0   D
8     0   D
9    11   F
10   11   F
11    3   F
12   14   F
13   19   F
14   41   F
15   12   S
16   55   S
17    3   S
18    0   S
19    0   S
20   30   F
21    4   F
22   10   F
23   99  DS
24    3  DS
25    1  DS
26    7  DS
27    4  DS
28    0  DS
29    2  DS
30    1  DS
31    0  UB
32    0  UB
33    0  UB
34    0  UB
35    1  UB
36    0  UM
37    0  UM
38    0  UM
39    0  UM
40    0  UM

> mod.nb <- glm.nb(data$Resp ~ data$Cat, data=data) 

> summary(mod.nb)

Call:
glm.nb(formula = data$Resp ~ data$Cat, data = data, init.theta =
0.5087557508, 
    link = log)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.85799  -0.75714  -0.58082  -0.00009   1.95946  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -0.9808     0.7609  -1.289 0.197409    
data$CatF      3.7464     0.8969   4.177 2.95e-05 ***
data$CatS      3.6199     0.9932   3.645 0.000268 ***
data$CatDS     3.6636     0.9128   4.013 5.99e-05 ***
data$CatUB    -0.6286     1.4043  -0.448 0.654427    
data$CatUM   -18.3218  4215.7113  -0.004 0.996532    
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

(Dispersion parameter for Negative Binomial(0.5088) family taken to be 1)

    Null deviance: 77.163  on 39  degrees of freedom
Residual deviance: 33.700  on 34  degrees of freedom
AIC: 191.12

Number of Fisher Scoring iterations: 1


              Theta:  0.509 
          Std. Err.:  0.152 

 2 x log-likelihood:  -177.120 

> data1<-data
> data1[40,1]<- 1 #add a small value to one of the UM categories
> mod.nb1 <- glm.nb(data1$Resp ~ data1$Cat, data=data1)     #run model again

> summary(mod.nb1)

Call:
glm.nb(formula = data1$Resp ~ data1$Cat, data = data1, init.theta =
0.515774723, 
    link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8671  -0.7593  -0.5814  -0.2098   1.9726  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -0.9808     0.7587  -1.293 0.196112    
data1$CatF    3.7464     0.8934   4.194 2.75e-05 ***
data1$CatS    3.6199     0.9888   3.661 0.000251 ***
data1$CatDS   3.6636     0.9092   4.030 5.59e-05 ***
data1$CatUB  -0.6286     1.4012  -0.449 0.653712    
data1$CatUM  -0.6286     1.4012  -0.449 0.653712    
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

(Dispersion parameter for Negative Binomial(0.5158) family taken to be 1)

    Null deviance: 76.133  on 39  degrees of freedom
Residual deviance: 36.328  on 34  degrees of freedom
AIC: 196.69

Number of Fisher Scoring iterations: 1


              Theta:  0.516 
          Std. Err.:  0.152 

 2 x log-likelihood:  -182.686 


Thanks! 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-categorical-variable-coefficients-and-se-in-glm-tp7581579.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From aortizbobea at arec.umd.edu  Sun Nov  4 08:20:11 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Sun, 4 Nov 2012 00:20:11 -0700 (PDT)
Subject: [R-sig-Geo] spml and logLik, help!
Message-ID: <1352013611310-7581581.post@n2.nabble.com>

Hello,

I would greatly appreciate some help on this. Any tips are more than
welcome.

I'm trying to obtain the log-likelihood at the optimum parameter values
using spml() from the splm package. The created fit object contains a slot
called "logLik" which is supposed to have that value but I find it to be
empty. However, when I allow all the verbiage to be printed (quiet=F), the
function prints all the MLE iterations with the values of the likelihood
function each time... but somehow the last value is not stored.

Is this a bug in the function? I'm looking for a way to to obtain the logLik
value automatically and any ideas would be appreciated (even on how to
capture the last line of the returned text if need be).

Thanks in advance for the help!

Ariel


#### Reproducible code below ########

# Load pacakge
    library(splm)
	
# Generate spatial object
    temp <- expand.grid(lon=1:10, lat=1:10 )
    temp$id        <- 1:dim(temp)[1]    
    rownames(temp) <- 1:dim(temp)[1]
    n        <- dim(temp)[1]
    mylist         <- vector('list', n)
    for(i in 1:n) { 
		mylist[[i]] = Polygons(list(Polygon(
   		cbind( c(temp[i,"lon"]-0.5, temp[i,"lon"]-0.5, temp[i,"lon"]+0.5,
temp[i,"lon"]+0.5, temp[i,"lon"]-0.5), 
	
c(temp[i,"lat"]-0.5,temp[i,"lat"]+0.5,temp[i,"lat"]+0.5,temp[i,"lat"]-0.5,temp[i,"lat"]-0.5)))),i) 
    } 
    map      <- SpatialPolygons(mylist, 1:n) 
    map          <- SpatialPolygonsDataFrame(map, temp) 
    plot(map)
    rm(temp,i,mylist)   

# Generate weight matrix/neighbor lists
   dmatrix <- spDists(map)
   coords  <- coordinates(map)  
   nb<- poly2nb(map, queen=TRUE) # contiguity queen neighbors
   plot(map, lwd=0.1, col="cornsilk")
   plot(nb , coordinates(map), add=T, col="blue") 
   dlist <- nbdists(nb, coords) 
   idlist  <- lapply(dlist, function(x) 1/x) # inverse distance
   nbw <- nb2listw(nb, glist=idlist , style="W") # inverse distance
    
    
# Generate fake data
    years <- 1993:1996
    dataset  <- data.frame( id  = as.numeric(paste(map at data$id)),
year=rep(years, each=n) )
    dataset$X <-  rnorm(length(years)*n, mean=10, sd=5) 
    dataset$a  <- rep(rnorm(n,mean=50,sd=sqrt(30)), times=length(years)) 	
    dataset$y  <- dataset$X * 1 + dataset$a + rnorm(4*20, mean=0, sd=2)

# Run model 
	fit   <- spml(formula = y ~ X , data = dataset, model="within",
effect=c("individual"), index = c("id","year"), listw = nbw, lag = FALSE,
spatial.error = "b", quiet=F)        

# Check results
    summary(fit)
    fit$logLik # nothing was stored there.



-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spml-and-logLik-help-tp7581581.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From seth at swbigelow.net  Mon Nov  5 02:41:54 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Sun, 4 Nov 2012 20:41:54 -0500
Subject: [R-sig-Geo] Problem with categorical variable coefficients and
	se	in glm
In-Reply-To: <1351984551587-7581579.post@n2.nabble.com>
References: <1351984551587-7581579.post@n2.nabble.com>
Message-ID: <003801cdbaf6$bd4e5140$37eaf3c0$@net>

Will, if your category UM is all zeros, there can be no variance to it, so I would say that you cannot make any statistical inference about it. Presumably there is no option of collecting more data? Certainly changing one of the data points from zero to one gives a cleaner-looking estimate of standard error, but it's an incorrect one. 

I would consider leaving the UM category out of the formal data analysis. You can still report & discuss the findings regarding the UM category, but by keeping the made-up variance out of the statistical analysis you can avoid giving that impression that the statistical results are contaminated in some way. 

--Seth

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of WillM
Sent: Saturday, November 03, 2012 7:16 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Problem with categorical variable coefficients and se in glm

Hi all

I'm hoping that this is something that people deal with regularly and you
can help me out quickly even though it is a bit more of a stats question
than R.

I have a dataset where data$Resp is a count response variable (lots of 0s)
so I used a negative binomial glm with a categorical response variable. The
categories are the types of vegetation that I stratified my sampling by - so
they are not an arbitrary post hoc decision.

The UM category only has 0's for a response and produces a large coefficient
and large standard error (see output below). So I added a small number (1)
to one row of the UM category to explore what was happening and get a better
result. With a continuous response variable you can add a very small number
(say 0.001) so that it is still representative of 0, but with this count
data, 1 is the minimum.

I get a better estimate, but is there some better way of dealing with this
type of situation? I could possibly combine UM and UB categories, but I did
want to keep them separate.

Thanks alot :)

>data

   Resp Cat
1     0   D
2     0   D
3     0   D
4     0   D
5     3   D
6     0   D
7     0   D
8     0   D
9    11   F
10   11   F
11    3   F
12   14   F
13   19   F
14   41   F
15   12   S
16   55   S
17    3   S
18    0   S
19    0   S
20   30   F
21    4   F
22   10   F
23   99  DS
24    3  DS
25    1  DS
26    7  DS
27    4  DS
28    0  DS
29    2  DS
30    1  DS
31    0  UB
32    0  UB
33    0  UB
34    0  UB
35    1  UB
36    0  UM
37    0  UM
38    0  UM
39    0  UM
40    0  UM

> mod.nb <- glm.nb(data$Resp ~ data$Cat, data=data) 

> summary(mod.nb)

Call:
glm.nb(formula = data$Resp ~ data$Cat, data = data, init.theta =
0.5087557508, 
    link = log)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.85799  -0.75714  -0.58082  -0.00009   1.95946  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -0.9808     0.7609  -1.289 0.197409    
data$CatF      3.7464     0.8969   4.177 2.95e-05 ***
data$CatS      3.6199     0.9932   3.645 0.000268 ***
data$CatDS     3.6636     0.9128   4.013 5.99e-05 ***
data$CatUB    -0.6286     1.4043  -0.448 0.654427    
data$CatUM   -18.3218  4215.7113  -0.004 0.996532    
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

(Dispersion parameter for Negative Binomial(0.5088) family taken to be 1)

    Null deviance: 77.163  on 39  degrees of freedom
Residual deviance: 33.700  on 34  degrees of freedom
AIC: 191.12

Number of Fisher Scoring iterations: 1


              Theta:  0.509 
          Std. Err.:  0.152 

 2 x log-likelihood:  -177.120 

> data1<-data
> data1[40,1]<- 1 #add a small value to one of the UM categories
> mod.nb1 <- glm.nb(data1$Resp ~ data1$Cat, data=data1)     #run model again

> summary(mod.nb1)

Call:
glm.nb(formula = data1$Resp ~ data1$Cat, data = data1, init.theta =
0.515774723, 
    link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8671  -0.7593  -0.5814  -0.2098   1.9726  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -0.9808     0.7587  -1.293 0.196112    
data1$CatF    3.7464     0.8934   4.194 2.75e-05 ***
data1$CatS    3.6199     0.9888   3.661 0.000251 ***
data1$CatDS   3.6636     0.9092   4.030 5.59e-05 ***
data1$CatUB  -0.6286     1.4012  -0.449 0.653712    
data1$CatUM  -0.6286     1.4012  -0.449 0.653712    
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

(Dispersion parameter for Negative Binomial(0.5158) family taken to be 1)

    Null deviance: 76.133  on 39  degrees of freedom
Residual deviance: 36.328  on 34  degrees of freedom
AIC: 196.69

Number of Fisher Scoring iterations: 1


              Theta:  0.516 
          Std. Err.:  0.152 

 2 x log-likelihood:  -182.686 


Thanks! 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-categorical-variable-coefficients-and-se-in-glm-tp7581579.html
Sent from the R-sig-geo mailing list archive at Nabble.com.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Tom_Roche at pobox.com  Mon Nov  5 04:29:44 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Sun, 04 Nov 2012 22:29:44 -0500
Subject: [R-sig-Geo] reboxing with package=gstat
In-Reply-To: <87lielrfem.fsf@pobox.com>
References: <87lielrfem.fsf@pobox.com>
Message-ID: <87ip9k4thz.fsf@pobox.com>


Apologies if the following reveals a profound lack of understanding of
spatiality or geostatistics (esp kriging), which I'm learning slowly and
"on-the-fly":

summary: for "reboxing" from a regular global unprojected grid to a
regular local projected grid (both 3D), should one use

* gstat::krige? If so, what model?

* gstat::idw? If so, what formula?

or something completely different?

details: 

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016573.html
>>> [I seek to] incorporate N2O emissions inventories (EIs), initial
>>> conditions (ICs), and boundary conditions (BCs) from relatively
>>> coarse-scaled global inventories (with horizontal grids on the order
>>> of degrees lon-lat) into a [finer-scaled] regional atmospheric model
>>> (12-km LCC horizontal). The [EIs] are [surface/2D] and I now know
>>> how to "regrid," or interpolate from one 2D grid to another.

>>> However the model and [its] IC/BCs are 3D[, and] have [both]
>>> different vertical layering (i.e., [number and height of layers])
>>> [and] different horizontal grids. I'd like to know: is there R code
>>> available that will "rebox," i.e., interpolate vertically as well as
>>> horizontally?

To further specify: my global IC/BC estimates mass concentration for
each box/voxel in a regular, unprojected grid 1.875? x 2.5? x 56 levels.
I want to "rebox" from global IC/BCs to model-ready IC/BCs, where the
latter must estimate mass concentration over a regular grid that
horizontally projects to LCC over North America at 12-km resolution, and
which has 34 vertical levels. (Both the vertical and horizontal extents
of the model-ready IC/BC are subsets of the global extents.) I can
compute the sizes of the boxes, so I can compute the mass in each input
box, and recompute the output concentrations, presuming I can learn how
to rebox the masses.

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016574.html
(rearranged)
>> [A] typical issue is [whether] variability, or spatial correlation,
>> in x/y differs from that in z for the same distance unit[.]

I believe the vertical and horizontal correlations of N2O concentrations
differ strongly:

* vertical distribution of N2O is governed by atmospheric processes
  (advection and diffusion) very different from the mostly biological
  pedospheric processes that govern the horizontal distribution of its
  emissions (though the two sets of processes are coupled via
  precipitation and temperature)

* N2O in the troposphere (which unfortunately is all my group can now
  model) has a long life (scale ~= century) relative to the temporal
  scale of the processes that produce/emit it (which vary diurnally and
  seasonally, with soil moisture and temperature)

That being said, N2O datasets are quite appallingly sparse, given its
current significance as a depleter of stratospheric O3 and as a GHG.

>> Package gstat provides 3D interpolation:

>> library(gstat)
>> demo(gstat3D)

>> in this case, if you'd leave out the variogram model, inverse distance
>> is used for interpolation.

I note

R session
> demo(gstat3D)
...
> # $Id: gstat3D.R,v 1.5 2007-02-23 13:34:07 edzer Exp $
> # simple demo of 3D interpolation of 50 points with random normal
> # values, randomly located in the unit cube
> n <- 50
> data3D <- data.frame(x=runif(n), y=runif(n), z=runif(n), v=rnorm(n))
> coordinates(data3D)=~x+y+z
> range1D <- seq(from=0, to=1, length=20)
> grid3D <- expand.grid(x=range1D, y=range1D, z=range1D)
> gridded(grid3D)=~x+y+z
> res3D <- krige(formula=v ~ 1, data3D, grid3D, model=vgm(1, "Exp", .2))

So for my usecase,

1 'coordinates(data3D)' would be the coordinates of the centers of the
  boxes defined by the global/unprojected grid

2 'data3D' would be the pairs of coordinates and mass concentrations
  for the global/unprojected grid

3 'grid3D' would be the coordinates of the centers of the
  local/projected gridboxes

4 'res3D' would be the pairs of coordinates and mass concentrations
  for the global/unprojected grid

correct? (Though I note that, in the demo

> names(res3D at data)
[1] "var1.pred" "var1.var" 

and I don't know why there are 2 data columns rather than 1.) If so, I
can create data3D and get its coordinates from my input grid, and
obtain grid3D by projecting coordinates(data3D) using R package=M3.
But to get res3D from grid3D, for my usecase, should I use

* gstat::krige? If so, what model? (or no model?)

* gstat::idw? If so, what formula?

* or something else?

Your assistance is appreciated! Tom Roche <Tom_Roche at pobox.com>


From Tom_Roche at pobox.com  Mon Nov  5 05:58:37 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Sun, 04 Nov 2012 23:58:37 -0500
Subject: [R-sig-Geo] reboxing with package=GSIF
In-Reply-To: <5092B0DF.4050204@spatial-analyst.net>
References: <5092B0DF.4050204@spatial-analyst.net> <87lielrfem.fsf@pobox.com>
Message-ID: <87fw4o4pdu.fsf@pobox.com>


summary: how to use GSIF::make.3Dgrid for general-purpose "reboxing," or
3D interpolation? Particularly, can one use varying vertical bounds
rather than the same "standard depths" for both input and output?

details:

Apologies if the following questions reveal a profound ignorance of
spatiality or geostatistics (which I'm learning slowly and "on-the-fly")
and if I'm missing something simple regarding GSIF; unfortunately the
tutorial

http://gsif.r-forge.r-project.org/tutorial_eberg.php

seems to require more geostatistical background than I currently have.

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016573.html
>>> [I seek to] incorporate N2O emissions inventories (EIs), initial
>>> conditions (ICs), and boundary conditions (BCs) from relatively
>>> coarse-scaled global inventories (with horizontal grids on the order
>>> of degrees lon-lat) into a [finer-scaled] regional atmospheric model
>>> (12-km LCC horizontal). The [EIs] are [surface/2D] and I now know
>>> how to "regrid," or interpolate from one 2D grid to another.

>>> However the model and [its] IC/BCs are 3D[, and] have [both]
>>> different vertical layering (i.e., [number and height of layers])
>>> [and] different horizontal grids. I'd like to know: is there R code
>>> available that will "rebox," i.e., interpolate vertically as well as
>>> horizontally?

To further specify: my global IC/BC estimates mass concentration for
each box/voxel in a regular, unprojected grid 1.875? x 2.5? x 56 levels.
I want to "rebox" from global IC/BCs to model-ready IC/BCs, where the
latter must estimate mass concentration over a regular grid that
horizontally projects to LCC over North America at 12-km resolution, and
which has 34 vertical levels. (Both the vertical and horizontal extents
of the model-ready IC/BC are subsets of the global extents.) I can
compute the sizes of the boxes, so I can compute the mass in each input
box, and recompute the output concentrations, presuming I can learn how
to rebox the masses.

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016578.HTML
> I've produced some 3D interpolation examples in the experimental
> package GSIF (under construction). You can actually create some kind
> of voxels via the SpatialPixelsDataFrame class

> http://gsif.r-forge.r-project.org/make.3Dgrid-method.html

> and then predict at those locations.

From

http://gsif.r-forge.r-project.org/make.3Dgrid-method.html

it appears one can provide as input

* an unprojected SpatialPixelsDataFrame or RasterBrick

* a PROJ.4 string defining the output CRS

* a "list of standard depths"

and get an output list of SpatialPixelsDataFrame's (one per standard
depth). From the description, it seems like GSIF::make.3Dgrid is doing a
2D regridding at each standard depth, such that the heights of the input
box/voxels must match that of the output box/voxels. Is that correct?

If not, how can one rebox from an input with one set of layer heights
(or vertical bounds) to an output with another set of layer heights?
Can `gdalwarp` do that, or is it (like, IIUC, raster::projectRaster)
restricted to 2D?

Your assistance is appreciated! Tom Roche <Tom_Roche at pobox.com>


From Ravichandra.MONDRETI at cefe.cnrs.fr  Mon Nov  5 07:40:35 2012
From: Ravichandra.MONDRETI at cefe.cnrs.fr (Ravichandra MONDRETI)
Date: Mon, 5 Nov 2012 07:40:35 +0100
Subject: [R-sig-Geo] Spatial autocorrelation
References: <0572F5C875F0A74A97108D62AD6EACDB42C31B@ZZML.newcefe.newage.fr>
Message-ID: <0572F5C875F0A74A97108D62AD6EACDB0D163B@ZZML.newcefe.newage.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/529a58c3/attachment.pl>

From hengl at spatial-analyst.net  Mon Nov  5 10:34:12 2012
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 05 Nov 2012 10:34:12 +0100
Subject: [R-sig-Geo] reboxing with package=GSIF
In-Reply-To: <87fw4o4pdu.fsf@pobox.com>
References: <5092B0DF.4050204@spatial-analyst.net> <87lielrfem.fsf@pobox.com>
	<87fw4o4pdu.fsf@pobox.com>
Message-ID: <50978814.5080106@spatial-analyst.net>



On 05/11/2012 05:58, Tom Roche wrote:
>
> summary: how to use GSIF::make.3Dgrid for general-purpose "reboxing," or
> 3D interpolation? Particularly, can one use varying vertical bounds
> rather than the same "standard depths" for both input and output?
>

Yes. You can predict at irregular locations by using 
SpatialPointsDataFrame object e.g.:

 > obj = data.frame(x = 100, y = 100, d = -.2, DEM = 122)
 > coordinates(obj) <- ~x+y+d

The names of coordinate fields in the gstatModel and for the new 
locations must correspond. See also:

http://gsif.r-forge.r-project.org/tutorial_eberg.php#visualizing_uncertainty

> details:
>
> Apologies if the following questions reveal a profound ignorance of
> spatiality or geostatistics (which I'm learning slowly and "on-the-fly")
> and if I'm missing something simple regarding GSIF; unfortunately the
> tutorial
>
> http://gsif.r-forge.r-project.org/tutorial_eberg.php
>

Yes. I'm also on the edge here :)

> seems to require more geostatistical background than I currently have.
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016573.html
>>>> [I seek to] incorporate N2O emissions inventories (EIs), initial
>>>> conditions (ICs), and boundary conditions (BCs) from relatively
>>>> coarse-scaled global inventories (with horizontal grids on the order
>>>> of degrees lon-lat) into a [finer-scaled] regional atmospheric model
>>>> (12-km LCC horizontal). The [EIs] are [surface/2D] and I now know
>>>> how to "regrid," or interpolate from one 2D grid to another.
>
>>>> However the model and [its] IC/BCs are 3D[, and] have [both]
>>>> different vertical layering (i.e., [number and height of layers])
>>>> [and] different horizontal grids. I'd like to know: is there R code
>>>> available that will "rebox," i.e., interpolate vertically as well as
>>>> horizontally?
>
> To further specify: my global IC/BC estimates mass concentration for
> each box/voxel in a regular, unprojected grid 1.875? x 2.5? x 56 levels.
> I want to "rebox" from global IC/BCs to model-ready IC/BCs, where the
> latter must estimate mass concentration over a regular grid that
> horizontally projects to LCC over North America at 12-km resolution, and
> which has 34 vertical levels. (Both the vertical and horizontal extents
> of the model-ready IC/BC are subsets of the global extents.) I can
> compute the sizes of the boxes, so I can compute the mass in each input
> box, and recompute the output concentrations, presuming I can learn how
> to rebox the masses.
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016578.HTML
>> I've produced some 3D interpolation examples in the experimental
>> package GSIF (under construction). You can actually create some kind
>> of voxels via the SpatialPixelsDataFrame class
>
>> http://gsif.r-forge.r-project.org/make.3Dgrid-method.html
>
>> and then predict at those locations.
>
> From
>
> http://gsif.r-forge.r-project.org/make.3Dgrid-method.html
>
> it appears one can provide as input
>
> * an unprojected SpatialPixelsDataFrame or RasterBrick
>
> * a PROJ.4 string defining the output CRS
>
> * a "list of standard depths"
>
> and get an output list of SpatialPixelsDataFrame's (one per standard
> depth). From the description, it seems like GSIF::make.3Dgrid is doing a
> 2D regridding at each standard depth, such that the heights of the input
> box/voxels must match that of the output box/voxels. Is that correct?
>
> If not, how can one rebox from an input with one set of layer heights
> (or vertical bounds) to an output with another set of layer heights?
> Can `gdalwarp` do that, or is it (like, IIUC, raster::projectRaster)
> restricted to 2D?
>
> Your assistance is appreciated! Tom Roche <Tom_Roche at pobox.com>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From rob.robinson at bto.org  Mon Nov  5 10:34:41 2012
From: rob.robinson at bto.org (Rob Robinson)
Date: Mon, 5 Nov 2012 09:34:41 +0000
Subject: [R-sig-Geo] Problem with categorical variable coefficients and
 se in glm
In-Reply-To: <003801cdbaf6$bd4e5140$37eaf3c0$@net>
References: <1351984551587-7581579.post@n2.nabble.com>
	<003801cdbaf6$bd4e5140$37eaf3c0$@net>
Message-ID: <CAGcXcEb7vG07MX=WEr7n7sFxH_Etxz0qij_U6-cpxtnCjcsfFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/ec2bcd5a/attachment.pl>

From virgilio.gomez at uclm.es  Mon Nov  5 11:56:42 2012
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Mon, 05 Nov 2012 11:56:42 +0100
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <1351779673999-7581537.post@n2.nabble.com>
References: <1351779673999-7581537.post@n2.nabble.com>
Message-ID: <1352113002.3467.8.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Hi,

> I am curious if the list can point me to some other libraries in R, besides
> INLA, that are capable of using the spacetime data directly in a regression

INLA is a good software to fit spatiotemporal models as it is very
flexible.

> framework, or perhaps in a spatio-temporal disease clustering framework. I
> know about the DCluster library and use it some, but would be very grateful
> for any other ideas.

You may want to check DClusterm :

https://r-forge.r-project.org/projects/dclusterm/

It is underdevelopment but it implements space-time clustering and
spatial clustering based on GLMs.

Best,

Virgilio


From acmonmany at gmail.com  Mon Nov  5 13:31:36 2012
From: acmonmany at gmail.com (carolina monmany)
Date: Mon, 5 Nov 2012 08:31:36 -0400
Subject: [R-sig-Geo] Saving a variogram in gstat
Message-ID: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/e2ede0a9/attachment.pl>

From finleya at msu.edu  Mon Nov  5 13:48:11 2012
From: finleya at msu.edu (Andrew Finley)
Date: Mon, 5 Nov 2012 07:48:11 -0500
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <1352113002.3467.8.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
References: <1351779673999-7581537.post@n2.nabble.com>
	<1352113002.3467.8.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
Message-ID: <ADE85578-3A5F-4B70-A6EF-9FEDFB069E8B@msu.edu>

Hi,
The new package spTimer might be another option.
-Andy

On Nov 5, 2012, at 5:56, Virgilio G?mez-Rubio <virgilio.gomez at uclm.es> wrote:

> Hi,
> 
>> I am curious if the list can point me to some other libraries in R, besides
>> INLA, that are capable of using the spacetime data directly in a regression
> 
> INLA is a good software to fit spatiotemporal models as it is very
> flexible.
> 
>> framework, or perhaps in a spatio-temporal disease clustering framework. I
>> know about the DCluster library and use it some, but would be very grateful
>> for any other ideas.
> 
> You may want to check DClusterm :
> 
> https://r-forge.r-project.org/projects/dclusterm/
> 
> It is underdevelopment but it implements space-time clustering and
> spatial clustering based on GLMs.
> 
> Best,
> 
> Virgilio
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From acmonmany at gmail.com  Mon Nov  5 15:04:40 2012
From: acmonmany at gmail.com (carolina monmany)
Date: Mon, 5 Nov 2012 10:04:40 -0400
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
Message-ID: <CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/f10bc2f9/attachment.pl>

From sarah.goslee at gmail.com  Mon Nov  5 15:11:55 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Mon, 5 Nov 2012 09:11:55 -0500
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
Message-ID: <CAM_vjum9_sP8ssRfE-326JKWDFO4Z8sO11OmqPSFJoNjs9uMiQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/d1edee62/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Mon Nov  5 15:28:56 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Mon, 05 Nov 2012 15:28:56 +0100
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
Message-ID: <5097CD28.8050106@jrc.ec.europa.eu>

The following reproducible example works for me
(please run it in a new session):

  -------- START ----------
  library(gstat)
  data(meuse)

  # no trend:
  coordinates(meuse) = ~x+y
  myvgm <- variogram(log(zinc)~1, meuse)

  # saving the variogram to your home directory
  setwd("~")
  save(myvgm, file="Myvgm.RData")

  ## remove (almost) everything in the working environment.
  ## IMPORTANT:: You will get no warning, so
  ## don't do this unless you are really sure.
  rm(list = ls())

  ## Loading the variogram
  load("Myvgm.RData")
  summary(myvgm)
-------- END ----------


IHTH,

Mauricio

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
Linux user #454569 -- Ubuntu user #17469
=================================================
"It is a mistake to look too far ahead. Only one
link in the chain of destiny can be handled at a time"
(Sir Winston Churchill)



On 05/11/12 15:04, carolina monmany wrote:
> Thanks, Sarah. I've tried that and it looks like it is loaded but when I
> try to do anything such as plot(variog1) or fit it it does not work. When I
> ask
>
> class(variog1)
>
> it says
>
> character
>
>
> 2012/11/5 Sarah Goslee<sarah.goslee at gmail.com>
>
>> If you use save() to save your variograms, you need to use load() to load
>> them.
>>
>> load("variog1.Rdata")
>>
>> Sarah
>>
>>
>> On Monday, November 5, 2012, carolina monmany wrote:
>>
>>> Dear all,
>>>
>>> I am using R 2.15.1 and the package gstat in Linux to calculate variograms
>>> from large datasets (200x200m high resolution satellite images).
>>>
>>> I need to save all the variograms for later modelling and others and I
>>> realized late that I was using the wrong command:
>>>
>>> save(variog1, file="variog1.Rdata")
>>>
>>> the variograms were being indeed saved but I cannot open them again
>>>   because they not being saved as variograms but as characters.
>>>
>>> I tried to save them using the suggested command:
>>>
>>> data(variog1): 'variog1';
>>>
>>> with no success. My main question is: is there a way I can recover the
>>> already saved variograms?
>>> And the other question : what is the correct syntaxis for saving
>>> variograms
>>> in gstat?
>>>
>>> Thanks  a lot.
>>> --
>>> ---------------------------
>>> A. CAROLINA MONMANY
>>> Universidad de Puerto Rico
>>> Departamento de Biologia - CN 235
>>> POBOX 23360
>>> San Juan, Puerto Rico 00931-3360
>>> Tel: +1 787 764 0000 x2847
>>> Fax: +1 787 764 2610
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> Sarah Goslee
>> http://www.stringpage.com
>> http://www.sarahgoslee.com
>> http://www.functionaldiversity.org
>>
>
>
>


From acmonmany at gmail.com  Mon Nov  5 16:26:19 2012
From: acmonmany at gmail.com (carolina monmany)
Date: Mon, 5 Nov 2012 11:26:19 -0400
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <5097CD28.8050106@jrc.ec.europa.eu>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
Message-ID: <CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/de3983e7/attachment.pl>

From corey.sparks at utsa.edu  Mon Nov  5 16:29:27 2012
From: corey.sparks at utsa.edu (Corey Sparks)
Date: Mon, 5 Nov 2012 15:29:27 +0000
Subject: [R-sig-Geo] Question about space-time analysis routines
In-Reply-To: <ADE85578-3A5F-4B70-A6EF-9FEDFB069E8B@msu.edu>
References: <1351779673999-7581537.post@n2.nabble.com>
	<1352113002.3467.8.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
	<ADE85578-3A5F-4B70-A6EF-9FEDFB069E8B@msu.edu>
Message-ID: <176F26A1DA36AE4FA85D1D6502858F820568D1@BY2PRD0810MB356.namprd08.prod.outlook.com>

Thank you gentlemen, this gives me some things to work with.
Best to all
Corey

On Nov 5, 2012, at 6:48 AM, Andrew Finley wrote:

> Hi,
> The new package spTimer might be another option.
> -Andy
> 
> On Nov 5, 2012, at 5:56, Virgilio G?mez-Rubio <virgilio.gomez at uclm.es> wrote:
> 
>> Hi,
>> 
>>> I am curious if the list can point me to some other libraries in R, besides
>>> INLA, that are capable of using the spacetime data directly in a regression
>> 
>> INLA is a good software to fit spatiotemporal models as it is very
>> flexible.
>> 
>>> framework, or perhaps in a spatio-temporal disease clustering framework. I
>>> know about the DCluster library and use it some, but would be very grateful
>>> for any other ideas.
>> 
>> You may want to check DClusterm :
>> 
>> https://r-forge.r-project.org/projects/dclusterm/
>> 
>> It is underdevelopment but it implements space-time clustering and
>> spatial clustering based on GLMs.
>> 
>> Best,
>> 
>> Virgilio
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

Corey Sparks, PhD
Assistant professor
Department of Demography
The University of Texas at San Antonio
501 West Cesar E Chavez Blvd
San Antonio TX 78207
Corey.sparks 'at' utsa.edu
210 458 3166
Latitude: 29.423614  /  Longitude: -98.504282


From rafael.wueest at wsl.ch  Mon Nov  5 16:35:25 2012
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Mon, 5 Nov 2012 16:35:25 +0100
Subject: [R-sig-Geo] raster package - zonal - standard deviations
In-Reply-To: <50940478.5000504@geo.hu-berlin.de>
References: <50940478.5000504@geo.hu-berlin.de>
Message-ID: <AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>

Hi Christian

What version of raster do you use. Using my installation of raster (version 2.0-12), 'sd' as a function in zonal works fine (see example below).

r <- raster(ncols=10, nrows=10)
r[] <- runif(ncell(r)) * 1:ncell(r)
z <- r
z[] <- rep(1:5, each=20)
zonal(r, z, 'sd')
     zone      "sd"
[1,]    1  4.894058
[2,]    2  9.216353
[3,]    3 14.144341
[4,]    4 19.973913
[5,]    5 27.934773

I guess updating the raster package will solve the problem.

Best,
Rafael

On 02.11.2012, at 18:35, Christian Levers wrote:

> Hello,
> 
> I am using the raster package to calculate zonal statistics for my stack of ca. 50 rasters (each raster is about 33 mio. pixels) and I am wondering if there is a simple way to calculate standard deviations for the zones since "sd" is not implemented in the presets for the "stat" argument. If not, I guess defining a function which calculates std.dev is the easiest solution.
> 
> Thanks in advance and a nice weekend,
> Christian
> 
> -- 
> MSc Geogr. Christian Levers
> Doctoral Researcher
> 
> Biogeography & Conservation Biology
> Geography Department | Humboldt-Universitaet zu Berlin
> 
> eMail:  christian.levers at geo.hu-berlin.de
> phone:  +49 (0) 30 2093 9341
> fax:    +49 (0) 30 2093 6848
> mail:   Unter den Linden 6 | 10099 Berlin | Germany
> web:    http://www.geographie.hu-berlin.de
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From sarah.goslee at gmail.com  Mon Nov  5 16:42:24 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Mon, 5 Nov 2012 10:42:24 -0500
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
	<CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
Message-ID: <CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>

On Mon, Nov 5, 2012 at 10:26 AM, carolina monmany <acmonmany at gmail.com> wrote:
> Thanks Sarah and Mauricio,
>
> here's the example
>
>> library(gstat)
>> setwd("/home/acmonmany/matricesDN")
>> tuc11.2.frm = read.table("plot11_2.txt", header=T)
>> coordinates(tuc11.2.frm) <- c("X", "Y")
>> proj4string(tuc11.2.frm) <-CRS("+proj=utm +zone=20 +south +ellps=intl
> +towgs84=-355,21,72,0,0,0,0 +units=m +no_defs")
>> variog11.2 <- variogram(reflectance~1, data=tuc11.2.frm)
>> save(variog11.2, file="tuc11.2.200.var.Rdata")
>
> NOW when I try to load the saved file (I do not change directory and I can
> see the files there, in the directory stated above):
>
>
>> load("tuc11.2.200.var.Rdata")
>> class("tuc11.2.200.var.Rdata")
> [1] "character"

Of course it is:

"tuc11.2.200.var.Rdata" is a character string, as is anything in quotes.


>> summary(tuc11.2.200.var)
> Error in summary(tuc11.2.200.var) :
>   error in evaluating the argument 'object' in selecting a method for
> function 'summary': Error: object 'tuc11.2.200.var' not found

That's not anything, just the name of your Rdata file. The R object
itself keeps the same name as it had when you saved it: variog11.2
summary(variog11.2)
will show you its properties. If you ls() you'll see there is no R object called
tuc11.2.200.var

If you want your saved object to have that name, you need to rename it
before saving.

Sarah


--
Sarah Goslee
http://www.functionaldiversity.org


From acmonmany at gmail.com  Mon Nov  5 16:55:58 2012
From: acmonmany at gmail.com (carolina monmany)
Date: Mon, 5 Nov 2012 11:55:58 -0400
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
	<CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
	<CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>
Message-ID: <CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/572cf136/attachment.pl>

From hzambran.newsgroups at gmail.com  Mon Nov  5 17:07:47 2012
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano-Bigiarini)
Date: Mon, 5 Nov 2012 17:07:47 +0100
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
	<CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
	<CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>
	<CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>
Message-ID: <CAHYf9P=BO9RqUsv-m=NbFsyrcO4pBbgiLfjQN6155dhB46fmEA@mail.gmail.com>

Hi Carolina,

You can save all the variables of your current session by using 'save.image':

save.image("myVGMsession.RData")

and then load it as before (from Windows or GNU/Linux):

load("myVGMsession.RData")

Kinds,

Mauricio

2012/11/5 carolina monmany <acmonmany at gmail.com>:
> I see, Sarah. Thank you!
>
> Now I need to transfer those variograms to my PC running windows and that
> was the reason I  was doing
>
> save(variog11.2, file="tuc11.2.200.var.Rdata")
>
> and transfering those files from Linux to Windows. Should I transfer the
> .Rdata in the directory instead? Where are the objects themselves?
>
>
> 2012/11/5 Sarah Goslee <sarah.goslee at gmail.com>
>
>> On Mon, Nov 5, 2012 at 10:26 AM, carolina monmany <acmonmany at gmail.com>
>> wrote:
>> > Thanks Sarah and Mauricio,
>> >
>> > here's the example
>> >
>> >> library(gstat)
>> >> setwd("/home/acmonmany/matricesDN")
>> >> tuc11.2.frm = read.table("plot11_2.txt", header=T)
>> >> coordinates(tuc11.2.frm) <- c("X", "Y")
>> >> proj4string(tuc11.2.frm) <-CRS("+proj=utm +zone=20 +south +ellps=intl
>> > +towgs84=-355,21,72,0,0,0,0 +units=m +no_defs")
>> >> variog11.2 <- variogram(reflectance~1, data=tuc11.2.frm)
>> >> save(variog11.2, file="tuc11.2.200.var.Rdata")
>> >
>> > NOW when I try to load the saved file (I do not change directory and I
>> can
>> > see the files there, in the directory stated above):
>> >
>> >
>> >> load("tuc11.2.200.var.Rdata")
>> >> class("tuc11.2.200.var.Rdata")
>> > [1] "character"
>>
>> Of course it is:
>>
>> "tuc11.2.200.var.Rdata" is a character string, as is anything in quotes.
>>
>>
>> >> summary(tuc11.2.200.var)
>> > Error in summary(tuc11.2.200.var) :
>> >   error in evaluating the argument 'object' in selecting a method for
>> > function 'summary': Error: object 'tuc11.2.200.var' not found
>>
>> That's not anything, just the name of your Rdata file. The R object
>> itself keeps the same name as it had when you saved it: variog11.2
>> summary(variog11.2)
>> will show you its properties. If you ls() you'll see there is no R object
>> called
>> tuc11.2.200.var
>>
>> If you want your saved object to have that name, you need to rename it
>> before saving.
>>
>> Sarah
>>
>>
>> --
>> Sarah Goslee
>> http://www.functionaldiversity.org
>>
>
>
>
> --
> ---------------------------
> A. CAROLINA MONMANY
> Universidad de Puerto Rico
> Departamento de Biologia - CN 235
> POBOX 23360
> San Juan, Puerto Rico 00931-3360
> Tel: +1 787 764 0000 x2847
> Fax: +1 787 764 2610
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
=====================================
Water Resources Unit
Institute for Environment and Sustainability
Joint Research Centre, European Commission
webinfo    : http://floods.jrc.ec.europa.eu/
=====================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:13}}


From sarah.goslee at gmail.com  Mon Nov  5 17:17:08 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Mon, 5 Nov 2012 11:17:08 -0500
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
	<CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
	<CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>
	<CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>
Message-ID: <CAM_vjukMMDc8husfD38PMuR9EumesO+uMJQowae45aCb-6fqDA@mail.gmail.com>

On Mon, Nov 5, 2012 at 10:55 AM, carolina monmany <acmonmany at gmail.com> wrote:
> I see, Sarah. Thank you!
>
> Now I need to transfer those variograms to my PC running windows and that
> was the reason I  was doing
>
> save(variog11.2, file="tuc11.2.200.var.Rdata")
>
> and transfering those files from Linux to Windows. Should I transfer the
> .Rdata in the directory instead? Where are the objects themselves?

The R object named variog11.2 is saved in the binary file named
tuc11.2.200.var.Rdata. That file can be copied to other computers and
loaded using load(), which will create the variogram variog11.2 in
that workspace (potentially overwriting any object already named
variog11.2).

I don't understand your question about directories.

Sarah


>
> 2012/11/5 Sarah Goslee <sarah.goslee at gmail.com>
>
>> On Mon, Nov 5, 2012 at 10:26 AM, carolina monmany <acmonmany at gmail.com>
>> wrote:
>> > Thanks Sarah and Mauricio,
>> >
>> > here's the example
>> >
>> >> library(gstat)
>> >> setwd("/home/acmonmany/matricesDN")
>> >> tuc11.2.frm = read.table("plot11_2.txt", header=T)
>> >> coordinates(tuc11.2.frm) <- c("X", "Y")
>> >> proj4string(tuc11.2.frm) <-CRS("+proj=utm +zone=20 +south +ellps=intl
>> > +towgs84=-355,21,72,0,0,0,0 +units=m +no_defs")
>> >> variog11.2 <- variogram(reflectance~1, data=tuc11.2.frm)
>> >> save(variog11.2, file="tuc11.2.200.var.Rdata")
>> >
>> > NOW when I try to load the saved file (I do not change directory and I
>> can
>> > see the files there, in the directory stated above):
>> >
>> >
>> >> load("tuc11.2.200.var.Rdata")
>> >> class("tuc11.2.200.var.Rdata")
>> > [1] "character"
>>
>> Of course it is:
>>
>> "tuc11.2.200.var.Rdata" is a character string, as is anything in quotes.
>>
>>
>> >> summary(tuc11.2.200.var)
>> > Error in summary(tuc11.2.200.var) :
>> >   error in evaluating the argument 'object' in selecting a method for
>> > function 'summary': Error: object 'tuc11.2.200.var' not found
>>
>> That's not anything, just the name of your Rdata file. The R object
>> itself keeps the same name as it had when you saved it: variog11.2
>> summary(variog11.2)
>> will show you its properties. If you ls() you'll see there is no R object
>> called
>> tuc11.2.200.var
>>
>> If you want your saved object to have that name, you need to rename it
>> before saving.
>>
>> Sarah
>>
>>

--
Sarah Goslee
http://www.functionaldiversity.org


From acmonmany at gmail.com  Mon Nov  5 17:39:32 2012
From: acmonmany at gmail.com (carolina monmany)
Date: Mon, 5 Nov 2012 12:39:32 -0400
Subject: [R-sig-Geo] Saving a variogram in gstat
In-Reply-To: <CAM_vjukMMDc8husfD38PMuR9EumesO+uMJQowae45aCb-6fqDA@mail.gmail.com>
References: <CANEaUWteMENDUAGHjEZ+Wp+2MZo5Hh8Bx_s2VJZ1wdK9ZfejLA@mail.gmail.com>
	<CAM_vjunwSLd=4tB9sU7pG3DraOo1GXM2VDfB_MZZZSfHP4v1ww@mail.gmail.com>
	<CANEaUWuD9vZo_9cjsytdjuy12dKSaBmbo0TpHpOjO+Too4dQ5g@mail.gmail.com>
	<5097CD28.8050106@jrc.ec.europa.eu>
	<CANEaUWvFpxA61DC69RSin2AsymPkynWNXXWyRZWtChF3dLAPzw@mail.gmail.com>
	<CAM_vjumF+jW1SXgjzXG7cRn2uZ7kxQEKn4uqu71J8pkugOQbiw@mail.gmail.com>
	<CANEaUWtscKM3-R61g7ckgzQw+48jBjUubWq_-K3GToz51c4nFg@mail.gmail.com>
	<CAM_vjukMMDc8husfD38PMuR9EumesO+uMJQowae45aCb-6fqDA@mail.gmail.com>
Message-ID: <CANEaUWsn1jXCvAKTPAjvA5ZV0g2=eFXb-et3y6TwkYDLr0Fk3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/fdc59179/attachment.pl>

From christian.levers at geo.hu-berlin.de  Mon Nov  5 18:52:40 2012
From: christian.levers at geo.hu-berlin.de (Christian Levers)
Date: Mon, 05 Nov 2012 18:52:40 +0100
Subject: [R-sig-Geo] raster package - zonal - standard deviations
In-Reply-To: <AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>
References: <50940478.5000504@geo.hu-berlin.de>
	<AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>
Message-ID: <5097FCE8.2020506@geo.hu-berlin.de>

Hi Rafael,

thanks for the quick reply. I'm using version 2.0-12, on a Win7 platform 
though. Since your little code works also fine for me, I guess its a 
matter of my input raster(s). Here is the printout:

 > relnrg_mskd <- zonal(slope_final_mskd.tif, zone.raster, 'sd')
Fehler in .local(x, z, ...) : stat can be 'sum', 'mean', 'min', or 'max'

f?r:
 > slope_final_mskd.tif
class       : RasterLayer
dimensions  : 5320, 6270, 33356400  (nrow, ncol, ncell)
resolution  : 1000, 1000  (x, y)
extent      : 1500000, 7770000, 740000, 6060000 (xmin, xmax, ymin, ymax)
coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 
+ellps=GRS80 +units=m +no_defs
names       : slope_final_mskd
values      : 0, 46  (min, max)

 > zone.raster
class       : RasterLayer
dimensions  : 5320, 6270, 33356400  (nrow, ncol, ncell)
resolution  : 1000, 1000  (x, y)
extent      : 1500000, 7770000, 740000, 6060000 (xmin, xmax, ymin, ymax)
coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 
+ellps=GRS80 +units=m +no_defs
names       : harvestmap_efi
values      : 1, 460  (min, max)

Cheers,
Christian

Am 05.11.2012 16:35, schrieb Rafael W?est:
> Hi Christian
>
> What version of raster do you use. Using my installation of raster (version 2.0-12), 'sd' as a function in zonal works fine (see example below).
>
> r <- raster(ncols=10, nrows=10)
> r[] <- runif(ncell(r)) * 1:ncell(r)
> z <- r
> z[] <- rep(1:5, each=20)
> zonal(r, z, 'sd')
>       zone      "sd"
> [1,]    1  4.894058
> [2,]    2  9.216353
> [3,]    3 14.144341
> [4,]    4 19.973913
> [5,]    5 27.934773
>
> I guess updating the raster package will solve the problem.
>
> Best,
> Rafael
>
> On 02.11.2012, at 18:35, Christian Levers wrote:
>
>> Hello,
>>
>> I am using the raster package to calculate zonal statistics for my stack of ca. 50 rasters (each raster is about 33 mio. pixels) and I am wondering if there is a simple way to calculate standard deviations for the zones since "sd" is not implemented in the presets for the "stat" argument. If not, I guess defining a function which calculates std.dev is the easiest solution.
>>
>> Thanks in advance and a nice weekend,
>> Christian
>>
>> --
>> MSc Geogr. Christian Levers
>> Doctoral Researcher
>>
>> Biogeography & Conservation Biology
>> Geography Department | Humboldt-Universitaet zu Berlin
>>
>> eMail:  christian.levers at geo.hu-berlin.de
>> phone:  +49 (0) 30 2093 9341
>> fax:    +49 (0) 30 2093 6848
>> mail:   Unter den Linden 6 | 10099 Berlin | Germany
>> web:    http://www.geographie.hu-berlin.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Rafael W?est
> Swiss Federal Research Institute WSL
> Z?rcherstrasse 111
> 8903 Birmensdorf
> Switzerland
>
> +41 44 7392126
> rafael.wueest at wsl.ch
> http://www.wsl.ch/info/mitarbeitende/wueest/index_EN
>
>
>


-- 
MSc Geogr. Christian Levers
Doctoral Researcher

Biogeography & Conservation Biology
Geography Department | Humboldt-Universitaet zu Berlin

eMail:  christian.levers at geo.hu-berlin.de
phone:  +49 (0) 30 2093 9341
fax:    +49 (0) 30 2093 6848
mail:   Unter den Linden 6 | 10099 Berlin | Germany
web:    http://www.geographie.hu-berlin.de


From r.hijmans at gmail.com  Mon Nov  5 19:11:43 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 5 Nov 2012 10:11:43 -0800
Subject: [R-sig-Geo] raster package - zonal - standard deviations
In-Reply-To: <AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>
References: <50940478.5000504@geo.hu-berlin.de>
	<AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>
Message-ID: <CANtt_hy+9PcJkR1z9_1GCAD6sZzo1nPxkC3yFRRE_=qP0sQ=Lg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/5d8a5bf7/attachment.pl>

From paolo.piras at uniroma3.it  Mon Nov  5 19:20:42 2012
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Mon, 5 Nov 2012 18:20:42 +0000
Subject: [R-sig-Geo] different spatial structures for different variables
Message-ID: <A7557249237BD449977E3AEE33C62AD317D8C529@DBXPRD0410MB394.eurprd04.prod.outlook.com>

Dear all,
my question is some-what related to a previous post that received an answer. 
However, this time I want to ask you an advice about the fact that when fitting multivariate-multiple gls model.... different responses and-or different predictors could have DIFFERENT correlation structures (i.e. gaus, exp or spher.).
How then one can fit a unique model?
Maybe one can perform a gls without response for ANY spatially correlated variable by applying the correct corStructure and successively use the residuals of such models in a unique model.
However, I'm not really sure about this.
Thankyou in advance for any advice
Best regards
Paolo Piras

From r.hijmans at gmail.com  Mon Nov  5 19:47:03 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 5 Nov 2012 10:47:03 -0800
Subject: [R-sig-Geo] polygon to raster -"adjusted" method
In-Reply-To: <CAJP9LR6uSi3b9+MnDDHNnBRtAb-oQQ05CKxy2HS0csA=-i1m7w@mail.gmail.com>
References: <CAJP9LR7XuEd_jxE8g1f8fmaO6LicSYHXDtFWfhyxm57FVqkchg@mail.gmail.com>
	<CANtt_hwai6fcK3fp9H_ADKgq5Wd6rYnKCRk3Bx2_8xzvbvfAFA@mail.gmail.com>
	<CAJP9LR49zWMMR_d0PmBXU2u3U3w3E_N4A4GcFGwpYiZe6E-h2g@mail.gmail.com>
	<CANtt_hwpENYQ2q8Jadb-H-SYEPpqncd+WzBaN3EhQE2se-RNZg@mail.gmail.com>
	<CAJP9LR6uSi3b9+MnDDHNnBRtAb-oQQ05CKxy2HS0csA=-i1m7w@mail.gmail.com>
Message-ID: <CANtt_hyVLhZvZrMxnKGQiuhQSr4AYYEnihnpp=QNHxdJHQMZqw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121105/0d0543e5/attachment.pl>

From raffaele.morelli at gmail.com  Tue Nov  6 14:42:36 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 6 Nov 2012 14:42:36 +0100
Subject: [R-sig-Geo] rgdal & spatstat: gtiff
Message-ID: <CAD4guxP2611Yo8T_qhF6cAc73KpjdWOd8tBrPBMp+_8Uwoci-A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/1a3914e4/attachment.pl>

From lluis at sigte.udg.es  Tue Nov  6 15:32:23 2012
From: lluis at sigte.udg.es (Jornadas de SIG Libre)
Date: Tue, 06 Nov 2012 15:32:23 +0100
Subject: [R-sig-Geo] Call for Abstracts: VII Jornadas de SIG Libre,
	March 2013
Message-ID: <50991F77.7020903@sigte.udg.es>

Dear,

Call for Abstracts to VII Jornadas de SIG Libre (Spanish FOSS4G) is 
still open until November 21st. We count on your active participation! 
The Spanish FOSS4G, aka Jornadas de SIG Libre, is the Spanish event 
centered on free and open source software for Geospatial, that takes 
place in Girona every March. Spanish is the official language of the 
Conference but English papers/communications are also accepted.

If you have any doubt, do not hesitate to contact us

More information:

http://www.sigte.udg.edu/jornadassiglibre/
http://www.sigte.udg.edu/jornadassiglibre/comunicaciones
http://sigserver4.udg.edu/wiki_jornadas/index.php/Anuncio_2

Best regards,

-- 
Llu?s Vicens
Comit? Organizador Local
Jornadas de SIG Libre

Sitio web:http://www.sigte.udg.edu/jornadassiglibre
S?guenos en:https://twitter.com/#!/SIGLibreGirona


From kmcoulib at gmail.com  Tue Nov  6 17:16:01 2012
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Tue, 6 Nov 2012 11:16:01 -0500
Subject: [R-sig-Geo] error in Crop command from Raster package
Message-ID: <CANcefXYYFHxF6X=tOySR3x4zaefvgmXOG8DtuBg0k3w1xvYSSw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/3d6740b5/attachment.pl>

From christian.levers at geo.hu-berlin.de  Tue Nov  6 17:59:23 2012
From: christian.levers at geo.hu-berlin.de (Christian Levers)
Date: Tue, 06 Nov 2012 17:59:23 +0100
Subject: [R-sig-Geo] raster package - zonal - standard deviations
In-Reply-To: <CANtt_hy+9PcJkR1z9_1GCAD6sZzo1nPxkC3yFRRE_=qP0sQ=Lg@mail.gmail.com>
References: <50940478.5000504@geo.hu-berlin.de>
	<AA1DF475-1B7F-433F-BFEA-6B7C0B68F806@wsl.ch>
	<CANtt_hy+9PcJkR1z9_1GCAD6sZzo1nPxkC3yFRRE_=qP0sQ=Lg@mail.gmail.com>
Message-ID: <509941EB.7040200@geo.hu-berlin.de>

Thanks a lot Robert!

Indeed it's (obviously) a matter of memory (although our server has 
approx 200GB RAM). While simulating RAM limitations, I obtain the same 
message: error in .local(x, z, ...) : stat can be 'sum', 'mean', 'min', 
or 'max'.

Changing maxmemory doesn't improve things, even with 1E+20. I was 
thinking on looping through the zones (my layer has just 460) and using 
cellStats, too.

Thanks again and all the best from Berlin,
Christian


Am 05.11.2012 19:11, schrieb Robert J. Hijmans:
>
> The small example can be processed in memory, so any sensible function
> will work.
>
> library(raster)
> r <- raster(ncols=10, nrows=10)
> r[] <- runif(ncell(r)) * 1:ncell(r)
> z <- r
> z[] <- rep(1:5, each=20)
> zonal(r, z, 'sd')
>
> # simulate RAM limitation:
> setOptions(todisk=TRUE)
> zonal(r, z, 'sd')
> # don't forget to turn this off.
> setOptions(todisk=FALSE)
>
> # perhaps you can overcome that by changing "maxmemory". See
> showOptions()
> setOptions(maxmemory=1e+10)
>
>
> I will also add an "sd" function to zonal for large rasters. That is not
> as simple as for min, max, and sum, but it can be done, as it is done in
> cellStats. If you do not have too many zones, you could, for now, use a
> loop with a combination of reclass/mask/cellStats to extract the sd for
> each zone.
>
> Robert
>
>
>
> On Mon, Nov 5, 2012 at 7:35 AM, Rafael W?est <rafael.wueest at wsl.ch
> <mailto:rafael.wueest at wsl.ch>> wrote:
>
>     Hi Christian
>
>     What version of raster do you use. Using my installation of raster
>     (version 2.0-12), 'sd' as a function in zonal works fine (see
>     example below).
>
>     r <- raster(ncols=10, nrows=10)
>     r[] <- runif(ncell(r)) * 1:ncell(r)
>     z <- r
>     z[] <- rep(1:5, each=20)
>     zonal(r, z, 'sd')
>           zone      "sd"
>     [1,]    1  4.894058
>     [2,]    2  9.216353
>     [3,]    3 14.144341
>     [4,]    4 19.973913
>     [5,]    5 27.934773
>
>     I guess updating the raster package will solve the problem.
>
>     Best,
>     Rafael
>
>     On 02.11.2012, at 18:35, Christian Levers wrote:
>
>      > Hello,
>      >
>      > I am using the raster package to calculate zonal statistics for
>     my stack of ca. 50 rasters (each raster is about 33 mio. pixels) and
>     I am wondering if there is a simple way to calculate standard
>     deviations for the zones since "sd" is not implemented in the
>     presets for the "stat" argument. If not, I guess defining a function
>     which calculates std.dev is the easiest solution.
>      >
>      > Thanks in advance and a nice weekend,
>      > Christian
>      >
>      > --
>      > MSc Geogr. Christian Levers
>      > Doctoral Researcher
>      >
>      > Biogeography & Conservation Biology
>      > Geography Department | Humboldt-Universitaet zu Berlin
>      >
>      > eMail: christian.levers at geo.hu-berlin.de
>     <mailto:christian.levers at geo.hu-berlin.de>
>      > phone: +49 (0) 30 2093 9341 <tel:%2B49%20%280%29%2030%202093%209341>
>      > fax: +49 (0) 30 2093 6848 <tel:%2B49%20%280%29%2030%202093%206848>
>      > mail:   Unter den Linden 6 | 10099 Berlin | Germany
>      > web: http://www.geographie.hu-berlin.de
>      >
>      > _______________________________________________
>      > R-sig-Geo mailing list
>      > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>     --
>     Rafael W?est
>     Swiss Federal Research Institute WSL
>     Z?rcherstrasse 111
>     8903 Birmensdorf
>     Switzerland
>
>     +41 44 7392126 <tel:%2B41%2044%207392126>
>     rafael.wueest at wsl.ch <mailto:rafael.wueest at wsl.ch>
>     http://www.wsl.ch/info/mitarbeitende/wueest/index_EN
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
MSc Geogr. Christian Levers
Doctoral Researcher

Biogeography & Conservation Biology
Geography Department | Humboldt-Universitaet zu Berlin

eMail:  christian.levers at geo.hu-berlin.de
phone:  +49 (0) 30 2093 9341
fax:    +49 (0) 30 2093 6848
mail:   Unter den Linden 6 | 10099 Berlin | Germany
web:    http://www.geographie.hu-berlin.de


From r.hijmans at gmail.com  Tue Nov  6 19:42:50 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Nov 2012 10:42:50 -0800
Subject: [R-sig-Geo] error in Crop command from Raster package
In-Reply-To: <CANcefXYYFHxF6X=tOySR3x4zaefvgmXOG8DtuBg0k3w1xvYSSw@mail.gmail.com>
References: <CANcefXYYFHxF6X=tOySR3x4zaefvgmXOG8DtuBg0k3w1xvYSSw@mail.gmail.com>
Message-ID: <CANtt_hzmA9KwG0NwsK0whGcHyiemsomcJw=m9FNxHOHH8GzW=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/6f887c55/attachment.pl>

From WSteenbeek at nscr.nl  Tue Nov  6 21:30:32 2012
From: WSteenbeek at nscr.nl (Wouter Steenbeek)
Date: Tue, 6 Nov 2012 21:30:32 +0100
Subject: [R-sig-Geo] how to draw a new circle/round polygon on existing plot
Message-ID: <6F935AB43360774EB2A937510A67E5D310E9AF6C5B@exchsvr1.arthur.nscr.nl>

I have a plot with several layers of SpatialPoints and Polygons. They are all projected and in the correct CRS, so my map looks like it should. I now want to draw a circle with a radius x on a part of this map. This should not just be a circle, but be in the correct projection (so that I can change radius x to whatever I desire, and the circle is drawn correctly on scale, and slightly "distorted" dependent on my zoom of the map).

How do I do this? Thanks!

(I understand that I should define a new polygon and "plot(..., add=T)" that to my map. But how do I make such a polygon? I don't quite understand the "polygon" function in the 'graphics' package, if that's even the correct one to use. Seeing an example would help.)


From kmcoulib at gmail.com  Tue Nov  6 21:58:32 2012
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Tue, 6 Nov 2012 15:58:32 -0500
Subject: [R-sig-Geo] error in Crop command from Raster package
In-Reply-To: <CANtt_hzmA9KwG0NwsK0whGcHyiemsomcJw=m9FNxHOHH8GzW=A@mail.gmail.com>
References: <CANcefXYYFHxF6X=tOySR3x4zaefvgmXOG8DtuBg0k3w1xvYSSw@mail.gmail.com>
	<CANtt_hzmA9KwG0NwsK0whGcHyiemsomcJw=m9FNxHOHH8GzW=A@mail.gmail.com>
Message-ID: <CANcefXb1DvS-AyfRf_eTH+hQ+7wKZDUO_a-rMwjjxtm4S8-gEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/60c10624/attachment.pl>

From etiennebr at gmail.com  Tue Nov  6 23:06:36 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 6 Nov 2012 17:06:36 -0500
Subject: [R-sig-Geo] raster parallelization
In-Reply-To: <CANtt_hw0KM0kAL0_Vi2=0OOUj8rE3+GYLHR9Q2B6VO9UYS2kUg@mail.gmail.com>
References: <CABG0rfuO30v40iFgEgK4J4KvGJvLTH3y5433ZjZ6NB31SpAraA@mail.gmail.com>
	<CANtt_hw0KM0kAL0_Vi2=0OOUj8rE3+GYLHR9Q2B6VO9UYS2kUg@mail.gmail.com>
Message-ID: <CALjAYt4SJQzGAnhEq=FJs0CbP_12rrUUZYUfQiU20QStS7hQpQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/6528f7ef/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Nov  6 23:42:46 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 06 Nov 2012 23:42:46 +0100
Subject: [R-sig-Geo] how to draw a new circle/round polygon on existing
 plot
In-Reply-To: <6F935AB43360774EB2A937510A67E5D310E9AF6C5B@exchsvr1.arthur.nscr.nl>
References: <6F935AB43360774EB2A937510A67E5D310E9AF6C5B@exchsvr1.arthur.nscr.nl>
Message-ID: <50999266.1050205@uni-muenster.de>

x = 10 # center x
y = 10 # center y
n = 100 # nr of pts
r = 5 # radius
pts = seq(0, 2 * pi, length.out = n)
plot(sin(pts), cos(pts), type = 'l', asp = 1) # test
require(sp)
xy = cbind(x + r * sin(pts), y + r * cos(pts))
sl= SpatialLines(list(Lines(list(Line(xy)), "line")))
plot(sl, add=FALSE, col = 'red', axes=T )

this draws a circle as a line; if you want a filled polygon, I'd replace
every instance of Line with Polygon (but mind the s).

On 11/06/2012 09:30 PM, Wouter Steenbeek wrote:
> I have a plot with several layers of SpatialPoints and Polygons. They are all projected and in the correct CRS, so my map looks like it should. I now want to draw a circle with a radius x on a part of this map. This should not just be a circle, but be in the correct projection (so that I can change radius x to whatever I desire, and the circle is drawn correctly on scale, and slightly "distorted" dependent on my zoom of the map).
> 
> How do I do this? Thanks!
> 
> (I understand that I should define a new polygon and "plot(..., add=T)" that to my map. But how do I make such a polygon? I don't quite understand the "polygon" function in the 'graphics' package, if that's even the correct one to use. Seeing an example would help.)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Wed Nov  7 00:51:03 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Nov 2012 15:51:03 -0800
Subject: [R-sig-Geo] raster parallelization
In-Reply-To: <CALjAYt4SJQzGAnhEq=FJs0CbP_12rrUUZYUfQiU20QStS7hQpQ@mail.gmail.com>
References: <CABG0rfuO30v40iFgEgK4J4KvGJvLTH3y5433ZjZ6NB31SpAraA@mail.gmail.com>
	<CANtt_hw0KM0kAL0_Vi2=0OOUj8rE3+GYLHR9Q2B6VO9UYS2kUg@mail.gmail.com>
	<CALjAYt4SJQzGAnhEq=FJs0CbP_12rrUUZYUfQiU20QStS7hQpQ@mail.gmail.com>
Message-ID: <CANtt_hyBS+CarpEgCUJUf__txnS7a8cB2EOBmmY2cZHxyskyPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121106/28f9718d/attachment.pl>

From Roche.Tom at epamail.epa.gov  Wed Nov  7 04:39:20 2012
From: Roche.Tom at epamail.epa.gov (Tom Roche)
Date: Tue, 06 Nov 2012 22:39:20 -0500
Subject: [R-sig-Geo] [gstat] simple reboxing test fails
Message-ID: <87vcdi3wuv.fsf@pobox.com>


summary: I'm trying to test reboxing, or 3D interpolation, using
package=gstat. The idea is to create a uniform input grid of box/voxel
dimensions=2x2x2 with each box value=1, then "rebox" to a uniform output
grid with dimensions=1x1x8; presumably the output box values should
approximate the input box values. (Or am I missing something?) But all
my predicted box values=NA; how to fix?

details:

sessionInfo()
# gets
#> R version 2.15.1 (2012-06-22)
#> Platform: x86_64-pc-linux-gnu (64-bit)
#> 
#> locale:
#>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
#>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
#>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
#>  [7] LC_PAPER=C                 LC_NAME=C                 
#>  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
#> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
#> 
#> attached base packages:
#> [1] stats     graphics  grDevices utils     datasets  methods   base
#> 
#> loaded via a namespace (and not attached):
#> [1] tools_2.15.1

library(gstat)

# horizontal grid sequences for 4x4 grid with cell area=4
hor.from.in <- 0
hor.to.in   <- 8
hor.by.in   <- 2
# grid corners
corners.hor.in <- seq(from=hor.from.in, to=hor.to.in, by=hor.by.in)
#corners.hor.in
# grid midpoints
midpts.hor.in <-
  seq(from=(hor.from.in+(hor.by.in/2)),
      to=(hor.to.in-(hor.by.in/2)),
      by=hor.by.in)
midpts.hor.in
#> [1] 1 3 5 7

# vertical grid sequence for 4 layers with height=2
ver.from.in <- 0
ver.to.in   <- 8
ver.by.in   <- 2
corners.ver.in <- seq(from=ver.from.in, to=ver.to.in, by=ver.by.in)
#corners.ver.in
midpts.ver.in <-
  seq(from=(ver.from.in+(ver.by.in/2)),
      to=(ver.to.in-(ver.by.in/2)),
      by=ver.by.in)
midpts.ver.in
#> [1] 1 3 5 7

grid3D.in <-
  expand.grid(x=midpts.hor.in, y=midpts.hor.in, z=midpts.ver.in)
# more on grid3D.in (the input grid) below

val.in <- 1.0 # data value for each input box of volume=8
data3D.in <-
  data.frame(v=rep(val.in, times=length(row.names(grid3D.in))))
coordinates(data3D.in) <- grid3D.in
summary(data3D.in)
#> Object of class SpatialPointsDataFrame
#> Coordinates:
#>   min max
#> x   1   7
#> y   1   7
#> z   1   7
#> Is projected: NA 
#> proj4string : [NA]
#> Number of points: 64
#> Data attributes:
#>   Min. 1st Qu.  Median  Mean 3rd Qu.  Max. 
#>      1       1       1     1       1     1 

# so each datum=1 in the input data (data3D.in)

gridded(grid3D.in)=~x+y+z
summary(grid3D.in)
#> Object of class SpatialPixels
#> Coordinates:
#>   min max
#> x   0   8
#> y   0   8
#> z   0   8
#> Is projected: NA 
#> proj4string : [NA]
#> Number of points: 64
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> x                 1        2         4
#> y                 1        2         4
#> z                 1        2         4

# so there are 64 box/voxels each of volume=8 in the input grid

# horizontal grid sequences for 8x8 grid with cell area=1
hor.from.out <- 0
hor.to.out   <- 8
hor.by.out   <- 1
corners.hor.out <- seq(from=hor.from.out, to=hor.to.out, by=hor.by.out)
corners.hor.out
midpts.hor.out <- seq(from=(hor.from.out+(hor.by.out/2)), to=(hor.to.out-(hor.by.out/2)), by=hor.by.out)
midpts.hor.out
#> [1] 0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5

# vertical grid sequence for 1 layer with height=8
ver.from.out <- 0
ver.to.out   <- 8
ver.by.out   <- 8
corners.ver.out <- seq(from=ver.from.out, to=ver.to.out, by=ver.by.out)
corners.ver.out
midpts.ver.out <- seq(from=(ver.from.out+(ver.by.out/2)), to=(ver.to.out-(ver.by.out/2)), by=ver.by.out)
midpts.ver.out
# 4

# This fails to create
# 64 boxes each of volume=8 (but 1x1x8 instead of 2x2x2)
grid3D.out <- expand.grid(x=midpts.hor.out, y=midpts.hor.out, z=midpts.ver.out)
gridded(grid3D.out)=~x+y+z
summary(grid3D.out)
# gets
#> Object of class SpatialPixels
#> Coordinates:
#>   min max
#> x 0.0 8.0
#> y 0.0 8.0
#> z 3.5 4.5 ############################ NO! I want cellsize=8
#> Is projected: NA 
#> proj4string : [NA]
#> Number of points: 64
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> x               0.5        1         8
#> y               0.5        1         8
#> z               4.0        1         1

# This appears to create
# 64 boxes each of volume=8 (but 1x1x8 instead of 2x2x2)
grid3D.out <-
  SpatialGrid(
    GridTopology(
      c(0.5,0.5,4.0), # centers
      c(1.0,1.0,8.0), # sizes
      c(8,  8,  1)),  # dim/number
    proj4string = CRS(as.character(NA)))
summary(grid3D.out)
# gets
#> Object of class SpatialGrid
#> Coordinates:
#>      min max
#> [1,]   0   8
#> [2,]   0   8
#> [3,]   0   8
#> Is projected: NA 
#> proj4string : [NA]
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> 1               0.5        1         8
#> 2               0.5        1         8
#> 3               4.0        8         1

# so each box/voxel volume=8 in the output grid (grid3D.out), no?

# Here I fail to get the values for the output grid :-(
data3D.out <- krige(formula=v ~ 1, data3D.in, grid3D.out)
summary(data3D.out)
# gets
#> Object of class SpatialGridDataFrame
#> Coordinates:
#>      min max
#> [1,]   0   8
#> [2,]   0   8
#> [3,]   0   8
#> Is projected: NA 
#> proj4string : [NA]
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> 1               0.5        1         8
#> 2               0.5        1         8
#> 3               4.0        8         1
#> Data attributes:
#>    var1.pred    var1.var  
#>  Min.   :1   Min.   : NA  
#>  1st Qu.:1   1st Qu.: NA  
#>  Median :1   Median : NA  
#>  Mean   :1   Mean   :NaN  
#>  3rd Qu.:1   3rd Qu.: NA  
#>  Max.   :1   Max.   : NA  
#>              NA's   :64   

What should I call to get the values for the output grid boxes?

Your assistance is appreciated, Tom Roche <Tom_Roche at pobox.com>


From Roche.Tom at epamail.epa.gov  Wed Nov  7 05:28:35 2012
From: Roche.Tom at epamail.epa.gov (Tom Roche)
Date: Tue, 06 Nov 2012 23:28:35 -0500
Subject: [R-sig-Geo] [GSIF] what API to call for a simple reboxing test?
Message-ID: <87sj8m3uks.fsf@pobox.com>


summary: I'm trying to test reboxing, or 3D interpolation, using
package=GSIF. The idea is to

* assume a uniform input field

* create a uniform input grid with box/voxel dimensions=2x2x2 with
  each box having value=1

* "rebox" to a uniform output grid with dimensions=1x1x8: if output
  box values approximate input box values, declare test to pass.

But I'm not seeing what GSIF API to call to calculate the output box
values, and my geostatistical background (or lack thereof) does not
prepare me for

http://gsif.r-forge.r-project.org/tutorial_eberg.php

details:

# 1. Create 3D input grid and data such that each of its regular boxes
#    has dims=2x2x2 and value=1

# horizontal grid sequences to produce input 2D grid unit area=4
hor.from.in <- 0
hor.to.in   <- 8
hor.by.in   <- 2
# grid corners
corners.hor.in <- seq(from=hor.from.in, to=hor.to.in, by=hor.by.in)
#corners.hor.in
# grid midpoints
midpts.hor.in <-
  seq(from=(hor.from.in+(hor.by.in/2)),
      to=(hor.to.in-(hor.by.in/2)),
      by=hor.by.in)
#midpts.hor.in

# vertical grid sequence to produce input 3D grid unit volume=8
ver.from.in <- 0
ver.to.in   <- 8
ver.by.in   <- 2
corners.ver.in <- seq(from=ver.from.in, to=ver.to.in, by=ver.by.in)
#corners.ver.in
midpts.ver.in <-
  seq(from=(ver.from.in+(ver.by.in/2)),
      to=(ver.to.in-(ver.by.in/2)),
      by=ver.by.in)
#midpts.ver.in

grid3D.in <-
  expand.grid(x=midpts.hor.in, y=midpts.hor.in, z=midpts.ver.in)
# examined below

val.in <- 1.0 # data value for each input box of volume=8
data3D.in <-
  data.frame(v=rep(val.in, times=length(row.names(grid3D.in))))
coordinates(data3D.in) <- grid3D.in
summary(data3D.in)
#> Object of class SpatialPointsDataFrame
#> Coordinates:
#>   min max
#> x   1   7
#> y   1   7
#> z   1   7
#> Is projected: NA 
#> proj4string : [NA]
#> Number of points: 64
#> Data attributes:
#>   Min. 1st Qu.  Median  Mean 3rd Qu.  Max. 
#>      1       1       1     1       1     1 

gridded(grid3D.in)=~x+y+z
summary(grid3D.in)
#> Object of class SpatialPixels
#> Coordinates:
#>   min max
#> x   0   8
#> y   0   8
#> z   0   8
#> Is projected: NA 
#> proj4string : [NA]
#> Number of points: 64
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> x                 1        2         4
#> y                 1        2         4
#> z                 1        2         4

# So there are 64 box/voxels each of volume=8 in the input grid
# and each box has value=1.

# 2. Create 3D output grid such that each of its regular boxes
#    has dims=1x1x8

# Previous grid setup method fails, so instead do

grid3D.out <-
  SpatialGrid(
    GridTopology(
      c(0.5,0.5,4.0), # centers
      c(1.0,1.0,8.0), # sizes
      c(8,  8,  1)),  # dim/number
    proj4string = CRS(as.character(NA)))
summary(grid3D.out)
# gets
#> Object of class SpatialGrid
#> Coordinates:
#>      min max
#> [1,]   0   8
#> [2,]   0   8
#> [3,]   0   8
#> Is projected: NA 
#> proj4string : [NA]
#> Grid attributes:
#>   cellcentre.offset cellsize cells.dim
#> 1               0.5        1         8
#> 2               0.5        1         8
#> 3               4.0        8         1

# So there are 64 box/voxels each of volume=8 in the output grid.

Since the input and output spaces are uniform, and each contains total
values=64, I'm assuming I should be able to calculate (aka predict) the
values in each output box, and furthermore that the output box values
should approximate the input box values. Am I missing something? If not:

How to call GSIF API to compute the values of the output boxes from the
input grid and its values?

Your assistance is appreciated, Tom Roche <Tom_Roche at pobox.com>


From Tom_Roche at pobox.com  Wed Nov  7 05:48:39 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Tue, 06 Nov 2012 23:48:39 -0500
Subject: [R-sig-Geo] "regridding" netCDF?
In-Reply-To: <CAK8gSG9k-+NNamkd7wx9d+AVf=0veQc8g+YA3MV9wrY8T6oWGA@mail.gmail.com>
References: <CAK8gSG9k-+NNamkd7wx9d+AVf=0veQc8g+YA3MV9wrY8T6oWGA@mail.gmail.com>
	<87mx3ew372.fsf@pobox.com>
	<CAK8gSG-7VFTN9zQTjU+cWGKti0-HMyFmYLwssS1q7i=aaxvWOw@mail.gmail.com>
	<87objhrggn.fsf@pobox.com> 
Message-ID: <87pq3q3tnc.fsf@pobox.com>


Tom Roche Thu, Nov 1, 2012 at 2:21 AM
>> See code [for lon-lat to LCC regridding] @

>>https://github.com/TomRoche/GEIA_to_NetCDF

>> esp

>> https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r

ping yang Tue, 6 Nov 2012 20:36:12 -0500 (rearranged)
> Thank you so much for your script.

Thanks to Dr Hijmans (and, presumably, his funders) for package=raster.
Hopefully this will free folks who run Eulerian models from having to
write Fortran merely to do this kind of one-off data assimilation. (And
hopefully we can figure out how to do this in 3D for boundary/initial
conditions.)

> I am digging into it,

Feel free to ask questions and CC: r-sig-geo

> I am a little new to R,

Me too--I was only java and python until about a year ago.

FWIW, Tom Roche <Tom_Roche at pobox.com>


From osoong+r at gmail.com  Wed Nov  7 06:41:58 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Tue, 6 Nov 2012 21:41:58 -0800
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
Message-ID: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>

So I'm also using the raster package, and the datum problems with
rgdal are inherited.  For those who haven't been following this
thread, there is a workaround as of rgdal 0.7.22 and setting
OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = FALSE.  Is there any way to have
raster respect this setting?  For small rasters, I know I can use
readGDAL and coerce the SpatialGridDataFrame to a RasterLayer, but
this requires being able to load the entire raster into memory.

R 2.15.1 32-bit, rgdal 0.7.22, raster 2.0.12, Windows XP/7.

Test code, translated from the rgdal example:

ext <- extent(-2100050, -2099950, 1199950, 1200050)
p4s <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
+y_0=0 +datum=NAD83 +units=m +no_defs"
img1 <- raster(nrows = 1, ncols = 1, crs = p4s, ext = ext)
values(img1) <- 0
img1.file <- file.path(tempdir(), "img1.tif")
writeRaster(img1, img1.file, "GTiff", overwrite = TRUE)
img2 <- raster(img1.file)
img3 <- readGDAL(img1.file, OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = FALSE)
projection(img1)
projection(img2)
projection(img3)

Thanks,
Oliver


On Fri, Nov 2, 2012 at 1:03 AM, Oliver Soong <osoong+r at gmail.com> wrote:
> R 2.15.1 32-bit, rgdal 0.7.20, Windows 7.
>
> grid <- GridTopology(c(-2100000, 1200000), c(100, 100), c(1, 1))
> p4s <- CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96
> +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
> +towgs84=0,0,0")
> img1 <- SpatialGridDataFrame(grid, data.frame(band1 = 1), p4s)
> img1.file <- file.path(tempdir(), "img1.tif")
> writeGDAL(img1, img1.file)
> img2 <- readGDAL(img1.file)
> img2.file <- file.path(tempdir(), "img2.tif")
> writeGDAL(img2, img2.file)
> img1 at proj4string
> img2 at proj4string
>
> For me, img1 at proj4string has +datum=NAD83 and img2 at proj4string does
> not.  Not surprisingly, if I look at both files in Arc, img1 has a
> defined datum and img2 does not.
>
> Am I doing anything wrong?
>
> Oliver


From edzer.pebesma at uni-muenster.de  Wed Nov  7 08:44:32 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Nov 2012 08:44:32 +0100
Subject: [R-sig-Geo] [gstat] simple reboxing test fails
In-Reply-To: <87vcdi3wuv.fsf@pobox.com>
References: <87vcdi3wuv.fsf@pobox.com>
Message-ID: <509A1160.4010101@uni-muenster.de>



On 11/07/2012 04:39 AM, Tom Roche wrote:
> 
...
>  But all
> my predicted box values=NA; how to fix?
> 
> details:
...
> # Here I fail to get the values for the output grid :-(
> data3D.out <- krige(formula=v ~ 1, data3D.in, grid3D.out)
> summary(data3D.out)
> # gets
> #> Object of class SpatialGridDataFrame
> #> Coordinates:
> #>      min max
> #> [1,]   0   8
> #> [2,]   0   8
> #> [3,]   0   8
> #> Is projected: NA 
> #> proj4string : [NA]
> #> Grid attributes:
> #>   cellcentre.offset cellsize cells.dim
> #> 1               0.5        1         8
> #> 2               0.5        1         8
> #> 3               4.0        8         1
> #> Data attributes:
> #>    var1.pred    var1.var  
> #>  Min.   :1   Min.   : NA  
> #>  1st Qu.:1   1st Qu.: NA  
> #>  Median :1   Median : NA  
> #>  Mean   :1   Mean   :NaN  
> #>  3rd Qu.:1   3rd Qu.: NA  
> #>  Max.   :1   Max.   : NA  
> #>              NA's   :64   
> 
> What should I call to get the values for the output grid boxes?

Did you notice the predictions in var1.pred values are all 1? (inverse
distance always returns NA values for the prediction variance var1.var)
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alobolistas at gmail.com  Wed Nov  7 11:44:55 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 7 Nov 2012 11:44:55 +0100
Subject: [R-sig-Geo] towgs snd prj files
Message-ID: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>

This might be a bit off-topic.
I do:
> wpBert700 at proj4string
CRS arguments:
 +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
+towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
> writeOGR(wpBert700,dsn="wpBert700v2",layer="wpBert700v2",driver="ESRI Shapefile",overwrite=T)

But the created prj file:
PROJCS["UTM_Zone_31_Northern_Hemisphere",GEOGCS["GCS_International
1909 (Hayford)",DATUM["D_unknown",SPHEROID["intl",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]

lacks the +towgs84=-87,-98,-121,0,0,0,0 information, which is a
problem if I do not remember I have to add it for a GIS display
with reprojection on the fly.
Is there any vector format that can  be written by rgdal in which the
CRS info would include the +towgs84=-87,-98,-121,0,0,0,0 ?

Thanks!

Agus


From leila.brook at my.jcu.edu.au  Wed Nov  7 12:39:39 2012
From: leila.brook at my.jcu.edu.au (Leila Brook)
Date: Wed, 7 Nov 2012 11:39:39 +0000
Subject: [R-sig-Geo] converting a single animal home range (estUD) to spixdf
Message-ID: <9BEE83C6BF59174DBD2CB4A06EB6CBEB329C287B@SINPRD0111MB368.apcprd01.prod.exchangelabs.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121107/c5480615/attachment.pl>

From Roger.Bivand at nhh.no  Wed Nov  7 13:21:38 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Nov 2012 13:21:38 +0100
Subject: [R-sig-Geo] towgs snd prj files
In-Reply-To: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
References: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211071227520.13751@reclus.nhh.no>

On Wed, 7 Nov 2012, Agustin Lobo wrote:

> This might be a bit off-topic.

There is no guarantee of any kind that GDAL/OGR will reproduce the same 
projection parameters on re-reading, and there is nothing in sp/rgdal that 
can be done about this. The thread at:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016581.html

did permit an extra argument to be passed to readGDAL() to preserve datum 
in addition to equivalent ellps and towgs84 tags.

The underlying difficulties are that none of the various spatial reference 
systems are unequivocal, and changing between PROJ.4, WKT, and others 
(EPSG codes in different versions) may drop tags, especially where they 
are not uniquely defined.

On R-forge (revision 383) I have added a morphToESRI= logical argument to 
writeOGR(), NULL default, set automatically TRUE if the driver is "ESRI 
Shapefile" and FALSE for all other drivers (this is the same as internal 
code has always been). The user may try to see whether this makes a 
difference, I didn't see any difference in the exported WKT written in the 
*.prj file.

The main issue is that for any given specification, the towgs84 tag may 
not be unique (or other tags), so that the PROJ.4/GDAL policy is not to do 
anything that might not be accurate in conversion. There are no easy 
solutions here.

In your case, for the copy og EPSG distributed with rgdal in the binary 
Windows and OSX packages, and for my PROJ.4/GDAL combination:

> CRS("+init=epsg:23031")
CRS arguments:
  +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
+towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs

but http://spatialreference.org/ref/epsg/23031/ does not include a 
+towgs84 term. Which is credible? This is an ED50 projection/datum, so I'd 
actually trust dropping towgs84 more than keeping it. The web page 
suggests that the ED50 datum should be defined by country with respect to 
towgs84; I often look at Grids & Datums to cross-check:

http://www.asprs.org/Grids-Datums.html

Hope this helps,

Roger

> I do:
>> wpBert700 at proj4string
> CRS arguments:
> +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>> writeOGR(wpBert700,dsn="wpBert700v2",layer="wpBert700v2",driver="ESRI Shapefile",overwrite=T)
>
> But the created prj file:
> PROJCS["UTM_Zone_31_Northern_Hemisphere",GEOGCS["GCS_International
> 1909 (Hayford)",DATUM["D_unknown",SPHEROID["intl",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> lacks the +towgs84=-87,-98,-121,0,0,0,0 information, which is a
> problem if I do not remember I have to add it for a GIS display
> with reprojection on the fly.
> Is there any vector format that can  be written by rgdal in which the
> CRS info would include the +towgs84=-87,-98,-121,0,0,0,0 ?
>
> Thanks!
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Nov  7 13:24:33 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 7 Nov 2012 13:24:33 +0100
Subject: [R-sig-Geo] towgs snd prj files
In-Reply-To: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
References: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
Message-ID: <CAG4NReKiqK41a+=NCPQU31vO_bmDYqAYs8cnAeSOd3CtBDEERg@mail.gmail.com>

Just to complement the info I provided, QGIS writes, for the same
proj4 info, the following prj file:
PROJCS["ED50_UTM_zone_31N",GEOGCS["GCS_European_1950",DATUM["D_European_1950",SPHEROID["International_1924",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]

which is a bit different than the prj written by writeOGR() (see former message)

The point is that when QGIS opens a shapefile with the prj written by
writeOGR(), the towgs84 coefficients are not assumed, while
when it reads a shapefile with the prj written by QGIS (above), the
towgs84 coefficients are assumed. And this has implications
in the onthefly reprojection.

I do not know if this is a QGIS idiosyncratic behaviour or it is
generally assumed that ["ED50_UTM_zone_31N" includes the towgs84
coefficients

Agus

On Wed, Nov 7, 2012 at 11:44 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> This might be a bit off-topic.
> I do:
>> wpBert700 at proj4string
> CRS arguments:
>  +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>> writeOGR(wpBert700,dsn="wpBert700v2",layer="wpBert700v2",driver="ESRI Shapefile",overwrite=T)
>
> But the created prj file:
> PROJCS["UTM_Zone_31_Northern_Hemisphere",GEOGCS["GCS_International
> 1909 (Hayford)",DATUM["D_unknown",SPHEROID["intl",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> lacks the +towgs84=-87,-98,-121,0,0,0,0 information, which is a
> problem if I do not remember I have to add it for a GIS display
> with reprojection on the fly.
> Is there any vector format that can  be written by rgdal in which the
> CRS info would include the +towgs84=-87,-98,-121,0,0,0,0 ?
>
> Thanks!
>
> Agus


From alobolistas at gmail.com  Wed Nov  7 13:32:07 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 7 Nov 2012 13:32:07 +0100
Subject: [R-sig-Geo] towgs snd prj files
In-Reply-To: <alpine.LRH.2.02.1211071227520.13751@reclus.nhh.no>
References: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
	<alpine.LRH.2.02.1211071227520.13751@reclus.nhh.no>
Message-ID: <CAG4NRe+ms=zH0+1b7oAmDjJLGAhBuH1qu+Uy=sOgL-uhjx+gpg@mail.gmail.com>

ok, thanks, just got your message while I was typing my second one.
It seems we have to live with this issue. The best is probably make a version
of the object in both datums via spTransform() and then write 2
shapefiles as well.

Or perhaps using spatialite objects instead of shapfiles would be a solution?
http://www.gaia-gis.it/spatialite-2.0/SpatiaLite2-tutorial.html#t5

Agus

On Wed, Nov 7, 2012 at 1:21 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 7 Nov 2012, Agustin Lobo wrote:
>
>> This might be a bit off-topic.
>
>
> There is no guarantee of any kind that GDAL/OGR will reproduce the same
> projection parameters on re-reading, and there is nothing in sp/rgdal that
> can be done about this. The thread at:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016581.html
>
> did permit an extra argument to be passed to readGDAL() to preserve datum in
> addition to equivalent ellps and towgs84 tags.
>
> The underlying difficulties are that none of the various spatial reference
> systems are unequivocal, and changing between PROJ.4, WKT, and others (EPSG
> codes in different versions) may drop tags, especially where they are not
> uniquely defined.
>
> On R-forge (revision 383) I have added a morphToESRI= logical argument to
> writeOGR(), NULL default, set automatically TRUE if the driver is "ESRI
> Shapefile" and FALSE for all other drivers (this is the same as internal
> code has always been). The user may try to see whether this makes a
> difference, I didn't see any difference in the exported WKT written in the
> *.prj file.
>
> The main issue is that for any given specification, the towgs84 tag may not
> be unique (or other tags), so that the PROJ.4/GDAL policy is not to do
> anything that might not be accurate in conversion. There are no easy
> solutions here.
>
> In your case, for the copy og EPSG distributed with rgdal in the binary
> Windows and OSX packages, and for my PROJ.4/GDAL combination:
>
>> CRS("+init=epsg:23031")
>
> CRS arguments:
>  +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>
> but http://spatialreference.org/ref/epsg/23031/ does not include a +towgs84
> term. Which is credible? This is an ED50 projection/datum, so I'd actually
> trust dropping towgs84 more than keeping it. The web page suggests that the
> ED50 datum should be defined by country with respect to towgs84; I often
> look at Grids & Datums to cross-check:
>
> http://www.asprs.org/Grids-Datums.html
>
> Hope this helps,
>
> Roger
>
>> I do:
>>>
>>> wpBert700 at proj4string
>>
>> CRS arguments:
>> +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
>> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>>>
>>> writeOGR(wpBert700,dsn="wpBert700v2",layer="wpBert700v2",driver="ESRI
>>> Shapefile",overwrite=T)
>>
>>
>> But the created prj file:
>> PROJCS["UTM_Zone_31_Northern_Hemisphere",GEOGCS["GCS_International
>> 1909
>> (Hayford)",DATUM["D_unknown",SPHEROID["intl",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>
>> lacks the +towgs84=-87,-98,-121,0,0,0,0 information, which is a
>> problem if I do not remember I have to add it for a GIS display
>> with reprojection on the fly.
>> Is there any vector format that can  be written by rgdal in which the
>> CRS info would include the +towgs84=-87,-98,-121,0,0,0,0 ?
>>
>> Thanks!
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Tom_Roche at pobox.com  Wed Nov  7 14:48:28 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Wed, 07 Nov 2012 08:48:28 -0500
Subject: [R-sig-Geo] [gstat] simple reboxing test fails
In-Reply-To: <509A1160.4010101@uni-muenster.de>
References: <509A1160.4010101@uni-muenster.de>
Message-ID: <87k3tx4j83.fsf@pobox.com>


https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016634.html
>> data3D.out <- krige(formula=v ~ 1, data3D.in, grid3D.out)
>> summary(data3D.out)
>> # gets
>> #> Object of class SpatialGridDataFrame
>> #> Coordinates:
>> #>      min max
>> #> [1,]   0   8
>> #> [2,]   0   8
>> #> [3,]   0   8
>> #> Is projected: NA
>> #> proj4string : [NA]
>> #> Grid attributes:
>> #>   cellcentre.offset cellsize cells.dim
>> #> 1               0.5        1         8
>> #> 2               0.5        1         8
>> #> 3               4.0        8         1
>> #> Data attributes:
>> #>    var1.pred    var1.var
>> #>  Min.   :1   Min.   : NA
>> #>  1st Qu.:1   1st Qu.: NA
>> #>  Median :1   Median : NA
>> #>  Mean   :1   Mean   :NaN
>> #>  3rd Qu.:1   3rd Qu.: NA
>> #>  Max.   :1   Max.   : NA
>> #>              NA's   :64

>> What should I call to get the values for the output grid boxes?

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016638.html
> Did you notice the predictions in var1.pred values are all 1? 

Doh! no. I guess I've gotta convince myself that methods designed for
point prediction will work for grid interpolation. (I'd appreciate sound
arguments for an isomorphism--this may be obvious to geostatisticians
but I'm skeptical.) Or quit working while keeping one ear on the US
elections (at least that worked out better :-)

Onward to a more complex test ...

thanks, Tom Roche <Tom_Roche at pobox.com>


From Roger.Bivand at nhh.no  Wed Nov  7 16:38:26 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Nov 2012 16:38:26 +0100
Subject: [R-sig-Geo] towgs snd prj files
In-Reply-To: <CAG4NRe+ms=zH0+1b7oAmDjJLGAhBuH1qu+Uy=sOgL-uhjx+gpg@mail.gmail.com>
References: <CAG4NRe+u0VON_P4Z1GVtzbL2PTTEb3hw055FEMEAQD90fru63Q@mail.gmail.com>
	<alpine.LRH.2.02.1211071227520.13751@reclus.nhh.no>
	<CAG4NRe+ms=zH0+1b7oAmDjJLGAhBuH1qu+Uy=sOgL-uhjx+gpg@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211071607470.23547@reclus.nhh.no>

On Wed, 7 Nov 2012, Agustin Lobo wrote:

> ok, thanks, just got your message while I was typing my second one. It 
> seems we have to live with this issue. The best is probably make a 
> version of the object in both datums via spTransform() and then write 2 
> shapefiles as well.

The issue is that where the +towgs84 coefficients are not known with 
complete certainty (the case for ED50, where they differ a good deal 
depending on where you are), they are dropped when converting from PROJ.4 
to the internal representation used by OGR:

library(rgdal)
pt <- matrix(c(10000, 3000000), ncol=2)
spdf <- SpatialPointsDataFrame(SpatialPoints(pt), data=data.frame(ID=1))
proj4string(spdf) <- CRS("+init=epsg:23031")
proj4string(spdf)
td <- tempdir()
writeOGR(spdf, td, "tmp", driver="ESRI Shapefile") 
readLines(paste(td, "tmp.prj", sep="/"))
proj4string(readOGR(td, "tmp"))

If we use OSGB instead, with D_OSGB_1936 rather than D_unknown for its 
datum, the +towgs84 values are preserved:

spdf <- SpatialPointsDataFrame(SpatialPoints(pt), data=data.frame(ID=1))
proj4string(spdf) <- CRS("+init=epsg:27700")
proj4string(spdf)
writeOGR(spdf, td, "tmposgb", driver="ESRI Shapefile")
readLines(paste(td, "tmposgb.prj", sep="/"))
proj4string(readOGR(td, "tmposgb"))

So the logic in OGR is trying to ensure that only information that is 
authoritative is encoded in the output file. QGIS has a "custom" way of 
handling spatial reference, trying to make things "easy" for the user, 
whereas OGR prefers not to guess when it doesn't have authority. ED50 is 
not a standard at all, it is a collection of national (sometimes 
sub-national) standards that have also changed over time. It is only since 
GRS80/WGS84 that we have satellite-based measurements on which to base 
spheroid and datum definitions, hence the importance of having authority 
for transformations to and from WGS84. It doesn't make matters easier that 
the Earth also changes, but these changes are small in comparison with the 
differences induced by poor datum transformation. The datum values 
recognised by PROJ.4 are:

projInfo("datum")

which includes OSGB36, but not ED50. This:

http://www.ogp.org.uk/pubs/373-10.pdf

gives a flavour of the difficulties involved in oil exploration in the 
North Sea when also transforming between ED50 and WGS84 - note that these 
coefficients are very different from those shown in another source:

http://earth-info.nga.mil/GandG/coordsys/onlinedatum/CountryEuropeTable.html

referred to in this thread:

http://lists.osgeo.org/pipermail/gdal-dev/2009-May/020656.html

This is a never-ending story ...

Roger

>
> Or perhaps using spatialite objects instead of shapfiles would be a 
> solution? 
> http://www.gaia-gis.it/spatialite-2.0/SpatiaLite2-tutorial.html#t5

No, nothing to do with this.

>
> Agus
>
> On Wed, Nov 7, 2012 at 1:21 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Wed, 7 Nov 2012, Agustin Lobo wrote:
>>
>>> This might be a bit off-topic.
>>
>>
>> There is no guarantee of any kind that GDAL/OGR will reproduce the same
>> projection parameters on re-reading, and there is nothing in sp/rgdal that
>> can be done about this. The thread at:
>>
>> https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016581.html
>>
>> did permit an extra argument to be passed to readGDAL() to preserve datum in
>> addition to equivalent ellps and towgs84 tags.
>>
>> The underlying difficulties are that none of the various spatial reference
>> systems are unequivocal, and changing between PROJ.4, WKT, and others (EPSG
>> codes in different versions) may drop tags, especially where they are not
>> uniquely defined.
>>
>> On R-forge (revision 383) I have added a morphToESRI= logical argument to
>> writeOGR(), NULL default, set automatically TRUE if the driver is "ESRI
>> Shapefile" and FALSE for all other drivers (this is the same as internal
>> code has always been). The user may try to see whether this makes a
>> difference, I didn't see any difference in the exported WKT written in the
>> *.prj file.
>>
>> The main issue is that for any given specification, the towgs84 tag may not
>> be unique (or other tags), so that the PROJ.4/GDAL policy is not to do
>> anything that might not be accurate in conversion. There are no easy
>> solutions here.
>>
>> In your case, for the copy og EPSG distributed with rgdal in the binary
>> Windows and OSX packages, and for my PROJ.4/GDAL combination:
>>
>>> CRS("+init=epsg:23031")
>>
>> CRS arguments:
>>  +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
>> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>>
>> but http://spatialreference.org/ref/epsg/23031/ does not include a +towgs84
>> term. Which is credible? This is an ED50 projection/datum, so I'd actually
>> trust dropping towgs84 more than keeping it. The web page suggests that the
>> ED50 datum should be defined by country with respect to towgs84; I often
>> look at Grids & Datums to cross-check:
>>
>> http://www.asprs.org/Grids-Datums.html
>>
>> Hope this helps,
>>
>> Roger
>>
>>> I do:
>>>>
>>>> wpBert700 at proj4string
>>>
>>> CRS arguments:
>>> +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
>>> +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
>>>>
>>>> writeOGR(wpBert700,dsn="wpBert700v2",layer="wpBert700v2",driver="ESRI
>>>> Shapefile",overwrite=T)
>>>
>>>
>>> But the created prj file:
>>> PROJCS["UTM_Zone_31_Northern_Hemisphere",GEOGCS["GCS_International
>>> 1909
>>> (Hayford)",DATUM["D_unknown",SPHEROID["intl",6378388,297]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",3],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>>
>>> lacks the +towgs84=-87,-98,-121,0,0,0,0 information, which is a
>>> problem if I do not remember I have to add it for a GIS display
>>> with reprojection on the fly.
>>> Is there any vector format that can  be written by rgdal in which the
>>> CRS info would include the +towgs84=-87,-98,-121,0,0,0,0 ?
>>>
>>> Thanks!
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marion.jacquot at univ-fcomte.fr  Wed Nov  7 19:53:55 2012
From: marion.jacquot at univ-fcomte.fr (Marion Jacquot)
Date: Wed, 07 Nov 2012 19:53:55 +0100
Subject: [R-sig-Geo] pseudo R-squared with likfit (geoR)
Message-ID: <509AAE43.4020002@univ-fcomte.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121107/de67c9ac/attachment.pl>

From Tom_Roche at pobox.com  Wed Nov  7 20:08:32 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Wed, 07 Nov 2012 14:08:32 -0500
Subject: [R-sig-Geo] conservative continental "reprojection" for lon-lat
	input?
Message-ID: <87hap144en.fsf@pobox.com>


http://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf
> Package gstat assumes that data are projected, i.e.
> [data] should not be provided as [latitude]/longitude.

How should a continental-scale reboxing project best cope with this
restriction? Why I ask:

I'm a student attempting to create 3D N2O initial conditions (ICs) and
boundary conditions (BCs) for a run of an Eulerian atmospheric model
over North America, specifically

https://github.com/TomRoche/cornbeltN2O/wiki/AQMEII-North-American-domain#wiki-EPA
> projection: LCC (Lambert Conformal Conic)
> standard parallels: 33?, 45? (N)
> lon/lat projection center: -97? (W), 40? (N)
> domain origin (from projection center, in km): -2556 (W), -1728 (S)
> horizontal grid spacing: 12 km
> horizontal grid count (x,y): 459, 299
> vertical grid count: 34
> max height: 50 mb

I'm attempting to create IC/BCs for my model using, as input, the output
of a more coarse-scaled 3D global inventory: 2.5? lon x 1.875? lat, with
vertical layer heights more resembling those of the output domain
(though the layer positions differ). This "global input" provides an
approximate value for the mass concentration of N2O in the air in each
of its voxels, or boxes.

So I'll need to "rebox" the global input onto the local domain: i.e.,
for each box in the North American projected domain (i.e., for the
"local output"), estimate its mass concentration based on those provided
for the global input. I was hoping to do this directly, in the manner
that raster::projectRaster allows one to "regrid" from lon-lat to LCC.
But direct reboxing from lon-lat appear problematic with package=gstat,
however. Am I missing something?

If not, I'm wondering: what would be the most safe, conservative way to
impose a projection on the global data in order to input it to gstat?
E.g., could I

1. reduce the extent of the input from global to a "subglobal" area
   somewhat larger than my target domain (which is -130 - -59.5? lon,
   23.5 - 58.5? lat)

2. impose some CRS on the subglobal data such that the areas of the CRS
   gridcells equal or closely approximate those of the subglobal grid.

? If so, which CRS to use?

TIA, Tom Roche <Tom_Roche at pobox.com>


From r.hijmans at gmail.com  Wed Nov  7 20:09:02 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 7 Nov 2012 11:09:02 -0800
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
In-Reply-To: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
References: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
Message-ID: <CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121107/96302f9a/attachment.pl>

From vrukol at gmail.com  Wed Nov  7 20:17:27 2012
From: vrukol at gmail.com (marco milella)
Date: Wed, 7 Nov 2012 20:17:27 +0100
Subject: [R-sig-Geo] R and GIS
Message-ID: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121107/2805e08b/attachment.pl>

From jlong at uvic.ca  Wed Nov  7 20:34:21 2012
From: jlong at uvic.ca (JLong)
Date: Wed, 7 Nov 2012 11:34:21 -0800 (PST)
Subject: [R-sig-Geo] converting a single animal home range (estUD) to
	spixdf
In-Reply-To: <9BEE83C6BF59174DBD2CB4A06EB6CBEB329C287B@SINPRD0111MB368.apcprd01.prod.exchangelabs.com>
References: <9BEE83C6BF59174DBD2CB4A06EB6CBEB329C287B@SINPRD0111MB368.apcprd01.prod.exchangelabs.com>
Message-ID: <1352316861509-7581641.post@n2.nabble.com>

Leila Brook wrote
> Hello,
> I am wondering whether anyone knows a way to convert estUD home range
> objects to the spatialpixelsdataframe class in adehabitatHR.
> 
> I have tried using estUDm2spixdf() but this requires an estUDm class for
> multiple animal home ranges rather than a single animal home range of
> estUD class. I am using R 2.15.1 64-bit and the latest version of
> adehabitatHR.
> 
> If anyone has a tip on how to do this I would greatly appreciate it.
> Kind regards

I suspect Clement C. may have a better solution, but here is a cheap
workaround that should do the trick.

a <- simm.crw(1:100,id="a")
b <- simm.crw(200:300,id="b")
bb1 <- kernelbb(a,1,0.2)                        #sig1, sig2 value just
picked by me
bb2 <- kernelbb(c(a,b),1,0.2)
str(bb1)
str(bb2)                                                 #Notice the
difference in structure, estUDm is a list of estUD
bb1.estUDm <- list()
bb1.estUDm$a <- bb1                             #basically just build a list
here
class(bb1.estUDm) <- "estUDm"              #set the class attribute
str(bb1.estUDm)
spdf <- estUDm2spixdf(bb1.estUDm)
image(spdf)



Cheers
Jed




-----
Jed Long
SPAR Lab, Dept. of Geography
University of Victoria, Canada
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/converting-a-single-animal-home-range-estUD-to-spixdf-tp7581631p7581641.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sglish at hotmail.com  Wed Nov  7 20:34:58 2012
From: sglish at hotmail.com (Chris English)
Date: Wed, 7 Nov 2012 14:34:58 -0500
Subject: [R-sig-Geo] conservative continental "reprojection" for lon-lat
 input?
In-Reply-To: <87hap144en.fsf@pobox.com>
References: <87hap144en.fsf@pobox.com>
Message-ID: <BAY172-W731169C385A0CEB0A4431C56A0@phx.gbl>


Tom,

Link to advice from Tomislav Hengl
http://grokbase.com/p/r/r-sig-geo/1226xdq5sh/help-to-analisys-spatio-temporal 

expresses preference for gstat but suggests Stem
might do the trick by design

http://cran.r-project.org/web/packages/Stem/ 

Model accepts UTMx, UTMy or LAt/LON coords(Stem.pdf, Stem.Model(...))

Not sure that this will help, but as you can spell
Eulerian you've a better grasp of the problem contemplated.

Hope this is both relevant and helps,
Chris

> From: Tom_Roche at pobox.com
> To: r-sig-geo at r-project.org
> Date: Wed, 7 Nov 2012 14:08:32 -0500
> Subject: [R-sig-Geo] conservative continental "reprojection" for lon-lat	input?
> 
> 
> http://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf
> > Package gstat assumes that data are projected, i.e.
> > [data] should not be provided as [latitude]/longitude.
> 
> How should a continental-scale reboxing project best cope with this
> restriction? Why I ask:
> 
> I'm a student attempting to create 3D N2O initial conditions (ICs) and
> boundary conditions (BCs) for a run of an Eulerian atmospheric model
> over North America, specifically
> 
> https://github.com/TomRoche/cornbeltN2O/wiki/AQMEII-North-American-domain#wiki-EPA
> > projection: LCC (Lambert Conformal Conic)
> > standard parallels: 33?, 45? (N)
> > lon/lat projection center: -97? (W), 40? (N)
> > domain origin (from projection center, in km): -2556 (W), -1728 (S)
> > horizontal grid spacing: 12 km
> > horizontal grid count (x,y): 459, 299
> > vertical grid count: 34
> > max height: 50 mb
> 
> I'm attempting to create IC/BCs for my model using, as input, the output
> of a more coarse-scaled 3D global inventory: 2.5? lon x 1.875? lat, with
> vertical layer heights more resembling those of the output domain
> (though the layer positions differ). This "global input" provides an
> approximate value for the mass concentration of N2O in the air in each
> of its voxels, or boxes.
> 
> So I'll need to "rebox" the global input onto the local domain: i.e.,
> for each box in the North American projected domain (i.e., for the
> "local output"), estimate its mass concentration based on those provided
> for the global input. I was hoping to do this directly, in the manner
> that raster::projectRaster allows one to "regrid" from lon-lat to LCC.
> But direct reboxing from lon-lat appear problematic with package=gstat,
> however. Am I missing something?
> 
> If not, I'm wondering: what would be the most safe, conservative way to
> impose a projection on the global data in order to input it to gstat?
> E.g., could I
> 
> 1. reduce the extent of the input from global to a "subglobal" area
>    somewhat larger than my target domain (which is -130 - -59.5? lon,
>    23.5 - 58.5? lat)
> 
> 2. impose some CRS on the subglobal data such that the areas of the CRS
>    gridcells equal or closely approximate those of the subglobal grid.
> 
> ? If so, which CRS to use?
> 
> TIA, Tom Roche <Tom_Roche at pobox.com>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 		 	   		  

From osoong+r at gmail.com  Wed Nov  7 20:40:53 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Wed, 7 Nov 2012 11:40:53 -0800
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
In-Reply-To: <CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>
References: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
	<CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>
Message-ID: <CAPQ=hVJRfRLn_G1s3efGTCUktckr19viWdQAFCFbrdWWXQ6j2Q@mail.gmail.com>

I had tried that, but it unfortunately did not fix the problem with raster.

library(rgdal)
library(raster)
set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
ext <- extent(-2100050, -2099950, 1199950, 1200050)
p4s <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
+y_0=0 +datum=NAD83 +units=m +no_defs"
img1 <- raster(nrows = 1, ncols = 1, crs = p4s, ext = ext)
values(img1) <- 0
img1.file <- file.path(tempdir(), "img1.tif")
writeRaster(img1, img1.file, "GTiff", overwrite = TRUE)
img2 <- raster(img1.file)
img3 <- readGDAL(img1.file)
projection(img1)
projection(img2)
projection(img3)

I think it might have something to do with this line in
raster:::.readRasterFromGDAL:

projection(r) <- .Call("RGDAL_GetProjectionRef", x, PACKAGE = "rgdal")

By contrast, rgdal::getProjectionRef does:
Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")
res <- .Call("RGDAL_GetProjectionRef", dataset, PACKAGE = "rgdal")
Sys.unsetenv("OVERRIDE_PROJ_DATUM_WITH_TOWGS84")

Could you use rgdal::getProjectionRef, rather than directly calling
RGDAL_GetProjectionRef?

Oliver


On Wed, Nov 7, 2012 at 11:09 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Oliver,
>
> I think starting your script with this should do it:
>
> library(rgdal)
> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>
> Robert
>
>
>


From osoong+r at gmail.com  Wed Nov  7 20:44:41 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Wed, 7 Nov 2012 11:44:41 -0800
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
In-Reply-To: <CAPQ=hVJRfRLn_G1s3efGTCUktckr19viWdQAFCFbrdWWXQ6j2Q@mail.gmail.com>
References: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
	<CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>
	<CAPQ=hVJRfRLn_G1s3efGTCUktckr19viWdQAFCFbrdWWXQ6j2Q@mail.gmail.com>
Message-ID: <CAPQ=hV+bKoNwJKpfXO27esW1yB-xbXx8d55hBXf8WAxw3RQ7nA@mail.gmail.com>

Just to be clear, rgdal::getProjectionRef has a bunch of conditionals,
and the part I showed is the part that's relevant for this particular
case.

I guess I could just set the environment variable myself:
Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")

Oliver


On Wed, Nov 7, 2012 at 11:40 AM, Oliver Soong <osoong+r at gmail.com> wrote:
> I had tried that, but it unfortunately did not fix the problem with raster.
>
> library(rgdal)
> library(raster)
> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
> ext <- extent(-2100050, -2099950, 1199950, 1200050)
> p4s <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
> +y_0=0 +datum=NAD83 +units=m +no_defs"
> img1 <- raster(nrows = 1, ncols = 1, crs = p4s, ext = ext)
> values(img1) <- 0
> img1.file <- file.path(tempdir(), "img1.tif")
> writeRaster(img1, img1.file, "GTiff", overwrite = TRUE)
> img2 <- raster(img1.file)
> img3 <- readGDAL(img1.file)
> projection(img1)
> projection(img2)
> projection(img3)
>
> I think it might have something to do with this line in
> raster:::.readRasterFromGDAL:
>
> projection(r) <- .Call("RGDAL_GetProjectionRef", x, PACKAGE = "rgdal")
>
> By contrast, rgdal::getProjectionRef does:
> Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")
> res <- .Call("RGDAL_GetProjectionRef", dataset, PACKAGE = "rgdal")
> Sys.unsetenv("OVERRIDE_PROJ_DATUM_WITH_TOWGS84")
>
> Could you use rgdal::getProjectionRef, rather than directly calling
> RGDAL_GetProjectionRef?
>
> Oliver
>
>
> On Wed, Nov 7, 2012 at 11:09 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>> Oliver,
>>
>> I think starting your script with this should do it:
>>
>> library(rgdal)
>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>>
>> Robert
>>
>>
>>


From sglish at hotmail.com  Wed Nov  7 20:50:00 2012
From: sglish at hotmail.com (Chris English)
Date: Wed, 7 Nov 2012 14:50:00 -0500
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
References: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
Message-ID: <BAY172-W453550EA8274D87A6EB4F5C56A0@phx.gbl>


a google of 
cran r archeology

seems to bring up many useful links

(and cran r or cran [r] in any R related
searches helps focus on things R)

HTH Chris

----------------------------------------
> Date: Wed, 7 Nov 2012 20:17:27 +0100
> From: vrukol at gmail.com
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] R and GIS
>
> Dear all,
> I'm interested in the analysis of spatial data with R and I'm completely
> new to the world of GIS. However, I would like to try to use R and GIS data
> for analyzing archaeological data. On the web I found several links, and it
> seems that a good combination could be the use of R with GRASS. However,
> I'm a little bit confused due to the big amount of possible links, guides,
> manuals. Do you have any suggestion (online material or books) for a not
> experienced R user and completely ignorant in GIS?
> Thanks for any feedback
> marco
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 		 	   		  

From lockhart.katherine at gmail.com  Wed Nov  7 21:24:13 2012
From: lockhart.katherine at gmail.com (Katherine Lockhart)
Date: Wed, 7 Nov 2012 12:24:13 -0800
Subject: [R-sig-Geo] Indicator Simulation Help
Message-ID: <CAMEAd6yKa72o3GtDcy8JqfVEvtcV1x044nBcKB1wxC-u=seeBw@mail.gmail.com>

Hi There,
I am trying to do conditional indicator simulation on some TCE values
in groundwater.
I set my data up as a SpatialPointsDataFrame and expanded a grid to
predict to that is a SpatialPixelsDataFrame.

>From there, here is my code:
for(i in 1:length(data$TCE_.mg.L.)) (if(data$TCE_.mg.L.[i]<=0.005)
data$TCE_.mg.L.ind[i] = 1 else
data$TCE_.mg.L.ind[i] = 0)
#Compute and plot the sample variogram for the indicator transform
TCE.var<-variogram(TCE_.mg.L.ind~1, data)
plot(TCE.var)
#Set initial choice of variogram model
# calculate variance as estimate of the sill
var(data$TCE_.mg.L.ind)
# [1] 0.2491694
TCE.vgm<-vgm(.25, "Sph", 40)
TCE.model<-fit.variogram(TCE.var, TCE.vgm)
TCE.model
#  model     psill    range
#1   Sph 0.2770698 50.82271
# try gstat and predict.gstat for simulation
g <- gstat(id = "TCE_.mg.L.ind", formula = TCE_.mg.L.ind~1,data =
data,model=TCE.model)
class(g)
#[1] "gstat" "list"
TCE.sim<-predict.gstat(g, site1.grid,nsim=1,indicators=TRUE)
summary(TCE.sim)
#Object of class SpatialPixelsDataFrame
#Coordinates:
# min max
#x  90 110
#y  75  85
#Is projected: NA
#proj4string : [NA]
#Number of points: 231
#Grid attributes:
# cellcentre.offset cellsize cells.dim
#x                90        1        21
#y                75        1        11
#Data attributes:
#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#0.00000 0.00000 0.00000 0.09524 0.00000 1.00000

My issue is how to get the simulated values for each pixel. I tried
TCE.sim[1] and I just get a list of the coordinates in X and Y. I also
need to extract the value of the mean. Also, the output seems off to
me, does this look typical of indicator simulation? If I plot with
spplot(TCE.sim[1]) I get a plot with just zeros and 1s. From my
understanding, indicator simulation gives values between 0-1. Any
advice is appreciated!
Thank you!
Katie

--
Katherine Lockhart
Graduate Student Researcher
UC Davis
Department of Land, Air, and Water Resources


From macqueen1 at llnl.gov  Wed Nov  7 22:25:42 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 7 Nov 2012 21:25:42 +0000
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521910DE3D6@PRDEXMBX-08.the-lab.llnl.gov>

Here's a book:

The Geospatial Desktop
Open Source GIS & Mapping

by Gary Sherman

isbn 978-0-9868052-1-9

http://www.locatepress.com/

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 11/7/12 11:17 AM, "marco milella" <vrukol at gmail.com> wrote:

>Dear all,
>I'm interested in the analysis of spatial data with R and I'm completely
>new to the world of GIS. However, I would like to try to use R and GIS
>data
>for analyzing archaeological data. On the web I found several links, and
>it
>seems that a good combination could be  the use of R with GRASS. However,
>I'm a little bit confused due to the big amount of possible links, guides,
>manuals. Do you have any suggestion (online material or books) for a not
>experienced R user and completely ignorant in GIS?
>Thanks for any feedback
>marco
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Wed Nov  7 23:43:16 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 7 Nov 2012 22:43:16 +0000
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <8feeb270d5db477d907dd713d356e252@EX-1-HT0.lancs.local>
References: <8feeb270d5db477d907dd713d356e252@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNsPybr3VEaWtEo2M6Xbo-67JsGuEAugvMvST_46K1xaA@mail.gmail.com>

On Wed, Nov 7, 2012 at 7:17 PM, marco milella <vrukol at gmail.com> wrote:
> Dear all,
> I'm interested in the analysis of spatial data with R and I'm completely
> new to the world of GIS. However, I would like to try to use R and GIS data
> for analyzing archaeological data.

 What you are saying here is basically:

 "I want to use this hammer to bash this nail"

The problem is that we have no idea what you are building. It might be
better to use glue, or screws.

In statistics, always start with a question about your data, that
should lead you to methods, and only then go looking for the right
software.


From edzer.pebesma at uni-muenster.de  Thu Nov  8 00:07:52 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 08 Nov 2012 00:07:52 +0100
Subject: [R-sig-Geo] Indicator Simulation Help
In-Reply-To: <CAMEAd6yKa72o3GtDcy8JqfVEvtcV1x044nBcKB1wxC-u=seeBw@mail.gmail.com>
References: <CAMEAd6yKa72o3GtDcy8JqfVEvtcV1x044nBcKB1wxC-u=seeBw@mail.gmail.com>
Message-ID: <509AE9C8.6050805@uni-muenster.de>



On 11/07/2012 09:24 PM, Katherine Lockhart wrote:
> Hi There,
> I am trying to do conditional indicator simulation on some TCE values
> in groundwater.
> I set my data up as a SpatialPointsDataFrame and expanded a grid to
> predict to that is a SpatialPixelsDataFrame.
> 
>>From there, here is my code:
> for(i in 1:length(data$TCE_.mg.L.)) (if(data$TCE_.mg.L.[i]<=0.005)
> data$TCE_.mg.L.ind[i] = 1 else
> data$TCE_.mg.L.ind[i] = 0)
> #Compute and plot the sample variogram for the indicator transform
> TCE.var<-variogram(TCE_.mg.L.ind~1, data)
> plot(TCE.var)
> #Set initial choice of variogram model
> # calculate variance as estimate of the sill
> var(data$TCE_.mg.L.ind)
> # [1] 0.2491694
> TCE.vgm<-vgm(.25, "Sph", 40)
> TCE.model<-fit.variogram(TCE.var, TCE.vgm)
> TCE.model
> #  model     psill    range
> #1   Sph 0.2770698 50.82271
> # try gstat and predict.gstat for simulation
> g <- gstat(id = "TCE_.mg.L.ind", formula = TCE_.mg.L.ind~1,data =
> data,model=TCE.model)
> class(g)
> #[1] "gstat" "list"
> TCE.sim<-predict.gstat(g, site1.grid,nsim=1,indicators=TRUE)
> summary(TCE.sim)
> #Object of class SpatialPixelsDataFrame
> #Coordinates:
> # min max
> #x  90 110
> #y  75  85
> #Is projected: NA
> #proj4string : [NA]
> #Number of points: 231
> #Grid attributes:
> # cellcentre.offset cellsize cells.dim
> #x                90        1        21
> #y                75        1        11
> #Data attributes:
> #  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> #0.00000 0.00000 0.00000 0.09524 0.00000 1.00000
> 
> My issue is how to get the simulated values for each pixel. I tried
> TCE.sim[1] and I just get a list of the coordinates in X and Y. I also

TCE.sim[[1]]

> need to extract the value of the mean. Also, the output seems off to
> me, does this look typical of indicator simulation? If I plot with
> spplot(TCE.sim[1]) I get a plot with just zeros and 1s. From my
> understanding, indicator simulation gives values between 0-1.

No - indicator kriging does, simulation simulates data, data are
supposed to be 0 or 1.

 Any
> advice is appreciated!
> Thank you!
> Katie
> 
> --
> Katherine Lockhart
> Graduate Student Researcher
> UC Davis
> Department of Land, Air, and Water Resources
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From thomas.adams at noaa.gov  Thu Nov  8 01:34:41 2012
From: thomas.adams at noaa.gov (Thomas Adams)
Date: Wed, 7 Nov 2012 19:34:41 -0500
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
References: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
Message-ID: <CAEoga+SJsNqpaVrF4qxtqDnmkZH6w_WhP48oUSO5XTseryrfoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121107/4a69b7ce/attachment.pl>

From Tom_Roche at pobox.com  Thu Nov  8 04:38:05 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Wed, 07 Nov 2012 22:38:05 -0500
Subject: [R-sig-Geo] R and GIS
Message-ID: <87zk2s3gte.fsf@pobox.com>


marco milella Wed Nov 7 20:17:27 CET 2012
>> I would like to try to use R and [GRASS for] analyzing archaeological
>> data. On the web I found several links, and it seems that a good
>> combination could be the use of R with GRASS.

While I don't know about his R experience, Scott Madry @ UNC-CH is an
archaeologist who specializes in spatial analysis and is a major OSGeo
evangelist--you might contact him directly.

Thomas Adams Thu Nov 8 01:34:41 CET 2012
> get the "Open Source GIS: A GRASS GIS Approach" 3rd edition.

Madry recommended this (and passed copies around) at a training @ UNC
just last week.

FWIW, Tom Roche <Tom_Roche at pobox.com>


From Roger.Bivand at nhh.no  Thu Nov  8 10:46:46 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Nov 2012 10:46:46 +0100
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
In-Reply-To: <CAPQ=hV+bKoNwJKpfXO27esW1yB-xbXx8d55hBXf8WAxw3RQ7nA@mail.gmail.com>
References: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
	<CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>
	<CAPQ=hVJRfRLn_G1s3efGTCUktckr19viWdQAFCFbrdWWXQ6j2Q@mail.gmail.com>
	<CAPQ=hV+bKoNwJKpfXO27esW1yB-xbXx8d55hBXf8WAxw3RQ7nA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211081024260.26505@reclus.nhh.no>

On Wed, 7 Nov 2012, Oliver Soong wrote:

> Just to be clear, rgdal::getProjectionRef has a bunch of conditionals,
> and the part I showed is the part that's relevant for this particular
> case.
>
> I guess I could just set the environment variable myself:
> Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")

I assume that you are running released raster on CRAN - have you tried 
installing the development version from R-forge, in which many of these 
steps have been taken? Could you check that first? The conditionals are 
there to try to avoid trashing OVERRIDE_PROJ_DATUM_WITH_TOWGS84 possibly 
set by other software, among other things. The development raster code 
goes through rgdal::GDALinfo() which respects the rgdal option.

Roger

>
> Oliver
>
>
> On Wed, Nov 7, 2012 at 11:40 AM, Oliver Soong <osoong+r at gmail.com> wrote:
>> I had tried that, but it unfortunately did not fix the problem with raster.
>>
>> library(rgdal)
>> library(raster)
>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>> ext <- extent(-2100050, -2099950, 1199950, 1200050)
>> p4s <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
>> +y_0=0 +datum=NAD83 +units=m +no_defs"
>> img1 <- raster(nrows = 1, ncols = 1, crs = p4s, ext = ext)
>> values(img1) <- 0
>> img1.file <- file.path(tempdir(), "img1.tif")
>> writeRaster(img1, img1.file, "GTiff", overwrite = TRUE)
>> img2 <- raster(img1.file)
>> img3 <- readGDAL(img1.file)
>> projection(img1)
>> projection(img2)
>> projection(img3)
>>
>> I think it might have something to do with this line in
>> raster:::.readRasterFromGDAL:
>>
>> projection(r) <- .Call("RGDAL_GetProjectionRef", x, PACKAGE = "rgdal")
>>
>> By contrast, rgdal::getProjectionRef does:
>> Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")
>> res <- .Call("RGDAL_GetProjectionRef", dataset, PACKAGE = "rgdal")
>> Sys.unsetenv("OVERRIDE_PROJ_DATUM_WITH_TOWGS84")
>>
>> Could you use rgdal::getProjectionRef, rather than directly calling
>> RGDAL_GetProjectionRef?
>>
>> Oliver
>>
>>
>> On Wed, Nov 7, 2012 at 11:09 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>>> Oliver,
>>>
>>> I think starting your script with this should do it:
>>>
>>> library(rgdal)
>>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>>>
>>> Robert
>>>
>>>
>>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From julian at hafro.is  Thu Nov  8 15:58:40 2012
From: julian at hafro.is (Julian Burgos)
Date: Thu, 08 Nov 2012 14:58:40 +0000
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
References: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
Message-ID: <509BC8A0.8070608@hafro.is>

Hi Marco,
Depending on what you have to do, you may not need a GIS.  R has now 
many "GIS-like" features.  I now use R for 98% of my work, and use GRASS 
and QGIS mostly to process large datasets and as interactive 
visualization tools.  But all analyses and plotting (for publications or 
reports) is done in R.
This is a good start:
http://www.springerlink.com/content/978-0-387-78171-6?MUD=MP
Look the first section of the book, in particular.
Good luck!

Julian

-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is



On 11/07/2012 07:17 PM, marco milella wrote:
> Dear all,
> I'm interested in the analysis of spatial data with R and I'm completely
> new to the world of GIS. However, I would like to try to use R and GIS data
> for analyzing archaeological data. On the web I found several links, and it
> seems that a good combination could be  the use of R with GRASS. However,
> I'm a little bit confused due to the big amount of possible links, guides,
> manuals. Do you have any suggestion (online material or books) for a not
> experienced R user and completely ignorant in GIS?
> Thanks for any feedback
> marco
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From marco.milella at aim.uzh.ch  Thu Nov  8 20:06:58 2012
From: marco.milella at aim.uzh.ch (marco milella)
Date: Thu, 8 Nov 2012 20:06:58 +0100
Subject: [R-sig-Geo] R and GIS
In-Reply-To: <509BC8A0.8070608@hafro.is>
References: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
	<509BC8A0.8070608@hafro.is>
Message-ID: <CAGmuAUqm+FN3epV9NhQcVQ=83YJaw4hsN+f+B2UgLX1NDT_++w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121108/8a57b1b6/attachment.pl>

From osoong+r at gmail.com  Thu Nov  8 20:34:40 2012
From: osoong+r at gmail.com (Oliver Soong)
Date: Thu, 8 Nov 2012 11:34:40 -0800
Subject: [R-sig-Geo] raster (was readGDAL) loses datum
In-Reply-To: <alpine.LRH.2.02.1211081024260.26505@reclus.nhh.no>
References: <CAPQ=hVKyvo+p+uCiEhescVFKdmkLU0HgrNZtiy2OTqsPmAi6vQ@mail.gmail.com>
	<CANtt_hy5cqpjt7TwbYvyZNugZVF=s=dbrrDK6gVVcnA-T7mSjw@mail.gmail.com>
	<CAPQ=hVJRfRLn_G1s3efGTCUktckr19viWdQAFCFbrdWWXQ6j2Q@mail.gmail.com>
	<CAPQ=hV+bKoNwJKpfXO27esW1yB-xbXx8d55hBXf8WAxw3RQ7nA@mail.gmail.com>
	<alpine.LRH.2.02.1211081024260.26505@reclus.nhh.no>
Message-ID: <CAPQ=hVL8efjbKsbCzcMQ_JSqZsk3HsV9RJcJAAr92dr=ngJmjA@mail.gmail.com>

Not surprisingly, you guys are ahead of me.  The dev version does
indeed work as expected.  I do like how the necessary changes to
raster were submitted months before the changes to rgdal.  Thanks for
all your patience and effort.

Oliver


On Thu, Nov 8, 2012 at 1:46 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 7 Nov 2012, Oliver Soong wrote:
>
>> Just to be clear, rgdal::getProjectionRef has a bunch of conditionals,
>> and the part I showed is the part that's relevant for this particular
>> case.
>>
>> I guess I could just set the environment variable myself:
>> Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")
>
>
> I assume that you are running released raster on CRAN - have you tried
> installing the development version from R-forge, in which many of these
> steps have been taken? Could you check that first? The conditionals are
> there to try to avoid trashing OVERRIDE_PROJ_DATUM_WITH_TOWGS84 possibly set
> by other software, among other things. The development raster code goes
> through rgdal::GDALinfo() which respects the rgdal option.
>
> Roger
>
>>
>> Oliver
>>
>>
>> On Wed, Nov 7, 2012 at 11:40 AM, Oliver Soong <osoong+r at gmail.com> wrote:
>>>
>>> I had tried that, but it unfortunately did not fix the problem with
>>> raster.
>>>
>>> library(rgdal)
>>> library(raster)
>>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>>> ext <- extent(-2100050, -2099950, 1199950, 1200050)
>>> p4s <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
>>> +y_0=0 +datum=NAD83 +units=m +no_defs"
>>> img1 <- raster(nrows = 1, ncols = 1, crs = p4s, ext = ext)
>>> values(img1) <- 0
>>> img1.file <- file.path(tempdir(), "img1.tif")
>>> writeRaster(img1, img1.file, "GTiff", overwrite = TRUE)
>>> img2 <- raster(img1.file)
>>> img3 <- readGDAL(img1.file)
>>> projection(img1)
>>> projection(img2)
>>> projection(img3)
>>>
>>> I think it might have something to do with this line in
>>> raster:::.readRasterFromGDAL:
>>>
>>> projection(r) <- .Call("RGDAL_GetProjectionRef", x, PACKAGE = "rgdal")
>>>
>>> By contrast, rgdal::getProjectionRef does:
>>> Sys.setenv(OVERRIDE_PROJ_DATUM_WITH_TOWGS84 = "NO")
>>> res <- .Call("RGDAL_GetProjectionRef", dataset, PACKAGE = "rgdal")
>>> Sys.unsetenv("OVERRIDE_PROJ_DATUM_WITH_TOWGS84")
>>>
>>> Could you use rgdal::getProjectionRef, rather than directly calling
>>> RGDAL_GetProjectionRef?
>>>
>>> Oliver
>>>
>>>
>>> On Wed, Nov 7, 2012 at 11:09 AM, Robert J. Hijmans <r.hijmans at gmail.com>
>>> wrote:
>>>>
>>>> Oliver,
>>>>
>>>> I think starting your script with this should do it:
>>>>
>>>> library(rgdal)
>>>> set_OVERRIDE_PROJ_DATUM_WITH_TOWGS84(FALSE)
>>>>
>>>> Robert
>>>>
>>>>
>>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>


From changdong at ouc.edu.cn  Thu Nov  8 20:48:39 2012
From: changdong at ouc.edu.cn (=?gb2312?B?wfWzpLar?=)
Date: Fri, 09 Nov 2012 03:48:39 +0800
Subject: [R-sig-Geo] spatial-temporal correlation
Message-ID: <HIQSTSFYPIBISUUJSUZAAINLLTLD.changdong@ouc.edu.cn>




    I want to standardize catch rates of wall-eye fish using GLM models. I used likfit method in R package geoR to cope with residuals correlation,
    but I think there was also temporal correlation in residuals. geoR can not solve the problem.Who can tell me what should I do? Is there any package 
    in R that can solve my problem?


             thanks a lot !!!!!!!!!!!!!!!!!
   
    

From seth at swbigelow.net  Thu Nov  8 23:30:23 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Thu, 8 Nov 2012 17:30:23 -0500
Subject: [R-sig-Geo] superimpose spatiallines object for site map
Message-ID: <000001cdbe00$a55f0e00$f01d2a00$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121108/04390cd7/attachment.pl>

From lockhart.katherine at gmail.com  Sat Nov 10 08:14:42 2012
From: lockhart.katherine at gmail.com (Katherine Lockhart)
Date: Fri, 9 Nov 2012 23:14:42 -0800
Subject: [R-sig-Geo] Indicator Simulation, Simulated Values Help
Message-ID: <CAMEAd6ypNeC4DLOtEMoV3YHd-1+FOhioQBzMwuK-dbuwoRaUoA@mail.gmail.com>

Hi Everyone,
I am using Indicator Simulation to interpolate indicator transformed
TCE sample values from 40 monitoring wells to a
SpatialPixelsDataFrame. The grid that covers all of my sample points
in approximately 55,000 pixels (1m resolution) and I was not able to
get a single simulation to finish running. However, I am only
concerned with a 10X20m section within my larger grid. If I
interpolate only to this smaller grid (231 pixels), it runs instantly
and I can compute 1000 simulations in about 2 hours. The trouble I am
having is that each simulation gives highly variable results, either
all 0s or all 1s for example. The histogram of average field values
for each simulation is flat to bimodal. Also, if I simulate to another
smaller grid of interest, I get almost the same distribution of
average field values, though I have reason to believe that they should
not be the same. When I average the averages, I get nearly the name
number, 0.29.
Could this be cause by simulating only to a smaller grid? Or perhaps
my variogram model is incorrect?

TCE.vgm<-vgm(.25, "Sph", 40)
TCE.model<-fit.variogram(TCE.var, TCE.vgm)

g <- gstat(id = "TCE_.mg.L.ind", formula = TCE_.mg.L.ind~1,data =
data,model=TCE.model)

#Now perform the simulations for Site2
# set a new projection grid for the site squares to speed up predictions
#  set up a regular grid data.frame for my predictions to site 2
xs2<-seq(from=190,to=210,by=1)
ys2<-seq(from=55,to=55,by=1)
xysite2<-expand.grid(x=xs1,y=ys1)

# change the data frame class to a SpatialPixelsDataFrame
site2.grid<-SpatialPixelsDataFrame(points=xysite2[c('x','y')],
data=xysite2,proj4string=CRS(as.character(NA)))

# write the loop for site 2
vec2<-numeric(1000)
for (i in 1:1000) {
TCE.sim.i<-predict.gstat(g, site2.grid,nsim=i,indicators=TRUE)
average.i<-mean(TCE.sim.i[[i]])
vec2[i]<-average.i
}


Thank you,
--
Katherine Lockhart
Graduate Student Researcher
UC Davis
Department of Land, Air, and Water Resources


From jianfeng.mao at gmail.com  Sat Nov 10 22:24:11 2012
From: jianfeng.mao at gmail.com (Jian-Feng Mao)
Date: Sat, 10 Nov 2012 13:24:11 -0800
Subject: [R-sig-Geo] Jian-Feng Mao wants to share new pictures with you
Message-ID: <0.0.43.659.1CDBF89B9B39EB8.0@invite2.zoosk.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121110/4407ebd4/attachment.html>

From jianfeng.mao at gmail.com  Sat Nov 10 22:24:23 2012
From: jianfeng.mao at gmail.com (Jian-Feng Mao)
Date: Sat, 10 Nov 2012 13:24:23 -0800
Subject: [R-sig-Geo] Jian-Feng Mao wants to share new pictures with you
Message-ID: <0.0.23.A35.1CDBF89C130362E.0@invite2.zoosk.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121110/b1a9f9f6/attachment.html>

From jianfeng.mao at gmail.com  Sat Nov 10 22:24:10 2012
From: jianfeng.mao at gmail.com (Jian-Feng Mao)
Date: Sat, 10 Nov 2012 13:24:10 -0800
Subject: [R-sig-Geo] Jian-Feng Mao wants to share new pictures with you
Message-ID: <0.0.43.715.1CDBF89B9239034.0@invite4.zoosk.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121110/683b136d/attachment.html>

From jianfeng.mao at gmail.com  Sat Nov 10 22:24:23 2012
From: jianfeng.mao at gmail.com (Jian-Feng Mao)
Date: Sat, 10 Nov 2012 13:24:23 -0800
Subject: [R-sig-Geo] Jian-Feng Mao wants to share new pictures with you
Message-ID: <0.0.102.FE8.1CDBF89C1001C0A.0@invite5.zoosk.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121110/580ab895/attachment.html>

From christoph.hofer at env.ethz.ch  Sun Nov 11 11:13:23 2012
From: christoph.hofer at env.ethz.ch (Hofer  Christoph Jean-Charles)
Date: Sun, 11 Nov 2012 10:13:23 +0000
Subject: [R-sig-Geo] method intersect for non-overlapping polygons
Message-ID: <AA4890F1E87BE6489BFAEA0FA5792913094180F2@MBX11.d.ethz.ch>

Dear List

The following simple example works fine

require( sp )
require( gpclib )

t.c1 <- matrix( c(1,5,5,1,1,1,1,5,5,1), ncol = 2)
t.c2 <- t.c1
t.c2[,1] <- t.c1[,1] + 10
t.c2[,2] <- t.c1[,2] +  10
t.p1 <- Polygon( t.c1 )
t.p2 <- Polygon( t.c2 )
t.p1 <- Polygons( srl = list( t.p1 ) , ID = "A")
t.p2 <- Polygons( srl = list( t.p2 ) , ID = "B")

t.sp1 <- SpatialPolygons( list( t.p1 ) )
t.sp2 <- SpatialPolygons( list( t.p2 ) )

plot( SpatialPolygons(list(t.p1,t.p2)) )


g1 <- as( t.sp1 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")
g2 <- as(  t.sp2 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")

intersect( g1, g2 )

The result is 0.

However, if I use "rgeos" instead of "gpclib" I get the following error message:

Error in as(spres, "gpc.poly") :
 no method or default for coercing "NULL" to "gpc.poly"

If the polygons t.p1 and t.p2  overlap both packages provide the same and right result.


Is this behavior of the intersect method in rgeos a bug or a desired property?


regeos version 0.2-6
gpclib versoin 1.5-1

sessionInfo()

R version 2.15.2 (2012-10-26)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] gpclib_1.5-1 rgeos_0.2-6  plyr_1.7.1   stringr_0.6  sp_0.9-99

loaded via a namespace (and not attached):
[1] compiler_2.15.2 grid_2.15.2     lattice_0.20-6  tools_2.15.2



Best regards


Christoph


..............................................................................................................
Dr. Christoph Hofer
Projektleiter F&E
Institut f?r Datenanalyse und Prozessdesign (IDP)
ZHAW Z?rcher Hochschule f?r Angewandte Wissenschaften
Rosenstrasse 3, Postfach
CH-8401 Winterthur
T: +41 (0)58 934 69 40
F: +41 (0)58 935 69 40
E: christoph.hofer at zhaw.ch
W: http://www.idp.zhaw.ch
..............................................................................................................


From roland.pape at uni-oldenburg.de  Sun Nov 11 17:55:09 2012
From: roland.pape at uni-oldenburg.de (Roland Pape)
Date: Sun, 11 Nov 2012 16:55:09 +0000
Subject: [R-sig-Geo] adehabitatHS - kselect analysis
Message-ID: <4780FC16AA89574CA36BB63C15DF63A1014B0417@mbx02.w2kroot.uni-oldenburg.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121111/b64aad5a/attachment.pl>

From Roger.Bivand at nhh.no  Sun Nov 11 20:07:19 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 11 Nov 2012 20:07:19 +0100
Subject: [R-sig-Geo] method intersect for non-overlapping polygons
In-Reply-To: <AA4890F1E87BE6489BFAEA0FA5792913094180F2@MBX11.d.ethz.ch>
References: <AA4890F1E87BE6489BFAEA0FA5792913094180F2@MBX11.d.ethz.ch>
Message-ID: <alpine.LRH.2.02.1211112002090.9370@reclus.nhh.no>

On Sun, 11 Nov 2012, Hofer  Christoph Jean-Charles wrote:

> Dear List
>
> The following simple example works fine
>
> require( sp )
> require( gpclib )
>
> t.c1 <- matrix( c(1,5,5,1,1,1,1,5,5,1), ncol = 2)
> t.c2 <- t.c1
> t.c2[,1] <- t.c1[,1] + 10
> t.c2[,2] <- t.c1[,2] +  10
> t.p1 <- Polygon( t.c1 )
> t.p2 <- Polygon( t.c2 )
> t.p1 <- Polygons( srl = list( t.p1 ) , ID = "A")
> t.p2 <- Polygons( srl = list( t.p2 ) , ID = "B")
>
> t.sp1 <- SpatialPolygons( list( t.p1 ) )
> t.sp2 <- SpatialPolygons( list( t.p2 ) )
>
> plot( SpatialPolygons(list(t.p1,t.p2)) )
>
>
> g1 <- as( t.sp1 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")
> g2 <- as(  t.sp2 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")
>
> intersect( g1, g2 )
>
> The result is 0.
>
> However, if I use "rgeos" instead of "gpclib" I get the following error 
> message:
>
> Error in as(spres, "gpc.poly") :
> no method or default for coercing "NULL" to "gpc.poly"
>
> If the polygons t.p1 and t.p2 overlap both packages provide the same and 
> right result.
>
>
> Is this behavior of the intersect method in rgeos a bug or a desired 
> property?

It is an unforeseen consequence of method despatch when the class of the 
returned object is NULL. If you can install rgeos from source, including 
the external dependencies, try revision 358 from the R-forge rgeos 
project, which traps the NULL and returns an empty gpc.poly object. If 
not, wait for a CRAN submission or if urgent enclose the intersect (or 
other) in try() or similar, a "try-error" return means no intersection. If 
you could check the rgeos commit from R-forge, that would be helpful - 
thanks for a good reproducible error case.

Roger

>
>
> regeos version 0.2-6
> gpclib versoin 1.5-1
>
> sessionInfo()
>
> R version 2.15.2 (2012-10-26)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] gpclib_1.5-1 rgeos_0.2-6  plyr_1.7.1   stringr_0.6  sp_0.9-99
>
> loaded via a namespace (and not attached):
> [1] compiler_2.15.2 grid_2.15.2     lattice_0.20-6  tools_2.15.2
>
>
>
> Best regards
>
>
> Christoph
>
>
> ..............................................................................................................
> Dr. Christoph Hofer
> Projektleiter F&E
> Institut f?r Datenanalyse und Prozessdesign (IDP)
> ZHAW Z?rcher Hochschule f?r Angewandte Wissenschaften
> Rosenstrasse 3, Postfach
> CH-8401 Winterthur
> T: +41 (0)58 934 69 40
> F: +41 (0)58 935 69 40
> E: christoph.hofer at zhaw.ch
> W: http://www.idp.zhaw.ch
> ..............................................................................................................
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From christoph.hofer at env.ethz.ch  Sun Nov 11 22:10:21 2012
From: christoph.hofer at env.ethz.ch (Hofer  Christoph Jean-Charles)
Date: Sun, 11 Nov 2012 21:10:21 +0000
Subject: [R-sig-Geo] method intersect for non-overlapping polygons
In-Reply-To: <14b08dced6c346b48c8cdd28c8105107@CAS12.d.ethz.ch>
References: <AA4890F1E87BE6489BFAEA0FA5792913094180F2@MBX11.d.ethz.ch>
	<24fedbf5635844b2bb476bd7530395cd@EX-0-HT0.lancs.local>
	<14b08dced6c346b48c8cdd28c8105107@CAS12.d.ethz.ch>
Message-ID: <9A83B6C9-B148-4919-86BF-4CA53EE8B013@env.ethz.ch>

I agree with you, gInterse? is a simple and working solution for my example. However, rgeos provides the class "gpc.poly" and the method "intersect".
So, my question was only whether the behavior of intersect for non-overlapping polygons is an unknown error or intended.
After the reply from Roger the answer is clear.
Am 11.11.2012 um 21:25 schrieb Barry Rowlingson <b.rowlingson at gmail.com>:

> Isn't another solution to simply use rgeos:gIntersection when intersecting sp polygon objects and not using gpclib?
> 
> On Nov 11, 2012 7:08 PM, "Roger Bivand" <Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>> wrote:
> On Sun, 11 Nov 2012, Hofer  Christoph Jean-Charles wrote:
> 
>> Dear List
>> 
>> The following simple example works fine
>> 
>> require( sp )
>> require( gpclib )
>> 
>> t.c1 <- matrix( c(1,5,5,1,1,1,1,5,5,1), ncol = 2)
>> t.c2 <- t.c1
>> t.c2[,1] <- t.c1[,1] + 10
>> t.c2[,2] <- t.c1[,2] +  10
>> t.p1 <- Polygon( t.c1 )
>> t.p2 <- Polygon( t.c2 )
>> t.p1 <- Polygons( srl = list( t.p1 ) , ID = "A")
>> t.p2 <- Polygons( srl = list( t.p2 ) , ID = "B")
>> 
>> t.sp1 <- SpatialPolygons( list( t.p1 ) )
>> t.sp2 <- SpatialPolygons( list( t.p2 ) )
>> 
>> plot( SpatialPolygons(list(t.p1,t.p2)) )
>> 
>> 
>> g1 <- as( t.sp1 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")
>> g2 <- as(  t.sp2 at polygons[[1]]@Polygons[[1]]@coords, "gpc.poly")
>> 
>> intersect( g1, g2 )
>> 
>> The result is 0.
>> 
>> However, if I use "rgeos" instead of "gpclib" I get the following error
>> message:
>> 
>> Error in as(spres, "gpc.poly") :
>> no method or default for coercing "NULL" to "gpc.poly"
>> 
>> If the polygons t.p1 and t.p2 overlap both packages provide the same and
>> right result.
>> 
>> 
>> Is this behavior of the intersect method in rgeos a bug or a desired
>> property?
> 
> It is an unforeseen consequence of method despatch when the class of the
> returned object is NULL. If you can install rgeos from source, including
> the external dependencies, try revision 358 from the R-forge rgeos
> project, which traps the NULL and returns an empty gpc.poly object. If
> not, wait for a CRAN submission or if urgent enclose the intersect (or
> other) in try() or similar, a "try-error" return means no intersection. If
> you could check the rgeos commit from R-forge, that would be helpful -
> thanks for a good reproducible error case.
> 
> Roger
> 
>> 
>> 
>> regeos version 0.2-6
>> gpclib versoin 1.5-1
>> 
>> sessionInfo()
>> 
>> R version 2.15.2 (2012-10-26)
>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>> 
>> locale:
>> [1] C
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> other attached packages:
>> [1] gpclib_1.5-1 rgeos_0.2-6  plyr_1.7.1   stringr_0.6  sp_0.9-99
>> 
>> loaded via a namespace (and not attached):
>> [1] compiler_2.15.2 grid_2.15.2     lattice_0.20-6  tools_2.15.2
>> 
>> 
>> 
>> Best regards
>> 
>> 
>> Christoph
>> 
>> 
>> ..............................................................................................................
>> Dr. Christoph Hofer
>> Projektleiter F&E
>> Institut f?r Datenanalyse und Prozessdesign (IDP)
>> ZHAW Z?rcher Hochschule f?r Angewandte Wissenschaften
>> Rosenstrasse 3, Postfach
>> CH-8401 Winterthur
>> T: +41 (0)58 934 69 40
>> F: +41 (0)58 935 69 40
>> E: christoph.hofer at zhaw.ch<mailto:christoph.hofer at zhaw.ch>
>> W: http://www.idp.zhaw.ch
>> ..............................................................................................................
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55<tel:%2B47%2055%2095%2093%2055>; fax +47 55 95 95 43<tel:%2B47%2055%2095%2095%2043>
> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>


From giubi78 at gmail.com  Mon Nov 12 01:06:44 2012
From: giubi78 at gmail.com (Giuseppe Bianco)
Date: Mon, 12 Nov 2012 01:06:44 +0100
Subject: [R-sig-Geo] Lines crossing Mercator projection map
Message-ID: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/c6b36d4a/attachment.pl>

From potts.a at gmail.com  Mon Nov 12 07:37:45 2012
From: potts.a at gmail.com (Alastair Potts)
Date: Mon, 12 Nov 2012 08:37:45 +0200
Subject: [R-sig-Geo] Optimising raster/matrix algrebra
Message-ID: <CAG_8N1af203od-1eJWjfoYcFot7q95g2+gcjepMF=vkoWwLrSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/38c3212c/attachment.pl>

From johan.mazel at gmail.com  Mon Nov 12 09:00:40 2012
From: johan.mazel at gmail.com (Johan Mazel)
Date: Mon, 12 Nov 2012 17:00:40 +0900
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
Message-ID: <CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>

Here is the code that I am using and the result.
The problem on the result is that, on the fourth and last page, it
looks like some parts of the map are not located where they are
supposed to be (Australia is thus right next to Canada).

My only modification is that I removed the xlim and ylim parameters in
the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
plot=FALSE)" in the original script. It obviously has a impact on the
final output but I can`t figure out what is happening.

Thanks for your time.
Regards.
Johan

2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
> Hi
> I am trying to use the solution rpesented here:
> https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
>
> However it looks like the shifted (from the north pole) map is
> displayed on top on the original azimuthal equidistant projection
> centered on the north pole.
> Is there any way to correct this ?
>
> Thanks for your time.
> Regards.
> Johan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: projection_azeq.r
Type: application/octet-stream
Size: 389 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/88a1cf4d/attachment.obj>

From mdsumner at gmail.com  Mon Nov 12 12:08:26 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 12 Nov 2012 22:08:26 +1100
Subject: [R-sig-Geo] Lines crossing Mercator projection map
In-Reply-To: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>
References: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>
Message-ID: <CAAcGz98RLFyVV2GNdtx=2LDchnxgz=yGCwbyPXuSYgDcYpsjjA@mail.gmail.com>

This is happening because the maps data has data that is out of the
range of [-180, 180], either from the source data itself or from the
clipping somehow:

 range(world.map$x, na.rm = TRUE)
[1] -179.9572  190.2908


You would have to carefully clean this up to make it useable, but I
would just avoid it and use the clean data set in maptools (or import
your own from some other source.

Here you can intersect a polygon with wrld_simpl to clip it from the
infinities at the poles before reprojecting:

library(maptools)
library(rgdal)
library(rgeos)

data(wrld_simpl)

poly <- Polygon(cbind(c(-180, 180, 180, -180, -180), c(-80, -80, 80, 80, -80)))
clipPoly <- SpatialPolygons(list(Polygons(list(poly), ID = "1")),
proj4string = CRS(proj4string(wrld_simpl)))

wrld.clip <- gIntersection(clipPoly, wrld_simpl)

wrld.merc <- spTransform(wrld.clip, CRS("+proj=merc"))

plot(wrld.merc)



Also, please declare the packages you have in use with library() or
require() so that code is reproducible.

Cheers, Mike.

On Mon, Nov 12, 2012 at 11:06 AM, Giuseppe Bianco <giubi78 at gmail.com> wrote:
> Dear List,
>
> I have been struggling all the day long with this issue but I didn't find
> any workaround.
>
> I would like to have exactly the map that come out from the code below but
> without the ugly line crossing one side to the other.
>
> world.map <- map(fill=T, plot=F)
> IDs <- sapply(strsplit(world.map$names, ":"), function(x) x[1])
> poly.map <- map2SpatialPolygons(world.map, IDs=IDs,
> proj4string=CRS("+proj=longlat"))
> merc.map <- spTransform(poly.map, CRS("+proj=merc"))
>
> # Set the map to -80 to 80
> bb <- cbind(c(-180, 180), c(-80, 80))
> bb.poly <- SpatialPoints(bb, proj4string = CRS("+proj=longlat"))
> bb.merc <- spTransform(bb.poly, CRS("+proj=merc"))
> bb.merc <- as.data.frame(bb.merc)
>
> # Here the ugly plot
> plot(merc.map, col="gray", border="gray", xlim=bb.merc[,1],
> ylim=bb.merc[,2])
>
> Any help is very appreciated,
> /Gis
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From ashton at msu.edu  Mon Nov 12 15:23:14 2012
From: ashton at msu.edu (Ashton Shortridge)
Date: Mon, 12 Nov 2012 09:23:14 -0500
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
Message-ID: <201211120923.14851.ashton@msu.edu>

Dear Johan (and list),

I'm not a professional cartographer, but I do find myself flipping through 
Snyder's book of map projections every once in a while.

Looking at your results, I don't see anything 'wrong' with the code or the 
results. Yes, the map looks awful, but that is what it should look like. 
Imagine a glass globe of the Earth with outlines of the land masses etched on 
it. Now imagine you have oriented that globe so that you are looking down at 
45N, 90W (somewhere not far from my neck of the woods). What you see as 
"Australia right next to Canada" is from looking 'through the globe', which is 
why Australia appears to be inverted, and why South America seems to fold 
under itself (also Africa).

Now this projection is not really a glass globe, but I hope the metaphor makes 
it a bit clearer. It should also make clearer why people don't normally use 
azimuthal projections for global mapping. Coincidentally it works sorta kinda 
ok from the north pole, but don't plan on it working well from other places.

Hope this is helpful.

Ashton


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671

On 11/12/12, Johan Mazel, wrote:
> Here is the code that I am using and the result.
> The problem on the result is that, on the fourth and last page, it
> looks like some parts of the map are not located where they are
> supposed to be (Australia is thus right next to Canada).
> 
> My only modification is that I removed the xlim and ylim parameters in
> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
> plot=FALSE)" in the original script. It obviously has a impact on the
> final output but I can`t figure out what is happening.
> 
> Thanks for your time.
> Regards.
> Johan
> 
> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
> > Hi
> > I am trying to use the solution rpesented here:
> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
> > 
> > However it looks like the shifted (from the north pole) map is
> > displayed on top on the original azimuthal equidistant projection
> > centered on the north pole.
> > Is there any way to correct this ?
> > 
> > Thanks for your time.
> > Regards.
> > Johan


From ashton at msu.edu  Mon Nov 12 15:23:14 2012
From: ashton at msu.edu (Ashton Shortridge)
Date: Mon, 12 Nov 2012 09:23:14 -0500
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
Message-ID: <201211120923.14851.ashton@msu.edu>

Dear Johan (and list),

I'm not a professional cartographer, but I do find myself flipping through 
Snyder's book of map projections every once in a while.

Looking at your results, I don't see anything 'wrong' with the code or the 
results. Yes, the map looks awful, but that is what it should look like. 
Imagine a glass globe of the Earth with outlines of the land masses etched on 
it. Now imagine you have oriented that globe so that you are looking down at 
45N, 90W (somewhere not far from my neck of the woods). What you see as 
"Australia right next to Canada" is from looking 'through the globe', which is 
why Australia appears to be inverted, and why South America seems to fold 
under itself (also Africa).

Now this projection is not really a glass globe, but I hope the metaphor makes 
it a bit clearer. It should also make clearer why people don't normally use 
azimuthal projections for global mapping. Coincidentally it works sorta kinda 
ok from the north pole, but don't plan on it working well from other places.

Hope this is helpful.

Ashton


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671

On 11/12/12, Johan Mazel, wrote:
> Here is the code that I am using and the result.
> The problem on the result is that, on the fourth and last page, it
> looks like some parts of the map are not located where they are
> supposed to be (Australia is thus right next to Canada).
> 
> My only modification is that I removed the xlim and ylim parameters in
> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
> plot=FALSE)" in the original script. It obviously has a impact on the
> final output but I can`t figure out what is happening.
> 
> Thanks for your time.
> Regards.
> Johan
> 
> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
> > Hi
> > I am trying to use the solution rpesented here:
> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
> > 
> > However it looks like the shifted (from the north pole) map is
> > displayed on top on the original azimuthal equidistant projection
> > centered on the north pole.
> > Is there any way to correct this ?
> > 
> > Thanks for your time.
> > Regards.
> > Johan


From j2kennel at gmail.com  Mon Nov 12 16:05:40 2012
From: j2kennel at gmail.com (Jonathan)
Date: Mon, 12 Nov 2012 07:05:40 -0800 (PST)
Subject: [R-sig-Geo] Optimising raster/matrix algrebra
In-Reply-To: <CAG_8N1af203od-1eJWjfoYcFot7q95g2+gcjepMF=vkoWwLrSA@mail.gmail.com>
References: <CAG_8N1af203od-1eJWjfoYcFot7q95g2+gcjepMF=vkoWwLrSA@mail.gmail.com>
Message-ID: <1352732740779-7581672.post@n2.nabble.com>

Hello Alastair,

In my experience when I've been up against speed issues I switch to do most
of my computation in arrays or matrices and then convert back to a raster at
the end.  The code isn't as elegant as using the raster functions but you
can pick up some speed.  If you need the xy stack for other uses you will
need to adjust the solution.

# YOUR SOLUTION
x <- fun(100,100,1000)
y <- fun(100,100,1000)
system.time(xy <- x==1&y==1)
system.time(xy.tot <- sum(xy))

# A POSSIBLE SOLUTION WHICH SHOULD BE FASTER
x1 <- values(x)
y1 <- values(y)
system.time({xy1 <- x1==1 & y1==1})
xy.tot1 <- raster(ncol=100,nrow=100)
system.time(xy.tot1[] <- rowSums(xy1))

all.equal(xy.tot1,xy.tot)

-Jonathan




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Optimising-raster-matrix-algrebra-tp7581668p7581672.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ptitle at umich.edu  Mon Nov 12 16:24:41 2012
From: ptitle at umich.edu (Pascal Title)
Date: Mon, 12 Nov 2012 10:24:41 -0500
Subject: [R-sig-Geo] stand-alone maxent vs Dismo
Message-ID: <CAPSA=ydY_jAqcsdBtSh7nG_cE6h4qRz=SO1orwFKxeEAwkbMJg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/fed74993/attachment.pl>

From danijon70 at gmail.com  Mon Nov 12 17:43:51 2012
From: danijon70 at gmail.com (dani jon)
Date: Mon, 12 Nov 2012 11:43:51 -0500
Subject: [R-sig-Geo] Overlay, Sample, and Extract
Message-ID: <CAFqirvZ+TEWzUK+_NduhgCExg-QeA=K1_XjqgAspqZP2_V9Vqg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/87bee73b/attachment.pl>

From giubi78 at gmail.com  Mon Nov 12 19:00:27 2012
From: giubi78 at gmail.com (Giuseppe Bianco)
Date: Mon, 12 Nov 2012 19:00:27 +0100
Subject: [R-sig-Geo] Lines crossing Mercator projection map
In-Reply-To: <CAAcGz98RLFyVV2GNdtx=2LDchnxgz=yGCwbyPXuSYgDcYpsjjA@mail.gmail.com>
References: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>
	<CAAcGz98RLFyVV2GNdtx=2LDchnxgz=yGCwbyPXuSYgDcYpsjjA@mail.gmail.com>
Message-ID: <CAF+H1PVEpx4kuBxANCvQA0QsXSrn5SshpT86yQJDkv9v0PWHZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/6e71f124/attachment.pl>

From liov2067 at gmail.com  Mon Nov 12 19:16:53 2012
From: liov2067 at gmail.com (=?ISO-8859-1?Q?Luis_Iv=E1n_Ortiz_Valencia?=)
Date: Mon, 12 Nov 2012 16:16:53 -0200
Subject: [R-sig-Geo]  crop raster with data value condition
Message-ID: <CAJ+S-MGwhXT+WjFo4KEy1ND6pxesHw78j7Vvup7rU+2Jvgi0=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/9726caee/attachment.pl>

From Roger.Bivand at nhh.no  Mon Nov 12 19:19:02 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Nov 2012 19:19:02 +0100
Subject: [R-sig-Geo] Lines crossing Mercator projection map
In-Reply-To: <CAF+H1PVEpx4kuBxANCvQA0QsXSrn5SshpT86yQJDkv9v0PWHZQ@mail.gmail.com>
References: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>
	<CAAcGz98RLFyVV2GNdtx=2LDchnxgz=yGCwbyPXuSYgDcYpsjjA@mail.gmail.com>
	<CAF+H1PVEpx4kuBxANCvQA0QsXSrn5SshpT86yQJDkv9v0PWHZQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211121910280.15795@reclus.nhh.no>

On Mon, 12 Nov 2012, Giuseppe Bianco wrote:

> Dear Mike,
>
> Thank you for your answer.
>
> I get an error with the polygons intersection:
>
>> wrld.clip <- gIntersection(clipPoly, wrld_simpl)
>
> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, "rgeos_intersection")
> :
>
>  TopologyException: side location conflict at -91.437497778887078
> 17.241108073444931

You need to provide the version of rgeos you are using - from 
sessionInfo(), and the messages printed when rgeos is loaded. For me with

> library(rgeos)
rgeos: (SVN revision 360)
  GEOS runtime version: 3.3.5-CAPI-1.7.5
  Polygon checking: TRUE

and:

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-unknown-linux-gnu (64-bit)
...
other attached packages:
[1] rgeos_0.2-9     rgdal_0.7-22    maptools_0.8-20 lattice_0.20-10
[5] sp_1.0-2        foreign_0.8-51

there is no problem.

>
> The problem seems to be a bad polygon in the wrld_simpl database
>
>> gIsValid(wrld_simpl)
>
> [1] FALSE

On the same system, I also see this, but it isn't the cause of your 
problem. Please also stop posting HTML, it is being stripped anyway, so 
post plain text only, as the list instructions require.

Roger

PS: If you need the countries, use:

wrld.clip <- gIntersection(clipPoly, wrld_simpl, byid=TRUE)
row.names(wrld.clip)

shows the IDs.

>
> Warning message:
>
> In RGEOSUnaryPredFunc(spgeom, byid, "rgeos_isvalid") :
>
>  Ring Self-intersection at or near point -95.902496339999999
> 66.946641920000005
>
>
> Any way to fix it?
>
> BTW, I am sorry for the packages call. Here it comes:
> library(maps)
> library(maptools)
> library(rgdal)
>
> /Gis
>
>
>
> On 12 November 2012 12:08, Michael Sumner <mdsumner at gmail.com> wrote:
>
>> This is happening because the maps data has data that is out of the
>> range of [-180, 180], either from the source data itself or from the
>> clipping somehow:
>>
>>  range(world.map$x, na.rm = TRUE)
>> [1] -179.9572  190.2908
>>
>>
>> You would have to carefully clean this up to make it useable, but I
>> would just avoid it and use the clean data set in maptools (or import
>> your own from some other source.
>>
>> Here you can intersect a polygon with wrld_simpl to clip it from the
>> infinities at the poles before reprojecting:
>>
>> library(maptools)
>> library(rgdal)
>> library(rgeos)
>>
>> data(wrld_simpl)
>>
>> poly <- Polygon(cbind(c(-180, 180, 180, -180, -180), c(-80, -80, 80, 80,
>> -80)))
>> clipPoly <- SpatialPolygons(list(Polygons(list(poly), ID = "1")),
>> proj4string = CRS(proj4string(wrld_simpl)))
>>
>> wrld.clip <- gIntersection(clipPoly, wrld_simpl)
>>
>> wrld.merc <- spTransform(wrld.clip, CRS("+proj=merc"))
>>
>> plot(wrld.merc)
>>
>>
>>
>> Also, please declare the packages you have in use with library() or
>> require() so that code is reproducible.
>>
>> Cheers, Mike.
>>
>> On Mon, Nov 12, 2012 at 11:06 AM, Giuseppe Bianco <giubi78 at gmail.com>
>> wrote:
>>> Dear List,
>>>
>>> I have been struggling all the day long with this issue but I didn't find
>>> any workaround.
>>>
>>> I would like to have exactly the map that come out from the code below
>> but
>>> without the ugly line crossing one side to the other.
>>>
>>> world.map <- map(fill=T, plot=F)
>>> IDs <- sapply(strsplit(world.map$names, ":"), function(x) x[1])
>>> poly.map <- map2SpatialPolygons(world.map, IDs=IDs,
>>> proj4string=CRS("+proj=longlat"))
>>> merc.map <- spTransform(poly.map, CRS("+proj=merc"))
>>>
>>> # Set the map to -80 to 80
>>> bb <- cbind(c(-180, 180), c(-80, 80))
>>> bb.poly <- SpatialPoints(bb, proj4string = CRS("+proj=longlat"))
>>> bb.merc <- spTransform(bb.poly, CRS("+proj=merc"))
>>> bb.merc <- as.data.frame(bb.merc)
>>>
>>> # Here the ugly plot
>>> plot(merc.map, col="gray", border="gray", xlim=bb.merc[,1],
>>> ylim=bb.merc[,2])
>>>
>>> Any help is very appreciated,
>>> /Gis
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Michael Sumner
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mintibezabih at gmail.com  Mon Nov 12 19:35:14 2012
From: mintibezabih at gmail.com (alemante zd)
Date: Mon, 12 Nov 2012 18:35:14 +0000
Subject: [R-sig-Geo] combining asc with csv file
Message-ID: <CAJfxP+p2YH9OobOWpfqTyt4XqQ22xe98PnKX+kPDYgXbwsO0FQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/ecf59c53/attachment.pl>

From danijon70 at gmail.com  Mon Nov 12 20:13:23 2012
From: danijon70 at gmail.com (dani jon)
Date: Mon, 12 Nov 2012 14:13:23 -0500
Subject: [R-sig-Geo] Overlay, sample, and extract
Message-ID: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/4656a156/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Nov 12 20:26:11 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 12 Nov 2012 20:26:11 +0100
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
Message-ID: <50A14D53.1080804@uni-muenster.de>

try:

x = do.call(rbind, lapply(1:length(SpPDF), function(x)
spsample(SpPDF[x,], 10, "random")))
points(x)

On 11/12/2012 08:13 PM, dani jon wrote:
> Dear List,
> 
> I am interested in overlaying a regular polygon grid of 8 by 8 into a
> spatial surface. Essentially, dividing the spatial surface into 64 polygon
> grids and would like to take a sample of 10 points (pixels) with
> corresponding xy coordinate and values for each of the 64 grids.  Here is
> my attempt.
> 
> library(maptools)
> library(raster)
> library(sp)
> library(gstat)
> library(maps)
> 
> ## Creating spatial surface
> 
> xg = seq(1, 100,, 100)
> yg = seq(1, 100,, 100)
> xy = expand.grid(xg, yg)
> names(xy) <- c("x","y")
> g.dummy <- gstat(formula=z~1, locations=~x+y, dummy=T, beta=1,
> model=vgm(psill=0.025,model="
> Exp",range=15), nmax=20)
> yy <- predict(g.dummy, newdata=xy, nsim=1)
> gridded(yy) = ~x+y
> coor.yy <- coordinates(yy[1])
> ytrue <-yy[1]@data
> yyspdf<- SpatialPointsDataFrame(coords=coor.yy, data=ytrue)
> yyspdf[1:10,]
>  coordinates     sim1
> 1       (1, 1) 1.305260
> 2       (2, 1) 1.287697
> 3       (3, 1) 1.219094
> 4       (4, 1) 1.333913
> 5       (5, 1) 1.268508
> 6       (6, 1) 1.263417
> 7       (7, 1) 1.243237
> 8       (8, 1) 1.276870
> 9       (9, 1) 1.231528
> 10     (10, 1) 1.162322
> 
> ## creating regular polygon grid (8x8)
> 
> grd <- GridTopology(c(6.3,6.3), c(12.5,12.5), c(8,8))
> SpP_grd <-as.SpatialPolygons.GridTopology(grd)
> plot(SpP_grd)
> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
> slot(i, "ID")), cex=0.5)
> ids <- sapply(slot(SpP_grd, 'polygons'), function(i) slot(i, 'ID'))
> trdata <- data.frame(A=rep(c(1,2,3,4,5,6,7,8), 8),
> B=rep(c(1,2,3,4,5,6,7,8), each=8),
> row.names=sapply(slot(SpP_grd, "polygons"), function(i) slot(i, "ID")))
> SpPDF <- SpatialPolygonsDataFrame(SpP_grd, trdata)
> SpPDF at data = cbind(SpPDF at data,ids)
> 
>> SpPDF at data[1:10,]
>     A B ids
> g1  1 1  g1
> g2  2 1  g2
> g3  3 1  g3
> g4  4 1  g4
> g5  5 1  g5
> g6  6 1  g6
> g7  7 1  g7
> g8  8 1  g8
> g9  1 2  g9
> g10 2 2 g10
> 
> ## Overlay
> image(yy[1])
> plot(SpPDF, border="magenta", add=TRUE)
> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
> slot(i, "ID")), cex=0.5)
> 
> My question is how to overlay yy[1] and SpPDF and take 10 samples within
> each polygon grid (g1-g64) and extract the values and coordinates of
> yy[1]?  So I will have an output with a sample of 640
> 
>  x  y   sim1        ids
> 1  2   1.305260   g1
> 1  3   1.02567     g1
> .
> .
> 95 95 1.3487    g64
> 
> Edzer  suggested something likes this, but it does not exactly  640 samples
> (10*64) as I wanted.
> 
>  x = do.call(rbind, lapply(1:10, function(x) spsample(yy, cellsize = 12.5,
> type = "stratified")))
> 
> Thanks in advance
> Best regards
> Sam
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From danijon70 at gmail.com  Mon Nov 12 20:26:44 2012
From: danijon70 at gmail.com (dani jon)
Date: Mon, 12 Nov 2012 14:26:44 -0500
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
Message-ID: <CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/d0eeb2ee/attachment.pl>

From Roger.Bivand at nhh.no  Mon Nov 12 20:40:46 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Nov 2012 20:40:46 +0100
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
	<CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211122032390.15795@reclus.nhh.no>

Patience is a virtue - this is your third identical posting on this topic. 
Please do respect the time list members give. Please also read the list 
instructions:

http://www.r-project.org/mail.html#instructions

and posting guide:

http://www.r-project.org/posting-guide.html

and note that you should only post plain text, not HTML, content. If you 
look at the archived version of your posting, you see:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016684.html

which treats your posting as an attachment. We strip HTML to reduce carbon 
footprint of the list (fewer bytes to store and transmit), and to reduce 
danger from included content. Please play by the rules ...

A slightly tired list admin.

On Mon, 12 Nov 2012, dani jon wrote:

> Dear List,
> I am interested in overlaying a regular polygon grid of 8 by 8 into a
> spatial surface. Essentially, dividing the spatial surface into 64 polygon
> grids and would like to take a sample of 10 points (pixels) with
> corresponding xy coordinate and values for each of the 64 grids.  Here is
> my attempt.
>
> library(maptools)
> library(raster)
> library(sp)
> library(gstat)
> library(maps)
>
> ## Creating spatial surface
>
> xg = seq(1, 100,, 100)
> yg = seq(1, 100,, 100)
> xy = expand.grid(xg, yg)
> names(xy) <- c("x","y")
> g.dummy <- gstat(formula=z~1, locations=~x+y, dummy=T, beta=1,
> model=vgm(psill=0.025,model="
> Exp",range=15), nmax=20)
> yy <- predict(g.dummy, newdata=xy, nsim=1)
> gridded(yy) = ~x+y
> coor.yy <- coordinates(yy[1])
> ytrue <-yy[1]@data
> yyspdf<- SpatialPointsDataFrame(coords=coor.yy, data=ytrue)
> yyspdf[1:10,]
> coordinates     sim1
> 1       (1, 1) 1.305260
> 2       (2, 1) 1.287697
> 3       (3, 1) 1.219094
> 4       (4, 1) 1.333913
> 5       (5, 1) 1.268508
> 6       (6, 1) 1.263417
> 7       (7, 1) 1.243237
> 8       (8, 1) 1.276870
> 9       (9, 1) 1.231528
> 10     (10, 1) 1.162322
>
> ## creating regular polygon grid (8x8)
>
> grd <- GridTopology(c(6.3,6.3), c(12.5,12.5), c(8,8))
> SpP_grd <-as.SpatialPolygons.GridTopology(grd)
> plot(SpP_grd)
> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
> slot(i, "ID")), cex=0.5)
> ids <- sapply(slot(SpP_grd, 'polygons'), function(i) slot(i, 'ID'))
> trdata <- data.frame(A=rep(c(1,2,3,4,5,6,7,8), 8),
> B=rep(c(1,2,3,4,5,6,7,8), each=8),
> row.names=sapply(slot(SpP_grd, "polygons"), function(i) slot(i, "ID")))
> SpPDF <- SpatialPolygonsDataFrame(SpP_grd, trdata)
> SpPDF at data = cbind(SpPDF at data,ids)
>
>> SpPDF at data[1:10,]
>    A B ids
> g1  1 1  g1
> g2  2 1  g2
> g3  3 1  g3
> g4  4 1  g4
> g5  5 1  g5
> g6  6 1  g6
> g7  7 1  g7
> g8  8 1  g8
> g9  1 2  g9
> g10 2 2 g10
>
> ## Overlay
> image(yy[1])
> plot(SpPDF, border="magenta", add=TRUE)
> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
> slot(i, "ID")), cex=0.5)
>
> My question is how to overlay yy[1] and SpPDF and take 10 samples within
> each polygon grid (g1-g64) and extract the values and coordinates of
> yy[1]?  So I will have an output with a sample of 640
>
> x  y   sim1        ids
> 1  2   1.305260   g1
> 1  3   1.02567     g1
> .
> .
> 95 95 1.3487    g64
>
> Edzer  suggested something likes this, but it does not exactly  640 samples
> (10*64) as I wanted.
>
> x = do.call(rbind, lapply(1:10, function(x) spsample(yy, cellsize = 12.5,
> type = "stratified")))
>
> Thanks in advance
> Best regards
> Sam
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From etiennebr at gmail.com  Mon Nov 12 20:52:44 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 12 Nov 2012 14:52:44 -0500
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
	<CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
Message-ID: <CALjAYt7zrpiLcAO+y8VOZVk14R4uxupfmm1YY=9LowxneXpGKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/69c3ae07/attachment.pl>

From etiennebr at gmail.com  Mon Nov 12 21:00:48 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 12 Nov 2012 15:00:48 -0500
Subject: [R-sig-Geo] crop raster with data value condition
In-Reply-To: <CAJ+S-MGwhXT+WjFo4KEy1ND6pxesHw78j7Vvup7rU+2Jvgi0=Q@mail.gmail.com>
References: <CAJ+S-MGwhXT+WjFo4KEy1ND6pxesHw78j7Vvup7rU+2Jvgi0=Q@mail.gmail.com>
Message-ID: <CALjAYt5AG31UgSH1_W-wHhXWSkMeh9coqXkeGcsnrBnt5=8cYg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/5ac180c8/attachment.pl>

From liov2067 at gmail.com  Mon Nov 12 22:10:27 2012
From: liov2067 at gmail.com (=?ISO-8859-1?Q?Luis_Iv=E1n_Ortiz_Valencia?=)
Date: Mon, 12 Nov 2012 19:10:27 -0200
Subject: [R-sig-Geo] crop raster with data value condition
In-Reply-To: <CALjAYt5AG31UgSH1_W-wHhXWSkMeh9coqXkeGcsnrBnt5=8cYg@mail.gmail.com>
References: <CAJ+S-MGwhXT+WjFo4KEy1ND6pxesHw78j7Vvup7rU+2Jvgi0=Q@mail.gmail.com>
	<CALjAYt5AG31UgSH1_W-wHhXWSkMeh9coqXkeGcsnrBnt5=8cYg@mail.gmail.com>
Message-ID: <CAJ+S-MHDCoBQF05DvjSdStAi1+Bosug2YWvOjX-5hA0F3HHbKA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/472b3da9/attachment.pl>

From danijon70 at gmail.com  Mon Nov 12 22:15:02 2012
From: danijon70 at gmail.com (dani jon)
Date: Mon, 12 Nov 2012 16:15:02 -0500
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <alpine.LRH.2.02.1211122032390.15795@reclus.nhh.no>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
	<CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
	<alpine.LRH.2.02.1211122032390.15795@reclus.nhh.no>
Message-ID: <CAFqirvYgRZv7MWsmbaJHE42iQZWqv92GK5+mZWCf39qgV6HoHQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/d2e6a57c/attachment.pl>

From milansharma2012 at yahoo.com  Tue Nov 13 02:29:21 2012
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Mon, 12 Nov 2012 17:29:21 -0800 (PST)
Subject: [R-sig-Geo] Fitting exponential variogram to lattice data
In-Reply-To: <CAGmuAUqm+FN3epV9NhQcVQ=83YJaw4hsN+f+B2UgLX1NDT_++w@mail.gmail.com>
References: <CAGmuAUpvCfcYnz6GYn+My-9_bo+pw-43YrbeOEVas=VoowRHBQ@mail.gmail.com>
	<509BC8A0.8070608@hafro.is>
	<CAGmuAUqm+FN3epV9NhQcVQ=83YJaw4hsN+f+B2UgLX1NDT_++w@mail.gmail.com>
Message-ID: <1352770161.98731.YahooMailNeo@web161203.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121112/06d994b1/attachment.pl>

From johan.mazel at gmail.com  Tue Nov 13 07:56:56 2012
From: johan.mazel at gmail.com (Johan Mazel)
Date: Tue, 13 Nov 2012 15:56:56 +0900
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <201211120923.14851.ashton@msu.edu>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
Message-ID: <CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>

Thanks for your answer.

Regarding your last paragraph, I am not really sure to understand.
Do you mean that the result is expected in regards to the script (and
rgdal use) ?
Or do you mean that azimuthal equidistant projection is not
possible/valid on any other points than the two poles ? Because, if it
is the latter, Synder's book seems to disagree. If you look at figure
41.C, it looks like azimuthal equidistant projection centered on a
different point than on of the two pole is possible.

Thanks a lot for your time.
Johan

2012/11/12 Ashton Shortridge <ashton at msu.edu>:
> Dear Johan (and list),
>
> I'm not a professional cartographer, but I do find myself flipping through
> Snyder's book of map projections every once in a while.
>
> Looking at your results, I don't see anything 'wrong' with the code or the
> results. Yes, the map looks awful, but that is what it should look like.
> Imagine a glass globe of the Earth with outlines of the land masses etched on
> it. Now imagine you have oriented that globe so that you are looking down at
> 45N, 90W (somewhere not far from my neck of the woods). What you see as
> "Australia right next to Canada" is from looking 'through the globe', which is
> why Australia appears to be inverted, and why South America seems to fold
> under itself (also Africa).
>
> Now this projection is not really a glass globe, but I hope the metaphor makes
> it a bit clearer. It should also make clearer why people don't normally use
> azimuthal projections for global mapping. Coincidentally it works sorta kinda
> ok from the north pole, but don't plan on it working well from other places.
>
> Hope this is helpful.
>
> Ashton
>
>
> -----
> Ashton Shortridge
> Associate Professor                     ashton at msu.edu
> Dept of Geography                       http://www.msu.edu/~ashton
> 235 Geography Building          ph (517) 432-3561
> Michigan State University               fx (517) 432-1671
>
> On 11/12/12, Johan Mazel, wrote:
>> Here is the code that I am using and the result.
>> The problem on the result is that, on the fourth and last page, it
>> looks like some parts of the map are not located where they are
>> supposed to be (Australia is thus right next to Canada).
>>
>> My only modification is that I removed the xlim and ylim parameters in
>> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
>> plot=FALSE)" in the original script. It obviously has a impact on the
>> final output but I can`t figure out what is happening.
>>
>> Thanks for your time.
>> Regards.
>> Johan
>>
>> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
>> > Hi
>> > I am trying to use the solution rpesented here:
>> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
>> >
>> > However it looks like the shifted (from the north pole) map is
>> > displayed on top on the original azimuthal equidistant projection
>> > centered on the north pole.
>> > Is there any way to correct this ?
>> >
>> > Thanks for your time.
>> > Regards.
>> > Johan
>


From johan.mazel at gmail.com  Tue Nov 13 07:56:56 2012
From: johan.mazel at gmail.com (Johan Mazel)
Date: Tue, 13 Nov 2012 15:56:56 +0900
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <201211120923.14851.ashton@msu.edu>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<CAKS5mhResS_N2u+a_pN4KP-Et0A5s=3_Mknq8D6yh6QVvVEs6w@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
Message-ID: <CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>

Thanks for your answer.

Regarding your last paragraph, I am not really sure to understand.
Do you mean that the result is expected in regards to the script (and
rgdal use) ?
Or do you mean that azimuthal equidistant projection is not
possible/valid on any other points than the two poles ? Because, if it
is the latter, Synder's book seems to disagree. If you look at figure
41.C, it looks like azimuthal equidistant projection centered on a
different point than on of the two pole is possible.

Thanks a lot for your time.
Johan

2012/11/12 Ashton Shortridge <ashton at msu.edu>:
> Dear Johan (and list),
>
> I'm not a professional cartographer, but I do find myself flipping through
> Snyder's book of map projections every once in a while.
>
> Looking at your results, I don't see anything 'wrong' with the code or the
> results. Yes, the map looks awful, but that is what it should look like.
> Imagine a glass globe of the Earth with outlines of the land masses etched on
> it. Now imagine you have oriented that globe so that you are looking down at
> 45N, 90W (somewhere not far from my neck of the woods). What you see as
> "Australia right next to Canada" is from looking 'through the globe', which is
> why Australia appears to be inverted, and why South America seems to fold
> under itself (also Africa).
>
> Now this projection is not really a glass globe, but I hope the metaphor makes
> it a bit clearer. It should also make clearer why people don't normally use
> azimuthal projections for global mapping. Coincidentally it works sorta kinda
> ok from the north pole, but don't plan on it working well from other places.
>
> Hope this is helpful.
>
> Ashton
>
>
> -----
> Ashton Shortridge
> Associate Professor                     ashton at msu.edu
> Dept of Geography                       http://www.msu.edu/~ashton
> 235 Geography Building          ph (517) 432-3561
> Michigan State University               fx (517) 432-1671
>
> On 11/12/12, Johan Mazel, wrote:
>> Here is the code that I am using and the result.
>> The problem on the result is that, on the fourth and last page, it
>> looks like some parts of the map are not located where they are
>> supposed to be (Australia is thus right next to Canada).
>>
>> My only modification is that I removed the xlim and ylim parameters in
>> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
>> plot=FALSE)" in the original script. It obviously has a impact on the
>> final output but I can`t figure out what is happening.
>>
>> Thanks for your time.
>> Regards.
>> Johan
>>
>> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
>> > Hi
>> > I am trying to use the solution rpesented here:
>> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
>> >
>> > However it looks like the shifted (from the north pole) map is
>> > displayed on top on the original azimuthal equidistant projection
>> > centered on the north pole.
>> > Is there any way to correct this ?
>> >
>> > Thanks for your time.
>> > Regards.
>> > Johan
>


From giubi78 at gmail.com  Tue Nov 13 08:01:35 2012
From: giubi78 at gmail.com (Giuseppe Bianco)
Date: Tue, 13 Nov 2012 08:01:35 +0100
Subject: [R-sig-Geo] Lines crossing Mercator projection map
In-Reply-To: <alpine.LRH.2.02.1211121910280.15795@reclus.nhh.no>
References: <CAF+H1PV8MhCvsNMCojYgiWX1mrA6ebcBPLnRcL7rXWkRXg0JPw@mail.gmail.com>
	<CAAcGz98RLFyVV2GNdtx=2LDchnxgz=yGCwbyPXuSYgDcYpsjjA@mail.gmail.com>
	<CAF+H1PVEpx4kuBxANCvQA0QsXSrn5SshpT86yQJDkv9v0PWHZQ@mail.gmail.com>
	<alpine.LRH.2.02.1211121910280.15795@reclus.nhh.no>
Message-ID: <CAF+H1PWfDCqyaYRnMXO23SH2v1kgaiC0s_-VydEKyjnj4+ow8A@mail.gmail.com>

Thank you Roger.

Below what I get (didn't change after update.packages("rgeos"))

> library(rgeos)
rgeos: (SVN revision 357)
 GEOS runtime version: 3.3.3-CAPI-1.7.4
 Polygon checking: TRUE

>  sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
[1] rgeos_0.2-8     rgdal_0.7-22    maptools_0.8-18 lattice_0.20-10
sp_1.0-2
[6] foreign_0.8-51

Hope this helps.

/Gis


On 12 November 2012 19:19, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 12 Nov 2012, Giuseppe Bianco wrote:
>
>> Dear Mike,
>>
>> Thank you for your answer.
>>
>> I get an error with the polygons intersection:
>>
>>> wrld.clip <- gIntersection(clipPoly, wrld_simpl)
>>
>>
>> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id,
>> "rgeos_intersection")
>> :
>>
>>  TopologyException: side location conflict at -91.437497778887078
>> 17.241108073444931
>
>
> You need to provide the version of rgeos you are using - from sessionInfo(),
> and the messages printed when rgeos is loaded. For me with
>
>> library(rgeos)
>
> rgeos: (SVN revision 360)
>  GEOS runtime version: 3.3.5-CAPI-1.7.5
>  Polygon checking: TRUE
>
> and:
>
>> sessionInfo()
>
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> ...
> other attached packages:
> [1] rgeos_0.2-9     rgdal_0.7-22    maptools_0.8-20 lattice_0.20-10
> [5] sp_1.0-2        foreign_0.8-51
>
> there is no problem.
>
>
>>
>> The problem seems to be a bad polygon in the wrld_simpl database
>>
>>> gIsValid(wrld_simpl)
>>
>>
>> [1] FALSE
>
>
> On the same system, I also see this, but it isn't the cause of your problem.
> Please also stop posting HTML, it is being stripped anyway, so post plain
> text only, as the list instructions require.
>
> Roger
>
> PS: If you need the countries, use:
>
> wrld.clip <- gIntersection(clipPoly, wrld_simpl, byid=TRUE)
> row.names(wrld.clip)
>
> shows the IDs.
>
>
>>
>> Warning message:
>>
>> In RGEOSUnaryPredFunc(spgeom, byid, "rgeos_isvalid") :
>>
>>  Ring Self-intersection at or near point -95.902496339999999
>> 66.946641920000005
>>
>>
>> Any way to fix it?
>>
>> BTW, I am sorry for the packages call. Here it comes:
>> library(maps)
>> library(maptools)
>> library(rgdal)
>>
>> /Gis
>>
>>
>>
>> On 12 November 2012 12:08, Michael Sumner <mdsumner at gmail.com> wrote:
>>
>>> This is happening because the maps data has data that is out of the
>>> range of [-180, 180], either from the source data itself or from the
>>> clipping somehow:
>>>
>>>  range(world.map$x, na.rm = TRUE)
>>> [1] -179.9572  190.2908
>>>
>>>
>>> You would have to carefully clean this up to make it useable, but I
>>> would just avoid it and use the clean data set in maptools (or import
>>> your own from some other source.
>>>
>>> Here you can intersect a polygon with wrld_simpl to clip it from the
>>> infinities at the poles before reprojecting:
>>>
>>> library(maptools)
>>> library(rgdal)
>>> library(rgeos)
>>>
>>> data(wrld_simpl)
>>>
>>> poly <- Polygon(cbind(c(-180, 180, 180, -180, -180), c(-80, -80, 80, 80,
>>> -80)))
>>> clipPoly <- SpatialPolygons(list(Polygons(list(poly), ID = "1")),
>>> proj4string = CRS(proj4string(wrld_simpl)))
>>>
>>> wrld.clip <- gIntersection(clipPoly, wrld_simpl)
>>>
>>> wrld.merc <- spTransform(wrld.clip, CRS("+proj=merc"))
>>>
>>> plot(wrld.merc)
>>>
>>>
>>>
>>> Also, please declare the packages you have in use with library() or
>>> require() so that code is reproducible.
>>>
>>> Cheers, Mike.
>>>
>>> On Mon, Nov 12, 2012 at 11:06 AM, Giuseppe Bianco <giubi78 at gmail.com>
>>> wrote:
>>>>
>>>> Dear List,
>>>>
>>>> I have been struggling all the day long with this issue but I didn't
>>>> find
>>>> any workaround.
>>>>
>>>> I would like to have exactly the map that come out from the code below
>>>
>>> but
>>>>
>>>> without the ugly line crossing one side to the other.
>>>>
>>>> world.map <- map(fill=T, plot=F)
>>>> IDs <- sapply(strsplit(world.map$names, ":"), function(x) x[1])
>>>> poly.map <- map2SpatialPolygons(world.map, IDs=IDs,
>>>> proj4string=CRS("+proj=longlat"))
>>>> merc.map <- spTransform(poly.map, CRS("+proj=merc"))
>>>>
>>>> # Set the map to -80 to 80
>>>> bb <- cbind(c(-180, 180), c(-80, 80))
>>>> bb.poly <- SpatialPoints(bb, proj4string = CRS("+proj=longlat"))
>>>> bb.merc <- spTransform(bb.poly, CRS("+proj=merc"))
>>>> bb.merc <- as.data.frame(bb.merc)
>>>>
>>>> # Here the ugly plot
>>>> plot(merc.map, col="gray", border="gray", xlim=bb.merc[,1],
>>>> ylim=bb.merc[,2])
>>>>
>>>> Any help is very appreciated,
>>>> /Gis
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>>
>>> --
>>> Michael Sumner
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>


From Roger.Bivand at nhh.no  Tue Nov 13 08:36:36 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Nov 2012 08:36:36 +0100
Subject: [R-sig-Geo] Overlay, sample, and extract
In-Reply-To: <CAFqirvYgRZv7MWsmbaJHE42iQZWqv92GK5+mZWCf39qgV6HoHQ@mail.gmail.com>
References: <CAFqirvZjgvRKq-TqTsaWRKRBbVuG0ZV=mYc9tCax6307DU_G7g@mail.gmail.com>
	<CAFqirvZhmf3YoVENeDC3EY0S7xebyn1vd47kNa_z_zc3yv=1pA@mail.gmail.com>
	<alpine.LRH.2.02.1211122032390.15795@reclus.nhh.no>
	<CAFqirvYgRZv7MWsmbaJHE42iQZWqv92GK5+mZWCf39qgV6HoHQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211130828100.18597@reclus.nhh.no>

On Mon, 12 Nov 2012, dani jon wrote:

> Hi Roger,
> I apologize for multiple posting.  I thought the list automatically posts
> the questions and  didn't know the questions go through admin before being
> posted.  I'll be patient next time...
>

No administrative moderation takes place on this list - all messages from 
subscribers are circulated immediately, and shown in the archive. All your 
three copies were sent to over 2600 recipients worldwide. Since you 
yourself have chosen to receive digests (once daily), please wait at least 
24 hours for any reply onlist. Please also do use the archives to check 
whether a message has been posted.

This isn't just a response to you, other list members seem to need 
reminding from time to time, certainly about not posting HTML.

Roger

>
>
>
> On Mon, Nov 12, 2012 at 2:40 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> Patience is a virtue - this is your third identical posting on this topic.
>> Please do respect the time list members give. Please also read the list
>> instructions:
>>
>> http://www.r-project.org/mail.**html#instructions<http://www.r-project.org/mail.html#instructions>
>>
>> and posting guide:
>>
>> http://www.r-project.org/**posting-guide.html<http://www.r-project.org/posting-guide.html>
>>
>> and note that you should only post plain text, not HTML, content. If you
>> look at the archived version of your posting, you see:
>>
>> https://stat.ethz.ch/**pipermail/r-sig-geo/2012-**November/016684.html<https://stat.ethz.ch/pipermail/r-sig-geo/2012-November/016684.html>
>>
>> which treats your posting as an attachment. We strip HTML to reduce carbon
>> footprint of the list (fewer bytes to store and transmit), and to reduce
>> danger from included content. Please play by the rules ...
>>
>> A slightly tired list admin.
>>
>>
>> On Mon, 12 Nov 2012, dani jon wrote:
>>
>>  Dear List,
>>> I am interested in overlaying a regular polygon grid of 8 by 8 into a
>>> spatial surface. Essentially, dividing the spatial surface into 64 polygon
>>> grids and would like to take a sample of 10 points (pixels) with
>>> corresponding xy coordinate and values for each of the 64 grids.  Here is
>>> my attempt.
>>>
>>> library(maptools)
>>> library(raster)
>>> library(sp)
>>> library(gstat)
>>> library(maps)
>>>
>>> ## Creating spatial surface
>>>
>>> xg = seq(1, 100,, 100)
>>> yg = seq(1, 100,, 100)
>>> xy = expand.grid(xg, yg)
>>> names(xy) <- c("x","y")
>>> g.dummy <- gstat(formula=z~1, locations=~x+y, dummy=T, beta=1,
>>> model=vgm(psill=0.025,model="
>>> Exp",range=15), nmax=20)
>>> yy <- predict(g.dummy, newdata=xy, nsim=1)
>>> gridded(yy) = ~x+y
>>> coor.yy <- coordinates(yy[1])
>>> ytrue <-yy[1]@data
>>> yyspdf<- SpatialPointsDataFrame(coords=**coor.yy, data=ytrue)
>>> yyspdf[1:10,]
>>> coordinates     sim1
>>> 1       (1, 1) 1.305260
>>> 2       (2, 1) 1.287697
>>> 3       (3, 1) 1.219094
>>> 4       (4, 1) 1.333913
>>> 5       (5, 1) 1.268508
>>> 6       (6, 1) 1.263417
>>> 7       (7, 1) 1.243237
>>> 8       (8, 1) 1.276870
>>> 9       (9, 1) 1.231528
>>> 10     (10, 1) 1.162322
>>>
>>> ## creating regular polygon grid (8x8)
>>>
>>> grd <- GridTopology(c(6.3,6.3), c(12.5,12.5), c(8,8))
>>> SpP_grd <-as.SpatialPolygons.**GridTopology(grd)
>>> plot(SpP_grd)
>>> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
>>> slot(i, "ID")), cex=0.5)
>>> ids <- sapply(slot(SpP_grd, 'polygons'), function(i) slot(i, 'ID'))
>>> trdata <- data.frame(A=rep(c(1,2,3,4,5,**6,7,8), 8),
>>> B=rep(c(1,2,3,4,5,6,7,8), each=8),
>>> row.names=sapply(slot(SpP_grd, "polygons"), function(i) slot(i, "ID")))
>>> SpPDF <- SpatialPolygonsDataFrame(SpP_**grd, trdata)
>>> SpPDF at data = cbind(SpPDF at data,ids)
>>>
>>>  SpPDF at data[1:10,]
>>>>
>>>    A B ids
>>> g1  1 1  g1
>>> g2  2 1  g2
>>> g3  3 1  g3
>>> g4  4 1  g4
>>> g5  5 1  g5
>>> g6  6 1  g6
>>> g7  7 1  g7
>>> g8  8 1  g8
>>> g9  1 2  g9
>>> g10 2 2 g10
>>>
>>> ## Overlay
>>> image(yy[1])
>>> plot(SpPDF, border="magenta", add=TRUE)
>>> text(coordinates(SpP_grd), sapply(slot(SpP_grd, "polygons"), function(i)
>>> slot(i, "ID")), cex=0.5)
>>>
>>> My question is how to overlay yy[1] and SpPDF and take 10 samples within
>>> each polygon grid (g1-g64) and extract the values and coordinates of
>>> yy[1]?  So I will have an output with a sample of 640
>>>
>>> x  y   sim1        ids
>>> 1  2   1.305260   g1
>>> 1 3 1.02567     g1
>>> .
>>> .
>>> 95 95 1.3487    g64
>>>
>>> Edzer  suggested something likes this, but it does not exactly  640
>>> samples
>>> (10*64) as I wanted.
>>>
>>> x = do.call(rbind, lapply(1:10, function(x) spsample(yy, cellsize = 12.5,
>>> type = "stratified")))
>>>
>>> Thanks in advance
>>> Best regards
>>> Sam
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From raffaele.morelli at gmail.com  Tue Nov 13 09:05:40 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 13 Nov 2012 09:05:40 +0100
Subject: [R-sig-Geo] Error: cannot allocate vector of size 274.7 Mb
Message-ID: <CAD4guxM-C7xJJRogYTOWY-rc=-oyzjsN8Hqph7p4y6+VUraq-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121113/a383d69f/attachment.pl>

From rinke.heida at aris.nl  Tue Nov 13 10:41:22 2012
From: rinke.heida at aris.nl (Rinke)
Date: Tue, 13 Nov 2012 01:41:22 -0800 (PST)
Subject: [R-sig-Geo] Non Square Pixels
In-Reply-To: <1300090247848-6168182.post@n2.nabble.com>
References: <AANLkTik5kSNGq+_gktdr7XYJhGgsgKmLRcsrHu+D7-rg@mail.gmail.com>
	<1300090247848-6168182.post@n2.nabble.com>
Message-ID: <1352799682119-7581692.post@n2.nabble.com>

Last week we released a new version of the ARIS ASCII Grid Reader for ArcGIS
10.0: http://www.aris.nl/asciigridreader_arcgis
<http://www.aris.nl/asciigridreader_arcgis>  The ASCII Grid Reader version
3.0 will do a direct read of ESRI ASCII GRID's in ArcCatalog and ArcMap with
small modifications to the strict ESRI ASCII GRID format like:    Non-square
cell size by using keywords XCELLSIZE and YCELLSIZE    Non-square cell size
by using keywords XDIM and YDIM    Non-numeric Nodata value like "NULL",
"NA", "mv", "!", "-"    Any order of the keywords in the header    Comment
on the first lineAs soon as you load an ASCII GRID in ArcMap you can do most
operations possible on image/raster layers, like calculations and export to
a number of formats using standard ArcGIS functionality.Maybe this is a
solution for your problem.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Non-Square-Pixels-tp6049989p7581692.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Tue Nov 13 10:41:56 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Nov 2012 10:41:56 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
Message-ID: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>

Hi!
I modify the CRS of a raster object:
> vinedomosaicMCA03 <- brick(paste(mosdir,"mosaico_envi.dat",sep="/"))
> proj <- CRS("+init=epsg:3042")
> proj
CRS arguments:
 +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs
> projection(vinedomosaicMCA03) <- proj
> vinedomosaicMCA03
class       : RasterBrick
dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
resolution  : 0.170881, 0.170881  (x, y)
extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs
data source : /media/Iomega_HDD/UAVetal/vinedo/Clara_final/mosaico_envi.dat
names       : mosaico_envi.1, mosaico_envi.2, mosaico_envi.3,
mosaico_envi.4, mosaico_envi.5, mosaico_envi.6

But then, after a reordering, the CRS changes again on its own:
> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
> vinedomosaicMCA03v2
class       : RasterStack
dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
resolution  : 0.170881, 0.170881  (x, y)
extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
+units=m +no_defs
names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
min values  : NA, NA, NA, NA, NA, NA
max values  : NA, NA, NA, NA, NA, NA

The correct CRS is conserved if I write to GTiff:
> projection(vinedomosaicMCA03v2) <- proj
> vinedomosaicMCA03v2
class       : RasterStack
dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
resolution  : 0.170881, 0.170881  (x, y)
extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs
names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
min values  : NA, NA, NA, NA, NA, NA
max values  : NA, NA, NA, NA, NA, NA

> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="GTiff")
class       : RasterBrick
dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
resolution  : 0.170881, 0.170881  (x, y)
extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.tif
names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
min values  : 0, 0, 0, 0, 0, 0
max values  : 175, 224, 179, 199, 196, 204

But it is modified if I write to ENVI format:

> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="ENVI")
class       : RasterBrick
dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
resolution  : 0.170881, 0.170881  (x, y)
extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=30 +datum=NAD27 +units=m +no_defs
+ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.envi
names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
min values  : 0, 0, 0, 0, 0, 0
max values  : 175, 224, 179, 199, 196, 204


Is this a bug in raster or rgdal, or am I doing something wrong?

Agus


From alobolistas at gmail.com  Tue Nov 13 10:42:38 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Nov 2012 10:42:38 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
Message-ID: <CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>

Sorry I forgot my session info:
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=C                 LC_NAME=C
LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-5   raster_2.0-12 sp_0.9-99

loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.19-30 tools_2.15.2

Agus

On Tue, Nov 13, 2012 at 10:41 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Hi!
> I modify the CRS of a raster object:
>> vinedomosaicMCA03 <- brick(paste(mosdir,"mosaico_envi.dat",sep="/"))
>> proj <- CRS("+init=epsg:3042")
>> proj
> CRS arguments:
>  +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>> projection(vinedomosaicMCA03) <- proj
>> vinedomosaicMCA03
> class       : RasterBrick
> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
> resolution  : 0.170881, 0.170881  (x, y)
> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
> data source : /media/Iomega_HDD/UAVetal/vinedo/Clara_final/mosaico_envi.dat
> names       : mosaico_envi.1, mosaico_envi.2, mosaico_envi.3,
> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>
> But then, after a reordering, the CRS changes again on its own:
>> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
>> vinedomosaicMCA03v2
> class       : RasterStack
> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
> resolution  : 0.170881, 0.170881  (x, y)
> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
> +units=m +no_defs
> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
> min values  : NA, NA, NA, NA, NA, NA
> max values  : NA, NA, NA, NA, NA, NA
>
> The correct CRS is conserved if I write to GTiff:
>> projection(vinedomosaicMCA03v2) <- proj
>> vinedomosaicMCA03v2
> class       : RasterStack
> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
> resolution  : 0.170881, 0.170881  (x, y)
> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
> min values  : NA, NA, NA, NA, NA, NA
> max values  : NA, NA, NA, NA, NA, NA
>
>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="GTiff")
> class       : RasterBrick
> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
> resolution  : 0.170881, 0.170881  (x, y)
> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
> data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.tif
> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
> min values  : 0, 0, 0, 0, 0, 0
> max values  : 175, 224, 179, 199, 196, 204
>
> But it is modified if I write to ENVI format:
>
>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="ENVI")
> class       : RasterBrick
> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
> resolution  : 0.170881, 0.170881  (x, y)
> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=30 +datum=NAD27 +units=m +no_defs
> +ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
> data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.envi
> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
> min values  : 0, 0, 0, 0, 0, 0
> max values  : 175, 224, 179, 199, 196, 204
>
>
> Is this a bug in raster or rgdal, or am I doing something wrong?
>
> Agus


From Roger.Bivand at nhh.no  Tue Nov 13 11:01:04 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Nov 2012 11:01:04 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>

Please provide a completely reproducible example, otherwise nobody can say 
that this isn't simply a feature of your data. I can't see why helpers 
should be expected to create an example for you, which may not correctly 
represent your problem.

Roger


On Tue, 13 Nov 2012, Agustin Lobo wrote:

> Sorry I forgot my session info:
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> LC_ADDRESS=C               LC_TELEPHONE=C
> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.7-5   raster_2.0-12 sp_0.9-99
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.2     lattice_0.19-30 tools_2.15.2
>
> Agus
>
> On Tue, Nov 13, 2012 at 10:41 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> Hi!
>> I modify the CRS of a raster object:
>>> vinedomosaicMCA03 <- brick(paste(mosdir,"mosaico_envi.dat",sep="/"))
>>> proj <- CRS("+init=epsg:3042")
>>> proj
>> CRS arguments:
>>  +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>> projection(vinedomosaicMCA03) <- proj
>>> vinedomosaicMCA03
>> class       : RasterBrick
>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>> resolution  : 0.170881, 0.170881  (x, y)
>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>> data source : /media/Iomega_HDD/UAVetal/vinedo/Clara_final/mosaico_envi.dat
>> names       : mosaico_envi.1, mosaico_envi.2, mosaico_envi.3,
>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>
>> But then, after a reordering, the CRS changes again on its own:
>>> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
>>> vinedomosaicMCA03v2
>> class       : RasterStack
>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>> resolution  : 0.170881, 0.170881  (x, y)
>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
>> +units=m +no_defs
>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>> min values  : NA, NA, NA, NA, NA, NA
>> max values  : NA, NA, NA, NA, NA, NA
>>
>> The correct CRS is conserved if I write to GTiff:
>>> projection(vinedomosaicMCA03v2) <- proj
>>> vinedomosaicMCA03v2
>> class       : RasterStack
>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>> resolution  : 0.170881, 0.170881  (x, y)
>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>> min values  : NA, NA, NA, NA, NA, NA
>> max values  : NA, NA, NA, NA, NA, NA
>>
>>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="GTiff")
>> class       : RasterBrick
>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>> resolution  : 0.170881, 0.170881  (x, y)
>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
>> data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.tif
>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>> min values  : 0, 0, 0, 0, 0, 0
>> max values  : 175, 224, 179, 199, 196, 204
>>
>> But it is modified if I write to ENVI format:
>>
>>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="ENVI")
>> class       : RasterBrick
>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>> resolution  : 0.170881, 0.170881  (x, y)
>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=utm +zone=30 +datum=NAD27 +units=m +no_defs
>> +ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>> data source : /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.envi
>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>> min values  : 0, 0, 0, 0, 0, 0
>> max values  : 175, 224, 179, 199, 196, 204
>>
>>
>> Is this a bug in raster or rgdal, or am I doing something wrong?
>>
>> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From raffaele.morelli at gmail.com  Tue Nov 13 11:20:03 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 13 Nov 2012 11:20:03 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
	274.7 Mb
Message-ID: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>

Hi,
sorry for double posting but I saw my messages were scrubbed from html
garbage and don't know if nobody replies for that, but just in case...
apologize if not.

I am having trouble with this error when calculating a density on a
point pattern dataset with 34480 points.
My script exit when calculating

z<-density(mypattern, 3000, dimyx=3000)

The machine the script it's running on it's a debian/amd64 OS with
16Gb RAM, I have set to unlimited the memory limits (the output of
ulimit -a follows)

Any ideas?
Regards
-raffaele

------------------------
rmorelli at amb-asa1:~/R$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 128594
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 128594
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

--
L'unica speranza di catarsi, ammesso che ne esista una, resta affidata
all'istinto di ribellione, alla rivolta non isterilita in progetti,
alla protesta violenta e viscerale. (V. Evangelisti)


From alobolistas at gmail.com  Tue Nov 13 11:35:31 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Nov 2012 11:35:31 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
Message-ID: <CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>

http://dl.dropbox.com/u/3180464/mosaico_envi.dat
http://dl.dropbox.com/u/3180464/mosaico_envi.hdr

to be read in with
vinedomosaicMCA03 <- brick("mosaico_envi.dat")

(both files must be present in the same directory)

Agus

On Tue, Nov 13, 2012 at 11:01 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> Please provide a completely reproducible example, otherwise nobody can say
> that this isn't simply a feature of your data. I can't see why helpers
> should be expected to create an example for you, which may not correctly
> represent your problem.
>
> Roger
>
>
>
> On Tue, 13 Nov 2012, Agustin Lobo wrote:
>
>> Sorry I forgot my session info:
>>>
>>> sessionInfo()
>>
>> R version 2.15.2 (2012-10-26)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> [7] LC_PAPER=C                 LC_NAME=C
>> LC_ADDRESS=C               LC_TELEPHONE=C
>> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-5   raster_2.0-12 sp_0.9-99
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.2     lattice_0.19-30 tools_2.15.2
>>
>> Agus
>>
>> On Tue, Nov 13, 2012 at 10:41 AM, Agustin Lobo <alobolistas at gmail.com>
>> wrote:
>>>
>>> Hi!
>>> I modify the CRS of a raster object:
>>>>
>>>> vinedomosaicMCA03 <- brick(paste(mosdir,"mosaico_envi.dat",sep="/"))
>>>> proj <- CRS("+init=epsg:3042")
>>>> proj
>>>
>>> CRS arguments:
>>>  +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>>>
>>>> projection(vinedomosaicMCA03) <- proj
>>>> vinedomosaicMCA03
>>>
>>> class       : RasterBrick
>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>> resolution  : 0.170881, 0.170881  (x, y)
>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>> data source :
>>> /media/Iomega_HDD/UAVetal/vinedo/Clara_final/mosaico_envi.dat
>>> names       : mosaico_envi.1, mosaico_envi.2, mosaico_envi.3,
>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>>
>>> But then, after a reordering, the CRS changes again on its own:
>>>>
>>>> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
>>>> vinedomosaicMCA03v2
>>>
>>> class       : RasterStack
>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>> resolution  : 0.170881, 0.170881  (x, y)
>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : +proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
>>> +units=m +no_defs
>>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>> min values  : NA, NA, NA, NA, NA, NA
>>> max values  : NA, NA, NA, NA, NA, NA
>>>
>>> The correct CRS is conserved if I write to GTiff:
>>>>
>>>> projection(vinedomosaicMCA03v2) <- proj
>>>> vinedomosaicMCA03v2
>>>
>>> class       : RasterStack
>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>> resolution  : 0.170881, 0.170881  (x, y)
>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>> min values  : NA, NA, NA, NA, NA, NA
>>> max values  : NA, NA, NA, NA, NA, NA
>>>
>>>>
>>>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="GTiff")
>>>
>>> class       : RasterBrick
>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>> resolution  : 0.170881, 0.170881  (x, y)
>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
>>> data source :
>>> /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.tif
>>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>>> min values  : 0, 0, 0, 0, 0, 0
>>> max values  : 175, 224, 179, 199, 196, 204
>>>
>>> But it is modified if I write to ENVI format:
>>>
>>>>
>>>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="ENVI")
>>>
>>> class       : RasterBrick
>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>> resolution  : 0.170881, 0.170881  (x, y)
>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : +proj=utm +zone=30 +datum=NAD27 +units=m +no_defs
>>> +ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>>> data source :
>>> /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.envi
>>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>>> min values  : 0, 0, 0, 0, 0, 0
>>> max values  : 175, 224, 179, 199, 196, 204
>>>
>>>
>>> Is this a bug in raster or rgdal, or am I doing something wrong?
>>>
>>> Agus
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Nov 13 12:40:28 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Nov 2012 12:40:28 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
	<CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>

On Tue, 13 Nov 2012, Agustin Lobo wrote:

> http://dl.dropbox.com/u/3180464/mosaico_envi.dat
> http://dl.dropbox.com/u/3180464/mosaico_envi.hdr
>

I do not think dumping 40MB on people is a helpful example. The idea is 
that you rather go through the trouble of re-creating the problem from a 
small data set, preferably built-in, because very oftem the process of 
re-creating the problem solves it, that is, you find out which step you 
took that deserved more thought.

It is also really helpful to have the input code verbatim, rather than 
interspersed with output, as this is easier to copy & paste. In addition, 
please use spaces after commas in included code, to avoid problems with 
representation by different email clients; using T for TRUE is bad 
practice, as I could have assigned T <- logical(NA) or "boo!"!


After downloading your data, and:

library(raster)
library(rgdal)
vinedomosaicMCA03 <- brick("mosaico_envi.dat")
projection(vinedomosaicMCA03)

says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs"

and:

ds <- GDAL.open("mosaico_envi.dat")
getProjectionRef(ds)
GDAL.close(ds)

says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "

Why then assign a projection? After:

proj <- CRS("+init=epsg:3042")
projection(vinedomosaicMCA03) <- proj
projection(vinedomosaicMCA03)

we have: "+init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80 
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs"

which is the same projection. Following subsetting:

vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03, c(3, 1, 2, 4, 5, 6))
projection(vinedomosaicMCA03v2)

we again have the same projection: "+proj=utm +zone=30 +ellps=GRS80 
+units=m +no_defs"; as you know, the dropped terms are simply duplicates, 
and do not change the spatial reference at all.

writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE, 
format="GTiff")

which takes a long time as this is a very large object.

ds <- GDAL.open("mosaico_enviv2.tif")
getProjectionRef(ds)
GDAL.close(ds)

shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "

which is exactly as read into R from the input file. Using the ENVI 
format:

writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE, 
format="ENVI")

ds <- GDAL.open("mosaico_enviv2.envi")
getProjectionRef(ds)
GDAL.close(ds)

shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "

So what is your problem? Please do check everything carefully, use another 
data set, and check that you understand what you are doing before 
suggesting that others should devote their time to your muddle?

Roger

> to be read in with
> vinedomosaicMCA03 <- brick("mosaico_envi.dat")
>
> (both files must be present in the same directory)
>
> Agus
>
> On Tue, Nov 13, 2012 at 11:01 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> Please provide a completely reproducible example, otherwise nobody can say
>> that this isn't simply a feature of your data. I can't see why helpers
>> should be expected to create an example for you, which may not correctly
>> represent your problem.
>>
>> Roger
>>
>>
>>
>> On Tue, 13 Nov 2012, Agustin Lobo wrote:
>>
>>> Sorry I forgot my session info:
>>>>
>>>> sessionInfo()
>>>
>>> R version 2.15.2 (2012-10-26)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>> LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> [7] LC_PAPER=C                 LC_NAME=C
>>> LC_ADDRESS=C               LC_TELEPHONE=C
>>> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.7-5   raster_2.0-12 sp_0.9-99
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.15.2     lattice_0.19-30 tools_2.15.2
>>>
>>> Agus
>>>
>>> On Tue, Nov 13, 2012 at 10:41 AM, Agustin Lobo <alobolistas at gmail.com>
>>> wrote:
>>>>
>>>> Hi!
>>>> I modify the CRS of a raster object:
>>>>>
>>>>> vinedomosaicMCA03 <- brick(paste(mosdir,"mosaico_envi.dat",sep="/"))
>>>>> proj <- CRS("+init=epsg:3042")
>>>>> proj
>>>>
>>>> CRS arguments:
>>>>  +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>>>>
>>>>> projection(vinedomosaicMCA03) <- proj
>>>>> vinedomosaicMCA03
>>>>
>>>> class       : RasterBrick
>>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>>> resolution  : 0.170881, 0.170881  (x, y)
>>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>>> data source :
>>>> /media/Iomega_HDD/UAVetal/vinedo/Clara_final/mosaico_envi.dat
>>>> names       : mosaico_envi.1, mosaico_envi.2, mosaico_envi.3,
>>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>>>
>>>> But then, after a reordering, the CRS changes again on its own:
>>>>>
>>>>> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
>>>>> vinedomosaicMCA03v2
>>>>
>>>> class       : RasterStack
>>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>>> resolution  : 0.170881, 0.170881  (x, y)
>>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
>>>> +units=m +no_defs
>>>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>>> min values  : NA, NA, NA, NA, NA, NA
>>>> max values  : NA, NA, NA, NA, NA, NA
>>>>
>>>> The correct CRS is conserved if I write to GTiff:
>>>>>
>>>>> projection(vinedomosaicMCA03v2) <- proj
>>>>> vinedomosaicMCA03v2
>>>>
>>>> class       : RasterStack
>>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>>> resolution  : 0.170881, 0.170881  (x, y)
>>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>>>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
>>>> names       : mosaico_envi.3, mosaico_envi.1, mosaico_envi.2,
>>>> mosaico_envi.4, mosaico_envi.5, mosaico_envi.6
>>>> min values  : NA, NA, NA, NA, NA, NA
>>>> max values  : NA, NA, NA, NA, NA, NA
>>>>
>>>>>
>>>>> writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2",
  overwrite=T, format="GTiff")
>>>>
>>>> class       : RasterBrick
>>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>>> resolution  : 0.170881, 0.170881  (x, y)
>>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
>>>> data source :
>>>> /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.tif
>>>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>>>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>>>> min values  : 0, 0, 0, 0, 0, 0
>>>> max values  : 175, 224, 179, 199, 196, 204
>>>>
>>>> But it is modified if I write to ENVI format:
>>>>
>>>>>
>>>>> writeRaster(vinedomosaicMCA03v2,file="mosaico_enviv2",overwrite=T,format="ENVI")
>>>>
>>>> class       : RasterBrick
>>>> dimensions  : 1486, 1162, 1726732, 6  (nrow, ncol, ncell, nlayers)
>>>> resolution  : 0.170881, 0.170881  (x, y)
>>>> extent      : 578587.4, 578785.9, 4722025, 4722279  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +proj=utm +zone=30 +datum=NAD27 +units=m +no_defs
>>>> +ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>>>> data source :
>>>> /media/Iomega_HDD/UAVetal/vinedo/RNavarra/mosaico_enviv2.envi
>>>> names       : mosaico_enviv2.1, mosaico_enviv2.2, mosaico_enviv2.3,
>>>> mosaico_enviv2.4, mosaico_enviv2.5, mosaico_enviv2.6
>>>> min values  : 0, 0, 0, 0, 0, 0
>>>> max values  : 175, 224, 179, 199, 196, 204
>>>>
>>>>
>>>> Is this a bug in raster or rgdal, or am I doing something wrong?
>>>>
>>>> Agus
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From roman.lustrik at gmail.com  Tue Nov 13 13:35:45 2012
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 13 Nov 2012 13:35:45 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
 274.7 Mb
In-Reply-To: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
References: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
Message-ID: <CAHT1vph9b+aWPFbjDhjRZnq0+1gict+4vbp4++es0R0Pu+ObHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121113/a37aa5e7/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Tue Nov 13 14:30:04 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 13 Nov 2012 14:30:04 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
 274.7 Mb
In-Reply-To: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
References: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
Message-ID: <50A24B5C.7000805@jrc.ec.europa.eu>

On 13/11/12 11:20, Raffaele Morelli wrote:
> Hi,
> sorry for double posting but I saw my messages were scrubbed from html
> garbage and don't know if nobody replies for that, but just in case...
> apologize if not.
>
> I am having trouble with this error when calculating a density on a
> point pattern dataset with 34480 points.
> My script exit when calculating
>
> z<-density(mypattern, 3000, dimyx=3000)
>
> The machine the script it's running on it's a debian/amd64 OS with
> 16Gb RAM, I have set to unlimited the memory limits (the output of
> ulimit -a follows)
>
> Any ideas?

Try:

?memory.limit
?gc

and read 'Circle 2' of the R_inferno 
(www.burns-stat.com/pages/Tutor/R_inferno.pdf)

IHTH,

Mauricio

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:11}}


From raffaele.morelli at gmail.com  Tue Nov 13 15:31:49 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 13 Nov 2012 15:31:49 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
 274.7 Mb
In-Reply-To: <CAHT1vph9b+aWPFbjDhjRZnq0+1gict+4vbp4++es0R0Pu+ObHg@mail.gmail.com>
References: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
	<CAHT1vph9b+aWPFbjDhjRZnq0+1gict+4vbp4++es0R0Pu+ObHg@mail.gmail.com>
Message-ID: <CAD4guxMkK9om+Srp1m6LZCTr=_tt=Uv+ELvTbLyNrtUBaW+QUw@mail.gmail.com>

2012/11/13 Roman Lu?trik <roman.lustrik at gmail.com>:
> Would it be at all possible if you made your problem reproducible?
>
>
> Cheers,
> Roman

I can upload my .RData (~45Mb) on a server and the script if you're
willing to try.

In the meanwhile I am doing some test with my owin taken from the maps
dataset, I guess the one I am using is too much detailed.

-r


From clement.calenge at oncfs.gouv.fr  Tue Nov 13 16:22:25 2012
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Tue, 13 Nov 2012 16:22:25 +0100
Subject: [R-sig-Geo] adehabitatHS - kselect analysis
In-Reply-To: <4780FC16AA89574CA36BB63C15DF63A1014B0417@mbx02.w2kroot.uni-oldenburg.de>
References: <4780FC16AA89574CA36BB63C15DF63A1014B0417@mbx02.w2kroot.uni-oldenburg.de>
Message-ID: <50A265B1.90408@oncfs.gouv.fr>

Dear Roland,

> while analyzing animal relocations using the kselect analysis in adehabitatHS (third-order habitat selection), I would greatly appreciate any help with the following two topics:
>
> 1) How to test for significance if the relocations are not independent? Since I am working with trajectories (time interval between relocations is one hour), I am afraid I cannot use rand.kselect for this purpose?
> Remark: To account for the dependence between successive relocations, I have used the BRB function to estimate the home ranges.

I do no know, but just a clue: maybe you should have a look at null 
model approaches. Have a look at the vignette of the package 
adehabitatLT, section 5. It may be possible to simulate trajectories at 
each step of the null model approach using some kind of movement model 
(which one is a complex question; there are no built-in functions to do 
that, and designing a sensible movement model is not an easy thing).

> 2) This topic deals with the visualization of the kselect results. Using plot.kselect, I get (among others) two diagrams showing a) the scores of the environmental variables (corresponding to x$l1 of the output) on the axes and b), the scores of the recentered marginality vectors on the axes (x$co). Just to be sure: Would it be mathematically correct to combine both scores into one single diagram, i.e. to create a kind of biplot?

Basically, the K-select analysis is a non-centered principal component 
analysis, so that biplots sensu Gabriel (1971) are indeed possible. Use 
the function scatter from the package ade4 to draw such biplots.
Best regards,

Cl?ment Calenge

> Many thanks in advance!
>
> Roland Pape
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From ashton at msu.edu  Tue Nov 13 18:39:06 2012
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 13 Nov 2012 12:39:06 -0500
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
	<CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
Message-ID: <201211131239.06942.ashton@msu.edu>

Dear Johan (and list),

you are right in the first case: I think the result is expected. Using global 
data with this sort of projection will look kind of awful - the equatorial 
azimuthal equidistant illustrations in Snyder do not try to map data for the 
whole planet - they employ a hemisphere.

When I clip the results to a hemisphere:
dta <- map("world",  xlim=c(-180, 0), ylim=c(-90,90), plot=FALSE)
...
dta2 <- spTransform(dta1, CRS("+proj=aeqd +lat_0=0 +lon_0=-0"))
plot(dta2, axes=TRUE)

the result looks pretty similar to what I see in Snyder's work.

That said... it is strange to me that using your global data the projection 
does NOT wrap around when doing a polar azimuthal projection, but then it does 
when you do not. This may not be on-topic for this stats list - I wonder if 
you could reach out to the GDAL community if you still have questions?

Yours,

Ashton




On 11/13/12, Johan Mazel, wrote:
> Thanks for your answer.
> 
> Regarding your last paragraph, I am not really sure to understand.
> Do you mean that the result is expected in regards to the script (and
> rgdal use) ?
> Or do you mean that azimuthal equidistant projection is not
> possible/valid on any other points than the two poles ? Because, if it
> is the latter, Synder's book seems to disagree. If you look at figure
> 41.C, it looks like azimuthal equidistant projection centered on a
> different point than on of the two pole is possible.
> 
> Thanks a lot for your time.
> Johan
> 
> 2012/11/12 Ashton Shortridge <ashton at msu.edu>:
> > Dear Johan (and list),
> > 
> > I'm not a professional cartographer, but I do find myself flipping
> > through Snyder's book of map projections every once in a while.
> > 
> > Looking at your results, I don't see anything 'wrong' with the code or
> > the results. Yes, the map looks awful, but that is what it should look
> > like. Imagine a glass globe of the Earth with outlines of the land
> > masses etched on it. Now imagine you have oriented that globe so that
> > you are looking down at 45N, 90W (somewhere not far from my neck of the
> > woods). What you see as "Australia right next to Canada" is from looking
> > 'through the globe', which is why Australia appears to be inverted, and
> > why South America seems to fold under itself (also Africa).
> > 
> > Now this projection is not really a glass globe, but I hope the metaphor
> > makes it a bit clearer. It should also make clearer why people don't
> > normally use azimuthal projections for global mapping. Coincidentally it
> > works sorta kinda ok from the north pole, but don't plan on it working
> > well from other places.
> > 
> > Hope this is helpful.
> > 
> > Ashton
> > 
> > 
> > -----
> > Ashton Shortridge
> > Associate Professor                     ashton at msu.edu
> > Dept of Geography                       http://www.msu.edu/~ashton
> > 235 Geography Building          ph (517) 432-3561
> > Michigan State University               fx (517) 432-1671
> > 
> > On 11/12/12, Johan Mazel, wrote:
> >> Here is the code that I am using and the result.
> >> The problem on the result is that, on the fourth and last page, it
> >> looks like some parts of the map are not located where they are
> >> supposed to be (Australia is thus right next to Canada).
> >> 
> >> My only modification is that I removed the xlim and ylim parameters in
> >> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
> >> plot=FALSE)" in the original script. It obviously has a impact on the
> >> final output but I can`t figure out what is happening.
> >> 
> >> Thanks for your time.
> >> Regards.
> >> Johan
> >> 
> >> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
> >> > Hi
> >> > I am trying to use the solution rpesented here:
> >> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
> >> > 
> >> > However it looks like the shifted (from the north pole) map is
> >> > displayed on top on the original azimuthal equidistant projection
> >> > centered on the north pole.
> >> > Is there any way to correct this ?
> >> > 
> >> > Thanks for your time.
> >> > Regards.
> >> > Johan


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From ashton at msu.edu  Tue Nov 13 18:39:06 2012
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 13 Nov 2012 12:39:06 -0500
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
	<CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
Message-ID: <201211131239.06942.ashton@msu.edu>

Dear Johan (and list),

you are right in the first case: I think the result is expected. Using global 
data with this sort of projection will look kind of awful - the equatorial 
azimuthal equidistant illustrations in Snyder do not try to map data for the 
whole planet - they employ a hemisphere.

When I clip the results to a hemisphere:
dta <- map("world",  xlim=c(-180, 0), ylim=c(-90,90), plot=FALSE)
...
dta2 <- spTransform(dta1, CRS("+proj=aeqd +lat_0=0 +lon_0=-0"))
plot(dta2, axes=TRUE)

the result looks pretty similar to what I see in Snyder's work.

That said... it is strange to me that using your global data the projection 
does NOT wrap around when doing a polar azimuthal projection, but then it does 
when you do not. This may not be on-topic for this stats list - I wonder if 
you could reach out to the GDAL community if you still have questions?

Yours,

Ashton




On 11/13/12, Johan Mazel, wrote:
> Thanks for your answer.
> 
> Regarding your last paragraph, I am not really sure to understand.
> Do you mean that the result is expected in regards to the script (and
> rgdal use) ?
> Or do you mean that azimuthal equidistant projection is not
> possible/valid on any other points than the two poles ? Because, if it
> is the latter, Synder's book seems to disagree. If you look at figure
> 41.C, it looks like azimuthal equidistant projection centered on a
> different point than on of the two pole is possible.
> 
> Thanks a lot for your time.
> Johan
> 
> 2012/11/12 Ashton Shortridge <ashton at msu.edu>:
> > Dear Johan (and list),
> > 
> > I'm not a professional cartographer, but I do find myself flipping
> > through Snyder's book of map projections every once in a while.
> > 
> > Looking at your results, I don't see anything 'wrong' with the code or
> > the results. Yes, the map looks awful, but that is what it should look
> > like. Imagine a glass globe of the Earth with outlines of the land
> > masses etched on it. Now imagine you have oriented that globe so that
> > you are looking down at 45N, 90W (somewhere not far from my neck of the
> > woods). What you see as "Australia right next to Canada" is from looking
> > 'through the globe', which is why Australia appears to be inverted, and
> > why South America seems to fold under itself (also Africa).
> > 
> > Now this projection is not really a glass globe, but I hope the metaphor
> > makes it a bit clearer. It should also make clearer why people don't
> > normally use azimuthal projections for global mapping. Coincidentally it
> > works sorta kinda ok from the north pole, but don't plan on it working
> > well from other places.
> > 
> > Hope this is helpful.
> > 
> > Ashton
> > 
> > 
> > -----
> > Ashton Shortridge
> > Associate Professor                     ashton at msu.edu
> > Dept of Geography                       http://www.msu.edu/~ashton
> > 235 Geography Building          ph (517) 432-3561
> > Michigan State University               fx (517) 432-1671
> > 
> > On 11/12/12, Johan Mazel, wrote:
> >> Here is the code that I am using and the result.
> >> The problem on the result is that, on the fourth and last page, it
> >> looks like some parts of the map are not located where they are
> >> supposed to be (Australia is thus right next to Canada).
> >> 
> >> My only modification is that I removed the xlim and ylim parameters in
> >> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
> >> plot=FALSE)" in the original script. It obviously has a impact on the
> >> final output but I can`t figure out what is happening.
> >> 
> >> Thanks for your time.
> >> Regards.
> >> Johan
> >> 
> >> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
> >> > Hi
> >> > I am trying to use the solution rpesented here:
> >> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
> >> > 
> >> > However it looks like the shifted (from the north pole) map is
> >> > displayed on top on the original azimuthal equidistant projection
> >> > centered on the north pole.
> >> > Is there any way to correct this ?
> >> > 
> >> > Thanks for your time.
> >> > Regards.
> >> > Johan


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From alobolistas at gmail.com  Tue Nov 13 20:14:33 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Nov 2012 20:14:33 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
	<CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
	<alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>
Message-ID: <CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>

Roger,
I'm not dumping anything on anybody: those are links that you download
if you want to,
and that I posted only after you requested an example.
Also, could you post your session info? According to what you say and
what I reproduce
we get different results for the same file and objects.
Agus

On Tue, Nov 13, 2012 at 12:40 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Tue, 13 Nov 2012, Agustin Lobo wrote:
>
>> http://dl.dropbox.com/u/3180464/mosaico_envi.dat
>> http://dl.dropbox.com/u/3180464/mosaico_envi.hdr
>>
>
> I do not think dumping 40MB on people is a helpful example. The idea is that
> you rather go through the trouble of re-creating the problem from a small
> data set, preferably built-in, because very oftem the process of re-creating
> the problem solves it, that is, you find out which step you took that
> deserved more thought.
>
> It is also really helpful to have the input code verbatim, rather than
> interspersed with output, as this is easier to copy & paste. In addition,
> please use spaces after commas in included code, to avoid problems with
> representation by different email clients; using T for TRUE is bad practice,
> as I could have assigned T <- logical(NA) or "boo!"!
>
>
> After downloading your data, and:
>
> library(raster)
> library(rgdal)
>
> vinedomosaicMCA03 <- brick("mosaico_envi.dat")
> projection(vinedomosaicMCA03)
>
> says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs"
>
> and:
>
> ds <- GDAL.open("mosaico_envi.dat")
> getProjectionRef(ds)
> GDAL.close(ds)
>
> says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>
> Why then assign a projection? After:
>
>
> proj <- CRS("+init=epsg:3042")
> projection(vinedomosaicMCA03) <- proj
> projection(vinedomosaicMCA03)
>
> we have: "+init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>
> which is the same projection. Following subsetting:
>
> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03, c(3, 1, 2, 4, 5, 6))
> projection(vinedomosaicMCA03v2)
>
> we again have the same projection: "+proj=utm +zone=30 +ellps=GRS80 +units=m
> +no_defs"; as you know, the dropped terms are simply duplicates, and do not
> change the spatial reference at all.
>
> writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE,
> format="GTiff")
>
> which takes a long time as this is a very large object.
>
> ds <- GDAL.open("mosaico_enviv2.tif")
> getProjectionRef(ds)
> GDAL.close(ds)
>
> shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>
> which is exactly as read into R from the input file. Using the ENVI format:
>
> writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE,
> format="ENVI")
>
> ds <- GDAL.open("mosaico_enviv2.envi")
> getProjectionRef(ds)
> GDAL.close(ds)
>
> shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>
> So what is your problem? Please do check everything carefully, use another
> data set, and check that you understand what you are doing before suggesting
> that others should devote their time to your muddle?
>
> Roger
>


From senator at ecotoxicology.de  Tue Nov 13 20:19:51 2012
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Tue, 13 Nov 2012 20:19:51 +0100
Subject: [R-sig-Geo] Strange error plotting SpatialPolygonsDataframe
Message-ID: <2CB4A58D-DF5B-48AC-9243-FDD3107E308E@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121113/5896f381/attachment.pl>

From mdsumner at gmail.com  Tue Nov 13 20:37:39 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 14 Nov 2012 06:37:39 +1100
Subject: [R-sig-Geo]  raster CRS changes on tis own
In-Reply-To: <CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
	<CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
	<alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>
	<CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>
Message-ID: <CAAcGz9_mtKBm5W70VP_LgWS-T0Jr0jZao-3oGWWQ4sJ-_c_+ng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121114/e876a9dc/attachment.pl>

From Roger.Bivand at nhh.no  Tue Nov 13 20:45:04 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Nov 2012 20:45:04 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
	<CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
	<alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>
	<CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211132021430.20069@reclus.nhh.no>

On Tue, 13 Nov 2012, Agustin Lobo wrote:

> Roger,
> I'm not dumping anything on anybody: those are links that you download 
> if you want to, and that I posted only after you requested an example. 
> Also, could you post your session info? According to what you say and 
> what I reproduce we get different results for the same file and objects.

That is precisely why I asked you to provide another example of the 
problem. If the problem cannot be reproduced with other data on your 
system, then it is limited to your initial data set, or the specific code 
used when the unexpected behaviour occurred. If you can reproduce it for 
similar data sets, then it is your system. I did note that you are running 
rgdal 0.7-5, mine is 0.7-22 (the current CRAN version). In my case the 
crucial startup messages are:

Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

but yours are unknown. I install GDAL and PROJ.4 from source; like you, I 
am on:

Platform: x86_64-unknown-linux-gnu (64-bit)
(you are: x86_64-pc-linux-gnu (64-bit))

My intuition is that the problem is a stale GDAL on your system, but from 
reading the GDAL tickets and NEWS logs, I can't see an update to the ENVI 
driver that might explain where the odd extra tags are coming from, so it 
might be something else, assuming it is your system and not an 
idiosyncracy of your handling that data set.

Roger

> Agus
>
> On Tue, Nov 13, 2012 at 12:40 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Tue, 13 Nov 2012, Agustin Lobo wrote:
>>
>>> http://dl.dropbox.com/u/3180464/mosaico_envi.dat
>>> http://dl.dropbox.com/u/3180464/mosaico_envi.hdr
>>>
>>
>> I do not think dumping 40MB on people is a helpful example. The idea is that
>> you rather go through the trouble of re-creating the problem from a small
>> data set, preferably built-in, because very oftem the process of re-creating
>> the problem solves it, that is, you find out which step you took that
>> deserved more thought.
>>
>> It is also really helpful to have the input code verbatim, rather than
>> interspersed with output, as this is easier to copy & paste. In addition,
>> please use spaces after commas in included code, to avoid problems with
>> representation by different email clients; using T for TRUE is bad practice,
>> as I could have assigned T <- logical(NA) or "boo!"!
>>
>>
>> After downloading your data, and:
>>
>> library(raster)
>> library(rgdal)
>>
>> vinedomosaicMCA03 <- brick("mosaico_envi.dat")
>> projection(vinedomosaicMCA03)
>>
>> says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs"
>>
>> and:
>>
>> ds <- GDAL.open("mosaico_envi.dat")
>> getProjectionRef(ds)
>> GDAL.close(ds)
>>
>> says: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>>
>> Why then assign a projection? After:
>>
>>
>> proj <- CRS("+init=epsg:3042")
>> projection(vinedomosaicMCA03) <- proj
>> projection(vinedomosaicMCA03)
>>
>> we have: "+init=epsg:3042 +proj=utm +zone=30 +ellps=GRS80
>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>>
>> which is the same projection. Following subsetting:
>>
>> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03, c(3, 1, 2, 4, 5, 6))
>> projection(vinedomosaicMCA03v2)
>>
>> we again have the same projection: "+proj=utm +zone=30 +ellps=GRS80 +units=m
>> +no_defs"; as you know, the dropped terms are simply duplicates, and do not
>> change the spatial reference at all.
>>
>> writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE,
>> format="GTiff")
>>
>> which takes a long time as this is a very large object.
>>
>> ds <- GDAL.open("mosaico_enviv2.tif")
>> getProjectionRef(ds)
>> GDAL.close(ds)
>>
>> shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>>
>> which is exactly as read into R from the input file. Using the ENVI format:
>>
>> writeRaster(vinedomosaicMCA03v2, file="mosaico_enviv2", overwrite=TRUE,
>> format="ENVI")
>>
>> ds <- GDAL.open("mosaico_enviv2.envi")
>> getProjectionRef(ds)
>> GDAL.close(ds)
>>
>> shows: "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs "
>>
>> So what is your problem? Please do check everything carefully, use another
>> data set, and check that you understand what you are doing before suggesting
>> that others should devote their time to your muddle?
>>
>> Roger
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From c.sonderblohm at gmail.com  Wed Nov 14 00:18:15 2012
From: c.sonderblohm at gmail.com (Carlos pombo sonderblohm)
Date: Tue, 13 Nov 2012 15:18:15 -0800
Subject: [R-sig-Geo] (no subject)
Message-ID: <CAAvcZ+ve1O9kaO9U+y+nhTD1OwhKGTfSD9AB3a7KiJqF=itahw@mail.gmail.com>

 http://cavemancommunications.com/wp-content/plugins/akismet/ugoogle.html


From johan.mazel at gmail.com  Wed Nov 14 06:20:58 2012
From: johan.mazel at gmail.com (Johan Mazel)
Date: Wed, 14 Nov 2012 12:20:58 +0700
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <201211131239.06942.ashton@msu.edu>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
	<CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
	<201211131239.06942.ashton@msu.edu>
Message-ID: <CAKS5mhSiswhaj7a-AvtbQQc7Ue4-tZwnPa3NAjMwJqnsmzReMQ@mail.gmail.com>

Hi
I don't think that Synder's book actually use a hemisphere for the
azimuthal equidistant projection examples.
For example, on figures 41.B and 41.C, you can see Australia
(respectively left to top-left and bottom-left).
I think that in both cases, you can see the whole world. This is quite
obvious on figure 41.C.
I think it is a little less obvious for figure 41.B because, on figure
41.C the outside of the map is a point located in south pacific,
while, on figure 41.B, the outside of the map is a point located in
Malaysia (or maybe Indonesia).

But, maybe this is expected behaviour and I misunderstood the
behaviour of rgdal.

Johan

2012/11/14 Ashton Shortridge <ashton at msu.edu>:
> Dear Johan (and list),
>
> you are right in the first case: I think the result is expected. Using global
> data with this sort of projection will look kind of awful - the equatorial
> azimuthal equidistant illustrations in Snyder do not try to map data for the
> whole planet - they employ a hemisphere.
>
> When I clip the results to a hemisphere:
> dta <- map("world",  xlim=c(-180, 0), ylim=c(-90,90), plot=FALSE)
> ...
> dta2 <- spTransform(dta1, CRS("+proj=aeqd +lat_0=0 +lon_0=-0"))
> plot(dta2, axes=TRUE)
>
> the result looks pretty similar to what I see in Snyder's work.
>
> That said... it is strange to me that using your global data the projection
> does NOT wrap around when doing a polar azimuthal projection, but then it does
> when you do not. This may not be on-topic for this stats list - I wonder if
> you could reach out to the GDAL community if you still have questions?
>
> Yours,
>
> Ashton
>
>
>
>
> On 11/13/12, Johan Mazel, wrote:
>> Thanks for your answer.
>>
>> Regarding your last paragraph, I am not really sure to understand.
>> Do you mean that the result is expected in regards to the script (and
>> rgdal use) ?
>> Or do you mean that azimuthal equidistant projection is not
>> possible/valid on any other points than the two poles ? Because, if it
>> is the latter, Synder's book seems to disagree. If you look at figure
>> 41.C, it looks like azimuthal equidistant projection centered on a
>> different point than on of the two pole is possible.
>>
>> Thanks a lot for your time.
>> Johan
>>
>> 2012/11/12 Ashton Shortridge <ashton at msu.edu>:
>> > Dear Johan (and list),
>> >
>> > I'm not a professional cartographer, but I do find myself flipping
>> > through Snyder's book of map projections every once in a while.
>> >
>> > Looking at your results, I don't see anything 'wrong' with the code or
>> > the results. Yes, the map looks awful, but that is what it should look
>> > like. Imagine a glass globe of the Earth with outlines of the land
>> > masses etched on it. Now imagine you have oriented that globe so that
>> > you are looking down at 45N, 90W (somewhere not far from my neck of the
>> > woods). What you see as "Australia right next to Canada" is from looking
>> > 'through the globe', which is why Australia appears to be inverted, and
>> > why South America seems to fold under itself (also Africa).
>> >
>> > Now this projection is not really a glass globe, but I hope the metaphor
>> > makes it a bit clearer. It should also make clearer why people don't
>> > normally use azimuthal projections for global mapping. Coincidentally it
>> > works sorta kinda ok from the north pole, but don't plan on it working
>> > well from other places.
>> >
>> > Hope this is helpful.
>> >
>> > Ashton
>> >
>> >
>> > -----
>> > Ashton Shortridge
>> > Associate Professor                     ashton at msu.edu
>> > Dept of Geography                       http://www.msu.edu/~ashton
>> > 235 Geography Building          ph (517) 432-3561
>> > Michigan State University               fx (517) 432-1671
>> >
>> > On 11/12/12, Johan Mazel, wrote:
>> >> Here is the code that I am using and the result.
>> >> The problem on the result is that, on the fourth and last page, it
>> >> looks like some parts of the map are not located where they are
>> >> supposed to be (Australia is thus right next to Canada).
>> >>
>> >> My only modification is that I removed the xlim and ylim parameters in
>> >> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
>> >> plot=FALSE)" in the original script. It obviously has a impact on the
>> >> final output but I can`t figure out what is happening.
>> >>
>> >> Thanks for your time.
>> >> Regards.
>> >> Johan
>> >>
>> >> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
>> >> > Hi
>> >> > I am trying to use the solution rpesented here:
>> >> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
>> >> >
>> >> > However it looks like the shifted (from the north pole) map is
>> >> > displayed on top on the original azimuthal equidistant projection
>> >> > centered on the north pole.
>> >> > Is there any way to correct this ?
>> >> >
>> >> > Thanks for your time.
>> >> > Regards.
>> >> > Johan
>
>
> -----
> Ashton Shortridge
> Associate Professor                     ashton at msu.edu
> Dept of Geography                       http://www.msu.edu/~ashton
> 235 Geography Building          ph (517) 432-3561
> Michigan State University               fx (517) 432-1671


From johan.mazel at gmail.com  Wed Nov 14 06:20:58 2012
From: johan.mazel at gmail.com (Johan Mazel)
Date: Wed, 14 Nov 2012 12:20:58 +0700
Subject: [R-sig-Geo] Azimuthal equidistant projection and rgdal
In-Reply-To: <201211131239.06942.ashton@msu.edu>
References: <CAKS5mhRy=uWM_8dS1dPd+jn19UhDSkNe0purC+dzoqqwb1Q3LQ@mail.gmail.com>
	<201211120923.14851.ashton@msu.edu>
	<CAKS5mhS2rjNCSZJAn6h_iXCmCMDs_RPY36_ORyVXEMyZSsj99g@mail.gmail.com>
	<201211131239.06942.ashton@msu.edu>
Message-ID: <CAKS5mhSiswhaj7a-AvtbQQc7Ue4-tZwnPa3NAjMwJqnsmzReMQ@mail.gmail.com>

Hi
I don't think that Synder's book actually use a hemisphere for the
azimuthal equidistant projection examples.
For example, on figures 41.B and 41.C, you can see Australia
(respectively left to top-left and bottom-left).
I think that in both cases, you can see the whole world. This is quite
obvious on figure 41.C.
I think it is a little less obvious for figure 41.B because, on figure
41.C the outside of the map is a point located in south pacific,
while, on figure 41.B, the outside of the map is a point located in
Malaysia (or maybe Indonesia).

But, maybe this is expected behaviour and I misunderstood the
behaviour of rgdal.

Johan

2012/11/14 Ashton Shortridge <ashton at msu.edu>:
> Dear Johan (and list),
>
> you are right in the first case: I think the result is expected. Using global
> data with this sort of projection will look kind of awful - the equatorial
> azimuthal equidistant illustrations in Snyder do not try to map data for the
> whole planet - they employ a hemisphere.
>
> When I clip the results to a hemisphere:
> dta <- map("world",  xlim=c(-180, 0), ylim=c(-90,90), plot=FALSE)
> ...
> dta2 <- spTransform(dta1, CRS("+proj=aeqd +lat_0=0 +lon_0=-0"))
> plot(dta2, axes=TRUE)
>
> the result looks pretty similar to what I see in Snyder's work.
>
> That said... it is strange to me that using your global data the projection
> does NOT wrap around when doing a polar azimuthal projection, but then it does
> when you do not. This may not be on-topic for this stats list - I wonder if
> you could reach out to the GDAL community if you still have questions?
>
> Yours,
>
> Ashton
>
>
>
>
> On 11/13/12, Johan Mazel, wrote:
>> Thanks for your answer.
>>
>> Regarding your last paragraph, I am not really sure to understand.
>> Do you mean that the result is expected in regards to the script (and
>> rgdal use) ?
>> Or do you mean that azimuthal equidistant projection is not
>> possible/valid on any other points than the two poles ? Because, if it
>> is the latter, Synder's book seems to disagree. If you look at figure
>> 41.C, it looks like azimuthal equidistant projection centered on a
>> different point than on of the two pole is possible.
>>
>> Thanks a lot for your time.
>> Johan
>>
>> 2012/11/12 Ashton Shortridge <ashton at msu.edu>:
>> > Dear Johan (and list),
>> >
>> > I'm not a professional cartographer, but I do find myself flipping
>> > through Snyder's book of map projections every once in a while.
>> >
>> > Looking at your results, I don't see anything 'wrong' with the code or
>> > the results. Yes, the map looks awful, but that is what it should look
>> > like. Imagine a glass globe of the Earth with outlines of the land
>> > masses etched on it. Now imagine you have oriented that globe so that
>> > you are looking down at 45N, 90W (somewhere not far from my neck of the
>> > woods). What you see as "Australia right next to Canada" is from looking
>> > 'through the globe', which is why Australia appears to be inverted, and
>> > why South America seems to fold under itself (also Africa).
>> >
>> > Now this projection is not really a glass globe, but I hope the metaphor
>> > makes it a bit clearer. It should also make clearer why people don't
>> > normally use azimuthal projections for global mapping. Coincidentally it
>> > works sorta kinda ok from the north pole, but don't plan on it working
>> > well from other places.
>> >
>> > Hope this is helpful.
>> >
>> > Ashton
>> >
>> >
>> > -----
>> > Ashton Shortridge
>> > Associate Professor                     ashton at msu.edu
>> > Dept of Geography                       http://www.msu.edu/~ashton
>> > 235 Geography Building          ph (517) 432-3561
>> > Michigan State University               fx (517) 432-1671
>> >
>> > On 11/12/12, Johan Mazel, wrote:
>> >> Here is the code that I am using and the result.
>> >> The problem on the result is that, on the fourth and last page, it
>> >> looks like some parts of the map are not located where they are
>> >> supposed to be (Australia is thus right next to Canada).
>> >>
>> >> My only modification is that I removed the xlim and ylim parameters in
>> >> the line "dta <- map("world", xlim=c(-120, -60), ylim=c(0,90),
>> >> plot=FALSE)" in the original script. It obviously has a impact on the
>> >> final output but I can`t figure out what is happening.
>> >>
>> >> Thanks for your time.
>> >> Regards.
>> >> Johan
>> >>
>> >> 2012/10/25 Johan Mazel <johan.mazel at gmail.com>:
>> >> > Hi
>> >> > I am trying to use the solution rpesented here:
>> >> > https://stat.ethz.ch/pipermail/r-sig-geo/2007-December/002939.html.
>> >> >
>> >> > However it looks like the shifted (from the north pole) map is
>> >> > displayed on top on the original azimuthal equidistant projection
>> >> > centered on the north pole.
>> >> > Is there any way to correct this ?
>> >> >
>> >> > Thanks for your time.
>> >> > Regards.
>> >> > Johan
>
>
> -----
> Ashton Shortridge
> Associate Professor                     ashton at msu.edu
> Dept of Geography                       http://www.msu.edu/~ashton
> 235 Geography Building          ph (517) 432-3561
> Michigan State University               fx (517) 432-1671


From raffaele.morelli at gmail.com  Wed Nov 14 09:58:44 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Wed, 14 Nov 2012 09:58:44 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
 274.7 Mb
In-Reply-To: <50A24B5C.7000805@jrc.ec.europa.eu>
References: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
	<50A24B5C.7000805@jrc.ec.europa.eu>
Message-ID: <CAD4guxO+gW8BVJ5iJo7jnkDUxnTE3bsVVPLZzXT9tY04tgB=1g@mail.gmail.com>

2012/11/13 Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu>:
> On 13/11/12 11:20, Raffaele Morelli wrote:
>>
>> Hi,
>> sorry for double posting but I saw my messages were scrubbed from html
>> garbage and don't know if nobody replies for that, but just in case...
>> apologize if not.
>>
>> I am having trouble with this error when calculating a density on a
>> point pattern dataset with 34480 points.
>> My script exit when calculating
>>
>> z<-density(mypattern, 3000, dimyx=3000)
>>
>> The machine the script it's running on it's a debian/amd64 OS with
>> 16Gb RAM, I have set to unlimited the memory limits (the output of
>> ulimit -a follows)
>>
>> Any ideas?
>
>
> Try:
>
> ?memory.limit
> ?gc
>
> and read 'Circle 2' of the R_inferno
> (www.burns-stat.com/pages/Tutor/R_inferno.pdf)
>
> IHTH,
>
> Mauricio

Circle 2 is interesting but it's not my case, I do not costruct object
that way and fetch data from a postgres/postgis database.
Putting in the code lines such as
>cat('point 1 mem', memory.size(), memory.size(max=TRUE), 'nn')
doesn't help because those commands are windows specific and I work on linux.

Here follows a link to my script and RData, lines commented are not
needed because objects are in the RData
http://cen.isprambiente.it/~rmorelli/R/

I've just purged unusued objects from RData.

Regards
-r


From raffaele.morelli at gmail.com  Wed Nov 14 09:59:29 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Wed, 14 Nov 2012 09:59:29 +0100
Subject: [R-sig-Geo] [plain text] Error: cannot allocate vector of size
 274.7 Mb
In-Reply-To: <CAHT1vph9b+aWPFbjDhjRZnq0+1gict+4vbp4++es0R0Pu+ObHg@mail.gmail.com>
References: <CAD4guxPkyjgpVjxJ8YshsoZ3RnpCehDgSz0bqc8VbuSYXbOR0g@mail.gmail.com>
	<CAHT1vph9b+aWPFbjDhjRZnq0+1gict+4vbp4++es0R0Pu+ObHg@mail.gmail.com>
Message-ID: <CAD4guxNaBAXVF5OW_o1qrMDiRB+HR-MaE5mHE4yFUL72UX0+NQ@mail.gmail.com>

2012/11/13 Roman Lu?trik <roman.lustrik at gmail.com>:
> Would it be at all possible if you made your problem reproducible?
>
>
> Cheers,
> Roman

Here follows a link to my script and RData, lines commented are not
needed because objects are in the RData
http://cen.isprambiente.it/~rmorelli/R/

Regards
-r


From andre.vanproosdij at wur.nl  Wed Nov 14 12:37:55 2012
From: andre.vanproosdij at wur.nl (Proosdij, Andre van)
Date: Wed, 14 Nov 2012 11:37:55 +0000
Subject: [R-sig-Geo] asc2dataframe and dataframe2asc problem with ncols
 nrows and cell size
Message-ID: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121114/ba4a2d9e/attachment.pl>

From thomas.wuest.wsl at gmail.com  Wed Nov 14 14:00:10 2012
From: thomas.wuest.wsl at gmail.com (twuest)
Date: Wed, 14 Nov 2012 05:00:10 -0800 (PST)
Subject: [R-sig-Geo] rgdal compile error on RHEL5 [SEC=UNCLASSIFIED]
In-Reply-To: <alpine.LRH.2.02.1209032249470.25010@reclus.nhh.no>
References: <122EC82C51E4074B995E23C4CC960017FEC8DE348A@BOM-VMBX-HO.bom.gov.au>
	<alpine.LRH.2.02.1209032249470.25010@reclus.nhh.no>
Message-ID: <1352898010527-7581713.post@n2.nabble.com>

Hi all,

I am getting exactly the same error when compiling the latest rgdal (0.7-22)
on RHEL5 (CentOS 5.5) using the gdal v1.8.0 RPM from the elgis repository.

Could anybody resolve this problem?

Thanks,
Thomas

Here are some specs:

gdalinfo --version
GDAL 1.8.0, released 2011/01/12


locate libgdal
/usr/lib/ogdi/libgdal.so
/usr/lib64/libgdal.so
/usr/lib64/libgdal.so.1
/usr/lib64/libgdal.so.1.15.0
/usr/lib64/libgdalconstjni.so
/usr/lib64/libgdalconstjni.so.1
/usr/lib64/libgdalconstjni.so.1.15.0
/usr/lib64/libgdaljni.so
/usr/lib64/libgdaljni.so.1
/usr/lib64/libgdaljni.so.1.15.0
/usr/lib64/ogdi/libgdal.so


/sbin/ldconfig -v | grep gdal
	libgdaljni.so.1 -> libgdaljni.so.1.15.0
	libgdalconstjni.so.1 -> libgdalconstjni.so.1.15.0
	libgdal.so.1 -> libgdal.so.1.15.0


nm -D /usr/lib64/libgdal.so.1.15.0 | grep GDALAllRegister
00000037a70cc3c0 T GDALAllRegister


> sessionInfo() 
R version 2.15.2 (2012-10-26)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

-- 
Thomas Wuest
Swiss Federal Research Institute WSL
http://www.wsl.ch




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-compile-error-on-RHEL5-SEC-UNCLASSIFIED-tp7580734p7581713.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Nov 14 14:15:23 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Nov 2012 14:15:23 +0100
Subject: [R-sig-Geo] rgdal compile error on RHEL5 [SEC=UNCLASSIFIED]
In-Reply-To: <1352898010527-7581713.post@n2.nabble.com>
References: <122EC82C51E4074B995E23C4CC960017FEC8DE348A@BOM-VMBX-HO.bom.gov.au>
	<alpine.LRH.2.02.1209032249470.25010@reclus.nhh.no>
	<1352898010527-7581713.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1211141403120.3599@reclus.nhh.no>

On Wed, 14 Nov 2012, twuest wrote:

> Hi all,
>
> I am getting exactly the same error when compiling the latest rgdal (0.7-22)
> on RHEL5 (CentOS 5.5) using the gdal v1.8.0 RPM from the elgis repository.
>
> Could anybody resolve this problem?

You are the only person with access to relevant information. What your 
"same error" is, only you know - no text from any existing thread is 
included in your message.

(from your nabble footer, it was:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-August/015872.html
https://stat.ethz.ch/pipermail/r-sig-geo/2012-September/016020.html

My advice then was as you can read.

For all systems installing rgdal from source, it is recommended that you 
consider not installing binary external dependencies, but installing them 
from source. All of the Linux GIS packages, be it Debian or RPM, have 
had numerous reported problems. So far, all installation problems on such 
systems have turned out to be problems in the external dependencies of 
rgdal, often multiple installs of GDAL (with the library pointed to by 
gdal-config not being the first such in the search path), or similar.

So this is work for you, nobody else. Using binary packages has advantages 
and disadvantages, you've hit a disadvantage, that "dependency hell" has 
said "hello".

Roger

>
> Thanks,
> Thomas
>
> Here are some specs:
>
> gdalinfo --version
> GDAL 1.8.0, released 2011/01/12
>
>
> locate libgdal
> /usr/lib/ogdi/libgdal.so
> /usr/lib64/libgdal.so
> /usr/lib64/libgdal.so.1
> /usr/lib64/libgdal.so.1.15.0
> /usr/lib64/libgdalconstjni.so
> /usr/lib64/libgdalconstjni.so.1
> /usr/lib64/libgdalconstjni.so.1.15.0
> /usr/lib64/libgdaljni.so
> /usr/lib64/libgdaljni.so.1
> /usr/lib64/libgdaljni.so.1.15.0
> /usr/lib64/ogdi/libgdal.so
>
>
> /sbin/ldconfig -v | grep gdal
> 	libgdaljni.so.1 -> libgdaljni.so.1.15.0
> 	libgdalconstjni.so.1 -> libgdalconstjni.so.1.15.0
> 	libgdal.so.1 -> libgdal.so.1.15.0
>
>
> nm -D /usr/lib64/libgdal.so.1.15.0 | grep GDALAllRegister
> 00000037a70cc3c0 T GDALAllRegister
>
>
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From thomas.wuest.wsl at gmail.com  Wed Nov 14 16:43:04 2012
From: thomas.wuest.wsl at gmail.com (twuest)
Date: Wed, 14 Nov 2012 07:43:04 -0800 (PST)
Subject: [R-sig-Geo] rgdal compile error on RHEL5 [SEC=UNCLASSIFIED]
In-Reply-To: <alpine.LRH.2.02.1211141403120.3599@reclus.nhh.no>
References: <122EC82C51E4074B995E23C4CC960017FEC8DE348A@BOM-VMBX-HO.bom.gov.au>
	<alpine.LRH.2.02.1209032249470.25010@reclus.nhh.no>
	<1352898010527-7581713.post@n2.nabble.com>
	<alpine.LRH.2.02.1211141403120.3599@reclus.nhh.no>
Message-ID: <1352907784059-7581715.post@n2.nabble.com>


On Wed, 14 Nov 2012, twuest wrote:

> Hi all,
>
> I am getting exactly the same error when compiling the latest rgdal
> (0.7-22)
> on RHEL5 (CentOS 5.5) using the gdal v1.8.0 RPM from the elgis repository.
>
> Could anybody resolve this problem?

You are the only person with access to relevant information. What your 
"same error" is, only you know - no text from any existing thread is 
included in your message.

Th error refers to the one originally posted by Andrew Harley (see above):
When running "R CMD INSTALL rgdal", the installation fails with

...
configure: error: GDALAllRegister not found in libgdal.


For all systems installing rgdal from source, it is recommended that you 
consider not installing binary external dependencies, but installing them 
from source. All of the Linux GIS packages, be it Debian or RPM, have 
had numerous reported problems. So far, all installation problems on such 
systems have turned out to be problems in the external dependencies of 
rgdal, often multiple installs of GDAL (with the library pointed to by 
gdal-config not being the first such in the search path), or similar.


I previously removed the old gdal RPMs, so there should be no 'gdal'
left-overs.

With elgis' gdal-1.7.3-3_0.el5.elgis.x86_64 and rgdal version 0.6-33, things
worked fine.


So this is work for you, nobody else. Using binary packages has advantages 
and disadvantages, you've hit a disadvantage, that "dependency hell" has 
said "hello".


Well, installing from source may resolve one particular problem but
introduces again new dependencies. Beside providing binaries, package
managers and repositories such as 'elgis' for RHEL (and many others) are
helping a lot to resolve exactly this "dependency hell".

Thus, I guess this issue might interest others too.

Thomas

-- 
Thomas Wuest
Swiss Federal Research Institute WSL
http://www.wsl.ch




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-compile-error-on-RHEL5-SEC-UNCLASSIFIED-tp7580734p7581715.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Nov 14 18:42:34 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Nov 2012 18:42:34 +0100
Subject: [R-sig-Geo] rgdal compile error on RHEL5 [SEC=UNCLASSIFIED]
In-Reply-To: <1352907784059-7581715.post@n2.nabble.com>
References: <122EC82C51E4074B995E23C4CC960017FEC8DE348A@BOM-VMBX-HO.bom.gov.au>
	<alpine.LRH.2.02.1209032249470.25010@reclus.nhh.no>
	<1352898010527-7581713.post@n2.nabble.com>
	<alpine.LRH.2.02.1211141403120.3599@reclus.nhh.no>
	<1352907784059-7581715.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1211141819300.3599@reclus.nhh.no>

On Wed, 14 Nov 2012, twuest wrote:

>
> On Wed, 14 Nov 2012, twuest wrote:
>
>> Hi all,
>>
>> I am getting exactly the same error when compiling the latest rgdal
>> (0.7-22)
>> on RHEL5 (CentOS 5.5) using the gdal v1.8.0 RPM from the elgis repository.
>>
>> Could anybody resolve this problem?
>
> You are the only person with access to relevant information. What your
> "same error" is, only you know - no text from any existing thread is
> included in your message.
>
> Th error refers to the one originally posted by Andrew Harley (see above):
> When running "R CMD INSTALL rgdal", the installation fails with
>
> ...
> configure: error: GDALAllRegister not found in libgdal.
>

Did you follow my suggestion to the original poster, which was to download 
and unpack the rgdal source package to a local temporary directory, and 
run:

R CMD INSTALL rgdal

and then examine the output to config.*? The problem you are experiencing 
is your problem, so if you need to resolve it, you should commit to doing 
so. Nobody else has your exact combination of system configuration and 
installed binary packages (Linux GIS binary packages are typically used by 
very few systems in the same combination, and are often very out of date).

You have once again edited out important content from my reply. Please do 
not do that - my messages are copyright to me and may not be cut at your 
pleasure. This list is not an adjunct to Nabble - please do not treat it 
as such.

I am still pretty certain that the installation error you are seeing is 
caused by gdal-config not pointing to the directory in shich the *.so file 
is to be found, so an installation muddle on your system. In addition, 
/sbin/ldconfig may not have been run after installing GDAL.

Please do:

R CMD INSTALL rgdal, and examining the contents of the rgdal
directory, specifically the config.log, config.status and errors.txt
files. The final file should record the compiler and linker error
messages.

as I wrote before. I believe that I recollect a message from the original 
poster reporting success after cleaning up muddle, but cannot find it on 
my system now. It certainly wasn't on thread or list, so Nabble has no 
record of the resolution. The configure file in rgdal is intended to trap 
systems that are not configured correctly, and so rgdal is working exactly 
to design here.

Roger


>
> For all systems installing rgdal from source, it is recommended that you
> consider not installing binary external dependencies, but installing them
> from source. All of the Linux GIS packages, be it Debian or RPM, have
> had numerous reported problems. So far, all installation problems on such
> systems have turned out to be problems in the external dependencies of
> rgdal, often multiple installs of GDAL (with the library pointed to by
> gdal-config not being the first such in the search path), or similar.
>
>
> I previously removed the old gdal RPMs, so there should be no 'gdal'
> left-overs.
>
> With elgis' gdal-1.7.3-3_0.el5.elgis.x86_64 and rgdal version 0.6-33, things
> worked fine.
>
>
> So this is work for you, nobody else. Using binary packages has advantages
> and disadvantages, you've hit a disadvantage, that "dependency hell" has
> said "hello".
>
>
> Well, installing from source may resolve one particular problem but
> introduces again new dependencies. Beside providing binaries, package
> managers and repositories such as 'elgis' for RHEL (and many others) are
> helping a lot to resolve exactly this "dependency hell".
>
> Thus, I guess this issue might interest others too.
>
> Thomas
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Wed Nov 14 19:12:57 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Nov 2012 10:12:57 -0800
Subject: [R-sig-Geo] asc2dataframe and dataframe2asc problem with ncols
 nrows and cell size
In-Reply-To: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>
References: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>
Message-ID: <CANtt_hw9OO3e2rG-CAPgF2TxOvEPwyR4EogQu28tyJUJ2pQFQw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121114/de806193/attachment.pl>

From pitiur at gmail.com  Wed Nov 14 19:45:15 2012
From: pitiur at gmail.com (peleve)
Date: Wed, 14 Nov 2012 10:45:15 -0800 (PST)
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on a
	grid.
Message-ID: <1352918715953-7581718.post@n2.nabble.com>

I have a result from Akima or Loesss interpolation using irregular data
defined inside a polygon. I only want the results inside the polygon.
Akima interpolates correctly inside the polygon but leaves a blue residue
outside the polygon (a result of Akima using a convex hull) that I want to
get rid of, and so far, have not been able to do so.  I only want the
information inside the polygon.
I've searched and searched, and read and read, but can't find a way to do
it.
A similar result with Loess, but it uses the whole grid.
Below the code of a highly simplified geometry that demonstrates the issue.
The first figure is what Akima produces. The second figure produced uses a
raster package approach using Akima's output but the data are flipped around
the y-axis.  It nearly seems to do the job, but there still is the outline
and contents of the convex hull that Akima does it's interpolation on.
How do I fix this, please?

library(raster)		# For raster
library(tgp)			# For interp.loess
library(fields)		# For image.plot
library(akima)		# For akima
library(sp)			# For spatial representation


#================================================================
# Definition of the polygon

x <- c(47, 44, 33, 20,19,30,16,4,16,34,45,52,60,60, 47)
y <- c(0,13,20,20,24,30,37,42,45,40,28,20,25,0, 0)
zero <- seq(0, 0, length=length(x))


# #
# # Definition of irregularly spaced -z- values
# # The points of the polygon have been add to force a zero constraint
# #
xx <- c(48,44,33,25,22,30,16,12,16,34,46,52,58,58,32,52,x)
yy <- c(1,14,22,22,22,28,38,42,43,36,21,18,20,4,30,12,y)
zz <- c(5, 6, 6, 4, 7, 5, 4, 3, 5, 6 ,8, 9, 6, 3, 5, 9, zero)


#================================================================
# Definition of the bounding box and related variables

xmin <- 0
xmax <- 60
ymin <- 0
ymax <- 50
dxy <- 0.2
nx <- (xmax-xmin)/dxy
ny <- (ymax-ymin)/dxy
xbox <- c(xmin, xmax, xmax, xmin)
ybox <- c(ymin, ymin, ymax, ymax)



#================================================================
# Akima interpolation/smoothing

x0 <- seq(xmin, xmax, length = nx)
y0 <- seq(ymin, ymax, length = ny)
akima <- interp(xx, yy, zz, xo=x0, yo=y0, duplicate="strip")
image.plot(akima)
polygon(x, y, lwd=2)
points(xx,yy)
contour(akima$x, akima$y, akima$z, add=TRUE, labcex=1.2)
lines(x,y, col="purple", lwd=5)
title("Akima and image.plot and contour")


#================================================================
# Data in spatial representation

xpoly <- c(x, x[1])
ypoly <- c(y, y[1])
xy <- cbind(xpoly, ypoly)
xypoly <- Polygon(xy, hole=TRUE)
sss1 <- Polygons(list(xypoly), "s1")

xxpoly <- c(xbox, xbox[1])
yypoly <- c(ybox, ybox[1])
# Define the map area polygon
maparea <- cbind(xxpoly, yypoly)
mappoly <- Polygon(maparea)
sss2 <- Polygons(list(mappoly), "s2")

SpP = SpatialPolygons(list(sss2,sss1), 1:2)

pol <- cbind(xpoly, ypoly)
addpoly <- SpatialPolygons(list(Polygons(list(Polygon(pol)), 1)))
addpoly <- as(addpoly, "SpatialPolygonsDataFrame")
addpoly at data[1,1] <- 10
r <- raster(akima$z, xmn=min(akima$x), xmx=max(akima$x), ymn=min(akima$y),
ymx=max(akima$y))
r2 <- rasterize(addpoly, r, field=1, update=TRUE, updateValue="NA")
#image(r2, main="")
plot(r2, main=" ")
contour(akima$x, akima$y, akima$z, add=TRUE, labcex=1.2)
lines(x,y, col="purple", lwd=5)
title("SpatialPolygonsDataFrame, Akima, plot and contour")






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Clearing-the-area-outside-of-a-polygon-defined-on-a-grid-tp7581718.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Nov 14 22:03:52 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Nov 2012 13:03:52 -0800
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on a
	grid.
In-Reply-To: <1352918715953-7581718.post@n2.nabble.com>
References: <1352918715953-7581718.post@n2.nabble.com>
Message-ID: <CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121114/8720315e/attachment.pl>

From andre.vanproosdij at wur.nl  Thu Nov 15 11:22:34 2012
From: andre.vanproosdij at wur.nl (Proosdij, Andre van)
Date: Thu, 15 Nov 2012 10:22:34 +0000
Subject: [R-sig-Geo] asc2dataframe and dataframe2asc problem with ncols
 nrows and cell size
In-Reply-To: <CANtt_hw9OO3e2rG-CAPgF2TxOvEPwyR4EogQu28tyJUJ2pQFQw@mail.gmail.com>
References: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>
	<CANtt_hw9OO3e2rG-CAPgF2TxOvEPwyR4EogQu28tyJUJ2pQFQw@mail.gmail.com>
Message-ID: <84D737939C16114590DCDD4F003E013B1FD31061@SCOMP0936.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121115/22db8bdd/attachment.pl>

From pitiur at gmail.com  Thu Nov 15 15:19:03 2012
From: pitiur at gmail.com (peleve)
Date: Thu, 15 Nov 2012 06:19:03 -0800 (PST)
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on a
	grid.
In-Reply-To: <CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>
References: <1352918715953-7581718.post@n2.nabble.com>
	<CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>
Message-ID: <1352989143906-7581721.post@n2.nabble.com>

Thank you very much.  That worked, mostly!?!  But I see the methodology now.
I had been thinking about masks, but I was asking the wrong question I now
realize.
In my real application, using your approach, I still have some unwanted bits
left outside of the polygon.  I traced it as a left over piece from
contouring the data... contours are vector objects. Your suggestion works
for the raster object,  and worked for the Akima result (outside the polygon
and inside the convex polygon that Akima works in).
I now realize that what I need is a hole in a polygon, outside colored
white, inside transparent, or a polygon with everything outside white and
inside transparent. The hole is the outline of the area with the contours
within the bounding box.
Any thoughts on how to do that?
Thank you again.


I think you can do:

x <- raster(akima)
y <- mask( x, SpP[2] )
plot(y)






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Clearing-the-area-outside-of-a-polygon-defined-on-a-grid-tp7581718p7581721.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Nov 15 18:39:55 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 15 Nov 2012 09:39:55 -0800
Subject: [R-sig-Geo] asc2dataframe and dataframe2asc problem with ncols
 nrows and cell size
In-Reply-To: <84D737939C16114590DCDD4F003E013B1FD31061@SCOMP0936.wurnet.nl>
References: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>
	<CANtt_hw9OO3e2rG-CAPgF2TxOvEPwyR4EogQu28tyJUJ2pQFQw@mail.gmail.com>
	<84D737939C16114590DCDD4F003E013B1FD31061@SCOMP0936.wurnet.nl>
Message-ID: <CANtt_hw-p8odZ7wXD2o3Venju-KcHZWJymYyrq4d+o+rib32sA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121115/d389f7ed/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 15 18:43:18 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 15 Nov 2012 09:43:18 -0800
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on a
	grid.
In-Reply-To: <1352989143906-7581721.post@n2.nabble.com>
References: <1352918715953-7581718.post@n2.nabble.com>
	<CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>
	<1352989143906-7581721.post@n2.nabble.com>
Message-ID: <CANtt_hyMjVVjYaTXwVL2GY8MML4T1nmh1cSBV0ZSF_tuYREG4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121115/ecd1d20b/attachment.pl>

From AikensE at si.edu  Thu Nov 15 19:55:09 2012
From: AikensE at si.edu (Aikens, Ellen)
Date: Thu, 15 Nov 2012 13:55:09 -0500
Subject: [R-sig-Geo] Creating spatial lines in a loop
Message-ID: <797ADF1D9300604586610F3FE24593BC0F7F9A5FF4@SI-MSEV04.US.SINET.SI.EDU>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121115/585a6581/attachment.pl>

From aortizbobea at arec.umd.edu  Thu Nov 15 20:48:03 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Thu, 15 Nov 2012 11:48:03 -0800 (PST)
Subject: [R-sig-Geo] spml and logLik, help!
In-Reply-To: <1352013611310-7581581.post@n2.nabble.com>
References: <1352013611310-7581581.post@n2.nabble.com>
Message-ID: <1353008883711-7581725.post@n2.nabble.com>

After some digging, I realized the problem is that the log-likelihood is
simply not exported by one of the internal functions (splm:::sperrorlm).

To fix this simply modify that function. After loading splm type:

fixInNamespace("sperrorlm", "splm")

And manually add "ll=LL" as an element to the "return" list at the end of
the function so that it reads:

return <- list(coeff = betas, lambda = lambda, s2 = s2, rest.se = rest.se, 
        lambda.se = lambda.se, asyvar1 = asyvar1, ll=LL)

This LL (i.e. LogLik) object was missing. 

A less elegant solution is to capture the text after running the function
when the option quiet=F.

Hope this saves some time to others.

Cheers.

Ariel



-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spml-and-logLik-help-tp7581581p7581725.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Thu Nov 15 21:17:47 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 16 Nov 2012 07:17:47 +1100
Subject: [R-sig-Geo] Creating spatial lines in a loop
In-Reply-To: <797ADF1D9300604586610F3FE24593BC0F7F9A5FF4@SI-MSEV04.US.SINET.SI.EDU>
References: <797ADF1D9300604586610F3FE24593BC0F7F9A5FF4@SI-MSEV04.US.SINET.SI.EDU>
Message-ID: <CAAcGz98caA+StLZagNPqQ3eaaBnAHeOpLpDGtVeFe1FU0VUePQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/0ad40697/attachment.pl>

From pitiur at gmail.com  Thu Nov 15 23:09:10 2012
From: pitiur at gmail.com (peleve)
Date: Thu, 15 Nov 2012 14:09:10 -0800 (PST)
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on a
	grid.
In-Reply-To: <CANtt_hyMjVVjYaTXwVL2GY8MML4T1nmh1cSBV0ZSF_tuYREG4w@mail.gmail.com>
References: <1352918715953-7581718.post@n2.nabble.com>
	<CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>
	<1352989143906-7581721.post@n2.nabble.com>
	<CANtt_hyMjVVjYaTXwVL2GY8MML4T1nmh1cSBV0ZSF_tuYREG4w@mail.gmail.com>
Message-ID: <1353017350774-7581727.post@n2.nabble.com>

Thanks Robert,
I was able to do it with the following using the 'gpclib" package:

p2 <- as(xy, "gpc.poly")
p1 <- as(maparea, "gpc.poly")
plot(setdiff(p1, p2), poly.args = list(col = 3), add = TRUE)

Did exactly what I was looking for.  Pretty simple, actually.

Thanks for inspiring me.

Pete




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Clearing-the-area-outside-of-a-polygon-defined-on-a-grid-tp7581718p7581727.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Fri Nov 16 08:00:40 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Nov 2012 08:00:40 +0100
Subject: [R-sig-Geo] Clearing the area outside of a polygon defined on
 a	grid.
In-Reply-To: <1353017350774-7581727.post@n2.nabble.com>
References: <1352918715953-7581718.post@n2.nabble.com>
	<CANtt_hz-okrxPwSeXBJr_kSZxpE_zRsjUyU4b+Zjc9gOvGjV4g@mail.gmail.com>
	<1352989143906-7581721.post@n2.nabble.com>
	<CANtt_hyMjVVjYaTXwVL2GY8MML4T1nmh1cSBV0ZSF_tuYREG4w@mail.gmail.com>
	<1353017350774-7581727.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1211160756100.16682@reclus.nhh.no>

On Thu, 15 Nov 2012, peleve wrote:

> Thanks Robert,
> I was able to do it with the following using the 'gpclib" package:

For completeness, please use rgeos rather than gpclib, which we are 
advising against strongly, because of the unclear and very restrictive 
licence of its included C code. rgeos contains gpclib classes and methods 
using GEOS rather than GPC under the hood, and should give identical 
results. It would be very helpful if you could confirm that the same code 
run in rgeos gives the same results. Once you get to rgeos, you may then 
find that there are efficiency gains in using rgeos wrappers to GEOS 
functions directly.

Roger

>
> p2 <- as(xy, "gpc.poly")
> p1 <- as(maparea, "gpc.poly")
> plot(setdiff(p1, p2), poly.args = list(col = 3), add = TRUE)
>
> Did exactly what I was looking for.  Pretty simple, actually.
>
> Thanks for inspiring me.
>
> Pete
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Clearing-the-area-outside-of-a-polygon-defined-on-a-grid-tp7581718p7581727.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Tord.Snall at slu.se  Fri Nov 16 12:37:47 2012
From: Tord.Snall at slu.se (=?iso-8859-1?Q?Tord_Sn=E4ll?=)
Date: Fri, 16 Nov 2012 11:37:47 +0000
Subject: [R-sig-Geo] order large pixel layer
Message-ID: <8F520F4A3134294A9668CC04645A2EFB020DC6C9@exchange2-2>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/1430f3ac/attachment.pl>

From potts.a at gmail.com  Fri Nov 16 14:35:54 2012
From: potts.a at gmail.com (Alastair Potts)
Date: Fri, 16 Nov 2012 15:35:54 +0200
Subject: [R-sig-Geo] Speeding up raster stack to values conversion
Message-ID: <CAG_8N1bEo9iEvE0M8OeO+B9DWyj+NptjxfqC+BA3eeN9oPBm-w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/418f3c86/attachment.pl>

From etiennebr at gmail.com  Fri Nov 16 16:50:30 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 16 Nov 2012 10:50:30 -0500
Subject: [R-sig-Geo] order large pixel layer
In-Reply-To: <8F520F4A3134294A9668CC04645A2EFB020DC6C9@exchange2-2>
References: <8F520F4A3134294A9668CC04645A2EFB020DC6C9@exchange2-2>
Message-ID: <CALjAYt5VQJRzkbGe=91kO_gCV6p=0rYiuhb2wTmNFdquNmkp2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/2b6adcb5/attachment.pl>

From Tord.Snall at slu.se  Fri Nov 16 17:15:38 2012
From: Tord.Snall at slu.se (=?iso-8859-1?Q?Tord_Sn=E4ll?=)
Date: Fri, 16 Nov 2012 16:15:38 +0000
Subject: [R-sig-Geo] order large pixel layer
In-Reply-To: <CALjAYt5VQJRzkbGe=91kO_gCV6p=0rYiuhb2wTmNFdquNmkp2A@mail.gmail.com>
References: <8F520F4A3134294A9668CC04645A2EFB020DC6C9@exchange2-2>
	<CALjAYt5VQJRzkbGe=91kO_gCV6p=0rYiuhb2wTmNFdquNmkp2A@mail.gmail.com>
Message-ID: <8F520F4A3134294A9668CC04645A2EFB020DCDF8@exchange2-2>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/a956be0d/attachment.pl>

From mello at ieee.org  Fri Nov 16 17:29:36 2012
From: mello at ieee.org (Marcio Pupin Mello)
Date: Fri, 16 Nov 2012 17:29:36 +0100
Subject: [R-sig-Geo] spacetime: Spatio-Temporal Data in R
Message-ID: <k85ple$djr$1@ger.gmane.org>

Just testing whether my subscription is working and decided to share a 
useful link
http://www.jstatsoft.org/v51/i07/
Enjoy it!

Marcio
www.dsr.inpe.br/~mello


From etiennebr at gmail.com  Fri Nov 16 18:14:06 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 16 Nov 2012 12:14:06 -0500
Subject: [R-sig-Geo] order large pixel layer
In-Reply-To: <8F520F4A3134294A9668CC04645A2EFB020DCDF8@exchange2-2>
References: <8F520F4A3134294A9668CC04645A2EFB020DC6C9@exchange2-2>
	<CALjAYt5VQJRzkbGe=91kO_gCV6p=0rYiuhb2wTmNFdquNmkp2A@mail.gmail.com>
	<8F520F4A3134294A9668CC04645A2EFB020DCDF8@exchange2-2>
Message-ID: <CALjAYt5oahFxa-=JW-_GyWULd09noxjeR1bZfLgR9261zzAVwA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/ea8010b5/attachment.pl>

From bohara at unm.edu  Fri Nov 16 20:48:08 2012
From: bohara at unm.edu (Alok K. Bohara)
Date: Fri, 16 Nov 2012 19:48:08 +0000
Subject: [R-sig-Geo] spacetime: Spatio-Temporal Data in R
In-Reply-To: <k85ple$djr$1@ger.gmane.org>
References: <k85ple$djr$1@ger.gmane.org>
Message-ID: <26DA675B6786904E912DCE264169317101CD2ADF@CH1PRD0711MB406.namprd07.prod.outlook.com>

I have been informed that this Spacetime package is best suited for basic infrastructure for handling data, and not for estimating space-time spatial panel data.  I would be keeping my eyes open for its application in conjunction with other estimation packages such as splm.    There seems to be several packages to do panel estimation --space and time (but without spatial correlation).   I am interested in packages (one or more for my students that are easy to use) that can estimate spatio-temporal model (e.g., poisson panel with spatial correlation).   I have encountered Inla package as a potential solution.   I am also looking for others..

Thanks.   

Best,
Alok K. Bohara
Professor


________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Marcio Pupin Mello [mello at ieee.org]
Sent: Friday, November 16, 2012 9:29 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] spacetime: Spatio-Temporal Data in R

Just testing whether my subscription is working and decided to share a
useful link
http://www.jstatsoft.org/v51/i07/
Enjoy it!

Marcio
www.dsr.inpe.br/~mello

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From cam.plouffe at gmail.com  Sat Nov 17 04:18:06 2012
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Fri, 16 Nov 2012 22:18:06 -0500
Subject: [R-sig-Geo] (no subject)
Message-ID: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>

  http://www.allentxmovers.com/wp-content/plugins/akismet/google235.html


From cam.plouffe at gmail.com  Sat Nov 17 05:07:36 2012
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Fri, 16 Nov 2012 23:07:36 -0500
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
References: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
Message-ID: <CAAN3GgARP5scV+P_EMUktwB9gnaj0OCfxv6s+_BPFnF3Zzd5Lw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121116/3d91f462/attachment.pl>

From Roger.Bivand at nhh.no  Sat Nov 17 10:36:20 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Nov 2012 10:36:20 +0100
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CAAN3GgARP5scV+P_EMUktwB9gnaj0OCfxv6s+_BPFnF3Zzd5Lw@mail.gmail.com>
References: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
	<CAAN3GgARP5scV+P_EMUktwB9gnaj0OCfxv6s+_BPFnF3Zzd5Lw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1211171029320.22595@reclus.nhh.no>

All the R lists have become subject to attack by bots automatically 
subscribing (all so far from gmail addresses) and we have not been able to 
match the escalation in this weapons race. We may be obliged to treat all 
non-institutional addresses as suspect (such as gmail, which has been the 
prefered mode for these attackers. We cannot moderate the list, so we may 
need to restrict address sending ranges. I have administratively 
unsubscribed all senders of spam, including you. If you wish to 
re-subscribe (and we don't know that you are not a bot), please do so from 
an institutional address. We may also have to introduce other methods for 
checking the reality of subscribers, which we haven't used until now.

Regretfully,

List admin.


On Sat, 17 Nov 2012, Cam Plouffe wrote:

> Hello,
>
> I'm sorry if you've received any spam mail or links from this email in the
> last few hours.  Please do not open it.  My email address was hacked, and
> I'm currently in the process of recovering it.
>
> Once again, sorry for the inconvenience.
> Cam
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From laurawette at gmail.com  Mon Nov 19 15:05:43 2012
From: laurawette at gmail.com (Laura Wette)
Date: Mon, 19 Nov 2012 15:05:43 +0100
Subject: [R-sig-Geo] problem with calculation of anisotropic variogram
Message-ID: <CADfOX6zQhhPcd3zGa2iaAB241sm5vtRqw-4gZNsbAR4EMOBMmw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121119/126fd62f/attachment.pl>

From magezijulian at yahoo.co.uk  Mon Nov 19 15:24:56 2012
From: magezijulian at yahoo.co.uk (julian magezi)
Date: Mon, 19 Nov 2012 14:24:56 +0000 (GMT)
Subject: [R-sig-Geo] Mailing list
Message-ID: <1353335096.13816.YahooMailClassic@web133005.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121119/67f769e4/attachment.pl>

From alobolistas at gmail.com  Mon Nov 19 17:43:35 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 19 Nov 2012 17:43:35 +0100
Subject: [R-sig-Geo] raster CRS changes on tis own
In-Reply-To: <alpine.LRH.2.02.1211132021430.20069@reclus.nhh.no>
References: <CAG4NReJnhpcf2dV4352-YV4qAyt1XWxQzjkthg1SGy7oq_CEHQ@mail.gmail.com>
	<CAG4NReLKTRCOkCi2Yvf64=fy6fyr4bSik5afJ3eHc15Hua8KSA@mail.gmail.com>
	<alpine.LRH.2.02.1211131059250.18597@reclus.nhh.no>
	<CAG4NReKUK7prAhPXqAivgpLpgUbi7mXjbY4yzeT-fL3BHMW8OA@mail.gmail.com>
	<alpine.LRH.2.02.1211131212410.18597@reclus.nhh.no>
	<CAG4NReJRgVoC+JGAoz=VB16jn1+atj8xWWbT1068U3BGptCMzQ@mail.gmail.com>
	<alpine.LRH.2.02.1211132021430.20069@reclus.nhh.no>
Message-ID: <CAG4NRe+EM6_tj8PeN_yQ-QYtuMKJ82PKec4=Zvmbk9RRENuyKw@mail.gmail.com>

Your intuition was right. The problem is not present any more with:

> require(rgdal)
Loading required package: rgdal
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: /usr/share/gdal/1.9
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

Changes:
1. GDALinfo(paste(mosdir,"mosaico_envi.dat",sep="/"))
states that the CRS is
+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs
and not any more
+proj=utm +zone=30 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs

2. subset() does not change the projection on its own any more:
> vinedomosaicMCA03v2 <- subset(vinedomosaicMCA03,c(3,1,2,4,5,6))
> projection(vinedomosaicMCA03v2)
[1] "+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs"


I can accept reproducing the R console was not the most readable option,
but linking to the original file was correct: Precisly, one problem
was that R was changing the CRS,
so I could not make an smaller version and gave access to the
original (and external) file, which had a correct hdr as I had
previoulsy checked.


On Tue, Nov 13, 2012 at 8:45 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Tue, 13 Nov 2012, Agustin Lobo wrote:
>
>> Roger,
>> I'm not dumping anything on anybody: those are links that you download if
>> you want to, and that I posted only after you requested an example. Also,
>> could you post your session info? According to what you say and what I
>> reproduce we get different results for the same file and objects.
>
>
> That is precisely why I asked you to provide another example of the problem.
> If the problem cannot be reproduced with other data on your system, then it
> is limited to your initial data set, or the specific code used when the
> unexpected behaviour occurred. If you can reproduce it for similar data
> sets, then it is your system. I did note that you are running rgdal 0.7-5,
> mine is 0.7-22 (the current CRAN version). In my case the crucial startup
> messages are:
>
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files: /usr/local/share/gdal
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>
> but yours are unknown. I install GDAL and PROJ.4 from source; like you, I am
> on:
>
> Platform: x86_64-unknown-linux-gnu (64-bit)
> (you are: x86_64-pc-linux-gnu (64-bit))
>
> My intuition is that the problem is a stale GDAL on your system, but from
> reading the GDAL tickets and NEWS logs, I can't see an update to the ENVI
> driver that might explain where the odd extra tags are coming from, so it
> might be something else, assuming it is your system and not an idiosyncracy
> of your handling that data set.
>
> Roger
>
>
Agus


From jgrn at illinois.edu  Mon Nov 19 20:20:02 2012
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 19 Nov 2012 13:20:02 -0600
Subject: [R-sig-Geo] Phd and Master's Graduate Research in Remote Sensing
	and Landscape Ecology
Message-ID: <CABG0rft_LUgKmx-snP7g1F-XJ0d9qudr=6_epcyMtieTaLaRnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121119/1cccd5ef/attachment.pl>

From ehartel at hboi.fau.edu  Mon Nov 19 23:27:15 2012
From: ehartel at hboi.fau.edu (Elizabeth Hartel)
Date: Mon, 19 Nov 2012 22:27:15 +0000
Subject: [R-sig-Geo] using adehabitatHR with a complex coastal boundary
Message-ID: <BBD564D58D06F547B498D91E01DE035B2A4EC989@EXCHANGEMB02.ad.fau.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121119/06d3f22b/attachment.pl>

From Tom_Roche at pobox.com  Tue Nov 20 22:46:14 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Tue, 20 Nov 2012 16:46:14 -0500
Subject: [R-sig-Geo] how to overlay maps on lattice panels?
Message-ID: <87mwyc0wyh.fsf@pobox.com>


summary: How to overlay a geographical map on each panel in a lattice?
(Note I am not seeking to create a choropleth map.)

details:

I have atmospheric data specifying gas concentrations over a 3D space
with dimensions longitude, latitude, and (vertical) level. Since the
data is numeric, and I need to plot it by level, lattice::levelplot
seems to be the "tool for the job." However I also need to spatially
manipulate the data, and therefore to display data before-and-after, and
the best way to do that seems to be to overlay the data with a map.
(Am I missing something?)

>From the excellent open-access book on package=lattice

ISBN 978-0-387-75968-5
e-ISBN 978-0-387-75969-2
http://dx.doi.org/10.1007/978-0-387-75969-2

I know how to plot a choropleth map with latticeExtra::mapplot, but
that's not what I want, which is just to overlay a lattice (or Trellis)
of levelplot's with the lines of a geographical map. How to do that?

A relatively small, quite self-contained example follows, in which I
plot toy data in the sort of lattice layout I need. The toy data covers
a horizontal space over North America; each panel has bounds=

longitudes: -130? to -59.5?
latitudes:  23.5? to 58.5?

corresponding to this geography

https://github.com/TomRoche/cornbeltN2O/wiki/images/Cmaq_aqmeii_domain.png

So how to (programmatically) overlay something like that image over each
panel in the lattice generated below? Your assistance is appreciated!

# start example
library(lattice)

# Not too many points, for this example
# -130? to -59.5: (130-59.5)/1.5=47
# 23.5? to 58.5?: 58.5-23.5     =35

# define longitudes
west.lon.deg=-130
#east.lon.deg=-115    # debugging
east.lon.deg=-59.5
step.lon.deg=1.5
lons  <- c(seq(west.lon.deg, east.lon.deg, step.lon.deg))
n.lon <- length(lons)

# define latitudes
south.lat.deg=23.5
#north.lat.deg=30.5    # debugging
north.lat.deg=58.5
step.lat.deg=1.0
lats  <- c(seq(south.lat.deg, north.lat.deg, step.lat.deg))
n.lat <- length(lats)

# define vertical levels
bot.lev.mb=1000
top.lev.mb=50
n.lev=4
levs <- c(seq(from=bot.lev.mb, to=top.lev.mb, length.out=n.lev))

# define concentrations
grid.3d.len <- n.lon * n.lat * n.lev
concs <- c(1:grid.3d.len)

# define grid
grid.3d.df <- expand.grid(longitude=lons, latitude=lats, level=levs)
# add concentrations as data
data.3d.df <- cbind(grid.3d.df, concentration=concs)
# debugging
head(data.3d.df)
tail(data.3d.df)

sigdigs=3 # significant digits
# plot "appropriately" for atmospheric data: use
# * lattice::levelplot
# * one column, since atmospheric levels stack vertically
levelplot(
  concentration ~ longitude * latitude | level, 
  data=data.3d.df, layout=c(1,n.lev),
  levs=as.character(round(data.3d.df[['level']], 1)),
  strip=FALSE,
  strip.left=strip.custom(
    factor.levels= # thanks, David Winsemius
      as.character(signif(unique(data.3d.df[['level']]), sigdigs)),
    strip.levels=TRUE,
    horizontal=TRUE,
    strip.names=FALSE,
    # gotta shrink strip text size to fit strip width:
    # more on that separately
    par.strip.text=list(cex=0.5)
  )
)
# end example

TIA, Tom Roche <Tom_Roche at pobox.com>


From rjadenham at gmail.com  Wed Nov 21 05:25:42 2012
From: rjadenham at gmail.com (robert denham)
Date: Wed, 21 Nov 2012 14:25:42 +1000
Subject: [R-sig-Geo] how to overlay maps on lattice panels?
In-Reply-To: <87mwyc0wyh.fsf@pobox.com>
References: <87mwyc0wyh.fsf@pobox.com>
Message-ID: <CAHMvJdTo9SF6P_SJG6rr6rhDJBB+skUtzDPPTg4Ztd19og61Bw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121121/b5bed723/attachment.pl>

From ligg at austin.utexas.edu  Wed Nov 21 06:10:15 2012
From: ligg at austin.utexas.edu (Laura I Gonzalez)
Date: Tue, 20 Nov 2012 23:10:15 -0600
Subject: [R-sig-Geo] Correlogram question
Message-ID: <50AC6237.9070700@austin.utexas.edu>

Hi,

I am trying to compute a spatial correlogram for a single variable using 
great-circle distances.  Does anybody know of a function in R that can 
complete this analysis?

Thanks a lot for any information you might have,

Laura

-- 
************************************************************
Laura I. Gonzalez-Guzman
University of Texas at Austin
Integrative Biology
1 University Station A6700
Austin, TX 78712-0253
Phone: (512) 471-5368
Fax: (512) 232-9529


From kat.m.jensen at gmail.com  Wed Nov 21 07:15:06 2012
From: kat.m.jensen at gmail.com (kmj2133)
Date: Tue, 20 Nov 2012 22:15:06 -0800 (PST)
Subject: [R-sig-Geo] Error in Modis mosaic tool
In-Reply-To: <AANLkTik3cqs6grUw8x0BK4PNN=knkbeOyY0ktN9iwTK1@mail.gmail.com>
References: <AANLkTik3cqs6grUw8x0BK4PNN=knkbeOyY0ktN9iwTK1@mail.gmail.com>
Message-ID: <1353478506225-7581749.post@n2.nabble.com>

Hi there!

I know this is an old post... but I am having the same problem.  For some
reason, the environment variable MRTDATADIR is not being set right - but I
looked in my .bash_profile (I'm on a mac) .. and it looks ok.  Wondering if
you had any luck solving this... Any help would be greatly appreciated!!

Best,
Kat



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-Modis-mosaic-tool-tp5810425p7581749.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From forrest at ufl.edu  Wed Nov 21 08:39:42 2012
From: forrest at ufl.edu (Forrest Stevens)
Date: Wed, 21 Nov 2012 02:39:42 -0500
Subject: [R-sig-Geo] Error in Modis mosaic tool
In-Reply-To: <1353478506225-7581749.post@n2.nabble.com>
References: <AANLkTik3cqs6grUw8x0BK4PNN=knkbeOyY0ktN9iwTK1@mail.gmail.com>
	<1353478506225-7581749.post@n2.nabble.com>
Message-ID: <CAEBQMMnp0TO2dnWnFjxYzvP+65kT+r495U1to6-jCfi_FfoNRw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121121/c784b850/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Nov 21 09:09:58 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Nov 2012 09:09:58 +0100
Subject: [R-sig-Geo] how to overlay maps on lattice panels?
In-Reply-To: <87mwyc0wyh.fsf@pobox.com>
References: <87mwyc0wyh.fsf@pobox.com>
Message-ID: <50AC8C56.4000505@uni-muenster.de>

http://r-spatial.sourceforge.net/gallery/

shows a few options how this can be done with sp::spplot

On 11/20/2012 10:46 PM, Tom Roche wrote:
> 
> summary: How to overlay a geographical map on each panel in a lattice?
> (Note I am not seeking to create a choropleth map.)
> 
> details:
> 
> I have atmospheric data specifying gas concentrations over a 3D space
> with dimensions longitude, latitude, and (vertical) level. Since the
> data is numeric, and I need to plot it by level, lattice::levelplot
> seems to be the "tool for the job." However I also need to spatially
> manipulate the data, and therefore to display data before-and-after, and
> the best way to do that seems to be to overlay the data with a map.
> (Am I missing something?)
> 
>>From the excellent open-access book on package=lattice
> 
> ISBN 978-0-387-75968-5
> e-ISBN 978-0-387-75969-2
> http://dx.doi.org/10.1007/978-0-387-75969-2
> 
> I know how to plot a choropleth map with latticeExtra::mapplot, but
> that's not what I want, which is just to overlay a lattice (or Trellis)
> of levelplot's with the lines of a geographical map. How to do that?
> 
> A relatively small, quite self-contained example follows, in which I
> plot toy data in the sort of lattice layout I need. The toy data covers
> a horizontal space over North America; each panel has bounds=
> 
> longitudes: -130? to -59.5?
> latitudes:  23.5? to 58.5?
> 
> corresponding to this geography
> 
> https://github.com/TomRoche/cornbeltN2O/wiki/images/Cmaq_aqmeii_domain.png
> 
> So how to (programmatically) overlay something like that image over each
> panel in the lattice generated below? Your assistance is appreciated!
> 
> # start example
> library(lattice)
> 
> # Not too many points, for this example
> # -130? to -59.5: (130-59.5)/1.5=47
> # 23.5? to 58.5?: 58.5-23.5     =35
> 
> # define longitudes
> west.lon.deg=-130
> #east.lon.deg=-115    # debugging
> east.lon.deg=-59.5
> step.lon.deg=1.5
> lons  <- c(seq(west.lon.deg, east.lon.deg, step.lon.deg))
> n.lon <- length(lons)
> 
> # define latitudes
> south.lat.deg=23.5
> #north.lat.deg=30.5    # debugging
> north.lat.deg=58.5
> step.lat.deg=1.0
> lats  <- c(seq(south.lat.deg, north.lat.deg, step.lat.deg))
> n.lat <- length(lats)
> 
> # define vertical levels
> bot.lev.mb=1000
> top.lev.mb=50
> n.lev=4
> levs <- c(seq(from=bot.lev.mb, to=top.lev.mb, length.out=n.lev))
> 
> # define concentrations
> grid.3d.len <- n.lon * n.lat * n.lev
> concs <- c(1:grid.3d.len)
> 
> # define grid
> grid.3d.df <- expand.grid(longitude=lons, latitude=lats, level=levs)
> # add concentrations as data
> data.3d.df <- cbind(grid.3d.df, concentration=concs)
> # debugging
> head(data.3d.df)
> tail(data.3d.df)
> 
> sigdigs=3 # significant digits
> # plot "appropriately" for atmospheric data: use
> # * lattice::levelplot
> # * one column, since atmospheric levels stack vertically
> levelplot(
>   concentration ~ longitude * latitude | level, 
>   data=data.3d.df, layout=c(1,n.lev),
>   levs=as.character(round(data.3d.df[['level']], 1)),
>   strip=FALSE,
>   strip.left=strip.custom(
>     factor.levels= # thanks, David Winsemius
>       as.character(signif(unique(data.3d.df[['level']]), sigdigs)),
>     strip.levels=TRUE,
>     horizontal=TRUE,
>     strip.names=FALSE,
>     # gotta shrink strip text size to fit strip width:
>     # more on that separately
>     par.strip.text=list(cex=0.5)
>   )
> )
> # end example
> 
> TIA, Tom Roche <Tom_Roche at pobox.com>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From andre.vanproosdij at wur.nl  Thu Nov 22 10:13:23 2012
From: andre.vanproosdij at wur.nl (Proosdij, Andre van)
Date: Thu, 22 Nov 2012 09:13:23 +0000
Subject: [R-sig-Geo] asc2dataframe and dataframe2asc problem with ncols
 nrows and cell size
In-Reply-To: <CANtt_hw-p8odZ7wXD2o3Venju-KcHZWJymYyrq4d+o+rib32sA@mail.gmail.com>
References: <84D737939C16114590DCDD4F003E013B1FD30FBB@SCOMP0936.wurnet.nl>
	<CANtt_hw9OO3e2rG-CAPgF2TxOvEPwyR4EogQu28tyJUJ2pQFQw@mail.gmail.com>
	<84D737939C16114590DCDD4F003E013B1FD31061@SCOMP0936.wurnet.nl>
	<CANtt_hw-p8odZ7wXD2o3Venju-KcHZWJymYyrq4d+o+rib32sA@mail.gmail.com>
Message-ID: <84D737939C16114590DCDD4F003E013B1FD427DA@SCOMP0936.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121122/643f10d9/attachment.pl>

From dbprovete at gmail.com  Thu Nov 22 13:46:57 2012
From: dbprovete at gmail.com (Diogo B. Provete)
Date: Thu, 22 Nov 2012 10:46:57 -0200
Subject: [R-sig-Geo] Same number of points in correlograms
Message-ID: <CALJB7JQk3S6mjOw=bcLwA7upDHr5LcS7EGWp0KQO9oopJ10vgw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121122/6c919d3c/attachment.pl>

From nmmv2002 at hotmail.com  Thu Nov 22 15:17:30 2012
From: nmmv2002 at hotmail.com (Nuno Veiga)
Date: Thu, 22 Nov 2012 14:17:30 +0000
Subject: [R-sig-Geo] Spatial Analysis doubts
In-Reply-To: <DUB104-W576F6CB2D2F2B98880FFB5D7540@phx.gbl>
References: <DUB104-W107B16C58369C72E359351D7540@phx.gbl>,
	<!~!UENERkVCMDkAAQACAAAAAAAAAAAAAAAAABgAAAAAAAAAVns5Y7wq3EaCUcbcW5a458KAAAAQAAAAM4lqzq2n8ECdTZq7MR+89wEAAAAA@ipma.pt>,
	<DUB104-W576F6CB2D2F2B98880FFB5D7540@phx.gbl>
Message-ID: <DUB104-W23111BE0E28129809A9AB3D75B0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121122/6ae4b08b/attachment.pl>

From paulojus at c3sl.ufpr.br  Fri Nov 23 10:15:17 2012
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Fri, 23 Nov 2012 07:15:17 -0200 (BRST)
Subject: [R-sig-Geo] pseudo R-squared with likfit (geoR)
In-Reply-To: <509AAE43.4020002@univ-fcomte.fr>
References: <509AAE43.4020002@univ-fcomte.fr>
Message-ID: <alpine.DEB.2.00.1211230714130.11779@macalan.c3sl.ufpr.br>

Marion

In your code you compute objects sp07*
but uses others sp07* to compute the pseudo-R2 - would be that the 
problem?

Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Wed, 7 Nov 2012, Marion Jacquot wrote:

> We want to compute a pseudo R-squared for a model whose parameter
> estimation was based on maximum likelihood (function likfit, package geoR).
>
> I tried to compute the R2 proposed by Maddala (1983) which compare the
> maximized likelihood for the model without any predictor and the
> maximized likelihood for the model with all predictors.
> I got a really low value (0,01%). Did I miss something? Are there other
> R-squared which are more appropriate than the R2 of Maddala? :
>
> >sp05_l01 <- likfit(cnm05g, *ini.cov.pars=vm05*, lik.method = "REML",
>                    trend = trend.spatial(~ logIKA04 + nbLitre0 +
> nbLitre1, cnm05g))#complete model
> >sp05_nt <- update(sp05_01, trend = trend.spatial("cte", cnm05g))
> #null model
>
> >1-(sp07_nt$loglik/sp07_l0$loglik)^(2/590)#Maddala (1983)
> [1] 0.0001510074
>
> Thanks,
> Regards,
> Marion
>
> -- 
> Marion Jacquot
> Laboratoire de Chrono-environnement
> UMR UFC/CNRS 6249 USC INRA
> Universit? de Franche-Comt?
> Place Leclerc
> F-25030 Besan?on cedex
> FRANCE
> Tel. : +33 (0)381 665 829
> Fax : +33 (0)381 665 797
> http://chrono-environnement.univ-fcomte.fr/
>
>
> 	[[alternative HTML version deleted]]
>
>


From mello at ieee.org  Fri Nov 23 15:32:56 2012
From: mello at ieee.org (Marcio Pupin Mello)
Date: Fri, 23 Nov 2012 15:32:56 +0100
Subject: [R-sig-Geo] Question about the results of mixed lagsarlm
In-Reply-To: <alpine.LRH.2.00.1112221317150.11762@reclus.nhh.no>
References: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>
	<alpine.LRH.2.00.1112211341240.7179@reclus.nhh.no>
	<CAFaxxctUipJr+ThvRH-KOMCdp_T4MTCkBo_m+ZF0ar_bvTsZ3A@mail.gmail.com>
	<alpine.LRH.2.00.1112221317150.11762@reclus.nhh.no>
Message-ID: <k8o1em$16r$1@ger.gmane.org>

Good, please post your question on the list after checking all the 
references, for example for lm.morantest, lm.morantest.sad and 
lm.LMtests; lm.moantest.exact is covered in Bivand, Roger; M?ller, 
Werner G.; Reder, Markus. Power calculations for global and local 
Moran's l. Computational Statistics & Data Analysis 2009 ;Volum 53.(8) 
s. 2859-2872. The Tiefelsdorf 2002 reference is very relevant, as are 
works cited there. In general, normality is not a real issue, unless the 
shape of the residuals is very badly behaved, but you can always run 
some simulations.

Roger



On Fri, 16 Nov 2012, Marcio Pupin Mello wrote:

 > Dear Prof. Roger,
 >    thanks for your reply.
 >    I've just sent a new post to the list and it worked now.
 >    I haven't read the papers where tests were introduced. Would them 
be those ones you cited in the help for summary.sarlm {spdep}? But I 
read in LeSage and Pace (2009) that a CI for the estimated parameters 
could be found through simulation processes.
 >    Apparently, results of the summary.sarlm showed that the test for 
the Intercept is Z based (Gaussian assumption, though), but I am not 
sure about the LR and Wald tests for Rho as well as LM test for residual 
autocorrelation.
 >    Bests,
 >
 > Marcio
 > www.dsr.inpe.br/~mello
 >
 > LeSage, J. and Pace, R.K. Introduction to Spatial Econometrics. CRC 
Press: Boca Raton, USA, 2009. 354 p.


On 12/22/11 1:21 PM, Roger Bivand wrote:
> On Thu, 22 Dec 2011, Dimitrios Efthymiou wrote:
>
>> Hi Roger,
>>
>> thanks for your help.
>>
>> Now I get a result, but many variables that are significant at the error
>> and lag models, are not significant here.
>> In addition, few variables have statistically significant direct impact,
>> others indirect and others total.
>>
>> e.g.
>>
>>
>> Simulated z-values:
>>                                 Direct    Indirect       Total
>>
>>
>> ...
>> log(sqm)                   134.33514612  6.95584281 27.94811234
>> parking                      9.01409655  0.51593572  1.58416761
>> chimney                      4.20407856  1.15585250  1.67326910
>> auto_heat                    5.37231195  0.66981923  1.30766715
>> klima                        4.75291342  2.42475203  2.99642118
>> dist_cbd                     1.86144465 -2.04747304 -1.08141630
>> metro                       -0.29541702  2.75180894  3.47650020
>>
>>
>> ...
>>
>>
>> This question does not have to do with the package's functions, but I
>> would
>> appreciate any help because I'm not totally sure how to explain these
>> results.
>
> Please refer to the advice given by J. Paul Elhorst on the openspace list:
>
> http://groups.google.com/group/openspace-list/browse_thread/thread/9381788c8f5c5352
>
>
> (click on: Show quoted text)
>
> In addition, if you look at the summary output for your error model with
> Hausman=TRUE, you'll see whether an error model is acceptable if the
> Common Factor LR test indicates error rather than spatial Durbin. The
> Hausman test is described in LeSage & Pace 2009.
>
> Hope this helps,
>
> Roger
>
>
>>
>> Many thanks in advance for your help.
>>
>> Dimitris
>>
>> On 21 December 2011 14:48, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> On Wed, 21 Dec 2011, Dimitrios Efthymiou wrote:
>>>
>>>  Hi all,
>>>>
>>>> I'm using the 'spdep' package of R, in a server with Ubuntu.
>>>> I'm trying to estimate a lagsarlm "mixed" model using 8.000
>>>> observations
>>>> of
>>>> house prices.
>>>>
>>>> until now, I can estimate the errorraslm, lagsarlm (lagged) and
>>>> sacsarlm
>>>> without problem, but when I try to estimate the mixed lagsarlm, NAs
>>>> appear
>>>> at the Std. Error, z-value and p columns of many variables.
>>>>
>>>
>>> This means that you have issues in the close correlations between the
>>> variables and lagged variables. If you use a trs= argument of MC traces,
>>> the finite difference estimate of the Hessian will be augmented as
>>> shown in
>>> LeSage & Pace (2009), and as the help page for lagsarlm says, the
>>> problem
>>> may go away. You need the series of traces of powers of W anyway for
>>> impacts(), so no extra effort is required. If the coefficient itself is
>>> dropped, a variable and its lag are aliased, but this isn't your case
>>> here.
>>>
>>> Hope this helps,
>>>
>>> Roger
>>>
>>>
>>>> Does anyone know what causes this?
>>>>
>>>> I'm using k-nearest neighbours = 12, the S-coding variance
>>>> - stabilising, and the LU method  (I concluded to these numbers and
>>>> methods
>>>> after experimentation in the other models).
>>>>
>>>>
>>>> Characteristics of weights list object:
>>>> Neighbour list object:
>>>> Number of regions: 8066
>>>> Number of nonzero links: 185518
>>>> Percentage nonzero weights: 0.2851475
>>>> Average number of links: 23
>>>> Non-symmetric neighbours list
>>>>
>>>> Weights style: S
>>>> Weights constants summary:
>>>>    n       nn   S0       S1       S2
>>>> S 8066 65060356 8066 630.5066 32982.99
>>>>
>>>>
>>>>
>>>>
>>>>  sessionInfo()R version 2.14.0 (2011-10-31)
>>>>>
>>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>>
>>>> locale:
>>>> [1] C
>>>>
>>>> attached base packages:
>>>> [1] splines   grid      stats     graphics  grDevices utils
>>>> datasets
>>>> [8] methods   base
>>>>
>>>> other attached packages:
>>>> [1] ape_2.8             ade4_1.4-17         car_2.0-11
>>>> [4] survival_2.36-10    nnet_7.3-1          gstat_1.0-10
>>>> [7] spacetime_0.5-7     xts_0.8-2           zoo_1.7-6
>>>> [10] rasterVis_0.10-7    hexbin_1.26.0       latticeExtra_0.6-19
>>>> [13] RColorBrewer_1.0-5  RANN_2.1.3          spdep_0.5-43
>>>> [16] coda_0.14-6         nlme_3.1-102        MASS_7.3-16
>>>> [19] Matrix_1.0-2        boot_1.3-3          ggplot2_0.8.9
>>>> [22] proto_0.3-9.2       reshape_0.8.4       plyr_1.6
>>>> [25] spgwr_0.6-13        spatstat_1.25-0     deldir_0.0-16
>>>> [28] mgcv_1.7-12         rgdal_0.7-5         maptools_0.8-10
>>>> [31] lattice_0.20-0      foreign_0.8-48      raster_1.9-55
>>>> [34] sp_0.9-91
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] gee_4.13-17  tools_2.14.0
>>>>
>>>>
>>>> Many thanks in advance for your help.
>>>>
>>>> Dimitris
>>>>
>>>>
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
>>
>>
>


From annamac_80 at hotmail.com  Sat Nov 24 05:50:45 2012
From: annamac_80 at hotmail.com (WillM)
Date: Fri, 23 Nov 2012 20:50:45 -0800 (PST)
Subject: [R-sig-Geo] spatial range parameter in ruf.fit (package ruf)
In-Reply-To: <AANLkTik+kJGc4=B=h7Btpkz-s60H3VGQ5MrY7KEo81kO@mail.gmail.com>
References: <AANLkTikkStrKnTGApm_-EtUn6Rf1ukRE8=eVgwQVkdMk@mail.gmail.com>
	<AANLkTimJpQui5ZQtOqeDf16Oo9fxDt2LCz=a9DZhW12Z@mail.gmail.com>
	<AANLkTik+kJGc4=B=h7Btpkz-s60H3VGQ5MrY7KEo81kO@mail.gmail.com>
Message-ID: <1353732645532-7581759.post@n2.nabble.com>

Hi

Did anyone get to the bottom of this? I am still confused - should I enter
the h value from the utilisation distribution as the smoothness and spatial
range?

Thanks
Anna



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-range-parameter-in-ruf-fit-package-ruf-tp5338902p7581759.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From annamac_80 at hotmail.com  Sat Nov 24 23:42:30 2012
From: annamac_80 at hotmail.com (WillM)
Date: Sat, 24 Nov 2012 14:42:30 -0800 (PST)
Subject: [R-sig-Geo] spatial range parameter in ruf.fit (package ruf)
In-Reply-To: <1353732645532-7581759.post@n2.nabble.com>
References: <AANLkTikkStrKnTGApm_-EtUn6Rf1ukRE8=eVgwQVkdMk@mail.gmail.com>
	<AANLkTimJpQui5ZQtOqeDf16Oo9fxDt2LCz=a9DZhW12Z@mail.gmail.com>
	<AANLkTik+kJGc4=B=h7Btpkz-s60H3VGQ5MrY7KEo81kO@mail.gmail.com>
	<1353732645532-7581759.post@n2.nabble.com>
Message-ID: <1353796950615-7581760.post@n2.nabble.com>

OK it has been sorted. 

Here is what to put into the ruf.fit for future users:

hval <-c(h, 1.5)

where h is the h value used to create the kernel utilisation distribution
for that individual. The 1.5 is always set at 1.5.

Cheers




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-range-parameter-in-ruf-fit-package-ruf-tp5338902p7581760.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From massimodisasha at gmail.com  Mon Nov 26 03:03:31 2012
From: massimodisasha at gmail.com (Massimo Di Stefano)
Date: Sun, 25 Nov 2012 21:03:31 -0500
Subject: [R-sig-Geo] Rgdal on osx 10.8 (homebrew)
In-Reply-To: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
References: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
Message-ID: <50B2CDF3.9030308@gmail.com>

Hi All,

i'm having trouble trying to build Rgdal from source on mac osx 10.8.x

i have R and gfortran installed using Homebrew.

when i try to build rgdal i got this log :

epi:~ epi$ R CMD INSTALL rgdal_0.7-22.tar.gz
* installing to library 
?/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library?
* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: gdal-config: gdal-config
checking gdal-config usability... yes
configure: GDAL: 1.9.2
checking GDAL version > 1.5.4... yes
checking for gcc... cc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether cc accepts -g... yes
checking for cc option to accept ISO C89... none needed
checking how to run the C preprocessor... cc -E
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for ANSI C header files... rm: conftest.dSYM: is a directory
rm: conftest.dSYM: is a directory
yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking gdal.h usability... yes
checking gdal.h presence... yes
checking for gdal.h... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
clang: warning: treating 'c' input as 'c++' when in C++ mode, this 
behavior is deprecated
gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
main() {
^~~~
1 error generated.
clang: warning: treating 'c' input as 'c++' when in C++ mode, this 
behavior is deprecated
gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
main() {
^~~~
1 error generated.
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing 
?/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/rgdal?
epi:~ epi$


have you any clue about it ?

 > sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-apple-darwin12.2.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats graphics grDevices utils datasets methods base
 >


###


epi:~ epi$ gfortran -v
Using built-in specs.
COLLECT_GCC=gfortran
COLLECT_LTO_WRAPPER=/usr/local/Cellar/gfortran/4.7.2/gfortran/libexec/gcc/x86_64-apple-darwin12.2.0/4.7.2/lto-wrapper
Target: x86_64-apple-darwin12.2.0
Configured with: ../configure --enable-languages=fortran 
--prefix=/usr/local/Cellar/gfortran/4.7.2/gfortran 
--datarootdir=/usr/local/Cellar/gfortran/4.7.2/share 
--bindir=/usr/local/Cellar/gfortran/4.7.2/bin --with-system-zlib 
--with-gmp=/usr/local/opt/gmp --with-mpfr=/usr/local/opt/mpfr 
--with-mpc=/usr/local/opt/libmpc --enable-checking=release 
--disable-stage1-checking --disable-build-poststage1-with-cxx 
--disable-libstdcxx-pc --disable-nls
Thread model: posix
gcc version 4.7.2 (GCC)
epi:~ epi$


Thanks!!!

Massimo.


From massimodisasha at gmail.com  Mon Nov 26 03:21:35 2012
From: massimodisasha at gmail.com (Massimo Di Stefano)
Date: Sun, 25 Nov 2012 21:21:35 -0500
Subject: [R-sig-Geo] Rgdal on osx 10.8 (homebrew)
In-Reply-To: <50B2CDF3.9030308@gmail.com>
References: <CAAN3GgAbh9in7gQ6OGukEFTzkix7_DA7CsnkcZ4ZA-yU4Y9wiQ@mail.gmail.com>
	<50B2CDF3.9030308@gmail.com>
Message-ID: <50B2D22F.3020308@gmail.com>

I tried to untar the rgdal.tar.gz
and rerun the R cMD install command ,

i attached a link to the logs :

http://epi.whoi.edu/esr/errors.txt
http://epi.whoi.edu/esr/configure.ac
http://epi.whoi.edu/config.log


Il 25/11/12 21:03, Massimo Di Stefano ha scritto:
> Hi All,
>
> i'm having trouble trying to build Rgdal from source on mac osx 10.8.x
>
> i have R and gfortran installed using Homebrew.
>
> when i try to build rgdal i got this log :
>
> epi:~ epi$ R CMD INSTALL rgdal_0.7-22.tar.gz
> * installing to library 
> ?/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library?
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: gdal-config: gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 1.9.2
> checking GDAL version > 1.5.4... yes
> checking for gcc... cc
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether cc accepts -g... yes
> checking for cc option to accept ISO C89... none needed
> checking how to run the C preprocessor... cc -E
> checking for grep that handles long lines and -e... /usr/bin/grep
> checking for egrep... /usr/bin/grep -E
> checking for ANSI C header files... rm: conftest.dSYM: is a directory
> rm: conftest.dSYM: is a directory
> yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking gdal.h usability... yes
> checking gdal.h presence... yes
> checking for gdal.h... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> clang: warning: treating 'c' input as 'c++' when in C++ mode, this 
> behavior is deprecated
> gdal_test.c:5:1: error: C++ requires a type specifier for all 
> declarations
> main() {
> ^~~~
> 1 error generated.
> clang: warning: treating 'c' input as 'c++' when in C++ mode, this 
> behavior is deprecated
> gdal_test.c:5:1: error: C++ requires a type specifier for all 
> declarations
> main() {
> ^~~~
> 1 error generated.
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing 
> ?/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/rgdal?
> epi:~ epi$
>
>
> have you any clue about it ?
>
> > sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-apple-darwin12.2.0 (64-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
> >
>
>
> ###
>
>
> epi:~ epi$ gfortran -v
> Using built-in specs.
> COLLECT_GCC=gfortran
> COLLECT_LTO_WRAPPER=/usr/local/Cellar/gfortran/4.7.2/gfortran/libexec/gcc/x86_64-apple-darwin12.2.0/4.7.2/lto-wrapper 
>
> Target: x86_64-apple-darwin12.2.0
> Configured with: ../configure --enable-languages=fortran 
> --prefix=/usr/local/Cellar/gfortran/4.7.2/gfortran 
> --datarootdir=/usr/local/Cellar/gfortran/4.7.2/share 
> --bindir=/usr/local/Cellar/gfortran/4.7.2/bin --with-system-zlib 
> --with-gmp=/usr/local/opt/gmp --with-mpfr=/usr/local/opt/mpfr 
> --with-mpc=/usr/local/opt/libmpc --enable-checking=release 
> --disable-stage1-checking --disable-build-poststage1-with-cxx 
> --disable-libstdcxx-pc --disable-nls
> Thread model: posix
> gcc version 4.7.2 (GCC)
> epi:~ epi$
>
>
> Thanks!!!
>
> Massimo.
>
>


From distem at rpi.edu  Mon Nov 26 04:56:03 2012
From: distem at rpi.edu (rpi)
Date: Sun, 25 Nov 2012 22:56:03 -0500
Subject: [R-sig-Geo] Rgdal on osx 10.8 (homebrew)
Message-ID: <F818978B-A1D9-4214-96A3-72722D22CE8A@rpi.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121125/42341544/attachment.pl>

From Roger.Bivand at nhh.no  Mon Nov 26 08:40:33 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Nov 2012 08:40:33 +0100
Subject: [R-sig-Geo] Rgdal on osx 10.8 (homebrew)
In-Reply-To: <F818978B-A1D9-4214-96A3-72722D22CE8A@rpi.edu>
References: <F818978B-A1D9-4214-96A3-72722D22CE8A@rpi.edu>
Message-ID: <alpine.LRH.2.02.1211260835580.17500@reclus.nhh.no>

I suggest posting on R-SIG-Mac for possibly more rapid and accurate 
feedback. The rgdal developers have no access to OSX at all, let alone 
10.8. It appears in addition that your compile train may be running the 
configure tests with clang rather than gcc, and that the GDAL shared 
objects are not being found where gdal-config says they are located. 
Please report back on this thread when you solve the problem.

Roger

On Mon, 26 Nov 2012, rpi wrote:

> Hi All,
> 
> i'm having trouble trying to build Rgdal from source on mac osx 10.8.x
> 
> i have R and gfortran installed using Homebrew.
> 
> when i try to build rgdal i got this log :
> 
> epi:~ epi$ R CMD INSTALL rgdal_0.7-22.tar.gz
> * installing to library
> ???/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library???
> * installing *source* package ???rgdal??? ...
> ** package ???rgdal??? successfully unpacked and MD5 sums checked
> configure: gdal-config: gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 1.9.2
> checking GDAL version > 1.5.4... yes
> checking for gcc... cc
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether cc accepts -g... yes
> checking for cc option to accept ISO C89... none needed
> checking how to run the C preprocessor... cc -E
> checking for grep that handles long lines and -e... /usr/bin/grep
> checking for egrep... /usr/bin/grep -E
> checking for ANSI C header files... rm: conftest.dSYM: is a directory
> rm: conftest.dSYM: is a directory
> yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking gdal.h usability... yes
> checking gdal.h presence... yes
> checking for gdal.h... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> clang: warning: treating 'c' input as 'c++' when in C++ mode, this
> behavior is deprecated
> gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
> main() {
> ^~~~
> 1 error generated.
> clang: warning: treating 'c' input as 'c++' when in C++ mode, this
> behavior is deprecated
> gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
> main() {
> ^~~~
> 1 error generated.
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ???rgdal???
> * removing
> ???/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/rgd
> al???
> epi:~ epi$
> 
> 
> have you any clue about it ?
> 
> 
> I tried to untar the rgdal.tar.gz
> and rerun the R CMD install command ,
> 
> i attached a link to the logs :
> 
> http://epi.whoi.edu/esr/errors.txt
> http://epi.whoi.edu/esr/configure.ac
> http://epi.whoi.edu/config.log
> 
> 
> ?> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-apple-darwin12.2.0 (64-bit)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
> ?>
> 
> 
> ###
> 
> 
> epi:~ epi$ gfortran -v
> Using built-in specs.
> COLLECT_GCC=gfortran
> COLLECT_LTO_WRAPPER=/usr/local/Cellar/gfortran/4.7.2/gfortran/libexec/gcc/x
> 86_64-apple-darwin12.2.0/4.7.2/lto-wrapper
> Target: x86_64-apple-darwin12.2.0
> Configured with: ../configure --enable-languages=fortran
> --prefix=/usr/local/Cellar/gfortran/4.7.2/gfortran
> --datarootdir=/usr/local/Cellar/gfortran/4.7.2/share
> --bindir=/usr/local/Cellar/gfortran/4.7.2/bin --with-system-zlib
> --with-gmp=/usr/local/opt/gmp --with-mpfr=/usr/local/opt/mpfr
> --with-mpc=/usr/local/opt/libmpc --enable-checking=release
> --disable-stage1-checking --disable-build-poststage1-with-cxx
> --disable-libstdcxx-pc --disable-nls
> Thread model: posix
> gcc version 4.7.2 (GCC)
> epi:~ epi$
> 
> 
> 
> 
> 
> Thanks!!!
> 
> Massimo.
> ??????? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alfios17 at hotmail.com  Mon Nov 26 12:20:51 2012
From: alfios17 at hotmail.com (Lorenzo Alfieri)
Date: Mon, 26 Nov 2012 12:20:51 +0100
Subject: [R-sig-Geo] calculate CRPS on rasters
Message-ID: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121126/a5b57d98/attachment.pl>

From s.meyer at lmu.de  Mon Nov 26 16:51:15 2012
From: s.meyer at lmu.de (Swen Meyer)
Date: Mon, 26 Nov 2012 16:51:15 +0100
Subject: [R-sig-Geo] Faster way of calculating the mean of multiple ascii
	files?
Message-ID: <50B38FF3.50107@lmu.de>

Dear All,
I?m trying to process a couple of ascii grids (daily grids): size of one 
grid (344kb). the header of the ascii grids look like this:
ncols 288
nrows 199
xllcorner 506255
yllcorner 4.35899e+006
cellsize 30

I have daily grids over 30 years and I like to find a fast way of 
calculating the monthly means for every month of those 30 years:
the file structure is like this: grid1: "sb05_dem30m_20410101.024"
grid2: "sb05_dem30m_20410102.024"
grid3: "sb05_dem30m_20410103.024"
...
gridn: "sb05_dem30m_YYYYMMdd.024"
...
last grid: "sb05_dem30m_20701231.024"

At the moment I?using R Vers. 2.15.1 on a Intel PC i5 CPU 760@ 2.80GHz 
2.80GHz with 4GB RAM Windows7, and the raster package and this is my 
script:
library(raster)

setwd("G:\\hydro_modelling\\Sardinia\\Wasim\\RioCostara30m\\KNMI_REF\\output30m\\RUN2\\UNSATZON\\") 

Path="G:\\hydro_modelling\\Sardinia\\Wasim\\RioCostara30m\\KNMI_REF\\output30m\\RUN2\\SOILMOIST\\" 



x="sb05_dem30m_"
#list files of folder with string x
Files=list.files(pattern=x)
# select files to process
Files=Files[which((substring(Files,nchar(Files)-3,nchar(Files)))==".024")]

for( i in unique(substring(Files,(nchar(Files)-9),nchar(Files)-6))){
print(i)
#stack files
X_01 <- 
stack(Files[which(substring(Files,(nchar(Files)-9),nchar(Files)-6)==i)])
#mean the grid with raster package
X_01_sum <- mean((X_01))
#Write monthly mean asci grid
writeRaster(X_01_sum, 
filename=paste(Path,"SoilMoisture_RM_Mean_",i,sep=""), "ascii")
}

The script works, but it takes more than 30 min until the grids are 
precessed. Does anyone know of a faster way of meaning (summing) those 
grids and exporting them as a asci again?
Best regards and thank you in advance,
Swen

-- 
--------------------------------------------------------------
Dipl. - Geogr. Swen Meyer
Department of Geography
Physical Geography and Environmental Modeling Ludwig-Maximilian University of Munich

Luisenstrasse 37
80333 Munich/Germany
fon: +49 (0)89 2180-6665
fax: +49 (0)89 2180-6675
email: s.meyer at lmu.de
web: www.geographie.uni-muenchen.de


From mello at ieee.org  Mon Nov 26 18:21:54 2012
From: mello at ieee.org (Marcio Pupin Mello)
Date: Mon, 26 Nov 2012 18:21:54 +0100
Subject: [R-sig-Geo] Image Classification - Wish List?
In-Reply-To: <CAO7hk-Jib6sKUJJvnKkdwSLJbR4e3PHUTDYypXT57vNzMQEK4Q@mail.gmail.com>
References: <mailman.6942.1333516299.4502.r-sig-geo@r-project.org>
	<CAO7hk-KUatLKDOWxhavVok7sQwfTRBQUfao0sTOZuKWOfyh2DA@mail.gmail.com>
	<4F7C3E2A.9080103@gmail.com>
	<CAO7hk-+C0VWae2DOR8jBCN-KOW=MqAG2j+utrR1D6+HfK+vBxw@mail.gmail.com>
	<CAO7hk-Jib6sKUJJvnKkdwSLJbR4e3PHUTDYypXT57vNzMQEK4Q@mail.gmail.com>
Message-ID: <k908fg$d6n$1@ger.gmane.org>

Perhaps too late but as a summary I'd suggest the paper
SLUITER, R.; PEBESMA, E. J. Comparing techniques for vegetation 
classification using multi- and hyperspectral images and ancillary 
environmental data. International Journal of Remote Sensing, v. 31, n. 
23, p. 6143-6161, 2010.

Marcio
www.dsr.inpe.br/~mello

On 4/4/12 3:34 PM, Eric Momsen wrote:
>>
>> On Wed, Apr 4, 2012 at 7:27 AM, Rainer M Krug <r.m.krug at gmail.com> wrote:
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>>
>>> On 04/04/12 14:16, Eric Momsen wrote:
>>
>>>
>>> An interface like this would help your work tremendously, as it would
>> make the linking much
>>> easier. Nevertheless, I have no idea how this could be achieved, maybe
>> via python, from which one
>>> can call R and some convenience functions?
>>
>>
>> Yes, my guess is also linking would be easier then rewriting an
>> algorithm.  At least one other process (Kriging) has been integrated
>> into the GRASS front end using R to do the processing.  Would anyone
>> find it useful to have something similar for other processes?
>> -Eric
>>
>>>
>>> Cheers,
>>>
>>> Rainer
>>>
>>>
>>
>
> 	[[alternative HTML version deleted]]
>


From distem at rpi.edu  Tue Nov 27 01:19:11 2012
From: distem at rpi.edu (rpi)
Date: Mon, 26 Nov 2012 19:19:11 -0500
Subject: [R-sig-Geo] Rgdal on osx 10.8 (homebrew)
In-Reply-To: <alpine.LRH.2.02.1211260835580.17500@reclus.nhh.no>
References: <F818978B-A1D9-4214-96A3-72722D22CE8A@rpi.edu>
	<alpine.LRH.2.02.1211260835580.17500@reclus.nhh.no>
Message-ID: <1C810CE1-B35B-44AD-BC24-EF8307C5C1F1@rpi.edu>

Thanks Roger!


the compiler was the problem :)

using the terminal instead of R.app (GUI)
i was able to install rgdal correctly exptoring CC & CXX  using gcc & g++  
(the default on OSX 10.8.x , Xcode 4.5.x are :  clang & clang++)

so what i had to do :

wget http://cran.cs.wwu.edu/src/contrib/rgdal_0.7-22.tar.gz

export CC=/usr/bin/gcc
export CXX=/usr/bin/g++ 

R CMD INSTALL rgdal_0.7-22.tar.gz

--Massimo.



Il giorno 26/nov/2012, alle ore 02:40, Roger Bivand <Roger.Bivand at nhh.no> ha scritto:

> I suggest posting on R-SIG-Mac for possibly more rapid and accurate feedback. The rgdal developers have no access to OSX at all, let alone 10.8. It appears in addition that your compile train may be running the configure tests with clang rather than gcc, and that the GDAL shared objects are not being found where gdal-config says they are located. Please report back on this thread when you solve the problem.
> 
> Roger
> 
> On Mon, 26 Nov 2012, rpi wrote:
> 
>> Hi All,
>> i'm having trouble trying to build Rgdal from source on mac osx 10.8.x
>> i have R and gfortran installed using Homebrew.
>> when i try to build rgdal i got this log :
>> epi:~ epi$ R CMD INSTALL rgdal_0.7-22.tar.gz
>> * installing to library
>> ???/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library???
>> * installing *source* package ???rgdal??? ...
>> ** package ???rgdal??? successfully unpacked and MD5 sums checked
>> configure: gdal-config: gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 1.9.2
>> checking GDAL version > 1.5.4... yes
>> checking for gcc... cc
>> checking whether the C compiler works... yes
>> checking for C compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... no
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether cc accepts -g... yes
>> checking for cc option to accept ISO C89... none needed
>> checking how to run the C preprocessor... cc -E
>> checking for grep that handles long lines and -e... /usr/bin/grep
>> checking for egrep... /usr/bin/grep -E
>> checking for ANSI C header files... rm: conftest.dSYM: is a directory
>> rm: conftest.dSYM: is a directory
>> yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking gdal.h usability... yes
>> checking gdal.h presence... yes
>> checking for gdal.h... yes
>> checking gdal: linking with --libs only... no
>> checking gdal: linking with --libs and --dep-libs... no
>> clang: warning: treating 'c' input as 'c++' when in C++ mode, this
>> behavior is deprecated
>> gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
>> main() {
>> ^~~~
>> 1 error generated.
>> clang: warning: treating 'c' input as 'c++' when in C++ mode, this
>> behavior is deprecated
>> gdal_test.c:5:1: error: C++ requires a type specifier for all declarations
>> main() {
>> ^~~~
>> 1 error generated.
>> configure: Install failure: compilation and/or linkage problems.
>> configure: error: GDALAllRegister not found in libgdal.
>> ERROR: configuration failed for package ???rgdal???
>> * removing
>> ???/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/rgd
>> al???
>> epi:~ epi$
>> have you any clue about it ?
>> I tried to untar the rgdal.tar.gz
>> and rerun the R CMD install command ,
>> i attached a link to the logs :
>> http://epi.whoi.edu/esr/errors.txt
>> http://epi.whoi.edu/esr/configure.ac
>> http://epi.whoi.edu/config.log
>>  > sessionInfo()
>> R version 2.15.2 (2012-10-26)
>> Platform: x86_64-apple-darwin12.2.0 (64-bit)
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> attached base packages:
>> [1] stats graphics grDevices utils datasets methods base
>>  >
>> ###
>> epi:~ epi$ gfortran -v
>> Using built-in specs.
>> COLLECT_GCC=gfortran
>> COLLECT_LTO_WRAPPER=/usr/local/Cellar/gfortran/4.7.2/gfortran/libexec/gcc/x
>> 86_64-apple-darwin12.2.0/4.7.2/lto-wrapper
>> Target: x86_64-apple-darwin12.2.0
>> Configured with: ../configure --enable-languages=fortran
>> --prefix=/usr/local/Cellar/gfortran/4.7.2/gfortran
>> --datarootdir=/usr/local/Cellar/gfortran/4.7.2/share
>> --bindir=/usr/local/Cellar/gfortran/4.7.2/bin --with-system-zlib
>> --with-gmp=/usr/local/opt/gmp --with-mpfr=/usr/local/opt/mpfr
>> --with-mpc=/usr/local/opt/libmpc --enable-checking=release
>> --disable-stage1-checking --disable-build-poststage1-with-cxx
>> --disable-libstdcxx-pc --disable-nls
>> Thread model: posix
>> gcc version 4.7.2 (GCC)
>> epi:~ epi$
>> Thanks!!!
>> Massimo.
>>         [[alternative HTML version deleted]]
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From etiennebr at gmail.com  Tue Nov 27 03:37:13 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 26 Nov 2012 21:37:13 -0500
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>
Message-ID: <CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121126/a6b3e187/attachment.pl>

From alfios17 at hotmail.com  Tue Nov 27 12:11:59 2012
From: alfios17 at hotmail.com (Lorenzo Alfieri)
Date: Tue, 27 Nov 2012 12:11:59 +0100
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>,
	<CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>
Message-ID: <DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121127/b5dee191/attachment.pl>

From markpayneatwork at gmail.com  Tue Nov 27 12:37:09 2012
From: markpayneatwork at gmail.com (Mark Payne)
Date: Tue, 27 Nov 2012 12:37:09 +0100
Subject: [R-sig-Geo] warning: size of values file does not match the number
	of cell
Message-ID: <CAGBzUO8ipXMvm4pGsG1+V_9FQ6_hmPe5-HhScVkowJmuio1KqQ@mail.gmail.com>

Hi,

I have a large raster file (netcdf) that I am trying to process ie

> bathr
class       : RasterLayer
dimensions  : 10800, 21600, 233280000  (nrow, ncol, ncell)
resolution  : 0.01666667, 0.01666667  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : /work/up/common/bathymetry/ETOPO1/ETOPO1_Ice_c_gmt4.nc
names       : z
values      : -10803, 8333  (min, max)
zvar        : z

Processing this with aggregate() gives the following warning:

> min.bath <- aggregate(bathr,fact=out.agg,fun=min,expand=FALSE)
Warning message:
In .rasterFromRasterFile(grdfile, band = band, objecttype) :
  size of values file does not match the number of cells (given the data type)

What does this warning mean? I've seen previously on the list that
there was a bug associated with this warning - the message has only
appeared for me since upgrading from about raster 2.0-12 (can't
remember the exact version, unfortunately) to 2.0-31.

Best wishes,

Mark


From markpayneatwork at gmail.com  Tue Nov 27 12:56:26 2012
From: markpayneatwork at gmail.com (Mark Payne)
Date: Tue, 27 Nov 2012 12:56:26 +0100
Subject: [R-sig-Geo] Writing a rasterBrick into a single NetCDF file
Message-ID: <CAGBzUO8jhZFVMEBcM6n9-x8KZUZr=MsvD6aVG3-77BXg6vRidg@mail.gmail.com>

Hi,

I have a rasterStack with several layers. I would like to write this
into a single NetCDF file, where each layer is stored as a variable.
Is there anyway that this can be done? At the moment (raster 2.0-31),
the layers are written as a third dimension, rather than than as
separate variables. I can see situations where people might want to do
both, so maybe an options switch to writeRaster could be a good
solution?

Cheers,
Mark


From educheyne at avia-gis.be  Tue Nov 27 15:00:08 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 27 Nov 2012 15:00:08 +0100
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
Message-ID: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>

Dear list
I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
Did anyone experience this before? 
Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.

>sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: i386-apple-darwin9.8.0/i386 (32 bit)

locale
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
stats graphics grDevices utils datasets methods base
> library(adehabitat)
Loading required package: ade4
Attaching package: 'ade4'
The following objects are masked from 'package:base'
within
loading required package:tkrplot
loading required package: tcltk
Loading Tcl/Tk interface
> sessionInfo()

After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.

Thanks for any help
Els


From massimodisasha at gmail.com  Tue Nov 27 15:03:25 2012
From: massimodisasha at gmail.com (epi)
Date: Tue, 27 Nov 2012 09:03:25 -0500
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
Message-ID: <988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>

did you tried to install XQuartz ?

http://xquartz.macosforge.org/landing/

--Massimo.


Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:

> Dear list
> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
> Did anyone experience this before? 
> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
> 
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
> 
> locale
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages:
> stats graphics grDevices utils datasets methods base
>> library(adehabitat)
> Loading required package: ade4
> Attaching package: 'ade4'
> The following objects are masked from 'package:base'
> within
> loading required package:tkrplot
> loading required package: tcltk
> Loading Tcl/Tk interface
>> sessionInfo()
> 
> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
> 
> Thanks for any help
> Els
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From educheyne at avia-gis.be  Tue Nov 27 15:34:26 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 27 Nov 2012 15:34:26 +0100
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
Message-ID: <9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>

Dear Massimo
I've just tried and it is still the same problem. Should I put it somewhere for R to find this?

Best
Els

On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:

> did you tried to install XQuartz ?
> 
> http://xquartz.macosforge.org/landing/
> 
> --Massimo.
> 
> 
> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
> 
>> Dear list
>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>> Did anyone experience this before? 
>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>> 
>>> sessionInfo()
>> R version 2.15.2 (2012-10-26)
>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>> 
>> locale
>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>> 
>> attached base packages:
>> stats graphics grDevices utils datasets methods base
>>> library(adehabitat)
>> Loading required package: ade4
>> Attaching package: 'ade4'
>> The following objects are masked from 'package:base'
>> within
>> loading required package:tkrplot
>> loading required package: tcltk
>> Loading Tcl/Tk interface
>>> sessionInfo()
>> 
>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>> 
>> Thanks for any help
>> Els
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From distem at rpi.edu  Tue Nov 27 16:42:42 2012
From: distem at rpi.edu (rpi)
Date: Tue, 27 Nov 2012 10:42:42 -0500
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
	<9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
Message-ID: <28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>

Els,

i tried to run adehabitat form inside the Gui.app (64 bit) using R 
(installed from Homebrew )

.. and i got the same problem you had

i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.

trying to run R from the command line ? it is able to load adehabitat.

seems to me a GUI.app problem 

..  can you check if your adehabitat code runs fine starting R from command line ?

thanks,

Massimo.

 
Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:

> Dear Massimo
> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
> 
> Best
> Els
> 
> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
> 
>> did you tried to install XQuartz ?
>> 
>> http://xquartz.macosforge.org/landing/
>> 
>> --Massimo.
>> 
>> 
>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>> 
>>> Dear list
>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>> Did anyone experience this before? 
>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>> 
>>>> sessionInfo()
>>> R version 2.15.2 (2012-10-26)
>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>> 
>>> locale
>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>> 
>>> attached base packages:
>>> stats graphics grDevices utils datasets methods base
>>>> library(adehabitat)
>>> Loading required package: ade4
>>> Attaching package: 'ade4'
>>> The following objects are masked from 'package:base'
>>> within
>>> loading required package:tkrplot
>>> loading required package: tcltk
>>> Loading Tcl/Tk interface
>>>> sessionInfo()
>>> 
>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>> 
>>> Thanks for any help
>>> Els
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From educheyne at avia-gis.be  Tue Nov 27 16:57:56 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 27 Nov 2012 16:57:56 +0100
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
	<9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
	<28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>
Message-ID: <FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>

Dear Massimo
yes it works from command line, I do get a warning about the tcl tk though, so indeed this must be the source of the problem (see below)
The good news is that at least I can carry out the code via the terminal if necessary (even it is not with the R Gui) 
Still hoping for a fix though
Els

R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(adehabitat)
Loading required package: ade4

Attaching package: ?ade4?

The following object(s) are masked from ?package:base?:

    within

Loading required package: tkrplot
Loading required package: tcltk
Loading Tcl/Tk interface ... done
Loading required package: shapefiles
Loading required package: foreign

Attaching package: ?shapefiles?

The following object(s) are masked from ?package:foreign?:

    read.dbf, write.dbf

Be careful: it is now recommended to use the newpackages adehabitatMA, adehabitatLT, adehabitatHR, and adehabitatHS.
These 4 packages are intended to become the future of adehabitat.
The "classical" version of adehabitat will still be maintained for some
time, but no new method will be added to the package.

Warning message:
In fun(libname, pkgname) :
  Can't find a usable tk.tcl in the following directories: 
    /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5/Resources/Scripts /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5/Resources/Scripts ./lib/tk8.5 ./lib/tk8.5/Resources/Scripts ~/Library/Tcl/tk8.5 ~/Library/Tcl/tk8.5/Resources/Scripts /Library/Tcl/tk8.5 /Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/tk8.5 /System/Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/8.5/tk8.5 /System/Library/Tcl/8.5/tk8.5/Resources/Scripts ~/Library/Frameworks/tk8.5 ~/Library/Frameworks/tk8.5/Resources/Scripts /Library/Frameworks/tk8.5 /Library/Frameworks/tk8.5/Resources/Scripts /System/Library/Frameworks/tk8.5 /System/Library/Frameworks/tk8.5/Resources/Scripts ./library



This probably means that tk wasn't installed properly.
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] tcltk     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] adehabitat_1.8.11 shapefiles_0.6    foreign_0.8-51    tkrplot_0.0-23   
[5] ade4_1.4-17      
> 

On 27 Nov 2012, at 16:42, rpi <distem at rpi.edu> wrote:

> Els,
> 
> i tried to run adehabitat form inside the Gui.app (64 bit) using R 
> (installed from Homebrew )
> 
> .. and i got the same problem you had
> 
> i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.
> 
> trying to run R from the command line ? it is able to load adehabitat.
> 
> seems to me a GUI.app problem 
> 
> ..  can you check if your adehabitat code runs fine starting R from command line ?
> 
> thanks,
> 
> Massimo.
> 
> 
> Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
> 
>> Dear Massimo
>> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
>> 
>> Best
>> Els
>> 
>> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
>> 
>>> did you tried to install XQuartz ?
>>> 
>>> http://xquartz.macosforge.org/landing/
>>> 
>>> --Massimo.
>>> 
>>> 
>>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>> 
>>>> Dear list
>>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>>> Did anyone experience this before? 
>>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>>> 
>>>>> sessionInfo()
>>>> R version 2.15.2 (2012-10-26)
>>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>>> 
>>>> locale
>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>> 
>>>> attached base packages:
>>>> stats graphics grDevices utils datasets methods base
>>>>> library(adehabitat)
>>>> Loading required package: ade4
>>>> Attaching package: 'ade4'
>>>> The following objects are masked from 'package:base'
>>>> within
>>>> loading required package:tkrplot
>>>> loading required package: tcltk
>>>> Loading Tcl/Tk interface
>>>>> sessionInfo()
>>>> 
>>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>>> 
>>>> Thanks for any help
>>>> Els
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 


From distem at rpi.edu  Tue Nov 27 17:10:18 2012
From: distem at rpi.edu (rpi)
Date: Tue, 27 Nov 2012 11:10:18 -0500
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
	<9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
	<28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>
	<FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>
Message-ID: <DFC81F8B-3CC0-49E3-AB15-3290D245DECE@rpi.edu>

yes is my guess that R binary is looking for the tcltk installed as framework

as suggested here :  http://cran.r-project.org/bin/macosx/tools/

do you have it installed ?

i didn't checked if it works on m. lion because i'm giving a try to there home-brew installation (it uses it's own gfortran and X system from the XQuarts installed in /opt/   as a standard unix library not as framework)

Massimo.


Il giorno 27/nov/2012, alle ore 10:57, Els Ducheyne <educheyne at avia-gis.be> ha scritto:

> Dear Massimo
> yes it works from command line, I do get a warning about the tcl tk though, so indeed this must be the source of the problem (see below)
> The good news is that at least I can carry out the code via the terminal if necessary (even it is not with the R Gui) 
> Still hoping for a fix though
> Els
> 
> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
> Copyright (C) 2012 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>  Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> [Previously saved workspace restored]
> 
>> library(adehabitat)
> Loading required package: ade4
> 
> Attaching package: ?ade4?
> 
> The following object(s) are masked from ?package:base?:
> 
>    within
> 
> Loading required package: tkrplot
> Loading required package: tcltk
> Loading Tcl/Tk interface ... done
> Loading required package: shapefiles
> Loading required package: foreign
> 
> Attaching package: ?shapefiles?
> 
> The following object(s) are masked from ?package:foreign?:
> 
>    read.dbf, write.dbf
> 
> Be careful: it is now recommended to use the newpackages adehabitatMA, adehabitatLT, adehabitatHR, and adehabitatHS.
> These 4 packages are intended to become the future of adehabitat.
> The "classical" version of adehabitat will still be maintained for some
> time, but no new method will be added to the package.
> 
> Warning message:
> In fun(libname, pkgname) :
>  Can't find a usable tk.tcl in the following directories: 
>    /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5/Resources/Scripts /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5/Resources/Scripts ./lib/tk8.5 ./lib/tk8.5/Resources/Scripts ~/Library/Tcl/tk8.5 ~/Library/Tcl/tk8.5/Resources/Scripts /Library/Tcl/tk8.5 /Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/tk8.5 /System/Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/8.5/tk8.5 /System/Library/Tcl/8.5/tk8.5/Resources/Scripts ~/Library/Frameworks/tk8.5 ~/Library/Frameworks/tk8.5/Resources/Scripts /Library/Frameworks/tk8.5 /Library/Frameworks/tk8.5/Resources/Scripts /System/Library/Frameworks/tk8.5 /System/Library/Frameworks/tk8.5/Resources/Scripts ./library
> 
> 
> 
> This probably means that tk wasn't installed properly.
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
> 
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods  
> [8] base     
> 
> other attached packages:
> [1] adehabitat_1.8.11 shapefiles_0.6    foreign_0.8-51    tkrplot_0.0-23   
> [5] ade4_1.4-17      
>> 
> 
> On 27 Nov 2012, at 16:42, rpi <distem at rpi.edu> wrote:
> 
>> Els,
>> 
>> i tried to run adehabitat form inside the Gui.app (64 bit) using R 
>> (installed from Homebrew )
>> 
>> .. and i got the same problem you had
>> 
>> i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.
>> 
>> trying to run R from the command line ? it is able to load adehabitat.
>> 
>> seems to me a GUI.app problem 
>> 
>> ..  can you check if your adehabitat code runs fine starting R from command line ?
>> 
>> thanks,
>> 
>> Massimo.
>> 
>> 
>> Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>> 
>>> Dear Massimo
>>> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
>>> 
>>> Best
>>> Els
>>> 
>>> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
>>> 
>>>> did you tried to install XQuartz ?
>>>> 
>>>> http://xquartz.macosforge.org/landing/
>>>> 
>>>> --Massimo.
>>>> 
>>>> 
>>>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>>> 
>>>>> Dear list
>>>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>>>> Did anyone experience this before? 
>>>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>>>> 
>>>>>> sessionInfo()
>>>>> R version 2.15.2 (2012-10-26)
>>>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>>>> 
>>>>> locale
>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>> 
>>>>> attached base packages:
>>>>> stats graphics grDevices utils datasets methods base
>>>>>> library(adehabitat)
>>>>> Loading required package: ade4
>>>>> Attaching package: 'ade4'
>>>>> The following objects are masked from 'package:base'
>>>>> within
>>>>> loading required package:tkrplot
>>>>> loading required package: tcltk
>>>>> Loading Tcl/Tk interface
>>>>>> sessionInfo()
>>>>> 
>>>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>>>> 
>>>>> Thanks for any help
>>>>> Els
>>>>> 
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
> 
> 
> 


From basille at ase-research.org  Tue Nov 27 17:25:31 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Tue, 27 Nov 2012 11:25:31 -0500
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
	<9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
	<28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>
	<FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>
Message-ID: <50B4E97B.2070306@ase-research.org>

Dear Els,

I can't really help on the Mac OS issue with tcl/tk since I'm using Linux. 
However, as the command line warning tells you, you'd better use 
'adehabitatHS' [1] now, instead of the old 'adehabitat', which is no longer 
developed (bug fixes are added, but no new methods). I don't think it will 
solve your problem, though, but I really recommend to upgrade. Besides, you 
might want to have a look at the MADIFA instead of the ENFA. See [2] for 
further details.

Best,
Mathieu Basille.


[1] http://cran.r-project.org/web/packages/adehabitatHS/index.html

[2] Calenge, C.; Darmon, G.; Basille, M.; Loison, A. & Jullien, J.-M. 
(2008) The factorial decomposition of the Mahalanobis distances in habitat 
selection studies. Ecology, 89: 555-566 doi 10.1890/06-1750.1


Le 27/11/2012 10:57, Els Ducheyne a ?crit :
> Dear Massimo
> yes it works from command line, I do get a warning about the tcl tk though, so indeed this must be the source of the problem (see below)
> The good news is that at least I can carry out the code via the terminal if necessary (even it is not with the R Gui)
> Still hoping for a fix though
> Els
>
> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
> Copyright (C) 2012 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>    Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> [Previously saved workspace restored]
>
>> library(adehabitat)
> Loading required package: ade4
>
> Attaching package: ?ade4?
>
> The following object(s) are masked from ?package:base?:
>
>      within
>
> Loading required package: tkrplot
> Loading required package: tcltk
> Loading Tcl/Tk interface ... done
> Loading required package: shapefiles
> Loading required package: foreign
>
> Attaching package: ?shapefiles?
>
> The following object(s) are masked from ?package:foreign?:
>
>      read.dbf, write.dbf
>
> Be careful: it is now recommended to use the newpackages adehabitatMA, adehabitatLT, adehabitatHR, and adehabitatHS.
> These 4 packages are intended to become the future of adehabitat.
> The "classical" version of adehabitat will still be maintained for some
> time, but no new method will be added to the package.
>
> Warning message:
> In fun(libname, pkgname) :
>    Can't find a usable tk.tcl in the following directories:
>      /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5/Resources/Scripts /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5/Resources/Scripts ./lib/tk8.5 ./lib/tk8.5/Resources/Scripts ~/Library/Tcl/tk8.5 ~/Library/Tcl/tk8.5/Resources/Scripts /Library/Tcl/tk8.5 /Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/tk8.5 /System/Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/8.5/tk8.5 /System/Library/Tcl/8.5/tk8.5/Resources/Scripts ~/Library/Frameworks/tk8.5 ~/Library/Frameworks/tk8.5/Resources/Scripts /Library/Frameworks/tk8.5 /Library/Frameworks/tk8.5/Resources/Scripts /System/Library/Frameworks/tk8.5 /System/Library/Frameworks/tk8.5/Resources/Scripts ./library
>
>
>
> This probably means that tk wasn't installed properly.
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] adehabitat_1.8.11 shapefiles_0.6    foreign_0.8-51    tkrplot_0.0-23
> [5] ade4_1.4-17
>>
>
> On 27 Nov 2012, at 16:42, rpi <distem at rpi.edu> wrote:
>
>> Els,
>>
>> i tried to run adehabitat form inside the Gui.app (64 bit) using R
>> (installed from Homebrew )
>>
>> .. and i got the same problem you had
>>
>> i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.
>>
>> trying to run R from the command line ? it is able to load adehabitat.
>>
>> seems to me a GUI.app problem
>>
>> ..  can you check if your adehabitat code runs fine starting R from command line ?
>>
>> thanks,
>>
>> Massimo.
>>
>>
>> Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>
>>> Dear Massimo
>>> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
>>>
>>> Best
>>> Els
>>>
>>> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
>>>
>>>> did you tried to install XQuartz ?
>>>>
>>>> http://xquartz.macosforge.org/landing/
>>>>
>>>> --Massimo.
>>>>
>>>>
>>>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>>>
>>>>> Dear list
>>>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>>>> Did anyone experience this before?
>>>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>>>>
>>>>>> sessionInfo()
>>>>> R version 2.15.2 (2012-10-26)
>>>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>>>>
>>>>> locale
>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> stats graphics grDevices utils datasets methods base
>>>>>> library(adehabitat)
>>>>> Loading required package: ade4
>>>>> Attaching package: 'ade4'
>>>>> The following objects are masked from 'package:base'
>>>>> within
>>>>> loading required package:tkrplot
>>>>> loading required package: tcltk
>>>>> Loading Tcl/Tk interface
>>>>>> sessionInfo()
>>>>>
>>>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>>>>
>>>>> Thanks for any help
>>>>> Els
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From jstruve at UFL.EDU  Tue Nov 27 17:34:26 2012
From: jstruve at UFL.EDU (Struve,Juliane)
Date: Tue, 27 Nov 2012 16:34:26 +0000
Subject: [R-sig-Geo] help with intersecting/aggregating multiple polygons
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A115821A5@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121127/bcf775bd/attachment.pl>

From hengl at spatial-analyst.net  Wed Nov 28 10:57:48 2012
From: hengl at spatial-analyst.net (hengl at spatial-analyst.net)
Date: Wed, 28 Nov 2012 09:57:48 -0000
Subject: [R-sig-Geo] AcademicTransfer vacancy link
Message-ID: <20121128095748.3182.89736@korma.gw20e.com>

hengl at spatial-analyst.net wants to bring a vacancy to your attention.

The user's message:
New research position at ISRIC. Knowledge of R not required but welcomed!

Click the following link to view the vacancy:

http://www.academictransfer.com/16419

Sincerely,
the AcademicTransfer team


From hengl at spatial-analyst.net  Wed Nov 28 10:53:02 2012
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 28 Nov 2012 10:53:02 +0100
Subject: [R-sig-Geo] Soil/Agricultural modeller position at ISRIC, Wageningen
Message-ID: <50B5DEFE.8080000@spatial-analyst.net>


For more info see: 
http://www.academictransfer.com/employer/WUR/vacancy/16419/lang/en/

Job description

A dedicated soil scientist, agricultural studies or physical geographer 
(MSc or PhD) who will support the aim of ISRIC to allow efficient 
exchange of soil data between soil scientists and the users community of 
global development issues and by adding the 4th dimension (time) to our 
soil information. Strong conceptual abilities are required to 
scientifically link these issues, especially the use of GIS and remote 
sensing information in combination with spatial and dynamic modelling. 
The candidate should have therefore experience in data management in 
combination with quantitative modelling of soil-water-plant processes, 
including soil formation processes, land-use change scenarios on 
degradation and modelling of carbon and water dynamics. Willingness to 
work in an international environment. Command of French or Spanish is an 
asset as well as flexibility and sensitivity to interact with multiple 
cultures.

Requirements

- Soil scientist or physical geographer (MSc or PhD)
- Experience in spatial database management, GIS and remote sensing
- Experience in dynamic modelling of soil- and landscape-related processes
- Experience in teaching or willingness to learn
- Experience in practical field research is an asset
- Good interpersonal, communication and writing skills.

Major duties:
- Develop soil-related modelling approaches to link thematic issues for 
efficient soil data exchange
- Develop methods to link remote sensing data, GIS and soil-water-crop 
modelling by adding the 4th dimension to soil data
- Understand methodologies for quantitative assessment of global 
thematic issues, including land and soil degradation, land productivity, 
availability and dynamics of soil water and carbon
- Support the development of user friendly toolkits for modelling.

Conditions of employment

Scale 10 with maximum salary of 3755.,- (Euro?s gross per month).
Social benefits including holiday and ?end of year? allowances.
Contract duration: 2 years, with annual renewal based on performance and 
possibility for extension
Maximum working hours per week: 38
Contract type: Temporary, 2 jaar

Organisation

Wageningen UR (University & Research centre)

ISRIC ? World Soil Information is an ICSU accredited World Data Centre 
and has a leading role in international projects aimed at developing a 
new soil map of the world. Awareness on the importance of soils in 
global developments has increased in the policy arena and society and it 
is now widely realized that soils play a key role in food production, 
climate change, maintenance of biodiversity, production of energy crops 
and the management of soil water. ISRIC is developing web-based systems 
to realize its mission and objectives. For more information see 
www.isric.org

Wageningen University & Research centre
Delivering a substantial contribution to the quality of life. That's our 
focus ? each and every day. Within our domain, healthy food and living 
environment, we search for answers to issues affecting society ? such as 
sustainable food production, climate change and alternative energy. Of 
course, we don?t do this alone. Every day, 6,500 people work on ?the 
quality of life?, turning ideas into reality, on a global scale.

Could you be one of these people? We give you the space you need.

For further information about working at Wageningen UR, take a look at 
www.wageningenur.nl/en/Jobs.htm.


-- 
T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001


From Paul.Harris at nuim.ie  Wed Nov 28 12:33:28 2012
From: Paul.Harris at nuim.ie (Paul Harris)
Date: Wed, 28 Nov 2012 11:33:28 +0000 (GMT)
Subject: [R-sig-Geo] Geographically weighted model workshop in April 2013 at
	the NCG Ireland
Message-ID: <93f7ca483aef40ba.50b5f688@nuim.ie>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/8995216a/attachment.pl>

From hughsturrock at hotmail.com  Wed Nov 28 16:20:34 2012
From: hughsturrock at hotmail.com (hughsturrock)
Date: Wed, 28 Nov 2012 07:20:34 -0800 (PST)
Subject: [R-sig-Geo] Least cost path
Message-ID: <1354116034680-7581785.post@n2.nabble.com>

Hi all, 

I am trying to model travel times to from any given point to its nearest
hospital (in rural Africa). I've been looking at doing this in ArcGIS and R
and it looks like if I can create a 'cost' raster, there are plenty of
functions like shortestPath in R {gdistance} and Cost Path in Arc that can
work this out. This is fine for factors like landcover, where the cost can
be assumed to be identical irrespective of which direction you are moving
through that pixel, but I'm having difficulty working out how I would asign
slope (from an elevation model) a cost given that the cost of a slope
depends on the direction of travel. Does anyone know of a way to model the
least costly path over an elevation raster which would account for the
direction of travel? That way I could look at both travel to and from the
hospital..
 
Thanks! 
Hugh 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Least-cost-path-tp7581785.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jacobvanetten at yahoo.com  Wed Nov 28 17:19:45 2012
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Wed, 28 Nov 2012 16:19:45 +0000 (GMT)
Subject: [R-sig-Geo] Least cost path
In-Reply-To: <1354116034680-7581785.post@n2.nabble.com>
References: <1354116034680-7581785.post@n2.nabble.com>
Message-ID: <1354119585.30845.YahooMailNeo@web29701.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/e3ad802c/attachment.pl>

From hughsturrock at hotmail.com  Wed Nov 28 18:40:47 2012
From: hughsturrock at hotmail.com (hughsturrock)
Date: Wed, 28 Nov 2012 09:40:47 -0800 (PST)
Subject: [R-sig-Geo] Least cost path
In-Reply-To: <1354119585.30845.YahooMailNeo@web29701.mail.ird.yahoo.com>
References: <1354116034680-7581785.post@n2.nabble.com>
	<1354119585.30845.YahooMailNeo@web29701.mail.ird.yahoo.com>
Message-ID: <1354124447953-7581788.post@n2.nabble.com>

Great, thanks everyone. Very helpful!



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Least-cost-path-tp7581785p7581788.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Nov 28 20:18:30 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Nov 2012 11:18:30 -0800
Subject: [R-sig-Geo] Writing a rasterBrick into a single NetCDF file
In-Reply-To: <CAGBzUO8jhZFVMEBcM6n9-x8KZUZr=MsvD6aVG3-77BXg6vRidg@mail.gmail.com>
References: <CAGBzUO8jhZFVMEBcM6n9-x8KZUZr=MsvD6aVG3-77BXg6vRidg@mail.gmail.com>
Message-ID: <CANtt_hztDjBUJX1736Bk3KUb_Cnj6O_6Cm=H=co+ySFBAKyj-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/9d519790/attachment.pl>

From r.hijmans at gmail.com  Wed Nov 28 20:22:50 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Nov 2012 11:22:50 -0800
Subject: [R-sig-Geo] warning: size of values file does not match the
 number of cell
In-Reply-To: <CAGBzUO8ipXMvm4pGsG1+V_9FQ6_hmPe5-HhScVkowJmuio1KqQ@mail.gmail.com>
References: <CAGBzUO8ipXMvm4pGsG1+V_9FQ6_hmPe5-HhScVkowJmuio1KqQ@mail.gmail.com>
Message-ID: <CANtt_hzrZdNyzf-QAR06wBE5XYGu8CaJw4pMpu3Lai6WmPXXiA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/155af4cd/attachment.pl>

From r.hijmans at gmail.com  Wed Nov 28 20:25:36 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Nov 2012 11:25:36 -0800
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>
	<CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>
	<DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>
Message-ID: <CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/2ef36024/attachment.pl>

From r.hijmans at gmail.com  Wed Nov 28 20:32:59 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Nov 2012 11:32:59 -0800
Subject: [R-sig-Geo] Faster way of calculating the mean of multiple
	ascii files?
In-Reply-To: <50B38FF3.50107@lmu.de>
References: <50B38FF3.50107@lmu.de>
Message-ID: <CANtt_hw24Bg984zPe9jsEXQ_sy9Ch56RR=yXi2f+k-4SFvMOsA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/2bec7ef7/attachment.pl>

From aren at arencambre.com  Thu Nov 29 03:15:29 2012
From: aren at arencambre.com (Aren Cambre)
Date: Wed, 28 Nov 2012 20:15:29 -0600
Subject: [R-sig-Geo] Determining changes in events counts along paths
Message-ID: <CAA1mBrqvciDPhQ6j6i7eo6TYFmyf5Xr8em39AMX+3m3T48yX-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121128/60e365bd/attachment.pl>

From educheyne at avia-gis.be  Thu Nov 29 09:19:59 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Thu, 29 Nov 2012 09:19:59 +0100
Subject: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
In-Reply-To: <50B4E97B.2070306@ase-research.org>
References: <25EFE991-FA10-4141-8E76-53509B4099B8@avia-gis.be>
	<988A7D7C-F2A3-49B6-9A47-A2E4E40273EE@gmail.com>
	<9173EBEF-F8EC-445E-8A22-879C5297F931@avia-gis.be>
	<28667216-6908-4A9B-A0C5-81EBECD7E18E@rpi.edu>
	<FF130CFA-DC02-4871-ADB5-E74F7F3B6A1D@avia-gis.be>
	<50B4E97B.2070306@ase-research.org>
Message-ID: <729C9E16-0F5A-4C23-9D22-A59BF2241D26@avia-gis.be>

Dear Mathieu and Massimo
Yes, that did the trick, installation of the framework solved the issue both on command line as in R GUI
Thanks for the help.

Could this be added to the documentation of the packages (the same issue occurs with adehabitatHS)

Best and thanks again
Els
On 27 Nov 2012, at 17:25, Mathieu Basille <basille at ase-research.org> wrote:

> Dear Els,
> 
> I can't really help on the Mac OS issue with tcl/tk since I'm using Linux. However, as the command line warning tells you, you'd better use 'adehabitatHS' [1] now, instead of the old 'adehabitat', which is no longer developed (bug fixes are added, but no new methods). I don't think it will solve your problem, though, but I really recommend to upgrade. Besides, you might want to have a look at the MADIFA instead of the ENFA. See [2] for further details.
> 
> Best,
> Mathieu Basille.
> 
> 
> [1] http://cran.r-project.org/web/packages/adehabitatHS/index.html
> 
> [2] Calenge, C.; Darmon, G.; Basille, M.; Loison, A. & Jullien, J.-M. (2008) The factorial decomposition of the Mahalanobis distances in habitat selection studies. Ecology, 89: 555-566 doi 10.1890/06-1750.1
> 
> 
> Le 27/11/2012 10:57, Els Ducheyne a ?crit :
>> Dear Massimo
>> yes it works from command line, I do get a warning about the tcl tk though, so indeed this must be the source of the problem (see below)
>> The good news is that at least I can carry out the code via the terminal if necessary (even it is not with the R Gui)
>> Still hoping for a fix though
>> Els
>> 
>> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
>> Copyright (C) 2012 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>> 
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>> 
>>   Natural language support but running in an English locale
>> 
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>> 
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>> 
>> [Previously saved workspace restored]
>> 
>>> library(adehabitat)
>> Loading required package: ade4
>> 
>> Attaching package: ?ade4?
>> 
>> The following object(s) are masked from ?package:base?:
>> 
>>     within
>> 
>> Loading required package: tkrplot
>> Loading required package: tcltk
>> Loading Tcl/Tk interface ... done
>> Loading required package: shapefiles
>> Loading required package: foreign
>> 
>> Attaching package: ?shapefiles?
>> 
>> The following object(s) are masked from ?package:foreign?:
>> 
>>     read.dbf, write.dbf
>> 
>> Be careful: it is now recommended to use the newpackages adehabitatMA, adehabitatLT, adehabitatHR, and adehabitatHS.
>> These 4 packages are intended to become the future of adehabitat.
>> The "classical" version of adehabitat will still be maintained for some
>> time, but no new method will be added to the package.
>> 
>> Warning message:
>> In fun(libname, pkgname) :
>>   Can't find a usable tk.tcl in the following directories:
>>     /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5/Resources/Scripts /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5/Resources/Scripts ./lib/tk8.5 ./lib/tk8.5/Resources/Scripts ~/Library/Tcl/tk8.5 ~/Library/Tcl/tk8.5/Resources/Scripts /Library/Tcl/tk8.5 /Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/tk8.5 /System/Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/8.5/tk8.5 /System/Library/Tcl/8.5/tk8.5/Resources/Scripts ~/Library/Frameworks/tk8.5 ~/Library/Frameworks/tk8.5/Resources/Scripts /Library/Frameworks/tk8.5 /Library/Frameworks/tk8.5/Resources/Scripts /System/Library/Frameworks/tk8.5 /System/Library/Frameworks/tk8.5/Resources/Scripts ./library
>> 
>> 
>> 
>> This probably means that tk wasn't installed properly.
>>> sessionInfo()
>> R version 2.15.2 (2012-10-26)
>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>> 
>> locale:
>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>> 
>> attached base packages:
>> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
>> [8] base
>> 
>> other attached packages:
>> [1] adehabitat_1.8.11 shapefiles_0.6    foreign_0.8-51    tkrplot_0.0-23
>> [5] ade4_1.4-17
>>> 
>> 
>> On 27 Nov 2012, at 16:42, rpi <distem at rpi.edu> wrote:
>> 
>>> Els,
>>> 
>>> i tried to run adehabitat form inside the Gui.app (64 bit) using R
>>> (installed from Homebrew )
>>> 
>>> .. and i got the same problem you had
>>> 
>>> i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.
>>> 
>>> trying to run R from the command line ? it is able to load adehabitat.
>>> 
>>> seems to me a GUI.app problem
>>> 
>>> ..  can you check if your adehabitat code runs fine starting R from command line ?
>>> 
>>> thanks,
>>> 
>>> Massimo.
>>> 
>>> 
>>> Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>> 
>>>> Dear Massimo
>>>> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
>>>> 
>>>> Best
>>>> Els
>>>> 
>>>> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
>>>> 
>>>>> did you tried to install XQuartz ?
>>>>> 
>>>>> http://xquartz.macosforge.org/landing/
>>>>> 
>>>>> --Massimo.
>>>>> 
>>>>> 
>>>>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>>>> 
>>>>>> Dear list
>>>>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>>>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>>>>> Did anyone experience this before?
>>>>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>>>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>>>>> 
>>>>>>> sessionInfo()
>>>>>> R version 2.15.2 (2012-10-26)
>>>>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>>>>> 
>>>>>> locale
>>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>>> 
>>>>>> attached base packages:
>>>>>> stats graphics grDevices utils datasets methods base
>>>>>>> library(adehabitat)
>>>>>> Loading required package: ade4
>>>>>> Attaching package: 'ade4'
>>>>>> The following objects are masked from 'package:base'
>>>>>> within
>>>>>> loading required package:tkrplot
>>>>>> loading required package: tcltk
>>>>>> Loading Tcl/Tk interface
>>>>>>> sessionInfo()
>>>>>> 
>>>>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>>>>> 
>>>>>> Thanks for any help
>>>>>> Els
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> 
> ~$ whoami
> Mathieu Basille, PhD
> 
> ~$ locate --details
> University of Florida \\
> Fort Lauderdale Research and Education Center
> (+1) 954-577-6314
> http://ase-research.org/basille
> 
> ~$ fortune
> ? Le tout est de tout dire, et je manque de mots
> Et je manque de temps, et je manque d'audace. ?
> -- Paul ?luard


From alfios17 at hotmail.com  Thu Nov 29 10:15:24 2012
From: alfios17 at hotmail.com (Lorenzo Alfieri)
Date: Thu, 29 Nov 2012 10:15:24 +0100
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw@mail.gmail.com>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>,
	<CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>,
	<DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>,
	<CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw@mail.gmail.com>
Message-ID: <DUB107-W649F6E7FC94975EE3E9E28D75C0@phx.gbl>


Hi Robert,
I was hoping to use the overlay function too, but it seems it doesn't work in this case. See the result:

CRPS? <- overlay(obs, pred, fun=function(x,y) crps(x,y)$crps)

Error in function (x, fun, filename = "", recycle = TRUE, ...)? : 
? cannot use this formula, probably because it is not vectorized

Lorenzo



Date: Wed, 28 Nov 2012 11:25:36 -0800
Subject: Re: [R-sig-Geo] calculate CRPS on rasters
From: r.hijmans at gmail.com
To: alfios17 at hotmail.com
CC: etiennebr at gmail.com; r-sig-geo at r-project.org

Lorenzo,
Given that solution, I think you can also express this?(in a memory-safe fashion)?like this :
CRPS??<- overlay(obs, pred, fun=function(x,y) crps(x, y)$crps)

Robert

On Tue, Nov 27, 2012 at 3:11 AM, Lorenzo Alfieri <alfios17 at hotmail.com> wrote:




Etienne,

thank you for the tip

Now it runs trough, by using



CRPS <- raster(ncol=10, nrow=10)

CRPS[] <- crps(obs[],pred[])$crps



Lorenzo





Date: Mon, 26 Nov 2012 21:37:13 -0500

Subject: Re: [R-sig-Geo] calculate CRPS on rasters

From: etiennebr at gmail.com

To: alfios17 at hotmail.com

CC: r-sig-geo at r-project.org



Lorenzo,



I don't know about your specific function, but you can access matrix using the []'s. So maybe something like :

CRPS <- raster(ncol=10, nrow=10)

CRPS[] <- crps(obs[],pred[])





Etienne



2012/11/26 Lorenzo Alfieri <alfios17 at hotmail.com>



CRPS <- raster(ncol=10, nrow=10)



for (i in 1:length(obs)){



? CRPS[i] <- crps(obs[i],pred[i])$CRPS



? ? ? ? [[alternative HTML version deleted]]



_______________________________________________

R-sig-Geo mailing list

R-sig-Geo at r-project.org

https://stat.ethz.ch/mailman/listinfo/r-sig-geo


 		 	   		  

From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Thu Nov 29 19:31:32 2012
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien.Ferland-Raymond at mrn.gouv.qc.ca)
Date: Thu, 29 Nov 2012 13:31:32 -0500
Subject: [R-sig-Geo] Problem with update gdistance 1.1-3
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B901A8245D006B@HARFANG.intranet.mrn.gouv>

Hello,

I want to expose a problem I am now facing with the gdistance package and the geoCorrection() function.

I have a code I haven't been using since March, and now, after updating R to 2.15.2 and the package gdistance to 1.1-3 from 1.1-2, the geoCorrection() function doesn't work.  It simply runs forever without giving any result.

My code is fine, as I tested it with my old computer still running R 2.15.0 and gdistance 1.1-2 and it does the task in 15 seconds.  The problem is really with the 1.1-3 version of gdistance.

## here a simple example of my code.
##  download le Rdata: https://www.dropbox.com/s/mo51vgft3fsmm5y/transi.RDATA

load("transi.Rdata")
library(gdistance)

transi <- transition(ras,transitionFunction=max, directions=8,symm=T) transi <- geoCorrection(transi)

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: i386-w64-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252 [3] LC_MONETARY=French_Canada.1252 LC_NUMERIC=C [5] LC_TIME=French_Canada.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] gdistance_1.1-3 Matrix_1.0-9    lattice_0.20-10 igraph0_0.5.5-3
[5] raster_2.0-31   sp_1.0-2

loaded via a namespace (and not attached):
[1] grid_2.15.2  tools_2.15.2

##########


I've tried it on win XP and windows 7,  32 and 64 bits, still the same problem.

I would be happy if somebody could fix it.

Thanks

Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
Division des orientations et projets sp?ciaux
Direction des inventaires forestiers
Minist?re des Ressources naturelles


From r.hijmans at gmail.com  Thu Nov 29 19:34:36 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 29 Nov 2012 10:34:36 -0800
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <DUB107-W649F6E7FC94975EE3E9E28D75C0@phx.gbl>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>
	<CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>
	<DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>
	<CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw@mail.gmail.com>
	<DUB107-W649F6E7FC94975EE3E9E28D75C0@phx.gbl>
Message-ID: <CANtt_hx-yw9ngJZ3LxHRy=KpN8V6dtMy3R=LsQojf0f-XMeOSw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121129/3d307c7c/attachment.pl>

From faranakfathi at gmail.com  Thu Nov 29 20:19:27 2012
From: faranakfathi at gmail.com (Faranak)
Date: Thu, 29 Nov 2012 11:19:27 -0800 (PST)
Subject: [R-sig-Geo] Gibbs Point Process
Message-ID: <1354216767176-7581798.post@n2.nabble.com>

Does anyone knows what is the aim of using Gibbs marked point process?! I
read a paper that used this method to find the best configuration of
locations of trees in a forest. But I'm wondering if we know the best
configuration what can we do with that (As we cannot change the locations!).
Thanks 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Gibbs-Point-Process-tp7581798.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Nov 29 20:39:33 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 29 Nov 2012 11:39:33 -0800
Subject: [R-sig-Geo] warning: size of values file does not match the
 number of cell
In-Reply-To: <CAGBzUO8tbMH198Hw_RSdZE0GAFLoWVpeH_Wu0g77uaSDsAJVBQ@mail.gmail.com>
References: <CAGBzUO8ipXMvm4pGsG1+V_9FQ6_hmPe5-HhScVkowJmuio1KqQ@mail.gmail.com>
	<CANtt_hzrZdNyzf-QAR06wBE5XYGu8CaJw4pMpu3Lai6WmPXXiA@mail.gmail.com>
	<CAGBzUO8tbMH198Hw_RSdZE0GAFLoWVpeH_Wu0g77uaSDsAJVBQ@mail.gmail.com>
Message-ID: <CANtt_hxYsdMNLCRtq_io4H8CuXG_T_oN6wuC+aTmY+oJmP_AqQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121129/8b78e213/attachment.pl>

From wrbuckin at wisc.edu  Thu Nov 29 21:17:18 2012
From: wrbuckin at wisc.edu (Bill Buckingham)
Date: Thu, 29 Nov 2012 14:17:18 -0600
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 111, Issue 27
Message-ID: <crr9gm8o79dkpvutgtpq19ic.1354220238368@email.android.com>



r-sig-geo-request at r-project.org wrote:

>Send R-sig-Geo mailing list submissions to
>	r-sig-geo at r-project.org
>
>To subscribe or unsubscribe via the World Wide Web, visit
>	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>or, via email, send a message with subject or body 'help' to
>	r-sig-geo-request at r-project.org
>
>You can reach the person managing the list at
>	r-sig-geo-owner at r-project.org
>
>When replying, please edit your Subject line so it is more specific
>than "Re: Contents of R-sig-Geo digest..."
>
>
>Today's Topics:
>
>   1. Soil/Agricultural modeller position at ISRIC, Wageningen
>      (Tomislav Hengl)
>   2. Geographically weighted model workshop in April 2013 at	the
>      NCG Ireland (Paul Harris)
>   3. Least cost path (hughsturrock)
>   4. Re: Least cost path (Jacob van Etten)
>   5. Re: Least cost path (hughsturrock)
>   6. Re: Writing a rasterBrick into a single NetCDF file
>      (Robert J. Hijmans)
>   7. Re: warning: size of values file does not match the number of
>      cell (Robert J. Hijmans)
>   8. Re: calculate CRPS on rasters (Robert J. Hijmans)
>   9. Re: Faster way of calculating the mean of multiple	ascii
>      files? (Robert J. Hijmans)
>  10. Determining changes in events counts along paths (Aren Cambre)
>  11. Re: Adehabitat crashed R on MacOS 2.15.2 (Els Ducheyne)
>  12. Re: calculate CRPS on rasters (Lorenzo Alfieri)
>
>
>----------------------------------------------------------------------
>
>Message: 1
>Date: Wed, 28 Nov 2012 10:53:02 +0100
>From: Tomislav Hengl <hengl at spatial-analyst.net>
>To: R-sig-Geo at r-project.org
>Subject: [R-sig-Geo] Soil/Agricultural modeller position at ISRIC,
>	Wageningen
>Message-ID: <50B5DEFE.8080000 at spatial-analyst.net>
>Content-Type: text/plain; charset=UTF-8; format=flowed
>
>
>For more info see: 
>http://www.academictransfer.com/employer/WUR/vacancy/16419/lang/en/
>
>Job description
>
>A dedicated soil scientist, agricultural studies or physical geographer 
>(MSc or PhD) who will support the aim of ISRIC to allow efficient 
>exchange of soil data between soil scientists and the users community of 
>global development issues and by adding the 4th dimension (time) to our 
>soil information. Strong conceptual abilities are required to 
>scientifically link these issues, especially the use of GIS and remote 
>sensing information in combination with spatial and dynamic modelling. 
>The candidate should have therefore experience in data management in 
>combination with quantitative modelling of soil-water-plant processes, 
>including soil formation processes, land-use change scenarios on 
>degradation and modelling of carbon and water dynamics. Willingness to 
>work in an international environment. Command of French or Spanish is an 
>asset as well as flexibility and sensitivity to interact with multiple 
>cultures.
>
>Requirements
>
>- Soil scientist or physical geographer (MSc or PhD)
>- Experience in spatial database management, GIS and remote sensing
>- Experience in dynamic modelling of soil- and landscape-related processes
>- Experience in teaching or willingness to learn
>- Experience in practical field research is an asset
>- Good interpersonal, communication and writing skills.
>
>Major duties:
>- Develop soil-related modelling approaches to link thematic issues for 
>efficient soil data exchange
>- Develop methods to link remote sensing data, GIS and soil-water-crop 
>modelling by adding the 4th dimension to soil data
>- Understand methodologies for quantitative assessment of global 
>thematic issues, including land and soil degradation, land productivity, 
>availability and dynamics of soil water and carbon
>- Support the development of user friendly toolkits for modelling.
>
>Conditions of employment
>
>Scale 10 with maximum salary of 3755.,- (Euro?s gross per month).
>Social benefits including holiday and ?end of year? allowances.
>Contract duration: 2 years, with annual renewal based on performance and 
>possibility for extension
>Maximum working hours per week: 38
>Contract type: Temporary, 2 jaar
>
>Organisation
>
>Wageningen UR (University & Research centre)
>
>ISRIC ? World Soil Information is an ICSU accredited World Data Centre 
>and has a leading role in international projects aimed at developing a 
>new soil map of the world. Awareness on the importance of soils in 
>global developments has increased in the policy arena and society and it 
>is now widely realized that soils play a key role in food production, 
>climate change, maintenance of biodiversity, production of energy crops 
>and the management of soil water. ISRIC is developing web-based systems 
>to realize its mission and objectives. For more information see 
>www.isric.org
>
>Wageningen University & Research centre
>Delivering a substantial contribution to the quality of life. That's our 
>focus ? each and every day. Within our domain, healthy food and living 
>environment, we search for answers to issues affecting society ? such as 
>sustainable food production, climate change and alternative energy. Of 
>course, we don?t do this alone. Every day, 6,500 people work on ?the 
>quality of life?, turning ideas into reality, on a global scale.
>
>Could you be one of these people? We give you the space you need.
>
>For further information about working at Wageningen UR, take a look at 
>www.wageningenur.nl/en/Jobs.htm.
>
>
>-- 
>T. Hengl
>http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001
>
>
>
>------------------------------
>
>Message: 2
>Date: Wed, 28 Nov 2012 11:33:28 +0000 (GMT)
>From: Paul Harris <Paul.Harris at nuim.ie>
>To: R-sig-Geo at r-project.org
>Subject: [R-sig-Geo] Geographically weighted model workshop in April
>	2013 at	the NCG Ireland
>Message-ID: <93f7ca483aef40ba.50b5f688 at nuim.ie>
>Content-Type: text/plain
>
>Dear list
>  We are pleased to announce a three-day workshop on
>  Geographically Weighted Modelling in R
>  being run at the National Centre for Geocomputation, National University of Ireland Maynooth on 24-26 April 2013.
>  For details see
>http://ncg.nuim.ie/redir.php?action=events/20130424
>  Instructors  for the course are: Martin Charlton, Chris Brunsdon (Liverpool  University), Binbin Lu, Isabella Gollini and Paul Harris.
>  For queries and to register for the course - please contact Paul Harris - paul.harris at nuim.ie  - before 31 March 2013.
>  Places are on a 'first come first serve' basis.
>  cheers Paul
>
>
>Paul Harris,
>
>National Centre for Geocomputation,
>
>National University of Ireland,
>
>Maynooth,
>
>Co Kildare.
>
>Tel: 00353- 0 1-7086204
>
>Fax: 00353- 0 1-7086456
>
>
>
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 3
>Date: Wed, 28 Nov 2012 07:20:34 -0800 (PST)
>From: hughsturrock <hughsturrock at hotmail.com>
>To: r-sig-geo at r-project.org
>Subject: [R-sig-Geo] Least cost path
>Message-ID: <1354116034680-7581785.post at n2.nabble.com>
>Content-Type: text/plain; charset=us-ascii
>
>Hi all, 
>
>I am trying to model travel times to from any given point to its nearest
>hospital (in rural Africa). I've been looking at doing this in ArcGIS and R
>and it looks like if I can create a 'cost' raster, there are plenty of
>functions like shortestPath in R {gdistance} and Cost Path in Arc that can
>work this out. This is fine for factors like landcover, where the cost can
>be assumed to be identical irrespective of which direction you are moving
>through that pixel, but I'm having difficulty working out how I would asign
>slope (from an elevation model) a cost given that the cost of a slope
>depends on the direction of travel. Does anyone know of a way to model the
>least costly path over an elevation raster which would account for the
>direction of travel? That way I could look at both travel to and from the
>hospital..
> 
>Thanks! 
>Hugh 
>
>
>
>--
>View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Least-cost-path-tp7581785.html
>Sent from the R-sig-geo mailing list archive at Nabble.com.
>
>
>
>------------------------------
>
>Message: 4
>Date: Wed, 28 Nov 2012 16:19:45 +0000 (GMT)
>From: Jacob van Etten <jacobvanetten at yahoo.com>
>To: hughsturrock <hughsturrock at hotmail.com>,	"r-sig-geo at r-project.org"
>	<r-sig-geo at r-project.org>
>Subject: Re: [R-sig-Geo] Least cost path
>Message-ID:
>	<1354119585.30845.YahooMailNeo at web29701.mail.ird.yahoo.com>
>Content-Type: text/plain
>
>Dear Hugh,
>
>Take a look at the gdistance vignette, example 1.
>
>Best,
>
>Jacob.
>
>
>________________________________
> From: hughsturrock <hughsturrock at hotmail.com>
>To: r-sig-geo at r-project.org 
>Sent: Wednesday, 28 November 2012, 10:20
>Subject: [R-sig-Geo] Least cost path
>
>Hi all, 
>
>I am trying to model travel times to from any given point to its nearest
>hospital (in rural Africa). I've been looking at doing this in ArcGIS and R
>and it looks like if I can create a 'cost' raster, there are plenty of
>functions like shortestPath in R {gdistance} and Cost Path in Arc that can
>work this out. This is fine for factors like landcover, where the cost can
>be assumed to be identical irrespective of which direction you are moving
>through that pixel, but I'm having difficulty working out how I would asign
>slope (from an elevation model) a cost given that the cost of a slope
>depends on the direction of travel. Does anyone know of a way to model the
>least costly path over an elevation raster which would account for the
>direction of travel? That way I could look at both travel to and from the
>hospital..
>
>Thanks! 
>Hugh 
>
>
>
>--
>View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Least-cost-path-tp7581785.html
>Sent from the R-sig-geo mailing list archive at Nabble.com.
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 5
>Date: Wed, 28 Nov 2012 09:40:47 -0800 (PST)
>From: hughsturrock <hughsturrock at hotmail.com>
>To: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] Least cost path
>Message-ID: <1354124447953-7581788.post at n2.nabble.com>
>Content-Type: text/plain; charset=us-ascii
>
>Great, thanks everyone. Very helpful!
>
>
>
>--
>View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Least-cost-path-tp7581785p7581788.html
>Sent from the R-sig-geo mailing list archive at Nabble.com.
>
>
>
>------------------------------
>
>Message: 6
>Date: Wed, 28 Nov 2012 11:18:30 -0800
>From: "Robert J. Hijmans" <r.hijmans at gmail.com>
>To: Mark Payne <markpayneatwork at gmail.com>
>Cc: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] Writing a rasterBrick into a single NetCDF
>	file
>Message-ID:
>	<CANtt_hztDjBUJX1736Bk3KUb_Cnj6O_6Cm=H=co+ySFBAKyj-Q at mail.gmail.com>
>Content-Type: text/plain
>
>Mark,
>That is a good suggestion that I will implement.
>Thanks,
>Robert
>
>On Tue, Nov 27, 2012 at 3:56 AM, Mark Payne <markpayneatwork at gmail.com>wrote:
>
>> Hi,
>>
>> I have a rasterStack with several layers. I would like to write this
>> into a single NetCDF file, where each layer is stored as a variable.
>> Is there anyway that this can be done? At the moment (raster 2.0-31),
>> the layers are written as a third dimension, rather than than as
>> separate variables. I can see situations where people might want to do
>> both, so maybe an options switch to writeRaster could be a good
>> solution?
>>
>> Cheers,
>> Mark
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 7
>Date: Wed, 28 Nov 2012 11:22:50 -0800
>From: "Robert J. Hijmans" <r.hijmans at gmail.com>
>To: Mark Payne <markpayneatwork at gmail.com>
>Cc: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] warning: size of values file does not match
>	the number of cell
>Message-ID:
>	<CANtt_hzrZdNyzf-QAR06wBE5XYGu8CaJw4pMpu3Lai6WmPXXiA at mail.gmail.com>
>Content-Type: text/plain
>
>Mark,
>
>It means that aggregate create a temporary file (because it is a large
>dataset) that is not correct. Given then number of cells and the datatype,
>the file should have a certain size, which apparently it has not. A common
>cause of this is a full disk (temp folder) which you can perhaps fix with
>removeTmpFiles.
>It could be because of a bug in aggregate. It could be a false alarm.  Can
>yo send me the print of  "min.bath" and of "file.info
>(filename(min.bath))$size"
>
>Robert
>
>
>On Tue, Nov 27, 2012 at 3:37 AM, Mark Payne <markpayneatwork at gmail.com>wrote:
>
>> Hi,
>>
>> I have a large raster file (netcdf) that I am trying to process ie
>>
>> > bathr
>> class       : RasterLayer
>> dimensions  : 10800, 21600, 233280000  (nrow, ncol, ncell)
>> resolution  : 0.01666667, 0.01666667  (x, y)
>> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> data source : /work/up/common/bathymetry/ETOPO1/ETOPO1_Ice_c_gmt4.nc
>> names       : z
>> values      : -10803, 8333  (min, max)
>> zvar        : z
>>
>> Processing this with aggregate() gives the following warning:
>>
>> > min.bath <- aggregate(bathr,fact=out.agg,fun=min,expand=FALSE)
>> Warning message:
>> In .rasterFromRasterFile(grdfile, band = band, objecttype) :
>>   size of values file does not match the number of cells (given the data
>> type)
>>
>> What does this warning mean? I've seen previously on the list that
>> there was a bug associated with this warning - the message has only
>> appeared for me since upgrading from about raster 2.0-12 (can't
>> remember the exact version, unfortunately) to 2.0-31.
>>
>> Best wishes,
>>
>> Mark
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 8
>Date: Wed, 28 Nov 2012 11:25:36 -0800
>From: "Robert J. Hijmans" <r.hijmans at gmail.com>
>To: Lorenzo Alfieri <alfios17 at hotmail.com>
>Cc: R-sig-geo_Forum <r-sig-geo at r-project.org>
>Subject: Re: [R-sig-Geo] calculate CRPS on rasters
>Message-ID:
>	<CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw at mail.gmail.com>
>Content-Type: text/plain
>
>Lorenzo,
>
>Given that solution, I think you can also express this (in a memory-safe
>fashion) like this :
>
>CRPS  <- overlay(obs, pred, fun=function(x,y) crps(x, y)$crps)
>
>Robert
>
>On Tue, Nov 27, 2012 at 3:11 AM, Lorenzo Alfieri <alfios17 at hotmail.com>wrote:
>
>>
>> Etienne,
>> thank you for the tip
>> Now it runs trough, by using
>>
>> CRPS <- raster(ncol=10, nrow=10)
>> CRPS[] <- crps(obs[],pred[])$crps
>>
>> Lorenzo
>>
>>
>> Date: Mon, 26 Nov 2012 21:37:13 -0500
>> Subject: Re: [R-sig-Geo] calculate CRPS on rasters
>> From: etiennebr at gmail.com
>> To: alfios17 at hotmail.com
>> CC: r-sig-geo at r-project.org
>>
>> Lorenzo,
>>
>> I don't know about your specific function, but you can access matrix using
>> the []'s. So maybe something like :
>> CRPS <- raster(ncol=10, nrow=10)
>> CRPS[] <- crps(obs[],pred[])
>>
>>
>> Etienne
>>
>> 2012/11/26 Lorenzo Alfieri <alfios17 at hotmail.com>
>>
>> CRPS <- raster(ncol=10, nrow=10)
>>
>> for (i in 1:length(obs)){
>>
>>   CRPS[i] <- crps(obs[i],pred[i])$CRPS
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 9
>Date: Wed, 28 Nov 2012 11:32:59 -0800
>From: "Robert J. Hijmans" <r.hijmans at gmail.com>
>To: Swen Meyer <s.meyer at lmu.de>
>Cc: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] Faster way of calculating the mean of
>	multiple	ascii files?
>Message-ID:
>	<CANtt_hw24Bg984zPe9jsEXQ_sy9Ch56RR=yXi2f+k-4SFvMOsA at mail.gmail.com>
>Content-Type: text/plain
>
>Swen,
>
>You do not provide much info (e.g. system.time() ) so I do not know where
>the bottleneck is. It could be in the call to "stack" which you can speed
>up with "quick=TRUE" (if you are sure that the rasters all line up). It
>could also be that the bottleneck is reading the data from file.
>Using ASCII is not a good idea (slow) in this type of application.
>If you have enough RAM, you might try reading all files in one step,
>instead of blocks:
>
>X_01 <- stack(Files[which(substring(**Files,(nchar(Files)-9),nchar(**
>Files)-6)==i)])
>X_01 <- readAll(X_01)  # this will fail if you have insufficient RAM
>X_01_sum <- mean((X_01))
>
>Robert
>
>
>
>On Mon, Nov 26, 2012 at 7:51 AM, Swen Meyer <s.meyer at lmu.de> wrote:
>
>> Dear All,
>> I?m trying to process a couple of ascii grids (daily grids): size of one
>> grid (344kb). the header of the ascii grids look like this:
>> ncols 288
>> nrows 199
>> xllcorner 506255
>> yllcorner 4.35899e+006
>> cellsize 30
>>
>> I have daily grids over 30 years and I like to find a fast way of
>> calculating the monthly means for every month of those 30 years:
>> the file structure is like this: grid1: "sb05_dem30m_20410101.024"
>> grid2: "sb05_dem30m_20410102.024"
>> grid3: "sb05_dem30m_20410103.024"
>> ...
>> gridn: "sb05_dem30m_YYYYMMdd.024"
>> ...
>> last grid: "sb05_dem30m_20701231.024"
>>
>> At the moment I?using R Vers. 2.15.1 on a Intel PC i5 CPU 760@ 2.80GHz
>> 2.80GHz with 4GB RAM Windows7, and the raster package and this is my script:
>> library(raster)
>>
>> setwd("G:\\hydro_modelling\\**Sardinia\\Wasim\\**RioCostara30m\\KNMI_REF\\
>> **output30m\\RUN2\\UNSATZON\\")
>> Path="G:\\hydro_modelling\\**Sardinia\\Wasim\\**RioCostara30m\\KNMI_REF\\*
>> *output30m\\RUN2\\SOILMOIST\\"
>>
>>
>> x="sb05_dem30m_"
>> #list files of folder with string x
>> Files=list.files(pattern=x)
>> # select files to process
>> Files=Files[which((substring(**Files,nchar(Files)-3,nchar(**
>> Files)))==".024")]
>>
>> for( i in unique(substring(Files,(nchar(**Files)-9),nchar(Files)-6))){
>> print(i)
>> #stack files
>> X_01 <- stack(Files[which(substring(**Files,(nchar(Files)-9),nchar(**
>> Files)-6)==i)])
>> #mean the grid with raster package
>> X_01_sum <- mean((X_01))
>> #Write monthly mean asci grid
>> writeRaster(X_01_sum, filename=paste(Path,"**
>> SoilMoisture_RM_Mean_",i,sep="**"), "ascii")
>> }
>>
>> The script works, but it takes more than 30 min until the grids are
>> precessed. Does anyone know of a faster way of meaning (summing) those
>> grids and exporting them as a asci again?
>> Best regards and thank you in advance,
>> Swen
>>
>> --
>> ------------------------------**------------------------------**--
>> Dipl. - Geogr. Swen Meyer
>> Department of Geography
>> Physical Geography and Environmental Modeling Ludwig-Maximilian University
>> of Munich
>>
>> Luisenstrasse 37
>> 80333 Munich/Germany
>> fon: +49 (0)89 2180-6665
>> fax: +49 (0)89 2180-6675
>> email: s.meyer at lmu.de
>> web: www.geographie.uni-muenchen.de
>>
>> ______________________________**_________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 10
>Date: Wed, 28 Nov 2012 20:15:29 -0600
>From: Aren Cambre <aren at arencambre.com>
>To: r-sig-geo at r-project.org
>Subject: [R-sig-Geo] Determining changes in events counts along paths
>Message-ID:
>	<CAA1mBrqvciDPhQ6j6i7eo6TYFmyf5Xr8em39AMX+3m3T48yX-g at mail.gmail.com>
>Content-Type: text/plain
>
>I have a road network and a set of events that occurs on the road network.
>
>I want to spot areas where there are significant changes in the amount of
>these events over time.
>
>I have proposed dividing the map into a grid and comparing event counts in
>each square between successive time periods. For example, I could use a
>grid with 1000 meter x 1000 meter squares and do a month-by-month
>comparison.
>
>This might be "good enough", but it still has two weaknesses:
>
>   1. A significant change in events could be diluted if the "center of
>   mass" of these events' locations or times lies near a grid boundary or near
>   the time division.
>   2. The grid size has to be a compromise between being large enough to
>   catch clusters of events yet small enough to not include too many unrelated
>   roadways.
>
>I think a better approach would be one that traverses paths and is able to
>organically spot these areas of changes over time. Another might be to
>overlay an offset grid and offset time over the original data to overcome
>the problem I identified in #1, although the end effect may not be much
>different than smaller grid and time slices.
>
>Any thoughts on this?
>
>Aren
>
>	[[alternative HTML version deleted]]
>
>
>
>------------------------------
>
>Message: 11
>Date: Thu, 29 Nov 2012 09:19:59 +0100
>From: Els Ducheyne <educheyne at avia-gis.be>
>To: Mathieu Basille <basille at ase-research.org>
>Cc: Els Ducheyne <educheyne at avia-gis.be>, r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] Adehabitat crashed R on MacOS 2.15.2
>Message-ID: <729C9E16-0F5A-4C23-9D22-A59BF2241D26 at avia-gis.be>
>Content-Type: text/plain; charset=windows-1252
>
>Dear Mathieu and Massimo
>Yes, that did the trick, installation of the framework solved the issue both on command line as in R GUI
>Thanks for the help.
>
>Could this be added to the documentation of the packages (the same issue occurs with adehabitatHS)
>
>Best and thanks again
>Els
>On 27 Nov 2012, at 17:25, Mathieu Basille <basille at ase-research.org> wrote:
>
>> Dear Els,
>> 
>> I can't really help on the Mac OS issue with tcl/tk since I'm using Linux. However, as the command line warning tells you, you'd better use 'adehabitatHS' [1] now, instead of the old 'adehabitat', which is no longer developed (bug fixes are added, but no new methods). I don't think it will solve your problem, though, but I really recommend to upgrade. Besides, you might want to have a look at the MADIFA instead of the ENFA. See [2] for further details.
>> 
>> Best,
>> Mathieu Basille.
>> 
>> 
>> [1] http://cran.r-project.org/web/packages/adehabitatHS/index.html
>> 
>> [2] Calenge, C.; Darmon, G.; Basille, M.; Loison, A. & Jullien, J.-M. (2008) The factorial decomposition of the Mahalanobis distances in habitat selection studies. Ecology, 89: 555-566 doi 10.1890/06-1750.1
>> 
>> 
>> Le 27/11/2012 10:57, Els Ducheyne a ?crit :
>>> Dear Massimo
>>> yes it works from command line, I do get a warning about the tcl tk though, so indeed this must be the source of the problem (see below)
>>> The good news is that at least I can carry out the code via the terminal if necessary (even it is not with the R Gui)
>>> Still hoping for a fix though
>>> Els
>>> 
>>> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
>>> Copyright (C) 2012 The R Foundation for Statistical Computing
>>> ISBN 3-900051-07-0
>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>> 
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>> 
>>>   Natural language support but running in an English locale
>>> 
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>> 
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>> 
>>> [Previously saved workspace restored]
>>> 
>>>> library(adehabitat)
>>> Loading required package: ade4
>>> 
>>> Attaching package: ?ade4?
>>> 
>>> The following object(s) are masked from ?package:base?:
>>> 
>>>     within
>>> 
>>> Loading required package: tkrplot
>>> Loading required package: tcltk
>>> Loading Tcl/Tk interface ... done
>>> Loading required package: shapefiles
>>> Loading required package: foreign
>>> 
>>> Attaching package: ?shapefiles?
>>> 
>>> The following object(s) are masked from ?package:foreign?:
>>> 
>>>     read.dbf, write.dbf
>>> 
>>> Be careful: it is now recommended to use the newpackages adehabitatMA, adehabitatLT, adehabitatHR, and adehabitatHS.
>>> These 4 packages are intended to become the future of adehabitat.
>>> The "classical" version of adehabitat will still be maintained for some
>>> time, but no new method will be added to the package.
>>> 
>>> Warning message:
>>> In fun(libname, pkgname) :
>>>   Can't find a usable tk.tcl in the following directories:
>>>     /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/Scripts/tk8.5/Resources/Scripts /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5 /System/Library/Frameworks/Tcl.framework/Versions/8.5/Resources/tk8.5/Resources/Scripts ./lib/tk8.5 ./lib/tk8.5/Resources/Scripts ~/Library/Tcl/tk8.5 ~/Library/Tcl/tk8.5/Resources/Scripts /Library/Tcl/tk8.5 /Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/tk8.5 /System/Library/Tcl/tk8.5/Resources/Scripts /System/Library/Tcl/8.5/tk8.5 /System/Library/Tcl/8.5/tk8.5/Resources/Scripts ~/Library/Frameworks/tk8.5 ~/Library/Frameworks/tk8.5/Resources/Scripts /Library/Frameworks/tk8.5 /Library/Frameworks/tk8.5/Resources/Scripts /System/Library/Frameworks/tk8.5 /System/Library/Frameworks/tk8.5/Resources/Scripts ./library
>>> 
>>> 
>>> 
>>> This probably means that tk wasn't installed properly.
>>>> sessionInfo()
>>> R version 2.15.2 (2012-10-26)
>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>> 
>>> locale:
>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>> 
>>> attached base packages:
>>> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
>>> [8] base
>>> 
>>> other attached packages:
>>> [1] adehabitat_1.8.11 shapefiles_0.6    foreign_0.8-51    tkrplot_0.0-23
>>> [5] ade4_1.4-17
>>>> 
>>> 
>>> On 27 Nov 2012, at 16:42, rpi <distem at rpi.edu> wrote:
>>> 
>>>> Els,
>>>> 
>>>> i tried to run adehabitat form inside the Gui.app (64 bit) using R
>>>> (installed from Homebrew )
>>>> 
>>>> .. and i got the same problem you had
>>>> 
>>>> i tried to rebuild the  gui.app using Xcode but no lucky .. same crash.
>>>> 
>>>> trying to run R from the command line ? it is able to load adehabitat.
>>>> 
>>>> seems to me a GUI.app problem
>>>> 
>>>> ..  can you check if your adehabitat code runs fine starting R from command line ?
>>>> 
>>>> thanks,
>>>> 
>>>> Massimo.
>>>> 
>>>> 
>>>> Il giorno 27/nov/2012, alle ore 09:34, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>>> 
>>>>> Dear Massimo
>>>>> I've just tried and it is still the same problem. Should I put it somewhere for R to find this?
>>>>> 
>>>>> Best
>>>>> Els
>>>>> 
>>>>> On 27 Nov 2012, at 15:03, epi <massimodisasha at gmail.com> wrote:
>>>>> 
>>>>>> did you tried to install XQuartz ?
>>>>>> 
>>>>>> http://xquartz.macosforge.org/landing/
>>>>>> 
>>>>>> --Massimo.
>>>>>> 
>>>>>> 
>>>>>> Il giorno 27/nov/2012, alle ore 09:00, Els Ducheyne <educheyne at avia-gis.be> ha scritto:
>>>>>> 
>>>>>>> Dear list
>>>>>>> I am trying to run ENFA for presence only records. I have installed adehabitat v1.18.11 on R2.15.2 on MacOS 10.8.2. I
>>>>>>> Whilst the library is successfully installed and loaded, it crashed R when I am trying to run other commands after loading the library.
>>>>>>> Did anyone experience this before?
>>>>>>> Is it the Tcl/Tk that causes the problem, could I load the package without the Tcl/Tk?
>>>>>>> I have tested under windows too with same version of adehabitat and R and there it works fine. Unfortunately, I will use the package for teaching and some students use MacOS so therefore I would like to find a solution.
>>>>>>> 
>>>>>>>> sessionInfo()
>>>>>>> R version 2.15.2 (2012-10-26)
>>>>>>> Platform: i386-apple-darwin9.8.0/i386 (32 bit)
>>>>>>> 
>>>>>>> locale
>>>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>>>> 
>>>>>>> attached base packages:
>>>>>>> stats graphics grDevices utils datasets methods base
>>>>>>>> library(adehabitat)
>>>>>>> Loading required package: ade4
>>>>>>> Attaching package: 'ade4'
>>>>>>> The following objects are masked from 'package:base'
>>>>>>> within
>>>>>>> loading required package:tkrplot
>>>>>>> loading required package: tcltk
>>>>>>> Loading Tcl/Tk interface
>>>>>>>> sessionInfo()
>>>>>>> 
>>>>>>> After the second sessionInfo() R does not respond, nor with any other command. The only option is Force quit and reboot.
>>>>>>> 
>>>>>>> Thanks for any help
>>>>>>> Els
>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>> 
>>>>> 
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> -- 
>> 
>> ~$ whoami
>> Mathieu Basille, PhD
>> 
>> ~$ locate --details
>> University of Florida \\
>> Fort Lauderdale Research and Education Center
>> (+1) 954-577-6314
>> http://ase-research.org/basille
>> 
>> ~$ fortune
>> ? Le tout est de tout dire, et je manque de mots
>> Et je manque de temps, et je manque d'audace. ?
>> -- Paul ?luard
>
>
>
>------------------------------
>
>Message: 12
>Date: Thu, 29 Nov 2012 10:15:24 +0100
>From: Lorenzo Alfieri <alfios17 at hotmail.com>
>To: <r.hijmans at gmail.com>
>Cc: R-sig-geo_Forum <r-sig-geo at r-project.org>
>Subject: Re: [R-sig-Geo] calculate CRPS on rasters
>Message-ID: <DUB107-W649F6E7FC94975EE3E9E28D75C0 at phx.gbl>
>Content-Type: text/plain; charset="iso-8859-1"
>
>
>Hi Robert,
>I was hoping to use the overlay function too, but it seems it doesn't work in this case. See the result:
>
>CRPS? <- overlay(obs, pred, fun=function(x,y) crps(x,y)$crps)
>
>Error in function (x, fun, filename = "", recycle = TRUE, ...)? : 
>? cannot use this formula, probably because it is not vectorized
>
>Lorenzo
>
>
>
>Date: Wed, 28 Nov 2012 11:25:36 -0800
>Subject: Re: [R-sig-Geo] calculate CRPS on rasters
>From: r.hijmans at gmail.com
>To: alfios17 at hotmail.com
>CC: etiennebr at gmail.com; r-sig-geo at r-project.org
>
>Lorenzo,
>Given that solution, I think you can also express this?(in a memory-safe fashion)?like this :
>CRPS??<- overlay(obs, pred, fun=function(x,y) crps(x, y)$crps)
>
>Robert
>
>On Tue, Nov 27, 2012 at 3:11 AM, Lorenzo Alfieri <alfios17 at hotmail.com> wrote:
>
>
>
>
>Etienne,
>
>thank you for the tip
>
>Now it runs trough, by using
>
>
>
>CRPS <- raster(ncol=10, nrow=10)
>
>CRPS[] <- crps(obs[],pred[])$crps
>
>
>
>Lorenzo
>
>
>
>
>
>Date: Mon, 26 Nov 2012 21:37:13 -0500
>
>Subject: Re: [R-sig-Geo] calculate CRPS on rasters
>
>From: etiennebr at gmail.com
>
>To: alfios17 at hotmail.com
>
>CC: r-sig-geo at r-project.org
>
>
>
>Lorenzo,
>
>
>
>I don't know about your specific function, but you can access matrix using the []'s. So maybe something like :
>
>CRPS <- raster(ncol=10, nrow=10)
>
>CRPS[] <- crps(obs[],pred[])
>
>
>
>
>
>Etienne
>
>
>
>2012/11/26 Lorenzo Alfieri <alfios17 at hotmail.com>
>
>
>
>CRPS <- raster(ncol=10, nrow=10)
>
>
>
>for (i in 1:length(obs)){
>
>
>
>? CRPS[i] <- crps(obs[i],pred[i])$CRPS
>
>
>
>? ? ? ? [[alternative HTML version deleted]]
>
>
>
>_______________________________________________
>
>R-sig-Geo mailing list
>
>R-sig-Geo at r-project.org
>
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> 		 	   		  
>
>
>------------------------------
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>End of R-sig-Geo Digest, Vol 111, Issue 27
>******************************************

From alfios17 at hotmail.com  Fri Nov 30 09:49:00 2012
From: alfios17 at hotmail.com (Lorenzo Alfieri)
Date: Fri, 30 Nov 2012 09:49:00 +0100
Subject: [R-sig-Geo] calculate CRPS on rasters
In-Reply-To: <CANtt_hx-yw9ngJZ3LxHRy=KpN8V6dtMy3R=LsQojf0f-XMeOSw@mail.gmail.com>
References: <DUB107-W547430534E219882EBB13AD75F0@phx.gbl>,
	<CALjAYt6L_0pkvaRFbZNTGdE4zyNZdR9yBdrP3vqP6d7BByYgmg@mail.gmail.com>,
	<DUB107-W15DBDD3807924285ABD430D75E0@phx.gbl>,
	<CANtt_hzGYYEk38TgYws+npfLwAg2Z6VG1fv0GW9YHjQiCvhbVw@mail.gmail.com>,
	<DUB107-W649F6E7FC94975EE3E9E28D75C0@phx.gbl>,
	<CANtt_hx-yw9ngJZ3LxHRy=KpN8V6dtMy3R=LsQojf0f-XMeOSw@mail.gmail.com>
Message-ID: <DUB107-W46A7961B703A9341505350D7430@phx.gbl>


Robert,
you're right, it works. 
I must have done something wrong yesterday
I'm trying to optimize the computation time
I've tested the two alternatives on a predictor of 51 layers of 680x810 pixels

CRPS[] <- crps(obs[],pred[])$crps ? ? ? ? ? ? ? ? took 0.98 second
CRPS  <- overlay(obs, pred, fun=function(x,y) crps(x,y)$crps)????????? took 1.45 seconds

anyway, thank you all!

Lorenzo


________________________________
> Date: Thu, 29 Nov 2012 10:34:36 -0800 
> Subject: Re: [R-sig-Geo] calculate CRPS on rasters 
> From: r.hijmans at gmail.com 
> To: alfios17 at hotmail.com 
> CC: r-sig-geo at r-project.org 
>  
> Lorenzo, 
>  
> The below (your example) works for me, using the overlay as I suggested. 
> Perhaps you did not load the verification package? 
>  
> Robert 
>  
> library(verification)      #includes function crps 
> library(raster) 
> set.seed(1) 
> r <- raster(ncol=10, nrow=10) 
> pred1 <- init(r, fun=runif) 
> pred2 <- init(r, fun=runif) 
> pred3 <- init(r, fun=runif) 
> pred <- stack(pred1, pred2, pred3) 
> obs <- init(r, fun=runif) 
>  
> CRPS  <- overlay(obs, pred, fun=function(x,y) crps(x,y)$crps) 
>  
>  
>  > CRPS 
> class       : RasterLayer 
> dimensions  : 10, 10, 100  (nrow, ncol, ncell) 
> resolution  : 36, 18  (x, y) 
> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax) 
> coord. ref. : +proj=longlat +datum=WGS84 
> data source : in memory 
> names       : layer 
> values      : 0.003277372, 0.7726679  (min, max) 
>  
>  
> # More fancy, to get all the crps output: 
>  
> x  <- overlay(obs, pred, fun=function(x,y) as.matrix(data.frame(crps(x,y)))) 
>  
>  
>  
> On Thu, Nov 29, 2012 at 1:15 AM, Lorenzo Alfieri  
> <alfios17 at hotmail.com<mailto:alfios17 at hotmail.com>> wrote: 
>  
> Hi Robert, 
> I was hoping to use the overlay function too, but it seems it doesn't 
> work in this case. See the result: 
>  
> CRPS  <- overlay(obs, pred, fun=function(x,y) crps(x,y)$crps) 
>  
> Error in function (x, fun, filename = "", recycle = TRUE, ...)  : 
>    cannot use this formula, probably because it is not vectorized 
>  
> Lorenzo 
>  
>  
>  
> Date: Wed, 28 Nov 2012 11:25:36 -0800 
> Subject: Re: [R-sig-Geo] calculate CRPS on rasters 
> From: r.hijmans at gmail.com<mailto:r.hijmans at gmail.com> 
> To: alfios17 at hotmail.com<mailto:alfios17 at hotmail.com> 
> CC: etiennebr at gmail.com<mailto:etiennebr at gmail.com>;  
> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org> 
>  
> Lorenzo, 
> Given that solution, I think you can also express this (in a  
> memory-safe fashion) like this : 
> CRPS  <- overlay(obs, pred, fun=function(x,y) crps(x, y)$crps)
>  
> Robert 
>  
> On Tue, Nov 27, 2012 at 3:11 AM, Lorenzo Alfieri  
> <alfios17 at hotmail.com<mailto:alfios17 at hotmail.com>> wrote: 
>  
>  
>  
>  
> Etienne, 
>  
> thank you for the tip 
>  
> Now it runs trough, by using 
>  
>  
>  
> CRPS <- raster(ncol=10, nrow=10) 
>  
> CRPS[] <- crps(obs[],pred[])$crps 
>  
>  
>  
> Lorenzo 
>  
>  
>  
>  
>  
> Date: Mon, 26 Nov 2012 21:37:13 -0500 
>  
> Subject: Re: [R-sig-Geo] calculate CRPS on rasters 
>  
> From: etiennebr at gmail.com<mailto:etiennebr at gmail.com> 
>  
> To: alfios17 at hotmail.com<mailto:alfios17 at hotmail.com> 
>  
> CC: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org> 
>  
>  
>  
> Lorenzo, 
>  
>  
>  
> I don't know about your specific function, but you can access matrix  
> using the []'s. So maybe something like : 
>  
> CRPS <- raster(ncol=10, nrow=10) 
>  
> CRPS[] <- crps(obs[],pred[]) 
>  
>  
>  
>  
>  
> Etienne 
>  
>  
>  
> 2012/11/26 Lorenzo Alfieri  
> <alfios17 at hotmail.com<mailto:alfios17 at hotmail.com>> 
>  
>  
>  
> CRPS <- raster(ncol=10, nrow=10) 
>  
>  
>  
> for (i in 1:length(obs)){ 
>  
>  
>  
>    CRPS[i] <- crps(obs[i],pred[i])$CRPS 
>  
>  
>  
>          [[alternative HTML version deleted]] 
>  
>  
>  
> _______________________________________________ 
>  
> R-sig-Geo mailing list 
>  
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org> 
>  
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo 
>  
>  
>  
>  
 		 	   		  

From nmmv2002 at hotmail.com  Fri Nov 30 14:42:16 2012
From: nmmv2002 at hotmail.com (Nuno)
Date: Fri, 30 Nov 2012 05:42:16 -0800 (PST)
Subject: [R-sig-Geo] Spatial Analysis Doubts
Message-ID: <1354282936830-7581802.post@n2.nabble.com>

Hi you all,
 
I am studying the spatial overlap between two species. I want to:
 
 - Determine the spatial distribution of each of the two species using a
geostatistical approach by estimating the variogram and then apply the
kriging and/or cokriging.
 
 - Use the estimates predicted for each species to determine the ratio, to
evaluate de spatial distribution of the ratio estimates and then obtain the
overlap degree.
 
My questions are:
 
1 ? What are the procedures that you recommend to test if the process is
stationary? I just assumed that the process is stationary?
 
 
2 - In my work there is clear east-west anisotropy. My questions regarding
this are:
 
i) Is there any test to evaluate its significance other than graphically? 
 
ii) Being a strong anisotropy it is more advisable to study the spatial
distribution, of the variable under study, in that direction?
 
3- Are there any cases where the Simple Kriging is more advisable than the
other forms of Kriging?
 
4- Besides Cross-validation residual and Cross validation z-scores, are
there any test to evaluate the adequacy of different models? Is there any
coefficient like AIC criterion to evaluate and choose the best-fitted model
between several models or the decision is mainly done by graphical analysis? 
 
5- Which is the package in R more fit to my study? geoR or gstat?
 

Thanks a lot for your help,
Best regards,
Nuno Veiga



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-Analysis-Doubts-tp7581802.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From basille at ase-research.org  Fri Nov 30 16:15:44 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 30 Nov 2012 10:15:44 -0500
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
Message-ID: <50B8CDA0.50501@ase-research.org>

Dear R users,

I have a working PostGIS database that I routinely access through R, using 
readOGR or readGDAL. I have this point layer, however, that I can't read in R:

 > ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", 
layer = "gis.world_ctrdcoast")
OGR data source with driver: PostgreSQL
Source: "PG:dbname=florida host=localhost user=pguser", layer: 
"gis.world_ctrdcoast"
with 35398 features and 2 fields
Error in readOGR("PG:dbname=florida host=localhost user=pguser", layer = 
"gis.world_ctrdcoast") :
   Error getting field 0

The layer is basically a table with just 2 fields: geom (a point feature) 
and gid (a serial primary key). I can export this layer without any problem 
using ogr2ogr, and the layer looks fine to me (it displays fine in QGIS):

ogr2ogr -f "ESRI Shapefile" ctrd.shp PG:"dbname=florida host=localhost 
user=pguser" "gis.world_ctrdcoast"

Any idea where this is going wrong? Thanks in advance for any suggestion.
Mathieu.


 > sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=fr_FR.UTF-8       LC_NUMERIC=C 
LC_TIME=fr_FR.UTF-8
  [4] LC_COLLATE=fr_FR.UTF-8     LC_MONETARY=fr_FR.UTF-8 
LC_MESSAGES=fr_FR.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C 

[10] LC_TELEPHONE=C             LC_MEASUREMENT=fr_FR.UTF-8 
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.0-31 rgdal_0.7-22  sp_1.0-2

loaded via a namespace (and not attached):
[1] compiler_2.15.1 grid_2.15.1     lattice_0.20-6  tools_2.15.1


# SELECT PostGIS_Full_Version();
 
     postgis_full_version 

-------------------------------------------------------------------------
  POSTGIS="2.1.0SVN r10597" GEOS="3.3.3-CAPI-1.7.4" PROJ="Rel. 4.7.1, 23 
September 2009" GDAL="GDAL 2.0dev, released 2011/12/29" LIBXML="2.8.0" 
LIBJSON="UNKNOWN" TOPOLOGY RASTER



-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From Roger.Bivand at nhh.no  Fri Nov 30 16:39:35 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Nov 2012 16:39:35 +0100
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <50B8CDA0.50501@ase-research.org>
References: <50B8CDA0.50501@ase-research.org>
Message-ID: <alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>

On Fri, 30 Nov 2012, Mathieu Basille wrote:

> Dear R users,
>
> I have a working PostGIS database that I routinely access through R, using 
> readOGR or readGDAL. I have this point layer, however, that I can't read in 
> R:
>
>> ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", layer 
> = "gis.world_ctrdcoast")
> OGR data source with driver: PostgreSQL
> Source: "PG:dbname=florida host=localhost user=pguser", layer: 
> "gis.world_ctrdcoast"
> with 35398 features and 2 fields
> Error in readOGR("PG:dbname=florida host=localhost user=pguser", layer = 
> "gis.world_ctrdcoast") :
>  Error getting field 0
>
> The layer is basically a table with just 2 fields: geom (a point feature) and 
> gid (a serial primary key). I can export this layer without any problem using 
> ogr2ogr, and the layer looks fine to me (it displays fine in QGIS):
>
> ogr2ogr -f "ESRI Shapefile" ctrd.shp PG:"dbname=florida host=localhost 
> user=pguser" "gis.world_ctrdcoast"
>
> Any idea where this is going wrong? Thanks in advance for any suggestion.
> Mathieu.

The error message is from ogrReadColumn(), line 221 in src/ogrsource.cpp, 
for example here:

https://r-forge.r-project.org/scm/viewvc.php/pkg/src/ogrsource.cpp?view=markup&root=rgdal

What does ogrInfo() report? Does it make a difference if you add an extra 
field? I'm wondering whether in this case the GID is not being seen as a 
field as such, but the FID of the point. Possibly ogr2ogr steps round 
this. I don't have a PostGIS system running, so may need help debugging. 
If you debug(readOGR), what happens here:

         if (drop_unsupported_fields) {
              iflds <- as.integer((1:ogr_info$nitems)-1)
              iflds <- iflds[keep]
              fldnms <- ogr_info$iteminfo$name[keep]
              if (any(!keep)) warning(paste("Fields dropped:",
                  paste(ogr_info$iteminfo$name[!keep], collapse=" ")))
         } else {
              if (any(!keep)) stop(paste("Unsupported field type:",
                  paste(ogr_info$iteminfo$typeName[!keep], collapse=" ")))
              iflds <- as.integer((1:ogr_info$nitems)-1)
              fldnms <- ogr_info$iteminfo$name
         }

I think ogr_info$nitems is 1, so we get 0, but if ogr_info$nitems is 0, 
(0, -1).

Roger




>
>
>> sessionInfo()
> R version 2.15.1 (2012-06-22)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=fr_FR.UTF-8       LC_NUMERIC=C LC_TIME=fr_FR.UTF-8
> [4] LC_COLLATE=fr_FR.UTF-8     LC_MONETARY=fr_FR.UTF-8 
> LC_MESSAGES=fr_FR.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C 
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=fr_FR.UTF-8 
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.0-31 rgdal_0.7-22  sp_1.0-2
>
> loaded via a namespace (and not attached):
> [1] compiler_2.15.1 grid_2.15.1     lattice_0.20-6  tools_2.15.1
>
>
> # SELECT PostGIS_Full_Version();
>
>    postgis_full_version 
> -------------------------------------------------------------------------
> POSTGIS="2.1.0SVN r10597" GEOS="3.3.3-CAPI-1.7.4" PROJ="Rel. 4.7.1, 23 
> September 2009" GDAL="GDAL 2.0dev, released 2011/12/29" LIBXML="2.8.0" 
> LIBJSON="UNKNOWN" TOPOLOGY RASTER
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From basille at ase-research.org  Fri Nov 30 17:00:52 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 30 Nov 2012 11:00:52 -0500
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
Message-ID: <50B8D834.60809@ase-research.org>

Dear Roger,

Thanks a lot for your very fast answer! Here are the requested outputs:

Le 30/11/2012 10:39, Roger Bivand a ?crit :
> On Fri, 30 Nov 2012, Mathieu Basille wrote:
>
>> Dear R users,
>>
>> I have a working PostGIS database that I routinely access through R,
>> using readOGR or readGDAL. I have this point layer, however, that I can't
>> read in R:
>>
>>> ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", layer
>> = "gis.world_ctrdcoast")
>> OGR data source with driver: PostgreSQL
>> Source: "PG:dbname=florida host=localhost user=pguser", layer:
>> "gis.world_ctrdcoast"
>> with 35398 features and 2 fields
>> Error in readOGR("PG:dbname=florida host=localhost user=pguser", layer =
>> "gis.world_ctrdcoast") :
>>  Error getting field 0
>>
>> The layer is basically a table with just 2 fields: geom (a point feature)
>> and gid (a serial primary key). I can export this layer without any
>> problem using ogr2ogr, and the layer looks fine to me (it displays fine
>> in QGIS):
>>
>> ogr2ogr -f "ESRI Shapefile" ctrd.shp PG:"dbname=florida host=localhost
>> user=pguser" "gis.world_ctrdcoast"
>>
>> Any idea where this is going wrong? Thanks in advance for any suggestion.
>> Mathieu.
>
> The error message is from ogrReadColumn(), line 221 in src/ogrsource.cpp,
> for example here:
>
> https://r-forge.r-project.org/scm/viewvc.php/pkg/src/ogrsource.cpp?view=markup&root=rgdal
>
>
> What does ogrInfo() report?

$ ogrinfo "PG:dbname=florida host=localhost user=pguser" 
gis.world_ctrdcoast -summary
INFO: Open of `PG:dbname=florida host=localhost user=pguser'
       using driver `PostgreSQL' successful.

Layer name: gis.world_ctrdcoast
Geometry: Unknown (any)
Feature Count: 35398
Extent: (-179.916500, -59.083000) - (179.968500, 83.535000)
Layer SRS WKT:
(unknown)
FID Column = gid
Geometry Column = geom

I noticed there was a call to ogrInfo in the readOGR function. After this 
line, here is what's reported:

Browse[2]> ogr_info
Source: "PG:dbname=florida host=localhost user=pguser", layer: 
"gis.world_ctrdcoast"
Driver: PostgreSQL number of rows 35398
Feature type: wkbPoint with 2 dimensions
NA
Number of fields: 0
[1] name     type     length   typeName
<0 rows> (or 0-length row.names)


> Does it make a difference if you add an extra
> field?

As a matter of fact, it does! If I add a serial field named 'bla', it works 
perfectly:

 > ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", 
layer = "gis.world_ctrdcoast")
OGR data source with driver: PostgreSQL
Source: "PG:dbname=florida host=localhost user=pguser", layer: 
"gis.world_ctrdcoast"
with 35398 features and 1 fields
Feature type: wkbPoint with 2 dimensions

 > summary(ctrdcoast)
Object of class SpatialPointsDataFrame
Coordinates:
                 min      max
coords.x1 -179.9165 179.9685
coords.x2  -59.0830  83.5350
Is projected: NA
proj4string : [NA]
Number of points: 35398
Data attributes:
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
       1    8850   17700   17700   26550   35400

 > head(ctrdcoast at data)
   bla
1   1
2   2
3   3
4   4
5   5
6   6


> I'm wondering whether in this case the GID is not being seen as a
> field as such, but the FID of the point. Possibly ogr2ogr steps round this.

It looks like a correct guess, given the output of ogrinfo. In addition, 
the exported shapefile from ogr2ogr present one field (named FID), while if 
I load the table into QGIS, I can see the field with its correct name 
(gid). Admittedly, while I'm pretty sure that QGIS uses GDAL to load 
tables, I have no idea how it deals with it.


> I don't have a PostGIS system running, so may need help debugging. If you
> debug(readOGR), what happens here:
>
>          if (drop_unsupported_fields) {
>               iflds <- as.integer((1:ogr_info$nitems)-1)
>               iflds <- iflds[keep]
>               fldnms <- ogr_info$iteminfo$name[keep]
>               if (any(!keep)) warning(paste("Fields dropped:",
>                   paste(ogr_info$iteminfo$name[!keep], collapse=" ")))
>          } else {
>               if (any(!keep)) stop(paste("Unsupported field type:",
>                   paste(ogr_info$iteminfo$typeName[!keep], collapse=" ")))
>               iflds <- as.integer((1:ogr_info$nitems)-1)
>               fldnms <- ogr_info$iteminfo$name
>          }

Browse[2]> ogr_info$nitems
[1] 0
Browse[2]> iflds
[1]  0 -1
Browse[2]> fldnms
character(0)


> I think ogr_info$nitems is 1, so we get 0, but if ogr_info$nitems is 0, (0,
> -1).

Does that mean that we necessarily need a field in the table (in addition 
to geom + gid)? It's not hard to 'fix' by adding a nonsensical field, but I 
find it quite counterintuitive.

Thanks again for the help!
Mathieu.


> Roger
>
>
>
>
>>
>>
>>> sessionInfo()
>> R version 2.15.1 (2012-06-22)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>> [1] LC_CTYPE=fr_FR.UTF-8       LC_NUMERIC=C LC_TIME=fr_FR.UTF-8
>> [4] LC_COLLATE=fr_FR.UTF-8     LC_MONETARY=fr_FR.UTF-8
>> LC_MESSAGES=fr_FR.UTF-8
>> [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C
>> [10] LC_TELEPHONE=C             LC_MEASUREMENT=fr_FR.UTF-8
>> LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.0-31 rgdal_0.7-22  sp_1.0-2
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_2.15.1 grid_2.15.1     lattice_0.20-6  tools_2.15.1
>>
>>
>> # SELECT PostGIS_Full_Version();
>>
>>    postgis_full_version
>> -------------------------------------------------------------------------
>> POSTGIS="2.1.0SVN r10597" GEOS="3.3.3-CAPI-1.7.4" PROJ="Rel. 4.7.1, 23
>> September 2009" GDAL="GDAL 2.0dev, released 2011/12/29" LIBXML="2.8.0"
>> LIBJSON="UNKNOWN" TOPOLOGY RASTER
>>
>>
>>
>>
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From Roger.Bivand at nhh.no  Fri Nov 30 17:27:52 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Nov 2012 17:27:52 +0100
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <50B8D834.60809@ase-research.org>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
	<50B8D834.60809@ase-research.org>
Message-ID: <alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>

On Fri, 30 Nov 2012, Mathieu Basille wrote:

> Dear Roger,
>
> Thanks a lot for your very fast answer! Here are the requested outputs:
>
> Le 30/11/2012 10:39, Roger Bivand a ?crit :
>> On Fri, 30 Nov 2012, Mathieu Basille wrote:
>> 
>>> Dear R users,
>>> 
>>> I have a working PostGIS database that I routinely access through R,
>>> using readOGR or readGDAL. I have this point layer, however, that I can't
>>> read in R:
>>> 
>>>> ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", 
>>>> layer
>>> = "gis.world_ctrdcoast")
>>> OGR data source with driver: PostgreSQL
>>> Source: "PG:dbname=florida host=localhost user=pguser", layer:
>>> "gis.world_ctrdcoast"
>>> with 35398 features and 2 fields
>>> Error in readOGR("PG:dbname=florida host=localhost user=pguser", layer =
>>> "gis.world_ctrdcoast") :
>>>  Error getting field 0
>>> 
>>> The layer is basically a table with just 2 fields: geom (a point feature)
>>> and gid (a serial primary key). I can export this layer without any
>>> problem using ogr2ogr, and the layer looks fine to me (it displays fine
>>> in QGIS):
>>> 
>>> ogr2ogr -f "ESRI Shapefile" ctrd.shp PG:"dbname=florida host=localhost
>>> user=pguser" "gis.world_ctrdcoast"
>>> 
>>> Any idea where this is going wrong? Thanks in advance for any suggestion.
>>> Mathieu.
>> 
>> The error message is from ogrReadColumn(), line 221 in src/ogrsource.cpp,
>> for example here:
>> 
>> https://r-forge.r-project.org/scm/viewvc.php/pkg/src/ogrsource.cpp?view=markup&root=rgdal
>> 
>> 
>> What does ogrInfo() report?
>
> $ ogrinfo "PG:dbname=florida host=localhost user=pguser" gis.world_ctrdcoast 
> -summary
> INFO: Open of `PG:dbname=florida host=localhost user=pguser'
>      using driver `PostgreSQL' successful.
>
> Layer name: gis.world_ctrdcoast
> Geometry: Unknown (any)
> Feature Count: 35398
> Extent: (-179.916500, -59.083000) - (179.968500, 83.535000)
> Layer SRS WKT:
> (unknown)
> FID Column = gid
> Geometry Column = geom
>
> I noticed there was a call to ogrInfo in the readOGR function. After this 
> line, here is what's reported:
>
> Browse[2]> ogr_info
> Source: "PG:dbname=florida host=localhost user=pguser", layer: 
> "gis.world_ctrdcoast"
> Driver: PostgreSQL number of rows 35398
> Feature type: wkbPoint with 2 dimensions
> NA
> Number of fields: 0
> [1] name     type     length   typeName
> <0 rows> (or 0-length row.names)
>

Thanks very much, this is the information needed, that there are no 
fields. It appears that at least in this driver, readOGR() needs to be 
able to return a geometry-only object, or to create a GID column in the 
data.frame. I'll let you know when I've committed to R-forge, and will be 
very grateful if you can check out the source package, install, and test 
whether the changes have helped. It may take a little time to get there, 
but I'll give it priority.

Roger

>
>> Does it make a difference if you add an extra
>> field?
>
> As a matter of fact, it does! If I add a serial field named 'bla', it works 
> perfectly:
>
>> ctrdcoast <- readOGR("PG:dbname=florida host=localhost user=pguser", layer 
> = "gis.world_ctrdcoast")
> OGR data source with driver: PostgreSQL
> Source: "PG:dbname=florida host=localhost user=pguser", layer: 
> "gis.world_ctrdcoast"
> with 35398 features and 1 fields
> Feature type: wkbPoint with 2 dimensions
>
>> summary(ctrdcoast)
> Object of class SpatialPointsDataFrame
> Coordinates:
>                min      max
> coords.x1 -179.9165 179.9685
> coords.x2  -59.0830  83.5350
> Is projected: NA
> proj4string : [NA]
> Number of points: 35398
> Data attributes:
>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>      1    8850   17700   17700   26550   35400
>
>> head(ctrdcoast at data)
>  bla
> 1   1
> 2   2
> 3   3
> 4   4
> 5   5
> 6   6
>
>
>> I'm wondering whether in this case the GID is not being seen as a
>> field as such, but the FID of the point. Possibly ogr2ogr steps round this.
>
> It looks like a correct guess, given the output of ogrinfo. In addition, the 
> exported shapefile from ogr2ogr present one field (named FID), while if I 
> load the table into QGIS, I can see the field with its correct name (gid). 
> Admittedly, while I'm pretty sure that QGIS uses GDAL to load tables, I have 
> no idea how it deals with it.
>
>
>> I don't have a PostGIS system running, so may need help debugging. If you
>> debug(readOGR), what happens here:
>>
>>          if (drop_unsupported_fields) {
>>               iflds <- as.integer((1:ogr_info$nitems)-1)
>>               iflds <- iflds[keep]
>>               fldnms <- ogr_info$iteminfo$name[keep]
>>               if (any(!keep)) warning(paste("Fields dropped:",
>>                   paste(ogr_info$iteminfo$name[!keep], collapse=" ")))
>>          } else {
>>               if (any(!keep)) stop(paste("Unsupported field type:",
>>                   paste(ogr_info$iteminfo$typeName[!keep], collapse=" ")))
>>               iflds <- as.integer((1:ogr_info$nitems)-1)
>>               fldnms <- ogr_info$iteminfo$name
>>          }
>
> Browse[2]> ogr_info$nitems
> [1] 0
> Browse[2]> iflds
> [1]  0 -1
> Browse[2]> fldnms
> character(0)
>
>
>> I think ogr_info$nitems is 1, so we get 0, but if ogr_info$nitems is 0, (0,
>> -1).
>
> Does that mean that we necessarily need a field in the table (in addition to 
> geom + gid)? It's not hard to 'fix' by adding a nonsensical field, but I find 
> it quite counterintuitive.
>
> Thanks again for the help!
> Mathieu.
>
>
>> Roger
>> 
>> 
>> 
>> 
>>> 
>>> 
>>>> sessionInfo()
>>> R version 2.15.1 (2012-06-22)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>> 
>>> locale:
>>> [1] LC_CTYPE=fr_FR.UTF-8       LC_NUMERIC=C LC_TIME=fr_FR.UTF-8
>>> [4] LC_COLLATE=fr_FR.UTF-8     LC_MONETARY=fr_FR.UTF-8
>>> LC_MESSAGES=fr_FR.UTF-8
>>> [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C
>>> [10] LC_TELEPHONE=C             LC_MEASUREMENT=fr_FR.UTF-8
>>> LC_IDENTIFICATION=C
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> 
>>> other attached packages:
>>> [1] raster_2.0-31 rgdal_0.7-22  sp_1.0-2
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] compiler_2.15.1 grid_2.15.1     lattice_0.20-6  tools_2.15.1
>>> 
>>> 
>>> # SELECT PostGIS_Full_Version();
>>>
>>>    postgis_full_version
>>> -------------------------------------------------------------------------
>>> POSTGIS="2.1.0SVN r10597" GEOS="3.3.3-CAPI-1.7.4" PROJ="Rel. 4.7.1, 23
>>> September 2009" GDAL="GDAL 2.0dev, released 2011/12/29" LIBXML="2.8.0"
>>> LIBJSON="UNKNOWN" TOPOLOGY RASTER
>>> 
>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From basille at ase-research.org  Fri Nov 30 17:34:12 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 30 Nov 2012 11:34:12 -0500
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
	<50B8D834.60809@ase-research.org>
	<alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>
Message-ID: <50B8E004.1050203@ase-research.org>

Le 30/11/2012 11:27, Roger Bivand a ?crit :
> [...]
>
> Thanks very much, this is the information needed, that there are no fields.
> It appears that at least in this driver, readOGR() needs to be able to
> return a geometry-only object, or to create a GID column in the data.frame.
> I'll let you know when I've committed to R-forge, and will be very grateful
> if you can check out the source package, install, and test whether the
> changes have helped. It may take a little time to get there, but I'll give
> it priority.

I'd be happy to test when it's ready! However, no need to hurry: in the 
meantime, it is still possible (and easy) to add a dummy field to make 
readOGR work.

Thank you very much for you work!
Mathieu.


> Roger


-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From Roger.Bivand at nhh.no  Fri Nov 30 17:56:33 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Nov 2012 17:56:33 +0100
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <50B8E004.1050203@ase-research.org>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
	<50B8D834.60809@ase-research.org>
	<alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>
	<50B8E004.1050203@ase-research.org>
Message-ID: <alpine.LRH.2.02.1211301752110.28713@reclus.nhh.no>

On Fri, 30 Nov 2012, Mathieu Basille wrote:

> Le 30/11/2012 11:27, Roger Bivand a ?crit :
>> [...]
>> 
>> Thanks very much, this is the information needed, that there are no fields.
>> It appears that at least in this driver, readOGR() needs to be able to
>> return a geometry-only object, or to create a GID column in the data.frame.
>> I'll let you know when I've committed to R-forge, and will be very grateful
>> if you can check out the source package, install, and test whether the
>> changes have helped. It may take a little time to get there, but I'll give
>> it priority.
>
> I'd be happy to test when it's ready! However, no need to hurry: in the 
> meantime, it is still possible (and easy) to add a dummy field to make 
> readOGR work.

OK, thanks. SVN revision 389 committed to R-forge project rgdal, checkout 
from:

svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg

and rename pkg -> rgdal (to avoid getting multiple branches), then try
R CMD check rgdal, if OK INSTALL, and try your problem.

Roger

>
> Thank you very much for you work!
> Mathieu.
>
>
>> Roger
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From saramartino at yahoo.com  Fri Nov 30 18:57:53 2012
From: saramartino at yahoo.com (sara martino)
Date: Fri, 30 Nov 2012 09:57:53 -0800 (PST)
Subject: [R-sig-Geo] Problem with RNetCDF and ubuntu
Message-ID: <1354298273.90558.YahooMailNeo@web140905.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121130/2bcba6d5/attachment.pl>

From ptitle at umich.edu  Fri Nov 30 19:35:34 2012
From: ptitle at umich.edu (Pascal Title)
Date: Fri, 30 Nov 2012 13:35:34 -0500
Subject: [R-sig-Geo] clamping in R dismo package
Message-ID: <CAPSA=yehYKyDsdmEWkEc1iXfPkvFn=QV1tdxTmKac+nmAJ-4yg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20121130/2ac8465d/attachment.pl>

From basille at ase-research.org  Fri Nov 30 20:18:18 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 30 Nov 2012 14:18:18 -0500
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <alpine.LRH.2.02.1211301752110.28713@reclus.nhh.no>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
	<50B8D834.60809@ase-research.org>
	<alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>
	<50B8E004.1050203@ase-research.org>
	<alpine.LRH.2.02.1211301752110.28713@reclus.nhh.no>
Message-ID: <50B9067A.5060205@ase-research.org>

Roger,

It works beautifully! Checkout and compilation went successfully without 
any problem, and now readOGR can read layers with no field. As a matter of 
fact, it doesn't even need a primary key, just the geometry field. If there 
is a primary key, it is used as 'FID', if there is no primary key, a 'FID' 
field is created starting at 0.

This is perfect, thanks a lot!

Mathieu.


Le 30/11/2012 11:56, Roger Bivand a ?crit :
> On Fri, 30 Nov 2012, Mathieu Basille wrote:
>
>> Le 30/11/2012 11:27, Roger Bivand a ?crit :
>>> [...]
>>>
>>> Thanks very much, this is the information needed, that there are no fields.
>>> It appears that at least in this driver, readOGR() needs to be able to
>>> return a geometry-only object, or to create a GID column in the data.frame.
>>> I'll let you know when I've committed to R-forge, and will be very grateful
>>> if you can check out the source package, install, and test whether the
>>> changes have helped. It may take a little time to get there, but I'll give
>>> it priority.
>>
>> I'd be happy to test when it's ready! However, no need to hurry: in the
>> meantime, it is still possible (and easy) to add a dummy field to make
>> readOGR work.
>
> OK, thanks. SVN revision 389 committed to R-forge project rgdal, checkout
> from:
>
> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg
>
> and rename pkg -> rgdal (to avoid getting multiple branches), then try
> R CMD check rgdal, if OK INSTALL, and try your problem.
>
> Roger
>
>>
>> Thank you very much for you work!
>> Mathieu.
>>
>>
>>> Roger
>>
>>
>>
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From Roger.Bivand at nhh.no  Fri Nov 30 20:21:07 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Nov 2012 20:21:07 +0100
Subject: [R-sig-Geo] readOGR and PostGIS: "Error getting field 0"
In-Reply-To: <50B9067A.5060205@ase-research.org>
References: <50B8CDA0.50501@ase-research.org>
	<alpine.LRH.2.02.1211301624250.28713@reclus.nhh.no>
	<50B8D834.60809@ase-research.org>
	<alpine.LRH.2.02.1211301723260.28713@reclus.nhh.no>
	<50B8E004.1050203@ase-research.org>
	<alpine.LRH.2.02.1211301752110.28713@reclus.nhh.no>
	<50B9067A.5060205@ase-research.org>
Message-ID: <alpine.LRH.2.02.1211302020220.29454@reclus.nhh.no>

On Fri, 30 Nov 2012, Mathieu Basille wrote:

> Roger,
>
> It works beautifully! Checkout and compilation went successfully without any 
> problem, and now readOGR can read layers with no field. As a matter of fact, 
> it doesn't even need a primary key, just the geometry field. If there is a 
> primary key, it is used as 'FID', if there is no primary key, a 'FID' field 
> is created starting at 0.
>
> This is perfect, thanks a lot!

Thanks for checking, I'll put a release submission together.

Roger

>
> Mathieu.
>
>
> Le 30/11/2012 11:56, Roger Bivand a ?crit :
>> On Fri, 30 Nov 2012, Mathieu Basille wrote:
>> 
>>> Le 30/11/2012 11:27, Roger Bivand a ?crit :
>>>> [...]
>>>> 
>>>> Thanks very much, this is the information needed, that there are no 
>>>> fields.
>>>> It appears that at least in this driver, readOGR() needs to be able to
>>>> return a geometry-only object, or to create a GID column in the 
>>>> data.frame.
>>>> I'll let you know when I've committed to R-forge, and will be very 
>>>> grateful
>>>> if you can check out the source package, install, and test whether the
>>>> changes have helped. It may take a little time to get there, but I'll 
>>>> give
>>>> it priority.
>>> 
>>> I'd be happy to test when it's ready! However, no need to hurry: in the
>>> meantime, it is still possible (and easy) to add a dummy field to make
>>> readOGR work.
>> 
>> OK, thanks. SVN revision 389 committed to R-forge project rgdal, checkout
>> from:
>> 
>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg
>> 
>> and rename pkg -> rgdal (to avoid getting multiple branches), then try
>> R CMD check rgdal, if OK INSTALL, and try your problem.
>> 
>> Roger
>> 
>>> 
>>> Thank you very much for you work!
>>> Mathieu.
>>> 
>>> 
>>>> Roger
>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

