From luispelayo84 at gmail.com  Thu Aug  1 00:19:12 2013
From: luispelayo84 at gmail.com (Luis Guerra)
Date: Thu, 1 Aug 2013 00:19:12 +0200
Subject: [R-sig-Geo] Spatial Regression: Moving window regression (MWR)
 or GWR adaptation...?
In-Reply-To: <alpine.LRH.2.03.1307311412220.6870@ecy.wa.gov>
References: <CAKs0pqfnRPw5jtzDCymauYE3Eac60ekscPVo_x-eiqNL4QWZdw@mail.gmail.com>
	<CAKs0pqeFpLZADbDQ-j9ro-StTj_05hu3jB_yBW+Eun+XTd09PA@mail.gmail.com>
	<alpine.LRH.2.03.1307311412220.6870@ecy.wa.gov>
Message-ID: <CANSaWwWhyfSV0PQ=dtTsiF6xqBRdvpbcz+Miobtu2GmdZPi9oA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/33b873d0/attachment.pl>

From alobolistas at gmail.com  Thu Aug  1 12:39:09 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 1 Aug 2013 12:39:09 +0200
Subject: [R-sig-Geo] =?windows-1252?q?package_=91raster=92_is_not_availabl?=
	=?windows-1252?q?e_=28for_R_version_2=2E14=2E1=29?=
Message-ID: <CAG4NReL_A0i5aMkYuBLpho7RrpPOc_4RKyMiXXKoquMZdCcLuQ@mail.gmail.com>

We are trying to install raster on a computer
running ubuntu Precise and get
> install.packages("raster",repos="http://R-Forge.R-project.org")
Warning in install.packages :
  package ?raster? is not available (for R version 2.14.1)
Installing package(s) into ?/home/ina/R/x86_64-pc-linux-gnu-library/2.14?
(as ?lib? is unspecified)
Warning in install.packages :
  package ?raster? is not available (for R version 2.14.1)

We have also tried with the CRAN repo, same result.

Any other way we could install the raster package?

Thanks

Agus


From roman.lustrik at gmail.com  Thu Aug  1 12:41:34 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 1 Aug 2013 12:41:34 +0200
Subject: [R-sig-Geo]
	=?utf-8?q?package_=E2=80=98raster=E2=80=99_is_not_ava?=
	=?utf-8?q?ilable_=28for_R_version_2=2E14=2E1=29?=
In-Reply-To: <CAG4NReL_A0i5aMkYuBLpho7RrpPOc_4RKyMiXXKoquMZdCcLuQ@mail.gmail.com>
References: <CAG4NReL_A0i5aMkYuBLpho7RrpPOc_4RKyMiXXKoquMZdCcLuQ@mail.gmail.com>
Message-ID: <CAHT1vpgErjTrurPNxLXyhPOMWy7VtWaYDL=qgaNG_bGiiH75BA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/fd75d707/attachment.pl>

From alobolistas at gmail.com  Thu Aug  1 12:52:16 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 1 Aug 2013 12:52:16 +0200
Subject: [R-sig-Geo]
	=?windows-1252?q?package_=91raster=92_is_not_availabl?=
	=?windows-1252?q?e_=28for_R_version_2=2E14=2E1=29?=
In-Reply-To: <CAHT1vpgErjTrurPNxLXyhPOMWy7VtWaYDL=qgaNG_bGiiH75BA@mail.gmail.com>
References: <CAG4NReL_A0i5aMkYuBLpho7RrpPOc_4RKyMiXXKoquMZdCcLuQ@mail.gmail.com>
	<CAHT1vpgErjTrurPNxLXyhPOMWy7VtWaYDL=qgaNG_bGiiH75BA@mail.gmail.com>
Message-ID: <CAG4NReKbrMm-miQ46QFbuHdCVrAA0RJTWk2n-TJYZR7SZdCNjg@mail.gmail.com>

Yes, thanks, just realized the R version on this computer is too old.
Sorry for the noise
Agus

On Thu, Aug 1, 2013 at 12:41 PM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
> Upgrade R or download the archived version of the packages (and all of its
> dependencies, quite the task) and build them on your own.
>
> Cheers,
> Roman
>
>
>
> On Thu, Aug 1, 2013 at 12:39 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> We are trying to install raster on a computer
>> running ubuntu Precise and get
>> > install.packages("raster",repos="http://R-Forge.R-project.org")
>> Warning in install.packages :
>>   package ?raster? is not available (for R version 2.14.1)
>> Installing package(s) into ?/home/ina/R/x86_64-pc-linux-gnu-library/2.14?
>> (as ?lib? is unspecified)
>> Warning in install.packages :
>>   package ?raster? is not available (for R version 2.14.1)
>>
>> We have also tried with the CRAN repo, same result.
>>
>> Any other way we could install the raster package?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> In God we trust, all others bring data.
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From amybethhenry at gmail.com  Thu Aug  1 21:06:10 2013
From: amybethhenry at gmail.com (Amy Henry)
Date: Thu, 1 Aug 2013 12:06:10 -0700
Subject: [R-sig-Geo] Proper ME{spdep} usage
Message-ID: <CADYQ-MJ98ODHBvqaHm9AQr_4gAfK5gpG=35=XZR+xWcLUNETbA@mail.gmail.com>

Hi,

My data consists of two species counts derived from fixed position
traps over 6 months. It is very skewed. I also collected data on
environmental variables such as building characteristic for where the
traps were located.

I would like to make sure I am using the function ME{spdep}
properly.First I ran a negative binomial regression to identify theta
and then a glm with family=nb(theta). I created a correlogram of
residuals using Moran?s I . If spatial autocorrelation was present I
removed it with ME and then compared AIC to determine if it improved
model. I ran another correlog to see if the spatial autocorrelation
was removed. Most of the time spatial autocorrelation is still present
but seemed to be at a different distance class and the model did not
improve.


I have attached a few examples of my script for different
environmental variables and subsets of my data. I am sorry I am not
able to post on website. Thank you very much for your advise.

Best,
Amy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Examples.R
Type: application/octet-stream
Size: 19652 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/e4f7a509/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Data_All.csv
Type: text/csv
Size: 5325 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/e4f7a509/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Data_InHDB.csv
Type: text/csv
Size: 2535 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/e4f7a509/attachment-0001.bin>

From olivierf at umd.edu  Fri Aug  2 02:45:18 2013
From: olivierf at umd.edu (Olivier Francois)
Date: Fri, 2 Aug 2013 00:45:18 +0000
Subject: [R-sig-Geo] Predict and spml
In-Reply-To: <9EE2F9439857F24394462255BCD7117008667B11@OITMX1005.AD.UMD.EDU>
References: <9EE2F9439857F24394462255BCD7117008667B11@OITMX1005.AD.UMD.EDU>
Message-ID: <9EE2F9439857F24394462255BCD7117008667B8A@OITMX1005.AD.UMD.EDU>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130802/c641540b/attachment.pl>

From bakare at ualberta.ca  Fri Aug  2 04:14:50 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Thu, 1 Aug 2013 20:14:50 -0600
Subject: [R-sig-Geo] grid size for irregular space spatial data
Message-ID: <CAJRR3XOYoXCq39+QL0Ju8uHmZFE4BYOdjkth=A6W=xE7FwWY4A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130801/cd75499a/attachment.pl>

From losedaghat at gmail.com  Fri Aug  2 10:03:03 2013
From: losedaghat at gmail.com (L S)
Date: Fri, 2 Aug 2013 04:03:03 -0400
Subject: [R-sig-Geo] Local spatial autocorrelation/Moran scatterplot without
 a spatial weights matrix
Message-ID: <CAMgNocvU+XK+SVry6m0NKzHc7GxrwZOJw06+T0qUAq6Px6G5ag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130802/0b09c454/attachment.pl>

From saldanha.plangeo at gmail.com  Fri Aug  2 15:11:03 2013
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Fri, 2 Aug 2013 10:11:03 -0300
Subject: [R-sig-Geo] ggmap route planning
Message-ID: <CACSWb41ggOMLfpjt-MDzJq24WVN7gxAfSrv9b96gA3TbeH_QMA@mail.gmail.com>

Hi!

I'm trying to get the best route plan using ggmap, starting from an
address and go to several destinations. Is there a way to get the best
route order minimizing the overall distance, and then map it?

Bellow an example:

# Start adress
add00 <- 'Anderson, TX'

# Destionations
add01 <- 'Andrews, TX'
add02 <- 'Bowie, TX'
add03 <- 'Clay, TX'
add04 <- 'Crosby, TX'



Thanks in advance!

Raphael Saldanha


From M.Huck at derby.ac.uk  Fri Aug  2 16:46:01 2013
From: M.Huck at derby.ac.uk (Maren Huck)
Date: Fri, 2 Aug 2013 15:46:01 +0100
Subject: [R-sig-Geo] projection of South American Datum 1969 data
Message-ID: <0E1E893FE7447F4F883C415B21D0E5E901222CEE1E15@MKT-MBX01.university.ds.derby.ac.uk>

Dear List-members,
While trying to get to grips with spatial analysis I got seriously stuck when trying to use my own data that are, unfortunately not collected in a standard system.

I am working with data that have been collected in UTM based on the South American Datum 1969  (in Northern Argentina, UTM zone 21J South). (EPSG-code:4618; the ellps name in R seems to be "aust_SA", not SAD69) I would like to plot these on a satellite map from Google. However, the data seem to be slightly shifted. I have found +towgs84 values for SAD69 (-62, -1, -37), but I when I included these in the code nothing seems to change. (see example code below).
In the example code I provide the map from Google, and a transect line where it SHOULD (approximately) be, based on some manual alteration of the Longitude-Latitude values I get from transformation. (Printed on the map in green). I also provide the raw data, which, when converted using the suggested +towgs84 results in the blue line. If I grossly change to +towgs84 values (multiply by 1000) the transect is plotted at exactly the same location (red line), which suggests to me that this information is not really read.
I also found that 
> CRS("+init=espg:4618")
produces the following error
Error in CRS("+init=espg:4618") : no system list, errno: 2

And I find that excluding the argument +ellps=aust_SA and +init=epsg:4618 completely also leads to exactly the same result, i.e., the information that this should be the South American Datum does not seem to be read by R.
I also tried to set the major and minor radius directly with +a=6378160 +b=6356775, but this did also not work.
Is there anything I misunderstood, or anything else I can do to get the little shift 'fixed'? I tried to find answers in the internet, but did not find anything (that I understood; and many of kind-of-similar queries I found did not relate to R). 

####### My codes ##############
# I am working on a PC, MS Windows 7 Enterprise; R vs. 2.15.2 # The raw data #Longitude (West):
y<-c(381776.3, 381823.5, 381874, 381920.5, 381967, 382021, 382075, 382120.5, 382166, 382215, 382257, 382363) #Latitude (South):
x<-c(7127544, 7127555, 7127565, 7127572, 7127579, 7127588, 7127597, 7127607, 7127617, 7127634, 7127638, 7127651)

# manually corrected longitude latitude values:
west<-c(-58.1815, -58.181, -58.1805, -58.1801, -58.1796, -58.1791, -58.1785, -58.1781, -58.1776, -58.1771, -58.1767, -58.1756) south<-c(-25.9664, -25.9663, -25.9662, -25.9662, -25.9661, -25.966, -25.9659, -25.9659, -25.9658, -25.9656, -25.9656, -25.9655)  # The map
library(RgoogleMaps)
bb <- qbbox(c(-25.984194,-25.961097),c(-58.193481,-58.168056))    #, TYPE = "all", margin = list(m=c(1,1,1,1), TYPE = c("perc", "abs")[1]))
Guayc <- GetMap.bbox(bb$lonR, bb$latR,destfile = "Guaycolec.png", maptype = "satellite", zoom=15)

library(mapproj)
library(rgdal)
# Where the transect line should be:
tmp <- PlotOnStaticMap(Guayc, lat = south , lon = west, FUN=lines, col="green", lwd=2)

# What happens if I use the original UTM data
sps1 <- SpatialPoints(cbind(y, x), proj4string = CRS(paste("+proj=utm +zone=21J +init=epsg:4618 +south +ellps=aust_SA +towgs84=-61,-1,-37,0,0,0,0"))) GridTrans<-as.data.frame(spTransform(sps1, CRS("+proj=longlat"))) mygrid <- cbind.data.frame(lat = GridTrans[,"x"], lon=GridTrans[,"y"]) tmp <- PlotOnStaticMap(Guayc, lat = mygrid[,"lat"], lon = mygrid[,"lon"], FUN=lines, lwd=2, col="blue", add=T)

# and if I change the +towgs84 parameters nothing changes!
sps2 <- SpatialPoints(cbind(y, x), proj4string = CRS(paste("+proj=utm +zone=21J +init=epsg:4618 +south +ellps=aust_SA +towgs84=-61000,-1000,-37000,0,0,0,0")))
GridTrans2<-as.data.frame(spTransform(sps2, CRS("+proj=longlat")))
mygrid2 <- cbind.data.frame(lat = GridTrans2[,"x"], lon=GridTrans[,"y"]) tmp <- PlotOnStaticMap(Guayc, lat = mygrid2[,"lat"], lon = mygrid2[,"lon"], FUN=lines, lwd=2, col="red", add=T)



Any suggestions would be greatly appreciated.
Kind regards,


Maren
---------------------
Maren Huck
Dep. of Biological and Forensic Sciences University of Derby Kedleston Road Derby DE22 1GB U.K.
Tel: +44-(0)1332-59 2354

_____________________________________________________________________
The University of Derby has a published policy regarding email and reserves the right to monitor email traffic. If you believe this email was sent to you in error, please notify the sender and delete this email. Please direct any concerns to Infosec at derby.ac.uk.


From alex.maerz at gmx.net  Fri Aug  2 18:22:11 2013
From: alex.maerz at gmx.net (=?UTF-8?B?QWxleGFuZGVyIE3DpHJ6?=)
Date: Fri, 02 Aug 2013 18:22:11 +0200
Subject: [R-sig-Geo] =?utf-8?q?Error_message_when_calling_mgcv=C2=B4s_summ?=
	=?utf-8?q?ary?=
Message-ID: <51FBDCB3.2070902@gmx.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130802/d38bcb23/attachment.pl>

From james.miraflor at gmail.com  Fri Aug  2 20:13:41 2013
From: james.miraflor at gmail.com (James Matthew Miraflor)
Date: Sat, 3 Aug 2013 02:13:41 +0800
Subject: [R-sig-Geo] How to do Zonal Statistics after Kriging in R given
	Shapefile of Polygon
Message-ID: <CAPim8ZJggJScncT-h=bYY6CthnqUue4veKf3Z75Zh5GAj_c2xw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130803/fb73d9f2/attachment.pl>

From macqueen1 at llnl.gov  Fri Aug  2 21:19:53 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 2 Aug 2013 19:19:53 +0000
Subject: [R-sig-Geo] projection issue - can one rotate a projection?
In-Reply-To: <2F3B7BEC-9EF0-43D4-B41B-A53938223D45@yahoo.com.au>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521910D3CCDF7@PRDEXMBX-08.the-lab.llnl.gov>

The elide function in the maptools package has a 'rotate' argument and may
be able to do what you need.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 7/31/13 3:17 AM, "Tanya Rijkenberg Compton"
<tanyajcompton at yahoo.com.au> wrote:

>Hi all
>
>My colleague, a physical oceanographer, and I are having problems getting
>his geographic layers into the correct projection (after importing as a
>netcdf file), and we are hoping someone can help us. We are using the
>Raster package.
>
>My colleague obtains a Dutch Rijksdriehoek in the first instance but then
>rotates this by 17 degrees to run his models. He then provides me with a
>netcdf file where the layers are still projected at 17 degrees from the
>normal Rijksdriehoek.
>
>Is there a way in R to rotate the layers back from the 17 degrees?
>
>If anyone can help we would greatly appreciate it!
>
>Thanks
>
>Tanya and Matias
>
>
>
>R Code 
># Load the packages:
>library("sp")
>library("ncdf4")
>library(raster)
>
># get the netcdf and read in to R
>d <- raster("test_layers.nc", varname = "time_exp")
>
># rijksdriehoek projection
>RD <-CRS("+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
>+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs")
>##http://spatialreference.org/ref/epsg/28992/proj4/,
>
># reproject to Rijksdriehoek
>pr1 <- projectRaster(d, crs=newproj)
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From berman.jesse at gmail.com  Fri Aug  2 23:51:58 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Fri, 2 Aug 2013 14:51:58 -0700 (PDT)
Subject: [R-sig-Geo] How to do Zonal Statistics after Kriging in R given
 Shapefile of Polygon
In-Reply-To: <CAPim8ZJggJScncT-h=bYY6CthnqUue4veKf3Z75Zh5GAj_c2xw@mail.gmail.com>
References: <CAPim8ZJggJScncT-h=bYY6CthnqUue4veKf3Z75Zh5GAj_c2xw@mail.gmail.com>
Message-ID: <1375480318827-7584332.post@n2.nabble.com>

James,

Have you considered block kriging with gstat?  This will allow a smoothed
estimate of an area average (e.g. a county or town boundary) as opposed to
over a fine grid.

It's relatively simple, as you merely set the town boundary as your
'newdata,' although you will have to make sure it's in the same projection
as your points.

kr <- krige(POVERTY_INCIDENCE~1, muni.sp, newdata=town, model=v.fin)
spplot(kr, "var1.pred", col.regions = rev(topo.colors(20)))

Jesse




-----
--------------------------------------------------------
Jesse D Berman, PhD
Johns Hopkins Bloomberg School of Public Health
Department of Environmental Health Sciences
Post-Doc 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-do-Zonal-Statistics-after-Kriging-in-R-given-Shapefile-of-Polygon-tp7584330p7584332.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Sat Aug  3 01:09:16 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 2 Aug 2013 17:09:16 -0600
Subject: [R-sig-Geo] Error in plotKML
Message-ID: <CABkCotR+XKLcwfeAxbH88+pdszeSHN5HSEoLCh-bwzGonC=UAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130802/6ac13dba/attachment.pl>

From duncan at mcpherson.org.uk  Sun Aug  4 23:24:54 2013
From: duncan at mcpherson.org.uk (Duncan McPherson)
Date: Sun, 4 Aug 2013 22:24:54 +0100
Subject: [R-sig-Geo] install rgdal to query postgis database
References: <3D8827DF-57B9-419D-BA06-FDB33C82DD31@mcpherson.org.uk>
Message-ID: <BC7B2705-A065-4E22-85BE-E046E4A50896@mcpherson.org.uk>

An update that may shed some light on my issue:

Mysteriously it started working, I was able to import some spatial tables form PostGIS to R, and plot them, and I was about to thank the list and close the discussion, when it broke again. This was just after I updated some packages, so, through luck I still had the old version of rgdal and tried both.

The old one works, the new one doesn't. But the difference is also in the version of GDAL that is loaded. And, what is more confusing, is that once I have loaded the old version of rgdal, which has found the new version of GDAL, loading the new version of rgdal again also finds this new version of GDAL and works (see the session details below). However, my original problem was with the old version of rgdal and new version of GDAL, that now works.

Now I'm thoroughly confused. But here is a question:

Is there a way of controlling where rgdal looks for GDAL? And for other users, is it worth flagging this as an issue with rgdal, or is it some quirk of my system?

Thanks again,

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_3.0.1
> dsn="PG:dbname=health_england user=postgres"
> ogrListLayers(dsn)
Error: could not find function "ogrListLayers" #obviously
> library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")    #The NEW version, that fails
Loading required package: sp
rgdal: version: 0.8-10, (SVN revision 478)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.8-10 sp_1.0-11   

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15 tools_3.0.1    
> ogrListLayers(dsn)
Error in ogrListLayers(dsn) : Cannot open data source
> detach("package:rgdal", unload=TRUE)
Warning messages:
1: In FUN(X[[2L]], ...) :
  Created a package name, ?2013-08-04 21:51:37?, when none found
2: In FUN(X[[2L]], ...) :
  Created a package name, ?2013-08-04 21:51:37?, when none found
> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_1.0-11

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15 tools_3.0.1    
> library("rgdal", lib.loc="/Users/duncan/Library/R/3.0/library")    #The OLD version, that works
rgdal: version: 0.8-8, (SVN revision 463)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: 
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)
> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.8-8 sp_1.0-11  

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15 tools_3.0.1    
> ogrListLayers(dsn)
 [1] ? [list of layers]
> detach("package:rgdal", unload=TRUE)
Warning messages:
1: In FUN(X[[2L]], ...) :
  Created a package name, ?2013-08-04 22:06:10?, when none found
2: In FUN(X[[2L]], ...) :
  Created a package name, ?2013-08-04 22:06:10?, when none found
> library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")	#The NEW version again, now it works
rgdal: version: 0.8-10, (SVN revision 478)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: 
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
> ogrListLayers(dsn)
 [1] ?[list of layers] 


From bakare at ualberta.ca  Mon Aug  5 08:09:23 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 5 Aug 2013 00:09:23 -0600
Subject: [R-sig-Geo] gstat Optimal variogram model and grid size
Message-ID: <CAJRR3XOVzBfGuj4bGBND1eC9xYRzL8=zPPbbYC+4gqWMDFP9pw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130805/7c351b6d/attachment.pl>

From ROONEYJ4 at tcd.ie  Mon Aug  5 08:44:32 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 5 Aug 2013 07:44:32 +0100
Subject: [R-sig-Geo] R2Winbugs - problem with workign directory
Message-ID: <75C8D19A1470D344A8AF5312F01160A602956D0E762B@GOMAIL.college.tcd.ie>

Hi all,

Having a problem with the R2Winbugs working.directory option.

My call to winbugs looks like this:

MCMCres<-bugs(debug=T,data=d,inits=inits,parameters.to.save=c("theta","alpha","tau","precv"),
              n.chains=2,n.iter=2000,n.burnin=500,n.thin=10, 
              model.file="ALS_spatial_CAR.txt", program="WinBUGS", WINE=WINE, WINEPATH=WINEPATH,useWINE=T,
              working.directory=".",codaPkg=F)

If I remove the working.directory option this all works fine.
If I leave it in - winbugs opens but doesn't load any model and doesn't do anything. It IS finding the model specification file because if it doens't R2winbugs gives an error.

I'm totally at a loss as to what is going on. Any ideas ?

This same line of code runs fine by the way if I open a Windows virtual machine and run R directly under winbugs - the problem there is the VM has limited memory and process allocation.

I hope someone can help! Many thanks,

James

From oscar.perpinan at gmail.com  Mon Aug  5 15:16:06 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Mon, 5 Aug 2013 15:16:06 +0200
Subject: [R-sig-Geo] ggmap route planning
In-Reply-To: <CACSWb41ggOMLfpjt-MDzJq24WVN7gxAfSrv9b96gA3TbeH_QMA@mail.gmail.com>
References: <CACSWb41ggOMLfpjt-MDzJq24WVN7gxAfSrv9b96gA3TbeH_QMA@mail.gmail.com>
Message-ID: <CAMLL7b=s08qM4M4vjHZHEJo4-XTropoEHZN5GXDEjp=BFahWuA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130805/8af871c7/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Mon Aug  5 16:37:24 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Mon, 05 Aug 2013 16:37:24 +0200
Subject: [R-sig-Geo] raster/rgdal- problem: Too many open files (Linux)
Message-ID: <51FFB8A4.4030400@jrc.ec.europa.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130805/b921a92c/attachment.pl>

From phytophthorasb at yahoo.com  Mon Aug  5 21:18:47 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Mon, 5 Aug 2013 12:18:47 -0700 (PDT)
Subject: [R-sig-Geo] Joining polygon and raster attributes
In-Reply-To: <1365802176.23889.YahooMailNeo@web142506.mail.bf1.yahoo.com>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>	<1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>	<alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>	<1365544586.27248.YahooMailNeo@web142506.mail.bf1.yahoo.com>	<alpine.LRH.2.03.1304100849590.8232@reclus.nhh.no>
	<1365802176.23889.YahooMailNeo@web142506.mail.bf1.yahoo.com>
Message-ID: <1375730327.40393.YahooMailNeo@web142503.mail.bf1.yahoo.com>

 
Hi. 
I?m trying to develop a repeatable
process in R that I can use with a variety of data. Basically I'm trying to
join/merge/combine/intersect?(I?m not sure technically which word is
right) a polygon and a raster so that I can do summaries on attributes from
both. I have A) a polygon shape file of terrestrial ecoregions (contains a
number of attributes that I am interested in) and B) a raster that is
categories (0-2), but later I might have a continuous raster. Specifically, I
want to ask things like what is the total area or proportion of area of biomes
(from polygon A) that are >0 (from raster B). [Note that zonal statistics
does Not seem to do what I want]. 
?
Below is some of the R code I have
tried and below that is the really cumbersome way I almost got it to work in
ArcGIS in case that clarifies what I?m trying to do ? but I?m keen to do it in a
scripted way since I will be changing the data later.
?
I?m grateful for any suggestions.
Thanks!
? Juliann

??????????
In R the closest I got is this, but I'm not sure I'm even on the right track. Perhaps I should be going about it in a completely different way.
#(I probably don't need all these libraries. I was trying a lot of different things.)

library(sp)??????????? 
library(raster)???????? 
library(rgdal)
library(maptools)
library(rgeos)

dryras <- raster("~overlay1.tif") #cells have values 0-2.
teow <-readOGR(dsn=".", layer="teow_africa")
#Terrestrial Ecoregions of the World
pdf("quickplots.pdf")
plot(dryras)
plot(teow)
dev.off()????????? 
#Yup
looks about the same as in arcgis

# overlay points on raster and create new shapefile with extracted values in
attribute table 

samp = extract(dryras, teow)
#sampsm<-extract(dryras, teow, small=TRUE)? #maybe this would be better, but let?s see if it works first.
#So far so good, it looks as though
each polygon has different numbers of 0,1,2 associated with it (not sure how I'm going to get area from this,
which is what I really want), but then it falls apart. I don't have column
names on samp, for one thing (>names(samp) yields NULL)

# combine with polygon data
#One tangential
problem is that I'm trying to use merge from the base library and raster also
has merge, so I first removed raster before this step. I'm sure there's a simple and obvious solution!#
test1 <- cbind(as.data.frame(teow),
samp) 
test2<-merge(teow, samp) 
test3<-merge(teow, samp, by.x=[,1], by.y="OBJECTID", all.x=TRUE,
all.y=TRUE, sort=FALSE)


for test1& test2 the error is
"Error in data.frame(c(0, 0, 0, 0, 0, 0), c(0, 0, 0, 0, 0, 0, 0, 0,
0,? : ? arguments imply differing number of rows: . . ."
for test 3 the error is "Error:
unexpected '[' in "test2<-merge(teow, samp, by.x=[""
?
Other things I've played with (over,
gIntersection, rasterize)
?
What I did in ArcGIS and JMP
I came up with a really cumbersome and
ugly brute force method (that I know for certain does not come out quite
right): In ARCGIS, I converted the raster to a polygon, then used a union to
combine this with?the ecoregions polygon so that there were new polygons
for each polygon-rastervalue combination that have all the attributes together.
Then I added an area field to this new polygon table. This process didn't work
very well as it left a few hundred weird (v. small) polygons that don't make
sense and are missing attributes. Also, I don't think I used the right area
calculator. Nevertheless, I took the table into JMP (just for the fun of
looking at data) and was able to very easily do the sorts of summaries I was
interested in. But I?d really like to script this and I know I can do those
summaries in R if I get the first part working.


From saldanha.plangeo at gmail.com  Mon Aug  5 21:22:15 2013
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 5 Aug 2013 16:22:15 -0300
Subject: [R-sig-Geo] ggmap route planning
In-Reply-To: <CAMLL7b=s08qM4M4vjHZHEJo4-XTropoEHZN5GXDEjp=BFahWuA@mail.gmail.com>
References: <CACSWb41ggOMLfpjt-MDzJq24WVN7gxAfSrv9b96gA3TbeH_QMA@mail.gmail.com>,
	<CAMLL7b=s08qM4M4vjHZHEJo4-XTropoEHZN5GXDEjp=BFahWuA@mail.gmail.com>
Message-ID: <BLU177-W31816A057CABE9B0BDF9C0D45C0@phx.gbl>

Hi Oscar, thanks!

---

Regards,

Raphael Saldanha
rfsaldanha at outlook.com

Date: Mon, 5 Aug 2013 15:16:06 +0200
Subject: Re: [R-sig-Geo] ggmap route planning
From: oscar.perpinan at gmail.com
To: saldanha.plangeo at gmail.com
CC: r-sig-geo at stat.math.ethz.ch

Hello,Try the osmar package: http://osmar.r-forge.r-project.org/.The section "R as navigator" of their paper includes an useful example: http://journal.r-project.org/archive/2013-1/eugster-schlesinger.pdfBest,Oscar.Oscar Perpi??n Lamigueiro 
Grupo de Sistemas Fotovoltaicos (IES-UPM) 
Dpto. Ingenier?a El?ctrica (EUITI-UPM) 
URL: http://procomun.wordpress.com 
Twitter: @oscarperpinan
LinkedIn: http://es.linkedin.com/in/oscarperpinanEl 02/08/2013 15:12, "Raphael Saldanha" <saldanha.plangeo at gmail.com> escribi?:
Hi!

I'm trying to get the best route plan using ggmap, starting from an
address and go to several destinations. Is there a way to get the best
route order minimizing the overall distance, and then map it?

Bellow an example:

# Start adress
add00 <- 'Anderson, TX'

# Destionations
add01 <- 'Andrews, TX'
add02 <- 'Bowie, TX'
add03 <- 'Clay, TX'
add04 <- 'Crosby, TX'



Thanks in advance!

Raphael Saldanha

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo 		 	   		  

From phytophthorasb at yahoo.com  Mon Aug  5 22:38:38 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Mon, 5 Aug 2013 13:38:38 -0700 (PDT)
Subject: [R-sig-Geo] Joining polygon and raster attributes
Message-ID: <1375735118.16549.YahooMailNeo@web142504.mail.bf1.yahoo.com>

[I apologize for reposting this ? it showed up in the archive under the wrong subject, which would make it less useful as an archive.]


Hi. 
I?m trying to develop a repeatable process in R that I can use with a variety of data. Basically I'm trying to join/merge/combine/intersect?(I?m not sure technically which word is right) a polygon and a raster so that I can do summaries on attributes from both. I have A) a polygon shape file of terrestrial ecoregions (contains a number of attributes that I am interested in) and B) a raster that is categories (0-2), but later I might have a continuous raster. Specifically, I want to ask things like what is the total area or proportion of area of biomes (from polygon A) that are >0 (from raster B). [Note that zonal statistics does Not seem to do what I want]. 

Below is some of the R code I have? tried and below that is the really cumbersome way I almost got it to work in? ArcGIS in case that clarifies what I?m trying to do ? but I?m keen to do it in a scripted way since I will be changing the data later. 

I?m grateful for any suggestions. 
Thanks! 
? Juliann 


In R the closest I got is this, but I'm not sure I'm even on the right track. Perhaps I should be going about it in a completely different way.?

#(I probably don't need all these libraries. I was trying a lot of different things.) 

library(sp)??????????? 
library(raster)???????? 
library(rgdal) 
library(maptools) 
library(rgeos) 

dryras <- raster("~overlay1.tif") #cells have values 0-2. 
teow <-readOGR(dsn=".", layer="teow_africa") 
#Terrestrial Ecoregions of the World 
pdf("quickplots.pdf") 
plot(dryras) 
plot(teow) 
dev.off()????????? 
#Yup looks about the same as in arcgis 

# overlay points on raster and create new shapefile with extracted values in attribute table 

samp = extract(dryras, teow) 
#sampsm<-extract(dryras, teow, small=TRUE)? #maybe this would be better, but let?s see if it works first. 
#So far so good, it looks as though each polygon has different numbers of 0,1,2 associated with it (not sure how I'm going to get area from this, which is what I really want), but then it falls apart. I don't have column 
names on samp, for one thing (>names(samp) yields NULL) 

# combine with polygon data 
#One tangential problem is that I'm trying to use merge from the base library and raster also has merge, so I first removed raster before this step. I'm sure there's a simple and obvious solution!# 
test1 <- cbind(as.data.frame(teow), 
samp) 
test2<-merge(teow, samp) 
test3<-merge(teow, samp, by.x=[,1], by.y="OBJECTID", all.x=TRUE, 
all.y=TRUE, sort=FALSE) 


for test1& test2 the error is "Error in data.frame(c(0, 0, 0, 0, 0, 0), c(0, 0, 0, 0, 0, 0, 0, 0, 0,? : ? arguments imply differing number of rows: . . ." 
for test 3 the error is "Error: unexpected '[' in "test2<-merge(teow, samp, by.x=["" 

Other things I've played with (over, gIntersection, rasterize) 

What I did in ArcGIS and JMP 
I came up with a really cumbersome and ugly brute force method (that I know for certain does not come out quite right): In ARCGIS, I converted the raster to a polygon, then used a union to combine this with?the ecoregions polygon so that there were new polygons for each polygon-rastervalue combination that have all the attributes together. Then I added an area field to this new polygon table. This process didn't work 
very well as it left a few hundred weird (v. small) polygons that don't make sense and are missing attributes. Also, I don't think I used the right area calculator. Nevertheless, I took the table into JMP (just for the fun of 
looking at data) and was able to very easily do the sorts of summaries I was interested in. But I?d really like to script this and then I can do the summaries in R if I get the first part working.?? ? ?????????? ? ?


From tephilippi at gmail.com  Tue Aug  6 01:03:48 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Mon, 5 Aug 2013 16:03:48 -0700
Subject: [R-sig-Geo] Joining polygon and raster attributes
In-Reply-To: <1375735118.16549.YahooMailNeo@web142504.mail.bf1.yahoo.com>
References: <1375735118.16549.YahooMailNeo@web142504.mail.bf1.yahoo.com>
Message-ID: <CALyPt8wYX8OhoJtSBqFSV==mT0nYAB2stzejqXHwE+ms3EEHvw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130805/e820b27a/attachment.pl>

From E.Couce.07 at bristol.ac.uk  Tue Aug  6 02:23:32 2013
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Mon, 5 Aug 2013 17:23:32 -0700 (PDT)
Subject: [R-sig-Geo] autoKrige: singular matrix in function LDLfactor
Message-ID: <1375748612704-7584343.post@n2.nabble.com>

Dear List,

I have a dataset (with an irregular grid) which I am trying to interpolate
to a regular grid with much higher spatial resolution using the autoKrige
function from the package 'automap'. But I get the error:

> SST_data <- autoKrige(SST~1, HG1990, center_points2, nmax=50)
[using ordinary kriging]

"chfactor.c", line 131: singular matrix in function LDLfactor()
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  : 
  LDLfactor


I understand this error could be due to duplicated points either within the
dataset itself or between the dataset and the points I want to interpolate
to. But I fail to find any duplicates with the function zerodist (with
default minimum distance):

> zerodist(HG1990)
     [,1] [,2]
> zerodist2(HG1990,center_points2)
     [,1] [,2]


(In the example above both 'HG1990' and 'center_points2' are
SpatialPointsDataFrame objects).

Any other ideas of what could be causing this error or how to deal with it
would be greatly appreciated! (I will be happy to send the data to anybody
who wants to take a closer look).

Thanks in advance,
Elena




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/autoKrige-singular-matrix-in-function-LDLfactor-tp7584343.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ganimedes5 at hotmail.com  Tue Aug  6 10:53:47 2013
From: ganimedes5 at hotmail.com (=?iso-8859-1?B?Q2FybG9zIFbhenF1ZXo=?=)
Date: Tue, 6 Aug 2013 10:53:47 +0200
Subject: [R-sig-Geo] Changing values of raster pixels to NA
Message-ID: <DUB118-W24E02BB4E5324CC1D0096C815D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/ea0124ee/attachment.pl>

From roman.lustrik at gmail.com  Tue Aug  6 10:59:33 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 6 Aug 2013 10:59:33 +0200
Subject: [R-sig-Geo] Changing values of raster pixels to NA
In-Reply-To: <DUB118-W24E02BB4E5324CC1D0096C815D0@phx.gbl>
References: <DUB118-W24E02BB4E5324CC1D0096C815D0@phx.gbl>
Message-ID: <CAHT1vpissSsDHbgm1ZgBnj=guBS=MOeS0QvN14x4J0C_Y7N1Kg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/b9c6c8be/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug  6 11:56:07 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Aug 2013 11:56:07 +0200
Subject: [R-sig-Geo] install rgdal to query postgis database
In-Reply-To: <BC7B2705-A065-4E22-85BE-E046E4A50896@mcpherson.org.uk>
References: <3D8827DF-57B9-419D-BA06-FDB33C82DD31@mcpherson.org.uk>
	<BC7B2705-A065-4E22-85BE-E046E4A50896@mcpherson.org.uk>
Message-ID: <alpine.LRH.2.03.1308061147480.25878@reclus.nhh.no>

On Sun, 4 Aug 2013, Duncan McPherson wrote:

> An update that may shed some light on my issue:
>
> Mysteriously it started working, I was able to import some spatial 
> tables form PostGIS to R, and plot them, and I was about to thank the 
> list and close the discussion, when it broke again. This was just after 
> I updated some packages, so, through luck I still had the old version of 
> rgdal and tried both.
>
> The old one works, the new one doesn't. But the difference is also in 
> the version of GDAL that is loaded. And, what is more confusing, is that 
> once I have loaded the old version of rgdal, which has found the new 
> version of GDAL, loading the new version of rgdal again also finds this 
> new version of GDAL and works (see the session details below). However, 
> my original problem was with the old version of rgdal and new version of 
> GDAL, that now works.
>
> Now I'm thoroughly confused. But here is a question:
>
> Is there a way of controlling where rgdal looks for GDAL? And for other 
> users, is it worth flagging this as an issue with rgdal, or is it some 
> quirk of my system?

Your system. If you have multiple GDAL installed and install rgdal from 
source, you may see the rgdal configure script choosing one gdal-config, 
building using the path values it returns, but find another GDAL 
installation at run time on loading, if it is earlier in the search path 
for dylibs. There is a check that the GDAL_VERSION_MAJOR, 
GDAL_VERSION_MINOR values agree for the build phase and the run time, but 
if they do agree, it cannot distinguish between one GDAL with the driver 
you need, and another without it. You can check for the presence of the 
driver with ogrDrivers().

Roger

>
> Thanks again,
>
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_3.0.1
>> dsn="PG:dbname=health_england user=postgres"
>> ogrListLayers(dsn)
> Error: could not find function "ogrListLayers" #obviously
>> library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")    #The NEW version, that fails
> Loading required package: sp
> rgdal: version: 0.8-10, (SVN revision 478)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-10 sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15 tools_3.0.1
>> ogrListLayers(dsn)
> Error in ogrListLayers(dsn) : Cannot open data source
>> detach("package:rgdal", unload=TRUE)
> Warning messages:
> 1: In FUN(X[[2L]], ...) :
>  Created a package name, ?2013-08-04 21:51:37?, when none found
> 2: In FUN(X[[2L]], ...) :
>  Created a package name, ?2013-08-04 21:51:37?, when none found
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15 tools_3.0.1
>> library("rgdal", lib.loc="/Users/duncan/Library/R/3.0/library")    #The OLD version, that works
> rgdal: version: 0.8-8, (SVN revision 463)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
> Path to GDAL shared files:
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-8 sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15 tools_3.0.1
>> ogrListLayers(dsn)
> [1] ? [list of layers]
>> detach("package:rgdal", unload=TRUE)
> Warning messages:
> 1: In FUN(X[[2L]], ...) :
>  Created a package name, ?2013-08-04 22:06:10?, when none found
> 2: In FUN(X[[2L]], ...) :
>  Created a package name, ?2013-08-04 22:06:10?, when none found
>> library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")	#The NEW version again, now it works
> rgdal: version: 0.8-10, (SVN revision 478)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
> Path to GDAL shared files:
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
>> ogrListLayers(dsn)
> [1] ?[list of layers]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From berman.jesse at gmail.com  Tue Aug  6 15:44:37 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Tue, 6 Aug 2013 06:44:37 -0700 (PDT)
Subject: [R-sig-Geo] autoKrige: singular matrix in function LDLfactor
In-Reply-To: <1375748612704-7584343.post@n2.nabble.com>
References: <1375748612704-7584343.post@n2.nabble.com>
Message-ID: <1375796677539-7584348.post@n2.nabble.com>

Elena,

Is this projected data?  I previously noted that zerodist() fails to work
under certain projections
(http://r-sig-geo.2731867.n2.nabble.com/zerodist-fails-with-Projected-Data-td7584211.html). 
Dr. Pebesma has noted this bug.  

Jesse



-----
--------------------------------------------------------
Jesse D Berman, PhD
Yale University
School of Forestry and Environmental Studies
Post-Doc Fellow
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/autoKrige-singular-matrix-in-function-LDLfactor-tp7584343p7584348.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From FTroude at air-rhonealpes.fr  Tue Aug  6 17:48:24 2013
From: FTroude at air-rhonealpes.fr (TROUDE Florence)
Date: Tue, 6 Aug 2013 15:48:24 +0000
Subject: [R-sig-Geo] plotKML coerce levels ?
Message-ID: <50E0004697686748A59DF2A04CED20BD2FBDA99E@Inf-ExchLyon.ATMO.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/3ccb072f/attachment.pl>

From Virgilio.Gomez at uclm.es  Tue Aug  6 18:21:19 2013
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Tue, 06 Aug 2013 18:21:19 +0200
Subject: [R-sig-Geo] R2Winbugs - problem with workign directory
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602956D0E762B@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602956D0E762B@GOMAIL.college.tcd.ie>
Message-ID: <1375806079.9138.1.camel@Virgilio-Gomez>

Hi James,

Try to use the full path (e.g., /home/james/mycode/...) instead of just
".".

Also, from the manual page:

 If 'useWINE=TRUE' is used, all paths (such as 'working.directory'
     and 'model.file', must be given in native (Unix) style, but
     'bugs.directory' can be given in Windows path style (e.g.
     "c:/Program Files/WinBUGS14/") or native (Unix) style (e.g.
     "/path/to/wine/folder/dosdevices/c:/Program Files/WinBUGS14").
     This is done to achieve greatest portability with default argument
     value for 'bugs.directory'.


Hope this helps.

Virgilio


El lun, 05-08-2013 a las 07:44 +0100, James Rooney escribi?:
> Hi all,
> 
> Having a problem with the R2Winbugs working.directory option.
> 
> My call to winbugs looks like this:
> 
> MCMCres<-bugs(debug=T,data=d,inits=inits,parameters.to.save=c("theta","alpha","tau","precv"),
>               n.chains=2,n.iter=2000,n.burnin=500,n.thin=10, 
>               model.file="ALS_spatial_CAR.txt", program="WinBUGS", WINE=WINE, WINEPATH=WINEPATH,useWINE=T,
>               working.directory=".",codaPkg=F)
> 
> If I remove the working.directory option this all works fine.
> If I leave it in - winbugs opens but doesn't load any model and doesn't do anything. It IS finding the model specification file because if it doens't R2winbugs gives an error.
> 
> I'm totally at a loss as to what is going on. Any ideas ?
> 
> This same line of code runs fine by the way if I open a Windows virtual machine and run R directly under winbugs - the problem there is the VM has limited memory and process allocation.
> 
> I hope someone can help! Many thanks,
> 
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From zua3 at cornell.edu  Tue Aug  6 18:37:25 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Tue, 6 Aug 2013 16:37:25 +0000
Subject: [R-sig-Geo] Changing values of raster pixels to NA
In-Reply-To: <DUB118-W24E02BB4E5324CC1D0096C815D0@phx.gbl>
References: <DUB118-W24E02BB4E5324CC1D0096C815D0@phx.gbl>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B9615975AED@CH1PRD0410MB391.namprd04.prod.outlook.com>

You can try this:

files <- list.files(pattern='.tif$')
s <- stack(files)
names(s)
nl <- nlayers(s)

# Create Raster: values <1:
rc1<-function(x){
  ifelse(x>1.000,0,
    ifelse(x<=1.000,1,NA))}

r1.rc1<-calc(s,fun=rc1)
plot(r1.rc1)
r1<-r1.rc1*s
plot(r1)

# Create raster: values >=-1 and <=1
rc2<-function(x){
  ifelse(x< -1.000,0,
    ifelse(x>= -1.000,1,NA))}

r2.rc2<-calc(r1,fun=rc2)
r2<-r1*r2.rc2
plot(r2)

Zia
-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Carlos V?zquez
Sent: Tuesday, August 06, 2013 4:54 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Changing values of raster pixels to NA

Hi to all,
I have a problem using raster stacks in R.
I have a set of raster layers with pixel reliability information for NDVI with pixel values of 0,1,2, and 3 Since i am not interested in values 2 and 3, I want to change all 2 and 3 values in the raster layers to NA's I am using the following formula:

 NDVI[NDVI==3|NDVI==2]<-NA


It works fine for single rasters but when applying to a raster stack, it gives strange results, converting some 0 and 1 values to NA as well.

Any ideas of what might be wrong?
Any help will be appreciated.

Thanks in advance!

MSc. student

Carlos  V?zquez 
 		 	   		  
	[[alternative HTML version deleted]]


From mauricio.zambrano at jrc.ec.europa.eu  Tue Aug  6 19:02:42 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 06 Aug 2013 19:02:42 +0200
Subject: [R-sig-Geo] raster/rgdal- problem: Too many open files (Linux)
In-Reply-To: <51FFB8A4.4030400@jrc.ec.europa.eu>
References: <51FFB8A4.4030400@jrc.ec.europa.eu>
Message-ID: <52012C32.8090202@jrc.ec.europa.eu>

On 08/05/2013 04:37 PM, Jon Olav Skoien wrote:
> Dear list,
>
> We have a problem which appears to be a bug in either rgdal or raster,
> although it could also be a bug in base R or in our understanding of how
> to deal with connections.
>
> We have a process which is writing a rather large (~10-20.000) number of
> geoTiffs via writeRaster. However, the process has frequently stopped
> with an error of the type:
> Error in .local(.Object, ...) :
>     TIFFOpen:/local0/skoiejo/hri/test.tif: Too many open files
> The issue seems to be the creation of temp-files in the temp directory
> which is given by tempdir(), not by raster:::.tmpdir(). These temp-files
> seem to be created by the call
>     transient <- new("GDALTransientDataset", driver=driver, rows=r at nrows,
> cols=r at ncols, bands=nbands, type=dataformat, fname=filename,
> options=options, handle=NULL)
> from raster:::.getGDALtransient
> The temp-files are deleted after writing the geoTiff, but are not
> removed from the list of open files in Linux, which on our system was
> limited to 1024 files (ulimit -n) per process. Below is a script which
> can replicate the issue (takes a few minutes to reach 1024) and
> sessionInfo().
>
> Currently we are trying to solve the issue by increasing the limit of
> file connections, but we would prefer a solution where the connections
> are properly deleted, either before writeRaster finishes, or a command
> which we can include in our script, either R-code or a call to System().
> The connections are not visible via showConnections(), and
> closeAllConnections() does not help.
>
> Thanks,
> Jon

I stumbled across the same problem (with exactly the same configuration 
reported by Jon with 'sessionInfo()'), while trying to change the values 
of some pixels in more than 6000 maps.

Thank  you very much Jon for the detailed report about the problem, 
which helped me to find a workaround to this problem (so far, just to 
split the 6000 maps in smaller groups).

>
>
> r <- raster(system.file("external/test.grd", package="raster"))
> for (ifile in 1:2000) {
>     writeRaster(r, "test.tif", format = "GTiff", overwrite = TRUE)
>     print(ifile)
> }
>

After trying the previous reproducible code, I don't understand why I 
got the error when ifile=1019 and not 1024:

....
[1] 1018
[1] 1019
Error in .local(.Object, ...) :
   TIFFOpen:/home/hzambran/test.tif: Too many open files



Thanks again Jon for sharing your findings about this.

All the best,

Mauricio Zambrano-Bigiarini, Ph.D


-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
"Sometimes life's going to hit you in the head
with a brick. Don't lose faith" (Steve Jobs)


> After the script stops, I checked the open files from the process, and
> got the following:
>    lsof -aPn -p 596 | more
> COMMAND PID    USER   FD   TYPE DEVICE SIZE/OFF     NODE NAME
> R       596 skoiejo  cwd    DIR   8,17   139264  4213416
> /local0/skoiejo/Raster_temp
> R       596 skoiejo  rtd    DIR  253,0     4096        2 /
> R       596 skoiejo  txt    REG  253,0    14192  2500779
> /usr/lib64/R/bin/exec/R
> R       596 skoiejo  mem    REG  253,0  2679280  2501177
> /usr/lib64/R/lib/libR.so
> ......................
>
> R       596 skoiejo 1015u   REG  253,0      238  4983213
> /tmp/RtmpNyOKCk/toptest.tif (deleted)
> R       596 skoiejo 1016u   REG  253,0      238  4983214
> /tmp/RtmpNyOKCk/qxdtest.tif (deleted)
> R       596 skoiejo 1017u   REG  253,0      238  4983215
> /tmp/RtmpNyOKCk/zwotest.tif (deleted)
> R       596 skoiejo 1018u   REG  253,0      238  4983216
> /tmp/RtmpNyOKCk/cnqtest.tif (deleted)
> R       596 skoiejo 1019u   REG  253,0      238  4983217
> /tmp/RtmpNyOKCk/lottest.tif (deleted)
> R       596 skoiejo 1020u   REG  253,0      238  4983218
> /tmp/RtmpNyOKCk/fartest.tif (deleted)
> R       596 skoiejo 1021u   REG  253,0      238  4983219
> /tmp/RtmpNyOKCk/vsqtest.tif (deleted)
> R       596 skoiejo 1022u   REG  253,0      238  4983220
> /tmp/RtmpNyOKCk/czptest.tif (deleted)
>
> Even if tested by someone with a limit higher than 2000, it should still
> be possible to see the long list of open connections, as above.

>
>   > sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-redhat-linux-gnu (64-bit)
>
> locale:
>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>    [7] LC_PAPER=C                 LC_NAME=C
>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15
>
>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tephilippi at gmail.com  Tue Aug  6 20:14:45 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Tue, 6 Aug 2013 11:14:45 -0700
Subject: [R-sig-Geo] plotKML coerce levels ?
In-Reply-To: <50E0004697686748A59DF2A04CED20BD2FBDA99E@Inf-ExchLyon.ATMO.local>
References: <50E0004697686748A59DF2A04CED20BD2FBDA99E@Inf-ExchLyon.ATMO.local>
Message-ID: <CALyPt8y4f9SYnSp-z2kEN-eNbfoMBRe-bfTiDapGGS-w+ZqzNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/1be480e7/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug  6 21:35:21 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Aug 2013 21:35:21 +0200
Subject: [R-sig-Geo] raster/rgdal- problem: Too many open files (Linux)
In-Reply-To: <52012C32.8090202@jrc.ec.europa.eu>
References: <51FFB8A4.4030400@jrc.ec.europa.eu>
	<52012C32.8090202@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.03.1308062114020.29917@reclus.nhh.no>

On Tue, 6 Aug 2013, Mauricio Zambrano-Bigiarini wrote:

> On 08/05/2013 04:37 PM, Jon Olav Skoien wrote:
>> Dear list,
>> 
>> We have a problem which appears to be a bug in either rgdal or raster,
>> although it could also be a bug in base R or in our understanding of how
>> to deal with connections.
>> 
>> We have a process which is writing a rather large (~10-20.000) number of
>> geoTiffs via writeRaster. However, the process has frequently stopped
>> with an error of the type:
>> Error in .local(.Object, ...) :
>>     TIFFOpen:/local0/skoiejo/hri/test.tif: Too many open files
>> The issue seems to be the creation of temp-files in the temp directory
>> which is given by tempdir(), not by raster:::.tmpdir(). These temp-files
>> seem to be created by the call
>>     transient <- new("GDALTransientDataset", driver=driver, rows=r at nrows,
>> cols=r at ncols, bands=nbands, type=dataformat, fname=filename,
>> options=options, handle=NULL)
>> from raster:::.getGDALtransient
>> The temp-files are deleted after writing the geoTiff, but are not
>> removed from the list of open files in Linux, which on our system was
>> limited to 1024 files (ulimit -n) per process. Below is a script which
>> can replicate the issue (takes a few minutes to reach 1024) and
>> sessionInfo().
>> 
>> Currently we are trying to solve the issue by increasing the limit of
>> file connections, but we would prefer a solution where the connections
>> are properly deleted, either before writeRaster finishes, or a command
>> which we can include in our script, either R-code or a call to System().
>> The connections are not visible via showConnections(), and
>> closeAllConnections() does not help.
>> 
>> Thanks,
>> Jon
>
> I stumbled across the same problem (with exactly the same configuration 
> reported by Jon with 'sessionInfo()'), while trying to change the values of 
> some pixels in more than 6000 maps.
>
> Thank  you very much Jon for the detailed report about the problem, which 
> helped me to find a workaround to this problem (so far, just to split the 
> 6000 maps in smaller groups).
>
>> 
>> 
>> r <- raster(system.file("external/test.grd", package="raster"))
>> for (ifile in 1:2000) {
>>     writeRaster(r, "test.tif", format = "GTiff", overwrite = TRUE)
>>     print(ifile)
>> }
>> 
>
> After trying the previous reproducible code, I don't understand why I got the 
> error when ifile=1019 and not 1024:
>
> ....
> [1] 1018
> [1] 1019
> Error in .local(.Object, ...) :
>  TIFFOpen:/home/hzambran/test.tif: Too many open files
>

There are other files opened by the R process that reduce the number 
needed. The problem is in the GDAL bindings with R, I haven't tried to see 
whether other applications keeping GDAL loaded face the same issues. GDAL 
applications typically write once and exit, so this isn't a problem there.

The current GDAL.close() code says unlink() to a vector of files with the 
same basename, but actually unlink() now appears to fail, leaving the 
files in place. Using file.remove() leads to the same result, and using 
deleteFile() provokes other problems.

This will probably turn out to be something trivial, but will take a great 
deal of time to debug, as the consequences of changing the dataset 
structure are possibly extensive.

For the time being, the work-around is the only route; if volunteers can 
debug this, progress may be possible, but everything else has to continue 
to work.

Roger

>
>
> Thanks again Jon for sharing your findings about this.
>
> All the best,
>
> Mauricio Zambrano-Bigiarini, Ph.D
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From bakare at ualberta.ca  Tue Aug  6 21:41:36 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 6 Aug 2013 13:41:36 -0600
Subject: [R-sig-Geo] gstat- Interpolate geostatistical data with kriging
Message-ID: <CAJRR3XOfd9sFRbKSsz5neJBLR_1d+nP6GXqneybPp-kKxkctHQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/db7603ce/attachment.pl>

From amommendes at hotmail.com  Tue Aug  6 22:41:55 2013
From: amommendes at hotmail.com (amluiz)
Date: Tue, 6 Aug 2013 13:41:55 -0700 (PDT)
Subject: [R-sig-Geo] plotRGB - negative values
Message-ID: <1375821715547-7584356.post@n2.nabble.com>

Hello,

I'm trying to use plotRGB. But I've negative values in my rasters cells and
I get the following error:

plotRGB(all.pca)
Error in rgb(RGB[, 1], RGB[, 2], RGB[, 3], alpha = alpha, max = scale) : 
  color intensity -1, not in 0:255

Is there some way to solve this?

Thanks in advance,

Amom





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From etiennebr at gmail.com  Tue Aug  6 22:50:56 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 6 Aug 2013 16:50:56 -0400
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <1375821715547-7584356.post@n2.nabble.com>
References: <1375821715547-7584356.post@n2.nabble.com>
Message-ID: <CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/7f6d2a79/attachment.pl>

From jemiller31 at gmail.com  Tue Aug  6 22:59:30 2013
From: jemiller31 at gmail.com (Joseph Miller)
Date: Tue, 6 Aug 2013 15:59:30 -0500
Subject: [R-sig-Geo] can gCentroid preserve polygons data frame?
Message-ID: <CAE+tLNCtyh6ZqM__mj0-qFaWGsz5F6eg7sAJWwdrUcsqkcH5bQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/fd504bb7/attachment.pl>

From tephilippi at gmail.com  Tue Aug  6 23:25:35 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Tue, 6 Aug 2013 14:25:35 -0700
Subject: [R-sig-Geo] can gCentroid preserve polygons data frame?
In-Reply-To: <CAE+tLNCtyh6ZqM__mj0-qFaWGsz5F6eg7sAJWwdrUcsqkcH5bQ@mail.gmail.com>
References: <CAE+tLNCtyh6ZqM__mj0-qFaWGsz5F6eg7sAJWwdrUcsqkcH5bQ@mail.gmail.com>
Message-ID: <CALyPt8zWYXA_CEL4JadOJrDdKLP6CECE8EGcZEAeK9Yawisueg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130806/31a626d4/attachment.pl>

From ROONEYJ4 at tcd.ie  Wed Aug  7 00:46:15 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Tue, 6 Aug 2013 23:46:15 +0100
Subject: [R-sig-Geo] R2Winbugs - problem with workign directory
In-Reply-To: <1375806079.9138.1.camel@Virgilio-Gomez>
References: <75C8D19A1470D344A8AF5312F01160A602956D0E762B@GOMAIL.college.tcd.ie>,
	<1375806079.9138.1.camel@Virgilio-Gomez>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602956D0E762E@GOMAIL.college.tcd.ie>

Hi Virgilio,

Many thanks. As it happens today I switched to OpenBugs and don't have this particular problem anymore.

But thanks again,

James
________________________________________
From: Virgilio Gomez Rubio [Virgilio.Gomez at uclm.es]
Sent: 06 August 2013 17:21
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] R2Winbugs - problem with workign directory

Hi James,

Try to use the full path (e.g., /home/james/mycode/...) instead of just
".".

Also, from the manual page:

 If 'useWINE=TRUE' is used, all paths (such as 'working.directory'
     and 'model.file', must be given in native (Unix) style, but
     'bugs.directory' can be given in Windows path style (e.g.
     "c:/Program Files/WinBUGS14/") or native (Unix) style (e.g.
     "/path/to/wine/folder/dosdevices/c:/Program Files/WinBUGS14").
     This is done to achieve greatest portability with default argument
     value for 'bugs.directory'.


Hope this helps.

Virgilio


El lun, 05-08-2013 a las 07:44 +0100, James Rooney escribi?:
> Hi all,
>
> Having a problem with the R2Winbugs working.directory option.
>
> My call to winbugs looks like this:
>
> MCMCres<-bugs(debug=T,data=d,inits=inits,parameters.to.save=c("theta","alpha","tau","precv"),
>               n.chains=2,n.iter=2000,n.burnin=500,n.thin=10,
>               model.file="ALS_spatial_CAR.txt", program="WinBUGS", WINE=WINE, WINEPATH=WINEPATH,useWINE=T,
>               working.directory=".",codaPkg=F)
>
> If I remove the working.directory option this all works fine.
> If I leave it in - winbugs opens but doesn't load any model and doesn't do anything. It IS finding the model specification file because if it doens't R2winbugs gives an error.
>
> I'm totally at a loss as to what is going on. Any ideas ?
>
> This same line of code runs fine by the way if I open a Windows virtual machine and run R directly under winbugs - the problem there is the VM has limited memory and process allocation.
>
> I hope someone can help! Many thanks,
>
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mail at change.org  Wed Aug  7 08:20:01 2013
From: mail at change.org (Kanwal Nayan Singh)
Date: Wed, 07 Aug 2013 06:20:01 +0000
Subject: [R-sig-Geo] =?utf-8?q?I_just_signed_=E2=80=9CShri=2E_Manmohan_Sin?=
 =?utf-8?q?gh=2C_Prime_Minister_-_Government_of_India_=3A_Save_RTI_Act_fro?=
 =?utf-8?q?m_Amendments_=E2=80=9D?=
Message-ID: <5201e7117d3de_6bb2bd00881025af@production-change-main-resque-05.mail>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130807/7c922366/attachment.pl>

From ecouce at gmail.com  Wed Aug  7 09:41:45 2013
From: ecouce at gmail.com (ElenaC)
Date: Wed, 7 Aug 2013 00:41:45 -0700 (PDT)
Subject: [R-sig-Geo] autoKrige: singular matrix in function LDLfactor
In-Reply-To: <1375796677539-7584348.post@n2.nabble.com>
References: <1375748612704-7584343.post@n2.nabble.com>
	<1375796677539-7584348.post@n2.nabble.com>
Message-ID: <1375861305883-7584363.post@n2.nabble.com>

Thanks Jesse, 

the issue does indeed seem to be a malfunctioning of zerodist2(). The first
time I tried, when I got no matches, both SpatialPoints objects were
projected, with proj4string of "+proj=merc +ellps=WGS84". 

I have now tried again with the same data but unprojected (proj4string of
"+proj=longlat +ellps=WGS84"), and I am getting over 10,000 matches. But the
output still doesn't make any sense! (What I understand the function is
meant to do is find indexes in both objects with matching coordinates, but
it is not doing that): 

> match <- zerodist2(HG1990,center_points) 
> dim(match) 
[1] 13478     2 
> 
> match[1,] 
[1]  2840 51188 
> 
> coordinates(HG1990[2840,]) 
     coords.x1 coords.x2 
[1,]        48        48 
> coordinates(center_points[51188,]) 
     coords_lon2 coords_lat2 
[1,]      42.125      42.125 

The coordinates above certainly do not match (in fact there is not a single
pair of matching coordinates out of the over 13,000 rows returned by
zerodist2). Would this be a bug or am I interpreting the output incorrectly? 

These are the library versions I am using: 

> sessionInfo() 
R version 3.0.1 (2013-05-16) 
Platform: x86_64-apple-darwin10.8.0 (64-bit) 

locale: 
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8 

attached base packages: 
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages: 
[1] automap_1.0-12 gstat_1.0-16   ncdf_1.6.6     rgdal_0.8-10   sp_1.0-11     

loaded via a namespace (and not attached): 
[1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-5 
tools_3.0.1      xts_0.9-5        zoo_1.7-10   



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/autoKrige-singular-matrix-in-function-LDLfactor-tp7584343p7584363.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From hengl at spatial-analyst.net  Wed Aug  7 10:05:18 2013
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 07 Aug 2013 10:05:18 +0200
Subject: [R-sig-Geo] plotKML coerce levels ?
In-Reply-To: <CALyPt8y4f9SYnSp-z2kEN-eNbfoMBRe-bfTiDapGGS-w+ZqzNg@mail.gmail.com>
References: <50E0004697686748A59DF2A04CED20BD2FBDA99E@Inf-ExchLyon.ATMO.local>
	<CALyPt8y4f9SYnSp-z2kEN-eNbfoMBRe-bfTiDapGGS-w+ZqzNg@mail.gmail.com>
Message-ID: <5201FFBE.3030009@spatial-analyst.net>


Thanks Tom,

That is correct. If you use the "cut" command to convert to factors and 
then assign the labels, then you can assign any colours you like 
following the example from the plotKML tutorial:

 > data(worldgrids_pal)
 > pal = 
as.character(worldgrids_pal["corine2k"][[1]][c(1,11,13,14,16,17,18)])
 > plotKML(eberg_grid["LNCCOR6"], colour_scale=pal)

http://gsif.isric.org/lib/exe/detail.php?id=wiki%3Atutorial_plotkml&media=wiki:plot_factorvar.png

T. Hengl
http://www.wageningenur.nl/en/Persons/dr.-T-Tom-Hengl.htm

On 6-8-2013 20:14, Tom Philippi wrote:
> Florence--
> I might misunderstand your question, but I think that your problem is the
> type in your SpatialPixelsDataFrame, not your call to plotKML.  From what
> you describe, I assume that the values in your SpatialPixelsDataFrame are
> numeric.  If you want a specific color legend, you need to use a factor
> instead of a numeric.
>
> If your values in the SpatialPixelsDataFrame take exactly
> {2,4,10,30,60,100}, you may need to convert the values from numeric to a
> factor with factor().  If your values are numeric but take any value (e.g.,
> from 0 to 100), you may want to convert it to a factor using cut() with
> c(0,2,4,10,30,60,100).
>
> I hope that this helps and points you in the right direction.
> Tom
>
>
> On Tue, Aug 6, 2013 at 8:48 AM, TROUDE Florence
> <FTroude at air-rhonealpes.fr>wrote:
>
>> Dear list,
>>
>> I use the plotKML library to plot maps of simulation results (pollen maps).
>> It's quite great but I'd like to have some colors at some defined levels
>> such as :
>> 2 -> white
>> 4 -> green
>> 10 -> yellow
>> 30 -> orange
>> 60 -> red
>> 100 -> black
>>
>> my object is a SpatialPixelsdataframe or a SpatialGriddataframe.
>>
>> When I use plotKML with for instance data range from 0 to 10, I don't
>> menage to coerce the levels/colors of the map :
>> the color_scale always fit to the min/max of the data and don't fellow the
>> levels (2,4,10,30,60,100)...
>> I have tried colour_scale, colour, levels options but it doesn't work.
>>
>> Does anyone have encountered the same problem and fixed it ?
>>
>> Regards,
>>
>> Florence
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jon.skoien at jrc.ec.europa.eu  Wed Aug  7 10:18:40 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Wed, 07 Aug 2013 10:18:40 +0200
Subject: [R-sig-Geo] raster/rgdal- problem: Too many open files (Linux)
In-Reply-To: <alpine.LRH.2.03.1308062114020.29917@reclus.nhh.no>
References: <51FFB8A4.4030400@jrc.ec.europa.eu>
	<52012C32.8090202@jrc.ec.europa.eu>
	<alpine.LRH.2.03.1308062114020.29917@reclus.nhh.no>
Message-ID: <520202E0.5020203@jrc.ec.europa.eu>







On 06-Aug-13 21:35, Roger Bivand wrote:
> On Tue, 6 Aug 2013, Mauricio Zambrano-Bigiarini wrote:
>
>> On 08/05/2013 04:37 PM, Jon Olav Skoien wrote:
>>> Dear list,
>>>
>>> We have a problem which appears to be a bug in either rgdal or raster,
>>> although it could also be a bug in base R or in our understanding of 
>>> how
>>> to deal with connections.
>>>
>>> We have a process which is writing a rather large (~10-20.000) 
>>> number of
>>> geoTiffs via writeRaster. However, the process has frequently stopped
>>> with an error of the type:
>>> Error in .local(.Object, ...) :
>>>     TIFFOpen:/local0/skoiejo/hri/test.tif: Too many open files
>>> The issue seems to be the creation of temp-files in the temp directory
>>> which is given by tempdir(), not by raster:::.tmpdir(). These 
>>> temp-files
>>> seem to be created by the call
>>>     transient <- new("GDALTransientDataset", driver=driver, 
>>> rows=r at nrows,
>>> cols=r at ncols, bands=nbands, type=dataformat, fname=filename,
>>> options=options, handle=NULL)
>>> from raster:::.getGDALtransient
>>> The temp-files are deleted after writing the geoTiff, but are not
>>> removed from the list of open files in Linux, which on our system was
>>> limited to 1024 files (ulimit -n) per process. Below is a script which
>>> can replicate the issue (takes a few minutes to reach 1024) and
>>> sessionInfo().
>>>
>>> Currently we are trying to solve the issue by increasing the limit of
>>> file connections, but we would prefer a solution where the connections
>>> are properly deleted, either before writeRaster finishes, or a command
>>> which we can include in our script, either R-code or a call to 
>>> System().
>>> The connections are not visible via showConnections(), and
>>> closeAllConnections() does not help.
>>>
>>> Thanks,
>>> Jon
>>
>> I stumbled across the same problem (with exactly the same 
>> configuration reported by Jon with 'sessionInfo()'), while trying to 
>> change the values of some pixels in more than 6000 maps.
>>
>> Thank  you very much Jon for the detailed report about the problem, 
>> which helped me to find a workaround to this problem (so far, just to 
>> split the 6000 maps in smaller groups).
>>
>>>
>>>
>>> r <- raster(system.file("external/test.grd", package="raster"))
>>> for (ifile in 1:2000) {
>>>     writeRaster(r, "test.tif", format = "GTiff", overwrite = TRUE)
>>>     print(ifile)
>>> }
>>>
>>
>> After trying the previous reproducible code, I don't understand why I 
>> got the error when ifile=1019 and not 1024:
>>
>> ....
>> [1] 1018
>> [1] 1019
>> Error in .local(.Object, ...) :
>>  TIFFOpen:/home/hzambran/test.tif: Too many open files
>>
>
> There are other files opened by the R process that reduce the number 
> needed. The problem is in the GDAL bindings with R, I haven't tried to 
> see whether other applications keeping GDAL loaded face the same 
> issues. GDAL applications typically write once and exit, so this isn't 
> a problem there.
>
> The current GDAL.close() code says unlink() to a vector of files with 
> the same basename, but actually unlink() now appears to fail, leaving 
> the files in place. Using file.remove() leads to the same result, and 
> using deleteFile() provokes other problems.
>
> This will probably turn out to be something trivial, but will take a 
> great deal of time to debug, as the consequences of changing the 
> dataset structure are possibly extensive.
>
> For the time being, the work-around is the only route; if volunteers 
> can debug this, progress may be possible, but everything else has to 
> continue to work.
>
> Roger

Roger, thanks for having a look at this.
I just checked with an older version, and it seems the problem was 
introduced more or less at the same time as a valgrind issue was fixed 
in revision 456. Running the example above worked with R 2.14.0 and 
rgdal 0.8-5 (sessionInfo below), but failed when upgrading rgdal (and 
sp). The problem seems to be in the C++ code (I already tried to revert 
the R code of GDAL.close to 0.8-5, without any difference), which I am 
unfortunately not able to debug.

As there is no quick fix at the moment, I just thought it would be good 
to summarize the possible workarounds for other people who encounter 
this problem:
- Split up the process in smaller problems
- Increase the number of possible file connections (the standard on 
Linux seems to be 1024, but I have not seen any reason for not 
increasing this to e.g. 40.000, as currently on our system)
- Do parallel processing (will work better as each sub-process will have 
its own list of file connections).

Best wishes,
Jon


R version 2.14.0 (2011-10-31)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-5   raster_2.0-41 sp_1.0-5

loaded via a namespace (and not attached):
[1] grid_2.14.0    lattice_0.20-0




>
>>
>>
>> Thanks again Jon for sharing your findings about this.
>>
>> All the best,
>>
>> Mauricio Zambrano-Bigiarini, Ph.D
>>
>>
>>
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From Roger.Bivand at nhh.no  Wed Aug  7 11:49:20 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Aug 2013 11:49:20 +0200
Subject: [R-sig-Geo] raster/rgdal- problem: Too many open files (Linux)
In-Reply-To: <520202E0.5020203@jrc.ec.europa.eu>
References: <51FFB8A4.4030400@jrc.ec.europa.eu>
	<52012C32.8090202@jrc.ec.europa.eu>
	<alpine.LRH.2.03.1308062114020.29917@reclus.nhh.no>
	<520202E0.5020203@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.03.1308071144520.752@reclus.nhh.no>

On Wed, 7 Aug 2013, Jon Olav Skoien wrote:

>
> On 06-Aug-13 21:35, Roger Bivand wrote:
>> On Tue, 6 Aug 2013, Mauricio Zambrano-Bigiarini wrote:
>> 
>>> On 08/05/2013 04:37 PM, Jon Olav Skoien wrote:
>>>> Dear list,
>>>> 
>>>> We have a problem which appears to be a bug in either rgdal or raster,
>>>> although it could also be a bug in base R or in our understanding of how
>>>> to deal with connections.
>>>> 
>>>> We have a process which is writing a rather large (~10-20.000) number of
>>>> geoTiffs via writeRaster. However, the process has frequently stopped
>>>> with an error of the type:
>>>> Error in .local(.Object, ...) :
>>>>     TIFFOpen:/local0/skoiejo/hri/test.tif: Too many open files
>>>> The issue seems to be the creation of temp-files in the temp directory
>>>> which is given by tempdir(), not by raster:::.tmpdir(). These temp-files
>>>> seem to be created by the call
>>>>     transient <- new("GDALTransientDataset", driver=driver, rows=r at nrows,
>>>> cols=r at ncols, bands=nbands, type=dataformat, fname=filename,
>>>> options=options, handle=NULL)
>>>> from raster:::.getGDALtransient
>>>> The temp-files are deleted after writing the geoTiff, but are not
>>>> removed from the list of open files in Linux, which on our system was
>>>> limited to 1024 files (ulimit -n) per process. Below is a script which
>>>> can replicate the issue (takes a few minutes to reach 1024) and
>>>> sessionInfo().
>>>> 
>>>> Currently we are trying to solve the issue by increasing the limit of
>>>> file connections, but we would prefer a solution where the connections
>>>> are properly deleted, either before writeRaster finishes, or a command
>>>> which we can include in our script, either R-code or a call to System().
>>>> The connections are not visible via showConnections(), and
>>>> closeAllConnections() does not help.
>>>> 
>>>> Thanks,
>>>> Jon
>>> 
>>> I stumbled across the same problem (with exactly the same configuration 
>>> reported by Jon with 'sessionInfo()'), while trying to change the values 
>>> of some pixels in more than 6000 maps.
>>> 
>>> Thank  you very much Jon for the detailed report about the problem, which 
>>> helped me to find a workaround to this problem (so far, just to split the 
>>> 6000 maps in smaller groups).
>>> 
>>>> 
>>>> 
>>>> r <- raster(system.file("external/test.grd", package="raster"))
>>>> for (ifile in 1:2000) {
>>>>     writeRaster(r, "test.tif", format = "GTiff", overwrite = TRUE)
>>>>     print(ifile)
>>>> }
>>>> 
>>> 
>>> After trying the previous reproducible code, I don't understand why I got 
>>> the error when ifile=1019 and not 1024:
>>> 
>>> ....
>>> [1] 1018
>>> [1] 1019
>>> Error in .local(.Object, ...) :
>>>  TIFFOpen:/home/hzambran/test.tif: Too many open files
>>> 
>> 
>> There are other files opened by the R process that reduce the number 
>> needed. The problem is in the GDAL bindings with R, I haven't tried to see 
>> whether other applications keeping GDAL loaded face the same issues. GDAL 
>> applications typically write once and exit, so this isn't a problem there.
>> 
>> The current GDAL.close() code says unlink() to a vector of files with the 
>> same basename, but actually unlink() now appears to fail, leaving the files 
>> in place. Using file.remove() leads to the same result, and using 
>> deleteFile() provokes other problems.
>> 
>> This will probably turn out to be something trivial, but will take a great 
>> deal of time to debug, as the consequences of changing the dataset 
>> structure are possibly extensive.
>> 
>> For the time being, the work-around is the only route; if volunteers can 
>> debug this, progress may be possible, but everything else has to continue 
>> to work.
>> 
>> Roger
>
> Roger, thanks for having a look at this.
> I just checked with an older version, and it seems the problem was introduced 
> more or less at the same time as a valgrind issue was fixed in revision 456. 
> Running the example above worked with R 2.14.0 and rgdal 0.8-5 (sessionInfo 
> below), but failed when upgrading rgdal (and sp). The problem seems to be in 
> the C++ code (I already tried to revert the R code of GDAL.close to 0.8-5, 
> without any difference), which I am unfortunately not able to debug.

Thanks. The changes made then were a result of an audit for references to 
de-referenced pointers and memory leaks. I've looked to see whether it is 
possible to revert optionally to the former behaviour (admitting 
references to de-referenced pointers and memory leaks), but I can't see an 
easy resolution. So for now the workarounds you propose are those to 
follow.

Roger

>
> As there is no quick fix at the moment, I just thought it would be good to 
> summarize the possible workarounds for other people who encounter this 
> problem:
> - Split up the process in smaller problems
> - Increase the number of possible file connections (the standard on Linux 
> seems to be 1024, but I have not seen any reason for not increasing this to 
> e.g. 40.000, as currently on our system)
> - Do parallel processing (will work better as each sub-process will have its 
> own list of file connections).
>
> Best wishes,
> Jon
>
>
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-5   raster_2.0-41 sp_1.0-5
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.0    lattice_0.20-0
>
>
>
>
>> 
>>> 
>>> 
>>> Thanks again Jon for sharing your findings about this.
>>> 
>>> All the best,
>>> 
>>> Mauricio Zambrano-Bigiarini, Ph.D
>>> 
>>> 
>>> 
>> 
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jon.skoien at jrc.ec.europa.eu  Wed Aug  7 11:49:45 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Wed, 07 Aug 2013 11:49:45 +0200
Subject: [R-sig-Geo] gstat- Interpolate geostatistical data with kriging
In-Reply-To: <CAJRR3XOfd9sFRbKSsz5neJBLR_1d+nP6GXqneybPp-kKxkctHQ@mail.gmail.com>
References: <CAJRR3XOfd9sFRbKSsz5neJBLR_1d+nP6GXqneybPp-kKxkctHQ@mail.gmail.com>
Message-ID: <52021839.1090900@jrc.ec.europa.eu>

On 06-Aug-13 21:41, Moshood Agba Bakare wrote:
> Dear All,
>
> I have carried out variogram analysis on geostatistical data using gstat
> package of R. after rescaling my spatial coordinates, it ranges as follows
> easting: min=0 and max=794.256 meters
> northing: min= and max=621.8851 meters
> the maximum distance between pairs of observation is 1008.754 meters.
> I have fitted a number of variogram models such as spherical, exponential,
> Gaussian, and linear to empirical semivariogram. Besides, I have generated
> the interpolation grid for kriging. With this information, I wish to
> determine optimal grid size and interpolate with kriging. The cross
> validation will be used to compare the values.
>
> ### Create grid for the point coordinate
>
> easting.range <- as.integer(range(canmod.sp at coords[,1]))
> northing.range <- as.integer(range(canmod.sp at coords[,2]))
>
> ## now expand to a grid with 10 meter spacing:
> grd <- expand.grid(x = seq(from=easting.range[1], to = easting.range[2], by
> = 10), y = seq(from = northing.range[1], to = northing.range[2], by = 50) )
> grd.attr = data.frame(grd, yield = canmod.sp at data)
>
> ## convert to SpatialPixel class
> grd.pts <- SpatialPixels(SpatialPoints(grd))
> proj4string(grd.pts)<-CRS("+proj = utm + datum = WGS84")
>
>
> k10 <- krige(yield ~ 1, canmod.sp, newdata = grd.pts, model=sph.mod)
>
>
> I ran the last statement for kriging interpolation but take quite a long
> time with error message. This is probably due to large volume of the data
> records (12,800 observations). Could anyone guide me on what to do when
> having large data of this nature for kriging? Is there any error on the way
> I defined my grid interpolation? Do I need to split the data for kirging?
> If yes, how?

Moshood,
We have not seen the error message, but I think the size of your data is 
the cause of your problems. gstat will as default try to make a 
covariance matrix of all observations, being a 12,800 * 12,800 matrix in 
your case. This is slow and will maybe also fill up the memory on your 
computer. Instead you can do kriging in a local neighbourhood with the 
nearest n observations, n typically being a value from 10-50. Your 
kriging call would then be:

k10 <- krige(yield ~ 1, canmod.sp, newdata = grd.pts, model=sph.mod, nmax = n)

Hope this helps,
Jon

>
> Thank you.
>
> Moshood
>
>
>
>
>
>
>
>
>   where cross validation. Please guide me on how to go about this using the
> above details. Note that my observation size is 12,500 records.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From jemiller31 at gmail.com  Wed Aug  7 18:29:54 2013
From: jemiller31 at gmail.com (Joseph Miller)
Date: Wed, 7 Aug 2013 11:29:54 -0500
Subject: [R-sig-Geo] extract() error
Message-ID: <CAE+tLNC5HGEazNQxBq=X8cfVSgBwKNosPTev3xdUVF_T5Mb66A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130807/0a1c9185/attachment.pl>

From macqueen1 at llnl.gov  Wed Aug  7 21:57:29 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 7 Aug 2013 19:57:29 +0000
Subject: [R-sig-Geo] Error in plotKML
In-Reply-To: <CABkCotR+XKLcwfeAxbH88+pdszeSHN5HSEoLCh-bwzGonC=UAg@mail.gmail.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521910D3E103F@PRDEXMBX-04.the-lab.llnl.gov>

Apparently, because you don't have gnome-open installed on your system.
Why it wants gnome-open is a mystery.
But this is probably how it is trying to run GoogleEarth.
The equivalent command in OS X is simply 'open'

But, if you open a Finder window to your working directory [type
   getwd()
in your R session] and look for a file named
   eberg__CLYMHT_A__.kml
and double-click on it, it should open in GoogleEarth.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 8/2/13 4:09 PM, "Manuel Sp?nola" <mspinola10 at gmail.com> wrote:

>Dear list members,
>
>Working on X OS mountain lion and R 3.0.1
>
>I am running the example from the plotKML tutorial (
>http://gsif.isric.org/doku.php?id=wiki:tutorial_plotkml) and I get this
>error:
>
>> data(eberg)
>> coordinates(eberg) <- ~X+Y
>> proj4string(eberg) <- CRS("+init=epsg:31467")
>> eberg <- eberg[runif(nrow(eberg))<.2,]
>> bubble(eberg["CLYMHT_A"])
>> plotKML(eberg["CLYMHT_A"])
>Plotting the first variable on the list
>KML file opened for writing...
>Reprojecting to +proj=longlat +datum=WGS84 ...
>Parsing to KML...
>Closing  eberg__CLYMHT_A__.kml
>sh: gnome-open: command not found
>
>Why I get this error?
>
>Best,
>
>Manuel
>
>-- 
>*Manuel Sp?nola, Ph.D.*
>Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>Universidad Nacional
>Apartado 1350-3000
>Heredia
>COSTA RICA
>mspinola at una.ac.cr
>mspinola10 at gmail.com
>Tel?fono: (506) 2277-3598
>Fax: (506) 2237-7036
>Personal website: Lobito de r?o
><https://sites.google.com/site/lobitoderio/>
>Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>	[[alternative HTML version deleted]]
>


From bakare at ualberta.ca  Wed Aug  7 22:45:22 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 7 Aug 2013 14:45:22 -0600
Subject: [R-sig-Geo] gstat- Interpolate geostatistical data with kriging
In-Reply-To: <52021839.1090900@jrc.ec.europa.eu>
References: <CAJRR3XOfd9sFRbKSsz5neJBLR_1d+nP6GXqneybPp-kKxkctHQ@mail.gmail.com>
	<52021839.1090900@jrc.ec.europa.eu>
Message-ID: <CAJRR3XOYzGAmOcSkLc6adtsLPbnksNUt3WF_YV9vTvq726kNPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130807/fd3d7125/attachment.pl>

From mspinola10 at gmail.com  Wed Aug  7 23:48:21 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Wed, 7 Aug 2013 15:48:21 -0600
Subject: [R-sig-Geo] Error in plotKML
In-Reply-To: <5E1B812FAC2C4A49B3D99593B5A521910D3E103F@PRDEXMBX-04.the-lab.llnl.gov>
References: <CABkCotR+XKLcwfeAxbH88+pdszeSHN5HSEoLCh-bwzGonC=UAg@mail.gmail.com>
	<5E1B812FAC2C4A49B3D99593B5A521910D3E103F@PRDEXMBX-04.the-lab.llnl.gov>
Message-ID: <CABkCotS0aEwmqg0kMWYsv3+WQnt_AT1dZzNCfkcXen87FtZ1+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130807/c1b9376e/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Thu Aug  8 10:01:25 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Thu, 08 Aug 2013 10:01:25 +0200
Subject: [R-sig-Geo] gstat- Interpolate geostatistical data with kriging
In-Reply-To: <CAJRR3XOYzGAmOcSkLc6adtsLPbnksNUt3WF_YV9vTvq726kNPA@mail.gmail.com>
References: <CAJRR3XOfd9sFRbKSsz5neJBLR_1d+nP6GXqneybPp-kKxkctHQ@mail.gmail.com>
	<52021839.1090900@jrc.ec.europa.eu>
	<CAJRR3XOYzGAmOcSkLc6adtsLPbnksNUt3WF_YV9vTvq726kNPA@mail.gmail.com>
Message-ID: <52035055.10100@jrc.ec.europa.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130808/84efdef2/attachment.pl>

From gerardommc at gmail.com  Thu Aug  8 12:11:22 2013
From: gerardommc at gmail.com (Gerardo Martin)
Date: Thu, 08 Aug 2013 20:11:22 +1000
Subject: [R-sig-Geo] data.frame methods for maxlike and maxent
Message-ID: <52036ECA.6010200@gmail.com>

Hi all. I'm trying to implement some species distribution models with my 
data sets. Because of the nature of the organisms i'm working with I 
need specifically to fit models with data contained in a data.frame 
instead of providing the x,y locations to be sampled from a rasterStack.
Firstly i've found one way of doing it with dismo's maxent 
implementation, by providing a vector with 1's ans 0's, 0 values 
correspond to values extracted with randomPonints. However, I haven't 
found a way of providing the data.fame as background data, instead of 
pseudoabsences as described.
Secondly, I also want to fit a maxlike model, but haven't found if 
there's a data.frame method. Like I said, I can't do it with the 
traditional rasterStack method, because the information to fit the model 
is seasonal.

Any help is really appreciated.

Regards

Gerardo


From thi_veloso at yahoo.com.br  Thu Aug  8 20:41:49 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Thu, 8 Aug 2013 11:41:49 -0700 (PDT)
Subject: [R-sig-Geo] Plot area avarage across time for several variables
Message-ID: <1375987309.72251.YahooMailNeo@web121901.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130808/c4f91ca1/attachment.pl>

From peter at thoughtspot.net  Fri Aug  9 04:08:52 2013
From: peter at thoughtspot.net (Peter Schmiedeskamp)
Date: Thu, 8 Aug 2013 19:08:52 -0700
Subject: [R-sig-Geo] Load spatialite extension in RSQLite crashes R (OS X
	10.8)
Message-ID: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>

I am running some queries against a spatialite database, and would
like to get the data directly into R.This thread
(http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html)
suggests I can do something like this:

library(RSQLite)
sqldrv <- dbDriver("SQLite")
con <- dbConnect(sqldrv, dbname =
"/path/to/db.sqlite",loadable.extensions = TRUE)
spatialitestatus <- dbGetQuery(con, "SELECT
load_extension('libspatialite.dylib')")

But when I do, R segfaults with the following:

 *** caught segfault ***
address 0x0, cause 'memory not mapped'

Traceback:
 1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = .SQLitePkgName)
 2: sqliteFetch(rs, n = -1, ...)
 3: sqliteQuickSQL(conn, statement, ...)
 4: dbGetQuery(con, "SELECT
load_extension('/usr/local/lib/libspatialite.dylib')")
 5: dbGetQuery(con, "SELECT
load_extension('/usr/local/lib/libspatialite.dylib')")

In my case, spatialite was built from source using Homebrew, as is the
version of sqlite that I would normally use. In the libspatialite
homebrew definition, it says it depends on sqlite > 3.7.3. My
homebrewed version of sqlite is 3.7.17. My libspatialite is
libspatialite-4.1.1.

I don't know for certain what version of sqlite RSQLite pulls in by
default, but I assume it's the version 3.7.17 version included in the
RSQLite source package. I tried building RSQLite from source
usinginstall.packages(c("RSQLite"), type="source") in hopes that it
would simply use my version of sqlite, but it doesn't look like it
did. Or if it did, it's still crashing.

Finally, I should mention that I tried this under two versions of R
with same results:

R 3.0.0 downloaded in binary form from CRAN
R 3.0.1 downloaded in source form and installed via homebrew

Cheers,
Peter

P.S. I also posted this to stackoverflow a couple days ago, if anyone
is hankering for some karma:
http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x


From tghoward at gw.dec.state.ny.us  Fri Aug  9 13:42:39 2013
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Fri, 09 Aug 2013 07:42:39 -0400
Subject: [R-sig-Geo]  data.frame methods for maxlike and maxent
In-Reply-To: <mailman.13.1376042404.17760.r-sig-geo@r-project.org>
References: <mailman.13.1376042404.17760.r-sig-geo@r-project.org>
Message-ID: <52049D6F020000D500B7DE99@gwsmtp.dec.state.ny.us>

You can create the model using data contained in a data.frame but then -- because you are creating a species distribution model - you still need the raster stack to actually run the prediction and make the map representing the model. And your raster stack still needs to have those environmental variables, even if you are dealing with seasonal data and time is another factor. Perhaps I'm not understanding your scenario. 

At any rate, the SDM vignette that comes with dismo shows you how to use randomPoints to extract the values from a raster stack to a data.frame, which you then can use to create your model. (page 26 in here: http://cran.r-project.org/web/packages/dismo/vignettes/sdm.pdf ).  Is that what you are asking?

Tim
 
----------
Date: Thu, 08 Aug 2013 20:11:22 +1000
From: Gerardo Martin <gerardommc at gmail.com>
To: r-sig-geo at r-project.org 
Subject: [R-sig-Geo] data.frame methods for maxlike and maxent
Message-ID: <52036ECA.6010200 at gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi all. I'm trying to implement some species distribution models with my 
data sets. Because of the nature of the organisms i'm working with I 
need specifically to fit models with data contained in a data.frame 
instead of providing the x,y locations to be sampled from a rasterStack.
Firstly i've found one way of doing it with dismo's maxent 
implementation, by providing a vector with 1's ans 0's, 0 values 
correspond to values extracted with randomPonints. However, I haven't 
found a way of providing the data.fame as background data, instead of 
pseudoabsences as described.
Secondly, I also want to fit a maxlike model, but haven't found if 
there's a data.frame method. Like I said, I can't do it with the 
traditional rasterStack method, because the information to fit the model 
is seasonal.

Any help is really appreciated.

Regards

Gerardo



_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org 
https://stat.ethz.ch/mailman/listinfo/r-sig-geo 


End of R-sig-Geo Digest, Vol 120, Issue 8


From ruben.vandekerchove at gmail.com  Fri Aug  9 15:29:45 2013
From: ruben.vandekerchove at gmail.com (Ruben Van De Kerchove)
Date: Fri, 9 Aug 2013 15:29:45 +0200
Subject: [R-sig-Geo] Calculate (global/local) Moran I for a segmented
	satellite image
Message-ID: <CAO6WGrVCrsudko958h0-kBmYXazKDeAA_Yw=6QaSn+wZamhP4w@mail.gmail.com>

Dear,

I am trying to calculate global Moran I and local Moran I for a
segmented satellite image.  This is what I would like to obtain.

- Segment a high resolution satellite in GRASS using i.segment.
- Calculate mean band values for each created object
- Calculate local (for each zone) and global Moran I for these mean
object values taking into account only the neighboring objects

Step 1 works fine, but I have some issues with steps 2 and 3.
Therefore, below you find an example I created for these steps.

Although the code seems to work on this example, it isn?t optimized in
terms of speed (and memory?) for very large raster sets. Especially
rasterToPolygons() is extremely slow. I think that it should be better
to calculate neighbors immediately on the ?raster regions?, but is
this possible? I checked cell2nb() but this seems not to work for
regions/objects. Furthermore it seems that when I convert large
rasters (100 000 000) cells into polygons the number of created
polygons might slightly differ from the number of unique regions in
the raster (tested with gdal_polygonize and r.to.vect; not yet with
rasterToPolygons due to the time it takes). Any idea why this happens?

Would it be possible to use Moran and MoranLocal from the raster
package in this case (maybe in combination with the zonal function? I
guess that this would also speed up things.

Thanks and regards,

Ruben

----------------------------------------------
library(spgrass6)
library(raster)
library(spdep)

###LOAD DATA

#Satellite image
r <- c(55, 56, 54, 58, 65, 75, 82, 77, 74, 74, 69, 61, 62, 71, 73,
         63, 62, 63, 64, 59, 85, 88, 95, 106, 110, 99, 89, 82, 79, 84, 97, 79,
         55, 55, 56, 60, 91, 95, 86, 98, 115, 105, 110, 107, 101, 89, 85, 68,
         55, 54, 53, 61, 82, 102, 88, 93, 96, 94, 110, 114, 109, 103, 92, 68,
         59, 58, 60, 64, 88, 99, 82, 81, 71, 80, 89, 89, 89, 102, 104, 75, 63,
         57, 58, 58, 77, 92, 82, 71, 59, 90, 105, 92, 79, 98, 110, 83, 62, 55,
         56, 56, 80, 90, 99, 88, 64, 91, 112, 94, 76, 91, 100, 85, 62, 59, 55,
         61, 99, 97, 93, 80, 65, 87, 107, 80, 59, 60, 67, 66, 65, 62, 68, 72,
         102, 94, 90, 83, 74, 81, 96, 69, 52, 50, 51, 54, 62, 62, 86, 85, 55,
         59, 64, 72, 75, 70, 70, 62, 66, 61, 55, 57, 52, 59, 61, 56, 41, 40,
         43, 44, 46, 48, 50, 52, 68, 69, 60, 61, 42, 43, 44, 43, 42, 41, 42,
         44, 43, 43, 44, 47, 58, 59, 55, 61, 44, 41, 39, 42, 44, 43, 42, 42,
         42, 43, 43, 49, 56, 53, 53, 61, 43, 42, 40, 42, 42, 42, 41, 42, 42,
         43, 42, 53, 66, 61, 51, 62, 40, 42, 41, 40, 43, 49, 46, 42, 42, 43,
         43, 49, 59, 62, 53, 62, 40, 41, 42, 43, 49, 54, 47, 44, 42, 44, 43,
         46, 52, 56, 56, 61)
r <- matrix(r, ncol=16, nrow=16, byrow=T)
r<- raster(r)
plot(r)

#Segments
seg <- r
k=0
for (i in 1:4){
  for (j in 1:4){
    k=k+1
  seg[(4*i-3):(4*i),(4*j-3):(4*j)]=matrix(rep(k,16),4,4)
}
}
plot(seg)

####ZONAL STAT
#Create raster of mean for each segment
r.mean=zonal(r,seg, fun="mean")
r.mean=as.data.frame(r.mean)
r.mean.im=subs(seg,r.mean,by="zone",which="mean")
plot(r.mean.im)

#Create polygons of mean for each segment
r.mean.pl=rasterToPolygons(seg,dissolve=T)
r.mean.pl=spCbind(r.mean.pl,r.mean[,2])
names(r.mean.pl)[2]="mean"

#####MI
#Calculate neighbours and weights
nb=poly2nb(r.mean.pl)
plot(r.mean.pl, border="grey")
plot(nb, coordinates(r.mean.pl), add=TRUE)
nb.weight=nb2listw(nb,style="B")

values=as.data.frame(r.mean.pl)[,2]
MI.global=moran(values,nb.weight,length(nb),Szero(nb.weight))
MI.local=localmoran(values,nb.weight)

r.mean.pl=spCbind(r.mean.pl,as.data.frame(MI.local)[[1]])
names(r.mean.pl)[3]="MI.local"

spplot(r.mean.pl, zcol="MI.local", col=NA)


From amommendes at hotmail.com  Fri Aug  9 18:02:42 2013
From: amommendes at hotmail.com (amluiz)
Date: Fri, 9 Aug 2013 09:02:42 -0700 (PDT)
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
References: <1375821715547-7584356.post@n2.nabble.com>
	<CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
Message-ID: <BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>



Thanks Etienne
I was trying to plot three PCA axes (each one representing R, G and B color bands) in the map, but without success in R. I only can do this in GIS software...
Any suggestion? 

Date: Tue, 6 Aug 2013 13:51:55 -0700
From: ml-node+s2731867n7584357h83 at n2.nabble.com
To: amommendes at hotmail.com
Subject: Re: plotRGB - negative values



	Amom, you could probably offset your values and make sure you set scale to

the right value. If your lowest value is 1 and the highest value then

becomes 2, then something like

plotRGB(all.pca + 1, scale = 2)


I don't think you can use negative values in plotRGB.


Etienne



2013/8/6 amluiz <[hidden email]>


> Hello,

>

> I'm trying to use plotRGB. But I've negative values in my rasters cells and

> I get the following error:

>

> plotRGB(all.pca)

> Error in rgb(RGB[, 1], RGB[, 2], RGB[, 3], alpha = alpha, max = scale) :

>   color intensity -1, not in 0:255

>

> Is there some way to solve this?

>

> Thanks in advance,

>

> Amom

>

>

>

>

>

> --

> View this message in context:

> http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.

>

> _______________________________________________

> R-sig-Geo mailing list

> [hidden email]

> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]


_______________________________________________

R-sig-Geo mailing list

[hidden email]

https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	
	
	
	

	

	
	
		If you reply to this email, your message will be added to the discussion below:
		http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584357.html
	
	
		
		To unsubscribe from plotRGB - negative values, click here.

		NAML
	 		 	   		  



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584378.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vitale232 at gmail.com  Fri Aug  9 18:19:43 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 9 Aug 2013 09:19:43 -0700
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
References: <1375821715547-7584356.post@n2.nabble.com>
	<CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
	<BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
Message-ID: <CAFTcopdgpvKk9cW4JuZDO81pZGg141B6wj+kCk1LhLEGrOzOUA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130809/64e84aa4/attachment.pl>

From tephilippi at gmail.com  Fri Aug  9 19:02:34 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 9 Aug 2013 10:02:34 -0700
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
References: <1375821715547-7584356.post@n2.nabble.com>
	<CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
	<BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
Message-ID: <CALyPt8xUpEB4YQ+wC7MsyJfTGbnWWpxWMb_taV4r+E=+C7ysyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130809/30d3c92e/attachment.pl>

From tephilippi at gmail.com  Fri Aug  9 19:06:49 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 9 Aug 2013 10:06:49 -0700
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <CALyPt8xUpEB4YQ+wC7MsyJfTGbnWWpxWMb_taV4r+E=+C7ysyw@mail.gmail.com>
References: <1375821715547-7584356.post@n2.nabble.com>
	<CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
	<BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
	<CALyPt8xUpEB4YQ+wC7MsyJfTGbnWWpxWMb_taV4r+E=+C7ysyw@mail.gmail.com>
Message-ID: <CALyPt8xL2jODrFxFPEuaJaQp3vSvpi+oxTwk87bfMQdTJgdYDw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130809/6b328073/attachment.pl>

From amommendes at hotmail.com  Fri Aug  9 21:48:07 2013
From: amommendes at hotmail.com (amluiz)
Date: Fri, 9 Aug 2013 12:48:07 -0700 (PDT)
Subject: [R-sig-Geo] plotRGB - negative values
In-Reply-To: <CALyPt8xL2jODrFxFPEuaJaQp3vSvpi+oxTwk87bfMQdTJgdYDw@mail.gmail.com>
References: <1375821715547-7584356.post@n2.nabble.com>
	<CALjAYt7Xui2c6cgEd-Bex6_U332yPDNED7p02pNohH+Pk3Mx8Q@mail.gmail.com>
	<BLU176-W52057A47BF4B15CA13914BD5580@phx.gbl>
	<CALyPt8xUpEB4YQ+wC7MsyJfTGbnWWpxWMb_taV4r+E=+C7ysyw@mail.gmail.com>
	<CALyPt8xL2jODrFxFPEuaJaQp3vSvpi+oxTwk87bfMQdTJgdYDw@mail.gmail.com>
Message-ID: <BLU176-W335C33F021D1EDB4AC7B34D5580@phx.gbl>

Thanks Philippi, it worked well...
Best,
Amom

Date: Fri, 9 Aug 2013 10:07:28 -0700
From: ml-node+s2731867n7584381h27 at n2.nabble.com
To: amommendes at hotmail.com
Subject: Re: plotRGB - negative values



	Oops, one slight mistake: range() returns a vector of min,max values, so

you need to subtract them:

Ranges <- Ranges[,2] - Ranges[,1]




On Fri, Aug 9, 2013 at 10:02 AM, Tom Philippi <[hidden email]> wrote:


> Amom--

> If your PCA axis scores are centered (mean=0) as is customary, simply

> standardize each one to range -0.5:0.5 or -128:127 (with floor to convert

> to integers), and then add 0.5 or 128 to center at 0.5 or 127.

> Assuming that you're trying to false-color plot the first 3 PCA axes, the

> decision you need to make is whether you want to standardize each axis

> independently, so that each ranges from 0:255, or whether you want to

> standardize the axis with the greatest range to 0:255, then use that

> scaling on the other 2 axes to reflect their reduced variation.  Either way

> is 'correct', they emphasize different variation in your data.

>

> Depending on the format of your PCA data, you may need to *apply the range

> function.  If PCA is an X by 3 matrix with PCA axes as columns, something

> like:

> Ranges <- apply(PCA,FUN=range,MARGIN=2)

> scaledPCA <- scale(PCA,center=rep(-.5,3),scale=Ranges)

> should work.

> If you want all axes scaled by the longest axis, then something like:

> maxRange <- max(apply(PCA,FUN=range,MARGIN=2))

> scaledPCA <- scale(PCA,center=rep(-0.5,3),scale=rep(maxRange,3))

> might work.  [Note that you could modify this if you needed to scale by

> eigenvalues.]

>

> If your PCA values are already in a RasterStackBrick object named

> PCAbrick, scale has a method for Raster* objects, but you need to use

> cellStats rather than apply and range:

> Ranges <- cellStats(PCAbrick,stat='range')

> scaledPCAbrick <- scale(PCAbrick,center=c(-0.5,3),scale=Ranges)

> [If your raster is "very large", you might have to call cellStats

> separately for max and min instead of once for range: see ?cellStats.]

>

> I hope that this is sufficient guidance, and that you can fix any errors

> in my untested code.

>

> Tom

>

>

>

>

> On Fri, Aug 9, 2013 at 9:02 AM, amluiz <[hidden email]> wrote:

>

>>

>>

>> Thanks Etienne

>> I was trying to plot three PCA axes (each one representing R, G and B

>> color bands) in the map, but without success in R. I only can do this in

>> GIS software...

>> Any suggestion?

>>

>> Date: Tue, 6 Aug 2013 13:51:55 -0700

>> From: [hidden email]

>> To: [hidden email]

>> Subject: Re: plotRGB - negative values

>>

>>

>>

>>         Amom, you could probably offset your values and make sure you set

>> scale to

>>

>> the right value. If your lowest value is 1 and the highest value then

>>

>> becomes 2, then something like

>>

>> plotRGB(all.pca + 1, scale = 2)

>>

>>

>> I don't think you can use negative values in plotRGB.

>>

>>

>> Etienne

>>

>>

>>

>> 2013/8/6 amluiz <[hidden email]>

>>

>>

>> > Hello,

>>

>> >

>>

>> > I'm trying to use plotRGB. But I've negative values in my rasters cells

>> and

>>

>> > I get the following error:

>>

>> >

>>

>> > plotRGB(all.pca)

>>

>> > Error in rgb(RGB[, 1], RGB[, 2], RGB[, 3], alpha = alpha, max = scale) :

>>

>> >   color intensity -1, not in 0:255

>>

>> >

>>

>> > Is there some way to solve this?

>>

>> >

>>

>> > Thanks in advance,

>>

>> >

>>

>> > Amom

>>

>> >

>>

>> >

>>

>> >

>>

>> >

>>

>> >

>>

>> > --

>>

>> > View this message in context:

>>

>> >

>> http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356.html
>> > Sent from the R-sig-geo mailing list archive at Nabble.com.

>>

>> >

>>

>> > _______________________________________________

>>

>> > R-sig-Geo mailing list

>>

>> > [hidden email]

>>

>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >

>>

>>         [[alternative HTML version deleted]]

>>

>>

>> _______________________________________________

>>

>> R-sig-Geo mailing list

>>

>> [hidden email]

>>

>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

>>

>>

>>

>>

>>

>>

>>

>>

>>

>>

>>                 If you reply to this email, your message will be added to

>> the discussion below:

>>

>> http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584357.html
>>

>>

>>

>>                 To unsubscribe from plotRGB - negative values, click here.

>>

>>                 NAML

>>

>>

>>

>>

>> --

>> View this message in context:

>> http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584378.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.

>>

>> _______________________________________________

>> R-sig-Geo mailing list

>> [hidden email]

>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

>

>

        [[alternative HTML version deleted]]


_______________________________________________

R-sig-Geo mailing list

[hidden email]

https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	
	
	
	

	

	
	
		If you reply to this email, your message will be added to the discussion below:
		http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584381.html
	
	
		
		To unsubscribe from plotRGB - negative values, click here.

		NAML
	 		 	   		  



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plotRGB-negative-values-tp7584356p7584382.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From peter at thoughtspot.net  Fri Aug  9 22:57:49 2013
From: peter at thoughtspot.net (Peter Schmiedeskamp)
Date: Fri, 9 Aug 2013 13:57:49 -0700
Subject: [R-sig-Geo] Load spatialite extension in RSQLite crashes R (OS
	X 10.8)
In-Reply-To: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
Message-ID: <CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>

I fired up an Ubuntu VM and found that loading the spatialite
extension also seems to crash there. My test Ubuntu setup is v13.04
(x86_64). I installed libspatialite5 from the Ubuntu FOSS GIS
packages: (http://hub.qgis.org/projects/quantum-gis/wiki/Download#262-With-updated-dependencies).
R was installed from the CRAN Ubuntu package site.

I am starting to wonder if this isn't an incompatibility between
RSQLite and the latest versions of libspatialite. If anyone has any
experience using the new libspatialite with RSQLite, I'd love to hear
how you got it working.

Cheers,
Peter

On Thu, Aug 8, 2013 at 7:08 PM, Peter Schmiedeskamp
<peter at thoughtspot.net> wrote:
> I am running some queries against a spatialite database, and would
> like to get the data directly into R.This thread
> (http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html)
> suggests I can do something like this:
>
> library(RSQLite)
> sqldrv <- dbDriver("SQLite")
> con <- dbConnect(sqldrv, dbname =
> "/path/to/db.sqlite",loadable.extensions = TRUE)
> spatialitestatus <- dbGetQuery(con, "SELECT
> load_extension('libspatialite.dylib')")
>
> But when I do, R segfaults with the following:
>
>  *** caught segfault ***
> address 0x0, cause 'memory not mapped'
>
> Traceback:
>  1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = .SQLitePkgName)
>  2: sqliteFetch(rs, n = -1, ...)
>  3: sqliteQuickSQL(conn, statement, ...)
>  4: dbGetQuery(con, "SELECT
> load_extension('/usr/local/lib/libspatialite.dylib')")
>  5: dbGetQuery(con, "SELECT
> load_extension('/usr/local/lib/libspatialite.dylib')")
>
> In my case, spatialite was built from source using Homebrew, as is the
> version of sqlite that I would normally use. In the libspatialite
> homebrew definition, it says it depends on sqlite > 3.7.3. My
> homebrewed version of sqlite is 3.7.17. My libspatialite is
> libspatialite-4.1.1.
>
> I don't know for certain what version of sqlite RSQLite pulls in by
> default, but I assume it's the version 3.7.17 version included in the
> RSQLite source package. I tried building RSQLite from source
> usinginstall.packages(c("RSQLite"), type="source") in hopes that it
> would simply use my version of sqlite, but it doesn't look like it
> did. Or if it did, it's still crashing.
>
> Finally, I should mention that I tried this under two versions of R
> with same results:
>
> R 3.0.0 downloaded in binary form from CRAN
> R 3.0.1 downloaded in source form and installed via homebrew
>
> Cheers,
> Peter
>
> P.S. I also posted this to stackoverflow a couple days ago, if anyone
> is hankering for some karma:
> http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x


From bellard.celine at gmail.com  Sat Aug 10 16:34:48 2013
From: bellard.celine at gmail.com (=?ISO-8859-1?Q?C=E9line_Bellard?=)
Date: Sat, 10 Aug 2013 16:34:48 +0200
Subject: [R-sig-Geo] raster contour lines
Message-ID: <52064F88.60606@gmail.com>

Hi members,

I would like to superpose a raster stack and some contour lines (several 
pannels).
It is possible with rasterVis :
levelplot()+contourplot()

But I would like to do it with plot (much faster) :
plot()
and something like contour(<>, add=T)

Any idea ? Thank !

C?line

-- 
C?line Bellard, PhD student
  
Lab ESE, UMR CNRS 8079

Univ Paris-Sud Tel  (0033/0) 1 69 15 56 85

Bat 362

F-91405  Orsay Cedex FRANCE


From tech_dev at wildintellect.com  Sat Aug 10 20:57:31 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Sat, 10 Aug 2013 11:57:31 -0700
Subject: [R-sig-Geo] Load spatialite extension in RSQLite crashes R (OS
 X 10.8)
In-Reply-To: <CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
	<CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
Message-ID: <52068D1B.80700@wildintellect.com>

That's entirely possible Spatialite 4 had some changes to the db
structure when compared to Spatialite 3. I don't think RSQLite or
Pyspatialite have caught up yet, and SQLiteMap (R package) appears
orphaned. So I would try to roll back to spatialite 3 and see if you can
get that working with SQLiteMap. That also appears to mean R below
version 3.

So in Raring (13.04) that means use it from the main ubuntu repos.
On Mac http://www.kyngchaos.com/software:frameworks  Spatialite Tools v3.0

Possible workaround, create a view and then use rgdal (with gdal 1.10)
to import that view.

I tested on ubuntu 12.04 and those instructions (which I wrote) don't
appear to work anymore, at least not with R 3.0+spatialite3. I
originally figured that out back in 2008-2009 though so a lot has
changed since then. I'm going to go back to OSGeoLive 6.5 and see if
they work (that should have R 2.15 with spatialite3)

Thanks,
Alex

On 08/09/2013 01:57 PM, Peter Schmiedeskamp wrote:
> I fired up an Ubuntu VM and found that loading the spatialite
> extension also seems to crash there. My test Ubuntu setup is v13.04
> (x86_64). I installed libspatialite5 from the Ubuntu FOSS GIS
> packages: (http://hub.qgis.org/projects/quantum-gis/wiki/Download#262-With-updated-dependencies).
> R was installed from the CRAN Ubuntu package site.
> 
> I am starting to wonder if this isn't an incompatibility between
> RSQLite and the latest versions of libspatialite. If anyone has any
> experience using the new libspatialite with RSQLite, I'd love to hear
> how you got it working.
> 
> Cheers,
> Peter
> 
> On Thu, Aug 8, 2013 at 7:08 PM, Peter Schmiedeskamp
> <peter at thoughtspot.net> wrote:
>> I am running some queries against a spatialite database, and would
>> like to get the data directly into R.This thread
>> (http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html)
>> suggests I can do something like this:
>>
>> library(RSQLite)
>> sqldrv <- dbDriver("SQLite")
>> con <- dbConnect(sqldrv, dbname =
>> "/path/to/db.sqlite",loadable.extensions = TRUE)
>> spatialitestatus <- dbGetQuery(con, "SELECT
>> load_extension('libspatialite.dylib')")
>>
>> But when I do, R segfaults with the following:
>>
>>  *** caught segfault ***
>> address 0x0, cause 'memory not mapped'
>>
>> Traceback:
>>  1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = .SQLitePkgName)
>>  2: sqliteFetch(rs, n = -1, ...)
>>  3: sqliteQuickSQL(conn, statement, ...)
>>  4: dbGetQuery(con, "SELECT
>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>  5: dbGetQuery(con, "SELECT
>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>
>> In my case, spatialite was built from source using Homebrew, as is the
>> version of sqlite that I would normally use. In the libspatialite
>> homebrew definition, it says it depends on sqlite > 3.7.3. My
>> homebrewed version of sqlite is 3.7.17. My libspatialite is
>> libspatialite-4.1.1.
>>
>> I don't know for certain what version of sqlite RSQLite pulls in by
>> default, but I assume it's the version 3.7.17 version included in the
>> RSQLite source package. I tried building RSQLite from source
>> usinginstall.packages(c("RSQLite"), type="source") in hopes that it
>> would simply use my version of sqlite, but it doesn't look like it
>> did. Or if it did, it's still crashing.
>>
>> Finally, I should mention that I tried this under two versions of R
>> with same results:
>>
>> R 3.0.0 downloaded in binary form from CRAN
>> R 3.0.1 downloaded in source form and installed via homebrew
>>
>> Cheers,
>> Peter
>>
>> P.S. I also posted this to stackoverflow a couple days ago, if anyone
>> is hankering for some karma:
>> http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From peter at thoughtspot.net  Sat Aug 10 21:02:57 2013
From: peter at thoughtspot.net (Peter Schmiedeskamp)
Date: Sat, 10 Aug 2013 12:02:57 -0700
Subject: [R-sig-Geo] Load spatialite extension in RSQLite crashes R (OS
	X 10.8)
In-Reply-To: <52068D1B.80700@wildintellect.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
	<CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
	<52068D1B.80700@wildintellect.com>
Message-ID: <CAOhL9ALfCDiT-mgT5gC0_EPyMC-w8rs7v94-7SJx_S6jq7yfbA@mail.gmail.com>

Thanks Alex,

I'm in the thick of working with this now, and literally just
discovered that libspatialite.so.3 loads in Ubuntu and OS X (however,
queries exercising spatial functions still cause R to segfault on OS
X, but I'll take this as forward progress).

If you don't mind, I'll forward this thread on to the spatialite users
group. I've seen a few postings focussed on other languages that talk
about extension loading problems with the new libspatialite.

Cheers,
Peter


On Sat, Aug 10, 2013 at 11:57 AM, Alex Mandel
<tech_dev at wildintellect.com> wrote:
> That's entirely possible Spatialite 4 had some changes to the db
> structure when compared to Spatialite 3. I don't think RSQLite or
> Pyspatialite have caught up yet, and SQLiteMap (R package) appears
> orphaned. So I would try to roll back to spatialite 3 and see if you can
> get that working with SQLiteMap. That also appears to mean R below
> version 3.
>
> So in Raring (13.04) that means use it from the main ubuntu repos.
> On Mac http://www.kyngchaos.com/software:frameworks  Spatialite Tools v3.0
>
> Possible workaround, create a view and then use rgdal (with gdal 1.10)
> to import that view.
>
> I tested on ubuntu 12.04 and those instructions (which I wrote) don't
> appear to work anymore, at least not with R 3.0+spatialite3. I
> originally figured that out back in 2008-2009 though so a lot has
> changed since then. I'm going to go back to OSGeoLive 6.5 and see if
> they work (that should have R 2.15 with spatialite3)
>
> Thanks,
> Alex
>
> On 08/09/2013 01:57 PM, Peter Schmiedeskamp wrote:
>> I fired up an Ubuntu VM and found that loading the spatialite
>> extension also seems to crash there. My test Ubuntu setup is v13.04
>> (x86_64). I installed libspatialite5 from the Ubuntu FOSS GIS
>> packages: (http://hub.qgis.org/projects/quantum-gis/wiki/Download#262-With-updated-dependencies).
>> R was installed from the CRAN Ubuntu package site.
>>
>> I am starting to wonder if this isn't an incompatibility between
>> RSQLite and the latest versions of libspatialite. If anyone has any
>> experience using the new libspatialite with RSQLite, I'd love to hear
>> how you got it working.
>>
>> Cheers,
>> Peter
>>
>> On Thu, Aug 8, 2013 at 7:08 PM, Peter Schmiedeskamp
>> <peter at thoughtspot.net> wrote:
>>> I am running some queries against a spatialite database, and would
>>> like to get the data directly into R.This thread
>>> (http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html)
>>> suggests I can do something like this:
>>>
>>> library(RSQLite)
>>> sqldrv <- dbDriver("SQLite")
>>> con <- dbConnect(sqldrv, dbname =
>>> "/path/to/db.sqlite",loadable.extensions = TRUE)
>>> spatialitestatus <- dbGetQuery(con, "SELECT
>>> load_extension('libspatialite.dylib')")
>>>
>>> But when I do, R segfaults with the following:
>>>
>>>  *** caught segfault ***
>>> address 0x0, cause 'memory not mapped'
>>>
>>> Traceback:
>>>  1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = .SQLitePkgName)
>>>  2: sqliteFetch(rs, n = -1, ...)
>>>  3: sqliteQuickSQL(conn, statement, ...)
>>>  4: dbGetQuery(con, "SELECT
>>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>>  5: dbGetQuery(con, "SELECT
>>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>>
>>> In my case, spatialite was built from source using Homebrew, as is the
>>> version of sqlite that I would normally use. In the libspatialite
>>> homebrew definition, it says it depends on sqlite > 3.7.3. My
>>> homebrewed version of sqlite is 3.7.17. My libspatialite is
>>> libspatialite-4.1.1.
>>>
>>> I don't know for certain what version of sqlite RSQLite pulls in by
>>> default, but I assume it's the version 3.7.17 version included in the
>>> RSQLite source package. I tried building RSQLite from source
>>> usinginstall.packages(c("RSQLite"), type="source") in hopes that it
>>> would simply use my version of sqlite, but it doesn't look like it
>>> did. Or if it did, it's still crashing.
>>>
>>> Finally, I should mention that I tried this under two versions of R
>>> with same results:
>>>
>>> R 3.0.0 downloaded in binary form from CRAN
>>> R 3.0.1 downloaded in source form and installed via homebrew
>>>
>>> Cheers,
>>> Peter
>>>
>>> P.S. I also posted this to stackoverflow a couple days ago, if anyone
>>> is hankering for some karma:
>>> http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From tech_dev at wildintellect.com  Sat Aug 10 21:06:43 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Sat, 10 Aug 2013 12:06:43 -0700
Subject: [R-sig-Geo] Load spatialite extension in RSQLite crashes R (OS
 X 10.8)
In-Reply-To: <CAOhL9ALfCDiT-mgT5gC0_EPyMC-w8rs7v94-7SJx_S6jq7yfbA@mail.gmail.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
	<CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
	<52068D1B.80700@wildintellect.com>
	<CAOhL9ALfCDiT-mgT5gC0_EPyMC-w8rs7v94-7SJx_S6jq7yfbA@mail.gmail.com>
Message-ID: <52068F43.9050208@wildintellect.com>

Yes, thats a good place to ask, though you may once again be talking to
me. I did find this old thread I had forgot about, which has some more
ideas.
https://stat.ethz.ch/pipermail/r-sig-db/2010q1/000784.html

Thanks,
Alex

On 08/10/2013 12:02 PM, Peter Schmiedeskamp wrote:
> Thanks Alex,
> 
> I'm in the thick of working with this now, and literally just
> discovered that libspatialite.so.3 loads in Ubuntu and OS X (however,
> queries exercising spatial functions still cause R to segfault on OS
> X, but I'll take this as forward progress).
> 
> If you don't mind, I'll forward this thread on to the spatialite users
> group. I've seen a few postings focussed on other languages that talk
> about extension loading problems with the new libspatialite.
> 
> Cheers,
> Peter
> 
> 
> On Sat, Aug 10, 2013 at 11:57 AM, Alex Mandel
> <tech_dev at wildintellect.com> wrote:
>> That's entirely possible Spatialite 4 had some changes to the db
>> structure when compared to Spatialite 3. I don't think RSQLite or
>> Pyspatialite have caught up yet, and SQLiteMap (R package) appears
>> orphaned. So I would try to roll back to spatialite 3 and see if you can
>> get that working with SQLiteMap. That also appears to mean R below
>> version 3.
>>
>> So in Raring (13.04) that means use it from the main ubuntu repos.
>> On Mac http://www.kyngchaos.com/software:frameworks  Spatialite Tools v3.0
>>
>> Possible workaround, create a view and then use rgdal (with gdal 1.10)
>> to import that view.
>>
>> I tested on ubuntu 12.04 and those instructions (which I wrote) don't
>> appear to work anymore, at least not with R 3.0+spatialite3. I
>> originally figured that out back in 2008-2009 though so a lot has
>> changed since then. I'm going to go back to OSGeoLive 6.5 and see if
>> they work (that should have R 2.15 with spatialite3)
>>
>> Thanks,
>> Alex
>>
>> On 08/09/2013 01:57 PM, Peter Schmiedeskamp wrote:
>>> I fired up an Ubuntu VM and found that loading the spatialite
>>> extension also seems to crash there. My test Ubuntu setup is v13.04
>>> (x86_64). I installed libspatialite5 from the Ubuntu FOSS GIS
>>> packages: (http://hub.qgis.org/projects/quantum-gis/wiki/Download#262-With-updated-dependencies).
>>> R was installed from the CRAN Ubuntu package site.
>>>
>>> I am starting to wonder if this isn't an incompatibility between
>>> RSQLite and the latest versions of libspatialite. If anyone has any
>>> experience using the new libspatialite with RSQLite, I'd love to hear
>>> how you got it working.
>>>
>>> Cheers,
>>> Peter
>>>
>>> On Thu, Aug 8, 2013 at 7:08 PM, Peter Schmiedeskamp
>>> <peter at thoughtspot.net> wrote:
>>>> I am running some queries against a spatialite database, and would
>>>> like to get the data directly into R.This thread
>>>> (http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html)
>>>> suggests I can do something like this:
>>>>
>>>> library(RSQLite)
>>>> sqldrv <- dbDriver("SQLite")
>>>> con <- dbConnect(sqldrv, dbname =
>>>> "/path/to/db.sqlite",loadable.extensions = TRUE)
>>>> spatialitestatus <- dbGetQuery(con, "SELECT
>>>> load_extension('libspatialite.dylib')")
>>>>
>>>> But when I do, R segfaults with the following:
>>>>
>>>>  *** caught segfault ***
>>>> address 0x0, cause 'memory not mapped'
>>>>
>>>> Traceback:
>>>>  1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = .SQLitePkgName)
>>>>  2: sqliteFetch(rs, n = -1, ...)
>>>>  3: sqliteQuickSQL(conn, statement, ...)
>>>>  4: dbGetQuery(con, "SELECT
>>>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>>>  5: dbGetQuery(con, "SELECT
>>>> load_extension('/usr/local/lib/libspatialite.dylib')")
>>>>
>>>> In my case, spatialite was built from source using Homebrew, as is the
>>>> version of sqlite that I would normally use. In the libspatialite
>>>> homebrew definition, it says it depends on sqlite > 3.7.3. My
>>>> homebrewed version of sqlite is 3.7.17. My libspatialite is
>>>> libspatialite-4.1.1.
>>>>
>>>> I don't know for certain what version of sqlite RSQLite pulls in by
>>>> default, but I assume it's the version 3.7.17 version included in the
>>>> RSQLite source package. I tried building RSQLite from source
>>>> usinginstall.packages(c("RSQLite"), type="source") in hopes that it
>>>> would simply use my version of sqlite, but it doesn't look like it
>>>> did. Or if it did, it's still crashing.
>>>>
>>>> Finally, I should mention that I tried this under two versions of R
>>>> with same results:
>>>>
>>>> R 3.0.0 downloaded in binary form from CRAN
>>>> R 3.0.1 downloaded in source form and installed via homebrew
>>>>
>>>> Cheers,
>>>> Peter
>>>>
>>>> P.S. I also posted this to stackoverflow a couple days ago, if anyone
>>>> is hankering for some karma:
>>>> http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>


From bellard.celine at gmail.com  Sun Aug 11 11:12:02 2013
From: bellard.celine at gmail.com (=?ISO-8859-1?Q?C=E9line_Bellard?=)
Date: Sun, 11 Aug 2013 11:12:02 +0200
Subject: [R-sig-Geo] raster contourplot issue
Message-ID: <52075562.1050709@gmail.com>

Sorry for the replicates, but I am not sure that my previous message was 
sent.

Hi members,

I would like to superpose a raster stack and some contour lines (several
pannels).
It is possible with rasterVis :
levelplot()+contourplot()

But I would like to do it with plot (much faster) :
plot()
and something like contour(<>, add=T)

Any idea ? Thank !

C?line

-- 
C?line Bellard, PhD student
  
Lab ESE, UMR CNRS 8079

Univ Paris-Sud Tel  (0033/0) 1 69 15 56 85

Bat 362

F-91405  Orsay Cedex FRANCE


From edzer.pebesma at uni-muenster.de  Sun Aug 11 21:33:35 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 11 Aug 2013 21:33:35 +0200
Subject: [R-sig-Geo] autoKrige: singular matrix in function LDLfactor
In-Reply-To: <1375861305883-7584363.post@n2.nabble.com>
References: <1375748612704-7584343.post@n2.nabble.com>
	<1375796677539-7584348.post@n2.nabble.com>
	<1375861305883-7584363.post@n2.nabble.com>
Message-ID: <5207E70F.4020403@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

zerodist and zerodist2 give wrong results when data are longlat;
please try using sp from r-forge for this; see
https://r-forge.r-project.org/R/?group_id=1014

On 08/07/2013 09:41 AM, ElenaC wrote:
> Thanks Jesse,
> 
> the issue does indeed seem to be a malfunctioning of zerodist2().
> The first time I tried, when I got no matches, both SpatialPoints
> objects were projected, with proj4string of "+proj=merc
> +ellps=WGS84".
> 
> I have now tried again with the same data but unprojected
> (proj4string of "+proj=longlat +ellps=WGS84"), and I am getting
> over 10,000 matches. But the output still doesn't make any sense!
> (What I understand the function is meant to do is find indexes in
> both objects with matching coordinates, but it is not doing that):
> 
> 
>> match <- zerodist2(HG1990,center_points) dim(match)
> [1] 13478     2
>> 
>> match[1,]
> [1]  2840 51188
>> 
>> coordinates(HG1990[2840,])
> coords.x1 coords.x2 [1,]        48        48
>> coordinates(center_points[51188,])
> coords_lon2 coords_lat2 [1,]      42.125      42.125
> 
> The coordinates above certainly do not match (in fact there is not
> a single pair of matching coordinates out of the over 13,000 rows
> returned by zerodist2). Would this be a bug or am I interpreting
> the output incorrectly?
> 
> These are the library versions I am using:
> 
>> sessionInfo()
> R version 3.0.1 (2013-05-16) Platform: x86_64-apple-darwin10.8.0
> (64-bit)
> 
> locale: [1]
> en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages: [1] stats     graphics  grDevices utils
> datasets  methods   base
> 
> other attached packages: [1] automap_1.0-12 gstat_1.0-16
> ncdf_1.6.6     rgdal_0.8-10   sp_1.0-11
> 
> loaded via a namespace (and not attached): [1] grid_3.0.1
> intervals_0.14.0 lattice_0.20-15  spacetime_1.0-5 tools_3.0.1
> xts_0.9-5        zoo_1.7-10
> 
> 
> 
> -- View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/autoKrige-singular-matrix-in-function-LDLfactor-tp7584343p7584363.html
>
> 
Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJSB+cPAAoJEM1OCHCtOnfx6+4H/jNw39dEBTUAcfl+hDUJVBbB
1yogGGr0HeaZ8qkFVJ/Q/bNNAW1LWZX0FAkx9WsFJ/TNIsILTZe1o9YE3G6vjc55
g5WdnCpoi5yRoKx/AO916YEaEXZ5LRdFjCwfvePwg04Ky9LSiRyhp3VeuQVmoGCo
L5Ep+qM1A7FaavBT3GQX5yx/TBAj9sfa8y3zAetJEDLTJYwgQdBK91g8a/GeG/oR
BfwlmpYXnvVN6TfnBLnwk2tijYSKRTbQRpL4bJqiucO/mwVP7OPx2Y9hn1DXi8+2
uLIwb9lZCc7ja4VJZmijWabkhDcGh56ilawDu5Np+PjFWKnWyZMqHzzhGt6MFQQ=
=e1zL
-----END PGP SIGNATURE-----


From bakare at ualberta.ca  Sun Aug 11 22:01:47 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Sun, 11 Aug 2013 14:01:47 -0600
Subject: [R-sig-Geo] knearneigh function - warning message
Message-ID: <CAJRR3XM=A6XXkgMV1T4tdDkBGnH=t+eoqMbti8-=UXAXzqxR6A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130811/4a450bd7/attachment.pl>

From kridox at ymail.com  Mon Aug 12 04:35:53 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Mon, 12 Aug 2013 11:35:53 +0900
Subject: [R-sig-Geo] knearneigh function - warning message
In-Reply-To: <CAJRR3XM=A6XXkgMV1T4tdDkBGnH=t+eoqMbti8-=UXAXzqxR6A@mail.gmail.com>
References: <CAJRR3XM=A6XXkgMV1T4tdDkBGnH=t+eoqMbti8-=UXAXzqxR6A@mail.gmail.com>
Message-ID: <CAAcyNCycfkcCAAY3JeY0PGROb=YW0Piox6vLh9wF5o75K+5zSw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/49aef4a0/attachment.pl>

From bakare at ualberta.ca  Mon Aug 12 06:12:24 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Sun, 11 Aug 2013 22:12:24 -0600
Subject: [R-sig-Geo] knearneigh function - warning message
In-Reply-To: <CAAcyNCycfkcCAAY3JeY0PGROb=YW0Piox6vLh9wF5o75K+5zSw@mail.gmail.com>
References: <CAJRR3XM=A6XXkgMV1T4tdDkBGnH=t+eoqMbti8-=UXAXzqxR6A@mail.gmail.com>
	<CAAcyNCycfkcCAAY3JeY0PGROb=YW0Piox6vLh9wF5o75K+5zSw@mail.gmail.com>
Message-ID: <CAJRR3XPaE7Ez_M0RhLjhgvn6XAWTb-93=O4yj8R1oWXQ4sxweg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130811/197666d4/attachment.pl>

From bakare at ualberta.ca  Mon Aug 12 06:32:20 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Sun, 11 Aug 2013 22:32:20 -0600
Subject: [R-sig-Geo] gstat - goodness of model fit to empirical semivariogram
Message-ID: <CAJRR3XMdZQzK1qqTPVjF7yoBwKk5rH1cPach2j_RWOVajC_y2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130811/10cd7720/attachment.pl>

From tech_dev at wildintellect.com  Mon Aug 12 08:04:28 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Sun, 11 Aug 2013 23:04:28 -0700
Subject: [R-sig-Geo] [SpatiaLite-Users] Re: Load spatialite extension in
 RSQLite crashes R (OS X 10.8)
In-Reply-To: <b310995f-f732-4785-8d8e-c027db71cc21@googlegroups.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
	<CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
	<52068D1B.80700@wildintellect.com>
	<CAOhL9ALfCDiT-mgT5gC0_EPyMC-w8rs7v94-7SJx_S6jq7yfbA@mail.gmail.com>
	<52068F43.9050208@wildintellect.com>
	<CAOhL9AKhHjMoGrY6H4AvTCOkhhyhQ8szevXYVUgroSQ5PfMCEg@mail.gmail.com>
	<b310995f-f732-4785-8d8e-c027db71cc21@googlegroups.com>
Message-ID: <52087AEC.7020102@wildintellect.com>

Peter,

I wanted to report that I've found another workaround. If you create a
view in spatialite (pick your interface), that view can then be
registered as spatial and loaded via rgdal readOGR:

1. CREATE VIEW with a geometry column
2. INSERT a record into views_geometry_columns for that view
Looks like:
INSERT INTO views_geometry_columns
    (view_name, view_geometry, view_rowid, f_table_name, f_geometry_column)
  VALUES ('italy', 'geometry', 'ROWID', 'local_councils', 'geometry');

f_table_name is the table referenced in the view from which the geometry
actually derives from.
3. Open R
4. Load rgdal
5. test <- readOGR("somedata.db","italy",verbose=TRUE,disambiguateFIDs=TRUE)

verbose isn't required, disambiguiateFIDs is if you don't have a unique
ID column in your view.

Hints from:
http://www.gaia-gis.it/spatialite-3.0.0-BETA/spatialite-cookbook/html/sp-view.html
http://gis.stackexchange.com/a/25044

Note, such views can also be loaded in QGIS > 1.8 (so master version
soon to be 2.0), this should work with spatialite 3+

Not as clean as just executing the sql in R, but I usually prep my
queries first anyways and store them in code, so making views is just as
cheap and easy.

Thanks,
Alex

On 08/10/2013 03:33 PM, Peter Schmiedeskamp wrote:
> I never was quite able to figure out how to get even version 3 of the 
> libspatialite package to load in R on OS X with the CRAN version of 
> RSQLite. So, my short-term solution was to create a package, 
> RSQLite.spatialite, that builds and loads its own amalgamated build of 
> spatialite.
> 
> https://github.com/pschmied/RSQLite.spatialite
> 
> This is kind of a short-term hacky solution until someone (probably not me) 
> comes up with a more robust way of loading libspatialite4.
> 
> Cheers,
> Peter
> 
> On Saturday, August 10, 2013 12:29:00 PM UTC-7, Peter Schmiedeskamp wrote:
>>
>> Dear list, 
>>
>> I've spent the past few days trying to track down an issue whereby I'm 
>> unable to load the latest version of libspatialite (4.1.1) as an 
>> extension in various environments (RSQLite, Clojure/Xerial-JDBC on 
>> Ubuntu 13.04 and OS X 10.8). Using libspatialite 3.x, it would appear 
>> things mostly work. 
>>
>> I'm forwarding this email history along in case anyone might know what 
>> sort of differences in libspatialite 4 might be causing this, or in 
>> case some future intrepid explorer finds their way to the same 
>> problem. 
>>
>> Cheers, 
>> Peter 
>>
>>
>> ---------- Forwarded message ---------- 
>> From: Alex Mandel <tech_dev at wildintellect.com> 
>> Date: Sat, Aug 10, 2013 at 12:06 PM 
>> Subject: Re: [R-sig-Geo] Load spatialite extension in RSQLite crashes 
>> R (OS X 10.8) 
>> To: Peter Schmiedeskamp <peter at thoughtspot.net> 
>> Cc: r-sig-geo at r-project.org 
>>
>>
>> Yes, thats a good place to ask, though you may once again be talking to 
>> me. I did find this old thread I had forgot about, which has some more 
>> ideas. 
>> https://stat.ethz.ch/pipermail/r-sig-db/2010q1/000784.html 
>>
>> Thanks, 
>> Alex 
>>
>> On 08/10/2013 12:02 PM, Peter Schmiedeskamp wrote: 
>>> Thanks Alex, 
>>>
>>> I'm in the thick of working with this now, and literally just 
>>> discovered that libspatialite.so.3 loads in Ubuntu and OS X (however, 
>>> queries exercising spatial functions still cause R to segfault on OS 
>>> X, but I'll take this as forward progress). 
>>>
>>> If you don't mind, I'll forward this thread on to the spatialite users 
>>> group. I've seen a few postings focussed on other languages that talk 
>>> about extension loading problems with the new libspatialite. 
>>>
>>> Cheers, 
>>> Peter 
>>>
>>>
>>> On Sat, Aug 10, 2013 at 11:57 AM, Alex Mandel 
>>> <tech_dev at wildintellect.com> wrote: 
>>>> That's entirely possible Spatialite 4 had some changes to the db 
>>>> structure when compared to Spatialite 3. I don't think RSQLite or 
>>>> Pyspatialite have caught up yet, and SQLiteMap (R package) appears 
>>>> orphaned. So I would try to roll back to spatialite 3 and see if you 
>> can 
>>>> get that working with SQLiteMap. That also appears to mean R below 
>>>> version 3. 
>>>>
>>>> So in Raring (13.04) that means use it from the main ubuntu repos. 
>>>> On Mac http://www.kyngchaos.com/software:frameworks  Spatialite Tools 
>> v3.0 
>>>>
>>>> Possible workaround, create a view and then use rgdal (with gdal 1.10) 
>>>> to import that view. 
>>>>
>>>> I tested on ubuntu 12.04 and those instructions (which I wrote) don't 
>>>> appear to work anymore, at least not with R 3.0+spatialite3. I 
>>>> originally figured that out back in 2008-2009 though so a lot has 
>>>> changed since then. I'm going to go back to OSGeoLive 6.5 and see if 
>>>> they work (that should have R 2.15 with spatialite3) 
>>>>
>>>> Thanks, 
>>>> Alex 
>>>>
>>>> On 08/09/2013 01:57 PM, Peter Schmiedeskamp wrote: 
>>>>> I fired up an Ubuntu VM and found that loading the spatialite 
>>>>> extension also seems to crash there. My test Ubuntu setup is v13.04 
>>>>> (x86_64). I installed libspatialite5 from the Ubuntu FOSS GIS 
>>>>> packages: (
>> http://hub.qgis.org/projects/quantum-gis/wiki/Download#262-With-updated-dependencies). 
>>
>>>>> R was installed from the CRAN Ubuntu package site. 
>>>>>
>>>>> I am starting to wonder if this isn't an incompatibility between 
>>>>> RSQLite and the latest versions of libspatialite. If anyone has any 
>>>>> experience using the new libspatialite with RSQLite, I'd love to hear 
>>>>> how you got it working. 
>>>>>
>>>>> Cheers, 
>>>>> Peter 
>>>>>
>>>>> On Thu, Aug 8, 2013 at 7:08 PM, Peter Schmiedeskamp 
>>>>> <peter at thoughtspot.net> wrote: 
>>>>>> I am running some queries against a spatialite database, and would 
>>>>>> like to get the data directly into R.This thread 
>>>>>> (
>> http://r-sig-geo.2731867.n2.nabble.com/Re-spatialite-from-R-td7583603.html) 
>>
>>>>>> suggests I can do something like this: 
>>>>>>
>>>>>> library(RSQLite) 
>>>>>> sqldrv <- dbDriver("SQLite") 
>>>>>> con <- dbConnect(sqldrv, dbname = 
>>>>>> "/path/to/db.sqlite",loadable.extensions = TRUE) 
>>>>>> spatialitestatus <- dbGetQuery(con, "SELECT 
>>>>>> load_extension('libspatialite.dylib')") 
>>>>>>
>>>>>> But when I do, R segfaults with the following: 
>>>>>>
>>>>>>  *** caught segfault *** 
>>>>>> address 0x0, cause 'memory not mapped' 
>>>>>>
>>>>>> Traceback: 
>>>>>>  1: .Call("RS_SQLite_fetch", rsId, nrec = n, PACKAGE = 
>> .SQLitePkgName) 
>>>>>>  2: sqliteFetch(rs, n = -1, ...) 
>>>>>>  3: sqliteQuickSQL(conn, statement, ...) 
>>>>>>  4: dbGetQuery(con, "SELECT 
>>>>>> load_extension('/usr/local/lib/libspatialite.dylib')") 
>>>>>>  5: dbGetQuery(con, "SELECT 
>>>>>> load_extension('/usr/local/lib/libspatialite.dylib')") 
>>>>>>
>>>>>> In my case, spatialite was built from source using Homebrew, as is 
>> the 
>>>>>> version of sqlite that I would normally use. In the libspatialite 
>>>>>> homebrew definition, it says it depends on sqlite > 3.7.3. My 
>>>>>> homebrewed version of sqlite is 3.7.17. My libspatialite is 
>>>>>> libspatialite-4.1.1. 
>>>>>>
>>>>>> I don't know for certain what version of sqlite RSQLite pulls in by 
>>>>>> default, but I assume it's the version 3.7.17 version included in the 
>>>>>> RSQLite source package. I tried building RSQLite from source 
>>>>>> usinginstall.packages(c("RSQLite"), type="source") in hopes that it 
>>>>>> would simply use my version of sqlite, but it doesn't look like it 
>>>>>> did. Or if it did, it's still crashing. 
>>>>>>
>>>>>> Finally, I should mention that I tried this under two versions of R 
>>>>>> with same results: 
>>>>>>
>>>>>> R 3.0.0 downloaded in binary form from CRAN 
>>>>>> R 3.0.1 downloaded in source form and installed via homebrew 
>>>>>>
>>>>>> Cheers, 
>>>>>> Peter 
>>>>>>
>>>>>> P.S. I also posted this to stackoverflow a couple days ago, if anyone 
>>>>>> is hankering for some karma: 
>>>>>>
>> http://stackoverflow.com/questions/18107336/load-spatialite-extension-in-rsqlite-crashes-r-os-x 
>>>>>
>>>>> _______________________________________________ 
>>>>> R-sig-Geo mailing list 
>>>>> R-sig-Geo at r-project.org 
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo 
>>>>>
>>>>
>>
>


From gerardommc at gmail.com  Mon Aug 12 08:28:18 2013
From: gerardommc at gmail.com (Gerardo Martin)
Date: Mon, 12 Aug 2013 16:28:18 +1000
Subject: [R-sig-Geo] Maxent and Maxlike data.frame methods
Message-ID: <52088082.8000909@gmail.com>

Hi, I', trying to implement a series of species distribution models. I 
am working with seasonal data and as I want to project them to several 
different scenarios, i need to use strictly samples with data format. I 
have extracted the background and pseudoabsences points from their 
corresponding raster files, so nos i want to fit the maxlike and maxent 
models and then project them with different rasterStack objects. The 
problem is that i haven't found out if there's a data.frame method for 
maxlike, there's no reference to such a thing in the reference manual. 
Besides, for maxent, the sdm vignete only describes how to run maxent 
with a rasterStack. I have found out how to specify pseudoabsences for 
maxent providing a vector with 1's and 0's, but no method as to specify 
a data frame with the background data.

Regards

Gerardo


From rafael.wueest at wsl.ch  Mon Aug 12 11:40:15 2013
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Mon, 12 Aug 2013 11:40:15 +0200
Subject: [R-sig-Geo] Maxent and Maxlike data.frame methods
In-Reply-To: <52088082.8000909@gmail.com>
References: <52088082.8000909@gmail.com>
Message-ID: <73F53E11-B253-46BE-BEF3-1481043D136F@wsl.ch>

Hi Gerardo

I'm not sure I understand exactly what your question is about. Maybe some reproducible example code could help... Assuming you want to fit a maxent model using a dataframe and providing background presences, the help file in ?maxent should be helpful as it says:

maxent(x, p, ...)

p: [...] If x is a data.frame, p should be a vector with a length equal to nrow(x) and contain 0 (background) and 1 (presence) values, to indicate which records (rows) in data.frame x are presence records, and which are background records.

HTH, Rafael


On 12.08.2013, at 08:28, Gerardo Martin <gerardommc at gmail.com> wrote:

> Hi, I', trying to implement a series of species distribution models. I am working with seasonal data and as I want to project them to several different scenarios, i need to use strictly samples with data format. I have extracted the background and pseudoabsences points from their corresponding raster files, so nos i want to fit the maxlike and maxent models and then project them with different rasterStack objects. The problem is that i haven't found out if there's a data.frame method for maxlike, there's no reference to such a thing in the reference manual. Besides, for maxent, the sdm vignete only describes how to run maxent with a rasterStack. I have found out how to specify pseudoabsences for maxent providing a vector with 1's and 0's, but no method as to specify a data frame with the background data.
> 
> Regards
> 
> Gerardo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From roman.lustrik at gmail.com  Mon Aug 12 14:28:58 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 12 Aug 2013 14:28:58 +0200
Subject: [R-sig-Geo] Maxent and Maxlike data.frame methods
In-Reply-To: <73F53E11-B253-46BE-BEF3-1481043D136F@wsl.ch>
References: <52088082.8000909@gmail.com>
	<73F53E11-B253-46BE-BEF3-1481043D136F@wsl.ch>
Message-ID: <CAHT1vpjPENuzp8OnxRWOJHV4jOLFJWDXs9wS2oWJs+ks1xq1AA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/950c897e/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Aug 12 16:11:28 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 12 Aug 2013 16:11:28 +0200
Subject: [R-sig-Geo] gstat: Cokriging with unusual neighbourhood choice
 - is this possible?
In-Reply-To: <CAFsio8hxhnpkNXGxxncQ4Sv0S3_kFZe=o0OJ9aQxk0fny3nNZg@mail.gmail.com>
References: <CAFsio8hxhnpkNXGxxncQ4Sv0S3_kFZe=o0OJ9aQxk0fny3nNZg@mail.gmail.com>
Message-ID: <5208ED10.2050503@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



On 07/31/2013 02:26 PM, Ralph Mettier wrote:
> Dear Edzer
> 
> Thank you greatly for your reply. I have attempted to implement
> the solution you suggested, but either it's not what I was looking
> for, or more likely, I'm missing something. Currently the relevant
> code passage looks like this:
> 
> ##--------------------
> 
> m.grid=data.frame(x=outgrid$V1,y=outgrid$V2) 
> m_preca=data.frame(x=prec[,2],y=prec[,3],preca=prec[,5]) 
> m_precb=data.frame(x=conc[,2],y=conc[,3],precb=conc[,6]) 
> m_conc=data.frame(x=conc[,2],y=conc[,3],conc=conc[,5]) 
> coordinates(m.grid) = ~x+y coordinates(m_preca)=~x+y 
> coordinates(m_precb)=~x+y coordinates(m_conc)=~x+y
> 
> ## Gstat m.g=gstat(id="conc",formula=conc ~ 1, data = m_conc, 
> nmax=16,model=vgm(0.4,"Pow",1,add.to=vgm(120,"Sph",200,10))) 
> m.g=gstat(m.g,id="preca",formula=preca ~ 1, 
> data=m_preca,nmax=16,model=vgm(0.1,"Pow",1,add.to=vgm(25,"Sph",200,80)))
>
> 
m.g=gstat(m.g,id="precb",formula=precb ~ 1,
> data=m_precb,nmax=16,model=vgm(0.1,"Pow",1,add.to 
> =vgm(25,"Sph",200,80)),merge=list(c("preca",1,"precb",1))) 
> m.g=gstat(m.g,id=c("conc","preca"),model=vgm(0.01,"Pow",1,add.to 
> =vgm(110,"Sph",200,70))) 
> m.g=gstat(m.g,id=c("preca","precb"),model=vgm(0.01,"Pow",1,add.to 
> =vgm(110,"Sph",200,70))) 
> m.g=gstat(m.g,id=c("conc","precb"),model=vgm(0.01,"Pow",1,add.to 
> =vgm(110,"Sph",200,70)))
> 
> ## Empirical Variogram 
> m.g.var=variogram(m.g,width=110,cutoff=600,pseudo=-1) ## Fitting 
> m.g.fit=fit.lmc(m.g.var,m.g,fit.lmc=TRUE,fit.ranges=FALSE,correct.diagonal=1.01,fit.method=7)
>
>  ## Force same variograms for preca and precb 
> m.g.fit$model$preca=m.g.fit$model$preca.precb 
> m.g.fit$model$precb=m.g.fit$model$preca.precb
> 
> ## Co-Kriging m.g.fit$set=list(nocheck=1) 
> m.g.pred=predict(m.g.fit,newdata=m.grid)
> 
> ##----------------------------
> 
> As you can see from the variable names, this has organically grown
> from something inspired by the 'meuse' example in gstat. Here's
> what I think I'm doing:
> 
> - set up a three variable gstat object, where two variables (conc
> and precb) come from the same measuring stations. preca comes from
> another station network, as discribed in my first message. - fit
> variograms and cross-variograms to this object - force the
> variograms for 'preca' and 'precb' and their cross-variogram to be
> identical - use the variograms for co-kriging
> 
> Am I making some fundamental mistake?

If you do, I can't see it, but then you were not very explicit about
what you expect, nor about what you got by doing this.

Cokriging makes shure both variables get a different mean effect
fitted. But if they are different variables, why would they have the
same variogram? Having a cross variogram that equals both direct
variogram (or the square root of their product) implies perfect
correlation: this does not correspond to what you called "a decent
correlation" in your earlier email.

> 
> Best Regards Ralph
> 
> [[alternative HTML version deleted]]
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJSCO0QAAoJEM1OCHCtOnfx/fMH/0CcRm/hHVTtC1tV31E5YpqP
uob74Q2oKr7jReu507rzl2DgfMe6BVSCt0CrHANWT0lE6DkhVxTsWZCwvQwiESCI
A7F6n2vKKlRMGGu7cO3CzjTP3lk80RWNMMRcl6F0vimA8DsaOrcThfo6VKvSWsIf
NGJ4LTKlJq51NAehKFPok6HJ6j6/6eJxI8r3Dej3QbyXxG0cX9abOsdQ1SW5Xtkk
3zDOXHgm33pyewzfbpALG3fIJnlUoa6xh0SIvwu9NmZcpTd/ChC+DTPC5e/zGgoZ
GjZrTXxnWjndMYTWEawv9Ib8jqzD0ncOs5w2QT+Rs/Dg3evk/W9X9rExp1X3pPc=
=dQI3
-----END PGP SIGNATURE-----


From peter at thoughtspot.net  Mon Aug 12 16:18:21 2013
From: peter at thoughtspot.net (Peter Schmiedeskamp)
Date: Mon, 12 Aug 2013 07:18:21 -0700
Subject: [R-sig-Geo] [SpatiaLite-Users] Re: Load spatialite extension in
 RSQLite crashes R (OS X 10.8)
In-Reply-To: <52087AEC.7020102@wildintellect.com>
References: <CAOhL9AJLoX+n1-wgiGbJZdSo4nNFYg9LczaR1ksdjEfoo4G9SQ@mail.gmail.com>
	<CAOhL9AJxbOy39rXZU954em=RT1h6Z=ndBQzC3aXJLHn+ZG1C4w@mail.gmail.com>
	<52068D1B.80700@wildintellect.com>
	<CAOhL9ALfCDiT-mgT5gC0_EPyMC-w8rs7v94-7SJx_S6jq7yfbA@mail.gmail.com>
	<52068F43.9050208@wildintellect.com>
	<CAOhL9AKhHjMoGrY6H4AvTCOkhhyhQ8szevXYVUgroSQ5PfMCEg@mail.gmail.com>
	<b310995f-f732-4785-8d8e-c027db71cc21@googlegroups.com>
	<52087AEC.7020102@wildintellect.com>
Message-ID: <CAOhL9ALjZQLQPjRu+iUasKqYyz198WzY4zv9H_R=PY85CsfonQ@mail.gmail.com>

Thank you, Alex.

That indeed is a work-around. And for all practical purposes, I like
to keep my intermediate results around as views anyway. The package I
built lets me create the views by executing the SQL directly in R,
however, I'll confess that there are nicer ways to explore building
those views. Still, there are some instances where executing a spatial
query directly from R is handy, and I guess I now have my package!

It looks like support for "amalgamation" builds was dropped in v4.x of
libspatialite, so my approach is old and getting older. This is a
shame, considering the speed benefits in 4.1
(https://www.gaia-gis.it/fossil/libspatialite/wiki?name=speed-optimization).
In theory, it would be possible to build libspatialite 4.1 inside an R
package, but I have no idea how to go about packaging software whose
build process is more elaborate / uses the autotools.

If I were a smarter and had more time, I'd consider resurrecting the
SQLiteMap package, which wraps all the libspatialite functions in R...

Cheers,
Peter


On Sun, Aug 11, 2013 at 11:04 PM, Alex Mandel
<tech_dev at wildintellect.com> wrote:
> Peter,
>
> I wanted to report that I've found another workaround. If you create a
> view in spatialite (pick your interface), that view can then be
> registered as spatial and loaded via rgdal readOGR:
>
> 1. CREATE VIEW with a geometry column
> 2. INSERT a record into views_geometry_columns for that view
> Looks like:
> INSERT INTO views_geometry_columns
>     (view_name, view_geometry, view_rowid, f_table_name, f_geometry_column)
>   VALUES ('italy', 'geometry', 'ROWID', 'local_councils', 'geometry');
>
> f_table_name is the table referenced in the view from which the geometry
> actually derives from.
> 3. Open R
> 4. Load rgdal
> 5. test <- readOGR("somedata.db","italy",verbose=TRUE,disambiguateFIDs=TRUE)
>
> verbose isn't required, disambiguiateFIDs is if you don't have a unique
> ID column in your view.
>
> Hints from:
> http://www.gaia-gis.it/spatialite-3.0.0-BETA/spatialite-cookbook/html/sp-view.html
> http://gis.stackexchange.com/a/25044
>
> Note, such views can also be loaded in QGIS > 1.8 (so master version
> soon to be 2.0), this should work with spatialite 3+
>
> Not as clean as just executing the sql in R, but I usually prep my
> queries first anyways and store them in code, so making views is just as
> cheap and easy.
>
> Thanks,
> Alex
>


From holtermann at hwwi.org  Mon Aug 12 16:37:27 2013
From: holtermann at hwwi.org (Linus Holtermann)
Date: Mon, 12 Aug 2013 16:37:27 +0200
Subject: [R-sig-Geo] Marginal effects for spatial probit models
Message-ID: <AD0050057515F54084E7D5B93478C848A12FF86B@winxbede39.exchange.xchg>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/e56b6614/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Calculation of marginal effects.docx
Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document
Size: 16390 bytes
Desc: Calculation of marginal effects.docx
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/e56b6614/attachment.bin>

From oscar.perpinan at gmail.com  Mon Aug 12 18:18:39 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Mon, 12 Aug 2013 18:18:39 +0200
Subject: [R-sig-Geo] raster contourplot issue
In-Reply-To: <52075562.1050709@gmail.com>
References: <52075562.1050709@gmail.com>
Message-ID: <CAMLL7bmZgTsdCUbyg_AEAPXQbB9rnnfmd04y52v-wCWQXnCcdA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/232a0599/attachment.pl>

From bakare at ualberta.ca  Mon Aug 12 19:03:36 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 12 Aug 2013 11:03:36 -0600
Subject: [R-sig-Geo] gstat -ordinary kriging from residual variogram model
Message-ID: <CAJRR3XOO35fjjszGv08bSVAztpL-hbsUB2KQ8=KmaeF9Z1LM6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/675bb294/attachment.pl>

From juantomas.sayago at gmail.com  Mon Aug 12 22:09:30 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Mon, 12 Aug 2013 16:09:30 -0400
Subject: [R-sig-Geo] Marginal effects for spatial probit models
In-Reply-To: <AD0050057515F54084E7D5B93478C848A12FF86B@winxbede39.exchange.xchg>
References: <AD0050057515F54084E7D5B93478C848A12FF86B@winxbede39.exchange.xchg>
Message-ID: <CAEOXpNBkxNyGWX4=XnJy5s=5A3T4uy+tMKOSzV3-oOgJoGMo+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/0da9c9c2/attachment.pl>

From Dominik.Schneider at colorado.edu  Mon Aug 12 23:17:44 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Mon, 12 Aug 2013 15:17:44 -0600
Subject: [R-sig-Geo] optimize idw power
Message-ID: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/548aa4c6/attachment.pl>

From tea3rd at gmail.com  Tue Aug 13 01:54:07 2013
From: tea3rd at gmail.com (Thomas Adams)
Date: Mon, 12 Aug 2013 19:54:07 -0400
Subject: [R-sig-Geo] optimize idw power
In-Reply-To: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
References: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
Message-ID: <CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/b8e63706/attachment.pl>

From choct155 at gmail.com  Tue Aug 13 03:15:08 2013
From: choct155 at gmail.com (Marvin Ward, Jr.)
Date: Mon, 12 Aug 2013 21:15:08 -0400
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the right
 coordinates after conversion)
Message-ID: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130812/2f2e2636/attachment.pl>

From kridox at ymail.com  Tue Aug 13 07:33:21 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 13 Aug 2013 14:33:21 +0900
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the
 right coordinates after conversion)
In-Reply-To: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
References: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
Message-ID: <CAAcyNCwPcMd9PcbhUUu2D=7BOic0DrDovJZ=-tTuQ8VDEni06A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/a53003ce/attachment.pl>

From bellard.celine at gmail.com  Tue Aug 13 08:27:37 2013
From: bellard.celine at gmail.com (=?ISO-8859-1?Q?C=E9line_Bellard?=)
Date: Tue, 13 Aug 2013 08:27:37 +0200
Subject: [R-sig-Geo] raster contourplot issue
In-Reply-To: <CAMLL7bmZgTsdCUbyg_AEAPXQbB9rnnfmd04y52v-wCWQXnCcdA@mail.gmail.com>
References: <52075562.1050709@gmail.com>
	<CAMLL7bmZgTsdCUbyg_AEAPXQbB9rnnfmd04y52v-wCWQXnCcdA@mail.gmail.com>
Message-ID: <CANBfNKVyPP_RpBBoGC4MAyXa9Cs2Pq49LUrm=6pgyyBMoheFuw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/a84edc5d/attachment.pl>

From kridox at ymail.com  Tue Aug 13 08:34:18 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 13 Aug 2013 15:34:18 +0900
Subject: [R-sig-Geo] raster contourplot issue
In-Reply-To: <CANBfNKVyPP_RpBBoGC4MAyXa9Cs2Pq49LUrm=6pgyyBMoheFuw@mail.gmail.com>
References: <52075562.1050709@gmail.com>
	<CAMLL7bmZgTsdCUbyg_AEAPXQbB9rnnfmd04y52v-wCWQXnCcdA@mail.gmail.com>
	<CANBfNKVyPP_RpBBoGC4MAyXa9Cs2Pq49LUrm=6pgyyBMoheFuw@mail.gmail.com>
Message-ID: <CAAcyNCyb0p5xMo9+S4SPkJ5OO7o4t4tbwAMosdfVEk_sreavNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/279ff7e4/attachment.pl>

From choct155 at gmail.com  Tue Aug 13 13:29:52 2013
From: choct155 at gmail.com (Marvin Ward, Jr.)
Date: Tue, 13 Aug 2013 07:29:52 -0400
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the
 right coordinates after conversion)
In-Reply-To: <CAAcyNCwPcMd9PcbhUUu2D=7BOic0DrDovJZ=-tTuQ8VDEni06A@mail.gmail.com>
References: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
	<CAAcyNCwPcMd9PcbhUUu2D=7BOic0DrDovJZ=-tTuQ8VDEni06A@mail.gmail.com>
Message-ID: <CAOAB+P2w7u5cuY0YYhN6CaQsLXzvj27mV6GdnrZTQyQW0xugXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/1706f325/attachment.pl>

From bellard.celine at gmail.com  Tue Aug 13 13:33:05 2013
From: bellard.celine at gmail.com (=?ISO-8859-1?Q?C=E9line_Bellard?=)
Date: Tue, 13 Aug 2013 13:33:05 +0200
Subject: [R-sig-Geo] raster contourplot issue
In-Reply-To: <CAAcyNCyb0p5xMo9+S4SPkJ5OO7o4t4tbwAMosdfVEk_sreavNA@mail.gmail.com>
References: <52075562.1050709@gmail.com>
	<CAMLL7bmZgTsdCUbyg_AEAPXQbB9rnnfmd04y52v-wCWQXnCcdA@mail.gmail.com>
	<CANBfNKVyPP_RpBBoGC4MAyXa9Cs2Pq49LUrm=6pgyyBMoheFuw@mail.gmail.com>
	<CAAcyNCyb0p5xMo9+S4SPkJ5OO7o4t4tbwAMosdfVEk_sreavNA@mail.gmail.com>
Message-ID: <CANBfNKVyqE3xH1zm+zmXRAokOAZTtV49pjLa3tiz8it_aL+szA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/982ffef8/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Tue Aug 13 15:38:50 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Tue, 13 Aug 2013 15:38:50 +0200
Subject: [R-sig-Geo] optimize idw power
In-Reply-To: <CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>
References: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
	<CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>
Message-ID: <520A36EA.7020608@jrc.ec.europa.eu>

Dominik,

The brute force approach shown in the link from Tom has in the mean time 
been implemented in the intamap package. See the example for the 
function "estimateParameters".

Cheers,
Jon

On 13-Aug-13 1:54, Thomas Adams wrote:
> Dominik,
>
> Look here:
> http://r-sig-geo.2731867.n2.nabble.com/GSTAT-Optimize-power-value-for-IDW-td2765918.html
>
> Tom
>
>
> On Mon, Aug 12, 2013 at 5:17 PM, Dominik Schneider <
> Dominik.Schneider at colorado.edu> wrote:
>
>> Hi,
>> I'd like to optimize the IDW power, similar to what ArcGIS does. I found
>> this old thread
>> http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg04011.html but
>> was hoping someone could help adapt the solution. I am using
>>
>>
>> idw(residuals(mdl.stepaic[[j]])~1,locations=swe.nozeros[swe.nozeros$mth==mth
>> & swe.nozeros$yr==yr,],newdata=swe.grid)
>>
>> where mdl.stepaic[[j]] is a list of 39 regression equations. swe.nozeros is
>> a spatialpointsdataframe of observations. swe.grid is a grid where I want
>> new values predicted. I currently run this idw command through a loop of j
>> with no problems but I'd like to optimize both within each equation
>> represented by j and for the whole data set (so across the 39 timesteps).
>>
>> Below is what I'm starting with but I don't really understand how to get it
>> working. I appreciate your help.
>>
>> f= function(idp,formula,locations,newdata,...) {
>>
>> sum(idw(formula,locations,newdata),set=list(debug=0,idp=idp),...)$residuals**2
>> }
>>
>> optimize(f,interval=seq(1.4,1.7,by=0.1),formula=residuals(mdl.stepaic[[j]])~1,locations=swe.nozeros[swe.nozeros$mth==mth
>> & swe.nozeros$yr==yr,],newdata=swe.grid)
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From ashton at msu.edu  Tue Aug 13 16:19:45 2013
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 13 Aug 2013 10:19:45 -0400
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the
	right coordinates after conversion)
In-Reply-To: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
References: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
Message-ID: <3629120.8HaPZ7KTip@erebus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/2844f2f7/attachment.pl>

From choct155 at gmail.com  Tue Aug 13 16:26:02 2013
From: choct155 at gmail.com (Marvin Ward, Jr.)
Date: Tue, 13 Aug 2013 10:26:02 -0400
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the
 right coordinates after conversion)
In-Reply-To: <3629120.8HaPZ7KTip@erebus>
References: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
	<3629120.8HaPZ7KTip@erebus>
Message-ID: <CAOAB+P161pp7FDLEtoaLD6DM8eDya7ZsBmWpdZmiYppNb4m2JQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/1bb17dbf/attachment.pl>

From Dominik.Schneider at colorado.edu  Tue Aug 13 18:59:09 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Tue, 13 Aug 2013 10:59:09 -0600
Subject: [R-sig-Geo] optimize idw power
In-Reply-To: <520A36EA.7020608@jrc.ec.europa.eu>
References: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
	<CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>
	<520A36EA.7020608@jrc.ec.europa.eu>
Message-ID: <CAHYDKLYsoLnYRnVS5epyuPEd0UCdSP=CE964uYghm=Gt1mT9bw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130813/0906eb0b/attachment.pl>

From kridox at ymail.com  Wed Aug 14 02:32:45 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 14 Aug 2013 09:32:45 +0900
Subject: [R-sig-Geo] spConvert - lcc to longlat (unable to find the
 right coordinates after conversion)
In-Reply-To: <CAOAB+P2w7u5cuY0YYhN6CaQsLXzvj27mV6GdnrZTQyQW0xugXw@mail.gmail.com>
References: <CAOAB+P0A_riy=aKH0_uFGDd2e4-fCSOBb+XALh_MQN-6AWXzUg@mail.gmail.com>
	<CAAcyNCwPcMd9PcbhUUu2D=7BOic0DrDovJZ=-tTuQ8VDEni06A@mail.gmail.com>
	<CAOAB+P2w7u5cuY0YYhN6CaQsLXzvj27mV6GdnrZTQyQW0xugXw@mail.gmail.com>
Message-ID: <CAAcyNCwMH5f=wN1dJALaxF-uFnBcykPhgRVWPYpbCa1RhrYDZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130814/dcb218bc/attachment.pl>

From pauloeducardoso at gmail.com  Wed Aug 14 18:58:00 2013
From: pauloeducardoso at gmail.com (pecardoso)
Date: Wed, 14 Aug 2013 09:58:00 -0700 (PDT)
Subject: [R-sig-Geo] writeRaster and Landsat 8 OLI 16bit unsigned data
Message-ID: <1376499480707-7584417.post@n2.nabble.com>

I'm not being able to export Landsat8 (16bit: 0-65535) TIF to IDRISI .RST
files with writeRaster().

IDRISI (Taiga) fail to read .RST files resulting from writeRaster().

First thing, which may be a typing error from raster help, is that from
?dataType one can read that INT2U range is 0-65534 and "For all integer
types, except the single byte types, the lowest (signed) or highest
(unsigned) value is used to store NA".

Curiously for INT1U the range interval presented is ok (0-255).

Why INT2U range is not 0-65535?

I'm not sure if this is preventing writeRaster to assign the entire Landsat
range of values  (0-65535).

In the conversion process I'm getting the right dataType() for memory-stored
raster file: INT2U.

I'm then cropping each band to some extent and exporting it to RST with:

writeRaster(img.crop, filename = paste0(dir.rst, fname,'.rst'),
                format = 'IDRISI', overwrite = TRUE,
                datatype='INT2U',
                crs = proj.i, NAflag = 0)

Please let me know if I should add any further explanation.

Landsat 8 can be downloaded for free from http://earthexplorer.usgs.gov/ or
http://glovis.usgs.gov/

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=Portuguese_Portugal.1252  LC_CTYPE=Portuguese_Portugal.1252   
[3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C                        
[5] LC_TIME=Portuguese_Portugal.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11    

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15 tools_3.0.1 
Further detail about data: http://landsat.usgs.gov/tools_faq.php

Any help or comment will be appreciated.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/writeRaster-and-Landsat-8-OLI-16bit-unsigned-data-tp7584417.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From agg18 at pitt.edu  Wed Aug 14 20:23:41 2013
From: agg18 at pitt.edu (alannie)
Date: Wed, 14 Aug 2013 11:23:41 -0700 (PDT)
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp classes
Message-ID: <1376504621680-7584418.post@n2.nabble.com>

Hi folks!

I have been having significant difficulty using the sp classes to perform
the ENFA in R. 
The objective of this posting is to inquire about how to "prepare data for
the ENFA," which in previous versions of the software package adehabitat was
carried out via 'data2enfa' and the 'dudi.pca' functions.

I have been using the code:

#Add table of coordinate locations

>locs<-read.table("xybartsiifolia.csv", header=TRUE, sep=",") 

#Convert to class sp

>xy.sp = SpatialPoints(locs)

#Import .asc variable maps into R. 

>bio1<-read.asciigrid("bio1.asc", as.image = FALSE, plot.image = FALSE,
colname = basename("bio1.asc"), proj4string = CRS(as.character(NA)))
>bio2<-read.asciigrid("bio2.asc", as.image = FALSE, plot.image = FALSE,
colname = basename("bio2.asc"), proj4string = CRS(as.character(NA)))

#etc

#Combine data maps

>join<- cbind(bio1 at data, bio2 at data, bio3 at data, etc)

After the last bit, I cannot go forward. 

I need to somehow combine the 'join' data which contains variable maps with
the 'locs' data which has species location data so that I can get the
principle component analysis from function dudi.pca. 

In the documentation for package adehabitatHS it says:

## We prepare the data for the ENFA
tab <- slot(map, "data")
pr <- slot(count.points(locs, map), "data")[,1]

and then goes on to do the PCA and ENFA

I have already tried working through the example 'lynxjura' multiple times
and have no greater understanding of what comprises the data (noted as
"data" in the example) or how to utilize the slot function in my own data
set. 

I would like assistance to put my data in the format for the PCA and the
ENFA. 

Thanks in advance for all assistance. 

Alannie






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Using-the-ENFA-from-adehabitatHS-in-R-with-sp-classes-tp7584418.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From basille.web at ase-research.org  Wed Aug 14 20:53:10 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Wed, 14 Aug 2013 14:53:10 -0400
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp
	classes
In-Reply-To: <1376504621680-7584418.post@n2.nabble.com>
References: <1376504621680-7584418.post@n2.nabble.com>
Message-ID: <520BD216.9030803@ase-research.org>

Dear Alannie,

Obviously all these "data"s are confusing :)
The 'enfa' example uses a dataset call 'lynxjura' (not 'data'), which is a 
list with several elements. One of these elements is the maps, with the 
name 'map' (singular!). This is what you want to achieve. This is simply a 
SpatialPixelsDataFrame, but as far as I can tell, a SpatialGridDataFrame 
will do too (if you want to know more about the differences between these 
two, check the sp vignette).

So, following your example, just replace "map" by "join", and it should 
work. The 'slot(map, "data")' line extracts the data frame storing the data 
of the map, since the dudi.pca and enfa functions do not directly need the 
spatial attributes.

Hope this helps,
Mathieu.


Le 08/14/2013 02:23 PM, alannie a ?crit :
> Hi folks!
>
> I have been having significant difficulty using the sp classes to perform
> the ENFA in R.
> The objective of this posting is to inquire about how to "prepare data for
> the ENFA," which in previous versions of the software package adehabitat was
> carried out via 'data2enfa' and the 'dudi.pca' functions.
>
> I have been using the code:
>
> #Add table of coordinate locations
>
>> locs<-read.table("xybartsiifolia.csv", header=TRUE, sep=",")
>
> #Convert to class sp
>
>> xy.sp = SpatialPoints(locs)
>
> #Import .asc variable maps into R.
>
>> bio1<-read.asciigrid("bio1.asc", as.image = FALSE, plot.image = FALSE,
> colname = basename("bio1.asc"), proj4string = CRS(as.character(NA)))
>> bio2<-read.asciigrid("bio2.asc", as.image = FALSE, plot.image = FALSE,
> colname = basename("bio2.asc"), proj4string = CRS(as.character(NA)))
>
> #etc
>
> #Combine data maps
>
>> join<- cbind(bio1 at data, bio2 at data, bio3 at data, etc)
>
> After the last bit, I cannot go forward.
>
> I need to somehow combine the 'join' data which contains variable maps with
> the 'locs' data which has species location data so that I can get the
> principle component analysis from function dudi.pca.
>
> In the documentation for package adehabitatHS it says:
>
> ## We prepare the data for the ENFA
> tab <- slot(map, "data")
> pr <- slot(count.points(locs, map), "data")[,1]
>
> and then goes on to do the PCA and ENFA
>
> I have already tried working through the example 'lynxjura' multiple times
> and have no greater understanding of what comprises the data (noted as
> "data" in the example) or how to utilize the slot function in my own data
> set.
>
> I would like assistance to put my data in the format for the PCA and the
> ENFA.
>
> Thanks in advance for all assistance.
>
> Alannie
>
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Using-the-ENFA-from-adehabitatHS-in-R-with-sp-classes-tp7584418.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From AGG18 at pitt.edu  Wed Aug 14 21:37:45 2013
From: AGG18 at pitt.edu (AGG18 at pitt.edu)
Date: Wed, 14 Aug 2013 15:37:45 -0400
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp
	classes
In-Reply-To: <520BD216.9030803@ase-research.org>
References: <1376504621680-7584418.post@n2.nabble.com>
	<520BD216.9030803@ase-research.org>
Message-ID: <79aa90529d9b318ce30e831cbf16c845.squirrel@webmail.pitt.edu>

Dear Mathieu,

Thank you for the assistance.

Upon executing the situation where I take the material of 'join' to
replace 'map' I receive an error:

> join<- cbind(bio1 at data, bio2 at data, bio3 at data, bio4 at data, bio5 at data,
bio6 at data, bio7 at data)
> tab <- slot(join, "data")
Error in slot(join, "data") :
  no slot of name "data" for this object of class "data.frame"

the description of what is compiled in the maps contain in 'join' are:

>head(join)
  bio1.asc bio2.asc bio3.asc bio4.asc bio5.asc bio6.asc bio7.asc
1       NA       NA       NA       NA       NA       NA       NA
2       NA       NA       NA       NA       NA       NA       NA
3       NA       NA       NA       NA       NA       NA       NA
4       NA       NA       NA       NA       NA       NA       NA
5       NA       NA       NA       NA       NA       NA       NA
6       NA       NA       NA       NA       NA       NA       NA
> class(join)
[1] "data.frame"


Do I need to create a slot or name an element 'data?'

Please advise further.

Cheers,
Alannie

> Dear Alannie,
>
> Obviously all these "data"s are confusing :)
> The 'enfa' example uses a dataset call 'lynxjura' (not 'data'), which is a
> list with several elements. One of these elements is the maps, with the
> name 'map' (singular!). This is what you want to achieve. This is simply a
> SpatialPixelsDataFrame, but as far as I can tell, a SpatialGridDataFrame
> will do too (if you want to know more about the differences between these
> two, check the sp vignette).
>
> So, following your example, just replace "map" by "join", and it should
> work. The 'slot(map, "data")' line extracts the data frame storing the
> data
> of the map, since the dudi.pca and enfa functions do not directly need the
> spatial attributes.
>
> Hope this helps,
> Mathieu.
>
>
> Le 08/14/2013 02:23 PM, alannie a ?crit :
>> Hi folks!
>>
>> I have been having significant difficulty using the sp classes to
>> perform
>> the ENFA in R.
>> The objective of this posting is to inquire about how to "prepare data
>> for
>> the ENFA," which in previous versions of the software package adehabitat
>> was
>> carried out via 'data2enfa' and the 'dudi.pca' functions.
>>
>> I have been using the code:
>>
>> #Add table of coordinate locations
>>
>>> locs<-read.table("xybartsiifolia.csv", header=TRUE, sep=",")
>>
>> #Convert to class sp
>>
>>> xy.sp = SpatialPoints(locs)
>>
>> #Import .asc variable maps into R.
>>
>>> bio1<-read.asciigrid("bio1.asc", as.image = FALSE, plot.image = FALSE,
>> colname = basename("bio1.asc"), proj4string = CRS(as.character(NA)))
>>> bio2<-read.asciigrid("bio2.asc", as.image = FALSE, plot.image = FALSE,
>> colname = basename("bi


From basille.web at ase-research.org  Wed Aug 14 22:01:13 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Wed, 14 Aug 2013 16:01:13 -0400
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp
	classes
In-Reply-To: <79aa90529d9b318ce30e831cbf16c845.squirrel@webmail.pitt.edu>
References: <1376504621680-7584418.post@n2.nabble.com>
	<520BD216.9030803@ase-research.org>
	<79aa90529d9b318ce30e831cbf16c845.squirrel@webmail.pitt.edu>
Message-ID: <520BE209.8090100@ase-research.org>

Sorry I didn't spot that one before... Please try:

join<- cbind(bio1, bio2, bio3, bio4, bio5, bio6, bio7)

and check the class and data:

summary(join)

You want this to be of class SpatialGridDataFrame (or 
SpatialPixelsDataFrame), so you want to keep the spatial attributes 
together with the data that comes with it.

Also note that, given a Spatial*DataFrame, 'xx at data' is equivalent to 
'slot(xx, "data")'.

Hope this helps,
Mathieu.


Le 08/14/2013 03:37 PM, AGG18 at pitt.edu a ?crit :
> Dear Mathieu,
>
> Thank you for the assistance.
>
> Upon executing the situation where I take the material of 'join' to
> replace 'map' I receive an error:
>
>> join<- cbind(bio1 at data, bio2 at data, bio3 at data, bio4 at data, bio5 at data,
> bio6 at data, bio7 at data)
>> tab <- slot(join, "data")
> Error in slot(join, "data") :
>    no slot of name "data" for this object of class "data.frame"
>
> the description of what is compiled in the maps contain in 'join' are:
>
>> head(join)
>    bio1.asc bio2.asc bio3.asc bio4.asc bio5.asc bio6.asc bio7.asc
> 1       NA       NA       NA       NA       NA       NA       NA
> 2       NA       NA       NA       NA       NA       NA       NA
> 3       NA       NA       NA       NA       NA       NA       NA
> 4       NA       NA       NA       NA       NA       NA       NA
> 5       NA       NA       NA       NA       NA       NA       NA
> 6       NA       NA       NA       NA       NA       NA       NA
>> class(join)
> [1] "data.frame"
>
>
> Do I need to create a slot or name an element 'data?'
>
> Please advise further.
>
> Cheers,
> Alannie
>
>> Dear Alannie,
>>
>> Obviously all these "data"s are confusing :)
>> The 'enfa' example uses a dataset call 'lynxjura' (not 'data'), which is a
>> list with several elements. One of these elements is the maps, with the
>> name 'map' (singular!). This is what you want to achieve. This is simply a
>> SpatialPixelsDataFrame, but as far as I can tell, a SpatialGridDataFrame
>> will do too (if you want to know more about the differences between these
>> two, check the sp vignette).
>>
>> So, following your example, just replace "map" by "join", and it should
>> work. The 'slot(map, "data")' line extracts the data frame storing the
>> data
>> of the map, since the dudi.pca and enfa functions do not directly need the
>> spatial attributes.
>>
>> Hope this helps,
>> Mathieu.
>>
>>
>> Le 08/14/2013 02:23 PM, alannie a ?crit :
>>> Hi folks!
>>>
>>> I have been having significant difficulty using the sp classes to
>>> perform
>>> the ENFA in R.
>>> The objective of this posting is to inquire about how to "prepare data
>>> for
>>> the ENFA," which in previous versions of the software package adehabitat
>>> was
>>> carried out via 'data2enfa' and the 'dudi.pca' functions.
>>>
>>> I have been using the code:
>>>
>>> #Add table of coordinate locations
>>>
>>>> locs<-read.table("xybartsiifolia.csv", header=TRUE, sep=",")
>>>
>>> #Convert to class sp
>>>
>>>> xy.sp = SpatialPoints(locs)
>>>
>>> #Import .asc variable maps into R.
>>>
>>>> bio1<-read.asciigrid("bio1.asc", as.image = FALSE, plot.image = FALSE,
>>> colname = basename("bio1.asc"), proj4string = CRS(as.character(NA)))
>>>> bio2<-read.asciigrid("bio2.asc", as.image = FALSE, plot.image = FALSE,
>>> colname = basename("bi
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From agg18 at pitt.edu  Wed Aug 14 22:46:33 2013
From: agg18 at pitt.edu (alannie)
Date: Wed, 14 Aug 2013 13:46:33 -0700 (PDT)
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp
	classes
In-Reply-To: <520BE209.8090100@ase-research.org>
References: <1376504621680-7584418.post@n2.nabble.com>
	<520BD216.9030803@ase-research.org>
	<79aa90529d9b318ce30e831cbf16c845.squirrel@webmail.pitt.edu>
	<520BE209.8090100@ase-research.org>
Message-ID: <1376513193220-7584422.post@n2.nabble.com>

Dear Mathieu,

The join/cbind/@data is wonderful!

However, if I try to join the location data as a data.frame or sp class it
does not work.

What would be the solution to this portion of the equation?

In other words, how to I add locations to the formula?


Thank you a million * ? !


Alannie




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Using-the-ENFA-from-adehabitatHS-in-R-with-sp-classes-tp7584418p7584422.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From basille.web at ase-research.org  Wed Aug 14 23:33:03 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Wed, 14 Aug 2013 17:33:03 -0400
Subject: [R-sig-Geo] Using the ENFA from adehabitatHS in R with sp
	classes
In-Reply-To: <1376513193220-7584422.post@n2.nabble.com>
References: <1376504621680-7584418.post@n2.nabble.com>
	<520BD216.9030803@ase-research.org>
	<79aa90529d9b318ce30e831cbf16c845.squirrel@webmail.pitt.edu>
	<520BE209.8090100@ase-research.org>
	<1376513193220-7584422.post@n2.nabble.com>
Message-ID: <520BF78F.9090808@ase-research.org>

Not sure where your problem is. If you have the SpatialPixelsDataFrame and 
the SpatialPoints, did you try to go on like in the example?

tab <- slot(map, "data")
pr <- slot(count.points(locs, map), "data")[,1]
pc <- dudi.pca(tab, scannf = FALSE)
(enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))

etc., etc.

Mathieu.


Le 08/14/2013 04:46 PM, alannie a ?crit :
> Dear Mathieu,
>
> The join/cbind/@data is wonderful!
>
> However, if I try to join the location data as a data.frame or sp class it
> does not work.
>
> What would be the solution to this portion of the equation?
>
> In other words, how to I add locations to the formula?
>
>
> Thank you a million * ? !
>
>
> Alannie
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Using-the-ENFA-from-adehabitatHS-in-R-with-sp-classes-tp7584418p7584422.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From dominic.roye at usc.es  Thu Aug 15 00:12:28 2013
From: dominic.roye at usc.es (Dominic Roye)
Date: Thu, 15 Aug 2013 00:12:28 +0200
Subject: [R-sig-Geo] Fwd: Thin-plate splines question
In-Reply-To: <CALvVS-EdVMTob=o4TYiO+AMzLZFbKbJSvRYkFM6kKg0uYCrq9Q@mail.gmail.com>
References: <CALvVS-EdVMTob=o4TYiO+AMzLZFbKbJSvRYkFM6kKg0uYCrq9Q@mail.gmail.com>
Message-ID: <CALvVS-GYion+HCBt4GKzdUHqzHERdfx8X+Se=BVOUw=sqfPaKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130815/ec9f12c8/attachment.pl>

From kridox at ymail.com  Thu Aug 15 03:32:26 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Thu, 15 Aug 2013 10:32:26 +0900
Subject: [R-sig-Geo] Fwd: Thin-plate splines question
In-Reply-To: <CALvVS-GYion+HCBt4GKzdUHqzHERdfx8X+Se=BVOUw=sqfPaKQ@mail.gmail.com>
References: <CALvVS-EdVMTob=o4TYiO+AMzLZFbKbJSvRYkFM6kKg0uYCrq9Q@mail.gmail.com>
	<CALvVS-GYion+HCBt4GKzdUHqzHERdfx8X+Se=BVOUw=sqfPaKQ@mail.gmail.com>
Message-ID: <CAAcyNCyGoG4WAGZkK-EyBRctgO6XkSr0Mf9jTiETQ5SRfNZDEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130815/7fdc7b97/attachment.pl>

From HodgessE at uhd.edu  Thu Aug 15 03:33:32 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 15 Aug 2013 01:33:32 +0000
Subject: [R-sig-Geo] out-of-bounds error
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A494A5@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130815/cbd27ded/attachment.pl>

From mdsumner at gmail.com  Thu Aug 15 15:21:00 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 15 Aug 2013 23:21:00 +1000
Subject: [R-sig-Geo] Problem with raster package and netcdf file
In-Reply-To: <CAAcGz9_zq7PtVWowZbWV7RdtDPpAy09d9cZYAmjX6E6rHfwNYA@mail.gmail.com>
References: <57081.82.134.28.207.1362737889.squirrel@www.hafro.is>
	<CAAcGz98=zBgEvoQy7FvWNp3KzQnTJoZFcEvwvaV6nWdMD-tv7g@mail.gmail.com>
	<CAAcGz9_zq7PtVWowZbWV7RdtDPpAy09d9cZYAmjX6E6rHfwNYA@mail.gmail.com>
Message-ID: <CAAcGz9_E=ivrPLgb+1uG9vOOYDd4o=ejK-qsA3ORiiivD5PqKg@mail.gmail.com>

FWIW, this should now work out of the box with the release of
ncdf4_1.10, and previous updates in raster long ago.

## (as attempted by OP)
bat <- raster(file="gebco_08_-82_37_63_80",varname="z")

I'll check it when I have a chance to build the package, but any other
verification would be nice.

Cheers, Mike.

On Thu, Mar 14, 2013 at 10:11 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> This should now work if you upgrade to raster_2.1-12.
>
> It will still use as much memory as is contained in the file, just to open
> it deep inside the raster() handling of the connection - but it's not
> permanent and if you can get past this step, try running gc() and it should
> settle down (I'm on Windows with ncdf_1.6.6):
>
> library(raster) ## 2.1-12 or greater
> bat <- raster(file="gebco_08_-82_37_63_80")
>
> gc()
>
> (I've only tested on gebco_08.nc, the original large file itself). Do not
> set varname = "z", it should choose that anyway.
>
> I'm hoping that a change in ncdf4 will be published to avoid the memory
> consumption, but I need to put the case for change in ncdf, ncdf4 and raster
> which potentially involves 3 separate package maintainers. They have each
> been very patient with me so far.
>
> If you want to shortcut to a solution, just use gdal_translate from OSGeo4W,
> and write to GeoTIFF with (optionally) lossless compression and tiling:
>
> gdal_translate gebco_08_-82_37_63_80 gebco_08_-82_37_63_80.tif -co
> COMPRESS=LZW -co TILED=YES
>
> BTW, It's a strange coincidence that this was asked this week just when I
> was investigating why it did not already work!  The GDAL workaround is good,
> but raster/ncdf/4 is a very nice general fix.
>
> And, for what it is worth - GDAL has long supported this NetCDF variant, so
> a build of rgdal with the GMT driver  should work well too with the extra
> caveats of subsetting with readGDAL() or via a GDALMajorObject. (CRAN's
> Windows rgdal does not have GMT)
>
> Cheers, Mike.
>
>
>
>
>
> On Sat, Mar 9, 2013 at 3:24 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>>
>> The raster package isn't able to read the data from this "GMT-style"
>> NetCDF, since the structure of the variable is one-dimensional internally
>> and you are supposed to deal with that yourself. I would stick with the
>> ncdf4 package to read it, you'll have to scan into the "z" variable manually
>> to reconstruct it as a matrix, or subset it.
>>
>> Note that you should have a large object size with "d", since the nc_open
>> function returns an index vector for each dimension (so one of them is
>> length 89784000, you must have sufficient memory to deal with that - I would
>> close/delete the "d" object once you read the "z", "dimension" and other
>> values).
>>
>> I have code to read from these files, but I can't access it today - it's
>> not that difficult though, you can probably do something like matrix(z,
>> dimension[1], dimension[2]) but you'll have to fiddle to get the orientation
>> right.
>>
>>
>>
>>
>> On Fri, Mar 8, 2013 at 9:18 PM, Julian Burgos <julian at hafro.is> wrote:
>>>
>>> Dear list,
>>>
>>> I am having some troubles opening accessing a raster in the netCDF
>>> format.
>>>  The file is bathimetric data from GEBCO:
>>> http://www.gebco.net/data_and_products/gridded_bathymetry_data/
>>>
>>> If I use the ncdf4 package to open and access the data, I have no issues:
>>>
>>> library(ncdf4)
>>> > d <- nc_open("gebco_08_-82_37_63_80.nc")
>>> > z <- as.vector(ncvar_get(d,varid="z"))
>>> > head(z)
>>> [1] 19 40 61 83 106 128
>>>
>>>
>>> But if I try to use the raster package to access the file and create a
>>> raster object, I get the following error:
>>>
>>> bat <- raster(file="gebco_08_-82_37_63_80",varname="z")
>>> Error in .varName(nc, varname, warn = warn) :
>>>   varname: z does not exist in the file. Select one from:
>>>
>>> ... and no varnames are listed.
>>>
>>>
>>> If I do not define a variable name and let the raster package choose it,
>>> I
>>> get this:
>>>
>>> > bat <- raster(file="gebco_08_-82_37_63_80",varname="z")
>>> Error in .varName(nc, varname, warn = warn) :
>>>
>>> The description of the netCDF file is as following:
>>>
>>> > d
>>> [1] "File gebco_08_-82_37_63_80.nc (NC_FORMAT_CLASSIC):"
>>> [1] ""
>>> [1] "     6 variables:"
>>> [1] "        double x_range[side]   "
>>> [1] "            units: user_x_unit"
>>> [1] "        double y_range[side]   "
>>> [1] "            units: user_y_unit"
>>> [1] "        short z_range[side]   "
>>> [1] "            units: user_z_unit"
>>> [1] "        double spacing[side]   "
>>> [1] "        int dimension[side]   "
>>> [1] "        short z[xysize]   "
>>> [1] "            scale_factor: 1"
>>> [1] "            add_offset: 0"
>>> [1] "            node_offset: 1"
>>> [1] ""
>>> [1] "     2 dimensions:"
>>> [1] "        side  Size:2"
>>> [1] "        xysize  Size:89784000"
>>> [1] ""
>>> [1] "    2 global attributes:"
>>> [1] "        title: GEBCO_08 Grid"
>>> [1] "        source: 20100927"
>>>
>>> I am using R 15.2 on Linux (Fedora), raster 2.1-8, and ncdf4 version
>>> ncdf4_1.6.1_20120411.
>>> Any help will be welcomed!
>>>
>>> Julian
>>>
>>> --
>>> Julian Mariano Burgos, PhD
>>> Hafranns?knastofnunin/Marine Research Institute
>>> Sk?lagata 4, 121 Reykjav?k, Iceland
>>> S?mi/Telephone : +354-5752037
>>> Br?fs?mi/Telefax:  +354-5752001
>>> Netfang/Email: julian at hafro.is
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>> --
>> Michael Sumner
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>
>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From jon.skoien at jrc.ec.europa.eu  Fri Aug 16 15:22:58 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Fri, 16 Aug 2013 15:22:58 +0200
Subject: [R-sig-Geo] optimize idw power
In-Reply-To: <CAHYDKLYsoLnYRnVS5epyuPEd0UCdSP=CE964uYghm=Gt1mT9bw@mail.gmail.com>
References: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
	<CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>
	<520A36EA.7020608@jrc.ec.europa.eu>
	<CAHYDKLYsoLnYRnVS5epyuPEd0UCdSP=CE964uYghm=Gt1mT9bw@mail.gmail.com>
Message-ID: <520E27B2.4010304@jrc.ec.europa.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130816/2c7dfb5f/attachment.pl>

From reyesfrance at gmail.com  Fri Aug 16 19:03:19 2013
From: reyesfrance at gmail.com (francescor)
Date: Fri, 16 Aug 2013 10:03:19 -0700 (PDT)
Subject: [R-sig-Geo] Error in use Gaussian Filter with rsaga.geoprocessor:
 "Gaussian Filter: could not initialize data objects"... had status 1
Message-ID: <1376672599372-7584430.post@n2.nabble.com>

R studio, Version 0.97.551 
SAGA from saga_2.1.0_win32.zip 
Windows 7 Profesional, Service Pack 1, 64-bit Operating System 
Privileges: "C:\\Program Files (x86)\\SAGA-GIS" requires administrator's
privileges, so I copied SAGA in that folder as administrator, but used R
from another user account. 


#Dear all, 
#I cannot make rsaga.geoprocessor working to use other functions such as
gaussian filter, watershed #segmentation or hillshade. 
#Did anybody encountered and solved this kind of problem? 
#Thank you for reading, and maybe answering! 

#For example when I run the following lines: 

#Set SAGA Working Directory 
rsaga.env(workspace=initialdata, 
          path= "C:\\Program Files (x86)\\SAGA-GIS",           
          modules="C:\\Program Files (x86)\\SAGA-GIS\\modules",           
          check.libpath=TRUE) 

#Gaussian Filter 
rsaga.geoprocessor("grid_filter", module = 1, 
                   param = list(INPUT= "C:\\Program Files
(x86)\\SAGA-GIS\\max_image_r0.25.sdat", 
                                RESULT=
"C:\\Users\\reyesf\\Desktop\\Trial_with_R_calling_saga", 
                                SIGMA=2 , MODE=1, RADIUS=3)) 


#after the following 16 lines that look fine 
#R gives me the error "Gaussian Filter: could not ...."(see below) 


library path:	C:\PROGRA~2\SAGA-GIS\modules\grid_filter.dll 
library name:	Grid - Filter 
module name :	Gaussian Filter 
author      :	Copyrights (c) 2003 by Andre Ringeler 
Parameters 
Grids: No objects 
Files: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat 
Transformation: yes 
Interpolation: B-Spline Interpolation 

loading: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat 
Driver: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat/ 
Cells: x 448, y 440 
Bands: 1 
Transformation x' = 676735.000000 + x * 0.250000 + y * 0.000000 
Transformation y' = 5091759.990000 + x * 0.000000 + y * -0.250000 
loading band [1/1] 

Gaussian Filter: could not initialize data objects 
Error: executing module [Gaussian Filter] 
Warning message: 
running command '"C:/Program Files (x86)/SAGA-GIS/saga_cmd.exe" -f=q
grid_filter 1 -INPUT "C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat"
-RESULT "C:\Users\reyesf\Desktop\Trial_with_R_calling_saga" -SIGMA "2" -MODE
"1" -RADIUS "3"' had status 1



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-use-Gaussian-Filter-with-rsaga-geoprocessor-Gaussian-Filter-could-not-initialize-data-objec1-tp7584430.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From asidimohamed at yahoo.com  Sat Aug 17 10:50:50 2013
From: asidimohamed at yahoo.com (asidimohamed)
Date: Sat, 17 Aug 2013 09:50:50 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 114, Issue 7
Message-ID: <40349.46213.bm@smtp233.mail.bf1.yahoo.com>



 

-----Original Message-----
From: r-sig-geo-request at r-project.org
Sent: jeudi 7 f?vrier 2013 11:00
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 114, Issue 7

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. spGRASS6 issue (R.S. Bhalla)
   2. Re: spplot specifying printing character (pch) broken?
      (Edzer Pebesma)
   3. spatial regression for binary/dichotomous depend	variable
      (Tanja Zin?er)
   4. Re: spGRASS6 issue (Roger Bivand)
   5. Re: spGRASS6 issue (Rainer M Krug)
   6. Compare two raster using Raster Library in code saving	style
      (gianni lavaredo)
   7. Re: Compare two raster using Raster Library in code	saving
      style (Wilfried Thuiller)
   8. Re: Compare two raster using Raster Library in code saving
      style (Julian Zeidler)
   9. Re: spatial regression for binary/dichotomous depend	variable
      (Milan Sharma)
  10. Re: Log-normal block krige (Jon Olav Skoien)
  11. Re: spatial regression for binary/dichotomous depend	variable
      (Juan Tomas Sayago Gomez)
  12. Re: spatial regression for binary/dichotomous depend variable
      (Andrew Finley)
  13. (no subject) (Adrian.Baddeley at csiro.au)
  14. Re: spGRASS6 issue (R.S. Bhalla)
  15. Not able to write shp file (vikram ranga)
  16. Re: spGRASS6 issue (R.S. Bhalla)
  17. Re: converting 0 to NAN in SpatialGridDataFrame (Wesley Roberts)
  18. R crashes when looping with function writeRaster (Romolo Salini)
  19. Re: spGRASS6 issue (Rainer M Krug)
  20. MADIFA results (Michela Giusti)
  21. Re: spGRASS6 issue (Roger Bivand)
  22. i want to extract a zip file using r (Kanwal Nayan)


----------------------------------------------------------------------

Message: 1
Date: Wed, 06 Feb 2013 16:48:57 +0530
From: 

[The entire original message is not included]

From asidimohamed at yahoo.com  Sat Aug 17 10:50:52 2013
From: asidimohamed at yahoo.com (asidimohamed)
Date: Sat, 17 Aug 2013 09:50:52 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 114, Issue 7
Message-ID: <369648.46213.bm@smtp233.mail.bf1.yahoo.com>



 

-----Original Message-----
From: r-sig-geo-request at r-project.org
Sent: jeudi 7 f?vrier 2013 11:00
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 114, Issue 7

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. spGRASS6 issue (R.S. Bhalla)
   2. Re: spplot specifying printing character (pch) broken?
      (Edzer Pebesma)
   3. spatial regression for binary/dichotomous depend	variable
      (Tanja Zin?er)
   4. Re: spGRASS6 issue (Roger Bivand)
   5. Re: spGRASS6 issue (Rainer M Krug)
   6. Compare two raster using Raster Library in code saving	style
      (gianni lavaredo)
   7. Re: Compare two raster using Raster Library in code	saving
      style (Wilfried Thuiller)
   8. Re: Compare two raster using Raster Library in code saving
      style (Julian Zeidler)
   9. Re: spatial regression for binary/dichotomous depend	variable
      (Milan Sharma)
  10. Re: Log-normal block krige (Jon Olav Skoien)
  11. Re: spatial regression for binary/dichotomous depend	variable
      (Juan Tomas Sayago Gomez)
  12. Re: spatial regression for binary/dichotomous depend variable
      (Andrew Finley)
  13. (no subject) (Adrian.Baddeley at csiro.au)
  14. Re: spGRASS6 issue (R.S. Bhalla)
  15. Not able to write shp file (vikram ranga)
  16. Re: spGRASS6 issue (R.S. Bhalla)
  17. Re: converting 0 to NAN in SpatialGridDataFrame (Wesley Roberts)
  18. R crashes when looping with function writeRaster (Romolo Salini)
  19. Re: spGRASS6 issue (Rainer M Krug)
  20. MADIFA results (Michela Giusti)
  21. Re: spGRASS6 issue (Roger Bivand)
  22. i want to extract a zip file using r (Kanwal Nayan)


----------------------------------------------------------------------

Message: 1
Date: Wed, 06 Feb 2013 16:48:57 +0530
From: 

[The entire original message is not included]

From asidimohamed at yahoo.com  Sat Aug 17 10:50:54 2013
From: asidimohamed at yahoo.com (asidimohamed)
Date: Sat, 17 Aug 2013 09:50:54 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 114, Issue 7
Message-ID: <500139.46213.bm@smtp233.mail.bf1.yahoo.com>



 

-----Original Message-----
From: r-sig-geo-request at r-project.org
Sent: jeudi 7 f?vrier 2013 11:00
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 114, Issue 7

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. spGRASS6 issue (R.S. Bhalla)
   2. Re: spplot specifying printing character (pch) broken?
      (Edzer Pebesma)
   3. spatial regression for binary/dichotomous depend	variable
      (Tanja Zin?er)
   4. Re: spGRASS6 issue (Roger Bivand)
   5. Re: spGRASS6 issue (Rainer M Krug)
   6. Compare two raster using Raster Library in code saving	style
      (gianni lavaredo)
   7. Re: Compare two raster using Raster Library in code	saving
      style (Wilfried Thuiller)
   8. Re: Compare two raster using Raster Library in code saving
      style (Julian Zeidler)
   9. Re: spatial regression for binary/dichotomous depend	variable
      (Milan Sharma)
  10. Re: Log-normal block krige (Jon Olav Skoien)
  11. Re: spatial regression for binary/dichotomous depend	variable
      (Juan Tomas Sayago Gomez)
  12. Re: spatial regression for binary/dichotomous depend variable
      (Andrew Finley)
  13. (no subject) (Adrian.Baddeley at csiro.au)
  14. Re: spGRASS6 issue (R.S. Bhalla)
  15. Not able to write shp file (vikram ranga)
  16. Re: spGRASS6 issue (R.S. Bhalla)
  17. Re: converting 0 to NAN in SpatialGridDataFrame (Wesley Roberts)
  18. R crashes when looping with function writeRaster (Romolo Salini)
  19. Re: spGRASS6 issue (Rainer M Krug)
  20. MADIFA results (Michela Giusti)
  21. Re: spGRASS6 issue (Roger Bivand)
  22. i want to extract a zip file using r (Kanwal Nayan)


----------------------------------------------------------------------

Message: 1
Date: Wed, 06 Feb 2013 16:48:57 +0530
From: 

[The entire original message is not included]

From alexander.brenning at uwaterloo.ca  Sat Aug 17 13:05:51 2013
From: alexander.brenning at uwaterloo.ca (Alexander Brenning)
Date: Sat, 17 Aug 2013 11:05:51 +0000
Subject: [R-sig-Geo] Error in use Gaussian Filter with
 rsaga.geoprocessor: "Gaussian Filter: could not initialize data objects"...
 had status 1
Message-ID: <7751194102F32C41B664258D78FE5BC571C3B31B@connmbx1>

Hi Francesco,

just a quick reaction while I'm heading out for a few days: I haven't seem this type of error before, and the module normally works well with RSAGA, so I suspect that this is a problem with SAGA GIS dealing with your data. May I suggest that you post this on one of the SAGA GIS discussion boards on sourcefourge ( http://sourceforge.net/p/saga-gis/discussion/ ) indicating also your SAGA GIS version and attaching your raster file (or a smaller test file that causes the same error) to that post if possible. I can have a look at it myself in a week from now if it hasn't been resolved by then.

Cheers
  Alex


Date: Fri, 16 Aug 2013 10:03:19 -0700 (PDT)
From: francescor <reyesfrance at gmail.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Error in use Gaussian Filter with
        rsaga.geoprocessor: "Gaussian Filter: could not initialize data
        objects"... had status 1
Message-ID: <1376672599372-7584430.post at n2.nabble.com>
Content-Type: text/plain; charset=us-ascii

R studio, Version 0.97.551
SAGA from saga_2.1.0_win32.zip
Windows 7 Profesional, Service Pack 1, 64-bit Operating System
Privileges: "C:\\Program Files (x86)\\SAGA-GIS" requires administrator's
privileges, so I copied SAGA in that folder as administrator, but used R
from another user account.


#Dear all,
#I cannot make rsaga.geoprocessor working to use other functions such as
gaussian filter, watershed #segmentation or hillshade.
#Did anybody encountered and solved this kind of problem?
#Thank you for reading, and maybe answering!

#For example when I run the following lines:

#Set SAGA Working Directory
rsaga.env(workspace=initialdata,
          path= "C:\\Program Files (x86)\\SAGA-GIS",
          modules="C:\\Program Files (x86)\\SAGA-GIS\\modules",
          check.libpath=TRUE)

#Gaussian Filter
rsaga.geoprocessor("grid_filter", module = 1,
                   param = list(INPUT= "C:\\Program Files
(x86)\\SAGA-GIS\\max_image_r0.25.sdat",
                                RESULT=
"C:\\Users\\reyesf\\Desktop\\Trial_with_R_calling_saga",
                                SIGMA=2 , MODE=1, RADIUS=3))


#after the following 16 lines that look fine
#R gives me the error "Gaussian Filter: could not ...."(see below)


library path:   C:\PROGRA~2\SAGA-GIS\modules\grid_filter.dll
library name:   Grid - Filter
module name :   Gaussian Filter
author      :   Copyrights (c) 2003 by Andre Ringeler
Parameters
Grids: No objects
Files: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat
Transformation: yes
Interpolation: B-Spline Interpolation

loading: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat
Driver: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat/
Cells: x 448, y 440
Bands: 1
Transformation x' = 676735.000000 + x * 0.250000 + y * 0.000000
Transformation y' = 5091759.990000 + x * 0.000000 + y * -0.250000
loading band [1/1]

Gaussian Filter: could not initialize data objects
Error: executing module [Gaussian Filter]
Warning message:
running command '"C:/Program Files (x86)/SAGA-GIS/saga_cmd.exe" -f=q
grid_filter 1 -INPUT "C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat"
-RESULT "C:\Users\reyesf\Desktop\Trial_with_R_calling_saga" -SIGMA "2" -MODE
"1" -RADIUS "3"' had status 1


From saramartino at yahoo.com  Sat Aug 17 22:20:33 2013
From: saramartino at yahoo.com (sara martino)
Date: Sat, 17 Aug 2013 13:20:33 -0700 (PDT)
Subject: [R-sig-Geo] Problems wirh R 3.0.1 and maptools
Message-ID: <1376770833.46709.YahooMailNeo@web140904.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130817/8bc150a7/attachment.pl>

From lee.hachadoorian at gmail.com  Sat Aug 17 23:34:34 2013
From: lee.hachadoorian at gmail.com (Lee Hachadoorian)
Date: Sat, 17 Aug 2013 17:34:34 -0400
Subject: [R-sig-Geo] Problems wirh R 3.0.1 and maptools
In-Reply-To: <1376770833.46709.YahooMailNeo@web140904.mail.bf1.yahoo.com>
References: <1376770833.46709.YahooMailNeo@web140904.mail.bf1.yahoo.com>
Message-ID: <CANnCtnJraYB4P4rYzB1uA7kXBbH157sNzwqp0JK5JrocsKEogg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130817/0fa15396/attachment.pl>

From dominic.roye at gmail.com  Sun Aug 18 15:50:16 2013
From: dominic.roye at gmail.com (Dominic Roye)
Date: Sun, 18 Aug 2013 15:50:16 +0200
Subject: [R-sig-Geo] Thin-plate splines question
Message-ID: <CALvVS-H1pMrp_S7kjALKiqiiCPum7nYKbJZwFpwinNmpc44vXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130818/72cc9cd0/attachment.pl>

From lee.hachadoorian at gmail.com  Mon Aug 19 01:05:16 2013
From: lee.hachadoorian at gmail.com (Lee Hachadoorian)
Date: Sun, 18 Aug 2013 19:05:16 -0400
Subject: [R-sig-Geo] Problems wirh R 3.0.1 and maptools
In-Reply-To: <1376815755.65672.YahooMailNeo@web140904.mail.bf1.yahoo.com>
References: <1376770833.46709.YahooMailNeo@web140904.mail.bf1.yahoo.com>
	<CANnCtnJraYB4P4rYzB1uA7kXBbH157sNzwqp0JK5JrocsKEogg@mail.gmail.com>
	<1376815755.65672.YahooMailNeo@web140904.mail.bf1.yahoo.com>
Message-ID: <5211532C.10908@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130818/3ed8bf29/attachment.html>

From Dominik.Schneider at colorado.edu  Mon Aug 19 04:04:56 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Sun, 18 Aug 2013 20:04:56 -0600
Subject: [R-sig-Geo] optimize idw power
In-Reply-To: <520E27B2.4010304@jrc.ec.europa.eu>
References: <CAHYDKLajX8fYSX0YGGCL1GxSi08-_s3AdzZsTK9faFZgk6akOA@mail.gmail.com>
	<CAGxgkWg+-GMQM3igfAj1-q4oZLpeZQr_F+iaWA5ezStmX8ofmw@mail.gmail.com>
	<520A36EA.7020608@jrc.ec.europa.eu>
	<CAHYDKLYsoLnYRnVS5epyuPEd0UCdSP=CE964uYghm=Gt1mT9bw@mail.gmail.com>
	<520E27B2.4010304@jrc.ec.europa.eu>
Message-ID: <CAHYDKLYEYtcVP1Z7_DGUGFW4agnhPS69dUN=rVD8nNmH7xR1=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130818/5e0b210f/attachment.pl>

From zdziarze at scss.tcd.ie  Mon Aug 19 20:02:10 2013
From: zdziarze at scss.tcd.ie (zdziarze)
Date: Mon, 19 Aug 2013 19:02:10 +0100
Subject: [R-sig-Geo] krigeST in gstat
Message-ID: <9ad546b61fe278df8e3307222fb50a74@scss.tcd.ie>

Hello,

Apologies for making this request for assistance but I'm new to R let 
alone the gstat package and I need help with (x,y,t) kriging 
interpolation.

I've been trying to follow this vignette: 
http://cran.r-project.org/web/packages/spacetime/vignettes/jss816.pdf on 
how to interpolate spacio-temporal data but all this talk about STFDF 
objects  and the cryptic (to me) commands in R has me pulling my hair 
out. I was wondering if anybody could give me a quick hand in 
transforming my data (similarly to Section 7.3 of the vignette) to 
finally extract interpolated data after calling the krigeST function.

My (abridged) data is as follows
x	y	t	value
30	30	497826	6.6
1890	30	500990	59.8
1440	270	504142	0.8
30	540	505710	9.5
1890	540	508834	-14
1440	810	512002	-6.5
1890	1050	516706	18
30	30	598238	-5.8
1890	30	601298	55.1
1440	270	604398	5.6
30	540	605946	5.3
1890	540	609022	-17.1
1440	810	612182	-19.1
1890	1050	616606	15.7

and I would like to interpolate, for example, for the following 2 
points in (x, y, t):
x	y	t
240	270	555610
960	810	557186

Many thanks in advance!
Ziggy


From acmartensen at gmail.com  Tue Aug 20 07:48:21 2013
From: acmartensen at gmail.com (Alexandre Camargo Martensen)
Date: Tue, 20 Aug 2013 02:48:21 -0300
Subject: [R-sig-Geo] Keep attributes of spdf - gIntersection, gSymdifference,
	gUnion
Message-ID: <CAJy=A58QwyeU64Xskn1gmw1Dq+1xvFx5GP8PptQeFpP1zA+4MA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130820/e646470e/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug 20 20:20:37 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Aug 2013 20:20:37 +0200
Subject: [R-sig-Geo] Keep attributes of spdf - gIntersection,
 gSymdifference, gUnion
In-Reply-To: <CAJy=A58QwyeU64Xskn1gmw1Dq+1xvFx5GP8PptQeFpP1zA+4MA@mail.gmail.com>
References: <CAJy=A58QwyeU64Xskn1gmw1Dq+1xvFx5GP8PptQeFpP1zA+4MA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308202018160.11594@reclus.nhh.no>

On Tue, 20 Aug 2013, Alexandre Camargo Martensen wrote:

> Dear all,
>
> I have two SpatialPolygonsDataFrame and I am conducting some spatial
> operations such as gIntersection, gSymdifference, gUnion in rgeos. However,
> the outputs are SpatialPolygons, and thus, I lose the attributes (@data) of
> the original polygons.
>
> I need to keep the original attributes associated with the resulted
> attributes, and I was wondering if this is somehow possible, and how. I
> tried byid T and F without success.

While you may know which ID values are appropriate, the rgeos functions 
cannot guess what you mean. Look at row.names() of the output objects, and 
match substrings of those to the row.names() values of your input objects.

Hope this clarifies,

Roger


PS. Please do not post HTML.


>
> Thanks in advance.
>
> Alex
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rhurlin at gwdg.de  Tue Aug 20 21:31:45 2013
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue, 20 Aug 2013 21:31:45 +0200
Subject: [R-sig-Geo] Error in use Gaussian Filter with
 rsaga.geoprocessor: "Gaussian Filter: could not initialize data objects"...
 had status 1
In-Reply-To: <7751194102F32C41B664258D78FE5BC571C3B31B@connmbx1>
References: <7751194102F32C41B664258D78FE5BC571C3B31B@connmbx1>
Message-ID: <5213C421.2050608@gwdg.de>

Am 17.08.2013 13:05, schrieb Alexander Brenning:
> Hi Francesco,
> 
> just a quick reaction while I'm heading out for a few days: I haven't seem this type of error before, and the module normally works well with RSAGA, so I suspect that this is a problem with SAGA GIS dealing with your data. May I suggest that you post this on one of the SAGA GIS discussion boards on sourcefourge ( http://sourceforge.net/p/saga-gis/discussion/ ) indicating also your SAGA GIS version and attaching your raster file (or a smaller test file that causes the same error) to that post if possible. I can have a look at it myself in a week from now if it hasn't been resolved by then.

For the record: This was asked and solved on the SAGA GIS 'Open
discussion Forum', see
http://sourceforge.net/p/saga-gis/discussion/354013/thread/b665f027/

Solution: Input grid has to be named xxx.sgrd instead of xxx.sdat.

So nothing with RSAGA, but with naming conventions of SAGA GIS.

Regards,
Rainer

> 
> Cheers
>   Alex
> 
> 
> Date: Fri, 16 Aug 2013 10:03:19 -0700 (PDT)
> From: francescor <reyesfrance at gmail.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Error in use Gaussian Filter with
>         rsaga.geoprocessor: "Gaussian Filter: could not initialize data
>         objects"... had status 1
> Message-ID: <1376672599372-7584430.post at n2.nabble.com>
> Content-Type: text/plain; charset=us-ascii
> 
> R studio, Version 0.97.551
> SAGA from saga_2.1.0_win32.zip
> Windows 7 Profesional, Service Pack 1, 64-bit Operating System
> Privileges: "C:\\Program Files (x86)\\SAGA-GIS" requires administrator's
> privileges, so I copied SAGA in that folder as administrator, but used R
> from another user account.
> 
> 
> #Dear all,
> #I cannot make rsaga.geoprocessor working to use other functions such as
> gaussian filter, watershed #segmentation or hillshade.
> #Did anybody encountered and solved this kind of problem?
> #Thank you for reading, and maybe answering!
> 
> #For example when I run the following lines:
> 
> #Set SAGA Working Directory
> rsaga.env(workspace=initialdata,
>           path= "C:\\Program Files (x86)\\SAGA-GIS",
>           modules="C:\\Program Files (x86)\\SAGA-GIS\\modules",
>           check.libpath=TRUE)
> 
> #Gaussian Filter
> rsaga.geoprocessor("grid_filter", module = 1,
>                    param = list(INPUT= "C:\\Program Files
> (x86)\\SAGA-GIS\\max_image_r0.25.sdat",
>                                 RESULT=
> "C:\\Users\\reyesf\\Desktop\\Trial_with_R_calling_saga",
>                                 SIGMA=2 , MODE=1, RADIUS=3))
> 
> 
> #after the following 16 lines that look fine
> #R gives me the error "Gaussian Filter: could not ...."(see below)
> 
> 
> library path:   C:\PROGRA~2\SAGA-GIS\modules\grid_filter.dll
> library name:   Grid - Filter
> module name :   Gaussian Filter
> author      :   Copyrights (c) 2003 by Andre Ringeler
> Parameters
> Grids: No objects
> Files: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat
> Transformation: yes
> Interpolation: B-Spline Interpolation
> 
> loading: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat
> Driver: C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat/
> Cells: x 448, y 440
> Bands: 1
> Transformation x' = 676735.000000 + x * 0.250000 + y * 0.000000
> Transformation y' = 5091759.990000 + x * 0.000000 + y * -0.250000
> loading band [1/1]
> 
> Gaussian Filter: could not initialize data objects
> Error: executing module [Gaussian Filter]
> Warning message:
> running command '"C:/Program Files (x86)/SAGA-GIS/saga_cmd.exe" -f=q
> grid_filter 1 -INPUT "C:\Program Files (x86)\SAGA-GIS\max_image_r0.25.sdat"
> -RESULT "C:\Users\reyesf\Desktop\Trial_with_R_calling_saga" -SIGMA "2" -MODE
> "1" -RADIUS "3"' had status 1


From martijn.smit at vu.nl  Wed Aug 21 14:35:07 2013
From: martijn.smit at vu.nl (Smit, M.J.)
Date: Wed, 21 Aug 2013 12:35:07 +0000
Subject: [R-sig-Geo] sphet errors
Message-ID: <FBA2943645E7EA43A9ED44966DBAB9E5408236E0@PEXMB001A.vu.local>

Dear List,

I try to estimate a spatial HAC model with sphet, but I run into errors creating the distance object. First I try (where centroids is a 262x2 matrix with labels according to NUTS_ID, and NUTS_ID is a variable in an attached dataset of 262 observations):

distances <- distance(coord=centroids,type="NN",nn=5,
                      measure="euclidean",firstline=TRUE,
                      file.name="dist.GWT",region.id=NUTS_ID)
but that gives me:
	Error in Weights[Weights[, 1] == i, ][1:nn, ] : subscript out of bounds
	In addition: There were 50 or more warnings (use warnings() to see the first 50)

so instead, I run
distances <- distance(coord=centroids,type="NN",nn=5,
                      measure="euclidean",firstline=TRUE,
                      file.name="dist.GWT",region.id=NULL)
and that gives:
	In distance(coord = centroids, type = "NN", nn = 5, measure = "euclidean",  :
	region.id variable not specified
but still produces the dist.GWT I asked for. This file opens with 0 262, as I expected it to, and then gives origin, destination and distance, as I think it should. It ends with a blank line. However, I cannot read this file:
> dist <- read.gwt2dist(file="dist.GWT",skip=1)
	Error in read.gwt2dist(file = "dist.GWT", skip = 1) : 
	Invalid header line format for GWT file

What am I doing wrong?

Best regards,
Martijn
Vrije Universiteit Amsterdam


From tsippel at gmail.com  Wed Aug 21 21:57:21 2013
From: tsippel at gmail.com (Tim Sippel)
Date: Wed, 21 Aug 2013 12:57:21 -0700
Subject: [R-sig-Geo] sample raster from probability distribution
Message-ID: <CANgNK76vw_HZmwQ33WVQB4O3dwFYnwcMgPfNa_uyijTmu6xj0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130821/608cff2a/attachment.pl>

From darunabas at gmail.com  Wed Aug 21 22:44:34 2013
From: darunabas at gmail.com (BARNABAS DARU)
Date: Wed, 21 Aug 2013 22:44:34 +0200
Subject: [R-sig-Geo] Randomization to obtain p-values
Message-ID: <3D666C79-E1CD-41EB-B868-2FE0655C7D1D@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130821/e3e18c74/attachment.pl>

From damianmaddalena at gmail.com  Wed Aug 21 22:57:06 2013
From: damianmaddalena at gmail.com (Damian Maddalena)
Date: Wed, 21 Aug 2013 16:57:06 -0400
Subject: [R-sig-Geo] generating large, non-repeating,
	color palates for world maps
Message-ID: <521529A2.1010003@gmail.com>

I am mapping regions generated using k-means clustering of ecological 
variables at a global scale. I need to generate large random color ramps 
(200 and 500 colors, for example) that do not repeat and implement them 
in such a way as to minimize adjacency of similar colors. I am 
generating my plots using spplot.

Currently, I generate my color ramps using rainbow() with the number of 
categories in the spplot call as follows:

#df is a sp object of all land surface at .5 degree resolution. I am 
mapping df$clusternum, a category that ranges from 1-n, where n is the 
number of clusters.

n<-200
spplot(df,zcol="clusternum",col.regions=rainbow(n,start=1/6,end=1),at=0:n)

Is there a better way to do this where I can a.) randomize the colors 
and b.) minimize adjacency of similar colors?

Thank you.

-Damian


From carr at nimbios.org  Wed Aug 21 23:08:46 2013
From: carr at nimbios.org (Eric Carr)
Date: Wed, 21 Aug 2013 17:08:46 -0400
Subject: [R-sig-Geo] generating large, non-repeating,
	color palates for world maps
In-Reply-To: <521529A2.1010003@gmail.com>
References: <521529A2.1010003@gmail.com>
Message-ID: <023e01ce9eb2$b1ce07c0$156a1740$@nimbios.org>

200 colors seems extreme but ....   Cubehelix will generate a ramp of that
size.
http://www.mrao.cam.ac.uk/~dag/CUBEHELIX/cubetry.html
Eric

-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Damian Maddalena
Sent: Wednesday, August 21, 2013 4:57 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] generating large, non-repeating, color palates for
world maps

I am mapping regions generated using k-means clustering of ecological
variables at a global scale. I need to generate large random color ramps
(200 and 500 colors, for example) that do not repeat and implement them in
such a way as to minimize adjacency of similar colors. I am generating my
plots using spplot.

Currently, I generate my color ramps using rainbow() with the number of
categories in the spplot call as follows:

#df is a sp object of all land surface at .5 degree resolution. I am mapping
df$clusternum, a category that ranges from 1-n, where n is the number of
clusters.

n<-200
spplot(df,zcol="clusternum",col.regions=rainbow(n,start=1/6,end=1),at=0:n)

Is there a better way to do this where I can a.) randomize the colors and
b.) minimize adjacency of similar colors?

Thank you.

-Damian

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From roman.lustrik at gmail.com  Thu Aug 22 12:53:04 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 22 Aug 2013 12:53:04 +0200
Subject: [R-sig-Geo] sample raster from probability distribution
In-Reply-To: <CANgNK76vw_HZmwQ33WVQB4O3dwFYnwcMgPfNa_uyijTmu6xj0g@mail.gmail.com>
References: <CANgNK76vw_HZmwQ33WVQB4O3dwFYnwcMgPfNa_uyijTmu6xj0g@mail.gmail.com>
Message-ID: <CAHT1vpj_tpMpJ_BoL3obrKbrtbTvVGRdg7aQYw0f8XOwRzNg5Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130822/3a887a38/attachment.pl>

From ludmilarattis at gmail.com  Thu Aug 22 14:36:15 2013
From: ludmilarattis at gmail.com (Ludmila Rattis)
Date: Thu, 22 Aug 2013 09:36:15 -0300
Subject: [R-sig-Geo] Randomization to obtain p-values
In-Reply-To: <3D666C79-E1CD-41EB-B868-2FE0655C7D1D@gmail.com>
References: <3D666C79-E1CD-41EB-B868-2FE0655C7D1D@gmail.com>
Message-ID: <CAKWwe7-PhwrdrHgbiqrWkv07DGxDdYsTH87UXVaoTdqRmhMQMA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130822/2a10a4b2/attachment.pl>

From darunabas at gmail.com  Thu Aug 22 15:56:11 2013
From: darunabas at gmail.com (BARNABAS DARU)
Date: Thu, 22 Aug 2013 15:56:11 +0200
Subject: [R-sig-Geo] Randomization to obtain p-values
In-Reply-To: <CAKWwe7-PhwrdrHgbiqrWkv07DGxDdYsTH87UXVaoTdqRmhMQMA@mail.gmail.com>
References: <3D666C79-E1CD-41EB-B868-2FE0655C7D1D@gmail.com>
	<CAKWwe7-PhwrdrHgbiqrWkv07DGxDdYsTH87UXVaoTdqRmhMQMA@mail.gmail.com>
Message-ID: <B811094B-FAF4-4F2D-9FDD-0BFA22C12B0A@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130822/13898696/attachment.pl>

From tsippel at gmail.com  Thu Aug 22 19:42:10 2013
From: tsippel at gmail.com (Tim Sippel)
Date: Thu, 22 Aug 2013 10:42:10 -0700
Subject: [R-sig-Geo] sample raster from probability distribution
In-Reply-To: <CAHT1vpj_tpMpJ_BoL3obrKbrtbTvVGRdg7aQYw0f8XOwRzNg5Q@mail.gmail.com>
References: <CANgNK76vw_HZmwQ33WVQB4O3dwFYnwcMgPfNa_uyijTmu6xj0g@mail.gmail.com>
	<CAHT1vpj_tpMpJ_BoL3obrKbrtbTvVGRdg7aQYw0f8XOwRzNg5Q@mail.gmail.com>
Message-ID: <CANgNK753NmjRz90wu-4AmvFShGA-JrKeZEa++r=DedBr4-J0jA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130822/575973d7/attachment.pl>

From arnold_salvacion at yahoo.com  Fri Aug 23 12:50:26 2013
From: arnold_salvacion at yahoo.com (Arnold Salvacion)
Date: Fri, 23 Aug 2013 18:50:26 +0800 (SGT)
Subject: [R-sig-Geo] Fitting Zero-Inflated Spatial Model in R
Message-ID: <1377255026.20045.YahooMailNeo@web192703.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130823/647ae0de/attachment.pl>

From valentina.lauria at nuigalway.ie  Fri Aug 23 13:03:51 2013
From: valentina.lauria at nuigalway.ie (Lauria, Valentina)
Date: Fri, 23 Aug 2013 11:03:51 +0000
Subject: [R-sig-Geo] Fitting Zero-Inflated Spatial Model in R
In-Reply-To: <1377255026.20045.YahooMailNeo@web192703.mail.sg3.yahoo.com>
References: <1377255026.20045.YahooMailNeo@web192703.mail.sg3.yahoo.com>
Message-ID: <B11DE93D7F439D4BA1E942572BA750308BC5911E@UDSMBX02.uds.nuigalway.ie>

Hi Arnold,

To fit zero inflated model you can either use zero-inflated Poisson, zero-inflated negative binomial regression, and hurdle models from the pscl package in R.

However I would advise to spend a bit of time to see what type of zero you have in your data.
In particular the zero-inflation model is a mixture model of two components:

1 - a count component described by Poisson, NB, and 2- a zero mass component (i.e., zero with probability 1).

The observed zeros in your data can come from both sources: either they are "random" zeros from component (1) or "excess" zeros from component (2). There is a paper from Mei-Chen Hu et al. 2011 " Zero-inflated and Hurdle Models of Count Data with Extra Zeros:
Examples from an HIV-Risk Reduction Intervention Trial" where this is well explained.

Hope this helps,
Valentina


Dr. Valentina Lauria
Postdoctoral Researcher Associate 
Room 118, Ryan Institute
University Road
National University of Ireland, Galway
Galway
Ireland


From ROONEYJ4 at tcd.ie  Mon Aug 26 12:22:16 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 26 Aug 2013 11:22:16 +0100
Subject: [R-sig-Geo] Openbugs doesn't seen to want to thin.. ?
Message-ID: <75C8D19A1470D344A8AF5312F01160A602B96C5CB8FE@GOMAIL.college.tcd.ie>

Hi all,

Doing some spatial smoothing using the BYM model from the ASDAR book.
I was using Winbugs but had lots of troubles so switched to Openbugs.
Unfortunately having a new problem running out of memory.
I have tried to fix it with thinning - however Openbugs does not seem to want to thin.
My Openscript is below (generated by R2Openbugs).
But no matter what I set the thin level too it still gives me the full 40,000 iterations in the CODA file.
This is a problem because Openbugs is 32bit and above 40k iterations my model gets bigger than 4GB.

Anyone know why it is not thinning ?
Thanks,
James

Script (FYI - I've clipped the pathnames out). This runs fine but the 3 in the modelUpdate() command has no effect - no matter what I change it to it saves all 40,000 samples.

modelDisplay('log')
modelCheck('model.txt')
modelData('data.txt')
modelCompile(2)
modelSetRN(1)
modelInits('inits1.txt',1)
modelInits('inits2.txt',2)
modelGenInits()
modelUpdate(1000,3,1000)
samplesSet(theta)
samplesSet(alpha)
samplesSet(tau)
samplesSet(precv)
samplesSet(deviance)
summarySet(theta)
summarySet(alpha)
summarySet(tau)
summarySet(precv)
summarySet(deviance)
dicSet()
modelUpdate(40000,3,40000)
samplesCoda('*', '//')
summaryStats('*')
dicStats()
samplesHistory('*')
modelSaveLog('log.odc')
modelSaveLog('log.txt')

From virgilio.gomez at uclm.es  Mon Aug 26 12:51:50 2013
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Mon, 26 Aug 2013 12:51:50 +0200
Subject: [R-sig-Geo] Openbugs doesn't seen to want to thin.. ?
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602B96C5CB8FE@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602B96C5CB8FE@GOMAIL.college.tcd.ie>
Message-ID: <1377514310.2737.4.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Hi James,


How many areas do you have? Also, 40K seems too much. Try to reduce it
to 4K. I believe that this number is not the total number of iterations
(including thinning) but the number of iterations to keep after
thinning. So, if you set it to a thinning of 10 and 4K iterations
OpenBUGS will be running for 10*5k iterations and keeping just 4k.
But I may be wrong as I have not used the script language in WB for a
long time.

If your data set is large, you may also want to try INLA to fit the same
model. It is faster and it can handle large datasets.


Hope this helps,

Virgilio

El lun, 26-08-2013 a las 11:22 +0100, James Rooney escribi?:
> Hi all,
> 
> Doing some spatial smoothing using the BYM model from the ASDAR book.
> I was using Winbugs but had lots of troubles so switched to Openbugs.
> Unfortunately having a new problem running out of memory.
> I have tried to fix it with thinning - however Openbugs does not seem to want to thin.
> My Openscript is below (generated by R2Openbugs).
> But no matter what I set the thin level too it still gives me the full 40,000 iterations in the CODA file.
> This is a problem because Openbugs is 32bit and above 40k iterations my model gets bigger than 4GB.
> 
> Anyone know why it is not thinning ?
> Thanks,
> James
> 
> Script (FYI - I've clipped the pathnames out). This runs fine but the 3 in the modelUpdate() command has no effect - no matter what I change it to it saves all 40,000 samples.
> 
> modelDisplay('log')
> modelCheck('model.txt')
> modelData('data.txt')
> modelCompile(2)
> modelSetRN(1)
> modelInits('inits1.txt',1)
> modelInits('inits2.txt',2)
> modelGenInits()
> modelUpdate(1000,3,1000)
> samplesSet(theta)
> samplesSet(alpha)
> samplesSet(tau)
> samplesSet(precv)
> samplesSet(deviance)
> summarySet(theta)
> summarySet(alpha)
> summarySet(tau)
> summarySet(precv)
> summarySet(deviance)
> dicSet()
> modelUpdate(40000,3,40000)
> samplesCoda('*', '//')
> summaryStats('*')
> dicStats()
> samplesHistory('*')
> modelSaveLog('log.odc')
> modelSaveLog('log.txt')
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ROONEYJ4 at tcd.ie  Mon Aug 26 13:13:01 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 26 Aug 2013 12:13:01 +0100
Subject: [R-sig-Geo] Openbugs doesn't seen to want to thin.. ?
In-Reply-To: <1377514310.2737.4.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
References: <75C8D19A1470D344A8AF5312F01160A602B96C5CB8FE@GOMAIL.college.tcd.ie>,
	<1377514310.2737.4.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602B96C5CB8FF@GOMAIL.college.tcd.ie>

Hi Virgilio,

I just did some testing based on what you said.
You are right! Thanks! The number is the number of iterations to keep!
This was not obvious to me from any documentation

But - great thanks problem fixed. Not familiar with INLA and too far into this to change now but since these solves the problem that is ok.
Thanks!

James

________________________________________
From: Virgilio G?mez-Rubio [virgilio.gomez at uclm.es]
Sent: 26 August 2013 11:51
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Openbugs doesn't seen to want to thin.. ?

Hi James,


How many areas do you have? Also, 40K seems too much. Try to reduce it
to 4K. I believe that this number is not the total number of iterations
(including thinning) but the number of iterations to keep after
thinning. So, if you set it to a thinning of 10 and 4K iterations
OpenBUGS will be running for 10*5k iterations and keeping just 4k.
But I may be wrong as I have not used the script language in WB for a
long time.

If your data set is large, you may also want to try INLA to fit the same
model. It is faster and it can handle large datasets.


Hope this helps,

Virgilio

El lun, 26-08-2013 a las 11:22 +0100, James Rooney escribi?:
> Hi all,
>
> Doing some spatial smoothing using the BYM model from the ASDAR book.
> I was using Winbugs but had lots of troubles so switched to Openbugs.
> Unfortunately having a new problem running out of memory.
> I have tried to fix it with thinning - however Openbugs does not seem to want to thin.
> My Openscript is below (generated by R2Openbugs).
> But no matter what I set the thin level too it still gives me the full 40,000 iterations in the CODA file.
> This is a problem because Openbugs is 32bit and above 40k iterations my model gets bigger than 4GB.
>
> Anyone know why it is not thinning ?
> Thanks,
> James
>
> Script (FYI - I've clipped the pathnames out). This runs fine but the 3 in the modelUpdate() command has no effect - no matter what I change it to it saves all 40,000 samples.
>
> modelDisplay('log')
> modelCheck('model.txt')
> modelData('data.txt')
> modelCompile(2)
> modelSetRN(1)
> modelInits('inits1.txt',1)
> modelInits('inits2.txt',2)
> modelGenInits()
> modelUpdate(1000,3,1000)
> samplesSet(theta)
> samplesSet(alpha)
> samplesSet(tau)
> samplesSet(precv)
> samplesSet(deviance)
> summarySet(theta)
> summarySet(alpha)
> summarySet(tau)
> summarySet(precv)
> summarySet(deviance)
> dicSet()
> modelUpdate(40000,3,40000)
> samplesCoda('*', '//')
> summaryStats('*')
> dicStats()
> samplesHistory('*')
> modelSaveLog('log.odc')
> modelSaveLog('log.txt')
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ROONEYJ4 at tcd.ie  Mon Aug 26 17:42:55 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 26 Aug 2013 16:42:55 +0100
Subject: [R-sig-Geo] output data from R to SaTScan
Message-ID: <75C8D19A1470D344A8AF5312F01160A602B96C5CB900@GOMAIL.college.tcd.ie>

Hi all,

So I have created some maps in R, smoothed then using the BYM model in Openbugs and opened the CODA files in R once again to analyze results etc.

I would like to now test for clusters using SaTScan and the post smoothing data - but I can find very little info anywhere on how to output my R data into a format that SaTScan can use. My data within R is in the form of a SpatialPolygonsDataFrame which up until now I have been saving as an ESRI shapefile with the command:
writeOGR(data, "", layer="data_out",driver="ESRI Shapefile",overwrite=T)

But from what info I can find, I think this doesn't seem to be a useful format for SaTScan.

Any advice would be appreciated on how to achieve this!
Many thanks,
James

From hughsturrock at hotmail.com  Mon Aug 26 18:10:22 2013
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Mon, 26 Aug 2013 17:10:22 +0100
Subject: [R-sig-Geo] output data from R to SaTScan
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602B96C5CB900@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602B96C5CB900@GOMAIL.college.tcd.ie>
Message-ID: <DUB116-W1397771AA4184A1106E3E70C8490@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130826/0dc024e6/attachment.pl>

From Scott.Waichler at pnnl.gov  Mon Aug 26 19:50:17 2013
From: Scott.Waichler at pnnl.gov (Waichler, Scott R)
Date: Mon, 26 Aug 2013 10:50:17 -0700
Subject: [R-sig-Geo] how to use levelplot() with a geographic projection
Message-ID: <A632B3F93D861843A3C966F3962C3F840148AE939952@EMAIL05.pnl.gov>

Hi, I am making lattice plots with levelplot(), where my data are on a regular grid in longitude and latitude, and I want to plot state boundaries as an overlay for reference.  How can I do this so that the plot looks more geographically true, with states having the appearance we are used to?  The extent of my plot regions is on the order of state of Texas or the Pacific Northwest.

library(lattice)
library(maps)
data(stateMapEnv)
state.map <- map("state", plot=F)

MAPPLOT1 <- function() {
  print(
  levelplot(zvec ~ xvec + yvec | pvec, asp="iso",
            panel = function(...) {
              panel.levelplot(...)
              llines(state.map$x, state.map$y, col="black")
            },
            xlab="Longitude", ylab="Latitude"
  ))
  dev.off() # close the graphics file for this date
}  # end MAPPLOT1()

Thanks,
Scott

Scott Waichler, PhD
Senior Research Scientist
Hydrology Group, Energy & Environment Directorate
Pacific Northwest National Laboratory
P.O. Box 999, Richland, WA  99352
scott.waichler at pnnl.gov
509-996-8260, 509-341-4051 (cell)


From zdziarze at scss.tcd.ie  Mon Aug 26 20:11:45 2013
From: zdziarze at scss.tcd.ie (Supadog)
Date: Mon, 26 Aug 2013 11:11:45 -0700 (PDT)
Subject: [R-sig-Geo] Error with STFDF
Message-ID: <1377540705110-7584461.post@n2.nabble.com>

Hello,

I'm having trouble creating an STFDF object from my spacio-temporal data.
The object is intended to be used later to perform kriging interpolation. 
My data looks like this (a few lines):
      x    y   t            value
1    30   30 497826   6.6
2   960   30 499430   7.4
3  1890  30 500990   59.8

And I type in the following commands:
# read in the data from csv file and specify coordinates columns
f <- read.csv('data.csv') 
coordinates(f) <- ~x+y

# create SP object out of the coordinates
g <- as(f, "SpatialPoints")

# obtain time points. The timestamps are in milliseconds.
ts = f$t
options("digits.secs"=3)
time = as.POSIXct(ts/1e3, origin="1970-01-01", tz="Europe/Dublin")

# create data.frame
data = as.data.frame(f[2])

# finally create the STFDF object
obj = STFDF(g, time, data)

But I get the following error message:
Error: nrow(object at data) == length(object at sp) * nrow(object at time) is not
TRUE


What am I missing? The data is in long form so each time reading has its own
coords and data value and I don't want the equation in the error to hold. 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-with-STFDF-tp7584461.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tephilippi at gmail.com  Mon Aug 26 20:57:37 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Mon, 26 Aug 2013 11:57:37 -0700
Subject: [R-sig-Geo] Error with STFDF
In-Reply-To: <1377540705110-7584461.post@n2.nabble.com>
References: <1377540705110-7584461.post@n2.nabble.com>
Message-ID: <CALyPt8zhOj8HNk5LgRpoWc+Ni8dyy4BUCV4u6-rJD8Bnd6YZCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130826/f3a88762/attachment.pl>

From Dominik.Schneider at colorado.edu  Mon Aug 26 21:31:58 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Mon, 26 Aug 2013 13:31:58 -0600
Subject: [R-sig-Geo] calculate moving window MAE for point and raster data.
Message-ID: <CAHYDKLa+mNQnj96xMNV9-26WC1oevf8BM=nJjhukYgjBn4XvxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130826/7c6170f6/attachment.pl>

From tephilippi at gmail.com  Mon Aug 26 21:39:31 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Mon, 26 Aug 2013 12:39:31 -0700
Subject: [R-sig-Geo] how to use levelplot() with a geographic projection
In-Reply-To: <A632B3F93D861843A3C966F3962C3F840148AE939952@EMAIL05.pnl.gov>
References: <A632B3F93D861843A3C966F3962C3F840148AE939952@EMAIL05.pnl.gov>
Message-ID: <CALyPt8ytCF=uaNi=0CWjMoWEjNDDJf1-WKFLCTx5UrD_WOcQ8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130826/85218c3a/attachment.pl>

From ROONEYJ4 at tcd.ie  Mon Aug 26 23:23:26 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 26 Aug 2013 22:23:26 +0100
Subject: [R-sig-Geo] output data from R to SaTScan
In-Reply-To: <DUB116-W1397771AA4184A1106E3E70C8490@phx.gbl>
References: <75C8D19A1470D344A8AF5312F01160A602B96C5CB900@GOMAIL.college.tcd.ie>,
	<DUB116-W1397771AA4184A1106E3E70C8490@phx.gbl>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602B96C5CB902@GOMAIL.college.tcd.ie>

Hi Hugh,

Thanks for your answer. Yes I've seen it said that those packages can do most of what SaTScan does.
I'm playing with Kulldorff's Statistic as implemented in section 11.5.6 of ASDAR - but a few things confuse me:

1. How do I decide what the correct value for fractpop is ? I initially had it set to .25 and I was getting cluster of 50% of my cases which made no sense.
2. Is there any correction for multiple testing in the opgam() command ? I have over 3000 areas - do I need to set a very low alpha ?
3. How do I detect more than one cluster ? I have maps where I suspect 2 or 3 separate clusters based on smoothed RR's.


My code currently looks like this (which I based on the code for Fig11.18 in the book and this useful question and answer: http://r-sig-geo.2731867.n2.nabble.com/Strange-results-in-DCluster-package-td7326832.html )

sa<-data.frame(Observed=ED$var1)
sa<-cbind(sa, Expected=mean(ED$var1))
sa<-cbind(sa, x=ED$x, y=ED$y)
sa$Observed<-as.numeric(sa$Observed)

#Kuldorff-Nagarwalla analysis
mle<-calculate.mle(sa, model="poisson") 
knres<-opgam(data=sa, thegrid=sa[,c("x", "y")], alpha=.025, R=99,
             iscluster=kn.iscluster, fractpop=.10, model="poisson", mle=mle, log.v=TRUE)

#Print cluster result
clusters<-get.knclusters(as(ED, "data.frame"), knres)
i<-which.max(knres$statistic)

ED$KNcluster<-""
ED$KNcluster[clusters[[i]]]<-"cluster"
ED$KNcluster[clusters[[i]][1]]<-"centre"
ED$KNcluster<-as.factor(ED$KNcluster)

print(spplot(ED, "KNcluster", main="Kulldorff's method",
              col.regions=c(gray(1), gray(.5), gray(.8))))


Thanks,
James


________________________________________
From: Hugh Sturrock [hughsturrock at hotmail.com]
Sent: 26 August 2013 17:10
To: James Rooney; r-sig-geo at r-project.org
Subject: RE: [R-sig-Geo] output data from R to SaTScan

Hi James,

Not sure how to do that, but check out SpatialEpi and Dcluster packages, I believe they can do a lot of what SaTScan does..

Cheers, Hugh

> From: ROONEYJ4 at tcd.ie
> To: r-sig-geo at r-project.org
> Date: Mon, 26 Aug 2013 16:42:55 +0100
> Subject: [R-sig-Geo] output data from R to SaTScan
>
> Hi all,
>
> So I have created some maps in R, smoothed then using the BYM model in Openbugs and opened the CODA files in R once again to analyze results etc.
>
> I would like to now test for clusters using SaTScan and the post smoothing data - but I can find very little info anywhere on how to output my R data into a format that SaTScan can use. My data within R is in the form of a SpatialPolygonsDataFrame which up until now I have been saving as an ESRI shapefile with the command:
> writeOGR(data, "", layer="data_out",driver="ESRI Shapefile",overwrite=T)
>
> But from what info I can find, I think this doesn't seem to be a useful format for SaTScan.
>
> Any advice would be appreciated on how to achieve this!
> Many thanks,
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From hughsturrock at hotmail.com  Tue Aug 27 00:42:14 2013
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Mon, 26 Aug 2013 23:42:14 +0100
Subject: [R-sig-Geo] output data from R to SaTScan
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602B96C5CB902@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602B96C5CB900@GOMAIL.college.tcd.ie>,
	, <DUB116-W1397771AA4184A1106E3E70C8490@phx.gbl>,
	<75C8D19A1470D344A8AF5312F01160A602B96C5CB902@GOMAIL.college.tcd.ie>
Message-ID: <DUB116-W824E6488C4DEFB835EB9CCC8490@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130826/9d8cc157/attachment.pl>

From macqueen1 at llnl.gov  Tue Aug 27 00:46:58 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 26 Aug 2013 22:46:58 +0000
Subject: [R-sig-Geo] Problems wirh R 3.0.1 and maptools
In-Reply-To: <1376770833.46709.YahooMailNeo@web140904.mail.bf1.yahoo.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521910D41CC9C@PRDEXMBX-08.the-lab.llnl.gov>

What happens if you try these, derived from the examples in ?rgdal:

## from ?readOGR
dsn <- system.file("vectors", package = "rgdal")[1]

## then read two of the shapefiles in that directory
cit <- readOGR(dsn,'cities')
plot(cit)

tmp <- readOGR(dsn,'trin_inca_pl03')
plot(tmp)


They work for me, also having recently upgraded to R 3.0.1 on a Mac.

I see that error message from time to time, and if I recall correctly it
usually has something to do with which packages I have (or don't have)
attached. 

Similar to what Lee said, I would make sure you have up to date versions
of everything that maptools and rgdal depend on.

Compare with the versions I have:
> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.8-10, (SVN revision 478)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj



I'd also suggest including the the output of sessionInfo() in your posts
(standard practice for all requests for R help)

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 8/17/13 1:20 PM, "sara martino" <saramartino at yahoo.com> wrote:

>Hi
>i am new to using shapefiles in R. I just want to plot some maps and I
>used to do it as: 
>
>
>shp=readShapeSpatial("file.shp")
>plot(shp)
>
>using maptools or 
>
>
>shp <-readOGR("path/to/shpfiles","IND_adm2")plot(shp)
>
>using rgdal.
>
>I have now upgraded to R 3.0.1 and since then everytime i try to plot the
>shapefile i get the error:
>
>Error in as.double(y) :
>cannot coerce type 'S4' to vector of type 'double'
>
>I get the same error also if i try to reproduce the example in
>>?readShapeSpatial.
>
>Can anyone tell me what is the problem?
>thanks
>sara
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From zdziarze at scss.tcd.ie  Tue Aug 27 01:03:24 2013
From: zdziarze at scss.tcd.ie (Supadog)
Date: Mon, 26 Aug 2013 16:03:24 -0700 (PDT)
Subject: [R-sig-Geo] Error with STFDF
In-Reply-To: <CALyPt8zhOj8HNk5LgRpoWc+Ni8dyy4BUCV4u6-rJD8Bnd6YZCA@mail.gmail.com>
References: <1377540705110-7584461.post@n2.nabble.com>
	<CALyPt8zhOj8HNk5LgRpoWc+Ni8dyy4BUCV4u6-rJD8Bnd6YZCA@mail.gmail.com>
Message-ID: <1377558204630-7584468.post@n2.nabble.com>

Hi Tom, 

Thanks for the response. I would like to interpolate for values in the
'value' column given different x, y and t values. I was hoping to use the
krigeST function but I just did a little bit of searching and it appears as
though it won't work with anything other than STFDF objects. Do I have any
other options?

Thanks,
Ziggy



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-with-STFDF-tp7584461p7584468.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From pan.sapiens.it at gmail.com  Tue Aug 27 08:23:15 2013
From: pan.sapiens.it at gmail.com (Pan)
Date: Tue, 27 Aug 2013 07:23:15 +0100
Subject: [R-sig-Geo] Import custom projection in R
Message-ID: <521C45D3.2030909@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130827/53aed8c5/attachment.pl>

From ben.graeler at uni-muenster.de  Tue Aug 27 09:31:20 2013
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Tue, 27 Aug 2013 09:31:20 +0200
Subject: [R-sig-Geo] Error with STFDF
In-Reply-To: <1377558204630-7584468.post@n2.nabble.com>
References: <1377540705110-7584461.post@n2.nabble.com>
	<CALyPt8zhOj8HNk5LgRpoWc+Ni8dyy4BUCV4u6-rJD8Bnd6YZCA@mail.gmail.com>
	<1377558204630-7584468.post@n2.nabble.com>
Message-ID: <521C55C8.2060109@uni-muenster.de>

Dear Ziggy,

the spatio-temporal sum-metric variogram model is the only one that is
currently also implemented for the STSDF classes. You should be able
to coerce your STIDF to a STSDF using as(). In the STSDF case ("S"
meaning sparse), the space and time instances are stored once and an
index relates observations to their spatio-temporal location. It can
handle both extreme cases of a full layout (ST-F-DF) and the irregular
case (ST-I-DF). See Figure 1 in the spacetime vignette [1] for a
graphical representation of all four ST* layouts.

Best,

 Ben

[1] http://cran.r-project.org/web/packages/spacetime/vignettes/jss816.pdf

On 27.08.2013 01:03, Supadog wrote:
> Hi Tom,
> 
> Thanks for the response. I would like to interpolate for values in
> the 'value' column given different x, y and t values. I was hoping
> to use the krigeST function but I just did a little bit of
> searching and it appears as though it won't work with anything
> other than STFDF objects. Do I have any other options?
> 
> Thanks, Ziggy
> 
> 
> 
> -- View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Error-with-STFDF-tp7584461p7584468.html
>
> 
Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de


From oscar.perpinan at gmail.com  Tue Aug 27 10:12:18 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Tue, 27 Aug 2013 10:12:18 +0200
Subject: [R-sig-Geo] how to use levelplot() with a geographic projection
In-Reply-To: <CALyPt8ytCF=uaNi=0CWjMoWEjNDDJf1-WKFLCTx5UrD_WOcQ8g@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148AE939952@EMAIL05.pnl.gov>
	<CALyPt8ytCF=uaNi=0CWjMoWEjNDDJf1-WKFLCTx5UrD_WOcQ8g@mail.gmail.com>
Message-ID: <CAMLL7b=+5j-tJWdeNcHnEs025vcBBthprUWj0km-evBt9=zhnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130827/52c31d2a/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug 27 10:53:07 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Aug 2013 10:53:07 +0200
Subject: [R-sig-Geo] Import custom projection in R
In-Reply-To: <521C45D3.2030909@gmail.com>
References: <521C45D3.2030909@gmail.com>
Message-ID: <alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>

On Tue, 27 Aug 2013, Pan wrote:

> Dear all,
>
> I'm quite new to spatial data processing in R and I'm getting entangled in projection systems, I would appreciate your support to find a solution. I need to import my custom projection in R (my.proj), create projected spatial objects (I usedSpatialPointsDataFrame {sp}) and export them as
> shapefiles (I usedwritePointsShape {maptools}). As I said, the first step is particularly tricky to me!
>
> I tried to import the projection both asmy.proj.shp andmy.proj.prj 
> usingreadOGR() {rgdal} but the result was just the same: it didn't work!
>
> As you see below I've been trying different solutions to make the 
> function work but I still didn't understand what I'm supposed to assign 
> to dsn and layer:

No, reading (and re-reading) the help pages and their references may help. 
You have not explained why you need to read your "custom" projection. You 
could simply enter it as a PROJ.4 string. You appear to think that you 
should read a shapefile (including its optional *.prj file component) to 
retreive the string. If you don't need to do this, and can write it as a 
string in R, do that - CRS() of your string with rgdal loaded will check 
for obvious errors. If you have a representation that OGR recognises, such 
as a shapefile, you can say for example:

library(rgdal)
dsn <- system.file("vectors", package = "rgdal")[1]
# to access the vector examples provided
OGRSpatialRef(dsn, "cities")

Here, the dsn= argument is the directory containing the shapefile 
components, and cities is a layer; here, you can check that there are 
files ending in "prj", and for files starting with "cities":

list.files(path=dsn, pattern="prj$")
list.files(path=dsn, pattern="^cities")

Do check that the files are where you think they are, the most frequent 
cause of the error message you see being that they are somewhere else. 
Once you are done, use writeOGR(), not writePointShape() which is 
deprecated and which discards your coordinate reference system anyway, so 
defeating the point of your exercise.

Hope this clarifies,

Roger

>
> inputdir<-"C:/my working directory/"
>
> library(rgdal)
>
>  > Test<-readOGR(dsn=paste(inputdir),layer="my.proj")
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv = use_iconv) :
>    Cannot open file
>
>  > Test<-readOGR(dsn=paste(inputdir,"my.proj",sep=""),layer="my.proj.shp")
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv = use_iconv) :
>    Cannot open file
>
>  > Test<-readOGR(dsn="my.proj",layer="my.proj.shp")
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv = use_iconv) :
>    Cannot open file
>
> also the attempts withogrInfo()haven't been successful.
>
> So I have two questions on this matter. How should I handle the issue withreadOGR()? Is there any other way (possibly easy) to import a custom projection in R?
>
> Note: I'm using R 2.15.2 and rgdal 0.8-10.
>
> Thanks in advance
>
> Ivan
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Tue Aug 27 15:15:17 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 27 Aug 2013 15:15:17 +0200
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white space?
Message-ID: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>

I have raster images with many more rows than columns, i.e
require(raster)
a <- raster(matrix(200,ncol=256,nrow=3171))
extent(a) <- c(0,256,0,3177)

and get too much blank space at plotting:

plot(a,axes=FALSE,legend=FALSE)

in particular if I want to display several bands in the same plot:
a <- stack(a,a*2,a/2,a*3)
plot(a,axes=FALSE,legend=FALSE)

Is there a way to optimize the plot so that rectangles are closer?

Thanks

Agus


From mdsumner at gmail.com  Tue Aug 27 15:37:02 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 27 Aug 2013 23:37:02 +1000
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white
	space?
In-Reply-To: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
References: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
Message-ID: <CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>

I don't get what you mean by "rectangles are closer", but maybe modify
the aspect ratio?
plot(a,axes=FALSE,legend=FALSE, asp = 0.2)

Otherwise, you can control the margins around each plot directly with
a bit of mixing old-school and new:
par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(2,2))
for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 0.2)

I don't think you can control the par run by raster's plot function
directly, but if you stop it setting up the whole page like this it
respects each panel it seems.

HTH


On Tue, Aug 27, 2013 at 11:15 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> I have raster images with many more rows than columns, i.e
> require(raster)
> a <- raster(matrix(200,ncol=256,nrow=3171))
> extent(a) <- c(0,256,0,3177)
>
> and get too much blank space at plotting:
>
> plot(a,axes=FALSE,legend=FALSE)
>
> in particular if I want to display several bands in the same plot:
> a <- stack(a,a*2,a/2,a*3)
> plot(a,axes=FALSE,legend=FALSE)
>
> Is there a way to optimize the plot so that rectangles are closer?
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From dominic.roye at gmail.com  Tue Aug 27 17:36:13 2013
From: dominic.roye at gmail.com (Dominic Roye)
Date: Tue, 27 Aug 2013 17:36:13 +0200
Subject: [R-sig-Geo] Thin-plate splines query
Message-ID: <CALvVS-HOkJOYdiYVw_gqFHkC42KwwVcHFYG-m6Mm8qfD4UJzrg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130827/00216a13/attachment.pl>

From alobolistas at gmail.com  Tue Aug 27 19:01:19 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 27 Aug 2013 19:01:19 +0200
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white
	space?
In-Reply-To: <CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>
References: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
	<CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>
Message-ID: <CAG4NReJPT=dn5GBe0LFujNBV9fHxg_FGmzdaiDONCt7xzRrg8Q@mail.gmail.com>

Michael,

On Tue, Aug 27, 2013 at 3:37 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> I don't get what you mean by "rectangles are closer", but maybe modify
> the aspect ratio?
> plot(a,axes=FALSE,legend=FALSE, asp = 0.2)
No, that distorts the image. The plot of the actual image is correct.
What I want is to reduce the extent of the large white area around the
image. The shape of the white area
is not proportional to the shape of the image, it is a much wider rectangle.

> Otherwise, you can control the margins around each plot directly with
> a bit of mixing old-school and new:
> par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(2,2))
> for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 0.2)
> I don't think you can control the par run by raster's plot function
> directly, but if you stop it setting up the whole page like this it
> respects each panel it seems.
>
Reducing the margins with par() is not enough, the big issue is the
large white space surrounding each image.
The trick seems to be making the plotting area so that it is more
proportional to the shape of the image.
Actually, based on your suggestion, this is quite close to what I need:
par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(1,4))
for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 1)

But a more general solution would be better.

Thanks
Agus



> On Tue, Aug 27, 2013 at 11:15 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> I have raster images with many more rows than columns, i.e
>> require(raster)
>> a <- raster(matrix(200,ncol=256,nrow=3171))
>> extent(a) <- c(0,256,0,3177)
>>
>> and get too much blank space at plotting:
>>
>> plot(a,axes=FALSE,legend=FALSE)
>>
>> in particular if I want to display several bands in the same plot:
>> a <- stack(a,a*2,a/2,a*3)
>> plot(a,axes=FALSE,legend=FALSE)
>>
>> Is there a way to optimize the plot so that rectangles are closer?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From oscar.perpinan at gmail.com  Wed Aug 28 01:08:20 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Wed, 28 Aug 2013 01:08:20 +0200
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white
	space?
In-Reply-To: <CAG4NReJPT=dn5GBe0LFujNBV9fHxg_FGmzdaiDONCt7xzRrg8Q@mail.gmail.com>
References: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
	<CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>
	<CAG4NReJPT=dn5GBe0LFujNBV9fHxg_FGmzdaiDONCt7xzRrg8Q@mail.gmail.com>
Message-ID: <CAMLL7bnH-s46RCVV=L1-bdpmA42wWdiC-8ZPCiyz9ajaKA4-cA@mail.gmail.com>

Hello,

I think this question asked for the same problem:
http://stackoverflow.com/questions/17214469/r-crop-raster-data-and-set-axis-limits

My proposal was to use raster::spplot or rasterVis::levelplot.

Best,

Oscar
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


2013/8/27 Agustin Lobo <alobolistas at gmail.com>:
> Michael,
>
> On Tue, Aug 27, 2013 at 3:37 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>> I don't get what you mean by "rectangles are closer", but maybe modify
>> the aspect ratio?
>> plot(a,axes=FALSE,legend=FALSE, asp = 0.2)
> No, that distorts the image. The plot of the actual image is correct.
> What I want is to reduce the extent of the large white area around the
> image. The shape of the white area
> is not proportional to the shape of the image, it is a much wider rectangle.
>
>> Otherwise, you can control the margins around each plot directly with
>> a bit of mixing old-school and new:
>> par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(2,2))
>> for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 0.2)
>> I don't think you can control the par run by raster's plot function
>> directly, but if you stop it setting up the whole page like this it
>> respects each panel it seems.
>>
> Reducing the margins with par() is not enough, the big issue is the
> large white space surrounding each image.
> The trick seems to be making the plotting area so that it is more
> proportional to the shape of the image.
> Actually, based on your suggestion, this is quite close to what I need:
> par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(1,4))
> for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 1)
>
> But a more general solution would be better.
>
> Thanks
> Agus
>
>
>
>> On Tue, Aug 27, 2013 at 11:15 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>> I have raster images with many more rows than columns, i.e
>>> require(raster)
>>> a <- raster(matrix(200,ncol=256,nrow=3171))
>>> extent(a) <- c(0,256,0,3177)
>>>
>>> and get too much blank space at plotting:
>>>
>>> plot(a,axes=FALSE,legend=FALSE)
>>>
>>> in particular if I want to display several bands in the same plot:
>>> a <- stack(a,a*2,a/2,a*3)
>>> plot(a,axes=FALSE,legend=FALSE)
>>>
>>> Is there a way to optimize the plot so that rectangles are closer?
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Michael Sumner
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Wed Aug 28 10:10:07 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 28 Aug 2013 10:10:07 +0200
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white
	space?
In-Reply-To: <CAMLL7bnH-s46RCVV=L1-bdpmA42wWdiC-8ZPCiyz9ajaKA4-cA@mail.gmail.com>
References: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
	<CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>
	<CAG4NReJPT=dn5GBe0LFujNBV9fHxg_FGmzdaiDONCt7xzRrg8Q@mail.gmail.com>
	<CAMLL7bnH-s46RCVV=L1-bdpmA42wWdiC-8ZPCiyz9ajaKA4-cA@mail.gmail.com>
Message-ID: <CAG4NReJt+rzL6u58uc3GqaHtj-KQjTTT30x_eDmhcWg6eGw7QA@mail.gmail.com>

Interesting thread, but spplot() does not solve the problem of the
excessive white space in multiple plots.
The following
require(lattice)
par(mar = c(0.1, 0.1, 0.1, 0.1))
p1 <- spplot(a[[1]], col=colort,colorkey=FALSE)
p2 <- spplot(a[[2]], col=colort,colorkey=FALSE)
p3 <- spplot(a[[3]], col=colort,colorkey=FALSE)
p4 <- spplot(a[[4]], col=colort,colorkey=FALSE)
print(p1, position = c(0,.5,.5,1),more=T)
print(p2, position = c(.5,.5,1,1),more = T)
print(p3, position = c(0,0,.5,.5),more=T)
print(p4, position = c(0.5,0,1,.5))

is quite the same as
par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(2,2))
for (i in 1:4) plot(a[[i]], col=colort,axes=FALSE,legend=FALSE, asp = 1)

and

print(p1, position = c(0,0,.25,1),more=T)
print(p2, position = c(0.25,0,0.5,1),more = T)
print(p3, position = c(0.5,0,.75,1),more=T)
print(p4, position = c(0.75,0,1,1))

is quite the same as

par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(1,4))
for (i in 1:4) plot(a[[i]], col=colort,axes=FALSE,legend=FALSE, asp = 1)

(and the the two last options provide acceptable results in my case).

I think that the trick is to design a plotting area with the appropriate shape,
and the white space is reduced proportionally. Or being able to get
the plotting area
proportional to the shape of the multiple plot.

But this is getting more into graphics than into spatial issues.

Thanks


On Wed, Aug 28, 2013 at 1:08 AM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> Hello,
>
> I think this question asked for the same problem:
> http://stackoverflow.com/questions/17214469/r-crop-raster-data-and-set-axis-limits
>
> My proposal was to use raster::spplot or rasterVis::levelplot.
>
> Best,
>
> Oscar
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan
>
>
> 2013/8/27 Agustin Lobo <alobolistas at gmail.com>:
>> Michael,
>>
>> On Tue, Aug 27, 2013 at 3:37 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>>> I don't get what you mean by "rectangles are closer", but maybe modify
>>> the aspect ratio?
>>> plot(a,axes=FALSE,legend=FALSE, asp = 0.2)
>> No, that distorts the image. The plot of the actual image is correct.
>> What I want is to reduce the extent of the large white area around the
>> image. The shape of the white area
>> is not proportional to the shape of the image, it is a much wider rectangle.
>>
>>> Otherwise, you can control the margins around each plot directly with
>>> a bit of mixing old-school and new:
>>> par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(2,2))
>>> for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 0.2)
>>> I don't think you can control the par run by raster's plot function
>>> directly, but if you stop it setting up the whole page like this it
>>> respects each panel it seems.
>>>
>> Reducing the margins with par() is not enough, the big issue is the
>> large white space surrounding each image.
>> The trick seems to be making the plotting area so that it is more
>> proportional to the shape of the image.
>> Actually, based on your suggestion, this is quite close to what I need:
>> par(mar = c(0.1, 0.1, 0.1, 0.1), mfrow = c(1,4))
>> for (i in 1:4) plot(a[[i]], axes=FALSE,legend=FALSE, asp = 1)
>>
>> But a more general solution would be better.
>>
>> Thanks
>> Agus
>>
>>
>>
>>> On Tue, Aug 27, 2013 at 11:15 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>>> I have raster images with many more rows than columns, i.e
>>>> require(raster)
>>>> a <- raster(matrix(200,ncol=256,nrow=3171))
>>>> extent(a) <- c(0,256,0,3177)
>>>>
>>>> and get too much blank space at plotting:
>>>>
>>>> plot(a,axes=FALSE,legend=FALSE)
>>>>
>>>> in particular if I want to display several bands in the same plot:
>>>> a <- stack(a,a*2,a/2,a*3)
>>>> plot(a,axes=FALSE,legend=FALSE)
>>>>
>>>> Is there a way to optimize the plot so that rectangles are closer?
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Michael Sumner
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jordan.chamberlin at gmail.com  Wed Aug 28 10:02:50 2013
From: jordan.chamberlin at gmail.com (Jordan Chamberlin)
Date: Wed, 28 Aug 2013 10:02:50 +0200
Subject: [R-sig-Geo] rasters of cell numbers & centroid coordinates
Message-ID: <521DAEAA.9000708@gmail.com>

Hi all,

For some processing that I'm doing with raster data, I need to keep 
track of cell centroid coordinate values, and I would like to do this in 
terms of a set of reference rasters which hold cell values, x and y 
coordinates, respectively, for the raster being analyzed. I can do this 
(code below) but my question is: am I going about this in the most 
efficient way? Here is what I'm doing (using a small test raster since 
mine are humongous):

#get test raster
r <- raster(system.file("external/test.grd", package="raster"))

#make copies which will hold cell identifiers, x & y values
ry <- rx <- rc <- r

#define raster of cell numbers for the non-NA cells
rc[] <- seq(1:length(r))
## for some reason, this is not working:  rc <- mask[rc,r]
## but this works fine:
rc[is.na(r)] <-NA

#assign coordinate values to corresponding rasters
ry[] <- yFromCell(rc, getValues(rc))
rx[] <- xFromCell(rc, getValues(rc))

# stack em up and view
s <- stack(r,rc,rx,ry)
names(s) <- c("values", "cell #", "x-coord", "y-coord")
plot(s)

So this works fine, but I have a feeling there are some shortcuts I'm 
missing.

Thanks for guidance,

Jordan


From jan.verbesselt at wur.nl  Wed Aug 28 15:49:23 2013
From: jan.verbesselt at wur.nl (Verbesselt, Jan)
Date: Wed, 28 Aug 2013 13:49:23 +0000
Subject: [R-sig-Geo] rasters of cell numbers & centroid coordinates
In-Reply-To: <521DAEAA.9000708@gmail.com>
Message-ID: <CE43BDED.7CD2%jan.verbesselt@wur.nl>

Hi Jordan,

Nice reproducible example.

The following should work:
rc <- mask(rc,r) # instead of mask[rc,r]

Only if your raster's are very large you'll have to watch out overusing
the RAM:
If possible in that case you could avoid creating new data (doubling data)
and potentially use the following only for specific rows/columns to
extract 
cells, and coordinates:
r <- raster(system.file("external/test.grd", package="raster"))
cells <- cellFromRowColCombine(r, 1:10, 1:10)
xy <- xyFromCell(r, cells)


Hope this helps,
Jan
http://goo.gl/1mBC5F





On 28/08/13 10:02, "Jordan Chamberlin" <jordan.chamberlin at gmail.com> wrote:

>Hi all,
>
>For some processing that I'm doing with raster data, I need to keep
>track of cell centroid coordinate values, and I would like to do this in
>terms of a set of reference rasters which hold cell values, x and y
>coordinates, respectively, for the raster being analyzed. I can do this
>(code below) but my question is: am I going about this in the most
>efficient way? Here is what I'm doing (using a small test raster since
>mine are humongous):
>
>#get test raster
>r <- raster(system.file("external/test.grd", package="raster"))
>
>#make copies which will hold cell identifiers, x & y values
>ry <- rx <- rc <- r
>
>#define raster of cell numbers for the non-NA cells
>rc[] <- seq(1:length(r))
>## for some reason, this is not working:  rc <- mask[rc,r]
>## but this works fine:
>rc[is.na(r)] <-NA
>
>#assign coordinate values to corresponding rasters
>ry[] <- yFromCell(rc, getValues(rc))
>rx[] <- xFromCell(rc, getValues(rc))
>
># stack em up and view
>s <- stack(r,rc,rx,ry)
>names(s) <- c("values", "cell #", "x-coord", "y-coord")
>plot(s)
>
>So this works fine, but I have a feeling there are some shortcuts I'm
>missing.
>
>Thanks for guidance,
>
>Jordan
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dobzhanski at gmail.com  Wed Aug 28 16:49:07 2013
From: dobzhanski at gmail.com (john d)
Date: Wed, 28 Aug 2013 11:49:07 -0300
Subject: [R-sig-Geo] generating coordinates at equal geographical distances
Message-ID: <CAMLNaBahPp+wtAajGiPh1P_ALEkEizTf=a08L76p8a8H9aR-xA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130828/672ba227/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Aug 28 17:04:54 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 28 Aug 2013 16:04:54 +0100
Subject: [R-sig-Geo] generating coordinates at equal geographical
	distances
In-Reply-To: <b25b8665be7141ecb4210ad9f319a24c@EX-0-HT0.lancs.local>
References: <b25b8665be7141ecb4210ad9f319a24c@EX-0-HT0.lancs.local>
Message-ID: <CANVKczPuYvX_pdZULAjA_i0wPqPH+AK8ASKuhV-gJNtK_iCf_Q@mail.gmail.com>

You will find that any two coordinates are equidistant from each other...

 So my suggestion is you need to expand you question a bit more! :)

On Wed, Aug 28, 2013 at 3:49 PM, john d <dobzhanski at gmail.com> wrote:
> Dear all,
>
> I need to generate coordinates that are equidistant, regardless of
> latitude. Any suggestions?
>
> Thanks!
>
> John
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rhonag at gmail.com  Wed Aug 28 17:58:18 2013
From: rhonag at gmail.com (Rhona Govender)
Date: Wed, 28 Aug 2013 08:58:18 -0700
Subject: [R-sig-Geo] Global mapping of multiple categories by colour
Message-ID: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>

Dear All,

Sorry for cross posting, I have been kindly directed here by the r help group.

I have to make a last minute global map. I'm trying to do this in r,
but I am a beginner.

I have a global dataset of dependent values (eg. rate of common cold)
for 100/240 countries/offshore territories. I have a predictor
variable (eg. Human development index or HDI). What I would like to do
is colour a global map by HDI grouping (low [0-0.5], medium[0.51-0.7],
high[0.71-1.0]). So for countries that I have data for, if it is low
HDI it would be colour1, medium colour 2, low colour3. For countries
with no data they will be a fourth colour (grey).

Additionally, some small island nations will be too small to be
visualized. Is there a way to manually increase the size of the
colouration to be visible on a map at the global scale?

My data is as such (where blanks are no data):

Country HDI Colds Albania 0.42 .72 Austria 0.89 China 0 .76 .12

I have found this example to try and build off:

http://stackoverflow.com/questions/11225343/how-to-create-a-world-map-in-r-with-specific-countries-filled-in?rq=1

To change this example, I imported my csv, picked out the columns I
wanted (country ISO3 codes [country] and the hdi predictor[hdi]) and
named them(country=data3$country) then and made it into a data frame
(data3).

I have this code I am confused with:

malMap <- joinCountryData2Map(dF = "data3", joinCode = "ISO3",
nameJoinColumn = "country")

# This will join your malDF data.frame to the country map data

mapCountryData(malMap, nameColumnToPlot="hdi", catMethod =
"categorical", missingCountryCol = gray(.8))

head(data3)

country   hdi
              0
              0
              0
  ASM     0.827
              0
              0

Firstly I get this error as it won't match the country names up:

"Error in joinCountryData2Map(dF = "data3", joinCode = "ISO3",
nameJoinColumn = "country") :  your chosen nameJoinColumn :'country'
seems not to exist in your data, columns ="

How can I change this sample code to colour the three levels of hdi?
Is it possible with this code? Also, is it possible to manually make
the small island nations bigger as they will not appear at this scale.

I'm sorry this is so long. Any help would be greatly appreciated.

Cheers,

Sarah


From 08389741 at stu.mmu.ac.uk  Wed Aug 28 18:39:44 2013
From: 08389741 at stu.mmu.ac.uk (Tom Higginbottom)
Date: Wed, 28 Aug 2013 09:39:44 -0700 (PDT)
Subject: [R-sig-Geo] Multiple time-series analysis
Message-ID: <1377707984650-7584485.post@n2.nabble.com>

Hello,

I am attempting to implement three trend techniques: linear, Mann Kendall
and Theil Senn, on a raster brick consisting of 20 rasters derived from some
statistical analysis.

I have complete the MK and linear trends, although the MK values seem
bizares as there are no negaitive slopes which would be expected. However, I
can not figure out how to implement a Theil Senn trend.

Any help would be much appreciated.

My code so far is below, not i am still new to r and have pulled section of
coding from mailing posts so it may not be the most refined method


#Generate the raster brick
list <- list.files(path ="G:\\gwr_rst\\", pattern = "*.rst$", all.files =
FALSE, full.names = TRUE, recursive = FALSE, ignore.case =
FALSE,include.dirs = FALSE, no.. = FALSE)

stack <- stack(lapply(list, raster))

brick <-brick(stack_80)

#Trend no breaks using the greenbrown package
Linear<- TrendRaster(Brick, start=c(1983, 1),  method="AAT", breaks=0)

#Gridded data Mann Kendall trend 

> myraster.mk <- calc(brick,function(x){MannKendall(rev(x))$sl}) 




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Multiple-time-series-analysis-tp7584485.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From macqueen1 at llnl.gov  Wed Aug 28 19:19:45 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 28 Aug 2013 17:19:45 +0000
Subject: [R-sig-Geo] Global mapping of multiple categories by colour
In-Reply-To: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521910D41F3F4@PRDEXMBX-08.the-lab.llnl.gov>

Rhona,

I am completely unfamiliar with the package and functions you're using,
so I had supposed you would use functions from the sp and rgdal packages.
For what it's worth, I'll give an example below.

However, probably you will need to share at least a representative portion
of your data in order for people to give useful help. One way is to
include the ouput of the dput() function. In your case, probably,
  dput(data3)
or perhaps
  dput(head(data3))
if data3 is big.


Here is an example that requires that your countries be stored in a
SpatialPolygonsDataFrame. In this example, first we create some arbitrary
polygons, then plot them. It's not complete solution for your situation,
but is, I hope, analogous.

Probably, my email software will mangle the line lengths.

## example data, creating a SpatialPolygonsDataFrame
## copied from help('over',package='sp')
r1 = cbind(c(180114, 180553, 181127, 181477, 181294, 181007, 180409,
 c(332349, 332057, 332342, 333250, 333558, 333676,   180162, 180114),
                     332618, 332413, 332349))
r2 = cbind(c(180042, 180545, 180553, 180314, 179955, 179142, 179437,
  179524, 179979, 180042), c(332373, 332026, 331426, 330889, 330683,
                             331133, 331623, 332152, 332357, 332373))
r3 = cbind(c(179110, 179907, 180433, 180712, 180752, 180329, 179875,
  179668, 179572, 179269, 178879, 178600, 178544, 179046, 179110),
  c(331086, 330620, 330494, 330265, 330075, 330233, 330336, 330004,
    329783, 329665, 329720, 329933, 330478, 331062, 331086))
r4 = cbind(c(180304, 180403,179632,179420,180304),
  c(332791, 333204, 333635, 333058, 332791))
     
sr1=Polygons(list(Polygon(r1)),"r1")
sr2=Polygons(list(Polygon(r2)),"r2")
sr3=Polygons(list(Polygon(r3)),"r3")
sr4=Polygons(list(Polygon(r4)),"r4")
sr=SpatialPolygons(list(sr1,sr2,sr3,sr4))
srdf=SpatialPolygonsDataFrame(sr, data.frame(cbind(1:4,5:2),
row.names=c("r1","r2","r3","r4")))


## now plot
plot(srdf)
plot(srdf,col=1:4)




-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 8/28/13 8:58 AM, "Rhona Govender" <rhonag at gmail.com> wrote:

>Dear All,
>
>Sorry for cross posting, I have been kindly directed here by the r help
>group.
>
>I have to make a last minute global map. I'm trying to do this in r,
>but I am a beginner.
>
>I have a global dataset of dependent values (eg. rate of common cold)
>for 100/240 countries/offshore territories. I have a predictor
>variable (eg. Human development index or HDI). What I would like to do
>is colour a global map by HDI grouping (low [0-0.5], medium[0.51-0.7],
>high[0.71-1.0]). So for countries that I have data for, if it is low
>HDI it would be colour1, medium colour 2, low colour3. For countries
>with no data they will be a fourth colour (grey).
>
>Additionally, some small island nations will be too small to be
>visualized. Is there a way to manually increase the size of the
>colouration to be visible on a map at the global scale?
>
>My data is as such (where blanks are no data):
>
>Country HDI Colds Albania 0.42 .72 Austria 0.89 China 0 .76 .12
>
>I have found this example to try and build off:
>
>http://stackoverflow.com/questions/11225343/how-to-create-a-world-map-in-r
>-with-specific-countries-filled-in?rq=1
>
>To change this example, I imported my csv, picked out the columns I
>wanted (country ISO3 codes [country] and the hdi predictor[hdi]) and
>named them(country=data3$country) then and made it into a data frame
>(data3).
>
>I have this code I am confused with:
>
>malMap <- joinCountryData2Map(dF = "data3", joinCode = "ISO3",
>nameJoinColumn = "country")
>
># This will join your malDF data.frame to the country map data
>
>mapCountryData(malMap, nameColumnToPlot="hdi", catMethod =
>"categorical", missingCountryCol = gray(.8))
>
>head(data3)
>
>country   hdi
>              0
>              0
>              0
>  ASM     0.827
>              0
>              0
>
>Firstly I get this error as it won't match the country names up:
>
>"Error in joinCountryData2Map(dF = "data3", joinCode = "ISO3",
>nameJoinColumn = "country") :  your chosen nameJoinColumn :'country'
>seems not to exist in your data, columns ="
>
>How can I change this sample code to colour the three levels of hdi?
>Is it possible with this code? Also, is it possible to manually make
>the small island nations bigger as they will not appear at this scale.
>
>I'm sorry this is so long. Any help would be greatly appreciated.
>
>Cheers,
>
>Sarah
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dobzhanski at gmail.com  Wed Aug 28 19:27:25 2013
From: dobzhanski at gmail.com (john d)
Date: Wed, 28 Aug 2013 14:27:25 -0300
Subject: [R-sig-Geo] generating coordinates at equal geographical
	distances
In-Reply-To: <CANVKczPuYvX_pdZULAjA_i0wPqPH+AK8ASKuhV-gJNtK_iCf_Q@mail.gmail.com>
References: <b25b8665be7141ecb4210ad9f319a24c@EX-0-HT0.lancs.local>
	<CANVKczPuYvX_pdZULAjA_i0wPqPH+AK8ASKuhV-gJNtK_iCf_Q@mail.gmail.com>
Message-ID: <CAMLNaBbX4jQqzqMhiyRpMFejuj9hmOdbP08ObPbKjoWVjsDP7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130828/25f836ac/attachment.pl>

From Dominik.Schneider at colorado.edu  Wed Aug 28 20:41:37 2013
From: Dominik.Schneider at colorado.edu (dschneiderch)
Date: Wed, 28 Aug 2013 11:41:37 -0700 (PDT)
Subject: [R-sig-Geo] plot raster: how to eliminate surrounding white
	space?
In-Reply-To: <CAG4NReJt+rzL6u58uc3GqaHtj-KQjTTT30x_eDmhcWg6eGw7QA@mail.gmail.com>
References: <CAG4NReLxHrmAS4TJn5iWNzc=V4g0TwN_=Tyhd2mCNMAt6n9Zeg@mail.gmail.com>
	<CAAcGz9-4CMLTjFAxHwjEs4V9HG6OyVr13esKHQsHFLWAWzvbHA@mail.gmail.com>
	<CAG4NReJPT=dn5GBe0LFujNBV9fHxg_FGmzdaiDONCt7xzRrg8Q@mail.gmail.com>
	<CAMLL7bnH-s46RCVV=L1-bdpmA42wWdiC-8ZPCiyz9ajaKA4-cA@mail.gmail.com>
	<CAG4NReJt+rzL6u58uc3GqaHtj-KQjTTT30x_eDmhcWg6eGw7QA@mail.gmail.com>
Message-ID: <1377715297130-7584488.post@n2.nabble.com>

In the past I've plotted it, adjusted the window by hand until the white
space is gone and then used dev.size() to get the dimensions. In your script
you can then specify those dimensions. Not a very practical way to do it but
if you are plotting several images of the same size it helps.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/plot-raster-how-to-eliminate-surrounding-white-space-tp7584473p7584488.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Aug 28 22:33:01 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Aug 2013 22:33:01 +0200
Subject: [R-sig-Geo] Global mapping of multiple categories by colour
In-Reply-To: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>
References: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308282219540.25273@reclus.nhh.no>

On Wed, 28 Aug 2013, Rhona Govender wrote:

> Dear All,
>
> Sorry for cross posting, I have been kindly directed here by the r help group.
>
> I have to make a last minute global map. I'm trying to do this in r,
> but I am a beginner.
>
> I have a global dataset of dependent values (eg. rate of common cold)
> for 100/240 countries/offshore territories. I have a predictor
> variable (eg. Human development index or HDI). What I would like to do
> is colour a global map by HDI grouping (low [0-0.5], medium[0.51-0.7],
> high[0.71-1.0]). So for countries that I have data for, if it is low
> HDI it would be colour1, medium colour 2, low colour3. For countries
> with no data they will be a fourth colour (grey).
>
> Additionally, some small island nations will be too small to be
> visualized. Is there a way to manually increase the size of the
> colouration to be visible on a map at the global scale?
>
> My data is as such (where blanks are no data):
>
> Country HDI Colds Albania 0.42 .72 Austria 0.89 China 0 .76 .12
>
> I have found this example to try and build off:
>
> http://stackoverflow.com/questions/11225343/how-to-create-a-world-map-in-r-with-specific-countries-filled-in?rq=1

This refers briefly to the rworldmap package. Go rather to the package 
page:

http://cran.r-project.org/web/packages/rworldmap/index.html

and review the vignettes and the reference manual. Try to get the examples 
in the manual to work, then try to make your data look like the 
data objects in the examples. See also Andy South's useR! 2013 tutorial:

http://www.edii.uclm.es/~useR-2013//Tutorials/South.html

and his site: http://andysouth.co.uk/ with links to tutorial and talk 
materials.

Summary: make an example work with Andy's data; make your data look like 
his; re-run the example with your data.

Hope this helps,

Roger

>
> To change this example, I imported my csv, picked out the columns I
> wanted (country ISO3 codes [country] and the hdi predictor[hdi]) and
> named them(country=data3$country) then and made it into a data frame
> (data3).
>
> I have this code I am confused with:
>
> malMap <- joinCountryData2Map(dF = "data3", joinCode = "ISO3",
> nameJoinColumn = "country")
>
> # This will join your malDF data.frame to the country map data
>
> mapCountryData(malMap, nameColumnToPlot="hdi", catMethod =
> "categorical", missingCountryCol = gray(.8))
>
> head(data3)
>
> country   hdi
>              0
>              0
>              0
>  ASM     0.827
>              0
>              0
>
> Firstly I get this error as it won't match the country names up:
>
> "Error in joinCountryData2Map(dF = "data3", joinCode = "ISO3",
> nameJoinColumn = "country") :  your chosen nameJoinColumn :'country'
> seems not to exist in your data, columns ="
>
> How can I change this sample code to colour the three levels of hdi?
> Is it possible with this code? Also, is it possible to manually make
> the small island nations bigger as they will not appear at this scale.
>
> I'm sorry this is so long. Any help would be greatly appreciated.
>
> Cheers,
>
> Sarah
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Thu Aug 29 00:29:00 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 29 Aug 2013 08:29:00 +1000
Subject: [R-sig-Geo] generating coordinates at equal geographical
	distances
In-Reply-To: <CAMLNaBbX4jQqzqMhiyRpMFejuj9hmOdbP08ObPbKjoWVjsDP7Q@mail.gmail.com>
References: <b25b8665be7141ecb4210ad9f319a24c@EX-0-HT0.lancs.local>
	<CANVKczPuYvX_pdZULAjA_i0wPqPH+AK8ASKuhV-gJNtK_iCf_Q@mail.gmail.com>
	<CAMLNaBbX4jQqzqMhiyRpMFejuj9hmOdbP08ObPbKjoWVjsDP7Q@mail.gmail.com>
Message-ID: <CAAcGz99CgQY+54C=3jyXCDwxA7c-zmJk72HLCaw4zOuCAqRFDA@mail.gmail.com>

There are many pathways to this, but you could use a map projection
that provides the properties you want and sample points there, then
project that back to longitude latitude.

Here's a dummy example, I just found an equal area projection by
stumbling through spatialreference.org, you should look into this more
for your purposes. I use spsample in the sp package to generate the
points, but what you use here really depends on what kind of points
you want, I ignored land vs. sea but you could easily adapt this to
the land only.

library(maptools)

data(wrld_simpl)
w <- subset(wrld_simpl, NAME %in% c("Canada", "Mexico", "United States"))
library(rgdal)
proj <- "+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997
+b=6370997 +units=m +no_defs"
w <- spTransform(subset(wrld_simpl, NAME %in% c("Canada", "Mexico",
"United States")), CRS(proj))

## create an extent object to sample from, rather than just the land
## (just use the "w" object if you want the points to be only on land)
library(raster)
bbpoly <- as(extent(w), "SpatialPolygons")
proj4string(bbpoly) <- CRS(proj4string(w))

x <- spsample(bbpoly, n = 2000, type = "hexagonal")
pts <- spTransform(x, CRS(proj4string(wrld_simpl)))
plot(pts)
plot(as(wrld_simpl, "SpatialLines"), add = TRUE, col = "dodgerblue")


On Thu, Aug 29, 2013 at 3:27 AM, john d <dobzhanski at gmail.com> wrote:
> Ok, I'll be more explicit :)
>
> If I want to generate random coordinates across North America by uniformly
> sampling latitudes and longitudes, the geographical distance between these
> coordinates would decrease towards higher latitudes. I'd like to be able to
> generate coordinates (e.g. a grid) such that the geographical distances
> between coordinates would be constant regardless of latitude.
>
>
>
> On Wed, Aug 28, 2013 at 12:04 PM, Barry Rowlingson <
> b.rowlingson at lancaster.ac.uk> wrote:
>
>> You will find that any two coordinates are equidistant from each other...
>>
>>  So my suggestion is you need to expand you question a bit more! :)
>>
>> On Wed, Aug 28, 2013 at 3:49 PM, john d <dobzhanski at gmail.com> wrote:
>> > Dear all,
>> >
>> > I need to generate coordinates that are equidistant, regardless of
>> > latitude. Any suggestions?
>> >
>> > Thanks!
>> >
>> > John
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From pan.sapiens.it at gmail.com  Thu Aug 29 12:46:24 2013
From: pan.sapiens.it at gmail.com (Pan)
Date: Thu, 29 Aug 2013 11:46:24 +0100
Subject: [R-sig-Geo] Import custom projection in R
In-Reply-To: <alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>
References: <521C45D3.2030909@gmail.com>
	<alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>
Message-ID: <521F2680.10804@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130829/b4090046/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Aug 29 13:21:18 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 29 Aug 2013 12:21:18 +0100
Subject: [R-sig-Geo] Import custom projection in R
In-Reply-To: <d7cdcb77800a4e37b8b3dfad8662fd58@EX-1-HT0.lancs.local>
References: <521C45D3.2030909@gmail.com>
	<alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>
	<d7cdcb77800a4e37b8b3dfad8662fd58@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPCHROBvrtaO5bA93J-B+XJYF71dc0ea15nuoeakWJcMQ@mail.gmail.com>

On Thu, Aug 29, 2013 at 11:46 AM, Pan <pan.sapiens.it at gmail.com> wrote:
> Dear Roger,
>
> Thank you for your valuable suggestions. First, I tried to enter my.proj as PROJ.4 string:
>
>   > MyProj.PROJ.4<-"+proj=UTM +datum=WGS84 +lon_0=17 +x_0=600000 +y_0=10000000"
>   >
>   > library(rgdal)
>   >
>   > CRS("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000")
> Error in CRS("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000") :
>     unknown projection id
>   >
>   > CRS(paste("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000"))
> Error in CRS(paste("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000")) :
>     unknown projection id

proj4 strings are case-sensitive:

 > p="+proj=UTM +datum=WGS84 +lon_0=17 +x_0=600000 +y_0=10000000"
 > CRS(p)
 Error in CRS(p) : unknown projection id
 > p="+proj=utm +datum=WGS84 +lon_0=17 +x_0=600000 +y_0=10000000"
 > CRS(p)
 CRS arguments:
  +proj=utm +datum=WGS84 +lon_0=17 +x_0=600000 +y_0=10000000 +ellps=WGS84
 +towgs84=0,0,0


> I tried to read a projected shapefile and retrieve the string from it because I'm not particularly familiar with PROJ.4 and I was not sure
> whether the string was correct.

 Just open the .prj file in a text editor (such as notepad on Windows)
- it is plain text.

Barry


From Roger.Bivand at nhh.no  Thu Aug 29 14:26:24 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Aug 2013 14:26:24 +0200
Subject: [R-sig-Geo] Import custom projection in R
In-Reply-To: <521F2680.10804@gmail.com>
References: <521C45D3.2030909@gmail.com>
	<alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>
	<521F2680.10804@gmail.com>
Message-ID: <alpine.LRH.2.03.1308291416170.27591@reclus.nhh.no>

On Thu, 29 Aug 2013, Pan wrote:

> Dear Roger,
>
> Thank you for your valuable suggestions. First, I tried to enter my.proj as 
> PROJ.4 string:
>
> > MyProj.PROJ.4<-"+proj=UTM +datum=WGS84 +lon_0=17 +x_0=600000 
> +y_0=10000000"
> >
> > library(rgdal)
> >
> > CRS("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000")
> Error in CRS("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000") :
>   unknown projection id
> >
> > CRS(paste("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000"))
> Error in CRS(paste("+proj=UTM +lon_0=17 +x_0=600000 +y_0=10000000")) :
>   unknown projection id
>
> I tried to read a projected shapefile and retrieve the string from it because 
> I'm not particularly familiar with PROJ.4 and I was not sure
> whether the string was correct.

As Barry pointed out, +proj=utm is correct for Universal Transverse 
Mercator. But +proj=utm should be accompanied by +zone= and optionally 
+south in order to place the projection - you use +lon_0=, +x= and +y=, 
which I would expect to see rather used with +proj=tmerc, with +lat_0= to 
fix the northings.

> The function couldn't open the file:
>
> >
> > inputdir<-"C:/my work directory/"
> >
> > OGRSpatialRef(dsn=paste(inputdir), "my.proj")
> Error in OGRSpatialRef(dsn = paste(inputdir), "my.proj") :
>   Cannot open file
>
> although the directory is correct:
>
> > list.files(path=paste(inputdir), pattern="prj$")
> [1] "myproj.prj"

missing "."? No idea, maybe setwd("C:/my work directory/"), then dsn="."? 
As Barry said, open the offending file in notepad and scroll across to 
find the values.

Roger

> > list.files(path=paste(inputdir), pattern="^my.proj")
> [1] "my.proj.dbf" "my.proj.prj" "my.proj.sbn" "my.proj.sbx"
> "my.proj.shp" "my.proj.shx"
>
> The reason why readOGR() and similar functions can't read my file keeps being 
> a mystery but I will try to resolve it later.
> My current priority is to save the projection as object of the CRS-class and 
> have it available to transform coordinates, project spatial objects,
> etc. The on-line documentation led me always to the same point (i.e. enter it 
> as a PROJ.4 string) but I didn't manage to do it.
>
> Do you have any suggestion for me?
>
> Thanks in advance
>
> Ivan
>
> On 27.08.2013 09:53, Roger Bivand wrote:
>> On Tue, 27 Aug 2013, Pan wrote:
>> 
>>> Dear all,
>>> 
>>> I'm quite new to spatial data processing in R and I'm getting entangled in 
>>> projection systems, I would appreciate your support to find a solution. I 
>>> need to import my custom projection in R (my.proj), create projected 
>>> spatial objects (I usedSpatialPointsDataFrame {sp}) and export them as
>>> shapefiles (I usedwritePointsShape {maptools}). As I said, the first step 
>>> is particularly tricky to me!
>>> 
>>> I tried to import the projection both asmy.proj.shp andmy.proj.prj 
>>> usingreadOGR() {rgdal} but the result was just the same: it didn't work!
>>> 
>>> As you see below I've been trying different solutions to make the function 
>>> work but I still didn't understand what I'm supposed to assign to dsn and 
>>> layer:
>> 
>> No, reading (and re-reading) the help pages and their references may help. 
>> You have not explained why you need to read your "custom" projection. You 
>> could simply enter it as a PROJ.4 string. You appear to think that you 
>> should read a shapefile (including its optional *.prj file component) to 
>> retreive the string. If you don't need to do this, and can write it as a 
>> string in R, do that - CRS() of your string with rgdal loaded will check 
>> for obvious errors. If you have a representation that OGR recognises, such 
>> as a shapefile, you can say for example:
>> 
>> library(rgdal)
>> dsn <- system.file("vectors", package = "rgdal")[1]
>> # to access the vector examples provided
>> OGRSpatialRef(dsn, "cities")
>> 
>> Here, the dsn= argument is the directory containing the shapefile 
>> components, and cities is a layer; here, you can check that there are files 
>> ending in "prj", and for files starting with "cities":
>> 
>> list.files(path=dsn, pattern="prj$")
>> list.files(path=dsn, pattern="^cities")
>> 
>> Do check that the files are where you think they are, the most frequent 
>> cause of the error message you see being that they are somewhere else. Once 
>> you are done, use writeOGR(), not writePointShape() which is deprecated and 
>> which discards your coordinate reference system anyway, so defeating the 
>> point of your exercise.
>> 
>> Hope this clarifies,
>> 
>> Roger
>> 
>>> 
>>> inputdir<-"C:/my working directory/"
>>> 
>>> library(rgdal)
>>>
>>>  > Test<-readOGR(dsn=paste(inputdir),layer="my.proj")
>>> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv 
>>> = use_iconv) :
>>>    Cannot open file
>>>
>>>  > Test<-readOGR(dsn=paste(inputdir,"my.proj",sep=""),layer="my.proj.shp")
>>> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv 
>>> = use_iconv) :
>>>    Cannot open file
>>>
>>>  > Test<-readOGR(dsn="my.proj",layer="my.proj.shp")
>>> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv 
>>> = use_iconv) :
>>>    Cannot open file
>>> 
>>> also the attempts withogrInfo()haven't been successful.
>>> 
>>> So I have two questions on this matter. How should I handle the issue 
>>> withreadOGR()? Is there any other way (possibly easy) to import a custom 
>>> projection in R?
>>> 
>>> Note: I'm using R 2.15.2 and rgdal 0.8-10.
>>> 
>>> Thanks in advance
>>> 
>>> Ivan
>>> 
>>>
>>>     [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pan.sapiens.it at gmail.com  Thu Aug 29 16:40:28 2013
From: pan.sapiens.it at gmail.com (Pan)
Date: Thu, 29 Aug 2013 15:40:28 +0100
Subject: [R-sig-Geo] Import custom projection in R
In-Reply-To: <alpine.LRH.2.03.1308291416170.27591@reclus.nhh.no>
References: <521C45D3.2030909@gmail.com>
	<alpine.LRH.2.03.1308271040590.18255@reclus.nhh.no>
	<521F2680.10804@gmail.com>
	<alpine.LRH.2.03.1308291416170.27591@reclus.nhh.no>
Message-ID: <521F5D5C.7040607@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130829/23ab9d13/attachment.pl>

From pbidanset at gmail.com  Fri Aug 30 01:26:07 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Thu, 29 Aug 2013 19:26:07 -0400
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
Message-ID: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130829/deca6ecf/attachment.pl>

From luispelayo84 at gmail.com  Fri Aug 30 02:56:30 2013
From: luispelayo84 at gmail.com (Luis Guerra)
Date: Fri, 30 Aug 2013 02:56:30 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
Message-ID: <CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/fdf92425/attachment.pl>

From pbidanset at gmail.com  Fri Aug 30 03:44:58 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Thu, 29 Aug 2013 21:44:58 -0400
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
Message-ID: <CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130829/3e32ed29/attachment.pl>

From luispelayo84 at gmail.com  Fri Aug 30 09:04:14 2013
From: luispelayo84 at gmail.com (Luis Guerra)
Date: Fri, 30 Aug 2013 09:04:14 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
Message-ID: <CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/a67d448a/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug 30 09:37:14 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Aug 2013 09:37:14 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>

Paul, Luis,

I suspect that your speculations are completely wrong-headed. Please 
provide a reproducible example with a built-in data set, so that there is 
at least minimal clarity in what you are guessing. Note in addition that 
GWR as a technique should not be used for anything other than exploration 
of possible mis-specification in the underlying model with the given data, 
as patterning in coefficients is induced by GWR for simulated covariates 
with no pattern.

Roger

On Fri, 30 Aug 2013, Luis Guerra wrote:

>> Thank you Luis. When calibrating the adaptive model, using adapt=t in the
>> bandwidth selection created the proportion you speak of, which then allowed
>> me to create a bandwidth matrix using gwr.adapt. However, this has not
>> worked for me with holdout samples. Have you had success in this regard?
>>
> Now I get what you mean. Let's show an example:
>
> bw <- gwr.sel(var ~ var1, data=yourdata, adapt=TRUE)
> m <- gwr(var~var1, data=yourdata, adapt=bw, fit.points=newdata)
>
> So an adaptative bandwidth (bw) is calculated based on"yourdata", while you
> are fitting "newdata" later on using that previously found bw. I had not
> thought about it previously. Let's see whether someone else can help you
> (us).
>
>
>> I do not know the intended influence of these "fit.points". I would think
>> that new localized regressions are not calculated, as we're testing the
>> model and previous data points' ability to predict for these new ones, but
>> I could be wrong. My current method, however, is producing much poorer
>> results with the holdouts, which I am fairly sure is related to my
>> inability to incorporate the new points necessary bandwidths.
>>
> Coming back to the previously created example, imagine that "newdata" is a
> single point that you want to fit. Imagine now that "yourdata" is a sample
> with 1000 cases. Then you are getting 1000 models with 1000 different
> intercepts and 1000 different beta values to adjust var1, rigth? Which of
> all these parameters do you use for fitting "newdata"? And something else,
> what would happen with "newdata" if it is enough far away from "yourdata"
> and we would be using a fixed bandwidth?
>
>
>
>
>
>
>
>> On Aug 29, 2013 8:56 PM, "Luis Guerra" <luispelayo84 at gmail.com> wrote:
>>
>>> Dear Paul,
>>>
>>> I am dealing with this kind of problems right now, and if I am not wrong,
>>> when you want to apply an adaptative bandwidth, you should introduce a
>>> value for the "adapt" parameter instead of for the "bandwidth" parameter.
>>> This value will be between 0 and 1 and indicates the proportion of cases
>>> around your regression point that should be included to estimate each local
>>> model. So depending on the amount of points around each case, the model
>>> will use a different bandwidth for each point to be fitted.
>>>
>>> Related to your question, do you know what is the influence of the data
>>> introduced in the "data" parameter to the data to be fitted (introduced in
>>> the "fit.points" parameter)? I mean, you have to obtain new local models
>>> (one for each point to be fitted), so I do not understand whether the
>>> "data" parameter is used somehow...
>>>
>>> Best regards,
>>>
>>> Luis
>>>
>>>
>>> On Fri, Aug 30, 2013 at 1:26 AM, Paul Bidanset <pbidanset at gmail.com>wrote:
>>>
>>>> Hi Folks,
>>>>
>>>> I was curious if anyone has had experience applying an SPGWR model with
>>>> an
>>>> adaptive bandwidth matrix to a holdout or validation sample. I am using
>>>> the
>>>> "fit.points" command, which does not seem to allow for a new bandwidth
>>>> calibrated around the holdout samples XY coordinates. Any direction would
>>>> be greatly appreciated.  I am also open to other viable methods.
>>>>
>>>> Cheers,
>>>>
>>>> Paul
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From by-beiyao at hotmail.com  Fri Aug 30 11:13:59 2013
From: by-beiyao at hotmail.com (yaobei)
Date: Fri, 30 Aug 2013 09:13:59 +0000
Subject: [R-sig-Geo] Questions of bandwidth in pcf() function
Message-ID: <BLU169-W92CF41345833FA2D23E480E0350@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/009879cd/attachment.pl>

From pbidanset at gmail.com  Fri Aug 30 14:56:31 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Fri, 30 Aug 2013 08:56:31 -0400
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
Message-ID: <CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/30f5d356/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug 30 15:01:50 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Aug 2013 15:01:50 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
	<CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>

Provide a reproducible code example of your problem using a built in data 
set. No reproducible example, no response, as I cannot guess (and likely 
nobody else can either) what your specific misunderstanding is. Code using 
for example the Georgia data set in the package. You seem to be assuming 
that you understand how GWR works, I don't think that you do, so you have 
to show what you mean in code.

Roger

On Fri, 30 Aug 2013, Paul Bidanset wrote:

> Roger,
>
> I think all I would like to know is if it is possible to apply a calibrated
> GWR model to a hold-out sample, and if so, what the most accurate way to do
> so is. I understand the pitfalls of GWR but would like to learn as much as
> I can before progressing to the next spatial methodology I learn in R.
>
>
> On Fri, Aug 30, 2013 at 3:37 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> Paul, Luis,
>>
>> I suspect that your speculations are completely wrong-headed. Please
>> provide a reproducible example with a built-in data set, so that there is
>> at least minimal clarity in what you are guessing. Note in addition that
>> GWR as a technique should not be used for anything other than exploration
>> of possible mis-specification in the underlying model with the given data,
>> as patterning in coefficients is induced by GWR for simulated covariates
>> with no pattern.
>>
>> Roger
>>
>>
>> On Fri, 30 Aug 2013, Luis Guerra wrote:
>>
>>  Thank you Luis. When calibrating the adaptive model, using adapt=t in the
>>>> bandwidth selection created the proportion you speak of, which then
>>>> allowed
>>>> me to create a bandwidth matrix using gwr.adapt. However, this has not
>>>> worked for me with holdout samples. Have you had success in this regard?
>>>>
>>>>  Now I get what you mean. Let's show an example:
>>>
>>> bw <- gwr.sel(var ~ var1, data=yourdata, adapt=TRUE)
>>> m <- gwr(var~var1, data=yourdata, adapt=bw, fit.points=newdata)
>>>
>>> So an adaptative bandwidth (bw) is calculated based on"yourdata", while
>>> you
>>> are fitting "newdata" later on using that previously found bw. I had not
>>> thought about it previously. Let's see whether someone else can help you
>>> (us).
>>>
>>>
>>>  I do not know the intended influence of these "fit.points". I would think
>>>> that new localized regressions are not calculated, as we're testing the
>>>> model and previous data points' ability to predict for these new ones,
>>>> but
>>>> I could be wrong. My current method, however, is producing much poorer
>>>> results with the holdouts, which I am fairly sure is related to my
>>>> inability to incorporate the new points necessary bandwidths.
>>>>
>>>>  Coming back to the previously created example, imagine that "newdata"
>>> is a
>>> single point that you want to fit. Imagine now that "yourdata" is a sample
>>> with 1000 cases. Then you are getting 1000 models with 1000 different
>>> intercepts and 1000 different beta values to adjust var1, rigth? Which of
>>> all these parameters do you use for fitting "newdata"? And something else,
>>> what would happen with "newdata" if it is enough far away from "yourdata"
>>> and we would be using a fixed bandwidth?
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>  On Aug 29, 2013 8:56 PM, "Luis Guerra" <luispelayo84 at gmail.com> wrote:
>>>>
>>>>  Dear Paul,
>>>>>
>>>>> I am dealing with this kind of problems right now, and if I am not
>>>>> wrong,
>>>>> when you want to apply an adaptative bandwidth, you should introduce a
>>>>> value for the "adapt" parameter instead of for the "bandwidth"
>>>>> parameter.
>>>>> This value will be between 0 and 1 and indicates the proportion of cases
>>>>> around your regression point that should be included to estimate each
>>>>> local
>>>>> model. So depending on the amount of points around each case, the model
>>>>> will use a different bandwidth for each point to be fitted.
>>>>>
>>>>> Related to your question, do you know what is the influence of the data
>>>>> introduced in the "data" parameter to the data to be fitted (introduced
>>>>> in
>>>>> the "fit.points" parameter)? I mean, you have to obtain new local models
>>>>> (one for each point to be fitted), so I do not understand whether the
>>>>> "data" parameter is used somehow...
>>>>>
>>>>> Best regards,
>>>>>
>>>>> Luis
>>>>>
>>>>>
>>>>> On Fri, Aug 30, 2013 at 1:26 AM, Paul Bidanset <pbidanset at gmail.com
>>>>>> wrote:
>>>>>
>>>>>  Hi Folks,
>>>>>>
>>>>>> I was curious if anyone has had experience applying an SPGWR model with
>>>>>> an
>>>>>> adaptive bandwidth matrix to a holdout or validation sample. I am using
>>>>>> the
>>>>>> "fit.points" command, which does not seem to allow for a new bandwidth
>>>>>> calibrated around the holdout samples XY coordinates. Any direction
>>>>>> would
>>>>>> be greatly appreciated.  I am also open to other viable methods.
>>>>>>
>>>>>> Cheers,
>>>>>>
>>>>>> Paul
>>>>>>
>>>>>>         [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________**_________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ludmilarattis at gmail.com  Fri Aug 30 15:57:28 2013
From: ludmilarattis at gmail.com (Ludmila Rattis)
Date: Fri, 30 Aug 2013 10:57:28 -0300
Subject: [R-sig-Geo] error - converting latlong to utm
Message-ID: <CAKWwe7-eQG+eqGBH-NBmKd3UZoC2STex_8q_M1G5pwYD++gXiQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/9b17f509/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug 30 16:01:42 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Aug 2013 16:01:42 +0200
Subject: [R-sig-Geo] error - converting latlong to utm
In-Reply-To: <CAKWwe7-eQG+eqGBH-NBmKd3UZoC2STex_8q_M1G5pwYD++gXiQ@mail.gmail.com>
References: <CAKWwe7-eQG+eqGBH-NBmKd3UZoC2STex_8q_M1G5pwYD++gXiQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308301600380.550@reclus.nhh.no>

Do not post HTML!

Yes, you have reversed your eastings and northings, so -115N is out of 
bounds for obvious reasons.

Roger

On Fri, 30 Aug 2013, Ludmila Rattis wrote:

> Hi everyone,
>
> I tried to convert five different matrix of geographic coordinates using
> this code, but just two didn't work:
>
> *The code:*
>
> gila_centroid_latlong<-data.frame(Y=gila_centroid[,2],X=gila_centroid[,3])
> coordinates(gila_centroid_latlong) <- ~ X + Y
>
> ##*And the error occurs here:*.
>
> proj4string(gila_centroide_latlong)<- CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84")
>
> Error in `proj4string<-`(`*tmp*`, value = <S4 object of class "CRS">) :
>  Geographical CRS given to non-conformant data: -115.675801995
>
> and for another species...
>
> proj4string(tas_centroide_latlong)<- CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84")
> Error in `proj4string<-`(`*tmp*`, value = <S4 object of class "CRS">) :
>  Geographical CRS given to non-conformant data: 148.34508586
>
> proj4string(gila_centroid_latlong)<- CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84")
> gila_centroid_utm <- spTransform (gila_centroid_latlong, CRS("+proj=utm
> +zone! ellps=WGS84"))
>
>
>
>
> Someone knows what's going on???
>
> I would really appreciate some help.
> Best wishes,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pbidanset at gmail.com  Fri Aug 30 16:07:58 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Fri, 30 Aug 2013 10:07:58 -0400
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
	<CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>
Message-ID: <CAD7wDOAwTqR7CjzkzVZoUp8th6ZekmScf0_01njZVaaz7EtxVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/0f07b3ae/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug 30 16:19:12 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Aug 2013 16:19:12 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CAD7wDOAwTqR7CjzkzVZoUp8th6ZekmScf0_01njZVaaz7EtxVQ@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
	<CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>
	<CAD7wDOAwTqR7CjzkzVZoUp8th6ZekmScf0_01njZVaaz7EtxVQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308301615320.550@reclus.nhh.no>

On Fri, 30 Aug 2013, Paul Bidanset wrote:

> Alrighty then!

Thanks. Now make this your case by subsetting georgia in a way that 
matches your case (all counties west of x?, random set?), and we may be 
getting closer. In the geographical partition, the fit points are all a 
long way from the data points, in the random case, they aren't grouped in 
the same way. You may also need to run the model twice, passing the fitted 
model (fit.points == data.points) through to the next stage, but I'm 
unsure about that.

Roger

>
> Say I create this adaptive bandwidth model using the original dataset
> "georgia"
>
> coords = cbind(georgia$x, georgia$y)
> bwsel <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov +
> PctBlack, data=georgia, adapt=TRUE, coords, gweight=gwr.Gauss, method =
> "aic" )
> bw1 <- gw.adapt(coords, coords, quant=bwsel)
> model1 <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov +
> PctBlack, data=georgia, bw=b1, coords, hatmatrix=T)
> model 1
>
> Suppose I receive an updated data set (same dependent and independent
> variables) and I wish to test the above model1's ability to predict the
> dependent variable of these new data points. If this were a basic lm
> regression in R, I would use the "predict()" command. I wish to better
> understand how I would do so using a GWR model. I found the below
> procedure, but I would like to know first if it is capable accomplishing
> this task, and secondly, if I am specifying it correctly. It seems to me
> that this procedure, as it stands, doesn't take into account the
> appropriate bandwidths for the new data, say, "georgiaNewData"
>
> PredictionsOfNewData  <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB
> + PctPov + PctBlack, data=gSRDF, adapt=TRUE, gweight=gwr.Gauss, method =
> "aic",  bandwidth=bw1,
> predictions=TRUE, fit.points=georgiaNewData)
> PredictionsOfNewData
>
> Thanks in advance for guidance and insight...
>
>
> On Fri, Aug 30, 2013 at 9:01 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> Provide a reproducible code example of your problem using a built in data
>> set. No reproducible example, no response, as I cannot guess (and likely
>> nobody else can either) what your specific misunderstanding is. Code using
>> for example the Georgia data set in the package. You seem to be assuming
>> that you understand how GWR works, I don't think that you do, so you have
>> to show what you mean in code.
>>
>> Roger
>>
>>
>> On Fri, 30 Aug 2013, Paul Bidanset wrote:
>>
>>  Roger,
>>>
>>> I think all I would like to know is if it is possible to apply a
>>> calibrated
>>> GWR model to a hold-out sample, and if so, what the most accurate way to
>>> do
>>> so is. I understand the pitfalls of GWR but would like to learn as much as
>>> I can before progressing to the next spatial methodology I learn in R.
>>>
>>>
>>> On Fri, Aug 30, 2013 at 3:37 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>
>>>  Paul, Luis,
>>>>
>>>> I suspect that your speculations are completely wrong-headed. Please
>>>> provide a reproducible example with a built-in data set, so that there is
>>>> at least minimal clarity in what you are guessing. Note in addition that
>>>> GWR as a technique should not be used for anything other than exploration
>>>> of possible mis-specification in the underlying model with the given
>>>> data,
>>>> as patterning in coefficients is induced by GWR for simulated covariates
>>>> with no pattern.
>>>>
>>>> Roger
>>>>
>>>>
>>>> On Fri, 30 Aug 2013, Luis Guerra wrote:
>>>>
>>>>  Thank you Luis. When calibrating the adaptive model, using adapt=t in
>>>> the
>>>>
>>>>> bandwidth selection created the proportion you speak of, which then
>>>>>> allowed
>>>>>> me to create a bandwidth matrix using gwr.adapt. However, this has not
>>>>>> worked for me with holdout samples. Have you had success in this
>>>>>> regard?
>>>>>>
>>>>>>  Now I get what you mean. Let's show an example:
>>>>>>
>>>>>
>>>>> bw <- gwr.sel(var ~ var1, data=yourdata, adapt=TRUE)
>>>>> m <- gwr(var~var1, data=yourdata, adapt=bw, fit.points=newdata)
>>>>>
>>>>> So an adaptative bandwidth (bw) is calculated based on"yourdata", while
>>>>> you
>>>>> are fitting "newdata" later on using that previously found bw. I had not
>>>>> thought about it previously. Let's see whether someone else can help you
>>>>> (us).
>>>>>
>>>>>
>>>>>  I do not know the intended influence of these "fit.points". I would
>>>>> think
>>>>>
>>>>>> that new localized regressions are not calculated, as we're testing the
>>>>>> model and previous data points' ability to predict for these new ones,
>>>>>> but
>>>>>> I could be wrong. My current method, however, is producing much poorer
>>>>>> results with the holdouts, which I am fairly sure is related to my
>>>>>> inability to incorporate the new points necessary bandwidths.
>>>>>>
>>>>>>  Coming back to the previously created example, imagine that "newdata"
>>>>>>
>>>>> is a
>>>>> single point that you want to fit. Imagine now that "yourdata" is a
>>>>> sample
>>>>> with 1000 cases. Then you are getting 1000 models with 1000 different
>>>>> intercepts and 1000 different beta values to adjust var1, rigth? Which
>>>>> of
>>>>> all these parameters do you use for fitting "newdata"? And something
>>>>> else,
>>>>> what would happen with "newdata" if it is enough far away from
>>>>> "yourdata"
>>>>> and we would be using a fixed bandwidth?
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>  On Aug 29, 2013 8:56 PM, "Luis Guerra" <luispelayo84 at gmail.com> wrote:
>>>>>
>>>>>>
>>>>>>  Dear Paul,
>>>>>>
>>>>>>>
>>>>>>> I am dealing with this kind of problems right now, and if I am not
>>>>>>> wrong,
>>>>>>> when you want to apply an adaptative bandwidth, you should introduce a
>>>>>>> value for the "adapt" parameter instead of for the "bandwidth"
>>>>>>> parameter.
>>>>>>> This value will be between 0 and 1 and indicates the proportion of
>>>>>>> cases
>>>>>>> around your regression point that should be included to estimate each
>>>>>>> local
>>>>>>> model. So depending on the amount of points around each case, the
>>>>>>> model
>>>>>>> will use a different bandwidth for each point to be fitted.
>>>>>>>
>>>>>>> Related to your question, do you know what is the influence of the
>>>>>>> data
>>>>>>> introduced in the "data" parameter to the data to be fitted
>>>>>>> (introduced
>>>>>>> in
>>>>>>> the "fit.points" parameter)? I mean, you have to obtain new local
>>>>>>> models
>>>>>>> (one for each point to be fitted), so I do not understand whether the
>>>>>>> "data" parameter is used somehow...
>>>>>>>
>>>>>>> Best regards,
>>>>>>>
>>>>>>> Luis
>>>>>>>
>>>>>>>
>>>>>>> On Fri, Aug 30, 2013 at 1:26 AM, Paul Bidanset <pbidanset at gmail.com
>>>>>>>
>>>>>>>> wrote:
>>>>>>>>
>>>>>>>
>>>>>>>  Hi Folks,
>>>>>>>
>>>>>>>>
>>>>>>>> I was curious if anyone has had experience applying an SPGWR model
>>>>>>>> with
>>>>>>>> an
>>>>>>>> adaptive bandwidth matrix to a holdout or validation sample. I am
>>>>>>>> using
>>>>>>>> the
>>>>>>>> "fit.points" command, which does not seem to allow for a new
>>>>>>>> bandwidth
>>>>>>>> calibrated around the holdout samples XY coordinates. Any direction
>>>>>>>> would
>>>>>>>> be greatly appreciated.  I am also open to other viable methods.
>>>>>>>>
>>>>>>>> Cheers,
>>>>>>>>
>>>>>>>> Paul
>>>>>>>>
>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>
>>>>>>>> ______________________________****_________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/****listinfo/r-sig-geo<https://stat.ethz.ch/mailman/**listinfo/r-sig-geo>
>>>>>>>> <https://**stat.ethz.ch/mailman/listinfo/**r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________****_________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/****listinfo/r-sig-geo<https://stat.ethz.ch/mailman/**listinfo/r-sig-geo>
>>>>> <https://**stat.ethz.ch/mailman/listinfo/**r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>
>>>>>
>>>>>
>>>>>  --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>>
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pbidanset at gmail.com  Fri Aug 30 16:28:27 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Fri, 30 Aug 2013 10:28:27 -0400
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <alpine.LRH.2.03.1308301615320.550@reclus.nhh.no>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
	<CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>
	<CAD7wDOAwTqR7CjzkzVZoUp8th6ZekmScf0_01njZVaaz7EtxVQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301615320.550@reclus.nhh.no>
Message-ID: <CAD7wDOA8OcC=9R_YOgJL9qU0tAJZRn+Fs7XvpDjzsUHewFseMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/5252f947/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug 30 16:40:05 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Aug 2013 16:40:05 +0200
Subject: [R-sig-Geo] Holdout Sampling Adaptive Bandwidth SPGWR
In-Reply-To: <CAD7wDOA8OcC=9R_YOgJL9qU0tAJZRn+Fs7XvpDjzsUHewFseMQ@mail.gmail.com>
References: <CAD7wDOBoF0+srquZxKGE=mB9RgDZ8SHo0YC8kHV8GH_TQBhq-Q@mail.gmail.com>
	<CANSaWwXvSt1DzpT7nz1rAp21toGr9u88khx=LTFBpsrop=bjrQ@mail.gmail.com>
	<CAD7wDOC8Qo9_xnGr9ibL+wV84NqhBByvmr1zUAcYebLQ+6NbJw@mail.gmail.com>
	<CANSaWwUXNWMGhvkXeCduFxnC4snwwfn1iPsAcfmZaeOfA6XDHA@mail.gmail.com>
	<alpine.LRH.2.03.1308300931430.550@reclus.nhh.no>
	<CAD7wDOBeBRu5dPNuwo642qE_cbdCqBgOERq=SbCnV8E8XkD8LQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301458330.550@reclus.nhh.no>
	<CAD7wDOAwTqR7CjzkzVZoUp8th6ZekmScf0_01njZVaaz7EtxVQ@mail.gmail.com>
	<alpine.LRH.2.03.1308301615320.550@reclus.nhh.no>
	<CAD7wDOA8OcC=9R_YOgJL9qU0tAJZRn+Fs7XvpDjzsUHewFseMQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1308301639050.550@reclus.nhh.no>

On Fri, 30 Aug 2013, Paul Bidanset wrote:

> Thank you. I'd like to subset into a specific county. Should there be
> further partitioning from that level?
>

No idea. Please re-create your scenario by subsetting georgia and the 
coordinates to suit.

Roger

>
> On Fri, Aug 30, 2013 at 10:19 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 30 Aug 2013, Paul Bidanset wrote:
>>
>>  Alrighty then!
>>>
>>
>> Thanks. Now make this your case by subsetting georgia in a way that
>> matches your case (all counties west of x?, random set?), and we may be
>> getting closer. In the geographical partition, the fit points are all a
>> long way from the data points, in the random case, they aren't grouped in
>> the same way. You may also need to run the model twice, passing the fitted
>> model (fit.points == data.points) through to the next stage, but I'm unsure
>> about that.
>>
>> Roger
>>
>>
>>> Say I create this adaptive bandwidth model using the original dataset
>>> "georgia"
>>>
>>> coords = cbind(georgia$x, georgia$y)
>>> bwsel <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov +
>>> PctBlack, data=georgia, adapt=TRUE, coords, gweight=gwr.Gauss, method =
>>> "aic" )
>>> bw1 <- gw.adapt(coords, coords, quant=bwsel)
>>> model1 <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov +
>>> PctBlack, data=georgia, bw=b1, coords, hatmatrix=T)
>>> model 1
>>>
>>> Suppose I receive an updated data set (same dependent and independent
>>> variables) and I wish to test the above model1's ability to predict the
>>> dependent variable of these new data points. If this were a basic lm
>>> regression in R, I would use the "predict()" command. I wish to better
>>> understand how I would do so using a GWR model. I found the below
>>> procedure, but I would like to know first if it is capable accomplishing
>>> this task, and secondly, if I am specifying it correctly. It seems to me
>>> that this procedure, as it stands, doesn't take into account the
>>> appropriate bandwidths for the new data, say, "georgiaNewData"
>>>
>>> PredictionsOfNewData  <- gwr(PctBach ~ TotPop90 + PctRural + PctEld +
>>> PctFB
>>> + PctPov + PctBlack, data=gSRDF, adapt=TRUE, gweight=gwr.Gauss, method =
>>> "aic",  bandwidth=bw1,
>>> predictions=TRUE, fit.points=georgiaNewData)
>>> PredictionsOfNewData
>>>
>>> Thanks in advance for guidance and insight...
>>>
>>>
>>> On Fri, Aug 30, 2013 at 9:01 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>
>>>  Provide a reproducible code example of your problem using a built in data
>>>> set. No reproducible example, no response, as I cannot guess (and likely
>>>> nobody else can either) what your specific misunderstanding is. Code
>>>> using
>>>> for example the Georgia data set in the package. You seem to be assuming
>>>> that you understand how GWR works, I don't think that you do, so you have
>>>> to show what you mean in code.
>>>>
>>>> Roger
>>>>
>>>>
>>>> On Fri, 30 Aug 2013, Paul Bidanset wrote:
>>>>
>>>>  Roger,
>>>>
>>>>>
>>>>> I think all I would like to know is if it is possible to apply a
>>>>> calibrated
>>>>> GWR model to a hold-out sample, and if so, what the most accurate way to
>>>>> do
>>>>> so is. I understand the pitfalls of GWR but would like to learn as much
>>>>> as
>>>>> I can before progressing to the next spatial methodology I learn in R.
>>>>>
>>>>>
>>>>> On Fri, Aug 30, 2013 at 3:37 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>>>> wrote:
>>>>>
>>>>>  Paul, Luis,
>>>>>
>>>>>>
>>>>>> I suspect that your speculations are completely wrong-headed. Please
>>>>>> provide a reproducible example with a built-in data set, so that there
>>>>>> is
>>>>>> at least minimal clarity in what you are guessing. Note in addition
>>>>>> that
>>>>>> GWR as a technique should not be used for anything other than
>>>>>> exploration
>>>>>> of possible mis-specification in the underlying model with the given
>>>>>> data,
>>>>>> as patterning in coefficients is induced by GWR for simulated
>>>>>> covariates
>>>>>> with no pattern.
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>
>>>>>> On Fri, 30 Aug 2013, Luis Guerra wrote:
>>>>>>
>>>>>>  Thank you Luis. When calibrating the adaptive model, using adapt=t in
>>>>>> the
>>>>>>
>>>>>>  bandwidth selection created the proportion you speak of, which then
>>>>>>>
>>>>>>>> allowed
>>>>>>>> me to create a bandwidth matrix using gwr.adapt. However, this has
>>>>>>>> not
>>>>>>>> worked for me with holdout samples. Have you had success in this
>>>>>>>> regard?
>>>>>>>>
>>>>>>>>  Now I get what you mean. Let's show an example:
>>>>>>>>
>>>>>>>>
>>>>>>> bw <- gwr.sel(var ~ var1, data=yourdata, adapt=TRUE)
>>>>>>> m <- gwr(var~var1, data=yourdata, adapt=bw, fit.points=newdata)
>>>>>>>
>>>>>>> So an adaptative bandwidth (bw) is calculated based on"yourdata",
>>>>>>> while
>>>>>>> you
>>>>>>> are fitting "newdata" later on using that previously found bw. I had
>>>>>>> not
>>>>>>> thought about it previously. Let's see whether someone else can help
>>>>>>> you
>>>>>>> (us).
>>>>>>>
>>>>>>>
>>>>>>>  I do not know the intended influence of these "fit.points". I would
>>>>>>> think
>>>>>>>
>>>>>>>  that new localized regressions are not calculated, as we're testing
>>>>>>>> the
>>>>>>>> model and previous data points' ability to predict for these new
>>>>>>>> ones,
>>>>>>>> but
>>>>>>>> I could be wrong. My current method, however, is producing much
>>>>>>>> poorer
>>>>>>>> results with the holdouts, which I am fairly sure is related to my
>>>>>>>> inability to incorporate the new points necessary bandwidths.
>>>>>>>>
>>>>>>>>  Coming back to the previously created example, imagine that
>>>>>>>> "newdata"
>>>>>>>>
>>>>>>>>  is a
>>>>>>> single point that you want to fit. Imagine now that "yourdata" is a
>>>>>>> sample
>>>>>>> with 1000 cases. Then you are getting 1000 models with 1000 different
>>>>>>> intercepts and 1000 different beta values to adjust var1, rigth? Which
>>>>>>> of
>>>>>>> all these parameters do you use for fitting "newdata"? And something
>>>>>>> else,
>>>>>>> what would happen with "newdata" if it is enough far away from
>>>>>>> "yourdata"
>>>>>>> and we would be using a fixed bandwidth?
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>  On Aug 29, 2013 8:56 PM, "Luis Guerra" <luispelayo84 at gmail.com>
>>>>>>> wrote:
>>>>>>>
>>>>>>>
>>>>>>>>  Dear Paul,
>>>>>>>>
>>>>>>>>
>>>>>>>>> I am dealing with this kind of problems right now, and if I am not
>>>>>>>>> wrong,
>>>>>>>>> when you want to apply an adaptative bandwidth, you should
>>>>>>>>> introduce a
>>>>>>>>> value for the "adapt" parameter instead of for the "bandwidth"
>>>>>>>>> parameter.
>>>>>>>>> This value will be between 0 and 1 and indicates the proportion of
>>>>>>>>> cases
>>>>>>>>> around your regression point that should be included to estimate
>>>>>>>>> each
>>>>>>>>> local
>>>>>>>>> model. So depending on the amount of points around each case, the
>>>>>>>>> model
>>>>>>>>> will use a different bandwidth for each point to be fitted.
>>>>>>>>>
>>>>>>>>> Related to your question, do you know what is the influence of the
>>>>>>>>> data
>>>>>>>>> introduced in the "data" parameter to the data to be fitted
>>>>>>>>> (introduced
>>>>>>>>> in
>>>>>>>>> the "fit.points" parameter)? I mean, you have to obtain new local
>>>>>>>>> models
>>>>>>>>> (one for each point to be fitted), so I do not understand whether
>>>>>>>>> the
>>>>>>>>> "data" parameter is used somehow...
>>>>>>>>>
>>>>>>>>> Best regards,
>>>>>>>>>
>>>>>>>>> Luis
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On Fri, Aug 30, 2013 at 1:26 AM, Paul Bidanset <pbidanset at gmail.com
>>>>>>>>>
>>>>>>>>>  wrote:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>  Hi Folks,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> I was curious if anyone has had experience applying an SPGWR model
>>>>>>>>>> with
>>>>>>>>>> an
>>>>>>>>>> adaptive bandwidth matrix to a holdout or validation sample. I am
>>>>>>>>>> using
>>>>>>>>>> the
>>>>>>>>>> "fit.points" command, which does not seem to allow for a new
>>>>>>>>>> bandwidth
>>>>>>>>>> calibrated around the holdout samples XY coordinates. Any direction
>>>>>>>>>> would
>>>>>>>>>> be greatly appreciated.  I am also open to other viable methods.
>>>>>>>>>>
>>>>>>>>>> Cheers,
>>>>>>>>>>
>>>>>>>>>> Paul
>>>>>>>>>>
>>>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>>>
>>>>>>>>>> ______________________________******_________________
>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>> https://stat.ethz.ch/mailman/******listinfo/r-sig-geo<https://stat.ethz.ch/mailman/****listinfo/r-sig-geo>
>>>>>>>>>> <https://**stat.ethz.ch/mailman/****listinfo/r-sig-geo<https://stat.ethz.ch/mailman/**listinfo/r-sig-geo>
>>>>>>>>>>>
>>>>>>>>>> <https://**stat.ethz.ch/**mailman/listinfo/**r-sig-geo<http://stat.ethz.ch/mailman/listinfo/**r-sig-geo>
>>>>>>>>>> <h**ttps://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>          [[alternative HTML version deleted]]
>>>>>>>>>
>>>>>>>>
>>>>>>> ______________________________******_________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/******listinfo/r-sig-geo<https://stat.ethz.ch/mailman/****listinfo/r-sig-geo>
>>>>>>> <https://**stat.ethz.ch/mailman/****listinfo/r-sig-geo<https://stat.ethz.ch/mailman/**listinfo/r-sig-geo>
>>>>>>>>
>>>>>>> <https://**stat.ethz.ch/**mailman/listinfo/**r-sig-geo<http://stat.ethz.ch/mailman/listinfo/**r-sig-geo>
>>>>>>> <h**ttps://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>  --
>>>>>>>
>>>>>> Roger Bivand
>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>>  --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>>
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mtreglia at gmail.com  Fri Aug 30 19:13:52 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 30 Aug 2013 12:13:52 -0500
Subject: [R-sig-Geo] Extract function - too much data for R?
Message-ID: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/3bf51f9d/attachment.pl>

From southandy at gmail.com  Fri Aug 30 20:04:15 2013
From: southandy at gmail.com (Andy South)
Date: Fri, 30 Aug 2013 18:04:15 +0000
Subject: [R-sig-Geo] Global mapping of multiple categories by colour
References: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>
	<alpine.LRH.2.03.1308282219540.25273@reclus.nhh.no>
Message-ID: <loom.20130830T195122-507@post.gmane.org>

> > 

Thanks Roger for your comprehensive answer, I've been offline for a couple 
of days.

Sarah, I think you may be very close to your first objective. Try removing 
the quotes around data3, (because data3 is an object not a string) :

malMap <- joinCountryData2Map(dF = data3, joinCode = "ISO3", nameJoinColumn 
= "country")

> > malMap <- joinCountryData2Map(dF = "data3", joinCode = "ISO3",
> > nameJoinColumn = "country")
> >
> > # This will join your malDF data.frame to the country map data
> >
> > mapCountryData(malMap, nameColumnToPlot="hdi", catMethod =
> > "categorical", missingCountryCol = gray(.8))
> >
> > head(data3)
> >
> > country   hdi
> >              0
> >              0
> >              0
> >  ASM     0.827
> >              0
> >              0
> >
> > Firstly I get this error as it won't match the country names up:
> >
> > "Error in joinCountryData2Map(dF = "data3", joinCode = "ISO3",
> > nameJoinColumn = "country") :  your chosen nameJoinColumn :'country'
> > seems not to exist in your data, columns ="

> > Also, is it possible to manually make
> > the small island nations bigger as they will not appear at this scale.

Let's walk before we try running, however that should be possible using 
mapBubbles([some stuff],add=TRUE)
after you've created your initial map.

To get a more rapid response from me & other rworldmap users, & search more 
targeted information you can join the nascent rworldmap google group : 
http://groups.google.com/group/rworldmap
(not much on it yet but it's a start).

Good luck,
Andy


> > I'm sorry this is so long. Any help would be greatly appreciated.
> >
> > Cheers,
> >
> > Sarah
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo <at> r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>


From tephilippi at gmail.com  Fri Aug 30 20:44:23 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 30 Aug 2013 11:44:23 -0700
Subject: [R-sig-Geo] Extract function - too much data for R?
In-Reply-To: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
References: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
Message-ID: <CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/a52f756d/attachment.pl>

From rhonag at gmail.com  Fri Aug 30 20:45:09 2013
From: rhonag at gmail.com (Rhona Govender)
Date: Fri, 30 Aug 2013 11:45:09 -0700
Subject: [R-sig-Geo] Global mapping of multiple categories by colour
In-Reply-To: <loom.20130830T195122-507@post.gmane.org>
References: <CAPVROXpLeRCRLZaeH4Rf-MxhDDRWOTye9rOc8PnSFU2XkjVB=g@mail.gmail.com>
	<alpine.LRH.2.03.1308282219540.25273@reclus.nhh.no>
	<loom.20130830T195122-507@post.gmane.org>
Message-ID: <CAPVROXorTFe2sO380M7xUnbfMKye=Sja3wafwLTG6uNdhdvJMw@mail.gmail.com>

Thank you for the help, everyone.
Andy, this did fix the country matching problem! Thank you very much.
I am now trying to divide the data into just 3 categories, but I will
move this over to the google group.

Cheers,

Sarah


On Fri, Aug 30, 2013 at 11:04 AM, Andy South <southandy at gmail.com> wrote:
>> >
>
> Thanks Roger for your comprehensive answer, I've been offline for a couple
> of days.
>
> Sarah, I think you may be very close to your first objective. Try removing
> the quotes around data3, (because data3 is an object not a string) :
>
> malMap <- joinCountryData2Map(dF = data3, joinCode = "ISO3", nameJoinColumn
> = "country")
>
>> > malMap <- joinCountryData2Map(dF = "data3", joinCode = "ISO3",
>> > nameJoinColumn = "country")
>> >
>> > # This will join your malDF data.frame to the country map data
>> >
>> > mapCountryData(malMap, nameColumnToPlot="hdi", catMethod =
>> > "categorical", missingCountryCol = gray(.8))
>> >
>> > head(data3)
>> >
>> > country   hdi
>> >              0
>> >              0
>> >              0
>> >  ASM     0.827
>> >              0
>> >              0
>> >
>> > Firstly I get this error as it won't match the country names up:
>> >
>> > "Error in joinCountryData2Map(dF = "data3", joinCode = "ISO3",
>> > nameJoinColumn = "country") :  your chosen nameJoinColumn :'country'
>> > seems not to exist in your data, columns ="
>
>> > Also, is it possible to manually make
>> > the small island nations bigger as they will not appear at this scale.
>
> Let's walk before we try running, however that should be possible using
> mapBubbles([some stuff],add=TRUE)
> after you've created your initial map.
>
> To get a more rapid response from me & other rworldmap users, & search more
> targeted information you can join the nascent rworldmap google group :
> http://groups.google.com/group/rworldmap
> (not much on it yet but it's a start).
>
> Good luck,
> Andy
>
>
>> > I'm sorry this is so long. Any help would be greatly appreciated.
>> >
>> > Cheers,
>> >
>> > Sarah
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo <at> r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Dominik.Schneider at colorado.edu  Fri Aug 30 20:52:55 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Fri, 30 Aug 2013 12:52:55 -0600
Subject: [R-sig-Geo] coordinate system in ncdf4
Message-ID: <CAHYDKLaxO_Aqy8z4Q2a3HRuaFgAjXEPc6fQOtD+Sjj8tQbxqjw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/085aca8f/attachment.pl>

From mtreglia at gmail.com  Fri Aug 30 21:36:28 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 30 Aug 2013 14:36:28 -0500
Subject: [R-sig-Geo] Extract function - too much data for R?
In-Reply-To: <CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>
References: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
	<CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>
Message-ID: <CAPKp32tnUujXoKJf3YmmM0SKxV+qsKaTcembw6Hpb+R0WQHWYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/375f88a0/attachment.pl>

From tephilippi at gmail.com  Fri Aug 30 23:47:10 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 30 Aug 2013 14:47:10 -0700
Subject: [R-sig-Geo] Extract function - too much data for R?
In-Reply-To: <CAPKp32tnUujXoKJf3YmmM0SKxV+qsKaTcembw6Hpb+R0WQHWYQ@mail.gmail.com>
References: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
	<CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>
	<CAPKp32tnUujXoKJf3YmmM0SKxV+qsKaTcembw6Hpb+R0WQHWYQ@mail.gmail.com>
Message-ID: <CALyPt8z8NRewV9-JrWaNEasuxTYp5uvPX7sTDLHhY3vY0aFOjg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/4776bc71/attachment.pl>

From mattguzzo12 at gmail.com  Sat Aug 31 00:01:52 2013
From: mattguzzo12 at gmail.com (mattguzzo12 at gmail.com)
Date: Fri, 30 Aug 2013 15:01:52 -0700 (PDT)
Subject: [R-sig-Geo] Converting from spatial polygon to spatial lines
Message-ID: <1377900112627-7584516.post@n2.nabble.com>

I cannot seem to find a method for converting a spatial polygon class file to
a spatial lines class. Most of the methods seem to be manually, but I am
hoping there is a simpler method. Any help would be appreciated.

Matt



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-from-spatial-polygon-to-spatial-lines-tp7584516.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jochen.albrecht at gmail.com  Sat Aug 31 00:19:27 2013
From: jochen.albrecht at gmail.com (Jochen Albrecht)
Date: Fri, 30 Aug 2013 18:19:27 -0400
Subject: [R-sig-Geo] (no subject)
Message-ID: <CAKRQQ2Rgp7Lm=TsDAP2N49S-xzo8cVoB_VcFihyaVR-XgB7zow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/1c83f142/attachment.pl>

From vitale232 at gmail.com  Sat Aug 31 00:23:59 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 30 Aug 2013 15:23:59 -0700
Subject: [R-sig-Geo] Converting from spatial polygon to spatial lines
In-Reply-To: <1377900112627-7584516.post@n2.nabble.com>
References: <1377900112627-7584516.post@n2.nabble.com>
Message-ID: <CAFTcopd5bB8bm+ef4kD4y0w4ZSz_pXNCq_Vex+DSsAKhC8VvDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/de36704d/attachment.pl>

From mattguzzo12 at gmail.com  Sat Aug 31 00:37:00 2013
From: mattguzzo12 at gmail.com (mattguzzo12 at gmail.com)
Date: Fri, 30 Aug 2013 15:37:00 -0700 (PDT)
Subject: [R-sig-Geo] Converting from spatial polygon to spatial lines
In-Reply-To: <CAFTcopd5bB8bm+ef4kD4y0w4ZSz_pXNCq_Vex+DSsAKhC8VvDQ@mail.gmail.com>
References: <1377900112627-7584516.post@n2.nabble.com>
	<CAFTcopd5bB8bm+ef4kD4y0w4ZSz_pXNCq_Vex+DSsAKhC8VvDQ@mail.gmail.com>
Message-ID: <1377902220960-7584519.post@n2.nabble.com>

That was simple - Thanks! Now I just have to deal with the turning angles
that are too large for the function I am using!

Matt



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-from-spatial-polygon-to-spatial-lines-tp7584516p7584519.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mtreglia at gmail.com  Sat Aug 31 01:40:10 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 30 Aug 2013 18:40:10 -0500
Subject: [R-sig-Geo] Extract function - too much data for R?
In-Reply-To: <CALyPt8z8NRewV9-JrWaNEasuxTYp5uvPX7sTDLHhY3vY0aFOjg@mail.gmail.com>
References: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
	<CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>
	<CAPKp32tnUujXoKJf3YmmM0SKxV+qsKaTcembw6Hpb+R0WQHWYQ@mail.gmail.com>
	<CALyPt8z8NRewV9-JrWaNEasuxTYp5uvPX7sTDLHhY3vY0aFOjg@mail.gmail.com>
Message-ID: <CAPKp32vgHtU0ZYVKJKMd3kgYP6nFU-HTUZ8B4bztj5uX0v6c-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130830/ad82d2a5/attachment.pl>

From grothered at gmail.com  Sat Aug 31 06:42:30 2013
From: grothered at gmail.com (GD)
Date: Fri, 30 Aug 2013 21:42:30 -0700 (PDT)
Subject: [R-sig-Geo] Extract function - too much data for R?
In-Reply-To: <CAPKp32vgHtU0ZYVKJKMd3kgYP6nFU-HTUZ8B4bztj5uX0v6c-Q@mail.gmail.com>
References: <CAPKp32tJ1kAMiTxK7N_irLj0p7Akv9Kxmn_REz-cOEHypGG3vQ@mail.gmail.com>
	<CALyPt8yG6qrxD_NaU+eLgqRf-xu-HO43xLiTAFB5d00MaEH02g@mail.gmail.com>
	<CAPKp32tnUujXoKJf3YmmM0SKxV+qsKaTcembw6Hpb+R0WQHWYQ@mail.gmail.com>
	<CALyPt8z8NRewV9-JrWaNEasuxTYp5uvPX7sTDLHhY3vY0aFOjg@mail.gmail.com>
	<CAPKp32vgHtU0ZYVKJKMd3kgYP6nFU-HTUZ8B4bztj5uX0v6c-Q@mail.gmail.com>
Message-ID: <1377924150709-7584521.post@n2.nabble.com>

I had related situation with 85000 non-overlapping polygons, and a raster
dataset with dimensions ~ 10000x10000. In that case I wanted the full
distribution of pixel values inside each polygon, rather than just the mean.

An efficient approach (much faster than extract) was:

1) Rasterize the polygons (to a single raster with the same dimensions as
the input raster dataset). My polygons had a unique ID value that was burned
into the raster. I did this with 'gdal_rasterize'

2) Use the 'crosstab' function in the 'raster' package to cross-tabulate the
values from the ID raster with the values on the input raster dataset. This
gives the full range of pixel values associated with each polygon ID.

3) From there, it is straightforward to apply whichever function to the
pixel values for each ID.




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Extract-function-too-much-data-for-R-tp7584509p7584521.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Sat Aug 31 06:54:38 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 31 Aug 2013 14:54:38 +1000
Subject: [R-sig-Geo] coordinate system in ncdf4
In-Reply-To: <CAHYDKLaxO_Aqy8z4Q2a3HRuaFgAjXEPc6fQOtD+Sjj8tQbxqjw@mail.gmail.com>
References: <CAHYDKLaxO_Aqy8z4Q2a3HRuaFgAjXEPc6fQOtD+Sjj8tQbxqjw@mail.gmail.com>
Message-ID: <CAAcGz99C5kGXJR7AjZK5yZw66_gC5wUbPo6JZf3gV-m7kGpM_A@mail.gmail.com>

It is possible, and one way to see an example would be to look in the
raster package source.

But, whether it will help depends on what the target software is.
(GDAL 1.9.2 doesn't seem to understand the metadata written by raster
for example.)

On Sat, Aug 31, 2013 at 4:52 AM, Dominik Schneider
<Dominik.Schneider at colorado.edu> wrote:
> Is it possible to specify the coordinate system when creating a netcdf file
> with the ncdf4 package? I have not been able to see anything in the
> documentation.
> Thanks
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From edzer.pebesma at uni-muenster.de  Sat Aug 31 22:05:11 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 31 Aug 2013 22:05:11 +0200
Subject: [R-sig-Geo] generating coordinates at equal geographical
	distances
In-Reply-To: <CAMLNaBbX4jQqzqMhiyRpMFejuj9hmOdbP08ObPbKjoWVjsDP7Q@mail.gmail.com>
References: <b25b8665be7141ecb4210ad9f319a24c@EX-0-HT0.lancs.local>
	<CANVKczPuYvX_pdZULAjA_i0wPqPH+AK8ASKuhV-gJNtK_iCf_Q@mail.gmail.com>
	<CAMLNaBbX4jQqzqMhiyRpMFejuj9hmOdbP08ObPbKjoWVjsDP7Q@mail.gmail.com>
Message-ID: <52224C77.7080408@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

John, as an alternative you may want to look into sp::spsample, using
type "Fibonacci"; the paper describing this is

Alvaro Gonzalez, 2010. Measurement of Areas on a Sphere Using
Fibonacci and Latitude-Longitude Lattices. Mathematical Geosciences
42(1), p. 49-64


On 08/28/2013 07:27 PM, john d wrote:
> Ok, I'll be more explicit :)
> 
> If I want to generate random coordinates across North America by
> uniformly sampling latitudes and longitudes, the geographical
> distance between these coordinates would decrease towards higher
> latitudes. I'd like to be able to generate coordinates (e.g. a
> grid) such that the geographical distances between coordinates
> would be constant regardless of latitude.
> 
> 
> 
> On Wed, Aug 28, 2013 at 12:04 PM, Barry Rowlingson < 
> b.rowlingson at lancaster.ac.uk> wrote:
> 
>> You will find that any two coordinates are equidistant from each
>> other...
>> 
>> So my suggestion is you need to expand you question a bit more!
>> :)
>> 
>> On Wed, Aug 28, 2013 at 3:49 PM, john d <dobzhanski at gmail.com>
>> wrote:
>>> Dear all,
>>> 
>>> I need to generate coordinates that are equidistant, regardless
>>> of latitude. Any suggestions?
>>> 
>>> Thanks!
>>> 
>>> John
>>> 
>>> [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________ R-sig-Geo
>>> mailing list R-sig-Geo at r-project.org 
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> [[alternative HTML version deleted]]
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJSIkx3AAoJEM1OCHCtOnfx2X0IAIPFc/Ut4cxqNcdFfXn2bFgQ
++HgCVm2EXHp6gqGNnGT4vD+Wn8DnXXd483alUFLD6SLxIqtI51DSTSEGy1p6ZkI
1bbKFdGKHmrOgXXf98nmBUBxHJGVrCU4M+aDVmHA2c5QhmEeqM/JnoGijL2pPHpH
SuK6HcBEqhL36jgtKF/uJKnMf4nEEFtP6lQ7UAVuhzADZ3nMR36zl+o/EsoHtwbt
uFcjDpP+qPh2S1wXd/y90lj8d1Pj3tQXNONvbOTgVthealPGBZxCTSSPbedhIV4w
jSfk2ded7QICCR0AoGRFcxV21SR0a5FrXpWjIfgWyWRg+RWq+5Dxdoxnu7ozOIs=
=hPBa
-----END PGP SIGNATURE-----


