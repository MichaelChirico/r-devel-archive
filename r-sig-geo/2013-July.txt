From b.rowlingson at lancaster.ac.uk  Mon Jul  1 10:01:48 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 1 Jul 2013 09:01:48 +0100
Subject: [R-sig-Geo] Chapter 4 in ASDAR book GeoTiff question
In-Reply-To: <0dc53c9490e3457bb166194927dbac92@EX-1-HT0.lancs.local>
References: <0dc53c9490e3457bb166194927dbac92@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOvk8Fb_GrUZfnRc8GfC96JryMnRoHhSL8vKxCcPGWhwA@mail.gmail.com>

On Sat, Jun 29, 2013 at 11:11 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear GEO-phytes
>
> I am working through the ASDAR book (which is TOTALLY amazing), and I have a question about something in Chapter 4, please:  We are looking at a GeoTiff file, and get the following warning message at the end.
>
>> GDALinfo("70042108.tif")
> rows        1200
> columns     1320
> bands       1
> lower left origin.x        174.2
> lower left origin.y        -37.5
> res.x       0.0008333333
> res.y       0.0008333333
> ysign       -1
> oblique.x   0
> oblique.y   0
> driver      GTiff
> projection  +proj=longlat +datum=WGS84 +no_defs
> file        70042108.tif
> apparent band summary:
>    GDType hasNoDataValue NoDataValue blockSize1 blockSize2
> 1 Float32          FALSE           0          1       1320
> apparent band statistics:
>          Bmin       Bmax Bmean Bsd
> 1 -4294967295 4294967295    NA  NA
> Metadata:
> AREA_OR_POINT=Area
> TIFFTAG_RESOLUTIONUNIT=1 (unitless)
> TIFFTAG_SOFTWARE=IMAGINE TIFF Support
> Copyright 1991 - 1999 by ERDAS, Inc. All Rights Reserved
> @(#)$RCSfile: etif.c $ $Revision: 1.11 $ $Date$
> TIFFTAG_XRESOLUTION=1
> TIFFTAG_YRESOLUTION=1
> Warning message:
> statistics not supported by this driver
>>
>
> I was wondering about this since GeoTiff is one of the supported drivers.

 Some geospatial image formats store 'statistics' of their data in
themselves - things like the mean and variance of the data - are kept
in little metadata chunks so that software doesn't have to loop over
the data and compute it whenever needed.

 The warning message is just saying that the GeoTiff driver in GDAL
doesn't support this kind of metadata. If GDAL has to get say, the
mean value of a band, it will have to loop over and compute it rather
than just getting the number from the metadata statistics block.

 Thomas Adams doesn't get this message - either he's got a different
version of the GDAL library that does handle statistics metadata, or
he's got a different version of sp or rgdal (wherever GDALInfo comes
from) that doesn't bother warning you.

 Either way, it doesn't really matter!

Barry


From losedaghat at gmail.com  Mon Jul  1 10:10:39 2013
From: losedaghat at gmail.com (L S)
Date: Mon, 1 Jul 2013 04:10:39 -0400
Subject: [R-sig-Geo] Is it possible to "bin" or grid ppp objects?
In-Reply-To: <51D08FF5.2030709@upm.es>
References: <CAMgNocvdifBVqkQtMaWfVjP4HvDtRi21qLCEGENxaQBDOufzKw@mail.gmail.com>
	<51D08FF5.2030709@upm.es>
Message-ID: <CAMgNocvBR6g4JzN3MnorQocDN3d3KCOu4qd3Qvw3mhaWP8m71w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/ed750c17/attachment.pl>

From hi_ono2001 at ybb.ne.jp  Mon Jul  1 10:19:26 2013
From: hi_ono2001 at ybb.ne.jp (hi_ono2001 at ybb.ne.jp)
Date: Mon, 1 Jul 2013 17:19:26 +0900 (JST)
Subject: [R-sig-Geo] About your FFIELD package
Message-ID: <100280.11272.qm@web200215.mail.kks.yahoo.co.jp>

Hello.

   I have been very interested in your packages.

   Excellent works!!

  Curently this works fine on my MacBook Pro.

 I'd like to ask you following questions.

 1. Is this package available for map data's attributes text placement using maptools?

2.  Any plan to extend placement with different size of text fonts?

3. Do you know following Dorling's circular cartogram? I think your packges can create  these maps adding some modifications.

?http://mbostock.github.io/protovis/ex/cartogram.html


 Best regards.


From ahimsa at camposarceiz.com  Mon Jul  1 10:24:22 2013
From: ahimsa at camposarceiz.com (Ahimsa Campos-Arceiz)
Date: Mon, 1 Jul 2013 16:24:22 +0800
Subject: [R-sig-Geo] Plotting multiple gmap (package dismo) maps in a single
	graph
Message-ID: <CA+=XEo7vsqeyog-gw9JMkRvNHDG6vhq2n4cGtkH-NTEWdLET9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/2960a767/attachment.pl>

From ahimsa at camposarceiz.com  Mon Jul  1 10:42:41 2013
From: ahimsa at camposarceiz.com (Ahimsa Campos-Arceiz)
Date: Mon, 1 Jul 2013 16:42:41 +0800
Subject: [R-sig-Geo] How to plot multiple maps created with the 'gmap'
 function, from the package 'dismo'?
Message-ID: <CA+=XEo6tPZoFU+PdD_OEkTxU5L745mRbiWZ=tuTiK1ecx0aJKw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/43109982/attachment.pl>

From chrismcowen at gmail.com  Mon Jul  1 13:01:33 2013
From: chrismcowen at gmail.com (Chris Mcowen)
Date: Mon, 1 Jul 2013 12:01:33 +0100
Subject: [R-sig-Geo] spatially clustered factors?
Message-ID: <000301ce764a$59ae5da0$0d0b18e0$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/5ed018cc/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jul  1 13:11:57 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 1 Jul 2013 13:11:57 +0200
Subject: [R-sig-Geo] spatially clustered factors?
In-Reply-To: <000301ce764a$59ae5da0$0d0b18e0$@com>
References: <000301ce764a$59ae5da0$0d0b18e0$@com>
Message-ID: <alpine.LRH.2.03.1307011308350.1368@reclus.nhh.no>

On Mon, 1 Jul 2013, Chris Mcowen wrote:

> Dear list, first let me apologise, i am an ecologist and this is my first
> foray into spatial statistics.
>
>
>
> I have, for a number of regions, the factor that best explains variation in
> the yield (fisheries catch) obtained within that region, the factor has 4
> levels - ChlA, SST, Effort or none.

See joincount.test for single comparisons, or joincount.multi for multiple 
comparisons by join "colours" in spdep. You'll also need neighbour lists, 
explained in:

vignette("nb")

in the most recent version of that package.

Hope this helps,

Roger

>
>
>
> What i am essentially wanting to know is,  is there a spatial pattern to the
> data? (clumped, over-dispersed or random)
>
>
>
> For example if region 1 is classed as Effort, is it more or less likely that
> the adjoining region (region 2) will be of the same factor, or does it makes
> no difference.
>
>
>
> I have seen lots of packages that allow this to be done for numerical data
> but have not found one for factors.
>
>
>
> Please see below for an example of the data. Where latitude is the centroid
> of the region and factor is the source of variation.
>
>
>
> clusters <- structure(list(Latitude = c(4.8261, 26.127123, 3.409063,
> -31.964573,
> 11.524328, 10.857926, 30.95066, 6.322733, 40.963009, -4.370738,
> 53.77057, -46.270909, 51.431808, 50.091992, -12.606217, 16.26404,
> -27.513126, -40.976427, -40.491914, -35.169487, -16.739053, -22.651113,
> 30.445027, -27.701939, -17.154608, -10.147356, -29.117245, 57.472215,
> 45.538569, 65.31731, 75.308501, 54.063299, 45.194528, 41.079154,
> -35.169487, 51.431808, 24.647845, 68.201714, 41.262656, 24.976371,
> 33.251908, 16.347456, 30.95066, -1.408364, 37.054319, 23.843305,
> 57.400753, 8.712258), Factor = structure(c(1L, 1L, 1L, 1L, 1L,
> 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
> 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L,
> 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L), .Label = c("ChlA",
> "Effort", "SST", "Unidentified"), class = "factor")), .Names = c("Latitude",
>
> "Factor"), class = "data.frame", row.names = c(NA, -48L))
>
>
>
>
>
> Thanks,
>
>
>
> Chris
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From chrismcowen at gmail.com  Mon Jul  1 13:44:10 2013
From: chrismcowen at gmail.com (Chris Mcowen)
Date: Mon, 1 Jul 2013 12:44:10 +0100
Subject: [R-sig-Geo] spatially clustered factors?
In-Reply-To: <alpine.LRH.2.03.1307011308350.1368@reclus.nhh.no>
References: <000301ce764a$59ae5da0$0d0b18e0$@com>
	<alpine.LRH.2.03.1307011308350.1368@reclus.nhh.no>
Message-ID: <000b01ce7650$4e5f4210$eb1dc630$@com>

Great thanks it worked a treat; a lot of time in R being pointed to the
correct package / function is all that is needed.

Chris 

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: 01 July 2013 12:12
To: Chris Mcowen
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] spatially clustered factors?

On Mon, 1 Jul 2013, Chris Mcowen wrote:

> Dear list, first let me apologise, i am an ecologist and this is my 
> first foray into spatial statistics.
>
>
>
> I have, for a number of regions, the factor that best explains 
> variation in the yield (fisheries catch) obtained within that region, 
> the factor has 4 levels - ChlA, SST, Effort or none.

See joincount.test for single comparisons, or joincount.multi for multiple
comparisons by join "colours" in spdep. You'll also need neighbour lists,
explained in:

vignette("nb")

in the most recent version of that package.

Hope this helps,

Roger

>
>
>
> What i am essentially wanting to know is,  is there a spatial pattern 
> to the data? (clumped, over-dispersed or random)
>
>
>
> For example if region 1 is classed as Effort, is it more or less 
> likely that the adjoining region (region 2) will be of the same 
> factor, or does it makes no difference.
>
>
>
> I have seen lots of packages that allow this to be done for numerical 
> data but have not found one for factors.
>
>
>
> Please see below for an example of the data. Where latitude is the 
> centroid of the region and factor is the source of variation.
>
>
>
> clusters <- structure(list(Latitude = c(4.8261, 26.127123, 3.409063, 
> -31.964573, 11.524328, 10.857926, 30.95066, 6.322733, 40.963009, 
> -4.370738, 53.77057, -46.270909, 51.431808, 50.091992, -12.606217, 
> 16.26404, -27.513126, -40.976427, -40.491914, -35.169487, -16.739053, 
> -22.651113, 30.445027, -27.701939, -17.154608, -10.147356, -29.117245, 
> 57.472215, 45.538569, 65.31731, 75.308501, 54.063299, 45.194528, 
> 41.079154, -35.169487, 51.431808, 24.647845, 68.201714, 41.262656, 
> 24.976371, 33.251908, 16.347456, 30.95066, -1.408364, 37.054319, 
> 23.843305, 57.400753, 8.712258), Factor = structure(c(1L, 1L, 1L, 1L, 
> 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
> 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 
> 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L), .Label = c("ChlA", "Effort", 
> "SST", "Unidentified"), class = "factor")), .Names = c("Latitude",
>
> "Factor"), class = "data.frame", row.names = c(NA, -48L))
>
>
>
>
>
> Thanks,
>
>
>
> Chris
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics, Helleveien 30,
N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From koen.hufkens at gmail.com  Mon Jul  1 14:49:00 2013
From: koen.hufkens at gmail.com (Koen Hufkens)
Date: Mon, 1 Jul 2013 14:49:00 +0200
Subject: [R-sig-Geo] aggregate() error on large files in raster
Message-ID: <CAHDtqqmWX69=MUG8dt+=EuNv7ZJ1k8_wT3d=WWyaSGsqESrEuA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/517e3882/attachment.pl>

From siqueira at engin.umass.edu  Mon Jul  1 15:15:19 2013
From: siqueira at engin.umass.edu (siqueira)
Date: Mon, 1 Jul 2013 06:15:19 -0700 (PDT)
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
Message-ID: <1372684519057-7583964.post@n2.nabble.com>

I am trying to get rid of the colorbar that shows up to the right of raster
image plots.

For instance, if I type the following:

data(lansing)
D <- density(lansing)
plot(D)

it always shows up with a colorbar at the right hand side.  I would like to
delete that colorbar.

does anyone have a suggestion as to how?  I have searched high and low for
this, so far unsuccessfully.

thank you, Paul



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-get-rid-of-colorbar-in-raster-images-tp7583964.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From koen.hufkens at gmail.com  Mon Jul  1 15:17:38 2013
From: koen.hufkens at gmail.com (Koen Hufkens)
Date: Mon, 1 Jul 2013 15:17:38 +0200
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
In-Reply-To: <1372684519057-7583964.post@n2.nabble.com>
References: <1372684519057-7583964.post@n2.nabble.com>
Message-ID: <CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/4151ff73/attachment.pl>

From siqueira at engin.umass.edu  Mon Jul  1 15:27:33 2013
From: siqueira at engin.umass.edu (siqueira)
Date: Mon, 1 Jul 2013 06:27:33 -0700 (PDT)
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
In-Reply-To: <CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>
References: <1372684519057-7583964.post@n2.nabble.com>
	<CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>
Message-ID: <1372685253910-7583966.post@n2.nabble.com>

Thank you for the quick reply Koen!

... however, that does not seem to work.  That is, maybe it has to do with
the density function... I just don't know.

That is, if I type what you suggested, I get plot with symbols, not a raster
image.  I have included a snapshot of what I get if I execute the following
commands in R

data(lansing)
D <- density(lansing)
plot(D,main="tree density",axes=FALSE,legend=FALSE,box=FALSE)

<http://r-sig-geo.2731867.n2.nabble.com/file/n7583966/R_colorbar_image.jpg> 

it is that colorbar at the right that I am trying to eliminate.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-get-rid-of-colorbar-in-raster-images-tp7583964p7583966.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Mon Jul  1 15:40:20 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 1 Jul 2013 23:40:20 +1000
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
In-Reply-To: <1372685253910-7583966.post@n2.nabble.com>
References: <1372684519057-7583964.post@n2.nabble.com>
	<CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>
	<1372685253910-7583966.post@n2.nabble.com>
Message-ID: <CAAcGz99ODGwA91he3_bfAQCt79zc_s88yt_DeMdX+E0meLrmVA@mail.gmail.com>

That's not a "raster", but an "im" (from package spatstat).

See ?plot.im

plot(D, ribbon = FALSE)

(And please declare enough for someone to reproduce your example,
including of course loaded packages).

On Mon, Jul 1, 2013 at 11:27 PM, siqueira <siqueira at engin.umass.edu> wrote:
> Thank you for the quick reply Koen!
>
> ... however, that does not seem to work.  That is, maybe it has to do with
> the density function... I just don't know.
>
> That is, if I type what you suggested, I get plot with symbols, not a raster
> image.  I have included a snapshot of what I get if I execute the following
> commands in R
>
> data(lansing)
> D <- density(lansing)
> plot(D,main="tree density",axes=FALSE,legend=FALSE,box=FALSE)
>
> <http://r-sig-geo.2731867.n2.nabble.com/file/n7583966/R_colorbar_image.jpg>
>
> it is that colorbar at the right that I am trying to eliminate.
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-get-rid-of-colorbar-in-raster-images-tp7583964p7583966.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From siqueira at engin.umass.edu  Mon Jul  1 15:44:17 2013
From: siqueira at engin.umass.edu (siqueira)
Date: Mon, 1 Jul 2013 06:44:17 -0700 (PDT)
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
In-Reply-To: <CAAcGz99ODGwA91he3_bfAQCt79zc_s88yt_DeMdX+E0meLrmVA@mail.gmail.com>
References: <1372684519057-7583964.post@n2.nabble.com>
	<CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>
	<1372685253910-7583966.post@n2.nabble.com>
	<CAAcGz99ODGwA91he3_bfAQCt79zc_s88yt_DeMdX+E0meLrmVA@mail.gmail.com>
Message-ID: <1372686257666-7583968.post@n2.nabble.com>

That worked!  Thank you... and yes, please accept my apologies for not
including the packages.  With some of these things, "I don't know what I
don't know" which is what makes this difficult.  

For instance, who would have thunk that that thing was called the 'ribbon'. 
I was searching for "colorkey" and "colorbar", which of course produced
nothing.

thank you again!  Paul



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-get-rid-of-colorbar-in-raster-images-tp7583964p7583968.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From koen.hufkens at gmail.com  Mon Jul  1 15:44:43 2013
From: koen.hufkens at gmail.com (Koen Hufkens)
Date: Mon, 1 Jul 2013 15:44:43 +0200
Subject: [R-sig-Geo] how to get rid of colorbar in raster images
In-Reply-To: <CAAcGz99ODGwA91he3_bfAQCt79zc_s88yt_DeMdX+E0meLrmVA@mail.gmail.com>
References: <1372684519057-7583964.post@n2.nabble.com>
	<CAHDtqqk=yJkFKd3r+Lw1rpVi3+HC_avuYjF4M+EMPtjs4vKk0g@mail.gmail.com>
	<1372685253910-7583966.post@n2.nabble.com>
	<CAAcGz99ODGwA91he3_bfAQCt79zc_s88yt_DeMdX+E0meLrmVA@mail.gmail.com>
Message-ID: <CAHDtqqkRjJ1ZtNkdXDf0P_seoDG7StBn=s-Vaq5NbJh_129S-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/511913d9/attachment.pl>

From zua3 at CORNELL.EDU  Mon Jul  1 16:38:43 2013
From: zua3 at CORNELL.EDU (Zia Uddin Ahmed)
Date: Mon, 1 Jul 2013 14:38:43 +0000
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
	stack
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>

I am trying to calculate standard deviation map from a raster stack. I have got following error . Any  suggestion? 
> std<-sd(s)
Error in as.double(x) : 
  cannot coerce type 'S4' to vector of type 'double'

Thanks
Zia

fn <- system.file("external/test.grd", package="raster")
s <- stack(fn, fn)
r <- raster(fn)
s <- stack(r, fn)
nlayers(s)
m<-mean(s)
std<-sd(s)

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9     

loaded via a namespace (and not attached):
[1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4 
[5] xts_0.9-3        zoo_1.7-9       
>

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of ASANTOS
Sent: Sunday, June 23, 2013 4:08 PM
To: Sarah Goslee; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset image

Hi Dra. Goslee,

             I work in OS linux and I like very much your lssub function, despites your notice. I think that the problems are in linux system, because:

 > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
Error in .local(.Object, ...) :
   `/home/asantos/Documentos/Sensoriamento remoto percevejo bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file system, and is not recognised as a supported dataset name.

Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",  :
   Cannot create a RasterLayer object from this file. (file does not exist)


              When I try to look the geotiff created 
(stackIm1.sample.tif) there are something wrong, because the pictures 
doesn't open (complete example below).

Thanks for your attention,

Alexandre

require(raster)
require(sp)
require(rgdal)
require(landsat)
#
#Create raster
r <- raster(nc=1000, nr=1000)
set.seed(20130622)
stackIm1 <- stack(lapply(1, function(x) setValues(r, round(runif(ncell(r))* 255))))## Simulation red band
stackIm2 <- stack(lapply(1, function(x) setValues(r, round(runif(ncell(r))* 255))))## Simulation nir

# define projection system
r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m +no_defs")    # geographical datum WGS84
proj4string(stackIm1) <- r.geo
proj4string(stackIm2) <- r.geo
#

#Create geotiff
writeRaster(stackIm1, filename="stackIm1.tif", format="GTiff",overwrite=TRUE)
writeRaster(stackIm2, filename="stackIm2.tif", format="GTiff",overwrite=TRUE)
#

#Subset a geotiff image 50 x 50 pixels
stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx = 0, centery = 0, widthx = 50, widthy = 50)
stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", centerx = 0, centery = 0, widthx = 50, widthy = 50)
#
landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))





Em 23/06/2013 12:59, Sarah Goslee escreveu:
> Hi,
>
> What happens?
>
> Do you get an error? Where?
>
> What is your sessionInfo()?
>
> As it says in the lssub() help, this function was written for a
> particular purpose, is only known to work on linux, and may not be
> widely applicable.
>
> It's a "use at your own risk" kind of function, and you may well be
> better off using one of the many other methods available for
> subsetting raster data, which would save you the whole "export as
> GeoTIFF, subset, reimport" sequence.
>
> Sarah
>
> On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos
> <alexandresantosbr at yahoo.com.br> wrote:
>> Dear Members,
>>
>>
>> I'm having trouble calculating NDVI difference, first the images Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not get to the NDVI, follow an example:
>>
>> require(raster)
>> require(sp)
>> require(rgdal)
>> require(landsat)
>> #
>> #Create raster
>> r <- raster(nc=1000, nr=1000)
>> set.seed(20130622)
>> stackIm1 <- stack(lapply(1, function(x) setValues(r, round(runif(ncell(r))* 255))))## Simulation red band
>> stackIm2 <- stack(lapply(1, function(x) setValues(r, round(runif(ncell(r))* 255))))## Simulation nir
>>
>> # define projection system
>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m +no_defs")    # geographical datum WGS84
>> proj4string(stackIm1) <- r.geo
>> proj4string(stackIm2) <- r.geo
>> #
>>
>> #Create geotiff
>> writeRaster(stackIm1, filename="stackIm1.tif", format="GTiff",overwrite=TRUE)
>> writeRaster(stackIm2, filename="stackIm2.tif", format="GTiff",overwrite=TRUE)
>> #
>>
>> #Subset a geotiff image 50 x 50 pixels
>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx = 0, centery = 0, widthx = 50, widthy = 50)
>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", centerx = 0, centery = 0, widthx = 50, widthy = 50)
>> #
>>
>> #Calculate NDVI difference
>>
>> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>>
>> band3<-raster(multi.espc,1)
>> band4<-raster(multi.espc,2)
>>
>> ndvi<-(band4-band3)/(band4+band3)
>>
>> #
>>
>>
>>

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
Coordenador do curso T?cnico em Florestas
Vice Coordenador do curso de Engenharia Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 8132-8112 (TIM)   (+55) 65 9686-6970 (VIVO)

         alexandre.santos at cas.ifmt.edu.br

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Mon Jul  1 18:07:46 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 01 Jul 2013 18:07:46 +0200
Subject: [R-sig-Geo] what's new in asdar latest edition?
In-Reply-To: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
References: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
Message-ID: <51D1A952.7060602@uni-muenster.de>

Mathieu,

The second edition of "Applied Spatial Data Analysis with R" (asdar2)
seems to be shipping now, and contains the following changes to chapters:
- ch 6, "Classes for spatio-temporal Data", replaces the old ch 6,
"Customising spatial data classes and methods". The old ch 6 is now a
vignette in sp:
http://cran.r-project.org/web/packages/sp/vignettes/csdacm.pdf
- ch 7, "Spatial Point Pattern Analysis", pays, compared to the first
edition, more attention to package spatstat
- ch 9, Modelling Areal Data is a merge of the old ch 9, "Areal data
and spatial correlation" and ch 10, "Modelling areal data"
- Chapter 10 (former 11) has been expanded to include recent
developments in Bayesian modelling, including BayesX and R-INLA
packages, and new examples. Spatio-temporal models for disease mapping
are described now as well.

The second edition contains full colour figures, many new examples, and
addresses several new packages, in particular rgeos and spacetime.
References were updated or added. Code examples have been updated, e.g.
the use of overlay() was removed altogether in favour of over(),
aggregate() has been explained, and spatial selections based on
intersection are now done by x[y,] with y a Spatial* object.

After the spatial workshop at UseR!, next week (Jul 9, 17:45 CEST), a
little celebration will take place to launch the second edition --
everyone is invited! Roger and Virgilio will be there in person.
https://twitter.com/SpringerStats/statuses/350673280354615298

Book site:
http://www.springer.com/statistics/life+sciences%2C+medicine+%26+health/book/978-1-4614-7617-7

The first edition of the book has now appeared in a chinese translation:
http://www.openbookdata.com.cn/Book/MzA2NDAyOF9PU0dB.html

Best regards,

On 05/02/2013 12:17 PM, Mathieu Rajerison wrote:
> Hello,
> 
> 
> I've already bought asdar's previous edition.
> 
> It's an excellent book that I recommend. As a beginner in spatial stats, I
> learnt a lot and the content seemed accessible for me.
> 
> Apparently, there's a new edition of asdar book, which I don't know a lot
> about.
> 
> I'd like to know some reasons I'd have to buy the newest edition. New
> chapters, content?
> 
> 
> Mathieu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From roman.lustrik at gmail.com  Mon Jul  1 18:09:16 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 1 Jul 2013 18:09:16 +0200
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
	stack
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/64640e2e/attachment.pl>

From zua3 at cornell.edu  Mon Jul  1 18:30:35 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Mon, 1 Jul 2013 16:30:35 +0000
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
 stack
In-Reply-To: <CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAA96A5@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/fa4c1a6c/attachment.pl>

From vitale232 at gmail.com  Mon Jul  1 18:44:35 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Mon, 1 Jul 2013 09:44:35 -0700
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
	stack
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAA96A5@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAA96A5@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAFTcopeK-4i-4NdBCTas02UXezHJ9Nt1v5YFStGXhuSioRefqw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/b08db4f3/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Jul  1 18:54:01 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 1 Jul 2013 17:54:01 +0100
Subject: [R-sig-Geo] what's new in asdar latest edition?
In-Reply-To: <27905e41ab6e46babdd3899a0db8ec1a@EX-1-HT0.lancs.local>
References: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
	<27905e41ab6e46babdd3899a0db8ec1a@EX-1-HT0.lancs.local>
Message-ID: <CANVKczM5Hb2EqXO_u7dH2UOaQbCoQEbC=OV65DnPcBCcbzmWqA@mail.gmail.com>

On Mon, Jul 1, 2013 at 5:07 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:

> The second edition contains full colour figures, many new examples, and
> addresses several new packages, in particular rgeos and spacetime.
> References were updated or added. Code examples have been updated, e.g.
> the use of overlay() was removed altogether in favour of over(),
> aggregate() has been explained, and spatial selections based on
> intersection are now done by x[y,] with y a Spatial* object.
>
> After the spatial workshop at UseR!, next week (Jul 9, 17:45 CEST), a
> little celebration will take place to launch the second edition --
> everyone is invited! Roger and Virgilio will be there in person.
> https://twitter.com/SpringerStats/statuses/350673280354615298

 Sounds great - if you send me a free copy I'll plug it at the
workshop I'm doing for ecologists next week - 90 of them, that should
generate some sales!

 Any mention of package:raster?

congrates

Barry


From zua3 at cornell.edu  Mon Jul  1 19:14:12 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Mon, 1 Jul 2013 17:14:12 +0000
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
 stack
In-Reply-To: <CAFTcopeK-4i-4NdBCTas02UXezHJ9Nt1v5YFStGXhuSioRefqw@mail.gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAA96A5@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcopeK-4i-4NdBCTas02UXezHJ9Nt1v5YFStGXhuSioRefqw@mail.gmail.com>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAA977B@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/3b63c6e2/attachment.pl>

From momadou at yahoo.fr  Mon Jul  1 20:14:09 2013
From: momadou at yahoo.fr (Komine)
Date: Mon, 1 Jul 2013 11:14:09 -0700 (PDT)
Subject: [R-sig-Geo] Space between grid and raster
Message-ID: <1372702449810-7583977.post@n2.nabble.com>

Dear, 
I use gps points into UTM coordinates to do a raster.
My code runs well, however the raster overlays the grid of the raster,
specially on the right and left sides.
Now I want to have an space between the raster and the grid on the right and
left sides.
Below my code:

>library(raster)   
>testo<-rasterFromXYZ(Image) 
>plot(testo)
>plot(testo,col=(terrain.colors(255)))
>testo2 <- aggregate(testo,fact=13, fun=mean) 
>plot(testo2)

Your help will be greatly appreciate 
Komine 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Space-between-grid-and-raster-tp7583977.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vitale232 at gmail.com  Mon Jul  1 21:13:00 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Mon, 1 Jul 2013 12:13:00 -0700
Subject: [R-sig-Geo] Error creating a standard deviation map from raster
	stack
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAA977B@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAA95E1@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAHT1vphO1H+ZstmaEPWuGhYQpawmxvFnEfD9EwkucQHT3E-ntQ@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAA96A5@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcopeK-4i-4NdBCTas02UXezHJ9Nt1v5YFStGXhuSioRefqw@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAA977B@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAFTcopfHTNrCvz+iDWzYmJVYuUKS8gV+HSNQG7ac6F0DbTex1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/d553dd23/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Jul  1 22:21:10 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 01 Jul 2013 22:21:10 +0200
Subject: [R-sig-Geo] what's new in asdar latest edition?
In-Reply-To: <CANVKczM5Hb2EqXO_u7dH2UOaQbCoQEbC=OV65DnPcBCcbzmWqA@mail.gmail.com>
References: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
	<27905e41ab6e46babdd3899a0db8ec1a@EX-1-HT0.lancs.local>
	<CANVKczM5Hb2EqXO_u7dH2UOaQbCoQEbC=OV65DnPcBCcbzmWqA@mail.gmail.com>
Message-ID: <51D1E4B6.2010704@uni-muenster.de>



On 07/01/2013 06:54 PM, Barry Rowlingson wrote:
> On Mon, Jul 1, 2013 at 5:07 PM, Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> wrote:
> 
>> The second edition contains full colour figures, many new examples, and
>> addresses several new packages, in particular rgeos and spacetime.
>> References were updated or added. Code examples have been updated, e.g.
>> the use of overlay() was removed altogether in favour of over(),
>> aggregate() has been explained, and spatial selections based on
>> intersection are now done by x[y,] with y a Spatial* object.
>>
>> After the spatial workshop at UseR!, next week (Jul 9, 17:45 CEST), a
>> little celebration will take place to launch the second edition --
>> everyone is invited! Roger and Virgilio will be there in person.
>> https://twitter.com/SpringerStats/statuses/350673280354615298
> 
>  Sounds great - if you send me a free copy I'll plug it at the
> workshop I'm doing for ecologists next week - 90 of them, that should
> generate some sales!

I would have liked to, but haven't received any author copies so far.

>  Any mention of package:raster?

Yes, chapters 2, 3 and 5 do have sections about raster, but in the
foreword to the second edition we mention that "We have not attempted to
cover the raster package in the detail that it deserves, hoping that a
raster book will appear before long."

> 
> congrates

Thanks, and have fun with the ecologists!

> Barry
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From r.hijmans at gmail.com  Mon Jul  1 23:31:57 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 1 Jul 2013 14:31:57 -0700
Subject: [R-sig-Geo] aggregate() error on large files in raster
In-Reply-To: <CAHDtqqmWX69=MUG8dt+=EuNv7ZJ1k8_wT3d=WWyaSGsqESrEuA@mail.gmail.com>
References: <CAHDtqqmWX69=MUG8dt+=EuNv7ZJ1k8_wT3d=WWyaSGsqESrEuA@mail.gmail.com>
Message-ID: <CANtt_hyp_BuxrVppAwawKb5nZxpTi8srsZQJ=N++kCSQnfvHAg@mail.gmail.com>

Koen,
That's a bug. You can, indeed, avoid it by using expand=TRUE (perhaps
followed by crop to remove the expanded area). This will be fixed in
next version of raster.
Robert

On Mon, Jul 1, 2013 at 5:49 AM, Koen Hufkens <koen.hufkens at gmail.com> wrote:
> Hi everyone,
>
> I've been experiencing errors using the aggregate() raster function on
> large files. It only seems to happen when using the expand=FALSE option.
>
> The warning I get reads:
>
> Warning message:
> In .rasterFromRasterFile(grdfile, band = band, objecttype) :
>   size of values file does not match the number of cells (given the data
> type)
>
> And most of the time the bottom rows of the resulting aggregated image
> contains values that read -3.4e+38 (which to me is rather arbitrairy).
>
> I'm running:
> R version 3.0.1 (2013-05-16) -- "Good Sport"
> Platform: x86_64-pc-linux-gnu (64-bit)
> raster 2.1-37
>
> Any clues on how to solve this would be appreciated. The error also seems
> to be limited to large files > 5000 x 5000 pixels or so.
>
> Best,
> Koen
>
>
> --------------
> a copy of the example code:
>
>
>> # aggregate error on large files
>>
>> # read image
>> img <- mean(brick('/home/khufkens/virton.tif'))
>> # show image info
>> img
> class       : RasterLayer
> dimensions  : 10342, 10342, 106956964  (nrow, ncol, ncell)
> resolution  : 0.7464698, 0.7464698  (x, y)
> extent      : 611736.7, 619456.7, 6379237, 6386957  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs
> data source :
> /tmp/R_raster_tmp/khufkens/raster_tmp_2013-07-01_142516_99728.grd
> names       : layer
> values      : 0, 213.3333  (min, max)
>
>> # set window size
>> windowsize <- 81
>
>> zones <- aggregate(img,fact=windowsize,fun=mean,expand=TRUE,na.rm=TRUE)
>> # show results info
>> zones
> class       : RasterLayer
> dimensions  : 128, 128, 16384  (nrow, ncol, ncell)
> resolution  : 60.46405, 60.46405  (x, y)
> extent      : 611736.7, 619476.1, 6379218, 6386957  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs
> data source :
> /tmp/R_raster_tmp/khufkens/raster_tmp_2013-07-01_142555_110676.grd
> names       : layer
> values      : 24.63222, 138.7439  (min, max)
>
>> zones <- aggregate(img,fact=windowsize,fun=mean,expand=FALSE,na.rm=TRUE)
>> # BAM!
> Warning message:
> In .rasterFromRasterFile(grdfile, band = band, objecttype) :
>   size of values file does not match the number of cells (given the data
> type)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From blows_michael at yahoo.com  Mon Jul  1 23:33:31 2013
From: blows_michael at yahoo.com (Michael Blows)
Date: Mon, 1 Jul 2013 14:33:31 -0700 (PDT)
Subject: [R-sig-Geo] weighting function
Message-ID: <1372714411.71267.YahooMailNeo@web161206.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130701/0e6d1cd3/attachment.pl>

From r.hijmans at gmail.com  Mon Jul  1 23:33:56 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 1 Jul 2013 14:33:56 -0700
Subject: [R-sig-Geo] reclassify() on large files
In-Reply-To: <CAHDtqqmmA=eacEXxKsqYV0vsH-Vg=RDTV0CsN6ArcE6UBpE2Cg@mail.gmail.com>
References: <CAHDtqqmmA=eacEXxKsqYV0vsH-Vg=RDTV0CsN6ArcE6UBpE2Cg@mail.gmail.com>
Message-ID: <CANtt_hwMWeYbLtOdY7FfRpd7Okh8fdF6h+JujcVUh6SihqA-Cg@mail.gmail.com>

Koen, Clearly there is something wrong with 'zones', and probably not
with reclassify. The problem with zones probably stems from the error
you can get when using aggregate(... , expand=F) that you reported in
another message. Robert

On Thu, Jun 27, 2013 at 1:21 AM, Koen Hufkens <koen.hufkens at gmail.com> wrote:
> Hi all,
>
> I'm trying reclassify an image but I keep hitting upon the error:
>
> R <- reclassify(zones,rcl.r)
>
> Error in setValues(out, .Call("reclass", values(x), rcl, include.lowest,  :
>   length(values) is not equal to ncell(x), or to 1
>
> If I plot the 'zones' RasterLayer I also get this error:
>
> plot(zones)
>
> Warning message:
> In matrix(x, ncol = cr[1], nrow = cr[2], byrow = TRUE) :
>   data length [25740] is not a sub-multiple or multiple of the number of
> rows [159]
>
> where 'zones' is the output of the aggregate() function.
>
> Both are related as it does not occur if I use a smaller image although the
> procedure is exactly the same.
>
> Any clues on why this is, and how to solve it?
>
> Thanks in advance,
> Koen
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Mon Jul  1 23:35:48 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 1 Jul 2013 14:35:48 -0700
Subject: [R-sig-Geo] trouble with the 'focal' function in 'raster'
In-Reply-To: <CAHDtqqmMCsrO+JcEcsJ+3vX3vWu3W_q5rvME6Fq1diwcV5XJiA@mail.gmail.com>
References: <CAP0b_6DDEZN0P30ZsAzVzx5xRR6u88v7jMWc2_hcxsDp-bGwww@mail.gmail.com>
	<CAHDtqqmMCsrO+JcEcsJ+3vX3vWu3W_q5rvME6Fq1diwcV5XJiA@mail.gmail.com>
Message-ID: <CANtt_hy5wmzxB1POex0U5byoz+N21P1a-t=jkXZdoX4eo=N6nw@mail.gmail.com>

Marcia,

This is a bug that is caused by
> mean(NA, na.rm=T)
[1] NaN

Because of this, "newr" will have NaN values. These are equivalent to
NA in the R "is.na" function but not in the C macro R_ISNA that is
used by focal.  Anyway, here is a work-around for the current version
of raster:

library(raster)
r <- raster(ncols=60, nrows=60, xmn=0)
r[] <- 1:(60*60)
values(r)[5]<-NA
values(r)[(30*30):(60*60)]<-NA
values(r)[round(runif(3000,1,3600))]<-NA
w = matrix(1,3,3)

for (i in 1:40){
newr <- focal(r, w=w, fun=mean, na.rm=T, pad=TRUE, padValue=NA, NAonly=TRUE)
r <- calc(newr, function(x){ x[is.nan(x)] = NA; x})
}

On Mon, Jun 24, 2013 at 7:14 AM, Koen Hufkens <koen.hufkens at gmail.com> wrote:
> This works on a system on which your code doesn't (ubuntu x64 / R 3.0.1 /
> raster 2.1-37).
>
> library(raster)
> r <- raster(ncols=60, nrows=60, xmn=0)
> r[] <- 1:(60*60)
> values(r)[5]<-NA
> values(r)[(30*30):(60*60)]<-NA
> values(r)[round(runif(3000,1,3600))]<-NA
>
> for (i in 1:40){
>   if (i==1){
>     writeRaster(focal(r,w=3, fun=mean, na.rm=F, pad=TRUE, padValue=NA,
> NAonly=TRUE),'tmp.tif',overwrite=TRUE)
>   }else{
>   t <- raster('tmp.tif')
>   writeRaster(focal(t,w=3, fun=mean, na.rm=F, pad=TRUE, padValue=NA,
> NAonly=TRUE),'tmp.tif',overwrite=TRUE)
>   }
>
> } # end loop i
>
> plot(raster('tmp.tif'))
>
>
> Somehow the history of the file gets in the way of your iterative approach,
> writing to file decouples the original from the new file. This is either a
> safeguard, or the file structure/content isn't properly updated, Robert
> Hijmans should know the details on which is which.
>
> Cheers,
> Koen
>
>
>
> On Mon, Jun 24, 2013 at 3:00 PM, Marcia Macedo <marcia.n.macedo at gmail.com>wrote:
>
>> Hi All,
>>
>> I am trying to use the focal function to iteratively fill NA's in a raster,
>> but am having trouble running it on my system. A colleague who was kindly
>> helping me troubleshoot my code noticed that it ran as expected with an
>> earlier version of R and the 'raster' package.
>>
>> The following example runs well on his setup (i.e., NA's are gradually
>> filled in with each iteration), but not on mine (i.e., the raster only
>> changes in the first iteration).
>>
>> #################################################################
>> # A test raster with plenty of NAs
>>
>> r <- raster(ncols=60, nrows=60, xmn=0)
>> r[] <- 1:(60*60)
>> values(r)[5]<-NA
>> values(r)[(30*30):(60*60)]<-NA
>> values(r)[round(runif(3000,1,3600))]<-NA
>>
>> for (i in 1:40){
>>
>> newr <- focal(r,w=3, fun=mean, na.rm=T, pad=TRUE, padValue=NA, NAonly=TRUE)
>>
>>  print(table(is.na(r[]),is.na(newr[])))
>>
>> r<-newr
>>
>> } # end loop i
>>
>> #################################################################
>> *The above code works on:*
>>
>> (Windows 7)
>> R version 2.15.0
>> raster 1.9-99 (1-June-2012)
>>
>> *It doesn't work on:*
>>
>> (Windows 7)
>> R version 3.0.1
>> raster 2.1-38
>>
>> The latter setup also gives the following warning message with each
>>  iteration:
>>
>> *In .getW(w): the computation of the weights matrix has changed in version
>> 2.1-35. The sum of weights is now 1.*
>>
>> Is it possible that the arguments for the function have been changed in the
>> most recent update, but not in the documentation? Any thoughts about what
>> might be going on would much appreciated!
>>
>> Best,
>> Marcia
>>
>> ---------------------------------------
>> *Marcia Macedo*
>> Postdoctoral Fellow
>> Woods Hole Research Center
>> mmacedo at whrc.org
>> 508.444.1538
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From babuawara at gmail.com  Tue Jul  2 08:43:15 2013
From: babuawara at gmail.com (vikram ranga)
Date: Tue, 2 Jul 2013 12:13:15 +0530
Subject: [R-sig-Geo] multiple ring buffer
Message-ID: <CAL-ALVGaqnMsHs=pxPBmF=rjSeDeObt-tMZ+wgTwH9Ax+hqtZg@mail.gmail.com>

Dear all,
I am trying to make multiple ring buffers using points; I have created
buffers of different widths using gBuffer from library(rgeos) but this
does not solve my purpose. I want to have three different rings of
varying widths for each point.
gUnion is not useful in this case as point are close enough and the
boundaries of different polygons overlaps.

Can anyone suggest how to achieve this in R as I do not want to turn
to ArcGIS for it.

Thanks in advance,

Vikram.


From koen.hufkens at gmail.com  Tue Jul  2 08:47:18 2013
From: koen.hufkens at gmail.com (Koen Hufkens)
Date: Tue, 2 Jul 2013 08:47:18 +0200
Subject: [R-sig-Geo] reclassify() on large files
In-Reply-To: <CANtt_hwMWeYbLtOdY7FfRpd7Okh8fdF6h+JujcVUh6SihqA-Cg@mail.gmail.com>
References: <CAHDtqqmmA=eacEXxKsqYV0vsH-Vg=RDTV0CsN6ArcE6UBpE2Cg@mail.gmail.com>
	<CANtt_hwMWeYbLtOdY7FfRpd7Okh8fdF6h+JujcVUh6SihqA-Cg@mail.gmail.com>
Message-ID: <CAHDtqqmw3amkU=1xvbfNLHtO2dYEcdSCaveLGZwFFuDiMq_-vA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/8c50b799/attachment.pl>

From ubuntero.9161 at gmail.com  Tue Jul  2 09:31:35 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Tue, 2 Jul 2013 10:31:35 +0300
Subject: [R-sig-Geo] dismo:::gmap - how to obtain a 1:1 plot
Message-ID: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>

Dear R-geo folks,

I am trying to plot some points with gmap(), but the resulting plot is
not the same quality as the (temporarily) stored TIFF file.

My workflow is as follows:

1. get the point coordinates and make them a SpatialPointsDataFrame
2. get a map tile containing the points: localities_map <-
gmap(localities, type = 'terrain', scale = 2) # to get a larger tile
3. re-project localities to Mercator
4. plot(localities_map) and
5. add the points

The the problem is that the resulting plot seems not to be a 1:1
representation of the TIFF file it's based on. I have also tried to
plot directly to a png() device, and even when specifying the size
*and* resolution reported by the RasterLayer where the gmap object is
stored, the plotted map (especially the labels) looks somewhat jagged.

 Is there a way to produce a plot that contains the stored TIFF file
as it is (i.e. 1:1)?

Thanks,
Ivailo
--
UBUNTU: a person is a person through other persons.


From a.m.hasnein at gmail.com  Tue Jul  2 10:48:06 2013
From: a.m.hasnein at gmail.com (hasnein)
Date: Tue, 2 Jul 2013 01:48:06 -0700 (PDT)
Subject: [R-sig-Geo] Standardise color bar for different automap plot
Message-ID: <1372754886349-7583987.post@n2.nabble.com>

Hi,

I am plotting interpolation result using autoPlot function of automap
package. As the interpolation values varies slightly from plot to plot, so
is the colorbar values as well. How can I make the colorbar with a standard
value so that all the plots are comparable with a single color bar?

I used the code as below:
******************************
cuts
<-seq(min(interpol.output$var1.pred),max(interpol.output$var1.pred),length.out=8)
cuts = round(cuts,digits=0)
col.regions = brewer.pal(length(cuts)+3-2, "YlOrRd")
a <- list("sp.points", pts, col= "red", pch = 16, cex = 1, lwd = 1)
automapPlot(interpol.output, "var1.pred", pretty=TRUE, sp.layout = list(a),
scales = list(draw=T),xlab = expression("Longitude"^o),            ylab =
expression("Latitude"^o), main = "Interpolated hydroperiods", spplot = NULL)
******************************



Any help would be very helpful, Thanks,

Hasnein



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Standardise-color-bar-for-different-automap-plot-tp7583987.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From babuawara at gmail.com  Tue Jul  2 13:16:45 2013
From: babuawara at gmail.com (vikram ranga)
Date: Tue, 2 Jul 2013 16:46:45 +0530
Subject: [R-sig-Geo] R help
In-Reply-To: <65B18893-FE8C-4547-A49E-EC3DCFA56545@gmail.com>
References: <65B18893-FE8C-4547-A49E-EC3DCFA56545@gmail.com>
Message-ID: <CAL-ALVHyYO_n1PQ=CrVtXSEh0ihbjQ7db=eOLiNzjX39PiqM4Q@mail.gmail.com>

Hi Kevin,

Thank you very much for your email and time.
I appreciate it greatly,
I worked with gDifference from rgeos, also suggested by Alex. It works
fine but it gives you SpatialPolygons instead of
SpatialPolygonsDataFrame.
In addition to that the row.names are lost which add to complexity in
matching and attaching the original data.

I figured out another way:- as my goal was to get information from
different rings at different distances.
therefore, I counted the number of points in one ring and substracted
the number from the lower buffer--gave me exclusive numbers for a
ring.
The column I got, was then used to do some arithmetics and results
came out fine. this is bit simpler (but took me longer to figure this
out).

Cheers,

Vikram.

On Tue, Jul 2, 2013 at 3:53 PM, Kevin Cazelles <kevin.cazelles at gmail.com> wrote:
> Hi Vikram,
>
>
> I am not sure this will help, but if the main issue is the overlap, try to
> use "gDiff".
> Here a complete example (I use locator(), to generate points, you just have
> to click on the plot !) :
>
> #------------------------------
> library(rgeos)
> #------------------------------
> plot(c(-10,10),c(-10,10), col=0, main="Points", xlab="", ylab="Latitude
> (?)")
> nbp <- 3
> coordpt <- locator(nbp)
> datapt <- runif(nbp, 1,4)
> points(coordpt, col=1, pch=20)
> #------------------------------
> ptsp <- SpatialPoints(cbind(coordpt$x, coordpt$y),
> proj4string=CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
> +towgs84=0,0,0"))
> #------------------------------
>
> Diff1 <- gDifference(gBuffer(ptsp, width=2), gBuffer(ptsp, width=1.7))
> Diff2 <- gDifference(gBuffer(ptsp, width=1.5), gBuffer(ptsp, width=1.2))
> Diff3 <- gDifference(gBuffer(ptsp, width=1), gBuffer(ptsp, width=0.5))
>
> plot(Diff1, add=T, col=3)
> plot(Diff2, add=T, col=7)
> plot(Diff3, add=T, col=2)
>
>
> Have a nice day !
>
>
>
> =====================================
> Kevin Cazelles
> kevin.cazelles at gmail.com
> Pdh Student
> Institut des Sciences de Montpellier (ISEM)
> Universit? du Quebec ? Rimouski (UQAR)
>
>
> "On n'est jamais trop vieux pour grandir."
>
>               ?                                                           ?
>                ??                                                   ??
>                   ??                                              ??
>                     ???         ________        ???
>                        ???  $$$            $$$  ???
>                          ???    ___     ___   ???
>                    < ?  ???      _____    ???  ? >
>                 < ?___???                 ???___ ? >
>               <  ? ====  ??              ??  ====  ?  >
>              <   ?   /       \  ??           ??  /       \    ?   >
>             <   ?   |  @   |   ??   /\   ??  |   @  |   ?   >
>              <   ?   \  __ /    ?? / _\ ??   \  __ /   ?   >
>                 <   ?              ?? \    / ??             ?   >
>                   <   ?????     __  \/  __    ?????   >
>                      $$$    +++                 +++   $$$
>                            $$_____________$$
>
>
>
>
>
>
>
>
>
>


From villers.alexandre at gmail.com  Tue Jul  2 13:40:11 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Tue, 2 Jul 2013 14:40:11 +0300
Subject: [R-sig-Geo] dismo:::gmap - how to obtain a 1:1 plot
In-Reply-To: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>
References: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>
Message-ID: <51D2BC1B.6030808@gmail.com>

Hi,

There is an asp options in par. It works with plot and image
plot(x,y, asp=1) or image(x, asp=1) should produce what you're looking for

HTH

Alex

On 02/07/2013 10:31, Ivailo wrote:
> Dear R-geo folks,
>
> I am trying to plot some points with gmap(), but the resulting plot is
> not the same quality as the (temporarily) stored TIFF file.
>
> My workflow is as follows:
>
> 1. get the point coordinates and make them a SpatialPointsDataFrame
> 2. get a map tile containing the points: localities_map <-
> gmap(localities, type = 'terrain', scale = 2) # to get a larger tile
> 3. re-project localities to Mercator
> 4. plot(localities_map) and
> 5. add the points
>
> The the problem is that the resulting plot seems not to be a 1:1
> representation of the TIFF file it's based on. I have also tried to
> plot directly to a png() device, and even when specifying the size
> *and* resolution reported by the RasterLayer where the gmap object is
> stored, the plotted map (especially the labels) looks somewhat jagged.
>
>   Is there a way to produce a plot that contains the stored TIFF file
> as it is (i.e. 1:1)?
>
> Thanks,
> Ivailo
> --
> UBUNTU: a person is a person through other persons.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Tue Jul  2 13:52:29 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 2 Jul 2013 13:52:29 +0200
Subject: [R-sig-Geo] weighting function
In-Reply-To: <1372714411.71267.YahooMailNeo@web161206.mail.bf1.yahoo.com>
References: <1372714411.71267.YahooMailNeo@web161206.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1307021346310.5145@reclus.nhh.no>

On Mon, 1 Jul 2013, Michael Blows wrote:

> Hi R sig geo community!
> does the current version of SPGWR use? wij = exp(-(d/h)^2) or wij = 
> exp(-0.5*(d/h)^2)as weighting function?
> Thanks,
> Mike

R 101? To see what the R code does, enter the name of the function at the 
prompt. The default weighting function is gwr.Gauss (see ?gwr), so:

> gwr.Gauss
function (dist2, bandwidth)
{
     w <- exp((-0.5) * ((dist2)/(bandwidth^2)))
     w
}

and ?gwr.Gauss says:

dist2: vector of squared distances between observations and fit point

Until 0.5, gwr.gauss was used, as the help page says; the current release 
is 0.6-21.

> 	[[alternative HTML version deleted]]

Please do not post HTML!

Hope this clarifies,

Roger


>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From vetter at pik-potsdam.de  Tue Jul  2 15:37:02 2013
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Tue, 02 Jul 2013 15:37:02 +0200
Subject: [R-sig-Geo] Huge kriging weights when using kriging with external
	drift in gstat
Message-ID: <51D2D77E.6070802@pik-potsdam.de>

Dear  all,
I am interpolating automatically  daily air temperature values using 
kriging with external drift (altitude) and the library gstat. From time 
to time (quite random) I get unrealistic predictions like -400?C with 
very high kriging weights   like 2000.
  Looking at the data everything seems to be ok.  Then I changed the 
variogram ranges  a little bit and the problem disappears.
How can this behavior be explained?

  I  have attached a small  example script for demonstration  and some data.

Thanks you
Tobias
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example.R
Type: application/x-extension-r
Size: 1236 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/1290aff5/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: points2.Data
Type: application/octet-stream
Size: 865 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/1290aff5/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mypoint.Data
Type: application/octet-stream
Size: 343 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/1290aff5/attachment-0001.obj>

From edzer.pebesma at uni-muenster.de  Tue Jul  2 16:05:33 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 02 Jul 2013 16:05:33 +0200
Subject: [R-sig-Geo] Huge kriging weights when using kriging with
 external drift in gstat
In-Reply-To: <51D2D77E.6070802@pik-potsdam.de>
References: <51D2D77E.6070802@pik-potsdam.de>
Message-ID: <51D2DE2D.4080600@uni-muenster.de>

Tobias, try using another variogram model: the linear model with sill is
not positive definite in more than one dimension (and yes: a warning
about this would have been very nice!)

On 07/02/2013 03:37 PM, Tobias Vetter wrote:
> Dear  all,
> I am interpolating automatically  daily air temperature values using
> kriging with external drift (altitude) and the library gstat. From time
> to time (quite random) I get unrealistic predictions like -400?C with
> very high kriging weights   like 2000.
>  Looking at the data everything seems to be ok.  Then I changed the
> variogram ranges  a little bit and the problem disappears.
> How can this behavior be explained?
> 
>  I  have attached a small  example script for demonstration  and some data.
> 
> Thanks you
> Tobias
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From vetter at pik-potsdam.de  Tue Jul  2 16:16:31 2013
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Tue, 02 Jul 2013 16:16:31 +0200
Subject: [R-sig-Geo] Huge kriging weights when using kriging with
 external drift in gstat
In-Reply-To: <51D2DE2D.4080600@uni-muenster.de>
References: <51D2D77E.6070802@pik-potsdam.de>
	<51D2DE2D.4080600@uni-muenster.de>
Message-ID: <51D2E0BF.5070307@pik-potsdam.de>

Thank you.
So as long as all my distances   are smaller than the range I will not 
have this problem?
Tobias
> Tobias, try using another variogram model: the linear model with sill is
> not positive definite in more than one dimension (and yes: a warning
> about this would have been very nice!)
>
> On 07/02/2013 03:37 PM, Tobias Vetter wrote:
>> Dear  all,
>> I am interpolating automatically  daily air temperature values using
>> kriging with external drift (altitude) and the library gstat. From time
>> to time (quite random) I get unrealistic predictions like -400?C with
>> very high kriging weights   like 2000.
>>   Looking at the data everything seems to be ok.  Then I changed the
>> variogram ranges  a little bit and the problem disappears.
>> How can this behavior be explained?
>>
>>   I  have attached a small  example script for demonstration  and some data.
>>
>> Thanks you
>> Tobias
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


From edzer.pebesma at uni-muenster.de  Tue Jul  2 16:28:38 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 02 Jul 2013 16:28:38 +0200
Subject: [R-sig-Geo] Huge kriging weights when using kriging with
 external drift in gstat
In-Reply-To: <51D2E0BF.5070307@pik-potsdam.de>
References: <51D2D77E.6070802@pik-potsdam.de>
	<51D2DE2D.4080600@uni-muenster.de>
	<51D2E0BF.5070307@pik-potsdam.de>
Message-ID: <51D2E396.7070303@uni-muenster.de>

Right, I believe the linear model without sill -- vgm(1, "Lin", 0) --
does work; note that the 1 in this case is a slope, no longer a partial
sill. You may also set the range to a value larger than the maximum
possible distance.

On 07/02/2013 04:16 PM, Tobias Vetter wrote:
> Thank you.
> So as long as all my distances   are smaller than the range I will not
> have this problem?
> Tobias
>> Tobias, try using another variogram model: the linear model with sill is
>> not positive definite in more than one dimension (and yes: a warning
>> about this would have been very nice!)
>>
>> On 07/02/2013 03:37 PM, Tobias Vetter wrote:
>>> Dear  all,
>>> I am interpolating automatically  daily air temperature values using
>>> kriging with external drift (altitude) and the library gstat. From time
>>> to time (quite random) I get unrealistic predictions like -400?C with
>>> very high kriging weights   like 2000.
>>>   Looking at the data everything seems to be ok.  Then I changed the
>>> variogram ranges  a little bit and the problem disappears.
>>> How can this behavior be explained?
>>>
>>>   I  have attached a small  example script for demonstration  and
>>> some data.
>>>
>>> Thanks you
>>> Tobias
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From momadou at yahoo.fr  Tue Jul  2 19:35:22 2013
From: momadou at yahoo.fr (Komine)
Date: Tue, 2 Jul 2013 10:35:22 -0700 (PDT)
Subject: [R-sig-Geo] Export raster from R to Arcgis
Message-ID: <1372786522374-7583995.post@n2.nabble.com>

Dear,
My objective is to save a raster created with R and to open it with Arcgis
in maintaining spatial reference.
I used GPS points (XYZ, spatial reference: WGS 84, UTM) with which I created
a raster following this code:

> Image<-read.table("C:\\Users\\Documents\\data.txt",sep="",dec=",",header=TRUE) 
> library(raster)   
> testo<-rasterFromXYZ(Image) 
> map<-plot(testo)

Then, I save the output by clicking < File < save < and to choose format
(.tif).
However, When I open the output with Arcgis, it has not spatial reference. 
How to save the output into .tif in maintaining the spatial reference. 
Thank you in advance 
Komine 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Export-raster-from-R-to-Arcgis-tp7583995.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From villers.alexandre at gmail.com  Tue Jul  2 19:38:54 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Tue, 2 Jul 2013 20:38:54 +0300
Subject: [R-sig-Geo] Export raster from R to Arcgis
In-Reply-To: <1372786522374-7583995.post@n2.nabble.com>
References: <1372786522374-7583995.post@n2.nabble.com>
Message-ID: <CAFrtd2N3h4BvR21ABMQc0J1sk9xZqYzhvOyo_FVsUaJeFVkCYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/1252a867/attachment.pl>

From zua3 at cornell.edu  Tue Jul  2 19:47:52 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Tue, 2 Jul 2013 17:47:52 +0000
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack in
	loop
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/b6f37dbd/attachment.pl>

From momadou at yahoo.fr  Tue Jul  2 20:59:16 2013
From: momadou at yahoo.fr (Komine)
Date: Tue, 2 Jul 2013 11:59:16 -0700 (PDT)
Subject: [R-sig-Geo] Export raster from R to Arcgis
In-Reply-To: <1372786522374-7583995.post@n2.nabble.com>
References: <1372786522374-7583995.post@n2.nabble.com>
Message-ID: <1372791556768-7583998.post@n2.nabble.com>

Alexandre, Thank so much, now it is well.
Komine



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Export-raster-from-R-to-Arcgis-tp7583995p7583998.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Tue Jul  2 21:16:28 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 2 Jul 2013 21:16:28 +0200
Subject: [R-sig-Geo] what's new in asdar latest edition?
In-Reply-To: <51D1A952.7060602@uni-muenster.de>
References: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
	<51D1A952.7060602@uni-muenster.de>
Message-ID: <alpine.LRH.2.03.1307022113250.7096@reclus.nhh.no>

On Mon, 1 Jul 2013, Edzer Pebesma wrote:

> Mathieu,
>
> The second edition of "Applied Spatial Data Analysis with R" (asdar2)
> seems to be shipping now, and contains the following changes to chapters:
> - ch 6, "Classes for spatio-temporal Data", replaces the old ch 6,
> "Customising spatial data classes and methods". The old ch 6 is now a
> vignette in sp:
> http://cran.r-project.org/web/packages/sp/vignettes/csdacm.pdf
> - ch 7, "Spatial Point Pattern Analysis", pays, compared to the first
> edition, more attention to package spatstat
> - ch 9, Modelling Areal Data is a merge of the old ch 9, "Areal data
> and spatial correlation" and ch 10, "Modelling areal data"
> - Chapter 10 (former 11) has been expanded to include recent
> developments in Bayesian modelling, including BayesX and R-INLA
> packages, and new examples. Spatio-temporal models for disease mapping
> are described now as well.

The book website, http://www.asdar-book.org, now has the second edition 
code, code+data bundles, and errata. We'd be grateful for reports on 
mistakes and things that don't work to add to the errata, so that 
users/readers can keep running smoothly. We don't yet have the code for 
INLA, WinBUGS or GRASS up yet - to follow.

Roger

>
> The second edition contains full colour figures, many new examples, and
> addresses several new packages, in particular rgeos and spacetime.
> References were updated or added. Code examples have been updated, e.g.
> the use of overlay() was removed altogether in favour of over(),
> aggregate() has been explained, and spatial selections based on
> intersection are now done by x[y,] with y a Spatial* object.
>
> After the spatial workshop at UseR!, next week (Jul 9, 17:45 CEST), a
> little celebration will take place to launch the second edition --
> everyone is invited! Roger and Virgilio will be there in person.
> https://twitter.com/SpringerStats/statuses/350673280354615298
>
> Book site:
> http://www.springer.com/statistics/life+sciences%2C+medicine+%26+health/book/978-1-4614-7617-7
>
> The first edition of the book has now appeared in a chinese translation:
> http://www.openbookdata.com.cn/Book/MzA2NDAyOF9PU0dB.html
>
> Best regards,
>
> On 05/02/2013 12:17 PM, Mathieu Rajerison wrote:
>> Hello,
>>
>>
>> I've already bought asdar's previous edition.
>>
>> It's an excellent book that I recommend. As a beginner in spatial stats, I
>> learnt a lot and the content seemed accessible for me.
>>
>> Apparently, there's a new edition of asdar book, which I don't know a lot
>> about.
>>
>> I'd like to know some reasons I'd have to buy the newest edition. New
>> chapters, content?
>>
>>
>> Mathieu
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ubuntero.9161 at gmail.com  Tue Jul  2 21:28:58 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Tue, 2 Jul 2013 22:28:58 +0300
Subject: [R-sig-Geo] dismo:::gmap - how to obtain a 1:1 plot
In-Reply-To: <51D2BC1B.6030808@gmail.com>
References: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>
	<51D2BC1B.6030808@gmail.com>
Message-ID: <CAAVnHstOboNogET++gJ6i+LS2gN809ZcmkXWZKf3qTxaBzPKqA@mail.gmail.com>

On Tue, Jul 2, 2013 at 2:40 PM, Alexandre Villers
<villers.alexandre at gmail.com> wrote:
> Hi,
>
> There is an asp options in par. It works with plot and image
> plot(x,y, asp=1) or image(x, asp=1) should produce what you're looking for
>
> HTH
>
> Alex

Thank you for the suggestion, Alex, but "asp=1" does not solve the
problem. The final plot is still does not reach the quality of the
downloaded map tile :(

Ivailo
--
UBUNTU: a person is a person through other persons.


From vitale232 at gmail.com  Tue Jul  2 22:23:30 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 2 Jul 2013 13:23:30 -0700
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
 in loop
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/bd314d81/attachment.pl>

From zua3 at cornell.edu  Tue Jul  2 22:38:21 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Tue, 2 Jul 2013 20:38:21 +0000
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
 in loop
In-Reply-To: <CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/41764a62/attachment.pl>

From Han_Li at baylor.edu  Tue Jul  2 23:25:23 2013
From: Han_Li at baylor.edu (Li, Han)
Date: Tue, 2 Jul 2013 21:25:23 +0000
Subject: [R-sig-Geo] sample size for autoregressive models
Message-ID: <0F7B6F86D2AFD049B10949D376D8C64A152E0394@HARRY.baylor.edu>

Dear list,

I used SAR, CAR, and GAM models in my dissertation research (function spautolm() and gam()). My data sets were about urban wildlife presence/absence. I used eight continuous predicting variables and three categorical predicting variables.

One of my committee members asked me if the sample size was appropriate for these models. When I took statistic classes with this professor, he suggested that the rules of thumb for the minimum sample size of regression would be 100 + # of predictors. I also found many tables of sample size for regression in my textbooks. I was wondering if the "minimum sample size" rules for linear/logistic regression can be applied to autoregressive models.

Thanks in advance

Han



Han Li
Department of Biology
Baylor University
Waco, TX  76798-7388
Phone: (254) 710-2151
Fax: (254) 710-2969
han_li at baylor.edu<mailto:han_li at baylor.edu>


From vitale232 at gmail.com  Tue Jul  2 23:35:10 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 2 Jul 2013 14:35:10 -0700
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
 in loop
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/3658f59e/attachment.pl>

From r.hijmans at gmail.com  Tue Jul  2 23:51:54 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 2 Jul 2013 14:51:54 -0700
Subject: [R-sig-Geo] dismo:::gmap - how to obtain a 1:1 plot
In-Reply-To: <CAAVnHstOboNogET++gJ6i+LS2gN809ZcmkXWZKf3qTxaBzPKqA@mail.gmail.com>
References: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>
	<51D2BC1B.6030808@gmail.com>
	<CAAVnHstOboNogET++gJ6i+LS2gN809ZcmkXWZKf3qTxaBzPKqA@mail.gmail.com>
Message-ID: <CANtt_hwoCTAGK9MwErj=RFabQ02LU01hPNfZ-78sbsspM5UEag@mail.gmail.com>

Ivailo,

You make it very hard to help you because you do not provide a
reproducible example. I do not know what TIFF file you refer to
(probably a .gif file?). The get a better looking plot, you may want
to try something like:

libary(dismo)
g <- gmap('Reykyavik')
plot(g, interpolate=TRUE, maxpixels=10^8)

Robert

On Tue, Jul 2, 2013 at 12:28 PM, Ivailo <ubuntero.9161 at gmail.com> wrote:
> On Tue, Jul 2, 2013 at 2:40 PM, Alexandre Villers
> <villers.alexandre at gmail.com> wrote:
>> Hi,
>>
>> There is an asp options in par. It works with plot and image
>> plot(x,y, asp=1) or image(x, asp=1) should produce what you're looking for
>>
>> HTH
>>
>> Alex
>
> Thank you for the suggestion, Alex, but "asp=1" does not solve the
> problem. The final plot is still does not reach the quality of the
> downloaded map tile :(
>
> Ivailo
> --
> UBUNTU: a person is a person through other persons.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From zua3 at cornell.edu  Wed Jul  3 00:13:24 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Tue, 2 Jul 2013 22:13:24 +0000
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
 in loop
In-Reply-To: <CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>
	<38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA1E8@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/3b804a71/attachment.pl>

From bakare at ualberta.ca  Wed Jul  3 00:49:15 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 2 Jul 2013 16:49:15 -0600
Subject: [R-sig-Geo] Removal of trend in geospatial data
Message-ID: <CAJRR3XP14r=Q3a7-mf+0xMFOn-x1ejZXw2Q=HJvFSw6uCW-tgw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130702/d6371278/attachment.pl>

From ubuntero.9161 at gmail.com  Wed Jul  3 07:17:28 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Wed, 3 Jul 2013 08:17:28 +0300
Subject: [R-sig-Geo] dismo:::gmap - how to obtain a 1:1 plot
In-Reply-To: <CANtt_hwoCTAGK9MwErj=RFabQ02LU01hPNfZ-78sbsspM5UEag@mail.gmail.com>
References: <CAAVnHsuAvg4NVXd1-26pv0Cc2WmCX-igkULWqFUmwq3RAPXS4A@mail.gmail.com>
	<51D2BC1B.6030808@gmail.com>
	<CAAVnHstOboNogET++gJ6i+LS2gN809ZcmkXWZKf3qTxaBzPKqA@mail.gmail.com>
	<CANtt_hwoCTAGK9MwErj=RFabQ02LU01hPNfZ-78sbsspM5UEag@mail.gmail.com>
Message-ID: <CAAVnHsuQyJiX8FggC7a6HCRMws9JuSgmzUac6P4AxfR=ExE2VA@mail.gmail.com>

On Wed, Jul 3, 2013 at 12:51 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Ivailo,
>
> You make it very hard to help you because you do not provide a
> reproducible example. I do not know what TIFF file you refer to
> (probably a .gif file?). The get a better looking plot, you may want
> to try something like:
>
> libary(dismo)
> g <- gmap('Reykyavik')
> plot(g, interpolate=TRUE, maxpixels=10^8)
>
> Robert

Thank you for the response, Robert!

Of course I mean the temporary .gif file. Here is the one I got from
the Reykyavik example you suggested: http://i.imgur.com/M39o5Lg.gif

Plotting `g` without any arguments as in

png("reykyavik.png")
g <- gmap('Reykyavik')
plot(g)
dev.off()

results in the following: http://i.imgur.com/2l0bgb0.png

The code from your example produces http://i.imgur.com/3whIsfw.png
which is clearly looking better, but I was wondering if I can get a
plot identical to the very tile (http://i.imgur.com/M39o5Lg.gif) the
plots are based on.

Cheers,
Ivailo
--
UBUNTU: a person is a person through other persons.


From oscar.perpinan at gmail.com  Wed Jul  3 08:55:38 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 03 Jul 2013 08:55:38 +0200
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
	in loop
In-Reply-To: <CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>,
	<CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>,
	<38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>,
	<CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>
Message-ID: <87bo6kt9n9.fsf@gmail.com>

Hello,

Instead of using lapply, you can define layout=c(1, 1):

library(raster)

fn <- system.file("external/test.grd", package="raster")
r <- raster(fn)
r2 <- raster(fn)+runif(ncell(r))
r3 <- raster(fn)+runif(ncell(r))
r4 <- raster(fn)+runif(ncell(r))
s <- stack(r, r2,r3, r4)

spplot(s, layout=c(1, 1))


On the other hand, you may be interested in this stackoverflow Q&A about
animated plots:
http://stackoverflow.com/questions/1298100/creating-a-movie-from-a-series-of-plots-in-r

Last, there is a FAQ about the use of lattice/ggplot2 inside loops:
http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f

Best,

Oscar.

Andrew Vitale <vitale232 at gmail.com> writes:

> I was about to give up when I looked at your original email again.  Looks
> like you just need to wrap it with print():
>
> lapply(1:length(s), function(x){x11(); print(spplot(s[[x]], main =
> names(s[[x]])))})
>
> Does anyone on the list know why?
>
>
> On Tue, Jul 2, 2013 at 1:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>
>>  Hi Andrew,****
>>
>> It works fine with plot function. But like  to use ?spplot? function.
>> Because like to customize plot following ways to create animated gif plot.
>>     ****
>>
>> However, when  I use spplot function in your code,  I have got plots with
>> NULL values. Thanks Zia****
>>
>> ** **
>>
>> > lapply(1:nlayers(s), function(x){spplot(s[[x]], main =
>> names(s[[x]]));x11()})****
>>
>> [[1]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[2]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[3]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[4]]****
>>
>> NULL****
>>
>> ** **
>>
>> # ****
>>
>> bd<-readShapePoly("BD_boundary.shp")****
>>
>> thana <- list("sp.lines", as(bd, "SpatialLines"), col="grey", lwd=.7,lty=3)
>> ****
>>
>> at.NDVI <- seq(-3, +3, by = 0.5)****
>>
>> rgb.palette <- colorRampPalette(c("firebrick4","khaki1","green4"))****
>>
>> ** **
>>
>> # Plot****
>>
>> ** **
>>
>> spplot(s$May_2012, main = "",****
>>
>>    sp.layout=list(thana),at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey60",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:13,labels=list(cex=1.2,at=1:13,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60))****
>>
>> ** **
>>
>> # Animated GIF (This function did not work!)****
>>
>> saveGIF(****
>>
>> for (i in 1:ns){****
>>
>>    print(spplot(s[], main = list(label=paste("May_",i),cex=1.5),****
>>
>>    sp.layout=list(thana), at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey25",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:21,labels=list(cex=1.2,at=1:21,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60)))}, ****
>>
>> height = 500, width = 350, interval = .3, outdir = getwd())****
>>
>> }****
>>
>> ** **
>>
>> *From:* Andrew Vitale [mailto:vitale232 at gmail.com]
>> *Sent:* Tuesday, July 02, 2013 4:24 PM
>>
>> *To:* Zia Uddin Ahmed
>> *Cc:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Help: Individual plots all raster in a raster
>> stack in loop****
>>
>> ** **
>>
>> Zia,****
>>
>> ** **
>>
>> I like to use the plot function from the raster package.****
>>
>> ** **
>>
>> ?raster:::plot****
>>
>> ** **
>>
>> To continue your example, I'm able to plot the individual layers of a
>> stack using the lapply() function.  I'm not sure if there is a simpler way
>> to do it, but this way works for me:****
>>
>> ** **
>>
>> library(raster)****
>>
>> library(sp)****
>>
>> library(gstat)****
>>
>> ** **
>>
>> fn <- system.file("external/test.grd", package="raster")****
>>
>> r <- raster(fn)****
>>
>> r2 <- raster(fn)+runif(ncell(r))****
>>
>> r3 <- raster(fn)+runif(ncell(r))****
>>
>> r4 <- raster(fn)+runif(ncell(r))****
>>
>> s <- stack(r, r2,r3, r4)****
>>
>> ** **
>>
>> # Plot all rasters in a raster stack****
>>
>> ** **
>>
>> lapply(1:nlayers(s), function(x){plot(s[[x]], main = names(s[[x]]));x11()})
>> ****
>>
>> ** **
>>
>> ** **
>>
>> ####And if you want the layers all in one plot, just use****
>>
>> ** **
>>
>> plot(s)****
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> On Tue, Jul 2, 2013 at 10:47 AM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>> ****
>>
>> I like to plot (individual plot all raster objects in raster stack in a
>> loop. Help will be appreciated.
>> Thanks
>> Zia
>>
>> library(raster)
>> library(sp)
>> library(gstat)
>> fn <- system.file("external/test.grd", package="raster")
>> r <- raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> r3 <- raster(fn)+runif(ncell(r))
>> r4 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2,r3, r4)
>> names(s)
>> # [1] "test.1" "test.2" "test.3" "test.4"
>>
>> # Plot all rasters in a raster stack
>> print(spplot(s$test.1))
>> print(spplot(s$test.2))
>> print(spplot(s$test.3))
>> print(spplot(s$test.4))
>>
>> From: Andrew Vitale [mailto:vitale232 at gmail.com]
>> Sent: Monday, July 01, 2013 3:13 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik; r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from
>> raster stack
>>
>> Did the sample code I sent not run on your system?  That's strange.
>>
>>
>> On my machine:
>>
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster")
>> r <- raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>>
>> std<-calc(s, fun = sd)
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>>
>> par(mfrow=c(1,2));plot(sd,main = 'sd'); plot(std, main = 'std')
>>
>> identical(sd, std)
>> #[1] TRUE
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-15
>>
>> On Mon, Jul 1, 2013 at 10:14 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> Thanks you so much it works with following code. Zia
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>> plot(sd)
>>
>> From: Andrew Vitale [mailto:vitale232 at gmail.com<mailto:vitale232 at gmail.com
>> >]
>> Sent: Monday, July 01, 2013 12:45 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from
>> raster stack
>>
>> Check out ?calc
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster")
>> r <- raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>> std<-calc(s, fun = sd)
>>
>>
>> On Mon, Jul 1, 2013 at 9:30 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> In my case, object ?s? is a set of 22 geo-tif files.
>> Thanks
>> zia
>>
>> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:
>> romunov at gmail.com<mailto:romunov at gmail.com>] On Behalf Of Roman Lu?trik
>> Sent: Monday, July 01, 2013 12:09 PM
>> To: Zia Uddin Ahmed
>> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from
>> raster stack
>>
>> What's the class/structure of object `s`?
>>
>> Cheers,
>> Roman
>> On Mon, Jul 1, 2013 at 4:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu><mailto:zua3 at cornell.edu<mailto:zua3 at cornell.edu>>>
>> wrote:
>> I am trying to calculate standard deviation map from a raster stack. I
>> have got following error . Any  suggestion?
>> > std<-sd(s)
>> Error in as.double(x) :
>>   cannot coerce type 'S4' to vector of type 'double'
>>
>> Thanks
>> Zia
>>
>> fn <- system.file("external/test.grd", package="raster")
>> s <- stack(fn, fn)
>> r <- raster(fn)
>> s <- stack(r, fn)
>> nlayers(s)
>> m<-mean(s)
>> std<-sd(s)
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4
>> [5] xts_0.9-3        zoo_1.7-9
>> >
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org><mailto:r-sig-geo-bounces at r-project.org
>> <mailto:r-sig-geo-bounces at r-project.org>> [mailto:
>> r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org
>> ><mailto:r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org>>] On Behalf Of ASANTOS
>> Sent: Sunday, June 23, 2013 4:08 PM
>> To: Sarah Goslee; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org
>> ><mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>> Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset image
>>
>> Hi Dra. Goslee,
>>
>>              I work in OS linux and I like very much your lssub function,
>> despites your notice. I think that the problems are in linux system,
>> because:
>>
>>  > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>> Error in .local(.Object, ...) :
>>    `/home/asantos/Documentos/Sensoriamento remoto percevejo
>> bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file system,
>> and is not recognised as a supported dataset name.
>>
>> Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",
>>  :
>>    Cannot create a RasterLayer object from this file. (file does not exist)
>>
>>
>>               When I try to look the geotiff created
>> (stackIm1.sample.tif) there are something wrong, because the pictures
>> doesn't open (complete example below).
>>
>> Thanks for your attention,
>>
>> Alexandre
>>
>> require(raster)
>> require(sp)
>> require(rgdal)
>> require(landsat)
>> #
>> #Create raster
>> r <- raster(nc=1000, nr=1000)
>> set.seed(20130622)
>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>>
>> # define projection system
>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m +no_defs")
>>  # geographical datum WGS84
>> proj4string(stackIm1) <- r.geo
>> proj4string(stackIm2) <- r.geo
>> #
>>
>> #Create geotiff
>> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> #
>>
>> #Subset a geotiff image 50 x 50 pixels
>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx = 0,
>> centery = 0, widthx = 50, widthy = 50)
>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", centerx =
>> 0, centery = 0, widthx = 50, widthy = 50)
>> #
>> landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>
>>
>>
>>
>>
>> Em 23/06/2013 12:59, Sarah Goslee escreveu:
>> > Hi,
>> >
>> > What happens?
>> >
>> > Do you get an error? Where?
>> >
>> > What is your sessionInfo()?
>> >
>> > As it says in the lssub() help, this function was written for a
>> > particular purpose, is only known to work on linux, and may not be
>> > widely applicable.
>> >
>> > It's a "use at your own risk" kind of function, and you may well be
>> > better off using one of the many other methods available for
>> > subsetting raster data, which would save you the whole "export as
>> > GeoTIFF, subset, reimport" sequence.
>> >
>> > Sarah
>> >
>> > On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos
>> > <alexandresantosbr at yahoo.com.br<mailto:alexandresantosbr at yahoo.com.br
>> ><mailto:alexandresantosbr at yahoo.com.br<mailto:
>> alexandresantosbr at yahoo.com.br>>> wrote:
>> >> Dear Members,
>> >>
>> >>
>> >> I'm having trouble calculating NDVI difference, first the images
>> Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not get to
>> the NDVI, follow an example:
>> >>
>> >> require(raster)
>> >> require(sp)
>> >> require(rgdal)
>> >> require(landsat)
>> >> #
>> >> #Create raster
>> >> r <- raster(nc=1000, nr=1000)
>> >> set.seed(20130622)
>> >> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> >> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>> >>
>> >> # define projection system
>> >> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>> +no_defs")    # geographical datum WGS84
>> >> proj4string(stackIm1) <- r.geo
>> >> proj4string(stackIm2) <- r.geo
>> >> #
>> >>
>> >> #Create geotiff
>> >> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> >> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> >> #
>> >>
>> >> #Subset a geotiff image 50 x 50 pixels
>> >> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx =
>> 0, centery = 0, widthx = 50, widthy = 50)
>> >> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", centerx
>> = 0, centery = 0, widthx = 50, widthy = 50)
>> >> #
>> >>
>> >> #Calculate NDVI difference
>> >>
>> >> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>> >>
>> >> band3<-raster(multi.espc,1)
>> >> band4<-raster(multi.espc,2)
>> >>
>> >> ndvi<-(band4-band3)/(band4+band3)
>> >>
>> >> #
>> >>
>> >>
>> >>
>>
>> --
>> ======================================================================
>> Alexandre dos Santos
>> Prote??o Florestal
>> Coordenador do curso T?cnico em Florestas
>> Vice Coordenador do curso de Engenharia Florestal
>> IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
>> Campus C?ceres
>> Caixa Postal 244
>> Avenida dos Ramires, s/n
>> Bairro: Distrito Industrial
>> C?ceres - MT                      CEP: 78.200-000
>> Fone: (+55) 65 8132-8112<tel:%28%2B55%29%2065%208132-8112<%28%2B55%29%2065%208132-8112>>
>> (TIM)   (+55) 65 9686-6970<tel:%28%2B55%29%2065%209686-6970<%28%2B55%29%2065%209686-6970>>
>> (VIVO)
>>          alexandre.santos at cas.ifmt.edu.br<mailto:
>> alexandre.santos at cas.ifmt.edu.br><mailto:alexandre.santos at cas.ifmt.edu.br
>> <mailto:alexandre.santos at cas.ifmt.edu.br>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632<tel:%28412%29%20915-3632 <%28412%29%20915-3632>>
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo****
>>
>>
>>
>> ****
>>
>> ** **
>>
>> -- ****
>>
>> *Andrew P. Vitale*****
>>
>> Masters Student****
>>
>> Department of Geography****
>>
>> University of Nevada, Reno****
>>
>> (412) 915-3632****
>>
>> vitale232 at gmail.com****
>>


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan
LinkedIn: http://www.linkedin.com/in/oscarperpinan


From b.rowlingson at lancaster.ac.uk  Wed Jul  3 11:00:21 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 3 Jul 2013 10:00:21 +0100
Subject: [R-sig-Geo] Adding SQL "where" to readOGR
Message-ID: <CANVKczOJygHHsOxH4cJfj6dm1tHmyBEQRCdQ39Ov2Ej9oF-2cg@mail.gmail.com>

This pops up on stackoverflow and r-sig-geo occasionally - how can I
add SQL to my readOGR call?

There was a discussion here about 2.5 years ago, which ended in some
comment from Roger about some refactoring of rgdal before trying to
implement setAttributeFilter. Since then, nothing, and no sign of it
in the current codebase.

Is it as simple as it seems it could be?

1. Add an optional 'where' argument to readOGR.
2. Pass that string to C++ and call setAttributeFilter on the OGRLayer object.
3. Check for errors...
4. Get back a filtered data set.

 spdf = readOGR("PG:dbname=maps","countries",where="population > 1000")

I don't think it needs the full hammer of using OGR's ExecuteSQL
functionality whch looks a bit different. The attribute filter
mechanism is smart enough to pass the SQL to the database for database
drivers, or do the hard work itself for reading from Shapefiles. I
think the implementation of this in gdal is widespread enough now for
it to be accepted (1.8?).

Now, if only I wasn't teaching 100 ecologists next week I might attack
this. Actually I would probably be going to UseR!... But anyway....

Has anyone looked at this in more detail?

Barry


From Roger.Bivand at nhh.no  Wed Jul  3 11:46:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jul 2013 11:46:40 +0200
Subject: [R-sig-Geo] Adding SQL "where" to readOGR
In-Reply-To: <CANVKczOJygHHsOxH4cJfj6dm1tHmyBEQRCdQ39Ov2Ej9oF-2cg@mail.gmail.com>
References: <CANVKczOJygHHsOxH4cJfj6dm1tHmyBEQRCdQ39Ov2Ej9oF-2cg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307031141250.9375@reclus.nhh.no>

On Wed, 3 Jul 2013, Barry Rowlingson wrote:

> This pops up on stackoverflow and r-sig-geo occasionally - how can I
> add SQL to my readOGR call?
>
> There was a discussion here about 2.5 years ago, which ended in some
> comment from Roger about some refactoring of rgdal before trying to
> implement setAttributeFilter. Since then, nothing, and no sign of it
> in the current codebase.

Nobody volunteered ...

>
> Is it as simple as it seems it could be?
>
> 1. Add an optional 'where' argument to readOGR.
> 2. Pass that string to C++ and call setAttributeFilter on the OGRLayer object.
> 3. Check for errors...
> 4. Get back a filtered data set.
>
> spdf = readOGR("PG:dbname=maps","countries",where="population > 1000")
>
> I don't think it needs the full hammer of using OGR's ExecuteSQL
> functionality whch looks a bit different. The attribute filter
> mechanism is smart enough to pass the SQL to the database for database
> drivers, or do the hard work itself for reading from Shapefiles. I
> think the implementation of this in gdal is widespread enough now for
> it to be accepted (1.8?).
>

It does vary from version to version, and may imply geometric where=, 
which may also drag GEOS into its build train. If we stay with 
bounding-box/envelope geometric conditions and attribute conditions, it 
might be OK, but will meet design questions about how much of the where= 
to parse in R before despatch.

readOGR() does still need rewriting anyway, even though it is a lot faster 
now that lists of sp polygon class objects are created in C.

> Now, if only I wasn't teaching 100 ecologists next week I might attack
> this. Actually I would probably be going to UseR!... But anyway....
>
> Has anyone looked at this in more detail?

All welcome!

Roger

>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From michela.giusti at isprambiente.it  Wed Jul  3 12:22:05 2013
From: michela.giusti at isprambiente.it (Michela Giusti)
Date: Wed, 03 Jul 2013 12:22:05 +0200
Subject: [R-sig-Geo] MADIFA habitat suitability map problem
Message-ID: <51D3FB4D.4020703@isprambiente.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130703/fcb13e3d/attachment.pl>

From mauriziomarchi85 at gmail.com  Wed Jul  3 12:28:01 2013
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Wed, 3 Jul 2013 12:28:01 +0200
Subject: [R-sig-Geo] Export raster from R to Arcgis
Message-ID: <CANJhsN3Vsgdky8iXBDMNfD_zkFozKQGRC9erKoqb4-r37szN_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130703/ed8ba96b/attachment.pl>

From momadou at yahoo.fr  Wed Jul  3 12:43:18 2013
From: momadou at yahoo.fr (Komine)
Date: Wed, 3 Jul 2013 03:43:18 -0700 (PDT)
Subject: [R-sig-Geo] Export raster from R to Arcgis
In-Reply-To: <CANJhsN3Vsgdky8iXBDMNfD_zkFozKQGRC9erKoqb4-r37szN_w@mail.gmail.com>
References: <1372786522374-7583995.post@n2.nabble.com>
	<CANJhsN3Vsgdky8iXBDMNfD_zkFozKQGRC9erKoqb4-r37szN_w@mail.gmail.com>
Message-ID: <1372848198760-7584016.post@n2.nabble.com>

Thank Maurizio,
Idid it with writeRaster () function



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Export-raster-from-R-to-Arcgis-tp7583995p7584016.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Wed Jul  3 13:00:51 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 3 Jul 2013 12:00:51 +0100
Subject: [R-sig-Geo] Adding SQL "where" to readOGR
In-Reply-To: <b44795fb5bc54ad8b6ae4ad76aee55f9@EX-0-HT0.lancs.local>
References: <CANVKczOJygHHsOxH4cJfj6dm1tHmyBEQRCdQ39Ov2Ej9oF-2cg@mail.gmail.com>
	<b44795fb5bc54ad8b6ae4ad76aee55f9@EX-0-HT0.lancs.local>
Message-ID: <CANVKczOizX8TN2=RFu7MDtC_LJSU=JoPNbSAtBR2tK9RgW9nHg@mail.gmail.com>

On Wed, Jul 3, 2013 at 10:46 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> It does vary from version to version, and may imply geometric where=,
> which may also drag GEOS into its build train.

 is that the build train for libgdal rather than for rgdal? Can
libgdal exist without GEOS?

> how much of the where=
> to parse in R before despatch.

 How about none of it. What does ogr2ogr do? It seems to just pass the
string through. I don't see why R would have to do anything with it
except check for errors if gdal returns a CPL_YOUR_SQL_MAKES_NO_SENSE
or CPL_YOU_TRIED_TO_DO_SOMETHING_THAT_NEEDS_GEOS_BUT_YOU_AINT_GOT_IT
error.

 I reckon attribute filtering would cover most of the 'can I do sql in
readOGR' messages I've seen.

> All welcome!

 One day...

Barry


From Roger.Bivand at nhh.no  Wed Jul  3 13:29:29 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jul 2013 13:29:29 +0200
Subject: [R-sig-Geo] Adding SQL "where" to readOGR
In-Reply-To: <CANVKczOizX8TN2=RFu7MDtC_LJSU=JoPNbSAtBR2tK9RgW9nHg@mail.gmail.com>
References: <CANVKczOJygHHsOxH4cJfj6dm1tHmyBEQRCdQ39Ov2Ej9oF-2cg@mail.gmail.com>
	<b44795fb5bc54ad8b6ae4ad76aee55f9@EX-0-HT0.lancs.local>
	<CANVKczOizX8TN2=RFu7MDtC_LJSU=JoPNbSAtBR2tK9RgW9nHg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307031318070.14436@reclus.nhh.no>

On Wed, 3 Jul 2013, Barry Rowlingson wrote:

> On Wed, Jul 3, 2013 at 10:46 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> It does vary from version to version, and may imply geometric where=,
>> which may also drag GEOS into its build train.
>
> is that the build train for libgdal rather than for rgdal? Can
> libgdal exist without GEOS?

Yes, the build train for libgdal; and yes, libgdal can and does exist 
without GEOS.

>
>> how much of the where=
>> to parse in R before despatch.
>
> How about none of it. What does ogr2ogr do? It seems to just pass the
> string through. I don't see why R would have to do anything with it
> except check for errors if gdal returns a CPL_YOUR_SQL_MAKES_NO_SENSE
> or CPL_YOU_TRIED_TO_DO_SOMETHING_THAT_NEEDS_GEOS_BUT_YOU_AINT_GOT_IT
> error.
>

The error and warning messages from GDAL are often short and opaque, 
including empty layers. For medium-sized data sets, subsetting is 
certainly easier on the R side; for large ones, using ogr2ogr to select 
before import is a viable option.

They may very well also be interesting encoding challenges, because R and 
OGR may (and do) disagree on protocols for handling encoding, for example 
of placenames. A lot are in CP1252 or other variants, few are UTF-8, etc. 
So the search string going from R to OGR may need to know about the 
expected encoding on the "other" side to return hits. If the match should 
be of where=paste("bydel ==", shQuote("?sane")) or some such, the outcome 
will depend on the way encoding is handled.

I'm sure it will be fun!

Roger

> I reckon attribute filtering would cover most of the 'can I do sql in
> readOGR' messages I've seen.
>
>> All welcome!
>
> One day...
>
> Barry
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From s.meyer at lmu.de  Wed Jul  3 18:15:42 2013
From: s.meyer at lmu.de (Swen Meyer)
Date: Wed, 03 Jul 2013 18:15:42 +0200
Subject: [R-sig-Geo] Palmer Drought Severity Index PDSI
Message-ID: <51D44E2E.4000301@lmu.de>

Hi Everybody,
I was wondering if anyone knows if there is a R-package or r-Script that 
can be used to calculate the Palmer Drought Severity Index?
  Best regards,
Swen


From tea3rd at gmail.com  Wed Jul  3 18:46:47 2013
From: tea3rd at gmail.com (Thomas Adams)
Date: Wed, 3 Jul 2013 12:46:47 -0400
Subject: [R-sig-Geo] Palmer Drought Severity Index PDSI
In-Reply-To: <51D44E2E.4000301@lmu.de>
References: <51D44E2E.4000301@lmu.de>
Message-ID: <CAGxgkWiTLG3f3enr3v5vPRXfNFwLiBh0oc8TSG82b5+=Kjcvag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130703/b38c2c5c/attachment.pl>

From zua3 at cornell.edu  Wed Jul  3 19:18:09 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Wed, 3 Jul 2013 17:18:09 +0000
Subject: [R-sig-Geo] Help: Individual plots all raster in a raster stack
 in loop
In-Reply-To: <87bo6kt9n9.fsf@gmail.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA146@CH1PRD0410MB391.namprd04.prod.outlook.com>,
	<CAFTcope-KAb400bNhqiDAL4auGc6-aa_6hnewmwfFeNvcCUxag@mail.gmail.com>,
	<38AE5D3AB285FB4EB7F8683E9E383B960EAAA18C@CH1PRD0410MB391.namprd04.prod.outlook.com>,
	<CAFTcopchb3FtUNGJXQ_1ciWjx3bT=0Fo_=XReyP7WVGAqz9bPw@mail.gmail.com>
	<87bo6kt9n9.fsf@gmail.com>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA702@CH1PRD0410MB391.namprd04.prod.outlook.com>

Thank you so much.
 It works with following code:

saveGIF(
print(spplot(s, layout=c(1, 1))),
height = 500, width = 350, interval = .3, outdir = getwd())

-----Original Message-----
From: Oscar Perpi??n Lamigueiro [mailto:oscar.perpinan at gmail.com] 
Sent: Wednesday, July 03, 2013 2:56 AM
To: Andrew Vitale; Zia Uddin Ahmed
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster stack in loop

Hello,

Instead of using lapply, you can define layout=c(1, 1):

library(raster)

fn <- system.file("external/test.grd", package="raster") r <- raster(fn)
r2 <- raster(fn)+runif(ncell(r))
r3 <- raster(fn)+runif(ncell(r))
r4 <- raster(fn)+runif(ncell(r))
s <- stack(r, r2,r3, r4)

spplot(s, layout=c(1, 1))


On the other hand, you may be interested in this stackoverflow Q&A about animated plots:
http://stackoverflow.com/questions/1298100/creating-a-movie-from-a-series-of-plots-in-r

Last, there is a FAQ about the use of lattice/ggplot2 inside loops:
http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f

Best,

Oscar.

Andrew Vitale <vitale232 at gmail.com> writes:

> I was about to give up when I looked at your original email again.  
> Looks like you just need to wrap it with print():
>
> lapply(1:length(s), function(x){x11(); print(spplot(s[[x]], main =
> names(s[[x]])))})
>
> Does anyone on the list know why?
>
>
> On Tue, Jul 2, 2013 at 1:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>
>>  Hi Andrew,****
>>
>> It works fine with plot function. But like  to use ?spplot? function.
>> Because like to customize plot following ways to create animated gif plot.
>>     ****
>>
>> However, when  I use spplot function in your code,  I have got plots 
>> with NULL values. Thanks Zia****
>>
>> ** **
>>
>> > lapply(1:nlayers(s), function(x){spplot(s[[x]], main =
>> names(s[[x]]));x11()})****
>>
>> [[1]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[2]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[3]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[4]]****
>>
>> NULL****
>>
>> ** **
>>
>> # ****
>>
>> bd<-readShapePoly("BD_boundary.shp")****
>>
>> thana <- list("sp.lines", as(bd, "SpatialLines"), col="grey", 
>> lwd=.7,lty=3)
>> ****
>>
>> at.NDVI <- seq(-3, +3, by = 0.5)****
>>
>> rgb.palette <- 
>> colorRampPalette(c("firebrick4","khaki1","green4"))****
>>
>> ** **
>>
>> # Plot****
>>
>> ** **
>>
>> spplot(s$May_2012, main = "",****
>>
>>    sp.layout=list(thana),at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey60",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:13,labels=list(cex=1.2,at=
>> 1:13,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60))****
>>
>> ** **
>>
>> # Animated GIF (This function did not work!)****
>>
>> saveGIF(****
>>
>> for (i in 1:ns){****
>>
>>    print(spplot(s[], main = list(label=paste("May_",i),cex=1.5),****
>>
>>    sp.layout=list(thana), at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey25",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:21,labels=list(cex=1.2,at=
>> 1:21,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60)))}, ****
>>
>> height = 500, width = 350, interval = .3, outdir = getwd())****
>>
>> }****
>>
>> ** **
>>
>> *From:* Andrew Vitale [mailto:vitale232 at gmail.com]
>> *Sent:* Tuesday, July 02, 2013 4:24 PM
>>
>> *To:* Zia Uddin Ahmed
>> *Cc:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Help: Individual plots all raster in a 
>> raster stack in loop****
>>
>> ** **
>>
>> Zia,****
>>
>> ** **
>>
>> I like to use the plot function from the raster package.****
>>
>> ** **
>>
>> ?raster:::plot****
>>
>> ** **
>>
>> To continue your example, I'm able to plot the individual layers of a 
>> stack using the lapply() function.  I'm not sure if there is a 
>> simpler way to do it, but this way works for me:****
>>
>> ** **
>>
>> library(raster)****
>>
>> library(sp)****
>>
>> library(gstat)****
>>
>> ** **
>>
>> fn <- system.file("external/test.grd", package="raster")****
>>
>> r <- raster(fn)****
>>
>> r2 <- raster(fn)+runif(ncell(r))****
>>
>> r3 <- raster(fn)+runif(ncell(r))****
>>
>> r4 <- raster(fn)+runif(ncell(r))****
>>
>> s <- stack(r, r2,r3, r4)****
>>
>> ** **
>>
>> # Plot all rasters in a raster stack****
>>
>> ** **
>>
>> lapply(1:nlayers(s), function(x){plot(s[[x]], main = 
>> names(s[[x]]));x11()})
>> ****
>>
>> ** **
>>
>> ** **
>>
>> ####And if you want the layers all in one plot, just use****
>>
>> ** **
>>
>> plot(s)****
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> On Tue, Jul 2, 2013 at 10:47 AM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>> ****
>>
>> I like to plot (individual plot all raster objects in raster stack in 
>> a loop. Help will be appreciated.
>> Thanks
>> Zia
>>
>> library(raster)
>> library(sp)
>> library(gstat)
>> fn <- system.file("external/test.grd", package="raster") r <- 
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> r3 <- raster(fn)+runif(ncell(r))
>> r4 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2,r3, r4)
>> names(s)
>> # [1] "test.1" "test.2" "test.3" "test.4"
>>
>> # Plot all rasters in a raster stack
>> print(spplot(s$test.1))
>> print(spplot(s$test.2))
>> print(spplot(s$test.3))
>> print(spplot(s$test.4))
>>
>> From: Andrew Vitale [mailto:vitale232 at gmail.com]
>> Sent: Monday, July 01, 2013 3:13 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik; r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> Did the sample code I sent not run on your system?  That's strange.
>>
>>
>> On my machine:
>>
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster") r <- 
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>>
>> std<-calc(s, fun = sd)
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>>
>> par(mfrow=c(1,2));plot(sd,main = 'sd'); plot(std, main = 'std')
>>
>> identical(sd, std)
>> #[1] TRUE
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C [5] 
>> LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-15
>>
>> On Mon, Jul 1, 2013 at 10:14 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> Thanks you so much it works with following code. Zia
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>> plot(sd)
>>
>> From: Andrew Vitale 
>> [mailto:vitale232 at gmail.com<mailto:vitale232 at gmail.com
>> >]
>> Sent: Monday, July 01, 2013 12:45 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik; 
>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> Check out ?calc
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster") r <- 
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>> std<-calc(s, fun = sd)
>>
>>
>> On Mon, Jul 1, 2013 at 9:30 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> In my case, object ?s? is a set of 22 geo-tif files.
>> Thanks
>> zia
>>
>> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:
>> romunov at gmail.com<mailto:romunov at gmail.com>] On Behalf Of Roman 
>> Lu?trik
>> Sent: Monday, July 01, 2013 12:09 PM
>> To: Zia Uddin Ahmed
>> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> What's the class/structure of object `s`?
>>
>> Cheers,
>> Roman
>> On Mon, Jul 1, 2013 at 4:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu><mailto:zua3 at cornell.edu<mailto:zua3 at cornell.edu>>>
>> wrote:
>> I am trying to calculate standard deviation map from a raster stack. 
>> I have got following error . Any  suggestion?
>> > std<-sd(s)
>> Error in as.double(x) :
>>   cannot coerce type 'S4' to vector of type 'double'
>>
>> Thanks
>> Zia
>>
>> fn <- system.file("external/test.grd", package="raster") s <- 
>> stack(fn, fn) r <- raster(fn) s <- stack(r, fn)
>> nlayers(s)
>> m<-mean(s)
>> std<-sd(s)
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United 
>> States.1252 [3] LC_MONETARY=English_United States.1252 [4] 
>> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4
>> [5] xts_0.9-3        zoo_1.7-9
>> >
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org><mailto:r-sig-geo-bounces at r-project.o
>> rg <mailto:r-sig-geo-bounces at r-project.org>> [mailto:
>> r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.or
>> g
>> ><mailto:r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org>>] On Behalf Of ASANTOS
>> Sent: Sunday, June 23, 2013 4:08 PM
>> To: Sarah Goslee; 
>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org
>> ><mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>> Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset 
>> image
>>
>> Hi Dra. Goslee,
>>
>>              I work in OS linux and I like very much your lssub 
>> function, despites your notice. I think that the problems are in 
>> linux system,
>> because:
>>
>>  > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>> Error in .local(.Object, ...) :
>>    `/home/asantos/Documentos/Sensoriamento remoto percevejo 
>> bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file 
>> system, and is not recognised as a supported dataset name.
>>
>> Error in .rasterObjectFromFile(x, band = band, objecttype = 
>> "RasterLayer",
>>  :
>>    Cannot create a RasterLayer object from this file. (file does not 
>> exist)
>>
>>
>>               When I try to look the geotiff created
>> (stackIm1.sample.tif) there are something wrong, because the pictures 
>> doesn't open (complete example below).
>>
>> Thanks for your attention,
>>
>> Alexandre
>>
>> require(raster)
>> require(sp)
>> require(rgdal)
>> require(landsat)
>> #
>> #Create raster
>> r <- raster(nc=1000, nr=1000)
>> set.seed(20130622)
>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>>
>> # define projection system
>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m 
>> +no_defs")  # geographical datum WGS84
>> proj4string(stackIm1) <- r.geo
>> proj4string(stackIm2) <- r.geo
>> #
>>
>> #Create geotiff
>> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> #
>>
>> #Subset a geotiff image 50 x 50 pixels 
>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx 
>> = 0, centery = 0, widthx = 50, widthy = 50) 
>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>> centerx = 0, centery = 0, widthx = 50, widthy = 50) #
>> landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>
>>
>>
>>
>>
>> Em 23/06/2013 12:59, Sarah Goslee escreveu:
>> > Hi,
>> >
>> > What happens?
>> >
>> > Do you get an error? Where?
>> >
>> > What is your sessionInfo()?
>> >
>> > As it says in the lssub() help, this function was written for a 
>> > particular purpose, is only known to work on linux, and may not be 
>> > widely applicable.
>> >
>> > It's a "use at your own risk" kind of function, and you may well be 
>> > better off using one of the many other methods available for 
>> > subsetting raster data, which would save you the whole "export as 
>> > GeoTIFF, subset, reimport" sequence.
>> >
>> > Sarah
>> >
>> > On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos  
>> ><alexandresantosbr at yahoo.com.br<mailto:alexandresantosbr at yahoo.com.b
>> >r
>> ><mailto:alexandresantosbr at yahoo.com.br<mailto:
>> alexandresantosbr at yahoo.com.br>>> wrote:
>> >> Dear Members,
>> >>
>> >>
>> >> I'm having trouble calculating NDVI difference, first the images
>> Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not 
>> get to the NDVI, follow an example:
>> >>
>> >> require(raster)
>> >> require(sp)
>> >> require(rgdal)
>> >> require(landsat)
>> >> #
>> >> #Create raster
>> >> r <- raster(nc=1000, nr=1000)
>> >> set.seed(20130622)
>> >> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> >> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>> >>
>> >> # define projection system
>> >> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>> +no_defs")    # geographical datum WGS84
>> >> proj4string(stackIm1) <- r.geo
>> >> proj4string(stackIm2) <- r.geo
>> >> #
>> >>
>> >> #Create geotiff
>> >> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> >> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> >> #
>> >>
>> >> #Subset a geotiff image 50 x 50 pixels 
>> >> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", 
>> >> centerx =
>> 0, centery = 0, widthx = 50, widthy = 50)
>> >> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>> >> centerx
>> = 0, centery = 0, widthx = 50, widthy = 50)
>> >> #
>> >>
>> >> #Calculate NDVI difference
>> >>
>> >> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>> >>
>> >> band3<-raster(multi.espc,1)
>> >> band4<-raster(multi.espc,2)
>> >>
>> >> ndvi<-(band4-band3)/(band4+band3)
>> >>
>> >> #
>> >>
>> >>
>> >>
>>
>> --
>> =====================================================================
>> =
>> Alexandre dos Santos
>> Prote??o Florestal
>> Coordenador do curso T?cnico em Florestas Vice Coordenador do curso 
>> de Engenharia Florestal IFMT - Instituto Federal de Educa??o, Ci?ncia 
>> e Tecnologia de Mato Grosso Campus C?ceres Caixa Postal 244 Avenida 
>> dos Ramires, s/n
>> Bairro: Distrito Industrial
>> C?ceres - MT                      CEP: 78.200-000
>> Fone: (+55) 65 8132-8112<tel:%28%2B55%29%2065%208132-8112<%28%2B55%29%2065%208132-8112>>
>> (TIM)   (+55) 65 9686-6970<tel:%28%2B55%29%2065%209686-6970<%28%2B55%29%2065%209686-6970>>
>> (VIVO)
>>          alexandre.santos at cas.ifmt.edu.br<mailto:
>> alexandre.santos at cas.ifmt.edu.br><mailto:alexandre.santos at cas.ifmt.ed
>> u.br <mailto:alexandre.santos at cas.ifmt.edu.br>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632<tel:%28412%29%20915-3632 <%28412%29%20915-3632>> 
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo****
>>
>>
>>
>> ****
>>
>> ** **
>>
>> -- ****
>>
>> *Andrew P. Vitale*****
>>
>> Masters Student****
>>
>> Department of Geography****
>>
>> University of Nevada, Reno****
>>
>> (412) 915-3632****
>>
>> vitale232 at gmail.com****
>>


--
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM) Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan
LinkedIn: http://www.linkedin.com/in/oscarperpinan


From zua3 at cornell.edu  Wed Jul  3 20:19:27 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Wed, 3 Jul 2013 18:19:27 +0000
Subject: [R-sig-Geo] Quantiles (10th and 90th) of a Raster Stack?
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA727@CH1PRD0410MB391.namprd04.prod.outlook.com>

I am trying to calculate 10- and 90-th quantiles of a raster stack . When I use following I always get quartile values from 0 to 100% with 25% interval. I am interested only 10th and 90-th quantiles of   a set of raster. Any suggestion?  
Thanks
Zia

library(raster)
fn <- system.file("external/test.grd", package="raster") 
r <- raster(fn)
r2 <- raster(fn)+runif(ncell(r))
r3 <- raster(fn)+runif(ncell(r))
r4 <- raster(fn)+runif(ncell(r))
s <- stack(r, r2,r3, r4)

Q10 <- calc(s, fun = stats::quantile,probs = 0.10,na.rm=TRUE)
summary(Q10)
> summary(Q10)
               0%       25%       50%       75%      100%
Min.     128.4340  128.4760  128.5845  128.7812  129.0879
1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
Median   371.4120  371.6039  371.6643  371.6944  371.7912
3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000
plot(Q10)

Q90 <- calc(s, fun = stats::quantile,probs = 0.90,na.rm=TRUE)
summary (Q90)
> summary(Q90)
               0%       25%       50%       75%      100%
Min.     128.4340  128.4760  128.5845  128.7812  129.0879
1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
Median   371.4120  371.6039  371.6643  371.6944  371.7912
3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Zia Uddin Ahmed
Sent: Wednesday, July 03, 2013 1:18 PM
To: Oscar Perpi??n Lamigueiro; Andrew Vitale
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster stack in loop

Thank you so much.
 It works with following code:

saveGIF(
print(spplot(s, layout=c(1, 1))),
height = 500, width = 350, interval = .3, outdir = getwd())

-----Original Message-----
From: Oscar Perpi??n Lamigueiro [mailto:oscar.perpinan at gmail.com]
Sent: Wednesday, July 03, 2013 2:56 AM
To: Andrew Vitale; Zia Uddin Ahmed
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster stack in loop

Hello,

Instead of using lapply, you can define layout=c(1, 1):

library(raster)

fn <- system.file("external/test.grd", package="raster") r <- raster(fn)
r2 <- raster(fn)+runif(ncell(r))
r3 <- raster(fn)+runif(ncell(r))
r4 <- raster(fn)+runif(ncell(r))
s <- stack(r, r2,r3, r4)

spplot(s, layout=c(1, 1))


On the other hand, you may be interested in this stackoverflow Q&A about animated plots:
http://stackoverflow.com/questions/1298100/creating-a-movie-from-a-series-of-plots-in-r

Last, there is a FAQ about the use of lattice/ggplot2 inside loops:
http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f

Best,

Oscar.

Andrew Vitale <vitale232 at gmail.com> writes:

> I was about to give up when I looked at your original email again.  
> Looks like you just need to wrap it with print():
>
> lapply(1:length(s), function(x){x11(); print(spplot(s[[x]], main =
> names(s[[x]])))})
>
> Does anyone on the list know why?
>
>
> On Tue, Jul 2, 2013 at 1:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>
>>  Hi Andrew,****
>>
>> It works fine with plot function. But like  to use ?spplot? function.
>> Because like to customize plot following ways to create animated gif plot.
>>     ****
>>
>> However, when  I use spplot function in your code,  I have got plots 
>> with NULL values. Thanks Zia****
>>
>> ** **
>>
>> > lapply(1:nlayers(s), function(x){spplot(s[[x]], main =
>> names(s[[x]]));x11()})****
>>
>> [[1]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[2]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[3]]****
>>
>> NULL****
>>
>> ** **
>>
>> [[4]]****
>>
>> NULL****
>>
>> ** **
>>
>> # ****
>>
>> bd<-readShapePoly("BD_boundary.shp")****
>>
>> thana <- list("sp.lines", as(bd, "SpatialLines"), col="grey",
>> lwd=.7,lty=3)
>> ****
>>
>> at.NDVI <- seq(-3, +3, by = 0.5)****
>>
>> rgb.palette <-
>> colorRampPalette(c("firebrick4","khaki1","green4"))****
>>
>> ** **
>>
>> # Plot****
>>
>> ** **
>>
>> spplot(s$May_2012, main = "",****
>>
>>    sp.layout=list(thana),at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey60",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:13,labels=list(cex=1.2,at=
>> 1:13,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60))****
>>
>> ** **
>>
>> # Animated GIF (This function did not work!)****
>>
>> saveGIF(****
>>
>> for (i in 1:ns){****
>>
>>    print(spplot(s[], main = list(label=paste("May_",i),cex=1.5),****
>>
>>    sp.layout=list(thana), at=at.NDVI,****
>>
>>    par.settings=list(axis.line=list(col="grey25",lwd=0.5)),****
>>
>>
>> colorkey=list(space="right",width=1.8,at=1:21,labels=list(cex=1.2,at=
>> 1:21,
>> ****
>>
>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>> "3.0"))),****
>>
>>    col.regions=rgb.palette(60)))}, ****
>>
>> height = 500, width = 350, interval = .3, outdir = getwd())****
>>
>> }****
>>
>> ** **
>>
>> *From:* Andrew Vitale [mailto:vitale232 at gmail.com]
>> *Sent:* Tuesday, July 02, 2013 4:24 PM
>>
>> *To:* Zia Uddin Ahmed
>> *Cc:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Help: Individual plots all raster in a 
>> raster stack in loop****
>>
>> ** **
>>
>> Zia,****
>>
>> ** **
>>
>> I like to use the plot function from the raster package.****
>>
>> ** **
>>
>> ?raster:::plot****
>>
>> ** **
>>
>> To continue your example, I'm able to plot the individual layers of a 
>> stack using the lapply() function.  I'm not sure if there is a 
>> simpler way to do it, but this way works for me:****
>>
>> ** **
>>
>> library(raster)****
>>
>> library(sp)****
>>
>> library(gstat)****
>>
>> ** **
>>
>> fn <- system.file("external/test.grd", package="raster")****
>>
>> r <- raster(fn)****
>>
>> r2 <- raster(fn)+runif(ncell(r))****
>>
>> r3 <- raster(fn)+runif(ncell(r))****
>>
>> r4 <- raster(fn)+runif(ncell(r))****
>>
>> s <- stack(r, r2,r3, r4)****
>>
>> ** **
>>
>> # Plot all rasters in a raster stack****
>>
>> ** **
>>
>> lapply(1:nlayers(s), function(x){plot(s[[x]], main =
>> names(s[[x]]));x11()})
>> ****
>>
>> ** **
>>
>> ** **
>>
>> ####And if you want the layers all in one plot, just use****
>>
>> ** **
>>
>> plot(s)****
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> ** **
>>
>> On Tue, Jul 2, 2013 at 10:47 AM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>> ****
>>
>> I like to plot (individual plot all raster objects in raster stack in 
>> a loop. Help will be appreciated.
>> Thanks
>> Zia
>>
>> library(raster)
>> library(sp)
>> library(gstat)
>> fn <- system.file("external/test.grd", package="raster") r <-
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> r3 <- raster(fn)+runif(ncell(r))
>> r4 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2,r3, r4)
>> names(s)
>> # [1] "test.1" "test.2" "test.3" "test.4"
>>
>> # Plot all rasters in a raster stack
>> print(spplot(s$test.1))
>> print(spplot(s$test.2))
>> print(spplot(s$test.3))
>> print(spplot(s$test.4))
>>
>> From: Andrew Vitale [mailto:vitale232 at gmail.com]
>> Sent: Monday, July 01, 2013 3:13 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik; r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> Did the sample code I sent not run on your system?  That's strange.
>>
>>
>> On my machine:
>>
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster") r <-
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>>
>> std<-calc(s, fun = sd)
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>>
>> par(mfrow=c(1,2));plot(sd,main = 'sd'); plot(std, main = 'std')
>>
>> identical(sd, std)
>> #[1] TRUE
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C [5] 
>> LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-15
>>
>> On Mon, Jul 1, 2013 at 10:14 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> Thanks you so much it works with following code. Zia
>>
>> fun = function(x)
>> { sqrt(var(x))
>> }
>> sd <- calc(s, fun)
>> plot(sd)
>>
>> From: Andrew Vitale
>> [mailto:vitale232 at gmail.com<mailto:vitale232 at gmail.com
>> >]
>> Sent: Monday, July 01, 2013 12:45 PM
>> To: Zia Uddin Ahmed
>> Cc: Roman Lu?trik;
>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> Check out ?calc
>>
>> library(raster)
>> fn <- system.file("external/test.grd", package="raster") r <-
>> raster(fn)
>> r2 <- raster(fn)+runif(ncell(r))
>> s <- stack(r, r2)
>> nlayers(s)
>> m<-mean(s)
>> std<-calc(s, fun = sd)
>>
>>
>> On Mon, Jul 1, 2013 at 9:30 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu>> wrote:
>> In my case, object ?s? is a set of 22 geo-tif files.
>> Thanks
>> zia
>>
>> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:
>> romunov at gmail.com<mailto:romunov at gmail.com>] On Behalf Of Roman 
>> Lu?trik
>> Sent: Monday, July 01, 2013 12:09 PM
>> To: Zia Uddin Ahmed
>> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>> raster stack
>>
>> What's the class/structure of object `s`?
>>
>> Cheers,
>> Roman
>> On Mon, Jul 1, 2013 at 4:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>> zua3 at cornell.edu><mailto:zua3 at cornell.edu<mailto:zua3 at cornell.edu>>>
>> wrote:
>> I am trying to calculate standard deviation map from a raster stack. 
>> I have got following error . Any  suggestion?
>> > std<-sd(s)
>> Error in as.double(x) :
>>   cannot coerce type 'S4' to vector of type 'double'
>>
>> Thanks
>> Zia
>>
>> fn <- system.file("external/test.grd", package="raster") s <- 
>> stack(fn, fn) r <- raster(fn) s <- stack(r, fn)
>> nlayers(s)
>> m<-mean(s)
>> std<-sd(s)
>>
>> > sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United
>> States.1252 [3] LC_MONETARY=English_United States.1252 [4] 
>> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4
>> [5] xts_0.9-3        zoo_1.7-9
>> >
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org><mailto:r-sig-geo-bounces at r-project.o
>> rg <mailto:r-sig-geo-bounces at r-project.org>> [mailto:
>> r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.or
>> g
>> ><mailto:r-sig-geo-bounces at r-project.org<mailto:
>> r-sig-geo-bounces at r-project.org>>] On Behalf Of ASANTOS
>> Sent: Sunday, June 23, 2013 4:08 PM
>> To: Sarah Goslee;
>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org
>> ><mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>> Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset 
>> image
>>
>> Hi Dra. Goslee,
>>
>>              I work in OS linux and I like very much your lssub 
>> function, despites your notice. I think that the problems are in 
>> linux system,
>> because:
>>
>>  > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>> Error in .local(.Object, ...) :
>>    `/home/asantos/Documentos/Sensoriamento remoto percevejo 
>> bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file 
>> system, and is not recognised as a supported dataset name.
>>
>> Error in .rasterObjectFromFile(x, band = band, objecttype = 
>> "RasterLayer",
>>  :
>>    Cannot create a RasterLayer object from this file. (file does not
>> exist)
>>
>>
>>               When I try to look the geotiff created
>> (stackIm1.sample.tif) there are something wrong, because the pictures 
>> doesn't open (complete example below).
>>
>> Thanks for your attention,
>>
>> Alexandre
>>
>> require(raster)
>> require(sp)
>> require(rgdal)
>> require(landsat)
>> #
>> #Create raster
>> r <- raster(nc=1000, nr=1000)
>> set.seed(20130622)
>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>>
>> # define projection system
>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>> +no_defs")  # geographical datum WGS84
>> proj4string(stackIm1) <- r.geo
>> proj4string(stackIm2) <- r.geo
>> #
>>
>> #Create geotiff
>> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> #
>>
>> #Subset a geotiff image 50 x 50 pixels 
>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx 
>> = 0, centery = 0, widthx = 50, widthy = 50) 
>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>> centerx = 0, centery = 0, widthx = 50, widthy = 50) #
>> landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>
>>
>>
>>
>>
>> Em 23/06/2013 12:59, Sarah Goslee escreveu:
>> > Hi,
>> >
>> > What happens?
>> >
>> > Do you get an error? Where?
>> >
>> > What is your sessionInfo()?
>> >
>> > As it says in the lssub() help, this function was written for a 
>> > particular purpose, is only known to work on linux, and may not be 
>> > widely applicable.
>> >
>> > It's a "use at your own risk" kind of function, and you may well be 
>> > better off using one of the many other methods available for 
>> > subsetting raster data, which would save you the whole "export as 
>> > GeoTIFF, subset, reimport" sequence.
>> >
>> > Sarah
>> >
>> > On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos 
>> ><alexandresantosbr at yahoo.com.br<mailto:alexandresantosbr at yahoo.com.b
>> >r
>> ><mailto:alexandresantosbr at yahoo.com.br<mailto:
>> alexandresantosbr at yahoo.com.br>>> wrote:
>> >> Dear Members,
>> >>
>> >>
>> >> I'm having trouble calculating NDVI difference, first the images
>> Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not 
>> get to the NDVI, follow an example:
>> >>
>> >> require(raster)
>> >> require(sp)
>> >> require(rgdal)
>> >> require(landsat)
>> >> #
>> >> #Create raster
>> >> r <- raster(nc=1000, nr=1000)
>> >> set.seed(20130622)
>> >> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation red band
>> >> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>> round(runif(ncell(r))* 255))))## Simulation nir
>> >>
>> >> # define projection system
>> >> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>> +no_defs")    # geographical datum WGS84
>> >> proj4string(stackIm1) <- r.geo
>> >> proj4string(stackIm2) <- r.geo
>> >> #
>> >>
>> >> #Create geotiff
>> >> writeRaster(stackIm1, filename="stackIm1.tif",
>> format="GTiff",overwrite=TRUE)
>> >> writeRaster(stackIm2, filename="stackIm2.tif",
>> format="GTiff",overwrite=TRUE)
>> >> #
>> >>
>> >> #Subset a geotiff image 50 x 50 pixels 
>> >> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", 
>> >> centerx =
>> 0, centery = 0, widthx = 50, widthy = 50)
>> >> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>> >> centerx
>> = 0, centery = 0, widthx = 50, widthy = 50)
>> >> #
>> >>
>> >> #Calculate NDVI difference
>> >>
>> >> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>> >>
>> >> band3<-raster(multi.espc,1)
>> >> band4<-raster(multi.espc,2)
>> >>
>> >> ndvi<-(band4-band3)/(band4+band3)
>> >>
>> >> #
>> >>
>> >>
>> >>
>>
>> --
>> =====================================================================
>> =
>> Alexandre dos Santos
>> Prote??o Florestal
>> Coordenador do curso T?cnico em Florestas Vice Coordenador do curso 
>> de Engenharia Florestal IFMT - Instituto Federal de Educa??o, Ci?ncia 
>> e Tecnologia de Mato Grosso Campus C?ceres Caixa Postal 244 Avenida 
>> dos Ramires, s/n
>> Bairro: Distrito Industrial
>> C?ceres - MT                      CEP: 78.200-000
>> Fone: (+55) 65 8132-8112<tel:%28%2B55%29%2065%208132-8112<%28%2B55%29%2065%208132-8112>>
>> (TIM)   (+55) 65 9686-6970<tel:%28%2B55%29%2065%209686-6970<%28%2B55%29%2065%209686-6970>>
>> (VIVO)
>>          alexandre.santos at cas.ifmt.edu.br<mailto:
>> alexandre.santos at cas.ifmt.edu.br><mailto:alexandre.santos at cas.ifmt.ed
>> u.br <mailto:alexandre.santos at cas.ifmt.edu.br>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632<tel:%28412%29%20915-3632 <%28412%29%20915-3632>> 
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632
>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo****
>>
>>
>>
>> ****
>>
>> ** **
>>
>> -- ****
>>
>> *Andrew P. Vitale*****
>>
>> Masters Student****
>>
>> Department of Geography****
>>
>> University of Nevada, Reno****
>>
>> (412) 915-3632****
>>
>> vitale232 at gmail.com****
>>


--
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM) Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan
LinkedIn: http://www.linkedin.com/in/oscarperpinan

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From edzer.pebesma at uni-muenster.de  Wed Jul  3 20:31:00 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 03 Jul 2013 20:31:00 +0200
Subject: [R-sig-Geo] Quantiles (10th and 90th) of a Raster Stack?
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA727@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA727@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <51D46DE4.2090208@uni-muenster.de>

Zia,

The help of calc explains this:

    ...: Additional arguments as for ?writeRaster?

meaning the additional agument (probs) are not passed on to fun.

Defining the function more completely then passes probs to quantile:

Q10 <- calc(s, fun = function(x) {quantile(x,probs = c(.1,.9),na.rm=TRUE)} )

> summary(Q10)
              10%       90%
Min.     128.5144  128.8897
1st Qu.  293.2683  293.8457
Median   371.4973  372.1300
3rd Qu.  499.9098  500.5061
Max.    1805.7937 1806.1727
NA's    6097.0000 6097.0000



On 07/03/2013 08:19 PM, Zia Uddin Ahmed wrote:
> I am trying to calculate 10- and 90-th quantiles of a raster stack . When I use following I always get quartile values from 0 to 100% with 25% interval. I am interested only 10th and 90-th quantiles of   a set of raster. Any suggestion?  
> Thanks
> Zia
> 
> library(raster)
> fn <- system.file("external/test.grd", package="raster") 
> r <- raster(fn)
> r2 <- raster(fn)+runif(ncell(r))
> r3 <- raster(fn)+runif(ncell(r))
> r4 <- raster(fn)+runif(ncell(r))
> s <- stack(r, r2,r3, r4)
> 
> Q10 <- calc(s, fun = stats::quantile,probs = 0.10,na.rm=TRUE)
> summary(Q10)
>> summary(Q10)
>                0%       25%       50%       75%      100%
> Min.     128.4340  128.4760  128.5845  128.7812  129.0879
> 1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
> Median   371.4120  371.6039  371.6643  371.6944  371.7912
> 3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
> Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
> NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000
> plot(Q10)
> 
> Q90 <- calc(s, fun = stats::quantile,probs = 0.90,na.rm=TRUE)
> summary (Q90)
>> summary(Q90)
>                0%       25%       50%       75%      100%
> Min.     128.4340  128.4760  128.5845  128.7812  129.0879
> 1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
> Median   371.4120  371.6039  371.6643  371.6944  371.7912
> 3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
> Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
> NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Zia Uddin Ahmed
> Sent: Wednesday, July 03, 2013 1:18 PM
> To: Oscar Perpi??n Lamigueiro; Andrew Vitale
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster stack in loop
> 
> Thank you so much.
>  It works with following code:
> 
> saveGIF(
> print(spplot(s, layout=c(1, 1))),
> height = 500, width = 350, interval = .3, outdir = getwd())
> 
> -----Original Message-----
> From: Oscar Perpi??n Lamigueiro [mailto:oscar.perpinan at gmail.com]
> Sent: Wednesday, July 03, 2013 2:56 AM
> To: Andrew Vitale; Zia Uddin Ahmed
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster stack in loop
> 
> Hello,
> 
> Instead of using lapply, you can define layout=c(1, 1):
> 
> library(raster)
> 
> fn <- system.file("external/test.grd", package="raster") r <- raster(fn)
> r2 <- raster(fn)+runif(ncell(r))
> r3 <- raster(fn)+runif(ncell(r))
> r4 <- raster(fn)+runif(ncell(r))
> s <- stack(r, r2,r3, r4)
> 
> spplot(s, layout=c(1, 1))
> 
> 
> On the other hand, you may be interested in this stackoverflow Q&A about animated plots:
> http://stackoverflow.com/questions/1298100/creating-a-movie-from-a-series-of-plots-in-r
> 
> Last, there is a FAQ about the use of lattice/ggplot2 inside loops:
> http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f
> 
> Best,
> 
> Oscar.
> 
> Andrew Vitale <vitale232 at gmail.com> writes:
> 
>> I was about to give up when I looked at your original email again.  
>> Looks like you just need to wrap it with print():
>>
>> lapply(1:length(s), function(x){x11(); print(spplot(s[[x]], main =
>> names(s[[x]])))})
>>
>> Does anyone on the list know why?
>>
>>
>> On Tue, Jul 2, 2013 at 1:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>>
>>>  Hi Andrew,****
>>>
>>> It works fine with plot function. But like  to use ?spplot? function.
>>> Because like to customize plot following ways to create animated gif plot.
>>>     ****
>>>
>>> However, when  I use spplot function in your code,  I have got plots 
>>> with NULL values. Thanks Zia****
>>>
>>> ** **
>>>
>>>> lapply(1:nlayers(s), function(x){spplot(s[[x]], main =
>>> names(s[[x]]));x11()})****
>>>
>>> [[1]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[2]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[3]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[4]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> # ****
>>>
>>> bd<-readShapePoly("BD_boundary.shp")****
>>>
>>> thana <- list("sp.lines", as(bd, "SpatialLines"), col="grey",
>>> lwd=.7,lty=3)
>>> ****
>>>
>>> at.NDVI <- seq(-3, +3, by = 0.5)****
>>>
>>> rgb.palette <-
>>> colorRampPalette(c("firebrick4","khaki1","green4"))****
>>>
>>> ** **
>>>
>>> # Plot****
>>>
>>> ** **
>>>
>>> spplot(s$May_2012, main = "",****
>>>
>>>    sp.layout=list(thana),at=at.NDVI,****
>>>
>>>    par.settings=list(axis.line=list(col="grey60",lwd=0.5)),****
>>>
>>>
>>> colorkey=list(space="right",width=1.8,at=1:13,labels=list(cex=1.2,at=
>>> 1:13,
>>> ****
>>>
>>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>>> "3.0"))),****
>>>
>>>    col.regions=rgb.palette(60))****
>>>
>>> ** **
>>>
>>> # Animated GIF (This function did not work!)****
>>>
>>> saveGIF(****
>>>
>>> for (i in 1:ns){****
>>>
>>>    print(spplot(s[], main = list(label=paste("May_",i),cex=1.5),****
>>>
>>>    sp.layout=list(thana), at=at.NDVI,****
>>>
>>>    par.settings=list(axis.line=list(col="grey25",lwd=0.5)),****
>>>
>>>
>>> colorkey=list(space="right",width=1.8,at=1:21,labels=list(cex=1.2,at=
>>> 1:21,
>>> ****
>>>
>>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>>> "3.0"))),****
>>>
>>>    col.regions=rgb.palette(60)))}, ****
>>>
>>> height = 500, width = 350, interval = .3, outdir = getwd())****
>>>
>>> }****
>>>
>>> ** **
>>>
>>> *From:* Andrew Vitale [mailto:vitale232 at gmail.com]
>>> *Sent:* Tuesday, July 02, 2013 4:24 PM
>>>
>>> *To:* Zia Uddin Ahmed
>>> *Cc:* r-sig-geo at r-project.org
>>> *Subject:* Re: [R-sig-Geo] Help: Individual plots all raster in a 
>>> raster stack in loop****
>>>
>>> ** **
>>>
>>> Zia,****
>>>
>>> ** **
>>>
>>> I like to use the plot function from the raster package.****
>>>
>>> ** **
>>>
>>> ?raster:::plot****
>>>
>>> ** **
>>>
>>> To continue your example, I'm able to plot the individual layers of a 
>>> stack using the lapply() function.  I'm not sure if there is a 
>>> simpler way to do it, but this way works for me:****
>>>
>>> ** **
>>>
>>> library(raster)****
>>>
>>> library(sp)****
>>>
>>> library(gstat)****
>>>
>>> ** **
>>>
>>> fn <- system.file("external/test.grd", package="raster")****
>>>
>>> r <- raster(fn)****
>>>
>>> r2 <- raster(fn)+runif(ncell(r))****
>>>
>>> r3 <- raster(fn)+runif(ncell(r))****
>>>
>>> r4 <- raster(fn)+runif(ncell(r))****
>>>
>>> s <- stack(r, r2,r3, r4)****
>>>
>>> ** **
>>>
>>> # Plot all rasters in a raster stack****
>>>
>>> ** **
>>>
>>> lapply(1:nlayers(s), function(x){plot(s[[x]], main =
>>> names(s[[x]]));x11()})
>>> ****
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ####And if you want the layers all in one plot, just use****
>>>
>>> ** **
>>>
>>> plot(s)****
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> On Tue, Jul 2, 2013 at 10:47 AM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>>> ****
>>>
>>> I like to plot (individual plot all raster objects in raster stack in 
>>> a loop. Help will be appreciated.
>>> Thanks
>>> Zia
>>>
>>> library(raster)
>>> library(sp)
>>> library(gstat)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> r3 <- raster(fn)+runif(ncell(r))
>>> r4 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2,r3, r4)
>>> names(s)
>>> # [1] "test.1" "test.2" "test.3" "test.4"
>>>
>>> # Plot all rasters in a raster stack
>>> print(spplot(s$test.1))
>>> print(spplot(s$test.2))
>>> print(spplot(s$test.3))
>>> print(spplot(s$test.4))
>>>
>>> From: Andrew Vitale [mailto:vitale232 at gmail.com]
>>> Sent: Monday, July 01, 2013 3:13 PM
>>> To: Zia Uddin Ahmed
>>> Cc: Roman Lu?trik; r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>>> raster stack
>>>
>>> Did the sample code I sent not run on your system?  That's strange.
>>>
>>>
>>> On my machine:
>>>
>>>
>>> library(raster)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2)
>>> nlayers(s)
>>> m<-mean(s)
>>>
>>> std<-calc(s, fun = sd)
>>>
>>> fun = function(x)
>>> { sqrt(var(x))
>>> }
>>> sd <- calc(s, fun)
>>>
>>> par(mfrow=c(1,2));plot(sd,main = 'sd'); plot(std, main = 'std')
>>>
>>> identical(sd, std)
>>> #[1] TRUE
>>>
>>>> sessionInfo()
>>> R version 3.0.1 (2013-05-16)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C [5] 
>>> LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] raster_2.1-37 sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.1      lattice_0.20-15
>>>
>>> On Mon, Jul 1, 2013 at 10:14 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu>> wrote:
>>> Thanks you so much it works with following code. Zia
>>>
>>> fun = function(x)
>>> { sqrt(var(x))
>>> }
>>> sd <- calc(s, fun)
>>> plot(sd)
>>>
>>> From: Andrew Vitale
>>> [mailto:vitale232 at gmail.com<mailto:vitale232 at gmail.com
>>>> ]
>>> Sent: Monday, July 01, 2013 12:45 PM
>>> To: Zia Uddin Ahmed
>>> Cc: Roman Lu?trik;
>>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>>
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>>> raster stack
>>>
>>> Check out ?calc
>>>
>>> library(raster)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2)
>>> nlayers(s)
>>> m<-mean(s)
>>> std<-calc(s, fun = sd)
>>>
>>>
>>> On Mon, Jul 1, 2013 at 9:30 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu>> wrote:
>>> In my case, object ?s? is a set of 22 geo-tif files.
>>> Thanks
>>> zia
>>>
>>> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:
>>> romunov at gmail.com<mailto:romunov at gmail.com>] On Behalf Of Roman 
>>> Lu?trik
>>> Sent: Monday, July 01, 2013 12:09 PM
>>> To: Zia Uddin Ahmed
>>> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map from 
>>> raster stack
>>>
>>> What's the class/structure of object `s`?
>>>
>>> Cheers,
>>> Roman
>>> On Mon, Jul 1, 2013 at 4:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu><mailto:zua3 at cornell.edu<mailto:zua3 at cornell.edu>>>
>>> wrote:
>>> I am trying to calculate standard deviation map from a raster stack. 
>>> I have got following error . Any  suggestion?
>>>> std<-sd(s)
>>> Error in as.double(x) :
>>>   cannot coerce type 'S4' to vector of type 'double'
>>>
>>> Thanks
>>> Zia
>>>
>>> fn <- system.file("external/test.grd", package="raster") s <- 
>>> stack(fn, fn) r <- raster(fn) s <- stack(r, fn)
>>> nlayers(s)
>>> m<-mean(s)
>>> std<-sd(s)
>>>
>>>> sessionInfo()
>>> R version 3.0.1 (2013-05-16)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United
>>> States.1252 [3] LC_MONETARY=English_United States.1252 [4] 
>>> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4
>>> [5] xts_0.9-3        zoo_1.7-9
>>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org<mailto:
>>> r-sig-geo-bounces at r-project.org><mailto:r-sig-geo-bounces at r-project.o
>>> rg <mailto:r-sig-geo-bounces at r-project.org>> [mailto:
>>> r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.or
>>> g
>>>> <mailto:r-sig-geo-bounces at r-project.org<mailto:
>>> r-sig-geo-bounces at r-project.org>>] On Behalf Of ASANTOS
>>> Sent: Sunday, June 23, 2013 4:08 PM
>>> To: Sarah Goslee;
>>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org
>>>> <mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>> Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset 
>>> image
>>>
>>> Hi Dra. Goslee,
>>>
>>>              I work in OS linux and I like very much your lssub 
>>> function, despites your notice. I think that the problems are in 
>>> linux system,
>>> because:
>>>
>>>  > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>> Error in .local(.Object, ...) :
>>>    `/home/asantos/Documentos/Sensoriamento remoto percevejo 
>>> bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file 
>>> system, and is not recognised as a supported dataset name.
>>>
>>> Error in .rasterObjectFromFile(x, band = band, objecttype = 
>>> "RasterLayer",
>>>  :
>>>    Cannot create a RasterLayer object from this file. (file does not
>>> exist)
>>>
>>>
>>>               When I try to look the geotiff created
>>> (stackIm1.sample.tif) there are something wrong, because the pictures 
>>> doesn't open (complete example below).
>>>
>>> Thanks for your attention,
>>>
>>> Alexandre
>>>
>>> require(raster)
>>> require(sp)
>>> require(rgdal)
>>> require(landsat)
>>> #
>>> #Create raster
>>> r <- raster(nc=1000, nr=1000)
>>> set.seed(20130622)
>>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation red band
>>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation nir
>>>
>>> # define projection system
>>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>>> +no_defs")  # geographical datum WGS84
>>> proj4string(stackIm1) <- r.geo
>>> proj4string(stackIm2) <- r.geo
>>> #
>>>
>>> #Create geotiff
>>> writeRaster(stackIm1, filename="stackIm1.tif",
>>> format="GTiff",overwrite=TRUE)
>>> writeRaster(stackIm2, filename="stackIm2.tif",
>>> format="GTiff",overwrite=TRUE)
>>> #
>>>
>>> #Subset a geotiff image 50 x 50 pixels 
>>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", centerx 
>>> = 0, centery = 0, widthx = 50, widthy = 50) 
>>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>>> centerx = 0, centery = 0, widthx = 50, widthy = 50) #
>>> landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>>
>>>
>>>
>>>
>>>
>>> Em 23/06/2013 12:59, Sarah Goslee escreveu:
>>>> Hi,
>>>>
>>>> What happens?
>>>>
>>>> Do you get an error? Where?
>>>>
>>>> What is your sessionInfo()?
>>>>
>>>> As it says in the lssub() help, this function was written for a 
>>>> particular purpose, is only known to work on linux, and may not be 
>>>> widely applicable.
>>>>
>>>> It's a "use at your own risk" kind of function, and you may well be 
>>>> better off using one of the many other methods available for 
>>>> subsetting raster data, which would save you the whole "export as 
>>>> GeoTIFF, subset, reimport" sequence.
>>>>
>>>> Sarah
>>>>
>>>> On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos 
>>>> <alexandresantosbr at yahoo.com.br<mailto:alexandresantosbr at yahoo.com.b
>>>> r
>>>> <mailto:alexandresantosbr at yahoo.com.br<mailto:
>>> alexandresantosbr at yahoo.com.br>>> wrote:
>>>>> Dear Members,
>>>>>
>>>>>
>>>>> I'm having trouble calculating NDVI difference, first the images
>>> Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not 
>>> get to the NDVI, follow an example:
>>>>>
>>>>> require(raster)
>>>>> require(sp)
>>>>> require(rgdal)
>>>>> require(landsat)
>>>>> #
>>>>> #Create raster
>>>>> r <- raster(nc=1000, nr=1000)
>>>>> set.seed(20130622)
>>>>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation red band
>>>>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation nir
>>>>>
>>>>> # define projection system
>>>>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>>> +no_defs")    # geographical datum WGS84
>>>>> proj4string(stackIm1) <- r.geo
>>>>> proj4string(stackIm2) <- r.geo
>>>>> #
>>>>>
>>>>> #Create geotiff
>>>>> writeRaster(stackIm1, filename="stackIm1.tif",
>>> format="GTiff",overwrite=TRUE)
>>>>> writeRaster(stackIm2, filename="stackIm2.tif",
>>> format="GTiff",overwrite=TRUE)
>>>>> #
>>>>>
>>>>> #Subset a geotiff image 50 x 50 pixels 
>>>>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", 
>>>>> centerx =
>>> 0, centery = 0, widthx = 50, widthy = 50)
>>>>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>>>>> centerx
>>> = 0, centery = 0, widthx = 50, widthy = 50)
>>>>> #
>>>>>
>>>>> #Calculate NDVI difference
>>>>>
>>>>> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>>>>>
>>>>> band3<-raster(multi.espc,1)
>>>>> band4<-raster(multi.espc,2)
>>>>>
>>>>> ndvi<-(band4-band3)/(band4+band3)
>>>>>
>>>>> #
>>>>>
>>>>>
>>>>>
>>>
>>> --
>>> =====================================================================
>>> =
>>> Alexandre dos Santos
>>> Prote??o Florestal
>>> Coordenador do curso T?cnico em Florestas Vice Coordenador do curso 
>>> de Engenharia Florestal IFMT - Instituto Federal de Educa??o, Ci?ncia 
>>> e Tecnologia de Mato Grosso Campus C?ceres Caixa Postal 244 Avenida 
>>> dos Ramires, s/n
>>> Bairro: Distrito Industrial
>>> C?ceres - MT                      CEP: 78.200-000
>>> Fone: (+55) 65 8132-8112<tel:%28%2B55%29%2065%208132-8112<%28%2B55%29%2065%208132-8112>>
>>> (TIM)   (+55) 65 9686-6970<tel:%28%2B55%29%2065%209686-6970<%28%2B55%29%2065%209686-6970>>
>>> (VIVO)
>>>          alexandre.santos at cas.ifmt.edu.br<mailto:
>>> alexandre.santos at cas.ifmt.edu.br><mailto:alexandre.santos at cas.ifmt.ed
>>> u.br <mailto:alexandre.santos at cas.ifmt.edu.br>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> In God we trust, all others bring data.
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Andrew P. Vitale
>>> Masters Student
>>> Department of Geography
>>> University of Nevada, Reno
>>> (412) 915-3632<tel:%28412%29%20915-3632 <%28412%29%20915-3632>> 
>>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>>
>>>
>>>
>>> --
>>> Andrew P. Vitale
>>> Masters Student
>>> Department of Geography
>>> University of Nevada, Reno
>>> (412) 915-3632
>>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo****
>>>
>>>
>>>
>>> ****
>>>
>>> ** **
>>>
>>> -- ****
>>>
>>> *Andrew P. Vitale*****
>>>
>>> Masters Student****
>>>
>>> Department of Geography****
>>>
>>> University of Nevada, Reno****
>>>
>>> (412) 915-3632****
>>>
>>> vitale232 at gmail.com****
>>>
> 
> 
> --
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM) Dpto. Ingenier?a El?ctrica (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan
> LinkedIn: http://www.linkedin.com/in/oscarperpinan
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From zua3 at cornell.edu  Wed Jul  3 20:59:41 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Wed, 3 Jul 2013 18:59:41 +0000
Subject: [R-sig-Geo] Quantiles (10th and 90th) of a Raster Stack?
In-Reply-To: <51D46DE4.2090208@uni-muenster.de>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA727@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<51D46DE4.2090208@uni-muenster.de>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAA746@CH1PRD0410MB391.namprd04.prod.outlook.com>

Thank you so much, I will try this. 
Zia

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
Sent: Wednesday, July 03, 2013 2:31 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Quantiles (10th and 90th) of a Raster Stack?

Zia,

The help of calc explains this:

    ...: Additional arguments as for ?writeRaster?

meaning the additional agument (probs) are not passed on to fun.

Defining the function more completely then passes probs to quantile:

Q10 <- calc(s, fun = function(x) {quantile(x,probs = c(.1,.9),na.rm=TRUE)} )

> summary(Q10)
              10%       90%
Min.     128.5144  128.8897
1st Qu.  293.2683  293.8457
Median   371.4973  372.1300
3rd Qu.  499.9098  500.5061
Max.    1805.7937 1806.1727
NA's    6097.0000 6097.0000



On 07/03/2013 08:19 PM, Zia Uddin Ahmed wrote:
> I am trying to calculate 10- and 90-th quantiles of a raster stack . When I use following I always get quartile values from 0 to 100% with 25% interval. I am interested only 10th and 90-th quantiles of   a set of raster. Any suggestion?  
> Thanks
> Zia
> 
> library(raster)
> fn <- system.file("external/test.grd", package="raster") r <- 
> raster(fn)
> r2 <- raster(fn)+runif(ncell(r))
> r3 <- raster(fn)+runif(ncell(r))
> r4 <- raster(fn)+runif(ncell(r))
> s <- stack(r, r2,r3, r4)
> 
> Q10 <- calc(s, fun = stats::quantile,probs = 0.10,na.rm=TRUE)
> summary(Q10)
>> summary(Q10)
>                0%       25%       50%       75%      100%
> Min.     128.4340  128.4760  128.5845  128.7812  129.0879
> 1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
> Median   371.4120  371.6039  371.6643  371.6944  371.7912
> 3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
> Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
> NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000
> plot(Q10)
> 
> Q90 <- calc(s, fun = stats::quantile,probs = 0.90,na.rm=TRUE) summary 
> (Q90)
>> summary(Q90)
>                0%       25%       50%       75%      100%
> Min.     128.4340  128.4760  128.5845  128.7812  129.0879
> 1st Qu.  293.2325  293.4515  293.6626  293.9346  294.1769
> Median   371.4120  371.6039  371.6643  371.6944  371.7912
> 3rd Qu.  499.8195  500.0833  500.3306  500.4950  500.5551
> Max.    1805.7800 1805.8013 1805.8857 1806.0099 1806.1505
> NA's    6097.0000 6097.0000 6097.0000 6097.0000 6097.0000
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org 
> [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Zia Uddin Ahmed
> Sent: Wednesday, July 03, 2013 1:18 PM
> To: Oscar Perpi??n Lamigueiro; Andrew Vitale
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster 
> stack in loop
> 
> Thank you so much.
>  It works with following code:
> 
> saveGIF(
> print(spplot(s, layout=c(1, 1))),
> height = 500, width = 350, interval = .3, outdir = getwd())
> 
> -----Original Message-----
> From: Oscar Perpi??n Lamigueiro [mailto:oscar.perpinan at gmail.com]
> Sent: Wednesday, July 03, 2013 2:56 AM
> To: Andrew Vitale; Zia Uddin Ahmed
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Help: Individual plots all raster in a raster 
> stack in loop
> 
> Hello,
> 
> Instead of using lapply, you can define layout=c(1, 1):
> 
> library(raster)
> 
> fn <- system.file("external/test.grd", package="raster") r <- 
> raster(fn)
> r2 <- raster(fn)+runif(ncell(r))
> r3 <- raster(fn)+runif(ncell(r))
> r4 <- raster(fn)+runif(ncell(r))
> s <- stack(r, r2,r3, r4)
> 
> spplot(s, layout=c(1, 1))
> 
> 
> On the other hand, you may be interested in this stackoverflow Q&A about animated plots:
> http://stackoverflow.com/questions/1298100/creating-a-movie-from-a-ser
> ies-of-plots-in-r
> 
> Last, there is a FAQ about the use of lattice/ggplot2 inside loops:
> http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrelli
> s-graphics-not-work_003f
> 
> Best,
> 
> Oscar.
> 
> Andrew Vitale <vitale232 at gmail.com> writes:
> 
>> I was about to give up when I looked at your original email again.  
>> Looks like you just need to wrap it with print():
>>
>> lapply(1:length(s), function(x){x11(); print(spplot(s[[x]], main =
>> names(s[[x]])))})
>>
>> Does anyone on the list know why?
>>
>>
>> On Tue, Jul 2, 2013 at 1:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>>
>>>  Hi Andrew,****
>>>
>>> It works fine with plot function. But like  to use ?spplot? function.
>>> Because like to customize plot following ways to create animated gif plot.
>>>     ****
>>>
>>> However, when  I use spplot function in your code,  I have got plots 
>>> with NULL values. Thanks Zia****
>>>
>>> ** **
>>>
>>>> lapply(1:nlayers(s), function(x){spplot(s[[x]], main =
>>> names(s[[x]]));x11()})****
>>>
>>> [[1]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[2]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[3]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> [[4]]****
>>>
>>> NULL****
>>>
>>> ** **
>>>
>>> # ****
>>>
>>> bd<-readShapePoly("BD_boundary.shp")****
>>>
>>> thana <- list("sp.lines", as(bd, "SpatialLines"), col="grey",
>>> lwd=.7,lty=3)
>>> ****
>>>
>>> at.NDVI <- seq(-3, +3, by = 0.5)****
>>>
>>> rgb.palette <-
>>> colorRampPalette(c("firebrick4","khaki1","green4"))****
>>>
>>> ** **
>>>
>>> # Plot****
>>>
>>> ** **
>>>
>>> spplot(s$May_2012, main = "",****
>>>
>>>    sp.layout=list(thana),at=at.NDVI,****
>>>
>>>    par.settings=list(axis.line=list(col="grey60",lwd=0.5)),****
>>>
>>>
>>> colorkey=list(space="right",width=1.8,at=1:13,labels=list(cex=1.2,at
>>> =
>>> 1:13,
>>> ****
>>>
>>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>>> "3.0"))),****
>>>
>>>    col.regions=rgb.palette(60))****
>>>
>>> ** **
>>>
>>> # Animated GIF (This function did not work!)****
>>>
>>> saveGIF(****
>>>
>>> for (i in 1:ns){****
>>>
>>>    print(spplot(s[], main = list(label=paste("May_",i),cex=1.5),****
>>>
>>>    sp.layout=list(thana), at=at.NDVI,****
>>>
>>>    par.settings=list(axis.line=list(col="grey25",lwd=0.5)),****
>>>
>>>
>>> colorkey=list(space="right",width=1.8,at=1:21,labels=list(cex=1.2,at
>>> =
>>> 1:21,
>>> ****
>>>
>>>    labels=c("-3.0","","","-1.5","","", "0.0", "", "", "1.5", "", "",
>>> "3.0"))),****
>>>
>>>    col.regions=rgb.palette(60)))}, ****
>>>
>>> height = 500, width = 350, interval = .3, outdir = getwd())****
>>>
>>> }****
>>>
>>> ** **
>>>
>>> *From:* Andrew Vitale [mailto:vitale232 at gmail.com]
>>> *Sent:* Tuesday, July 02, 2013 4:24 PM
>>>
>>> *To:* Zia Uddin Ahmed
>>> *Cc:* r-sig-geo at r-project.org
>>> *Subject:* Re: [R-sig-Geo] Help: Individual plots all raster in a 
>>> raster stack in loop****
>>>
>>> ** **
>>>
>>> Zia,****
>>>
>>> ** **
>>>
>>> I like to use the plot function from the raster package.****
>>>
>>> ** **
>>>
>>> ?raster:::plot****
>>>
>>> ** **
>>>
>>> To continue your example, I'm able to plot the individual layers of 
>>> a stack using the lapply() function.  I'm not sure if there is a 
>>> simpler way to do it, but this way works for me:****
>>>
>>> ** **
>>>
>>> library(raster)****
>>>
>>> library(sp)****
>>>
>>> library(gstat)****
>>>
>>> ** **
>>>
>>> fn <- system.file("external/test.grd", package="raster")****
>>>
>>> r <- raster(fn)****
>>>
>>> r2 <- raster(fn)+runif(ncell(r))****
>>>
>>> r3 <- raster(fn)+runif(ncell(r))****
>>>
>>> r4 <- raster(fn)+runif(ncell(r))****
>>>
>>> s <- stack(r, r2,r3, r4)****
>>>
>>> ** **
>>>
>>> # Plot all rasters in a raster stack****
>>>
>>> ** **
>>>
>>> lapply(1:nlayers(s), function(x){plot(s[[x]], main =
>>> names(s[[x]]));x11()})
>>> ****
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ####And if you want the layers all in one plot, just use****
>>>
>>> ** **
>>>
>>> plot(s)****
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> ** **
>>>
>>> On Tue, Jul 2, 2013 at 10:47 AM, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:
>>> ****
>>>
>>> I like to plot (individual plot all raster objects in raster stack 
>>> in a loop. Help will be appreciated.
>>> Thanks
>>> Zia
>>>
>>> library(raster)
>>> library(sp)
>>> library(gstat)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> r3 <- raster(fn)+runif(ncell(r))
>>> r4 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2,r3, r4)
>>> names(s)
>>> # [1] "test.1" "test.2" "test.3" "test.4"
>>>
>>> # Plot all rasters in a raster stack
>>> print(spplot(s$test.1))
>>> print(spplot(s$test.2))
>>> print(spplot(s$test.3))
>>> print(spplot(s$test.4))
>>>
>>> From: Andrew Vitale [mailto:vitale232 at gmail.com]
>>> Sent: Monday, July 01, 2013 3:13 PM
>>> To: Zia Uddin Ahmed
>>> Cc: Roman Lu?trik; r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map 
>>> from raster stack
>>>
>>> Did the sample code I sent not run on your system?  That's strange.
>>>
>>>
>>> On my machine:
>>>
>>>
>>> library(raster)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2)
>>> nlayers(s)
>>> m<-mean(s)
>>>
>>> std<-calc(s, fun = sd)
>>>
>>> fun = function(x)
>>> { sqrt(var(x))
>>> }
>>> sd <- calc(s, fun)
>>>
>>> par(mfrow=c(1,2));plot(sd,main = 'sd'); plot(std, main = 'std')
>>>
>>> identical(sd, std)
>>> #[1] TRUE
>>>
>>>> sessionInfo()
>>> R version 3.0.1 (2013-05-16)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C [5] 
>>> LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] raster_2.1-37 sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.1      lattice_0.20-15
>>>
>>> On Mon, Jul 1, 2013 at 10:14 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu>> wrote:
>>> Thanks you so much it works with following code. Zia
>>>
>>> fun = function(x)
>>> { sqrt(var(x))
>>> }
>>> sd <- calc(s, fun)
>>> plot(sd)
>>>
>>> From: Andrew Vitale
>>> [mailto:vitale232 at gmail.com<mailto:vitale232 at gmail.com
>>>> ]
>>> Sent: Monday, July 01, 2013 12:45 PM
>>> To: Zia Uddin Ahmed
>>> Cc: Roman Lu?trik;
>>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>>
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map 
>>> from raster stack
>>>
>>> Check out ?calc
>>>
>>> library(raster)
>>> fn <- system.file("external/test.grd", package="raster") r <-
>>> raster(fn)
>>> r2 <- raster(fn)+runif(ncell(r))
>>> s <- stack(r, r2)
>>> nlayers(s)
>>> m<-mean(s)
>>> std<-calc(s, fun = sd)
>>>
>>>
>>> On Mon, Jul 1, 2013 at 9:30 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu>> wrote:
>>> In my case, object ?s? is a set of 22 geo-tif files.
>>> Thanks
>>> zia
>>>
>>> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:
>>> romunov at gmail.com<mailto:romunov at gmail.com>] On Behalf Of Roman 
>>> Lu?trik
>>> Sent: Monday, July 01, 2013 12:09 PM
>>> To: Zia Uddin Ahmed
>>> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>>> Subject: Re: [R-sig-Geo] Error creating a standard deviation map 
>>> from raster stack
>>>
>>> What's the class/structure of object `s`?
>>>
>>> Cheers,
>>> Roman
>>> On Mon, Jul 1, 2013 at 4:38 PM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:
>>> zua3 at cornell.edu><mailto:zua3 at cornell.edu<mailto:zua3 at cornell.edu>>>
>>> wrote:
>>> I am trying to calculate standard deviation map from a raster stack. 
>>> I have got following error . Any  suggestion?
>>>> std<-sd(s)
>>> Error in as.double(x) :
>>>   cannot coerce type 'S4' to vector of type 'double'
>>>
>>> Thanks
>>> Zia
>>>
>>> fn <- system.file("external/test.grd", package="raster") s <- 
>>> stack(fn, fn) r <- raster(fn) s <- stack(r, fn)
>>> nlayers(s)
>>> m<-mean(s)
>>> std<-sd(s)
>>>
>>>> sessionInfo()
>>> R version 3.0.1 (2013-05-16)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252 [2] 
>>> LC_CTYPE=English_United
>>> States.1252 [3] LC_MONETARY=English_United States.1252 [4] 
>>> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] gstat_1.0-16  rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.1       intervals_0.14.0 lattice_0.20-15  spacetime_1.0-4
>>> [5] xts_0.9-3        zoo_1.7-9
>>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org<mailto:
>>> r-sig-geo-bounces at r-project.org><mailto:r-sig-geo-bounces at r-project.
>>> o rg <mailto:r-sig-geo-bounces at r-project.org>> [mailto:
>>> r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.o
>>> r
>>> g
>>>> <mailto:r-sig-geo-bounces at r-project.org<mailto:
>>> r-sig-geo-bounces at r-project.org>>] On Behalf Of ASANTOS
>>> Sent: Sunday, June 23, 2013 4:08 PM
>>> To: Sarah Goslee;
>>> r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org
>>>> <mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>> Subject: Re: [R-sig-Geo] Problem with NDVI difference with subset 
>>> image
>>>
>>> Hi Dra. Goslee,
>>>
>>>              I work in OS linux and I like very much your lssub 
>>> function, despites your notice. I think that the problems are in 
>>> linux system,
>>> because:
>>>
>>>  > landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>> Error in .local(.Object, ...) :
>>>    `/home/asantos/Documentos/Sensoriamento remoto percevejo 
>>> bronzeador/Contornos/tackIm2.sample.tif' does not exist in the file 
>>> system, and is not recognised as a supported dataset name.
>>>
>>> Error in .rasterObjectFromFile(x, band = band, objecttype = 
>>> "RasterLayer",
>>>  :
>>>    Cannot create a RasterLayer object from this file. (file does not
>>> exist)
>>>
>>>
>>>               When I try to look the geotiff created
>>> (stackIm1.sample.tif) there are something wrong, because the 
>>> pictures doesn't open (complete example below).
>>>
>>> Thanks for your attention,
>>>
>>> Alexandre
>>>
>>> require(raster)
>>> require(sp)
>>> require(rgdal)
>>> require(landsat)
>>> #
>>> #Create raster
>>> r <- raster(nc=1000, nr=1000)
>>> set.seed(20130622)
>>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation red band
>>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation nir
>>>
>>> # define projection system
>>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>>> +no_defs")  # geographical datum WGS84
>>> proj4string(stackIm1) <- r.geo
>>> proj4string(stackIm2) <- r.geo
>>> #
>>>
>>> #Create geotiff
>>> writeRaster(stackIm1, filename="stackIm1.tif",
>>> format="GTiff",overwrite=TRUE)
>>> writeRaster(stackIm2, filename="stackIm2.tif",
>>> format="GTiff",overwrite=TRUE)
>>> #
>>>
>>> #Subset a geotiff image 50 x 50 pixels 
>>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", 
>>> centerx = 0, centery = 0, widthx = 50, widthy = 50) 
>>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>>> centerx = 0, centery = 0, widthx = 50, widthy = 50) #
>>> landc<- stack(c("stackIm1.sample.tif","tackIm2.sample.tif"))
>>>
>>>
>>>
>>>
>>>
>>> Em 23/06/2013 12:59, Sarah Goslee escreveu:
>>>> Hi,
>>>>
>>>> What happens?
>>>>
>>>> Do you get an error? Where?
>>>>
>>>> What is your sessionInfo()?
>>>>
>>>> As it says in the lssub() help, this function was written for a 
>>>> particular purpose, is only known to work on linux, and may not be 
>>>> widely applicable.
>>>>
>>>> It's a "use at your own risk" kind of function, and you may well be 
>>>> better off using one of the many other methods available for 
>>>> subsetting raster data, which would save you the whole "export as 
>>>> GeoTIFF, subset, reimport" sequence.
>>>>
>>>> Sarah
>>>>
>>>> On Sun, Jun 23, 2013 at 11:36 AM, Alexandre Santos 
>>>> <alexandresantosbr at yahoo.com.br<mailto:alexandresantosbr at yahoo.com.
>>>> b
>>>> r
>>>> <mailto:alexandresantosbr at yahoo.com.br<mailto:
>>> alexandresantosbr at yahoo.com.br>>> wrote:
>>>>> Dear Members,
>>>>>
>>>>>
>>>>> I'm having trouble calculating NDVI difference, first the images
>>> Geotiff can not view using Ubuntu 4.12 64-bit and therefore can not 
>>> get to the NDVI, follow an example:
>>>>>
>>>>> require(raster)
>>>>> require(sp)
>>>>> require(rgdal)
>>>>> require(landsat)
>>>>> #
>>>>> #Create raster
>>>>> r <- raster(nc=1000, nr=1000)
>>>>> set.seed(20130622)
>>>>> stackIm1 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation red band
>>>>> stackIm2 <- stack(lapply(1, function(x) setValues(r,
>>> round(runif(ncell(r))* 255))))## Simulation nir
>>>>>
>>>>> # define projection system
>>>>> r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
>>> +no_defs")    # geographical datum WGS84
>>>>> proj4string(stackIm1) <- r.geo
>>>>> proj4string(stackIm2) <- r.geo
>>>>> #
>>>>>
>>>>> #Create geotiff
>>>>> writeRaster(stackIm1, filename="stackIm1.tif",
>>> format="GTiff",overwrite=TRUE)
>>>>> writeRaster(stackIm2, filename="stackIm2.tif",
>>> format="GTiff",overwrite=TRUE)
>>>>> #
>>>>>
>>>>> #Subset a geotiff image 50 x 50 pixels 
>>>>> stackIm1.sample<-lssub("stackIm1.tif", "stackIm1.sample.tif", 
>>>>> centerx =
>>> 0, centery = 0, widthx = 50, widthy = 50)
>>>>> stackIm2.sample<-lssub("stackIm1.tif", "sstackIm2.sample.tif", 
>>>>> centerx
>>> = 0, centery = 0, widthx = 50, widthy = 50)
>>>>> #
>>>>>
>>>>> #Calculate NDVI difference
>>>>>
>>>>> multi.espc<-stack(c("stackIm1.sample.tif","stackIm2.sample.tif"))
>>>>>
>>>>> band3<-raster(multi.espc,1)
>>>>> band4<-raster(multi.espc,2)
>>>>>
>>>>> ndvi<-(band4-band3)/(band4+band3)
>>>>>
>>>>> #
>>>>>
>>>>>
>>>>>
>>>
>>> --
>>> ====================================================================
>>> =
>>> =
>>> Alexandre dos Santos
>>> Prote??o Florestal
>>> Coordenador do curso T?cnico em Florestas Vice Coordenador do curso 
>>> de Engenharia Florestal IFMT - Instituto Federal de Educa??o, 
>>> Ci?ncia e Tecnologia de Mato Grosso Campus C?ceres Caixa Postal 244 
>>> Avenida dos Ramires, s/n
>>> Bairro: Distrito Industrial
>>> C?ceres - MT                      CEP: 78.200-000
>>> Fone: (+55) 65 8132-8112<tel:%28%2B55%29%2065%208132-8112<%28%2B55%29%2065%208132-8112>>
>>> (TIM)   (+55) 65 9686-6970<tel:%28%2B55%29%2065%209686-6970<%28%2B55%29%2065%209686-6970>>
>>> (VIVO)
>>>          alexandre.santos at cas.ifmt.edu.br<mailto:
>>> alexandre.santos at cas.ifmt.edu.br><mailto:alexandre.santos at cas.ifmt.e
>>> d u.br <mailto:alexandre.santos at cas.ifmt.edu.br>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org><mailto:
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> In God we trust, all others bring data.
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Andrew P. Vitale
>>> Masters Student
>>> Department of Geography
>>> University of Nevada, Reno
>>> (412) 915-3632<tel:%28412%29%20915-3632 <%28412%29%20915-3632>> 
>>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>>
>>>
>>>
>>> --
>>> Andrew P. Vitale
>>> Masters Student
>>> Department of Geography
>>> University of Nevada, Reno
>>> (412) 915-3632
>>> vitale232 at gmail.com<mailto:vitale232 at gmail.com>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo****
>>>
>>>
>>>
>>> ****
>>>
>>> ** **
>>>
>>> -- ****
>>>
>>> *Andrew P. Vitale*****
>>>
>>> Masters Student****
>>>
>>> Department of Geography****
>>>
>>> University of Nevada, Reno****
>>>
>>> (412) 915-3632****
>>>
>>> vitale232 at gmail.com****
>>>
> 
> 
> --
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM) Dpto. Ingenier?a El?ctrica 
> (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan
> LinkedIn: http://www.linkedin.com/in/oscarperpinan
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From r.hijmans at gmail.com  Wed Jul  3 21:51:53 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 3 Jul 2013 12:51:53 -0700
Subject: [R-sig-Geo] Variance of prediction in Kriging
In-Reply-To: <CANJhsN03egawdenX8nL9UP+M=7PcE6mYgm89AmO48mhg5eszbg@mail.gmail.com>
References: <CANJhsN03egawdenX8nL9UP+M=7PcE6mYgm89AmO48mhg5eszbg@mail.gmail.com>
Message-ID: <CANtt_hx1Pgd9Hhob=mTwJRQ0GASDV5WaBxVxNwv7iOSj-6V9MQ@mail.gmail.com>

Maurizio,

you can use the "index" argument for that. Following your example in
?interpolate:

library(raster)
library(gstat)

r <- raster(system.file("external/test.grd", package="raster"))
data(meuse)
coordinates(meuse) <- ~x+y
projection(meuse) <- projection(r)

gCoK <- gstat(NULL, 'log.zinc', log(zinc)~1, meuse)
gCoK <- gstat(gCoK, 'elev', elev~1, meuse)
gCoK <- gstat(gCoK, 'cadmium', cadmium~1, meuse)
gCoK <- gstat(gCoK, 'copper', copper~1, meuse)
coV <- variogram(gCoK)
plot(coV, type='b', main='Co-variogram')
coV.fit <- fit.lmc(coV, gCoK, vgm(model='Sph', range=1000))
coV.fit
plot(coV, coV.fit, main='Fitted Co-variogram')
coK <- interpolate(r, coV.fit)
coKvar <- interpolate(r, coV.fit, index=2)


unfortunately x <- interpolate(r, coV.fit, index=1:2)  does not (yet) work.

Robert

On Wed, Jun 26, 2013 at 11:34 PM, Maurizio Marchi
<mauriziomarchi85 at gmail.com> wrote:
> Hallo everybody.
> Using the krige() function of the gstat package for ordinary and universal
> kriging and the predict() function of the same package for ordinary and
> universal cokriging I obtain the prediction of the variable and also the
> variance of prediction. Is possible to do the same with the raster package,
> maybe with an option of the interpolate() function?
> Thanks,
>
> Maurizio Marchi
> Ph.D student
>
>
> --
> Maurizio Marchi
> ID skype: maurizioxyz
> *Ubuntu 12.04 (Precise Pangolin)*
> *"Il bello dell'open-source ? che le domande possono essere poste alla
> fonte"*
> *utente linux 552.742*
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mathieu.rajerison at gmail.com  Thu Jul  4 10:09:08 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 4 Jul 2013 10:09:08 +0200
Subject: [R-sig-Geo] what's new in asdar latest edition?
In-Reply-To: <alpine.LRH.2.03.1307022113250.7096@reclus.nhh.no>
References: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>
	<51D1A952.7060602@uni-muenster.de>
	<alpine.LRH.2.03.1307022113250.7096@reclus.nhh.no>
Message-ID: <CAGfc75nqUBKjQhwX9Usy6pd31yJremvfy1mswzWi_oZfy-6jxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/558c0ef3/attachment.pl>

From ew66 at gmx.at  Thu Jul  4 11:38:08 2013
From: ew66 at gmx.at (erwin)
Date: Thu, 4 Jul 2013 02:38:08 -0700 (PDT)
Subject: [R-sig-Geo] SEM model : system is singular
Message-ID: <1372930688779-7584028.post@n2.nabble.com>

Hi,

I have to do a spatial model for my master thesis. If I do a SEM or SAR
model i get the message:

Fehler in solve.default(asyvar, tol = tol.solve) : 
  System ist f?r den Rechner singul?r: reziproke Konditionszahl =
3.61856e-20

In other posts i have read that the reason could be multicollinearity. I
have tested it with vif but all factors were below 2. I have also tried to
add random numbers like suggested in another post but i got the same error
message.

If i do an SAR with another method like "Matrix_J" i get the following error
message:

Fehler in as_dsTMatrix_listw(get("listw", envir = env)) : 
  odd neighbours sum

So i don't get results at any type of model. I have a 2380*2380 weighting
matrix could the size be a problem?


Thank you very much in advance

erwin



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/SEM-model-system-is-singular-tp7584028.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ariel.fuentesdi at usach.cl  Thu Jul  4 17:32:24 2013
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Thu, 4 Jul 2013 11:32:24 -0400
Subject: [R-sig-Geo] help: density map
Message-ID: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/3d8745e2/attachment.pl>

From juantomas.sayago at gmail.com  Thu Jul  4 19:14:11 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Thu, 4 Jul 2013 13:14:11 -0400
Subject: [R-sig-Geo] help: density map
In-Reply-To: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
References: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
Message-ID: <CAEOXpNCV=fMmKJf0ap5_SWy7x1M0U5XNzSZCSacPztA-fD8P_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/00c691f8/attachment.pl>

From wdf61 at mac.com  Thu Jul  4 19:21:43 2013
From: wdf61 at mac.com (Wayne Folta)
Date: Thu, 04 Jul 2013 13:21:43 -0400
Subject: [R-sig-Geo] help: density map
In-Reply-To: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
References: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
Message-ID: <2A129189-1B90-4BD3-8819-621397256F65@mac.com>

Ariel,

Are you wanting to map the density of the raingauges, or are you wanting to interpolate the values of the rain at the rain gauges? KernSmooth will do the former.

In either case, you might want to look at the R package ggplot2, which includes density-plotting mechanisms. Say you have your rain gauge lat's and lon's in a data frame, raindata. You could plot the density of the gauges and overlay the gauge locations with something like:

    ggplot (raindata, aes(x=lon, y=lat)) + geom_density2d () + geom_point () 

If you want to plot the density of the rain instead:

        ggplot (raindata, aes(x=lon, y=lat, z=rainamount)) + stat_contour (geom="polygon", aes(fill=..level..)) + geom_point () 

And if you want to overlay either of these on a Google (or OpenStreetMap) map background, look into the ggmap package, which makes it easy.

   Wayne

On Jul 4, 2013, at 11:32 AM, Ariel Fuentesdi <ariel.fuentesdi at usach.cl> wrote:

> Hello,
> 
> I have raingauges as points and I want to make an heatmap with those
> points. So, I understand I need to do a kernel density estimation, but,
> there are different kernel functions. Thus, my questions is: how do I know
> which kernel function I need to apply to my data? Do I need to run a
> previous test first?
> 
> I believe I can select the function using grass, but how can I do it with
> R? Do I have to use the KernSmooth package? How Can I map that ?
> 
> Regards,
> Ariel
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jon.baik at stat.ubc.ca  Thu Jul  4 19:28:12 2013
From: jon.baik at stat.ubc.ca (jbaik)
Date: Thu, 4 Jul 2013 10:28:12 -0700 (PDT)
Subject: [R-sig-Geo] rasterVis: Region colours do not match the legend
	colours
Message-ID: <1372958892791-7584032.post@n2.nabble.com>

I want to compare several layer plots of a set of raster files that I have.
The problem is that the range of the data differs slightly for each file, so
the legends and colours are not directly comparable if I plot the rasters
side by side. For example, the range of data in raster A might be c(10, 90),
but raster B might have a range of c(0,100) - but then the regions in raster
A with values of 10 will be coloured the same as the regions in raster B
with values of 0!!

I tried modifying the plot using the "col.regions=", "at=" and "colorkey="
parameters in the "levelplot" command, but it does not seem to work.

Here is a reproducible example of my problem:


# Fix legend in raster plots
library(raster)
library(rasterVis)

f <- system.file("external/test.grd", package="raster")
r <- raster(f)

# The original levelplot
levelplot(r)

# Try to modify the legend and region colours
rgb.palette <- colorRampPalette(c("black", "white", "red"),
                                space = "rgb")

levelplot(r, col.regions=rgb.palette(16),
          at=seq(-30000, 30000, length=15) , contour=FALSE, 
          colorkey=list( at=seq(-30000, 30000, length=15), 
                         col=rgb.palette(16) ))



Notice that the original range of data is between approximately 0 and 2000.
In my second levelplot, I expand the range to -30000 and 30000. The legend
seems to reflect this, but the colours of the regions do not match the
legend!

How can I expand the range of the legend and force the regions to be
coloured properly?



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-not-match-the-legend-colours-tp7584032.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From oscar.perpinan at gmail.com  Thu Jul  4 19:56:45 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 04 Jul 2013 19:56:45 +0200
Subject: [R-sig-Geo] rasterVis: Region colours do not match the
	legend	colours
In-Reply-To: <1372958892791-7584032.post@n2.nabble.com>
References: <1372958892791-7584032.post@n2.nabble.com>
Message-ID: <87obaip5sy.fsf@gmail.com>

Hello,

Because the differences between layers are small, a suitable solution is to increase the
number of breaks:

library(raster)
library(rasterVis)

f <- system.file("external/test.grd", package="raster")
r <- raster(f)
r1 <- r + 100*runif(ncell(r))
r2 <- r - 100*runif(ncell(r))

s <- stack(r, r1, r2)

levelplot(s,
          par.settings=rasterTheme(region=c('black', 'white', 'red')),
          cuts=99)

Another approach is to display each layer with an independent legend:
http://rastervis.r-forge.r-project.org/FAQ.html#sec-7

Best,

Oscar.


jbaik writes:

> I want to compare several layer plots of a set of raster files that I have.
> The problem is that the range of the data differs slightly for each file, so
> the legends and colours are not directly comparable if I plot the rasters
> side by side. For example, the range of data in raster A might be c(10, 90),
> but raster B might have a range of c(0,100) - but then the regions in raster
> A with values of 10 will be coloured the same as the regions in raster B
> with values of 0!!
>
> I tried modifying the plot using the "col.regions=", "at=" and "colorkey="
> parameters in the "levelplot" command, but it does not seem to work.
>
> Here is a reproducible example of my problem:
>
>
> # Fix legend in raster plots
> library(raster)
> library(rasterVis)
>
> f <- system.file("external/test.grd", package="raster")
> r <- raster(f)
>
> # The original levelplot
> levelplot(r)
>
> # Try to modify the legend and region colours
> rgb.palette <- colorRampPalette(c("black", "white", "red"),
>                                 space = "rgb")
>
> levelplot(r, col.regions=rgb.palette(16),
>           at=seq(-30000, 30000, length=15) , contour=FALSE, 
>           colorkey=list( at=seq(-30000, 30000, length=15), 
>                          col=rgb.palette(16) ))
>
>
>
> Notice that the original range of data is between approximately 0 and 2000.
> In my second levelplot, I expand the range to -30000 and 30000. The legend
> seems to reflect this, but the colours of the regions do not match the
> legend!
>
> How can I expand the range of the legend and force the regions to be
> coloured properly?
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-not-match-the-legend-colours-tp7584032.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From jon.baik at stat.ubc.ca  Thu Jul  4 20:28:18 2013
From: jon.baik at stat.ubc.ca (jbaik)
Date: Thu, 4 Jul 2013 11:28:18 -0700 (PDT)
Subject: [R-sig-Geo] rasterVis: Region colours do not match the
	legend	colours
In-Reply-To: <87obaip5sy.fsf@gmail.com>
References: <1372958892791-7584032.post@n2.nabble.com>
	<87obaip5sy.fsf@gmail.com>
Message-ID: <1372962498975-7584034.post@n2.nabble.com>

Hello,

Thanks for the reply, Oscar. Placing the different raster layers into a
stack before calling layerplot seems to have fixed the problem. I am able to
compare the plots now with the same scale.

However, I would still like to know how to manually set the region colours
and extend the range of the legend, if it is possible. I am also dealing
with a time component, so while stacking the layers forces all the layer
plots to use the same colours at the same values at, say time t=0, the range
of data may change after some time has progressed, say at time t=10.

Ultimately, the goal would be to make a gif to compare several climate model
forecasts over time, like so:

<http://r-sig-geo.2731867.n2.nabble.com/file/n7584034/testing.gif> 

If the gif is viewable, notice how the legend is changing as the gif
animation plays out - I want to, if possible, have the legend fixed and the
regions coloured correctly according to the legend.

I have read the link about creating an independent legend for each raster
layer, but I think I would prefer to have just one legend.

Thanks again,

Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-not-match-the-legend-colours-tp7584032p7584034.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ariel.fuentesdi at usach.cl  Thu Jul  4 21:02:46 2013
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Thu, 4 Jul 2013 15:02:46 -0400
Subject: [R-sig-Geo] help: density map
In-Reply-To: <CAEOXpNCV=fMmKJf0ap5_SWy7x1M0U5XNzSZCSacPztA-fD8P_g@mail.gmail.com>
References: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
	<CAEOXpNCV=fMmKJf0ap5_SWy7x1M0U5XNzSZCSacPztA-fD8P_g@mail.gmail.com>
Message-ID: <CAD0a9Kj9uYRqn=4LNt0PUyh0fYiaG0okfcT83hAuQObp9Zs3Bg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/a7912b55/attachment.pl>

From juantomas.sayago at gmail.com  Thu Jul  4 21:08:24 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Thu, 4 Jul 2013 15:08:24 -0400
Subject: [R-sig-Geo] help: density map
In-Reply-To: <CAD0a9Kj9uYRqn=4LNt0PUyh0fYiaG0okfcT83hAuQObp9Zs3Bg@mail.gmail.com>
References: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
	<CAEOXpNCV=fMmKJf0ap5_SWy7x1M0U5XNzSZCSacPztA-fD8P_g@mail.gmail.com>
	<CAD0a9Kj9uYRqn=4LNt0PUyh0fYiaG0okfcT83hAuQObp9Zs3Bg@mail.gmail.com>
Message-ID: <CAEOXpNB7goRFgpDCv-Pvnz2OG+D+fMZOZX25W1o46KW=EVdJeg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/2bd7b8af/attachment.pl>

From marcelino.delacruz at upm.es  Thu Jul  4 21:26:17 2013
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 04 Jul 2013 21:26:17 +0200
Subject: [R-sig-Geo] help: density map
In-Reply-To: <CAD0a9Kj9uYRqn=4LNt0PUyh0fYiaG0okfcT83hAuQObp9Zs3Bg@mail.gmail.com>
References: <CAD0a9KgEvKxWTae7GyV1LFAaTAW-BLovX8FZmmK1RfxxW3yBHw@mail.gmail.com>
	<CAEOXpNCV=fMmKJf0ap5_SWy7x1M0U5XNzSZCSacPztA-fD8P_g@mail.gmail.com>
	<CAD0a9Kj9uYRqn=4LNt0PUyh0fYiaG0okfcT83hAuQObp9Zs3Bg@mail.gmail.com>
Message-ID: <51D5CC59.4030600@upm.es>

In general it is acknowledged that it is more important to select a 
bandwith (i.e., a sigma for the Gaussian kernel) than the type of kernel 
(see for example the 1st ed. of the ASDAR book, p. 167).
You can select a sensible bandwith with the functions bw.diggle  in 
spatstat or mse2d in splancs.

By the way, there is a illustrative chapter about kernel functions (in 
spanish) in this book (you can download a free pdf copy)

http://www.bubok.es/libros/225830/Avances-en-el-Analisis-Espacial-de-Datos-Ecologicos-Aspectos-Metodologicos-y-Aplicados


Cheers,
Marcelino

El 04/07/2013 21:02, Ariel Fuentesdi escribi?:
> Thank you,
> Why sigma = 10?, what function can I use for choose the best sigma?. And I
> looked the info about density.ppp and it says it use the Gaussian Kernel.
> But, if we look on wikipedia:
> http://en.wikipedia.org/wiki/Kernel_(statistics) , it says, there are more
> kernel function than the Gaussian Kernel, so my question is how do I know
> wether I have to use for example a Gaussian kernel or a Tricube Kernel.
>
> Regards,
> Ariel
>
> 2013/7/4 Juan Tomas Sayago Gomez <juantomas.sayago at gmail.com>
>
>> Hello,
>> you can use the commands in spatstat
>>
>> library(spatstat)
>>
>> summary(swedishpines)
>> plot(density(swedishpines, sigma = 10))
>> then check the help in the spatstat command density.ppp
>>
>> Also check the material in this course http://www.csiro.au/resources/pf16h
>>
>>
>> Juan
>>
>>
>> On Thu, Jul 4, 2013 at 11:32 AM, Ariel Fuentesdi <ariel.fuentesdi at usach.cl
>>> wrote:
>>
>>> Hello,
>>>
>>> I have raingauges as points and I want to make an heatmap with those
>>> points. So, I understand I need to do a kernel density estimation, but,
>>> there are different kernel functions. Thus, my questions is: how do I know
>>> which kernel function I need to apply to my data? Do I need to run a
>>> previous test first?
>>>
>>> I believe I can select the function using grass, but how can I do it with
>>> R? Do I have to use the KernSmooth package? How Can I map that ?
>>>
>>> Regards,
>>> Ariel
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> Juan Tom?s Sayago G?mez
>> Graduate Research Assistant
>> West Virginia University - RRI
>> 886 Chestnut Ridge Road, Room 520
>> P.O. Box 6825
>> Morgantown, WV 26506-6825
>>
>
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From paolo.piras at uniroma3.it  Thu Jul  4 22:56:31 2013
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Thu, 4 Jul 2013 20:56:31 +0000
Subject: [R-sig-Geo] R or R studio 3d manipulate
Message-ID: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>

Hi folks,

I'm performing some simulation of spatial data that I need to visualize when manipulating a given variable in expression 
Do you know if there is ANY possibility to build a 3d graph with a manipulator button?
In 2d it is very easily feasable in RStudio; I did it
 but in 3D ...I cannot find any solution
I would like to do in R what you can see here (in Mathematica) under the section "3D graphics":
http://reference.wolfram.com/mathematica/tutorial/IntroductionToManipulate.html


Thanks in advance for your advice
best
paolo

From zua3 at cornell.edu  Fri Jul  5 01:53:24 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Thu, 4 Jul 2013 23:53:24 +0000
Subject: [R-sig-Geo] Help: Setting values between minus 1 to plus 1 in all
 raster objects (Geo TIFF) in a raster stack
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EAAAE91@CH1PRD0410MB391.namprd04.prod.outlook.com>

I have calculated time series NDWI (float TIFFF raster ) values from Landsat images.  In few pixels of all raster (in a raster stack) objects have  values  <-1.000 and >1.0000 . I like to convert values that are <-1 to -1.000 and values that are >1 to +1.000 of all  raster and save as getif (float) files in a loop. I have limited knowledge in looping.  Help will be appreciated. Thanks
Zia


-----Original Message-----
From: Zia Uddin Ahmed 
Sent: Thursday, July 04, 2013 7:29 PM
To: Oscar Perpi??n Lamigueiro
Subject: Setting values between minus 1 to plus 1 in all raster object in a raster stack,

I have calculated NDWI from Landsat images. I have get values few pixel

Zia Ahmed, PhD
Dept. Crop and Soil Sciences
Cornell University
Ithaca, NY 14850

On Jul 4, 2013, at 2:01 PM, "Oscar Perpi??n Lamigueiro" <oscar.perpinan at gmail.com> wrote:

> Hello,
> 
> Because the differences between layers are small, a suitable solution 
> is to increase the number of breaks:
> 
> library(raster)
> library(rasterVis)
> 
> f <- system.file("external/test.grd", package="raster") r <- raster(f)
> r1 <- r + 100*runif(ncell(r))
> r2 <- r - 100*runif(ncell(r))
> 
> s <- stack(r, r1, r2)
> 
> levelplot(s,
>          par.settings=rasterTheme(region=c('black', 'white', 'red')),
>          cuts=99)
> 
> Another approach is to display each layer with an independent legend:
> http://rastervis.r-forge.r-project.org/FAQ.html#sec-7
> 
> Best,
> 
> Oscar.
> 
> 
> jbaik writes:
> 
>> I want to compare several layer plots of a set of raster files that I have.
>> The problem is that the range of the data differs slightly for each 
>> file, so the legends and colours are not directly comparable if I 
>> plot the rasters side by side. For example, the range of data in 
>> raster A might be c(10, 90), but raster B might have a range of 
>> c(0,100) - but then the regions in raster A with values of 10 will be 
>> coloured the same as the regions in raster B with values of 0!!
>> 
>> I tried modifying the plot using the "col.regions=", "at=" and "colorkey="
>> parameters in the "levelplot" command, but it does not seem to work.
>> 
>> Here is a reproducible example of my problem:
>> 
>> 
>> # Fix legend in raster plots
>> library(raster)
>> library(rasterVis)
>> 
>> f <- system.file("external/test.grd", package="raster") r <- 
>> raster(f)
>> 
>> # The original levelplot
>> levelplot(r)
>> 
>> # Try to modify the legend and region colours rgb.palette <- 
>> colorRampPalette(c("black", "white", "red"),
>>                                space = "rgb")
>> 
>> levelplot(r, col.regions=rgb.palette(16),
>>          at=seq(-30000, 30000, length=15) , contour=FALSE, 
>>          colorkey=list( at=seq(-30000, 30000, length=15), 
>>                         col=rgb.palette(16) ))
>> 
>> 
>> 
>> Notice that the original range of data is between approximately 0 and 2000.
>> In my second levelplot, I expand the range to -30000 and 30000. The 
>> legend seems to reflect this, but the colours of the regions do not 
>> match the legend!
>> 
>> How can I expand the range of the legend and force the regions to be 
>> coloured properly?
>> 
>> 
>> 
>> --
>> View this message in context: 
>> http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-no
>> t-match-the-legend-colours-tp7584032.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> --
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM) Dpto. Ingenier?a El?ctrica 
> (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From fabriciovasselai at gmail.com  Fri Jul  5 03:08:48 2013
From: fabriciovasselai at gmail.com (Fabricio Vasselai)
Date: Thu, 4 Jul 2013 21:08:48 -0400
Subject: [R-sig-Geo] Sampling random clustering of spatial points for
	districatilization experiment
Message-ID: <CAEkXS9+PzZYFktLP7Qtq6p9Zx7J2YVbSHBK3o=R0+k5mhwEBtQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130704/829a6995/attachment.pl>

From michela.giusti at isprambiente.it  Fri Jul  5 10:12:04 2013
From: michela.giusti at isprambiente.it (Michela Giusti)
Date: Fri, 05 Jul 2013 10:12:04 +0200
Subject: [R-sig-Geo] problem in producing a HSM on different sites
Message-ID: <51D67FD4.7080902@isprambiente.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130705/71ff53bb/attachment.pl>

From oscar.perpinan at gmail.com  Fri Jul  5 18:13:23 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Fri, 05 Jul 2013 18:13:23 +0200
Subject: [R-sig-Geo] rasterVis: Region colours do not match
	the	legend	colours
In-Reply-To: <1372962498975-7584034.post@n2.nabble.com>
References: <1372958892791-7584032.post@n2.nabble.com>,
	<87obaip5sy.fsf@gmail.com>,
	<1372962498975-7584034.post@n2.nabble.com>
Message-ID: <87mwq12dek.fsf@gmail.com>

Hello,

> However, I would still like to know how to manually set the region colours
> and extend the range of the legend, if it is possible. 

You have to use the at argument as you already did. However, you should
choose better breaks to display your data correctly. Here you will find
an example: http://rastervis.r-forge.r-project.org/FAQ.html#sec-1.

> I am also dealing with a time component, so while stacking the layers
> forces all the layer plots to use the same colours at the same values
> at, say time t=0, the range of data may change after some time has
> progressed, say at time t=10.
>
> Ultimately, the goal would be to make a gif to compare several climate model
> forecasts over time, like so:
>
> <http://r-sig-geo.2731867.n2.nabble.com/file/n7584034/testing.gif> 
>
> If the gif is viewable, notice how the legend is changing as the gif
> animation plays out - I want to, if possible, have the legend fixed and the
> regions coloured correctly according to the legend.

Use layout=c(1, 1). With your data:

levelplot(s, layout=c(1, 1))

If you need to create a movie use this code:

trellis.device(png, file='Rplot%02d.png')
levelplot(s, layout=c(1, 1))
dev.off()

## ffmpeg must be installed in your system
movieCMD <- 'ffmpeg -i Rplot%02d.png output.mp4'
system(movieCMD)

Take a look at this thread for more info:
https://stat.ethz.ch/pipermail/r-sig-geo/2013-July/018735.html.

Best,

Oscar.


> I have read the link about creating an independent legend for each raster
> layer, but I think I would prefer to have just one legend.
>
> Thanks again,
>
> Jonathan
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-not-match-the-legend-colours-tp7584032p7584034.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan
LinkedIn: http://www.linkedin.com/in/oscarperpinan


From jon.baik at stat.ubc.ca  Fri Jul  5 19:14:42 2013
From: jon.baik at stat.ubc.ca (jbaik)
Date: Fri, 5 Jul 2013 10:14:42 -0700 (PDT)
Subject: [R-sig-Geo] rasterVis: Region colours do not match
	the	legend	colours
In-Reply-To: <87mwq12dek.fsf@gmail.com>
References: <1372958892791-7584032.post@n2.nabble.com>
	<87obaip5sy.fsf@gmail.com>
	<1372962498975-7584034.post@n2.nabble.com>
	<87mwq12dek.fsf@gmail.com>
Message-ID: <1373044482551-7584043.post@n2.nabble.com>

Thanks for the reply, Oscar.

I tried running the example that you linked, and it did not work. It seems
there was something wrong with my R or rasterVis package on my machine. 

I ran "install.packages('rasterVis', dependencies=TRUE)", and it said that
the package "rgl" could not be installed with the following error:
"configure: error: missing required header GL/gl.h". 

After fixing this, and then installing the 'rgl' package in R, everything
seems to work!

Thanks again for the help,

Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rasterVis-Region-colours-do-not-match-the-legend-colours-tp7584032p7584043.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amerinoviteri at gmail.com  Sun Jul  7 05:25:50 2013
From: amerinoviteri at gmail.com (Andres Merino-Viteri)
Date: Sat, 6 Jul 2013 22:25:50 -0500
Subject: [R-sig-Geo] alternative for spixdf2kasc from adehabitat package
Message-ID: <CAHRdQt_hmUEBjaTmdTcqpDVBc-cTvUc3mKmtCDhkage1uB+QnA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130706/62657774/attachment.pl>

From villers.alexandre at gmail.com  Sun Jul  7 06:46:32 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Sun, 7 Jul 2013 07:46:32 +0300
Subject: [R-sig-Geo] alternative for spixdf2kasc from adehabitat package
In-Reply-To: <CAHRdQt_hmUEBjaTmdTcqpDVBc-cTvUc3mKmtCDhkage1uB+QnA@mail.gmail.com>
References: <CAHRdQt_hmUEBjaTmdTcqpDVBc-cTvUc3mKmtCDhkage1uB+QnA@mail.gmail.com>
Message-ID: <CAFrtd2OLUWH8bwfwWb4Q54q9iW5sz+Fq3-=xYvxg5pCeuVNvrA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130707/e7bd6612/attachment.pl>

From catalinroibu at gmail.com  Sun Jul  7 12:12:39 2013
From: catalinroibu at gmail.com (catalin roibu)
Date: Sun, 7 Jul 2013 13:12:39 +0300
Subject: [R-sig-Geo] spatstat output
Message-ID: <CAEW+BDKqRgQzsf_f1NYfTET-LsYN6cSG9M8cNzREiKz+kg2Tdw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130707/814ac3eb/attachment.pl>

From HodgessE at uhd.edu  Sun Jul  7 14:05:25 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 7 Jul 2013 12:05:25 +0000
Subject: [R-sig-Geo] spatstat output
In-Reply-To: <CAEW+BDKqRgQzsf_f1NYfTET-LsYN6cSG9M8cNzREiKz+kg2Tdw@mail.gmail.com>
References: <CAEW+BDKqRgQzsf_f1NYfTET-LsYN6cSG9M8cNzREiKz+kg2Tdw@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A13CB0@columbia.uhd.campus>

Hello!

For the first question, here is an example:

> E <- alltypes(bramblecanes, Kest, nsim = 100, envelope =
+ TRUE,savepatterns=TRUE,correction="isotropic")
> E$fns[[1]]$r
> E$fns[[1]]$obs


________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of catalin roibu [catalinroibu at gmail.com]
Sent: Sunday, July 07, 2013 5:12 AM
To: r-sig-geo at stat.math.ethz.ch
Cc: r-help at r-project.org
Subject: [R-sig-Geo] spatstat output

Dear R users,
Is there a possibility to extract only the r, CI's envelope and L function
from the output of spatstat?
I use this code
E <- alltypes(df1, Kest, nsim = 100, envelope =
TRUE,savepatterns=TRUE,correction="isotropic")
And second question, is there a possibility to modify the margin of plot in
spatstat?

plot(E, sqrt(./pi) - r ~ r, ylab = "L(r)-r",main=NULL,sub=NULL,las=1)

Thank you very much for your help!

CR

--
---
Catalin-Constantin ROIBU
Lecturer PhD, Forestry engineer
Forestry Faculty of Suceava
Str. Universitatii no. 13, Suceava, 720229, Romania
office phone     +4 0230 52 29 78, ext. 531
mobile phone   +4 0745 53 18 01
                       +4 0766 71 76 58
FAX:                +4 0230 52 16 64
silvic.usv.ro

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From basille.web at ase-research.org  Sun Jul  7 17:45:04 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Sun, 07 Jul 2013 11:45:04 -0400
Subject: [R-sig-Geo] alternative for spixdf2kasc from adehabitat package
In-Reply-To: <CAFrtd2OLUWH8bwfwWb4Q54q9iW5sz+Fq3-=xYvxg5pCeuVNvrA@mail.gmail.com>
References: <CAHRdQt_hmUEBjaTmdTcqpDVBc-cTvUc3mKmtCDhkage1uB+QnA@mail.gmail.com>
	<CAFrtd2OLUWH8bwfwWb4Q54q9iW5sz+Fq3-=xYvxg5pCeuVNvrA@mail.gmail.com>
Message-ID: <51D98D00.3050804@ase-research.org>

Dear Andres,

In addition to Alexandre's answers, did you try with the RGDAL package? 
Something like:

veg <- readGDAL("~/Desktop/natur_inter.asc")

This should solve your problem: the asc should be imported as a 
SpatialPixel object, which can then be used in the new version of 
adehabitat package, as underlined by Alexandre.

Mathieu Basille.


Le 07/07/2013 12:46 AM, Alexandre Villers a ?crit :
> Hello,
>
> Look at adehabitatHS package (and other related packages adehabitatHR and
> adehabitatLT): there are new functions to take advantage of sp class
> objects (such as the ones created when reading a raster with rgdal).
> Adehabitat is now "deprecated" and you should use these other packages
> instead
>
> HTH
>
> Alex
>
>
> 2013/7/7 Andres Merino-Viteri <amerinoviteri at gmail.com>
>
>> Dear list,
>>
>> Sometimes I have problems opening ASCII files  with read.asc function from
>> SDMTools package.
>>
>> The error message is like  the following one:
>>
>>> Veg=read.asc("~/Desktop/natur_inter.asc")
>> Error in if ((yll[[1]][1] == "yllcenter") | (xll[[1]][1] == "YLLCENTER")) {
>> :
>>    missing value where TRUE/FALSE needed
>> In addition: Warning message:
>> In read.asc("~/Desktop/natur_inter.asc") : NAs introduced by coercion
>>
>> Looking at different forums I found the following solution to this problem:
>>
>> library("rgdal")
>> library("adehabitat")
>> B1=readGDAL("~/Desktop/natur_inter.asc")
>> blaK <- spixdf2kasc(B1)
>> write.asc(blaK, "~/Desktop/NEW_natur_inter.asc", gz=FALSE)
>>
>> It used to solve my problem. The NEW .asc file did not display any error
>> message when read with the read.asc function.
>>
>> However, since I updated to R 2.15.2 GUI 1.53 Leopard build 32-bit (6335),
>> I can not use adehabitat package anymore, and I have not been able to find
>> the "spixdf2kasc" function in the new adehabitat family packages. Now, I am
>> not able to use new .asc files provided to me.
>>
>> Does anyone have an alternative solution for  the read.asc error? or an
>> alternative for using "spixdf2kasc" function?
>>
>> Any help would be very appreciated. Thanks.
>>
>> Andres
>>
>> Additional infor about my R version:
>> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
>> Copyright (C) 2012 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>
>> My computer:
>> MacBook 2GHz Intel Core 2 Duo
>> MAC OS X Version 10.6.8
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From kanwalnayan at gmail.com  Sun Jul  7 19:40:05 2013
From: kanwalnayan at gmail.com (Kanwal Nayan)
Date: Sun, 7 Jul 2013 10:40:05 -0700
Subject: [R-sig-Geo] Thought you'd find this interesting
Message-ID: <0.0.0.F8C.1CE7B3904650814.0@vmta09.monkeyinferno.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130707/3439c7e4/attachment.pl>

From fvbersse at gmail.com  Sun Jul  7 21:32:17 2013
From: fvbersse at gmail.com (Ferdinand Bersse)
Date: Sun, 7 Jul 2013 15:32:17 -0400
Subject: [R-sig-Geo] Error when installing rgeos
Message-ID: <CA+nXtYbM9rf+XGux_oaJpSCZ3v7WHm4JjwMRuGfZp+SqkwsMOw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130707/83cc2e95/attachment.pl>

From ubuntero.9161 at gmail.com  Sun Jul  7 21:39:54 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Sun, 7 Jul 2013 22:39:54 +0300
Subject: [R-sig-Geo] Error when installing rgeos
In-Reply-To: <CA+nXtYbM9rf+XGux_oaJpSCZ3v7WHm4JjwMRuGfZp+SqkwsMOw@mail.gmail.com>
References: <CA+nXtYbM9rf+XGux_oaJpSCZ3v7WHm4JjwMRuGfZp+SqkwsMOw@mail.gmail.com>
Message-ID: <CAAVnHstC3j1heae=zDUJFWxnogdapyr2WJLFDYqbsxi8JO8yWg@mail.gmail.com>

On Sun, Jul 7, 2013 at 10:32 PM, Ferdinand Bersse <fvbersse at gmail.com> wrote:
> Dear list,
>
> I am trying to install rgeos package in a Red-Hat Linux server, but I
> receive the following error in the install report. I would appreciate any
> insights on how to solve the problem:
>
...
> ./configure: line 1385: geos-config: command not found
> no
> configure: error: geos-config not usable
> ERROR: configuration failed for package ?rgeos?

Hi Ferdinand,

as the output says, you don't have the geos-config file on your
system. Therefore you need to install the .rpm that provides the file
before installing rgeos. I'm not on a RH machine and I'm guessing now
that the needed package might be something like geos-devel-*.rpm.
Perhaps you can use the RH package tools to locate and install the
exact package.

HTH,
Ivailo
--
UBUNTU: a person is a person through other persons.


From Roger.Bivand at nhh.no  Sun Jul  7 21:45:03 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 7 Jul 2013 21:45:03 +0200
Subject: [R-sig-Geo] SEM model : system is singular
In-Reply-To: <1372930688779-7584028.post@n2.nabble.com>
References: <1372930688779-7584028.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1307072134320.8732@reclus.nhh.no>

On Thu, 4 Jul 2013, erwin wrote:

> Hi,
>
> I have to do a spatial model for my master thesis. If I do a SEM or SAR
> model i get the message:
>
> Fehler in solve.default(asyvar, tol = tol.solve) :
>  System ist f?r den Rechner singul?r: reziproke Konditionszahl =
> 3.61856e-20
>
> In other posts i have read that the reason could be multicollinearity. I
> have tested it with vif but all factors were below 2. I have also tried to
> add random numbers like suggested in another post but i got the same error
> message.

Instead of reading posts, which are often just guesses, do please read the 
help page, which says that you may rescale the variables to avoid the 
problem, whoich occurs when the spatial coefficient takes values that 
differ greatly from sigma squared and the other coefficients.

>
> If i do an SAR with another method like "Matrix_J" i get the following error
> message:
>
> Fehler in as_dsTMatrix_listw(get("listw", envir = env)) :
>  odd neighbours sum
>

Your weights appear not to be symmetric, which is a requirement for using 
Cholesky decomposition. This should probably be trapped earlier; the "LU" 
method should work for the same weights.

> So i don't get results at any type of model. I have a 2380*2380 weighting
> matrix could the size be a problem?
>

Not a problem on current hardware.

Hope this helps,

Roger

>
> Thank you very much in advance
>
> erwin
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/SEM-model-system-is-singular-tp7584028.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From amerinoviteri at gmail.com  Mon Jul  8 01:28:28 2013
From: amerinoviteri at gmail.com (Andres Merino-Viteri)
Date: Sun, 7 Jul 2013 18:28:28 -0500
Subject: [R-sig-Geo] alternative for spixdf2kasc from adehabitat package
Message-ID: <CAHRdQt8__Th1v-V1xG8dgpY8rjp+VJeoqEw+TDyWfzqnOioMCw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130707/1040bb8d/attachment.pl>

From adrian.baddeley at uwa.edu.au  Mon Jul  8 12:43:36 2013
From: adrian.baddeley at uwa.edu.au (Adrian Baddeley)
Date: Mon, 8 Jul 2013 18:43:36 +0800
Subject: [R-sig-Geo]  Re: spatstat output
Message-ID: <1CEF56CFF7118748AE0FA6C0186D3A31278BE957@IS-WIN-172.staffad.uwa.edu.au>

Catalin Roibu writes:

   > Is there a possibility to extract only the r, CI's envelope and L function
   > from the output of spatstat?

   > I use this code
   > E <- alltypes(df1, Kest, nsim = 100, envelope = TRUE, ...)

'E' contains the K functions and envelopes computed for points of each type, taken separately.
Do you want to extract the data for one of these types, or all types?

E is a 'fasp' object (representing an array of envelopes) with dimensions p * 1 where p is the number of types.
For example
            K2 <- E[2,1] 
will extract the envelope for the second type of points.
If you plot(K2) you get just this envelope.

To extract the data from this envelope, 
     K2data <- as.data.frame(K2)
this returns a data frame with a column of r values, column of L values, and so on.

 > And second question, is there a possibility to modify the margin of plot in spatstat?
  > plot(E, sqrt(./pi) - r ~ r, ylab = "L(r)-r",main=NULL,sub=NULL,las=1)

See help(plot.fasp).

Yes, the arguments 'sub' and 'las' will be handled (they are passed to plot.default).
However, sub=NULL will not do anything - if you wanted to remove the x axis label 
that should be xlab=""

If you mean that you want to increase the space between the panels in the plot,
use the argument 'mar.panel' described in help(plot.fasp).

A

Prof Adrian Baddeley FAA
University of Western Australia  /and/ CSIRO Mathematics, Informatics & Statistics
Mail: <cet.uwa.edu.au>             Skype: adrian.baddeley

From basille.web at ase-research.org  Mon Jul  8 16:42:46 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Mon, 08 Jul 2013 10:42:46 -0400
Subject: [R-sig-Geo] alternative for spixdf2kasc from adehabitat package
In-Reply-To: <CAHRdQt8__Th1v-V1xG8dgpY8rjp+VJeoqEw+TDyWfzqnOioMCw@mail.gmail.com>
References: <CAHRdQt8__Th1v-V1xG8dgpY8rjp+VJeoqEw+TDyWfzqnOioMCw@mail.gmail.com>
Message-ID: <51DACFE6.50500@ase-research.org>

Ahah, now I understand that I was slightly out of topic when I answered. 
Sorry about that, I should have read more carefully the initial message!

I'm glad you solved it. This said, it looks like a bug in read.asc from 
SDMTools. Did you try to contact the author? Another solution might be to 
convert the file before reading it in R, to see if it makes any difference. 
For instance, it looks like GDAL is able to correctly handle the file. Did 
you try to convert it to another .asc file using gdal_translate? Maybe it 
would correct your problem from the beginning.

Another, more rational, solution would be that the author(s) of SDMTools 
switch to sp or raster maps! But admittedly, this is not an easy one to 
solve for you :)

Hope this helps, this time...
Mathieu.


Le 07/07/2013 07:28 PM, Andres Merino-Viteri a ?crit :
> Thanks Alex and Mathieu for your replies. I am familiar with the new
> packages related to the old adehabitat.
>
> Finally, I solved my problem using rgdal and SDMTools packages as the
> following way:
>
> Veg <- readGDAL("~/Desktop/natur_inter.asc")
> Veg2=raster(Veg)
> blaK <- asc.from.raster(Veg2)
> write.asc(blaK, "~/Desktop/NEW_natur_inter.asc", gz=FALSE)
>
>
>
>
>
> On Sun, Jul 7, 2013 at 10:45 AM, Mathieu Basille <
> basille.web at ase-research.org> wrote:
>
>> Dear Andres,
>>
>> In addition to Alexandre's answers, did you try with the RGDAL package?
>> Something like:
>>
>> veg <- readGDAL("~/Desktop/natur_**inter.asc")
>>
>> This should solve your problem: the asc should be imported as a
>> SpatialPixel object, which can then be used in the new version of
>> adehabitat package, as underlined by Alexandre.
>>
>> Mathieu Basille.
>>
>>
>> Le 07/07/2013 12:46 AM, Alexandre Villers a ?crit :
>>
>>   Hello,
>>>
>>> Look at adehabitatHS package (and other related packages adehabitatHR and
>>> adehabitatLT): there are new functions to take advantage of sp class
>>> objects (such as the ones created when reading a raster with rgdal).
>>> Adehabitat is now "deprecated" and you should use these other packages
>>> instead
>>>
>>> HTH
>>>
>>> Alex
>>>
>>>
>>> 2013/7/7 Andres Merino-Viteri <amerinoviteri at gmail.com>
>>>
>>>   Dear list,
>>>>
>>>> Sometimes I have problems opening ASCII files  with read.asc function
>>>> from
>>>> SDMTools package.
>>>>
>>>> The error message is like  the following one:
>>>>
>>>>   Veg=read.asc("~/Desktop/natur_**inter.asc")
>>>>>
>>>> Error in if ((yll[[1]][1] == "yllcenter") | (xll[[1]][1] ==
>>>> "YLLCENTER")) {
>>>> :
>>>>     missing value where TRUE/FALSE needed
>>>> In addition: Warning message:
>>>> In read.asc("~/Desktop/natur_**inter.asc") : NAs introduced by coercion
>>>>
>>>> Looking at different forums I found the following solution to this
>>>> problem:
>>>>
>>>> library("rgdal")
>>>> library("adehabitat")
>>>> B1=readGDAL("~/Desktop/natur_**inter.asc")
>>>> blaK <- spixdf2kasc(B1)
>>>> write.asc(blaK, "~/Desktop/NEW_natur_inter.**asc", gz=FALSE)
>>>>
>>>> It used to solve my problem. The NEW .asc file did not display any error
>>>> message when read with the read.asc function.
>>>>
>>>> However, since I updated to R 2.15.2 GUI 1.53 Leopard build 32-bit
>>>> (6335),
>>>> I can not use adehabitat package anymore, and I have not been able to
>>>> find
>>>> the "spixdf2kasc" function in the new adehabitat family packages. Now, I
>>>> am
>>>> not able to use new .asc files provided to me.
>>>>
>>>> Does anyone have an alternative solution for  the read.asc error? or an
>>>> alternative for using "spixdf2kasc" function?
>>>>
>>>> Any help would be very appreciated. Thanks.
>>>>
>>>> Andres
>>>>
>>>> Additional infor about my R version:
>>>> R version 2.15.2 (2012-10-26) -- "Trick or Treat"
>>>> Copyright (C) 2012 The R Foundation for Statistical Computing
>>>> ISBN 3-900051-07-0
>>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>>
>>>> My computer:
>>>> MacBook 2GHz Intel Core 2 Duo
>>>> MAC OS X Version 10.6.8
>>>>
>>>>           [[alternative HTML version deleted]]
>>>>
>>>> ______________________________**_________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>
>>>>
>>>
>>>
>>>
>> --
>>
>> ~$ whoami
>> Mathieu Basille, PhD
>>
>> ~$ locate --details
>> University of Florida \\
>> Fort Lauderdale Research and Education Center
>> (+1) 954-577-6314
>> http://ase-research.org/**basille <http://ase-research.org/basille>
>>
>> ~$ fortune
>> ? Le tout est de tout dire, et je manque de mots
>> Et je manque de temps, et je manque d'audace. ?
>>   -- Paul ?luard
>>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From ROONEYJ4 at tcd.ie  Mon Jul  8 16:59:53 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 8 Jul 2013 15:59:53 +0100
Subject: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly
Message-ID: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>

Hi all, 

I am trying to setup a geospatial CAR model to implement areal spatial smoothing (similar to Fig11.11 in "Applied Spatial Data Analysis with R" except without the beta term). 
I am using ESRI shapfiles downloaded from Census Ireland (http://www.cso.ie/en/census/census2011boundaryfiles/)
As some of the boundaries have changed over various census years, I need to join certain polygons - note these are adjacent polygons and I have used unionSpatial Polygons to try to do this. I am using a join_list of polygons that have changed and are to be joined - this is just a CSV file I made myself. The problem I am having is that my code is not joining the correct polygons and is in fact joining non-adjacent unrelated polygons. I can't figure out how to fix this.

My code looks like this: (FYI - EDdata contains a unique code for each polygon in a factor variable called GEOGID).

EDdata<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
names(EDdata)
join_list<- read.csv("joins.csv", header=TRUE)

ED2<-merge(EDdata,join_list,by="GEOGID",all=TRUE)

# modify copied geogids as per join list
ED2$GEO<-as.character(ED2$GEOGID)
ED2$GEO[!is.na(ED2$Joined)]<-as.character(ED2$Joined[!is.na(ED2$Joined)])
ED2$GEOGID2<-as.factor(ED2$GEO)

# apply join function to polygons
EDdata$GEOGID2<-ED2$GEOGID2
EDpoly_joined <- unionSpatialPolygons(EDdata, EDdata$GEOGID2)


When I plot specific joined polygons they are not the adjacent ones I intended to join. As far as I can see - GEOGID and GEOGID2 match each other so I am a loss as to why the unionSpatialPolygons function appears to join to incorrect polygons.

FYI the join list looks like this (its longer than this but this should give you an idea).

                               Joined            variable       GEOGID
E01001                   E01001/01019     Sub1       E01001
E10001                         E10001         Sub1       E10001
E10004                         E10004         Sub1       E10004
E11001                   E11001/11026     Sub1       E11001
E11002                   E11002/11055     Sub1       E11002
E11003                   E11003/11092     Sub1       E11003



I cannot see where I am going wrong -I'd be very grateful for any assistance/advice.

Many thanks,

James

From Roger.Bivand at nhh.no  Mon Jul  8 17:35:13 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 8 Jul 2013 17:35:13 +0200
Subject: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>
Message-ID: <alpine.LRH.2.03.1307081724170.15070@reclus.nhh.no>

On Mon, 8 Jul 2013, James Rooney wrote:

> Hi all,
>
> I am trying to setup a geospatial CAR model to implement areal spatial smoothing (similar to Fig11.11 in "Applied Spatial Data Analysis with R" except without the beta term).
> I am using ESRI shapfiles downloaded from Census Ireland (http://www.cso.ie/en/census/census2011boundaryfiles/)
> As some of the boundaries have changed over various census years, I need to join certain polygons - note these are adjacent polygons and I have used unionSpatial Polygons to try to do this. I am using a join_list of polygons that have changed and are to be joined - this is just a CSV file I made myself. The problem I am having is that my code is not joining the correct polygons and is in fact joining non-adjacent unrelated polygons. I can't figure out how to fix this.
>
> My code looks like this: (FYI - EDdata contains a unique code for each polygon in a factor variable called GEOGID).
>
> EDdata<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
> names(EDdata)
> join_list<- read.csv("joins.csv", header=TRUE)
>
> ED2<-merge(EDdata,join_list,by="GEOGID",all=TRUE)

What is merge() - which package? If you mean the merge method in sp, it is 
not intended for joining geometries, nor I think is the earlier method in 
raster.

The standard approach since forever is unionSpatialPolygons() in maptools, 
or eqivalently gUnaryUnion() in rgeos. Unless this merge() function is 
making strong assumptions, it will mess up the aggregation of multiple 
observed values from the joined/unioned Polygons objects. There have been 
multiple threads on this list on the use of gUnaryUnion().

Hope this clarifies,

Roger

>
> # modify copied geogids as per join list
> ED2$GEO<-as.character(ED2$GEOGID)
> ED2$GEO[!is.na(ED2$Joined)]<-as.character(ED2$Joined[!is.na(ED2$Joined)])
> ED2$GEOGID2<-as.factor(ED2$GEO)
>
> # apply join function to polygons
> EDdata$GEOGID2<-ED2$GEOGID2
> EDpoly_joined <- unionSpatialPolygons(EDdata, EDdata$GEOGID2)
>
>
> When I plot specific joined polygons they are not the adjacent ones I intended to join. As far as I can see - GEOGID and GEOGID2 match each other so I am a loss as to why the unionSpatialPolygons function appears to join to incorrect polygons.
>
> FYI the join list looks like this (its longer than this but this should give you an idea).
>
>                               Joined            variable       GEOGID
> E01001                   E01001/01019     Sub1       E01001
> E10001                         E10001         Sub1       E10001
> E10004                         E10004         Sub1       E10004
> E11001                   E11001/11026     Sub1       E11001
> E11002                   E11002/11055     Sub1       E11002
> E11003                   E11003/11092     Sub1       E11003
>
>
>
> I cannot see where I am going wrong -I'd be very grateful for any assistance/advice.
>
> Many thanks,
>
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Jul  8 17:46:27 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 8 Jul 2013 17:46:27 +0200
Subject: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly
In-Reply-To: <alpine.LRH.2.03.1307081724170.15070@reclus.nhh.no>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>
	<alpine.LRH.2.03.1307081724170.15070@reclus.nhh.no>
Message-ID: <alpine.LRH.2.03.1307081739590.15070@reclus.nhh.no>

On Mon, 8 Jul 2013, Roger Bivand wrote:

> On Mon, 8 Jul 2013, James Rooney wrote:
>
>> Hi all,
>> 
>> I am trying to setup a geospatial CAR model to implement areal spatial 
>> smoothing (similar to Fig11.11 in "Applied Spatial Data Analysis with R" 
>> except without the beta term).
>> I am using ESRI shapfiles downloaded from Census Ireland 
>> (http://www.cso.ie/en/census/census2011boundaryfiles/)
>> As some of the boundaries have changed over various census years, I need to 
>> join certain polygons - note these are adjacent polygons and I have used 
>> unionSpatial Polygons to try to do this. I am using a join_list of polygons 
>> that have changed and are to be joined - this is just a CSV file I made 
>> myself. The problem I am having is that my code is not joining the correct 
>> polygons and is in fact joining non-adjacent unrelated polygons. I can't 
>> figure out how to fix this.
>> 
>> My code looks like this: (FYI - EDdata contains a unique code for each 
>> polygon in a factor variable called GEOGID).
>> 
>> EDdata<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
>> names(EDdata)
>> join_list<- read.csv("joins.csv", header=TRUE)
>> 
>> ED2<-merge(EDdata,join_list,by="GEOGID",all=TRUE)

OK. Don't do this, use the maptools spCbind() method after first having 
set the row.names of EDdata and join_list (which is a data.frame object). 
They are almost certainly not in the right order. Check the order with 
match(), and if necessary change the order of join_list to match exactly.

>
> What is merge() - which package? If you mean the merge method in sp, it is 
> not intended for joining geometries, nor I think is the earlier method in 
> raster.
>
> The standard approach since forever is unionSpatialPolygons() in maptools, or 
> eqivalently gUnaryUnion() in rgeos. Unless this merge() function is making 
> strong assumptions, it will mess up the aggregation of multiple observed 
> values from the joined/unioned Polygons objects. There have been multiple 
> threads on this list on the use of gUnaryUnion().
>
> Hope this clarifies,
>
> Roger
>
>> 
>> # modify copied geogids as per join list
>> ED2$GEO<-as.character(ED2$GEOGID)
>> ED2$GEO[!is.na(ED2$Joined)]<-as.character(ED2$Joined[!is.na(ED2$Joined)])
>> ED2$GEOGID2<-as.factor(ED2$GEO)
>> 
>> # apply join function to polygons
>> EDdata$GEOGID2<-ED2$GEOGID2
>> EDpoly_joined <- unionSpatialPolygons(EDdata, EDdata$GEOGID2)
>>

At this point EDdata$GEOGID2 is a factor, and is in the wrong order. If 
you use row.names() to set and retreive the character versions, it will be 
easier. Maybe the new vignette in maptools (two sections of ch. 5 in the 
book you refer to) would help, or since you have the book, you could read 
the sections there.

Roger

>> 
>> When I plot specific joined polygons they are not the adjacent ones I 
>> intended to join. As far as I can see - GEOGID and GEOGID2 match each other 
>> so I am a loss as to why the unionSpatialPolygons function appears to join 
>> to incorrect polygons.
>> 
>> FYI the join list looks like this (its longer than this but this should 
>> give you an idea).
>>
>>                               Joined            variable       GEOGID
>> E01001                   E01001/01019     Sub1       E01001
>> E10001                         E10001         Sub1       E10001
>> E10004                         E10004         Sub1       E10004
>> E11001                   E11001/11026     Sub1       E11001
>> E11002                   E11002/11055     Sub1       E11002
>> E11003                   E11003/11092     Sub1       E11003
>> 
>> 
>> 
>> I cannot see where I am going wrong -I'd be very grateful for any 
>> assistance/advice.
>> 
>> Many thanks,
>> 
>> James
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From 538280 at gmail.com  Mon Jul  8 17:53:58 2013
From: 538280 at gmail.com (Greg Snow)
Date: Mon, 8 Jul 2013 09:53:58 -0600
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
Message-ID: <CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130708/32945197/attachment.pl>

From ROONEYJ4 at tcd.ie  Mon Jul  8 18:11:04 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 8 Jul 2013 17:11:04 +0100
Subject: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly
In-Reply-To: <alpine.LRH.2.03.1307081739590.15070@reclus.nhh.no>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>
	<alpine.LRH.2.03.1307081724170.15070@reclus.nhh.no>,
	<alpine.LRH.2.03.1307081739590.15070@reclus.nhh.no>
Message-ID: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB7@GOMAIL.college.tcd.ie>


Thanks Roger - I will take a look at chapter 5 and spCbind(). I figured I was scarmbling the order somewhere along the way but could not figure where exactly.
Many thanks for your help.

James

________________________________________
From: Roger Bivand [Roger.Bivand at nhh.no]
Sent: 08 July 2013 16:46
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly

On Mon, 8 Jul 2013, Roger Bivand wrote:

> On Mon, 8 Jul 2013, James Rooney wrote:
>
>> Hi all,
>>
>> I am trying to setup a geospatial CAR model to implement areal spatial
>> smoothing (similar to Fig11.11 in "Applied Spatial Data Analysis with R"
>> except without the beta term).
>> I am using ESRI shapfiles downloaded from Census Ireland
>> (http://www.cso.ie/en/census/census2011boundaryfiles/)
>> As some of the boundaries have changed over various census years, I need to
>> join certain polygons - note these are adjacent polygons and I have used
>> unionSpatial Polygons to try to do this. I am using a join_list of polygons
>> that have changed and are to be joined - this is just a CSV file I made
>> myself. The problem I am having is that my code is not joining the correct
>> polygons and is in fact joining non-adjacent unrelated polygons. I can't
>> figure out how to fix this.
>>
>> My code looks like this: (FYI - EDdata contains a unique code for each
>> polygon in a factor variable called GEOGID).
>>
>> EDdata<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
>> names(EDdata)
>> join_list<- read.csv("joins.csv", header=TRUE)
>>
>> ED2<-merge(EDdata,join_list,by="GEOGID",all=TRUE)

OK. Don't do this, use the maptools spCbind() method after first having
set the row.names of EDdata and join_list (which is a data.frame object).
They are almost certainly not in the right order. Check the order with
match(), and if necessary change the order of join_list to match exactly.

>
> What is merge() - which package? If you mean the merge method in sp, it is
> not intended for joining geometries, nor I think is the earlier method in
> raster.
>
> The standard approach since forever is unionSpatialPolygons() in maptools, or
> eqivalently gUnaryUnion() in rgeos. Unless this merge() function is making
> strong assumptions, it will mess up the aggregation of multiple observed
> values from the joined/unioned Polygons objects. There have been multiple
> threads on this list on the use of gUnaryUnion().
>
> Hope this clarifies,
>
> Roger
>
>>
>> # modify copied geogids as per join list
>> ED2$GEO<-as.character(ED2$GEOGID)
>> ED2$GEO[!is.na(ED2$Joined)]<-as.character(ED2$Joined[!is.na(ED2$Joined)])
>> ED2$GEOGID2<-as.factor(ED2$GEO)
>>
>> # apply join function to polygons
>> EDdata$GEOGID2<-ED2$GEOGID2
>> EDpoly_joined <- unionSpatialPolygons(EDdata, EDdata$GEOGID2)
>>

At this point EDdata$GEOGID2 is a factor, and is in the wrong order. If
you use row.names() to set and retreive the character versions, it will be
easier. Maybe the new vignette in maptools (two sections of ch. 5 in the
book you refer to) would help, or since you have the book, you could read
the sections there.

Roger

>>
>> When I plot specific joined polygons they are not the adjacent ones I
>> intended to join. As far as I can see - GEOGID and GEOGID2 match each other
>> so I am a loss as to why the unionSpatialPolygons function appears to join
>> to incorrect polygons.
>>
>> FYI the join list looks like this (its longer than this but this should
>> give you an idea).
>>
>>                               Joined            variable       GEOGID
>> E01001                   E01001/01019     Sub1       E01001
>> E10001                         E10001         Sub1       E10001
>> E10004                         E10004         Sub1       E10004
>> E11001                   E11001/11026     Sub1       E11001
>> E11002                   E11002/11055     Sub1       E11002
>> E11003                   E11003/11092     Sub1       E11003
>>
>>
>>
>> I cannot see where I am going wrong -I'd be very grateful for any
>> assistance/advice.
>>
>> Many thanks,
>>
>> James
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From paolo.piras at uniroma3.it  Mon Jul  8 18:49:34 2013
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Mon, 8 Jul 2013 16:49:34 +0000
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>,
	<CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
Message-ID: <A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130708/7e14b017/attachment.pl>

From ROONEYJ4 at tcd.ie  Mon Jul  8 20:08:35 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 8 Jul 2013 19:08:35 +0100
Subject: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB7@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB1@GOMAIL.college.tcd.ie>
	<alpine.LRH.2.03.1307081724170.15070@reclus.nhh.no>,
	<alpine.LRH.2.03.1307081739590.15070@reclus.nhh.no>,
	<75C8D19A1470D344A8AF5312F01160A6028545C7EAB7@GOMAIL.college.tcd.ie>
Message-ID: <75C8D19A1470D344A8AF5312F01160A6028545C7EAB8@GOMAIL.college.tcd.ie>


Ok so I was not able to figure out how to use the matching and spCbind command. I seem to have some mental block on this. I studied book the example in ch 5 of the book and the example in the R help file and I just do not get how the row matching is happening.

Instead I did the following:

# fill in blank rows in join_list
EDs<-data.frame(EDdata[,11:12])
EDs<-merge(EDs,join_list,by="GEOGID",all=TRUE)
EDs$GEO2<-as.character(EDs$GEOGID)
EDs$GEO2[!is.na(EDs$Joined)]<-as.character(EDs$Joined[!is.na(EDs$Joined)])
EDs$GEO2<-as.factor(EDs$GEO2)
# match and join new EDs to spatial dataset
EDdata at data=data.frame(EDdata at data, EDs[match(EDdata at data$GEOGID, EDs$GEOGID),])  (from here: http://stackoverflow.com/questions/13135413/r-spcbind-error)

I was then able to use unionSpatialPolygons and it seems to have worked correctly - the plot of poly2nb looks as it should - and individual joined areas I've plotted look perfect.

Thank you very much Roger for your help!

James


________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
Sent: 08 July 2013 17:11
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly

Thanks Roger - I will take a look at chapter 5 and spCbind(). I figured I was scarmbling the order somewhere along the way but could not figure where exactly.
Many thanks for your help.

James

________________________________________
From: Roger Bivand [Roger.Bivand at nhh.no]
Sent: 08 July 2013 16:46
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Problem with poly2nb after unionSpatialPoly

On Mon, 8 Jul 2013, Roger Bivand wrote:

> On Mon, 8 Jul 2013, James Rooney wrote:
>
>> Hi all,
>>
>> I am trying to setup a geospatial CAR model to implement areal spatial
>> smoothing (similar to Fig11.11 in "Applied Spatial Data Analysis with R"
>> except without the beta term).
>> I am using ESRI shapfiles downloaded from Census Ireland
>> (http://www.cso.ie/en/census/census2011boundaryfiles/)
>> As some of the boundaries have changed over various census years, I need to
>> join certain polygons - note these are adjacent polygons and I have used
>> unionSpatial Polygons to try to do this. I am using a join_list of polygons
>> that have changed and are to be joined - this is just a CSV file I made
>> myself. The problem I am having is that my code is not joining the correct
>> polygons and is in fact joining non-adjacent unrelated polygons. I can't
>> figure out how to fix this.
>>
>> My code looks like this: (FYI - EDdata contains a unique code for each
>> polygon in a factor variable called GEOGID).
>>
>> EDdata<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
>> names(EDdata)
>> join_list<- read.csv("joins.csv", header=TRUE)
>>
>> ED2<-merge(EDdata,join_list,by="GEOGID",all=TRUE)

OK. Don't do this, use the maptools spCbind() method after first having
set the row.names of EDdata and join_list (which is a data.frame object).
They are almost certainly not in the right order. Check the order with
match(), and if necessary change the order of join_list to match exactly.

>
> What is merge() - which package? If you mean the merge method in sp, it is
> not intended for joining geometries, nor I think is the earlier method in
> raster.
>
> The standard approach since forever is unionSpatialPolygons() in maptools, or
> eqivalently gUnaryUnion() in rgeos. Unless this merge() function is making
> strong assumptions, it will mess up the aggregation of multiple observed
> values from the joined/unioned Polygons objects. There have been multiple
> threads on this list on the use of gUnaryUnion().
>
> Hope this clarifies,
>
> Roger
>
>>
>> # modify copied geogids as per join list
>> ED2$GEO<-as.character(ED2$GEOGID)
>> ED2$GEO[!is.na(ED2$Joined)]<-as.character(ED2$Joined[!is.na(ED2$Joined)])
>> ED2$GEOGID2<-as.factor(ED2$GEO)
>>
>> # apply join function to polygons
>> EDdata$GEOGID2<-ED2$GEOGID2
>> EDpoly_joined <- unionSpatialPolygons(EDdata, EDdata$GEOGID2)
>>

At this point EDdata$GEOGID2 is a factor, and is in the wrong order. If
you use row.names() to set and retreive the character versions, it will be
easier. Maybe the new vignette in maptools (two sections of ch. 5 in the
book you refer to) would help, or since you have the book, you could read
the sections there.

Roger

>>
>> When I plot specific joined polygons they are not the adjacent ones I
>> intended to join. As far as I can see - GEOGID and GEOGID2 match each other
>> so I am a loss as to why the unionSpatialPolygons function appears to join
>> to incorrect polygons.
>>
>> FYI the join list looks like this (its longer than this but this should
>> give you an idea).
>>
>>                               Joined            variable       GEOGID
>> E01001                   E01001/01019     Sub1       E01001
>> E10001                         E10001         Sub1       E10001
>> E10004                         E10004         Sub1       E10004
>> E11001                   E11001/11026     Sub1       E11001
>> E11002                   E11002/11055     Sub1       E11002
>> E11003                   E11003/11092     Sub1       E11003
>>
>>
>>
>> I cannot see where I am going wrong -I'd be very grateful for any
>> assistance/advice.
>>
>> Many thanks,
>>
>> James
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From fvbersse at gmail.com  Tue Jul  9 03:00:16 2013
From: fvbersse at gmail.com (Ferdinand Bersse)
Date: Mon, 8 Jul 2013 21:00:16 -0400
Subject: [R-sig-Geo] Error when installing rgeos
In-Reply-To: <CAAVnHstC3j1heae=zDUJFWxnogdapyr2WJLFDYqbsxi8JO8yWg@mail.gmail.com>
References: <CA+nXtYbM9rf+XGux_oaJpSCZ3v7WHm4JjwMRuGfZp+SqkwsMOw@mail.gmail.com>
	<CAAVnHstC3j1heae=zDUJFWxnogdapyr2WJLFDYqbsxi8JO8yWg@mail.gmail.com>
Message-ID: <CA+nXtYbdGA652pLxyqywU6u7jAruCKtoVmtWywOB6zPQ-+Jqyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130708/fb6cb153/attachment.pl>

From fvbersse at gmail.com  Tue Jul  9 03:36:31 2013
From: fvbersse at gmail.com (Ferdinand Bersse)
Date: Mon, 8 Jul 2013 21:36:31 -0400
Subject: [R-sig-Geo] Using gDistance under Linux causes R crash.
Message-ID: <CA+nXtYZbHjNemcdoO-0vMTR4+EXDE9E3EWmE_U7Ws6qOpzP=Vg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130708/78b2dfd6/attachment.pl>

From Roger.Bivand at nhh.no  Tue Jul  9 07:57:12 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 9 Jul 2013 07:57:12 +0200
Subject: [R-sig-Geo] Using gDistance under Linux causes R crash.
In-Reply-To: <CA+nXtYZbHjNemcdoO-0vMTR4+EXDE9E3EWmE_U7Ws6qOpzP=Vg@mail.gmail.com>
References: <CA+nXtYZbHjNemcdoO-0vMTR4+EXDE9E3EWmE_U7Ws6qOpzP=Vg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307090752270.17437@reclus.nhh.no>

On Tue, 9 Jul 2013, Ferdinand Bersse wrote:

> Dears,
>
> I've been trying to use gDistance from rgeos package to generate a distance
> matrix between all features of a shp file, i.e. using gDistance(shpfile,
> shpfile, byid=TRUE) in R 2.15 and it always makes R to crash.

You should always provide a reproducible example of claims of crashing R. 
There is no way anyone can advise you if you do not do this, because 
guesswork is no help. Please also see the posting guide for definitions of 
crash - a crash is only when R exits to the shell. You will have to remove 
the possibility that rgeos and GEOS are wrongly installed, first by 
removing the rpm (I doubt that geos-devel is sufficient) and installing 
GEOS from source. Then you must show how your read the shapefile (use 
rgdal only), and it will be best if you show your code in relation to a 
small shapefile that is available.

Roger

>
> I am using a Red Hat server with R 2.15 (can not change R version now in
> the server).
>
> Any insights about what may be going on or any other option that calculates
> distances from border to border of spatial features (not from centroids to
> centroids)?
>
> Many thanks!
>
> Ferd.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From carotenuto_francesco at yahoo.it  Tue Jul  9 11:35:42 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Tue, 9 Jul 2013 10:35:42 +0100 (BST)
Subject: [R-sig-Geo] Regression kriging or kriging with external drift
In-Reply-To: <1372574042.54540.BPMail_high_noncarrier@web133003.mail.ir2.yahoo.com>
References: <1372574042.54540.BPMail_high_noncarrier@web133003.mail.ir2.yahoo.com>
Message-ID: <1373362542.19613.YahooMailNeo@web133006.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/69f56314/attachment.pl>

From ROONEYJ4 at tcd.ie  Tue Jul  9 11:46:18 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Tue, 9 Jul 2013 10:46:18 +0100
Subject: [R-sig-Geo] R2WinBugs - getting TRAP errors in Winbugs
Message-ID: <75C8D19A1470D344A8AF5312F01160A6028545C7EABA@GOMAIL.college.tcd.ie>

Hi all,

I am trying to implement the WinBUGS spatial conditional autoregression model on page 11.11 of Applied Spatial Data Analysis in R. I have about 3300 polygons with about 17,000 adjacencies in the set.
I have changed the model only by removing the beta term as, for now, I don't have any variables to include - I want simply to do a spatially smoothed model with no covariates.

Anyhow the code runs fine under R - but I am constantly getting a Trap Error in Winbugs - Index out of range.
My BUGs code looks like this:
model
{

  for(i in 1:N)
  {
    observed[i]~dpois(mu[i])    
    log(theta[i])<-alpha + u[i] + v[i]
    mu[i]<-expected[i]*theta[i]
    u[i] ~dnorm(0,precu)
  }

v[1:N]~car.normal(adj[],weights[],num[],precv)

  alpha ~dflat()
  precu ~dgamma (0.001, 0.001) 
  precv ~dgamma (0.001, 0.001)

}

and my R code like this - (I've deliberately kept the iterations low in trying to figure out the problem but I get the error even within 1000 iterations).

nb<-poly2nb(EDdata2,queen=T)
nb.w<-nb2listw(nb,zero.policy=T,style="B")
nbBugs<-listw2WB(nb.w)

BugsDir<-"C:/Program Files/WinBUGS14/"
N<-length(EDdata2$nm_tt_c)
d<-list(N = N, observed =EDdata2$nm_tt_c, expected = EDdata2$tot_exp, adj=nbBugs$adj, weights=nbBugs$weights, num=nbBugs$num)
inits<-list(list(u=rep(0,N),v=rep(0,N),alpha=0,precu=0.001,precv=0.001))

MCMCres<-bugs(data=d,inits=inits,bugs.directory=BugsDir,parameters.to.save=c("theta","alpha"),n.chains=1,n.iter=1000,n.burnin=500,n.thin=1, model.file="ALS_spatial_CAR.txt")


I don't know if WinBUGS falls under the remit here ?? But was hoping someone might have some idea whats causing my TRAP errors as I am at a loss.

Many thanks all,
James

From edzer.pebesma at uni-muenster.de  Tue Jul  9 11:52:46 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 09 Jul 2013 11:52:46 +0200
Subject: [R-sig-Geo] Regression kriging or kriging with external drift
In-Reply-To: <1373362542.19613.YahooMailNeo@web133006.mail.ir2.yahoo.com>
References: <1372574042.54540.BPMail_high_noncarrier@web133003.mail.ir2.yahoo.com>
	<1373362542.19613.YahooMailNeo@web133006.mail.ir2.yahoo.com>
Message-ID: <51DBDD6E.8010307@uni-muenster.de>

Most of the methods in intamap don't support this; IIRC, if any of the
methods do, it will be automap, and you could as well use
automap::autoKrige directly.

On 07/09/2013 11:35 AM, Francesco Carotenuto wrote:
> Any suggestions?
> 
> 
> ________________________________
> 
> A: r-sig-geo at r-project.org 
> Inviato: Domenica 30 Giugno 2013 8:34
> Oggetto: Regression kriging or kriging with external drift
> 
> 
> 
> Hi to all. Is there a way to perform regression kriging (kriging with external drift) by using the intamap package? If yes, how to set the covariate? Thanks.
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From jon.skoien at jrc.ec.europa.eu  Tue Jul  9 14:30:45 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Tue, 09 Jul 2013 14:30:45 +0200
Subject: [R-sig-Geo] Regression kriging or kriging with external drift
In-Reply-To: <51DBDD6E.8010307@uni-muenster.de>
References: <1372574042.54540.BPMail_high_noncarrier@web133003.mail.ir2.yahoo.com>
	<1373362542.19613.YahooMailNeo@web133006.mail.ir2.yahoo.com>
	<51DBDD6E.8010307@uni-muenster.de>
Message-ID: <51DC0275.7070500@jrc.ec.europa.eu>

Edzer is right, the only important method that supports covariates in 
the intamap package is automap (the other ones are linearVariogram and 
idw). You can set the covariate in the optList-argument to interpolate:
x = interpolate(meuse, meuse.grid, optList = list(formulaString = "zinc 
~ dist"), methodName = "automap")

Cheers,
Jon

On 09-Jul-13 11:52, Edzer Pebesma wrote:
> Most of the methods in intamap don't support this; IIRC, if any of the
> methods do, it will be automap, and you could as well use
> automap::autoKrige directly.
>
> On 07/09/2013 11:35 AM, Francesco Carotenuto wrote:
>> Any suggestions?
>>
>>
>> ________________________________
>>
>> A: r-sig-geo at r-project.org
>> Inviato: Domenica 30 Giugno 2013 8:34
>> Oggetto: Regression kriging or kriging with external drift
>>
>>
>>
>> Hi to all. Is there a way to perform regression kriging (kriging with external drift) by using the intamap package? If yes, how to set the covariate? Thanks.
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From thomas.aubineau.gds35 at reseaugds.com  Tue Jul  9 15:16:15 2013
From: thomas.aubineau.gds35 at reseaugds.com (Thomas AUBINEAU)
Date: Tue, 9 Jul 2013 15:16:15 +0200
Subject: [R-sig-Geo] Connection
Message-ID: <005b01ce7ca6$7dbbd440$79337cc0$@aubineau.gds35@reseaugds.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/3901b3d7/attachment.pl>

From roman.lustrik at gmail.com  Tue Jul  9 15:20:44 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 9 Jul 2013 15:20:44 +0200
Subject: [R-sig-Geo] Connection
In-Reply-To: <51dc0c21.0a0acd0a.6831.6f99SMTPIN_ADDED_BROKEN@mx.google.com>
References: <51dc0c21.0a0acd0a.6831.6f99SMTPIN_ADDED_BROKEN@mx.google.com>
Message-ID: <CAHT1vpihGCmrp82CFsOhCsPy9zZC7_6mGa-90edWRVWOtSMyuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/8a7dcc9f/attachment.pl>

From thomas.aubineau.gds35 at reseaugds.com  Tue Jul  9 17:01:01 2013
From: thomas.aubineau.gds35 at reseaugds.com (Thomas AUBINEAU)
Date: Tue, 9 Jul 2013 17:01:01 +0200
Subject: [R-sig-Geo] sapply function
Message-ID: <000501ce7cb5$20aac3b0$62004b10$@aubineau.gds35@reseaugds.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/efb6922e/attachment.pl>

From HodgessE at uhd.edu  Tue Jul  9 17:30:03 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 9 Jul 2013 15:30:03 +0000
Subject: [R-sig-Geo] sapply function
In-Reply-To: <000501ce7cb5$20aac3b0$62004b10$@aubineau.gds35@reseaugds.com>
References: <000501ce7cb5$20aac3b0$62004b10$@aubineau.gds35@reseaugds.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A14BC5@columbia.uhd.campus>

Hi!

Did you have a "return" after the quotes for coords, please?  R doesn't like to have the quotes separately.



lns <- slot(auck_shore, "lines")
table(sapply(lns, function(x) length(slot(x, "Lines"))))
islands_auck <- sapply(lns, function(x) {
  crds <- slot(slot(x, "Lines")[[1]], "coords")
  identical(crds[1,], crds[nrow(crds),])
})
table(islands_auck)

Hope this helps!

Sincerely,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Thomas AUBINEAU [thomas.aubineau.gds35 at reseaugds.com]
Sent: Tuesday, July 09, 2013 10:01 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] sapply function

Hello,

I've still a problem with script written in ASDAR book, and more precisely
with sapply function, as you can see in the script below. I've try to
decompose the script in several sentences, but it doesn't work (I think I
don't understand what is written in the whole sentence).

Someone can help me?



Sincerely.





lns<-slot(auck_shore,"lines")

> aucksap<-sapply(lns,length)

> table(aucksap)

aucksap

 1

80

>
islands_auck<-sapply(lns,function(x){crds<-slot(slot(x,"Lines")[[1]],"coords
")identical(crds[1,],crds[nrow(crds),])})

Error: unexpected symbol in
"islands_auck<-sapply(lns,function(x){crds<-slot(slot(x,"Lines")[[1]],"coord
s")identical"







Thomas AUBINEAU

Responsable technique GDS 35

ZA Atalante Champeaux

35042 RENNES CEDEX

0223482600 / 0623258789




        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From basille.web at ase-research.org  Tue Jul  9 20:27:43 2013
From: basille.web at ase-research.org (Mathieu Basille)
Date: Tue, 09 Jul 2013 14:27:43 -0400
Subject: [R-sig-Geo] problem in producing a HSM on different sites
In-Reply-To: <51D67FD4.7080902@isprambiente.it>
References: <51D67FD4.7080902@isprambiente.it>
Message-ID: <51DC561F.7070701@ase-research.org>

Dear Michela,

What you are trying to achieve is not trivial, both from a technical and a 
biological point of view. From a technical point of view, this is really a 
'sp' issue, and not a 'adehabitatHS' one. The question is to know whether a 
SpatialPixelsDataFrame can accept non-contiguous areas. The answer is 
probably yes, using a single raster merging all three areas, and the rest 
filled in by NAs. This is probably something you can do using R spatial 
tools, but I cannot help here.

Second, from a biological point of view, it is not clear what you want to 
do. Using a single MADIFA for all three areas would imply that they are 
part of the same population, with the same rules that apply to them. In 
other words, each site is a sample from the whole population. If it is not 
the case, you might as well use three independent MADIFAs, each on a 
different study area. In this case, if you're interested into a single 
habitat suitability map, I would then suggest to merge individual MADIFA 
predictions into a single map. Since the MADIFA predicts (approximate) 
Mahalanobis distances, they should be comparable to each other (and could 
thus be merged together).

If you consider your three areas as three distinct populations, you might 
consider the OMI, for which I already gave you the reference.

Now, I would really advise you to think thoroughly about your problem, 
which is not a simple one, and try to understand precisely the aims of each 
approach. A good starting point is:

vignette("adehabitatHS")

Hope this helps,
Mathieu Basille.


Le 07/05/2013 04:12 AM, Michela Giusti a ?crit :
> Hello again R-users,
>
> I didn't receive any answer regarding my last post on HSM. I think my
> question was not clear.. (sorry..). I try again to explain my problem:
>
> so.. I have 3 different sites along the Mediterranean Sea with different
> extents, coordinates,....on which I performed a MADIFA analysis.
>
>
> Now, I want to produce a final HSM on these 3 sites using the MADIFA
> results. My problem is in "map" in the line command :
>
> pred <- predict(mad, map,..)
>
> I don't know how to prepare a total "map" with my 3 different
> SpatialPixelsDataFrame (how to merge, aggregate, mosaic....them together?)
>
> Below I report my MADIFA results and the structure of my 3 SPDFs:
>
>
> MADIFA
>
> $call: madifa(dudi = pc_mad, pr = pr_mad, scannf = FALSE, nf = 7)
>
> eigen values: 15.58 3.255 0.9557 0.6351 0.2338 ...
>
> $nf: 7 axes saved
>
> vectorlength modecontent
>
> 1 $pr418353 numeric vector of presence
>
> 2 $mahasu 418353 numeric squared Mahalanobis distances
>
> 3 $lw418353 numeric row weights
>
> 4 $cw418353 numeric column weights
>
> 5 $eig8numeric eigen values
>
> data.frame nrowncol content
>
> 1 $tab418353 8modified array
>
> 2 $li418353 7row coordinates
>
> 3 $l1418353 7row normed scores (variance weighted by $pr = 1)
>
> 4 $co87column coordinates
>
> 5 $cor87cor(habitat var., scores) for available points
>
>
>
>> str(SPDF_tuna_norm)
>
> Formal class 'SpatialPixelsDataFrame' [package "sp"] with 7 slots
>
> ..@ data:'data.frame':349272 obs. of8 variables:
>
> .. ..$ aspect: num [1:349272] 1.298 0.583 0.553 1.457 0.627 ...
>
> .. ..$ BPI: num [1:349272] 0.0684 0.0331 0.0251 0.0147 -0.0371 ...
>
> .. ..$ curvature: num [1:349272] 0 -0.0341 -0.001 0.0389 -0.0656 ...
>
> .. ..$ plan.curvature: num [1:349272] 0 -0.0239 -0.0008 0.0005 -0.0434 ...
>
> .. ..$ profile.curvature: num [1:349272] 0 -0.0104 -0.0003 0.0385 -0.023 ...
>
> .. ..$ depth: num [1:349272] -97.4 -97.5 -97.6 -97.6 -97.7 ...
>
> .. ..$ slope: num [1:349272] 0.0871 0.1205 0.0927 0.0685 0.092 ...
>
> .. ..$ TRI: num [1:349272] 0.0617 0.0811 0.0606 0.0581 0.0677 ...
>
> ..@ coords.nrs : num(0)
>
> ..@ grid:Formal class 'GridTopology' [package "sp"] with 3 slots
>
> .. .. ..@ cellcentre.offset: Named num [1:2] 594515 4669713
>
> .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>
> .. .. ..@ cellsize: num [1:2] 1 1
>
> .. .. ..@ cells.dim: int [1:2] 396 882
>
> ..@ grid.index : int [1:349272] 1 2 3 4 5 6 7 8 9 10 ...
>
> ..@ coords: num [1:349272, 1:2] 594515 594516 594517 594518 594519 ...
>
> .. ..- attr(*, "dimnames")=List of 2
>
> .. .. ..$ : NULL
>
> .. .. ..$ : chr [1:2] "x" "y"
>
> ..@ bbox: num [1:2, 1:2] 594515 4669713 594911 4670595
>
> .. ..- attr(*, "dimnames")=List of 2
>
> .. .. ..$ : chr [1:2] "x" "y"
>
> .. .. ..$ : chr [1:2] "min" "max"
>
> ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>
> .. .. ..@ projargs: chr "+proj=utm +zone=32 +ellps=WGS84
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>
>> str(SPDF_monte_norm)
>
> Formal class 'SpatialPixelsDataFrame' [package "sp"] with 7 slots
>
> ..@ data:'data.frame':48333 obs. of8 variables:
>
> .. ..$ aspect: num [1:48333] 5.498 0.303 1.288 1.298 0.785 ...
>
> .. ..$ BPI: num [1:48333] 5.18 6.14 6.8 5.69 6.2 ...
>
> .. ..$ curvature: num [1:48333] 0 0.19 1.03 -1.01 0 ...
>
> .. ..$ plan.curvature: num [1:48333] 0 0.175 0.132 -0.119 0 ...
>
> .. ..$ profile.curvature: num [1:48333] 0 0.0185 0.9835 -0.959 0 ...
>
> .. ..$ depth: num [1:48333] -32.6 -32.5 -32.7 -34.7 -35 ...
>
> .. ..$ slope: num [1:48333] 0.0298 0.2737 0.8512 0.8674 0.3622 ...
>
> .. ..$ TRI: num [1:48333] 0.0211 0.1896 1.176 1.1811 0.268 ...
>
> ..@ coords.nrs : num(0)
>
> ..@ grid:Formal class 'GridTopology' [package "sp"] with 3 slots
>
> .. .. ..@ cellcentre.offset: Named num [1:2] 608418 4685237
>
> .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>
> .. .. ..@ cellsize: num [1:2] 1 1
>
> .. .. ..@ cells.dim: int [1:2] 308 190
>
> ..@ grid.index : int [1:48333] 169 170 171 172 173 175 176 177 178 179 ...
>
> ..@ coords: num [1:48333, 1:2] 608586 608587 608588 608589 608590 ...
>
> .. ..- attr(*, "dimnames")=List of 2
>
> .. .. ..$ : NULL
>
> .. .. ..$ : chr [1:2] "x" "y"
>
> ..@ bbox: num [1:2, 1:2] 608418 4685237 608726 4685427
>
> .. ..- attr(*, "dimnames")=List of 2
>
> .. .. ..$ : chr [1:2] "x" "y"
>
> .. .. ..$ : chr [1:2] "min" "max"
>
> ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>
> .. .. ..@ projargs: chr "+proj=utm +zone=32 +ellps=WGS84
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From dwkang1982 at gmail.com  Tue Jul  9 22:47:01 2013
From: dwkang1982 at gmail.com (Dongwoo Kang)
Date: Tue, 9 Jul 2013 13:47:01 -0700
Subject: [R-sig-Geo] Question about LM test for residual autocorrelation in R
Message-ID: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/579e34b4/attachment.pl>

From HodgessE at uhd.edu  Tue Jul  9 23:07:11 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 9 Jul 2013 21:07:11 +0000
Subject: [R-sig-Geo] Question about LM test for residual autocorrelation
 in R
In-Reply-To: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
References: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A14FCA@columbia.uhd.campus>

Hi Dongwoo:

I tried the following example:

> erin1 <-     summary(COL.mix.eig, correlation=TRUE, Nagelkerke=TRUE)
> names(erin1)
 [1] "type"            "rho"             "coefficients"    "rest.se"        
 [5] "LL"              "s2"              "SSE"             "parameters"     
 [9] "logLik_lm.model" "AIC_lm.model"    "method"          "call"           
[13] "residuals"       "opt"             "tarX"            "tary"           
[17] "y"               "X"               "fitted.values"   "se.fit"         
[21] "similar"         "ase"             "rho.se"          "LMtest"         
[25] "resvar"          "zero.policy"     "aliased"         "listw_style"    
[29] "interval"        "fdHess"          "optimHess"       "insert"         
[33] "trs"             "LLNullLlm"       "timings"         "f_calls"        
[37] "hf_calls"        "intern_classic"  "coeftitle"       "Coef"           
[41] "NK"              "Wald1"           "correlation"     "correltext"     
[45] "LR1"            
> erin1$LMtest
          [,1]
[1,] 0.2891926
> 

and it does indeed have the LMtest result.

Or were you looking for the formula, please?

Thanks,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Dongwoo Kang [dwkang1982 at gmail.com]
Sent: Tuesday, July 09, 2013 3:47 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Question about LM test for residual autocorrelation in R

Dear list,

Hello, I am Dongwoo Kang. I am studying Spatial Econometric modeling.
I've faced one question while using *spdep* package in R.
 I want to ask your help for my qeustion.

While estimating my empirical models,
I want to test whether residuals of my spatial regression models (SEM, SAR,
SARAR, SDM estimated by maximum likelihood) still have spatial
autocorrelation pattern.

I think I have two options,
1) Moran's I test using *"moran.mc"* function in R,
2) Lagrange multiplier diagnostics with LMerr option using
*"lm.LMtests"* function
in R.

But I also find that for SAR, SDM, *"summary.sarlm"* function returns "LM
test for residual autocorrelation" by default.
However, this LM test is not given for SER and SARAR.

At first, I thought that "Lagrange multiplier diagnostics" and "LM test for
residual autocorrelation" in "*summary.sarlm*" function are same tests.
But in my empirical results, they give me different statistics (please see
below example).

-----< example
>---------------------------------------------------------------------------
> summary.sarlm(sar2, Nagelkerke=T)
...
Log likelihood: -3533.378 for lag model
ML residual variance (sigma squared): 224.88, (sigma: 14.996)
Nagelkerke pseudo-R-squared: 0.76166
Number of observations: 853
Number of parameters estimated: 29
AIC: 7124.8, (AIC for lm: 7393.3)
LM test for residual autocorrelation
test value: 6.8391, p-value: 0.0089184

>
> lm.LMtests(sar2$residuals, listw=w100.listw, test=c("LMerr"))

Lagrange multiplier diagnostics for spatial dependence

data:
residuals: sar2$residuals
weights: w100.listw

LMErr = 3.7108, df = 1, p-value = 0.05406
-------------------------------------------------------------------------------------------------------

I try to find formulation of "LM test for residual autocorrelation" given
by *"summary.sarlm"* function but I couldn't.

Would you tell me where I can get some documents or explanations about "LM
test for residual autocorrelation" given by *"summary.sarlm"*?

I also want to know why "LM test for residual autocorrelation" is not
provided in SER and SARAR models.

Thank you very much for your time.

Best regards,

Dongwoo Kang

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Tue Jul  9 23:12:03 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 9 Jul 2013 21:12:03 +0000
Subject: [R-sig-Geo] Question about LM test for residual autocorrelation
 in R
In-Reply-To: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
References: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A14FE3@columbia.uhd.campus>

Sorry...answered the wrong question

How do you generate the SER models, please?

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Dongwoo Kang [dwkang1982 at gmail.com]
Sent: Tuesday, July 09, 2013 3:47 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Question about LM test for residual autocorrelation in R

Dear list,

Hello, I am Dongwoo Kang. I am studying Spatial Econometric modeling.
I've faced one question while using *spdep* package in R.
 I want to ask your help for my qeustion.

While estimating my empirical models,
I want to test whether residuals of my spatial regression models (SEM, SAR,
SARAR, SDM estimated by maximum likelihood) still have spatial
autocorrelation pattern.

I think I have two options,
1) Moran's I test using *"moran.mc"* function in R,
2) Lagrange multiplier diagnostics with LMerr option using
*"lm.LMtests"* function
in R.

But I also find that for SAR, SDM, *"summary.sarlm"* function returns "LM
test for residual autocorrelation" by default.
However, this LM test is not given for SER and SARAR.

At first, I thought that "Lagrange multiplier diagnostics" and "LM test for
residual autocorrelation" in "*summary.sarlm*" function are same tests.
But in my empirical results, they give me different statistics (please see
below example).

-----< example
>---------------------------------------------------------------------------
> summary.sarlm(sar2, Nagelkerke=T)
...
Log likelihood: -3533.378 for lag model
ML residual variance (sigma squared): 224.88, (sigma: 14.996)
Nagelkerke pseudo-R-squared: 0.76166
Number of observations: 853
Number of parameters estimated: 29
AIC: 7124.8, (AIC for lm: 7393.3)
LM test for residual autocorrelation
test value: 6.8391, p-value: 0.0089184

>
> lm.LMtests(sar2$residuals, listw=w100.listw, test=c("LMerr"))

Lagrange multiplier diagnostics for spatial dependence

data:
residuals: sar2$residuals
weights: w100.listw

LMErr = 3.7108, df = 1, p-value = 0.05406
-------------------------------------------------------------------------------------------------------

I try to find formulation of "LM test for residual autocorrelation" given
by *"summary.sarlm"* function but I couldn't.

Would you tell me where I can get some documents or explanations about "LM
test for residual autocorrelation" given by *"summary.sarlm"*?

I also want to know why "LM test for residual autocorrelation" is not
provided in SER and SARAR models.

Thank you very much for your time.

Best regards,

Dongwoo Kang

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From blows_michael at yahoo.com  Tue Jul  9 23:44:21 2013
From: blows_michael at yahoo.com (Michael Blows)
Date: Tue, 9 Jul 2013 14:44:21 -0700 (PDT)
Subject: [R-sig-Geo] Degrees of freedom in GWR
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217A14FE3@columbia.uhd.campus>
References: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A14FE3@columbia.uhd.campus>
Message-ID: <1373406261.61358.YahooMailNeo@web161201.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130709/3f43ce80/attachment.pl>

From Jorge.Molinos at sams.ac.uk  Tue Jul  9 23:58:09 2013
From: Jorge.Molinos at sams.ac.uk (Jorge Molinos)
Date: Tue, 9 Jul 2013 21:58:09 +0000
Subject: [R-sig-Geo] Reproject raster from 0 360 to -180 180?
In-Reply-To: <EE4F0547B0D1ED4E935316DBD984843807ADFF1A@Verbiage1.sams.local>
References: <EE4F0547B0D1ED4E935316DBD984843807ADEEE7@Verbiage1.sams.local>,
	<EE4F0547B0D1ED4E935316DBD984843807ADFF1A@Verbiage1.sams.local>
Message-ID: <EE4F0547B0D1ED4E935316DBD984843807AE1F8F@Verbiage1.sams.local>


Hello everybody,

I have a raster that has longtitudes from 0 to 360 with the horizontal center at 180 longtitude

http://www.freeimagehosting.net/lr9rb

Pre_CCSM_r
class       : RasterLayer
dimensions  : 395, 320, 126400  (nrow, ncol, ncell)
resolution  : 1.125, 0.4294937  (x, y)
extent      : 0.50001, 360.5, -79.43527, 90.21475  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84
data source : in memory
names       : layer
values      : 271.2439, 303.2426  (min, max)

I want to transform this to a new raster with -180, 180 longtitude range centred at Greenwich meridian (0) for comparisons/analysis with other raster files. I have tried cutting the original raster into two (using the meridian 180 as cutting value) and piece them back together but got sort of a mosaic raster instead

http://www.freeimagehosting.net/h5bxo

>lonlat <- data.frame(xyFromCell(Pre_CCSM_r, 1:ncell(Pre_CCSM_r)))
>lonlat <- cbind(lonlat, getValues(Pre_CCSM_r))

>head(lonlat)

           x          y            getValues(Pre_CCSM_r)
1    1.06251 90              271.3698
2    2.18751 90              271.3698
3    3.31251 90              271.3698
4    4.43751 90              271.3698
5    5.56251 90              271.3698
6    6.68751 90              271.3698

>lolaA <- as.matrix(lonlat[lonlat$x>180,])

>lolaB <- as.matrix(lonlat[lonlat$x<=180,])
>mydata <- rbind(lolaA,lolaB)
>mydat <- matrix(mydata[,3], ncol=320,nrow=395,byrow=T)
>Pre_Had <- raster(mydat,xmn=-180, xmx=180, ymn=-90, ymx=90,crs="+proj=longlat +datum=WGS84")


This is probably a very clumsy (obviously wrong) way of doing it so any help/advice will be very much appreciated.

Thanks!!

Jorge








The Scottish Association for Marine Science (SAMS) is registered in Scotland as a Company Limited by Guarantee (SC009292) and is a registered charity (9206). SAMS has an actively trading wholly owned subsidiary company: SAMS Research Services Ltd a Limited Company (SC224404). All Companies in the group are registered in Scotland and share a registered office at Scottish Marine Institute, Oban Argyll PA37 1QA. The content of this message may contain personal views which are not the views of SAMS unless specifically stated. Please note that all email traffic is monitored for purposes of security and spam filtering. As such individual emails may be examined in more detail.


From kranstauber at orn.mpg.de  Wed Jul 10 08:35:39 2013
From: kranstauber at orn.mpg.de (Kranstauber, Bart)
Date: Wed, 10 Jul 2013 06:35:39 +0000
Subject: [R-sig-Geo] Reproject raster from 0 360 to -180 180?
References: <EE4F0547B0D1ED4E935316DBD984843807ADEEE7@Verbiage1.sams.local>,
	<EE4F0547B0D1ED4E935316DBD984843807ADFF1A@Verbiage1.sams.local>
	<EE4F0547B0D1ED4E935316DBD984843807AE1F8F@Verbiage1.sams.local>
Message-ID: <750B41C00D0B014687F06775A91F6E8655956BD4@UM-EXCDAG-A01.um.gwdg.de>

Use rotate in the package raster see for example:
https://stat.ethz.ch/pipermail/r-sig-geo/2011-March/011155.html

Bart

On 07/09/2013 11:59 PM, Jorge Molinos wrote:
> Hello everybody,
>
> I have a raster that has longtitudes from 0 to 360 with the horizontal center at 180 longtitude
>
> http://www.freeimagehosting.net/lr9rb
>
> Pre_CCSM_r
> class       : RasterLayer
> dimensions  : 395, 320, 126400  (nrow, ncol, ncell)
> resolution  : 1.125, 0.4294937  (x, y)
> extent      : 0.50001, 360.5, -79.43527, 90.21475  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84
> data source : in memory
> names       : layer
> values      : 271.2439, 303.2426  (min, max)
>
> I want to transform this to a new raster with -180, 180 longtitude range centred at Greenwich meridian (0) for comparisons/analysis with other raster files. I have tried cutting the original raster into two (using the meridian 180 as cutting value) and piece them back together but got sort of a mosaic raster instead
>
> http://www.freeimagehosting.net/h5bxo
>
>> lonlat <- data.frame(xyFromCell(Pre_CCSM_r, 1:ncell(Pre_CCSM_r)))
>> lonlat <- cbind(lonlat, getValues(Pre_CCSM_r))
>> head(lonlat)
>            x          y            getValues(Pre_CCSM_r)
> 1    1.06251 90              271.3698
> 2    2.18751 90              271.3698
> 3    3.31251 90              271.3698
> 4    4.43751 90              271.3698
> 5    5.56251 90              271.3698
> 6    6.68751 90              271.3698
>
>> lolaA <- as.matrix(lonlat[lonlat$x>180,])
>> lolaB <- as.matrix(lonlat[lonlat$x<=180,])
>> mydata <- rbind(lolaA,lolaB)
>> mydat <- matrix(mydata[,3], ncol=320,nrow=395,byrow=T)
>> Pre_Had <- raster(mydat,xmn=-180, xmx=180, ymn=-90, ymx=90,crs="+proj=longlat +datum=WGS84")
>
> This is probably a very clumsy (obviously wrong) way of doing it so any help/advice will be very much appreciated.
>
> Thanks!!
>
> Jorge
>
>
>
>
>
>
>
>
> The Scottish Association for Marine Science (SAMS) is registered in Scotland as a Company Limited by Guarantee (SC009292) and is a registered charity (9206). SAMS has an actively trading wholly owned subsidiary company: SAMS Research Services Ltd a Limited Company (SC224404). All Companies in the group are registered in Scotland and share a registered office at Scottish Marine Institute, Oban Argyll PA37 1QA. The content of this message may contain personal views which are not the views of SAMS unless specifically stated. Please note that all email traffic is monitored for purposes of security and spam filtering. As such individual emails may be examined in more detail.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Jorge.Molinos at sams.ac.uk  Wed Jul 10 10:12:02 2013
From: Jorge.Molinos at sams.ac.uk (Jorge Molinos)
Date: Wed, 10 Jul 2013 08:12:02 +0000
Subject: [R-sig-Geo] Reproject raster from 0 360 to -180 180?
In-Reply-To: <750B41C00D0B014687F06775A91F6E8655956BD4@UM-EXCDAG-A01.um.gwdg.de>
References: <EE4F0547B0D1ED4E935316DBD984843807ADEEE7@Verbiage1.sams.local>,
	<EE4F0547B0D1ED4E935316DBD984843807ADFF1A@Verbiage1.sams.local>
	<EE4F0547B0D1ED4E935316DBD984843807AE1F8F@Verbiage1.sams.local>
	<750B41C00D0B014687F06775A91F6E8655956BD4@UM-EXCDAG-A01.um.gwdg.de>
Message-ID: <EE4F0547B0D1ED4E935316DBD984843807AE2FE0@Verbiage1.sams.local>

Thanks a lot! Exactly what I needed.

Jorge

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Kranstauber, Bart
Sent: 10 July 2013 07:36
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Reproject raster from 0 360 to -180 180?

Use rotate in the package raster see for example:
https://stat.ethz.ch/pipermail/r-sig-geo/2011-March/011155.html

Bart

On 07/09/2013 11:59 PM, Jorge Molinos wrote:
> Hello everybody,
>
> I have a raster that has longtitudes from 0 to 360 with the horizontal
> center at 180 longtitude
>
> http://www.freeimagehosting.net/lr9rb
>
> Pre_CCSM_r
> class       : RasterLayer
> dimensions  : 395, 320, 126400  (nrow, ncol, ncell) resolution  :
> 1.125, 0.4294937  (x, y)
> extent      : 0.50001, 360.5, -79.43527, 90.21475  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 data source : in memory
> names       : layer
> values      : 271.2439, 303.2426  (min, max)
>
> I want to transform this to a new raster with -180, 180 longtitude
> range centred at Greenwich meridian (0) for comparisons/analysis with
> other raster files. I have tried cutting the original raster into two
> (using the meridian 180 as cutting value) and piece them back together
> but got sort of a mosaic raster instead
>
> http://www.freeimagehosting.net/h5bxo
>
>> lonlat <- data.frame(xyFromCell(Pre_CCSM_r, 1:ncell(Pre_CCSM_r)))
>> lonlat <- cbind(lonlat, getValues(Pre_CCSM_r))
>> head(lonlat)
>            x          y            getValues(Pre_CCSM_r)
> 1    1.06251 90              271.3698
> 2    2.18751 90              271.3698
> 3    3.31251 90              271.3698
> 4    4.43751 90              271.3698
> 5    5.56251 90              271.3698
> 6    6.68751 90              271.3698
>
>> lolaA <- as.matrix(lonlat[lonlat$x>180,]) lolaB <-
>> as.matrix(lonlat[lonlat$x<=180,]) mydata <- rbind(lolaA,lolaB) mydat
>> <- matrix(mydata[,3], ncol=320,nrow=395,byrow=T) Pre_Had <-
>> raster(mydat,xmn=-180, xmx=180, ymn=-90, ymx=90,crs="+proj=longlat
>> +datum=WGS84")
>
> This is probably a very clumsy (obviously wrong) way of doing it so any help/advice will be very much appreciated.
>
> Thanks!!
>
> Jorge
>
>
>
>
>
>
>
>
> The Scottish Association for Marine Science (SAMS) is registered in Scotland as a Company Limited by Guarantee (SC009292) and is a registered charity (9206). SAMS has an actively trading wholly owned subsidiary company: SAMS Research Services Ltd a Limited Company (SC224404). All Companies in the group are registered in Scotland and share a registered office at Scottish Marine Institute, Oban Argyll PA37 1QA. The content of this message may contain personal views which are not the views of SAMS unless specifically stated. Please note that all email traffic is monitored for purposes of security and spam filtering. As such individual emails may be examined in more detail.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
The Scottish Association for Marine Science (SAMS) is registered in Scotland as a Company Limited by Guarantee (SC009292) and is a registered charity (9206). SAMS has an actively trading wholly owned subsidiary company: SAMS Research Services Ltd a Limited Company (SC224404). All Companies in the group are registered in Scotland and share a registered office at Scottish Marine Institute, Oban Argyll PA37 1QA. The content of this message may contain personal views which are not the views of SAMS unless specifically stated. Please note that all email traffic is monitored for purposes of security and spam filtering. As such individual emails may be examined in more detail.


From Roger.Bivand at nhh.no  Wed Jul 10 11:25:04 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 10 Jul 2013 09:25:04 +0000
Subject: [R-sig-Geo] R2WinBugs - getting TRAP errors in Winbugs
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A6028545C7EABA@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EABA@GOMAIL.college.tcd.ie>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B6C0DC3E8@DALER.valuta.nhh.no>

It is possible that N is large for this approach, but you have options using the CARBayes package and the BayesX interface in R, and INLA at www.r-inla.org. Code samples in ch. 10 in the 2nd edition of the book you refer to, ch. 10, on www.asdar-book.org. If there are spatially patterned omitted covariates, going through Bayesian inference may be serious overkill, unless you really need the N marginals on the spatially structured random effects rather than just the point smooth values in your Poisson regession; does glm() or some GLMM get you there with less trouble? Might the hglm package help?

Hope this helps,

Roger

--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av James Rooney [ROONEYJ4 at tcd.ie]
Sendt: 9. juli 2013 11:46
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] R2WinBugs - getting TRAP errors in Winbugs

Hi all,

I am trying to implement the WinBUGS spatial conditional autoregression model on page 11.11 of Applied Spatial Data Analysis in R. I have about 3300 polygons with about 17,000 adjacencies in the set.
I have changed the model only by removing the beta term as, for now, I don't have any variables to include - I want simply to do a spatially smoothed model with no covariates.

Anyhow the code runs fine under R - but I am constantly getting a Trap Error in Winbugs - Index out of range.
My BUGs code looks like this:
model
{

  for(i in 1:N)
  {
    observed[i]~dpois(mu[i])
    log(theta[i])<-alpha + u[i] + v[i]
    mu[i]<-expected[i]*theta[i]
    u[i] ~dnorm(0,precu)
  }

v[1:N]~car.normal(adj[],weights[],num[],precv)

  alpha ~dflat()
  precu ~dgamma (0.001, 0.001)
  precv ~dgamma (0.001, 0.001)

}

and my R code like this - (I've deliberately kept the iterations low in trying to figure out the problem but I get the error even within 1000 iterations).

nb<-poly2nb(EDdata2,queen=T)
nb.w<-nb2listw(nb,zero.policy=T,style="B")
nbBugs<-listw2WB(nb.w)

BugsDir<-"C:/Program Files/WinBUGS14/"
N<-length(EDdata2$nm_tt_c)
d<-list(N = N, observed =EDdata2$nm_tt_c, expected = EDdata2$tot_exp, adj=nbBugs$adj, weights=nbBugs$weights, num=nbBugs$num)
inits<-list(list(u=rep(0,N),v=rep(0,N),alpha=0,precu=0.001,precv=0.001))

MCMCres<-bugs(data=d,inits=inits,bugs.directory=BugsDir,parameters.to.save=c("theta","alpha"),n.chains=1,n.iter=1000,n.burnin=500,n.thin=1, model.file="ALS_spatial_CAR.txt")


I don't know if WinBUGS falls under the remit here ?? But was hoping someone might have some idea whats causing my TRAP errors as I am at a loss.

Many thanks all,
James
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed Jul 10 11:28:20 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 10 Jul 2013 09:28:20 +0000
Subject: [R-sig-Geo] Using gDistance under Linux causes R crash.
In-Reply-To: <alpine.LRH.2.03.1307090752270.17437@reclus.nhh.no>
References: <CA+nXtYZbHjNemcdoO-0vMTR4+EXDE9E3EWmE_U7Ws6qOpzP=Vg@mail.gmail.com>,
	<alpine.LRH.2.03.1307090752270.17437@reclus.nhh.no>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B6C0DC3FB@DALER.valuta.nhh.no>

To test whether GEOS and rgeos are installed correctly, run:

library(rgeos)
library(testthat)
set_do_poly_check(FALSE)
test_package("rgeos")
set_do_poly_check(TRUE)

--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av Roger Bivand [Roger.Bivand at nhh.no]
Sendt: 9. juli 2013 7:57
Til: Ferdinand Bersse
Kopi: r-sig-geo at r-project.org
Emne: Re: [R-sig-Geo] Using gDistance under Linux causes R crash.

On Tue, 9 Jul 2013, Ferdinand Bersse wrote:

> Dears,
>
> I've been trying to use gDistance from rgeos package to generate a distance
> matrix between all features of a shp file, i.e. using gDistance(shpfile,
> shpfile, byid=TRUE) in R 2.15 and it always makes R to crash.

You should always provide a reproducible example of claims of crashing R.
There is no way anyone can advise you if you do not do this, because
guesswork is no help. Please also see the posting guide for definitions of
crash - a crash is only when R exits to the shell. You will have to remove
the possibility that rgeos and GEOS are wrongly installed, first by
removing the rpm (I doubt that geos-devel is sufficient) and installing
GEOS from source. Then you must show how your read the shapefile (use
rgdal only), and it will be best if you show your code in relation to a
small shapefile that is available.

Roger

>
> I am using a Red Hat server with R 2.15 (can not change R version now in
> the server).
>
> Any insights about what may be going on or any other option that calculates
> distances from border to border of spatial features (not from centroids to
> centroids)?
>
> Many thanks!
>
> Ferd.
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From gga01jet at yahoo.co.uk  Wed Jul 10 12:26:56 2013
From: gga01jet at yahoo.co.uk (John Tomkinson)
Date: Wed, 10 Jul 2013 11:26:56 +0100 (BST)
Subject: [R-sig-Geo] Imputation of missing values
Message-ID: <1373452016.59753.YahooMailNeo@web171703.mail.ir2.yahoo.com>

Hi all,

I would like to impute missing values in a data set based on the distribution of the other values of the variable.

Imagine that 30 % of the values = 1, 20 % = 2 and 50 % = 3, in effect I'd like to do the following :

df$var[df$var==NA]<-1 # for 30 % of the NA occurrences #
df$var[df$var==NA]<-2 # for 20 % of the NA occurrences #
df$var[df$var==NA]<-3 # for 50 % of the NA occurrences #

Can anybody help ?

John



From ROONEYJ4 at tcd.ie  Wed Jul 10 12:59:34 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Wed, 10 Jul 2013 11:59:34 +0100
Subject: [R-sig-Geo] R2WinBugs - getting TRAP errors in Winbugs
In-Reply-To: <E953A98FD6EAA7479A68EE8C24491F6B6C0DC3E8@DALER.valuta.nhh.no>
References: <75C8D19A1470D344A8AF5312F01160A6028545C7EABA@GOMAIL.college.tcd.ie>,
	<E953A98FD6EAA7479A68EE8C24491F6B6C0DC3E8@DALER.valuta.nhh.no>
Message-ID: <75C8D19A1470D344A8AF5312F01160A6028545C7EABC@GOMAIL.college.tcd.ie>

Thanks for the various options.

I have tried using the CARBayes package however several of the functions (for example the .bymGAR function) were giving me this error:

Error in chol2inv(chol(Q.current)) : 
  error in evaluating the argument 'x' in selecting a method for function 'chol2inv': Error in chol.default(Q.current) : 
  the leading minor of order 8 is not positive definite

Thanks for the other options I will look into them. 

James
________________________________________
From: Roger Bivand [Roger.Bivand at nhh.no]
Sent: 10 July 2013 10:25
To: James Rooney; r-sig-geo at r-project.org
Subject: SV: R2WinBugs - getting TRAP errors in Winbugs

It is possible that N is large for this approach, but you have options using the CARBayes package and the BayesX interface in R, and INLA at www.r-inla.org. Code samples in ch. 10 in the 2nd edition of the book you refer to, ch. 10, on www.asdar-book.org. If there are spatially patterned omitted covariates, going through Bayesian inference may be serious overkill, unless you really need the N marginals on the spatially structured random effects rather than just the point smooth values in your Poisson regession; does glm() or some GLMM get you there with less trouble? Might the hglm package help?

Hope this helps,

Roger

--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av James Rooney [ROONEYJ4 at tcd.ie]
Sendt: 9. juli 2013 11:46
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] R2WinBugs - getting TRAP errors in Winbugs

Hi all,

I am trying to implement the WinBUGS spatial conditional autoregression model on page 11.11 of Applied Spatial Data Analysis in R. I have about 3300 polygons with about 17,000 adjacencies in the set.
I have changed the model only by removing the beta term as, for now, I don't have any variables to include - I want simply to do a spatially smoothed model with no covariates.

Anyhow the code runs fine under R - but I am constantly getting a Trap Error in Winbugs - Index out of range.
My BUGs code looks like this:
model
{

  for(i in 1:N)
  {
    observed[i]~dpois(mu[i])
    log(theta[i])<-alpha + u[i] + v[i]
    mu[i]<-expected[i]*theta[i]
    u[i] ~dnorm(0,precu)
  }

v[1:N]~car.normal(adj[],weights[],num[],precv)

  alpha ~dflat()
  precu ~dgamma (0.001, 0.001)
  precv ~dgamma (0.001, 0.001)

}

and my R code like this - (I've deliberately kept the iterations low in trying to figure out the problem but I get the error even within 1000 iterations).

nb<-poly2nb(EDdata2,queen=T)
nb.w<-nb2listw(nb,zero.policy=T,style="B")
nbBugs<-listw2WB(nb.w)

BugsDir<-"C:/Program Files/WinBUGS14/"
N<-length(EDdata2$nm_tt_c)
d<-list(N = N, observed =EDdata2$nm_tt_c, expected = EDdata2$tot_exp, adj=nbBugs$adj, weights=nbBugs$weights, num=nbBugs$num)
inits<-list(list(u=rep(0,N),v=rep(0,N),alpha=0,precu=0.001,precv=0.001))

MCMCres<-bugs(data=d,inits=inits,bugs.directory=BugsDir,parameters.to.save=c("theta","alpha"),n.chains=1,n.iter=1000,n.burnin=500,n.thin=1, model.file="ALS_spatial_CAR.txt")


I don't know if WinBUGS falls under the remit here ?? But was hoping someone might have some idea whats causing my TRAP errors as I am at a loss.

Many thanks all,
James
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From samanmonfared1 at gmail.com  Wed Jul 10 14:14:50 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Wed, 10 Jul 2013 15:44:50 +0330
Subject: [R-sig-Geo] help for lattice plot
Message-ID: <CAOytA4ZQtOT9wNbxWuGzgRNa74rxHkvCdTPA4iYdv5Xy46YJUg@mail.gmail.com>

Dear All,

How can I plot some different plots in one page in lattice
like "par(mfrow=c(2,2))" in graphics package?


p1<-bwplot(m~PRED,data=PRED)
p2<-bwplot(R~Residual,data=PRED)
xyplot(obs~PRED.v|method,data=PRED.v)
histogram(~PRED.v|method,data=PRED.v)

Thanks,

Saman.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From roman.lustrik at gmail.com  Wed Jul 10 14:52:23 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 10 Jul 2013 14:52:23 +0200
Subject: [R-sig-Geo] help for lattice plot
In-Reply-To: <CAOytA4ZQtOT9wNbxWuGzgRNa74rxHkvCdTPA4iYdv5Xy46YJUg@mail.gmail.com>
References: <CAOytA4ZQtOT9wNbxWuGzgRNa74rxHkvCdTPA4iYdv5Xy46YJUg@mail.gmail.com>
Message-ID: <CAHT1vpjYkakxdv9tKTSV8ZoHpv4Ls1XrAGDtaMHiti0nt-dp-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130710/6f4d9793/attachment.pl>

From oscar.perpinan at gmail.com  Wed Jul 10 15:19:46 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 10 Jul 2013 15:19:46 +0200
Subject: [R-sig-Geo] help for lattice plot
In-Reply-To: <CAOytA4ZQtOT9wNbxWuGzgRNa74rxHkvCdTPA4iYdv5Xy46YJUg@mail.gmail.com>
References: <CAOytA4ZQtOT9wNbxWuGzgRNa74rxHkvCdTPA4iYdv5Xy46YJUg@mail.gmail.com>
Message-ID: <87vc4iwo0d.fsf@gmail.com>

?print.trellis

Next time use the R-help mailing list
(https://stat.ethz.ch/mailman/listinfo/r-help) for these questions.

Best,

Oscar.


Saman Monfared <samanmonfared1 at gmail.com> writes:

> Dear All,
>
> How can I plot some different plots in one page in lattice
> like "par(mfrow=c(2,2))" in graphics package?
>
>
> p1<-bwplot(m~PRED,data=PRED)
> p2<-bwplot(R~Residual,data=PRED)
> xyplot(obs~PRED.v|method,data=PRED.v)
> histogram(~PRED.v|method,data=PRED.v)
>
> Thanks,
>
> Saman.


From thomas.aubineau.gds35 at reseaugds.com  Wed Jul 10 15:45:37 2013
From: thomas.aubineau.gds35 at reseaugds.com (Thomas AUBINEAU)
Date: Wed, 10 Jul 2013 15:45:37 +0200
Subject: [R-sig-Geo] length polygons / nrow data
Message-ID: <001601ce7d73$c29f3d90$47ddb8b0$@aubineau.gds35@reseaugds.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130710/2a1200d1/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jul 10 16:09:48 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 10 Jul 2013 16:09:48 +0200
Subject: [R-sig-Geo] length polygons / nrow data
In-Reply-To: <001601ce7d73$c29f3d90$47ddb8b0$@aubineau.gds35@reseaugds.com>
References: <001601ce7d73$c29f3d90$47ddb8b0$@aubineau.gds35@reseaugds.com>
Message-ID: <alpine.LRH.2.03.1307101604580.21897@reclus.nhh.no>

On Wed, 10 Jul 2013, Thomas AUBINEAU wrote:

> Hello,
>
> I' m still beginner (two days of practice), and I failed in the example
> script from the ASFAR Book, about SpatialPolygonsDataFrame (example page
> 45).
>

Assuming that you did download the code for that chapter (2, 1st edition I 
assume) from http://www.asdar-book.org/book/cm_mod.R, are you in chunk 73?

All the code is run daily, so it does work; for future reference, please 
paste the offending line of code and error message into your question.

Roger

>
>
> Can you help me?
>
>
>
> Sincerely
>
>
>
> state.map<-map("state",plot=FALSE,fill=TRUE)
>
>> IDs<-sapply(strsplit(state.map$names,":"),function(x)x[1])
>
>> state.sp<-map2SpatialPolygons(state.map,IDs=IDs,
>
> + proj4string=CRS("+proj=longlat+ellps=WGS84"))
>
>> sat<-read.table("C:/Users/Thomas
> AUBINEAU/Desktop/state.sat.data_mod.txt",row.names=5,
>
> + header=TRUE)
>
>> str(sat)
>
> 'data.frame':   52 obs. of  4 variables:
>
> $ oname : Factor w/ 52 levels "ala","alaska",..: 1 2 3 4 5 6 7 9 8 10 ...
>
> $ vscore: int  561 516 524 563 497 536 510 503 494 499 ...
>
> $ mscore: int  555 514 525 556 514 540 509 497 478 498 ...
>
> $ pc    : int  9 50 34 6 49 32 80 67 77 53 ...
>
>> id<-match(row.names(sat),sapply(slot(state.sp,"polygons"),
>
> + function(x)slot(x,"ID")))
>
>> row.names(sat)[is.na(id)]
>
> [1] "alaska" "hawaii" "usa"
>
>> state.spdf<-SpatialPolygonsDataFrame(state.sp,sat)
>
> Error: length(Sr at polygons) == nrow(data) is not TRUE
>
>
>
> Thomas AUBINEAU
>
> Responsable technique GDS 35
>
> ZA Atalante Champeaux
>
> 35042 RENNES CEDEX
>
> 0223482600 / 0623258789
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mspinola10 at gmail.com  Wed Jul 10 18:38:51 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Wed, 10 Jul 2013 10:38:51 -0600
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
Message-ID: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130710/9cf7a04e/attachment.pl>

From samanmonfared1 at gmail.com  Wed Jul 10 19:51:51 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Wed, 10 Jul 2013 21:21:51 +0330
Subject: [R-sig-Geo] help for show.vgms
Message-ID: <CAOytA4bJkW1-VuPJ8ZwQ3BrGXAHR_RL1V=ZiE70CnRjaC=pZ6Q@mail.gmail.com>

Dear all,

How can I add text and change color of variograms in show.vgms()?


Best,

Saman.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From pbidanset at gmail.com  Wed Jul 10 21:34:27 2013
From: pbidanset at gmail.com (Paul Bidanset)
Date: Wed, 10 Jul 2013 15:34:27 -0400
Subject: [R-sig-Geo] SPGWR - gw.adapt() command question
Message-ID: <CAD7wDOBwbkQCqpknT2Pcd9pVu+x8M5Doo0MU_DDkDTTCPmEhwA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130710/dda1e894/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Thu Jul 11 09:02:53 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 11 Jul 2013 09:02:53 +0200
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
In-Reply-To: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
References: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
Message-ID: <51DE589D.20301@jrc.ec.europa.eu>

On 10/07/13 18:38, Manuel Sp?nola wrote:
> Dear list members,
>
> I am trying to export a raster file to a ascii file (.asc) but the min and
> max values are not the same. Any idea why?

Hi Manuel,

Could you provide your sessionInfo() ?
>
>> bio1res
> class       : RasterLayer
> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
> resolution  : 0.008333333, 0.008333333  (x, y)
> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> data source : in memory
> names       : bio1_23
> values      : 47, 272  (min, max)
>
>> writeRaster(bio1res, filename="temp.asc", format="ascii",overwrite=TRUE)
> class       : RasterLayer
> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
> resolution  : 0.008333333, 0.008333333  (x, y)
> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> data source : /Users/manuelspinola/Dropbox/Distribucio??n de
> especies/World_Clim_Costa_Rica/temp.asc
> names       : temp
> values      : -2147483648, 2147483647  (min, max)

Unfortunately, your example is not reproducible, so I tried with a 
different example and the values in the original and the written ascii 
file were the same (rgdal_0.8-10, raster_2.1-48, sp_1.0-11):

----------  START --------------
library(raster)
Loading required package: sp

# Creation of a raster file for testing
r <- raster(system.file("external/test.grd", package="raster"))

r
#class       : RasterLayer
#dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
#resolution  : 40, 40  (x, y)
#extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
#coord. ref. : +init=epsg:28992 
+towgs84=565.237,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
#data source : /usr/lib64/R/library/raster/external/test.grd
#names       : test
#values      : 128.434, 1805.78  (min, max)

writeRaster(r, filename="temp.asc", format="ascii",overwrite=TRUE)
#rgdal: version: 0.8-10, (SVN revision 478)
#Geospatial Data Abstraction Library extensions to R successfully loaded
#Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
#Path to GDAL shared files: /usr/share/gdal
#Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
#Path to PROJ.4 shared files: (autodetected)
#class       : RasterLayer
#dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
#resolution  : 40, 40  (x, y)
#extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
#coord. ref. : NA
#data source : /home/zambrhe/temp.asc
#names       : temp

# reading the .asc file form disk
r2 <- raster("temp.asc")

r2
#class       : RasterLayer
#dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
#resolution  : 40, 40  (x, y)
#extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
#coord. ref. : NA
#data source : /home/zambrhe/temp.asc
#names       : temp

# Summary of the ascii file in the hard disk
#summary(r2)
#             temp
#Min.     128.4340
#1st Qu.  293.2325
#Median   371.4120
#3rd Qu.  499.8195
#Max.    1805.7800
#NA's    6097.0000


# Summary of the original raster file
summary(r)
#             test
#Min.     128.4340
#1st Qu.  293.2325
#Median   371.4120
#3rd Qu.  499.8195
#Max.    1805.7800
#NA's    6097.0000
----------  END --------------

Kind regards,

Mauricio Zambrano-Bigiarini, Ph.D

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
Work Phone : +39 0332 789588
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
"The journey is the reward"  (Steve Jobs)


From Roger.Bivand at nhh.no  Thu Jul 11 09:33:57 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 11 Jul 2013 09:33:57 +0200
Subject: [R-sig-Geo] SPGWR - gw.adapt() command question
In-Reply-To: <CAD7wDOBwbkQCqpknT2Pcd9pVu+x8M5Doo0MU_DDkDTTCPmEhwA@mail.gmail.com>
References: <CAD7wDOBwbkQCqpknT2Pcd9pVu+x8M5Doo0MU_DDkDTTCPmEhwA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307110927510.24545@reclus.nhh.no>

On Wed, 10 Jul 2013, Paul Bidanset wrote:

> Hello all,
>
> I am doing some exploratory analysis with adaptive and fixed kernels in the
> SPGWR package. I am hoping to glean further insight from someone who has a
> better understanding of the gw.adapt(dp, fp, quant, longlat=FALSE) command.
> I understand 'quant' is proportion of data points to include in the weight.
> Is there a common trade off moving from 0 to 1? The bandwidth it assigns
> are consistently much larger and perform significantly worse than when
> employing a fixed bandwidth, which seems counter-intuitive to much of the
> literature I am reading. As the proportion I use increases, some of the
> bandwidths are reaching as high as 200 km, which I know cannot be correct
> as the geographical area is no more than 30 square kilometers.

If you do not provide a reproducible example, the only conclusion is that 
your usage of the function - which is used internally rather than by users 
- is incorrect. I can reproduce your artefact by using quant > 1, that is 
more than 100% of points included in the pointwise bandwidths:

library(spgwr)
data(columbus)
col.bw <- gwr.sel(crime ~ income + housing, data=columbus, 
coords=cbind(columbus$x, columbus$y), adapt=TRUE)
gw.adapt(cbind(columbus$x, columbus$y), cbind(columbus$x, columbus$y),
   quant=col.bw)
gw.adapt(cbind(columbus$x, columbus$y), cbind(columbus$x, columbus$y),
   quant=0.1)
gw.adapt(cbind(columbus$x, columbus$y), cbind(columbus$x, columbus$y),
   quant=0.9)
gw.adapt(cbind(columbus$x, columbus$y), cbind(columbus$x, columbus$y),
   quant=0.99)
gw.adapt(cbind(columbus$x, columbus$y), cbind(columbus$x, columbus$y),
   quant=15)

Is this your scenario?

Roger

>
> Any insight is very much appreciated.  I am very aware of the
> warnings and pitfalls of GWR ; I am simply looking to have a better
> understanding of the intuition behind this package and command
> specifically. Thanks very much for your time!
>
> Best,
>
> Paul
> Old Dominion University
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Thu Jul 11 09:34:41 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 11 Jul 2013 09:34:41 +0200
Subject: [R-sig-Geo] help for show.vgms
In-Reply-To: <CAOytA4bJkW1-VuPJ8ZwQ3BrGXAHR_RL1V=ZiE70CnRjaC=pZ6Q@mail.gmail.com>
References: <CAOytA4bJkW1-VuPJ8ZwQ3BrGXAHR_RL1V=ZiE70CnRjaC=pZ6Q@mail.gmail.com>
Message-ID: <51DE6011.9000805@uni-muenster.de>

library(gstat)
my.show.vgms = show.vgms
my.show.vgms = edit(my.show.vgms)
my.show.vgms()

what exactly you have to change during the edit phase is beyond the
context of this list, it is basic R programming.

On 07/10/2013 07:51 PM, Saman Monfared wrote:
> Dear all,
> 
> How can I add text and change color of variograms in show.vgms()?
> 
> 
> Best,
> 
> Saman.
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From Roger.Bivand at nhh.no  Thu Jul 11 09:48:09 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 11 Jul 2013 09:48:09 +0200
Subject: [R-sig-Geo] Degrees of freedom in GWR
In-Reply-To: <1373406261.61358.YahooMailNeo@web161201.mail.bf1.yahoo.com>
References: <CAOEftptpadxFBntb2NNGt2zjgxYrkc=jSZjJJ_fehOk8kESe7Q@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A14FE3@columbia.uhd.campus>
	<1373406261.61358.YahooMailNeo@web161201.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1307110936470.24545@reclus.nhh.no>

On Tue, 9 Jul 2013, Michael Blows wrote:

> Hi all, can any body clarify me why the degrees of freedom in R output 
> of ?GWR comes in decimal? Mike

Please read the references, where this is explained - why would you expect 
them to be integer when weighted proportions of observations are being 
used for each fit point? The print method for fitted gwr objects reports 
two versions of effective degrees of freedom if the hat matrix is 
computed, one complete, the other an approximation used in the 2002 GWR 
book, but these non-integer numbers are also based on assumptions.

> 	[[alternative HTML version deleted]]

Please only post plain text!

Roger

>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rosa.manrique at unibo.it  Thu Jul 11 10:02:08 2013
From: rosa.manrique at unibo.it (Rosa Soledad Manrique Paredes)
Date: Thu, 11 Jul 2013 08:02:08 +0000
Subject: [R-sig-Geo] Bayesian Networks-GIS
Message-ID: <059E5980392C2B44998A9234C2A677B1012A6E6026@E10-MBX4-DR.personale.dir.unibo.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/6f4e32a9/attachment.pl>

From Franz.Tscheikner-Gratl at uibk.ac.at  Thu Jul 11 13:55:41 2013
From: Franz.Tscheikner-Gratl at uibk.ac.at (ElSiebo)
Date: Thu, 11 Jul 2013 04:55:41 -0700 (PDT)
Subject: [R-sig-Geo] Data from intersecting Lines of shp files
Message-ID: <1373543741249-7584101.post@n2.nabble.com>

Hi
Iam quite new to R and Iam trying to use it for GIS application.
I used the maptools package to load a shapefile
WVA<-readShapeLines("WVA")

and now I would like to fill gaps in the shape file (missing numbers) with
the numbers from intersecting lines
I have tried with gintersect but I can only get true or false for answer and
not the numbers of the intersected lines...
For example for the first line....
gIntersects(WVA[1,],WVA, byid=TRUE)

Is there another possibility to do this?

Best regards
Franz





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Data-from-intersecting-Lines-of-shp-files-tp7584101.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Thu Jul 11 14:04:02 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 11 Jul 2013 06:04:02 -0600
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
In-Reply-To: <51DE589D.20301@jrc.ec.europa.eu>
References: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
	<51DE589D.20301@jrc.ec.europa.eu>
Message-ID: <CABkCotTrJNpb2h9-J25GNPDLXXp7iuMn6GbrfLOsvb7qN3=ZJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/edca40ab/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Jul 11 14:17:06 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 11 Jul 2013 13:17:06 +0100
Subject: [R-sig-Geo] Data from intersecting Lines of shp files
In-Reply-To: <5cd0ba61e20e433c831e479737ab8ddb@EX-1-HT0.lancs.local>
References: <5cd0ba61e20e433c831e479737ab8ddb@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMX65DbGVKA0j80P+h0ETA=eUBF6KGj44gB1c4HTwQOmg@mail.gmail.com>

On Thu, Jul 11, 2013 at 12:55 PM, ElSiebo
<Franz.Tscheikner-Gratl at uibk.ac.at> wrote:
> Hi
> Iam quite new to R and Iam trying to use it for GIS application.
> I used the maptools package to load a shapefile
> WVA<-readShapeLines("WVA")

1. Use readOGR from the rgdal package to read shapefiles - it will
handle the projection properly (unless maptools has fxed this).

> and now I would like to fill gaps in the shape file (missing numbers) with
> the numbers from intersecting lines
> I have tried with gintersect but I can only get true or false for answer and
> not the numbers of the intersected lines...
> For example for the first line....
> gIntersects(WVA[1,],WVA, byid=TRUE)
>
> Is there another possibility to do this?

 Its hard to figure out what you are trying to do - a picture might
help, but there's no image posting to this mailing list. If you could
make a diagram and upload it somewhere we can all see it (any picture
hosting service - flickr, picasa, etc etc) then we might get a better
idea.

 My first problem with your explanation is I don't understand exactly
what  'gaps in the shapefile (missing numbers)' means. Its a set of
line features - where are the gaps? Is it missing attribute data or
coordinate data?

Barry


From b.rowlingson at lancaster.ac.uk  Thu Jul 11 14:35:42 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 11 Jul 2013 13:35:42 +0100
Subject: [R-sig-Geo] Data from intersecting Lines of shp files
In-Reply-To: <581dd8503f7f47f0a6efc93167c33a68@EX-1-HT0.lancs.local>
References: <5cd0ba61e20e433c831e479737ab8ddb@EX-1-HT0.lancs.local>
	<CANVKczMX65DbGVKA0j80P+h0ETA=eUBF6KGj44gB1c4HTwQOmg@mail.gmail.com>
	<581dd8503f7f47f0a6efc93167c33a68@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMiaxE7SriW+t6Xru+eiJc_JXYwow8Kj1HYFNyYViARgA@mail.gmail.com>

On Thu, Jul 11, 2013 at 1:27 PM, Tscheikner-Gratl, Franz
<Franz.Tscheikner-Gratl at uibk.ac.at> wrote:
> Thanks for your reply.
>  The problem is that I have data of a pipe network with missing attributes (construction year). So I would like to see what are the constructions years of the intersecting (neighbouring) pipes.
> Then I would fill the missing attributes with the oldest construction age.
> I could make it by hand with ArcGis but it would be lots of work - so I thought I could make it with R.

 That's a bit clearer - if you could make a simple example shapefile
that shows the problem (you don't have to share all your data) I'm
pretty sure its just a case of selecting the pipe features and looping
over one of the intersection functions, which should return the  The
problem is if you have more than one labelled pipe crossing an
unlabelled pipe, or if no pipes cross - or in that case do you want
the nearest pipe? Maybe nearest is a better solution in any case
(since crossing pipes have distance zero)...

 Worst case scenario is a double loop over features with missing data
over features with data...

Barry


From alobolistas at gmail.com  Thu Jul 11 15:19:06 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 11 Jul 2013 15:19:06 +0200
Subject: [R-sig-Geo] writeRaster() writing float despite stating INT2U
Message-ID: <CAG4NRe+K8iU=rrTR3=zPf5V4mF2WEKw1md9gJkMM9CkR8+jXag@mail.gmail.com>

I'm having this strange problem: I write a raster as INT2U but get a
geotif with Float64. Is perhaps a gdal problem?


> r <- raster(matrix(1:100,nrow=10,ncol=10))
> writeRaster(r, file="r.tif",format="GTiff",dataype="INT2U",overwrite=TRUE,NAflag=0)
rgdal: version: 0.8-10, (SVN revision 478)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: /usr/share/gdal/1.10
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)
class       : RasterLayer
dimensions  : 10, 10, 100  (nrow, ncol, ncell)
resolution  : 0.1, 0.1  (x, y)
extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : /media/alobo/Iomega_HDD/PIVOT/RPivot/r.tif
names       : r
values      : 1, 100  (min, max)

> GDALinfo("r.tif")
rows        10
columns     10
bands       1
lower left origin.x        0
lower left origin.y        0
res.x       0.1
res.y       0.1
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  NA
file        r.tif
apparent band summary:
   GDType hasNoDataValue NoDataValue blockSize1 blockSize2
1 Float64           TRUE           0         10         10
apparent band statistics:
  Bmin Bmax Bmean      Bsd
1    1  100  50.5 29.01149

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=es_ES.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-10  raster_2.1-37 sp_1.0-9

loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.20-13 tools_2.15.2

Agus


From Roger.Bivand at nhh.no  Thu Jul 11 16:00:57 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 11 Jul 2013 16:00:57 +0200
Subject: [R-sig-Geo] Data from intersecting Lines of shp files
In-Reply-To: <CANVKczMiaxE7SriW+t6Xru+eiJc_JXYwow8Kj1HYFNyYViARgA@mail.gmail.com>
References: <5cd0ba61e20e433c831e479737ab8ddb@EX-1-HT0.lancs.local>
	<CANVKczMX65DbGVKA0j80P+h0ETA=eUBF6KGj44gB1c4HTwQOmg@mail.gmail.com>
	<581dd8503f7f47f0a6efc93167c33a68@EX-1-HT0.lancs.local>
	<CANVKczMiaxE7SriW+t6Xru+eiJc_JXYwow8Kj1HYFNyYViARgA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307111545510.26206@reclus.nhh.no>

On Thu, 11 Jul 2013, Barry Rowlingson wrote:

> On Thu, Jul 11, 2013 at 1:27 PM, Tscheikner-Gratl, Franz
> <Franz.Tscheikner-Gratl at uibk.ac.at> wrote:
>> Thanks for your reply.
>>  The problem is that I have data of a pipe network with missing attributes (construction year). So I would like to see what are the constructions years of the intersecting (neighbouring) pipes.
>> Then I would fill the missing attributes with the oldest construction age.
>> I could make it by hand with ArcGis but it would be lots of work - so I thought I could make it with R.
>
> That's a bit clearer - if you could make a simple example shapefile
> that shows the problem (you don't have to share all your data) I'm
> pretty sure its just a case of selecting the pipe features and looping
> over one of the intersection functions, which should return the  The
> problem is if you have more than one labelled pipe crossing an
> unlabelled pipe, or if no pipes cross - or in that case do you want
> the nearest pipe? Maybe nearest is a better solution in any case
> (since crossing pipes have distance zero)...

Maybe gTouches() rather than gIntersects() as maybe the contiguous pipe 
segments to segments with NA attribute values can by listed, while I'm not 
sure whether they intersect:

library(rgeos)
l1 = readWKT("LINESTRING(0 0,2 2)")
l2 = readWKT("LINESTRING(1 1,2 0)")
gTouches(l1,l2)
gIntersects(l1,l2)

so they do touch and intersect. I would suggest identifying the NA 
attribute Lines objects first, then loop over them to find their 
contiguous neighbours. If there are two neighbbours, and the value of 
interest is identical, it may be copied across, if different, or for three 
or more with different values, manual intervention may be needed, unless 
there is some other non-NA variable indicating which bit of the jigsaw 
puzzle belongs where.

Roger

>
> Worst case scenario is a double loop over features with missing data
> over features with data...
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From loic.dutrieux at wur.nl  Thu Jul 11 16:46:36 2013
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Thu, 11 Jul 2013 14:46:36 +0000
Subject: [R-sig-Geo] writeRaster() writing float despite stating INT2U
In-Reply-To: <CAG4NRe+K8iU=rrTR3=zPf5V4mF2WEKw1md9gJkMM9CkR8+jXag@mail.gmail.com>
References: <CAG4NRe+K8iU=rrTR3=zPf5V4mF2WEKw1md9gJkMM9CkR8+jXag@mail.gmail.com>
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB70E270BFA@SCOMP0937.wurnet.nl>

Hi Augustin,

Could it be because of the typo in the code ("dataype")?

Cheers,
Lo?c

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Agustin Lobo
Sent: jeudi 11 juillet 2013 15:19
To: r-sig-geo
Subject: [R-sig-Geo] writeRaster() writing float despite stating INT2U

I'm having this strange problem: I write a raster as INT2U but get a geotif with Float64. Is perhaps a gdal problem?


> r <- raster(matrix(1:100,nrow=10,ncol=10))
> writeRaster(r, 
> file="r.tif",format="GTiff",dataype="INT2U",overwrite=TRUE,NAflag=0)
rgdal: version: 0.8-10, (SVN revision 478) Geospatial Data Abstraction Library extensions to R successfully loaded Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24 Path to GDAL shared files: /usr/share/gdal/1.10 Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480] Path to PROJ.4 shared files: (autodetected)
class       : RasterLayer
dimensions  : 10, 10, 100  (nrow, ncol, ncell) resolution  : 0.1, 0.1  (x, y)
extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : /media/alobo/Iomega_HDD/PIVOT/RPivot/r.tif
names       : r
values      : 1, 100  (min, max)

> GDALinfo("r.tif")
rows        10
columns     10
bands       1
lower left origin.x        0
lower left origin.y        0
res.x       0.1
res.y       0.1
ysign       -1
oblique.x   0
oblique.y   0
driver      GTiff
projection  NA
file        r.tif
apparent band summary:
   GDType hasNoDataValue NoDataValue blockSize1 blockSize2
1 Float64           TRUE           0         10         10
apparent band statistics:
  Bmin Bmax Bmean      Bsd
1    1  100  50.5 29.01149

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=es_ES.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-10  raster_2.1-37 sp_1.0-9

loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.20-13 tools_2.15.2

Agus

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Thu Jul 11 18:07:04 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 11 Jul 2013 18:07:04 +0200
Subject: [R-sig-Geo] writeRaster() writing float despite stating INT2U
In-Reply-To: <A83620D4CC4762448EFB789FD6E9BBB70E270BFA@SCOMP0937.wurnet.nl>
References: <CAG4NRe+K8iU=rrTR3=zPf5V4mF2WEKw1md9gJkMM9CkR8+jXag@mail.gmail.com>
	<A83620D4CC4762448EFB789FD6E9BBB70E270BFA@SCOMP0937.wurnet.nl>
Message-ID: <CAG4NRe+QJPWADh1fTn7v7xB2Q2hz-6FYmZn2czK0C2tce6YLkg@mail.gmail.com>

LLoic,
Thanks and I apologize!
Agus

On Thu, Jul 11, 2013 at 4:46 PM, Dutrieux, Loic <loic.dutrieux at wur.nl> wrote:
> Hi Augustin,
>
> Could it be because of the typo in the code ("dataype")?
>
> Cheers,
> Lo?c
>
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Agustin Lobo
> Sent: jeudi 11 juillet 2013 15:19
> To: r-sig-geo
> Subject: [R-sig-Geo] writeRaster() writing float despite stating INT2U
>
> I'm having this strange problem: I write a raster as INT2U but get a geotif with Float64. Is perhaps a gdal problem?
>
>
>> r <- raster(matrix(1:100,nrow=10,ncol=10))
>> writeRaster(r,
>> file="r.tif",format="GTiff",dataype="INT2U",overwrite=TRUE,NAflag=0)
> rgdal: version: 0.8-10, (SVN revision 478) Geospatial Data Abstraction Library extensions to R successfully loaded Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24 Path to GDAL shared files: /usr/share/gdal/1.10 Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480] Path to PROJ.4 shared files: (autodetected)
> class       : RasterLayer
> dimensions  : 10, 10, 100  (nrow, ncol, ncell) resolution  : 0.1, 0.1  (x, y)
> extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> data source : /media/alobo/Iomega_HDD/PIVOT/RPivot/r.tif
> names       : r
> values      : 1, 100  (min, max)
>
>> GDALinfo("r.tif")
> rows        10
> columns     10
> bands       1
> lower left origin.x        0
> lower left origin.y        0
> res.x       0.1
> res.y       0.1
> ysign       -1
> oblique.x   0
> oblique.y   0
> driver      GTiff
> projection  NA
> file        r.tif
> apparent band summary:
>    GDType hasNoDataValue NoDataValue blockSize1 blockSize2
> 1 Float64           TRUE           0         10         10
> apparent band statistics:
>   Bmin Bmax Bmean      Bsd
> 1    1  100  50.5 29.01149
>
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
> LC_MONETARY=es_ES.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C
>                LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-10  raster_2.1-37 sp_1.0-9
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.2     lattice_0.20-13 tools_2.15.2
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From 538280 at gmail.com  Thu Jul 11 22:27:50 2013
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 11 Jul 2013 14:27:50 -0600
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>
Message-ID: <CAFEqCdzRxO8RYd2AVOeu0miyZeBp39VzvVOV2KuTFPnw=6Uwvg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/786e43eb/attachment.pl>

From mtreglia at gmail.com  Fri Jul 12 02:16:31 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 11 Jul 2013 17:16:31 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
Message-ID: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/291c338c/attachment.pl>

From HodgessE at uhd.edu  Fri Jul 12 02:50:43 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 12 Jul 2013 00:50:43 +0000
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>

Hi Michael:

Did you try this;

test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")

with the plus sign, please?

That might do it.

Thanks,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Michael Treglia [mtreglia at gmail.com]
Sent: Thursday, July 11, 2013 7:16 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import

Hi All,

I am using he "raster" package, and in particular the "raster" function. I
am dealing with a number of layers, and it would be easiest to set the CRS
upon import. Looking through the documentation, it seems that it is doable,
and I have been using the following code to get started, though it is not
setting the CRS.

Here are my code, and the results of the import:
> test<-raster("us_ppt_1981_2010.02.asc", crs="ellps=GRS80")
> test
class       : RasterLayer
dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
ymax)
*coord. ref. : NA *
data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
names       : us_ppt_1981_2010.02
values      : -2147483648, 2147483647  (min, max)

If I use the "projection" command afterwards, it sets the projection
appropriately though.
> projection(test)<-CRS("+proj=longlat +ellps=GRS80")
> test
class       : RasterLayer
dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
ymax)
*coord. ref. : +proj=longlat +ellps=GRS80 *
data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
names       : us_ppt_1981_2010.02
values      : -2147483648, 2147483647  (min, max)

Any suggestions of why the first option is not working? I have a script in
which I import all files in a folder, and the simplest way to assign the
projection would be the first option (I'm using an 'lapply' command).
It would look something like this:
import <- lapply(filenames ,raster, crs="....") #where "filenames" is a
vector of filenames in the working directory.

In case it helps, these are PRISM Climate Data, and the header of my raster
file is this:
ncols 7025
nrows 3105
xllcorner -125.020833333333329
yllcorner 24.062500000000000
cellsize 0.008333333333333
NODATA_value -9999

Thanks for any suggestions!
Mike

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mtreglia at gmail.com  Fri Jul 12 02:59:39 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 11 Jul 2013 17:59:39 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
Message-ID: <CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/75497a7c/attachment.pl>

From mtreglia at gmail.com  Fri Jul 12 03:10:26 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 11 Jul 2013 18:10:26 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
Message-ID: <CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/ec7633f5/attachment.pl>

From mdsumner at gmail.com  Fri Jul 12 03:13:53 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 12 Jul 2013 11:13:53 +1000
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
Message-ID: <CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>

Please report on the actual code you ran, you've just sent two
messages, one with

test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")

this correctly cannot set the CRS and so it is NA

and the other with

t<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
> test

We have no idea what you see in "t" now. In short you have to have a
"+proj", not just a "+ellps" for this incantation. You can check with

library(rgdal)
CRS("+ellps=GRS80")
Error in CRS("+ellps=GRS80") : projection not named






On Fri, Jul 12, 2013 at 11:10 AM, Michael Treglia <mtreglia at gmail.com> wrote:
> I just tried running it in an older version of R, 2.13.0 (64-bit) and it
> ran with no problem... the exact same code run from Notepad++
>
> Anybody know what has changed/if I need to adjust my for R 3.x.x?
>
> t<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
>> test
> class       : RasterLayer
> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
> resolution  : 0.008333333, 0.008333333  (x, y)
> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
> ymax)
> coord. ref. : +proj=longlat +ellps=GRS80
> values      : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>
> Thanks again!
> Mike
>
>
> On Thu, Jul 11, 2013 at 5:59 PM, Michael Treglia <mtreglia at gmail.com> wrote:
>
>> Hi Erin,
>>
>> Thanks for the quick response - I did try it with the plus sign, and same
>> result. (I also tried it with 'crs="+proj=longlat +ellps=GRS80"' with the
>> same result too.)
>>
>>
>> >  test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")
>> >  test
>> class       : RasterLayer
>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>> resolution  : 0.008333333, 0.008333333  (x, y)
>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : NA
>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>> names       : us_ppt_1981_2010.02
>> values      : -2147483648, 2147483647  (min, max)
>>
>> I'm running R Version 3.0.0, 64-bit, in case that helps at all...
>> Cheers,
>> Mike
>>
>>
>> On Thu, Jul 11, 2013 at 5:50 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>>
>>> Hi Michael:
>>>
>>> Did you try this;
>>>
>>> test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")
>>>
>>> with the plus sign, please?
>>>
>>> That might do it.
>>>
>>> Thanks,
>>> Erin
>>>
>>> ________________________________________
>>> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org]
>>> on behalf of Michael Treglia [mtreglia at gmail.com]
>>> Sent: Thursday, July 11, 2013 7:16 PM
>>> To: r-sig-geo at r-project.org
>>> Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
>>>
>>> Hi All,
>>>
>>> I am using he "raster" package, and in particular the "raster" function. I
>>> am dealing with a number of layers, and it would be easiest to set the CRS
>>> upon import. Looking through the documentation, it seems that it is
>>> doable,
>>> and I have been using the following code to get started, though it is not
>>> setting the CRS.
>>>
>>> Here are my code, and the results of the import:
>>> > test<-raster("us_ppt_1981_2010.02.asc", crs="ellps=GRS80")
>>> > test
>>> class       : RasterLayer
>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>> ymax)
>>> *coord. ref. : NA *
>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>> names       : us_ppt_1981_2010.02
>>> values      : -2147483648, 2147483647  (min, max)
>>>
>>> If I use the "projection" command afterwards, it sets the projection
>>> appropriately though.
>>> > projection(test)<-CRS("+proj=longlat +ellps=GRS80")
>>> > test
>>> class       : RasterLayer
>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>> ymax)
>>> *coord. ref. : +proj=longlat +ellps=GRS80 *
>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>> names       : us_ppt_1981_2010.02
>>> values      : -2147483648, 2147483647  (min, max)
>>>
>>> Any suggestions of why the first option is not working? I have a script in
>>> which I import all files in a folder, and the simplest way to assign the
>>> projection would be the first option (I'm using an 'lapply' command).
>>> It would look something like this:
>>> import <- lapply(filenames ,raster, crs="....") #where "filenames" is a
>>> vector of filenames in the working directory.
>>>
>>> In case it helps, these are PRISM Climate Data, and the header of my
>>> raster
>>> file is this:
>>> ncols 7025
>>> nrows 3105
>>> xllcorner -125.020833333333329
>>> yllcorner 24.062500000000000
>>> cellsize 0.008333333333333
>>> NODATA_value -9999
>>>
>>> Thanks for any suggestions!
>>> Mike
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From mtreglia at gmail.com  Fri Jul 12 03:21:22 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 11 Jul 2013 18:21:22 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
Message-ID: <CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/4aa3ddd8/attachment.pl>

From HodgessE at uhd.edu  Fri Jul 12 03:40:11 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 12 Jul 2013 01:40:11 +0000
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>,
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130712/8a6239f1/attachment.pl>

From mtreglia at gmail.com  Fri Jul 12 03:41:22 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 11 Jul 2013 18:41:22 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
Message-ID: <CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130711/6c2798bf/attachment.pl>

From mdsumner at gmail.com  Fri Jul 12 07:15:42 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 12 Jul 2013 15:15:42 +1000
Subject: [R-sig-Geo] map topology problem and solution (off-topic)
Message-ID: <CAAcGz99U9g9Dv+JCuTd1cDjjn9YSNCsb7w6y0eyeZOeLOYy7Tw@mail.gmail.com>

Hello,

This explanation and solution to a common problem is really excellent:

http://bost.ocks.org/mike/example/

While it's not R, I thought it would be of general interest to many on
this list, apologies for the noise otherwise.

Cheers, Mike.

-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From federicotomasetto at hotmail.it  Fri Jul 12 07:24:17 2013
From: federicotomasetto at hotmail.it (Federico Tomasetto)
Date: Fri, 12 Jul 2013 05:24:17 +0000
Subject: [R-sig-Geo] NMDS R2 goodness of fit statistic
In-Reply-To: <CAAcGz99U9g9Dv+JCuTd1cDjjn9YSNCsb7w6y0eyeZOeLOYy7Tw@mail.gmail.com>
References: <CAAcGz99U9g9Dv+JCuTd1cDjjn9YSNCsb7w6y0eyeZOeLOYy7Tw@mail.gmail.com>
Message-ID: <DUB107-W6072EAE4B5A8997A4DC306C8640@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130712/2038001f/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jul 12 10:00:01 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 12 Jul 2013 10:00:01 +0200
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>

On Fri, 12 Jul 2013, Michael Treglia wrote:

> Thanks for trying Erin!
> I appreciate knowing its not just me :-)

Are your raster package versions different? In current raster, 
R/rasterFromGDAL.R in line 129 sets crs="", and because in line 152 the 
assigned value in:

projection(r) <- attr(gdalinfo, 'projection')

is NA, you get what you see. My guess is that if your crs= argument is 
neither missing nor NA or the empty string, it should poverride 
attr(gdalinfo, 'projection').

Providing the version of your older installation of raster will help 
isolate when and which change has led to this outcome, but you do have a 
workaround. I can't see the offending revision in SCM in R-forge.

Roger

> -Mike
>
>
> On Thu, Jul 11, 2013 at 6:40 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>
>>  Hi again.
>>
>> It looks like the crs argument no longer works when creating a raster from
>> a file.  I've tried all kinds of "variations on the theme" also, but no
>> luck.
>>
>> Weird.
>>
>> Thanks
>> Erin
>>
>>  ------------------------------
>> *From:* Michael Treglia [mtreglia at gmail.com]
>> *Sent:* Thursday, July 11, 2013 8:21 PM
>> *To:* Michael Sumner
>> *Cc:* Hodgess, Erin; r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Problem Setting Projection of Rasters upon
>> Import
>>
>>    Hi,
>>  I apologize - I must have mistakenly copied/pasted only the last "t"
>>
>>  Here is how it was run, and the results, in R 3.0.0 (64-bit):
>>> test<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
>>> test
>> class       : RasterLayer
>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>> resolution  : 0.008333333, 0.008333333  (x, y)
>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : NA
>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>> names       : us_ppt_1981_2010.02
>> values      : -2147483648, 2147483647  (min, max)
>>
>>
>>  and in R 2.13.0 (also 64-bit):
>>> test<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
>>> test
>> class       : RasterLayer
>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>> resolution  : 0.008333333, 0.008333333  (x, y)
>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=longlat +ellps=GRS80
>> values      : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>
>>
>>
>>
>> On Thu, Jul 11, 2013 at 6:13 PM, Michael Sumner <mdsumner at gmail.com>wrote:
>>
>>> Please report on the actual code you ran, you've just sent two
>>> messages, one with
>>>
>>> test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")
>>>
>>>  this correctly cannot set the CRS and so it is NA
>>>
>>> and the other with
>>>
>>> t<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
>>>> test
>>>
>>>  We have no idea what you see in "t" now. In short you have to have a
>>> "+proj", not just a "+ellps" for this incantation. You can check with
>>>
>>> library(rgdal)
>>> CRS("+ellps=GRS80")
>>> Error in CRS("+ellps=GRS80") : projection not named
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Fri, Jul 12, 2013 at 11:10 AM, Michael Treglia <mtreglia at gmail.com>
>>> wrote:
>>>> I just tried running it in an older version of R, 2.13.0 (64-bit) and it
>>>> ran with no problem... the exact same code run from Notepad++
>>>>
>>>> Anybody know what has changed/if I need to adjust my for R 3.x.x?
>>>>
>>>> t<-raster("us_ppt_1981_2010.02.asc", crs="+proj=longlat +ellps=GRS80")
>>>>> test
>>>> class       : RasterLayer
>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : +proj=longlat +ellps=GRS80
>>>> values      : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>>>
>>>> Thanks again!
>>>> Mike
>>>>
>>>>
>>>> On Thu, Jul 11, 2013 at 5:59 PM, Michael Treglia <mtreglia at gmail.com>
>>> wrote:
>>>>
>>>>> Hi Erin,
>>>>>
>>>>> Thanks for the quick response - I did try it with the plus sign, and
>>> same
>>>>> result. (I also tried it with 'crs="+proj=longlat +ellps=GRS80"' with
>>> the
>>>>> same result too.)
>>>>>
>>>>>
>>>>>>  test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")
>>>>>>  test
>>>>> class       : RasterLayer
>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>> ymin,
>>>>> ymax)
>>>>> coord. ref. : NA
>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>>>> names       : us_ppt_1981_2010.02
>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>
>>>>> I'm running R Version 3.0.0, 64-bit, in case that helps at all...
>>>>> Cheers,
>>>>> Mike
>>>>>
>>>>>
>>>>> On Thu, Jul 11, 2013 at 5:50 PM, Hodgess, Erin <HodgessE at uhd.edu>
>>> wrote:
>>>>>
>>>>>> Hi Michael:
>>>>>>
>>>>>> Did you try this;
>>>>>>
>>>>>> test<-raster("us_ppt_1981_2010.02.asc", crs="+ellps=GRS80")
>>>>>>
>>>>>> with the plus sign, please?
>>>>>>
>>>>>> That might do it.
>>>>>>
>>>>>> Thanks,
>>>>>> Erin
>>>>>>
>>>>>> ________________________________________
>>>>>> From: r-sig-geo-bounces at r-project.org [
>>> r-sig-geo-bounces at r-project.org]
>>>>>> on behalf of Michael Treglia [mtreglia at gmail.com]
>>>>>> Sent: Thursday, July 11, 2013 7:16 PM
>>>>>> To: r-sig-geo at r-project.org
>>>>>> Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
>>>>>>
>>>>>> Hi All,
>>>>>>
>>>>>> I am using he "raster" package, and in particular the "raster"
>>> function. I
>>>>>> am dealing with a number of layers, and it would be easiest to set
>>> the CRS
>>>>>> upon import. Looking through the documentation, it seems that it is
>>>>>> doable,
>>>>>> and I have been using the following code to get started, though it is
>>> not
>>>>>> setting the CRS.
>>>>>>
>>>>>> Here are my code, and the results of the import:
>>>>>>> test<-raster("us_ppt_1981_2010.02.asc", crs="ellps=GRS80")
>>>>>>> test
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>> ymin,
>>>>>> ymax)
>>>>>> *coord. ref. : NA *
>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>>>>> names       : us_ppt_1981_2010.02
>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>
>>>>>> If I use the "projection" command afterwards, it sets the projection
>>>>>> appropriately though.
>>>>>>> projection(test)<-CRS("+proj=longlat +ellps=GRS80")
>>>>>>> test
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>> ymin,
>>>>>> ymax)
>>>>>> *coord. ref. : +proj=longlat +ellps=GRS80 *
>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_ppt_1981_2010.02.asc
>>>>>> names       : us_ppt_1981_2010.02
>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>
>>>>>> Any suggestions of why the first option is not working? I have a
>>> script in
>>>>>> which I import all files in a folder, and the simplest way to assign
>>> the
>>>>>> projection would be the first option (I'm using an 'lapply' command).
>>>>>> It would look something like this:
>>>>>> import <- lapply(filenames ,raster, crs="....") #where "filenames" is
>>> a
>>>>>> vector of filenames in the working directory.
>>>>>>
>>>>>> In case it helps, these are PRISM Climate Data, and the header of my
>>>>>> raster
>>>>>> file is this:
>>>>>> ncols 7025
>>>>>> nrows 3105
>>>>>> xllcorner -125.020833333333329
>>>>>> yllcorner 24.062500000000000
>>>>>> cellsize 0.008333333333333
>>>>>> NODATA_value -9999
>>>>>>
>>>>>> Thanks for any suggestions!
>>>>>> Mike
>>>>>>
>>>>>>         [[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>>  --
>>> Michael Sumner
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From amen.alyaari at bordeaux.inra.fr  Fri Jul 12 18:07:34 2013
From: amen.alyaari at bordeaux.inra.fr (Amen Alyaari)
Date: Fri, 12 Jul 2013 18:07:34 +0200
Subject: [R-sig-Geo] apply help
Message-ID: <51E029C6.3010909@bordeaux.inra.fr>

Hello All,

There are 600 (global map)files (1440 sample * 720 lines)in three 
directories dir1 and dir2,and dir3 (600 files in each directory) which 
have the same format ,byte,extend,etc.
  I computed the `err` between three datasets using the function and 
code given below as follows:


  function:

        err<-function(pred,obs,mod,na.rm=TRUE){
             sqrt(mean(((pred-obs)*(pred-mod)), na.rm = na.rm))}

read the files:

         dir1 <- list.files("/donnees/notghi", "*.img", full.names = TRUE)
         dir2 <- list.files("/donnees/baieSt", "*.img", full.names = TRUE)
         dir3 <- list.files("/donnees/modt", "*.img", full.names = TRUE)
  code:

         file_tot<-array(dim=c(1440,720,600,3))## worked well
    for(i in 1:length(dir3)){
   file_tot[,,i,1] <- readBin(dir1[i], double(), size = 4 ,n = 1440* 720 
, signed = T)
   file_tot[,,i,2] <- readBin(dir2[i], double(), size = 4 ,n = 1440 * 
720, signed = T)
    file_tot[,,i,3] <- readBin(dir3[i], double(), size = 4 ,n = 1440 * 
720, signed = T)
     }

Now compute based on the function:

  result<-apply(file_tot,c(1,3),function(x){err(x[,1],x[,2],x[,3])})

               Is this line right?

This worked without errors but I checked the results and they were crap:
-the size of the was 3859kb instead of 4050kb.
-it should by a global map with some values over lane but I got map of 
just horizontal lines

  may be: indices or confusing choice of margin with value of index

Any help

Cheers,

-- 
Amen Alyaari, UPMC
PhD student
Unit of Functional Ecology&  Environmental Physics [EPHYSE]
National Institute of Agricultural Research [INRA].
71, Avenue Edouard Bourlaux
33140 Villenave d'Ornon
T?l?phone : +33(0) 5 57 12 24 27
Fax : +33 (0)5 57 12 24 20
FRANCE


From mtreglia at gmail.com  Fri Jul 12 20:39:30 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 12 Jul 2013 11:39:30 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
	<alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
Message-ID: <CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130712/c58690c3/attachment.pl>

From mtreglia at gmail.com  Fri Jul 12 23:55:23 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 12 Jul 2013 14:55:23 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
	<alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
	<CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>
Message-ID: <CAPKp32tpcXBuzLBMk0nie+yS4XBp0tpCquvhBKRgsopmLcYt8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130712/b0788f0e/attachment.pl>

From r.hijmans at gmail.com  Sat Jul 13 01:29:21 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 12 Jul 2013 16:29:21 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CAPKp32tpcXBuzLBMk0nie+yS4XBp0tpCquvhBKRgsopmLcYt8g@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
	<alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
	<CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>
	<CAPKp32tpcXBuzLBMk0nie+yS4XBp0tpCquvhBKRgsopmLcYt8g@mail.gmail.com>
Message-ID: <CANtt_hyZ3QyPdsfWttE5=nqrDKAyiVuPL3cvjG8HHHH1S3UyNQ@mail.gmail.com>

Michael,

I did not try it, but I think the below accomplishes the same. If at
all possible, you should avoid using ascii format files (that leads to
slow processing).

library(raster)
reference <- raster("D:/GIS/California/Hab Suitability
Files/10m_DEM/10m DEMasc/DEM_10m.asc")
projection(reference) <- "+proj=longlat +ellps=GRS80"

setwd("D:/GIS/PRISM/1981-2010/TMin")
s <- stack(list.files(pattern="*.asc", full.names=TRUE))
projection(s) <- "+proj=longlat +ellps=GRS80"
x <- crop(s, reference)
y <- projectRaster(x, crs="+proj=utm +zone=11 +datum=WGS84", res=800,
filename="TMinCrop.tif")

#if you need separate files you could use
writeRaster(y, .... , bylayer=TRUE)


As for setting the crs when creating a Raster object from file with
the raster function. I removed that because it is was some
inconsistent and misinterpreted. I will put it back in, allowing to
set the crs if it is unknown (as with esri ascii files), but not to
change it if the file supplies one.

Robert

On Fri, Jul 12, 2013 at 2:55 PM, Michael Treglia <mtreglia at gmail.com> wrote:
> Hi All,
>
> Thank you again for the suggestions and assistance. I used the work-around
> provided by Roger and Erin, and I've included the full function I was
> working on in case others find it useful.
>
> Basically, I've written this function to crop a bunch of ascii raster
> layers (.asc) in the working directory to the same extents as another
> raster layer (given that they are all in the same projection), then modify
> the projection and grain size of the cropped layers, as desired, and output
> them to new files in the working directory. In particular, I've been using
> this to reduce large raster grids from PRISM Climate Data to a focal area
> for which I need the data. The function can easily be modified to use
> different file types too...
>
> I'm all ears to improve the code...  Depending on the size of your datasets
> it might take a few minutes to run.  It does end up with a lot of data in
> memory for large files, so it would be great to hear any suggestions for
> dealing with that.
>
> #########################################
> #BatchCrop Function ###
> #by Mike Treglia, mtreglia at gmail.com ###
> ###Tested in R Version 3.0.0 (64-bit), using 'raster' version 2.1-48 and
> 'rgdal' version 0.8-10 ###
> ########################################
>
> #Function crops .asc raster files in working directory to extent of another
> layer (referred to here as 'reference' layer), converts to desired
> projection, and saves as new .asc files in the working directory. It is
> important that the original raster files and the reference layer are all in
> the same projection, though different pixel sizes are OK. Function can
> easily be modified to use other raster formats as well
>
> #Requires package 'raster'
>
> #Function Arguments:
> #'Reference'  refers to name of the layer with the desired extent;
> 'OutName' represents the intended prefix for output files; 'OutPrj'
> represents the desired output projection; and 'OutRes' represents the
> desired Output Resolution
>
> BatchCrop<-function(Reference,OutName,OutPrj,OutRes){
>             filenames <- list.files(pattern="*.asc", full.names=TRUE)
> #Extract list of  file names from working directory
>             library(raster)    #Calls 'raster' library
>
>             #Function 'f1' imports data listed in 'filenames' and assigns
> projection
>                 f1<-function(x,z) {
>                 y <- raster(x)
>                 projection(y) <- CRS(z)
>                 return(y)
>                 }
>                 import <- lapply(filenames,f1,projection(Reference))
>
>             cropped <- lapply(import,crop,Reference)    #Crop imported
> layers to reference layer, argument 'x'
>
>             #Function 'f2' changes projectection of cropped layers
>                 f2<-function(x,y) {
>                 x<-projectRaster(x, crs=OutPrj, res=OutRes)
>                 return(x)
>                 }
>                 output <- lapply(cropped,f2,OutPrj)
>
>             #Use a 'for' loop to iterate writeRaster function for all
> cropped layers
>             for(i in (1:max(length(filenames)))){            #
>                 writeRaster(output[[i]],paste(deparse(substitute(OutName)),
> i), format='ascii')
>                 }
>                 }
> #############################################
> ###Example Code using function 'BatchCrop'###
> #############################################
>
> #Data layers to be cropped downloaded from:
> http://www.prism.oregonstate.edu/products/matrix.phtml?vartype=tmax&view=maps[testing
> was done using 1981-2010 monthly and annual normals; can use any
> .asc layer within the bounds of the PRISM data, with projection as lat/long
> and GRS80]
> #Set Working Directory where data to be cropped are stored
> setwd("D:/GIS/PRISM/1981-2010/TMin")
>
> #Import Reference Layer
> reference<-raster("D:/GIS/California/Hab Suitability Files/10m_DEM/10m DEM
> asc/DEM_10m.asc")
> #Set Projection for Reference Layer
> projection(reference) <- CRS("+proj=longlat +ellps=GRS80")
>
> #Run Function
> BatchCrop(Reference=reference,OutName=TMinCrop,OutPrj="+proj=utm +zone=11
> +datum=WGS84",OutRes=800)
>
>
>
> On Fri, Jul 12, 2013 at 11:39 AM, Michael Treglia <mtreglia at gmail.com>wrote:
>
>> Hi Roger,
>>
>> In R 2.13.0, it is Raster version 1.9-70; in R 3.0.0 it is Raster version
>> 2.1-48
>>
>> When running in R 3.0.0, upon running the 'raster' command, it loads the
>> rgdal package... whereas in R 2.13.0, I don't even have the rgdal package
>> installed. I guess in the previous version of Raster, it actually housed
>> gdal commands or something of the sort, whereas now it does not?
>>
>> Thanks for your help!
>> Mike
>>
>>
>> On Fri, Jul 12, 2013 at 1:00 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> On Fri, 12 Jul 2013, Michael Treglia wrote:
>>>
>>>  Thanks for trying Erin!
>>>> I appreciate knowing its not just me :-)
>>>>
>>>
>>> Are your raster package versions different? In current raster,
>>> R/rasterFromGDAL.R in line 129 sets crs="", and because in line 152 the
>>> assigned value in:
>>>
>>> projection(r) <- attr(gdalinfo, 'projection')
>>>
>>> is NA, you get what you see. My guess is that if your crs= argument is
>>> neither missing nor NA or the empty string, it should poverride
>>> attr(gdalinfo, 'projection').
>>>
>>> Providing the version of your older installation of raster will help
>>> isolate when and which change has led to this outcome, but you do have a
>>> workaround. I can't see the offending revision in SCM in R-forge.
>>>
>>> Roger
>>>
>>>  -Mike
>>>>
>>>>
>>>> On Thu, Jul 11, 2013 at 6:40 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>>>>
>>>>   Hi again.
>>>>>
>>>>> It looks like the crs argument no longer works when creating a raster
>>>>> from
>>>>> a file.  I've tried all kinds of "variations on the theme" also, but no
>>>>> luck.
>>>>>
>>>>> Weird.
>>>>>
>>>>> Thanks
>>>>> Erin
>>>>>
>>>>>  ------------------------------
>>>>> *From:* Michael Treglia [mtreglia at gmail.com]
>>>>> *Sent:* Thursday, July 11, 2013 8:21 PM
>>>>> *To:* Michael Sumner
>>>>> *Cc:* Hodgess, Erin; r-sig-geo at r-project.org
>>>>> *Subject:* Re: [R-sig-Geo] Problem Setting Projection of Rasters upon
>>>>>
>>>>> Import
>>>>>
>>>>>    Hi,
>>>>>  I apologize - I must have mistakenly copied/pasted only the last "t"
>>>>>
>>>>>  Here is how it was run, and the results, in R 3.0.0 (64-bit):
>>>>>
>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+proj=longlat
>>>>>> +ellps=GRS80")
>>>>>> test
>>>>>>
>>>>> class       : RasterLayer
>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>>>> ymax)
>>>>> coord. ref. : NA
>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>> names       : us_ppt_1981_2010.02
>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>
>>>>>
>>>>>  and in R 2.13.0 (also 64-bit):
>>>>>
>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+proj=longlat
>>>>>> +ellps=GRS80")
>>>>>> test
>>>>>>
>>>>> class       : RasterLayer
>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>>>> ymax)
>>>>> coord. ref. : +proj=longlat +ellps=GRS80
>>>>> values      : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Thu, Jul 11, 2013 at 6:13 PM, Michael Sumner <mdsumner at gmail.com
>>>>> >wrote:
>>>>>
>>>>>  Please report on the actual code you ran, you've just sent two
>>>>>> messages, one with
>>>>>>
>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>
>>>>>>  this correctly cannot set the CRS and so it is NA
>>>>>>
>>>>>> and the other with
>>>>>>
>>>>>> t<-raster("us_ppt_1981_2010.**02.asc", crs="+proj=longlat
>>>>>> +ellps=GRS80")
>>>>>>
>>>>>>> test
>>>>>>>
>>>>>>
>>>>>>  We have no idea what you see in "t" now. In short you have to have a
>>>>>> "+proj", not just a "+ellps" for this incantation. You can check with
>>>>>>
>>>>>> library(rgdal)
>>>>>> CRS("+ellps=GRS80")
>>>>>> Error in CRS("+ellps=GRS80") : projection not named
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Fri, Jul 12, 2013 at 11:10 AM, Michael Treglia <mtreglia at gmail.com>
>>>>>> wrote:
>>>>>>
>>>>>>> I just tried running it in an older version of R, 2.13.0 (64-bit) and
>>>>>>> it
>>>>>>> ran with no problem... the exact same code run from Notepad++
>>>>>>>
>>>>>>> Anybody know what has changed/if I need to adjust my for R 3.x.x?
>>>>>>>
>>>>>>> t<-raster("us_ppt_1981_2010.**02.asc", crs="+proj=longlat
>>>>>>> +ellps=GRS80")
>>>>>>>
>>>>>>>> test
>>>>>>>>
>>>>>>> class       : RasterLayer
>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>> ymin,
>>>>>>> ymax)
>>>>>>> coord. ref. : +proj=longlat +ellps=GRS80
>>>>>>> values      : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>
>>>>>>> Thanks again!
>>>>>>> Mike
>>>>>>>
>>>>>>>
>>>>>>> On Thu, Jul 11, 2013 at 5:59 PM, Michael Treglia <mtreglia at gmail.com>
>>>>>>>
>>>>>> wrote:
>>>>>>
>>>>>>>
>>>>>>>  Hi Erin,
>>>>>>>>
>>>>>>>> Thanks for the quick response - I did try it with the plus sign, and
>>>>>>>>
>>>>>>> same
>>>>>>
>>>>>>> result. (I also tried it with 'crs="+proj=longlat +ellps=GRS80"' with
>>>>>>>>
>>>>>>> the
>>>>>>
>>>>>>> same result too.)
>>>>>>>>
>>>>>>>>
>>>>>>>>   test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>>>>  test
>>>>>>>>>
>>>>>>>> class       : RasterLayer
>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>
>>>>>>> ymin,
>>>>>>
>>>>>>> ymax)
>>>>>>>> coord. ref. : NA
>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>
>>>>>>>> I'm running R Version 3.0.0, 64-bit, in case that helps at all...
>>>>>>>> Cheers,
>>>>>>>> Mike
>>>>>>>>
>>>>>>>>
>>>>>>>> On Thu, Jul 11, 2013 at 5:50 PM, Hodgess, Erin <HodgessE at uhd.edu>
>>>>>>>>
>>>>>>> wrote:
>>>>>>
>>>>>>>
>>>>>>>>  Hi Michael:
>>>>>>>>>
>>>>>>>>> Did you try this;
>>>>>>>>>
>>>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>>>>
>>>>>>>>> with the plus sign, please?
>>>>>>>>>
>>>>>>>>> That might do it.
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> Erin
>>>>>>>>>
>>>>>>>>> ______________________________**__________
>>>>>>>>> From: r-sig-geo-bounces at r-project.**org<r-sig-geo-bounces at r-project.org>[
>>>>>>>>>
>>>>>>>> r-sig-geo-bounces at r-project.**org <r-sig-geo-bounces at r-project.org>]
>>>>>>
>>>>>>> on behalf of Michael Treglia [mtreglia at gmail.com]
>>>>>>>>> Sent: Thursday, July 11, 2013 7:16 PM
>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>> Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon
>>>>>>>>> Import
>>>>>>>>>
>>>>>>>>> Hi All,
>>>>>>>>>
>>>>>>>>> I am using he "raster" package, and in particular the "raster"
>>>>>>>>>
>>>>>>>> function. I
>>>>>>
>>>>>>> am dealing with a number of layers, and it would be easiest to set
>>>>>>>>>
>>>>>>>> the CRS
>>>>>>
>>>>>>> upon import. Looking through the documentation, it seems that it is
>>>>>>>>> doable,
>>>>>>>>> and I have been using the following code to get started, though it
>>>>>>>>> is
>>>>>>>>>
>>>>>>>> not
>>>>>>
>>>>>>> setting the CRS.
>>>>>>>>>
>>>>>>>>> Here are my code, and the results of the import:
>>>>>>>>>
>>>>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="ellps=GRS80")
>>>>>>>>>> test
>>>>>>>>>>
>>>>>>>>> class       : RasterLayer
>>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>>
>>>>>>>> ymin,
>>>>>>
>>>>>>> ymax)
>>>>>>>>> *coord. ref. : NA *
>>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>>
>>>>>>>>> If I use the "projection" command afterwards, it sets the projection
>>>>>>>>> appropriately though.
>>>>>>>>>
>>>>>>>>>> projection(test)<-CRS("+proj=**longlat +ellps=GRS80")
>>>>>>>>>> test
>>>>>>>>>>
>>>>>>>>> class       : RasterLayer
>>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>>
>>>>>>>> ymin,
>>>>>>
>>>>>>> ymax)
>>>>>>>>> *coord. ref. : +proj=longlat +ellps=GRS80 *
>>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>>
>>>>>>>>> Any suggestions of why the first option is not working? I have a
>>>>>>>>>
>>>>>>>> script in
>>>>>>
>>>>>>> which I import all files in a folder, and the simplest way to assign
>>>>>>>>>
>>>>>>>> the
>>>>>>
>>>>>>> projection would be the first option (I'm using an 'lapply' command).
>>>>>>>>> It would look something like this:
>>>>>>>>> import <- lapply(filenames ,raster, crs="....") #where "filenames"
>>>>>>>>> is
>>>>>>>>>
>>>>>>>> a
>>>>>>
>>>>>>> vector of filenames in the working directory.
>>>>>>>>>
>>>>>>>>> In case it helps, these are PRISM Climate Data, and the header of my
>>>>>>>>> raster
>>>>>>>>> file is this:
>>>>>>>>> ncols 7025
>>>>>>>>> nrows 3105
>>>>>>>>> xllcorner -125.020833333333329
>>>>>>>>> yllcorner 24.062500000000000
>>>>>>>>> cellsize 0.008333333333333
>>>>>>>>> NODATA_value -9999
>>>>>>>>>
>>>>>>>>> Thanks for any suggestions!
>>>>>>>>> Mike
>>>>>>>>>
>>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>>
>>>>>>>>> ______________________________**_________________
>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> ______________________________**_________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>  --
>>>>>> Michael Sumner
>>>>>> Hobart, Australia
>>>>>> e-mail: mdsumner at gmail.com
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________**_________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Sat Jul 13 01:44:34 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 12 Jul 2013 16:44:34 -0700
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
In-Reply-To: <CABkCotTrJNpb2h9-J25GNPDLXXp7iuMn6GbrfLOsvb7qN3=ZJQ@mail.gmail.com>
References: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
	<51DE589D.20301@jrc.ec.europa.eu>
	<CABkCotTrJNpb2h9-J25GNPDLXXp7iuMn6GbrfLOsvb7qN3=ZJQ@mail.gmail.com>
Message-ID: <CANtt_hzdDA9nV4GzQ6OZrSf2pfaexevV2And1i-kZ=w1+p0_CA@mail.gmail.com>

I do not the data have changed. Wrong min and max values are reported,
however. Seems to me that in this case gdal does not know the min and
max values but reports  -2147483648, 2147483647. You could check with
GDALinfo. I guess that this is a  shortcoming of (your version of?)
gdal, not rgdal. Robert

On Thu, Jul 11, 2013 at 5:04 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Thank you Mauricio.
>
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets  methods
> base
>
> other attached packages:
> [1] SDMTools_1.1-13 dismo_0.8-11    raster_2.1-37   rgdal_0.8-10
>  maptools_0.8-25
> [6] lattice_0.20-15 sp_1.0-11       foreign_0.8-54
>
> loaded via a namespace (and not attached):
> [1] tools_3.0.1
>
>
> 2013/7/11 Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu>
>
>> On 10/07/13 18:38, Manuel Sp?nola wrote:
>>
>>> Dear list members,
>>>
>>> I am trying to export a raster file to a ascii file (.asc) but the min and
>>> max values are not the same. Any idea why?
>>>
>>
>> Hi Manuel,
>>
>> Could you provide your sessionInfo() ?
>>
>>>
>>>  bio1res
>>>>
>>> class       : RasterLayer
>>> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : NA
>>> data source : in memory
>>> names       : bio1_23
>>> values      : 47, 272  (min, max)
>>>
>>>  writeRaster(bio1res, filename="temp.asc", format="ascii",overwrite=TRUE)
>>>>
>>> class       : RasterLayer
>>> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin,
>>> ymax)
>>> coord. ref. : NA
>>> data source : /Users/manuelspinola/Dropbox/**Distribucio? n de
>>>
>>> especies/World_Clim_Costa_**Rica/temp.asc
>>> names       : temp
>>> values      : -2147483648, 2147483647  (min, max)
>>>
>>
>> Unfortunately, your example is not reproducible, so I tried with a
>> different example and the values in the original and the written ascii file
>> were the same (rgdal_0.8-10, raster_2.1-48, sp_1.0-11):
>>
>> ----------  START --------------
>> library(raster)
>> Loading required package: sp
>>
>> # Creation of a raster file for testing
>> r <- raster(system.file("external/**test.grd", package="raster"))
>>
>> r
>> #class       : RasterLayer
>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>> #resolution  : 40, 40  (x, y)
>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>> #coord. ref. : +init=epsg:28992 +towgs84=565.237,50.0087,465.**
>> 658,-0.406857,0.350733,-1.**87035,4.0812 +proj=sterea
>> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000
>> +y_0=463000 +ellps=bessel +units=m +no_defs
>> #data source : /usr/lib64/R/library/raster/**external/test.grd
>> #names       : test
>> #values      : 128.434, 1805.78  (min, max)
>>
>> writeRaster(r, filename="temp.asc", format="ascii",overwrite=TRUE)
>> #rgdal: version: 0.8-10, (SVN revision 478)
>> #Geospatial Data Abstraction Library extensions to R successfully loaded
>> #Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> #Path to GDAL shared files: /usr/share/gdal
>> #Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> #Path to PROJ.4 shared files: (autodetected)
>> #class       : RasterLayer
>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>> #resolution  : 40, 40  (x, y)
>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>> #coord. ref. : NA
>> #data source : /home/zambrhe/temp.asc
>> #names       : temp
>>
>> # reading the .asc file form disk
>> r2 <- raster("temp.asc")
>>
>> r2
>> #class       : RasterLayer
>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>> #resolution  : 40, 40  (x, y)
>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>> #coord. ref. : NA
>> #data source : /home/zambrhe/temp.asc
>> #names       : temp
>>
>> # Summary of the ascii file in the hard disk
>> #summary(r2)
>> #             temp
>> #Min.     128.4340
>> #1st Qu.  293.2325
>> #Median   371.4120
>> #3rd Qu.  499.8195
>> #Max.    1805.7800
>> #NA's    6097.0000
>>
>>
>> # Summary of the original raster file
>> summary(r)
>> #             test
>> #Min.     128.4340
>> #1st Qu.  293.2325
>> #Median   371.4120
>> #3rd Qu.  499.8195
>> #Max.    1805.7800
>> #NA's    6097.0000
>> ----------  END --------------
>>
>> Kind regards,
>>
>> Mauricio Zambrano-Bigiarini, Ph.D
>>
>> --
>> ==============================**===================
>> Water Resources Unit
>> Institute for Environment and Sustainability (IES)
>> Joint Research Centre (JRC), European Commission
>> TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
>> Work Phone : +39 0332 789588
>> webinfo    : http://floods.jrc.ec.europa.**eu/<http://floods.jrc.ec.europa.eu/>
>> ==============================**===================
>> DISCLAIMER:
>> "The views expressed are purely those of the writer
>> and may not in any circumstances be regarded as sta-
>> ting an official position of the European Commission"
>> ==============================**===================
>> "The journey is the reward"  (Steve Jobs)
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mtreglia at gmail.com  Sat Jul 13 01:53:54 2013
From: mtreglia at gmail.com (Michael Treglia)
Date: Fri, 12 Jul 2013 16:53:54 -0700
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
In-Reply-To: <CANtt_hyZ3QyPdsfWttE5=nqrDKAyiVuPL3cvjG8HHHH1S3UyNQ@mail.gmail.com>
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
	<alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
	<CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>
	<CAPKp32tpcXBuzLBMk0nie+yS4XBp0tpCquvhBKRgsopmLcYt8g@mail.gmail.com>
	<CANtt_hyZ3QyPdsfWttE5=nqrDKAyiVuPL3cvjG8HHHH1S3UyNQ@mail.gmail.com>
Message-ID: <CAPKp32u_SyF_EAm+49Zp2v6AG6uA4Yiwp2+JMBnE0TOoqMWQ7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130712/58d5f495/attachment.pl>

From alexandresantosbr at yahoo.com.br  Sat Jul 13 16:54:08 2013
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Sat, 13 Jul 2013 10:54:08 -0400
Subject: [R-sig-Geo] Extracting mean spectra from RasterLayer
Message-ID: <51E16A10.7010409@yahoo.com.br>

Dear list member,

        I make a simple simulation of landsat band and I intended to 
extracting the mean spectra from a band3.DOS4refl objec create after 
atmospheric and radiometric simulation, for this I make:

require(raster)
require(sp)
require(rgdal)
require(landsat)
#
#Create raster
r <- raster(nc=1000, nr=1000)
set.seed(20130622)
stackIm1 <- stack(lapply(1, function(x) setValues(r, 
round(runif(ncell(r))* 255))))## Simulation band
#
# define projection system
r.geo <- CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m +no_defs") 
# geographical datum WGS84
proj4string(stackIm1) <- r.geo
#
#Create geotiff
writeRaster(stackIm1, 
filename="stackIm1.tif",format="GTiff",overwrite=TRUE, bylayer=TRUE)
#
# Atmospheric and radiometric correction
dia<-125#Day order 06/05/2010
isun<-23.45*sin(360*((284+dia)/365)) #Sun inclination
#
#
# Read tif object created
r1<-raster(c("stackIm1.tif"))
r1.grid<- as(r1, 'SpatialGridDataFrame')
#
#That SHV (45) "very clear day" is then used in DOS() to end the 
corrected SHV values for the remaining bands
#
# Hypothetical band 1
band1.DOS <- DOS(sat = 5, SHV = 45, SHV.band = 1, Grescale = 0.765827, 
Brescale = -2.29, sunelev = isun, edist = ESdist("2010-05-06"))
band1.DOS <- band1.DOS[["DNfinal.mean"]]## Coefficients results
#
## Simulation band 3 correction
band3.DOS4refl<-radiocorr(r1.grid, Grescale=0.120354, Brescale=-0.49, 
sunelev=isun, satzenith = 0, edist=ESdist("2010-05-06"), Esun=220.0, 
Lhaze = band1.DOS[3,1], method = "DOS4")
image(band3.DOS4refl)

but I ask, if there are any function for extracting mean spectra from 
band3.DOS4refl object?

Thanks

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 8132-8112 (TIM)   (+55) 65 9686-6970 (VIVO)

         alexandre.santos at cas.ifmt.edu.br


From blows_michael at yahoo.com  Sat Jul 13 20:18:52 2013
From: blows_michael at yahoo.com (Michael Blows)
Date: Sat, 13 Jul 2013 11:18:52 -0700 (PDT)
Subject: [R-sig-Geo] Exponential Distance Decaay function (typo?)
In-Reply-To: <alpine.LRH.2.03.1307101604580.21897@reclus.nhh.no>
References: <001601ce7d73$c29f3d90$47ddb8b0$@aubineau.gds35@reseaugds.com>
	<alpine.LRH.2.03.1307101604580.21897@reclus.nhh.no>
Message-ID: <1373739532.89314.YahooMailNeo@web161206.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130713/27dc0905/attachment.pl>

From paolo.piras at uniroma3.it  Sun Jul 14 01:34:25 2013
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Sat, 13 Jul 2013 23:34:25 +0000
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <CAFEqCdzRxO8RYd2AVOeu0miyZeBp39VzvVOV2KuTFPnw=6Uwvg@mail.gmail.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>,
	<CAFEqCdzRxO8RYd2AVOeu0miyZeBp39VzvVOV2KuTFPnw=6Uwvg@mail.gmail.com>
Message-ID: <A7557249237BD449977E3AEE33C62AD340DC0320@DBXPRD0410MB394.eurprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130713/bed9cb29/attachment.pl>

From ipaajs at gmail.com  Sun Jul 14 14:33:47 2013
From: ipaajs at gmail.com (ipampa)
Date: Sun, 14 Jul 2013 05:33:47 -0700 (PDT)
Subject: [R-sig-Geo] assign a slot to a name (character) in loop
Message-ID: <1373805227267-7584131.post@n2.nabble.com>


I have been struggling for a long time with this, and I still don?t know how
to achieve it.

I have many databases that I want to cut and put in different objects and I
would need to be able to use the function get() before the assignment. I
mean I need the last loop of this script to work:


################ data ################
library(sp)
grd <- GridTopology(c(1,1), c(1,1), c(3,3))
polys <- as.SpatialPolygons.GridTopology(grd)
centroids <- getSpPPolygonsLabptSlots(polys)
x <- centroids[,1]
y <- centroids[,2]
z <- 1.4 + 0.1*x + 0.2*y + 0.002*x*x
map <- SpatialPolygonsDataFrame(polys, 
                                data=data.frame(x=x, y=y, z=z,                                
row.names=getSpPPolygonsIDSlots(polys)))


########## my case ##############
new.data1<-data.frame(x=x, y=y, z=z*2,
row.names=getSpPPolygonsIDSlots(polys))
new.data2<-data.frame(x=x, y=y, z=z/2,
row.names=getSpPPolygonsIDSlots(polys))
datas<-c("new.data1","new.data2")
maps<-c("map1","map2")

##################################
######### help please!!! ###############
##################################
for(i in 1:length(datas)){
  slot(get(maps[i]),"data")<-get(datas[i])
}


anybody any suggestions??
thanks million

Iosu





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/assign-a-slot-to-a-name-character-in-loop-tp7584131.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Xi.Chen at quinnipiac.edu  Mon Jul 15 05:54:01 2013
From: Xi.Chen at quinnipiac.edu (Chen, Xi Prof.)
Date: Mon, 15 Jul 2013 03:54:01 +0000
Subject: [R-sig-Geo] Spatial panel Durbin model
Message-ID: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>

Hi,
Is there a package that can run spatial panel durbin model in r?

Thanks.

From Rainer at krugs.de  Mon Jul 15 09:04:04 2013
From: Rainer at krugs.de (Rainer M Krug)
Date: Mon, 15 Jul 2013 09:04:04 +0200
Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon Import
References: <CAPKp32s2eXgbO5mtZ_-3RfTBobFqQoCNhUqAXC5c=RukRhBCWA@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16338@columbia.uhd.campus>
	<CAPKp32uH5uJyVTNqhsYTqy6WKWwJ9CmcFuXzOYkZ=4daxCqY2w@mail.gmail.com>
	<CAPKp32sJ+JvdMBFftjMnNc6ZOkYk0apEd=Bwiy2DvjwtjORTRA@mail.gmail.com>
	<CAAcGz98RaYW-QfkDAirBdD79a=bHDwm+J_hiQy5J-17tkbFM9Q@mail.gmail.com>
	<CAPKp32tCSZbSgPRG4U=zU5zZVLsHYGSMVfvXccSWqBpHJe3ppw@mail.gmail.com>
	<FF9DB805FC41CC4E95825A50F680630217A16398@columbia.uhd.campus>
	<CAPKp32sdRMjP94=Z-uMMZZiSAEnkT=vsJ2GPtH7BjMxaSZTLAQ@mail.gmail.com>
	<alpine.LRH.2.03.1307120950200.6954@reclus.nhh.no>
	<CAPKp32u=dDMfPH4hdNaW4yhNDrzVrW0H2zPD_7JynTisRzF+4g@mail.gmail.com>
	<CAPKp32tpcXBuzLBMk0nie+yS4XBp0tpCquvhBKRgsopmLcYt8g@mail.gmail.com>
	<CANtt_hyZ3QyPdsfWttE5=nqrDKAyiVuPL3cvjG8HHHH1S3UyNQ@mail.gmail.com>
Message-ID: <m2vc4cs3rv.fsf@krugs.de>

"Robert J. Hijmans" <r.hijmans at gmail.com> writes:

> Michael,
>
> I did not try it, but I think the below accomplishes the same. If at
> all possible, you should avoid using ascii format files (that leads to
> slow processing).
>
> library(raster)
> reference <- raster("D:/GIS/California/Hab Suitability
> Files/10m_DEM/10m DEMasc/DEM_10m.asc")
> projection(reference) <- "+proj=longlat +ellps=GRS80"
>
> setwd("D:/GIS/PRISM/1981-2010/TMin")
> s <- stack(list.files(pattern="*.asc", full.names=TRUE))
> projection(s) <- "+proj=longlat +ellps=GRS80"
> x <- crop(s, reference)
> y <- projectRaster(x, crs="+proj=utm +zone=11 +datum=WGS84", res=800,
> filename="TMinCrop.tif")
>
> #if you need separate files you could use
> writeRaster(y, .... , bylayer=TRUE)
>
>
> As for setting the crs when creating a Raster object from file with
> the raster function. I removed that because it is was some
> inconsistent and misinterpreted. I will put it back in, allowing to
> set the crs if it is unknown (as with esri ascii files), but not to
> change it if the file supplies one.

I would suggest to add a warning when trying to set a crs when it is
already supplied by the file. This would make the behavior clearer.

Rainer

>
> Robert
>
> On Fri, Jul 12, 2013 at 2:55 PM, Michael Treglia <mtreglia at gmail.com> wrote:
>> Hi All,
>>
>> Thank you again for the suggestions and assistance. I used the work-around
>> provided by Roger and Erin, and I've included the full function I was
>> working on in case others find it useful.
>>
>> Basically, I've written this function to crop a bunch of ascii raster
>> layers (.asc) in the working directory to the same extents as another
>> raster layer (given that they are all in the same projection), then modify
>> the projection and grain size of the cropped layers, as desired, and output
>> them to new files in the working directory. In particular, I've been using
>> this to reduce large raster grids from PRISM Climate Data to a focal area
>> for which I need the data. The function can easily be modified to use
>> different file types too...
>>
>> I'm all ears to improve the code...  Depending on the size of your datasets
>> it might take a few minutes to run.  It does end up with a lot of data in
>> memory for large files, so it would be great to hear any suggestions for
>> dealing with that.
>>
>> #########################################
>> #BatchCrop Function ###
>> #by Mike Treglia, mtreglia at gmail.com ###
>> ###Tested in R Version 3.0.0 (64-bit), using 'raster' version 2.1-48 and
>> 'rgdal' version 0.8-10 ###
>> ########################################
>>
>> #Function crops .asc raster files in working directory to extent of another
>> layer (referred to here as 'reference' layer), converts to desired
>> projection, and saves as new .asc files in the working directory. It is
>> important that the original raster files and the reference layer are all in
>> the same projection, though different pixel sizes are OK. Function can
>> easily be modified to use other raster formats as well
>>
>> #Requires package 'raster'
>>
>> #Function Arguments:
>> #'Reference'  refers to name of the layer with the desired extent;
>> 'OutName' represents the intended prefix for output files; 'OutPrj'
>> represents the desired output projection; and 'OutRes' represents the
>> desired Output Resolution
>>
>> BatchCrop<-function(Reference,OutName,OutPrj,OutRes){
>>             filenames <- list.files(pattern="*.asc", full.names=TRUE)
>> #Extract list of  file names from working directory
>>             library(raster)    #Calls 'raster' library
>>
>>             #Function 'f1' imports data listed in 'filenames' and assigns
>> projection
>>                 f1<-function(x,z) {
>>                 y <- raster(x)
>>                 projection(y) <- CRS(z)
>>                 return(y)
>>                 }
>>                 import <- lapply(filenames,f1,projection(Reference))
>>
>>             cropped <- lapply(import,crop,Reference)    #Crop imported
>> layers to reference layer, argument 'x'
>>
>>             #Function 'f2' changes projectection of cropped layers
>>                 f2<-function(x,y) {
>>                 x<-projectRaster(x, crs=OutPrj, res=OutRes)
>>                 return(x)
>>                 }
>>                 output <- lapply(cropped,f2,OutPrj)
>>
>>             #Use a 'for' loop to iterate writeRaster function for all
>> cropped layers
>>             for(i in (1:max(length(filenames)))){            #
>>                 writeRaster(output[[i]],paste(deparse(substitute(OutName)),
>> i), format='ascii')
>>                 }
>>                 }
>> #############################################
>> ###Example Code using function 'BatchCrop'###
>> #############################################
>>
>> #Data layers to be cropped downloaded from:
>> http://www.prism.oregonstate.edu/products/matrix.phtml?vartype=tmax&view=maps[testing
>> was done using 1981-2010 monthly and annual normals; can use any
>> .asc layer within the bounds of the PRISM data, with projection as lat/long
>> and GRS80]
>> #Set Working Directory where data to be cropped are stored
>> setwd("D:/GIS/PRISM/1981-2010/TMin")
>>
>> #Import Reference Layer
>> reference<-raster("D:/GIS/California/Hab Suitability Files/10m_DEM/10m DEM
>> asc/DEM_10m.asc")
>> #Set Projection for Reference Layer
>> projection(reference) <- CRS("+proj=longlat +ellps=GRS80")
>>
>> #Run Function
>> BatchCrop(Reference=reference,OutName=TMinCrop,OutPrj="+proj=utm +zone=11
>> +datum=WGS84",OutRes=800)
>>
>>
>>
>> On Fri, Jul 12, 2013 at 11:39 AM, Michael Treglia <mtreglia at gmail.com>wrote:
>>
>>> Hi Roger,
>>>
>>> In R 2.13.0, it is Raster version 1.9-70; in R 3.0.0 it is Raster version
>>> 2.1-48
>>>
>>> When running in R 3.0.0, upon running the 'raster' command, it loads the
>>> rgdal package... whereas in R 2.13.0, I don't even have the rgdal package
>>> installed. I guess in the previous version of Raster, it actually housed
>>> gdal commands or something of the sort, whereas now it does not?
>>>
>>> Thanks for your help!
>>> Mike
>>>
>>>
>>> On Fri, Jul 12, 2013 at 1:00 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Fri, 12 Jul 2013, Michael Treglia wrote:
>>>>
>>>>  Thanks for trying Erin!
>>>>> I appreciate knowing its not just me :-)
>>>>>
>>>>
>>>> Are your raster package versions different? In current raster,
>>>> R/rasterFromGDAL.R in line 129 sets crs="", and because in line 152 the
>>>> assigned value in:
>>>>
>>>> projection(r) <- attr(gdalinfo, 'projection')
>>>>
>>>> is NA, you get what you see. My guess is that if your crs= argument is
>>>> neither missing nor NA or the empty string, it should poverride
>>>> attr(gdalinfo, 'projection').
>>>>
>>>> Providing the version of your older installation of raster will help
>>>> isolate when and which change has led to this outcome, but you do have a
>>>> workaround. I can't see the offending revision in SCM in R-forge.
>>>>
>>>> Roger
>>>>
>>>>  -Mike
>>>>>
>>>>>
>>>>> On Thu, Jul 11, 2013 at 6:40 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>>>>>
>>>>>   Hi again.
>>>>>>
>>>>>> It looks like the crs argument no longer works when creating a raster
>>>>>> from
>>>>>> a file.  I've tried all kinds of "variations on the theme" also, but no
>>>>>> luck.
>>>>>>
>>>>>> Weird.
>>>>>>
>>>>>> Thanks
>>>>>> Erin
>>>>>>
>>>>>>  ------------------------------
>>>>>> *From:* Michael Treglia [mtreglia at gmail.com]
>>>>>> *Sent:* Thursday, July 11, 2013 8:21 PM
>>>>>> *To:* Michael Sumner
>>>>>> *Cc:* Hodgess, Erin; r-sig-geo at r-project.org
>>>>>> *Subject:* Re: [R-sig-Geo] Problem Setting Projection of Rasters upon
>>>>>>
>>>>>> Import
>>>>>>
>>>>>>    Hi,
>>>>>>  I apologize - I must have mistakenly copied/pasted only the last "t"
>>>>>>
>>>>>>  Here is how it was run, and the results, in R 3.0.0 (64-bit):
>>>>>>
>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+proj=longlat
>>>>>>> +ellps=GRS80")
>>>>>>> test
>>>>>>>
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>>>>> ymax)
>>>>>> coord. ref. : NA
>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>> names       : us_ppt_1981_2010.02
>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>
>>>>>>
>>>>>>  and in R 2.13.0 (also 64-bit):
>>>>>>
>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+proj=longlat
>>>>>>> +ellps=GRS80")
>>>>>>> test
>>>>>>>
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax, ymin,
>>>>>> ymax)
>>>>>> coord. ref. : +proj=longlat +ellps=GRS80
>>>>>> values      : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Thu, Jul 11, 2013 at 6:13 PM, Michael Sumner <mdsumner at gmail.com
>>>>>> >wrote:
>>>>>>
>>>>>>  Please report on the actual code you ran, you've just sent two
>>>>>>> messages, one with
>>>>>>>
>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>>
>>>>>>>  this correctly cannot set the CRS and so it is NA
>>>>>>>
>>>>>>> and the other with
>>>>>>>
>>>>>>> t<-raster("us_ppt_1981_2010.**02.asc", crs="+proj=longlat
>>>>>>> +ellps=GRS80")
>>>>>>>
>>>>>>>> test
>>>>>>>>
>>>>>>>
>>>>>>>  We have no idea what you see in "t" now. In short you have to have a
>>>>>>> "+proj", not just a "+ellps" for this incantation. You can check with
>>>>>>>
>>>>>>> library(rgdal)
>>>>>>> CRS("+ellps=GRS80")
>>>>>>> Error in CRS("+ellps=GRS80") : projection not named
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> On Fri, Jul 12, 2013 at 11:10 AM, Michael Treglia <mtreglia at gmail.com>
>>>>>>> wrote:
>>>>>>>
>>>>>>>> I just tried running it in an older version of R, 2.13.0 (64-bit) and
>>>>>>>> it
>>>>>>>> ran with no problem... the exact same code run from Notepad++
>>>>>>>>
>>>>>>>> Anybody know what has changed/if I need to adjust my for R 3.x.x?
>>>>>>>>
>>>>>>>> t<-raster("us_ppt_1981_2010.**02.asc", crs="+proj=longlat
>>>>>>>> +ellps=GRS80")
>>>>>>>>
>>>>>>>>> test
>>>>>>>>>
>>>>>>>> class       : RasterLayer
>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>> ymin,
>>>>>>>> ymax)
>>>>>>>> coord. ref. : +proj=longlat +ellps=GRS80
>>>>>>>> values      : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>
>>>>>>>> Thanks again!
>>>>>>>> Mike
>>>>>>>>
>>>>>>>>
>>>>>>>> On Thu, Jul 11, 2013 at 5:59 PM, Michael Treglia <mtreglia at gmail.com>
>>>>>>>>
>>>>>>> wrote:
>>>>>>>
>>>>>>>>
>>>>>>>>  Hi Erin,
>>>>>>>>>
>>>>>>>>> Thanks for the quick response - I did try it with the plus sign, and
>>>>>>>>>
>>>>>>>> same
>>>>>>>
>>>>>>>> result. (I also tried it with 'crs="+proj=longlat +ellps=GRS80"' with
>>>>>>>>>
>>>>>>>> the
>>>>>>>
>>>>>>>> same result too.)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>   test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>>>>>  test
>>>>>>>>>>
>>>>>>>>> class       : RasterLayer
>>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>>
>>>>>>>> ymin,
>>>>>>>
>>>>>>>> ymax)
>>>>>>>>> coord. ref. : NA
>>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>>
>>>>>>>>> I'm running R Version 3.0.0, 64-bit, in case that helps at all...
>>>>>>>>> Cheers,
>>>>>>>>> Mike
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On Thu, Jul 11, 2013 at 5:50 PM, Hodgess, Erin <HodgessE at uhd.edu>
>>>>>>>>>
>>>>>>>> wrote:
>>>>>>>
>>>>>>>>
>>>>>>>>>  Hi Michael:
>>>>>>>>>>
>>>>>>>>>> Did you try this;
>>>>>>>>>>
>>>>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="+ellps=GRS80")
>>>>>>>>>>
>>>>>>>>>> with the plus sign, please?
>>>>>>>>>>
>>>>>>>>>> That might do it.
>>>>>>>>>>
>>>>>>>>>> Thanks,
>>>>>>>>>> Erin
>>>>>>>>>>
>>>>>>>>>> ______________________________**__________
>>>>>>>>>> From: r-sig-geo-bounces at r-project.**org<r-sig-geo-bounces at r-project.org>[
>>>>>>>>>>
>>>>>>>>> r-sig-geo-bounces at r-project.**org <r-sig-geo-bounces at r-project.org>]
>>>>>>>
>>>>>>>> on behalf of Michael Treglia [mtreglia at gmail.com]
>>>>>>>>>> Sent: Thursday, July 11, 2013 7:16 PM
>>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>>> Subject: [R-sig-Geo] Problem Setting Projection of Rasters upon
>>>>>>>>>> Import
>>>>>>>>>>
>>>>>>>>>> Hi All,
>>>>>>>>>>
>>>>>>>>>> I am using he "raster" package, and in particular the "raster"
>>>>>>>>>>
>>>>>>>>> function. I
>>>>>>>
>>>>>>>> am dealing with a number of layers, and it would be easiest to set
>>>>>>>>>>
>>>>>>>>> the CRS
>>>>>>>
>>>>>>>> upon import. Looking through the documentation, it seems that it is
>>>>>>>>>> doable,
>>>>>>>>>> and I have been using the following code to get started, though it
>>>>>>>>>> is
>>>>>>>>>>
>>>>>>>>> not
>>>>>>>
>>>>>>>> setting the CRS.
>>>>>>>>>>
>>>>>>>>>> Here are my code, and the results of the import:
>>>>>>>>>>
>>>>>>>>>>> test<-raster("us_ppt_1981_**2010.02.asc", crs="ellps=GRS80")
>>>>>>>>>>> test
>>>>>>>>>>>
>>>>>>>>>> class       : RasterLayer
>>>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>>>
>>>>>>>>> ymin,
>>>>>>>
>>>>>>>> ymax)
>>>>>>>>>> *coord. ref. : NA *
>>>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>>>
>>>>>>>>>> If I use the "projection" command afterwards, it sets the projection
>>>>>>>>>> appropriately though.
>>>>>>>>>>
>>>>>>>>>>> projection(test)<-CRS("+proj=**longlat +ellps=GRS80")
>>>>>>>>>>> test
>>>>>>>>>>>
>>>>>>>>>> class       : RasterLayer
>>>>>>>>>> dimensions  : 3105, 7025, 21812625  (nrow, ncol, ncell)
>>>>>>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>>>>>>> extent      : -125.0208, -66.47917, 24.0625, 49.9375  (xmin, xmax,
>>>>>>>>>>
>>>>>>>>> ymin,
>>>>>>>
>>>>>>>> ymax)
>>>>>>>>>> *coord. ref. : +proj=longlat +ellps=GRS80 *
>>>>>>>>>> data source : D:\GIS\PRISM\1981-2010\PPT\us_**ppt_1981_2010.02.asc
>>>>>>>>>> names       : us_ppt_1981_2010.02
>>>>>>>>>> values      : -2147483648, 2147483647  (min, max)
>>>>>>>>>>
>>>>>>>>>> Any suggestions of why the first option is not working? I have a
>>>>>>>>>>
>>>>>>>>> script in
>>>>>>>
>>>>>>>> which I import all files in a folder, and the simplest way to assign
>>>>>>>>>>
>>>>>>>>> the
>>>>>>>
>>>>>>>> projection would be the first option (I'm using an 'lapply' command).
>>>>>>>>>> It would look something like this:
>>>>>>>>>> import <- lapply(filenames ,raster, crs="....") #where "filenames"
>>>>>>>>>> is
>>>>>>>>>>
>>>>>>>>> a
>>>>>>>
>>>>>>>> vector of filenames in the working directory.
>>>>>>>>>>
>>>>>>>>>> In case it helps, these are PRISM Climate Data, and the header of my
>>>>>>>>>> raster
>>>>>>>>>> file is this:
>>>>>>>>>> ncols 7025
>>>>>>>>>> nrows 3105
>>>>>>>>>> xllcorner -125.020833333333329
>>>>>>>>>> yllcorner 24.062500000000000
>>>>>>>>>> cellsize 0.008333333333333
>>>>>>>>>> NODATA_value -9999
>>>>>>>>>>
>>>>>>>>>> Thanks for any suggestions!
>>>>>>>>>> Mike
>>>>>>>>>>
>>>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>>>
>>>>>>>>>> ______________________________**_________________
>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>
>>>>>>>> ______________________________**_________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>  --
>>>>>>> Michael Sumner
>>>>>>> Hobart, Australia
>>>>>>> e-mail: mdsumner at gmail.com
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________**_________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>
>>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
<#secure method=pgpmime mode=sign>

-- 
Rainer M. Krug

email: RMKrug<at>gmail<dot>com


From juantomas.sayago at gmail.com  Mon Jul 15 12:38:39 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Mon, 15 Jul 2013 06:38:39 -0400
Subject: [R-sig-Geo] Spatial panel Durbin model
In-Reply-To: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>
References: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>
Message-ID: <CAEOXpNBrXCuZu8dsPaqoQ_2HiAoVoiZ6np06PJJgSzzu0--o-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/c1611432/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jul 15 12:45:11 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 15 Jul 2013 12:45:11 +0200
Subject: [R-sig-Geo] Spatial panel Durbin model
In-Reply-To: <CAEOXpNBrXCuZu8dsPaqoQ_2HiAoVoiZ6np06PJJgSzzu0--o-g@mail.gmail.com>
References: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>
	<CAEOXpNBrXCuZu8dsPaqoQ_2HiAoVoiZ6np06PJJgSzzu0--o-g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307151243080.29790@reclus.nhh.no>

On Mon, 15 Jul 2013, Juan Tomas Sayago Gomez wrote:

> Hi, package spdep, when you use the command lagsarlm select the option type
> mixed.
> install.packages("spdep")
> library(spdep)
> ?lagsarlm

Right for cross-section models, but the question was about spatial panel 
models. In that case. it may be necessary to construct the spatial lags 
manually, and add them to the model to be estimated (by ML, for GM you 
risk difficulties with instruments).

Roger

> Best,
> Juan
>
>
> On Sun, Jul 14, 2013 at 11:54 PM, Chen, Xi Prof. <Xi.Chen at quinnipiac.edu>wrote:
>
>> Hi,
>> Is there a package that can run spatial panel durbin model in r?
>>
>> Thanks.
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From juantomas.sayago at gmail.com  Mon Jul 15 12:51:21 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Mon, 15 Jul 2013 06:51:21 -0400
Subject: [R-sig-Geo] Spatial panel Durbin model
In-Reply-To: <alpine.LRH.2.03.1307151243080.29790@reclus.nhh.no>
References: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>
	<CAEOXpNBrXCuZu8dsPaqoQ_2HiAoVoiZ6np06PJJgSzzu0--o-g@mail.gmail.com>
	<alpine.LRH.2.03.1307151243080.29790@reclus.nhh.no>
Message-ID: <CAEOXpNBZt221ChOOweAD=c0LoSrmbaxvE=Nsb58aLfvLeGEapg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/2ca27d1a/attachment.pl>

From Roman.Minguez at uclm.es  Mon Jul 15 13:02:18 2013
From: Roman.Minguez at uclm.es (ROMAN MINGUEZ SALIDO)
Date: Mon, 15 Jul 2013 13:02:18 +0200
Subject: [R-sig-Geo] Plotting together Lucas County observations and map
Message-ID: <545ACE76E07A204FB8ADCC0E179A7F7D33E84B@evscu02.uclm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/6f0bec6f/attachment.pl>

From HodgessE at uhd.edu  Mon Jul 15 13:14:25 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 15 Jul 2013 11:14:25 +0000
Subject: [R-sig-Geo] Plotting together Lucas County observations and map
In-Reply-To: <545ACE76E07A204FB8ADCC0E179A7F7D33E84B@evscu02.uclm.es>
References: <545ACE76E07A204FB8ADCC0E179A7F7D33E84B@evscu02.uclm.es>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A238B2@columbia.uhd.campus>

Hi!

Use spTransform to get the spdep data into long/lat

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of ROMAN MINGUEZ SALIDO [Roman.Minguez at uclm.es]
Sent: Monday, July 15, 2013 6:02 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Plotting together Lucas County observations and map

Hi everyone:

I would like to plot the observations of housing prices included in the Lucas County data of spdep package. The problem is that I want to plot these observations in a map of Lucas County. I have found a map of Lucas County in an shp polygon file but the spatial coordinates are in longitude-latitude and the spatial coordinates of the housing data included in spdep are projected like CRS(+init=epsg:2834), the Ohio North State Plane. Anyone knows how can I mix both files in a single plot?.

Thanks in advance.

Regards,

Rom?n

        [[alternative HTML version deleted]]



From ipaajs at gmail.com  Mon Jul 15 13:34:18 2013
From: ipaajs at gmail.com (ipampa)
Date: Mon, 15 Jul 2013 04:34:18 -0700 (PDT)
Subject: [R-sig-Geo] assign a slot to a name (character) in loop
In-Reply-To: <1373805227267-7584131.post@n2.nabble.com>
References: <1373805227267-7584131.post@n2.nabble.com>
Message-ID: <1373888058871-7584139.post@n2.nabble.com>

after searching and searching I couldn?t find a way to that.

instead, I simply came back in the loops and inserted my data.frame in the
assignation of the spatialpolygonsdataframe.







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/assign-a-slot-to-a-name-character-in-loop-tp7584131p7584139.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ROONEYJ4 at tcd.ie  Mon Jul 15 18:25:45 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 15 Jul 2013 17:25:45 +0100
Subject: [R-sig-Geo] how to code for neighbour list editing
Message-ID: <75C8D19A1470D344A8AF5312F01160A602874A6E5EA0@GOMAIL.college.tcd.ie>

Hi all,

Ok so I have a spatial data set with over 3000 polygons. I used poly2nb() to identify neighbour relationships and make an nb object. Of the polygons, about 30 or 40 are islands and have no neighbours according to polynb. Prior to doing Bayesian smoothing, I wish to assign neighbours to those islands (and probably weight them with a weaker weighting than true neighbours). Anyhow I've tried the edit tool for manually editing neighbours. Its basically not useful however since there are so many polygons its too hard to see the islands.

So I'd like to write some code to do something like this by manipulating the nblist:

1) Identify islands
2) For each island find nearest neighbour
3) Assign a neighbour relationship between the island and its nearest neighbour
4) Weight it appropriately (half normal weighting for example)

My problem is I don't really have any understanding of the nb object or how it stores relationships. I've tried summary() attributes() print() etc etc and can't really glean an insight into how to access or edit the inner structure of the nblist.

I was hoping someone might have dealt with this before. Or maybe there are functions for this I have yet to discover ?

Many thanks,
James

From milansharma2012 at yahoo.com  Mon Jul 15 18:46:53 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Mon, 15 Jul 2013 09:46:53 -0700 (PDT)
Subject: [R-sig-Geo] Citation for spgwr
Message-ID: <1373906813.93313.YahooMailNeo@web162103.mail.bf1.yahoo.com>

Hi Roger,
?Please let me know if the following way of citing spgwr is incorect:

In references: ?Bivand, R., Yu, D.
(2013) spgwr:? Geographically weighted
regression. R package version 3.0


and within the text:?
We usedthe spgwr
package (Bivand and Yu 2013) for GWR in the statistical software package R,
version 3.0 (R Development core team 2013).

Please let me know if any thing is incorrect.
Thanks,
Milan



From bakare at ualberta.ca  Mon Jul 15 19:08:46 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 15 Jul 2013 11:08:46 -0600
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
Message-ID: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/619025de/attachment.pl>

From amen.alyaari at bordeaux.inra.fr  Mon Jul 15 19:36:44 2013
From: amen.alyaari at bordeaux.inra.fr (Amen Alyaari)
Date: Mon, 15 Jul 2013 19:36:44 +0200
Subject: [R-sig-Geo] number of triples
Message-ID: <51E4332C.3090700@bordeaux.inra.fr>

Dear All,

I have three datasets and would like co know how much N was used in my 
calculations.

I read the data into a multi-dimensional array with dimensions (nx, ny, 
ntsteps, ndatasets), e.g. with a smaller example dataset:

           # nx   ny   nsteps ndatasets
                 dat = runif(20 * 30 * 100 *  3)
             dim(dat) = c(20, 30, 100, 3)
 > str(dat)
         num [1:20, 1:30, 1:100, 1:3] 0.1834 0.8537 0.0672 0.0734 0.8078 ...

we take advantage of the `cor` functions and build this function to 
compute how many N we have:

         cor_withN <- function(...) {
             res <- try(cor.test(...)$parameter+2, silent=TRUE)
             ifelse(class(res)=="try-error", NA, res)}

Now we take advantage of the fact that apply also works on 
multi-dimensional arrays, not only matrices:

We use apply to iterate over all the x,y,z triples.

           result = apply(dat, c(1,2), function(x) cor_withN(x[,1], 
x[,2],x[,3]))
 > str(cor_result)
          logi [1:20, 1:30] NA NA NA NA NA NA ..
so something is wrong by getting NA NA NA NA
if the last line went well! then

          str(cor_result)
  should be

          logi [1:20, 1:30] 100 100 100 100 100 ..(nsteps)

Any idea on why I am getting NA or is there another way to do it?

When I tested it with 2 datsets,it went well!

           cor_result = apply(dat, c(1,2), function(x) cor_withN(x[,1], 
x[,2]))
 > str(cor_result)
          num [1:20, 1:30] 100 100 100 100 100 100 100 100 100 100

so the problem is when I added `x[,3]`!!
Thanks

Amen


From Roger.Bivand at nhh.no  Mon Jul 15 20:51:07 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 15 Jul 2013 20:51:07 +0200
Subject: [R-sig-Geo] how to code for neighbour list editing
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602874A6E5EA0@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602874A6E5EA0@GOMAIL.college.tcd.ie>
Message-ID: <alpine.LRH.2.03.1307151914570.31230@reclus.nhh.no>

On Mon, 15 Jul 2013, James Rooney wrote:

> Hi all,
>
> Ok so I have a spatial data set with over 3000 polygons. I used 
> poly2nb() to identify neighbour relationships and make an nb object. Of 
> the polygons, about 30 or 40 are islands and have no neighbours 
> according to polynb. Prior to doing Bayesian smoothing, I wish to assign 
> neighbours to those islands (and probably weight them with a weaker 
> weighting than true neighbours). Anyhow I've tried the edit tool for 
> manually editing neighbours. Its basically not useful however since 
> there are so many polygons its too hard to see the islands.
>
> So I'd like to write some code to do something like this by manipulating 
> the nblist:

Please provide example code and data to set up the problem, say US 
counties or similar:

http://www2.census.gov/geo/tiger/GENZ2010/gz_2010_us_050_00_20m.zip

library(rgdal)
usc <- readOGR(".", "gz_2010_us_050_00_20m")
library(spdep)
nb <- poly2nb(usc)

>
> 1) Identify islands

no_neighs <- which(card(nb) == 0) # returns set cardinality.

To check that you get the same result using counts of graph components:

nc <- n.comp.nb(nb)
table(nc$comp.id)
no_neighs_comps <- which(unname(table(nc$comp.id)==1))
match(no_neighs_comps, nc$comp.id)

> 2) For each island find nearest neighbour

k1nb <- knn2nb(knearneigh(coordinates(usc), k=1,
   longlat=!is.projected(usc)))

It isn't just a matter of finding the one-way neighbor, as the reverse 
should also be assigned (if i neighbours j, then j neighbours i, as in 
poly2nb()).

> 3) Assign a neighbour relationship between the island and its nearest 
> neighbour

is.symmetric.nb(nb, force=TRUE)
nb1 <- nb

res <- k1nb[no_neighs]
nb1[no_neighs] <- res
attr(nb1, "sym") <- is.symmetric.nb(nb1, force=TRUE)
# re-assign the now incorrect symmetry attribute
nb1

nb2 <- make.sym.nb(nb1)
is.symmetric.nb(nb2, force=TRUE)
nb2

I think that some new links here have contributed to changes in the 
smaller subgraphs:

table(n.comp.nb(nb2)$comp.id)

> 4) Weight it appropriately (half normal weighting for example)
>

This is harder to arrange, because of the symmetric linkages, and although 
it could be done, is unlikely to affect the result. Indeed, judicious use 
of set.ZeroPolicyOption(TRUE) to avoid having to set zero.policy=TRUE 
might be quite acceptable if there are few no-neighbour observations.

> My problem is I don't really have any understanding of the nb object or 
> how it stores relationships. I've tried summary() attributes() print() 
> etc etc and can't really glean an insight into how to access or edit the 
> inner structure of the nblist.

Use a smaller example to get on top of it and read the vignette in spdep 
as well as the help pages and their references. An nb object is a list of 
integer vectors, but uses an integer vector with a single value of 0 to 
signal no neighbour.

Hope this clarifies,

Roger

>
> I was hoping someone might have dealt with this before. Or maybe there 
> are functions for this I have yet to discover ?
>
> Many thanks,
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From paulojus at c3sl.ufpr.br  Mon Jul 15 20:51:49 2013
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Mon, 15 Jul 2013 15:51:49 -0300 (BRT)
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
In-Reply-To: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
References: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
Message-ID: <alpine.DEB.2.02.1307151551080.7482@macalan.c3sl.ufpr.br>

likelihood based methods and full kriging neighbourhood in some (or most) 
of geoR functions are not suitable for such data size


Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Mon, 15 Jul 2013, Moshood Agba Bakare wrote:

> Dear All,
> Please which of these packages - gstat and geoR is better for fitting
> spatial covariance structure model for spatial data with 20,000
> observations. Kindly recommend any other package you think can fit such
> model.
>
> Thank you.
>
> Moshood
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Mon Jul 15 20:53:29 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 15 Jul 2013 20:53:29 +0200
Subject: [R-sig-Geo] Citation for spgwr
In-Reply-To: <1373906813.93313.YahooMailNeo@web162103.mail.bf1.yahoo.com>
References: <1373906813.93313.YahooMailNeo@web162103.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1307152051590.31230@reclus.nhh.no>

On Mon, 15 Jul 2013, Milan Sharma wrote:

> Hi Roger,
> ?Please let me know if the following way of citing spgwr is incorect:

For citing, use the citation() function:

citation() # for R itself
citation("<package>") # for <package>

Roger

>
> In references: ?Bivand, R., Yu, D.
> (2013) spgwr:? Geographically weighted
> regression. R package version 3.0
>
>
> and within the text:?
> We usedthe spgwr
> package (Bivand and Yu 2013) for GWR in the statistical software package R,
> version 3.0 (R Development core team 2013).
>
> Please let me know if any thing is incorrect.
> Thanks,
> Milan
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Xi.Chen at quinnipiac.edu  Mon Jul 15 21:04:34 2013
From: Xi.Chen at quinnipiac.edu (Chen, Xi Prof.)
Date: Mon, 15 Jul 2013 19:04:34 +0000
Subject: [R-sig-Geo] Spatial panel Durbin model
In-Reply-To: <CAEOXpNBZt221ChOOweAD=c0LoSrmbaxvE=Nsb58aLfvLeGEapg@mail.gmail.com>
References: <EBC91FF8B4E53246B8BA237A2299D1E812B12C56@cm-emu.quinnipiac.edu>
	<CAEOXpNBrXCuZu8dsPaqoQ_2HiAoVoiZ6np06PJJgSzzu0--o-g@mail.gmail.com>
	<alpine.LRH.2.03.1307151243080.29790@reclus.nhh.no>
	<CAEOXpNBZt221ChOOweAD=c0LoSrmbaxvE=Nsb58aLfvLeGEapg@mail.gmail.com>
Message-ID: <EBC91FF8B4E53246B8BA237A2299D1E812B12E08@cm-emu.quinnipiac.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/f81bf146/attachment.pl>

From ROONEYJ4 at tcd.ie  Mon Jul 15 22:04:20 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 15 Jul 2013 21:04:20 +0100
Subject: [R-sig-Geo] how to code for neighbour list editing
In-Reply-To: <alpine.LRH.2.03.1307151914570.31230@reclus.nhh.no>
References: <75C8D19A1470D344A8AF5312F01160A602874A6E5EA0@GOMAIL.college.tcd.ie>,
	<alpine.LRH.2.03.1307151914570.31230@reclus.nhh.no>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602874A6E5EA2@GOMAIL.college.tcd.ie>

Many thanks Roger,

I'll study that and see how I get on!

James
________________________________________
From: Roger Bivand [Roger.Bivand at nhh.no]
Sent: 15 July 2013 19:51
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] how to code for neighbour list editing

On Mon, 15 Jul 2013, James Rooney wrote:

> Hi all,
>
> Ok so I have a spatial data set with over 3000 polygons. I used
> poly2nb() to identify neighbour relationships and make an nb object. Of
> the polygons, about 30 or 40 are islands and have no neighbours
> according to polynb. Prior to doing Bayesian smoothing, I wish to assign
> neighbours to those islands (and probably weight them with a weaker
> weighting than true neighbours). Anyhow I've tried the edit tool for
> manually editing neighbours. Its basically not useful however since
> there are so many polygons its too hard to see the islands.
>
> So I'd like to write some code to do something like this by manipulating
> the nblist:

Please provide example code and data to set up the problem, say US
counties or similar:

http://www2.census.gov/geo/tiger/GENZ2010/gz_2010_us_050_00_20m.zip

library(rgdal)
usc <- readOGR(".", "gz_2010_us_050_00_20m")
library(spdep)
nb <- poly2nb(usc)

>
> 1) Identify islands

no_neighs <- which(card(nb) == 0) # returns set cardinality.

To check that you get the same result using counts of graph components:

nc <- n.comp.nb(nb)
table(nc$comp.id)
no_neighs_comps <- which(unname(table(nc$comp.id)==1))
match(no_neighs_comps, nc$comp.id)

> 2) For each island find nearest neighbour

k1nb <- knn2nb(knearneigh(coordinates(usc), k=1,
   longlat=!is.projected(usc)))

It isn't just a matter of finding the one-way neighbor, as the reverse
should also be assigned (if i neighbours j, then j neighbours i, as in
poly2nb()).

> 3) Assign a neighbour relationship between the island and its nearest
> neighbour

is.symmetric.nb(nb, force=TRUE)
nb1 <- nb

res <- k1nb[no_neighs]
nb1[no_neighs] <- res
attr(nb1, "sym") <- is.symmetric.nb(nb1, force=TRUE)
# re-assign the now incorrect symmetry attribute
nb1

nb2 <- make.sym.nb(nb1)
is.symmetric.nb(nb2, force=TRUE)
nb2

I think that some new links here have contributed to changes in the
smaller subgraphs:

table(n.comp.nb(nb2)$comp.id)

> 4) Weight it appropriately (half normal weighting for example)
>

This is harder to arrange, because of the symmetric linkages, and although
it could be done, is unlikely to affect the result. Indeed, judicious use
of set.ZeroPolicyOption(TRUE) to avoid having to set zero.policy=TRUE
might be quite acceptable if there are few no-neighbour observations.

> My problem is I don't really have any understanding of the nb object or
> how it stores relationships. I've tried summary() attributes() print()
> etc etc and can't really glean an insight into how to access or edit the
> inner structure of the nblist.

Use a smaller example to get on top of it and read the vignette in spdep
as well as the help pages and their references. An nb object is a list of
integer vectors, but uses an integer vector with a single value of 0 to
signal no neighbour.

Hope this clarifies,

Roger

>
> I was hoping someone might have dealt with this before. Or maybe there
> are functions for this I have yet to discover ?
>
> Many thanks,
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From bakare at ualberta.ca  Mon Jul 15 22:19:33 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 15 Jul 2013 14:19:33 -0600
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
In-Reply-To: <alpine.DEB.2.02.1307151551080.7482@macalan.c3sl.ufpr.br>
References: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
	<alpine.DEB.2.02.1307151551080.7482@macalan.c3sl.ufpr.br>
Message-ID: <CAJRR3XMiJc7cnLUtK4iSnq-dJnj26v3QY11F0cE30V0wjrfAuw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/b8bae447/attachment.pl>

From rundel at gmail.com  Mon Jul 15 23:38:51 2013
From: rundel at gmail.com (Colin Rundel)
Date: Mon, 15 Jul 2013 17:38:51 -0400
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
In-Reply-To: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
References: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
Message-ID: <727C1810-FB7A-4C53-B0F9-E6B4BA2482CA@gmail.com>

You can look into using the spBayes package using gaussian predictive process models to handle the large number of observations.

-Colin


On Jul 15, 2013, at 1:08 PM, Moshood Agba Bakare <bakare at ualberta.ca> wrote:

> Dear All,
> Please which of these packages - gstat and geoR is better for fitting
> spatial covariance structure model for spatial data with 20,000
> observations. Kindly recommend any other package you think can fit such
> model.
> 
> Thank you.
> 
> Moshood
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From bakare at ualberta.ca  Tue Jul 16 02:50:49 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 15 Jul 2013 18:50:49 -0600
Subject: [R-sig-Geo] Directions in northing-easting coordinates of spatial
	data
Message-ID: <CAJRR3XOxmj_jiW4q3nEWCSQ4TMZqYo6kdTGiifypPt9kKtmbtQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/ecc57452/attachment.pl>

From tf at devmag.net  Tue Jul 16 07:30:16 2013
From: tf at devmag.net (Thiemo Fetzer)
Date: Tue, 16 Jul 2013 06:30:16 +0100
Subject: [R-sig-Geo] Projection of raster created from a tif
Message-ID: <FC9FF78C-F2AE-4C39-A155-903685DE1F5F@devmag.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130716/81bba75b/attachment.pl>

From tephilippi at gmail.com  Tue Jul 16 08:09:06 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Mon, 15 Jul 2013 23:09:06 -0700
Subject: [R-sig-Geo] Projection of raster created from a tif
In-Reply-To: <FC9FF78C-F2AE-4C39-A155-903685DE1F5F@devmag.net>
References: <FC9FF78C-F2AE-4C39-A155-903685DE1F5F@devmag.net>
Message-ID: <CALyPt8xgQFqJy1rfKgJUoN5R+a+8_t0cpx6jT5Q64RLEbdJWbw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130715/d3338c4c/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jul 16 10:31:03 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 16 Jul 2013 10:31:03 +0200
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
In-Reply-To: <CAJRR3XMiJc7cnLUtK4iSnq-dJnj26v3QY11F0cE30V0wjrfAuw@mail.gmail.com>
References: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
	<alpine.DEB.2.02.1307151551080.7482@macalan.c3sl.ufpr.br>
	<CAJRR3XMiJc7cnLUtK4iSnq-dJnj26v3QY11F0cE30V0wjrfAuw@mail.gmail.com>
Message-ID: <51E504C7.6010808@uni-muenster.de>

It can fit such a model.

On 07/15/2013 10:19 PM, Moshood Agba Bakare wrote:
> Thanks. What about gstat package?
> 
> Moshood
> 
> 
> On Mon, Jul 15, 2013 at 12:51 PM, Paulo Justiniano Ribeiro Jr <
> paulojus at c3sl.ufpr.br> wrote:
> 
>> likelihood based methods and full kriging neighbourhood in some (or most)
>> of geoR functions are not suitable for such data size
>>
>>
>> Paulo Justiniano Ribeiro Jr
>> LEG (Laboratorio de Estatistica e Geoinformacao)
>> Universidade Federal do Parana
>> Caixa Postal 19.081
>> CEP 81.531-990
>> Curitiba, PR  -  Brasil
>> Tel: (+55) 41 3361 3573
>> VOIP: (+55) (41) (3361 3600) 1053 1066
>> Fax: (+55) 41 3361 3141
>> e-mail: paulojus AT  ufpr  br
>> http://www.leg.ufpr.br/~**paulojus <http://www.leg.ufpr.br/~paulojus>
>>
>>
>> On Mon, 15 Jul 2013, Moshood Agba Bakare wrote:
>>
>>  Dear All,
>>> Please which of these packages - gstat and geoR is better for fitting
>>> spatial covariance structure model for spatial data with 20,000
>>> observations. Kindly recommend any other package you think can fit such
>>> model.
>>>
>>> Thank you.
>>>
>>> Moshood
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From villers.alexandre at gmail.com  Tue Jul 16 10:35:07 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Tue, 16 Jul 2013 11:35:07 +0300
Subject: [R-sig-Geo] Package for fitting spatial model on large dataset
In-Reply-To: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
References: <CAJRR3XP4oRz4ZAYqQ+4kmN4rExMq_NjX0_j=i0GOXcnt_UcAYQ@mail.gmail.com>
Message-ID: <CAFrtd2NEW8UGfipoyqpLAefhk5=NFqDQ-BJbDPqDg=hq6sqRvw@mail.gmail.com>

Hello,

You can also have a look at INLA www.r-inla.org
HTH

Alex

2013/7/15 Moshood Agba Bakare <bakare at ualberta.ca>:
> Dear All,
> Please which of these packages - gstat and geoR is better for fitting
> spatial covariance structure model for spatial data with 20,000
> observations. Kindly recommend any other package you think can fit such
> model.
>
> Thank you.
>
> Moshood
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Alexandre Villers, PhD.
Postdoctoral researcher
Section of Ecology
University of Turku
FIN-20014 Turku, Finland

Phone +358 (0)2 333 5039


From markpayneatwork at gmail.com  Tue Jul 16 14:28:18 2013
From: markpayneatwork at gmail.com (Mark Payne)
Date: Tue, 16 Jul 2013 14:28:18 +0200
Subject: [R-sig-Geo] Area calculation workflow
Message-ID: <CAGBzUO8yBU05+yeSvvsFkgT-hQbQGvSyHEEzQnVUAqWMYSr13Q@mail.gmail.com>

Hi,

I have a SpatialGridDataFrame with sea-surface temperatures based on
lon/lat coordinates that I want to use to calculate the area (in
square km) contained within an isotherm. I'm still a little unsure in
this type of thing, so just wanted to check that the workflow is
correct.

I can get the isotherm out ok, using as.image.SpatialGridDataFrame(),
contourLines() and then back to sp with ContourLines2SLDF. This gives
me a set of SpatialLines in lat-lon space. But now I get a bit stuck.

I guessing that are three steps
1. Close the lines to make polygons (but how?)
2. Convert to UTM e.g. using spTransform() from rgdal package
3. Extract the area of each individual polygon from the polygons slot

Is this is the quickest and easiest approach? Or have I overlooked
something? And how do I conver the lines to polygons?

Best wishes,

Mark


From mdsumner at gmail.com  Tue Jul 16 15:17:14 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 16 Jul 2013 23:17:14 +1000
Subject: [R-sig-Geo] Area calculation workflow
In-Reply-To: <CAGBzUO8yBU05+yeSvvsFkgT-hQbQGvSyHEEzQnVUAqWMYSr13Q@mail.gmail.com>
References: <CAGBzUO8yBU05+yeSvvsFkgT-hQbQGvSyHEEzQnVUAqWMYSr13Q@mail.gmail.com>
Message-ID: <CAAcGz9-n=SapA8TKc+poeqf-FGmGoZN5C3gU0REoLpe6sU0uEg@mail.gmail.com>

It's probably easier to use area() on the raster in the first place,
and subset on that with your range of temperatures. You wear an
approximation with area() on longlat but probably no more than you
introduce by another route, and it's easy to test with simpler made up
objects.

(Closing polygons with lines from contours is hard)

library(raster)
## (nothing realistic about this)
r <- raster(volcano, xmn = 0, xmx = 10, ymn = 20, ymx = 40, crs =
"+proj=longlat")

## get longlat-approx cell areas, and subset on "temperatures" in the
range [110, 130]
sum(area(r)[][r[] > 110 & r[] < 130])





On Tue, Jul 16, 2013 at 10:28 PM, Mark Payne <markpayneatwork at gmail.com> wrote:
> Hi,
>
> I have a SpatialGridDataFrame with sea-surface temperatures based on
> lon/lat coordinates that I want to use to calculate the area (in
> square km) contained within an isotherm. I'm still a little unsure in
> this type of thing, so just wanted to check that the workflow is
> correct.
>
> I can get the isotherm out ok, using as.image.SpatialGridDataFrame(),
> contourLines() and then back to sp with ContourLines2SLDF. This gives
> me a set of SpatialLines in lat-lon space. But now I get a bit stuck.
>
> I guessing that are three steps
> 1. Close the lines to make polygons (but how?)
> 2. Convert to UTM e.g. using spTransform() from rgdal package
> 3. Extract the area of each individual polygon from the polygons slot
>
> Is this is the quickest and easiest approach? Or have I overlooked
> something? And how do I conver the lines to polygons?
>
> Best wishes,
>
> Mark
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From waldircj at gmail.com  Tue Jul 16 19:17:37 2013
From: waldircj at gmail.com (Waldir de Carvalho Junior)
Date: Tue, 16 Jul 2013 14:17:37 -0300
Subject: [R-sig-Geo] export classification from spatialpixelsdataframe
Message-ID: <CAFs5Q4L5EDK7CyF2CVaTDr+8HTW_LQ5py167hm6V=gsZxyRAxw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130716/79b7b3e6/attachment.pl>

From vitale232 at gmail.com  Tue Jul 16 22:22:56 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 16 Jul 2013 13:22:56 -0700
Subject: [R-sig-Geo] Raster Package Crash raster:::terrain
Message-ID: <CAFTcopczuLuubMJh8VAStgfRMMOkaVMc2xKZ6SOUh3p0OaOoBw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130716/0a14d9c2/attachment.pl>

From mdsumner at gmail.com  Tue Jul 16 23:31:20 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 17 Jul 2013 07:31:20 +1000
Subject: [R-sig-Geo] Raster Package Crash raster:::terrain
In-Reply-To: <CAFTcopczuLuubMJh8VAStgfRMMOkaVMc2xKZ6SOUh3p0OaOoBw@mail.gmail.com>
References: <CAFTcopczuLuubMJh8VAStgfRMMOkaVMc2xKZ6SOUh3p0OaOoBw@mail.gmail.com>
Message-ID: <CAAcGz99AbRSo4xpM7BVZ6=viMm4EKVjM-xG3huygWkxi1YbPQw@mail.gmail.com>

That's a pretty old version of raster (released over a month ago :).

FWIW, I can run your code successfully with the latest CRAN version so
perhaps see if that fixes the issue first.

(sessionInfo below)

Cheers, Mike.

R version 3.0.1 Patched (2013-07-07 r63210)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252
[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C
[5] LC_TIME=English_Australia.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  compiler  methods
[8] base

other attached packages:
[1] raster_2.1-49 sp_1.0-11

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15



On Wed, Jul 17, 2013 at 6:22 AM, Andrew Vitale <vitale232 at gmail.com> wrote:
> Hello,
>
> I'm getting some strange behavior from the raster package terrain(opt =
> 'roughness') function.
>
> I have a large (~1GB) digital elevation model in .grd format that was
> created from a past R session.  When I load the file in and attempt to
> calculate the roughness index, I consistently crash R.
>
> In an attempt to debug, I created a raster file with the same extent,
> nrows, ncols, and crs as my actual data, and set random values with the
> same min and max.  My system is storing the file in memory rather than
> writing to the temporary library.  The terrain(opt = 'roughness') function
> sometimes runs with the raster in RAM, but usually doesn't.
>
> Since running from memory doesn't help me with my problem, I've created the
> sample script to save the simulated DEM to disk then exit R without saving
> the session.  You'll then have to restart R.  The second part of the code
> attempts to reload the simulated DEM and calculate roughness, and this
> piece of code crashes every time I run it (as it does with my actual data).
>
> Here is my sessionInfo(), and a sample code follows:
>
>
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.1-37 sp_1.0-9
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15
>
>
> #===============================================================================
> #Example code
> #Set the working directory to your system
> #===============================================================================
> setwd('C:/Users/avitale/Documents')
> library(raster)
>
> #set the extent, resolution, and crs to match my data
> r <- raster(xmn =  688256.5, xmx = 779259.5, ymn = 4276005, ymx = 4396000,
> nrows = 11650, ncols = 11347,
> crs = "+proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84
> +towgs84=0,0,0")
>
> set.seed(232)
> r[] <- runif(ncell(r), min = 1352, max = 3981)
>
> #Write r to disk and exit the r session without saving
> r <- writeRaster(r, 'r_from_File.grd', overwrite = TRUE)
> q(save = 'no')
>
> #===============================================================================
> #Restart R!!!
> #Set the working directory to your system
> #===============================================================================
> setwd('C:/Users/avitale/Documents')
> library(raster)
>
> r <- raster(file.path(getwd(), 'r_from_File.grd'))
> rough <- terrain(r, opt = 'roughness', filename = 'roughness_test.grd',
> overwrite = TRUE)
>
>
>
> --
> *Andrew P. Vitale*
> Masters Student
> Department of Geography
> University of Nevada, Reno
> (412) 915-3632
> vitale232 at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.hijmans at gmail.com  Wed Jul 17 00:37:21 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 16 Jul 2013 15:37:21 -0700
Subject: [R-sig-Geo] Raster Package Crash raster:::terrain
In-Reply-To: <CAAcGz99AbRSo4xpM7BVZ6=viMm4EKVjM-xG3huygWkxi1YbPQw@mail.gmail.com>
References: <CAFTcopczuLuubMJh8VAStgfRMMOkaVMc2xKZ6SOUh3p0OaOoBw@mail.gmail.com>
	<CAAcGz99AbRSo4xpM7BVZ6=viMm4EKVjM-xG3huygWkxi1YbPQw@mail.gmail.com>
Message-ID: <CANtt_hyJADNwAdUHO3M+1F7=HsW0P+yFE4CPrgyeT=EVJUyrgw@mail.gmail.com>

Andrew,


A simpler script that works for me (indeed with the version of raster)

library(raster)
r <- raster(xmn =  688256.5, xmx = 779259.5, ymn = 4276005, ymx =
4396000, nrows = 11650, ncols = 11347, crs = "+proj=utm +zone=11
+datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0")
set.seed(232)
r <- init(r, function(x) runif(x, min = 1352, max = 3981),
filename='r_from_File.grd', overwrite = TRUE)
rough <- terrain(r, opt = 'roughness', filename =
'roughness_test.grd', overwrite = TRUE)


If this uses too much RAM for your computer, then use a more
conservative chunksize. Set it to e.g.

rasterOptions(chunksize=1e+06)
# and do
r <- raster('r_from_File.grd')
rough <- terrain(r, opt = 'roughness', filename =
'roughness_test.grd', overwrite = TRUE)

Robert

On Tue, Jul 16, 2013 at 2:31 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> That's a pretty old version of raster (released over a month ago :).
>
> FWIW, I can run your code successfully with the latest CRAN version so
> perhaps see if that fixes the issue first.
>
> (sessionInfo below)
>
> Cheers, Mike.
>
> R version 3.0.1 Patched (2013-07-07 r63210)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252
> [3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C
> [5] LC_TIME=English_Australia.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  compiler  methods
> [8] base
>
> other attached packages:
> [1] raster_2.1-49 sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.1      lattice_0.20-15
>
>
>
> On Wed, Jul 17, 2013 at 6:22 AM, Andrew Vitale <vitale232 at gmail.com> wrote:
>> Hello,
>>
>> I'm getting some strange behavior from the raster package terrain(opt =
>> 'roughness') function.
>>
>> I have a large (~1GB) digital elevation model in .grd format that was
>> created from a past R session.  When I load the file in and attempt to
>> calculate the roughness index, I consistently crash R.
>>
>> In an attempt to debug, I created a raster file with the same extent,
>> nrows, ncols, and crs as my actual data, and set random values with the
>> same min and max.  My system is storing the file in memory rather than
>> writing to the temporary library.  The terrain(opt = 'roughness') function
>> sometimes runs with the raster in RAM, but usually doesn't.
>>
>> Since running from memory doesn't help me with my problem, I've created the
>> sample script to save the simulated DEM to disk then exit R without saving
>> the session.  You'll then have to restart R.  The second part of the code
>> attempts to reload the simulated DEM and calculate roughness, and this
>> piece of code crashes every time I run it (as it does with my actual data).
>>
>> Here is my sessionInfo(), and a sample code follows:
>>
>>
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.1-37 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-15
>>
>>
>> #===============================================================================
>> #Example code
>> #Set the working directory to your system
>> #===============================================================================
>> setwd('C:/Users/avitale/Documents')
>> library(raster)
>>
>> #set the extent, resolution, and crs to match my data
>> r <- raster(xmn =  688256.5, xmx = 779259.5, ymn = 4276005, ymx = 4396000,
>> nrows = 11650, ncols = 11347,
>> crs = "+proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84
>> +towgs84=0,0,0")
>>
>> set.seed(232)
>> r[] <- runif(ncell(r), min = 1352, max = 3981)
>>
>> #Write r to disk and exit the r session without saving
>> r <- writeRaster(r, 'r_from_File.grd', overwrite = TRUE)
>> q(save = 'no')
>>
>> #===============================================================================
>> #Restart R!!!
>> #Set the working directory to your system
>> #===============================================================================
>> setwd('C:/Users/avitale/Documents')
>> library(raster)
>>
>> r <- raster(file.path(getwd(), 'r_from_File.grd'))
>> rough <- terrain(r, opt = 'roughness', filename = 'roughness_test.grd',
>> overwrite = TRUE)
>>
>>
>>
>> --
>> *Andrew P. Vitale*
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632
>> vitale232 at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From milansharma2012 at yahoo.com  Wed Jul 17 17:27:26 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 17 Jul 2013 08:27:26 -0700 (PDT)
Subject: [R-sig-Geo] Citation
Message-ID: <1374074846.65995.YahooMailNeo@web162101.mail.bf1.yahoo.com>

Hi Roger,
If I am using a number of packages from R, what is the general practice of citation (to cite all the packages individually or to cite R as a whole) in scientific journal ?publications?
Thanks,
Milan


From jemiller31 at gmail.com  Wed Jul 17 17:31:22 2013
From: jemiller31 at gmail.com (Joseph Miller)
Date: Wed, 17 Jul 2013 10:31:22 -0500
Subject: [R-sig-Geo] Clipping raster by polygon
Message-ID: <CAE+tLNAJZVxw4E=LA2upq+8EXrMDExY5-yrpGE=kR34XbjU0wQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130717/7521777e/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jul 17 17:34:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 17 Jul 2013 17:34:41 +0200
Subject: [R-sig-Geo] Citation
In-Reply-To: <1374074846.65995.YahooMailNeo@web162101.mail.bf1.yahoo.com>
References: <1374074846.65995.YahooMailNeo@web162101.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1307171731150.12673@reclus.nhh.no>

On Wed, 17 Jul 2013, Milan Sharma wrote:

> Hi Roger,
> If I am using a number of packages from R, what is the general practice 
> of citation (to cite all the packages individually or to cite R as a 
> whole) in scientific journal ?publications?

It will depend on how much your work depends on the packages. If the 
packages make a contribution that you feel referees and readers should be 
referred to (so that they can check what you did), include them in the 
references. For R, this is FAQ 2.8, otherwise ?citation. Journals also 
vary in their practice.

Roger

> Thanks,
> Milan
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Rizzo.Michael at epa.gov  Wed Jul 17 18:17:17 2013
From: Rizzo.Michael at epa.gov (Rizzo, Michael)
Date: Wed, 17 Jul 2013 16:17:17 +0000
Subject: [R-sig-Geo] Scaling SpatialPolygons
Message-ID: <a4d711d34b1d4a059585c74cd96cd09f@BLUPR09MB040.namprd09.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130717/d409c1d8/attachment.pl>

From r.hijmans at gmail.com  Wed Jul 17 19:01:09 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Jul 2013 10:01:09 -0700
Subject: [R-sig-Geo] Scaling SpatialPolygons
In-Reply-To: <a4d711d34b1d4a059585c74cd96cd09f@BLUPR09MB040.namprd09.prod.outlook.com>
References: <a4d711d34b1d4a059585c74cd96cd09f@BLUPR09MB040.namprd09.prod.outlook.com>
Message-ID: <CANtt_hzf5vm0UO6k0w=r4K4Rt+9uEnHT53+GKPjj3Wm1SvenWA@mail.gmail.com>

Mike, You can create a small inside (negative) buffer using rgeos and
use that. Robert

On Wed, Jul 17, 2013 at 9:17 AM, Rizzo, Michael <Rizzo.Michael at epa.gov> wrote:
> I have a group of counties in a SpatialPolygonsDataFrame and would like to know if a function exists to scale them.  Many of the counties share a common border, and I want to color each county's border differently to distinguish them by individual categories.  The problem is the border colors overlap for adjacent counties.   I thought if I could scale the individual polygons down to 95% of their original size, the boundaries of adjacent counties would appear side by side without the overlap.
>
> I created my own function to do this but concave polygons don't scale 100% correctly and still overlap each other a little so I am hoping there may be a pre-defined function that would scale the county polygons correctly.
>
> Thank you,
> Mike Rizzo
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Wed Jul 17 19:02:12 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Jul 2013 10:02:12 -0700
Subject: [R-sig-Geo] Clipping raster by polygon
In-Reply-To: <CAE+tLNAJZVxw4E=LA2upq+8EXrMDExY5-yrpGE=kR34XbjU0wQ@mail.gmail.com>
References: <CAE+tLNAJZVxw4E=LA2upq+8EXrMDExY5-yrpGE=kR34XbjU0wQ@mail.gmail.com>
Message-ID: <CANtt_hy1VYWiP+rDHYS+mhGm1aGSSUeGbHcXjzFyPJXxR6ahXw@mail.gmail.com>

Joseph, Perhaps you can use raster function crop, perhaps followed by
mask. Robert


On Wed, Jul 17, 2013 at 8:31 AM, Joseph Miller <jemiller31 at gmail.com> wrote:
> Hello-
>
> I am trying to clip a raster with a Spatial Polygons Data Frame (esri
> shapefile).  I reviewed the rgeos package documentation but could not find
> an adequate tool to do this.  Suggestions?
>
> Thanks,
> Joseph
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Rizzo.Michael at epa.gov  Wed Jul 17 19:25:51 2013
From: Rizzo.Michael at epa.gov (Rizzo, Michael)
Date: Wed, 17 Jul 2013 17:25:51 +0000
Subject: [R-sig-Geo] Scaling SpatialPolygons
In-Reply-To: <CANtt_hzf5vm0UO6k0w=r4K4Rt+9uEnHT53+GKPjj3Wm1SvenWA@mail.gmail.com>
References: <a4d711d34b1d4a059585c74cd96cd09f@BLUPR09MB040.namprd09.prod.outlook.com>
	<CANtt_hzf5vm0UO6k0w=r4K4Rt+9uEnHT53+GKPjj3Wm1SvenWA@mail.gmail.com>
Message-ID: <016268a8540545c5a4a5de4b9a36a86d@BLUPR09MB040.namprd09.prod.outlook.com>

Robert,
Thank you!  That did exactly what I needed.

Mike Rizzo

-----Original Message-----
From: Robert J. Hijmans [mailto:r.hijmans at gmail.com] 
Sent: Wednesday, July 17, 2013 12:01 PM
To: Rizzo, Michael
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Scaling SpatialPolygons

Mike, You can create a small inside (negative) buffer using rgeos and use that. Robert

On Wed, Jul 17, 2013 at 9:17 AM, Rizzo, Michael <Rizzo.Michael at epa.gov> wrote:
> I have a group of counties in a SpatialPolygonsDataFrame and would like to know if a function exists to scale them.  Many of the counties share a common border, and I want to color each county's border differently to distinguish them by individual categories.  The problem is the border colors overlap for adjacent counties.   I thought if I could scale the individual polygons down to 95% of their original size, the boundaries of adjacent counties would appear side by side without the overlap.
>
> I created my own function to do this but concave polygons don't scale 100% correctly and still overlap each other a little so I am hoping there may be a pre-defined function that would scale the county polygons correctly.
>
> Thank you,
> Mike Rizzo
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From 538280 at gmail.com  Wed Jul 17 19:43:00 2013
From: 538280 at gmail.com (Greg Snow)
Date: Wed, 17 Jul 2013 11:43:00 -0600
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <A7557249237BD449977E3AEE33C62AD340DC0320@DBXPRD0410MB394.eurprd04.prod.outlook.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzRxO8RYd2AVOeu0miyZeBp39VzvVOV2KuTFPnw=6Uwvg@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DC0320@DBXPRD0410MB394.eurprd04.prod.outlook.com>
Message-ID: <CAFEqCdwx=X0TUoT6kjy9+aN0UFkYEUS6zqtkbvFs_-jbU1oxsg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130717/db7e068a/attachment.pl>

From vitale232 at gmail.com  Wed Jul 17 19:50:48 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Wed, 17 Jul 2013 10:50:48 -0700
Subject: [R-sig-Geo] Raster Package Crash raster:::terrain
In-Reply-To: <CANtt_hyJADNwAdUHO3M+1F7=HsW0P+yFE4CPrgyeT=EVJUyrgw@mail.gmail.com>
References: <CAFTcopczuLuubMJh8VAStgfRMMOkaVMc2xKZ6SOUh3p0OaOoBw@mail.gmail.com>
	<CAAcGz99AbRSo4xpM7BVZ6=viMm4EKVjM-xG3huygWkxi1YbPQw@mail.gmail.com>
	<CANtt_hyJADNwAdUHO3M+1F7=HsW0P+yFE4CPrgyeT=EVJUyrgw@mail.gmail.com>
Message-ID: <CAFTcopejOUQHuJRUDr_PmrJ7WYPYzKBstdtu5cHUtr3cejkxVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130717/7b347163/attachment.pl>

From paolo.piras at uniroma3.it  Wed Jul 17 22:50:02 2013
From: paolo.piras at uniroma3.it (Paolo Piras)
Date: Wed, 17 Jul 2013 20:50:02 +0000
Subject: [R-sig-Geo] R or R studio 3d manipulate
In-Reply-To: <CAFEqCdwx=X0TUoT6kjy9+aN0UFkYEUS6zqtkbvFs_-jbU1oxsg@mail.gmail.com>
References: <A7557249237BD449977E3AEE33C62AD340DAB414@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzzETQqJV=VYm1L5JMfd_GpkEMz5rz6D+YseCfkcLTeCw@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DAB612@DBXPRD0410MB394.eurprd04.prod.outlook.com>
	<CAFEqCdzRxO8RYd2AVOeu0miyZeBp39VzvVOV2KuTFPnw=6Uwvg@mail.gmail.com>
	<A7557249237BD449977E3AEE33C62AD340DC0320@DBXPRD0410MB394.eurprd04.prod.outlook.com>,
	<CAFEqCdwx=X0TUoT6kjy9+aN0UFkYEUS6zqtkbvFs_-jbU1oxsg@mail.gmail.com>
Message-ID: <A7557249237BD449977E3AEE33C62AD340DC0660@DBXPRD0410MB394.eurprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130717/5dc6c74e/attachment.pl>

From r.ponce.reyes at gmail.com  Thu Jul 18 09:05:18 2013
From: r.ponce.reyes at gmail.com (Rocio Ponce)
Date: Thu, 18 Jul 2013 02:05:18 -0500
Subject: [R-sig-Geo] working with large ascii files in R
Message-ID: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/0857f249/attachment.pl>

From roman.lustrik at gmail.com  Thu Jul 18 09:26:03 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 18 Jul 2013 09:26:03 +0200
Subject: [R-sig-Geo] working with large ascii files in R
In-Reply-To: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
References: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
Message-ID: <CAHT1vphq2aDrN7K2vVR5cwF2s3Yt+nO+G5sVWFWmwW18wBjH0w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/c41b2705/attachment.pl>

From dfvv at yahoo.com  Thu Jul 18 10:36:00 2013
From: dfvv at yahoo.com (Diego Valbuena)
Date: Thu, 18 Jul 2013 01:36:00 -0700 (PDT)
Subject: [R-sig-Geo] Extract multiple raster but obtain NULL values
Message-ID: <1374136560.70479.YahooMailNeo@web141103.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/f8f6ee47/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Thu Jul 18 10:38:12 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 18 Jul 2013 10:38:12 +0200
Subject: [R-sig-Geo] working with large ascii files in R
In-Reply-To: <CAHT1vphq2aDrN7K2vVR5cwF2s3Yt+nO+G5sVWFWmwW18wBjH0w@mail.gmail.com>
References: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
	<CAHT1vphq2aDrN7K2vVR5cwF2s3Yt+nO+G5sVWFWmwW18wBjH0w@mail.gmail.com>
Message-ID: <51E7A974.1000909@jrc.ec.europa.eu>

On 07/18/2013 09:26 AM, Roman Lu?trik wrote:
> Have you considered updating your R and associated packages?

As Roman mentioned, I also suggest you, as first step, to update R (and 
all the packages) up to version 3 or higher, because one of the 
significant user changes introduced in R 3.0.0 was related to memory 
(from the NEWS file):

      "It is now possible for 64-bit builds to allocate amounts of
       memory limited only by the OS.  It may be wise to use OS
       facilities (e.g. ulimit in a bash shell, limit in csh), to set
       limits on overall memory consumption of an R process,
       particularly in a multi-user environment.  A number of packages
       need a limit of at least 4GB of virtual memory to load.

       64-bit Windows builds of R are by default limited in memory usage
       to the amount of RAM installed: this limit can be changed by
       command-line option --max-mem-size or setting environment
       variable R_MAX_MEM_SIZE."

Kind regards,

Mauricio Zambrano-Bigiarini, Ph.D

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
Work Phone : +39 0332 789588
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
"The journey is the reward"  (Steve Jobs)

> There's also a plethora of other GUI based GIS systems. Just the other day,
> I found Quantum GIS to be very user friendly.
>
> That being said, I suggest you use R. :)
>
> Cheers,
> Roman
>
>
>
> On Thu, Jul 18, 2013 at 9:05 AM, Rocio Ponce <r.ponce.reyes at gmail.com>wrote:
>
>> Hi there,
>> I'm a newie in using R to make maps... I used to work with ArcGis but I ran
>> out of a valid license...
>>
>> I'm trying to crop the future Worldclim datasets layers which are huge
>> ascii files (of the whole world at 1km resolution, so they are between
>> 3-4GB each)  to the extent of Mexico using the library (raster).
>>
>> I used the following code:
>>
>>> setwd('G:/future_A2a/2020/bccr_bcm2_0_sres_a2_2020s/')
>>> maask<-  read.asc("C:/xalapa/worldclim_pres/bio01.asc",gz=FALSE)
>>> mask<-raster.from.asc(maask,projs=NA)
>>> files <- list.files(pattern='\\.asc$')
>>> s <- stack(files)
>>> crop(s, mask)
>> Error: cannot allocate vector of size 253.2 Mb
>>
>>
>> I'm using R.2.14.1 on a computer running on Windows XP
>> Any help that you could provide me would be greatly appreciated,
>>
>> Cheers,
>> Rocio
>>
>> --
>> Dr. Rocio Ponce-Reyes
>>
>> http://rocioponcereyes.wordpress.com/
>>
>> (disculpe la falta de acentos en este correo electronico)
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>


From mathieu.rajerison at gmail.com  Thu Jul 18 11:17:13 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 18 Jul 2013 11:17:13 +0200
Subject: [R-sig-Geo] Scaling SpatialPolygons
In-Reply-To: <016268a8540545c5a4a5de4b9a36a86d@BLUPR09MB040.namprd09.prod.outlook.com>
References: <a4d711d34b1d4a059585c74cd96cd09f@BLUPR09MB040.namprd09.prod.outlook.com>
	<CANtt_hzf5vm0UO6k0w=r4K4Rt+9uEnHT53+GKPjj3Wm1SvenWA@mail.gmail.com>
	<016268a8540545c5a4a5de4b9a36a86d@BLUPR09MB040.namprd09.prod.outlook.com>
Message-ID: <CAGfc75mS08ZmQhMZjraDyR66xz6N6YKjuGNODt8f1WMAZS8Kdw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/40d9dbe5/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Thu Jul 18 11:27:46 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 18 Jul 2013 11:27:46 +0200
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
In-Reply-To: <CANtt_hzdDA9nV4GzQ6OZrSf2pfaexevV2And1i-kZ=w1+p0_CA@mail.gmail.com>
References: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
	<51DE589D.20301@jrc.ec.europa.eu>
	<CABkCotTrJNpb2h9-J25GNPDLXXp7iuMn6GbrfLOsvb7qN3=ZJQ@mail.gmail.com>
	<CANtt_hzdDA9nV4GzQ6OZrSf2pfaexevV2And1i-kZ=w1+p0_CA@mail.gmail.com>
Message-ID: <51E7B512.2000808@jrc.ec.europa.eu>

On 07/13/2013 01:44 AM, Robert J. Hijmans wrote:
> I do not the data have changed. Wrong min and max values are reported,
> however. Seems to me that in this case gdal does not know the min and
> max values but reports  -2147483648, 2147483647. You could check with
> GDALinfo. I guess that this is a  shortcoming of (your version of?)
> gdal, not rgdal. Robert

Just in case still be useful.

I tried to reproduce the wrongly reported values for min and max using 
an .asc file I'm using, but I couldn't:

------------ START -----------
library(raster)

# entering to the directory where the .asc file is stored
# setwd("~")

# Creation of a raster file for testing
r <- raster("temp2.asc")

# rgdal: version: 0.8-10, (SVN revision 478)
# Geospatial Data Abstraction Library extensions to R successfully loaded
# Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
# Path to GDAL shared files: /usr/share/gdal
# Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
# Path to PROJ.4 shared files: (autodetected)

# Summary of the original raster file
summary(r)

#                temp2
# Min.    2.668977e-02
# 1st Qu. 1.474479e-01
# Median  2.109602e-01
# 3rd Qu. 4.575650e-01
# Max.    7.108980e+00
# NA's    1.690500e+04

# Writing the raster from memory to disk (as a new file)
writeRaster(r, filename="temp2_new.asc", format="ascii",overwrite=TRUE)

# class       : RasterLayer
# dimensions  : 254, 262, 66548  (nrow, ncol, ncell)
# resolution  : 5000, 5000  (x, y)
# extent      : -1045000, 265000, -620000, 650000  (xmin, xmax, ymin, ymax)
# coord. ref. : NA
# data source : /home/hzambran/temp2_new.asc
# names       : temp2_new

# reading the .asc file form disk
r2 <- raster("temp2_new.asc")

# Summary of the .asc file in the hard disk
summary(r2)

#            temp2_new
# Min.    2.668977e-02
# 1st Qu. 1.474479e-01
# Median  2.109602e-01
# 3rd Qu. 4.575650e-01
# Max.    7.108980e+00
# NA's    1.690500e+04

# the same summary values are the same as for the original raster (r)

------------ END -----------

I'm using the same rgdal version of Manuel (0.8-10), so as Roger 
mentioned before, the error should come from your GDAL version. I'm 
using GDAL 1.9.2, released 2012/10/08 (not the latest...)

Kind regards,

Mauricio

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
"The journey is the reward"  (Steve Jobs)


>
> On Thu, Jul 11, 2013 at 5:04 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>> Thank you Mauricio.
>>
>>> sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] grid      stats     graphics  grDevices utils     datasets  methods
>> base
>>
>> other attached packages:
>> [1] SDMTools_1.1-13 dismo_0.8-11    raster_2.1-37   rgdal_0.8-10
>>   maptools_0.8-25
>> [6] lattice_0.20-15 sp_1.0-11       foreign_0.8-54
>>
>> loaded via a namespace (and not attached):
>> [1] tools_3.0.1
>>
>>
>> 2013/7/11 Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu>
>>
>>> On 10/07/13 18:38, Manuel Sp?nola wrote:
>>>
>>>> Dear list members,
>>>>
>>>> I am trying to export a raster file to a ascii file (.asc) but the min and
>>>> max values are not the same. Any idea why?
>>>>
>>>
>>> Hi Manuel,
>>>
>>> Could you provide your sessionInfo() ?
>>>
>>>>
>>>>   bio1res
>>>>>
>>>> class       : RasterLayer
>>>> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : NA
>>>> data source : in memory
>>>> names       : bio1_23
>>>> values      : 47, 272  (min, max)
>>>>
>>>>   writeRaster(bio1res, filename="temp.asc", format="ascii",overwrite=TRUE)
>>>>>
>>>> class       : RasterLayer
>>>> dimensions  : 382, 407, 155474  (nrow, ncol, ncell)
>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>> extent      : -85.95, -82.55833, 8.041667, 11.225  (xmin, xmax, ymin,
>>>> ymax)
>>>> coord. ref. : NA
>>>> data source : /Users/manuelspinola/Dropbox/**Distribucio? n de
>>>>
>>>> especies/World_Clim_Costa_**Rica/temp.asc
>>>> names       : temp
>>>> values      : -2147483648, 2147483647  (min, max)
>>>>
>>>
>>> Unfortunately, your example is not reproducible, so I tried with a
>>> different example and the values in the original and the written ascii file
>>> were the same (rgdal_0.8-10, raster_2.1-48, sp_1.0-11):
>>>
>>> ----------  START --------------
>>> library(raster)
>>> Loading required package: sp
>>>
>>> # Creation of a raster file for testing
>>> r <- raster(system.file("external/**test.grd", package="raster"))
>>>
>>> r
>>> #class       : RasterLayer
>>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>>> #resolution  : 40, 40  (x, y)
>>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : +init=epsg:28992 +towgs84=565.237,50.0087,465.**
>>> 658,-0.406857,0.350733,-1.**87035,4.0812 +proj=sterea
>>> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000
>>> +y_0=463000 +ellps=bessel +units=m +no_defs
>>> #data source : /usr/lib64/R/library/raster/**external/test.grd
>>> #names       : test
>>> #values      : 128.434, 1805.78  (min, max)
>>>
>>> writeRaster(r, filename="temp.asc", format="ascii",overwrite=TRUE)
>>> #rgdal: version: 0.8-10, (SVN revision 478)
>>> #Geospatial Data Abstraction Library extensions to R successfully loaded
>>> #Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>> #Path to GDAL shared files: /usr/share/gdal
>>> #Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>> #Path to PROJ.4 shared files: (autodetected)
>>> #class       : RasterLayer
>>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>>> #resolution  : 40, 40  (x, y)
>>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : NA
>>> #data source : /home/zambrhe/temp.asc
>>> #names       : temp
>>>
>>> # reading the .asc file form disk
>>> r2 <- raster("temp.asc")
>>>
>>> r2
>>> #class       : RasterLayer
>>> #dimensions  : 115, 80, 9200  (nrow, ncol, ncell)
>>> #resolution  : 40, 40  (x, y)
>>> #extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : NA
>>> #data source : /home/zambrhe/temp.asc
>>> #names       : temp
>>>
>>> # Summary of the ascii file in the hard disk
>>> #summary(r2)
>>> #             temp
>>> #Min.     128.4340
>>> #1st Qu.  293.2325
>>> #Median   371.4120
>>> #3rd Qu.  499.8195
>>> #Max.    1805.7800
>>> #NA's    6097.0000
>>>
>>>
>>> # Summary of the original raster file
>>> summary(r)
>>> #             test
>>> #Min.     128.4340
>>> #1st Qu.  293.2325
>>> #Median   371.4120
>>> #3rd Qu.  499.8195
>>> #Max.    1805.7800
>>> #NA's    6097.0000
>>> ----------  END --------------
>>>
>>> Kind regards,
>>>
>>> Mauricio Zambrano-Bigiarini, Ph.D
>>>
>>> --
>>> ==============================**===================
>>> Water Resources Unit
>>> Institute for Environment and Sustainability (IES)
>>> Joint Research Centre (JRC), European Commission
>>> TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
>>> Work Phone : +39 0332 789588
>>> webinfo    : http://floods.jrc.ec.europa.**eu/<http://floods.jrc.ec.europa.eu/>
>>> ==============================**===================
>>> DISCLAIMER:
>>> "The views expressed are purely those of the writer
>>> and may not in any circumstances be regarded as sta-
>>> ting an official position of the European Commission"
>>> ==============================**===================
>>> "The journey is the reward"  (Steve Jobs)
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.ac.cr
>> mspinola10 at gmail.com
>> Tel?fono: (506) 2277-3598
>> Fax: (506) 2237-7036
>> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>>          [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From ulrich.leopold at tudor.lu  Thu Jul 18 11:44:15 2013
From: ulrich.leopold at tudor.lu (ulrich.leopold at tudor.lu)
Date: Thu, 18 Jul 2013 11:44:15 +0200
Subject: [R-sig-Geo] spplot: correct display of data minimum in colour key
Message-ID: <OF83B1B1EC.DB8C5153-ONC1257BAC.00357D86-C1257BAC.00357D92@tudor.lu>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/65cde7a2/attachment.html>

From mspinola10 at gmail.com  Thu Jul 18 16:35:34 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 18 Jul 2013 08:35:34 -0600
Subject: [R-sig-Geo] writeRaster to ascii file (.asc)
In-Reply-To: <51E7B512.2000808@jrc.ec.europa.eu>
References: <CABkCotTup62cbAzPcUnT=+iSuPGkLRPPuTPDJpaVf8nQ2D_11w@mail.gmail.com>
	<51DE589D.20301@jrc.ec.europa.eu>
	<CABkCotTrJNpb2h9-J25GNPDLXXp7iuMn6GbrfLOsvb7qN3=ZJQ@mail.gmail.com>
	<CANtt_hzdDA9nV4GzQ6OZrSf2pfaexevV2And1i-kZ=w1+p0_CA@mail.gmail.com>
	<51E7B512.2000808@jrc.ec.europa.eu>
Message-ID: <CABkCotQmM=69eYFXEHDinU45MUeU9e7eVjH+-mQ3psQsMKXvSw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/46fb83c8/attachment.pl>

From ipaajs at gmail.com  Thu Jul 18 16:59:28 2013
From: ipaajs at gmail.com (ipampa)
Date: Thu, 18 Jul 2013 07:59:28 -0700 (PDT)
Subject: [R-sig-Geo] CAR vs BESAG
Message-ID: <1374159568154-7584180.post@n2.nabble.com>

Hello, I am new to spatial stats and I was wondering what is the difference
between a CAR and a BESAG model. BYM is equal to BESAG?

sorry I am not a statistician



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/CAR-vs-BESAG-tp7584180.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Jul 18 18:14:41 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 18 Jul 2013 09:14:41 -0700
Subject: [R-sig-Geo] working with large ascii files in R
In-Reply-To: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
References: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
Message-ID: <CANtt_hx3FSmwz-Lmy6hcm5eQrega0rMMjRqe207x4cYDRK7LEg@mail.gmail.com>

Rocio,

You should not use functions read.asc and raster.from.asc because they
read all the values into memory. Also please indicated which packages
you use. The below should fix the problem:

setwd('G:/future_A2a/2020/bccr_bcm2_0_sres_a2_2020s/')
library(raster)
mask<-raster("C:/xalapa/worldclim_pres/bio01.asc")
files <- list.files(pattern='\\.asc$')
s <- stack(files)
x <- crop(s, mask)

And it would indeed good to use a current version of R and its packages.
Robert


On Thu, Jul 18, 2013 at 12:05 AM, Rocio Ponce <r.ponce.reyes at gmail.com> wrote:
> Hi there,
> I'm a newie in using R to make maps... I used to work with ArcGis but I ran
> out of a valid license...
>
> I'm trying to crop the future Worldclim datasets layers which are huge
> ascii files (of the whole world at 1km resolution, so they are between
> 3-4GB each)  to the extent of Mexico using the library (raster).
>
> I used the following code:
>
>>setwd('G:/future_A2a/2020/bccr_bcm2_0_sres_a2_2020s/')
>>maask<-  read.asc("C:/xalapa/worldclim_pres/bio01.asc",gz=FALSE)
>>mask<-raster.from.asc(maask,projs=NA)
>>files <- list.files(pattern='\\.asc$')
>>s <- stack(files)
>> crop(s, mask)
> Error: cannot allocate vector of size 253.2 Mb
>
>
> I'm using R.2.14.1 on a computer running on Windows XP
> Any help that you could provide me would be greatly appreciated,
>
> Cheers,
> Rocio
>
> --
> Dr. Rocio Ponce-Reyes
>
> http://rocioponcereyes.wordpress.com/
>
> (disculpe la falta de acentos en este correo electronico)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Thu Jul 18 18:22:36 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 18 Jul 2013 09:22:36 -0700
Subject: [R-sig-Geo] Extract multiple raster but obtain NULL values
In-Reply-To: <1374136560.70479.YahooMailNeo@web141103.mail.bf1.yahoo.com>
References: <1374136560.70479.YahooMailNeo@web141103.mail.bf1.yahoo.com>
Message-ID: <CANtt_hx_+jXaqM-i0VWPnY7U3Gmatsm2nF5qAuLLP9chbE6oTA@mail.gmail.com>

Diego,
To check what extract does you should look at what it returns! Your
object "rasValue" in this case.
Then it should be easy to understand that the mistake is here:

combine=cbind(points,rasValue)

You can fix it like this:

combine=cbind(coordinates(points), rasValue)
Robert


On Thu, Jul 18, 2013 at 1:36 AM, Diego Valbuena <dfvv at yahoo.com> wrote:
> Hello All,
>
> This must be a simple mistake but I'm trying to get information for few points of 10.000 raster files (TIFF) into a table. If I do it individually, I get the real values for each individual raster. But if I do it using "stack" (see below), I get the correct values only for the first raster; for the other raster files I get NULL. Would you have a suggestion to make it work (I'm using R 3.0.1)?
> Thanks, Diego
>
>
>
> library (sp)
> library (rgdal)
> library (raster)
>
> f <- list.files("folder")
>
> s <- stack(f)
>
>
> points = read.csv("points.csv")
>
> coordinates(points)= ~X+Y
>
> rasValue=extract(s, points)
>
> combine=cbind(points,rasValue)
>
>
>
>
> PS. Uploading only two raster I get this result:
>
>      points2 r19830101.1 r19830101.2
> [1,] ?       0           NULL
> [2,] ?       0           NULL
> [3,] ?       0           NULL
> [4,] ?       0           NULL
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Thu Jul 18 18:39:28 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 18 Jul 2013 18:39:28 +0200
Subject: [R-sig-Geo] spplot: correct display of data minimum in colour
 key
In-Reply-To: <OF83B1B1EC.DB8C5153-ONC1257BAC.00357D86-C1257BAC.00357D92@tudor.lu>
References: <OF83B1B1EC.DB8C5153-ONC1257BAC.00357D86-C1257BAC.00357D92@tudor.lu>
Message-ID: <51E81A40.1040705@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Ulrich, please try the "at" argument of spplot; see the following
example on lattice::levelplot, for which spplot is a front-end:

xy = expand.grid(x=1:10,y=1:10)
xy$z = runif(100)
library(lattice)
levelplot(z~x+y,xy)
levelplot(z~x+y,xy,at=(0:10)/10)


On 07/18/2013 11:44 AM, ulrich.leopold at tudor.lu wrote:
> 
> Dear all,
> 
> I try to plot a raster map  with a correct colour key using spplot.
> But the minimum seems to be smaller than the data minimum in the
> colour key.
> 
> I use the following code:
> 
> ##  Summary of raster map
>> summary(slope.grid)
> Object of class SpatialGridDataFrame Coordinates: min      max x
> 76165.36 78140.36 y 65210.14 67560.14 Is projected: NA proj4string
> : [NA] Grid attributes: cellcentre.offset cellsize cells.dim x
> 76167.86        5       395 y          65212.64        5       470 
> Data attributes: Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> NA's 0.00   19.37   31.72   34.97   48.95   83.57  131421
> 
> ## exact minimum
>> min(slope.grid$band1, na.rm = T)
> [1] 0.003956468
> 
> ## Plot Slope grid and sampling scheme l1 = list("sp.points",
> roeser.sp, pch = 21, lwd = 1, col = "black", fill = "white", cex =
> 0.8) l2 = list("SpatialPolygonsRescale", layout.north.arrow(),
> offset = c(76250,67200), scale = 300) l3 =
> list("SpatialPolygonsRescale", layout.scale.bar(), offset =
> c(77500,65300), scale = 500, fill=c("transparent","black")) l4 =
> list("sp.text", c(77500,65360), "0") l5 = list("sp.text",
> c(77750,65360), "250") l6 = list("sp.text", c(78000,65360),
> "500m") cuts = 199 at = c(0,10,20,30,40,50,60,70,80,90) 
> spplot(slope.grid, zcol = "band1", col.regions = rainbow(200,
> start= 3/15, end = 1), cuts = cuts, pretty = F, sp.layout =
> list(l1, l2, l3, l4, l5, l6), lty = 1, lwd = 0.1, scales =
> list(draw = TRUE),xlim = bbox(roeser.grid)[1,], ylim = 
> bbox(roeser.grid)[2,], main = "Slope Map with Sampling locations")
> 
> Somehow the colour key does not start with zero. Or better said,
> there is a part of the colour ramp which signalises values below
> zero. The summary statistics show that the minimum value is 0.00
> 3956468.
> 
> You can find a screenshot here: 
> http://ubuntuone.com/1b6DAeKvoMTlvFZumWuIXz Any suggestions what I
> am doing wrong?
> 
> Thanks very much, Ulrich 
> ______________________________________________
> 
> Ulrich Leopold
> 
> Senior Researcher in Geocomputation Resource Centre for
> Environmental Technologies Public Research Centre Henri Tudor 6A,
> avenue des Hauts-Fourneaux L-4362 Esch-sur-Alzette Luxembourg
> 
> tel: +352 425991 4618 fax: +352 425991 555 mobile: +352 691 304813 
> email: ulrich.leopold at tudor.lu http://www.tudor.lu
> 
> 
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR6BpAAAoJEM1OCHCtOnfxHkwH/2MYdpDHM7pNPu81pAdEgjUp
XsF64F8hCKPGA2DlFKOnthYhK10PVsdzfNZ1yISd04CqP/HyBAgwpiwWP+ie0Vji
GmslduK6Ab1YsjLZ1+PSkfSV8BESN9k6DOV4TrIpNNWtE4nubOCL+cm6xwu/aAnf
mCQo+kINq78AVs66eL+8LIoGQ7L1IGFHmR3fEMCvoCs727W8lgLJphvq2593zE05
ZnYQSJEwUFCpXWlOkbRK/lNz/KYdl35D31BWc/T728qpMLRfN0W4WlMjXUYfiQPw
vaUw+2rDPLl1RX6+4+CzBdeEiGYvufTaY24m1CRtSxc+KpmngB0ey0+iixm121c=
=mDoU
-----END PGP SIGNATURE-----


From r.ponce.reyes at gmail.com  Thu Jul 18 21:53:17 2013
From: r.ponce.reyes at gmail.com (Rocio Ponce)
Date: Thu, 18 Jul 2013 14:53:17 -0500
Subject: [R-sig-Geo] working with large ascii files in R
In-Reply-To: <CANtt_hx3FSmwz-Lmy6hcm5eQrega0rMMjRqe207x4cYDRK7LEg@mail.gmail.com>
References: <CAFgLXXAnmGYCQnLTiOE6Y7tJ-QEjULnyg6hf9sCbKjKp_tYnkg@mail.gmail.com>
	<CANtt_hx3FSmwz-Lmy6hcm5eQrega0rMMjRqe207x4cYDRK7LEg@mail.gmail.com>
Message-ID: <CAFgLXXBqZHSvZnXnwt=NOya94uOX3ESMe8rE+LSL6dUPeKCSpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/312e3a1c/attachment.pl>

From bakare at ualberta.ca  Fri Jul 19 01:21:37 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Thu, 18 Jul 2013 17:21:37 -0600
Subject: [R-sig-Geo] spatial correlation model and variogram
Message-ID: <CAJRR3XOW5KMF0CaWnEqBMxb7t4Mi8-WmDherv04C=nW5Z0vK3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130718/90ef2855/attachment.pl>

From thiemo.fetzer at gmail.com  Fri Jul 19 02:23:20 2013
From: thiemo.fetzer at gmail.com (Thiemo Fetzer)
Date: Fri, 19 Jul 2013 02:23:20 +0200
Subject: [R-sig-Geo] Transportation Network Shapefile into a Raster
Message-ID: <67938C1E-0A0A-4E4E-8784-B1CEB1ADE480@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/1eb6b454/attachment.pl>

From r.hijmans at gmail.com  Fri Jul 19 03:28:40 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 18 Jul 2013 18:28:40 -0700
Subject: [R-sig-Geo] Transportation Network Shapefile into a Raster
In-Reply-To: <67938C1E-0A0A-4E4E-8784-B1CEB1ADE480@gmail.com>
References: <67938C1E-0A0A-4E4E-8784-B1CEB1ADE480@gmail.com>
Message-ID: <CANtt_hw0FcKQ=30gbZ_a1Q4_5gukQ-v0C2JeTfQcRQoYUEAavA@mail.gmail.com>

Thiemo,
I think the plot does not show all the pixels. Simpler script:

tempr <- raster(USA.highway)
dim(tempr) <- c(4480, 2080)
USA.highwayraster <- rasterize(USA.highway, tempr, progress='text')

# high resolution plot (but how many pixels does your screen have?)
plot(USA.highwayraster, maxpixels=ncell(tempr))

# or try this
zoom(USA.highwayraster)  # now click twice on the previous plot

Robert


On Thu, Jul 18, 2013 at 5:23 PM, Thiemo Fetzer <thiemo.fetzer at gmail.com> wrote:
> Dear all,
>
> I have another question or problem -- this time it is related to the transformation of a Spatial Lines shapefile into a raster.
>
> Let me describe my problem: I want to construct a measure of travel distance from A<->B; I have obtained a shapefile of the highway network of the US; in order to compute the travel distance, I need to transform the shape into a raster -- at least that is what I have done in the past for a similar project, however, there the task was a lot simpler (computing maritime routes).
>
> I use the following code:
>
>
> #############LOAD USA HIGHWAY NETWORK
> USA.highway<-readShapeLines("Shapefiles/Highways/NHPNLine.shp")
>
>
> ###reproject to WGS 84
> proj4string(USA.highway)<- CRS("+init=epsg:4269"))
> USA.highway<-spTransform(USA.highway,CRS(proj4string(USA)))
>
>
> USA.highway
>
> ##spits out
> class       : SpatialLinesDataFrame
> nfeatures   : 176231
> extent      : -176.764, 17.93439, -65.59364, 71.31699  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> nvariables  : 42
>
> ###I reconed that -- in order to get crid-cells of roughly .less than ..1, I make the rast
>
> tempr<-raster(nrows=4480, ncols=2080)
>
> ###not sure if i need this
> setExtent(tempr, extent(USA.highway), keepres=FALSE, snap=FALSE)
> ###or this?
> extent(tempr) <- extent(USA.highway)
> ###this is the rasterize
> USA.highwayraster<- rasterize(USA.highway, tempr, progress='text')
>
>
> Well, it basically turns out that the raster picture looks nowhere near what the original shapefile looks like; even though I thought it should.
> To give you an impression, have a look at
>
> http://freigeist.devmag.net/wp-content/Screen-Shot-2013-07-19-at-02.19.31.png
>
> (I cropped out Alaska as it would otherwise be not so easily visible).
>
> I definately cant use that to compute routes as the grid basically does not have any connected roads at all!
>
> I appreciate your thoughts, ideas and comments on what I am doing wrong,
>
> thanks a lot
> best
> ----
> Thiemo Fetzer
> London School of Economics
> STICERD
> Houghton Street
> WC2A 2AE London
> United Kingdom
>
> office: 32L, 3.01 D
> tel: +44 7411 566845
> skype: thiemo.fetzer
> email: t.r.fetzer at lse.ac.uk
> web: www.trfetzer.com
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From George.Leigh at daff.qld.gov.au  Fri Jul 19 05:12:36 2013
From: George.Leigh at daff.qld.gov.au (Leigh, George)
Date: Fri, 19 Jul 2013 13:12:36 +1000
Subject: [R-sig-Geo] The "comment" attribute in R spatial objects
Message-ID: <DBA429E2E2576A4FBCCF0205D8DF75AD022707BC15D5@SPIBSRVPR08.org.local>

Roger suggested that I send this note to inform/remind subscribers about the use of the "comment" attribute in R spatial objects.
 
R spatial objects require the "comment" attribute to be consistent with the contents of the object.  The functions in the libraries can give incorrect results otherwise.  In my particular case, a "Polygons" object contained multiple polygons but the "comment" attribute was the string "0" which indicated that it contained only one polygon.  Then the "gIntersection" function returned the intersection with only the first polygon, which was not what I wanted.
 
Users also need to be aware that the "comment" attribute is not displayed when an object is printed.  If we want to know its value, we have to use R's "comment" function.
 
In general, it is safe to have NULL comment attributes.  My problem was caused by using the "readWKT" function, which assigns a non-null comment field.  If I had known this at the time, I could easily have fixed the problem by setting the comment field to NULL in the object after creating it in readWKT.
 
Roger has just introduced fixes to detect inconsistencies in the comment field, which will be included in new downloads of the software.
 
The use of comments is explained on page 47 of the second edition of the ASDAR book.  (Unfortunately, I had only the first edition.)  It came about because of the need for consistency with standards and other software.  There is a function called "createSPComment" that can create the comments correctly, but as stated above it is generally safe to set all comment attributes to NULL.
------------------------------
The information in this email together with any attachments is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. There is no waiver of any confidentiality/privilege by your inadvertent receipt of this material. 
Any form of review, disclosure, modification, distribution and/or publication of this email message is prohibited, unless as a necessary part of Departmental business.
If you have received this message in error, you are asked to inform the sender as quickly as possible and delete this message and any copies of this message from your computer and/or your computer system network.


From thiemo.fetzer at gmail.com  Fri Jul 19 09:14:27 2013
From: thiemo.fetzer at gmail.com (Thiemo Fetzer)
Date: Fri, 19 Jul 2013 09:14:27 +0200
Subject: [R-sig-Geo] Transportation Network Shapefile into a Raster
In-Reply-To: <CANtt_hw0FcKQ=30gbZ_a1Q4_5gukQ-v0C2JeTfQcRQoYUEAavA@mail.gmail.com>
References: <67938C1E-0A0A-4E4E-8784-B1CEB1ADE480@gmail.com>
	<CANtt_hw0FcKQ=30gbZ_a1Q4_5gukQ-v0C2JeTfQcRQoYUEAavA@mail.gmail.com>
Message-ID: <626AFE21-D868-4E17-A6D2-C063AE48456B@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/d267cdb9/attachment.pl>

From m.bevanda at ymail.com  Fri Jul 19 09:30:02 2013
From: m.bevanda at ymail.com (M. Bevanda)
Date: Fri, 19 Jul 2013 08:30:02 +0100 (BST)
Subject: [R-sig-Geo] Fwd: survey
Message-ID: <1374219002.43136.YahooMailNeo@web171405.mail.ir2.yahoo.com>





-------- original message --------


Dear all,

A survey is underway to understand the current usage, needs and shortcomings 
of remote sensing for biodiversity research and conservation applications.? 
Please consider filling it out - the estimated time is 10 min.

http://remote-sensing-biodiversity.org/survey

This survey aims to obtain information from ecologists, conservationists and 
remote sensing scientists working or interested in this interdisciplinary field 
in order to understand the needs and challenges of remote sensing 
applications. The results will be communicated to various groups, including 
CEOS and GEO BON.

Your participation in this survey will help improve remote sensing 
developments with respect to biodiversity and conservation needs!

Please also feel free to forward it to interested colleagues.

Best, Martin


From Thierry.ONKELINX at inbo.be  Fri Jul 19 10:04:00 2013
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 19 Jul 2013 08:04:00 +0000
Subject: [R-sig-Geo] spatial correlation model and variogram
In-Reply-To: <CAJRR3XOW5KMF0CaWnEqBMxb7t4Mi8-WmDherv04C=nW5Z0vK3g@mail.gmail.com>
References: <CAJRR3XOW5KMF0CaWnEqBMxb7t4Mi8-WmDherv04C=nW5Z0vK3g@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA7427CD30198F@inbomail.inbo.be>

Dear Moshood,

Pleasenotethataddingspacestoyourcodemakesyourcodemuchmorereadable

You want
model.vc <- gls(yield ~ easting + northing, method = "ML")
model.sph <- update(model.vc, corSpher(form = ~easting + northing, nugget = TRUE))

which is equivalent to
model.sph <- gls(yield ~ 1, corr = CorSpher(form = ~ easting + northing, nugget = TRUE), method="ML")

Save the residuals and modeling those again is not a good idea.

Best regards,

Thierry

PS I recommend setting some sensible starting values for the range and nugget. With the default range the optimizer tends to get stuck at very small ranges.

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] Namens Moshood Agba Bakare
Verzonden: vrijdag 19 juli 2013 1:22
Aan: r-sig-geo at r-project.org
Onderwerp: [R-sig-Geo] spatial correlation model and variogram

Dear All,
Consider yield as attribute and easting and northing in meters as spatial coordinates.
I used gls function of nlme package because of spatial dependency of the residual. I tried to remove large-scale trend by using the easting and northing as covariates of yield.

model.vc<-gls(yield~easting+northing,method="ML").

Being a spatial data, we are most interested in carrying out variogram modelling of the spatial structure on the small-scale component i.e. the residual and equally fit the spatial correlation structure on the residual as well.

Do I need to obtain the residual from the model.vc above i.e
resid<-residuals(model.vc) and fit the other models as follow

model.sph<-gls(resid~1,corr=CorSpher(form=~easting+northing, nugget=T)) or
model.sph<-update(model.vc,corSpher(form=~easting+northing,nugget=T))

Please which one is correct.

Thank you.
Moshood

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From carstennh at aol.com  Fri Jul 19 11:56:20 2013
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 19 Jul 2013 11:56:20 +0200
Subject: [R-sig-Geo] Clipping raster by polygon
In-Reply-To: <CANtt_hy1VYWiP+rDHYS+mhGm1aGSSUeGbHcXjzFyPJXxR6ahXw@mail.gmail.com>
References: <CAE+tLNAJZVxw4E=LA2upq+8EXrMDExY5-yrpGE=kR34XbjU0wQ@mail.gmail.com>
	<CANtt_hy1VYWiP+rDHYS+mhGm1aGSSUeGbHcXjzFyPJXxR6ahXw@mail.gmail.com>
Message-ID: <51E90D44.305@aol.com>

Hi Joseph,

I wrote a function that you can use to clip every raster object with any
polygon within the raster package.

######################################
clip<-function(raster,shape) {
          a1_crop<-crop(raster,shape)
          step1<-rasterize(shape,a1_crop)
          a1_crop*step1}
######################################

Much success.

Carsten



On 07/17/2013 07:02 PM, Robert J. Hijmans wrote:
> Joseph, Perhaps you can use raster function crop, perhaps followed by
> mask. Robert
>
>
> On Wed, Jul 17, 2013 at 8:31 AM, Joseph Miller <jemiller31 at gmail.com> wrote:
>   
>> Hello-
>>
>> I am trying to clip a raster with a Spatial Polygons Data Frame (esri
>> shapefile).  I reviewed the rgeos package documentation but could not find
>> an adequate tool to do this.  Suggestions?
>>
>> Thanks,
>> Joseph
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>     
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 

Carsten Neumann
Telegrafenberg, A 17 01.13
14473 Potsdam
-------------------------------------------------------
Helmholtz Centre Potsdam
GFZ German Research Centre for Geosciences
Department 1 - Section 1.4 - Remote Sensing
-------------------------------------------------------
Tel.: +49 (0) 331 288 1766
e-mail: carstenn at gfz-potsdam.de


From momadou at yahoo.fr  Fri Jul 19 15:11:49 2013
From: momadou at yahoo.fr (Komine)
Date: Fri, 19 Jul 2013 06:11:49 -0700 (PDT)
Subject: [R-sig-Geo] Intersect Grid and Attributes
Message-ID: <1374239509781-7584193.post@n2.nabble.com>

Dear,
I have 3 files (shape file): the first is a grid (with cells of 500m)
covering my study area, the second file is soil moisture (Z1), the third
file is vegetation moisture (Z2). When plotting data, Z1 and Z2 fall on the
grid on certain cells while other cells are empty.  I would like to have for
each cell, the coordinates X Y and the values of soil moisture and
vegetation moisture corresponding for each cell. So I should have only one
file with X Y Z1 Z2. 

Thank you in advance.  
Komine



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Intersect-Grid-and-Attributes-tp7584193.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From kat.emidio at gmail.com  Fri Jul 19 15:12:49 2013
From: kat.emidio at gmail.com (=?ISO-8859-1?Q?K=E1tia_Emidio?=)
Date: Fri, 19 Jul 2013 09:12:49 -0400
Subject: [R-sig-Geo] Fwd: help with matrix
In-Reply-To: <CABFLJOn24uXc3RndvRhgKwjmTU+wU8tGWMzzS6eW_ztAdTfLuA@mail.gmail.com>
References: <CABFLJOn24uXc3RndvRhgKwjmTU+wU8tGWMzzS6eW_ztAdTfLuA@mail.gmail.com>
Message-ID: <CABFLJOkiycRQAiLzxfcEzmTLqjnwqEzCNLCsCWF7uxq3vFUoxg@mail.gmail.com>

Hi,
 I am a beginner at R and I would like to get information from a matrix,
where the numbers are larger than or equal to 50m . This means that plants
need to be apart 50m.  I  need to get the selection(the results) as a
matrix or another object that allows me to identify which pair of species
are 50m apart. Attached it is an example...

Thanks

-- 
K?tia Em?dio da Silva DSc
Eng. Florestal
Manaus/AM



Forestry Engineer
Manaus/AM-Brazil



-- 
K?tia Em?dio da Silva DSc
Eng. Florestal
Manaus/AM



Forestry Engineer
Manaus/AM-Brazil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/08bb9e62/attachment.html>
-------------- next part --------------
	Nauc_calo_1	Nauc_calo_2	Nauc_calo_3	Nauc_calo_4	Nauc_calo_5	Nauc_calo_6
Nauc_calo_1	0	118,74	172,27	152,72	119,45	85,351
Nauc_calo_2	118,74	0	165,8	141,68	67,186	151,47
Nauc_calo_3	172,27	165,8	0	24,331	98,671	104,72
Nauc_calo_4	152,72	141,68	24,331	0	74,673	93,503
Nauc_calo_5	119,45	67,186	98,671	74,673	0	108,95
Nauc_calo_6	85,351	151,47	104,72	93,503	108,95	0

From sarah.goslee at gmail.com  Fri Jul 19 15:40:30 2013
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Fri, 19 Jul 2013 09:40:30 -0400
Subject: [R-sig-Geo] Fwd: help with matrix
In-Reply-To: <CABFLJOkiycRQAiLzxfcEzmTLqjnwqEzCNLCsCWF7uxq3vFUoxg@mail.gmail.com>
References: <CABFLJOn24uXc3RndvRhgKwjmTU+wU8tGWMzzS6eW_ztAdTfLuA@mail.gmail.com>
	<CABFLJOkiycRQAiLzxfcEzmTLqjnwqEzCNLCsCWF7uxq3vFUoxg@mail.gmail.com>
Message-ID: <CAM_vjumT7ntfCROD8v1sSXMDFOc-tTuPSmL_UMYEYS0CptysEQ@mail.gmail.com>

Hi,

Please don't cross-post: choose the most appropriate email list and
send your question only to that one. The best place for general
questions like this is R-help.

On Fri, Jul 19, 2013 at 9:12 AM, K?tia Emidio <kat.emidio at gmail.com> wrote:
>
> Hi,
>  I am a beginner at R and I would like to get information from a matrix,
> where the numbers are larger than or equal to 50m . This means that plants
> need to be apart 50m.  I  need to get the selection(the results) as a matrix
> or another object that allows me to identify which pair of species are 50m
> apart. Attached it is an example...

Attaching your data isn't nearly as useful as using dput() to include
it directly in the email. Many people dislike opening unsolicited
attachments, and the mail server strips most of them off anyway.

There are almost certainly more elegant ways to accomplish this.
Please move the discussion to R-help if you wish to continue it.

# recreate your data
adist <- structure(list(Nauc_calo_1 = c(0, 118.74, 172.27, 152.72, 119.45,
85.351), Nauc_calo_2 = c(118.74, 0, 165.8, 141.68, 67.186, 151.47
), Nauc_calo_3 = c(172.27, 165.8, 0, 24.331, 98.671, 104.72),
    Nauc_calo_4 = c(152.72, 141.68, 24.331, 0, 74.673, 93.503
    ), Nauc_calo_5 = c(119.45, 67.186, 98.671, 74.673, 0, 108.95
    ), Nauc_calo_6 = c(85.351, 151.47, 104.72, 93.503, 108.95,
    0)), .Names = c("Nauc_calo_1", "Nauc_calo_2", "Nauc_calo_3",
"Nauc_calo_4", "Nauc_calo_5", "Nauc_calo_6"), class = "data.frame",
row.names = c("Nauc_calo_1",
"Nauc_calo_2", "Nauc_calo_3", "Nauc_calo_4", "Nauc_calo_5", "Nauc_calo_6"
))

# identify which elements are >= 50
index50 <- data.frame(which(adist >= 50, arr.ind=TRUE))
# take unique pairs from your symmetric matrix
index50 <- subset(index50, row < col)
# get the associated names
results50 <- data.frame(row = rownames(adist)[index50$row], col =
colnames(adist)[index50$col], stringsAsFactors = FALSE)

Sarah

-- 
Sarah Goslee
http://www.functionaldiversity.org


From s6lihert at uni-bonn.de  Fri Jul 19 15:43:21 2013
From: s6lihert at uni-bonn.de (Lionel Hertzog)
Date: Fri, 19 Jul 2013 15:43:21 +0200
Subject: [R-sig-Geo] Intersect Grid and Attributes
In-Reply-To: <1374239509781-7584193.post@n2.nabble.com>
References: <1374239509781-7584193.post@n2.nabble.com>
Message-ID: <51E94279.7070707@uni-bonn.de>

Dear Komine,

You could use the raster package to turn your grid into rasters (or 
stacks) and then use the xyFromCell and values function to get for each 
cell the coordinates plus the value.

Sincerely yours,

Lionel

On 19/07/2013 15:11, Komine wrote:
> Dear,
> I have 3 files (shape file): the first is a grid (with cells of 500m)
> covering my study area, the second file is soil moisture (Z1), the third
> file is vegetation moisture (Z2). When plotting data, Z1 and Z2 fall on the
> grid on certain cells while other cells are empty.  I would like to have for
> each cell, the coordinates X Y and the values of soil moisture and
> vegetation moisture corresponding for each cell. So I should have only one
> file with X Y Z1 Z2.
>
> Thank you in advance.
> Komine
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Intersect-Grid-and-Attributes-tp7584193.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From efisio.solazzo at jrc.ec.europa.eu  Fri Jul 19 16:18:18 2013
From: efisio.solazzo at jrc.ec.europa.eu (solazef)
Date: Fri, 19 Jul 2013 07:18:18 -0700 (PDT)
Subject: [R-sig-Geo] Is it possible to calculate the semivariances of a
 variogram between one specific point and all other points in space?
In-Reply-To: <50504F55.1080103@uni-muenster.de>
References: <CADfOX6y9CxAy32CZPvNVh8VMP-xV1HS6tteiU+sCZ5SW5tmcrA@mail.gmail.com>
	<5049CFB4.5050700@uni-muenster.de>
	<50504F55.1080103@uni-muenster.de>
Message-ID: <1374243498242-7584198.post@n2.nabble.com>

Dear, I have read with interest this post as it describes exactly what I'm
after.

the solution proposed seems to be OK, but I wonder whether this
"point-centered" variogram analysis can only be performed as post-processing
of the "standard variogram outputs", as suggested in this post.

Is any of you aware of a function (or modification to the existing variogram
function itself) allowing to run variogram analysis based on one-to-all
points? 

thanks for your help, Efisio



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Is-it-possible-to-calculate-the-semivariances-of-a-variogram-between-one-specific-point-and-all-othe-tp7580909p7584198.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From bakare at ualberta.ca  Fri Jul 19 16:19:45 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Fri, 19 Jul 2013 08:19:45 -0600
Subject: [R-sig-Geo] spatial correlation model and variogram
In-Reply-To: <AA818EAD2576BC488B4F623941DA7427CD30198F@inbomail.inbo.be>
References: <CAJRR3XOW5KMF0CaWnEqBMxb7t4Mi8-WmDherv04C=nW5Z0vK3g@mail.gmail.com>
	<AA818EAD2576BC488B4F623941DA7427CD30198F@inbomail.inbo.be>
Message-ID: <CAJRR3XPRsqac+SSr+2wAQho3fEYaEsXiN1W4bZ26N9w2gZ=pkw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/a2403934/attachment.pl>

From Paul.Harris at nuim.ie  Fri Jul 19 16:41:57 2013
From: Paul.Harris at nuim.ie (Paul Harris)
Date: Fri, 19 Jul 2013 15:41:57 +0100
Subject: [R-sig-Geo] Is it possible to calculate the semivariances of a
 variogram between one specific point and all other points in space?
In-Reply-To: <1374243498242-7584198.post@n2.nabble.com>
References: <CADfOX6y9CxAy32CZPvNVh8VMP-xV1HS6tteiU+sCZ5SW5tmcrA@mail.gmail.com>
	<5049CFB4.5050700@uni-muenster.de> <50504F55.1080103@uni-muenster.de>
	<1374243498242-7584198.post@n2.nabble.com>
Message-ID: <a0ac73a842838d55.51e95e45@nuim.ie>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/39d20b4a/attachment.pl>

From onos2god at yahoo.com  Fri Jul 19 17:35:27 2013
From: onos2god at yahoo.com (Israel Ikoyi)
Date: Fri, 19 Jul 2013 08:35:27 -0700 (PDT)
Subject: [R-sig-Geo] Regression kriging error
Message-ID: <1374248127.10944.YahooMailNeo@web160605.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/2fb25249/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Jul 19 17:56:01 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 19 Jul 2013 17:56:01 +0200
Subject: [R-sig-Geo] Regression kriging error
In-Reply-To: <1374248127.10944.YahooMailNeo@web160605.mail.bf1.yahoo.com>
References: <1374248127.10944.YahooMailNeo@web160605.mail.bf1.yahoo.com>
Message-ID: <51E96191.7090409@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



On 07/19/2013 05:35 PM, Israel Ikoyi wrote:
> Hi, I am trying to do regression kriging with this commands: 
> #Regression modeling regSI <- lm(SI~OrgMat+Moisture+pH, data =
> malpie) summary(regSI) # add residual to malpie malpie$resSI <-
> regSI$residuals # calculate variogram of residual gresSI <-
> gstat(id="resids", formula = resSI~1, data = malpie) vgresSI <-
> variogram(gresSI) plot(vgresSI,plot.nu=T) vgmresSI <-
> fit.variogram(vgresSI, model=vgm(psill=400, range=150, model="Sph",
>  add.to= vgm(psill=100, range=500, model="Sph"))) plot(vgresSI,
> vgmresSI, ylim=c(0,600)) vgmresSI
> 
> #regression kriging malpie_rk <- krige(SI~OrgMat+Moisture+pH,
> locations=malpie, newdata=zgrid)  # regression part only! 
> malpie_rok <- krige(residuals(regSI)~1, locations=malpie,
> newdata=zgrid, model=vgmresSI)  # OK of residuals
> 
> CHALLENGE: the regression part gives me the error message: Error in
> eval(expr, envir, enclos) : object 'OrgMat' not found. Can someone
> help me on how to solve this?

A wild guess: OrgMat is not present, as layer, in zgrid, or in malpie.

Providing a reproducible example would allow me to help, instead of
wildly guessing.

> 
> Israel Ikoyi [[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR6WGRAAoJEM1OCHCtOnfx3i4H/RnZ2aZKUaF9vfz4ssiuGtVY
cdYskQo9kLAMM5DUy9a71bse2r0lIfvh2uaPavcqvRMAVGHOTIsbIJk9CIuBTTOw
mLPXbg5hEmBIRnbeqty8nGTsyu9us4safAqZcOTsmqsuu9k0PMF8DSwNI/8mxMtr
+wJbs8b7mq0p4cphCoh+QoUuCI+lYoW8GeLjj6Aytkj7qS/PA2s7Y296NGmGb6Ad
EUhEgPNqLcVPMUeSlwFjGzDSEgkzdrPG89IGmtUKLqsuk0TOBrcdZCAeru+KImgu
ts8L8ed4dPVQGGrtbFYUBCD1+HUttldVGNbVfkWF46xeVDDRhwrgmRZ87W7/E0g=
=TBWQ
-----END PGP SIGNATURE-----


From berman.jesse at gmail.com  Fri Jul 19 22:08:22 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Fri, 19 Jul 2013 13:08:22 -0700 (PDT)
Subject: [R-sig-Geo] Singular Matrix Error
Message-ID: <1374264502905-7584203.post@n2.nabble.com>

Hi All,

I want to perform ordinary kriging on a series of air pollution values, but
am getting the error

/> IL.Jul7.ok<-krige(Arithmetic.Mean~1, IL.Jul7, model=ILvgm.jul7,
newdata=IL2.map)
[using ordinary kriging]

"chfactor.c", line 131: singular matrix in function LDLfactor()
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  : 
  LDLfactor/

I know that this error is typically caused by either duplicate points or a
variogram without a nugget effect.  However, I have neither (see code
below).  I also have set the same projection for points and prediction grid,
plus ran an IDW successfully /[CRS("+proj=longlat +ellps=GRS80 +datum=NAD83
+no_defs")]
/
/> ILvgm.jul7
  model     psill   range
1   Nug  1.537923   0.000
2   Sph 53.045879 266.323

> 	zerodist(IL.Jul7)
     [,1] [,2]

> summary(IL.Jul7 at data$Arithmetic.Mean)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  13.50   17.60   21.95   22.82   27.83   32.10 /

Any thoughts as to what might be causing this problem?  Sorry for not
providing a reproducible example, as I can't reproduce it and have run
similar code without problems on other data.  Thanks for the suggestions.

Jesse



-----
--------------------------------------------------------
Jesse D Berman, PhD
Johns Hopkins Bloomberg School of Public Health
Department of Environmental Health Sciences
Post-Doc 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Singular-Matrix-Error-tp7584203.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From justine.sumrok at gmail.com  Fri Jul 19 23:55:19 2013
From: justine.sumrok at gmail.com (Justine Sumrok)
Date: Fri, 19 Jul 2013 14:55:19 -0700
Subject: [R-sig-Geo] Choropleth values plotting incorrectly
Message-ID: <CADySoi0Y=Ts=A5v+6sGcZJDmkT4DCwVJPnMMeRS9J02Nbk6udQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130719/ac02fb61/attachment.pl>

From sheila_dufford at fws.gov  Sat Jul 20 02:28:26 2013
From: sheila_dufford at fws.gov (SheilaD)
Date: Fri, 19 Jul 2013 17:28:26 -0700 (PDT)
Subject: [R-sig-Geo] adehabitatHR kernalBB batch processing
In-Reply-To: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
References: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
Message-ID: <1374280106183-7584205.post@n2.nabble.com>

Has anyone been able to batch process the kernelbb function from adehabitatHR
with individual sig1 values?

p.s. im running
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)
adehabitatHR_0.4.7 adehabitatLT_0.3.11?

Sheila


Phil H wrote
> I am attempting to use the kernalBB function from adehabitatHR. Now it  
> works just fine with just one fish, however I have quite a number of  
> fish and would like to run the analysis on all the fish in one  
> go-while maintaining individual sig 1 estimates. See below for example  
> coding...
> 
> library(adehabitatHR)
> library(adehabitatLT)
> data(puechabonsp)
> 
> loc$DT <-as.POSIXct(strptime(loc$Date, format='%y%m%d' ))
> ltraj <- as.ltraj(coordinates(loc), loc$DT, id = loc$Name, burst =
> loc$Name,
> + typeII = TRUE)
> 
> sig255<-liker(ltraj, sig2 = 255, rangesig1 = c(0, 1000))
> 
> *****************************************
> 
> Maximization of the log-likelihood for parameter
> sig1 of brownian bridge
> 
> Brock : Sig1 = 2.002 Sig2 = 255
> Calou : Sig1 = 0 Sig2 = 255
> Chou : Sig1 = 1.001 Sig2 = 255
> Jean : Sig1 = 2.002 Sig2 = 255
> 
> ##so now I would like to run the kernalBB on all 4 fish individually.
> ##so i tried...
> 
>> tataall <- kernelbb(ltraj, sig1 = sig255, sig2 = 255, grid =
>> 100,byburst=T)
> 
> #Error in sig1^2 : non-numeric argument to binary operator
> 
> ##I dont have a great deal of experience working with list formats-  
> can anyone ##assist me in calling the relevent sig 1 for each fish?
> 
> 
> 
> #now if I know I can used a fixed sig 1 for all fine ie
>> tataall <- kernelbb(ltraj, sig1 = 1, sig2 = 255, grid = 100,byburst=T)
> 
> 
> ##I am sure it is something stupid and easy....
> 
> ##I see that when you do a similar thing for the D function in the BRB  
> function it seems to work fine  (I assume that this is using differing  
> D levels for each fish..)
> 
> vv2<- BRB.likD(ltraj, Dr=c(1,50000), Tmax = 5*(24*60*60) + 1, Lmin = 0.1)
> testud <-BRB(ltraj, D =vv2, Tmax =5*(24*60*60) + 1, Lmin =0.1, hmin = 100)
> 
> 
> finally, I notice that we get some zero sig 1 values both in my  
> dataset and in the example of Calou. Is this an issue?
> 
> Thanks for any help
> 
> Phil H.
> 
> p.s. im running
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> adehabitatHR_0.4.2 adehabitatLT_0.3.6
> 
> _______________________________________________
> R-sig-Geo mailing list

> R-sig-Geo@

> https://stat.ethz.ch/mailman/listinfo/r-sig-geo





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-kernalBB-batch-processing-tp7583119p7584205.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From roman.lustrik at gmail.com  Sat Jul 20 08:19:16 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 20 Jul 2013 08:19:16 +0200
Subject: [R-sig-Geo] adehabitatHR kernalBB batch processing
In-Reply-To: <1374280106183-7584205.post@n2.nabble.com>
References: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
	<1374280106183-7584205.post@n2.nabble.com>
Message-ID: <CAHT1vpi+iZ_T9UU6zTeuUM+4=ELVU5r3hVyUAjoP_pNrU9NdTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130720/03d84b1e/attachment.pl>

From Roger.Bivand at nhh.no  Sat Jul 20 16:44:31 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 20 Jul 2013 16:44:31 +0200
Subject: [R-sig-Geo] Choropleth values plotting incorrectly
In-Reply-To: <CADySoi0Y=Ts=A5v+6sGcZJDmkT4DCwVJPnMMeRS9J02Nbk6udQ@mail.gmail.com>
References: <CADySoi0Y=Ts=A5v+6sGcZJDmkT4DCwVJPnMMeRS9J02Nbk6udQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307201634020.6699@reclus.nhh.no>

On Fri, 19 Jul 2013, Justine Sumrok wrote:

> Hi all,
>
> I ran into a spot of trouble today plotting a map of free and reduced lunch
> students (FRL) in Ohio. linked are:
> https://drive.google.com/folderview?
> id=0ByHQd1ckVHrSTURXeU5MczgzWDQ&usp=sharing
>
> shapefile of school districts in Ohio
> csv of the district data
>
> Using the code below I created a choropleth map of Ohio, though the fill in
> certain school districts was incorrect. For example: according to my csv of
> data Cleveland Municipal would be in the highest bracket of FRL population,
> but is not displaying that color. Any thoughts?

Thanks for example data. Never use merge(), it always masks trouble. Never 
assign directly to the data slot, always use spCbind() in maptools. You 
have multiple problems. You have 616 entities in your shapefile, but only 
601 of these are in the CSV file (which has 768 observations) - this based 
on using match() on character representations of NCESID - it is a factor 
in OH, but integer in dist. So you have a two-way matching problem. You 
can maybe address it by first removing the 15 entities from OH for which 
you have no data, then dropping from dist the IDs that do not match, and 
finally spCbind() after checking that row.names(OH) and row.names(dist) 
agree. I started by:

row.names(OH) <- as.character(OH$NCESID)
dist$NCESID <- as.character(dist$NCESID)
row.names(dist) <- dist$NCESID

to remove the possibility that the different representations were getting 
in the way. I don't know what you'll choose to do with the IDs in OH foe 
which you have no data, so I'll leave this here for now.

See the vignette("combine_maptools") in maptools for more ideas.

Hope this helps,

Roger

>
> #Libraries
> library(maps)
> library(maptools)
> library(RColorBrewer)
> library(class)
> library(classInt)
>
> #Reading in data
> state <- readShapePoly('/Users/Path/to/File/Census2010')
> dist <- read.csv('/Users/Path/to/File/Dist.csv', header = T)
>
> #Merging Data
> OH <- state
> OH at data <-
>     merge(OH at data, dist, by.x="NCESID", by.y="NCESID", all.x=F, sort=F )
>
> #Plotting FRL by district
> plotvar <- OH at data$PctFRL
> nclr <- 5
> plotclr <- brewer.pal(nclr, "GnBu")
> class <- classIntervals(plotvar, nclr, style = "fixed",
>    fixedBreaks = c(0, 0.40, 0.60, 0.80, 0.90, 1))
> legend("bottomleft", legend=names(attr(colcode, "table")),
>    fill=attr(colcode, "palette"), cex=0.6, bty="n")
>
> Thanks!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From renaud.lancelot at cirad.fr  Sun Jul 21 00:13:16 2013
From: renaud.lancelot at cirad.fr (lancelot)
Date: Sun, 21 Jul 2013 00:13:16 +0200
Subject: [R-sig-Geo] AVHRR GIMMS NDVI3g 1981-2011
Message-ID: <51EB0B7C.7030401@cirad.fr>

Dear all,

Sorry for this off-topic question.

Does anybody know how to get the AVHRR GIMMS NDVI3g 1981-2011 data set 
described in 
http://www.mdpi.com/journal/remotesensing/special_issues/monitoring_global

I am aware of the 1981-2006 available at http://glcf.umd.edu/data/gimms/

Thanks in advance,

Renaud
-- 
Renaud Lancelot
Directeur adjoint / Deputy director
CIRAD, UMR CMAEE, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier - http://umr-cmaee.cirad.fr/

Head of epidemiology team
EDENext Project, coordinator: http://www.edenext.eu/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From hammadi.achour at gmail.com  Sun Jul 21 06:54:50 2013
From: hammadi.achour at gmail.com (Hammadi ACHOUR)
Date: Sun, 21 Jul 2013 05:54:50 +0100
Subject: [R-sig-Geo] Hammadi ACHOUR
Message-ID: <CAOTayha-Toxy-rdzxHscmz_sAaANEA+Exhh+ZzCL2im0EaqWvA@mail.gmail.com>

http://sv.bodoo.net/oryaifx/tspzr.tkxpczol


From rhtardin at gmail.com  Sun Jul 21 07:37:31 2013
From: rhtardin at gmail.com (Rodrigo Tardin)
Date: Sun, 21 Jul 2013 02:37:31 -0300
Subject: [R-sig-Geo] Rodrigo Tardin
Message-ID: <CAE5HZZJz81wz6scW0fm6LP-qvpssMixb1+bp6p7SmWG9eMTkVQ@mail.gmail.com>

http://re-imaginemediagroup.com/iy/hgdrftbycn.mpnylrrzyttkbhpacy


From berman.jesse at gmail.com  Sun Jul 21 20:29:25 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Sun, 21 Jul 2013 11:29:25 -0700 (PDT)
Subject: [R-sig-Geo] zerodist() fails with Projected Data
Message-ID: <1374431365267-7584211.post@n2.nabble.com>

Hi All,

I have run across an error where 'zerodist()' fails to identify duplicate
points if data is projected under a geographic coordinate system (e.g. WGS84
or NAD83).  However, it works correctly if data has no set projection or is
projected under a local or continental system (e.g. Albers Equal Area or
Lambert Conformal Conic).  Any thoughts as to why this occurs (see example
below)?

Jesse

/# GCS Projection, where zerodist() fails to identify duplicates. WGS84 also
fails to work
require(sp)
longitude<-c(-75.518056, -76.952778, -77.032500, -75.558056, -75.558056)
latitude<-c(39.155000, 38.897222, 38.880833, 39.739444, 39.739444)
z<-c(12, 14, 15, 13, 19)
data<-as.data.frame(cbind(longitude, latitude, z))
coordinates(data)=~longitude+latitude
proj4string(data)=CRS("+proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
+towgs84=0,0,0 +units=m") # NAD83 Geographic Coordinate System
zerodist(data)/

/# Continental Projection on same dataset, where zerodist() identifies
duplicates
require(sp)
longitude<-c(-75.518056, -76.952778, -77.032500, -75.558056, -75.558056)
latitude<-c(39.155000, 38.897222, 38.880833, 39.739444, 39.739444)
z<-c(12, 14, 15, 13, 19)
data<-as.data.frame(cbind(longitude, latitude, z))
coordinates(data)=~longitude+latitude
proj4string(data)=CRS("+proj=aea +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96
+x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs") #Continental
projection system for Albers Equal Area
zerodist(data)
/



-----
--------------------------------------------------------
Jesse D Berman, PhD
Johns Hopkins Bloomberg School of Public Health
Department of Environmental Health Sciences
Post-Doc 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/zerodist-fails-with-Projected-Data-tp7584211.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mauriziomarchi85 at gmail.com  Sun Jul 21 20:34:17 2013
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Sun, 21 Jul 2013 20:34:17 +0200
Subject: [R-sig-Geo] Background points number in RandomForest
Message-ID: <CANJhsN33VCBE7kHVo6bFqdLijVUUARYiRDh4DU+KUmZxRZ-CDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130721/89115311/attachment.pl>

From mspinola10 at gmail.com  Mon Jul 22 00:43:03 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 21 Jul 2013 16:43:03 -0600
Subject: [R-sig-Geo] Remove grey area when using gplot (rasterVis)
Message-ID: <CABkCotQjotTM3q59n8p4CS8i=83G6MhPrzfYEkf-8wC+4Ooq-w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130721/b5edf646/attachment.pl>

From HodgessE at uhd.edu  Mon Jul 22 00:43:08 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 21 Jul 2013 22:43:08 +0000
Subject: [R-sig-Geo] Google Earth files on an iPad
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A34FEC@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130721/967de7ce/attachment.pl>

From mdsumner at gmail.com  Mon Jul 22 02:07:51 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 22 Jul 2013 10:07:51 +1000
Subject: [R-sig-Geo] Google Earth files on an iPad
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217A34FEC@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217A34FEC@challenger.uhd.campus>
Message-ID: <CAAcGz9_TqO7mSit0B-UbVJ=EK8Z91OuQkAM5DSRXPZZ1FhCP=g@mail.gmail.com>

I would consult the manual for the iPad device. I don't see the
relevance of this question to this mailing list.

Cheers, Mike.

On Mon, Jul 22, 2013 at 8:43 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi Geo People:
>
> I have a quick question, please:  what is the best way to transfer a KML file from my computer to my iPad, please?
>
> I want to show the file on Google Earth on the iPad.
>
> Thanks,
> Erin
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From HodgessE at uhd.edu  Mon Jul 22 02:12:51 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 22 Jul 2013 00:12:51 +0000
Subject: [R-sig-Geo] Google Earth files on an iPad
In-Reply-To: <CAAcGz9_TqO7mSit0B-UbVJ=EK8Z91OuQkAM5DSRXPZZ1FhCP=g@mail.gmail.com>
References: <FF9DB805FC41CC4E95825A50F680630217A34FEC@challenger.uhd.campus>,
	<CAAcGz9_TqO7mSit0B-UbVJ=EK8Z91OuQkAM5DSRXPZZ1FhCP=g@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217A35266@challenger.uhd.campus>

I thought since we produce kml files for maps then perhaps someone may have done it

________________________________________
From: Michael Sumner [mdsumner at gmail.com]
Sent: Sunday, July 21, 2013 7:07 PM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Google Earth files on an iPad

I would consult the manual for the iPad device. I don't see the
relevance of this question to this mailing list.

Cheers, Mike.

On Mon, Jul 22, 2013 at 8:43 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi Geo People:
>
> I have a quick question, please:  what is the best way to transfer a KML file from my computer to my iPad, please?
>
> I want to show the file on Google Earth on the iPad.
>
> Thanks,
> Erin
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From fvbersse at gmail.com  Mon Jul 22 02:16:07 2013
From: fvbersse at gmail.com (Ferdinand Bersse)
Date: Sun, 21 Jul 2013 20:16:07 -0400
Subject: [R-sig-Geo] Comparing spatial patterns: cases vs population
Message-ID: <CA+nXtYaOA4L=+zqAiP=dBrktYkQkU8nQOUzq1WUqqM=0q6FxWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130721/220662de/attachment.pl>

From oscar.perpinan at gmail.com  Mon Jul 22 08:49:19 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Mon, 22 Jul 2013 08:49:19 +0200
Subject: [R-sig-Geo] Remove grey area when using gplot (rasterVis)
In-Reply-To: <CABkCotQjotTM3q59n8p4CS8i=83G6MhPrzfYEkf-8wC+4Ooq-w@mail.gmail.com>
References: <CABkCotQjotTM3q59n8p4CS8i=83G6MhPrzfYEkf-8wC+4Ooq-w@mail.gmail.com>
Message-ID: <87zjtfccnk.fsf@gmail.com>

Hello,

Use na.value='transparent' inside scale_fill_gradient:

theme_set(theme_bw())
gplot(s) + geom_tile(aes(fill = value)) + 
  facet_wrap(~ variable) + 
  scale_fill_gradient(low = "white", high = "blue", na.value='transparent') +
  coord_equal()

Best,

Oscar

Manuel Sp?nola <mspinola10 at gmail.com> writes:

> Dear list members,
>
> How can I remove the grey area that appear when using gplot from rasterVis
>
> Here is the reproducible example that come from the example of gplot:
>
> r <- raster(system.file("external/test.grd", package="raster"))
> s <- stack(r, r*2)
> names(s) <- c("meuse", "meuse x 2")
>
> theme_set(theme_bw())
> gplot(s) + geom_tile(aes(fill = value)) +
>   facet_wrap(~ variable) +
>   scale_fill_gradient(low = "white", high = "blue") +
>   coord_equal()
>
>
> Best,
>
> Manuel


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan
LinkedIn: http://www.linkedin.com/in/oscarperpinan


From b.rowlingson at lancaster.ac.uk  Mon Jul 22 08:57:14 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 22 Jul 2013 07:57:14 +0100
Subject: [R-sig-Geo] Google Earth files on an iPad
In-Reply-To: <8765c4976d0d485b963cdabc53e35030@EX-0-HT0.lancs.local>
References: <FF9DB805FC41CC4E95825A50F680630217A34FEC@challenger.uhd.campus>
	<CAAcGz9_TqO7mSit0B-UbVJ=EK8Z91OuQkAM5DSRXPZZ1FhCP=g@mail.gmail.com>
	<8765c4976d0d485b963cdabc53e35030@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMPensVnvoM9FNBeX1QNq10p6Y3qXPYvjpzgWEXKtzVnQ@mail.gmail.com>

On Mon, Jul 22, 2013 at 1:12 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> I thought since we produce kml files for maps then perhaps someone may have done it

 Maybe, but even more people would have transferred files in general
to their iPads. A kml file is just a file.

 I would try:

 1. put it on a server that you can access from the iPad
 2. the good old 'email it to yourself' trick
 3. ummmmm some kind of file transfer thing
 4. doesn't an iPad have a USB socket for a memory stick?
 5. errr....

Barry


From edzer.pebesma at uni-muenster.de  Mon Jul 22 10:14:51 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 22 Jul 2013 10:14:51 +0200
Subject: [R-sig-Geo] zerodist() fails with Projected Data
In-Reply-To: <1374431365267-7584211.post@n2.nabble.com>
References: <1374431365267-7584211.post@n2.nabble.com>
Message-ID: <51ECE9FB.9060501@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This was a bug. svn revision 1437 on r-forge has this corrected.

Thanks for the reproducible example,

On 07/21/2013 08:29 PM, Jesse Berman wrote:
> Hi All,
> 
> I have run across an error where 'zerodist()' fails to identify
> duplicate points if data is projected under a geographic coordinate
> system (e.g. WGS84 or NAD83).  However, it works correctly if data
> has no set projection or is projected under a local or continental
> system (e.g. Albers Equal Area or Lambert Conformal Conic).  Any
> thoughts as to why this occurs (see example below)?
> 
> Jesse
> 
> /# GCS Projection, where zerodist() fails to identify duplicates.
> WGS84 also fails to work require(sp) longitude<-c(-75.518056,
> -76.952778, -77.032500, -75.558056, -75.558056) 
> latitude<-c(39.155000, 38.897222, 38.880833, 39.739444, 39.739444) 
> z<-c(12, 14, 15, 13, 19) data<-as.data.frame(cbind(longitude,
> latitude, z)) coordinates(data)=~longitude+latitude 
> proj4string(data)=CRS("+proj=longlat +ellps=GRS80 +datum=NAD83
> +no_defs +towgs84=0,0,0 +units=m") # NAD83 Geographic Coordinate
> System zerodist(data)/
> 
> /# Continental Projection on same dataset, where zerodist()
> identifies duplicates require(sp) longitude<-c(-75.518056,
> -76.952778, -77.032500, -75.558056, -75.558056) 
> latitude<-c(39.155000, 38.897222, 38.880833, 39.739444, 39.739444) 
> z<-c(12, 14, 15, 13, 19) data<-as.data.frame(cbind(longitude,
> latitude, z)) coordinates(data)=~longitude+latitude 
> proj4string(data)=CRS("+proj=aea +lat_1=20 +lat_2=60 +lat_0=40
> +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m
> +no_defs") #Continental projection system for Albers Equal Area 
> zerodist(data) /
> 
> 
> 
> ----- -------------------------------------------------------- 
> Jesse D Berman, PhD Johns Hopkins Bloomberg School of Public
> Health Department of Environmental Health Sciences Post-Doc -- View
> this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/zerodist-fails-with-Projected-Data-tp7584211.html
>
> 
Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR7On7AAoJEM1OCHCtOnfx410H+way0NyeX/6zryng7JFibORl
tAIr28MEqYnSNF/PCQeIGZuC586YGsU5VdJGbfw1mVSN38CFVAVLct+KEj0rmoGs
+NXWiR76tvJ10jejXnNOr9RJvfrT6Nmet6Tx6WMt2hxVOP1dFb4ADe74RNz2ZX22
wf4ekjqIYPVmzF/Ojsn5EHvbFeNODoYU4Vn11ELIlzAYf6DACAqqOHEzLqe1MqIS
UqZKaysa2q+eiVCBCs1oaowICirHGizkTNu9n6p9YG21zAZCJd0qCfg3OifTg64f
wflSqzoAoBcc+F22NxTTyPcWnaWh6qhiIXH11oPNCPwJpK7mceNF/o5PqZcum7k=
=sqyM
-----END PGP SIGNATURE-----


From momadou at yahoo.fr  Mon Jul 22 11:02:55 2013
From: momadou at yahoo.fr (Komine)
Date: Mon, 22 Jul 2013 02:02:55 -0700 (PDT)
Subject: [R-sig-Geo] Intersect Grid and Attributes
In-Reply-To: <51E94279.7070707@uni-bonn.de>
References: <1374239509781-7584193.post@n2.nabble.com>
	<51E94279.7070707@uni-bonn.de>
Message-ID: <1374483775187-7584221.post@n2.nabble.com>

Dear Lionel,
Thank you for your advice, I will read raster package.
Komine



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Intersect-Grid-and-Attributes-tp7584193p7584221.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Mon Jul 22 13:25:09 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Mon, 22 Jul 2013 05:25:09 -0600
Subject: [R-sig-Geo] Remove grey area when using gplot (rasterVis)
In-Reply-To: <87zjtfccnk.fsf@gmail.com>
References: <CABkCotQjotTM3q59n8p4CS8i=83G6MhPrzfYEkf-8wC+4Ooq-w@mail.gmail.com>
	<87zjtfccnk.fsf@gmail.com>
Message-ID: <CABkCotRjYEos0SevYX7=dBeyFtLZHBDNBD1eRUu9893kn6XMeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130722/ba2de27b/attachment.pl>

From thi_veloso at yahoo.com.br  Mon Jul 22 16:41:59 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 22 Jul 2013 07:41:59 -0700 (PDT)
Subject: [R-sig-Geo] Read .dat file as raster
Message-ID: <1374504119.90671.YahooMailNeo@web121901.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130722/ea1a1c06/attachment.pl>

From r.hijmans at gmail.com  Mon Jul 22 22:04:16 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 22 Jul 2013 13:04:16 -0700
Subject: [R-sig-Geo] Read .dat file as raster
In-Reply-To: <1374504119.90671.YahooMailNeo@web121901.mail.ne1.yahoo.com>
References: <1374504119.90671.YahooMailNeo@web121901.mail.ne1.yahoo.com>
Message-ID: <CANtt_hz2Dj0FWKMc-Bu=xYaqBUM4BnfgXbY9yaCLB-vuGKE7MA@mail.gmail.com>

Thiago, it would be useful the mention the source (I am guessing CRU),
as others might then benefit from this discussion. Perhaps the below
does it (I have not checked this):

f <- 'ccld6190.dat'
d <- readLines(f)
d <- d[-c(1:2)]
d <- lapply(d, function(r) lapply(0:719, function(i) substr(r, i*5+1,(i+1)*5)))
d <- as.numeric(unlist(d))
d[d==-9999] <- NA
d <- matrix(d, ncol=12)

library(raster)
b <- brick(xmn=0, xmx=360, nl=12)
res(b) <- 0.5
values(b) <- d
b <- rotate(b)

Robert

On Mon, Jul 22, 2013 at 7:41 AM, Thiago V. dos Santos
<thi_veloso at yahoo.com.br> wrote:
> Dear all,
>
> Today I came across with a raster file formatted as ascii that looks like this: https://dl.dropboxusercontent.com/u/27700634/ccld6190.dat (17Mb)
>
> The question is: what is the best approach to read a file like this into R and convert it to a raster object?
>
>
> Thanks in advance,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From sheila_dufford at fws.gov  Mon Jul 22 22:10:04 2013
From: sheila_dufford at fws.gov (SheilaD)
Date: Mon, 22 Jul 2013 13:10:04 -0700 (PDT)
Subject: [R-sig-Geo] adehabitatHR kernalBB batch processing
In-Reply-To: <CAHT1vpi+iZ_T9UU6zTeuUM+4=ELVU5r3hVyUAjoP_pNrU9NdTA@mail.gmail.com>
References: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
	<1374280106183-7584205.post@n2.nabble.com>
	<CAHT1vpi+iZ_T9UU6zTeuUM+4=ELVU5r3hVyUAjoP_pNrU9NdTA@mail.gmail.com>
Message-ID: <CAAupi12eveef5tXG3_HCy-DPeFPEqjRptNHuAE3twX49S4Z9Xg@mail.gmail.com>

Roman,
Thank you for responding so quickly. My problem is in scripting the
kernalbb function to pull the appropriate sig1 value for each bounce. The
liker function works fine. I get the following results:

## Maximization of the log-likelihood for Brownian Motion Variance
parameter (sig2)
lik_all <- liker(S000all, sig2 = 14.6, rangesig1 = c(1, 10),byburst =
FALSE, plotit = F)
lik_all

## RESULTS - Maximization of the log-likelihood for parameter sig1 of
brownian bridge

#F05 : Sig1 = 7.1622 Sig2 = 14.6
#F06 : Sig1 = 4.6757 Sig2 = 14.6
#F07 : Sig1 = 4.8649 Sig2 = 14.6
#L05 : Sig1 = 7.1622 Sig2 = 14.6
#L06 : Sig1 = 6.1261 Sig2 = 14.6
#L07 : Sig1 = 7.2613 Sig2 = 14.6
#L08 : Sig1 = 4.8198 Sig2 = 14.6
#R04 : Sig1 = 2.7568 Sig2 = 14.6
#R05 : Sig1 = 2.9279 Sig2 = 14.6
#R06 : Sig1 = 2.5946 Sig2 = 14.6
#R07 : Sig1 = 2.4234 Sig2 = 14.6
#S05 : Sig1 = 6.3604 Sig2 = 14.6
#S06 : Sig1 = 5.1802 Sig2 = 14.6
#S07 : Sig1 = 6.8649 Sig2 = 14.6
#S08 : Sig1 = 4.9099 Sig2 = 14.6
#W05 : Sig1 = 3.1261 Sig2 = 14.6
#W06 : Sig1 = 3.027 Sig2 = 14.6
#W07 : Sig1 = 3.4775 Sig2 = 14.6
#W08 : Sig1 = 2.3243 Sig2 = 14.6

I tried the following script and it seemed to work, except it appears to
have pulled the first sig1 value and applied this same value to every
burst. I am a bit of a novice at R and realize I need some form of a loop,
but I have no Idea how to script it.

sig1 <- c(7.1622, 4.6757, 4.8649, 7.1622, 6.1261, 7.2613, 4.8198, 2.7568,
2.9279, 2.5946, 2.4234, 6.3604, 5.1802, 5.1802, 6.8649, 4.9099, 3.1261,
3.027, 3.4775, 2.234)
S000allBB2 <- kernelbb(S000all, sig1=SIG1, sig2 = 14.6, grid = 800,
same4all = TRUE, byburst = TRUE)

I also tried to apply the script suggested be Johannes Signer (See below).
But I could note get past the error messages and either did not get a
result or would get a warning that some of  the arguments were ignored.

sig255 <- liker(ltraj, sig2 = 255, rangesig1 = c(0, 1000))
tataall <- lapply(seq_along(ltraj), function(x) kernelbb(ltraj[x],
sig1=sig255[[x]]$sig1, sig2=sig255[[x]]$sig2, grid=100, byburst=T))

My data if for a single Dall sheep partitioned by year and season.  I would
like the grids to be all the same. I would simplify further analysis using
raster math. It seemed logical to me that if you could calculate the
individual sig1 values by-burst, you could apply them in the kernelbb
function by-burst. If it can not be easily done, I am ready to use a single
Sig1 value, calculated for the whole dataset, and run the kernelbb
by-burst. Running each burst individually results in rasters with different
spatial resolutions, because the animals seasonal home range varies. I am
also not sure if there is much difference in the results for the
methodologies.

My inexperience is glaringly obvious.

Thanks again.

Sheila


On Fri, Jul 19, 2013 at 10:21 PM, Roman Lu?trik [via R-sig-geo] <
ml-node+s2731867n7584206h16 at n2.nabble.com> wrote:

> What part is tripping you up? AFAIK, you "just" need to feed it a
> trajectory and some estimates from liker(). Are you having trouble
> extracting the data from those objects (objects `ltraj` and `sig255` in
> Phil's question)?
>
> Cheers,
> Roman
>
>
> On Sat, Jul 20, 2013 at 2:28 AM, SheilaD <[hidden email]<http://user/SendEmail.jtp?type=node&node=7584206&i=0>>
> wrote:
>
> > Has anyone been able to batch process the kernelbb function from
> > adehabitatHR
> > with individual sig1 values?
> >
> > p.s. im running
> > R version 2.15.2 (2012-10-26)
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > adehabitatHR_0.4.7 adehabitatLT_0.3.11?
> >
> > Sheila
> >
> >
> > Phil H wrote
> > > I am attempting to use the kernalBB function from adehabitatHR. Now it
> > > works just fine with just one fish, however I have quite a number of
> > > fish and would like to run the analysis on all the fish in one
> > > go-while maintaining individual sig 1 estimates. See below for example
> > > coding...
> > >
> > > library(adehabitatHR)
> > > library(adehabitatLT)
> > > data(puechabonsp)
> > >
> > > loc$DT <-as.POSIXct(strptime(loc$Date, format='%y%m%d' ))
> > > ltraj <- as.ltraj(coordinates(loc), loc$DT, id = loc$Name, burst =
> > > loc$Name,
> > > + typeII = TRUE)
> > >
> > > sig255<-liker(ltraj, sig2 = 255, rangesig1 = c(0, 1000))
> > >
> > > *****************************************
> > >
> > > Maximization of the log-likelihood for parameter
> > > sig1 of brownian bridge
> > >
> > > Brock : Sig1 = 2.002 Sig2 = 255
> > > Calou : Sig1 = 0 Sig2 = 255
> > > Chou : Sig1 = 1.001 Sig2 = 255
> > > Jean : Sig1 = 2.002 Sig2 = 255
> > >
> > > ##so now I would like to run the kernalBB on all 4 fish individually.
> > > ##so i tried...
> > >
> > >> tataall <- kernelbb(ltraj, sig1 = sig255, sig2 = 255, grid =
> > >> 100,byburst=T)
> > >
> > > #Error in sig1^2 : non-numeric argument to binary operator
> > >
> > > ##I dont have a great deal of experience working with list formats-
> > > can anyone ##assist me in calling the relevent sig 1 for each fish?
> > >
> > >
> > >
> > > #now if I know I can used a fixed sig 1 for all fine ie
> > >> tataall <- kernelbb(ltraj, sig1 = 1, sig2 = 255, grid =
> 100,byburst=T)
> > >
> > >
> > > ##I am sure it is something stupid and easy....
> > >
> > > ##I see that when you do a similar thing for the D function in the BRB
> > > function it seems to work fine  (I assume that this is using differing
> > > D levels for each fish..)
> > >
> > > vv2<- BRB.likD(ltraj, Dr=c(1,50000), Tmax = 5*(24*60*60) + 1, Lmin =
> 0.1)
> > > testud <-BRB(ltraj, D =vv2, Tmax =5*(24*60*60) + 1, Lmin =0.1, hmin =
> > 100)
> > >
> > >
> > > finally, I notice that we get some zero sig 1 values both in my
> > > dataset and in the example of Calou. Is this an issue?
> > >
> > > Thanks for any help
> > >
> > > Phil H.
> > >
> > > p.s. im running
> > > R version 2.15.2 (2012-10-26)
> > > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > > adehabitatHR_0.4.2 adehabitatLT_0.3.6
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> >
> > > R-sig-Geo@
> >
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-kernalBB-batch-processing-tp7583119p7584205.html
> > Sent from the R-sig-geo mailing list archive at Nabble.com.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > [hidden email] <http://user/SendEmail.jtp?type=node&node=7584206&i=1>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
>
> --
> In God we trust, all others bring data.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email] <http://user/SendEmail.jtp?type=node&node=7584206&i=2>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-kernalBB-batch-processing-tp7583119p7584206.html
>  To unsubscribe from adehabitatHR kernalBB batch processing, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7583119&code=c2hlaWxhX2R1ZmZvcmRAZndzLmdvdnw3NTgzMTE5fC05NTYyNjI5NDk=>
> .
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>



-- 
*Sheila J. Dufford*
*Biologist / GIS Specialist*
*Yukon Flats National Wildlife Refuge*
*101 12th Avenue, Room 264*
*Fairbanks, AK  99701*
*907-456-0307*
*sheila_dufford at fws.gov*
*
*
*"Most people are about as happy as they make up their minds to be.**"--Abraham
Lincoln*




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-kernalBB-batch-processing-tp7583119p7584225.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From fpb01 at health.ny.gov  Mon Jul 22 22:46:23 2013
From: fpb01 at health.ny.gov (Boscoe, Frank)
Date: Mon, 22 Jul 2013 20:46:23 +0000
Subject: [R-sig-Geo] adding labels to a projected plot
Message-ID: <2506c9044f634ca58607b90e98c264a0@BLUPR09MB054.namprd09.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130722/e8154917/attachment.pl>

From thi_veloso at yahoo.com.br  Mon Jul 22 22:49:58 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 22 Jul 2013 13:49:58 -0700 (PDT)
Subject: [R-sig-Geo] Read .dat file as raster
In-Reply-To: <CANtt_hz2Dj0FWKMc-Bu=xYaqBUM4BnfgXbY9yaCLB-vuGKE7MA@mail.gmail.com>
References: <1374504119.90671.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CANtt_hz2Dj0FWKMc-Bu=xYaqBUM4BnfgXbY9yaCLB-vuGKE7MA@mail.gmail.com>
Message-ID: <1374526198.31783.YahooMailNeo@web121906.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130722/fbcadb5f/attachment.pl>

From allar.haav at gmail.com  Tue Jul 23 03:23:02 2013
From: allar.haav at gmail.com (Allar Haav)
Date: Tue, 23 Jul 2013 02:23:02 +0100
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
Message-ID: <51EDDAF6.3060509@gmail.com>

Hi all,

I am currently trying to use spatstat's inhomogeneous cluster analysis 
methods (mostly Linhom), but ran into a problem. Namely, I have a pixel 
image (type "im") with values ranging from 0 to 1 indicating point 
probabilities. When creating and plotting random points with it, this 
intensity surface works as it should. I can also use it in regular 
envelope functions without issues. However, any attempt to use the 
intensity surface with Linhom function results in empty plot. I 
suspected that this might have something to do with the integral of the 
surface, therefore made a crude transformation so that it would be 
approximately the number of points under study (see below), but of 
course it didn't change anything. Generally I still feel that the crux 
lies in the intensity surface's values, but I can't quite put my finger 
on it.

A simplified code I used is as follows:

area <- as.owin(area_polygon)
sites <- as.ppp(as(readShapeSpatial('sites.shp')))
sites$window <- area
model <- as.im(read.asciigrid('model.asc'))
sites.n <- sites$n
integral <- summary(model)$integral

# This creates a nice plot with simulation envelopes
plot(envelope(sites, Lest, nsim=19, 
simulate=expression(rpoispp(eval.im(model*(sites.n/integral ))))))

# These produce only empty plots
plot(envelope(sites, Linhom, nsim=19, lambda=model ))
plot(envelope(sites, Linhom, nsim=19, lambda=eval.im(model 
*(sites.n/integral ))))

# A further check without envelope
Linhom(sites, lambda=model)
# This resulted in:
"Error in Kwtsum(dIJ, bI, wIJ, b, w = reciplambda, breaks) : Weights in 
K-function were infinite or NA"

That last error message left me a bit perplexed. Indeed, I have NA 
values in the dataset as the study area is not perfectly rectangular. 
But this should be a non-issue anyway.
Frankly I'm running out of ideas. I've been thinking of alternative 
approaches, e.g. creating random points from the intensity surface and 
fitting a model based on it using "ppm", perhaps using some covariates. 
Yet this seems actually an awful idea considering the probable loss of 
accuracy and the fact that basically the model already exists.

As a side note, a bit of googling on the issue revealed an older post 
about inhomogeneous process analysis 
(http://r-sig-geo.2731867.n2.nabble.com/memory-allocation-problem-with-envelope-function-in-spatstat-td5029218.html). 
There a command equivalent to my first envelope plot was used: 
Lin=envelope(SPECIES.ppp,Linhom,nsim=5,simulate=expression(rpoispp(lambda)), 
! + correction="border")
That made me think that I might be overthinking the problem and I've 
already found the solution with first try. However I am still skeptical 
as the difference between Lest and Linhom does not lie merely in 
simulated patterns - weights are also to be considered. If so, why was 
this solution used?

Any suggestions or ideas? All sort of feedback would be appreciated.

Regards,
Allar Haav


From rmettier at gmail.com  Tue Jul 23 11:21:18 2013
From: rmettier at gmail.com (Ralph Mettier)
Date: Tue, 23 Jul 2013 11:21:18 +0200
Subject: [R-sig-Geo] gstat: Cokriging with unusual neighbourhood choice - is
	this possible?
Message-ID: <CAFsio8iANo0fVYCDbZEwJGydVULqkTuL7FjXREz0WNdWamaFzQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130723/a26d0535/attachment.pl>

From r.turner at auckland.ac.nz  Tue Jul 23 12:07:12 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 23 Jul 2013 22:07:12 +1200
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <51EDDAF6.3060509@gmail.com>
References: <51EDDAF6.3060509@gmail.com>
Message-ID: <51EE55D0.7000407@auckland.ac.nz>


Dear Allar,

It is impossible for me to tell from the information that you have 
provided what is going
wrong.  Basically it seems to me that the code you used will work "in 
general".  It is strange
that you are getting *empty* plots.   A toy example (see below) 
indicates that "empty plots"
should not result.

I can see why there might be problems with the envelope, but the plot 
shouldn't be
*empty*.  At the very least you should get a plot of Linhom(sites).

Toy example:

W <- disc(0.5,c(0.5,0.5),npoly=6)
A  <- as.im(function(x,y){0.1*cos(2*pi*(x^2+y^2))^2},W=W)
i    <- summary(A)$integral
B   <- eval.im(100*A/i)
set.seed(42)
X  <- rpoispp(B)[W]
E1 <- envelope(X,Linhom,lambda=A,nsim=19)
E2 <- envelope(X,Linhom,lambda=B,nsim=19)
E3 <- envelope(X,Linhom,lambda=A,simulate=expression(rpoispp(A)),nsim=19)
plot(E1)
plot(E2)
plot(E3)

The envelopes E1 and E2 are silly looking, being inappropriate, but they are
certainly not empty.

The envelope E3 yields a non-empty plot, although there is no envelope 
as such.
This is due to the fact that the "simulate" expression yields nothing 
but empty
patterns (from which no L function estimate can be calculated).

I suspect that what you actually did was something like the E3 
calculation rather
than what you told us you did.

What you probably should have done is something like:

E4 <- envelope(X,Linhom,lambda=B,simulate=expression(rpoispp(B)),nsim=19)

which produces a sensible envelope.

What Linhom() does for you is to allow you to assess whether "sites" 
arises from an
inhomogeneous Poisson process or if there is evidence of interaction in 
the data.  To
apply Linhom() you must know (or have an idea of) the underlying 
intensity of "sites".
To use an intensity such as "model" which you apparently *know* would 
generate fewer
points than there are in "sites" makes no sense.  Use an intensity which 
you actually
believe to be the underlying intensity for "sites" (or which you at 
least believe to be a
*plausible* candidate for this intensity).

     cheers,

         Rolf Turner

P. S.  The error that you got from applying Linhom() directly to "sites" 
with lambda=model
might have arisen because "model" has some zero values.  I *think* this 
will be a problem
only if it has zero values at one or more points of "sites". Haven't 
experimented with
this.

         R. T.

On 23/07/13 13:23, Allar Haav wrote:
> Hi all,
>
> I am currently trying to use spatstat's inhomogeneous cluster analysis 
> methods (mostly Linhom), but ran into a problem. Namely, I have a 
> pixel image (type "im") with values ranging from 0 to 1 indicating 
> point probabilities. When creating and plotting random points with it, 
> this intensity surface works as it should. I can also use it in 
> regular envelope functions without issues. However, any attempt to use 
> the intensity surface with Linhom function results in empty plot. I 
> suspected that this might have something to do with the integral of 
> the surface, therefore made a crude transformation so that it would be 
> approximately the number of points under study (see below), but of 
> course it didn't change anything. Generally I still feel that the crux 
> lies in the intensity surface's values, but I can't quite put my 
> finger on it.
>
> A simplified code I used is as follows:
>
> area <- as.owin(area_polygon)
> sites <- as.ppp(as(readShapeSpatial('sites.shp')))
> sites$window <- area
> model <- as.im(read.asciigrid('model.asc'))
> sites.n <- sites$n
> integral <- summary(model)$integral
>
> # This creates a nice plot with simulation envelopes
> plot(envelope(sites, Lest, nsim=19, 
> simulate=expression(rpoispp(eval.im(model*(sites.n/integral ))))))
>
> # These produce only empty plots
> plot(envelope(sites, Linhom, nsim=19, lambda=model ))
> plot(envelope(sites, Linhom, nsim=19, lambda=eval.im(model 
> *(sites.n/integral ))))
>
> # A further check without envelope
> Linhom(sites, lambda=model)
> # This resulted in:
> "Error in Kwtsum(dIJ, bI, wIJ, b, w = reciplambda, breaks) : Weights 
> in K-function were infinite or NA"
>
> That last error message left me a bit perplexed. Indeed, I have NA 
> values in the dataset as the study area is not perfectly rectangular. 
> But this should be a non-issue anyway.
> Frankly I'm running out of ideas. I've been thinking of alternative 
> approaches, e.g. creating random points from the intensity surface and 
> fitting a model based on it using "ppm", perhaps using some 
> covariates. Yet this seems actually an awful idea considering the 
> probable loss of accuracy and the fact that basically the model 
> already exists.
>
> As a side note, a bit of googling on the issue revealed an older post 
> about inhomogeneous process analysis 
> (http://r-sig-geo.2731867.n2.nabble.com/memory-allocation-problem-with-envelope-function-in-spatstat-td5029218.html). 
> There a command equivalent to my first envelope plot was used: 
> Lin=envelope(SPECIES.ppp,Linhom,nsim=5,simulate=expression(rpoispp(lambda)), 
> ! + correction="border")
> That made me think that I might be overthinking the problem and I've 
> already found the solution with first try. However I am still 
> skeptical as the difference between Lest and Linhom does not lie 
> merely in simulated patterns - weights are also to be considered. If 
> so, why was this solution used?
>
> Any suggestions or ideas? All sort of feedback would be appreciated.


From edzer.pebesma at uni-muenster.de  Tue Jul 23 12:37:05 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 23 Jul 2013 12:37:05 +0200
Subject: [R-sig-Geo] gstat: Cokriging with unusual neighbourhood choice
 - is this possible?
In-Reply-To: <CAFsio8iANo0fVYCDbZEwJGydVULqkTuL7FjXREz0WNdWamaFzQ@mail.gmail.com>
References: <CAFsio8iANo0fVYCDbZEwJGydVULqkTuL7FjXREz0WNdWamaFzQ@mail.gmail.com>
Message-ID: <51EE5CD1.8060303@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Ralph,

I guess you'd need to define three variables,

concA, precA and precB. Then, you can let precA and precB have
different neighbourhood specs, but make them statistically "identical"
by specifying the same variograms for precA and precB as well as for
its cross variogram, and use the merge option to have them share a
single mean value. (see ?gstat ; there's an example of this in
demo(pcb) ).

On 07/23/2013 11:21 AM, Ralph Mettier wrote:
> I'm looking at two variables, concentration and precipitation,
> measured at two networks of stations:
> 
> network A measures both variables at few (~30), widely spaced
> stations network B measures only precipitation at many (~1800)
> densely spaced stations
> 
> a decent correlation between the two variables is expected, making 
> cokriging an attractive choice. Ordinary cokriging in gstat works,
> using only concentration from network A and precipitation only from
> network B. However, for quality assurance, I am trying to reproduce
> previous results obtained using a different, commercial,
> geostatistics tool.
> 
> Currently, I am using nmax (and maxdist) to control the points in
> the neighbourhoods (16 concentration and 32 precipitation), but
> what I would ideally need to do is the following:
> 
> For concentration, the neighbourhood should contain the 16 nearest 
> measurements from network A, as is the case now. For precipitation,
> the neighbourhood should contain the 16 nearest measurements from
> network B and the 16 nearest measurements from network A. This
> doesn't seem possible using the 'nmax' option in gstat.
> 
> I have tried splitting concentration and precipitation from network
> A into two seperate gstat objects and then using cokriging with
> three variables, but the results are unsatisfying and I'm fairly
> certain this is not the way to go.
> 
> Any hints or pushes in the right direction would be greatly
> appreciated.
> 
> Best Regards Ralph
> 
> [[alternative HTML version deleted]]
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR7lzRAAoJEM1OCHCtOnfx3pUH/27TvcVqFg50DPXkqKjX7c9N
9RE36Sy1lFd/WG8ky6VK3Wb+M3kNfNh1ZsVyK/zjYwjD7QswGgsSl7ZGgt29GrEJ
S0271WagmRYFLG7iHD4F00NOLffe2d7wl9Go5t/paYh1chjI8JQFWwSUJy9J9u3y
0yBwZ3SWhqULaijdbVlSVsdSv09PPuirz/j1KIQqmzWD+E/Rtno64oPUuBVPWV2K
WYTNvstYQ6R5pdMrOj5yPKKSPkzqwj5W7ohRYgIsIXnZGCV8uQUnF5UmLPOwln6G
+rjrS3rSGlBYqmcgXPpvCOfs9fexiuZL+VL21TDg/std3lWI5ob6akCYDhkKpaw=
=ceyk
-----END PGP SIGNATURE-----


From bakare at ualberta.ca  Tue Jul 23 17:49:51 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 23 Jul 2013 09:49:51 -0600
Subject: [R-sig-Geo] variogram modeling using gstat
Message-ID: <CAJRR3XMPGMdFgv0NTzxo-S_WXXPRqsT7tERTUv5q_+w1vw5zTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130723/03648cfc/attachment.pl>

From markus.jenning at web.de  Tue Jul 23 17:56:57 2013
From: markus.jenning at web.de (Markus Jenning)
Date: Tue, 23 Jul 2013 17:56:57 +0200
Subject: [R-sig-Geo] Which are the most suitable,
 elegant or efficient packages for geographical maps in R? Which did
 you use yourself?
Message-ID: <op.w0omk71svldg4i@charliebravo123>

Hi everyone.

I remember some very interesting and professional-looking R projects that  
somehow involved geographical maps.
Now that I'd like to work with maps myself, let me ask you this question:
Which of the packages that are currently available would you think are the  
most elegant and useful for an R project that use maps?
Which packages (other than the "maps" package) did you use in your own  
projects and why?
Are there any packages that are not available on CRAN (or in some way hard  
to find) but that still deserve recognition?

Thanks for your help, and feel free to redirect me to a more suitable  
thread or even another group if you feel that this question could better  
be asked elsewhere.

Cheers,
Markus


From sarah.goslee at gmail.com  Tue Jul 23 18:06:52 2013
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Tue, 23 Jul 2013 12:06:52 -0400
Subject: [R-sig-Geo] Which are the most suitable,
 elegant or efficient packages for geographical maps in R? Which did
 you use yourself?
In-Reply-To: <op.w0omk71svldg4i@charliebravo123>
References: <op.w0omk71svldg4i@charliebravo123>
Message-ID: <CAM_vjun9LYxjfXRN+BB9T_sWdNqJfwsMRdj9_hbjdayJQGMtEQ@mail.gmail.com>

HI Markus,

That's... rather broad.

I'd suggest installing the Spatial taskview, reading about what's
available as part of that collection at
http://cran.r-project.org/web/views/Spatial.html and then thinking
about what you are trying to accomplish.

Surely a more focused answer would be more useful than having everyone
list all the packages they use, as well as requiring less time from
the list members.

Sarah


On Tue, Jul 23, 2013 at 11:56 AM, Markus Jenning <markus.jenning at web.de> wrote:
> Hi everyone.
>
> I remember some very interesting and professional-looking R projects that
> somehow involved geographical maps.
> Now that I'd like to work with maps myself, let me ask you this question:
> Which of the packages that are currently available would you think are the
> most elegant and useful for an R project that use maps?
> Which packages (other than the "maps" package) did you use in your own
> projects and why?
> Are there any packages that are not available on CRAN (or in some way hard
> to find) but that still deserve recognition?
>
> Thanks for your help, and feel free to redirect me to a more suitable thread
> or even another group if you feel that this question could better be asked
> elsewhere.
>
> Cheers,
> Markus
>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From blows_michael at yahoo.com  Tue Jul 23 18:52:34 2013
From: blows_michael at yahoo.com (Michael Blows)
Date: Tue, 23 Jul 2013 09:52:34 -0700 (PDT)
Subject: [R-sig-Geo] matching names in the input data with those on the map
Message-ID: <1374598354.37347.YahooMailNeo@web161203.mail.bf1.yahoo.com>

Hi all, I see someone had earlier posted similar question to the list. But, my problem is that? the counties in the input data don't match those on the map. Codes below:
############
library(spdep)
library(maps)
data<-read.csv("C:/Users/mitra.devkota/Desktop/MT1.csv",header=TRUE)?
names(data)
data$merge <- paste(tolower(data$State),tolower(data$NAME), sep='.')
newmap <- map("county",c("montana"), fill=T, plot=F)
?commaReplace <- function(x) {
? ? return(gsub(",",".", x))
}
newmap$names <- sapply(newmap$names, commaReplace, simplify=TRUE)
names(newmap$names) <- NULL
length(newmap$names)?
# Merge the data with the geography
index <- match(newmap$names, data$merge)
# printing index gives
>index
?[1] ?1 ?2 ?3 ?4 ?5 ?6 ?7 ?8 ?9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 29 28 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
[51] 51 52 53 54 55 56 NA
#The NA is the problem now.
Any hand is appreciated.

Mike


From nrevistada at yahoo.co.uk  Tue Jul 23 19:42:42 2013
From: nrevistada at yahoo.co.uk (=?iso-8859-1?Q?C=E9sar_Capinha?=)
Date: Tue, 23 Jul 2013 18:42:42 +0100 (BST)
Subject: [R-sig-Geo] pca on raster layers with NA's
Message-ID: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>

Dear all,
I have a set of 7 overlaying rasters for which I want to perform a principal components analysis and subsequently extract the corresponding maps of the two or three principal components (i.e. the scores).
I've been trying to do this for a while, but I keep getting stuck in the beginning with this error message: "Error in cov.wt(z) : 'x' must contain finite values only" 
I think this is related to the presence of NA's in the raster layers but I'm not being able to figure out a way to solve this issue .

Any suggestions ? 


#code begin
library(raster)
elev <- raster("elev.asc")
expo <- raster("expo.asc")
wind <- raster("wind.asc")
pop <- raster("pop.asc")
prec <- raster("prec.asc")
temp <- raster("temp.asc")
access <- raster("access.asc")

s <- c("elev", "expo", "wind", "pop", "prec", "temp", "access")
pca<-princomp(s, cor=T)

#code end


Many thanks in advance.
Edward Correia


From tim.appelhans at gmail.com  Tue Jul 23 20:53:57 2013
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Tue, 23 Jul 2013 20:53:57 +0200
Subject: [R-sig-Geo] pca on raster layers with NA's
In-Reply-To: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
References: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
Message-ID: <51EED145.3030402@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130723/0116315a/attachment.pl>

From allar.haav at gmail.com  Tue Jul 23 21:56:37 2013
From: allar.haav at gmail.com (Allar Haav)
Date: Tue, 23 Jul 2013 20:56:37 +0100
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <51EE55D0.7000407@auckland.ac.nz>
References: <51EDDAF6.3060509@gmail.com> <51EE55D0.7000407@auckland.ac.nz>
Message-ID: <51EEDFF5.10307@gmail.com>

Dear Rolf,

Thank you for insightful answer. Following your explanation I found out 
that the key problem was that I didn't specify the simulation in Linhom 
envelope. For some reason I thought that lambda would be overriding the 
envelope creating point process. So, your example 4 was really helpful 
for that matter.

However in order to produce a proper-looking graph with an envelope, I 
had to use reciplambda instead of the regular one. I figured this out 
after seeing that while envelope was calculated and displayed correctly, 
the observed Linhom(r) line did not appear (envelope's "obs" values are 
either 0's or NaN's). Using reciplambda did the trick though, but the 
values on the y-axis are 1e+07 times smaller than they should.  Creating 
random patterns using rpoispp() does not indicate at all that the 
intensity surface should be used reciprocally: the number of points and 
their spatial distribution make sense. Also if using randomly created 
points there is no need for reciplambda, although it works both ways 
showing slightly different results. Another worrying issue, but I'll try 
to look into it.


Thank you and all the best,
Allar


On 23/07/2013 11:07, Rolf Turner wrote:
>
> Dear Allar,
>
> It is impossible for me to tell from the information that you have 
> provided what is going
> wrong.  Basically it seems to me that the code you used will work "in 
> general".  It is strange
> that you are getting *empty* plots.   A toy example (see below) 
> indicates that "empty plots"
> should not result.
>
> I can see why there might be problems with the envelope, but the plot 
> shouldn't be
> *empty*.  At the very least you should get a plot of Linhom(sites).
>
> Toy example:
>
> W <- disc(0.5,c(0.5,0.5),npoly=6)
> A  <- as.im(function(x,y){0.1*cos(2*pi*(x^2+y^2))^2},W=W)
> i    <- summary(A)$integral
> B   <- eval.im(100*A/i)
> set.seed(42)
> X  <- rpoispp(B)[W]
> E1 <- envelope(X,Linhom,lambda=A,nsim=19)
> E2 <- envelope(X,Linhom,lambda=B,nsim=19)
> E3 <- envelope(X,Linhom,lambda=A,simulate=expression(rpoispp(A)),nsim=19)
> plot(E1)
> plot(E2)
> plot(E3)
>
> The envelopes E1 and E2 are silly looking, being inappropriate, but 
> they are
> certainly not empty.
>
> The envelope E3 yields a non-empty plot, although there is no envelope 
> as such.
> This is due to the fact that the "simulate" expression yields nothing 
> but empty
> patterns (from which no L function estimate can be calculated).
>
> I suspect that what you actually did was something like the E3 
> calculation rather
> than what you told us you did.
>
> What you probably should have done is something like:
>
> E4 <- envelope(X,Linhom,lambda=B,simulate=expression(rpoispp(B)),nsim=19)
>
> which produces a sensible envelope.
>
> What Linhom() does for you is to allow you to assess whether "sites" 
> arises from an
> inhomogeneous Poisson process or if there is evidence of interaction 
> in the data.  To
> apply Linhom() you must know (or have an idea of) the underlying 
> intensity of "sites".
> To use an intensity such as "model" which you apparently *know* would 
> generate fewer
> points than there are in "sites" makes no sense.  Use an intensity 
> which you actually
> believe to be the underlying intensity for "sites" (or which you at 
> least believe to be a
> *plausible* candidate for this intensity).
>
>     cheers,
>
>         Rolf Turner
>
> P. S.  The error that you got from applying Linhom() directly to 
> "sites" with lambda=model
> might have arisen because "model" has some zero values.  I *think* 
> this will be a problem
> only if it has zero values at one or more points of "sites". Haven't 
> experimented with
> this.
>
>         R. T.
>
> On 23/07/13 13:23, Allar Haav wrote:
>> Hi all,
>>
>> I am currently trying to use spatstat's inhomogeneous cluster 
>> analysis methods (mostly Linhom), but ran into a problem. Namely, I 
>> have a pixel image (type "im") with values ranging from 0 to 1 
>> indicating point probabilities. When creating and plotting random 
>> points with it, this intensity surface works as it should. I can also 
>> use it in regular envelope functions without issues. However, any 
>> attempt to use the intensity surface with Linhom function results in 
>> empty plot. I suspected that this might have something to do with the 
>> integral of the surface, therefore made a crude transformation so 
>> that it would be approximately the number of points under study (see 
>> below), but of course it didn't change anything. Generally I still 
>> feel that the crux lies in the intensity surface's values, but I 
>> can't quite put my finger on it.
>>
>> A simplified code I used is as follows:
>>
>> area <- as.owin(area_polygon)
>> sites <- as.ppp(as(readShapeSpatial('sites.shp')))
>> sites$window <- area
>> model <- as.im(read.asciigrid('model.asc'))
>> sites.n <- sites$n
>> integral <- summary(model)$integral
>>
>> # This creates a nice plot with simulation envelopes
>> plot(envelope(sites, Lest, nsim=19, 
>> simulate=expression(rpoispp(eval.im(model*(sites.n/integral ))))))
>>
>> # These produce only empty plots
>> plot(envelope(sites, Linhom, nsim=19, lambda=model ))
>> plot(envelope(sites, Linhom, nsim=19, lambda=eval.im(model 
>> *(sites.n/integral ))))
>>
>> # A further check without envelope
>> Linhom(sites, lambda=model)
>> # This resulted in:
>> "Error in Kwtsum(dIJ, bI, wIJ, b, w = reciplambda, breaks) : Weights 
>> in K-function were infinite or NA"
>>
>> That last error message left me a bit perplexed. Indeed, I have NA 
>> values in the dataset as the study area is not perfectly rectangular. 
>> But this should be a non-issue anyway.
>> Frankly I'm running out of ideas. I've been thinking of alternative 
>> approaches, e.g. creating random points from the intensity surface 
>> and fitting a model based on it using "ppm", perhaps using some 
>> covariates. Yet this seems actually an awful idea considering the 
>> probable loss of accuracy and the fact that basically the model 
>> already exists.
>>
>> As a side note, a bit of googling on the issue revealed an older post 
>> about inhomogeneous process analysis 
>> (http://r-sig-geo.2731867.n2.nabble.com/memory-allocation-problem-with-envelope-function-in-spatstat-td5029218.html). 
>> There a command equivalent to my first envelope plot was used: 
>> Lin=envelope(SPECIES.ppp,Linhom,nsim=5,simulate=expression(rpoispp(lambda)), 
>> ! + correction="border")
>> That made me think that I might be overthinking the problem and I've 
>> already found the solution with first try. However I am still 
>> skeptical as the difference between Lest and Linhom does not lie 
>> merely in simulated patterns - weights are also to be considered. If 
>> so, why was this solution used?
>>
>> Any suggestions or ideas? All sort of feedback would be appreciated.


From r.hijmans at gmail.com  Tue Jul 23 22:43:25 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 23 Jul 2013 13:43:25 -0700
Subject: [R-sig-Geo] pca on raster layers with NA's
In-Reply-To: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
References: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
Message-ID: <CANtt_hxxZ9zxrwnXiR=ceh6oWprFinCd=t+MTL1SR8vKAHj4Hg@mail.gmail.com>

C?sar, I think you can do princomp(na.omit(values(s)), cor=TRUE)
For large objects, also see the pca example in ?raster::predict
Robert

On Tue, Jul 23, 2013 at 10:42 AM, C?sar Capinha <nrevistada at yahoo.co.uk> wrote:
> Dear all,
> I have a set of 7 overlaying rasters for which I want to perform a principal components analysis and subsequently extract the corresponding maps of the two or three principal components (i.e. the scores).
> I've been trying to do this for a while, but I keep getting stuck in the beginning with this error message: "Error in cov.wt(z) : 'x' must contain finite values only"
> I think this is related to the presence of NA's in the raster layers but I'm not being able to figure out a way to solve this issue .
>
> Any suggestions ?
>
>
> #code begin
> library(raster)
> elev <- raster("elev.asc")
> expo <- raster("expo.asc")
> wind <- raster("wind.asc")
> pop <- raster("pop.asc")
> prec <- raster("prec.asc")
> temp <- raster("temp.asc")
> access <- raster("access.asc")
>
> s <- c("elev", "expo", "wind", "pop", "prec", "temp", "access")
> pca<-princomp(s, cor=T)
>
> #code end
>
>
> Many thanks in advance.
> Edward Correia
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.turner at auckland.ac.nz  Tue Jul 23 23:57:14 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 24 Jul 2013 09:57:14 +1200
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <51EEDFF5.10307@gmail.com>
References: <51EDDAF6.3060509@gmail.com> <51EE55D0.7000407@auckland.ac.nz>
	<51EEDFF5.10307@gmail.com>
Message-ID: <51EEFC3A.9060908@auckland.ac.nz>

On 24/07/13 07:56, Allar Haav wrote:
> Dear Rolf,
>
> Thank you for insightful answer. Following your explanation I found 
> out that the key problem was that I didn't specify the simulation in 
> Linhom envelope. For some reason I thought that lambda would be 
> overriding the envelope creating point process. So, your example 4 was 
> really helpful for that matter.
>
> However in order to produce a proper-looking graph with an envelope, I 
> had to use reciplambda instead of the regular one. I figured this out 
> after seeing that while envelope was calculated and displayed 
> correctly, the observed Linhom(r) line did not appear (envelope's 
> "obs" values are either 0's or NaN's). Using reciplambda did the trick 
> though, but the values on the y-axis are 1e+07 times smaller than they 
> should.  Creating random patterns using rpoispp() does not indicate at 
> all that the intensity surface should be used reciprocally: the number 
> of points and their spatial distribution make sense. Also if using 
> randomly created points there is no need for reciplambda, although it 
> works both ways showing slightly different results. Another worrying 
> issue, but I'll try to look into it.

This does not make a hell of a lot of sense to me.  Can you make your 
data ("sites" and "model")
available to me to experiment with and see what is going on?

Basically if you think that "model" represents the underlying intensity 
for "sites" then

     X <- rpoispp(model)

should bear at least a *vague* resemblance to "sites".   If you think 
that "model" represents
the reciprocal of the underlying intensity for "sites" then

     recipMod <- eval.im(1/model)
     Y <- rpoispp(recipMod)

should yield a "Y" which bears at least a vague resemblance to "sites".  
If neither of these
apply then it would appear that "model" has nothing to do with the 
intensity underlying sites,
and you shouldn't be using it.  Or perhaps some other transformation of 
"model" is
required.  Perhaps you need to use exp(model)?  This would apply if 
"model" arises from
the *linear* predictor of a loglinear model for the intensity.

     cheers,

         Rolf


From allar.haav at gmail.com  Wed Jul 24 00:47:12 2013
From: allar.haav at gmail.com (Allar Haav)
Date: Tue, 23 Jul 2013 23:47:12 +0100
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <51EEFC3A.9060908@auckland.ac.nz>
References: <51EDDAF6.3060509@gmail.com> <51EE55D0.7000407@auckland.ac.nz>
	<51EEDFF5.10307@gmail.com> <51EEFC3A.9060908@auckland.ac.nz>
Message-ID: <51EF07F0.40709@gmail.com>

Ah! Thank you! Exponenting the "model" truly fixed the problem as, 
indeed, the pixel image indeed stems from a multinomial logit model. I 
am not really sure why though, something to do with Poisson process 
probability function?

All the best,
Allar

On 23/07/2013 22:57, Rolf Turner wrote:
> This does not make a hell of a lot of sense to me.  Can you make your 
> data ("sites" and "model")
> available to me to experiment with and see what is going on?
>
> Basically if you think that "model" represents the underlying 
> intensity for "sites" then
>
>     X <- rpoispp(model)
>
> should bear at least a *vague* resemblance to "sites".   If you think 
> that "model" represents
> the reciprocal of the underlying intensity for "sites" then
>
>     recipMod <- eval.im(1/model)
>     Y <- rpoispp(recipMod)
>
> should yield a "Y" which bears at least a vague resemblance to 
> "sites".  If neither of these
> apply then it would appear that "model" has nothing to do with the 
> intensity underlying sites,
> and you shouldn't be using it.  Or perhaps some other transformation 
> of "model" is
> required.  Perhaps you need to use exp(model)?  This would apply if 
> "model" arises from
> the *linear* predictor of a loglinear model for the intensity.
>
>     cheers,
>
>         Rolf


From bakare at ualberta.ca  Wed Jul 24 03:54:24 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Tue, 23 Jul 2013 19:54:24 -0600
Subject: [R-sig-Geo] Shapefile for spatial point referenced data
Message-ID: <CAJRR3XOvk+Xk8o3CNWJYnrVqnyZm_-i5u1ApGi5kPQrx-ZR9sw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130723/c8acf812/attachment.pl>

From adrian.baddeley at uwa.edu.au  Wed Jul 24 05:50:46 2013
From: adrian.baddeley at uwa.edu.au (Adrian Baddeley)
Date: Wed, 24 Jul 2013 11:50:46 +0800
Subject: [R-sig-Geo]  Using pixel image as spatstat's intensity surface
In-Reply-To: <mailman.17.1374573604.5847.r-sig-geo@r-project.org>
References: <mailman.17.1374573604.5847.r-sig-geo@r-project.org>
Message-ID: <1CEF56CFF7118748AE0FA6C0186D3A31286C07F9@IS-WIN-172.staffad.uwa.edu.au>

Allar Haav writes:

> I am currently trying to use spatstat's inhomogeneous cluster analysis
> methods (mostly Linhom), but ran into a problem. Namely, I have a pixel
> image (type "im") with values ranging from 0 to 1 indicating point
> probabilities. When creating and plotting random points with it, this
> intensity surface works as it should.

Intensities are not probabilities.
The intensity is the expected number of points per unit area (possibly spatially-varying).
If the probability of presence of a point is 'p', in a small pixel of area 'a', then the
intensity in that pixel is approximately p/a. 
Thus, to get the correct interpretation in Kinhom, Linhom etc, you need to rescale 
your image pixel values by dividing by the pixel area. 

As a crosscheck, if 'lambda' is an intensity function (stored as a pixel image) that was obtained by fitting
to the point pattern 'X' by some procedure, then integral.im(lambda) should be approximately equal to npoints(X),
because the integral of the intensity is the expected total number of points.

> Linhom(sites, lambda=model)
> # This resulted in:
> "Error in Kwtsum(dIJ, bI, wIJ, b, w = reciplambda, breaks) : Weights in
> K-function were infinite or NA"

This is an important clue that the point pattern called 'sites' apparently includes some points where 
the intensity image called 'model' has a pixel value of either 0 or NA. To check this, extract the 
relevant pixel values at each data point:

       modvals <- model[sites, drop=FALSE]

and inspect them. The inhomogeneous K and L functions attach a weight to each pair of 
data points x_i, x_j proportional to 1/(lambda(x_i) lambda(x_j)) where lambda() is the intensity
function. A value of 0 is illegal because the weight is then infinite, or more insightfully,
because 0 means that "model" thinks it is impossible for a point to occur at that location.
A value of NA is also rejected because that means we don't have the data to compute the inhomogeneous
K function. 

Don't use 'reciplambda' - that is a red herring and will just get everyone confused. 

>  I can also use it in regular
> envelope functions without issues. However, any attempt to use the
> intensity surface with Linhom function results in empty plot.

In calls to envelope() using Kinhom or Linhom, there are two things to consider. 
One is how you want to generate the simulated point patterns that will contribute to the envelope
(this determines the 'null hypothesis' that you are testing).
In your case, you probably want to do something like 
     envelope(..... simulate=expression(rpoispp(mylambda)))
where 'mylambda' is an image containing the intensity values. This will generate realisations
from the inhomogeneous Poisson process with the specified intensity - assuming that is the
null hypothesis.

The other consideration is how you want the simulated points to be weighted in the calculation
of Kinhom or Linhom. For this you could specify the argument 'lambda' that will be passed
from envelope() to Kinhom(). For example if you want to use the same intensity function 'mylambda'
just type
      envelope(X, ..., simulate=expression(rpoispp(mylambda)), lambda=mylambda)

There are some other caveats about the validity of the resulting envelopes (because 'mylambda'
was presumably computed by fitting to the data point pattern 'X') but I'll leave that until later.

Adrian Baddeley

Prof Adrian Baddeley FAA
University of Western Australia  /and/ CSIRO Mathematics, Informatics & Statistics
Mail: <cet.uwa.edu.au>             Skype: adrian.baddeley


From Thierry.ONKELINX at inbo.be  Wed Jul 24 10:02:47 2013
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 24 Jul 2013 08:02:47 +0000
Subject: [R-sig-Geo] spatial correlation model and variogram
In-Reply-To: <CAJRR3XPRsqac+SSr+2wAQho3fEYaEsXiN1W4bZ26N9w2gZ=pkw@mail.gmail.com>
References: <CAJRR3XOW5KMF0CaWnEqBMxb7t4Mi8-WmDherv04C=nW5Z0vK3g@mail.gmail.com>
	<AA818EAD2576BC488B4F623941DA7427CD30198F@inbomail.inbo.be>
	<CAJRR3XPRsqac+SSr+2wAQho3fEYaEsXiN1W4bZ26N9w2gZ=pkw@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA7427CD31462C@inbomail.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130724/621da292/attachment.pl>

From allar.haav at gmail.com  Wed Jul 24 10:38:53 2013
From: allar.haav at gmail.com (Allar Haav)
Date: Wed, 24 Jul 2013 09:38:53 +0100
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <1CEF56CFF7118748AE0FA6C0186D3A31286C07F9@IS-WIN-172.staffad.uwa.edu.au>
References: <mailman.17.1374573604.5847.r-sig-geo@r-project.org>
	<1CEF56CFF7118748AE0FA6C0186D3A31286C07F9@IS-WIN-172.staffad.uwa.edu.au>
Message-ID: <51EF929D.3070203@gmail.com>

Thank you Adrian and Rolf!
Your explanations have been really helpful. It seems I've had some 
misconceptions about the relationship between intensities and probabilities.
Found a book "Statistical Analysis and Modelling of Spatial Point 
Patterns" by Illian et al. to get a proper understanding of the whole topic.

Again, you've been most helpful.

All the best,
Allar


From nrevistada at yahoo.co.uk  Wed Jul 24 10:44:33 2013
From: nrevistada at yahoo.co.uk (=?iso-8859-1?Q?C=E9sar_Capinha?=)
Date: Wed, 24 Jul 2013 09:44:33 +0100 (BST)
Subject: [R-sig-Geo] pca on raster layers with NA's
In-Reply-To: <CANtt_hxxZ9zxrwnXiR=ceh6oWprFinCd=t+MTL1SR8vKAHj4Hg@mail.gmail.com>
References: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
	<CANtt_hxxZ9zxrwnXiR=ceh6oWprFinCd=t+MTL1SR8vKAHj4Hg@mail.gmail.com>
Message-ID: <1374655473.75496.YahooMailNeo@web173103.mail.ir2.yahoo.com>

Dear Robert, 
It works really fine.

Thanks a lot.
Edward.


Shared e-mail account. 




----- Original Message -----
From: Robert J. Hijmans <r.hijmans at gmail.com>
To: C?sar Capinha <nrevistada at yahoo.co.uk>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Sent: Tuesday, 23 July 2013, 21:43
Subject: Re: [R-sig-Geo] pca on raster layers with NA's

C?sar, I think you can do princomp(na.omit(values(s)), cor=TRUE)
For large objects, also see the pca example in ?raster::predict
Robert


From nrevistada at yahoo.co.uk  Wed Jul 24 10:49:18 2013
From: nrevistada at yahoo.co.uk (=?iso-8859-1?Q?C=E9sar_Capinha?=)
Date: Wed, 24 Jul 2013 09:49:18 +0100 (BST)
Subject: [R-sig-Geo] pca on raster layers with NA's
In-Reply-To: <51EED145.3030402@gmail.com>
References: <1374601362.72091.YahooMailNeo@web173105.mail.ir2.yahoo.com>
	<51EED145.3030402@gmail.com>
Message-ID: <1374655758.23731.YahooMailNeo@web173101.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130724/485dba68/attachment.pl>

From alexandresantosbr at yahoo.com.br  Wed Jul 24 14:37:21 2013
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Wed, 24 Jul 2013 08:37:21 -0400
Subject: [R-sig-Geo] Problem with spTransform() function
Message-ID: <51EFCA81.7060109@yahoo.com.br>

Dear Members,

     I have a problem with spTransform() function, when I try to use a 
object in UTM Zone 23K south and project in latlong south. First, I have 
a polygon SP object in UTM ( CRS("+proj=utm +zone=23+south +datum=WGS84 
+units=m +no_defs"))

     > bbox(SP)
         min       max
x  772259.1  775259.1
y 7840046.0 7843046.0

   But if a using spTransform() for latlong (CRS("+proj=longlat +south 
+datum=WGS84")):

 > bbox(SPlatlong)
         min       max
x -37.67016 -37.58043
y  70.51439  70.54432

  There are something wrong, because the min values are x -37.67016 and 
y 70.51439, but I suppose to be x -42.4058069902 and y -19.5157348241. 
What's the conversion problem?

My example:


require(sp)
require(rgdal)

# Create one point in UTM
xcc<-773759.1
ycc<-7841546
p.central<-cbind(xcc,ycc) ##Centroid

###Countour area
coordV<-NULL
coordV 
<-rbind(coordV,cbind(p.central[,1]+c(-1500,1500,1500,-1500,-1500),p.central[,2]+c(1500,1500,-1500,-1500,1500)))
plot(coordV[,1],coordV[,2])
points(p.central[,1],p.central[,2], col="red")
#

# Creat a polygon
bnds <- cbind(x=c(coordV[,1]), y=c(coordV[,2]))

# Convert in spatial polygon and project in UTM Zone 23K
SP <- SpatialPolygons(list(Polygons(list(Polygon(bnds)), "1")))
proj4string(SP) = CRS("+proj=utm +zone=23+south +datum=WGS84 +units=m 
+no_defs") ## Proje??o

# Reproject the same area in latlong south
SPlatlong<- spTransform(SP, CRS("+proj=longlat +south +datum=WGS84"))
#

Thanks,

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 8132-8112 (TIM)   (+55) 65 9686-6970 (VIVO)

         alexandre.santos at cas.ifmt.edu.br
Lattes: http://lattes.cnpq.br/1360403201088680


From edzer.pebesma at uni-muenster.de  Wed Jul 24 15:09:43 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 24 Jul 2013 15:09:43 +0200
Subject: [R-sig-Geo] Problem with spTransform() function
In-Reply-To: <51EFCA81.7060109@yahoo.com.br>
References: <51EFCA81.7060109@yahoo.com.br>
Message-ID: <51EFD217.8040300@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



On 07/24/2013 02:37 PM, ASANTOS wrote:
> 
> proj4string(SP) = CRS("+proj=utm +zone=23+south +datum=WGS84
> +units=m +no_defs") ## Proje

maybe try:

proj4string(SP) = CRS("+proj=utm +zone=23 +south +datum=WGS84 +units=m
+no_defs")

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR79IXAAoJEM1OCHCtOnfxwzUH/3aYBKe5OYK64WsdmRk9HFK8
yQtnzlunACiEaShrCPbLf0roHQmo3hs6xMbWiPiYs0Lw79FzeZ/gBY4iKHZtmzMN
z9A8JQ6q2cZqbiBazW6OLo68QnSgWoAF1cuatsqMMjklCfp3uONequVYAdBtrKOh
ya1mLutn2v86+OaNPkb2K0immIQtDZ/GzE6cq6adROnjD1byAHXI9p1MZx6ix7nM
AdY6qjRwBPndmofwUtyHeNSzR1YwhrzHUqRJqbUrdYK0Mba7gDVbNFqytQUj6fso
DkNu4c/hBD9Mjuox8h0Z4/6AinJ/NCnI5QUx2XnAgwP4js0uwjYvNyNrtJN5eC0=
=Mo9W
-----END PGP SIGNATURE-----


From amybethhenry at gmail.com  Wed Jul 24 16:19:24 2013
From: amybethhenry at gmail.com (Amy Henry)
Date: Wed, 24 Jul 2013 07:19:24 -0700
Subject: [R-sig-Geo] R help
Message-ID: <CADYQ-MKQQSpObkqgDR5snW7dAGpkhNfJb3JFqiZPqzbSiXUFWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130724/fea135c7/attachment.pl>

From vitale232 at gmail.com  Thu Jul 25 01:02:33 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Wed, 24 Jul 2013 16:02:33 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
Message-ID: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130724/0fe08e39/attachment.pl>

From r.hijmans at gmail.com  Thu Jul 25 03:00:57 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 24 Jul 2013 18:00:57 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
In-Reply-To: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
References: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
Message-ID: <CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>

Andrew,
I think you can use the stackSelect function for this to shortcut the problem:

# your data
library(raster)
SOST <- raster()
SOST[] <- 1:5
r1 <- r2 <- r3 <- r4 <- r5 <- raster()
r1[] <- 10
r2[] <- 20
r3[] <- 30
r4[] <- 40
r5[] <- 50
GDD <- stack(r1,r2,r3,r4,r5)
#

x <- stackSelect(GDD, SOST)

set.seed(232)
samp <- sampleRandom(SOST, 5, xy = TRUE, na.rm = TRUE)[, -3]
extract(x, samp)

Best, Robert

On Wed, Jul 24, 2013 at 4:02 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
> Hello,
>
> We have a raster which represents the ordinal date corresponding to the
> start of growing season.  That is, each pixel value in the raster lies
> between 1:365, representing the ordinal date.
>
> I have also calculated cumulative growing degree days for all 365 days in
> the corresponding year.  These data are loaded into R as a raster stack
> with 365 layers.
>
> My goal is to randomly sample geographic locations on the start of growing
> season layer.  I then hope to extract the value of cumulative growing
> degree days from those same coordinates, but only from the growing degree
> days stack's layer which corresponds to the start of season pixel value.
>
> For example, if the start of season at a given pixel was the 100th day of
> the year, I would like to extract the growing degree days from that
> location on the 100th day of the year (nlayers = 100).
>
> I have been attempting to write a function to accomplish this, but I can't
> seem to get it to work right.  I would like to end up with a data frame or
> matrix showing my x location, y location, start of season day, and GDD for
> that day.  Instead of many GDD values in one column, I get many columns of
> one GDD value.
>
> It seems the problem is in my use of extract.  I've experimented with the
> arguments nl, layer, and indexing the x argument with [[]].  They seem to
> produce the same result.  Here's a simplified code with only 5 days to
> consider, and the function I am trying to construct.
>
> Any help/suggestions is appreciated!
> Andrew
>
> #============================================================
> library(raster)
>
> SOST <- raster()
> SOST[] <- 1:5
>
> r1 <- r2 <- r3 <- r4 <- r5 <- raster()
> r1[] <- 10
> r2[] <- 20
> r3[] <- 30
> r4[] <- 40
> r5[] <- 50
> GDD <- stack(r1,r2,r3,r4,r5)
>
> getGDD <- function(sost, gdd, n){set.seed(232)
>             samp <- sampleRandom(sost, n, xy = TRUE,
>             na.rm = TRUE)
>
>             df <- data.frame('x'=as.numeric(), 'y'=
>             as.numeric(), 'SOST'=as.numeric(),
>             'GDD'=as.numeric())
>
>
>             df.temp <- data.frame('x' = samp[1:n,1], 'y' =
>             samp[1:n,2], 'SOST' = samp[,3],'GDD' =
>             extract(gdd, samp[1:n,1:2], nl = samp[1:n,3]))
>
>             df <- rbind(df, df.temp)
>             return(df)
>                                         }
>
> getGDD(sost = SOST, gdd = GDD, n = 5)
>
>
>
> --
> *Andrew P. Vitale*
> Masters Student
> Department of Geography
> University of Nevada, Reno
> (412) 915-3632
> vitale232 at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tarabridwell at gmail.com  Thu Jul 25 03:20:07 2013
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Wed, 24 Jul 2013 18:20:07 -0700
Subject: [R-sig-Geo] 'move' package
Message-ID: <CAELQJc3xStCCP+GJgku1zv5myB=1WjjbvXyy+_xNbK4WbwZnuw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130724/790848ad/attachment.pl>

From kridox at ymail.com  Thu Jul 25 03:56:02 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Thu, 25 Jul 2013 10:56:02 +0900
Subject: [R-sig-Geo] 'move' package
In-Reply-To: <CAELQJc3xStCCP+GJgku1zv5myB=1WjjbvXyy+_xNbK4WbwZnuw@mail.gmail.com>
References: <CAELQJc3xStCCP+GJgku1zv5myB=1WjjbvXyy+_xNbK4WbwZnuw@mail.gmail.com>
Message-ID: <CAAcyNCyGSTxEQkp0UGfgUn3=VWm2WYPviRn_xsC9DSpjJYBmqg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/788725be/attachment.pl>

From Han_Li at baylor.edu  Thu Jul 25 05:29:25 2013
From: Han_Li at baylor.edu (Li, Han)
Date: Thu, 25 Jul 2013 03:29:25 +0000
Subject: [R-sig-Geo] CAR model related negative interaction variable and
	threshold
Message-ID: <0F7B6F86D2AFD049B10949D376D8C64A152F3193@HARRY.baylor.edu>

Dear list,

I am experiencing some difficulty with a negative interaction variable in my CAR models. Any insight will be highly appreciated. My CAR model result from R is:

Call: spautolm(formula = group ~ intersect * popu_dense, data = tabr, listw = tabr_neighbor_k1_max_wb, family = "CAR")

Residuals:
Min          1Q          Median   3Q         Max
-1.02934 -0.25278 -0.05858 0.29985 0.93158

Coefficients:
                                  Estimate      Std. Error       z value    Pr(>|z|)
(Intercept)                  5.9235e-02  3.7017e-02    1.6002    0.109552
intersect                     7.7819e-02  1.4418e-02    5.3974    6.762e-08
popu_dense                4.8762e-05  1.5287e-05    3.1898    0.001424
intersect:popu_dense -1.0898e-05  3.7201e-06   -2.9295    0.003395

Lambda: 0.025376 LR test value: 57.924 p-value: 2.72e-14

Log likelihood: -261.4561
ML residual variance (sigma squared): 0.15865, (sigma: 0.39831)
Number of observations: 516
Number of parameters estimated: 6
AIC: 534.91

In this model, the independent variable was the presence/absence of a bat species in urban environment (group:0/1). Two continuous explanatory variables were street intersection density (intersect, # of street intersections per area, range 0-10) and human population density (# of people per area, range 100-15000). I modeled these two variables as well as the interaction between them. From the result, both variables were significant positive variables. But the interaction term is significantly negative. Basically, when the population density increases, the positive effect of intersection density will decrease (or vice versa). As far as I understand, there should be a threshold for each variable. After passing the threshold, the positive effect of a variable would turn into a negative effect due to the interaction with the other variable.

My biggest question is (assuming my knowledge by far is correct) how to find out this threshold.
If this is a linear model, like z=a+b*x+c*y+m*x*y, I can calculate the thresholds for x as -m/c. The threshold for y is -m/b.
Can I apply these calculations to the coefficients in CAR model?

Another idea I had was to calculate the prediction value from CAR model and plot the prediction in a 3-D graph. So the threshold can be seen. But I read that it is not possible to get the prediction values from CAR model.

If anyone can suggest a way to either calculate the threshold or visually present the threshold in the prediction or just provide any thoughts/comments, thank you in advance.

Han

Han Li
Department of Biology
Baylor University
Waco, TX  76798-7388
Phone: (254) 710-2151
Fax: (254) 710-2969
han_li at baylor.edu<mailto:han_li at baylor.edu>


From Roger.Bivand at nhh.no  Thu Jul 25 07:36:08 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 25 Jul 2013 07:36:08 +0200
Subject: [R-sig-Geo] CAR model related negative interaction variable and
 threshold
In-Reply-To: <0F7B6F86D2AFD049B10949D376D8C64A152F3193@HARRY.baylor.edu>
References: <0F7B6F86D2AFD049B10949D376D8C64A152F3193@HARRY.baylor.edu>
Message-ID: <alpine.LRH.2.03.1307250724020.8810@reclus.nhh.no>

On Thu, 25 Jul 2013, Li, Han wrote:

> Dear list,
>
> I am experiencing some difficulty with a negative interaction variable 
> in my CAR models. Any insight will be highly appreciated. My CAR model 
> result from R is:
>
> Call: spautolm(formula = group ~ intersect * popu_dense, data = tabr, 
> listw = tabr_neighbor_k1_max_wb, family = "CAR")
>
> Residuals:
> Min          1Q          Median   3Q         Max
> -1.02934 -0.25278 -0.05858 0.29985 0.93158
>
> Coefficients:
>                                  Estimate      Std. Error       z value    Pr(>|z|)
> (Intercept)                  5.9235e-02  3.7017e-02    1.6002    0.109552
> intersect                     7.7819e-02  1.4418e-02    5.3974    6.762e-08
> popu_dense                4.8762e-05  1.5287e-05    3.1898    0.001424
> intersect:popu_dense -1.0898e-05  3.7201e-06   -2.9295    0.003395
>
> Lambda: 0.025376 LR test value: 57.924 p-value: 2.72e-14
>
> Log likelihood: -261.4561
> ML residual variance (sigma squared): 0.15865, (sigma: 0.39831)
> Number of observations: 516
> Number of parameters estimated: 6
> AIC: 534.91
>
> In this model, the independent variable was the presence/absence of a 
> bat species in urban environment (group:0/1). Two continuous explanatory

The CAR model fitted by spautolm is only for Gaussian response variables, 
but your response is discrete taking only two values. Consider using the 
CARBayes (provides CAR implementations for binomial response) or 
spatialprobit (SAR model, semprobit()) packages to fit this model, or a 
GLMM estimator using a continuous space approach to spatial dependence. 
You may also be able to use inla() in the INLA package, from 
www.r-inla.org.

Hope this clarifies,

Roger

> variables were street intersection density (intersect, # of street 
> intersections per area, range 0-10) and human population density (# of 
> people per area, range 100-15000). I modeled these two variables as well 
> as the interaction between them. From the result, both variables were 
> significant positive variables. But the interaction term is 
> significantly negative. Basically, when the population density 
> increases, the positive effect of intersection density will decrease (or 
> vice versa). As far as I understand, there should be a threshold for 
> each variable. After passing the threshold, the positive effect of a 
> variable would turn into a negative effect due to the interaction with 
> the other variable.
>
> My biggest question is (assuming my knowledge by far is correct) how to find out this threshold.
> If this is a linear model, like z=a+b*x+c*y+m*x*y, I can calculate the thresholds for x as -m/c. The threshold for y is -m/b.
> Can I apply these calculations to the coefficients in CAR model?
>
> Another idea I had was to calculate the prediction value from CAR model and plot the prediction in a 3-D graph. So the threshold can be seen. But I read that it is not possible to get the prediction values from CAR model.
>
> If anyone can suggest a way to either calculate the threshold or visually present the threshold in the prediction or just provide any thoughts/comments, thank you in advance.
>
> Han
>
> Han Li
> Department of Biology
> Baylor University
> Waco, TX  76798-7388
> Phone: (254) 710-2151
> Fax: (254) 710-2969
> han_li at baylor.edu<mailto:han_li at baylor.edu>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kranstauber at orn.mpg.de  Thu Jul 25 09:11:43 2013
From: kranstauber at orn.mpg.de (Kranstauber, Bart)
Date: Thu, 25 Jul 2013 07:11:43 +0000
Subject: [R-sig-Geo] 'move' package
References: <CAELQJc3xStCCP+GJgku1zv5myB=1WjjbvXyy+_xNbK4WbwZnuw@mail.gmail.com>
	<CAAcyNCyGSTxEQkp0UGfgUn3=VWm2WYPviRn_xsC9DSpjJYBmqg@mail.gmail.com>
Message-ID: <750B41C00D0B014687F06775A91F6E8655957EA3@UM-EXCDAG-A01.um.gwdg.de>

Hi

The package was updating yesturday maybe that caused an error with
install packages. It is indeed specified not to work with old verisions
of R see the dependencies on cran. But is should install without any
problems, if not what is your operating system and what error messages
do you get?

Bart

On 07/25/2013 03:57 AM, Pascal Oettli wrote:
> Hello,
>
> You don't provide details about your OS. "raster", of course, works for R
> 3.0
>
> Regards,
> Pascal
>
>
> 2013/7/25 Tara Bridwell <tarabridwell at gmail.com>
>
>> Hello,
>> I was wondering if anyone has any experience with the 'move' package, found
>> here: http://www.computational-ecology.com/main-move.html
>>
>> It says it is available on CRAN but install.packages does not work.  When I
>> have manually installed the binary, I found that it would not work with my
>> old version of R (2.12). I switched over to 3.0, but the raster package is
>> a dependency and doesn't work with 3.0, so move would not install.
>>
>> Just curious if anyone had successfully used this package before I install
>> a third version of R to see if I can get it working.
>>
>> Thank you,
>> Tara
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From allar.haav at gmail.com  Thu Jul 25 12:12:06 2013
From: allar.haav at gmail.com (Allar Haav)
Date: Thu, 25 Jul 2013 11:12:06 +0100
Subject: [R-sig-Geo] Using pixel image as spatstat's intensity surface
In-Reply-To: <51F05F8D.2030408@auckland.ac.nz>
References: <mailman.17.1374573604.5847.r-sig-geo@r-project.org>
	<1CEF56CFF7118748AE0FA6C0186D3A31286C07F9@IS-WIN-172.staffad.uwa.edu.au>
	<51EF929D.3070203@gmail.com> <51F05F8D.2030408@auckland.ac.nz>
Message-ID: <51F0F9F6.3060407@gmail.com>

Ah, apparently this book is also in available from the library here. 
Will look it up, thank you for the suggestion!

Best,
Allar


On 25/07/2013 00:13, Rolf Turner wrote:
> Yes indeed, Illian et al. would be a very good start.  You might also 
> want to have a look at
> Peter Diggle's book "Statistical Analysis of Spatial Point Patterns" 
> (2nd ed., 2003, published
> by Arnold).
>
>     cheers,
>
>         Rolf


From nicolas.bories at orange.fr  Thu Jul 25 17:09:20 2013
From: nicolas.bories at orange.fr (Nicolas Bories)
Date: Thu, 25 Jul 2013 17:09:20 +0200
Subject: [R-sig-Geo] How to compute an average year on time series ?
In-Reply-To: <51CC1522.5030302@uni-muenster.de>
References: <51CBFE31.2070004@orange.fr> <51CC1522.5030302@uni-muenster.de>
Message-ID: <51F13FA0.2090602@orange.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/374fae84/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Jul 25 19:37:14 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 25 Jul 2013 19:37:14 +0200
Subject: [R-sig-Geo] How to compute an average year on time series ?
In-Reply-To: <51F13FA0.2090602@orange.fr>
References: <51CBFE31.2070004@orange.fr> <51CC1522.5030302@uni-muenster.de>
	<51F13FA0.2090602@orange.fr>
Message-ID: <51F1624A.4020905@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

spacetime does not provide this, but zoo does; see the last example in
?aggregate.zoo. I'd try something along these lines:

pix = obj at sp
obj = as.zoo(obj)
obj = aggregate(obj, format(time(obj), "%m"), mean,na.rm=TRUE)
sp = SpatialPixelsDataFrame(pix, data.frame(t(obj)))

you may need to give the data.frame() meaningful names before passing
them into the SpatialPixelsDataFrame.

On 07/25/2013 05:09 PM, Nicolas Bories wrote:
> Edzer, Thanks for helping me and sorry for my late answer. I think
> didn't express myself very well. Actually, I would like, for each
> pixel, to have a mean year (23 values). So each value will be an
> average of the EVI at the same date for the 10 years.
> 
> Regards,
> 
> Nicolas.
> 
> On 27/06/2013 12:34, Edzer Pebesma wrote:
>> Given your data are in obj, did you try
>> 
>> mean.yrs = aggregate(obj, "year", mean)
>> 
>> ?
>> 
>> On 06/27/2013 10:56 AM, Nicolas Bories wrote:
>>> Dear all,
>>> 
>>> I'm working on EVI-MODIS time series with the R package
>>> spacetime. I have 10 years of data. I want to compute an
>>> average year for each pixel. How can I do this ? The goal is to
>>> compare for each pixel and for specific years the EVI-MODIS
>>> variations and average year variations. I saw the method
>>> aggregate(x, by, FUN = mean, ..., simplify = TRUE) but I didn't
>>> manage to get an average year.
>>> 
>>> Thanks in advance for any suggestions !
>>> 
>>> Nicolas.
>>> 
>>> 
>>> [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________ R-sig-Geo
>>> mailing list R-sig-Geo at r-project.org 
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
> 
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR8WJKAAoJEM1OCHCtOnfxVcEH/ApXIKfhPviSO3do3LwmWEd4
qZlLD+zJt92QsEb8fD8uKDNyvdiWTrcHLCDJRA9zx6xS0CUQMYVPZ5RNffcBpv3G
DvmwXhEMkNEfjjF1wj9Ft+SXFQDzgDbm6fNfNO6J4TI+kjPSrfk3nV8LnnZZxsMh
Ws0JFZ2UFsQ8vqIB3M0M6OsFxGXAvLwys0nvrcOJ0BscQOWU7eHp4Qjgbren3/5F
faEBAwuYvkie9iTblZv01XrVbEmPTyxkbi1xATtFcoYqdCsfnLkHFEjs8NWvjzMn
ZV88CA9z04JkvnVWHMS5M4utxE8HAvINlcdeOzC2Lo5XoxFJraJZ/WkqNkN+EtQ=
=jJfR
-----END PGP SIGNATURE-----


From amybethhenry at gmail.com  Thu Jul 25 19:46:14 2013
From: amybethhenry at gmail.com (Amy Henry)
Date: Thu, 25 Jul 2013 10:46:14 -0700
Subject: [R-sig-Geo] Me{spdep} error and results interpretation
Message-ID: <10170604-C639-4C3B-80A8-C09FC407D33B@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/45e593ea/attachment.pl>

From Roger.Bivand at nhh.no  Thu Jul 25 22:00:48 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 25 Jul 2013 22:00:48 +0200
Subject: [R-sig-Geo] Me{spdep} error and results interpretation
In-Reply-To: <10170604-C639-4C3B-80A8-C09FC407D33B@gmail.com>
References: <10170604-C639-4C3B-80A8-C09FC407D33B@gmail.com>
Message-ID: <alpine.LRH.2.03.1307252157380.10695@reclus.nhh.no>

Please do not post in HTML, and do follow the posting guide by providing a 
reproducible example from a standard data set. There is nothing anyone can 
do when the most likely cause of your problems is your own data and choice 
of methods.

On Thu, 25 Jul 2013, Amy Henry wrote:

> Hi,
>
> I fitted my spatial data (count data and environmental variables) to a 
> glm.nb model. I decided to detect and correct for spatial 
> autocorrelation using ME{spdep}. I used family poisson since with 
> negative binomial the model did not converge. I received this warning 
> after I added the eigenvectors into the model. Can you help me 
> understand what the error means? Also, should I infer from the example 
> below that spatial autocorrelation is negligible since the pr(ZI) values 
> are so high?
>
>
>
>> tu1<-glm.nb(total.aeg~Total.number.of.units, data=inhdb, offset(x))
>
>> tuME<-ME(total.aeg~Total.number.of.units, data=inhdb, family="poisson", 
>> offset(x), listw=sw.nb, alpha=0.5)
>
>> tuME
>
>   Eigenvector ZI pr(ZI)
>
> 0           NA NA   0.40
>
> 1           43 NA   0.39
>
> 2           19 NA   0.39
>
> 3           18 NA   0.36
>
> 4           34 NA   0.35
>
> 5           23 NA   0.41
>
> 6           25 NA   0.39
>
> 7           56 NA   0.36
>
> 8           51 NA   0.47
>
> 9           46 NA   0.41
>
> 10          36 NA   0.32
>
> etc.....
>
>> inhdb$eigen_43<-fitted(tuME)[,1]
>
>> inhdb$eigen_19<-fitted(tuME)[,2]
>
>> tuglmME<-glm.nb(total.aeg~Total.number.of.units+fitted(tuME), data=inhdb, offset(x))
>
> There were 27 warnings (use warnings() to see them)
>
> Warning messages:
>
> 1: In theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace = control$trace >  ... :
>
>  iteration limit reached
>
>
>
> Thank you for your help!
>
> Best,
>
> Amy
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From vitale232 at gmail.com  Thu Jul 25 23:00:23 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Thu, 25 Jul 2013 14:00:23 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
In-Reply-To: <CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>
References: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
	<CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>
Message-ID: <CAFTcopcY=Yh6ztPRs1PS3sScHHYdXMXUAR=kWGTzuo+CtryppA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/e2f7913b/attachment.pl>

From tarabridwell at gmail.com  Fri Jul 26 01:52:11 2013
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Thu, 25 Jul 2013 16:52:11 -0700
Subject: [R-sig-Geo] 'move' package
In-Reply-To: <750B41C00D0B014687F06775A91F6E8655957EA3@UM-EXCDAG-A01.um.gwdg.de>
References: <CAELQJc3xStCCP+GJgku1zv5myB=1WjjbvXyy+_xNbK4WbwZnuw@mail.gmail.com>
	<CAAcyNCyGSTxEQkp0UGfgUn3=VWm2WYPviRn_xsC9DSpjJYBmqg@mail.gmail.com>
	<750B41C00D0B014687F06775A91F6E8655957EA3@UM-EXCDAG-A01.um.gwdg.de>
Message-ID: <CAELQJc1_h2dFZHos4xT4APRpZJddy8w2r-bPHiZjKREFNUFf4A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/6ecdbf23/attachment.pl>

From thi_veloso at yahoo.com.br  Fri Jul 26 05:47:29 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Thu, 25 Jul 2013 20:47:29 -0700 (PDT)
Subject: [R-sig-Geo] Make raster from oddly organized ASCII
In-Reply-To: <1355948406.9467.YahooMailNeo@web121905.mail.ne1.yahoo.com>
References: <1355948406.9467.YahooMailNeo@web121905.mail.ne1.yahoo.com>
Message-ID: <1374810449.20618.YahooMailNeo@web121906.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130725/cbdc18de/attachment.pl>

From fabriciovasselai at gmail.com  Fri Jul 26 07:10:42 2013
From: fabriciovasselai at gmail.com (Fabricio Vasselai)
Date: Fri, 26 Jul 2013 01:10:42 -0400
Subject: [R-sig-Geo] Comparing spatial patterns: cases vs population
In-Reply-To: <CA+nXtYaOA4L=+zqAiP=dBrktYkQkU8nQOUzq1WUqqM=0q6FxWA@mail.gmail.com>
References: <CA+nXtYaOA4L=+zqAiP=dBrktYkQkU8nQOUzq1WUqqM=0q6FxWA@mail.gmail.com>
Message-ID: <CAEkXS9Kmk1z79KMbB2O=57YbytrfqWVHVqTHZZoWG+iGVJRfCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130726/1a7442eb/attachment.pl>

From heikz at gmx.de  Fri Jul 26 14:47:00 2013
From: heikz at gmx.de (Heike Zimmermann)
Date: Fri, 26 Jul 2013 14:47:00 +0200
Subject: [R-sig-Geo] Mac Os X graphic layer (Quartz) fails to display large
	SpatialPolyonsDataFrame
Message-ID: <391C321E-7CB2-4E18-9A02-DEED489C3632@gmx.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130726/98784740/attachment.pl>

From pmassicotte at hotmail.com  Fri Jul 26 15:46:57 2013
From: pmassicotte at hotmail.com (philippe massicotte)
Date: Fri, 26 Jul 2013 13:46:57 +0000
Subject: [R-sig-Geo] Get projection from shapefile
Message-ID: <COL127-W632A67C8C0F7562A8F1BEB36A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130726/0ac2b552/attachment.pl>

From francois.morneau at onf.fr  Fri Jul 26 16:30:30 2013
From: francois.morneau at onf.fr (=?ISO-8859-1?Q?Fran=E7ois_Morneau?=)
Date: Fri, 26 Jul 2013 16:30:30 +0200
Subject: [R-sig-Geo] Get projection from shapefile
In-Reply-To: <COL127-W632A67C8C0F7562A8F1BEB36A0@phx.gbl>
References: <COL127-W632A67C8C0F7562A8F1BEB36A0@phx.gbl>
Message-ID: <51F28806.9050508@onf.fr>

Hello Philippe,

You should have a look a the readOGR function in the package rgdal.

Fran?ois
Le 26/07/2013 15:46, philippe massicotte a ?crit :
> Hi everyone.
> I'm using maptools (readShapePoints) to read some shapefiles. However, when I try proj4string(myshp) it returns me NA. I opened the shapefile in QGIS and ArcGIS to ensure there was a projection associated to the file.
> I was wondering if there was a way to retrieve the projection of a shapefile?
> Thank in advance,Phil 		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From vitale232 at gmail.com  Fri Jul 26 23:40:04 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 26 Jul 2013 14:40:04 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
In-Reply-To: <CAFTcopcY=Yh6ztPRs1PS3sScHHYdXMXUAR=kWGTzuo+CtryppA@mail.gmail.com>
References: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
	<CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>
	<CAFTcopcY=Yh6ztPRs1PS3sScHHYdXMXUAR=kWGTzuo+CtryppA@mail.gmail.com>
Message-ID: <CAFTcope83dMvAODKxOKB5o8v9K_mv=ADWXx9ZRUDP5BCG6Kudg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130726/e04552e7/attachment.pl>

From r.hijmans at gmail.com  Sat Jul 27 02:38:15 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 26 Jul 2013 17:38:15 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
In-Reply-To: <CAFTcope83dMvAODKxOKB5o8v9K_mv=ADWXx9ZRUDP5BCG6Kudg@mail.gmail.com>
References: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
	<CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>
	<CAFTcopcY=Yh6ztPRs1PS3sScHHYdXMXUAR=kWGTzuo+CtryppA@mail.gmail.com>
	<CAFTcope83dMvAODKxOKB5o8v9K_mv=ADWXx9ZRUDP5BCG6Kudg@mail.gmail.com>
Message-ID: <CANtt_hxu0FwUu+LmpnnN9vNnbWhmNr6CkhxCTuKXgdWaZ3Nb=g@mail.gmail.com>

Andrew,

To avoid looping you could do:

names(SOST) <- 'SOST'
set.seed(232)
n = 5
samp <- sampleRandom(SOST, size = n, xy = TRUE)
e <- extract(GDD, samp[,1:2])[cbind(1:nrow(samp),samp[,3])]
out <- data.frame(samp, 'GDD' = e)
out

Robert


On Fri, Jul 26, 2013 at 2:40 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
> After a little more effort, I was able to get my function to run.  I'd still
> be interested in a simpler solution, but here's what I came up with.
>
> Thanks again, Robert.
>
> What works:
>
>
> library(raster)
> #SOST and GDD simulations with same ncell and extents as actual data:
>
> SOST <- raster(nrow = 3991, ncol = 3025, xmn = 688635, xmx = 779385,
> ymn = 4276125, ymx = 4395855, crs = "+proj=utm +zone=11 +datum=WGS84
> +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0")
> SOST[] <- 1:5
>
> r1 <- r2 <- r3 <- r4 <- r5 <- raster(nrow = 3951, ncol = 2995, xmn =
> 688620.2, xmx = 779377.8, ymn = 4276121, ymx = 4395848, crs = "+proj=utm
> +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0")
> r1[] <- 10
> r2[] <- 20
> r3[] <- 30
> r4[] <- 40
> r5[] <- 50
> GDD <- stack(r1,r2,r3,r4,r5)
>
> getGDD <- function(sost, gdd, n){
>           set.seed(232)
>           samp <- sampleRandom(sost, size = n, xy = TRUE)
>
>           extr <- NULL
>           for(i in 1:n){
>           extr[i] <- extract(gdd[[samp[i,3]]], cbind(as.matrix(samp[i,1]),
>                      as.matrix(samp[i,2])))
>           }
>
>           out <- data.frame(x = samp[,1], y = samp[,2], 'SOST' = samp[,3],
> 'GDD' = extr)
>           return(out)
>           }
>
> test <- getGDD(sost = SOST, gdd = GDD, n = 5)
> test
>
>
>
> On Thu, Jul 25, 2013 at 2:00 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
>>
>> Robert and list,
>>
>> Thanks for such a quick, simple solution.
>>
>> I should have included one more detail in the original post.  The GDD and
>> SOST objects with my actual data do not have the same extents or number of
>> cells.  My GDD data are derived from reprojecting and diaggregating a 1000m
>> resolution raster to as close to 30 as possible.  I then crop the GDD stack
>> to the SOST extent, and end up with pretty different extents and cell
>> counts.
>>
>>
>> Hence, I'm unable to use the stackSelect() solution without more
>> (forceful) data manipulation.  Do you have another suggestion?
>>
>> Here's my example again, but with extents and cell numbers representing my
>> actual data.  Sorry these important details did not come out in my original
>> post.
>>
>>
>> #============================================================================
>> library(raster)
>> #SOST and GDD simulations with same ncell and extents as actual data:
>>
>> SOST <- raster(nrow = 3991, ncol = 3025, xmn = 688635, xmx = 779385,
>> ymn = 4276125, ymx = 4395855, crs = "+proj=utm +zone=11 +datum=WGS84
>> +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0")
>> SOST[] <- 1:5
>>
>> r1 <- r2 <- r3 <- r4 <- r5 <- raster(nrow = 3951, ncol = 2995, xmn =
>> 688620.2, xmx = 779377.8, ymn = 4276121, ymx = 4395848, crs = "+proj=utm
>> +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0")
>> r1[] <- 10
>> r2[] <- 20
>> r3[] <- 30
>> r4[] <- 40
>> r5[] <- 50
>> GDD <- stack(r1,r2,r3,r4,r5)
>>
>>
>> #As I'm sure you've guessed, your solution doesn't work with my original
>> data due to differing extents.
>> x <- stackSelect(GDD, SOST)
>>
>> set.seed(232)
>> samp <- sampleRandom(SOST, 5, xy = TRUE, na.rm = TRUE)[, -3]
>> extract(x, samp)
>>
>>
>> On Wed, Jul 24, 2013 at 6:00 PM, Robert J. Hijmans <r.hijmans at gmail.com>
>> wrote:
>>>
>>> Andrew,
>>> I think you can use the stackSelect function for this to shortcut the
>>> problem:
>>>
>>> # your data
>>> library(raster)
>>> SOST <- raster()
>>> SOST[] <- 1:5
>>> r1 <- r2 <- r3 <- r4 <- r5 <- raster()
>>> r1[] <- 10
>>> r2[] <- 20
>>> r3[] <- 30
>>> r4[] <- 40
>>> r5[] <- 50
>>> GDD <- stack(r1,r2,r3,r4,r5)
>>> #
>>>
>>> x <- stackSelect(GDD, SOST)
>>>
>>> set.seed(232)
>>> samp <- sampleRandom(SOST, 5, xy = TRUE, na.rm = TRUE)[, -3]
>>> extract(x, samp)
>>>
>>> Best, Robert
>>>
>>> On Wed, Jul 24, 2013 at 4:02 PM, Andrew Vitale <vitale232 at gmail.com>
>>> wrote:
>>> > Hello,
>>> >
>>> > We have a raster which represents the ordinal date corresponding to the
>>> > start of growing season.  That is, each pixel value in the raster lies
>>> > between 1:365, representing the ordinal date.
>>> >
>>> > I have also calculated cumulative growing degree days for all 365 days
>>> > in
>>> > the corresponding year.  These data are loaded into R as a raster stack
>>> > with 365 layers.
>>> >
>>> > My goal is to randomly sample geographic locations on the start of
>>> > growing
>>> > season layer.  I then hope to extract the value of cumulative growing
>>> > degree days from those same coordinates, but only from the growing
>>> > degree
>>> > days stack's layer which corresponds to the start of season pixel
>>> > value.
>>> >
>>> > For example, if the start of season at a given pixel was the 100th day
>>> > of
>>> > the year, I would like to extract the growing degree days from that
>>> > location on the 100th day of the year (nlayers = 100).
>>> >
>>> > I have been attempting to write a function to accomplish this, but I
>>> > can't
>>> > seem to get it to work right.  I would like to end up with a data frame
>>> > or
>>> > matrix showing my x location, y location, start of season day, and GDD
>>> > for
>>> > that day.  Instead of many GDD values in one column, I get many columns
>>> > of
>>> > one GDD value.
>>> >
>>> > It seems the problem is in my use of extract.  I've experimented with
>>> > the
>>> > arguments nl, layer, and indexing the x argument with [[]].  They seem
>>> > to
>>> > produce the same result.  Here's a simplified code with only 5 days to
>>> > consider, and the function I am trying to construct.
>>> >
>>> > Any help/suggestions is appreciated!
>>> > Andrew
>>> >
>>> > #============================================================
>>> > library(raster)
>>> >
>>> > SOST <- raster()
>>> > SOST[] <- 1:5
>>> >
>>> > r1 <- r2 <- r3 <- r4 <- r5 <- raster()
>>> > r1[] <- 10
>>> > r2[] <- 20
>>> > r3[] <- 30
>>> > r4[] <- 40
>>> > r5[] <- 50
>>> > GDD <- stack(r1,r2,r3,r4,r5)
>>> >
>>> > getGDD <- function(sost, gdd, n){set.seed(232)
>>> >             samp <- sampleRandom(sost, n, xy = TRUE,
>>> >             na.rm = TRUE)
>>> >
>>> >             df <- data.frame('x'=as.numeric(), 'y'=
>>> >             as.numeric(), 'SOST'=as.numeric(),
>>> >             'GDD'=as.numeric())
>>> >
>>> >
>>> >             df.temp <- data.frame('x' = samp[1:n,1], 'y' =
>>> >             samp[1:n,2], 'SOST' = samp[,3],'GDD' =
>>> >             extract(gdd, samp[1:n,1:2], nl = samp[1:n,3]))
>>> >
>>> >             df <- rbind(df, df.temp)
>>> >             return(df)
>>> >                                         }
>>> >
>>> > getGDD(sost = SOST, gdd = GDD, n = 5)
>>> >
>>> >
>>> >
>>> > --
>>> > *Andrew P. Vitale*
>>> > Masters Student
>>> > Department of Geography
>>> > University of Nevada, Reno
>>> > (412) 915-3632
>>> > vitale232 at gmail.com
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>> --
>> Andrew P. Vitale
>> Masters Student
>> Department of Geography
>> University of Nevada, Reno
>> (412) 915-3632
>> vitale232 at gmail.com
>
>
>
>
> --
> Andrew P. Vitale
> Masters Student
> Department of Geography
> University of Nevada, Reno
> (412) 915-3632
> vitale232 at gmail.com


From duncan at mcpherson.org.uk  Sat Jul 27 12:13:07 2013
From: duncan at mcpherson.org.uk (Duncan McPherson)
Date: Sat, 27 Jul 2013 11:13:07 +0100
Subject: [R-sig-Geo] install rgdal to query postgis database
Message-ID: <23B03322-0CB6-4A3C-9688-2BD76B48F50F@mcpherson.org.uk>

I have installed postgres, postgis, gdal 'complete' all from kyngchaos. Then I loaded a map of England, and have been able to do manipulations of that with SQL statements. I can also create maps with QGis by loading Postgis layers within QGis. And, I can use the utilities in terminal, e.g.:

iMac:~ duncan$ ogrinfo -ro "PG:dbname=health_england user=postgres"
INFO: Open of `PG:dbname=health_england user=postgres'
      using driver `PostgreSQL' successful.
?[list of layers]

Further, I have installed R64 and RStudio, the packages DBI and RPostgreSQL and am able to query the non-map parts of the database:

> library(DBI)
> library(RPostgreSQL)
> con=dbConnect(dbDriver('PostgreSQL'), dbname="health_england", user="postgres")
> std<-data.frame(dbGetQuery(con, 'SELECT * FROM case_list LIMIT 10'), row.names=1)

Now the problem:

I need to be able to produce many maps from this database within R, so that I can, for example, use the non-map analyses above to colour the map areas. I want to do this programmatically because of the number of maps (also the reason for not wanting to save out a shapefile of every map), rather than produce each one in QGis. From reading around, including this: http://gis.stackexchange.com/questions/64950/which-is-the-best-way-of-working-with-postgis-data-in-r, that rgdal would be able to handle the database connection and correctly handle the geometry columns, which RPostgreSQL cannot. But I keep getting this:

> dsn="PG:dbname=england_health user=postgres"
> ogrListLayers(dsn)
Error in ogrListLayers(dsn) : Cannot open data source

Information that may be useful if you were to be able to help me might be:

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RPostgreSQL_0.4 DBI_0.2-7       rgdal_0.8-8     sp_1.0-9       

loaded via a namespace (and not attached):
[1] grid_3.0.1      lattice_0.20-15 tools_3.0.1    

> ogrDrivers()
             name write
...
42         PGDump  TRUE
43           PGeo FALSE
44     PostgreSQL  TRUE
...


> library(rgdal)
Loading required package: sp
rgdal: version: 0.8-8, (SVN revision 463)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: /Library/Frameworks/GDAL.framework/Versions/1.10/Resources/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

Many thanks in anticipation,

Duncan


From edzer.pebesma at uni-muenster.de  Sat Jul 27 18:36:42 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 27 Jul 2013 18:36:42 +0200
Subject: [R-sig-Geo] install rgdal to query postgis database
In-Reply-To: <23B03322-0CB6-4A3C-9688-2BD76B48F50F@mcpherson.org.uk>
References: <23B03322-0CB6-4A3C-9688-2BD76B48F50F@mcpherson.org.uk>
Message-ID: <51F3F71A.9050608@uni-muenster.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Duncan, maybe you need to add

host="localhost"

to the arguments. Does user postgres need a password?

If it worked, please share with the list.

On 07/27/2013 12:13 PM, Duncan McPherson wrote:
> I have installed postgres, postgis, gdal 'complete' all from
> kyngchaos. Then I loaded a map of England, and have been able to do
> manipulations of that with SQL statements. I can also create maps
> with QGis by loading Postgis layers within QGis. And, I can use the
> utilities in terminal, e.g.:
> 
> iMac:~ duncan$ ogrinfo -ro "PG:dbname=health_england
> user=postgres" INFO: Open of `PG:dbname=health_england
> user=postgres' using driver `PostgreSQL' successful. ?[list of
> layers]
> 
> Further, I have installed R64 and RStudio, the packages DBI and
> RPostgreSQL and am able to query the non-map parts of the
> database:
> 
>> library(DBI) library(RPostgreSQL) 
>> con=dbConnect(dbDriver('PostgreSQL'), dbname="health_england",
>> user="postgres") std<-data.frame(dbGetQuery(con, 'SELECT * FROM
>> case_list LIMIT 10'), row.names=1)
> 
> Now the problem:
> 
> I need to be able to produce many maps from this database within R,
> so that I can, for example, use the non-map analyses above to
> colour the map areas. I want to do this programmatically because of
> the number of maps (also the reason for not wanting to save out a
> shapefile of every map), rather than produce each one in QGis. From
> reading around, including this:
> http://gis.stackexchange.com/questions/64950/which-is-the-best-way-of-working-with-postgis-data-in-r,
> that rgdal would be able to handle the database connection and
> correctly handle the geometry columns, which RPostgreSQL cannot.
> But I keep getting this:
> 
>> dsn="PG:dbname=england_health user=postgres" ogrListLayers(dsn)
> Error in ogrListLayers(dsn) : Cannot open data source
> 
> Information that may be useful if you were to be able to help me
> might be:
> 
>> sessionInfo()
> R version 3.0.1 (2013-05-16) Platform: x86_64-apple-darwin10.8.0
> (64-bit)
> 
> locale: [1]
> en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages: [1] stats     graphics  grDevices utils
> datasets  methods   base
> 
> other attached packages: [1] RPostgreSQL_0.4 DBI_0.2-7
> rgdal_0.8-8     sp_1.0-9
> 
> loaded via a namespace (and not attached): [1] grid_3.0.1
> lattice_0.20-15 tools_3.0.1
> 
>> ogrDrivers()
> name write ... 42         PGDump  TRUE 43           PGeo FALSE 44
> PostgreSQL  TRUE ...
> 
> 
>> library(rgdal)
> Loading required package: sp rgdal: version: 0.8-8, (SVN revision
> 463) Geospatial Data Abstraction Library extensions to R
> successfully loaded Loaded GDAL runtime: GDAL 1.10.0, released
> 2013/04/24 Path to GDAL shared files:
> /Library/Frameworks/GDAL.framework/Versions/1.10/Resources/gdal 
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480] 
> Path to PROJ.4 shared files: (autodetected)
> 
> Many thanks in anticipation,
> 
> Duncan
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

- -- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJR8/caAAoJEM1OCHCtOnfxsV4IAIBr+718m1zWYG13rEdvkqkM
cJia8/yHaBXTPZsLRfiuU7KvVOgvSFAhqi6AespJv0MXIPeDK2TG/OE1Kod+bMWU
gIUKOBKQzwXkAqI8MYyeQ8l4Wya5R1x68qGrtTWC63o31sE/VgBELGoLO9QLvzpo
wtDdRKWqsspSy7lGmYpEcaFhOx37s17WuIqJfLnhPkove7cgkc7OE1pHMVwqXgpL
0S3MhgRlI6Vlc52kZ3oQkd188f2atZ2ZPq3qvMF3PKPNMzX9yKn8576uCNkUFHgm
dfxZlYgXVws6BT2Qr+M8GJQhxZGa/H4JiekfOQSbK7zUaF2n68p9GOQWdc97d3o=
=mRIx
-----END PGP SIGNATURE-----


From agus.camacho at gmail.com  Sun Jul 28 15:46:14 2013
From: agus.camacho at gmail.com (Agus Camacho)
Date: Sun, 28 Jul 2013 23:16:14 +0930
Subject: [R-sig-Geo] Identify which layers in a raster stack are categorical
Message-ID: <CALsJ7pRLLpaMWBk0iqqZtvQ4wRtPeOWdXG3uxOGmVToCuPHt_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130728/cba9afe5/attachment.pl>

From duncan at mcpherson.org.uk  Sun Jul 28 19:49:09 2013
From: duncan at mcpherson.org.uk (Duncan McPherson)
Date: Sun, 28 Jul 2013 18:49:09 +0100
Subject: [R-sig-Geo] install rgdal to query postgis database
In-Reply-To: <mailman.9.1375005603.6593.r-sig-geo@r-project.org>
References: <mailman.9.1375005603.6593.r-sig-geo@r-project.org>
Message-ID: <77F93972-D685-4FE1-8BA4-54F3EA23F911@mcpherson.org.uk>

Sorry, I forgot to add that I have already tried:

host=localhost
port=5432
password=''

and all combinations with and without these and with single quotes and double quotes. Also, all of QGis, Terminal and PGAdminIII can connect to the database with some combination of the settings that I have already tried.

Duncan


From duncan at mcpherson.org.uk  Mon Jul 29 00:49:19 2013
From: duncan at mcpherson.org.uk (Duncan McPherson)
Date: Sun, 28 Jul 2013 23:49:19 +0100
Subject: [R-sig-Geo] install rgdal to query postgis database
In-Reply-To: <51F565AD.5040300@uni-muenster.de>
References: <mailman.9.1375005603.6593.r-sig-geo@r-project.org>
	<77F93972-D685-4FE1-8BA4-54F3EA23F911@mcpherson.org.uk>
	<51F565AD.5040300@uni-muenster.de>
Message-ID: <3D8827DF-57B9-419D-BA06-FDB33C82DD31@mcpherson.org.uk>

Thanks for your suggestion.

The user postgres has a password already (see below for detail). I tried as you suggested:

> dsn="PG:dbname=england_health user=postgres password=[password]"
> ogrListLayers(dsn)
Error in ogrListLayers(dsn) : Cannot open data source

and all the variations as before. I also created a new postgres user 'duncan', with the same password as my system login password and used this in case there was some conflict between the logged in user and the database role. That didn't help either, although I can make all the other connections as either postgres or duncan (including DBI+RPostgreSQL).

Your suggestion got me to digging around in my postgresql configuration. It turns out that my pg_hba.conf file has

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local	 all		all					trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                trust
#host    replication     postgres        127.0.0.1/32            trust
#host    replication     postgres        ::1/128                 trust

which means, to my reading, that any user should be trusted to connect from localhost (I may have to look into this more, since there are suggestions this isn't secure, but that is another story). So, even if a user has a password set, it shouldn't be checked.

I am curious also as to why DBI/RPostgreSQL can connect and get data from the database freely, but Rgdal cannot? They must be doing something different that I can't figure out?

From samanmonfared1 at gmail.com  Mon Jul 29 00:55:11 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Mon, 29 Jul 2013 02:25:11 +0330
Subject: [R-sig-Geo] Help for optim
Message-ID: <CAOytA4ZDabeLoMOEV1c=Cg0w5WNdDgmt5avskwgyb262fL+SXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130729/53a0f20b/attachment.pl>

From samanmonfared1 at gmail.com  Mon Jul 29 01:03:01 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Mon, 29 Jul 2013 02:33:01 +0330
Subject: [R-sig-Geo] Help for optim
In-Reply-To: <CAOytA4ZDabeLoMOEV1c=Cg0w5WNdDgmt5avskwgyb262fL+SXQ@mail.gmail.com>
References: <CAOytA4ZDabeLoMOEV1c=Cg0w5WNdDgmt5avskwgyb262fL+SXQ@mail.gmail.com>
Message-ID: <CAOytA4b3b6SkLhnt02GX+zccfGv2dvS3_Nyds7M2h=29FyrrZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130729/4bd14d09/attachment.pl>

From bakare at ualberta.ca  Mon Jul 29 02:28:26 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Sun, 28 Jul 2013 18:28:26 -0600
Subject: [R-sig-Geo] Standard error from gstat
Message-ID: <CAJRR3XMFkQthQfq6QkzTZi8vw4HcHEkCoDcQTY0NhNppt8ONQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130728/9f6073e5/attachment.pl>

From ssgorelick at gmail.com  Mon Jul 29 15:40:51 2013
From: ssgorelick at gmail.com (Susan Gorelick)
Date: Mon, 29 Jul 2013 09:40:51 -0400
Subject: [R-sig-Geo] to create a distance matrix (list) to run gstlshet from
	sphet package
Message-ID: <000001ce8c61$3fc9cff0$bf5d6fd0$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130729/7247926d/attachment.pl>

From bakare at ualberta.ca  Mon Jul 29 17:42:19 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 29 Jul 2013 09:42:19 -0600
Subject: [R-sig-Geo] Spatial correlation
Message-ID: <CAJRR3XMRP__D=fyZEkESPifwO9enSyVroUwX+MFBdT3jofGwSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130729/1620d817/attachment.pl>

From paulojus at c3sl.ufpr.br  Mon Jul 29 17:50:33 2013
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Mon, 29 Jul 2013 12:50:33 -0300 (BRT)
Subject: [R-sig-Geo] Help for optim
In-Reply-To: <CAOytA4ZDabeLoMOEV1c=Cg0w5WNdDgmt5avskwgyb262fL+SXQ@mail.gmail.com>
References: <CAOytA4ZDabeLoMOEV1c=Cg0w5WNdDgmt5avskwgyb262fL+SXQ@mail.gmail.com>
Message-ID: <alpine.DEB.2.02.1307291249070.22066@macalan.c3sl.ufpr.br>

from the section Details of
?optim


By default ?optim? performs minimization, but it will maximize if
      ?control$fnscale? is negative.


Alternatively your chance the sigh of what is returned by your function



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Mon, 29 Jul 2013, Saman Monfared wrote:

> Dear all,
> I want to optimize a function using optim. I have two problems:
> 1-how can i minimize function which fn value be positive because it can be
> negative?
> 2- how can i change it to maximization?
> Best,
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From felsmechanik at email.de  Tue Jul 30 09:28:56 2013
From: felsmechanik at email.de (Cristian Osan)
Date: Tue, 30 Jul 2013 09:28:56 +0200 (CEST)
Subject: [R-sig-Geo] Cropping a interpolated map by  a polygon
Message-ID: <trinity-edf8f853-f3d9-417f-980a-039fd329a82c-1375169335901@3capp-webde-bs05>

Hello everybody,
 
i need to create a map showing the temperature distribution in a concrete dam, as measured by sensors installed. I can do a lot of calculation on the data, working just fine. Now i want to show a picture with the interpolated temperature distribution. Up to now, i did follwing:
 
library(raster)      # For raster
library(tgp)            # For interp.
library(fields)        # For image.plot
library(akima)        # For akima
library(sp)            # For spatial representation
#================================================================
##definition of dam contour polygon
x<-c(35.0,46.5,51.5,99.0,152.7,167.2,147.5,147.5,35.0)
y<-c(9.25,    6.70,    6.70,    7.90,    1.50,    5.80,    32.20,    43.10,    43.10)
damcontour<-cbind(x,y)
dc<-owin(poly=damcontour)
#================================================================

# # Definition of irregularly spaced -z- values
#================================================================
#read from table exported from excel
#irregularily spaced temperature sensors
temp15july<- read.delim("temp15july0845.txt", dec=",")
xx<-temp15july$x
yy<-temp15july$y
zz<-temp15july$t1507
#================================================================
# Definition of the bounding box and related variables - taken from other maillist answer
xmin<-0
xmax<-200
ymin<-0
ymax<-200
dxy <- 0.5
nx <- (xmax-xmin)/dxy
ny <- (ymax-ymin)/dxy
xbox <- c(xmin, xmax, xmax, xmin)
ybox <- c(ymin, ymin, ymax, ymax)
#================================================================
coo<-cbind(xx,yy)
prds<-predict.surface(Tps(coo,zz))  #produces the expected results!
hmr<-raster(prds) ##creates raster
image.plot(hmr, nlevel=35)
contour(prds, nlevels=35, add=T)
#================================================================
##overlay dam contour
plot(dc,add=T)
# now crop the image on the dam contour!!
 
I found a method in a mailing list, but i need to transform the coordinates in LatLon or so, it appears to complicated for me. I use a local rectangular coordinate system. Data file is available on request.
 
Any thougths?
 
Thanks a lot in advance
?
--?
Dipl.?Ing.?Cristian?Osan?VDI
Geotechniker
Stuttgart/Germany


From Ravichandra.MONDRETI at cefe.cnrs.fr  Tue Jul 30 11:37:20 2013
From: Ravichandra.MONDRETI at cefe.cnrs.fr (Ravichandra MONDRETI)
Date: Tue, 30 Jul 2013 11:37:20 +0200
Subject: [R-sig-Geo] Splitting the transect in to smaller segments
Message-ID: <7422421DBB284141ACBF3EBFB07B46760148ACF73C24@ZZMAIL.newcefe.newage.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/7230c703/attachment.pl>

From mdsumner at gmail.com  Tue Jul 30 11:46:59 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 30 Jul 2013 19:46:59 +1000
Subject: [R-sig-Geo] Splitting the transect in to smaller segments
In-Reply-To: <7422421DBB284141ACBF3EBFB07B46760148ACF73C24@ZZMAIL.newcefe.newage.fr>
References: <7422421DBB284141ACBF3EBFB07B46760148ACF73C24@ZZMAIL.newcefe.newage.fr>
Message-ID: <CAAcGz9_Q4VMJOnFi1HxC0FBQZPqoq1-5NDPAZ_bknOFiOcHDXA@mail.gmail.com>

Could you put your data together in a reproducible way? It looks like
this might just be the raw contents of a text file?

If you have it in R use dput() to create the code that will regenerate
your object.



On Tue, Jul 30, 2013 at 7:37 PM, Ravichandra MONDRETI
<Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>
> Hello All,
>
> My data are counts of seabirds and marine mammals at a spatial scale of 20 Km i.e I had recorded the position of the ship at the beginning of every 20 Km transect. Now I want to split each 20km transect in to 3km segments to check for spatial autocorrelation among the observations and relate it to the oceanographic features. I had tried with packages sp and rgdal but was not arrive at the r code. Could anyone suggest me how to proceed with this problem?
>
> My data looks like this:
>
>     Latitude
>
>         Longitude
>
> 12,80382
>
> 82,44553
>
> 12,77357
>
> 82,67792
>
> 12,74253
>
> 82,8775
>
> 12,7118
>
> 83,08733
>
> 12,68468
>
> 83,28215
>
> 12,64768
>
> 83,49067
>
> 12,61173
>
> 83,723
>
> 12,58148
>
> 83,92935
>
> 12,553
>
> 84,16293
>
> 12,51517
>
> 84,37533
>
> 12,48025
>
> 84,60193
>
> 12,45202
>
> 84,83365
>
> 12,03108
>
> 87,61216
>
> 11,99813
>
> 87,83575
>
> 11,96863
>
> 88,05197
>
> 11,93698
>
> 88,27583
>
> 11,90938
>
> 88,49937
>
> 11,87682
>
> 88,69888
>
>
> Thanks in advance,
> Ravichandra Mondreti.
>
>
> Ravichandra Mondreti
> PhD student/ Doctorant
> MAHEVA Fellow (ERASMUS MUNDUS programme)
> Spatial Population Ecology Team
> CEFE-CNRS
> 1919, route de Mende
> F-34293 Montpellier Cedex 05
> France
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Ravichandra.MONDRETI at cefe.cnrs.fr  Tue Jul 30 15:13:45 2013
From: Ravichandra.MONDRETI at cefe.cnrs.fr (Ravichandra MONDRETI)
Date: Tue, 30 Jul 2013 15:13:45 +0200
Subject: [R-sig-Geo] TR:  Splitting the transect in to smaller segments
In-Reply-To: <7422421DBB284141ACBF3EBFB07B46760148ACF73C35@ZZMAIL.newcefe.newage.fr>
References: <7422421DBB284141ACBF3EBFB07B46760148ACF73C24@ZZMAIL.newcefe.newage.fr>
	<CAAcGz9_Q4VMJOnFi1HxC0FBQZPqoq1-5NDPAZ_bknOFiOcHDXA@mail.gmail.com>
	<7422421DBB284141ACBF3EBFB07B46760148ACF73C35@ZZMAIL.newcefe.newage.fr>
Message-ID: <7422421DBB284141ACBF3EBFB07B46760148ACF73C36@ZZMAIL.newcefe.newage.fr>


I am sorry for the distortion. Here is the original data which consists of spatial point (Long-Lat) representing the beginning position of each transect of length 20km. Now I want to split each transect in to multiple 3km segments and test for spatial auto correlation. 

Obs	    Lat	                   Long              Number 
1	12,80382	82,44553	56
2	12,77357	82,67792	1
3	12,74253	82,8775	0
4	12,7118	83,08733	0
5	12,68468	83,28215	90
6	12,64768	83,49067	31
7	12,61173	83,723	                0
8	12,58148	83,92935	0
9	12,553	                84,16293            91
10	12,51517	84,37533	0
11	12,48025	84,60193	0
12	12,45202	84,83365	1
13	12,03108	87,61216	3
14	11,99813	87,83575	0
15	11,96863	88,05197	0
16	11,93698	88,27583	130
17	11,90938	88,49937	0
18	11,87682	88,69888	0
19	11,8452	88,90217	127
20	11,8116	89,13405	0
21	11,77802	89,35748	1
22	11,74482	89,57783	0
23	11,70103	89,94217	0
24	11,32148	92,42758	0
25	11,33478	92,68475	0
26	11,51452	92,78533	0

rm(list=ls())
# Library to load
library(sp)
library(adehabitat)
library(adehabitatHR)
library(adehabitatHS)
library(adehabitatLT)
library(adehabitatMA)
library(rgdal)
library(fields)
library(shapefiles)
library(maptools)
library(rgdal)
library(gpclib)
gpclibPermit()

setwd("C:\\Users\\mondreti\\Desktop\\Rworkdir")

# Data to load
BOBMDSOTE<- read.csv("C:\\Users\\mondreti\\Desktop\\Rworkdir\\BOBMD_SOTE1.csv", sep= ";", header=T)

# Inspect column headings
head(BOBMDSOTE)

# Telling R that BOBMDSOTE data frame consists spatial data	
coordinates(BOBMDSOTE)<- c("Latitude", "Longitude")
Class(BOBMDSOTE)
str(BOBMDSOTE)
x<- BOBMDSOTE$Latitude
y<- BOBMDSOTE$Longitude

xy.spdf <- SpatialPointsDataFrame(xy.sp, BOBMDSOTE)
summary(xy.spdf)
dimensions(xy.spdf)
xy.spdf

-------------------
After this I am unable to proceed.  Please help me with the code.

Thanks in advance,
Ravi.


-----Message d'origine-----
De?: Michael Sumner [mailto:mdsumner at gmail.com] Envoy??: mardi 30 juillet 2013 11:47 ??: Ravichandra MONDRETI Cc?: r-sig-geo at r-project.org Objet?: Re: [R-sig-Geo] Splitting the transect in to smaller segments

Could you put your data together in a reproducible way? It looks like this might just be the raw contents of a text file?

If you have it in R use dput() to create the code that will regenerate your object.



On Tue, Jul 30, 2013 at 7:37 PM, Ravichandra MONDRETI <Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>
> Hello All,
>
> My data are counts of seabirds and marine mammals at a spatial scale of 20 Km i.e I had recorded the position of the ship at the beginning of every 20 Km transect. Now I want to split each 20km transect in to 3km segments to check for spatial autocorrelation among the observations and relate it to the oceanographic features. I had tried with packages sp and rgdal but was not arrive at the r code. Could anyone suggest me how to proceed with this problem?
>
> My data looks like this:
>
>     Latitude
>
>         Longitude
>
> 12,80382
>
> 82,44553
>
> 12,77357
>
> 82,67792
>
> 12,74253
>
> 82,8775
>
> 12,7118
>
> 83,08733
>
> 12,68468
>
> 83,28215
>
> 12,64768
>
> 83,49067
>
> 12,61173
>
> 83,723
>
> 12,58148
>
> 83,92935
>
> 12,553
>
> 84,16293
>
> 12,51517
>
> 84,37533
>
> 12,48025
>
> 84,60193
>
> 12,45202
>
> 84,83365
>
> 12,03108
>
> 87,61216
>
> 11,99813
>
> 87,83575
>
> 11,96863
>
> 88,05197
>
> 11,93698
>
> 88,27583
>
> 11,90938
>
> 88,49937
>
> 11,87682
>
> 88,69888
>
>
> Thanks in advance,
> Ravichandra Mondreti.
>
>
> Ravichandra Mondreti
> PhD student/ Doctorant
> MAHEVA Fellow (ERASMUS MUNDUS programme) Spatial Population Ecology 
> Team CEFE-CNRS 1919, route de Mende
> F-34293 Montpellier Cedex 05
> France
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com

From Ravichandra.MONDRETI at cefe.cnrs.fr  Tue Jul 30 15:19:01 2013
From: Ravichandra.MONDRETI at cefe.cnrs.fr (Ravichandra MONDRETI)
Date: Tue, 30 Jul 2013 15:19:01 +0200
Subject: [R-sig-Geo] Converting CorelDraw files in to shape files
Message-ID: <7422421DBB284141ACBF3EBFB07B46760148ACF73C38@ZZMAIL.newcefe.newage.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/5f8f518c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Jul 30 15:43:10 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 30 Jul 2013 14:43:10 +0100
Subject: [R-sig-Geo] Converting CorelDraw files in to shape files
In-Reply-To: <d65052b5c92f421b954c1873dcc04790@EX-1-HT0.lancs.local>
References: <d65052b5c92f421b954c1873dcc04790@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOsd475EroZ0a0zkYD-1-qqFYnYgOY6+hg6WwAX=yit_A@mail.gmail.com>

On Tue, Jul 30, 2013 at 2:19 PM, Ravichandra MONDRETI
<Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>
> Hello everyone,
>
> Could anyone please give me an idea how extract the shape files from CorelDraw files (CDR).
>

CorelDraw is a proprietary, closed source general vector graphics
package. You may have some maps in the files, but there's no guarantee
the polygons are closed, or anything. They could be lots of line
segments in the wrong order. Or made up of triangles. Different files
could store the data differently. The coordinate system might not be
lat-long or anything else (its probably inches on the document, not
useful when your map is of France).

 Best you could hope for would be to post some where we can get them
and hope someone can reverse-engineer them, or convert them to
something more malleable.

 Inkscape (open source vector graphics editor) says it can Import
Corel Draw files, so you might be able to input them, check the
geometry, save as SVG, convert to shapes somehow,

Barr


From emanuele.cordano at gmail.com  Tue Jul 30 15:53:12 2013
From: emanuele.cordano at gmail.com (Emanuele Cordano)
Date: Tue, 30 Jul 2013 15:53:12 +0200
Subject: [R-sig-Geo] how to crete a *.prj file from a Raster object
Message-ID: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/f1f6a9ff/attachment.pl>

From samanmonfared1 at gmail.com  Tue Jul 30 16:11:53 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Tue, 30 Jul 2013 17:41:53 +0330
Subject: [R-sig-Geo] help for optim
Message-ID: <CAOytA4bwZEqu_2hNwSLnKXehR5mBu+KPc1bfj1+mNuNiu5OqzQ@mail.gmail.com>

Subj: Help for optim
Dear all,
I want to optimize a function using optim. I
have two problems:
1-how can i minimize function which fn value
be zero not negative. Because i want optimize parameters which lead to zero fn.

2- how can i change it to maximization?
Best,


From Ravichandra.MONDRETI at cefe.cnrs.fr  Tue Jul 30 17:07:53 2013
From: Ravichandra.MONDRETI at cefe.cnrs.fr (Ravichandra MONDRETI)
Date: Tue, 30 Jul 2013 17:07:53 +0200
Subject: [R-sig-Geo] Converting CorelDraw files in to shape files
In-Reply-To: <CANVKczOsd475EroZ0a0zkYD-1-qqFYnYgOY6+hg6WwAX=yit_A@mail.gmail.com>
References: <d65052b5c92f421b954c1873dcc04790@EX-1-HT0.lancs.local>
	<CANVKczOsd475EroZ0a0zkYD-1-qqFYnYgOY6+hg6WwAX=yit_A@mail.gmail.com>
Message-ID: <7422421DBB284141ACBF3EBFB07B46760148ACF73C4A@ZZMAIL.newcefe.newage.fr>


Thanks for the advice Barry but I think its quite a lot of work and there might be some problems in converting SVG files to shape file format as SVG is a drawing format and may not really represent the real world situation.

Ravi.

-----Message d'origine-----
De?: b.rowlingson at gmail.com [mailto:b.rowlingson at gmail.com] De la part de Barry Rowlingson
Envoy??: mardi 30 juillet 2013 15:43
??: Ravichandra MONDRETI
Cc?: r-sig-geo at r-project.org
Objet?: Re: [R-sig-Geo] Converting CorelDraw files in to shape files

On Tue, Jul 30, 2013 at 2:19 PM, Ravichandra MONDRETI <Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>
> Hello everyone,
>
> Could anyone please give me an idea how extract the shape files from CorelDraw files (CDR).
>

CorelDraw is a proprietary, closed source general vector graphics package. You may have some maps in the files, but there's no guarantee the polygons are closed, or anything. They could be lots of line segments in the wrong order. Or made up of triangles. Different files could store the data differently. The coordinate system might not be lat-long or anything else (its probably inches on the document, not useful when your map is of France).

 Best you could hope for would be to post some where we can get them and hope someone can reverse-engineer them, or convert them to something more malleable.

 Inkscape (open source vector graphics editor) says it can Import Corel Draw files, so you might be able to input them, check the geometry, save as SVG, convert to shapes somehow,

Barr


From vitale232 at gmail.com  Tue Jul 30 18:25:04 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 30 Jul 2013 09:25:04 -0700
Subject: [R-sig-Geo] Extract Value from Raster Stack Layer Determined by
 Different Raster's Pixel Value
In-Reply-To: <CANtt_hxu0FwUu+LmpnnN9vNnbWhmNr6CkhxCTuKXgdWaZ3Nb=g@mail.gmail.com>
References: <CAFTcopfqM4kyz4S2cQSexB8S-fz_4AG+xmQcNQDPRDDoXTb8Fg@mail.gmail.com>
	<CANtt_hyBUm9h99qRN=E_OyoKozhP5=BRBcQiV2=G+6u01xgzLA@mail.gmail.com>
	<CAFTcopcY=Yh6ztPRs1PS3sScHHYdXMXUAR=kWGTzuo+CtryppA@mail.gmail.com>
	<CAFTcope83dMvAODKxOKB5o8v9K_mv=ADWXx9ZRUDP5BCG6Kudg@mail.gmail.com>
	<CANtt_hxu0FwUu+LmpnnN9vNnbWhmNr6CkhxCTuKXgdWaZ3Nb=g@mail.gmail.com>
Message-ID: <CAFTcope+31TRbRdPqkaFRTa1UX_JgC5nxYS712CVRoLN8mH1Ug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/d6558311/attachment.pl>

From narayani at ku.edu  Tue Jul 30 18:28:47 2013
From: narayani at ku.edu (Narayani Barve)
Date: Tue, 30 Jul 2013 11:28:47 -0500
Subject: [R-sig-Geo] NoData value in writeRaster function
Message-ID: <CAE=+0-K85zyCrYueb13WaU4gW2-4ghD4jFywO-THFypKBFsTDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/a7c2e2cf/attachment.pl>

From james.miraflor at gmail.com  Tue Jul 30 18:50:10 2013
From: james.miraflor at gmail.com (James Matthew Miraflor)
Date: Wed, 31 Jul 2013 00:50:10 +0800
Subject: [R-sig-Geo] Zonal Statistics after Kriging
Message-ID: <CAPim8ZJN-vc7vCGX_GJZki_cwsucnFqcm2JFOo5XrAoQtV12pA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/5a97e746/attachment.pl>

From Roger.Bivand at nhh.no  Tue Jul 30 20:48:02 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 30 Jul 2013 18:48:02 +0000
Subject: [R-sig-Geo] help for optim
In-Reply-To: <CAOytA4bwZEqu_2hNwSLnKXehR5mBu+KPc1bfj1+mNuNiu5OqzQ@mail.gmail.com>
References: <CAOytA4bwZEqu_2hNwSLnKXehR5mBu+KPc1bfj1+mNuNiu5OqzQ@mail.gmail.com>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B6C0E08AA@DALER.valuta.nhh.no>

Paulo answered your posting (sent twice), but you now repeat the posting a third time. Please do follow the posting guide and the instructions for posting found on:

http://www.r-project.org/mail.html

Too many posts recently have not followed these simple requirements, and questioners are disappointed that there is no response. If you follow the instructions and posting guide, and especially if you provide a reproducible example demonstrating your problem, you are more likely to be answered. 

In this case, the questioner has not read the help page for the optim function, and should do so before further postings - the noise to signal ratio on the list is important, and asking the list to read help pages is noise. Please do understand that those of us who offer advice are not obliged to help, and the less sensible the question - especially when the question shows your unwillingness to do what the instructions and posting guide ask, the more likely that it will remain unanswered.

Roger Bivand
List admin.


--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av Saman Monfared [samanmonfared1 at gmail.com]
Sendt: 30. juli 2013 4:11
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] help for optim

Subj: Help for optim
Dear all,
I want to optimize a function using optim. I
have two problems:
1-how can i minimize function which fn value
be zero not negative. Because i want optimize parameters which lead to zero fn.

2- how can i change it to maximization?
Best,

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Dominik.Schneider at colorado.edu  Tue Jul 30 19:14:55 2013
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Tue, 30 Jul 2013 11:14:55 -0600
Subject: [R-sig-Geo] raster::stack() help
Message-ID: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/e2387b2c/attachment.pl>

From mdsumner at gmail.com  Wed Jul 31 03:01:19 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 31 Jul 2013 11:01:19 +1000
Subject: [R-sig-Geo] Converting CorelDraw files in to shape files
In-Reply-To: <7422421DBB284141ACBF3EBFB07B46760148ACF73C4A@ZZMAIL.newcefe.newage.fr>
References: <d65052b5c92f421b954c1873dcc04790@EX-1-HT0.lancs.local>
	<CANVKczOsd475EroZ0a0zkYD-1-qqFYnYgOY6+hg6WwAX=yit_A@mail.gmail.com>
	<7422421DBB284141ACBF3EBFB07B46760148ACF73C4A@ZZMAIL.newcefe.newage.fr>
Message-ID: <CAAcGz9-RFcN3KQDKzStas+xn0-2s3Kvqma9A3qRAowEs1+Q4+w@mail.gmail.com>

On Wed, Jul 31, 2013 at 1:07 AM, Ravichandra MONDRETI
<Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>
> Thanks for the advice Barry but I think its quite a lot of work and there might be some problems in converting SVG files to shape file format as SVG is a drawing format and may not really represent the real world situation.
>
> Ravi.

Well this is exactly what Barry was talking about. The CorelDraw files
have already started the problem, when you ask about extracting "the
shapefiles" from them. There aren't any "shapefiles" in there, but
presumably there is geometry of some kind, which may or may not match
the underlying model used by actual shapefiles. How did you get your
geometry into those files and what options does the program provide
you for using them elsewhere?



It's usually a good lead to search for "[my thing] GDAL" which can
pull up discussions about these issues. I found this with "CorelDraw
GDAL CDR": http://gis.stackexchange.com/questions/5596/import-cdr-file-into-gis-cad-format

(DXF as an intermediate is going to cause you more of the same
problems, but it may be the only way to share what you have. )

Cheers, Mike.


>
> -----Message d'origine-----
> De : b.rowlingson at gmail.com [mailto:b.rowlingson at gmail.com] De la part de Barry Rowlingson
> Envoy? : mardi 30 juillet 2013 15:43
> ? : Ravichandra MONDRETI
> Cc : r-sig-geo at r-project.org
> Objet : Re: [R-sig-Geo] Converting CorelDraw files in to shape files
>
> On Tue, Jul 30, 2013 at 2:19 PM, Ravichandra MONDRETI <Ravichandra.MONDRETI at cefe.cnrs.fr> wrote:
>>
>> Hello everyone,
>>
>> Could anyone please give me an idea how extract the shape files from CorelDraw files (CDR).
>>
>
> CorelDraw is a proprietary, closed source general vector graphics package. You may have some maps in the files, but there's no guarantee the polygons are closed, or anything. They could be lots of line segments in the wrong order. Or made up of triangles. Different files could store the data differently. The coordinate system might not be lat-long or anything else (its probably inches on the document, not useful when your map is of France).
>
>  Best you could hope for would be to post some where we can get them and hope someone can reverse-engineer them, or convert them to something more malleable.
>
>  Inkscape (open source vector graphics editor) says it can Import Corel Draw files, so you might be able to input them, check the geometry, save as SVG, convert to shapes somehow,
>
> Barr
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Dominik.Schneider at colorado.edu  Wed Jul 31 04:08:18 2013
From: Dominik.Schneider at colorado.edu (dschneiderch)
Date: Tue, 30 Jul 2013 19:08:18 -0700 (PDT)
Subject: [R-sig-Geo] NoData value in writeRaster function
In-Reply-To: <CAE=+0-K85zyCrYueb13WaU4gW2-4ghD4jFywO-THFypKBFsTDQ@mail.gmail.com>
References: <CAE=+0-K85zyCrYueb13WaU4gW2-4ghD4jFywO-THFypKBFsTDQ@mail.gmail.com>
Message-ID: <1375236498045-7584300.post@n2.nabble.com>

Did you look at help(writeRaster)?  You should be able to specify /NAflag:
Numeric. To overwrite the default value used to represent NA in a file/You
may need to manually change all your existing nodata values in i1 to NA
first.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/NoData-value-in-writeRaster-function-tp7584295p7584300.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vitale232 at gmail.com  Wed Jul 31 04:14:52 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 30 Jul 2013 19:14:52 -0700
Subject: [R-sig-Geo] raster::stack() help
In-Reply-To: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>
References: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>
Message-ID: <CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130730/aa2dd1b0/attachment.pl>

From Dominik.Schneider at colorado.edu  Wed Jul 31 04:27:24 2013
From: Dominik.Schneider at colorado.edu (dschneiderch)
Date: Tue, 30 Jul 2013 19:27:24 -0700 (PDT)
Subject: [R-sig-Geo] raster::stack() help
In-Reply-To: <CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>
References: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>
	<CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>
Message-ID: <1375237644103-7584302.post@n2.nabble.com>

Yeah I figure it'll work for most people.
I just logged into my desktop from home to get my sessioninfo and now
a.stack<-stack() worked as expected, at least in terminal as opposed to
emacs or R gui. aarrrgg. anyway, thanks for responding.

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] graphics  grDevices utils     datasets  stats     methods   base     

other attached packages:
[1] raster_2.1-49   sp_1.0-11       plyr_1.8        scales_0.2.3   
[5] reshape2_1.2.2  lubridate_1.2.0 ggplot2_0.9.3  

loaded via a namespace (and not attached):
 [1] colorspace_1.2-1   dichromat_2.0-0    digest_0.6.3       grid_2.15.2       
 [5] gtable_0.1.2       labeling_0.1       lattice_0.20-13    MASS_7.3-23       
 [9] munsell_0.4        proto_0.3-10       RColorBrewer_1.0-5 stringr_0.6.2     




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/raster-stack-help-tp7584298p7584302.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Jul 31 05:29:36 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 30 Jul 2013 20:29:36 -0700
Subject: [R-sig-Geo] raster::stack() help
In-Reply-To: <CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>
References: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>
	<CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>
Message-ID: <CANtt_hx-PkfCcRBScj0qHS_NNnp7EoEtxPCchR=2vjPWxrXc4Q@mail.gmail.com>

My guess is that there is another package hiding the raster function
-- no messages? You could explicitly use raster::stack()
Also, this avoids the call and might be more efficient:

library(raster)
a.list <- list()
for (yr in seq(2000,2008)){
....
a.layer = raster(something).

a.list <- c(a.list, a.layer)
}

a.stack = stack(a.list)

Robert


On Tue, Jul 30, 2013 at 7:14 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
> Works on my machine.
>
>> a.stack <- stack()
>> a.stack
> class       : RasterStack
> nlayers     : 0
>
>> stack()
> class       : RasterStack
> nlayers     : 0
>
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets  methods
> base
>
> other attached packages:
>  [1] ncdf_1.6.6          rasterVis_0.21      hexbin_1.26.2
> latticeExtra_0.6-24 RColorBrewer_1.0-5
>  [6] lattice_0.20-15     rgdal_0.8-9         ncdf4_1.9
> raster_2.1-49       sp_1.0-11
>
> loaded via a namespace (and not attached):
> [1] tools_3.0.1 zoo_1.7-10
>>
>
>
> On Tue, Jul 30, 2013 at 10:14 AM, Dominik Schneider <
> Dominik.Schneider at colorado.edu> wrote:
>
>> Hi, I am trying to initialize an empty stack with
>>
>> require(raster)
>> a.stack <- stack()
>> for (yr in seq(2000,2008)){
>> ....
>> a.layer = raster(something).
>>
>> a.stack <- addLayer(a.stack, a.layer)
>> }
>>
>> Even if I just run a.stack <- stack() in the commandline:
>> > stack()
>> Error in as.list(x) : argument "x" is missing, with no default
>>
>> I know I've done this in the past and the help file for stack() says x can
>> be missing to create an empty stack. Could someone help me debug or suggest
>> a workaround?
>> Thanks
>> Dominik
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> *Andrew P. Vitale*
> Masters Student
> Department of Geography
> University of Nevada, Reno
> (412) 915-3632
> vitale232 at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mauricio.zambrano at jrc.ec.europa.eu  Wed Jul 31 09:17:45 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Wed, 31 Jul 2013 09:17:45 +0200
Subject: [R-sig-Geo] how to crete a *.prj file from a Raster object
In-Reply-To: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>
References: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>
Message-ID: <51F8BA19.7000304@jrc.ec.europa.eu>

On 07/30/2013 03:53 PM, Emanuele Cordano wrote:
> Dear list,
>
> I have a RasterLayer object with CRS.
>
> I would like to write it in a *.asc ESRI ASCII file with writeRaster. I did
> it , I got the *.asc file but no related *.prj file was written.
> Is there a quick method to create directly the *.prj file from a
> RasterLayer object?

Hi Emanuele,

AFAIK, the .prj files are only used for vectorial shapefiles, and that 
is the reason why you don't get such file when using the 'writeRaster' 
function.

Have a look to:

https://en.wikipedia.org/wiki/Shapefile#Shapefile_projection_format_.28.prj.29

All the best,

Mauricio Zambrano-Bigiarini, Ph.D


-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:7}}


From mdsumner at gmail.com  Wed Jul 31 10:20:37 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 31 Jul 2013 18:20:37 +1000
Subject: [R-sig-Geo] how to crete a *.prj file from a Raster object
In-Reply-To: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>
References: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>
Message-ID: <CAAcGz9_fad=cx2vJt+b0WsHHmpS6tmzhMHhLQE-4NUeQdqNasw@mail.gmail.com>

One way is to write a dummy shapefile, and rename the .prj to suit.

To do that you could:
require(raster)
require(rgdal)
r <- raster(list(x = 1:nrow(volcano), y = 1:ncol(volcano), z =
volcano), crs = "+proj=laea +lat_0=-50 +datum=WGS84")
writeRaster(r, "file.asc")
dummy <- as(extent(r), "SpatialPolygons")
proj4string(dummy) <- CRS(proj4string(r))
writeOGR(SpatialPolygonsDataFrame(dummy, data.frame(x = 1)), ".",
"file", "ESRI Shapefile")
unlink(c("file.shp", "file.shx", "file.dbf"))


Some programs (such as GDAL) do use these .prj files for ASCII rasters
(see below), which helps make them more useful - though it's a bit of
a minefield since GDAL allows them to have non-square pixels, but the
raster package does not let you write one (rgdal::writeGDAL does). It
depends on your target for whether this mix is helpful or not. I would
seriously consider using a better format if you can. GeoTIFF is the
best all-rounder in my experience, but there's always lots of gotchas.
The native raster format (another .grd) is probably the best for
general R/raster package use if you don't need to go to other systems.

So, long story but just be aware that none of this makes for an
obvious choice, it depends on your circumstances. I avoid text-format
rasters like the plague.

On my system:

gdalinfo file.asc
Driver: AAIGrid/Arc/Info ASCII Grid
Files: file.asc
       file.prj
Size is 87, 61
Coordinate System is:
PROJCS["Lambert_Azimuthal_Equal_Area",
    GEOGCS["GCS_WGS_1984",
        DATUM["WGS_1984",
            SPHEROID["WGS_84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
    PARAMETER["latitude_of_center",-50],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (0.500000000000000,61.500000000000000)
Pixel Size = (1.000000000000000,-1.000000000000000)
Corner Coordinates:
Upper Left  (   0.5000000,  61.5000000) (  0d 0' 0.03"E, 49d59'58.01"S)
Lower Left  (   0.5000000,   0.5000000) (  0d 0' 0.03"E, 49d59'59.98"S)
Upper Right (  87.5000000,  61.5000000) (  0d 0' 4.39"E, 49d59'58.01"S)
Lower Right (  87.5000000,   0.5000000) (  0d 0' 4.39"E, 49d59'59.98"S)
Center      (  44.0000000,  31.0000000) (  0d 0' 2.21"E, 49d59'59.00"S)
Band 1 Block=87x1 Type=Float32, ColorInterp=Undefined
  NoData Value=-9999

rgdal can write these GDAL non-square pixels:

r <-  raster(volcano)
## this will fail
writeRaster(r, "afile.asc")
##Error in .startAsciiWriting(x, filename, ...) :
 ## x has unequal horizontal and vertical resolutions. Such data
cannot be stored in arc-ascii format

## this works
writeGDAL(as(r, "SpatialGridDataFrame"), "afile.asc", driver = "AAIGrid")

The crux of the GDAL rectangular pixel support is here at the top of the .asc:
ncols        61
nrows        87
xllcorner    0.000000000000
yllcorner    0.000000000000
dx           0.016393442623
dy           0.011494252874

This is described here, and how to overwrite the default:
http://gdal.org/frmt_various.html#AAIGrid

Cheers, Mike.

On Tue, Jul 30, 2013 at 11:53 PM, Emanuele Cordano
<emanuele.cordano at gmail.com> wrote:
> Dear list,
>
> I have a RasterLayer object with CRS.
>
> I would like to write it in a *.asc ESRI ASCII file with writeRaster. I did
> it , I got the *.asc file but no related *.prj file was written.
> Is there a quick method to create directly the *.prj file from a
> RasterLayer object?
>
> Thank you very much
>
>
> kind regards
> Emanuele Cordano
>
>
> --
> Emanuele Cordano
> Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
> 3587 (Albo A - Provincia di Trento)
> Fondazione Edmund Mach
> CRI - Reasearch and Innovation Center
> Agro-Eco-System Dynamic Platform
> Via Mach 1
> 38017 San Michele All'Adige (Italy)
> phone +39 0461 615397
> email: emanuele.cordano at iasma.it ,emanuele.cordano at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Roger.Bivand at nhh.no  Wed Jul 31 10:56:15 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 31 Jul 2013 08:56:15 +0000
Subject: [R-sig-Geo] how to crete a *.prj file from a Raster object
In-Reply-To: <CAAcGz9_fad=cx2vJt+b0WsHHmpS6tmzhMHhLQE-4NUeQdqNasw@mail.gmail.com>
References: <CAKw81f__0DTjJpyiVu6zxHppVDTA1ocixWKuVx1FZHWKjevDrg@mail.gmail.com>,
	<CAAcGz9_fad=cx2vJt+b0WsHHmpS6tmzhMHhLQE-4NUeQdqNasw@mail.gmail.com>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B6C0E0924@DALER.valuta.nhh.no>

And even:

require(raster)
require(rgdal)
r <- raster(list(x = 1:nrow(volcano), y = 1:ncol(volcano), z =
volcano), crs = "+proj=laea +lat_0=-50 +datum=WGS84")
writeRaster(r, "file.asc")
showWKT(proj4string(r), file="file.prj") 
# which also shows the WKT version on the console

Roger

--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av Michael Sumner [mdsumner at gmail.com]
Sendt: 31. juli 2013 10:20
Til: Emanuele Cordano
Kopi: r-sig-geo at r-project.org
Emne: Re: [R-sig-Geo] how to crete a *.prj file from a Raster object

One way is to write a dummy shapefile, and rename the .prj to suit.

To do that you could:
require(raster)
require(rgdal)
r <- raster(list(x = 1:nrow(volcano), y = 1:ncol(volcano), z =
volcano), crs = "+proj=laea +lat_0=-50 +datum=WGS84")
writeRaster(r, "file.asc")
dummy <- as(extent(r), "SpatialPolygons")
proj4string(dummy) <- CRS(proj4string(r))
writeOGR(SpatialPolygonsDataFrame(dummy, data.frame(x = 1)), ".",
"file", "ESRI Shapefile")
unlink(c("file.shp", "file.shx", "file.dbf"))


Some programs (such as GDAL) do use these .prj files for ASCII rasters
(see below), which helps make them more useful - though it's a bit of
a minefield since GDAL allows them to have non-square pixels, but the
raster package does not let you write one (rgdal::writeGDAL does). It
depends on your target for whether this mix is helpful or not. I would
seriously consider using a better format if you can. GeoTIFF is the
best all-rounder in my experience, but there's always lots of gotchas.
The native raster format (another .grd) is probably the best for
general R/raster package use if you don't need to go to other systems.

So, long story but just be aware that none of this makes for an
obvious choice, it depends on your circumstances. I avoid text-format
rasters like the plague.

On my system:

gdalinfo file.asc
Driver: AAIGrid/Arc/Info ASCII Grid
Files: file.asc
       file.prj
Size is 87, 61
Coordinate System is:
PROJCS["Lambert_Azimuthal_Equal_Area",
    GEOGCS["GCS_WGS_1984",
        DATUM["WGS_1984",
            SPHEROID["WGS_84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
    PARAMETER["latitude_of_center",-50],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (0.500000000000000,61.500000000000000)
Pixel Size = (1.000000000000000,-1.000000000000000)
Corner Coordinates:
Upper Left  (   0.5000000,  61.5000000) (  0d 0' 0.03"E, 49d59'58.01"S)
Lower Left  (   0.5000000,   0.5000000) (  0d 0' 0.03"E, 49d59'59.98"S)
Upper Right (  87.5000000,  61.5000000) (  0d 0' 4.39"E, 49d59'58.01"S)
Lower Right (  87.5000000,   0.5000000) (  0d 0' 4.39"E, 49d59'59.98"S)
Center      (  44.0000000,  31.0000000) (  0d 0' 2.21"E, 49d59'59.00"S)
Band 1 Block=87x1 Type=Float32, ColorInterp=Undefined
  NoData Value=-9999

rgdal can write these GDAL non-square pixels:

r <-  raster(volcano)
## this will fail
writeRaster(r, "afile.asc")
##Error in .startAsciiWriting(x, filename, ...) :
 ## x has unequal horizontal and vertical resolutions. Such data
cannot be stored in arc-ascii format

## this works
writeGDAL(as(r, "SpatialGridDataFrame"), "afile.asc", driver = "AAIGrid")

The crux of the GDAL rectangular pixel support is here at the top of the .asc:
ncols        61
nrows        87
xllcorner    0.000000000000
yllcorner    0.000000000000
dx           0.016393442623
dy           0.011494252874

This is described here, and how to overwrite the default:
http://gdal.org/frmt_various.html#AAIGrid

Cheers, Mike.

On Tue, Jul 30, 2013 at 11:53 PM, Emanuele Cordano
<emanuele.cordano at gmail.com> wrote:
> Dear list,
>
> I have a RasterLayer object with CRS.
>
> I would like to write it in a *.asc ESRI ASCII file with writeRaster. I did
> it , I got the *.asc file but no related *.prj file was written.
> Is there a quick method to create directly the *.prj file from a
> RasterLayer object?
>
> Thank you very much
>
>
> kind regards
> Emanuele Cordano
>
>
> --
> Emanuele Cordano
> Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
> 3587 (Albo A - Provincia di Trento)
> Fondazione Edmund Mach
> CRI - Reasearch and Innovation Center
> Agro-Eco-System Dynamic Platform
> Via Mach 1
> 38017 San Michele All'Adige (Italy)
> phone +39 0461 615397
> email: emanuele.cordano at iasma.it ,emanuele.cordano at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tanyajcompton at yahoo.com.au  Wed Jul 31 12:17:14 2013
From: tanyajcompton at yahoo.com.au (Tanya Rijkenberg Compton)
Date: Wed, 31 Jul 2013 12:17:14 +0200
Subject: [R-sig-Geo] projection issue - can one rotate a projection?
Message-ID: <2F3B7BEC-9EF0-43D4-B41B-A53938223D45@yahoo.com.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/af47ccb4/attachment.pl>

From cjpauw at gmail.com  Wed Jul 31 14:08:46 2013
From: cjpauw at gmail.com (Christiaan Pauw)
Date: Wed, 31 Jul 2013 14:08:46 +0200
Subject: [R-sig-Geo] Walk around the block
Message-ID: <CAJESSmaRxv09cdT=TGh6F-Jz1WrfN-P90BrmHe6qjpXVq14YLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/7e2695aa/attachment.pl>

From rmettier at gmail.com  Wed Jul 31 14:26:54 2013
From: rmettier at gmail.com (Ralph Mettier)
Date: Wed, 31 Jul 2013 14:26:54 +0200
Subject: [R-sig-Geo] gstat: Cokriging with unusual neighbourhood choice
 - is this possible?
Message-ID: <CAFsio8hxhnpkNXGxxncQ4Sv0S3_kFZe=o0OJ9aQxk0fny3nNZg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/667d2f1c/attachment.pl>

From xujianhui306 at gmail.com  Wed Jul 31 15:28:57 2013
From: xujianhui306 at gmail.com (jianhui xu)
Date: Wed, 31 Jul 2013 21:28:57 +0800
Subject: [R-sig-Geo] cokriging for large data
Message-ID: <CAOALw2We+zjbKSrMRZzY+cAkLC2YAU2jLe+zy6C6C6m=F55TOQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/44777138/attachment.pl>

From xujianhui306 at gmail.com  Wed Jul 31 15:31:51 2013
From: xujianhui306 at gmail.com (jianhui xu)
Date: Wed, 31 Jul 2013 21:31:51 +0800
Subject: [R-sig-Geo] cokriging for large data
Message-ID: <CAOALw2Vt4iXM5bWYoBCC35-+9=3pjNNLqgmSz-O_KJPM8tmg3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/fee7bcf2/attachment.pl>

From danielvdelatorre at gmail.com  Wed Jul 31 15:39:18 2013
From: danielvdelatorre at gmail.com (latorre.daniel)
Date: Wed, 31 Jul 2013 06:39:18 -0700 (PDT)
Subject: [R-sig-Geo] Script to get polygons area in square meters
Message-ID: <1375277958376-7584312.post@n2.nabble.com>

Hello,

I am really new to GIS and I am posting here to check if what I learned so
far is right. My goal is to measure areas of polygons (representing species
distributions) in square meters. I'm going to use data available as
shapefiles on IUCN Red List website.

To read the polygon into R:

library(sp)
library(rgdal)
library(rgeos)
setwd("~/Folder1/Folder2/Canis_latrans_(Coyote)/")
coyote<-readOGR(dsn=".", layer="species_3745")

The projection is in longlat:

> coyote at proj4string
CRS arguments:
 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 

so area calculation will be in longlat units.

The next step, then, should be transforming the projection. In this case I
chose the equal area Mollweide projection, just because I've seen a paper
using it (but I don't really looked for pros/cons of using any other
projection).

Projection transformation:

coyote_moll<-spTransform(x=coyote,CRSobj=CRS("+proj=moll +ellps=WGS84"))

To get the area:

gArea(coyote_moll)

As I said I am writhing here because I want to be sure if this script is
right, is it? Second, because I couldn't find all these steps together and I
thought it could be useful for someone else in the future.

Also I would like to know if Mollweide is a good projection for that
propose? If not, is there something easy and useful to read about?

My final question is: the 'readOGR' function returns an error if the 'dsn'
argument is a path different from ".". Am I doing something wrong or is it
normal?

Thank you very much in advance! 

Daniel

> sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] pt_BR.UTF-8/pt_BR.UTF-8/pt_BR.UTF-8/C/pt_BR.UTF-8/pt_BR.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgeos_0.2-17 rgdal_0.8-10 sp_1.0-11   

loaded via a namespace (and not attached):
[1] grid_3.0.0      lattice_0.20-15 tools_3.0.0 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Script-to-get-polygons-area-in-square-meters-tp7584312.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Dominik.Schneider at colorado.edu  Wed Jul 31 17:00:17 2013
From: Dominik.Schneider at colorado.edu (dschneiderch)
Date: Wed, 31 Jul 2013 08:00:17 -0700 (PDT)
Subject: [R-sig-Geo] raster::stack() help
In-Reply-To: <CANtt_hx-PkfCcRBScj0qHS_NNnp7EoEtxPCchR=2vjPWxrXc4Q@mail.gmail.com>
References: <CAHYDKLZi6YD7P7o-FHD9C+DFBq6Zmq+Z=kCY12Zgp6JF=GfvsA@mail.gmail.com>
	<CAFTcopc+o_tcAS2Ds61P+cMnBEGmVXtuRxAkau1z-SXdddm=Sg@mail.gmail.com>
	<CANtt_hx-PkfCcRBScj0qHS_NNnp7EoEtxPCchR=2vjPWxrXc4Q@mail.gmail.com>
Message-ID: <1375282817770-7584313.post@n2.nabble.com>

Thanks for the advice Robert. I'll give those a try if I continue to have
problems.  For now my code is running again.




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/raster-stack-help-tp7584298p7584313.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mark at weather-source.com  Wed Jul 31 19:17:32 2013
From: mark at weather-source.com (Mark Gibbas)
Date: Wed, 31 Jul 2013 13:17:32 -0400
Subject: [R-sig-Geo] readOGR -- Dropping null geometries -- Possible issue
 with path as a point
Message-ID: <51F946AC.2020301@weather-source.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/11d9578e/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jul 31 21:16:38 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 31 Jul 2013 19:16:38 +0000
Subject: [R-sig-Geo] readOGR -- Dropping null geometries -- Possible
 issue with path as a point
In-Reply-To: <51F946AC.2020301@weather-source.com>
References: <51F946AC.2020301@weather-source.com>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B6C0E09E6@DALER.valuta.nhh.no>

The data you link to are not those you refer to:

> tornados.rg <- readOGR(".", "tornado")
OGR data source with driver: ESRI Shapefile 
Source: ".", layer: "tornado"
with 56221 features and 28 fields
Feature type: wkbPoint with 2 dimensions

that source does not provide any called "tornado_tracks". I do see similar behaviour in:

http://www.spc.noaa.gov/gis/svrgis/zipped/prelim_2012_tornado_tracks.zip

but have no idea whether your analysis applies to this data. Please check and report back. If it does, I can try to see why, but NULL geometries are defined in the OGR shapefile driver, and so by definition have no position data. What you may be seeing as first and last equal coordinates are the entries in the data.frame returned when dropNULLGeometries=FALSE, and may be single point events, which have not been given a geometry. You would need to find out from the data provider what they meant by this. It is not permitted to mix geometry types in a shapefile, so the problem may arise if they try to do so; the shapefile contains invalid geometry types for the NULL geometries, suggesting that they are not read or set correctly. The event_id values should permit them to be identified.

Hope this helps,

Roger


--
Roger Bivand
NHH Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] p&#229; vegne av Mark Gibbas [mark at weather-source.com]
Sendt: 31. juli 2013 7:17
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] readOGR -- Dropping null geometries -- Possible issue with path as a point

Greetings!

I am attempting to read a shapefile with readOGR and I'm getting the
message 'Dropping null geometries'. From what I have been able to
discern the null geometries seem to be associated with lines where the
begin and end lat/lon are the same. So effectively the line is really
just a point. Should such a case cause readOGR to treat this as a null
geometry? Or is it possible something else is happening? Any insight
into this is _very_ appreciated. Thanks!

###############
# DATA DOWNLOAD

    http://www.spc.noaa.gov/gis/svrgis/zipped/tornado.zip

###############
# SAMPLE CODE

    setwd("C:/Users/mark/Downloads/GIS_Data")
    library(rgdal)
    tornados.rg <- readOGR("./SPC_Data/tornado_tracks", "tornado_tracks")

###############
# RESULTS

    OGR data source with driver: ESRI Shapefile
    Source: "./SPC_Data/tornado_tracks", layer: "tornado_tracks"
    with 29806 features and 28 fields
    Feature type: wkbLineString with 2 dimensions
    Warning message:
    In readOGR("./SPC_Data/tornado_tracks", "tornado_tracks") :
       Dropping null geometries: 147, 427, 542, 730, 739, 851, 859, ...

###############
# INVESTIGATION

    By comparing the elements of what was read by readOGR to a CSV file
    of the same data, I find that the ones skipped by readOGR are
    elements where the begin and end lat/lon are the same.

###############
# SESSION INFO

     > sessionInfo()
    R version 2.15.3 (2013-03-01)
    Platform: x86_64-w64-mingw32/x64 (64-bit)

    locale:
    [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
    States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C
    [5] LC_TIME=English_United States.1252

    attached base packages:
    [1] grid      stats     graphics  grDevices utils     datasets
    methods   base

    other attached packages:
    [1] PBSmapping_2.66.53 maptools_0.8-25    lattice_0.20-13
    foreign_0.8-52     rgeos_0.2-19       rgdal_0.8-10 sp_1.0-11

    loaded via a namespace (and not attached):
    [1] tools_2.15.3




        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mark at weather-source.com  Wed Jul 31 21:52:29 2013
From: mark at weather-source.com (Mark Gibbas)
Date: Wed, 31 Jul 2013 15:52:29 -0400
Subject: [R-sig-Geo] readOGR -- Dropping null geometries -- Possible
 issue with path as a point
In-Reply-To: <E953A98FD6EAA7479A68EE8C24491F6B6C0E09E6@DALER.valuta.nhh.no>
References: <51F946AC.2020301@weather-source.com>
	<E953A98FD6EAA7479A68EE8C24491F6B6C0E09E6@DALER.valuta.nhh.no>
Message-ID: <51F96AFD.9030102@weather-source.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/4d80df28/attachment.pl>

From jmbluengo at gmail.com  Wed Jul 31 23:05:36 2013
From: jmbluengo at gmail.com (Juan Manuel Becerra)
Date: Wed, 31 Jul 2013 23:05:36 +0200
Subject: [R-sig-Geo] Spatial Regression: Moving window regression (MWR) or
	GWR adaptation...?
In-Reply-To: <CAKs0pqfnRPw5jtzDCymauYE3Eac60ekscPVo_x-eiqNL4QWZdw@mail.gmail.com>
References: <CAKs0pqfnRPw5jtzDCymauYE3Eac60ekscPVo_x-eiqNL4QWZdw@mail.gmail.com>
Message-ID: <CAKs0pqeFpLZADbDQ-j9ro-StTj_05hu3jB_yBW+Eun+XTd09PA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130731/7bb50ae2/attachment.pl>

From clint at ecy.wa.gov  Wed Jul 31 23:18:33 2013
From: clint at ecy.wa.gov (Clint Bowman)
Date: Wed, 31 Jul 2013 14:18:33 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Regression: Moving window regression (MWR)
 or GWR adaptation...?
In-Reply-To: <CAKs0pqeFpLZADbDQ-j9ro-StTj_05hu3jB_yBW+Eun+XTd09PA@mail.gmail.com>
References: <CAKs0pqfnRPw5jtzDCymauYE3Eac60ekscPVo_x-eiqNL4QWZdw@mail.gmail.com>
	<CAKs0pqeFpLZADbDQ-j9ro-StTj_05hu3jB_yBW+Eun+XTd09PA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1307311412220.6870@ecy.wa.gov>

Isn't this amenable to a Poisson point process 
<http://en.wikipedia.org/wiki/Poisson_process>?

See Konisky, et al, 2013, "Strategic Placement of Air Polluters: An 
Application of Point Pattern Models".


Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Quality Modeler		INTERNET:	clint at math.utah.edu
Department of Ecology		VOICE:		(360) 407-6815
PO Box 47600			FAX:		(360) 407-7534
Olympia, WA 98504-7600

         USPS:           PO Box 47600, Olympia, WA 98504-7600
         Parcels:        300 Desmond Drive, Lacey, WA 98503-1274

On Wed, 31 Jul 2013, Juan Manuel Becerra wrote:

> Hi
>
> I'm trying to make a model to estimate the number of roberys. I know the
> address of these people and the point on the map where they live. I have a
> sample of all the country, in different cities, different zones. The
> variable can be set to 0,1,2 .....,and it is distributed as a poisson.
> Right now I'm using data from the population density from a raster of
> european environment agency. For now I want only estimate the number of
> roberys, depending on population density, or moving window arround the
> people live. In future I would like to include more variables raster-based
> style.
>
> I have read that the models used in these cases are GWR, but in a book
> specifically speaks about MWR as a good method to estimate in places where
> you did not have data to make the regression (this is my situation). I
> think GWR need points near the value estimate to give a good estimate. In
> my case i don't have these points to estimate because I want to estimate
> only considering adaptations of independent variables (...focal by kernel,
> or others ).
>
> I've read about GWmodel, gwrr, spgwr .... but I don't have a very clear
> idea about what is the best way in my case. Is there any package that has
> implemented MWR?, It is possible that I'm wrong, and I can use whith GWR
> raster values in areas without sample to estimate?. A good
> recommendation?... i'm new in this king of regressions.
>
> I posted the same question in gis secction of stackoverflow.
>
> http://gis.stackexchange.com/questions/67443/moving-window-regression-mwr-in-r
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


