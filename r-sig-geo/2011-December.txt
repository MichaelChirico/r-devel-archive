From karaka at ifc.cnr.it  Thu Dec  1 12:29:22 2011
From: karaka at ifc.cnr.it (Matilde Karakachoff)
Date: Thu, 01 Dec 2011 12:29:22 +0100
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <mailman.13.1322737204.15033.r-sig-geo@r-project.org>
References: <mailman.13.1322737204.15033.r-sig-geo@r-project.org>
Message-ID: <afaffa9e08ad88e224c256113ec2b05c@insm.isti.cnr.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111201/63d96f70/attachment.pl>

From David.Stephens at cefas.co.uk  Thu Dec  1 13:51:54 2011
From: David.Stephens at cefas.co.uk (David Stephens (Cefas))
Date: Thu, 1 Dec 2011 12:51:54 -0000
Subject: [R-sig-Geo] KED predictions using raster package
Message-ID: <04A370231C10664C88B28D1EF74F487901CB7A00@LOWEXPRESS.corp.cefas.co.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111201/466f7a05/attachment.pl>

From paul.hiemstra at knmi.nl  Thu Dec  1 14:23:42 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 01 Dec 2011 13:23:42 +0000
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <afaffa9e08ad88e224c256113ec2b05c@insm.isti.cnr.it>
References: <mailman.13.1322737204.15033.r-sig-geo@r-project.org>
	<afaffa9e08ad88e224c256113ec2b05c@insm.isti.cnr.it>
Message-ID: <4ED77FDE.6070703@knmi.nl>

Hi Matilde,

Your short and cryptic mail leaves us guessing what is going wrong here.
Please provide more info, see the R-help posting guide for some advice
[1]. Most important is a small piece of R code which reproduces this
problem.

regards,
Paul

[1] http://www.r-project.org/posting-guide.html

On 12/01/2011 11:29 AM, Matilde Karakachoff wrote:
>   
>
> Hello all, 
>
> I'm trying to execute a very simple command on a linux
> server: 
>
> Locus1grid  as asMethod -> as asMethod
> Execution halted
>
>
> Could you help me? May be the sspdep package doesn't work in the same
> way if working on a server? I admit that my experience working with
> servers is almost 0!!!! 
>
> Thank you very much, 
>
> regards 
>
> Matilde
>
> --
>
> Matilde Karakachoff
> Istituto di Fisiologia Clinica
> Pisa Italia
>  
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From karaka at ifc.cnr.it  Thu Dec  1 15:31:40 2011
From: karaka at ifc.cnr.it (Matilde Karakachoff)
Date: Thu, 01 Dec 2011 15:31:40 +0100
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <4ED77FDE.6070703@knmi.nl>
References: <mailman.13.1322737204.15033.r-sig-geo@r-project.org>
	<afaffa9e08ad88e224c256113ec2b05c@insm.isti.cnr.it>
	<4ED77FDE.6070703@knmi.nl>
Message-ID: <5e37d648e9cbd5486113f55277aa40a5@insm.isti.cnr.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111201/ce90c68d/attachment.pl>

From karaka at ifc.cnr.it  Thu Dec  1 15:45:43 2011
From: karaka at ifc.cnr.it (Matilde Karakachoff)
Date: Thu, 01 Dec 2011 15:45:43 +0100
Subject: [R-sig-Geo] spdep and server
Message-ID: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>

Ok, I?m sorry. I think that there was a little problem with my previous 
message.

I?m trying to execute some R commands on a linux server (where I 
installed R and packages previously) to create a SpatialGridDataFrame. 
It has to be a grid 10*10 to which I will associate data resulting from 
simulations of the spatial distribution of genotypic data (Fregene).


Some lines and columns of my data frame:
coord	x	y	f.all1s1	f.all2s1
4040	40	40	0,665	0,335	0,05346675
4041	40	41	0,72	0,28	0,049152
4042	40	42	0,825	0,175	0,04141875
4043	40	43	0,81	0,19	0,042483
4044	40	44	0,82	0,18	0,041772
4045	40	45	0,59	0,41	0,059643
4046	40	46	0,585	0,415	0,06006675
4047	40	47	0,405	0,595	0,07632075

My script:
>library(spdep)
>Locus1 <- read.csv2(file='data.csv', head=T)
>coordinates(Locus1) <- c('x', 'y')
>Locus1.sp <- as(Locus1, 'SpatialPixels')
>Locus1.gr <- as(Locus1.sp, 'SpatialGridDataFrame')

The first four lines are ok, but the last one gives the following 
error:

Error in asMethod(object, Class, value) : replace-coercion not allowed

But if I run it on my computer it works. So, why it doesn?t work on a 
server? May be the ?spdep? package doesn't work in the same way on 
linux?
Thanks a lot,

Matilde




-- 
Matilde Karakachoff
Istituto di Fisiologia Clinica
Pisa Italia


From sarah.goslee at gmail.com  Thu Dec  1 15:54:23 2011
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 1 Dec 2011 09:54:23 -0500
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
Message-ID: <CAM_vjukGF=3eCjZTL-rXoYTQNye8fJLd0Zyn5JnzdOLioPHtCw@mail.gmail.com>

A reproducible example and the basis system information requested
in the posting guide would be very helpful.
OS, version of R, versions of the relevant packages...

We really do need this information to answer questions.

Sarah

On Thu, Dec 1, 2011 at 9:45 AM, Matilde Karakachoff <karaka at ifc.cnr.it> wrote:
> Ok, I?m sorry. I think that there was a little problem with my previous
> message.
>
> I?m trying to execute some R commands on a linux server (where I installed R
> and packages previously) to create a SpatialGridDataFrame. It has to be a
> grid 10*10 to which I will associate data resulting from simulations of the
> spatial distribution of genotypic data (Fregene).
>
>
> Some lines and columns of my data frame:
> coord ? x ? ? ? y ? ? ? f.all1s1 ? ? ? ?f.all2s1
> 4040 ? ?40 ? ? ?40 ? ? ?0,665 ? 0,335 ? 0,05346675
> 4041 ? ?40 ? ? ?41 ? ? ?0,72 ? ?0,28 ? ?0,049152
> 4042 ? ?40 ? ? ?42 ? ? ?0,825 ? 0,175 ? 0,04141875
> 4043 ? ?40 ? ? ?43 ? ? ?0,81 ? ?0,19 ? ?0,042483
> 4044 ? ?40 ? ? ?44 ? ? ?0,82 ? ?0,18 ? ?0,041772
> 4045 ? ?40 ? ? ?45 ? ? ?0,59 ? ?0,41 ? ?0,059643
> 4046 ? ?40 ? ? ?46 ? ? ?0,585 ? 0,415 ? 0,06006675
> 4047 ? ?40 ? ? ?47 ? ? ?0,405 ? 0,595 ? 0,07632075
>
> My script:
>>
>> library(spdep)
>> Locus1 <- read.csv2(file='data.csv', head=T)
>> coordinates(Locus1) <- c('x', 'y')
>> Locus1.sp <- as(Locus1, 'SpatialPixels')
>> Locus1.gr <- as(Locus1.sp, 'SpatialGridDataFrame')
>
>
> The first four lines are ok, but the last one gives the following error:
>
> Error in asMethod(object, Class, value) : replace-coercion not allowed
>
> But if I run it on my computer it works. So, why it doesn?t work on a
> server? May be the ?spdep? package doesn't work in the same way on linux?
> Thanks a lot,
>
> Matilde
>
>
-- 
Sarah Goslee
http://www.functionaldiversity.org


From jon.skoien at jrc.ec.europa.eu  Thu Dec  1 17:23:57 2011
From: jon.skoien at jrc.ec.europa.eu (jon.skoien at jrc.ec.europa.eu)
Date: Thu, 01 Dec 2011 17:23:57 +0100
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
Message-ID: <4ED7AA1D.9080607@jrc.ec.europa.eu>

Hi Matilde,
see inline comments below.

On 01-Dec-11 15:45, Matilde Karakachoff wrote:
> Ok, I?m sorry. I think that there was a little problem with my 
> previous message.
>
> I?m trying to execute some R commands on a linux server (where I 
> installed R and packages previously) to create a SpatialGridDataFrame. 
> It has to be a grid 10*10 to which I will associate data resulting 
> from simulations of the spatial distribution of genotypic data (Fregene).
>
>
> Some lines and columns of my data frame:
> coord    x    y    f.all1s1    f.all2s1
> 4040    40    40    0,665    0,335    0,05346675
> 4041    40    41    0,72    0,28    0,049152
> 4042    40    42    0,825    0,175    0,04141875
> 4043    40    43    0,81    0,19    0,042483
> 4044    40    44    0,82    0,18    0,041772
> 4045    40    45    0,59    0,41    0,059643
> 4046    40    46    0,585    0,415    0,06006675
> 4047    40    47    0,405    0,595    0,07632075
>
> My script:
>> library(spdep)
>> Locus1 <- read.csv2(file='data.csv', head=T)
>> coordinates(Locus1) <- c('x', 'y')
>> Locus1.sp <- as(Locus1, 'SpatialPixels')
>> Locus1.gr <- as(Locus1.sp, 'SpatialGridDataFrame')

What has happened here is that you first create a spatial object with 
coordinates(). Then you strip off the data with as(Locus1, 
'SpatialPixels'). The last line throws an error because you try to 
coerce a SpatialPixels-object without data into a SpatialGridDataFrame 
which needs a data slot.

The lines above would probably work if you changed SpatialPixels with 
SpatialPixelsDataFrame in line 4. But you can also try:
Locus1 <- read.csv2(file='data.csv', head=T)
gridded(Locus1) = ~x+y # Set coordinates and create 
SpatialPixelsDataFrame immediately
fullgrid(Locus1) = TRUE # change to SpatialGridDataFrame

>
> The first four lines are ok, but the last one gives the following error:
>
> Error in asMethod(object, Class, value) : replace-coercion not allowed
>
> But if I run it on my computer it works. So, why it doesn?t work on a 
> server? May be the ?spdep? package doesn't work in the same way on linux?

This shouldnt be different between different installations of R, but 
maybe there was something in your workspace that made it work on your 
computer?

Cheers,
Jon


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Global Environment Monitoring Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From b.rowlingson at lancaster.ac.uk  Thu Dec  1 17:28:42 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 1 Dec 2011 16:28:42 +0000
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
Message-ID: <CANVKczN_7mMii0fBbyM1QAUxzp2cm6SBUmpgrRSOJGWnqat9CQ@mail.gmail.com>

>> Locus1.gr <- as(Locus1.sp, 'SpatialGridDataFrame')
>
> The first four lines are ok, but the last one gives the following error:
>
> Error in asMethod(object, Class, value) : replace-coercion not allowed
>
> But if I run it on my computer it works. So, why it doesn?t work on a
> server? May be the ?spdep? package doesn't work in the same way on linux?

Its nothing to do with spdep because this is only using the sp package
and not spdep.

This is what we call a reproducible example:

 library(sp)
 d=data.frame(x=rep(1:4,4),y=rep(1:4,rep(4,4)),z=runif(16))
 coordinates(d)=~x+y
 d.sp=as(d,"SpatialPixels")
 d.gr=as(d.sp,"SpatialGridDataFrame")

and that works for me. Cut n paste it and see if it works for you.
Then tell us this:

> packageDescription("sp")
Package: sp
Version: 0.9-88
Date: 2011-09-14
[etc]

 I suspect that the version of R and sp is probably old on the server.
Server admins are lazy :)

Barry


From jon.skoien at jrc.ec.europa.eu  Thu Dec  1 18:14:38 2011
From: jon.skoien at jrc.ec.europa.eu (jon.skoien at jrc.ec.europa.eu)
Date: Thu, 01 Dec 2011 18:14:38 +0100
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <CANVKczN_7mMii0fBbyM1QAUxzp2cm6SBUmpgrRSOJGWnqat9CQ@mail.gmail.com>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
	<CANVKczN_7mMii0fBbyM1QAUxzp2cm6SBUmpgrRSOJGWnqat9CQ@mail.gmail.com>
Message-ID: <4ED7B5FE.7080805@jrc.ec.europa.eu>

On 01-Dec-11 17:28, Barry Rowlingson wrote:
> Its nothing to do with spdep because this is only using the sp package
> and not spdep.
>
> This is what we call a reproducible example:
>
>   library(sp)
>   d=data.frame(x=rep(1:4,4),y=rep(1:4,rep(4,4)),z=runif(16))
>   coordinates(d)=~x+y
>   d.sp=as(d,"SpatialPixels")
>   d.gr=as(d.sp,"SpatialGridDataFrame")
>
> and that works for me. Cut n paste it and see if it works for you.
> Then tell us this:
>
>> packageDescription("sp")
> Package: sp
> Version: 0.9-88
> Date: 2011-09-14
> [etc]
>

Then it actually seems to be an sp and/or R version problem.
Your example works for an old version on my Windows computer (R 2.12.1, 
sp_0.9-76), but not for the newest version (R 2.14.0, sp_0.9-91). It 
seems the old version didnt remove the data after the fourth line 
whereas the new version does.

Cheers,
Jon


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Global Environment Monitoring Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From r.hijmans at gmail.com  Thu Dec  1 18:28:24 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 1 Dec 2011 09:28:24 -0800
Subject: [R-sig-Geo] KED predictions using raster package
In-Reply-To: <04A370231C10664C88B28D1EF74F487901CB7A00@LOWEXPRESS.corp.cefas.co.uk>
References: <04A370231C10664C88B28D1EF74F487901CB7A00@LOWEXPRESS.corp.cefas.co.uk>
Message-ID: <CANtt_hyTa1i+nzLaWPaxWV=CWzTx0y8afGnZUAaAMua2DxbGoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111201/f931c73b/attachment.pl>

From Roger.Bivand at nhh.no  Thu Dec  1 18:41:17 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 1 Dec 2011 18:41:17 +0100 (CET)
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <4ED7B5FE.7080805@jrc.ec.europa.eu>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
	<CANVKczN_7mMii0fBbyM1QAUxzp2cm6SBUmpgrRSOJGWnqat9CQ@mail.gmail.com>
	<4ED7B5FE.7080805@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.00.1112011833430.10059@reclus.nhh.no>

On Thu, 1 Dec 2011, jon.skoien at jrc.ec.europa.eu wrote:

> On 01-Dec-11 17:28, Barry Rowlingson wrote:
>> Its nothing to do with spdep because this is only using the sp package
>> and not spdep.
>> 
>> This is what we call a reproducible example:
>>
>>   library(sp)
>>   d=data.frame(x=rep(1:4,4),y=rep(1:4,rep(4,4)),z=runif(16))
>>   coordinates(d)=~x+y
>>   d.sp=as(d,"SpatialPixels")
>>   d.gr=as(d.sp,"SpatialGridDataFrame")
>> 
>> and that works for me. Cut n paste it and see if it works for you.
>> Then tell us this:
>> 
>>> packageDescription("sp")
>> Package: sp
>> Version: 0.9-88
>> Date: 2011-09-14
>> [etc]
>> 
>
> Then it actually seems to be an sp and/or R version problem.
> Your example works for an old version on my Windows computer (R 2.12.1, 
> sp_0.9-76), but not for the newest version (R 2.14.0, sp_0.9-91). It seems 
> the old version didnt remove the data after the fourth line whereas the new 
> version does.

Yes, current 0.9-91 shows the reported behaviour, so the server is running 
the updated version, the local Windows machine is out of date. We have 
been trying to get the classes to inherit properly - earlier code stepped 
around things that either didn't work then, or we didn't grasp, in S4 
classes. In fact, doing:

d.sp=as(d,"SpatialPixels")
d.gr=as(d.sp,"SpatialGridDataFrame")

should fail, because d.sp has no attribute data, so cannot be coerced to 
SpatialGridDataFrame. This does work:

summary(d)
d.sp=as(d,"SpatialPixelsDataFrame")
d.gr=as(d.sp,"SpatialGridDataFrame")
summary(d.gr)

but Jon's suggestion is equally adeqate.

Roger

>
> Cheers,
> Jon
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karaka at ifc.cnr.it  Thu Dec  1 21:36:10 2011
From: karaka at ifc.cnr.it (Matilde Karakachoff)
Date: Thu, 01 Dec 2011 21:36:10 +0100
Subject: [R-sig-Geo] spdep and server
In-Reply-To: <alpine.LRH.2.00.1112011833430.10059@reclus.nhh.no>
References: <42562676e950a020d42eaae73d8a74c1@insm.isti.cnr.it>
	<CANVKczN_7mMii0fBbyM1QAUxzp2cm6SBUmpgrRSOJGWnqat9CQ@mail.gmail.com>
	<4ED7B5FE.7080805@jrc.ec.europa.eu>
	<alpine.LRH.2.00.1112011833430.10059@reclus.nhh.no>
Message-ID: <38021ca4bbc9a1f417c369adc9c17f4a@insm.isti.cnr.it>

Ok ok, thanks to all!

The "lazy" was me! The server admin updated R and packages two days 
ago, but not me!

R version on my Windows C is

R version 2.13.1 (2011-07-08)

and sp version

Package: sp
Version: 0.9-88
Date: 2011-09-14

I haven't access to server now, but I took note and I will run it next
monday.

Thankyou very much,
Matilde




On Thu, 01 Dec 2011 18:41:17 +0100 (CET), Roger Bivand wrote:

> On Thu, 1 Dec 2011, jon.skoien at jrc.ec.europa.eu [1]wrote:
>
>> On 01-Dec-11 17:28, Barry Rowlingson wrote:
>>
>>> Its nothing to do with spdep because this is only using the sp
>>> package and not spdep. This is what we call a reproducible example:
>>> library(sp)
>>> d=data.frame(x=rep(1:4,4),y=rep(1:4,rep(4,4)),z=runif(16))
>>> coordinates(d)=~x+y d.sp=as(d,"SpatialPixels")
>>> d.gr=as(d.sp,"SpatialGridDataFrame") and that works for me. Cut n
>>> paste it and see if it works for you. Then tell us this:
>>>
>>>> packageDescription("sp")
>>> Package: sp Version: 0.9-88 Date: 2011-09-14 [etc]
>> Then it actually seems to be an sp and/or R version problem. Your
>> example works for an old version on my Windows computer (R 2.12.1,
>> sp_0.9-76), but not for the newest version (R 2.14.0, sp_0.9-91). It
>> seems the old version didnt remove the data after the fourth line
>> whereas the new version does.
>
> Yes, current 0.9-91 shows the reported behaviour, so the server is
> running
> the updated version, the local Windows machine is out of date. We 
> have
> been trying to get the classes to inherit properly - earlier code
> stepped
> around things that either didn't work then, or we didn't grasp, in S4
> classes. In fact, doing:
>
> d.sp=as(d,"SpatialPixels")
> d.gr=as(d.sp,"SpatialGridDataFrame")
>
> should fail, because d.sp has no attribute data, so cannot be coerced 
> to
>
> SpatialGridDataFrame. This does work:
>
> summary(d)
> d.sp=as(d,"SpatialPixelsDataFrame")
> d.gr=as(d.sp,"SpatialGridDataFrame")
> summary(d.gr)
>
> but Jon's suggestion is equally adeqate.
>
> Roger
>
>> Cheers, Jon

-- 
Matilde Karakachoff
Istituto di Fisiologia Clinica
Pisa Italia


Links:
------
[1] mailto:jon.skoien at jrc.ec.europa.eu


From lyndon.estes at gmail.com  Fri Dec  2 02:55:33 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Thu, 1 Dec 2011 20:55:33 -0500
Subject: [R-sig-Geo] Getting vector index (i.e. layer number) for each cell
	in raster brick
Message-ID: <CALuVVab546xywNqL16w7H+Q_NB7_4eHOnskLid-aeiV6eWftbQ@mail.gmail.com>

Dear List,

I was hoping to get some advice on the best way to solve the following
problem given two raster bricks.

Given two bricks:

r.list <- lapply(1:20, function(x) {
 r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
 res(r) <- 0.1
 r[] <- runif(ncell(r))
 return(r)
})
rs1 <- stack(lapply(1:20, function(x) r.list[[x]]))
rb1 <- brick(rs1)  # Brick 1

r.list2 <- lapply(1:20, function(x) {
 r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
 res(r) <- 0.1
 r[] <- sample(1:7000, ncell(r), replace = T)
return(r)
})
rs2 <- stack(lapply(1:20, function(x) r.list2[[x]]))
rb2 <- brick(rs2)  # Brick 2

I am trying to figure out the best way to find, on a per pixel basis,
which layers of brick 1 contains the 10th percentile value, and then
retrieve the value for those layer from another brick 2.

I have gotten as far as using this function to get the quantile's
index for each pixel:

qfun <- function(x) {
  ind <- unname(which(x == quantile(x, 0.1, na.rm = T, type = 3)))
  ind[sample(length(ind))[1]]  # Get rid of ties
}

ind.r <- calc(rb1, fun = qfun)

The above gives me a raster indicating the layer number I need to
extract from brick 2.  However, I am not entirely sure how to access
the layers from there, or if I am even barking up the right tree.

The other alternative I thought of is this:

rst <- seq(1, nrow(rb1), by = nrow(rb1) / 7)
outvals <- lapply(1:length(rst), function(x) {
  j <- getValuesBlock(rb1, row = rst[x], nrows = 10)
  k <- getValuesBlock(rb2, row = rst[x], nrows = 10)
  inds <- unlist(apply(j, 1, function(y) {
   ind <- which(y == sort(y)[2])
   ind2 <- ind[sample(length(ind))[1]]  # Get rid of ties
   return(ind2)
  }))
  j2 <- j[, 1:ncol(j)][cbind(1:nrow(j), inds)]  # Select the correct
column/layer from j
  k2 <- k[, 1:ncol(k)][cbind(1:nrow(k), inds)]  # And from k
  list(j2, k2)
})

r1.q10 <- r.list[[1]] * 0
r2.q10 <- r.list[[1]] * 0

r1.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[1]]))  # 10th
percentile values from brick 1
r2.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[2]]))  #
Values from same layers as brick 1 10th %iles in brick 2

plot(r1.q10)
plot(r2.q10)

Although this *appears* to work, it seems to be unnecessarily
complicated for something that I am sure is done in a only a few
lines.

I will greatly appreciate any pointers for how to go about solving
this problem.

Many thanks, Lyndon


From r.hijmans at gmail.com  Fri Dec  2 06:10:54 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 1 Dec 2011 21:10:54 -0800
Subject: [R-sig-Geo] Getting vector index (i.e. layer number) for each
 cell in raster brick
In-Reply-To: <CALuVVab546xywNqL16w7H+Q_NB7_4eHOnskLid-aeiV6eWftbQ@mail.gmail.com>
References: <CALuVVab546xywNqL16w7H+Q_NB7_4eHOnskLid-aeiV6eWftbQ@mail.gmail.com>
Message-ID: <CANtt_hyr-WXDhwG2ZrAzoXEKN0czhg4EHNUvFuSgCmFF_6y9Hw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111201/bfc4caf8/attachment.pl>

From samanmonfared1 at gmail.com  Fri Dec  2 09:07:40 2011
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Fri, 2 Dec 2011 11:37:40 +0330
Subject: [R-sig-Geo] Getting vector index (i.e. layer number) for each
 cell in raster brick
In-Reply-To: <CANtt_hyr-WXDhwG2ZrAzoXEKN0czhg4EHNUvFuSgCmFF_6y9Hw@mail.gmail.com>
References: <CALuVVab546xywNqL16w7H+Q_NB7_4eHOnskLid-aeiV6eWftbQ@mail.gmail.com>
	<CANtt_hyr-WXDhwG2ZrAzoXEKN0czhg4EHNUvFuSgCmFF_6y9Hw@mail.gmail.com>
Message-ID: <CAOytA4aUPr5AYrZxkigv-pdVed=phwRUZSoWdr54y_3Foq1Qxg@mail.gmail.com>

Dear all
Can I use residual cokriging for some variables??
If yes,how??

On 12/2/11, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Hi Lyndon,
>
> I think there is a function for that:
>
> x <- stackSelect(rb2, ind.r)
>
> I.e., for each cell, use the value in ind.r to select the layer in rb2 from
> which to take the value for the output layer.
>
> Best, Robert
>
>
>
> On Thu, Dec 1, 2011 at 5:55 PM, Lyndon Estes <lyndon.estes at gmail.com> wrote:
>
>> Dear List,
>>
>> I was hoping to get some advice on the best way to solve the following
>> problem given two raster bricks.
>>
>> Given two bricks:
>>
>> r.list <- lapply(1:20, function(x) {
>>  r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
>>  res(r) <- 0.1
>>  r[] <- runif(ncell(r))
>>  return(r)
>> })
>> rs1 <- stack(lapply(1:20, function(x) r.list[[x]]))
>> rb1 <- brick(rs1)  # Brick 1
>>
>> r.list2 <- lapply(1:20, function(x) {
>>  r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
>>  res(r) <- 0.1
>>  r[] <- sample(1:7000, ncell(r), replace = T)
>> return(r)
>> })
>> rs2 <- stack(lapply(1:20, function(x) r.list2[[x]]))
>> rb2 <- brick(rs2)  # Brick 2
>>
>> I am trying to figure out the best way to find, on a per pixel basis,
>> which layers of brick 1 contains the 10th percentile value, and then
>> retrieve the value for those layer from another brick 2.
>>
>> I have gotten as far as using this function to get the quantile's
>> index for each pixel:
>>
>> qfun <- function(x) {
>>  ind <- unname(which(x == quantile(x, 0.1, na.rm = T, type = 3)))
>>  ind[sample(length(ind))[1]]  # Get rid of ties
>> }
>>
>> ind.r <- calc(rb1, fun = qfun)
>>
>> The above gives me a raster indicating the layer number I need to
>> extract from brick 2.  However, I am not entirely sure how to access
>> the layers from there, or if I am even barking up the right tree.
>>
>> The other alternative I thought of is this:
>>
>> rst <- seq(1, nrow(rb1), by = nrow(rb1) / 7)
>> outvals <- lapply(1:length(rst), function(x) {
>>  j <- getValuesBlock(rb1, row = rst[x], nrows = 10)
>>  k <- getValuesBlock(rb2, row = rst[x], nrows = 10)
>>  inds <- unlist(apply(j, 1, function(y) {
>>   ind <- which(y == sort(y)[2])
>>   ind2 <- ind[sample(length(ind))[1]]  # Get rid of ties
>>   return(ind2)
>>  }))
>>  j2 <- j[, 1:ncol(j)][cbind(1:nrow(j), inds)]  # Select the correct
>> column/layer from j
>>  k2 <- k[, 1:ncol(k)][cbind(1:nrow(k), inds)]  # And from k
>>  list(j2, k2)
>> })
>>
>> r1.q10 <- r.list[[1]] * 0
>> r2.q10 <- r.list[[1]] * 0
>>
>> r1.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[1]]))  # 10th
>> percentile values from brick 1
>> r2.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[2]]))  #
>> Values from same layers as brick 1 10th %iles in brick 2
>>
>> plot(r1.q10)
>> plot(r2.q10)
>>
>> Although this *appears* to work, it seems to be unnecessarily
>> complicated for something that I am sure is done in a only a few
>> lines.
>>
>> I will greatly appreciate any pointers for how to go about solving
>> this problem.
>>
>> Many thanks, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Saman Monfared
MSc. Student of statistics,
Department of science,
Shiraz university
Shiraz-Iran


From David.Stephens at cefas.co.uk  Fri Dec  2 11:55:54 2011
From: David.Stephens at cefas.co.uk (David Stephens (Cefas))
Date: Fri, 2 Dec 2011 10:55:54 -0000
Subject: [R-sig-Geo] KED predictions using raster package
In-Reply-To: <CANtt_hyTa1i+nzLaWPaxWV=CWzTx0y8afGnZUAaAMua2DxbGoA@mail.gmail.com>
References: <04A370231C10664C88B28D1EF74F487901CB7A00@LOWEXPRESS.corp.cefas.co.uk>
	<CANtt_hyTa1i+nzLaWPaxWV=CWzTx0y8afGnZUAaAMua2DxbGoA@mail.gmail.com>
Message-ID: <04A370231C10664C88B28D1EF74F487901CB7A05@LOWEXPRESS.corp.cefas.co.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111202/160867d6/attachment.pl>

From cristhine.arj at gmail.com  Fri Dec  2 12:23:39 2011
From: cristhine.arj at gmail.com (CRISTINA ARJONA)
Date: Fri, 2 Dec 2011 12:23:39 +0100
Subject: [R-sig-Geo] How to get the number of week with "zoo"
Message-ID: <CAKO7Wna2_rjFd-ToeSnP_ugE+6xXhD9Trusi0Um3q4EANVFRoQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111202/716d0da3/attachment.pl>

From ggrothendieck at gmail.com  Fri Dec  2 12:49:27 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 2 Dec 2011 06:49:27 -0500
Subject: [R-sig-Geo] How to get the number of week with "zoo"
In-Reply-To: <CAKO7Wna2_rjFd-ToeSnP_ugE+6xXhD9Trusi0Um3q4EANVFRoQ@mail.gmail.com>
References: <CAKO7Wna2_rjFd-ToeSnP_ugE+6xXhD9Trusi0Um3q4EANVFRoQ@mail.gmail.com>
Message-ID: <CAP01uRkWcYyWEbJ4ck_ktMG25_fKSquKo+JLezs7N=Mcp+XYOQ@mail.gmail.com>

On Fri, Dec 2, 2011 at 6:23 AM, CRISTINA ARJONA <cristhine.arj at gmail.com> wrote:
> Dear list,
>
> I have an object of class zoo and use time() to extract the times:
>> class(Equiwz2010)
> [1] "zoo"
>> a = time(Equiwz2010)
>
>
> How could I convert the elements of a to the week of the year
> as integers (between 1 and 52)?
>
> I've tried extracting the month and the day,
>> as.vector(days(a[30]))
> [1] "12"
>> as.vector(months(a[30]))
> [1] "diciembre"
>
> but cannot find the way of getting the month as an integer
> (i.e., 12 for the example above).
>

1. There are more than 52 weeks in a year since 7 * 52 = 364 whereas a
year has 365 or 366 days so the 1-52 part of your question is not
possible without doing things like redefining a week or dropping one
or two days in each  year.  Assuming we don't do that there are still
many ways to define week number and it can depend on what time class
you are using for the index of your zoo object but this will provide
the definition of week number given in ?strptime with Date class dates
and for certain other classes:

# create some test data: Jan1, Feb1, ..., Dec1
library(zoo)
z <- zoo(1:12, seq(as.Date("2011-01-01"), length = 12, by = "month"))

# calculate week numbers which start at 0
as.numeric(format(time(z), "%W"))

If you are willing to redefine the last week of the year as having
more than 7 days then you can force it into 1-52 as shown here:

http://r.789695.n4.nabble.com/Missing-data-td4097332.html


2. The other percent codes on the ?strptime page can get you other
components of the date, e.g. as.numeric(format(dd, "%m")) for month
number (1-12)  You can also use the components of as.POSIXlt, e.g.

> str(unclass(as.POSIXlt(time(z))))
List of 9
 $ sec  : num [1:12] 0 0 0 0 0 0 0 0 0 0 ...
 $ min  : int [1:12] 0 0 0 0 0 0 0 0 0 0 ...
 $ hour : int [1:12] 0 0 0 0 0 0 0 0 0 0 ...
 $ mday : int [1:12] 1 1 1 1 1 1 1 1 1 1 ...
 $ mon  : int [1:12] 0 1 2 3 4 5 6 7 8 9 ...
 $ year : int [1:12] 111 111 111 111 111 111 111 111 111 111 ...
 $ wday : int [1:12] 6 2 2 5 0 3 5 1 4 6 ...
 $ yday : int [1:12] 0 31 59 90 120 151 181 212 243 273 ...
 $ isdst: int [1:12] 0 0 0 0 0 0 0 0 0 0 ...
 - attr(*, "tzone")= chr "UTC"

> as.POSIXlt(time(z))$mon + 1
 [1]  1  2  3  4  5  6  7  8  9 10 11 12

See ?as.POSIXlt

Also read the article on dates and times in R News 4/1 and also look
at its references.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From janverbesselt at gmail.com  Fri Dec  2 13:58:26 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Fri, 2 Dec 2011 13:58:26 +0100
Subject: [R-sig-Geo] How to get the number of week with "zoo"
In-Reply-To: <CAKO7Wna2_rjFd-ToeSnP_ugE+6xXhD9Trusi0Um3q4EANVFRoQ@mail.gmail.com>
References: <CAKO7Wna2_rjFd-ToeSnP_ugE+6xXhD9Trusi0Um3q4EANVFRoQ@mail.gmail.com>
Message-ID: <2CD6DAD1-0549-4179-BE56-022E6B3CEDF8@gmail.com>

This is not a r-sig-geo question but r-help. Also, please create a reproducible example.
For now try;
?as.integer
dt <- as.Date("2007-03-01") # or
dt <- strptime("2007-03-01","%Y-%m-%d")
as.integer(format(dt,"%m"))
as.integer(format(dt,"%U"))
# etc.
%U
Week of the year as decimal number (00?53) using Sunday as the first day 1 of the week (and typically with the first Sunday of the year as day 1 of week 1). The US convention.



On 02/12/2011, at 12:23 PM, CRISTINA ARJONA wrote:

> Dear list,
> 
> I have an object of class zoo and use time() to extract the times:
>> class(Equiwz2010)
> [1] "zoo"
>> a = time(Equiwz2010)
> 
> 
> How could I convert the elements of a to the week of the year
> as integers (between 1 and 52)?
> 
> I've tried extracting the month and the day,
>> as.vector(days(a[30]))
> [1] "12"
>> as.vector(months(a[30]))
> [1] "diciembre"
> 
> but cannot find the way of getting the month as an integer
> (i.e., 12 for the example above).
> 
> Thanks!
> 
> *CRISTINA*
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From lyndon.estes at gmail.com  Fri Dec  2 15:30:16 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Fri, 2 Dec 2011 09:30:16 -0500
Subject: [R-sig-Geo] Getting vector index (i.e. layer number) for each
 cell in raster brick
In-Reply-To: <CANtt_hyr-WXDhwG2ZrAzoXEKN0czhg4EHNUvFuSgCmFF_6y9Hw@mail.gmail.com>
References: <CALuVVab546xywNqL16w7H+Q_NB7_4eHOnskLid-aeiV6eWftbQ@mail.gmail.com>
	<CANtt_hyr-WXDhwG2ZrAzoXEKN0czhg4EHNUvFuSgCmFF_6y9Hw@mail.gmail.com>
Message-ID: <CALuVVaYtiwe3fNaLca_7ze17Pc56jOq96P0ayo1o3oHO2B=7ow@mail.gmail.com>

Hi Robert,

Very many thanks, and I see the two hours I spent on that last night
would have been more profitably applied in the help files.

Cheers, Lyndon

On Fri, Dec 2, 2011 at 12:10 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Hi Lyndon,
>
> I think there is a function for that:
>
> x <- stackSelect(rb2, ind.r)
>
> I.e., for each cell, use the value in ind.r to select the layer in rb2 from
> which to take the value for the output layer.
>
> Best, Robert
>
>
>
> On Thu, Dec 1, 2011 at 5:55 PM, Lyndon Estes <lyndon.estes at gmail.com> wrote:
>>
>> Dear List,
>>
>> I was hoping to get some advice on the best way to solve the following
>> problem given two raster bricks.
>>
>> Given two bricks:
>>
>> r.list <- lapply(1:20, function(x) {
>> ?r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
>> ?res(r) <- 0.1
>> ?r[] <- runif(ncell(r))
>> ?return(r)
>> })
>> rs1 <- stack(lapply(1:20, function(x) r.list[[x]]))
>> rb1 <- brick(rs1) ?# Brick 1
>>
>> r.list2 <- lapply(1:20, function(x) {
>> ?r <- raster(xmn = 25, xmx = 32, ymn = -34, ymx = -27)
>> ?res(r) <- 0.1
>> ?r[] <- sample(1:7000, ncell(r), replace = T)
>> return(r)
>> })
>> rs2 <- stack(lapply(1:20, function(x) r.list2[[x]]))
>> rb2 <- brick(rs2) ?# Brick 2
>>
>> I am trying to figure out the best way to find, on a per pixel basis,
>> which layers of brick 1 contains the 10th percentile value, and then
>> retrieve the value for those layer from another brick 2.
>>
>> I have gotten as far as using this function to get the quantile's
>> index for each pixel:
>>
>> qfun <- function(x) {
>> ?ind <- unname(which(x == quantile(x, 0.1, na.rm = T, type = 3)))
>> ?ind[sample(length(ind))[1]] ?# Get rid of ties
>> }
>>
>> ind.r <- calc(rb1, fun = qfun)
>>
>> The above gives me a raster indicating the layer number I need to
>> extract from brick 2. ?However, I am not entirely sure how to access
>> the layers from there, or if I am even barking up the right tree.
>>
>> The other alternative I thought of is this:
>>
>> rst <- seq(1, nrow(rb1), by = nrow(rb1) / 7)
>> outvals <- lapply(1:length(rst), function(x) {
>> ?j <- getValuesBlock(rb1, row = rst[x], nrows = 10)
>> ?k <- getValuesBlock(rb2, row = rst[x], nrows = 10)
>> ?inds <- unlist(apply(j, 1, function(y) {
>> ? ind <- which(y == sort(y)[2])
>> ? ind2 <- ind[sample(length(ind))[1]] ?# Get rid of ties
>> ? return(ind2)
>> ?}))
>> ?j2 <- j[, 1:ncol(j)][cbind(1:nrow(j), inds)] ?# Select the correct
>> column/layer from j
>> ?k2 <- k[, 1:ncol(k)][cbind(1:nrow(k), inds)] ?# And from k
>> ?list(j2, k2)
>> })
>>
>> r1.q10 <- r.list[[1]] * 0
>> r2.q10 <- r.list[[1]] * 0
>>
>> r1.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[1]])) ?# 10th
>> percentile values from brick 1
>> r2.q10[] <- unlist(lapply(1:7, function(x) outvals[[x]][[2]])) ?#
>> Values from same layers as brick 1 10th %iles in brick 2
>>
>> plot(r1.q10)
>> plot(r2.q10)
>>
>> Although this *appears* to work, it seems to be unnecessarily
>> complicated for something that I am sure is done in a only a few
>> lines.
>>
>> I will greatly appreciate any pointers for how to go about solving
>> this problem.
>>
>> Many thanks, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From benweinstein2010 at gmail.com  Fri Dec  2 19:08:38 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Fri, 2 Dec 2011 13:08:38 -0500
Subject: [R-sig-Geo] fail to plot .img raster "Failure during IO"
Message-ID: <CAC28k7SdWZWLMHYea5uHJRc0OBn=o4kfcmXjFhuN69WScjFCkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111202/7e721a06/attachment.pl>

From k_jacobi at surf2000.de  Sun Dec  4 10:40:38 2011
From: k_jacobi at surf2000.de (k_jacobi at surf2000.de)
Date: Sun, 4 Dec 2011 10:40:38 +0100 (CET)
Subject: [R-sig-Geo] Problems with extracting data from GRIB files from "The
 NCEP Climate Forecast System Version 2 (CFSv2)"
Message-ID: <38068.202.154.241.199.1322991638.squirrel@webmail.surf2000.de>

For a model on estimating flows from snow melt, I need forecasts on
temperature and precipitation. Forecast data (12-hourly for the next 9
months) I find on ftp://ftpprd.ncep.noaa.gov/pub/data1/nccf/com/cfs/prod/,
The data are in grib2 format, and I can load each file as a rasterbrick
and extract forecasts for certain coordinates c(x,y) like that:

tmp_brick <- brick(gribfile)
t <- extract(tmp_brick, cellFromXY(tmp_brick, c(x,y))) # time series

Although the coordinates of my raster brick are bit strange I can live
with that:

> tmp_brick
class       : RasterBrick
dimensions  : 73, 144, 10512, 559  (nrow, ncol, ncell, nlayers)
resolution  : 2.5, 2.5  (x, y)
extent      : 0, 360, -92.5, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +a=6371200 +b=6371200 +no_defs

Unfortunately, the above mentioned url contains only forecasts for the
last 8 days. In order to verify the suitability of the data, I need to
precess historic forecasts (reforecasts).

I found something which looked initially promising under the url
http://nomads.ncdc.noaa.gov/data/cfsr-rfl-ts9/

I can load data as a raster brick, although coordinates are even more
strange from point of view of a GIS user:

class       : RasterBrick
dimensions  : 190, 384, 72960, 1200  (nrow, ncol, ncell, nlayers)
resolution  : 0.938, 0.9473684  (x, y)
extent      : 0, 360.192, 88.32963, 268.3296  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +a=6371229 +b=6371229 +no_defs

Also, I received the following warning from R

dec_jpeg2000: Unable to open JPEG2000 image within GRIB file.
Is the JPEG2000 driver available?

When I Try to extract values for a selected coordinate, the warning
repeats for each raster layer and the results either are either a vector
of 0 (precipitation rate) or strange figure around -60 for temperatures.

BTW, I can load and visualize the data with Open EV_WD (but trying to
export them has no effect).

Any help how to overcome this problem (including hints to data sources
that are easier to process) would be highly appreciated.

Klaus Jacobi


From bymanh at gmail.com  Sun Dec  4 13:50:39 2011
From: bymanh at gmail.com (Byman)
Date: Sun, 04 Dec 2011 13:50:39 +0100
Subject: [R-sig-Geo] Problems with extracting data from GRIB files from
 "The NCEP Climate Forecast System Version 2 (CFSv2)"
In-Reply-To: <38068.202.154.241.199.1322991638.squirrel@webmail.surf2000.de>
References: <38068.202.154.241.199.1322991638.squirrel@webmail.surf2000.de>
Message-ID: <4EDB6C9F.1080101@gmail.com>

Klaus

I think it is better to convert the grib2 files to NetCDF from grib, 
then use raster package in R (like you did) .

I hope this will help

Byman

On 12/4/2011 10:40 AM, k_jacobi at surf2000.de wrote:
> For a model on estimating flows from snow melt, I need forecasts on
> temperature and precipitation. Forecast data (12-hourly for the next 9
> months) I find on ftp://ftpprd.ncep.noaa.gov/pub/data1/nccf/com/cfs/prod/,
> The data are in grib2 format, and I can load each file as a rasterbrick
> and extract forecasts for certain coordinates c(x,y) like that:
>
> tmp_brick<- brick(gribfile)
> t<- extract(tmp_brick, cellFromXY(tmp_brick, c(x,y))) # time series
>
> Although the coordinates of my raster brick are bit strange I can live
> with that:
>
>> tmp_brick
> class       : RasterBrick
> dimensions  : 73, 144, 10512, 559  (nrow, ncol, ncell, nlayers)
> resolution  : 2.5, 2.5  (x, y)
> extent      : 0, 360, -92.5, 90  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +a=6371200 +b=6371200 +no_defs
>
> Unfortunately, the above mentioned url contains only forecasts for the
> last 8 days. In order to verify the suitability of the data, I need to
> precess historic forecasts (reforecasts).
>
> I found something which looked initially promising under the url
> http://nomads.ncdc.noaa.gov/data/cfsr-rfl-ts9/
>
> I can load data as a raster brick, although coordinates are even more
> strange from point of view of a GIS user:
>
> class       : RasterBrick
> dimensions  : 190, 384, 72960, 1200  (nrow, ncol, ncell, nlayers)
> resolution  : 0.938, 0.9473684  (x, y)
> extent      : 0, 360.192, 88.32963, 268.3296  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +a=6371229 +b=6371229 +no_defs
>
> Also, I received the following warning from R
>
> dec_jpeg2000: Unable to open JPEG2000 image within GRIB file.
> Is the JPEG2000 driver available?
>
> When I Try to extract values for a selected coordinate, the warning
> repeats for each raster layer and the results either are either a vector
> of 0 (precipitation rate) or strange figure around -60 for temperatures.
>
> BTW, I can load and visualize the data with Open EV_WD (but trying to
> export them has no effect).
>
> Any help how to overcome this problem (including hints to data sources
> that are easier to process) would be highly appreciated.
>
> Klaus Jacobi
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From lfelliott at hotmail.com  Sun Dec  4 15:48:05 2011
From: lfelliott at hotmail.com (LeRoy Elliott)
Date: Sun, 4 Dec 2011 14:48:05 +0000
Subject: [R-sig-Geo] assigning NA to layers in a brick
In-Reply-To: <mailman.13.1319709604.28370.r-sig-geo@r-project.org>
References: <mailman.13.1319709604.28370.r-sig-geo@r-project.org>
Message-ID: <SNT113-W435AF260B4285D75A577A0A6B40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111204/e5ab5bce/attachment.pl>

From r.hijmans at gmail.com  Sun Dec  4 19:00:34 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 4 Dec 2011 10:00:34 -0800
Subject: [R-sig-Geo] KED predictions using raster package
In-Reply-To: <04A370231C10664C88B28D1EF74F487901CB7A05@LOWEXPRESS.corp.cefas.co.uk>
References: <04A370231C10664C88B28D1EF74F487901CB7A00@LOWEXPRESS.corp.cefas.co.uk>
	<CANtt_hyTa1i+nzLaWPaxWV=CWzTx0y8afGnZUAaAMua2DxbGoA@mail.gmail.com>
	<04A370231C10664C88B28D1EF74F487901CB7A05@LOWEXPRESS.corp.cefas.co.uk>
Message-ID: <CANtt_hzYD=cnmDx604cBAYzCw34RHy2GjWYyBSQqCvsWy3FRJA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111204/c03e14d2/attachment.pl>

From r.hijmans at gmail.com  Sun Dec  4 19:06:02 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 4 Dec 2011 10:06:02 -0800
Subject: [R-sig-Geo] fail to plot .img raster "Failure during IO"
In-Reply-To: <CAC28k7SdWZWLMHYea5uHJRc0OBn=o4kfcmXjFhuN69WScjFCkg@mail.gmail.com>
References: <CAC28k7SdWZWLMHYea5uHJRc0OBn=o4kfcmXjFhuN69WScjFCkg@mail.gmail.com>
Message-ID: <CANtt_hyfFf6iN3iXp4=jp+E0MSVCfb6VffKtfPGGsKEkNSx3ow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111204/1fb05c06/attachment.pl>

From jhullman at umich.edu  Sun Dec  4 19:36:12 2011
From: jhullman at umich.edu (Jessica Ruth Hullman)
Date: Sun, 04 Dec 2011 13:36:12 -0500
Subject: [R-sig-Geo] expanding range in legend in spplot kriging
Message-ID: <f9f66faa6d9744d35394844ecaf635a1@umich.edu>


Hi,

I've been working with gstat and some of the kriging examples for an
experiment, such as using spplot() shown here:
http://casoilresource.lawr.ucdavis.edu/drupal/node/442. I'm using radon
values to create the regions.

What I want to do is change the range of the values in the legend so that
it is larger than the values that are actually shown in the map itself, but
without having to change/add any values to the data itself. It seems that
the legend is always created specific to the map. Is there a way to
manually change the range of values shown in the legend (while adding
cols/cuts)? Do I need to create a map that does have a value that goes as
high as I want, then somehow save the legend from this plot so I can reuse
it on subsequent plots? 

I've looked at the trellis settings to see if I could change it there, but
nothing jumps out as me. Any help on a good strategy would be appreciated,
thanks for your time.


From edzer.pebesma at uni-muenster.de  Sun Dec  4 19:50:29 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 04 Dec 2011 19:50:29 +0100
Subject: [R-sig-Geo] expanding range in legend in spplot kriging
In-Reply-To: <f9f66faa6d9744d35394844ecaf635a1@umich.edu>
References: <f9f66faa6d9744d35394844ecaf635a1@umich.edu>
Message-ID: <4EDBC0F5.9070301@uni-muenster.de>

Jessica, please try the at argument in spplot:

require(sp)
loadMeuse()
spplot(meuse.grid["dist"], at = seq(-1,2,length=20),
col.regions=bpy.colors())


On 12/04/2011 07:36 PM, Jessica Ruth Hullman wrote:
> 
> Hi,
> 
> I've been working with gstat and some of the kriging examples for an
> experiment, such as using spplot() shown here:
> http://casoilresource.lawr.ucdavis.edu/drupal/node/442. I'm using radon
> values to create the regions.
> 
> What I want to do is change the range of the values in the legend so that
> it is larger than the values that are actually shown in the map itself, but
> without having to change/add any values to the data itself. It seems that
> the legend is always created specific to the map. Is there a way to
> manually change the range of values shown in the legend (while adding
> cols/cuts)? Do I need to create a map that does have a value that goes as
> high as I want, then somehow save the legend from this plot so I can reuse
> it on subsequent plots? 
> 
> I've looked at the trellis settings to see if I could change it there, but
> nothing jumps out as me. Any help on a good strategy would be appreciated,
> thanks for your time.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From E.Couce.07 at bristol.ac.uk  Mon Dec  5 16:36:46 2011
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Mon, 5 Dec 2011 07:36:46 -0800 (PST)
Subject: [R-sig-Geo] Stippling
Message-ID: <1323099406633-7063274.post@n2.nabble.com>

Dear all,

is there a simple way to add stippling to a map? I have my data as a
SpatialGrid data frame, with a column for a prediction value and another for
its standard deviation. I create color maps from the prediction, and would
like to indicate which areas of the map are statistically significant
(prediction is greater than the standard deviation) by plotting regular dots
on top, similar to what they do in the plots b and d of the figure:
http://www.ipcc.ch/graphics/ar4-wg1/jpg/fig-10-18.jpg

Id appreciate any suggestion!

Best regards,
Elena

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Stippling-tp7063274p7063274.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Mon Dec  5 17:07:41 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 05 Dec 2011 17:07:41 +0100
Subject: [R-sig-Geo] Stippling
In-Reply-To: <1323099406633-7063274.post@n2.nabble.com>
References: <1323099406633-7063274.post@n2.nabble.com>
Message-ID: <4EDCEC4D.7000107@tum.de>

create a regular grid, subset it with over() and plot it with the sp.layout argument of spplot().

HTH,
Tom

Am 05.12.2011 16:36, schrieb ElenaC:
> Dear all,
>
> is there a simple way to add stippling to a map? I have my data as a
> SpatialGrid data frame, with a column for a prediction value and another for
> its standard deviation. I create color maps from the prediction, and would
> like to indicate which areas of the map are statistically significant
> (prediction is greater than the standard deviation) by plotting regular dots
> on top, similar to what they do in the plots b and d of the figure:
> http://www.ipcc.ch/graphics/ar4-wg1/jpg/fig-10-18.jpg
>
> Id appreciate any suggestion!
>
> Best regards,
> Elena
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Stippling-tp7063274p7063274.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From tom.gottfried at tum.de  Mon Dec  5 17:12:11 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 05 Dec 2011 17:12:11 +0100
Subject: [R-sig-Geo] Stippling
In-Reply-To: <1323099406633-7063274.post@n2.nabble.com>
References: <1323099406633-7063274.post@n2.nabble.com>
Message-ID: <4EDCED5B.9010007@tum.de>

Sorry, that was a bit too quick. To correct myself:

subset your grid based on the criterion you gave, convert it to SpatialPoints (gridded(grid) <- 
FALSE) and then plot it with the sp.layout argument to spplot().

Tom

Am 05.12.2011 16:36, schrieb ElenaC:
> Dear all,
>
> is there a simple way to add stippling to a map? I have my data as a
> SpatialGrid data frame, with a column for a prediction value and another for
> its standard deviation. I create color maps from the prediction, and would
> like to indicate which areas of the map are statistically significant
> (prediction is greater than the standard deviation) by plotting regular dots
> on top, similar to what they do in the plots b and d of the figure:
> http://www.ipcc.ch/graphics/ar4-wg1/jpg/fig-10-18.jpg
>
> Id appreciate any suggestion!
>
> Best regards,
> Elena
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Stippling-tp7063274p7063274.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From janverbesselt at gmail.com  Mon Dec  5 17:41:07 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Mon, 5 Dec 2011 17:41:07 +0100
Subject: [R-sig-Geo] =?iso-8859-1?q?how_to_set_projection_of_a_raster_to_P?=
	=?iso-8859-1?q?late-Carr=E9e_with_a_Geographic_Lat/Lon_representat?=
	=?iso-8859-1?q?ion_=28GCTP=5FGEO=29=2C_WGS_84?=
Message-ID: <CAHKDjo6jmLf64cTky5z=k2xM9sHLVM-nnBXOJxnZ14A-rc-q=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111205/ef01cdb3/attachment.pl>

From k_jacobi at surf2000.de  Mon Dec  5 19:18:43 2011
From: k_jacobi at surf2000.de (Klaus Jacobi)
Date: Mon, 5 Dec 2011 23:18:43 +0500
Subject: [R-sig-Geo] Problems with extracting data from GRIB files from
	"The NCEP Climate Forecast System Version 2 (CFSv2)"
Message-ID: <BE3845EF-E474-4C44-BAB2-F3E21E4FDB04@surf2000.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111205/b5bb27b4/attachment.pl>

From Matthias.demuzere at ees.kuleuven.be  Tue Dec  6 05:49:41 2011
From: Matthias.demuzere at ees.kuleuven.be (Matthias Demuzere)
Date: Tue, 06 Dec 2011 15:49:41 +1100
Subject: [R-sig-Geo] merge netcdf files with Raster (or other) package?
Message-ID: <4EDD9EE5.1060507@ees.kuleuven.be>

Hi all,

I have some large netcdf files that present 4 quadrants (that neatly fit
together) of a large domain (eg. NW, NE, SE, SW).
Let's assume for example that all the files contain the following
variables with dimensions:
      float A(lat, lon) ;
          A:units = "unitless" ;
          A:long_name = "none" ;
      float B(pft, lat, lon) ;
          B:units = "unitless" ;
          B:long_name = "nonet" ;
      float C(time, pft, lat, lon) ;
          C:units = "unitless" ;
          C:long_name = "none" ;
     float D(layers) ;
          D:long_name = "thickness" ;
          D:units = "m" ;
So as you can see, 4 variables (A, B, C and D) which all have different
dimensions (lat,lon), (pft,lat,lon), (time,pft,lat,lon) and (layers).
But these variables are the same over all 4 quadrants.

Now my question is whether there is an easy way to merge these 4
quadrants into 1 file, and write it out as a netcdf file again, with the
same metadata as the original files.

I have tried with the raster package (merge function), but it seems you
can only read 1 variable at the time (when reading .nc file with
raster())? Furthermore, raster() seems unable to deal with 1D variables
(as eg. D)?
The reason I would like to get it working with raster is that I like the
fact is handles large datasets really well.

So if anyone could point me in the right direction how to deal with this
properly, that would be great!

Kind regards,
Matthias

-- 
-------------------------------------------------------------
FWO Post-doctoral Research Fellow
School of Geography and Environmental Science
Monash University
Melbourne, Victoria
Australia
Matthias.Demuzere at monash.edu

Department of Earth&   Environmental Sciences
Physical and Regional Geography Research Group
Regional climate studies

Celestijnenlaan 200E
3001 Heverlee (Leuven)
BELGIUM

Tel: + 32 16 326424
Fax: + 32 16 322980
matthias.demuzere at ees.kuleuven.be
http://geo.kuleuven.be/aow/
www.kuleuven.be/geography


From sandra.werb at googlemail.com  Tue Dec  6 12:06:47 2011
From: sandra.werb at googlemail.com (sandra werb)
Date: Tue, 6 Dec 2011 12:06:47 +0100
Subject: [R-sig-Geo] Extracting informations from overlay
Message-ID: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/daa99e79/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Dec  6 12:45:48 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 06 Dec 2011 12:45:48 +0100
Subject: [R-sig-Geo] Extracting informations from overlay
In-Reply-To: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>
References: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>
Message-ID: <4EDE006C.2050906@uni-muenster.de>



On 12/06/2011 12:06 PM, sandra werb wrote:
> Dear all,
> 
> I am working with a Lidar dataset, which contains thousands of
> undistributed points. What I want to do is to count the number of points
> within a raster cell and extract this information. Not just as single
> numbers, but together with the ID or the coordinates of the raster. I came
> to this so far:
> 
> - Create an empty raster, all cells are 0
> 
> empty.r <- raster(nrows=733, ncols=732, xmn=-158, xmx=-121, ymn=-28.3,
> ymx=8.35, crs=NA)
> empty.r[] <- 0
> 
> - read in the dataset of points containing only xy information and define
> these as spatialpoints
> 
> r1_points <- read.table("09_16_B.txt", sep="\t", dec=".", header=F)
> p <- r1_points[,-3]
>  p<-SpatialPoints(data.frame(p))
> 
> - create an overlay of the raster and the spatial points and use function
> table to
> 
> o <- overlay(as(empty.r, "SpatialGrid"),p)
> tab <- table(o)

untried, from ?over:

g = as(empty.r, "SpatialGrid")
o = sapply(over(as(g, "SpatialPolygons"), p, returnList = TRUE), length)
gdf = SpatialGridDataFrame(g, data.frame(o = o))
spplot(gdf)

> 
> tab gives me the numbers of points within one cell, but I don't know how to
> get this information together with the ID or XY coordinates as one table or
> else. Can anyone help?
> 
> Thank you very much in advance!
> 
> Leni
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From E.Couce.07 at bristol.ac.uk  Tue Dec  6 17:15:25 2011
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Tue, 6 Dec 2011 08:15:25 -0800 (PST)
Subject: [R-sig-Geo] Stippling
In-Reply-To: <4EDCED5B.9010007@tum.de>
References: <1323099406633-7063274.post@n2.nabble.com>
	<4EDCED5B.9010007@tum.de>
Message-ID: <1323188125585-7067358.post@n2.nabble.com>

Thanks a lot, Tom,
that did the trick!

Cheers
Elena

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Stippling-tp7063274p7067358.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sandra.werb at googlemail.com  Tue Dec  6 17:17:25 2011
From: sandra.werb at googlemail.com (sandra werb)
Date: Tue, 6 Dec 2011 17:17:25 +0100
Subject: [R-sig-Geo] Extracting informations from overlay
In-Reply-To: <4EDE006C.2050906@uni-muenster.de>
References: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>
	<4EDE006C.2050906@uni-muenster.de>
Message-ID: <CAMJxNtxHJUu1wFAFgfVUb5-MubfZXYuz5Z0a8ntb9dXvP7Nu-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/2776e30b/attachment.pl>

From giohappy at gmail.com  Tue Dec  6 17:41:31 2011
From: giohappy at gmail.com (G. Allegri)
Date: Tue, 6 Dec 2011 17:41:31 +0100
Subject: [R-sig-Geo] constrained (cost based) point interpolation options?
Message-ID: <CAB4g1=zsXKb_8=9fJBMeX059BvSC8HC+Zky24O8zo_HB9SavUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/a9c66c41/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Dec  6 18:20:57 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 06 Dec 2011 18:20:57 +0100
Subject: [R-sig-Geo] Extracting informations from overlay
In-Reply-To: <CAMJxNtxHJUu1wFAFgfVUb5-MubfZXYuz5Z0a8ntb9dXvP7Nu-g@mail.gmail.com>
References: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>
	<4EDE006C.2050906@uni-muenster.de>
	<CAMJxNtxHJUu1wFAFgfVUb5-MubfZXYuz5Z0a8ntb9dXvP7Nu-g@mail.gmail.com>
Message-ID: <4EDE4EF9.1040708@uni-muenster.de>



On 12/06/2011 05:17 PM, sandra werb wrote:
> 
> 
> 2011/12/6 Edzer Pebesma <edzer.pebesma at uni-muenster.de
> <mailto:edzer.pebesma at uni-muenster.de>>
> 
> 
> 
>     On 12/06/2011 12:06 PM, sandra werb wrote:
>     > Dear all,
>     >
>     > I am working with a Lidar dataset, which contains thousands of
>     > undistributed points. What I want to do is to count the number of
>     points
>     > within a raster cell and extract this information. Not just as single
>     > numbers, but together with the ID or the coordinates of the
>     raster. I came
>     > to this so far:
>     >
>     > - Create an empty raster, all cells are 0
>     >
>     > empty.r <- raster(nrows=733, ncols=732, xmn=-158, xmx=-121, ymn=-28.3,
>     > ymx=8.35, crs=NA)
>     > empty.r[] <- 0
>     >
>     > - read in the dataset of points containing only xy information and
>     define
>     > these as spatialpoints
>     >
>     > r1_points <- read.table("09_16_B.txt", sep="\t", dec=".", header=F)
>     > p <- r1_points[,-3]
>     >  p<-SpatialPoints(data.frame(p))
>     >
>     > - create an overlay of the raster and the spatial points and use
>     function
>     > table to
>     >
>     > o <- overlay(as(empty.r, "SpatialGrid"),p)
>     > tab <- table(o)
> 
>     untried, from ?over:
> 
>     g = as(empty.r, "SpatialGrid")
>     o = sapply(over(as(g, "SpatialPolygons"), p, returnList = TRUE), length)
>     gdf = SpatialGridDataFrame(g, data.frame(o = o))
>     spplot(gdf)
> 
> 
> Thanks, this works. When I sum up the counts within the overlay I get a
> number that is higher than the points I have in the dataset. Might it be
> the case that points, which lie on/very close to boundaries of the cells
> are counted twice?

Yes, that must be the case. (Maybe shifting all your points with 1 mm or
so helps?)

>  
> 
> 
>     >
>     > tab gives me the numbers of points within one cell, but I don't
>     know how to
>     > get this information together with the ID or XY coordinates as one
>     table or
>     > else. Can anyone help?
>     >
>     > Thank you very much in advance!
>     >
>     > Leni
>     >
>     >       [[alternative HTML version deleted]]
>     >
>     > _______________________________________________
>     > R-sig-Geo mailing list
>     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
>     --
>     Edzer Pebesma
>     Institute for Geoinformatics (ifgi), University of M?nster
>     Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>     8333081, Fax: +49 251 8339763 <tel:%2B49%20251%208339763>
>      http://ifgi.uni-muenster.de
>     http://www.52north.org/geostatistics      e.pebesma at wwu.de
>     <mailto:e.pebesma at wwu.de>
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gildas.mazo at inria.fr  Tue Dec  6 19:14:36 2011
From: gildas.mazo at inria.fr (Gildas Mazo)
Date: Tue, 6 Dec 2011 19:14:36 +0100 (CET)
Subject: [R-sig-Geo] geoR, Kriging, non-standard models
In-Reply-To: <841066106.1268364.1323194980623.JavaMail.root@zmbs2.inria.fr>
Message-ID: <1293572995.1268396.1323195276360.JavaMail.root@zmbs2.inria.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/f1806092/attachment.pl>

From r.hijmans at gmail.com  Tue Dec  6 19:44:52 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Dec 2011 10:44:52 -0800
Subject: [R-sig-Geo] Extracting informations from overlay
In-Reply-To: <4EDE4EF9.1040708@uni-muenster.de>
References: <CAMJxNtyJS4z+hDGjvo+z1gHH09Hget4U16387DD64ejzYO4ZMQ@mail.gmail.com>
	<4EDE006C.2050906@uni-muenster.de>
	<CAMJxNtxHJUu1wFAFgfVUb5-MubfZXYuz5Z0a8ntb9dXvP7Nu-g@mail.gmail.com>
	<4EDE4EF9.1040708@uni-muenster.de>
Message-ID: <CANtt_hzgo6WmsbgT6qf5x54BekFH+aLpAKgXxTMDRa=as5O6DA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/9dcf8892/attachment.pl>

From r.hijmans at gmail.com  Tue Dec  6 20:00:17 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Dec 2011 11:00:17 -0800
Subject: [R-sig-Geo]
	=?iso-8859-1?q?how_to_set_projection_of_a_raster_to_P?=
	=?iso-8859-1?q?late-Carr=E9e_with_a_Geographic_Lat/Lon_representat?=
	=?iso-8859-1?q?ion_=28GCTP=5FGEO=29=2C_WGS_84?=
In-Reply-To: <CAHKDjo6jmLf64cTky5z=k2xM9sHLVM-nnBXOJxnZ14A-rc-q=Q@mail.gmail.com>
References: <CAHKDjo6jmLf64cTky5z=k2xM9sHLVM-nnBXOJxnZ14A-rc-q=Q@mail.gmail.com>
Message-ID: <CANtt_hwvnBobwXZ-oh-1gUeX9NFw00tYejnxyfDX7WT2Gne_Yw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/ad9f59dd/attachment.pl>

From jsbarret at sfu.ca  Wed Dec  7 00:48:33 2011
From: jsbarret at sfu.ca (Jenn.B)
Date: Tue, 6 Dec 2011 15:48:33 -0800 (PST)
Subject: [R-sig-Geo] Import raster from ArcGIS - mismatch between original
 GRID and raster in R
Message-ID: <1323215313501-7068880.post@n2.nabble.com>

Hi everyone,

I'm an advanced ArcGIS user, but new to doing all things spatial in R (I
typically only use R for graphing and regressions). That said:

I've written some code to calculate shortest paths between nest sites and
foraging locations, following water only (water coded as 1, all other cells
= 0) The loop works fine; however, my problem is in the initial import of
the GRID into R using raster(). 

In running my loop, I received the error: 

"In get.shortest.paths(adjacencyGraph, indexOrigin, indexGoal) :
At structural_properties.c:4277 :Couldn't reach some vertices"

for one of my nests, which I understand to mean that the particular nest and
foraging location that the loop is currently processing are not connected.
However, they ARE connected in my ArcGIS GRID (i.e., they both lie on water
cells with no gaps between them). After a little investigating I noticed
that the GRID gets resampled when imported into R, such that my location,
which is near land, now falls on land (and thus not on a value cell).  How
can I avoid this? Is there some argument I can apply to "snap" the raster to
the original GRID? This is a serious problem, as I imagine I'll encounter
the same issue for other nests and foraging locations that the loop has yet
to process. 

The code for one nest and location looks like:

library(gdistance)
library(maptools)

# Import raster layer - ocean + freshwater = 1, land = NoData
r.CS<- raster ("C:/myfile")

# Create transition layer

t.CS<- transition(r.CS, transitionFunction=mean, directions=16)
tc.CS<- geoCorrection(t.CS)

# Import nest and forage locations

setwd("C:/ForR")
nest1<-read.csv("nest1.csv")
radio1<-read.csv("radio1.csv")

# Extract X and Y 
nestXY<- cbind(nest1$X, nest1$Y)
radioXY<-cbind(radio1$X, radio1$Y)

# Create Spatial Points objects - for radio, just do first location for
testing...
SpRadio<-SpatialPoints(radioXY)
SpRadio

SpNest<-SpatialPoints(nestXY)

#Calculate the shortest path
sPathL<-shortestPath(tc.CS, SpNest, SpRadio, output="SpatialLines")
distance<-SpatialLinesLengths(sPathL, longlat=FALSE)

Apologies if any of this is unclear. If you're interested in the loop, I can
post that as well - it basically just involves a bunch of subsetting and
writing outputs for different nests to different files.

Cheers,
Jenn



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Import-raster-from-ArcGIS-mismatch-between-original-GRID-and-raster-in-R-tp7068880p7068880.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Dec  7 08:06:34 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Dec 2011 23:06:34 -0800
Subject: [R-sig-Geo] merge netcdf files with Raster (or other) package?
In-Reply-To: <4EDD9EE5.1060507@ees.kuleuven.be>
References: <4EDD9EE5.1060507@ees.kuleuven.be>
Message-ID: <CANtt_hxf8wTW7x1eV6Si1VD+i6wcgLQj8H_0zduWV-vYCQcy6g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111206/a1dcde2a/attachment.pl>

From r.m.krug at gmail.com  Wed Dec  7 10:01:45 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Wed, 07 Dec 2011 10:01:45 +0100
Subject: [R-sig-Geo] Import raster from ArcGIS - mismatch between
 original GRID and raster in R
In-Reply-To: <1323215313501-7068880.post@n2.nabble.com>
References: <1323215313501-7068880.post@n2.nabble.com>
Message-ID: <4EDF2B79.6090100@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 07/12/11 00:48, Jenn.B wrote:
> Hi everyone,
> 
> I'm an advanced ArcGIS user, but new to doing all things spatial in
> R (I typically only use R for graphing and regressions). That
> said:
> 
> I've written some code to calculate shortest paths between nest
> sites and foraging locations, following water only (water coded as
> 1, all other cells = 0) The loop works fine; however, my problem is
> in the initial import of the GRID into R using raster().
> 
> In running my loop, I received the error:
> 
> "In get.shortest.paths(adjacencyGraph, indexOrigin, indexGoal) : At
> structural_properties.c:4277 :Couldn't reach some vertices"
> 
> for one of my nests, which I understand to mean that the particular
> nest and foraging location that the loop is currently processing
> are not connected. However, they ARE connected in my ArcGIS GRID
> (i.e., they both lie on water cells with no gaps between them).
> After a little investigating I noticed that the GRID gets resampled
> when imported into R, such that my location, which is near land,
> now falls on land (and thus not on a value cell).  How can I avoid
> this? Is there some argument I can apply to "snap" the raster to 
> the original GRID? This is a serious problem, as I imagine I'll
> encounter the same issue for other nests and foraging locations
> that the loop has yet to process.

Where does the "resampling" occur, because as far as I am aware, an
import does not do any resampling.

I would suggest to track down where in your code this occurs.

Just to be save: what about projections - are they the same?

Also: try something like qgis or GRASS to visualize your data and see
if they are as you expect them to be.

Also: can you provide a subset of your data (the site which is on land
but should be on water, and the underlying clipped raster map) so that
the example is reproducible?

Cheers,

Rainer

> 
> The code for one nest and location looks like:
> 
> library(gdistance) library(maptools)
> 
> # Import raster layer - ocean + freshwater = 1, land = NoData 
> r.CS<- raster ("C:/myfile")
> 
> # Create transition layer
> 
> t.CS<- transition(r.CS, transitionFunction=mean, directions=16) 
> tc.CS<- geoCorrection(t.CS)
> 
> # Import nest and forage locations
> 
> setwd("C:/ForR") nest1<-read.csv("nest1.csv") 
> radio1<-read.csv("radio1.csv")
> 
> # Extract X and Y nestXY<- cbind(nest1$X, nest1$Y) 
> radioXY<-cbind(radio1$X, radio1$Y)
> 
> # Create Spatial Points objects - for radio, just do first location
> for testing... SpRadio<-SpatialPoints(radioXY) SpRadio
> 
> SpNest<-SpatialPoints(nestXY)
> 
> #Calculate the shortest path sPathL<-shortestPath(tc.CS, SpNest,
> SpRadio, output="SpatialLines") 
> distance<-SpatialLinesLengths(sPathL, longlat=FALSE)
> 
> Apologies if any of this is unclear. If you're interested in the
> loop, I can post that as well - it basically just involves a bunch
> of subsetting and writing outputs for different nests to different
> files.
> 
> Cheers, Jenn
> 
> 
> 
> -- View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Import-raster-from-ArcGIS-mismatch-between-original-GRID-and-raster-in-R-tp7068880p7068880.html
>
> 
Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7fK3kACgkQoYgNqgF2egqqHACeKOhX7UqT093oGZc6sdosJpgB
XEMAn2y7UFx19D9RKbGxwvZo5sehJk+b
=2+GL
-----END PGP SIGNATURE-----


From b.rowlingson at lancaster.ac.uk  Wed Dec  7 11:14:08 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 7 Dec 2011 10:14:08 +0000
Subject: [R-sig-Geo] Import raster from ArcGIS - mismatch between
 original GRID and raster in R
In-Reply-To: <1323215313501-7068880.post@n2.nabble.com>
References: <1323215313501-7068880.post@n2.nabble.com>
Message-ID: <CANVKczNTf=9nMMeYYQanOvyMPBZDpgNgbUUvQXRQ9pyuzrP7Xg@mail.gmail.com>

On Tue, Dec 6, 2011 at 11:48 PM, Jenn.B <jsbarret at sfu.ca> wrote:

>  After a little investigating I noticed
> that the GRID gets resampled when imported into R, such that my location,
> which is near land, now falls on land (and thus not on a value cell). ?How
> can I avoid this? Is there some argument I can apply to "snap" the raster to
> the original GRID? This is a serious problem, as I imagine I'll encounter

>
> # Import raster layer - ocean + freshwater = 1, land = NoData
> r.CS<- raster ("C:/myfile")

 I think you need to see what r.CS is here, and compare it to your
ArcGIS raster. What does summary(r.CS), or even print(r.CS), give -
then compare that to whatever ArcGIS' summary function spits out -
dimensions, bounding boxes etc. They should be the same. Ditto your
transition matrix.

 One thing you might not have noticed is that big rasters get
downsampled when _plotting_ - so you might see a point on 'land' which
is really on water once you've zoomed in far enough to see the cells.
The raster package 'zoom' function is very handy in this respect. Zoom
and add your points (with the points function) until you can really
see the cells.

 Check the raster in R is really at the coordinates it says it is.
Sometimes rasters get aligned to their cell edges instead of cell
centres (or vice versa). Zoom in on the corners and check the edges.
Adding axes (axis(1);axis(2)) helps for visual reference, and adding
vertical and horizontal lines (abline(h=XX) and abline(v=XX)) helps
too.

 Of course it may end up that your point is right on a cell boundary
and a minor arithmetic calculation difference between ArcGIS and R is
putting this coordinate on land! (what sort of bird nests on water
anyway?)

Barry


From spareeth at gmail.com  Wed Dec  7 12:46:00 2011
From: spareeth at gmail.com (sajid pareeth)
Date: Wed, 7 Dec 2011 17:16:00 +0530
Subject: [R-sig-Geo] Zonal stats using raster on netcdf files
Message-ID: <CAO7vHBHy0Sh-cDfK4KTtfwBNvaX4G-qkxC3F2aAc2gHuRzQSpA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111207/190074b1/attachment.pl>

From r.hijmans at gmail.com  Wed Dec  7 18:25:00 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 7 Dec 2011 09:25:00 -0800
Subject: [R-sig-Geo] Zonal stats using raster on netcdf files
In-Reply-To: <CAO7vHBHy0Sh-cDfK4KTtfwBNvaX4G-qkxC3F2aAc2gHuRzQSpA@mail.gmail.com>
References: <CAO7vHBHy0Sh-cDfK4KTtfwBNvaX4G-qkxC3F2aAc2gHuRzQSpA@mail.gmail.com>
Message-ID: <CANtt_hzEYb7cHoGPJBtuOHFT9ccQZyjpyPv9_qbke3ZGnEor0w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111207/979a7ab6/attachment.pl>

From spareeth at gmail.com  Wed Dec  7 19:21:11 2011
From: spareeth at gmail.com (sajid pareeth)
Date: Wed, 7 Dec 2011 23:51:11 +0530
Subject: [R-sig-Geo] Zonal stats using raster on netcdf files
In-Reply-To: <CANtt_hzEYb7cHoGPJBtuOHFT9ccQZyjpyPv9_qbke3ZGnEor0w@mail.gmail.com>
References: <CAO7vHBHy0Sh-cDfK4KTtfwBNvaX4G-qkxC3F2aAc2gHuRzQSpA@mail.gmail.com>
	<CANtt_hzEYb7cHoGPJBtuOHFT9ccQZyjpyPv9_qbke3ZGnEor0w@mail.gmail.com>
Message-ID: <CAO7vHBFZT8dWyRNRTZhdQ=8a0AgiEuP+PSDoCkxdBN_qS3bhdQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111207/1af79597/attachment.pl>

From jsbarret at sfu.ca  Wed Dec  7 20:01:32 2011
From: jsbarret at sfu.ca (Jenn.B)
Date: Wed, 7 Dec 2011 11:01:32 -0800 (PST)
Subject: [R-sig-Geo] Import raster from ArcGIS - mismatch between
 original GRID and raster in R
In-Reply-To: <CANVKczNTf=9nMMeYYQanOvyMPBZDpgNgbUUvQXRQ9pyuzrP7Xg@mail.gmail.com>
References: <1323215313501-7068880.post@n2.nabble.com>
	<CANVKczNTf=9nMMeYYQanOvyMPBZDpgNgbUUvQXRQ9pyuzrP7Xg@mail.gmail.com>
Message-ID: <1323284492225-7071696.post@n2.nabble.com>

Thanks for your quick replies!

Okay - Barry, you are right in that I was "mislead" by the raster plot in R.
I had used the plot() function to examine the raster, transition layer and
geocorrected transition layers in R, followed by points(), and found that,
based on the plot (I exported to .pdf), the point where the error occured
was now on land and that the raster looked to be resampled (or rather
'downsampled' as you correctly point out). Exporting the rasters above to
ascii files and opening them in ArcGIS shows that this is indeed just
associated with the R plotting and that the rasters are in fact identical to
the one I imported. Likewise if I used the zoom() function. So that's good. 

However, I'm now totally puzzled as to why I'm getting this error. Note that
the code is running fine and producing good results for other nests, and for
other foraging locations associated with this nest. All files have the same
projection (NAD1983 Albers). This is actually the 24th nest, and the 41st
foraging point for the 24th nest - all points before this are processed just
fine. As a side note - the birds nest on land, but forage on the water, and
tend to follow waterways (i.e., streams and then ocean) to access foraging
sites and nests, rather than flying over land.

I've attached .csv files of the nest and the location, as well as the raster
file. A simplified code to use just these files is below. I've also attached
a .pdf exported from ArcGIS that shows the route is connected (note that
both the location and the nest are on value pixels). 

Thanks,
Jenn

CODE:
r.CS<- raster ("C:/ForR/ds_ocfly75f") 

plot(r.CS, useRaster=TRUE)

# Create transition layer

t.CS<- transition(r.CS, transitionFunction=mean, directions=16)

# Correct values for distortion

tc.CS<- geoCorrection(t.CS)

# Import nest and forage location

setwd("C:/ForR")
nest1<-read.csv("nest.csv")
radio1<-read.csv("forageloc.csv")

nestXY<- cbind(nest1$X_COORD, nest1$Y_COORD)
radioXY<-cbind(radio1$X_COORD, radio1$Y_COORD)

nestXY
radioXY

SpRadio<-SpatialPoints(radioXY)
SpRadio

SpNest<-SpatialPoints(nestXY)
SpNest

sPathL<-shortestPath(tc.CS, SpNest, SpRadio, output="SpatialLines")

# (line above is where I get the error msg)

http://r-sig-geo.2731867.n2.nabble.com/file/n7071696/nest.csv nest.csv 
http://r-sig-geo.2731867.n2.nabble.com/file/n7071696/forageloc.csv
forageloc.csv 
http://r-sig-geo.2731867.n2.nabble.com/file/n7071696/ds_ocfly75f.zip
ds_ocfly75f.zip 
http://r-sig-geo.2731867.n2.nabble.com/file/n7071696/MapNestForageLoc.pdf
MapNestForageLoc.pdf 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Import-raster-from-ArcGIS-mismatch-between-original-GRID-and-raster-in-R-tp7068880p7071696.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From frippe12573 at hotmail.com  Wed Dec  7 20:35:55 2011
From: frippe12573 at hotmail.com (Eugenio Trumpy)
Date: Wed, 7 Dec 2011 19:35:55 +0000
Subject: [R-sig-Geo] (no subject)
Message-ID: <DUB108-W475F57F884F6F50C6AD14AE5BB0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111207/a781bfdc/attachment.pl>

From jsbarret at sfu.ca  Wed Dec  7 20:39:02 2011
From: jsbarret at sfu.ca (Jenn.B)
Date: Wed, 7 Dec 2011 11:39:02 -0800 (PST)
Subject: [R-sig-Geo] Import raster from ArcGIS - mismatch between
 original GRID and raster in R
In-Reply-To: <1323284492225-7071696.post@n2.nabble.com>
References: <1323215313501-7068880.post@n2.nabble.com>
	<CANVKczNTf=9nMMeYYQanOvyMPBZDpgNgbUUvQXRQ9pyuzrP7Xg@mail.gmail.com>
	<1323284492225-7071696.post@n2.nabble.com>
Message-ID: <1323286742051-7071852.post@n2.nabble.com>

An update:

Ok - now that I knew it wasn't the raster that had been 'downsampled', I
looked more closely at the points in R, using zoom() as Barry suggested, and
it is the point that is in the incorrect spot. A stupid, stupid error on my
part as I didn't update the X_COORDS after snapping them to the nearest
ocean (an adjustment I had to make for some foraging locs that, due to
resolution, fell slightly on land). Upon receiving the error and examining
the plot, it seemed obvious that the problem was the raster - and hence I
didn't examine the points. Crud. This is what happend when you rush things.

Thanks for the tip Barry - and for the zoom() function - very helpful! 

Cheers,
Jenn

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Import-raster-from-ArcGIS-mismatch-between-original-GRID-and-raster-in-R-tp7068880p7071852.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jose.matos at epfl.ch  Wed Dec  7 21:29:52 2011
From: jose.matos at epfl.ch (=?ISO-8859-1?Q?Jos=E9_Matos?=)
Date: Wed, 07 Dec 2011 20:29:52 +0000
Subject: [R-sig-Geo] Local singularity
In-Reply-To: <4EDFC1FB.8070707@epfl.ch>
References: <4EDFC1FB.8070707@epfl.ch>
Message-ID: <4EDFCCC0.9@epfl.ch>

Dear All,

I'm testing different interpolation settings and methods for a rainfall
field. From the complete field I take some points, perform the
interpolation and then compute the errors. The variogram was computed
for the original data.
While trying local neighborhoods, I got some unexpected results and am
fairly confident that I'm doing something wrong, although I not sure
about what it is.

It is as if outside the predetermined radius, gstat is computing the 
estimate gathering points up to the predefined minimum but without the 
closest point.

One of the command sets I used (made to enhance this effect) was the 
following:
data(TRMM): 'dataKrig', x=1, y=2, v=3, radius=2, min=4, max=4, force;
predictions(TRMM): 'predKrig';
mask: 'maskKrig.asc';
variogram(TRMM):   0.00000401 Nug(0) + 1232.26185112 Pow(0.54167,0,1);

A more elaborate description and all the files used to run gstat can be 
found at:
https://documents.epfl.ch/users/g/ga/gamito/www/gstat/gstatHelp.zip

All help on this issue is much appreciated.

Thank you in advance.

Kind regards,
Jos? Matos


From edzer.pebesma at uni-muenster.de  Wed Dec  7 21:43:27 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Dec 2011 21:43:27 +0100
Subject: [R-sig-Geo] Local singularity
In-Reply-To: <4EDFCCC0.9@epfl.ch>
References: <4EDFC1FB.8070707@epfl.ch> <4EDFCCC0.9@epfl.ch>
Message-ID: <4EDFCFEF.3020407@uni-muenster.de>

Jos?,

you're sending this message to the wrong list, as it has nothing to do
with R -- it seems you are using gstat stand-alone, a program that
predates the gstat R package. The more appropriate list would be

http://list.52north.org/mailman/listinfo/geostatistics

With best regards,

On 12/07/2011 09:29 PM, Jos? Matos wrote:
> Dear All,
> 
> I'm testing different interpolation settings and methods for a rainfall
> field. From the complete field I take some points, perform the
> interpolation and then compute the errors. The variogram was computed
> for the original data.
> While trying local neighborhoods, I got some unexpected results and am
> fairly confident that I'm doing something wrong, although I not sure
> about what it is.
> 
> It is as if outside the predetermined radius, gstat is computing the
> estimate gathering points up to the predefined minimum but without the
> closest point.
> 
> One of the command sets I used (made to enhance this effect) was the
> following:
> data(TRMM): 'dataKrig', x=1, y=2, v=3, radius=2, min=4, max=4, force;
> predictions(TRMM): 'predKrig';
> mask: 'maskKrig.asc';
> variogram(TRMM):   0.00000401 Nug(0) + 1232.26185112 Pow(0.54167,0,1);
> 
> A more elaborate description and all the files used to run gstat can be
> found at:
> https://documents.epfl.ch/users/g/ga/gamito/www/gstat/gstatHelp.zip
> 
> All help on this issue is much appreciated.
> 
> Thank you in advance.
> 
> Kind regards,
> Jos? Matos
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Matthias.demuzere at ees.kuleuven.be  Thu Dec  8 00:18:27 2011
From: Matthias.demuzere at ees.kuleuven.be (Matthias Demuzere)
Date: Thu, 08 Dec 2011 10:18:27 +1100
Subject: [R-sig-Geo] merge netcdf files with Raster (or other) package?
In-Reply-To: <CANtt_hxf8wTW7x1eV6Si1VD+i6wcgLQj8H_0zduWV-vYCQcy6g@mail.gmail.com>
References: <4EDD9EE5.1060507@ees.kuleuven.be>
	<CANtt_hxf8wTW7x1eV6Si1VD+i6wcgLQj8H_0zduWV-vYCQcy6g@mail.gmail.com>
Message-ID: <4EDFF443.6050403@ees.kuleuven.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/fbd4cb3b/attachment.pl>

From friedman.steve at gmail.com  Thu Dec  8 00:48:34 2011
From: friedman.steve at gmail.com (Steve Friedman)
Date: Wed, 7 Dec 2011 18:48:34 -0500
Subject: [R-sig-Geo] merge netcdf files with Raster (or other) package?
In-Reply-To: <4EDFF443.6050403@ees.kuleuven.be>
References: <4EDD9EE5.1060507@ees.kuleuven.be>
	<CANtt_hxf8wTW7x1eV6Si1VD+i6wcgLQj8H_0zduWV-vYCQcy6g@mail.gmail.com>
	<4EDFF443.6050403@ees.kuleuven.be>
Message-ID: <CADkZ+_UuLpLqCazDXpaaoGUDgegp1QizHw2LRs=U4Q-M=Sxfzw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111207/c13d1452/attachment.pl>

From tf at devmag.net  Thu Dec  8 11:11:59 2011
From: tf at devmag.net (tf at devmag.net)
Date: Thu, 08 Dec 2011 11:11:59 +0100
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
	direction
Message-ID: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>

Dear all,

I have the following problem.

I managed to use the gdistance package to give me computations for  
shortest distances between two ocean points. I am working on a simple  
1 degree grid for that and it works fine.

However, now I want to incorporate something slightly more advanced.  
For each cell of the grid I have a wind vector with its horizontal and  
its vertical wind component; the units are speeds in meters per  
second, which can be positive / negative indicating the direction  
north/ south, east and west.

I have both of them as a raster object.

Similar to the vignette hiking example, I want to compute the fastest  
way to get from A to B. Imagine that the object that moves from A to B  
is a sailing boat that wants to exploit the best possible combiantion  
of winds along all possible paths from A to B.

The data structure for now is as follows:

vertical <- raster(nrows=10, ncols=10)
vertical <- setValues(vertical, runif(10*10, min=-1, max=1) )
horizontal <- raster(nrows=10, ncols=10)
horizontal <- setValues(horizontal, runif(10*10, min=-1, max=1) )

In the hiking example, the direction was either going up or going down  
which was captured by the sign of the height difference (i.e. the  
slope).

They key difference here is, that I essentially have "two signs" for  
both speed direction components.


I am not sure whether this is possible using the gdistance package; I  
would be happy to hear your thoughts and comments.

Best,
Thiemo


From jacobvanetten at yahoo.com  Thu Dec  8 11:34:20 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Thu, 8 Dec 2011 10:34:20 +0000 (GMT)
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
	direction
In-Reply-To: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
References: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
Message-ID: <1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/229969a5/attachment.pl>

From d.nuest at 52north.org  Thu Dec  8 11:37:55 2011
From: d.nuest at 52north.org (=?UTF-8?B?RGFuaWVsIE7DvHN0?=)
Date: Thu, 08 Dec 2011 11:37:55 +0100
Subject: [R-sig-Geo] GEO Label Questionnaire
Message-ID: <4EE09383.2010209@52north.org>

Dear list!

I write to you as critical users of spatial data and ask for your time
to participate in a survey that has the ultimate goal to make your life
using geodata from external sources easier:

52?North is a Partner in GeoViQua (http://geoviqua.org), an EU project
working on providing the GEO data user community with innovative
quality-aware visualization and advanced geo-search capabilities.

One of the objectives of our project is to contribute to defining a
concept of a GEO Label. The *Geo Label* definition is performed by the
GEO Science and Technology Committee (http://earthobservations.org) with
the goal to assist the user in assessing the quality of geospatial data.
This questionnaire aims to collect initial user views on a GEO Label and
its potential role.

We would be very grateful if you could spare 15 minutes to complete this
questionnaire. Your responses will be anonymous and confidential, and
will only be used in our study. Your responses will provide important
information that will help us define what role a GEO Label should
fulfill and help you to improve your research workflow.

GEO Label questionnaire : http://geolabel.questionpro.com/
Please fill out the questionnaire by December 31, 2011.

We thank you for your support.

Best regards,
Daniel


-- 
Daniel N?st
52? North Initiative for Geospatial Open Source Software GmbH
Martin-Luther-King-Weg 24
48155 M?nster, Germany
E-Mail: d.nuest at 52north.org
Fon: +49-(0)-251?396371-36
Fax: +49-(0)-251?396371-11
http://52north.org/
General Managers: Dr. Albert Remke, Dr. Andreas Wytzisk
Local Court Muenster HRB 10849


From paulojus at c3sl.ufpr.br  Thu Dec  8 11:59:53 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Thu, 8 Dec 2011 08:59:53 -0200 (BRST)
Subject: [R-sig-Geo] geoR, Kriging, non-standard models
In-Reply-To: <1293572995.1268396.1323195276360.JavaMail.root@zmbs2.inria.fr>
References: <1293572995.1268396.1323195276360.JavaMail.root@zmbs2.inria.fr>
Message-ID: <alpine.DEB.2.00.1112080858150.4377@macalan.c3sl.ufpr.br>

Gildas

regarding with geoR you can only "fit" such models visually using
lines.variomodel() or alike.
The automatic fitting functions (variofit(), likfit())
do not fit "nested" models.




Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Tue, 6 Dec 2011, Gildas Mazo wrote:

> Dear R users,
>
> I am learning geostatistics and was trying to analyse the 
> Wolfcamp-Aquifer data from Cressie's famous book (1994) using the geoR 
> package. However I don't know how to fit the semivariogram model found 
> by Cressie (4.1.2) page 217. It is a smooth combination of two power 
> models. How can I do that with geoR ? Or gstat ?
>
> Thanks,
> Gildas
>
> -- 
>
> Gildas Mazo
> Doctorant Equipe-Projet MISTIS
> INRIA Grenoble Rhone-Alpes
> Inovall?e, 655, av. de l'Europe, Montbonnot
> 38334 Saint-Ismier Cedex France
> Bureau: G-206
> Tel: +33 (0) 4 56527104
>
> 	[[alternative HTML version deleted]]
>
>


From tf at devmag.net  Thu Dec  8 15:04:58 2011
From: tf at devmag.net (tf at devmag.net)
Date: Thu, 08 Dec 2011 15:04:58 +0100
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
 direction
In-Reply-To: <1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>
References: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
	<1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>
Message-ID: <20111208150458.10112hu5pgwo6neo@c02.conhost.de>


Dear Jacob,


thank you for your prompt response. I am not sure whether I really  
understand the material in the link. This is alll considering the case  
when one is aboard a ship and measures an apparent wind direction and  
a given speed of the boat.

Essentially, what I have is the direction and strength of the wind and  
I want to transform this into a speed of a boat going in a certain  
direction.

The example I was thinking about was something very simplistic:

Think of the boat being in the center of a 9x9 grid and hence  
technically it may be able to move into all 8 cells.  So lets just  
assume that the course the ship can take are courses -180 -135 -90 -45  
0  45  90  135 180  degrees (by assumption), where a course 0 degrees  
means going to the center row rightmost cell.

Next I assume that the ship "does not accumulate speed", going from  
cell to cell - think of this representing the water friction.

Also for simplicity I assume that the ship can sail at most at 90  
degree angles to the wind (in either direction), so for wind coming at  
angle alpha, the ships courses can range from alpha-90 to alpha+90.

I am really not sure how realistic this is, I guess it corresponds to  
the ship having a drag and a lift sail, see

http://terrytao.wordpress.com/2009/03/23/sailing-into-the-wind-or-faster-than-the-wind/


I think these two features make the transition function less  
straightforward. I just computed a simple example.

Suppose the wind blows at 75 degree angle with speed 10 m/s.

Now the ship wants to move into a 45 degree course to reach the upper  
right cell. What is its speed?

The angle between wind and ship course is 75 - 45 = 30 degree. Of the  
10 m/s wind going in direction 75 degree, only a portion is used on  
the 45 degree course. This portion is:

v = cos(30)*10 m/s

For top center cell (90 degrees course)
v = cos(90-75) * 10
Top left cell: (135 degrees course)
v = cos(135-75)*10

The right center row cell (0 degree course)
v = cos(75-0)) * 10

The bottom row right cell as well as all other cells  can not be  
reached, as the course angle abs(course - 75) > 90 degrees.

So I need to assign these transitions speed 0.


This is not what I had originally in mind, as its a crude  
simplification but maybe its one on which I can iterate.


The key question is now, how do I implement this? I dont quite  
understand how I can define the transition function to use these  
different course angles for the 8 adjacent cells - essentially, it is  
a "different function" for each of the 8 adjacent cells.


I hope this is a bit more clear, thank you very much for your help,

best Thiemo


Zitat von Jacob van Etten <jacobvanetten at yahoo.com>:

> Dear Thiemo,
>
> Nice question.
>
>
> The wind direction/speed would need to be converted into a cost or  
> speed variable. This website explains how:
>
> http://sites.google.com/site/yoavraz2/sailingboatspeedvs.windspeed
>
> Best,
>
> Jacob.
>
>
>
> ________________________________
>  From: "tf at devmag.net" <tf at devmag.net>
> To: r-sig-geo at r-project.org
> Sent: Thursday, 8 December 2011, 11:11
> Subject: [R-sig-Geo] gdistance: working with vector speed data in  
> two direction
>
> Dear all,
>
> I have the following problem.
>
> I managed to use the gdistance package to give me computations for  
> shortest distances between two ocean points. I am working on a  
> simple 1 degree grid for that and it works fine.
>
> However, now I want to incorporate something slightly more advanced.  
> For each cell of the grid I have a wind vector with its horizontal  
> and its vertical wind component; the units are speeds in meters per  
> second, which can be positive / negative indicating the direction  
> north/ south, east and west.
>
> I have both of them as a raster object.
>
> Similar to the vignette hiking example, I want to compute the  
> fastest way to get from A to B. Imagine that the object that moves  
> from A to B is a sailing boat that wants to exploit the best  
> possible combiantion of winds along all possible paths from A to B.
>
> The data structure for now is as follows:
>
> vertical <- raster(nrows=10, ncols=10)
> vertical <- setValues(vertical, runif(10*10, min=-1, max=1) )
> horizontal <- raster(nrows=10, ncols=10)
> horizontal <- setValues(horizontal, runif(10*10, min=-1, max=1) )
>
> In the hiking example, the direction was either going up or going  
> down which was captured by the sign of the height difference (i.e.  
> the slope).
>
> They key difference here is, that I essentially have "two signs" for  
> both speed direction components.
>
>
> I am not sure whether this is possible using the gdistance package;  
> I would be happy to hear your thoughts and comments.
>
> Best,
> Thiemo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From darunabas at gmail.com  Thu Dec  8 17:50:33 2011
From: darunabas at gmail.com (Barnabas Daru)
Date: Thu, 8 Dec 2011 18:50:33 +0200
Subject: [R-sig-Geo] Plotting continuous variables onto a map to show
	distribution of variables
Message-ID: <CA+R607GmB2rL1e7U35F82vTgmJ5Nwi+9W8kX_JZOx5_EeCJKig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/d12e42cb/attachment.pl>

From ptacnik at icbm.de  Thu Dec  8 17:57:43 2011
From: ptacnik at icbm.de (Robert Ptacnik)
Date: Thu, 8 Dec 2011 17:57:43 +0100
Subject: [R-sig-Geo] question regarding outdated map polygons
Message-ID: <5BF45041-AF94-4860-87C4-97FAA55B10C9@icbm.de>

Hi list,
where can I find current maps of Europe? The polygons contained in (geo-)mapdata correspond to the borders before 1990 (e.g. Yugoslavia, Czechoslovakia instead of the new states).
Is there any updated source within R?
thanks,
Robert


From carstennh at aol.com  Thu Dec  8 18:49:12 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Thu, 08 Dec 2011 18:49:12 +0100
Subject: [R-sig-Geo] zlim argument image() does not work
Message-ID: <4EE0F898.1000700@aol.com>

Dear developers,

the zlim argument in image() or image.plot() can be used to change the 
scale of the colorlegend. But this has no influence on the image that is 
plotted. Typically z values (Pixels) allocated to image data should 
change colors regarding min and max placed on the legend. But the 
plotted colors remains the same independently from changing 
colorlegends. Is this a known bug or did I overlook a detail:
#############################################################################
sessionInfo()
R version 2.14.0 (2011-10-31)
Platform: x86_64-unknown-linux-gnu (64-bit)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] plotrix_3.3-1 fields_6.6.2  spam_0.27-0   rgdal_0.7-5   sp_0.9-91

loaded via a namespace (and not attached):
[1] grid_2.14.0    lattice_0.20-0
################################################################################
d1<-readGDAL('NMS1_blue_neu.img')

image.plot(d1,"band100",col=rainbow(200),zlim=c(0,200))
image.plot(d1,"band100",col=rainbow(200),zlim=c(0,1))

###means the legend is changing but the visualization of the images 
keeps the same and that is not a correct behavior###

The same behavior I could observe in Raster Objects!

Best regards

Carsten

-- 

Carsten Neumann
Telegrafenberg, A 17 01.13
14473 Potsdam
-------------------------------------------------------
Helmholtz Centre Potsdam
GFZ German Research Centre for Geosciences
Department 1 - Section 1.4 - Remote Sensing
-------------------------------------------------------
Tel.: +49 (0) 331 288 1766
e-mail: carstenn at gfz-potsdam.de


From gildas.mazo at inria.fr  Thu Dec  8 19:01:51 2011
From: gildas.mazo at inria.fr (Gildas Mazo)
Date: Thu, 8 Dec 2011 19:01:51 +0100 (CET)
Subject: [R-sig-Geo] geoR, Kriging, non-standard models
In-Reply-To: <alpine.DEB.2.00.1112080858150.4377@macalan.c3sl.ufpr.br>
Message-ID: <1142818464.1311734.1323367311348.JavaMail.root@zmbs2.inria.fr>

Dear P.J. Ribeiro,

thank you for your answer. Actually I have realized I have misswritten my question. I indeed fit the two power models using variofit(), but I don't know how to perform the kriging map based on the combination (4.1.2) ??

Thank you,
Gildas

----- Mail original -----
> De: "Paulo Justiniano Ribeiro Jr" <paulojus at c3sl.ufpr.br>
> ?: "Gildas Mazo" <gildas.mazo at inria.fr>
> Cc: r-sig-geo at r-project.org
> Envoy?: Jeudi 8 D?cembre 2011 11:59:53
> Objet: Re: [R-sig-Geo] geoR, Kriging, non-standard models
> Gildas
> 
> regarding with geoR you can only "fit" such models visually using
> lines.variomodel() or alike.
> The automatic fitting functions (variofit(), likfit())
> do not fit "nested" models.
> 
> 
> 
> 
> Paulo Justiniano Ribeiro Jr
> LEG (Laboratorio de Estatistica e Geoinformacao)
> Universidade Federal do Parana
> Caixa Postal 19.081
> CEP 81.531-990
> Curitiba, PR - Brasil
> Tel: (+55) 41 3361 3573
> VOIP: (+55) (41) (3361 3600) 1053 1066
> Fax: (+55) 41 3361 3141
> e-mail: paulojus AT ufpr br
> http://www.leg.ufpr.br/~paulojus
> 
> On Tue, 6 Dec 2011, Gildas Mazo wrote:
> 
> > Dear R users,
> >
> > I am learning geostatistics and was trying to analyse the
> > Wolfcamp-Aquifer data from Cressie's famous book (1994) using the
> > geoR
> > package. However I don't know how to fit the semivariogram model
> > found
> > by Cressie (4.1.2) page 217. It is a smooth combination of two power
> > models. How can I do that with geoR ? Or gstat ?
> >
> > Thanks,
> > Gildas
> >
> > --
> >
> > Gildas Mazo
> > Doctorant Equipe-Projet MISTIS
> > INRIA Grenoble Rhone-Alpes
> > Inovall?e, 655, av. de l'Europe, Montbonnot
> > 38334 Saint-Ismier Cedex France
> > Bureau: G-206
> > Tel: +33 (0) 4 56527104
> >
> > 	[[alternative HTML version deleted]]
> >
> >

-- 
Gildas Mazo
Doctorant Equipe-Projet MISTIS
INRIA Grenoble Rhone-Alpes
Inovall?e, 655, av. de l'Europe, Montbonnot
38334 Saint-Ismier Cedex France
Bureau: G-206
Tel: +33 (0) 4 56527104


From rnuske at gwdg.de  Thu Dec  8 19:09:09 2011
From: rnuske at gwdg.de (Robert Nuske)
Date: Thu, 8 Dec 2011 19:09:09 +0100
Subject: [R-sig-Geo] question regarding outdated map polygons
In-Reply-To: <5BF45041-AF94-4860-87C4-97FAA55B10C9@icbm.de>
References: <5BF45041-AF94-4860-87C4-97FAA55B10C9@icbm.de>
Message-ID: <201112081909.09373.rnuske@gwdg.de>

Hi Robert,

> where can I find current maps of Europe? The polygons contained in
> (geo-)mapdata correspond to the borders before 1990 (e.g. Yugoslavia,
> Czechoslovakia instead of the new states). Is there any updated source
> within R?

You might find what you need at http://www.gadm.org (they even provide RData 
files of the boundaries) or at http://www.naturalearthdata.com


Good Luck,
  robert


From edzer.pebesma at uni-muenster.de  Thu Dec  8 19:31:15 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 08 Dec 2011 19:31:15 +0100
Subject: [R-sig-Geo] zlim argument image() does not work
In-Reply-To: <4EE0F898.1000700@aol.com>
References: <4EE0F898.1000700@aol.com>
Message-ID: <4EE10273.9060502@uni-muenster.de>

you didn't provide a reproducible example so I couldn't check, but have
you tried:

image(d1, "band100", zlim=c(0,1), useRasterImage = FALSE)

?

On 12/08/2011 06:49 PM, Carsten Neumann wrote:
> Dear developers,
> 
> the zlim argument in image() or image.plot() can be used to change the
> scale of the colorlegend. But this has no influence on the image that is
> plotted. Typically z values (Pixels) allocated to image data should
> change colors regarding min and max placed on the legend. But the
> plotted colors remains the same independently from changing
> colorlegends. Is this a known bug or did I overlook a detail:
> #############################################################################
> 
> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] plotrix_3.3-1 fields_6.6.2  spam_0.27-0   rgdal_0.7-5   sp_0.9-91
> 
> loaded via a namespace (and not attached):
> [1] grid_2.14.0    lattice_0.20-0
> ################################################################################
> 
> d1<-readGDAL('NMS1_blue_neu.img')
> 
> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,200))
> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,1))
> 
> ###means the legend is changing but the visualization of the images
> keeps the same and that is not a correct behavior###
> 
> The same behavior I could observe in Raster Objects!
> 
> Best regards
> 
> Carsten
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Thu Dec  8 21:54:58 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Dec 2011 21:54:58 +0100 (CET)
Subject: [R-sig-Geo] zlim argument image() does not work
In-Reply-To: <4EE0F898.1000700@aol.com>
References: <4EE0F898.1000700@aol.com>
Message-ID: <alpine.LRH.2.00.1112082136590.9966@reclus.nhh.no>

On Thu, 8 Dec 2011, Carsten Neumann wrote:

> Dear developers,

The image.plot() function is in the fields package. image() and spplot() 
methods in the sp package or image() methods in raster are not the same, 
that is, they are methods called depending on their (first) argument(s). 
image.plot() does not pass through a zlim= argument, as you can see from 
its help page. You should have provided a reproducible example. d1 is 
probably a SpatialGridDataFrame, since you read it with readGDAL(), but 
image.plot() does not take this kind of object as an argument. It may be 
that the ... in image.plot() does get passed through to the legend 
building code, but its help page suggests rather using breaks= to control 
the legend. This gets you some way there:

library(fields)
x<- 1:10; y<- 1:15; z<- outer( x,y,"+")
image.plot(x,y,z)
brk<- quantile( c(z))
image.plot(x,y,z, breaks=brk, col=rainbow(4))
brk[1] <- 8
brk[5] <- 19
image.plot(x,y,z, breaks=brk, col=rainbow(4))

and with more reading of the help page, you may get there. Also see:

SGDF <- image2Grid(obj)
image(SGDF, "z", zlim=c(8, 19), useRasterImage = FALSE)

Roger

>
> the zlim argument in image() or image.plot() can be used to change the scale 
> of the colorlegend. But this has no influence on the image that is plotted. 
> Typically z values (Pixels) allocated to image data should change colors 
> regarding min and max placed on the legend. But the plotted colors remains 
> the same independently from changing colorlegends. Is this a known bug or did 
> I overlook a detail:
> #############################################################################
> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] plotrix_3.3-1 fields_6.6.2  spam_0.27-0   rgdal_0.7-5   sp_0.9-91
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.0    lattice_0.20-0
> ################################################################################
> d1<-readGDAL('NMS1_blue_neu.img')
>
> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,200))
> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,1))
>
> ###means the legend is changing but the visualization of the images keeps the 
> same and that is not a correct behavior###
>
> The same behavior I could observe in Raster Objects!
>
> Best regards
>
> Carsten
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jacobvanetten at yahoo.com  Thu Dec  8 23:38:04 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Thu, 8 Dec 2011 22:38:04 +0000 (GMT)
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
	direction
In-Reply-To: <20111208150458.10112hu5pgwo6neo@c02.conhost.de>
References: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
	<1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>
	<20111208150458.10112hu5pgwo6neo@c02.conhost.de>
Message-ID: <1323383884.95578.YahooMailNeo@web29717.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/fc2dbc8f/attachment.pl>

From agus.camacho at gmail.com  Fri Dec  9 00:43:12 2011
From: agus.camacho at gmail.com (agus)
Date: Thu, 8 Dec 2011 15:43:12 -0800 (PST)
Subject: [R-sig-Geo] Problem with tryf parameter at low number of occorrences
Message-ID: <1323387792847-7076370.post@n2.nabble.com>

Dear all,

I am trying to use the function "randomPoints" for modelling distribution
from a very low number of occorrences:

    Longitude  Latitude
161  144.6333 -18.11667
163  144.0000 -18.03333
164  144.5500 -18.21667
165  144.6167 -18.1166

I am using parameters as explained in the SDM in R pdf:

However, despite this workedd well for species with a greater number of
occurrences, this time it showed me the following error message:

"Error en randomPoints(AU.environment, n = 500, ext = ext, tryf = 100,  : 
  generated random points = 0.06 times requested number; Use a higher value
for tryf"

I tried values of tryf about100, but still got the same result. Anyone might
throw some light on this?

Thanks a lot!
Agus Camacho

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-tryf-parameter-at-low-number-of-occorrences-tp7076370p7076370.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From benweinstein2010 at gmail.com  Fri Dec  9 01:30:20 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Thu, 8 Dec 2011 19:30:20 -0500
Subject: [R-sig-Geo] gdistance resistanceDistance error
Message-ID: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/7b1f4293/attachment.pl>

From r.hijmans at gmail.com  Fri Dec  9 06:32:28 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 8 Dec 2011 21:32:28 -0800
Subject: [R-sig-Geo] merge netcdf files with Raster (or other) package?
In-Reply-To: <CADkZ+_UuLpLqCazDXpaaoGUDgegp1QizHw2LRs=U4Q-M=Sxfzw@mail.gmail.com>
References: <4EDD9EE5.1060507@ees.kuleuven.be>
	<CANtt_hxf8wTW7x1eV6Si1VD+i6wcgLQj8H_0zduWV-vYCQcy6g@mail.gmail.com>
	<4EDFF443.6050403@ees.kuleuven.be>
	<CADkZ+_UuLpLqCazDXpaaoGUDgegp1QizHw2LRs=U4Q-M=Sxfzw@mail.gmail.com>
Message-ID: <CANtt_hy7qwATFC-7Qou+mhEoben65yGWkuOO=aXtM85fktKpGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/0176717c/attachment.pl>

From r.hijmans at gmail.com  Fri Dec  9 06:35:11 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 8 Dec 2011 21:35:11 -0800
Subject: [R-sig-Geo] Problem with tryf parameter at low number of
	occorrences
In-Reply-To: <1323387792847-7076370.post@n2.nabble.com>
References: <1323387792847-7076370.post@n2.nabble.com>
Message-ID: <CANtt_hypA+X3OSNqcd_ZAr=ra1cOxBiHsw-ALy=jqhAqQRR_UA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111208/3352ee83/attachment.pl>

From jacobvanetten at yahoo.com  Fri Dec  9 07:17:20 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 9 Dec 2011 06:17:20 +0000 (GMT)
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
Message-ID: <1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/5f7585a3/attachment.pl>

From agus.camacho at gmail.com  Fri Dec  9 07:54:51 2011
From: agus.camacho at gmail.com (agus)
Date: Thu, 8 Dec 2011 22:54:51 -0800 (PST)
Subject: [R-sig-Geo] Problem with tryf parameter at low number of
	occorrences
In-Reply-To: <CANtt_hypA+X3OSNqcd_ZAr=ra1cOxBiHsw-ALy=jqhAqQRR_UA@mail.gmail.com>
References: <1323387792847-7076370.post@n2.nabble.com>
	<CANtt_hypA+X3OSNqcd_ZAr=ra1cOxBiHsw-ALy=jqhAqQRR_UA@mail.gmail.com>
Message-ID: <1323413691777-7077233.post@n2.nabble.com>

Thanks for the prompt answer Robert,

You guessed right. However, when I take out the parameters extent and
extentf, leaving it like:

backg <- randomPoints(AU.environment, n=500)

It comes the problem:   

Error en rbind(deparse.level, ...) : 
  numbers of columns of arguments do not match

If I traceback>

   traceback()
7: stop("numbers of columns of arguments do not match")
6: rbind(deparse.level, ...)
5: rbind(pv, av)
4: .local(x, p, ...)
3: maxent(AU.environment, pres_train, factors = c("sq1", "sq2", 
       "sq3", "sq4", "sq5", "sq6", "sq7")) at #29
2: maxent(AU.environment, pres_train, factors = c("sq1", "sq2", 
       "sq3", "sq4", "sq5", "sq6", "sq7")) at #29
1: maxmod.dist(x)

I guess this might be related

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-tryf-parameter-at-low-number-of-occorrences-tp7076370p7077233.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mathieu.rajerison at gmail.com  Fri Dec  9 08:39:50 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 9 Dec 2011 08:39:50 +0100
Subject: [R-sig-Geo] DeducerSpatial - A Spatial Data Analysis GUI for R
Message-ID: <CAGfc75kP79rZk=iKwy6FYxxd5SWBiZB2pLgOYNZ3soosNEJL6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/2249c350/attachment.pl>

From leroy.boris at gmail.com  Fri Dec  9 13:15:38 2011
From: leroy.boris at gmail.com (Boris Leroy)
Date: Fri, 9 Dec 2011 13:15:38 +0100
Subject: [R-sig-Geo] zlim argument image() does not work
Message-ID: <CAFu_poEozcMMSbk_rGbU-JEysD968jvynT2U6mCUJWr-4PbD2g@mail.gmail.com>

Dear Carsten,

Yes, it is known that zlim does not work properly and Robert Hijmans
is aware of that.
There will probably be a fix when possible!

All the best,

Boris

>Dear developers,
>
>the zlim argument in image() or image.plot() can be used to change the
>scale of the colorlegend. But this has no influence on the image that is
>plotted. Typically z values (Pixels) allocated to image data should
>change colors regarding min and max placed on the legend. But the
>plotted colors remains the same independently from changing
>colorlegends. Is this a known bug or did I overlook a detail:
>#############################################################################
>sessionInfo()
>R version 2.14.0 (2011-10-31)
>Platform: x86_64-unknown-linux-gnu (64-bit)
>
>attached base packages:
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>other attached packages:
>[1] plotrix_3.3-1 fields_6.6.2  spam_0.27-0   rgdal_0.7-5   sp_0.9-91
>
>loaded via a namespace (and not attached):
>[1] grid_2.14.0    lattice_0.20-0
>################################################################################
>d1<-readGDAL('NMS1_blue_neu.img')
>
>image.plot(d1,"band100",col=rainbow(200),zlim=c(0,200))
>image.plot(d1,"band100",col=rainbow(200),zlim=c(0,1))
>
>###means the legend is changing but the visualization of the images
>keeps the same and that is not a correct behavior###
>
>The same behavior I could observe in Raster Objects!
>
>Best regards
>
>Carsten
>
>--
>
>Carsten Neumann
>Telegrafenberg, A 17 01.13
>14473 Potsdam
>-------------------------------------------------------
>Helmholtz Centre Potsdam
>GFZ German Research Centre for Geosciences
>Department 1 - Section 1.4 - Remote Sensing
>-------------------------------------------------------
>Tel.: +49 (0) 331 288 1766
>e-mail: carstenn at gfz-potsdam.de

--
Boris Leroy,
PhD Student,
Equipe Biodiversit? et Gestion des Territoires,
Service du Patrimoine Naturel, MNHN
UMR 7204 CERSP, MNHN
Universit? de Rennes 1
Campus de Beaulieu, B?t. 25, 1er ?tage
35042 Rennes cedex

+33 (0) 2 23 23 68 05
+33 (0) 6 66 02 13 27


From Els.Verfaillie at Ugent.be  Fri Dec  9 13:23:42 2011
From: Els.Verfaillie at Ugent.be (Els Verfaillie)
Date: Fri, 9 Dec 2011 13:23:42 +0100
Subject: [R-sig-Geo] kriging with external drift problems
Message-ID: <003f01ccb66d$63bb46d0$2b31d470$@Verfaillie@Ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/6f98c606/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Dec  9 13:33:02 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 09 Dec 2011 13:33:02 +0100
Subject: [R-sig-Geo] kriging with external drift problems
In-Reply-To: <003f01ccb66d$63bb46d0$2b31d470$@Verfaillie@Ugent.be>
References: <003f01ccb66d$63bb46d0$2b31d470$@Verfaillie@Ugent.be>
Message-ID: <4EE1FFFE.4080008@uni-muenster.de>

Dear Els, I believe there is no cure for too little data.

Instead of looking at directional variograms, I would look at variograms
of regression residuals. Instead of a max distance value, I would set a
maximum neighbourhood size expressed as the max number of nearest values.

Whether 43 observations can be sufficient to indicate strong
non-stationarity, is questionable; cross validation might give you some
information about how helpful it is to work in local neighbourhoods, but
again, it only has 43 observation to do this.

As usual, when going from a global to a local model you expect a
decrease in bias, and an increase in variability.

On 12/09/2011 01:23 PM, Els Verfaillie wrote:
> Dear list,
> 
>  
> 
> I have a dataset from Ethiopia with a good correlation between infiltration
> depth and slope (r=0.75). Therefore, I would like to use KED (with slope as
> secondary variable) to interpolate the infiltration observations.
> 
> However, my main problem is the limited amount of observations (n=43). This
> gives problems for the directional variogram calculation and for the use of
> an interpolation window. I would like to consider the direction where the
> drift is not present as underlying variogram, but with the very limited
> amount of observations this is not straightforward. 
> 
>  
> 
> My questions are the following:
> 
> -          Is there an alternative interpolation technique for my approach
> given the small number of observations, if possible making use of the slope
> information as secondary variable?
> 
> -          Because of the strong non-stationarity of the dataset I want to
> use a local interpolation window. But when I set a distance value I receive
> an error message ("lufactor.c", line 207: singular matrix in function
> m_inverse()). Is there a way to solve this problem? 
> 
>  
> 
> Thank you for your answer!
> 
>  
> 
> ______________________________________________
> 
> Els Verfaillie
> 
> Ghent University (UGent) - Department of Geography
> 
> Belgium
> 
> ______________________________________________
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From carstennh at aol.com  Fri Dec  9 16:02:21 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 09 Dec 2011 16:02:21 +0100
Subject: [R-sig-Geo] zlim argument image() does not work
In-Reply-To: <alpine.LRH.2.00.1112082136590.9966@reclus.nhh.no>
References: <4EE0F898.1000700@aol.com>
	<alpine.LRH.2.00.1112082136590.9966@reclus.nhh.no>
Message-ID: <4EE222FD.40605@aol.com>

On 12/08/2011 09:54 PM, Roger Bivand wrote:
> On Thu, 8 Dec 2011, Carsten Neumann wrote:
>
>> Dear developers,
>
> The image.plot() function is in the fields package. image() and 
> spplot() methods in the sp package or image() methods in raster are 
> not the same, that is, they are methods called depending on their 
> (first) argument(s). image.plot() does not pass through a zlim= 
> argument, as you can see from its help page. You should have provided 
> a reproducible example. d1 is probably a SpatialGridDataFrame, since 
> you read it with readGDAL(), but image.plot() does not take this kind 
> of object as an argument. It may be that the ... in image.plot() does 
> get passed through to the legend building code, but its help page 
> suggests rather using breaks= to control the legend. This gets you 
> some way there:
>
> library(fields)
> x<- 1:10; y<- 1:15; z<- outer( x,y,"+")
> image.plot(x,y,z)
> brk<- quantile( c(z))
> image.plot(x,y,z, breaks=brk, col=rainbow(4))
> brk[1] <- 8
> brk[5] <- 19
> image.plot(x,y,z, breaks=brk, col=rainbow(4))
>
> and with more reading of the help page, you may get there. Also see:
>
> SGDF <- image2Grid(obj)
> image(SGDF, "z", zlim=c(8, 19), useRasterImage = FALSE)
>
> Roger
>
>>
>> the zlim argument in image() or image.plot() can be used to change 
>> the scale of the colorlegend. But this has no influence on the image 
>> that is plotted. Typically z values (Pixels) allocated to image data 
>> should change colors regarding min and max placed on the legend. But 
>> the plotted colors remains the same independently from changing 
>> colorlegends. Is this a known bug or did I overlook a detail:
>> ############################################################################# 
>>
>> sessionInfo()
>> R version 2.14.0 (2011-10-31)
>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] plotrix_3.3-1 fields_6.6.2  spam_0.27-0   rgdal_0.7-5   sp_0.9-91
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.14.0    lattice_0.20-0
>> ################################################################################ 
>>
>> d1<-readGDAL('NMS1_blue_neu.img')
>>
>> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,200))
>> image.plot(d1,"band100",col=rainbow(200),zlim=c(0,1))
>>
>> ###means the legend is changing but the visualization of the images 
>> keeps the same and that is not a correct behavior###
>>
>> The same behavior I could observe in Raster Objects!
>>
>> Best regards
>>
>> Carsten
>>
>>
>
Dear all,

d1 is indeed a SpatialGridDataFrame and thank you "useRasterImage = 
FALSE" works to scale legend and image together with the "zlim" argument 
in functions image() and image.plot(). Unfortunately I could not find 
this argument on the function's help pages. The help pages did not grasp 
this zlim issue quite clear, so when comparing multiple images for one 
scale defined by zlim you might not see what you think to see. Just a 
hint, because it happened to me.

Thank you to Boris for your hint on raster package.

All the Best and thank you again

Carsten

-- 

Carsten Neumann
Telegrafenberg, A 17 01.13
14473 Potsdam
-------------------------------------------------------
Helmholtz Centre Potsdam
GFZ German Research Centre for Geosciences
Department 1 - Section 1.4 - Remote Sensing
-------------------------------------------------------
Tel.: +49 (0) 331 288 1766
e-mail: carstenn at gfz-potsdam.de


From frippe12573 at hotmail.com  Fri Dec  9 16:33:44 2011
From: frippe12573 at hotmail.com (Eugenio Trumpy)
Date: Fri, 9 Dec 2011 15:33:44 +0000
Subject: [R-sig-Geo] sorry!
In-Reply-To: <DUB108-W54CF5FDA1C1BAA7D7B3B3E5B90@phx.gbl>
References: <DUB108-W56D6BB8079669984F13CCE5B90@phx.gbl>,
	<DUB108-W54CF5FDA1C1BAA7D7B3B3E5B90@phx.gbl>
Message-ID: <DUB108-W5771B3D554B8D10AE8CF6E5B90@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/e92140e9/attachment.pl>

From eric.momsen at ndsu.edu  Fri Dec  9 19:56:38 2011
From: eric.momsen at ndsu.edu (Eric Momsen)
Date: Fri, 9 Dec 2011 12:56:38 -0600
Subject: [R-sig-Geo] readVECT6 - Multiple incompatible geometries
Message-ID: <CAO7hk-Kk0_3m6qaWCj0jA7WgranFMTTd7i4DsJxztMTADy7Uww@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/eb637a04/attachment.pl>

From miaoyingshi23 at gmail.com  Fri Dec  9 21:06:40 2011
From: miaoyingshi23 at gmail.com (Miaoying Shi)
Date: Fri, 9 Dec 2011 15:06:40 -0500
Subject: [R-sig-Geo] create point shapefile of street centerline
Message-ID: <CABx2-fCAEBd=nwL0MH-Yq6kFrUV1w66Us6_ueBXH42GWx5rxNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111209/e710918b/attachment.pl>

From tf at devmag.net  Fri Dec  9 22:08:36 2011
From: tf at devmag.net (tf at devmag.net)
Date: Fri, 09 Dec 2011 22:08:36 +0100
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
 direction
In-Reply-To: <1323383884.95578.YahooMailNeo@web29717.mail.ird.yahoo.com>
References: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
	<1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>
	<20111208150458.10112hu5pgwo6neo@c02.conhost.de>
	<1323383884.95578.YahooMailNeo@web29717.mail.ird.yahoo.com>
Message-ID: <20111209220836.12991vmhqwd7lbk0@c02.conhost.de>



Dear Jacob, dear all,

thaks for the hint towards the adjacent() function. I got "somewhere"  
using this.

Using the wind-vector data I calculated for each adjacent cell the  
speed based on my very simplistic modelling of sailing.


The structure is a dataframe that looks for example as follows:

from   to   speed
2000  1998   0
2000  1999   1.2223
2000  2001   2.8972


so I basically just added a speed vector to the vector of adjacencies.  
If a ship can not go somewhere, the speed is set to 0 for that  
adjacency.

I now was wondering how I can get this into the transition-layer  
format so that I can use the Diijsktra implementation in that package?

I want to see how well this simplistic modelling works, before adding  
more layers of sophistication.


Thanks a lot for your help and hints,

best Thiemo



Zitat von Jacob van Etten <jacobvanetten at yahoo.com>:

> Hi Thiemo,
>
> This is something beyond the transition() function. You probably  
> need to look at all 8 directions separately and then sum the
> TransitionLayer objects.
>
>
> You could achieve that by looking at the
> adjacent() function in raster to analyze connected cells in each direction
> separately.
>
>
> I think that not going at more than 90 degrees against the wind  
> would oversimplify too much and is not necessary.
>
>
> You will need to work out the mathematics to do this. I think that  
> the website I gave you below gives all the clues you need to  
> approximate sailing boat speed.
>
>
> Best,
>
> Jacob.
>
>
>
> ________________________________
>  From: "tf at devmag.net" <tf at devmag.net>
> To: Jacob van Etten <jacobvanetten at yahoo.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Sent: Thursday, 8 December 2011, 15:04
> Subject: Re: [R-sig-Geo] gdistance: working with vector speed data  
> in two direction
>
>
> Dear Jacob,
>
>
> thank you for your prompt response. I am not sure whether I really  
> understand the material in the link. This is alll considering the  
> case when one is aboard a ship and measures an apparent wind  
> direction and a given speed of the boat.
>
> Essentially, what I have is the direction and strength of the wind  
> and I want to transform this into a speed of a boat going in a  
> certain direction.
>
> The example I was thinking about was something very simplistic:
>
> Think of the boat being in the center of a 9x9 grid and hence  
> technically it may be able to move into all 8 cells.? So lets just  
> assume that the course the ship can take are courses -180 -135 -90  
> -45 0? 45? 90? 135 180? degrees (by assumption), where a course 0  
> degrees means going to the center row rightmost cell.
>
> Next I assume that the ship "does not accumulate speed", going from  
> cell to cell - think of this representing the water friction.
>
> Also for simplicity I assume that the ship can sail at most at 90  
> degree angles to the wind (in either direction), so for wind coming  
> at angle alpha, the ships courses can range from alpha-90 to alpha+90.
>
> I am really not sure how realistic this is, I guess it corresponds  
> to the ship having a drag and a lift sail, see
>
> http://terrytao.wordpress.com/2009/03/23/sailing-into-the-wind-or-faster-than-the-wind/
>
>
> I think these two features make the transition function less  
> straightforward. I just computed a simple example.
>
> Suppose the wind blows at 75 degree angle with speed 10 m/s.
>
> Now the ship wants to move into a 45 degree course to reach the  
> upper right cell. What is its speed?
>
> The angle between wind and ship course is 75 - 45 = 30 degree. Of  
> the 10 m/s wind going in direction 75 degree, only a portion is used  
> on the 45 degree course. This portion is:
>
> v = cos(30)*10 m/s
>
> For top center cell (90 degrees course)
> v = cos(90-75) * 10
> Top left cell: (135 degrees course)
> v = cos(135-75)*10
>
> The right center row cell (0 degree course)
> v = cos(75-0)) * 10
>
> The bottom row right cell as well as all other cells? can not be  
> reached, as the course angle abs(course - 75) > 90 degrees.
>
> So I need to assign these transitions speed 0.
>
>
> This is not what I had originally in mind, as its a crude  
> simplification but maybe its one on which I can iterate.
>
>
> The key question is now, how do I implement this? I dont quite  
> understand how I can define the transition function to use these  
> different course angles for the 8 adjacent cells - essentially, it  
> is a "different function" for each of the 8 adjacent cells.
>
>
> I hope this is a bit more clear, thank you very much for your help,
>
> best Thiemo
>
>
> Zitat von Jacob van Etten <jacobvanetten at yahoo.com>:
>
>> Dear Thiemo,
>>
>> Nice question.
>>
>>
>> The wind direction/speed would need to be converted into a cost or  
>> speed variable. This website explains how:
>>
>> http://sites.google.com/site/yoavraz2/sailingboatspeedvs.windspeed
>>
>> Best,
>>
>> Jacob.
>>
>>
>>
>> ________________________________
>> ? From: "tf at devmag.net" <tf at devmag.net>
>> To: r-sig-geo at r-project.org
>> Sent: Thursday, 8 December 2011, 11:11
>> Subject: [R-sig-Geo] gdistance: working with vector speed data in  
>> two direction
>>
>> Dear all,
>>
>> I have the following problem.
>>
>> I managed to use the gdistance package to give me computations for  
>> shortest distances between two ocean points. I am working on a  
>> simple 1 degree grid for that and it works fine.
>>
>> However, now I want to incorporate something slightly more  
>> advanced. For each cell of the grid I have a wind vector with its  
>> horizontal and its vertical wind component; the units are speeds in  
>> meters per second, which can be positive / negative indicating the  
>> direction north/ south, east and west.
>>
>> I have both of them as a raster object.
>>
>> Similar to the vignette hiking example, I want to compute the  
>> fastest way to get from A to B. Imagine that the object that moves  
>> from A to B is a sailing boat that wants to exploit the best  
>> possible combiantion of winds along all possible paths from A to B.
>>
>> The data structure for now is as follows:
>>
>> vertical <- raster(nrows=10, ncols=10)
>> vertical <- setValues(vertical, runif(10*10, min=-1, max=1) )
>> horizontal <- raster(nrows=10, ncols=10)
>> horizontal <- setValues(horizontal, runif(10*10, min=-1, max=1) )
>>
>> In the hiking example, the direction was either going up or going  
>> down which was captured by the sign of the height difference (i.e.  
>> the slope).
>>
>> They key difference here is, that I essentially have "two signs"  
>> for both speed direction components.
>>
>>
>> I am not sure whether this is possible using the gdistance package;  
>> I would be happy to hear your thoughts and comments.
>>
>> Best,
>> Thiemo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From wongwatana at gmail.com  Sat Dec 10 15:24:38 2011
From: wongwatana at gmail.com (Wongwatana Sombunying)
Date: Sat, 10 Dec 2011 21:24:38 +0700
Subject: [R-sig-Geo] How to interpolate river cross section with R?
Message-ID: <CAJPrg=zoRntY+XW+tGnxr7BiUR9VNRuimSCqf0s66P7XPc57LQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111210/3c0cca6b/attachment.pl>

From sas0025 at auburn.edu  Sat Dec 10 20:43:28 2011
From: sas0025 at auburn.edu (Stephen Sefick)
Date: Sat, 10 Dec 2011 13:43:28 -0600
Subject: [R-sig-Geo] How to interpolate river cross section with R?
In-Reply-To: <CAJPrg=zoRntY+XW+tGnxr7BiUR9VNRuimSCqf0s66P7XPc57LQ@mail.gmail.com>
References: <CAJPrg=zoRntY+XW+tGnxr7BiUR9VNRuimSCqf0s66P7XPc57LQ@mail.gmail.com>
Message-ID: <4EE3B660.8040808@auburn.edu>

I think I would look into GRASS GIS.  There are some very good 
interpolation algorithms that are implemented there already.  Likely, 
you can do this with either R or GRASS, whether it is sensible is up to 
you.

It sounds like the survey data and the DEM data are referenced to 
different elevation datums.  How far off are the elevation values?

On Sat 10 Dec 2011 08:24:38 AM CST, Wongwatana Sombunying wrote:
> Dear all
>
>            I have two data elevation sources which are DEM grid file and
> river cross-section surveyed data. DEM data is grid file covering the whole
> watershed area. Surveying data is 500-m interval cross sections along a
> river reach in the watershed area. However, these are much difference in
> elevation value at the same coordinate points. I want to generate a new
> grid file from surveyed data along the river reach to be input of
> hydrodynamic model.  Can I solve this problem with any R packages?  or  Can
> I use R to  interpolate river cross section between upstream and downstream
> river cross sections?
>
> The example of 2 cross section data are as following :
>
> Cross section No- 1
> chainage,x,y,z
> 0,537545.1,2219340,452.11
> 4,537541.1,2219340,452.05
> 12,537533.2,2219339,451.54
> 14,537531.2,2219338,451.6
> 16,537529.2,2219338,451.39
> 24,537521.3,2219337,450.13
> 34,537511.4,2219336,450.32
> 39,537506.5,2219335,448.55
> 44,537501.5,2219334,447.05
> 49,537496.6,2219333,446.15
> 54,537491.6,2219333,445.58
> 59,537486.7,2219332,445.11
> 64,537481.7,2219331,445
> 69,537476.8,2219331,444.83
> 74,537471.8,2219330,444.94
> 79,537466.9,2219329,444.69
> 84,537461.9,2219329,444.76
> 89,537456.9,2219328,444.8
> 94,537452,2219327,444.94
> 99,537447,2219326,445.04
> 104,537442.1,2219326,445.94
> 110,537436.2,2219325,446.89
> 114,537432.2,2219324,450.51
> 124,537422.3,2219323,457.19
> 134,537412.4,2219322,464.5
> 144,537402.5,2219320,471.79
> 154,537392.6,2219319,478.5
>
> Cross section No- 2
>
> chainage,x,y,z
> 0,537545.1,2219340,452.11
> 4,537541.1,2219340,452.05
> 12,537533.2,2219339,451.54
> 14,537531.2,2219338,451.6
> 16,537529.2,2219338,451.39
> 24,537521.3,2219337,450.13
> 34,537511.4,2219336,450.32
> 39,537506.5,2219335,448.55
> 44,537501.5,2219334,447.05
> 49,537496.6,2219333,446.15
> 54,537491.6,2219333,445.58
> 59,537486.7,2219332,445.11
> 64,537481.7,2219331,445
> 69,537476.8,2219331,444.83
> 74,537471.8,2219330,444.94
> 79,537466.9,2219329,444.69
> 84,537461.9,2219329,444.76
> 89,537456.9,2219328,444.8
> 94,537452,2219327,444.94
> 99,537447,2219326,445.04
> 104,537442.1,2219326,445.94
> 110,537436.2,2219325,446.89
> 114,537432.2,2219324,450.51
> 124,537422.3,2219323,457.19
> 134,537412.4,2219322,464.5
> 144,537402.5,2219320,471.79
> 154,537392.6,2219319,478.5
>
>      Thank you for your help.
>

-- 
Stephen Sefick
**************************************************
Auburn University                                         
Biological Sciences                                      
331 Funchess Hall                                       
Auburn, Alabama                                        
36849                                                           
**************************************************
sas0025 at auburn.edu                                  
http://www.auburn.edu/~sas0025                 
**************************************************

Let's not spend our time and resources thinking about things that are 
so little or so large that all they really do for us is puff us up and 
make us feel like gods.  We are mammals, and have not exhausted the 
annoying little problems of being mammals.

                                -K. Mullis

"A big computer, a complex algorithm and a long time does not equal 
science."

                              -Robert Gentleman


From ivan.marchesini at gmail.com  Sat Dec 10 22:35:44 2011
From: ivan.marchesini at gmail.com (ivan marchesini)
Date: Sat, 10 Dec 2011 22:35:44 +0100
Subject: [R-sig-Geo] How to interpolate river cross section with R?
In-Reply-To: <4EE3B660.8040808@auburn.edu>
References: <CAJPrg=zoRntY+XW+tGnxr7BiUR9VNRuimSCqf0s66P7XPc57LQ@mail.gmail.com>
	<4EE3B660.8040808@auburn.edu>
Message-ID: <1323552944.3157.38.camel@beedo>

Hi,
in the past, for a similar problem, I used GRASS and in particular the
module r.surf.nnbathy which is an addon of GRASS.
I used this module to perform a delaunay triangulation considering both
the cross section points and the grid points (only those outside of the
river width). Obviously this approach can work only if the cross section
data are not really sparse respect to the DEM resolution. But since you
have 500 m interval cross section I think this could be a problem.

Another way is to pass, unfortunately, from the proprietary software
HEC-RAS. You can (1)import your cross section data (2)use the
"interpolate cross-section" function and then (3)export (non so simple)
all the cross sections (original and interpolated) as x,y,z values.
At this point you can go back and at GRASS and r.surf.nnbathy. 

The only problem is that the result is a sharp rigid surface, but you
can try to smooth it, for example, using some kernel filter.

hope this help.

ivan


Il giorno sab, 10/12/2011 alle 13.43 -0600, Stephen Sefick ha scritto:
> I think I would look into GRASS GIS.  There are some very good 
> interpolation algorithms that are implemented there already.  Likely, 
> you can do this with either R or GRASS, whether it is sensible is up to 
> you.
> 
> It sounds like the survey data and the DEM data are referenced to 
> different elevation datums.  How far off are the elevation values?
> 
> On Sat 10 Dec 2011 08:24:38 AM CST, Wongwatana Sombunying wrote:
> > Dear all
> >
> >            I have two data elevation sources which are DEM grid file and
> > river cross-section surveyed data. DEM data is grid file covering the whole
> > watershed area. Surveying data is 500-m interval cross sections along a
> > river reach in the watershed area. However, these are much difference in
> > elevation value at the same coordinate points. I want to generate a new
> > grid file from surveyed data along the river reach to be input of
> > hydrodynamic model.  Can I solve this problem with any R packages?  or  Can
> > I use R to  interpolate river cross section between upstream and downstream
> > river cross sections?
> >
> > The example of 2 cross section data are as following :
> >
> > Cross section No- 1
> > chainage,x,y,z
> > 0,537545.1,2219340,452.11
> > 4,537541.1,2219340,452.05
> > 12,537533.2,2219339,451.54
> > 14,537531.2,2219338,451.6
> > 16,537529.2,2219338,451.39
> > 24,537521.3,2219337,450.13
> > 34,537511.4,2219336,450.32
> > 39,537506.5,2219335,448.55
> > 44,537501.5,2219334,447.05
> > 49,537496.6,2219333,446.15
> > 54,537491.6,2219333,445.58
> > 59,537486.7,2219332,445.11
> > 64,537481.7,2219331,445
> > 69,537476.8,2219331,444.83
> > 74,537471.8,2219330,444.94
> > 79,537466.9,2219329,444.69
> > 84,537461.9,2219329,444.76
> > 89,537456.9,2219328,444.8
> > 94,537452,2219327,444.94
> > 99,537447,2219326,445.04
> > 104,537442.1,2219326,445.94
> > 110,537436.2,2219325,446.89
> > 114,537432.2,2219324,450.51
> > 124,537422.3,2219323,457.19
> > 134,537412.4,2219322,464.5
> > 144,537402.5,2219320,471.79
> > 154,537392.6,2219319,478.5
> >
> > Cross section No- 2
> >
> > chainage,x,y,z
> > 0,537545.1,2219340,452.11
> > 4,537541.1,2219340,452.05
> > 12,537533.2,2219339,451.54
> > 14,537531.2,2219338,451.6
> > 16,537529.2,2219338,451.39
> > 24,537521.3,2219337,450.13
> > 34,537511.4,2219336,450.32
> > 39,537506.5,2219335,448.55
> > 44,537501.5,2219334,447.05
> > 49,537496.6,2219333,446.15
> > 54,537491.6,2219333,445.58
> > 59,537486.7,2219332,445.11
> > 64,537481.7,2219331,445
> > 69,537476.8,2219331,444.83
> > 74,537471.8,2219330,444.94
> > 79,537466.9,2219329,444.69
> > 84,537461.9,2219329,444.76
> > 89,537456.9,2219328,444.8
> > 94,537452,2219327,444.94
> > 99,537447,2219326,445.04
> > 104,537442.1,2219326,445.94
> > 110,537436.2,2219325,446.89
> > 114,537432.2,2219324,450.51
> > 124,537422.3,2219323,457.19
> > 134,537412.4,2219322,464.5
> > 144,537402.5,2219320,471.79
> > 154,537392.6,2219319,478.5
> >
> >      Thank you for your help.
> >
> 

-- 
Ti prego di cercare di non inviarmi files .dwg, .doc, .xls, .ppt.
Preferisco formati liberi.
Please try to avoid to send me .dwg, .doc, .xls, .ppt files.
I prefer free formats.
http://it.wikipedia.org/wiki/Formato_aperto
http://en.wikipedia.org/wiki/Open_format

Ivan Marchesini
Perugia (Italy)
Socio fondatore GFOSS "Geospatial Free and Open Source Software" http://www.gfoss.it
e-mail: ivan.marchesini at irpi.cnr.it
        ivan.marchesini at gmail.com
fax (mailfax): +39 1782092534
jabber: geoivan73 at jabber.org
skype: geoivan73
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111210/2678cd96/attachment.bin>

From darunabas at gmail.com  Sun Dec 11 07:50:58 2011
From: darunabas at gmail.com (Barnabas Daru)
Date: Sat, 10 Dec 2011 22:50:58 -0800
Subject: [R-sig-Geo] Species distribution ranges using cells/grids
Message-ID: <CA+R607HB_rXEvi64yPfPP3iG=+FZq9=q6eLLeSg1HkGVN4U93Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111210/0dadadb7/attachment.pl>

From valcu at orn.mpg.de  Sun Dec 11 13:00:19 2011
From: valcu at orn.mpg.de (Mihai Valcu)
Date: Sun, 11 Dec 2011 13:00:19 +0100
Subject: [R-sig-Geo] Species distribution ranges using cells/grids
In-Reply-To: <CA+R607HB_rXEvi64yPfPP3iG=+FZq9=q6eLLeSg1HkGVN4U93Q@mail.gmail.com>
References: <CA+R607HB_rXEvi64yPfPP3iG=+FZq9=q6eLLeSg1HkGVN4U93Q@mail.gmail.com>
Message-ID: <4EE49B53.5090504@orn.mpg.de>

You could probably use rangeMapper. There are a few examples posted 
here: http://rangemapper.r-forge.r-project.org/index.html
See e.g. http://rangemapper.r-forge.r-project.org/01__Species_Richness.html
best regards
Mihai
*
*
On 12/11/2011 7:50 AM, Barnabas Daru wrote:
> Dear all,
>
> I write to ask whether it is possible to show using R, species distribution
> ranges for some plant species occurring in South Africa.
>
> Firstly, I would like to divide the country which they occur into grids or
> cells say of 1km square each.
>
> Then assign a name or number to each grid/cell and using presence/absence
> (1 or 0), code the distribution of each species.
>
> The idea is to eventually plot the map to show the diversity or
> concentration of the species in relation to the country.
>
> Thank you very much
>
> Barnabas Daru
>

-- 
+-----------------------------------------------+
| Mihai Valcu                                   |
| Max Planck Institute for Ornithology          |
| Behavioural Ecology and Evolutionary Genetics |
| Eberhard-Gwinner-Stra?e 7                     |
| D-82319 Starnberg (Seewiesen)                 |
| Phone: +49 (0)8157-932-343                    |
| Fax:   +49-(0)8157-932-400                    |
| http://orn.mpg.de/mitarbeiter/valcu.html      |
+-----------------------------------------------+


From jacobvanetten at yahoo.com  Sun Dec 11 19:48:29 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Sun, 11 Dec 2011 18:48:29 +0000 (GMT)
Subject: [R-sig-Geo] gdistance: working with vector speed data in two
	direction
In-Reply-To: <20111209220836.12991vmhqwd7lbk0@c02.conhost.de>
References: <20111208111159.76415cxp7bxei8gs@c02.conhost.de>
	<1323340460.76431.YahooMailNeo@web29709.mail.ird.yahoo.com>
	<20111208150458.10112hu5pgwo6neo@c02.conhost.de>
	<1323383884.95578.YahooMailNeo@web29717.mail.ird.yahoo.com>
	<20111209220836.12991vmhqwd7lbk0@c02.conhost.de>
Message-ID: <1323629309.175.YahooMailNeo@web29711.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111211/c599795f/attachment.pl>

From Jan.Quets at ua.ac.be  Sun Dec 11 21:11:35 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Sun, 11 Dec 2011 20:11:35 +0000
Subject: [R-sig-Geo] =?iso-8859-1?q?calculate_r=B2_between_kernel-based_sp?=
	=?iso-8859-1?q?atial_variables?=
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F83A6@xmail32.ad.ua.ac.be>

Hello list,


I have a rather theoretical question (with practical finality):

how to correctly calculate a coefficient of determination between two spatial variables which values (pixels in a window) are both kernel-based?

suppose a point pattern X, and a point pattern Y, in the same window

make density maps of both:


densX = density.ppp(X)         #the first spatial variable

densY = density.ppp(Y)          #the second spatial variable


suppose densX and densY have both 128x128 = 16384 values (pixels)

suppose there is some correlation between densX and densY.

The significance of this relationship however depends on which pixels to include in the formula: neighboring pixel values are in general similar and dependent.


I had an approach in mind:

1) choose an epanechnikov kernel (because it is spatially bound, with supposed total width = 2h) instead of a gaussian kernel (which in theory is not spatially bound) to construct both density maps with density.ppp() 

2) include in the formula of the coefficient of determination, only pixels which lay at least 2h (the total width of the epanechnikov kernel) from each other.


Would this be an sound and appropriate way to calculate the coefficient of determination between two kernel-based spatial variables (e.g. densX and densY)??

Thank you,
Jan

From mathieu.rajerison at gmail.com  Mon Dec 12 08:35:36 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 12 Dec 2011 08:35:36 +0100
Subject: [R-sig-Geo] create point shapefile of street centerline
In-Reply-To: <CABx2-fCAEBd=nwL0MH-Yq6kFrUV1w66Us6_ueBXH42GWx5rxNA@mail.gmail.com>
References: <CABx2-fCAEBd=nwL0MH-Yq6kFrUV1w66Us6_ueBXH42GWx5rxNA@mail.gmail.com>
Message-ID: <CAGfc75=vSxXQmzBC8b8iJy64WYquJx2aAXof6nkiu46yVBPMRg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111212/7ae52a23/attachment.pl>

From chrismcowen at gmail.com  Mon Dec 12 11:07:58 2011
From: chrismcowen at gmail.com (Chris Mcowen)
Date: Mon, 12 Dec 2011 10:07:58 -0000
Subject: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
Message-ID: <000c01ccb8b5$edfacdd0$c9f06970$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111212/4bd9f6cd/attachment.pl>

From Roger.Bivand at nhh.no  Mon Dec 12 11:50:55 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Dec 2011 11:50:55 +0100 (CET)
Subject: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
In-Reply-To: <000c01ccb8b5$edfacdd0$c9f06970$@com>
References: <000c01ccb8b5$edfacdd0$c9f06970$@com>
Message-ID: <alpine.LRH.2.00.1112121140290.22991@reclus.nhh.no>

On Mon, 12 Dec 2011, Chris Mcowen wrote:

> Dear List,
>
> I am trying to model variation is fisheries catch, I have a large data 
> set (36574) cells , with knowledge of the tonnes of fish caught in each 
> "Cell" ( .5 degree) global cells.
>
> At present I am simply wanting to investigate if certain "area" (clusters of
> cells) have high numbers of fish than others
>
> Due to the grid nature of the data set I have significant spatial
> autocorrelation in the data set.
>
> I have tried:
>
> REALM_gls <- gls(tonnesperkm_log~REALM, correlation = corGaus(form =~Lat +
> Lon), data = Cells)
>
> coords<-cbind(Cells$Lat,Cells$Lon)
> coords<-as.matrix(coords)
> nb1.5<-dnearneigh(coords,0,1.5)
> nb1.5.w<-nb2listw(nb1.5, glist=NULL, style="W", zero.policy=TRUE)
> ols_lm<-lm(Cells$tonnesperkm_log~Cells$REALM)
> ols_lm_error_REALM<-errorsarlm(ols_lm, listw=nb1.5.w, na.action = na.omit,
> zero.policy = T, data = Cells)

This is not right, the first argument to errorsarlm() is a formula object. 
Did you look at the help page? If you did, did you look at the method= 
argument, which offers among others sparse matrix methods for larger N?
You may have no-neighbour observations, just see the help page. In 
addition, you have geographical coordinates, so should set the arguments 
to dnearneigh appropriately - here they are assuming a planar surface, but 
may be OK to recover neighbours.

> llk1 <- knn2nb(knearneigh(coords, k=1, longlat=FALSE))
> col.nb.0.all <- dnearneigh(coords, 0, llk1)

Wrong function argument again, llk1 is an nb object, not a scalar 
distance. Again, please do read the help pages carefully. You need to find 
the maximum of the first nearest neighbour distances, but I advise against 
this here.

Advice, please do read the help pages carefully, and relevant literature, 
for example ASDAR as as www.asdar-book.org.

Roger


> col.nb.0.all
> summary(col.nb.0.all)
> ols_error_REALM2<-errorsarlm(ols_lm, listw=col.nb.0.all, na.action =
> na.omit, zero.policy = T, data = Cells)
>
>
>
>
>
> However the memory required is large - 16GB.
>
>
>
> This won't run on my computer,  I therefore had two questions:
>
>
>
> First, is the process I am doing correct - or can it be done in a more
> efficient way?
>
>
>
> Second, can I take a subsample of the data i.e every other cell and run the
> analysis? OR find a way of subsetting and "re-joining"?
>
>
>
> Thanks in advance,
>
>
>
> Chris
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From chrismcowen at gmail.com  Mon Dec 12 12:48:07 2011
From: chrismcowen at gmail.com (Chris Mcowen)
Date: Mon, 12 Dec 2011 11:48:07 -0000
Subject: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
In-Reply-To: <alpine.LRH.2.00.1112121140290.22991@reclus.nhh.no>
References: <000c01ccb8b5$edfacdd0$c9f06970$@com>
	<alpine.LRH.2.00.1112121140290.22991@reclus.nhh.no>
Message-ID: <002401ccb8c3$eb52d6f0$c1f884d0$@com>

Thanks Roger,

I am aware it may look like I did not read the help page but I did.

I tried to include the longlat argument and got this:

coords<-cbind(Cells$Lat,Cells$Lon)
nb1.5<-dnearneigh(coords,0,1.5, longlat = TRUE)
Warning message:
In dnearneigh(coords, 0, 1.5, longlat = TRUE) :
  Coordinates are not geographical: longlat argument wrong


> head(Cells$Lon)
[1] 121.75 120.75 121.25 121.75 122.25 119.75
> head(Cells$Lat)
[1] 41.25 40.75 40.75 40.75 40.75 40.25



In regards to the formula in the errorsarlm, I was following the method of
Kissling and Carl 2008:

#######################
#OLS model for organism 1
ols<-lm(data$organism1~data$rain+data$jungle)
summary(ols)
res.ols <- residuals(ols)

#######################

#######################
#SARerr model with neighbourhood distance 1.5 and coding style "W"

#Specify SARerr model
sem.nb1.5.w<-errorsarlm(ols, listw=nb1.5.w)
summary(sem.nb1.5.w)
res.sem.nb1.5.w <- residuals(sem.nb1.5.w)

#######################



In regards to the sparse matrix:

If I am honest, I was unaware of what this does.. I had seen it used in
situations with large datasets, but methodologically I am unsure what it is
doing - I ran it and it completed very quickly, I was unsure why this was
the case. I appreciate I should read up on the methodology behind this
before reporting my results.

Thanks

Chris



-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: 12 December 2011 10:51
To: Chris Mcowen
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Removing spatial autocorrelation - Memory limits

On Mon, 12 Dec 2011, Chris Mcowen wrote:

> Dear List,
>
> I am trying to model variation is fisheries catch, I have a large data 
> set (36574) cells , with knowledge of the tonnes of fish caught in each 
> "Cell" ( .5 degree) global cells.
>
> At present I am simply wanting to investigate if certain "area" (clusters
of
> cells) have high numbers of fish than others
>
> Due to the grid nature of the data set I have significant spatial
> autocorrelation in the data set.
>
> I have tried:
>
> REALM_gls <- gls(tonnesperkm_log~REALM, correlation = corGaus(form =~Lat +
> Lon), data = Cells)
>
> coords<-cbind(Cells$Lat,Cells$Lon)
> coords<-as.matrix(coords)
> nb1.5<-dnearneigh(coords,0,1.5)
> nb1.5.w<-nb2listw(nb1.5, glist=NULL, style="W", zero.policy=TRUE)
> ols_lm<-lm(Cells$tonnesperkm_log~Cells$REALM)
> ols_lm_error_REALM<-errorsarlm(ols_lm, listw=nb1.5.w, na.action = na.omit,
> zero.policy = T, data = Cells)

This is not right, the first argument to errorsarlm() is a formula object. 
Did you look at the help page? If you did, did you look at the method= 
argument, which offers among others sparse matrix methods for larger N?
You may have no-neighbour observations, just see the help page. In 
addition, you have geographical coordinates, so should set the arguments 
to dnearneigh appropriately - here they are assuming a planar surface, but 
may be OK to recover neighbours.

> llk1 <- knn2nb(knearneigh(coords, k=1, longlat=FALSE))
> col.nb.0.all <- dnearneigh(coords, 0, llk1)

Wrong function argument again, llk1 is an nb object, not a scalar 
distance. Again, please do read the help pages carefully. You need to find 
the maximum of the first nearest neighbour distances, but I advise against 
this here.

Advice, please do read the help pages carefully, and relevant literature, 
for example ASDAR as as www.asdar-book.org.

Roger


> col.nb.0.all
> summary(col.nb.0.all)
> ols_error_REALM2<-errorsarlm(ols_lm, listw=col.nb.0.all, na.action =
> na.omit, zero.policy = T, data = Cells)
>
>
>
>
>
> However the memory required is large - 16GB.
>
>
>
> This won't run on my computer,  I therefore had two questions:
>
>
>
> First, is the process I am doing correct - or can it be done in a more
> efficient way?
>
>
>
> Second, can I take a subsample of the data i.e every other cell and run
the
> analysis? OR find a way of subsetting and "re-joining"?
>
>
>
> Thanks in advance,
>
>
>
> Chris
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From sam856040 at gmail.com  Mon Dec 12 13:13:34 2011
From: sam856040 at gmail.com (Sam smith)
Date: Mon, 12 Dec 2011 12:13:34 +0000
Subject: [R-sig-Geo] Pairwise t test with spatial strucutre
In-Reply-To: <CAKZr0U1oajUf1qbB+Hfth6G0dHSq6vjaWSn0sWKk6bKRQqc8Nw@mail.gmail.com>
References: <CAKZr0U1oajUf1qbB+Hfth6G0dHSq6vjaWSn0sWKk6bKRQqc8Nw@mail.gmail.com>
Message-ID: <CAKZr0U10camHPTLCoyjaESChmjN__u8_d66t_ysFxO7MWMSJGg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111212/af7e5096/attachment.pl>

From janverbesselt at gmail.com  Mon Dec 12 13:21:37 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Mon, 12 Dec 2011 13:21:37 +0100
Subject: [R-sig-Geo]
	=?iso-8859-1?q?how_to_set_projection_of_a_raster_to_P?=
	=?iso-8859-1?q?late-Carr=E9e_with_a_Geographic_Lat/Lon_representat?=
	=?iso-8859-1?q?ion_=28GCTP=5FGEO=29=2C_WGS_84?=
In-Reply-To: <CANtt_hwvnBobwXZ-oh-1gUeX9NFw00tYejnxyfDX7WT2Gne_Yw@mail.gmail.com>
References: <CAHKDjo6jmLf64cTky5z=k2xM9sHLVM-nnBXOJxnZ14A-rc-q=Q@mail.gmail.com>
	<CANtt_hwvnBobwXZ-oh-1gUeX9NFw00tYejnxyfDX7WT2Gne_Yw@mail.gmail.com>
Message-ID: <CAHKDjo5c=NpUXT4VcZeLFnaGsGS=xWH1aURGjzcVjH-qxVsa=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111212/3a303708/attachment.pl>

From Jan.Quets at ua.ac.be  Mon Dec 12 14:27:04 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Mon, 12 Dec 2011 13:27:04 +0000
Subject: [R-sig-Geo] plot.im annoyances
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F8481@xmail32.ad.ua.ac.be>

Hello all,

I have several issues with using plot.im to plot a density map.

4 images are can be found here:

http://www.ua.ac.be/main.aspx?c=jan.quets&n=74655&ct=69642

and the codes that produced them are printed below in this mail:

the issues are:

1) cex.main doesn't work, cannot scale font of title

2) setting margins with mar=c(x,x,x,x) does not seem to work as it should: from image1 to image 4 I made attempts to include both title and text below the plot visible
		a) in image1 and image4, the title is topped of, because it is not completely inside the box; at image2 and3 the title is completely outside the box, yet visible (???)
		b) the first and third entry in mar=c(x,x,x,x), should refer to bottom and top, but when you look at image3, the opposite is true (margins get wider left and right)
		c) when I (because of b)) increase the second and third entry in mar=c(x,x,x,x) to increase bottom and top margins, it worked, but the title also heightens together with the margin, so that it is still not completely visible 

3) uninvited white lines traversing plot area

4) axes=FALSE didn't work, ticks and labels on the ribbon are still there

5) while not setting axes=FALSE, I tried to increase the font size of the ribbon labels with, cex.axis=3, but that didn't work either


could someone enlighten be what is going on?

kind regards,
Jan
---------------------------------------------------------------------------------------------------------
#code image1.jpg

jpeg("./output/densmap.jpg", width = 8, height = 8*aspect, units="in",res=50)
	par(mar=c(0,0,0,0))
	plot(densim,ribscale=1/(mpp^2),ribsep=0.05,axes=FALSE,main=paste("density map"),cex.main=5);box();
	text(4000,-150,labels=paste("kernel's standard deviation: ",round(attr(densim,"sigma")*mpp,2)," m"),cex=2)
dev.off()

#code image2.jpg

jpeg("./output/densmap.jpg", width = 8, height = 8*aspect, units="in",res=50)
	par(mar=c(0,0,5,0))
	plot(densim,ribscale=1/(mpp^2),ribsep=0.05,axes=FALSE,main=paste("density map"),cex.main=5);box();
	text(4000,-150,labels=paste("kernel's standard deviation: ",round(attr(densim,"sigma")*mpp,2)," m"),cex=2)
dev.off()

#code image3.jpg

jpeg("./output/densmap.jpg", width = 8, height = 8*aspect, units="in",res=50)
	par(mar=c(5,0,5,0))
	plot(densim,ribscale=1/(mpp^2),ribsep=0.05,axes=FALSE,main=paste("density map"),cex.main=15);box();
	text(4000,-150,labels=paste("kernel's standard deviation: ",round(attr(densim,"sigma")*mpp,2)," m"),cex=2)
dev.off()

#code image4.jpg

jpeg("./output/densmap.jpg", width = 8, height = 8*aspect, units="in",res=50)
	par(mar=c(0,5,0,5))
	plot(densim,ribscale=1/(mpp^2),ribsep=0.05,axes=FALSE,main=paste("density map"),cex.main=15);box();
	text(4000,-150,labels=paste("kernel's standard deviation: ",round(attr(densim,"sigma")*mpp,2)," m"),cex=2)
dev.off()


From Roger.Bivand at nhh.no  Mon Dec 12 14:37:15 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Dec 2011 14:37:15 +0100 (CET)
Subject: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
In-Reply-To: <002401ccb8c3$eb52d6f0$c1f884d0$@com>
References: <000c01ccb8b5$edfacdd0$c9f06970$@com>
	<alpine.LRH.2.00.1112121140290.22991@reclus.nhh.no>
	<002401ccb8c3$eb52d6f0$c1f884d0$@com>
Message-ID: <alpine.LRH.2.00.1112121405080.23761@reclus.nhh.no>

On Mon, 12 Dec 2011, Chris Mcowen wrote:

> Thanks Roger,
>
> I am aware it may look like I did not read the help page but I did.
>
> I tried to include the longlat argument and got this:
>
> coords<-cbind(Cells$Lat,Cells$Lon)
> nb1.5<-dnearneigh(coords,0,1.5, longlat = TRUE)
> Warning message:
> In dnearneigh(coords, 0, 1.5, longlat = TRUE) :
>  Coordinates are not geographical: longlat argument wrong
>
>
>> head(Cells$Lon)
> [1] 121.75 120.75 121.25 121.75 122.25 119.75
>> head(Cells$Lat)
> [1] 41.25 40.75 40.75 40.75 40.75 40.25
>

The test is for values exceeding the -90 to 90 and -180 to 180 or 0 to 360 
ranges, specifically sp:::.ll_sanity(bbox(coords)), but is issued as 
warning to accommodate edge issues. The 1.5km distance here would be very 
narrow, I guess that 150km would be closer to your needs. In fact here, a 
Queen contiguity would look like a planar distance, so you can choose 
between the kinds of spatial processes you feel might be relevant.

>
>
> In regards to the formula in the errorsarlm, I was following the method of
> Kissling and Carl 2008:

OK, so if you are following their lead, this is where the issues are 
coming from. They do write in the Word file of the supplementary material:

ols<-lm(data$organism1~data$rain+data$jungle)
sem.nb1.5.w<-errorsarlm(ols, listw=nb1.5.w)

but as far as I am aware, this never worked, because ols is an lm object, 
not a formula object. They should have written:

ols <- lm(organism ~ rain + jungle, data=data)
sem.nb1.5.w <- errorsarlm(organism ~ rain + jungle, data=data,
   listw=nb1.5.w)

You can get there by coercing ols to a formula for the first version:

ols <- lm(data$organism1~data$rain+data$jungle)
sem.nb1.5.w <- errorsarlm(formula(ols), listw=nb1.5.w)

and for the second version by providing the data= argument:

ols <- lm(organism ~ rain + jungle, data=data)
sem.nb1.5.w <- errorsarlm(formula(ols), data=data, listw=nb1.5.w)

but that isn't what they say. It is cleaner to say:

fm0 <- formula(organism ~ rain + jungle)
ols <- lm(fm0, data=data)
sem.nb1.5.w <- errorsarlm(fm0, data=data, listw=nb1.5.w)

and perhaps use update() methods on the formula object if needed.

>
> #######################
> #OLS model for organism 1
> ols<-lm(data$organism1~data$rain+data$jungle)
> summary(ols)
> res.ols <- residuals(ols)
>
> #######################
>
> #######################
> #SARerr model with neighbourhood distance 1.5 and coding style "W"
>
> #Specify SARerr model
> sem.nb1.5.w<-errorsarlm(ols, listw=nb1.5.w)
> summary(sem.nb1.5.w)
> res.sem.nb1.5.w <- residuals(sem.nb1.5.w)
>
> #######################
>
>
>
> In regards to the sparse matrix:
>
> If I am honest, I was unaware of what this does.. I had seen it used in
> situations with large datasets, but methodologically I am unsure what it is
> doing - I ran it and it completed very quickly, I was unsure why this was
> the case. I appreciate I should read up on the methodology behind this
> before reporting my results.

There are references on the help page - if you used the prefered Matrix 
method, which gives an exact result, Barry & Pace and LeSage & Pace are 
relevant.

Hope this clarifies,

Roger

>
> Thanks
>
> Chris
>
>
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: 12 December 2011 10:51
> To: Chris Mcowen
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
>
> On Mon, 12 Dec 2011, Chris Mcowen wrote:
>
>> Dear List,
>>
>> I am trying to model variation is fisheries catch, I have a large data
>> set (36574) cells , with knowledge of the tonnes of fish caught in each
>> "Cell" ( .5 degree) global cells.
>>
>> At present I am simply wanting to investigate if certain "area" (clusters
> of
>> cells) have high numbers of fish than others
>>
>> Due to the grid nature of the data set I have significant spatial
>> autocorrelation in the data set.
>>
>> I have tried:
>>
>> REALM_gls <- gls(tonnesperkm_log~REALM, correlation = corGaus(form =~Lat +
>> Lon), data = Cells)
>>
>> coords<-cbind(Cells$Lat,Cells$Lon)
>> coords<-as.matrix(coords)
>> nb1.5<-dnearneigh(coords,0,1.5)
>> nb1.5.w<-nb2listw(nb1.5, glist=NULL, style="W", zero.policy=TRUE)
>> ols_lm<-lm(Cells$tonnesperkm_log~Cells$REALM)
>> ols_lm_error_REALM<-errorsarlm(ols_lm, listw=nb1.5.w, na.action = na.omit,
>> zero.policy = T, data = Cells)
>
> This is not right, the first argument to errorsarlm() is a formula object.
> Did you look at the help page? If you did, did you look at the method=
> argument, which offers among others sparse matrix methods for larger N?
> You may have no-neighbour observations, just see the help page. In
> addition, you have geographical coordinates, so should set the arguments
> to dnearneigh appropriately - here they are assuming a planar surface, but
> may be OK to recover neighbours.
>
>> llk1 <- knn2nb(knearneigh(coords, k=1, longlat=FALSE))
>> col.nb.0.all <- dnearneigh(coords, 0, llk1)
>
> Wrong function argument again, llk1 is an nb object, not a scalar
> distance. Again, please do read the help pages carefully. You need to find
> the maximum of the first nearest neighbour distances, but I advise against
> this here.
>
> Advice, please do read the help pages carefully, and relevant literature,
> for example ASDAR as as www.asdar-book.org.
>
> Roger
>
>
>> col.nb.0.all
>> summary(col.nb.0.all)
>> ols_error_REALM2<-errorsarlm(ols_lm, listw=col.nb.0.all, na.action =
>> na.omit, zero.policy = T, data = Cells)
>>
>>
>>
>>
>>
>> However the memory required is large - 16GB.
>>
>>
>>
>> This won't run on my computer,  I therefore had two questions:
>>
>>
>>
>> First, is the process I am doing correct - or can it be done in a more
>> efficient way?
>>
>>
>>
>> Second, can I take a subsample of the data i.e every other cell and run
> the
>> analysis? OR find a way of subsetting and "re-joining"?
>>
>>
>>
>> Thanks in advance,
>>
>>
>>
>> Chris
>>
>>
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From a.mosnier at gmail.com  Mon Dec 12 14:57:58 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 12 Dec 2011 08:57:58 -0500
Subject: [R-sig-Geo] Removing spatial autocorrelation - Memory limits
Message-ID: <CANkFkEerOs9JVNaE_4nvyDoqPCf68z4hSio=m63sM73ZL6i6ug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111212/a012a14c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Dec 12 14:59:47 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 12 Dec 2011 13:59:47 +0000
Subject: [R-sig-Geo] plot.im annoyances
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F8481@xmail32.ad.ua.ac.be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F8481@xmail32.ad.ua.ac.be>
Message-ID: <CANVKczPeSuhfn5-=S2F7nKFSdBMQ7=NgqycykoouKuCjWwFeaw@mail.gmail.com>

On Mon, Dec 12, 2011 at 1:27 PM, Quets Jan <Jan.Quets at ua.ac.be> wrote:

> and the codes that produced them are printed below in this mail:

 The codes, yes,  but neither the data nor the description of your
system nor the version of R and relevant packages. You're likely to
get either nothing or a bunch of 'works for me' messages. What's
'plot.im' anyway?

 Reproducible examples with either standard datasets or synthetic data
will get you a much better response..

Barry


From alobolistas at gmail.com  Tue Dec 13 08:14:27 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 08:14:27 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
Message-ID: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>

Hi!

I have this problem and think it's related to rgdal (or rather to gdal).

r <- raster(ncol=10, nrow=10)
r1 <- init(r, fun=runif)
r2 <- init(r, fun=runif)
r3 <- overlay(r1, r2, fun=function(x,y){return(x+y)})
> writeRaster(r3,filename="delme.tif",format="GTiff",overwrite=T,datatype="FLT4S")
Error in .local(.Object, ...) : Unable to create dataset
> sp2003 <- brick(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
Error in .rasterObjectFromFile(x, objecttype = "RasterBrick", ...) :
 Cannot create a RasterLayer object from this file.
> delme = readGDAL(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
Error in .local(.Object, ...) :

`/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
not recognised as a supported file format.

> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
Error in .local(.Object, ...) :

`/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
not recognised as a supported file format.

I can read/write any external file not using rgdal, and save() and
save.image() work fine:
> save.image()
> x = data.frame(var1=1:10,var2=LETTERS[1:10])
> x
   var1 var2
1     1    A
2     2    B
3     3    C
4     4    D
5     5    E
6     6    F
7     7    G
8     8    H
9     9    I
10   10    J
> write.csv(x,file="x.csv")
> x2 <- read.csv("x.csv")
> x2
    X var1 var2
1   1    1    A
2   2    2    B
3   3    3    C
4   4    4    D
5   5    5    E
6   6    6    F
7   7    7    G
8   8    8    H
9   9    9    I
10 10   10    J

It seems to me a problem with gdal, my version is 1.8.0.2 from
ubuntugis-unstable binaries for ubuntu 10.04
Are you aware of any problem with gdal and/or rgdal?

Thanks,

Agus

> sessionInfo()
R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C LC_TIME=en_US.UTF-8
 LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C
              LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-5   raster_1.9-55 sp_0.9-89

loaded via a namespace (and not attached):
[1] grid_2.14.0     lattice_0.19-30 tools_2.14.0


From alobolistas at gmail.com  Tue Dec 13 10:29:42 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 10:29:42 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
Message-ID: <CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>

Just adding more details: gdalinfo works fine on the same file for
which infoGDAL() fails:

Also, after reinstalling rgdal from cran, I get a warning:
> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
Error in .local(.Object, ...) :
  WARNING ! libtiff version mismatch : You're linking against libtiff
3.X but GDAL has been compiled against libtiff >= 4.0.0
> system("gdalinfo /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif",intern=T)
 [1] "Driver: GTiff/GeoTIFF"
 [2] "Files: /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif"
 [3] "       /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tfw"
 [4] "       /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif.aux.xml"
 [5] "Size is 2221, 1950"
 [6] "Coordinate System is:"
 [7] "PROJCS[\"ED50 / UTM zone 31N\","
 [8] "    GEOGCS[\"ED50\","
 [9] "        DATUM[\"European_Datum_1950\","
[10] "            SPHEROID[\"International
1924\",6378388,297.0000000000014,"
[11] "                AUTHORITY[\"EPSG\",\"7022\"]],"
[12] "            AUTHORITY[\"EPSG\",\"6230\"]],"
[13] "        PRIMEM[\"Greenwich\",0],"
[14] "        UNIT[\"degree\",0.0174532925199433],"
[15] "        AUTHORITY[\"EPSG\",\"4230\"]],"
[16] "    PROJECTION[\"Transverse_Mercator\"],"
[17] "    PARAMETER[\"latitude_of_origin\",0],"
[18] "    PARAMETER[\"central_meridian\",3],"
[19] "    PARAMETER[\"scale_factor\",0.9996],"
[20] "    PARAMETER[\"false_easting\",500000],"
[21] "    PARAMETER[\"false_northing\",0],"
[22] "    UNIT[\"metre\",1,"
[23] "        AUTHORITY[\"EPSG\",\"9001\"]],"
[24] "    AUTHORITY[\"EPSG\",\"23031\"]]"
[25] "Origin = (404629.090000000025611,4624285.299999999813735)"
[26] "Pixel Size = (10.000000000000000,-10.000000000000000)"
[27] "Metadata:"
[28] "  TIFFTAG_XRESOLUTION=300"
[29] "  TIFFTAG_YRESOLUTION=300"
[30] "  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)"
[31] "  AREA_OR_POINT=Area"
[32] "Image Structure Metadata:"
[33] "  INTERLEAVE=PIXEL"
[34] "Corner Coordinates:"
[35] "Upper Left  (  404629.090, 4624285.300) (  1d51' 9.77\"E,
41d45'50.20\"N)"
[36] "Lower Left  (  404629.090, 4604785.300) (  1d51'20.98\"E,
41d35'18.04\"N)"
[37] "Upper Right (  426839.090, 4624285.300) (  2d 7'11.49\"E,
41d45'58.68\"N)"
[38] "Lower Right (  426839.090, 4604785.300) (  2d 7'20.10\"E,
41d35'26.47\"N)"
[39] "Center      (  415734.090, 4614535.300) (  1d59'15.58\"E,
41d40'38.63\"N)"
[40] "Band 1 Block=2221x16 Type=Byte, ColorInterp=Gray"
[41] "Band 2 Block=2221x16 Type=Byte, ColorInterp=Undefined"
[42] "Band 3 Block=2221x16 Type=Byte, ColorInterp=Undefined"
[43] "Band 4 Block=2221x16 Type=Byte, ColorInterp=Undefined"



Agus


2011/12/13 Agustin Lobo <alobolistas at gmail.com>:
> Hi!
>
> I have this problem and think it's related to rgdal (or rather to gdal).
>
> r <- raster(ncol=10, nrow=10)
> r1 <- init(r, fun=runif)
> r2 <- init(r, fun=runif)
> r3 <- overlay(r1, r2, fun=function(x,y){return(x+y)})
>> writeRaster(r3,filename="delme.tif",format="GTiff",overwrite=T,datatype="FLT4S")
> Error in .local(.Object, ...) : Unable to create dataset
>> sp2003 <- brick(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
> Error in .rasterObjectFromFile(x, objecttype = "RasterBrick", ...) :
> ?Cannot create a RasterLayer object from this file.
>> delme = readGDAL(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
> Error in .local(.Object, ...) :
>
> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
> not recognised as a supported file format.
>
>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
> Error in .local(.Object, ...) :
>
> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
> not recognised as a supported file format.
>
> I can read/write any external file not using rgdal, and save() and
> save.image() work fine:
>> save.image()
>> x = data.frame(var1=1:10,var2=LETTERS[1:10])
>> x
> ? var1 var2
> 1 ? ? 1 ? ?A
> 2 ? ? 2 ? ?B
> 3 ? ? 3 ? ?C
> 4 ? ? 4 ? ?D
> 5 ? ? 5 ? ?E
> 6 ? ? 6 ? ?F
> 7 ? ? 7 ? ?G
> 8 ? ? 8 ? ?H
> 9 ? ? 9 ? ?I
> 10 ? 10 ? ?J
>> write.csv(x,file="x.csv")
>> x2 <- read.csv("x.csv")
>> x2
> ? ?X var1 var2
> 1 ? 1 ? ?1 ? ?A
> 2 ? 2 ? ?2 ? ?B
> 3 ? 3 ? ?3 ? ?C
> 4 ? 4 ? ?4 ? ?D
> 5 ? 5 ? ?5 ? ?E
> 6 ? 6 ? ?6 ? ?F
> 7 ? 7 ? ?7 ? ?G
> 8 ? 8 ? ?8 ? ?H
> 9 ? 9 ? ?9 ? ?I
> 10 10 ? 10 ? ?J
>
> It seems to me a problem with gdal, my version is 1.8.0.2 from
> ubuntugis-unstable binaries for ubuntu 10.04
> Are you aware of any problem with gdal and/or rgdal?
>
> Thanks,
>
> Agus
>
>> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C LC_TIME=en_US.UTF-8
> ?LC_COLLATE=en_US.UTF-8
> ?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8 ? ?LC_PAPER=C
> ? ? ? ? ? ? ?LC_NAME=C
> ?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C
> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
> other attached packages:
> [1] rgdal_0.7-5 ? raster_1.9-55 sp_0.9-89
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.0 ? ? lattice_0.19-30 tools_2.14.0


From r.m.krug at gmail.com  Tue Dec 13 10:45:37 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 13 Dec 2011 10:45:37 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
Message-ID: <4EE71EC1.4040104@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/12/11 10:29, Agustin Lobo wrote:
> Also, after reinstalling rgdal from cran, I get a warning:
>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=3D""))
>
>> 
Error in .local(.Object, ...) :
> WARNING ! libtiff version mismatch : You're linking against
> libtiff 3.X but GDAL has been compiled against libtiff >=3D 4.0.0

I had a simlar problem, and this is when I started (as Roger Bivand
suggested to me) to install gdal from source and use this one as a
gdal installation for rgdal - then it worked.

If you install gdal in your home directory, you *can* leave the
systemwide from repo installed, as several problems rely on it, but
you have to set PATH and point rgdal to the installation of gdal in
the home directory.

Other option: use checkinstall to create a package of gdal and install
it systemwide (haven't done this yet, just thought about it...).

Cheers,

Rainer

<--- SNIP --->


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7nHsEACgkQoYgNqgF2egqMhACfYR+XulzgRwQL8SvQbmf/Ym91
xQsAnRRw0uarGxx6sGdWdRAhGuwVpUBg
=gRMF
-----END PGP SIGNATURE-----


From alobolistas at gmail.com  Tue Dec 13 10:46:36 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 10:46:36 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
	<CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
Message-ID: <CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>

More details: the problem occurs with tif files only, therefore it
seems that the warning message
points to the actual problem. Unfortunately, I'm not skilled to go
beyond this and really do not know what to do.

> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
Error in .local(.Object, ...) :
  WARNING ! libtiff version mismatch : You're linking against libtiff
3.X but GDAL has been compiled against libtiff >= 4.0.0

> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp")
rows        532
columns     1093
bands       3
origin.x        71725.2
origin.y        5130101
res.x       0.5965674
res.y       0.5965674
ysign       -1
oblique.x   0
oblique.y   0
driver      BMP
projection  NA
file        /media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp
apparent band summary:
  GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
1   Byte    0  255 122.93389 57.72138          FALSE           0
2   Byte    0  255 117.77019 48.26621          FALSE           0
3   Byte    0  255  83.67153 45.79935          FALSE           0
> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
Error in .local(.Object, ...) :
  `/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif'
not recognised as a supported file format.


Agus

2011/12/13 Agustin Lobo <alobolistas at gmail.com>:
> Just adding more details: gdalinfo works fine on the same file for
> which infoGDAL() fails:
>
> Also, after reinstalling rgdal from cran, I get a warning:
>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
> Error in .local(.Object, ...) :
> ?WARNING ! libtiff version mismatch : You're linking against libtiff
> 3.X but GDAL has been compiled against libtiff >= 4.0.0
>> system("gdalinfo /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif",intern=T)
> ?[1] "Driver: GTiff/GeoTIFF"
> ?[2] "Files: /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif"
> ?[3] " ? ? ? /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tfw"
> ?[4] " ? ? ? /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif.aux.xml"
> ?[5] "Size is 2221, 1950"
> ?[6] "Coordinate System is:"
> ?[7] "PROJCS[\"ED50 / UTM zone 31N\","
> ?[8] " ? ?GEOGCS[\"ED50\","
> ?[9] " ? ? ? ?DATUM[\"European_Datum_1950\","
> [10] " ? ? ? ? ? ?SPHEROID[\"International
> 1924\",6378388,297.0000000000014,"
> [11] " ? ? ? ? ? ? ? ?AUTHORITY[\"EPSG\",\"7022\"]],"
> [12] " ? ? ? ? ? ?AUTHORITY[\"EPSG\",\"6230\"]],"
> [13] " ? ? ? ?PRIMEM[\"Greenwich\",0],"
> [14] " ? ? ? ?UNIT[\"degree\",0.0174532925199433],"
> [15] " ? ? ? ?AUTHORITY[\"EPSG\",\"4230\"]],"
> [16] " ? ?PROJECTION[\"Transverse_Mercator\"],"
> [17] " ? ?PARAMETER[\"latitude_of_origin\",0],"
> [18] " ? ?PARAMETER[\"central_meridian\",3],"
> [19] " ? ?PARAMETER[\"scale_factor\",0.9996],"
> [20] " ? ?PARAMETER[\"false_easting\",500000],"
> [21] " ? ?PARAMETER[\"false_northing\",0],"
> [22] " ? ?UNIT[\"metre\",1,"
> [23] " ? ? ? ?AUTHORITY[\"EPSG\",\"9001\"]],"
> [24] " ? ?AUTHORITY[\"EPSG\",\"23031\"]]"
> [25] "Origin = (404629.090000000025611,4624285.299999999813735)"
> [26] "Pixel Size = (10.000000000000000,-10.000000000000000)"
> [27] "Metadata:"
> [28] " ?TIFFTAG_XRESOLUTION=300"
> [29] " ?TIFFTAG_YRESOLUTION=300"
> [30] " ?TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)"
> [31] " ?AREA_OR_POINT=Area"
> [32] "Image Structure Metadata:"
> [33] " ?INTERLEAVE=PIXEL"
> [34] "Corner Coordinates:"
> [35] "Upper Left ?( ?404629.090, 4624285.300) ( ?1d51' 9.77\"E,
> 41d45'50.20\"N)"
> [36] "Lower Left ?( ?404629.090, 4604785.300) ( ?1d51'20.98\"E,
> 41d35'18.04\"N)"
> [37] "Upper Right ( ?426839.090, 4624285.300) ( ?2d 7'11.49\"E,
> 41d45'58.68\"N)"
> [38] "Lower Right ( ?426839.090, 4604785.300) ( ?2d 7'20.10\"E,
> 41d35'26.47\"N)"
> [39] "Center ? ? ?( ?415734.090, 4614535.300) ( ?1d59'15.58\"E,
> 41d40'38.63\"N)"
> [40] "Band 1 Block=2221x16 Type=Byte, ColorInterp=Gray"
> [41] "Band 2 Block=2221x16 Type=Byte, ColorInterp=Undefined"
> [42] "Band 3 Block=2221x16 Type=Byte, ColorInterp=Undefined"
> [43] "Band 4 Block=2221x16 Type=Byte, ColorInterp=Undefined"
>
>
>
> Agus
>
>
> 2011/12/13 Agustin Lobo <alobolistas at gmail.com>:
>> Hi!
>>
>> I have this problem and think it's related to rgdal (or rather to gdal).
>>
>> r <- raster(ncol=10, nrow=10)
>> r1 <- init(r, fun=runif)
>> r2 <- init(r, fun=runif)
>> r3 <- overlay(r1, r2, fun=function(x,y){return(x+y)})
>>> writeRaster(r3,filename="delme.tif",format="GTiff",overwrite=T,datatype="FLT4S")
>> Error in .local(.Object, ...) : Unable to create dataset
>>> sp2003 <- brick(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>> Error in .rasterObjectFromFile(x, objecttype = "RasterBrick", ...) :
>> ?Cannot create a RasterLayer object from this file.
>>> delme = readGDAL(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>> Error in .local(.Object, ...) :
>>
>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>> not recognised as a supported file format.
>>
>>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>> Error in .local(.Object, ...) :
>>
>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>> not recognised as a supported file format.
>>
>> I can read/write any external file not using rgdal, and save() and
>> save.image() work fine:
>>> save.image()
>>> x = data.frame(var1=1:10,var2=LETTERS[1:10])
>>> x
>> ? var1 var2
>> 1 ? ? 1 ? ?A
>> 2 ? ? 2 ? ?B
>> 3 ? ? 3 ? ?C
>> 4 ? ? 4 ? ?D
>> 5 ? ? 5 ? ?E
>> 6 ? ? 6 ? ?F
>> 7 ? ? 7 ? ?G
>> 8 ? ? 8 ? ?H
>> 9 ? ? 9 ? ?I
>> 10 ? 10 ? ?J
>>> write.csv(x,file="x.csv")
>>> x2 <- read.csv("x.csv")
>>> x2
>> ? ?X var1 var2
>> 1 ? 1 ? ?1 ? ?A
>> 2 ? 2 ? ?2 ? ?B
>> 3 ? 3 ? ?3 ? ?C
>> 4 ? 4 ? ?4 ? ?D
>> 5 ? 5 ? ?5 ? ?E
>> 6 ? 6 ? ?6 ? ?F
>> 7 ? 7 ? ?7 ? ?G
>> 8 ? 8 ? ?8 ? ?H
>> 9 ? 9 ? ?9 ? ?I
>> 10 10 ? 10 ? ?J
>>
>> It seems to me a problem with gdal, my version is 1.8.0.2 from
>> ubuntugis-unstable binaries for ubuntu 10.04
>> Are you aware of any problem with gdal and/or rgdal?
>>
>> Thanks,
>>
>> Agus
>>
>>> sessionInfo()
>> R version 2.14.0 (2011-10-31)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C LC_TIME=en_US.UTF-8
>> ?LC_COLLATE=en_US.UTF-8
>> ?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8 ? ?LC_PAPER=C
>> ? ? ? ? ? ? ?LC_NAME=C
>> ?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C
>> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>> other attached packages:
>> [1] rgdal_0.7-5 ? raster_1.9-55 sp_0.9-89
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.14.0 ? ? lattice_0.19-30 tools_2.14.0


From rlist at zeidlers.de  Tue Dec 13 10:55:40 2011
From: rlist at zeidlers.de (Julian Zeidler)
Date: Tue, 13 Dec 2011 10:55:40 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
	<CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
	<CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
Message-ID: <4EE7211C.1060608@zeidlers.de>

Hi Agustin,


I had a similar problem with updating to a newer gdal Version.  Rgdal 
was still linked to the old one.
The problem disappeared after removing and reinstalling rgdal.

If the above does not solve your issue have a look at your version of 
libtiff and try to update it.

Best,
Julian


On 13.12.2011 10:46, Agustin Lobo wrote:
> More details: the problem occurs with tif files only, therefore it
> seems that the warning message
> points to the actual problem. Unfortunately, I'm not skilled to go
> beyond this and really do not know what to do.
>
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
> Error in .local(.Object, ...) :
>    WARNING ! libtiff version mismatch : You're linking against libtiff
> 3.X but GDAL has been compiled against libtiff>= 4.0.0
>
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp")
> rows        532
> columns     1093
> bands       3
> origin.x        71725.2
> origin.y        5130101
> res.x       0.5965674
> res.y       0.5965674
> ysign       -1
> oblique.x   0
> oblique.y   0
> driver      BMP
> projection  NA
> file        /media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp
> apparent band summary:
>    GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
> 1   Byte    0  255 122.93389 57.72138          FALSE           0
> 2   Byte    0  255 117.77019 48.26621          FALSE           0
> 3   Byte    0  255  83.67153 45.79935          FALSE           0
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
> Error in .local(.Object, ...) :
>    `/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif'
> not recognised as a supported file format.
>
>
> Agus
>
> 2011/12/13 Agustin Lobo<alobolistas at gmail.com>:
>> Just adding more details: gdalinfo works fine on the same file for
>> which infoGDAL() fails:
>>
>> Also, after reinstalling rgdal from cran, I get a warning:
>>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>> Error in .local(.Object, ...) :
>>   WARNING ! libtiff version mismatch : You're linking against libtiff
>> 3.X but GDAL has been compiled against libtiff>= 4.0.0
>>> system("gdalinfo /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif",intern=T)
>>   [1] "Driver: GTiff/GeoTIFF"
>>   [2] "Files: /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif"
>>   [3] "       /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tfw"
>>   [4] "       /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif.aux.xml"
>>   [5] "Size is 2221, 1950"
>>   [6] "Coordinate System is:"
>>   [7] "PROJCS[\"ED50 / UTM zone 31N\","
>>   [8] "    GEOGCS[\"ED50\","
>>   [9] "        DATUM[\"European_Datum_1950\","
>> [10] "            SPHEROID[\"International
>> 1924\",6378388,297.0000000000014,"
>> [11] "                AUTHORITY[\"EPSG\",\"7022\"]],"
>> [12] "            AUTHORITY[\"EPSG\",\"6230\"]],"
>> [13] "        PRIMEM[\"Greenwich\",0],"
>> [14] "        UNIT[\"degree\",0.0174532925199433],"
>> [15] "        AUTHORITY[\"EPSG\",\"4230\"]],"
>> [16] "    PROJECTION[\"Transverse_Mercator\"],"
>> [17] "    PARAMETER[\"latitude_of_origin\",0],"
>> [18] "    PARAMETER[\"central_meridian\",3],"
>> [19] "    PARAMETER[\"scale_factor\",0.9996],"
>> [20] "    PARAMETER[\"false_easting\",500000],"
>> [21] "    PARAMETER[\"false_northing\",0],"
>> [22] "    UNIT[\"metre\",1,"
>> [23] "        AUTHORITY[\"EPSG\",\"9001\"]],"
>> [24] "    AUTHORITY[\"EPSG\",\"23031\"]]"
>> [25] "Origin = (404629.090000000025611,4624285.299999999813735)"
>> [26] "Pixel Size = (10.000000000000000,-10.000000000000000)"
>> [27] "Metadata:"
>> [28] "  TIFFTAG_XRESOLUTION=300"
>> [29] "  TIFFTAG_YRESOLUTION=300"
>> [30] "  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)"
>> [31] "  AREA_OR_POINT=Area"
>> [32] "Image Structure Metadata:"
>> [33] "  INTERLEAVE=PIXEL"
>> [34] "Corner Coordinates:"
>> [35] "Upper Left  (  404629.090, 4624285.300) (  1d51' 9.77\"E,
>> 41d45'50.20\"N)"
>> [36] "Lower Left  (  404629.090, 4604785.300) (  1d51'20.98\"E,
>> 41d35'18.04\"N)"
>> [37] "Upper Right (  426839.090, 4624285.300) (  2d 7'11.49\"E,
>> 41d45'58.68\"N)"
>> [38] "Lower Right (  426839.090, 4604785.300) (  2d 7'20.10\"E,
>> 41d35'26.47\"N)"
>> [39] "Center      (  415734.090, 4614535.300) (  1d59'15.58\"E,
>> 41d40'38.63\"N)"
>> [40] "Band 1 Block=2221x16 Type=Byte, ColorInterp=Gray"
>> [41] "Band 2 Block=2221x16 Type=Byte, ColorInterp=Undefined"
>> [42] "Band 3 Block=2221x16 Type=Byte, ColorInterp=Undefined"
>> [43] "Band 4 Block=2221x16 Type=Byte, ColorInterp=Undefined"
>>
>>
>>
>> Agus
>>
>>
>> 2011/12/13 Agustin Lobo<alobolistas at gmail.com>:
>>> Hi!
>>>
>>> I have this problem and think it's related to rgdal (or rather to gdal).
>>>
>>> r<- raster(ncol=10, nrow=10)
>>> r1<- init(r, fun=runif)
>>> r2<- init(r, fun=runif)
>>> r3<- overlay(r1, r2, fun=function(x,y){return(x+y)})
>>>> writeRaster(r3,filename="delme.tif",format="GTiff",overwrite=T,datatype="FLT4S")
>>> Error in .local(.Object, ...) : Unable to create dataset
>>>> sp2003<- brick(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>> Error in .rasterObjectFromFile(x, objecttype = "RasterBrick", ...) :
>>>   Cannot create a RasterLayer object from this file.
>>>> delme = readGDAL(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>> Error in .local(.Object, ...) :
>>>
>>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>>> not recognised as a supported file format.
>>>
>>>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>> Error in .local(.Object, ...) :
>>>
>>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>>> not recognised as a supported file format.
>>>
>>> I can read/write any external file not using rgdal, and save() and
>>> save.image() work fine:
>>>> save.image()
>>>> x = data.frame(var1=1:10,var2=LETTERS[1:10])
>>>> x
>>>    var1 var2
>>> 1     1    A
>>> 2     2    B
>>> 3     3    C
>>> 4     4    D
>>> 5     5    E
>>> 6     6    F
>>> 7     7    G
>>> 8     8    H
>>> 9     9    I
>>> 10   10    J
>>>> write.csv(x,file="x.csv")
>>>> x2<- read.csv("x.csv")
>>>> x2
>>>     X var1 var2
>>> 1   1    1    A
>>> 2   2    2    B
>>> 3   3    3    C
>>> 4   4    4    D
>>> 5   5    5    E
>>> 6   6    6    F
>>> 7   7    7    G
>>> 8   8    8    H
>>> 9   9    9    I
>>> 10 10   10    J
>>>
>>> It seems to me a problem with gdal, my version is 1.8.0.2 from
>>> ubuntugis-unstable binaries for ubuntu 10.04
>>> Are you aware of any problem with gdal and/or rgdal?
>>>
>>> Thanks,
>>>
>>> Agus
>>>
>>>> sessionInfo()
>>> R version 2.14.0 (2011-10-31)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C LC_TIME=en_US.UTF-8
>>>   LC_COLLATE=en_US.UTF-8
>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C
>>>               LC_NAME=C
>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.7-5   raster_1.9-55 sp_0.9-89
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.14.0     lattice_0.19-30 tools_2.14.0
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.m.krug at gmail.com  Tue Dec 13 10:58:57 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 13 Dec 2011 10:58:57 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
	<CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
	<CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
Message-ID: <4EE721E1.4050902@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/12/11 10:46, Agustin Lobo wrote:
> More details: the problem occurs with tif files only, therefore it 
> seems that the warning message points to the actual problem.
> Unfortunately, I'm not skilled to go beyond this and really do not
> know what to do.

You could install the gdal version on the Ubuntu repository - that one
works. Just remember to lock this version in synaptic.

Cheers,

Rainer

> 
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
>
>> 
Error in .local(.Object, ...) :
> WARNING ! libtiff version mismatch : You're linking against
> libtiff 3.X but GDAL has been compiled against libtiff >= 4.0.0
> 
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp")
>
>> 
rows        532
> columns     1093 bands       3 origin.x        71725.2 origin.y
> 5130101 res.x       0.5965674 res.y       0.5965674 ysign       -1 
> oblique.x   0 oblique.y   0 driver      BMP projection  NA file
> /media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/algerri_goomercator.bmp
>
> 
apparent band summary:
> GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue 1
> Byte    0  255 122.93389 57.72138          FALSE           0 2
> Byte    0  255 117.77019 48.26621          FALSE           0 3
> Byte    0  255  83.67153 45.79935          FALSE           0
>> GDALinfo("/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif")
>
>> 
Error in .local(.Object, ...) :
> `/media/Iomega_HDD/UAVetal/CALIBRACIONRADIOM/TETRACAM6/FISIOV_UB/ALGERRI/ilerfly/125-6b-111010b.tif'
>
> 
not recognised as a supported file format.
> 
> 
> Agus
> 
> 2011/12/13 Agustin Lobo <alobolistas at gmail.com>:
>> Just adding more details: gdalinfo works fine on the same file
>> for which infoGDAL() fails:
>> 
>> Also, after reinstalling rgdal from cran, I get a warning:
>>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>
>>> 
Error in .local(.Object, ...) :
>> WARNING ! libtiff version mismatch : You're linking against
>> libtiff 3.X but GDAL has been compiled against libtiff >= 4.0.0
>>> system("gdalinfo
>>> /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif",intern=T)
>>
>>> 
[1] "Driver: GTiff/GeoTIFF"
>> [2] "Files:
>> /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif"
>>
>> 
[3] "
/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tfw"
>> [4] "
>> /media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif.aux.xml"
>>
>> 
[5] "Size is 2221, 1950"
>> [6] "Coordinate System is:" [7] "PROJCS[\"ED50 / UTM zone
>> 31N\"," [8] "    GEOGCS[\"ED50\"," [9] "
>> DATUM[\"European_Datum_1950\"," [10] "
>> SPHEROID[\"International 1924\",6378388,297.0000000000014," [11]
>> "                AUTHORITY[\"EPSG\",\"7022\"]]," [12] "
>> AUTHORITY[\"EPSG\",\"6230\"]]," [13] "
>> PRIMEM[\"Greenwich\",0]," [14] "
>> UNIT[\"degree\",0.0174532925199433]," [15] "
>> AUTHORITY[\"EPSG\",\"4230\"]]," [16] "
>> PROJECTION[\"Transverse_Mercator\"]," [17] "
>> PARAMETER[\"latitude_of_origin\",0]," [18] "
>> PARAMETER[\"central_meridian\",3]," [19] "
>> PARAMETER[\"scale_factor\",0.9996]," [20] "
>> PARAMETER[\"false_easting\",500000]," [21] "
>> PARAMETER[\"false_northing\",0]," [22] "    UNIT[\"metre\",1," 
>> [23] "        AUTHORITY[\"EPSG\",\"9001\"]]," [24] "
>> AUTHORITY[\"EPSG\",\"23031\"]]" [25] "Origin =
>> (404629.090000000025611,4624285.299999999813735)" [26] "Pixel
>> Size = (10.000000000000000,-10.000000000000000)" [27]
>> "Metadata:" [28] "  TIFFTAG_XRESOLUTION=300" [29] "
>> TIFFTAG_YRESOLUTION=300" [30] "  TIFFTAG_RESOLUTIONUNIT=2
>> (pixels/inch)" [31] "  AREA_OR_POINT=Area" [32] "Image Structure
>> Metadata:" [33] "  INTERLEAVE=PIXEL" [34] "Corner Coordinates:" 
>> [35] "Upper Left  (  404629.090, 4624285.300) (  1d51' 9.77\"E, 
>> 41d45'50.20\"N)" [36] "Lower Left  (  404629.090, 4604785.300) (
>> 1d51'20.98\"E, 41d35'18.04\"N)" [37] "Upper Right (  426839.090,
>> 4624285.300) (  2d 7'11.49\"E, 41d45'58.68\"N)" [38] "Lower Right
>> (  426839.090, 4604785.300) (  2d 7'20.10\"E, 41d35'26.47\"N)" 
>> [39] "Center      (  415734.090, 4614535.300) (  1d59'15.58\"E, 
>> 41d40'38.63\"N)" [40] "Band 1 Block=2221x16 Type=Byte,
>> ColorInterp=Gray" [41] "Band 2 Block=2221x16 Type=Byte,
>> ColorInterp=Undefined" [42] "Band 3 Block=2221x16 Type=Byte,
>> ColorInterp=Undefined" [43] "Band 4 Block=2221x16 Type=Byte,
>> ColorInterp=Undefined"
>> 
>> 
>> 
>> Agus
>> 
>> 
>> 2011/12/13 Agustin Lobo <alobolistas at gmail.com>:
>>> Hi!
>>> 
>>> I have this problem and think it's related to rgdal (or rather
>>> to gdal).
>>> 
>>> r <- raster(ncol=10, nrow=10) r1 <- init(r, fun=runif) r2 <-
>>> init(r, fun=runif) r3 <- overlay(r1, r2,
>>> fun=function(x,y){return(x+y)})
>>>> writeRaster(r3,filename="delme.tif",format="GTiff",overwrite=T,datatype="FLT4S")
>>>
>>>> 
Error in .local(.Object, ...) : Unable to create dataset
>>>> sp2003 <-
>>>> brick(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>>
>>>> 
Error in .rasterObjectFromFile(x, objecttype = "RasterBrick", ...) :
>>> Cannot create a RasterLayer object from this file.
>>>> delme =
>>>> readGDAL(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>>
>>>> 
Error in .local(.Object, ...) :
>>> 
>>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>>>
>>> 
not recognised as a supported file format.
>>> 
>>>> GDALinfo(paste(datawd,"/SPOTmultispectral/SP2003ATC_atm2.tif",sep=""))
>>>
>>>> 
Error in .local(.Object, ...) :
>>> 
>>> `/media/Iomega_HDD/MASTER_ICTA2007_2008/ExercisesJEMES/ExerciseFIRESPOT/Data_ExerciseFIRESPOT/SPOTmultispectral/SP2003ATC_atm2.tif'
>>>
>>> 
not recognised as a supported file format.
>>> 
>>> I can read/write any external file not using rgdal, and save()
>>> and save.image() work fine:
>>>> save.image() x = data.frame(var1=1:10,var2=LETTERS[1:10]) x
>>> var1 var2 1     1    A 2     2    B 3     3    C 4     4    D 5
>>> 5    E 6     6    F 7     7    G 8     8    H 9     9    I 10
>>> 10    J
>>>> write.csv(x,file="x.csv") x2 <- read.csv("x.csv") x2
>>> X var1 var2 1   1    1    A 2   2    2    B 3   3    3    C 4
>>> 4    4    D 5   5    5    E 6   6    6    F 7   7    7    G 8
>>> 8    8    H 9   9    9    I 10 10   10    J
>>> 
>>> It seems to me a problem with gdal, my version is 1.8.0.2 from 
>>> ubuntugis-unstable binaries for ubuntu 10.04 Are you aware of
>>> any problem with gdal and/or rgdal?
>>> 
>>> Thanks,
>>> 
>>> Agus
>>> 
>>>> sessionInfo()
>>> R version 2.14.0 (2011-10-31) Platform: x86_64-pc-linux-gnu
>>> (64-bit)
>>> 
>>> locale: [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8 [5]
>>> LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> LC_PAPER=C LC_NAME=C [9] LC_ADDRESS=C
>>> LC_TELEPHONE=C LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>> 
>>> attached base packages: [1] stats     graphics  grDevices utils
>>> datasets  methods   base
>>> 
>>> other attached packages: [1] rgdal_0.7-5   raster_1.9-55
>>> sp_0.9-89
>>> 
>>> loaded via a namespace (and not attached): [1] grid_2.14.0
>>> lattice_0.19-30 tools_2.14.0
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7nIeAACgkQoYgNqgF2egrK0wCbBzu8r+j3/5H18mM3r6hSlUux
8n0AoIEz0Ii/TGqlUGg/LUNdUf60lrMg
=ysHN
-----END PGP SIGNATURE-----


From alobolistas at gmail.com  Tue Dec 13 11:09:47 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 11:09:47 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <4EE721E1.4050902@gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
	<CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
	<CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
	<4EE721E1.4050902@gmail.com>
Message-ID: <CAG4NReKbdRoFifECLQGJT3ewL4cTQCweLayiv+TiJREJowEfhg@mail.gmail.com>

Do you mean libgdal1-1.8 from ubuntugis-unstable? This is what I have
(I think, actually Synaptic does not
tell you from which repo the packages comes from and I do not know how
to actually make sure
my libgdal comes from).
Also, what do you mean by "locking"? selecting "Mark Recommended for
installation"?
Thanks
Agus

2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 13/12/11 10:46, Agustin Lobo wrote:
>> More details: the problem occurs with tif files only, therefore it
>> seems that the warning message points to the actual problem.
>> Unfortunately, I'm not skilled to go beyond this and really do not
>> know what to do.
>
> You could install the gdal version on the Ubuntu repository - that one
> works. Just remember to lock this version in synaptic.
>
> Cheers,
>
> Rainer
>


From Michael.Q.Klein at gmail.com  Tue Dec 13 11:36:14 2011
From: Michael.Q.Klein at gmail.com (Michael Klein)
Date: Tue, 13 Dec 2011 11:36:14 +0100
Subject: [R-sig-Geo] spatial covariance in the glmm in brain data
Message-ID: <4EE72A9E.6090306@gmail.com>


Dear List,

I am a beginner or R (just started last week) and I am not exactly a freak
in theoretical statistics, so please excuse me, if my questions are naive or
contain mistakes. This might also not be your standard problem since it
is about brain imaging data. However, it seems that I have to deal with a
problem that you seem to be very familiar with.

I try to model time frequency data with the glmm while either correcting
for spatial covariance or removing the spatial covariance somehow.
More precisely, I try to model the mean power change for time frequency
bins by the fixed factors TIME and FREQ and the random factor SUBJECT.
Since in time-frequency data, the values of time frequency bins are not
spatially independent, I would like to either remove that dependence or
correct for it.

I must have read a dozen papers and pages and posts and came up with
something that might be going in the right direction. However, I need to 
be sure
that this is doing what I want it to do:

My data (tfbins, value: mean_change) is basically the result of an 
average for
every subject for each time freq bin and then the percentage signal change
between the two conditions. So for every subject I have one time freq 
matrix
(everything transformed to a data frame).

To model the spatial covariance, I understood (maybe incorrectly) that I 
can use
a corExp term. So here is what I came up with. Instead of x and y spatial
coordinates, I just use time and freq:

model_spatial_2 <- glmmPQL(mean_change~time*freq, random = ~1|sub, 
correlation=corExp(form=~time+freq), data = tfbins, family = "gaussian")

Any thoughts on that would be very much appreciated.

Best regards,
Michael


From r.m.krug at gmail.com  Tue Dec 13 11:38:45 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 13 Dec 2011 11:38:45 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NReKbdRoFifECLQGJT3ewL4cTQCweLayiv+TiJREJowEfhg@mail.gmail.com>
References: <CAG4NReJ=WSifd+650eNfcVX5Lq_8WSViwW48MeYuwrrLkuC+Jw@mail.gmail.com>
	<CAG4NReJAA4SHqDSDgtHB17=1Qyv8HMfHm7OFGrEyEFMcAAn3SQ@mail.gmail.com>
	<CAG4NRe+gxwiA+7nEnw8VwHzWH3sPfm_+uq8_ZjnSeUbduUgrFA@mail.gmail.com>
	<4EE721E1.4050902@gmail.com>
	<CAG4NReKbdRoFifECLQGJT3ewL4cTQCweLayiv+TiJREJowEfhg@mail.gmail.com>
Message-ID: <4EE72B35.2090306@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/12/11 11:09, Agustin Lobo wrote:
> Do you mean libgdal1-1.8 from ubuntugis-unstable? \

That is the culprit - yes.

> This is what I have (I think, actually Synaptic does not tell you
> from which repo the packages comes from and I do not know how to
> actually make sure my libgdal comes from).

Yes, this is sometimes tricky, but if you right-click on libgdal, and
select propertiesm, which gives you an indication where it comes from.

Also, you cal select ion the left side "Origin", and it shows you all
the repositories.

> Also, what do you mean by "locking"? selecting "Mark Recommended
> for installation"?

The version from Oneiric is libgdal1-1.7.0. Just install it, and just
uninstal 1.1.8. As I said, there might be some dependency issues, if
you use other packages from ubuntugis-unstable - just try it out.

As these have different names, you do not have to lock the version.

Then you obviously have to reinstall rgdal.

Rainer

> Thanks Agus
> 
> 2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
>> -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1
>> 
>> On 13/12/11 10:46, Agustin Lobo wrote:
>>> More details: the problem occurs with tif files only, therefore
>>> it seems that the warning message points to the actual
>>> problem. Unfortunately, I'm not skilled to go beyond this and
>>> really do not know what to do.
>> 
>> You could install the gdal version on the Ubuntu repository -
>> that one works. Just remember to lock this version in synaptic.
>> 
>> Cheers,
>> 
>> Rainer
>> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7nKzUACgkQoYgNqgF2egpFrwCfYyNJZ4sYRvV5PKQJ9uAmUKOv
NyAAnRcLOBklVmXGkNCOikuLf2GuZjH1
=jKAR
-----END PGP SIGNATURE-----


From spareeth at gmail.com  Tue Dec 13 12:03:40 2011
From: spareeth at gmail.com (sajid pareeth)
Date: Tue, 13 Dec 2011 16:33:40 +0530
Subject: [R-sig-Geo] Adding raster files from a folder
Message-ID: <CAO7vHBFH0YHH3S2aS8qzHzaarx4XhQAZiir1b2nafeJwwQgFpw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/898187c2/attachment.pl>

From ghoermann at hydrology.uni-kiel.de  Tue Dec 13 12:10:17 2011
From: ghoermann at hydrology.uni-kiel.de (=?ISO-8859-1?Q?Georg_H=F6rmann?=)
Date: Tue, 13 Dec 2011 12:10:17 +0100
Subject: [R-sig-Geo] How to plot attributes of a shapefile?
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
Message-ID: <4EE73299.80503@hydrology.uni-kiel.de>

Hello World,

I am somehow stuck with a simple GIS problem.
I have a landuse map imported from ArcGIS in
shapefile format. Everything is ok,
but if I plot the map. it only plots the polygons
without attributes.
I want to plot the map with the attribute
"GRIDCODE", which is the code for the landuse.
The only solution I found was to convert everything
to a raster file, but then I lose information...


The structure is:
 > str(myLanduse at data)
'data.frame':   7716 obs. of  6 variables:
  $ ID       : int  31469 31470 31471 31472 31473 31474 31475 31476 
31477 31478 ...
  $ GRIDCODE : int  1 2 6 1 1 6 4 2 6 2 ...
  $ AREA     : num  1720 1718 907 636 1232 ...
  $ PERIMETER: num  169 169 123 107 161 ...
  $ ACRES    : num  0.425 0.424 0.224 0.157 0.305 0.777 0.363 0.411 0.18 
0.354 ...
  $ HECTARES : num  0.172 0.172 0.091 0.064 0.123 0.314 0.147 0.166 
0.073 0.143 ...
  - attr(*, "data_types")= chr  "N" "N" "N" "N" ...

Actually I am using this solution:

LUTemplate <- raster(ncol=110, nrow=110, crs=as.character(NA))
extent(LUTemplate)  <-  extent(myLanduse)
LUraster <- rasterize(myLanduse, LUTemplate, field="GRIDCODE")

I would like a solution like :-)

plot(myLanduse, attribute="GRIDCODE")

Any hints?

Thanks,
Georg


From tom.gottfried at tum.de  Tue Dec 13 12:27:25 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Tue, 13 Dec 2011 12:27:25 +0100
Subject: [R-sig-Geo] How to plot attributes of a shapefile?
In-Reply-To: <4EE73299.80503@hydrology.uni-kiel.de>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
	<4EE73299.80503@hydrology.uni-kiel.de>
Message-ID: <4EE7369D.6060304@tum.de>

spplot(myLanduse, "GRIDCODE")

regards,
Tom

Am 13.12.2011 12:10, schrieb Georg H?rmann:
> Hello World,
>
> I am somehow stuck with a simple GIS problem.
> I have a landuse map imported from ArcGIS in
> shapefile format. Everything is ok,
> but if I plot the map. it only plots the polygons
> without attributes.
> I want to plot the map with the attribute
> "GRIDCODE", which is the code for the landuse.
> The only solution I found was to convert everything
> to a raster file, but then I lose information...
>
>
> The structure is:
>  > str(myLanduse at data)
> 'data.frame': 7716 obs. of 6 variables:
> $ ID : int 31469 31470 31471 31472 31473 31474 31475 31476 31477 31478 ...
> $ GRIDCODE : int 1 2 6 1 1 6 4 2 6 2 ...
> $ AREA : num 1720 1718 907 636 1232 ...
> $ PERIMETER: num 169 169 123 107 161 ...
> $ ACRES : num 0.425 0.424 0.224 0.157 0.305 0.777 0.363 0.411 0.18 0.354 ...
> $ HECTARES : num 0.172 0.172 0.091 0.064 0.123 0.314 0.147 0.166 0.073 0.143 ...
> - attr(*, "data_types")= chr "N" "N" "N" "N" ...
>
> Actually I am using this solution:
>
> LUTemplate <- raster(ncol=110, nrow=110, crs=as.character(NA))
> extent(LUTemplate) <- extent(myLanduse)
> LUraster <- rasterize(myLanduse, LUTemplate, field="GRIDCODE")
>
> I would like a solution like :-)
>
> plot(myLanduse, attribute="GRIDCODE")
>
> Any hints?
>
> Thanks,
> Georg
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From alobolistas at gmail.com  Tue Dec 13 13:27:23 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 13:27:23 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <4EE71EC1.4040104@gmail.com>
References: <4EE71EC1.4040104@gmail.com>
Message-ID: <CAG4NReJ76tKCVntNmsfiDTC2NBCSQPNZDHYA4fmv1V0iN4AMAQ@mail.gmail.com>

2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
> -----BEGIN PGP SIGNED MESSAGE-----
> If you install gdal in your home directory, you *can* leave the
> systemwide from repo installed, as several problems rely on it, but
> you have to set PATH and point rgdal to the installation of gdal in
> the home directory.
>

Or actually just using libgdal 1.7, but how can I indicate rgdal to use a given
libgdal? where can I modify the PATH for this?

Thanks


From sam856040 at gmail.com  Tue Dec 13 13:27:49 2011
From: sam856040 at gmail.com (Sam smith)
Date: Tue, 13 Dec 2011 12:27:49 +0000
Subject: [R-sig-Geo] Lat / Long - x/y?
Message-ID: <CAKZr0U2Adh8iY=VEW=F0XnPADcpjOPxjurMkDS-CBZFKARXNnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/94d6004b/attachment.pl>

From tom.gottfried at tum.de  Tue Dec 13 13:40:52 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Tue, 13 Dec 2011 13:40:52 +0100
Subject: [R-sig-Geo] Lat / Long - x/y?
In-Reply-To: <CAKZr0U2Adh8iY=VEW=F0XnPADcpjOPxjurMkDS-CBZFKARXNnw@mail.gmail.com>
References: <CAKZr0U2Adh8iY=VEW=F0XnPADcpjOPxjurMkDS-CBZFKARXNnw@mail.gmail.com>
Message-ID: <4EE747D4.6070308@tum.de>

Hi Sam,

Am 13.12.2011 13:27, schrieb Sam smith:
> Dear List i have been provided spatial data in the format lat/lon and i
> have realised that alot of functions in R require x/y coordinates i.e.
> positive integers only.

as far as I'm aware, coordinates are kept in numeric/double.

> I appreciate converting between the two is hard, taking into
> account projection, especially on the global scale that i am working.
>
> However i was wondering if there was a package / function that any body
> knew of that could do it? Or can arcGIS?

Could do what? Projection? In this case:

library(rgdal)
?spTransform

regards,
Tom

>
> Thanks
>
> Sam
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From r.m.krug at gmail.com  Tue Dec 13 13:45:03 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 13 Dec 2011 13:45:03 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NReJ76tKCVntNmsfiDTC2NBCSQPNZDHYA4fmv1V0iN4AMAQ@mail.gmail.com>
References: <4EE71EC1.4040104@gmail.com>
	<CAG4NReJ76tKCVntNmsfiDTC2NBCSQPNZDHYA4fmv1V0iN4AMAQ@mail.gmail.com>
Message-ID: <4EE748CF.8010500@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/12/11 13:27, Agustin Lobo wrote:
> 2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
>> -----BEGIN PGP SIGNED MESSAGE----- If you install gdal in your
>> home directory, you *can* leave the systemwide from repo
>> installed, as several problems rely on it, but you have to set
>> PATH and point rgdal to the installation of gdal in the home
>> directory.
>> 
> 
> Or actually just using libgdal 1.7, but how can I indicate rgdal to
> use a given libgdal? where can I modify the PATH for this?

You have to use configure.args (when using install.packages) or
?configure-args when using R CMD INSTALL

Just google - you should find the correct arguments there.

Rainer


> 
> Thanks


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7nSM8ACgkQoYgNqgF2egp4vwCfcdr6/F/Gf19osSMzJV/Eh2pL
/HYAn1azq42s5kRXJ4aTtHnfqINa9K2Q
=BlWf
-----END PGP SIGNATURE-----


From R.Catarino at MARLAB.AC.UK  Tue Dec 13 13:50:57 2011
From: R.Catarino at MARLAB.AC.UK (Rui Catarino)
Date: Tue, 13 Dec 2011 12:50:57 -0000
Subject: [R-sig-Geo] Acessing slot information in spatialPolygon class
Message-ID: <1BA13B469D9E89408AAA651AC9B309160E4C1E@sose0009g.marlab.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/b6a22c7e/attachment.pl>

From sam856040 at gmail.com  Tue Dec 13 13:52:21 2011
From: sam856040 at gmail.com (Sam smith)
Date: Tue, 13 Dec 2011 12:52:21 +0000
Subject: [R-sig-Geo] Lat / Long - x/y?
In-Reply-To: <4EE747D4.6070308@tum.de>
References: <CAKZr0U2Adh8iY=VEW=F0XnPADcpjOPxjurMkDS-CBZFKARXNnw@mail.gmail.com>
	<4EE747D4.6070308@tum.de>
Message-ID: <CAKZr0U03iHcr8s+hqg6M+cwmx1PCMJhmCYZpbE29JV98Na-L1g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/2a5f6d6b/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Tue Dec 13 14:24:32 2011
From: jon.skoien at jrc.ec.europa.eu (jon.skoien at jrc.ec.europa.eu)
Date: Tue, 13 Dec 2011 14:24:32 +0100
Subject: [R-sig-Geo] Adding raster files from a folder
In-Reply-To: <CAO7vHBFH0YHH3S2aS8qzHzaarx4XhQAZiir1b2nafeJwwQgFpw@mail.gmail.com>
References: <CAO7vHBFH0YHH3S2aS8qzHzaarx4XhQAZiir1b2nafeJwwQgFpw@mail.gmail.com>
Message-ID: <4EE75210.4080404@jrc.ec.europa.eu>

Hi Sajid,

You should be able to do something like this:

setwd( name of folder)
fls = list.files() # you can add a pattern if you only want files of a 
certain type
dst = stack(fls[1])
for (ifile in 2:length(fls)) dst = addLayer(dst, raster(fls[ifile]))

And I am sure someone can do this even shorter...

Cheers,
Jon

On 13-Dec-11 12:03, sajid pareeth wrote:
> Hi
>
> I have number of raster files(more than 100) in a folder for which I want
> to do some zonal stats.
>
> My question is how to add these raster files into R environment. Is there
> any way to do that together? Like batch files, where we give the folder and
> all the files from that folder will be processed automatically.
>
> I want to make a stack of these rasters and do the processing.
>
> So instead of typing each file names in Stack (r1,r2,r3....) , I want to
> call them automatically from a folder.
>
> Any idea in this direction???
>
> Thanks and Regards
>
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Global Environment Monitoring Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From jon.skoien at jrc.ec.europa.eu  Tue Dec 13 14:25:33 2011
From: jon.skoien at jrc.ec.europa.eu (jon.skoien at jrc.ec.europa.eu)
Date: Tue, 13 Dec 2011 14:25:33 +0100
Subject: [R-sig-Geo] Acessing slot information in spatialPolygon class
In-Reply-To: <1BA13B469D9E89408AAA651AC9B309160E4C1E@sose0009g.marlab.ac.uk>
References: <1BA13B469D9E89408AAA651AC9B309160E4C1E@sose0009g.marlab.ac.uk>
Message-ID: <4EE7524D.70506@jrc.ec.europa.eu>

Hi Rui,

I think the following should give you what you are looking for:
res$area2 = sapply(slot(res,"polygons"), function(x) slot(x, "area"))

Cheers,
Jon

On 13-Dec-11 13:50, Rui Catarino wrote:
> Dear all,
>
>
>
> This may seem a very obvious question but I'm suck and for the past 2h I
> haven't been able of solving the problem. So for the sake of
> productivity I'll ask for some help:
>
>
>
> I have a SpatialPolygon Class that looks like(see bellow) in the example
> below I have only 2 polygons but they will be thousands. What I'm trying
> to achieve is a list with the total area of each polygon.
>
>
>
> Thanks in advance
>
>
>
>> str(res)
> Formal class 'SpatialPolygons' [package "sp"] with 4 slots
>
>    ..@ polygons   :List of 2
>
>    .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
>
>    .. .. .. ..@ Polygons :List of 9
>
>    .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
>
>    .. .. .. .. .. .. ..@ labpt  : num [1:2] 3.19 51.68
>
>    .. .. .. .. .. .. ..@ area   : num 8.96e-05
>
>    .. .. .. .. .. .. ..@ hole   : logi FALSE
>
>    .. .. .. .. .. .. ..@ ringDir: int 1
>
>    .. .. .. .. .. .. ..@ coords : num [1:5, 1:2] 3.18 3.18 3.19 3.2 3.18
> ...
>
> .
>
> .
>
> .
>
>
>
>    .. .. .. ..@ plotOrder: int [1:9] 9 8 2 3 1 4 7 5 6
>
>    .. .. .. ..@ labpt    : num [1:2] 3.14 51.67
>
>    .. .. .. ..@ ID       : chr "2"
>
>    .. .. .. ..@ area     : num 0.000993
>
>    ..@ plotOrder  : int [1:2] 2 1
>
>    ..@ bbox       : num [1:2, 1:2] 3.09 51.66 3.26 51.73
>
>    .. ..- attr(*, "dimnames")=List of 2
>
>    .. .. ..$ : chr [1:2] "x" "y"
>
>    .. .. ..$ : chr [1:2] "min" "max"
>
>    ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>
>    .. .. ..@ projargs: chr NA
>
>
>
>
>
>
>
>
>
>
>
> Rui Catarino
>
> Scientific Officer
>
> Fishery Systems Group
>
> Marine Scotland - Science
>
>
>
> Scottish Government | 36 |B |Marine Laboratory, PO Box 101| 375,
> Victoria Road | Aberdeen AB11 9DB
>
>
>
> Tel:  +44 (0)1224 295572
>
> Mob:+44 (0)7530 240666
>
> Fax: +44 (0)1224 295511
>
> e: r.catarino at marlab.ac.uk
>
> w: http://www.scotland.gov.uk/marinescotland
> <http://www.scotland.gov.uk/marinescotland>
>
>
>
>
> ______________________________________________________________________
> This email has been scanned by the Symantec Email Security.cloud service.
> For more information please visit http://www.symanteccloud.com
> ______________________________________________________________________
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Global Environment Monitoring Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From alobolistas at gmail.com  Tue Dec 13 14:27:49 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Dec 2011 14:27:49 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <4EE748CF.8010500@gmail.com>
References: <4EE71EC1.4040104@gmail.com>
	<CAG4NReJ76tKCVntNmsfiDTC2NBCSQPNZDHYA4fmv1V0iN4AMAQ@mail.gmail.com>
	<4EE748CF.8010500@gmail.com>
Message-ID: <CAG4NRe+TfmsZynF9zFMvMLo+nSZ0QCE4=R611AsSjVXDP9osxg@mail.gmail.com>

Well, after googling quite a bit, could not really find the exact
syntax for the
configure.args in this case, probably because of my inexperience on
these issues.

But, in parallel, another solution has been suggested by Julien Malik
(see http://orfeo-toolbox.org/otb/) as he had had this problem few weeks ago
and actually made a correctly build libgdal for otb.

The solution is:
1. Make sure you have the otb repo in your list:
http://ppa.launchpad.net/otb/orfeotoolbox-stable-ubuntugis/ubuntu
(in my case, lucid)
2. Run
sudo aptitude install libgdal1-1.8.0=1.8.0-2~lucid2+otb2
libgdal1-dev=1.8.0-2~lucid2+otb2
3. remove and install rgdal from cran

Now I have libgdal1-1.8.0 flagged as upgradeable in Synaptic, but will
not do it until the
package is fixed there.

Thanks a lot Julien!

2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 13/12/11 13:27, Agustin Lobo wrote:
>> 2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
>>> -----BEGIN PGP SIGNED MESSAGE----- If you install gdal in your
>>> home directory, you *can* leave the systemwide from repo
>>> installed, as several problems rely on it, but you have to set
>>> PATH and point rgdal to the installation of gdal in the home
>>> directory.
>>>
>>
>> Or actually just using libgdal 1.7, but how can I indicate rgdal to
>> use a given libgdal? where can I modify the PATH for this?
>
> You have to use configure.args (when using install.packages) or
> ?configure-args when using R CMD INSTALL
>
> Just google - you should find the correct arguments there.
>
> Rainer
>
>
>>
>> Thanks
>
>
> - --
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
> Biology, UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
>
> Tel : ? ? ? +33 - (0)9 53 10 27 44
> Cell: ? ? ? +33 - (0)6 85 62 59 98
> Fax : ? ? ? +33 - (0)9 58 10 27 44
>
> Fax (D): ? ?+49 - (0)3 21 21 25 22 44
>
> email: ? ? ?Rainer at krugs.de
>
> Skype: ? ? ?RMkrug
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.11 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
>
> iEYEARECAAYFAk7nSM8ACgkQoYgNqgF2egp4vwCfcdr6/F/Gf19osSMzJV/Eh2pL
> /HYAn1azq42s5kRXJ4aTtHnfqINa9K2Q
> =BlWf
> -----END PGP SIGNATURE-----


From r.m.krug at gmail.com  Tue Dec 13 14:34:41 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 13 Dec 2011 14:34:41 +0100
Subject: [R-sig-Geo] Problem reading files through rgdal
In-Reply-To: <CAG4NRe+TfmsZynF9zFMvMLo+nSZ0QCE4=R611AsSjVXDP9osxg@mail.gmail.com>
References: <4EE71EC1.4040104@gmail.com>
	<CAG4NReJ76tKCVntNmsfiDTC2NBCSQPNZDHYA4fmv1V0iN4AMAQ@mail.gmail.com>
	<4EE748CF.8010500@gmail.com>
	<CAG4NRe+TfmsZynF9zFMvMLo+nSZ0QCE4=R611AsSjVXDP9osxg@mail.gmail.com>
Message-ID: <4EE75471.5060001@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I just saw that email as well - I'll follow the same path.

Thanks for posting this here,

Cheers,

Rainer

On 13/12/11 14:27, Agustin Lobo wrote:
> Well, after googling quite a bit, could not really find the exact 
> syntax for the configure.args in this case, probably because of my
> inexperience on these issues.
> 
> But, in parallel, another solution has been suggested by Julien
> Malik (see http://orfeo-toolbox.org/otb/) as he had had this
> problem few weeks ago and actually made a correctly build libgdal
> for otb.
> 
> The solution is: 1. Make sure you have the otb repo in your list: 
> http://ppa.launchpad.net/otb/orfeotoolbox-stable-ubuntugis/ubuntu 
> (in my case, lucid) 2. Run sudo aptitude install
> libgdal1-1.8.0=1.8.0-2~lucid2+otb2 
> libgdal1-dev=1.8.0-2~lucid2+otb2 3. remove and install rgdal from
> cran
> 
> Now I have libgdal1-1.8.0 flagged as upgradeable in Synaptic, but
> will not do it until the package is fixed there.
> 
> Thanks a lot Julien!
> 
> 2011/12/13 Rainer M Krug <r.m.krug at gmail.com>: On 13/12/11 13:27,
> Agustin Lobo wrote:
>>>> 2011/12/13 Rainer M Krug <r.m.krug at gmail.com>:
>>>>> -----BEGIN PGP SIGNED MESSAGE----- If you install gdal in
>>>>> your home directory, you *can* leave the systemwide from
>>>>> repo installed, as several problems rely on it, but you
>>>>> have to set PATH and point rgdal to the installation of
>>>>> gdal in the home directory.
>>>>> 
>>>> 
>>>> Or actually just using libgdal 1.7, but how can I indicate
>>>> rgdal to use a given libgdal? where can I modify the PATH for
>>>> this?
> 
> You have to use configure.args (when using install.packages) or 
> ?configure-args when using R CMD INSTALL
> 
> Just google - you should find the correct arguments there.
> 
> Rainer
> 
> 
>>>> 
>>>> Thanks
> 
> 

- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7nVHEACgkQoYgNqgF2egowFwCeNT7a+9pc7E95U023E1ii3m8F
bq0AnRJzP6yAQ2UgX46N9h0KYawl1DNH
=4gfg
-----END PGP SIGNATURE-----


From R.Catarino at MARLAB.AC.UK  Tue Dec 13 14:46:23 2011
From: R.Catarino at MARLAB.AC.UK (Rui Catarino)
Date: Tue, 13 Dec 2011 13:46:23 -0000
Subject: [R-sig-Geo] Acessing slot information in spatialPolygon class
References: <1BA13B469D9E89408AAA651AC9B309160E4C1E@sose0009g.marlab.ac.uk>
	<4EE7524D.70506@jrc.ec.europa.eu>
Message-ID: <1BA13B469D9E89408AAA651AC9B309160E4C1F@sose0009g.marlab.ac.uk>

Hi Jon,

Thank you for your quick reply, which solved the problem with just a small change in your line of code.

Using the code below I get an error message:

res$area2 = sapply(slot(res,"polygons"), function(x) slot(x, "area"))

Error in `$<-`(`*tmp*`, "area2", value = c(0.000452308218606559, 0.00099334172367839 : no $<- method for object without attributes

But if I use the:
area2 = sapply(slot(res,"polygons"), function(x) slot(x, "area"))

It works like a charm.
Once again thank you for your help

Regards
Rui



-----Original Message-----
From: jon.skoien at jrc.ec.europa.eu [mailto:jon.skoien at jrc.ec.europa.eu] 
Sent: 13 December 2011 13:26
To: Rui Catarino
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Acessing slot information in spatialPolygon class

Hi Rui,

I think the following should give you what you are looking for:
res$area2 = sapply(slot(res,"polygons"), function(x) slot(x, "area"))

Cheers,
Jon

On 13-Dec-11 13:50, Rui Catarino wrote:
> Dear all,
>
>
>
> This may seem a very obvious question but I'm suck and for the past 2h I
> haven't been able of solving the problem. So for the sake of
> productivity I'll ask for some help:
>
>
>
> I have a SpatialPolygon Class that looks like(see bellow) in the example
> below I have only 2 polygons but they will be thousands. What I'm trying
> to achieve is a list with the total area of each polygon.
>
>
>
> Thanks in advance
>
>
>
>> str(res)
> Formal class 'SpatialPolygons' [package "sp"] with 4 slots
>
>    ..@ polygons   :List of 2
>
>    .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
>
>    .. .. .. ..@ Polygons :List of 9
>
>    .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
>
>    .. .. .. .. .. .. ..@ labpt  : num [1:2] 3.19 51.68
>
>    .. .. .. .. .. .. ..@ area   : num 8.96e-05
>
>    .. .. .. .. .. .. ..@ hole   : logi FALSE
>
>    .. .. .. .. .. .. ..@ ringDir: int 1
>
>    .. .. .. .. .. .. ..@ coords : num [1:5, 1:2] 3.18 3.18 3.19 3.2 3.18
> ...
>
> .
>
> .
>
> .
>
>
>
>    .. .. .. ..@ plotOrder: int [1:9] 9 8 2 3 1 4 7 5 6
>
>    .. .. .. ..@ labpt    : num [1:2] 3.14 51.67
>
>    .. .. .. ..@ ID       : chr "2"
>
>    .. .. .. ..@ area     : num 0.000993
>
>    ..@ plotOrder  : int [1:2] 2 1
>
>    ..@ bbox       : num [1:2, 1:2] 3.09 51.66 3.26 51.73
>
>    .. ..- attr(*, "dimnames")=List of 2
>
>    .. .. ..$ : chr [1:2] "x" "y"
>
>    .. .. ..$ : chr [1:2] "min" "max"
>
>    ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>
>    .. .. ..@ projargs: chr NA
>
>
>
>
>
>
>
>
>
>
>
> Rui Catarino
>
> Scientific Officer
>
> Fishery Systems Group
>
> Marine Scotland - Science
>
>
>
> Scottish Government | 36 |B |Marine Laboratory, PO Box 101| 375,
> Victoria Road | Aberdeen AB11 9DB
>
>
>
> Tel:  +44 (0)1224 295572
>
> Mob:+44 (0)7530 240666
>
> Fax: +44 (0)1224 295511
>
> e: r.catarino at marlab.ac.uk
>
> w: http://www.scotland.gov.uk/marinescotland
> <http://www.scotland.gov.uk/marinescotland>
>
>
>
>
> ______________________________________________________________________
> This email has been scanned by the Symantec Email Security.cloud service.
> For more information please visit http://www.symanteccloud.com
> ______________________________________________________________________
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Global Environment Monitoring Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.



______________________________________________________________________
This email has been scanned by the Symantec Email Security.cloud service.
For more information please visit http://www.symanteccloud.com
______________________________________________________________________


______________________________________________________________________
This email has been scanned by the Symantec Email Security.cloud service.
For more information please visit http://www.symanteccloud.com


From miaoyingshi23 at gmail.com  Tue Dec 13 15:45:29 2011
From: miaoyingshi23 at gmail.com (Miaoying Shi)
Date: Tue, 13 Dec 2011 09:45:29 -0500
Subject: [R-sig-Geo] put coordinates back to polyline
Message-ID: <CABx2-fD6wWZxi2AQRjuLXDq9Qb9D+uQX1qYJVk9YASrsH9ftMg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/ead0e54d/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Dec 13 15:47:54 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 Dec 2011 14:47:54 +0000
Subject: [R-sig-Geo] Lat / Long - x/y?
In-Reply-To: <CAKZr0U03iHcr8s+hqg6M+cwmx1PCMJhmCYZpbE29JV98Na-L1g@mail.gmail.com>
References: <CAKZr0U2Adh8iY=VEW=F0XnPADcpjOPxjurMkDS-CBZFKARXNnw@mail.gmail.com>
	<4EE747D4.6070308@tum.de>
	<CAKZr0U03iHcr8s+hqg6M+cwmx1PCMJhmCYZpbE29JV98Na-L1g@mail.gmail.com>
Message-ID: <CANVKczMgyEUybd0sPYZ3AR6JeL5Zi9378BGtZHE2zow4EOawjg@mail.gmail.com>

On Tue, Dec 13, 2011 at 12:52 PM, Sam smith <sam856040 at gmail.com> wrote:
> Hi,
>
> Thanks for this - yes i was looking to do a Projection from Decimal Degrees
> into spatial (xy) coordinates.
>
> I shall have a look at the package you suggested.

 You probably mean 'Cartesian x-y coordinates'. You'll need to find a
coordinate transformation (not a projection, strictly) to a more
Cartesian coordinate system. If your data are in the UK for example,
you'd use Ordnance Survey Grid References. If you have a spatial data
frame with a CRS properly defined you can transform with spTransform
and the appropriate EPSG code:

> ll
  coordinates A
1    (50, 23) a
2    (52, 26) b
> spTransform(ll,CRS("+init=epsg:27700"))
          coordinates A
1 (6273200, -1692000) a
2 (6301630, -1123490) b

 (these coordinates are nowhere near the UK so don't do that).

 For the rest of the planet, there's probably a UTM (Universal
Transverse Mercator) zone that will do the job. Not sure what you do
if you're working with polar bears or penguins - there's probably
other transformations for polar data...

Barry


From mpioz at voila.fr  Tue Dec 13 15:54:33 2011
From: mpioz at voila.fr (Maryline PIOZ)
Date: Tue, 13 Dec 2011 15:54:33 +0100 (CET)
Subject: [R-sig-Geo] general question on R squared for SAR models
Message-ID: <1375907251.911891323788073621.JavaMail.www@wwinf7138>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/783d79c6/attachment.pl>

From danner.ray at gmail.com  Tue Dec 13 22:32:40 2011
From: danner.ray at gmail.com (Ray Danner)
Date: Tue, 13 Dec 2011 16:32:40 -0500
Subject: [R-sig-Geo] Coordinate system specification
Message-ID: <CACdHj0NrcjT1+rfvoG45wtdicJ=W0eOvdd8gGbnVZfthWs5CJQ@mail.gmail.com>

Dear community,

I would like to calculate average values from a few hundred raster
files and then query values for 217 specific points.  The raster files
are of evapotranspiration data in California
(http://goes.casil.ucdavis.edu/cimis/).  The maps have 2km resolution.
 I'm able to download the .asc files, visualize them, average them,
and query point values, but can't get the maps into the proper
coordinate system so that I can query points based on decimal degrees.
 The website states that the maps are in Albert's Equal Area
projection (http://goes.casil.ucdavis.edu/), though doesn't provide
any reference points (not sure if these are necessary).  Would anyone
be willing to point me in the correct direction regarding coordinate
systems?  Please see example below.

Thanks in advance.
Ray

#download: http://goes.casil.ucdavis.edu/cimis/2011/01/04/mc_et0_avg.asc.gz
library("maptools")
library("raster")
grid <- readAsciiGrid("/Users/rdanner/Downloads/mc_et0_avg.asc")
table <- data.frame(grid)
image(grid)
ETo<-raster(grid)
plot(ETo) #Note that the scale is not decimal degrees


From r.hijmans at gmail.com  Wed Dec 14 00:04:09 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Dec 2011 15:04:09 -0800
Subject: [R-sig-Geo] Coordinate system specification
In-Reply-To: <CACdHj0NrcjT1+rfvoG45wtdicJ=W0eOvdd8gGbnVZfthWs5CJQ@mail.gmail.com>
References: <CACdHj0NrcjT1+rfvoG45wtdicJ=W0eOvdd8gGbnVZfthWs5CJQ@mail.gmail.com>
Message-ID: <CANtt_hwLT8FwGedtsEMPBCMBB4zfge6xOe-EiiubBEPan1HfRg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/bb905be4/attachment.pl>

From r.hijmans at gmail.com  Wed Dec 14 00:06:49 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Dec 2011 15:06:49 -0800
Subject: [R-sig-Geo] Adding raster files from a folder
In-Reply-To: <4EE75210.4080404@jrc.ec.europa.eu>
References: <CAO7vHBFH0YHH3S2aS8qzHzaarx4XhQAZiir1b2nafeJwwQgFpw@mail.gmail.com>
	<4EE75210.4080404@jrc.ec.europa.eu>
Message-ID: <CANtt_hyn7YaN5r7Wo59M5=BHj2_vbHZ8cN9rGyRT5ULqsU6P+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/e4c075a8/attachment.pl>

From r.hijmans at gmail.com  Wed Dec 14 02:27:53 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Dec 2011 17:27:53 -0800
Subject: [R-sig-Geo] Plot box is empty!!! Raster plot?
In-Reply-To: <4EE7E559.9060205@gmail.com>
References: <CAO7vHBFH0YHH3S2aS8qzHzaarx4XhQAZiir1b2nafeJwwQgFpw@mail.gmail.com>
	<4EE75210.4080404@jrc.ec.europa.eu>
	<CANtt_hyn7YaN5r7Wo59M5=BHj2_vbHZ8cN9rGyRT5ULqsU6P+Q@mail.gmail.com>
	<4EE7E559.9060205@gmail.com>
Message-ID: <CANtt_hwSNEFPMHqU-jcJR4f_cOoZgJW22KQ5YFy9H_m41x4mEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111213/050c1a0e/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Dec 14 15:25:01 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Dec 2011 15:25:01 +0100
Subject: [R-sig-Geo] A SpatialPolygons object from holes
Message-ID: <CAGfc75myL2E8_WEF1FWwaRSDthiXiW-5KJ-TuzBwh+zSwDPRXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111214/c57bfc19/attachment.pl>

From eric.momsen at ndsu.edu  Wed Dec 14 18:31:42 2011
From: eric.momsen at ndsu.edu (Eric Momsen)
Date: Wed, 14 Dec 2011 11:31:42 -0600
Subject: [R-sig-Geo] readVECT6 - Multiple incompatible geometries
In-Reply-To: <CAO7hk-Kk0_3m6qaWCj0jA7WgranFMTTd7i4DsJxztMTADy7Uww@mail.gmail.com>
References: <CAO7hk-Kk0_3m6qaWCj0jA7WgranFMTTd7i4DsJxztMTADy7Uww@mail.gmail.com>
Message-ID: <CAO7hk-+cs6GV2E_tC_bWBkFfxVdDjh7ZZVamjkeo6-dHMzcVVg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111214/5bf1461f/attachment.pl>

From Roger.Bivand at nhh.no  Wed Dec 14 20:39:57 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Dec 2011 20:39:57 +0100 (CET)
Subject: [R-sig-Geo] readVECT6 - Multiple incompatible geometries
In-Reply-To: <CAO7hk-+cs6GV2E_tC_bWBkFfxVdDjh7ZZVamjkeo6-dHMzcVVg@mail.gmail.com>
References: <CAO7hk-Kk0_3m6qaWCj0jA7WgranFMTTd7i4DsJxztMTADy7Uww@mail.gmail.com>
	<CAO7hk-+cs6GV2E_tC_bWBkFfxVdDjh7ZZVamjkeo6-dHMzcVVg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112142033150.8971@reclus.nhh.no>

On Wed, 14 Dec 2011, Eric Momsen wrote:

> Hi again,
>
> I'm still having trouble figuring this issue out.  Maybe posting on a
> Friday night in Europe was the wrong time to be asking questions?
> Otherwise I apologize for the repost.
>
> Today I have a possibly related error.  The new scenerio is added below.
> Is there a way to tell if I have an installation issue, data issue, or am
> not entering the commands correctly?

You do need to provide the output of sessionInfo(), and also the messages 
shown when you load spgrass6. Running your initial example with R 2.14.0, 
spgrass6_0.7-4, rgdal_0.7-5, sp_0.9-91, and:

Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)
Loading required package: XML
GRASS GIS interface loaded with GRASS version: GRASS 6.4.2svn47586 (2011)
and location: spearfish60

> streams <- readVECT6("streams", type = "line,boundary", 
+ remove.duplicates = FALSE)

seems to work OK. The data set in GRASS has both stream lines and islands 
forming boundaries, but is flattened in R to a SpatialLinesDataFrame. I 
suspect that your software versions may playing a role here. You may find 
the smaller volume statgrass list more responsive, although spgrass6 users 
use this list too.

Roger

>
> Thanks for any advice,
> Eric
>
>
> I am trying out Ordinary Kriging, following the example at
> http://casoilresource.lawr.ucdavis.edu/drupal/node/438
> With one minor modification (based on Roger Bivand's suggestions on
> grass.osgeo.org/wiki { I changed  G$cols*G$rows  to   prod(slot(grd,
> "cells.dim"))  }, I was able to successfully execute the procedure and
> write the data back to GRASS.  But when I tried to run the procedure on my
> dataset, I have the following error:
>
>> x.has.na <- readVECT6('nws_precip_1day_observed_20100310')
> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
> input_field_name_encoding) :
> Cannot open layer
>
> I checked with:
>> system("g.list vect")
> ----------------------------------------------
> vector files available in mapset <nws_precip_1day_observed>:
> nws_precip_1day_observed_20100101       nws_precip_1day_observed_20100703
> ...additional vector files for each day...
>
> So I can see the file is available.  I'm not sure how to proceed with
> troubleshooting this.
>
> On Fri, Dec 9, 2011 at 12:56 PM, Eric Momsen <eric.momsen at ndsu.edu> wrote:
>
>> Hello,
>>
>> I'm new to GIS and R and have been working my way along from various
>> sources.  I'm having difficulty getting R to see some data in GRASS.  For
>> troubleshooting, I'm trying out the examples in Applied Spatial Data
>> Analysis with R, chapter 4.
>>
>> I am able to use readVECT6 to read the 'bugsites' but not the 'streams' in
>> the spearfish dataset.  I was able to use vInfo for the 'streams'. Here is
>> the error, more input/output is below.
>>
>>> streams <- readVECT6("streams", type = "line,boundary",
>> remove.duplicates = FALSE)
>> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
>> input_field_name_encoding) :
>>   Multiple incompatible geometries: 2:3
>>
>> I have searched for the phrase "Multiple incompatible geometries" and have
>> not found anything helpful.  Any advice would be appreciated!
>>
>> Thanks,
>> Eric
>>
>> Terminal commands and outputs (with some extraneous lines deleted ?):
>>
>> '/Applications/GRASS-6.4.app/Contents/MacOS/grass.sh'; exit
>> ?
>> Python 2.6.1 found.
>> ?
>> Welcome to GRASS 6.4.1 (2011)
>> ?
>> GRASS 6.4.1 (spearfish60):~ > r64
>>
>> R version 2.13.2 (2011-09-30)
>> Copyright (C) 2011 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>> ?
>> [Previously saved workspace restored]
>>
>>> library(spgrass6)
>> Loading required package: sp
>> Loading required package: rgdal
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
>> Path to GDAL shared files:
>> /Library/Frameworks/GDAL.framework/Versions/1.8/Resources/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>> Loading required package: XML
>> GRASS GIS interface loaded with GRASS version: GRASS 6.4.1 (2011)
>> and location: spearfish60
>>
>>> bugsDF <- readVECT6("bugsites")
>> OGR data source with driver: GRASS
>> Source:
>> "/Users/eric.momsen/grassdata/spearfish60/PERMANENT/vector/bugsites/head",
>> layer: "1"
>> with 90 features and 2 fields
>> Feature type: wkbPoint with 2 dimensions
>>
>>> summary(bugsDF)
>> Object of class SpatialPointsDataFrame
>> Coordinates:
>>               min     max
>> coords.x1  590232  608471
>> coords.x2 4914096 4920512
>> Is projected: TRUE
>> proj4string :
>> [+proj=utm +zone=13 +datum=NAD27 +units=m +no_defs +ellps=clrk66
>> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat]
>> Number of points: 90
>> Data attributes:
>>       cat                 str1
>>  Min.   : 1.00   Beetle site:90
>>  1st Qu.:23.25
>>  Median :45.50
>>  Mean   :45.50
>>  3rd Qu.:67.75
>>  Max.   :90.00
>>
>>> system("g.list vect")
>> ----------------------------------------------
>> vector files available in mapset <user1>:
>> basins    contours  rivers
>>
>> vector files available in mapset <PERMANENT>:
>> ? landuse         streams         t_9961_300_bks  ?
>>
>> ----------------------------------------------
>>
>>> vInfo("streams")
>>      nodes     points      lines boundaries  centroids      areas
>>  islands
>>        139          0        104         12          4          4
>>  4
>>      faces    kernels primitives      map3d
>>          0          0        120          0
>>
>>> streams <- readVECT6("streams", type = "line,boundary",
>> remove.duplicates = FALSE)
>> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
>> input_field_name_encoding) :
>>   Multiple incompatible geometries: 2:3
>>>
>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From stefano at casalegno.net  Thu Dec 15 10:49:14 2011
From: stefano at casalegno.net (Stefano Casalegno)
Date: Thu, 15 Dec 2011 10:49:14 +0100
Subject: [R-sig-Geo] TRAINING: Open Source Tools for Spatial Ecological
	Modeling
Message-ID: <1323942554.1793.35.camel@ste>

Hi

Within the http://www.spatial-ecology.net project we are organizing a
course in "Open Source Tools for Spatial Ecological Modeling" using R,
GRASS, AWK, gdal under Linux Environment.

The training will take place at the University of Alcal? (Madrid) Spain,
Geography Department, 9-13 January 2012.
http://www.geogra.uah.es/inicio/

To subscribe, fill in this doodle:
http://www.doodle.com/z73puay95hp7ez5z
and send an e-mail to :
stefano at casalegno.net and giuseppe.amatulli at gmail.com 
with your name, address, email and keywords stating your scientific or
technical background.

More info at http://www.spatial-ecology.net 

Stefano and Giuseppe


From alobolistas at gmail.com  Fri Dec 16 13:24:08 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 16 Dec 2011 13:24:08 +0100
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for CRS
	of epsg:4326
Message-ID: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>

Hi!
I' trying to read this shapefile that is just in lon,lat WGS84
> ogrInfo(dsn=datad,layer="world_adm0v2")
Source: "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
layer: "world_adm0v2"
Driver: ESRI Shapefile number of rows 209
Feature type: wkbPolygon with 2 dimensions
+proj=longlat +datum=WGS84 +no_defs
Number of fields: 3
       name type length typeName
1      NAME    4     40   String
2 GMI_CNTRY    4      3   String
3    REGION    4     25   String

but I get:
> world <-readOGR(dsn=datad,layer="world_adm0v2")
OGR data source with driver: ESRI Shapefile
Source: "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
layer: "world_adm0v2"
with 209 features and 3 fields
Feature type: wkbPolygon with 2 dimensions
Error in validityMethod(as(object, superClass)) :
  Geographical CRS given to non-conformant data
I've tried
> world <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
but get the same result

can't this CRS (epsg:4326)
+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
be read by readOGR() ?

Thanks
Agus


From alfredamorinez at gmail.com  Fri Dec 16 14:04:07 2011
From: alfredamorinez at gmail.com (alfreda morinez)
Date: Fri, 16 Dec 2011 13:04:07 +0000
Subject: [R-sig-Geo] Model design
Message-ID: <CAHtRGzEjsoJ4EK3oy_pqU8MNrf_0dgqVg4CiEeYkuSvSNPTk9g@mail.gmail.com>

Dear List,

I am realtively inexperienced so i apologise in advance and ask for
understanding in the simplicity of my question:

I have data on the amount of grass per km in a cell ( of which i have
lots) "grass" and for each cell i have x/y coordinates - required due
to spatial autocorrelation

Cells can be classfied?in a hierarchical nature into ?AREAS and STATES

i.e Cell 1, Cell 2, Cell 3 are all in AREA "A"

where as Cell 4,5 and 6 are in AREA "B"

However both area A?+ B are?in state "S1"

I have lots of these (13000) cells which are classfied into ~2000
AREA's and ~750 STATE'S

So my question is do AREA'S differ in the amount of grass they contain
i.e does AREA A contain significantly more grass than AREA B?

I have modelled this by

area_grass <- gls(grass~AREA, correlation=corExp(form=~x+y), data = grassland

I have set the contrasts to options(contrasts = c("contr.treatment",
"contr.poly")) as there are no control groups.

What i will get ( it is taking ages!)

is

AREA A:     -0.12.... **
AREA B:      0.17....*
AREA C..


So can i then say AREA A has significantly less grass than the
average, AREA B significantly more and AREA C is not significantly
different?

Thanks

Alfreda

P.S - Il will then repate this fot STATE instead of AREA.


From r.hijmans at gmail.com  Fri Dec 16 18:09:56 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 16 Dec 2011 09:09:56 -0800
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
Message-ID: <CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111216/2f8bd21d/attachment.pl>

From r.hijmans at gmail.com  Fri Dec 16 18:28:53 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 16 Dec 2011 09:28:53 -0800
Subject: [R-sig-Geo] Model design
In-Reply-To: <CAHtRGzEjsoJ4EK3oy_pqU8MNrf_0dgqVg4CiEeYkuSvSNPTk9g@mail.gmail.com>
References: <CAHtRGzEjsoJ4EK3oy_pqU8MNrf_0dgqVg4CiEeYkuSvSNPTk9g@mail.gmail.com>
Message-ID: <CANtt_hwYgUh=PxJkQQ7ov1nB6dtyOhh6joO_56vuN0bV75_ZNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111216/7156f6a8/attachment.pl>

From Roger.Bivand at nhh.no  Fri Dec 16 19:04:27 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Dec 2011 19:04:27 +0100 (CET)
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>

On Fri, 16 Dec 2011, Robert J. Hijmans wrote:

> Agus,
>
> This is likely because there are some longitude coordinates that are  <
> -180 or > 180.
> OGR does not complain, but, as these are lon/lat data, sp runs
> sp:::.ll_sanity  and throws an error.
>
> I think it would be preferable if sp gave a warning rather than an error,
> at least when longitudes are within a reasonable number (-360 -- 360 ?). I
> think that a longitude of, e.g. 181 is perfectly interpretable, and
> sometimes useful. For example to plot Russia, or Fiji in one piece in
> lon/lat coordinates.

As Agus knows, unless the file is made available, help will likely not be 
forthcoming. Without a traceback(), we don't know where the error is being 
thrown. The fact that an out of domain number is interpretable in one 
context doesn't necessarily make it acceptable in others, I believe. We 
could go to an option setting, which would slacken the error to a warning 
if set. Opinions?

Roger

>
> Robert
>
>
> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> Hi!
>> I' trying to read this shapefile that is just in lon,lat WGS84
>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>> Source: "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>> layer: "world_adm0v2"
>> Driver: ESRI Shapefile number of rows 209
>> Feature type: wkbPolygon with 2 dimensions
>> +proj=longlat +datum=WGS84 +no_defs
>> Number of fields: 3
>>       name type length typeName
>> 1      NAME    4     40   String
>> 2 GMI_CNTRY    4      3   String
>> 3    REGION    4     25   String
>>
>> but I get:
>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>> OGR data source with driver: ESRI Shapefile
>> Source: "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>> layer: "world_adm0v2"
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Error in validityMethod(as(object, superClass)) :
>>  Geographical CRS given to non-conformant data
>> I've tried
>>> world
>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>> but get the same result
>>
>> can't this CRS (epsg:4326)
>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>> be read by readOGR() ?
>>
>> Thanks
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alfredamorinez at gmail.com  Fri Dec 16 19:59:44 2011
From: alfredamorinez at gmail.com (alfreda morinez)
Date: Fri, 16 Dec 2011 18:59:44 +0000
Subject: [R-sig-Geo] Model design
In-Reply-To: <CANtt_hwYgUh=PxJkQQ7ov1nB6dtyOhh6joO_56vuN0bV75_ZNA@mail.gmail.com>
References: <CAHtRGzEjsoJ4EK3oy_pqU8MNrf_0dgqVg4CiEeYkuSvSNPTk9g@mail.gmail.com>
	<CANtt_hwYgUh=PxJkQQ7ov1nB6dtyOhh6joO_56vuN0bV75_ZNA@mail.gmail.com>
Message-ID: <CAHtRGzGzE40zdCv0LC2FHkRBw41pm4X-U+FT6bFOYm=nzzi7Vw@mail.gmail.com>

Hi Robert,

Thanks for this,

So my concern was the high levels of spatial auto-correlation. I made
a semi-variogram of the cell's x and y values and tested for
significant difference from predicted value ( which there was).

So what you are saying is to take the average per AREA maybe in the
form of a ANOVA and test for significant differences between the
AREAS?

However my concern with this approach is that the average is not
realistic as two cells next to each other are not independent from
each other due to their proximity to each other. Hence the approach i
am taking?

Alfreda

On Fri, Dec 16, 2011 at 5:28 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Alfreda,
>
> It appears that you are comparing entire populations (all cells in each
> AREA), not samples. If that is the case there is no difference between the
> (true) population mean and the (estimated) sample mean. That makes doing a
> statistical test is irrelevant: all differences should be
> considered?statistically significant. Whether these differences matter is
> for you to decide.
>
> Given that we (think we) know how many people live in Germany and France
> would you do a statistical test to say which country has a larger
> population?
>
> Robert
>
> On Fri, Dec 16, 2011 at 5:04 AM, alfreda morinez <alfredamorinez at gmail.com>
> wrote:
>>
>> Dear List,
>>
>> I am realtively inexperienced so i apologise in advance and ask for
>> understanding in the simplicity of my question:
>>
>> I have data on the amount of grass per km in a cell ( of which i have
>> lots) "grass" and for each cell i have x/y coordinates - required due
>> to spatial autocorrelation
>>
>> Cells can be classfied?in a hierarchical nature into ?AREAS and STATES
>>
>> i.e Cell 1, Cell 2, Cell 3 are all in AREA "A"
>>
>> where as Cell 4,5 and 6 are in AREA "B"
>>
>> However both area A?+ B are?in state "S1"
>>
>> I have lots of these (13000) cells which are classfied into ~2000
>> AREA's and ~750 STATE'S
>>
>> So my question is do AREA'S differ in the amount of grass they contain
>> i.e does AREA A contain significantly more grass than AREA B?
>>
>> I have modelled this by
>>
>> area_grass <- gls(grass~AREA, correlation=corExp(form=~x+y), data =
>> grassland
>>
>> I have set the contrasts to options(contrasts = c("contr.treatment",
>> "contr.poly")) as there are no control groups.
>>
>> What i will get ( it is taking ages!)
>>
>> is
>>
>> AREA A: ? ? -0.12.... **
>> AREA B: ? ? ?0.17....*
>> AREA C..
>>
>>
>> So can i then say AREA A has significantly less grass than the
>> average, AREA B significantly more and AREA C is not significantly
>> different?
>>
>> Thanks
>>
>> Alfreda
>>
>> P.S - Il will then repate this fot STATE instead of AREA.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From alobolistas at gmail.com  Fri Dec 16 23:55:18 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 16 Dec 2011 23:55:18 +0100
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
Message-ID: <CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>

Hi!

I've uploaded the file here:
https://sites.google.com/site/filestemp2/home/world_adm0.zip

It was a popular file, but actually cannot find it in the diva server any more
According to qgis, there are no coordinates beyond +/- 90 or +/-180

Extents:
In layer spatial reference system units : xMin,yMin -180,-90 :
xMax,yMax 180,83.623
but readOGR() probably makes a more rigorous check.

Could it be possible that readOGR()  read the file with a warning
and print the offending coordinates?

readOGR() works fine with this alternative file:
http://www.gadm.org/data/gadm_v1_lev0_shp.zip

but it's huge and cannot actually work with it and have not found a
third alternative.

Thanks,

Agus

2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>
>> Agus,
>>
>> This is likely because there are some longitude coordinates that are ?<
>> -180 or > 180.
>> OGR does not complain, but, as these are lon/lat data, sp runs
>> sp:::.ll_sanity ?and throws an error.
>>
>> I think it would be preferable if sp gave a warning rather than an error,
>> at least when longitudes are within a reasonable number (-360 -- 360 ?). I
>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>> lon/lat coordinates.
>
>
> As Agus knows, unless the file is made available, help will likely not be
> forthcoming. Without a traceback(), we don't know where the error is being
> thrown. The fact that an out of domain number is interpretable in one
> context doesn't necessarily make it acceptable in others, I believe. We
> could go to an option setting, which would slacken the error to a warning if
> set. Opinions?
>
> Roger
>
>
>>
>> Robert
>>
>>
>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>> wrote:
>>
>>> Hi!
>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>
>>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>>>
>>> Source:
>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>> layer: "world_adm0v2"
>>> Driver: ESRI Shapefile number of rows 209
>>> Feature type: wkbPolygon with 2 dimensions
>>> +proj=longlat +datum=WGS84 +no_defs
>>> Number of fields: 3
>>> ? ? ?name type length typeName
>>> 1 ? ? ?NAME ? ?4 ? ? 40 ? String
>>> 2 GMI_CNTRY ? ?4 ? ? ?3 ? String
>>> 3 ? ?REGION ? ?4 ? ? 25 ? String
>>>
>>> but I get:
>>>>
>>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>>>
>>> OGR data source with driver: ESRI Shapefile
>>> Source:
>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>> layer: "world_adm0v2"
>>> with 209 features and 3 fields
>>> Feature type: wkbPolygon with 2 dimensions
>>> Error in validityMethod(as(object, superClass)) :
>>> ?Geographical CRS given to non-conformant data
>>> I've tried
>>>>
>>>> world
>>>
>>>
>>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>>> but get the same result
>>>
>>> can't this CRS (epsg:4326)
>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>> be read by readOGR() ?
>>>
>>> Thanks
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sat Dec 17 13:44:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Dec 2011 13:44:39 +0100 (CET)
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>

On Fri, 16 Dec 2011, Agustin Lobo wrote:

> Hi!
>
> I've uploaded the file here:
> https://sites.google.com/site/filestemp2/home/world_adm0.zip
>
> It was a popular file, but actually cannot find it in the diva server any more
> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>
> Extents:
> In layer spatial reference system units : xMin,yMin -180,-90 :
> xMax,yMax 180,83.623
> but readOGR() probably makes a more rigorous check.

Right. Thanks for access to the file. If I change the name of the *.prj 
file, I see:

> wrld <- readOGR(".", "world_adm0")
> print(bbox(wrld), digits=12)
              min            max
x -180.000183105 180.0000000000
y  -90.000000000  83.6230316162

so it is going sufficiently far below -180 for the validity check at 
.Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly 
slacker tolerance. I suggest providing a tolerance in an option in sp to 
resolve this. The error is primarily to stop users assigning a 
+proj=longlat to projected coordinates (yes, it does happen). I'll look to 
add an options mechanism to sp to handle both error/warning and tolerance 
for the power to .Machine$double.eps.

Had you looked at using the wrld_simpl dataset that is disributed with 
maptools:

data(wrld_simpl)

and joining countries with the codes included? It is a bit out od date in 
not having the Sudan split; it is about twice the object size of the file 
you are using, plotting somewhat more slowly:

> object.size(wrld_simpl)
6349008 bytes
> object.size(wrld)
3250784 bytes
> plot(wrld_simpl)
> plot(wrld, border="red", add=TRUE)

The file simplifies sea ice in Antarctica, and discards many small 
islands, otherwise they match pretty well.

Roger

>
> Could it be possible that readOGR()  read the file with a warning
> and print the offending coordinates?
>
> readOGR() works fine with this alternative file:
> http://www.gadm.org/data/gadm_v1_lev0_shp.zip
>
> but it's huge and cannot actually work with it and have not found a
> third alternative.
>
> Thanks,
>
> Agus
>
> 2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>
>>> Agus,
>>>
>>> This is likely because there are some longitude coordinates that are ?<
>>> -180 or > 180.
>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>> sp:::.ll_sanity ?and throws an error.
>>>
>>> I think it would be preferable if sp gave a warning rather than an error,
>>> at least when longitudes are within a reasonable number (-360 -- 360 ?). I
>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>> lon/lat coordinates.
>>
>>
>> As Agus knows, unless the file is made available, help will likely not be
>> forthcoming. Without a traceback(), we don't know where the error is being
>> thrown. The fact that an out of domain number is interpretable in one
>> context doesn't necessarily make it acceptable in others, I believe. We
>> could go to an option setting, which would slacken the error to a warning if
>> set. Opinions?
>>
>> Roger
>>
>>
>>>
>>> Robert
>>>
>>>
>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>>> wrote:
>>>
>>>> Hi!
>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>
>>>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>>>>
>>>> Source:
>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>> layer: "world_adm0v2"
>>>> Driver: ESRI Shapefile number of rows 209
>>>> Feature type: wkbPolygon with 2 dimensions
>>>> +proj=longlat +datum=WGS84 +no_defs
>>>> Number of fields: 3
>>>> ? ? ?name type length typeName
>>>> 1 ? ? ?NAME ? ?4 ? ? 40 ? String
>>>> 2 GMI_CNTRY ? ?4 ? ? ?3 ? String
>>>> 3 ? ?REGION ? ?4 ? ? 25 ? String
>>>>
>>>> but I get:
>>>>>
>>>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>>>>
>>>> OGR data source with driver: ESRI Shapefile
>>>> Source:
>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>> layer: "world_adm0v2"
>>>> with 209 features and 3 fields
>>>> Feature type: wkbPolygon with 2 dimensions
>>>> Error in validityMethod(as(object, superClass)) :
>>>> ?Geographical CRS given to non-conformant data
>>>> I've tried
>>>>>
>>>>> world
>>>>
>>>>
>>>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>>>> but get the same result
>>>>
>>>> can't this CRS (epsg:4326)
>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>> be read by readOGR() ?
>>>>
>>>> Thanks
>>>> Agus
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sat Dec 17 16:27:57 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Dec 2011 16:27:57 +0100 (CET)
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>

On Sat, 17 Dec 2011, Roger Bivand wrote:

> On Fri, 16 Dec 2011, Agustin Lobo wrote:
>
>> Hi!
>> 
>> I've uploaded the file here:
>> https://sites.google.com/site/filestemp2/home/world_adm0.zip
>> 
>> It was a popular file, but actually cannot find it in the diva server any 
>> more
>> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>> 
>> Extents:
>> In layer spatial reference system units : xMin,yMin -180,-90 :
>> xMax,yMax 180,83.623
>> but readOGR() probably makes a more rigorous check.
>
> Right. Thanks for access to the file. If I change the name of the *.prj file, 
> I see:
>
>> wrld <- readOGR(".", "world_adm0")
>> print(bbox(wrld), digits=12)
>             min            max
> x -180.000183105 180.0000000000
> y  -90.000000000  83.6230316162
>
> so it is going sufficiently far below -180 for the validity check at 
> .Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly slacker 
> tolerance. I suggest providing a tolerance in an option in sp to resolve 
> this. The error is primarily to stop users assigning a +proj=longlat to 
> projected coordinates (yes, it does happen). I'll look to add an options 
> mechanism to sp to handle both error/warning and tolerance for the power to 
> .Machine$double.eps.

This is now committed to the rspatial R-forge project, module sp, revision 
1179. Now it is possible either to throw a warning rather than an error, 
and/or to alter the tolerance; the error message now shows the exceeding 
value(s):

> library(rgdal)
Loading required package: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)
> wrld1 <- readOGR(".", "world_adm0")
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "world_adm0"
with 209 features and 3 fields
Feature type: wkbPolygon with 2 dimensions
Error in validityMethod(as(object, superClass)) :
   Geographical CRS given to non-conformant data: -180.000183105
> set_ll_warn(TRUE)
[1] TRUE
> wrld1 <- readOGR(".", "world_adm0")
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "world_adm0"
with 209 features and 3 fields
Feature type: wkbPolygon with 2 dimensions
Warning message:
In validityMethod(as(object, superClass)) :
   Geographical CRS given to non-conformant data: -180.000183105
> set_ll_warn(FALSE)
[1] FALSE
> set_ll_TOL(0.2)
[1] 0.2
> wrld1 <- readOGR(".", "world_adm0")
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "world_adm0"
with 209 features and 3 fields
Feature type: wkbPolygon with 2 dimensions
>

Please let me know if this helps,

Roger

>
> Had you looked at using the wrld_simpl dataset that is disributed with 
> maptools:
>
> data(wrld_simpl)
>
> and joining countries with the codes included? It is a bit out od date in not 
> having the Sudan split; it is about twice the object size of the file you are 
> using, plotting somewhat more slowly:
>
>> object.size(wrld_simpl)
> 6349008 bytes
>> object.size(wrld)
> 3250784 bytes
>> plot(wrld_simpl)
>> plot(wrld, border="red", add=TRUE)
>
> The file simplifies sea ice in Antarctica, and discards many small islands, 
> otherwise they match pretty well.
>
> Roger
>
>> 
>> Could it be possible that readOGR()  read the file with a warning
>> and print the offending coordinates?
>> 
>> readOGR() works fine with this alternative file:
>> http://www.gadm.org/data/gadm_v1_lev0_shp.zip
>> 
>> but it's huge and cannot actually work with it and have not found a
>> third alternative.
>> 
>> Thanks,
>> 
>> Agus
>> 
>> 2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
>>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>> 
>>>> Agus,
>>>> 
>>>> This is likely because there are some longitude coordinates that are ?<
>>>> -180 or > 180.
>>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>>> sp:::.ll_sanity ?and throws an error.
>>>> 
>>>> I think it would be preferable if sp gave a warning rather than an error,
>>>> at least when longitudes are within a reasonable number (-360 -- 360 ?). 
>>>> I
>>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>>> lon/lat coordinates.
>>> 
>>> 
>>> As Agus knows, unless the file is made available, help will likely not be
>>> forthcoming. Without a traceback(), we don't know where the error is being
>>> thrown. The fact that an out of domain number is interpretable in one
>>> context doesn't necessarily make it acceptable in others, I believe. We
>>> could go to an option setting, which would slacken the error to a warning 
>>> if
>>> set. Opinions?
>>> 
>>> Roger
>>> 
>>> 
>>>> 
>>>> Robert
>>>> 
>>>> 
>>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>>>> wrote:
>>>> 
>>>>> Hi!
>>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>> 
>>>>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>>>>> 
>>>>> Source:
>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>> layer: "world_adm0v2"
>>>>> Driver: ESRI Shapefile number of rows 209
>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>> +proj=longlat +datum=WGS84 +no_defs
>>>>> Number of fields: 3
>>>>> ? ? ?name type length typeName
>>>>> 1 ? ? ?NAME ? ?4 ? ? 40 ? String
>>>>> 2 GMI_CNTRY ? ?4 ? ? ?3 ? String
>>>>> 3 ? ?REGION ? ?4 ? ? 25 ? String
>>>>> 
>>>>> but I get:
>>>>>> 
>>>>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>>>>> 
>>>>> OGR data source with driver: ESRI Shapefile
>>>>> Source:
>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>> layer: "world_adm0v2"
>>>>> with 209 features and 3 fields
>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>> Error in validityMethod(as(object, superClass)) :
>>>>> ?Geographical CRS given to non-conformant data
>>>>> I've tried
>>>>>> 
>>>>>> world
>>>>> 
>>>>> 
>>>>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>>>>> but get the same result
>>>>> 
>>>>> can't this CRS (epsg:4326)
>>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>> be read by readOGR() ?
>>>>> 
>>>>> Thanks
>>>>> Agus
>>>>> 
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>> 
>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From roman.lustrik at gmail.com  Sat Dec 17 17:20:03 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 17 Dec 2011 08:20:03 -0800 (PST)
Subject: [R-sig-Geo] memory leaking of some rgeos functions?
In-Reply-To: <CAHT1vpiKD8HQ-Bgs_0a3yxqeAmrqL96db4n9ReriHg81LWD=vw@mail.gmail.com>
References: <CAHT1vpiKD8HQ-Bgs_0a3yxqeAmrqL96db4n9ReriHg81LWD=vw@mail.gmail.com>
Message-ID: <1324138803570-7104268.post@n2.nabble.com>

I found a workaround to circumvent the memory leaking. I initiate all cores
on my CPU and run rgeos functions inside snowfall functions (sfSapply,
sfLapply...). Once the calculations are done, I stop the "cluster" which
frees stranded memory.

Cheers,
Roman

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/memory-leaking-of-some-rgeos-functions-tp6943137p7104268.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Sun Dec 18 11:18:56 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 18 Dec 2011 11:18:56 +0100
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
	<alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
Message-ID: <CAG4NRe+vMCYLVqr2dB+WEkCN96Mfzm=4FTVBeG3z-78UpeCe1Q@mail.gmail.com>

Yes, it does! I've tested under ubuntu 10.04. Thanks.
When is this new version of sp going to available for win and mac?
Also, would it be possible to change the value of that point from -180.000183105
to -180.000 in R? And/or, could R print the 2 coordinates of the
non-conformant points
so that they can be identified in the GIS and eventually edited?

Agus

2011/12/17 Roger Bivand <Roger.Bivand at nhh.no>:
> On Sat, 17 Dec 2011, Roger Bivand wrote:
>
>> On Fri, 16 Dec 2011, Agustin Lobo wrote:
>>
>>> Hi!
>>>
>>> I've uploaded the file here:
>>> https://sites.google.com/site/filestemp2/home/world_adm0.zip
>>>
>>> It was a popular file, but actually cannot find it in the diva server any
>>> more
>>> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>>>
>>> Extents:
>>> In layer spatial reference system units : xMin,yMin -180,-90 :
>>> xMax,yMax 180,83.623
>>> but readOGR() probably makes a more rigorous check.
>>
>>
>> Right. Thanks for access to the file. If I change the name of the *.prj
>> file, I see:
>>
>>> wrld <- readOGR(".", "world_adm0")
>>> print(bbox(wrld), digits=12)
>>
>> ? ? ? ? ? ?min ? ? ? ? ? ?max
>> x -180.000183105 180.0000000000
>> y ?-90.000000000 ?83.6230316162
>>
>> so it is going sufficiently far below -180 for the validity check at
>> .Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly
>> slacker tolerance. I suggest providing a tolerance in an option in sp to
>> resolve this. The error is primarily to stop users assigning a +proj=longlat
>> to projected coordinates (yes, it does happen). I'll look to add an options
>> mechanism to sp to handle both error/warning and tolerance for the power to
>> .Machine$double.eps.
>
>
> This is now committed to the rspatial R-forge project, module sp, revision
> 1179. Now it is possible either to throw a warning rather than an error,
> and/or to alter the tolerance; the error message now shows the exceeding
> value(s):
>
>> library(rgdal)
>
> Loading required package: sp
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
> Path to GDAL shared files: /usr/local/share/gdal
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> Path to PROJ.4 shared files: (autodetected)
>>
>> wrld1 <- readOGR(".", "world_adm0")
>
> OGR data source with driver: ESRI Shapefile
> Source: ".", layer: "world_adm0"
>
> with 209 features and 3 fields
> Feature type: wkbPolygon with 2 dimensions
> Error in validityMethod(as(object, superClass)) :
> ?Geographical CRS given to non-conformant data: -180.000183105
>>
>> set_ll_warn(TRUE)
>
> [1] TRUE
>>
>> wrld1 <- readOGR(".", "world_adm0")
>
> OGR data source with driver: ESRI Shapefile
> Source: ".", layer: "world_adm0"
>
> with 209 features and 3 fields
> Feature type: wkbPolygon with 2 dimensions
> Warning message:
> In validityMethod(as(object, superClass)) :
> ?Geographical CRS given to non-conformant data: -180.000183105
>>
>> set_ll_warn(FALSE)
>
> [1] FALSE
>>
>> set_ll_TOL(0.2)
>
> [1] 0.2
>>
>> wrld1 <- readOGR(".", "world_adm0")
>
> OGR data source with driver: ESRI Shapefile
> Source: ".", layer: "world_adm0"
>
> with 209 features and 3 fields
> Feature type: wkbPolygon with 2 dimensions
>>
>>
>
> Please let me know if this helps,
>
> Roger
>
>
>>
>> Had you looked at using the wrld_simpl dataset that is disributed with
>> maptools:
>>
>> data(wrld_simpl)
>>
>> and joining countries with the codes included? It is a bit out od date in
>> not having the Sudan split; it is about twice the object size of the file
>> you are using, plotting somewhat more slowly:
>>
>>> object.size(wrld_simpl)
>>
>> 6349008 bytes
>>>
>>> object.size(wrld)
>>
>> 3250784 bytes
>>>
>>> plot(wrld_simpl)
>>> plot(wrld, border="red", add=TRUE)
>>
>>
>> The file simplifies sea ice in Antarctica, and discards many small
>> islands, otherwise they match pretty well.
>>
>> Roger
>>
>>>
>>> Could it be possible that readOGR() ?read the file with a warning
>>> and print the offending coordinates?
>>>
>>> readOGR() works fine with this alternative file:
>>> http://www.gadm.org/data/gadm_v1_lev0_shp.zip
>>>
>>> but it's huge and cannot actually work with it and have not found a
>>> third alternative.
>>>
>>> Thanks,
>>>
>>> Agus
>>>
>>> 2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
>>>>
>>>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>>>
>>>>> Agus,
>>>>>
>>>>> This is likely because there are some longitude coordinates that are ?<
>>>>> -180 or > 180.
>>>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>>>> sp:::.ll_sanity ?and throws an error.
>>>>>
>>>>> I think it would be preferable if sp gave a warning rather than an
>>>>> error,
>>>>> at least when longitudes are within a reasonable number (-360 -- 360
>>>>> ?). I
>>>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>>>> lon/lat coordinates.
>>>>
>>>>
>>>>
>>>> As Agus knows, unless the file is made available, help will likely not
>>>> be
>>>> forthcoming. Without a traceback(), we don't know where the error is
>>>> being
>>>> thrown. The fact that an out of domain number is interpretable in one
>>>> context doesn't necessarily make it acceptable in others, I believe. We
>>>> could go to an option setting, which would slacken the error to a
>>>> warning if
>>>> set. Opinions?
>>>>
>>>> Roger
>>>>
>>>>
>>>>>
>>>>> Robert
>>>>>
>>>>>
>>>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Hi!
>>>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>>>
>>>>>>>
>>>>>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>>>>>>
>>>>>>
>>>>>> Source:
>>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>>> layer: "world_adm0v2"
>>>>>> Driver: ESRI Shapefile number of rows 209
>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>> +proj=longlat +datum=WGS84 +no_defs
>>>>>> Number of fields: 3
>>>>>> ? ? ?name type length typeName
>>>>>> 1 ? ? ?NAME ? ?4 ? ? 40 ? String
>>>>>> 2 GMI_CNTRY ? ?4 ? ? ?3 ? String
>>>>>> 3 ? ?REGION ? ?4 ? ? 25 ? String
>>>>>>
>>>>>> but I get:
>>>>>>>
>>>>>>>
>>>>>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>>>>>>
>>>>>>
>>>>>> OGR data source with driver: ESRI Shapefile
>>>>>> Source:
>>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>>> layer: "world_adm0v2"
>>>>>> with 209 features and 3 fields
>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>> Error in validityMethod(as(object, superClass)) :
>>>>>> ?Geographical CRS given to non-conformant data
>>>>>> I've tried
>>>>>>>
>>>>>>>
>>>>>>> world
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>>>>>> but get the same result
>>>>>>
>>>>>> can't this CRS (epsg:4326)
>>>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>>> be read by readOGR() ?
>>>>>>
>>>>>> Thanks
>>>>>> Agus
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Sun Dec 18 14:30:24 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 18 Dec 2011 14:30:24 +0100 (CET)
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CAG4NRe+vMCYLVqr2dB+WEkCN96Mfzm=4FTVBeG3z-78UpeCe1Q@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
	<alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
	<CAG4NRe+vMCYLVqr2dB+WEkCN96Mfzm=4FTVBeG3z-78UpeCe1Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112181427380.26294@reclus.nhh.no>

On Sun, 18 Dec 2011, Agustin Lobo wrote:

> Yes, it does! I've tested under ubuntu 10.04. Thanks.

Thanks for checking!

> When is this new version of sp going to available for win and mac?

We'll try to release this week.

> Also, would it be possible to change the value of that point from 
> -180.000183105 to -180.000 in R? And/or, could R print the 2 coordinates 
> of the non-conformant points so that they can be identified in the GIS 
> and eventually edited?

The test is on the bounding box, so the value reported is the exceeding 
value - the -180.000183105 is the value in the file at the western 
boundary of the bounding box. This means that the exceeding coordinates 
cannot be returned, but one could iterate over the bounding boxes of the 
Polygons or Lines objects to find the exceeding object.

Roger

>
> Agus
>
> 2011/12/17 Roger Bivand <Roger.Bivand at nhh.no>:
>> On Sat, 17 Dec 2011, Roger Bivand wrote:
>>
>>> On Fri, 16 Dec 2011, Agustin Lobo wrote:
>>>
>>>> Hi!
>>>>
>>>> I've uploaded the file here:
>>>> https://sites.google.com/site/filestemp2/home/world_adm0.zip
>>>>
>>>> It was a popular file, but actually cannot find it in the diva server any
>>>> more
>>>> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>>>>
>>>> Extents:
>>>> In layer spatial reference system units : xMin,yMin -180,-90 :
>>>> xMax,yMax 180,83.623
>>>> but readOGR() probably makes a more rigorous check.
>>>
>>>
>>> Right. Thanks for access to the file. If I change the name of the *.prj
>>> file, I see:
>>>
>>>> wrld <- readOGR(".", "world_adm0")
>>>> print(bbox(wrld), digits=12)
>>>
>>> ? ? ? ? ? ?min ? ? ? ? ? ?max
>>> x -180.000183105 180.0000000000
>>> y ?-90.000000000 ?83.6230316162
>>>
>>> so it is going sufficiently far below -180 for the validity check at
>>> .Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly
>>> slacker tolerance. I suggest providing a tolerance in an option in sp to
>>> resolve this. The error is primarily to stop users assigning a +proj=longlat
>>> to projected coordinates (yes, it does happen). I'll look to add an options
>>> mechanism to sp to handle both error/warning and tolerance for the power to
>>> .Machine$double.eps.
>>
>>
>> This is now committed to the rspatial R-forge project, module sp, revision
>> 1179. Now it is possible either to throw a warning rather than an error,
>> and/or to alter the tolerance; the error message now shows the exceeding
>> value(s):
>>
>>> library(rgdal)
>>
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Error in validityMethod(as(object, superClass)) :
>> ?Geographical CRS given to non-conformant data: -180.000183105
>>>
>>> set_ll_warn(TRUE)
>>
>> [1] TRUE
>>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Warning message:
>> In validityMethod(as(object, superClass)) :
>> ?Geographical CRS given to non-conformant data: -180.000183105
>>>
>>> set_ll_warn(FALSE)
>>
>> [1] FALSE
>>>
>>> set_ll_TOL(0.2)
>>
>> [1] 0.2
>>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>>>
>>>
>>
>> Please let me know if this helps,
>>
>> Roger
>>
>>
>>>
>>> Had you looked at using the wrld_simpl dataset that is disributed with
>>> maptools:
>>>
>>> data(wrld_simpl)
>>>
>>> and joining countries with the codes included? It is a bit out od date in
>>> not having the Sudan split; it is about twice the object size of the file
>>> you are using, plotting somewhat more slowly:
>>>
>>>> object.size(wrld_simpl)
>>>
>>> 6349008 bytes
>>>>
>>>> object.size(wrld)
>>>
>>> 3250784 bytes
>>>>
>>>> plot(wrld_simpl)
>>>> plot(wrld, border="red", add=TRUE)
>>>
>>>
>>> The file simplifies sea ice in Antarctica, and discards many small
>>> islands, otherwise they match pretty well.
>>>
>>> Roger
>>>
>>>>
>>>> Could it be possible that readOGR() ?read the file with a warning
>>>> and print the offending coordinates?
>>>>
>>>> readOGR() works fine with this alternative file:
>>>> http://www.gadm.org/data/gadm_v1_lev0_shp.zip
>>>>
>>>> but it's huge and cannot actually work with it and have not found a
>>>> third alternative.
>>>>
>>>> Thanks,
>>>>
>>>> Agus
>>>>
>>>> 2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
>>>>>
>>>>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>>>>
>>>>>> Agus,
>>>>>>
>>>>>> This is likely because there are some longitude coordinates that are ?<
>>>>>> -180 or > 180.
>>>>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>>>>> sp:::.ll_sanity ?and throws an error.
>>>>>>
>>>>>> I think it would be preferable if sp gave a warning rather than an
>>>>>> error,
>>>>>> at least when longitudes are within a reasonable number (-360 -- 360
>>>>>> ?). I
>>>>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>>>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>>>>> lon/lat coordinates.
>>>>>
>>>>>
>>>>>
>>>>> As Agus knows, unless the file is made available, help will likely not
>>>>> be
>>>>> forthcoming. Without a traceback(), we don't know where the error is
>>>>> being
>>>>> thrown. The fact that an out of domain number is interpretable in one
>>>>> context doesn't necessarily make it acceptable in others, I believe. We
>>>>> could go to an option setting, which would slacken the error to a
>>>>> warning if
>>>>> set. Opinions?
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>>
>>>>>> Robert
>>>>>>
>>>>>>
>>>>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>>>>>> wrote:
>>>>>>
>>>>>>> Hi!
>>>>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>>>>
>>>>>>>>
>>>>>>>> ogrInfo(dsn=datad,layer="world_adm0v2")
>>>>>>>
>>>>>>>
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> Driver: ESRI Shapefile number of rows 209
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> +proj=longlat +datum=WGS84 +no_defs
>>>>>>> Number of fields: 3
>>>>>>> ? ? ?name type length typeName
>>>>>>> 1 ? ? ?NAME ? ?4 ? ? 40 ? String
>>>>>>> 2 GMI_CNTRY ? ?4 ? ? ?3 ? String
>>>>>>> 3 ? ?REGION ? ?4 ? ? 25 ? String
>>>>>>>
>>>>>>> but I get:
>>>>>>>>
>>>>>>>>
>>>>>>>> world <-readOGR(dsn=datad,layer="world_adm0v2")
>>>>>>>
>>>>>>>
>>>>>>> OGR data source with driver: ESRI Shapefile
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/ExIE2011DATA/ExFireBorneoDATA/world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> with 209 features and 3 fields
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> Error in validityMethod(as(object, superClass)) :
>>>>>>> ?Geographical CRS given to non-conformant data
>>>>>>> I've tried
>>>>>>>>
>>>>>>>>
>>>>>>>> world
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> <-readOGR(dsn=datad,layer="world_adm0v2",p4s=CRSargs(CRS("+init=epsg:4326")))
>>>>>>> but get the same result
>>>>>>>
>>>>>>> can't this CRS (epsg:4326)
>>>>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>>>> be read by readOGR() ?
>>>>>>>
>>>>>>> Thanks
>>>>>>> Agus
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>
>>>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From miaoyingshi23 at gmail.com  Sun Dec 18 22:40:41 2011
From: miaoyingshi23 at gmail.com (Miaoying Shi)
Date: Sun, 18 Dec 2011 16:40:41 -0500
Subject: [R-sig-Geo] converting line segment into polyline
Message-ID: <CABx2-fDqzudn8a_6-CG8Z8GRwPT4oyzV_zpo-FWyRwQkq6A_iw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111218/26b379c3/attachment.pl>

From r.turner at auckland.ac.nz  Mon Dec 19 08:30:58 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 19 Dec 2011 20:30:58 +1300
Subject: [R-sig-Geo] converting line segment into polyline
In-Reply-To: <CABx2-fDqzudn8a_6-CG8Z8GRwPT4oyzV_zpo-FWyRwQkq6A_iw@mail.gmail.com>
References: <CABx2-fDqzudn8a_6-CG8Z8GRwPT4oyzV_zpo-FWyRwQkq6A_iw@mail.gmail.com>
Message-ID: <4EEEE832.4010108@auckland.ac.nz>


As it stands, your question does not make a lot of sense.  A psp object
is a collection of (in general) unrelated line segments. A *polyline*
in my understanding is a collection of *related* line segments ``joined
end to end''.  I.e. a polyline is effectively a sequence of points (x_i,y_i)
where (conceptually at least) the i-th point is joined to the (i+1)-st
point by a line segment.

Hence, in a sense, there is an enormous number of ways in which
a psp object could be turned into a polyline --- arrange the segments
in arbitrary order and then "join" the second point of the i-th segment
to the first point of the (i+1)-st segment.  (The first point of each 
segment
is ``already joined'' to the second point of that segment.)

Few if any of these ``ways'' would be meaningful or useful.

You will have to be much more clear and explicit in your question if
you want any real help.

BTW what do you mean by ``***back*** into a polyline''?
Please note the dictum:  "R lacks a mind_read() function."
As do I.

     cheers,

         Rolf Turner

P. S.  I do not know if there is formal "polyline" class (either S3 or S4)
defined in any R package.  If there is, please enlighten me.

The PBSmapping package has a class "PolySet"; a PolySet object is in
effect a collection of polylines.

         R. T.

On 19/12/11 10:40, Miaoying Shi wrote:
> Hello, Lists,
>
>   I have been searching a method to convert psp format line segment back
> into polyline, as the psp data (p1) is like below, is there anyone can help
> me?  Thanks a lot!
>
> Erin
>
>
>
>> str(p1)
> List of 5
>   $ ends      :'data.frame':     22511 obs. of  4 variables:
>    ..$ x0: num [1:22511] 233994 233966 233949 233929 233885 ...
>    ..$ y0: num [1:22511] 3355530 3355519 3355515 3355508 3355533 ...
>    ..$ x1: num [1:22511] 233946 233918 233911 233873 233889 ...
>    ..$ y1: num [1:22511] 3355510 3355511 3355512 3355513 3355514 ...
>   $ window    :List of 4
>    ..$ type  : chr "rectangle"
>    ..$ xrange: Named num [1:2] 228691 236822
>    .. ..- attr(*, "names")= chr [1:2] "min" "max"
>    ..$ yrange: Named num [1:2] 3347926 3356435
>    .. ..- attr(*, "names")= chr [1:2] "min" "max"
>    ..$ units :List of 3
>    .. ..$ singular  : chr "unit"
>    .. ..$ plural    : chr "units"
>    .. ..$ multiplier: num 1
>    .. ..- attr(*, "class")= chr "units"
>    ..- attr(*, "class")= chr "owin"
>   $ n         : int 22511
>   $ marks     : int [1:22511] 37 37 37 37 37 37 37 37 100 100 ...
>   $ markformat: chr "vector"
>   - attr(*, "class")= chr [1:2] "psp" "list"
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dimefthim at gmail.com  Mon Dec 19 08:48:43 2011
From: dimefthim at gmail.com (Dimitrios Efthymiou)
Date: Mon, 19 Dec 2011 09:48:43 +0200
Subject: [R-sig-Geo] Distance from SpatialLinesDataFrame
Message-ID: <CAFaxxcuw6GqmzLvQNJaXW9QbJTAqyPhfJxZ=WK4cvwwPnk5Z1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111219/b2aa18c3/attachment.pl>

From Roger.Bivand at nhh.no  Mon Dec 19 09:17:11 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Dec 2011 09:17:11 +0100 (CET)
Subject: [R-sig-Geo] Distance from SpatialLinesDataFrame
In-Reply-To: <CAFaxxcuw6GqmzLvQNJaXW9QbJTAqyPhfJxZ=WK4cvwwPnk5Z1A@mail.gmail.com>
References: <CAFaxxcuw6GqmzLvQNJaXW9QbJTAqyPhfJxZ=WK4cvwwPnk5Z1A@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112190916320.28929@reclus.nhh.no>

On Mon, 19 Dec 2011, Dimitrios Efthymiou wrote:

> Hi,
>
> I'm using the function "distanceFromPoints" of the R package 'raster' to
> create a raster with the Euclidean distances from a SpatialPointsDataFrame.
>
> Is there a similar command to calculate the Euclidean Distance from a
> SpatialLinesDataFrame object (in my case this is a highway)?

Please try gDistance() in rgeos.

Roger

>
> What I'm doing now, is to extract the Mid points of
> the SpatialLineDataFrame using the command "SpatialLineDataFrame", and then
> create a raster with distances from these points.
> However, I need something more accurate.
>
> Thanks in advance for you help.
>
>
>> sessionInfo() R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] splines   grid      stats     graphics  grDevices utils
> datasets  methods   base
>
> other attached packages:
> [1] ape_2.8             ade4_1.4-17         car_2.0-11
> survival_2.36-10    nnet_7.3-1
> [6] gstat_1.0-10        spacetime_0.5-7     xts_0.8-2
> zoo_1.7-6           rasterVis_0.10-7
> [11] hexbin_1.26.0       latticeExtra_0.6-19 RColorBrewer_1.0-5
> RANN_2.1.3          spdep_0.5-43
> [16] coda_0.14-6         nlme_3.1-102        MASS_7.3-16
> Matrix_1.0-2        boot_1.3-3
> [21] ggplot2_0.8.9       proto_0.3-9.2       reshape_0.8.4
> plyr_1.6            spgwr_0.6-13
> [26] spatstat_1.25-0     deldir_0.0-16       mgcv_1.7-12
> rgdal_0.7-5         maptools_0.8-10
> [31] lattice_0.20-0      foreign_0.8-48      raster_1.9-55
> sp_0.9-91
>
> loaded via a namespace (and not attached):
> [1] gee_4.13-17  tools_2.14.0
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Dec 19 11:30:32 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Dec 2011 11:30:32 +0100 (CET)
Subject: [R-sig-Geo] converting line segment into polyline
In-Reply-To: <4EEEE832.4010108@auckland.ac.nz>
References: <CABx2-fDqzudn8a_6-CG8Z8GRwPT4oyzV_zpo-FWyRwQkq6A_iw@mail.gmail.com>
	<4EEEE832.4010108@auckland.ac.nz>
Message-ID: <alpine.LRH.2.00.1112191125010.28929@reclus.nhh.no>

On Mon, 19 Dec 2011, Rolf Turner wrote:

>
> As it stands, your question does not make a lot of sense.  A psp object
> is a collection of (in general) unrelated line segments. A *polyline*
> in my understanding is a collection of *related* line segments ``joined
> end to end''.  I.e. a polyline is effectively a sequence of points (x_i,y_i)
> where (conceptually at least) the i-th point is joined to the (i+1)-st
> point by a line segment.
>
> Hence, in a sense, there is an enormous number of ways in which
> a psp object could be turned into a polyline --- arrange the segments
> in arbitrary order and then "join" the second point of the i-th segment
> to the first point of the (i+1)-st segment.  (The first point of each segment
> is ``already joined'' to the second point of that segment.)
>
> Few if any of these ``ways'' would be meaningful or useful.
>
> You will have to be much more clear and explicit in your question if
> you want any real help.

Yes, it would be useful to know where the psp objects come into your 
workflow, and if you do need them. A possible answer to your question is:

library(maptools)
xx <- readShapeSpatial(system.file("shapes/fylk-val.shp",
  package="maptools")[1], proj4string =
  CRS("+proj=utm +zone=33 +datum=WGS84"))
dim(xx)
xxPSP <- as.psp(xx[,"VALINJE_"])
str(xxPSP)
xx1 <- as(xxPSP, "SpatialLines")
# using the version of maptools on R-forge or wait for it to reach CRAN, 
# submitted today
library(rgeos)
xx2 <- gLineMerge(xx1)

There isn't a way yet to merge the lines respecting the marks in the psp 
object, but this might be possible to accommodate, xx2 here has one Lines 
object containing 93 Line objects.

Hope this helps,

Roger

>
> BTW what do you mean by ``***back*** into a polyline''?
> Please note the dictum:  "R lacks a mind_read() function."
> As do I.
>
>    cheers,
>
>        Rolf Turner
>
> P. S.  I do not know if there is formal "polyline" class (either S3 or S4)
> defined in any R package.  If there is, please enlighten me.
>
> The PBSmapping package has a class "PolySet"; a PolySet object is in
> effect a collection of polylines.
>
>        R. T.
>
> On 19/12/11 10:40, Miaoying Shi wrote:
>> Hello, Lists,
>>
>>   I have been searching a method to convert psp format line segment back
>> into polyline, as the psp data (p1) is like below, is there anyone can help
>> me?  Thanks a lot!
>> 
>> Erin
>> 
>> 
>> 
>>> str(p1)
>> List of 5
>>   $ ends      :'data.frame':     22511 obs. of  4 variables:
>>    ..$ x0: num [1:22511] 233994 233966 233949 233929 233885 ...
>>    ..$ y0: num [1:22511] 3355530 3355519 3355515 3355508 3355533 ...
>>    ..$ x1: num [1:22511] 233946 233918 233911 233873 233889 ...
>>    ..$ y1: num [1:22511] 3355510 3355511 3355512 3355513 3355514 ...
>>   $ window    :List of 4
>>    ..$ type  : chr "rectangle"
>>    ..$ xrange: Named num [1:2] 228691 236822
>>    .. ..- attr(*, "names")= chr [1:2] "min" "max"
>>    ..$ yrange: Named num [1:2] 3347926 3356435
>>    .. ..- attr(*, "names")= chr [1:2] "min" "max"
>>    ..$ units :List of 3
>>    .. ..$ singular  : chr "unit"
>>    .. ..$ plural    : chr "units"
>>    .. ..$ multiplier: num 1
>>    .. ..- attr(*, "class")= chr "units"
>>    ..- attr(*, "class")= chr "owin"
>>   $ n         : int 22511
>>   $ marks     : int [1:22511] 37 37 37 37 37 37 37 37 100 100 ...
>>   $ markformat: chr "vector"
>>   - attr(*, "class")= chr [1:2] "psp" "list"
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From hevals at gmail.com  Mon Dec 19 15:07:43 2011
From: hevals at gmail.com (=?ISO-8859-1?Q?Henri_Vall=E8s?=)
Date: Mon, 19 Dec 2011 10:07:43 -0400
Subject: [R-sig-Geo] removing spatial autocorrelation with ME function and
 subsequently testing with lm.morantest
Message-ID: <CAGpXgKuwgPeFgO5K866OV5jgK8GtvmPBNK=8P9nQ7RYiahnJOA@mail.gmail.com>

Hi,

I am hoping somebody will be able to assist me.

I am using the "ME" function of the "spdep" package to select a suite
of eigenvectors that successfully removes any significant spatial
autocorrelation (at a nominal level of 0.05) from my dependent
variable (density, "den") given a spatial weighting matrix
(listwdist).

The code and output:

> ME_model=ME(den~1,listw=listwdist,verbose=TRUE,nsim=999,alpha=0.05)

eV[,1], I: 0.2267349 ZI: NA, pr(ZI): 0.001
eV[,8], I: 0.1727207 ZI: NA, pr(ZI): 0.001
eV[,3], I: 0.1490887 ZI: NA, pr(ZI): 0.001
eV[,5], I: 0.1260945 ZI: NA, pr(ZI): 0.001
eV[,2], I: 0.1042690 ZI: NA, pr(ZI): 0.001
eV[,15], I: 0.08287102 ZI: NA, pr(ZI): 0.001
eV[,10], I: 0.06740037 ZI: NA, pr(ZI): 0.001
eV[,7], I: 0.0513471 ZI: NA, pr(ZI): 0.001
eV[,21], I: 0.03391224 ZI: NA, pr(ZI): 0.018
eV[,13], I: 0.01831637 ZI: NA, pr(ZI): 0.073


However, when I use the "lm.morantest" function to double-check
whether there is any significant autocorrelation in the residuals,
using "den" as the dependent variable and the selected eigenvectors as
predictors (ME_model$vectors), the test indicates that there still is
considerable autocorrelation left in the residuals:

 model=lm(den~ME_model$vectors)

> lm.morantest(model,listwdist)

        Global Moran's I for regression residuals

data:
model: lm(formula = den ~ ME_model$vectors)
weights: listwdist

Moran I statistic standard deviate = 5.2239, p-value = 8.761e-08
alternative hypothesis: greater
sample estimates:
Observed Moran's I        Expectation           Variance
      1.831637e-02      -2.453698e-02       6.729546e-05


In contrast, I get a different result (but one that would be more
consistent with the outcome of the ME function) when I extract the
residuals from the model above and run a "moran.test" on those
residuals, although I have just found out that using the residuals
this way appears not to be valid:

>moran.test(residuals(model),listwdist)

Moran's I test under randomisation, .
data:  residuals(model)
weights: listwdist
Moran I statistic standard deviate = 1.5546, p-value = 0.06002
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance
     0.0183163706     -0.0024154589      0.0001778361


I would very much appreciate if anyone could help me understand these
discrepancies between methods or what is it that I am doing wrong?

Regards,

Henri Valles
Lecturer in Ecology
Department of Biological and Chemical Sciences
University of the West Indies, Cave Hill Campus, Barbados, BB11000
tel (Direct): (246) 417-4328
E-mail: hevals at gmail.com


From tsippel at gmail.com  Mon Dec 19 22:01:43 2011
From: tsippel at gmail.com (tsippel)
Date: Mon, 19 Dec 2011 13:01:43 -0800
Subject: [R-sig-Geo] summarize and plot spatial data by grid cell function
Message-ID: <CANgNK75dQ1XL+cPynPLsV785KXGvd=9DAwbwJXPLqUTxiCv16g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111219/9417b1d8/attachment.pl>

From miaoyingshi23 at gmail.com  Mon Dec 19 22:17:50 2011
From: miaoyingshi23 at gmail.com (Miaoying Shi)
Date: Mon, 19 Dec 2011 16:17:50 -0500
Subject: [R-sig-Geo] converting line segment into polyline
In-Reply-To: <alpine.LRH.2.00.1112191125010.28929@reclus.nhh.no>
References: <CABx2-fDqzudn8a_6-CG8Z8GRwPT4oyzV_zpo-FWyRwQkq6A_iw@mail.gmail.com>
	<4EEEE832.4010108@auckland.ac.nz>
	<alpine.LRH.2.00.1112191125010.28929@reclus.nhh.no>
Message-ID: <CABx2-fDdhc9axwGwhQRTpwdwngcS1Dbc-+e7_crDJCRkeH3C2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111219/23e3e337/attachment.pl>

From benweinstein2010 at gmail.com  Mon Dec 19 23:18:43 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Mon, 19 Dec 2011 17:18:43 -0500
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
	<alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
Message-ID: <CAC28k7TMK_aC0F7YDtjrcB7bK_Fkq85-=7yPJtGQFmAgY6V5DQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111219/c280dd4d/attachment.pl>

From senawusl at yahoo.com  Tue Dec 20 01:29:32 2011
From: senawusl at yahoo.com (senani karunaratne)
Date: Mon, 19 Dec 2011 16:29:32 -0800 (PST)
Subject: [R-sig-Geo] Examine the fixed effects in geoR
In-Reply-To: <mailman.7.1324292403.18027.r-sig-geo@r-project.org>
References: <mailman.7.1324292403.18027.r-sig-geo@r-project.org>
Message-ID: <1324340972.30492.YahooMailNeo@web113201.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111219/1b914444/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Tue Dec 20 07:40:58 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Tue, 20 Dec 2011 07:40:58 +0100
Subject: [R-sig-Geo] computing polygons from a centroid point distribution
Message-ID: <4EF02DFA.9040009@univ-fcomte.fr>

Hi,

Given a spatial point distribution in a two dimensional space, I wonder 
if there is a function in R that could make a polygon partition of the 
two dimensional space, with each point as centroid of each polygon ?

Any suggestion about package(s) and function(s), if any, welcome,

Best,

Patrick


From lists at remoteinformation.com.au  Tue Dec 20 07:53:46 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Tue, 20 Dec 2011 14:53:46 +0800
Subject: [R-sig-Geo] computing polygons from a centroid point
	distribution
In-Reply-To: <4EF02DFA.9040009@univ-fcomte.fr>
References: <4EF02DFA.9040009@univ-fcomte.fr>
Message-ID: <4A316DEA-F34F-4131-891E-D32ED0FBA9AC@remoteinformation.com.au>

Patrick,

On 20/12/2011, at 2:40 PM, Patrick Giraudoux wrote:

> Given a spatial point distribution in a two dimensional space, I wonder if there is a function in R that could make a polygon partition of the two dimensional space, with each point as centroid of each polygon ?
> 
> Any suggestion about package(s) and function(s), if any, welcome,

> library(deldir)
> ?deldir

might be what you are after?

cheers

Ben


From Roger.Bivand at nhh.no  Tue Dec 20 09:36:58 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Dec 2011 09:36:58 +0100 (CET)
Subject: [R-sig-Geo] removing spatial autocorrelation with ME function
 and subsequently testing with lm.morantest
In-Reply-To: <CAGpXgKuwgPeFgO5K866OV5jgK8GtvmPBNK=8P9nQ7RYiahnJOA@mail.gmail.com>
References: <CAGpXgKuwgPeFgO5K866OV5jgK8GtvmPBNK=8P9nQ7RYiahnJOA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112200930560.1427@reclus.nhh.no>

On Mon, 19 Dec 2011, Henri Vall?s wrote:

> Hi,
>
> I am hoping somebody will be able to assist me.
>
> I am using the "ME" function of the "spdep" package to select a suite
> of eigenvectors that successfully removes any significant spatial
> autocorrelation (at a nominal level of 0.05) from my dependent
> variable (density, "den") given a spatial weighting matrix
> (listwdist).

The choice of alpha=0.05 is very conservative, and could well be larger. 
Your results are down to your data:

library(spdep)
example(columbus)
lagcol <- SpatialFiltering(CRIME ~ 1, data=columbus, nb=col.gal.nb,
   style="W", alpha=0.05, verbose=TRUE)
lmlag <- lm(CRIME ~ fitted(lagcol), data=columbus)
lm.morantest(lmlag, nb2listw(col.gal.nb))
lagcol1 <- ME(CRIME ~ 1, data=columbus, family="gaussian",
   listw=nb2listw(col.gal.nb), alpha=0.05, stdev=TRUE, verbose=TRUE)
lmlag1 <- lm(CRIME ~ fitted(lagcol1), data=columbus)
lm.morantest(lmlag1, nb2listw(col.gal.nb))

which all show lm.morantest() at approximately the target alpha. Note that 
ME() with the default Gaussian family is the same as SpatialFiltering() 
but using a bootstrap test on the regression residuals (an approximation), 
rather than the analytical test, so SpatialFiltering() would normally be 
preferred. There is something in your data that is driving this. Please 
try to reproduce your problem with a data set shipped with spdep or 
maptools. Your null model is also asking for trouble, as most of the 
observed autocorrelation in dens is caused by missing covariates.

Hope this helps,

Roger


>
> The code and output:
>
>> ME_model=ME(den~1,listw=listwdist,verbose=TRUE,nsim=999,alpha=0.05)
>
> eV[,1], I: 0.2267349 ZI: NA, pr(ZI): 0.001
> eV[,8], I: 0.1727207 ZI: NA, pr(ZI): 0.001
> eV[,3], I: 0.1490887 ZI: NA, pr(ZI): 0.001
> eV[,5], I: 0.1260945 ZI: NA, pr(ZI): 0.001
> eV[,2], I: 0.1042690 ZI: NA, pr(ZI): 0.001
> eV[,15], I: 0.08287102 ZI: NA, pr(ZI): 0.001
> eV[,10], I: 0.06740037 ZI: NA, pr(ZI): 0.001
> eV[,7], I: 0.0513471 ZI: NA, pr(ZI): 0.001
> eV[,21], I: 0.03391224 ZI: NA, pr(ZI): 0.018
> eV[,13], I: 0.01831637 ZI: NA, pr(ZI): 0.073
>
>
> However, when I use the "lm.morantest" function to double-check
> whether there is any significant autocorrelation in the residuals,
> using "den" as the dependent variable and the selected eigenvectors as
> predictors (ME_model$vectors), the test indicates that there still is
> considerable autocorrelation left in the residuals:
>
> model=lm(den~ME_model$vectors)
>
>> lm.morantest(model,listwdist)
>
>        Global Moran's I for regression residuals
>
> data:
> model: lm(formula = den ~ ME_model$vectors)
> weights: listwdist
>
> Moran I statistic standard deviate = 5.2239, p-value = 8.761e-08
> alternative hypothesis: greater
> sample estimates:
> Observed Moran's I        Expectation           Variance
>      1.831637e-02      -2.453698e-02       6.729546e-05
>
>
> In contrast, I get a different result (but one that would be more
> consistent with the outcome of the ME function) when I extract the
> residuals from the model above and run a "moran.test" on those
> residuals, although I have just found out that using the residuals
> this way appears not to be valid:
>
>> moran.test(residuals(model),listwdist)
>
> Moran's I test under randomisation, .
> data:  residuals(model)
> weights: listwdist
> Moran I statistic standard deviate = 1.5546, p-value = 0.06002
> alternative hypothesis: greater
> sample estimates:
> Moran I statistic       Expectation          Variance
>     0.0183163706     -0.0024154589      0.0001778361
>
>
> I would very much appreciate if anyone could help me understand these
> discrepancies between methods or what is it that I am doing wrong?
>
> Regards,
>
> Henri Valles
> Lecturer in Ecology
> Department of Biological and Chemical Sciences
> University of the West Indies, Cave Hill Campus, Barbados, BB11000
> tel (Direct): (246) 417-4328
> E-mail: hevals at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From patrick.giraudoux at univ-fcomte.fr  Tue Dec 20 09:55:29 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Tue, 20 Dec 2011 09:55:29 +0100
Subject: [R-sig-Geo] computing polygons from a centroid point
	distribution
In-Reply-To: <4A316DEA-F34F-4131-891E-D32ED0FBA9AC@remoteinformation.com.au>
References: <4EF02DFA.9040009@univ-fcomte.fr>
	<4A316DEA-F34F-4131-891E-D32ED0FBA9AC@remoteinformation.com.au>
Message-ID: <4EF04D81.2040107@univ-fcomte.fr>

Le 20/12/2011 07:53, Ben Madin a ?crit :
> Patrick,
>
> On 20/12/2011, at 2:40 PM, Patrick Giraudoux wrote:
>
>> Given a spatial point distribution in a two dimensional space, I wonder if there is a function in R that could make a polygon partition of the two dimensional space, with each point as centroid of each polygon ?
>>
>> Any suggestion about package(s) and function(s), if any, welcome,
>> library(deldir)
>> ?deldir
> might be what you are after?
>
> cheers
>
> Ben
>
>

Yes ! exactly what I needed. Missed that it could have been properly 
called "tesselation", rather than to use winding explanations...

Many thanks,

Patrick


From Roger.Bivand at nhh.no  Tue Dec 20 09:56:43 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Dec 2011 09:56:43 +0100 (CET)
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CAC28k7TMK_aC0F7YDtjrcB7bK_Fkq85-=7yPJtGQFmAgY6V5DQ@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
	<alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
	<CAC28k7TMK_aC0F7YDtjrcB7bK_Fkq85-=7yPJtGQFmAgY6V5DQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112200942280.1427@reclus.nhh.no>

On Mon, 19 Dec 2011, Ben Weinstein wrote:

> Thanks for updating the readOGR function. I've been getting the same error
> as Agus when tying to make richness maps using the new rangeMapper package
> (there are birds in the arctic circle). Will it be sufficient for me to
> wait for the windows update of sp, and the changes will be inherited into
> the function? Or do i need to edit the source code of rangeMapper to
> reflect the changes in sp.

sp_0.9-92.zip is diffusing across CRAN mirrors, so I suggest you try it 
out once you've updated. Please report back on whether the changes help in 
your case.

Roger

>
> Thanks for the help
>
> Ben Weinstein
>
> On Sat, Dec 17, 2011 at 10:27 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Sat, 17 Dec 2011, Roger Bivand wrote:
>>
>>  On Fri, 16 Dec 2011, Agustin Lobo wrote:
>>>
>>>  Hi!
>>>>
>>>> I've uploaded the file here:
>>>> https://sites.google.com/site/**filestemp2/home/world_adm0.zip<https://sites.google.com/site/filestemp2/home/world_adm0.zip>
>>>>
>>>> It was a popular file, but actually cannot find it in the diva server
>>>> any more
>>>> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>>>>
>>>> Extents:
>>>> In layer spatial reference system units : xMin,yMin -180,-90 :
>>>> xMax,yMax 180,83.623
>>>> but readOGR() probably makes a more rigorous check.
>>>>
>>>
>>> Right. Thanks for access to the file. If I change the name of the *.prj
>>> file, I see:
>>>
>>>  wrld <- readOGR(".", "world_adm0")
>>>> print(bbox(wrld), digits=12)
>>>>
>>>            min            max
>>> x -180.000183105 180.0000000000
>>> y  -90.000000000  83.6230316162
>>>
>>> so it is going sufficiently far below -180 for the validity check at
>>> .Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly
>>> slacker tolerance. I suggest providing a tolerance in an option in sp to
>>> resolve this. The error is primarily to stop users assigning a
>>> +proj=longlat to projected coordinates (yes, it does happen). I'll look to
>>> add an options mechanism to sp to handle both error/warning and tolerance
>>> for the power to .Machine$double.eps.
>>>
>>
>> This is now committed to the rspatial R-forge project, module sp, revision
>> 1179. Now it is possible either to throw a warning rather than an error,
>> and/or to alter the tolerance; the error message now shows the exceeding
>> value(s):
>>
>>  library(rgdal)
>>>
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Error in validityMethod(as(object, superClass)) :
>>  Geographical CRS given to non-conformant data: -180.000183105
>>
>>> set_ll_warn(TRUE)
>>>
>> [1] TRUE
>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Warning message:
>> In validityMethod(as(object, superClass)) :
>>  Geographical CRS given to non-conformant data: -180.000183105
>>
>>> set_ll_warn(FALSE)
>>>
>> [1] FALSE
>>
>>> set_ll_TOL(0.2)
>>>
>> [1] 0.2
>>
>>> wrld1 <- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>>
>>>
>>>
>> Please let me know if this helps,
>>
>> Roger
>>
>>
>>
>>> Had you looked at using the wrld_simpl dataset that is disributed with
>>> maptools:
>>>
>>> data(wrld_simpl)
>>>
>>> and joining countries with the codes included? It is a bit out od date in
>>> not having the Sudan split; it is about twice the object size of the file
>>> you are using, plotting somewhat more slowly:
>>>
>>>  object.size(wrld_simpl)
>>>>
>>> 6349008 bytes
>>>
>>>> object.size(wrld)
>>>>
>>> 3250784 bytes
>>>
>>>> plot(wrld_simpl)
>>>> plot(wrld, border="red", add=TRUE)
>>>>
>>>
>>> The file simplifies sea ice in Antarctica, and discards many small
>>> islands, otherwise they match pretty well.
>>>
>>> Roger
>>>
>>>
>>>> Could it be possible that readOGR()  read the file with a warning
>>>> and print the offending coordinates?
>>>>
>>>> readOGR() works fine with this alternative file:
>>>> http://www.gadm.org/data/gadm_**v1_lev0_shp.zip<http://www.gadm.org/data/gadm_v1_lev0_shp.zip>
>>>>
>>>> but it's huge and cannot actually work with it and have not found a
>>>> third alternative.
>>>>
>>>> Thanks,
>>>>
>>>> Agus
>>>>
>>>> 2011/12/16 Roger Bivand <Roger.Bivand at nhh.no>:
>>>>
>>>>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>>>>
>>>>>  Agus,
>>>>>>
>>>>>> This is likely because there are some longitude coordinates that are  <
>>>>>> -180 or > 180.
>>>>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>>>>> sp:::.ll_sanity  and throws an error.
>>>>>>
>>>>>> I think it would be preferable if sp gave a warning rather than an
>>>>>> error,
>>>>>> at least when longitudes are within a reasonable number (-360 -- 360
>>>>>> ?). I
>>>>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>>>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>>>>> lon/lat coordinates.
>>>>>>
>>>>>
>>>>>
>>>>> As Agus knows, unless the file is made available, help will likely not
>>>>> be
>>>>> forthcoming. Without a traceback(), we don't know where the error is
>>>>> being
>>>>> thrown. The fact that an out of domain number is interpretable in one
>>>>> context doesn't necessarily make it acceptable in others, I believe. We
>>>>> could go to an option setting, which would slacken the error to a
>>>>> warning if
>>>>> set. Opinions?
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>
>>>>>> Robert
>>>>>>
>>>>>>
>>>>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo <alobolistas at gmail.com>
>>>>>> wrote:
>>>>>>
>>>>>>  Hi!
>>>>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>>>
>>>>>>>>
>>>>>>>> ogrInfo(dsn=datad,layer="**world_adm0v2")
>>>>>>>>
>>>>>>>
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/**ExIE2011DATA/ExFireBorneoDATA/**
>>>>>>> world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> Driver: ESRI Shapefile number of rows 209
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> +proj=longlat +datum=WGS84 +no_defs
>>>>>>> Number of fields: 3
>>>>>>>      name type length typeName
>>>>>>> 1      NAME    4     40   String
>>>>>>> 2 GMI_CNTRY    4      3   String
>>>>>>> 3    REGION    4     25   String
>>>>>>>
>>>>>>> but I get:
>>>>>>>
>>>>>>>>
>>>>>>>> world <-readOGR(dsn=datad,layer="**world_adm0v2")
>>>>>>>>
>>>>>>>
>>>>>>> OGR data source with driver: ESRI Shapefile
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/**ExIE2011DATA/ExFireBorneoDATA/**
>>>>>>> world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> with 209 features and 3 fields
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> Error in validityMethod(as(object, superClass)) :
>>>>>>>  Geographical CRS given to non-conformant data
>>>>>>> I've tried
>>>>>>>
>>>>>>>>
>>>>>>>> world
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> <-readOGR(dsn=datad,layer="**world_adm0v2",p4s=CRSargs(CRS(**
>>>>>>> "+init=epsg:4326")))
>>>>>>> but get the same result
>>>>>>>
>>>>>>> can't this CRS (epsg:4326)
>>>>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>>>> be read by readOGR() ?
>>>>>>>
>>>>>>> Thanks
>>>>>>> Agus
>>>>>>>
>>>>>>> ______________________________**_________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>
>>>>>>>
>>>>>>        [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________**_________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>
>>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>>
>>>>> ______________________________**_________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>
>>>>
>>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From valcu at orn.mpg.de  Tue Dec 20 11:39:36 2011
From: valcu at orn.mpg.de (Mihai Valcu)
Date: Tue, 20 Dec 2011 11:39:36 +0100
Subject: [R-sig-Geo] "Geographical CRS given to non-conformant data" for
 CRS of epsg:4326
In-Reply-To: <CAC28k7TMK_aC0F7YDtjrcB7bK_Fkq85-=7yPJtGQFmAgY6V5DQ@mail.gmail.com>
References: <CAG4NRe+FJKNd-WBW206o0EnftyqxZ7+kou2CwHs0uWLQK84H_g@mail.gmail.com>
	<CANtt_hwEJ-PP0oeiia17N8if_bzR6MSV6COL5E=k3BzfLi+Evw@mail.gmail.com>
	<alpine.LRH.2.00.1112161849090.20029@reclus.nhh.no>
	<CAG4NReLu5Dqn40rc=AY2_8U=AL=39b6H-a-WZ+oWwnHoi8XvXA@mail.gmail.com>
	<alpine.LRH.2.00.1112171327320.22806@reclus.nhh.no>
	<alpine.LRH.2.00.1112171624020.22806@reclus.nhh.no>
	<CAC28k7TMK_aC0F7YDtjrcB7bK_Fkq85-=7yPJtGQFmAgY6V5DQ@mail.gmail.com>
Message-ID: <4EF065E8.4010402@orn.mpg.de>

I would guess the issue in focus here should not affect much other 
packages depending on sp.
regarding rangeMapper would be nicer to write/contribute a new 
'processRanges' Method than to alter the source code.
regards
Mihai

On 12/19/2011 11:18 PM, Ben Weinstein wrote:
> Thanks for updating the readOGR function. I've been getting the same error
> as Agus when tying to make richness maps using the new rangeMapper package
> (there are birds in the arctic circle). Will it be sufficient for me to
> wait for the windows update of sp, and the changes will be inherited into
> the function? Or do i need to edit the source code of rangeMapper to
> reflect the changes in sp.
>
> Thanks for the help
>
> Ben Weinstein
>
> On Sat, Dec 17, 2011 at 10:27 AM, Roger Bivand<Roger.Bivand at nhh.no>  wrote:
>
>> On Sat, 17 Dec 2011, Roger Bivand wrote:
>>
>>   On Fri, 16 Dec 2011, Agustin Lobo wrote:
>>>   Hi!
>>>> I've uploaded the file here:
>>>> https://sites.google.com/site/**filestemp2/home/world_adm0.zip<https://sites.google.com/site/filestemp2/home/world_adm0.zip>
>>>>
>>>> It was a popular file, but actually cannot find it in the diva server
>>>> any more
>>>> According to qgis, there are no coordinates beyond +/- 90 or +/-180
>>>>
>>>> Extents:
>>>> In layer spatial reference system units : xMin,yMin -180,-90 :
>>>> xMax,yMax 180,83.623
>>>> but readOGR() probably makes a more rigorous check.
>>>>
>>> Right. Thanks for access to the file. If I change the name of the *.prj
>>> file, I see:
>>>
>>>   wrld<- readOGR(".", "world_adm0")
>>>> print(bbox(wrld), digits=12)
>>>>
>>>             min            max
>>> x -180.000183105 180.0000000000
>>> y  -90.000000000  83.6230316162
>>>
>>> so it is going sufficiently far below -180 for the validity check at
>>> .Machine$double.eps ^ 0.25 (0.0001220703), but passes with a slightly
>>> slacker tolerance. I suggest providing a tolerance in an option in sp to
>>> resolve this. The error is primarily to stop users assigning a
>>> +proj=longlat to projected coordinates (yes, it does happen). I'll look to
>>> add an options mechanism to sp to handle both error/warning and tolerance
>>> for the power to .Machine$double.eps.
>>>
>> This is now committed to the rspatial R-forge project, module sp, revision
>> 1179. Now it is possible either to throw a warning rather than an error,
>> and/or to alter the tolerance; the error message now shows the exceeding
>> value(s):
>>
>>   library(rgdal)
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>>
>>> wrld1<- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Error in validityMethod(as(object, superClass)) :
>>   Geographical CRS given to non-conformant data: -180.000183105
>>
>>> set_ll_warn(TRUE)
>>>
>> [1] TRUE
>>
>>> wrld1<- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>> Warning message:
>> In validityMethod(as(object, superClass)) :
>>   Geographical CRS given to non-conformant data: -180.000183105
>>
>>> set_ll_warn(FALSE)
>>>
>> [1] FALSE
>>
>>> set_ll_TOL(0.2)
>>>
>> [1] 0.2
>>
>>> wrld1<- readOGR(".", "world_adm0")
>>>
>> OGR data source with driver: ESRI Shapefile
>> Source: ".", layer: "world_adm0"
>>
>> with 209 features and 3 fields
>> Feature type: wkbPolygon with 2 dimensions
>>
>>>
>> Please let me know if this helps,
>>
>> Roger
>>
>>
>>
>>> Had you looked at using the wrld_simpl dataset that is disributed with
>>> maptools:
>>>
>>> data(wrld_simpl)
>>>
>>> and joining countries with the codes included? It is a bit out od date in
>>> not having the Sudan split; it is about twice the object size of the file
>>> you are using, plotting somewhat more slowly:
>>>
>>>   object.size(wrld_simpl)
>>> 6349008 bytes
>>>
>>>> object.size(wrld)
>>>>
>>> 3250784 bytes
>>>
>>>> plot(wrld_simpl)
>>>> plot(wrld, border="red", add=TRUE)
>>>>
>>> The file simplifies sea ice in Antarctica, and discards many small
>>> islands, otherwise they match pretty well.
>>>
>>> Roger
>>>
>>>
>>>> Could it be possible that readOGR()  read the file with a warning
>>>> and print the offending coordinates?
>>>>
>>>> readOGR() works fine with this alternative file:
>>>> http://www.gadm.org/data/gadm_**v1_lev0_shp.zip<http://www.gadm.org/data/gadm_v1_lev0_shp.zip>
>>>>
>>>> but it's huge and cannot actually work with it and have not found a
>>>> third alternative.
>>>>
>>>> Thanks,
>>>>
>>>> Agus
>>>>
>>>> 2011/12/16 Roger Bivand<Roger.Bivand at nhh.no>:
>>>>
>>>>> On Fri, 16 Dec 2011, Robert J. Hijmans wrote:
>>>>>
>>>>>   Agus,
>>>>>> This is likely because there are some longitude coordinates that are<
>>>>>> -180 or>  180.
>>>>>> OGR does not complain, but, as these are lon/lat data, sp runs
>>>>>> sp:::.ll_sanity  and throws an error.
>>>>>>
>>>>>> I think it would be preferable if sp gave a warning rather than an
>>>>>> error,
>>>>>> at least when longitudes are within a reasonable number (-360 -- 360
>>>>>> ?). I
>>>>>> think that a longitude of, e.g. 181 is perfectly interpretable, and
>>>>>> sometimes useful. For example to plot Russia, or Fiji in one piece in
>>>>>> lon/lat coordinates.
>>>>>>
>>>>>
>>>>> As Agus knows, unless the file is made available, help will likely not
>>>>> be
>>>>> forthcoming. Without a traceback(), we don't know where the error is
>>>>> being
>>>>> thrown. The fact that an out of domain number is interpretable in one
>>>>> context doesn't necessarily make it acceptable in others, I believe. We
>>>>> could go to an option setting, which would slacken the error to a
>>>>> warning if
>>>>> set. Opinions?
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>
>>>>>> Robert
>>>>>>
>>>>>>
>>>>>> On Fri, Dec 16, 2011 at 4:24 AM, Agustin Lobo<alobolistas at gmail.com>
>>>>>> wrote:
>>>>>>
>>>>>>   Hi!
>>>>>>> I' trying to read this shapefile that is just in lon,lat WGS84
>>>>>>>
>>>>>>>> ogrInfo(dsn=datad,layer="**world_adm0v2")
>>>>>>>>
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/**ExIE2011DATA/ExFireBorneoDATA/**
>>>>>>> world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> Driver: ESRI Shapefile number of rows 209
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> +proj=longlat +datum=WGS84 +no_defs
>>>>>>> Number of fields: 3
>>>>>>>       name type length typeName
>>>>>>> 1      NAME    4     40   String
>>>>>>> 2 GMI_CNTRY    4      3   String
>>>>>>> 3    REGION    4     25   String
>>>>>>>
>>>>>>> but I get:
>>>>>>>
>>>>>>>> world<-readOGR(dsn=datad,layer="**world_adm0v2")
>>>>>>>>
>>>>>>> OGR data source with driver: ESRI Shapefile
>>>>>>> Source:
>>>>>>> "/media/Iomega_HDD/JACOB/**ExIE2011DATA/ExFireBorneoDATA/**
>>>>>>> world_adm0",
>>>>>>> layer: "world_adm0v2"
>>>>>>> with 209 features and 3 fields
>>>>>>> Feature type: wkbPolygon with 2 dimensions
>>>>>>> Error in validityMethod(as(object, superClass)) :
>>>>>>>   Geographical CRS given to non-conformant data
>>>>>>> I've tried
>>>>>>>
>>>>>>>> world
>>>>>>>>
>>>>>>>
>>>>>>> <-readOGR(dsn=datad,layer="**world_adm0v2",p4s=CRSargs(CRS(**
>>>>>>> "+init=epsg:4326")))
>>>>>>> but get the same result
>>>>>>>
>>>>>>> can't this CRS (epsg:4326)
>>>>>>> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>>>> be read by readOGR() ?
>>>>>>>
>>>>>>> Thanks
>>>>>>> Agus
>>>>>>>
>>>>>>> ______________________________**_________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>
>>>>>>>
>>>>>>         [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________**_________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>
>>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>>
>>>>> ______________________________**_________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>
>>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>

-- 
+-----------------------------------------------+
| Mihai Valcu                                   |
| Max Planck Institute for Ornithology          |
| Behavioural Ecology and Evolutionary Genetics |
| Eberhard-Gwinner-Stra?e 7                     |
| D-82319 Starnberg (Seewiesen)                 |
| Phone: +49 (0)8157-932-343                    |
| Fax:   +49-(0)8157-932-400                    |
| http://orn.mpg.de/mitarbeiter/valcu.html      |
+-----------------------------------------------+


From rusers.sh at gmail.com  Tue Dec 20 14:56:32 2011
From: rusers.sh at gmail.com (rusers.sh)
Date: Tue, 20 Dec 2011 21:56:32 +0800
Subject: [R-sig-Geo] obtain coordinates in google earth
Message-ID: <CAKj+dtXQPdziDN1O6td+68yQGNUvfns0frGHrTo7ptHKEoh+9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/035e6bd6/attachment.pl>

From juantomas.sayago at gmail.com  Tue Dec 20 15:13:40 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Tue, 20 Dec 2011 09:13:40 -0500
Subject: [R-sig-Geo] obtain coordinates in google earth
In-Reply-To: <CAKj+dtXQPdziDN1O6td+68yQGNUvfns0frGHrTo7ptHKEoh+9A@mail.gmail.com>
References: <CAKj+dtXQPdziDN1O6td+68yQGNUvfns0frGHrTo7ptHKEoh+9A@mail.gmail.com>
Message-ID: <CAEOXpNAySZ+MsE4aaPWKG3gym4ypfpj+n2_-5wObBZY6Dpcisw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/344a715d/attachment.pl>

From dieter.vanderelst at gmail.com  Tue Dec 20 16:43:50 2011
From: dieter.vanderelst at gmail.com (Dieter Vanderelst)
Date: Tue, 20 Dec 2011 16:43:50 +0100
Subject: [R-sig-Geo] Finding out in which polygon a point lies
Message-ID: <CAATY4m4hbWCfuYjg=r0RzrD7Z3OJFuU7gQdP51JhU8WXPqDyOg@mail.gmail.com>

Dear List,

I've read in a shapefile using the readShapePoly {maptools} function.
This shapefile represents Angola and has different polygons for the
different regions of the country. I also have a set of coordinates
(lat/long). Now want to do two things:

1 - I want to plot the points on the map. Given that both my points
and the shapefile use the same coordinate reference system
(latitude/longitude) and theWGS84 datum, I think I can just use the
function plot(lon,lat). Please correct me I if I'm wrong here.

2 - The second problem is a bit harder. I want to color the polygons
which contain one or more points. How can I check in which polygon
each of the points lie. I found a partial explanation online on how to
do this with the sp package (see
https://stat.ethz.ch/pipermail/r-help/2009-February/187435.html).
However, I haven't been able to reconstruct the method suggested in
this post.

Any thoughts on how to select polygons based on coordinates using
maptools would be most welcome.

Regards,
Dieter


From tom.gottfried at tum.de  Tue Dec 20 17:37:55 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Tue, 20 Dec 2011 17:37:55 +0100
Subject: [R-sig-Geo] Finding out in which polygon a point lies
In-Reply-To: <CAATY4m4hbWCfuYjg=r0RzrD7Z3OJFuU7gQdP51JhU8WXPqDyOg@mail.gmail.com>
References: <CAATY4m4hbWCfuYjg=r0RzrD7Z3OJFuU7gQdP51JhU8WXPqDyOg@mail.gmail.com>
Message-ID: <4EF0B9E3.9010601@tum.de>

Hi,

Am 20.12.2011 16:43, schrieb Dieter Vanderelst:
> Dear List,
>
> I've read in a shapefile using the readShapePoly {maptools} function.
> This shapefile represents Angola and has different polygons for the
> different regions of the country. I also have a set of coordinates
> (lat/long). Now want to do two things:
>
> 1 - I want to plot the points on the map. Given that both my points
> and the shapefile use the same coordinate reference system
> (latitude/longitude) and theWGS84 datum, I think I can just use the
> function plot(lon,lat). Please correct me I if I'm wrong here.

Use spplot() for the polygons and the sp.layout argument for the points. 
See ?spplot.

> 2 - The second problem is a bit harder. I want to color the polygons
> which contain one or more points. How can I check in which polygon
> each of the points lie. I found a partial explanation online on how to
> do this with the sp package (see
> https://stat.ethz.ch/pipermail/r-help/2009-February/187435.html).
> However, I haven't been able to reconstruct the method suggested in
> this post.

What did you try already? Some lines of code would be helpful. In any 
case, what you can use is over() from the sp package (overlay is 
deprecated).

regards,
Tom

> Any thoughts on how to select polygons based on coordinates using
> maptools would be most welcome.
>
> Regards,
> Dieter
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From hevals at gmail.com  Tue Dec 20 19:47:51 2011
From: hevals at gmail.com (=?ISO-8859-1?Q?Henri_Vall=E8s?=)
Date: Tue, 20 Dec 2011 14:47:51 -0400
Subject: [R-sig-Geo] removing spatial autocorrelation with ME function
 and subsequently testing with lm.morantest
In-Reply-To: <alpine.LRH.2.00.1112200930560.1427@reclus.nhh.no>
References: <CAGpXgKuwgPeFgO5K866OV5jgK8GtvmPBNK=8P9nQ7RYiahnJOA@mail.gmail.com>
	<alpine.LRH.2.00.1112200930560.1427@reclus.nhh.no>
Message-ID: <CAGpXgKt7xtiTX--0NvdPogwTHMk+wcK1bEtyZiZgv7f=3RjS1g@mail.gmail.com>

Thank you. This helps.


On Tue, Dec 20, 2011 at 4:36 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 19 Dec 2011, Henri Vall?s wrote:
>
>> Hi,
>>
>> I am hoping somebody will be able to assist me.
>>
>> I am using the "ME" function of the "spdep" package to select a suite
>> of eigenvectors that successfully removes any significant spatial
>> autocorrelation (at a nominal level of 0.05) from my dependent
>> variable (density, "den") given a spatial weighting matrix
>> (listwdist).
>
>
> The choice of alpha=0.05 is very conservative, and could well be larger.
> Your results are down to your data:
>
> library(spdep)
> example(columbus)
> lagcol <- SpatialFiltering(CRIME ~ 1, data=columbus, nb=col.gal.nb,
> ?style="W", alpha=0.05, verbose=TRUE)
> lmlag <- lm(CRIME ~ fitted(lagcol), data=columbus)
> lm.morantest(lmlag, nb2listw(col.gal.nb))
> lagcol1 <- ME(CRIME ~ 1, data=columbus, family="gaussian",
> ?listw=nb2listw(col.gal.nb), alpha=0.05, stdev=TRUE, verbose=TRUE)
> lmlag1 <- lm(CRIME ~ fitted(lagcol1), data=columbus)
> lm.morantest(lmlag1, nb2listw(col.gal.nb))
>
> which all show lm.morantest() at approximately the target alpha. Note that
> ME() with the default Gaussian family is the same as SpatialFiltering() but
> using a bootstrap test on the regression residuals (an approximation),
> rather than the analytical test, so SpatialFiltering() would normally be
> preferred. There is something in your data that is driving this. Please try
> to reproduce your problem with a data set shipped with spdep or maptools.
> Your null model is also asking for trouble, as most of the observed
> autocorrelation in dens is caused by missing covariates.
>
> Hope this helps,
>
> Roger
>
>
>>
>> The code and output:
>>
>>> ME_model=ME(den~1,listw=listwdist,verbose=TRUE,nsim=999,alpha=0.05)
>>
>>
>> eV[,1], I: 0.2267349 ZI: NA, pr(ZI): 0.001
>> eV[,8], I: 0.1727207 ZI: NA, pr(ZI): 0.001
>> eV[,3], I: 0.1490887 ZI: NA, pr(ZI): 0.001
>> eV[,5], I: 0.1260945 ZI: NA, pr(ZI): 0.001
>> eV[,2], I: 0.1042690 ZI: NA, pr(ZI): 0.001
>> eV[,15], I: 0.08287102 ZI: NA, pr(ZI): 0.001
>> eV[,10], I: 0.06740037 ZI: NA, pr(ZI): 0.001
>> eV[,7], I: 0.0513471 ZI: NA, pr(ZI): 0.001
>> eV[,21], I: 0.03391224 ZI: NA, pr(ZI): 0.018
>> eV[,13], I: 0.01831637 ZI: NA, pr(ZI): 0.073
>>
>>
>> However, when I use the "lm.morantest" function to double-check
>> whether there is any significant autocorrelation in the residuals,
>> using "den" as the dependent variable and the selected eigenvectors as
>> predictors (ME_model$vectors), the test indicates that there still is
>> considerable autocorrelation left in the residuals:
>>
>> model=lm(den~ME_model$vectors)
>>
>>> lm.morantest(model,listwdist)
>>
>>
>> ? ? ? Global Moran's I for regression residuals
>>
>> data:
>> model: lm(formula = den ~ ME_model$vectors)
>> weights: listwdist
>>
>> Moran I statistic standard deviate = 5.2239, p-value = 8.761e-08
>> alternative hypothesis: greater
>> sample estimates:
>> Observed Moran's I ? ? ? ?Expectation ? ? ? ? ? Variance
>> ? ? 1.831637e-02 ? ? ?-2.453698e-02 ? ? ? 6.729546e-05
>>
>>
>> In contrast, I get a different result (but one that would be more
>> consistent with the outcome of the ME function) when I extract the
>> residuals from the model above and run a "moran.test" on those
>> residuals, although I have just found out that using the residuals
>> this way appears not to be valid:
>>
>>> moran.test(residuals(model),listwdist)
>>
>>
>> Moran's I test under randomisation, .
>> data: ?residuals(model)
>> weights: listwdist
>> Moran I statistic standard deviate = 1.5546, p-value = 0.06002
>> alternative hypothesis: greater
>> sample estimates:
>> Moran I statistic ? ? ? Expectation ? ? ? ? ?Variance
>> ? ?0.0183163706 ? ? -0.0024154589 ? ? ?0.0001778361
>>
>>
>> I would very much appreciate if anyone could help me understand these
>> discrepancies between methods or what is it that I am doing wrong?
>>
>> Regards,
>>
>> Henri Valles
>> Lecturer in Ecology
>> Department of Biological and Chemical Sciences
>> University of the West Indies, Cave Hill Campus, Barbados, BB11000
>> tel (Direct): (246) 417-4328
>> E-mail: hevals at gmail.com
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From hevals at gmail.com  Tue Dec 20 21:35:52 2011
From: hevals at gmail.com (=?ISO-8859-1?Q?Henri_Vall=E8s?=)
Date: Tue, 20 Dec 2011 16:35:52 -0400
Subject: [R-sig-Geo] removing spatial autocorrelation with ME function
 and subsequently testing with lm.morantest
In-Reply-To: <alpine.LRH.2.00.1112200930560.1427@reclus.nhh.no>
References: <CAGpXgKuwgPeFgO5K866OV5jgK8GtvmPBNK=8P9nQ7RYiahnJOA@mail.gmail.com>
	<alpine.LRH.2.00.1112200930560.1427@reclus.nhh.no>
Message-ID: <CAGpXgKvbPJxmt+Z_Fz08n2nnmYDrik1xoh-Zg+Di291CrYtYeg@mail.gmail.com>

Dear list,

Would it be appropriate to use the SpatialFiltering function of spdep
to model the spatial structure of a single variable of interest? Here,
my final objective is to carry out a variance partitioning separating
environmental "effects" from spatial "effects" and assessing the
variance in the response variable that is shared by both the space and
the environment. In this context, what I have often seen in the
literature is the use of forward selection of Moran Eigenvector Maps
to model the spatial component of the response variable, which (I
understand) is based on a different selection criterion of MEMs from
that used by SpatialFiltering.

Henri

On Tue, Dec 20, 2011 at 4:36 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 19 Dec 2011, Henri Vall?s wrote:
>
>> Hi,
>>
>> I am hoping somebody will be able to assist me.
>>
>> I am using the "ME" function of the "spdep" package to select a suite
>> of eigenvectors that successfully removes any significant spatial
>> autocorrelation (at a nominal level of 0.05) from my dependent
>> variable (density, "den") given a spatial weighting matrix
>> (listwdist).
>
>
> The choice of alpha=0.05 is very conservative, and could well be larger.
> Your results are down to your data:
>
> library(spdep)
> example(columbus)
> lagcol <- SpatialFiltering(CRIME ~ 1, data=columbus, nb=col.gal.nb,
> ?style="W", alpha=0.05, verbose=TRUE)
> lmlag <- lm(CRIME ~ fitted(lagcol), data=columbus)
> lm.morantest(lmlag, nb2listw(col.gal.nb))
> lagcol1 <- ME(CRIME ~ 1, data=columbus, family="gaussian",
> ?listw=nb2listw(col.gal.nb), alpha=0.05, stdev=TRUE, verbose=TRUE)
> lmlag1 <- lm(CRIME ~ fitted(lagcol1), data=columbus)
> lm.morantest(lmlag1, nb2listw(col.gal.nb))
>
> which all show lm.morantest() at approximately the target alpha. Note that
> ME() with the default Gaussian family is the same as SpatialFiltering() but
> using a bootstrap test on the regression residuals (an approximation),
> rather than the analytical test, so SpatialFiltering() would normally be
> preferred. There is something in your data that is driving this. Please try
> to reproduce your problem with a data set shipped with spdep or maptools.
> Your null model is also asking for trouble, as most of the observed
> autocorrelation in dens is caused by missing covariates.
>
> Hope this helps,
>
> Roger
>
>
>>
>> The code and output:
>>
>>> ME_model=ME(den~1,listw=listwdist,verbose=TRUE,nsim=999,alpha=0.05)
>>
>>
>> eV[,1], I: 0.2267349 ZI: NA, pr(ZI): 0.001
>> eV[,8], I: 0.1727207 ZI: NA, pr(ZI): 0.001
>> eV[,3], I: 0.1490887 ZI: NA, pr(ZI): 0.001
>> eV[,5], I: 0.1260945 ZI: NA, pr(ZI): 0.001
>> eV[,2], I: 0.1042690 ZI: NA, pr(ZI): 0.001
>> eV[,15], I: 0.08287102 ZI: NA, pr(ZI): 0.001
>> eV[,10], I: 0.06740037 ZI: NA, pr(ZI): 0.001
>> eV[,7], I: 0.0513471 ZI: NA, pr(ZI): 0.001
>> eV[,21], I: 0.03391224 ZI: NA, pr(ZI): 0.018
>> eV[,13], I: 0.01831637 ZI: NA, pr(ZI): 0.073
>>
>>
>> However, when I use the "lm.morantest" function to double-check
>> whether there is any significant autocorrelation in the residuals,
>> using "den" as the dependent variable and the selected eigenvectors as
>> predictors (ME_model$vectors), the test indicates that there still is
>> considerable autocorrelation left in the residuals:
>>
>> model=lm(den~ME_model$vectors)
>>
>>> lm.morantest(model,listwdist)
>>
>>
>> ? ? ? Global Moran's I for regression residuals
>>
>> data:
>> model: lm(formula = den ~ ME_model$vectors)
>> weights: listwdist
>>
>> Moran I statistic standard deviate = 5.2239, p-value = 8.761e-08
>> alternative hypothesis: greater
>> sample estimates:
>> Observed Moran's I ? ? ? ?Expectation ? ? ? ? ? Variance
>> ? ? 1.831637e-02 ? ? ?-2.453698e-02 ? ? ? 6.729546e-05
>>
>>
>> In contrast, I get a different result (but one that would be more
>> consistent with the outcome of the ME function) when I extract the
>> residuals from the model above and run a "moran.test" on those
>> residuals, although I have just found out that using the residuals
>> this way appears not to be valid:
>>
>>> moran.test(residuals(model),listwdist)
>>
>>
>> Moran's I test under randomisation, .
>> data: ?residuals(model)
>> weights: listwdist
>> Moran I statistic standard deviate = 1.5546, p-value = 0.06002
>> alternative hypothesis: greater
>> sample estimates:
>> Moran I statistic ? ? ? Expectation ? ? ? ? ?Variance
>> ? ?0.0183163706 ? ? -0.0024154589 ? ? ?0.0001778361
>>
>>
>> I would very much appreciate if anyone could help me understand these
>> discrepancies between methods or what is it that I am doing wrong?
>>
>> Regards,
>>
>> Henri Valles
>> Lecturer in Ecology
>> Department of Biological and Chemical Sciences
>> University of the West Indies, Cave Hill Campus, Barbados, BB11000
>> tel (Direct): (246) 417-4328
>> E-mail: hevals at gmail.com
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From dimefthim at gmail.com  Tue Dec 20 22:27:47 2011
From: dimefthim at gmail.com (Dimitrios Efthymiou)
Date: Tue, 20 Dec 2011 23:27:47 +0200
Subject: [R-sig-Geo] Reference for LU method
Message-ID: <CAFaxxcsuw305As5xRLWH9L5PSXtyCkD_84W-O2Q=iDkNLuYdaA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/68591a53/attachment.pl>

From jjcabrera20 at yahoo.com.mx  Tue Dec 20 23:56:54 2011
From: jjcabrera20 at yahoo.com.mx (Jorge Cabrera)
Date: Tue, 20 Dec 2011 14:56:54 -0800
Subject: [R-sig-Geo] Looping though pixels in a SpatialGridDataFrame
Message-ID: <1324421814.85270.YahooMailNeo@web160604.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/7ff61aa6/attachment.pl>

From jjcabrera20 at yahoo.com.mx  Wed Dec 21 00:00:03 2011
From: jjcabrera20 at yahoo.com.mx (Jorge Cabrera)
Date: Tue, 20 Dec 2011 15:00:03 -0800 (PST)
Subject: [R-sig-Geo] Looping though pixels in a SpatialGridDataFrame
Message-ID: <1324422003.7287.YahooMailNeo@web160606.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/35ee86e2/attachment.pl>

From jjcabrera20 at yahoo.com.mx  Wed Dec 21 01:01:51 2011
From: jjcabrera20 at yahoo.com.mx (Jorge Cabrera)
Date: Tue, 20 Dec 2011 16:01:51 -0800 (PST)
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
Message-ID: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111220/6f132ed6/attachment.pl>

From agus.camacho at gmail.com  Wed Dec 21 07:35:40 2011
From: agus.camacho at gmail.com (agus)
Date: Tue, 20 Dec 2011 22:35:40 -0800 (PST)
Subject: [R-sig-Geo] xtracting coordinates of model boundaries
Message-ID: <1324449340143-7114268.post@n2.nabble.com>

Hello all,

I am trying to calculate the exact area in km2 for a given maxent model of
distribution of a species, at a given probability of occurrence.
 
How could be the best way to do that?

I tried     area (model) but it seems to give me the number of pixels of the
square generated by the maximum values of long/lat.

I also tried to use:
pred_area=length(a at data@values[a at data@values>quantile(a at data@values,c(0.95))])

To find the number of raster cells that have a given probability of finding
the species, and then multiplying it by the resolution. However, I think
this does not correct for the spatial diferences between raster cell sizes
along latitudinal gradients.

Finally, given a set of coordinates x, I think I might use:

coords=x
coordinates(coords) <- ~Longitude+Latitude
projection(coords) <- " +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
+no_defs"
r = raster(coords)# avoiding South Pole; bugs there.
p = rasterToPolygons(r)# or a sp coerce method from the spgdf
dist.extent=(areaPolygon(p)/10^6)# area in km2

to calculate the extent of distribution. 

However, help tells that polygons should not self intersect for
areaPolygon() to work well. Then, how to avoid intersecting polygons from a
maxent model or just a set of occurences?

In other words:
How to extract coordinates of the boundaries of a distributional model, at a
given probability of occurrence, and then calculate the area?

Any hint/paper/package documentation you could recommend would be welcome.


Thanks a lot!
Agus


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/xtracting-coordinates-of-model-boundaries-tp7114268p7114268.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Dec 21 08:34:46 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Dec 2011 08:34:46 +0100 (CET)
Subject: [R-sig-Geo] Reference for LU method
In-Reply-To: <CAFaxxcsuw305As5xRLWH9L5PSXtyCkD_84W-O2Q=iDkNLuYdaA@mail.gmail.com>
References: <CAFaxxcsuw305As5xRLWH9L5PSXtyCkD_84W-O2Q=iDkNLuYdaA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112210828410.7179@reclus.nhh.no>

On Tue, 20 Dec 2011, Dimitrios Efthymiou wrote:

> Hello Roger,
>
> What is the appropriate paper (to use as reference), that describes the LU
> method used by the SAR models in 'spdep' package?


@article{pace+barry:97a,
Author = {Pace, RK and Barry, RP},
Title = {{Fast CARs}},
Journal = {{Journal of Statistical Computation and Simulation}},
Year = {{1997}},
Volume = {{59}},
Number = {{2}},
Pages = {{123-145}}
}

does mention LU in a footnote. Other papers in the same year by the same 
authors step around mentioning the choice of LU or Cholesky decomposition. 
Citing the standard work:

@book{lesage+pace:09,
author = {{LeSage}, JP and Pace, RK},
title = {Introduction to Spatial Econometrics},
year = {2009},
publisher = {CRC Press},
address = {Boca Raton, FL}
}

is always a good idea.

Roger

>
> Thanks in advance for your help,
> Dimitris
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Wed Dec 21 09:01:24 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 21 Dec 2011 00:01:24 -0800
Subject: [R-sig-Geo] xtracting coordinates of model boundaries
In-Reply-To: <1324449340143-7114268.post@n2.nabble.com>
References: <1324449340143-7114268.post@n2.nabble.com>
Message-ID: <CANtt_hy9+GW0DpKK4NHU+ysvknZbC54a0e88g=CFV=RC+4qE-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111221/ae91261c/attachment.pl>

From alobolistas at gmail.com  Wed Dec 21 11:44:52 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 21 Dec 2011 11:44:52 +0100
Subject: [R-sig-Geo] vignettes for rgeos?
Message-ID: <CAG4NReL3D+DUF_PU3BHGydDvtjx9p3Y_UmQ8ifGe7_s=jttpSQ@mail.gmail.com>

Hi!
Are there vignettes or a general description of package rgeos?
I've browsed the project in rForge and http://trac.osgeo.org/geos/ but
can not find a general
description. It's hard to get the general view from the individual
help page of each function.
Thanks
Agus


From Roger.Bivand at nhh.no  Wed Dec 21 11:54:50 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Dec 2011 11:54:50 +0100 (CET)
Subject: [R-sig-Geo] vignettes for rgeos?
In-Reply-To: <CAG4NReL3D+DUF_PU3BHGydDvtjx9p3Y_UmQ8ifGe7_s=jttpSQ@mail.gmail.com>
References: <CAG4NReL3D+DUF_PU3BHGydDvtjx9p3Y_UmQ8ifGe7_s=jttpSQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112211149120.7179@reclus.nhh.no>

On Wed, 21 Dec 2011, Agustin Lobo wrote:

> Hi!
> Are there vignettes or a general description of package rgeos?
> I've browsed the project in rForge and http://trac.osgeo.org/geos/ but
> can not find a general
> description. It's hard to get the general view from the individual
> help page of each function.

No, no vignette available, the best available guide at the root is from 
JTS:

http://www.vividsolutions.com/jts/bin/JTS%20Technical%20Specs.pdf

which was used in writing rgeos. This is on TODO lists, but not at the 
top, sorry; contributions gratefully received!

Roger

> Thanks
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From dimefthim at gmail.com  Wed Dec 21 13:36:08 2011
From: dimefthim at gmail.com (Dimitrios Efthymiou)
Date: Wed, 21 Dec 2011 14:36:08 +0200
Subject: [R-sig-Geo] Question about the results of mixed lagsarlm
Message-ID: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111221/8d4e922a/attachment.pl>

From Roger.Bivand at nhh.no  Wed Dec 21 13:48:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Dec 2011 13:48:23 +0100 (CET)
Subject: [R-sig-Geo] Question about the results of mixed lagsarlm
In-Reply-To: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>
References: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112211341240.7179@reclus.nhh.no>

On Wed, 21 Dec 2011, Dimitrios Efthymiou wrote:

> Hi all,
>
> I'm using the 'spdep' package of R, in a server with Ubuntu.
> I'm trying to estimate a lagsarlm "mixed" model using 8.000 observations of
> house prices.
>
> until now, I can estimate the errorraslm, lagsarlm (lagged) and sacsarlm
> without problem, but when I try to estimate the mixed lagsarlm, NAs appear
> at the Std. Error, z-value and p columns of many variables.

This means that you have issues in the close correlations between the 
variables and lagged variables. If you use a trs= argument of MC traces, 
the finite difference estimate of the Hessian will be augmented as shown 
in LeSage & Pace (2009), and as the help page for lagsarlm says, the 
problem may go away. You need the series of traces of powers of W anyway 
for impacts(), so no extra effort is required. If the coefficient itself 
is dropped, a variable and its lag are aliased, but this isn't your case 
here.

Hope this helps,

Roger

>
> Does anyone know what causes this?
>
> I'm using k-nearest neighbours = 12, the S-coding variance
> - stabilising, and the LU method  (I concluded to these numbers and methods
> after experimentation in the other models).
>
>
> Characteristics of weights list object:
> Neighbour list object:
> Number of regions: 8066
> Number of nonzero links: 185518
> Percentage nonzero weights: 0.2851475
> Average number of links: 23
> Non-symmetric neighbours list
>
> Weights style: S
> Weights constants summary:
>     n       nn   S0       S1       S2
> S 8066 65060356 8066 630.5066 32982.99
>
>
>
>
>> sessionInfo()R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] splines   grid      stats     graphics  grDevices utils     datasets
> [8] methods   base
>
> other attached packages:
> [1] ape_2.8             ade4_1.4-17         car_2.0-11
> [4] survival_2.36-10    nnet_7.3-1          gstat_1.0-10
> [7] spacetime_0.5-7     xts_0.8-2           zoo_1.7-6
> [10] rasterVis_0.10-7    hexbin_1.26.0       latticeExtra_0.6-19
> [13] RColorBrewer_1.0-5  RANN_2.1.3          spdep_0.5-43
> [16] coda_0.14-6         nlme_3.1-102        MASS_7.3-16
> [19] Matrix_1.0-2        boot_1.3-3          ggplot2_0.8.9
> [22] proto_0.3-9.2       reshape_0.8.4       plyr_1.6
> [25] spgwr_0.6-13        spatstat_1.25-0     deldir_0.0-16
> [28] mgcv_1.7-12         rgdal_0.7-5         maptools_0.8-10
> [31] lattice_0.20-0      foreign_0.8-48      raster_1.9-55
> [34] sp_0.9-91
>
> loaded via a namespace (and not attached):
> [1] gee_4.13-17  tools_2.14.0
>
>
> Many thanks in advance for your help.
>
> Dimitris
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Dec 21 14:05:44 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 21 Dec 2011 14:05:44 +0100
Subject: [R-sig-Geo] zlim in spplot() ?
Message-ID: <CAG4NReKS6xd_-1vRjjLeL7CU5tfmy6hTyV7c3paEG-oFkhXbZw@mail.gmail.com>

Hi!
I have to plot data for different years in individual plots and want
to keep the same range. I've tried
 spplot(worldowlstot2,z="X2005",cuts=3,xlim=c(-180,180),ylim=c(20,90),zlim=c(0,20))

but it seems that zlim is ignored (no error message, but no effect,
the bar is from 0 to 8 ).

Is there any way to set the range for the color display?

Thanks

Agus


From edzer.pebesma at uni-muenster.de  Wed Dec 21 15:05:57 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Dec 2011 15:05:57 +0100
Subject: [R-sig-Geo] zlim in spplot() ?
In-Reply-To: <CAG4NReKS6xd_-1vRjjLeL7CU5tfmy6hTyV7c3paEG-oFkhXbZw@mail.gmail.com>
References: <CAG4NReKS6xd_-1vRjjLeL7CU5tfmy6hTyV7c3paEG-oFkhXbZw@mail.gmail.com>
Message-ID: <4EF1E7C5.6080105@uni-muenster.de>



On 12/21/2011 02:05 PM, Agustin Lobo wrote:
> Hi!
> I have to plot data for different years in individual plots and want
> to keep the same range. I've tried
>  spplot(worldowlstot2,z="X2005",cuts=3,xlim=c(-180,180),ylim=c(20,90),zlim=c(0,20))
> 
> but it seems that zlim is ignored (no error message, but no effect,
> the bar is from 0 to 8 ).
> 
> Is there any way to set the range for the color display?

library(lattice)
?levelplot

try the cuts argument (zlim is sth that image() is more likely to obey).

> 
> Thanks
> 
> Agus
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From agus.camacho at gmail.com  Thu Dec 22 05:18:08 2011
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 22 Dec 2011 14:48:08 +1030
Subject: [R-sig-Geo] xtracting coordinates of model boundaries
In-Reply-To: <CANtt_hy9+GW0DpKK4NHU+ysvknZbC54a0e88g=CFV=RC+4qE-Q@mail.gmail.com>
References: <1324449340143-7114268.post@n2.nabble.com>
	<CANtt_hy9+GW0DpKK4NHU+ysvknZbC54a0e88g=CFV=RC+4qE-Q@mail.gmail.com>
Message-ID: <CALsJ7pTGFseo9W8zhcF7P0iWAR0_CxfDyq0u91feY=SgkSb=Eg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111222/5778c6f2/attachment.pl>

From janverbesselt at gmail.com  Thu Dec 22 08:59:07 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Thu, 22 Dec 2011 08:59:07 +0100
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
In-Reply-To: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
References: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
Message-ID: <B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>

Hi Jorge,

As for flood modelling; maybe look at the GRASS or QGIS mailing lists. And the following posts:
http://gis.stackexchange.com/questions/5907/flood-modelling-insights
http://www.cs.duke.edu/geo%2a/terraflow/r.terraflow.html
Also;
http://hub.qgis.org/wiki/quantum-gis/Hydrology_&_Hydraulic_modelling

Hope this helps,
Jan


On 21/12/2011, at 1:01 AM, Jorge Cabrera wrote:

> Hello people in the list,
> 
> I am new to R and I am trying to simulate a simple flood model using a digital elevation model and water height data.
> The idea is to find the neighbor pixels of a river and assign to them the values of the DEM, comparing them with the water height data, and were it exceeds the height, this pixel is starting to get flooded, the flood continues to its neighbors taking into account the height from the DEM. These happens until the water height is again below the DEM.
> I need some idea to start, and mainly how to loop inside a SpatialGridDataFrame or SpatialPixelDataFrame and be able to compare between different SpatialGridDataFrames in my case DEM and Water Height.
> 
> I hope the explanation is clear
> 
> Thanks in advance for your help
> 
> Best,
> 
> Jorge
> PD: I am a windows user R version 2.14
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dimefthim at gmail.com  Thu Dec 22 12:00:50 2011
From: dimefthim at gmail.com (Dimitrios Efthymiou)
Date: Thu, 22 Dec 2011 13:00:50 +0200
Subject: [R-sig-Geo] Question about the results of mixed lagsarlm
In-Reply-To: <alpine.LRH.2.00.1112211341240.7179@reclus.nhh.no>
References: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>
	<alpine.LRH.2.00.1112211341240.7179@reclus.nhh.no>
Message-ID: <CAFaxxctUipJr+ThvRH-KOMCdp_T4MTCkBo_m+ZF0ar_bvTsZ3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111222/346fbe9d/attachment.pl>

From Roger.Bivand at nhh.no  Thu Dec 22 13:21:54 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 Dec 2011 13:21:54 +0100 (CET)
Subject: [R-sig-Geo] Question about the results of mixed lagsarlm
In-Reply-To: <CAFaxxctUipJr+ThvRH-KOMCdp_T4MTCkBo_m+ZF0ar_bvTsZ3A@mail.gmail.com>
References: <CAFaxxcu48SfVw0j+5wDgEvmvGgPh+kGfDP6PihmYsyk5Wg0=Fg@mail.gmail.com>
	<alpine.LRH.2.00.1112211341240.7179@reclus.nhh.no>
	<CAFaxxctUipJr+ThvRH-KOMCdp_T4MTCkBo_m+ZF0ar_bvTsZ3A@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1112221317150.11762@reclus.nhh.no>

On Thu, 22 Dec 2011, Dimitrios Efthymiou wrote:

> Hi Roger,
>
> thanks for your help.
>
> Now I get a result, but many variables that are significant at the error
> and lag models, are not significant here.
> In addition, few variables have statistically significant direct impact,
> others indirect and others total.
>
> e.g.
>
>
> Simulated z-values:
>                                 Direct    Indirect       Total
>
>
> ...
> log(sqm)                   134.33514612  6.95584281 27.94811234
> parking                      9.01409655  0.51593572  1.58416761
> chimney                      4.20407856  1.15585250  1.67326910
> auto_heat                    5.37231195  0.66981923  1.30766715
> klima                        4.75291342  2.42475203  2.99642118
> dist_cbd                     1.86144465 -2.04747304 -1.08141630
> metro                       -0.29541702  2.75180894  3.47650020
>
>
> ...
>
>
> This question does not have to do with the package's functions, but I would
> appreciate any help because I'm not totally sure how to explain these
> results.

Please refer to the advice given by J. Paul Elhorst on the openspace list:

http://groups.google.com/group/openspace-list/browse_thread/thread/9381788c8f5c5352

(click on: Show quoted text)

In addition, if you look at the summary output for your error model with 
Hausman=TRUE, you'll see whether an error model is acceptable if the 
Common Factor LR test indicates error rather than spatial Durbin. The 
Hausman test is described in LeSage & Pace 2009.

Hope this helps,

Roger


>
> Many thanks in advance for your help.
>
> Dimitris
>
> On 21 December 2011 14:48, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 21 Dec 2011, Dimitrios Efthymiou wrote:
>>
>>  Hi all,
>>>
>>> I'm using the 'spdep' package of R, in a server with Ubuntu.
>>> I'm trying to estimate a lagsarlm "mixed" model using 8.000 observations
>>> of
>>> house prices.
>>>
>>> until now, I can estimate the errorraslm, lagsarlm (lagged) and sacsarlm
>>> without problem, but when I try to estimate the mixed lagsarlm, NAs appear
>>> at the Std. Error, z-value and p columns of many variables.
>>>
>>
>> This means that you have issues in the close correlations between the
>> variables and lagged variables. If you use a trs= argument of MC traces,
>> the finite difference estimate of the Hessian will be augmented as shown in
>> LeSage & Pace (2009), and as the help page for lagsarlm says, the problem
>> may go away. You need the series of traces of powers of W anyway for
>> impacts(), so no extra effort is required. If the coefficient itself is
>> dropped, a variable and its lag are aliased, but this isn't your case here.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> Does anyone know what causes this?
>>>
>>> I'm using k-nearest neighbours = 12, the S-coding variance
>>> - stabilising, and the LU method  (I concluded to these numbers and
>>> methods
>>> after experimentation in the other models).
>>>
>>>
>>> Characteristics of weights list object:
>>> Neighbour list object:
>>> Number of regions: 8066
>>> Number of nonzero links: 185518
>>> Percentage nonzero weights: 0.2851475
>>> Average number of links: 23
>>> Non-symmetric neighbours list
>>>
>>> Weights style: S
>>> Weights constants summary:
>>>    n       nn   S0       S1       S2
>>> S 8066 65060356 8066 630.5066 32982.99
>>>
>>>
>>>
>>>
>>>  sessionInfo()R version 2.14.0 (2011-10-31)
>>>>
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>> [1] C
>>>
>>> attached base packages:
>>> [1] splines   grid      stats     graphics  grDevices utils     datasets
>>> [8] methods   base
>>>
>>> other attached packages:
>>> [1] ape_2.8             ade4_1.4-17         car_2.0-11
>>> [4] survival_2.36-10    nnet_7.3-1          gstat_1.0-10
>>> [7] spacetime_0.5-7     xts_0.8-2           zoo_1.7-6
>>> [10] rasterVis_0.10-7    hexbin_1.26.0       latticeExtra_0.6-19
>>> [13] RColorBrewer_1.0-5  RANN_2.1.3          spdep_0.5-43
>>> [16] coda_0.14-6         nlme_3.1-102        MASS_7.3-16
>>> [19] Matrix_1.0-2        boot_1.3-3          ggplot2_0.8.9
>>> [22] proto_0.3-9.2       reshape_0.8.4       plyr_1.6
>>> [25] spgwr_0.6-13        spatstat_1.25-0     deldir_0.0-16
>>> [28] mgcv_1.7-12         rgdal_0.7-5         maptools_0.8-10
>>> [31] lattice_0.20-0      foreign_0.8-48      raster_1.9-55
>>> [34] sp_0.9-91
>>>
>>> loaded via a namespace (and not attached):
>>> [1] gee_4.13-17  tools_2.14.0
>>>
>>>
>>> Many thanks in advance for your help.
>>>
>>> Dimitris
>>>
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jjcabrera20 at yahoo.com.mx  Thu Dec 22 14:26:40 2011
From: jjcabrera20 at yahoo.com.mx (jjcabrera20)
Date: Thu, 22 Dec 2011 05:26:40 -0800 (PST)
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
In-Reply-To: <B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>
References: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
	<B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>
Message-ID: <1324560400623-7118612.post@n2.nabble.com>

Thanks Jan
I will take a look on the links.
But any way there is a method to loop inside a SpatialPixelDataFrame?


Best,

Jorge

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Looping-through-pixels-in-a-SpatialGridDataFrame-tp7113726p7118612.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Thu Dec 22 15:24:38 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 22 Dec 2011 15:24:38 +0100
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
In-Reply-To: <1324560400623-7118612.post@n2.nabble.com>
References: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
	<B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>
	<1324560400623-7118612.post@n2.nabble.com>
Message-ID: <4EF33DA6.3020000@uni-muenster.de>



On 12/22/2011 02:26 PM, jjcabrera20 wrote:
> Thanks Jan
> I will take a look on the links.
> But any way there is a method to loop inside a SpatialPixelDataFrame?

You can address individual pixels, as in:

library(sp)
loadMeuse()

gridded(meuse.grid)
class(meuse.grid)

meuse.grid[10,] # pixel 10
meuse.grid[10,][["dist"]] # attr "dist" for pixel 10

for looping over rows and columns, you'd like to convert to
SpatialGridDataFrame, as in:

fullgrid(meuse.grid) = TRUE
meuse.grid[50:51,50:51] # select a region defined by row/col ranges
meuse.grid[50,50] # which should work, but doesn't for some reason.

> 
> 
> Best,
> 
> Jorge
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Looping-through-pixels-in-a-SpatialGridDataFrame-tp7113726p7118612.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jmbarriosg at gmail.com  Thu Dec 22 15:39:09 2011
From: jmbarriosg at gmail.com (=?ISO-8859-1?Q?Jos=E9_Miguel_Barrios?=)
Date: Thu, 22 Dec 2011 15:39:09 +0100
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
In-Reply-To: <1324560400623-7118612.post@n2.nabble.com>
References: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
	<B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>
	<1324560400623-7118612.post@n2.nabble.com>
Message-ID: <CAKAdxrUD8J7ahYZz+0FAe=ZiF5RCdf7KP+PVKfukHnsMtias-A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111222/d26a15a6/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Dec 22 15:49:18 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 22 Dec 2011 15:49:18 +0100
Subject: [R-sig-Geo] Looping through pixels in a SpatialGridDataFrame
In-Reply-To: <4EF33DA6.3020000@uni-muenster.de>
References: <1324425711.31940.YahooMailNeo@web160601.mail.bf1.yahoo.com>
	<B6120749-51C1-4B5E-870D-09A72FDCF4FE@gmail.com>
	<1324560400623-7118612.post@n2.nabble.com>
	<4EF33DA6.3020000@uni-muenster.de>
Message-ID: <4EF3436E.8050705@uni-muenster.de>



On 12/22/2011 03:24 PM, Edzer Pebesma wrote:
> meuse.grid[50,50] # which should work, but doesn't for some reason.

this will work (and return an object of SpatialPointsDataFrame, as it
is, arguably, a single point) in the next sp version (correction in svn).
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From satish.regonda at gmail.com  Thu Dec 22 20:06:40 2011
From: satish.regonda at gmail.com (satishr)
Date: Thu, 22 Dec 2011 11:06:40 -0800 (PST)
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected by
 another polygon
Message-ID: <1324580800294-7119672.post@n2.nabble.com>

Hi,
   I need to calculate the fraction of a polygon that is intersected by
another polygon. details of the problem: I have data in two shape files; the
first file corresponds to a rectangular grid with uniform intervals whereas
the second file corresponds to US climate divisions, which are polygons. The
polygons representing climate divisions vary in size, some times these
climate divisions/polygons are so small such that they fit in one
rectangular grid and some times require more than 20 rectangular grids. What
I need is: (a) identify rectangular grids that intersect with a polygon and
(b) calculate the fraction of the intersection between the rectangular grid
and polygon.
    The function 'extract' with 'weights=TRUE' was able to calculate
fractions but it has following issues: (a) the function did not consider a
grid(s) although there is a overlap with a climate division, and (b)
fractional amounts are changed when I changed the rectangular grid size.
Here is my code. Any help is greatly appreciated.
Thanks,
Satish

#          Read two shape files, rasterize rectangular grid and use it with
'extract'

#          First shape file, rectangular grid;

 

            spatGP=readShapeSpatial("Gaussian_Poylgon_ExtendedCONUS.shp")

 

            spatGP1=as(spatGP,"SpatialPolygons")

 

            spatGP2=slot(spatGP1,"polygons")

 

#          rasterization

 

            spatras0 <- raster(ncol=180, nrow=180)

 

            extent(spatras0)<- extent(spatGP);

 

            spatras <- rasterize(spatGP, spatras0)

 

 

#          second shapefile, polygons, i.e., climate divisions

 

            cddata=readShapeSpatial("divisions.shp")

 

            spcddata=as(cddata,"SpatialPolygons")

 

            regionscddata=slot(spcddata,"polygons")

 

            ipolygon=256   # say, I am interested in this polygon

 

            sub.tmp = slot(regionscddata[[ipolygon]],'Polygons')

 

#          create a polygon

 

            poly.tmp=cbind(sub.tmp[[1]]@coords[,1],sub.tmp[[1]]@coords[,2])

 

            polys = SpatialPolygons(list(Polygons(list(Polygon(poly.tmp)),
1)))

           

            weights.tmp = extract(spatras, polys, weights=TRUE)

 

?weights.tmp? is a matrix ? provides information of cells that are covered
by the polygon, i.e., first column cell positions and second column fraction
of cell.

http://r-sig-geo.2731867.n2.nabble.com/file/n7119672/USClimateDivsions_RectangularGrid.jpeg 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119672p7119672.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From satish.regonda at gmail.com  Thu Dec 22 20:12:59 2011
From: satish.regonda at gmail.com (satishr)
Date: Thu, 22 Dec 2011 11:12:59 -0800 (PST)
Subject: [R-sig-Geo] fraction of a polygon that is intersected by another
	polygon
Message-ID: <1324581179490-7119685.post@n2.nabble.com>

Hi,
   I need to calculate the fraction of a polygon that is intersected by
another polygon. details of the problem: I have data in two shape files; the
first file corresponds to a rectangular grid with uniform intervals whereas
the second file corresponds to US climate divisions, which are polygons. The
polygons representing climate divisions vary in size, some times these
climate divisions/polygons are so small such that they fit in one
rectangular grid and some times require more than 20 rectangular grids. What
I need is: identify rectangular grids that intersect with a polygon and
calculate the fraction of the intersection between the rectangular grid and
polygon.
    The function 'extract' with 'weights=TRUE' was able to calculate
fractions but it has following issues: (a) the function did not consider a
grid(s) although there is a overlap with a climate division, and (b)
fractional amounts are changed when I changed the rectangular grid size.
Here is my code. Any help is greatly appreciated.
Thanks,
Satish

#          Read two shape files, rasterize rectangular grid and use it with
'extract'

#          First shape file, rectangular grid;

            spatGP=readShapeSpatial("Gaussian_Poylgon_ExtendedCONUS.shp")
            spatGP1=as(spatGP,"SpatialPolygons")
            spatGP2=slot(spatGP1,"polygons")

 #          rasterization

             spatras0 <- raster(ncol=180, nrow=180)
             extent(spatras0)<- extent(spatGP);
             spatras <- rasterize(spatGP, spatras0)

 #          second shapefile, polygons, i.e., climate divisions

             cddata=readShapeSpatial("divisions.shp")
             spcddata=as(cddata,"SpatialPolygons")
             regionscddata=slot(spcddata,"polygons")
 
             ipolygon=256   # say, I am interested in this polygon

             sub.tmp = slot(regionscddata[[ipolygon]],'Polygons')
#          create a polygon
            poly.tmp=cbind(sub.tmp[[1]]@coords[,1],sub.tmp[[1]]@coords[,2])
            polys = SpatialPolygons(list(Polygons(list(Polygon(poly.tmp)),
1)))

#           Calculate fractions
            weights.tmp = extract(spatras, polys, weights=TRUE)

?weights.tmp? is a matrix ? provides information of cells that are covered
by the polygon, i.e., first column cell positions and second column fraction
of cell.

http://r-sig-geo.2731867.n2.nabble.com/file/n7119685/USClimateDivsions_RectangularGrid.jpeg 


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119685p7119685.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Dec 22 20:32:29 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 22 Dec 2011 11:32:29 -0800
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected
 by another polygon
In-Reply-To: <1324580800294-7119672.post@n2.nabble.com>
References: <1324580800294-7119672.post@n2.nabble.com>
Message-ID: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111222/e48d0294/attachment.pl>

From satish.regonda at gmail.com  Thu Dec 22 22:54:24 2011
From: satish.regonda at gmail.com (satishr)
Date: Thu, 22 Dec 2011 13:54:24 -0800 (PST)
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected
 by another polygon
In-Reply-To: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>
References: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>
Message-ID: <1324590864607-7120086.post@n2.nabble.com>

Robert,
   Thanks for the information. I am also not sure whether rasterizing a
rectangular grid is good or not. I tried 'gIntersection' but got an error.
Anyway, here are the data sets. As you see the climate division file name
changed, so you may want to change the name in the code. 
Thanks,
Satish

1. Rectangular Gaussian Grid
http://r-sig-geo.2731867.n2.nabble.com/file/n7120086/GaussianPolygonExtendedCONUS.zip
GaussianPolygonExtendedCONUS.zip 


2. US climate divisions

http://r-sig-geo.2731867.n2.nabble.com/file/n7120086/US344ClimateDivisions.zip
US344ClimateDivisions.zip 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Re-calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119738p7120086.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.turner at auckland.ac.nz  Fri Dec 23 02:41:40 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 23 Dec 2011 14:41:40 +1300
Subject: [R-sig-Geo] computing polygons from a centroid
	point	distribution
In-Reply-To: <4EF04D81.2040107@univ-fcomte.fr>
References: <4EF02DFA.9040009@univ-fcomte.fr>	<4A316DEA-F34F-4131-891E-D32ED0FBA9AC@remoteinformation.com.au>
	<4EF04D81.2040107@univ-fcomte.fr>
Message-ID: <4EF3DC54.8020208@auckland.ac.nz>


You should be aware that the ***centroid*** of a Dirichlet/Voronoi tile is
***NOT*** in general the point determining that tile.

I do not believe that your original question, as posed (in terms
of centroids) actually has a solution.

     cheers,

         Rolf Turner

On 20/12/11 21:55, Patrick Giraudoux wrote:
> Le 20/12/2011 07:53, Ben Madin a ?crit :
>> Patrick,
>>
>> On 20/12/2011, at 2:40 PM, Patrick Giraudoux wrote:
>>
>>> Given a spatial point distribution in a two dimensional space, I 
>>> wonder if there is a function in R that could make a polygon 
>>> partition of the two dimensional space, with each point as centroid 
>>> of each polygon ?
>>>
>>> Any suggestion about package(s) and function(s), if any, welcome,
>>> library(deldir)
>>> ?deldir
>> might be what you are after?
>>
>> cheers
>>
>> Ben
>>
>>
>
> Yes ! exactly what I needed. Missed that it could have been properly 
> called "tesselation", rather than to use winding explanations...
>
> Many thanks,
>
> Patrick
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Fri Dec 23 03:40:43 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 22 Dec 2011 18:40:43 -0800
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected
 by another polygon
In-Reply-To: <1324590864607-7120086.post@n2.nabble.com>
References: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>
	<1324590864607-7120086.post@n2.nabble.com>
Message-ID: <CANtt_hyYjjzR-FWKRpZeaaBJ8=X0YNJDSZuxqzTmunLm1mhAZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111222/3921bf39/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Fri Dec 23 04:16:54 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Fri, 23 Dec 2011 04:16:54 +0100
Subject: [R-sig-Geo] computing polygons from a centroid
	point	distribution
In-Reply-To: <4EF3DC54.8020208@auckland.ac.nz>
References: <4EF02DFA.9040009@univ-fcomte.fr>	<4A316DEA-F34F-4131-891E-D32ED0FBA9AC@remoteinformation.com.au>
	<4EF04D81.2040107@univ-fcomte.fr> <4EF3DC54.8020208@auckland.ac.nz>
Message-ID: <4EF3F2A6.3090907@univ-fcomte.fr>

Le 23/12/2011 02:41, Rolf Turner a ?crit :
>
> You should be aware that the ***centroid*** of a Dirichlet/Voronoi 
> tile is
> ***NOT*** in general the point determining that tile.
>
> I do not believe that your original question, as posed (in terms
> of centroids) actually has a solution.
>
>     cheers,
>
>         Rolf Turner



Thanks for this info. Now I realize that my question was wrongly 
formulated. A tesselation based on spatial points was enough for what I 
wanted to do.

Best,

Patrick



>
> On 20/12/11 21:55, Patrick Giraudoux wrote:
>> Le 20/12/2011 07:53, Ben Madin a ?crit :
>>> Patrick,
>>>
>>> On 20/12/2011, at 2:40 PM, Patrick Giraudoux wrote:
>>>
>>>> Given a spatial point distribution in a two dimensional space, I 
>>>> wonder if there is a function in R that could make a polygon 
>>>> partition of the two dimensional space, with each point as centroid 
>>>> of each polygon ?
>>>>
>>>> Any suggestion about package(s) and function(s), if any, welcome,
>>>> library(deldir)
>>>> ?deldir
>>> might be what you are after?
>>>
>>> cheers
>>>
>>> Ben
>>>
>>>
>>
>> Yes ! exactly what I needed. Missed that it could have been properly 
>> called "tesselation", rather than to use winding explanations...
>>
>> Many thanks,
>>
>> Patrick
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From r.turner at auckland.ac.nz  Fri Dec 23 05:32:25 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 23 Dec 2011 17:32:25 +1300
Subject: [R-sig-Geo] Finding out in which polygon a point lies
In-Reply-To: <CAATY4m4hbWCfuYjg=r0RzrD7Z3OJFuU7gQdP51JhU8WXPqDyOg@mail.gmail.com>
References: <CAATY4m4hbWCfuYjg=r0RzrD7Z3OJFuU7gQdP51JhU8WXPqDyOg@mail.gmail.com>
Message-ID: <4EF40459.2040302@auckland.ac.nz>


The spatstat package provides tools  which will easily allow you
to check which polygons contain points.

Turn your polygons into "owin" objects, make a *list* (say "L")
of these objects, and then

     sapply(L,function(W,x,y){any(inside.owin(x,y,W))},x=x,y=y)

will give TRUE for polygons containing points and FALSE otherwise.

     cheers,

         Rolf Turner

On 21/12/11 04:43, Dieter Vanderelst wrote:
> Dear List,
>
> I've read in a shapefile using the readShapePoly {maptools} function.
> This shapefile represents Angola and has different polygons for the
> different regions of the country. I also have a set of coordinates
> (lat/long). Now want to do two things:
>
> 1 - I want to plot the points on the map. Given that both my points
> and the shapefile use the same coordinate reference system
> (latitude/longitude) and theWGS84 datum, I think I can just use the
> function plot(lon,lat). Please correct me I if I'm wrong here.
>
> 2 - The second problem is a bit harder. I want to color the polygons
> which contain one or more points. How can I check in which polygon
> each of the points lie. I found a partial explanation online on how to
> do this with the sp package (see
> https://stat.ethz.ch/pipermail/r-help/2009-February/187435.html).
> However, I haven't been able to reconstruct the method suggested in
> this post.
>
> Any thoughts on how to select polygons based on coordinates using
> maptools would be most welcome.


From Jan.Quets at ua.ac.be  Fri Dec 23 16:32:53 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Fri, 23 Dec 2011 15:32:53 +0000
Subject: [R-sig-Geo] epanechnikov kernel in density.ppp?
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE558FF00D@xmail33.ad.ua.ac.be>

Hello,

is it possible to use a epanechnikov kernel instead of a gaussian kernel in density.ppp()?

kind regards,
Jan

From satish.regonda at gmail.com  Fri Dec 23 21:00:35 2011
From: satish.regonda at gmail.com (satishr)
Date: Fri, 23 Dec 2011 12:00:35 -0800 (PST)
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected
 by another polygon
In-Reply-To: <CANtt_hyYjjzR-FWKRpZeaaBJ8=X0YNJDSZuxqzTmunLm1mhAZw@mail.gmail.com>
References: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>
	<1324590864607-7120086.post@n2.nabble.com>
	<CANtt_hyYjjzR-FWKRpZeaaBJ8=X0YNJDSZuxqzTmunLm1mhAZw@mail.gmail.com>
Message-ID: <1324670435063-7122457.post@n2.nabble.com>

Robert,
   Thanks for all the detailed information. I am able to work around it with
the help of your email and Roger Bivand's reply from archives. For others
benefit, I am putting the final version code here.
Thanks,
Satish

	rm(list=ls())

	library(maptools);library(raster);library(rgeos);library(rgdal);

	grid=readOGR("C:/test","Gaussian_Poylgon_ExtendedCONUS")

	climdiv <- readOGR("C:/test","US344ClimateDivisions1928Polys")

	# climdiv has several polygons with the same attributes, need to do be
"aggregated" first

	climagdiv <- aggregate(climdiv, 'PopupInfo')

	iclimdiv=256 # say, we are interested in this polygon

	int = gIntersects(climagdiv[iclimdiv,],grid,byid=TRUE)

	vec = vector(mode="list", length=dim(int)[2]) 

	for (i in seq(along=vec)) vec[[i]] =
try(gIntersection(climagdiv[iclimdiv,],grid[int[,i],], byid=TRUE))

	out = do.call("rbind", vec) 

	rn = row.names(out) 

	nrn = do.call("rbind", strsplit(rn, " ")) # nrn[,2] --> grid index

	gridindex=as.numeric(nrn[,2])+1	# gridindex, need to add "1" because row
names start from "0"

	fracgridarea=sapply(slot(out,"polygons"), slot, "area")	# fraction of a
grid in a polygon

# "gridindex" corresponds to grid number whereas  "fractgridarea"
corresponds to fraction of a grid in a polygon/climate division

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Re-calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119738p7122457.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From satish.regonda at gmail.com  Fri Dec 23 21:04:44 2011
From: satish.regonda at gmail.com (satishr)
Date: Fri, 23 Dec 2011 12:04:44 -0800 (PST)
Subject: [R-sig-Geo] calculate fraction of a polygon that is intersected
 by another polygon
In-Reply-To: <CANtt_hyYjjzR-FWKRpZeaaBJ8=X0YNJDSZuxqzTmunLm1mhAZw@mail.gmail.com>
References: <CANtt_hw=VR=mQ_jy7wYPKjXcNUgz=yKq-8d43C8CN8onWj7LuA@mail.gmail.com>
	<1324590864607-7120086.post@n2.nabble.com>
	<CANtt_hyYjjzR-FWKRpZeaaBJ8=X0YNJDSZuxqzTmunLm1mhAZw@mail.gmail.com>
Message-ID: <CACQSnN_vNmC0oasv=B+kBkLZ_GUS8NTMzEDK9T_eDaJGhOEM7g@mail.gmail.com>

Robert, Thanks for all the detailed information, it was very helpful and am
able to find solutions. I update the thread with my final version of code.

Thanks,
Satish


On Thu, Dec 22, 2011 at 9:44 PM, Robert Hijmans [via R-sig-geo] <
ml-node+s2731867n7120634h34 at n2.nabble.com> wrote:

> Satish,
>
> Here are some suggestions:
>
> library(rgeos)
> library(raster)
> # you need the latests versions of the above packages
> library(rgdal)
>
> grid <- readOGR("c:/satish", "Gaussian_Poylgon_ExtendedCONUS")
> clim <- readOGR("c:/satish", "US344ClimateDivisions")
>
> # climag has several polygons with the same attributes
> # you should probably "aggregate" first
> climag <- aggregate(clim, 'Name')
>
> #rather than creating a polygon grid, I would create a raster grid
> # raster(xmn=, , , , ) etc.
> # for now this recreates your polygon grid as a raster
> r <- raster(grid)
> dim(r) <- c(38, 92)
> r[] <- 1:ncell(r)
>
> ex <- extract(r, climag, weights=TRUE)
> ex[1]
> sapply(ex, nrow)  # each multi-polygon has at least one cell
>
> # you would be able to compute area were it not that this is lon/lat data.
> # either first project your data, or use a function like 'area' to
> determine the area of each grid cell
> # and then take the fractions from "ex"
>
> #This fails
> x <- gIntersection(grid, climag, byid=TRUE)
>
> # but you can do this for most polygons
>
> x <- gIntersection(grid, climag[1,])
> plot(x)
> row.names(x)
> sapply(x at polygons, function(x) slot(x, 'area'))
>
> # and that is more precise than the raster method
>
> Hope this helps, Robert
>
> On Thu, Dec 22, 2011 at 1:54 PM, satishr <[hidden email]<http://user/SendEmail.jtp?type=node&node=7120634&i=0>>
> wrote:
>
> > Robert,
> >   Thanks for the information. I am also not sure whether rasterizing a
> > rectangular grid is good or not. I tried 'gIntersection' but got an
> error.
> > Anyway, here are the data sets. As you see the climate division file
> name
> > changed, so you may want to change the name in the code.
> > Thanks,
> > Satish
> >
> > 1. Rectangular Gaussian Grid
> >
> >
> http://r-sig-geo.2731867.n2.nabble.com/file/n7120086/GaussianPolygonExtendedCONUS.zip
> > GaussianPolygonExtendedCONUS.zip
> >
> >
> > 2. US climate divisions
> >
> >
> >
> http://r-sig-geo.2731867.n2.nabble.com/file/n7120086/US344ClimateDivisions.zip
> > US344ClimateDivisions.zip
> >
> >
> >
> > --
> > View this message in context:
> >
> http://r-sig-geo.2731867.n2.nabble.com/Re-calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119738p7120086.html
> > Sent from the R-sig-geo mailing list archive at Nabble.com.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > [hidden email] <http://user/SendEmail.jtp?type=node&node=7120634&i=1>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email] <http://user/SendEmail.jtp?type=node&node=7120634&i=2>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://r-sig-geo.2731867.n2.nabble.com/Re-calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119738p7120634.html
>  To unsubscribe from Re: calculate fraction of a polygon that is
> intersected by another polygon, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7119738&code=c2F0aXNoLnJlZ29uZGFAZ21haWwuY29tfDcxMTk3Mzh8LTEwNDk4OTYwNDc=>
> .
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.InstantMailNamespace&breadcrumbs=instant+emails%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Re-calculate-fraction-of-a-polygon-that-is-intersected-by-another-polygon-tp7119738p7122468.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From benweinstein2010 at gmail.com  Mon Dec 26 01:07:05 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Sun, 25 Dec 2011 19:07:05 -0500
Subject: [R-sig-Geo] topographic roughness
Message-ID: <CAC28k7ShUCvmdFQBct40x_mxkN21tJFRVbwo+4FpJoWaXnyncw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111225/3bff7a5a/attachment.pl>

From jjcabrera20 at yahoo.com.mx  Mon Dec 26 02:46:35 2011
From: jjcabrera20 at yahoo.com.mx (jjcabrera20)
Date: Sun, 25 Dec 2011 17:46:35 -0800 (PST)
Subject: [R-sig-Geo] topographic roughness
In-Reply-To: <CAC28k7ShUCvmdFQBct40x_mxkN21tJFRVbwo+4FpJoWaXnyncw@mail.gmail.com>
References: <CAC28k7ShUCvmdFQBct40x_mxkN21tJFRVbwo+4FpJoWaXnyncw@mail.gmail.com>
Message-ID: <1324863995716-7127110.post@n2.nabble.com>

Hello Ben, I think you should take a look on the raster package, there you
have the TRI as a function
Best,

Jorge

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/topographic-roughness-tp7127002p7127110.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.turner at auckland.ac.nz  Mon Dec 26 05:28:09 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 26 Dec 2011 17:28:09 +1300
Subject: [R-sig-Geo] epanechnikov kernel in density.ppp?
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE558FF00D@xmail33.ad.ua.ac.be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE558FF00D@xmail33.ad.ua.ac.be>
Message-ID: <4EF7F7D9.80305@auckland.ac.nz>

On 24/12/11 04:32, Quets Jan wrote:
> Hello,
>
> is it possible to use a epanechnikov kernel instead of a gaussian kernel in density.ppp()?
Currently density.ppp() supports on Gaussian kernels (possibly 
non-isotropic).

     cheers,

         Rolf Turner


From samanmonfared1 at gmail.com  Mon Dec 26 23:56:31 2011
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Tue, 27 Dec 2011 02:26:31 +0330
Subject: [R-sig-Geo] Please help me
Message-ID: <CAOytA4amXidkQ73Zenmt-fSHq3QwK-3tXa0rJr_M-=Jm96mgoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111227/bd4740c5/attachment.pl>

From mathieu.rajerison at gmail.com  Tue Dec 27 11:24:28 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 27 Dec 2011 11:24:28 +0100
Subject: [R-sig-Geo] Looping though pixels in a SpatialGridDataFrame
In-Reply-To: <1324422003.7287.YahooMailNeo@web160606.mail.bf1.yahoo.com>
References: <1324422003.7287.YahooMailNeo@web160606.mail.bf1.yahoo.com>
Message-ID: <CAGfc75=25JC_i9LD4rUtJbK2pOJ0h1AL99etL4M7cRXVuZkuuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111227/c675168f/attachment.pl>

From mathieu.rajerison at gmail.com  Tue Dec 27 11:30:12 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 27 Dec 2011 11:30:12 +0100
Subject: [R-sig-Geo] fraction of a polygon that is intersected by
	another polygon
In-Reply-To: <1324581179490-7119685.post@n2.nabble.com>
References: <1324581179490-7119685.post@n2.nabble.com>
Message-ID: <CAGfc75m1VcBfjMyjf+ECWPYi=HC72ZnfMkp0ssEXkWmeYmv=yA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111227/a30b9d5d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Dec 28 12:05:33 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 28 Dec 2011 12:05:33 +0100
Subject: [R-sig-Geo] Please help me
In-Reply-To: <CAOytA4amXidkQ73Zenmt-fSHq3QwK-3tXa0rJr_M-=Jm96mgoA@mail.gmail.com>
References: <CAOytA4amXidkQ73Zenmt-fSHq3QwK-3tXa0rJr_M-=Jm96mgoA@mail.gmail.com>
Message-ID: <4EFAF7FD.8000806@uni-muenster.de>

You can find some introductions in:

http://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf

and also an example when running:

library(gstat)
demo(cokriging)

Your phrasing "that have minimum error" does not ring enough bells with
me in order to answer.

Hth,

On 12/26/2011 11:56 PM, Saman Monfared wrote:
> Dear All.
> Hi.
> I want perform a cokriging for three co-variable with gstat package but I
> don't know how fit the best cross-variogram model that have a minimum error.
> Please guide me.
> Thanks.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From rrasterr at gmail.com  Wed Dec 28 13:14:22 2011
From: rrasterr at gmail.com (Ana)
Date: Wed, 28 Dec 2011 13:14:22 +0100
Subject: [R-sig-Geo] transparency using plot+points with sp classes
Message-ID: <CAErHZW0GTt2aBy5BnFrSE36JHD=t2s557nRBCZksWwBfAsZREA@mail.gmail.com>

How can I make one point graphics with transparency

These are all sp classes:

plot(polygons_area,axes=TRUE,asp=1.5,main="Title",xlab="Latitude",
ylab="Longitude")
points(observations2000,type = "p",pch=21,col="green")
points(observation1999,type = "p",pch=21,col="blue")
points(reference.points,type = "p",pch=21,col="red")

how can I add transparency to one of the point graphics, for example
points(observation1999,type = "p",pch=21,col="blue")  ?


From roman.lustrik at gmail.com  Wed Dec 28 13:35:36 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 28 Dec 2011 13:35:36 +0100
Subject: [R-sig-Geo] transparency using plot+points with sp classes
In-Reply-To: <CAErHZW0GTt2aBy5BnFrSE36JHD=t2s557nRBCZksWwBfAsZREA@mail.gmail.com>
References: <CAErHZW0GTt2aBy5BnFrSE36JHD=t2s557nRBCZksWwBfAsZREA@mail.gmail.com>
Message-ID: <CAHT1vphMmBe8XnH+TOJNE3Svm8U+zgiOCCmGpDw-QkKJtX3yjg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111228/b82f7501/attachment.pl>

From rrasterr at gmail.com  Wed Dec 28 13:46:20 2011
From: rrasterr at gmail.com (Ana)
Date: Wed, 28 Dec 2011 13:46:20 +0100
Subject: [R-sig-Geo] transparency using plot+points with sp classes
In-Reply-To: <CAHT1vphMmBe8XnH+TOJNE3Svm8U+zgiOCCmGpDw-QkKJtX3yjg@mail.gmail.com>
References: <CAErHZW0GTt2aBy5BnFrSE36JHD=t2s557nRBCZksWwBfAsZREA@mail.gmail.com>
	<CAHT1vphMmBe8XnH+TOJNE3Svm8U+zgiOCCmGpDw-QkKJtX3yjg@mail.gmail.com>
Message-ID: <CAErHZW1eXa98EFezXdNQ5e7gmZgS-o9VN6T=Dj6say4g90+qeg@mail.gmail.com>

Thanks Roman!


Is there a way to move all points of a point graphics
up/down/left/right in reference to the previous position, by a certain
amount of values? This is to avoid overlaps with other point data.


On Wed, Dec 28, 2011 at 1:35 PM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
> You can use ?rgb
>
> plot(0, 0, xlim = c(0, 1), ylim = c(0, 1), type = "n")
> sapply(seq(1, 0, -0.1), function(x)
> points(x = runif(100), y = rep(x, 100),
> col = rgb(red = 0, green = 0, blue = 1, alpha = x), pch = 16))
>
>
> HTH,
> Roman
>
>
>
>
> On Wed, Dec 28, 2011 at 1:14 PM, Ana <rrasterr at gmail.com> wrote:
>>
>> How can I make one point graphics with transparency
>>
>> These are all sp classes:
>>
>> plot(polygons_area,axes=TRUE,asp=1.5,main="Title",xlab="Latitude",
>> ylab="Longitude")
>> points(observations2000,type = "p",pch=21,col="green")
>> points(observation1999,type = "p",pch=21,col="blue")
>> points(reference.points,type = "p",pch=21,col="red")
>>
>> how can I add transparency to one of the point graphics, for example
>> points(observation1999,type = "p",pch=21,col="blue") ??
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> --
> In God we trust, all others bring data.


From roman.lustrik at gmail.com  Wed Dec 28 13:56:03 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 28 Dec 2011 13:56:03 +0100
Subject: [R-sig-Geo] transparency using plot+points with sp classes
In-Reply-To: <CAErHZW1eXa98EFezXdNQ5e7gmZgS-o9VN6T=Dj6say4g90+qeg@mail.gmail.com>
References: <CAErHZW0GTt2aBy5BnFrSE36JHD=t2s557nRBCZksWwBfAsZREA@mail.gmail.com>
	<CAHT1vphMmBe8XnH+TOJNE3Svm8U+zgiOCCmGpDw-QkKJtX3yjg@mail.gmail.com>
	<CAErHZW1eXa98EFezXdNQ5e7gmZgS-o9VN6T=Dj6say4g90+qeg@mail.gmail.com>
Message-ID: <CAHT1vpjTmjmQm4e-ZV86S-7-wUdFd5YOwaqhyd2P-P6BZ1xktg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111228/af22c2e5/attachment.pl>

From momadou at yahoo.fr  Wed Dec 28 17:39:46 2011
From: momadou at yahoo.fr (Komine)
Date: Wed, 28 Dec 2011 08:39:46 -0800 (PST)
Subject: [R-sig-Geo] Number of duplicated pixels
Message-ID: <1325090385869-7133208.post@n2.nabble.com>

HI,
I have a matrix containing 2 columns: coordinates X (longitude), Y
(Latitude), representing the coordinates of burned pixels for 10 years. I
want to known the pixels which burned once, twice, three times etc. in the
10 years. So I would like to obtain the frequency of the burned pixels. 
I used this following code which is good. 

> essai[which(duplicated(essai,incomparables=FALSE)==TRUE),]

But I want to know the length of each duplicated coordinate. I used this
code with length: 

> length(essai[which(duplicated(essai,incomparables=FALSE)==TRUE),])

But it shows only the length of the first duplicated coordinate. 

Can you help me to resolve it!
Thank you in advance 
Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Number-of-duplicated-pixels-tp7133208p7133208.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From roman.lustrik at gmail.com  Wed Dec 28 18:04:59 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 28 Dec 2011 18:04:59 +0100
Subject: [R-sig-Geo] Number of duplicated pixels
In-Reply-To: <1325090385869-7133208.post@n2.nabble.com>
References: <1325090385869-7133208.post@n2.nabble.com>
Message-ID: <CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111228/0e076717/attachment.pl>

From momadou at yahoo.fr  Wed Dec 28 18:28:34 2011
From: momadou at yahoo.fr (Komine)
Date: Wed, 28 Dec 2011 09:28:34 -0800 (PST)
Subject: [R-sig-Geo] Number of duplicated pixels
In-Reply-To: <CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>
References: <1325090385869-7133208.post@n2.nabble.com>
	<CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>
Message-ID: <1325093314852-7133363.post@n2.nabble.com>

Thank Roman for your answer,
In fact, I arrived to obtain the matrix with the duplicated coordinates. But
I want a automatically method to know the frequency of the duplicated
coordinates using perhaps "length". 
Thank you in advance 
Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Number-of-duplicated-pixels-tp7133208p7133363.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Wed Dec 28 18:38:40 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 28 Dec 2011 18:38:40 +0100
Subject: [R-sig-Geo] Number of duplicated pixels
In-Reply-To: <1325093314852-7133363.post@n2.nabble.com>
References: <1325090385869-7133208.post@n2.nabble.com>
	<CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>
	<1325093314852-7133363.post@n2.nabble.com>
Message-ID: <4EFB5420.4070301@uni-muenster.de>

Maybe sp::zerodist helps:

> library(sp)
> loadMeuse()
> table(zerodist(meuse[c(1:10,4:5),], unique.ID=TRUE))

 1  2  3  6  7  8  9 10 11 12
 1  1  1  1  1  1  1  1  2  2
> (zerodist(meuse[c(1:10,4:5),], unique.ID=TRUE))
 [1]  1  2  3 11 12  6  7  8  9 10 11 12


On 12/28/2011 06:28 PM, Komine wrote:
> Thank Roman for your answer,
> In fact, I arrived to obtain the matrix with the duplicated coordinates. But
> I want a automatically method to know the frequency of the duplicated
> coordinates using perhaps "length". 
> Thank you in advance 
> Komine 
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Number-of-duplicated-pixels-tp7133208p7133363.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From momadou at yahoo.fr  Wed Dec 28 18:47:43 2011
From: momadou at yahoo.fr (Komine)
Date: Wed, 28 Dec 2011 09:47:43 -0800 (PST)
Subject: [R-sig-Geo] Number of duplicated pixels
In-Reply-To: <4EFB5420.4070301@uni-muenster.de>
References: <1325090385869-7133208.post@n2.nabble.com>
	<CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>
	<1325093314852-7133363.post@n2.nabble.com>
	<4EFB5420.4070301@uni-muenster.de>
Message-ID: <1325094463390-7133427.post@n2.nabble.com>

Yes Roman, I want 3 columns : X =Long, Y=Lat and Frequency.
Edzer, I will try library (sp).  
Thank you in advance 
Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Number-of-duplicated-pixels-tp7133208p7133427.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From momadou at yahoo.fr  Wed Dec 28 19:17:00 2011
From: momadou at yahoo.fr (Komine)
Date: Wed, 28 Dec 2011 10:17:00 -0800 (PST)
Subject: [R-sig-Geo] Number of duplicated pixels
In-Reply-To: <1325094463390-7133427.post@n2.nabble.com>
References: <1325090385869-7133208.post@n2.nabble.com>
	<CAHT1vphc5Zrv6hXCNQqawuXbZ2zpfX3v2v08Ds5WWeysgUnt0A@mail.gmail.com>
	<1325093314852-7133363.post@n2.nabble.com>
	<4EFB5420.4070301@uni-muenster.de>
	<1325094463390-7133427.post@n2.nabble.com>
Message-ID: <1325096220925-7133526.post@n2.nabble.com>

Thanks to Roman, Edzer and Caspar, 
I resolve the problem with the code of Caspar. I had problem to understand
the example of Edzer because I am not good with R. 
Thank to again 
Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Number-of-duplicated-pixels-tp7133208p7133526.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From samanmonfared1 at gmail.com  Wed Dec 28 21:38:11 2011
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Thu, 29 Dec 2011 00:08:11 +0330
Subject: [R-sig-Geo] Cross variogram fitting
Message-ID: <CAOytA4YhPMd9p=RxbzMjnovCyovbK+sbpEDHyqRwLU_CiaByxw@mail.gmail.com>

Dear all
I want fitt a cross variogram with two covariables.

I have two problems.

1)-How can I find the best model for cross variogram??

2)-When I use fit.lmc() with fit.ranges = F or  fit.ranges = T it is
non possituve
 definite.

B is main variable and E,T are covariables.

coordinates(dd) <-~x+y
g = gstat(NULL, "T", T~1, dd)
g = gstat(g, "E", E~1, dd)
g = gstat(g, "B", B~1,dd)
v = variogram(g)
g = gstat(g, model = vgm(1814.2042, "Lin",39061.93, 199.2033), fill.all= T)
g.fit = fit.lmc(v,g,fit.ranges = F)
plot(v, g.fit,type="b",col="black")
but when I use
predict.gstat(g.fit, dd)
I faced with error
""non-positive definite coefficient matrix in structure 1non-positive
definite coefficient
 matrix in structure 2Warning: No Intrinsic Correlation or Linear
Model of Coregionalization found""

-- 

Saman Monfared
Msc Student,
Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From edzer.pebesma at uni-muenster.de  Wed Dec 28 21:56:58 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 28 Dec 2011 21:56:58 +0100
Subject: [R-sig-Geo] Cross variogram fitting
In-Reply-To: <CAOytA4YhPMd9p=RxbzMjnovCyovbK+sbpEDHyqRwLU_CiaByxw@mail.gmail.com>
References: <CAOytA4YhPMd9p=RxbzMjnovCyovbK+sbpEDHyqRwLU_CiaByxw@mail.gmail.com>
Message-ID: <4EFB829A.3060203@uni-muenster.de>

You might be stuck in a fit of perfectly correlated components; as the
documentation of fit.lmc suggests, you could try

g.fit = fit.lmc(v,g,fit.ranges = FALSE, correct.diagonal = 1.01)

but there might be other reasons. Without a reproducible example it's
only guessing I can do.
--
Edzer

On 12/28/2011 09:38 PM, Saman Monfared wrote:
> Dear all
> I want fitt a cross variogram with two covariables.
> 
> I have two problems.
> 
> 1)-How can I find the best model for cross variogram??
> 
> 2)-When I use fit.lmc() with fit.ranges = F or  fit.ranges = T it is
> non possituve
>  definite.
> 
> B is main variable and E,T are covariables.
> 
> coordinates(dd) <-~x+y
> g = gstat(NULL, "T", T~1, dd)
> g = gstat(g, "E", E~1, dd)
> g = gstat(g, "B", B~1,dd)
> v = variogram(g)
> g = gstat(g, model = vgm(1814.2042, "Lin",39061.93, 199.2033), fill.all= T)
> g.fit = fit.lmc(v,g,fit.ranges = F)
> plot(v, g.fit,type="b",col="black")
> but when I use
> predict.gstat(g.fit, dd)
> I faced with error
> ""non-positive definite coefficient matrix in structure 1non-positive
> definite coefficient
>  matrix in structure 2Warning: No Intrinsic Correlation or Linear
> Model of Coregionalization found""
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From chamb244 at msu.edu  Thu Dec 29 00:19:27 2011
From: chamb244 at msu.edu (Jordan Chamberlin)
Date: Wed, 28 Dec 2011 18:19:27 -0500
Subject: [R-sig-Geo] iterative field naming
Message-ID: <4EFBA3FF.80100@msu.edu>

Dear people,

Apologies in advance for what must be a silly question:  I want to 
iterative add a field to a dataframe, where the field takes a name that 
is created as part of the iteration. In the bit of code below, the 
problem line is "zmbpts$myfname <- extr$band1" : what I want to do is 
have the value of the string "myfname" be used as the name of the new 
field (rather than creating a new field called "myfname", which is what 
I'm doing).

for (i in 2000:2009) {
     for (j in 1:12) {

         #temporarily go to data directory, grab file, then return to 
working directory
         setwd(mydd)
         myingrid <- gsub("( )", "", paste("pre", i, "_", j))
         tmpgrid <- readGDAL(myingrid)
         setwd(mywd)

         #create SpatialPixelsDataFrame
         spdf <- as(tmpgrid, "SpatialPixelsDataFrame")
          #summary(spdf)
          #image(spdf, "band1", axes=TRUE, col=terrain.colors(20))

         #extract values to points
         proj4string(spdf)<-proj4string(zmbpts)
         extr = over(zmbpts,spdf)

         #add extracted values to SpatialPointsDataFrame
         myfname <- gsub("( )", "", paste("y", i, "m", j))
         zmbpts$myfname <- extr$band1

     }
}

Thanks for your kind help!  Jordan


From ybrandvain at hotmail.com  Thu Dec 29 02:56:07 2011
From: ybrandvain at hotmail.com (yaniv brandvain)
Date: Wed, 28 Dec 2011 20:56:07 -0500
Subject: [R-sig-Geo] LatLong to UTM zone and coordinates?
Message-ID: <SNT131-W416FD58AEC7F9BF5CEC91FDDAD0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111228/c74fff5c/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Dec 29 12:15:40 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 29 Dec 2011 12:15:40 +0100
Subject: [R-sig-Geo] iterative field naming
In-Reply-To: <4EFBA3FF.80100@msu.edu>
References: <4EFBA3FF.80100@msu.edu>
Message-ID: <4EFC4BDC.4060308@uni-muenster.de>

Jordan, please try

   zmbpts[[myfname]] <- extr$band1

On 12/29/2011 12:19 AM, Jordan Chamberlin wrote:
> Dear people,
> 
> Apologies in advance for what must be a silly question:  I want to
> iterative add a field to a dataframe, where the field takes a name that
> is created as part of the iteration. In the bit of code below, the
> problem line is "zmbpts$myfname <- extr$band1" : what I want to do is
> have the value of the string "myfname" be used as the name of the new
> field (rather than creating a new field called "myfname", which is what
> I'm doing).
> 
> for (i in 2000:2009) {
>     for (j in 1:12) {
> 
>         #temporarily go to data directory, grab file, then return to
> working directory
>         setwd(mydd)
>         myingrid <- gsub("( )", "", paste("pre", i, "_", j))
>         tmpgrid <- readGDAL(myingrid)
>         setwd(mywd)
> 
>         #create SpatialPixelsDataFrame
>         spdf <- as(tmpgrid, "SpatialPixelsDataFrame")
>          #summary(spdf)
>          #image(spdf, "band1", axes=TRUE, col=terrain.colors(20))
> 
>         #extract values to points
>         proj4string(spdf)<-proj4string(zmbpts)
>         extr = over(zmbpts,spdf)
> 
>         #add extracted values to SpatialPointsDataFrame
>         myfname <- gsub("( )", "", paste("y", i, "m", j))
>         zmbpts$myfname <- extr$band1
> 
>     }
> }
> 
> Thanks for your kind help!  Jordan
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From chamb244 at msu.edu  Thu Dec 29 13:51:31 2011
From: chamb244 at msu.edu (Jordan Chamberlin)
Date: Thu, 29 Dec 2011 07:51:31 -0500
Subject: [R-sig-Geo] iterative field naming
In-Reply-To: <4EFC4BDC.4060308@uni-muenster.de>
References: <4EFBA3FF.80100@msu.edu> <4EFC4BDC.4060308@uni-muenster.de>
Message-ID: <4EFC6253.3090808@msu.edu>

Thank you, Edzer, Tom and Tom. Problem solved!

On 11/12/29 6:15 AM, Edzer Pebesma wrote:
> Jordan, please try
>
>     zmbpts[[myfname]]<- extr$band1
>
> On 12/29/2011 12:19 AM, Jordan Chamberlin wrote:
>> Dear people,
>>
>> Apologies in advance for what must be a silly question:  I want to
>> iterative add a field to a dataframe, where the field takes a name that
>> is created as part of the iteration. In the bit of code below, the
>> problem line is "zmbpts$myfname<- extr$band1" : what I want to do is
>> have the value of the string "myfname" be used as the name of the new
>> field (rather than creating a new field called "myfname", which is what
>> I'm doing).
>>
>> for (i in 2000:2009) {
>>      for (j in 1:12) {
>>
>>          #temporarily go to data directory, grab file, then return to
>> working directory
>>          setwd(mydd)
>>          myingrid<- gsub("( )", "", paste("pre", i, "_", j))
>>          tmpgrid<- readGDAL(myingrid)
>>          setwd(mywd)
>>
>>          #create SpatialPixelsDataFrame
>>          spdf<- as(tmpgrid, "SpatialPixelsDataFrame")
>>           #summary(spdf)
>>           #image(spdf, "band1", axes=TRUE, col=terrain.colors(20))
>>
>>          #extract values to points
>>          proj4string(spdf)<-proj4string(zmbpts)
>>          extr = over(zmbpts,spdf)
>>
>>          #add extracted values to SpatialPointsDataFrame
>>          myfname<- gsub("( )", "", paste("y", i, "m", j))
>>          zmbpts$myfname<- extr$band1
>>
>>      }
>> }
>>
>> Thanks for your kind help!  Jordan
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From samanmonfared1 at gmail.com  Thu Dec 29 15:00:46 2011
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Thu, 29 Dec 2011 17:30:46 +0330
Subject: [R-sig-Geo] How can i chose number of lags
Message-ID: <CAOytA4bxDJkhkNrtJeGeYxCOhf-1Fyk25Un8Y2vyVKGCkA_Dkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111229/158b408d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Dec 29 15:52:11 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 29 Dec 2011 15:52:11 +0100
Subject: [R-sig-Geo] How can i chose number of lags
In-Reply-To: <CAOytA4bxDJkhkNrtJeGeYxCOhf-1Fyk25Un8Y2vyVKGCkA_Dkg@mail.gmail.com>
References: <CAOytA4bxDJkhkNrtJeGeYxCOhf-1Fyk25Un8Y2vyVKGCkA_Dkg@mail.gmail.com>
Message-ID: <4EFC7E9B.6080801@uni-muenster.de>

You can use the width argument, and set it to 1/12 of the cutoff value;
specify both for full control.

On 12/29/2011 03:00 PM, Saman Monfared wrote:
> Dear All.
> How can I chose number of lags in variogram function (gstat)
> for example I want calculate empirical variogram in 12 lags.it is 15
> by default in gstat package.
> ??What should I do??
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Dec 30 09:36:50 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Dec 2011 09:36:50 +0100 (CET)
Subject: [R-sig-Geo] LatLong to UTM zone and coordinates?
In-Reply-To: <SNT131-W416FD58AEC7F9BF5CEC91FDDAD0@phx.gbl>
References: <SNT131-W416FD58AEC7F9BF5CEC91FDDAD0@phx.gbl>
Message-ID: <alpine.LRH.2.00.1112300928530.19576@reclus.nhh.no>

On Wed, 28 Dec 2011, yaniv brandvain wrote:

>
> Dear all,I have a lot of global lat-long data, and want to find the UTM 
> coordinates and zones for each.I tried using the convUL function in the 
> PBSmapping package, but it seemed to get the zone wrong for entries far 
> from the equator. A similar problem arose when using latlong2grid in 
> SpatialEpi.Suggestions would be much appreciated.yaniv

Use spTransform in rgdal once you have found the target zone. You might 
find the target zone with a sequence of longitudes in steps of 6 degrees, 
and findInterval() to assign the zones; splitting on the sign of the 
latitude could also give you +south if you want it. You will have to 
subset the Spatial* object by zone, as each object can only have a single 
coordinate reference system. You might also like to consider whether and 
why you want to assign UTM coordinates, as it does lead to your data set 
being split up into many parts.

Roger


> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Adrian.Baddeley at csiro.au  Fri Dec 30 11:13:10 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 30 Dec 2011 18:13:10 +0800
Subject: [R-sig-Geo]  plot.im annoyances
Message-ID: <57DC18C299094D4299F837570C5DF1C558B6DF734A@EXWA-MBX01.nexus.csiro.au>

Quets Jan <Jan.Quets at ua.ac.be> wrote:

 > Hello all,
> I have several issues with using plot.im to plot a density map.

This query is about the package 'spatstat'. 
Please email the package authors first if you have a query, especially if you want something fixed. 
And if you want an answer, avoid words like 'annoyance'.

 > the issues are:
> 1) cex.main doesn't work, cannot scale font of title

The help for plot.im does not mention cex.main and does not promise that arguments such as cex.main will be handled.
However since this is the season of goodwill, I will add this functionality to the next version of spatstat.

>  2) setting margins with mar=c(x,x,x,x) does not seem to work 

Remember that the plot functions in spatstat are equal-scale plots. The physical scale of the x and y axes must be the same. If the physically available plotting region (minus the margins) does not have the same aspect ratio as the image to be plotted, then the image will not take up the entire space. The plot dimensions are determined by a call to plot.default with asp=1 so this all happens in the 'base graphics' system.

 > 3) uninvited white lines traversing plot area

This occurs on some graphics devices because of a change to image.default in R 2.14.0.
A workaround will be added to the next version of spatstat.

> 4) axes=FALSE didn't work, ticks and labels on the ribbon are still there

Again this is not designed to happen but it seems like a good idea so it will be added to the next version of spatstat.

regards
Adrian Baddeley


From marceivissa at gmail.com  Fri Dec 30 14:47:14 2011
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Fri, 30 Dec 2011 14:47:14 +0100
Subject: [R-sig-Geo] Detect islands (of more than 1 areas or polygons) into
	a cartography
Message-ID: <CAAZSCQ7LuLfBBjSgi0r5RdEmoWwZ3u8fmPN++g1AbQdO7b9szw@mail.gmail.com>

Dear all,

Anyone knows a function to detect if there are islands into a
cartography. I refer to islands with more than one area (or polygons).
In other words, I would like to detect how many connected components I
have in the graph.

On the other hand, I would like to know the ?id? of the areas (or
polygons) for each island.

Note: I usually use the "readShapePoly " to open the cartography.

Thank you very much!
Marc


From hammadi.achour at gmail.com  Fri Dec 30 15:31:51 2011
From: hammadi.achour at gmail.com (Hammadi ACHOUR)
Date: Fri, 30 Dec 2011 15:31:51 +0100
Subject: [R-sig-Geo] normalized longitudinal river profil
Message-ID: <CAOTayhZGWoMkpycyHmnhv9nwjhycR-sJTherF4Mw7JMR1MTr8Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111230/d0969057/attachment.pl>

From samanmonfared1 at gmail.com  Fri Dec 30 18:45:40 2011
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Fri, 30 Dec 2011 21:15:40 +0330
Subject: [R-sig-Geo] cross variogram
Message-ID: <CAOytA4aqiiGU6uXrMSAriRT=Hc=aikLOYiXnKfUqBOq=qSGDeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111230/a998e0cf/attachment.pl>

From renaud.lancelot at cirad.fr  Fri Dec 30 23:38:04 2011
From: renaud.lancelot at cirad.fr (lancelot)
Date: Fri, 30 Dec 2011 23:38:04 +0100
Subject: [R-sig-Geo] spplot: title for the colorkey
In-Reply-To: <SNT131-W416FD58AEC7F9BF5CEC91FDDAD0@phx.gbl>
References: <SNT131-W416FD58AEC7F9BF5CEC91FDDAD0@phx.gbl>
Message-ID: <4EFE3D4C.5020404@cirad.fr>

Dear all,

Is there a simple way to add a title to the color key produced by spplot 
(package sp) for raster data sets?

Best wishes,

Renaud
-- 
Renaud Lancelot
EDENext Project, coordinator: http://www.edenext.eu/

CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 95
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From juantomas.sayago at gmail.com  Sat Dec 31 00:25:44 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Fri, 30 Dec 2011 18:25:44 -0500
Subject: [R-sig-Geo] FIPS code join problem,
Message-ID: <CAEOXpND0RY=M1EO5C9dTP-3qdi=RPrv7SukgTQbdRmod9R_LNw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111230/8f82d5d7/attachment.pl>

From darunabas at gmail.com  Sat Dec 31 11:20:09 2011
From: darunabas at gmail.com (Barnabas Daru)
Date: Sat, 31 Dec 2011 12:20:09 +0200
Subject: [R-sig-Geo] Temporal and spatial gradients from two rasters
Message-ID: <CA+R607FWPibYGPA1a06dzgpCBFO2WN9e2D1Y3TaUVT+LO4AvAw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111231/28aa624c/attachment.pl>

