From |omn@v@@|@ @end|ng |rom gm@||@com  Tue Jun  2 09:44:17 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Tue, 2 Jun 2020 02:44:17 -0500
Subject: [R-sig-Geo] How to efficiently generate data of neighboring points
 within specified radii (distances) for each point in a given points data
 set.
Message-ID: <CAKBoCbHUGq9dimYTSN1Bmk2yLBFB24b0Mu4LX7kzkB32i-KYVA@mail.gmail.com>

Hello,
I have data set of about 3400 location points with which I am trying to
generate data of each point and their neighbors within defined radii (eg,
0.25, 1, and 3 miles).

Below is a reprex using the built-in  nz_height  data:

library(sf)
library(dplyr)
library(spData)
library(ggplot2)
library(stringr)
library(rgdal)
library(lwgeom)
library(sp)


#Transform and project to required UTM

projdata<-st_transform(nz_height, 32759)  #32759 is for UTM Zone 59S


# plot(projdata$geometry)

# sequence of radii

bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)

#Create data of neighboring wells per buffer

dataout <- do.call("rbind", lapply(1:length(bufferR), function(y) {
    bfr <- projdata %>% st_buffer(bufferR[y]) ## create Buffer
    ## minus the next smaller buffer
    if(y>1) {
      inters <- suppressWarnings(st_difference(bfr, projdata %>%
st_buffer(bufferR[y-1])))
      bfr <- inters[which(inters$t50_fid == inters$t50_fid.1),]
    }

    # get ids that intersect with buffer
    inters <- bfr %>% st_intersects(projdata)


    do.call("rbind", lapply(which(sapply(inters, length)>0),
         function(z) data.frame(t50_fid = projdata[z,]$t50_fid, radius =
bufferR[y],
                t50_fid_2 = projdata[unlist(inters[z]),]$t50_fid,
                elevation_mtchd = projdata[unlist(inters[z]),]$elevation)))
}))

This gives data frame as:

> head(dataout)
  t50_fid  radius t50_fid_2 elevation_mtchd
1 2353944 402.336   2353944            2723
2 2354404 402.336   2354404            2820
3 2354405 402.336   2354405            2830
4 2369113 402.336   2369113            3033
5 2362630 402.336   2362630            2749
6 2362814 402.336   2362814            2822

The end goal is that for each (original) point with  t50_fid  as IDs, I
want its neighboring points within the specified radius listed under
 t50_fid_2 in a long format. The caveat is that for the very first (ie. the
smallest) radius 402.336,  t50_fid_2 should return neighboring points
within that distance. But for subsequent radii,  t50_fid_2 should return
neighboring points within them but not within the smaller radius. Thus for
example, for radius 1609.34m, I should get as neighboring points, points
within 1609.34m but not within the smaller buffer/radius 402.336m.

The problem is that if I use my full data set of over 3000 rows (points), I
get the following error:

Error in CPL_geos_op2(op, st_geometry(x), st_geometry(y)) : Evaluation
error: std::bad_alloc.

I understand this is a memory issue as the code I am using creates buffers
around each point and this approach is memory intensive.

A suggestion was made that I could achieve my objective  using
st_is_within_distance  instead of  st_buffer  , st_difference  and
st_intersect without creating buffers.

How can I achieve my objective (that is, the table in dataout) efficiently
either with the suggested use of  st_is_within_distance,  or with my code
without running out of memory (RAM) or any other approach?

Thank you for considering my question.
-----------------------
Lom Navanyo Newton

	[[alternative HTML version deleted]]


From kent3737 @end|ng |rom gm@||@com  Tue Jun  2 15:14:54 2020
From: kent3737 @end|ng |rom gm@||@com (Kent Johnson)
Date: Tue, 2 Jun 2020 09:14:54 -0400
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
Message-ID: <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>

> Date: Tue, 2 Jun 2020 02:44:17 -0500
> From: Lom Navanyo <lomnavasia at gmail.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
>         points within specified radii (distances) for each point in a given
>         points data set.
>


> Hello,
> I have data set of about 3400 location points with which I am trying to
> generate data of each point and their neighbors within defined radii (eg,
> 0.25, 1, and 3 miles).
>

The rtree package is very fast and memory-efficient for within-distance
calculations.
https://github.com/hunzikp/rtree

Kent Johnson
Cambridge, MA

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  2 15:59:12 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 2 Jun 2020 15:59:12 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>

On Tue, 2 Jun 2020, Kent Johnson wrote:

>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>> From: Lom Navanyo <lomnavasia at gmail.com>
>> To: r-sig-geo at r-project.org
>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
>>         points within specified radii (distances) for each point in a given
>>         points data set.
>>
>
>
>> Hello,
>> I have data set of about 3400 location points with which I am trying to
>> generate data of each point and their neighbors within defined radii (eg,
>> 0.25, 1, and 3 miles).
>>
>
> The rtree package is very fast and memory-efficient for within-distance
> calculations.
> https://github.com/hunzikp/rtree

Thanks! Does this also apply when the input points are in geographical 
coordinates?

Roger

>
> Kent Johnson
> Cambridge, MA
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  2 16:58:16 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 2 Jun 2020 16:58:16 +0200
Subject: [R-sig-Geo] rgdal: About the new gdal3 and proj >=6 condition
In-Reply-To: <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
References: <54DFB961-C4BB-4937-90AF-450B771F1F21@gmail.com>
 <alpine.LFD.2.22.394.2005291421380.3227460@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005291837350.3230794@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
Message-ID: <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>

Brian Ripley (thanks!) provided a patch for rgdal's configure.ac, and the 
R-forge build and check processes now succeed, so please try to install 
either downloading 
http://download.r-forge.r-project.org/src/contrib/rgdal_1.5-9.tar.gz and 
installing from the command line (after running R CMD check), or 
install.packages("rgdal", repos="http://R-Forge.R-project.org").

Remember that if GDAL is < 3, and PROJ >= 6, you need the configure 
argument: --configure-args=--with-proj_api=proj_api.h.

Roger

On Sun, 31 May 2020, Roger Bivand wrote:

> Fresh version of rgdal rev 995 on link and R-forge, with more tweaks to the 
> configure file. Please test.
>
> Roger
>
> On Fri, 29 May 2020, Roger Bivand wrote:
>
>>  I have put a tarball, built without vignettes with GDAL 2.2.4 and PROJ
>>  7.0.1 that passes CMD check (with warnings for missing vignettes) on:
>>
>>  http://spatial.nhh.no/R/rgdal/gdal_1.5-9.tar.gz
>>
>>  It involves code copying to provide duplicated functions in three
>>  settings:
>>
>>  PROJ < 6 & GDAL < 3
>> PROJ >  = 6 & GDAL >= 3
>> PROJ >  = 6 & GDAL < 3 (your homebrew case)
>>
>>  You need the configure argument:
>>  --configure-args=--with-proj_api=proj_api.h.
>>  Without the argument, you now get directed to use it.
>>
>>  For now I've dropped the configure tests for sqlite3, curl and tiff; works
>>  for me but may not work for you.
>>
>>  Please make the output of:
>>
>>  R CMD check --install-args="--configure-args=--with-proj_api=proj_api.h"
>>  rgdal_1.5-9.tar.gz
>>
>>  available ASAP. I count on an immediate response.
>>
>>  Roger
>>
>>  On Fri, 29 May 2020, Roger Bivand wrote:
>>
>>>   On Fri, 29 May 2020, Patrick Schratz wrote:
>>>
>>>>    The just released rgdal v1.5.8 requires gdal >= 3 when proj >= 6 is
>>>>    present. It does not even install the package if this condition is not
>>>>    met
>>>>    but errors during linking.
>>>
>>>   Please document with the output of 00install.out from R CMD check
>>>   rgdal_1.5-8.tar.gz, and pkg-config proj --modversion, gdalinfo --version
>>>   with system details.
>>>
>>>   Yes, PROJ >= 6 makes no sense without GDAL >= 3; GDAL 3 makes no sense
>>>   with PROJ < 6. GDAL 3 with PROJ < 6 uses the old proj_api.h API and the
>>>   old metadata structure with Proj4 string degradation; GDAL < 3 with PROJ
>>>>   = 6 must use the deprecated API and the new metadata structure.
>>> 
>>>>
>>>>    I could not find any sources in the web or in the announcement post of
>>>>    v1.5.8 why this condition was enforced so strictly.
>>>>    Does it cause unwanted results?
>>>
>>>   Yes, definitely. GDAL 3 was released as 3, not 2.5, to stress the
>>>   complete
>>>   break between GDAL 2 (with PROJ <= 5) and GDAL >= 3 (with PROJ >= 6)
>>>   after
>>>   GDAL barnraising. So:
>>>
>>>             PROJ
>>>             < 6 >= 6
>>>   GDAL < 3   OK   NO
>>>    >   = 3   NO   OK
>>>
>>> 
>>>
>>>>    If so, then there is a big issue since the ?gdal2 and proj >= 6?
>>>>    combination has been used by many people in the past already.
>>>
>>>   No good precedent, just binary packagers protecting slow downstream
>>>   adaptation.
>>>
>>>>    I haven?t tracked down for how long this situation was on the market
>>>>    already.
>>>>    Also the {sf} package is still installable with this combination and I
>>>>    am not aware of any warnings/issues that came up due to this so far.
>>>> 
>>>
>>>   rgdal is a much older package and has much more older code that needs
>>>   this
>>>   protection. It is possible to accommodate the no-go areas, but I'd
>>>   really
>>>   value patches to R-forge, as I cannot check multiple PROJ/GDAL version
>>>   combinations just because someone isn't up to speed.
>>>
>>>>    It further causes complete breakage for people relying on the homebrew
>>>>    package manager on macOS since current versions are gdal v2.2.4 and
>>>>    proj
>>>>    7.0.1.
>>>
>>>   They should never have gone beyond PROJ 5 if they are stuck on GDAL.
>>>   PROJ
>>>   7 is a very different animal.
>>>
>>>>    The update to gdal3 is blocked since months due to an incompatibility
>>>>    with `liblas` (https://github.com/libLAS/libLAS/issues/164). Reading
>>>>    the
>>>>    issue, it looks unclear when this issue will be resolved.
>>>>    The alternative osgeo4mac tap holds formula that is unstable and
>>>>    somewhat broken. One cannot link rgdal with the current gdal v3.0.1
>>>>    from
>>>>    osgeo4mac.
>>>>
>>>>    This incompatibility with homebrew-core formula leads to further
>>>>    issues
>>>>    for CI tests that rely on the spatial homebrew stack for macOS builds.
>>>>
>>>>    All of this is really unfortunate and I am wondering if this was a
>>>>    known
>>>>    factor when introducing this condition in the new release.
>>>>    Unfortunately rgdal is not hosted on any Git* provider (there is just
>>>>    the CRAN mirror with not much information about the recent changes)
>>>>    and
>>>>    it is unclear/untransparent to me if there is a continuous integration
>>>>    setup at all for this package.
>>>
>>>   Do not require me to leave the excellent SVN service on R-forge. Provide
>>>   patches there.
>>>
>>>>    I hope this is not another case in the series ?I do not like operating
>>>>    system XY and hence I do not test on it? which was seen recently in
>>>>    another package. That?s what CI is for and the responsibility of
>>>>    package authors.
>>>> 
>>>
>>>   I run and develop on Fedora, I  have no access to OSX, and the current
>>>   release was fully checked with ~ 900 revdeps repeatedly since November
>>>   on
>>>   successive older and newer versions of PROJ and GDAL. I blocked new PROJ
>>>   with old GDAL recently to simplify development. CI is only as good as
>>>   the
>>>   scripts, I am completely sure that repeated revdep testing and reading
>>>   the
>>>   output is superior.
>>>
>>>>    Also one should be aware that not every rgdal user is member of this
>>>>    mailing list (I guess not even 5%) and many people in production will
>>>>    face this error during install, most of them without any clue what to
>>>>    do
>>>>    or an idea why this was raised.
>>>> 
>>>
>>>   There has been plenty of information given about the CRS changes. rgdal
>>>   could simply have been abandoned by me, and all  those production
>>>   volunteers might have fixed things, but I never hear anything at all.
>>>
>>>>    In summary it would be great if
>>>>
>>>>    - There would be more detailed information on the introduction of the
>>>>    new condition
>>>>    - Awareness of state-of-the-art platform related library versions
>>>>    before
>>>>    making such a release
>>>>    - Transparency/Existence of a cross-platform build process
>>>>    - If the incompatibility is just due to some features not being
>>>>    accessible with this configuration, I suggest to raise a warning
>>>>    during
>>>>    package load but not prevent the package from installing in the first
>>>>    place
>>>>    - A version-based NEWS file would be available. Currently one only
>>>>    sees
>>>>    a revision-based Changelog:
>>>>    https://cran.r-project.org/web/packages/rgdal/ChangeLog
>>>>
>>>>    I am well aware that I am indirectly criticising (hopefully in a
>>>>    constructive way) the transparency and release process here, for which
>>>>    I
>>>>    will probably get a rough response.
>>>>    However, if that leads to more robustness and transparency in future
>>>>    release, I am fine with this.
>>>>
>>>>    A quick patch release resolving the breakage would be highly
>>>>    appreciated.
>>>
>>>   Only with community imput. what you ask is not needed, just extra
>>>   complexity. Please provide patches, or accept my invitation to join the
>>>   R-forge project and commit your fixes directly. I can see how to do it,
>>>   but I don't think it makes sense, and your messsage has not motivated
>>>   me,
>>>   to be honest. I'm prioritizing working with CRAN to iron out reverse
>>>   dependency problems.
>>>
>>>   Roger
>>> 
>>>>
>>>>    Best, Patrick
>>>>     [[alternative HTML version deleted]]
>>>>
>>>>    _______________________________________________
>>>>    R-sig-Geo mailing list
>>>>    R-sig-Geo at r-project.org
>>>>    https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> 
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From kent3737 @end|ng |rom gm@||@com  Tue Jun  2 17:24:09 2020
From: kent3737 @end|ng |rom gm@||@com (Kent Johnson)
Date: Tue, 2 Jun 2020 11:24:09 -0400
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
Message-ID: <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>

rtree uses Euclidean distance so the points should be in a coordinate
system where this makes sense at least as a reasonable approximation.

Kent

On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 2 Jun 2020, Kent Johnson wrote:
>
> >> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >> From: Lom Navanyo <lomnavasia at gmail.com>
> >> To: r-sig-geo at r-project.org
> >> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
> >>         points within specified radii (distances) for each point in a
> given
> >>         points data set.
> >>
> >
> >
> >> Hello,
> >> I have data set of about 3400 location points with which I am trying to
> >> generate data of each point and their neighbors within defined radii
> (eg,
> >> 0.25, 1, and 3 miles).
> >>
> >
> > The rtree package is very fast and memory-efficient for within-distance
> > calculations.
> > https://github.com/hunzikp/rtree
>
> Thanks! Does this also apply when the input points are in geographical
> coordinates?
>
> Roger
>
> >
> > Kent Johnson
> > Cambridge, MA
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  2 17:33:23 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 2 Jun 2020 17:33:23 +0200
Subject: [R-sig-Geo] rgdal 1.5-8 released on CRAN
In-Reply-To: <401DE748-316B-4C80-9A68-2D707A9D69F9@R-project.org>
References: <alpine.LFD.2.22.394.2005281321030.3206251@reclus.nhh.no>
 <796811998.1903003.1590787537630@mail.yahoo.com>
 <alpine.LFD.2.22.394.2005301356310.4058071@reclus.nhh.no>
 <CAASFQpR7FiGzsykgCz=9Ozt_Raa5E4dqJXOres1CPec2817zxw@mail.gmail.com>
 <FB1FFF1B-2D21-4143-8963-7F62A8F9897A@noaa.gov>
 <CAASFQpQ=BiTXJaeNr5+P70w64P8+rOQ1UXF-xBcAb4-p08pzEA@mail.gmail.com>
 <76FBBA61-399A-4D7E-A4D5-15C4968EC7F1@noaa.gov>
 <604FAF19-C258-4F41-BCCD-6212A9A5A753@R-project.org>
 <6A890145-B435-4211-8842-A7F886242C98@noaa.gov>
 <401DE748-316B-4C80-9A68-2D707A9D69F9@R-project.org>
Message-ID: <alpine.LFD.2.22.394.2006021659150.5920@reclus.nhh.no>

On Sun, 31 May 2020, Simon Urbanek wrote:

> I believe you have to activate the anaconda environment to use it - but 
> that means you have to use R from Anaconda and it is incompatible with 
> anything else. All the package management systems are a horrible mess,

"All the package management systems are a horrible mess" is above the 
fortune threshold IMHO.

> because they now replace system libraries which makes them incompatible 
> with the system and each other. Is there a particular reason why you?re 
> not using the CRAN version? I know there was a discussion about how 
> broken some of the most recent versions of the spatial libraries are, 
> but I have not seen any requests yet...

There are several inter-twined problems here.

One is building rgdal from source on macOS using (I think from homebrew) 
mismatched versions of GDAL (<3) and PROJ (>= 6). rgdal 1.5-8 said no, 
1.5-9 says use the mismatched external software versions at your own 
responsibility (thread started here: 
https://stat.ethz.ch/pipermail/r-sig-geo/2020-May/028131.html).

Another is one about which I tried to elicit response earlier wih no 
success, but which affects Roy: with PROJ 7, CDN download of 
transformation grids becomes possible, but organizations may well want to 
make sure that all organizational users have the same geodetic 
transformation metadata. This extends across programs, because PROJ 
underlies QGIS, pyproj, GRASS, Saga, R spatial, and so on. The CRAN macOS 
binaries, like the CRAN Windows binaries, have bundled proj and gdal 
geodetic transformation metadata, which work, but may differ by version 
from the proj and gdal geodetic transformation metadata used by other 
programs.

We need to consider a) a separate (versioned) data-only CRAN package for 
Windows and macOS packages built against PROJ and GDAL to use, shipping 
once, not in each package built against PROJ and GDAL to use as at 
present. If the users can choose which version to install, they could 
match it to organization policy. b) is to re-think source installs for 
Windows (and macOS) to use resources like the fairly well-supported 
OSGeo4W for Windows. Maybe the organization data managers don't know or 
care that different versions of geodetic transformation metadata give 
different positions, but I think ongoing changes in many national mapping 
agencies suggest that, since 1984 is not recent and tectonic movement does 
happen, the versions of the metadata will matter more going forward.

Simon, I don't think we're ready to conclude about recipies for macOS; 
certainly I am not confident about suggesting anything I cannot test on 
hardware before committing to a choice. CRAN Windows binaries now ship 
with PROJ 6.3.1 and GDAL 3.0.4, but so far we haven't seen user reaction. 
sf has been using these for some weeks, rgdal was only published built on 
these very recently. Maybe we've brought the house down and nobody has 
emerged from the rubble yet ... Let's see user response to the CRAN 
Windows binaries and consider a next move then? Again, without access to 
hardware, I'm rather stuck.

Best wishes,

Roger

>
> Cheers,
> Simon
>
>
>> On May 31, 2020, at 3:06 PM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>
>> They are all from Anaconda Python.  I used otool and that is indeed how 
>> they are set up (see below - and libgdal.26.dylib is the image it can't 
>> find) .  I tried DYLD_FALLBACK_LIBRARY_PATH also a little while ago and 
>> it didn't make any difference, and we are a the point where it is 
>> beyond where I really know things.
>>
>>> otool -D /Users/rmendels/anaconda3/lib/libgdal.26.dylib
>>> /Users/rmendels/anaconda3/lib/libgdal.26.dylib:
>>> @rpath/libgdal.26.dylib
>>
>>> otool -L /Users/rmendels/anaconda3/lib/libgdal.26.dylib
>>> /Users/rmendels/anaconda3/lib/libgdal.26.dylib:
>>> 	@rpath/libgdal.26.dylib (compatibility version 27.0.0, current version 27.4.0)
>>> 	@rpath/libtiledb.dylib (compatibility version 0.0.0, current version 0.0.0)
>>> 	@rpath/libpoppler.78.dylib (compatibility version 78.0.0, current version 78.0.0)
>>> 	@rpath/libjson-c.4.dylib (compatibility version 5.0.0, current version 5.0.0)
>>> (and a bunch more)
>>
>> I only mention these because they seem to have the complete set of PROJ,  GEOS and GDAL at the newer versions,  as well as the headers and *-config files.  I have not been able to find another place that has everything  (well perhaps brew has been updated,  but brew has messed up my system in the past and last thing on this list is that it has not.)  Also my usually source,  Kyngchaos is still at gdal2.4
>>
>> Chris suggested it was a permissions problem,  but to use sudo I would have to get set up on a different machine,  because on this machine I can only sudo as a different user,  and that user doesn't have the necessary libraries and packages,  and to set that up would be more work than I want to do right now.
>>
>> So I was just hoping that if I could get it to compile,  I could post what I did  (I realized posting the package wouldn't work because you would need the dynamic libraries) and others could also do so if so desired.  But I am pretty much at the point where I don't really understand what the next steps would be,  and to find out would take more effort that I want to put into it right now. So I was hoping you (or someone else with a lot of knowledge about compiling on the Mac) might have suggestions.
>>
>> Thanks,
>>
>> -Roy
>>
>> PS - I have some packages that use sp and sf,  want to make certain I can test against the most recent versions using the newer libraries.  I can see if errors are generated using some of the test platforms,  but if there are errors they don't allow me to get in and debug.
>>
>>
>>
>>> On May 30, 2020, at 7:40 PM, Simon Urbanek <simon.urbanek at R-project.org> wrote:
>>>
>>> Roy,
>>>
>>> where did you get the libraries? If they use rpath it's quite tricky - that is not how native libraries work on macOS. Also the setting on macOS is not LD_LIBRARY_PATH but DYLD_FALLBACK_LIBRARY_PATH and is typically not needed unless the library is not built properly since macOS offers better options.
>>>
>>> Cheers,
>>> Simon
>>>
>>>
>>>
>>>> On May 31, 2020, at 6:11 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>>>
>>>> Hi All:
>>>>
>>>> Okay after some fiddling I was able to get it to sort of successfully compile,  where I am having problems is in finding the dynamic libraries, such as I get this error:
>>>>
>>>>> dyld: Library not loaded: @rpath/libproj.19.dylib
>>>>
>>>> and
>>>>
>>>>> Error: package or namespace load failed for ?rgdal? in dyn.load(file, DLLpath = DLLpath, ...):
>>>>> unable to load shared object '/Users/rmendels/Library/R/4.0/library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so':
>>>>> dlopen(/Users/rmendels/Library/R/4.0/library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so, 6): Library not loaded: @rpath/libgdal.26.dylib
>>>>> Referenced from: /Users/rmendels/Library/R/4.0/library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so
>>>>> Reason: image not found
>>>>> Error: loading failed
>>>>
>>>> It has to do with these are defined in terms of @rpath.  I thought defining this in $LD_LIBRARY_PATH would do it,  but I have:
>>>>
>>>>> echo $LD_LIBRARY_PATH
>>>>> /Users/rmendels/Library/R/4.0/library:/Users/rmendels/anaconda3/lib
>>>>
>>>> I also tried setting 	$DYLD_LIBRARY_PATH same problem.  If someone can tell me how to set it so @rpath finds the dynamic libraries I might be able to get this to work.
>>>>
>>>> Thanks,
>>>>
>>>> -Roy
>>>>
>>>>
>>>>
>>>>> On May 30, 2020, at 8:04 AM, chris english <englishchristophera at gmail.com> wrote:
>>>>>
>>>>> my setup - albeit on 20.04 as reported by sf
>>>>>
>>>>>> library(sf)
>>>>> Linking to GEOS 3.9.0dev, GDAL 3.1.0, PROJ 7.0.1
>>>>>
>>>>> Note I'm using release gdal, that I none the less built from source as I had to enable Mr. Sid for some particular
>>>>> data. Couldn't get GDAL 3.2.*dev working but still toying around with it. Roger's discussion of the history of all
>>>>> of this on r-spatial and the path forward is very much worth the read as and relates to his following message here.
>>>>>
>>>>>
>>>>>
>>>>> On Sat, May 30, 2020 at 10:33 AM Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>>>> Yes thanks.  As I said in reply to Roger I am far from an expert in these things,  but if I can get it to build,  then I will try to post somewhere for others to use.
>>>>>
>>>>> -Roy
>>>>>
>>>>>> On May 30, 2020, at 7:03 AM, chris english <englishchristophera at gmail.com> wrote:
>>>>>>
>>>>>> Roy,
>>>>>> From a related prior post Roger shared this link to rgdal-1.5-9,  http://spatial.nhh.no/R/rgdal/ . I followed discussions
>>>>>> from the 'sf' github readme and purged all prior proj/geos/gdal iterations that have lingered around over the past five
>>>>>> years and built them from source on ubuntu 20.04. This upgrade to 20.04 was perhaps my first mistake in a month
>>>>>> long effort to bring back my full spatial capabilities as it doesn't become the official LTS until sometime mid this month.
>>>>>> I don't know how Anaconda packages and may require sym links or copying files from down in the depths to visible,
>>>>>> but it worked before and can be made to work again.
>>>>>> HTH-
>>>>>> Chris
>>>>>>
>>>>>> On Sat, May 30, 2020 at 8:08 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>>> On Fri, 29 May 2020, Thiago V. dos Santos wrote:
>>>>>>
>>>>>>> Dear Roger,
>>>>>>>
>>>>>>> Many thanks for the effort keeping rgdal up-to-date with proj6.
>>>>>>>
>>>>>>> I'd like to report that I am unable to install rgdal 1.5.8 on my macOS
>>>>>>> system. I am reporting this error here on the list because I thought it
>>>>>>> would be the best channel in terms of reaching future users experiencing
>>>>>>> the same error. Please apologize if my rationale is not right, and
>>>>>>> ignore this message.
>>>>>>>
>>>>>>> GDAL was installed via MacPorts and is at its latest version, 3.1.0 (at
>>>>>>> the time of this writing). Proj6 has also been installed via Macports.
>>>>>>>
>>>>>>> This is how I am trying to install it:
>>>>>>>
>>>>>>> export PKG_CONFIG_PATH=/opt/local/lib/proj6/lib/pkgconfig
>>>>>>> R
>>>>>>> install.packages('rgdal', type="source", configure.args=c(
>>>>>>>   '--with-proj-include=/opt/local/lib/proj6/include',
>>>>>>>   '--with-proj-lib=/opt/local/lib/proj6/lib'))
>>>>>>>
>>>>>>> and this is the output I get:
>>>>>>>
>>>>>>> R version 4.0.0 (2020-04-24) -- "Arbor Day"
>>>>>>> Copyright (C) 2020 The R Foundation for Statistical Computing
>>>>>>> Platform: x86_64-apple-darwin17.0 (64-bit)
>>>>>>>
>>>>>>>
>>>>>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>>>>>> You are welcome to redistribute it under certain conditions.
>>>>>>> Type 'license()' or 'licence()' for distribution details.
>>>>>>>
>>>>>>>
>>>>>>> Natural language support but running in an English locale
>>>>>>>
>>>>>>>
>>>>>>> R is a collaborative project with many contributors.
>>>>>>> Type 'contributors()' for more information and
>>>>>>> 'citation()' on how to cite R or R packages in publications.
>>>>>>>
>>>>>>>
>>>>>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>>>>>> 'help.start()' for an HTML browser interface to help.
>>>>>>> Type 'q()' to quit R.
>>>>>>>
>>>>>>>
>>>>>>>> install.packages('rgdal', type="source", configure.args=c(
>>>>>>> +      '--with-proj-include=/opt/local/lib/proj6/include',
>>>>>>> +      '--with-proj-lib=/opt/local/lib/proj6/lib'))
>>>>>>> Installing package into ?/Users/thiago/Documents/R-packages?
>>>>>>> (as ?lib? is unspecified)
>>>>>>>
>>>>>>>
>>>>>>>  trying URL 'https://cran.r-project.org/src/contrib/rgdal_1.5-8.tar.gz'
>>>>>>> Content type 'application/x-gzip' length 2299235 bytes (2.2 MB)
>>>>>>> ==================================================
>>>>>>> downloaded 2.2 MB
>>>>>>>
>>>>>>>
>>>>>>> * installing *source* package ?rgdal? ...
>>>>>>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>> ** using staged installation
>>>>>>> configure: R_HOME: /Library/Frameworks/R.framework/Resources
>>>>>>> configure: CC: /opt/local/bin/gcc
>>>>>>> configure: CXX: /opt/local/bin/g++
>>>>>>> configure: C++11 support available
>>>>>>> configure: rgdal: 1.5-8
>>>>>>> checking for /usr/bin/svnversion... yes
>>>>>>> configure: svn revision: 990
>>>>>>> checking for gdal-config... /opt/local/bin/gdal-config
>>>>>>> checking gdal-config usability... yes
>>>>>>> configure: GDAL: 3.1.0
>>>>>>> checking GDAL version >= 1.11.4... yes
>>>>>>> checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>> checking gdal: linking with --libs only... yes
>>>>>>> checking GDAL: gdal-config data directory readable... yes
>>>>>>> checking GDAL: /opt/local/share/gdal/stateplane.csv readable... yes
>>>>>>> configure: pkg-config proj exists, will use it
>>>>>>
>>>>>> So far so good, but you chose to override pkg-config proj by passing
>>>>>> configure arguments. You should let pkg-config proj provide those values.
>>>>>>
>>>>>>> configure: PROJ version: 6.3.2
>>>>>>> configure: proj CPP flags: -DPROJ_H_API -I/opt/local/lib/proj6/include
>>>>>>> configure: PROJ LIBS: -L/opt/local/lib/proj6/lib
>>>>>>> checking PROJ header API:... proj.h
>>>>>>> checking for gcc... /opt/local/bin/gcc
>>>>>>> checking whether the C compiler works... yes
>>>>>>> checking for C compiler default output file name... a.out
>>>>>>> checking for suffix of executables...
>>>>>>> checking whether we are cross compiling... no
>>>>>>> checking for suffix of object files... o
>>>>>>> checking whether we are using the GNU C compiler... yes
>>>>>>> checking whether /opt/local/bin/gcc accepts -g... yes
>>>>>>> checking for /opt/local/bin/gcc option to accept ISO C89... none needed
>>>>>>> checking how to run the C preprocessor... /opt/local/bin/gcc -E
>>>>>>> checking for grep that handles long lines and -e... /usr/bin/grep
>>>>>>> checking for egrep... /usr/bin/grep -E
>>>>>>> checking for ANSI C header files... rm: conftest.dSYM: is a directory
>>>>>>> rm: conftest.dSYM: is a directory
>>>>>>> yes
>>>>>>> checking for sys/types.h... yes
>>>>>>> checking for sys/stat.h... yes
>>>>>>> checking for stdlib.h... yes
>>>>>>> checking for string.h... yes
>>>>>>> checking for memory.h... yes
>>>>>>> checking for strings.h... yes
>>>>>>> checking for inttypes.h... yes
>>>>>>> checking for stdint.h... yes
>>>>>>> checking for unistd.h... yes
>>>>>>> checking proj.h usability... yes
>>>>>>> checking proj.h presence... yes
>>>>>>> checking for proj.h... yes
>>>>>>
>>>>>> Also OK.
>>>>>>
>>>>>>> checking for proj_context_create in -lproj... no
>>>>>>> configure: error: proj_context_create not found in libproj.
>>>>>>
>>>>>> The directory where libproj should be does not contain it - whether you
>>>>>> got it wrong, pkg-config got it wrong, or for some other reason, the
>>>>>> library was not found.
>>>>>>
>>>>>>> ERROR: configuration failed for package ?rgdal?
>>>>>>> * removing ?/Users/thiago/Documents/R-packages/rgdal?
>>>>>>> * restoring previous ?/Users/thiago/Documents/R-packages/rgdal?
>>>>>>>
>>>>>>>
>>>>>>> The downloaded source packages are in
>>>>>>>  ?/private/var/folders/_z/01gg71zs19g816v6m2dddt8w0000gn/T/RtmpvZAChj/downloaded_packages?
>>>>>>> Warning message:
>>>>>>> In install.packages("rgdal", type = "source", configure.args = c("--with-proj-include=/opt/local/lib/proj6/include",  :
>>>>>>> installation of package ?rgdal? had non-zero exit status
>>>>>>>
>>>>>>> I found this error to be quite mysterious, and could not find any
>>>>>>> previous discussion about it.
>>>>>>
>>>>>> Try to avoid googling, it is usually misleading. Running ./configure in
>>>>>> the untarred source package directory, and running ./configure --help to
>>>>>> show the arguments to configure can be much more helpful. Crucially, they
>>>>>> are up to date, while most search hits are old, and they are ordered by
>>>>>> hit counts, which is certainly no guarantee of precision.
>>>>>>
>>>>>>>
>>>>>>> Are you familiar with it? Is there any other argument that I can pass to
>>>>>>> install.packages to solve it?
>>>>>>
>>>>>> Try not setting configure arguments and let pkg-config proj do the work if
>>>>>> you feel you can trust it. If, however, you have multiple installs of GDAL
>>>>>> and/or PROJ, the proj.pc file may point to a deleted install. Download and
>>>>>> untar the source package, and run just ./configure with its argumments, or
>>>>>> setting PKG_CONFIG_PATH= until you find a recipe that works that far.
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>> Greetings,
>>>>>>> -- Thiago V. dos Santos
>>>>>>>
>>>>>>> ThiagoDosSantos.com
>>>>>>> MudancasClimaticasBrasil.com
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> On Thursday, May 28, 2020, 08:53:50 AM GMT-3, Roger Bivand <roger.bivand at nhh.no> wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> With sp 1.4-2 and rgdal 1.5-8, those using GDAL 3 and PROJ 6 (including
>>>>>>> users of the CRAN Windows binary when it comes) will be part of the big
>>>>>>> migration to WKT2 from Proj4 strings for CRS representation. See
>>>>>>>
>>>>>>> https://cran.r-project.org/web/packages/rgdal/vignettes/CRS_projections_transformations.html
>>>>>>>
>>>>>>> or for a better rendering of "\phi" and bib-handling:
>>>>>>>
>>>>>>> https://rgdal.r-forge.r-project.org/articles/CRS_projections_transformations.html
>>>>>>>
>>>>>>> for background and https://www.r-spatial.org/r/2020/03/17/wkt.html for the
>>>>>>> full sf and sp story.
>>>>>>>
>>>>>>> You will see lots of warnings, they should grab your attention, that is
>>>>>>> what they are for. We need your attention to be as sure as we can be that
>>>>>>> your results - if affected by the transition - have been checked by you.
>>>>>>>
>>>>>>> I plan to flip the warnings to default off from rgdal 1.6-*, and sp 1.5-*.
>>>>>>> In some weeks but before flipping the defaults, I'll follow up showing
>>>>>>> ways of muting them, but we really need to be confident that this
>>>>>>> necessary and future-proofing change isn't silently destroying your work
>>>>>>> first. So please don't treat the many warnings as just pesky and nagging -
>>>>>>> they are priming your immune system to check for unwanted consequences of
>>>>>>> your legacy CRS representation choices.
>>>>>>>
>>>>>>> I'd also like to thank the maintainers of packages importing
>>>>>>> from/depending on sp/rgdal for largely positive responses to issues raised
>>>>>>> and emails sent, often less polite than they might have been, but grabbing
>>>>>>> attention was more important. From over 70 broken reverse dependency
>>>>>>> packages we are now well under 20, and I've contacted all of those, with
>>>>>>> only a couple not responding. Edzer has seen similar responsiveness for
>>>>>>> the parallel migration of sf.
>>>>>>>
>>>>>>> Enjoy!
>>>>>>>
>>>>>>> Roger
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>> **********************
>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>> **********************
>>>>> Roy Mendelssohn
>>>>> Supervisory Operations Research Analyst
>>>>> NOAA/NMFS
>>>>> Environmental Research Division
>>>>> Southwest Fisheries Science Center
>>>>> ***Note new street address***
>>>>> 110 McAllister Way
>>>>> Santa Cruz, CA 95060
>>>>> Phone: (831)-420-3666
>>>>> Fax: (831) 420-3980
>>>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>>>
>>>>> "Old age and treachery will overcome youth and skill."
>>>>> "From those who have been given much, much will be expected"
>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>
>>>>
>>>> **********************
>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>> **********************
>>>> Roy Mendelssohn
>>>> Supervisory Operations Research Analyst
>>>> NOAA/NMFS
>>>> Environmental Research Division
>>>> Southwest Fisheries Science Center
>>>> ***Note new street address***
>>>> 110 McAllister Way
>>>> Santa Cruz, CA 95060
>>>> Phone: (831)-420-3666
>>>> Fax: (831) 420-3980
>>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>>
>>>> "Old age and treachery will overcome youth and skill."
>>>> "From those who have been given much, much will be expected"
>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>
>>>
>>
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From rob00x @end|ng |rom gm@||@com  Tue Jun  2 17:25:27 2020
From: rob00x @end|ng |rom gm@||@com (Robin Lovelace)
Date: Tue, 2 Jun 2020 16:25:27 +0100
Subject: [R-sig-Geo] rgdal: About the new gdal3 and proj >=6 condition
In-Reply-To: <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>
References: <54DFB961-C4BB-4937-90AF-450B771F1F21@gmail.com>
 <alpine.LFD.2.22.394.2005291421380.3227460@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005291837350.3230794@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>
Message-ID: <CAF16KkVcSo6EktDh_Uh7SkbcRNaDCke321HH6Oi0UoXq84f5FQ@mail.gmail.com>

Confirmed: this worked perfectly for me.

Video evidence that this is fixed:
https://asciinema.org/a/zPQFbI6Q01oqUy1HRauCjLUXY

Thanks Roger!

Robin

On Tue, Jun 2, 2020 at 4:00 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> Brian Ripley (thanks!) provided a patch for rgdal's configure.ac, and the
> R-forge build and check processes now succeed, so please try to install
> either downloading
> http://download.r-forge.r-project.org/src/contrib/rgdal_1.5-9.tar.gz and
> installing from the command line (after running R CMD check), or
> install.packages("rgdal", repos="http://R-Forge.R-project.org").
>
> Remember that if GDAL is < 3, and PROJ >= 6, you need the configure
> argument: --configure-args=--with-proj_api=proj_api.h.
>
> Roger
>
> On Sun, 31 May 2020, Roger Bivand wrote:
>
> > Fresh version of rgdal rev 995 on link and R-forge, with more tweaks to
> the
> > configure file. Please test.
> >
> > Roger
> >
> > On Fri, 29 May 2020, Roger Bivand wrote:
> >
> >>  I have put a tarball, built without vignettes with GDAL 2.2.4 and PROJ
> >>  7.0.1 that passes CMD check (with warnings for missing vignettes) on:
> >>
> >>  http://spatial.nhh.no/R/rgdal/gdal_1.5-9.tar.gz
> >>
> >>  It involves code copying to provide duplicated functions in three
> >>  settings:
> >>
> >>  PROJ < 6 & GDAL < 3
> >> PROJ >  = 6 & GDAL >= 3
> >> PROJ >  = 6 & GDAL < 3 (your homebrew case)
> >>
> >>  You need the configure argument:
> >>  --configure-args=--with-proj_api=proj_api.h.
> >>  Without the argument, you now get directed to use it.
> >>
> >>  For now I've dropped the configure tests for sqlite3, curl and tiff;
> works
> >>  for me but may not work for you.
> >>
> >>  Please make the output of:
> >>
> >>  R CMD check
> --install-args="--configure-args=--with-proj_api=proj_api.h"
> >>  rgdal_1.5-9.tar.gz
> >>
> >>  available ASAP. I count on an immediate response.
> >>
> >>  Roger
> >>
> >>  On Fri, 29 May 2020, Roger Bivand wrote:
> >>
> >>>   On Fri, 29 May 2020, Patrick Schratz wrote:
> >>>
> >>>>    The just released rgdal v1.5.8 requires gdal >= 3 when proj >= 6 is
> >>>>    present. It does not even install the package if this condition is
> not
> >>>>    met
> >>>>    but errors during linking.
> >>>
> >>>   Please document with the output of 00install.out from R CMD check
> >>>   rgdal_1.5-8.tar.gz, and pkg-config proj --modversion, gdalinfo
> --version
> >>>   with system details.
> >>>
> >>>   Yes, PROJ >= 6 makes no sense without GDAL >= 3; GDAL 3 makes no
> sense
> >>>   with PROJ < 6. GDAL 3 with PROJ < 6 uses the old proj_api.h API and
> the
> >>>   old metadata structure with Proj4 string degradation; GDAL < 3 with
> PROJ
> >>>>   = 6 must use the deprecated API and the new metadata structure.
> >>>
> >>>>
> >>>>    I could not find any sources in the web or in the announcement
> post of
> >>>>    v1.5.8 why this condition was enforced so strictly.
> >>>>    Does it cause unwanted results?
> >>>
> >>>   Yes, definitely. GDAL 3 was released as 3, not 2.5, to stress the
> >>>   complete
> >>>   break between GDAL 2 (with PROJ <= 5) and GDAL >= 3 (with PROJ >= 6)
> >>>   after
> >>>   GDAL barnraising. So:
> >>>
> >>>             PROJ
> >>>             < 6 >= 6
> >>>   GDAL < 3   OK   NO
> >>>    >   = 3   NO   OK
> >>>
> >>>
> >>>
> >>>>    If so, then there is a big issue since the ?gdal2 and proj >= 6?
> >>>>    combination has been used by many people in the past already.
> >>>
> >>>   No good precedent, just binary packagers protecting slow downstream
> >>>   adaptation.
> >>>
> >>>>    I haven?t tracked down for how long this situation was on the
> market
> >>>>    already.
> >>>>    Also the {sf} package is still installable with this combination
> and I
> >>>>    am not aware of any warnings/issues that came up due to this so
> far.
> >>>>
> >>>
> >>>   rgdal is a much older package and has much more older code that needs
> >>>   this
> >>>   protection. It is possible to accommodate the no-go areas, but I'd
> >>>   really
> >>>   value patches to R-forge, as I cannot check multiple PROJ/GDAL
> version
> >>>   combinations just because someone isn't up to speed.
> >>>
> >>>>    It further causes complete breakage for people relying on the
> homebrew
> >>>>    package manager on macOS since current versions are gdal v2.2.4 and
> >>>>    proj
> >>>>    7.0.1.
> >>>
> >>>   They should never have gone beyond PROJ 5 if they are stuck on GDAL.
> >>>   PROJ
> >>>   7 is a very different animal.
> >>>
> >>>>    The update to gdal3 is blocked since months due to an
> incompatibility
> >>>>    with `liblas` (https://github.com/libLAS/libLAS/issues/164).
> Reading
> >>>>    the
> >>>>    issue, it looks unclear when this issue will be resolved.
> >>>>    The alternative osgeo4mac tap holds formula that is unstable and
> >>>>    somewhat broken. One cannot link rgdal with the current gdal v3.0.1
> >>>>    from
> >>>>    osgeo4mac.
> >>>>
> >>>>    This incompatibility with homebrew-core formula leads to further
> >>>>    issues
> >>>>    for CI tests that rely on the spatial homebrew stack for macOS
> builds.
> >>>>
> >>>>    All of this is really unfortunate and I am wondering if this was a
> >>>>    known
> >>>>    factor when introducing this condition in the new release.
> >>>>    Unfortunately rgdal is not hosted on any Git* provider (there is
> just
> >>>>    the CRAN mirror with not much information about the recent changes)
> >>>>    and
> >>>>    it is unclear/untransparent to me if there is a continuous
> integration
> >>>>    setup at all for this package.
> >>>
> >>>   Do not require me to leave the excellent SVN service on R-forge.
> Provide
> >>>   patches there.
> >>>
> >>>>    I hope this is not another case in the series ?I do not like
> operating
> >>>>    system XY and hence I do not test on it? which was seen recently in
> >>>>    another package. That?s what CI is for and the responsibility of
> >>>>    package authors.
> >>>>
> >>>
> >>>   I run and develop on Fedora, I  have no access to OSX, and the
> current
> >>>   release was fully checked with ~ 900 revdeps repeatedly since
> November
> >>>   on
> >>>   successive older and newer versions of PROJ and GDAL. I blocked new
> PROJ
> >>>   with old GDAL recently to simplify development. CI is only as good as
> >>>   the
> >>>   scripts, I am completely sure that repeated revdep testing and
> reading
> >>>   the
> >>>   output is superior.
> >>>
> >>>>    Also one should be aware that not every rgdal user is member of
> this
> >>>>    mailing list (I guess not even 5%) and many people in production
> will
> >>>>    face this error during install, most of them without any clue what
> to
> >>>>    do
> >>>>    or an idea why this was raised.
> >>>>
> >>>
> >>>   There has been plenty of information given about the CRS changes.
> rgdal
> >>>   could simply have been abandoned by me, and all  those production
> >>>   volunteers might have fixed things, but I never hear anything at all.
> >>>
> >>>>    In summary it would be great if
> >>>>
> >>>>    - There would be more detailed information on the introduction of
> the
> >>>>    new condition
> >>>>    - Awareness of state-of-the-art platform related library versions
> >>>>    before
> >>>>    making such a release
> >>>>    - Transparency/Existence of a cross-platform build process
> >>>>    - If the incompatibility is just due to some features not being
> >>>>    accessible with this configuration, I suggest to raise a warning
> >>>>    during
> >>>>    package load but not prevent the package from installing in the
> first
> >>>>    place
> >>>>    - A version-based NEWS file would be available. Currently one only
> >>>>    sees
> >>>>    a revision-based Changelog:
> >>>>    https://cran.r-project.org/web/packages/rgdal/ChangeLog
> >>>>
> >>>>    I am well aware that I am indirectly criticising (hopefully in a
> >>>>    constructive way) the transparency and release process here, for
> which
> >>>>    I
> >>>>    will probably get a rough response.
> >>>>    However, if that leads to more robustness and transparency in
> future
> >>>>    release, I am fine with this.
> >>>>
> >>>>    A quick patch release resolving the breakage would be highly
> >>>>    appreciated.
> >>>
> >>>   Only with community imput. what you ask is not needed, just extra
> >>>   complexity. Please provide patches, or accept my invitation to join
> the
> >>>   R-forge project and commit your fixes directly. I can see how to do
> it,
> >>>   but I don't think it makes sense, and your messsage has not motivated
> >>>   me,
> >>>   to be honest. I'm prioritizing working with CRAN to iron out reverse
> >>>   dependency problems.
> >>>
> >>>   Roger
> >>>
> >>>>
> >>>>    Best, Patrick
> >>>>     [[alternative HTML version deleted]]
> >>>>
> >>>>    _______________________________________________
> >>>>    R-sig-Geo mailing list
> >>>>    R-sig-Geo at r-project.org
> >>>>    https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>
> >>>
> >>>
> >>
> >>
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  2 18:29:37 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 2 Jun 2020 18:29:37 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>

On Tue, 2 Jun 2020, Kent Johnson wrote:

> rtree uses Euclidean distance so the points should be in a coordinate
> system where this makes sense at least as a reasonable approximation.

I tried the original example:

remotes::install_github("hunzikp/rtree")
library(spData)
library(sf)
projdata<-st_transform(nz_height, 32759)
library(rtree)
pts <- st_coordinates(projdata)
rt <- RTree(st_coordinates(projdata))
bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
wd1 <- withinDistance(rt, pts, bufferR[1])

but unfortunately failed (maybe newer Boost headers than yours?):

Error in UseMethod("withinDistance", rTree) :
   no applicable method for 'withinDistance' applied to an object of class 
"c('list', 'RTree')"

Going back to the last century:

library(spdep)
bds <- c(0, bufferR)
wd1 <- dnearneigh(pts, bds[1], bds[2])
wd2 <- dnearneigh(pts, bds[2], bds[3])
wd3 <- dnearneigh(pts, bds[3], bds[4])
wd4 <- dnearneigh(pts, bds[4], bds[5])

gives four neighbour objects. A neighbour object is an n-list of integer 
vectors (0 encodes no neighbours), which you can use to find the rows to 
copy out to your output object.

Does this get you started?

Roger

>
> Kent
>
> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>
>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>> To: r-sig-geo at r-project.org
>>>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
>>>>         points within specified radii (distances) for each point in a
>> given
>>>>         points data set.
>>>>
>>>
>>>
>>>> Hello,
>>>> I have data set of about 3400 location points with which I am trying to
>>>> generate data of each point and their neighbors within defined radii
>> (eg,
>>>> 0.25, 1, and 3 miles).
>>>>
>>>
>>> The rtree package is very fast and memory-efficient for within-distance
>>> calculations.
>>> https://github.com/hunzikp/rtree
>>
>> Thanks! Does this also apply when the input points are in geographical
>> coordinates?
>>
>> Roger
>>
>>>
>>> Kent Johnson
>>> Cambridge, MA
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From |omn@v@@|@ @end|ng |rom gm@||@com  Wed Jun  3 00:19:00 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Tue, 2 Jun 2020 17:19:00 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
Message-ID: <CAKBoCbF3oq9XeT=-nGEgbNUnofZ3c-0UASmQ5mqnJqMFzOJ1Tg@mail.gmail.com>

I tried looking at rtree package and even run the example at
https://github.com/hunzikp/rtree but it gives me the same error message
Error in UseMethod("withinDistance", rTree) :
   no applicable method for 'withinDistance' applied to an object of class
"c('list', 'RTree')"
That is strange given the page shows it was successful.

Regarding the library(spdep) and using dnearneigh(), I read through the
examples here https://r-spatial.github.io/spdep/reference/dnearneigh.html
but I seem to have a challenge as to how to get the output from wd1,wd2,
wd3, wd4  to my output object as in dataout.
For example when I call wd1, I get :
> wd1
Neighbour list object:
Number of regions: 101
Number of nonzero links: 38
Percentage nonzero weights: 0.3725125
Average number of links: 0.3762376
67 regions with no links:


How do I get the original point IDs and their respective neighbors IDs?

Lom





On Tue, Jun 2, 2020 at 11:29 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 2 Jun 2020, Kent Johnson wrote:
>
> > rtree uses Euclidean distance so the points should be in a coordinate
> > system where this makes sense at least as a reasonable approximation.
>
> I tried the original example:
>
> remotes::install_github("hunzikp/rtree")
> library(spData)
> library(sf)
> projdata<-st_transform(nz_height, 32759)
> library(rtree)
> pts <- st_coordinates(projdata)
> rt <- RTree(st_coordinates(projdata))
> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> wd1 <- withinDistance(rt, pts, bufferR[1])
>
> but unfortunately failed (maybe newer Boost headers than yours?):
>
> Error in UseMethod("withinDistance", rTree) :
>    no applicable method for 'withinDistance' applied to an object of class
> "c('list', 'RTree')"
>
> Going back to the last century:
>
> library(spdep)
> bds <- c(0, bufferR)
> wd1 <- dnearneigh(pts, bds[1], bds[2])
> wd2 <- dnearneigh(pts, bds[2], bds[3])
> wd3 <- dnearneigh(pts, bds[3], bds[4])
> wd4 <- dnearneigh(pts, bds[4], bds[5])
>
> gives four neighbour objects. A neighbour object is an n-list of integer
> vectors (0 encodes no neighbours), which you can use to find the rows to
> copy out to your output object.
>
> Does this get you started?
>
> Roger
>
> >
> > Kent
> >
> > On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>
> >>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>> To: r-sig-geo at r-project.org
> >>>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
> >>>>         points within specified radii (distances) for each point in a
> >> given
> >>>>         points data set.
> >>>>
> >>>
> >>>
> >>>> Hello,
> >>>> I have data set of about 3400 location points with which I am trying
> to
> >>>> generate data of each point and their neighbors within defined radii
> >> (eg,
> >>>> 0.25, 1, and 3 miles).
> >>>>
> >>>
> >>> The rtree package is very fast and memory-efficient for within-distance
> >>> calculations.
> >>> https://github.com/hunzikp/rtree
> >>
> >> Thanks! Does this also apply when the input points are in geographical
> >> coordinates?
> >>
> >> Roger
> >>
> >>>
> >>> Kent Johnson
> >>> Cambridge, MA
> >>>
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From kent3737 @end|ng |rom gm@||@com  Wed Jun  3 03:02:00 2020
From: kent3737 @end|ng |rom gm@||@com (Kent Johnson)
Date: Tue, 2 Jun 2020 21:02:00 -0400
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
Message-ID: <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>

Roger's example works for me and gives a list of length 101. I did have
some issues that were resolved by updating packages. I'm using R 3.6.3 on
macOS 10.15.4. I also use rtree successfully on Windows 10 with R 3.6.3.

Kent

On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 2 Jun 2020, Kent Johnson wrote:
>
> > rtree uses Euclidean distance so the points should be in a coordinate
> > system where this makes sense at least as a reasonable approximation.
>
> I tried the original example:
>
> remotes::install_github("hunzikp/rtree")
> library(spData)
> library(sf)
> projdata<-st_transform(nz_height, 32759)
> library(rtree)
> pts <- st_coordinates(projdata)
> rt <- RTree(st_coordinates(projdata))
> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> wd1 <- withinDistance(rt, pts, bufferR[1])
>
> but unfortunately failed (maybe newer Boost headers than yours?):
>
> Error in UseMethod("withinDistance", rTree) :
>    no applicable method for 'withinDistance' applied to an object of class
> "c('list', 'RTree')"
>
> >
> > Kent
> >
> > On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>
> >>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>> To: r-sig-geo at r-project.org
> >>>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
> >>>>         points within specified radii (distances) for each point in a
> >> given
> >>>>         points data set.
> >>>>
> >>>
> >>>
> >>>> Hello,
> >>>> I have data set of about 3400 location points with which I am trying
> to
> >>>> generate data of each point and their neighbors within defined radii
> >> (eg,
> >>>> 0.25, 1, and 3 miles).
> >>>>
> >>>
> >>> The rtree package is very fast and memory-efficient for within-distance
> >>> calculations.
> >>> https://github.com/hunzikp/rtree
> >>
> >> Thanks! Does this also apply when the input points are in geographical
> >> coordinates?
> >>
> >> Roger
> >>
> >>>
> >>> Kent Johnson
> >>> Cambridge, MA
> >>>
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From |omn@v@@|@ @end|ng |rom gm@||@com  Wed Jun  3 06:20:43 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Tue, 2 Jun 2020 23:20:43 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
Message-ID: <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>

I had the errors with rtree using R 3.6.3. I have since changed to R 4.0.0
but I got the same error.

And  yes, for Roger's example, I have the objects wd1, ... wd4, all with
length 101. I think my difficulty is my inability to output the list
detailing the point IDs t50_fid.

---------
Lom

On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com> wrote:

> Roger's example works for me and gives a list of length 101. I did have
> some issues that were resolved by updating packages. I'm using R 3.6.3 on
> macOS 10.15.4. I also use rtree successfully on Windows 10 with R 3.6.3.
>
> Kent
>
> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>
>> > rtree uses Euclidean distance so the points should be in a coordinate
>> > system where this makes sense at least as a reasonable approximation.
>>
>> I tried the original example:
>>
>> remotes::install_github("hunzikp/rtree")
>> library(spData)
>> library(sf)
>> projdata<-st_transform(nz_height, 32759)
>> library(rtree)
>> pts <- st_coordinates(projdata)
>> rt <- RTree(st_coordinates(projdata))
>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>
>> but unfortunately failed (maybe newer Boost headers than yours?):
>>
>> Error in UseMethod("withinDistance", rTree) :
>>    no applicable method for 'withinDistance' applied to an object of
>> class
>> "c('list', 'RTree')"
>>
>> >
>> > Kent
>> >
>> > On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>> >
>> >> On Tue, 2 Jun 2020, Kent Johnson wrote:
>> >>
>> >>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>> >>>> From: Lom Navanyo <lomnavasia at gmail.com>
>> >>>> To: r-sig-geo at r-project.org
>> >>>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
>> >>>>         points within specified radii (distances) for each point in a
>> >> given
>> >>>>         points data set.
>> >>>>
>> >>>
>> >>>
>> >>>> Hello,
>> >>>> I have data set of about 3400 location points with which I am trying
>> to
>> >>>> generate data of each point and their neighbors within defined radii
>> >> (eg,
>> >>>> 0.25, 1, and 3 miles).
>> >>>>
>> >>>
>> >>> The rtree package is very fast and memory-efficient for
>> within-distance
>> >>> calculations.
>> >>> https://github.com/hunzikp/rtree
>> >>
>> >> Thanks! Does this also apply when the input points are in geographical
>> >> coordinates?
>> >>
>> >> Roger
>> >>
>> >>>
>> >>> Kent Johnson
>> >>> Cambridge, MA
>> >>>
>> >>>       [[alternative HTML version deleted]]
>> >>>
>> >>> _______________________________________________
>> >>> R-sig-Geo mailing list
>> >>> R-sig-Geo at r-project.org
>> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>>
>> >>
>> >> --
>> >> Roger Bivand
>> >> Department of Economics, Norwegian School of Economics,
>> >> Helleveien 30, N-5045 Bergen, Norway.
>> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> >> https://orcid.org/0000-0003-2392-6140
>> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>> >>
>> >
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jun  3 15:18:19 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 3 Jun 2020 15:18:19 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>

On Wed, 3 Jun 2020, Lom Navanyo wrote:

> I had the errors with rtree using R 3.6.3. I have since changed to R 4.0.0
> but I got the same error.
>
> And  yes, for Roger's example, I have the objects wd1, ... wd4, all with
> length 101. I think my difficulty is my inability to output the list
> detailing the point IDs t50_fid.

library(spData)
library(sf)
projdata<-st_transform(nz_height, 32759)
pts <- st_coordinates(projdata)
library(spdep)
bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
bds <- c(0, bufferR)
wd1 <- dnearneigh(pts, bds[1], bds[2])
wd2 <- dnearneigh(pts, bds[2], bds[3])
wd3 <- dnearneigh(pts, bds[3], bds[4])
wd4 <- dnearneigh(pts, bds[4], bds[5])
sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3, sn_band4))
class(data_out) <- "data.frame"
table(data_out$band)
data_out$ID_from <- projdata$t50_fid[data_out$from]
data_out$ID_to <- projdata$t50_fid[data_out$to]
data_out$elev_from <- projdata$elevation[data_out$from]
data_out$elev_to <- projdata$elevation[data_out$to]
str(data_out)

The "spatial.neighbour" representation was that used in the S-Plus 
SpatialStats module, with "from" and "to" columns, and here drops 
no-neighbour cases gracefully. So listw2sn() comes in useful 
for creating the output, and from there, just look-up in the 
input data.frame. Observations here cannot be their own neighbours.

It would be relevant to know why you need these, are you looking at 
variogram clouds?

Hope this clarifies,

Roger

>
> ---------
> Lom
>
> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com> wrote:
>
>> Roger's example works for me and gives a list of length 101. I did have
>> some issues that were resolved by updating packages. I'm using R 3.6.3 on
>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R 3.6.3.
>>
>> Kent
>>
>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>
>>>> rtree uses Euclidean distance so the points should be in a coordinate
>>>> system where this makes sense at least as a reasonable approximation.
>>>
>>> I tried the original example:
>>>
>>> remotes::install_github("hunzikp/rtree")
>>> library(spData)
>>> library(sf)
>>> projdata<-st_transform(nz_height, 32759)
>>> library(rtree)
>>> pts <- st_coordinates(projdata)
>>> rt <- RTree(st_coordinates(projdata))
>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>
>>> but unfortunately failed (maybe newer Boost headers than yours?):
>>>
>>> Error in UseMethod("withinDistance", rTree) :
>>>    no applicable method for 'withinDistance' applied to an object of
>>> class
>>> "c('list', 'RTree')"
>>>
>>>>
>>>> Kent
>>>>
>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>>
>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>
>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>> To: r-sig-geo at r-project.org
>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of neighboring
>>>>>>>         points within specified radii (distances) for each point in a
>>>>> given
>>>>>>>         points data set.
>>>>>>>
>>>>>>
>>>>>>
>>>>>>> Hello,
>>>>>>> I have data set of about 3400 location points with which I am trying
>>> to
>>>>>>> generate data of each point and their neighbors within defined radii
>>>>> (eg,
>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>
>>>>>>
>>>>>> The rtree package is very fast and memory-efficient for
>>> within-distance
>>>>>> calculations.
>>>>>> https://github.com/hunzikp/rtree
>>>>>
>>>>> Thanks! Does this also apply when the input points are in geographical
>>>>> coordinates?
>>>>>
>>>>> Roger
>>>>>
>>>>>>
>>>>>> Kent Johnson
>>>>>> Cambridge, MA
>>>>>>
>>>>>>       [[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>> https://orcid.org/0000-0003-2392-6140
>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @bdou|@ye@@r @end|ng |rom gm@||@com  Wed Jun  3 15:38:42 2020
From: @bdou|@ye@@r @end|ng |rom gm@||@com (Abdoulaye Sarr)
Date: Wed, 3 Jun 2020 13:38:42 +0000
Subject: [R-sig-Geo] rgdal: About the new gdal3 and proj >=6 condition
In-Reply-To: <CAF16KkVcSo6EktDh_Uh7SkbcRNaDCke321HH6Oi0UoXq84f5FQ@mail.gmail.com>
References: <54DFB961-C4BB-4937-90AF-450B771F1F21@gmail.com>
 <alpine.LFD.2.22.394.2005291421380.3227460@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005291837350.3230794@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>
 <CAF16KkVcSo6EktDh_Uh7SkbcRNaDCke321HH6Oi0UoXq84f5FQ@mail.gmail.com>
Message-ID: <CAN=6O0JNKtdepP9swPV2aujATqPsCFGfN2w4=q5AePJAsxkVnw@mail.gmail.com>

Have a problem with needed gdal version on mac

On Tue, Jun 2, 2020 at 4:04 PM Robin Lovelace <rob00x at gmail.com> wrote:

> Confirmed: this worked perfectly for me.
>
> Video evidence that this is fixed:
> https://asciinema.org/a/zPQFbI6Q01oqUy1HRauCjLUXY
>
> Thanks Roger!
>
> Robin
>
> On Tue, Jun 2, 2020 at 4:00 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> > Brian Ripley (thanks!) provided a patch for rgdal's configure.ac, and
> the
> > R-forge build and check processes now succeed, so please try to install
> > either downloading
> > http://download.r-forge.r-project.org/src/contrib/rgdal_1.5-9.tar.gz and
> > installing from the command line (after running R CMD check), or
> > install.packages("rgdal", repos="http://R-Forge.R-project.org").
> >
> > Remember that if GDAL is < 3, and PROJ >= 6, you need the configure
> > argument: --configure-args=--with-proj_api=proj_api.h.
> >
> > Roger
> >
> > On Sun, 31 May 2020, Roger Bivand wrote:
> >
> > > Fresh version of rgdal rev 995 on link and R-forge, with more tweaks to
> > the
> > > configure file. Please test.
> > >
> > > Roger
> > >
> > > On Fri, 29 May 2020, Roger Bivand wrote:
> > >
> > >>  I have put a tarball, built without vignettes with GDAL 2.2.4 and
> PROJ
> > >>  7.0.1 that passes CMD check (with warnings for missing vignettes) on:
> > >>
> > >>  http://spatial.nhh.no/R/rgdal/gdal_1.5-9.tar.gz
> > >>
> > >>  It involves code copying to provide duplicated functions in three
> > >>  settings:
> > >>
> > >>  PROJ < 6 & GDAL < 3
> > >> PROJ >  = 6 & GDAL >= 3
> > >> PROJ >  = 6 & GDAL < 3 (your homebrew case)
> > >>
> > >>  You need the configure argument:
> > >>  --configure-args=--with-proj_api=proj_api.h.
> > >>  Without the argument, you now get directed to use it.
> > >>
> > >>  For now I've dropped the configure tests for sqlite3, curl and tiff;
> > works
> > >>  for me but may not work for you.
> > >>
> > >>  Please make the output of:
> > >>
> > >>  R CMD check
> > --install-args="--configure-args=--with-proj_api=proj_api.h"
> > >>  rgdal_1.5-9.tar.gz
> > >>
> > >>  available ASAP. I count on an immediate response.
> > >>
> > >>  Roger
> > >>
> > >>  On Fri, 29 May 2020, Roger Bivand wrote:
> > >>
> > >>>   On Fri, 29 May 2020, Patrick Schratz wrote:
> > >>>
> > >>>>    The just released rgdal v1.5.8 requires gdal >= 3 when proj >= 6
> is
> > >>>>    present. It does not even install the package if this condition
> is
> > not
> > >>>>    met
> > >>>>    but errors during linking.
> > >>>
> > >>>   Please document with the output of 00install.out from R CMD check
> > >>>   rgdal_1.5-8.tar.gz, and pkg-config proj --modversion, gdalinfo
> > --version
> > >>>   with system details.
> > >>>
> > >>>   Yes, PROJ >= 6 makes no sense without GDAL >= 3; GDAL 3 makes no
> > sense
> > >>>   with PROJ < 6. GDAL 3 with PROJ < 6 uses the old proj_api.h API and
> > the
> > >>>   old metadata structure with Proj4 string degradation; GDAL < 3 with
> > PROJ
> > >>>>   = 6 must use the deprecated API and the new metadata structure.
> > >>>
> > >>>>
> > >>>>    I could not find any sources in the web or in the announcement
> > post of
> > >>>>    v1.5.8 why this condition was enforced so strictly.
> > >>>>    Does it cause unwanted results?
> > >>>
> > >>>   Yes, definitely. GDAL 3 was released as 3, not 2.5, to stress the
> > >>>   complete
> > >>>   break between GDAL 2 (with PROJ <= 5) and GDAL >= 3 (with PROJ >=
> 6)
> > >>>   after
> > >>>   GDAL barnraising. So:
> > >>>
> > >>>             PROJ
> > >>>             < 6 >= 6
> > >>>   GDAL < 3   OK   NO
> > >>>    >   = 3   NO   OK
> > >>>
> > >>>
> > >>>
> > >>>>    If so, then there is a big issue since the ?gdal2 and proj >= 6?
> > >>>>    combination has been used by many people in the past already.
> > >>>
> > >>>   No good precedent, just binary packagers protecting slow downstream
> > >>>   adaptation.
> > >>>
> > >>>>    I haven?t tracked down for how long this situation was on the
> > market
> > >>>>    already.
> > >>>>    Also the {sf} package is still installable with this combination
> > and I
> > >>>>    am not aware of any warnings/issues that came up due to this so
> > far.
> > >>>>
> > >>>
> > >>>   rgdal is a much older package and has much more older code that
> needs
> > >>>   this
> > >>>   protection. It is possible to accommodate the no-go areas, but I'd
> > >>>   really
> > >>>   value patches to R-forge, as I cannot check multiple PROJ/GDAL
> > version
> > >>>   combinations just because someone isn't up to speed.
> > >>>
> > >>>>    It further causes complete breakage for people relying on the
> > homebrew
> > >>>>    package manager on macOS since current versions are gdal v2.2.4
> and
> > >>>>    proj
> > >>>>    7.0.1.
> > >>>
> > >>>   They should never have gone beyond PROJ 5 if they are stuck on
> GDAL.
> > >>>   PROJ
> > >>>   7 is a very different animal.
> > >>>
> > >>>>    The update to gdal3 is blocked since months due to an
> > incompatibility
> > >>>>    with `liblas` (https://github.com/libLAS/libLAS/issues/164).
> > Reading
> > >>>>    the
> > >>>>    issue, it looks unclear when this issue will be resolved.
> > >>>>    The alternative osgeo4mac tap holds formula that is unstable and
> > >>>>    somewhat broken. One cannot link rgdal with the current gdal
> v3.0.1
> > >>>>    from
> > >>>>    osgeo4mac.
> > >>>>
> > >>>>    This incompatibility with homebrew-core formula leads to further
> > >>>>    issues
> > >>>>    for CI tests that rely on the spatial homebrew stack for macOS
> > builds.
> > >>>>
> > >>>>    All of this is really unfortunate and I am wondering if this was
> a
> > >>>>    known
> > >>>>    factor when introducing this condition in the new release.
> > >>>>    Unfortunately rgdal is not hosted on any Git* provider (there is
> > just
> > >>>>    the CRAN mirror with not much information about the recent
> changes)
> > >>>>    and
> > >>>>    it is unclear/untransparent to me if there is a continuous
> > integration
> > >>>>    setup at all for this package.
> > >>>
> > >>>   Do not require me to leave the excellent SVN service on R-forge.
> > Provide
> > >>>   patches there.
> > >>>
> > >>>>    I hope this is not another case in the series ?I do not like
> > operating
> > >>>>    system XY and hence I do not test on it? which was seen recently
> in
> > >>>>    another package. That?s what CI is for and the responsibility of
> > >>>>    package authors.
> > >>>>
> > >>>
> > >>>   I run and develop on Fedora, I  have no access to OSX, and the
> > current
> > >>>   release was fully checked with ~ 900 revdeps repeatedly since
> > November
> > >>>   on
> > >>>   successive older and newer versions of PROJ and GDAL. I blocked new
> > PROJ
> > >>>   with old GDAL recently to simplify development. CI is only as good
> as
> > >>>   the
> > >>>   scripts, I am completely sure that repeated revdep testing and
> > reading
> > >>>   the
> > >>>   output is superior.
> > >>>
> > >>>>    Also one should be aware that not every rgdal user is member of
> > this
> > >>>>    mailing list (I guess not even 5%) and many people in production
> > will
> > >>>>    face this error during install, most of them without any clue
> what
> > to
> > >>>>    do
> > >>>>    or an idea why this was raised.
> > >>>>
> > >>>
> > >>>   There has been plenty of information given about the CRS changes.
> > rgdal
> > >>>   could simply have been abandoned by me, and all  those production
> > >>>   volunteers might have fixed things, but I never hear anything at
> all.
> > >>>
> > >>>>    In summary it would be great if
> > >>>>
> > >>>>    - There would be more detailed information on the introduction of
> > the
> > >>>>    new condition
> > >>>>    - Awareness of state-of-the-art platform related library versions
> > >>>>    before
> > >>>>    making such a release
> > >>>>    - Transparency/Existence of a cross-platform build process
> > >>>>    - If the incompatibility is just due to some features not being
> > >>>>    accessible with this configuration, I suggest to raise a warning
> > >>>>    during
> > >>>>    package load but not prevent the package from installing in the
> > first
> > >>>>    place
> > >>>>    - A version-based NEWS file would be available. Currently one
> only
> > >>>>    sees
> > >>>>    a revision-based Changelog:
> > >>>>    https://cran.r-project.org/web/packages/rgdal/ChangeLog
> > >>>>
> > >>>>    I am well aware that I am indirectly criticising (hopefully in a
> > >>>>    constructive way) the transparency and release process here, for
> > which
> > >>>>    I
> > >>>>    will probably get a rough response.
> > >>>>    However, if that leads to more robustness and transparency in
> > future
> > >>>>    release, I am fine with this.
> > >>>>
> > >>>>    A quick patch release resolving the breakage would be highly
> > >>>>    appreciated.
> > >>>
> > >>>   Only with community imput. what you ask is not needed, just extra
> > >>>   complexity. Please provide patches, or accept my invitation to join
> > the
> > >>>   R-forge project and commit your fixes directly. I can see how to do
> > it,
> > >>>   but I don't think it makes sense, and your messsage has not
> motivated
> > >>>   me,
> > >>>   to be honest. I'm prioritizing working with CRAN to iron out
> reverse
> > >>>   dependency problems.
> > >>>
> > >>>   Roger
> > >>>
> > >>>>
> > >>>>    Best, Patrick
> > >>>>     [[alternative HTML version deleted]]
> > >>>>
> > >>>>    _______________________________________________
> > >>>>    R-sig-Geo mailing list
> > >>>>    R-sig-Geo at r-project.org
> > >>>>    https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >>>>
> > >>>
> > >>>
> > >>
> > >>
> > >
> > >
> >
> > --
> > Roger Bivand
> > Department of Economics, Norwegian School of Economics,
> > Helleveien 30, N-5045 Bergen, Norway.
> > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > https://orcid.org/0000-0003-2392-6140
> > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jun  3 17:30:09 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 3 Jun 2020 17:30:09 +0200
Subject: [R-sig-Geo] rgdal: About the new gdal3 and proj >=6 condition
In-Reply-To: <CAN=6O0JNKtdepP9swPV2aujATqPsCFGfN2w4=q5AePJAsxkVnw@mail.gmail.com>
References: <54DFB961-C4BB-4937-90AF-450B771F1F21@gmail.com>
 <alpine.LFD.2.22.394.2005291421380.3227460@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005291837350.3230794@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>
 <CAF16KkVcSo6EktDh_Uh7SkbcRNaDCke321HH6Oi0UoXq84f5FQ@mail.gmail.com>
 <CAN=6O0JNKtdepP9swPV2aujATqPsCFGfN2w4=q5AePJAsxkVnw@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006031717210.23273@reclus.nhh.no>

On Wed, 3 Jun 2020, Abdoulaye Sarr wrote:

> Have a problem with needed gdal version on mac

Please be much more specific. CRAN has macOS binaries of rgdal 1.5-8. Are 
you trying to install all the external software dependencies then rgdal 
from source? If this is difficult, rely on the CRAN macOS binaries, even 
though the PROJ and GDAL versions do not yet support WKT2 CRS 
representation. If you have installed PROJ and GDAL successfully, and PROJ 
< 6 && GDAL < 3, or PROJ >= 6 && GDAL >= 3, you should be OK. If you have 
the pointless PROJ >= 6 && GDAL < 3, you need the 1.5-9 tarball from 
R-forge, download locally and run R CMD INSTALL 
--configure-args="--with-proj_api=proj_api.h" rgdal_1.5-9.tar.gz.

Please report back on specifics, or simply use CRAN binaries and report 
that.

We are actively looking for ways to prevent macOS users getting trapped 
into trying to install from source when such a choice is not appropriate. 
We have no control over the provenance of the installed software as we 
have for Windows, thanks to Jeroen's rwinlib/gdal3 collection.

Roger

>
> On Tue, Jun 2, 2020 at 4:04 PM Robin Lovelace <rob00x at gmail.com> wrote:
>
>> Confirmed: this worked perfectly for me.
>>
>> Video evidence that this is fixed:
>> https://asciinema.org/a/zPQFbI6Q01oqUy1HRauCjLUXY
>>
>> Thanks Roger!
>>
>> Robin
>>
>> On Tue, Jun 2, 2020 at 4:00 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> Brian Ripley (thanks!) provided a patch for rgdal's configure.ac, and
>> the
>>> R-forge build and check processes now succeed, so please try to install
>>> either downloading
>>> http://download.r-forge.r-project.org/src/contrib/rgdal_1.5-9.tar.gz and
>>> installing from the command line (after running R CMD check), or
>>> install.packages("rgdal", repos="http://R-Forge.R-project.org").
>>>
>>> Remember that if GDAL is < 3, and PROJ >= 6, you need the configure
>>> argument: --configure-args=--with-proj_api=proj_api.h.
>>>
>>> Roger
>>>
>>> On Sun, 31 May 2020, Roger Bivand wrote:
>>>
>>>> Fresh version of rgdal rev 995 on link and R-forge, with more tweaks to
>>> the
>>>> configure file. Please test.
>>>>
>>>> Roger
>>>>
>>>> On Fri, 29 May 2020, Roger Bivand wrote:
>>>>
>>>>>  I have put a tarball, built without vignettes with GDAL 2.2.4 and
>> PROJ
>>>>>  7.0.1 that passes CMD check (with warnings for missing vignettes) on:
>>>>>
>>>>>  http://spatial.nhh.no/R/rgdal/gdal_1.5-9.tar.gz
>>>>>
>>>>>  It involves code copying to provide duplicated functions in three
>>>>>  settings:
>>>>>
>>>>>  PROJ < 6 & GDAL < 3
>>>>> PROJ >  = 6 & GDAL >= 3
>>>>> PROJ >  = 6 & GDAL < 3 (your homebrew case)
>>>>>
>>>>>  You need the configure argument:
>>>>>  --configure-args=--with-proj_api=proj_api.h.
>>>>>  Without the argument, you now get directed to use it.
>>>>>
>>>>>  For now I've dropped the configure tests for sqlite3, curl and tiff;
>>> works
>>>>>  for me but may not work for you.
>>>>>
>>>>>  Please make the output of:
>>>>>
>>>>>  R CMD check
>>> --install-args="--configure-args=--with-proj_api=proj_api.h"
>>>>>  rgdal_1.5-9.tar.gz
>>>>>
>>>>>  available ASAP. I count on an immediate response.
>>>>>
>>>>>  Roger
>>>>>
>>>>>  On Fri, 29 May 2020, Roger Bivand wrote:
>>>>>
>>>>>>   On Fri, 29 May 2020, Patrick Schratz wrote:
>>>>>>
>>>>>>>    The just released rgdal v1.5.8 requires gdal >= 3 when proj >= 6
>> is
>>>>>>>    present. It does not even install the package if this condition
>> is
>>> not
>>>>>>>    met
>>>>>>>    but errors during linking.
>>>>>>
>>>>>>   Please document with the output of 00install.out from R CMD check
>>>>>>   rgdal_1.5-8.tar.gz, and pkg-config proj --modversion, gdalinfo
>>> --version
>>>>>>   with system details.
>>>>>>
>>>>>>   Yes, PROJ >= 6 makes no sense without GDAL >= 3; GDAL 3 makes no
>>> sense
>>>>>>   with PROJ < 6. GDAL 3 with PROJ < 6 uses the old proj_api.h API and
>>> the
>>>>>>   old metadata structure with Proj4 string degradation; GDAL < 3 with
>>> PROJ
>>>>>>>   = 6 must use the deprecated API and the new metadata structure.
>>>>>>
>>>>>>>
>>>>>>>    I could not find any sources in the web or in the announcement
>>> post of
>>>>>>>    v1.5.8 why this condition was enforced so strictly.
>>>>>>>    Does it cause unwanted results?
>>>>>>
>>>>>>   Yes, definitely. GDAL 3 was released as 3, not 2.5, to stress the
>>>>>>   complete
>>>>>>   break between GDAL 2 (with PROJ <= 5) and GDAL >= 3 (with PROJ >=
>> 6)
>>>>>>   after
>>>>>>   GDAL barnraising. So:
>>>>>>
>>>>>>             PROJ
>>>>>>             < 6 >= 6
>>>>>>   GDAL < 3   OK   NO
>>>>>>   >   = 3   NO   OK
>>>>>>
>>>>>>
>>>>>>
>>>>>>>    If so, then there is a big issue since the ?gdal2 and proj >= 6?
>>>>>>>    combination has been used by many people in the past already.
>>>>>>
>>>>>>   No good precedent, just binary packagers protecting slow downstream
>>>>>>   adaptation.
>>>>>>
>>>>>>>    I haven?t tracked down for how long this situation was on the
>>> market
>>>>>>>    already.
>>>>>>>    Also the {sf} package is still installable with this combination
>>> and I
>>>>>>>    am not aware of any warnings/issues that came up due to this so
>>> far.
>>>>>>>
>>>>>>
>>>>>>   rgdal is a much older package and has much more older code that
>> needs
>>>>>>   this
>>>>>>   protection. It is possible to accommodate the no-go areas, but I'd
>>>>>>   really
>>>>>>   value patches to R-forge, as I cannot check multiple PROJ/GDAL
>>> version
>>>>>>   combinations just because someone isn't up to speed.
>>>>>>
>>>>>>>    It further causes complete breakage for people relying on the
>>> homebrew
>>>>>>>    package manager on macOS since current versions are gdal v2.2.4
>> and
>>>>>>>    proj
>>>>>>>    7.0.1.
>>>>>>
>>>>>>   They should never have gone beyond PROJ 5 if they are stuck on
>> GDAL.
>>>>>>   PROJ
>>>>>>   7 is a very different animal.
>>>>>>
>>>>>>>    The update to gdal3 is blocked since months due to an
>>> incompatibility
>>>>>>>    with `liblas` (https://github.com/libLAS/libLAS/issues/164).
>>> Reading
>>>>>>>    the
>>>>>>>    issue, it looks unclear when this issue will be resolved.
>>>>>>>    The alternative osgeo4mac tap holds formula that is unstable and
>>>>>>>    somewhat broken. One cannot link rgdal with the current gdal
>> v3.0.1
>>>>>>>    from
>>>>>>>    osgeo4mac.
>>>>>>>
>>>>>>>    This incompatibility with homebrew-core formula leads to further
>>>>>>>    issues
>>>>>>>    for CI tests that rely on the spatial homebrew stack for macOS
>>> builds.
>>>>>>>
>>>>>>>    All of this is really unfortunate and I am wondering if this was
>> a
>>>>>>>    known
>>>>>>>    factor when introducing this condition in the new release.
>>>>>>>    Unfortunately rgdal is not hosted on any Git* provider (there is
>>> just
>>>>>>>    the CRAN mirror with not much information about the recent
>> changes)
>>>>>>>    and
>>>>>>>    it is unclear/untransparent to me if there is a continuous
>>> integration
>>>>>>>    setup at all for this package.
>>>>>>
>>>>>>   Do not require me to leave the excellent SVN service on R-forge.
>>> Provide
>>>>>>   patches there.
>>>>>>
>>>>>>>    I hope this is not another case in the series ?I do not like
>>> operating
>>>>>>>    system XY and hence I do not test on it? which was seen recently
>> in
>>>>>>>    another package. That?s what CI is for and the responsibility of
>>>>>>>    package authors.
>>>>>>>
>>>>>>
>>>>>>   I run and develop on Fedora, I  have no access to OSX, and the
>>> current
>>>>>>   release was fully checked with ~ 900 revdeps repeatedly since
>>> November
>>>>>>   on
>>>>>>   successive older and newer versions of PROJ and GDAL. I blocked new
>>> PROJ
>>>>>>   with old GDAL recently to simplify development. CI is only as good
>> as
>>>>>>   the
>>>>>>   scripts, I am completely sure that repeated revdep testing and
>>> reading
>>>>>>   the
>>>>>>   output is superior.
>>>>>>
>>>>>>>    Also one should be aware that not every rgdal user is member of
>>> this
>>>>>>>    mailing list (I guess not even 5%) and many people in production
>>> will
>>>>>>>    face this error during install, most of them without any clue
>> what
>>> to
>>>>>>>    do
>>>>>>>    or an idea why this was raised.
>>>>>>>
>>>>>>
>>>>>>   There has been plenty of information given about the CRS changes.
>>> rgdal
>>>>>>   could simply have been abandoned by me, and all  those production
>>>>>>   volunteers might have fixed things, but I never hear anything at
>> all.
>>>>>>
>>>>>>>    In summary it would be great if
>>>>>>>
>>>>>>>    - There would be more detailed information on the introduction of
>>> the
>>>>>>>    new condition
>>>>>>>    - Awareness of state-of-the-art platform related library versions
>>>>>>>    before
>>>>>>>    making such a release
>>>>>>>    - Transparency/Existence of a cross-platform build process
>>>>>>>    - If the incompatibility is just due to some features not being
>>>>>>>    accessible with this configuration, I suggest to raise a warning
>>>>>>>    during
>>>>>>>    package load but not prevent the package from installing in the
>>> first
>>>>>>>    place
>>>>>>>    - A version-based NEWS file would be available. Currently one
>> only
>>>>>>>    sees
>>>>>>>    a revision-based Changelog:
>>>>>>>    https://cran.r-project.org/web/packages/rgdal/ChangeLog
>>>>>>>
>>>>>>>    I am well aware that I am indirectly criticising (hopefully in a
>>>>>>>    constructive way) the transparency and release process here, for
>>> which
>>>>>>>    I
>>>>>>>    will probably get a rough response.
>>>>>>>    However, if that leads to more robustness and transparency in
>>> future
>>>>>>>    release, I am fine with this.
>>>>>>>
>>>>>>>    A quick patch release resolving the breakage would be highly
>>>>>>>    appreciated.
>>>>>>
>>>>>>   Only with community imput. what you ask is not needed, just extra
>>>>>>   complexity. Please provide patches, or accept my invitation to join
>>> the
>>>>>>   R-forge project and commit your fixes directly. I can see how to do
>>> it,
>>>>>>   but I don't think it makes sense, and your messsage has not
>> motivated
>>>>>>   me,
>>>>>>   to be honest. I'm prioritizing working with CRAN to iron out
>> reverse
>>>>>>   dependency problems.
>>>>>>
>>>>>>   Roger
>>>>>>
>>>>>>>
>>>>>>>    Best, Patrick
>>>>>>>     [[alternative HTML version deleted]]
>>>>>>>
>>>>>>>    _______________________________________________
>>>>>>>    R-sig-Geo mailing list
>>>>>>>    R-sig-Geo at r-project.org
>>>>>>>    https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From ee|koudou@@ @end|ng |rom |ordh@m@edu  Wed Jun  3 17:57:31 2020
From: ee|koudou@@ @end|ng |rom |ordh@m@edu (El Mechry El Koudouss)
Date: Wed, 3 Jun 2020 11:57:31 -0400
Subject: [R-sig-Geo] Package lwgeom (0.2-4) fails to install on Shinyapps.io
 with an "upgrade GEOS to 3.6.0 or later" error
Message-ID: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>

Dear all,
I am building a Shiny app that works fine on my laptop (Windows 10).
However, it fails to deploy on Shinyapps.io because the package lwgeom
(0.2-4) fails to install on Shinyapps.io. I have the sf  package installed
and loaded to the library on my laptop and it links to GEOS 3.8.0. I also
have the  lwgeom package installed and loaded to the library in my laptop
and it also links to GOES 3.8.0. Yes the error I get is:
error: upgrade GEOS to 3.6.0 or later
ERROR: configuration failed for package ?lwgeom?
The full message I get up on trying to deploy my app is pasted below. For
more information, I am using the following packages and the following shiny
functions. I am hoping someone here can point me in the right direction.
Thanks.

library(shiny)
library(shinythemes)
library(plotly)
library(tidyverse)
library(sf)
library(leaflet)
library(tmap)
library(lubridate)
renderLeaflet()
tm_shape()
tm_polygons()
tmap_leaflet()

Full error message is below:
Building R package: lwgeom (0.2-4)
/mnt/packages/build /mnt
* installing to library ?/opt/R/4.0.0/lib/R/library?
* installing *source* package ?lwgeom? ...
** package ?lwgeom? successfully unpacked and MD5 sums checked
** using staged installation
configure: CC: gcc
configure: CXX: g++ -std=gnu++11
configure: pkg-config proj exists, will use it
configure: PROJ: 4.9.2
checking for pj_init_plus in -lproj... yes
checking PROJ: epsg found and readable... yes
configure: POSTGIS_PROJ_VERSION: 49
checking for geos-config... /usr/bin/geos-config
checking geos-config usability... yes
configure: GEOS: 3.5.1
checking GEOS version >= 3.6.0... no
configure: error: upgrade GEOS to 3.6.0 or later
ERROR: configuration failed for package ?lwgeom?
* removing ?/opt/R/4.0.0/lib/R/library/lwgeom?
################################# End Task Log
#################################
Error: Unhandled Exception: Child Task 741259659 failed: Error building
image: Error building lwgeom (0.2-4). Build exited with non-zero status: 1
Execution halted

-- 
El Mechry, El Koudouss (Meshry)
Graduate Research Assistant
Center for International Policy Studies
Fordham University
Department of Economics
Website: www.meshry.com

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Wed Jun  3 18:03:38 2020
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Wed, 3 Jun 2020 10:03:38 -0600
Subject: [R-sig-Geo] 
 Package lwgeom (0.2-4) fails to install on Shinyapps.io
 with an "upgrade GEOS to 3.6.0 or later" error
In-Reply-To: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
References: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
Message-ID: <CACxE24mbUaU3c+dBzX2NzDo9p3By6HjezXkMdu2rEEVCmzsaQQ@mail.gmail.com>

Hello!

Could this possibly be due to the upgrade for GDAL and PROJ libraries,
please?

That might be something on the Shinyapps.io side.  Just a thought.

Thanks,
Erin

On Wed, Jun 3, 2020 at 10:00 AM El Mechry El Koudouss <
eelkoudouss at fordham.edu> wrote:

> Dear all,
> I am building a Shiny app that works fine on my laptop (Windows 10).
> However, it fails to deploy on Shinyapps.io because the package lwgeom
> (0.2-4) fails to install on Shinyapps.io. I have the sf  package installed
> and loaded to the library on my laptop and it links to GEOS 3.8.0. I also
> have the  lwgeom package installed and loaded to the library in my laptop
> and it also links to GOES 3.8.0. Yes the error I get is:
> error: upgrade GEOS to 3.6.0 or later
> ERROR: configuration failed for package ?lwgeom?
> The full message I get up on trying to deploy my app is pasted below. For
> more information, I am using the following packages and the following shiny
> functions. I am hoping someone here can point me in the right direction.
> Thanks.
>
> library(shiny)
> library(shinythemes)
> library(plotly)
> library(tidyverse)
> library(sf)
> library(leaflet)
> library(tmap)
> library(lubridate)
> renderLeaflet()
> tm_shape()
> tm_polygons()
> tmap_leaflet()
>
> Full error message is below:
> Building R package: lwgeom (0.2-4)
> /mnt/packages/build /mnt
> * installing to library ?/opt/R/4.0.0/lib/R/library?
> * installing *source* package ?lwgeom? ...
> ** package ?lwgeom? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: CC: gcc
> configure: CXX: g++ -std=gnu++11
> configure: pkg-config proj exists, will use it
> configure: PROJ: 4.9.2
> checking for pj_init_plus in -lproj... yes
> checking PROJ: epsg found and readable... yes
> configure: POSTGIS_PROJ_VERSION: 49
> checking for geos-config... /usr/bin/geos-config
> checking geos-config usability... yes
> configure: GEOS: 3.5.1
> checking GEOS version >= 3.6.0... no
> configure: error: upgrade GEOS to 3.6.0 or later
> ERROR: configuration failed for package ?lwgeom?
> * removing ?/opt/R/4.0.0/lib/R/library/lwgeom?
> ################################# End Task Log
> #################################
> Error: Unhandled Exception: Child Task 741259659 failed: Error building
> image: Error building lwgeom (0.2-4). Build exited with non-zero status: 1
> Execution halted
>
> --
> El Mechry, El Koudouss (Meshry)
> Graduate Research Assistant
> Center for International Policy Studies
> Fordham University
> Department of Economics
> Website: www.meshry.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Jun  3 18:33:18 2020
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 3 Jun 2020 09:33:18 -0700 (PDT)
Subject: [R-sig-Geo] 
 Package lwgeom (0.2-4) fails to install on Shinyapps.io
 with an "upgrade GEOS to 3.6.0 or later" error
In-Reply-To: <CACxE24mbUaU3c+dBzX2NzDo9p3By6HjezXkMdu2rEEVCmzsaQQ@mail.gmail.com>
References: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
 <CACxE24mbUaU3c+dBzX2NzDo9p3By6HjezXkMdu2rEEVCmzsaQQ@mail.gmail.com>
Message-ID: <alpine.LNX.2.20.2006030931070.26984@salmo.appl-ecosys.com>

On Wed, 3 Jun 2020, Erin Hodgess wrote:

> Could this possibly be due to the upgrade for GDAL and PROJ libraries,
> please?

Erin,

I learned a while ago that when any of proj, geos, and gdal are upgraded I
need to rebuid tools higher in that chain. If you have a new geos version
then a new gdal build is in order.

If this does not address your issue please excuse my responding.

Regards,

Rich


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Wed Jun  3 18:52:06 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Wed, 3 Jun 2020 18:52:06 +0200
Subject: [R-sig-Geo] 
 Package lwgeom (0.2-4) fails to install on Shinyapps.io
 with an "upgrade GEOS to 3.6.0 or later" error
In-Reply-To: <alpine.LNX.2.20.2006030931070.26984@salmo.appl-ecosys.com>
References: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
 <CACxE24mbUaU3c+dBzX2NzDo9p3By6HjezXkMdu2rEEVCmzsaQQ@mail.gmail.com>
 <alpine.LNX.2.20.2006030931070.26984@salmo.appl-ecosys.com>
Message-ID: <d0cdd815-37fc-b288-9908-f29e69e903a2@uni-muenster.de>

R package lwgeom had to upgrade to a newer version of liblwgeom (now a
subdirectory in the PostGIS source tree, really) because of the new PROJ
versions and deprecation of the old PROJ interface; PostGIS requires the
newer GEOS version.

I have no control over versions of GEOS that are run on the shinyapps.io
machines, and don't know which OS at which version they run. I also have
no clue how one could debug this issue.

One could try to patch the install file,
https://github.com/rstudio/shinyapps-package-dependencies/blob/master/packages/lwgeom/install
such that it installs a newer GEOS (maybe binary from another ppa,
otherwise from source).

On 6/3/20 6:33 PM, Rich Shepard wrote:
> On Wed, 3 Jun 2020, Erin Hodgess wrote:
> 
>> Could this possibly be due to the upgrade for GDAL and PROJ libraries,
>> please?
> 
> Erin,
> 
> I learned a while ago that when any of proj, geos, and gdal are upgraded I
> need to rebuid tools higher in that chain. If you have a new geos version
> then a new gdal build is in order.
> 
> If this does not address your issue please excuse my responding.
> 
> Regards,
> 
> Rich
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200603/24a1a3fc/attachment.bin>

From |@t@z@hn @end|ng |rom gm@||@com  Wed Jun  3 19:21:58 2020
From: |@t@z@hn @end|ng |rom gm@||@com (Ista Zahn)
Date: Wed, 3 Jun 2020 13:21:58 -0400
Subject: [R-sig-Geo] 
 Package lwgeom (0.2-4) fails to install on Shinyapps.io
 with an "upgrade GEOS to 3.6.0 or later" error
In-Reply-To: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
References: <CABvzdCVRrRReyRBDT5GMsh3UB2JXsM94RS0jzHA9JKpiQg_76w@mail.gmail.com>
Message-ID: <CA+vqiLG5sDnH3aFG796oSAPwTObpwOWy3ELWnZEWe2f+dXMfiw@mail.gmail.com>

The documentation at
https://docs.rstudio.com/shinyapps.io/getting-started.html#deploying-applications
will help you figure it out. From a quick glance it seems you can
either downgrade your local version of lwgeom or work to get the
system dependencies installed as instructed at
https://docs.rstudio.com/shinyapps.io/getting-started.html#system-packages

Best,
Ista

On Wed, Jun 3, 2020 at 12:00 PM El Mechry El Koudouss
<eelkoudouss at fordham.edu> wrote:
>
> Dear all,
> I am building a Shiny app that works fine on my laptop (Windows 10).
> However, it fails to deploy on Shinyapps.io because the package lwgeom
> (0.2-4) fails to install on Shinyapps.io. I have the sf  package installed
> and loaded to the library on my laptop and it links to GEOS 3.8.0. I also
> have the  lwgeom package installed and loaded to the library in my laptop
> and it also links to GOES 3.8.0. Yes the error I get is:
> error: upgrade GEOS to 3.6.0 or later
> ERROR: configuration failed for package ?lwgeom?
> The full message I get up on trying to deploy my app is pasted below. For
> more information, I am using the following packages and the following shiny
> functions. I am hoping someone here can point me in the right direction.
> Thanks.
>
> library(shiny)
> library(shinythemes)
> library(plotly)
> library(tidyverse)
> library(sf)
> library(leaflet)
> library(tmap)
> library(lubridate)
> renderLeaflet()
> tm_shape()
> tm_polygons()
> tmap_leaflet()
>
> Full error message is below:
> Building R package: lwgeom (0.2-4)
> /mnt/packages/build /mnt
> * installing to library ?/opt/R/4.0.0/lib/R/library?
> * installing *source* package ?lwgeom? ...
> ** package ?lwgeom? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: CC: gcc
> configure: CXX: g++ -std=gnu++11
> configure: pkg-config proj exists, will use it
> configure: PROJ: 4.9.2
> checking for pj_init_plus in -lproj... yes
> checking PROJ: epsg found and readable... yes
> configure: POSTGIS_PROJ_VERSION: 49
> checking for geos-config... /usr/bin/geos-config
> checking geos-config usability... yes
> configure: GEOS: 3.5.1
> checking GEOS version >= 3.6.0... no
> configure: error: upgrade GEOS to 3.6.0 or later
> ERROR: configuration failed for package ?lwgeom?
> * removing ?/opt/R/4.0.0/lib/R/library/lwgeom?
> ################################# End Task Log
> #################################
> Error: Unhandled Exception: Child Task 741259659 failed: Error building
> image: Error building lwgeom (0.2-4). Build exited with non-zero status: 1
> Execution halted
>
> --
> El Mechry, El Koudouss (Meshry)
> Graduate Research Assistant
> Center for International Policy Studies
> Fordham University
> Department of Economics
> Website: www.meshry.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From @bdou|@ye@@r @end|ng |rom gm@||@com  Wed Jun  3 19:42:12 2020
From: @bdou|@ye@@r @end|ng |rom gm@||@com (Abdoulaye Sarr)
Date: Wed, 3 Jun 2020 17:42:12 +0000
Subject: [R-sig-Geo] rgdal: About the new gdal3 and proj >=6 condition
In-Reply-To: <alpine.LFD.2.22.394.2006031717210.23273@reclus.nhh.no>
References: <54DFB961-C4BB-4937-90AF-450B771F1F21@gmail.com>
 <alpine.LFD.2.22.394.2005291421380.3227460@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005291837350.3230794@reclus.nhh.no>
 <alpine.LFD.2.22.394.2005311743370.4085767@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006021655430.5920@reclus.nhh.no>
 <CAF16KkVcSo6EktDh_Uh7SkbcRNaDCke321HH6Oi0UoXq84f5FQ@mail.gmail.com>
 <CAN=6O0JNKtdepP9swPV2aujATqPsCFGfN2w4=q5AePJAsxkVnw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031717210.23273@reclus.nhh.no>
Message-ID: <CAN=6O0KeATfOgMKyJu2htjcZUBeWR-H=aUCanBxzN8BGUt7wHg@mail.gmail.com>

I was trying from source, but now installed the binary.

Thank you

On Wed, Jun 3, 2020 at 3:30 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 3 Jun 2020, Abdoulaye Sarr wrote:
>
> > Have a problem with needed gdal version on mac
>
> Please be much more specific. CRAN has macOS binaries of rgdal 1.5-8. Are
> you trying to install all the external software dependencies then rgdal
> from source? If this is difficult, rely on the CRAN macOS binaries, even
> though the PROJ and GDAL versions do not yet support WKT2 CRS
> representation. If you have installed PROJ and GDAL successfully, and PROJ
> < 6 && GDAL < 3, or PROJ >= 6 && GDAL >= 3, you should be OK. If you have
> the pointless PROJ >= 6 && GDAL < 3, you need the 1.5-9 tarball from
> R-forge, download locally and run R CMD INSTALL
> --configure-args="--with-proj_api=proj_api.h" rgdal_1.5-9.tar.gz.
>
> Please report back on specifics, or simply use CRAN binaries and report
> that.
>
> We are actively looking for ways to prevent macOS users getting trapped
> into trying to install from source when such a choice is not appropriate.
> We have no control over the provenance of the installed software as we
> have for Windows, thanks to Jeroen's rwinlib/gdal3 collection.
>
> Roger
>
> >
> > On Tue, Jun 2, 2020 at 4:04 PM Robin Lovelace <rob00x at gmail.com> wrote:
> >
> >> Confirmed: this worked perfectly for me.
> >>
> >> Video evidence that this is fixed:
> >> https://asciinema.org/a/zPQFbI6Q01oqUy1HRauCjLUXY
> >>
> >> Thanks Roger!
> >>
> >> Robin
> >>
> >> On Tue, Jun 2, 2020 at 4:00 PM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>
> >>> Brian Ripley (thanks!) provided a patch for rgdal's configure.ac, and
> >> the
> >>> R-forge build and check processes now succeed, so please try to install
> >>> either downloading
> >>> http://download.r-forge.r-project.org/src/contrib/rgdal_1.5-9.tar.gz
> and
> >>> installing from the command line (after running R CMD check), or
> >>> install.packages("rgdal", repos="http://R-Forge.R-project.org").
> >>>
> >>> Remember that if GDAL is < 3, and PROJ >= 6, you need the configure
> >>> argument: --configure-args=--with-proj_api=proj_api.h.
> >>>
> >>> Roger
> >>>
> >>> On Sun, 31 May 2020, Roger Bivand wrote:
> >>>
> >>>> Fresh version of rgdal rev 995 on link and R-forge, with more tweaks
> to
> >>> the
> >>>> configure file. Please test.
> >>>>
> >>>> Roger
> >>>>
> >>>> On Fri, 29 May 2020, Roger Bivand wrote:
> >>>>
> >>>>>  I have put a tarball, built without vignettes with GDAL 2.2.4 and
> >> PROJ
> >>>>>  7.0.1 that passes CMD check (with warnings for missing vignettes)
> on:
> >>>>>
> >>>>>  http://spatial.nhh.no/R/rgdal/gdal_1.5-9.tar.gz
> >>>>>
> >>>>>  It involves code copying to provide duplicated functions in three
> >>>>>  settings:
> >>>>>
> >>>>>  PROJ < 6 & GDAL < 3
> >>>>> PROJ >  = 6 & GDAL >= 3
> >>>>> PROJ >  = 6 & GDAL < 3 (your homebrew case)
> >>>>>
> >>>>>  You need the configure argument:
> >>>>>  --configure-args=--with-proj_api=proj_api.h.
> >>>>>  Without the argument, you now get directed to use it.
> >>>>>
> >>>>>  For now I've dropped the configure tests for sqlite3, curl and tiff;
> >>> works
> >>>>>  for me but may not work for you.
> >>>>>
> >>>>>  Please make the output of:
> >>>>>
> >>>>>  R CMD check
> >>> --install-args="--configure-args=--with-proj_api=proj_api.h"
> >>>>>  rgdal_1.5-9.tar.gz
> >>>>>
> >>>>>  available ASAP. I count on an immediate response.
> >>>>>
> >>>>>  Roger
> >>>>>
> >>>>>  On Fri, 29 May 2020, Roger Bivand wrote:
> >>>>>
> >>>>>>   On Fri, 29 May 2020, Patrick Schratz wrote:
> >>>>>>
> >>>>>>>    The just released rgdal v1.5.8 requires gdal >= 3 when proj >= 6
> >> is
> >>>>>>>    present. It does not even install the package if this condition
> >> is
> >>> not
> >>>>>>>    met
> >>>>>>>    but errors during linking.
> >>>>>>
> >>>>>>   Please document with the output of 00install.out from R CMD check
> >>>>>>   rgdal_1.5-8.tar.gz, and pkg-config proj --modversion, gdalinfo
> >>> --version
> >>>>>>   with system details.
> >>>>>>
> >>>>>>   Yes, PROJ >= 6 makes no sense without GDAL >= 3; GDAL 3 makes no
> >>> sense
> >>>>>>   with PROJ < 6. GDAL 3 with PROJ < 6 uses the old proj_api.h API
> and
> >>> the
> >>>>>>   old metadata structure with Proj4 string degradation; GDAL < 3
> with
> >>> PROJ
> >>>>>>>   = 6 must use the deprecated API and the new metadata structure.
> >>>>>>
> >>>>>>>
> >>>>>>>    I could not find any sources in the web or in the announcement
> >>> post of
> >>>>>>>    v1.5.8 why this condition was enforced so strictly.
> >>>>>>>    Does it cause unwanted results?
> >>>>>>
> >>>>>>   Yes, definitely. GDAL 3 was released as 3, not 2.5, to stress the
> >>>>>>   complete
> >>>>>>   break between GDAL 2 (with PROJ <= 5) and GDAL >= 3 (with PROJ >=
> >> 6)
> >>>>>>   after
> >>>>>>   GDAL barnraising. So:
> >>>>>>
> >>>>>>             PROJ
> >>>>>>             < 6 >= 6
> >>>>>>   GDAL < 3   OK   NO
> >>>>>>   >   = 3   NO   OK
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>>    If so, then there is a big issue since the ?gdal2 and proj >= 6?
> >>>>>>>    combination has been used by many people in the past already.
> >>>>>>
> >>>>>>   No good precedent, just binary packagers protecting slow
> downstream
> >>>>>>   adaptation.
> >>>>>>
> >>>>>>>    I haven?t tracked down for how long this situation was on the
> >>> market
> >>>>>>>    already.
> >>>>>>>    Also the {sf} package is still installable with this combination
> >>> and I
> >>>>>>>    am not aware of any warnings/issues that came up due to this so
> >>> far.
> >>>>>>>
> >>>>>>
> >>>>>>   rgdal is a much older package and has much more older code that
> >> needs
> >>>>>>   this
> >>>>>>   protection. It is possible to accommodate the no-go areas, but I'd
> >>>>>>   really
> >>>>>>   value patches to R-forge, as I cannot check multiple PROJ/GDAL
> >>> version
> >>>>>>   combinations just because someone isn't up to speed.
> >>>>>>
> >>>>>>>    It further causes complete breakage for people relying on the
> >>> homebrew
> >>>>>>>    package manager on macOS since current versions are gdal v2.2.4
> >> and
> >>>>>>>    proj
> >>>>>>>    7.0.1.
> >>>>>>
> >>>>>>   They should never have gone beyond PROJ 5 if they are stuck on
> >> GDAL.
> >>>>>>   PROJ
> >>>>>>   7 is a very different animal.
> >>>>>>
> >>>>>>>    The update to gdal3 is blocked since months due to an
> >>> incompatibility
> >>>>>>>    with `liblas` (https://github.com/libLAS/libLAS/issues/164).
> >>> Reading
> >>>>>>>    the
> >>>>>>>    issue, it looks unclear when this issue will be resolved.
> >>>>>>>    The alternative osgeo4mac tap holds formula that is unstable and
> >>>>>>>    somewhat broken. One cannot link rgdal with the current gdal
> >> v3.0.1
> >>>>>>>    from
> >>>>>>>    osgeo4mac.
> >>>>>>>
> >>>>>>>    This incompatibility with homebrew-core formula leads to further
> >>>>>>>    issues
> >>>>>>>    for CI tests that rely on the spatial homebrew stack for macOS
> >>> builds.
> >>>>>>>
> >>>>>>>    All of this is really unfortunate and I am wondering if this was
> >> a
> >>>>>>>    known
> >>>>>>>    factor when introducing this condition in the new release.
> >>>>>>>    Unfortunately rgdal is not hosted on any Git* provider (there is
> >>> just
> >>>>>>>    the CRAN mirror with not much information about the recent
> >> changes)
> >>>>>>>    and
> >>>>>>>    it is unclear/untransparent to me if there is a continuous
> >>> integration
> >>>>>>>    setup at all for this package.
> >>>>>>
> >>>>>>   Do not require me to leave the excellent SVN service on R-forge.
> >>> Provide
> >>>>>>   patches there.
> >>>>>>
> >>>>>>>    I hope this is not another case in the series ?I do not like
> >>> operating
> >>>>>>>    system XY and hence I do not test on it? which was seen recently
> >> in
> >>>>>>>    another package. That?s what CI is for and the responsibility of
> >>>>>>>    package authors.
> >>>>>>>
> >>>>>>
> >>>>>>   I run and develop on Fedora, I  have no access to OSX, and the
> >>> current
> >>>>>>   release was fully checked with ~ 900 revdeps repeatedly since
> >>> November
> >>>>>>   on
> >>>>>>   successive older and newer versions of PROJ and GDAL. I blocked
> new
> >>> PROJ
> >>>>>>   with old GDAL recently to simplify development. CI is only as good
> >> as
> >>>>>>   the
> >>>>>>   scripts, I am completely sure that repeated revdep testing and
> >>> reading
> >>>>>>   the
> >>>>>>   output is superior.
> >>>>>>
> >>>>>>>    Also one should be aware that not every rgdal user is member of
> >>> this
> >>>>>>>    mailing list (I guess not even 5%) and many people in production
> >>> will
> >>>>>>>    face this error during install, most of them without any clue
> >> what
> >>> to
> >>>>>>>    do
> >>>>>>>    or an idea why this was raised.
> >>>>>>>
> >>>>>>
> >>>>>>   There has been plenty of information given about the CRS changes.
> >>> rgdal
> >>>>>>   could simply have been abandoned by me, and all  those production
> >>>>>>   volunteers might have fixed things, but I never hear anything at
> >> all.
> >>>>>>
> >>>>>>>    In summary it would be great if
> >>>>>>>
> >>>>>>>    - There would be more detailed information on the introduction
> of
> >>> the
> >>>>>>>    new condition
> >>>>>>>    - Awareness of state-of-the-art platform related library
> versions
> >>>>>>>    before
> >>>>>>>    making such a release
> >>>>>>>    - Transparency/Existence of a cross-platform build process
> >>>>>>>    - If the incompatibility is just due to some features not being
> >>>>>>>    accessible with this configuration, I suggest to raise a warning
> >>>>>>>    during
> >>>>>>>    package load but not prevent the package from installing in the
> >>> first
> >>>>>>>    place
> >>>>>>>    - A version-based NEWS file would be available. Currently one
> >> only
> >>>>>>>    sees
> >>>>>>>    a revision-based Changelog:
> >>>>>>>    https://cran.r-project.org/web/packages/rgdal/ChangeLog
> >>>>>>>
> >>>>>>>    I am well aware that I am indirectly criticising (hopefully in a
> >>>>>>>    constructive way) the transparency and release process here, for
> >>> which
> >>>>>>>    I
> >>>>>>>    will probably get a rough response.
> >>>>>>>    However, if that leads to more robustness and transparency in
> >>> future
> >>>>>>>    release, I am fine with this.
> >>>>>>>
> >>>>>>>    A quick patch release resolving the breakage would be highly
> >>>>>>>    appreciated.
> >>>>>>
> >>>>>>   Only with community imput. what you ask is not needed, just extra
> >>>>>>   complexity. Please provide patches, or accept my invitation to
> join
> >>> the
> >>>>>>   R-forge project and commit your fixes directly. I can see how to
> do
> >>> it,
> >>>>>>   but I don't think it makes sense, and your messsage has not
> >> motivated
> >>>>>>   me,
> >>>>>>   to be honest. I'm prioritizing working with CRAN to iron out
> >> reverse
> >>>>>>   dependency problems.
> >>>>>>
> >>>>>>   Roger
> >>>>>>
> >>>>>>>
> >>>>>>>    Best, Patrick
> >>>>>>>     [[alternative HTML version deleted]]
> >>>>>>>
> >>>>>>>    _______________________________________________
> >>>>>>>    R-sig-Geo mailing list
> >>>>>>>    R-sig-Geo at r-project.org
> >>>>>>>    https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>
> >>>>>
> >>>>
> >>>>
> >>>
> >>> --
> >>> Roger Bivand
> >>> Department of Economics, Norwegian School of Economics,
> >>> Helleveien 30, N-5045 Bergen, Norway.
> >>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>> https://orcid.org/0000-0003-2392-6140
> >>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From |omn@v@@|@ @end|ng |rom gm@||@com  Thu Jun  4 05:44:24 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Wed, 3 Jun 2020 22:44:24 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
Message-ID: <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>

Thank you very much for your support. This gives me what I need and I must
say listw2sn() is really great.

Why do I need the data in the format as in dataout? I am trying to test
spatial dependence (or neighborhood effect) by running a regression model
that entails pop_size_it = beta_1*sum of pop_size of point i's neighbors
within a specified radius. So my plan is to get the neighbors for each
focal point
as per the specified bands and their attributes (eg pop_size) so I can can
add them (attribute) by the bands.

I am totally new to the area of spatial econometrics, so I am taking things
one step at a time. Some readings suggest I may need distance matrix or
weight matrix but for now I think I should try the current approach.

Thank you.

-------------
Lom

On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>
> > I had the errors with rtree using R 3.6.3. I have since changed to R
> 4.0.0
> > but I got the same error.
> >
> > And  yes, for Roger's example, I have the objects wd1, ... wd4, all with
> > length 101. I think my difficulty is my inability to output the list
> > detailing the point IDs t50_fid.
>
> library(spData)
> library(sf)
> projdata<-st_transform(nz_height, 32759)
> pts <- st_coordinates(projdata)
> library(spdep)
> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> bds <- c(0, bufferR)
> wd1 <- dnearneigh(pts, bds[1], bds[2])
> wd2 <- dnearneigh(pts, bds[2], bds[3])
> wd3 <- dnearneigh(pts, bds[3], bds[4])
> wd4 <- dnearneigh(pts, bds[4], bds[5])
> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3, sn_band4))
> class(data_out) <- "data.frame"
> table(data_out$band)
> data_out$ID_from <- projdata$t50_fid[data_out$from]
> data_out$ID_to <- projdata$t50_fid[data_out$to]
> data_out$elev_from <- projdata$elevation[data_out$from]
> data_out$elev_to <- projdata$elevation[data_out$to]
> str(data_out)
>
> The "spatial.neighbour" representation was that used in the S-Plus
> SpatialStats module, with "from" and "to" columns, and here drops
> no-neighbour cases gracefully. So listw2sn() comes in useful
> for creating the output, and from there, just look-up in the
> input data.frame. Observations here cannot be their own neighbours.
>
> It would be relevant to know why you need these, are you looking at
> variogram clouds?
>
> Hope this clarifies,
>
> Roger
>
> >
> > ---------
> > Lom
> >
> > On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com> wrote:
> >
> >> Roger's example works for me and gives a list of length 101. I did have
> >> some issues that were resolved by updating packages. I'm using R 3.6.3
> on
> >> macOS 10.15.4. I also use rtree successfully on Windows 10 with R 3.6.3.
> >>
> >> Kent
> >>
> >> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>
> >>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>
> >>>> rtree uses Euclidean distance so the points should be in a coordinate
> >>>> system where this makes sense at least as a reasonable approximation.
> >>>
> >>> I tried the original example:
> >>>
> >>> remotes::install_github("hunzikp/rtree")
> >>> library(spData)
> >>> library(sf)
> >>> projdata<-st_transform(nz_height, 32759)
> >>> library(rtree)
> >>> pts <- st_coordinates(projdata)
> >>> rt <- RTree(st_coordinates(projdata))
> >>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>
> >>> but unfortunately failed (maybe newer Boost headers than yours?):
> >>>
> >>> Error in UseMethod("withinDistance", rTree) :
> >>>    no applicable method for 'withinDistance' applied to an object of
> >>> class
> >>> "c('list', 'RTree')"
> >>>
> >>>>
> >>>> Kent
> >>>>
> >>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
> >>> wrote:
> >>>>
> >>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>
> >>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>> To: r-sig-geo at r-project.org
> >>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> neighboring
> >>>>>>>         points within specified radii (distances) for each point
> in a
> >>>>> given
> >>>>>>>         points data set.
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>>> Hello,
> >>>>>>> I have data set of about 3400 location points with which I am
> trying
> >>> to
> >>>>>>> generate data of each point and their neighbors within defined
> radii
> >>>>> (eg,
> >>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>
> >>>>>>
> >>>>>> The rtree package is very fast and memory-efficient for
> >>> within-distance
> >>>>>> calculations.
> >>>>>> https://github.com/hunzikp/rtree
> >>>>>
> >>>>> Thanks! Does this also apply when the input points are in
> geographical
> >>>>> coordinates?
> >>>>>
> >>>>> Roger
> >>>>>
> >>>>>>
> >>>>>> Kent Johnson
> >>>>>> Cambridge, MA
> >>>>>>
> >>>>>>       [[alternative HTML version deleted]]
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> R-sig-Geo mailing list
> >>>>>> R-sig-Geo at r-project.org
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>
> >>>>>
> >>>>> --
> >>>>> Roger Bivand
> >>>>> Department of Economics, Norwegian School of Economics,
> >>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>> https://orcid.org/0000-0003-2392-6140
> >>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>
> >>>>
> >>>
> >>> --
> >>> Roger Bivand
> >>> Department of Economics, Norwegian School of Economics,
> >>> Helleveien 30, N-5045 Bergen, Norway.
> >>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>> https://orcid.org/0000-0003-2392-6140
> >>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Jun  4 10:48:00 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 4 Jun 2020 10:48:00 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>

On Thu, 4 Jun 2020, Lom Navanyo wrote:

> Thank you very much for your support. This gives me what I need and I must
> say listw2sn() is really great.
>
> Why do I need the data in the format as in dataout? I am trying to test 
> spatial dependence (or neighborhood effect) by running a regression 
> model that entails pop_size_it = beta_1*sum of pop_size of point i's 
> neighbors within a specified radius. So my plan is to get the neighbors 
> for each focal point as per the specified bands and their attributes (eg 
> pop_size) so I can can add them (attribute) by the bands.

Thanks, clarifies a good deal. Maybe look at the original localG articles 
for exploring distance relationships (Getis and Ord looked at HIV/AIDS); 
?spdep::localG or https://r-spatial.github.io/spdep/reference/localG.html.

Further note at OLS is biased as you have y = f(y) + e, so y on both 
sides. The nearest equivalent for a single band is spatialreg::lagsarlm() 
with listw=nb2listw(wd1, style="B") to get the neighbour sums through the 
weights matrix. So both your betas and their standard errors are unusable, 
I'm afraid. You are actually very much closer to ordinary kriging, looking 
at the way in which distance attenuates the correlation in value of 
proximate observations.

Hope this clarifies,

Roger

>
> I am totally new to the area of spatial econometrics, so I am taking things
> one step at a time. Some readings suggest I may need distance matrix or
> weight matrix but for now I think I should try the current approach.
>
> Thank you.
>
> -------------
> Lom
>
> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>>
>>> I had the errors with rtree using R 3.6.3. I have since changed to R
>> 4.0.0
>>> but I got the same error.
>>>
>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all with
>>> length 101. I think my difficulty is my inability to output the list
>>> detailing the point IDs t50_fid.
>>
>> library(spData)
>> library(sf)
>> projdata<-st_transform(nz_height, 32759)
>> pts <- st_coordinates(projdata)
>> library(spdep)
>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>> bds <- c(0, bufferR)
>> wd1 <- dnearneigh(pts, bds[1], bds[2])
>> wd2 <- dnearneigh(pts, bds[2], bds[3])
>> wd3 <- dnearneigh(pts, bds[3], bds[4])
>> wd4 <- dnearneigh(pts, bds[4], bds[5])
>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3, sn_band4))
>> class(data_out) <- "data.frame"
>> table(data_out$band)
>> data_out$ID_from <- projdata$t50_fid[data_out$from]
>> data_out$ID_to <- projdata$t50_fid[data_out$to]
>> data_out$elev_from <- projdata$elevation[data_out$from]
>> data_out$elev_to <- projdata$elevation[data_out$to]
>> str(data_out)
>>
>> The "spatial.neighbour" representation was that used in the S-Plus
>> SpatialStats module, with "from" and "to" columns, and here drops
>> no-neighbour cases gracefully. So listw2sn() comes in useful
>> for creating the output, and from there, just look-up in the
>> input data.frame. Observations here cannot be their own neighbours.
>>
>> It would be relevant to know why you need these, are you looking at
>> variogram clouds?
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>>
>>> ---------
>>> Lom
>>>
>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com> wrote:
>>>
>>>> Roger's example works for me and gives a list of length 101. I did have
>>>> some issues that were resolved by updating packages. I'm using R 3.6.3
>> on
>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R 3.6.3.
>>>>
>>>> Kent
>>>>
>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>>>
>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>
>>>>>> rtree uses Euclidean distance so the points should be in a coordinate
>>>>>> system where this makes sense at least as a reasonable approximation.
>>>>>
>>>>> I tried the original example:
>>>>>
>>>>> remotes::install_github("hunzikp/rtree")
>>>>> library(spData)
>>>>> library(sf)
>>>>> projdata<-st_transform(nz_height, 32759)
>>>>> library(rtree)
>>>>> pts <- st_coordinates(projdata)
>>>>> rt <- RTree(st_coordinates(projdata))
>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>>>
>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
>>>>>
>>>>> Error in UseMethod("withinDistance", rTree) :
>>>>>    no applicable method for 'withinDistance' applied to an object of
>>>>> class
>>>>> "c('list', 'RTree')"
>>>>>
>>>>>>
>>>>>> Kent
>>>>>>
>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>>> wrote:
>>>>>>
>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>
>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
>> neighboring
>>>>>>>>>         points within specified radii (distances) for each point
>> in a
>>>>>>> given
>>>>>>>>>         points data set.
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>> Hello,
>>>>>>>>> I have data set of about 3400 location points with which I am
>> trying
>>>>> to
>>>>>>>>> generate data of each point and their neighbors within defined
>> radii
>>>>>>> (eg,
>>>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>>>
>>>>>>>>
>>>>>>>> The rtree package is very fast and memory-efficient for
>>>>> within-distance
>>>>>>>> calculations.
>>>>>>>> https://github.com/hunzikp/rtree
>>>>>>>
>>>>>>> Thanks! Does this also apply when the input points are in
>> geographical
>>>>>>> coordinates?
>>>>>>>
>>>>>>> Roger
>>>>>>>
>>>>>>>>
>>>>>>>> Kent Johnson
>>>>>>>> Cambridge, MA
>>>>>>>>
>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Roger Bivand
>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>> https://orcid.org/0000-0003-2392-6140
>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Jun  4 21:52:28 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 4 Jun 2020 21:52:28 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>

On Thu, 4 Jun 2020, Lom Navanyo wrote:

> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS approach. I
> have a variable I intend to use as an IV for y.
> I have seen a few papers use this approach. Will this approach not correct
> for the endogeneity?
>
> Actually, I am not sure if this is a right forum or perhaps if it's
> appropriate or acceptable to you to take this one-on-one with you for help:

I do not offer private help. That would presuppose that one person has the 
answer. It would also presuppose that all exchanges are only read by the 
original poster and direct participants, while in fact others may join in, 
or follow a thread, or find the thread by searching: google supports the 
list:r-sig-geo search tag. If the thread goes private, that search is 
fruitless.

> My model actually looks like this: y= f(y, x)  + e.
> Aside the endogeneity of y (which I intend to instrument by another
> variable z), there is simultaneity between y and x.
> I intend to use the lag of x as instrument for x.  Given that I am seeking
> to test spatial dependency, do you see some fatal flaws with my approach?
>

What is the support of your observations, point, or are they aggregations? 
Why may proximity make a difference - often, apparent spatial 
autocorrelation is caused by observing inappropriate entities, or by 
omitting covariates, or by using the wrong functional form.


> I have also seen other empirical approaches like static and dynamic spatial
> panel data modelling. I will be reviewing them also to see suitability for
> my objective.
> But, any further directions or suggestions are highly appreciated.

If the data are spatial panel, you can look at the splm package. 
Personally, I have never found instruments any use at all, because the 
instruments are typically at best weak because of shared spatial processes 
with the response, unless the model is really well specified from known 
theory. In space, almost everything is close to endogeneous unless the 
opposite is demonstrated. So causal relationships are less worthwhile, 
because they are at best conditional on omitted variables and 
autocorrelation engendered by the choice of observational entities.

Further, because spatial processes are driven by the inverse matrix of the 
input graph of proximate neighbours (the covariance matrix of the spatial 
process), you don't need to start from more than the first order 
neighbours. Maybe your x has the same spatial pattern as y, so that the 
residuals are white noise with no spatial structure.

Recently, analysts prefer to start with the SLX model (Halleck Vega & 
Elhorst 2015 and others), so that might be worth exploring. If only the 
direct impacts seem important, OLS may be enough.

Hope this helps,

Roger

>
> Thanks,
> -------------------
> Lom
>
>
>
> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>
>>> Thank you very much for your support. This gives me what I need and I
>> must
>>> say listw2sn() is really great.
>>>
>>> Why do I need the data in the format as in dataout? I am trying to test
>>> spatial dependence (or neighborhood effect) by running a regression
>>> model that entails pop_size_it = beta_1*sum of pop_size of point i's
>>> neighbors within a specified radius. So my plan is to get the neighbors
>>> for each focal point as per the specified bands and their attributes (eg
>>> pop_size) so I can can add them (attribute) by the bands.
>>
>> Thanks, clarifies a good deal. Maybe look at the original localG articles
>> for exploring distance relationships (Getis and Ord looked at HIV/AIDS);
>> ?spdep::localG or https://r-spatial.github.io/spdep/reference/localG.html.
>>
>> Further note at OLS is biased as you have y = f(y) + e, so y on both
>> sides. The nearest equivalent for a single band is spatialreg::lagsarlm()
>> with listw=nb2listw(wd1, style="B") to get the neighbour sums through the
>> weights matrix. So both your betas and their standard errors are unusable,
>> I'm afraid. You are actually very much closer to ordinary kriging, looking
>> at the way in which distance attenuates the correlation in value of
>> proximate observations.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>>
>>> I am totally new to the area of spatial econometrics, so I am taking
>> things
>>> one step at a time. Some readings suggest I may need distance matrix or
>>> weight matrix but for now I think I should try the current approach.
>>>
>>> Thank you.
>>>
>>> -------------
>>> Lom
>>>
>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>>>>
>>>>> I had the errors with rtree using R 3.6.3. I have since changed to R
>>>> 4.0.0
>>>>> but I got the same error.
>>>>>
>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
>> with
>>>>> length 101. I think my difficulty is my inability to output the list
>>>>> detailing the point IDs t50_fid.
>>>>
>>>> library(spData)
>>>> library(sf)
>>>> projdata<-st_transform(nz_height, 32759)
>>>> pts <- st_coordinates(projdata)
>>>> library(spdep)
>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>> bds <- c(0, bufferR)
>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
>> sn_band4))
>>>> class(data_out) <- "data.frame"
>>>> table(data_out$band)
>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
>>>> data_out$elev_from <- projdata$elevation[data_out$from]
>>>> data_out$elev_to <- projdata$elevation[data_out$to]
>>>> str(data_out)
>>>>
>>>> The "spatial.neighbour" representation was that used in the S-Plus
>>>> SpatialStats module, with "from" and "to" columns, and here drops
>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
>>>> for creating the output, and from there, just look-up in the
>>>> input data.frame. Observations here cannot be their own neighbours.
>>>>
>>>> It would be relevant to know why you need these, are you looking at
>>>> variogram clouds?
>>>>
>>>> Hope this clarifies,
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> ---------
>>>>> Lom
>>>>>
>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
>> wrote:
>>>>>
>>>>>> Roger's example works for me and gives a list of length 101. I did
>> have
>>>>>> some issues that were resolved by updating packages. I'm using R 3.6.3
>>>> on
>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
>> 3.6.3.
>>>>>>
>>>>>> Kent
>>>>>>
>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
>>>> wrote:
>>>>>>
>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>
>>>>>>>> rtree uses Euclidean distance so the points should be in a
>> coordinate
>>>>>>>> system where this makes sense at least as a reasonable
>> approximation.
>>>>>>>
>>>>>>> I tried the original example:
>>>>>>>
>>>>>>> remotes::install_github("hunzikp/rtree")
>>>>>>> library(spData)
>>>>>>> library(sf)
>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>> library(rtree)
>>>>>>> pts <- st_coordinates(projdata)
>>>>>>> rt <- RTree(st_coordinates(projdata))
>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>>>>>
>>>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
>>>>>>>
>>>>>>> Error in UseMethod("withinDistance", rTree) :
>>>>>>>    no applicable method for 'withinDistance' applied to an object of
>>>>>>> class
>>>>>>> "c('list', 'RTree')"
>>>>>>>
>>>>>>>>
>>>>>>>> Kent
>>>>>>>>
>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>>>>> wrote:
>>>>>>>>
>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>
>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
>>>> neighboring
>>>>>>>>>>>         points within specified radii (distances) for each point
>>>> in a
>>>>>>>>> given
>>>>>>>>>>>         points data set.
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> Hello,
>>>>>>>>>>> I have data set of about 3400 location points with which I am
>>>> trying
>>>>>>> to
>>>>>>>>>>> generate data of each point and their neighbors within defined
>>>> radii
>>>>>>>>> (eg,
>>>>>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> The rtree package is very fast and memory-efficient for
>>>>>>> within-distance
>>>>>>>>>> calculations.
>>>>>>>>>> https://github.com/hunzikp/rtree
>>>>>>>>>
>>>>>>>>> Thanks! Does this also apply when the input points are in
>>>> geographical
>>>>>>>>> coordinates?
>>>>>>>>>
>>>>>>>>> Roger
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Kent Johnson
>>>>>>>>>> Cambridge, MA
>>>>>>>>>>
>>>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>>>
>>>>>>>>>> _______________________________________________
>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> Roger Bivand
>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Roger Bivand
>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From |omn@v@@|@ @end|ng |rom gm@||@com  Thu Jun  4 20:50:25 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Thu, 4 Jun 2020 13:50:25 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
Message-ID: <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>

Thank you. Yes, the OLS is biased and my plan is to use a 2SLS approach. I
have a variable I intend to use as an IV for y.
I have seen a few papers use this approach. Will this approach not correct
for the endogeneity?

Actually, I am not sure if this is a right forum or perhaps if it's
appropriate or acceptable to you to take this one-on-one with you for help:
My model actually looks like this: y= f(y, x)  + e.
Aside the endogeneity of y (which I intend to instrument by another
variable z), there is simultaneity between y and x.
I intend to use the lag of x as instrument for x.  Given that I am seeking
to test spatial dependency, do you see some fatal flaws with my approach?

I have also seen other empirical approaches like static and dynamic spatial
panel data modelling. I will be reviewing them also to see suitability for
my objective.
But, any further directions or suggestions are highly appreciated.

Thanks,
-------------------
Lom



On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>
> > Thank you very much for your support. This gives me what I need and I
> must
> > say listw2sn() is really great.
> >
> > Why do I need the data in the format as in dataout? I am trying to test
> > spatial dependence (or neighborhood effect) by running a regression
> > model that entails pop_size_it = beta_1*sum of pop_size of point i's
> > neighbors within a specified radius. So my plan is to get the neighbors
> > for each focal point as per the specified bands and their attributes (eg
> > pop_size) so I can can add them (attribute) by the bands.
>
> Thanks, clarifies a good deal. Maybe look at the original localG articles
> for exploring distance relationships (Getis and Ord looked at HIV/AIDS);
> ?spdep::localG or https://r-spatial.github.io/spdep/reference/localG.html.
>
> Further note at OLS is biased as you have y = f(y) + e, so y on both
> sides. The nearest equivalent for a single band is spatialreg::lagsarlm()
> with listw=nb2listw(wd1, style="B") to get the neighbour sums through the
> weights matrix. So both your betas and their standard errors are unusable,
> I'm afraid. You are actually very much closer to ordinary kriging, looking
> at the way in which distance attenuates the correlation in value of
> proximate observations.
>
> Hope this clarifies,
>
> Roger
>
> >
> > I am totally new to the area of spatial econometrics, so I am taking
> things
> > one step at a time. Some readings suggest I may need distance matrix or
> > weight matrix but for now I think I should try the current approach.
> >
> > Thank you.
> >
> > -------------
> > Lom
> >
> > On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Wed, 3 Jun 2020, Lom Navanyo wrote:
> >>
> >>> I had the errors with rtree using R 3.6.3. I have since changed to R
> >> 4.0.0
> >>> but I got the same error.
> >>>
> >>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
> with
> >>> length 101. I think my difficulty is my inability to output the list
> >>> detailing the point IDs t50_fid.
> >>
> >> library(spData)
> >> library(sf)
> >> projdata<-st_transform(nz_height, 32759)
> >> pts <- st_coordinates(projdata)
> >> library(spdep)
> >> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >> bds <- c(0, bufferR)
> >> wd1 <- dnearneigh(pts, bds[1], bds[2])
> >> wd2 <- dnearneigh(pts, bds[2], bds[3])
> >> wd3 <- dnearneigh(pts, bds[3], bds[4])
> >> wd4 <- dnearneigh(pts, bds[4], bds[5])
> >> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> >> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> >> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> >> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> >> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> >> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> >> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> >> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> >> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
> sn_band4))
> >> class(data_out) <- "data.frame"
> >> table(data_out$band)
> >> data_out$ID_from <- projdata$t50_fid[data_out$from]
> >> data_out$ID_to <- projdata$t50_fid[data_out$to]
> >> data_out$elev_from <- projdata$elevation[data_out$from]
> >> data_out$elev_to <- projdata$elevation[data_out$to]
> >> str(data_out)
> >>
> >> The "spatial.neighbour" representation was that used in the S-Plus
> >> SpatialStats module, with "from" and "to" columns, and here drops
> >> no-neighbour cases gracefully. So listw2sn() comes in useful
> >> for creating the output, and from there, just look-up in the
> >> input data.frame. Observations here cannot be their own neighbours.
> >>
> >> It would be relevant to know why you need these, are you looking at
> >> variogram clouds?
> >>
> >> Hope this clarifies,
> >>
> >> Roger
> >>
> >>>
> >>> ---------
> >>> Lom
> >>>
> >>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
> wrote:
> >>>
> >>>> Roger's example works for me and gives a list of length 101. I did
> have
> >>>> some issues that were resolved by updating packages. I'm using R 3.6.3
> >> on
> >>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
> 3.6.3.
> >>>>
> >>>> Kent
> >>>>
> >>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
> >> wrote:
> >>>>
> >>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>
> >>>>>> rtree uses Euclidean distance so the points should be in a
> coordinate
> >>>>>> system where this makes sense at least as a reasonable
> approximation.
> >>>>>
> >>>>> I tried the original example:
> >>>>>
> >>>>> remotes::install_github("hunzikp/rtree")
> >>>>> library(spData)
> >>>>> library(sf)
> >>>>> projdata<-st_transform(nz_height, 32759)
> >>>>> library(rtree)
> >>>>> pts <- st_coordinates(projdata)
> >>>>> rt <- RTree(st_coordinates(projdata))
> >>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>>>
> >>>>> but unfortunately failed (maybe newer Boost headers than yours?):
> >>>>>
> >>>>> Error in UseMethod("withinDistance", rTree) :
> >>>>>    no applicable method for 'withinDistance' applied to an object of
> >>>>> class
> >>>>> "c('list', 'RTree')"
> >>>>>
> >>>>>>
> >>>>>> Kent
> >>>>>>
> >>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
> >>>>> wrote:
> >>>>>>
> >>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>
> >>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>>>> To: r-sig-geo at r-project.org
> >>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> >> neighboring
> >>>>>>>>>         points within specified radii (distances) for each point
> >> in a
> >>>>>>> given
> >>>>>>>>>         points data set.
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>> Hello,
> >>>>>>>>> I have data set of about 3400 location points with which I am
> >> trying
> >>>>> to
> >>>>>>>>> generate data of each point and their neighbors within defined
> >> radii
> >>>>>>> (eg,
> >>>>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>> The rtree package is very fast and memory-efficient for
> >>>>> within-distance
> >>>>>>>> calculations.
> >>>>>>>> https://github.com/hunzikp/rtree
> >>>>>>>
> >>>>>>> Thanks! Does this also apply when the input points are in
> >> geographical
> >>>>>>> coordinates?
> >>>>>>>
> >>>>>>> Roger
> >>>>>>>
> >>>>>>>>
> >>>>>>>> Kent Johnson
> >>>>>>>> Cambridge, MA
> >>>>>>>>
> >>>>>>>>       [[alternative HTML version deleted]]
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> R-sig-Geo mailing list
> >>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>>
> >>>>>>>
> >>>>>>> --
> >>>>>>> Roger Bivand
> >>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>
> >>>>>>
> >>>>>
> >>>>> --
> >>>>> Roger Bivand
> >>>>> Department of Economics, Norwegian School of Economics,
> >>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>> https://orcid.org/0000-0003-2392-6140
> >>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From @turm|echen @end|ng |rom gm@||@com  Fri Jun  5 07:14:03 2020
From: @turm|echen @end|ng |rom gm@||@com (Lena Fehlhaber)
Date: Fri, 5 Jun 2020 07:14:03 +0200
Subject: [R-sig-Geo] GLM model with spatialspillover on categorical variables
In-Reply-To: <CA+yGT=FSy2F13gehU4uopD7kCp3GFtgNnsAcqKM4a74SGsbmnA@mail.gmail.com>
References: <CA+yGT=FSy2F13gehU4uopD7kCp3GFtgNnsAcqKM4a74SGsbmnA@mail.gmail.com>
Message-ID: <CA+yGT=FVYCFasyhMjSX8prwfwAPh6Wd2BRs7OyiLeGR_=aZXoA@mail.gmail.com>

I did a regression analysis with categorical data with a glm model
approach, which worked fine. I have longitude and latitude coordinates for
each observation and I want to add their geographic spillover effect to the
model.

My sample data is structured:

Index DV IVI IVII IVIII IVIV Long Lat
 1  0  2  1  3  -12  -17.8  12
 2  0  1  1  6  112  11  -122
 3  1  3  6  1  91  57  53

with regression eq. DV ~ IVI + IVII + IVIII + IVIV

That mentioned, I assume that the nearer regions are, the more it may
influence my dependant variable. I found several approaches for spatial
regression models, but not for categorical data. I tried to use existing
libraries and functions, such as spdep's lagsarlm, glmmfields, spatialreg,
gstat, geoRglm and many more (I used this list as a reference:
https://cran.r-project.org/web/views/Spatial.html ). For numeric values, I
am able to do spatial regression, but for categorical values, I struggle.
The data structure is the following:

library(dplyr)
data <- data %>%
  mutate(
    DV = as.factor(DV),
    IVI = as.factor(IVI),
    IVII = as.factor(IVII),
    IVIII = as.factor(IVIII),
    IVIV = as.numeric(IVIV),
    longitude = as.numeric(longitude),
    latitude = as.numeric(latitude)
  )

My dependant variable (0|1) as well as my independant variables are
categorical and it would be no use to transform them, of course. I want to
have an other glm model in the end, but with spatial spillover effects
included. The libraries I tested so far can't handle categorical data. Any
leads/ideas would be greatly appreciated.

Thanks a lot.

	[[alternative HTML version deleted]]


From |omn@v@@|@ @end|ng |rom gm@||@com  Fri Jun  5 10:12:06 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Fri, 5 Jun 2020 03:12:06 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
Message-ID: <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>

I fully agree with you and appreciate the listed benefits of not taking
things private. I was just trying to be sure the forum here is appropriate
and receptive of a beginner like me.

To be more explicit with regards to my observations, y is amount of water
withdrawal from wells and an important variable in x is (height of) water
level in the wells. These are end of year figures. I am using the
aggregations (sum for y and mean for water level) by band as spatial
neighborhood variables. There will be one or two indicator variables also
in x. I hope these do not
present additional hurdles.

 I am thinking Proximity is relevant in testing spatial
dependency/externality.

I will consider splm package  and the SLX model.

Thank you.
---------------
Lom

On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>
> > Thank you. Yes, the OLS is biased and my plan is to use a 2SLS approach.
> I
> > have a variable I intend to use as an IV for y.
> > I have seen a few papers use this approach. Will this approach not
> correct
> > for the endogeneity?
> >
> > Actually, I am not sure if this is a right forum or perhaps if it's
> > appropriate or acceptable to you to take this one-on-one with you for
> help:
>
> I do not offer private help. That would presuppose that one person has the
> answer. It would also presuppose that all exchanges are only read by the
> original poster and direct participants, while in fact others may join in,
> or follow a thread, or find the thread by searching: google supports the
> list:r-sig-geo search tag. If the thread goes private, that search is
> fruitless.
>
> > My model actually looks like this: y= f(y, x)  + e.
> > Aside the endogeneity of y (which I intend to instrument by another
> > variable z), there is simultaneity between y and x.
> > I intend to use the lag of x as instrument for x.  Given that I am
> seeking
> > to test spatial dependency, do you see some fatal flaws with my approach?
> >
>
> What is the support of your observations, point, or are they aggregations?
> Why may proximity make a difference - often, apparent spatial
> autocorrelation is caused by observing inappropriate entities, or by
> omitting covariates, or by using the wrong functional form.
>
>
> > I have also seen other empirical approaches like static and dynamic
> spatial
> > panel data modelling. I will be reviewing them also to see suitability
> for
> > my objective.
> > But, any further directions or suggestions are highly appreciated.
>
> If the data are spatial panel, you can look at the splm package.
> Personally, I have never found instruments any use at all, because the
> instruments are typically at best weak because of shared spatial processes
> with the response, unless the model is really well specified from known
> theory. In space, almost everything is close to endogeneous unless the
> opposite is demonstrated. So causal relationships are less worthwhile,
> because they are at best conditional on omitted variables and
> autocorrelation engendered by the choice of observational entities.
>
> Further, because spatial processes are driven by the inverse matrix of the
> input graph of proximate neighbours (the covariance matrix of the spatial
> process), you don't need to start from more than the first order
> neighbours. Maybe your x has the same spatial pattern as y, so that the
> residuals are white noise with no spatial structure.
>
> Recently, analysts prefer to start with the SLX model (Halleck Vega &
> Elhorst 2015 and others), so that might be worth exploring. If only the
> direct impacts seem important, OLS may be enough.
>
> Hope this helps,
>
> Roger
>
> >
> > Thanks,
> > -------------------
> > Lom
> >
> >
> >
> > On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>
> >>> Thank you very much for your support. This gives me what I need and I
> >> must
> >>> say listw2sn() is really great.
> >>>
> >>> Why do I need the data in the format as in dataout? I am trying to test
> >>> spatial dependence (or neighborhood effect) by running a regression
> >>> model that entails pop_size_it = beta_1*sum of pop_size of point i's
> >>> neighbors within a specified radius. So my plan is to get the neighbors
> >>> for each focal point as per the specified bands and their attributes
> (eg
> >>> pop_size) so I can can add them (attribute) by the bands.
> >>
> >> Thanks, clarifies a good deal. Maybe look at the original localG
> articles
> >> for exploring distance relationships (Getis and Ord looked at HIV/AIDS);
> >> ?spdep::localG or
> https://r-spatial.github.io/spdep/reference/localG.html.
> >>
> >> Further note at OLS is biased as you have y = f(y) + e, so y on both
> >> sides. The nearest equivalent for a single band is
> spatialreg::lagsarlm()
> >> with listw=nb2listw(wd1, style="B") to get the neighbour sums through
> the
> >> weights matrix. So both your betas and their standard errors are
> unusable,
> >> I'm afraid. You are actually very much closer to ordinary kriging,
> looking
> >> at the way in which distance attenuates the correlation in value of
> >> proximate observations.
> >>
> >> Hope this clarifies,
> >>
> >> Roger
> >>
> >>>
> >>> I am totally new to the area of spatial econometrics, so I am taking
> >> things
> >>> one step at a time. Some readings suggest I may need distance matrix or
> >>> weight matrix but for now I think I should try the current approach.
> >>>
> >>> Thank you.
> >>>
> >>> -------------
> >>> Lom
> >>>
> >>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>>
> >>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
> >>>>
> >>>>> I had the errors with rtree using R 3.6.3. I have since changed to R
> >>>> 4.0.0
> >>>>> but I got the same error.
> >>>>>
> >>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
> >> with
> >>>>> length 101. I think my difficulty is my inability to output the list
> >>>>> detailing the point IDs t50_fid.
> >>>>
> >>>> library(spData)
> >>>> library(sf)
> >>>> projdata<-st_transform(nz_height, 32759)
> >>>> pts <- st_coordinates(projdata)
> >>>> library(spdep)
> >>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>> bds <- c(0, bufferR)
> >>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
> >>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
> >>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
> >>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
> >>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> >>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> >>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> >>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> >>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> >>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> >>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> >>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> >>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
> >> sn_band4))
> >>>> class(data_out) <- "data.frame"
> >>>> table(data_out$band)
> >>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
> >>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
> >>>> data_out$elev_from <- projdata$elevation[data_out$from]
> >>>> data_out$elev_to <- projdata$elevation[data_out$to]
> >>>> str(data_out)
> >>>>
> >>>> The "spatial.neighbour" representation was that used in the S-Plus
> >>>> SpatialStats module, with "from" and "to" columns, and here drops
> >>>> no-neighbour cases gracefully. So listw2sn() comes in useful
> >>>> for creating the output, and from there, just look-up in the
> >>>> input data.frame. Observations here cannot be their own neighbours.
> >>>>
> >>>> It would be relevant to know why you need these, are you looking at
> >>>> variogram clouds?
> >>>>
> >>>> Hope this clarifies,
> >>>>
> >>>> Roger
> >>>>
> >>>>>
> >>>>> ---------
> >>>>> Lom
> >>>>>
> >>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
> >> wrote:
> >>>>>
> >>>>>> Roger's example works for me and gives a list of length 101. I did
> >> have
> >>>>>> some issues that were resolved by updating packages. I'm using R
> 3.6.3
> >>>> on
> >>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
> >> 3.6.3.
> >>>>>>
> >>>>>> Kent
> >>>>>>
> >>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
> >>>> wrote:
> >>>>>>
> >>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>
> >>>>>>>> rtree uses Euclidean distance so the points should be in a
> >> coordinate
> >>>>>>>> system where this makes sense at least as a reasonable
> >> approximation.
> >>>>>>>
> >>>>>>> I tried the original example:
> >>>>>>>
> >>>>>>> remotes::install_github("hunzikp/rtree")
> >>>>>>> library(spData)
> >>>>>>> library(sf)
> >>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>> library(rtree)
> >>>>>>> pts <- st_coordinates(projdata)
> >>>>>>> rt <- RTree(st_coordinates(projdata))
> >>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>>>>>
> >>>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
> >>>>>>>
> >>>>>>> Error in UseMethod("withinDistance", rTree) :
> >>>>>>>    no applicable method for 'withinDistance' applied to an object
> of
> >>>>>>> class
> >>>>>>> "c('list', 'RTree')"
> >>>>>>>
> >>>>>>>>
> >>>>>>>> Kent
> >>>>>>>>
> >>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
> >>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>
> >>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>>>>>> To: r-sig-geo at r-project.org
> >>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> >>>> neighboring
> >>>>>>>>>>>         points within specified radii (distances) for each
> point
> >>>> in a
> >>>>>>>>> given
> >>>>>>>>>>>         points data set.
> >>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>>> Hello,
> >>>>>>>>>>> I have data set of about 3400 location points with which I am
> >>>> trying
> >>>>>>> to
> >>>>>>>>>>> generate data of each point and their neighbors within defined
> >>>> radii
> >>>>>>>>> (eg,
> >>>>>>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>> The rtree package is very fast and memory-efficient for
> >>>>>>> within-distance
> >>>>>>>>>> calculations.
> >>>>>>>>>> https://github.com/hunzikp/rtree
> >>>>>>>>>
> >>>>>>>>> Thanks! Does this also apply when the input points are in
> >>>> geographical
> >>>>>>>>> coordinates?
> >>>>>>>>>
> >>>>>>>>> Roger
> >>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>> Kent Johnson
> >>>>>>>>>> Cambridge, MA
> >>>>>>>>>>
> >>>>>>>>>>       [[alternative HTML version deleted]]
> >>>>>>>>>>
> >>>>>>>>>> _______________________________________________
> >>>>>>>>>> R-sig-Geo mailing list
> >>>>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> --
> >>>>>>>>> Roger Bivand
> >>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>
> >>>>>>> --
> >>>>>>> Roger Bivand
> >>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>
> >>>>>>
> >>>>>
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>> https://orcid.org/0000-0003-2392-6140
> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Fri Jun  5 10:51:20 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 5 Jun 2020 10:51:20 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>

On Fri, 5 Jun 2020, Lom Navanyo wrote:

> I fully agree with you and appreciate the listed benefits of not taking
> things private. I was just trying to be sure the forum here is appropriate
> and receptive of a beginner like me.
>
> To be more explicit with regards to my observations, y is amount of 
> water withdrawal from wells and an important variable in x is (height 
> of) water level in the wells. These are end of year figures. I am using 
> the aggregations (sum for y and mean for water level) by band as spatial 
> neighborhood variables. There will be one or two indicator variables 
> also in x. I hope these do not present additional hurdles.

There are several further questions. If water level is measured at 
end-of-year, it is instantaneous at that point, and will depend on level a 
year earlier plus inflow from the movements of the water table 
(precipitation, soils and surface geology, maybe geology if deeper wells), 
minus evaporation (if an open well) and extraction. However, your y 
(extraction) is probably measured over an interval (1 Jan - 31 Dec?). It 
does not depend on level unless level is 0, but depends on the closeness 
of people extracting water for domestic, agricultural or other use.

All else equal, you would expect changes in the level in a well to depend 
on inputs, evaporation and extraction, and extraction at that well and 
other nearby wells (which may experience falls in the ground water table 
level not because the water was extracted from those wells, but at 
neighbouring wells. You may also see users shifting to neerby wells if 
their closest well runs dry.

So you probably need to start with a deterministic hydrological model, and 
you need much more information about who extracts and why. Say in India, 
you would also need price data - apparently free water has led to 
over-extraction.

So I would advise against any spatial econometric analysis of the data you 
have, because so much is going on in the system as a whole that you cannot 
control if all the data you have is as you describe. I also understand 
better why well water level is endogeneous, but am sure that IV will not 
help, since the level is being driven partly by a deterministic 
hydrological system which differs from well to well, and extraction varies 
by demand.

Has anyone worked with this kind of data? Any ideas or contributions more 
helpful than the above?

Roger

>
> I am thinking Proximity is relevant in testing spatial
> dependency/externality.
>
> I will consider splm package  and the SLX model.
>
> Thank you.
> ---------------
> Lom
>
> On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>
>>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS approach.
>> I
>>> have a variable I intend to use as an IV for y.
>>> I have seen a few papers use this approach. Will this approach not
>> correct
>>> for the endogeneity?
>>>
>>> Actually, I am not sure if this is a right forum or perhaps if it's
>>> appropriate or acceptable to you to take this one-on-one with you for
>> help:
>>
>> I do not offer private help. That would presuppose that one person has the
>> answer. It would also presuppose that all exchanges are only read by the
>> original poster and direct participants, while in fact others may join in,
>> or follow a thread, or find the thread by searching: google supports the
>> list:r-sig-geo search tag. If the thread goes private, that search is
>> fruitless.
>>
>>> My model actually looks like this: y= f(y, x)  + e.
>>> Aside the endogeneity of y (which I intend to instrument by another
>>> variable z), there is simultaneity between y and x.
>>> I intend to use the lag of x as instrument for x.  Given that I am
>> seeking
>>> to test spatial dependency, do you see some fatal flaws with my approach?
>>>
>>
>> What is the support of your observations, point, or are they aggregations?
>> Why may proximity make a difference - often, apparent spatial
>> autocorrelation is caused by observing inappropriate entities, or by
>> omitting covariates, or by using the wrong functional form.
>>
>>
>>> I have also seen other empirical approaches like static and dynamic
>> spatial
>>> panel data modelling. I will be reviewing them also to see suitability
>> for
>>> my objective.
>>> But, any further directions or suggestions are highly appreciated.
>>
>> If the data are spatial panel, you can look at the splm package.
>> Personally, I have never found instruments any use at all, because the
>> instruments are typically at best weak because of shared spatial processes
>> with the response, unless the model is really well specified from known
>> theory. In space, almost everything is close to endogeneous unless the
>> opposite is demonstrated. So causal relationships are less worthwhile,
>> because they are at best conditional on omitted variables and
>> autocorrelation engendered by the choice of observational entities.
>>
>> Further, because spatial processes are driven by the inverse matrix of the
>> input graph of proximate neighbours (the covariance matrix of the spatial
>> process), you don't need to start from more than the first order
>> neighbours. Maybe your x has the same spatial pattern as y, so that the
>> residuals are white noise with no spatial structure.
>>
>> Recently, analysts prefer to start with the SLX model (Halleck Vega &
>> Elhorst 2015 and others), so that might be worth exploring. If only the
>> direct impacts seem important, OLS may be enough.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> Thanks,
>>> -------------------
>>> Lom
>>>
>>>
>>>
>>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>>>
>>>>> Thank you very much for your support. This gives me what I need and I
>>>> must
>>>>> say listw2sn() is really great.
>>>>>
>>>>> Why do I need the data in the format as in dataout? I am trying to test
>>>>> spatial dependence (or neighborhood effect) by running a regression
>>>>> model that entails pop_size_it = beta_1*sum of pop_size of point i's
>>>>> neighbors within a specified radius. So my plan is to get the neighbors
>>>>> for each focal point as per the specified bands and their attributes
>> (eg
>>>>> pop_size) so I can can add them (attribute) by the bands.
>>>>
>>>> Thanks, clarifies a good deal. Maybe look at the original localG
>> articles
>>>> for exploring distance relationships (Getis and Ord looked at HIV/AIDS);
>>>> ?spdep::localG or
>> https://r-spatial.github.io/spdep/reference/localG.html.
>>>>
>>>> Further note at OLS is biased as you have y = f(y) + e, so y on both
>>>> sides. The nearest equivalent for a single band is
>> spatialreg::lagsarlm()
>>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums through
>> the
>>>> weights matrix. So both your betas and their standard errors are
>> unusable,
>>>> I'm afraid. You are actually very much closer to ordinary kriging,
>> looking
>>>> at the way in which distance attenuates the correlation in value of
>>>> proximate observations.
>>>>
>>>> Hope this clarifies,
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> I am totally new to the area of spatial econometrics, so I am taking
>>>> things
>>>>> one step at a time. Some readings suggest I may need distance matrix or
>>>>> weight matrix but for now I think I should try the current approach.
>>>>>
>>>>> Thank you.
>>>>>
>>>>> -------------
>>>>> Lom
>>>>>
>>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>>>>
>>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>>>>>>
>>>>>>> I had the errors with rtree using R 3.6.3. I have since changed to R
>>>>>> 4.0.0
>>>>>>> but I got the same error.
>>>>>>>
>>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
>>>> with
>>>>>>> length 101. I think my difficulty is my inability to output the list
>>>>>>> detailing the point IDs t50_fid.
>>>>>>
>>>>>> library(spData)
>>>>>> library(sf)
>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>> pts <- st_coordinates(projdata)
>>>>>> library(spdep)
>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>> bds <- c(0, bufferR)
>>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
>>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
>>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
>>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
>>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
>>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
>>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
>>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
>>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
>>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
>>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
>>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
>>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
>>>> sn_band4))
>>>>>> class(data_out) <- "data.frame"
>>>>>> table(data_out$band)
>>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
>>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
>>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
>>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
>>>>>> str(data_out)
>>>>>>
>>>>>> The "spatial.neighbour" representation was that used in the S-Plus
>>>>>> SpatialStats module, with "from" and "to" columns, and here drops
>>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
>>>>>> for creating the output, and from there, just look-up in the
>>>>>> input data.frame. Observations here cannot be their own neighbours.
>>>>>>
>>>>>> It would be relevant to know why you need these, are you looking at
>>>>>> variogram clouds?
>>>>>>
>>>>>> Hope this clarifies,
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>> ---------
>>>>>>> Lom
>>>>>>>
>>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
>>>> wrote:
>>>>>>>
>>>>>>>> Roger's example works for me and gives a list of length 101. I did
>>>> have
>>>>>>>> some issues that were resolved by updating packages. I'm using R
>> 3.6.3
>>>>>> on
>>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
>>>> 3.6.3.
>>>>>>>>
>>>>>>>> Kent
>>>>>>>>
>>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no>
>>>>>> wrote:
>>>>>>>>
>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>
>>>>>>>>>> rtree uses Euclidean distance so the points should be in a
>>>> coordinate
>>>>>>>>>> system where this makes sense at least as a reasonable
>>>> approximation.
>>>>>>>>>
>>>>>>>>> I tried the original example:
>>>>>>>>>
>>>>>>>>> remotes::install_github("hunzikp/rtree")
>>>>>>>>> library(spData)
>>>>>>>>> library(sf)
>>>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>>>> library(rtree)
>>>>>>>>> pts <- st_coordinates(projdata)
>>>>>>>>> rt <- RTree(st_coordinates(projdata))
>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>>>>>>>
>>>>>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
>>>>>>>>>
>>>>>>>>> Error in UseMethod("withinDistance", rTree) :
>>>>>>>>>    no applicable method for 'withinDistance' applied to an object
>> of
>>>>>>>>> class
>>>>>>>>> "c('list', 'RTree')"
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Kent
>>>>>>>>>>
>>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>>>>>>> wrote:
>>>>>>>>>>
>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>>>
>>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
>>>>>> neighboring
>>>>>>>>>>>>>         points within specified radii (distances) for each
>> point
>>>>>> in a
>>>>>>>>>>> given
>>>>>>>>>>>>>         points data set.
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>> I have data set of about 3400 location points with which I am
>>>>>> trying
>>>>>>>>> to
>>>>>>>>>>>>> generate data of each point and their neighbors within defined
>>>>>> radii
>>>>>>>>>>> (eg,
>>>>>>>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> The rtree package is very fast and memory-efficient for
>>>>>>>>> within-distance
>>>>>>>>>>>> calculations.
>>>>>>>>>>>> https://github.com/hunzikp/rtree
>>>>>>>>>>>
>>>>>>>>>>> Thanks! Does this also apply when the input points are in
>>>>>> geographical
>>>>>>>>>>> coordinates?
>>>>>>>>>>>
>>>>>>>>>>> Roger
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Kent Johnson
>>>>>>>>>>>> Cambridge, MA
>>>>>>>>>>>>
>>>>>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>>>>>
>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> --
>>>>>>>>>>> Roger Bivand
>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> Roger Bivand
>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From |omn@v@@|@ @end|ng |rom gm@||@com  Fri Jun  5 12:28:18 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Fri, 5 Jun 2020 05:28:18 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
Message-ID: <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>

Thank you once again. To clarify, which is more suitable, end of year water
levels or yearly average measure of water levels?

Also below are a few more notes to throw more light on my variables/data:

These wells are solely for irrigation purposes and are
irrigator/farmer-owned and operated.
No farmer/irrigator moves to another well not owned by him. The only reason
to suspect any spatial externalities is because the wells share a common
aquifer.
And this is essentially what I am testing.

It is also understood that there are not much variation in the geography
and geology of the study region.

I have data a number of well specific features in addition to the water
level. I also have some farm data including cropping and technology use
data. No soil data though.
No recharge data too as well.

In fact, I agree a lot factors can come to play here and I may not have or
observe all but I was thinking I could incorporate some fixed effects
to take care of those, especially for those I suspect (or perhaps by
theory) are likely to not vary much in terms of their effect on
irrigation(pumping) decisions across farmers
or effect on water level.

My panel is rather a short one: I have a five year panel data.

Given the above, is it still not advisable to use any spatial econometric
analysis? Just a simple OLS will suffice?

Thanks.
----------------------
Lom





On Fri, Jun 5, 2020 at 3:51 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 5 Jun 2020, Lom Navanyo wrote:
>
> > I fully agree with you and appreciate the listed benefits of not taking
> > things private. I was just trying to be sure the forum here is
> appropriate
> > and receptive of a beginner like me.
> >
> > To be more explicit with regards to my observations, y is amount of
> > water withdrawal from wells and an important variable in x is (height
> > of) water level in the wells. These are end of year figures. I am using
> > the aggregations (sum for y and mean for water level) by band as spatial
> > neighborhood variables. There will be one or two indicator variables
> > also in x. I hope these do not present additional hurdles.
>
> There are several further questions. If water level is measured at
> end-of-year, it is instantaneous at that point, and will depend on level a
> year earlier plus inflow from the movements of the water table
> (precipitation, soils and surface geology, maybe geology if deeper wells),
> minus evaporation (if an open well) and extraction. However, your y
> (extraction) is probably measured over an interval (1 Jan - 31 Dec?). It
> does not depend on level unless level is 0, but depends on the closeness
> of people extracting water for domestic, agricultural or other use.
>
> All else equal, you would expect changes in the level in a well to depend
> on inputs, evaporation and extraction, and extraction at that well and
> other nearby wells (which may experience falls in the ground water table
> level not because the water was extracted from those wells, but at
> neighbouring wells. You may also see users shifting to neerby wells if
> their closest well runs dry.
>
> So you probably need to start with a deterministic hydrological model, and
> you need much more information about who extracts and why. Say in India,
> you would also need price data - apparently free water has led to
> over-extraction.
>
> So I would advise against any spatial econometric analysis of the data you
> have, because so much is going on in the system as a whole that you cannot
> control if all the data you have is as you describe. I also understand
> better why well water level is endogeneous, but am sure that IV will not
> help, since the level is being driven partly by a deterministic
> hydrological system which differs from well to well, and extraction varies
> by demand.
>
> Has anyone worked with this kind of data? Any ideas or contributions more
> helpful than the above?
>
> Roger
>
> >
> > I am thinking Proximity is relevant in testing spatial
> > dependency/externality.
> >
> > I will consider splm package  and the SLX model.
> >
> > Thank you.
> > ---------------
> > Lom
> >
> > On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>
> >>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS
> approach.
> >> I
> >>> have a variable I intend to use as an IV for y.
> >>> I have seen a few papers use this approach. Will this approach not
> >> correct
> >>> for the endogeneity?
> >>>
> >>> Actually, I am not sure if this is a right forum or perhaps if it's
> >>> appropriate or acceptable to you to take this one-on-one with you for
> >> help:
> >>
> >> I do not offer private help. That would presuppose that one person has
> the
> >> answer. It would also presuppose that all exchanges are only read by the
> >> original poster and direct participants, while in fact others may join
> in,
> >> or follow a thread, or find the thread by searching: google supports the
> >> list:r-sig-geo search tag. If the thread goes private, that search is
> >> fruitless.
> >>
> >>> My model actually looks like this: y= f(y, x)  + e.
> >>> Aside the endogeneity of y (which I intend to instrument by another
> >>> variable z), there is simultaneity between y and x.
> >>> I intend to use the lag of x as instrument for x.  Given that I am
> >> seeking
> >>> to test spatial dependency, do you see some fatal flaws with my
> approach?
> >>>
> >>
> >> What is the support of your observations, point, or are they
> aggregations?
> >> Why may proximity make a difference - often, apparent spatial
> >> autocorrelation is caused by observing inappropriate entities, or by
> >> omitting covariates, or by using the wrong functional form.
> >>
> >>
> >>> I have also seen other empirical approaches like static and dynamic
> >> spatial
> >>> panel data modelling. I will be reviewing them also to see suitability
> >> for
> >>> my objective.
> >>> But, any further directions or suggestions are highly appreciated.
> >>
> >> If the data are spatial panel, you can look at the splm package.
> >> Personally, I have never found instruments any use at all, because the
> >> instruments are typically at best weak because of shared spatial
> processes
> >> with the response, unless the model is really well specified from known
> >> theory. In space, almost everything is close to endogeneous unless the
> >> opposite is demonstrated. So causal relationships are less worthwhile,
> >> because they are at best conditional on omitted variables and
> >> autocorrelation engendered by the choice of observational entities.
> >>
> >> Further, because spatial processes are driven by the inverse matrix of
> the
> >> input graph of proximate neighbours (the covariance matrix of the
> spatial
> >> process), you don't need to start from more than the first order
> >> neighbours. Maybe your x has the same spatial pattern as y, so that the
> >> residuals are white noise with no spatial structure.
> >>
> >> Recently, analysts prefer to start with the SLX model (Halleck Vega &
> >> Elhorst 2015 and others), so that might be worth exploring. If only the
> >> direct impacts seem important, OLS may be enough.
> >>
> >> Hope this helps,
> >>
> >> Roger
> >>
> >>>
> >>> Thanks,
> >>> -------------------
> >>> Lom
> >>>
> >>>
> >>>
> >>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>>
> >>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>>>
> >>>>> Thank you very much for your support. This gives me what I need and I
> >>>> must
> >>>>> say listw2sn() is really great.
> >>>>>
> >>>>> Why do I need the data in the format as in dataout? I am trying to
> test
> >>>>> spatial dependence (or neighborhood effect) by running a regression
> >>>>> model that entails pop_size_it = beta_1*sum of pop_size of point i's
> >>>>> neighbors within a specified radius. So my plan is to get the
> neighbors
> >>>>> for each focal point as per the specified bands and their attributes
> >> (eg
> >>>>> pop_size) so I can can add them (attribute) by the bands.
> >>>>
> >>>> Thanks, clarifies a good deal. Maybe look at the original localG
> >> articles
> >>>> for exploring distance relationships (Getis and Ord looked at
> HIV/AIDS);
> >>>> ?spdep::localG or
> >> https://r-spatial.github.io/spdep/reference/localG.html.
> >>>>
> >>>> Further note at OLS is biased as you have y = f(y) + e, so y on both
> >>>> sides. The nearest equivalent for a single band is
> >> spatialreg::lagsarlm()
> >>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums through
> >> the
> >>>> weights matrix. So both your betas and their standard errors are
> >> unusable,
> >>>> I'm afraid. You are actually very much closer to ordinary kriging,
> >> looking
> >>>> at the way in which distance attenuates the correlation in value of
> >>>> proximate observations.
> >>>>
> >>>> Hope this clarifies,
> >>>>
> >>>> Roger
> >>>>
> >>>>>
> >>>>> I am totally new to the area of spatial econometrics, so I am taking
> >>>> things
> >>>>> one step at a time. Some readings suggest I may need distance matrix
> or
> >>>>> weight matrix but for now I think I should try the current approach.
> >>>>>
> >>>>> Thank you.
> >>>>>
> >>>>> -------------
> >>>>> Lom
> >>>>>
> >>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
> >> wrote:
> >>>>>
> >>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
> >>>>>>
> >>>>>>> I had the errors with rtree using R 3.6.3. I have since changed to
> R
> >>>>>> 4.0.0
> >>>>>>> but I got the same error.
> >>>>>>>
> >>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
> >>>> with
> >>>>>>> length 101. I think my difficulty is my inability to output the
> list
> >>>>>>> detailing the point IDs t50_fid.
> >>>>>>
> >>>>>> library(spData)
> >>>>>> library(sf)
> >>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>> pts <- st_coordinates(projdata)
> >>>>>> library(spdep)
> >>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>> bds <- c(0, bufferR)
> >>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
> >>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
> >>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
> >>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
> >>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> >>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> >>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> >>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> >>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> >>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> >>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> >>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> >>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
> >>>> sn_band4))
> >>>>>> class(data_out) <- "data.frame"
> >>>>>> table(data_out$band)
> >>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
> >>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
> >>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
> >>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
> >>>>>> str(data_out)
> >>>>>>
> >>>>>> The "spatial.neighbour" representation was that used in the S-Plus
> >>>>>> SpatialStats module, with "from" and "to" columns, and here drops
> >>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
> >>>>>> for creating the output, and from there, just look-up in the
> >>>>>> input data.frame. Observations here cannot be their own neighbours.
> >>>>>>
> >>>>>> It would be relevant to know why you need these, are you looking at
> >>>>>> variogram clouds?
> >>>>>>
> >>>>>> Hope this clarifies,
> >>>>>>
> >>>>>> Roger
> >>>>>>
> >>>>>>>
> >>>>>>> ---------
> >>>>>>> Lom
> >>>>>>>
> >>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
> >>>> wrote:
> >>>>>>>
> >>>>>>>> Roger's example works for me and gives a list of length 101. I did
> >>>> have
> >>>>>>>> some issues that were resolved by updating packages. I'm using R
> >> 3.6.3
> >>>>>> on
> >>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
> >>>> 3.6.3.
> >>>>>>>>
> >>>>>>>> Kent
> >>>>>>>>
> >>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no
> >
> >>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>
> >>>>>>>>>> rtree uses Euclidean distance so the points should be in a
> >>>> coordinate
> >>>>>>>>>> system where this makes sense at least as a reasonable
> >>>> approximation.
> >>>>>>>>>
> >>>>>>>>> I tried the original example:
> >>>>>>>>>
> >>>>>>>>> remotes::install_github("hunzikp/rtree")
> >>>>>>>>> library(spData)
> >>>>>>>>> library(sf)
> >>>>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>>>> library(rtree)
> >>>>>>>>> pts <- st_coordinates(projdata)
> >>>>>>>>> rt <- RTree(st_coordinates(projdata))
> >>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>>>>>>>
> >>>>>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
> >>>>>>>>>
> >>>>>>>>> Error in UseMethod("withinDistance", rTree) :
> >>>>>>>>>    no applicable method for 'withinDistance' applied to an object
> >> of
> >>>>>>>>> class
> >>>>>>>>> "c('list', 'RTree')"
> >>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>> Kent
> >>>>>>>>>>
> >>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <
> Roger.Bivand at nhh.no>
> >>>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>>>>>>>> To: r-sig-geo at r-project.org
> >>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> >>>>>> neighboring
> >>>>>>>>>>>>>         points within specified radii (distances) for each
> >> point
> >>>>>> in a
> >>>>>>>>>>> given
> >>>>>>>>>>>>>         points data set.
> >>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>>> Hello,
> >>>>>>>>>>>>> I have data set of about 3400 location points with which I am
> >>>>>> trying
> >>>>>>>>> to
> >>>>>>>>>>>>> generate data of each point and their neighbors within
> defined
> >>>>>> radii
> >>>>>>>>>>> (eg,
> >>>>>>>>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>> The rtree package is very fast and memory-efficient for
> >>>>>>>>> within-distance
> >>>>>>>>>>>> calculations.
> >>>>>>>>>>>> https://github.com/hunzikp/rtree
> >>>>>>>>>>>
> >>>>>>>>>>> Thanks! Does this also apply when the input points are in
> >>>>>> geographical
> >>>>>>>>>>> coordinates?
> >>>>>>>>>>>
> >>>>>>>>>>> Roger
> >>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>> Kent Johnson
> >>>>>>>>>>>> Cambridge, MA
> >>>>>>>>>>>>
> >>>>>>>>>>>>       [[alternative HTML version deleted]]
> >>>>>>>>>>>>
> >>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>> R-sig-Geo mailing list
> >>>>>>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> --
> >>>>>>>>>>> Roger Bivand
> >>>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> --
> >>>>>>>>> Roger Bivand
> >>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>> --
> >>>>>> Roger Bivand
> >>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>
> >>>>>
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>> https://orcid.org/0000-0003-2392-6140
> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Fri Jun  5 13:29:29 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 5 Jun 2020 13:29:29 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
Message-ID: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>

The release candidate of rgdal_1.5-9 is ready for testing on R-forge:

https://r-forge.r-project.org/R/?group_id=884

Those insisting on installing on PROJ >= 6 and GDAL < 3 must use configure 
argument --with-proj_api="proj_api.h"; with this used, this version builds 
with --no-build-vignettes and installs and checks OK on PROJ 7.0.1 and 
GDAL 2.2.4 with --with-proj_api="proj_api.h".

Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL 
1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2 
and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.

All who have indicated issues with source installs are asked to try the 
release candidate and to report back here by midnight CEST Monday 8 June. 
If no indications are forthcoming, I'll assume that problems with 1.5-8 
are resolved.

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From roy@mende|@@ohn @end|ng |rom no@@@gov  Fri Jun  5 15:54:15 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Fri, 5 Jun 2020 06:54:15 -0700
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
Message-ID: <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>

Hi All:

Is there a source for binaries of PROJ >= 6 and GDAL > 3  for the Mac, other than the Anaconda ones which cause problems because they use @rpart?

Thanks,

-Roy


> On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> 
> https://r-forge.r-project.org/R/?group_id=884
> 
> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use configure argument --with-proj_api="proj_api.h"; with this used, this version builds with --no-build-vignettes and installs and checks OK on PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> 
> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> 
> All who have indicated issues with source installs are asked to try the release candidate and to report back here by midnight CEST Monday 8 June. If no indications are forthcoming, I'll assume that problems with 1.5-8 are resolved.
> 
> Roger
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From th|_ve|o@o @end|ng |rom y@hoo@com@br  Fri Jun  5 18:35:29 2020
From: th|_ve|o@o @end|ng |rom y@hoo@com@br (Thiago V. dos Santos)
Date: Fri, 5 Jun 2020 16:35:29 +0000 (UTC)
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
Message-ID: <1626460897.3321277.1591374929087@mail.yahoo.com>

Hi Roy,

I use and recommend MacPorts as a package manager for macOS computers. It is quite comprehensive in terms of programs/libraries available, almost always up-to-date and pretty simple to use. It does not always provide binaries though, it needs to compile a few packages from source (gdal is an example) - which can take a little bit, depending on your machine configuration.

I have some notes on how to set it up - maybe it's useful for you:?https://thiagodossantos.com/post/1-mac-science-software/ ?

Greetings,
?-- Thiago V. dos Santos

ThiagoDosSantos.com
MudancasClimaticasBrasil.com






On Friday, June 5, 2020, 10:54:55 AM GMT-3, Roy Mendelssohn - NOAA Federal via R-sig-Geo <r-sig-geo at r-project.org> wrote: 





Hi All:

Is there a source for binaries of PROJ >= 6 and GDAL > 3? for the Mac, other than the Anaconda ones which cause problems because they use @rpart?

Thanks,

-Roy


> On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> 
> https://r-forge.r-project.org/R/?group_id=884
> 
> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use configure argument --with-proj_api="proj_api.h"; with this used, this version builds with --no-build-vignettes and installs and checks OK on PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> 
> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> 
> All who have indicated issues with source installs are asked to try the release candidate and to report back here by midnight CEST Monday 8 June. If no indications are forthcoming, I'll assume that problems with 1.5-8 are resolved.
> 
> Roger
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From m@p|no|@10 @end|ng |rom gm@||@com  Fri Jun  5 19:25:03 2020
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Fri, 5 Jun 2020 11:25:03 -0600
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <1626460897.3321277.1591374929087@mail.yahoo.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
 <1626460897.3321277.1591374929087@mail.yahoo.com>
Message-ID: <CABkCotRvZmK+jMN-pW98Yui2Hiedn3ARG=HuMSvZz1jTGCmssg@mail.gmail.com>

Thank you very much Thiago.

I am very interested in that because I use R in macOS.

Manuel

El vie., 5 jun. 2020 a las 10:35, Thiago V. dos Santos via R-sig-Geo (<
r-sig-geo at r-project.org>) escribi?:

> Hi Roy,
>
> I use and recommend MacPorts as a package manager for macOS computers. It
> is quite comprehensive in terms of programs/libraries available, almost
> always up-to-date and pretty simple to use. It does not always provide
> binaries though, it needs to compile a few packages from source (gdal is an
> example) - which can take a little bit, depending on your machine
> configuration.
>
> I have some notes on how to set it up - maybe it's useful for you:
> https://thiagodossantos.com/post/1-mac-science-software/
>
> Greetings,
>  -- Thiago V. dos Santos
>
> ThiagoDosSantos.com
> MudancasClimaticasBrasil.com
>
>
>
>
>
>
> On Friday, June 5, 2020, 10:54:55 AM GMT-3, Roy Mendelssohn - NOAA Federal
> via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>
>
>
>
>
> Hi All:
>
> Is there a source for binaries of PROJ >= 6 and GDAL > 3  for the Mac,
> other than the Anaconda ones which cause problems because they use @rpart?
>
> Thanks,
>
> -Roy
>
>
> > On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> > The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> >
> > https://r-forge.r-project.org/R/?group_id=884
> >
> > Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
> configure argument --with-proj_api="proj_api.h"; with this used, this
> version builds with --no-build-vignettes and installs and checks OK on PROJ
> 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> >
> > Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2
> and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> >
> > All who have indicated issues with source installs are asked to try the
> release candidate and to report back here by midnight CEST Monday 8 June.
> If no indications are forthcoming, I'll assume that problems with 1.5-8 are
> resolved.
> >
> > Roger
> >
> > --
> > Roger Bivand
> > Department of Economics, Norwegian School of Economics,
> > Helleveien 30, N-5045 Bergen, Norway.
> > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > https://orcid.org/0000-0003-2392-6140
> > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> **********************
> "The contents of this message do not reflect any position of the U.S.
> Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK
> Jr.
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Fri Jun  5 19:36:44 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 5 Jun 2020 19:36:44 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <CABkCotRvZmK+jMN-pW98Yui2Hiedn3ARG=HuMSvZz1jTGCmssg@mail.gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
 <1626460897.3321277.1591374929087@mail.yahoo.com>
 <CABkCotRvZmK+jMN-pW98Yui2Hiedn3ARG=HuMSvZz1jTGCmssg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006051926140.68944@reclus.nhh.no>

To all macOS users of r-spatial packages requiring external software for 
installation.

Unless you are completely confident that you can install the external 
software, and install source packages without assistance, do not try to 
install packages like sf, rgdal, terra, gdalcubes and others from source. 
Do not choose "both", choose "binary". We cannot help you to install these 
packages from source. If that means waiting for new functionality, wait.

If however you are confident that you can install from source yourself 
without asking us for help, for example because you are familiar with the 
software, or where you need to use the same versions of say PROJ, GEOS and 
GDAL that other geospatial programs do, please go ahead. We have an issue 
open on the r-spatial task view repo, which we can use to propagate proven 
ideas: https://github.com/r-spatial/task_views/issues/16. "It works for 
me now" is not proven - we need paths that have worked predictably for 
years without significant modification (unfortunately it seems that 
notarization has defeated Kyngchaos, which had worked well for years but 
no longer).

Roger

On Fri, 5 Jun 2020, Manuel Sp?nola wrote:

> Thank you very much Thiago.
>
> I am very interested in that because I use R in macOS.
>
> Manuel
>
> El vie., 5 jun. 2020 a las 10:35, Thiago V. dos Santos via R-sig-Geo (<
> r-sig-geo at r-project.org>) escribi?:
>
>> Hi Roy,
>>
>> I use and recommend MacPorts as a package manager for macOS computers. It
>> is quite comprehensive in terms of programs/libraries available, almost
>> always up-to-date and pretty simple to use. It does not always provide
>> binaries though, it needs to compile a few packages from source (gdal is an
>> example) - which can take a little bit, depending on your machine
>> configuration.
>>
>> I have some notes on how to set it up - maybe it's useful for you:
>> https://thiagodossantos.com/post/1-mac-science-software/
>>
>> Greetings,
>>  -- Thiago V. dos Santos
>>
>> ThiagoDosSantos.com
>> MudancasClimaticasBrasil.com
>>
>>
>>
>>
>>
>>
>> On Friday, June 5, 2020, 10:54:55 AM GMT-3, Roy Mendelssohn - NOAA Federal
>> via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>>
>>
>>
>>
>>
>> Hi All:
>>
>> Is there a source for binaries of PROJ >= 6 and GDAL > 3  for the Mac,
>> other than the Anaconda ones which cause problems because they use @rpart?
>>
>> Thanks,
>>
>> -Roy
>>
>>
>>> On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>>>
>>> https://r-forge.r-project.org/R/?group_id=884
>>>
>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>> configure argument --with-proj_api="proj_api.h"; with this used, this
>> version builds with --no-build-vignettes and installs and checks OK on PROJ
>> 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>
>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2
>> and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>
>>> All who have indicated issues with source installs are asked to try the
>> release candidate and to report back here by midnight CEST Monday 8 June.
>> If no indications are forthcoming, I'll assume that problems with 1.5-8 are
>> resolved.
>>>
>>> Roger
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> **********************
>> "The contents of this message do not reflect any position of the U.S.
>> Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK
>> Jr.
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From roy@mende|@@ohn @end|ng |rom no@@@gov  Fri Jun  5 19:44:21 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Fri, 5 Jun 2020 10:44:21 -0700
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006051926140.68944@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
 <1626460897.3321277.1591374929087@mail.yahoo.com>
 <CABkCotRvZmK+jMN-pW98Yui2Hiedn3ARG=HuMSvZz1jTGCmssg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051926140.68944@reclus.nhh.no>
Message-ID: <3A32D9BA-0C91-4174-8E5D-32730EE16B38@noaa.gov>

Thanks all.  My problem is I already have Fink and Homebrew and everything starts interfering with everything,  so I have cut back on package managers except for a few essentially libraries.  Roger,  thanks for the links and the advice.    Kyngchaos also was defeated in that he doesn?t have Catalina and I guess isn?t set up to run it.  Too bad because his frameworks were alway pretty reliable.

-Roy


> On Jun 5, 2020, at 10:36 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> To all macOS users of r-spatial packages requiring external software for installation.
> 
> Unless you are completely confident that you can install the external software, and install source packages without assistance, do not try to install packages like sf, rgdal, terra, gdalcubes and others from source. Do not choose "both", choose "binary". We cannot help you to install these packages from source. If that means waiting for new functionality, wait.
> 
> If however you are confident that you can install from source yourself without asking us for help, for example because you are familiar with the software, or where you need to use the same versions of say PROJ, GEOS and GDAL that other geospatial programs do, please go ahead. We have an issue open on the r-spatial task view repo, which we can use to propagate proven ideas: https://github.com/r-spatial/task_views/issues/16 <https://github.com/r-spatial/task_views/issues/16>. "It works for me now" is not proven - we need paths that have worked predictably for years without significant modification (unfortunately it seems that notarization has defeated Kyngchaos, which had worked well for years but no longer).
> 
> Roger
> 
> On Fri, 5 Jun 2020, Manuel Sp?nola wrote:
> 
>> Thank you very much Thiago.
>> 
>> I am very interested in that because I use R in macOS.
>> 
>> Manuel
>> 
>> El vie., 5 jun. 2020 a las 10:35, Thiago V. dos Santos via R-sig-Geo (<
>> r-sig-geo at r-project.org>) escribi?:
>> 
>>> Hi Roy,
>>> 
>>> I use and recommend MacPorts as a package manager for macOS computers. It
>>> is quite comprehensive in terms of programs/libraries available, almost
>>> always up-to-date and pretty simple to use. It does not always provide
>>> binaries though, it needs to compile a few packages from source (gdal is an
>>> example) - which can take a little bit, depending on your machine
>>> configuration.
>>> 
>>> I have some notes on how to set it up - maybe it's useful for you:
>>> https://thiagodossantos.com/post/1-mac-science-software/
>>> 
>>> Greetings,
>>> -- Thiago V. dos Santos
>>> 
>>> ThiagoDosSantos.com
>>> MudancasClimaticasBrasil.com
>>> 
>>> 
>>> 
>>> 
>>> 
>>> 
>>> On Friday, June 5, 2020, 10:54:55 AM GMT-3, Roy Mendelssohn - NOAA Federal
>>> via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>>> 
>>> 
>>> 
>>> 
>>> 
>>> Hi All:
>>> 
>>> Is there a source for binaries of PROJ >= 6 and GDAL > 3  for the Mac,
>>> other than the Anaconda ones which cause problems because they use @rpart?
>>> 
>>> Thanks,
>>> 
>>> -Roy
>>> 
>>> 
>>>> On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>> 
>>>> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>>>> 
>>>> https://r-forge.r-project.org/R/?group_id=884
>>>> 
>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>> configure argument --with-proj_api="proj_api.h"; with this used, this
>>> version builds with --no-build-vignettes and installs and checks OK on PROJ
>>> 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>> 
>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2
>>> and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>> 
>>>> All who have indicated issues with source installs are asked to try the
>>> release candidate and to report back here by midnight CEST Monday 8 June.
>>> If no indications are forthcoming, I'll assume that problems with 1.5-8 are
>>> resolved.
>>>> 
>>>> Roger
>>>> 
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S.
>>> Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK
>>> Jr.
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> 
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no <mailto:Roger.Bivand at nhh.no>
> https://orcid.org/0000-0003-2392-6140 <https://orcid.org/0000-0003-2392-6140>
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en <https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en>

	[[alternative HTML version deleted]]


From m@p|no|@10 @end|ng |rom gm@||@com  Fri Jun  5 20:07:35 2020
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Fri, 5 Jun 2020 12:07:35 -0600
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006051926140.68944@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <7A995B9D-4DDA-4E65-A3D3-692F992F90D6@noaa.gov>
 <1626460897.3321277.1591374929087@mail.yahoo.com>
 <CABkCotRvZmK+jMN-pW98Yui2Hiedn3ARG=HuMSvZz1jTGCmssg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051926140.68944@reclus.nhh.no>
Message-ID: <CABkCotR8_Hmp8F_BCMf0LBCWtNZuRJ6ZXXdz1W5LXvdvG0b_TA@mail.gmail.com>

Thank you very much Roger.  I will take that into consideration.

Manuel

El vie., 5 jun. 2020 a las 11:36, Roger Bivand (<Roger.Bivand at nhh.no>)
escribi?:

> To all macOS users of r-spatial packages requiring external software for
> installation.
>
> Unless you are completely confident that you can install the external
> software, and install source packages without assistance, do not try to
> install packages like sf, rgdal, terra, gdalcubes and others from source.
> Do not choose "both", choose "binary". We cannot help you to install these
> packages from source. If that means waiting for new functionality, wait.
>
> If however you are confident that you can install from source yourself
> without asking us for help, for example because you are familiar with the
> software, or where you need to use the same versions of say PROJ, GEOS and
> GDAL that other geospatial programs do, please go ahead. We have an issue
> open on the r-spatial task view repo, which we can use to propagate proven
> ideas: https://github.com/r-spatial/task_views/issues/16. "It works for
> me now" is not proven - we need paths that have worked predictably for
> years without significant modification (unfortunately it seems that
> notarization has defeated Kyngchaos, which had worked well for years but
> no longer).
>
> Roger
>
> On Fri, 5 Jun 2020, Manuel Sp?nola wrote:
>
> > Thank you very much Thiago.
> >
> > I am very interested in that because I use R in macOS.
> >
> > Manuel
> >
> > El vie., 5 jun. 2020 a las 10:35, Thiago V. dos Santos via R-sig-Geo (<
> > r-sig-geo at r-project.org>) escribi?:
> >
> >> Hi Roy,
> >>
> >> I use and recommend MacPorts as a package manager for macOS computers.
> It
> >> is quite comprehensive in terms of programs/libraries available, almost
> >> always up-to-date and pretty simple to use. It does not always provide
> >> binaries though, it needs to compile a few packages from source (gdal
> is an
> >> example) - which can take a little bit, depending on your machine
> >> configuration.
> >>
> >> I have some notes on how to set it up - maybe it's useful for you:
> >> https://thiagodossantos.com/post/1-mac-science-software/
> >>
> >> Greetings,
> >>  -- Thiago V. dos Santos
> >>
> >> ThiagoDosSantos.com
> >> MudancasClimaticasBrasil.com
> >>
> >>
> >>
> >>
> >>
> >>
> >> On Friday, June 5, 2020, 10:54:55 AM GMT-3, Roy Mendelssohn - NOAA
> Federal
> >> via R-sig-Geo <r-sig-geo at r-project.org> wrote:
> >>
> >>
> >>
> >>
> >>
> >> Hi All:
> >>
> >> Is there a source for binaries of PROJ >= 6 and GDAL > 3  for the Mac,
> >> other than the Anaconda ones which cause problems because they use
> @rpart?
> >>
> >> Thanks,
> >>
> >> -Roy
> >>
> >>
> >>> On Jun 5, 2020, at 4:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >>>
> >>> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> >>>
> >>> https://r-forge.r-project.org/R/?group_id=884
> >>>
> >>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
> >> configure argument --with-proj_api="proj_api.h"; with this used, this
> >> version builds with --no-build-vignettes and installs and checks OK on
> PROJ
> >> 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> >>>
> >>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
> >> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2
> >> and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> >>>
> >>> All who have indicated issues with source installs are asked to try the
> >> release candidate and to report back here by midnight CEST Monday 8
> June.
> >> If no indications are forthcoming, I'll assume that problems with 1.5-8
> are
> >> resolved.
> >>>
> >>> Roger
> >>>
> >>> --
> >>> Roger Bivand
> >>> Department of Economics, Norwegian School of Economics,
> >>> Helleveien 30, N-5045 Bergen, Norway.
> >>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>> https://orcid.org/0000-0003-2392-6140
> >>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >> **********************
> >> "The contents of this message do not reflect any position of the U.S.
> >> Government or NOAA."
> >> **********************
> >> Roy Mendelssohn
> >> Supervisory Operations Research Analyst
> >> NOAA/NMFS
> >> Environmental Research Division
> >> Southwest Fisheries Science Center
> >> ***Note new street address***
> >> 110 McAllister Way
> >> Santa Cruz, CA 95060
> >> Phone: (831)-420-3666
> >> Fax: (831) 420-3980
> >> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >>
> >> "Old age and treachery will overcome youth and skill."
> >> "From those who have been given much, much will be expected"
> >> "the arc of the moral universe is long, but it bends toward justice"
> -MLK
> >> Jr.
> >>
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en



-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Fri Jun  5 22:31:31 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Fri, 05 Jun 2020 22:31:31 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
Message-ID: <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>

I am not sure if the part with

use --with-proj_api="proj_api.h" for deprecated API

Is of much help since c/p won?t work but the text let?s people 
assume that c/p could/should work.
In fact, a full path to ?proj_api.h? is required?

I still do not like this blocker and I still do not know if this 
combination causes serious issues in production or just limits new 
features.

For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj 
(7.0.1) works and can be used as a workaround until homebrew-core 
formulas catch up.

> checks OK on PROJ 7.0.1 and GDAL 2.2.4

Again, since it was maybe caused by my typo a few mails ago: The 
homebred-core gdal version is at 2.4.4 and not 2.2.4.

On 5 Jun 2020, at 13:29, Roger Bivand wrote:

> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>
> https://r-forge.r-project.org/R/?group_id=884
>
> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use 
> configure argument --with-proj_api="proj_api.h"; with this used, this 
> version builds with --no-build-vignettes and installs and checks OK on 
> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>
> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL 
> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 
> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>
> All who have indicated issues with source installs are asked to try 
> the release candidate and to report back here by midnight CEST Monday 
> 8 June. If no indications are forthcoming, I'll assume that problems 
> with 1.5-8 are resolved.
>
> Roger
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From m@p|no|@10 @end|ng |rom gm@||@com  Sat Jun  6 01:46:40 2020
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Fri, 5 Jun 2020 17:46:40 -0600
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
Message-ID: <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>

Dear list members,

Sorry for the confusion, but with all these suggestions, what is the way to
have the updated versions of the external
software GEOS, PROJ, and GDAL for macOS users.

Manuel

El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
patrick.schratz at gmail.com>) escribi?:

> I am not sure if the part with
>
> use --with-proj_api="proj_api.h" for deprecated API
>
> Is of much help since c/p won?t work but the text let?s people
> assume that c/p could/should work.
> In fact, a full path to ?proj_api.h? is required?
>
> I still do not like this blocker and I still do not know if this
> combination causes serious issues in production or just limits new
> features.
>
> For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj
> (7.0.1) works and can be used as a workaround until homebrew-core
> formulas catch up.
>
> > checks OK on PROJ 7.0.1 and GDAL 2.2.4
>
> Again, since it was maybe caused by my typo a few mails ago: The
> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>
> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>
> > The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> >
> > https://r-forge.r-project.org/R/?group_id=884
> >
> > Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
> > configure argument --with-proj_api="proj_api.h"; with this used, this
> > version builds with --no-build-vignettes and installs and checks OK on
> > PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> >
> > Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
> > 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
> > 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> >
> > All who have indicated issues with source installs are asked to try
> > the release candidate and to report back here by midnight CEST Monday
> > 8 June. If no indications are forthcoming, I'll assume that problems
> > with 1.5-8 are resolved.
> >
> > Roger
> >
> > --
> > Roger Bivand
> > Department of Economics, Norwegian School of Economics,
> > Helleveien 30, N-5045 Bergen, Norway.
> > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > https://orcid.org/0000-0003-2392-6140
> > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From |@t@z@hn @end|ng |rom gm@||@com  Sat Jun  6 02:44:37 2020
From: |@t@z@hn @end|ng |rom gm@||@com (Ista Zahn)
Date: Fri, 5 Jun 2020 20:44:37 -0400
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
Message-ID: <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>

On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>
> Dear list members,
>
> Sorry for the confusion, but with all these suggestions, what is the way to
> have the updated versions of the external
> software GEOS, PROJ, and GDAL for macOS users.

I think the current recommendation is "if you have to ask don't do
it". Just wait for these to be updated in the OSX binary packages on
CRAN.

Best,
Ista

>
> Manuel
>
> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
> patrick.schratz at gmail.com>) escribi?:
>
> > I am not sure if the part with
> >
> > use --with-proj_api="proj_api.h" for deprecated API
> >
> > Is of much help since c/p won?t work but the text let?s people
> > assume that c/p could/should work.
> > In fact, a full path to ?proj_api.h? is required?
> >
> > I still do not like this blocker and I still do not know if this
> > combination causes serious issues in production or just limits new
> > features.
> >
> > For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj
> > (7.0.1) works and can be used as a workaround until homebrew-core
> > formulas catch up.
> >
> > > checks OK on PROJ 7.0.1 and GDAL 2.2.4
> >
> > Again, since it was maybe caused by my typo a few mails ago: The
> > homebred-core gdal version is at 2.4.4 and not 2.2.4.
> >
> > On 5 Jun 2020, at 13:29, Roger Bivand wrote:
> >
> > > The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> > >
> > > https://r-forge.r-project.org/R/?group_id=884
> > >
> > > Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
> > > configure argument --with-proj_api="proj_api.h"; with this used, this
> > > version builds with --no-build-vignettes and installs and checks OK on
> > > PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> > >
> > > Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
> > > 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
> > > 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> > >
> > > All who have indicated issues with source installs are asked to try
> > > the release candidate and to report back here by midnight CEST Monday
> > > 8 June. If no indications are forthcoming, I'll assume that problems
> > > with 1.5-8 are resolved.
> > >
> > > Roger
> > >
> > > --
> > > Roger Bivand
> > > Department of Economics, Norwegian School of Economics,
> > > Helleveien 30, N-5045 Bergen, Norway.
> > > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > > https://orcid.org/0000-0003-2392-6140
> > > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From m@p|no|@10 @end|ng |rom gm@||@com  Sat Jun  6 02:50:55 2020
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Fri, 5 Jun 2020 18:50:55 -0600
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
Message-ID: <CABkCotTT93naBeZprKS_2sf7mRX+A3rnKZ5BO66ZMb9gELn6Pg@mail.gmail.com>

Thank you very much Ista.

Manuel

El vie., 5 jun. 2020 a las 18:44, Ista Zahn (<istazahn at gmail.com>) escribi?:

> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com>
> wrote:
> >
> > Dear list members,
> >
> > Sorry for the confusion, but with all these suggestions, what is the way
> to
> > have the updated versions of the external
> > software GEOS, PROJ, and GDAL for macOS users.
>
> I think the current recommendation is "if you have to ask don't do
> it". Just wait for these to be updated in the OSX binary packages on
> CRAN.
>
> Best,
> Ista
>
> >
> > Manuel
> >
> > El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
> > patrick.schratz at gmail.com>) escribi?:
> >
> > > I am not sure if the part with
> > >
> > > use --with-proj_api="proj_api.h" for deprecated API
> > >
> > > Is of much help since c/p won?t work but the text let?s people
> > > assume that c/p could/should work.
> > > In fact, a full path to ?proj_api.h? is required?
> > >
> > > I still do not like this blocker and I still do not know if this
> > > combination causes serious issues in production or just limits new
> > > features.
> > >
> > > For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj
> > > (7.0.1) works and can be used as a workaround until homebrew-core
> > > formulas catch up.
> > >
> > > > checks OK on PROJ 7.0.1 and GDAL 2.2.4
> > >
> > > Again, since it was maybe caused by my typo a few mails ago: The
> > > homebred-core gdal version is at 2.4.4 and not 2.2.4.
> > >
> > > On 5 Jun 2020, at 13:29, Roger Bivand wrote:
> > >
> > > > The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
> > > >
> > > > https://r-forge.r-project.org/R/?group_id=884
> > > >
> > > > Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
> > > > configure argument --with-proj_api="proj_api.h"; with this used, this
> > > > version builds with --no-build-vignettes and installs and checks OK
> on
> > > > PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
> > > >
> > > > Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with
> GDAL
> > > > 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
> > > > 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
> > > >
> > > > All who have indicated issues with source installs are asked to try
> > > > the release candidate and to report back here by midnight CEST Monday
> > > > 8 June. If no indications are forthcoming, I'll assume that problems
> > > > with 1.5-8 are resolved.
> > > >
> > > > Roger
> > > >
> > > > --
> > > > Roger Bivand
> > > > Department of Economics, Norwegian School of Economics,
> > > > Helleveien 30, N-5045 Bergen, Norway.
> > > > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > > > https://orcid.org/0000-0003-2392-6140
> > > > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >
> > --
> > *Manuel Sp?nola, Ph.D.*
> > Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> > Universidad Nacional
> > Apartado 1350-3000
> > Heredia
> > COSTA RICA
> > mspinola at una.cr <mspinola at una.ac.cr>
> > mspinola10 at gmail.com
> > Tel?fono: (506) 8706 - 4662
> > Personal website: Lobito de r?o <
> https://sites.google.com/site/lobitoderio/>
> > Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun  6 15:45:39 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 6 Jun 2020 15:45:39 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>

On Sat, 6 Jun 2020, Ista Zahn wrote:

> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>>
>> Dear list members,
>>
>> Sorry for the confusion, but with all these suggestions, what is the way to
>> have the updated versions of the external
>> software GEOS, PROJ, and GDAL for macOS users.
>
> I think the current recommendation is "if you have to ask don't do
> it". Just wait for these to be updated in the OSX binary packages on
> CRAN.

Thanks, a much better way of saying this!

We really would like to be able to help macOS users who see "Install from 
source?" and are tempted to choose "yes", but not only do we not have the 
resources or access to running systems, but also, at the moment, things 
seem very unpredictable. We do not think that environments are helpful, 
and many package managers do not seem to have sufficient focussed 
attention, which is understandable given Apple's gift for moving the 
goalposts.

If users can install external software from source (macOS, Linux), they/we 
have a good deal of freedom. But this takes time, insight, and for many is 
problematic because their production system is blocked until the new 
versions are ready (PROJ and GDAL are C++11 or more, and take an order of 
magnitude longer to compile than just a few years ago).

So for Windows and macOS, waiting for the CRAN binaries is a reasonable 
choice.

Beyond this, we need to find ways of providing share/proj and share/gdal 
metadata files for all of the packages now using the PROJ and GDAL 
libraries, and of navigating the content download network for geodetic 
transformation grids available from PROJ 7. But that is another story ...

Roger

>
> Best,
> Ista
>
>>
>> Manuel
>>
>> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>> patrick.schratz at gmail.com>) escribi?:
>>
>>> I am not sure if the part with
>>>
>>> use --with-proj_api="proj_api.h" for deprecated API
>>>
>>> Is of much help since c/p won?t work but the text let?s people
>>> assume that c/p could/should work.
>>> In fact, a full path to ?proj_api.h? is required?
>>>
>>> I still do not like this blocker and I still do not know if this
>>> combination causes serious issues in production or just limits new
>>> features.
>>>
>>> For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj
>>> (7.0.1) works and can be used as a workaround until homebrew-core
>>> formulas catch up.
>>>
>>>> checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>
>>> Again, since it was maybe caused by my typo a few mails ago: The
>>> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>
>>> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>
>>>> The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>>>>
>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>
>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>> configure argument --with-proj_api="proj_api.h"; with this used, this
>>>> version builds with --no-build-vignettes and installs and checks OK on
>>>> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>
>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
>>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>
>>>> All who have indicated issues with source installs are asked to try
>>>> the release candidate and to report back here by midnight CEST Monday
>>>> 8 June. If no indications are forthcoming, I'll assume that problems
>>>> with 1.5-8 are resolved.
>>>>
>>>> Roger
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.cr <mspinola at una.ac.cr>
>> mspinola10 at gmail.com
>> Tel?fono: (506) 8706 - 4662
>> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Sat Jun  6 16:28:24 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Sat, 06 Jun 2020 16:28:24 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
Message-ID: <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>

Roger,

I am sorry for arguing differently so often recently, but if I think 
that unfair arguing is going on, I have the feeling to correct this.

First, again I think that stating "I do not have access to this system" 
is a weak reason in 2020.
I've said this previously but again: As a developer/maintainer, there is 
the implicit burden to set up a dev environment across different 
platforms.
CI helps here.
For more detailed testing, local emulation is possible via virtual 
machines which also applies to macOS systems (setting up is harder but 
not impossible).
Before switching back to macOS a few months ago, I had a virtual machine 
of macOS running and used it successfully for dev purposes.

Second: All package managers seek to provide stability and homebrew is 
one of the most sophisticated ones out there.
I honestly do not understand the general bashing against package 
managers here.

Third: What role does Apple play in all of this? I am not arguing that 
they made some decisions that did not necessarily enhance the dev 
experience on macOS.
However, I do not see any of these having an effect on the spatial 
library stack, especially GDAL and PROJ.

The current situation is that the **main** package manager on macOS, 
namely homebrew, has a temporary version situation of GDAL and PROJ that 
is (for no clear reason yet) blocked by the client package rgdal.

Users on macOS can however use the formulas of the osgeo4mac 
(https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with PROJ7 
and GDAL3 to solve these issues.

```r
brew tap osgeo/osgeo4mac
brew unlink gdal
brew unlink proj

brew install osgeo-gdal
brew install osgeo-proj
brew link osgeo-gdal
brew link osgeo-proj
```

I am well aware that many users of spatial software are not developers 
in their every day life and should stick to binaries.
However, there is a group that does source installs and there are CI 
checks that rely on proper source installations with the current stack 
of the main package managers on a platform.
And exactly this group is blocked right now by blocking the rgdal 
installation at all, with a somewhat weak reasoning for this action.

In addition, arguing/ranting about specific platforms with points 
unrelated to the current issues is a thing that I absolutely dislike, 
getting me started arguing against it.
I also do not like certain platforms and have personal favorites.
However, I always check on all and make sure that everyone gets a 
pleasant experience on their platform, even if that's painful for me and 
costs a lot of time.

I am well aware that I might not be invited to the next imaginary party 
with my arguing here but maybe the discussion can make use of more real 
facts again, lower subjective views, and focus on providing support for 
everyone, on all platforms, without introducing something like a 
"platform racism" with semi-fake news.

Best, Patrick

On 6 Jun 2020, at 15:45, Roger Bivand wrote:

> On Sat, 6 Jun 2020, Ista Zahn wrote:
>
>> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com> 
>> wrote:
>>>
>>> Dear list members,
>>>
>>> Sorry for the confusion, but with all these suggestions, what is the 
>>> way to
>>> have the updated versions of the external
>>> software GEOS, PROJ, and GDAL for macOS users.
>>
>> I think the current recommendation is "if you have to ask don't do
>> it". Just wait for these to be updated in the OSX binary packages on
>> CRAN.
>
> Thanks, a much better way of saying this!
>
> We really would like to be able to help macOS users who see "Install 
> from source?" and are tempted to choose "yes", but not only do we not 
> have the resources or access to running systems, but also, at the 
> moment, things seem very unpredictable. We do not think that 
> environments are helpful, and many package managers do not seem to 
> have sufficient focussed attention, which is understandable given 
> Apple's gift for moving the goalposts.
>
> If users can install external software from source (macOS, Linux), 
> they/we have a good deal of freedom. But this takes time, insight, and 
> for many is problematic because their production system is blocked 
> until the new versions are ready (PROJ and GDAL are C++11 or more, and 
> take an order of magnitude longer to compile than just a few years 
> ago).
>
> So for Windows and macOS, waiting for the CRAN binaries is a 
> reasonable choice.
>
> Beyond this, we need to find ways of providing share/proj and 
> share/gdal metadata files for all of the packages now using the PROJ 
> and GDAL libraries, and of navigating the content download network for 
> geodetic transformation grids available from PROJ 7. But that is 
> another story ...
>
> Roger
>
>>
>> Best,
>> Ista
>>
>>>
>>> Manuel
>>>
>>> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>> patrick.schratz at gmail.com>) escribi?:
>>>
>>>> I am not sure if the part with
>>>>
>>>> use --with-proj_api="proj_api.h" for deprecated API
>>>>
>>>> Is of much help since c/p won?t work but the text let?s people
>>>> assume that c/p could/should work.
>>>> In fact, a full path to ?proj_api.h? is required?
>>>>
>>>> I still do not like this blocker and I still do not know if this
>>>> combination causes serious issues in production or just limits new
>>>> features.
>>>>
>>>> For the time being, using and linking osgeo-gdal (3.0.1) and 
>>>> osgeo-proj
>>>> (7.0.1) works and can be used as a workaround until homebrew-core
>>>> formulas catch up.
>>>>
>>>>> checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>
>>>> Again, since it was maybe caused by my typo a few mails ago: The
>>>> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>
>>>> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>
>>>>> The release candidate of rgdal_1.5-9 is ready for testing on 
>>>>> R-forge:
>>>>>
>>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>>
>>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>> configure argument --with-proj_api="proj_api.h"; with this used, 
>>>>> this
>>>>> version builds with --no-build-vignettes and installs and checks 
>>>>> OK on
>>>>> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>
>>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with 
>>>>> GDAL
>>>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>>> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>
>>>>> All who have indicated issues with source installs are asked to 
>>>>> try
>>>>> the release candidate and to report back here by midnight CEST 
>>>>> Monday
>>>>> 8 June. If no indications are forthcoming, I'll assume that 
>>>>> problems
>>>>> with 1.5-8 are resolved.
>>>>>
>>>>> Roger
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>> https://orcid.org/0000-0003-2392-6140
>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>> --
>>> *Manuel Sp?nola, Ph.D.*
>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>> Universidad Nacional
>>> Apartado 1350-3000
>>> Heredia
>>> COSTA RICA
>>> mspinola at una.cr <mspinola at una.ac.cr>
>>> mspinola10 at gmail.com
>>> Tel?fono: (506) 8706 - 4662
>>> Personal website: Lobito de r?o 
>>> <https://sites.google.com/site/lobitoderio/>
>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun  6 17:10:05 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 6 Jun 2020 17:10:05 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006061557310.88969@reclus.nhh.no>

On Fri, 5 Jun 2020, Patrick Schratz wrote:

> I am not sure if the part with
>
> use --with-proj_api="proj_api.h" for deprecated API
>
> Is of much help since c/p won?t work but the text let?s people assume that 
> c/p could/should work.
> In fact, a full path to ?proj_api.h? is required?

No. If proj.pc is found by pkg-config, the path to the relevant include 
directory is obtained there. If proj.pc is not availble, on Linux 
platforms, the usual include directories are tried (often 
/usrlocal/include is the right place). If proj.pc is not available and the 
include directory cannot be found automatically, use the 
--with-proj-include=DIR configure argument to point to the location of 
proj header files.

This is a different configure argument. If PROJ is >= 6, rgdal will choose 
"proj.h" by default. In PROJ 5-7, proj.h and proj_api.h (the legacy 
interface) have been available. In PROJ 5, proj.h was experimental, and 
proj_api.h was used by default. PROJ 6 uses proj.h (with very different 
structures and functions) by default, but proj_api.h can be used by 
setting -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H. PROJ 7 (March 2020) 
extended the grace period for the use of proj_api.h until PROJ 8 (March 
2021) - originally PROJ 7 was going to block proj_api.h.

So setting the path to the directory where both proj.h and proj_api.h are 
present (and project.h for the archeologically interested, happily gone 
now!) does not solve the problem. Seeing the PROJ version, the configure 
script seeing >= 6 chooses proj.h, but GDAL < 3 does not support proj.h. 
Consequently, sf says - ok, degrade the PROJ headers to the deprecated 
version without needing user intervention, rgdal says - user: either use 
PROJ < 6 with GDAL < 3, or explicitly use configure argument 
--with-proj_api="proj_api.h" to change the default, which is "proj.h" for 
PROJ >= 6. In 9 months, we need to make sure that all affected packages 
and workflows are migrating smoothly to PROJ >= 6 with GDAL >= 3, and 
stand-outs only risk unintended and possibly silent degradation of 
workflows.

See 
http://rgdal.r-forge.r-project.org/articles/CRS_projections_transformations.html

for details of why the migration is needed. PROJ had stood still until 
2017, and was slowly ceasing to be fit for purpose. Projections were fine, 
including ellipsoid changes in some cases, but datum shifts were always a 
cludge. GDAL and PROJ had separate *.csv files to hold projection and 
datum shift specifications; these were not as such authorised, and were 
hard to maintain. PROJ 5 brought the introduction of transformation 
pipelines, offering to avoid transformation from source to WGS84 and then 
to target. PROJ 6 and GDAL 3 brought the harmonisation of projection and 
transformation specifications as an SQLite database (proj.db) shipping 
only with PROJ, and the deep integration of GDAL and PROJ coordinate 
operation functionality. GDAL 2 simply doesn't know how to use the proj.db 
database directly, so some temporary code has been provided to bridge back 
from old GDAL to new PROJ. In particular, the new database structure 
supports conceptualisations, such as area of interest and epoch, which are 
crucial for finding coordinate operations efficiently, but which are not 
available to GDAL 2.

Work can still be done with PROJ 6 or 7 and GDAL 2, but PROJ 8 and GDAL 2 
will not work together. Most likely, accuracy is already less when using 
GDAL 2 and PROJ 6 or 7, compared to upgraded use of GDAL >= 3 and PROJ >= 
6, especially if WKT2 strings are used instead of legacy Proj4 strings in 
the current setting.

>
> I still do not like this blocker and I still do not know if this 
> combination causes serious issues in production or just limits new 
> features.

Both problems as described above. The positions may end up being off by 
about 125m.

>
> For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj 
> (7.0.1) works and can be used as a workaround until homebrew-core 
> formulas catch up.
>
>>  checks OK on PROJ 7.0.1 and GDAL 2.2.4
>
> Again, since it was maybe caused by my typo a few mails ago: The 
> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>

Really not my problem, as you should have seen, I also checked PROJ 5.2.0 
and GDAL 2.4.2. This does not impinge on the use of the deprecated API.

I see that you have posted again, I will respond to that in-thread.

Roger

> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>
>>  The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>>
>>  https://r-forge.r-project.org/R/?group_id=884
>>
>>  Those insisting on installing on PROJ >= 6 and GDAL < 3 must use configure
>>  argument --with-proj_api="proj_api.h"; with this used, this version builds
>>  with --no-build-vignettes and installs and checks OK on PROJ 7.0.1 and
>>  GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>
>>  Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
>>  1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ 6.3.2
>>  and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>
>>  All who have indicated issues with source installs are asked to try the
>>  release candidate and to report back here by midnight CEST Monday 8 June.
>>  If no indications are forthcoming, I'll assume that problems with 1.5-8
>>  are resolved.
>>
>>  Roger
>>
>>  --
>>  Roger Bivand
>>  Department of Economics, Norwegian School of Economics,
>>  Helleveien 30, N-5045 Bergen, Norway.
>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>  https://orcid.org/0000-0003-2392-6140
>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>>  _______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at r-project.org
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Sat Jun  6 17:25:55 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Sat, 6 Jun 2020 17:25:55 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
Message-ID: <96f9126f-d334-1bae-c6a1-26efe0db3027@uni-muenster.de>

Patrick, out of interest: can you point to a CI that mirrors what CRAN
OSX binary builds do? What I have seen they build on brew, not on
statically built binaries.

On 6/6/20 4:28 PM, Patrick Schratz wrote:
> Roger,
> 
> I am sorry for arguing differently so often recently, but if I think 
> that unfair arguing is going on, I have the feeling to correct this.
> 
> First, again I think that stating "I do not have access to this system" 
> is a weak reason in 2020.
> I've said this previously but again: As a developer/maintainer, there is 
> the implicit burden to set up a dev environment across different 
> platforms.
> CI helps here.
> For more detailed testing, local emulation is possible via virtual 
> machines which also applies to macOS systems (setting up is harder but 
> not impossible).
> Before switching back to macOS a few months ago, I had a virtual machine 
> of macOS running and used it successfully for dev purposes.
> 
> Second: All package managers seek to provide stability and homebrew is 
> one of the most sophisticated ones out there.
> I honestly do not understand the general bashing against package 
> managers here.
> 
> Third: What role does Apple play in all of this? I am not arguing that 
> they made some decisions that did not necessarily enhance the dev 
> experience on macOS.
> However, I do not see any of these having an effect on the spatial 
> library stack, especially GDAL and PROJ.
> 
> The current situation is that the **main** package manager on macOS, 
> namely homebrew, has a temporary version situation of GDAL and PROJ that 
> is (for no clear reason yet) blocked by the client package rgdal.
> 
> Users on macOS can however use the formulas of the osgeo4mac 
> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with PROJ7 
> and GDAL3 to solve these issues.
> 
> ```r
> brew tap osgeo/osgeo4mac
> brew unlink gdal
> brew unlink proj
> 
> brew install osgeo-gdal
> brew install osgeo-proj
> brew link osgeo-gdal
> brew link osgeo-proj
> ```
> 
> I am well aware that many users of spatial software are not developers 
> in their every day life and should stick to binaries.
> However, there is a group that does source installs and there are CI 
> checks that rely on proper source installations with the current stack 
> of the main package managers on a platform.
> And exactly this group is blocked right now by blocking the rgdal 
> installation at all, with a somewhat weak reasoning for this action.
> 
> In addition, arguing/ranting about specific platforms with points 
> unrelated to the current issues is a thing that I absolutely dislike, 
> getting me started arguing against it.
> I also do not like certain platforms and have personal favorites.
> However, I always check on all and make sure that everyone gets a 
> pleasant experience on their platform, even if that's painful for me and 
> costs a lot of time.
> 
> I am well aware that I might not be invited to the next imaginary party 
> with my arguing here but maybe the discussion can make use of more real 
> facts again, lower subjective views, and focus on providing support for 
> everyone, on all platforms, without introducing something like a 
> "platform racism" with semi-fake news.
> 
> Best, Patrick
> 
> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
> 
>> On Sat, 6 Jun 2020, Ista Zahn wrote:
>>
>>> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com> 
>>> wrote:
>>>>
>>>> Dear list members,
>>>>
>>>> Sorry for the confusion, but with all these suggestions, what is the 
>>>> way to
>>>> have the updated versions of the external
>>>> software GEOS, PROJ, and GDAL for macOS users.
>>>
>>> I think the current recommendation is "if you have to ask don't do
>>> it". Just wait for these to be updated in the OSX binary packages on
>>> CRAN.
>>
>> Thanks, a much better way of saying this!
>>
>> We really would like to be able to help macOS users who see "Install 
>> from source?" and are tempted to choose "yes", but not only do we not 
>> have the resources or access to running systems, but also, at the 
>> moment, things seem very unpredictable. We do not think that 
>> environments are helpful, and many package managers do not seem to 
>> have sufficient focussed attention, which is understandable given 
>> Apple's gift for moving the goalposts.
>>
>> If users can install external software from source (macOS, Linux), 
>> they/we have a good deal of freedom. But this takes time, insight, and 
>> for many is problematic because their production system is blocked 
>> until the new versions are ready (PROJ and GDAL are C++11 or more, and 
>> take an order of magnitude longer to compile than just a few years 
>> ago).
>>
>> So for Windows and macOS, waiting for the CRAN binaries is a 
>> reasonable choice.
>>
>> Beyond this, we need to find ways of providing share/proj and 
>> share/gdal metadata files for all of the packages now using the PROJ 
>> and GDAL libraries, and of navigating the content download network for 
>> geodetic transformation grids available from PROJ 7. But that is 
>> another story ...
>>
>> Roger
>>
>>>
>>> Best,
>>> Ista
>>>
>>>>
>>>> Manuel
>>>>
>>>> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>> patrick.schratz at gmail.com>) escribi?:
>>>>
>>>>> I am not sure if the part with
>>>>>
>>>>> use --with-proj_api="proj_api.h" for deprecated API
>>>>>
>>>>> Is of much help since c/p won?t work but the text let?s people
>>>>> assume that c/p could/should work.
>>>>> In fact, a full path to ?proj_api.h? is required?
>>>>>
>>>>> I still do not like this blocker and I still do not know if this
>>>>> combination causes serious issues in production or just limits new
>>>>> features.
>>>>>
>>>>> For the time being, using and linking osgeo-gdal (3.0.1) and 
>>>>> osgeo-proj
>>>>> (7.0.1) works and can be used as a workaround until homebrew-core
>>>>> formulas catch up.
>>>>>
>>>>>> checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>
>>>>> Again, since it was maybe caused by my typo a few mails ago: The
>>>>> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>
>>>>> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>
>>>>>> The release candidate of rgdal_1.5-9 is ready for testing on 
>>>>>> R-forge:
>>>>>>
>>>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>>>
>>>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>>> configure argument --with-proj_api="proj_api.h"; with this used, 
>>>>>> this
>>>>>> version builds with --no-build-vignettes and installs and checks 
>>>>>> OK on
>>>>>> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>
>>>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with 
>>>>>> GDAL
>>>>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>>>> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>
>>>>>> All who have indicated issues with source installs are asked to 
>>>>>> try
>>>>>> the release candidate and to report back here by midnight CEST 
>>>>>> Monday
>>>>>> 8 June. If no indications are forthcoming, I'll assume that 
>>>>>> problems
>>>>>> with 1.5-8 are resolved.
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>>
>>>> --
>>>> *Manuel Sp?nola, Ph.D.*
>>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>>> Universidad Nacional
>>>> Apartado 1350-3000
>>>> Heredia
>>>> COSTA RICA
>>>> mspinola at una.cr <mspinola at una.ac.cr>
>>>> mspinola10 at gmail.com
>>>> Tel?fono: (506) 8706 - 4662
>>>> Personal website: Lobito de r?o 
>>>> <https://sites.google.com/site/lobitoderio/>
>>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> -- 
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200606/b80060e2/attachment.bin>

From roy@mende|@@ohn @end|ng |rom no@@@gov  Sat Jun  6 17:28:01 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Sat, 6 Jun 2020 08:28:01 -0700
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
Message-ID: <4DA04783-FBD8-487C-B5A5-A9FF70EB95D6@noaa.gov>

Hi All:

There are some important issues being discussed here about access to new versions of libraries on certain platforms,  but can I add:

1.  Let's keep the discussion civil and factual.  Do a little editing before you send to remove side comments.

2.  Develops/maintainers are almost all volunteers,  it is a lot of work,  and what may seem easy to you can be just one more large piece of work for the maintainer.

3.  Most importantly,  work with the developer to find solutions for things that they can't do.  If there are solutions to getting the new proj and gdal libraries on a Mac,  post how to do that and also how to use them to build rgdal,  sp and sf.   Work with the Mac CRAN maintainer to get the libraries on that machine so that binary builds can be available to users.

Thanks to all for the work that they do.  I think everyone is honestly trying to achieve the same purposes,  but sometimes frustrations can set in.

-Roy


> On Jun 6, 2020, at 7:28 AM, Patrick Schratz <patrick.schratz at gmail.com> wrote:
> 
> Roger,
> 
> I am sorry for arguing differently so often recently, but if I think 
> that unfair arguing is going on, I have the feeling to correct this.
> 
> First, again I think that stating "I do not have access to this system" 
> is a weak reason in 2020.
> I've said this previously but again: As a developer/maintainer, there is 
> the implicit burden to set up a dev environment across different 
> platforms.
> CI helps here.
> For more detailed testing, local emulation is possible via virtual 
> machines which also applies to macOS systems (setting up is harder but 
> not impossible).
> Before switching back to macOS a few months ago, I had a virtual machine 
> of macOS running and used it successfully for dev purposes.
> 
> Second: All package managers seek to provide stability and homebrew is 
> one of the most sophisticated ones out there.
> I honestly do not understand the general bashing against package 
> managers here.
> 
> Third: What role does Apple play in all of this? I am not arguing that 
> they made some decisions that did not necessarily enhance the dev 
> experience on macOS.
> However, I do not see any of these having an effect on the spatial 
> library stack, especially GDAL and PROJ.
> 
> The current situation is that the **main** package manager on macOS, 
> namely homebrew, has a temporary version situation of GDAL and PROJ that 
> is (for no clear reason yet) blocked by the client package rgdal.
> 
> Users on macOS can however use the formulas of the osgeo4mac 
> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with PROJ7 
> and GDAL3 to solve these issues.
> 
> ```r
> brew tap osgeo/osgeo4mac
> brew unlink gdal
> brew unlink proj
> 
> brew install osgeo-gdal
> brew install osgeo-proj
> brew link osgeo-gdal
> brew link osgeo-proj
> ```
> 
> I am well aware that many users of spatial software are not developers 
> in their every day life and should stick to binaries.
> However, there is a group that does source installs and there are CI 
> checks that rely on proper source installations with the current stack 
> of the main package managers on a platform.
> And exactly this group is blocked right now by blocking the rgdal 
> installation at all, with a somewhat weak reasoning for this action.
> 
> In addition, arguing/ranting about specific platforms with points 
> unrelated to the current issues is a thing that I absolutely dislike, 
> getting me started arguing against it.
> I also do not like certain platforms and have personal favorites.
> However, I always check on all and make sure that everyone gets a 
> pleasant experience on their platform, even if that's painful for me and 
> costs a lot of time.
> 
> I am well aware that I might not be invited to the next imaginary party 
> with my arguing here but maybe the discussion can make use of more real 
> facts again, lower subjective views, and focus on providing support for 
> everyone, on all platforms, without introducing something like a 
> "platform racism" with semi-fake news.
> 
> Best, Patrick
> 
> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
> 
>> On Sat, 6 Jun 2020, Ista Zahn wrote:
>> 
>>> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com> 
>>> wrote:
>>>> 
>>>> Dear list members,
>>>> 
>>>> Sorry for the confusion, but with all these suggestions, what is the 
>>>> way to
>>>> have the updated versions of the external
>>>> software GEOS, PROJ, and GDAL for macOS users.
>>> 
>>> I think the current recommendation is "if you have to ask don't do
>>> it". Just wait for these to be updated in the OSX binary packages on
>>> CRAN.
>> 
>> Thanks, a much better way of saying this!
>> 
>> We really would like to be able to help macOS users who see "Install 
>> from source?" and are tempted to choose "yes", but not only do we not 
>> have the resources or access to running systems, but also, at the 
>> moment, things seem very unpredictable. We do not think that 
>> environments are helpful, and many package managers do not seem to 
>> have sufficient focussed attention, which is understandable given 
>> Apple's gift for moving the goalposts.
>> 
>> If users can install external software from source (macOS, Linux), 
>> they/we have a good deal of freedom. But this takes time, insight, and 
>> for many is problematic because their production system is blocked 
>> until the new versions are ready (PROJ and GDAL are C++11 or more, and 
>> take an order of magnitude longer to compile than just a few years 
>> ago).
>> 
>> So for Windows and macOS, waiting for the CRAN binaries is a 
>> reasonable choice.
>> 
>> Beyond this, we need to find ways of providing share/proj and 
>> share/gdal metadata files for all of the packages now using the PROJ 
>> and GDAL libraries, and of navigating the content download network for 
>> geodetic transformation grids available from PROJ 7. But that is 
>> another story ...
>> 
>> Roger
>> 
>>> 
>>> Best,
>>> Ista
>>> 
>>>> 
>>>> Manuel
>>>> 
>>>> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>> patrick.schratz at gmail.com>) escribi?:
>>>> 
>>>>> I am not sure if the part with
>>>>> 
>>>>> use --with-proj_api="proj_api.h" for deprecated API
>>>>> 
>>>>> Is of much help since c/p won?t work but the text let?s people
>>>>> assume that c/p could/should work.
>>>>> In fact, a full path to ?proj_api.h? is required?
>>>>> 
>>>>> I still do not like this blocker and I still do not know if this
>>>>> combination causes serious issues in production or just limits new
>>>>> features.
>>>>> 
>>>>> For the time being, using and linking osgeo-gdal (3.0.1) and 
>>>>> osgeo-proj
>>>>> (7.0.1) works and can be used as a workaround until homebrew-core
>>>>> formulas catch up.
>>>>> 
>>>>>> checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>> 
>>>>> Again, since it was maybe caused by my typo a few mails ago: The
>>>>> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>> 
>>>>> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>> 
>>>>>> The release candidate of rgdal_1.5-9 is ready for testing on 
>>>>>> R-forge:
>>>>>> 
>>>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>>> 
>>>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>>> configure argument --with-proj_api="proj_api.h"; with this used, 
>>>>>> this
>>>>>> version builds with --no-build-vignettes and installs and checks 
>>>>>> OK on
>>>>>> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>> 
>>>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with 
>>>>>> GDAL
>>>>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>>>> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>> 
>>>>>> All who have indicated issues with source installs are asked to 
>>>>>> try
>>>>>> the release candidate and to report back here by midnight CEST 
>>>>>> Monday
>>>>>> 8 June. If no indications are forthcoming, I'll assume that 
>>>>>> problems
>>>>>> with 1.5-8 are resolved.
>>>>>> 
>>>>>> Roger
>>>>>> 
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>> 
>>>> 
>>>> --
>>>> *Manuel Sp?nola, Ph.D.*
>>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>>> Universidad Nacional
>>>> Apartado 1350-3000
>>>> Heredia
>>>> COSTA RICA
>>>> mspinola at una.cr <mspinola at una.ac.cr>
>>>> mspinola10 at gmail.com
>>>> Tel?fono: (506) 8706 - 4662
>>>> Personal website: Lobito de r?o 
>>>> <https://sites.google.com/site/lobitoderio/>
>>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>> 
>>>>        [[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> -- 
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Sat Jun  6 17:32:32 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Sat, 06 Jun 2020 17:32:32 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <96f9126f-d334-1bae-c6a1-26efe0db3027@uni-muenster.de>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <96f9126f-d334-1bae-c6a1-26efe0db3027@uni-muenster.de>
Message-ID: <331A847C-02F1-4F51-ACD3-F290194B5669@gmail.com>

AFAIK CRAN for macOS relies on the toolstack listed on 
https://mac.r-project.org/libs-4/ and not on homebrew. Though I am not 
100% sure here.
There, static tarballs are used which do not follow a package manager 
versioning scheme (unfortunately, because this would prevent many issues 
for the end user).

-> GDAL 2.4.2 and PROJ 5.2.0

On 6 Jun 2020, at 17:25, Edzer Pebesma wrote:

> Patrick, out of interest: can you point to a CI that mirrors what CRAN
> OSX binary builds do? What I have seen they build on brew, not on
> statically built binaries.
>
> On 6/6/20 4:28 PM, Patrick Schratz wrote:
>> Roger,
>>
>> I am sorry for arguing differently so often recently, but if I think
>> that unfair arguing is going on, I have the feeling to correct this.
>>
>> First, again I think that stating "I do not have access to this 
>> system"
>> is a weak reason in 2020.
>> I've said this previously but again: As a developer/maintainer, there 
>> is
>> the implicit burden to set up a dev environment across different
>> platforms.
>> CI helps here.
>> For more detailed testing, local emulation is possible via virtual
>> machines which also applies to macOS systems (setting up is harder 
>> but
>> not impossible).
>> Before switching back to macOS a few months ago, I had a virtual 
>> machine
>> of macOS running and used it successfully for dev purposes.
>>
>> Second: All package managers seek to provide stability and homebrew 
>> is
>> one of the most sophisticated ones out there.
>> I honestly do not understand the general bashing against package
>> managers here.
>>
>> Third: What role does Apple play in all of this? I am not arguing 
>> that
>> they made some decisions that did not necessarily enhance the dev
>> experience on macOS.
>> However, I do not see any of these having an effect on the spatial
>> library stack, especially GDAL and PROJ.
>>
>> The current situation is that the **main** package manager on macOS,
>> namely homebrew, has a temporary version situation of GDAL and PROJ 
>> that
>> is (for no clear reason yet) blocked by the client package rgdal.
>>
>> Users on macOS can however use the formulas of the osgeo4mac
>> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with 
>> PROJ7
>> and GDAL3 to solve these issues.
>>
>> ```r
>> brew tap osgeo/osgeo4mac
>> brew unlink gdal
>> brew unlink proj
>>
>> brew install osgeo-gdal
>> brew install osgeo-proj
>> brew link osgeo-gdal
>> brew link osgeo-proj
>> ```
>>
>> I am well aware that many users of spatial software are not 
>> developers
>> in their every day life and should stick to binaries.
>> However, there is a group that does source installs and there are CI
>> checks that rely on proper source installations with the current 
>> stack
>> of the main package managers on a platform.
>> And exactly this group is blocked right now by blocking the rgdal
>> installation at all, with a somewhat weak reasoning for this action.
>>
>> In addition, arguing/ranting about specific platforms with points
>> unrelated to the current issues is a thing that I absolutely dislike,
>> getting me started arguing against it.
>> I also do not like certain platforms and have personal favorites.
>> However, I always check on all and make sure that everyone gets a
>> pleasant experience on their platform, even if that's painful for me 
>> and
>> costs a lot of time.
>>
>> I am well aware that I might not be invited to the next imaginary 
>> party
>> with my arguing here but maybe the discussion can make use of more 
>> real
>> facts again, lower subjective views, and focus on providing support 
>> for
>> everyone, on all platforms, without introducing something like a
>> "platform racism" with semi-fake news.
>>
>> Best, Patrick
>>
>> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
>>
>>> On Sat, 6 Jun 2020, Ista Zahn wrote:
>>>
>>>> On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola 
>>>> <mspinola10 at gmail.com>
>>>> wrote:
>>>>>
>>>>> Dear list members,
>>>>>
>>>>> Sorry for the confusion, but with all these suggestions, what is 
>>>>> the
>>>>> way to
>>>>> have the updated versions of the external
>>>>> software GEOS, PROJ, and GDAL for macOS users.
>>>>
>>>> I think the current recommendation is "if you have to ask don't do
>>>> it". Just wait for these to be updated in the OSX binary packages 
>>>> on
>>>> CRAN.
>>>
>>> Thanks, a much better way of saying this!
>>>
>>> We really would like to be able to help macOS users who see "Install
>>> from source?" and are tempted to choose "yes", but not only do we 
>>> not
>>> have the resources or access to running systems, but also, at the
>>> moment, things seem very unpredictable. We do not think that
>>> environments are helpful, and many package managers do not seem to
>>> have sufficient focussed attention, which is understandable given
>>> Apple's gift for moving the goalposts.
>>>
>>> If users can install external software from source (macOS, Linux),
>>> they/we have a good deal of freedom. But this takes time, insight, 
>>> and
>>> for many is problematic because their production system is blocked
>>> until the new versions are ready (PROJ and GDAL are C++11 or more, 
>>> and
>>> take an order of magnitude longer to compile than just a few years
>>> ago).
>>>
>>> So for Windows and macOS, waiting for the CRAN binaries is a
>>> reasonable choice.
>>>
>>> Beyond this, we need to find ways of providing share/proj and
>>> share/gdal metadata files for all of the packages now using the PROJ
>>> and GDAL libraries, and of navigating the content download network 
>>> for
>>> geodetic transformation grids available from PROJ 7. But that is
>>> another story ...
>>>
>>> Roger
>>>
>>>>
>>>> Best,
>>>> Ista
>>>>
>>>>>
>>>>> Manuel
>>>>>
>>>>> El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>>> patrick.schratz at gmail.com>) escribi?:
>>>>>
>>>>>> I am not sure if the part with
>>>>>>
>>>>>> use --with-proj_api="proj_api.h" for deprecated API
>>>>>>
>>>>>> Is of much help since c/p won?t work but the text let?s 
>>>>>> people
>>>>>> assume that c/p could/should work.
>>>>>> In fact, a full path to ?proj_api.h? is required?
>>>>>>
>>>>>> I still do not like this blocker and I still do not know if this
>>>>>> combination causes serious issues in production or just limits 
>>>>>> new
>>>>>> features.
>>>>>>
>>>>>> For the time being, using and linking osgeo-gdal (3.0.1) and
>>>>>> osgeo-proj
>>>>>> (7.0.1) works and can be used as a workaround until homebrew-core
>>>>>> formulas catch up.
>>>>>>
>>>>>>> checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>>
>>>>>> Again, since it was maybe caused by my typo a few mails ago: The
>>>>>> homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>>
>>>>>> On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>>
>>>>>>> The release candidate of rgdal_1.5-9 is ready for testing on
>>>>>>> R-forge:
>>>>>>>
>>>>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>>>>
>>>>>>> Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>>>> configure argument --with-proj_api="proj_api.h"; with this used,
>>>>>>> this
>>>>>>> version builds with --no-build-vignettes and installs and checks
>>>>>>> OK on
>>>>>>> PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>>
>>>>>>> Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 
>>>>>>> with
>>>>>>> GDAL
>>>>>>> 1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with 
>>>>>>> PROJ
>>>>>>> 6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>>
>>>>>>> All who have indicated issues with source installs are asked to
>>>>>>> try
>>>>>>> the release candidate and to report back here by midnight CEST
>>>>>>> Monday
>>>>>>> 8 June. If no indications are forthcoming, I'll assume that
>>>>>>> problems
>>>>>>> with 1.5-8 are resolved.
>>>>>>>
>>>>>>> Roger
>>>>>>>
>>>>>>> --
>>>>>>> Roger Bivand
>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> *Manuel Sp?nola, Ph.D.*
>>>>> Instituto Internacional en Conservaci?n y Manejo de Vida 
>>>>> Silvestre
>>>>> Universidad Nacional
>>>>> Apartado 1350-3000
>>>>> Heredia
>>>>> COSTA RICA
>>>>> mspinola at una.cr <mspinola at una.ac.cr>
>>>>> mspinola10 at gmail.com
>>>>> Tel?fono: (506) 8706 - 4662
>>>>> Personal website: Lobito de r?o
>>>>> <https://sites.google.com/site/lobitoderio/>
>>>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> -- 
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> -- 
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48149 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun  6 18:09:41 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 6 Jun 2020 18:09:41 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>

On Sat, 6 Jun 2020, Patrick Schratz wrote:

> Roger,
>
> I am sorry for arguing differently so often recently, but if I think that 
> unfair arguing is going on, I have the feeling to correct this.
>
> First, again I think that stating "I do not have access to this system" is a 
> weak reason in 2020.

Your view, not mine. I cannot ask my employer to provide such resources.

> I've said this previously but again: As a developer/maintainer, there is 
> the implicit burden to set up a dev environment across different 
> platforms. CI helps here.

No, this is not the main burden. For forward-facing packages interfacing 
external software, it is vastly more important to track developments in 
that software, by reading development mailing lists, and checking against 
alpha, beta and RC, as well as tracking master/trunk in periods between 
releases or when things happening in the external software seems to have 
the potential to impact existing R packages. This obviously absorbs a lot 
of time and energy. https://github.com/r-spatial/sf/issues/545 documents 
where we were in November 2017 with this; there are lots of other examples 
in posts  on the PROJ and GDAL lists, and in email exchanges with others.


> For more detailed testing, local emulation is possible via virtual 
> machines which also applies to macOS systems (setting up is harder but 
> not impossible).

> Before switching back to macOS a few months ago, I had a virtual machine 
> of macOS running and used it successfully for dev purposes.
>

The problem with macOS compared to Windows has been that while providing 
static builds for Windows for three iterations of the Windows RTools build 
train, with help from CRAN and others, most recently Jeroen, has gone 
fairly smoothly for more than ten years, macOS moves too quickly. For 
Simon to keep R itself running has been an uphill struggle, with problems 
with Fortran, versions of system software under clang (most recently the 
archaic ssl shipped by Apple), so providing fresh builds of PROJ, GDAL and 
GEOS has understandably not been a priority. We do not build Windows or 
macOS PROJ, GDAL or GEOS libraries, we need others, probably close to 
CRAN, to do this, following CRAN static linking policy.

Note that Brian Ripley continues to monitor and check possibilities for 
static builds of OSGeo software for static linking to CRAN binary packages 
for macOS, but does not have breakthroughs to report for recent PROJ or 
GDAL releases, unfortunately. We are very fortunate that he continues to 
help us with this. rgdal 1.5-9 is partly to resolve your problem, but just 
as much to resolve problems on Solaris and other corner-case CRAN check 
platforms.

Static linking isn't the only policy, but only Linux platforms provide 
(fairly) mature dynamic build package managers. OSGeo4W - built on cygwin 
- has been tried by some over the years, because CRAN static linked binary 
packages may have different versions than say QGIS, GRASS or other Windows 
binaries. We have touched on the idea of proposing R-spatial as an OSGeo 
project, among other things to try to match the versions of key software 
components better. But having many alternatives for source install on 
macOS runs counter to this, we need to find a path that works - the 
previous go-to was Kyngchaos, but that is no longer a viable solution.

> Second: All package managers seek to provide stability and homebrew is 
> one of the most sophisticated ones out there. I honestly do not 
> understand the general bashing against package managers here.

Package managers were debated on R-sig-mac (yes, I follow that too). If 
you use a package manager, that is your choice, but having CI for macOS 
(past and current releases) then gets multiplied  by the number of package 
managers and environments (conda), etc. For central resources, say curl, 
package managers may be OK, but get stuck when some downstream packages 
either get dropped because they are not up to speed with say PROJ/GDAL, or 
PROJ/GDAL get held up because the packages using them are seen as 
important. This happens in all package managers, and is frequently 
discussed on PROJ and GDAL lists, amonng others by those 
responsible for package manager releases. The decisions are not easy, but 
we cannot be held back by package managers' policy choices. My guess is 
that some package in homebrew depends on GDAL 2.* and has not yet upgraded 
to be able to use GDAL 3.*; since GDAL 2.* can be built (although using 
the deprecated API) with PROJ >= 6, they let things slide. They should 
have chosen to stop PROJ at 5.2.*, avoiding the used of the deprecated 
API.

>
> Third: What role does Apple play in all of this? I am not arguing that they 
> made some decisions that did not necessarily enhance the dev experience on 
> macOS.
> However, I do not see any of these having an effect on the spatial library 
> stack, especially GDAL and PROJ.
>
> The current situation is that the **main** package manager on macOS, namely 
> homebrew, has a temporary version situation of GDAL and PROJ that is (for no 
> clear reason yet) blocked by the client package rgdal.
>
> Users on macOS can however use the formulas of the osgeo4mac 
> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with PROJ7 and 
> GDAL3 to solve these issues.
>
> ```r
> brew tap osgeo/osgeo4mac
> brew unlink gdal
> brew unlink proj
>
> brew install osgeo-gdal
> brew install osgeo-proj
> brew link osgeo-gdal
> brew link osgeo-proj
> ```
>
> I am well aware that many users of spatial software are not developers in 
> their every day life and should stick to binaries.
> However, there is a group that does source installs and there are CI checks 
> that rely on proper source installations with the current stack of the main 
> package managers on a platform.
> And exactly this group is blocked right now by blocking the rgdal 
> installation at all, with a somewhat weak reasoning for this action.
>

Block is your expression, what is being required is that users actively 
opt in to using a very-short-life deprecated API. If I relax the 
requirement (I have already opened up for using the deprecated API, which 
I regard as potentially leading to positional accuracy loss, and certainly 
encouraging business as usual rather than active migration of workflows to 
WKT2 from Proj4 strings), I would be demonstrating crass irresponsibility 
with regard to users of rgdal, who need to know that these changes (in 
GDAL/PROJ) may impact their work.

> In addition, arguing/ranting about specific platforms with points unrelated 
> to the current issues is a thing that I absolutely dislike, getting me 
> started arguing against it.
> I also do not like certain platforms and have personal favorites.
> However, I always check on all and make sure that everyone gets a pleasant 
> experience on their platform, even if that's painful for me and costs a lot 
> of time.

Pleasant experience is not something that carries much weight. Things need 
to work, and if user choices may lead to degradation through use of a 
deprecated API, I feel that they should be warned, and that that is more 
important than any pleaasant experience.

For many years, OSX has been checked by CRAN, and this will continue. I do 
not accept that package maintainers have to resolve these problems (source 
installs of packages using external software), if they follow up CRAN 
requirements and make sure that the source packages continue to install 
and check cleanly with successive versions of the external software.

>
> I am well aware that I might not be invited to the next imaginary party with 
> my arguing here but maybe the discussion can make use of more real facts 
> again, lower subjective views, and focus on providing support for everyone, 
> on all platforms, without introducing something like a "platform racism" with 
> semi-fake news.

I'm uncertain what you are referring to. I do not have a problem with 
platforms, I just see the role of package developers differently, as I 
explained above. At some point this year or next, the CRAN Windows and 
macOS binaries will have caught up (Windows already at PROJ 6.3.1 aand 
GDAL 3.0.4), so that for all users and developers but those insisting on 
source installs, the temporary difficulties now being experienced will 
pass. For those installing from source, when package managers catch up 
with the speed of change in PROJ and GDAL, things will calm down.

Roger

>
> Best, Patrick
>
> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
>
>>  On Sat, 6 Jun 2020, Ista Zahn wrote:
>>
>>>  On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com>
>>>  wrote:
>>>>
>>>>  Dear list members,
>>>>
>>>>  Sorry for the confusion, but with all these suggestions, what is the way
>>>>  to
>>>>  have the updated versions of the external
>>>>  software GEOS, PROJ, and GDAL for macOS users.
>>>
>>>  I think the current recommendation is "if you have to ask don't do
>>>  it". Just wait for these to be updated in the OSX binary packages on
>>>  CRAN.
>>
>>  Thanks, a much better way of saying this!
>>
>>  We really would like to be able to help macOS users who see "Install from
>>  source?" and are tempted to choose "yes", but not only do we not have the
>>  resources or access to running systems, but also, at the moment, things
>>  seem very unpredictable. We do not think that environments are helpful,
>>  and many package managers do not seem to have sufficient focussed
>>  attention, which is understandable given Apple's gift for moving the
>>  goalposts.
>>
>>  If users can install external software from source (macOS, Linux), they/we
>>  have a good deal of freedom. But this takes time, insight, and for many is
>>  problematic because their production system is blocked until the new
>>  versions are ready (PROJ and GDAL are C++11 or more, and take an order of
>>  magnitude longer to compile than just a few years ago).
>>
>>  So for Windows and macOS, waiting for the CRAN binaries is a reasonable
>>  choice.
>>
>>  Beyond this, we need to find ways of providing share/proj and share/gdal
>>  metadata files for all of the packages now using the PROJ and GDAL
>>  libraries, and of navigating the content download network for geodetic
>>  transformation grids available from PROJ 7. But that is another story ...
>>
>>  Roger
>> 
>>>
>>>  Best,
>>>  Ista
>>> 
>>>>
>>>>  Manuel
>>>>
>>>>  El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>>  patrick.schratz at gmail.com>) escribi?:
>>>>
>>>>>  I am not sure if the part with
>>>>>
>>>>>  use --with-proj_api="proj_api.h" for deprecated API
>>>>>
>>>>>  Is of much help since c/p won?t work but the text let?s people
>>>>>  assume that c/p could/should work.
>>>>>  In fact, a full path to ?proj_api.h? is required?
>>>>>
>>>>>  I still do not like this blocker and I still do not know if this
>>>>>  combination causes serious issues in production or just limits new
>>>>>  features.
>>>>>
>>>>>  For the time being, using and linking osgeo-gdal (3.0.1) and osgeo-proj
>>>>>  (7.0.1) works and can be used as a workaround until homebrew-core
>>>>>  formulas catch up.
>>>>>
>>>>>>  checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>
>>>>>  Again, since it was maybe caused by my typo a few mails ago: The
>>>>>  homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>
>>>>>  On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>
>>>>>>  The release candidate of rgdal_1.5-9 is ready for testing on R-forge:
>>>>>>
>>>>>>  https://r-forge.r-project.org/R/?group_id=884
>>>>>>
>>>>>>  Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>>>  configure argument --with-proj_api="proj_api.h"; with this used, this
>>>>>>  version builds with --no-build-vignettes and installs and checks OK on
>>>>>>  PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>
>>>>>>  Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with GDAL
>>>>>>  1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>>>>  6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>
>>>>>>  All who have indicated issues with source installs are asked to try
>>>>>>  the release candidate and to report back here by midnight CEST Monday
>>>>>>  8 June. If no indications are forthcoming, I'll assume that problems
>>>>>>  with 1.5-8 are resolved.
>>>>>>
>>>>>>  Roger
>>>>>>
>>>>>>  --
>>>>>>  Roger Bivand
>>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>
>>>>>>  _______________________________________________
>>>>>>  R-sig-Geo mailing list
>>>>>>  R-sig-Geo at r-project.org
>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>  _______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>> 
>>>>
>>>>  --
>>>>  *Manuel Sp?nola, Ph.D.*
>>>>  Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>>>  Universidad Nacional
>>>>  Apartado 1350-3000
>>>>  Heredia
>>>>  COSTA RICA
>>>>  mspinola at una.cr <mspinola at una.ac.cr>
>>>>  mspinola10 at gmail.com
>>>>  Tel?fono: (506) 8706 - 4662
>>>>  Personal website: Lobito de r?o
>>>>  <https://sites.google.com/site/lobitoderio/>
>>>>  Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>>  _______________________________________________
>>>>  R-sig-Geo mailing list
>>>>  R-sig-Geo at r-project.org
>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>  _______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>
>>  --
>>  Roger Bivand
>>  Department of Economics, Norwegian School of Economics,
>>  Helleveien 30, N-5045 Bergen, Norway.
>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>  https://orcid.org/0000-0003-2392-6140
>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at r-project.org
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Sat Jun  6 18:30:59 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Sat, 06 Jun 2020 18:30:59 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
Message-ID: <34F8BD86-A06C-4D6B-B88D-FDF2F9E83AEE@gmail.com>

Roger,

thanks for your extensive answer, much appreciated.

I won't commenting on every detail, this would make the discssion 
somewhat bloated.

It's always the "cat and mouse game" between the libraries, packages 
managers and client packages.
However, the chain is library > package manager > client package in my 
opinion, meaning the client package has the burden to at least check the 
first two and provide **at least** instructions for every OS how to get 
the package installable.

The dev toolchain on macOS in general and how things are linked/build is 
a different topic.
For this, I am somewhat missing (until recently) public accessibility of 
the build process/toolchain, even though things are moving forward with 
the creation of https://github.com/R-macos?type=source lately.

Regarding GDAL2 and PROJ>=6: If there is such an offset in spatial 
projections using this combination, I welcome the blocker.
However, this was not clear in any way before your last post a few hours 
ago.
However, I would also welcome more information on this then, either 
during installation attempts or at some other place.
Maybe even opening an issue at the respective package manager informing 
the people about the dangerous situation.
The more attraction an issue gets, the earlier it gets fixed.

Apologies if some of my recent messages were offensive to you or anyone 
else.
However, sometimes discussions need "clear" statements with emotions 
excluded.

In the end, we all aim for a smooth experience and aim to have everybody 
on board.

Best, Patrick

On 6 Jun 2020, at 18:09, Roger Bivand wrote:

> On Sat, 6 Jun 2020, Patrick Schratz wrote:
>
>> Roger,
>>
>> I am sorry for arguing differently so often recently, but if I think 
>> that unfair arguing is going on, I have the feeling to correct this.
>>
>> First, again I think that stating "I do not have access to this 
>> system" is a weak reason in 2020.
>
> Your view, not mine. I cannot ask my employer to provide such 
> resources.
>
>> I've said this previously but again: As a developer/maintainer, there 
>> is the implicit burden to set up a dev environment across different 
>> platforms. CI helps here.
>
> No, this is not the main burden. For forward-facing packages 
> interfacing external software, it is vastly more important to track 
> developments in that software, by reading development mailing lists, 
> and checking against alpha, beta and RC, as well as tracking 
> master/trunk in periods between releases or when things happening in 
> the external software seems to have the potential to impact existing R 
> packages. This obviously absorbs a lot of time and energy. 
> https://github.com/r-spatial/sf/issues/545 documents where we were in 
> November 2017 with this; there are lots of other examples in posts  on 
> the PROJ and GDAL lists, and in email exchanges with others.
>
>
>> For more detailed testing, local emulation is possible via virtual 
>> machines which also applies to macOS systems (setting up is harder 
>> but not impossible).
>
>> Before switching back to macOS a few months ago, I had a virtual 
>> machine of macOS running and used it successfully for dev purposes.
>>
>
> The problem with macOS compared to Windows has been that while 
> providing static builds for Windows for three iterations of the 
> Windows RTools build train, with help from CRAN and others, most 
> recently Jeroen, has gone fairly smoothly for more than ten years, 
> macOS moves too quickly. For Simon to keep R itself running has been 
> an uphill struggle, with problems with Fortran, versions of system 
> software under clang (most recently the archaic ssl shipped by Apple), 
> so providing fresh builds of PROJ, GDAL and GEOS has understandably 
> not been a priority. We do not build Windows or macOS PROJ, GDAL or 
> GEOS libraries, we need others, probably close to CRAN, to do this, 
> following CRAN static linking policy.
>
> Note that Brian Ripley continues to monitor and check possibilities 
> for static builds of OSGeo software for static linking to CRAN binary 
> packages for macOS, but does not have breakthroughs to report for 
> recent PROJ or GDAL releases, unfortunately. We are very fortunate 
> that he continues to help us with this. rgdal 1.5-9 is partly to 
> resolve your problem, but just as much to resolve problems on Solaris 
> and other corner-case CRAN check platforms.
>
> Static linking isn't the only policy, but only Linux platforms provide 
> (fairly) mature dynamic build package managers. OSGeo4W - built on 
> cygwin - has been tried by some over the years, because CRAN static 
> linked binary packages may have different versions than say QGIS, 
> GRASS or other Windows binaries. We have touched on the idea of 
> proposing R-spatial as an OSGeo project, among other things to try to 
> match the versions of key software components better. But having many 
> alternatives for source install on macOS runs counter to this, we need 
> to find a path that works - the previous go-to was Kyngchaos, but that 
> is no longer a viable solution.
>
>> Second: All package managers seek to provide stability and homebrew 
>> is one of the most sophisticated ones out there. I honestly do not 
>> understand the general bashing against package managers here.
>
> Package managers were debated on R-sig-mac (yes, I follow that too). 
> If you use a package manager, that is your choice, but having CI for 
> macOS (past and current releases) then gets multiplied  by the number 
> of package managers and environments (conda), etc. For central 
> resources, say curl, package managers may be OK, but get stuck when 
> some downstream packages either get dropped because they are not up to 
> speed with say PROJ/GDAL, or PROJ/GDAL get held up because the 
> packages using them are seen as important. This happens in all package 
> managers, and is frequently discussed on PROJ and GDAL lists, amonng 
> others by those responsible for package manager releases. The 
> decisions are not easy, but we cannot be held back by package 
> managers' policy choices. My guess is that some package in homebrew 
> depends on GDAL 2.* and has not yet upgraded to be able to use GDAL 
> 3.*; since GDAL 2.* can be built (although using the deprecated API) 
> with PROJ >= 6, they let things slide. They should have chosen to stop 
> PROJ at 5.2.*, avoiding the used of the deprecated API.
>
>>
>> Third: What role does Apple play in all of this? I am not arguing 
>> that they made some decisions that did not necessarily enhance the 
>> dev experience on macOS.
>> However, I do not see any of these having an effect on the spatial 
>> library stack, especially GDAL and PROJ.
>>
>> The current situation is that the **main** package manager on macOS, 
>> namely homebrew, has a temporary version situation of GDAL and PROJ 
>> that is (for no clear reason yet) blocked by the client package 
>> rgdal.
>>
>> Users on macOS can however use the formulas of the osgeo4mac 
>> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with 
>> PROJ7 and GDAL3 to solve these issues.
>>
>> ```r
>> brew tap osgeo/osgeo4mac
>> brew unlink gdal
>> brew unlink proj
>>
>> brew install osgeo-gdal
>> brew install osgeo-proj
>> brew link osgeo-gdal
>> brew link osgeo-proj
>> ```
>>
>> I am well aware that many users of spatial software are not 
>> developers in their every day life and should stick to binaries.
>> However, there is a group that does source installs and there are CI 
>> checks that rely on proper source installations with the current 
>> stack of the main package managers on a platform.
>> And exactly this group is blocked right now by blocking the rgdal 
>> installation at all, with a somewhat weak reasoning for this action.
>>
>
> Block is your expression, what is being required is that users 
> actively opt in to using a very-short-life deprecated API. If I relax 
> the requirement (I have already opened up for using the deprecated 
> API, which I regard as potentially leading to positional accuracy 
> loss, and certainly encouraging business as usual rather than active 
> migration of workflows to WKT2 from Proj4 strings), I would be 
> demonstrating crass irresponsibility with regard to users of rgdal, 
> who need to know that these changes (in GDAL/PROJ) may impact their 
> work.
>
>> In addition, arguing/ranting about specific platforms with points 
>> unrelated to the current issues is a thing that I absolutely dislike, 
>> getting me started arguing against it.
>> I also do not like certain platforms and have personal favorites.
>> However, I always check on all and make sure that everyone gets a 
>> pleasant experience on their platform, even if that's painful for me 
>> and costs a lot of time.
>
> Pleasant experience is not something that carries much weight. Things 
> need to work, and if user choices may lead to degradation through use 
> of a deprecated API, I feel that they should be warned, and that that 
> is more important than any pleaasant experience.
>
> For many years, OSX has been checked by CRAN, and this will continue. 
> I do not accept that package maintainers have to resolve these 
> problems (source installs of packages using external software), if 
> they follow up CRAN requirements and make sure that the source 
> packages continue to install and check cleanly with successive 
> versions of the external software.
>
>>
>> I am well aware that I might not be invited to the next imaginary 
>> party with my arguing here but maybe the discussion can make use of 
>> more real facts again, lower subjective views, and focus on providing 
>> support for everyone, on all platforms, without introducing something 
>> like a "platform racism" with semi-fake news.
>
> I'm uncertain what you are referring to. I do not have a problem with 
> platforms, I just see the role of package developers differently, as I 
> explained above. At some point this year or next, the CRAN Windows and 
> macOS binaries will have caught up (Windows already at PROJ 6.3.1 aand 
> GDAL 3.0.4), so that for all users and developers but those insisting 
> on source installs, the temporary difficulties now being experienced 
> will pass. For those installing from source, when package managers 
> catch up with the speed of change in PROJ and GDAL, things will calm 
> down.
>
> Roger
>
>>
>> Best, Patrick
>>
>> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
>>
>>>  On Sat, 6 Jun 2020, Ista Zahn wrote:
>>>
>>>>  On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola 
>>>> <mspinola10 at gmail.com>
>>>>  wrote:
>>>>>
>>>>>  Dear list members,
>>>>>
>>>>>  Sorry for the confusion, but with all these suggestions, what is 
>>>>> the way
>>>>>  to
>>>>>  have the updated versions of the external
>>>>>  software GEOS, PROJ, and GDAL for macOS users.
>>>>
>>>>  I think the current recommendation is "if you have to ask don't do
>>>>  it". Just wait for these to be updated in the OSX binary packages 
>>>> on
>>>>  CRAN.
>>>
>>>  Thanks, a much better way of saying this!
>>>
>>>  We really would like to be able to help macOS users who see 
>>> "Install from
>>>  source?" and are tempted to choose "yes", but not only do we not 
>>> have the
>>>  resources or access to running systems, but also, at the moment, 
>>> things
>>>  seem very unpredictable. We do not think that environments are 
>>> helpful,
>>>  and many package managers do not seem to have sufficient focussed
>>>  attention, which is understandable given Apple's gift for moving 
>>> the
>>>  goalposts.
>>>
>>>  If users can install external software from source (macOS, Linux), 
>>> they/we
>>>  have a good deal of freedom. But this takes time, insight, and for 
>>> many is
>>>  problematic because their production system is blocked until the 
>>> new
>>>  versions are ready (PROJ and GDAL are C++11 or more, and take an 
>>> order of
>>>  magnitude longer to compile than just a few years ago).
>>>
>>>  So for Windows and macOS, waiting for the CRAN binaries is a 
>>> reasonable
>>>  choice.
>>>
>>>  Beyond this, we need to find ways of providing share/proj and 
>>> share/gdal
>>>  metadata files for all of the packages now using the PROJ and GDAL
>>>  libraries, and of navigating the content download network for 
>>> geodetic
>>>  transformation grids available from PROJ 7. But that is another 
>>> story ...
>>>
>>>  Roger
>>>
>>>>
>>>>  Best,
>>>>  Ista
>>>>
>>>>>
>>>>>  Manuel
>>>>>
>>>>>  El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>>>  patrick.schratz at gmail.com>) escribi?:
>>>>>
>>>>>>  I am not sure if the part with
>>>>>>
>>>>>>  use --with-proj_api="proj_api.h" for deprecated API
>>>>>>
>>>>>>  Is of much help since c/p won?t work but the text let?s 
>>>>>> people
>>>>>>  assume that c/p could/should work.
>>>>>>  In fact, a full path to ?proj_api.h? is required?
>>>>>>
>>>>>>  I still do not like this blocker and I still do not know if this
>>>>>>  combination causes serious issues in production or just limits 
>>>>>> new
>>>>>>  features.
>>>>>>
>>>>>>  For the time being, using and linking osgeo-gdal (3.0.1) and 
>>>>>> osgeo-proj
>>>>>>  (7.0.1) works and can be used as a workaround until 
>>>>>> homebrew-core
>>>>>>  formulas catch up.
>>>>>>
>>>>>>>  checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>>
>>>>>>  Again, since it was maybe caused by my typo a few mails ago: The
>>>>>>  homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>>
>>>>>>  On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>>
>>>>>>>  The release candidate of rgdal_1.5-9 is ready for testing on 
>>>>>>> R-forge:
>>>>>>>
>>>>>>>  https://r-forge.r-project.org/R/?group_id=884
>>>>>>>
>>>>>>>  Those insisting on installing on PROJ >= 6 and GDAL < 3 must 
>>>>>>> use
>>>>>>>  configure argument --with-proj_api="proj_api.h"; with this 
>>>>>>> used, this
>>>>>>>  version builds with --no-build-vignettes and installs and 
>>>>>>> checks OK on
>>>>>>>  PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>>
>>>>>>>  Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 
>>>>>>> with GDAL
>>>>>>>  1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with 
>>>>>>> PROJ
>>>>>>>  6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>>
>>>>>>>  All who have indicated issues with source installs are asked to 
>>>>>>> try
>>>>>>>  the release candidate and to report back here by midnight CEST 
>>>>>>> Monday
>>>>>>>  8 June. If no indications are forthcoming, I'll assume that 
>>>>>>> problems
>>>>>>>  with 1.5-8 are resolved.
>>>>>>>
>>>>>>>  Roger
>>>>>>>
>>>>>>>  --
>>>>>>>  Roger Bivand
>>>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>>  _______________________________________________
>>>>>>>  R-sig-Geo mailing list
>>>>>>>  R-sig-Geo at r-project.org
>>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>  _______________________________________________
>>>>>>  R-sig-Geo mailing list
>>>>>>  R-sig-Geo at r-project.org
>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>
>>>>>  --
>>>>>  *Manuel Sp?nola, Ph.D.*
>>>>>  Instituto Internacional en Conservaci?n y Manejo de Vida 
>>>>> Silvestre
>>>>>  Universidad Nacional
>>>>>  Apartado 1350-3000
>>>>>  Heredia
>>>>>  COSTA RICA
>>>>>  mspinola at una.cr <mspinola at una.ac.cr>
>>>>>  mspinola10 at gmail.com
>>>>>  Tel?fono: (506) 8706 - 4662
>>>>>  Personal website: Lobito de r?o
>>>>>  <https://sites.google.com/site/lobitoderio/>
>>>>>  Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>>
>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>>  _______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>  _______________________________________________
>>>>  R-sig-Geo mailing list
>>>>  R-sig-Geo at r-project.org
>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>  --
>>>  Roger Bivand
>>>  Department of Economics, Norwegian School of Economics,
>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>  https://orcid.org/0000-0003-2392-6140
>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun  6 21:09:01 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 6 Jun 2020 21:09:01 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <34F8BD86-A06C-4D6B-B88D-FDF2F9E83AEE@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
 <34F8BD86-A06C-4D6B-B88D-FDF2F9E83AEE@gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006062027530.521999@reclus.nhh.no>

Patrick,

Thanks for this ...

On Sat, 6 Jun 2020, Patrick Schratz wrote:

> Roger,
>
> thanks for your extensive answer, much appreciated.
>
> I won't commenting on every detail, this would make the discssion somewhat 
> bloated.
>
> It's always the "cat and mouse game" between the libraries, packages 
> managers and client packages. However, the chain is library > package 
> manager > client package in my opinion, meaning the client package has 
> the burden to at least check the first two and provide **at least** 
> instructions for every OS how to get the package installable.

On Linux, I never myself use the package manager for critical libraries, 
always installing R and software like PROJ/GDAL/GEOS from source. I'll 
admit that it is years since, following Brian Ripley's advice, I installed 
GCC from source to explore a particular wrinkle, but for me it has been 
important to avoid the decisions made by package manager maintainers 
interfering with my view of the relationships between the external 
software and compiled code in packages for which I am responsible. 
Recently, for example, it turned out that the R rpm package picked certain 
values for LDFLAGS, which then got in the way of sf's configure script 
https://github.com/r-spatial/sf/issues/1369.

For Windows, we know how to install, using a script in packages to 
download the libraries and share/* files; it is robust and works.

For Linux, some of us install external software from source, it works, but 
we need to handle mutual dependencies manually (say knowing which PROJ and 
GEOS GDAL was built with). Some use Debian and Ubuntu package managers, 
which are versioned to the level of the OS, and generally work; some repos 
are more actively maintained than others. Some use ArchLinux and other 
distributions, maybe source installs are sensible. For Centos/RHEL/Fedora, 
the picture is rather mixed, with slowish tracking of the fast speed of 
API and ABI change in PROJ and GDAL. Package managers also face 
misunderstandings about when an ABI change needs to be flagged by changing 
a minor version or patch number - this happened when GDAL 3.1.0 RCs were 
being checked: 
https://lists.osgeo.org/pipermail/gdal-dev/2020-May/052060.html. Here the 
careful attention of a Debian packager working with us led to a 
last-minute bump of the SONAME, also thanks to Even Rouault, who is 
unfailingly helpful.

Just keeping things more or less functioning at this level is already 
pretty absorbing.

Getting to CRAN binaries for macOS will take a little longer. From 
R-sig-mac, we know that Simon is not convinced that package managers are 
of use in getting to a general resolution, but he has published recipes: 
Simon replied to me pointinng to them: 
https://stat.ethz.ch/pipermail/r-sig-mac/2020-May/013537.html, 
https://github.com/R-macos/recipes

Since he has asked for input, I think that this is likely  to be a 
fruitful way forward, but as noted in this thread, it is getting harder to 
build PROJ and GDAL static, to get to static CRAN binary packages.

>
> The dev toolchain on macOS in general and how things are linked/build is a 
> different topic.
> For this, I am somewhat missing (until recently) public accessibility of the 
> build process/toolchain, even though things are moving forward with the 
> creation of https://github.com/R-macos?type=source lately.

Exactly, it has been really difficult to make this kind of progress, so 
positive contributions and patience seem most useful.

>
> Regarding GDAL2 and PROJ>=6: If there is such an offset in spatial 
> projections using this combination, I welcome the blocker. However, this 
> was not clear in any way before your last post a few hours ago. However, 
> I would also welcome more information on this then, either during 
> installation attempts or at some other place. Maybe even opening an 
> issue at the respective package manager informing the people about the 
> dangerous situation. The more attraction an issue gets, the earlier it 
> gets fixed.

The package maintainers are also in a difficult position with regard to 
packages/applications that still need GDAL 2. The offsets are not always 
there, but until end users have had the opportunity to check their 
workflows, we won't know. Certainly the announced degradation of GDAL's 
OSR::exportToProj4() suprised a lot of us, even though we knew it was 
coming. For me teaching the John Snow Soho Cholera story and finding the 
Broad Street pump in Ingestre Place was a strong motivation to get users 
to pay attention. Again, it will not affect everyone, but it may do so.

>
> Apologies if some of my recent messages were offensive to you or anyone else.
> However, sometimes discussions need "clear" statements with emotions 
> excluded.
>
> In the end, we all aim for a smooth experience and aim to have everybody on 
> board.

Certainly everybody on board, locations in data and the real world lined 
up adequately, smooth at the moment is a big ask, but once we get the 
community over to WKT2, PROJ >= 6 and GDAL >= 3, we'll be much, much 
calmer.

Best wishes,

Roger

>
> Best, Patrick
>
> On 6 Jun 2020, at 18:09, Roger Bivand wrote:
>
>>  On Sat, 6 Jun 2020, Patrick Schratz wrote:
>>
>>>  Roger,
>>>
>>>  I am sorry for arguing differently so often recently, but if I think that
>>>  unfair arguing is going on, I have the feeling to correct this.
>>>
>>>  First, again I think that stating "I do not have access to this system"
>>>  is a weak reason in 2020.
>>
>>  Your view, not mine. I cannot ask my employer to provide such resources.
>>
>>>  I've said this previously but again: As a developer/maintainer, there is
>>>  the implicit burden to set up a dev environment across different
>>>  platforms. CI helps here.
>>
>>  No, this is not the main burden. For forward-facing packages interfacing
>>  external software, it is vastly more important to track developments in
>>  that software, by reading development mailing lists, and checking against
>>  alpha, beta and RC, as well as tracking master/trunk in periods between
>>  releases or when things happening in the external software seems to have
>>  the potential to impact existing R packages. This obviously absorbs a lot
>>  of time and energy. https://github.com/r-spatial/sf/issues/545 documents
>>  where we were in November 2017 with this; there are lots of other examples
>>  in posts  on the PROJ and GDAL lists, and in email exchanges with others.
>> 
>>
>>>  For more detailed testing, local emulation is possible via virtual
>>>  machines which also applies to macOS systems (setting up is harder but
>>>  not impossible).
>>
>>>  Before switching back to macOS a few months ago, I had a virtual machine
>>>  of macOS running and used it successfully for dev purposes.
>>> 
>>
>>  The problem with macOS compared to Windows has been that while providing
>>  static builds for Windows for three iterations of the Windows RTools build
>>  train, with help from CRAN and others, most recently Jeroen, has gone
>>  fairly smoothly for more than ten years, macOS moves too quickly. For
>>  Simon to keep R itself running has been an uphill struggle, with problems
>>  with Fortran, versions of system software under clang (most recently the
>>  archaic ssl shipped by Apple), so providing fresh builds of PROJ, GDAL and
>>  GEOS has understandably not been a priority. We do not build Windows or
>>  macOS PROJ, GDAL or GEOS libraries, we need others, probably close to
>>  CRAN, to do this, following CRAN static linking policy.
>>
>>  Note that Brian Ripley continues to monitor and check possibilities for
>>  static builds of OSGeo software for static linking to CRAN binary packages
>>  for macOS, but does not have breakthroughs to report for recent PROJ or
>>  GDAL releases, unfortunately. We are very fortunate that he continues to
>>  help us with this. rgdal 1.5-9 is partly to resolve your problem, but just
>>  as much to resolve problems on Solaris and other corner-case CRAN check
>>  platforms.
>>
>>  Static linking isn't the only policy, but only Linux platforms provide
>>  (fairly) mature dynamic build package managers. OSGeo4W - built on cygwin
>>  - has been tried by some over the years, because CRAN static linked binary
>>  packages may have different versions than say QGIS, GRASS or other Windows
>>  binaries. We have touched on the idea of proposing R-spatial as an OSGeo
>>  project, among other things to try to match the versions of key software
>>  components better. But having many alternatives for source install on
>>  macOS runs counter to this, we need to find a path that works - the
>>  previous go-to was Kyngchaos, but that is no longer a viable solution.
>>
>>>  Second: All package managers seek to provide stability and homebrew is
>>>  one of the most sophisticated ones out there. I honestly do not
>>>  understand the general bashing against package managers here.
>>
>>  Package managers were debated on R-sig-mac (yes, I follow that too). If
>>  you use a package manager, that is your choice, but having CI for macOS
>>  (past and current releases) then gets multiplied  by the number of package
>>  managers and environments (conda), etc. For central resources, say curl,
>>  package managers may be OK, but get stuck when some downstream packages
>>  either get dropped because they are not up to speed with say PROJ/GDAL, or
>>  PROJ/GDAL get held up because the packages using them are seen as
>>  important. This happens in all package managers, and is frequently
>>  discussed on PROJ and GDAL lists, amonng others by those responsible for
>>  package manager releases. The decisions are not easy, but we cannot be
>>  held back by package managers' policy choices. My guess is that some
>>  package in homebrew depends on GDAL 2.* and has not yet upgraded to be
>>  able to use GDAL 3.*; since GDAL 2.* can be built (although using the
>>  deprecated API) with PROJ >= 6, they let things slide. They should have
>>  chosen to stop PROJ at 5.2.*, avoiding the used of the deprecated API.
>> 
>>>
>>>  Third: What role does Apple play in all of this? I am not arguing that
>>>  they made some decisions that did not necessarily enhance the dev
>>>  experience on macOS.
>>>  However, I do not see any of these having an effect on the spatial
>>>  library stack, especially GDAL and PROJ.
>>>
>>>  The current situation is that the **main** package manager on macOS,
>>>  namely homebrew, has a temporary version situation of GDAL and PROJ that
>>>  is (for no clear reason yet) blocked by the client package rgdal.
>>>
>>>  Users on macOS can however use the formulas of the osgeo4mac
>>>  (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with PROJ7
>>>  and GDAL3 to solve these issues.
>>>
>>>  ```r
>>>  brew tap osgeo/osgeo4mac
>>>  brew unlink gdal
>>>  brew unlink proj
>>>
>>>  brew install osgeo-gdal
>>>  brew install osgeo-proj
>>>  brew link osgeo-gdal
>>>  brew link osgeo-proj
>>>  ```
>>>
>>>  I am well aware that many users of spatial software are not developers in
>>>  their every day life and should stick to binaries.
>>>  However, there is a group that does source installs and there are CI
>>>  checks that rely on proper source installations with the current stack of
>>>  the main package managers on a platform.
>>>  And exactly this group is blocked right now by blocking the rgdal
>>>  installation at all, with a somewhat weak reasoning for this action.
>>> 
>>
>>  Block is your expression, what is being required is that users actively
>>  opt in to using a very-short-life deprecated API. If I relax the
>>  requirement (I have already opened up for using the deprecated API, which
>>  I regard as potentially leading to positional accuracy loss, and certainly
>>  encouraging business as usual rather than active migration of workflows to
>>  WKT2 from Proj4 strings), I would be demonstrating crass irresponsibility
>>  with regard to users of rgdal, who need to know that these changes (in
>>  GDAL/PROJ) may impact their work.
>>
>>>  In addition, arguing/ranting about specific platforms with points
>>>  unrelated to the current issues is a thing that I absolutely dislike,
>>>  getting me started arguing against it.
>>>  I also do not like certain platforms and have personal favorites.
>>>  However, I always check on all and make sure that everyone gets a
>>>  pleasant experience on their platform, even if that's painful for me and
>>>  costs a lot of time.
>>
>>  Pleasant experience is not something that carries much weight. Things need
>>  to work, and if user choices may lead to degradation through use of a
>>  deprecated API, I feel that they should be warned, and that that is more
>>  important than any pleaasant experience.
>>
>>  For many years, OSX has been checked by CRAN, and this will continue. I do
>>  not accept that package maintainers have to resolve these problems (source
>>  installs of packages using external software), if they follow up CRAN
>>  requirements and make sure that the source packages continue to install
>>  and check cleanly with successive versions of the external software.
>> 
>>>
>>>  I am well aware that I might not be invited to the next imaginary party
>>>  with my arguing here but maybe the discussion can make use of more real
>>>  facts again, lower subjective views, and focus on providing support for
>>>  everyone, on all platforms, without introducing something like a
>>>  "platform racism" with semi-fake news.
>>
>>  I'm uncertain what you are referring to. I do not have a problem with
>>  platforms, I just see the role of package developers differently, as I
>>  explained above. At some point this year or next, the CRAN Windows and
>>  macOS binaries will have caught up (Windows already at PROJ 6.3.1 aand
>>  GDAL 3.0.4), so that for all users and developers but those insisting on
>>  source installs, the temporary difficulties now being experienced will
>>  pass. For those installing from source, when package managers catch up
>>  with the speed of change in PROJ and GDAL, things will calm down.
>>
>>  Roger
>> 
>>>
>>>  Best, Patrick
>>>
>>>  On 6 Jun 2020, at 15:45, Roger Bivand wrote:
>>>
>>>>   On Sat, 6 Jun 2020, Ista Zahn wrote:
>>>>
>>>>>  On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola <mspinola10 at gmail.com>
>>>>>   wrote:
>>>>>>
>>>>>>   Dear list members,
>>>>>>
>>>>>>  Sorry for the confusion, but with all these suggestions, what is the
>>>>>>  way
>>>>>>   to
>>>>>>   have the updated versions of the external
>>>>>>   software GEOS, PROJ, and GDAL for macOS users.
>>>>>
>>>>>   I think the current recommendation is "if you have to ask don't do
>>>>>   it". Just wait for these to be updated in the OSX binary packages
>>>>>  on
>>>>>   CRAN.
>>>>
>>>>   Thanks, a much better way of saying this!
>>>>
>>>>  We really would like to be able to help macOS users who see "Install
>>>>  from
>>>>  source?" and are tempted to choose "yes", but not only do we not have
>>>>  the
>>>>  resources or access to running systems, but also, at the moment, things
>>>>  seem very unpredictable. We do not think that environments are helpful,
>>>>   and many package managers do not seem to have sufficient focussed
>>>>   attention, which is understandable given Apple's gift for moving
>>>>  the
>>>>   goalposts.
>>>>
>>>>  If users can install external software from source (macOS, Linux),
>>>>  they/we
>>>>  have a good deal of freedom. But this takes time, insight, and for many
>>>>  is
>>>>  problematic because their production system is blocked until the new
>>>>  versions are ready (PROJ and GDAL are C++11 or more, and take an order
>>>>  of
>>>>   magnitude longer to compile than just a few years ago).
>>>>
>>>>  So for Windows and macOS, waiting for the CRAN binaries is a reasonable
>>>>   choice.
>>>>
>>>>  Beyond this, we need to find ways of providing share/proj and share/gdal
>>>>   metadata files for all of the packages now using the PROJ and GDAL
>>>>   libraries, and of navigating the content download network for
>>>>  geodetic
>>>>  transformation grids available from PROJ 7. But that is another story
>>>>  ...
>>>>
>>>>   Roger
>>>> 
>>>>>
>>>>>   Best,
>>>>>   Ista
>>>>> 
>>>>>>
>>>>>>   Manuel
>>>>>>
>>>>>>   El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>>>>   patrick.schratz at gmail.com>) escribi?:
>>>>>>
>>>>>>>   I am not sure if the part with
>>>>>>>
>>>>>>>   use --with-proj_api="proj_api.h" for deprecated API
>>>>>>>
>>>>>>>  Is of much help since c/p won?t work but the text let?s people
>>>>>>>   assume that c/p could/should work.
>>>>>>>   In fact, a full path to ?proj_api.h? is required?
>>>>>>>
>>>>>>>   I still do not like this blocker and I still do not know if this
>>>>>>>   combination causes serious issues in production or just limits
>>>>>>>  new
>>>>>>>   features.
>>>>>>>
>>>>>>>  For the time being, using and linking osgeo-gdal (3.0.1) and
>>>>>>>  osgeo-proj
>>>>>>>  (7.0.1) works and can be used as a workaround until homebrew-core
>>>>>>>   formulas catch up.
>>>>>>>
>>>>>>>>   checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>>>
>>>>>>>   Again, since it was maybe caused by my typo a few mails ago: The
>>>>>>>   homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>>>
>>>>>>>   On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>>>
>>>>>>>>  The release candidate of rgdal_1.5-9 is ready for testing on
>>>>>>>>  R-forge:
>>>>>>>>
>>>>>>>>   https://r-forge.r-project.org/R/?group_id=884
>>>>>>>>
>>>>>>>>  Those insisting on installing on PROJ >= 6 and GDAL < 3 must use
>>>>>>>>  configure argument --with-proj_api="proj_api.h"; with this used,
>>>>>>>>  this
>>>>>>>>  version builds with --no-build-vignettes and installs and checks OK
>>>>>>>>  on
>>>>>>>>   PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>>>
>>>>>>>>  Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 with
>>>>>>>>  GDAL
>>>>>>>>  1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with PROJ
>>>>>>>>   6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>>>
>>>>>>>>  All who have indicated issues with source installs are asked to try
>>>>>>>>  the release candidate and to report back here by midnight CEST
>>>>>>>>  Monday
>>>>>>>>  8 June. If no indications are forthcoming, I'll assume that problems
>>>>>>>>   with 1.5-8 are resolved.
>>>>>>>>
>>>>>>>>   Roger
>>>>>>>>
>>>>>>>>   --
>>>>>>>>   Roger Bivand
>>>>>>>>   Department of Economics, Norwegian School of Economics,
>>>>>>>>   Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>   voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>   https://orcid.org/0000-0003-2392-6140
>>>>>>>>   https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>
>>>>>>>>   _______________________________________________
>>>>>>>>   R-sig-Geo mailing list
>>>>>>>>   R-sig-Geo at r-project.org
>>>>>>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>>   _______________________________________________
>>>>>>>   R-sig-Geo mailing list
>>>>>>>   R-sig-Geo at r-project.org
>>>>>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>> 
>>>>>> 
>>>>>>
>>>>>>   --
>>>>>>   *Manuel Sp?nola, Ph.D.*
>>>>>>   Instituto Internacional en Conservaci?n y Manejo de Vida
>>>>>>  Silvestre
>>>>>>   Universidad Nacional
>>>>>>   Apartado 1350-3000
>>>>>>   Heredia
>>>>>>   COSTA RICA
>>>>>>   mspinola at una.cr <mspinola at una.ac.cr>
>>>>>>   mspinola10 at gmail.com
>>>>>>   Tel?fono: (506) 8706 - 4662
>>>>>>   Personal website: Lobito de r?o
>>>>>>   <https://sites.google.com/site/lobitoderio/>
>>>>>>   Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>>>
>>>>>>           [[alternative HTML version deleted]]
>>>>>>
>>>>>>   _______________________________________________
>>>>>>   R-sig-Geo mailing list
>>>>>>   R-sig-Geo at r-project.org
>>>>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>   _______________________________________________
>>>>>   R-sig-Geo mailing list
>>>>>   R-sig-Geo at r-project.org
>>>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>>
>>>>   --
>>>>   Roger Bivand
>>>>   Department of Economics, Norwegian School of Economics,
>>>>   Helleveien 30, N-5045 Bergen, Norway.
>>>>   voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>   https://orcid.org/0000-0003-2392-6140
>>>>   https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>>   R-sig-Geo mailing list
>>>>   R-sig-Geo at r-project.org
>>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>
>>  --
>>  Roger Bivand
>>  Department of Economics, Norwegian School of Economics,
>>  Helleveien 30, N-5045 Bergen, Norway.
>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>  https://orcid.org/0000-0003-2392-6140
>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Sat Jun  6 21:15:31 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Sat, 06 Jun 2020 21:15:31 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
Message-ID: <B787B11E-8B8B-4DE1-B842-5B47F18D5586@gmail.com>

> I am well aware that I might not be invited to the next imaginary 
> party with my arguing here but maybe the discussion can make use of 
> more real facts again, lower subjective views, and focus on providing 
> support for everyone, on all platforms, without introducing something 
> like a "platform racism" with semi-fake news.

Since some people reached out to me regarding this paragraph, I would 
like to clarify some things:

I am aware that the terms "racism" and "fake news" contain some weight 
in the current times.
I used them because the way how people who use a specific operating 
system (no matter which one) are treated/grouped reminds me of how 
mankind groups peoples for whatever reason.

This makes me very sad and also somewhat angry, hence my somewhat 
emotional response on this.
Needless to say that I am completely against such categorizations, 
whether they happen in a human or IT context.

What happens in IT in particular is that often vague arguments are 
added, often poorly informed about the operating system in question, 
mostly because the person does not use it in person and just head some 
things about it.

Nevertheless, such wordings and discussion should not be used in 
IT-related mailing lists.
I apologize for this and try to not do it again.

In addition, I will keep quiet for some time, relaxing my emotions and 
re-evaluating if putting in the effort, like I did recently, is actually 
of any help/received positively or just burning time and pushing 
emotions.

Since I use and contribute to R (6 years for now) I was always on the 
side of "help everyone", "things can get better/easier", "don't create 
your own island solutions". However, I was hitting some (in my view, not 
understandable) "walls" recently and I am not sure if I want to continue 
with this attitude.

On 6 Jun 2020, at 18:09, Roger Bivand wrote:

> On Sat, 6 Jun 2020, Patrick Schratz wrote:
>
>> Roger,
>>
>> I am sorry for arguing differently so often recently, but if I think 
>> that unfair arguing is going on, I have the feeling to correct this.
>>
>> First, again I think that stating "I do not have access to this 
>> system" is a weak reason in 2020.
>
> Your view, not mine. I cannot ask my employer to provide such 
> resources.
>
>> I've said this previously but again: As a developer/maintainer, there 
>> is the implicit burden to set up a dev environment across different 
>> platforms. CI helps here.
>
> No, this is not the main burden. For forward-facing packages 
> interfacing external software, it is vastly more important to track 
> developments in that software, by reading development mailing lists, 
> and checking against alpha, beta and RC, as well as tracking 
> master/trunk in periods between releases or when things happening in 
> the external software seems to have the potential to impact existing R 
> packages. This obviously absorbs a lot of time and energy. 
> https://github.com/r-spatial/sf/issues/545 documents where we were in 
> November 2017 with this; there are lots of other examples in posts  on 
> the PROJ and GDAL lists, and in email exchanges with others.
>
>
>> For more detailed testing, local emulation is possible via virtual 
>> machines which also applies to macOS systems (setting up is harder 
>> but not impossible).
>
>> Before switching back to macOS a few months ago, I had a virtual 
>> machine of macOS running and used it successfully for dev purposes.
>>
>
> The problem with macOS compared to Windows has been that while 
> providing static builds for Windows for three iterations of the 
> Windows RTools build train, with help from CRAN and others, most 
> recently Jeroen, has gone fairly smoothly for more than ten years, 
> macOS moves too quickly. For Simon to keep R itself running has been 
> an uphill struggle, with problems with Fortran, versions of system 
> software under clang (most recently the archaic ssl shipped by Apple), 
> so providing fresh builds of PROJ, GDAL and GEOS has understandably 
> not been a priority. We do not build Windows or macOS PROJ, GDAL or 
> GEOS libraries, we need others, probably close to CRAN, to do this, 
> following CRAN static linking policy.
>
> Note that Brian Ripley continues to monitor and check possibilities 
> for static builds of OSGeo software for static linking to CRAN binary 
> packages for macOS, but does not have breakthroughs to report for 
> recent PROJ or GDAL releases, unfortunately. We are very fortunate 
> that he continues to help us with this. rgdal 1.5-9 is partly to 
> resolve your problem, but just as much to resolve problems on Solaris 
> and other corner-case CRAN check platforms.
>
> Static linking isn't the only policy, but only Linux platforms provide 
> (fairly) mature dynamic build package managers. OSGeo4W - built on 
> cygwin - has been tried by some over the years, because CRAN static 
> linked binary packages may have different versions than say QGIS, 
> GRASS or other Windows binaries. We have touched on the idea of 
> proposing R-spatial as an OSGeo project, among other things to try to 
> match the versions of key software components better. But having many 
> alternatives for source install on macOS runs counter to this, we need 
> to find a path that works - the previous go-to was Kyngchaos, but that 
> is no longer a viable solution.
>
>> Second: All package managers seek to provide stability and homebrew 
>> is one of the most sophisticated ones out there. I honestly do not 
>> understand the general bashing against package managers here.
>
> Package managers were debated on R-sig-mac (yes, I follow that too). 
> If you use a package manager, that is your choice, but having CI for 
> macOS (past and current releases) then gets multiplied  by the number 
> of package managers and environments (conda), etc. For central 
> resources, say curl, package managers may be OK, but get stuck when 
> some downstream packages either get dropped because they are not up to 
> speed with say PROJ/GDAL, or PROJ/GDAL get held up because the 
> packages using them are seen as important. This happens in all package 
> managers, and is frequently discussed on PROJ and GDAL lists, amonng 
> others by those responsible for package manager releases. The 
> decisions are not easy, but we cannot be held back by package 
> managers' policy choices. My guess is that some package in homebrew 
> depends on GDAL 2.* and has not yet upgraded to be able to use GDAL 
> 3.*; since GDAL 2.* can be built (although using the deprecated API) 
> with PROJ >= 6, they let things slide. They should have chosen to stop 
> PROJ at 5.2.*, avoiding the used of the deprecated API.
>
>>
>> Third: What role does Apple play in all of this? I am not arguing 
>> that they made some decisions that did not necessarily enhance the 
>> dev experience on macOS.
>> However, I do not see any of these having an effect on the spatial 
>> library stack, especially GDAL and PROJ.
>>
>> The current situation is that the **main** package manager on macOS, 
>> namely homebrew, has a temporary version situation of GDAL and PROJ 
>> that is (for no clear reason yet) blocked by the client package 
>> rgdal.
>>
>> Users on macOS can however use the formulas of the osgeo4mac 
>> (https://github.com/OSGeo/homebrew-osgeo4mac) tap which comes with 
>> PROJ7 and GDAL3 to solve these issues.
>>
>> ```r
>> brew tap osgeo/osgeo4mac
>> brew unlink gdal
>> brew unlink proj
>>
>> brew install osgeo-gdal
>> brew install osgeo-proj
>> brew link osgeo-gdal
>> brew link osgeo-proj
>> ```
>>
>> I am well aware that many users of spatial software are not 
>> developers in their every day life and should stick to binaries.
>> However, there is a group that does source installs and there are CI 
>> checks that rely on proper source installations with the current 
>> stack of the main package managers on a platform.
>> And exactly this group is blocked right now by blocking the rgdal 
>> installation at all, with a somewhat weak reasoning for this action.
>>
>
> Block is your expression, what is being required is that users 
> actively opt in to using a very-short-life deprecated API. If I relax 
> the requirement (I have already opened up for using the deprecated 
> API, which I regard as potentially leading to positional accuracy 
> loss, and certainly encouraging business as usual rather than active 
> migration of workflows to WKT2 from Proj4 strings), I would be 
> demonstrating crass irresponsibility with regard to users of rgdal, 
> who need to know that these changes (in GDAL/PROJ) may impact their 
> work.
>
>> In addition, arguing/ranting about specific platforms with points 
>> unrelated to the current issues is a thing that I absolutely dislike, 
>> getting me started arguing against it.
>> I also do not like certain platforms and have personal favorites.
>> However, I always check on all and make sure that everyone gets a 
>> pleasant experience on their platform, even if that's painful for me 
>> and costs a lot of time.
>
> Pleasant experience is not something that carries much weight. Things 
> need to work, and if user choices may lead to degradation through use 
> of a deprecated API, I feel that they should be warned, and that that 
> is more important than any pleaasant experience.
>
> For many years, OSX has been checked by CRAN, and this will continue. 
> I do not accept that package maintainers have to resolve these 
> problems (source installs of packages using external software), if 
> they follow up CRAN requirements and make sure that the source 
> packages continue to install and check cleanly with successive 
> versions of the external software.
>
>>
>> I am well aware that I might not be invited to the next imaginary 
>> party with my arguing here but maybe the discussion can make use of 
>> more real facts again, lower subjective views, and focus on providing 
>> support for everyone, on all platforms, without introducing something 
>> like a "platform racism" with semi-fake news.
>
> I'm uncertain what you are referring to. I do not have a problem with 
> platforms, I just see the role of package developers differently, as I 
> explained above. At some point this year or next, the CRAN Windows and 
> macOS binaries will have caught up (Windows already at PROJ 6.3.1 aand 
> GDAL 3.0.4), so that for all users and developers but those insisting 
> on source installs, the temporary difficulties now being experienced 
> will pass. For those installing from source, when package managers 
> catch up with the speed of change in PROJ and GDAL, things will calm 
> down.
>
> Roger
>
>>
>> Best, Patrick
>>
>> On 6 Jun 2020, at 15:45, Roger Bivand wrote:
>>
>>>  On Sat, 6 Jun 2020, Ista Zahn wrote:
>>>
>>>>  On Fri, Jun 5, 2020 at 7:47 PM Manuel Sp?nola 
>>>> <mspinola10 at gmail.com>
>>>>  wrote:
>>>>>
>>>>>  Dear list members,
>>>>>
>>>>>  Sorry for the confusion, but with all these suggestions, what is 
>>>>> the way
>>>>>  to
>>>>>  have the updated versions of the external
>>>>>  software GEOS, PROJ, and GDAL for macOS users.
>>>>
>>>>  I think the current recommendation is "if you have to ask don't do
>>>>  it". Just wait for these to be updated in the OSX binary packages 
>>>> on
>>>>  CRAN.
>>>
>>>  Thanks, a much better way of saying this!
>>>
>>>  We really would like to be able to help macOS users who see 
>>> "Install from
>>>  source?" and are tempted to choose "yes", but not only do we not 
>>> have the
>>>  resources or access to running systems, but also, at the moment, 
>>> things
>>>  seem very unpredictable. We do not think that environments are 
>>> helpful,
>>>  and many package managers do not seem to have sufficient focussed
>>>  attention, which is understandable given Apple's gift for moving 
>>> the
>>>  goalposts.
>>>
>>>  If users can install external software from source (macOS, Linux), 
>>> they/we
>>>  have a good deal of freedom. But this takes time, insight, and for 
>>> many is
>>>  problematic because their production system is blocked until the 
>>> new
>>>  versions are ready (PROJ and GDAL are C++11 or more, and take an 
>>> order of
>>>  magnitude longer to compile than just a few years ago).
>>>
>>>  So for Windows and macOS, waiting for the CRAN binaries is a 
>>> reasonable
>>>  choice.
>>>
>>>  Beyond this, we need to find ways of providing share/proj and 
>>> share/gdal
>>>  metadata files for all of the packages now using the PROJ and GDAL
>>>  libraries, and of navigating the content download network for 
>>> geodetic
>>>  transformation grids available from PROJ 7. But that is another 
>>> story ...
>>>
>>>  Roger
>>>
>>>>
>>>>  Best,
>>>>  Ista
>>>>
>>>>>
>>>>>  Manuel
>>>>>
>>>>>  El vie., 5 jun. 2020 a las 14:31, Patrick Schratz (<
>>>>>  patrick.schratz at gmail.com>) escribi?:
>>>>>
>>>>>>  I am not sure if the part with
>>>>>>
>>>>>>  use --with-proj_api="proj_api.h" for deprecated API
>>>>>>
>>>>>>  Is of much help since c/p won?t work but the text let?s 
>>>>>> people
>>>>>>  assume that c/p could/should work.
>>>>>>  In fact, a full path to ?proj_api.h? is required?
>>>>>>
>>>>>>  I still do not like this blocker and I still do not know if this
>>>>>>  combination causes serious issues in production or just limits 
>>>>>> new
>>>>>>  features.
>>>>>>
>>>>>>  For the time being, using and linking osgeo-gdal (3.0.1) and 
>>>>>> osgeo-proj
>>>>>>  (7.0.1) works and can be used as a workaround until 
>>>>>> homebrew-core
>>>>>>  formulas catch up.
>>>>>>
>>>>>>>  checks OK on PROJ 7.0.1 and GDAL 2.2.4
>>>>>>
>>>>>>  Again, since it was maybe caused by my typo a few mails ago: The
>>>>>>  homebred-core gdal version is at 2.4.4 and not 2.2.4.
>>>>>>
>>>>>>  On 5 Jun 2020, at 13:29, Roger Bivand wrote:
>>>>>>
>>>>>>>  The release candidate of rgdal_1.5-9 is ready for testing on 
>>>>>>> R-forge:
>>>>>>>
>>>>>>>  https://r-forge.r-project.org/R/?group_id=884
>>>>>>>
>>>>>>>  Those insisting on installing on PROJ >= 6 and GDAL < 3 must 
>>>>>>> use
>>>>>>>  configure argument --with-proj_api="proj_api.h"; with this 
>>>>>>> used, this
>>>>>>>  version builds with --no-build-vignettes and installs and 
>>>>>>> checks OK on
>>>>>>>  PROJ 7.0.1 and GDAL 2.2.4 with --with-proj_api="proj_api.h".
>>>>>>>
>>>>>>>  Otherwise checked OK with PROJ 4.8.0, 4.9.2, 4.9.3 and 5.2.0 
>>>>>>> with GDAL
>>>>>>>  1.11.4; with PROJ 5.2.0 and GDAL 2.2.4, 2.3.2 and 2.4.2; with 
>>>>>>> PROJ
>>>>>>>  6.3.2 and GDAL 3.0.4; with PROJ 7.0.1 and GDAL 3.0.4 and 3.1.0.
>>>>>>>
>>>>>>>  All who have indicated issues with source installs are asked to 
>>>>>>> try
>>>>>>>  the release candidate and to report back here by midnight CEST 
>>>>>>> Monday
>>>>>>>  8 June. If no indications are forthcoming, I'll assume that 
>>>>>>> problems
>>>>>>>  with 1.5-8 are resolved.
>>>>>>>
>>>>>>>  Roger
>>>>>>>
>>>>>>>  --
>>>>>>>  Roger Bivand
>>>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>>  _______________________________________________
>>>>>>>  R-sig-Geo mailing list
>>>>>>>  R-sig-Geo at r-project.org
>>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>  _______________________________________________
>>>>>>  R-sig-Geo mailing list
>>>>>>  R-sig-Geo at r-project.org
>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>
>>>>>  --
>>>>>  *Manuel Sp?nola, Ph.D.*
>>>>>  Instituto Internacional en Conservaci?n y Manejo de Vida 
>>>>> Silvestre
>>>>>  Universidad Nacional
>>>>>  Apartado 1350-3000
>>>>>  Heredia
>>>>>  COSTA RICA
>>>>>  mspinola at una.cr <mspinola at una.ac.cr>
>>>>>  mspinola10 at gmail.com
>>>>>  Tel?fono: (506) 8706 - 4662
>>>>>  Personal website: Lobito de r?o
>>>>>  <https://sites.google.com/site/lobitoderio/>
>>>>>  Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>>>
>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>>  _______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>  _______________________________________________
>>>>  R-sig-Geo mailing list
>>>>  R-sig-Geo at r-project.org
>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>  --
>>>  Roger Bivand
>>>  Department of Economics, Norwegian School of Economics,
>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>  https://orcid.org/0000-0003-2392-6140
>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Sat Jun  6 22:31:07 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Sat, 6 Jun 2020 22:31:07 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <B787B11E-8B8B-4DE1-B842-5B47F18D5586@gmail.com>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
 <B787B11E-8B8B-4DE1-B842-5B47F18D5586@gmail.com>
Message-ID: <490e6ae1-707e-fb66-3fc9-c9bc69a5ad00@uni-muenster.de>



On 6/6/20 9:15 PM, Patrick Schratz wrote:
> Since I use and contribute to R (6 years for now) I was always on the
> side of "help everyone", "things can get better/easier", "don't create
> your own island solutions". However, I was hitting some (in my view, not
> understandable) "walls" recently and I am not sure if I want to continue
> with this attitude.

Dear Patrick,

We should keep in mind that the system requirements of the R spatial
packages is quite likely the most complicated there is on CRAN, that it
has a long legacy, and that GDAL/PROJ came very dynamic recently, and
that many people (though not enough) are involved.

I think that you're learning that working with people is much harder
than working with technology.

I highly appreciate the contributions you made to CI for R packages [*],
and the way you helped making it work for sf; this helps robust
development and finding bugs early. However, the moment something breaks
in the CI setup, I have no clue what to do and have to ask your help. If
I wouldn't get that help a couple of times, I would drop the whole thing
and throw it out of the window. For people using sf this is the same:
they have no clue how it works; if it doesn't work a couple of times and
help doesn't come quickly, they throw it out of the window and look for
something else that does work.

What you have to realize is that what looks simple for you (e.g. CI)
looks incredibly complicated for other people, for the simple reason
that they have been doing very different things for the last 6 years,
and have neither time nor ambition to make up for that. Convincing
others to change something by arguing the change is "simple and makes
things better" often does not work because the receiver has a different
perception of "simple" and is not convinced that the status quo is not
good enough, or is convinced the change brings a lot of work and/or
added complexity. I don't think it helps to get emotional publicly in
such a case and move to twitter [&], nor to become disappointed in the R
project. If you'd move to another project, you'll find yourself again
confronted with people, and discover that communication is always difficult.

[*] see e.g. https://github.com/ropensci/tic
[&] https://twitter.com/pjs_228/status/1269301044481339392
-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200606/d1ee363b/attachment.bin>

From p@tr|ck@@chr@tz @end|ng |rom gm@||@com  Sat Jun  6 23:04:51 2020
From: p@tr|ck@@chr@tz @end|ng |rom gm@||@com (Patrick Schratz)
Date: Sat, 06 Jun 2020 23:04:51 +0200
Subject: [R-sig-Geo] rgdal release candidate 1.5-9 rev. 1000 ready for
 testing
In-Reply-To: <490e6ae1-707e-fb66-3fc9-c9bc69a5ad00@uni-muenster.de>
References: <alpine.LFD.2.22.394.2006051319390.64342@reclus.nhh.no>
 <3F7BA254-93D4-4C1D-82E9-6C8C28C44297@gmail.com>
 <CABkCotSs3jKLm+4syJh0RWgEBFH3P=DXqQn_iCfNXkX05a5eUw@mail.gmail.com>
 <CA+vqiLGtaOqxBfSU4X3D1pKMaRMm7PWizbFSOK8os57ApAgJUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006061534280.88969@reclus.nhh.no>
 <C1B187D8-9C9F-46BF-B5D2-B117BCEB8660@gmail.com>
 <alpine.LFD.2.22.394.2006061712190.194656@reclus.nhh.no>
 <B787B11E-8B8B-4DE1-B842-5B47F18D5586@gmail.com>
 <490e6ae1-707e-fb66-3fc9-c9bc69a5ad00@uni-muenster.de>
Message-ID: <DAA3D333-F989-4B57-BE37-8F796416373D@gmail.com>

Edzer,

I appreciate your message and agree with everything.

In addition I want to clarify that the Twitter post does not solely 
result out of / refer to the recent messages of today.
It summarizes observations of mine over a longer period from many 
different people and today's discussion might simply have caused this 
overflow (of emotions).
That?s why I did not add any names or other details, to say that again 
explicitly.
Maybe I should have kept it in my head, though.

Happy coding everyone,
Patrick

On 6 Jun 2020, at 22:31, Edzer Pebesma wrote:

> On 6/6/20 9:15 PM, Patrick Schratz wrote:
>> Since I use and contribute to R (6 years for now) I was always on the
>> side of "help everyone", "things can get better/easier", "don't 
>> create
>> your own island solutions". However, I was hitting some (in my view, 
>> not
>> understandable) "walls" recently and I am not sure if I want to 
>> continue
>> with this attitude.
>
> Dear Patrick,
>
> We should keep in mind that the system requirements of the R spatial
> packages is quite likely the most complicated there is on CRAN, that 
> it
> has a long legacy, and that GDAL/PROJ came very dynamic recently, and
> that many people (though not enough) are involved.
>
> I think that you're learning that working with people is much harder
> than working with technology.
>
> I highly appreciate the contributions you made to CI for R packages 
> [*],
> and the way you helped making it work for sf; this helps robust
> development and finding bugs early. However, the moment something 
> breaks
> in the CI setup, I have no clue what to do and have to ask your help. 
> If
> I wouldn't get that help a couple of times, I would drop the whole 
> thing
> and throw it out of the window. For people using sf this is the same:
> they have no clue how it works; if it doesn't work a couple of times 
> and
> help doesn't come quickly, they throw it out of the window and look 
> for
> something else that does work.
>
> What you have to realize is that what looks simple for you (e.g. CI)
> looks incredibly complicated for other people, for the simple reason
> that they have been doing very different things for the last 6 years,
> and have neither time nor ambition to make up for that. Convincing
> others to change something by arguing the change is "simple and makes
> things better" often does not work because the receiver has a 
> different
> perception of "simple" and is not convinced that the status quo is not
> good enough, or is convinced the change brings a lot of work and/or
> added complexity. I don't think it helps to get emotional publicly in
> such a case and move to twitter [&], nor to become disappointed in the 
> R
> project. If you'd move to another project, you'll find yourself again
> confronted with people, and discover that communication is always 
> difficult.
>
> [*] see e.g. https://github.com/ropensci/tic
> [&] https://twitter.com/pjs_228/status/1269301044481339392
> -- 
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48149 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun  7 12:06:49 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 7 Jun 2020 12:06:49 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
 <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006071200170.997990@reclus.nhh.no>

On Fri, 5 Jun 2020, Lom Navanyo wrote:

> Thank you once again. To clarify, which is more suitable, end of year water
> levels or yearly average measure of water levels?
>
> Also below are a few more notes to throw more light on my variables/data:
>
> These wells are solely for irrigation purposes and are 
> irrigator/farmer-owned and operated. No farmer/irrigator moves to 
> another well not owned by him. The only reason to suspect any spatial 
> externalities is because the wells share a common aquifer. And this is 
> essentially what I am testing.

Is irrigation by fixed pipe, or can the water be moved to the area of 
another well? Can irrigators extract water from multiple wells? Is then 
the irrigator the unit of observation rather than the well?

>
> It is also understood that there are not much variation in the geography
> and geology of the study region.
>
> I have data a number of well specific features in addition to the water
> level. I also have some farm data including cropping and technology use
> data. No soil data though.
> No recharge data too as well.

OK, the farming data may reflect the demand for water. Do the different 
crops or technologies have different seasonal patterns, leading to 
different draw-down patterns in the wells over time?

>
> In fact, I agree a lot factors can come to play here and I may not have or
> observe all but I was thinking I could incorporate some fixed effects
> to take care of those, especially for those I suspect (or perhaps by
> theory) are likely to not vary much in terms of their effect on
> irrigation(pumping) decisions across farmers
> or effect on water level.
>
> My panel is rather a short one: I have a five year panel data.
>
> Given the above, is it still not advisable to use any spatial econometric
> analysis? Just a simple OLS will suffice?

OLS probably not, but the decisions are starting to look like farmers' 
cropping decisions, leading to varied need for water. Do the farmers pay 
for the water or the irrigation technology?

I'm starting to think that maybe SUR is a possibility, but am unsure how 
your short panel would handle that.

Roger

>
> Thanks.
> ----------------------
> Lom
>
>
>
>
>
> On Fri, Jun 5, 2020 at 3:51 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 5 Jun 2020, Lom Navanyo wrote:
>>
>>> I fully agree with you and appreciate the listed benefits of not taking
>>> things private. I was just trying to be sure the forum here is
>> appropriate
>>> and receptive of a beginner like me.
>>>
>>> To be more explicit with regards to my observations, y is amount of
>>> water withdrawal from wells and an important variable in x is (height
>>> of) water level in the wells. These are end of year figures. I am using
>>> the aggregations (sum for y and mean for water level) by band as spatial
>>> neighborhood variables. There will be one or two indicator variables
>>> also in x. I hope these do not present additional hurdles.
>>
>> There are several further questions. If water level is measured at
>> end-of-year, it is instantaneous at that point, and will depend on level a
>> year earlier plus inflow from the movements of the water table
>> (precipitation, soils and surface geology, maybe geology if deeper wells),
>> minus evaporation (if an open well) and extraction. However, your y
>> (extraction) is probably measured over an interval (1 Jan - 31 Dec?). It
>> does not depend on level unless level is 0, but depends on the closeness
>> of people extracting water for domestic, agricultural or other use.
>>
>> All else equal, you would expect changes in the level in a well to depend
>> on inputs, evaporation and extraction, and extraction at that well and
>> other nearby wells (which may experience falls in the ground water table
>> level not because the water was extracted from those wells, but at
>> neighbouring wells. You may also see users shifting to neerby wells if
>> their closest well runs dry.
>>
>> So you probably need to start with a deterministic hydrological model, and
>> you need much more information about who extracts and why. Say in India,
>> you would also need price data - apparently free water has led to
>> over-extraction.
>>
>> So I would advise against any spatial econometric analysis of the data you
>> have, because so much is going on in the system as a whole that you cannot
>> control if all the data you have is as you describe. I also understand
>> better why well water level is endogeneous, but am sure that IV will not
>> help, since the level is being driven partly by a deterministic
>> hydrological system which differs from well to well, and extraction varies
>> by demand.
>>
>> Has anyone worked with this kind of data? Any ideas or contributions more
>> helpful than the above?
>>
>> Roger
>>
>>>
>>> I am thinking Proximity is relevant in testing spatial
>>> dependency/externality.
>>>
>>> I will consider splm package  and the SLX model.
>>>
>>> Thank you.
>>> ---------------
>>> Lom
>>>
>>> On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>>>
>>>>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS
>> approach.
>>>> I
>>>>> have a variable I intend to use as an IV for y.
>>>>> I have seen a few papers use this approach. Will this approach not
>>>> correct
>>>>> for the endogeneity?
>>>>>
>>>>> Actually, I am not sure if this is a right forum or perhaps if it's
>>>>> appropriate or acceptable to you to take this one-on-one with you for
>>>> help:
>>>>
>>>> I do not offer private help. That would presuppose that one person has
>> the
>>>> answer. It would also presuppose that all exchanges are only read by the
>>>> original poster and direct participants, while in fact others may join
>> in,
>>>> or follow a thread, or find the thread by searching: google supports the
>>>> list:r-sig-geo search tag. If the thread goes private, that search is
>>>> fruitless.
>>>>
>>>>> My model actually looks like this: y= f(y, x)  + e.
>>>>> Aside the endogeneity of y (which I intend to instrument by another
>>>>> variable z), there is simultaneity between y and x.
>>>>> I intend to use the lag of x as instrument for x.  Given that I am
>>>> seeking
>>>>> to test spatial dependency, do you see some fatal flaws with my
>> approach?
>>>>>
>>>>
>>>> What is the support of your observations, point, or are they
>> aggregations?
>>>> Why may proximity make a difference - often, apparent spatial
>>>> autocorrelation is caused by observing inappropriate entities, or by
>>>> omitting covariates, or by using the wrong functional form.
>>>>
>>>>
>>>>> I have also seen other empirical approaches like static and dynamic
>>>> spatial
>>>>> panel data modelling. I will be reviewing them also to see suitability
>>>> for
>>>>> my objective.
>>>>> But, any further directions or suggestions are highly appreciated.
>>>>
>>>> If the data are spatial panel, you can look at the splm package.
>>>> Personally, I have never found instruments any use at all, because the
>>>> instruments are typically at best weak because of shared spatial
>> processes
>>>> with the response, unless the model is really well specified from known
>>>> theory. In space, almost everything is close to endogeneous unless the
>>>> opposite is demonstrated. So causal relationships are less worthwhile,
>>>> because they are at best conditional on omitted variables and
>>>> autocorrelation engendered by the choice of observational entities.
>>>>
>>>> Further, because spatial processes are driven by the inverse matrix of
>> the
>>>> input graph of proximate neighbours (the covariance matrix of the
>> spatial
>>>> process), you don't need to start from more than the first order
>>>> neighbours. Maybe your x has the same spatial pattern as y, so that the
>>>> residuals are white noise with no spatial structure.
>>>>
>>>> Recently, analysts prefer to start with the SLX model (Halleck Vega &
>>>> Elhorst 2015 and others), so that might be worth exploring. If only the
>>>> direct impacts seem important, OLS may be enough.
>>>>
>>>> Hope this helps,
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> Thanks,
>>>>> -------------------
>>>>> Lom
>>>>>
>>>>>
>>>>>
>>>>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>>>>
>>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>>>>>
>>>>>>> Thank you very much for your support. This gives me what I need and I
>>>>>> must
>>>>>>> say listw2sn() is really great.
>>>>>>>
>>>>>>> Why do I need the data in the format as in dataout? I am trying to
>> test
>>>>>>> spatial dependence (or neighborhood effect) by running a regression
>>>>>>> model that entails pop_size_it = beta_1*sum of pop_size of point i's
>>>>>>> neighbors within a specified radius. So my plan is to get the
>> neighbors
>>>>>>> for each focal point as per the specified bands and their attributes
>>>> (eg
>>>>>>> pop_size) so I can can add them (attribute) by the bands.
>>>>>>
>>>>>> Thanks, clarifies a good deal. Maybe look at the original localG
>>>> articles
>>>>>> for exploring distance relationships (Getis and Ord looked at
>> HIV/AIDS);
>>>>>> ?spdep::localG or
>>>> https://r-spatial.github.io/spdep/reference/localG.html.
>>>>>>
>>>>>> Further note at OLS is biased as you have y = f(y) + e, so y on both
>>>>>> sides. The nearest equivalent for a single band is
>>>> spatialreg::lagsarlm()
>>>>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums through
>>>> the
>>>>>> weights matrix. So both your betas and their standard errors are
>>>> unusable,
>>>>>> I'm afraid. You are actually very much closer to ordinary kriging,
>>>> looking
>>>>>> at the way in which distance attenuates the correlation in value of
>>>>>> proximate observations.
>>>>>>
>>>>>> Hope this clarifies,
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>> I am totally new to the area of spatial econometrics, so I am taking
>>>>>> things
>>>>>>> one step at a time. Some readings suggest I may need distance matrix
>> or
>>>>>>> weight matrix but for now I think I should try the current approach.
>>>>>>>
>>>>>>> Thank you.
>>>>>>>
>>>>>>> -------------
>>>>>>> Lom
>>>>>>>
>>>>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>> wrote:
>>>>>>>
>>>>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>>>>>>>>
>>>>>>>>> I had the errors with rtree using R 3.6.3. I have since changed to
>> R
>>>>>>>> 4.0.0
>>>>>>>>> but I got the same error.
>>>>>>>>>
>>>>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4, all
>>>>>> with
>>>>>>>>> length 101. I think my difficulty is my inability to output the
>> list
>>>>>>>>> detailing the point IDs t50_fid.
>>>>>>>>
>>>>>>>> library(spData)
>>>>>>>> library(sf)
>>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>>> pts <- st_coordinates(projdata)
>>>>>>>> library(spdep)
>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>>> bds <- c(0, bufferR)
>>>>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
>>>>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
>>>>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
>>>>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
>>>>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
>>>>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
>>>>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
>>>>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
>>>>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
>>>>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
>>>>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
>>>>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
>>>>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
>>>>>> sn_band4))
>>>>>>>> class(data_out) <- "data.frame"
>>>>>>>> table(data_out$band)
>>>>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
>>>>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
>>>>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
>>>>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
>>>>>>>> str(data_out)
>>>>>>>>
>>>>>>>> The "spatial.neighbour" representation was that used in the S-Plus
>>>>>>>> SpatialStats module, with "from" and "to" columns, and here drops
>>>>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
>>>>>>>> for creating the output, and from there, just look-up in the
>>>>>>>> input data.frame. Observations here cannot be their own neighbours.
>>>>>>>>
>>>>>>>> It would be relevant to know why you need these, are you looking at
>>>>>>>> variogram clouds?
>>>>>>>>
>>>>>>>> Hope this clarifies,
>>>>>>>>
>>>>>>>> Roger
>>>>>>>>
>>>>>>>>>
>>>>>>>>> ---------
>>>>>>>>> Lom
>>>>>>>>>
>>>>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
>>>>>> wrote:
>>>>>>>>>
>>>>>>>>>> Roger's example works for me and gives a list of length 101. I did
>>>>>> have
>>>>>>>>>> some issues that were resolved by updating packages. I'm using R
>>>> 3.6.3
>>>>>>>> on
>>>>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with R
>>>>>> 3.6.3.
>>>>>>>>>>
>>>>>>>>>> Kent
>>>>>>>>>>
>>>>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <Roger.Bivand at nhh.no
>>>
>>>>>>>> wrote:
>>>>>>>>>>
>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>>>
>>>>>>>>>>>> rtree uses Euclidean distance so the points should be in a
>>>>>> coordinate
>>>>>>>>>>>> system where this makes sense at least as a reasonable
>>>>>> approximation.
>>>>>>>>>>>
>>>>>>>>>>> I tried the original example:
>>>>>>>>>>>
>>>>>>>>>>> remotes::install_github("hunzikp/rtree")
>>>>>>>>>>> library(spData)
>>>>>>>>>>> library(sf)
>>>>>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>>>>>> library(rtree)
>>>>>>>>>>> pts <- st_coordinates(projdata)
>>>>>>>>>>> rt <- RTree(st_coordinates(projdata))
>>>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>>>>>>>>>
>>>>>>>>>>> but unfortunately failed (maybe newer Boost headers than yours?):
>>>>>>>>>>>
>>>>>>>>>>> Error in UseMethod("withinDistance", rTree) :
>>>>>>>>>>>    no applicable method for 'withinDistance' applied to an object
>>>> of
>>>>>>>>>>> class
>>>>>>>>>>> "c('list', 'RTree')"
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Kent
>>>>>>>>>>>>
>>>>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <
>> Roger.Bivand at nhh.no>
>>>>>>>>>>> wrote:
>>>>>>>>>>>>
>>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
>>>>>>>> neighboring
>>>>>>>>>>>>>>>         points within specified radii (distances) for each
>>>> point
>>>>>>>> in a
>>>>>>>>>>>>> given
>>>>>>>>>>>>>>>         points data set.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>>>> I have data set of about 3400 location points with which I am
>>>>>>>> trying
>>>>>>>>>>> to
>>>>>>>>>>>>>>> generate data of each point and their neighbors within
>> defined
>>>>>>>> radii
>>>>>>>>>>>>> (eg,
>>>>>>>>>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> The rtree package is very fast and memory-efficient for
>>>>>>>>>>> within-distance
>>>>>>>>>>>>>> calculations.
>>>>>>>>>>>>>> https://github.com/hunzikp/rtree
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thanks! Does this also apply when the input points are in
>>>>>>>> geographical
>>>>>>>>>>>>> coordinates?
>>>>>>>>>>>>>
>>>>>>>>>>>>> Roger
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Kent Johnson
>>>>>>>>>>>>>> Cambridge, MA
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> --
>>>>>>>>>>>>> Roger Bivand
>>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> --
>>>>>>>>>>> Roger Bivand
>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> --
>>>>>>>> Roger Bivand
>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun  7 21:41:16 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 7 Jun 2020 21:41:16 +0200
Subject: [R-sig-Geo] R-spatial packages with external software requirements
Message-ID: <alpine.LFD.2.22.394.2006072116360.1855478@reclus.nhh.no>

Following the last few days' posts on this list on building rgdal from 
source on macOS, I'd like to draw attention to OSGeo initiatives:

https://wiki.osgeo.org/wiki/SAC_Shared_Building_Services

and this discussion issue:

https://github.com/r-spatial/discuss/issues/37#issuecomment-640265943

based on a grass-dev thread:

https://lists.osgeo.org/pipermail/grass-dev/2020-June/094453.html

Please join the discussion here and on the r-spatial discussion issue 
if you use github. Please also follow up the grass-dev thread with regard 
to CI. Following the OSGeo shared building services initiative may help 
those installing from source on Windows and macOS. If we in addition can 
promote the provision of reliable static-linkable components, we could 
perhaps reduce the burden on CRAN, especially if CI could check CRAN 
compatability of build trains (compiler versions etc.).

We would have more leverage if r-spatial in some form became a project 
associated with OSGeo as well as R itself, as mentioned in the discussion 
issue.

If a list member has edit access to the OSGeo wiki, please add text about 
r-spatial, for example to "Current State":

R Windows binary packages distributed by the Comprehensive R Archive 
Network (CRAN) using OSGeo software (chiefly PROJ, GDAL and GEOS) use 
custom built binaries compatible with the build train used by R and are 
static linked; at present both 32-bit and 64-bit binaries are deployed. 
CRAN packages for macOS are also static linked to custom built binaries, 
again using the build train used by R. Static linkage is used to avoid 
having to deploy a package manager for external software on which R 
packages depend, since CRAN as a package manager already supports over 
15000 packages with three binary versions (devel, release, old release) 
for Windows and macOS.

Please report back here if you are able to enter this text or similar, or 
are in touch with the site admin.

Contributions very welcome!

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From |omn@v@@|@ @end|ng |rom gm@||@com  Mon Jun  8 02:23:52 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Sun, 7 Jun 2020 19:23:52 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006071200170.997990@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyj9byWgc5BBZCrGRDs0W06HttaU0_SQJpouct=SNcdVUA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021557450.4600@reclus.nhh.no>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
 <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006071200170.997990@reclus.nhh.no>
Message-ID: <CAKBoCbEUKKQedieZhgZKqiXYXtFFJWnpOVEG6Kofuh5m=PHqYw@mail.gmail.com>

Some farmers own more than one well and thus can extract from their
multiple wells. Others are single well owners.

The amount of water pumped by the irrigator from their wells is the unit of
observation. And I do not know how it might sound but
I would say "irrigator-well" is the unit of analysis?

Both crops and technology have seasonal patterns, though not pronounced
probably due to switching costs.

I have two segments of the data: A section or  a group of neighboring
irrigators pay fees for water withdrawal. The second group (of neighbors)
does
not pay any fee aside their individual lift cost (which is not observed in
the data). I do not intend to run a difference-in-difference model with
respect
to the fee as that's not what I want to study. So I intend to run separate
models/specifications for the two groups.

Thanks,
-----------------
Lom

On Sun, Jun 7, 2020 at 5:06 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 5 Jun 2020, Lom Navanyo wrote:
>
> > Thank you once again. To clarify, which is more suitable, end of year
> water
> > levels or yearly average measure of water levels?
> >
> > Also below are a few more notes to throw more light on my variables/data:
> >
> > These wells are solely for irrigation purposes and are
> > irrigator/farmer-owned and operated. No farmer/irrigator moves to
> > another well not owned by him. The only reason to suspect any spatial
> > externalities is because the wells share a common aquifer. And this is
> > essentially what I am testing.
>
> Is irrigation by fixed pipe, or can the water be moved to the area of
> another well? Can irrigators extract water from multiple wells? Is then
> the irrigator the unit of observation rather than the well?
>
> >
> > It is also understood that there are not much variation in the geography
> > and geology of the study region.
> >
> > I have data a number of well specific features in addition to the water
> > level. I also have some farm data including cropping and technology use
> > data. No soil data though.
> > No recharge data too as well.
>
> OK, the farming data may reflect the demand for water. Do the different
> crops or technologies have different seasonal patterns, leading to
> different draw-down patterns in the wells over time?
>
> >
> > In fact, I agree a lot factors can come to play here and I may not have
> or
> > observe all but I was thinking I could incorporate some fixed effects
> > to take care of those, especially for those I suspect (or perhaps by
> > theory) are likely to not vary much in terms of their effect on
> > irrigation(pumping) decisions across farmers
> > or effect on water level.
> >
> > My panel is rather a short one: I have a five year panel data.
> >
> > Given the above, is it still not advisable to use any spatial econometric
> > analysis? Just a simple OLS will suffice?
>
> OLS probably not, but the decisions are starting to look like farmers'
> cropping decisions, leading to varied need for water. Do the farmers pay
> for the water or the irrigation technology?
>
> I'm starting to think that maybe SUR is a possibility, but am unsure how
> your short panel would handle that.
>
> Roger
>
> >
> > Thanks.
> > ----------------------
> > Lom
> >
> >
> >
> >
> >
> > On Fri, Jun 5, 2020 at 3:51 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Fri, 5 Jun 2020, Lom Navanyo wrote:
> >>
> >>> I fully agree with you and appreciate the listed benefits of not taking
> >>> things private. I was just trying to be sure the forum here is
> >> appropriate
> >>> and receptive of a beginner like me.
> >>>
> >>> To be more explicit with regards to my observations, y is amount of
> >>> water withdrawal from wells and an important variable in x is (height
> >>> of) water level in the wells. These are end of year figures. I am using
> >>> the aggregations (sum for y and mean for water level) by band as
> spatial
> >>> neighborhood variables. There will be one or two indicator variables
> >>> also in x. I hope these do not present additional hurdles.
> >>
> >> There are several further questions. If water level is measured at
> >> end-of-year, it is instantaneous at that point, and will depend on
> level a
> >> year earlier plus inflow from the movements of the water table
> >> (precipitation, soils and surface geology, maybe geology if deeper
> wells),
> >> minus evaporation (if an open well) and extraction. However, your y
> >> (extraction) is probably measured over an interval (1 Jan - 31 Dec?). It
> >> does not depend on level unless level is 0, but depends on the closeness
> >> of people extracting water for domestic, agricultural or other use.
> >>
> >> All else equal, you would expect changes in the level in a well to
> depend
> >> on inputs, evaporation and extraction, and extraction at that well and
> >> other nearby wells (which may experience falls in the ground water table
> >> level not because the water was extracted from those wells, but at
> >> neighbouring wells. You may also see users shifting to neerby wells if
> >> their closest well runs dry.
> >>
> >> So you probably need to start with a deterministic hydrological model,
> and
> >> you need much more information about who extracts and why. Say in India,
> >> you would also need price data - apparently free water has led to
> >> over-extraction.
> >>
> >> So I would advise against any spatial econometric analysis of the data
> you
> >> have, because so much is going on in the system as a whole that you
> cannot
> >> control if all the data you have is as you describe. I also understand
> >> better why well water level is endogeneous, but am sure that IV will not
> >> help, since the level is being driven partly by a deterministic
> >> hydrological system which differs from well to well, and extraction
> varies
> >> by demand.
> >>
> >> Has anyone worked with this kind of data? Any ideas or contributions
> more
> >> helpful than the above?
> >>
> >> Roger
> >>
> >>>
> >>> I am thinking Proximity is relevant in testing spatial
> >>> dependency/externality.
> >>>
> >>> I will consider splm package  and the SLX model.
> >>>
> >>> Thank you.
> >>> ---------------
> >>> Lom
> >>>
> >>> On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>>
> >>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>>>
> >>>>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS
> >> approach.
> >>>> I
> >>>>> have a variable I intend to use as an IV for y.
> >>>>> I have seen a few papers use this approach. Will this approach not
> >>>> correct
> >>>>> for the endogeneity?
> >>>>>
> >>>>> Actually, I am not sure if this is a right forum or perhaps if it's
> >>>>> appropriate or acceptable to you to take this one-on-one with you for
> >>>> help:
> >>>>
> >>>> I do not offer private help. That would presuppose that one person has
> >> the
> >>>> answer. It would also presuppose that all exchanges are only read by
> the
> >>>> original poster and direct participants, while in fact others may join
> >> in,
> >>>> or follow a thread, or find the thread by searching: google supports
> the
> >>>> list:r-sig-geo search tag. If the thread goes private, that search is
> >>>> fruitless.
> >>>>
> >>>>> My model actually looks like this: y= f(y, x)  + e.
> >>>>> Aside the endogeneity of y (which I intend to instrument by another
> >>>>> variable z), there is simultaneity between y and x.
> >>>>> I intend to use the lag of x as instrument for x.  Given that I am
> >>>> seeking
> >>>>> to test spatial dependency, do you see some fatal flaws with my
> >> approach?
> >>>>>
> >>>>
> >>>> What is the support of your observations, point, or are they
> >> aggregations?
> >>>> Why may proximity make a difference - often, apparent spatial
> >>>> autocorrelation is caused by observing inappropriate entities, or by
> >>>> omitting covariates, or by using the wrong functional form.
> >>>>
> >>>>
> >>>>> I have also seen other empirical approaches like static and dynamic
> >>>> spatial
> >>>>> panel data modelling. I will be reviewing them also to see
> suitability
> >>>> for
> >>>>> my objective.
> >>>>> But, any further directions or suggestions are highly appreciated.
> >>>>
> >>>> If the data are spatial panel, you can look at the splm package.
> >>>> Personally, I have never found instruments any use at all, because the
> >>>> instruments are typically at best weak because of shared spatial
> >> processes
> >>>> with the response, unless the model is really well specified from
> known
> >>>> theory. In space, almost everything is close to endogeneous unless the
> >>>> opposite is demonstrated. So causal relationships are less worthwhile,
> >>>> because they are at best conditional on omitted variables and
> >>>> autocorrelation engendered by the choice of observational entities.
> >>>>
> >>>> Further, because spatial processes are driven by the inverse matrix of
> >> the
> >>>> input graph of proximate neighbours (the covariance matrix of the
> >> spatial
> >>>> process), you don't need to start from more than the first order
> >>>> neighbours. Maybe your x has the same spatial pattern as y, so that
> the
> >>>> residuals are white noise with no spatial structure.
> >>>>
> >>>> Recently, analysts prefer to start with the SLX model (Halleck Vega &
> >>>> Elhorst 2015 and others), so that might be worth exploring. If only
> the
> >>>> direct impacts seem important, OLS may be enough.
> >>>>
> >>>> Hope this helps,
> >>>>
> >>>> Roger
> >>>>
> >>>>>
> >>>>> Thanks,
> >>>>> -------------------
> >>>>> Lom
> >>>>>
> >>>>>
> >>>>>
> >>>>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no>
> >> wrote:
> >>>>>
> >>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>>>>>
> >>>>>>> Thank you very much for your support. This gives me what I need
> and I
> >>>>>> must
> >>>>>>> say listw2sn() is really great.
> >>>>>>>
> >>>>>>> Why do I need the data in the format as in dataout? I am trying to
> >> test
> >>>>>>> spatial dependence (or neighborhood effect) by running a regression
> >>>>>>> model that entails pop_size_it = beta_1*sum of pop_size of point
> i's
> >>>>>>> neighbors within a specified radius. So my plan is to get the
> >> neighbors
> >>>>>>> for each focal point as per the specified bands and their
> attributes
> >>>> (eg
> >>>>>>> pop_size) so I can can add them (attribute) by the bands.
> >>>>>>
> >>>>>> Thanks, clarifies a good deal. Maybe look at the original localG
> >>>> articles
> >>>>>> for exploring distance relationships (Getis and Ord looked at
> >> HIV/AIDS);
> >>>>>> ?spdep::localG or
> >>>> https://r-spatial.github.io/spdep/reference/localG.html.
> >>>>>>
> >>>>>> Further note at OLS is biased as you have y = f(y) + e, so y on both
> >>>>>> sides. The nearest equivalent for a single band is
> >>>> spatialreg::lagsarlm()
> >>>>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums
> through
> >>>> the
> >>>>>> weights matrix. So both your betas and their standard errors are
> >>>> unusable,
> >>>>>> I'm afraid. You are actually very much closer to ordinary kriging,
> >>>> looking
> >>>>>> at the way in which distance attenuates the correlation in value of
> >>>>>> proximate observations.
> >>>>>>
> >>>>>> Hope this clarifies,
> >>>>>>
> >>>>>> Roger
> >>>>>>
> >>>>>>>
> >>>>>>> I am totally new to the area of spatial econometrics, so I am
> taking
> >>>>>> things
> >>>>>>> one step at a time. Some readings suggest I may need distance
> matrix
> >> or
> >>>>>>> weight matrix but for now I think I should try the current
> approach.
> >>>>>>>
> >>>>>>> Thank you.
> >>>>>>>
> >>>>>>> -------------
> >>>>>>> Lom
> >>>>>>>
> >>>>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
> >>>> wrote:
> >>>>>>>
> >>>>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
> >>>>>>>>
> >>>>>>>>> I had the errors with rtree using R 3.6.3. I have since changed
> to
> >> R
> >>>>>>>> 4.0.0
> >>>>>>>>> but I got the same error.
> >>>>>>>>>
> >>>>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4,
> all
> >>>>>> with
> >>>>>>>>> length 101. I think my difficulty is my inability to output the
> >> list
> >>>>>>>>> detailing the point IDs t50_fid.
> >>>>>>>>
> >>>>>>>> library(spData)
> >>>>>>>> library(sf)
> >>>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>>> pts <- st_coordinates(projdata)
> >>>>>>>> library(spdep)
> >>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>>> bds <- c(0, bufferR)
> >>>>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
> >>>>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
> >>>>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
> >>>>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
> >>>>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> >>>>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> >>>>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> >>>>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> >>>>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> >>>>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> >>>>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> >>>>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> >>>>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
> >>>>>> sn_band4))
> >>>>>>>> class(data_out) <- "data.frame"
> >>>>>>>> table(data_out$band)
> >>>>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
> >>>>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
> >>>>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
> >>>>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
> >>>>>>>> str(data_out)
> >>>>>>>>
> >>>>>>>> The "spatial.neighbour" representation was that used in the S-Plus
> >>>>>>>> SpatialStats module, with "from" and "to" columns, and here drops
> >>>>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
> >>>>>>>> for creating the output, and from there, just look-up in the
> >>>>>>>> input data.frame. Observations here cannot be their own
> neighbours.
> >>>>>>>>
> >>>>>>>> It would be relevant to know why you need these, are you looking
> at
> >>>>>>>> variogram clouds?
> >>>>>>>>
> >>>>>>>> Hope this clarifies,
> >>>>>>>>
> >>>>>>>> Roger
> >>>>>>>>
> >>>>>>>>>
> >>>>>>>>> ---------
> >>>>>>>>> Lom
> >>>>>>>>>
> >>>>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
> >>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> Roger's example works for me and gives a list of length 101. I
> did
> >>>>>> have
> >>>>>>>>>> some issues that were resolved by updating packages. I'm using R
> >>>> 3.6.3
> >>>>>>>> on
> >>>>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with
> R
> >>>>>> 3.6.3.
> >>>>>>>>>>
> >>>>>>>>>> Kent
> >>>>>>>>>>
> >>>>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <
> Roger.Bivand at nhh.no
> >>>
> >>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>> rtree uses Euclidean distance so the points should be in a
> >>>>>> coordinate
> >>>>>>>>>>>> system where this makes sense at least as a reasonable
> >>>>>> approximation.
> >>>>>>>>>>>
> >>>>>>>>>>> I tried the original example:
> >>>>>>>>>>>
> >>>>>>>>>>> remotes::install_github("hunzikp/rtree")
> >>>>>>>>>>> library(spData)
> >>>>>>>>>>> library(sf)
> >>>>>>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>>>>>> library(rtree)
> >>>>>>>>>>> pts <- st_coordinates(projdata)
> >>>>>>>>>>> rt <- RTree(st_coordinates(projdata))
> >>>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>>>>>>>>>
> >>>>>>>>>>> but unfortunately failed (maybe newer Boost headers than
> yours?):
> >>>>>>>>>>>
> >>>>>>>>>>> Error in UseMethod("withinDistance", rTree) :
> >>>>>>>>>>>    no applicable method for 'withinDistance' applied to an
> object
> >>>> of
> >>>>>>>>>>> class
> >>>>>>>>>>> "c('list', 'RTree')"
> >>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>> Kent
> >>>>>>>>>>>>
> >>>>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <
> >> Roger.Bivand at nhh.no>
> >>>>>>>>>>> wrote:
> >>>>>>>>>>>>
> >>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>>>>>>>>>> To: r-sig-geo at r-project.org
> >>>>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> >>>>>>>> neighboring
> >>>>>>>>>>>>>>>         points within specified radii (distances) for each
> >>>> point
> >>>>>>>> in a
> >>>>>>>>>>>>> given
> >>>>>>>>>>>>>>>         points data set.
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> Hello,
> >>>>>>>>>>>>>>> I have data set of about 3400 location points with which I
> am
> >>>>>>>> trying
> >>>>>>>>>>> to
> >>>>>>>>>>>>>>> generate data of each point and their neighbors within
> >> defined
> >>>>>>>> radii
> >>>>>>>>>>>>> (eg,
> >>>>>>>>>>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> The rtree package is very fast and memory-efficient for
> >>>>>>>>>>> within-distance
> >>>>>>>>>>>>>> calculations.
> >>>>>>>>>>>>>> https://github.com/hunzikp/rtree
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> Thanks! Does this also apply when the input points are in
> >>>>>>>> geographical
> >>>>>>>>>>>>> coordinates?
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> Roger
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> Kent Johnson
> >>>>>>>>>>>>>> Cambridge, MA
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>       [[alternative HTML version deleted]]
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>> R-sig-Geo mailing list
> >>>>>>>>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> --
> >>>>>>>>>>>>> Roger Bivand
> >>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> --
> >>>>>>>>>>> Roger Bivand
> >>>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>> --
> >>>>>>>> Roger Bivand
> >>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>> --
> >>>>>> Roger Bivand
> >>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>
> >>>>>
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>> https://orcid.org/0000-0003-2392-6140
> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun  8 11:23:49 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 8 Jun 2020 09:23:49 +0000
Subject: [R-sig-Geo] 
 R-spatial packages with external software requirements
In-Reply-To: <6E239BFE-F77E-4F5C-9D10-DF1CB188EE5A@icloud.com>
References: <alpine.LFD.2.22.394.2006072116360.1855478@reclus.nhh.no>,
 <6E239BFE-F77E-4F5C-9D10-DF1CB188EE5A@icloud.com>
Message-ID: <04354739beb3434c8e5bdeeeb12f9623@nhh.no>

Hi Rainer:

The relevant page is: https://wiki.osgeo.org/wiki/SAC_Shared_Building_Services, do you have access to that?

Best wishes,

Roger

--
Roger Bivand
Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: Rainer Krug <rainer_krug at icloud.com>
Sendt: mandag 8. juni 2020 08.49
Til: Roger Bivand
Kopi: r-sig-geo at r-project.org
Emne: Re: [R-sig-Geo] R-spatial packages with external software requirements

Hi Roger,

I have edit access - if you could give me the URL on which you would like to have the text?

Thanks,

Rainer



On 7 Jun 2020, at 21:41, Roger Bivand <Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>> wrote:

Following the last few days' posts on this list on building rgdal from source on macOS, I'd like to draw attention to OSGeo initiatives:

https://wiki.osgeo.org/wiki/SAC_Shared_Building_Services

and this discussion issue:

https://github.com/r-spatial/discuss/issues/37#issuecomment-640265943

based on a grass-dev thread:

https://lists.osgeo.org/pipermail/grass-dev/2020-June/094453.html

Please join the discussion here and on the r-spatial discussion issue if you use github. Please also follow up the grass-dev thread with regard to CI. Following the OSGeo shared building services initiative may help those installing from source on Windows and macOS. If we in addition can promote the provision of reliable static-linkable components, we could perhaps reduce the burden on CRAN, especially if CI could check CRAN compatability of build trains (compiler versions etc.).

We would have more leverage if r-spatial in some form became a project associated with OSGeo as well as R itself, as mentioned in the discussion issue.

If a list member has edit access to the OSGeo wiki, please add text about r-spatial, for example to "Current State":

R Windows binary packages distributed by the Comprehensive R Archive Network (CRAN) using OSGeo software (chiefly PROJ, GDAL and GEOS) use custom built binaries compatible with the build train used by R and are static linked; at present both 32-bit and 64-bit binaries are deployed. CRAN packages for macOS are also static linked to custom built binaries, again using the build train used by R. Static linkage is used to avoid having to deploy a package manager for external software on which R packages depend, since CRAN as a package manager already supports over 15000 packages with three binary versions (devel, release, old release) for Windows and macOS.

Please report back here if you are able to enter this text or similar, or are in touch with the site admin.

Contributions very welcome!

Roger

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Orcid ID: 0000-0002-7490-0066

Department of Evolutionary Biology and Environmental Studies
University of Z?rich
Office Y34-J-74
Winterthurerstrasse 190
8075 Z?rich
Switzerland

Office: +41 (0)44 635 47 64
Cell:        +41 (0)78 630 66 57
email:      Rainer.Krug at uzh.ch<mailto:Rainer.Krug at uzh.ch>
Rainer at krugs.de<mailto:Rainer at krugs.de>
Skype:     RMkrug

PGP: 0x0F52F982


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun  8 14:12:22 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 8 Jun 2020 14:12:22 +0200
Subject: [R-sig-Geo] 
 R-spatial packages with external software requirements
In-Reply-To: <1A9E3602-648C-4152-9CFF-A8A5B79594B2@uv.es>
References: <alpine.LFD.2.22.394.2006072116360.1855478@reclus.nhh.no>
 <1A9E3602-648C-4152-9CFF-A8A5B79594B2@uv.es>
Message-ID: <alpine.LFD.2.22.394.2006081408270.1889984@reclus.nhh.no>

On Mon, 8 Jun 2020, Agust?n Diez Castillo wrote:

> Roger,
> See if this [1] is what you were asking for. As far as there is a Mac specific session I?ve duplicated some of your statements.
> Thanks for bringing taht to osGEO
> Agust?n
> [1] https://wiki.osgeo.org/wiki/SAC_Shared_Building_Services

Agustin,

Thanks very much! This gives a place-holder - how should we "handshake" to 
OSGeo on this? Adding this mailing list to the wiki is unhelpful for 
non-subscribers - it would be helpful to identify people to contact.

Best wishes,

Roger

>
>> On 7 Jun 2020, at 21:41, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>> Following the last few days' posts on this list on building rgdal from source on macOS, I'd like to draw attention to OSGeo initiatives:
>>
>> https://wiki.osgeo.org/wiki/SAC_Shared_Building_Services
>>
>> and this discussion issue:
>>
>> https://github.com/r-spatial/discuss/issues/37#issuecomment-640265943
>>
>> based on a grass-dev thread:
>>
>> https://lists.osgeo.org/pipermail/grass-dev/2020-June/094453.html
>>
>> Please join the discussion here and on the r-spatial discussion issue if you use github. Please also follow up the grass-dev thread with regard to CI. Following the OSGeo shared building services initiative may help those installing from source on Windows and macOS. If we in addition can promote the provision of reliable static-linkable components, we could perhaps reduce the burden on CRAN, especially if CI could check CRAN compatability of build trains (compiler versions etc.).
>>
>> We would have more leverage if r-spatial in some form became a project associated with OSGeo as well as R itself, as mentioned in the discussion issue.
>>
>> If a list member has edit access to the OSGeo wiki, please add text about r-spatial, for example to "Current State":
>>
>> R Windows binary packages distributed by the Comprehensive R Archive Network (CRAN) using OSGeo software (chiefly PROJ, GDAL and GEOS) use custom built binaries compatible with the build train used by R and are static linked; at present both 32-bit and 64-bit binaries are deployed. CRAN packages for macOS are also static linked to custom built binaries, again using the build train used by R. Static linkage is used to avoid having to deploy a package manager for external software on which R packages depend, since CRAN as a package manager already supports over 15000 packages with three binary versions (devel, release, old release) for Windows and macOS.
>>
>> Please report back here if you are able to enter this text or similar, or are in touch with the site admin.
>>
>> Contributions very welcome!
>>
>> Roger
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  9 12:35:53 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 9 Jun 2020 12:35:53 +0200
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <CAKBoCbEUKKQedieZhgZKqiXYXtFFJWnpOVEG6Kofuh5m=PHqYw@mail.gmail.com>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
 <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006071200170.997990@reclus.nhh.no>
 <CAKBoCbEUKKQedieZhgZKqiXYXtFFJWnpOVEG6Kofuh5m=PHqYw@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006091224470.1930273@reclus.nhh.no>

On Mon, 8 Jun 2020, Lom Navanyo wrote:

> Some farmers own more than one well and thus can extract from their
> multiple wells. Others are single well owners.
>
> The amount of water pumped by the irrigator from their wells is the unit of
> observation. And I do not know how it might sound but
> I would say "irrigator-well" is the unit of analysis?
>
> Both crops and technology have seasonal patterns, though not pronounced
> probably due to switching costs.
>
> I have two segments of the data: A section or a group of neighboring 
> irrigators pay fees for water withdrawal. The second group (of 
> neighbors) does not pay any fee aside their individual lift cost (which 
> is not observed in the data). I do not intend to run a 
> difference-in-difference model with respect to the fee as that's not 
> what I want to study. So I intend to run separate models/specifications 
> for the two groups.

This feels like a linear mixed effects model with an irrigator random 
effect and a temporal random effect. A spatial random effect (ICAR?) might 
be added, but it will be hard to split the identification of the irrigator 
RE from a spatially structured RE for the wells. I think that you should 
be looking at the mgcv package, the second edition of Simon Wood's book, 
and either an MRF or a Gaussian Process ("gp") spatial RE for the wells.

It may very well be that a group RE (fee/no fee) would discriminate 
between the groups statistically, but I'm out of my depth here. Anyway, 
mgcv, using a flexible functional form on water level, and RE's for the 
other components, seems possible. Structural regression using BayesX or 
INLA are also possible. You have 5 years, how many irrigators and how many 
wells?

Roger

>
> Thanks,
> -----------------
> Lom
>
> On Sun, Jun 7, 2020 at 5:06 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 5 Jun 2020, Lom Navanyo wrote:
>>
>>> Thank you once again. To clarify, which is more suitable, end of year
>> water
>>> levels or yearly average measure of water levels?
>>>
>>> Also below are a few more notes to throw more light on my variables/data:
>>>
>>> These wells are solely for irrigation purposes and are
>>> irrigator/farmer-owned and operated. No farmer/irrigator moves to
>>> another well not owned by him. The only reason to suspect any spatial
>>> externalities is because the wells share a common aquifer. And this is
>>> essentially what I am testing.
>>
>> Is irrigation by fixed pipe, or can the water be moved to the area of
>> another well? Can irrigators extract water from multiple wells? Is then
>> the irrigator the unit of observation rather than the well?
>>
>>>
>>> It is also understood that there are not much variation in the geography
>>> and geology of the study region.
>>>
>>> I have data a number of well specific features in addition to the water
>>> level. I also have some farm data including cropping and technology use
>>> data. No soil data though.
>>> No recharge data too as well.
>>
>> OK, the farming data may reflect the demand for water. Do the different
>> crops or technologies have different seasonal patterns, leading to
>> different draw-down patterns in the wells over time?
>>
>>>
>>> In fact, I agree a lot factors can come to play here and I may not have
>> or
>>> observe all but I was thinking I could incorporate some fixed effects
>>> to take care of those, especially for those I suspect (or perhaps by
>>> theory) are likely to not vary much in terms of their effect on
>>> irrigation(pumping) decisions across farmers
>>> or effect on water level.
>>>
>>> My panel is rather a short one: I have a five year panel data.
>>>
>>> Given the above, is it still not advisable to use any spatial econometric
>>> analysis? Just a simple OLS will suffice?
>>
>> OLS probably not, but the decisions are starting to look like farmers'
>> cropping decisions, leading to varied need for water. Do the farmers pay
>> for the water or the irrigation technology?
>>
>> I'm starting to think that maybe SUR is a possibility, but am unsure how
>> your short panel would handle that.
>>
>> Roger
>>
>>>
>>> Thanks.
>>> ----------------------
>>> Lom
>>>
>>>
>>>
>>>
>>>
>>> On Fri, Jun 5, 2020 at 3:51 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Fri, 5 Jun 2020, Lom Navanyo wrote:
>>>>
>>>>> I fully agree with you and appreciate the listed benefits of not taking
>>>>> things private. I was just trying to be sure the forum here is
>>>> appropriate
>>>>> and receptive of a beginner like me.
>>>>>
>>>>> To be more explicit with regards to my observations, y is amount of
>>>>> water withdrawal from wells and an important variable in x is (height
>>>>> of) water level in the wells. These are end of year figures. I am using
>>>>> the aggregations (sum for y and mean for water level) by band as
>> spatial
>>>>> neighborhood variables. There will be one or two indicator variables
>>>>> also in x. I hope these do not present additional hurdles.
>>>>
>>>> There are several further questions. If water level is measured at
>>>> end-of-year, it is instantaneous at that point, and will depend on
>> level a
>>>> year earlier plus inflow from the movements of the water table
>>>> (precipitation, soils and surface geology, maybe geology if deeper
>> wells),
>>>> minus evaporation (if an open well) and extraction. However, your y
>>>> (extraction) is probably measured over an interval (1 Jan - 31 Dec?). It
>>>> does not depend on level unless level is 0, but depends on the closeness
>>>> of people extracting water for domestic, agricultural or other use.
>>>>
>>>> All else equal, you would expect changes in the level in a well to
>> depend
>>>> on inputs, evaporation and extraction, and extraction at that well and
>>>> other nearby wells (which may experience falls in the ground water table
>>>> level not because the water was extracted from those wells, but at
>>>> neighbouring wells. You may also see users shifting to neerby wells if
>>>> their closest well runs dry.
>>>>
>>>> So you probably need to start with a deterministic hydrological model,
>> and
>>>> you need much more information about who extracts and why. Say in India,
>>>> you would also need price data - apparently free water has led to
>>>> over-extraction.
>>>>
>>>> So I would advise against any spatial econometric analysis of the data
>> you
>>>> have, because so much is going on in the system as a whole that you
>> cannot
>>>> control if all the data you have is as you describe. I also understand
>>>> better why well water level is endogeneous, but am sure that IV will not
>>>> help, since the level is being driven partly by a deterministic
>>>> hydrological system which differs from well to well, and extraction
>> varies
>>>> by demand.
>>>>
>>>> Has anyone worked with this kind of data? Any ideas or contributions
>> more
>>>> helpful than the above?
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> I am thinking Proximity is relevant in testing spatial
>>>>> dependency/externality.
>>>>>
>>>>> I will consider splm package  and the SLX model.
>>>>>
>>>>> Thank you.
>>>>> ---------------
>>>>> Lom
>>>>>
>>>>> On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>>>>
>>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>>>>>
>>>>>>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS
>>>> approach.
>>>>>> I
>>>>>>> have a variable I intend to use as an IV for y.
>>>>>>> I have seen a few papers use this approach. Will this approach not
>>>>>> correct
>>>>>>> for the endogeneity?
>>>>>>>
>>>>>>> Actually, I am not sure if this is a right forum or perhaps if it's
>>>>>>> appropriate or acceptable to you to take this one-on-one with you for
>>>>>> help:
>>>>>>
>>>>>> I do not offer private help. That would presuppose that one person has
>>>> the
>>>>>> answer. It would also presuppose that all exchanges are only read by
>> the
>>>>>> original poster and direct participants, while in fact others may join
>>>> in,
>>>>>> or follow a thread, or find the thread by searching: google supports
>> the
>>>>>> list:r-sig-geo search tag. If the thread goes private, that search is
>>>>>> fruitless.
>>>>>>
>>>>>>> My model actually looks like this: y= f(y, x)  + e.
>>>>>>> Aside the endogeneity of y (which I intend to instrument by another
>>>>>>> variable z), there is simultaneity between y and x.
>>>>>>> I intend to use the lag of x as instrument for x.  Given that I am
>>>>>> seeking
>>>>>>> to test spatial dependency, do you see some fatal flaws with my
>>>> approach?
>>>>>>>
>>>>>>
>>>>>> What is the support of your observations, point, or are they
>>>> aggregations?
>>>>>> Why may proximity make a difference - often, apparent spatial
>>>>>> autocorrelation is caused by observing inappropriate entities, or by
>>>>>> omitting covariates, or by using the wrong functional form.
>>>>>>
>>>>>>
>>>>>>> I have also seen other empirical approaches like static and dynamic
>>>>>> spatial
>>>>>>> panel data modelling. I will be reviewing them also to see
>> suitability
>>>>>> for
>>>>>>> my objective.
>>>>>>> But, any further directions or suggestions are highly appreciated.
>>>>>>
>>>>>> If the data are spatial panel, you can look at the splm package.
>>>>>> Personally, I have never found instruments any use at all, because the
>>>>>> instruments are typically at best weak because of shared spatial
>>>> processes
>>>>>> with the response, unless the model is really well specified from
>> known
>>>>>> theory. In space, almost everything is close to endogeneous unless the
>>>>>> opposite is demonstrated. So causal relationships are less worthwhile,
>>>>>> because they are at best conditional on omitted variables and
>>>>>> autocorrelation engendered by the choice of observational entities.
>>>>>>
>>>>>> Further, because spatial processes are driven by the inverse matrix of
>>>> the
>>>>>> input graph of proximate neighbours (the covariance matrix of the
>>>> spatial
>>>>>> process), you don't need to start from more than the first order
>>>>>> neighbours. Maybe your x has the same spatial pattern as y, so that
>> the
>>>>>> residuals are white noise with no spatial structure.
>>>>>>
>>>>>> Recently, analysts prefer to start with the SLX model (Halleck Vega &
>>>>>> Elhorst 2015 and others), so that might be worth exploring. If only
>> the
>>>>>> direct impacts seem important, OLS may be enough.
>>>>>>
>>>>>> Hope this helps,
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>> -------------------
>>>>>>> Lom
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>> wrote:
>>>>>>>
>>>>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
>>>>>>>>
>>>>>>>>> Thank you very much for your support. This gives me what I need
>> and I
>>>>>>>> must
>>>>>>>>> say listw2sn() is really great.
>>>>>>>>>
>>>>>>>>> Why do I need the data in the format as in dataout? I am trying to
>>>> test
>>>>>>>>> spatial dependence (or neighborhood effect) by running a regression
>>>>>>>>> model that entails pop_size_it = beta_1*sum of pop_size of point
>> i's
>>>>>>>>> neighbors within a specified radius. So my plan is to get the
>>>> neighbors
>>>>>>>>> for each focal point as per the specified bands and their
>> attributes
>>>>>> (eg
>>>>>>>>> pop_size) so I can can add them (attribute) by the bands.
>>>>>>>>
>>>>>>>> Thanks, clarifies a good deal. Maybe look at the original localG
>>>>>> articles
>>>>>>>> for exploring distance relationships (Getis and Ord looked at
>>>> HIV/AIDS);
>>>>>>>> ?spdep::localG or
>>>>>> https://r-spatial.github.io/spdep/reference/localG.html.
>>>>>>>>
>>>>>>>> Further note at OLS is biased as you have y = f(y) + e, so y on both
>>>>>>>> sides. The nearest equivalent for a single band is
>>>>>> spatialreg::lagsarlm()
>>>>>>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums
>> through
>>>>>> the
>>>>>>>> weights matrix. So both your betas and their standard errors are
>>>>>> unusable,
>>>>>>>> I'm afraid. You are actually very much closer to ordinary kriging,
>>>>>> looking
>>>>>>>> at the way in which distance attenuates the correlation in value of
>>>>>>>> proximate observations.
>>>>>>>>
>>>>>>>> Hope this clarifies,
>>>>>>>>
>>>>>>>> Roger
>>>>>>>>
>>>>>>>>>
>>>>>>>>> I am totally new to the area of spatial econometrics, so I am
>> taking
>>>>>>>> things
>>>>>>>>> one step at a time. Some readings suggest I may need distance
>> matrix
>>>> or
>>>>>>>>> weight matrix but for now I think I should try the current
>> approach.
>>>>>>>>>
>>>>>>>>> Thank you.
>>>>>>>>>
>>>>>>>>> -------------
>>>>>>>>> Lom
>>>>>>>>>
>>>>>>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no>
>>>>>> wrote:
>>>>>>>>>
>>>>>>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
>>>>>>>>>>
>>>>>>>>>>> I had the errors with rtree using R 3.6.3. I have since changed
>> to
>>>> R
>>>>>>>>>> 4.0.0
>>>>>>>>>>> but I got the same error.
>>>>>>>>>>>
>>>>>>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4,
>> all
>>>>>>>> with
>>>>>>>>>>> length 101. I think my difficulty is my inability to output the
>>>> list
>>>>>>>>>>> detailing the point IDs t50_fid.
>>>>>>>>>>
>>>>>>>>>> library(spData)
>>>>>>>>>> library(sf)
>>>>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>>>>> pts <- st_coordinates(projdata)
>>>>>>>>>> library(spdep)
>>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>>>>> bds <- c(0, bufferR)
>>>>>>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
>>>>>>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
>>>>>>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
>>>>>>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
>>>>>>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
>>>>>>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
>>>>>>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
>>>>>>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
>>>>>>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
>>>>>>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
>>>>>>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
>>>>>>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
>>>>>>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
>>>>>>>> sn_band4))
>>>>>>>>>> class(data_out) <- "data.frame"
>>>>>>>>>> table(data_out$band)
>>>>>>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
>>>>>>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
>>>>>>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
>>>>>>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
>>>>>>>>>> str(data_out)
>>>>>>>>>>
>>>>>>>>>> The "spatial.neighbour" representation was that used in the S-Plus
>>>>>>>>>> SpatialStats module, with "from" and "to" columns, and here drops
>>>>>>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
>>>>>>>>>> for creating the output, and from there, just look-up in the
>>>>>>>>>> input data.frame. Observations here cannot be their own
>> neighbours.
>>>>>>>>>>
>>>>>>>>>> It would be relevant to know why you need these, are you looking
>> at
>>>>>>>>>> variogram clouds?
>>>>>>>>>>
>>>>>>>>>> Hope this clarifies,
>>>>>>>>>>
>>>>>>>>>> Roger
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> ---------
>>>>>>>>>>> Lom
>>>>>>>>>>>
>>>>>>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <kent3737 at gmail.com>
>>>>>>>> wrote:
>>>>>>>>>>>
>>>>>>>>>>>> Roger's example works for me and gives a list of length 101. I
>> did
>>>>>>>> have
>>>>>>>>>>>> some issues that were resolved by updating packages. I'm using R
>>>>>> 3.6.3
>>>>>>>>>> on
>>>>>>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10 with
>> R
>>>>>>>> 3.6.3.
>>>>>>>>>>>>
>>>>>>>>>>>> Kent
>>>>>>>>>>>>
>>>>>>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <
>> Roger.Bivand at nhh.no
>>>>>
>>>>>>>>>> wrote:
>>>>>>>>>>>>
>>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>>>>>
>>>>>>>>>>>>>> rtree uses Euclidean distance so the points should be in a
>>>>>>>> coordinate
>>>>>>>>>>>>>> system where this makes sense at least as a reasonable
>>>>>>>> approximation.
>>>>>>>>>>>>>
>>>>>>>>>>>>> I tried the original example:
>>>>>>>>>>>>>
>>>>>>>>>>>>> remotes::install_github("hunzikp/rtree")
>>>>>>>>>>>>> library(spData)
>>>>>>>>>>>>> library(sf)
>>>>>>>>>>>>> projdata<-st_transform(nz_height, 32759)
>>>>>>>>>>>>> library(rtree)
>>>>>>>>>>>>> pts <- st_coordinates(projdata)
>>>>>>>>>>>>> rt <- RTree(st_coordinates(projdata))
>>>>>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
>>>>>>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
>>>>>>>>>>>>>
>>>>>>>>>>>>> but unfortunately failed (maybe newer Boost headers than
>> yours?):
>>>>>>>>>>>>>
>>>>>>>>>>>>> Error in UseMethod("withinDistance", rTree) :
>>>>>>>>>>>>>    no applicable method for 'withinDistance' applied to an
>> object
>>>>>> of
>>>>>>>>>>>>> class
>>>>>>>>>>>>> "c('list', 'RTree')"
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Kent
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <
>>>> Roger.Bivand at nhh.no>
>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
>>>>>>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
>>>>>>>>>>>>>>>>> To: r-sig-geo at r-project.org
>>>>>>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
>>>>>>>>>> neighboring
>>>>>>>>>>>>>>>>>         points within specified radii (distances) for each
>>>>>> point
>>>>>>>>>> in a
>>>>>>>>>>>>>>> given
>>>>>>>>>>>>>>>>>         points data set.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>>>>>> I have data set of about 3400 location points with which I
>> am
>>>>>>>>>> trying
>>>>>>>>>>>>> to
>>>>>>>>>>>>>>>>> generate data of each point and their neighbors within
>>>> defined
>>>>>>>>>> radii
>>>>>>>>>>>>>>> (eg,
>>>>>>>>>>>>>>>>> 0.25, 1, and 3 miles).
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> The rtree package is very fast and memory-efficient for
>>>>>>>>>>>>> within-distance
>>>>>>>>>>>>>>>> calculations.
>>>>>>>>>>>>>>>> https://github.com/hunzikp/rtree
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thanks! Does this also apply when the input points are in
>>>>>>>>>> geographical
>>>>>>>>>>>>>>> coordinates?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Roger
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Kent Johnson
>>>>>>>>>>>>>>>> Cambridge, MA
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>>>> R-sig-Geo mailing list
>>>>>>>>>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> --
>>>>>>>>>>>>>>> Roger Bivand
>>>>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> --
>>>>>>>>>>>>> Roger Bivand
>>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> --
>>>>>>>>>> Roger Bivand
>>>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> --
>>>>>>>> Roger Bivand
>>>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>> https://orcid.org/0000-0003-2392-6140
>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From m|807 @end|ng |rom c@m@@c@uk  Tue Jun  9 15:01:05 2020
From: m|807 @end|ng |rom c@m@@c@uk (Matt Lewis)
Date: Tue, 09 Jun 2020 14:01:05 +0100
Subject: [R-sig-Geo] maptools::as.im.RasterLayer with factor layers
Message-ID: <f43b64555ea137c3ccae170e10b31519@cam.ac.uk>

Dear all, 

Not so much a question as a bit of adapted code. 

Recently, I've been working with the spatstat package and using maptools
to convert raster objects to spatstat's im format. One issue I have been
having is the conversion of factor raster layers to im. To that end,
I've adapted the maptools::as.im.RasterLayer() function to work with
factor layers. 

I realise that quite possibly this is a problem that has an alternative
solution that I'm unaware of, but in case my adapted function is useful
to others or something which you would like to include in the next
release of maptools, I have attached it here. 

Thanks for your work with maptools, and with all best wishes, 

Matt 

This email was originally sent to Roger Bivand who directed me to this
list.

-- 
Matt Lewis (he/him)
MPhil Student

Insect Ecology Group
Department of Zoology
University of Cambridge
CB2 3EJ

ml807 at cam.ac.uk | matthewlewis896 at gmail.com
@matthewlewis896
https://www.zoo.cam.ac.uk/directory/matthew-lewis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200609/b8707026/attachment.html>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: as.im.RasterLayer.R
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200609/b8707026/attachment.ksh>

From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  9 15:36:22 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 9 Jun 2020 15:36:22 +0200
Subject: [R-sig-Geo] rgdal 1.5-10 published on CRAN
Message-ID: <alpine.LFD.2.22.394.2006091532320.1939340@reclus.nhh.no>

rgdal 1.5-10 published on CRAN - thanks to the CRAN team for a quick 
release. Almost the same as RC 1.5-9, unlinked http://www.epsg.org because 
many find the link blocked in browsers for security reasons. This updates 
1.5-8 to accommodate requests to permit GDAL < 3 with PROJ >= 6 (with 
configure argument --with-proj_api="proj_api.h"), and many other configure 
tweaks.

Enjoy!

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From eg@mp@du @end|ng |rom gm@||@com  Tue Jun  9 16:06:15 2020
From: eg@mp@du @end|ng |rom gm@||@com (Enoch Gyamfi Ampadu)
Date: Tue, 9 Jun 2020 16:06:15 +0200
Subject: [R-sig-Geo] Coding and addition of explanatory variables
Message-ID: <CAC4+n+wLfqYCqBwRmZYoEeV=8z80pfum8g0cEyj4aiiB=t7oxQ@mail.gmail.com>

Dear List,

Please I am doing a biomass analysis with a satellite image. The
explanatory variables include the satellite bands and vegetation indices. I
am using Random forest regression. I have added bands of the satellite
image to the model and it worked. However, when I tried to add the
vegetation indices (bands) I get error messages. I have put the codes I am
using below;

Model <- randomForest(class~ B1 + B2 + B3 + B4 + B5 + B6 + B7 + B8 + B9 +
B10 + B11 + B12 + DVI1, data = Trainingset, proximity=TRUE,
                            importance=TRUE).
The "DVI1" is the vegetation index variable band I tried to add to the
model.

Below is the error message I received.

"Error in eval(predvars, data, env) : object 'DVI1' not found"

   I will be glad if I could get some assistance on how to resolve it.

Best regards,

Enoch

-- 
*Enoch Gyamfi - Ampadu*

*Geography & Environmental Sciences*

*College of Agriculture, Engineering & Science*

*University of KwaZulu-Natal, Westville Campus*

*Private Bag X54001*
*Durban, South Africa **? 4000**.*
*Phone: +27 835 828255*

*email: egampadu at gmail.com <egampadu at gmail.com>*


*skype: enoch.ampadu*
*The highest evidence of nobility is self-control*.

*A simple act of kindness creates an endless ripple*.

	[[alternative HTML version deleted]]


From ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@  Tue Jun  9 16:09:13 2020
From: ju||@n@burgo@ @end|ng |rom h@|ogv@tn@|@ (Julian Burgos)
Date: Tue, 9 Jun 2020 14:09:13 +0000
Subject: [R-sig-Geo] Coding and addition of explanatory variables
In-Reply-To: <CAC4+n+wLfqYCqBwRmZYoEeV=8z80pfum8g0cEyj4aiiB=t7oxQ@mail.gmail.com>
References: <CAC4+n+wLfqYCqBwRmZYoEeV=8z80pfum8g0cEyj4aiiB=t7oxQ@mail.gmail.com>
Message-ID: <VI1PR0102MB3344CC47AEA6AA08626ACAF281820@VI1PR0102MB3344.eurprd01.prod.exchangelabs.com>

Very hard to say without a reproducible example.  But perhaps "DVI1" is not in your "Trainingset" dataframe?


________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Enoch Gyamfi Ampadu <egampadu at gmail.com>
Sent: Tuesday, June 9, 2020 14:06
To: Help R-Sig_Geo <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] Coding and addition of explanatory variables

Dear List,

Please I am doing a biomass analysis with a satellite image. The
explanatory variables include the satellite bands and vegetation indices. I
am using Random forest regression. I have added bands of the satellite
image to the model and it worked. However, when I tried to add the
vegetation indices (bands) I get error messages. I have put the codes I am
using below;

Model <- randomForest(class~ B1 + B2 + B3 + B4 + B5 + B6 + B7 + B8 + B9 +
B10 + B11 + B12 + DVI1, data = Trainingset, proximity=TRUE,
                            importance=TRUE).
The "DVI1" is the vegetation index variable band I tried to add to the
model.

Below is the error message I received.

"Error in eval(predvars, data, env) : object 'DVI1' not found"

   I will be glad if I could get some assistance on how to resolve it.

Best regards,

Enoch

--
*Enoch Gyamfi - Ampadu*

*Geography & Environmental Sciences*

*College of Agriculture, Engineering & Science*

*University of KwaZulu-Natal, Westville Campus*

*Private Bag X54001*
*Durban, South Africa **? 4000**.*
*Phone: +27 835 828255*

*email: egampadu at gmail.com <egampadu at gmail.com>*


*skype: enoch.ampadu*
*The highest evidence of nobility is self-control*.

*A simple act of kindness creates an endless ripple*.

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7C%7C040a519515414dcf4ff508d80c7e6133%7C8e105b94435e4303a61063620dbe162b%7C0%7C0%7C637273084221502390&amp;sdata=yL%2BLWXZWZ0EaUNEXxLXpWnkkOgKeMriuuuJR47MUIhI%3D&amp;reserved=0

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  9 16:28:33 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 9 Jun 2020 16:28:33 +0200
Subject: [R-sig-Geo] Coding and addition of explanatory variables
In-Reply-To: <VI1PR0102MB3344CC47AEA6AA08626ACAF281820@VI1PR0102MB3344.eurprd01.prod.exchangelabs.com>
References: <CAC4+n+wLfqYCqBwRmZYoEeV=8z80pfum8g0cEyj4aiiB=t7oxQ@mail.gmail.com>
 <VI1PR0102MB3344CC47AEA6AA08626ACAF281820@VI1PR0102MB3344.eurprd01.prod.exchangelabs.com>
Message-ID: <alpine.LFD.2.22.394.2006091624470.1940153@reclus.nhh.no>

On Tue, 9 Jun 2020, Julian Burgos wrote:

> Very hard to say without a reproducible example.  But perhaps "DVI1" is 
> not in your "Trainingset" dataframe?

Thanks, here is a code example:

library(randomForest)
data(airquality)
set.seed(131)
ozone.rf1 <- randomForest(Ozone ~ Solar.R + Wind + Temp + Month + Day, 
data=airquality, proximity=TRUE, importance=TRUE, na.action=na.omit)
print(ozone.rf1)
set.seed(131)
ozone.rf2 <- randomForest(Ozone ~ Solar.R + Wind + Temp + Month + day, 
data=airquality, proximity=TRUE, importance=TRUE, na.action=na.omit)
# Error in eval(predvars, data, env) : object 'day' not found

Concise code examples always help to tease out problems,

Roger


>
>
> ________________________________
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Enoch Gyamfi Ampadu <egampadu at gmail.com>
> Sent: Tuesday, June 9, 2020 14:06
> To: Help R-Sig_Geo <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Coding and addition of explanatory variables
>
> Dear List,
>
> Please I am doing a biomass analysis with a satellite image. The
> explanatory variables include the satellite bands and vegetation indices. I
> am using Random forest regression. I have added bands of the satellite
> image to the model and it worked. However, when I tried to add the
> vegetation indices (bands) I get error messages. I have put the codes I am
> using below;
>
> Model <- randomForest(class~ B1 + B2 + B3 + B4 + B5 + B6 + B7 + B8 + B9 +
> B10 + B11 + B12 + DVI1, data = Trainingset, proximity=TRUE,
>                            importance=TRUE).
> The "DVI1" is the vegetation index variable band I tried to add to the
> model.
>
> Below is the error message I received.
>
> "Error in eval(predvars, data, env) : object 'DVI1' not found"
>
>   I will be glad if I could get some assistance on how to resolve it.
>
> Best regards,
>
> Enoch
>
> --
> *Enoch Gyamfi - Ampadu*
>
> *Geography & Environmental Sciences*
>
> *College of Agriculture, Engineering & Science*
>
> *University of KwaZulu-Natal, Westville Campus*
>
> *Private Bag X54001*
> *Durban, South Africa **? 4000**.*
> *Phone: +27 835 828255*
>
> *email: egampadu at gmail.com <egampadu at gmail.com>*
>
>
> *skype: enoch.ampadu*
> *The highest evidence of nobility is self-control*.
>
> *A simple act of kindness creates an endless ripple*.
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7C%7C040a519515414dcf4ff508d80c7e6133%7C8e105b94435e4303a61063620dbe162b%7C0%7C0%7C637273084221502390&amp;sdata=yL%2BLWXZWZ0EaUNEXxLXpWnkkOgKeMriuuuJR47MUIhI%3D&amp;reserved=0
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From |omn@v@@|@ @end|ng |rom gm@||@com  Tue Jun  9 22:26:10 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Tue, 9 Jun 2020 15:26:10 -0500
Subject: [R-sig-Geo] 
 How to efficiently generate data of neighboring points
In-Reply-To: <alpine.LFD.2.22.394.2006091224470.1930273@reclus.nhh.no>
References: <mailman.28148.5.1591092002.10938.r-sig-geo@r-project.org>
 <CAPP0wyjAkD+NVGxtBfxacyY=mCDym8vWnaAq1TX89+b11u5EQg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006021811480.5920@reclus.nhh.no>
 <CAPP0wyiDYDz2hzoHLP17JoKv+wg9wFGSXtOjDDGkMfza8-8w9w@mail.gmail.com>
 <CAKBoCbGnkycTn-SWYkSWEEvMDNqXjtHfMw_D-Vhg3U2oK1rZKg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006031512020.20766@reclus.nhh.no>
 <CAKBoCbEnc5DKofAANL-kax=TLh9dvaMiKWtQ4LBQAjwbsDPDtg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006041038390.41141@reclus.nhh.no>
 <CAKBoCbHVbOo8Fmm2u52Q9aJDdrv2QWj7_JdPt6XNLauUp4BJKw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006042130550.50210@reclus.nhh.no>
 <CAKBoCbGsoQXHF-yoJNA=T=aqu0oNJJf41FOOXDi3HhLBUFJ_dQ@mail.gmail.com>
 <alpine.LFD.2.22.394.2006051032210.62065@reclus.nhh.no>
 <CAKBoCbG9ma1i+okXykJif6kLC3p=oyKSqZSCdbL2AEYmYE8znA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006071200170.997990@reclus.nhh.no>
 <CAKBoCbEUKKQedieZhgZKqiXYXtFFJWnpOVEG6Kofuh5m=PHqYw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006091224470.1930273@reclus.nhh.no>
Message-ID: <CAKBoCbH8zQX30RtjeZzTz0jB-hkJWu8diSA8+s7yiGT_ziGvTg@mail.gmail.com>

Thank you very much. I will try as much as I can to see which model best
fits the data.

I have about 3400 wells and about 1500 irrigators.

--------
Lom

On Tue, Jun 9, 2020 at 5:36 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Mon, 8 Jun 2020, Lom Navanyo wrote:
>
> > Some farmers own more than one well and thus can extract from their
> > multiple wells. Others are single well owners.
> >
> > The amount of water pumped by the irrigator from their wells is the unit
> of
> > observation. And I do not know how it might sound but
> > I would say "irrigator-well" is the unit of analysis?
> >
> > Both crops and technology have seasonal patterns, though not pronounced
> > probably due to switching costs.
> >
> > I have two segments of the data: A section or a group of neighboring
> > irrigators pay fees for water withdrawal. The second group (of
> > neighbors) does not pay any fee aside their individual lift cost (which
> > is not observed in the data). I do not intend to run a
> > difference-in-difference model with respect to the fee as that's not
> > what I want to study. So I intend to run separate models/specifications
> > for the two groups.
>
> This feels like a linear mixed effects model with an irrigator random
> effect and a temporal random effect. A spatial random effect (ICAR?) might
> be added, but it will be hard to split the identification of the irrigator
> RE from a spatially structured RE for the wells. I think that you should
> be looking at the mgcv package, the second edition of Simon Wood's book,
> and either an MRF or a Gaussian Process ("gp") spatial RE for the wells.
>
> It may very well be that a group RE (fee/no fee) would discriminate
> between the groups statistically, but I'm out of my depth here. Anyway,
> mgcv, using a flexible functional form on water level, and RE's for the
> other components, seems possible. Structural regression using BayesX or
> INLA are also possible. You have 5 years, how many irrigators and how many
> wells?
>
> Roger
>
> >
> > Thanks,
> > -----------------
> > Lom
> >
> > On Sun, Jun 7, 2020 at 5:06 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Fri, 5 Jun 2020, Lom Navanyo wrote:
> >>
> >>> Thank you once again. To clarify, which is more suitable, end of year
> >> water
> >>> levels or yearly average measure of water levels?
> >>>
> >>> Also below are a few more notes to throw more light on my
> variables/data:
> >>>
> >>> These wells are solely for irrigation purposes and are
> >>> irrigator/farmer-owned and operated. No farmer/irrigator moves to
> >>> another well not owned by him. The only reason to suspect any spatial
> >>> externalities is because the wells share a common aquifer. And this is
> >>> essentially what I am testing.
> >>
> >> Is irrigation by fixed pipe, or can the water be moved to the area of
> >> another well? Can irrigators extract water from multiple wells? Is then
> >> the irrigator the unit of observation rather than the well?
> >>
> >>>
> >>> It is also understood that there are not much variation in the
> geography
> >>> and geology of the study region.
> >>>
> >>> I have data a number of well specific features in addition to the water
> >>> level. I also have some farm data including cropping and technology use
> >>> data. No soil data though.
> >>> No recharge data too as well.
> >>
> >> OK, the farming data may reflect the demand for water. Do the different
> >> crops or technologies have different seasonal patterns, leading to
> >> different draw-down patterns in the wells over time?
> >>
> >>>
> >>> In fact, I agree a lot factors can come to play here and I may not have
> >> or
> >>> observe all but I was thinking I could incorporate some fixed effects
> >>> to take care of those, especially for those I suspect (or perhaps by
> >>> theory) are likely to not vary much in terms of their effect on
> >>> irrigation(pumping) decisions across farmers
> >>> or effect on water level.
> >>>
> >>> My panel is rather a short one: I have a five year panel data.
> >>>
> >>> Given the above, is it still not advisable to use any spatial
> econometric
> >>> analysis? Just a simple OLS will suffice?
> >>
> >> OLS probably not, but the decisions are starting to look like farmers'
> >> cropping decisions, leading to varied need for water. Do the farmers pay
> >> for the water or the irrigation technology?
> >>
> >> I'm starting to think that maybe SUR is a possibility, but am unsure how
> >> your short panel would handle that.
> >>
> >> Roger
> >>
> >>>
> >>> Thanks.
> >>> ----------------------
> >>> Lom
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> On Fri, Jun 5, 2020 at 3:51 AM Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >>>
> >>>> On Fri, 5 Jun 2020, Lom Navanyo wrote:
> >>>>
> >>>>> I fully agree with you and appreciate the listed benefits of not
> taking
> >>>>> things private. I was just trying to be sure the forum here is
> >>>> appropriate
> >>>>> and receptive of a beginner like me.
> >>>>>
> >>>>> To be more explicit with regards to my observations, y is amount of
> >>>>> water withdrawal from wells and an important variable in x is (height
> >>>>> of) water level in the wells. These are end of year figures. I am
> using
> >>>>> the aggregations (sum for y and mean for water level) by band as
> >> spatial
> >>>>> neighborhood variables. There will be one or two indicator variables
> >>>>> also in x. I hope these do not present additional hurdles.
> >>>>
> >>>> There are several further questions. If water level is measured at
> >>>> end-of-year, it is instantaneous at that point, and will depend on
> >> level a
> >>>> year earlier plus inflow from the movements of the water table
> >>>> (precipitation, soils and surface geology, maybe geology if deeper
> >> wells),
> >>>> minus evaporation (if an open well) and extraction. However, your y
> >>>> (extraction) is probably measured over an interval (1 Jan - 31 Dec?).
> It
> >>>> does not depend on level unless level is 0, but depends on the
> closeness
> >>>> of people extracting water for domestic, agricultural or other use.
> >>>>
> >>>> All else equal, you would expect changes in the level in a well to
> >> depend
> >>>> on inputs, evaporation and extraction, and extraction at that well and
> >>>> other nearby wells (which may experience falls in the ground water
> table
> >>>> level not because the water was extracted from those wells, but at
> >>>> neighbouring wells. You may also see users shifting to neerby wells if
> >>>> their closest well runs dry.
> >>>>
> >>>> So you probably need to start with a deterministic hydrological model,
> >> and
> >>>> you need much more information about who extracts and why. Say in
> India,
> >>>> you would also need price data - apparently free water has led to
> >>>> over-extraction.
> >>>>
> >>>> So I would advise against any spatial econometric analysis of the data
> >> you
> >>>> have, because so much is going on in the system as a whole that you
> >> cannot
> >>>> control if all the data you have is as you describe. I also understand
> >>>> better why well water level is endogeneous, but am sure that IV will
> not
> >>>> help, since the level is being driven partly by a deterministic
> >>>> hydrological system which differs from well to well, and extraction
> >> varies
> >>>> by demand.
> >>>>
> >>>> Has anyone worked with this kind of data? Any ideas or contributions
> >> more
> >>>> helpful than the above?
> >>>>
> >>>> Roger
> >>>>
> >>>>>
> >>>>> I am thinking Proximity is relevant in testing spatial
> >>>>> dependency/externality.
> >>>>>
> >>>>> I will consider splm package  and the SLX model.
> >>>>>
> >>>>> Thank you.
> >>>>> ---------------
> >>>>> Lom
> >>>>>
> >>>>> On Thu, Jun 4, 2020 at 2:52 PM Roger Bivand <Roger.Bivand at nhh.no>
> >> wrote:
> >>>>>
> >>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>>>>>
> >>>>>>> Thank you. Yes, the OLS is biased and my plan is to use a 2SLS
> >>>> approach.
> >>>>>> I
> >>>>>>> have a variable I intend to use as an IV for y.
> >>>>>>> I have seen a few papers use this approach. Will this approach not
> >>>>>> correct
> >>>>>>> for the endogeneity?
> >>>>>>>
> >>>>>>> Actually, I am not sure if this is a right forum or perhaps if it's
> >>>>>>> appropriate or acceptable to you to take this one-on-one with you
> for
> >>>>>> help:
> >>>>>>
> >>>>>> I do not offer private help. That would presuppose that one person
> has
> >>>> the
> >>>>>> answer. It would also presuppose that all exchanges are only read by
> >> the
> >>>>>> original poster and direct participants, while in fact others may
> join
> >>>> in,
> >>>>>> or follow a thread, or find the thread by searching: google supports
> >> the
> >>>>>> list:r-sig-geo search tag. If the thread goes private, that search
> is
> >>>>>> fruitless.
> >>>>>>
> >>>>>>> My model actually looks like this: y= f(y, x)  + e.
> >>>>>>> Aside the endogeneity of y (which I intend to instrument by another
> >>>>>>> variable z), there is simultaneity between y and x.
> >>>>>>> I intend to use the lag of x as instrument for x.  Given that I am
> >>>>>> seeking
> >>>>>>> to test spatial dependency, do you see some fatal flaws with my
> >>>> approach?
> >>>>>>>
> >>>>>>
> >>>>>> What is the support of your observations, point, or are they
> >>>> aggregations?
> >>>>>> Why may proximity make a difference - often, apparent spatial
> >>>>>> autocorrelation is caused by observing inappropriate entities, or by
> >>>>>> omitting covariates, or by using the wrong functional form.
> >>>>>>
> >>>>>>
> >>>>>>> I have also seen other empirical approaches like static and dynamic
> >>>>>> spatial
> >>>>>>> panel data modelling. I will be reviewing them also to see
> >> suitability
> >>>>>> for
> >>>>>>> my objective.
> >>>>>>> But, any further directions or suggestions are highly appreciated.
> >>>>>>
> >>>>>> If the data are spatial panel, you can look at the splm package.
> >>>>>> Personally, I have never found instruments any use at all, because
> the
> >>>>>> instruments are typically at best weak because of shared spatial
> >>>> processes
> >>>>>> with the response, unless the model is really well specified from
> >> known
> >>>>>> theory. In space, almost everything is close to endogeneous unless
> the
> >>>>>> opposite is demonstrated. So causal relationships are less
> worthwhile,
> >>>>>> because they are at best conditional on omitted variables and
> >>>>>> autocorrelation engendered by the choice of observational entities.
> >>>>>>
> >>>>>> Further, because spatial processes are driven by the inverse matrix
> of
> >>>> the
> >>>>>> input graph of proximate neighbours (the covariance matrix of the
> >>>> spatial
> >>>>>> process), you don't need to start from more than the first order
> >>>>>> neighbours. Maybe your x has the same spatial pattern as y, so that
> >> the
> >>>>>> residuals are white noise with no spatial structure.
> >>>>>>
> >>>>>> Recently, analysts prefer to start with the SLX model (Halleck Vega
> &
> >>>>>> Elhorst 2015 and others), so that might be worth exploring. If only
> >> the
> >>>>>> direct impacts seem important, OLS may be enough.
> >>>>>>
> >>>>>> Hope this helps,
> >>>>>>
> >>>>>> Roger
> >>>>>>
> >>>>>>>
> >>>>>>> Thanks,
> >>>>>>> -------------------
> >>>>>>> Lom
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Jun 4, 2020 at 3:48 AM Roger Bivand <Roger.Bivand at nhh.no>
> >>>> wrote:
> >>>>>>>
> >>>>>>>> On Thu, 4 Jun 2020, Lom Navanyo wrote:
> >>>>>>>>
> >>>>>>>>> Thank you very much for your support. This gives me what I need
> >> and I
> >>>>>>>> must
> >>>>>>>>> say listw2sn() is really great.
> >>>>>>>>>
> >>>>>>>>> Why do I need the data in the format as in dataout? I am trying
> to
> >>>> test
> >>>>>>>>> spatial dependence (or neighborhood effect) by running a
> regression
> >>>>>>>>> model that entails pop_size_it = beta_1*sum of pop_size of point
> >> i's
> >>>>>>>>> neighbors within a specified radius. So my plan is to get the
> >>>> neighbors
> >>>>>>>>> for each focal point as per the specified bands and their
> >> attributes
> >>>>>> (eg
> >>>>>>>>> pop_size) so I can can add them (attribute) by the bands.
> >>>>>>>>
> >>>>>>>> Thanks, clarifies a good deal. Maybe look at the original localG
> >>>>>> articles
> >>>>>>>> for exploring distance relationships (Getis and Ord looked at
> >>>> HIV/AIDS);
> >>>>>>>> ?spdep::localG or
> >>>>>> https://r-spatial.github.io/spdep/reference/localG.html.
> >>>>>>>>
> >>>>>>>> Further note at OLS is biased as you have y = f(y) + e, so y on
> both
> >>>>>>>> sides. The nearest equivalent for a single band is
> >>>>>> spatialreg::lagsarlm()
> >>>>>>>> with listw=nb2listw(wd1, style="B") to get the neighbour sums
> >> through
> >>>>>> the
> >>>>>>>> weights matrix. So both your betas and their standard errors are
> >>>>>> unusable,
> >>>>>>>> I'm afraid. You are actually very much closer to ordinary kriging,
> >>>>>> looking
> >>>>>>>> at the way in which distance attenuates the correlation in value
> of
> >>>>>>>> proximate observations.
> >>>>>>>>
> >>>>>>>> Hope this clarifies,
> >>>>>>>>
> >>>>>>>> Roger
> >>>>>>>>
> >>>>>>>>>
> >>>>>>>>> I am totally new to the area of spatial econometrics, so I am
> >> taking
> >>>>>>>> things
> >>>>>>>>> one step at a time. Some readings suggest I may need distance
> >> matrix
> >>>> or
> >>>>>>>>> weight matrix but for now I think I should try the current
> >> approach.
> >>>>>>>>>
> >>>>>>>>> Thank you.
> >>>>>>>>>
> >>>>>>>>> -------------
> >>>>>>>>> Lom
> >>>>>>>>>
> >>>>>>>>> On Wed, Jun 3, 2020 at 8:18 AM Roger Bivand <Roger.Bivand at nhh.no
> >
> >>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> On Wed, 3 Jun 2020, Lom Navanyo wrote:
> >>>>>>>>>>
> >>>>>>>>>>> I had the errors with rtree using R 3.6.3. I have since changed
> >> to
> >>>> R
> >>>>>>>>>> 4.0.0
> >>>>>>>>>>> but I got the same error.
> >>>>>>>>>>>
> >>>>>>>>>>> And  yes, for Roger's example, I have the objects wd1, ... wd4,
> >> all
> >>>>>>>> with
> >>>>>>>>>>> length 101. I think my difficulty is my inability to output the
> >>>> list
> >>>>>>>>>>> detailing the point IDs t50_fid.
> >>>>>>>>>>
> >>>>>>>>>> library(spData)
> >>>>>>>>>> library(sf)
> >>>>>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>>>>> pts <- st_coordinates(projdata)
> >>>>>>>>>> library(spdep)
> >>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>>>>> bds <- c(0, bufferR)
> >>>>>>>>>> wd1 <- dnearneigh(pts, bds[1], bds[2])
> >>>>>>>>>> wd2 <- dnearneigh(pts, bds[2], bds[3])
> >>>>>>>>>> wd3 <- dnearneigh(pts, bds[3], bds[4])
> >>>>>>>>>> wd4 <- dnearneigh(pts, bds[4], bds[5])
> >>>>>>>>>> sn_band1 <- listw2sn(nb2listw(wd1, style="B", zero.policy=TRUE))
> >>>>>>>>>> sn_band1$band <- paste(attr(wd1, "distances"), collapse="-")
> >>>>>>>>>> sn_band2 <- listw2sn(nb2listw(wd2, style="B", zero.policy=TRUE))
> >>>>>>>>>> sn_band2$band <- paste(attr(wd2, "distances"), collapse="-")
> >>>>>>>>>> sn_band3 <- listw2sn(nb2listw(wd3, style="B", zero.policy=TRUE))
> >>>>>>>>>> sn_band3$band <- paste(attr(wd3, "distances"), collapse="-")
> >>>>>>>>>> sn_band4 <- listw2sn(nb2listw(wd4, style="B", zero.policy=TRUE))
> >>>>>>>>>> sn_band4$band <- paste(attr(wd4, "distances"), collapse="-")
> >>>>>>>>>> data_out <- do.call("rbind", list(sn_band1, sn_band2, sn_band3,
> >>>>>>>> sn_band4))
> >>>>>>>>>> class(data_out) <- "data.frame"
> >>>>>>>>>> table(data_out$band)
> >>>>>>>>>> data_out$ID_from <- projdata$t50_fid[data_out$from]
> >>>>>>>>>> data_out$ID_to <- projdata$t50_fid[data_out$to]
> >>>>>>>>>> data_out$elev_from <- projdata$elevation[data_out$from]
> >>>>>>>>>> data_out$elev_to <- projdata$elevation[data_out$to]
> >>>>>>>>>> str(data_out)
> >>>>>>>>>>
> >>>>>>>>>> The "spatial.neighbour" representation was that used in the
> S-Plus
> >>>>>>>>>> SpatialStats module, with "from" and "to" columns, and here
> drops
> >>>>>>>>>> no-neighbour cases gracefully. So listw2sn() comes in useful
> >>>>>>>>>> for creating the output, and from there, just look-up in the
> >>>>>>>>>> input data.frame. Observations here cannot be their own
> >> neighbours.
> >>>>>>>>>>
> >>>>>>>>>> It would be relevant to know why you need these, are you looking
> >> at
> >>>>>>>>>> variogram clouds?
> >>>>>>>>>>
> >>>>>>>>>> Hope this clarifies,
> >>>>>>>>>>
> >>>>>>>>>> Roger
> >>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> ---------
> >>>>>>>>>>> Lom
> >>>>>>>>>>>
> >>>>>>>>>>> On Tue, Jun 2, 2020 at 8:02 PM Kent Johnson <
> kent3737 at gmail.com>
> >>>>>>>> wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>> Roger's example works for me and gives a list of length 101. I
> >> did
> >>>>>>>> have
> >>>>>>>>>>>> some issues that were resolved by updating packages. I'm
> using R
> >>>>>> 3.6.3
> >>>>>>>>>> on
> >>>>>>>>>>>> macOS 10.15.4. I also use rtree successfully on Windows 10
> with
> >> R
> >>>>>>>> 3.6.3.
> >>>>>>>>>>>>
> >>>>>>>>>>>> Kent
> >>>>>>>>>>>>
> >>>>>>>>>>>> On Tue, Jun 2, 2020 at 12:29 PM Roger Bivand <
> >> Roger.Bivand at nhh.no
> >>>>>
> >>>>>>>>>> wrote:
> >>>>>>>>>>>>
> >>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>> rtree uses Euclidean distance so the points should be in a
> >>>>>>>> coordinate
> >>>>>>>>>>>>>> system where this makes sense at least as a reasonable
> >>>>>>>> approximation.
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> I tried the original example:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> remotes::install_github("hunzikp/rtree")
> >>>>>>>>>>>>> library(spData)
> >>>>>>>>>>>>> library(sf)
> >>>>>>>>>>>>> projdata<-st_transform(nz_height, 32759)
> >>>>>>>>>>>>> library(rtree)
> >>>>>>>>>>>>> pts <- st_coordinates(projdata)
> >>>>>>>>>>>>> rt <- RTree(st_coordinates(projdata))
> >>>>>>>>>>>>> bufferR <- c(402.336, 1609.34, 3218.69, 4828.03, 6437.38)
> >>>>>>>>>>>>> wd1 <- withinDistance(rt, pts, bufferR[1])
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> but unfortunately failed (maybe newer Boost headers than
> >> yours?):
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> Error in UseMethod("withinDistance", rTree) :
> >>>>>>>>>>>>>    no applicable method for 'withinDistance' applied to an
> >> object
> >>>>>> of
> >>>>>>>>>>>>> class
> >>>>>>>>>>>>> "c('list', 'RTree')"
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> Kent
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> On Tue, Jun 2, 2020 at 9:59 AM Roger Bivand <
> >>>> Roger.Bivand at nhh.no>
> >>>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> On Tue, 2 Jun 2020, Kent Johnson wrote:
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> Date: Tue, 2 Jun 2020 02:44:17 -0500
> >>>>>>>>>>>>>>>>> From: Lom Navanyo <lomnavasia at gmail.com>
> >>>>>>>>>>>>>>>>> To: r-sig-geo at r-project.org
> >>>>>>>>>>>>>>>>> Subject: [R-sig-Geo] How to efficiently generate data of
> >>>>>>>>>> neighboring
> >>>>>>>>>>>>>>>>>         points within specified radii (distances) for
> each
> >>>>>> point
> >>>>>>>>>> in a
> >>>>>>>>>>>>>>> given
> >>>>>>>>>>>>>>>>>         points data set.
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> Hello,
> >>>>>>>>>>>>>>>>> I have data set of about 3400 location points with which
> I
> >> am
> >>>>>>>>>> trying
> >>>>>>>>>>>>> to
> >>>>>>>>>>>>>>>>> generate data of each point and their neighbors within
> >>>> defined
> >>>>>>>>>> radii
> >>>>>>>>>>>>>>> (eg,
> >>>>>>>>>>>>>>>>> 0.25, 1, and 3 miles).
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> The rtree package is very fast and memory-efficient for
> >>>>>>>>>>>>> within-distance
> >>>>>>>>>>>>>>>> calculations.
> >>>>>>>>>>>>>>>> https://github.com/hunzikp/rtree
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> Thanks! Does this also apply when the input points are in
> >>>>>>>>>> geographical
> >>>>>>>>>>>>>>> coordinates?
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> Roger
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> Kent Johnson
> >>>>>>>>>>>>>>>> Cambridge, MA
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>       [[alternative HTML version deleted]]
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>>>> R-sig-Geo mailing list
> >>>>>>>>>>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> --
> >>>>>>>>>>>>>>> Roger Bivand
> >>>>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>>>>>>>
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> --
> >>>>>>>>>>>>> Roger Bivand
> >>>>>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>>> --
> >>>>>>>>>> Roger Bivand
> >>>>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>>>
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>> --
> >>>>>>>> Roger Bivand
> >>>>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>> --
> >>>>>> Roger Bivand
> >>>>>> Department of Economics, Norwegian School of Economics,
> >>>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>> https://orcid.org/0000-0003-2392-6140
> >>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>>
> >>>>>
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>> https://orcid.org/0000-0003-2392-6140
> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From m@ur|c|o@z@mbr@no @end|ng |rom u|ronter@@c|  Wed Jun 10 22:27:39 2020
From: m@ur|c|o@z@mbr@no @end|ng |rom u|ronter@@c| (Mauricio Zambrano-Bigiarini)
Date: Wed, 10 Jun 2020 16:27:39 -0400
Subject: [R-sig-Geo] rgdal 1.5-10 published on CRAN
In-Reply-To: <alpine.LFD.2.22.394.2006091532320.1939340@reclus.nhh.no>
References: <alpine.LFD.2.22.394.2006091532320.1939340@reclus.nhh.no>
Message-ID: <CAP6VarucHK0zeP9oA9c1N=NOnOZTNewCDH3URmpQcWbCwwcNUg@mail.gmail.com>

Thank you very much for all the great work you and all the developers
constantly do.

Mauricio


Mauricio Zambrano-Bigiarini, PhD

=====================================
Department of Civil Engineering
Faculty of Engineering and Sciences
Universidad de La Frontera, Temuco, Chile
http://hzambran.github.io/
https://orcid.org/0000-0002-9536-643X
=====================================
mailto : mauricio.zambrano at ufrontera.cl
work-phone : +56 45 259 2812
=====================================
"What makes the desert beautiful is
that somewhere it hides a well"
(Antoine de Saint-Exupery
=====================================
Linux user #454569 -- Linux Mint user

-- 
La informaci?n contenida en este correo electr?nico y cualquier anexo o 
respuesta relacionada, puede contener datos e informaci?n confidencial y no 
puede ser usada o difundida por personas distintas a su(s) destinatario(s). 
Si usted no es el destinatario de esta comunicaci?n, le informamos que 
cualquier divulgaci?n, distribuci?n o copia de esta informaci?n constituye 
un delito conforme a la ley chilena. Si lo ha recibido por error, por favor 
borre el mensaje y todos sus anexos y notifique al remitente.


From Roger@B|v@nd @end|ng |rom nhh@no  Fri Jun 12 16:32:49 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 12 Jun 2020 16:32:49 +0200
Subject: [R-sig-Geo] macOS packages with updated spatial libraries
Message-ID: <alpine.LFD.2.22.394.2006121629170.2035510@reclus.nhh.no>

Please see R-sig-Mac for Prof. Brian Ripley's message about test candidate 
macOS R-spatial package binaries using PROJ, GEOS and GDAL: 
https://stat.ethz.ch/pipermail/r-sig-mac/2020-June/013599.html

Please report back in that thread if you have tried these builds.

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From bennet @end|ng |rom um|ch@edu  Sun Jun 14 17:30:06 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Sun, 14 Jun 2020 11:30:06 -0400
Subject: [R-sig-Geo] rgdal configure errors for proj test
Message-ID: <CAB2ovotw1icBJQ979MS0Fn=RUTNixv_84jY+_7oJBAnXzcAt6A@mail.gmail.com>

Summary

I was getting errors from the configure script that it could not find
the proj library file when it is installed outside of /usr/local.  A
one line change to configure.ac and rerunning autoreconf solves the
problem.  This problem exists both in the tar ball supplied by CRAN
mirrors and in the version provided by

$ svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/
. . . .
Checked out revision 1009.

I hope that sufficient detail is provided in what follows to understand
the environment, the error, and why the proposed fix works.  There is
almost certainly a better way to resolve the issue, but the proposed one
does work.  I hope it will isolate the problem sufficiently that a more
correct fix can be created.


Environment description

#------------------------------------------------------------------------
CentOS Linux release 7.7.1908 (Core)
3.10.0-1062.9.1.el7.x86_64

GCC 8.2.0  Compiled from source
R version 3.6.3 (2020-02-29)  Compiled from source with gcc/8.2.0

#------------------------------------------------------------------------
06-11-2020 09:22 $ wget http://download.osgeo.org/geos/geos-3.8.1.tar.bz2

./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/geos/3.8.1

#------------------------------------------------------------------------
06-11-2020 09:26 $ wget http://download.osgeo.org/gdal/CURRENT/gdal-3.1.0.tar.gz

./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0 \
    --with-libtiff=$IMG_LIBS_HOME \
    --with-libjpeg=$IMG_LIBS_HOME --with-gif=$IMG_LIBS_HOME \
    --with-hdf4=$HDF4_ROOT --with-hdf5=$HDF5_ROOT \
    --with-geos=$GEOS_HOME --with-proj=$PROJ_HOME

#------------------------------------------------------------------------
06-11-2020 19:44 $ wget https://download.osgeo.org/proj/proj-6.2.1.tar.gz

./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1

# Into the build directory, and before running make ; make install, we

unzip -o /sw/src/arcts/proj/proj-datumgrid-1.8.zip -d data

#------------------------------------------------------------------------

All of the base libraries pass tests and are known to work properly.



All R libraries obtained from a mirror of CRAN.

The prerequisite libraries for rgdal were install with these commands
and were successful.

install.packages('tidyverse', "/sw/arcts/centos7/Rgeospatial/062020")
install.packages('sf', "/sw/arcts/centos7/Rgeospatial/062020")
install.packages('rgeos', "/sw/arcts/centos7/Rgeospatial/062020")


Rgdal installation

# First attempted this install.packages(rgdal) command, which has worked
# in past years with slightly different versions
# (comand line broken for legibility)

install.packages('rgdal',
    configure.args=c("--with-proj-include=${PROJ_INCLUDE}",
                     "--with-proj-lib=${PROJ_LIB}",
                     "--with-proj-share=${PROJ_SHARE}")
                    )

That failed on the configure test of `proj_create_context` because it is
unable to find the library with this message from `configure`.  See note
at the end of this message for the complete transcript of the first attempt
at installation.

>> /usr/bin/ld: cannot find -lproj

The rgdal installation reports that it can find proj, and it is usable.  The
following excerpt from the transcript shows configure properly finding
the proj libraries from pkg-config, and that it knows the proper PROJ_LIBS.

configure: pkg-config proj exists, will use it
configure: PROJ version: 6.2.1
configure: proj CPP flags: -DPROJ_H_API
-I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
checking PROJ header API:... yes

Somewhere between that test and compilation of the test code for
proj_context_create shown above, it clearly loses the needed
'-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion of PROJ LIBS.


Debugging information

To debug this, I unpacked the .tar.gz of the R package and ran `configure`
by hand.  I obtained the same result.

Looking in the config.log generated by `configure`, I find that the compile
command used was.  This confirms that the library location if reported
finding is not being used on the compile command for this test.

    configure:3894: gcc -o conftest -O3 -mtune=native -I/usr/local/include
    -DPROJ_H_API -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
    -L/usr/local/lib64 conftest.c -lproj
    -L/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/lib -lgdal >&5


Nonetheless, I confirmed that by extracting the test code and compiling it
by hand with the correct library flag provided, it compiles.  I modified
the `configure` script to include the missing library specification, and
`configure` also then runs to completion.  That confirms that the problem
really is the missing '-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion
of PROJ LIBS.

I then tried to locate where in the configure.ac file the library was
being lost or not set for the test, but I was only able to determine that
by adding $PKG_LIBS to LIBS manually after the block where the proj-libs
are determined, configure would now run to completion; it did.

I then applied the patch and recreated the installation tar ball to be used
with install.packages().

The procedure for doing that is to unpack rgdal_1.5-10.tar.gz as distributed
by CRAN mirrors, change to the rgdal directory, apply this patch,


*** configure.ac.original    2020-06-14 10:44:31.999142923 -0400
--- configure.ac    2020-06-14 10:47:59.830661680 -0400
***************
*** 397,402 ****
--- 397,403 ----
    fi # proj_config_ok
  fi # proj_lib_path

+ LIBS="${PKG_LIBS} ${LIBS}"
  AC_MSG_NOTICE([PROJ LIBS: ${PKG_LIBS}])


run autoreconf to regenerate the configure script, obtain new md5sums for
configure and configure.ac, patch the MD5 file, change to the directory
above, tar the rgdal directory that contains the patched files, and use
that to install rgdal with install.packages().


After installation of the patched version, I get this upon loading the rgdal
library.

> library(rgdal)
Loading required package: sp
rgdal: version: 1.5-10, (SVN revision 1006)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 3.1.0, released 2020/05/03
Path to GDAL shared files: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal
GDAL binary built with GEOS: FALSE
Loaded PROJ runtime: Rel. 6.2.1, November 1st, 2019, [PJ_VERSION: 621]
Path to PROJ shared files: /sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/share/proj
Linking to sp version:1.4-2
To mute warnings of possible GDAL/OSR exportToProj4() degradation,
use options("rgdal_show_exportToProj4_warnings"="none") before loading rgdal.




#============================================================================
#
# Transcript of the first, failed installation attempt
#
#============================================================================

> install.packages('rgdal', "/sw/arcts/centos7/Rgeospatial/062020", repos="https://repo.miserver.it.umich.edu/cran/")
trying URL 'https://repo.miserver.it.umich.edu/cran/src/contrib/rgdal_1.5-10.tar.gz'
Content type 'application/octet-stream' length 2300923 bytes (2.2 MB)
==================================================
downloaded 2.2 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
** using staged installation
configure: R_HOME: /sw/arcts/centos7/R/3.6.3/lib64/R
configure: CC: gcc
configure: CXX: g++ -std=gnu++11
configure: CXX11 is: g++, CXX11STD is: -std=gnu++11
configure: CXX is: g++ -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-10
checking for /usr/bin/svnversion... yes
configure: svn revision: 1006
checking for gdal-config...
/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.1.0
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking gdal: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal/stateplane.csv
readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.2.1
configure: proj CPP flags: -DPROJ_H_API
-I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
checking PROJ header API:... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking proj.h usability... yes
checking proj.h presence... yes
checking for proj.h... yes
checking for proj_context_create in -lproj... no
configure: error: proj_context_create not found in libproj.
ERROR: configuration failed for package ?rgdal?


From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 14 21:25:01 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 14 Jun 2020 21:25:01 +0200
Subject: [R-sig-Geo] rgdal configure errors for proj test
In-Reply-To: <CAB2ovotw1icBJQ979MS0Fn=RUTNixv_84jY+_7oJBAnXzcAt6A@mail.gmail.com>
References: <CAB2ovotw1icBJQ979MS0Fn=RUTNixv_84jY+_7oJBAnXzcAt6A@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006142122380.2085047@reclus.nhh.no>

Thanks, I've only checked your patch locally. Please try rev. 1010 when/if 
it completes building on R-Forge. I'd be grateful if others can also check 
the current rgdal status, as quite a number of changes have entered 
configure.ac since 1.5-8, and only some are in 1.5-10.

Roger

On Sun, 14 Jun 2020, Bennet Fauber wrote:

> Summary
>
> I was getting errors from the configure script that it could not find
> the proj library file when it is installed outside of /usr/local.  A
> one line change to configure.ac and rerunning autoreconf solves the
> problem.  This problem exists both in the tar ball supplied by CRAN
> mirrors and in the version provided by
>
> $ svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/
> . . . .
> Checked out revision 1009.
>
> I hope that sufficient detail is provided in what follows to understand
> the environment, the error, and why the proposed fix works.  There is
> almost certainly a better way to resolve the issue, but the proposed one
> does work.  I hope it will isolate the problem sufficiently that a more
> correct fix can be created.
>
>
> Environment description
>
> #------------------------------------------------------------------------
> CentOS Linux release 7.7.1908 (Core)
> 3.10.0-1062.9.1.el7.x86_64
>
> GCC 8.2.0  Compiled from source
> R version 3.6.3 (2020-02-29)  Compiled from source with gcc/8.2.0
>
> #------------------------------------------------------------------------
> 06-11-2020 09:22 $ wget http://download.osgeo.org/geos/geos-3.8.1.tar.bz2
>
> ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/geos/3.8.1
>
> #------------------------------------------------------------------------
> 06-11-2020 09:26 $ wget http://download.osgeo.org/gdal/CURRENT/gdal-3.1.0.tar.gz
>
> ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0 \
>    --with-libtiff=$IMG_LIBS_HOME \
>    --with-libjpeg=$IMG_LIBS_HOME --with-gif=$IMG_LIBS_HOME \
>    --with-hdf4=$HDF4_ROOT --with-hdf5=$HDF5_ROOT \
>    --with-geos=$GEOS_HOME --with-proj=$PROJ_HOME
>
> #------------------------------------------------------------------------
> 06-11-2020 19:44 $ wget https://download.osgeo.org/proj/proj-6.2.1.tar.gz
>
> ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1
>
> # Into the build directory, and before running make ; make install, we
>
> unzip -o /sw/src/arcts/proj/proj-datumgrid-1.8.zip -d data
>
> #------------------------------------------------------------------------
>
> All of the base libraries pass tests and are known to work properly.
>
>
>
> All R libraries obtained from a mirror of CRAN.
>
> The prerequisite libraries for rgdal were install with these commands
> and were successful.
>
> install.packages('tidyverse', "/sw/arcts/centos7/Rgeospatial/062020")
> install.packages('sf', "/sw/arcts/centos7/Rgeospatial/062020")
> install.packages('rgeos', "/sw/arcts/centos7/Rgeospatial/062020")
>
>
> Rgdal installation
>
> # First attempted this install.packages(rgdal) command, which has worked
> # in past years with slightly different versions
> # (comand line broken for legibility)
>
> install.packages('rgdal',
>    configure.args=c("--with-proj-include=${PROJ_INCLUDE}",
>                     "--with-proj-lib=${PROJ_LIB}",
>                     "--with-proj-share=${PROJ_SHARE}")
>                    )
>
> That failed on the configure test of `proj_create_context` because it is
> unable to find the library with this message from `configure`.  See note
> at the end of this message for the complete transcript of the first attempt
> at installation.
>
>>> /usr/bin/ld: cannot find -lproj
>
> The rgdal installation reports that it can find proj, and it is usable.  The
> following excerpt from the transcript shows configure properly finding
> the proj libraries from pkg-config, and that it knows the proper PROJ_LIBS.
>
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.2.1
> configure: proj CPP flags: -DPROJ_H_API
> -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
> configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
> checking PROJ header API:... yes
>
> Somewhere between that test and compilation of the test code for
> proj_context_create shown above, it clearly loses the needed
> '-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion of PROJ LIBS.
>
>
> Debugging information
>
> To debug this, I unpacked the .tar.gz of the R package and ran `configure`
> by hand.  I obtained the same result.
>
> Looking in the config.log generated by `configure`, I find that the compile
> command used was.  This confirms that the library location if reported
> finding is not being used on the compile command for this test.
>
>    configure:3894: gcc -o conftest -O3 -mtune=native -I/usr/local/include
>    -DPROJ_H_API -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
>    -L/usr/local/lib64 conftest.c -lproj
>    -L/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/lib -lgdal >&5
>
>
> Nonetheless, I confirmed that by extracting the test code and compiling it
> by hand with the correct library flag provided, it compiles.  I modified
> the `configure` script to include the missing library specification, and
> `configure` also then runs to completion.  That confirms that the problem
> really is the missing '-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion
> of PROJ LIBS.
>
> I then tried to locate where in the configure.ac file the library was
> being lost or not set for the test, but I was only able to determine that
> by adding $PKG_LIBS to LIBS manually after the block where the proj-libs
> are determined, configure would now run to completion; it did.
>
> I then applied the patch and recreated the installation tar ball to be used
> with install.packages().
>
> The procedure for doing that is to unpack rgdal_1.5-10.tar.gz as distributed
> by CRAN mirrors, change to the rgdal directory, apply this patch,
>
>
> *** configure.ac.original    2020-06-14 10:44:31.999142923 -0400
> --- configure.ac    2020-06-14 10:47:59.830661680 -0400
> ***************
> *** 397,402 ****
> --- 397,403 ----
>    fi # proj_config_ok
>  fi # proj_lib_path
>
> + LIBS="${PKG_LIBS} ${LIBS}"
>  AC_MSG_NOTICE([PROJ LIBS: ${PKG_LIBS}])
>
>
> run autoreconf to regenerate the configure script, obtain new md5sums for
> configure and configure.ac, patch the MD5 file, change to the directory
> above, tar the rgdal directory that contains the patched files, and use
> that to install rgdal with install.packages().
>
>
> After installation of the patched version, I get this upon loading the rgdal
> library.
>
>> library(rgdal)
> Loading required package: sp
> rgdal: version: 1.5-10, (SVN revision 1006)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 3.1.0, released 2020/05/03
> Path to GDAL shared files: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal
> GDAL binary built with GEOS: FALSE
> Loaded PROJ runtime: Rel. 6.2.1, November 1st, 2019, [PJ_VERSION: 621]
> Path to PROJ shared files: /sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/share/proj
> Linking to sp version:1.4-2
> To mute warnings of possible GDAL/OSR exportToProj4() degradation,
> use options("rgdal_show_exportToProj4_warnings"="none") before loading rgdal.
>
>
>
>
> #============================================================================
> #
> # Transcript of the first, failed installation attempt
> #
> #============================================================================
>
>> install.packages('rgdal', "/sw/arcts/centos7/Rgeospatial/062020", repos="https://repo.miserver.it.umich.edu/cran/")
> trying URL 'https://repo.miserver.it.umich.edu/cran/src/contrib/rgdal_1.5-10.tar.gz'
> Content type 'application/octet-stream' length 2300923 bytes (2.2 MB)
> ==================================================
> downloaded 2.2 MB
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /sw/arcts/centos7/R/3.6.3/lib64/R
> configure: CC: gcc
> configure: CXX: g++ -std=gnu++11
> configure: CXX11 is: g++, CXX11STD is: -std=gnu++11
> configure: CXX is: g++ -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-10
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 1006
> checking for gdal-config...
> /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.1.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal/stateplane.csv
> readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.2.1
> configure: proj CPP flags: -DPROJ_H_API
> -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
> configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
> checking PROJ header API:... yes
> checking for gcc... gcc
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -E
> checking for grep that handles long lines and -e... /usr/bin/grep
> checking for egrep... /usr/bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking proj.h usability... yes
> checking proj.h presence... yes
> checking for proj.h... yes
> checking for proj_context_create in -lproj... no
> configure: error: proj_context_create not found in libproj.
> ERROR: configuration failed for package ?rgdal?
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From bennet @end|ng |rom um|ch@edu  Mon Jun 15 02:49:07 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Sun, 14 Jun 2020 20:49:07 -0400
Subject: [R-sig-Geo] rgdal configure errors for proj test
In-Reply-To: <alpine.LFD.2.22.394.2006142122380.2085047@reclus.nhh.no>
References: <CAB2ovotw1icBJQ979MS0Fn=RUTNixv_84jY+_7oJBAnXzcAt6A@mail.gmail.com>
 <alpine.LFD.2.22.394.2006142122380.2085047@reclus.nhh.no>
Message-ID: <CAB2ovosVw387K8AJUFOUqXbbDAqLa17P13AU4UfJE4j4Rd3omg@mail.gmail.com>

That seems to have done the trick for my case!  Thanks!  Details
included below include the svn revision number and the results of
configure.

If it helps any, the line I suggested adding (with an additional
library variable) is in the original configure.ac in the sf library.
I include that below the configure output at the end of the message,
in case it is of use or interest

I tried just now with

$ svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/
A    rgdal/pkg
....
A    rgdal/old/old_0.6-28/man/closeDataset-methods.Rd
A    rgdal/old/old_0.6-28/NAMESPACE
Checked out revision 1010.

and it builds without error.

$ ./configure --prefix=/tmp/local
configure: R_HOME: /sw/arcts/centos7/R/3.6.3/lib64/R
configure: CC: gcc
configure: CXX: g++ -std=gnu++11
configure: CXX11 is: g++, CXX11STD is: -std=gnu++11
configure: CXX is: g++ -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-11
checking for /usr/bin/svnversion... yes
cat: inst/SVN_VERSION: No such file or directory
configure: svn revision:
checking for gdal-config...
/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.1.0
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking GDAL: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal/stateplane.csv
readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.2.1
configure: PROJ CPP flags: -DPROJ_H_API
-I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
checking PROJ header API:... yes
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C++ compiler... yes
checking whether g++ -std=gnu++11 accepts -g... yes
checking how to run the C++ preprocessor... g++ -std=gnu++11 -E
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking proj.h usability... yes
checking proj.h presence... yes
checking for proj.h... yes
checking for proj_context_create in -lproj... yes
checking Using GDAL < 3 with PROJ >= 6... no
checking PROJ version >= 4.8.0... yes
checking PROJ: proj.db found and readable... yes
configure: Package CPP flags:
-I/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/include
-I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include   -DPROJ_H_API
configure: Package LIBS:  -L/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/lib
-lgdal -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
configure: creating ./config.status
config.status: creating src/Makevars


sf_0.9-3tar.gz:  sf/configure.ac

378 # dnl ditto for a library path
379 AC_ARG_WITH([proj-lib],
380     AC_HELP_STRING([--with-proj-lib=LIB_PATH],
381                [the location of proj libraries]),
382                [proj_lib_path=$withval])
383 if test [ -n "$proj_lib_path" ] ; then
384     AC_SUBST([PROJ_LIBS], ["-L${proj_lib_path} ${INPKG_LIBS} -lproj"])
385 else
386   if test "${proj_config_ok}" = yes; then
387     PROJ_LIB_PATH=`${PROJ_CONFIG} --libs`
388     AC_SUBST([PROJ_LIBS], ["${PROJ_LIB_PATH} ${INPKG_LIBS}"])
389     proj_version=`${PROJ_CONFIG} --modversion`
390     AC_MSG_NOTICE([PROJ: ${proj_version}])
391   else
392     PROJ_LIBS="${PKG_LIBS} -lproj"
393   fi
394 fi
395
396 LIBS="${PROJ_LIBS} ${INLIBS} ${PKG_LIBS}"


On Sun, Jun 14, 2020 at 3:25 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> Thanks, I've only checked your patch locally. Please try rev. 1010 when/if
> it completes building on R-Forge. I'd be grateful if others can also check
> the current rgdal status, as quite a number of changes have entered
> configure.ac since 1.5-8, and only some are in 1.5-10.
>
> Roger
>
> On Sun, 14 Jun 2020, Bennet Fauber wrote:
>
> > Summary
> >
> > I was getting errors from the configure script that it could not find
> > the proj library file when it is installed outside of /usr/local.  A
> > one line change to configure.ac and rerunning autoreconf solves the
> > problem.  This problem exists both in the tar ball supplied by CRAN
> > mirrors and in the version provided by
> >
> > $ svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/
> > . . . .
> > Checked out revision 1009.
> >
> > I hope that sufficient detail is provided in what follows to understand
> > the environment, the error, and why the proposed fix works.  There is
> > almost certainly a better way to resolve the issue, but the proposed one
> > does work.  I hope it will isolate the problem sufficiently that a more
> > correct fix can be created.
> >
> >
> > Environment description
> >
> > #------------------------------------------------------------------------
> > CentOS Linux release 7.7.1908 (Core)
> > 3.10.0-1062.9.1.el7.x86_64
> >
> > GCC 8.2.0  Compiled from source
> > R version 3.6.3 (2020-02-29)  Compiled from source with gcc/8.2.0
> >
> > #------------------------------------------------------------------------
> > 06-11-2020 09:22 $ wget http://download.osgeo.org/geos/geos-3.8.1.tar.bz2
> >
> > ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/geos/3.8.1
> >
> > #------------------------------------------------------------------------
> > 06-11-2020 09:26 $ wget http://download.osgeo.org/gdal/CURRENT/gdal-3.1.0.tar.gz
> >
> > ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0 \
> >    --with-libtiff=$IMG_LIBS_HOME \
> >    --with-libjpeg=$IMG_LIBS_HOME --with-gif=$IMG_LIBS_HOME \
> >    --with-hdf4=$HDF4_ROOT --with-hdf5=$HDF5_ROOT \
> >    --with-geos=$GEOS_HOME --with-proj=$PROJ_HOME
> >
> > #------------------------------------------------------------------------
> > 06-11-2020 19:44 $ wget https://download.osgeo.org/proj/proj-6.2.1.tar.gz
> >
> > ./configure --prefix=/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1
> >
> > # Into the build directory, and before running make ; make install, we
> >
> > unzip -o /sw/src/arcts/proj/proj-datumgrid-1.8.zip -d data
> >
> > #------------------------------------------------------------------------
> >
> > All of the base libraries pass tests and are known to work properly.
> >
> >
> >
> > All R libraries obtained from a mirror of CRAN.
> >
> > The prerequisite libraries for rgdal were install with these commands
> > and were successful.
> >
> > install.packages('tidyverse', "/sw/arcts/centos7/Rgeospatial/062020")
> > install.packages('sf', "/sw/arcts/centos7/Rgeospatial/062020")
> > install.packages('rgeos', "/sw/arcts/centos7/Rgeospatial/062020")
> >
> >
> > Rgdal installation
> >
> > # First attempted this install.packages(rgdal) command, which has worked
> > # in past years with slightly different versions
> > # (comand line broken for legibility)
> >
> > install.packages('rgdal',
> >    configure.args=c("--with-proj-include=${PROJ_INCLUDE}",
> >                     "--with-proj-lib=${PROJ_LIB}",
> >                     "--with-proj-share=${PROJ_SHARE}")
> >                    )
> >
> > That failed on the configure test of `proj_create_context` because it is
> > unable to find the library with this message from `configure`.  See note
> > at the end of this message for the complete transcript of the first attempt
> > at installation.
> >
> >>> /usr/bin/ld: cannot find -lproj
> >
> > The rgdal installation reports that it can find proj, and it is usable.  The
> > following excerpt from the transcript shows configure properly finding
> > the proj libraries from pkg-config, and that it knows the proper PROJ_LIBS.
> >
> > configure: pkg-config proj exists, will use it
> > configure: PROJ version: 6.2.1
> > configure: proj CPP flags: -DPROJ_H_API
> > -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
> > configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
> > checking PROJ header API:... yes
> >
> > Somewhere between that test and compilation of the test code for
> > proj_context_create shown above, it clearly loses the needed
> > '-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion of PROJ LIBS.
> >
> >
> > Debugging information
> >
> > To debug this, I unpacked the .tar.gz of the R package and ran `configure`
> > by hand.  I obtained the same result.
> >
> > Looking in the config.log generated by `configure`, I find that the compile
> > command used was.  This confirms that the library location if reported
> > finding is not being used on the compile command for this test.
> >
> >    configure:3894: gcc -o conftest -O3 -mtune=native -I/usr/local/include
> >    -DPROJ_H_API -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
> >    -L/usr/local/lib64 conftest.c -lproj
> >    -L/sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/lib -lgdal >&5
> >
> >
> > Nonetheless, I confirmed that by extracting the test code and compiling it
> > by hand with the correct library flag provided, it compiles.  I modified
> > the `configure` script to include the missing library specification, and
> > `configure` also then runs to completion.  That confirms that the problem
> > really is the missing '-L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib' portion
> > of PROJ LIBS.
> >
> > I then tried to locate where in the configure.ac file the library was
> > being lost or not set for the test, but I was only able to determine that
> > by adding $PKG_LIBS to LIBS manually after the block where the proj-libs
> > are determined, configure would now run to completion; it did.
> >
> > I then applied the patch and recreated the installation tar ball to be used
> > with install.packages().
> >
> > The procedure for doing that is to unpack rgdal_1.5-10.tar.gz as distributed
> > by CRAN mirrors, change to the rgdal directory, apply this patch,
> >
> >
> > *** configure.ac.original    2020-06-14 10:44:31.999142923 -0400
> > --- configure.ac    2020-06-14 10:47:59.830661680 -0400
> > ***************
> > *** 397,402 ****
> > --- 397,403 ----
> >    fi # proj_config_ok
> >  fi # proj_lib_path
> >
> > + LIBS="${PKG_LIBS} ${LIBS}"
> >  AC_MSG_NOTICE([PROJ LIBS: ${PKG_LIBS}])
> >
> >
> > run autoreconf to regenerate the configure script, obtain new md5sums for
> > configure and configure.ac, patch the MD5 file, change to the directory
> > above, tar the rgdal directory that contains the patched files, and use
> > that to install rgdal with install.packages().
> >
> >
> > After installation of the patched version, I get this upon loading the rgdal
> > library.
> >
> >> library(rgdal)
> > Loading required package: sp
> > rgdal: version: 1.5-10, (SVN revision 1006)
> > Geospatial Data Abstraction Library extensions to R successfully loaded
> > Loaded GDAL runtime: GDAL 3.1.0, released 2020/05/03
> > Path to GDAL shared files: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal
> > GDAL binary built with GEOS: FALSE
> > Loaded PROJ runtime: Rel. 6.2.1, November 1st, 2019, [PJ_VERSION: 621]
> > Path to PROJ shared files: /sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/share/proj
> > Linking to sp version:1.4-2
> > To mute warnings of possible GDAL/OSR exportToProj4() degradation,
> > use options("rgdal_show_exportToProj4_warnings"="none") before loading rgdal.
> >
> >
> >
> >
> > #============================================================================
> > #
> > # Transcript of the first, failed installation attempt
> > #
> > #============================================================================
> >
> >> install.packages('rgdal', "/sw/arcts/centos7/Rgeospatial/062020", repos="https://repo.miserver.it.umich.edu/cran/")
> > trying URL 'https://repo.miserver.it.umich.edu/cran/src/contrib/rgdal_1.5-10.tar.gz'
> > Content type 'application/octet-stream' length 2300923 bytes (2.2 MB)
> > ==================================================
> > downloaded 2.2 MB
> >
> > * installing *source* package ?rgdal? ...
> > ** package ?rgdal? successfully unpacked and MD5 sums checked
> > ** using staged installation
> > configure: R_HOME: /sw/arcts/centos7/R/3.6.3/lib64/R
> > configure: CC: gcc
> > configure: CXX: g++ -std=gnu++11
> > configure: CXX11 is: g++, CXX11STD is: -std=gnu++11
> > configure: CXX is: g++ -std=gnu++11
> > configure: C++11 support available
> > configure: rgdal: 1.5-10
> > checking for /usr/bin/svnversion... yes
> > configure: svn revision: 1006
> > checking for gdal-config...
> > /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 3.1.0
> > checking GDAL version >= 1.11.4... yes
> > checking GDAL version <= 2.5 or >= 3.0... yes
> > checking gdal: linking with --libs only... yes
> > checking GDAL: gdal-config data directory readable... yes
> > checking GDAL: /sw/arcts/centos7/gcc_8_2_0/gdal/3.1.0/share/gdal/stateplane.csv
> > readable... yes
> > configure: pkg-config proj exists, will use it
> > configure: PROJ version: 6.2.1
> > configure: proj CPP flags: -DPROJ_H_API
> > -I/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/include
> > configure: PROJ LIBS: -L/sw/arcts/centos7/gcc_8_2_0/proj/6.2.1/lib -lproj
> > checking PROJ header API:... yes
> > checking for gcc... gcc
> > checking whether the C compiler works... yes
> > checking for C compiler default output file name... a.out
> > checking for suffix of executables...
> > checking whether we are cross compiling... no
> > checking for suffix of object files... o
> > checking whether we are using the GNU C compiler... yes
> > checking whether gcc accepts -g... yes
> > checking for gcc option to accept ISO C89... none needed
> > checking how to run the C preprocessor... gcc -E
> > checking for grep that handles long lines and -e... /usr/bin/grep
> > checking for egrep... /usr/bin/grep -E
> > checking for ANSI C header files... yes
> > checking for sys/types.h... yes
> > checking for sys/stat.h... yes
> > checking for stdlib.h... yes
> > checking for string.h... yes
> > checking for memory.h... yes
> > checking for strings.h... yes
> > checking for inttypes.h... yes
> > checking for stdint.h... yes
> > checking for unistd.h... yes
> > checking proj.h usability... yes
> > checking proj.h presence... yes
> > checking for proj.h... yes
> > checking for proj_context_create in -lproj... no
> > configure: error: proj_context_create not found in libproj.
> > ERROR: configuration failed for package ?rgdal?
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From mo||y@@cott @end|ng |rom no@@@gov  Tue Jun 16 21:51:56 2020
From: mo||y@@cott @end|ng |rom no@@@gov (Molly Scott - NOAA Affiliate)
Date: Tue, 16 Jun 2020 09:51:56 -1000
Subject: [R-sig-Geo] Proj not projecting properly on maps
Message-ID: <CAJN8b5ej80nhP5fq5ChzHGcp47J=eW3S+LUv0bekjdL8EuNLog@mail.gmail.com>

Hi all, I apologise for the simple question, but really unsure how to
proceed given the error message. I make lots of animated movement maps
using the package MoveVis. Normally, I set up my animated date frame like
this:

ocs_ani_move = df2move(ocs.ani,
       * proj = "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs
+ellps=WGS84 +towgs84=0,0,0",*
        x = "Longitude", y = "Latitude", time = "Local.Date.Time", track_id
= "shark1" )

I am now getting this error when I do: CRS object has comment, which is
lost in output.Discarded ellps WGS 84 in CRS definition: +proj=merc
+a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m
+nadgrids=@null +wktext +no_defsDiscarded datum WGS_1984 in CRS definition.

Could any please tell me what to input for 'proj" I have read the most
recent vignettes and am aware that changes have been made, but unsure what
is the equivalent to my previous code.

Many thanks,

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun 16 22:21:52 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 16 Jun 2020 20:21:52 +0000
Subject: [R-sig-Geo] Proj not projecting properly on maps
Message-ID: <AM4PR05MB3316DC96FBBE4911A23CFFA3AC9D0@AM4PR05MB3316.eurprd05.prod.outlook.com>

Please provide the output of sessionInfo() to show your platform, and the complete context of the message, which is issued by rgdal as a warning, not an error. If you see it as an error, also provide the output of traceback(), and options("warn"). If that is 2, you have opted to treat all warnings as errors.

Can anyone check MoveVis with a standard data set and post it here, to see what is going on?

Roger

-------
Roger Bivand
Norwegian School of Economics, Bergen, Norway
roger.bivand at nhh.no

________________________________
Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Molly Scott - NOAA Affiliate via R-sig-Geo <r-sig-geo at r-project.org>
Sendt: tirsdag 16. juni 2020, 21:52
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] Proj not projecting properly on maps

Hi all, I apologise for the simple question, but really unsure how to proceed given the error message. I make lots of animated movement maps using the package MoveVis. Normally, I set up my animated date frame like this: ocs_ani_move = df2move(ocs.ani, * proj = "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0",* x = "Longitude", y = "Latitude", time = "Local.Date.Time", track_id = "shark1" ) I am now getting this error when I do: CRS object has comment, which is lost in output.Discarded ellps WGS 84 in CRS definition: +proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defsDiscarded datum WGS_1984 in CRS definition. Could any please tell me what to input for 'proj" I have read the most recent vignettes and am aware that changes have been made, but unsure what is the equivalent to my previous code. Many thanks, [[alternative HTML version deleted]] _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun 16 23:08:17 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 16 Jun 2020 21:08:17 +0000
Subject: [R-sig-Geo] Proj not projecting properly on maps
In-Reply-To: <AM4PR05MB3316DC96FBBE4911A23CFFA3AC9D0@AM4PR05MB3316.eurprd05.prod.outlook.com>
References: <AM4PR05MB3316DC96FBBE4911A23CFFA3AC9D0@AM4PR05MB3316.eurprd05.prod.outlook.com>
Message-ID: <7ad0ee988d6641379cbc22e6521310a1@nhh.no>

Using the df2move example:

> df2move(move_df,
+              proj = "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0", 
+              x = "coords.x1", y = "coords.x2", time = "timestamps", track_id = "trackId")
class       : MoveStack 
features    : 458 
extent      : 8.905824, 8.991679, 47.72762, 47.76816  (xmin, xmax, ymin, ymax)
crs         : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
variables   : 3
names       :                x,                y,             time 
min values  : 8.90582370470083, 47.7276175163588, 1526367599.63629 
max values  : 8.99167919359875, 47.7681647469332, 1526412899.54452 
timestamps  : 2018-05-15 06:59:59 ... 2018-05-15 19:34:59 Time difference of 13 hours  (start ... end, duration) 
sensors     : unknown 
indiv. data :  
individuals : T246a, T342g, T932u 
date created: 2020-06-06 15:52:40 
Warning messages:
1: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum WGS_1984 in CRS definition,
 but +towgs84= values preserved
2: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum WGS_1984 in CRS definition,
 but +towgs84= values preserved
3: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum WGS_1984 in CRS definition,
 but +towgs84= values preserved
4: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum WGS_1984 in CRS definition,
 but +towgs84= values preserved
5: In FUN(X[[i]], ...) : CRS object has comment, which is lost in output
6: In FUN(X[[i]], ...) : CRS object has comment, which is lost in output
7: In FUN(X[[i]], ...) : CRS object has comment, which is lost in output
8: In proj4string(x) : CRS object has comment, which is lost in output


which are all warnings by design. They are not errors, and will not manifest as errors unless the warn option has been reset from default.

The example on the help page is very misleading and the maintainer should update it ASAP; the warnings are being generated from repeated calls to CRS checking functions.

Why is rgdal with new PROJ and GDAL warning users? Because in some cases the output transformations may be degraded, so users need to check the output positions. sf and rgdal have taken steps to avoid this, but we cannot rule out the possibility that scripts rely on the defunct Proj4 string representation.

Roger

--
Roger Bivand
Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Roger Bivand <Roger.Bivand at nhh.no>
Sendt: tirsdag 16. juni 2020 22.21
Til: R-sig-geo mailing list; Molly Scott - NOAA Affiliate
Emne: Re: [R-sig-Geo] Proj not projecting properly on maps

Please provide the output of sessionInfo() to show your platform, and the complete context of the message, which is issued by rgdal as a warning, not an error. If you see it as an error, also provide the output of traceback(), and options("warn"). If that is 2, you have opted to treat all warnings as errors.

Can anyone check MoveVis with a standard data set and post it here, to see what is going on?

Roger

-------
Roger Bivand
Norwegian School of Economics, Bergen, Norway
roger.bivand at nhh.no

________________________________
Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Molly Scott - NOAA Affiliate via R-sig-Geo <r-sig-geo at r-project.org>
Sendt: tirsdag 16. juni 2020, 21:52
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] Proj not projecting properly on maps

Hi all, I apologise for the simple question, but really unsure how to proceed given the error message. I make lots of animated movement maps using the package MoveVis. Normally, I set up my animated date frame like this: ocs_ani_move = df2move(ocs.ani, * proj = "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0",* x = "Longitude", y = "Latitude", time = "Local.Date.Time", track_id = "shark1" ) I am now getting this error when I do: CRS object has comment, which is lost in output.Discarded ellps WGS 84 in CRS definition: +proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defsDiscarded datum WGS_1984 in CRS definition. Could any please tell me what to input for 'proj" I have read the most recent vignettes and am aware that changes have been made, but unsure what is the equivalent to my previous code. Many thanks, [[alternative HTML version deleted]] _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo

        [[alternative HTML version deleted]]


From |omn@v@@|@ @end|ng |rom gm@||@com  Sat Jun 20 10:43:44 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Sat, 20 Jun 2020 03:43:44 -0500
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
Message-ID: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>

Hello,

I have had to merge a shapefile that I read into R as an sf object with a
.csv data containing  some variables. Now I want to save the merged data to
a file (a folder on my pc). I am however getting following error:

Error in CPL_write_ogr(obj, dsn, layer, driver,
as.character(dataset_options),  :
  Write error

Below is a snippet of code used:
library(sf)
library(dplyr)
library(ggplot2)
library(stringr)
library(rgdal)
library(sp)

parcel1 <- st_read("parcels_all.shp")
balance5 <- read.csv("Balanced_5.csv")

mergedparcel <- merge(parcel1, balance5, by=c('PARCEL_ID','CAL_YEAR'),
all.x = FALSE, all.y=TRUE)

st_write(mergedparcel,"mergedparcel.shp")

I also used the shapefile function thus:

shapefile(mergedparcel , "D:/Documents/mergedparcel.shp")
 This also gives me:
Error in shapefile(mergedparcel, "D:/Documents/
Documents/mergedparcel.shp") :
  could not find function "shapefile"

Am I doing this right?
Any suggestion to resolve this issue would be appreciated.

-----------------
Lom

	[[alternative HTML version deleted]]


From b|@|ev||@t @end|ng |rom gm@||@com  Sat Jun 20 11:14:16 2020
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Sat, 20 Jun 2020 11:14:16 +0200
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
Message-ID: <9442a78e-e67f-601d-a545-8a08fb9e4ff0@gmail.com>

Dear Lom,

Since you did not provide reproducible example, I can only guess...
You used merge(, all.y = TRUE). This might produce an sf object of type 
GEOMETRY and some "GEOMETRYCOLLECTION EMPTY" in the geometry column, if 
some of the key values of y (balance5) are not found in the key values 
of x (parcel1). ESRI shapefile cannot accept mixed geometries, this 
might be the reason that you cannot write the dataset to shp format.

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2020.06.20. 10:43 keltez?ssel, Lom Navanyo ?rta:
> Hello,
>
> I have had to merge a shapefile that I read into R as an sf object with a
> .csv data containing  some variables. Now I want to save the merged data to
> a file (a folder on my pc). I am however getting following error:
>
> Error in CPL_write_ogr(obj, dsn, layer, driver,
> as.character(dataset_options),  :
>    Write error
>
> Below is a snippet of code used:
> library(sf)
> library(dplyr)
> library(ggplot2)
> library(stringr)
> library(rgdal)
> library(sp)
>
> parcel1 <- st_read("parcels_all.shp")
> balance5 <- read.csv("Balanced_5.csv")
>
> mergedparcel <- merge(parcel1, balance5, by=c('PARCEL_ID','CAL_YEAR'),
> all.x = FALSE, all.y=TRUE)
>
> st_write(mergedparcel,"mergedparcel.shp")
>
> I also used the shapefile function thus:
>
> shapefile(mergedparcel , "D:/Documents/mergedparcel.shp")
>   This also gives me:
> Error in shapefile(mergedparcel, "D:/Documents/
> Documents/mergedparcel.shp") :
>    could not find function "shapefile"
>
> Am I doing this right?
> Any suggestion to resolve this issue would be appreciated.
>
> -----------------
> Lom
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From |omn@v@@|@ @end|ng |rom gm@||@com  Sat Jun 20 12:28:36 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Sat, 20 Jun 2020 05:28:36 -0500
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <9442a78e-e67f-601d-a545-8a08fb9e4ff0@gmail.com>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
 <9442a78e-e67f-601d-a545-8a08fb9e4ff0@gmail.com>
Message-ID: <CAKBoCbEK2rQhRcddUNNNc3KsgTJqVTyEC6vjasPNf2E-5oaU=g@mail.gmail.com>

Dear Bede-Fazekas,

Thank you for the swift response.
I confirm that all key values in y (balance5) are in x (parcel1). I used
all.y=TRUE because y the IDs (key values in y) are actually a subset of x.
However, what I cannot confirm is if the key variables combination
c('PARCEL_ID','CAL_YEAR') match perfectly from the two data sets.
I therefore changed the merging as:
mergedparcel2 <- merge(parcel1, balance5, by=c('PARCEL_ID','CAL_YEAR'))

I still get the following error:
> st_write(mergedparcel2,"mergedparcel2.shp")
Writing layer `mergedparcel2' to data source `mergedparcel2.shp' using
driver `ESRI Shapefile'
Writing 4682 features with 204 fields and geometry type Multi Polygon.
Unknown field name `Act_Depthtwtr': updating a layer with improper field
name(s)?
Error in CPL_write_ogr(obj, dsn, layer, driver,
as.character(dataset_options),  :
  Write error
In addition: There were 21 warnings (use warnings() to see them)

-----------------
Lom

	[[alternative HTML version deleted]]


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Sat Jun 20 12:56:04 2020
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Sat, 20 Jun 2020 12:56:04 +0200
Subject: [R-sig-Geo] generating points from random to overdispersed on a
 raster grid.
Message-ID: <0c3b369c-3579-76bc-413b-34018e2e98d2@univ-fcomte.fr>

Dear listers,

On a simulation purpose, I would like to generate data variying from 
random to various degrees of overdispersion on a raster grid.? For 
instance on a matrix 1000 x 1000, to select a number of pixels that 
could be considered spatially aggregated (with a possibility for tuning 
the degree of aggregation from "random" - no aggregation - to strong 
clusters).

Has anyone heard about how to proceed or an idea about it?

Best,

Patrick



	[[alternative HTML version deleted]]


From jm@rt|nez19 @end|ng |rom u@@d@edu@do  Sat Jun 20 15:46:06 2020
From: jm@rt|nez19 @end|ng |rom u@@d@edu@do (Jose Ramon Martinez Batlle)
Date: Sat, 20 Jun 2020 09:46:06 -0400
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
Message-ID: <CAAUfc+3r=eUpCHxddBBBO6XNrJhKw4V_ORcDOBZ9+ZdH9s9v_w@mail.gmail.com>

Hello.

The "Write error" seems a permissions issue. Do you have write
permission to the folder you are trying to save the file? You can see
the default path by typing getwd() in the console.

Regarding the error message you got while trying to write the shape
using the shapefile function, I guess you mean the function belonging
to the raster package, which you may don't have installed in your
computer. That may be the reason why R can't find the function after
searching in your libraries.

If you type ?raster::shapefile in the console, with the raster package
installed, you will find the documentation of the function, where the
argument x (the source) is defined as "character (a file name, when
reading a shapefile) or Spatial* object (when writing a shapefile)".
So if you provide an object (which you did), it must be an object of
class Spatial*, but the one you provided seems to be an sf object. You
can try to coerce the Spatial to an sf object, but I advise against
that, because it is an unnecessary workaround when using the sf
workflow.

BTW, try to avoid using shapefile as the default format.

Best regards.



El s?b., 20 jun. 2020 a las 4:44, Lom Navanyo (<lomnavasia at gmail.com>) escribi?:
>
> Hello,
>
> I have had to merge a shapefile that I read into R as an sf object with a
> .csv data containing  some variables. Now I want to save the merged data to
> a file (a folder on my pc). I am however getting following error:
>
> Error in CPL_write_ogr(obj, dsn, layer, driver,
> as.character(dataset_options),  :
>   Write error
>
> Below is a snippet of code used:
> library(sf)
> library(dplyr)
> library(ggplot2)
> library(stringr)
> library(rgdal)
> library(sp)
>
> parcel1 <- st_read("parcels_all.shp")
> balance5 <- read.csv("Balanced_5.csv")
>
> mergedparcel <- merge(parcel1, balance5, by=c('PARCEL_ID','CAL_YEAR'),
> all.x = FALSE, all.y=TRUE)
>
> st_write(mergedparcel,"mergedparcel.shp")
>
> I also used the shapefile function thus:
>
> shapefile(mergedparcel , "D:/Documents/mergedparcel.shp")
>  This also gives me:
> Error in shapefile(mergedparcel, "D:/Documents/
> Documents/mergedparcel.shp") :
>   could not find function "shapefile"
>
> Am I doing this right?
> Any suggestion to resolve this issue would be appreciated.
>
> -----------------
> Lom
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Jos? Ram?n Mart?nez Batlle
Investigador/Profesor Universidad Aut?noma de Santo Domingo (UASD)
Correo electr?nico: jmartinez19 at uasd.edu.do
P?gina web: http://geografiafisica.org


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Sat Jun 20 18:20:42 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Sat, 20 Jun 2020 18:20:42 +0200
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <CAKBoCbEK2rQhRcddUNNNc3KsgTJqVTyEC6vjasPNf2E-5oaU=g@mail.gmail.com>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
 <9442a78e-e67f-601d-a545-8a08fb9e4ff0@gmail.com>
 <CAKBoCbEK2rQhRcddUNNNc3KsgTJqVTyEC6vjasPNf2E-5oaU=g@mail.gmail.com>
Message-ID: <5e5ce909-2217-c715-423d-3ac945cb3fc2@uni-muenster.de>



On 6/20/20 12:28 PM, Lom Navanyo wrote:
> Unknown field name `Act_Depthtwtr': updating a layer with improper field
> name(s)?

Shapefiles have funny restrictions as to the length and form of variable
names, you probably ran into that, as the message suggests.

A general advice is to not use shapefiles for writing; there are better
alternatives, geopackage comes to mind. Shapefiles make life unnecessary
complicated, you've now run into two of the many problems they have. The
days of creating shapefiles are over. If someone asks you to create
shapfiles, explain them it is a bad idea.
-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200620/ae0821eb/attachment.bin>

From t|m@@ppe|h@n@ @end|ng |rom gm@||@com  Sat Jun 20 18:32:58 2020
From: t|m@@ppe|h@n@ @end|ng |rom gm@||@com (Tim Salabim)
Date: Sat, 20 Jun 2020 18:32:58 +0200
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <5e5ce909-2217-c715-423d-3ac945cb3fc2@uni-muenster.de>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
 <9442a78e-e67f-601d-a545-8a08fb9e4ff0@gmail.com>
 <CAKBoCbEK2rQhRcddUNNNc3KsgTJqVTyEC6vjasPNf2E-5oaU=g@mail.gmail.com>
 <5e5ce909-2217-c715-423d-3ac945cb3fc2@uni-muenster.de>
Message-ID: <CAMbH+HhD4MEEjucXa-dsYpO43R35G5BYkMvWKrROALe1fYS3MA@mail.gmail.com>

And for anyone looking for arguments:

http://switchfromshapefile.org/


On Sat, Jun 20, 2020, 18:20 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

>
>
> On 6/20/20 12:28 PM, Lom Navanyo wrote:
> > Unknown field name `Act_Depthtwtr': updating a layer with improper field
> > name(s)?
>
> Shapefiles have funny restrictions as to the length and form of variable
> names, you probably ran into that, as the message suggests.
>
> A general advice is to not use shapefiles for writing; there are better
> alternatives, geopackage comes to mind. Shapefiles make life unnecessary
> complicated, you've now run into two of the many problems they have. The
> days of creating shapefiles are over. If someone asks you to create
> shapfiles, explain them it is a bad idea.
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48149 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From |omn@v@@|@ @end|ng |rom gm@||@com  Sun Jun 21 09:15:43 2020
From: |omn@v@@|@ @end|ng |rom gm@||@com (Lom Navanyo)
Date: Sun, 21 Jun 2020 02:15:43 -0500
Subject: [R-sig-Geo] Error when saving an sf (data) object to file as a
 shapefile
In-Reply-To: <CAAUfc+3r=eUpCHxddBBBO6XNrJhKw4V_ORcDOBZ9+ZdH9s9v_w@mail.gmail.com>
References: <CAKBoCbF6++bz56D5SKu5WZNR0UhXWFrtO6bOivnf9WgkiTheZQ@mail.gmail.com>
 <CAAUfc+3r=eUpCHxddBBBO6XNrJhKw4V_ORcDOBZ9+ZdH9s9v_w@mail.gmail.com>
Message-ID: <CAKBoCbGCR+Uu6rhLP+0cCh=nCVgAcJ5MR+f_Py2+hycS6c6mFw@mail.gmail.com>

I have write permission to the folder. I have also now called the raster
package, coerced the sf object to Spatial and could save as a shapefile.
But just as you hinted and was further explained by Edzer and Tim, the
shapefile could not be used elsewhere.

Thank you all for the support.

--------
Lom

On Sat, Jun 20, 2020 at 8:46 AM Jose Ramon Martinez Batlle <
jmartinez19 at uasd.edu.do> wrote:

> Hello.
>
> The "Write error" seems a permissions issue. Do you have write
> permission to the folder you are trying to save the file? You can see
> the default path by typing getwd() in the console.
>
> Regarding the error message you got while trying to write the shape
> using the shapefile function, I guess you mean the function belonging
> to the raster package, which you may don't have installed in your
> computer. That may be the reason why R can't find the function after
> searching in your libraries.
>
> If you type ?raster::shapefile in the console, with the raster package
> installed, you will find the documentation of the function, where the
> argument x (the source) is defined as "character (a file name, when
> reading a shapefile) or Spatial* object (when writing a shapefile)".
> So if you provide an object (which you did), it must be an object of
> class Spatial*, but the one you provided seems to be an sf object. You
> can try to coerce the Spatial to an sf object, but I advise against
> that, because it is an unnecessary workaround when using the sf
> workflow.
>
> BTW, try to avoid using shapefile as the default format.
>
> Best regards.
>
>
>
> El s?b., 20 jun. 2020 a las 4:44, Lom Navanyo (<lomnavasia at gmail.com>)
> escribi?:
> >
> > Hello,
> >
> > I have had to merge a shapefile that I read into R as an sf object with a
> > .csv data containing  some variables. Now I want to save the merged data
> to
> > a file (a folder on my pc). I am however getting following error:
> >
> > Error in CPL_write_ogr(obj, dsn, layer, driver,
> > as.character(dataset_options),  :
> >   Write error
> >
> > Below is a snippet of code used:
> > library(sf)
> > library(dplyr)
> > library(ggplot2)
> > library(stringr)
> > library(rgdal)
> > library(sp)
> >
> > parcel1 <- st_read("parcels_all.shp")
> > balance5 <- read.csv("Balanced_5.csv")
> >
> > mergedparcel <- merge(parcel1, balance5, by=c('PARCEL_ID','CAL_YEAR'),
> > all.x = FALSE, all.y=TRUE)
> >
> > st_write(mergedparcel,"mergedparcel.shp")
> >
> > I also used the shapefile function thus:
> >
> > shapefile(mergedparcel , "D:/Documents/mergedparcel.shp")
> >  This also gives me:
> > Error in shapefile(mergedparcel, "D:/Documents/
> > Documents/mergedparcel.shp") :
> >   could not find function "shapefile"
> >
> > Am I doing this right?
> > Any suggestion to resolve this issue would be appreciated.
> >
> > -----------------
> > Lom
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jos? Ram?n Mart?nez Batlle
> Investigador/Profesor Universidad Aut?noma de Santo Domingo (UASD)
> Correo electr?nico: jmartinez19 at uasd.edu.do
> P?gina web: http://geografiafisica.org
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun 22 16:20:57 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 22 Jun 2020 16:20:57 +0200
Subject: [R-sig-Geo] generating points from random to overdispersed on a
 raster grid.
In-Reply-To: <0c3b369c-3579-76bc-413b-34018e2e98d2@univ-fcomte.fr>
References: <0c3b369c-3579-76bc-413b-34018e2e98d2@univ-fcomte.fr>
Message-ID: <alpine.LFD.2.22.394.2006221618480.172970@reclus.nhh.no>

On Sat, 20 Jun 2020, Patrick Giraudoux wrote:

> Dear listers,
>
> On a simulation purpose, I would like to generate data variying from
> random to various degrees of overdispersion on a raster grid.? For
> instance on a matrix 1000 x 1000, to select a number of pixels that
> could be considered spatially aggregated (with a possibility for tuning
> the degree of aggregation from "random" - no aggregation - to strong
> clusters).
>
> Has anyone heard about how to proceed or an idea about it?

This sounds very much like spatstat, but could you provide a short code 
example to show what the discretised output should be? Are these 
presence/absence in the grid cells?

Best wishes,

Roger

>
> Best,
>
> Patrick
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Mon Jun 22 16:40:08 2020
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Mon, 22 Jun 2020 16:40:08 +0200
Subject: [R-sig-Geo] generating points from random to overdispersed on a
 raster grid.
In-Reply-To: <alpine.LFD.2.22.394.2006221618480.172970@reclus.nhh.no>
References: <0c3b369c-3579-76bc-413b-34018e2e98d2@univ-fcomte.fr>
 <alpine.LFD.2.22.394.2006221618480.172970@reclus.nhh.no>
Message-ID: <0749ec87-e9cb-b22b-c6df-2a03e60b3e3f@univ-fcomte.fr>

Le 22/06/2020 ? 16:20, Roger Bivand a ?crit?:
> On Sat, 20 Jun 2020, Patrick Giraudoux wrote:
>
>> Dear listers,
>>
>> On a simulation purpose, I would like to generate data variying from
>> random to various degrees of overdispersion on a raster grid. For
>> instance on a matrix 1000 x 1000, to select a number of pixels that
>> could be considered spatially aggregated (with a possibility for tuning
>> the degree of aggregation from "random" - no aggregation - to strong
>> clusters).
>>
>> Has anyone heard about how to proceed or an idea about it?
>
> This sounds very much like spatstat, but could you provide a short 
> code example to show what the discretised output should be? Are these 
> presence/absence in the grid cells?
>
> Best wishes,
>
> Roger

Good point Roger. Actually some earlier answers helped be even to 
clarify the problem in my mind... I did not realise at first there was 
two hidden components in my question. I becomes clear that the way to? 
adress the issue is scale dependent. If? the need is to simulate spatial 
aggregation of points (e.g. vole colonies or vole individuals), thus we 
probably need to dig in Akos' proposition and spatstat, indeed. If the 
need is to simulate overdispersed densities (e.g. according to a e.g. 
negbinomial distribution), thus selecting pixels randomly on a raster 
and giving them the values computed on the negbinomial distribution 
should make it. Both can be combined to obtain a perfect mess

The ball is now in my and collaborator's court !

Thanks anyway to responders who really helped be to go a step further 
(below David Pleydell's answer, a former postdoc now researcher at INRA, 
contacted directly off list, but this might be of interest or other 
listers).


------------------------------------------------------------------------
Le 22/06/2020 ? 13:01, David Pleydell a ?crit?:

Hi Patrick

(...)

Since?the?Poisson is a special case of negative binomial then?why not?

https://en.wikipedia.org/wiki/Negative_binomial_distribution#Poisson_distribution

According to the above chunk of?wikipedia, as r?->?Inf the neg binomial 
converges to Poisson. So in a spatial model you could include log(r) (or 
log(1/r)) as a?Gaussian random field (or Markov random field, or 2-D 
spline etc etc).? You would need to give some thought as to how to 
parameterise this - i.e. if there was no data would you 
want?over-dispersed vs Poisson to be equally likely, or should the prior 
favour one or the other?

If this is a (modestly sized)?spatial model it should be possible to use 
the conditional-autoregressive (CAR) priors that?Andrew Lawson has 
written for nimble (https://r-nimble.org/nimbleExamples/CAR.html). These 
are adaptations of what has previously been implemented?in geo-BUGS 
(with the added advantage of the flexibility and transparency of nimble).

One potential limit of this option is that under-dispersion is assumed 
to not take place. So a slightly different approach would be needed 
for?potentially?territorial animals (e.g.?blackbirds). In this case a 
gamma distribution could be more flexible:?when scale=1 then 
mean=variance, when scale <1 variance<mean, when scale>1 variance>mean.





	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jun 24 17:44:53 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 24 Jun 2020 17:44:53 +0200
Subject: [R-sig-Geo] maptools::as.im.RasterLayer with factor layers
In-Reply-To: <f43b64555ea137c3ccae170e10b31519@cam.ac.uk>
References: <f43b64555ea137c3ccae170e10b31519@cam.ac.uk>
Message-ID: <alpine.LFD.2.22.394.2006241742390.1184310@reclus.nhh.no>

Not seeing a reply here, I opened an issue: 
https://github.com/spatstat/spatstat/issues/132, which has been answered. 
If you are on github, Matt and others interested, please look at the code 
and let me know when it stabilises enough to revise maptools.

Roger

On Tue, 9 Jun 2020, Matt Lewis wrote:

> Dear all, 
> Not so much a question as a bit of adapted code. 
> Recently, I've been working with the spatstat package and using maptools
> to convert raster objects to spatstat's im format. One issue I have been
> having is the conversion of factor raster layers to im. To that end,
> I've adapted the maptools::as.im.RasterLayer() function to work with
> factor layers. 
> I realise that quite possibly this is a problem that has an alternative
> solution that I'm unaware of, but in case my adapted function is useful
> to others or something which you would like to include in the next
> release of maptools, I have attached it here. 
> Thanks for your work with maptools, and with all best wishes, 
> Matt 
> This email was originally sent to Roger Bivand who directed me to this
> list.
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From dn|ven @end|ng |rom uc@c@edu  Wed Jun 24 19:45:36 2020
From: dn|ven @end|ng |rom uc@c@edu (Doug Niven)
Date: Wed, 24 Jun 2020 10:45:36 -0700
Subject: [R-sig-Geo] Best resource for help compiling Gdal
In-Reply-To: <mailman.28228.7.1592906401.19518.r-sig-geo@r-project.org>
References: <mailman.28228.7.1592906401.19518.r-sig-geo@r-project.org>
Message-ID: <A3305621-11BB-4D6F-B413-C5A6140AD7E4@ucsc.edu>

Hi Folks,

Looking through the archives of this list, it looks like this isn?t the best place for troubleshooting build/make issues compiling gdal 3.1.0 in Linux.

Can someone please direct me to the best place for assistance with that? I?ve built it successfully previously on the same server without problems...

Specifically I?m getting the following error in in the ?make? step, and Googling errors like this doesn?t come up with many helpful results:

make[1]: *** [GNUmakefile:99: gdalserver] Error 1
make[1]: Leaving directory ?/home/admin/gdal-3.1.0/apps'
make: *** [GNUmakefile:114: apps-target] Error 2

Thanks in advance,

Doug

From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jun 24 20:48:32 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 24 Jun 2020 20:48:32 +0200
Subject: [R-sig-Geo] Best resource for help compiling Gdal
In-Reply-To: <A3305621-11BB-4D6F-B413-C5A6140AD7E4@ucsc.edu>
References: <mailman.28228.7.1592906401.19518.r-sig-geo@r-project.org>
 <A3305621-11BB-4D6F-B413-C5A6140AD7E4@ucsc.edu>
Message-ID: <alpine.LFD.2.22.394.2006242045470.1297325@reclus.nhh.no>

On Wed, 24 Jun 2020, Doug Niven via R-sig-Geo wrote:

> Hi Folks,
>
> Looking through the archives of this list, it looks like this isn?t the 
> best place for troubleshooting build/make issues compiling gdal 3.1.0 in 
> Linux.
>
> Can someone please direct me to the best place for assistance with that? 
> I?ve built it successfully previously on the same server without 
> problems...
>
> Specifically I?m getting the following error in in the ?make? step, and 
> Googling errors like this doesn?t come up with many helpful results:
>
> make[1]: *** [GNUmakefile:99: gdalserver] Error 1
> make[1]: Leaving directory ?/home/admin/gdal-3.1.0/apps'
> make: *** [GNUmakefile:114: apps-target] Error 2

The previous configure step should show where your expectations were not 
met, although apps is quite late, and suggests that the libraries got 
built. Maybe try the GDAL list, or an OS-specific list, as Linux is very 
broad?

Roger

>
> Thanks in advance,
>
> Doug
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From hyok|ee @end|ng |rom hd|group@org  Fri Jun 26 16:36:37 2020
From: hyok|ee @end|ng |rom hd|group@org (H. Joe Lee)
Date: Fri, 26 Jun 2020 09:36:37 -0500
Subject: [R-sig-Geo] New GDAL multi-dimensional array support?
Message-ID: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>

 Hi,


  My name is H. Joe Lee who maintains a rgdal website [0] to help rgdal
users to access NASA Earthdata easily.


  Recently, GDAL 3.1.0 added a multi-dimensional raster model [1] and two
new command line interface tools - gdalmdiminfo & gdalmdimtranslate. They
significantly increase the usability of NASA Earthdata in HDF like MOD35
product [2] by allowing users to subset and transpose data easily.



  Thus, I'm wondering if rgdal development team can provide functions that
utilize new GDAL multi-dimensional APIs and tools that support [1] in the
future release.


  Sincerely,



[0] https://hdfeos.org/software/r.php
<https://www.hdfeos.org/software/r.php>

[1]
https://gdal.org/user/multidim_raster_data_model.html#multidim-raster-data-model


[2] https://hdfeos.org/zoo/LAADS_MOD_py.php


--
Datafy everything in HDF for faster AI.

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Fri Jun 26 19:07:13 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Fri, 26 Jun 2020 19:07:13 +0200
Subject: [R-sig-Geo] New GDAL multi-dimensional array support?
In-Reply-To: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
References: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
Message-ID: <fc434768-408b-4dc6-2efd-864633fe9ae0@uni-muenster.de>

Good thinking! I was thinking of making this available in the context of
stars, which has multidimensional arrays (data cubes/hypercubes) as its
target data type.

Many regards,

On 6/26/20 4:36 PM, H. Joe Lee wrote:
>  Hi,
> 
> 
>   My name is H. Joe Lee who maintains a rgdal website [0] to help rgdal
> users to access NASA Earthdata easily.
> 
> 
>   Recently, GDAL 3.1.0 added a multi-dimensional raster model [1] and two
> new command line interface tools - gdalmdiminfo & gdalmdimtranslate. They
> significantly increase the usability of NASA Earthdata in HDF like MOD35
> product [2] by allowing users to subset and transpose data easily.
> 
> 
> 
>   Thus, I'm wondering if rgdal development team can provide functions that
> utilize new GDAL multi-dimensional APIs and tools that support [1] in the
> future release.
> 
> 
>   Sincerely,
> 
> 
> 
> [0] https://hdfeos.org/software/r.php
> <https://www.hdfeos.org/software/r.php>
> 
> [1]
> https://gdal.org/user/multidim_raster_data_model.html#multidim-raster-data-model
> 
> 
> [2] https://hdfeos.org/zoo/LAADS_MOD_py.php
> 
> 
> --
> Datafy everything in HDF for faster AI.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200626/185dd880/attachment.bin>

From t|m@@ppe|h@n@ @end|ng |rom gm@||@com  Fri Jun 26 19:23:22 2020
From: t|m@@ppe|h@n@ @end|ng |rom gm@||@com (Tim Salabim)
Date: Fri, 26 Jun 2020 19:23:22 +0200
Subject: [R-sig-Geo] New GDAL multi-dimensional array support?
In-Reply-To: <fc434768-408b-4dc6-2efd-864633fe9ae0@uni-muenster.de>
References: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
 <fc434768-408b-4dc6-2efd-864633fe9ae0@uni-muenster.de>
Message-ID: <CAMbH+Hhyy_qP9POGFbauMwCFru0xC+WJBhBgJrDRQhJ5Zn0wFg@mail.gmail.com>

Somewhat related , but Dirk Edelb?ttel just released an R package to
interact with tiledb for storing spatiotemporal data as arrays (I believe
very similar in structure to what stars objects are). Tiledb also has a
gdal driver, so should play rather nicely with stars/sf/...

On Fri, Jun 26, 2020, 19:07 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

> Good thinking! I was thinking of making this available in the context of
> stars, which has multidimensional arrays (data cubes/hypercubes) as its
> target data type.
>
> Many regards,
>
> On 6/26/20 4:36 PM, H. Joe Lee wrote:
> >  Hi,
> >
> >
> >   My name is H. Joe Lee who maintains a rgdal website [0] to help rgdal
> > users to access NASA Earthdata easily.
> >
> >
> >   Recently, GDAL 3.1.0 added a multi-dimensional raster model [1] and two
> > new command line interface tools - gdalmdiminfo & gdalmdimtranslate. They
> > significantly increase the usability of NASA Earthdata in HDF like MOD35
> > product [2] by allowing users to subset and transpose data easily.
> >
> >
> >
> >   Thus, I'm wondering if rgdal development team can provide functions
> that
> > utilize new GDAL multi-dimensional APIs and tools that support [1] in the
> > future release.
> >
> >
> >   Sincerely,
> >
> >
> >
> > [0] https://hdfeos.org/software/r.php
> > <https://www.hdfeos.org/software/r.php>
> >
> > [1]
> >
> https://gdal.org/user/multidim_raster_data_model.html#multidim-raster-data-model
> >
> >
> > [2] https://hdfeos.org/zoo/LAADS_MOD_py.php
> >
> >
> > --
> > Datafy everything in HDF for faster AI.
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48149 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From eng||@hchr|@topher@ @end|ng |rom gm@||@com  Sat Jun 27 03:55:47 2020
From: eng||@hchr|@topher@ @end|ng |rom gm@||@com (chris english)
Date: Fri, 26 Jun 2020 21:55:47 -0400
Subject: [R-sig-Geo] New GDAL multi-dimensional array support?
In-Reply-To: <CAMbH+Hhyy_qP9POGFbauMwCFru0xC+WJBhBgJrDRQhJ5Zn0wFg@mail.gmail.com>
References: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
 <fc434768-408b-4dc6-2efd-864633fe9ae0@uni-muenster.de>
 <CAMbH+Hhyy_qP9POGFbauMwCFru0xC+WJBhBgJrDRQhJ5Zn0wFg@mail.gmail.com>
Message-ID: <CAASFQpSLd3FYCJhHbgaB=4qacZOKE4Bd_08UvV0f-5hAOQxN9A@mail.gmail.com>

Merely for completeness,
https://cran.r-project.org/web/packages/tiledb/index.html
I feel guilty when I think, let Dirk do the werk, but he is light years
ahead of my C++ and C.
Chris

On Fri, Jun 26, 2020 at 1:23 PM Tim Salabim <tim.appelhans at gmail.com> wrote:

> Somewhat related , but Dirk Edelb?ttel just released an R package to
> interact with tiledb for storing spatiotemporal data as arrays (I believe
> very similar in structure to what stars objects are). Tiledb also has a
> gdal driver, so should play rather nicely with stars/sf/...
>
> On Fri, Jun 26, 2020, 19:07 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> wrote:
>
> > Good thinking! I was thinking of making this available in the context of
> > stars, which has multidimensional arrays (data cubes/hypercubes) as its
> > target data type.
> >
> > Many regards,
> >
> > On 6/26/20 4:36 PM, H. Joe Lee wrote:
> > >  Hi,
> > >
> > >
> > >   My name is H. Joe Lee who maintains a rgdal website [0] to help rgdal
> > > users to access NASA Earthdata easily.
> > >
> > >
> > >   Recently, GDAL 3.1.0 added a multi-dimensional raster model [1] and
> two
> > > new command line interface tools - gdalmdiminfo & gdalmdimtranslate.
> They
> > > significantly increase the usability of NASA Earthdata in HDF like
> MOD35
> > > product [2] by allowing users to subset and transpose data easily.
> > >
> > >
> > >
> > >   Thus, I'm wondering if rgdal development team can provide functions
> > that
> > > utilize new GDAL multi-dimensional APIs and tools that support [1] in
> the
> > > future release.
> > >
> > >
> > >   Sincerely,
> > >
> > >
> > >
> > > [0] https://hdfeos.org/software/r.php
> > > <https://www.hdfeos.org/software/r.php>
> > >
> > > [1]
> > >
> >
> https://gdal.org/user/multidim_raster_data_model.html#multidim-raster-data-model
> > >
> > >
> > > [2] https://hdfeos.org/zoo/LAADS_MOD_py.php
> > >
> > >
> > > --
> > > Datafy everything in HDF for faster AI.
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Edzer Pebesma
> > Institute for Geoinformatics
> > Heisenbergstrasse 2, 48149 Muenster, Germany
> > Phone: +49 251 8333081
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun 27 15:07:03 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 27 Jun 2020 15:07:03 +0200
Subject: [R-sig-Geo] New GDAL multi-dimensional array support?
In-Reply-To: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
References: <CADeM3-wRF8FZ_DugFgjZBCYhm9W2fbHuj4pt+Jfn8VWY306mXQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006271503130.2916930@reclus.nhh.no>

On Fri, 26 Jun 2020, H. Joe Lee wrote:

> Hi,
>
>
>  My name is H. Joe Lee who maintains a rgdal website [0] to help rgdal
> users to access NASA Earthdata easily.
>
>
>  Recently, GDAL 3.1.0 added a multi-dimensional raster model [1] and two
> new command line interface tools - gdalmdiminfo & gdalmdimtranslate. They
> significantly increase the usability of NASA Earthdata in HDF like MOD35
> product [2] by allowing users to subset and transpose data easily.
>
>
>
>  Thus, I'm wondering if rgdal development team can provide functions that
> utilize new GDAL multi-dimensional APIs and tools that support [1] in the
> future release.

As you will have gathered, rgdal is suitable for multiband raster. Other 
packages provide array data models. There is no rgdal development team, 
only the maintainer (an academic on the verge of retiring). rgdal is in 
maintenance mode only, permitting packages using rgdal through raster to 
migrate to terra, and packages using rgdal/sp classes to migrate to stars 
and friends.

Roger

>
>
>  Sincerely,
>
>
>
> [0] https://hdfeos.org/software/r.php
> <https://www.hdfeos.org/software/r.php>
>
> [1]
> https://gdal.org/user/multidim_raster_data_model.html#multidim-raster-data-model
>
>
> [2] https://hdfeos.org/zoo/LAADS_MOD_py.php
>
>
> --
> Datafy everything in HDF for faster AI.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From vero@ndreo @end|ng |rom gm@||@com  Sat Jun 27 21:29:35 2020
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Sat, 27 Jun 2020 21:29:35 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
Message-ID: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>

Hello everyone

I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
6) and when updating my R packages, I get the following error for rgdal.
Can someone help me out here? What does it mean that it cannot run C++
compiled programs?  And do I want to crosscompile?

Thanks much in advance

Vero

---

install.packages("rgdal")
Installing package into
?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
(as ?lib? is unspecified)
trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
==================================================
downloaded 2.2 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
** using staged installation
configure: R_HOME: /usr/lib64/R
configure: CC: gcc -m64
configure: CXX: g++ -m64 -std=gnu++11
configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
configure: CXX is: g++ -m64 -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-12
checking for /usr/bin/svnversion... yes
configure: svn revision: 1018
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.0.4
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking GDAL: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.3.2
configure: PROJ CPP flags: -DPROJ_H_API
configure: PROJ LIBS: -lproj
checking PROJ header API:... yes
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in
`/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
configure: error: cannot run C++ compiled programs. <<<<--- here
If you meant to cross compile, use `--host'.
See `config.log' for more details
ERROR: configuration failed for package ?rgdal?
* removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
* restoring previous
?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
Warning in install.packages :
  installation of package ?rgdal? had non-zero exit status

---

sessionInfo()
R version 3.6.3 (2020-02-29)
Platform: x86_64-redhat-linux-gnu (64-bit)
Running under: Fedora 32 (Thirty Two)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so

Random number generation:
 RNG:     Mersenne-Twister
 Normal:  Inversion
 Sample:  Rounding

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_3.6.3 tools_3.6.3

	[[alternative HTML version deleted]]


From vero@ndreo @end|ng |rom gm@||@com  Sat Jun 27 22:54:23 2020
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Sat, 27 Jun 2020 22:54:23 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
Message-ID: <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>

See the attached config.log file

El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo (<veroandreo at gmail.com>)
escribi?:

> Hello everyone
>
> I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
> 6) and when updating my R packages, I get the following error for rgdal.
> Can someone help me out here? What does it mean that it cannot run C++
> compiled programs?  And do I want to crosscompile?
>
> Thanks much in advance
>
> Vero
>
> ---
>
> install.packages("rgdal")
> Installing package into
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> (as ?lib? is unspecified)
> trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> ==================================================
> downloaded 2.2 MB
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /usr/lib64/R
> configure: CC: gcc -m64
> configure: CXX: g++ -m64 -std=gnu++11
> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> configure: CXX is: g++ -m64 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-12
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 1018
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.0.4
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.2
> configure: PROJ CPP flags: -DPROJ_H_API
> configure: PROJ LIBS: -lproj
> checking PROJ header API:... yes
> checking whether the C++ compiler works... yes
> checking for C++ compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> configure: error: cannot run C++ compiled programs. <<<<--- here
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> * restoring previous
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> Warning in install.packages :
>   installation of package ?rgdal? had non-zero exit status
>
> ---
>
> sessionInfo()
> R version 3.6.3 (2020-02-29)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> Running under: Fedora 32 (Thirty Two)
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>
> Random number generation:
>  RNG:     Mersenne-Twister
>  Normal:  Inversion
>  Sample:  Rounding
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_3.6.3 tools_3.6.3
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200627/97f66de5/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: config.log
Type: text/x-log
Size: 8207 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200627/97f66de5/attachment.bin>

From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 28 08:40:12 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 28 Jun 2020 08:40:12 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>

Vero,

On Sat, 27 Jun 2020, Veronica Andreo wrote:

> See the attached config.log file
>

How did you install R itself? If an rpm, then

https://github.com/r-spatial/sf/issues/1369

may be relevant, also if you see errors installing sf. You would need to 
unset LDFLAGS before installing:

https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865

Please report back on this.

Roger

> El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo (<veroandreo at gmail.com>)
> escribi?:
>
>> Hello everyone
>>
>> I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
>> 6) and when updating my R packages, I get the following error for rgdal.
>> Can someone help me out here? What does it mean that it cannot run C++
>> compiled programs?  And do I want to crosscompile?
>>
>> Thanks much in advance
>>
>> Vero
>>
>> ---
>>
>> install.packages("rgdal")
>> Installing package into
>> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> (as ?lib? is unspecified)
>> trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>> Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>> ==================================================
>> downloaded 2.2 MB
>>
>> * installing *source* package ?rgdal? ...
>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>> ** using staged installation
>> configure: R_HOME: /usr/lib64/R
>> configure: CC: gcc -m64
>> configure: CXX: g++ -m64 -std=gnu++11
>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> configure: CXX is: g++ -m64 -std=gnu++11
>> configure: C++11 support available
>> configure: rgdal: 1.5-12
>> checking for /usr/bin/svnversion... yes
>> configure: svn revision: 1018
>> checking for gdal-config... /usr/bin/gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 3.0.4
>> checking GDAL version >= 1.11.4... yes
>> checking GDAL version <= 2.5 or >= 3.0... yes
>> checking GDAL: linking with --libs only... yes
>> checking GDAL: gdal-config data directory readable... yes
>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> configure: pkg-config proj exists, will use it
>> configure: PROJ version: 6.3.2
>> configure: PROJ CPP flags: -DPROJ_H_API
>> configure: PROJ LIBS: -lproj
>> checking PROJ header API:... yes
>> checking whether the C++ compiler works... yes
>> checking for C++ compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... configure: error: in
>> `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>> configure: error: cannot run C++ compiled programs. <<<<--- here
>> If you meant to cross compile, use `--host'.
>> See `config.log' for more details
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> * restoring previous
>> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> Warning in install.packages :
>>   installation of package ?rgdal? had non-zero exit status
>>
>> ---
>>
>> sessionInfo()
>> R version 3.6.3 (2020-02-29)
>> Platform: x86_64-redhat-linux-gnu (64-bit)
>> Running under: Fedora 32 (Thirty Two)
>>
>> Matrix products: default
>> BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>
>> Random number generation:
>>  RNG:     Mersenne-Twister
>>  Normal:  Inversion
>>  Sample:  Rounding
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_3.6.3 tools_3.6.3
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 28 14:44:02 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 28 Jun 2020 14:44:02 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
Message-ID: <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>

On Sun, 28 Jun 2020, Roger Bivand wrote:

> Vero,
>
> On Sat, 27 Jun 2020, Veronica Andreo wrote:
>
>>  See the attached config.log file
>> 
>
> How did you install R itself? If an rpm, then
>
> https://github.com/r-spatial/sf/issues/1369
>
> may be relevant, also if you see errors installing sf. You would need to 
> unset LDFLAGS before installing:
>
> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>
> Please report back on this.

LDFLAGS needs unsetting. Revision 1020 on R-Forge

https://r-forge.r-project.org/R/?group_id=884

includes a new configure argument --disable-loadflags to assist in 
unsetting the very specific R rpm LDFLAGS. Please report if this fixes the 
problem.

Roger


>
> Roger
>
>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>  (<veroandreo at gmail.com>)
>>  escribi?:
>>
>>>  Hello everyone
>>>
>>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
>>>  6) and when updating my R packages, I get the following error for rgdal.
>>>  Can someone help me out here? What does it mean that it cannot run C++
>>>  compiled programs?  And do I want to crosscompile?
>>>
>>>  Thanks much in advance
>>>
>>>  Vero
>>>
>>>  ---
>>>
>>>  install.packages("rgdal")
>>>  Installing package into
>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>  (as ?lib? is unspecified)
>>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>  ==================================================
>>>  downloaded 2.2 MB
>>>
>>>  * installing *source* package ?rgdal? ...
>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>  ** using staged installation
>>> configure:  R_HOME: /usr/lib64/R
>>> configure:  CC: gcc -m64
>>> configure:  CXX: g++ -m64 -std=gnu++11
>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>> configure:  C++11 support available
>>> configure:  rgdal: 1.5-12
>>>  checking for /usr/bin/svnversion... yes
>>> configure:  svn revision: 1018
>>>  checking for gdal-config... /usr/bin/gdal-config
>>>  checking gdal-config usability... yes
>>> configure:  GDAL: 3.0.4
>>>  checking GDAL version >= 1.11.4... yes
>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>  checking GDAL: linking with --libs only... yes
>>>  checking GDAL: gdal-config data directory readable... yes
>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>> configure:  pkg-config proj exists, will use it
>>> configure:  PROJ version: 6.3.2
>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>> configure:  PROJ LIBS: -lproj
>>>  checking PROJ header API:... yes
>>>  checking whether the C++ compiler works... yes
>>>  checking for C++ compiler default output file name... a.out
>>>  checking for suffix of executables...
>>>  checking whether we are cross compiling... configure: error: in
>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>>>  If you meant to cross compile, use `--host'.
>>>  See `config.log' for more details
>>>  ERROR: configuration failed for package ?rgdal?
>>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>  * restoring previous
>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>  Warning in install.packages :
>>>    installation of package ?rgdal? had non-zero exit status
>>>
>>>  ---
>>>
>>>  sessionInfo()
>>>  R version 3.6.3 (2020-02-29)
>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>>>  Running under: Fedora 32 (Thirty Two)
>>>
>>>  Matrix products: default
>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>
>>>  Random number generation:
>>>   RNG:     Mersenne-Twister
>>>   Normal:  Inversion
>>>   Sample:  Rounding
>>>
>>>  locale:
>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>>  attached base packages:
>>>  [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>>  loaded via a namespace (and not attached):
>>>  [1] compiler_3.6.3 tools_3.6.3
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From vero@ndreo @end|ng |rom gm@||@com  Sun Jun 28 15:41:39 2020
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Sun, 28 Jun 2020 15:41:39 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
Message-ID: <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>

Dear Roger,

Thanks for the answer.

R is installed from Fedora repos and no, I do not have any issues with sf.
It installs and loads just fine.

I downloaded the new rgdal tar.gz from R-forge, but I get the same error
that was reported yesterday; config.log file attached. The first error I
see there is in line 98-99 about a -V not recognized and then another one
for -qversion. Are those relevant?

Vero
---
install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type =
"source")
Installing package into
?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
(as ?lib? is unspecified)
* installing *source* package ?rgdal? ...
** using staged installation
configure: R_HOME: /usr/lib64/R
configure: CC: gcc -m64
configure: CXX: g++ -m64 -std=gnu++11
configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
-Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
-fstack-protector-strong -grecord-gcc-switches
-specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
-specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
-fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
configure: CPPFLAGS: -I/usr/local/include
configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
-specs=/usr/lib/rpm/redhat/redhat-hardened-ld
loadflags: yes
configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
-specs=/usr/lib/rpm/redhat/redhat-hardened-ld
configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
configure: CXX is: g++ -m64 -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-13
checking for /usr/bin/svnversion... yes
cat: inst/SVN_VERSION: No such file or directory
configure: svn revision:
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.0.4
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking GDAL: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.3.2
configure: PROJ CPP flags: -DPROJ_H_API
configure: PROJ LIBS: -lproj
checking PROJ header API:... yes
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in
`/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
configure: error: cannot run C++ compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details
ERROR: configuration failed for package ?rgdal?
* removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
Warning in install.packages :
  installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz?
had non-zero exit status



El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
escribi?:

> On Sun, 28 Jun 2020, Roger Bivand wrote:
>
> > Vero,
> >
> > On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >
> >>  See the attached config.log file
> >>
> >
> > How did you install R itself? If an rpm, then
> >
> > https://github.com/r-spatial/sf/issues/1369
> >
> > may be relevant, also if you see errors installing sf. You would need to
> > unset LDFLAGS before installing:
> >
> > https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >
> > Please report back on this.
>
> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>
> https://r-forge.r-project.org/R/?group_id=884
>
> includes a new configure argument --disable-loadflags to assist in
> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
> problem.
>
> Roger
>
>
> >
> > Roger
> >
> >>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >>  (<veroandreo at gmail.com>)
> >>  escribi?:
> >>
> >>>  Hello everyone
> >>>
> >>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and
> PROJ
> >>>  6) and when updating my R packages, I get the following error for
> rgdal.
> >>>  Can someone help me out here? What does it mean that it cannot run C++
> >>>  compiled programs?  And do I want to crosscompile?
> >>>
> >>>  Thanks much in advance
> >>>
> >>>  Vero
> >>>
> >>>  ---
> >>>
> >>>  install.packages("rgdal")
> >>>  Installing package into
> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>  (as ?lib? is unspecified)
> >>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >>>  ==================================================
> >>>  downloaded 2.2 MB
> >>>
> >>>  * installing *source* package ?rgdal? ...
> >>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>  ** using staged installation
> >>> configure:  R_HOME: /usr/lib64/R
> >>> configure:  CC: gcc -m64
> >>> configure:  CXX: g++ -m64 -std=gnu++11
> >>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>> configure:  C++11 support available
> >>> configure:  rgdal: 1.5-12
> >>>  checking for /usr/bin/svnversion... yes
> >>> configure:  svn revision: 1018
> >>>  checking for gdal-config... /usr/bin/gdal-config
> >>>  checking gdal-config usability... yes
> >>> configure:  GDAL: 3.0.4
> >>>  checking GDAL version >= 1.11.4... yes
> >>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>  checking GDAL: linking with --libs only... yes
> >>>  checking GDAL: gdal-config data directory readable... yes
> >>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>> configure:  pkg-config proj exists, will use it
> >>> configure:  PROJ version: 6.3.2
> >>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>> configure:  PROJ LIBS: -lproj
> >>>  checking PROJ header API:... yes
> >>>  checking whether the C++ compiler works... yes
> >>>  checking for C++ compiler default output file name... a.out
> >>>  checking for suffix of executables...
> >>>  checking whether we are cross compiling... configure: error: in
> >>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >>> configure:  error: cannot run C++ compiled programs. <<<<--- here
> >>>  If you meant to cross compile, use `--host'.
> >>>  See `config.log' for more details
> >>>  ERROR: configuration failed for package ?rgdal?
> >>>  * removing
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>  * restoring previous
> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>  Warning in install.packages :
> >>>    installation of package ?rgdal? had non-zero exit status
> >>>
> >>>  ---
> >>>
> >>>  sessionInfo()
> >>>  R version 3.6.3 (2020-02-29)
> >>>  Platform: x86_64-redhat-linux-gnu (64-bit)
> >>>  Running under: Fedora 32 (Thirty Two)
> >>>
> >>>  Matrix products: default
> >>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >>>
> >>>  Random number generation:
> >>>   RNG:     Mersenne-Twister
> >>>   Normal:  Inversion
> >>>   Sample:  Rounding
> >>>
> >>>  locale:
> >>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>
> >>>  attached base packages:
> >>>  [1] stats     graphics  grDevices utils     datasets  methods   base
> >>>
> >>>  loaded via a namespace (and not attached):
> >>>  [1] compiler_3.6.3 tools_3.6.3
> >>>
> >>
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200628/d2e3eca7/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: config.log
Type: text/x-log
Size: 8624 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200628/d2e3eca7/attachment.bin>

From |epennec @end|ng |rom gm@||@com  Sun Jun 28 15:46:00 2020
From: |epennec @end|ng |rom gm@||@com (Erwan LE PENNEC)
Date: Sun, 28 Jun 2020 15:46:00 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
Message-ID: <CALHdWxJPYwMG=unQh-xY7+sRfJqzoUDR4w8FF8DtEcwgcNU1dw@mail.gmail.com>

Using the new --disable-loadflags in install.packages:
install.packages("rgdal_1.5-13.tar.gz", repos = NULL, type = "source",
configure.args = "--disable-loadflags")
should solve the issue.

Erwan

On Sun, Jun 28, 2020 at 3:42 PM Veronica Andreo <veroandreo at gmail.com>
wrote:

> Dear Roger,
>
> Thanks for the answer.
>
> R is installed from Fedora repos and no, I do not have any issues with sf.
> It installs and loads just fine.
>
> I downloaded the new rgdal tar.gz from R-forge, but I get the same error
> that was reported yesterday; config.log file attached. The first error I
> see there is in line 98-99 about a -V not recognized and then another one
> for -qversion. Are those relevant?
>
> Vero
> ---
> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type =
> "source")
> Installing package into
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> (as ?lib? is unspecified)
> * installing *source* package ?rgdal? ...
> ** using staged installation
> configure: R_HOME: /usr/lib64/R
> configure: CC: gcc -m64
> configure: CXX: g++ -m64 -std=gnu++11
> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
> -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
> -fstack-protector-strong -grecord-gcc-switches
> -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
> -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
> -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> configure: CPPFLAGS: -I/usr/local/include
> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> loadflags: yes
> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> configure: CXX is: g++ -m64 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-13
> checking for /usr/bin/svnversion... yes
> cat: inst/SVN_VERSION: No such file or directory
> configure: svn revision:
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.0.4
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.2
> configure: PROJ CPP flags: -DPROJ_H_API
> configure: PROJ LIBS: -lproj
> checking PROJ header API:... yes
> checking whether the C++ compiler works... yes
> checking for C++ compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> configure: error: cannot run C++ compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> Warning in install.packages :
>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz?
> had non-zero exit status
>
>
>
> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
> escribi?:
>
>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>>
>> > Vero,
>> >
>> > On Sat, 27 Jun 2020, Veronica Andreo wrote:
>> >
>> >>  See the attached config.log file
>> >>
>> >
>> > How did you install R itself? If an rpm, then
>> >
>> > https://github.com/r-spatial/sf/issues/1369
>> >
>> > may be relevant, also if you see errors installing sf. You would need
>> to
>> > unset LDFLAGS before installing:
>> >
>> > https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>> >
>> > Please report back on this.
>>
>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>
>> https://r-forge.r-project.org/R/?group_id=884
>>
>> includes a new configure argument --disable-loadflags to assist in
>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes
>> the
>> problem.
>>
>> Roger
>>
>>
>> >
>> > Roger
>> >
>> >>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>> >>  (<veroandreo at gmail.com>)
>> >>  escribi?:
>> >>
>> >>>  Hello everyone
>> >>>
>> >>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and
>> PROJ
>> >>>  6) and when updating my R packages, I get the following error for
>> rgdal.
>> >>>  Can someone help me out here? What does it mean that it cannot run
>> C++
>> >>>  compiled programs?  And do I want to crosscompile?
>> >>>
>> >>>  Thanks much in advance
>> >>>
>> >>>  Vero
>> >>>
>> >>>  ---
>> >>>
>> >>>  install.packages("rgdal")
>> >>>  Installing package into
>> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> >>>  (as ?lib? is unspecified)
>> >>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>> >>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>> >>>  ==================================================
>> >>>  downloaded 2.2 MB
>> >>>
>> >>>  * installing *source* package ?rgdal? ...
>> >>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>> >>>  ** using staged installation
>> >>> configure:  R_HOME: /usr/lib64/R
>> >>> configure:  CC: gcc -m64
>> >>> configure:  CXX: g++ -m64 -std=gnu++11
>> >>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> >>> configure:  CXX is: g++ -m64 -std=gnu++11
>> >>> configure:  C++11 support available
>> >>> configure:  rgdal: 1.5-12
>> >>>  checking for /usr/bin/svnversion... yes
>> >>> configure:  svn revision: 1018
>> >>>  checking for gdal-config... /usr/bin/gdal-config
>> >>>  checking gdal-config usability... yes
>> >>> configure:  GDAL: 3.0.4
>> >>>  checking GDAL version >= 1.11.4... yes
>> >>>  checking GDAL version <= 2.5 or >= 3.0... yes
>> >>>  checking GDAL: linking with --libs only... yes
>> >>>  checking GDAL: gdal-config data directory readable... yes
>> >>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> >>> configure:  pkg-config proj exists, will use it
>> >>> configure:  PROJ version: 6.3.2
>> >>> configure:  PROJ CPP flags: -DPROJ_H_API
>> >>> configure:  PROJ LIBS: -lproj
>> >>>  checking PROJ header API:... yes
>> >>>  checking whether the C++ compiler works... yes
>> >>>  checking for C++ compiler default output file name... a.out
>> >>>  checking for suffix of executables...
>> >>>  checking whether we are cross compiling... configure: error: in
>> >>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>> >>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>> >>>  If you meant to cross compile, use `--host'.
>> >>>  See `config.log' for more details
>> >>>  ERROR: configuration failed for package ?rgdal?
>> >>>  * removing
>> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>  * restoring previous
>> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>  Warning in install.packages :
>> >>>    installation of package ?rgdal? had non-zero exit status
>> >>>
>> >>>  ---
>> >>>
>> >>>  sessionInfo()
>> >>>  R version 3.6.3 (2020-02-29)
>> >>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>> >>>  Running under: Fedora 32 (Thirty Two)
>> >>>
>> >>>  Matrix products: default
>> >>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>> >>>
>> >>>  Random number generation:
>> >>>   RNG:     Mersenne-Twister
>> >>>   Normal:  Inversion
>> >>>   Sample:  Rounding
>> >>>
>> >>>  locale:
>> >>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> >>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> >>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> >>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> >>>
>> >>>  attached base packages:
>> >>>  [1] stats     graphics  grDevices utils     datasets  methods   base
>> >>>
>> >>>  loaded via a namespace (and not attached):
>> >>>  [1] compiler_3.6.3 tools_3.6.3
>> >>>
>> >>
>> >
>> >
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From |@t@z@hn @end|ng |rom gm@||@com  Sun Jun 28 18:55:52 2020
From: |@t@z@hn @end|ng |rom gm@||@com (Ista Zahn)
Date: Sun, 28 Jun 2020 12:55:52 -0400
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
Message-ID: <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>

I can reproduce this error using the official Fedora 32 docker image:

docker run -it library/fedora:32
dnf install 'dnf-command(builddep)'
dnf builddep R-rgdal
R
install.packages("rgdal")

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
** using staged installation
configure: R_HOME: /usr/lib64/R
configure: CC: gcc -m64
configure: CXX: g++ -m64 -std=gnu++11
configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
configure: CXX is: g++ -m64 -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-12
checking for /usr/bin/svnversion... no
configure: svn revision: 1018
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.0.4
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking GDAL: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.3.2
configure: PROJ CPP flags: -DPROJ_H_API
configure: PROJ LIBS: -lproj
checking PROJ header API:... yes
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in
`/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
configure: error: cannot run C++ compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/lib64/R/library/rgdal?

The downloaded source packages are in
        ?/tmp/RtmpooFgiH/downloaded_packages?
Updating HTML index of packages in '.Library'
Warning messages:
1: In install.packages("rgdal") :
  installation of package ?rgdal? had non-zero exit status
2: In file.create(f.tg) :
  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
such file or directory'
3: In make.packages.html(.Library) : cannot update HTML package index
>

I don't have any insight into what happens here, but it is reproducible.

Best,
Ista

On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com> wrote:
>
> Dear Roger,
>
> Thanks for the answer.
>
> R is installed from Fedora repos and no, I do not have any issues with sf. It installs and loads just fine.
>
> I downloaded the new rgdal tar.gz from R-forge, but I get the same error that was reported yesterday; config.log file attached. The first error I see there is in line 98-99 about a -V not recognized and then another one for -qversion. Are those relevant?
>
> Vero
> ---
> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type = "source")
> Installing package into ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> (as ?lib? is unspecified)
> * installing *source* package ?rgdal? ...
> ** using staged installation
> configure: R_HOME: /usr/lib64/R
> configure: CC: gcc -m64
> configure: CXX: g++ -m64 -std=gnu++11
> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> configure: CPPFLAGS: -I/usr/local/include
> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> loadflags: yes
> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> configure: CXX is: g++ -m64 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-13
> checking for /usr/bin/svnversion... yes
> cat: inst/SVN_VERSION: No such file or directory
> configure: svn revision:
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.0.4
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.2
> configure: PROJ CPP flags: -DPROJ_H_API
> configure: PROJ LIBS: -lproj
> checking PROJ header API:... yes
> checking whether the C++ compiler works... yes
> checking for C++ compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> configure: error: cannot run C++ compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> Warning in install.packages :
>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
>
>
>
> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
>>
>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>>
>> > Vero,
>> >
>> > On Sat, 27 Jun 2020, Veronica Andreo wrote:
>> >
>> >>  See the attached config.log file
>> >>
>> >
>> > How did you install R itself? If an rpm, then
>> >
>> > https://github.com/r-spatial/sf/issues/1369
>> >
>> > may be relevant, also if you see errors installing sf. You would need to
>> > unset LDFLAGS before installing:
>> >
>> > https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>> >
>> > Please report back on this.
>>
>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>
>> https://r-forge.r-project.org/R/?group_id=884
>>
>> includes a new configure argument --disable-loadflags to assist in
>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
>> problem.
>>
>> Roger
>>
>>
>> >
>> > Roger
>> >
>> >>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>> >>  (<veroandreo at gmail.com>)
>> >>  escribi?:
>> >>
>> >>>  Hello everyone
>> >>>
>> >>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
>> >>>  6) and when updating my R packages, I get the following error for rgdal.
>> >>>  Can someone help me out here? What does it mean that it cannot run C++
>> >>>  compiled programs?  And do I want to crosscompile?
>> >>>
>> >>>  Thanks much in advance
>> >>>
>> >>>  Vero
>> >>>
>> >>>  ---
>> >>>
>> >>>  install.packages("rgdal")
>> >>>  Installing package into
>> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> >>>  (as ?lib? is unspecified)
>> >>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>> >>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>> >>>  ==================================================
>> >>>  downloaded 2.2 MB
>> >>>
>> >>>  * installing *source* package ?rgdal? ...
>> >>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>> >>>  ** using staged installation
>> >>> configure:  R_HOME: /usr/lib64/R
>> >>> configure:  CC: gcc -m64
>> >>> configure:  CXX: g++ -m64 -std=gnu++11
>> >>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> >>> configure:  CXX is: g++ -m64 -std=gnu++11
>> >>> configure:  C++11 support available
>> >>> configure:  rgdal: 1.5-12
>> >>>  checking for /usr/bin/svnversion... yes
>> >>> configure:  svn revision: 1018
>> >>>  checking for gdal-config... /usr/bin/gdal-config
>> >>>  checking gdal-config usability... yes
>> >>> configure:  GDAL: 3.0.4
>> >>>  checking GDAL version >= 1.11.4... yes
>> >>>  checking GDAL version <= 2.5 or >= 3.0... yes
>> >>>  checking GDAL: linking with --libs only... yes
>> >>>  checking GDAL: gdal-config data directory readable... yes
>> >>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> >>> configure:  pkg-config proj exists, will use it
>> >>> configure:  PROJ version: 6.3.2
>> >>> configure:  PROJ CPP flags: -DPROJ_H_API
>> >>> configure:  PROJ LIBS: -lproj
>> >>>  checking PROJ header API:... yes
>> >>>  checking whether the C++ compiler works... yes
>> >>>  checking for C++ compiler default output file name... a.out
>> >>>  checking for suffix of executables...
>> >>>  checking whether we are cross compiling... configure: error: in
>> >>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>> >>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>> >>>  If you meant to cross compile, use `--host'.
>> >>>  See `config.log' for more details
>> >>>  ERROR: configuration failed for package ?rgdal?
>> >>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>  * restoring previous
>> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>  Warning in install.packages :
>> >>>    installation of package ?rgdal? had non-zero exit status
>> >>>
>> >>>  ---
>> >>>
>> >>>  sessionInfo()
>> >>>  R version 3.6.3 (2020-02-29)
>> >>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>> >>>  Running under: Fedora 32 (Thirty Two)
>> >>>
>> >>>  Matrix products: default
>> >>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>> >>>
>> >>>  Random number generation:
>> >>>   RNG:     Mersenne-Twister
>> >>>   Normal:  Inversion
>> >>>   Sample:  Rounding
>> >>>
>> >>>  locale:
>> >>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> >>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> >>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> >>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> >>>
>> >>>  attached base packages:
>> >>>  [1] stats     graphics  grDevices utils     datasets  methods   base
>> >>>
>> >>>  loaded via a namespace (and not attached):
>> >>>  [1] compiler_3.6.3 tools_3.6.3
>> >>>
>> >>
>> >
>> >
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vero@ndreo @end|ng |rom gm@||@com  Sun Jun 28 19:08:02 2020
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Sun, 28 Jun 2020 19:08:02 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAB2ovovkM6BkDb-QYUm-eJFz7JGB=OELbQGNkkktn-gtNvfSQw@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CAB2ovovkM6BkDb-QYUm-eJFz7JGB=OELbQGNkkktn-gtNvfSQw@mail.gmail.com>
Message-ID: <CAAMki4HmY55gPa-+pNXTG1pmEP6ve__Jv21UU-b9+gYYy+ZwtA@mail.gmail.com>

Hi Bennet,
[cc-ing the list too]

Thanks for the explanations about the config.log file

I tried with your suggestion, but the error still appears as originally
reported

Best,
Vero

El dom., 28 jun. 2020 a las 17:00, Bennet Fauber (<bennet at umich.edu>)
escribi?:

> Hi, Vero,
>
> Your Fedora is using GCC version 10, which is newer and may have
> changed options.  Just to help you with reading the config.log, this
> is the part that matters here.
>
> #---  The following line is the command that configure is actually running
> configure:3006: g++ -m64 -std=gnu++11 -o conftest
> -I/usr/local/include -DPROJ_H_API   -Wl,-z,relro -Wl,--as-needed
> -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld conftest.cpp
> -lproj     -L/usr/lib64 -lgdal >&5/usr/bin/ld: /home/veroandreo
>
> #--- This is the error that it generated
> /tmp/ccNranTE.o: relocation R_X86_64_32 against `.rodata' can not be
> used when making a PIE object; recompile with -fPIE
>
> #--- This is configure telling you that an error occured, but not what it
> is
> collect2: error: ld returned 1 exit status
>
> #--- If the g++ command had succeeded, there would be a program file
> called 'conftest' that it could run
> configure:3017: ./conftest
> configure: line 3019: ./conftest: No such file or directory
>
> I will take a wild stab in the dark and suggest you try
>
> > install.packages('rgdal', configure.vars=c("CXXFLAGS=-no-pie"))
>
>
>
> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
> wrote:
> >
> > Dear Roger,
> >
> > Thanks for the answer.
> >
> > R is installed from Fedora repos and no, I do not have any issues with
> sf. It installs and loads just fine.
> >
> > I downloaded the new rgdal tar.gz from R-forge, but I get the same error
> that was reported yesterday; config.log file attached. The first error I
> see there is in line 98-99 about a -V not recognized and then another one
> for -qversion. Are those relevant?
> >
> > Vero
> > ---
> > install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type =
> "source")
> > Installing package into
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> > (as ?lib? is unspecified)
> > * installing *source* package ?rgdal? ...
> > ** using staged installation
> > configure: R_HOME: /usr/lib64/R
> > configure: CC: gcc -m64
> > configure: CXX: g++ -m64 -std=gnu++11
> > configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
> -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
> -fstack-protector-strong -grecord-gcc-switches
> -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
> -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
> -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> > configure: CPPFLAGS: -I/usr/local/include
> > configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> > loadflags: yes
> > configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> > configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> > configure: CXX is: g++ -m64 -std=gnu++11
> > configure: C++11 support available
> > configure: rgdal: 1.5-13
> > checking for /usr/bin/svnversion... yes
> > cat: inst/SVN_VERSION: No such file or directory
> > configure: svn revision:
> > checking for gdal-config... /usr/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 3.0.4
> > checking GDAL version >= 1.11.4... yes
> > checking GDAL version <= 2.5 or >= 3.0... yes
> > checking GDAL: linking with --libs only... yes
> > checking GDAL: gdal-config data directory readable... yes
> > checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> > configure: pkg-config proj exists, will use it
> > configure: PROJ version: 6.3.2
> > configure: PROJ CPP flags: -DPROJ_H_API
> > configure: PROJ LIBS: -lproj
> > checking PROJ header API:... yes
> > checking whether the C++ compiler works... yes
> > checking for C++ compiler default output file name... a.out
> > checking for suffix of executables...
> > checking whether we are cross compiling... configure: error: in
> `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> > configure: error: cannot run C++ compiled programs.
> > If you meant to cross compile, use `--host'.
> > See `config.log' for more details
> > ERROR: configuration failed for package ?rgdal?
> > * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> > Warning in install.packages :
> >   installation of package
> ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
> >
> >
> >
> > El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
> escribi?:
> >>
> >> On Sun, 28 Jun 2020, Roger Bivand wrote:
> >>
> >> > Vero,
> >> >
> >> > On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >> >
> >> >>  See the attached config.log file
> >> >>
> >> >
> >> > How did you install R itself? If an rpm, then
> >> >
> >> > https://github.com/r-spatial/sf/issues/1369
> >> >
> >> > may be relevant, also if you see errors installing sf. You would need
> to
> >> > unset LDFLAGS before installing:
> >> >
> >> > https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >> >
> >> > Please report back on this.
> >>
> >> LDFLAGS needs unsetting. Revision 1020 on R-Forge
> >>
> >> https://r-forge.r-project.org/R/?group_id=884
> >>
> >> includes a new configure argument --disable-loadflags to assist in
> >> unsetting the very specific R rpm LDFLAGS. Please report if this fixes
> the
> >> problem.
> >>
> >> Roger
> >>
> >>
> >> >
> >> > Roger
> >> >
> >> >>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >> >>  (<veroandreo at gmail.com>)
> >> >>  escribi?:
> >> >>
> >> >>>  Hello everyone
> >> >>>
> >> >>>  I have just updated my system to fedora 32 (which fetched GDAL 3
> and PROJ
> >> >>>  6) and when updating my R packages, I get the following error for
> rgdal.
> >> >>>  Can someone help me out here? What does it mean that it cannot run
> C++
> >> >>>  compiled programs?  And do I want to crosscompile?
> >> >>>
> >> >>>  Thanks much in advance
> >> >>>
> >> >>>  Vero
> >> >>>
> >> >>>  ---
> >> >>>
> >> >>>  install.packages("rgdal")
> >> >>>  Installing package into
> >> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >> >>>  (as ?lib? is unspecified)
> >> >>>  trying URL '
> http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >> >>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >> >>>  ==================================================
> >> >>>  downloaded 2.2 MB
> >> >>>
> >> >>>  * installing *source* package ?rgdal? ...
> >> >>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >> >>>  ** using staged installation
> >> >>> configure:  R_HOME: /usr/lib64/R
> >> >>> configure:  CC: gcc -m64
> >> >>> configure:  CXX: g++ -m64 -std=gnu++11
> >> >>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >> >>> configure:  CXX is: g++ -m64 -std=gnu++11
> >> >>> configure:  C++11 support available
> >> >>> configure:  rgdal: 1.5-12
> >> >>>  checking for /usr/bin/svnversion... yes
> >> >>> configure:  svn revision: 1018
> >> >>>  checking for gdal-config... /usr/bin/gdal-config
> >> >>>  checking gdal-config usability... yes
> >> >>> configure:  GDAL: 3.0.4
> >> >>>  checking GDAL version >= 1.11.4... yes
> >> >>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >> >>>  checking GDAL: linking with --libs only... yes
> >> >>>  checking GDAL: gdal-config data directory readable... yes
> >> >>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >> >>> configure:  pkg-config proj exists, will use it
> >> >>> configure:  PROJ version: 6.3.2
> >> >>> configure:  PROJ CPP flags: -DPROJ_H_API
> >> >>> configure:  PROJ LIBS: -lproj
> >> >>>  checking PROJ header API:... yes
> >> >>>  checking whether the C++ compiler works... yes
> >> >>>  checking for C++ compiler default output file name... a.out
> >> >>>  checking for suffix of executables...
> >> >>>  checking whether we are cross compiling... configure: error: in
> >> >>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >> >>> configure:  error: cannot run C++ compiled programs. <<<<--- here
> >> >>>  If you meant to cross compile, use `--host'.
> >> >>>  See `config.log' for more details
> >> >>>  ERROR: configuration failed for package ?rgdal?
> >> >>>  * removing
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >> >>>  * restoring previous
> >> >>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >> >>>  Warning in install.packages :
> >> >>>    installation of package ?rgdal? had non-zero exit status
> >> >>>
> >> >>>  ---
> >> >>>
> >> >>>  sessionInfo()
> >> >>>  R version 3.6.3 (2020-02-29)
> >> >>>  Platform: x86_64-redhat-linux-gnu (64-bit)
> >> >>>  Running under: Fedora 32 (Thirty Two)
> >> >>>
> >> >>>  Matrix products: default
> >> >>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >> >>>
> >> >>>  Random number generation:
> >> >>>   RNG:     Mersenne-Twister
> >> >>>   Normal:  Inversion
> >> >>>   Sample:  Rounding
> >> >>>
> >> >>>  locale:
> >> >>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >> >>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >> >>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >> >>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >> >>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >> >>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >> >>>
> >> >>>  attached base packages:
> >> >>>  [1] stats     graphics  grDevices utils     datasets  methods
>  base
> >> >>>
> >> >>>  loaded via a namespace (and not attached):
> >> >>>  [1] compiler_3.6.3 tools_3.6.3
> >> >>>
> >> >>
> >> >
> >> >
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 28 19:17:08 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 28 Jun 2020 19:17:08 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>

On Sun, 28 Jun 2020, Ista Zahn wrote:

> I can reproduce this error using the official Fedora 32 docker image:

The error is in the RPM propagating its LDFLAGS which are  not needed (or 
cause no havoc) in simple tests for C compiler functionality in 
./configure. For the arguably broken R rpm, use either LDFLAGS="" or the 
svn rev. 1020 configure argument --disable-loadflags. The load flags are 
far more than is sensibly needed to check whether the compile train works. 
I have used RH, RHEL and Fedora since the last century, and have always 
installed R from source. Recently, the TexLive packaging system drew in 
(totally unecessarily) a dependency on the R rpm, which I now have to 
avoid using. My rpm:

$ /usr/bin/R CMD config LDFLAGS
-Wl,-z,relro -Wl,--as-needed -Wl,-z,now 
-specs=/usr/lib/rpm/redhat/redhat-hardened-ld

and compiled from source:

$ R CMD config LDFLAGS
-L/usr/local/lib64

Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line 
504 in configure.ac) is unknown for me, hence the need for the workaround.

I advise strongly against binary packaging of rgdal for Linux, and was not 
aware that any such packaging had been attempted. Changes in GDAL and PROJ 
happen fast, and Fedora/Centos etc. have been really slow to update.

If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS 
and can explain why they are needed and how to run a cross platform 
configure script without having to special-case platforms, I'd be mildly 
interested to know. sf has also been through similar trouble as mentioned 
earlier in this thread.

Roger

>
> docker run -it library/fedora:32
> dnf install 'dnf-command(builddep)'
> dnf builddep R-rgdal
> R
> install.packages("rgdal")
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /usr/lib64/R
> configure: CC: gcc -m64
> configure: CXX: g++ -m64 -std=gnu++11
> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> configure: CXX is: g++ -m64 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-12
> checking for /usr/bin/svnversion... no
> configure: svn revision: 1018
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.0.4
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.2
> configure: PROJ CPP flags: -DPROJ_H_API
> configure: PROJ LIBS: -lproj
> checking PROJ header API:... yes
> checking whether the C++ compiler works... yes
> checking for C++ compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
> configure: error: cannot run C++ compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/lib64/R/library/rgdal?
>
> The downloaded source packages are in
>        ?/tmp/RtmpooFgiH/downloaded_packages?
> Updating HTML index of packages in '.Library'
> Warning messages:
> 1: In install.packages("rgdal") :
>  installation of package ?rgdal? had non-zero exit status
> 2: In file.create(f.tg) :
>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
> such file or directory'
> 3: In make.packages.html(.Library) : cannot update HTML package index
>>
>
> I don't have any insight into what happens here, but it is reproducible.
>
> Best,
> Ista
>
> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com> wrote:
>>
>> Dear Roger,
>>
>> Thanks for the answer.
>>
>> R is installed from Fedora repos and no, I do not have any issues with sf. It installs and loads just fine.
>>
>> I downloaded the new rgdal tar.gz from R-forge, but I get the same error that was reported yesterday; config.log file attached. The first error I see there is in line 98-99 about a -V not recognized and then another one for -qversion. Are those relevant?
>>
>> Vero
>> ---
>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type = "source")
>> Installing package into ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> (as ?lib? is unspecified)
>> * installing *source* package ?rgdal? ...
>> ** using staged installation
>> configure: R_HOME: /usr/lib64/R
>> configure: CC: gcc -m64
>> configure: CXX: g++ -m64 -std=gnu++11
>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
>> configure: CPPFLAGS: -I/usr/local/include
>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>> loadflags: yes
>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> configure: CXX is: g++ -m64 -std=gnu++11
>> configure: C++11 support available
>> configure: rgdal: 1.5-13
>> checking for /usr/bin/svnversion... yes
>> cat: inst/SVN_VERSION: No such file or directory
>> configure: svn revision:
>> checking for gdal-config... /usr/bin/gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 3.0.4
>> checking GDAL version >= 1.11.4... yes
>> checking GDAL version <= 2.5 or >= 3.0... yes
>> checking GDAL: linking with --libs only... yes
>> checking GDAL: gdal-config data directory readable... yes
>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> configure: pkg-config proj exists, will use it
>> configure: PROJ version: 6.3.2
>> configure: PROJ CPP flags: -DPROJ_H_API
>> configure: PROJ LIBS: -lproj
>> checking PROJ header API:... yes
>> checking whether the C++ compiler works... yes
>> checking for C++ compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... configure: error: in `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>> configure: error: cannot run C++ compiled programs.
>> If you meant to cross compile, use `--host'.
>> See `config.log' for more details
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> Warning in install.packages :
>>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
>>
>>
>>
>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
>>>
>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>>>
>>>> Vero,
>>>>
>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
>>>>
>>>>>  See the attached config.log file
>>>>>
>>>>
>>>> How did you install R itself? If an rpm, then
>>>>
>>>> https://github.com/r-spatial/sf/issues/1369
>>>>
>>>> may be relevant, also if you see errors installing sf. You would need to
>>>> unset LDFLAGS before installing:
>>>>
>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>>>>
>>>> Please report back on this.
>>>
>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>>
>>> https://r-forge.r-project.org/R/?group_id=884
>>>
>>> includes a new configure argument --disable-loadflags to assist in
>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
>>> problem.
>>>
>>> Roger
>>>
>>>
>>>>
>>>> Roger
>>>>
>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>>>>  (<veroandreo at gmail.com>)
>>>>>  escribi?:
>>>>>
>>>>>>  Hello everyone
>>>>>>
>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
>>>>>>  6) and when updating my R packages, I get the following error for rgdal.
>>>>>>  Can someone help me out here? What does it mean that it cannot run C++
>>>>>>  compiled programs?  And do I want to crosscompile?
>>>>>>
>>>>>>  Thanks much in advance
>>>>>>
>>>>>>  Vero
>>>>>>
>>>>>>  ---
>>>>>>
>>>>>>  install.packages("rgdal")
>>>>>>  Installing package into
>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>  (as ?lib? is unspecified)
>>>>>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>>>>  ==================================================
>>>>>>  downloaded 2.2 MB
>>>>>>
>>>>>>  * installing *source* package ?rgdal? ...
>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>  ** using staged installation
>>>>>> configure:  R_HOME: /usr/lib64/R
>>>>>> configure:  CC: gcc -m64
>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>>> configure:  C++11 support available
>>>>>> configure:  rgdal: 1.5-12
>>>>>>  checking for /usr/bin/svnversion... yes
>>>>>> configure:  svn revision: 1018
>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>>  checking gdal-config usability... yes
>>>>>> configure:  GDAL: 3.0.4
>>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>  checking GDAL: linking with --libs only... yes
>>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>> configure:  pkg-config proj exists, will use it
>>>>>> configure:  PROJ version: 6.3.2
>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>>> configure:  PROJ LIBS: -lproj
>>>>>>  checking PROJ header API:... yes
>>>>>>  checking whether the C++ compiler works... yes
>>>>>>  checking for C++ compiler default output file name... a.out
>>>>>>  checking for suffix of executables...
>>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>>>>>>  If you meant to cross compile, use `--host'.
>>>>>>  See `config.log' for more details
>>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>  * restoring previous
>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>  Warning in install.packages :
>>>>>>    installation of package ?rgdal? had non-zero exit status
>>>>>>
>>>>>>  ---
>>>>>>
>>>>>>  sessionInfo()
>>>>>>  R version 3.6.3 (2020-02-29)
>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>  Running under: Fedora 32 (Thirty Two)
>>>>>>
>>>>>>  Matrix products: default
>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>>>>
>>>>>>  Random number generation:
>>>>>>   RNG:     Mersenne-Twister
>>>>>>   Normal:  Inversion
>>>>>>   Sample:  Rounding
>>>>>>
>>>>>>  locale:
>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>
>>>>>>  attached base packages:
>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>
>>>>>>  loaded via a namespace (and not attached):
>>>>>>  [1] compiler_3.6.3 tools_3.6.3
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 28 19:20:18 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sun, 28 Jun 2020 19:20:18 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4HmY55gPa-+pNXTG1pmEP6ve__Jv21UU-b9+gYYy+ZwtA@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CAB2ovovkM6BkDb-QYUm-eJFz7JGB=OELbQGNkkktn-gtNvfSQw@mail.gmail.com>
 <CAAMki4HmY55gPa-+pNXTG1pmEP6ve__Jv21UU-b9+gYYy+ZwtA@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006281919080.2945762@reclus.nhh.no>

On Sun, 28 Jun 2020, Veronica Andreo wrote:

> Hi Bennet,
> [cc-ing the list too]
>
> Thanks for the explanations about the config.log file
>
> I tried with your suggestion, but the error still appears as originally
> reported

Please try install.packages("rgdal", repos="http://R-Forge.R-project.org", 
configure.args="--disable-loadflags") to be sure to get the current 
version.

Roger

>
> Best,
> Vero
>
> El dom., 28 jun. 2020 a las 17:00, Bennet Fauber (<bennet at umich.edu>)
> escribi?:
>
>> Hi, Vero,
>>
>> Your Fedora is using GCC version 10, which is newer and may have
>> changed options.  Just to help you with reading the config.log, this
>> is the part that matters here.
>>
>> #---  The following line is the command that configure is actually running
>> configure:3006: g++ -m64 -std=gnu++11 -o conftest
>> -I/usr/local/include -DPROJ_H_API   -Wl,-z,relro -Wl,--as-needed
>> -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld conftest.cpp
>> -lproj     -L/usr/lib64 -lgdal >&5/usr/bin/ld: /home/veroandreo
>>
>> #--- This is the error that it generated
>> /tmp/ccNranTE.o: relocation R_X86_64_32 against `.rodata' can not be
>> used when making a PIE object; recompile with -fPIE
>>
>> #--- This is configure telling you that an error occured, but not what it
>> is
>> collect2: error: ld returned 1 exit status
>>
>> #--- If the g++ command had succeeded, there would be a program file
>> called 'conftest' that it could run
>> configure:3017: ./conftest
>> configure: line 3019: ./conftest: No such file or directory
>>
>> I will take a wild stab in the dark and suggest you try
>>
>>> install.packages('rgdal', configure.vars=c("CXXFLAGS=-no-pie"))
>>
>>
>>
>> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
>> wrote:
>>>
>>> Dear Roger,
>>>
>>> Thanks for the answer.
>>>
>>> R is installed from Fedora repos and no, I do not have any issues with
>> sf. It installs and loads just fine.
>>>
>>> I downloaded the new rgdal tar.gz from R-forge, but I get the same error
>> that was reported yesterday; config.log file attached. The first error I
>> see there is in line 98-99 about a -V not recognized and then another one
>> for -qversion. Are those relevant?
>>>
>>> Vero
>>> ---
>>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type =
>> "source")
>>> Installing package into
>> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>> (as ?lib? is unspecified)
>>> * installing *source* package ?rgdal? ...
>>> ** using staged installation
>>> configure: R_HOME: /usr/lib64/R
>>> configure: CC: gcc -m64
>>> configure: CXX: g++ -m64 -std=gnu++11
>>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
>> -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
>> -fstack-protector-strong -grecord-gcc-switches
>> -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
>> -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
>> -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
>>> configure: CPPFLAGS: -I/usr/local/include
>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>> loadflags: yes
>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>> configure: CXX is: g++ -m64 -std=gnu++11
>>> configure: C++11 support available
>>> configure: rgdal: 1.5-13
>>> checking for /usr/bin/svnversion... yes
>>> cat: inst/SVN_VERSION: No such file or directory
>>> configure: svn revision:
>>> checking for gdal-config... /usr/bin/gdal-config
>>> checking gdal-config usability... yes
>>> configure: GDAL: 3.0.4
>>> checking GDAL version >= 1.11.4... yes
>>> checking GDAL version <= 2.5 or >= 3.0... yes
>>> checking GDAL: linking with --libs only... yes
>>> checking GDAL: gdal-config data directory readable... yes
>>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>> configure: pkg-config proj exists, will use it
>>> configure: PROJ version: 6.3.2
>>> configure: PROJ CPP flags: -DPROJ_H_API
>>> configure: PROJ LIBS: -lproj
>>> checking PROJ header API:... yes
>>> checking whether the C++ compiler works... yes
>>> checking for C++ compiler default output file name... a.out
>>> checking for suffix of executables...
>>> checking whether we are cross compiling... configure: error: in
>> `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>>> configure: error: cannot run C++ compiled programs.
>>> If you meant to cross compile, use `--host'.
>>> See `config.log' for more details
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>> Warning in install.packages :
>>>   installation of package
>> ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
>>>
>>>
>>>
>>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
>> escribi?:
>>>>
>>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>>>>
>>>>> Vero,
>>>>>
>>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
>>>>>
>>>>>>  See the attached config.log file
>>>>>>
>>>>>
>>>>> How did you install R itself? If an rpm, then
>>>>>
>>>>> https://github.com/r-spatial/sf/issues/1369
>>>>>
>>>>> may be relevant, also if you see errors installing sf. You would need
>> to
>>>>> unset LDFLAGS before installing:
>>>>>
>>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>>>>>
>>>>> Please report back on this.
>>>>
>>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>>>
>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>
>>>> includes a new configure argument --disable-loadflags to assist in
>>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes
>> the
>>>> problem.
>>>>
>>>> Roger
>>>>
>>>>
>>>>>
>>>>> Roger
>>>>>
>>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>>>>>  (<veroandreo at gmail.com>)
>>>>>>  escribi?:
>>>>>>
>>>>>>>  Hello everyone
>>>>>>>
>>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3
>> and PROJ
>>>>>>>  6) and when updating my R packages, I get the following error for
>> rgdal.
>>>>>>>  Can someone help me out here? What does it mean that it cannot run
>> C++
>>>>>>>  compiled programs?  And do I want to crosscompile?
>>>>>>>
>>>>>>>  Thanks much in advance
>>>>>>>
>>>>>>>  Vero
>>>>>>>
>>>>>>>  ---
>>>>>>>
>>>>>>>  install.packages("rgdal")
>>>>>>>  Installing package into
>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>>  (as ?lib? is unspecified)
>>>>>>>  trying URL '
>> http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>>>>>  ==================================================
>>>>>>>  downloaded 2.2 MB
>>>>>>>
>>>>>>>  * installing *source* package ?rgdal? ...
>>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>>  ** using staged installation
>>>>>>> configure:  R_HOME: /usr/lib64/R
>>>>>>> configure:  CC: gcc -m64
>>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>>>> configure:  C++11 support available
>>>>>>> configure:  rgdal: 1.5-12
>>>>>>>  checking for /usr/bin/svnversion... yes
>>>>>>> configure:  svn revision: 1018
>>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>>>  checking gdal-config usability... yes
>>>>>>> configure:  GDAL: 3.0.4
>>>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>>  checking GDAL: linking with --libs only... yes
>>>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>>> configure:  pkg-config proj exists, will use it
>>>>>>> configure:  PROJ version: 6.3.2
>>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>>>> configure:  PROJ LIBS: -lproj
>>>>>>>  checking PROJ header API:... yes
>>>>>>>  checking whether the C++ compiler works... yes
>>>>>>>  checking for C++ compiler default output file name... a.out
>>>>>>>  checking for suffix of executables...
>>>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>>>>>>>  If you meant to cross compile, use `--host'.
>>>>>>>  See `config.log' for more details
>>>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>>>  * removing
>> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>  * restoring previous
>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>  Warning in install.packages :
>>>>>>>    installation of package ?rgdal? had non-zero exit status
>>>>>>>
>>>>>>>  ---
>>>>>>>
>>>>>>>  sessionInfo()
>>>>>>>  R version 3.6.3 (2020-02-29)
>>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>  Running under: Fedora 32 (Thirty Two)
>>>>>>>
>>>>>>>  Matrix products: default
>>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>>>>>
>>>>>>>  Random number generation:
>>>>>>>   RNG:     Mersenne-Twister
>>>>>>>   Normal:  Inversion
>>>>>>>   Sample:  Rounding
>>>>>>>
>>>>>>>  locale:
>>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>
>>>>>>>  attached base packages:
>>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods
>>  base
>>>>>>>
>>>>>>>  loaded via a namespace (and not attached):
>>>>>>>  [1] compiler_3.6.3 tools_3.6.3
>>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From vero@ndreo @end|ng |rom gm@||@com  Sun Jun 28 19:30:29 2020
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Sun, 28 Jun 2020 19:30:29 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006281919080.2945762@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CAB2ovovkM6BkDb-QYUm-eJFz7JGB=OELbQGNkkktn-gtNvfSQw@mail.gmail.com>
 <CAAMki4HmY55gPa-+pNXTG1pmEP6ve__Jv21UU-b9+gYYy+ZwtA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281919080.2945762@reclus.nhh.no>
Message-ID: <CAAMki4G2O4bTt3AYF8nVQLQ_AUch1iAuEUzLtR+Vg81sFodvyg@mail.gmail.com>

El dom., 28 jun. 2020 a las 19:20, Roger Bivand (<Roger.Bivand at nhh.no>)
escribi?:

> On Sun, 28 Jun 2020, Veronica Andreo wrote:
>
> > Hi Bennet,
> > [cc-ing the list too]
> >
> > Thanks for the explanations about the config.log file
> >
> > I tried with your suggestion, but the error still appears as originally
> > reported
>
> Please try install.packages("rgdal", repos="http://R-Forge.R-project.org",
>
> configure.args="--disable-loadflags") to be sure to get the current
> version.
>

Yes, this works! rgdal is installed properly now :)
I didn't understand how to properly specify the command before, apologies.
And many thanks!!!

Vero


> Roger
>
> >
> > Best,
> > Vero
> >
> > El dom., 28 jun. 2020 a las 17:00, Bennet Fauber (<bennet at umich.edu>)
> > escribi?:
> >
> >> Hi, Vero,
> >>
> >> Your Fedora is using GCC version 10, which is newer and may have
> >> changed options.  Just to help you with reading the config.log, this
> >> is the part that matters here.
> >>
> >> #---  The following line is the command that configure is actually
> running
> >> configure:3006: g++ -m64 -std=gnu++11 -o conftest
> >> -I/usr/local/include -DPROJ_H_API   -Wl,-z,relro -Wl,--as-needed
> >> -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld conftest.cpp
> >> -lproj     -L/usr/lib64 -lgdal >&5/usr/bin/ld: /home/veroandreo
> >>
> >> #--- This is the error that it generated
> >> /tmp/ccNranTE.o: relocation R_X86_64_32 against `.rodata' can not be
> >> used when making a PIE object; recompile with -fPIE
> >>
> >> #--- This is configure telling you that an error occured, but not what
> it
> >> is
> >> collect2: error: ld returned 1 exit status
> >>
> >> #--- If the g++ command had succeeded, there would be a program file
> >> called 'conftest' that it could run
> >> configure:3017: ./conftest
> >> configure: line 3019: ./conftest: No such file or directory
> >>
> >> I will take a wild stab in the dark and suggest you try
> >>
> >>> install.packages('rgdal', configure.vars=c("CXXFLAGS=-no-pie"))
> >>
> >>
> >>
> >> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
> >> wrote:
> >>>
> >>> Dear Roger,
> >>>
> >>> Thanks for the answer.
> >>>
> >>> R is installed from Fedora repos and no, I do not have any issues with
> >> sf. It installs and loads just fine.
> >>>
> >>> I downloaded the new rgdal tar.gz from R-forge, but I get the same
> error
> >> that was reported yesterday; config.log file attached. The first error I
> >> see there is in line 98-99 about a -V not recognized and then another
> one
> >> for -qversion. Are those relevant?
> >>>
> >>> Vero
> >>> ---
> >>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type
> =
> >> "source")
> >>> Installing package into
> >> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>> (as ?lib? is unspecified)
> >>> * installing *source* package ?rgdal? ...
> >>> ** using staged installation
> >>> configure: R_HOME: /usr/lib64/R
> >>> configure: CC: gcc -m64
> >>> configure: CXX: g++ -m64 -std=gnu++11
> >>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
> >> -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
> >> -fstack-protector-strong -grecord-gcc-switches
> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
> >> -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
> >> -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> >>> configure: CPPFLAGS: -I/usr/local/include
> >>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>> loadflags: yes
> >>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>> configure: CXX is: g++ -m64 -std=gnu++11
> >>> configure: C++11 support available
> >>> configure: rgdal: 1.5-13
> >>> checking for /usr/bin/svnversion... yes
> >>> cat: inst/SVN_VERSION: No such file or directory
> >>> configure: svn revision:
> >>> checking for gdal-config... /usr/bin/gdal-config
> >>> checking gdal-config usability... yes
> >>> configure: GDAL: 3.0.4
> >>> checking GDAL version >= 1.11.4... yes
> >>> checking GDAL version <= 2.5 or >= 3.0... yes
> >>> checking GDAL: linking with --libs only... yes
> >>> checking GDAL: gdal-config data directory readable... yes
> >>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>> configure: pkg-config proj exists, will use it
> >>> configure: PROJ version: 6.3.2
> >>> configure: PROJ CPP flags: -DPROJ_H_API
> >>> configure: PROJ LIBS: -lproj
> >>> checking PROJ header API:... yes
> >>> checking whether the C++ compiler works... yes
> >>> checking for C++ compiler default output file name... a.out
> >>> checking for suffix of executables...
> >>> checking whether we are cross compiling... configure: error: in
> >> `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> >>> configure: error: cannot run C++ compiled programs.
> >>> If you meant to cross compile, use `--host'.
> >>> See `config.log' for more details
> >>> ERROR: configuration failed for package ?rgdal?
> >>> * removing
> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>> Warning in install.packages :
> >>>   installation of package
> >> ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit
> status
> >>>
> >>>
> >>>
> >>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no
> >)
> >> escribi?:
> >>>>
> >>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
> >>>>
> >>>>> Vero,
> >>>>>
> >>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >>>>>
> >>>>>>  See the attached config.log file
> >>>>>>
> >>>>>
> >>>>> How did you install R itself? If an rpm, then
> >>>>>
> >>>>> https://github.com/r-spatial/sf/issues/1369
> >>>>>
> >>>>> may be relevant, also if you see errors installing sf. You would need
> >> to
> >>>>> unset LDFLAGS before installing:
> >>>>>
> >>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >>>>>
> >>>>> Please report back on this.
> >>>>
> >>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
> >>>>
> >>>> https://r-forge.r-project.org/R/?group_id=884
> >>>>
> >>>> includes a new configure argument --disable-loadflags to assist in
> >>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes
> >> the
> >>>> problem.
> >>>>
> >>>> Roger
> >>>>
> >>>>
> >>>>>
> >>>>> Roger
> >>>>>
> >>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >>>>>>  (<veroandreo at gmail.com>)
> >>>>>>  escribi?:
> >>>>>>
> >>>>>>>  Hello everyone
> >>>>>>>
> >>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3
> >> and PROJ
> >>>>>>>  6) and when updating my R packages, I get the following error for
> >> rgdal.
> >>>>>>>  Can someone help me out here? What does it mean that it cannot run
> >> C++
> >>>>>>>  compiled programs?  And do I want to crosscompile?
> >>>>>>>
> >>>>>>>  Thanks much in advance
> >>>>>>>
> >>>>>>>  Vero
> >>>>>>>
> >>>>>>>  ---
> >>>>>>>
> >>>>>>>  install.packages("rgdal")
> >>>>>>>  Installing package into
> >>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>>>>>  (as ?lib? is unspecified)
> >>>>>>>  trying URL '
> >> http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >>>>>>>  ==================================================
> >>>>>>>  downloaded 2.2 MB
> >>>>>>>
> >>>>>>>  * installing *source* package ?rgdal? ...
> >>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>>>>>  ** using staged installation
> >>>>>>> configure:  R_HOME: /usr/lib64/R
> >>>>>>> configure:  CC: gcc -m64
> >>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
> >>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>>>>>> configure:  C++11 support available
> >>>>>>> configure:  rgdal: 1.5-12
> >>>>>>>  checking for /usr/bin/svnversion... yes
> >>>>>>> configure:  svn revision: 1018
> >>>>>>>  checking for gdal-config... /usr/bin/gdal-config
> >>>>>>>  checking gdal-config usability... yes
> >>>>>>> configure:  GDAL: 3.0.4
> >>>>>>>  checking GDAL version >= 1.11.4... yes
> >>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>>>>  checking GDAL: linking with --libs only... yes
> >>>>>>>  checking GDAL: gdal-config data directory readable... yes
> >>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>>>>> configure:  pkg-config proj exists, will use it
> >>>>>>> configure:  PROJ version: 6.3.2
> >>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>>>>>> configure:  PROJ LIBS: -lproj
> >>>>>>>  checking PROJ header API:... yes
> >>>>>>>  checking whether the C++ compiler works... yes
> >>>>>>>  checking for C++ compiler default output file name... a.out
> >>>>>>>  checking for suffix of executables...
> >>>>>>>  checking whether we are cross compiling... configure: error: in
> >>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
> >>>>>>>  If you meant to cross compile, use `--host'.
> >>>>>>>  See `config.log' for more details
> >>>>>>>  ERROR: configuration failed for package ?rgdal?
> >>>>>>>  * removing
> >> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>  * restoring previous
> >>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>  Warning in install.packages :
> >>>>>>>    installation of package ?rgdal? had non-zero exit status
> >>>>>>>
> >>>>>>>  ---
> >>>>>>>
> >>>>>>>  sessionInfo()
> >>>>>>>  R version 3.6.3 (2020-02-29)
> >>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
> >>>>>>>  Running under: Fedora 32 (Thirty Two)
> >>>>>>>
> >>>>>>>  Matrix products: default
> >>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >>>>>>>
> >>>>>>>  Random number generation:
> >>>>>>>   RNG:     Mersenne-Twister
> >>>>>>>   Normal:  Inversion
> >>>>>>>   Sample:  Rounding
> >>>>>>>
> >>>>>>>  locale:
> >>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>>>>>
> >>>>>>>  attached base packages:
> >>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods
> >>  base
> >>>>>>>
> >>>>>>>  loaded via a namespace (and not attached):
> >>>>>>>  [1] compiler_3.6.3 tools_3.6.3
> >>>>>>>
> >>>>>>
> >>>>>
> >>>>>
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>> https://orcid.org/0000-0003-2392-6140
> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From bennet @end|ng |rom um|ch@edu  Sun Jun 28 20:35:33 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Sun, 28 Jun 2020 14:35:33 -0400
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAAMki4G2O4bTt3AYF8nVQLQ_AUch1iAuEUzLtR+Vg81sFodvyg@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CAB2ovovkM6BkDb-QYUm-eJFz7JGB=OELbQGNkkktn-gtNvfSQw@mail.gmail.com>
 <CAAMki4HmY55gPa-+pNXTG1pmEP6ve__Jv21UU-b9+gYYy+ZwtA@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281919080.2945762@reclus.nhh.no>
 <CAAMki4G2O4bTt3AYF8nVQLQ_AUch1iAuEUzLtR+Vg81sFodvyg@mail.gmail.com>
Message-ID: <CAB2ovou4VQPzE0VEccvTDHisG9qAMXxRvy_p0oQ+ER7F8iMnrg@mail.gmail.com>

Vero, Ista, and Roger,

I used Ista's help to get a Docker container in which I could try this.

Yes, there does seem to be something wrong with the R packages for
Fedora 32, as I am also getting this when installing packages (not
just rgdal)

Warning in file.create(f.tg) :
  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
such file or directory'
Warning in utils::make.packages.html(.Library, docdir = R.home("doc")) :
  cannot update HTML package index

I believe that they (Fedora) also did not include building the HTML
documentation for R.

The particular LDFLAG that is causing the issue seems to be this one,

    LDFLAGS='-specs=/usr/lib/rpm/redhat/redhat-hardened-ld'

as that fails with the same message, but using all the others (the
following line used the additional printing of LDFLAGS, thank you
Roger!), as in the following,

    install.packages('rgdal', repos="https://R-Forge.R-project.org",
configure.vars=c("LDFLAGS='-Wl,-z,relro -Wl,--as-needed -Wl,-z,now'"))

does work.  I don't know if that helps you any, Roger, but I thought
that might help if someone reports this to Fedora.  I agree with you
that they probably should be dropped.

I am confused by them having the compiler syntax `-Wl,<linker options,
comma separated>`.  I think if those were CFLAGS, that would result in
a line like

    ld -z relro --as-needed -z now

where these are the explanations from the `ld` man page.

    -z relro                    Create RELRO program header (default)
    -z now                      Mark object non-lazy runtime binding
    --as-needed                 Only set DT_NEEDED for following
dynamic libs if used

I am not working on Fedora, so my ability to pursue further is limited.

Thanks, Roger, for providing a solution so quickly!

-- bennet


On Sun, Jun 28, 2020 at 1:30 PM Veronica Andreo <veroandreo at gmail.com> wrote:
>
>
>
> El dom., 28 jun. 2020 a las 19:20, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
>>
>> On Sun, 28 Jun 2020, Veronica Andreo wrote:
>>
>> > Hi Bennet,
>> > [cc-ing the list too]
>> >
>> > Thanks for the explanations about the config.log file
>> >
>> > I tried with your suggestion, but the error still appears as originally
>> > reported
>>
>> Please try install.packages("rgdal", repos="http://R-Forge.R-project.org",
>> configure.args="--disable-loadflags") to be sure to get the current
>> version.
>
>
> Yes, this works! rgdal is installed properly now :)
> I didn't understand how to properly specify the command before, apologies.
> And many thanks!!!
>
> Vero
>
>>
>> Roger
>>
>> >
>> > Best,
>> > Vero
>> >
>> > El dom., 28 jun. 2020 a las 17:00, Bennet Fauber (<bennet at umich.edu>)
>> > escribi?:
>> >
>> >> Hi, Vero,
>> >>
>> >> Your Fedora is using GCC version 10, which is newer and may have
>> >> changed options.  Just to help you with reading the config.log, this
>> >> is the part that matters here.
>> >>
>> >> #---  The following line is the command that configure is actually running
>> >> configure:3006: g++ -m64 -std=gnu++11 -o conftest
>> >> -I/usr/local/include -DPROJ_H_API   -Wl,-z,relro -Wl,--as-needed
>> >> -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld conftest.cpp
>> >> -lproj     -L/usr/lib64 -lgdal >&5/usr/bin/ld: /home/veroandreo
>> >>
>> >> #--- This is the error that it generated
>> >> /tmp/ccNranTE.o: relocation R_X86_64_32 against `.rodata' can not be
>> >> used when making a PIE object; recompile with -fPIE
>> >>
>> >> #--- This is configure telling you that an error occured, but not what it
>> >> is
>> >> collect2: error: ld returned 1 exit status
>> >>
>> >> #--- If the g++ command had succeeded, there would be a program file
>> >> called 'conftest' that it could run
>> >> configure:3017: ./conftest
>> >> configure: line 3019: ./conftest: No such file or directory
>> >>
>> >> I will take a wild stab in the dark and suggest you try
>> >>
>> >>> install.packages('rgdal', configure.vars=c("CXXFLAGS=-no-pie"))
>> >>
>> >>
>> >>
>> >> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
>> >> wrote:
>> >>>
>> >>> Dear Roger,
>> >>>
>> >>> Thanks for the answer.
>> >>>
>> >>> R is installed from Fedora repos and no, I do not have any issues with
>> >> sf. It installs and loads just fine.
>> >>>
>> >>> I downloaded the new rgdal tar.gz from R-forge, but I get the same error
>> >> that was reported yesterday; config.log file attached. The first error I
>> >> see there is in line 98-99 about a -V not recognized and then another one
>> >> for -qversion. Are those relevant?
>> >>>
>> >>> Vero
>> >>> ---
>> >>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type =
>> >> "source")
>> >>> Installing package into
>> >> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> >>> (as ?lib? is unspecified)
>> >>> * installing *source* package ?rgdal? ...
>> >>> ** using staged installation
>> >>> configure: R_HOME: /usr/lib64/R
>> >>> configure: CC: gcc -m64
>> >>> configure: CXX: g++ -m64 -std=gnu++11
>> >>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
>> >> -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions
>> >> -fstack-protector-strong -grecord-gcc-switches
>> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
>> >> -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic
>> >> -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
>> >>> configure: CPPFLAGS: -I/usr/local/include
>> >>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>> >>> loadflags: yes
>> >>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>> >>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> >>> configure: CXX is: g++ -m64 -std=gnu++11
>> >>> configure: C++11 support available
>> >>> configure: rgdal: 1.5-13
>> >>> checking for /usr/bin/svnversion... yes
>> >>> cat: inst/SVN_VERSION: No such file or directory
>> >>> configure: svn revision:
>> >>> checking for gdal-config... /usr/bin/gdal-config
>> >>> checking gdal-config usability... yes
>> >>> configure: GDAL: 3.0.4
>> >>> checking GDAL version >= 1.11.4... yes
>> >>> checking GDAL version <= 2.5 or >= 3.0... yes
>> >>> checking GDAL: linking with --libs only... yes
>> >>> checking GDAL: gdal-config data directory readable... yes
>> >>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> >>> configure: pkg-config proj exists, will use it
>> >>> configure: PROJ version: 6.3.2
>> >>> configure: PROJ CPP flags: -DPROJ_H_API
>> >>> configure: PROJ LIBS: -lproj
>> >>> checking PROJ header API:... yes
>> >>> checking whether the C++ compiler works... yes
>> >>> checking for C++ compiler default output file name... a.out
>> >>> checking for suffix of executables...
>> >>> checking whether we are cross compiling... configure: error: in
>> >> `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>> >>> configure: error: cannot run C++ compiled programs.
>> >>> If you meant to cross compile, use `--host'.
>> >>> See `config.log' for more details
>> >>> ERROR: configuration failed for package ?rgdal?
>> >>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>> Warning in install.packages :
>> >>>   installation of package
>> >> ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
>> >>>
>> >>>
>> >>>
>> >>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
>> >> escribi?:
>> >>>>
>> >>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>> >>>>
>> >>>>> Vero,
>> >>>>>
>> >>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
>> >>>>>
>> >>>>>>  See the attached config.log file
>> >>>>>>
>> >>>>>
>> >>>>> How did you install R itself? If an rpm, then
>> >>>>>
>> >>>>> https://github.com/r-spatial/sf/issues/1369
>> >>>>>
>> >>>>> may be relevant, also if you see errors installing sf. You would need
>> >> to
>> >>>>> unset LDFLAGS before installing:
>> >>>>>
>> >>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>> >>>>>
>> >>>>> Please report back on this.
>> >>>>
>> >>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>> >>>>
>> >>>> https://r-forge.r-project.org/R/?group_id=884
>> >>>>
>> >>>> includes a new configure argument --disable-loadflags to assist in
>> >>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes
>> >> the
>> >>>> problem.
>> >>>>
>> >>>> Roger
>> >>>>
>> >>>>
>> >>>>>
>> >>>>> Roger
>> >>>>>
>> >>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>> >>>>>>  (<veroandreo at gmail.com>)
>> >>>>>>  escribi?:
>> >>>>>>
>> >>>>>>>  Hello everyone
>> >>>>>>>
>> >>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3
>> >> and PROJ
>> >>>>>>>  6) and when updating my R packages, I get the following error for
>> >> rgdal.
>> >>>>>>>  Can someone help me out here? What does it mean that it cannot run
>> >> C++
>> >>>>>>>  compiled programs?  And do I want to crosscompile?
>> >>>>>>>
>> >>>>>>>  Thanks much in advance
>> >>>>>>>
>> >>>>>>>  Vero
>> >>>>>>>
>> >>>>>>>  ---
>> >>>>>>>
>> >>>>>>>  install.packages("rgdal")
>> >>>>>>>  Installing package into
>> >>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>> >>>>>>>  (as ?lib? is unspecified)
>> >>>>>>>  trying URL '
>> >> http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>> >>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>> >>>>>>>  ==================================================
>> >>>>>>>  downloaded 2.2 MB
>> >>>>>>>
>> >>>>>>>  * installing *source* package ?rgdal? ...
>> >>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>> >>>>>>>  ** using staged installation
>> >>>>>>> configure:  R_HOME: /usr/lib64/R
>> >>>>>>> configure:  CC: gcc -m64
>> >>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>> >>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>> >>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>> >>>>>>> configure:  C++11 support available
>> >>>>>>> configure:  rgdal: 1.5-12
>> >>>>>>>  checking for /usr/bin/svnversion... yes
>> >>>>>>> configure:  svn revision: 1018
>> >>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>> >>>>>>>  checking gdal-config usability... yes
>> >>>>>>> configure:  GDAL: 3.0.4
>> >>>>>>>  checking GDAL version >= 1.11.4... yes
>> >>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>> >>>>>>>  checking GDAL: linking with --libs only... yes
>> >>>>>>>  checking GDAL: gdal-config data directory readable... yes
>> >>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>> >>>>>>> configure:  pkg-config proj exists, will use it
>> >>>>>>> configure:  PROJ version: 6.3.2
>> >>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>> >>>>>>> configure:  PROJ LIBS: -lproj
>> >>>>>>>  checking PROJ header API:... yes
>> >>>>>>>  checking whether the C++ compiler works... yes
>> >>>>>>>  checking for C++ compiler default output file name... a.out
>> >>>>>>>  checking for suffix of executables...
>> >>>>>>>  checking whether we are cross compiling... configure: error: in
>> >>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>> >>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>> >>>>>>>  If you meant to cross compile, use `--host'.
>> >>>>>>>  See `config.log' for more details
>> >>>>>>>  ERROR: configuration failed for package ?rgdal?
>> >>>>>>>  * removing
>> >> ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>>>>>  * restoring previous
>> >>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>> >>>>>>>  Warning in install.packages :
>> >>>>>>>    installation of package ?rgdal? had non-zero exit status
>> >>>>>>>
>> >>>>>>>  ---
>> >>>>>>>
>> >>>>>>>  sessionInfo()
>> >>>>>>>  R version 3.6.3 (2020-02-29)
>> >>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>> >>>>>>>  Running under: Fedora 32 (Thirty Two)
>> >>>>>>>
>> >>>>>>>  Matrix products: default
>> >>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>> >>>>>>>
>> >>>>>>>  Random number generation:
>> >>>>>>>   RNG:     Mersenne-Twister
>> >>>>>>>   Normal:  Inversion
>> >>>>>>>   Sample:  Rounding
>> >>>>>>>
>> >>>>>>>  locale:
>> >>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> >>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> >>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> >>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> >>>>>>>
>> >>>>>>>  attached base packages:
>> >>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods
>> >>  base
>> >>>>>>>
>> >>>>>>>  loaded via a namespace (and not attached):
>> >>>>>>>  [1] compiler_3.6.3 tools_3.6.3
>> >>>>>>>
>> >>>>>>
>> >>>>>
>> >>>>>
>> >>>>
>> >>>> --
>> >>>> Roger Bivand
>> >>>> Department of Economics, Norwegian School of Economics,
>> >>>> Helleveien 30, N-5045 Bergen, Norway.
>> >>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> >>>> https://orcid.org/0000-0003-2392-6140
>> >>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>> >>>
>> >>> _______________________________________________
>> >>> R-sig-Geo mailing list
>> >>> R-sig-Geo at r-project.org
>> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From bennet @end|ng |rom um|ch@edu  Sun Jun 28 22:55:01 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Sun, 28 Jun 2020 16:55:01 -0400
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
Message-ID: <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>

Roger,

This seems to be an outcome of a 'security' policy that
RedHat/Fedora/CentOS implemented.  There are some circumstances where
I think that could be justified, but I do not think compiling R is one
of them.

It was reported several times to RedHat's Bugzilla and basically
ignored by RedHat at least as far back as 2015-12-02.  There are
several reports of slightly different versions of the report, but none
of them got acted upon.  Some details and links to other issues marked
as duplicates (but also seemingly closed without any attention or
action) can be found at

    https://bugzilla.redhat.com/show_bug.cgi?id=1287743

The version of R-rgdal that is in the Fedora archive as a binary is
rgdal_1.4-8 and that .srpm will build, however if it is updated to use
rgdal_1.5-12 it fails the same way that it does with the source build.



On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> On Sun, 28 Jun 2020, Ista Zahn wrote:
>
> > I can reproduce this error using the official Fedora 32 docker image:
>
> The error is in the RPM propagating its LDFLAGS which are  not needed (or
> cause no havoc) in simple tests for C compiler functionality in
> ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
> svn rev. 1020 configure argument --disable-loadflags. The load flags are
> far more than is sensibly needed to check whether the compile train works.
> I have used RH, RHEL and Fedora since the last century, and have always
> installed R from source. Recently, the TexLive packaging system drew in
> (totally unecessarily) a dependency on the R rpm, which I now have to
> avoid using. My rpm:
>
> $ /usr/bin/R CMD config LDFLAGS
> -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>
> and compiled from source:
>
> $ R CMD config LDFLAGS
> -L/usr/local/lib64
>
> Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
> 504 in configure.ac) is unknown for me, hence the need for the workaround.
>
> I advise strongly against binary packaging of rgdal for Linux, and was not
> aware that any such packaging had been attempted. Changes in GDAL and PROJ
> happen fast, and Fedora/Centos etc. have been really slow to update.
>
> If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
> and can explain why they are needed and how to run a cross platform
> configure script without having to special-case platforms, I'd be mildly
> interested to know. sf has also been through similar trouble as mentioned
> earlier in this thread.
>
> Roger
>
> >
> > docker run -it library/fedora:32
> > dnf install 'dnf-command(builddep)'
> > dnf builddep R-rgdal
> > R
> > install.packages("rgdal")
> >
> > * installing *source* package ?rgdal? ...
> > ** package ?rgdal? successfully unpacked and MD5 sums checked
> > ** using staged installation
> > configure: R_HOME: /usr/lib64/R
> > configure: CC: gcc -m64
> > configure: CXX: g++ -m64 -std=gnu++11
> > configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> > configure: CXX is: g++ -m64 -std=gnu++11
> > configure: C++11 support available
> > configure: rgdal: 1.5-12
> > checking for /usr/bin/svnversion... no
> > configure: svn revision: 1018
> > checking for gdal-config... /usr/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 3.0.4
> > checking GDAL version >= 1.11.4... yes
> > checking GDAL version <= 2.5 or >= 3.0... yes
> > checking GDAL: linking with --libs only... yes
> > checking GDAL: gdal-config data directory readable... yes
> > checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> > configure: pkg-config proj exists, will use it
> > configure: PROJ version: 6.3.2
> > configure: PROJ CPP flags: -DPROJ_H_API
> > configure: PROJ LIBS: -lproj
> > checking PROJ header API:... yes
> > checking whether the C++ compiler works... yes
> > checking for C++ compiler default output file name... a.out
> > checking for suffix of executables...
> > checking whether we are cross compiling... configure: error: in
> > `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
> > configure: error: cannot run C++ compiled programs.
> > If you meant to cross compile, use `--host'.
> > See `config.log' for more details
> > ERROR: configuration failed for package ?rgdal?
> > * removing ?/usr/lib64/R/library/rgdal?
> >
> > The downloaded source packages are in
> >        ?/tmp/RtmpooFgiH/downloaded_packages?
> > Updating HTML index of packages in '.Library'
> > Warning messages:
> > 1: In install.packages("rgdal") :
> >  installation of package ?rgdal? had non-zero exit status
> > 2: In file.create(f.tg) :
> >  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
> > such file or directory'
> > 3: In make.packages.html(.Library) : cannot update HTML package index
> >>
> >
> > I don't have any insight into what happens here, but it is reproducible.
> >
> > Best,
> > Ista
> >
> > On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com> wrote:
> >>
> >> Dear Roger,
> >>
> >> Thanks for the answer.
> >>
> >> R is installed from Fedora repos and no, I do not have any issues with sf. It installs and loads just fine.
> >>
> >> I downloaded the new rgdal tar.gz from R-forge, but I get the same error that was reported yesterday; config.log file attached. The first error I see there is in line 98-99 about a -V not recognized and then another one for -qversion. Are those relevant?
> >>
> >> Vero
> >> ---
> >> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type = "source")
> >> Installing package into ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >> (as ?lib? is unspecified)
> >> * installing *source* package ?rgdal? ...
> >> ** using staged installation
> >> configure: R_HOME: /usr/lib64/R
> >> configure: CC: gcc -m64
> >> configure: CXX: g++ -m64 -std=gnu++11
> >> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> >> configure: CPPFLAGS: -I/usr/local/include
> >> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >> loadflags: yes
> >> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >> configure: CXX is: g++ -m64 -std=gnu++11
> >> configure: C++11 support available
> >> configure: rgdal: 1.5-13
> >> checking for /usr/bin/svnversion... yes
> >> cat: inst/SVN_VERSION: No such file or directory
> >> configure: svn revision:
> >> checking for gdal-config... /usr/bin/gdal-config
> >> checking gdal-config usability... yes
> >> configure: GDAL: 3.0.4
> >> checking GDAL version >= 1.11.4... yes
> >> checking GDAL version <= 2.5 or >= 3.0... yes
> >> checking GDAL: linking with --libs only... yes
> >> checking GDAL: gdal-config data directory readable... yes
> >> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >> configure: pkg-config proj exists, will use it
> >> configure: PROJ version: 6.3.2
> >> configure: PROJ CPP flags: -DPROJ_H_API
> >> configure: PROJ LIBS: -lproj
> >> checking PROJ header API:... yes
> >> checking whether the C++ compiler works... yes
> >> checking for C++ compiler default output file name... a.out
> >> checking for suffix of executables...
> >> checking whether we are cross compiling... configure: error: in `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> >> configure: error: cannot run C++ compiled programs.
> >> If you meant to cross compile, use `--host'.
> >> See `config.log' for more details
> >> ERROR: configuration failed for package ?rgdal?
> >> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >> Warning in install.packages :
> >>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
> >>
> >>
> >>
> >> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
> >>>
> >>> On Sun, 28 Jun 2020, Roger Bivand wrote:
> >>>
> >>>> Vero,
> >>>>
> >>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >>>>
> >>>>>  See the attached config.log file
> >>>>>
> >>>>
> >>>> How did you install R itself? If an rpm, then
> >>>>
> >>>> https://github.com/r-spatial/sf/issues/1369
> >>>>
> >>>> may be relevant, also if you see errors installing sf. You would need to
> >>>> unset LDFLAGS before installing:
> >>>>
> >>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >>>>
> >>>> Please report back on this.
> >>>
> >>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
> >>>
> >>> https://r-forge.r-project.org/R/?group_id=884
> >>>
> >>> includes a new configure argument --disable-loadflags to assist in
> >>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
> >>> problem.
> >>>
> >>> Roger
> >>>
> >>>
> >>>>
> >>>> Roger
> >>>>
> >>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >>>>>  (<veroandreo at gmail.com>)
> >>>>>  escribi?:
> >>>>>
> >>>>>>  Hello everyone
> >>>>>>
> >>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
> >>>>>>  6) and when updating my R packages, I get the following error for rgdal.
> >>>>>>  Can someone help me out here? What does it mean that it cannot run C++
> >>>>>>  compiled programs?  And do I want to crosscompile?
> >>>>>>
> >>>>>>  Thanks much in advance
> >>>>>>
> >>>>>>  Vero
> >>>>>>
> >>>>>>  ---
> >>>>>>
> >>>>>>  install.packages("rgdal")
> >>>>>>  Installing package into
> >>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>>>>  (as ?lib? is unspecified)
> >>>>>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >>>>>>  ==================================================
> >>>>>>  downloaded 2.2 MB
> >>>>>>
> >>>>>>  * installing *source* package ?rgdal? ...
> >>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>>>>  ** using staged installation
> >>>>>> configure:  R_HOME: /usr/lib64/R
> >>>>>> configure:  CC: gcc -m64
> >>>>>> configure:  CXX: g++ -m64 -std=gnu++11
> >>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>>>>> configure:  C++11 support available
> >>>>>> configure:  rgdal: 1.5-12
> >>>>>>  checking for /usr/bin/svnversion... yes
> >>>>>> configure:  svn revision: 1018
> >>>>>>  checking for gdal-config... /usr/bin/gdal-config
> >>>>>>  checking gdal-config usability... yes
> >>>>>> configure:  GDAL: 3.0.4
> >>>>>>  checking GDAL version >= 1.11.4... yes
> >>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>>>  checking GDAL: linking with --libs only... yes
> >>>>>>  checking GDAL: gdal-config data directory readable... yes
> >>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>>>> configure:  pkg-config proj exists, will use it
> >>>>>> configure:  PROJ version: 6.3.2
> >>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>>>>> configure:  PROJ LIBS: -lproj
> >>>>>>  checking PROJ header API:... yes
> >>>>>>  checking whether the C++ compiler works... yes
> >>>>>>  checking for C++ compiler default output file name... a.out
> >>>>>>  checking for suffix of executables...
> >>>>>>  checking whether we are cross compiling... configure: error: in
> >>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
> >>>>>>  If you meant to cross compile, use `--host'.
> >>>>>>  See `config.log' for more details
> >>>>>>  ERROR: configuration failed for package ?rgdal?
> >>>>>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>  * restoring previous
> >>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>  Warning in install.packages :
> >>>>>>    installation of package ?rgdal? had non-zero exit status
> >>>>>>
> >>>>>>  ---
> >>>>>>
> >>>>>>  sessionInfo()
> >>>>>>  R version 3.6.3 (2020-02-29)
> >>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
> >>>>>>  Running under: Fedora 32 (Thirty Two)
> >>>>>>
> >>>>>>  Matrix products: default
> >>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >>>>>>
> >>>>>>  Random number generation:
> >>>>>>   RNG:     Mersenne-Twister
> >>>>>>   Normal:  Inversion
> >>>>>>   Sample:  Rounding
> >>>>>>
> >>>>>>  locale:
> >>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>>>>
> >>>>>>  attached base packages:
> >>>>>>  [1] stats     graphics  grDevices utils     datasets  methods   base
> >>>>>>
> >>>>>>  loaded via a namespace (and not attached):
> >>>>>>  [1] compiler_3.6.3 tools_3.6.3
> >>>>>>
> >>>>>
> >>>>
> >>>>
> >>>
> >>> --
> >>> Roger Bivand
> >>> Department of Economics, Norwegian School of Economics,
> >>> Helleveien 30, N-5045 Bergen, Norway.
> >>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>> https://orcid.org/0000-0003-2392-6140
> >>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ttcro@@ro@d@09 @end|ng |rom gm@||@com  Mon Jun 29 04:55:55 2020
From: ttcro@@ro@d@09 @end|ng |rom gm@||@com (Alan Engel)
Date: Mon, 29 Jun 2020 11:55:55 +0900
Subject: [R-sig-Geo] readOGR workaround for Japanese UTF-8 geojson
Message-ID: <CAHYftXUhdbkemi4S-bz=sCohLe2txATr+LTd4tvGtPQS8znZgw@mail.gmail.com>

I am working on a project https://github.com/AlanInTsukuba/jpucd that
involves

extracting shapefiles and property data from Japanese geojson files. When

reading with readOGR(ibarakipath1 , encoding="UTF-8", use_iconv=TRUE),

I find that the subsets of cannot be written with writeOGR without losing

text fields that are in Japanese text. I found the following workaround but

wonder if there is a better way to do this.


Environment: RGui, Windows10



# load ibaraki shapefiles, extract TX subset, write to geojson

library(jpucd)

shppath <- system.file("extdata",package="jpucd")



ibarakipath1 <-
paste(shppath,"JPGen2005CTgenlCY2000P08Ibaraki.geojson",sep="/")



#^ JPGen2005CTgenlCY2000P08Ibaraki.geojson is a UTF-8 encoded geojson file

#^     having Japanese names in property fields. To be able to

#^    read these fields, they need to be converted (to switch-jis?).

#^     The following command does this.

#^ This can also be done by use_iconv=FALSE and setting

#^     the encoding of the Japanese columns using Encoding(x) <- "UTF-8".



ibaraki <- readOGR(ibarakipath1 , encoding="UTF-8", use_iconv=FALSE) ##
use_iconv=TRUE

## loads so that the Japanese fields are readable but writeOGR doesn?t
write them.

head(ibaraki at data)



#^ Apply Encoding(x) <- ?UTF-8?

for (name in colnames(ibaraki at data[,sapply(ibaraki @data, is.character)])){

  Encoding(ibaraki @data[[name]]) <- "UTF-8"}



#^ Get TX subset

tx2000 <- ibaraki[ibaraki at data$CITY_NAME=="????"|ibaraki at data$CITY_NAME=="
???"

              |ibaraki at data$CITY_NAME=="???"|ibaraki at data$CITY_NAME=="????
",]

head(tx2000 at data)



#^ Write it.

dsn <- "TsukubaExpressCensusDistricts2000.geojson"

writeOGR(tx2000 , dsn,layer="TsukubaExpressCensusDistricts2000" ,
driver="GeoJSON", dataset_options = NULL,

layer_options=NULL, verbose = FALSE, check_exists=NULL,

overwrite_layer=FALSE, delete_dsn=FALSE, morphToESRI=NULL,

encoding="UTF-8")



Thank you.

Alan

https://alanintsukuba.github.io/

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun 29 09:32:27 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 29 Jun 2020 09:32:27 +0200
Subject: [R-sig-Geo] readOGR workaround for Japanese UTF-8 geojson
In-Reply-To: <CAHYftXUhdbkemi4S-bz=sCohLe2txATr+LTd4tvGtPQS8znZgw@mail.gmail.com>
References: <CAHYftXUhdbkemi4S-bz=sCohLe2txATr+LTd4tvGtPQS8znZgw@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006290916140.2954318@reclus.nhh.no>

On Mon, 29 Jun 2020, Alan Engel wrote:

> I am working on a project https://github.com/AlanInTsukuba/jpucd that 
> involves extracting shapefiles and property data from Japanese geojson 
> files. When reading with readOGR(ibarakipath1 , encoding="UTF-8", 
> use_iconv=TRUE), I find that the subsets of cannot be written with 
> writeOGR without losing text fields that are in Japanese text. I found 
> the following workaround but wonder if there is a better way to do this.
>

Firstly, the ESRI shapefile driver should only be used for reading legacy 
files with known text encodings. They use DBF files to store attribute 
data, which should never now be used in new work. They have restrictions 
on field name length, imprecision in storing numerical data, and big 
problems in storing any text that is not ASCII (see 
https://cran.r-project.org/web/packages/rgdal/vignettes/OGR_shape_encoding.pdf).

All new projects must use more modern formats, preferably GeoPackage GPKG
http://www.geopackage.org/spec/, which resolves all of the problems 
mentioned.

If your project is using R on Windows, you  need to be aware in addition 
of 
https://developer.r-project.org/Blog/public/2020/05/02/utf-8-support-on-windows/index.html 
that is that R on Windows is moving towards UTF-8 in order to reduce 
internal and cross-platform encoding problems.

Finally, you should be starting new work using the sf workflow, not 
sp/rgdal. sp/rgdal are being maintained to support their reverse 
dependencies only (and especially for spatial vector data, for which sf 
provides full support).

Roger

>
> Environment: RGui, Windows10
>
>
>
> # load ibaraki shapefiles, extract TX subset, write to geojson
>
> library(jpucd)
>
> shppath <- system.file("extdata",package="jpucd")
>
>
>
> ibarakipath1 <-
> paste(shppath,"JPGen2005CTgenlCY2000P08Ibaraki.geojson",sep="/")
>
>
>
> #^ JPGen2005CTgenlCY2000P08Ibaraki.geojson is a UTF-8 encoded geojson file
>
> #^     having Japanese names in property fields. To be able to
>
> #^    read these fields, they need to be converted (to switch-jis?).
>
> #^     The following command does this.
>
> #^ This can also be done by use_iconv=FALSE and setting
>
> #^     the encoding of the Japanese columns using Encoding(x) <- "UTF-8".
>
>
>
> ibaraki <- readOGR(ibarakipath1 , encoding="UTF-8", use_iconv=FALSE) ##
> use_iconv=TRUE
>
> ## loads so that the Japanese fields are readable but writeOGR doesn?t
> write them.
>
> head(ibaraki at data)
>
>
>
> #^ Apply Encoding(x) <- ?UTF-8?
>
> for (name in colnames(ibaraki at data[,sapply(ibaraki @data, is.character)])){
>
>  Encoding(ibaraki @data[[name]]) <- "UTF-8"}
>
>
>
> #^ Get TX subset
>
> tx2000 <- ibaraki[ibaraki at data$CITY_NAME=="????"|ibaraki at data$CITY_NAME=="
> ???"
>
>              |ibaraki at data$CITY_NAME=="???"|ibaraki at data$CITY_NAME=="????
> ",]
>
> head(tx2000 at data)
>
>
>
> #^ Write it.
>
> dsn <- "TsukubaExpressCensusDistricts2000.geojson"
>
> writeOGR(tx2000 , dsn,layer="TsukubaExpressCensusDistricts2000" ,
> driver="GeoJSON", dataset_options = NULL,
>
> layer_options=NULL, verbose = FALSE, check_exists=NULL,
>
> overwrite_layer=FALSE, delete_dsn=FALSE, morphToESRI=NULL,
>
> encoding="UTF-8")
>
>
>
> Thank you.
>
> Alan
>
> https://alanintsukuba.github.io/
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun 29 09:56:52 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 29 Jun 2020 09:56:52 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
 <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>

Bennet,

Thanks for the careful analysis.

On Sun, 28 Jun 2020, Bennet Fauber wrote:

> Roger,
>
> This seems to be an outcome of a 'security' policy that
> RedHat/Fedora/CentOS implemented.  There are some circumstances where
> I think that could be justified, but I do not think compiling R is one
> of them.
>
> It was reported several times to RedHat's Bugzilla and basically
> ignored by RedHat at least as far back as 2015-12-02.  There are
> several reports of slightly different versions of the report, but none
> of them got acted upon.  Some details and links to other issues marked
> as duplicates (but also seemingly closed without any attention or
> action) can be found at
>
>    https://bugzilla.redhat.com/show_bug.cgi?id=1287743
>

https://bugzilla.redhat.com/show_bug.cgi?id=1343892 includes more 
information. Many traces in search suggest that a missing 
redhat-rpm-config package is to blame, but it is certainly present on my 
test system.

The Redhat policy positions are specified in:

https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/

but do not seem to resolve the conflict between autoconf and 
-specs=/usr/lib/rpm/redhat/redhat-hardened-ld.

I'll raise this on the R fedora list.

Roger

> The version of R-rgdal that is in the Fedora archive as a binary is
> rgdal_1.4-8 and that .srpm will build, however if it is updated to use
> rgdal_1.5-12 it fails the same way that it does with the source build.
>
>
>
> On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>> On Sun, 28 Jun 2020, Ista Zahn wrote:
>>
>>> I can reproduce this error using the official Fedora 32 docker image:
>>
>> The error is in the RPM propagating its LDFLAGS which are  not needed (or
>> cause no havoc) in simple tests for C compiler functionality in
>> ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
>> svn rev. 1020 configure argument --disable-loadflags. The load flags are
>> far more than is sensibly needed to check whether the compile train works.
>> I have used RH, RHEL and Fedora since the last century, and have always
>> installed R from source. Recently, the TexLive packaging system drew in
>> (totally unecessarily) a dependency on the R rpm, which I now have to
>> avoid using. My rpm:
>>
>> $ /usr/bin/R CMD config LDFLAGS
>> -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>
>> and compiled from source:
>>
>> $ R CMD config LDFLAGS
>> -L/usr/local/lib64
>>
>> Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
>> 504 in configure.ac) is unknown for me, hence the need for the workaround.
>>
>> I advise strongly against binary packaging of rgdal for Linux, and was not
>> aware that any such packaging had been attempted. Changes in GDAL and PROJ
>> happen fast, and Fedora/Centos etc. have been really slow to update.
>>
>> If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
>> and can explain why they are needed and how to run a cross platform
>> configure script without having to special-case platforms, I'd be mildly
>> interested to know. sf has also been through similar trouble as mentioned
>> earlier in this thread.
>>
>> Roger
>>
>>>
>>> docker run -it library/fedora:32
>>> dnf install 'dnf-command(builddep)'
>>> dnf builddep R-rgdal
>>> R
>>> install.packages("rgdal")
>>>
>>> * installing *source* package ?rgdal? ...
>>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>>> ** using staged installation
>>> configure: R_HOME: /usr/lib64/R
>>> configure: CC: gcc -m64
>>> configure: CXX: g++ -m64 -std=gnu++11
>>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>> configure: CXX is: g++ -m64 -std=gnu++11
>>> configure: C++11 support available
>>> configure: rgdal: 1.5-12
>>> checking for /usr/bin/svnversion... no
>>> configure: svn revision: 1018
>>> checking for gdal-config... /usr/bin/gdal-config
>>> checking gdal-config usability... yes
>>> configure: GDAL: 3.0.4
>>> checking GDAL version >= 1.11.4... yes
>>> checking GDAL version <= 2.5 or >= 3.0... yes
>>> checking GDAL: linking with --libs only... yes
>>> checking GDAL: gdal-config data directory readable... yes
>>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>> configure: pkg-config proj exists, will use it
>>> configure: PROJ version: 6.3.2
>>> configure: PROJ CPP flags: -DPROJ_H_API
>>> configure: PROJ LIBS: -lproj
>>> checking PROJ header API:... yes
>>> checking whether the C++ compiler works... yes
>>> checking for C++ compiler default output file name... a.out
>>> checking for suffix of executables...
>>> checking whether we are cross compiling... configure: error: in
>>> `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
>>> configure: error: cannot run C++ compiled programs.
>>> If you meant to cross compile, use `--host'.
>>> See `config.log' for more details
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/usr/lib64/R/library/rgdal?
>>>
>>> The downloaded source packages are in
>>>        ?/tmp/RtmpooFgiH/downloaded_packages?
>>> Updating HTML index of packages in '.Library'
>>> Warning messages:
>>> 1: In install.packages("rgdal") :
>>>  installation of package ?rgdal? had non-zero exit status
>>> 2: In file.create(f.tg) :
>>>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
>>> such file or directory'
>>> 3: In make.packages.html(.Library) : cannot update HTML package index
>>>>
>>>
>>> I don't have any insight into what happens here, but it is reproducible.
>>>
>>> Best,
>>> Ista
>>>
>>> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com> wrote:
>>>>
>>>> Dear Roger,
>>>>
>>>> Thanks for the answer.
>>>>
>>>> R is installed from Fedora repos and no, I do not have any issues with sf. It installs and loads just fine.
>>>>
>>>> I downloaded the new rgdal tar.gz from R-forge, but I get the same error that was reported yesterday; config.log file attached. The first error I see there is in line 98-99 about a -V not recognized and then another one for -qversion. Are those relevant?
>>>>
>>>> Vero
>>>> ---
>>>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type = "source")
>>>> Installing package into ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>> (as ?lib? is unspecified)
>>>> * installing *source* package ?rgdal? ...
>>>> ** using staged installation
>>>> configure: R_HOME: /usr/lib64/R
>>>> configure: CC: gcc -m64
>>>> configure: CXX: g++ -m64 -std=gnu++11
>>>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
>>>> configure: CPPFLAGS: -I/usr/local/include
>>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>> loadflags: yes
>>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>> configure: CXX is: g++ -m64 -std=gnu++11
>>>> configure: C++11 support available
>>>> configure: rgdal: 1.5-13
>>>> checking for /usr/bin/svnversion... yes
>>>> cat: inst/SVN_VERSION: No such file or directory
>>>> configure: svn revision:
>>>> checking for gdal-config... /usr/bin/gdal-config
>>>> checking gdal-config usability... yes
>>>> configure: GDAL: 3.0.4
>>>> checking GDAL version >= 1.11.4... yes
>>>> checking GDAL version <= 2.5 or >= 3.0... yes
>>>> checking GDAL: linking with --libs only... yes
>>>> checking GDAL: gdal-config data directory readable... yes
>>>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>> configure: pkg-config proj exists, will use it
>>>> configure: PROJ version: 6.3.2
>>>> configure: PROJ CPP flags: -DPROJ_H_API
>>>> configure: PROJ LIBS: -lproj
>>>> checking PROJ header API:... yes
>>>> checking whether the C++ compiler works... yes
>>>> checking for C++ compiler default output file name... a.out
>>>> checking for suffix of executables...
>>>> checking whether we are cross compiling... configure: error: in `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>>>> configure: error: cannot run C++ compiled programs.
>>>> If you meant to cross compile, use `--host'.
>>>> See `config.log' for more details
>>>> ERROR: configuration failed for package ?rgdal?
>>>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>> Warning in install.packages :
>>>>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
>>>>
>>>>
>>>>
>>>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
>>>>>
>>>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
>>>>>
>>>>>> Vero,
>>>>>>
>>>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
>>>>>>
>>>>>>>  See the attached config.log file
>>>>>>>
>>>>>>
>>>>>> How did you install R itself? If an rpm, then
>>>>>>
>>>>>> https://github.com/r-spatial/sf/issues/1369
>>>>>>
>>>>>> may be relevant, also if you see errors installing sf. You would need to
>>>>>> unset LDFLAGS before installing:
>>>>>>
>>>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>>>>>>
>>>>>> Please report back on this.
>>>>>
>>>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>>>>
>>>>> https://r-forge.r-project.org/R/?group_id=884
>>>>>
>>>>> includes a new configure argument --disable-loadflags to assist in
>>>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
>>>>> problem.
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>>>>>>  (<veroandreo at gmail.com>)
>>>>>>>  escribi?:
>>>>>>>
>>>>>>>>  Hello everyone
>>>>>>>>
>>>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
>>>>>>>>  6) and when updating my R packages, I get the following error for rgdal.
>>>>>>>>  Can someone help me out here? What does it mean that it cannot run C++
>>>>>>>>  compiled programs?  And do I want to crosscompile?
>>>>>>>>
>>>>>>>>  Thanks much in advance
>>>>>>>>
>>>>>>>>  Vero
>>>>>>>>
>>>>>>>>  ---
>>>>>>>>
>>>>>>>>  install.packages("rgdal")
>>>>>>>>  Installing package into
>>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>>>  (as ?lib? is unspecified)
>>>>>>>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>>>>>>  ==================================================
>>>>>>>>  downloaded 2.2 MB
>>>>>>>>
>>>>>>>>  * installing *source* package ?rgdal? ...
>>>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>>>  ** using staged installation
>>>>>>>> configure:  R_HOME: /usr/lib64/R
>>>>>>>> configure:  CC: gcc -m64
>>>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>>>>> configure:  C++11 support available
>>>>>>>> configure:  rgdal: 1.5-12
>>>>>>>>  checking for /usr/bin/svnversion... yes
>>>>>>>> configure:  svn revision: 1018
>>>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>>>>  checking gdal-config usability... yes
>>>>>>>> configure:  GDAL: 3.0.4
>>>>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>>>  checking GDAL: linking with --libs only... yes
>>>>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>>>> configure:  pkg-config proj exists, will use it
>>>>>>>> configure:  PROJ version: 6.3.2
>>>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>>>>> configure:  PROJ LIBS: -lproj
>>>>>>>>  checking PROJ header API:... yes
>>>>>>>>  checking whether the C++ compiler works... yes
>>>>>>>>  checking for C++ compiler default output file name... a.out
>>>>>>>>  checking for suffix of executables...
>>>>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
>>>>>>>>  If you meant to cross compile, use `--host'.
>>>>>>>>  See `config.log' for more details
>>>>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>>>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>  * restoring previous
>>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>  Warning in install.packages :
>>>>>>>>    installation of package ?rgdal? had non-zero exit status
>>>>>>>>
>>>>>>>>  ---
>>>>>>>>
>>>>>>>>  sessionInfo()
>>>>>>>>  R version 3.6.3 (2020-02-29)
>>>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>>  Running under: Fedora 32 (Thirty Two)
>>>>>>>>
>>>>>>>>  Matrix products: default
>>>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>>>>>>
>>>>>>>>  Random number generation:
>>>>>>>>   RNG:     Mersenne-Twister
>>>>>>>>   Normal:  Inversion
>>>>>>>>   Sample:  Rounding
>>>>>>>>
>>>>>>>>  locale:
>>>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>
>>>>>>>>  attached base packages:
>>>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>>>
>>>>>>>>  loaded via a namespace (and not attached):
>>>>>>>>  [1] compiler_3.6.3 tools_3.6.3
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>> https://orcid.org/0000-0003-2392-6140
>>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun 29 14:02:22 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 29 Jun 2020 14:02:22 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
 <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
 <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
Message-ID: <alpine.LFD.2.22.394.2006291356230.2961111@reclus.nhh.no>

In thread 
https://stat.ethz.ch/pipermail/r-sig-fedora/2020-June/000653.html, I?aki 
?car explains that, following the introduction of AC_LANG(C++) into 
configure.ac about 11 June, the Fedora R rpm would also need CXXFLAGS set.

Having added : ${CXXFLAGS=`"${RBIN}" CMD config CXXFLAGS`} to 
configure.ac, I can confirm that the work-around flag is not needed, and 
that (once R-forge revision 1021 completes), install.packages("rgdal", 
repos="http://R-Forge.R-project.org") should work on Fedora R rpm 
platforms. Those affected please check and confirm.

Many thanks to Bennet and I?aki!

Roger

On Mon, 29 Jun 2020, Roger Bivand wrote:

> Bennet,
>
> Thanks for the careful analysis.
>
> On Sun, 28 Jun 2020, Bennet Fauber wrote:
>
>>  Roger,
>>
>>  This seems to be an outcome of a 'security' policy that
>>  RedHat/Fedora/CentOS implemented.  There are some circumstances where
>>  I think that could be justified, but I do not think compiling R is one
>>  of them.
>>
>>  It was reported several times to RedHat's Bugzilla and basically
>>  ignored by RedHat at least as far back as 2015-12-02.  There are
>>  several reports of slightly different versions of the report, but none
>>  of them got acted upon.  Some details and links to other issues marked
>>  as duplicates (but also seemingly closed without any attention or
>>  action) can be found at
>>
>>     https://bugzilla.redhat.com/show_bug.cgi?id=1287743
>> 
>
> https://bugzilla.redhat.com/show_bug.cgi?id=1343892 includes more 
> information. Many traces in search suggest that a missing redhat-rpm-config 
> package is to blame, but it is certainly present on my test system.
>
> The Redhat policy positions are specified in:
>
> https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/
>
> but do not seem to resolve the conflict between autoconf and 
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld.
>
> I'll raise this on the R fedora list.
>
> Roger
>
>>  The version of R-rgdal that is in the Fedora archive as a binary is
>>  rgdal_1.4-8 and that .srpm will build, however if it is updated to use
>>  rgdal_1.5-12 it fails the same way that it does with the source build.
>> 
>> 
>>
>>  On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>  On Sun, 28 Jun 2020, Ista Zahn wrote:
>>>
>>>>  I can reproduce this error using the official Fedora 32 docker image:
>>>
>>>  The error is in the RPM propagating its LDFLAGS which are  not needed (or
>>>  cause no havoc) in simple tests for C compiler functionality in
>>>  ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
>>>  svn rev. 1020 configure argument --disable-loadflags. The load flags are
>>>  far more than is sensibly needed to check whether the compile train
>>>  works.
>>>  I have used RH, RHEL and Fedora since the last century, and have always
>>>  installed R from source. Recently, the TexLive packaging system drew in
>>>  (totally unecessarily) a dependency on the R rpm, which I now have to
>>>  avoid using. My rpm:
>>>
>>>  $ /usr/bin/R CMD config LDFLAGS
>>>  -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>>>  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>
>>>  and compiled from source:
>>>
>>>  $ R CMD config LDFLAGS
>>>  -L/usr/local/lib64
>>>
>>>  Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
>>>  504 in configure.ac) is unknown for me, hence the need for the
>>>  workaround.
>>>
>>>  I advise strongly against binary packaging of rgdal for Linux, and was
>>>  not
>>>  aware that any such packaging had been attempted. Changes in GDAL and
>>>  PROJ
>>>  happen fast, and Fedora/Centos etc. have been really slow to update.
>>>
>>>  If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
>>>  and can explain why they are needed and how to run a cross platform
>>>  configure script without having to special-case platforms, I'd be mildly
>>>  interested to know. sf has also been through similar trouble as mentioned
>>>  earlier in this thread.
>>>
>>>  Roger
>>> 
>>>>
>>>>  docker run -it library/fedora:32
>>>>  dnf install 'dnf-command(builddep)'
>>>>  dnf builddep R-rgdal
>>>>  R
>>>>  install.packages("rgdal")
>>>>
>>>>  * installing *source* package ?rgdal? ...
>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>  ** using staged installation
>>>> configure:  R_HOME: /usr/lib64/R
>>>> configure:  CC: gcc -m64
>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>> configure:  C++11 support available
>>>> configure:  rgdal: 1.5-12
>>>>  checking for /usr/bin/svnversion... no
>>>> configure:  svn revision: 1018
>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>  checking gdal-config usability... yes
>>>> configure:  GDAL: 3.0.4
>>>>  checking GDAL version >= 1.11.4... yes
>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>  checking GDAL: linking with --libs only... yes
>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>> configure:  pkg-config proj exists, will use it
>>>> configure:  PROJ version: 6.3.2
>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>> configure:  PROJ LIBS: -lproj
>>>>  checking PROJ header API:... yes
>>>>  checking whether the C++ compiler works... yes
>>>>  checking for C++ compiler default output file name... a.out
>>>>  checking for suffix of executables...
>>>>  checking whether we are cross compiling... configure: error: in
>>>>  `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
>>>> configure:  error: cannot run C++ compiled programs.
>>>>  If you meant to cross compile, use `--host'.
>>>>  See `config.log' for more details
>>>>  ERROR: configuration failed for package ?rgdal?
>>>>  * removing ?/usr/lib64/R/library/rgdal?
>>>>
>>>>  The downloaded source packages are in
>>>>         ?/tmp/RtmpooFgiH/downloaded_packages?
>>>>  Updating HTML index of packages in '.Library'
>>>>  Warning messages:
>>>>  1: In install.packages("rgdal") :
>>>>  installation of package ?rgdal? had non-zero exit status
>>>>  2: In file.create(f.tg) :
>>>>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
>>>>  such file or directory'
>>>>  3: In make.packages.html(.Library) : cannot update HTML package index
>>>>> 
>>>>
>>>>  I don't have any insight into what happens here, but it is reproducible.
>>>>
>>>>  Best,
>>>>  Ista
>>>>
>>>>  On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
>>>>  wrote:
>>>>>
>>>>>  Dear Roger,
>>>>>
>>>>>  Thanks for the answer.
>>>>>
>>>>>  R is installed from Fedora repos and no, I do not have any issues with
>>>>>  sf. It installs and loads just fine.
>>>>>
>>>>>  I downloaded the new rgdal tar.gz from R-forge, but I get the same
>>>>>  error that was reported yesterday; config.log file attached. The first
>>>>>  error I see there is in line 98-99 about a -V not recognized and then
>>>>>  another one for -qversion. Are those relevant?
>>>>>
>>>>>  Vero
>>>>>  ---
>>>>>  install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type
>>>>>  = "source")
>>>>>  Installing package into
>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>  (as ?lib? is unspecified)
>>>>>  * installing *source* package ?rgdal? ...
>>>>>  ** using staged installation
>>>>> configure:  R_HOME: /usr/lib64/R
>>>>> configure:  CC: gcc -m64
>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>> configure:  CFLAGS: -O2 -g -pipe -Wall -Werror=format-security 
>>>>> configure:  -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS 
>>>>> configure:  -fexceptions -fstack-protector-strong -grecord-gcc-switches 
>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 
>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 
>>>>> configure:  -mtune=generic -fasynchronous-unwind-tables 
>>>>> configure:  -fstack-clash-protection -fcf-protection
>>>>> configure:  CPPFLAGS: -I/usr/local/include
>>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now 
>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>>>  loadflags: yes
>>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now 
>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>> configure:  C++11 support available
>>>>> configure:  rgdal: 1.5-13
>>>>>  checking for /usr/bin/svnversion... yes
>>>>>  cat: inst/SVN_VERSION: No such file or directory
>>>>> configure:  svn revision:
>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>  checking gdal-config usability... yes
>>>>> configure:  GDAL: 3.0.4
>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>  checking GDAL: linking with --libs only... yes
>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>> configure:  pkg-config proj exists, will use it
>>>>> configure:  PROJ version: 6.3.2
>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>> configure:  PROJ LIBS: -lproj
>>>>>  checking PROJ header API:... yes
>>>>>  checking whether the C++ compiler works... yes
>>>>>  checking for C++ compiler default output file name... a.out
>>>>>  checking for suffix of executables...
>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>  `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>>>>> configure:  error: cannot run C++ compiled programs.
>>>>>  If you meant to cross compile, use `--host'.
>>>>>  See `config.log' for more details
>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>  * removing
>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>  Warning in install.packages :
>>>>>    installation of package
>>>>>    ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit
>>>>>    status
>>>>> 
>>>>> 
>>>>>
>>>>>  El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
>>>>>  escribi?:
>>>>>>
>>>>>>  On Sun, 28 Jun 2020, Roger Bivand wrote:
>>>>>>
>>>>>>>  Vero,
>>>>>>>
>>>>>>>  On Sat, 27 Jun 2020, Veronica Andreo wrote:
>>>>>>>
>>>>>>>>   See the attached config.log file
>>>>>>>> 
>>>>>>>
>>>>>>>  How did you install R itself? If an rpm, then
>>>>>>>
>>>>>>>  https://github.com/r-spatial/sf/issues/1369
>>>>>>>
>>>>>>>  may be relevant, also if you see errors installing sf. You would need
>>>>>>>  to
>>>>>>>  unset LDFLAGS before installing:
>>>>>>>
>>>>>>>  https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>>>>>>>
>>>>>>>  Please report back on this.
>>>>>>
>>>>>>  LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>>>>>
>>>>>>  https://r-forge.r-project.org/R/?group_id=884
>>>>>>
>>>>>>  includes a new configure argument --disable-loadflags to assist in
>>>>>>  unsetting the very specific R rpm LDFLAGS. Please report if this fixes
>>>>>>  the
>>>>>>  problem.
>>>>>>
>>>>>>  Roger
>>>>>> 
>>>>>> 
>>>>>>>
>>>>>>>  Roger
>>>>>>>
>>>>>>>>   El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>>>>>>>   (<veroandreo at gmail.com>)
>>>>>>>>   escribi?:
>>>>>>>>
>>>>>>>>>   Hello everyone
>>>>>>>>>
>>>>>>>>>   I have just updated my system to fedora 32 (which fetched GDAL 3
>>>>>>>>>   and PROJ
>>>>>>>>>   6) and when updating my R packages, I get the following error for
>>>>>>>>>   rgdal.
>>>>>>>>>   Can someone help me out here? What does it mean that it cannot run
>>>>>>>>>   C++
>>>>>>>>>   compiled programs?  And do I want to crosscompile?
>>>>>>>>>
>>>>>>>>>   Thanks much in advance
>>>>>>>>>
>>>>>>>>>   Vero
>>>>>>>>>
>>>>>>>>>   ---
>>>>>>>>>
>>>>>>>>>   install.packages("rgdal")
>>>>>>>>>   Installing package into
>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>>>>   (as ?lib? is unspecified)
>>>>>>>>>   trying URL
>>>>>>>>>   'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>>>>>>>   Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>>>>>>>   ==================================================
>>>>>>>>>   downloaded 2.2 MB
>>>>>>>>>
>>>>>>>>>   * installing *source* package ?rgdal? ...
>>>>>>>>>   ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>>>>   ** using staged installation
>>>>>>>>> configure:   R_HOME: /usr/lib64/R
>>>>>>>>> configure:   CC: gcc -m64
>>>>>>>>> configure:   CXX: g++ -m64 -std=gnu++11
>>>>>>>>> configure:   CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>>>>> configure:   CXX is: g++ -m64 -std=gnu++11
>>>>>>>>> configure:   C++11 support available
>>>>>>>>> configure:   rgdal: 1.5-12
>>>>>>>>>   checking for /usr/bin/svnversion... yes
>>>>>>>>> configure:   svn revision: 1018
>>>>>>>>>   checking for gdal-config... /usr/bin/gdal-config
>>>>>>>>>   checking gdal-config usability... yes
>>>>>>>>> configure:   GDAL: 3.0.4
>>>>>>>>>   checking GDAL version >= 1.11.4... yes
>>>>>>>>>   checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>>>>   checking GDAL: linking with --libs only... yes
>>>>>>>>>   checking GDAL: gdal-config data directory readable... yes
>>>>>>>>>   checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>>>>> configure:   pkg-config proj exists, will use it
>>>>>>>>> configure:   PROJ version: 6.3.2
>>>>>>>>> configure:   PROJ CPP flags: -DPROJ_H_API
>>>>>>>>> configure:   PROJ LIBS: -lproj
>>>>>>>>>   checking PROJ header API:... yes
>>>>>>>>>   checking whether the C++ compiler works... yes
>>>>>>>>>   checking for C++ compiler default output file name... a.out
>>>>>>>>>   checking for suffix of executables...
>>>>>>>>>   checking whether we are cross compiling... configure: error: in
>>>>>>>>>   `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>>>>>>>> configure:   error: cannot run C++ compiled programs. <<<<--- here
>>>>>>>>>   If you meant to cross compile, use `--host'.
>>>>>>>>>   See `config.log' for more details
>>>>>>>>>   ERROR: configuration failed for package ?rgdal?
>>>>>>>>>   * removing
>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>>   * restoring previous
>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>>   Warning in install.packages :
>>>>>>>>>     installation of package ?rgdal? had non-zero exit status
>>>>>>>>>
>>>>>>>>>   ---
>>>>>>>>>
>>>>>>>>>   sessionInfo()
>>>>>>>>>   R version 3.6.3 (2020-02-29)
>>>>>>>>>   Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>>>   Running under: Fedora 32 (Thirty Two)
>>>>>>>>>
>>>>>>>>>   Matrix products: default
>>>>>>>>>   BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>>>>>>>
>>>>>>>>>   Random number generation:
>>>>>>>>>    RNG:     Mersenne-Twister
>>>>>>>>>    Normal:  Inversion
>>>>>>>>>    Sample:  Rounding
>>>>>>>>>
>>>>>>>>>   locale:
>>>>>>>>>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>>>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>>>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>>>>    [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>>>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>>   [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>>
>>>>>>>>>   attached base packages:
>>>>>>>>>   [1] stats     graphics  grDevices utils     datasets  methods
>>>>>>>>>   base
>>>>>>>>>
>>>>>>>>>   loaded via a namespace (and not attached):
>>>>>>>>>   [1] compiler_3.6.3 tools_3.6.3
>>>>>>>>> 
>>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>
>>>>>>  --
>>>>>>  Roger Bivand
>>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>
>>>>>  _______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>>
>>>  --
>>>  Roger Bivand
>>>  Department of Economics, Norwegian School of Economics,
>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>  https://orcid.org/0000-0003-2392-6140
>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From bennet @end|ng |rom um|ch@edu  Mon Jun 29 14:20:39 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Mon, 29 Jun 2020 08:20:39 -0400
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
 <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
 <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
Message-ID: <CAB2ovot4czgs-=yKSxvbUhaZRe5MGvfzPDuORts1PYUH=CsuYQ@mail.gmail.com>

Roger,

I believe the redhat-rpm-config package is actually the culprit that
introduces the problem.  It's missing in the sense that it gets pulled
in when it is not there.  There is something to that effect in the
Change Log for the Fedora R package, I believe, but it's not very
informative other than to say it is happening.

Sorry, I should have been more clear.

-- bennet




On Mon, Jun 29, 2020 at 3:57 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> Bennet,
>
> Thanks for the careful analysis.
>
> On Sun, 28 Jun 2020, Bennet Fauber wrote:
>
> > Roger,
> >
> > This seems to be an outcome of a 'security' policy that
> > RedHat/Fedora/CentOS implemented.  There are some circumstances where
> > I think that could be justified, but I do not think compiling R is one
> > of them.
> >
> > It was reported several times to RedHat's Bugzilla and basically
> > ignored by RedHat at least as far back as 2015-12-02.  There are
> > several reports of slightly different versions of the report, but none
> > of them got acted upon.  Some details and links to other issues marked
> > as duplicates (but also seemingly closed without any attention or
> > action) can be found at
> >
> >    https://bugzilla.redhat.com/show_bug.cgi?id=1287743
> >
>
> https://bugzilla.redhat.com/show_bug.cgi?id=1343892 includes more
> information. Many traces in search suggest that a missing
> redhat-rpm-config package is to blame, but it is certainly present on my
> test system.
>
> The Redhat policy positions are specified in:
>
> https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/
>
> but do not seem to resolve the conflict between autoconf and
> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld.
>
> I'll raise this on the R fedora list.
>
> Roger
>
> > The version of R-rgdal that is in the Fedora archive as a binary is
> > rgdal_1.4-8 and that .srpm will build, however if it is updated to use
> > rgdal_1.5-12 it fails the same way that it does with the source build.
> >
> >
> >
> > On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >>
> >> On Sun, 28 Jun 2020, Ista Zahn wrote:
> >>
> >>> I can reproduce this error using the official Fedora 32 docker image:
> >>
> >> The error is in the RPM propagating its LDFLAGS which are  not needed (or
> >> cause no havoc) in simple tests for C compiler functionality in
> >> ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
> >> svn rev. 1020 configure argument --disable-loadflags. The load flags are
> >> far more than is sensibly needed to check whether the compile train works.
> >> I have used RH, RHEL and Fedora since the last century, and have always
> >> installed R from source. Recently, the TexLive packaging system drew in
> >> (totally unecessarily) a dependency on the R rpm, which I now have to
> >> avoid using. My rpm:
> >>
> >> $ /usr/bin/R CMD config LDFLAGS
> >> -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>
> >> and compiled from source:
> >>
> >> $ R CMD config LDFLAGS
> >> -L/usr/local/lib64
> >>
> >> Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
> >> 504 in configure.ac) is unknown for me, hence the need for the workaround.
> >>
> >> I advise strongly against binary packaging of rgdal for Linux, and was not
> >> aware that any such packaging had been attempted. Changes in GDAL and PROJ
> >> happen fast, and Fedora/Centos etc. have been really slow to update.
> >>
> >> If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
> >> and can explain why they are needed and how to run a cross platform
> >> configure script without having to special-case platforms, I'd be mildly
> >> interested to know. sf has also been through similar trouble as mentioned
> >> earlier in this thread.
> >>
> >> Roger
> >>
> >>>
> >>> docker run -it library/fedora:32
> >>> dnf install 'dnf-command(builddep)'
> >>> dnf builddep R-rgdal
> >>> R
> >>> install.packages("rgdal")
> >>>
> >>> * installing *source* package ?rgdal? ...
> >>> ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>> ** using staged installation
> >>> configure: R_HOME: /usr/lib64/R
> >>> configure: CC: gcc -m64
> >>> configure: CXX: g++ -m64 -std=gnu++11
> >>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>> configure: CXX is: g++ -m64 -std=gnu++11
> >>> configure: C++11 support available
> >>> configure: rgdal: 1.5-12
> >>> checking for /usr/bin/svnversion... no
> >>> configure: svn revision: 1018
> >>> checking for gdal-config... /usr/bin/gdal-config
> >>> checking gdal-config usability... yes
> >>> configure: GDAL: 3.0.4
> >>> checking GDAL version >= 1.11.4... yes
> >>> checking GDAL version <= 2.5 or >= 3.0... yes
> >>> checking GDAL: linking with --libs only... yes
> >>> checking GDAL: gdal-config data directory readable... yes
> >>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>> configure: pkg-config proj exists, will use it
> >>> configure: PROJ version: 6.3.2
> >>> configure: PROJ CPP flags: -DPROJ_H_API
> >>> configure: PROJ LIBS: -lproj
> >>> checking PROJ header API:... yes
> >>> checking whether the C++ compiler works... yes
> >>> checking for C++ compiler default output file name... a.out
> >>> checking for suffix of executables...
> >>> checking whether we are cross compiling... configure: error: in
> >>> `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
> >>> configure: error: cannot run C++ compiled programs.
> >>> If you meant to cross compile, use `--host'.
> >>> See `config.log' for more details
> >>> ERROR: configuration failed for package ?rgdal?
> >>> * removing ?/usr/lib64/R/library/rgdal?
> >>>
> >>> The downloaded source packages are in
> >>>        ?/tmp/RtmpooFgiH/downloaded_packages?
> >>> Updating HTML index of packages in '.Library'
> >>> Warning messages:
> >>> 1: In install.packages("rgdal") :
> >>>  installation of package ?rgdal? had non-zero exit status
> >>> 2: In file.create(f.tg) :
> >>>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
> >>> such file or directory'
> >>> 3: In make.packages.html(.Library) : cannot update HTML package index
> >>>>
> >>>
> >>> I don't have any insight into what happens here, but it is reproducible.
> >>>
> >>> Best,
> >>> Ista
> >>>
> >>> On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com> wrote:
> >>>>
> >>>> Dear Roger,
> >>>>
> >>>> Thanks for the answer.
> >>>>
> >>>> R is installed from Fedora repos and no, I do not have any issues with sf. It installs and loads just fine.
> >>>>
> >>>> I downloaded the new rgdal tar.gz from R-forge, but I get the same error that was reported yesterday; config.log file attached. The first error I see there is in line 98-99 about a -V not recognized and then another one for -qversion. Are those relevant?
> >>>>
> >>>> Vero
> >>>> ---
> >>>> install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type = "source")
> >>>> Installing package into ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>> (as ?lib? is unspecified)
> >>>> * installing *source* package ?rgdal? ...
> >>>> ** using staged installation
> >>>> configure: R_HOME: /usr/lib64/R
> >>>> configure: CC: gcc -m64
> >>>> configure: CXX: g++ -m64 -std=gnu++11
> >>>> configure: CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection
> >>>> configure: CPPFLAGS: -I/usr/local/include
> >>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>>> loadflags: yes
> >>>> configure: LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>>> configure: CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>> configure: CXX is: g++ -m64 -std=gnu++11
> >>>> configure: C++11 support available
> >>>> configure: rgdal: 1.5-13
> >>>> checking for /usr/bin/svnversion... yes
> >>>> cat: inst/SVN_VERSION: No such file or directory
> >>>> configure: svn revision:
> >>>> checking for gdal-config... /usr/bin/gdal-config
> >>>> checking gdal-config usability... yes
> >>>> configure: GDAL: 3.0.4
> >>>> checking GDAL version >= 1.11.4... yes
> >>>> checking GDAL version <= 2.5 or >= 3.0... yes
> >>>> checking GDAL: linking with --libs only... yes
> >>>> checking GDAL: gdal-config data directory readable... yes
> >>>> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>> configure: pkg-config proj exists, will use it
> >>>> configure: PROJ version: 6.3.2
> >>>> configure: PROJ CPP flags: -DPROJ_H_API
> >>>> configure: PROJ LIBS: -lproj
> >>>> checking PROJ header API:... yes
> >>>> checking whether the C++ compiler works... yes
> >>>> checking for C++ compiler default output file name... a.out
> >>>> checking for suffix of executables...
> >>>> checking whether we are cross compiling... configure: error: in `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> >>>> configure: error: cannot run C++ compiled programs.
> >>>> If you meant to cross compile, use `--host'.
> >>>> See `config.log' for more details
> >>>> ERROR: configuration failed for package ?rgdal?
> >>>> * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>> Warning in install.packages :
> >>>>   installation of package ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit status
> >>>>
> >>>>
> >>>>
> >>>> El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>) escribi?:
> >>>>>
> >>>>> On Sun, 28 Jun 2020, Roger Bivand wrote:
> >>>>>
> >>>>>> Vero,
> >>>>>>
> >>>>>> On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >>>>>>
> >>>>>>>  See the attached config.log file
> >>>>>>>
> >>>>>>
> >>>>>> How did you install R itself? If an rpm, then
> >>>>>>
> >>>>>> https://github.com/r-spatial/sf/issues/1369
> >>>>>>
> >>>>>> may be relevant, also if you see errors installing sf. You would need to
> >>>>>> unset LDFLAGS before installing:
> >>>>>>
> >>>>>> https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >>>>>>
> >>>>>> Please report back on this.
> >>>>>
> >>>>> LDFLAGS needs unsetting. Revision 1020 on R-Forge
> >>>>>
> >>>>> https://r-forge.r-project.org/R/?group_id=884
> >>>>>
> >>>>> includes a new configure argument --disable-loadflags to assist in
> >>>>> unsetting the very specific R rpm LDFLAGS. Please report if this fixes the
> >>>>> problem.
> >>>>>
> >>>>> Roger
> >>>>>
> >>>>>
> >>>>>>
> >>>>>> Roger
> >>>>>>
> >>>>>>>  El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >>>>>>>  (<veroandreo at gmail.com>)
> >>>>>>>  escribi?:
> >>>>>>>
> >>>>>>>>  Hello everyone
> >>>>>>>>
> >>>>>>>>  I have just updated my system to fedora 32 (which fetched GDAL 3 and PROJ
> >>>>>>>>  6) and when updating my R packages, I get the following error for rgdal.
> >>>>>>>>  Can someone help me out here? What does it mean that it cannot run C++
> >>>>>>>>  compiled programs?  And do I want to crosscompile?
> >>>>>>>>
> >>>>>>>>  Thanks much in advance
> >>>>>>>>
> >>>>>>>>  Vero
> >>>>>>>>
> >>>>>>>>  ---
> >>>>>>>>
> >>>>>>>>  install.packages("rgdal")
> >>>>>>>>  Installing package into
> >>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>>>>>>  (as ?lib? is unspecified)
> >>>>>>>>  trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >>>>>>>>  Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >>>>>>>>  ==================================================
> >>>>>>>>  downloaded 2.2 MB
> >>>>>>>>
> >>>>>>>>  * installing *source* package ?rgdal? ...
> >>>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>>>>>>  ** using staged installation
> >>>>>>>> configure:  R_HOME: /usr/lib64/R
> >>>>>>>> configure:  CC: gcc -m64
> >>>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
> >>>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>>>>>>> configure:  C++11 support available
> >>>>>>>> configure:  rgdal: 1.5-12
> >>>>>>>>  checking for /usr/bin/svnversion... yes
> >>>>>>>> configure:  svn revision: 1018
> >>>>>>>>  checking for gdal-config... /usr/bin/gdal-config
> >>>>>>>>  checking gdal-config usability... yes
> >>>>>>>> configure:  GDAL: 3.0.4
> >>>>>>>>  checking GDAL version >= 1.11.4... yes
> >>>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>>>>>  checking GDAL: linking with --libs only... yes
> >>>>>>>>  checking GDAL: gdal-config data directory readable... yes
> >>>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>>>>>> configure:  pkg-config proj exists, will use it
> >>>>>>>> configure:  PROJ version: 6.3.2
> >>>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>>>>>>> configure:  PROJ LIBS: -lproj
> >>>>>>>>  checking PROJ header API:... yes
> >>>>>>>>  checking whether the C++ compiler works... yes
> >>>>>>>>  checking for C++ compiler default output file name... a.out
> >>>>>>>>  checking for suffix of executables...
> >>>>>>>>  checking whether we are cross compiling... configure: error: in
> >>>>>>>>  `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >>>>>>>> configure:  error: cannot run C++ compiled programs. <<<<--- here
> >>>>>>>>  If you meant to cross compile, use `--host'.
> >>>>>>>>  See `config.log' for more details
> >>>>>>>>  ERROR: configuration failed for package ?rgdal?
> >>>>>>>>  * removing ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>>  * restoring previous
> >>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>>  Warning in install.packages :
> >>>>>>>>    installation of package ?rgdal? had non-zero exit status
> >>>>>>>>
> >>>>>>>>  ---
> >>>>>>>>
> >>>>>>>>  sessionInfo()
> >>>>>>>>  R version 3.6.3 (2020-02-29)
> >>>>>>>>  Platform: x86_64-redhat-linux-gnu (64-bit)
> >>>>>>>>  Running under: Fedora 32 (Thirty Two)
> >>>>>>>>
> >>>>>>>>  Matrix products: default
> >>>>>>>>  BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >>>>>>>>
> >>>>>>>>  Random number generation:
> >>>>>>>>   RNG:     Mersenne-Twister
> >>>>>>>>   Normal:  Inversion
> >>>>>>>>   Sample:  Rounding
> >>>>>>>>
> >>>>>>>>  locale:
> >>>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>>>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>>>>>>>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>>>>>>
> >>>>>>>>  attached base packages:
> >>>>>>>>  [1] stats     graphics  grDevices utils     datasets  methods   base
> >>>>>>>>
> >>>>>>>>  loaded via a namespace (and not attached):
> >>>>>>>>  [1] compiler_3.6.3 tools_3.6.3
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>
> >>>>> --
> >>>>> Roger Bivand
> >>>>> Department of Economics, Norwegian School of Economics,
> >>>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>> https://orcid.org/0000-0003-2392-6140
> >>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>
> >>>> _______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at r-project.org
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From bennet @end|ng |rom um|ch@edu  Mon Jun 29 14:27:20 2020
From: bennet @end|ng |rom um|ch@edu (Bennet Fauber)
Date: Mon, 29 Jun 2020 08:27:20 -0400
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <alpine.LFD.2.22.394.2006291356230.2961111@reclus.nhh.no>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
 <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
 <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006291356230.2961111@reclus.nhh.no>
Message-ID: <CAB2ovoskTnm_D-pHmYC8M7rC_FK7AMKSUUPZ0LLkQzKSb5ppEg@mail.gmail.com>

Thanks for the update, Roger!  Very glad you got a response so
quickly, and a fix to match.

I would reiterate I?aki's warning to folks.

    ...note that CPPFLAGS are *not* CXXFLAGS; I say this because it's
a common mistake

CPPFLAGS -> C preprocessor and are use to specify include files
CXXFLAGS -> C++ compilation flags

I have hurt myself several times thinking that CPP must be C Plus
Plus, not C Pre Processor.

On Mon, Jun 29, 2020 at 8:03 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> In thread
> https://stat.ethz.ch/pipermail/r-sig-fedora/2020-June/000653.html, I?aki
> ?car explains that, following the introduction of AC_LANG(C++) into
> configure.ac about 11 June, the Fedora R rpm would also need CXXFLAGS set.
>
> Having added : ${CXXFLAGS=`"${RBIN}" CMD config CXXFLAGS`} to
> configure.ac, I can confirm that the work-around flag is not needed, and
> that (once R-forge revision 1021 completes), install.packages("rgdal",
> repos="http://R-Forge.R-project.org") should work on Fedora R rpm
> platforms. Those affected please check and confirm.
>
> Many thanks to Bennet and I?aki!
>
> Roger
>
> On Mon, 29 Jun 2020, Roger Bivand wrote:
>
> > Bennet,
> >
> > Thanks for the careful analysis.
> >
> > On Sun, 28 Jun 2020, Bennet Fauber wrote:
> >
> >>  Roger,
> >>
> >>  This seems to be an outcome of a 'security' policy that
> >>  RedHat/Fedora/CentOS implemented.  There are some circumstances where
> >>  I think that could be justified, but I do not think compiling R is one
> >>  of them.
> >>
> >>  It was reported several times to RedHat's Bugzilla and basically
> >>  ignored by RedHat at least as far back as 2015-12-02.  There are
> >>  several reports of slightly different versions of the report, but none
> >>  of them got acted upon.  Some details and links to other issues marked
> >>  as duplicates (but also seemingly closed without any attention or
> >>  action) can be found at
> >>
> >>     https://bugzilla.redhat.com/show_bug.cgi?id=1287743
> >>
> >
> > https://bugzilla.redhat.com/show_bug.cgi?id=1343892 includes more
> > information. Many traces in search suggest that a missing redhat-rpm-config
> > package is to blame, but it is certainly present on my test system.
> >
> > The Redhat policy positions are specified in:
> >
> > https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/
> >
> > but do not seem to resolve the conflict between autoconf and
> > -specs=/usr/lib/rpm/redhat/redhat-hardened-ld.
> >
> > I'll raise this on the R fedora list.
> >
> > Roger
> >
> >>  The version of R-rgdal that is in the Fedora archive as a binary is
> >>  rgdal_1.4-8 and that .srpm will build, however if it is updated to use
> >>  rgdal_1.5-12 it fails the same way that it does with the source build.
> >>
> >>
> >>
> >>  On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >>>
> >>>  On Sun, 28 Jun 2020, Ista Zahn wrote:
> >>>
> >>>>  I can reproduce this error using the official Fedora 32 docker image:
> >>>
> >>>  The error is in the RPM propagating its LDFLAGS which are  not needed (or
> >>>  cause no havoc) in simple tests for C compiler functionality in
> >>>  ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
> >>>  svn rev. 1020 configure argument --disable-loadflags. The load flags are
> >>>  far more than is sensibly needed to check whether the compile train
> >>>  works.
> >>>  I have used RH, RHEL and Fedora since the last century, and have always
> >>>  installed R from source. Recently, the TexLive packaging system drew in
> >>>  (totally unecessarily) a dependency on the R rpm, which I now have to
> >>>  avoid using. My rpm:
> >>>
> >>>  $ /usr/bin/R CMD config LDFLAGS
> >>>  -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >>>  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>>
> >>>  and compiled from source:
> >>>
> >>>  $ R CMD config LDFLAGS
> >>>  -L/usr/local/lib64
> >>>
> >>>  Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
> >>>  504 in configure.ac) is unknown for me, hence the need for the
> >>>  workaround.
> >>>
> >>>  I advise strongly against binary packaging of rgdal for Linux, and was
> >>>  not
> >>>  aware that any such packaging had been attempted. Changes in GDAL and
> >>>  PROJ
> >>>  happen fast, and Fedora/Centos etc. have been really slow to update.
> >>>
> >>>  If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
> >>>  and can explain why they are needed and how to run a cross platform
> >>>  configure script without having to special-case platforms, I'd be mildly
> >>>  interested to know. sf has also been through similar trouble as mentioned
> >>>  earlier in this thread.
> >>>
> >>>  Roger
> >>>
> >>>>
> >>>>  docker run -it library/fedora:32
> >>>>  dnf install 'dnf-command(builddep)'
> >>>>  dnf builddep R-rgdal
> >>>>  R
> >>>>  install.packages("rgdal")
> >>>>
> >>>>  * installing *source* package ?rgdal? ...
> >>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>>  ** using staged installation
> >>>> configure:  R_HOME: /usr/lib64/R
> >>>> configure:  CC: gcc -m64
> >>>> configure:  CXX: g++ -m64 -std=gnu++11
> >>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>>> configure:  C++11 support available
> >>>> configure:  rgdal: 1.5-12
> >>>>  checking for /usr/bin/svnversion... no
> >>>> configure:  svn revision: 1018
> >>>>  checking for gdal-config... /usr/bin/gdal-config
> >>>>  checking gdal-config usability... yes
> >>>> configure:  GDAL: 3.0.4
> >>>>  checking GDAL version >= 1.11.4... yes
> >>>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>  checking GDAL: linking with --libs only... yes
> >>>>  checking GDAL: gdal-config data directory readable... yes
> >>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>> configure:  pkg-config proj exists, will use it
> >>>> configure:  PROJ version: 6.3.2
> >>>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>>> configure:  PROJ LIBS: -lproj
> >>>>  checking PROJ header API:... yes
> >>>>  checking whether the C++ compiler works... yes
> >>>>  checking for C++ compiler default output file name... a.out
> >>>>  checking for suffix of executables...
> >>>>  checking whether we are cross compiling... configure: error: in
> >>>>  `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
> >>>> configure:  error: cannot run C++ compiled programs.
> >>>>  If you meant to cross compile, use `--host'.
> >>>>  See `config.log' for more details
> >>>>  ERROR: configuration failed for package ?rgdal?
> >>>>  * removing ?/usr/lib64/R/library/rgdal?
> >>>>
> >>>>  The downloaded source packages are in
> >>>>         ?/tmp/RtmpooFgiH/downloaded_packages?
> >>>>  Updating HTML index of packages in '.Library'
> >>>>  Warning messages:
> >>>>  1: In install.packages("rgdal") :
> >>>>  installation of package ?rgdal? had non-zero exit status
> >>>>  2: In file.create(f.tg) :
> >>>>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
> >>>>  such file or directory'
> >>>>  3: In make.packages.html(.Library) : cannot update HTML package index
> >>>>>
> >>>>
> >>>>  I don't have any insight into what happens here, but it is reproducible.
> >>>>
> >>>>  Best,
> >>>>  Ista
> >>>>
> >>>>  On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
> >>>>  wrote:
> >>>>>
> >>>>>  Dear Roger,
> >>>>>
> >>>>>  Thanks for the answer.
> >>>>>
> >>>>>  R is installed from Fedora repos and no, I do not have any issues with
> >>>>>  sf. It installs and loads just fine.
> >>>>>
> >>>>>  I downloaded the new rgdal tar.gz from R-forge, but I get the same
> >>>>>  error that was reported yesterday; config.log file attached. The first
> >>>>>  error I see there is in line 98-99 about a -V not recognized and then
> >>>>>  another one for -qversion. Are those relevant?
> >>>>>
> >>>>>  Vero
> >>>>>  ---
> >>>>>  install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type
> >>>>>  = "source")
> >>>>>  Installing package into
> >>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>>>  (as ?lib? is unspecified)
> >>>>>  * installing *source* package ?rgdal? ...
> >>>>>  ** using staged installation
> >>>>> configure:  R_HOME: /usr/lib64/R
> >>>>> configure:  CC: gcc -m64
> >>>>> configure:  CXX: g++ -m64 -std=gnu++11
> >>>>> configure:  CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
> >>>>> configure:  -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS
> >>>>> configure:  -fexceptions -fstack-protector-strong -grecord-gcc-switches
> >>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
> >>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64
> >>>>> configure:  -mtune=generic -fasynchronous-unwind-tables
> >>>>> configure:  -fstack-clash-protection -fcf-protection
> >>>>> configure:  CPPFLAGS: -I/usr/local/include
> >>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>>>>  loadflags: yes
> >>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
> >>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
> >>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>>> configure:  CXX is: g++ -m64 -std=gnu++11
> >>>>> configure:  C++11 support available
> >>>>> configure:  rgdal: 1.5-13
> >>>>>  checking for /usr/bin/svnversion... yes
> >>>>>  cat: inst/SVN_VERSION: No such file or directory
> >>>>> configure:  svn revision:
> >>>>>  checking for gdal-config... /usr/bin/gdal-config
> >>>>>  checking gdal-config usability... yes
> >>>>> configure:  GDAL: 3.0.4
> >>>>>  checking GDAL version >= 1.11.4... yes
> >>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>>  checking GDAL: linking with --libs only... yes
> >>>>>  checking GDAL: gdal-config data directory readable... yes
> >>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>>> configure:  pkg-config proj exists, will use it
> >>>>> configure:  PROJ version: 6.3.2
> >>>>> configure:  PROJ CPP flags: -DPROJ_H_API
> >>>>> configure:  PROJ LIBS: -lproj
> >>>>>  checking PROJ header API:... yes
> >>>>>  checking whether the C++ compiler works... yes
> >>>>>  checking for C++ compiler default output file name... a.out
> >>>>>  checking for suffix of executables...
> >>>>>  checking whether we are cross compiling... configure: error: in
> >>>>>  `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
> >>>>> configure:  error: cannot run C++ compiled programs.
> >>>>>  If you meant to cross compile, use `--host'.
> >>>>>  See `config.log' for more details
> >>>>>  ERROR: configuration failed for package ?rgdal?
> >>>>>  * removing
> >>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>  Warning in install.packages :
> >>>>>    installation of package
> >>>>>    ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit
> >>>>>    status
> >>>>>
> >>>>>
> >>>>>
> >>>>>  El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
> >>>>>  escribi?:
> >>>>>>
> >>>>>>  On Sun, 28 Jun 2020, Roger Bivand wrote:
> >>>>>>
> >>>>>>>  Vero,
> >>>>>>>
> >>>>>>>  On Sat, 27 Jun 2020, Veronica Andreo wrote:
> >>>>>>>
> >>>>>>>>   See the attached config.log file
> >>>>>>>>
> >>>>>>>
> >>>>>>>  How did you install R itself? If an rpm, then
> >>>>>>>
> >>>>>>>  https://github.com/r-spatial/sf/issues/1369
> >>>>>>>
> >>>>>>>  may be relevant, also if you see errors installing sf. You would need
> >>>>>>>  to
> >>>>>>>  unset LDFLAGS before installing:
> >>>>>>>
> >>>>>>>  https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
> >>>>>>>
> >>>>>>>  Please report back on this.
> >>>>>>
> >>>>>>  LDFLAGS needs unsetting. Revision 1020 on R-Forge
> >>>>>>
> >>>>>>  https://r-forge.r-project.org/R/?group_id=884
> >>>>>>
> >>>>>>  includes a new configure argument --disable-loadflags to assist in
> >>>>>>  unsetting the very specific R rpm LDFLAGS. Please report if this fixes
> >>>>>>  the
> >>>>>>  problem.
> >>>>>>
> >>>>>>  Roger
> >>>>>>
> >>>>>>
> >>>>>>>
> >>>>>>>  Roger
> >>>>>>>
> >>>>>>>>   El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
> >>>>>>>>   (<veroandreo at gmail.com>)
> >>>>>>>>   escribi?:
> >>>>>>>>
> >>>>>>>>>   Hello everyone
> >>>>>>>>>
> >>>>>>>>>   I have just updated my system to fedora 32 (which fetched GDAL 3
> >>>>>>>>>   and PROJ
> >>>>>>>>>   6) and when updating my R packages, I get the following error for
> >>>>>>>>>   rgdal.
> >>>>>>>>>   Can someone help me out here? What does it mean that it cannot run
> >>>>>>>>>   C++
> >>>>>>>>>   compiled programs?  And do I want to crosscompile?
> >>>>>>>>>
> >>>>>>>>>   Thanks much in advance
> >>>>>>>>>
> >>>>>>>>>   Vero
> >>>>>>>>>
> >>>>>>>>>   ---
> >>>>>>>>>
> >>>>>>>>>   install.packages("rgdal")
> >>>>>>>>>   Installing package into
> >>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
> >>>>>>>>>   (as ?lib? is unspecified)
> >>>>>>>>>   trying URL
> >>>>>>>>>   'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
> >>>>>>>>>   Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
> >>>>>>>>>   ==================================================
> >>>>>>>>>   downloaded 2.2 MB
> >>>>>>>>>
> >>>>>>>>>   * installing *source* package ?rgdal? ...
> >>>>>>>>>   ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>>>>>>>>   ** using staged installation
> >>>>>>>>> configure:   R_HOME: /usr/lib64/R
> >>>>>>>>> configure:   CC: gcc -m64
> >>>>>>>>> configure:   CXX: g++ -m64 -std=gnu++11
> >>>>>>>>> configure:   CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
> >>>>>>>>> configure:   CXX is: g++ -m64 -std=gnu++11
> >>>>>>>>> configure:   C++11 support available
> >>>>>>>>> configure:   rgdal: 1.5-12
> >>>>>>>>>   checking for /usr/bin/svnversion... yes
> >>>>>>>>> configure:   svn revision: 1018
> >>>>>>>>>   checking for gdal-config... /usr/bin/gdal-config
> >>>>>>>>>   checking gdal-config usability... yes
> >>>>>>>>> configure:   GDAL: 3.0.4
> >>>>>>>>>   checking GDAL version >= 1.11.4... yes
> >>>>>>>>>   checking GDAL version <= 2.5 or >= 3.0... yes
> >>>>>>>>>   checking GDAL: linking with --libs only... yes
> >>>>>>>>>   checking GDAL: gdal-config data directory readable... yes
> >>>>>>>>>   checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> >>>>>>>>> configure:   pkg-config proj exists, will use it
> >>>>>>>>> configure:   PROJ version: 6.3.2
> >>>>>>>>> configure:   PROJ CPP flags: -DPROJ_H_API
> >>>>>>>>> configure:   PROJ LIBS: -lproj
> >>>>>>>>>   checking PROJ header API:... yes
> >>>>>>>>>   checking whether the C++ compiler works... yes
> >>>>>>>>>   checking for C++ compiler default output file name... a.out
> >>>>>>>>>   checking for suffix of executables...
> >>>>>>>>>   checking whether we are cross compiling... configure: error: in
> >>>>>>>>>   `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
> >>>>>>>>> configure:   error: cannot run C++ compiled programs. <<<<--- here
> >>>>>>>>>   If you meant to cross compile, use `--host'.
> >>>>>>>>>   See `config.log' for more details
> >>>>>>>>>   ERROR: configuration failed for package ?rgdal?
> >>>>>>>>>   * removing
> >>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>>>   * restoring previous
> >>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
> >>>>>>>>>   Warning in install.packages :
> >>>>>>>>>     installation of package ?rgdal? had non-zero exit status
> >>>>>>>>>
> >>>>>>>>>   ---
> >>>>>>>>>
> >>>>>>>>>   sessionInfo()
> >>>>>>>>>   R version 3.6.3 (2020-02-29)
> >>>>>>>>>   Platform: x86_64-redhat-linux-gnu (64-bit)
> >>>>>>>>>   Running under: Fedora 32 (Thirty Two)
> >>>>>>>>>
> >>>>>>>>>   Matrix products: default
> >>>>>>>>>   BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
> >>>>>>>>>
> >>>>>>>>>   Random number generation:
> >>>>>>>>>    RNG:     Mersenne-Twister
> >>>>>>>>>    Normal:  Inversion
> >>>>>>>>>    Sample:  Rounding
> >>>>>>>>>
> >>>>>>>>>   locale:
> >>>>>>>>>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>>>>>>>>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>>>>>>>>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>>>>>>>>    [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>>>>>>>>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>>>>>>>>   [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>>>>>>>
> >>>>>>>>>   attached base packages:
> >>>>>>>>>   [1] stats     graphics  grDevices utils     datasets  methods
> >>>>>>>>>   base
> >>>>>>>>>
> >>>>>>>>>   loaded via a namespace (and not attached):
> >>>>>>>>>   [1] compiler_3.6.3 tools_3.6.3
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>>  --
> >>>>>>  Roger Bivand
> >>>>>>  Department of Economics, Norwegian School of Economics,
> >>>>>>  Helleveien 30, N-5045 Bergen, Norway.
> >>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>>>>  https://orcid.org/0000-0003-2392-6140
> >>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>>>>
> >>>>>  _______________________________________________
> >>>>>  R-sig-Geo mailing list
> >>>>>  R-sig-Geo at r-project.org
> >>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>
> >>>
> >>>  --
> >>>  Roger Bivand
> >>>  Department of Economics, Norwegian School of Economics,
> >>>  Helleveien 30, N-5045 Bergen, Norway.
> >>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >>>  https://orcid.org/0000-0003-2392-6140
> >>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
> >>>  R-sig-Geo mailing list
> >>>  R-sig-Geo at r-project.org
> >>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Jun 29 16:32:29 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 29 Jun 2020 16:32:29 +0200
Subject: [R-sig-Geo] cannot install rgdal after updating to fedora32
In-Reply-To: <CAB2ovoskTnm_D-pHmYC8M7rC_FK7AMKSUUPZ0LLkQzKSb5ppEg@mail.gmail.com>
References: <CAAMki4EV2Okr5SVndPXuxi4yTWFXkV=nwWHM0p1dX0sPFszKgg@mail.gmail.com>
 <CAAMki4HVFSbOqAGw+rRzrikzH7VzcB6PnFdMJSVqjGknLMu-iw@mail.gmail.com>
 <alpine.LFD.2.22.394.2006280837310.2927366@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006281442080.2944189@reclus.nhh.no>
 <CAAMki4HDUJ1gD+giCWqHqB7EKFEgLFUFr-azaQ-b82Z5EnFO0A@mail.gmail.com>
 <CA+vqiLFfica-9Su-OtB9R1h5-=Nsm07Xt=40Jct-5oic--OEWg@mail.gmail.com>
 <alpine.LFD.2.22.394.2006281857480.2945762@reclus.nhh.no>
 <CAB2ovot9LNRFFxQn_S8jiMN66mXNBAxvFaeMS4x57agKxEE1+g@mail.gmail.com>
 <alpine.LFD.2.22.394.2006290949150.2954318@reclus.nhh.no>
 <alpine.LFD.2.22.394.2006291356230.2961111@reclus.nhh.no>
 <CAB2ovoskTnm_D-pHmYC8M7rC_FK7AMKSUUPZ0LLkQzKSb5ppEg@mail.gmail.com>
Message-ID: <alpine.LFD.2.22.394.2006291630140.2964910@reclus.nhh.no>

On Mon, 29 Jun 2020, Bennet Fauber wrote:

> Thanks for the update, Roger!  Very glad you got a response so
> quickly, and a fix to match.

I hope it worked in your case.

>
> I would reiterate I?aki's warning to folks.
>
>    ...note that CPPFLAGS are *not* CXXFLAGS; I say this because it's
> a common mistake
>
> CPPFLAGS -> C preprocessor and are use to specify include files
> CXXFLAGS -> C++ compilation flags
>
> I have hurt myself several times thinking that CPP must be C Plus
> Plus, not C Pre Processor.

Not the case here, CPP was for the pre-processor and had been around a 
long time to try to union the positions of R, GDAL and PROJ if possible.

Roger

>
> On Mon, Jun 29, 2020 at 8:03 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>> In thread
>> https://stat.ethz.ch/pipermail/r-sig-fedora/2020-June/000653.html, I?aki
>> ?car explains that, following the introduction of AC_LANG(C++) into
>> configure.ac about 11 June, the Fedora R rpm would also need CXXFLAGS set.
>>
>> Having added : ${CXXFLAGS=`"${RBIN}" CMD config CXXFLAGS`} to
>> configure.ac, I can confirm that the work-around flag is not needed, and
>> that (once R-forge revision 1021 completes), install.packages("rgdal",
>> repos="http://R-Forge.R-project.org") should work on Fedora R rpm
>> platforms. Those affected please check and confirm.
>>
>> Many thanks to Bennet and I?aki!
>>
>> Roger
>>
>> On Mon, 29 Jun 2020, Roger Bivand wrote:
>>
>>> Bennet,
>>>
>>> Thanks for the careful analysis.
>>>
>>> On Sun, 28 Jun 2020, Bennet Fauber wrote:
>>>
>>>>  Roger,
>>>>
>>>>  This seems to be an outcome of a 'security' policy that
>>>>  RedHat/Fedora/CentOS implemented.  There are some circumstances where
>>>>  I think that could be justified, but I do not think compiling R is one
>>>>  of them.
>>>>
>>>>  It was reported several times to RedHat's Bugzilla and basically
>>>>  ignored by RedHat at least as far back as 2015-12-02.  There are
>>>>  several reports of slightly different versions of the report, but none
>>>>  of them got acted upon.  Some details and links to other issues marked
>>>>  as duplicates (but also seemingly closed without any attention or
>>>>  action) can be found at
>>>>
>>>>     https://bugzilla.redhat.com/show_bug.cgi?id=1287743
>>>>
>>>
>>> https://bugzilla.redhat.com/show_bug.cgi?id=1343892 includes more
>>> information. Many traces in search suggest that a missing redhat-rpm-config
>>> package is to blame, but it is certainly present on my test system.
>>>
>>> The Redhat policy positions are specified in:
>>>
>>> https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/
>>>
>>> but do not seem to resolve the conflict between autoconf and
>>> -specs=/usr/lib/rpm/redhat/redhat-hardened-ld.
>>>
>>> I'll raise this on the R fedora list.
>>>
>>> Roger
>>>
>>>>  The version of R-rgdal that is in the Fedora archive as a binary is
>>>>  rgdal_1.4-8 and that .srpm will build, however if it is updated to use
>>>>  rgdal_1.5-12 it fails the same way that it does with the source build.
>>>>
>>>>
>>>>
>>>>  On Sun, Jun 28, 2020 at 1:17 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>>
>>>>>  On Sun, 28 Jun 2020, Ista Zahn wrote:
>>>>>
>>>>>>  I can reproduce this error using the official Fedora 32 docker image:
>>>>>
>>>>>  The error is in the RPM propagating its LDFLAGS which are  not needed (or
>>>>>  cause no havoc) in simple tests for C compiler functionality in
>>>>>  ./configure. For the arguably broken R rpm, use either LDFLAGS="" or the
>>>>>  svn rev. 1020 configure argument --disable-loadflags. The load flags are
>>>>>  far more than is sensibly needed to check whether the compile train
>>>>>  works.
>>>>>  I have used RH, RHEL and Fedora since the last century, and have always
>>>>>  installed R from source. Recently, the TexLive packaging system drew in
>>>>>  (totally unecessarily) a dependency on the R rpm, which I now have to
>>>>>  avoid using. My rpm:
>>>>>
>>>>>  $ /usr/bin/R CMD config LDFLAGS
>>>>>  -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>>>>>  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>>>
>>>>>  and compiled from source:
>>>>>
>>>>>  $ R CMD config LDFLAGS
>>>>>  -L/usr/local/lib64
>>>>>
>>>>>  Why the rpm LDFLAGS demolish a simple AC_LANG(C++) (guesswork, now line
>>>>>  504 in configure.ac) is unknown for me, hence the need for the
>>>>>  workaround.
>>>>>
>>>>>  I advise strongly against binary packaging of rgdal for Linux, and was
>>>>>  not
>>>>>  aware that any such packaging had been attempted. Changes in GDAL and
>>>>>  PROJ
>>>>>  happen fast, and Fedora/Centos etc. have been really slow to update.
>>>>>
>>>>>  If anyone understands why the R Fedora rpm imposes such vicious LDFLAGS
>>>>>  and can explain why they are needed and how to run a cross platform
>>>>>  configure script without having to special-case platforms, I'd be mildly
>>>>>  interested to know. sf has also been through similar trouble as mentioned
>>>>>  earlier in this thread.
>>>>>
>>>>>  Roger
>>>>>
>>>>>>
>>>>>>  docker run -it library/fedora:32
>>>>>>  dnf install 'dnf-command(builddep)'
>>>>>>  dnf builddep R-rgdal
>>>>>>  R
>>>>>>  install.packages("rgdal")
>>>>>>
>>>>>>  * installing *source* package ?rgdal? ...
>>>>>>  ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>  ** using staged installation
>>>>>> configure:  R_HOME: /usr/lib64/R
>>>>>> configure:  CC: gcc -m64
>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>>> configure:  C++11 support available
>>>>>> configure:  rgdal: 1.5-12
>>>>>>  checking for /usr/bin/svnversion... no
>>>>>> configure:  svn revision: 1018
>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>>  checking gdal-config usability... yes
>>>>>> configure:  GDAL: 3.0.4
>>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>  checking GDAL: linking with --libs only... yes
>>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>> configure:  pkg-config proj exists, will use it
>>>>>> configure:  PROJ version: 6.3.2
>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>>> configure:  PROJ LIBS: -lproj
>>>>>>  checking PROJ header API:... yes
>>>>>>  checking whether the C++ compiler works... yes
>>>>>>  checking for C++ compiler default output file name... a.out
>>>>>>  checking for suffix of executables...
>>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>>  `/tmp/Rtmp2o3TMz/R.INSTALLf5d2a7cbb3e/rgdal':
>>>>>> configure:  error: cannot run C++ compiled programs.
>>>>>>  If you meant to cross compile, use `--host'.
>>>>>>  See `config.log' for more details
>>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>>  * removing ?/usr/lib64/R/library/rgdal?
>>>>>>
>>>>>>  The downloaded source packages are in
>>>>>>         ?/tmp/RtmpooFgiH/downloaded_packages?
>>>>>>  Updating HTML index of packages in '.Library'
>>>>>>  Warning messages:
>>>>>>  1: In install.packages("rgdal") :
>>>>>>  installation of package ?rgdal? had non-zero exit status
>>>>>>  2: In file.create(f.tg) :
>>>>>>  cannot create file '/usr/share/doc/R/html/packages.html', reason 'No
>>>>>>  such file or directory'
>>>>>>  3: In make.packages.html(.Library) : cannot update HTML package index
>>>>>>>
>>>>>>
>>>>>>  I don't have any insight into what happens here, but it is reproducible.
>>>>>>
>>>>>>  Best,
>>>>>>  Ista
>>>>>>
>>>>>>  On Sun, Jun 28, 2020 at 9:42 AM Veronica Andreo <veroandreo at gmail.com>
>>>>>>  wrote:
>>>>>>>
>>>>>>>  Dear Roger,
>>>>>>>
>>>>>>>  Thanks for the answer.
>>>>>>>
>>>>>>>  R is installed from Fedora repos and no, I do not have any issues with
>>>>>>>  sf. It installs and loads just fine.
>>>>>>>
>>>>>>>  I downloaded the new rgdal tar.gz from R-forge, but I get the same
>>>>>>>  error that was reported yesterday; config.log file attached. The first
>>>>>>>  error I see there is in line 98-99 about a -V not recognized and then
>>>>>>>  another one for -qversion. Are those relevant?
>>>>>>>
>>>>>>>  Vero
>>>>>>>  ---
>>>>>>>  install.packages("~/Downloads/rgdal_1.5-13.tar.gz", repos = NULL, type
>>>>>>>  = "source")
>>>>>>>  Installing package into
>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>>  (as ?lib? is unspecified)
>>>>>>>  * installing *source* package ?rgdal? ...
>>>>>>>  ** using staged installation
>>>>>>> configure:  R_HOME: /usr/lib64/R
>>>>>>> configure:  CC: gcc -m64
>>>>>>> configure:  CXX: g++ -m64 -std=gnu++11
>>>>>>> configure:  CFLAGS: -O2 -g -pipe -Wall -Werror=format-security
>>>>>>> configure:  -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS
>>>>>>> configure:  -fexceptions -fstack-protector-strong -grecord-gcc-switches
>>>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1
>>>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64
>>>>>>> configure:  -mtune=generic -fasynchronous-unwind-tables
>>>>>>> configure:  -fstack-clash-protection -fcf-protection
>>>>>>> configure:  CPPFLAGS: -I/usr/local/include
>>>>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>>>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>>>>>  loadflags: yes
>>>>>>> configure:  LDFLAGS: -Wl,-z,relro -Wl,--as-needed -Wl,-z,now
>>>>>>> configure:  -specs=/usr/lib/rpm/redhat/redhat-hardened-ld
>>>>>>> configure:  CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>>> configure:  CXX is: g++ -m64 -std=gnu++11
>>>>>>> configure:  C++11 support available
>>>>>>> configure:  rgdal: 1.5-13
>>>>>>>  checking for /usr/bin/svnversion... yes
>>>>>>>  cat: inst/SVN_VERSION: No such file or directory
>>>>>>> configure:  svn revision:
>>>>>>>  checking for gdal-config... /usr/bin/gdal-config
>>>>>>>  checking gdal-config usability... yes
>>>>>>> configure:  GDAL: 3.0.4
>>>>>>>  checking GDAL version >= 1.11.4... yes
>>>>>>>  checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>>  checking GDAL: linking with --libs only... yes
>>>>>>>  checking GDAL: gdal-config data directory readable... yes
>>>>>>>  checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>>> configure:  pkg-config proj exists, will use it
>>>>>>> configure:  PROJ version: 6.3.2
>>>>>>> configure:  PROJ CPP flags: -DPROJ_H_API
>>>>>>> configure:  PROJ LIBS: -lproj
>>>>>>>  checking PROJ header API:... yes
>>>>>>>  checking whether the C++ compiler works... yes
>>>>>>>  checking for C++ compiler default output file name... a.out
>>>>>>>  checking for suffix of executables...
>>>>>>>  checking whether we are cross compiling... configure: error: in
>>>>>>>  `/home/veroandreo/tmp/Rtmp9DsGuk/R.INSTALL16352f5a74a/rgdal':
>>>>>>> configure:  error: cannot run C++ compiled programs.
>>>>>>>  If you meant to cross compile, use `--host'.
>>>>>>>  See `config.log' for more details
>>>>>>>  ERROR: configuration failed for package ?rgdal?
>>>>>>>  * removing
>>>>>>>  ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>  Warning in install.packages :
>>>>>>>    installation of package
>>>>>>>    ?/home/veroandreo/Downloads/rgdal_1.5-13.tar.gz? had non-zero exit
>>>>>>>    status
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>  El dom., 28 jun. 2020 a las 14:44, Roger Bivand (<Roger.Bivand at nhh.no>)
>>>>>>>  escribi?:
>>>>>>>>
>>>>>>>>  On Sun, 28 Jun 2020, Roger Bivand wrote:
>>>>>>>>
>>>>>>>>>  Vero,
>>>>>>>>>
>>>>>>>>>  On Sat, 27 Jun 2020, Veronica Andreo wrote:
>>>>>>>>>
>>>>>>>>>>   See the attached config.log file
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  How did you install R itself? If an rpm, then
>>>>>>>>>
>>>>>>>>>  https://github.com/r-spatial/sf/issues/1369
>>>>>>>>>
>>>>>>>>>  may be relevant, also if you see errors installing sf. You would need
>>>>>>>>>  to
>>>>>>>>>  unset LDFLAGS before installing:
>>>>>>>>>
>>>>>>>>>  https://github.com/r-spatial/sf/issues/1369#issuecomment-614096865
>>>>>>>>>
>>>>>>>>>  Please report back on this.
>>>>>>>>
>>>>>>>>  LDFLAGS needs unsetting. Revision 1020 on R-Forge
>>>>>>>>
>>>>>>>>  https://r-forge.r-project.org/R/?group_id=884
>>>>>>>>
>>>>>>>>  includes a new configure argument --disable-loadflags to assist in
>>>>>>>>  unsetting the very specific R rpm LDFLAGS. Please report if this fixes
>>>>>>>>  the
>>>>>>>>  problem.
>>>>>>>>
>>>>>>>>  Roger
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>>  Roger
>>>>>>>>>
>>>>>>>>>>   El s?b., 27 jun. 2020 a las 21:29, Veronica Andreo
>>>>>>>>>>   (<veroandreo at gmail.com>)
>>>>>>>>>>   escribi?:
>>>>>>>>>>
>>>>>>>>>>>   Hello everyone
>>>>>>>>>>>
>>>>>>>>>>>   I have just updated my system to fedora 32 (which fetched GDAL 3
>>>>>>>>>>>   and PROJ
>>>>>>>>>>>   6) and when updating my R packages, I get the following error for
>>>>>>>>>>>   rgdal.
>>>>>>>>>>>   Can someone help me out here? What does it mean that it cannot run
>>>>>>>>>>>   C++
>>>>>>>>>>>   compiled programs?  And do I want to crosscompile?
>>>>>>>>>>>
>>>>>>>>>>>   Thanks much in advance
>>>>>>>>>>>
>>>>>>>>>>>   Vero
>>>>>>>>>>>
>>>>>>>>>>>   ---
>>>>>>>>>>>
>>>>>>>>>>>   install.packages("rgdal")
>>>>>>>>>>>   Installing package into
>>>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6?
>>>>>>>>>>>   (as ?lib? is unspecified)
>>>>>>>>>>>   trying URL
>>>>>>>>>>>   'http://cran.rstudio.com/src/contrib/rgdal_1.5-12.tar.gz'
>>>>>>>>>>>   Content type 'application/x-gzip' length 2302403 bytes (2.2 MB)
>>>>>>>>>>>   ==================================================
>>>>>>>>>>>   downloaded 2.2 MB
>>>>>>>>>>>
>>>>>>>>>>>   * installing *source* package ?rgdal? ...
>>>>>>>>>>>   ** package ?rgdal? successfully unpacked and MD5 sums checked
>>>>>>>>>>>   ** using staged installation
>>>>>>>>>>> configure:   R_HOME: /usr/lib64/R
>>>>>>>>>>> configure:   CC: gcc -m64
>>>>>>>>>>> configure:   CXX: g++ -m64 -std=gnu++11
>>>>>>>>>>> configure:   CXX11 is: g++ -m64, CXX11STD is: -std=gnu++11
>>>>>>>>>>> configure:   CXX is: g++ -m64 -std=gnu++11
>>>>>>>>>>> configure:   C++11 support available
>>>>>>>>>>> configure:   rgdal: 1.5-12
>>>>>>>>>>>   checking for /usr/bin/svnversion... yes
>>>>>>>>>>> configure:   svn revision: 1018
>>>>>>>>>>>   checking for gdal-config... /usr/bin/gdal-config
>>>>>>>>>>>   checking gdal-config usability... yes
>>>>>>>>>>> configure:   GDAL: 3.0.4
>>>>>>>>>>>   checking GDAL version >= 1.11.4... yes
>>>>>>>>>>>   checking GDAL version <= 2.5 or >= 3.0... yes
>>>>>>>>>>>   checking GDAL: linking with --libs only... yes
>>>>>>>>>>>   checking GDAL: gdal-config data directory readable... yes
>>>>>>>>>>>   checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
>>>>>>>>>>> configure:   pkg-config proj exists, will use it
>>>>>>>>>>> configure:   PROJ version: 6.3.2
>>>>>>>>>>> configure:   PROJ CPP flags: -DPROJ_H_API
>>>>>>>>>>> configure:   PROJ LIBS: -lproj
>>>>>>>>>>>   checking PROJ header API:... yes
>>>>>>>>>>>   checking whether the C++ compiler works... yes
>>>>>>>>>>>   checking for C++ compiler default output file name... a.out
>>>>>>>>>>>   checking for suffix of executables...
>>>>>>>>>>>   checking whether we are cross compiling... configure: error: in
>>>>>>>>>>>   `/home/veroandreo/tmp/Rtmpo7AtPr/R.INSTALL12cc66f8f895/rgdal':
>>>>>>>>>>> configure:   error: cannot run C++ compiled programs. <<<<--- here
>>>>>>>>>>>   If you meant to cross compile, use `--host'.
>>>>>>>>>>>   See `config.log' for more details
>>>>>>>>>>>   ERROR: configuration failed for package ?rgdal?
>>>>>>>>>>>   * removing
>>>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>>>>   * restoring previous
>>>>>>>>>>>   ?/home/veroandreo/R/x86_64-redhat-linux-gnu-library/3.6/rgdal?
>>>>>>>>>>>   Warning in install.packages :
>>>>>>>>>>>     installation of package ?rgdal? had non-zero exit status
>>>>>>>>>>>
>>>>>>>>>>>   ---
>>>>>>>>>>>
>>>>>>>>>>>   sessionInfo()
>>>>>>>>>>>   R version 3.6.3 (2020-02-29)
>>>>>>>>>>>   Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>>>>>   Running under: Fedora 32 (Thirty Two)
>>>>>>>>>>>
>>>>>>>>>>>   Matrix products: default
>>>>>>>>>>>   BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.9.so
>>>>>>>>>>>
>>>>>>>>>>>   Random number generation:
>>>>>>>>>>>    RNG:     Mersenne-Twister
>>>>>>>>>>>    Normal:  Inversion
>>>>>>>>>>>    Sample:  Rounding
>>>>>>>>>>>
>>>>>>>>>>>   locale:
>>>>>>>>>>>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>>>>>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>>>>>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>>>>>>    [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>>>>>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>>>>   [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>>>>
>>>>>>>>>>>   attached base packages:
>>>>>>>>>>>   [1] stats     graphics  grDevices utils     datasets  methods
>>>>>>>>>>>   base
>>>>>>>>>>>
>>>>>>>>>>>   loaded via a namespace (and not attached):
>>>>>>>>>>>   [1] compiler_3.6.3 tools_3.6.3
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>  --
>>>>>>>>  Roger Bivand
>>>>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>>>>
>>>>>>>  _______________________________________________
>>>>>>>  R-sig-Geo mailing list
>>>>>>>  R-sig-Geo at r-project.org
>>>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>  --
>>>>>  Roger Bivand
>>>>>  Department of Economics, Norwegian School of Economics,
>>>>>  Helleveien 30, N-5045 Bergen, Norway.
>>>>>  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>>>  https://orcid.org/0000-0003-2392-6140
>>>>>  https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en_______________________________________________
>>>>>  R-sig-Geo mailing list
>>>>>  R-sig-Geo at r-project.org
>>>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From em@nue|e@b@rc@ @end|ng |rom b@@|r@@@cnr@|t  Tue Jun 30 13:46:59 2020
From: em@nue|e@b@rc@ @end|ng |rom b@@|r@@@cnr@|t (Emanuele Barca)
Date: Tue, 30 Jun 2020 13:46:59 +0200
Subject: [R-sig-Geo] automatic assessment of linear coregionalization model
Message-ID: <aa73a1bd483d8848403686ec26f39add@ba.irsa.cnr.it>

Dear friend,

I am trying to garner a result similar to that of autofitvariogram() 
function with fit.lmc() function.
But results are not good.
The following is my code:

g <- gstat(id = "Balance", formula = Balance ~ 1, data = mydata.sp, set 
= list(nocheck = 1))
g <- gstat(g, id = "Ancillary", formula = Ancillary ~ 1, data = r.sp, 
set = list(nocheck = 1))
v.g <- variogram(g)
g.fit <- fit.lmc(v.g, g, vgm("Exp",
         model.df$range[2]), fit.method = 1, correct.diagonal = 1.01) # 
fit.lmc = TRUE,
g.fit

the outcome is
data:
Balance : formula = Balance`~`1 ; data dim = 74 x 1
Ancillary : formula = Ancillary`~`1 ; data dim = 18683 x 1
variograms:
                      model     psill    range
Balance[1]             Nug 10.864143     0.00
Balance[2]             Exp  8.128785 12946.87
Ancillary[1]           Nug 43.803405     0.00
Ancillary[2]           Exp 52.100889 16156.90
Balance.Ancillary[1]   Nug 21.598834     0.00
Balance.Ancillary[2]   Exp 20.375770 16151.70
set nocheck = 1;

the results are too weird. Is a data problem?


thanks in advance

emanuele barca
-------------- next part --------------
A non-text attachment was scrubbed...
Name: data.rar
Type: application/x-rar-compressed
Size: 11684 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200630/5d1ce8c7/attachment.bin>

