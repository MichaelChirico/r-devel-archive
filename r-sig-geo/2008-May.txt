From Tom.Mulholland at dpi.wa.gov.au  Thu May  1 04:14:09 2008
From: Tom.Mulholland at dpi.wa.gov.au (Mulholland, Tom)
Date: Thu, 1 May 2008 10:14:09 +0800
Subject: [R-sig-Geo] Changing colour gradient in Spatstat surface plot
In-Reply-To: <31010290-858C-4392-9959-6D6B94389CD4@myotis.co.uk>
Message-ID: <C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>

# Rogers suggestion was 

library(RColorBrewer)
bl5 <- brewer.pal(5, "Blues")
mypal <- colorRampPalette(bl5)

# but he was saying any method of getting a list of colours is OK
rev(mypal(256))
rainbow(256)
colorRampPalette(c("lightblue","navy"))(256)

# then your example
       library(spatstat)
       data(longleaf)
       Z <- smooth.ppp(longleaf)
       par(mfrow = c(2,2))
       plot(Z)
       plot(Z, col=rev(mypal(256))) 
       plot(Z, col = colorRampPalette(c("lightblue","navy"))(256))  
       plot(Z, col = rainbow(256)) 

When Roger noted they were hard-coded he meant that the function
topo.colors and others are standard. Adrian was just pointing out that
his function is not hard coded to those functions and that you can use
any other function.

Tom

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Graham Smith
Sent: Wednesday, 30 April 2008 3:00 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Changing colour gradient in Spatstat surface
plot

Adrian

Thanks for the reply

> Here is an example of the whole process, starting from a marked point 
> pattern and finishing with a colour image:
>
>       library(spatstat)
>       data(longleaf)
>       Z <- smooth.ppp(longleaf)
>       plot(Z)
>       plot(Z, col=topo.colors(256))

This is what I did, but I couldn't find, and still can't find,   
anything in the help for plot.im or topo,colors that explains how to
change the colours to graduated blue, am  being really dim here.

However, in another post it was suggested I use rColorbrewer to set up
the colours , but it worries me that I cannot find the bit in the help
you have sent me to.

Graham
	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From regmi_pujan at hotmail.com  Thu May  1 17:04:50 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Thu, 1 May 2008 15:04:50 +0000
Subject: [R-sig-Geo]  Adding Scale bar in the Image
In-Reply-To: <C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>
References: <31010290-858C-4392-9959-6D6B94389CD4@myotis.co.uk>
	<C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>
Message-ID: <BAY113-W292C84DA8AB43A48EF245784DB0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080501/2efa0a04/attachment.pl>

From Roger.Bivand at nhh.no  Thu May  1 18:45:51 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 1 May 2008 18:45:51 +0200 (CEST)
Subject: [R-sig-Geo] Adding Scale bar in the Image
In-Reply-To: <BAY113-W292C84DA8AB43A48EF245784DB0@phx.gbl>
References: <31010290-858C-4392-9959-6D6B94389CD4@myotis.co.uk>
	<C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>
	<BAY113-W292C84DA8AB43A48EF245784DB0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805011835260.9166@reclus.nhh.no>

On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:

> Dear List,
> I would be thankful if anybody give me an way-out that How should can i 
> add scale bar in the RGB color image. Actually i want to use this image 
> for other purpose where i should mention the scale of the image.

I think that a few more details might help. This example uses methods from 
the sp package. Setup:

library(sp)
data(meuse.grid)
coordinates(meuse.grid) <- c("x", "y")
gridded(meuse.grid) <- TRUE

With lattice graphics:

l1 <- list("SpatialPolygonsRescale", layout.scale.bar(),
  offset = c(180500,329800), scale = 500, fill=c("transparent","black"))
l2 = list("sp.text", c(180500,329900), "0")
l3 = list("sp.text", c(181000,329900), "500 m")
spplot(meuse.grid, "dist", col.regions=grey.colors(20),
  sp.layout=list(l1, l2, l3))

With base graphics:

image(meuse.grid, "dist", col=grey.colors(20))
SpatialPolygonsRescale(layout.scale.bar(), offset = c(180500, 329800),
  scale = 500, fill=c("transparent","black"), plot.grid=FALSE)
text(180500, 329900, "0")
text(181000, 329900, "500 m")

layout.scale.bar() can take an argument setting the height of the scale 
bar, relative to the initial length of unity.

If this doesn't help, could you give an example of your problem using this 
or another accessible data set?

Roger

> Thanking you in advance
> Pujan
> _________________________________________________________________
> Make i'm yours.? Create a custom banner to support your cause.
>
> MSN_Make_IM_Yours
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Thu May  1 20:40:43 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 1 May 2008 20:40:43 +0200 (CEST)
Subject: [R-sig-Geo] Adding Scale bar in the Image
In-Reply-To: <BAY113-W42B382C871AFB86D9EED284DB0@phx.gbl>
References: <31010290-858C-4392-9959-6D6B94389CD4@myotis.co.uk>
	<C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au> 
	<BAY113-W292C84DA8AB43A48EF245784DB0@phx.gbl>
	<Pine.LNX.4.64.0805011835260.9166@reclus.nhh.no>
	<BAY113-W42B382C871AFB86D9EED284DB0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805012002480.9166@reclus.nhh.no>

On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:

If you ask a question on the list, unless there are very good reasons, 
reply through the list. Otherwise you deprive others on the list of 
information, and break the thread. I have brought this back onto the list, 
but the thread is probably broken.

In fact, this thread was broken by you intially, because you simply took 
an existing list message and replied to it, changing the Subject:, but 
still writing to the original contributors. The R lists have instructions 
and a posting guide, please do read them and keep to them.

List archives are searchable and are a potentially valuable resource, 
which loses value if users do not start fresh threads when the subject is 
new, and take follow-ups off-list, depriving others of potentially useful 
information.


> Thanks for prompt reply. Anyway to be a absolutely certain here I am 
> giving overview of my data type. My data has a four column of which 1 
> and 2 are coordinates in meters. Where as 3rd to 6th are reflectances in 
> 4 bands. Here I am using 3rd to 5th bands to plot the (RGB) image of my 
> study area. So here I want to add scale bar and if possible bar plot 
> also with color range as displayed in the image. I would be thankful if 
> you suggest me wayout.
> Thanking you
> Pujan
>
> My programme code:

No, you said:

library(rimage)

first, but that wasn't obvious, was it?

> A<- matrix (scan("test.txt",n=29613*6,sep="",skip=8),29605,6,byrow=TRUE)

What about:

A <- read.table("test.txt", skip=8, header=FALSE)
names(A) <- c("x", "y", "greenchannel", "redchannel",
   "nearinfraredchannel", "midinfraredchannel")
library(sp)
coordinates(A) <- c("x", "y")
gridded(A) <- TRUE

> greenchannel<-matrix(A[,3],nrow=155,ncol=191,byrow=TRUE)
> redchannel<-matrix(A[,4],nrow=155,ncol=191,byrow=TRUE)
> nearinfraredchannel<-matrix(A[,5],nrow=155,ncol=191,byrow=TRUE)
> midinfraredchannel<-matrix(A[,6],nrow=155,ncol=191,byrow=TRUE)
> mat <- array(0,c(155,191,3))
> mat[,,1] <- nearinfraredchannel/1000
> mat[,,2] <-redchannel/1000
> mat[,,3] <-greenchannel/1000

then

A$red <- A$nearinfraredchannel/1000
A$green <- A$redchannel/1000
A$blue <- A$greenchannel/1000

image(A, red="red", green="green", blue="blue")
axis(1, col.axis="blue", font.axis=4)
axis(2, col.axis="blue", font.axis=4)

using the image() method for SpatialPixelsDataFrame objects, then the base 
graphics approach as before - use locator() to find the offset. This is 
untried, because you did not either show a publically available data set, 
or provide a (subsetted) copy of your own.

For your bar plot, see layout() or ?par - see the mfrow= argument to add 
another plot to the graphics device.

Roger

> plot(imagematrix(mat))# To plot image in Color.
> axis(1,col.axis=?blue?,font.axis=4)
> axis(2,col.axis=?blue?,font.axis=4)
> title(main = list(" COLOR IMAGE", font = 4,col=?Blue?), xlab=list(?E-W Direction (Unit in Meters)?,font=3,col=?blue?),ylab= list(?N-S Direction (Unit in Meters)?, font=3,col=?blue?))
>
> _________________________________________________________________
> Spell a grand slam in this game where word skill meets World Series. Get in the game.
> http://club.live.com/word_slugger.aspx?icid=word_slugger_wlhm_admod_april08

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From regmi_pujan at hotmail.com  Thu May  1 21:36:01 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Thu, 1 May 2008 19:36:01 +0000
Subject: [R-sig-Geo] Scale Bar
Message-ID: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080501/61daae44/attachment.pl>

From graham.smith at myotis.co.uk  Thu May  1 21:50:20 2008
From: graham.smith at myotis.co.uk (Graham Smith)
Date: Thu, 1 May 2008 20:50:20 +0100
Subject: [R-sig-Geo] Changing colour gradient in Spatstat surface plot
In-Reply-To: <C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>
References: <C36843D783908044A2EA05A4E15F84CC0A726E@MAILSVR01.dpi.wa.gov.au>
Message-ID: <DFBA00EC-B32B-4BB1-AB56-781F29B72C35@myotis.co.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080501/176a0470/attachment.pl>

From Bjarke.Christensen at sydbank.dk  Fri May  2 00:24:37 2008
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Fri, 2 May 2008 00:24:37 +0200
Subject: [R-sig-Geo] Is there a lagsarglm?
In-Reply-To: <mailman.13.1206702003.15065.r-sig-geo@stat.math.ethz.ch>
Message-ID: <OFA6DA327E.5B1EFD85-ONC125743C.0078B98B-C125743C.007B1AF1@bdpnet.dk>

Hi,

I can't seem to find any implementation of spatial probit models in R.
Perhaps my limited understanding of spatial statistics is preventing me
from seeing what should be obvious, but it does not seem that the methods
in geoRglm are of help in that sense. Can anyone help?

Venlig hilsen
Sydbank

Bjarke Christensen
?konom

Forretningsprocesser - Modeller
Peberlyk
DK-6200 Aabenraa
Direkte tlf. 74 36 44 72
Telefax
bjarke.christensen at sydbank.dk


From Roger.Bivand at nhh.no  Fri May  2 10:55:32 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 May 2008 10:55:32 +0200 (CEST)
Subject: [R-sig-Geo] Is there a lagsarglm?
In-Reply-To: <OFA6DA327E.5B1EFD85-ONC125743C.0078B98B-C125743C.007B1AF1@bdpnet.dk>
References: <OFA6DA327E.5B1EFD85-ONC125743C.0078B98B-C125743C.007B1AF1@bdpnet.dk>
Message-ID: <Pine.LNX.4.64.0805021035280.11950@reclus.nhh.no>

On Fri, 2 May 2008, Bjarke Christensen wrote:

> Hi,
>
> I can't seem to find any implementation of spatial probit models in R.
> Perhaps my limited understanding of spatial statistics is preventing me
> from seeing what should be obvious, but it does not seem that the methods
> in geoRglm are of help in that sense. Can anyone help?

Well, contributions are always welcome! This is near the area of GLMMs 
which is seriously hard for most cases. Even if models can be fit, there 
is no agreement on how to put distributions around the fitted 
coefficients, or on how to assess their significance (MCMC being a 
computational route that at least gives something, if the assumptions in 
the prior hold).

You are thinking of a model with the spatially lagged limited dependent 
variable on the RHS, right? Are you sure of your specification?

Could you try tuning a regular glm() fit (or gam() with a spline term in 
the observation coordinates) - is the dependent variable "well behaved" - 
is its distributional shape as expected (zero-inflation, dispersion, etc)? 
Do you need case weights? Is it a rate - could it be modelled directly 
with a log offset (like epidemiologists do)? If you can establish where 
the spatial dependence is coming from, you may find that you can get to a 
residual with no marked patterning (but testing isn't obvious either).

I imagine that you have looked at the Matlab toolbox, but that is pursuing 
a specific route, one liked by econometricians, but one that say 
Schabenberger & Gotway probably would leave until after checking out the 
alternatives. There is so little use of spatial "probit" - in glm() for 
the binomial family, the default link is "logit" not "probit" - so we 
really don't know how credible results from implementations are.

Sorry not to be more help, but getting to a glm(..., 
binomial(link="probit")) with clean residuals will be more robust that 
one-off "spatial" code (as would be a gam() with an s(x,y) term - if it 
isn't significant, there probably isn't a spatial story left).

Roger


>
> Venlig hilsen
> Sydbank
>
> Bjarke Christensen
> ?konom
>
> Forretningsprocesser - Modeller
> Peberlyk
> DK-6200 Aabenraa
> Direkte tlf. 74 36 44 72
> Telefax
> bjarke.christensen at sydbank.dk
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Fri May  2 11:29:37 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 May 2008 11:29:37 +0200 (CEST)
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>

On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:

> Dear,

> I followed the instruction given by Roger. But i got the following error 
> message; coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> 
> greenchannel<-matrix(A[,3],nrow=155,ncol=191,byrow=TRUE)Error in 
> as.vector(x, mode) : cannot coerce to 
> vectorredchannel<-matrix(A[,4],nrow=155,ncol=191,byrow=TRUE)Error in 
> as.vector(x, mode) : cannot coerce to vector> 
> nearinfraredchannel<-matrix(A[,5],nrow=155,ncol=191,byrow=TRUE)Error in 
> `[.data.frame`(x at data, i, j, ..., drop = FALSE) :  undefined columns 
> selected> 
> midinfraredchannel<-matrix(A[,6],nrow=155,ncol=191,byrow=TRUE)Error in 
> `[.data.frame`(x at data, i, j, ..., drop = FALSE) :  undefined columns 
> selectedThe image plot was black background with x and y axis values.

You are not reading what is being sent to you carefully enough, but at 
least this is a fresh thread, so some progress. Above, you have mixed up 
my answer with your own attempt to use rimage classes and functions. If 
you have spatial data, use spatial classes and functions, which permit 
integration with other spatial data.

Using the data you sent me offline (but *.rar compressed, please use gzip 
or zip, rar is not portable), I have:


A <- read.table("test.txt", skip=8, header=FALSE)
names(A) <- c("x", "y", "greenchannel", "redchannel",
   "nearinfraredchannel", "midinfraredchannel")
coordinates(A) <- c("x", "y")
gridded(A) <- TRUE

I note that you have not given the projection of your data (UTM?), so 
registering this data with other data (stream channel patterns?) is not 
made any easier.

A$red <- as.double(A$nearinfraredchannel)
A$green <- as.double(A$redchannel)
A$blue <- as.double(A$greenchannel)
summary(A)

The values appear to be in the 0-255 range, but do not go much beyond 
halfway - do they need stretching? Muliplying the values by 1.79 -
1/(max(c(A$red, A$green, A$blue))/255) rounded down a touch - gave a more 
pleasing image, but I don't know the origins of your data.

image(A, red="red", green="green", blue="blue", axes=TRUE)

which shows the majority of your study area as 0 coded black, and the 
remainder is not very differentiated. It ought to be possible to code 
these 0 values as NA, but currently the underlying method in sp does not 
handle NAs gracefully for rgb input - this will be improved in the next 
release. So, we recode 0 as 255 to get white:

A$red <- ifelse(A$red < 1, 255, A$red)
A$green <- ifelse(A$green < 1, 255, A$green)
A$blue <- ifelse(A$blue < 1, 255, A$blue)
image(A, red="red", green="green", blue="blue", axes=TRUE)

So now to your scale bar:

SpatialPolygonsRescale(layout.scale.bar(), offset = c(566500, 5698000),
  scale = 500, fill=c("transparent","black"), plot.grid=FALSE)
text(566500, 5698075, "0", cex=0.7)
text(567000, 5698075, "500 m", cex=0.7)

You can complete the north arrow in the same way using examples on the 
help page for spplot, if you really want one.

Finally, as a geographer, I would point out that the scale bar and north 
arrow are not needed when the axes show the scale and the direction of 
north. Anyone who tells you that they have to be there (your supervisor?), 
should read up on analytical graphics - extra details distract attention 
from what the data are saying. Probably using grid() is less intrusive, 
and gives good placing control across the whole graphic. When was the last 
time anyone actually used a map scale bar to read off distances from a 
map?

Roger


> Any help?
> Thanking you
> Pujan
> _________________________________________________________________
> Back to work after baby?how do you know when you?re ready?
>
> 5797498&ocid=T067MSN40A0701A
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From regmi_pujan at hotmail.com  Fri May  2 18:00:06 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Fri, 2 May 2008 16:00:06 +0000
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
Message-ID: <BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080502/e6660c1e/attachment.pl>

From Roger.Bivand at nhh.no  Fri May  2 19:49:07 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 May 2008 19:49:07 +0200 (CEST)
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
	<BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>

On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:

>
>
> Dear list,
> Thanks to Mr. Roger, I have now able to plot my data using image and sp 
> packages. Everything now seems ok for one type of data set where X and Y 
> coordinates are regularly spaced with tolerance less than 0.000002. Now 
> I tried to plot with another data set then soon I realize that X 
> coordinates have tolerance about 0.02. This thing I realize when I get 
> the error message as follows: ?gridded(A)<- TRUE suggested tolerance 
> minimum: 0.00212314227724164Error in points2grid(points, tolerance) : 
> dimension 1 : coordinate intervals are not constant? Then I tried to use 
> points2grid to overcome this problem but it did not work.

Do you know where the irregular values came from - type of file written by 
what software? Are they just rounding at some stage - I feel that it would 
be helpful to rule out real causes before correcting something that might 
be an actual mistake, if you see what I mean.

>
> One more question my data has a projection system UTM (European1950) ZONE31.
> How can I incorporate this information while converting spatial data?

proj4string(A) <- CRS("+proj=utm +zone=31 +ellps=intl")

but because ED50 is not well defined, there is no +towgs84= value in the 
EPSG database in the rgdal package. If you need to datum-transform spatial 
data (not the grid, obviously), you'll need the +towgs84 values for your 
location.

Roger

> Thanking you
> Pujan
>
>> Date: Fri, 2 May 2008 11:29:37 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: Re: [R-sig-Geo] Scale Bar> > On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:> > > Dear,> > > I followed the instruction given by Roger. But i got the following error > > message; coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > > greenchannel<-matrix(A[,3],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to > > vectorredchannel<-matrix(A[,4],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to vector> > > nearinfraredchannel<-matrix(A[,5],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selected> > > midinfraredchannel<-matrix(A[,6],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selectedThe image plot was black background with x and y axis values.> > You are not reading what is being sent to you carefully enough, but at > least this is a fresh thread, so some progress. Above, you have mixed up > my answer with your own attempt to use rimage classes and functions. If > you have spatial data, use spatial classes and functions, which permit > integration with other spatial data.> > Using the data you sent me offline (but *.rar compressed, please use gzip > or zip, rar is not portable), I have:> > > A <- read.table("test.txt", skip=8, header=FALSE)> names(A) <- c("x", "y", "greenchannel", "redchannel",> "nearinfraredchannel", "midinfraredchannel")> coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > I note that you have not given the projection of your data (UTM?), so > registering this data with other data (stream channel patterns?) is not > made any easier.> > A$red <- as.double(A$nearinfraredchannel)> A$green <- as.double(A$redchannel)> A$blue <- as.double(A$greenchannel)> summary(A)> > The values appear to be in the 0-255 range, but do not go much beyond > halfway - do they need stretching? Muliplying the values by 1.79 -> 1/(max(c(A$red, A$green, A$blue))/255) rounded down a touch - gave a more > pleasing image, but I don't know the origins of your data.> > image(A, red="red", green="green", blue="blue", axes=TRUE)> > which shows the majority of your study area as 0 coded black, and the > remainder is not very differentiated. It ought to be possible to code > these 0 values as NA, but currently the underlying method in sp does not > handle NAs gracefully for rgb input - this will be improved in the next > release. So, we recode 0 as 255 to get white:> > A$red <- ifelse(A$red < 1, 255, A$red)> A$green <- ifelse(A$green < 1, 255, A$green)> A$blue <- ifelse(A$blue < 1, 255, A$blue)> image(A, red="red", green="green", blue="blue", axes=TRUE)> > So now to your scale bar:> > SpatialPolygonsRescale(layout.scale.bar(), offset = c(566500, 5698000),> scale = 500, fill=c("transparent","black"), plot.grid=FALSE)> text(566500, 5698075, "0", cex=0.7)> text(567000, 5698075, "500 m", cex=0.7)> > You can complete the north arrow in the same way using examples on the > help page for spplot, if you really want one.> > Finally, as a geographer, I would point out that the scale bar and north > arrow are not needed when the axes show the scale and the direction of > north. Anyone who tells you that they have to be there (your supervisor?), > should read up on analytical graphics - extra details distract attention > from what the data are saying. Probably using grid() is less intrusive, > and gives good placing control across the whole graphic. When was the last > time anyone actually used a map scale bar to read off distances from a > map?> > Roger> > > > Any help?> > Thanking you> > Pujan> > _________________________________________________________________> > Back to work after baby?how do you know when you?re ready?> >> > 5797498&ocid=T067MSN40A0701A> > [[alternative HTML version deleted]]> >> >> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no
> _________________________________________________________________
> Get Free (PRODUCT) RED?  Emoticons, Winks and Display Pics
> http://joinred.spaces.live.com?ocid=TXT_HMTG_prodredemoticons_052008

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From regmi_pujan at hotmail.com  Fri May  2 20:25:38 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Fri, 2 May 2008 18:25:38 +0000
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
	<BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl> 
	<Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>
Message-ID: <BAY113-W538E14570FE8C9BC126E4F84DA0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080502/c5df825d/attachment.pl>

From Roger.Bivand at nhh.no  Fri May  2 20:34:06 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 May 2008 20:34:06 +0200 (CEST)
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <BAY113-W538E14570FE8C9BC126E4F84DA0@phx.gbl>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
	<BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>
	<Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>
	<BAY113-W538E14570FE8C9BC126E4F84DA0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805022029010.11950@reclus.nhh.no>

On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:

>
>
> Dear sir,
> My data has been acquired from ENVI 4.0 and it has the following information regarding pixel size and projection system:
> samples = 596lines   = 440bands   = 21
> pixel size: 4.710294*4.70871
> file type = ENVI Standard
> header offset = 0
> map info = {UTM, 1.000, 1.000, 564761.521, 5699816.363, 4.7102936126e+000, 4.7087100663e+000, 31, North, WGS-84, units=Meters}
>
> vitotagprojectionsystem = Universal_Transverse_Mercatorvitotagprojectiondatum = WGS_84vitotagprojectionzone = 31
> I was mistaken earlier that projection datum was Eueropean1950 instead it is WGS84
> so I think the projection code should be:
> proj4string(A) <- CRS("+proj=utm +zone=31 +ellps=WGS84")

Or perhaps

proj4string(A) <- CRS("+proj=utm +zone=31 +datum=WGS84")

to fix the datum and ellipse at one go.

> Regarding the tolerance problem; The difference in the X coordinates 
> (column 1 out of 21 column)varies from 4.7019876 to 4.719234 so the 
> default tolerance 0.00212314227724164 does not incorporate those 
> variation. This is my source of error. Thanking you in advance Pujan

The given value is an internal value, but indicates what may be set to 
correct the problem. Do you know why the differences in the x coordinates 
vary? These look too big to be rounding error. I believe that the current 
points2grid will not solve the problem, but am working on a solution.

Another question is whether you could transfer data from ENVI to R using a 
different file format, for example as a GTiff, and the read it using 
readGDAL() in rgdal?

Roger

>
>> Date: Fri, 2 May 2008 19:49:07 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: RE: [R-sig-Geo] Scale Bar> > On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:> > >> >> > Dear list,> > Thanks to Mr. Roger, I have now able to plot my data using image and sp > > packages. Everything now seems ok for one type of data set where X and Y > > coordinates are regularly spaced with tolerance less than 0.000002. Now > > I tried to plot with another data set then soon I realize that X > > coordinates have tolerance about 0.02. This thing I realize when I get > > the error message as follows: ?gridded(A)<- TRUE suggested tolerance > > minimum: 0.00212314227724164Error in points2grid(points, tolerance) : > > dimension 1 : coordinate intervals are not constant? Then I tried to use > > points2grid to overcome this problem but it did not work.> > Do you know where the irregular values came from - type of file written by > what software? Are they just rounding at some stage - I feel that it would > be helpful to rule out real causes before correcting something that might > be an actual mistake, if you see what I mean.> > >> > One more question my data has a projection system UTM (European1950) ZONE31.> > How can I incorporate this information while converting spatial data?> > proj4string(A) <- CRS("+proj=utm +zone=31 +ellps=intl")> > but because ED50 is not well defined, there is no +towgs84= value in the > EPSG database in the rgdal package. If you need to datum-transform spatial > data (not the grid, obviously), you'll need the +towgs84 values for your > location.> > Roger> > > Thanking you> > Pujan> >> >> Date: Fri, 2 May 2008 11:29:37 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: Re: [R-sig-Geo] Scale Bar> > On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:> > > Dear,> > > I followed the instruction given by Roger. But i got the following error > > message; coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > > greenchannel<-matrix(A[,3],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to > > vectorredchannel<-matrix(A[,4],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to vector> > > nearinfraredchannel<-matrix(A[,5],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selected> > > midinfraredchannel<-matrix(A[,6],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selectedThe image plot was black background with x and y axis values.> > You are not reading what is being sent to you carefully enough, but at > least this is a fresh thread, so some progress. Above, you have mixed up > my answer with your own attempt to use rimage classes and functions. If > you have spatial data, use spatial classes and functions, which permit > integration with other spatial data.> > Using the data you sent me offline (but *.rar compressed, please use gzip > or zip, rar is not portable), I have:> > > A <- read.table("test.txt", skip=8, header=FALSE)> names(A) <- c("x", "y", "greenchannel", "redchannel",> "nearinfraredchannel", "midinfraredchannel")> coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > I note that you have not given the projection of your data (UTM?), so > registering this data with other data (stream channel patterns?) is not > made any easier.> > A$red <- as.double(A$nearinfraredchannel)> A$green <- as.double(A$redchannel)> A$blue <- as.double(A$greenchannel)> summary(A)> > The values appear to be in the 0-255 range, but do not go much beyond > halfway - do they need stretching? Muliplying the values by 1.79 -> 1/(max(c(A$red, A$green, A$blue))/255) rounded down a touch - gave a more > pleasing image, but I don't know the origins of your data.> > image(A, red="red", green="green", blue="blue", axes=TRUE)> > which shows the majority of your study area as 0 coded black, and the > remainder is not very differentiated. It ought to be possible to code > these 0 values as NA, but currently the underlying method in sp does not > handle NAs gracefully for rgb input - this will be improved in the next > release. So, we recode 0 as 255 to get white:> > A$red <- ifelse(A$red < 1, 255, A$red)> A$green <- ifelse(A$green < 1, 255, A$green)> A$blue <- ifelse(A$blue < 1, 255, A$blue)> image(A, red="red", green="green", blue="blue", axes=TRUE)> > So now to your scale bar:> > SpatialPolygonsRescale(layout.scale.bar(), offset = c(566500, 5698000),> scale = 500, fill=c("transparent","black"), plot.grid=FALSE)> text(566500, 5698075, "0", cex=0.7)> text(567000, 5698075, "500 m", cex=0.7)> > You can complete the north arrow in the same way using examples on the > help page for spplot, if you really want one.> > Finally, as a geographer, I would point out that the scale bar and north > arrow are not needed when the axes show the scale and the direction of > north. Anyone who tells you that they have to be there (your supervisor?), > should read up on analytical graphics - extra details distract attention > from what the data are saying. Probably using grid() is less intrusive, > and gives good placing control across the whole graphic. When was the last > time anyone actually used a map scale bar to read off distances from a > map?> > Roger> > > > Any help?> > Thanking you> > Pujan> > _________________________________________________________________> > Back to work after baby?how do you know when you?re ready?> >> > 5797498&ocid=T067MSN40A0701A> > [[alternative HTML version deleted]]> >> >> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no> > _________________________________________________________________> > Get Free (PRODUCT) RED? Emoticons, Winks and Display Pics> > http://joinred.spaces.live.com?ocid=TXT_HMTG_prodredemoticons_052008> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no
> _________________________________________________________________
> Stay in touch when you're away with Windows Live Messenger.
> http://www.windowslive.com/messenger/overview.html?ocid=TXT_TAGLM_WL_Refresh_messenger_052008

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From regmi_pujan at hotmail.com  Fri May  2 21:18:03 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Fri, 2 May 2008 19:18:03 +0000
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <Pine.LNX.4.64.0805022029010.11950@reclus.nhh.no>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
	<BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>
	<Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>
	<BAY113-W538E14570FE8C9BC126E4F84DA0@phx.gbl> 
	<Pine.LNX.4.64.0805022029010.11950@reclus.nhh.no>
Message-ID: <BAY113-W56C33D0923F9B250A0019384DA0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080502/7e304cc1/attachment.pl>

From Roger.Bivand at nhh.no  Sat May  3 12:09:54 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 May 2008 12:09:54 +0200 (CEST)
Subject: [R-sig-Geo] Scale Bar
In-Reply-To: <BAY113-W56C33D0923F9B250A0019384DA0@phx.gbl>
References: <BAY113-W174A0630054AC181AA23784DB0@phx.gbl>
	<Pine.LNX.4.64.0805021055480.11950@reclus.nhh.no>
	<BAY113-W3794C304F592C38D15BBDC84DA0@phx.gbl>
	<Pine.LNX.4.64.0805021827080.11950@reclus.nhh.no>
	<BAY113-W538E14570FE8C9BC126E4F84DA0@phx.gbl>
	<Pine.LNX.4.64.0805022029010.11950@reclus.nhh.no>
	<BAY113-W56C33D0923F9B250A0019384DA0@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805031203210.18988@reclus.nhh.no>

On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:

>
>
> Dear sir,

> Actually I realize that 0.02 tolerance is the best that incorporate the 
> variation in X coordinates differences. Then I used the points2grid with 
> tolerance=0.02 it worked till this step but as soon as I use the code:
> gridded(A)<-TRUE

Well, gridded()<- will not work because you cannot pass the tolerance 
through. I'm working on resolving the problem of how to generate a 
"quasi"-valid grid from fuzzy cell centre coordinates.

> then same error message appeared. so that means the problem should 
> solved for gridded too but i don't know how to do it. its strange to 
> found that why there is inconsistency in the X value differences! for 
> the other data that have been extracted Using ENVI to text format are 
> consistent and dont give any problem. This data set being spatially bit 
> finner (4.7mx 4.7m) may be the reason for the cuasue of inconsistency 
> while exporting from ENVI.

I would advise trying to establish exactly why ENVI is writing these 
values, I cannot think of a good reason why, as the only typical numerical 
fuzz we usually see comes from the final digits when coordinates have been 
written out to text file and read in again, that is a very small 
difference. Could you try to check why ENVI is doing this?

Roger

> Thanking you Pujan
>
>
>> Date: Fri, 2 May 2008 20:34:06 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: RE: [R-sig-Geo] Scale Bar> > On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:> > >> >> > Dear sir,> > My data has been acquired from ENVI 4.0 and it has the following information regarding pixel size and projection system:> > samples = 596lines = 440bands = 21> > pixel size: 4.710294*4.70871> > file type = ENVI Standard> > header offset = 0> > map info = {UTM, 1.000, 1.000, 564761.521, 5699816.363, 4.7102936126e+000, 4.7087100663e+000, 31, North, WGS-84, units=Meters}> >> > vitotagprojectionsystem = Universal_Transverse_Mercatorvitotagprojectiondatum = WGS_84vitotagprojectionzone = 31> > I was mistaken earlier that projection datum was Eueropean1950 instead it is WGS84> > so I think the projection code should be:> > proj4string(A) <- CRS("+proj=utm +zone=31 +ellps=WGS84")> > Or perhaps> > proj4string(A) <- CRS("+proj=utm +zone=31 +datum=WGS84")> > to fix the datum and ellipse at one go.> > > Regarding the tolerance problem; The difference in the X coordinates > > (column 1 out of 21 column)varies from 4.7019876 to 4.719234 so the > > default tolerance 0.00212314227724164 does not incorporate those > > variation. This is my source of error. Thanking you in advance Pujan> > The given value is an internal value, but indicates what may be set to > correct the problem. Do you know why the differences in the x coordinates > vary? These look too big to be rounding error. I believe that the current > points2grid will not solve the problem, but am working on a solution.> > Another question is whether you could transfer data from ENVI to R using a > different file format, for example as a GTiff, and the read it using > readGDAL() in rgdal?> > Roger> > >> >> Date: Fri, 2 May 2008 19:49:07 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: RE: [R-sig-Geo] Scale Bar> > On Fri, 2 May 2008, PUJAN RAJ REGMI wrote:> > >> >> > Dear list,> > Thanks to Mr. Roger, I have now able to plot my data using image and sp > > packages. Everything now seems ok for one type of data set where X and Y > > coordinates are regularly spaced with tolerance less than 0.000002. Now > > I tried to plot with another data set then soon I realize that X > > coordinates have tolerance about 0.02. This thing I realize when I get > > the error message as follows: ?gridded(A)<- TRUE suggested tolerance > > minimum: 0.00212314227724164Error in points2grid(points, tolerance) : > > dimension 1 : coordinate intervals are not constant? Then I tried to use > > points2grid to overcome this problem but it did not work.> > Do you know where the irregular values came from - type of file written by > what software? Are they just rounding at some stage - I feel that it would > be helpful to rule out real causes before correcting something that might > be an actual mistake, if you see what I mean.> > >> > One more question my data has a projection system UTM (European1950) ZONE31.> > How can I incorporate this information while converting spatial data?> > proj4string(A) <- CRS("+proj=utm +zone=31 +ellps=intl")> > but because ED50 is not well defined, there is no +towgs84= value in the > EPSG database in the rgdal package. If you need to datum-transform spatial > data (not the grid, obviously), you'll need the +towgs84 values for your > location.> > Roger> > > Thanking you> > Pujan> >> >> Date: Fri, 2 May 2008 11:29:37 +0200> From: Roger.Bivand at nhh.no> To: regmi_pujan at hotmail.com> CC: r-sig-geo at stat.math.ethz.ch> Subject: Re: [R-sig-Geo] Scale Bar> > On Thu, 1 May 2008, PUJAN RAJ REGMI wrote:> > > Dear,> > > I followed the instruction given by Roger. But i got the following error > > message; coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > > greenchannel<-matrix(A[,3],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to > > vectorredchannel<-matrix(A[,4],nrow=155,ncol=191,byrow=TRUE)Error in > > as.vector(x, mode) : cannot coerce to vector> > > nearinfraredchannel<-matrix(A[,5],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selected> > > midinfraredchannel<-matrix(A[,6],nrow=155,ncol=191,byrow=TRUE)Error in > > `[.data.frame`(x at data, i, j, ..., drop = FALSE) : undefined columns > > selectedThe image plot was black background with x and y axis values.> > You are not reading what is being sent to you carefully enough, but at > least this is a fresh thread, so some progress. Above, you have mixed up > my answer with your own attempt to use rimage classes and functions. If > you have spatial data, use spatial classes and functions, which permit > integration with other spatial data.> > Using the data you sent me offline (but *.rar compressed, please use gzip > or zip, rar is not portable), I have:> > > A <- read.table("test.txt", skip=8, header=FALSE)> names(A) <- c("x", "y", "greenchannel", "redchannel",> "nearinfraredchannel", "midinfraredchannel")> coordinates(A) <- c("x", "y")> gridded(A) <- TRUE> > I note that you have not given the projection of your data (UTM?), so > registering this data with other data (stream channel patterns?) is not > made any easier.> > A$red <- as.double(A$nearinfraredchannel)> A$green <- as.double(A$redchannel)> A$blue <- as.double(A$greenchannel)> summary(A)> > The values appear to be in the 0-255 range, but do not go much beyond > halfway - do they need stretching? Muliplying the values by 1.79 -> 1/(max(c(A$red, A$green, A$blue))/255) rounded down a touch - gave a more > pleasing image, but I don't know the origins of your data.> > image(A, red="red", green="green", blue="blue", axes=TRUE)> > which shows the majority of your study area as 0 coded black, and the > remainder is not very differentiated. It ought to be possible to code > these 0 values as NA, but currently the underlying method in sp does not > handle NAs gracefully for rgb input - this will be improved in the next > release. So, we recode 0 as 255 to get white:> > A$red <- ifelse(A$red < 1, 255, A$red)> A$green <- ifelse(A$green < 1, 255, A$green)> A$blue <- ifelse(A$blue < 1, 255, A$blue)> image(A, red="red", green="green", blue="blue", axes=TRUE)> > So now to your scale bar:> > SpatialPolygonsRescale(layout.scale.bar(), offset = c(566500, 5698000),> scale = 500, fill=c("transparent","black"), plot.grid=FALSE)> text(566500, 5698075, "0", cex=0.7)> text(567000, 5698075, "500 m", cex=0.7)> > You can complete the north arrow in the same way using examples on the > help page for spplot, if you really want one.> > Finally, as a geographer, I would point out that the scale bar and north > arrow are not needed when the axes show the scale and the direction of > north. Anyone who tells you that they have to be there (your supervisor?), > should read up on analytical graphics - extra details distract attention > from what the data are saying. Probably using grid() is less intrusive, > and gives good placing control across the whole graphic. When was the last > time anyone actually used a map scale bar to read off distances from a > map?> > Roger> > > > Any help?> > Thanking you> > Pujan> > _________________________________________________________________> > Back to work after baby?how do you know when you?re ready?> >> > 5797498&ocid=T067MSN40A0701A> > [[alternative HTML version deleted]]> >> >> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no> > _________________________________________________________________> > Get Free (PRODUCT) RED? Emoticons, Winks and Display Pics> > http://joinred.spaces.live.com?ocid=TXT_HMTG_prodredemoticons_052008> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no> > _________________________________________________________________> > Stay in touch when you're away with Windows Live Messenger.> > http://www.windowslive.com/messenger/overview.html?ocid=TXT_TAGLM_WL_Refresh_messenger_052008> > -- > Roger Bivand> Economic Geography Section, Department of Economics, Norwegian School of> Economics and Business Administration, Helleveien 30, N-5045 Bergen,> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43> e-mail: Roger.Bivand at nhh.no
> _________________________________________________________________
> Stay in touch when you're away with Windows Live Messenger.
> http://www.windowslive.com/messenger/overview.html?ocid=TXT_TAGLM_WL_Refresh_messenger_052008

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From giohappy at gmail.com  Mon May  5 01:17:52 2008
From: giohappy at gmail.com (G. Allegri)
Date: Mon, 5 May 2008 01:17:52 +0200
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
Message-ID: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080505/d191fc37/attachment.pl>

From Roger.Bivand at nhh.no  Mon May  5 11:00:31 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 May 2008 11:00:31 +0200 (CEST)
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
In-Reply-To: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com>
References: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>

On Mon, 5 May 2008, G. Allegri wrote:

> A question to Dr. Roger Bivand:
> I'm about to order you book "Applied Spatial Data Analysis with R", but I
> would like to have a look to the table of contents. It's not available on
> the Springer page, could it be shared on the ml?

The short table of contents is on the Springer site, but (I believe) 
because production is taking place now, there is no PDF with chapter 
sections and pagination, yet.

> Does the book cover some teoretical foundaments about the arguments treated,
> or it's just a hands-on manual?

This is explained under "About this book" - which says that the second 
part of the is intended to show how selected methods can be used in R, but 
is not a complete theoretical treatment. We provide systematic references 
to Cressie and Schabenberger & Gotway for Spatial Stats courses, and to 
Fortin & Dale for ecologists, and Waller & Gotway for public health 
people, plus a few more. It isn't a theory book, but we feel that it is 
more than a manual. Note that it does not recommend methods, but suggests 
that the reader should have the tools to explore and choose appropriate 
methods based on their better knowledge of the real research problem.

We are not sure whether we should mention this (self-advertising is not 
pleasant), but because it applies to all the books about using R now being 
published, and listed on:

http://www.r-project.org/doc/bib/R-books.html

we would draw attention to the discount info links by most titles, showing 
how to get (usually) 20% discounts. Other retailers may offer better 
discounts.

Roger

> Thank you very much,
> Giovanni
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From giohappy at gmail.com  Mon May  5 11:20:48 2008
From: giohappy at gmail.com (G. Allegri)
Date: Mon, 5 May 2008 11:20:48 +0200
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
In-Reply-To: <Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>
References: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com>
	<Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>
Message-ID: <e12429640805050220k65bb580bje48185dec2349c46@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080505/554c5959/attachment.pl>

From Roger.Bivand at nhh.no  Mon May  5 14:58:37 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 May 2008 14:58:37 +0200 (CEST)
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
In-Reply-To: <e12429640805050220k65bb580bje48185dec2349c46@mail.gmail.com>
References: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com> 
	<Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>
	<e12429640805050220k65bb580bje48185dec2349c46@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805051457160.15163@reclus.nhh.no>

On Mon, 5 May 2008, G. Allegri wrote:

> Thank you Roger. I thought to buy it to realize a course on spatial data
> analysis and to suggest it to the alumns. I think it could be a good trade
> off between hard mathematical theory and an R manual...
> I've tried to insert the token indicated in the Discount Info, but Springer
> returns that it's expired.

Thanks, I've passed on this failure (which I can reproduce) to those who 
ought to be able to fix it.

Roger

>
> Giovanni
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mao.loecher at gmail.com  Mon May  5 17:26:22 2008
From: mao.loecher at gmail.com (Markus Loecher)
Date: Mon, 5 May 2008 11:26:22 -0400
Subject: [R-sig-Geo] line inside rectangle
Message-ID: <3827b1320805050826s64b44e0fu94f27cd09f1b6b85@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080505/8b6288bd/attachment.pl>

From ddepew at sciborg.uwaterloo.ca  Mon May  5 20:27:46 2008
From: ddepew at sciborg.uwaterloo.ca (Dave Depew)
Date: Mon, 05 May 2008 14:27:46 -0400
Subject: [R-sig-Geo] kriging output
Message-ID: <481F51A2.9050102@scimail.uwaterloo.ca>

Hi all,
I've got a question regarding kriging outputs. I have an interpolated 
dataset which due to the nugget effect contains some negative values as 
the predictions. I would like to truncate these @ "0", rather than 
having them as a negative prediction.
I've tried something similar with the meuse data set...

data(meuse.grid) 
coordinates(meuse.grid) = c("x", "y") 
gridded(meuse.grid) <- TRUE
meuse.grid[["idist"]] = 1 - meuse.grid[["dist"]] 

Somewhat arbitrary, but essentially, I'd like to set all "dist" data less than 0.5 to "0", and have the rest remain as they are...


meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
if (meuse.grid[["dist"]]<0.5) {meuse.grid[["class"]]==0} else
{meuse.grid[["class"]]=meuse.grid[["dist"]]}
}

All I've managed to get is the new attribute "class" all filled with 0.

Any insight would be appreciated.



From edzer.pebesma at uni-muenster.de  Mon May  5 21:09:23 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 May 2008 21:09:23 +0200
Subject: [R-sig-Geo] kriging output
In-Reply-To: <481F51A2.9050102@scimail.uwaterloo.ca>
References: <481F51A2.9050102@scimail.uwaterloo.ca>
Message-ID: <481F5B63.6060102@uni-muenster.de>

Dave Depew wrote:
> Hi all,
> I've got a question regarding kriging outputs. I have an interpolated 
> dataset which due to the nugget effect contains some negative values 
> as the predictions. I would like to truncate these @ "0", rather than 
> having them as a negative prediction.
> I've tried something similar with the meuse data set...
>
> data(meuse.grid) coordinates(meuse.grid) = c("x", "y") 
> gridded(meuse.grid) <- TRUE
> meuse.grid[["idist"]] = 1 - meuse.grid[["dist"]]
> Somewhat arbitrary, but essentially, I'd like to set all "dist" data 
> less than 0.5 to "0", and have the rest remain as they are...
>
>
> meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
> if (meuse.grid[["dist"]]<0.5) {meuse.grid[["class"]]==0} else
I guess you meant an = rather than a == here
> {meuse.grid[["class"]]=meuse.grid[["dist"]]}
> }
>
> All I've managed to get is the new attribute "class" all filled with 0.
>
Try:

meuse.grid$class = meuse.grid$dist
meuse.grid$class[meuse.grid$dist < .5] = 0
plot(class~dist,meuse.grid)
--
Edzer



From ddepew at sciborg.uwaterloo.ca  Mon May  5 21:48:58 2008
From: ddepew at sciborg.uwaterloo.ca (Dave Depew)
Date: Mon, 05 May 2008 15:48:58 -0400
Subject: [R-sig-Geo] kriging output
In-Reply-To: <481F5B63.6060102@uni-muenster.de>
References: <481F51A2.9050102@scimail.uwaterloo.ca>
	<481F5B63.6060102@uni-muenster.de>
Message-ID: <481F64AA.4040507@scimail.uwaterloo.ca>

Thanks,
This worked.

I'm still confused why the if else statement didn't work...
If one wanted to do conditional arithmetic would a for statement bee needed?


e.g.
 meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
if (meuse.grid[["dist"]]<0.5) 
{meuse.grid[["class"]]=10*meuse.grid[["dist]]} else
{meuse.grid[["class"]]=100* meuse.grid[["dist"]]}
 }




Edzer Pebesma wrote:
> Dave Depew wrote:
>> Hi all,
>> I've got a question regarding kriging outputs. I have an interpolated 
>> dataset which due to the nugget effect contains some negative values 
>> as the predictions. I would like to truncate these @ "0", rather than 
>> having them as a negative prediction.
>> I've tried something similar with the meuse data set...
>>
>> data(meuse.grid) coordinates(meuse.grid) = c("x", "y") 
>> gridded(meuse.grid) <- TRUE
>> meuse.grid[["idist"]] = 1 - meuse.grid[["dist"]]
>> Somewhat arbitrary, but essentially, I'd like to set all "dist" data 
>> less than 0.5 to "0", and have the rest remain as they are...
>>
>>
>> meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
>> if (meuse.grid[["dist"]]<0.5) {meuse.grid[["class"]]==0} else
> I guess you meant an = rather than a == here
>> {meuse.grid[["class"]]=meuse.grid[["dist"]]}
>> }
>>
>> All I've managed to get is the new attribute "class" all filled with 0.
>>
> Try:
>
> meuse.grid$class = meuse.grid$dist
> meuse.grid$class[meuse.grid$dist < .5] = 0
> plot(class~dist,meuse.grid)
> -- 
> Edzer
>



From edzer.pebesma at uni-muenster.de  Mon May  5 22:08:18 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 May 2008 22:08:18 +0200
Subject: [R-sig-Geo] kriging output
In-Reply-To: <481F64AA.4040507@scimail.uwaterloo.ca>
References: <481F51A2.9050102@scimail.uwaterloo.ca>
	<481F5B63.6060102@uni-muenster.de>
	<481F64AA.4040507@scimail.uwaterloo.ca>
Message-ID: <481F6932.5090709@uni-muenster.de>

Dave Depew wrote:
> Thanks,
> This worked.
>
> I'm still confused why the if else statement didn't work...
> If one wanted to do conditional arithmetic would a for statement bee 
> needed?
>
>
> e.g.
> meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
> if (meuse.grid[["dist"]]<0.5) 
> {meuse.grid[["class"]]=10*meuse.grid[["dist]]} else
> {meuse.grid[["class"]]=100* meuse.grid[["dist"]]}
> }
>
I'd say
meuse.grid$class = ifelse(meuse.grid$dist < .5, 10, 100) * meuse.grid$dist

assigning the result from a for statement also does not yield a beauty 
price if you ask me, but that might be my  backgrounds in C, long ago.
--
Edzer



From Roger.Bivand at nhh.no  Tue May  6 09:06:57 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 May 2008 09:06:57 +0200 (CEST)
Subject: [R-sig-Geo] kriging output
In-Reply-To: <481F6932.5090709@uni-muenster.de>
References: <481F51A2.9050102@scimail.uwaterloo.ca>
	<481F5B63.6060102@uni-muenster.de>
	<481F64AA.4040507@scimail.uwaterloo.ca>
	<481F6932.5090709@uni-muenster.de>
Message-ID: <Pine.LNX.4.64.0805060856330.17989@reclus.nhh.no>

On Mon, 5 May 2008, Edzer Pebesma wrote:

> Dave Depew wrote:
>>  Thanks,
>>  This worked.
>>
>>  I'm still confused why the if else statement didn't work...
>>  If one wanted to do conditional arithmetic would a for statement bee
>>  needed?
>> 
>>
>>  e.g.
>>  meuse.grid[["class"]] = for(i in 1:length(meuse.grid[["dist"]])){
>>  if (meuse.grid[["dist"]]<0.5)
>>  {meuse.grid[["class"]]=10*meuse.grid[["dist]]} else
>>  {meuse.grid[["class"]]=100* meuse.grid[["dist"]]}
>>  }
>> 
> I'd say
> meuse.grid$class = ifelse(meuse.grid$dist < .5, 10, 100) * meuse.grid$dist

Right. ifelse() is vectorised, but if() else is not, so the vector 
condition in ifelse() splits out nicely, but if() else is flow control on 
a scalar condition. The above for loop looks redundant anyway (no use of 
index), but the if() else construction wouldn't work either - as you 
found out earlier.

For things like this, Braun & Murdoch is good (and from Canada!); if you 
read German, Uwe Ligges' book is recommended. It's also in the online 
Introduction to R, section 9.2.1, which explains the previous paragraph 
much more clearly than I can.

Roger

>
> assigning the result from a for statement also does not yield a beauty price 
> if you ask me, but that might be my  backgrounds in C, long ago.
> --
> Edzer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From adrian at maths.uwa.edu.au  Wed May  7 04:15:01 2008
From: adrian at maths.uwa.edu.au (adrian at maths.uwa.edu.au)
Date: Wed, 7 May 2008 10:15:01 +0800 (WST)
Subject: [R-sig-Geo] (no subject)
Message-ID: <1243.130.116.64.184.1210126501.squirrel@130.116.64.184>

Markus Loecher <mao.loecher at gmail.com> writes:

> I am looking for a function that
> indicates whether a line segment falls inside a rectangle (i.e. crosses
> the rectangle boundaries somewhere).

In the spatstat package: Suppose W is the rectangle (or other polygon),
stored as an object of class "owin", and S is the line segment, stored as
an object of class "psp" (inside some arbitrary, larger window). Then
      X <- crossing.psp(as.psp(W), S)
      X$n > 0
returns TRUE if the line segment crosses any of the edges of the
rectangle. The command as.psp(W) converts the edges of the window to a
list of line segments.

> In addition I need to (ii) compute the orthogonal projection
> of a point onto a line segment.

Do you mean the orthogonal projection of a point onto an infinite line, or
the convex projection (nearest point) of a point onto a line segment?

Adrian Baddeley



From Erik.Meesters at wur.nl  Wed May  7 08:44:37 2008
From: Erik.Meesters at wur.nl (Meesters, Erik)
Date: Wed, 7 May 2008 08:44:37 +0200
Subject: [R-sig-Geo] convert x,y,z data into a grid
Message-ID: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/e324ba3f/attachment.pl>

From regmi_pujan at hotmail.com  Wed May  7 12:22:14 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 7 May 2008 10:22:14 +0000
Subject: [R-sig-Geo] variogram using gstat
Message-ID: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/e4f33f0e/attachment.pl>

From mgallay01 at qub.ac.uk  Wed May  7 11:51:32 2008
From: mgallay01 at qub.ac.uk (Michal Gallay)
Date: 07 May 2008 10:51:32 +0100
Subject: [R-sig-Geo] convert x,y,z data into a grid
In-Reply-To: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl>
References: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl>
Message-ID: <Prayer.1.0.12.0805071051320.9519@localhost.localdomain>

On May 7 2008, Meesters, Erik wrote:

> Dear list members,
> I'm looking for a function in R like the function r.in.xyz in GRASS (vs.
> 6.2). I have x, y, z data frame (UTM) with z equals depth and would like
> to make a 3dperspective plot with rgl. My dataframe has 2.5 milion rows,
> so I think it's necessary to convert the data to a grid with something
> like mean depth per grid cell. I know I've seen an answer to a similar
> question somewhere on one of the lists, but I just don't seem to be able
> to find it again. Thanks for any help.
> Erik Meesters
>  


Hello Erik,

you could try something like the following code with lattice package.
You don't need to convert the data to grid for this.

require(lattice)

mydata <- read.table(...)

wireframe(z ~ x * y, data = mydata,
          scales = list(arrows = FALSE),
          drape = TRUE, colorkey = TRUE,
          screen = list(z = 30, x = -60))

or with simple graphics function 'persp' but for this you need to convert 
the data to matrix/grid. The following code presumes your x,y,z coordinates 
are on a grid. It will not work if they are not or at least I am not aware 
of any other approach.

require(sp)

coordinates(mydata) <- ~ x+y
gridded(mydata) <- TRUE 
m <- as.matrix(mydata)

exag <- 3
spacing <- 5
theta_val <- 120
phi_val <- 35
ltheta_val <- 20
lphi_val <- 10
z <- exag * m      # Exaggerate the relief
x <- spacing * (1:dim(m)[1]) 
y <- spacing * (1:dim(m)[2])
		
par(c(0.5,0.5,0.5,0.5))
persp(x, y, z, theta = theta_val, phi = phi_val, 
col = "gray", scale = FALSE,
ltheta = ltheta_val, lphi=lphi_val, shade = 0.75, 
border = NA, box = TRUE, r=600)

This worked for my 2mil points data.

I hope it helps.

Michal


> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Michal Gallay

Postgraduate Research Student
School of Geography, Archaeology and Palaeoecology
Queen's University
Belfast BT7 1NN
Northern Ireland

Tel: +44(0)2890 273929
Fax: +44(0)2890 973212
email: mgallay01 at qub.ac.uk
www: www.qub.ac.uk/geog



From Thierry.ONKELINX at inbo.be  Wed May  7 13:06:58 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 7 May 2008 13:06:58 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl>
Message-ID: <2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>

Dear Pujan,

Calculating variograms on large datasets is computationally rather
heavy. So maybe R didn't hang but was still busy calculating the
variogram. Run your script overnight (or over the weekend) and see the
next morning if it finished.
I couldn't find an error in your code at first glance.

HTH,

Thierry


------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens PUJAN RAJ REGMI
Verzonden: woensdag 7 mei 2008 12:22
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: [R-sig-Geo] variogram using gstat

Dear list,
I am trying to plot semivariogram suing gstat packages. But as soon as i
run the command variogram the programs hangs!! I don't know what
happened! Actually in my data set i have many rows (96000). My data has
5 columns out of these first 2 are x and y coordinates and the rest 3
are the sample data of different items under study. following is the
command i used to run the program:
A<-read.table(file.choose(new=FALSE), sep = ",",skip=1,header=FALSE) 
names(A) <- c("x", "y", "R", "G", "B")
coordinates(A) = ~x+y
variogram(R~1,A,cutoff=800,width=800/15)

My data set has maximum spatial extent of 2000m in x and and around
1600m in y direction. The variation in x and y direction is 12 m ( the
data set is irregular but in grid(12m))
Any help will be greatly appreciated
Thanking you
Pujan




_________________________________________________________________

 1.

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From regmi_pujan at hotmail.com  Wed May  7 13:50:25 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 7 May 2008 11:50:25 +0000
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
Message-ID: <BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/4d65820a/attachment.pl>

From Thierry.ONKELINX at inbo.be  Wed May  7 14:21:14 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 7 May 2008 14:21:14 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
Message-ID: <2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/b396712c/attachment.pl>

From Erik.Meesters at wur.nl  Wed May  7 14:23:09 2008
From: Erik.Meesters at wur.nl (Meesters, Erik)
Date: Wed, 7 May 2008 14:23:09 +0200
Subject: [R-sig-Geo] convert x,y,z data into a grid
In-Reply-To: <Prayer.1.0.12.0805071047370.9519@localhost.localdomain>
References: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl>
	<Prayer.1.0.12.0805071047370.9519@localhost.localdomain>
Message-ID: <055461107DE3B14AADEAA2D300D417F50125A5D6@scomp0040.wurnet.nl>

Michal,
thanks for the suggestions. If I try the wireframe I get a warning
message

"Warning message:
In nx * ny : NAs produced by integer overflow"

I haven't been able to figure out why that is, but could have something
to do with the 2.5mil * 2.5mil number of rows....

My data are not in a grid format, so the second option will not work. 
The data are simply UTM positions and depth values from a cruise
covering approximately an area of 10 square kilometers. In Grass there
is a function that reads in the dataframe and converts the data to a
grid which I think is easier to work with in many of the different
plotting routines.

Hope anyone can help.
Erik



-----Original Message-----
From: Michal Gallay [mailto:mgallay01 at qub.ac.uk] 
Sent: Wednesday, May 07, 2008 11:48
To: Meesters, Erik
Subject: Re: [R-sig-Geo] convert x,y,z data into a grid

On May 7 2008, Meesters, Erik wrote:

> Dear list members,
> I'm looking for a function in R like the function r.in.xyz in GRASS
(vs.
> 6.2). I have x, y, z data frame (UTM) with z equals depth and would 
> like to make a 3dperspective plot with rgl. My dataframe has 2.5 
> milion rows, so I think it's necessary to convert the data to a grid 
> with something like mean depth per grid cell. I know I've seen an 
> answer to a similar question somewhere on one of the lists, but I just

> don't seem to be able to find it again. Thanks for any help.
> Erik Meesters
>  

Hello Erik,

you could try something like the following code with lattice package.
You don't need to convert the dat to grid for this.

require(lattice)

mydata <- read.table(...)

wireframe(z ~ x * y, data = mydata,
          scales = list(arrows = FALSE),
          drape = TRUE, colorkey = TRUE,
          screen = list(z = 30, x = -60))

or with simple graphics function 'persp' but for this you need to
convert the data to matrix/grid. The following code presumes your x,y,z
coordinates are on a grid. It will not work if they are not or at least
I am not aware of any other approach.

require(sp)

coordinates(mydata) <- ~ x+y
gridded(mydata) <- TRUE
m <- as.matrix(mydata)
exag <- 3
spacing <- 5
theta_val <- 120
phi_val <- 35
ltheta_val <- 20
lphi_val <- 10
z <- exag * m      # Exaggerate the relief
x <- spacing * (1:dim(m)[1])
y <- spacing * (1:dim(m)[2])

par(c(0.5,0.5,0.5,0.5))
persp(x, y, z, theta = theta_val, phi = phi_val, col = "gray", scale =
FALSE, ltheta = ltheta_val, lphi=lphi_val, shade = 0.75, border = NA,
box = TRUE, r=600)

Both of them worked for my 2mil points data.

I hope this helps.

Michal


> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

--
Michal Gallay

Postgraduate Research Student
School of Geography, Archaeology and Palaeoecology Queen's University
Belfast BT7 1NN Northern Ireland

Tel: +44(0)2890 273929
Fax: +44(0)2890 973212
email: mgallay01 at qub.ac.uk
www: www.qub.ac.uk/geog



From Thierry.ONKELINX at inbo.be  Wed May  7 14:33:08 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 7 May 2008 14:33:08 +0200
Subject: [R-sig-Geo] convert x,y,z data into a grid
In-Reply-To: <055461107DE3B14AADEAA2D300D417F50125A5D6@scomp0040.wurnet.nl>
References: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl><Prayer.1.0.12.0805071047370.9519@localhost.localdomain>
	<055461107DE3B14AADEAA2D300D417F50125A5D6@scomp0040.wurnet.nl>
Message-ID: <2E9C414912813E4EB981326983E0A10404C18E72@inboexch.inbo.be>

Dear Erik,

In my opinion you beter first create an interpolated grid (e.g. with
kriging). Then plot this interpolated grid. That will reduce the number
of points dramatically. A 100 by 100 grid will probably do.

HTH,

Thierry


------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Meesters, Erik
Verzonden: woensdag 7 mei 2008 14:23
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] convert x,y,z data into a grid

Michal,
thanks for the suggestions. If I try the wireframe I get a warning
message

"Warning message:
In nx * ny : NAs produced by integer overflow"

I haven't been able to figure out why that is, but could have something
to do with the 2.5mil * 2.5mil number of rows....

My data are not in a grid format, so the second option will not work. 
The data are simply UTM positions and depth values from a cruise
covering approximately an area of 10 square kilometers. In Grass there
is a function that reads in the dataframe and converts the data to a
grid which I think is easier to work with in many of the different
plotting routines.

Hope anyone can help.
Erik



-----Original Message-----
From: Michal Gallay [mailto:mgallay01 at qub.ac.uk] 
Sent: Wednesday, May 07, 2008 11:48
To: Meesters, Erik
Subject: Re: [R-sig-Geo] convert x,y,z data into a grid

On May 7 2008, Meesters, Erik wrote:

> Dear list members,
> I'm looking for a function in R like the function r.in.xyz in GRASS
(vs.
> 6.2). I have x, y, z data frame (UTM) with z equals depth and would 
> like to make a 3dperspective plot with rgl. My dataframe has 2.5 
> milion rows, so I think it's necessary to convert the data to a grid 
> with something like mean depth per grid cell. I know I've seen an 
> answer to a similar question somewhere on one of the lists, but I just

> don't seem to be able to find it again. Thanks for any help.
> Erik Meesters
>  

Hello Erik,

you could try something like the following code with lattice package.
You don't need to convert the dat to grid for this.

require(lattice)

mydata <- read.table(...)

wireframe(z ~ x * y, data = mydata,
          scales = list(arrows = FALSE),
          drape = TRUE, colorkey = TRUE,
          screen = list(z = 30, x = -60))

or with simple graphics function 'persp' but for this you need to
convert the data to matrix/grid. The following code presumes your x,y,z
coordinates are on a grid. It will not work if they are not or at least
I am not aware of any other approach.

require(sp)

coordinates(mydata) <- ~ x+y
gridded(mydata) <- TRUE
m <- as.matrix(mydata)
exag <- 3
spacing <- 5
theta_val <- 120
phi_val <- 35
ltheta_val <- 20
lphi_val <- 10
z <- exag * m      # Exaggerate the relief
x <- spacing * (1:dim(m)[1])
y <- spacing * (1:dim(m)[2])

par(c(0.5,0.5,0.5,0.5))
persp(x, y, z, theta = theta_val, phi = phi_val, col = "gray", scale =
FALSE, ltheta = ltheta_val, lphi=lphi_val, shade = 0.75, border = NA,
box = TRUE, r=600)

Both of them worked for my 2mil points data.

I hope this helps.

Michal


> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

--
Michal Gallay

Postgraduate Research Student
School of Geography, Archaeology and Palaeoecology Queen's University
Belfast BT7 1NN Northern Ireland

Tel: +44(0)2890 273929
Fax: +44(0)2890 973212
email: mgallay01 at qub.ac.uk
www: www.qub.ac.uk/geog

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roel.May at nina.no  Wed May  7 15:35:54 2008
From: Roel.May at nina.no (May, Roel)
Date: Wed, 7 May 2008 15:35:54 +0200
Subject: [R-sig-Geo] Calculation of geographical slope
Message-ID: <A2C6E53287774840B0A2CEF5AED14DD50166F60A@alm.nina.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/9a2407e9/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May  7 15:59:47 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 May 2008 15:59:47 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
Message-ID: <4821B5D3.3040302@uni-muenster.de>

ONKELINX, Thierry wrote:
> Dear Pujan,
>  
> The helpfile (?variogram) is a wonderfull thing because it answers you
> question about dist. It reads: 
> dist	 the average distance of all point pairs considered for this
> estimate	
>  
> I think that gstat is based on gslib (Edzer, please correct me if I'm
> wrong). 
No, the gstat "core" code is written in C rather than in fortran. It was 
written in a similar time, i.e. the early 90s.
> Last year we compared gslib with R and gstat. Both yielded
> simmilar results. We prefered R and gstat over gslib because R is a more
> flexible and versatile tool.
>  
I'm always interested in hearing comparison results, and trying to 
figure out where differences come from. In theory, results should be 
identical rather than similar.
--
Edzer



From marcelino.delacruz at upm.es  Wed May  7 16:08:18 2008
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 07 May 2008 16:08:18 +0200
Subject: [R-sig-Geo] convert x,y,z data into a grid
In-Reply-To: <2E9C414912813E4EB981326983E0A10404C18E72@inboexch.inbo.be>
References: <055461107DE3B14AADEAA2D300D417F50125A5BA@scomp0040.wurnet.nl>
	<Prayer.1.0.12.0805071047370.9519@localhost.localdomain>
	<055461107DE3B14AADEAA2D300D417F50125A5D6@scomp0040.wurnet.nl>
	<2E9C414912813E4EB981326983E0A10404C18E72@inboexch.inbo.be>
Message-ID: <200805071408.m47E8Bcb030903@smtp.upm.es>


This would be my way, with kernel smoothing from spatstat function smooth.ppp:

Let's say that "cosa" is a dataframe with three columns x, y and z .

library(rgl)

library(ecespa) # for function "haz.ppp"; it requires (and load)  spatstat

cosa.ppp <- haz.ppp (cosa) # makes ppp object 
"easily". You may consider also functions "ppp" or "as.ppp" in spatstat.

cosa.s <- smooth.ppp (cosa.ppp)  #  spatial 
smoothing of numeric values observed

cosa.p <- persp.im (cosa.s) # 3D transformation 
matrix returned by persp.default

persp3d(cosa.p) # your perspective plot


Regards, Marcelino



At 14:33 07/05/2008, ONKELINX, Thierry wrote:
>Dear Erik,
>
>In my opinion you beter first create an interpolated grid (e.g. with
>kriging). Then plot this interpolated grid. That will reduce the number
>of points dramatically. A 100 by 100 grid will probably do.
>
>HTH,
>
>Thierry
>
>
>------------------------------------------------------------------------
>----
>ir. Thierry Onkelinx
>Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>and Forest
>Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
>methodology and quality assurance
>Gaverstraat 4
>9500 Geraardsbergen
>Belgium
>tel. + 32 54/436 185
>Thierry.Onkelinx at inbo.be
>www.inbo.be
>
>To call in the statistician after the experiment is done may be no more
>than asking him to perform a post-mortem examination: he may be able to
>say what the experiment died of.
>~ Sir Ronald Aylmer Fisher
>
>The plural of anecdote is not data.
>~ Roger Brinner
>
>The combination of some data and an aching desire for an answer does not
>ensure that a reasonable answer can be extracted from a given body of
>data.
>~ John Tukey
>
>-----Oorspronkelijk bericht-----
>Van: r-sig-geo-bounces at stat.math.ethz.ch
>[mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Meesters, Erik
>Verzonden: woensdag 7 mei 2008 14:23
>Aan: r-sig-geo at stat.math.ethz.ch
>Onderwerp: Re: [R-sig-Geo] convert x,y,z data into a grid
>
>Michal,
>thanks for the suggestions. If I try the wireframe I get a warning
>message
>
>"Warning message:
>In nx * ny : NAs produced by integer overflow"
>
>I haven't been able to figure out why that is, but could have something
>to do with the 2.5mil * 2.5mil number of rows....
>
>My data are not in a grid format, so the second option will not work.
>The data are simply UTM positions and depth values from a cruise
>covering approximately an area of 10 square kilometers. In Grass there
>is a function that reads in the dataframe and converts the data to a
>grid which I think is easier to work with in many of the different
>plotting routines.
>
>Hope anyone can help.
>Erik
>
>
>
>-----Original Message-----
>From: Michal Gallay [mailto:mgallay01 at qub.ac.uk]
>Sent: Wednesday, May 07, 2008 11:48
>To: Meesters, Erik
>Subject: Re: [R-sig-Geo] convert x,y,z data into a grid
>
>On May 7 2008, Meesters, Erik wrote:
>
> > Dear list members,
> > I'm looking for a function in R like the function r.in.xyz in GRASS
>(vs.
> > 6.2). I have x, y, z data frame (UTM) with z equals depth and would
> > like to make a 3dperspective plot with rgl. My dataframe has 2.5
> > milion rows, so I think it's necessary to convert the data to a grid
> > with something like mean depth per grid cell. I know I've seen an
> > answer to a similar question somewhere on one of the lists, but I just
>
> > don't seem to be able to find it again. Thanks for any help.
> > Erik Meesters
> >
>
>Hello Erik,
>
>you could try something like the following code with lattice package.
>You don't need to convert the dat to grid for this.
>
>require(lattice)
>
>mydata <- read.table(...)
>
>wireframe(z ~ x * y, data = mydata,
>           scales = list(arrows = FALSE),
>           drape = TRUE, colorkey = TRUE,
>           screen = list(z = 30, x = -60))
>
>or with simple graphics function 'persp' but for this you need to
>convert the data to matrix/grid. The following code presumes your x,y,z
>coordinates are on a grid. It will not work if they are not or at least
>I am not aware of any other approach.
>
>require(sp)
>
>coordinates(mydata) <- ~ x+y
>gridded(mydata) <- TRUE
>m <- as.matrix(mydata)
>exag <- 3
>spacing <- 5
>theta_val <- 120
>phi_val <- 35
>ltheta_val <- 20
>lphi_val <- 10
>z <- exag * m      # Exaggerate the relief
>x <- spacing * (1:dim(m)[1])
>y <- spacing * (1:dim(m)[2])
>
>par(c(0.5,0.5,0.5,0.5))
>persp(x, y, z, theta = theta_val, phi = phi_val, col = "gray", scale =
>FALSE, ltheta = ltheta_val, lphi=lphi_val, shade = 0.75, border = NA,
>box = TRUE, r=600)
>
>Both of them worked for my 2mil points data.
>
>I hope this helps.
>
>Michal
>
>
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>--
>Michal Gallay
>
>Postgraduate Research Student
>School of Geography, Archaeology and Palaeoecology Queen's University
>Belfast BT7 1NN Northern Ireland
>
>Tel: +44(0)2890 273929
>Fax: +44(0)2890 973212
>email: mgallay01 at qub.ac.uk
>www: www.qub.ac.uk/geog
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es



From Thierry.ONKELINX at inbo.be  Wed May  7 16:36:24 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 7 May 2008 16:36:24 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <4821B5D3.3040302@uni-muenster.de>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
Message-ID: <2E9C414912813E4EB981326983E0A10404C18F10@inboexch.inbo.be>

Hi Edzer,

Well, I wrote similar because I don't now the details by heart.
Furthermore the we analysed the same data independently in R/gstat and
variowin/gslib. The emphasis of our comparisons was rather on what was
the most userfriendly workflow. So the question was not realy if gslib
yields exactly the same results as gstat. But rather if R/gstat is
usefull to teach geostatistics when compared to variowin/gslib. Given
that most of the students use R (or S+) in other courses, we think that
using R/gstat is easier for the students.

I don't know whether the professor will change from variowin/gslib to
R/gstat. We were probabily just a bunch of R-addicted students who
perferred their own toys ;-)

Cheers,

Thierry 


------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Verzonden: woensdag 7 mei 2008 16:00
Aan: ONKELINX, Thierry
CC: PUJAN RAJ REGMI; r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] variogram using gstat

ONKELINX, Thierry wrote:
> Dear Pujan,
>  
> The helpfile (?variogram) is a wonderfull thing because it answers you
> question about dist. It reads: 
> dist	 the average distance of all point pairs considered for this
> estimate	
>  
> I think that gstat is based on gslib (Edzer, please correct me if I'm
> wrong). 
No, the gstat "core" code is written in C rather than in fortran. It was

written in a similar time, i.e. the early 90s.
> Last year we compared gslib with R and gstat. Both yielded
> simmilar results. We prefered R and gstat over gslib because R is a
more
> flexible and versatile tool.
>  
I'm always interested in hearing comparison results, and trying to 
figure out where differences come from. In theory, results should be 
identical rather than similar.
--
Edzer



From regmi_pujan at hotmail.com  Wed May  7 16:50:37 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 7 May 2008 14:50:37 +0000
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <4821B5D3.3040302@uni-muenster.de>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
Message-ID: <BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/52ace29d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May  7 18:27:44 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 May 2008 18:27:44 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
	<BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
Message-ID: <4821D880.60901@uni-muenster.de>

PUJAN RAJ REGMI wrote:
>
> Dear sir,
> Ya, Now I am comparing the results from gslib and R/gsat. The shape of 
> variograms exactly overlaps but the position of points varies, I don't 
> know why? or it is normal! I first checked the result of 
> omnidirectional variogram but still to have checked for directional 
> cases. I hope the plot will overlap exactly on these cases too!!
> Thanking you
> Pujan
>  
Does gslib also compute average distances over the point pairs, or does 
it give the middle point of the distance bin?
--
Edzer



From regmi_pujan at hotmail.com  Thu May  8 01:44:00 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 7 May 2008 23:44:00 +0000
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <4821D880.60901@uni-muenster.de>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
	<BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
	<4821D880.60901@uni-muenster.de>
Message-ID: <BAY113-W96DDD2387EE5A704B130884D10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080507/68c0ae1a/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu May  8 08:10:48 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 08 May 2008 08:10:48 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <BAY113-W96DDD2387EE5A704B130884D10@phx.gbl>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
	<BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
	<4821D880.60901@uni-muenster.de>
	<BAY113-W96DDD2387EE5A704B130884D10@phx.gbl>
Message-ID: <48229968.4070608@uni-muenster.de>

 From the gslib book, I understand that there is a lag, and a lag 
tolerance, and a cutoff. lag 0 is 0, the lag 1 is <0,tol], lag 2  
<lag2-tol,lag2+tol>, lag3 <lag3-tol,lag3+tol>, etc. This allows for 
overlap in the lags, if tolerance is larger than half the difference 
between lags.

gstat uses regular lag (the first one is not shorter than the latter):
lag1 = [0,width>
lag2 = [width,2*width>
lag3 = [2*width,3*width>
up to the cutoff. So, there's no possibility of overlapping lags, and a 
different organization of them.

tol_hor is the horizontal direction tolarance, and has nothing to do 
with width and cutoff.

note that gstat does not have a bandwidth concept, so for comparison 
purposes you should set this to a very large value.
--
Edzer

PUJAN RAJ REGMI wrote:
>
> Dear sir,
> I spent lot of time to figured it out what causing the difference in 
> result of R/gstat and gslib but didn't get any logical explanation. In 
> my opinion the source of difference is the cutoff and width.
> I would be thankful if you give me the in depth explanation of these 
> two parameters used in gstat or you can suggest me the suitable value 
> i should adopt for my case. In my data set the diagonal is 2771.89 so 
> 1/3 of it is 923.96 i believe this is the default cutoff. but what 
> about width, i don't get the logic of this function? where as in gslib 
> we have to define the limit to what level pairs will be compared and 
> the distance between the pairs and its tolerance. for my case in case 
> of directional semivariogram the distance between is 12m and tolerance 
> 6m and the extent is 923.96m that is i have to define numbers of lag 
> as 923.96/12 ~77 nos. i didn't see the tolerance for lag in gstat, i 
> think this has been done with build in script which incorporates with 
> tol.hor command?? One more querry; is it correct to use same cutoff 
> and width for omnidirectional and directional semivariogram 
> (especially in 45 and 135 directions)?? as the lag in 0 and 90 
> directions is 12 where as in 45 and 135 is 16.97m.
> Though my question seems very basic, hope you find sometime to answer them
> Thanking you
> Pujan
>
> ------------------------------------------------------------------------
> > Date: Wed, 7 May 2008 18:27:44 +0200
> > From: edzer.pebesma at uni-muenster.de
> > To: regmi_pujan at hotmail.com
> > CC: thierry.onkelinx at inbo.be; r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] variogram using gstat
> >
> > PUJAN RAJ REGMI wrote:
> > >
> > > Dear sir,
> > > Ya, Now I am comparing the results from gslib and R/gsat. The 
> shape of
> > > variograms exactly overlaps but the position of points varies, I 
> don't
> > > know why? or it is normal! I first checked the result of
> > > omnidirectional variogram but still to have checked for directional
> > > cases. I hope the plot will overlap exactly on these cases too!!
> > > Thanking you
> > > Pujan
> > >
> > Does gslib also compute average distances over the point pairs, or does
> > it give the middle point of the distance bin?
> > --
> > Edzer
>
> ------------------------------------------------------------------------
> Windows Live SkyDrive lets you share files with faraway friends. Start 
> sharing. 
> <http://www.windowslive.com/skydrive/overview.html?ocid=TXT_TAGLM_WL_Refresh_skydrive_052008>



From Agustin.Lobo at ija.csic.es  Thu May  8 10:44:30 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Thu, 08 May 2008 10:44:30 +0200
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
Message-ID: <4822BD6E.8000906@ija.csic.es>

Hi!

Is it possible (and if yes, how) to convert from an spatialPointsDataFrame
to a ppp object (selecting the appropriate variable in the
dataframe) so that I can run Kest ?
I've tried with as.ppp with no success.

(I always have a bad time converting among the different spatial
objects in R, I promise contributing a flow chart soon, or is ti
included in the new book?).

Thanks!

Agus
-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From marcelino.delacruz at upm.es  Thu May  8 11:09:39 2008
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 08 May 2008 11:09:39 +0200
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
In-Reply-To: <4822BD6E.8000906@ija.csic.es>
References: <4822BD6E.8000906@ija.csic.es>
Message-ID: <200805080909.m4899Tmh013420@smtp.upm.es>

 From the help of as.ppp {maptools}


data(meuse)

 > class(meuse)
[1] "SpatialPointsDataFrame"
attr(,"package")
[1] "sp"


coordinates(meuse) = ~x+y
zn1 <- as(meuse["zinc"], "ppp")
zn1

And then try this:

Kest(zn1)


Regards,

Marcelino


At 10:44 08/05/2008, Agustin Lobo wrote:
>Hi!
>
>Is it possible (and if yes, how) to convert from an spatialPointsDataFrame
>to a ppp object (selecting the appropriate variable in the
>dataframe) so that I can run Kest ?
>I've tried with as.ppp with no success.
>
>(I always have a bad time converting among the different spatial
>objects in R, I promise contributing a flow chart soon, or is ti
>included in the new book?).
>
>Thanks!
>
>Agus
>--
>Dr. Agustin Lobo
>Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
>LLuis Sole Sabaris s/n
>08028 Barcelona
>Spain
>Tel. 34 934095410
>Fax. 34 934110012
>email: Agustin.Lobo at ija.csic.es
>http://www.ija.csic.es/gt/obster
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es



From regmi_pujan at hotmail.com  Thu May  8 15:26:53 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Thu, 8 May 2008 13:26:53 +0000
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <48229968.4070608@uni-muenster.de>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>
	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
	<BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
	<4821D880.60901@uni-muenster.de>
	<BAY113-W96DDD2387EE5A704B130884D10@phx.gbl>
	<48229968.4070608@uni-muenster.de>
Message-ID: <BAY113-W16529A0DB7C26B9451366384D00@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080508/8da00179/attachment.pl>

From mihainica at yahoo.com  Thu May  8 20:12:37 2008
From: mihainica at yahoo.com (Mihai Nica)
Date: Thu, 8 May 2008 11:12:37 -0700 (PDT)
Subject: [R-sig-Geo] spgpc
Message-ID: <737552.30469.qm@web50809.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080508/869015e0/attachment.pl>

From Roger.Bivand at nhh.no  Thu May  8 21:47:48 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 May 2008 21:47:48 +0200 (CEST)
Subject: [R-sig-Geo] spgpc
In-Reply-To: <737552.30469.qm@web50809.mail.re2.yahoo.com>
References: <737552.30469.qm@web50809.mail.re2.yahoo.com>
Message-ID: <Pine.LNX.4.64.0805082140580.3446@reclus.nhh.no>

On Thu, 8 May 2008, Mihai Nica wrote:

> Greetings:
>
> I used to merge a SpatialPolygonsDataFrame with another dataframe with the following code (thanks to Dr. Bivand):
> ############################################################################################
> library(maptools)
> library(spgpc)

The functionality from the former off-CRAN spgpc is now in maptools.

> county <- readShapePoly("contUScty2000.shp", ID="GISJOIN") # put shapefile in SpatialPolygonsDataFrame
> ok <- county[county$STATENAM =="Oklahoma",] # subset with "[" method
> dat=data.frame(read.delim(file="okdata.txt", header = TRUE, sep = "\t", quote="\"", dec=".",na.strings = "NA"))
> dat=dat[dat$Line.code=="10",]; str(dat)
> ok.df<- merge(as(ok, "data.frame"), dat, by.x="NHGISCTY",by.y="FIPS", all.x=TRUE, sort=FALSE)
> row.names(ok.df)=ok.df$SP_ID ######## - $SP_ID seems not to work either
> ok <- SpatialPolygonsDataFrame(as(ok.df, "SpatialPolygons"), data=ok.df)
                                     ^^^^
                           should be ok, I think 
>

ok is a SpatialPolygonsDataFrame, ok.df is a data frame.

Beyond that, look at ?"spChFIDs-methods" for ways of setting the 
SpatialPolygons IDs. Please just step though things line by line and be 
sure you understand what each line does. There is no silver bullet here, 
and certainly no magic, the above is a bit muddled and pretty illegible. 
Please do use spaces around operators and after commas. If you had, you 
would have seen yourself that the objects were not the ones you thought 
they were.

Hope this helps,

Roger

> Error in as(ok.df, "SpatialPolygons") :
>  no method or default for coercing "data.frame" to "SpatialPolygons" #this is the outcome...
>
>
> ###########################################################################################
>
> Unfortunatelly the last two lines are obsolete, (it seems that wrapping  "spgpc" with other packages might be the culprit) and I am lost again. I read the last discussions on the list, but was unable to solve the issue.
>
> Please be so kind as to offer a hint.
>
> Thanks,
>
> mihai
>
>
>      ____________________________________________________________________________________
>
> [[elided Yahoo spam]]
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mihainica at yahoo.com  Fri May  9 03:07:58 2008
From: mihainica at yahoo.com (Mihai Nica)
Date: Thu, 8 May 2008 18:07:58 -0700 (PDT)
Subject: [R-sig-Geo] spgpc
Message-ID: <413976.13989.qm@web50807.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080508/d55806f9/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri May  9 08:31:53 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 09 May 2008 08:31:53 +0200
Subject: [R-sig-Geo] variogram using gstat
In-Reply-To: <BAY113-W16529A0DB7C26B9451366384D00@phx.gbl>
References: <BAY113-W514050FD3DE7BD82BD283584D10@phx.gbl><2E9C414912813E4EB981326983E0A10404C18E21@inboexch.inbo.be>	<BAY113-W18DE3AE399728B3FD0694984D10@phx.gbl>
	<2E9C414912813E4EB981326983E0A10404C18E61@inboexch.inbo.be>
	<4821B5D3.3040302@uni-muenster.de>
	<BAY113-W17F06229D6B62C24D23B5B84D10@phx.gbl>
	<4821D880.60901@uni-muenster.de>
	<BAY113-W96DDD2387EE5A704B130884D10@phx.gbl>
	<48229968.4070608@uni-muenster.de>
	<BAY113-W16529A0DB7C26B9451366384D00@phx.gbl>
Message-ID: <4823EFD9.6010601@uni-muenster.de>

I don't know of any general guidelines here. I would settle with a 
reasonable number of point pairs (preferably over 20) per lag.
--
Edzer

PUJAN RAJ REGMI wrote:
> Dear sir,
> Thank you very much for the help. I would like to ask another question 
> regarding the "width" selection. For omni directional which 
> width should I choose in case when data set are in grid pattern?(in my 
> case 12m in each x and y dir. i.e. 16.97m in diagonal) I saw 
> selectiong different width (12 or 16.97m) resulted the plot varied 
> slightly which can be even vivid when i got the parameters for the 
> sill and range of the model semivariograms of such plots. I suppose 
> the 12 m would be the good choce as the curve will be more contninous 
> but in the same time ecah "dist" will have less no. of pairs but 
> tradeoff between no. pairs and  no."dist" should be done?? While for 
> directional semivariogram like in E-W and N-S is that necessary I 
> should choose 12m and in 45 and 135 16.97m?
> Thanking you
> Pujan
>  
>
>
> ------------------------------------------------------------------------
> > Date: Thu, 8 May 2008 08:10:48 +0200
> > From: edzer.pebesma at uni-muenster.de
> > To: regmi_pujan at hotmail.com
> > CC: thierry.onkelinx at inbo.be; r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] variogram using gstat
> >
> > From the gslib book, I understand that there is a lag, and a lag
> > tolerance, and a cutoff. lag 0 is 0, the lag 1 is <0,tol], lag 2
> > <lag2-tol,lag2+tol>, lag3 <lag3-tol,lag3+tol>, etc. This allows for
> > overlap in the lags, if tolerance is larger than half the difference
> > between lags.
> >
> > gstat uses regular lag (the first one is not shorter than the latter):
> > lag1 = [0,width>
> > lag2 = [width,2*width>
> > lag3 = [2*width,3*width>
> > up to the cutoff. So, there's no possibility of overlapping lags, and a
> > different organization of them.
> >
> > tol_hor is the horizontal direction tolarance, and has nothing to do
> > with width and cutoff.
> >
> > note that gstat does not have a bandwidth concept, so for comparison
> > purposes you should set this to a very large value.
> > --
> > Edzer
> >
> > PUJAN RAJ REGMI wrote:
> > >
> > > Dear sir,
> > > I spent lot of time to figured it out what causing the difference in
> > > result of R/gstat and gslib but didn't get any logical 
> explanation. In
> > > my opinion the source of difference is the cutoff and width.
> > > I would be thankful if you give me the in depth explanation of these
> > > two parameters used in gstat or you can suggest me the suitable value
> > > i should adopt for my case. In my data set the diagonal is 2771.89 so
> > > 1/3 of it is 923.96 i believe this is the default cutoff. but what
> > > about width, i don't get the logic of this function? where as in 
> gslib
> > > we have to define the limit to what level pairs will be compared and
> > > the distance between the pairs and its tolerance. for my case in case
> > > of directional semivariogram the distance between is 12m and 
> tolerance
> > > 6m and the extent is 923.96m that is i have to define numbers of lag
> > > as 923.96/12 ~77 nos. i didn't see the tolerance for lag in gstat, i
> > > think this has been done with build in script which incorporates with
> > > tol.hor command?? One more querry; is it correct to use same cutoff
> > > and width for omnidirectional and directional semivariogram
> > > (especially in 45 and 135 directions)?? as the lag in 0 and 90
> > > directions is 12 where as in 45 and 135 is 16.97m.
> > > Though my question seems very basic, hope you find sometime to 
> answer them
> > > Thanking you
> > > Pujan
> > >
> > > 
> ------------------------------------------------------------------------
> > > > Date: Wed, 7 May 2008 18:27:44 +0200
> > > > From: edzer.pebesma at uni-muenster.de
> > > > To: regmi_pujan at hotmail.com
> > > > CC: thierry.onkelinx at inbo.be; r-sig-geo at stat.math.ethz.ch
> > > > Subject: Re: [R-sig-Geo] variogram using gstat
> > > >
> > > > PUJAN RAJ REGMI wrote:
> > > > >
> > > > > Dear sir,
> > > > > Ya, Now I am comparing the results from gslib and R/gsat. The
> > > shape of
> > > > > variograms exactly overlaps but the position of points varies, I
> > > don't
> > > > > know why? or it is normal! I first checked the result of
> > > > > omnidirectional variogram but still to have checked for 
> directional
> > > > > cases. I hope the plot will overlap exactly on these cases too!!
> > > > > Thanking you
> > > > > Pujan
> > > > >
> > > > Does gslib also compute average distances over the point pairs, 
> or does
> > > > it give the middle point of the distance bin?
> > > > --
> > > > Edzer
> > >
> > > 
> ------------------------------------------------------------------------
> > > Windows Live SkyDrive lets you share files with faraway friends. 
> Start
> > > sharing.
> > > 
> <http://www.windowslive.com/skydrive/overview.html?ocid=TXT_TAGLM_WL_Refresh_skydrive_052008>
> >
>
> ------------------------------------------------------------------------
> With Windows Live for mobile, your contacts travel with you. Connect 
> on the go. 
> <http://www.windowslive.com/mobile/overview.html?ocid=TXT_TAGLM_WL_Refresh_mobile_052008>



From hengl at science.uva.nl  Fri May  9 10:20:11 2008
From: hengl at science.uva.nl (Tomislav Hengl)
Date: Fri, 9 May 2008 10:20:11 +0200
Subject: [R-sig-Geo] Vacancies for 2 Scientific Programmers,
	Computational Geo-Ecology, Amsterdam
Message-ID: <001001c8b1ad$80598c70$3a871291@pcibed193>


****************************

The Computational Geo-Ecology (CGE) research group of the University of Amsterdam is looking for two
enthusiastic Scientific Programmers who will develop virtual laboratories that support data analyses
and modelling. This concerns data exploration through interactive visualization, statistical
analyses that demand much computer time, and complex dynamic simulation models. In cooperation with
other members of the team, they will develop and implement workflows, develop new analysis
methodologies and simulation models, and introduce new eScience developments and tools.
More info about the CGE research group: http://www.science.uva.nl/ibed-cbpg 
Salary: The salary will depend on experience, and will range from ?2330 to a maximum of ?3678 gross
per month (salary scale 9 or 10) based on a full-time appointment. For candidates with a doctorate,
there is a development opportunity to Ontwikkelaar ICT 2 (salary scale 11, maximum ?4284 gross per
month). The collective labour agreement of Dutch universities is applicable.
Application deadline: 20 May 2008.

Vacancies for 2 Scientific Programmers
http://www.science.uva.nl/ibed/vacancies.cfm/947EF185-1321-B0BE-A431677965C36F66    



From Oscar.Breugelmans at rivm.nl  Fri May  9 16:02:39 2008
From: Oscar.Breugelmans at rivm.nl (Oscar Breugelmans)
Date: Fri, 9 May 2008 16:02:39 +0200
Subject: [R-sig-Geo] SpatialPolygonsDataFrame converted to SpatialPolygons
	after union
Message-ID: <OFAC8EA557.D8F18926-ONC1257444.004BF313-C1257444.004D25B0@notesmail.rivm.nl>

Dear list,

I have a postal code map of the Netherlands. I use the area code PC4NR as
the identifier for each area. After making a subset of the areas, I use
unionSpatialPolygons to combine the polygons (areas) that have a different
ID, but the same PC4NR. When using unionSpatialPolygons, my
SpatialPolygonsDataFrame is converted into a SpatialPolygons object,
thereby losing all the auxilliary information contained in the dataframe. I
want to return to shapefile format after this, but writePolyShape doesn't
work anymore after the union.
Is there any way to perform the union while retaining the
SpatialPolygonsDataFrame class? The R code is below.
Any help is appreciated.

Oscar Breugelmans


pc4.00=readShapePoly("I:/smarhagt/geocor/burenmatrix/pc4_2000/pc4_gebieden_2000")

pc4.00.subset<-pc4.00[!pc4.00$PC4NR %in%
c(1117,1118,1322,1327,1341,1361,2268,2633,2909,3165,

3196,3199,3894,3895,5656,6192,6236,7125,7324,7915,7935,8239,8292,8939,9408,9941),]

pc4.00.union<-unionSpatialPolygons(as(pc4.00.subset, "SpatialPolygons"),
      as.character(pc4.00.subset$PC4NR))

writePolyShape(pc4.00.union,"c:/data/pc4final")
____________________________________________________________________________

DISCLAIMER:  http://www.rivm.nl/disclaimer.htm\ ...{{dropped:2}}



From Roger.Bivand at nhh.no  Fri May  9 16:52:15 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 May 2008 16:52:15 +0200 (CEST)
Subject: [R-sig-Geo] Calculation of geographical slope
In-Reply-To: <A2C6E53287774840B0A2CEF5AED14DD50166F60A@alm.nina.no>
References: <A2C6E53287774840B0A2CEF5AED14DD50166F60A@alm.nina.no>
Message-ID: <Pine.LNX.4.64.0805091638030.5741@reclus.nhh.no>

On Wed, 7 May 2008, May, Roel wrote:

> Hi all,
>
> Does anyone know if there exists a function in R that can calculate
> geographical slope and aspect (i.e. like elevational slope/aspect) on
> grid values?

I'd suggest pushing the DEM out to GRASS, and using the module there. It 
could be done by creating new columns in a SpatialGridDataFrame for the 
eight neighbours and just doing the math - Zevenbergen and Thorne (1987) 
algorithm (for a reasonable sized DEM), but we don't have a function for 
grid shifting yet, contributions welcome!

Roger

> I've looked around on the R-sites but could not find anything on this.
> I hope can help a simple soul...
>
> Cheers, Roel
>
> Roel May
> Norwegian Institute for Nature Research
> Tungasletta 2, NO-7089 Trondheim
> Norway
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri May  9 17:31:35 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 May 2008 17:31:35 +0200 (CEST)
Subject: [R-sig-Geo] SpatialPolygonsDataFrame converted to
 SpatialPolygons after union
In-Reply-To: <OFAC8EA557.D8F18926-ONC1257444.004BF313-C1257444.004D25B0@notesmail.rivm.nl>
References: <OFAC8EA557.D8F18926-ONC1257444.004BF313-C1257444.004D25B0@notesmail.rivm.nl>
Message-ID: <Pine.LNX.4.64.0805091725200.5796@reclus.nhh.no>

On Fri, 9 May 2008, Oscar Breugelmans wrote:

> Dear list,
>
> I have a postal code map of the Netherlands. I use the area code PC4NR as
> the identifier for each area. After making a subset of the areas, I use
> unionSpatialPolygons to combine the polygons (areas) that have a different
> ID, but the same PC4NR. When using unionSpatialPolygons, my
> SpatialPolygonsDataFrame is converted into a SpatialPolygons object,
> thereby losing all the auxilliary information contained in the dataframe. I
> want to return to shapefile format after this, but writePolyShape doesn't
> work anymore after the union.

No, it will not work, because it is not clear which rows should be 
retained - you have to do this yourself. Think about whether you want to 
aggregate using sum(), or mean(), or in other ways. Once you have 
aggregated the data frame part of the SpatialPolygonsDataFrame, and 
inserted row names to match the union criterion vector, you can build a 
new SpatialPolygonsDataFrame, and export it in the usual way.

Roger

> Is there any way to perform the union while retaining the
> SpatialPolygonsDataFrame class? The R code is below.
> Any help is appreciated.
>
> Oscar Breugelmans
>
>
> pc4.00=readShapePoly("I:/smarhagt/geocor/burenmatrix/pc4_2000/pc4_gebieden_2000")
>
> pc4.00.subset<-pc4.00[!pc4.00$PC4NR %in%
> c(1117,1118,1322,1327,1341,1361,2268,2633,2909,3165,
>
> 3196,3199,3894,3895,5656,6192,6236,7125,7324,7915,7935,8239,8292,8939,9408,9941),]
>
> pc4.00.union<-unionSpatialPolygons(as(pc4.00.subset, "SpatialPolygons"),
>      as.character(pc4.00.subset$PC4NR))
>
> writePolyShape(pc4.00.union,"c:/data/pc4final")
> ____________________________________________________________________________
>
> DISCLAIMER:  http://www.rivm.nl/disclaimer.htm\ ...{{dropped:2}}
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri May  9 17:55:09 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 May 2008 17:55:09 +0200 (CEST)
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
In-Reply-To: <Pine.LNX.4.64.0805051457160.15163@reclus.nhh.no>
References: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com> 
	<Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>
	<e12429640805050220k65bb580bje48185dec2349c46@mail.gmail.com>
	<Pine.LNX.4.64.0805051457160.15163@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0805091752140.5796@reclus.nhh.no>

On Mon, 5 May 2008, Roger Bivand wrote:

> On Mon, 5 May 2008, G. Allegri wrote:
>
>>  Thank you Roger. I thought to buy it to realize a course on spatial data
>>  analysis and to suggest it to the alumns. I think it could be a good trade
>>  off between hard mathematical theory and an R manual...
>>  I've tried to insert the token indicated in the Discount Info, but
>>  Springer
>>  returns that it's expired.
>
> Thanks, I've passed on this failure (which I can reproduce) to those who 
> ought to be able to fix it.

I'm happy to report that the token remains valid, but should be entered 
only on checking out (upper right button), as described in:

http://www.springer.com/cda/content/document/cda_downloaddocument?SGWID=0-0-45-304789-0

(and in a very terse way on the R site note, so terse that it is easy to 
misunderstand).

Roger

>
> Roger
>
>>
>>  Giovanni
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From giohappy at gmail.com  Fri May  9 18:16:54 2008
From: giohappy at gmail.com (G. Allegri)
Date: Fri, 9 May 2008 18:16:54 +0200
Subject: [R-sig-Geo] about Applied Spatial Data Analysis with R book
In-Reply-To: <Pine.LNX.4.64.0805091752140.5796@reclus.nhh.no>
References: <e12429640805041617g348294a0v97d0e0d7d5dddc75@mail.gmail.com>
	<Pine.LNX.4.64.0805051044550.14332@reclus.nhh.no>
	<e12429640805050220k65bb580bje48185dec2349c46@mail.gmail.com>
	<Pine.LNX.4.64.0805051457160.15163@reclus.nhh.no>
	<Pine.LNX.4.64.0805091752140.5796@reclus.nhh.no>
Message-ID: <e12429640805090916y7ff6395aref03db2764f721f6@mail.gmail.com>

Thanks Roger.
I'll try it

2008/5/9 Roger Bivand <Roger.Bivand at nhh.no>:
> On Mon, 5 May 2008, Roger Bivand wrote:
>
>> On Mon, 5 May 2008, G. Allegri wrote:
>>
>>>  Thank you Roger. I thought to buy it to realize a course on spatial data
>>>  analysis and to suggest it to the alumns. I think it could be a good
>>> trade
>>>  off between hard mathematical theory and an R manual...
>>>  I've tried to insert the token indicated in the Discount Info, but
>>>  Springer
>>>  returns that it's expired.
>>
>> Thanks, I've passed on this failure (which I can reproduce) to those who
>> ought to be able to fix it.
>
> I'm happy to report that the token remains valid, but should be entered only
> on checking out (upper right button), as described in:
>
> http://www.springer.com/cda/content/document/cda_downloaddocument?SGWID=0-0-45-304789-0
>
> (and in a very terse way on the R site note, so terse that it is easy to
> misunderstand).
>
> Roger
>
>>
>> Roger
>>
>>>
>>>  Giovanni
>>>
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From hi_ono2001 at ybb.ne.jp  Mon May 12 14:43:27 2008
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Mon, 12 May 2008 21:43:27 +0900 (JST)
Subject: [R-sig-Geo] Spatial Filtering Workshop
Message-ID: <20080512124327.85525.qmail@web10709.mail.bbt.yahoo.co.jp>



 I found Spatial Filtering
Workshop(http://www.spatialfiltering.com/index.html
) in CSISS site(http://www.csiss.org/).

 However it seems to no tools available.

 And at last I know Professor Bivand is British
geographer. For a long time I think he was Norwegian.



 Best Regards.



From Roger.Bivand at nhh.no  Mon May 12 22:00:30 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 May 2008 22:00:30 +0200 (CEST)
Subject: [R-sig-Geo] maptools: appending data to SpatialPolygonsDataFrame
In-Reply-To: <60974.66.27.67.30.1209528246.squirrel@acs-webmail.ucsd.edu>
References: <60974.66.27.67.30.1209528246.squirrel@acs-webmail.ucsd.edu>
Message-ID: <Pine.LNX.4.64.0805122153440.5538@reclus.nhh.no>

On Tue, 29 Apr 2008, hkreft at ucsd.edu wrote:

> Dear all,
>
> I am just starting to use the library maptools. Specifically, I want to
> use it as a quick way to map results from various multivariate analyses
> (e.g. cluster analyses) directly in R.
> I encountered problems appending newly generated data (cluster
> memberships) to the SpatialPolygonsDataFrame object. Unfortunately, the
> documentation is not really helpful.

Dear Holger,

Sorry that this message did not get a reply - I'm afraid that your code 
example is unhelpful, because it doesn't go far enough. Do you mean 
something like:

library(maptools)
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
names(xx)
k5 <- kmeans(as(xx, "data.frame")[, 9:14], center=5)
str(k5)
xx$k5 <- factor(k5$cluster)
spplot(xx, "k5")

for a trivial example that can be reproduced?

Roger

>
> But I am sure that this is an easy question for you.
>
> Thanks in advance,
>
> Holger
>
>
> The code so far:
>
>>> my.polys <- readShapePoly("Z://mypoly.shp",IDvar="ID",verbose=T)
>>> plot(my.polys)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From v.gomezrubio at imperial.ac.uk  Tue May 13 14:21:51 2008
From: v.gomezrubio at imperial.ac.uk (Virgilio Gomez-Rubio)
Date: Tue, 13 May 2008 13:21:51 +0100
Subject: [R-sig-Geo] New book on environmental statistics with R
Message-ID: <1210681311.32737.14.camel@fh-vrubio>

Dear all,

I have just come across a new book that may be of interest to some of
you:

Clemens Reimann, Peter Filzmoser, Robert Garrett, and Rudolf Dutter.
Statistical Data Analysis Explained: Applied Environmental Statistics
with R. Wiley, Chichester, UK, 2008. ISBN: 978-0-470-98581-6. [ bib |
Publisher Info | http://www.statistik.tuwien.ac.at/StatDA ]


They have a few things on mapping but, as far as I have been able to read,
I do not think they are using sp classes. The code used in this book is already 
available here:

http://www.statistik.tuwien.ac.at/StatDA

Best regards,

Virgilio



From didier.leibovici at nottingham.ac.uk  Tue May 13 14:50:52 2008
From: didier.leibovici at nottingham.ac.uk (Didier Leibovici)
Date: Tue, 13 May 2008 13:50:52 +0100
Subject: [R-sig-Geo] Announcement: Geospatial Web Services workshop,
 CGS University of Nottingham
Message-ID: <48298EAC.6040105@nottingham.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080513/2565ca6b/attachment.pl>

From Agustin.Lobo at ija.csic.es  Tue May 13 22:37:22 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Tue, 13 May 2008 22:37:22 +0200
Subject: [R-sig-Geo] Qgis-user Digest, Vol 27, Issue 13
In-Reply-To: <4829CF4E.8070507@uvic.ca>
References: <20080512160008.078D9E012A4@lists.osgeo.org>
	<48288312.3060407@uvic.ca> <48294617.3040401@gmail.com>
	<48294C95.7030502@gmail.com> <4829CF4E.8070507@uvic.ca>
Message-ID: <4829FC02.5010502@ija.csic.es>

Thanks Carson, just knowing that this is an R console is enough.
Now, after making a simple plot(), I'm just dreaming: if we could
display sp objects directly, not only avoiding the intermediate
shp file but being able of plotting columns of the dataframe
as statistical graphics  in R...
and soon being able to interact between the R plot and the
geographic display (a linked brushing, for example), tools
like in GeoDa but with a real GIS diaplay...

Great job!
(I'm forwarding the r-sig-geo list just for them
to know your developments)

Agus

Carson Farmer wrote:
> Agustin Lobo wrote:
>> ok, just installed Rpy 1.0.3
>> (BTW, should I have uninstalled 1.02? how?)
>> and manageR loads
>> on qgis 0.10 on ubuntu hardy.
>> Carson, could you provide some directions on how to use it
>> or point me to any file with some directions?
> The plugin dialog can be treated like the R console itself. So whatever 
> commands you would type into R, you can do in manageR (just make sure 
> you use '<-' when assigning variables etc. as manageR doesn't like you 
> to use '='). I have an updated manageR version which, in addition to 
> making it easier to load spatial data, also makes it very easy to save R 
> spatial objects as shapefiles and automatically load them into QGIS. 
> This will be up on my repository soon (I will post a notice to this list 
> when it is).
> 
> As for directions on how to use manageR, I have not really come up with 
> anything yet, but I will try to post something soon with a basic how to 
> and some screen shots or something.
> 
> Hope this is enough to get you started!
> 
> Carson
>> Should I have R started or should I start it from within
>> your plugin?
>>
>> Thanks!
>>
>> Agus
>>
>> Agustin Lobo wrote:
>>> Hi!
>>>
>>> Rpy 1.0.3 is available since today!
>>> "The primary purpose of
>>> this release is to provide support for R 2.7.0."
>>> But no windows yet (not a problem in my case).
>>> More on:
>>> http://sourceforge.net/mailarchive/forum.php?thread_name=7C8225C0-9810-401A-857F-1B3D6EE4E5F4%40rochester.edu&forum_name=rpy-lis 
>>>
>>>
>>> I'll let you know how it goes with it.
>>>
>>> Agus
>>>
>>> Carson Farmer wrote:
>>>> Agus,
>>>> Unfortunately, the latest R and  Rpy versions are not compatible on 
>>>> Hardy, so the main repositories will be no help to you in this 
>>>> regard.  However, there are two solutions (that I know of):
>>>> 1) If you are able to, you can regress to an earlier version of R, 
>>>> such as 2.6.0 or 2.6.2. Rpy works fine for older versions.
>>>> 2) If you don't mind a little bit of extra work, you can follow the 
>>>> fix posted by Diwaker Gupta (this is actually for Gutsy, but it 
>>>> still works...) and a few posts afterwards to get Rpy working with 
>>>> the latest R.
>>>>
>>>> Personally, I use R 2.6.0 and Rpy 1.0.1 (though I think 1.0.2 is the 
>>>> most recent)
>>>>
>>>> Hope this helps,
>>>>
>>>> Carson
>>>> a.k.a. cfarmer on IRC
>>>>> No idea, I installed rpy for using manageR. How can I test it? Agus 
>>>>> Sebastien Vial wrote:
>>>>>> > Hi !
>>>>>> > > Here it works but with R 2.6.1 (and the RPY build for R 2.6.1)
>>>>>> > > Does your RPY works with R 2.7 ?
>>>>>> > > Seb
>>>>>> > > 2008/5/12 Agustin Lobo <aloboaleu at gmail.com>:
>>>>>> > 
>>>>>>> >> Hi!
>>>>>>> >>
>>>>>>> >> I have a problem with loading plugin manageR.
>>>>>>> >> I have R 2.7.0, rpy 1.0.2 , python and numpy on ubuntu hardy.
>>>>>>> >> I get
>>>>>>> >> the following message at starting qgis 0.10:
>>>>>>> >>
>>>>>>> >> Couldn't load plugin "manageR" from 
>>>>>>> ['/home/alobo/.qgis//python/plugins',
>>>>>>> >> '/usr/local/share/qgis/python', 
>>>>>>> '/usr/local/share/qgis/python/plugins',
>>>>>>> >> '/usr/lib/python25.zip', '/usr/lib/python2.5',
>>>>>>> >> '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk',
>>>>>>> >> '/usr/lib/python2.5/lib-dynload', 
>>>>>>> '/usr/local/lib/python2.5/site-packages',
>>>>>>> >> '/usr/lib/python2.5/site-packages',
>>>>>>> >> '/usr/lib/python2.5/site-packages/Numeric',
>>>>>>> >> '/usr/lib/python2.5/site-packages/PIL',
>>>>>>> >> '/usr/lib/python2.5/site-packages/gst-0.10',
>>>>>>> >> '/var/lib/python-support/python2.5',
>>>>>>> >> '/usr/lib/python2.5/site-packages/gtk-2.0',
>>>>>>> >> '/var/lib/python-support/python2.5/gtk-2.0']
>>>>>>> >>
>>>>>>> >> Traceback (most recent call last):
>>>>>>> >>  File "", line 2, in
>>>>>>> >>  File "/home/alobo/.qgis//python/plugins/manageR/__init__.py", 
>>>>>>> line 35, in
>>>>>>> >>  from manageR import manageRPlugin
>>>>>>> >>  File "/home/alobo/.qgis//python/plugins/manageR/manageR.py", 
>>>>>>> line 40, in
>>>>>>> >>  import domanageR
>>>>>>> >>  File 
>>>>>>> "/home/alobo/.qgis//python/plugins/manageR/domanageR.py", line 
>>>>>>> 39, in
>>>>>>> >>  from rpy import *
>>>>>>> >>  File "/usr/lib/python2.5/site-packages/rpy.py", line 134, in
>>>>>>> >>  """ % RVERSION)
>>>>>>> >> RuntimeError: /usr/lib/python2.5/site-packages/_rpy2070.so: 
>>>>>>> undefined
>>>>>>> >> symbol: KillAllDevices
>>>>>>> >>
>>>>>>> >>   RPy module can not be imported. Please check if your rpy
>>>>>>> >>   installation supports R 2.7.0. If you have multiple R versions
>>>>>>> >>   installed, you may need to set RHOME before importing rpy. For
>>>>>>> >>   example:
>>>>>>> >>
>>>>>>> >>   >>> from rpy_options import set_options
>>>>>>> >>   >>> set_options(RHOME='c:/progra~1/r/rw2011/')
>>>>>>> >>   >>> from rpy import *
>>>>>>> >>
>>>>>>> >> Is there anything I had to do and did not? Is there anything 
>>>>>>> to set up
>>>>>>> >> within R?
>>>>>>> >>
>>>>>>> >> Thanks!
>>>>>>> >>
>>>>>>> >> Agus
>>>>>>> >>
>>>>>>> >> --
>>>>>>> >> Dr. Agustin Lobo
>>>>>>> >> Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
>>>>>>> >> LLuis Sole Sabaris s/n
>>>>>>> >> 08028 Barcelona
>>>>>>> >> Spain
>>>>>>> >> Tel. 34 934095410
>>>>>>> >> Fax. 34 934110012
>>>>>>> >> email: Agustin.Lobo at ija.csic.es
>>>>>>> >> http://www.ija.csic.es/gt/obster
>>>>>>> >> _______________________________________________
>>>>>>> >> Qgis-user mailing list
>>>>>>> >> Qgis-user at lists.osgeo.org
>>>>>>> >> http://lists.osgeo.org/mailman/listinfo/qgis-user
>>>>>>> >>
>>>>>>>       
>>>>>> > > >     
>>>>>
>>>>> -- Dr. Agustin Lobo Institut de Ciencies de la Terra "Jaume Almera" 
>>>>> (CSIC) LLuis Sole Sabaris s/n 08028 Barcelona Spain Tel. 34 
>>>>> 934095410 Fax. 34 934110012 email: Agustin.Lobo at ija.csic.es 
>>>>> http://www.ija.csic.es/gt/obster
>>>>
>>>
>>
> 

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From cfarmer at uvic.ca  Tue May 13 23:07:03 2008
From: cfarmer at uvic.ca (Carson Farmer)
Date: Tue, 13 May 2008 14:07:03 -0700
Subject: [R-sig-Geo] Qgis-user Digest, Vol 27, Issue 13
In-Reply-To: <4829FC02.5010502@ija.csic.es>
References: <20080512160008.078D9E012A4@lists.osgeo.org>
	<48288312.3060407@uvic.ca> <48294617.3040401@gmail.com>
	<48294C95.7030502@gmail.com> <4829CF4E.8070507@uvic.ca>
	<4829FC02.5010502@ija.csic.es>
Message-ID: <482A02F7.6020402@uvic.ca>

This is certainly where I would like to see manageR go someday! But 
unfortunately this would entail programming in C, which requires someone 
much more skilled than myself!
For now I simply use it instead of jumping between the two applications...
Your suggestion about displaying sp objects was a topic of discussion 
for the QGIS bridge2R team (of which I am a member), but we ended up 
putting this aside, as we felt that the average QGIS user would rather 
have all the R stuff happen 'behind the scenes' on their input vector 
layers directly, rather than knowingly interacting with R.  I tend to 
agree with this idea for that particular project, but for manageR, 
displaying sp objects would be great! I think in the end this would 
require an ogr/gdal driver for sp objects as Barry Rowlingson has 
previously suggested here, and in the r-sig-geo lists.

I have started to look at some brushing and linking functions using the 
iPlots R package, and should hopefully be able to implement some of 
these things in the future...?

Carson


Agustin Lobo wrote:
> Thanks Carson, just knowing that this is an R console is enough.
> Now, after making a simple plot(), I'm just dreaming: if we could
> display sp objects directly, not only avoiding the intermediate
> shp file but being able of plotting columns of the dataframe
> as statistical graphics  in R...
> and soon being able to interact between the R plot and the
> geographic display (a linked brushing, for example), tools
> like in GeoDa but with a real GIS diaplay...
>
> Great job!
> (I'm forwarding the r-sig-geo list just for them
> to know your developments)
>
> Agus
>
> Carson Farmer wrote:
>> Agustin Lobo wrote:
>>> ok, just installed Rpy 1.0.3
>>> (BTW, should I have uninstalled 1.02? how?)
>>> and manageR loads
>>> on qgis 0.10 on ubuntu hardy.
>>> Carson, could you provide some directions on how to use it
>>> or point me to any file with some directions?
>> The plugin dialog can be treated like the R console itself. So 
>> whatever commands you would type into R, you can do in manageR (just 
>> make sure you use '<-' when assigning variables etc. as manageR 
>> doesn't like you to use '='). I have an updated manageR version 
>> which, in addition to making it easier to load spatial data, also 
>> makes it very easy to save R spatial objects as shapefiles and 
>> automatically load them into QGIS. This will be up on my repository 
>> soon (I will post a notice to this list when it is).
>>
>> As for directions on how to use manageR, I have not really come up 
>> with anything yet, but I will try to post something soon with a basic 
>> how to and some screen shots or something.
>>
>> Hope this is enough to get you started!
>>
>> Carson
>>> Should I have R started or should I start it from within
>>> your plugin?
>>>
>>> Thanks!
>>>
>>> Agus
>>>
>>> Agustin Lobo wrote:
>>>> Hi!
>>>>
>>>> Rpy 1.0.3 is available since today!
>>>> "The primary purpose of
>>>> this release is to provide support for R 2.7.0."
>>>> But no windows yet (not a problem in my case).
>>>> More on:
>>>> http://sourceforge.net/mailarchive/forum.php?thread_name=7C8225C0-9810-401A-857F-1B3D6EE4E5F4%40rochester.edu&forum_name=rpy-lis 
>>>>
>>>>
>>>> I'll let you know how it goes with it.
>>>>
>>>> Agus
>>>>
>>>> Carson Farmer wrote:
>>>>> Agus,
>>>>> Unfortunately, the latest R and  Rpy versions are not compatible 
>>>>> on Hardy, so the main repositories will be no help to you in this 
>>>>> regard.  However, there are two solutions (that I know of):
>>>>> 1) If you are able to, you can regress to an earlier version of R, 
>>>>> such as 2.6.0 or 2.6.2. Rpy works fine for older versions.
>>>>> 2) If you don't mind a little bit of extra work, you can follow 
>>>>> the fix posted by Diwaker Gupta (this is actually for Gutsy, but 
>>>>> it still works...) and a few posts afterwards to get Rpy working 
>>>>> with the latest R.
>>>>>
>>>>> Personally, I use R 2.6.0 and Rpy 1.0.1 (though I think 1.0.2 is 
>>>>> the most recent)
>>>>>
>>>>> Hope this helps,
>>>>>
>>>>> Carson
>>>>> a.k.a. cfarmer on IRC
>>>>>> No idea, I installed rpy for using manageR. How can I test it? 
>>>>>> Agus Sebastien Vial wrote:
>>>>>>> > Hi !
>>>>>>> > > Here it works but with R 2.6.1 (and the RPY build for R 2.6.1)
>>>>>>> > > Does your RPY works with R 2.7 ?
>>>>>>> > > Seb
>>>>>>> > > 2008/5/12 Agustin Lobo <aloboaleu at gmail.com>:
>>>>>>> >
>>>>>>>> >> Hi!
>>>>>>>> >>
>>>>>>>> >> I have a problem with loading plugin manageR.
>>>>>>>> >> I have R 2.7.0, rpy 1.0.2 , python and numpy on ubuntu hardy.
>>>>>>>> >> I get
>>>>>>>> >> the following message at starting qgis 0.10:
>>>>>>>> >>
>>>>>>>> >> Couldn't load plugin "manageR" from 
>>>>>>>> ['/home/alobo/.qgis//python/plugins',
>>>>>>>> >> '/usr/local/share/qgis/python', 
>>>>>>>> '/usr/local/share/qgis/python/plugins',
>>>>>>>> >> '/usr/lib/python25.zip', '/usr/lib/python2.5',
>>>>>>>> >> '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk',
>>>>>>>> >> '/usr/lib/python2.5/lib-dynload', 
>>>>>>>> '/usr/local/lib/python2.5/site-packages',
>>>>>>>> >> '/usr/lib/python2.5/site-packages',
>>>>>>>> >> '/usr/lib/python2.5/site-packages/Numeric',
>>>>>>>> >> '/usr/lib/python2.5/site-packages/PIL',
>>>>>>>> >> '/usr/lib/python2.5/site-packages/gst-0.10',
>>>>>>>> >> '/var/lib/python-support/python2.5',
>>>>>>>> >> '/usr/lib/python2.5/site-packages/gtk-2.0',
>>>>>>>> >> '/var/lib/python-support/python2.5/gtk-2.0']
>>>>>>>> >>
>>>>>>>> >> Traceback (most recent call last):
>>>>>>>> >>  File "", line 2, in
>>>>>>>> >>  File 
>>>>>>>> "/home/alobo/.qgis//python/plugins/manageR/__init__.py", line 
>>>>>>>> 35, in
>>>>>>>> >>  from manageR import manageRPlugin
>>>>>>>> >>  File 
>>>>>>>> "/home/alobo/.qgis//python/plugins/manageR/manageR.py", line 
>>>>>>>> 40, in
>>>>>>>> >>  import domanageR
>>>>>>>> >>  File 
>>>>>>>> "/home/alobo/.qgis//python/plugins/manageR/domanageR.py", line 
>>>>>>>> 39, in
>>>>>>>> >>  from rpy import *
>>>>>>>> >>  File "/usr/lib/python2.5/site-packages/rpy.py", line 134, in
>>>>>>>> >>  """ % RVERSION)
>>>>>>>> >> RuntimeError: /usr/lib/python2.5/site-packages/_rpy2070.so: 
>>>>>>>> undefined
>>>>>>>> >> symbol: KillAllDevices
>>>>>>>> >>
>>>>>>>> >>   RPy module can not be imported. Please check if your rpy
>>>>>>>> >>   installation supports R 2.7.0. If you have multiple R 
>>>>>>>> versions
>>>>>>>> >>   installed, you may need to set RHOME before importing rpy. 
>>>>>>>> For
>>>>>>>> >>   example:
>>>>>>>> >>
>>>>>>>> >>   >>> from rpy_options import set_options
>>>>>>>> >>   >>> set_options(RHOME='c:/progra~1/r/rw2011/')
>>>>>>>> >>   >>> from rpy import *
>>>>>>>> >>
>>>>>>>> >> Is there anything I had to do and did not? Is there anything 
>>>>>>>> to set up
>>>>>>>> >> within R?
>>>>>>>> >>
>>>>>>>> >> Thanks!
>>>>>>>> >>
>>>>>>>> >> Agus
>>>>>>>> >>
>>>>>>>> >> --
>>>>>>>> >> Dr. Agustin Lobo
>>>>>>>> >> Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
>>>>>>>> >> LLuis Sole Sabaris s/n
>>>>>>>> >> 08028 Barcelona
>>>>>>>> >> Spain
>>>>>>>> >> Tel. 34 934095410
>>>>>>>> >> Fax. 34 934110012
>>>>>>>> >> email: Agustin.Lobo at ija.csic.es
>>>>>>>> >> http://www.ija.csic.es/gt/obster
>>>>>>>> >> _______________________________________________
>>>>>>>> >> Qgis-user mailing list
>>>>>>>> >> Qgis-user at lists.osgeo.org
>>>>>>>> >> http://lists.osgeo.org/mailman/listinfo/qgis-user
>>>>>>>> >>
>>>>>>>>       
>>>>>>> > > >     
>>>>>>
>>>>>> -- Dr. Agustin Lobo Institut de Ciencies de la Terra "Jaume 
>>>>>> Almera" (CSIC) LLuis Sole Sabaris s/n 08028 Barcelona Spain Tel. 
>>>>>> 34 934095410 Fax. 34 934110012 email: Agustin.Lobo at ija.csic.es 
>>>>>> http://www.ija.csic.es/gt/obster
>>>>>
>>>>
>>>
>>
>



From b.rowlingson at lancaster.ac.uk  Tue May 13 23:19:07 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 May 2008 22:19:07 +0100
Subject: [R-sig-Geo] Qgis-user Digest, Vol 27, Issue 13
In-Reply-To: <482A02F7.6020402@uvic.ca>
References: <20080512160008.078D9E012A4@lists.osgeo.org>	<48288312.3060407@uvic.ca>
	<48294617.3040401@gmail.com>	<48294C95.7030502@gmail.com>
	<4829CF4E.8070507@uvic.ca>	<4829FC02.5010502@ija.csic.es>
	<482A02F7.6020402@uvic.ca>
Message-ID: <482A05CB.6050403@lancaster.ac.uk>

Carson Farmer wrote:
> I think in the end this would 
> require an ogr/gdal driver for sp objects as Barry Rowlingson has 
> previously suggested here, and in the r-sig-geo lists.

  Progress on this has been minimal: I managed to create an ogr driver 
with a new name! There's a few places that you need to edit to link in 
the new driver in the ogr build system. Then I started to worry about 
how to link in to libR.so and stopped there. I need to find out how the 
OGR build system works with other library dependencies, and that 
probably means understanding autoconf... Beyond me at the moment...

> I have started to look at some brushing and linking functions using the 
> iPlots R package, and should hopefully be able to implement some of 
> these things in the future...?

  Isn't the ultimate in linking and brushing GGobi? There's a link from 
R to GGobi for displaying R data in GGobi. What might be nice would be a 
GGobi plugin for Qgis - set up so that brushed items in the GGobi view 
are highlighted in the Qgis map.

  I've looked at the C code in the R-GGobi interface and it looks very 
difficult....

Barry



From Agustin.Lobo at ija.csic.es  Wed May 14 08:14:56 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Wed, 14 May 2008 08:14:56 +0200
Subject: [R-sig-Geo] Qgis-Rmanage and geographic display of spatial
	objects
In-Reply-To: <482A02F7.6020402@uvic.ca>
References: <20080512160008.078D9E012A4@lists.osgeo.org>
	<48288312.3060407@uvic.ca> <48294617.3040401@gmail.com>
	<48294C95.7030502@gmail.com> <4829CF4E.8070507@uvic.ca>
	<4829FC02.5010502@ija.csic.es> <482A02F7.6020402@uvic.ca>
Message-ID: <482A8360.5000606@ija.csic.es>

Carson Farmer wrote:
> This is certainly where I would like to see manageR go someday! But 
> unfortunately this would entail programming in C, which requires someone 
> much more skilled than myself!
> For now I simply use it instead of jumping between the two applications...
> Your suggestion about displaying sp objects was a topic of discussion 
> for the QGIS bridge2R team (of which I am a member), but we ended up 
> putting this aside, as we felt that the average QGIS user would rather 
> have all the R stuff happen 'behind the scenes' on their input vector 
> layers directly, rather than knowingly interacting with R.  

I cannot but disagree here. "QGIS user have all the R stuff happen 
'behind the scenes'" because they cannot have it on the scenario. I strongly
recommend having a look to GeoDa to feel the power of interactive
exploratory geographic data analysis. It is a fundamental step for 
thinking and generating hypothesis that are formally tested afterwards
and then interactively displayed again. Unfortunately, GeoDa does not
have a real geographic display, as would be the case of QGis, and does
not have the amazing flexibility of R. I note
that GeoDa is becoming OS at some point,  and could be an excellent 
source of inspiration.

Also, note how powerful would be applying R syntaxis to the data tables 
associated to vector data. This is very easy with the "data slot" of R
SpatialDataFrame objects, but there is always the annoying step of going
through the shp export to display in QGIS (although I think that your
Rmanage makes easier the step).


> I tend to 
> agree with this idea for that particular project, but for manageR, 
> displaying sp objects would be great! 

Yes!

I think in the end this would
> require an ogr/gdal driver for sp objects as Barry Rowlingson has 
> previously suggested here, and in the r-sig-geo lists.
> 
> I have started to look at some brushing and linking functions using the 
> iPlots R package, and should hopefully be able to implement some of 
> these things in the future...?

Actually, perhaps we could make people from Rosuda get interested on
developing an "igeoplots" package!

Agus

> Carson
> 
> 
> Agustin Lobo wrote:
>> Thanks Carson, just knowing that this is an R console is enough.
>> Now, after making a simple plot(), I'm just dreaming: if we could
>> display sp objects directly, not only avoiding the intermediate
>> shp file but being able of plotting columns of the dataframe
>> as statistical graphics  in R...
>> and soon being able to interact between the R plot and the
>> geographic display (a linked brushing, for example), tools
>> like in GeoDa but with a real GIS diaplay...
>>
>> Great job!
>> (I'm forwarding the r-sig-geo list just for them
>> to know your developments)
>>
>> Agus
-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From Agustin.Lobo at ija.csic.es  Wed May 14 08:16:00 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Wed, 14 May 2008 07:16:00 +0100
Subject: [R-sig-Geo] [Openspace] Re: Qgis-Rmanage and geographic display of
	spatialobjects
In-Reply-To: <482A02F7.6020402@uvic.ca>
References: <20080512160008.078D9E012A4@lists.osgeo.org><48288312.3060407@uvic.ca>
	<48294617.3040401@gmail.com><48294C95.7030502@gmail.com>
	<4829CF4E.8070507@uvic.ca><4829FC02.5010502@ija.csic.es>
	<482A02F7.6020402@uvic.ca>
Message-ID: <000301c8b589$fab0b1d0$0210a8c0@Geofutures.local>

Carson Farmer wrote:
> This is certainly where I would like to see manageR go someday! But 
> unfortunately this would entail programming in C, which requires someone 
> much more skilled than myself!
> For now I simply use it instead of jumping between the two applications...
> Your suggestion about displaying sp objects was a topic of discussion 
> for the QGIS bridge2R team (of which I am a member), but we ended up 
> putting this aside, as we felt that the average QGIS user would rather 
> have all the R stuff happen 'behind the scenes' on their input vector 
> layers directly, rather than knowingly interacting with R.  

I cannot but disagree here. "QGIS user have all the R stuff happen 
'behind the scenes'" because they cannot have it on the scenario. I strongly
recommend having a look to GeoDa to feel the power of interactive
exploratory geographic data analysis. It is a fundamental step for 
thinking and generating hypothesis that are formally tested afterwards
and then interactively displayed again. Unfortunately, GeoDa does not
have a real geographic display, as would be the case of QGis, and does
not have the amazing flexibility of R. I note
that GeoDa is becoming OS at some point,  and could be an excellent 
source of inspiration.

Also, note how powerful would be applying R syntaxis to the data tables 
associated to vector data. This is very easy with the "data slot" of R
SpatialDataFrame objects, but there is always the annoying step of going
through the shp export to display in QGIS (although I think that your
Rmanage makes easier the step).


> I tend to 
> agree with this idea for that particular project, but for manageR, 
> displaying sp objects would be great! 

Yes!

I think in the end this would
> require an ogr/gdal driver for sp objects as Barry Rowlingson has 
> previously suggested here, and in the r-sig-geo lists.
> 
> I have started to look at some brushing and linking functions using the 
> iPlots R package, and should hopefully be able to implement some of 
> these things in the future...?

Actually, perhaps we could make people from Rosuda get interested on
developing an "igeoplots" package!

Agus

> Carson
> 
> 
> Agustin Lobo wrote:
>> Thanks Carson, just knowing that this is an R console is enough.
>> Now, after making a simple plot(), I'm just dreaming: if we could
>> display sp objects directly, not only avoiding the intermediate
>> shp file but being able of plotting columns of the dataframe
>> as statistical graphics  in R...
>> and soon being able to interact between the R plot and the
>> geographic display (a linked brushing, for example), tools
>> like in GeoDa but with a real GIS diaplay...
>>
>> Great job!
>> (I'm forwarding the r-sig-geo list just for them
>> to know your developments)
>>
>> Agus
-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster
_______________________________________________
Openspace mailing list
Openspace at sal.uiuc.edu
http://sal.uiuc.edu/mailman/listinfo/openspace



From infohunter at gmail.com  Wed May 14 08:43:16 2008
From: infohunter at gmail.com (Harry Kim)
Date: Tue, 13 May 2008 23:43:16 -0700
Subject: [R-sig-Geo] projecting Lat and Long to 2D
Message-ID: <91b8161f0805132343o6e30d39fh37feed92e1a93c05@mail.gmail.com>

Dear R-sig-Geo listers,

     These are very newbie like questions but if i could get any kind of
help, i would very much appreciate it.

     I am trying to project points encoded in latitude and longitude to
hopefully Cartesian coordinates with a reasonable unit of distance
(meters or kilometers.) When i encountered this problem previously,
i've used PBSmapping package and convUL() to convert the points to
UTM coordinates.
     However, the points that i wish to project now are all over eurasia
and Africa. I feel that if i just naively convert all the points to
UTM, then i will run into a trouble as the points have different UTM
zones. Is this correct? If i have some points in zone 10 and zone 14,
and wish to find the distance between them using UTM coordiates and
euclidean norm, would it provide a reasonable approximation of their
distance? If not, is there a projection you would recommend that will
give me a reasonable results?

     I would also like to overlay the points with a world map excluding
America and Antartica. I know that i can plot the map of the world
using maps package and map("world",regions="") but i don't know how i
would exclude the two continents.

     I tried to export the world map into a shapefile then read it in to R
using readShapPoly() in maptools package, then change the coordinate
system into UTM using spTransform, but this ended up giving me a very
weird looking figure.

     In sum, i would like to know if there is a good way to project these
points and overlay a map such that i can use euclidean norm to find
the distance, and the map won't look completely bizzare. Also i would
like to know if i could exclude the two continents mentioned: the
America and the Antarctica.

I thank you very much in advance and i hope you are having a pleasant day.

Harry



From aloboaleu at gmail.com  Wed May 14 09:02:34 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Wed, 14 May 2008 09:02:34 +0200
Subject: [R-sig-Geo] projecting Lat and Long to 2D
In-Reply-To: <91b8161f0805132343o6e30d39fh37feed92e1a93c05@mail.gmail.com>
References: <91b8161f0805132343o6e30d39fh37feed92e1a93c05@mail.gmail.com>
Message-ID: <482A8E8A.3020901@gmail.com>

If your sites are more or less all over the world,
why do you want to project? The Earth is not flat.
If this is just for cartographic display,
you can use goode homolosine for example
(http://en.wikipedia.org/wiki/Goode_homolosine_projection). But for
calculating distances, the most reasonable is
using geodesic distance.

Agus

Harry Kim wrote:
> Dear R-sig-Geo listers,
> 
>      These are very newbie like questions but if i could get any kind of
> help, i would very much appreciate it.
> 
>      I am trying to project points encoded in latitude and longitude to
> hopefully Cartesian coordinates with a reasonable unit of distance
> (meters or kilometers.) When i encountered this problem previously,
> i've used PBSmapping package and convUL() to convert the points to
> UTM coordinates.
>      However, the points that i wish to project now are all over eurasia
> and Africa. I feel that if i just naively convert all the points to
> UTM, then i will run into a trouble as the points have different UTM
> zones. Is this correct? If i have some points in zone 10 and zone 14,
> and wish to find the distance between them using UTM coordiates and
> euclidean norm, would it provide a reasonable approximation of their
> distance? If not, is there a projection you would recommend that will
> give me a reasonable results?
> 
>      I would also like to overlay the points with a world map excluding
> America and Antartica. I know that i can plot the map of the world
> using maps package and map("world",regions="") but i don't know how i
> would exclude the two continents.
> 
>      I tried to export the world map into a shapefile then read it in to R
> using readShapPoly() in maptools package, then change the coordinate
> system into UTM using spTransform, but this ended up giving me a very
> weird looking figure.
> 
>      In sum, i would like to know if there is a good way to project these
> points and overlay a map such that i can use euclidean norm to find
> the distance, and the map won't look completely bizzare. Also i would
> like to know if i could exclude the two continents mentioned: the
> America and the Antarctica.
> 
> I thank you very much in advance and i hope you are having a pleasant day.
> 
> Harry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From cfarmer at uvic.ca  Wed May 14 09:09:56 2008
From: cfarmer at uvic.ca (cfarmer)
Date: Wed, 14 May 2008 00:09:56 -0700 (PDT)
Subject: [R-sig-Geo] manageR update
Message-ID: <48820.142.104.193.193.1210748996.squirrel@wm3.uvic.ca>

Hello lists,

For those of you who are interested, a new version of manageR is now
available at http://www.geog.uvic.ca/spar/carson/ or via
http://www.geog.uvic.ca/spar/carson/cfarmerQgisRepo.xml from the QGIS
python plugin installer.

This latest release includes a few big fixes, the ability (hopefully?!) to
check all libPaths for installed packages, and the ability to
automatically write sp objects to file and load them in QGIS. This was a
pretty quick update, so please feel free to push the plugin to the limits,
and let me know what the outcome is...

Cheers,

Carson

Spatial Pattern Analysis & Research Lab (SPAR)
Department of Geography, University of Victoria
www.geog.uvic.ca/spar/carson
cfarmer at uvic.ca



From cfarmer at uvic.ca  Wed May 14 18:14:50 2008
From: cfarmer at uvic.ca (Carson Farmer)
Date: Wed, 14 May 2008 09:14:50 -0700
Subject: [R-sig-Geo] Qgis-Rmanage and geographic display of spatial
	objects
In-Reply-To: <482A8360.5000606@ija.csic.es>
References: <20080512160008.078D9E012A4@lists.osgeo.org>
	<48288312.3060407@uvic.ca> <48294617.3040401@gmail.com>
	<48294C95.7030502@gmail.com> <4829CF4E.8070507@uvic.ca>
	<4829FC02.5010502@ija.csic.es> <482A02F7.6020402@uvic.ca>
	<482A8360.5000606@ija.csic.es>
Message-ID: <482B0FFA.2080400@uvic.ca>

Agustin Lobo wrote:
> Carson Farmer wrote:
>> This is certainly where I would like to see manageR go someday! But 
>> unfortunately this would entail programming in C, which requires 
>> someone much more skilled than myself!
>> For now I simply use it instead of jumping between the two 
>> applications...
>> Your suggestion about displaying sp objects was a topic of discussion 
>> for the QGIS bridge2R team (of which I am a member), but we ended up 
>> putting this aside, as we felt that the average QGIS user would 
>> rather have all the R stuff happen 'behind the scenes' on their input 
>> vector layers directly, rather than knowingly interacting with R.  
>
> I cannot but disagree here. "QGIS user have all the R stuff happen 
> 'behind the scenes'" because they cannot have it on the scenario. I 
> strongly
> recommend having a look to GeoDa to feel the power of interactive
> exploratory geographic data analysis. It is a fundamental step for 
> thinking and generating hypothesis that are formally tested afterwards
> and then interactively displayed again. Unfortunately, GeoDa does not
> have a real geographic display, as would be the case of QGis, and does
> not have the amazing flexibility of R. I note
> that GeoDa is becoming OS at some point,  and could be an excellent 
> source of inspiration.
Reading over my last post, I can see that I wasn't clear on this point.
What I meant to say was: Brushing and Linking is good, and would be very 
nice to have (and in fact I do have a graphing plugin that does this in 
the works as I write), but we are talking about two separate things here:
1) The bridge2R project; the primary goal here (I think, other people 
can correct me here) is to provide a user-friendly means of doing 
statistical analysis in QGIS. The fact that we are using R is simply 
secondary (though the flexibility and extensibility of R means that we 
can continue to add functionality to QGIS long into the future), and 
thus this project should provide statistical operations to non-R-users 
and R-users alike. This means that brushing and linking can be 
incorporated into these operations, but the user shouldn't know that 
it's R and Rpy doing all the work.
2) The second point is something like manageR, or some other direct link 
between R and QGIS.  I imagine this as something of interest to more 
advanced R-users, who want to be able to knowingly work in R, and 
interact with QGIS at the same time. This is what I am most interested 
in, and am looking for ways to make manageR closer to this type of tool. 
This could also support brushing and linking eventually...?
>
> Also, note how powerful would be applying R syntaxis to the data 
> tables associated to vector data. This is very easy with the "data 
> slot" of R
> SpatialDataFrame objects, but there is always the annoying step of going
> through the shp export to display in QGIS (although I think that your
> Rmanage makes easier the step).
and hopefully I made this even easier with my latest update.

> Actually, perhaps we could make people from Rosuda get interested on
> developing an "igeoplots" package!
Their website indicates that there will be interactive mapping abilities 
(based on maptools) soon-ish...

Carson



From jonthayn at ku.edu  Thu May 15 06:15:12 2008
From: jonthayn at ku.edu (Jonathan B Thayn)
Date: Wed, 14 May 2008 23:15:12 -0500
Subject: [R-sig-Geo] installing rgdal on a Mac OS 10.5
Message-ID: <6212537.1210824912560.JavaMail.uportal@ptlprd2.cc.ku.edu>

This is a question for all you Mac computer users.  I am trying to install the rgdal package on my computer, an Intel MacBook OS 10.5.  I have installed all of the frameworks and the proj4 and the sp packages.  I used the Local Binary Package on the R Package Installer to install rgdal_0.5-24.tgz that I downloaded from www.kyngchaos.com.  The rgdal package appears in my R Package Manager, but the following errors appear when I try to load the rgdal package.  Any help would be greatly appreciated.  Hopefully, it's an easy problem to fix. Thanks.

Loading required package: sp
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared library '/Library/Frameworks/R.framework/Resources/library/rgdal/libs/i386/rgdal.so':
  dlopen(/Library/Frameworks/R.framework/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /Library/Frameworks/R.framework/Versions/2.6/Resources/lib/libR.dylib
  Referenced from: /Library/Frameworks/R.framework/Resources/library/rgdal/libs/i386/rgdal.so
  Reason: image not found
Error: package/namespace load failed for 'rgdal'



From cengel at stanford.edu  Thu May 15 07:58:58 2008
From: cengel at stanford.edu (Claudia A Engel)
Date: Wed, 14 May 2008 22:58:58 -0700
Subject: [R-sig-Geo] installing rgdal on a Mac OS 10.5
In-Reply-To: <6212537.1210824912560.JavaMail.uportal@ptlprd2.cc.ku.edu>
References: <6212537.1210824912560.JavaMail.uportal@ptlprd2.cc.ku.edu>
Message-ID: <F0A82CEE-A784-4BF4-B1FF-1CA113C36ADA@stanford.edu>

Jonathan,

not sure ..   the library looks for version 2.6, but you *may* have a  
different R version installed ??
If so, I very inelegantly fixed that once by actually editing the  
path in rgdal.so.

Claudia
_________________________
Claudia A Engel
Department of Anthropology


On May 14, 2008, at 9:15 PM, Jonathan B Thayn wrote:
> This is a question for all you Mac computer users.  I am trying to  
> install the rgdal package on my computer, an Intel MacBook OS  
> 10.5.  I have installed all of the frameworks and the proj4 and the  
> sp packages.  I used the Local Binary Package on the R Package  
> Installer to install rgdal_0.5-24.tgz that I downloaded from  
> www.kyngchaos.com.  The rgdal package appears in my R Package  
> Manager, but the following errors appear when I try to load the  
> rgdal package.  Any help would be greatly appreciated.  Hopefully,  
> it's an easy problem to fix. Thanks.
>
> Loading required package: sp
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>   unable to load shared library '/Library/Frameworks/R.framework/ 
> Resources/library/rgdal/libs/i386/rgdal.so':
>   dlopen(/Library/Frameworks/R.framework/Resources/library/rgdal/ 
> libs/i386/rgdal.so, 6): Library not loaded: /Library/Frameworks/ 
> R.framework/Versions/2.6/Resources/lib/libR.dylib
>   Referenced from: /Library/Frameworks/R.framework/Resources/ 
> library/rgdal/libs/i386/rgdal.so
>   Reason: image not found
> Error: package/namespace load failed for 'rgdal'
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From hengl at science.uva.nl  Thu May 15 09:58:42 2008
From: hengl at science.uva.nl (Tomislav Hengl)
Date: Thu, 15 May 2008 09:58:42 +0200 (CEST)
Subject: [R-sig-Geo] Calculation of geographical slope
In-Reply-To: <Pine.LNX.4.64.0805091638030.5741@reclus.nhh.no>
References: <A2C6E53287774840B0A2CEF5AED14DD50166F60A@alm.nina.no>
	<Pine.LNX.4.64.0805091638030.5741@reclus.nhh.no>
Message-ID: <37816.160.45.63.17.1210838322.squirrel@webmail.science.uva.nl>


If you are windows user you might also consider using RSAGA with probably
has much richer geomorphometric analysis possibilities than GRASS.

https://stat.ethz.ch/pipermail/r-sig-geo/2008-January/003078.html

> On Wed, 7 May 2008, May, Roel wrote:
>
>> Hi all,
>>
>> Does anyone know if there exists a function in R that can calculate
>> geographical slope and aspect (i.e. like elevational slope/aspect) on
>> grid values?
>
> I'd suggest pushing the DEM out to GRASS, and using the module there. It
> could be done by creating new columns in a SpatialGridDataFrame for the
> eight neighbours and just doing the math - Zevenbergen and Thorne (1987)
> algorithm (for a reasonable sized DEM), but we don't have a function for
> grid shifting yet, contributions welcome!
>
> Roger
>
>> I've looked around on the R-sites but could not find anything on this.
>> I hope can help a simple soul...
>>
>> Cheers, Roel
>>
>> Roel May
>> Norwegian Institute for Nature Research
>> Tungasletta 2, NO-7089 Trondheim
>> Norway
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From CHURCHER at DAL.CA  Thu May 15 15:55:24 2008
From: CHURCHER at DAL.CA (Sylvia Churcher)
Date: Thu, 15 May 2008 10:55:24 -0300
Subject: [R-sig-Geo] lat/long conversions to easting/northing
Message-ID: <20080515105524.q1n35s58yr6jkksk@my1.dal.ca>

Hello all,

I have a set of sample sites described in latitude and longitude and I'd like to
convert them to easting and northing for use in the kriging technique.

I'm a little surprised that I need to do this conversion...is there perhaps
another R package that works with lat and long coordinates in spatial analysis?

Any help with either question is much appreciated!

Many thanks,

S. Churcher



From Roger.Bivand at nhh.no  Thu May 15 16:08:32 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 May 2008 16:08:32 +0200 (CEST)
Subject: [R-sig-Geo] lat/long conversions to easting/northing
In-Reply-To: <20080515105524.q1n35s58yr6jkksk@my1.dal.ca>
References: <20080515105524.q1n35s58yr6jkksk@my1.dal.ca>
Message-ID: <Pine.LNX.4.64.0805151600550.17259@reclus.nhh.no>

On Thu, 15 May 2008, Sylvia Churcher wrote:

> Hello all,
>
> I have a set of sample sites described in latitude and longitude and I'd 
> like to convert them to easting and northing for use in the kriging 
> technique.
>
> I'm a little surprised that I need to do this conversion...is there 
> perhaps another R package that works with lat and long coordinates in 
> spatial analysis?

Both fields (Krig) and gstat (gstat and predict.gstat) include 
possibilities for interpolating using geographical coordinates. However, 
unless your study area is truly continental, you may well do better to 
project to the plane (see spTransform methods in the rgdal package).

If you are near a break in geographical coordinates (-/+180 degrees or 
0/360 degrees), you may find that great circle distances break down. I've 
found - for example, that Polar Stereographic seems to do better for the 
Arctic than trying to use geographical coordinates. Including trends also 
becomes a problem, by the way.

Roger

>
> Any help with either question is much appreciated!
>
> Many thanks,
>
> S. Churcher
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From nikko at hailmail.net  Thu May 15 22:07:39 2008
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Thu, 15 May 2008 13:07:39 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 57, Issue 12
In-Reply-To: <mailman.7.1210759202.21497.r-sig-geo@stat.math.ethz.ch>
References: <mailman.7.1210759202.21497.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1210882059.18919.1253395011@webmail.messagingengine.com>

Hi,
It would be difficult but not impossible to bring ggobi to
play here. The biggest issue is, as always, which
event loop is in control, R, GTK, QGIS?
Managing so many layers can be daunting and slow.
There was some discussion on the ggobi list about embedding
ggobi in manifold, which is a commercial package and windows only, and,
...
IT would be really nice to get a spatial eda application that
incorporates
spatial attributes. Some of the old ArcView-xgobi link code has been
ported into
ggobi as the variogram cloud plugin. I know there is (or was) interest
among
the ggobi developers in getting a spatial application working to allow
brushing
of maps in a linked environment. Anyway I am rambling.

Hope this helps

Nicholas




> Date: Tue, 13 May 2008 22:19:07 +0100
> From: Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
> Subject: Re: [R-sig-Geo] Qgis-user Digest, Vol 27, Issue 13
> To: Carson Farmer <cfarmer at uvic.ca>
> Cc: qgis-user at lists.osgeo.org, r-sig-geo at stat.math.ethz.ch
> Message-ID: <482A05CB.6050403 at lancaster.ac.uk>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Carson Farmer wrote:
> > I think in the end this would 
> > require an ogr/gdal driver for sp objects as Barry Rowlingson has 
> > previously suggested here, and in the r-sig-geo lists.
> 
>   Progress on this has been minimal: I managed to create an ogr driver 
> with a new name! There's a few places that you need to edit to link in 
> the new driver in the ogr build system. Then I started to worry about 
> how to link in to libR.so and stopped there. I need to find out how the 
> OGR build system works with other library dependencies, and that 
> probably means understanding autoconf... Beyond me at the moment...
> 
> > I have started to look at some brushing and linking functions using the 
> > iPlots R package, and should hopefully be able to implement some of 
> > these things in the future...?
> 
>   Isn't the ultimate in linking and brushing GGobi? There's a link from 
> R to GGobi for displaying R data in GGobi. What might be nice would be a 
> GGobi plugin for Qgis - set up so that brushed items in the GGobi view 
> are highlighted in the Qgis map.
> 
>   I've looked at the C code in the R-GGobi interface and it looks very 
> difficult....
> 
> Barry
> 
> 
>



From michal.palenik at iz.sk  Mon May 19 10:17:47 2008
From: michal.palenik at iz.sk (Michal Palenik)
Date: Mon, 19 May 2008 10:17:47 +0200
Subject: [R-sig-Geo] distance matrix to listw
Message-ID: <200805191017.48368.michal.palenik@iz.sk>

dear list,

I want to do analysis using lagsarlm function, however I am stuck on 
listw object. I have distances among spatial points in a mysql table in 
form:
point1_id | point2_id | distance (in km)

dataset in also in mysql table in form:
point_id | year | variable1 | variable2 | ....

so my questions:
1. how to I create a listw object from above mysql table ?

2. if i create data frame with command 
data<-dbGetQuery(con, "select * from data");
is it enough or some special actions need to be taken to connect data 
frame to listw object (eg so that lagsarlm knows which spatial point in 
data is which point in listw) ?


thanks in advance

michal palenik


-- 
michal palenik
institut zamestnanosti
michal.palenik at iz.sk



From Roger.Bivand at nhh.no  Mon May 19 10:59:38 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 May 2008 10:59:38 +0200 (CEST)
Subject: [R-sig-Geo] distance matrix to listw
In-Reply-To: <200805191017.48368.michal.palenik@iz.sk>
References: <200805191017.48368.michal.palenik@iz.sk>
Message-ID: <Pine.LNX.4.64.0805191040450.22217@reclus.nhh.no>

On Mon, 19 May 2008, Michal Palenik wrote:

> dear list,
>
> I want to do analysis using lagsarlm function, however I am stuck on
> listw object. I have distances among spatial points in a mysql table in
> form:
> point1_id | point2_id | distance (in km)
>
> dataset in also in mysql table in form:
> point_id | year | variable1 | variable2 | ....
>
> so my questions:
> 1. how to I create a listw object from above mysql table ?

The easiest way is to do it in R, provided that the coordinates of the 
observations are stored in the same table as the data - then there is less 
danger of the IDs getting mixed up. Then you'd ceate first an nb object 
using your choice of method, adding in the (distances) in the glist= 
argument to nb2listw() - examples are given there.

>
> 2. if i create data frame with command
> data<-dbGetQuery(con, "select * from data");
> is it enough or some special actions need to be taken to connect data
> frame to listw object (eg so that lagsarlm knows which spatial point in
> data is which point in listw) ?
>
>

If you want to use the external table of distances (because say they are 
network distances), you can read them in as a data frame, or possibly 
write then to a text file in GWT format. If the latter, see the GeoDa site 
or read.gwt2nb() for details of the format, using the point_ID values from 
the data frame with the variables as the region.id= argument. If your 
three field table is already thresholded, this might be a good way to go 
(say distance < threshold). Note that read.gwt2nb() returns an nb oject, 
with the distances as part of the "GeoDa" attribute:

nb <- read.gwt2nb("your_three_columns", region.id=df$point_id)
dlist <- attr(nb, "GeoDa")$dist

then use nb2listw() to make the listw object (with for example the inverse 
of dlist as the glist= argument).

If you prefer to read in the data frame, convert the data frame to a 
"spatial.neighbour" object, and get back to listw with sn2listw(). This is 
untried and may not work unless point_id is a 1:n sequence, because the 
"spatial.neighbour" object expects that. Use the example to sn2listw() to 
see what happens.

Hope this helps,

Roger

> thanks in advance
>
> michal palenik
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mgallay01 at qub.ac.uk  Mon May 19 10:58:21 2008
From: mgallay01 at qub.ac.uk (Michal Gallay)
Date: 19 May 2008 09:58:21 +0100
Subject: [R-sig-Geo] memory problems with GWR tests
Message-ID: <Prayer.1.0.12.0805190958210.5272@localhost.localdomain>

Dear R-Experts,

there is an error message regarding allocation of memory coming up after 
attempting to run GWR with hatmatrix=TRUE (there is no problem when this is 
set to FALSE).

I would like to test GWR outputs using e.g. LMZ.F2GWR.test(x)or 
BFC99.gwr.test(x).

> resid.Gauss <- gwr(regress.formula, data=resid, gweight=gwr.Gauss, 
> bandwidth=10, hatmatrix=TRUE))

Error: cannot allocate vector of size 505.4 Mb


Why it cannot allocate 505 MB if there is 2 GB RAM on my laptop?
Running R from WinXP command prompt:
Rgui --max-mem-size=1800Mb
The memory problem persists.

I read the instructions regarding the memory.limit(), Memory(), as well as 
the R help.I could decimate the number of points involved in GWR but that 
would be a test on a different scale, wouldn't it? The datasets comprise 8 
000 - 1 000 000 points. A Monte Carlo simultation would require too much 
time.

I would like to know if there would be any way around the memory problem to 
test a GWR object.

I much appreciate any advice.

Michal

PS: There is some other information about the session:

My seesion info:

 sessionInfo()
R version 2.6.2 (2008-02-08) 
i386-pc-mingw32 

locale: 
LC_COLLATE=Slovak_Slovakia.1250;LC_CTYPE=Slovak_Slovakia.1250;LC_MONETARY=Slovak_Slovakia.1250;LC_NUMERIC=C;LC_TIME=Slovak_Slovakia.1250

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages: [1] lattice_0.17-6 spgwr_0.5-1 maptools_0.6-5 
foreign_0.8-23 sp_0.9-23

loaded via a namespace (and not attached):
[1] grid_2.6.2 

> gc()
         used (Mb) gc trigger  (Mb)  max used  (Mb)
Ncells 269045  7.2     531268  14.2    531268  14.2
Vcells 413865  3.2   84325970 643.4 105241855 803.0
> memory.profile()
       NULL      symbol    pairlist     closure environment     promise 
          1        6876      143458        3669         825        5271 
   language     special     builtin        char     logical     integer 
      37538         151        1464       16489        4324        5293 
     double     complex   character         ...         any        list 
       2446           1       36010           0           0        3262 
 expression    bytecode externalptr     weakref         raw 
          1           0         665         177           1 
> 

-- 
Michal Gallay

Postgraduate Research Student
School of Geography, Archaeology and Palaeoecology
Queen's University
Belfast BT7 1NN
Northern Ireland

Tel: +44(0)2890 273929
Fax: +44(0)2890 973212
email: mgallay01 at qub.ac.uk
www: www.qub.ac.uk/geog



From Roger.Bivand at nhh.no  Mon May 19 11:46:33 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 May 2008 11:46:33 +0200 (CEST)
Subject: [R-sig-Geo] memory problems with GWR tests
In-Reply-To: <Prayer.1.0.12.0805190958210.5272@localhost.localdomain>
References: <Prayer.1.0.12.0805190958210.5272@localhost.localdomain>
Message-ID: <Pine.LNX.4.64.0805191143110.22730@reclus.nhh.no>

On Mon, 19 May 2008, Michal Gallay wrote:

> Dear R-Experts,
>
> there is an error message regarding allocation of memory coming up after 
> attempting to run GWR with hatmatrix=TRUE (there is no problem when this is 
> set to FALSE).
>
> I would like to test GWR outputs using e.g. LMZ.F2GWR.test(x)or 
> BFC99.gwr.test(x).
>
>>  resid.Gauss <- gwr(regress.formula, data=resid, gweight=gwr.Gauss,
>>  bandwidth=10, hatmatrix=TRUE))
>
> Error: cannot allocate vector of size 505.4 Mb
>
>
> Why it cannot allocate 505 MB if there is 2 GB RAM on my laptop?
> Running R from WinXP command prompt:
> Rgui --max-mem-size=1800Mb
> The memory problem persists.
>
> I read the instructions regarding the memory.limit(), Memory(), as well as 
> the R help.I could decimate the number of points involved in GWR but that 
> would be a test on a different scale, wouldn't it? The datasets comprise 8 
> 000 - 1 000 000 points. A Monte Carlo simultation would require too much 
> time.
>
> I would like to know if there would be any way around the memory problem to 
> test a GWR object.

Absolutely no way round at all, the hat matrix must be n x n (and you need 
several copies typically). In addition, the tests only have meaning if the 
assumptions they require are met, which under non-stationarity they 
typically are not. So if you need to test, choose several subsets of 
observations, and see if the test results correspond.

Hope this helps,

Roger

>
> I much appreciate any advice.
>
> Michal
>
> PS: There is some other information about the session:
>
> My seesion info:
>
> sessionInfo()
> R version 2.6.2 (2008-02-08) i386-pc-mingw32 
> locale: 
> LC_COLLATE=Slovak_Slovakia.1250;LC_CTYPE=Slovak_Slovakia.1250;LC_MONETARY=Slovak_Slovakia.1250;LC_NUMERIC=C;LC_TIME=Slovak_Slovakia.1250
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base 
> other attached packages: [1] lattice_0.17-6 spgwr_0.5-1 maptools_0.6-5 
> foreign_0.8-23 sp_0.9-23
>
> loaded via a namespace (and not attached):
> [1] grid_2.6.2
>>  gc()
>        used (Mb) gc trigger  (Mb)  max used  (Mb)
> Ncells 269045  7.2     531268  14.2    531268  14.2
> Vcells 413865  3.2   84325970 643.4 105241855 803.0
>>  memory.profile()
>       NULL      symbol    pairlist     closure environment     promise
>          1        6876      143458        3669         825        5271
>   language     special     builtin        char     logical     integer
>     37538         151        1464       16489        4324        5293 double
>     complex   character         ...         any        list
>       2446           1       36010           0           0        3262 
> expression    bytecode externalptr     weakref         raw
>          1           0         665         177           1
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hengl at science.uva.nl  Mon May 19 15:56:01 2008
From: hengl at science.uva.nl (Tomislav Hengl)
Date: Mon, 19 May 2008 15:56:01 +0200
Subject: [R-sig-Geo] FYI: 1st call Summer school on spatio-temporal data
	analysis using R + SAGA + Google Earth, 25-30 August 2008, Amsterdam
Message-ID: <010d01c8b9b8$1248a190$3a871291@pcibed193>



***********************************

>From 25-30 August 2008 the research school ICG organizes a five-day course targeted at PhD students,
academic staff and project teams working with spatio-temporal data. The course aims at providing a
balanced combination of theoretical and hands-on-software training. The participants will receive
many practical instructions on how to generate R scripts and use SAGA GIS / Google Earth to
visualize outputs of analysis. All these packages are available as open-source software or as
freeware. After completing the course, the course participants are expected to obtain sufficient
knowledge to independently produce R scripts, perform various analyzes and generate outputs that can
be directly distributed to the end-users.
Flyer: http://www.science.uva.nl/ibed/icg/UvA_geostat2008_1st.pdf 

Moderators: T. Hengl (uva.nl), D.G. Rossiter (itc.nl), G.B.M. Heuvelink (wur.nl) and V. Olaya
Ferrero (unex.es)
The course fees is 300 euros and includes the cost of coffee and lunch breaks, materials, a workshop
dinner and local transportation.

Deadline to register: 15th June 2008
The course is limited to 25 participants.
International/overseas applicants are welcome!
More info/registration:
http://www.science.uva.nl/ibed-agenda/events.cfm/F08AAEA4-1321-B0BE-A4707C0EADE7B462



From yong.li at unimelb.edu.au  Tue May 20 09:46:29 2008
From: yong.li at unimelb.edu.au (Yong Li)
Date: Tue, 20 May 2008 17:46:29 +1000
Subject: [R-sig-Geo] How to subset a spatial grid?
In-Reply-To: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
References: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
Message-ID: <86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>

Dear All,

I want to subset a large spatial grid (2000*2000) into many smaller
grids for further processing in my simulation models. Could anyone do it
before and any tips will be highly appreciated?

Library(rgdal)
Map <- readGDAL("yong.img")  # one image from erdras imagine
Map$va <- Map$band1
Map$band1 <- NULL
????
Map1 <- a subset of Map$va based on selected cols and rows.
????......

Cheers

Yong Li



From edzer.pebesma at uni-muenster.de  Tue May 20 10:11:04 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 20 May 2008 10:11:04 +0200
Subject: [R-sig-Geo] How to subset a spatial grid?
In-Reply-To: <86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>
References: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>
Message-ID: <48328798.7040201@uni-muenster.de>

Have you tried

Map1 <- Map[1:100,1:100]
?

Note that this works differently for SpatialGridDataFrames and 
SpatialPixelsDataFrames; the first knows about [rows,cols,bands], the 
second about [pixels, bands].
--
Edzer

Yong Li wrote:
> Dear All,
>
> I want to subset a large spatial grid (2000*2000) into many smaller
> grids for further processing in my simulation models. Could anyone do it
> before and any tips will be highly appreciated?
>
> Library(rgdal)
> Map <- readGDAL("yong.img")  # one image from erdras imagine
> Map$va <- Map$band1
> Map$band1 <- NULL
> ????
> Map1 <- a subset of Map$va based on selected cols and rows.
> ????......
>
> Cheers
>
> Yong Li
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From gord.yang at gmail.com  Tue May 20 10:36:56 2008
From: gord.yang at gmail.com (=?gb2312?B?0e65+rij?=)
Date: Tue, 20 May 2008 16:36:56 +0800
Subject: [R-sig-Geo] Adaptive kernel density estimation
Message-ID: <48328d9f.1f588c0a.25da.4333@mx.google.com>

Hi everyone:

with the package spatstat I can do the kernel density estimation in the
function density.ppp. but How do I use R for Adaptive kernel density
estimation.

Thanks in advance

Gordon
2008-5-20



From yong.li at unimelb.edu.au  Tue May 20 15:10:39 2008
From: yong.li at unimelb.edu.au (Yong Li)
Date: Tue, 20 May 2008 23:10:39 +1000
Subject: [R-sig-Geo] How to subset a spatial grid?
References: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>
	<48328798.7040201@uni-muenster.de>
Message-ID: <86DBA0678E017341B449A62F258E2956386C9E@IS-EX-BEV3.unimelb.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080520/e5bf15aa/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue May 20 15:20:06 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 20 May 2008 15:20:06 +0200
Subject: [R-sig-Geo] How to subset a spatial grid?
In-Reply-To: <86DBA0678E017341B449A62F258E2956386C9E@IS-EX-BEV3.unimelb.edu.au>
References: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>
	<48328798.7040201@uni-muenster.de>
	<86DBA0678E017341B449A62F258E2956386C9E@IS-EX-BEV3.unimelb.edu.au>
Message-ID: <4832D006.2090108@uni-muenster.de>

Yong, I would have loved to see your R shaking.

This argument has been heard more often here. When processing massive 
grids, please have a look at the function getRasterData in package 
rgdal. It allows you to _read_ only portions of a grid.
--
Edzer

Yong Li wrote:
> Thanks Edzer and Hengl. It works.
> But R is really shaking when large grids are processed. We wish there 
> is improvement of sp in the future like GIS handling grids.
>  
> Regards
>  
> Yong
>
> ------------------------------------------------------------------------
> *From:* Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> *Sent:* Tue 20/05/2008 6:11 PM
> *To:* Yong Li
> *Cc:* r-sig-geo at stat.math.ethz.ch
> *Subject:* Re: [R-sig-Geo] How to subset a spatial grid?
>
> Have you tried
>
> Map1 <- Map[1:100,1:100]
> ?
>
> Note that this works differently for SpatialGridDataFrames and
> SpatialPixelsDataFrames; the first knows about [rows,cols,bands], the
> second about [pixels, bands].
> --
> Edzer
>
> Yong Li wrote:
> > Dear All,
> >
> > I want to subset a large spatial grid (2000*2000) into many smaller
> > grids for further processing in my simulation models. Could anyone do it
> > before and any tips will be highly appreciated?
> >
> > Library(rgdal)
> > Map <- readGDAL("yong.img")  # one image from erdras imagine
> > Map$va <- Map$band1
> > Map$band1 <- NULL
> > ????
> > Map1 <- a subset of Map$va based on selected cols and rows.
> > ????......
> >
> > Cheers
> >
> > Yong Li
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >  
>



From Roger.Bivand at nhh.no  Tue May 20 15:49:45 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 May 2008 15:49:45 +0200 (CEST)
Subject: [R-sig-Geo] How to subset a spatial grid?
In-Reply-To: <4832D006.2090108@uni-muenster.de>
References: <mailman.13.1211191203.24778.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E29560169C50C@IS-EX-BEV3.unimelb.edu.au>
	<48328798.7040201@uni-muenster.de>
	<86DBA0678E017341B449A62F258E2956386C9E@IS-EX-BEV3.unimelb.edu.au>
	<4832D006.2090108@uni-muenster.de>
Message-ID: <Pine.LNX.4.64.0805201534370.26078@reclus.nhh.no>

On Tue, 20 May 2008, Edzer Pebesma wrote:

> Yong, I would have loved to see your R shaking.

Unless you do seismology, of course?

>
> This argument has been heard more often here. When processing massive grids, 
> please have a look at the function getRasterData in package rgdal. It allows 
> you to _read_ only portions of a grid.

This is the best current way to do things certainly, especially when many 
bands/variables are involved. What I'm wondering is whether a class could 
be written with an SQLiteDF sqlite.data.frame in the data slot? There is a 
talk at useR! on a proposed SQLiteMap, but for vector data, and which 
appears to miss sp classes, so I don't think that it is relevant.

Roger

> --
> Edzer
>
> Yong Li wrote:
>>  Thanks Edzer and Hengl. It works.
>>  But R is really shaking when large grids are processed. We wish there is
>>  improvement of sp in the future like GIS handling grids.
>>
>>  Regards
>>
>>  Yong
>>
>>  ------------------------------------------------------------------------
>>  *From:* Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
>>  *Sent:* Tue 20/05/2008 6:11 PM
>>  *To:* Yong Li
>>  *Cc:* r-sig-geo at stat.math.ethz.ch
>>  *Subject:* Re: [R-sig-Geo] How to subset a spatial grid?
>>
>>  Have you tried
>>
>>  Map1 <- Map[1:100,1:100]
>>  ?
>>
>>  Note that this works differently for SpatialGridDataFrames and
>>  SpatialPixelsDataFrames; the first knows about [rows,cols,bands], the
>>  second about [pixels, bands].
>>  --
>>  Edzer
>>
>>  Yong Li wrote:
>> >  Dear All,
>> > 
>> >  I want to subset a large spatial grid (2000*2000) into many smaller
>> >  grids for further processing in my simulation models. Could anyone do it
>> >  before and any tips will be highly appreciated?
>> > 
>> >  Library(rgdal)
>> >  Map <- readGDAL("yong.img")  # one image from erdras imagine
>> >  Map$va <- Map$band1
>> >  Map$band1 <- NULL
>> > ????
>> >  Map1 <- a subset of Map$va based on selected cols and rows.
>> > ????......
>> > 
>> >  Cheers
>> > 
>> >  Yong Li
>> > 
>> > _______________________________________________
>> >  R-sig-Geo mailing list
>> >  R-sig-Geo at stat.math.ethz.ch
>> >  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > 
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pisicandru at hotmail.com  Tue May 20 16:05:48 2008
From: pisicandru at hotmail.com (Monica Pisica)
Date: Tue, 20 May 2008 14:05:48 +0000
Subject: [R-sig-Geo] displayDataset command
Message-ID: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080520/cf6b9909/attachment.pl>

From Roger.Bivand at nhh.no  Tue May 20 16:38:06 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 May 2008 16:38:06 +0200 (CEST)
Subject: [R-sig-Geo] displayDataset command
In-Reply-To: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>
Message-ID: <Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>

On Tue, 20 May 2008, Monica Pisica wrote:

>
> Hi,
>
> I am trying to display a geotiff using displayDataset command from rgdal 
> ..... which i can do pretty successfully but i cannot display axes for 
> my map .... i tried to use axes = TRUE and i got the error that axes is 
> matched by multiple arguments and if i try to set xaxs and yaxs as equal 
> to "i" or "r" they are simply ignored .....
>
> Suppose my geotiff is named d1 ...
> x <- GDAL.open(d1)
> displayDataset(x, zlim = c(-2, 5.7), col = rainbow(20), xaxs = "r", yaxs 
> = "r")
>
> And i get a nice image display but no axes what so ever ;-)

If you look in the code, you'll see that axes are set to FALSE internally, 
and the drawing units are manipulated, so the graphics display does not 
know where they should go or which units they should be in. Since you can 
use output.dim= in readGDAL too, I'd go with

image(readGDAL(d1), col=grey.colors(20), axes=TRUE)

adding arguments to readGDAL() to decimate the image if there are many 
pixels. You don't get the color palette, though, but it could be retrieved 
if need be.

Roger

>
> I will really appreciate any help you can provide,
>
> Thanks,
>
> Monica
> _________________________________________________________________
> E-mail for the greater good. Join the i?m Initiative from Microsoft.
>
> ood
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hengl at science.uva.nl  Tue May 20 16:48:06 2008
From: hengl at science.uva.nl (Tomislav Hengl)
Date: Tue, 20 May 2008 16:48:06 +0200
Subject: [R-sig-Geo] displayDataset command
In-Reply-To: <Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
Message-ID: <01fa01c8ba88$83a92c80$3a871291@pcibed193>


If it is of any help, you might want to take a look at this guide:

"Creating Maps for Publication using R Graphics"
http://www.nceas.ucsb.edu/scicomp/GISSeminar/UseCases/MapProdWithRGraphics/OneMapProdWithRGraphics.h
tml

The second example demonstrates how to visualize a remote sensing band using grey levels and then
overlay various vector layers.

Tom Hengl
http://spatial-analyst.net 



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Roger Bivand
Sent: dinsdag 20 mei 2008 16:38
To: Monica Pisica
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] displayDataset command

On Tue, 20 May 2008, Monica Pisica wrote:

>
> Hi,
>
> I am trying to display a geotiff using displayDataset command from rgdal 
> ..... which i can do pretty successfully but i cannot display axes for 
> my map .... i tried to use axes = TRUE and i got the error that axes is 
> matched by multiple arguments and if i try to set xaxs and yaxs as equal 
> to "i" or "r" they are simply ignored .....
>
> Suppose my geotiff is named d1 ...
> x <- GDAL.open(d1)
> displayDataset(x, zlim = c(-2, 5.7), col = rainbow(20), xaxs = "r", yaxs 
> = "r")
>
> And i get a nice image display but no axes what so ever ;-)

If you look in the code, you'll see that axes are set to FALSE internally, 
and the drawing units are manipulated, so the graphics display does not 
know where they should go or which units they should be in. Since you can 
use output.dim= in readGDAL too, I'd go with

image(readGDAL(d1), col=grey.colors(20), axes=TRUE)

adding arguments to readGDAL() to decimate the image if there are many 
pixels. You don't get the color palette, though, but it could be retrieved 
if need be.

Roger

>
> I will really appreciate any help you can provide,
>
> Thanks,
>
> Monica
> _________________________________________________________________
> E-mail for the greater good. Join the i?m Initiative from Microsoft.
>
> ood
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pisicandru at hotmail.com  Tue May 20 17:03:02 2008
From: pisicandru at hotmail.com (Monica Pisica)
Date: Tue, 20 May 2008 15:03:02 +0000
Subject: [R-sig-Geo] displayDataset command
In-Reply-To: <Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>
	<Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
Message-ID: <BAY104-W41BC5C25227CE0C0E9858BC3C40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080520/bb53a6c1/attachment.pl>

From pisicandru at hotmail.com  Tue May 20 17:11:54 2008
From: pisicandru at hotmail.com (Monica Pisica)
Date: Tue, 20 May 2008 15:11:54 +0000
Subject: [R-sig-Geo] displayDataset command
Message-ID: <BAY104-W258BE22DA7B3FC2A0AA09CC3C40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080520/ec041a0a/attachment.pl>

From evans324 at umn.edu  Tue May 20 19:04:02 2008
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 20 May 2008 12:04:02 -0500
Subject: [R-sig-Geo] error message when running errorsarlm
Message-ID: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>

Hi, 

I'm working on Windows with 2GB RAM and am trying to run the errorsarlm 
with 32 predictor variables and 10,071 records. I created my listw object 
using the dnearneigh function with an upper distance limit of 3000m. I used 
the following code with method=Matrix to deal with memory limitations:

rams_dak3k.err <- errorsarlm(LN_PRICE~., data=reg_vars, 
rams_dak.dnear3k.listw, zero.policy=TRUE, method="Matrix")

When I run this, I get the following error message repeated many times:

Error in stop(gettextf("no method or default for coercing \"%s\" to 
\"%s\"", :
  no function to return from, jumping to top level
In addition: Warning message:
In optimize(sar.error.f.M, interval = interval, maximum = TRUE,  :
  NA/Inf replaced by maximum positive value

I am not sure what this message means. Should I trust the results? Should I 
run the function differently. I appreciate any advice anyone can offer me.

Thanks,
Heather Sander


-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA



From Roger.Bivand at nhh.no  Tue May 20 20:12:26 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 May 2008 20:12:26 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
Message-ID: <Pine.LNX.4.64.0805202005030.27206@reclus.nhh.no>

On Tue, 20 May 2008, evans324 at umn.edu wrote:

> Hi, 
> I'm working on Windows with 2GB RAM and am trying to run the errorsarlm with 
> 32 predictor variables and 10,071 records. I created my listw object using 
> the dnearneigh function with an upper distance limit of 3000m. I used the 
> following code with method=Matrix to deal with memory limitations:
>
> rams_dak3k.err <- errorsarlm(LN_PRICE~., data=reg_vars, 
> rams_dak.dnear3k.listw, zero.policy=TRUE, method="Matrix")
>
> When I run this, I get the following error message repeated many times:
>
> Error in stop(gettextf("no method or default for coercing \"%s\" to \"%s\"", 
> :
> no function to return from, jumping to top level
> In addition: Warning message:
> In optimize(sar.error.f.M, interval = interval, maximum = TRUE,  :
>  NA/Inf replaced by maximum positive value

A bit more context would help. The output of sessionInfo() at least (R and 
package versions may matter), plus the preceding code, including the 
definition of rams_dak.dnear3k.listw - is it row-standardised? Running 
traceback() immediately after the error would also be helpful to see where 
in functions called by sar.error.f.M() the problem is occurring. If I 
understand correctly, the error messages cycle, but the rams_dak3k.err 
object is created? Could you run it with quiet=FALSE, so see the function 
values as they are generated in optimize()? The NAs usually come from the 
interval= being too broad wrt. your weights style.

Roger

>
> I am not sure what this message means. Should I trust the results? Should I 
> run the function differently. I appreciate any advice anyone can offer me.
>
> Thanks,
> Heather Sander
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From CHURCHER at DAL.CA  Tue May 20 20:16:36 2008
From: CHURCHER at DAL.CA (Sylvia Churcher)
Date: Tue, 20 May 2008 15:16:36 -0300
Subject: [R-sig-Geo] spTransform results
Message-ID: <20080520151636.k3g96qqe1twkgcs4@my1.dal.ca>

Hello all,

Being a new and cautious user of the rgdal library I am having trouble
confirming that my results are correct.

transforming vectors with long and lat values to easting and northing in zone
16, datum=NAD83

I'll obviously omit the entire vectors, but include the first 2 lines for
reference

*coords.x1 is long (vector name:  lake.info$Longitude_W);
coords.x2 is lat (vector name:  lake.info$Latitude_N)

SpatialPoints:
      coords.x1 coords.x2
 [1,]     89.59     46.02
 [2,]     89.67     46.12

Using the code:
SP_grd <- SpatialPoints(cbind(lake.info$Longitude_W, lake.info$Latitude_N),
proj4string=CRS("+proj=longlat +datum=NAD83"))

SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=16 +datum=NAD83"))

My result is:
SpatialPoints:
      coords.x1 coords.x2
 [1,] -83121879 -53374442
 [2,] -82861240 -54157633

==> My main problem is that I'm not able to check that these resulting values
are correct and that I haven't made an error in my code.  The I've tried using
online converters and the results are not matching.  My lat and long points are
all for Wisconsin, USA (specifically zone 16T in NAD83).

Thank you any and all for your help.



From Roger.Bivand at nhh.no  Tue May 20 20:57:54 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 May 2008 20:57:54 +0200 (CEST)
Subject: [R-sig-Geo] spTransform results
In-Reply-To: <20080520151636.k3g96qqe1twkgcs4@my1.dal.ca>
References: <20080520151636.k3g96qqe1twkgcs4@my1.dal.ca>
Message-ID: <Pine.LNX.4.64.0805202051240.27206@reclus.nhh.no>

On Tue, 20 May 2008, Sylvia Churcher wrote:

> Hello all,
>
> Being a new and cautious user of the rgdal library I am having trouble
> confirming that my results are correct.
>
> transforming vectors with long and lat values to easting and northing in zone
> 16, datum=NAD83
>
> I'll obviously omit the entire vectors, but include the first 2 lines for
> reference
>
> *coords.x1 is long (vector name:  lake.info$Longitude_W);
> coords.x2 is lat (vector name:  lake.info$Latitude_N)
>
> SpatialPoints:
>      coords.x1 coords.x2
> [1,]     89.59     46.02
> [2,]     89.67     46.12

            ^^^^^

These look like Sinkiang to me - or a more recent translitteration. GE 
goes to Western China too if you type 89.59E 46.02N; 89.59W is near Vilas 
WI. If they are degrees W, they ought to be negative.

Hope this helps,

Roger

>
> Using the code:
> SP_grd <- SpatialPoints(cbind(lake.info$Longitude_W, lake.info$Latitude_N),
> proj4string=CRS("+proj=longlat +datum=NAD83"))
>
> SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=16 +datum=NAD83"))
>
> My result is:
> SpatialPoints:
>      coords.x1 coords.x2
> [1,] -83121879 -53374442
> [2,] -82861240 -54157633
>
> ==> My main problem is that I'm not able to check that these resulting values
> are correct and that I haven't made an error in my code.  The I've tried using
> online converters and the results are not matching.  My lat and long points are
> all for Wisconsin, USA (specifically zone 16T in NAD83).
>
> Thank you any and all for your help.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From evans324 at umn.edu  Tue May 20 21:29:50 2008
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 20 May 2008 14:29:50 -0500
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805202005030.27206@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805202005030.27206@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0805201429500.2967@wm2.tc.umn.edu>

Thanks for your response.  Here's what I have now.  

On May 20 2008, Roger Bivand wrote:

>A bit more context would help. The output of sessionInfo() at least (R and 
>package versions may matter), plus the preceding code, including the 
>definition of rams_dak.dnear3k.listw - is it row-standardised? 

Output of sessionInfo():
R version 2.6.1 (2007-11-26) 
i386-pc-mingw32 

locale: LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] spdep_0.4-17 Matrix_0.999375-5 lattice_0.17-2 spam_0.13-2 boot_1.2-30 
maptools_0.7-7
 [7] foreign_0.8-23    sp_0.9-23         tripack_1.2-11    car_1.2-7        

loaded via a namespace (and not attached):
[1] grid_2.6.1  tools_2.6.1

Preceding code:
rams_dak <-readShapePoly("rams_dak_6May.shp", IDvar="ID", verbose=TRUE)
rn<-sapply(slot(rams_dak, "polygons"), function(x) slot(x, "ID"))
rams_dak.dnear.nb <- dnearneigh(coords, 0, 2500, row.names=rn)
rams_dak.dnaer.listw <- nb2listw(rams_dak.dnear.nb, zero.policy=TRUE)


> Running traceback() immediately after the error would also be helpful to 
> see where in functions called by sar.error.f.M() the problem is 
> occurring.

I get:
2: stop(gettextf("no method or default for coercing \"%s\" to \"%s\"", 
       thisClass, Class), domain = NA)
1: as((I - lambda * csrw), "dsCMatrix")

> If I understand correctly, the error messages cycle, but the 
> rams_dak3k.err >object is created?
Yes.

>Could you run it with quiet=FALSE, so see the function values as they are  
>generated in optimize()? The NAs usually come from the  
>interval= being too broad wrt. your weights style.

I did this and found that lambda ranged from -.2364499 to .999 with SSEs 
starting at 292.339 and going to 267.4409. I a bit unsure of how to select 
and interval. Can you offer some advice on this?

Thanks for your help.

Heather


-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA



From Roger.Bivand at nhh.no  Tue May 20 22:28:27 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 May 2008 22:28:27 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Prayer.1.0.16.0805201429500.2967@wm2.tc.umn.edu>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805202005030.27206@reclus.nhh.no>
	<Prayer.1.0.16.0805201429500.2967@wm2.tc.umn.edu>
Message-ID: <Pine.LNX.4.64.0805202223000.27206@reclus.nhh.no>

On Tue, 20 May 2008, evans324 at umn.edu wrote:

> Thanks for your response.  Here's what I have now. 
> On May 20 2008, Roger Bivand wrote:
>
>> A bit more context would help. The output of sessionInfo() at least (R and 
>> package versions may matter), plus the preceding code, including the 
>> definition of rams_dak.dnear3k.listw - is it row-standardised? 
>
> Output of sessionInfo():
> R version 2.6.1 (2007-11-26) i386-pc-mingw32 
> locale: LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
> States.1252;LC_MONETARY=English_United 
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base 
> other attached packages:
> [1] spdep_0.4-17 Matrix_0.999375-5 lattice_0.17-2 spam_0.13-2 boot_1.2-30 
> maptools_0.7-7
> [7] foreign_0.8-23    sp_0.9-23         tripack_1.2-11    car_1.2-7 
>
> loaded via a namespace (and not attached):
> [1] grid_2.6.1  tools_2.6.1

If you cannot upgrade R to 2.7.0, and Matrix to >= 0.999375-9 and spdep to 
current, try method="spam". To benefit from "Matrix", you need a fully 
updated system, running update.packages() frequently. The results are not 
trustworthy, because the NAs are pushing lambda to the upper limit of its 
interval. The default interval is OK for your setting - the weights are 
row-standardised.

Roger

>
> Preceding code:
> rams_dak <-readShapePoly("rams_dak_6May.shp", IDvar="ID", verbose=TRUE)
> rn<-sapply(slot(rams_dak, "polygons"), function(x) slot(x, "ID"))
> rams_dak.dnear.nb <- dnearneigh(coords, 0, 2500, row.names=rn)
> rams_dak.dnaer.listw <- nb2listw(rams_dak.dnear.nb, zero.policy=TRUE)
>
>
>>  Running traceback() immediately after the error would also be helpful to
>>  see where in functions called by sar.error.f.M() the problem is occurring.
>
> I get:
> 2: stop(gettextf("no method or default for coercing \"%s\" to \"%s\"", 
> thisClass, Class), domain = NA)
> 1: as((I - lambda * csrw), "dsCMatrix")
>
>>  If I understand correctly, the error messages cycle, but the
>>  rams_dak3k.err >object is created?
> Yes.
>
>> Could you run it with quiet=FALSE, so see the function values as they are 
>> generated in optimize()? The NAs usually come from the  interval= being too 
>> broad wrt. your weights style.
>
> I did this and found that lambda ranged from -.2364499 to .999 with SSEs 
> starting at 292.339 and going to 267.4409. I a bit unsure of how to select 
> and interval. Can you offer some advice on this?
>
> Thanks for your help.
>
> Heather
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From regmi_pujan at hotmail.com  Wed May 21 01:51:45 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Tue, 20 May 2008 23:51:45 +0000
Subject: [R-sig-Geo] fit.variogram
Message-ID: <BAY113-W5068D8C6EF84FB3E13154F84C40@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080520/e0347e0a/attachment.pl>

From miguez at uiuc.edu  Wed May 21 03:28:32 2008
From: miguez at uiuc.edu (Fernando Miguez)
Date: Tue, 20 May 2008 20:28:32 -0500
Subject: [R-sig-Geo] NARR
Message-ID: <48337AC0.2020200@uiuc.edu>

Hi,

I've used R for a few years but I'm a novice regarding the topics 
discussed in this list. I would like to know if there is a package or 
script that can easily access and manipulate the NARR (North American 
Regional Reanalysis) database. I have a model that takes these data as 
input at hourly time steps. My understanding is that these data is in 
3-hour intervals, so if there is also a package/script for interpolating 
to one hour intervals that would be great too.

Any help is appreciated.

Thanks!

Fernando

-- 
Fernando E. Miguez
Energy Biosciences Institute
http://netfiles.uiuc.edu/miguez/www/



From hi_ono2001 at ybb.ne.jp  Wed May 21 05:24:32 2008
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Wed, 21 May 2008 12:24:32 +0900 (JST)
Subject: [R-sig-Geo] Adaptive kernel density estimation
Message-ID: <20080521032432.58063.qmail@web10701.mail.bbt.yahoo.co.jp>

 Hi.
 
 How about using "gw.adapt functio", Adaptive kernel
 for  GWR, in spgwr package?
 
 Regards.
 
 --- ??? <gord.yang at gmail.com> wrote:
 
> Hi everyone:
> 
> > with the package spatstat I can do the kernel
> > density estimation in the
> > function density.ppp. but How do I use R for
> > Adaptive kernel density
> > estimation.
> > 
> > Thanks in advance
> > 
> > Gordon
> > 2008-5-20



From edzer.pebesma at uni-muenster.de  Wed May 21 08:15:10 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 May 2008 08:15:10 +0200
Subject: [R-sig-Geo] fit.variogram
In-Reply-To: <BAY113-W5068D8C6EF84FB3E13154F84C40@phx.gbl>
References: <BAY113-W5068D8C6EF84FB3E13154F84C40@phx.gbl>
Message-ID: <4833BDEE.4000504@uni-muenster.de>

Could you please provide us with a readable email (see below how yours 
looked like to me), and with a reproducable example, so we can look into it?
--
Edzer

PUJAN RAJ REGMI wrote:
> Dear list,
> I tried to fit the model variogram to the experimental semivariogram. I used the following code:
> A<-read.table(file.choose(new=FALSE), sep = "",skip=8,header=FALSE) 
> names(A) <- c("x", "y", "B1","B2","B3","B4")
> library(sp)library(gstat)coordinates(A) = ~x+yC<-variogram(B1~x+y+x*y+x*x+y*y,A,cutoff=650,width=12,alpha=0,tol.hor=90)model.1<- fit.variogram(C,vgm(4,"Sph",500,add.to=vgm(1,"Sph",80,nugget=.9)))
> plot(C, model=model.1,pch=1,col="blue",lty =1,lwd=2,plot.numbers=F,xlab=list("Distance(h) [m]",font=1,col="black"),ylab= list(expression("Semivariogram [-]"^2), font=3,col="black"),ylim = c(0,6, by=1), xlim = c(0,650, by=100))
> Using the above code everything went ok. But i need to save the experimental semivariogram i.e (C) and then later utilize it to fit the semivariogram for the same. So I first save it using the following code:
>  
> write.table(C, file = "expm-vario.csv", sep = ",", col.names =T,quote=T,qmethod="double")
>  
> Then i used the following code to read the saved file expm-vari.csv and try to fit the model for it;
> B<-read.table(file.choose(new=FALSE), sep = ",",skip=0,header=T) class(B)=c("gstatVariogram","data.frame","numeric")model.2<- fit.variogram(B,vgm(4,"Sph",500,add.to=vgm(1,"Sph",80,nugget=.9)))
>  
> But I couldn't fit the model. Following was the error message i got:
>  
> "Error in fit.variogram(B, vgm(4, "Sph", 500, add.to = vgm(1, "Sph", 80,  :   REAL() can only be applied to a 'numeric', not a 'integer' "
> The problem seems to be the numeric and integer mismatched but i couldn't figured it out.
>  
> any help will be greatly appreciated!
>  
> Regards
> Pujan
>  
>
>  
> _________________________________________________________________
> E-mail for the greater good. Join the i?m Initiative from Microsoft.
>
> ood
> 	[[alternative HTML version deleted]]
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ya-cine at hotmail.com  Wed May 21 10:30:23 2008
From: ya-cine at hotmail.com (ya-cine at hotmail.com)
Date: Wed, 21 May 2008 10:30:23 +0200
Subject: [R-sig-Geo] Dear list
Message-ID: <BAY114-DS242400CFA94D04657CE29FBC70@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080521/68bc5ce5/attachment.pl>

From regmi_pujan at hotmail.com  Wed May 21 11:01:22 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 21 May 2008 09:01:22 +0000
Subject: [R-sig-Geo] To fit variogram model
Message-ID: <BAY113-W34CCD42E5F28E186B2B70C84C70@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080521/5cb00a6b/attachment.pl>

From regmi_pujan at hotmail.com  Wed May 21 11:08:04 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Wed, 21 May 2008 09:08:04 +0000
Subject: [R-sig-Geo] fit.variogram
In-Reply-To: <4833BDEE.4000504@uni-muenster.de>
References: <BAY113-W5068D8C6EF84FB3E13154F84C40@phx.gbl>
	<4833BDEE.4000504@uni-muenster.de>
Message-ID: <BAY113-W25A9ECA43840EB5A37A63384C70@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080521/2558853d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May 21 12:07:38 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 May 2008 12:07:38 +0200
Subject: [R-sig-Geo] To fit variogram model
In-Reply-To: <BAY113-W34CCD42E5F28E186B2B70C84C70@phx.gbl>
References: <BAY113-W34CCD42E5F28E186B2B70C84C70@phx.gbl>
Message-ID: <4833F46A.7040207@uni-muenster.de>

Well, the answer is that this is not the way to write out and read back 
objects, as it will alter contents (such as representation by real or 
integer) and class of objects.

Please use the save/load command to save/load data in binary format, or 
dump/source to save & read back in an ascii representation.
--
Edzer

PUJAN RAJ REGMI wrote:
>  
> Dear list, I tried to fit the model variogram to the experimental semivariogram. I used the following code:
> A<-read.table(file.choose(new=FALSE), sep = ",",skip=1,header=FALSE) 
>  
> names(A) <- c("S.N","x", "y", "B1","B2","B3","B4")
>  
> library(sp)
>  
> library(gstat)
>  
> coordinates(A) = ~x+y
>  
> C<-variogram(B1~x+y+x*y+x*x+y*y,A,cutoff=700,width=12,alpha=0,tol.hor=90)
>  
> model.1 <- fit.variogram(C,vgm(4,"Sph",800,add.to=vgm(1,"Sph",40,nugget=.9)))
>  
> plot(C,model=model.1,pch=1,col=?blue?,lty=1,lwd=2,plot.numbers=F,xlab=list("Distance(h) [m]",font=1,col="black"),ylab= list(expression("Semivariogram [-]"^2), font=1,col="black"))#,ylim = c(0,6, by=1), xlim = c(0,700, by=100))
>  
> Using the above code everything went ok. But I need to save the experimental semivariogram i.e (C) and then later utilize it to fit the model semivariogram for the same. So I first save it using the following code:
> write.table(C, file = "expm_vario.csv", sep = ",", col.names = T,qmethod="double")
>  
> Then I used the following code to read the saved file expm_vario.csv and try to fit the model for it;
> B<-read.table(file.choose(new=FALSE), sep = ",",skip=0,header=T) 
> class(B)=c("gstatVariogram","data.frame","numeric")
> model.2<- fit.variogram(B,vgm(4,"Sph",500,add.to=vgm(1,"Sph",80,nugget=.9))) But I couldn't fit the model. Following was the error message I got: "Error in fit.variogram(B, vgm(4, "Sph", 500, add.to = vgm(1, "Sph", 80,  :   REAL() can only be applied to a 'numeric', not a 'integer' "The problem seems to be the numeric and integer values but I couldn't figured it out. Any help will be greatly appreciated!
>  
> Regards,
> Pujan
> _________________________________________________________________
> Give to a good cause with every e-mail. Join the i?m Initiative from Microsoft.
>
> 	[[alternative HTML version deleted]]
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From evans324 at umn.edu  Wed May 21 17:13:56 2008
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 21 May 2008 10:13:56 -0500
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805202223000.27206@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805202223000.27206@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0805211013560.17103@wm0.tc.umn.edu>

Thanks. I upgraded and updated everything and got a better result. However, 
I'm not 100% sure that I'm using the correct command to accomplish what I 
need to accomplish. My OLS model has significant spatial autocorrelation 
(RLMlag is not significant and RLMerror is) and heteroscedasticity. I had 
hoped to use errorsarlm then run White's standard errors to address this, 
but I find that hccm(car) requires a .lm object. Looking through old 
threads, I found one that suggests using spautolm is such situations. Does 
spautolm address both spatial autocorrelation and heteroscedasticity? It 
looks as though I would use the adj.se=TRUE in the summary method to get 
corrected standard errors. Is this correct? Thank you for your help.

Heather

On May 20 2008, Roger Bivand wrote:

>On Tue, 20 May 2008, evans324 at umn.edu wrote:
>
>> Thanks for your response.  Here's what I have now. 
>> On May 20 2008, Roger Bivand wrote:
>>
>>> A bit more context would help. The output of sessionInfo() at least (R 
>>> and package versions may matter), plus the preceding code, including 
>>> the definition of rams_dak.dnear3k.listw - is it row-standardised?
>>
>> Output of sessionInfo():
>> R version 2.6.1 (2007-11-26) i386-pc-mingw32 
>> locale: LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
>> States.1252;LC_MONETARY=English_United 
>> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages: [1] stats graphics grDevices utils datasets 
>> methods base other attached packages: [1] spdep_0.4-17 Matrix_0.999375-5 
>> lattice_0.17-2 spam_0.13-2 boot_1.2-30 maptools_0.7-7 [7] foreign_0.8-23 
>> sp_0.9-23 tripack_1.2-11 car_1.2-7
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.6.1  tools_2.6.1
>
>If you cannot upgrade R to 2.7.0, and Matrix to >= 0.999375-9 and spdep to 
>current, try method="spam". To benefit from "Matrix", you need a fully 
>updated system, running update.packages() frequently. The results are not 
>trustworthy, because the NAs are pushing lambda to the upper limit of its 
>interval. The default interval is OK for your setting - the weights are 
>row-standardised.
>
>Roger
>
>>
>> Preceding code:
>> rams_dak <-readShapePoly("rams_dak_6May.shp", IDvar="ID", verbose=TRUE)
>> rn<-sapply(slot(rams_dak, "polygons"), function(x) slot(x, "ID"))
>> rams_dak.dnear.nb <- dnearneigh(coords, 0, 2500, row.names=rn)
>> rams_dak.dnaer.listw <- nb2listw(rams_dak.dnear.nb, zero.policy=TRUE)
>>
>>
>>>  Running traceback() immediately after the error would also be helpful 
>>> to
>>>  see where in functions called by sar.error.f.M() the problem is 
>>> occurring.
>>
>> I get:
>> 2: stop(gettextf("no method or default for coercing \"%s\" to \"%s\"", 
>> thisClass, Class), domain = NA)
>> 1: as((I - lambda * csrw), "dsCMatrix")
>>
>>>  If I understand correctly, the error messages cycle, but the
>>>  rams_dak3k.err >object is created?
>> Yes.
>>
>>> Could you run it with quiet=FALSE, so see the function values as they 
>>> are generated in optimize()? The NAs usually come from the interval= 
>>> being too broad wrt. your weights style.
>>
>> I did this and found that lambda ranged from -.2364499 to .999 with 
>> SSEs starting at 292.339 and going to 267.4409. I a bit unsure of how to 
>> select and interval. Can you offer some advice on this?
>>
>> Thanks for your help.
>>
>> Heather
>>
>>
>>
>
>

-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA



From juantomas.sayago at gmail.com  Wed May 21 17:42:59 2008
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Wed, 21 May 2008 17:42:59 +0200
Subject: [R-sig-Geo] Is there a command to run SARMA on the spdep?
Message-ID: <3364ce110805210842h4c1ea444g80a3e7fa4a0305fa@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080521/46af29d9/attachment.pl>

From Roger.Bivand at nhh.no  Wed May 21 19:10:20 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 May 2008 19:10:20 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Prayer.1.0.16.0805211013560.17103@wm0.tc.umn.edu>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805202223000.27206@reclus.nhh.no>
	<Prayer.1.0.16.0805211013560.17103@wm0.tc.umn.edu>
Message-ID: <Pine.LNX.4.64.0805211900230.29860@reclus.nhh.no>

On Wed, 21 May 2008, evans324 at umn.edu wrote:

> Thanks. I upgraded and updated everything and got a better result.

Does that mean that you get a sensible lambda for your model now - the 
line search leads somewhere other than a boundary of the interval?

> However, 
> I'm not 100% sure that I'm using the correct command to accomplish what I 
> need to accomplish. My OLS model has significant spatial autocorrelation 
> (RLMlag is not significant and RLMerror is) and heteroscedasticity. I had 
> hoped to use errorsarlm then run White's standard errors to address this, but 
> I find that hccm(car) requires a .lm object. Looking through old threads, I 
> found one that suggests using spautolm is such situations. Does spautolm 
> address both spatial autocorrelation and heteroscedasticity?

There are different traditions. Econometricians and some others in social 
science try to trick the standard errors by "magic", while epidemiologists 
(and crime people) typically use case weights - that is model the 
heteroscedasticity directly. spautolm() can include such case weights. I 
don't think that there is any substantive and reliable theory for 
adjusting the SE, that is theory that doesn't appeal to assumptions we 
already know don't hold. Sampling from the posterior gives a handle on 
this, but is not simple, and doesn't really suit 10K observations.

> It looks as 
> though I would use the adj.se=TRUE in the summary method to get corrected 
> standard errors. Is this correct?

No, it simply adjusts the SE for (n-k) rather than ML (n), to match the 
results in Waller and Gotway chapter 9, nothing more.

Hope this helps,

Roger

> Thank you for your help.
>
> Heather
>
> On May 20 2008, Roger Bivand wrote:
>
>> On Tue, 20 May 2008, evans324 at umn.edu wrote:
>> 
>> >  Thanks for your response.  Here's what I have now. On May 20 2008, Roger 
>> >  Bivand wrote:
>> > 
>> > >  A bit more context would help. The output of sessionInfo() at least (R 
>> > >  and package versions may matter), plus the preceding code, including 
>> > >  the definition of rams_dak.dnear3k.listw - is it row-standardised?
>> > 
>> >  Output of sessionInfo():
>> >  R version 2.6.1 (2007-11-26) i386-pc-mingw32 locale: 
>> >  LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
>> >  States.1252;LC_MONETARY=English_United 
>> >  States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>> > 
>> >  attached base packages: [1] stats graphics grDevices utils datasets 
>> >  methods base other attached packages: [1] spdep_0.4-17 Matrix_0.999375-5 
>> >  lattice_0.17-2 spam_0.13-2 boot_1.2-30 maptools_0.7-7 [7] foreign_0.8-23 
>> >  sp_0.9-23 tripack_1.2-11 car_1.2-7
>> > 
>> >  loaded via a namespace (and not attached):
>> >  [1] grid_2.6.1  tools_2.6.1
>> 
>> If you cannot upgrade R to 2.7.0, and Matrix to >= 0.999375-9 and spdep to 
>> current, try method="spam". To benefit from "Matrix", you need a fully 
>> updated system, running update.packages() frequently. The results are not 
>> trustworthy, because the NAs are pushing lambda to the upper limit of its 
>> interval. The default interval is OK for your setting - the weights are 
>> row-standardised.
>> 
>> Roger
>> 
>> > 
>> >  Preceding code:
>> >  rams_dak <-readShapePoly("rams_dak_6May.shp", IDvar="ID", verbose=TRUE)
>> >  rn<-sapply(slot(rams_dak, "polygons"), function(x) slot(x, "ID"))
>> >  rams_dak.dnear.nb <- dnearneigh(coords, 0, 2500, row.names=rn)
>> >  rams_dak.dnaer.listw <- nb2listw(rams_dak.dnear.nb, zero.policy=TRUE)
>> > 
>> > 
>> > >  Running traceback() immediately after the error would also be helpful 
>> > >  to
>> > >  see where in functions called by sar.error.f.M() the problem is 
>> > >  occurring.
>> > 
>> >  I get:
>> >  2: stop(gettextf("no method or default for coercing \"%s\" to \"%s\"", 
>> >  thisClass, Class), domain = NA)
>> >  1: as((I - lambda * csrw), "dsCMatrix")
>> > 
>> > >   If I understand correctly, the error messages cycle, but the
>> > >   rams_dak3k.err >object is created?
>> >  Yes.
>> > 
>> > >  Could you run it with quiet=FALSE, so see the function values as they 
>> > >  are generated in optimize()? The NAs usually come from the interval= 
>> > >  being too broad wrt. your weights style.
>> > 
>> >  I did this and found that lambda ranged from -.2364499 to .999 with SSEs 
>> >  starting at 292.339 and going to 267.4409. I a bit unsure of how to 
>> >  select and interval. Can you offer some advice on this?
>> > 
>> >  Thanks for your help.
>> > 
>> >  Heather
>> > 
>> > 
>> > 
>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Wed May 21 19:15:55 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 May 2008 19:15:55 +0200 (CEST)
Subject: [R-sig-Geo] Is there a command to run SARMA on the spdep?
In-Reply-To: <3364ce110805210842h4c1ea444g80a3e7fa4a0305fa@mail.gmail.com>
References: <3364ce110805210842h4c1ea444g80a3e7fa4a0305fa@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805211912310.29860@reclus.nhh.no>

On Wed, 21 May 2008, Juan Tomas Sayago wrote:

> I have been using spdep for a short time, but I am learning the advantages
> from the package I would like to know if its possible to run a SARMA in the
> package.

No, if you mean a two parameter ML fit of a simultaneous autoregressive 
model and a simultaneous moving average model at the same time. Why would 
you want to do that, can you motivate the choice based on the behaviour of 
the data generating process? The most common cause of the spatial 
dependence of model residuals is, after all, model misspecification.

Roger

> Thanks for your attention.
> Juan
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pisicandru at hotmail.com  Wed May 21 21:07:38 2008
From: pisicandru at hotmail.com (Monica Pisica)
Date: Wed, 21 May 2008 19:07:38 +0000
Subject: [R-sig-Geo]  Displaying CIR images and overlay shape files
In-Reply-To: <Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>
	<Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
Message-ID: <BAY104-W41D8600A0BE76D18578BA2C3C70@phx.gbl>



Hi,

I am still struggling to understand how to display images in R ?. I have a CIR 3 band file (geotiff format with projection imbedded) and a polygon shape file with same projection. I want to display the CIR image and overlay on top only the contour of the poly shape file, and I want to display coordinate axes ?.

Up to now I was able to display the CIR without coordinates (now I know that using displayDataset suppresses axes ? but I was not able to display correctly the CIR with "image" ?.) and I can overlay the contour of my poly shape file but this one comes shifted horizontally and vertically ?. And I don't know why. My code is:

x <- GDAL.open("e:/JELA_veg/shapefiles/jela_cir_bigger3.tif")
dx <- RGB2PCT(x, band=1:3)
displayDataset(dx)
  park<- readShapePoly("e:/JELA_veg/shapefiles/jela_park.shp", proj4string= CRS("+proj=tmerc +lat_0=0.00000000000 +lon_0=-93.00000000000 +k=0.99960000 +x_0=500000.000000 +y_0=0.0000000 +datum=NAD83 +units=m +tonad83=0,0,0"))

  park_lines <- as(park, "SpatialLines")
plot(park_lines, col = "green", lwd = 2, add = T)

I suppose that somehow I can use spplot, but I have to recognize that I don't know how to use it to display the CIR image ?..


Any help is very much appreciated, thanks,


Monica

_________________________________________________________________
Change the world with e-mail. Join the i?m Initiative from Microsoft.

ld


From edzer.pebesma at uni-muenster.de  Wed May 21 21:45:27 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 May 2008 21:45:27 +0200
Subject: [R-sig-Geo] Displaying CIR images and overlay shape files
In-Reply-To: <BAY104-W41D8600A0BE76D18578BA2C3C70@phx.gbl>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>	<Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
	<BAY104-W41D8600A0BE76D18578BA2C3C70@phx.gbl>
Message-ID: <48347BD7.4080107@uni-muenster.de>

Monica Pisica wrote:
> I suppose that somehow I can use spplot, but I have to recognize that I don't know how to use it to display the CIR image ?.. 
>   
This would be a way that I haven't explored. When looking in sp, a place 
to start would be the image method; it has arguments red green and blue 
where you pass these bands; then it composites colour.

A similar trick should be do-able for spplot, but it's not in there, as 
of now; right now you can only pass a factor and the colours to use.
--
Edzer
>
> Any help is very much appreciated, thanks,
>
>
> Monica
>
> _________________________________________________________________
> Change the world with e-mail. Join the i?m Initiative from Microsoft.
>
> ld
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From evans324 at umn.edu  Wed May 21 21:59:31 2008
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 21 May 2008 14:59:31 -0500
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805211900230.29860@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805211900230.29860@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0805211459310.5127@wm1.tc.umn.edu>

On May 21 2008, Roger Bivand wrote:

>On Wed, 21 May 2008, evans324 at umn.edu wrote:
>
>> Thanks. I upgraded and updated everything and got a better result.
>
>Does that mean that you get a sensible lambda for your model now - the 
>line search leads somewhere other than a boundary of the interval?

I apologize for being unclear. I actually upgraded R and updated packages, 
then ran errorsarlm with method="Matrix" and got the same error messages 
I'd had previously (i.e., the search led to the boundary of the interval). 
I then tried your other suggestion and used method="spam" and got a result 
with no error messages.
 
>> However, I'm not 100% sure that I'm using the correct command to 
>> accomplish what I need to accomplish. My OLS model has significant 
>> spatial autocorrelation (RLMlag is not significant and RLMerror is) and 
>> heteroscedasticity. I had hoped to use errorsarlm then run White's 
>> standard errors to address this, but I find that hccm(car) requires a 
>> .lm object. Looking through old threads, I found one that suggests using 
>> spautolm is such situations. Does spautolm address both spatial 
>> autocorrelation and heteroscedasticity?
>
>There are different traditions. Econometricians and some others in social 
>science try to trick the standard errors by "magic", while epidemiologists 
>(and crime people) typically use case weights - that is model the 
>heteroscedasticity directly. spautolm() can include such case weights. I 
>don't think that there is any substantive and reliable theory for 
>adjusting the SE, that is theory that doesn't appeal to assumptions we 
>already know don't hold. Sampling from the posterior gives a handle on 
>this, but is not simple, and doesn't really suit 10K observations.
>
Can you explain "magic" a little further? I'm running this for a professor 
who is a bit nervous about black box techniques and I'd like to be able to 
offer him a good explanation. I think he'll just have me calculate White's 
standard errors and ignore spatial autocorrelation if I can't be clearer.
 
Thanks again.

Heather

-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA



From pisicandru at hotmail.com  Wed May 21 22:07:00 2008
From: pisicandru at hotmail.com (Monica Pisica)
Date: Wed, 21 May 2008 20:07:00 +0000
Subject: [R-sig-Geo] Displaying CIR images and overlay shape files
In-Reply-To: <48347BD7.4080107@uni-muenster.de>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>
	<Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
	<BAY104-W41D8600A0BE76D18578BA2C3C70@phx.gbl>
	<48347BD7.4080107@uni-muenster.de>
Message-ID: <BAY104-W12115F3C2C327E26FABD10C3C70@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080521/a6dfa5e7/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May 21 22:09:38 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 May 2008 22:09:38 +0200
Subject: [R-sig-Geo] Displaying CIR images and overlay shape files
In-Reply-To: <BAY104-W12115F3C2C327E26FABD10C3C70@phx.gbl>
References: <BAY104-W42D639D943935F96E037C3C3C40@phx.gbl>	<Pine.LNX.4.64.0805201609371.26078@reclus.nhh.no>
	<BAY104-W41D8600A0BE76D18578BA2C3C70@phx.gbl>
	<48347BD7.4080107@uni-muenster.de>
	<BAY104-W12115F3C2C327E26FABD10C3C70@phx.gbl>
Message-ID: <48348182.90808@uni-muenster.de>

A familiar problem. This works (for S3 methods at least):

 > library(sp)
 > methods(image)
[1] image.default                 image.SpatialGridDataFrame*
[3] image.SpatialPixelsDataFrame*

   Non-visible functions are asterisked
 > ?image.SpatialGridDataFrame
--
Edzer

Monica Pisica wrote:
> Bingo, it did work .... my fault was to look at the help inside R for 
> "image" and i didn't see the arguments red, green, blue, but looking 
> at the pdf manual for sp i found the complete definition of "image".
>  
> Thanks so much,
>  
> Monica
>
> > Date: Wed, 21 May 2008 21:45:27 +0200
> > From: edzer.pebesma at uni-muenster.de
> > To: pisicandru at hotmail.com
> > CC: r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] Displaying CIR images and overlay shape files
> >
> > Monica Pisica wrote:
> > > I suppose that somehow I can use spplot, but I have to recognize 
> that I don't know how to use it to display the CIR image ?..
> > >
> > This would be a way that I haven't explored. When looking in sp, a 
> place
> > to start would be the image method; it has arguments red green and blue
> > where you pass these bands; then it composites colour.
> >
> > A similar trick should be do-able for spplot, but it's not in there, as
> > of now; right now you can only pass a factor and the colours to use.
> > --
> > Edzer
> > >
> > > Any help is very much appreciated, thanks,
> > >
> > >
> > > Monica
> > >
> > > _________________________________________________________________
> > > Change the world with e-mail. Join the i?m Initiative from Microsoft.
> > >
> > > ld
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
>
>
> ------------------------------------------------------------------------
> Keep your kids safer online with Windows Live Family Safety. Help 
> protect your kids. 
> <http://www.windowslive.com/family_safety/overview.html?ocid=TXT_TAGLM_WL_Refresh_family_safety_052008>



From reeves at nceas.ucsb.edu  Thu May 22 08:29:43 2008
From: reeves at nceas.ucsb.edu (reeves at nceas.ucsb.edu)
Date: Wed, 21 May 2008 23:29:43 -0700 (PDT)
Subject: [R-sig-Geo] Sampling SpatialPolygonDataFrame attributes from points
	in a grid..
Message-ID: <2537.71.102.158.88.1211437783.squirrel@webmail.nceas.ucsb.edu>


Greetings:

I'd like to get some advice on performing this task:


Given a SpatialPolygonsDataFrame, and a regularly-spaced point grid
created 'over' the polygons using spsample() or similar method, how
to extract one attribute from the polygon 'beneath' the location of
each point in the grid, and then assign the computed attribute to
the point? Best end product would be a SpatialPointsDataFrame.

The next step would be to replace the attribute of all points corresponding
to each polygon with a weighted average of all the point subset's attribute
value.

I am reviewing the spsample() and overlay() methods, which look like
good candidates for this task. But perhaps there is a better way.

Can someone direct me to a sample solution to a similar task,
for example, a vector polygon to raster grid conversion?

Thanks in advance,
Rick Reeves
NCEAS



From Roger.Bivand at nhh.no  Thu May 22 10:47:34 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 May 2008 10:47:34 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Prayer.1.0.16.0805211459310.5127@wm1.tc.umn.edu>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805211900230.29860@reclus.nhh.no>
	<Prayer.1.0.16.0805211459310.5127@wm1.tc.umn.edu>
Message-ID: <Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>

On Wed, 21 May 2008, evans324 at umn.edu wrote:

> On May 21 2008, Roger Bivand wrote:
>
>> On Wed, 21 May 2008, evans324 at umn.edu wrote:
>> 
>> >  Thanks. I upgraded and updated everything and got a better result.
>> 
>> Does that mean that you get a sensible lambda for your model now - the line 
>> search leads somewhere other than a boundary of the interval?
>
> I apologize for being unclear. I actually upgraded R and updated packages, 
> then ran errorsarlm with method="Matrix" and got the same error messages I'd 
> had previously (i.e., the search led to the boundary of the interval). I then 
> tried your other suggestion and used method="spam" and got a result with no 
> error messages.

But we do not know why the two are not the same (they should be), so I 
would still not trust the outcome. I would be interested in off-list 
access to the data being used - I think that there is some issue with the 
scaling of the variable values. Do you see the same difference using 
spautolm(), which is effectively the same as errorsarlm(), but with a 
different internal structure?

> 
>> >  However, I'm not 100% sure that I'm using the correct command to 
>> >  accomplish what I need to accomplish. My OLS model has significant 
>> >  spatial autocorrelation (RLMlag is not significant and RLMerror is) and 
>> >  heteroscedasticity. I had hoped to use errorsarlm then run White's 
>> >  standard errors to address this, but I find that hccm(car) requires a 
>> >  .lm object. Looking through old threads, I found one that suggests using 
>> >  spautolm is such situations. Does spautolm address both spatial 
>> >  autocorrelation and heteroscedasticity?
>> 
>> There are different traditions. Econometricians and some others in social 
>> science try to trick the standard errors by "magic", while epidemiologists 
>> (and crime people) typically use case weights - that is model the 
>> heteroscedasticity directly. spautolm() can include such case weights. I 
>> don't think that there is any substantive and reliable theory for adjusting 
>> the SE, that is theory that doesn't appeal to assumptions we already know 
>> don't hold. Sampling from the posterior gives a handle on this, but is not 
>> simple, and doesn't really suit 10K observations.
>> 
> Can you explain "magic" a little further? I'm running this for a professor 
> who is a bit nervous about black box techniques and I'd like to be able to 
> offer him a good explanation. I think he'll just have me calculate White's 
> standard errors and ignore spatial autocorrelation if I can't be clearer.
>

If this is all your "professor" can manage, please replace/educate! The 
model is fundamentally misspecified, and neither "magicing" the standard 
errors, nor just fitting a simultaneous autoregressive error model will 
let you make fair decisions on the "significance" or otherwise of the 
right-hand side variables, which I suppose is the object of the exercise?

(Looking at Johnston & DiNardo (1997), pp. 164-166, it looks as if White's 
SE only help asymptotically (in Prof. Ripley's well-known remark, 
asymptotics are a foreign country with spatial data), and not in finite 
samples, and their performance is unknown if the residuals are 
autocorrelated, which is the case here).

The vast number of observations is no help either, because they certainly 
introduce heterogeneity that has not been controlled for. Is this a grid 
of global species occurrence data, by any chance? Which RHS variables are 
covering for differences in environmental drivers? Or is there a better 
reason for using many observations (instead of careful data collection) 
than just their being available?

More observations do not mean more information if meaningful differences 
across the observations are not captured by included variables (with the 
correct functional form). Have you tried GAM with flexible functional 
forms on the RHS variables and s(x,y) on the (point) locations of the 
observations?

You are not alone in your plight, but if the inferences matter, then it's 
better to be cautious, irrespective of the "professor".

Roger

> Thanks again.
>
> Heather
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From E.O.Folmer at rug.nl  Thu May 22 17:12:23 2008
From: E.O.Folmer at rug.nl (Eelke Folmer)
Date: Thu, 22 May 2008 17:12:23 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal with
	missing values in predictor variables
Message-ID: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080522/fcc6ef7e/attachment.pl>

From evans324 at umn.edu  Thu May 22 18:24:48 2008
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 22 May 2008 11:24:48 -0500
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0805221124480.6321@wm0.tc.umn.edu>

On May 22 2008, Roger Bivand wrote:

>>> Does that mean that you get a sensible lambda for your model now - the 
>>> line search leads somewhere other than a boundary of the interval?
>>
>> I apologize for being unclear. I actually upgraded R and updated 
>> packages, then ran errorsarlm with method="Matrix" and got the same 
>> error messages I'd had previously (i.e., the search led to the boundary 
>> of the interval). I then tried your other suggestion and used 
>> method="spam" and got a result with no error messages.
>
>But we do not know why the two are not the same (they should be), so I 
>would still not trust the outcome. I would be interested in off-list 
>access to the data being used - I think that there is some issue with the 
>scaling of the variable values. Do you see the same difference using 
>spautolm(), which is effectively the same as errorsarlm(), but with a 
>different internal structure?

I do see the same difference using spautolm() and get no error messages 
using it. I'll send you then data separately and would appreciate your 
opinion on them.

>>> There are different traditions. Econometricians and some others in 
>>> social science try to trick the standard errors by "magic", while 
>>> epidemiologists (and crime people) typically use case weights - that is 
>>> model the heteroscedasticity directly. spautolm() can include such case 
>>> weights. I don't think that there is any substantive and reliable 
>>> theory for adjusting the SE, that is theory that doesn't appeal to 
>>> assumptions we already know don't hold. Sampling from the posterior 
>>> gives a handle on this, but is not simple, and doesn't really suit 10K 
>>> observations.
>>> 
>> Can you explain "magic" a little further? I'm running this for a 
>> professor who is a bit nervous about black box techniques and I'd like 
>> to be able to offer him a good explanation. I think he'll just have me 
>> calculate White's standard errors and ignore spatial autocorrelation if 
>> I can't be clearer.
>>
>
>If this is all your "professor" can manage, please replace/educate! The 
>model is fundamentally misspecified, and neither "magicing" the standard 
>errors, nor just fitting a simultaneous autoregressive error model will 
>let you make fair decisions on the "significance" or otherwise of the 
>right-hand side variables, which I suppose is the object of the exercise?
>
I agree here, but haven't been able to get much advice on this. I 
appreciate your input.

>(Looking at Johnston & DiNardo (1997), pp. 164-166, it looks as if White's 
>SE only help asymptotically (in Prof. Ripley's well-known remark, 
>asymptotics are a foreign country with spatial data), and not in finite 
>samples, and their performance is unknown if the residuals are 
>autocorrelated, which is the case here).

>The vast number of observations is no help either, because they certainly 
>introduce heterogeneity that has not been controlled for. Is this a grid 
>of global species occurrence data, by any chance? Which RHS variables are 
>covering for differences in environmental drivers? Or is there a better 
>reason for using many observations (instead of careful data collection) 
>than just their being available?
>
This is a hedonic regression with a goal of eliciting economic values for 
different percentages of tree cover on parcels and in the local 
neighborhood as capitalized in home sale prices. We're using all 2005 
residential sales from Ramsey and Dakota counties in Minnesota, USA as our 
observations. This gives us sales from most study area regions and for all 
months. I'll send you a description of the RHS variables with the dataset.

>More observations do not mean more information if meaningful differences 
>across the observations are not captured by included variables (with the 
>correct functional form). Have you tried GAM with flexible functional 
>forms on the RHS variables and s(x,y) on the (point) locations of the 
>observations?

I haven't tried this, but will look into it.  

>You are not alone in your plight, but if the inferences matter, then it's 
>better to be cautious, irrespective of the "professor".
>
Thanks very much for your help.

Regards,
Heather

--- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA



From macq at llnl.gov  Thu May 22 18:39:00 2008
From: macq at llnl.gov (Don MacQueen)
Date: Thu, 22 May 2008 09:39:00 -0700
Subject: [R-sig-Geo] Problem activating manageR
In-Reply-To: <48820.142.104.193.193.1210748996.squirrel@wm3.uvic.ca>
References: <48820.142.104.193.193.1210748996.squirrel@wm3.uvic.ca>
Message-ID: <p0623090ac45b4bfa3947@[128.115.92.33]>

Carson,

I decided to try manageR and ran into a problem. It appears to be 
specific to Mac OS X, but I'm hoping you or someone on this list will 
be able to help. It installs correctly, as far as I can tell, but 
does not activate.

When I go activate manageR  using the QGis plugin manager, I get this:

Couldn't load plugin "manageR" from 
['/Users/macq/.qgis//python/plugins', 
'/Applications/qgis0.10.0.app/Contents/MacOS/share/qgis/python', 
'/Applications/qgis0.10.0.app/Contents/MacOS/share/qgis/python/plugins', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python23.zip', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-darwin', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-mac', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-mac/lib-scriptpackages', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/lib-tk', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/lib-dynload', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/site-packages', 
'/System/Library/Frameworks/Python.framework/Versions/2.3/Extras/lib/python'] 
Traceback (most recent call last):
  File "", line 3, in ?
  File "/Users/macq/.qgis//python/plugins/manageR/__init__.py", line 35, in ?
   from manageR import manageRPlugin ImportError: cannot import name 
manageRPlugin


Note that version 2.3 of python is being searched, within /System/Library/...

QGis itself requires a newer version of python than comes with the OS.
The OS X binary installer for Qgis installes python 2.5 in
     /Library/Frameworks
*** not *** /System/Library
Which means that I now have two versions of python installed.

It looks like there's a search path that is searching the wrong 
python installation, so maybe the wrong python is being used to load 
the plugin??

But I don't know where that search path is defined or controlled. Any 
suggestions will be appreciated

Thanks
-Don


p.s.
With regard to having two versions of python:

python[118]% which python
/usr/local/bin/python
python[119]% python --version
Python 2.5.1
python[120]% /usr/bin/python -V
Python 2.3.5

And /usr/local/bin/python is actually a link to the python in 
/Library/... (not /System/Library/....)

I did downloaded and installed NumPy and Rpy, and a few tests succeeded.

At 12:09 AM -0700 5/14/08, cfarmer wrote:
>Hello lists,
>
>For those of you who are interested, a new version of manageR is now
>available at http://www.geog.uvic.ca/spar/carson/ or via
>http://www.geog.uvic.ca/spar/carson/cfarmerQgisRepo.xml from the QGIS
>python plugin installer.
>
>This latest release includes a few big fixes, the ability (hopefully?!) to
>check all libPaths for installed packages, and the ability to
>automatically write sp objects to file and load them in QGIS. This was a
>pretty quick update, so please feel free to push the plugin to the limits,
>and let me know what the outcome is...
>
>Cheers,
>
>Carson
>
>Spatial Pattern Analysis & Research Lab (SPAR)
>Department of Geography, University of Victoria
>www.geog.uvic.ca/spar/carson
>cfarmer at uvic.ca
>
>
>_______________________________________________
>Qgis-user mailing list
>Qgis-user at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/qgis-user


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062



From Roger.Bivand at nhh.no  Thu May 22 18:42:07 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 May 2008 18:42:07 +0200 (CEST)
Subject: [R-sig-Geo] Sampling SpatialPolygonDataFrame attributes from
 points in a grid..
In-Reply-To: <2537.71.102.158.88.1211437783.squirrel@webmail.nceas.ucsb.edu>
References: <2537.71.102.158.88.1211437783.squirrel@webmail.nceas.ucsb.edu>
Message-ID: <Pine.LNX.4.64.0805221625050.10591@reclus.nhh.no>

On Wed, 21 May 2008, reeves at nceas.ucsb.edu wrote:

>
> Greetings:
>
> I'd like to get some advice on performing this task:
>
>
> Given a SpatialPolygonsDataFrame, and a regularly-spaced point grid
> created 'over' the polygons using spsample() or similar method, how
> to extract one attribute from the polygon 'beneath' the location of
> each point in the grid, and then assign the computed attribute to
> the point? Best end product would be a SpatialPointsDataFrame.
>
> The next step would be to replace the attribute of all points corresponding
> to each polygon with a weighted average of all the point subset's attribute
> value.
>
> I am reviewing the spsample() and overlay() methods, which look like
> good candidates for this task. But perhaps there is a better way.
>
> Can someone direct me to a sample solution to a similar task,
> for example, a vector polygon to raster grid conversion?

I have a feeling of uncertainty about the relative resolutions of the grid 
and the polygons, how many points per polygon do you expect to see?

library(maptools)
fn <- system.file("shapes/sids.shp", package="maptools")[1]
p4s <- CRS("+proj=longlat +ellps=clrk66")
xx <- readShapePoly(fn, IDvar="FIPSNO", proj4string=p4s)
xxG <- Sobj_SpatialGrid(xx, n=10000)
o <- overlay(xxG, xx)
zz <- as(xx, "data.frame")[o,]
xxSGDF <- SpatialGridDataFrame(slot(xxG, "grid"),
   proj4string=CRS(proj4string(xxG)), data=zz)
summary(xxSGDF)

Going the other way, you can use tapply() using o to form ragged arrays, 
for example, say to take median grid values by polygon. If you could 
illustrate using this or another available case, it would help.

Roger


>
> Thanks in advance,
> Rick Reeves
> NCEAS
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu May 22 20:08:10 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 May 2008 20:08:10 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Prayer.1.0.16.0805221124480.6321@wm0.tc.umn.edu>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>
	<Prayer.1.0.16.0805221124480.6321@wm0.tc.umn.edu>
Message-ID: <Pine.LNX.4.64.0805221944520.10591@reclus.nhh.no>

On Thu, 22 May 2008, evans324 at umn.edu wrote:

> On May 22 2008, Roger Bivand wrote:
>
>> > >  Does that mean that you get a sensible lambda for your model now - the 
>> > >  line search leads somewhere other than a boundary of the interval?
>> > 
>> >  I apologize for being unclear. I actually upgraded R and updated 
>> >  packages, then ran errorsarlm with method="Matrix" and got the same 
>> >  error messages I'd had previously (i.e., the search led to the boundary 
>> >  of the interval). I then tried your other suggestion and used 
>> >  method="spam" and got a result with no error messages.
>> 
>> But we do not know why the two are not the same (they should be), so I 
>> would still not trust the outcome. I would be interested in off-list access 
>> to the data being used - I think that there is some issue with the scaling 
>> of the variable values. Do you see the same difference using spautolm(), 
>> which is effectively the same as errorsarlm(), but with a different 
>> internal structure?
>
> I do see the same difference using spautolm() and get no error messages using 
> it. I'll send you then data separately and would appreciate your opinion on 
> them.

Heather:

OK, thanks. On first inspection, the choice of a distance criterion for 
neighbours seems to be part of the problem. Using:

nb_k5 <- knn2nb(knearneigh(coordinates(rd), k=5))
nb_k5s <- make.sym.nb(nb_k5)

where rd is the SpatialPointsDataFrame object, with many fewer neighbours 
than your 2500m or 3000m criteria, gives results from "Matrix" and "spam" 
that are identical, and most likely what you are after. These weights are 
the 5 nearest neighbours coerced to symmetric, so all ahave 5 neighbours 
and the largest number of neighbours is 12 (your 2500m criterion had a 
mean number of neighbours of 280, maximum 804). If you can live without 
your choice of neighbours (which in some settings may be getting pretty 
close to your market segment dummies), I'd advise using something much 
sparser (but symmetric). The sparser weights matrices also increase the 
speed dramatically.

If you look at the bottom of ?bptest.sarlm, you'll see a cheap and totally 
untested way of adjusting the output SEs, but please don't believe what it 
does, because it is treating the lambda value as known, not estimated. A 
guess at the remaining heterogeneity would be age by maintenance 
interaction, older houses will vary in value by maintenance, probably also 
by neighbourhood?

Hope this helps,

Roger
>
>> > >  There are different traditions. Econometricians and some others in 
>> > >  social science try to trick the standard errors by "magic", while 
>> > >  epidemiologists (and crime people) typically use case weights - that 
>> > >  is model the heteroscedasticity directly. spautolm() can include such 
>> > >  case weights. I don't think that there is any substantive and reliable 
>> > >  theory for adjusting the SE, that is theory that doesn't appeal to 
>> > >  assumptions we already know don't hold. Sampling from the posterior 
>> > >  gives a handle on this, but is not simple, and doesn't really suit 10K 
>> > >  observations.
>> > > 
>> >  Can you explain "magic" a little further? I'm running this for a 
>> >  professor who is a bit nervous about black box techniques and I'd like 
>> >  to be able to offer him a good explanation. I think he'll just have me 
>> >  calculate White's standard errors and ignore spatial autocorrelation if 
>> >  I can't be clearer.
>> > 
>> 
>> If this is all your "professor" can manage, please replace/educate! The 
>> model is fundamentally misspecified, and neither "magicing" the standard 
>> errors, nor just fitting a simultaneous autoregressive error model will let 
>> you make fair decisions on the "significance" or otherwise of the 
>> right-hand side variables, which I suppose is the object of the exercise?
>> 
> I agree here, but haven't been able to get much advice on this. I appreciate 
> your input.
>
>> (Looking at Johnston & DiNardo (1997), pp. 164-166, it looks as if White's 
>> SE only help asymptotically (in Prof. Ripley's well-known remark, 
>> asymptotics are a foreign country with spatial data), and not in finite 
>> samples, and their performance is unknown if the residuals are 
>> autocorrelated, which is the case here).
>
>> The vast number of observations is no help either, because they certainly 
>> introduce heterogeneity that has not been controlled for. Is this a grid of 
>> global species occurrence data, by any chance? Which RHS variables are 
>> covering for differences in environmental drivers? Or is there a better 
>> reason for using many observations (instead of careful data collection) 
>> than just their being available?
>> 
> This is a hedonic regression with a goal of eliciting economic values for 
> different percentages of tree cover on parcels and in the local neighborhood 
> as capitalized in home sale prices. We're using all 2005 residential sales 
> from Ramsey and Dakota counties in Minnesota, USA as our observations. This 
> gives us sales from most study area regions and for all months. I'll send you 
> a description of the RHS variables with the dataset.
>
>> More observations do not mean more information if meaningful differences 
>> across the observations are not captured by included variables (with the 
>> correct functional form). Have you tried GAM with flexible functional forms 
>> on the RHS variables and s(x,y) on the (point) locations of the 
>> observations?
>
> I haven't tried this, but will look into it. 
>> You are not alone in your plight, but if the inferences matter, then it's 
>> better to be cautious, irrespective of the "professor".
>> 
> Thanks very much for your help.
>
> Regards,
> Heather
>
> --- Heather Sander
> Ph.D. Candidate:  Conservation Biology
> Office:  305 Ecology & 420 Blegen
> Mail:  University of Minnesota
> Dept. of Geography
> 414 Social Science Bldg.
> 267 19th Ave. S.
> Minneapolis, MN 55455
> USA
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri May 23 08:42:56 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 May 2008 08:42:56 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805221944520.10591@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>
	<Prayer.1.0.16.0805221124480.6321@wm0.tc.umn.edu>
	<Pine.LNX.4.64.0805221944520.10591@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0805230830050.29071@reclus.nhh.no>

On Thu, 22 May 2008, Roger Bivand wrote:

> On Thu, 22 May 2008, evans324 at umn.edu wrote:
>
>>  On May 22 2008, Roger Bivand wrote:
>> 
>> > > >   Does that mean that you get a sensible lambda for your model now - 
>> > > >   the line search leads somewhere other than a boundary of the 
>> > > >   interval?
>> > > 
>> > >   I apologize for being unclear. I actually upgraded R and updated 
>> > >   packages, then ran errorsarlm with method="Matrix" and got the same 
>> > >   error messages I'd had previously (i.e., the search led to the 
>> > >   boundary of the interval). I then tried your other suggestion and 
>> > >   used method="spam" and got a result with no error messages.
>> > 
>> >  But we do not know why the two are not the same (they should be), so I 
>> >  would still not trust the outcome. I would be interested in off-list 
>> >  access to the data being used - I think that there is some issue with 
>> >  the scaling of the variable values. Do you see the same difference using 
>> >  spautolm(), which is effectively the same as errorsarlm(), but with a 
>> >  different internal structure?
>>
>>  I do see the same difference using spautolm() and get no error messages
>>  using it. I'll send you then data separately and would appreciate your
>>  opinion on them.

To close the part of the thread about differences between the spam and 
Matrix methods, I can report that on Linux (both 2GB and 1GB 32-bit), 
there is no difference for the original model using the 2500m distance 
criterion, and both line searches reach a lambda of 0.9165158. The same 
applies to Windows 32-bit. R version 2.7.0 using R-generic BLAS, spdep 
0.4-21, Matrix 0.999375-9, spam 0.13-3, in all cases.

The sparser weights cases described below run with adequate speed, but the 
semi-dense weights (average # neighbours 280) run more slowly, but the 
time is mostly spent in making sure that the weights are exactly symmetric 
- now in R functions similar.listw() and listw2U(), both of which will be 
re-written to hand out the time consuming parts to compiled C.

The data were 10055 house prices, the objective to fit a hedonic 
regression. Conclusion: using a more sparse neighbour representation is 
advisable; the computational problems could not be reproduced, but looked 
initially like a package version issue - Matrix is moving fast, and spdep 
is trying to keep up with it.

Roger

>
> Heather:
>
> OK, thanks. On first inspection, the choice of a distance criterion for 
> neighbours seems to be part of the problem. Using:
>
> nb_k5 <- knn2nb(knearneigh(coordinates(rd), k=5))
> nb_k5s <- make.sym.nb(nb_k5)
>
> where rd is the SpatialPointsDataFrame object, with many fewer neighbours 
> than your 2500m or 3000m criteria, gives results from "Matrix" and "spam" 
> that are identical, and most likely what you are after. These weights are the 
> 5 nearest neighbours coerced to symmetric, so all ahave 5 neighbours and the 
> largest number of neighbours is 12 (your 2500m criterion had a mean number of 
> neighbours of 280, maximum 804). If you can live without your choice of 
> neighbours (which in some settings may be getting pretty close to your market 
> segment dummies), I'd advise using something much sparser (but symmetric). 
> The sparser weights matrices also increase the speed dramatically.
>
> If you look at the bottom of ?bptest.sarlm, you'll see a cheap and totally 
> untested way of adjusting the output SEs, but please don't believe what it 
> does, because it is treating the lambda value as known, not estimated. A 
> guess at the remaining heterogeneity would be age by maintenance interaction, 
> older houses will vary in value by maintenance, probably also by 
> neighbourhood?
>
> Hope this helps,
>
> Roger
>> 
>> > > >   There are different traditions. Econometricians and some others in 
>> > > >   social science try to trick the standard errors by "magic", while 
>> > > >   epidemiologists (and crime people) typically use case weights - 
>> > > >   that is model the heteroscedasticity directly. spautolm() can 
>> > > >   include such case weights. I don't think that there is any 
>> > > >   substantive and reliable theory for adjusting the SE, that is 
>> > > >   theory that doesn't appeal to assumptions we already know don't 
>> > > >   hold. Sampling from the posterior gives a handle on this, but is 
>> > > >   not simple, and doesn't really suit 10K observations.
>> > > > 
>> > >   Can you explain "magic" a little further? I'm running this for a 
>> > >   professor who is a bit nervous about black box techniques and I'd 
>> > >   like to be able to offer him a good explanation. I think he'll just 
>> > >   have me calculate White's standard errors and ignore spatial 
>> > >   autocorrelation if I can't be clearer.
>> > > 
>> > 
>> >  If this is all your "professor" can manage, please replace/educate! The 
>> >  model is fundamentally misspecified, and neither "magicing" the standard 
>> >  errors, nor just fitting a simultaneous autoregressive error model will 
>> >  let you make fair decisions on the "significance" or otherwise of the 
>> >  right-hand side variables, which I suppose is the object of the 
>> >  exercise?
>> >
>>  I agree here, but haven't been able to get much advice on this. I
>>  appreciate your input.
>> 
>> >  (Looking at Johnston & DiNardo (1997), pp. 164-166, it looks as if 
>> >  White's SE only help asymptotically (in Prof. Ripley's well-known 
>> >  remark, asymptotics are a foreign country with spatial data), and not in 
>> >  finite samples, and their performance is unknown if the residuals are 
>> >  autocorrelated, which is the case here).
>> 
>> >  The vast number of observations is no help either, because they 
>> >  certainly introduce heterogeneity that has not been controlled for. Is 
>> >  this a grid of global species occurrence data, by any chance? Which RHS 
>> >  variables are covering for differences in environmental drivers? Or is 
>> >  there a better reason for using many observations (instead of careful 
>> >  data collection) than just their being available?
>> >
>>  This is a hedonic regression with a goal of eliciting economic values for
>>  different percentages of tree cover on parcels and in the local
>>  neighborhood as capitalized in home sale prices. We're using all 2005
>>  residential sales from Ramsey and Dakota counties in Minnesota, USA as our
>>  observations. This gives us sales from most study area regions and for all
>>  months. I'll send you a description of the RHS variables with the dataset.
>> 
>> >  More observations do not mean more information if meaningful differences 
>> >  across the observations are not captured by included variables (with the 
>> >  correct functional form). Have you tried GAM with flexible functional 
>> >  forms on the RHS variables and s(x,y) on the (point) locations of the 
>> >  observations?
>>
>>  I haven't tried this, but will look into it. 
>> >  You are not alone in your plight, but if the inferences matter, then 
>> >  it's better to be cautious, irrespective of the "professor".
>> >
>>  Thanks very much for your help.
>>
>>  Regards,
>>  Heather
>>
>>  --- Heather Sander
>>  Ph.D. Candidate:  Conservation Biology
>>  Office:  305 Ecology & 420 Blegen
>>  Mail:  University of Minnesota
>>  Dept. of Geography
>>  414 Social Science Bldg.
>>  267 19th Ave. S.
>>  Minneapolis, MN 55455
>>  USA
>> 
>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri May 23 09:01:38 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 May 2008 09:01:38 +0200 (CEST)
Subject: [R-sig-Geo] error message when running errorsarlm
In-Reply-To: <Pine.LNX.4.64.0805230830050.29071@reclus.nhh.no>
References: <Prayer.1.0.16.0805201204020.15160@wm2.tc.umn.edu>
	<Pine.LNX.4.64.0805221026500.32142@reclus.nhh.no>
	<Prayer.1.0.16.0805221124480.6321@wm0.tc.umn.edu>
	<Pine.LNX.4.64.0805221944520.10591@reclus.nhh.no>
	<Pine.LNX.4.64.0805230830050.29071@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0805230844540.29071@reclus.nhh.no>

On Fri, 23 May 2008, Roger Bivand wrote:

> On Thu, 22 May 2008, Roger Bivand wrote:
>
>>  On Thu, 22 May 2008, evans324 at umn.edu wrote:
>> 
>> >   On May 22 2008, Roger Bivand wrote:
>> > 
>> > > > >    Does that mean that you get a sensible lambda for your model now 
>> > > > >    - the line search leads somewhere other than a boundary of the 
>> > > > >    interval?
>> > > > 
>> > > >    I apologize for being unclear. I actually upgraded R and updated 
>> > > >    packages, then ran errorsarlm with method="Matrix" and got the 
>> > > >    same error messages I'd had previously (i.e., the search led to 
>> > > >    the boundary of the interval). I then tried your other suggestion 
>> > > >    and used method="spam" and got a result with no error messages.
>> > > 
>> > >   But we do not know why the two are not the same (they should be), so 
>> > >   I would still not trust the outcome. I would be interested in 
>> > >   off-list access to the data being used - I think that there is some 
>> > >   issue with the scaling of the variable values. Do you see the same 
>> > >   difference using spautolm(), which is effectively the same as 
>> > >   errorsarlm(), but with a different internal structure?
>> > 
>> >   I do see the same difference using spautolm() and get no error messages
>> >   using it. I'll send you then data separately and would appreciate your
>> >   opinion on them.
>
> To close the part of the thread about differences between the spam and Matrix 
> methods, I can report that on Linux (both 2GB and 1GB 32-bit), there is no 
> difference for the original model using the 2500m distance criterion, and 
> both line searches reach a lambda of 0.9165158. The same applies to Windows 
> 32-bit. R version 2.7.0 using R-generic BLAS, spdep 0.4-21, Matrix 
> 0.999375-9, spam 0.13-3, in all cases.
>
> The sparser weights cases described below run with adequate speed, but the 
> semi-dense weights (average # neighbours 280) run more slowly, but the time 
> is mostly spent in making sure that the weights are exactly symmetric - now 
> in R functions similar.listw() and listw2U(), both of which will be 
> re-written to hand out the time consuming parts to compiled C.
>
> The data were 10055 house prices, the objective to fit a hedonic regression. 
> Conclusion: using a more sparse neighbour representation is advisable; the 
> computational problems could not be reproduced, but looked initially like a 
> package version issue - Matrix is moving fast, and spdep is trying to keep up 
> with it.

Sorry, to put the record straight, finally, I hope - I can provoke similar 
error messages under Windows when either spam or Matrix methods are unable 
to allocate memory - usually the error messages returned from inside spam 
and Matrix are not informative, as the ones initially seen (things like 
"no function to return from, jumping to top level"). I just managed to 
reproduce this with spam on the 1GB Windows machine.

This is happening when the sparse package functions bail out because of 
difficulties allocating memory, but instead of terminating the line 
search, it continues to batter its head on one end of the interval. I'll 
try to make the functions behave more sensitively - which is not easy, 
because the sparse package functions can fail for a number of reasons, 
like lambda leaving its range, that are acceptable, or running out of 
memory on Windows, which isn't. On Linux 1GB, the underlying better memory 
management systems seem to protect us from this infelicity.

The base conclusion remain the same - weights should really be sparse, so 
do look at the output of the print method for neighbour objects! Neither 
method has any trouble with really sparse weights for this size of data 
set.

Roger

>
> Roger
>
>>
>>  Heather:
>>
>>  OK, thanks. On first inspection, the choice of a distance criterion for
>>  neighbours seems to be part of the problem. Using:
>>
>>  nb_k5 <- knn2nb(knearneigh(coordinates(rd), k=5))
>>  nb_k5s <- make.sym.nb(nb_k5)
>>
>>  where rd is the SpatialPointsDataFrame object, with many fewer neighbours
>>  than your 2500m or 3000m criteria, gives results from "Matrix" and "spam"
>>  that are identical, and most likely what you are after. These weights are
>>  the 5 nearest neighbours coerced to symmetric, so all ahave 5 neighbours
>>  and the largest number of neighbours is 12 (your 2500m criterion had a
>>  mean number of neighbours of 280, maximum 804). If you can live without
>>  your choice of neighbours (which in some settings may be getting pretty
>>  close to your market segment dummies), I'd advise using something much
>>  sparser (but symmetric). The sparser weights matrices also increase the
>>  speed dramatically.
>>
>>  If you look at the bottom of ?bptest.sarlm, you'll see a cheap and totally
>>  untested way of adjusting the output SEs, but please don't believe what it
>>  does, because it is treating the lambda value as known, not estimated. A
>>  guess at the remaining heterogeneity would be age by maintenance
>>  interaction, older houses will vary in value by maintenance, probably also
>>  by neighbourhood?
>>
>>  Hope this helps,
>>
>>  Roger
>> > 
>> > > > >    There are different traditions. Econometricians and some others 
>> > > > >    in social science try to trick the standard errors by "magic", 
>> > > > >    while epidemiologists (and crime people) typically use case 
>> > > > >    weights - that is model the heteroscedasticity directly. 
>> > > > >    spautolm() can include such case weights. I don't think that 
>> > > > >    there is any substantive and reliable theory for adjusting the 
>> > > > >    SE, that is theory that doesn't appeal to assumptions we already 
>> > > > >    know don't hold. Sampling from the posterior gives a handle on 
>> > > > >    this, but is not simple, and doesn't really suit 10K 
>> > > > >    observations.
>> > > > > 
>> > > >    Can you explain "magic" a little further? I'm running this for a 
>> > > >    professor who is a bit nervous about black box techniques and I'd 
>> > > >    like to be able to offer him a good explanation. I think he'll 
>> > > >    just have me calculate White's standard errors and ignore spatial 
>> > > >    autocorrelation if I can't be clearer.
>> > > > 
>> > > 
>> > >   If this is all your "professor" can manage, please replace/educate! 
>> > >   The model is fundamentally misspecified, and neither "magicing" the 
>> > >   standard errors, nor just fitting a simultaneous autoregressive error 
>> > >   model will let you make fair decisions on the "significance" or 
>> > >   otherwise of the right-hand side variables, which I suppose is the 
>> > >   object of the exercise?
>> > > 
>> >   I agree here, but haven't been able to get much advice on this. I
>> >   appreciate your input.
>> > 
>> > >   (Looking at Johnston & DiNardo (1997), pp. 164-166, it looks as if 
>> > >   White's SE only help asymptotically (in Prof. Ripley's well-known 
>> > >   remark, asymptotics are a foreign country with spatial data), and not 
>> > >   in finite samples, and their performance is unknown if the residuals 
>> > >   are autocorrelated, which is the case here).
>> > 
>> > >   The vast number of observations is no help either, because they 
>> > >   certainly introduce heterogeneity that has not been controlled for. 
>> > >   Is this a grid of global species occurrence data, by any chance? 
>> > >   Which RHS variables are covering for differences in environmental 
>> > >   drivers? Or is there a better reason for using many observations 
>> > >   (instead of careful data collection) than just their being available?
>> > > 
>> >   This is a hedonic regression with a goal of eliciting economic values 
>> >   for
>> >   different percentages of tree cover on parcels and in the local
>> >   neighborhood as capitalized in home sale prices. We're using all 2005
>> >   residential sales from Ramsey and Dakota counties in Minnesota, USA as 
>> >   our
>> >   observations. This gives us sales from most study area regions and for 
>> >   all
>> >   months. I'll send you a description of the RHS variables with the 
>> >   dataset.
>> > 
>> > >   More observations do not mean more information if meaningful 
>> > >   differences across the observations are not captured by included 
>> > >   variables (with the correct functional form). Have you tried GAM with 
>> > >   flexible functional forms on the RHS variables and s(x,y) on the 
>> > >   (point) locations of the observations?
>> > 
>> >   I haven't tried this, but will look into it. 
>> > >   You are not alone in your plight, but if the inferences matter, then 
>> > >   it's better to be cautious, irrespective of the "professor".
>> > > 
>> >   Thanks very much for your help.
>> > 
>> >   Regards,
>> >   Heather
>> > 
>> >   --- Heather Sander
>> >   Ph.D. Candidate:  Conservation Biology
>> >   Office:  305 Ecology & 420 Blegen
>> >   Mail:  University of Minnesota
>> >   Dept. of Geography
>> >   414 Social Science Bldg.
>> >   267 19th Ave. S.
>> >   Minneapolis, MN 55455
>> >   USA
>> > 
>> > 
>> > 
>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hzambran.newsgroups at gmail.com  Fri May 23 14:12:34 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Fri, 23 May 2008 14:12:34 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
Message-ID: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>

Dear List,

My question is about how to define the grid to be used for the
interpolations, using R 2.7.0 and gstat 0.9-47

I'm working in a catchment of ~3000 km2, with daily rainfall data of
several stations (more than 40), and I would like to interpolate daily
values within all the catchment using ordinary Kriging.

For defining the grid in which the interpolation will be carried out,
at the beginning, I tried with

#setting a grid each 100m vertical and horizontal
dx <- seq(674400,730700,by=100)
dy <- seq(4615100,4744400,by=100)
catch.grid <- expand.grid(dx,dy)

#setting the names of the columns of the grid
names(catch.grid) <- c("x","y")

#setting the coordinates of the grid
coordinates(catch.grid) <- ~x+y

#interpolating with the inverse distance
pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)

#plotting the interpolated values
spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")

but looking at the figure I realized that the interpolations were
carried out considering all the cells within the squared grid, and not
only within the catchment.

After, I tried reading a raster file (each 100m) and using it as the grid,

DEMM100m <- read.asciigrid("Catch_DEM_c100m")

but the results that I got seems to be wrong, because I got high
values where low values were expected and viceversa. (I really
appreciate any help clarifying me what I'm doing wrong )

Is there any way to define a grid, starting from a shapefile of the
catchment boundaries ?. For example, I would like to define something
similar to the "meuse.grid" dataset.

Thanks in advance and best regards

-- 
Mauricio

Linux user #454569 -- Ubuntu user #17469



From edzer.pebesma at uni-muenster.de  Fri May 23 15:02:58 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 23 May 2008 15:02:58 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
Message-ID: <4836C082.40208@uni-muenster.de>

Good question; the meuse example does not explain how to get meuse.grid.

The asciigrid file you have you should read with readGDAL in package 
rgdal, if that goes wrong I'd expect the problem in your data file.

Otherwise, if you have a shapefile with a polygon covering the 
catchment, called catch.pol, you'd want to use

sel = overlay(catch.pol, catch.grid)

The grid cells inside the polygon(s) are now found by

catch.sel = catch.grid[!is.na(sel)]
--
Edzer

Mauricio Zambrano wrote:
> Dear List,
>
> My question is about how to define the grid to be used for the
> interpolations, using R 2.7.0 and gstat 0.9-47
>
> I'm working in a catchment of ~3000 km2, with daily rainfall data of
> several stations (more than 40), and I would like to interpolate daily
> values within all the catchment using ordinary Kriging.
>
> For defining the grid in which the interpolation will be carried out,
> at the beginning, I tried with
>
> #setting a grid each 100m vertical and horizontal
> dx <- seq(674400,730700,by=100)
> dy <- seq(4615100,4744400,by=100)
> catch.grid <- expand.grid(dx,dy)
>
> #setting the names of the columns of the grid
> names(catch.grid) <- c("x","y")
>
> #setting the coordinates of the grid
> coordinates(catch.grid) <- ~x+y
>
> #interpolating with the inverse distance
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>
> #plotting the interpolated values
> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>
> but looking at the figure I realized that the interpolations were
> carried out considering all the cells within the squared grid, and not
> only within the catchment.
>
> After, I tried reading a raster file (each 100m) and using it as the grid,
>
> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>
> but the results that I got seems to be wrong, because I got high
> values where low values were expected and viceversa. (I really
> appreciate any help clarifying me what I'm doing wrong )
>
> Is there any way to define a grid, starting from a shapefile of the
> catchment boundaries ?. For example, I would like to define something
> similar to the "meuse.grid" dataset.
>
> Thanks in advance and best regards
>
>



From Friderike.Oehler at fao.org  Fri May 23 15:12:48 2008
From: Friderike.Oehler at fao.org (Oehler, Friderike (AGPP))
Date: Fri, 23 May 2008 15:12:48 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
Message-ID: <1A28265B00AA7E4085BB761555D3FCE8016AF842@hqagex02.fao.org>

Dear Mauricio,

with some help of Dr. Rossiter, I once created a grid covering my study area
by importing a vector file delimiting the borders of the area and overlaying
it over the expanded grid:

# import the vector shape-file
area=readShapePoly('/.../my_area')

# in case that the vector file includes various polygons: extract from these
only the polygon you want to use for your grid, for instance: 
area at data
levels(area$data1)
area[area$data1=='catchment',] -> catchment

# set up a fitting grid
grid <- expand.grid(x = seq(674400,730700,by=100), y =
seq(4615100,4744400,by=100))
coordinates(grid) <- c("x", "y")
catch.coor <- overlay(grid,catchment)
str(catch.coor)
catch.grid <- grid[!is.na(catch.coor),]
summary(catch.grid)
plot(catch.grid)

In case that you have a vector file of your catchment available, or can
create one, maybe this helps. However, the more experienced gstat users or
developers certainly know better advice.

Cheers, Friderike



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Mauricio Zambrano
Sent: 23 May 2008 14:13
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Defining a grid for interpolations ?


Dear List,

My question is about how to define the grid to be used for the
interpolations, using R 2.7.0 and gstat 0.9-47

I'm working in a catchment of ~3000 km2, with daily rainfall data of several
stations (more than 40), and I would like to interpolate daily values within
all the catchment using ordinary Kriging.

For defining the grid in which the interpolation will be carried out, at the
beginning, I tried with

#setting a grid each 100m vertical and horizontal
dx <- seq(674400,730700,by=100)
dy <- seq(4615100,4744400,by=100)
catch.grid <- expand.grid(dx,dy)

#setting the names of the columns of the grid
names(catch.grid) <- c("x","y")

#setting the coordinates of the grid
coordinates(catch.grid) <- ~x+y

#interpolating with the inverse distance
pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)

#plotting the interpolated values
spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")

but looking at the figure I realized that the interpolations were carried out
considering all the cells within the squared grid, and not only within the
catchment.

After, I tried reading a raster file (each 100m) and using it as the grid,

DEMM100m <- read.asciigrid("Catch_DEM_c100m")

but the results that I got seems to be wrong, because I got high values where
low values were expected and viceversa. (I really appreciate any help
clarifying me what I'm doing wrong )

Is there any way to define a grid, starting from a shapefile of the catchment
boundaries ?. For example, I would like to define something similar to the
"meuse.grid" dataset.

Thanks in advance and best regards

-- 
Mauricio

Linux user #454569 -- Ubuntu user #17469

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From wilbersa at armonia-bo.org  Fri May 23 15:54:24 2008
From: wilbersa at armonia-bo.org (Rodrigo W. Soria Auza)
Date: Fri, 23 May 2008 15:54:24 +0200
Subject: [R-sig-Geo] Dear Friends,
Message-ID: <4836CC90.6010407@armonia-bo.org>

Hi all,
I have a file (MOD06_auza_gridded_cldstats.bin) created by a college 
(Richard Frey). It is a binary written with FORTRAN in a little-endian 
(Linux) machine that contains a 400x300x84-bite integer array. The 400 
represents 1/20 degree cells in a N-S direction (7S-27S), 300 is 1/20 
degree cells in the E-W direction (55-70W). The 8 products in order for 
each of the 120000 cells:
1) Number retrievals
2) Yearly mean cloud fraction
3) Frequency of high, thick clouds
4) Frequency of thick clouds top temperatures <-65C
5) Same as # 4 but <-38C
6) Same as # 4 but <-12C
7) Center of cell latitude
8) Center of cell longitude
So as you can see is a multi layer file
Now neither Richard (the guy who made this file) nor I know how to 
import this kind of file into other GIS software, and I would like to 
know if somebody here could give us detailed instructions or advise to 
convert layer by layer into a common format (separate from each other. 
so we could manage every layer independently from the others), so we 
will be able to import them into other GIS software (Arcview or DIVA 
GIS) as raster (or grid) layers. (maybe ascii?).
I have a limited experience using R, but every day I learn a bit more 
and I think (actually hope) there is a package that is able to do this.
Sincerely,
Rodrigo


-------------- next part --------------
A non-text attachment was scrubbed...
Name: wilbersa.vcf
Type: text/x-vcard
Size: 309 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080523/2d440c9a/attachment.vcf>

From aloboaleu at gmail.com  Fri May 23 16:14:25 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Fri, 23 May 2008 16:14:25 +0200
Subject: [R-sig-Geo] Dear Friends,
In-Reply-To: <4836CC90.6010407@armonia-bo.org>
References: <4836CC90.6010407@armonia-bo.org>
Message-ID: <4836D141.4080208@gmail.com>

Hola Rodrigo,

Hice algo parecido para los quality flags de imagenes
Modis usando Matlab. Seguramente se puede hacer en R
(no se si tiene enteros de 4 bits; por cierto,
bite no puede ser, es bit o byte, yo entiendo
que son 4 bits; tambien deberias saber
si son signed o unsigned)
pero si nadie te da una buena respuesta escribeme
y nos miramos como lo hice en Matlab. Luego
escribimos en tif o lo que quieras.

Saludos,

Agus

Rodrigo W. Soria Auza wrote:
> Hi all,
> I have a file (MOD06_auza_gridded_cldstats.bin) created by a college 
> (Richard Frey). It is a binary written with FORTRAN in a little-endian 
> (Linux) machine that contains a 400x300x84-bite integer array. The 400 
> represents 1/20 degree cells in a N-S direction (7S-27S), 300 is 1/20 
> degree cells in the E-W direction (55-70W). The 8 products in order for 
> each of the 120000 cells:
> 1) Number retrievals
> 2) Yearly mean cloud fraction
> 3) Frequency of high, thick clouds
> 4) Frequency of thick clouds top temperatures <-65C
> 5) Same as # 4 but <-38C
> 6) Same as # 4 but <-12C
> 7) Center of cell latitude
> 8) Center of cell longitude
> So as you can see is a multi layer file
> Now neither Richard (the guy who made this file) nor I know how to 
> import this kind of file into other GIS software, and I would like to 
> know if somebody here could give us detailed instructions or advise to 
> convert layer by layer into a common format (separate from each other. 
> so we could manage every layer independently from the others), so we 
> will be able to import them into other GIS software (Arcview or DIVA 
> GIS) as raster (or grid) layers. (maybe ascii?).
> I have a limited experience using R, but every day I learn a bit more 
> and I think (actually hope) there is a package that is able to do this.
> Sincerely,
> Rodrigo
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From v.gomezrubio at imperial.ac.uk  Fri May 23 16:17:35 2008
From: v.gomezrubio at imperial.ac.uk (Virgilio Gomez-Rubio)
Date: Fri, 23 May 2008 15:17:35 +0100
Subject: [R-sig-Geo] Dear Friends,
In-Reply-To: <4836CC90.6010407@armonia-bo.org>
References: <4836CC90.6010407@armonia-bo.org>
Message-ID: <1211552255.5902.29.camel@fh-vrubio>

?Dear Rodrigo,

I believe that you can use 'readBin' to read from binary files in R. So
you should be able to read your data with R. Given that you have the
full information about the grid points at which your data was taken, it
should be possible to make a SpatialGrid with this information and put
all the data (grid + covariates) together in a SpatialGridDataFrame.

I am afraid that this may require a bit of programming (not much though)
and that there is probably no specific function to read your data as it
is.

Hope this helps,

Virgilio

On Fri, 2008-05-23 at 15:54 +0200, Rodrigo W. Soria Auza wrote:
> Hi all,
> I have a file (MOD06_auza_gridded_cldstats.bin) created by a college 
> (Richard Frey). It is a binary written with FORTRAN in a little-endian 
> (Linux) machine that contains a 400x300x84-bite integer array. The 400 
> represents 1/20 degree cells in a N-S direction (7S-27S), 300 is 1/20 
> degree cells in the E-W direction (55-70W). The 8 products in order for 
> each of the 120000 cells:
> 1) Number retrievals
> 2) Yearly mean cloud fraction
> 3) Frequency of high, thick clouds
> 4) Frequency of thick clouds top temperatures <-65C
> 5) Same as # 4 but <-38C
> 6) Same as # 4 but <-12C
> 7) Center of cell latitude
> 8) Center of cell longitude
> So as you can see is a multi layer file
> Now neither Richard (the guy who made this file) nor I know how to 
> import this kind of file into other GIS software, and I would like to 
> know if somebody here could give us detailed instructions or advise to 
> convert layer by layer into a common format (separate from each other. 
> so we could manage every layer independently from the others), so we 
> will be able to import them into other GIS software (Arcview or DIVA 
> GIS) as raster (or grid) layers. (maybe ascii?).
> I have a limited experience using R, but every day I learn a bit more 
> and I think (actually hope) there is a package that is able to do this.
> Sincerely,
> Rodrigo
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Fri May 23 16:22:44 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 May 2008 16:22:44 +0200 (CEST)
Subject: [R-sig-Geo] Dear Friends,
In-Reply-To: <4836CC90.6010407@armonia-bo.org>
References: <4836CC90.6010407@armonia-bo.org>
Message-ID: <Pine.LNX.4.64.0805231612380.30982@reclus.nhh.no>

On Fri, 23 May 2008, Rodrigo W. Soria Auza wrote:

> Hi all,
> I have a file (MOD06_auza_gridded_cldstats.bin) created by a college (Richard 
> Frey). It is a binary written with FORTRAN in a little-endian (Linux) machine 
> that contains a 400x300x84-bite integer array.

If you have access to the Fortran source code, use readBin() to read the 
chunks. I'm puzzled by the 84 bytes, because that suggests that each cell 
record contains more than 8 8-byte double precision numbers (which would 
be 64 bytes). So you need a more detailed description than you have now.

If you read the data into pre-allocated vectors (perhaps grouped in a 
list), thes can readily be converted to a data frame. This can be 
converted into a SpatialPointsDataFrame (class defiled in the sp package) 
and further to a SpatialGridDataFrame. This can then be exported using 
writeGDAL() in the rgdal package, to a range of different formats, defined 
by the drivers in your installed GDAL, see gdalDrivers() for the ones you 
have.

Roger

> The 400 represents 1/20 degree 
> cells in a N-S direction (7S-27S), 300 is 1/20 degree cells in the E-W 
> direction (55-70W). The 8 products in order for each of the 120000 cells:
> 1) Number retrievals
> 2) Yearly mean cloud fraction
> 3) Frequency of high, thick clouds
> 4) Frequency of thick clouds top temperatures <-65C
> 5) Same as # 4 but <-38C
> 6) Same as # 4 but <-12C
> 7) Center of cell latitude
> 8) Center of cell longitude
> So as you can see is a multi layer file
> Now neither Richard (the guy who made this file) nor I know how to import 
> this kind of file into other GIS software, and I would like to know if 
> somebody here could give us detailed instructions or advise to convert layer 
> by layer into a common format (separate from each other. so we could manage 
> every layer independently from the others), so we will be able to import them 
> into other GIS software (Arcview or DIVA GIS) as raster (or grid) layers. 
> (maybe ascii?).
> I have a limited experience using R, but every day I learn a bit more and I 
> think (actually hope) there is a package that is able to do this.
> Sincerely,
> Rodrigo
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From edzer.pebesma at uni-muenster.de  Fri May 23 16:30:48 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 23 May 2008 16:30:48 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805230723p23774aa3of952876778eb657e@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>	
	<4836C082.40208@uni-muenster.de>
	<63d616b0805230723p23774aa3of952876778eb657e@mail.gmail.com>
Message-ID: <4836D518.1080903@uni-muenster.de>

Mauricio, please keep r-sig-geo in the loop.

Mauricio Zambrano wrote:
> Dear Ezder,
>
> Thanks for your advice about the readGdal and the "overlay" function,
> but why is it better to use "readGdal" than "readasciigrid" ?.
>   
because the latter one is deprecated.
> In any case, when I tried to load "rgdal" I got the following error message:
>
> "Error in fun(...) :
> 	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
> compartido: No existe el fichero ? directorio
>
> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
> Error: package/namespace load failed for 'rgdal'
>   
>> library(rgdal)
>>     
> Error in fun(...) :
> 	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
> compartido: No existe el fichero ? directorio
>
> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
> Error: package/namespace load failed for 'rgdal'"
>
> I don't know what is the problem, but yesterday I installed the new
> "qgis" and I don't know if this can be the cause of the error.
>   
It wouldn't surprise me. You may want to try to reinstall rgdal.
> In the meantime, I solved the problem using something very similar to
> the advice given by Oehler:
>
> # reading the boundary of the catchment
> library(maptools)
> catchment <- readShapePoly("only_catchment.shp")
> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>
> and it works.
>
> However, if i did:
>
> library(maptools)
> #projection string for the UTM ED50, Z30N
> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
> catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)
> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>
> I got an error, because the grid is projected but the coordinates of
> the stations are not. How can assign a projection to a given set of
>   
Please tell us where exactly you got which error. I suspect you got it a 
bit later.
> points with existing coordinates ?. At the beginning I did:
>
> #reading data from the file
> meteo<- read.csv2("Meteorological_by_basin.csv")
>
> #setting the coordinates
> coordinates(meteo) <- ~EAST_ED50 + NORTH_ED50
>   
Did you try
proj4string(meteo) = p4s
?
--
Edzer (not Ezder)
> Thanks in advance,
>
> Mauricio
>
> 2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>   
>> Good question; the meuse example does not explain how to get meuse.grid.
>>
>> The asciigrid file you have you should read with readGDAL in package rgdal,
>> if that goes wrong I'd expect the problem in your data file.
>>
>> Otherwise, if you have a shapefile with a polygon covering the catchment,
>> called catch.pol, you'd want to use
>>
>> sel = overlay(catch.pol, catch.grid)
>>
>> The grid cells inside the polygon(s) are now found by
>>
>> catch.sel = catch.grid[!is.na(sel)]
>> --
>> Edzer
>>
>> Mauricio Zambrano wrote:
>>     
>>> Dear List,
>>>
>>> My question is about how to define the grid to be used for the
>>> interpolations, using R 2.7.0 and gstat 0.9-47
>>>
>>> I'm working in a catchment of ~3000 km2, with daily rainfall data of
>>> several stations (more than 40), and I would like to interpolate daily
>>> values within all the catchment using ordinary Kriging.
>>>
>>> For defining the grid in which the interpolation will be carried out,
>>> at the beginning, I tried with
>>>
>>> #setting a grid each 100m vertical and horizontal
>>> dx <- seq(674400,730700,by=100)
>>> dy <- seq(4615100,4744400,by=100)
>>> catch.grid <- expand.grid(dx,dy)
>>>
>>> #setting the names of the columns of the grid
>>> names(catch.grid) <- c("x","y")
>>>
>>> #setting the coordinates of the grid
>>> coordinates(catch.grid) <- ~x+y
>>>
>>> #interpolating with the inverse distance
>>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>>>
>>> #plotting the interpolated values
>>> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>>>
>>> but looking at the figure I realized that the interpolations were
>>> carried out considering all the cells within the squared grid, and not
>>> only within the catchment.
>>>
>>> After, I tried reading a raster file (each 100m) and using it as the grid,
>>>
>>> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>>>
>>> but the results that I got seems to be wrong, because I got high
>>> values where low values were expected and viceversa. (I really
>>> appreciate any help clarifying me what I'm doing wrong )
>>>
>>> Is there any way to define a grid, starting from a shapefile of the
>>> catchment boundaries ?. For example, I would like to define something
>>> similar to the "meuse.grid" dataset.
>>>
>>> Thanks in advance and best regards
>>>
>>>
>>>       
>>     
>
>
>
>



From hzambran.newsgroups at gmail.com  Fri May 23 17:19:55 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Fri, 23 May 2008 17:19:55 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <4836D518.1080903@uni-muenster.de>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
	<4836C082.40208@uni-muenster.de>
	<63d616b0805230723p23774aa3of952876778eb657e@mail.gmail.com>
	<4836D518.1080903@uni-muenster.de>
Message-ID: <63d616b0805230819o4795450fn87cd26fc3bb41915@mail.gmail.com>

Sorry for not include the list in my last e-mail, I forgot it. :(.



2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> Mauricio, please keep r-sig-geo in the loop.
>
> Mauricio Zambrano wrote:
>>
>> Dear Ezder,
>>
>> Thanks for your advice about the readGdal and the "overlay" function,
>> but why is it better to use "readGdal" than "readasciigrid" ?.
>>
>
> because the latter one is deprecated.
>>
Thanks, for clarifying me this.

>> In any case, when I tried to load "rgdal" I got the following error
>> message:
>>
>> "Error in fun(...) :
>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>> compartido: No existe el fichero ? directorio
>>
>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>> Error: package/namespace load failed for 'rgdal'
>>
>>>
>>> library(rgdal)
>>>
>>
>> Error in fun(...) :
>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>> compartido: No existe el fichero ? directorio
>>
>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>> Error: package/namespace load failed for 'rgdal'"
>>
>> I don't know what is the problem, but yesterday I installed the new
>> "qgis" and I don't know if this can be the cause of the error.
>>
>
> It wouldn't surprise me. You may want to try to reinstall rgdal.

I tried, but I got an error:

> remove.packages("rgdal")
Warning in remove.packages("rgdal") :
  argument 'lib' is missing: using /usr/local/lib/R/site-library
> install.packages("rgdal",dependencies=TRUE)
Warning in install.packages("rgdal", dependencies = TRUE) :
  argument 'lib' is missing: using '/usr/local/lib/R/site-library'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
probando la URL 'http://cran.miroir-francais.fr/src/contrib/rgdal_0.5-24.tar.gz'
Content type 'application/x-gzip' length 4426322 bytes (4.2 Mb)
URL abierta
==================================================
downloaded 4.2 Mb

* Installing *source* package 'rgdal' ...
gdal-config: gdal-config
./configure: line 1311: gdal-config: command not found

The gdal-config script distributed with GDAL could not be found.
If you have not installed the GDAL libraries, you can
download the source from  http://www.gdal.org/
If you have installed the GDAL libraries, then make sure that
gdal-config is in your path. Try typing gdal-config at a
shell prompt and see if it runs. If not, use:
 --configure-args='--with-gdal-config=/usr/local/bin/gdal-config' echo
with appropriate values for your installation.

ERROR: configuration failed for package 'rgdal'
** Removing '/usr/local/lib/R/site-library/rgdal'

The downloaded packages are in
	/tmp/Rtmphf9aT7/downloaded_packages
Warning message:
In install.packages("rgdal", dependencies = TRUE) :
  installation of package 'rgdal' had non-zero exit status

Do you have any idea about how to solve it ?

>>
>> In the meantime, I solved the problem using something very similar to
>> the advice given by Oehler:
>>
>> # reading the boundary of the catchment
>> library(maptools)
>> catchment <- readShapePoly("only_catchment.shp")
>> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>
>> and it works.
>>
>> However, if i did:
>>
>> library(maptools)
>> #projection string for the UTM ED50, Z30N
>> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>> catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)
>> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>
>> I got an error, because the grid is projected but the coordinates of
>> the stations are not. How can assign a projection to a given set of
>>
>
> Please tell us where exactly you got which error. I suspect you got it a bit
> later.
>>

Sorry, you are right, I got the error when I tried:
#interpolating with the inverse distance
pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catchment.grid)

>> points with existing coordinates ?. At the beginning I did:
>>
>> #reading data from the file
>> meteo<- read.csv2("Meteorological_by_basin.csv")
>>
>> #setting the coordinates
>> coordinates(meteo) <- ~EAST_ED50 + NORTH_ED50
>>
>
> Did you try
> proj4string(meteo) = p4s
> ?

Thanks a lot, I didn't know that function, and looking at the help of
"coordinates" I didn't find it.
This allow me to run the interpolation in the right projected system:

pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catchment.grid)

Thanks a lot.

Mauricio

> --
> Edzer (not Ezder)
>>
>> Thanks in advance,
>>
>> Mauricio
>>
>> 2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>>
>>>
>>> Good question; the meuse example does not explain how to get meuse.grid.
>>>
>>> The asciigrid file you have you should read with readGDAL in package
>>> rgdal,
>>> if that goes wrong I'd expect the problem in your data file.
>>>
>>> Otherwise, if you have a shapefile with a polygon covering the catchment,
>>> called catch.pol, you'd want to use
>>>
>>> sel = overlay(catch.pol, catch.grid)
>>>
>>> The grid cells inside the polygon(s) are now found by
>>>
>>> catch.sel = catch.grid[!is.na(sel)]
>>> --
>>> Edzer
>>>
>>> Mauricio Zambrano wrote:
>>>
>>>>
>>>> Dear List,
>>>>
>>>> My question is about how to define the grid to be used for the
>>>> interpolations, using R 2.7.0 and gstat 0.9-47
>>>>
>>>> I'm working in a catchment of ~3000 km2, with daily rainfall data of
>>>> several stations (more than 40), and I would like to interpolate daily
>>>> values within all the catchment using ordinary Kriging.
>>>>
>>>> For defining the grid in which the interpolation will be carried out,
>>>> at the beginning, I tried with
>>>>
>>>> #setting a grid each 100m vertical and horizontal
>>>> dx <- seq(674400,730700,by=100)
>>>> dy <- seq(4615100,4744400,by=100)
>>>> catch.grid <- expand.grid(dx,dy)
>>>>
>>>> #setting the names of the columns of the grid
>>>> names(catch.grid) <- c("x","y")
>>>>
>>>> #setting the coordinates of the grid
>>>> coordinates(catch.grid) <- ~x+y
>>>>
>>>> #interpolating with the inverse distance
>>>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>>>>
>>>> #plotting the interpolated values
>>>> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>>>>
>>>> but looking at the figure I realized that the interpolations were
>>>> carried out considering all the cells within the squared grid, and not
>>>> only within the catchment.
>>>>
>>>> After, I tried reading a raster file (each 100m) and using it as the
>>>> grid,
>>>>
>>>> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>>>>
>>>> but the results that I got seems to be wrong, because I got high
>>>> values where low values were expected and viceversa. (I really
>>>> appreciate any help clarifying me what I'm doing wrong )
>>>>
>>>> Is there any way to define a grid, starting from a shapefile of the
>>>> catchment boundaries ?. For example, I would like to define something
>>>> similar to the "meuse.grid" dataset.
>>>>
>>>> Thanks in advance and best regards
>>>>
>>>>
>>>>
>>>
>>>
>>
>>
>>
>>
>
>



-- 
hzambran

Linux user #454569 -- Ubuntu user #17469



From Lydia.Gerharz at uni-muenster.de  Fri May 23 17:47:17 2008
From: Lydia.Gerharz at uni-muenster.de (Lydia Gerharz)
Date: Fri, 23 May 2008 17:47:17 +0200
Subject: [R-sig-Geo]  Try to write GeoTiff with rgdal
Message-ID: <4836E705.4010600@uni-muenster.de>

Hi,

I have problems with writeGDAL. With:

 >writeGDAL(mean2005, "mean.tif", drivername="GTiff", options="TFW=YES")

I export a SpatialGridDataFrame with 9 bands to a GeoTiff. But when I 
try to display this GeoTiff in ArcGIS, all 9 bands are not correctly 
displayed and all cells have the same value (1.17549e-038). I also tried 
another GIS (PcRaster) but it doesn't work. Can somebody tell me what I 
did wrong? In R all 9 bands are displayed correctly.

Thank you very much,
Lydia

-- 
Lydia Gerharz
Institute for Geoinformatics
University of Muenster
GERMANY

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Lydia_Gerharz.vcf
Type: text/x-vcard
Size: 312 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080523/902f0fe4/attachment.vcf>

From hzambran.newsgroups at gmail.com  Fri May 23 17:53:49 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Fri, 23 May 2008 17:53:49 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805230819o4795450fn87cd26fc3bb41915@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
	<4836C082.40208@uni-muenster.de>
	<63d616b0805230723p23774aa3of952876778eb657e@mail.gmail.com>
	<4836D518.1080903@uni-muenster.de>
	<63d616b0805230819o4795450fn87cd26fc3bb41915@mail.gmail.com>
Message-ID: <63d616b0805230853y4c22637fncc9a2449033fe613@mail.gmail.com>

Dear Edzer,

Just in case it be useful for somebody else, I solved the problem with
the installation of "rgdal" in R, installing the "libgdal1-dev"
library on my linux system.

Thanks.

Mauricio

2008/5/23 Mauricio Zambrano <hzambran.newsgroups at gmail.com>:
> Sorry for not include the list in my last e-mail, I forgot it. :(.
>
>
>
> 2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>> Mauricio, please keep r-sig-geo in the loop.
>>
>> Mauricio Zambrano wrote:
>>>
>>> Dear Ezder,
>>>
>>> Thanks for your advice about the readGdal and the "overlay" function,
>>> but why is it better to use "readGdal" than "readasciigrid" ?.
>>>
>>
>> because the latter one is deprecated.
>>>
> Thanks, for clarifying me this.
>
>>> In any case, when I tried to load "rgdal" I got the following error
>>> message:
>>>
>>> "Error in fun(...) :
>>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>>> compartido: No existe el fichero ? directorio
>>>
>>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>>> Error: package/namespace load failed for 'rgdal'
>>>
>>>>
>>>> library(rgdal)
>>>>
>>>
>>> Error in fun(...) :
>>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>>> compartido: No existe el fichero ? directorio
>>>
>>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>>> Error: package/namespace load failed for 'rgdal'"
>>>
>>> I don't know what is the problem, but yesterday I installed the new
>>> "qgis" and I don't know if this can be the cause of the error.
>>>
>>
>> It wouldn't surprise me. You may want to try to reinstall rgdal.
>
> I tried, but I got an error:
>
>> remove.packages("rgdal")
> Warning in remove.packages("rgdal") :
>  argument 'lib' is missing: using /usr/local/lib/R/site-library
>> install.packages("rgdal",dependencies=TRUE)
> Warning in install.packages("rgdal", dependencies = TRUE) :
>  argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> probando la URL 'http://cran.miroir-francais.fr/src/contrib/rgdal_0.5-24.tar.gz'
> Content type 'application/x-gzip' length 4426322 bytes (4.2 Mb)
> URL abierta
> ==================================================
> downloaded 4.2 Mb
>
> * Installing *source* package 'rgdal' ...
> gdal-config: gdal-config
> ./configure: line 1311: gdal-config: command not found
>
> The gdal-config script distributed with GDAL could not be found.
> If you have not installed the GDAL libraries, you can
> download the source from  http://www.gdal.org/
> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, use:
>  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config' echo
> with appropriate values for your installation.
>
> ERROR: configuration failed for package 'rgdal'
> ** Removing '/usr/local/lib/R/site-library/rgdal'
>
> The downloaded packages are in
>        /tmp/Rtmphf9aT7/downloaded_packages
> Warning message:
> In install.packages("rgdal", dependencies = TRUE) :
>  installation of package 'rgdal' had non-zero exit status
>
> Do you have any idea about how to solve it ?
>
>>>
>>> In the meantime, I solved the problem using something very similar to
>>> the advice given by Oehler:
>>>
>>> # reading the boundary of the catchment
>>> library(maptools)
>>> catchment <- readShapePoly("only_catchment.shp")
>>> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>>
>>> and it works.
>>>
>>> However, if i did:
>>>
>>> library(maptools)
>>> #projection string for the UTM ED50, Z30N
>>> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>>> catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)
>>> catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>>
>>> I got an error, because the grid is projected but the coordinates of
>>> the stations are not. How can assign a projection to a given set of
>>>
>>
>> Please tell us where exactly you got which error. I suspect you got it a bit
>> later.
>>>
>
> Sorry, you are right, I got the error when I tried:
> #interpolating with the inverse distance
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catchment.grid)
>
>>> points with existing coordinates ?. At the beginning I did:
>>>
>>> #reading data from the file
>>> meteo<- read.csv2("Meteorological_by_basin.csv")
>>>
>>> #setting the coordinates
>>> coordinates(meteo) <- ~EAST_ED50 + NORTH_ED50
>>>
>>
>> Did you try
>> proj4string(meteo) = p4s
>> ?
>
> Thanks a lot, I didn't know that function, and looking at the help of
> "coordinates" I didn't find it.
> This allow me to run the interpolation in the right projected system:
>
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catchment.grid)
>
> Thanks a lot.
>
> Mauricio
>
>> --
>> Edzer (not Ezder)
>>>
>>> Thanks in advance,
>>>
>>> Mauricio
>>>
>>> 2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>>>
>>>>
>>>> Good question; the meuse example does not explain how to get meuse.grid.
>>>>
>>>> The asciigrid file you have you should read with readGDAL in package
>>>> rgdal,
>>>> if that goes wrong I'd expect the problem in your data file.
>>>>
>>>> Otherwise, if you have a shapefile with a polygon covering the catchment,
>>>> called catch.pol, you'd want to use
>>>>
>>>> sel = overlay(catch.pol, catch.grid)
>>>>
>>>> The grid cells inside the polygon(s) are now found by
>>>>
>>>> catch.sel = catch.grid[!is.na(sel)]
>>>> --
>>>> Edzer
>>>>
>>>> Mauricio Zambrano wrote:
>>>>
>>>>>
>>>>> Dear List,
>>>>>
>>>>> My question is about how to define the grid to be used for the
>>>>> interpolations, using R 2.7.0 and gstat 0.9-47
>>>>>
>>>>> I'm working in a catchment of ~3000 km2, with daily rainfall data of
>>>>> several stations (more than 40), and I would like to interpolate daily
>>>>> values within all the catchment using ordinary Kriging.
>>>>>
>>>>> For defining the grid in which the interpolation will be carried out,
>>>>> at the beginning, I tried with
>>>>>
>>>>> #setting a grid each 100m vertical and horizontal
>>>>> dx <- seq(674400,730700,by=100)
>>>>> dy <- seq(4615100,4744400,by=100)
>>>>> catch.grid <- expand.grid(dx,dy)
>>>>>
>>>>> #setting the names of the columns of the grid
>>>>> names(catch.grid) <- c("x","y")
>>>>>
>>>>> #setting the coordinates of the grid
>>>>> coordinates(catch.grid) <- ~x+y
>>>>>
>>>>> #interpolating with the inverse distance
>>>>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>>>>>
>>>>> #plotting the interpolated values
>>>>> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>>>>>
>>>>> but looking at the figure I realized that the interpolations were
>>>>> carried out considering all the cells within the squared grid, and not
>>>>> only within the catchment.
>>>>>
>>>>> After, I tried reading a raster file (each 100m) and using it as the
>>>>> grid,
>>>>>
>>>>> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>>>>>
>>>>> but the results that I got seems to be wrong, because I got high
>>>>> values where low values were expected and viceversa. (I really
>>>>> appreciate any help clarifying me what I'm doing wrong )
>>>>>
>>>>> Is there any way to define a grid, starting from a shapefile of the
>>>>> catchment boundaries ?. For example, I would like to define something
>>>>> similar to the "meuse.grid" dataset.
>>>>>
>>>>> Thanks in advance and best regards
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>
>>>
>>>
>>>
>>
>>
>
>
>
> --
> hzambran
>
> Linux user #454569 -- Ubuntu user #17469
>



-- 
hzambran

Linux user #454569 -- Ubuntu user #17469



From hzambran.newsgroups at gmail.com  Fri May 23 17:54:29 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Fri, 23 May 2008 17:54:29 +0200
Subject: [R-sig-Geo] Problem finding the centroid of a polygon with get.Pcent
Message-ID: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com>

Dear List,

For finding the centroid of a catchment, I tried with the function:

 get.Pcent(gallego_catchment)

but I got the following  error:

Error en get.Pcent(gallego_catchment) : not a Map object

However, I checked the class:

> class(gallego_catchment)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"

and I read the catchment boundary with:

p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
# reading the boundary of the gallego catchment
library(maptools)
gallego_catchment <- readShapePoly("only_gallego_catchment.shp",
proj4string=p4s)

Could somebody tell me if I'm doing something wrong?

Thanks in advance

Mauricio

-- 
hzambran

Linux user #454569 -- Ubuntu user #17469



From Roger.Bivand at nhh.no  Fri May 23 18:10:56 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 May 2008 18:10:56 +0200 (CEST)
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <4836D518.1080903@uni-muenster.de>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com> 
	<4836C082.40208@uni-muenster.de>
	<63d616b0805230723p23774aa3of952876778eb657e@mail.gmail.com>
	<4836D518.1080903@uni-muenster.de>
Message-ID: <Pine.LNX.4.64.0805231805140.30982@reclus.nhh.no>

On Fri, 23 May 2008, Edzer Pebesma wrote:

> Mauricio, please keep r-sig-geo in the loop.
>
> Mauricio Zambrano wrote:
>>  Dear Ezder,
>>
>>  Thanks for your advice about the readGdal and the "overlay" function,
>>  but why is it better to use "readGdal" than "readasciigrid" ?.
>> 
> because the latter one is deprecated.
>>  In any case, when I tried to load "rgdal" I got the following error
>>  message:
>>
>>  "Error in fun(...) :
>>  	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>>  compartido: No existe el fichero ? directorio
>>
>>  Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>>  Error: package/namespace load failed for 'rgdal'
>> 
>> >  library(rgdal)
>> >
>>  Error in fun(...) :
>>  	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>>  compartido: No existe el fichero ? directorio
>>
>>  Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>>  Error: package/namespace load failed for 'rgdal'"
>>
>>  I don't know what is the problem, but yesterday I installed the new
>>  "qgis" and I don't know if this can be the cause of the error.
>> 
> It wouldn't surprise me. You may want to try to reinstall rgdal.

Yes, it's almost certainly QGIS chewing things up. It looks as though QGIS 
expects the GRASS OGR plugin to be present, or some GRASS dependencies to 
be present - if they are, you need to add the offending GRASS library 
directory to ld.so.conf or similar as root, and refresh ldconfig. On 
Linux, if the above does not work, best remove QGIS and reinstall GDAL 
(from source, not binary, the binaries often have unfulfilled 
dependencies, unfortunately). Then remove and re-install rgdal.

Roger

>>  In the meantime, I solved the problem using something very similar to
>>  the advice given by Oehler:
>>
>>  # reading the boundary of the catchment
>>  library(maptools)
>>  catchment <- readShapePoly("only_catchment.shp")
>>  catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>
>>  and it works.
>>
>>  However, if i did:
>>
>>  library(maptools)
>>  #projection string for the UTM ED50, Z30N
>>  p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>>  catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)
>>  catchment.grid <- spsample(catchment, type="regular", cellsize=100)
>>
>>  I got an error, because the grid is projected but the coordinates of
>>  the stations are not. How can assign a projection to a given set of
>> 
> Please tell us where exactly you got which error. I suspect you got it a bit 
> later.
>>  points with existing coordinates ?. At the beginning I did:
>>
>>  #reading data from the file
>>  meteo<- read.csv2("Meteorological_by_basin.csv")
>>
>>  #setting the coordinates
>>  coordinates(meteo) <- ~EAST_ED50 + NORTH_ED50
>> 
> Did you try
> proj4string(meteo) = p4s
> ?
> --
> Edzer (not Ezder)
>>  Thanks in advance,
>>
>>  Mauricio
>>
>>  2008/5/23 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>> 
>> >  Good question; the meuse example does not explain how to get meuse.grid.
>> > 
>> >  The asciigrid file you have you should read with readGDAL in package 
>> >  rgdal,
>> >  if that goes wrong I'd expect the problem in your data file.
>> > 
>> >  Otherwise, if you have a shapefile with a polygon covering the 
>> >  catchment,
>> >  called catch.pol, you'd want to use
>> > 
>> >  sel = overlay(catch.pol, catch.grid)
>> > 
>> >  The grid cells inside the polygon(s) are now found by
>> > 
>> >  catch.sel = catch.grid[!is.na(sel)]
>> >  --
>> >  Edzer
>> > 
>> >  Mauricio Zambrano wrote:
>> > 
>> > >  Dear List,
>> > > 
>> > >  My question is about how to define the grid to be used for the
>> > >  interpolations, using R 2.7.0 and gstat 0.9-47
>> > > 
>> > >  I'm working in a catchment of ~3000 km2, with daily rainfall data of
>> > >  several stations (more than 40), and I would like to interpolate daily
>> > >  values within all the catchment using ordinary Kriging.
>> > > 
>> > >  For defining the grid in which the interpolation will be carried out,
>> > >  at the beginning, I tried with
>> > > 
>> > >  #setting a grid each 100m vertical and horizontal
>> > >  dx <- seq(674400,730700,by=100)
>> > >  dy <- seq(4615100,4744400,by=100)
>> > >  catch.grid <- expand.grid(dx,dy)
>> > > 
>> > >  #setting the names of the columns of the grid
>> > >  names(catch.grid) <- c("x","y")
>> > > 
>> > >  #setting the coordinates of the grid
>> > >  coordinates(catch.grid) <- ~x+y
>> > > 
>> > >  #interpolating with the inverse distance
>> > >  pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>> > > 
>> > >  #plotting the interpolated values
>> > >  spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>> > > 
>> > >  but looking at the figure I realized that the interpolations were
>> > >  carried out considering all the cells within the squared grid, and not
>> > >  only within the catchment.
>> > > 
>> > >  After, I tried reading a raster file (each 100m) and using it as the 
>> > >  grid,
>> > > 
>> > >  DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>> > > 
>> > >  but the results that I got seems to be wrong, because I got high
>> > >  values where low values were expected and viceversa. (I really
>> > >  appreciate any help clarifying me what I'm doing wrong )
>> > > 
>> > >  Is there any way to define a grid, starting from a shapefile of the
>> > >  catchment boundaries ?. For example, I would like to define something
>> > >  similar to the "meuse.grid" dataset.
>> > > 
>> > >  Thanks in advance and best regards
>> > > 
>> > > 
>> > > 
>> > 
>> 
>> 
>> 
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Fri May 23 18:13:54 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 May 2008 18:13:54 +0200 (CEST)
Subject: [R-sig-Geo] Problem finding the centroid of a polygon with
 get.Pcent
In-Reply-To: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com>
References: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805231800510.30982@reclus.nhh.no>

On Fri, 23 May 2008, Mauricio Zambrano wrote:

> Dear List,
>
> For finding the centroid of a catchment, I tried with the function:
>
> get.Pcent(gallego_catchment)
>
> but I got the following  error:
>
> Error en get.Pcent(gallego_catchment) : not a Map object
>
> However, I checked the class:
>
>> class(gallego_catchment)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"

Just say coordinates(gallego_catchment) to extract the "centroid" - 
labelpoint - for each Polygons object - the coordinates() method retrieves 
the label points. Note that a "Map" object is not a 
"SpatialPolygonsDataFrame" object, and indeed "Map" objects are only used 
internally in some limited settings. You are muddling up classes. 
Installing rgdal properly would make sure you only saw the 
"SpatialPolygonsDataFrame" object, which is all you need.

Roger

>
> and I read the catchment boundary with:
>
> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
> # reading the boundary of the gallego catchment
> library(maptools)
> gallego_catchment <- readShapePoly("only_gallego_catchment.shp",
> proj4string=p4s)
>
> Could somebody tell me if I'm doing something wrong?
>
> Thanks in advance
>
> Mauricio
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From aloboaleu at gmail.com  Fri May 23 20:06:42 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Fri, 23 May 2008 20:06:42 +0200
Subject: [R-sig-Geo] Try to write GeoTiff with rgdal
In-Reply-To: <4836E705.4010600@uni-muenster.de>
References: <4836E705.4010600@uni-muenster.de>
Message-ID: <483707B2.4030501@gmail.com>

Many programs are not able to display tiff files with more
than 3 bands. Test with qgis 0.10 or globalmapper. Or with matlab

Agus



Lydia Gerharz wrote:
> Hi,
> 
> I have problems with writeGDAL. With:
> 
>  >writeGDAL(mean2005, "mean.tif", drivername="GTiff", options="TFW=YES")
> 
> I export a SpatialGridDataFrame with 9 bands to a GeoTiff. But when I 
> try to display this GeoTiff in ArcGIS, all 9 bands are not correctly 
> displayed and all cells have the same value (1.17549e-038). I also tried 
> another GIS (PcRaster) but it doesn't work. Can somebody tell me what I 
> did wrong? In R all 9 bands are displayed correctly.
> 
> Thank you very much,
> Lydia
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From edzer.pebesma at uni-muenster.de  Fri May 23 21:39:51 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 23 May 2008 21:39:51 +0200
Subject: [R-sig-Geo] Try to write GeoTiff with rgdal
In-Reply-To: <483707B2.4030501@gmail.com>
References: <4836E705.4010600@uni-muenster.de> <483707B2.4030501@gmail.com>
Message-ID: <48371D87.3070702@uni-muenster.de>

Also, I believe that ArcGIS assumes GeoTIFF are integer always, whereas 
yours (I know) are floating point.

You may want to use gdalinfo on it, which is probably in fwtools. Or, 
yes, qgis.
--
Edzer

Agustin Lobo wrsote:
> Many programs are not able to display tiff files with more
> than 3 bands. Test with qgis 0.10 or globalmapper. Or with matlab
>
> Agus
>
>
>
> Lydia Gerharz wrote:
>> Hi,
>>
>> I have problems with writeGDAL. With:
>>
>>  >writeGDAL(mean2005, "mean.tif", drivername="GTiff", options="TFW=YES")
>>
>> I export a SpatialGridDataFrame with 9 bands to a GeoTiff. But when I 
>> try to display this GeoTiff in ArcGIS, all 9 bands are not correctly 
>> displayed and all cells have the same value (1.17549e-038). I also 
>> tried another GIS (PcRaster) but it doesn't work. Can somebody tell 
>> me what I did wrong? In R all 9 bands are displayed correctly.
>>
>> Thank you very much,
>> Lydia
>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Sat May 24 11:02:04 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 May 2008 11:02:04 +0200 (CEST)
Subject: [R-sig-Geo] Try to write GeoTiff with rgdal
In-Reply-To: <483707B2.4030501@gmail.com>
References: <4836E705.4010600@uni-muenster.de> <483707B2.4030501@gmail.com>
Message-ID: <Pine.LNX.4.64.0805241054520.1399@reclus.nhh.no>

On Fri, 23 May 2008, Agustin Lobo wrote:

> Many programs are not able to display tiff files with more
> than 3 bands. Test with qgis 0.10 or globalmapper. Or with matlab

Any other program using GDAL (like QGIS) will read files written by GDAL. 
ArcGIS is an exception, as it predictably does the wrong thing. My 
experience is that you have to read GeoTiff through the toolbox raster 
calculate statistics module, because ArcGIS guesses wrong about how the 
data are configured, and often ignores valid NA cells (hence the odd 
values). A three-band will typically be interpreted by ArcGIS as an RGB 
image. Doing it a band at a time, and going in through the toolbox (think 
Python script) is feasible. On the other hand, non-GDAL ENVI handles 
GDAL-written multiband GeoTiffs without any trouble that I've seen.

Welcome to the world of "interoperability"!

Roger

>
> Agus
>
>
>
> Lydia Gerharz wrote:
>>  Hi,
>>
>>  I have problems with writeGDAL. With:
>> 
>> > writeGDAL(mean2005, "mean.tif", drivername="GTiff", options="TFW=YES")
>>
>>  I export a SpatialGridDataFrame with 9 bands to a GeoTiff. But when I try
>>  to display this GeoTiff in ArcGIS, all 9 bands are not correctly displayed
>>  and all cells have the same value (1.17549e-038). I also tried another GIS
>>  (PcRaster) but it doesn't work. Can somebody tell me what I did wrong? In
>>  R all 9 bands are displayed correctly.
>>
>>  Thank you very much,
>>  Lydia
>>
>>
>>  ------------------------------------------------------------------------
>>
>>  _______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at stat.math.ethz.ch
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Sun May 25 02:47:26 2008
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Sun, 25 May 2008 10:47:26 +1000
Subject: [R-sig-Geo] Dear Friends,
In-Reply-To: <Pine.LNX.4.64.0805231612380.30982@reclus.nhh.no>
References: <4836CC90.6010407@armonia-bo.org>
	<Pine.LNX.4.64.0805231612380.30982@reclus.nhh.no>
Message-ID: <4838B71E.60507@utas.edu.au>

Apparently it's common for extra bytes to be added by Fortran "raw 
binary" writers. I don't know exactly, but I had to figure this out by 
trial and error for some binary versions of the Reynolds SST products - 
that had precise descriptions of the file arrangement that doesn't 
include the extra bytes. Some colleagues with more experience confirmed 
that there were some strange additional bytes to be expected from Fortran.

ftp://podaac.jpl.nasa.gov/pub/sea_surface_temperature/reynolds/oisst/software/v2/README.v2
When reading from these files you can see the bytes that I ignore as 
"junk", the rest of the data in there is tidy and predictable:

    if (length(grep(".gz", fl)) == 1)
      con <- gzfile(file.path(dir, fl), "rb") else    con <- 
file(file.path(dir, fl), "rb")
   
    head <- readBin(con, "integer", size = 4, n = 11, endian = "big",  
signed = FALSE)
    temps <- readBin(con, "numeric", size = 4, n = 180 * 360,endian = "big")
    junk <- readBin(con, "integer", size = 4, endian = "big", n = 2)

    err <- readBin(con, "numeric", size = 4, n = 180 * 360, endian = "big")
    junk <- readBin(con, "integer", size = 4, endian = "big", n = 2)
    ice <- readBin(con, "integer", size = 1, n = 180 * 360, endian = 
"big",signed = FALSE)

    close(con)

HTH
Cheers, Mike.
Roger Bivand wrote:
> On Fri, 23 May 2008, Rodrigo W. Soria Auza wrote:
>
>> Hi all,
>> I have a file (MOD06_auza_gridded_cldstats.bin) created by a college 
>> (Richard Frey). It is a binary written with FORTRAN in a 
>> little-endian (Linux) machine that contains a 400x300x84-bite integer 
>> array.
>
> If you have access to the Fortran source code, use readBin() to read 
> the chunks. I'm puzzled by the 84 bytes, because that suggests that 
> each cell record contains more than 8 8-byte double precision numbers 
> (which would be 64 bytes). So you need a more detailed description 
> than you have now.
>
> If you read the data into pre-allocated vectors (perhaps grouped in a 
> list), thes can readily be converted to a data frame. This can be 
> converted into a SpatialPointsDataFrame (class defiled in the sp 
> package) and further to a SpatialGridDataFrame. This can then be 
> exported using writeGDAL() in the rgdal package, to a range of 
> different formats, defined by the drivers in your installed GDAL, see 
> gdalDrivers() for the ones you have.
>
> Roger
>
>> The 400 represents 1/20 degree cells in a N-S direction (7S-27S), 300 
>> is 1/20 degree cells in the E-W direction (55-70W). The 8 products in 
>> order for each of the 120000 cells:
>> 1) Number retrievals
>> 2) Yearly mean cloud fraction
>> 3) Frequency of high, thick clouds
>> 4) Frequency of thick clouds top temperatures <-65C
>> 5) Same as # 4 but <-38C
>> 6) Same as # 4 but <-12C
>> 7) Center of cell latitude
>> 8) Center of cell longitude
>> So as you can see is a multi layer file
>> Now neither Richard (the guy who made this file) nor I know how to 
>> import this kind of file into other GIS software, and I would like to 
>> know if somebody here could give us detailed instructions or advise 
>> to convert layer by layer into a common format (separate from each 
>> other. so we could manage every layer independently from the others), 
>> so we will be able to import them into other GIS software (Arcview or 
>> DIVA GIS) as raster (or grid) layers. (maybe ascii?).
>> I have a limited experience using R, but every day I learn a bit more 
>> and I think (actually hope) there is a package that is able to do this.
>> Sincerely,
>> Rodrigo
>>
>>
>>
>



From regmi_pujan at hotmail.com  Sun May 25 13:59:33 2008
From: regmi_pujan at hotmail.com (PUJAN RAJ REGMI)
Date: Sun, 25 May 2008 11:59:33 +0000
Subject: [R-sig-Geo] Replacing the Matrix vlaues
Message-ID: <BAY113-W11729193CFEE67CBF4569584C30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080525/837e6c53/attachment.pl>

From opheliawang at mail.utexas.edu  Sun May 25 20:19:30 2008
From: opheliawang at mail.utexas.edu (Ophelia Wang)
Date: Sun, 25 May 2008 13:19:30 -0500
Subject: [R-sig-Geo] Problem with ignoring background value
In-Reply-To: <BAY113-W11729193CFEE67CBF4569584C30@phx.gbl>
References: <BAY113-W11729193CFEE67CBF4569584C30@phx.gbl>
Message-ID: <1211739570.4839adb24f8f9@webmailapp5.cc.utexas.edu>

Hi all,

I've been having troubles to get rid of background values (255) of
aerial photo
mosaics (.img) in Erdas Imagine. I've tried "mosaic" (which has options
of
ignore certain input and output background and 0 values), "rescale"
(ignore 0
and 255), ArcGIS copy raster (ignore 0 and 255), etc. etc. Everything
that has
an option to ignore both 0 and 255 that I've tried.

None of those worked in terms of removing the white background of the
aerial
photo mosaics. I have nearly 50 images, so I can't manually create AOI
and then
subset each mosaic based on AOI.

Any suggestions? Thanks for you help.

Ophelia


-- 
Ophelia Wang
PhD candidate
Department of Geography and Environment
University of Texas at Austin
210 West 24th Street, Austin, TX 78712, USA
Phone: 1-512-471-5116
Fax: 1-512-471-5049
Email: opheliawang at mail.utexas.edu



From Roger.Bivand at nhh.no  Sun May 25 23:26:10 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 25 May 2008 23:26:10 +0200 (CEST)
Subject: [R-sig-Geo] Problem with ignoring background value
In-Reply-To: <1211739570.4839adb24f8f9@webmailapp5.cc.utexas.edu>
References: <BAY113-W11729193CFEE67CBF4569584C30@phx.gbl>
	<1211739570.4839adb24f8f9@webmailapp5.cc.utexas.edu>
Message-ID: <Pine.LNX.4.64.0805252319420.29145@reclus.nhh.no>

On Sun, 25 May 2008, Ophelia Wang wrote:

> Hi all,
>
> I've been having troubles to get rid of background values (255) of 
> aerial photo mosaics (.img) in Erdas Imagine. I've tried "mosaic" (which 
> has options of ignore certain input and output background and 0 values), 
> "rescale" (ignore 0 and 255), ArcGIS copy raster (ignore 0 and 255), 
> etc. etc. Everything that has an option to ignore both 0 and 255 that 
> I've tried.
>
> None of those worked in terms of removing the white background of the 
> aerial photo mosaics. I have nearly 50 images, so I can't manually 
> create AOI and then subset each mosaic based on AOI.

There are (at least) two things mixed up here. One concerns the actual 
values, the other their graphical representation. You could script a loop 
to set SpatialGridDataFrame variables meeting your conditions to NA, which 
would display as transparent in many R graphics devices, but getting the 
missing values across to other systems might need patience. A combination 
of R and Python might get them into Arc - R to set to NA and export, then 
Python or VBA to import the file with NAs into Arc. Do you need to crop 
them too?

Roger

>
> Any suggestions? Thanks for you help.
>
> Ophelia
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From opheliawang at mail.utexas.edu  Mon May 26 00:03:21 2008
From: opheliawang at mail.utexas.edu (Ophelia Wang)
Date: Sun, 25 May 2008 17:03:21 -0500
Subject: [R-sig-Geo] Problem with ignoring background value
In-Reply-To: <Pine.LNX.4.64.0805252319420.29145@reclus.nhh.no>
References: <BAY113-W11729193CFEE67CBF4569584C30@phx.gbl>
	<1211739570.4839adb24f8f9@webmailapp5.cc.utexas.edu>
	<Pine.LNX.4.64.0805252319420.29145@reclus.nhh.no>
Message-ID: <1211753001.4839e2297b2d7@webmailapp5.cc.utexas.edu>

Hi all,

Thanks for all the responses. I finally fixed the problem by creating a binary
mask that sets the aerial photos as 1 and the white background (layer 1=255,
layer 2=254 and 255, layer 3=255) as 0. I then used the mask function in Erdas'
utilities to mask out the unwanted background.

Ophelia



From a.ghisla at studenti.uninsubria.it  Mon May 26 10:35:12 2008
From: a.ghisla at studenti.uninsubria.it (Anne Ghisla)
Date: Mon, 26 May 2008 10:35:12 +0200
Subject: [R-sig-Geo] (adehabitat) compana() freezes on small dataset
Message-ID: <1211790912.6630.14.camel@galadriel>

Hello all,

I'm running compositional analysis on red squirrel data.
I've got two datasets, one for summer and one for fall.
The summer dataset includes 6 animals and 5 habitats, and fall includes
9 animals and 5 habitats.

I ran the compana(used, avail, test="parametric") separately for the two
seasons, but only fall succeeded. Summer dataset causes R to freeze, and
the process must be killed.
Aebischer et al. 1993 fixes the absolute minimum as 6 animals. Is it the
same for compana() algorithm?

thank you in advance,

Anne Ghisla
Universit? dell'Insubria, Varese (IT)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080526/ffbbe62a/attachment.bin>

From p.hiemstra at geo.uu.nl  Mon May 26 10:37:10 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 26 May 2008 10:37:10 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
Message-ID: <483A76B6.3070300@geo.uu.nl>

Hi Mauricio,

To get a grid based on a shapefile you can use the command "spsample".

library(sp)
library(maptools)
source_poly = readShapePoly("/path/to/poly")
# cellsize is in map units (e.g. km), also see "?spsample"
grd = spsample(source_poly, cellsize = c(10e3,10e3), type = "regular")
gridded(grd) = TRUE # Make it a grid
summary(grd)
# Visualize the grid
spplot(source_poly, sp.layout = list("sp.points", grd))

"grd" can now be used for interpolations.

hth and cheers,
Paul

Mauricio Zambrano wrote:
> Dear List,
>
> My question is about how to define the grid to be used for the
> interpolations, using R 2.7.0 and gstat 0.9-47
>
> I'm working in a catchment of ~3000 km2, with daily rainfall data of
> several stations (more than 40), and I would like to interpolate daily
> values within all the catchment using ordinary Kriging.
>
> For defining the grid in which the interpolation will be carried out,
> at the beginning, I tried with
>
> #setting a grid each 100m vertical and horizontal
> dx <- seq(674400,730700,by=100)
> dy <- seq(4615100,4744400,by=100)
> catch.grid <- expand.grid(dx,dy)
>
> #setting the names of the columns of the grid
> names(catch.grid) <- c("x","y")
>
> #setting the coordinates of the grid
> coordinates(catch.grid) <- ~x+y
>
> #interpolating with the inverse distance
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>
> #plotting the interpolated values
> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>
> but looking at the figure I realized that the interpolations were
> carried out considering all the cells within the squared grid, and not
> only within the catchment.
>
> After, I tried reading a raster file (each 100m) and using it as the grid,
>
> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>
> but the results that I got seems to be wrong, because I got high
> values where low values were expected and viceversa. (I really
> appreciate any help clarifying me what I'm doing wrong )
>
> Is there any way to define a grid, starting from a shapefile of the
> catchment boundaries ?. For example, I would like to define something
> similar to the "meuse.grid" dataset.
>
> Thanks in advance and best regards
>
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From p.hiemstra at geo.uu.nl  Mon May 26 10:47:36 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 26 May 2008 10:47:36 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
Message-ID: <483A7928.7090501@geo.uu.nl>

Hi Eelke,

I would advise against filling up the RK grid with OK predictions. 
Interpolating the predictors would have my preference, although it has 
it own set of problems. What is the opinion of the r-sig-geo gurus on 
this subject?

cheers,
Paul

Eelke Folmer wrote:
> Hello all,
> I'm using Gstat/R for regression kriging. I don't have values for all locations in the predictor variables for which I want to interpolate a surface. I do however want to make use of the independent predictors. Therfor I combined regression kriging with ordinary kriging:
> 1. regression kriging:     krige(log(cer+1) ~ pred1 + pred2 ,  data,  data.pred.grid, model = vgm.fit1) 
> 2. ordinary kriging:         krige(log(cer+1) ~ 1,                     data,  pred.grid,        model = vgm.fit0) 
> 3. add the values from the second step to the grid where the first step gives NA: 
>   s0 = surface.krige0 at data$var1.pred
>   s1 = surface.krige1 at data$var1.pred
>   s1[is.na(s1)] <- 0    # make the NA zero
>   s0[!is.na(s1)] <- 0   # make everyting that is not NA in s1 zero
>   s1 = s1 + s0          # now, all locations get a predicted value despite missing predictors
> surface.krige at data$var1.pred.inclusive = s1
>
> Is this ok, or should I interpolate (in fact, extrapolate) the predictors to get values at all necessary locations instead? Better solutions available?
> Thank you in advance for time and effort.
> Best regards,
> Eelke
>
> Eelke Folmer
> Animal Ecology Group
> University of Groningen
> P. O. Box 14
> 9750 AA Haren
> The Netherlands
> +31(0)50 3632091
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From calenge at biomserv.univ-lyon1.fr  Mon May 26 11:44:17 2008
From: calenge at biomserv.univ-lyon1.fr (=?UTF-8?B?Q2zDqW1lbnQgQ2FsZW5nZQ==?=)
Date: Mon, 26 May 2008 11:44:17 +0200
Subject: [R-sig-Geo] [AniMov] (adehabitat) compana() freezes on small
	dataset
In-Reply-To: <1211790912.6630.14.camel@galadriel>
References: <1211790912.6630.14.camel@galadriel>
Message-ID: <483A8671.6040409@biomserv.univ-lyon1.fr>

Dear Anne,

> I'm running compositional analysis on red squirrel data.
> I've got two datasets, one for summer and one for fall.
> The summer dataset includes 6 animals and 5 habitats, and fall includes
> 9 animals and 5 habitats.
>
> I ran the compana(used, avail, test="parametric") separately for the two
> seasons, but only fall succeeded. Summer dataset causes R to freeze, and
> the process must be killed.
> Aebischer et al. 1993 fixes the absolute minimum as 6 animals. Is it the
> same for compana() algorithm?
>   

In fact, there is no absolute minimum for the function compana (you 
should just be aware that a small number of animals leads to uncertain 
conclusions). The only absolute minimum of the function is two animals 
(these are required to have a sensible measure of variance - remember 
that the compositional analysis relies on the multivariate analysis of 
/variance/).

Thus, for example, performing a compositional analysis on only the first 
four pheasants of the pheasant dataset (from the Aebischer et al.'s 
paper) works perfectly (just copy and paste):

data(pheasant)
compana(pheasant$mcp[1:4,], pheasant$studyarea[1:4,],
                test = "parametric")

I guess, however, that you may have an habitat type which is not 
available to any animal. For example, the following causes R to freeze:

pheana2 <- compana(cbind(pheasant$mcp, rep(0, nrow(pheasant$mcp))), 
cbind(pheasant$studyarea, rep(0, nrow(pheasant$mcp))),
                         test = "parametric")

How to study the selection of a habitat type by a species if this 
habitat type is not available to any animal?
Note that the same problem arises if one habitat type is available to 
only one animal (at least two animals are required to compute the variance):

compana(cbind(pheasant$mcp,          c(rep(0, nrow(pheasant$mcp)-1),1)),
                cbind(pheasant$studyarea, c(rep(0, 
nrow(pheasant$mcp)-1),1)),
                  test = "parametric")

I will modify the function compana in the next version of adehabitat, so 
that it reports an error when such cases occur.
However, it is difficult to know what happens exactly in your case 
without any reproducible example.
Hope this helps,


Cl?ment Calenge

-- 
Cl?ment CALENGE
Observatoire des galliformes de montagne
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14



From E.O.Folmer at rug.nl  Mon May 26 11:54:14 2008
From: E.O.Folmer at rug.nl (Eelke Folmer)
Date: Mon, 26 May 2008 11:54:14 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
	with	missing values in predictor variables
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl>
Message-ID: <003a01c8bf16$74e99530$e5847d81@129125132229>

Thank you Paul,
I did indeed get more advice from Tomislav Hengl, the same as yours. And 
given the reliability of the (through kriging) predictions of the auxiliary 
variable it indeed makes most sense as you advice also.
Cheers,
Eelke

Tomislav Hengl writes:
I would rather try to extrapolate the predictors (pred1 etc.) and then run
only one model. At least the transition of the values in the final map
will be continuous.

In any case, RK predictions where you do not have values of predictors
will be poor. Only if the regression model is not really significant
(R-square<0.3), then you might rely on the kriging part.

----- Original Message ----- 
From: "Paul Hiemstra" <p.hiemstra at geo.uu.nl>
To: "Eelke Folmer" <E.O.Folmer at rug.nl>
Cc: <r-sig-geo at stat.math.ethz.ch>
Sent: Monday, May 26, 2008 10:47 AM
Subject: Re: [R-sig-Geo] Ordinary and Regression Kriging combined to deal 
with missing values in predictor variables


> Hi Eelke,
>
> I would advise against filling up the RK grid with OK predictions. 
> Interpolating the predictors would have my preference, although it has it 
> own set of problems. What is the opinion of the r-sig-geo gurus on this 
> subject?
>
> cheers,
> Paul
>
> Eelke Folmer wrote:
>> Hello all,
>> I'm using Gstat/R for regression kriging. I don't have values for all 
>> locations in the predictor variables for which I want to interpolate a 
>> surface. I do however want to make use of the independent predictors. 
>> Therfor I combined regression kriging with ordinary kriging:
>> 1. regression kriging:     krige(log(cer+1) ~ pred1 + pred2 ,  data, 
>> data.pred.grid, model = vgm.fit1) 2. ordinary kriging: 
>> krige(log(cer+1) ~ 1,                     data,  pred.grid,        model 
>> = vgm.fit0) 3. add the values from the second step to the grid where the 
>> first step gives NA: s0 = surface.krige0 at data$var1.pred
>>   s1 = surface.krige1 at data$var1.pred
>>   s1[is.na(s1)] <- 0    # make the NA zero
>>   s0[!is.na(s1)] <- 0   # make everyting that is not NA in s1 zero
>>   s1 = s1 + s0          # now, all locations get a predicted value 
>> despite missing predictors
>> surface.krige at data$var1.pred.inclusive = s1
>>
>> Is this ok, or should I interpolate (in fact, extrapolate) the predictors 
>> to get values at all necessary locations instead? Better solutions 
>> available?
>> Thank you in advance for time and effort.
>> Best regards,
>> Eelke
>>
>> Eelke Folmer
>> Animal Ecology Group
>> University of Groningen
>> P. O. Box 14
>> 9750 AA Haren
>> The Netherlands
>> +31(0)50 3632091
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> -- 
> Drs. Paul Hiemstra
> Department of Physical Geography
> Faculty of Geosciences
> University of Utrecht
> Heidelberglaan 2
> P.O. Box 80.115
> 3508 TC Utrecht
> Phone: +31302535773
> Fax: +31302531145
> http://intamap.geo.uu.nl/~paul
>
>



From a.ghisla at studenti.uninsubria.it  Mon May 26 13:27:14 2008
From: a.ghisla at studenti.uninsubria.it (Anne Ghisla)
Date: Mon, 26 May 2008 13:27:14 +0200
Subject: [R-sig-Geo] [AniMov] (adehabitat) compana() freezes on small
	dataset
In-Reply-To: <483A8671.6040409@biomserv.univ-lyon1.fr>
References: <1211790912.6630.14.camel@galadriel>
	<483A8671.6040409@biomserv.univ-lyon1.fr>
Message-ID: <1211801234.6630.22.camel@galadriel>

On Mon, 2008-05-26 at 11:44 +0200, Cl?ment Calenge wrote:
> Dear Anne,
[...]

> I guess, however, that you may have an habitat type which is not 
> available to any animal. 

I examined the dataframes, and this is the case. Two habitats aren't
available to any animal.
Thanks to have pointed it out!

> I will modify the function compana in the next version of adehabitat, so 
> that it reports an error when such cases occur.

Thanks a lot! You can count me among testers.

> However, it is difficult to know what happens exactly in your case 
> without any reproducible example.

Sorry for not have sent the data, but there is an article in press about
this and I wasn't allowed to publish them.

> Hope this helps,
> 
> 
> Cl?ment Calenge

regards,

Anne
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20080526/4f3913da/attachment.bin>

From edzer.pebesma at uni-muenster.de  Mon May 26 13:53:10 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 May 2008 13:53:10 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <483A7928.7090501@geo.uu.nl>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl>
Message-ID: <483AA4A6.2010101@uni-muenster.de>

Paul, calling for gurus is easy, but why don't you try to elaborate on 
the problems that you claim this approach has without telling Eelke what 
they are?
--
Edzer

Paul Hiemstra wrote:
> Hi Eelke,
>
> I would advise against filling up the RK grid with OK predictions. 
> Interpolating the predictors would have my preference, although it has 
> it own set of problems. What is the opinion of the r-sig-geo gurus on 
> this subject?
>
> cheers,
> Paul
>
> Eelke Folmer wrote:
>> Hello all,
>> I'm using Gstat/R for regression kriging. I don't have values for all 
>> locations in the predictor variables for which I want to interpolate 
>> a surface. I do however want to make use of the independent 
>> predictors. Therfor I combined regression kriging with ordinary kriging:
>> 1. regression kriging:     krige(log(cer+1) ~ pred1 + pred2 ,  data,  
>> data.pred.grid, model = vgm.fit1) 2. ordinary kriging:         
>> krige(log(cer+1) ~ 1,                     data,  pred.grid,        
>> model = vgm.fit0) 3. add the values from the second step to the grid 
>> where the first step gives NA:   s0 = surface.krige0 at data$var1.pred
>>   s1 = surface.krige1 at data$var1.pred
>>   s1[is.na(s1)] <- 0    # make the NA zero
>>   s0[!is.na(s1)] <- 0   # make everyting that is not NA in s1 zero
>>   s1 = s1 + s0          # now, all locations get a predicted value 
>> despite missing predictors
>> surface.krige at data$var1.pred.inclusive = s1
>>
>> Is this ok, or should I interpolate (in fact, extrapolate) the 
>> predictors to get values at all necessary locations instead? Better 
>> solutions available?
>> Thank you in advance for time and effort.
>> Best regards,
>> Eelke
>>
>> Eelke Folmer
>> Animal Ecology Group
>> University of Groningen
>> P. O. Box 14
>> 9750 AA Haren
>> The Netherlands
>> +31(0)50 3632091
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>   
>
>



From aloboaleu at gmail.com  Mon May 26 13:53:11 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Mon, 26 May 2008 13:53:11 +0200
Subject: [R-sig-Geo] spatial probit
Message-ID: <483AA4A7.3050605@gmail.com>

Is there an implementation of spatial probit models in R?
Could not find it in spdep

Thanks

Agus
-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From edzer.pebesma at uni-muenster.de  Mon May 26 13:54:33 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 May 2008 13:54:33 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <483A76B6.3070300@geo.uu.nl>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
	<483A76B6.3070300@geo.uu.nl>
Message-ID: <483AA4F9.9010906@uni-muenster.de>

Please note that this "regular" grid is still random, as the first point 
is sampled randomly from the first cell. For a fixed, reproducable grid, 
add the argument offset = c(0.5, 0.5)
--
Edzer

Paul Hiemstra wrote:
> Hi Mauricio,
>
> To get a grid based on a shapefile you can use the command "spsample".
>
> library(sp)
> library(maptools)
> source_poly = readShapePoly("/path/to/poly")
> # cellsize is in map units (e.g. km), also see "?spsample"
> grd = spsample(source_poly, cellsize = c(10e3,10e3), type = "regular")
> gridded(grd) = TRUE # Make it a grid
> summary(grd)
> # Visualize the grid
> spplot(source_poly, sp.layout = list("sp.points", grd))
>
> "grd" can now be used for interpolations.
>
> hth and cheers,
> Paul
>
> Mauricio Zambrano wrote:
>> Dear List,
>>
>> My question is about how to define the grid to be used for the
>> interpolations, using R 2.7.0 and gstat 0.9-47
>>
>> I'm working in a catchment of ~3000 km2, with daily rainfall data of
>> several stations (more than 40), and I would like to interpolate daily
>> values within all the catchment using ordinary Kriging.
>>
>> For defining the grid in which the interpolation will be carried out,
>> at the beginning, I tried with
>>
>> #setting a grid each 100m vertical and horizontal
>> dx <- seq(674400,730700,by=100)
>> dy <- seq(4615100,4744400,by=100)
>> catch.grid <- expand.grid(dx,dy)
>>
>> #setting the names of the columns of the grid
>> names(catch.grid) <- c("x","y")
>>
>> #setting the coordinates of the grid
>> coordinates(catch.grid) <- ~x+y
>>
>> #interpolating with the inverse distance
>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>>
>> #plotting the interpolated values
>> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>>
>> but looking at the figure I realized that the interpolations were
>> carried out considering all the cells within the squared grid, and not
>> only within the catchment.
>>
>> After, I tried reading a raster file (each 100m) and using it as the 
>> grid,
>>
>> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>>
>> but the results that I got seems to be wrong, because I got high
>> values where low values were expected and viceversa. (I really
>> appreciate any help clarifying me what I'm doing wrong )
>>
>> Is there any way to define a grid, starting from a shapefile of the
>> catchment boundaries ?. For example, I would like to define something
>> similar to the "meuse.grid" dataset.
>>
>> Thanks in advance and best regards
>>
>>   
>
>



From p.hiemstra at geo.uu.nl  Mon May 26 14:49:57 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 26 May 2008 14:49:57 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <483AA4A6.2010101@uni-muenster.de>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl> <483AA4A6.2010101@uni-muenster.de>
Message-ID: <483AB1F5.7000905@geo.uu.nl>

Point taken Edzer, I guess calling the gurus is the easy way out when I 
have difficulties formulating an answer :). But I will give it a shot.

I oppose mixing RK and OK because:
- There is no sound reason other than a pragmatical one to use OK. If 
you know that there are trends in the data it is not logical to not 
include them for part of the dataset, particularly if that part is large 
in comparison to the total study area (which I assume because if the 
area where small you (Eelke) would probably just exclude the area with 
no predictor information available).
- The kriging variance for the RK part and the OK part will be different 
(depending on the R^2 of the regression, more R^2 means lower kriging 
error in RK). So using the kriging variance in any subsequent analysis 
is questionable.

I would prefer interpolating the predictors. This ensures that you can 
use RK on the whole study area. A problem is that if you estimate the 
predictors through interpolation you introduce an additional error in 
the parts of the predictor map that are estimated. Consequently, any RK 
based on this estimated predictor will not yield good estimates of the 
kriging prediction variance.

So both approaches have their drawback, but I would prefer interpolating 
the predictor.

Eelke, if you don't have predictor values for all locations you could 
try co-kriging.

hth and cheers,
Paul

Edzer Pebesma wrote:
> Paul, calling for gurus is easy, but why don't you try to elaborate on 
> the problems that you claim this approach has without telling Eelke 
> what they are?
> -- 
> Edzer
>
> Paul Hiemstra wrote:
>> Hi Eelke,
>>
>> I would advise against filling up the RK grid with OK predictions. 
>> Interpolating the predictors would have my preference, although it 
>> has it own set of problems. What is the opinion of the r-sig-geo 
>> gurus on this subject?
>>
>> cheers,
>> Paul
>>
>> Eelke Folmer wrote:
>>> Hello all,
>>> I'm using Gstat/R for regression kriging. I don't have values for 
>>> all locations in the predictor variables for which I want to 
>>> interpolate a surface. I do however want to make use of the 
>>> independent predictors. Therfor I combined regression kriging with 
>>> ordinary kriging:
>>> 1. regression kriging:     krige(log(cer+1) ~ pred1 + pred2 ,  
>>> data,  data.pred.grid, model = vgm.fit1) 2. ordinary 
>>> kriging:         krige(log(cer+1) ~ 1,                     data,  
>>> pred.grid,        model = vgm.fit0) 3. add the values from the 
>>> second step to the grid where the first step gives NA:   s0 = 
>>> surface.krige0 at data$var1.pred
>>>   s1 = surface.krige1 at data$var1.pred
>>>   s1[is.na(s1)] <- 0    # make the NA zero
>>>   s0[!is.na(s1)] <- 0   # make everyting that is not NA in s1 zero
>>>   s1 = s1 + s0          # now, all locations get a predicted value 
>>> despite missing predictors
>>> surface.krige at data$var1.pred.inclusive = s1
>>>
>>> Is this ok, or should I interpolate (in fact, extrapolate) the 
>>> predictors to get values at all necessary locations instead? Better 
>>> solutions available?
>>> Thank you in advance for time and effort.
>>> Best regards,
>>> Eelke
>>>
>>> Eelke Folmer
>>> Animal Ecology Group
>>> University of Groningen
>>> P. O. Box 14
>>> 9750 AA Haren
>>> The Netherlands
>>> +31(0)50 3632091
>>>     [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>   
>>
>>
>


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From edzer.pebesma at uni-muenster.de  Mon May 26 15:08:17 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 May 2008 15:08:17 +0200
Subject: [R-sig-Geo] Ordinary and Regression Kriging combined to deal
 with	missing values in predictor variables
In-Reply-To: <483AB1F5.7000905@geo.uu.nl>
References: <004c01c8bc1e$3d0d1f10$e5847d81@129125132229>
	<483A7928.7090501@geo.uu.nl> <483AA4A6.2010101@uni-muenster.de>
	<483AB1F5.7000905@geo.uu.nl>
Message-ID: <483AB641.1040201@uni-muenster.de>

Paul Hiemstra wrote:
>
> Eelke, if you don't have predictor values for all locations you could 
> try co-kriging.
>
which is indeed theoretically the better approach.

Thanks,
--
Edzer



From Bjarke.Christensen at sydbank.dk  Tue May 27 12:40:48 2008
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Tue, 27 May 2008 12:40:48 +0200
Subject: [R-sig-Geo] spatial probit
In-Reply-To: <mailman.9.1211882402.13486.r-sig-geo@stat.math.ethz.ch>
Message-ID: <OF6B0AF9A3.236D1C6F-ONC1257456.003910E2-C1257456.003AAAB8@bdpnet.dk>

Agus,

I recently asked a very similar question, and got the following thoughtful
reply from Roger Bivand:
https://stat.ethz.ch/pipermail/r-sig-geo/2008-May/003527.html

For my purpose, which is to estimate probabilities for use in an inverse
probability weighted regression, I've decided to explore alternative
routes, but if you find a way to estimate a probit model with a spatially
lagged limited dependent variable as a predictor, I'd be interested in
hearing about it as well.

Bjarke Christensen



From Agustin.Lobo at ija.csic.es  Tue May 27 12:48:23 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Tue, 27 May 2008 12:48:23 +0200
Subject: [R-sig-Geo] spatial probit
In-Reply-To: <OF6B0AF9A3.236D1C6F-ONC1257456.003910E2-C1257456.003AAAB8@bdpnet.dk>
References: <OF6B0AF9A3.236D1C6F-ONC1257456.003910E2-C1257456.003AAAB8@bdpnet.dk>
Message-ID: <483BE6F7.6030407@ija.csic.es>

Thanks, I'll keep you posted.
BTW, I tried to search the r-sig-geo list, but only
the "regular" R lists were searchable. Am I
wrong?
Agus

Bjarke Christensen wrote:
> Agus,
> 
> I recently asked a very similar question, and got the following thoughtful
> reply from Roger Bivand:
> https://stat.ethz.ch/pipermail/r-sig-geo/2008-May/003527.html
> 
> For my purpose, which is to estimate probabilities for use in an inverse
> probability weighted regression, I've decided to explore alternative
> routes, but if you find a way to estimate a probit model with a spatially
> lagged limited dependent variable as a predictor, I'd be interested in
> hearing about it as well.
> 
> Bjarke Christensen
> 
> 

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From marcelino.delacruz at upm.es  Tue May 27 13:18:11 2008
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 27 May 2008 13:18:11 +0200
Subject: [R-sig-Geo] spatial probit
In-Reply-To: <483BE6F7.6030407@ija.csic.es>
References: <OF6B0AF9A3.236D1C6F-ONC1257456.003910E2-C1257456.003AAAB8@bdpnet.dk>
	<483BE6F7.6030407@ija.csic.es>
Message-ID: <200805271118.m4RBI4Me018929@edison.ccupm.upm.es>

At least, the R-site search of Jonathan Baron,

http://finzi.psych.upenn.edu/search.html

searchs also the r-sig-geo list

Regards,

Marcelino



At 12:48 27/05/2008, Agustin Lobo wrote:
>Thanks, I'll keep you posted.
>BTW, I tried to search the r-sig-geo list, but only
>the "regular" R lists were searchable. Am I
>wrong?
>Agus
>
>Bjarke Christensen wrote:
>>Agus,
>>I recently asked a very similar question, and got the following thoughtful
>>reply from Roger Bivand:
>>https://stat.ethz.ch/pipermail/r-sig-geo/2008-May/003527.html
>>For my purpose, which is to estimate probabilities for use in an inverse
>>probability weighted regression, I've decided to explore alternative
>>routes, but if you find a way to estimate a probit model with a spatially
>>lagged limited dependent variable as a predictor, I'd be interested in
>>hearing about it as well.
>>Bjarke Christensen
>
>--
>Dr. Agustin Lobo
>Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
>LLuis Sole Sabaris s/n
>08028 Barcelona
>Spain
>Tel. 34 934095410
>Fax. 34 934110012
>email: Agustin.Lobo at ija.csic.es
>http://www.ija.csic.es/gt/obster
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es



From aloboaleu at gmail.com  Tue May 27 15:06:59 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Tue, 27 May 2008 15:06:59 +0200
Subject: [R-sig-Geo] r-sig-geo searchable archieves (from Re: spatial probit)
Message-ID: <483C0773.8090508@gmail.com>

Marcelino de la Cruz wrote:
 > At least, the R-site search of Jonathan Baron,
 >
 > http://finzi.psych.upenn.edu/search.html
 >
 > searchs also the r-sig-geo list
 >
 > Regards,
 >
 > Marcelino
 >

Good to know, because
at the bottom of that page the choices are:

Target:
Functions
R-help 2002-
Rhelp 1997-2001
R-devel

Agus
-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From v.gomezrubio at imperial.ac.uk  Tue May 27 15:21:29 2008
From: v.gomezrubio at imperial.ac.uk (Virgilio Gomez-Rubio)
Date: Tue, 27 May 2008 14:21:29 +0100
Subject: [R-sig-Geo] r-sig-geo searchable archieves (from Re:
	spatial	probit)
In-Reply-To: <483C0773.8090508@gmail.com>
References: <483C0773.8090508@gmail.com>
Message-ID: <1211894489.6079.11.camel@fh-vrubio>

Hi,

Have you tried the RSiteSearch() command? For example, if you write

RSiteSearch("gdal problem")

the browser will come up and you will be shown the results of a search
in the main R malining lists. Personally, I find this way of searching
the most convenient.

Best regards,

VIrgilio


On Tue, 2008-05-27 at 15:06 +0200, Agustin Lobo wrote:
> Marcelino de la Cruz wrote:
>  > At least, the R-site search of Jonathan Baron,
>  >
>  > http://finzi.psych.upenn.edu/search.html
>  >
>  > searchs also the r-sig-geo list
>  >
>  > Regards,
>  >
>  > Marcelino
>  >
> 
> Good to know, because
> at the bottom of that page the choices are:
> 
> Target:
> Functions
> R-help 2002-
> Rhelp 1997-2001
> R-devel
> 
> Agus



From hzambran.newsgroups at gmail.com  Tue May 27 15:26:55 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Tue, 27 May 2008 15:26:55 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <483AA4F9.9010906@uni-muenster.de>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
	<483A76B6.3070300@geo.uu.nl> <483AA4F9.9010906@uni-muenster.de>
Message-ID: <63d616b0805270626w7aedf098y5879bd1346d93ff1@mail.gmail.com>

Dear Paul and Edzer,

Thanks a lot for your answers.

Before reading the solution proposed by Paul, I had tried with:

# reading the boundary of the catchment
library(maptools)
catchment <- readShapePoly("only_catchment.shp")
catchment.grid <- spsample(catchment, cellsize=100, offset = c(0.5,
0.5)) # reading the boundary of the catchment

 and then I did an IDW interpolation with:

pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo, catchment.grid)

and it works.

However, after reading your solution, I realised that I didn't use the command:

gridded(catchment.grid)

but I got an interpolation anyway.

Where is performed the interpolation when I don't use a gridded grid (
gridded(catchment.grid) ) ?

Best regards

Mauricio

2008/5/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> Please note that this "regular" grid is still random, as the first point is
> sampled randomly from the first cell. For a fixed, reproducable grid, add
> the argument offset = c(0.5, 0.5)
> --
> Edzer
>
> Paul Hiemstra wrote:
>>
>> Hi Mauricio,
>>
>> To get a grid based on a shapefile you can use the command "spsample".
>>
>> library(sp)
>> library(maptools)
>> source_poly = readShapePoly("/path/to/poly")
>> # cellsize is in map units (e.g. km), also see "?spsample"
>> grd = spsample(source_poly, cellsize = c(10e3,10e3), type = "regular")
>> gridded(grd) = TRUE # Make it a grid
>> summary(grd)
>> # Visualize the grid
>> spplot(source_poly, sp.layout = list("sp.points", grd))
>>
>> "grd" can now be used for interpolations.
>>
>> hth and cheers,
>> Paul
>>
>> Mauricio Zambrano wrote:
>>>
>>> Dear List,
>>>
>>> My question is about how to define the grid to be used for the
>>> interpolations, using R 2.7.0 and gstat 0.9-47
>>>
>>> I'm working in a catchment of ~3000 km2, with daily rainfall data of
>>> several stations (more than 40), and I would like to interpolate daily
>>> values within all the catchment using ordinary Kriging.
>>>
>>> For defining the grid in which the interpolation will be carried out,
>>> at the beginning, I tried with
>>>
>>> #setting a grid each 100m vertical and horizontal
>>> dx <- seq(674400,730700,by=100)
>>> dy <- seq(4615100,4744400,by=100)
>>> catch.grid <- expand.grid(dx,dy)
>>>
>>> #setting the names of the columns of the grid
>>> names(catch.grid) <- c("x","y")
>>>
>>> #setting the coordinates of the grid
>>> coordinates(catch.grid) <- ~x+y
>>>
>>> #interpolating with the inverse distance
>>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_catch_nNA, catch.grid)
>>>
>>> #plotting the interpolated values
>>> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>>>
>>> but looking at the figure I realized that the interpolations were
>>> carried out considering all the cells within the squared grid, and not
>>> only within the catchment.
>>>
>>> After, I tried reading a raster file (each 100m) and using it as the
>>> grid,
>>>
>>> DEMM100m <- read.asciigrid("Catch_DEM_c100m")
>>>
>>> but the results that I got seems to be wrong, because I got high
>>> values where low values were expected and viceversa. (I really
>>> appreciate any help clarifying me what I'm doing wrong )
>>>
>>> Is there any way to define a grid, starting from a shapefile of the
>>> catchment boundaries ?. For example, I would like to define something
>>> similar to the "meuse.grid" dataset.
>>>
>>> Thanks in advance and best regards
>>>
>>>
>>
>>
>
>



-- 
hzambran

Linux user #454569 -- Ubuntu user #17469



From edzer.pebesma at uni-muenster.de  Tue May 27 15:34:45 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 27 May 2008 15:34:45 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805270626w7aedf098y5879bd1346d93ff1@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>	
	<483A76B6.3070300@geo.uu.nl> <483AA4F9.9010906@uni-muenster.de>
	<63d616b0805270626w7aedf098y5879bd1346d93ff1@mail.gmail.com>
Message-ID: <483C0DF5.8020905@uni-muenster.de>

Mauricio Zambrano wrote:
> Dear Paul and Edzer,
>
> Thanks a lot for your answers.
>
> Before reading the solution proposed by Paul, I had tried with:
>
> # reading the boundary of the catchment
> library(maptools)
> catchment <- readShapePoly("only_catchment.shp")
> catchment.grid <- spsample(catchment, cellsize=100, offset = c(0.5,
> 0.5)) # reading the boundary of the catchment
>
>  and then I did an IDW interpolation with:
>
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo, catchment.grid)
>
> and it works.
>
> However, after reading your solution, I realised that I didn't use the command:
>
> gridded(catchment.grid)
>
> but I got an interpolation anyway.
>
> Where is performed the interpolation when I don't use a gridded grid (
> gridded(catchment.grid) ) ?
>   
it is actually

gridded(catchment.grid) <- TRUE

that changes the object, if it not gridded.

For interpolation, it doesn't matter whether you loop over a set of 
points, or a set of points on a grid.
--
Edzer



From hzambran.newsgroups at gmail.com  Tue May 27 15:41:53 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Tue, 27 May 2008 15:41:53 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <483C0DF5.8020905@uni-muenster.de>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>
	<483A76B6.3070300@geo.uu.nl> <483AA4F9.9010906@uni-muenster.de>
	<63d616b0805270626w7aedf098y5879bd1346d93ff1@mail.gmail.com>
	<483C0DF5.8020905@uni-muenster.de>
Message-ID: <63d616b0805270641m2a015c88t959b76734eab18d@mail.gmail.com>

2008/5/27 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> Mauricio Zambrano wrote:
>>
>> Dear Paul and Edzer,
>>
>> Thanks a lot for your answers.
>>
>> Before reading the solution proposed by Paul, I had tried with:
>>
>> # reading the boundary of the catchment
>> library(maptools)
>> catchment <- readShapePoly("only_catchment.shp")
>> catchment.grid <- spsample(catchment, cellsize=100, offset = c(0.5,
>> 0.5)) # reading the boundary of the catchment
>>
>>  and then I did an IDW interpolation with:
>>
>> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo, catchment.grid)
>>
>> and it works.
>>
>> However, after reading your solution, I realised that I didn't use the
>> command:
>>
>> gridded(catchment.grid)
>>
>> but I got an interpolation anyway.
>>
>> Where is performed the interpolation when I don't use a gridded grid (
>> gridded(catchment.grid) ) ?
>>
>
> it is actually
>
> gridded(catchment.grid) <- TRUE

Sorry for the mistake.

>
> that changes the object, if it not gridded.
>
> For interpolation, it doesn't matter whether you loop over a set of points,
> or a set of points on a grid.

But if the object (catchment.grid) is not gridded, what points are
used for carrying out the interpolation "pp.idw <-
krige(PP_DAILY_MEAN_MM~1, meteo, catchment.grid "?

> --
> Edzer
>

Mauricio

Linux user  #454569 -- Ubuntu user #17469



From edzer.pebesma at uni-muenster.de  Tue May 27 15:51:56 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 27 May 2008 15:51:56 +0200
Subject: [R-sig-Geo] Defining a grid for interpolations ?
In-Reply-To: <63d616b0805270641m2a015c88t959b76734eab18d@mail.gmail.com>
References: <63d616b0805230512j2c36f083h7e48fcd81b86f55a@mail.gmail.com>	
	<483A76B6.3070300@geo.uu.nl> <483AA4F9.9010906@uni-muenster.de>	
	<63d616b0805270626w7aedf098y5879bd1346d93ff1@mail.gmail.com>	
	<483C0DF5.8020905@uni-muenster.de>
	<63d616b0805270641m2a015c88t959b76734eab18d@mail.gmail.com>
Message-ID: <483C11FC.8000302@uni-muenster.de>

Mauricio Zambrano wrote:
> But if the object (catchment.grid) is not gridded, what points are
> used for carrying out the interpolation "pp.idw <-
> krige(PP_DAILY_MEAN_MM~1, meteo, catchment.grid "?
>
>   
The points in catchment.grid. After all, a grid is just a set of points 
that happens to have some geometrical organization.
--
Edzer



From p.hiemstra at geo.uu.nl  Tue May 27 16:07:34 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 27 May 2008 16:07:34 +0200
Subject: [R-sig-Geo] r-sig-geo searchable archieves (from Re:	spatial
 probit)
In-Reply-To: <1211894489.6079.11.camel@fh-vrubio>
References: <483C0773.8090508@gmail.com> <1211894489.6079.11.camel@fh-vrubio>
Message-ID: <483C15A6.7000308@geo.uu.nl>

Hi,

Just typing "R words describing your problem" in Google also yields good 
results.

cheers,
Paul

Virgilio Gomez-Rubio wrote:
> Hi,
>
> Have you tried the RSiteSearch() command? For example, if you write
>
> RSiteSearch("gdal problem")
>
> the browser will come up and you will be shown the results of a search
> in the main R malining lists. Personally, I find this way of searching
> the most convenient.
>
> Best regards,
>
> VIrgilio
>
>
> On Tue, 2008-05-27 at 15:06 +0200, Agustin Lobo wrote:
>   
>> Marcelino de la Cruz wrote:
>>  > At least, the R-site search of Jonathan Baron,
>>  >
>>  > http://finzi.psych.upenn.edu/search.html
>>  >
>>  > searchs also the r-sig-geo list
>>  >
>>  > Regards,
>>  >
>>  > Marcelino
>>  >
>>
>> Good to know, because
>> at the bottom of that page the choices are:
>>
>> Target:
>> Functions
>> R-help 2002-
>> Rhelp 1997-2001
>> R-devel
>>
>> Agus
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From hzambran.newsgroups at gmail.com  Tue May 27 16:55:22 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Tue, 27 May 2008 16:55:22 +0200
Subject: [R-sig-Geo] Problem finding the centroid of a polygon with
	get.Pcent
In-Reply-To: <Pine.LNX.4.64.0805231800510.30982@reclus.nhh.no>
References: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com>
	<Pine.LNX.4.64.0805231800510.30982@reclus.nhh.no>
Message-ID: <63d616b0805270755p6f8d6b38re427b341b3c7f16a@mail.gmail.com>

Dear Roger,

2008/5/23 Roger Bivand <Roger.Bivand at nhh.no>:
> On Fri, 23 May 2008, Mauricio Zambrano wrote:
>
>> Dear List,
>>
>> For finding the centroid of a catchment, I tried with the function:
>>
>> get.Pcent(gallego_catchment)
>>
>> but I got the following  error:
>>
>> Error en get.Pcent(gallego_catchment) : not a Map object
>>
>> However, I checked the class:
>>
>>> class(gallego_catchment)
>>
>> [1] "SpatialPolygonsDataFrame"
>> attr(,"package")
>> [1] "sp"
>
> Just say coordinates(gallego_catchment) to extract the "centroid" -
> labelpoint - for each Polygons object - the coordinates() method retrieves
> the label points.

Does it mean that the coordinates of the centroid are stored within
the shapefile, or  are they computed by the coordinates command ?.

Note that a "Map" object is not a
> "SpatialPolygonsDataFrame" object, and indeed "Map" objects are only used
> internally in some limited settings. You are muddling up classes. Installing
> rgdal properly would make sure you only saw the "SpatialPolygonsDataFrame"
> object, which is all you need.
>
Thanks for your answer and for clarifying my confusion about the Map
and SpatialPolygonsDataFrame class.
I have gdal 1.5.1-3 installed in my linux system, and when I tried to
load the "rgdal" library whitin R, I got the following error:

library(rgdal)
Error in fun(...) :
	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
compartido: No existe el fichero ? directorio

Error : .onLoad failed in 'loadNamespace' for 'rgdal'
Error: package/namespace load failed for 'rgdal'

I uninstalled the rgdal package, then installed again with:

install.packages("rgdal", dependencies = TRUE)	

but when I tried to load it again, I got the same error:

library(rgdal)
Loading required package: sp
Error in fun(...) :
	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
compartido: No existe el fichero ? directorio

Error : .onLoad failed in 'loadNamespace' for 'rgdal'
Error: package/namespace load failed for 'rgdal'

Do you have any idea about what could be my problem ?.

Thanks in advance

Mauricio

> Roger
>
>>
>> and I read the catchment boundary with:
>>
>> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>> # reading the boundary of the gallego catchment
>> library(maptools)
>> gallego_catchment <- readShapePoly("only_gallego_catchment.shp",
>> proj4string=p4s)
>>
>> Could somebody tell me if I'm doing something wrong?
>>
>> Thanks in advance
>>
>> Mauricio
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From Roger.Bivand at nhh.no  Tue May 27 17:11:27 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 May 2008 17:11:27 +0200 (CEST)
Subject: [R-sig-Geo] Problem finding the centroid of a polygon with
 get.Pcent
In-Reply-To: <63d616b0805270755p6f8d6b38re427b341b3c7f16a@mail.gmail.com>
References: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com> 
	<Pine.LNX.4.64.0805231800510.30982@reclus.nhh.no>
	<63d616b0805270755p6f8d6b38re427b341b3c7f16a@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805271705370.19333@reclus.nhh.no>

On Tue, 27 May 2008, Mauricio Zambrano wrote:

> Dear Roger,
>
> 2008/5/23 Roger Bivand <Roger.Bivand at nhh.no>:
>> On Fri, 23 May 2008, Mauricio Zambrano wrote:
>>
>>> Dear List,
>>>
>>> For finding the centroid of a catchment, I tried with the function:
>>>
>>> get.Pcent(gallego_catchment)
>>>
>>> but I got the following  error:
>>>
>>> Error en get.Pcent(gallego_catchment) : not a Map object
>>>
>>> However, I checked the class:
>>>
>>>> class(gallego_catchment)
>>>
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>
>> Just say coordinates(gallego_catchment) to extract the "centroid" -
>> labelpoint - for each Polygons object - the coordinates() method retrieves
>> the label points.
>
> Does it mean that the coordinates of the centroid are stored within
> the shapefile, or  are they computed by the coordinates command ?.

The shapefile is a collection of files in your file-system. It is not 
present in the R workspace. It is read into a Spatial*DataFrame object, 
which in the case of SpatialPolygonsDataFrame objects, does return the 
precomputed label point of the largest constituent polygon for each 
observation when the coordinates() method is used.

>
> Note that a "Map" object is not a
>> "SpatialPolygonsDataFrame" object, and indeed "Map" objects are only used
>> internally in some limited settings. You are muddling up classes. Installing
>> rgdal properly would make sure you only saw the "SpatialPolygonsDataFrame"
>> object, which is all you need.
>>
> Thanks for your answer and for clarifying my confusion about the Map
> and SpatialPolygonsDataFrame class.
> I have gdal 1.5.1-3 installed in my linux system, and when I tried to
> load the "rgdal" library whitin R, I got the following error:
>
> library(rgdal)
> Error in fun(...) :
> 	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
> compartido: No existe el fichero ? directorio

I already replied that you have a stale GRASS OGR plugin on your system, 
that GDAL can see, but where its dependency on libgrass_I.so is not 
fulfilled. I'm sure that no other GDAL programmes work. Make GDAL work 
first (even just gdalinfo --version) and rgdal will work. As I suggested 
before, you need to tread carefully when using binary versions of 
QGIS/GDAL etc.

Roger

>
> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
> Error: package/namespace load failed for 'rgdal'
>
> I uninstalled the rgdal package, then installed again with:
>
> install.packages("rgdal", dependencies = TRUE)
>
> but when I tried to load it again, I got the same error:
>
> library(rgdal)
> Loading required package: sp
> Error in fun(...) :
> 	GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
> compartido: No existe el fichero ? directorio
>
> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
> Error: package/namespace load failed for 'rgdal'
>
> Do you have any idea about what could be my problem ?.
>
> Thanks in advance
>
> Mauricio
>
>> Roger
>>
>>>
>>> and I read the catchment boundary with:
>>>
>>> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>>> # reading the boundary of the gallego catchment
>>> library(maptools)
>>> gallego_catchment <- readShapePoly("only_gallego_catchment.shp",
>>> proj4string=p4s)
>>>
>>> Could somebody tell me if I'm doing something wrong?
>>>
>>> Thanks in advance
>>>
>>> Mauricio
>>>
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hzambran.newsgroups at gmail.com  Tue May 27 17:48:59 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Tue, 27 May 2008 17:48:59 +0200
Subject: [R-sig-Geo] Problem finding the centroid of a polygon with
	get.Pcent
In-Reply-To: <Pine.LNX.4.64.0805271705370.19333@reclus.nhh.no>
References: <63d616b0805230854v5a56236dm4d77cc8441cf5e1a@mail.gmail.com>
	<Pine.LNX.4.64.0805231800510.30982@reclus.nhh.no>
	<63d616b0805270755p6f8d6b38re427b341b3c7f16a@mail.gmail.com>
	<Pine.LNX.4.64.0805271705370.19333@reclus.nhh.no>
Message-ID: <63d616b0805270848n234eb54bu3f57c7596a1826aa@mail.gmail.com>

2008/5/27 Roger Bivand <Roger.Bivand at nhh.no>:
> On Tue, 27 May 2008, Mauricio Zambrano wrote:
>
>> Dear Roger,
>>
>> 2008/5/23 Roger Bivand <Roger.Bivand at nhh.no>:
>>>
>>> On Fri, 23 May 2008, Mauricio Zambrano wrote:
>>>
>>>> Dear List,
>>>>
>>>> For finding the centroid of a catchment, I tried with the function:
>>>>
>>>> get.Pcent(gallego_catchment)
>>>>
>>>> but I got the following  error:
>>>>
>>>> Error en get.Pcent(gallego_catchment) : not a Map object
>>>>
>>>> However, I checked the class:
>>>>
>>>>> class(gallego_catchment)
>>>>
>>>> [1] "SpatialPolygonsDataFrame"
>>>> attr(,"package")
>>>> [1] "sp"
>>>
>>> Just say coordinates(gallego_catchment) to extract the "centroid" -
>>> labelpoint - for each Polygons object - the coordinates() method
>>> retrieves
>>> the label points.
>>
>> Does it mean that the coordinates of the centroid are stored within
>> the shapefile, or  are they computed by the coordinates command ?.
>
> The shapefile is a collection of files in your file-system. It is not
> present in the R workspace. It is read into a Spatial*DataFrame object,
> which in the case of SpatialPolygonsDataFrame objects, does return the
> precomputed label point of the largest constituent polygon for each
> observation when the coordinates() method is used.
>
>>
>> Note that a "Map" object is not a
>>>
>>> "SpatialPolygonsDataFrame" object, and indeed "Map" objects are only used
>>> internally in some limited settings. You are muddling up classes.
>>> Installing
>>> rgdal properly would make sure you only saw the
>>> "SpatialPolygonsDataFrame"
>>> object, which is all you need.
>>>
>> Thanks for your answer and for clarifying my confusion about the Map
>> and SpatialPolygonsDataFrame class.
>> I have gdal 1.5.1-3 installed in my linux system, and when I tried to
>> load the "rgdal" library whitin R, I got the following error:
>>
>> library(rgdal)
>> Error in fun(...) :
>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>> compartido: No existe el fichero ? directorio
>
> I already replied that you have a stale GRASS OGR plugin on your system,
> that GDAL can see, but where its dependency on libgrass_I.so is not
> fulfilled. I'm sure that no other GDAL programmes work. Make GDAL work first
> (even just gdalinfo --version) and rgdal will work. As I suggested before,
> you need to tread carefully when using binary versions of QGIS/GDAL etc.
>
> Roger

Thanks for your help. The problem was the "libgdal1-1.4.0-grass"
required by the "qgis-plugin-grass", so, I uninstalled the last one.

Best regards

Mauricio
>
>>
>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>> Error: package/namespace load failed for 'rgdal'
>>
>> I uninstalled the rgdal package, then installed again with:
>>
>> install.packages("rgdal", dependencies = TRUE)
>>
>> but when I tried to load it again, I got the same error:
>>
>> library(rgdal)
>> Loading required package: sp
>> Error in fun(...) :
>>        GDAL Error 1: libgrass_I.so: no se puede abr?r el archivo de objeto
>> compartido: No existe el fichero ? directorio
>>
>> Error : .onLoad failed in 'loadNamespace' for 'rgdal'
>> Error: package/namespace load failed for 'rgdal'
>>
>> Do you have any idea about what could be my problem ?.
>>
>> Thanks in advance
>>
>> Mauricio
>>
>>> Roger
>>>
>>>>
>>>> and I read the catchment boundary with:
>>>>
>>>> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>>>> # reading the boundary of the gallego catchment
>>>> library(maptools)
>>>> gallego_catchment <- readShapePoly("only_gallego_catchment.shp",
>>>> proj4string=p4s)
>>>>
>>>> Could somebody tell me if I'm doing something wrong?
>>>>
>>>> Thanks in advance
>>>>
>>>> Mauricio
>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>



-- 
hzambran

Linux user  #454569 -- Ubuntu user #17469



From fhds2000 at yahoo.com  Tue May 27 22:49:13 2008
From: fhds2000 at yahoo.com (F. De Sales)
Date: Tue, 27 May 2008 13:49:13 -0700 (PDT)
Subject: [R-sig-Geo] Help with Haar's wavelet decomposition
In-Reply-To: <63d616b0805270848n234eb54bu3f57c7596a1826aa@mail.gmail.com>
Message-ID: <32057.64596.qm@web53305.mail.re2.yahoo.com>

    Hello all,
    Would know how to re-construct the original field
using the outputs from the dwt.2d function?
    I am getting the decomposition by entering:

    E.dwt <- dwt.2d (E, wf="haar", J=4)
    
    as outputs I get a set 12 of arrays: HH1, LH1,
HL1, HH2, LH2, HL2, ..., HL4.

   The question is, how to get back to E using the 12
arrays?

   Any help will be appreciated.
   Fernando DeSales



From E.O.Folmer at rug.nl  Wed May 28 13:53:58 2008
From: E.O.Folmer at rug.nl (Eelke Folmer)
Date: Wed, 28 May 2008 13:53:58 +0200
Subject: [R-sig-Geo] spatial probit
In-Reply-To: <OF6B0AF9A3.236D1C6F-ONC1257456.003910E2-C1257456.003AAAB8@bdpnet.dk>
Message-ID: <200805281154.m4SBsI7J015242@hypatia.math.ethz.ch>

Roger Bivand mentions LeSage's matlab toolbox
(http://www.spatial-econometrics.com/), including very clear manuals with
theory. I am unable to judge the theoretical validity of the routines but I
experienced that I was able to estimate parameters of spatial probit
regression models (with MCMC) that reflected the parameters used in the
data-generating process.
Regards,
Eelke Folmer


-----Original Message-----
From: Bjarke Christensen [mailto:Bjarke.Christensen at sydbank.dk] 
Sent: 27 May 2008 12:41
To: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] spatial probit

Agus,

I recently asked a very similar question, and got the following thoughtful
reply from Roger Bivand:
https://stat.ethz.ch/pipermail/r-sig-geo/2008-May/003527.html

For my purpose, which is to estimate probabilities for use in an inverse
probability weighted regression, I've decided to explore alternative
routes, but if you find a way to estimate a probit model with a spatially
lagged limited dependent variable as a predictor, I'd be interested in
hearing about it as well.

Bjarke Christensen



From hzambran.newsgroups at gmail.com  Wed May 28 16:21:18 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Wed, 28 May 2008 16:21:18 +0200
Subject: [R-sig-Geo] Problem overlying Kriging grid with measurement points
Message-ID: <63d616b0805280721s3b026989g5c055d14e3ccb5c3@mail.gmail.com>

Dear List,

I carried out a IDW interpolation and I got a plot of the
interpolations values over the grid that I defined.

However, for a better interpretation of the results, I would like to
plot, over the Kriging grid, the points that were used as data for the
interpolation, which are stored in a shapefile.

For doing this, I tried with:
spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]", sp.layout =
list("SpatialPointsDataFrame", meteo_pt[,"PP_DAILY_MEAN_MM"] ) )

but I only get the plot of the interpolated value over the grid, and
the plot shows the following error message:

"error using packet 1"
"Missing 'data' argument, no omission value"

Could you give some hint about what I'm doing wrong ?.

Additional information is:

class(pp.idw)
[1] "SpatialPixelsDataFrame"
attr(,"package")
[1] "sp"

 class(meteo_pt)
[1] "SpatialPointsDataFrame"
attr(,"package")
[1] "sp"


And complete tried procedure:

p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")

meteo <- read.csv2("Meteorological_by_basin.csv")

# Selecting only those stations that have a NON "NA" value on the
field "PP_DAILY_MEAN_MM":
meteo_nna <- meteo[!is.na(meteo[,"PP_DAILY_MEAN_MM"]),]

# Settting the COORDINATES
coordinates(meteo_nna) <- ~EAST_ED50 + NORTH_ED50

# Projecting the coordinates of the meteorological stations into the
right system
proj4string(meteo_nna) = p4s
#proj4string(meteo_nna) <- CRS("+init=epsg:28992") ; # another way to
set up the coordinates

# Reading the boundary of the catchment
library(maptools)
catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)

# Defining a sampling GRID of 1000mx1000m with regular spacing
# For avoiding a random grid (sampled randomly from the first cell),
and getting a fixed,
# and reproducable grid, it is neccessary to add the argument "offset
= c(0.5, 0.5)"
catchment.grid <- spsample(catchment, type="regular", cellsize=1000,
offset = c(0.5, 0.5))

# Makin possible that the grid can be used in the interpolations:
gridded(catchment.grid) <- TRUE

# Plotting the grid
spplot(catchment, sp.layout = list("sp.points", catchment.grid))

library(gstat)
# Interpolating with the INVERSE DISTANCE WEIGHTED
pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_nna, catchment.grid)

# Plotting the interpolated values
spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")

# Reading the Meteorologicla Stations whitin the cachment
meteo_pt <- readShapePoints("meteo_by_basin.shp", proj4string=p4s)

#Attempting to get the overlay:
spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]", sp.layout =
list("SpatialPointsDataFrame", meteo_pt[,"PP_DAILY_MEAN_MM"] ) )


Thanks in advance,

Mauricio

-- 
Linux user #454569 -- Ubuntu user #17469



From Roger.Bivand at nhh.no  Wed May 28 16:31:49 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 May 2008 16:31:49 +0200 (CEST)
Subject: [R-sig-Geo] Problem overlying Kriging grid with measurement
 points
In-Reply-To: <63d616b0805280721s3b026989g5c055d14e3ccb5c3@mail.gmail.com>
References: <63d616b0805280721s3b026989g5c055d14e3ccb5c3@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0805281630020.24036@reclus.nhh.no>

On Wed, 28 May 2008, Mauricio Zambrano wrote:

> Dear List,
>
> I carried out a IDW interpolation and I got a plot of the
> interpolations values over the grid that I defined.
>
> However, for a better interpretation of the results, I would like to
> plot, over the Kriging grid, the points that were used as data for the
> interpolation, which are stored in a shapefile.
>
> For doing this, I tried with:
> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]", sp.layout =
> list("SpatialPointsDataFrame", meteo_pt[,"PP_DAILY_MEAN_MM"] ) )
>
> but I only get the plot of the interpolated value over the grid, and
> the plot shows the following error message:
>
> "error using packet 1"
> "Missing 'data' argument, no omission value"
>
> Could you give some hint about what I'm doing wrong ?.

sp.layout=list("sp.points", meteo_pt)

See Note in ?spplot

Roger

>
> Additional information is:
>
> class(pp.idw)
> [1] "SpatialPixelsDataFrame"
> attr(,"package")
> [1] "sp"
>
> class(meteo_pt)
> [1] "SpatialPointsDataFrame"
> attr(,"package")
> [1] "sp"
>
>
> And complete tried procedure:
>
> p4s <- CRS("+proj=utm +zone=30 +ellps=intl +units=m +no_defs")
>
> meteo <- read.csv2("Meteorological_by_basin.csv")
>
> # Selecting only those stations that have a NON "NA" value on the
> field "PP_DAILY_MEAN_MM":
> meteo_nna <- meteo[!is.na(meteo[,"PP_DAILY_MEAN_MM"]),]
>
> # Settting the COORDINATES
> coordinates(meteo_nna) <- ~EAST_ED50 + NORTH_ED50
>
> # Projecting the coordinates of the meteorological stations into the
> right system
> proj4string(meteo_nna) = p4s
> #proj4string(meteo_nna) <- CRS("+init=epsg:28992") ; # another way to
> set up the coordinates
>
> # Reading the boundary of the catchment
> library(maptools)
> catchment <- readShapePoly("only_catchment.shp", proj4string=p4s)
>
> # Defining a sampling GRID of 1000mx1000m with regular spacing
> # For avoiding a random grid (sampled randomly from the first cell),
> and getting a fixed,
> # and reproducable grid, it is neccessary to add the argument "offset
> = c(0.5, 0.5)"
> catchment.grid <- spsample(catchment, type="regular", cellsize=1000,
> offset = c(0.5, 0.5))
>
> # Makin possible that the grid can be used in the interpolations:
> gridded(catchment.grid) <- TRUE
>
> # Plotting the grid
> spplot(catchment, sp.layout = list("sp.points", catchment.grid))
>
> library(gstat)
> # Interpolating with the INVERSE DISTANCE WEIGHTED
> pp.idw <- krige(PP_DAILY_MEAN_MM~1, meteo_nna, catchment.grid)
>
> # Plotting the interpolated values
> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]")
>
> # Reading the Meteorologicla Stations whitin the cachment
> meteo_pt <- readShapePoints("meteo_by_basin.shp", proj4string=p4s)
>
> #Attempting to get the overlay:
> spplot(pp.idw["var1.pred"], main="Daily Mean PP, [mm]", sp.layout =
> list("SpatialPointsDataFrame", meteo_pt[,"PP_DAILY_MEAN_MM"] ) )
>
>
> Thanks in advance,
>
> Mauricio
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hzambran.newsgroups at gmail.com  Wed May 28 16:53:12 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Wed, 28 May 2008 16:53:12 +0200
Subject: [R-sig-Geo] Problem overlying Kriging grid with measurement
	points
In-Reply-To: <Pine.LNX.4.64.0805281630020.24036@reclus.nhh.no>
References: <63d616b0805280721s3b026989g5c055d14e3ccb5c3@mail.gmail.com>
	<Pine.LNX.4.64.0805281630020.24036@reclus.nhh.no>
Message-ID: <63d616b0805280753s4a2ee1c7l44407aaf7a5706c3@mail.gmail.com>

Thanks a lot !. it works.

I had read the ?spplot before, but because I'm new in this topic, I
didn't figure out how to do the overlay in the right way.

My humble opinion, and thinking in newbies, I think that it could be a
good idea to add an example about this (just one line) to the next
version of the documentation of the gstat package, and/or  to the
gstat_package-tutorial.pdf file.

Again, thanks a lot.

-- 
Mauricio

Linux user #454569 -- Ubuntu user #17469



From jbarnier at ens-lsh.fr  Fri May 30 16:34:18 2008
From: jbarnier at ens-lsh.fr (Julien Barnier)
Date: Fri, 30 May 2008 16:34:18 +0200
Subject: [R-sig-Geo] spplot and diverging colorbrewer palette
Message-ID: <87mym7n9n9.fsf@ens-lsh.fr>

Hi to all,

A little question about using a diverging colorbrewer palette with
spplot. If you try the following code :

library(sp)
library(maptools)
library(RColorBrewer)

nc <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
nc at data$AREA2 <- nc at data$AREA - 0.1
spplot(nc, c("AREA2"), col.regions=brewer.pal(7, "RdBu"), cuts=6,scales=list(draw = TRUE))

you should get a map of a (very dummy) variable which takes value
below and above zero. So I'd like the ?0? value to be exactly at the
point where colours are changing from red to blue. However, with this
method it only works when ?0? is exactly at the center of the scale.

Do you have any idea on how I could obtain the result I would like,
without specifying manually the cut points with ?cuts? and ?at? ?

Thanks in advance, and sorry if my question is not really clear, as I
am quite new to spplot...

Sincerely,
-- 
Julien Barnier
Groupe de recherche sur la socialisation
ENS-LSH - Lyon, France



From edzer.pebesma at uni-muenster.de  Fri May 30 17:55:47 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 30 May 2008 17:55:47 +0200
Subject: [R-sig-Geo] spplot and diverging colorbrewer palette
In-Reply-To: <87mym7n9n9.fsf@ens-lsh.fr>
References: <87mym7n9n9.fsf@ens-lsh.fr>
Message-ID: <48402383.1050704@uni-muenster.de>

Julien, try

 > library(lattice)
 > z = rnorm(100)
 > x=rep(1:10,10)
 > y=rep(1:10,each=10)
 > levelplot(z~x+y,colorkey=list(at=-4:4))

try the colorkey argument in spplot, it should get passed on to spplot, 
which wraps levelplot.
--
Edzer

Julien Barnier wrote:
> Hi to all,
>
> A little question about using a diverging colorbrewer palette with
> spplot. If you try the following code :
>
> library(sp)
> library(maptools)
> library(RColorBrewer)
>
> nc <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
> nc at data$AREA2 <- nc at data$AREA - 0.1
> spplot(nc, c("AREA2"), col.regions=brewer.pal(7, "RdBu"), cuts=6,scales=list(draw = TRUE))
>
> you should get a map of a (very dummy) variable which takes value
> below and above zero. So I'd like the ?0? value to be exactly at the
> point where colours are changing from red to blue. However, with this
> method it only works when ?0? is exactly at the center of the scale.
>
> Do you have any idea on how I could obtain the result I would like,
> without specifying manually the cut points with ?cuts? and ?at? ?
>
> Thanks in advance, and sorry if my question is not really clear, as I
> am quite new to spplot...
>
> Sincerely,
>



