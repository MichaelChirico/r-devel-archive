From florian.detsch at staff.uni-marburg.de  Mon Jan  2 16:31:57 2017
From: florian.detsch at staff.uni-marburg.de (Florian Detsch)
Date: Mon, 2 Jan 2017 16:31:57 +0100
Subject: [R-sig-Geo] gimms: Download and Process GIMMS NDVI3g Data
Message-ID: <c0314354-eb0d-ef7e-e8d0-e73688dcbf2c@staff.uni-marburg.de>

Dear list members,

allow me to briefly draw your attention towards the latest release of 
the 'gimms' package (gimms-1.0.0). Quite some time has passed since the 
last update, but now that version 1 of the AVHRR-based GIMMS NDVI record 
(NDVI3g.v1; until end 2015) has been made available, some adjustments 
were overdue. Among those are (taken from the NEWS file):

* Added support for the recently released NDVI3g.v1 to all package 
functions.
* Included local file inventories for all available GIMMS products 
(NDVI3g.v0
   and NDVI3g.v1) and their respective servers (ECOCAST, NASANEX).
* Quality control has been added to rasterizeGimms() through specifying
   permitted flag values ('keep'), rendering the subsequent application of a
   separate function unnecessary. For reasons of convenience, however,
   qualityControl() is still available.
* rasterizeGimms() now includes an extent argument ('ext') to enable 
clipping
   based on raster::crop().
* Scaling and the rejection of water and nodata-mask values are no longer
   optional.
* If 'timestamp = TRUE', monthlyIndices() now returns an object of class 
'Date'
   (instead of 'character') and '...' is no longer available.

In addition, the accompanying GitBook has been updated which provides a 
rather quick-and-dirty introduction to the subject. It is reachable via 
https://www.gitbook.com/book/envin-marburg/introducing-the-r-gimms-package/details.

Feedback and suggestions are always welcome, and feature requests and/or 
bug reports should be filed at 
https://github.com/environmentalinformatics-marburg/gimms.

Best,
Florian


-- 
Florian Detsch (M.Sc. Physical Geography)
Environmental Informatics
Department of Geography
Philipps-Universit?t Marburg
Deutschhausstra?e 12
35032 (parcel post: 35037) Marburg, Germany

Phone: +49 (0) 6421 28-25323
Web: http://www.uni-marburg.de/fb19/fachgebiete/umweltinformatik/detschf/index.html


From nikolaos.nikolioudakis at imr.no  Thu Jan  5 08:42:25 2017
From: nikolaos.nikolioudakis at imr.no (Nikolioudakis Nikolaos)
Date: Thu, 5 Jan 2017 07:42:25 +0000
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
Message-ID: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>

Dear members of the list,
My question might be trivial but please bear with me as I am quite new in GIS and R so my terminology and/or expressions might not be the right ones. I have a set of coordinates in lat/lon for which I need to extract values from a netCDF file. The file is downloaded from http://marine.copernicus.eu/ (needs registration to reach data from there). For this reason you can find in the following link a .nc subset (single raster) from a multiband .nc I am using.
.nc file:

https://dl.dropboxusercontent.com/u/2156982/subset.nc

The coordinates of my locations (in lon/lat) are in the coords.csv file can be found here:

https://dl.dropboxusercontent.com/u/2156982/coords.csv

The raster's projection is (according to the data source EPSG: 3411 (NSIDC Polar Stereographic North)) so the obvious thing to do is reproject my points to the same projection as the raster's in order to overplot them (and subsequently extract values from the raster based on the points). Reprojecting the rasters would also be an option, but in my specific case I have multiband (many dates) netCDFs and also many different variables in each netCDF so reprojecting the coordinates if possible and performing the extraction from the epsg 3411 rasters would be ideal for me. My problem is that when I reproject my coordinates I get them in meters and not in decimal degrees as the raster is.



So the question is how can I obtain my reprojected coordinates in decimal degrees instead of meters in order to be able to perform the extraction of values from the raster (I have done this for another dataset that both the locations and the rasters were in the same projection and units). I understand that my problem is probably related with how to declare that the output units of my reprojected coordinates should be in dd instead of meters but I am not sure on the syntax of the proj4 string and on the web the inverse procedure is usually described (dd to meters). The r code I am using is the following:

library(raster)

library(rgdal)



#setwd to the location of the files

subset.r = raster('subset.nc', varname='chla')

#print(subset.r)



locs <- read.table('coords.csv',header = T,sep = ';')

coordinates(locs) <- ~ LON+LAT

# par(mfrow=c(1,2))

# plot(subset.r)

# plot(locs at coords)



#set the projection to EPSG: 4326 for the locs

wgs84 <- CRS('+init=epsg:4326')

proj4string(locs) <- wgs84

#reproject locs to polar stereographic (EPSG 3411)

locs.repr <- spTransform(locs, crs(subset.r))

#compareCRS(locs.repr, subset.r)

plot(subset.r)

plot(locs.repr at coords<mailto:locs.repr at coords>)

# extent(locs.repr)

# extent(subset.r)



Any help would be greatly appreciated as well as any comments on things I might be forgetting to provide so as to make my problem better understood.

Best regards,
Nikos
__________________________
Nikos Nikolioudakis
PostDoc Researcher
Pelagic Fish Research Group
Institute of Marine Research (IMR)
P.O. Box 1870 - Nordnes
5817 Bergen, Norway
E-mail:nikolaos.nikolioudakis at imr.no
Tel:0047489981

[cid:image001.jpg at 01D0B00F.4BA30FC0]
__________________________

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Thu Jan  5 09:01:17 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 05 Jan 2017 08:01:17 +0000
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
Message-ID: <CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>

This data is in polar stereographic so it's best to ignore the lonlats and
apply the right affine transform (extent and resolution) directly. I.e. no
transformation or hacky workarounds required. We do this routinely from
similar files, happy to explain off-list.

For annoying reasons this is poorly understood on both the GIS and NetCDF
(modelling) sides.

Cheers, Mike

On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <
nikolaos.nikolioudakis at imr.no> wrote:

> Dear members of the list,
> My question might be trivial but please bear with me as I am quite new in
> GIS and R so my terminology and/or expressions might not be the right ones.
> I have a set of coordinates in lat/lon for which I need to extract values
> from a netCDF file. The file is downloaded from
> http://marine.copernicus.eu/ (needs registration to reach data from
> there). For this reason you can find in the following link a .nc subset
> (single raster) from a multiband .nc I am using.
> .nc file:
>
> https://dl.dropboxusercontent.com/u/2156982/subset.nc
>
> The coordinates of my locations (in lon/lat) are in the coords.csv file
> can be found here:
>
> https://dl.dropboxusercontent.com/u/2156982/coords.csv
>
> The raster's projection is (according to the data source EPSG: 3411 (NSIDC
> Polar Stereographic North)) so the obvious thing to do is reproject my
> points to the same projection as the raster's in order to overplot them
> (and subsequently extract values from the raster based on the points).
> Reprojecting the rasters would also be an option, but in my specific case I
> have multiband (many dates) netCDFs and also many different variables in
> each netCDF so reprojecting the coordinates if possible and performing the
> extraction from the epsg 3411 rasters would be ideal for me. My problem is
> that when I reproject my coordinates I get them in meters and not in
> decimal degrees as the raster is.
>
>
>
> So the question is how can I obtain my reprojected coordinates in decimal
> degrees instead of meters in order to be able to perform the extraction of
> values from the raster (I have done this for another dataset that both the
> locations and the rasters were in the same projection and units). I
> understand that my problem is probably related with how to declare that the
> output units of my reprojected coordinates should be in dd instead of
> meters but I am not sure on the syntax of the proj4 string and on the web
> the inverse procedure is usually described (dd to meters). The r code I am
> using is the following:
>
> library(raster)
>
> library(rgdal)
>
>
>
> #setwd to the location of the files
>
> subset.r = raster('subset.nc', varname='chla')
>
> #print(subset.r)
>
>
>
> locs <- read.table('coords.csv',header = T,sep = ';')
>
> coordinates(locs) <- ~ LON+LAT
>
> # par(mfrow=c(1,2))
>
> # plot(subset.r)
>
> # plot(locs at coords)
>
>
>
> #set the projection to EPSG: 4326 for the locs
>
> wgs84 <- CRS('+init=epsg:4326')
>
> proj4string(locs) <- wgs84
>
> #reproject locs to polar stereographic (EPSG 3411)
>
> locs.repr <- spTransform(locs, crs(subset.r))
>
> #compareCRS(locs.repr, subset.r)
>
> plot(subset.r)
>
> plot(locs.repr at coords<mailto:locs.repr at coords>)
>
> # extent(locs.repr)
>
> # extent(subset.r)
>
>
>
> Any help would be greatly appreciated as well as any comments on things I
> might be forgetting to provide so as to make my problem better understood.
>
> Best regards,
> Nikos
> __________________________
> Nikos Nikolioudakis
> PostDoc Researcher
> Pelagic Fish Research Group
> Institute of Marine Research (IMR)
> P.O. Box 1870 - Nordnes
> 5817 Bergen, Norway
> E-mail:nikolaos.nikolioudakis at imr.no
> Tel:0047489981
>
> [cid:image001.jpg at 01D0B00F.4BA30FC0]
> __________________________
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From nikolaos.nikolioudakis at imr.no  Thu Jan  5 09:19:50 2017
From: nikolaos.nikolioudakis at imr.no (Nikolioudakis Nikolaos)
Date: Thu, 5 Jan 2017 08:19:50 +0000
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
	<CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
Message-ID: <0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>

Thank you for the prompt response Mike. It would be great if you could do so and I can later post the solution on the list in case someone needs it in the future

Cheers,
Nikos

From: Michael Sumner [mailto:mdsumner at gmail.com]
Sent: Thursday, January 05, 2017 9:01 AM
To: Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no>; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] reproject coordinates from meters to decimal degrees


This data is in polar stereographic so it's best to ignore the lonlats and apply the right affine transform (extent and resolution) directly. I.e. no transformation or hacky workarounds required. We do this routinely from similar files, happy to explain off-list.

For annoying reasons this is poorly understood on both the GIS and NetCDF (modelling) sides.

Cheers, Mike

On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no<mailto:nikolaos.nikolioudakis at imr.no>> wrote:
Dear members of the list,
My question might be trivial but please bear with me as I am quite new in GIS and R so my terminology and/or expressions might not be the right ones. I have a set of coordinates in lat/lon for which I need to extract values from a netCDF file. The file is downloaded from http://marine.copernicus.eu/ (needs registration to reach data from there). For this reason you can find in the following link a .nc subset (single raster) from a multiband .nc I am using.
.nc file:

https://dl.dropboxusercontent.com/u/2156982/subset.nc

The coordinates of my locations (in lon/lat) are in the coords.csv file can be found here:

https://dl.dropboxusercontent.com/u/2156982/coords.csv

The raster's projection is (according to the data source EPSG: 3411 (NSIDC Polar Stereographic North)) so the obvious thing to do is reproject my points to the same projection as the raster's in order to overplot them (and subsequently extract values from the raster based on the points). Reprojecting the rasters would also be an option, but in my specific case I have multiband (many dates) netCDFs and also many different variables in each netCDF so reprojecting the coordinates if possible and performing the extraction from the epsg 3411 rasters would be ideal for me. My problem is that when I reproject my coordinates I get them in meters and not in decimal degrees as the raster is.



So the question is how can I obtain my reprojected coordinates in decimal degrees instead of meters in order to be able to perform the extraction of values from the raster (I have done this for another dataset that both the locations and the rasters were in the same projection and units). I understand that my problem is probably related with how to declare that the output units of my reprojected coordinates should be in dd instead of meters but I am not sure on the syntax of the proj4 string and on the web the inverse procedure is usually described (dd to meters). The r code I am using is the following:

library(raster)

library(rgdal)



#setwd to the location of the files

subset.r = raster('subset.nc<http://subset.nc>', varname='chla')

#print(subset.r)



locs <- read.table('coords.csv',header = T,sep = ';')

coordinates(locs) <- ~ LON+LAT

# par(mfrow=c(1,2))

# plot(subset.r)

# plot(locs at coords)



#set the projection to EPSG: 4326 for the locs

wgs84 <- CRS('+init=epsg:4326')

proj4string(locs) <- wgs84

#reproject locs to polar stereographic (EPSG 3411)

locs.repr <- spTransform(locs, crs(subset.r))

#compareCRS(locs.repr, subset.r)

plot(subset.r)

plot(locs.repr at coords<mailto:locs.repr at coords<mailto:locs.repr at coords>>)

# extent(locs.repr)

# extent(subset.r)



Any help would be greatly appreciated as well as any comments on things I might be forgetting to provide so as to make my problem better understood.

Best regards,
Nikos
__________________________
Nikos Nikolioudakis
PostDoc Researcher
Pelagic Fish Research Group
Institute of Marine Research (IMR)
P.O. Box 1870 - Nordnes
5817 Bergen, Norway
E-mail:nikolaos.nikolioudakis at imr.no<mailto:E-mail%3Anikolaos.nikolioudakis at imr.no>
Tel:0047489981

[cid:image001.jpg at 01D0B00F.4BA30FC0]
__________________________

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Thu Jan  5 11:18:38 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Jan 2017 11:18:38 +0100
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
	<CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
	<0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
Message-ID: <alpine.LFD.2.20.1701051117360.11388@reclus.nhh.no>

On Thu, 5 Jan 2017, Nikolioudakis Nikolaos wrote:

> Thank you for the prompt response Mike. It would be great if you could 
> do so and I can later post the solution on the list in case someone 
> needs it in the future

This topic is also a clear candidate for a vignette for the rgdal package; 
it needs documenting where users can find it.

Roger

>
> Cheers,
> Nikos
>
> From: Michael Sumner [mailto:mdsumner at gmail.com]
> Sent: Thursday, January 05, 2017 9:01 AM
> To: Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no>; r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] reproject coordinates from meters to decimal degrees
>
>
> This data is in polar stereographic so it's best to ignore the lonlats and apply the right affine transform (extent and resolution) directly. I.e. no transformation or hacky workarounds required. We do this routinely from similar files, happy to explain off-list.
>
> For annoying reasons this is poorly understood on both the GIS and NetCDF (modelling) sides.
>
> Cheers, Mike
>
> On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no<mailto:nikolaos.nikolioudakis at imr.no>> wrote:
> Dear members of the list,
> My question might be trivial but please bear with me as I am quite new in GIS and R so my terminology and/or expressions might not be the right ones. I have a set of coordinates in lat/lon for which I need to extract values from a netCDF file. The file is downloaded from http://marine.copernicus.eu/ (needs registration to reach data from there). For this reason you can find in the following link a .nc subset (single raster) from a multiband .nc I am using.
> .nc file:
>
> https://dl.dropboxusercontent.com/u/2156982/subset.nc
>
> The coordinates of my locations (in lon/lat) are in the coords.csv file can be found here:
>
> https://dl.dropboxusercontent.com/u/2156982/coords.csv
>
> The raster's projection is (according to the data source EPSG: 3411 (NSIDC Polar Stereographic North)) so the obvious thing to do is reproject my points to the same projection as the raster's in order to overplot them (and subsequently extract values from the raster based on the points). Reprojecting the rasters would also be an option, but in my specific case I have multiband (many dates) netCDFs and also many different variables in each netCDF so reprojecting the coordinates if possible and performing the extraction from the epsg 3411 rasters would be ideal for me. My problem is that when I reproject my coordinates I get them in meters and not in decimal degrees as the raster is.
>
>
>
> So the question is how can I obtain my reprojected coordinates in decimal degrees instead of meters in order to be able to perform the extraction of values from the raster (I have done this for another dataset that both the locations and the rasters were in the same projection and units). I understand that my problem is probably related with how to declare that the output units of my reprojected coordinates should be in dd instead of meters but I am not sure on the syntax of the proj4 string and on the web the inverse procedure is usually described (dd to meters). The r code I am using is the following:
>
> library(raster)
>
> library(rgdal)
>
>
>
> #setwd to the location of the files
>
> subset.r = raster('subset.nc<http://subset.nc>', varname='chla')
>
> #print(subset.r)
>
>
>
> locs <- read.table('coords.csv',header = T,sep = ';')
>
> coordinates(locs) <- ~ LON+LAT
>
> # par(mfrow=c(1,2))
>
> # plot(subset.r)
>
> # plot(locs at coords)
>
>
>
> #set the projection to EPSG: 4326 for the locs
>
> wgs84 <- CRS('+init=epsg:4326')
>
> proj4string(locs) <- wgs84
>
> #reproject locs to polar stereographic (EPSG 3411)
>
> locs.repr <- spTransform(locs, crs(subset.r))
>
> #compareCRS(locs.repr, subset.r)
>
> plot(subset.r)
>
> plot(locs.repr at coords<mailto:locs.repr at coords<mailto:locs.repr at coords>>)
>
> # extent(locs.repr)
>
> # extent(subset.r)
>
>
>
> Any help would be greatly appreciated as well as any comments on things I might be forgetting to provide so as to make my problem better understood.
>
> Best regards,
> Nikos
> __________________________
> Nikos Nikolioudakis
> PostDoc Researcher
> Pelagic Fish Research Group
> Institute of Marine Research (IMR)
> P.O. Box 1870 - Nordnes
> 5817 Bergen, Norway
> E-mail:nikolaos.nikolioudakis at imr.no<mailto:E-mail%3Anikolaos.nikolioudakis at imr.no>
> Tel:0047489981
>
> [cid:image001.jpg at 01D0B00F.4BA30FC0]
> __________________________
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From mdsumner at gmail.com  Thu Jan  5 12:08:28 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 05 Jan 2017 11:08:28 +0000
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
	<CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
	<0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
Message-ID: <CAAcGz999pJgm0qko9vVD4Pk9gTYcTEd_v6uaaXWNv5dprXR2-A@mail.gmail.com>

On Thu, 5 Jan 2017 at 19:19 Nikolioudakis Nikolaos <
nikolaos.nikolioudakis at imr.no> wrote:

Thank you for the prompt response Mike. It would be great if you could do
so and I can later post the solution on the list in case someone needs it
in the future




Ugh, it's not what I thought, raster is just wrong on what this file has in
it, but there's no point laying blame, NetCDF is so general and so commonly
abused that software everywhere has endless heuristics to figure out what
to assume.

Basically your data ship with longitude/latitudes, and you need to figure
out what that is in the native polar stereographic projection as a regular
grid for use in raster().  You can't easily reproject that raster as it is,
and I'd advise against it since it's lossy, and doesn't scale well to long
time series, you could use nn techniques to transform to the longlat values
in a brute force way, but that's a horrible hack - I think it's worth
figuring this one out.

I've put my startings here: https://github.com/mdsumner/ranch/issues/3

If I can I'll figure it out and let you know.  Feel free to ping on that
issue, but also share more info you find from the sources -  it's a
repository I made to collect NetCDF adventures - it  might be worthwhile .
. .

 Similar data (from raw binary but using the same-mostly projection) is
wrapped by us here:
https://github.com/AustralianAntarcticDivision/raadtools/blob/master/R/ice.R
This is also built into raster itself (but only to read those particular
binary files, not NetCDF ones).

I kind of agree with Roger about a vignette for rgdal, but really the
information belongs at the source of the data (and inside the NetCDF file
itself), and I'd be more interested if rgdal was easier to work with as a
collaborator. (Most users would think it belongs in raster, since that
hides rgdal for the most part - neither package is easy to contribute to).

 I agree we need a better community resource for these file-bogeys, but
it's something we share with the GDAL community and many others so it's
bigger than any particular software user group.

(For this problem generally, we just collect our fixes in our local tool
kit (raadtools) for files that will be of long-term use, and because it
provides the rest of the workflows we need on top of huge file collections
on local shares. I don't see any general solutions that are better than
that on the horizon, though incremental improvements to raster, GDAL and
NetCDF have seen a lot of our workarounds updated).

Cheers, Mike.



Cheers,

Nikos



*From:* Michael Sumner [mailto:mdsumner at gmail.com]
*Sent:* Thursday, January 05, 2017 9:01 AM
*To:* Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no>;
r-sig-geo at r-project.org
*Subject:* Re: [R-sig-Geo] reproject coordinates from meters to decimal
degrees



This data is in polar stereographic so it's best to ignore the lonlats and
apply the right affine transform (extent and resolution) directly. I.e. no
transformation or hacky workarounds required. We do this routinely from
similar files, happy to explain off-list.

For annoying reasons this is poorly understood on both the GIS and NetCDF
(modelling) sides.

Cheers, Mike



On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <
nikolaos.nikolioudakis at imr.no> wrote:

Dear members of the list,
My question might be trivial but please bear with me as I am quite new in
GIS and R so my terminology and/or expressions might not be the right ones.
I have a set of coordinates in lat/lon for which I need to extract values
from a netCDF file. The file is downloaded from http://marine.copernicus.eu/
(needs registration to reach data from there). For this reason you can find
in the following link a .nc subset (single raster) from a multiband .nc I
am using.
.nc file:

https://dl.dropboxusercontent.com/u/2156982/subset.nc

The coordinates of my locations (in lon/lat) are in the coords.csv file can
be found here:

https://dl.dropboxusercontent.com/u/2156982/coords.csv

The raster's projection is (according to the data source EPSG: 3411 (NSIDC
Polar Stereographic North)) so the obvious thing to do is reproject my
points to the same projection as the raster's in order to overplot them
(and subsequently extract values from the raster based on the points).
Reprojecting the rasters would also be an option, but in my specific case I
have multiband (many dates) netCDFs and also many different variables in
each netCDF so reprojecting the coordinates if possible and performing the
extraction from the epsg 3411 rasters would be ideal for me. My problem is
that when I reproject my coordinates I get them in meters and not in
decimal degrees as the raster is.



So the question is how can I obtain my reprojected coordinates in decimal
degrees instead of meters in order to be able to perform the extraction of
values from the raster (I have done this for another dataset that both the
locations and the rasters were in the same projection and units). I
understand that my problem is probably related with how to declare that the
output units of my reprojected coordinates should be in dd instead of
meters but I am not sure on the syntax of the proj4 string and on the web
the inverse procedure is usually described (dd to meters). The r code I am
using is the following:

library(raster)

library(rgdal)



#setwd to the location of the files

subset.r = raster('subset.nc', varname='chla')

#print(subset.r)



locs <- read.table('coords.csv',header = T,sep = ';')

coordinates(locs) <- ~ LON+LAT

# par(mfrow=c(1,2))

# plot(subset.r)

# plot(locs at coords)



#set the projection to EPSG: 4326 for the locs

wgs84 <- CRS('+init=epsg:4326')

proj4string(locs) <- wgs84

#reproject locs to polar stereographic (EPSG 3411)

locs.repr <- spTransform(locs, crs(subset.r))

#compareCRS(locs.repr, subset.r)

plot(subset.r)

plot(locs.repr at coords<mailto:locs.repr at coords>)

# extent(locs.repr)

# extent(subset.r)



Any help would be greatly appreciated as well as any comments on things I
might be forgetting to provide so as to make my problem better understood.

Best regards,
Nikos
__________________________
Nikos Nikolioudakis
PostDoc Researcher
Pelagic Fish Research Group
Institute of Marine Research (IMR)
P.O. Box 1870 - Nordnes
5817 Bergen, Norway
E-mail:nikolaos.nikolioudakis at imr.no
Tel:0047489981 <0047489981>

[cid:image001.jpg at 01D0B00F.4BA30FC0]
__________________________

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Thu Jan  5 12:24:07 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Jan 2017 12:24:07 +0100
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <CAAcGz999pJgm0qko9vVD4Pk9gTYcTEd_v6uaaXWNv5dprXR2-A@mail.gmail.com>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
	<CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
	<0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
	<CAAcGz999pJgm0qko9vVD4Pk9gTYcTEd_v6uaaXWNv5dprXR2-A@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1701051214370.11388@reclus.nhh.no>

On Thu, 5 Jan 2017, Michael Sumner wrote:

> On Thu, 5 Jan 2017 at 19:19 Nikolioudakis Nikolaos <
> nikolaos.nikolioudakis at imr.no> wrote:
>
> Thank you for the prompt response Mike. It would be great if you could do
> so and I can later post the solution on the list in case someone needs it
> in the future
>
>
>
>
> Ugh, it's not what I thought, raster is just wrong on what this file has in
> it, but there's no point laying blame, NetCDF is so general and so commonly
> abused that software everywhere has endless heuristics to figure out what
> to assume.
>
> Basically your data ship with longitude/latitudes, and you need to figure
> out what that is in the native polar stereographic projection as a regular
> grid for use in raster().  You can't easily reproject that raster as it is,
> and I'd advise against it since it's lossy, and doesn't scale well to long
> time series, you could use nn techniques to transform to the longlat values
> in a brute force way, but that's a horrible hack - I think it's worth
> figuring this one out.
>
> I've put my startings here: https://github.com/mdsumner/ranch/issues/3
>
> If I can I'll figure it out and let you know.  Feel free to ping on that
> issue, but also share more info you find from the sources -  it's a
> repository I made to collect NetCDF adventures - it  might be worthwhile .
> . .
>
> Similar data (from raw binary but using the same-mostly projection) is
> wrapped by us here:
> https://github.com/AustralianAntarcticDivision/raadtools/blob/master/R/ice.R
> This is also built into raster itself (but only to read those particular
> binary files, not NetCDF ones).
>
> I kind of agree with Roger about a vignette for rgdal, but really the
> information belongs at the source of the data (and inside the NetCDF file
> itself), and I'd be more interested if rgdal was easier to work with as a
> collaborator. (Most users would think it belongs in raster, since that
> hides rgdal for the most part - neither package is easy to contribute to).
>
> I agree we need a better community resource for these file-bogeys, but
> it's something we share with the GDAL community and many others so it's
> bigger than any particular software user group.

Yes, I agree. Does the use of +proj=obtran - oblique transformations - 
come into the same general area of file-bogeys which could be documented 
in the same place?

Roger

>
> (For this problem generally, we just collect our fixes in our local tool
> kit (raadtools) for files that will be of long-term use, and because it
> provides the rest of the workflows we need on top of huge file collections
> on local shares. I don't see any general solutions that are better than
> that on the horizon, though incremental improvements to raster, GDAL and
> NetCDF have seen a lot of our workarounds updated).
>
> Cheers, Mike.
>
>
>
> Cheers,
>
> Nikos
>
>
>
> *From:* Michael Sumner [mailto:mdsumner at gmail.com]
> *Sent:* Thursday, January 05, 2017 9:01 AM
> *To:* Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no>;
> r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] reproject coordinates from meters to decimal
> degrees
>
>
>
> This data is in polar stereographic so it's best to ignore the lonlats and
> apply the right affine transform (extent and resolution) directly. I.e. no
> transformation or hacky workarounds required. We do this routinely from
> similar files, happy to explain off-list.
>
> For annoying reasons this is poorly understood on both the GIS and NetCDF
> (modelling) sides.
>
> Cheers, Mike
>
>
>
> On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <
> nikolaos.nikolioudakis at imr.no> wrote:
>
> Dear members of the list,
> My question might be trivial but please bear with me as I am quite new in
> GIS and R so my terminology and/or expressions might not be the right ones.
> I have a set of coordinates in lat/lon for which I need to extract values
> from a netCDF file. The file is downloaded from http://marine.copernicus.eu/
> (needs registration to reach data from there). For this reason you can find
> in the following link a .nc subset (single raster) from a multiband .nc I
> am using.
> .nc file:
>
> https://dl.dropboxusercontent.com/u/2156982/subset.nc
>
> The coordinates of my locations (in lon/lat) are in the coords.csv file can
> be found here:
>
> https://dl.dropboxusercontent.com/u/2156982/coords.csv
>
> The raster's projection is (according to the data source EPSG: 3411 (NSIDC
> Polar Stereographic North)) so the obvious thing to do is reproject my
> points to the same projection as the raster's in order to overplot them
> (and subsequently extract values from the raster based on the points).
> Reprojecting the rasters would also be an option, but in my specific case I
> have multiband (many dates) netCDFs and also many different variables in
> each netCDF so reprojecting the coordinates if possible and performing the
> extraction from the epsg 3411 rasters would be ideal for me. My problem is
> that when I reproject my coordinates I get them in meters and not in
> decimal degrees as the raster is.
>
>
>
> So the question is how can I obtain my reprojected coordinates in decimal
> degrees instead of meters in order to be able to perform the extraction of
> values from the raster (I have done this for another dataset that both the
> locations and the rasters were in the same projection and units). I
> understand that my problem is probably related with how to declare that the
> output units of my reprojected coordinates should be in dd instead of
> meters but I am not sure on the syntax of the proj4 string and on the web
> the inverse procedure is usually described (dd to meters). The r code I am
> using is the following:
>
> library(raster)
>
> library(rgdal)
>
>
>
> #setwd to the location of the files
>
> subset.r = raster('subset.nc', varname='chla')
>
> #print(subset.r)
>
>
>
> locs <- read.table('coords.csv',header = T,sep = ';')
>
> coordinates(locs) <- ~ LON+LAT
>
> # par(mfrow=c(1,2))
>
> # plot(subset.r)
>
> # plot(locs at coords)
>
>
>
> #set the projection to EPSG: 4326 for the locs
>
> wgs84 <- CRS('+init=epsg:4326')
>
> proj4string(locs) <- wgs84
>
> #reproject locs to polar stereographic (EPSG 3411)
>
> locs.repr <- spTransform(locs, crs(subset.r))
>
> #compareCRS(locs.repr, subset.r)
>
> plot(subset.r)
>
> plot(locs.repr at coords<mailto:locs.repr at coords>)
>
> # extent(locs.repr)
>
> # extent(subset.r)
>
>
>
> Any help would be greatly appreciated as well as any comments on things I
> might be forgetting to provide so as to make my problem better understood.
>
> Best regards,
> Nikos
> __________________________
> Nikos Nikolioudakis
> PostDoc Researcher
> Pelagic Fish Research Group
> Institute of Marine Research (IMR)
> P.O. Box 1870 - Nordnes
> 5817 Bergen, Norway
> E-mail:nikolaos.nikolioudakis at imr.no
> Tel:0047489981 <0047489981>
>
> [cid:image001.jpg at 01D0B00F.4BA30FC0]
> __________________________
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From mdsumner at gmail.com  Thu Jan  5 12:40:31 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 05 Jan 2017 11:40:31 +0000
Subject: [R-sig-Geo] reproject coordinates from meters to decimal degrees
In-Reply-To: <alpine.LFD.2.20.1701051214370.11388@reclus.nhh.no>
References: <9a751645d7fe42318f50bdbeed2185ea@exmail1.imr.no>
	<CAAcGz9-GgX-RwM06ZZ8hhn4YeStfOAvW7000ig6S3x=2m_n+dg@mail.gmail.com>
	<0c1f0620bde04d4689dc57a8ee079f8c@exmail1.imr.no>
	<CAAcGz999pJgm0qko9vVD4Pk9gTYcTEd_v6uaaXWNv5dprXR2-A@mail.gmail.com>
	<alpine.LFD.2.20.1701051214370.11388@reclus.nhh.no>
Message-ID: <CAAcGz98anbyD_YevwW16m7MPapAYF--Rd+Ac6Vbyaxb80hw-HA@mail.gmail.com>

On Thu, 5 Jan 2017 at 22:24 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Thu, 5 Jan 2017, Michael Sumner wrote:
>
> > On Thu, 5 Jan 2017 at 19:19 Nikolioudakis Nikolaos <
> > nikolaos.nikolioudakis at imr.no> wrote:
> >
> > Thank you for the prompt response Mike. It would be great if you could do
> > so and I can later post the solution on the list in case someone needs it
> > in the future
> >
> >
> >
> >
> > Ugh, it's not what I thought, raster is just wrong on what this file has
> in
> > it, but there's no point laying blame, NetCDF is so general and so
> commonly
> > abused that software everywhere has endless heuristics to figure out what
> > to assume.
> >
> > Basically your data ship with longitude/latitudes, and you need to figure
> > out what that is in the native polar stereographic projection as a
> regular
> > grid for use in raster().  You can't easily reproject that raster as it
> is,
> > and I'd advise against it since it's lossy, and doesn't scale well to
> long
> > time series, you could use nn techniques to transform to the longlat
> values
> > in a brute force way, but that's a horrible hack - I think it's worth
> > figuring this one out.
> >
> > I've put my startings here: https://github.com/mdsumner/ranch/issues/3
> >
> > If I can I'll figure it out and let you know.  Feel free to ping on that
> > issue, but also share more info you find from the sources -  it's a
> > repository I made to collect NetCDF adventures - it  might be worthwhile
> .
> > . .
> >
> > Similar data (from raw binary but using the same-mostly projection) is
> > wrapped by us here:
> >
> https://github.com/AustralianAntarcticDivision/raadtools/blob/master/R/ice.R
> > This is also built into raster itself (but only to read those particular
> > binary files, not NetCDF ones).
> >
> > I kind of agree with Roger about a vignette for rgdal, but really the
> > information belongs at the source of the data (and inside the NetCDF file
> > itself), and I'd be more interested if rgdal was easier to work with as a
> > collaborator. (Most users would think it belongs in raster, since that
> > hides rgdal for the most part - neither package is easy to contribute
> to).
> >
> > I agree we need a better community resource for these file-bogeys, but
> > it's something we share with the GDAL community and many others so it's
> > bigger than any particular software user group.
>
> Yes, I agree. Does the use of +proj=obtran - oblique transformations -
> come into the same general area of file-bogeys which could be documented
> in the same place?
>
>
Yes it does, I just don't seem to have the capacity to collect them in a
sensible way. I have a little here and there:

https://github.com/mdsumner/angstroms

https://github.com/mdsumner/roc

https://github.com/AustralianAntarcticDivision/raadtools

Perhaps Edzer would like us to collect file-bogeys as part of
http://r-spatial.org/ for future developments?

If there was a single place that people would actually look at I'd get
behind it, I hit these kinds of examples regularly.

Cheers, Mike.


Roger
>
> >
> > (For this problem generally, we just collect our fixes in our local tool
> > kit (raadtools) for files that will be of long-term use, and because it
> > provides the rest of the workflows we need on top of huge file
> collections
> > on local shares. I don't see any general solutions that are better than
> > that on the horizon, though incremental improvements to raster, GDAL and
> > NetCDF have seen a lot of our workarounds updated).
> >
> > Cheers, Mike.
> >
> >
> >
> > Cheers,
> >
> > Nikos
> >
> >
> >
> > *From:* Michael Sumner [mailto:mdsumner at gmail.com]
> > *Sent:* Thursday, January 05, 2017 9:01 AM
> > *To:* Nikolioudakis Nikolaos <nikolaos.nikolioudakis at imr.no>;
> > r-sig-geo at r-project.org
> > *Subject:* Re: [R-sig-Geo] reproject coordinates from meters to decimal
> > degrees
> >
> >
> >
> > This data is in polar stereographic so it's best to ignore the lonlats
> and
> > apply the right affine transform (extent and resolution) directly. I.e.
> no
> > transformation or hacky workarounds required. We do this routinely from
> > similar files, happy to explain off-list.
> >
> > For annoying reasons this is poorly understood on both the GIS and NetCDF
> > (modelling) sides.
> >
> > Cheers, Mike
> >
> >
> >
> > On Thu, 5 Jan 2017, 18:43 Nikolioudakis Nikolaos <
> > nikolaos.nikolioudakis at imr.no> wrote:
> >
> > Dear members of the list,
> > My question might be trivial but please bear with me as I am quite new in
> > GIS and R so my terminology and/or expressions might not be the right
> ones.
> > I have a set of coordinates in lat/lon for which I need to extract values
> > from a netCDF file. The file is downloaded from
> http://marine.copernicus.eu/
> > (needs registration to reach data from there). For this reason you can
> find
> > in the following link a .nc subset (single raster) from a multiband .nc I
> > am using.
> > .nc file:
> >
> > https://dl.dropboxusercontent.com/u/2156982/subset.nc
> >
> > The coordinates of my locations (in lon/lat) are in the coords.csv file
> can
> > be found here:
> >
> > https://dl.dropboxusercontent.com/u/2156982/coords.csv
> >
> > The raster's projection is (according to the data source EPSG: 3411
> (NSIDC
> > Polar Stereographic North)) so the obvious thing to do is reproject my
> > points to the same projection as the raster's in order to overplot them
> > (and subsequently extract values from the raster based on the points).
> > Reprojecting the rasters would also be an option, but in my specific
> case I
> > have multiband (many dates) netCDFs and also many different variables in
> > each netCDF so reprojecting the coordinates if possible and performing
> the
> > extraction from the epsg 3411 rasters would be ideal for me. My problem
> is
> > that when I reproject my coordinates I get them in meters and not in
> > decimal degrees as the raster is.
> >
> >
> >
> > So the question is how can I obtain my reprojected coordinates in decimal
> > degrees instead of meters in order to be able to perform the extraction
> of
> > values from the raster (I have done this for another dataset that both
> the
> > locations and the rasters were in the same projection and units). I
> > understand that my problem is probably related with how to declare that
> the
> > output units of my reprojected coordinates should be in dd instead of
> > meters but I am not sure on the syntax of the proj4 string and on the web
> > the inverse procedure is usually described (dd to meters). The r code I
> am
> > using is the following:
> >
> > library(raster)
> >
> > library(rgdal)
> >
> >
> >
> > #setwd to the location of the files
> >
> > subset.r = raster('subset.nc', varname='chla')
> >
> > #print(subset.r)
> >
> >
> >
> > locs <- read.table('coords.csv',header = T,sep = ';')
> >
> > coordinates(locs) <- ~ LON+LAT
> >
> > # par(mfrow=c(1,2))
> >
> > # plot(subset.r)
> >
> > # plot(locs at coords)
> >
> >
> >
> > #set the projection to EPSG: 4326 for the locs
> >
> > wgs84 <- CRS('+init=epsg:4326')
> >
> > proj4string(locs) <- wgs84
> >
> > #reproject locs to polar stereographic (EPSG 3411)
> >
> > locs.repr <- spTransform(locs, crs(subset.r))
> >
> > #compareCRS(locs.repr, subset.r)
> >
> > plot(subset.r)
> >
> > plot(locs.repr at coords<mailto:locs.repr at coords>)
> >
> > # extent(locs.repr)
> >
> > # extent(subset.r)
> >
> >
> >
> > Any help would be greatly appreciated as well as any comments on things I
> > might be forgetting to provide so as to make my problem better
> understood.
> >
> > Best regards,
> > Nikos
> > __________________________
> > Nikos Nikolioudakis
> > PostDoc Researcher
> > Pelagic Fish Research Group
> > Institute of Marine Research (IMR)
> > P.O. Box 1870 - Nordnes
> > 5817 Bergen, Norway
> > E-mail:nikolaos.nikolioudakis at imr.no
> > Tel:0047489981 <0047489981>
> >
> > [cid:image001.jpg at 01D0B00F.4BA30FC0]
> > __________________________
> >
> >        [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55 <+47%2055%2095%2093%2055>; e-mail:
> Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> http://depsy.org/person/434412
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From daniel.nuest at wwu.de  Fri Jan  6 14:49:53 2017
From: daniel.nuest at wwu.de (=?UTF-8?Q?Daniel_N=c3=bcst?=)
Date: Fri, 6 Jan 2017 14:49:53 +0100
Subject: [R-sig-Geo] Heads up: EGU GA abstract deadline 11 Jan
Message-ID: <3482a018-e80a-c146-be3e-97f53b078c17@wwu.de>

Dear all,

the submission deadline for the EGU GA 2017 is apporaching fast.

Open science, open source and collaboration is natural to many people on
this list so please consider sharing your work at one of the following
sessions. Submit your abstracts before 11 Jan 2017, 1300 CET.


R?s deliberate role in Earth sciences
(IE3.6/GM1.8/AS4.50/BG9.65/CL5.26/HS11.23/SSS11.11)
Conveners: Michael Dietze, Sebastian Kreutzer, Oliver Korup
http://meetingorganizer.copernicus.org/EGU2017/session/24971


Free and Open Source Software (FOSS) for Geoinformatics and Geosciences
(ESSI3.4)
Conveners: Jens Klump, Peter L?we, Edzer Pebesma, Markus Neteler
http://meetingorganizer.copernicus.org/EGU2017/session/22866


Reproducible research for big data in practice (IE3.3/ESSI4.11)
Conveners: Edzer Pebesma, Yolanda Gil, Kerstin Lehnert, Jens Klump,
Martin Hammitzsch, Daniel N?st
http://meetingorganizer.copernicus.org/EGU2017/session/23581


Open Data and Open Science (IE2.4/ESSI3.10)
Conveners: Lorenzo Bigagli, Martin Hammitzsch, Bernadette Fritzsch,
Berit Arheimer, Ivo Grigorov
http://meetingorganizer.copernicus.org/EGU2017/session/23924


Detailed information on how to submit an abstract can be found at:
http://egu2017.eu/abstract_management/how_to_submit_an_abstract.html

Further information about the EGU General Assembly 2017 can be found at:
http://egu2017.eu/

Best regards,
Daniel

-- 
Daniel N?st
Institute for Geoinformatics (ifgi),   University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 31962
http://ifgi.uni-muenster.de/~d_nues01        http://o2r.info


-- 
Daniel N?st
Institute for Geoinformatics (ifgi),   University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 31962
http://ifgi.uni-muenster.de/~d_nues01        http://o2r.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 819 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170106/3aae39b8/attachment.bin>

From stefan.valentin87 at yahoo.com  Sun Jan  8 21:00:19 2017
From: stefan.valentin87 at yahoo.com (Valentin Stefan)
Date: Sun, 8 Jan 2017 20:00:19 +0000 (UTC)
Subject: [R-sig-Geo] Best practices for transforming raster data without
	altering values
References: <1426866284.683713.1483905619540.ref@mail.yahoo.com>
Message-ID: <1426866284.683713.1483905619540@mail.yahoo.com>

Dear all,
I have several global rasters from http://worldclim.org/?and I want to project them in a equal area projection shifted on Pacific.A sample code is:bio_1.WGS84.global ?<- raster("bio_1.bil")
# I use?World Cylindrical Equal Area (CEA)crs.cea <- "+proj=cea +lon_0=180 +lat_ts=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"bio_1.1km <- projectRaster(from=bio_1.WGS84.global, res=1000, method='bilinear', crs = crs.cea)
I came across the very helpful page maintained by Robert Hijmans at?http://rspatial.org/spatial/rst/6-crs.html#transforming-raster-data?,where he mentions that "Because projection of rasters affects the cells values, in most cases you will want to avoid projecting raster data and rather project vector data."
So, I know that the new (projected) cell values have been altered. There are not huge differences, nevertheless, is there a "good practice" to avoid changes in data while transforming a raster?
I presume I can't work on unprojected data and I should use a equal area projection as I need to further aggregate the rasters at various resolutions (e.g. 5, 10, 20 km) and extract some cell statistics at given points across the Pacific.
Kind regards,Valentin Stefan



	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Jan  9 11:39:08 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 9 Jan 2017 11:39:08 +0100
Subject: [R-sig-Geo] sp::spDists*
In-Reply-To: <5f120dcd-0b4a-33f4-52a0-6da70a511cae@uni-muenster.de>
References: <5f120dcd-0b4a-33f4-52a0-6da70a511cae@uni-muenster.de>
Message-ID: <alpine.LFD.2.20.1701091138360.3056@reclus.nhh.no>

New versions of spdep and spgwr fixing the same bug are now on CRAN.

Roger

On Thu, 8 Dec 2016, Edzer Pebesma wrote:

> While building support for geosphere distance functions in sf and
> comparing results from geosphere::distMeeuws with those of sp::spDists,
> I found a typo in the C code underlying the great circle distance
> computation functions in sp (sp::spDists, sp::spDistsN1) [*]:
>
> https://github.com/edzer/sp/commit/d8374ff7efc6735cba9a054748c602bed0672f23
>
> Before:
>> library(sf)
> Linking to GEOS 3.5.0, GDAL 2.1.0, proj.4 4.9.2
>> library(sp)
>> library(units)
>>
>> x = st_sfc(
> + st_point(c(0,0)),
> + st_point(c(1,0)),
> + st_point(c(2,0)),
> + st_point(c(3,0)),
> + crs = 4326
> + )
>>
>> y = st_sfc(
> + st_point(c(0,10)),
> + st_point(c(1,0)),
> + st_point(c(2,0)),
> + st_point(c(3,0)),
> + st_point(c(4,0)),
> + crs = 4326
> + )
>>
>> st_distance(x, y)
> Units: m
>        [,1]     [,2]     [,3]     [,4]     [,5]
> [1,] 1105855 111319.5 222639.0 333958.5 445278.0
> [2,] 1111387      0.0 111319.5 222639.0 333958.5
> [3,] 1127822 111319.5      0.0 111319.5 222639.0
> [4,] 1154693 222639.0 111319.5      0.0 111319.5
>>
>> d.sf = st_distance(x, y, geosphere::distMeeus)
>> d.sp = spDists(as(x, "Spatial"), as(y, "Spatial"))
>> units(d.sp) = make_unit("km")
>> d.sf - d.sp
> Units: m
>         [,1]         [,2]         [,3]         [,4] [,5]
> [1,] 1851.990 0.000000e+00 0.000000e+00 0.000000e+00    0
> [2,] 1842.938 0.000000e+00 0.000000e+00 2.910383e-11    0
> [3,] 1816.564 0.000000e+00 0.000000e+00 1.455192e-11    0
> [4,] 1775.032 2.910383e-11 1.455192e-11 0.000000e+00    0
>>
>
>
>
> After:
>
>> library(sf)
> Linking to GEOS 3.5.0, GDAL 2.1.0, proj.4 4.9.2
>> library(sp)
>> library(units)
>>
>> x = st_sfc(
> + st_point(c(0,0)),
> + st_point(c(1,0)),
> + st_point(c(2,0)),
> + st_point(c(3,0)),
> + crs = 4326
> + )
>>
>> y = st_sfc(
> + st_point(c(0,10)),
> + st_point(c(1,0)),
> + st_point(c(2,0)),
> + st_point(c(3,0)),
> + st_point(c(4,0)),
> + crs = 4326
> + )
>>
>> st_distance(x, y)
> Units: m
>        [,1]     [,2]     [,3]     [,4]     [,5]
> [1,] 1105855 111319.5 222639.0 333958.5 445278.0
> [2,] 1111387      0.0 111319.5 222639.0 333958.5
> [3,] 1127822 111319.5      0.0 111319.5 222639.0
> [4,] 1154693 222639.0 111319.5      0.0 111319.5
>>
>> d.sf = st_distance(x, y, geosphere::distMeeus)
>> d.sp = spDists(as(x, "Spatial"), as(y, "Spatial"))
>> units(d.sp) = make_unit("km")
>> d.sf - d.sp
> Units: m
>              [,1]         [,2]         [,3]         [,4] [,5]
> [1,] -2.328306e-10 0.000000e+00 0.000000e+00 0.000000e+00    0
> [2,]  2.328306e-10 0.000000e+00 0.000000e+00 2.910383e-11    0
> [3,]  0.000000e+00 0.000000e+00 0.000000e+00 1.455192e-11    0
> [4,]  0.000000e+00 2.910383e-11 1.455192e-11 0.000000e+00    0
>>
>
> [*] assuming the source code of
> http://www.abecedarical.com/javascript/script_greatcircle.html is
> correct; I don't have access to the Meeuws book mentioned there under (1).
>
> The same C function is used by gstat; I corrected that as well.
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From sanjay.lamsal at monsanto.com  Mon Jan  9 20:56:59 2017
From: sanjay.lamsal at monsanto.com (LAMSAL, SANJAY [AG/1005])
Date: Mon, 9 Jan 2017 19:56:59 +0000
Subject: [R-sig-Geo] Simulating or bootstrapping of Spatial Data
Message-ID: <8DEB54F46E2E8E4D937EDC2D04B7311B01EB9E31@STLWEXMBXPRD15.na.ds.monsanto.com>

I have a spatial data of soil bacteria concentration and have its semivariogram model. I wanted to simulate spatial scenarios of bacterial concentration in other fields. I could see this as either bootstrapping the bacteria data on spatial grids placed over other fields such that the generated data is spatially autocorrelated (honors the semivariogram model).

In my case, we want to develop spatial patterns of bacterium across several fields, where spatial pattern differ among fields but all patterns honor the same semivariogram model. Can anyone suggest an approach to accomplish this? I see this as being different from sequential simulation using gstat object (package gstat) where the simulated maps are realizations of original scenario.

Thanks

Sanjay



This email and any attachments were sent from a Monsanto email account and may contain confidential and/or privileged information. If you are not the intended recipient, please contact the sender and delete this email and any attachments immediately. Any unauthorized use, including disclosing, printing, storing, copying or distributing this email, is prohibited. All emails and attachments sent to or from Monsanto email accounts may be subject to monitoring, reading, and archiving by Monsanto, including its affiliates and subsidiaries, as permitted by applicable law. Thank you.

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jan  9 21:51:20 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 9 Jan 2017 21:51:20 +0100
Subject: [R-sig-Geo] Simulating or bootstrapping of Spatial Data
In-Reply-To: <8DEB54F46E2E8E4D937EDC2D04B7311B01EB9E31@STLWEXMBXPRD15.na.ds.monsanto.com>
References: <8DEB54F46E2E8E4D937EDC2D04B7311B01EB9E31@STLWEXMBXPRD15.na.ds.monsanto.com>
Message-ID: <64041420-b607-94be-ff83-61f8b5330244@uni-muenster.de>

Sanjay,

library(gstat)
demo(ugsim)

gives a demo of a sequential Gaussian unconditional simulation, which
you seem to want. Several other simulation methods are found in package
RandomFields.

On 09/01/17 20:56, LAMSAL, SANJAY [AG/1005] wrote:
> I have a spatial data of soil bacteria concentration and have its semivariogram model. I wanted to simulate spatial scenarios of bacterial concentration in other fields. I could see this as either bootstrapping the bacteria data on spatial grids placed over other fields such that the generated data is spatially autocorrelated (honors the semivariogram model).
> 
> In my case, we want to develop spatial patterns of bacterium across several fields, where spatial pattern differ among fields but all patterns honor the same semivariogram model. Can anyone suggest an approach to accomplish this? I see this as being different from sequential simulation using gstat object (package gstat) where the simulated maps are realizations of original scenario.
> 
> Thanks
> 
> Sanjay
> 
> 
> 
> This email and any attachments were sent from a Monsanto email account and may contain confidential and/or privileged information. If you are not the intended recipient, please contact the sender and delete this email and any attachments immediately. Any unauthorized use, including disclosing, printing, storing, copying or distributing this email, is prohibited. All emails and attachments sent to or from Monsanto email accounts may be subject to monitoring, reading, and archiving by Monsanto, including its affiliates and subsidiaries, as permitted by applicable law. Thank you.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170109/3778f785/attachment.bin>

From mdsumner at gmail.com  Tue Jan 10 12:02:22 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 10 Jan 2017 11:02:22 +0000
Subject: [R-sig-Geo] ongoing spatial developments in R
Message-ID: <CAAcGz98sDuA4oN4-GwuOgYirmee_VqR1QHaukah-w1EvVwBVDQ@mail.gmail.com>

Hello,

this is just a note to share some links about new developments in the R
spatial ecosystems.

1) Simple features for R

The main thing going on is the new "simple features for R" package, which
is still in development, but is now on CRAN:

http://r-spatial.org/r/2016/11/02/sfcran.html

("Simple features" is about the "vector stuff", shapefiles and the like,
i.e.  points, lines, and polygons - not the gridded raster/image stuff.)

The best place for an intro is Edzer's blog post/s above, and the vignettes
that are included with the package - and I mean it, if you are interested
in spatial in R you should read these, it is excellent material. You will
be pleasantly surprised by what is possible and how well things are
explained and the ease of use and overall consistency.

Please note that "sf" and its kin is not yet a total replacement for the
sp/rgdal/raster family so those packages will continue to be important for
some time, and it may be that the new stuff is not relevant to you. This is
an area of active development, which is not to everyone's tastes and needs
so use your own discretion of course.

There are important opportunities leveraging the simple features support,
and the biggest ones are the packages "leaflet", "ggplot2", and "mapview".
These are all on CRAN and have open development repositories where you can
see what is going on and what is in the pipeline. There will be much
greater flexibility and efficiency for spatial tasks in R, and there will
be powerful tools for interactivity and new ways of thinking about and
working with spatial data.

2) Future directions and discussion

There is a general "future directions and discussion" repository on GitHub,
set up by Tim Appelhans (an author of mapview). Check out the material
there and the discussions in the "Issues" tab, get involved.

https://github.com/tim-salabim/rspatial

I have written a pretty loose and opinionated summary here, not all of it
is accurate partly due to ongoing improvements in various packages. I've
had to edit this document to keep it accurate in the last few days, having
written the first draft 10 days ago. (Some of it is probably just wrong and
some is speculative and dreamy)

http://mdsumner.github.io/2017/01/10/spatial-r-2017.html

3) LiDAR!

CRAN now has LAS and LiDAR manipulation support in two integrated packages.
  I love this, it's been a huge hole for a long time and having this now is
very timely for future directions.

https://CRAN.R-project.org/package=lidR
https://CRAN.R-project.org/package=rlas

4) Community

Finally, please explore the new stuff, get involved, share your ideas and
tell this list and the world what you want and what you've tried. All the
developing projects will welcome reproducible tests and bug reports and
contributions, though do check them individually for a code of conduct and
how-tos for getting involved.

There are also other active community discussion on twitter, see the
#rstats tag there.

All the best.

Michael Sumner


-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From sourabh.vds at gmail.com  Tue Jan 10 12:22:18 2017
From: sourabh.vds at gmail.com (Sourabh Shrivastava)
Date: Tue, 10 Jan 2017 16:52:18 +0530
Subject: [R-sig-Geo] Reliability Diagram
Message-ID: <CAE3S--GWh6v3=L8GUz-RCk+rJWhWVaKwOqfh=cjAmDy79F_fNA@mail.gmail.com>

Hello,

I want to draw reliability diagram by model forecast and Observation.
As, I am very new in R.
so please help me out, How i can draw reliability diagram in R.

Thanking You

-- 
SOURABH SHRIVASTAVA

	[[alternative HTML version deleted]]


From mirzaceng at gmail.com  Tue Jan 10 15:59:26 2017
From: mirzaceng at gmail.com (Mirza Cengic)
Date: Tue, 10 Jan 2017 15:59:26 +0100
Subject: [R-sig-Geo] Passing a custom function to raster::focal
Message-ID: <CAJAunfd7whaLCjxGpq_19OXivH3Q7yZHGaKfG_wWfWBM3n0rGQ@mail.gmail.com>

Hi all,

I want to run the focal() function from the raster package with a custom
function. I want to calculate within a moving kernel (in the example I
provided 5x5), what is the percentage of cells with the value 1 (frequency
would work as well), and assign the value of the center cell of the moving
window. The error occurs when I run the focal function. I suppose the error
might come from using an inappropriate method on the object, but I am not
really sure how to solve it. Could you please give me some hints what am I
doing wrong.


Regards,
Mirza.

Example:

library(raster)
>
> my_rast <- raster(ncols=40, nrows=20, xmn=0)
> my_rast[] <- rnorm(ncell(my_rast))
>
> # Reclassify to binary raster
> my_mat <- c(cellStats(my_rast, min),cellStats(my_rast, max)/2,
>        cellStats(my_rast, max)/2, cellStats(my_rast, max), 0,1)
> my_rcl_mat <- matrix(my_mat, ncol=3, byrow=FALSE)
> my_rast_rcl <- reclassify(my_rast, my_rcl_mat)
>
> # Function to calculate percentage of cells with value of 1
> calc_pctg <- function(x)
> {
>   pct_val <- sum(values(x) == 1, na.rm = TRUE)/length(x)
>   return(pct_val)
> }
>
> # Run focal
> my_rast_fcl <- focal(my_rast_rcl,
>                      w = matrix(1/25,nrow=5,ncol=5),
>                      calc_pctg)





>

-- 
>
*Mirza ?engi?*

*Junior Researcher | Department of Environmental Science*
Radboud University | Heyendaalseweg 135
6525 AJ Nijmegen | The Netherlands

+31 657020823 | +38761908392
Skype: mirzacengic
<https://www.linkedin.com/in/mirzacengic>

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Tue Jan 10 16:16:56 2017
From: btupper at bigelow.org (Ben Tupper)
Date: Tue, 10 Jan 2017 10:16:56 -0500
Subject: [R-sig-Geo] Passing a custom function to raster::focal
In-Reply-To: <CAJAunfd7whaLCjxGpq_19OXivH3Q7yZHGaKfG_wWfWBM3n0rGQ@mail.gmail.com>
References: <CAJAunfd7whaLCjxGpq_19OXivH3Q7yZHGaKfG_wWfWBM3n0rGQ@mail.gmail.com>
Message-ID: <98AA6E07-5B29-47E9-AF5F-9C1CF3F3494D@bigelow.org>

Hi,

Your calc_pctg() function is trying to treat the input as a raster (well, a mini-raster).  I think that you actually get a numeric.  So, if you drop the call to values(x) in the sum you should be fine.


# Function to calculate percentage of cells with value of 1
calc_pctg <- function(x)
{
 pct_val <- sum(x == 1, na.rm = TRUE)/length(x)
 return(pct_val)
}

Ben

 

> On Jan 10, 2017, at 9:59 AM, Mirza Cengic <mirzaceng at gmail.com> wrote:
> 
> Hi all,
> 
> I want to run the focal() function from the raster package with a custom
> function. I want to calculate within a moving kernel (in the example I
> provided 5x5), what is the percentage of cells with the value 1 (frequency
> would work as well), and assign the value of the center cell of the moving
> window. The error occurs when I run the focal function. I suppose the error
> might come from using an inappropriate method on the object, but I am not
> really sure how to solve it. Could you please give me some hints what am I
> doing wrong.
> 
> 
> Regards,
> Mirza.
> 
> Example:
> 
> library(raster)
>> 
>> my_rast <- raster(ncols=40, nrows=20, xmn=0)
>> my_rast[] <- rnorm(ncell(my_rast))
>> 
>> # Reclassify to binary raster
>> my_mat <- c(cellStats(my_rast, min),cellStats(my_rast, max)/2,
>>       cellStats(my_rast, max)/2, cellStats(my_rast, max), 0,1)
>> my_rcl_mat <- matrix(my_mat, ncol=3, byrow=FALSE)
>> my_rast_rcl <- reclassify(my_rast, my_rcl_mat)
>> 
>> # Function to calculate percentage of cells with value of 1
>> calc_pctg <- function(x)
>> {
>>  pct_val <- sum(values(x) == 1, na.rm = TRUE)/length(x)
>>  return(pct_val)
>> }
>> 
>> # Run focal
>> my_rast_fcl <- focal(my_rast_rcl,
>>                     w = matrix(1/25,nrow=5,ncol=5),
>>                     calc_pctg)
> 
> 
> 
> 
> 
>> 
> 
> -- 
>> 
> *Mirza ?engi?*
> 
> *Junior Researcher | Department of Environmental Science*
> Radboud University | Heyendaalseweg 135
> 6525 AJ Nijmegen | The Netherlands
> 
> +31 657020823 | +38761908392
> Skype: mirzacengic
> <https://www.linkedin.com/in/mirzacengic>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From milujisb at gmail.com  Wed Jan 11 00:19:12 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Wed, 11 Jan 2017 00:19:12 +0100
Subject: [R-sig-Geo] Elevation data
Message-ID: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>

Dear all.

Is there a way to download global elevation data at the 1? x 1? resolution
in R using a given set of coordinates?

I know about the getData() function but can many coordinates be passed
through this? Thanks!

Sincerely,

Milu

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Jan 11 01:39:15 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 11 Jan 2017 00:39:15 +0000
Subject: [R-sig-Geo] Best practices for transforming raster data without
 altering values
In-Reply-To: <1426866284.683713.1483905619540@mail.yahoo.com>
References: <1426866284.683713.1483905619540.ref@mail.yahoo.com>
	<1426866284.683713.1483905619540@mail.yahoo.com>
Message-ID: <CAAcGz9_1SWP8KTWXC4UgDUSkSRy1v7QXqchTrj85g2-niPmx_A@mail.gmail.com>

I would avoid raster reprojection (warping) here, you can do everything you
need by extraction by, as you say, transforming the vector data to it.
This can be both more exacting without lossy sampling/aggregation, and much
more efficient.

But, it's a little abstract, has some key tricks required for efficiency
and for dealing with *likely* topological limitations in reshaping. Also
the best way to do always depends on specific details about your data and
the desired result.  I tend to use polar layers over large regions, so the
common workflows break down pretty quickly and these more abstract tricks
are better.

I would start by making a vector layer that has the final structures in the
coordinate system you want for your model, then decide what's best for
summarizing pixels into those.

If you just want a picture, then I would warp the raster - no problem,
you'll want to think about the target resolution, how the thing gets split
over the longitude boundary and rejoined, and the details of the resampling
(e.g. bilinear, nearest neighbour, or more intensively *explicit
aggregation* or focal/kernel operations).  GDAL is generally more suited to
controlling all this, but raster is easier to use of course.

All those warping details also are relevant and can inform how the vector
extraction gets done too, but from a slightly different perspective.

If you can provide a reproducible example of the raster and the vector
layer it's easiest to answer more questions.

Cheers, Mike.


On Mon, 9 Jan 2017 at 07:01 Valentin Stefan via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Dear all,
> I have several global rasters from http://worldclim.org/ and I want to
> project them in a equal area projection shifted on Pacific.A sample code
> is:bio_1.WGS84.global  <- raster("bio_1.bil")
> # I use World Cylindrical Equal Area (CEA)crs.cea <- "+proj=cea +lon_0=180
> +lat_ts=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m
> +no_defs"bio_1.1km <- projectRaster(from=bio_1.WGS84.global, res=1000,
> method='bilinear', crs = crs.cea)
> I came across the very helpful page maintained by Robert Hijmans at
> http://rspatial.org/spatial/rst/6-crs.html#transforming-raster-data ,where
> he mentions that "Because projection of rasters affects the cells values,
> in most cases you will want to avoid projecting raster data and rather
> project vector data."
> So, I know that the new (projected) cell values have been altered. There
> are not huge differences, nevertheless, is there a "good practice" to avoid
> changes in data while transforming a raster?
> I presume I can't work on unprojected data and I should use a equal area
> projection as I need to further aggregate the rasters at various
> resolutions (e.g. 5, 10, 20 km) and extract some cell statistics at given
> points across the Pacific.
> Kind regards,Valentin Stefan
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Jan 11 01:51:59 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 11 Jan 2017 00:51:59 +0000
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
Message-ID: <CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>

Passed through? Maybe you want ?raster::extract

There are a few versions of global elevation on CRAN, necessarily at low
resolution but no overall summary afaik (someone should do this :).

This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html

If you have the stomach for development versions of packages see elevatr:
https://github.com/jhollist/elevatr

I tend to have the high-resolution files at hand because we use them
constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
Smith-Sandwell).

There's a reasonable overview here, you probably should find a specific
data set that is at the resolution you are after already, and you can cite
its derivation for your work:

http://vterrain.org/Elevation/global.html

Cheers, Mike.

On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:

> Dear all.
>
> Is there a way to download global elevation data at the 1? x 1? resolution
> in R using a given set of coordinates?
>
> I know about the getData() function but can many coordinates be passed
> through this? Thanks!
>
> Sincerely,
>
> Milu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> University of Tasmania Electronic Communications Policy (December, 2014).
> This email is confidential, and is for the intended recipient only.
> Access, disclosure, copying, distribution, or reliance on any of it by
> anyone outside the intended recipient organisation is prohibited and may be
> a criminal offence. Please delete if obtained in error and email
> confirmation to the sender. The views expressed in this email are not
> necessarily the views of the University of Tasmania, unless clearly
> intended otherwise.
> .
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From milujisb at gmail.com  Wed Jan 11 12:26:11 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Wed, 11 Jan 2017 12:26:11 +0100
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
	<CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
Message-ID: <CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>

Dear Michael,

Thank you for your reply and the suggestions.

Ideally, I would like a raster from which I can extract elevation at 1? x
1? resolution. I do not have much experience with working with DEM but have
work with data such as GPW.

I will definitely look at the datasets. Could you kindly suggest one that I
could convert to raster and extract? Hope that's not a silly question.

Sincerely,

Milu

On Wed, Jan 11, 2017 at 1:51 AM, Michael Sumner <mdsumner at gmail.com> wrote:

> Passed through? Maybe you want ?raster::extract
>
> There are a few versions of global elevation on CRAN, necessarily at low
> resolution but no overall summary afaik (someone should do this :).
>
> This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html
>
> If you have the stomach for development versions of packages see elevatr:
> https://github.com/jhollist/elevatr
>
> I tend to have the high-resolution files at hand because we use them
> constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
> Smith-Sandwell).
>
> There's a reasonable overview here, you probably should find a specific
> data set that is at the resolution you are after already, and you can cite
> its derivation for your work:
>
> http://vterrain.org/Elevation/global.html
>
> Cheers, Mike.
>
> On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:
>
>> Dear all.
>>
>> Is there a way to download global elevation data at the 1? x 1? resolution
>> in R using a given set of coordinates?
>>
>> I know about the getData() function but can many coordinates be passed
>> through this? Thanks!
>>
>> Sincerely,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> University of Tasmania Electronic Communications Policy (December, 2014).
>> This email is confidential, and is for the intended recipient only.
>> Access, disclosure, copying, distribution, or reliance on any of it by
>> anyone outside the intended recipient organisation is prohibited and may be
>> a criminal offence. Please delete if obtained in error and email
>> confirmation to the sender. The views expressed in this email are not
>> necessarily the views of the University of Tasmania, unless clearly
>> intended otherwise.
>> .
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>

	[[alternative HTML version deleted]]


From Hollister.Jeff at epa.gov  Wed Jan 11 12:59:38 2017
From: Hollister.Jeff at epa.gov (Hollister, Jeff)
Date: Wed, 11 Jan 2017 11:59:38 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 161, Issue 7
In-Reply-To: <mailman.11.1484132402.7639.r-sig-geo@r-project.org>
References: <mailman.11.1484132402.7639.r-sig-geo@r-project.org>
Message-ID: <BY2PR09MB0676728D4AF5F260F51C906081660@BY2PR09MB0676.namprd09.prod.outlook.com>

Mike mentioned https://github.com/jhollist/elevatr and it is still in development, but is very close to being submitted to CRAN so for the time being the development version shouldn't cause to much queasiness!


It access both point elevations from a data frame of xy's or a SpatialPoints/SpatialPointsDataFrame or a raster DEM from data frame/sp object bounding box.  The primary source is the Mapzen elevation/terrain tiles (<https://tile.mapzen.com/mapzen/terrain/v1/>https://mapzen.com/documentation/terrain-tiles/ and https://mapzen.com/documentation/elevation/elevation-service/).


Cheers,

Jeff



>Message: 7
>Date: Wed, 11 Jan 2017 00:51:59 +0000
>From: Michael Sumner <mdsumner at gmail.com>
>To: Miluji Sb <milujisb at gmail.com>,     R-sig-geo mailing list
>       <r-sig-geo at r-project.org>
>Subject: Re: [R-sig-Geo] Elevation data
>Message-ID:
 >       <CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ at mail.gmail.com>
>Content-Type: text/plain; charset="UTF-8"
>
>Passed through? Maybe you want ?raster::extract
>
>There are a few versions of global elevation on CRAN, necessarily at low
>resolution but no overall summary afaik (someone should do this :).
>
>This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html
>
>If you have the stomach for development versions of packages see elevatr:
>https://github.com/jhollist/elevatr<https://github.com/jhollist/elevatr>
>
>I tend to have the high-resolution files at hand because we use them
>constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
>Smith-Sandwell).
>
>There's a reasonable overview here, you probably should find a specific
>data set that is at the resolution you are after already, and you can cite
>its derivation for your work:
>
>http://vterrain.org/Elevation/global.html<http://vterrain.org/Elevation/global.html>
>
>Cheers, Mike.
>
>On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:>
>
>> Dear all.
>>
>> Is there a way to download global elevation data at the 1? x 1? resolution
>> in R using a given set of coordinates?
>>
>> I know about the getData() function but can many coordinates be passed
>> through this? Thanks!
>>
>> Sincerely,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo<https://remoteworkplacedr.epa.gov/mailman/listinfo/,DanaInfo=.asucwDjzo7Ims,SSL+r-sig-geo>
>>
>>
>> University of Tasmania Electronic Communications Policy (December, 2014).
>> This email is confidential, and is for the intended recipient only.
>> Access, disclosure, copying, distribution, or reliance on any of it by
>> anyone outside the intended recipient organisation is prohibited and may be
>> a criminal offence. Please delete if obtained in error and email
>> confirmation to the sender. The views expressed in this email are not
>> necessarily the views of the University of Tasmania, unless clearly
>> intended otherwise.
>> .
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From milujisb at gmail.com  Thu Jan 12 17:07:36 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Thu, 12 Jan 2017 17:07:36 +0100
Subject: [R-sig-Geo] Difference in coordinates to country conversion
Message-ID: <CAMLwc7PgauM8MpXv6z448_N79fymnPJPvDkxbsn0d3Om_YXjKg@mail.gmail.com>

I have a set of coordinates at 1? x 1?  which look like this:

structure(list(longitude = c(-179L, -178L, -177L, -177L, -177L,
-176L), latitude = c(-15L, -15L, -14L, 51L, 52L, -22L)), .Names =
c("longitude",
"latitude"), row.names = c("1", "2", "3", "4", "5", "6"), class =
"data.frame")

I am trying to obtain country names for them and tried the following two
methods. There are some difference (mostly between USA and Canada). While
sometimes method 1 provides a country name but method 2 cannot.

Is there a way to say if either of the methods are more accurate? Or
another more accurate method? Or am I doing something wrong?

Thanks!

Sincerely,

Shouro

library(raster)
library(tmap)
library(rworldmap)
library(countrycode)

# Method 1

{
  countriesSP <- getMap(resolution='low')
  #countriesSP <- getMap(resolution='high') #you could use high res map
from rworldxtra if you were concerned about detail

  # convert our list of points to a SpatialPoints object

  # pointsSP = SpatialPoints(points, proj4string=CRS(" +proj=longlat
+ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"))

  #setting CRS directly to that from rworldmap
  pointsSP = SpatialPoints(coord_dams,
proj4string=CRS(proj4string(countriesSP)))


  # use 'over' to get indices of the Polygons object containing each point
  indices = over(pointsSP, countriesSP)

  # return the ADMIN names of each country
  indices$ADMIN
  #indices$ISO3 # returns the ISO3 code
  #indices$continent   # returns the continent (6 continent model)
  #indices$REGION   # returns the continent (7 continent model)
}

# Method 2
pts_dams <- SpatialPoints(coord_dams,proj4string=CRS(proj4string(worldmap)))
indices_dams <- over(pts_dams, worldmap,na.rm=TRUE)
indices <- cbind(indices_dams, coord_dams)

#Keep only ISO3, log, lat
foo_dams<-indices[,c(3,12,13)]

	[[alternative HTML version deleted]]


From martazores at gmail.com  Thu Jan 12 17:17:58 2017
From: martazores at gmail.com (marta azores)
Date: Thu, 12 Jan 2017 15:17:58 -0100
Subject: [R-sig-Geo] shortestPath in a loop
Message-ID: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>

Dear forum members,

I would like to know how join several points with the aim to track a ship.

After reading the documentation of some packages, I decided to use the
function shortestPath, but I only got the line between the first and the
last location of my points list. I need the complete survey, including also
the middle points. I try a loop to build the survey of the boats using
their locations, but It didn't work to me.


Any idea?

Thanks in advance,

Marta

#script# it's also attached in a R.file: question loop2.R
##########################################################
#
#raster# it's attached
azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
#
#10 points# it's attached
boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE, sep=",",
na.strings="NA", dec=".", strip.white=TRUE)#
head(boat)

#raster to transitionlayer
trCostS4<- transition(1/azoTS1, mean, directions=4)

# points to spatialpointsdataframe
x=boat$Long1
y=boat$Lat1
coords = cbind(x, y)
plot(coords)
sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
+datum=WGS84"), bbox = NULL)
sp
spdf=SpatialPointsDataFrame(sp,boat)
spdf
nrow(spdf)
plot(sp,axes=TRUE)
plot(spdf,add=TRUE, axes=TRUE)

#shortestpath

## 1) this script only join the first point of the list and the last one,
and the points in the middle are not used.
CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
output="SpatialLines")
plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)

## 2) this script didn't work to me

#first way from website:
http://stackoverflow.com/questions/8127066/loop-or-sapply-function-for-multiple-least-cost-analysis-in-r?answertab=active#tab-top
for(i in 1:nrow(spdf)) {
  # Computation
  Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
output="SpatialLines")
  plot(Costpath)

}

#Error in validObject(.Object) :
#invalid class ?SpatialLines? object: bbox should never contain infinite
values
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170112/e3166d43/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: azoTS1.tif
Type: image/tiff
Size: 1841 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170112/e3166d43/attachment.tif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 10pontos.csv
Type: text/csv
Size: 222 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170112/e3166d43/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: question loop2.R
Type: application/octet-stream
Size: 1513 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170112/e3166d43/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rplot_1.png
Type: image/png
Size: 2089 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170112/e3166d43/attachment.png>

From mdsumner at gmail.com  Thu Jan 12 21:45:18 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 12 Jan 2017 20:45:18 +0000
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
References: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
Message-ID: <CAAcGz9-XO07o3uN0EjUzt9Pk+Wtfh1Vw3FK8fAn7-LmQWhELSw@mail.gmail.com>

This seems impossible ( to get right, you can certainly get an answer)  in
general terms, do you really not know either an order of the points and/or
their relative spacing in time?

On Fri, Jan 13, 2017, 03:18 marta azores <martazores at gmail.com> wrote:

> Dear forum members,
>
> I would like to know how join several points with the aim to track a ship.
>
> After reading the documentation of some packages, I decided to use the
> function shortestPath, but I only got the line between the first and the
> last location of my points list. I need the complete survey, including also
> the middle points. I try a loop to build the survey of the boats using
> their locations, but It didn't work to me.
>
>
> Any idea?
>
> Thanks in advance,
>
> Marta
>
> #script# it's also attached in a R.file: question loop2.R
> ##########################################################
> #
> #raster# it's attached
> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
> #
> #10 points# it's attached
> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
> head(boat)
>
> #raster to transitionlayer
> trCostS4<- transition(1/azoTS1, mean, directions=4)
>
> # points to spatialpointsdataframe
> x=boat$Long1
> y=boat$Lat1
> coords = cbind(x, y)
> plot(coords)
> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84"), bbox = NULL)
> sp
> spdf=SpatialPointsDataFrame(sp,boat)
> spdf
> nrow(spdf)
> plot(sp,axes=TRUE)
> plot(spdf,add=TRUE, axes=TRUE)
>
> #shortestpath
>
> ## 1) this script only join the first point of the list and the last one,
> and the points in the middle are not used.
> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
> output="SpatialLines")
> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)
>
> ## 2) this script didn't work to me
>
> #first way from website:
> http://stackoverflow.com/questions/8127066/loop-or-sapply-function-for-multiple-least-cost-analysis-in-r?answertab=active#tab-top
> for(i in 1:nrow(spdf)) {
>   # Computation
>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
> output="SpatialLines")
>   plot(Costpath)
>
> }
>
> #Error in validObject(.Object) :
> #invalid class ?SpatialLines? object: bbox should never contain infinite
> values
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From carr at nimbios.org  Thu Jan 12 22:03:48 2017
From: carr at nimbios.org (Eric Carr)
Date: Thu, 12 Jan 2017 16:03:48 -0500
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
References: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
Message-ID: <CA+XavVB8OSiktMhRBFw60iAbucJu4mWHD11FCQkNnZrRCTdv3g@mail.gmail.com>

Generically independent of R, A graph and the connectivity between points
needs defined before a shortest path algorithm can be applied.  If it
assumes all points are connected, than the shortest path will be a straight
line.  What you are looking for is some sort of  minimum spanning tree for
the vertices.
Eric

On Thu, Jan 12, 2017 at 11:17 AM, marta azores <martazores at gmail.com> wrote:

> Dear forum members,
>
> I would like to know how join several points with the aim to track a ship.
>
> After reading the documentation of some packages, I decided to use the
> function shortestPath, but I only got the line between the first and the
> last location of my points list. I need the complete survey, including also
> the middle points. I try a loop to build the survey of the boats using
> their locations, but It didn't work to me.
>
>
> Any idea?
>
> Thanks in advance,
>
> Marta
>
> #script# it's also attached in a R.file: question loop2.R
> ##########################################################
> #
> #raster# it's attached
> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
> #
> #10 points# it's attached
> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
> head(boat)
>
> #raster to transitionlayer
> trCostS4<- transition(1/azoTS1, mean, directions=4)
>
> # points to spatialpointsdataframe
> x=boat$Long1
> y=boat$Lat1
> coords = cbind(x, y)
> plot(coords)
> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
> +datum=WGS84"), bbox = NULL)
> sp
> spdf=SpatialPointsDataFrame(sp,boat)
> spdf
> nrow(spdf)
> plot(sp,axes=TRUE)
> plot(spdf,add=TRUE, axes=TRUE)
>
> #shortestpath
>
> ## 1) this script only join the first point of the list and the last one,
> and the points in the middle are not used.
> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
> output="SpatialLines")
> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)
>
> ## 2) this script didn't work to me
>
> #first way from website: http://stackoverflow.com/
> questions/8127066/loop-or-sapply-function-for-multiple-
> least-cost-analysis-in-r?answertab=active#tab-top
> for(i in 1:nrow(spdf)) {
>   # Computation
>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
> output="SpatialLines")
>   plot(Costpath)
>
> }
>
> #Error in validObject(.Object) :
> #invalid class ?SpatialLines? object: bbox should never contain infinite
> values
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mel at mbacou.com  Fri Jan 13 03:11:50 2017
From: mel at mbacou.com (Bacou, Melanie)
Date: Thu, 12 Jan 2017 21:11:50 -0500
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
	<CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
	<CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>
Message-ID: <d7113880-ae28-f114-a9ee-d259748c5a47@mbacou.com>

R raster::getData("SRTM", ...) will return elevation rasters at 90m 
resolution.
See:
https://www.rdocumentation.org/packages/raster/versions/2.5-8/topics/getData 

http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1

--Mel.

On 1/11/2017 6:26 AM, Miluji Sb wrote:
> Dear Michael,
>
> Thank you for your reply and the suggestions.
>
> Ideally, I would like a raster from which I can extract elevation at 1? x
> 1? resolution. I do not have much experience with working with DEM but have
> work with data such as GPW.
>
> I will definitely look at the datasets. Could you kindly suggest one that I
> could convert to raster and extract? Hope that's not a silly question.
>
> Sincerely,
>
> Milu
>
> On Wed, Jan 11, 2017 at 1:51 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>
>> Passed through? Maybe you want ?raster::extract
>>
>> There are a few versions of global elevation on CRAN, necessarily at low
>> resolution but no overall summary afaik (someone should do this :).
>>
>> This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html
>>
>> If you have the stomach for development versions of packages see elevatr:
>> https://github.com/jhollist/elevatr
>>
>> I tend to have the high-resolution files at hand because we use them
>> constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
>> Smith-Sandwell).
>>
>> There's a reasonable overview here, you probably should find a specific
>> data set that is at the resolution you are after already, and you can cite
>> its derivation for your work:
>>
>> http://vterrain.org/Elevation/global.html
>>
>> Cheers, Mike.
>>
>> On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:
>>
>>> Dear all.
>>>
>>> Is there a way to download global elevation data at the 1? x 1? resolution
>>> in R using a given set of coordinates?
>>>
>>> I know about the getData() function but can many coordinates be passed
>>> through this? Thanks!
>>>
>>> Sincerely,
>>>
>>> Milu
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> University of Tasmania Electronic Communications Policy (December, 2014).
>>> This email is confidential, and is for the intended recipient only.
>>> Access, disclosure, copying, distribution, or reliance on any of it by
>>> anyone outside the intended recipient organisation is prohibited and may be
>>> a criminal offence. Please delete if obtained in error and email
>>> confirmation to the sender. The views expressed in this email are not
>>> necessarily the views of the University of Tasmania, unless clearly
>>> intended otherwise.
>>> .
>>>
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Fri Jan 13 09:02:21 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 13 Jan 2017 09:02:21 +0100
Subject: [R-sig-Geo] sp::spDists*
In-Reply-To: <alpine.LFD.2.20.1701091138360.3056@reclus.nhh.no>
References: <5f120dcd-0b4a-33f4-52a0-6da70a511cae@uni-muenster.de>
	<alpine.LFD.2.20.1701091138360.3056@reclus.nhh.no>
Message-ID: <7dc3b1f3-03fd-26dc-4088-bb1097bdd972@uni-muenster.de>

A new version of gstat, fixing the same bug, is now also on CRAN.

On 09/01/17 11:39, Roger Bivand wrote:
> New versions of spdep and spgwr fixing the same bug are now on CRAN.
> 
> Roger
> 
> On Thu, 8 Dec 2016, Edzer Pebesma wrote:
> 
>> While building support for geosphere distance functions in sf and
>> comparing results from geosphere::distMeeuws with those of sp::spDists,
>> I found a typo in the C code underlying the great circle distance
>> computation functions in sp (sp::spDists, sp::spDistsN1) [*]:
>>
>> https://github.com/edzer/sp/commit/d8374ff7efc6735cba9a054748c602bed0672f23
>>
>>
>> Before:
>>> library(sf)
>> Linking to GEOS 3.5.0, GDAL 2.1.0, proj.4 4.9.2
>>> library(sp)
>>> library(units)
>>>
>>> x = st_sfc(
>> + st_point(c(0,0)),
>> + st_point(c(1,0)),
>> + st_point(c(2,0)),
>> + st_point(c(3,0)),
>> + crs = 4326
>> + )
>>>
>>> y = st_sfc(
>> + st_point(c(0,10)),
>> + st_point(c(1,0)),
>> + st_point(c(2,0)),
>> + st_point(c(3,0)),
>> + st_point(c(4,0)),
>> + crs = 4326
>> + )
>>>
>>> st_distance(x, y)
>> Units: m
>>        [,1]     [,2]     [,3]     [,4]     [,5]
>> [1,] 1105855 111319.5 222639.0 333958.5 445278.0
>> [2,] 1111387      0.0 111319.5 222639.0 333958.5
>> [3,] 1127822 111319.5      0.0 111319.5 222639.0
>> [4,] 1154693 222639.0 111319.5      0.0 111319.5
>>>
>>> d.sf = st_distance(x, y, geosphere::distMeeus)
>>> d.sp = spDists(as(x, "Spatial"), as(y, "Spatial"))
>>> units(d.sp) = make_unit("km")
>>> d.sf - d.sp
>> Units: m
>>         [,1]         [,2]         [,3]         [,4] [,5]
>> [1,] 1851.990 0.000000e+00 0.000000e+00 0.000000e+00    0
>> [2,] 1842.938 0.000000e+00 0.000000e+00 2.910383e-11    0
>> [3,] 1816.564 0.000000e+00 0.000000e+00 1.455192e-11    0
>> [4,] 1775.032 2.910383e-11 1.455192e-11 0.000000e+00    0
>>>
>>
>>
>>
>> After:
>>
>>> library(sf)
>> Linking to GEOS 3.5.0, GDAL 2.1.0, proj.4 4.9.2
>>> library(sp)
>>> library(units)
>>>
>>> x = st_sfc(
>> + st_point(c(0,0)),
>> + st_point(c(1,0)),
>> + st_point(c(2,0)),
>> + st_point(c(3,0)),
>> + crs = 4326
>> + )
>>>
>>> y = st_sfc(
>> + st_point(c(0,10)),
>> + st_point(c(1,0)),
>> + st_point(c(2,0)),
>> + st_point(c(3,0)),
>> + st_point(c(4,0)),
>> + crs = 4326
>> + )
>>>
>>> st_distance(x, y)
>> Units: m
>>        [,1]     [,2]     [,3]     [,4]     [,5]
>> [1,] 1105855 111319.5 222639.0 333958.5 445278.0
>> [2,] 1111387      0.0 111319.5 222639.0 333958.5
>> [3,] 1127822 111319.5      0.0 111319.5 222639.0
>> [4,] 1154693 222639.0 111319.5      0.0 111319.5
>>>
>>> d.sf = st_distance(x, y, geosphere::distMeeus)
>>> d.sp = spDists(as(x, "Spatial"), as(y, "Spatial"))
>>> units(d.sp) = make_unit("km")
>>> d.sf - d.sp
>> Units: m
>>              [,1]         [,2]         [,3]         [,4] [,5]
>> [1,] -2.328306e-10 0.000000e+00 0.000000e+00 0.000000e+00    0
>> [2,]  2.328306e-10 0.000000e+00 0.000000e+00 2.910383e-11    0
>> [3,]  0.000000e+00 0.000000e+00 0.000000e+00 1.455192e-11    0
>> [4,]  0.000000e+00 2.910383e-11 1.455192e-11 0.000000e+00    0
>>>
>>
>> [*] assuming the source code of
>> http://www.abecedarical.com/javascript/script_greatcircle.html is
>> correct; I don't have access to the Meeuws book mentioned there under
>> (1).
>>
>> The same C function is used by gstat; I corrected that as well.
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170113/c3a16da9/attachment.bin>

From milujisb at gmail.com  Fri Jan 13 10:59:31 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Fri, 13 Jan 2017 10:59:31 +0100
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <d7113880-ae28-f114-a9ee-d259748c5a47@mbacou.com>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
	<CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
	<CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>
	<d7113880-ae28-f114-a9ee-d259748c5a47@mbacou.com>
Message-ID: <CAMLwc7PJ3dikK3vN-NVrnLJsgG58g_UY5QGo0sa93VWRY-m60w@mail.gmail.com>

Thank you for your reply. This is what I did:

###
library(data.table)
library(raster)
library(rgdal)
library(foreign)

elevation_world <- getData('worldclim', var='alt', res=2.5)

# Aggregate Elevation to 1 degree
elevation_world_1deg <- aggregate(elevation_world, fact = 24, fun = sum)

# Extract by lon lat (1? x 1? - gcp_grid)
elevation <- cbind(gcp_grid, alt = extract(elevation_world_1deg, gcp_grid))

elevation <- as.data.frame(elevation)
###

Is this correct? Thanks again!

Sincerely,

Milu

On Fri, Jan 13, 2017 at 3:11 AM, Bacou, Melanie <mel at mbacou.com> wrote:

> R raster::getData("SRTM", ...) will return elevation rasters at 90m
> resolution.
> See:
> https://www.rdocumentation.org/packages/raster/versions/2.5-
> 8/topics/getData
> http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1
>
> --Mel.
>
>
> On 1/11/2017 6:26 AM, Miluji Sb wrote:
>
>> Dear Michael,
>>
>> Thank you for your reply and the suggestions.
>>
>> Ideally, I would like a raster from which I can extract elevation at 1? x
>> 1? resolution. I do not have much experience with working with DEM but
>> have
>> work with data such as GPW.
>>
>> I will definitely look at the datasets. Could you kindly suggest one that
>> I
>> could convert to raster and extract? Hope that's not a silly question.
>>
>> Sincerely,
>>
>> Milu
>>
>> On Wed, Jan 11, 2017 at 1:51 AM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>>
>> Passed through? Maybe you want ?raster::extract
>>>
>>> There are a few versions of global elevation on CRAN, necessarily at low
>>> resolution but no overall summary afaik (someone should do this :).
>>>
>>> This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html
>>>
>>> If you have the stomach for development versions of packages see elevatr:
>>> https://github.com/jhollist/elevatr
>>>
>>> I tend to have the high-resolution files at hand because we use them
>>> constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
>>> Smith-Sandwell).
>>>
>>> There's a reasonable overview here, you probably should find a specific
>>> data set that is at the resolution you are after already, and you can
>>> cite
>>> its derivation for your work:
>>>
>>> http://vterrain.org/Elevation/global.html
>>>
>>> Cheers, Mike.
>>>
>>> On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:
>>>
>>> Dear all.
>>>>
>>>> Is there a way to download global elevation data at the 1? x 1?
>>>> resolution
>>>> in R using a given set of coordinates?
>>>>
>>>> I know about the getData() function but can many coordinates be passed
>>>> through this? Thanks!
>>>>
>>>> Sincerely,
>>>>
>>>> Milu
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>> University of Tasmania Electronic Communications Policy (December,
>>>> 2014).
>>>> This email is confidential, and is for the intended recipient only.
>>>> Access, disclosure, copying, distribution, or reliance on any of it by
>>>> anyone outside the intended recipient organisation is prohibited and
>>>> may be
>>>> a criminal offence. Please delete if obtained in error and email
>>>> confirmation to the sender. The views expressed in this email are not
>>>> necessarily the views of the University of Tasmania, unless clearly
>>>> intended otherwise.
>>>> .
>>>>
>>>> --
>>> Dr. Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> 203 Channel Highway
>>> Kingston Tasmania 7050 Australia
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From martazores at gmail.com  Fri Jan 13 11:41:21 2017
From: martazores at gmail.com (marta azores)
Date: Fri, 13 Jan 2017 09:41:21 -0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CA+XavVB8OSiktMhRBFw60iAbucJu4mWHD11FCQkNnZrRCTdv3g@mail.gmail.com>
References: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
	<CA+XavVB8OSiktMhRBFw60iAbucJu4mWHD11FCQkNnZrRCTdv3g@mail.gmail.com>
Message-ID: <CAE3WKgTxgehT42p_pzTXFPnR-WbHiT=KPf74cKTFfJq14kzYFw@mail.gmail.com>

Thanks for your quick reply to my question,

This ten points are ordered by time (date + time), and I know ,the points
are all connected.  I didn't include the column with the time in this
example, to make it simple.

After read your messages, I was looking the minimum spanning tree for the
vertices.
The advantage with the function "shortestPath" is that you have as result a
spatial line output, which I need it.
However, the minimum spanning tree give as output an ordiplot.

Is it possible to transform the ordiplot into spatialLines?

Thanks for your answers

Marta



2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org>:

> Generically independent of R, A graph and the connectivity between points
> needs defined before a shortest path algorithm can be applied.  If it
> assumes all points are connected, than the shortest path will be a straight
> line.  What you are looking for is some sort of  minimum spanning tree for
> the vertices.
> Eric
>
> On Thu, Jan 12, 2017 at 11:17 AM, marta azores <martazores at gmail.com>
> wrote:
>
>> Dear forum members,
>>
>> I would like to know how join several points with the aim to track a ship.
>>
>> After reading the documentation of some packages, I decided to use the
>> function shortestPath, but I only got the line between the first and the
>> last location of my points list. I need the complete survey, including also
>> the middle points. I try a loop to build the survey of the boats using
>> their locations, but It didn't work to me.
>>
>>
>> Any idea?
>>
>> Thanks in advance,
>>
>> Marta
>>
>> #script# it's also attached in a R.file: question loop2.R
>> ##########################################################
>> #
>> #raster# it's attached
>> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
>> #
>> #10 points# it's attached
>> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
>> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
>> head(boat)
>>
>> #raster to transitionlayer
>> trCostS4<- transition(1/azoTS1, mean, directions=4)
>>
>> # points to spatialpointsdataframe
>> x=boat$Long1
>> y=boat$Lat1
>> coords = cbind(x, y)
>> plot(coords)
>> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
>> +datum=WGS84"), bbox = NULL)
>> sp
>> spdf=SpatialPointsDataFrame(sp,boat)
>> spdf
>> nrow(spdf)
>> plot(sp,axes=TRUE)
>> plot(spdf,add=TRUE, axes=TRUE)
>>
>> #shortestpath
>>
>> ## 1) this script only join the first point of the list and the last one,
>> and the points in the middle are not used.
>> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
>> output="SpatialLines")
>> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)
>>
>> ## 2) this script didn't work to me
>>
>> #first way from website: http://stackoverflow.com/quest
>> ions/8127066/loop-or-sapply-function-for-multiple-least-
>> cost-analysis-in-r?answertab=active#tab-top
>> for(i in 1:nrow(spdf)) {
>>   # Computation
>>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
>> output="SpatialLines")
>>   plot(Costpath)
>>
>> }
>>
>> #Error in validObject(.Object) :
>> #invalid class ?SpatialLines? object: bbox should never contain infinite
>> values
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From matteo at mattiuzzi.com  Fri Jan 13 14:23:06 2017
From: matteo at mattiuzzi.com (Matteo Mattiuzzi)
Date: Fri, 13 Jan 2017 14:23:06 +0100
Subject: [R-sig-Geo] MODIS package released to CRAN
Message-ID: <CADcazoyL3QxGLkwKk_BBcTGNzN2JoGyYNi=7BFsYgEbvmDLm-w@mail.gmail.com>

Dear list,


We would like to announce the release of the MODIS package to CRAN. This
was finally possible thanks to the constant efforts of Florian Detsch, whom
I would like to say thank you!


Some months ago we decided to move the development from R-Forge to GitHub
and we are thankful for any contributions in the form of ideas,
bug-reports, pull requests or whatever helps.


GitHub repository: https://github.com/MatMatt/MODIS



We hope you will enjoy!


Kind regards,

Matteo

	[[alternative HTML version deleted]]


From loic.dutrieux at conabio.gob.mx  Fri Jan 13 15:35:16 2017
From: loic.dutrieux at conabio.gob.mx (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Fri, 13 Jan 2017 15:35:16 +0100
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <CAMLwc7PJ3dikK3vN-NVrnLJsgG58g_UY5QGo0sa93VWRY-m60w@mail.gmail.com>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
	<CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
	<CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>
	<d7113880-ae28-f114-a9ee-d259748c5a47@mbacou.com>
	<CAMLwc7PJ3dikK3vN-NVrnLJsgG58g_UY5QGo0sa93VWRY-m60w@mail.gmail.com>
Message-ID: <d890286e-c3fc-e83c-d522-f149eda4f2d9@conabio.gob.mx>



On 13/01/2017 10:59, Miluji Sb wrote:
> Thank you for your reply. This is what I did:
> 
> ###
> library(data.table)
> library(raster)
> library(rgdal)
> library(foreign)
> 
> elevation_world <- getData('worldclim', var='alt', res=2.5)
> 
> # Aggregate Elevation to 1 degree
> elevation_world_1deg <- aggregate(elevation_world, fact = 24, fun = sum)

Aggregating with fun=sum is a bit strange for elevation. mean or median
would certainly be a better choice.

> 
> # Extract by lon lat (1? x 1? - gcp_grid)
> elevation <- cbind(gcp_grid, alt = extract(elevation_world_1deg, gcp_grid))

gcp_grid are points or polygons? If they are polygons, there's no need
for the aggregation step above. Also have a look at df = TRUE, which
returns a dataframe, and sp=TRUE, which returns a Spatial*DataFrame with
extracted values cbinded to the attributes of the original
Spatial*DataFrame. (both are arguments of raster::extract)

Cheers,
Lo?c

> 
> elevation <- as.data.frame(elevation)
> ###
> 
> Is this correct? Thanks again!
> 
> Sincerely,
> 
> Milu
> 
> On Fri, Jan 13, 2017 at 3:11 AM, Bacou, Melanie <mel at mbacou.com> wrote:
> 
>> R raster::getData("SRTM", ...) will return elevation rasters at 90m
>> resolution.
>> See:
>> https://www.rdocumentation.org/packages/raster/versions/2.5-
>> 8/topics/getData
>> http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1
>>
>> --Mel.
>>
>>
>> On 1/11/2017 6:26 AM, Miluji Sb wrote:
>>
>>> Dear Michael,
>>>
>>> Thank you for your reply and the suggestions.
>>>
>>> Ideally, I would like a raster from which I can extract elevation at 1? x
>>> 1? resolution. I do not have much experience with working with DEM but
>>> have
>>> work with data such as GPW.
>>>
>>> I will definitely look at the datasets. Could you kindly suggest one that
>>> I
>>> could convert to raster and extract? Hope that's not a silly question.
>>>
>>> Sincerely,
>>>
>>> Milu
>>>
>>> On Wed, Jan 11, 2017 at 1:51 AM, Michael Sumner <mdsumner at gmail.com>
>>> wrote:
>>>
>>> Passed through? Maybe you want ?raster::extract
>>>>
>>>> There are a few versions of global elevation on CRAN, necessarily at low
>>>> resolution but no overall summary afaik (someone should do this :).
>>>>
>>>> This is one: https://cloud.r-project.org/web/packages/GEOmap/index.html
>>>>
>>>> If you have the stomach for development versions of packages see elevatr:
>>>> https://github.com/jhollist/elevatr
>>>>
>>>> I tend to have the high-resolution files at hand because we use them
>>>> constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
>>>> Smith-Sandwell).
>>>>
>>>> There's a reasonable overview here, you probably should find a specific
>>>> data set that is at the resolution you are after already, and you can
>>>> cite
>>>> its derivation for your work:
>>>>
>>>> http://vterrain.org/Elevation/global.html
>>>>
>>>> Cheers, Mike.
>>>>
>>>> On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:
>>>>
>>>> Dear all.
>>>>>
>>>>> Is there a way to download global elevation data at the 1? x 1?
>>>>> resolution
>>>>> in R using a given set of coordinates?
>>>>>
>>>>> I know about the getData() function but can many coordinates be passed
>>>>> through this? Thanks!
>>>>>
>>>>> Sincerely,
>>>>>
>>>>> Milu
>>>>>
>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>> University of Tasmania Electronic Communications Policy (December,
>>>>> 2014).
>>>>> This email is confidential, and is for the intended recipient only.
>>>>> Access, disclosure, copying, distribution, or reliance on any of it by
>>>>> anyone outside the intended recipient organisation is prohibited and
>>>>> may be
>>>>> a criminal offence. Please delete if obtained in error and email
>>>>> confirmation to the sender. The views expressed in this email are not
>>>>> necessarily the views of the University of Tasmania, unless clearly
>>>>> intended otherwise.
>>>>> .
>>>>>
>>>>> --
>>>> Dr. Michael Sumner
>>>> Software and Database Engineer
>>>> Australian Antarctic Division
>>>> 203 Channel Highway
>>>> Kingston Tasmania 7050 Australia
>>>>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From milujisb at gmail.com  Fri Jan 13 16:25:28 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Fri, 13 Jan 2017 16:25:28 +0100
Subject: [R-sig-Geo] Elevation data
In-Reply-To: <d890286e-c3fc-e83c-d522-f149eda4f2d9@conabio.gob.mx>
References: <CAMLwc7MN+Lvi-wdb0=U4RxtGomof7Q5bGh-RjJmF-xMP9VxHXg@mail.gmail.com>
	<CAAcGz9-EokqsPzyorVjvQzmtUmOzx4Y-L8W52DR9HDdbSqRwgQ@mail.gmail.com>
	<CAMLwc7PpmPipinjm4k+bQnsuZocToMfxNZUm43_QzQKn6Qp8sg@mail.gmail.com>
	<d7113880-ae28-f114-a9ee-d259748c5a47@mbacou.com>
	<CAMLwc7PJ3dikK3vN-NVrnLJsgG58g_UY5QGo0sa93VWRY-m60w@mail.gmail.com>
	<d890286e-c3fc-e83c-d522-f149eda4f2d9@conabio.gob.mx>
Message-ID: <CAMLwc7OXd+f7-KumuZquOOSnrW-=4Y2obznXeDf3cMqP_M6Vsw@mail.gmail.com>

Dear Loic,

Thank you for your reply!

Re. aggregation, I agree - I will use either mean or median.

gcp_grid are points as below

structure(list(longitude = c(-179L, -178L, -177L, -177L, -177L,
-176L), latitude = c(-15L, -15L, -14L, 51L, 52L, -22L)), .Names =
c("longitude",
"latitude"), row.names = c("1", "2", "3", "4", "5", "6"), class =
"data.frame")

Thank you for your suggestion on the additional options, I will look them
up. Would you say I am on the right path after the changes? Thanks again!

Sincerely,

Milu

On Fri, Jan 13, 2017 at 3:35 PM, Lo?c Dutrieux <loic.dutrieux at conabio.gob.mx
> wrote:

>
>
> On 13/01/2017 10:59, Miluji Sb wrote:
> > Thank you for your reply. This is what I did:
> >
> > ###
> > library(data.table)
> > library(raster)
> > library(rgdal)
> > library(foreign)
> >
> > elevation_world <- getData('worldclim', var='alt', res=2.5)
> >
> > # Aggregate Elevation to 1 degree
> > elevation_world_1deg <- aggregate(elevation_world, fact = 24, fun = sum)
>
> Aggregating with fun=sum is a bit strange for elevation. mean or median
> would certainly be a better choice.
>
> >
> > # Extract by lon lat (1? x 1? - gcp_grid)
> > elevation <- cbind(gcp_grid, alt = extract(elevation_world_1deg,
> gcp_grid))
>
> gcp_grid are points or polygons? If they are polygons, there's no need
> for the aggregation step above. Also have a look at df = TRUE, which
> returns a dataframe, and sp=TRUE, which returns a Spatial*DataFrame with
> extracted values cbinded to the attributes of the original
> Spatial*DataFrame. (both are arguments of raster::extract)
>
> Cheers,
> Lo?c
>
> >
> > elevation <- as.data.frame(elevation)
> > ###
> >
> > Is this correct? Thanks again!
> >
> > Sincerely,
> >
> > Milu
> >
> > On Fri, Jan 13, 2017 at 3:11 AM, Bacou, Melanie <mel at mbacou.com> wrote:
> >
> >> R raster::getData("SRTM", ...) will return elevation rasters at 90m
> >> resolution.
> >> See:
> >> https://www.rdocumentation.org/packages/raster/versions/2.5-
> >> 8/topics/getData
> >> http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1
> >>
> >> --Mel.
> >>
> >>
> >> On 1/11/2017 6:26 AM, Miluji Sb wrote:
> >>
> >>> Dear Michael,
> >>>
> >>> Thank you for your reply and the suggestions.
> >>>
> >>> Ideally, I would like a raster from which I can extract elevation at
> 1? x
> >>> 1? resolution. I do not have much experience with working with DEM but
> >>> have
> >>> work with data such as GPW.
> >>>
> >>> I will definitely look at the datasets. Could you kindly suggest one
> that
> >>> I
> >>> could convert to raster and extract? Hope that's not a silly question.
> >>>
> >>> Sincerely,
> >>>
> >>> Milu
> >>>
> >>> On Wed, Jan 11, 2017 at 1:51 AM, Michael Sumner <mdsumner at gmail.com>
> >>> wrote:
> >>>
> >>> Passed through? Maybe you want ?raster::extract
> >>>>
> >>>> There are a few versions of global elevation on CRAN, necessarily at
> low
> >>>> resolution but no overall summary afaik (someone should do this :).
> >>>>
> >>>> This is one: https://cloud.r-project.org/
> web/packages/GEOmap/index.html
> >>>>
> >>>> If you have the stomach for development versions of packages see
> elevatr:
> >>>> https://github.com/jhollist/elevatr
> >>>>
> >>>> I tend to have the high-resolution files at hand because we use them
> >>>> constantly, the main ones are Gebco14/Gebco08 and Etopo1/Etopo2 (from
> >>>> Smith-Sandwell).
> >>>>
> >>>> There's a reasonable overview here, you probably should find a
> specific
> >>>> data set that is at the resolution you are after already, and you can
> >>>> cite
> >>>> its derivation for your work:
> >>>>
> >>>> http://vterrain.org/Elevation/global.html
> >>>>
> >>>> Cheers, Mike.
> >>>>
> >>>> On Wed, 11 Jan 2017 at 10:20 Miluji Sb <milujisb at gmail.com> wrote:
> >>>>
> >>>> Dear all.
> >>>>>
> >>>>> Is there a way to download global elevation data at the 1? x 1?
> >>>>> resolution
> >>>>> in R using a given set of coordinates?
> >>>>>
> >>>>> I know about the getData() function but can many coordinates be
> passed
> >>>>> through this? Thanks!
> >>>>>
> >>>>> Sincerely,
> >>>>>
> >>>>> Milu
> >>>>>
> >>>>>          [[alternative HTML version deleted]]
> >>>>>
> >>>>> _______________________________________________
> >>>>> R-sig-Geo mailing list
> >>>>> R-sig-Geo at r-project.org
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>
> >>>>>
> >>>>> University of Tasmania Electronic Communications Policy (December,
> >>>>> 2014).
> >>>>> This email is confidential, and is for the intended recipient only.
> >>>>> Access, disclosure, copying, distribution, or reliance on any of it
> by
> >>>>> anyone outside the intended recipient organisation is prohibited and
> >>>>> may be
> >>>>> a criminal offence. Please delete if obtained in error and email
> >>>>> confirmation to the sender. The views expressed in this email are not
> >>>>> necessarily the views of the University of Tasmania, unless clearly
> >>>>> intended otherwise.
> >>>>> .
> >>>>>
> >>>>> --
> >>>> Dr. Michael Sumner
> >>>> Software and Database Engineer
> >>>> Australian Antarctic Division
> >>>> 203 Channel Highway
> >>>> Kingston Tasmania 7050 Australia
> >>>>
> >>>>
> >>>>         [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r-sig-geo at forreststevens.com  Fri Jan 13 16:44:20 2017
From: r-sig-geo at forreststevens.com (Forrest Stevens)
Date: Fri, 13 Jan 2017 15:44:20 +0000
Subject: [R-sig-Geo] MODIS package released to CRAN
In-Reply-To: <CADcazoyL3QxGLkwKk_BBcTGNzN2JoGyYNi=7BFsYgEbvmDLm-w@mail.gmail.com>
References: <CADcazoyL3QxGLkwKk_BBcTGNzN2JoGyYNi=7BFsYgEbvmDLm-w@mail.gmail.com>
Message-ID: <CAEBQMMm7MWoFbnDBaWppfFJ1LxWnGRCXuw21vKoqS7WQNmLkDw@mail.gmail.com>

Great stuff to finally see it make it!  Well done to all involved!

On Fri, Jan 13, 2017 at 8:24 AM Matteo Mattiuzzi <matteo at mattiuzzi.com>
wrote:

> Dear list,
>
>
> We would like to announce the release of the MODIS package to CRAN. This
> was finally possible thanks to the constant efforts of Florian Detsch, whom
> I would like to say thank you!
>
>
> Some months ago we decided to move the development from R-Forge to GitHub
> and we are thankful for any contributions in the form of ideas,
> bug-reports, pull requests or whatever helps.
>
>
> GitHub repository: https://github.com/MatMatt/MODIS
>
>
>
> We hope you will enjoy!
>
>
> Kind regards,
>
> Matteo
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From kmccaffrey2011 at my.fit.edu  Fri Jan 13 20:48:58 2017
From: kmccaffrey2011 at my.fit.edu (Kelly McCaffrey)
Date: Fri, 13 Jan 2017 14:48:58 -0500
Subject: [R-sig-Geo] Error reading hdf files with rgdal
Message-ID: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>

Hello all,
I'm working with some .hdf files containing MODIS satellite data, but I
have been unable to read them into R using rgdal and gdalUtils since the
last rgdal update. Has anyone else experienced these issues and does anyone
have a suggested fix? The code I'm attempting to use and error message are
as follows:

library(raster)
library(rgdal)
library(gdalUtils)
file<-"MODWCW_2017010_DAILY_AQUA_CHLORA_EC_1KM.hdf"
sds<-get_subdatasets(file)
Error in split1[[1]] : subscript out of bounds

I've tried this code with .hdf files from different sources, and they
return the same error. I've attempted to download and use an older version
of rgdal as a workaround, but I am having trouble obtaining its software
dependencies and would prefer a fix compatible with the current version of
the package.
Thanks!
Kelly

-- 

*Kelly McCaffrey*
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Fri Jan 13 21:06:05 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 13 Jan 2017 20:06:05 +0000
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
Message-ID: <4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>

Please provide the output of the startup messages from the loaded packages, and of sessionInfo().

Roger Bivand
Norwegian School of Economics
Bergen, Norway

Fra: Kelly McCaffrey
Sendt: fredag 13. januar, 20.51
Emne: [R-sig-Geo] Error reading hdf files with rgdal
Til: R-sig-geo mailing list

Hello all, I'm working with some .hdf files containing MODIS satellite data, but I have been unable to read them into R using rgdal and gdalUtils since the last rgdal update. Has anyone else experienced these issues and does anyone have a suggested fix? The code I'm attempting to use and error message are as follows: library(raster) library(rgdal) library(gdalUtils) file

	[[alternative HTML version deleted]]


From kmccaffrey2011 at my.fit.edu  Fri Jan 13 21:12:12 2017
From: kmccaffrey2011 at my.fit.edu (Kelly McCaffrey)
Date: Fri, 13 Jan 2017 15:12:12 -0500
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
Message-ID: <CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>

Here are the startup messages and the sessionInfo() output:

> library(raster)
Loading required package: sp
> library(rgdal)
rgdal: version: 1.2-5, (SVN revision 648)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
 Path to GDAL shared files:
C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
 Path to PROJ.4 shared files:
C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
 Linking to sp version: 1.2-4
> library(gdalUtils)
> sessionInfo()
R version 3.3.2 (2016-10-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils
[5] datasets  methods   base

other attached packages:
[1] gdalUtils_2.0.1.7 rgdal_1.2-5
[3] raster_2.5-8      sp_1.2-4

loaded via a namespace (and not attached):
 [1] tools_3.3.2       Rcpp_0.12.8
 [3] R.methodsS3_1.7.1 codetools_0.2-15
 [5] grid_3.3.2        iterators_1.0.8
 [7] foreach_1.4.3     R.utils_2.5.0
 [9] R.oo_1.21.0       lattice_0.20-34


Kelly

On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> Please provide the output of the startup messages from the loaded
> packages, and of sessionInfo().
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
> Fra: Kelly McCaffrey
> Sendt: fredag 13. januar, 20.51
> Emne: [R-sig-Geo] Error reading hdf files with rgdal
> Til: R-sig-geo mailing list
>
> Hello all, I'm working with some .hdf files containing MODIS satellite
> data, but I have been unable to read them into R using rgdal and gdalUtils
> since the last rgdal update. Has anyone else experienced these issues and
> does anyone have a suggested fix? The code I'm attempting to use and error
> message are as follows: library(raster) library(rgdal) library(gdalUtils)
> file
>



-- 

*Kelly McCaffrey*
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Sat Jan 14 01:18:45 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 14 Jan 2017 00:18:45 +0000
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
	<CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
Message-ID: <CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>

Try listing the subdatasets and reading them directly with GDAL or readGDAL

On Sat, Jan 14, 2017, 07:12 Kelly McCaffrey <kmccaffrey2011 at my.fit.edu>
wrote:

> Here are the startup messages and the sessionInfo() output:
>
> > library(raster)
> Loading required package: sp
> > library(rgdal)
> rgdal: version: 1.2-5, (SVN revision 648)
>  Geospatial Data Abstraction Library extensions to R successfully loaded
>  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>  Path to GDAL shared files:
> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
>  Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
>  Path to PROJ.4 shared files:
> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
>  Linking to sp version: 1.2-4
> > library(gdalUtils)
> > sessionInfo()
> R version 3.3.2 (2016-10-31)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows >= 8 x64 (build 9200)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils
> [5] datasets  methods   base
>
> other attached packages:
> [1] gdalUtils_2.0.1.7 rgdal_1.2-5
> [3] raster_2.5-8      sp_1.2-4
>
> loaded via a namespace (and not attached):
>  [1] tools_3.3.2       Rcpp_0.12.8
>  [3] R.methodsS3_1.7.1 codetools_0.2-15
>  [5] grid_3.3.2        iterators_1.0.8
>  [7] foreach_1.4.3     R.utils_2.5.0
>  [9] R.oo_1.21.0       lattice_0.20-34
>
>
> Kelly
>
> On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> > Please provide the output of the startup messages from the loaded
> > packages, and of sessionInfo().
> >
> > Roger Bivand
> > Norwegian School of Economics
> > Bergen, Norway
> >
> > Fra: Kelly McCaffrey
> > Sendt: fredag 13. januar, 20.51
> > Emne: [R-sig-Geo] Error reading hdf files with rgdal
> > Til: R-sig-geo mailing list
> >
> > Hello all, I'm working with some .hdf files containing MODIS satellite
> > data, but I have been unable to read them into R using rgdal and
> gdalUtils
> > since the last rgdal update. Has anyone else experienced these issues and
> > does anyone have a suggested fix? The code I'm attempting to use and
> error
> > message are as follows: library(raster) library(rgdal) library(gdalUtils)
> > file
> >
>
>
>
> --
>
> *Kelly McCaffrey*
> Graduate Student
> Department of Biological Sciences
> Florida Institute of Technology
> 150 W. University Blvd.
> Melbourne, FL, 32901
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From zhang_t_y at hotmail.com  Sat Jan 14 13:45:41 2017
From: zhang_t_y at hotmail.com (Zhang Tianyi)
Date: Sat, 14 Jan 2017 12:45:41 +0000
Subject: [R-sig-Geo] Error when I try to interpolate NA for each cell from
	Rasterstack
In-Reply-To: <ae7cce0f-0f6e-5829-c8b7-5035c5242842@uni-muenster.de>
References: <31ac0b1b926f4b5da6b59487dd989a42@ul-exc-pr-mbx14.ulaval.ca>,
	<ae7cce0f-0f6e-5829-c8b7-5035c5242842@uni-muenster.de>
Message-ID: <SG2PR0601MB132807854CD9F28A50E6203FB87B0@SG2PR0601MB1328.apcprd06.prod.outlook.com>

Dear all,

I need to substitute or interpolate the NA in a vector of each cell from a rasterstack data. I have two functions fun_sub for substituting NA and fun_interp for interpolating NA.
I found fun_sub works very well. But fun_interp does not work but I cannot find a reason.
Thank you very much

Tianyi Zhang

Below is a simple example:
#------EXAMPLE
library(timeSeries)
library(raster)
fun_sub <- function(x) {
  # substitute the NA to the mean of vector for each cell
  v=as.vector(x)
  z<-substituteNA(v,type="mean")
  return (z)
}

fun_interp <- function(x) {
  # interpolate the NA to the the linear regression of vector for each cell
  v=as.vector(x)
  z=interpNA(v, method="linear")
  return (z)
}

# create data
r<-raster(ncols=2,nrows=2)
r1<-r; r2<-r; r3<-r; r4<-r
r1[]<-c(1,1,1,2)
r2[]<-c(5,5,NA,5)
r3[]<-c(3,3,4,2)
r4[]<-c(6,5,5,2)
s<-stack(r1,r2,r3,r4)

# try the two functions; the task is change the NA in r2 to a number;
res_sub<-calc(s,fun_sub) # works great! substitute the NA to the mean of c(1,NA,4,5); I got c(1,3.333,4,5)
res_inter<-calc(s,fun_interp) # cannot interpolate; have an error, don't know the reason; I expected it is c(1, 2.5 ,4, 5). But it returns an error

# try whether interpNA() can work or not
interpNA(c(1,NA,4,5),method="linear") # but this function is OK.





	[[alternative HTML version deleted]]


From milujisb at gmail.com  Sat Jan 14 14:02:51 2017
From: milujisb at gmail.com (Miluji Sb)
Date: Sat, 14 Jan 2017 14:02:51 +0100
Subject: [R-sig-Geo] Question on Aggregation
Message-ID: <CAMLwc7P9-vwaQ_dPCFoJ-gt7eH6WYwMkhhmtZ5-XsYbfyg92Og@mail.gmail.com>

I have the following GDP data by longitude and latitude at 0.5 degree by
0.5 degree.

temp <- dput(head(ptsDF,10))
structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
-67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
-54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
-53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
c("longitude",
"latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
82L, 95L, 108L, 121L), class = "data.frame")

I would like to aggregate the data 1 degree by 1 degree. This is what I
have done:

temp$long1 <- floor(temp$longitude)
temp$lat1 <- floor(temp$latitude)
temp1 <- aggregate(GDP ~ long1 + lat1, temp, mean)

I was wondering though if I should be doing using sum instead of mean for
aggregation, as in:

temp <- aggregate(GDP ~ long1 + lat1, temp, sum)

Any advice would be highly appreciated. Thank you!

Sincerely,

Milu

	[[alternative HTML version deleted]]


From jerome.mathieu at upmc.fr  Sat Jan 14 15:52:40 2017
From: jerome.mathieu at upmc.fr (=?UTF-8?Q?J=C3=A9rome_Mathieu?=)
Date: Sat, 14 Jan 2017 15:52:40 +0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgTxgehT42p_pzTXFPnR-WbHiT=KPf74cKTFfJq14kzYFw@mail.gmail.com>
References: <CAE3WKgRxMymdjwcUXCabH9g8q_+v0A3ND9trPwNvkCUniiBQ9g@mail.gmail.com>
	<CA+XavVB8OSiktMhRBFw60iAbucJu4mWHD11FCQkNnZrRCTdv3g@mail.gmail.com>
	<CAE3WKgTxgehT42p_pzTXFPnR-WbHiT=KPf74cKTFfJq14kzYFw@mail.gmail.com>
Message-ID: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>

Hi,

Did you have a look at the package adehabitatLT?

https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf

It deals with trajectories based on points ordered by date.

Jerome


2017-01-13 11:41 GMT+01:00 marta azores <martazores at gmail.com>:

> Thanks for your quick reply to my question,
>
> This ten points are ordered by time (date + time), and I know ,the points
> are all connected.  I didn't include the column with the time in this
> example, to make it simple.
>
> After read your messages, I was looking the minimum spanning tree for the
> vertices.
> The advantage with the function "shortestPath" is that you have as result a
> spatial line output, which I need it.
> However, the minimum spanning tree give as output an ordiplot.
>
> Is it possible to transform the ordiplot into spatialLines?
>
> Thanks for your answers
>
> Marta
>
>
>
> 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org>:
>
> > Generically independent of R, A graph and the connectivity between points
> > needs defined before a shortest path algorithm can be applied.  If it
> > assumes all points are connected, than the shortest path will be a
> straight
> > line.  What you are looking for is some sort of  minimum spanning tree
> for
> > the vertices.
> > Eric
> >
> > On Thu, Jan 12, 2017 at 11:17 AM, marta azores <martazores at gmail.com>
> > wrote:
> >
> >> Dear forum members,
> >>
> >> I would like to know how join several points with the aim to track a
> ship.
> >>
> >> After reading the documentation of some packages, I decided to use the
> >> function shortestPath, but I only got the line between the first and the
> >> last location of my points list. I need the complete survey, including
> also
> >> the middle points. I try a loop to build the survey of the boats using
> >> their locations, but It didn't work to me.
> >>
> >>
> >> Any idea?
> >>
> >> Thanks in advance,
> >>
> >> Marta
> >>
> >> #script# it's also attached in a R.file: question loop2.R
> >> ##########################################################
> >> #
> >> #raster# it's attached
> >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
> >> #
> >> #10 points# it's attached
> >> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
> >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
> >> head(boat)
> >>
> >> #raster to transitionlayer
> >> trCostS4<- transition(1/azoTS1, mean, directions=4)
> >>
> >> # points to spatialpointsdataframe
> >> x=boat$Long1
> >> y=boat$Lat1
> >> coords = cbind(x, y)
> >> plot(coords)
> >> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
> >> +datum=WGS84"), bbox = NULL)
> >> sp
> >> spdf=SpatialPointsDataFrame(sp,boat)
> >> spdf
> >> nrow(spdf)
> >> plot(sp,axes=TRUE)
> >> plot(spdf,add=TRUE, axes=TRUE)
> >>
> >> #shortestpath
> >>
> >> ## 1) this script only join the first point of the list and the last
> one,
> >> and the points in the middle are not used.
> >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
> >> output="SpatialLines")
> >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)
> >>
> >> ## 2) this script didn't work to me
> >>
> >> #first way from website: http://stackoverflow.com/quest
> >> ions/8127066/loop-or-sapply-function-for-multiple-least-
> >> cost-analysis-in-r?answertab=active#tab-top
> >> for(i in 1:nrow(spdf)) {
> >>   # Computation
> >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
> >> output="SpatialLines")
> >>   plot(Costpath)
> >>
> >> }
> >>
> >> #Error in validObject(.Object) :
> >> #invalid class ?SpatialLines? object: bbox should never contain infinite
> >> values
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
J?r?me Mathieu <http://www.jerome-mathieu.com/>
Universit? Pierre & Marie Curie <http://www.upmc.fr/>
Institute of Ecology and Environmental Science (Paris)
<https://ieesparis.ufr918.upmc.fr/>
Team EERI

4 place Jussieu
Tour 44-45, 5th floor, door 514
75005 Paris

tel: 01 44 27 34 22

	[[alternative HTML version deleted]]


From vijaylulla at gmail.com  Sat Jan 14 17:11:31 2017
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Sat, 14 Jan 2017 11:11:31 -0500
Subject: [R-sig-Geo] Error when I try to interpolate NA for each cell
	from Rasterstack
In-Reply-To: <SG2PR0601MB132807854CD9F28A50E6203FB87B0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
References: <31ac0b1b926f4b5da6b59487dd989a42@ul-exc-pr-mbx14.ulaval.ca>
	<ae7cce0f-0f6e-5829-c8b7-5035c5242842@uni-muenster.de>
	<SG2PR0601MB132807854CD9F28A50E6203FB87B0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
Message-ID: <CAKkiGbsCAmATNYunQ1ki6xpXqbe22QSgcddFcudV_Di1A1ssGg@mail.gmail.com>

I think this is because interpNA returns a matrix of one column whereas
raster::setValues (used internally by calc) expects the values to be a
vector of elements.  Changing the last line in `fun_interp` from
`return(z)` to `return(c(z))` might do the trick.

HTH,
Vijay.

On Sat, Jan 14, 2017 at 7:45 AM, Zhang Tianyi <zhang_t_y at hotmail.com> wrote:

> Dear all,
>
> I need to substitute or interpolate the NA in a vector of each cell from a
> rasterstack data. I have two functions fun_sub for substituting NA and
> fun_interp for interpolating NA.
> I found fun_sub works very well. But fun_interp does not work but I cannot
> find a reason.
> Thank you very much
>
> Tianyi Zhang
>
> Below is a simple example:
> #------EXAMPLE
> library(timeSeries)
> library(raster)
> fun_sub <- function(x) {
>   # substitute the NA to the mean of vector for each cell
>   v=as.vector(x)
>   z<-substituteNA(v,type="mean")
>   return (z)
> }
>
> fun_interp <- function(x) {
>   # interpolate the NA to the the linear regression of vector for each cell
>   v=as.vector(x)
>   z=interpNA(v, method="linear")
>   return (z)
> }
>
> # create data
> r<-raster(ncols=2,nrows=2)
> r1<-r; r2<-r; r3<-r; r4<-r
> r1[]<-c(1,1,1,2)
> r2[]<-c(5,5,NA,5)
> r3[]<-c(3,3,4,2)
> r4[]<-c(6,5,5,2)
> s<-stack(r1,r2,r3,r4)
>
> # try the two functions; the task is change the NA in r2 to a number;
> res_sub<-calc(s,fun_sub) # works great! substitute the NA to the mean of
> c(1,NA,4,5); I got c(1,3.333,4,5)
> res_inter<-calc(s,fun_interp) # cannot interpolate; have an error, don't
> know the reason; I expected it is c(1, 2.5 ,4, 5). But it returns an error
>
> # try whether interpNA() can work or not
> interpNA(c(1,NA,4,5),method="linear") # but this function is OK.
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From roland.harhoff at uni-muenster.de  Sat Jan 14 17:21:53 2017
From: roland.harhoff at uni-muenster.de (Roland Harhoff)
Date: Sat, 14 Jan 2017 17:21:53 +0100 (CET)
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
Message-ID: <permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>

Hi Marta,

and did you check the trajectories package ...?

https://cran.r-project.org/web/packages/trajectories/index.html

Cheers!
Roland


J?rome Mathieu schrieb am 2017-01-14:
> Hi,

> Did you have a look at the package adehabitatLT?

> https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf

> It deals with trajectories based on points ordered by date.

> Jerome


> 2017-01-13 11:41 GMT+01:00 marta azores <martazores at gmail.com>:

> > Thanks for your quick reply to my question,
> >
> > This ten points are ordered by time (date + time), and I know ,the points
> > are all connected.  I didn't include the column with the time in this
> > example, to make it simple.
> >
> > After read your messages, I was looking the minimum spanning tree for the
> > vertices.
> > The advantage with the function "shortestPath" is that you have as result a
> > spatial line output, which I need it.
> > However, the minimum spanning tree give as output an ordiplot.
> >
> > Is it possible to transform the ordiplot into spatialLines?
> >
> > Thanks for your answers
> >
> > Marta
> >
> >
> >
> > 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org>:
> >
> > > Generically independent of R, A graph and the connectivity between points
> > > needs defined before a shortest path algorithm can be applied.  If it
> > > assumes all points are connected, than the shortest path will be a
> > straight
> > > line.  What you are looking for is some sort of  minimum spanning tree
> > for
> > > the vertices.
> > > Eric
> > >
> > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores <martazores at gmail.com>
> > > wrote:
> > >
> > >> Dear forum members,
> > >>
> > >> I would like to know how join several points with the aim to track a
> > ship.
> > >>
> > >> After reading the documentation of some packages, I decided to use the
> > >> function shortestPath, but I only got the line between the first and the
> > >> last location of my points list. I need the complete survey, including
> > also
> > >> the middle points. I try a loop to build the survey of the boats using
> > >> their locations, but It didn't work to me.
> > >>
> > >>
> > >> Any idea?
> > >>
> > >> Thanks in advance,
> > >>
> > >> Marta
> > >>
> > >> #script# it's also attached in a R.file: question loop2.R
> > >> ##########################################################
> > >> #
> > >> #raster# it's attached
> > >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
> > >> #
> > >> #10 points# it's attached
> > >> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
> > >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
> > >> head(boat)
> > >>
> > >> #raster to transitionlayer
> > >> trCostS4<- transition(1/azoTS1, mean, directions=4)
> > >>
> > >> # points to spatialpointsdataframe
> > >> x=boat$Long1
> > >> y=boat$Lat1
> > >> coords = cbind(x, y)
> > >> plot(coords)
> > >> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat +ellps=WGS84
> > >> +datum=WGS84"), bbox = NULL)
> > >> sp
> > >> spdf=SpatialPointsDataFrame(sp,boat)
> > >> spdf
> > >> nrow(spdf)
> > >> plot(sp,axes=TRUE)
> > >> plot(spdf,add=TRUE, axes=TRUE)
> > >>
> > >> #shortestpath
> > >>
> > >> ## 1) this script only join the first point of the list and the last
> > one,
> > >> and the points in the middle are not used.
> > >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
> > >> output="SpatialLines")
> > >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's attached)
> > >>
> > >> ## 2) this script didn't work to me
> > >>
> > >> #first way from website: http://stackoverflow.com/quest
> > >> ions/8127066/loop-or-sapply-function-for-multiple-least-
> > >> cost-analysis-in-r?answertab=active#tab-top
> > >> for(i in 1:nrow(spdf)) {
> > >>   # Computation
> > >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
> > >> output="SpatialLines")
> > >>   plot(Costpath)
> > >>
> > >> }
> > >>
> > >> #Error in validObject(.Object) :
> > >> #invalid class ?SpatialLines? object: bbox should never contain infinite
> > >> values
> > >>
> > >> _______________________________________________
> > >> R-sig-Geo mailing list
> > >> R-sig-Geo at r-project.org
> > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >>
> > >
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >



> --
> J?r?me Mathieu <http://www.jerome-mathieu.com/>
> Universit? Pierre & Marie Curie <http://www.upmc.fr/>
> Institute of Ecology and Environmental Science (Paris)
> <https://ieesparis.ufr918.upmc.fr/>
> Team EERI

> 4 place Jussieu
> Tour 44-45, 5th floor, door 514
> 75005 Paris

> tel: 01 44 27 34 22

> 	[[alternative HTML version deleted]]

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.turner at auckland.ac.nz  Sat Jan 14 20:47:57 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sun, 15 Jan 2017 08:47:57 +1300
Subject: [R-sig-Geo] [FORGED] Re: Error when I try to interpolate NA for
 each cell from Rasterstack
In-Reply-To: <CAKkiGbsCAmATNYunQ1ki6xpXqbe22QSgcddFcudV_Di1A1ssGg@mail.gmail.com>
References: <31ac0b1b926f4b5da6b59487dd989a42@ul-exc-pr-mbx14.ulaval.ca>
	<ae7cce0f-0f6e-5829-c8b7-5035c5242842@uni-muenster.de>
	<SG2PR0601MB132807854CD9F28A50E6203FB87B0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
	<CAKkiGbsCAmATNYunQ1ki6xpXqbe22QSgcddFcudV_Di1A1ssGg@mail.gmail.com>
Message-ID: <06ffd77b-5aa8-1d94-9baf-0a1e90a46a0b@auckland.ac.nz>

On 15/01/17 05:11, Vijay Lulla wrote:
> I think this is because interpNA returns a matrix of one column whereas
> raster::setValues (used internally by calc) expects the values to be a
> vector of elements.  Changing the last line in `fun_interp` from
> `return(z)` to `return(c(z))` might do the trick.

<SNIP>

Better to use return(as.vector(z)).  See fortune(185).

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From vijaylulla at gmail.com  Sat Jan 14 20:57:31 2017
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Sat, 14 Jan 2017 14:57:31 -0500
Subject: [R-sig-Geo] [FORGED] Re: Error when I try to interpolate NA for
 each cell from Rasterstack
In-Reply-To: <06ffd77b-5aa8-1d94-9baf-0a1e90a46a0b@auckland.ac.nz>
References: <31ac0b1b926f4b5da6b59487dd989a42@ul-exc-pr-mbx14.ulaval.ca>
	<ae7cce0f-0f6e-5829-c8b7-5035c5242842@uni-muenster.de>
	<SG2PR0601MB132807854CD9F28A50E6203FB87B0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
	<CAKkiGbsCAmATNYunQ1ki6xpXqbe22QSgcddFcudV_Di1A1ssGg@mail.gmail.com>
	<06ffd77b-5aa8-1d94-9baf-0a1e90a46a0b@auckland.ac.nz>
Message-ID: <CAKkiGbvb8=0u2KU-SmBYVjCitXu0qrGgApdp1r1X5N_zPf-3rQ@mail.gmail.com>

Thank you for pointing out my bad practice.  Even `?c` mentions that
as.vector is more intuitive and a safer approach.  I was unaware of the
side-effect nature of `c`!  Enlightening.

Appreciatively,
Vijay.

On Sat, Jan 14, 2017 at 2:47 PM, Rolf Turner <r.turner at auckland.ac.nz>
wrote:

> On 15/01/17 05:11, Vijay Lulla wrote:
>
>> I think this is because interpNA returns a matrix of one column whereas
>> raster::setValues (used internally by calc) expects the values to be a
>> vector of elements.  Changing the last line in `fun_interp` from
>> `return(z)` to `return(c(z))` might do the trick.
>>
>
> <SNIP>
>
> Better to use return(as.vector(z)).  See fortune(185).
>
> cheers,
>
> Rolf Turner
>
> --
> Technical Editor ANZJS
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>

	[[alternative HTML version deleted]]


From loic.dutrieux at conabio.gob.mx  Sun Jan 15 01:44:25 2017
From: loic.dutrieux at conabio.gob.mx (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Sun, 15 Jan 2017 01:44:25 +0100
Subject: [R-sig-Geo] Question on Aggregation
In-Reply-To: <CAMLwc7P9-vwaQ_dPCFoJ-gt7eH6WYwMkhhmtZ5-XsYbfyg92Og@mail.gmail.com>
References: <CAMLwc7P9-vwaQ_dPCFoJ-gt7eH6WYwMkhhmtZ5-XsYbfyg92Og@mail.gmail.com>
Message-ID: <a62d8e7c-ade8-9a8e-bb87-3a5144c67495@conabio.gob.mx>



On 14/01/2017 14:02, Miluji Sb wrote:
> I have the following GDP data by longitude and latitude at 0.5 degree by
> 0.5 degree.
> 
> temp <- dput(head(ptsDF,10))
> structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
> -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
> -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
> -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
> 0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
> c("longitude",
> "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
> 82L, 95L, 108L, 121L), class = "data.frame")
> 
> I would like to aggregate the data 1 degree by 1 degree. This is what I
> have done:
> 
> temp$long1 <- floor(temp$longitude)
> temp$lat1 <- floor(temp$latitude)
> temp1 <- aggregate(GDP ~ long1 + lat1, temp, mean)
> 
> I was wondering though if I should be doing using sum instead of mean for
> aggregation, as in:

I think so. I'm not an expert in GDP but clearly it sounds like a
variable that "adds up" (it represents a quantity) and should therefore
be spatially aggregated with a sum.

Cheers,
Lo?c
> 
> temp <- aggregate(GDP ~ long1 + lat1, temp, sum)
> 
> Any advice would be highly appreciated. Thank you!
> 
> Sincerely,
> 
> Milu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> Email secured by Check Point
>


From kmccaffrey2011 at my.fit.edu  Sun Jan 15 19:16:32 2017
From: kmccaffrey2011 at my.fit.edu (Kelly McCaffrey)
Date: Sun, 15 Jan 2017 13:16:32 -0500
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
	<CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
	<CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>
Message-ID: <CACT55__pi8EXZx_F6VLk6v_V0nf+yKA5Z0tSBoqBzEW1T83+Jg@mail.gmail.com>

Using GDAL and readGDAL both result in the error message:
Error in .local(.Object, ...) :
With no other message following this warning. Trying to use GDALinfo()
results in the same warning. I'm having these problems trying to use .hdf
files I have previously successfully accessed and transformed to geoTIFF
files as well.


On Fri, Jan 13, 2017 at 7:18 PM, Michael Sumner <mdsumner at gmail.com> wrote:

> Try listing the subdatasets and reading them directly with GDAL or readGDAL
>
> On Sat, Jan 14, 2017, 07:12 Kelly McCaffrey <kmccaffrey2011 at my.fit.edu>
> wrote:
>
>> Here are the startup messages and the sessionInfo() output:
>>
>> > library(raster)
>> Loading required package: sp
>> > library(rgdal)
>> rgdal: version: 1.2-5, (SVN revision 648)
>>  Geospatial Data Abstraction Library extensions to R successfully loaded
>>  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>>  Path to GDAL shared files:
>> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
>>  Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
>>  Path to PROJ.4 shared files:
>> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
>>  Linking to sp version: 1.2-4
>> > library(gdalUtils)
>> > sessionInfo()
>> R version 3.3.2 (2016-10-31)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows >= 8 x64 (build 9200)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils
>> [5] datasets  methods   base
>>
>> other attached packages:
>> [1] gdalUtils_2.0.1.7 rgdal_1.2-5
>> [3] raster_2.5-8      sp_1.2-4
>>
>> loaded via a namespace (and not attached):
>>  [1] tools_3.3.2       Rcpp_0.12.8
>>  [3] R.methodsS3_1.7.1 codetools_0.2-15
>>  [5] grid_3.3.2        iterators_1.0.8
>>  [7] foreach_1.4.3     R.utils_2.5.0
>>  [9] R.oo_1.21.0       lattice_0.20-34
>>
>>
>> Kelly
>>
>> On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>
>> > Please provide the output of the startup messages from the loaded
>> > packages, and of sessionInfo().
>> >
>> > Roger Bivand
>> > Norwegian School of Economics
>> > Bergen, Norway
>> >
>> > Fra: Kelly McCaffrey
>> > Sendt: fredag 13. januar, 20.51
>> > Emne: [R-sig-Geo] Error reading hdf files with rgdal
>> > Til: R-sig-geo mailing list
>> >
>> > Hello all, I'm working with some .hdf files containing MODIS satellite
>> > data, but I have been unable to read them into R using rgdal and
>> gdalUtils
>> > since the last rgdal update. Has anyone else experienced these issues
>> and
>> > does anyone have a suggested fix? The code I'm attempting to use and
>> error
>> > message are as follows: library(raster) library(rgdal)
>> library(gdalUtils)
>> > file
>> >
>>
>>
>>
>> --
>>
>> *Kelly McCaffrey*
>> Graduate Student
>> Department of Biological Sciences
>> Florida Institute of Technology
>> 150 W. University Blvd.
>> Melbourne, FL, 32901
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>


-- 

*Kelly McCaffrey*
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Sun Jan 15 19:36:44 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 15 Jan 2017 18:36:44 +0000
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <CACT55__pi8EXZx_F6VLk6v_V0nf+yKA5Z0tSBoqBzEW1T83+Jg@mail.gmail.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
	<CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
	<CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>
	<CACT55__pi8EXZx_F6VLk6v_V0nf+yKA5Z0tSBoqBzEW1T83+Jg@mail.gmail.com>
Message-ID: <4F58C8D16A2DF6F4.c5bd661c-e3d6-40bb-ba32-76da47d9729d@mail.outlook.com>

When you see an error message from the R interpreter, include the full output, and the output of traceback() issued immediately after the error. Nothing important in raster handling has changed in rgdal. Try to provide a reprodicible example that you can show succeeded on the same system with earlier versions of packages, and which now fail. We cannot see over your shoulder.

Roger Bivand
Norwegian School of Economics
Bergen, Norway



On Sun, Jan 15, 2017 at 7:17 PM +0100, "Kelly McCaffrey" <kmccaffrey2011 at my.fit.edu<mailto:kmccaffrey2011 at my.fit.edu>> wrote:

Using GDAL and readGDAL both result in the error message:
Error in .local(.Object, ...) :
With no other message following this warning. Trying to use GDALinfo() results in the same warning. I'm having these problems trying to use .hdf files I have previously successfully accessed and transformed to geoTIFF files as well.


On Fri, Jan 13, 2017 at 7:18 PM, Michael Sumner <mdsumner at gmail.com<mailto:mdsumner at gmail.com>> wrote:

Try listing the subdatasets and reading them directly with GDAL or readGDAL

On Sat, Jan 14, 2017, 07:12 Kelly McCaffrey <kmccaffrey2011 at my.fit.edu<mailto:kmccaffrey2011 at my.fit.edu>> wrote:
Here are the startup messages and the sessionInfo() output:

> library(raster)
Loading required package: sp
> library(rgdal)
rgdal: version: 1.2-5, (SVN revision 648)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
 Path to GDAL shared files:
C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
 Path to PROJ.4 shared files:
C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
 Linking to sp version: 1.2-4
> library(gdalUtils)
> sessionInfo()
R version 3.3.2 (2016-10-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils
[5] datasets  methods   base

other attached packages:
[1] gdalUtils_2.0.1.7 rgdal_1.2-5
[3] raster_2.5-8      sp_1.2-4

loaded via a namespace (and not attached):
 [1] tools_3.3.2       Rcpp_0.12.8
 [3] R.methodsS3_1.7.1 codetools_0.2-15
 [5] grid_3.3.2        iterators_1.0.8
 [7] foreach_1.4.3     R.utils_2.5.0
 [9] R.oo_1.21.0       lattice_0.20-34


Kelly

On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>> wrote:

> Please provide the output of the startup messages from the loaded
> packages, and of sessionInfo().
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
> Fra: Kelly McCaffrey
> Sendt: fredag 13. januar, 20.51
> Emne: [R-sig-Geo] Error reading hdf files with rgdal
> Til: R-sig-geo mailing list
>
> Hello all, I'm working with some .hdf files containing MODIS satellite
> data, but I have been unable to read them into R using rgdal and gdalUtils
> since the last rgdal update. Has anyone else experienced these issues and
> does anyone have a suggested fix? The code I'm attempting to use and error
> message are as follows: library(raster) library(rgdal) library(gdalUtils)
> file
>



--

*Kelly McCaffrey*
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia




--

Kelly McCaffrey
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901


	[[alternative HTML version deleted]]


From mike_jadoo at yahoo.com  Mon Jan 16 00:03:39 2017
From: mike_jadoo at yahoo.com (Mike Jadoo)
Date: Sun, 15 Jan 2017 23:03:39 +0000 (UTC)
Subject: [R-sig-Geo] Answer for Question on Aggregation from Loic
References: <1775820334.3740458.1484521419016.ref@mail.yahoo.com>
Message-ID: <1775820334.3740458.1484521419016@mail.yahoo.com>

Hi everyone,
Just a small advice when it comes to GDP agg in a geospace context.? If you want you aggregate value to match the reported national total make sure that the unit of measure you are working with for GDP is in current dollars. 

 If you a aggregating GDP by either growth rate or real terms this measure might not match the reported aggregate national level.??? I might be wrong but please keep note of this situation. 

Best
Mike 

	[[alternative HTML version deleted]]


From martazores at gmail.com  Mon Jan 16 11:45:00 2017
From: martazores at gmail.com (marta azores)
Date: Mon, 16 Jan 2017 09:45:00 -0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
References: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
	<permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
Message-ID: <CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>

Hi Jerome,

There are several R packages to join points. However, I have two relevant
issues with them.
 -The first,  I need to get the "Lines" from these tracks in "spatial
Lines". For example, in the adehabitatLT package you can get easily the
trajectories of the animal but with the class " ltraj". I don't know
   how transform this object class into spatial lines.
-The second, when I made the tracks I need to avoid the coast, and I don't
know how do that in adehabitatLT.

Any idea?

Thanks for your suggestions,

Marta

2017-01-14 15:21 GMT-01:00 Roland Harhoff <roland.harhoff at uni-muenster.de>:

> Hi Marta,
>
> and did you check the trajectories package ...?
>
> https://cran.r-project.org/web/packages/trajectories/index.html
>
> Cheers!
> Roland
>
>
> J?rome Mathieu schrieb am 2017-01-14:
> > Hi,
>
> > Did you have a look at the package adehabitatLT?
>
> > https://cran.r-project.org/web/packages/adehabitatLT/
> vignettes/adehabitatLT.pdf
>
> > It deals with trajectories based on points ordered by date.
>
> > Jerome
>
>
> > 2017-01-13 11:41 GMT+01:00 marta azores <martazores at gmail.com>:
>
> > > Thanks for your quick reply to my question,
> > >
> > > This ten points are ordered by time (date + time), and I know ,the
> points
> > > are all connected.  I didn't include the column with the time in this
> > > example, to make it simple.
> > >
> > > After read your messages, I was looking the minimum spanning tree for
> the
> > > vertices.
> > > The advantage with the function "shortestPath" is that you have as
> result a
> > > spatial line output, which I need it.
> > > However, the minimum spanning tree give as output an ordiplot.
> > >
> > > Is it possible to transform the ordiplot into spatialLines?
> > >
> > > Thanks for your answers
> > >
> > > Marta
> > >
> > >
> > >
> > > 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org>:
> > >
> > > > Generically independent of R, A graph and the connectivity between
> points
> > > > needs defined before a shortest path algorithm can be applied.  If it
> > > > assumes all points are connected, than the shortest path will be a
> > > straight
> > > > line.  What you are looking for is some sort of  minimum spanning
> tree
> > > for
> > > > the vertices.
> > > > Eric
> > > >
> > > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores <martazores at gmail.com
> >
> > > > wrote:
> > > >
> > > >> Dear forum members,
> > > >>
> > > >> I would like to know how join several points with the aim to track a
> > > ship.
> > > >>
> > > >> After reading the documentation of some packages, I decided to use
> the
> > > >> function shortestPath, but I only got the line between the first
> and the
> > > >> last location of my points list. I need the complete survey,
> including
> > > also
> > > >> the middle points. I try a loop to build the survey of the boats
> using
> > > >> their locations, but It didn't work to me.
> > > >>
> > > >>
> > > >> Any idea?
> > > >>
> > > >> Thanks in advance,
> > > >>
> > > >> Marta
> > > >>
> > > >> #script# it's also attached in a R.file: question loop2.R
> > > >> ##########################################################
> > > >> #
> > > >> #raster# it's attached
> > > >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
> > > >> #
> > > >> #10 points# it's attached
> > > >> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
> > > >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
> > > >> head(boat)
> > > >>
> > > >> #raster to transitionlayer
> > > >> trCostS4<- transition(1/azoTS1, mean, directions=4)
> > > >>
> > > >> # points to spatialpointsdataframe
> > > >> x=boat$Long1
> > > >> y=boat$Lat1
> > > >> coords = cbind(x, y)
> > > >> plot(coords)
> > > >> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat
> +ellps=WGS84
> > > >> +datum=WGS84"), bbox = NULL)
> > > >> sp
> > > >> spdf=SpatialPointsDataFrame(sp,boat)
> > > >> spdf
> > > >> nrow(spdf)
> > > >> plot(sp,axes=TRUE)
> > > >> plot(spdf,add=TRUE, axes=TRUE)
> > > >>
> > > >> #shortestpath
> > > >>
> > > >> ## 1) this script only join the first point of the list and the last
> > > one,
> > > >> and the points in the middle are not used.
> > > >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
> > > >> output="SpatialLines")
> > > >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's
> attached)
> > > >>
> > > >> ## 2) this script didn't work to me
> > > >>
> > > >> #first way from website: http://stackoverflow.com/quest
> > > >> ions/8127066/loop-or-sapply-function-for-multiple-least-
> > > >> cost-analysis-in-r?answertab=active#tab-top
> > > >> for(i in 1:nrow(spdf)) {
> > > >>   # Computation
> > > >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
> > > >> output="SpatialLines")
> > > >>   plot(Costpath)
> > > >>
> > > >> }
> > > >>
> > > >> #Error in validObject(.Object) :
> > > >> #invalid class ?SpatialLines? object: bbox should never contain
> infinite
> > > >> values
> > > >>
> > > >> _______________________________________________
> > > >> R-sig-Geo mailing list
> > > >> R-sig-Geo at r-project.org
> > > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >>
> > > >
> > > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
>
>
>
> > --
> > J?r?me Mathieu <http://www.jerome-mathieu.com/>
> > Universit? Pierre & Marie Curie <http://www.upmc.fr/>
> > Institute of Ecology and Environmental Science (Paris)
> > <https://ieesparis.ufr918.upmc.fr/>
> > Team EERI
>
> > 4 place Jussieu
> > Tour 44-45, 5th floor, door 514
> > 75005 Paris
>
> > tel: 01 44 27 34 22
>
> >       [[alternative HTML version deleted]]
>
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From dosc3612 at colorado.edu  Mon Jan 16 14:18:21 2017
From: dosc3612 at colorado.edu (Dominik Schneider)
Date: Mon, 16 Jan 2017 14:18:21 +0100
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <4F58C8D16A2DF6F4.c5bd661c-e3d6-40bb-ba32-76da47d9729d@mail.outlook.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
	<CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
	<CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>
	<CACT55__pi8EXZx_F6VLk6v_V0nf+yKA5Z0tSBoqBzEW1T83+Jg@mail.gmail.com>
	<4F58C8D16A2DF6F4.c5bd661c-e3d6-40bb-ba32-76da47d9729d@mail.outlook.com>
Message-ID: <CAF1jk_mOWjBCs2F4YDGq+VUsJXcz+GN9MUEA37gSo9DEy1Gcdg@mail.gmail.com>

Just to cover all the bases, MODIS hdf files require the hdf4 library. If
you changed something with your GDAL install you might not have this
anymore.

at the commandline prompt, gdalinfo --format HDF4 should give the following
Khione:~ $ gdalinfo --format HDF4
Format Details:
  Short Name: HDF4
  Long Name: Hierarchical Data Format Release 4
  Supports: Raster
  Extension: hdf
  Help Topic: frmt_hdf4.html
  Supports: Subdatasets
  Supports: Open() - Open existing dataset.

Dominik

On Sun, Jan 15, 2017 at 7:36 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> When you see an error message from the R interpreter, include the full
> output, and the output of traceback() issued immediately after the error.
> Nothing important in raster handling has changed in rgdal. Try to provide a
> reprodicible example that you can show succeeded on the same system with
> earlier versions of packages, and which now fail. We cannot see over your
> shoulder.
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
>
>
> On Sun, Jan 15, 2017 at 7:17 PM +0100, "Kelly McCaffrey" <
> kmccaffrey2011 at my.fit.edu<mailto:kmccaffrey2011 at my.fit.edu>> wrote:
>
> Using GDAL and readGDAL both result in the error message:
> Error in .local(.Object, ...) :
> With no other message following this warning. Trying to use GDALinfo()
> results in the same warning. I'm having these problems trying to use .hdf
> files I have previously successfully accessed and transformed to geoTIFF
> files as well.
>
>
> On Fri, Jan 13, 2017 at 7:18 PM, Michael Sumner <mdsumner at gmail.com
> <mailto:mdsumner at gmail.com>> wrote:
>
> Try listing the subdatasets and reading them directly with GDAL or readGDAL
>
> On Sat, Jan 14, 2017, 07:12 Kelly McCaffrey <kmccaffrey2011 at my.fit.edu<
> mailto:kmccaffrey2011 at my.fit.edu>> wrote:
> Here are the startup messages and the sessionInfo() output:
>
> > library(raster)
> Loading required package: sp
> > library(rgdal)
> rgdal: version: 1.2-5, (SVN revision 648)
>  Geospatial Data Abstraction Library extensions to R successfully loaded
>  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>  Path to GDAL shared files:
> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
>  Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
>  Path to PROJ.4 shared files:
> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
>  Linking to sp version: 1.2-4
> > library(gdalUtils)
> > sessionInfo()
> R version 3.3.2 (2016-10-31)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows >= 8 x64 (build 9200)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils
> [5] datasets  methods   base
>
> other attached packages:
> [1] gdalUtils_2.0.1.7 rgdal_1.2-5
> [3] raster_2.5-8      sp_1.2-4
>
> loaded via a namespace (and not attached):
>  [1] tools_3.3.2       Rcpp_0.12.8
>  [3] R.methodsS3_1.7.1 codetools_0.2-15
>  [5] grid_3.3.2        iterators_1.0.8
>  [7] foreach_1.4.3     R.utils_2.5.0
>  [9] R.oo_1.21.0       lattice_0.20-34
>
>
> Kelly
>
> On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no<mailto:
> Roger.Bivand at nhh.no>> wrote:
>
> > Please provide the output of the startup messages from the loaded
> > packages, and of sessionInfo().
> >
> > Roger Bivand
> > Norwegian School of Economics
> > Bergen, Norway
> >
> > Fra: Kelly McCaffrey
> > Sendt: fredag 13. januar, 20.51
> > Emne: [R-sig-Geo] Error reading hdf files with rgdal
> > Til: R-sig-geo mailing list
> >
> > Hello all, I'm working with some .hdf files containing MODIS satellite
> > data, but I have been unable to read them into R using rgdal and
> gdalUtils
> > since the last rgdal update. Has anyone else experienced these issues and
> > does anyone have a suggested fix? The code I'm attempting to use and
> error
> > message are as follows: library(raster) library(rgdal) library(gdalUtils)
> > file
> >
>
>
>
> --
>
> *Kelly McCaffrey*
> Graduate Student
> Department of Biological Sciences
> Florida Institute of Technology
> 150 W. University Blvd.
> Melbourne, FL, 32901
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>
>
>
> --
>
> Kelly McCaffrey
> Graduate Student
> Department of Biological Sciences
> Florida Institute of Technology
> 150 W. University Blvd.
> Melbourne, FL, 32901
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From kmccaffrey2011 at my.fit.edu  Mon Jan 16 15:39:13 2017
From: kmccaffrey2011 at my.fit.edu (Kelly McCaffrey)
Date: Mon, 16 Jan 2017 09:39:13 -0500
Subject: [R-sig-Geo] Error reading hdf files with rgdal
In-Reply-To: <CAF1jk_mOWjBCs2F4YDGq+VUsJXcz+GN9MUEA37gSo9DEy1Gcdg@mail.gmail.com>
References: <CACT55_-YXPdRzo4zGzbpZ4oocGwEXTVFs9aP5Tj3P_eoavs0BQ@mail.gmail.com>
	<4F58C8D16A2DF6F4.b569b295-3962-4ba8-a617-0935c03c15e1@mail.outlook.com>
	<CACT55__p=dKO1MY2AovcunGjgUxFLaUGCom4D6-w1eWKD-d4OQ@mail.gmail.com>
	<CAAcGz9_q5DbcB5drZyr9Sawx-=qAoJSeUABLTxg3j2J=qPYhAQ@mail.gmail.com>
	<CACT55__pi8EXZx_F6VLk6v_V0nf+yKA5Z0tSBoqBzEW1T83+Jg@mail.gmail.com>
	<4F58C8D16A2DF6F4.c5bd661c-e3d6-40bb-ba32-76da47d9729d@mail.outlook.com>
	<CAF1jk_mOWjBCs2F4YDGq+VUsJXcz+GN9MUEA37gSo9DEy1Gcdg@mail.gmail.com>
Message-ID: <CACT55___62Mj9xm25oEM0PBdcdTZS+SbTXvzVuB_j4HL1C0CSA@mail.gmail.com>

Thank you all! It seems to have been the GDAL installation on my system, as
Dominik suggested.
Best,
Kelly

On Mon, Jan 16, 2017 at 8:18 AM, Dominik Schneider <dosc3612 at colorado.edu>
wrote:

> Just to cover all the bases, MODIS hdf files require the hdf4 library. If
> you changed something with your GDAL install you might not have this
> anymore.
>
> at the commandline prompt, gdalinfo --format HDF4 should give the following
> Khione:~ $ gdalinfo --format HDF4
> Format Details:
>   Short Name: HDF4
>   Long Name: Hierarchical Data Format Release 4
>   Supports: Raster
>   Extension: hdf
>   Help Topic: frmt_hdf4.html
>   Supports: Subdatasets
>   Supports: Open() - Open existing dataset.
>
> Dominik
>
> On Sun, Jan 15, 2017 at 7:36 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> When you see an error message from the R interpreter, include the full
>> output, and the output of traceback() issued immediately after the error.
>> Nothing important in raster handling has changed in rgdal. Try to provide a
>> reprodicible example that you can show succeeded on the same system with
>> earlier versions of packages, and which now fail. We cannot see over your
>> shoulder.
>>
>> Roger Bivand
>> Norwegian School of Economics
>> Bergen, Norway
>>
>>
>>
>> On Sun, Jan 15, 2017 at 7:17 PM +0100, "Kelly McCaffrey" <
>> kmccaffrey2011 at my.fit.edu<mailto:kmccaffrey2011 at my.fit.edu>> wrote:
>>
>> Using GDAL and readGDAL both result in the error message:
>> Error in .local(.Object, ...) :
>> With no other message following this warning. Trying to use GDALinfo()
>> results in the same warning. I'm having these problems trying to use .hdf
>> files I have previously successfully accessed and transformed to geoTIFF
>> files as well.
>>
>>
>> On Fri, Jan 13, 2017 at 7:18 PM, Michael Sumner <mdsumner at gmail.com
>> <mailto:mdsumner at gmail.com>> wrote:
>>
>> Try listing the subdatasets and reading them directly with GDAL or
>> readGDAL
>>
>> On Sat, Jan 14, 2017, 07:12 Kelly McCaffrey <kmccaffrey2011 at my.fit.edu
>> <mailto:kmccaffrey2011 at my.fit.edu>> wrote:
>> Here are the startup messages and the sessionInfo() output:
>>
>> > library(raster)
>> Loading required package: sp
>> > library(rgdal)
>> rgdal: version: 1.2-5, (SVN revision 648)
>>  Geospatial Data Abstraction Library extensions to R successfully loaded
>>  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>>  Path to GDAL shared files:
>> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/gdal
>>  Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
>>  Path to PROJ.4 shared files:
>> C:/Users/kmccaffrey2011/Documents/R/win-library/3.3/rgdal/proj
>>  Linking to sp version: 1.2-4
>> > library(gdalUtils)
>> > sessionInfo()
>> R version 3.3.2 (2016-10-31)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows >= 8 x64 (build 9200)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils
>> [5] datasets  methods   base
>>
>> other attached packages:
>> [1] gdalUtils_2.0.1.7 rgdal_1.2-5
>> [3] raster_2.5-8      sp_1.2-4
>>
>> loaded via a namespace (and not attached):
>>  [1] tools_3.3.2       Rcpp_0.12.8
>>  [3] R.methodsS3_1.7.1 codetools_0.2-15
>>  [5] grid_3.3.2        iterators_1.0.8
>>  [7] foreach_1.4.3     R.utils_2.5.0
>>  [9] R.oo_1.21.0       lattice_0.20-34
>>
>>
>> Kelly
>>
>> On Fri, Jan 13, 2017 at 3:06 PM, Roger Bivand <Roger.Bivand at nhh.no
>> <mailto:Roger.Bivand at nhh.no>> wrote:
>>
>> > Please provide the output of the startup messages from the loaded
>> > packages, and of sessionInfo().
>> >
>> > Roger Bivand
>> > Norwegian School of Economics
>> > Bergen, Norway
>> >
>> > Fra: Kelly McCaffrey
>> > Sendt: fredag 13. januar, 20.51
>> > Emne: [R-sig-Geo] Error reading hdf files with rgdal
>> > Til: R-sig-geo mailing list
>> >
>> > Hello all, I'm working with some .hdf files containing MODIS satellite
>> > data, but I have been unable to read them into R using rgdal and
>> gdalUtils
>> > since the last rgdal update. Has anyone else experienced these issues
>> and
>> > does anyone have a suggested fix? The code I'm attempting to use and
>> error
>> > message are as follows: library(raster) library(rgdal)
>> library(gdalUtils)
>> > file
>> >
>>
>>
>>
>> --
>>
>> *Kelly McCaffrey*
>> Graduate Student
>> Department of Biological Sciences
>> Florida Institute of Technology
>> 150 W. University Blvd.
>> Melbourne, FL, 32901
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>>
>>
>>
>> --
>>
>> Kelly McCaffrey
>> Graduate Student
>> Department of Biological Sciences
>> Florida Institute of Technology
>> 150 W. University Blvd.
>> Melbourne, FL, 32901
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


-- 

*Kelly McCaffrey*
Graduate Student
Department of Biological Sciences
Florida Institute of Technology
150 W. University Blvd.
Melbourne, FL, 32901

	[[alternative HTML version deleted]]


From s.menichetti at arpat.toscana.it  Tue Jan 17 09:22:11 2017
From: s.menichetti at arpat.toscana.it (Stefano Menichetti)
Date: Tue, 17 Jan 2017 09:22:11 +0100
Subject: [R-sig-Geo] Moran Index n ape and spdep package
Message-ID: <d83da5c6-9284-76fd-575e-ce4c2bacb3e1@arpat.toscana.it>

Good morning at all, I'm new on R and also I'm not so practical with 
spatial analysis by Moran index. So, I've some practice in kriging to 
interpolate adn before to judge by variogram effective spatial 
autocorrelation of my actual data resolution.
Recently I've discover Moran index that give me, it seems, a sound 
statistical judgment about effective autocorrelation and perhaps spatial 
continuity.

I've used "ape" package to perform a Moran evaluation by simple weight  
by inverse distance
library("ape")
View(myData) (X, Y, Z attribute of pollutant concentration)
myData.dists <- as.matrix(dist(cbind(myData$X,myData$Y)))
myData.dists.inv <- 1/myData.dists
diag(myData.dists.inv) <- 0
Moran.I(myData$PCE,myData.dists.inv)

Forgive my difficulties but I can not play a similar syntax with 
"spdep". Example are not clear for me.

Can you show me an example ?

Thank you very much in advance

Stefano





-- 
Dott. Geol. Stefano Menichetti
=============================================================
ARPAT - Agenzia per la Protezione dell'Ambiente della Toscana
Settore Tecnico SIRA - Sistema Informativo Regionale Ambientale via Nicola Porpora 22 - 50144 Firenze
tel. 0553206333 cell. 3383550147 fax 0553206410
s.menichetti at arpat.toscana.it http:\\www.arpat.toscana.it http:\\sira.arpat.toscana.it


From Roger.Bivand at nhh.no  Tue Jan 17 14:39:39 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 17 Jan 2017 14:39:39 +0100
Subject: [R-sig-Geo] Moran Index n ape and spdep package
In-Reply-To: <d83da5c6-9284-76fd-575e-ce4c2bacb3e1@arpat.toscana.it>
References: <d83da5c6-9284-76fd-575e-ce4c2bacb3e1@arpat.toscana.it>
Message-ID: <alpine.LFD.2.20.1701171416110.12776@reclus.nhh.no>

On Tue, 17 Jan 2017, Stefano Menichetti wrote:

> Good morning at all, I'm new on R and also I'm not so practical with spatial 
> analysis by Moran index. So, I've some practice in kriging to interpolate adn 
> before to judge by variogram effective spatial autocorrelation of my actual 
> data resolution.
> Recently I've discover Moran index that give me, it seems, a sound 
> statistical judgment about effective autocorrelation and perhaps spatial 
> continuity.
>
> I've used "ape" package to perform a Moran evaluation by simple weight  by 
> inverse distance
> library("ape")
> View(myData) (X, Y, Z attribute of pollutant concentration)
> myData.dists <- as.matrix(dist(cbind(myData$X,myData$Y)))
> myData.dists.inv <- 1/myData.dists
> diag(myData.dists.inv) <- 0
> Moran.I(myData$PCE,myData.dists.inv)
>
> Forgive my difficulties but I can not play a similar syntax with "spdep". 
> Example are not clear for me.
>
> Can you show me an example ?

library(sp)
data(meuse)
myData.dists <- as.matrix(dist(cbind(meuse$x, meuse$y)))
myData.dists.inv <- 1/myData.dists
diag(myData.dists.inv) <- 0
library("ape")
Moran.I(meuse$zinc, myData.dists.inv)

This is what you had already, and spdep can do the same, but in a much 
more flexible way, where the user has control of what is happening.

library(spdep)
nb_inf <- dnearneigh(cbind(meuse$x, meuse$y), 0, 10000)
nb_inf # dense
dists_inf <- nbdists(nb_inf, cbind(meuse$x, meuse$y))
dists_inf_inv <- lapply(dists_inf, function(x) 1/x)
lw <- nb2listw(nb_inf, glist=dists_inf_inv, style="B")
Mlw <- listw2mat(lw)
all.equal(Mlw, myData.dists.inv, check.attributes=FALSE)
Moran.I(meuse$zinc, myData.dists.inv)
Moran.I(meuse$zinc, Mlw)
moran.test(meuse$zinc, lw)

# not the same, ape::Moran.I converts to style="W" - row-standardising the 
# weights - internally and transparently

spdepI <- moran.test(meuse$zinc, nb2listw(nb_inf, glist=dists_inf_inv,
  style="W"))
apeI1 <- Moran.I(meuse$zinc, Mlw)
apeI0 <- Moran.I(meuse$zinc, myData.dists.inv)
all.equal(unname(spdepI$estimate[1]), unname(apeI0$observed))
all.equal(unname(spdepI$estimate[1]), unname(apeI1$observed))
all.equal(unname(spdepI$statistic),
  unname((apeI0$observed-apeI0$expected)/apeI0$sd))

# note that spdep::moran.test and ape::Moran.I have different defaults for 
# alternative, and that ape::Moran.I implements the randomisation variance 
# without stating that it does this

All now the same. But:

nb_tri <- tri2nb(cbind(meuse$x, meuse$y))
nb_tri # sparse
dists_tri <- nbdists(nb_tri, cbind(meuse$x, meuse$y))
dists_tri_inv <- lapply(dists_tri, function(x) 1/x)
moran.test(meuse$zinc, nb2listw(nb_tri, glist=dists_tri_inv, style="W"))

See vignette("nb") for different ways of finding neighbours. Sparse 
weights are always to be preferred over dense, because the covariance 
matrix of the observations becomes dense by inversion when spatial 
autocorrelation is present.

Moran's I can always be fooled by a wrong mean model (Moran.I and 
moran.test use the mean of the variable of interest). If there is a 
spatial trend in otherwise uncorrelated data, and the trend is not 
included in the mean model, the measure will find spurious 
autocorrelation.

Hope this clarifies,

Roger

>
> Thank you very much in advance
>
> Stefano
>
>
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From aurelie.tschopp at vetsuisse.unibe.ch  Tue Jan 17 17:44:53 2017
From: aurelie.tschopp at vetsuisse.unibe.ch (aurelie.tschopp at vetsuisse.unibe.ch)
Date: Tue, 17 Jan 2017 16:44:53 +0000
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
Message-ID: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>

Dear all,

I am analysing GPS Data from Chad. I need to first project the latitude and longitudes. I use the package Proj4, the function project for this.  
I have 2 devices and with the data of the 1st device, the projection worked perfectly. But with the data from the other device, I got this error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded limits"

I found that Chad was UTM 33P (Wikipedia UTM: https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system ), but some people could use the notification 33N: 33 for the zone and N for the North hemisphere. 

My code is: 
loc <- dat[,c("Longitude","Latitude")
loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")

Does anybody know where my problem could be?
Thank you
Aur?lie


From johnwasige at gmail.com  Tue Jan 17 17:46:56 2017
From: johnwasige at gmail.com (John Wasige)
Date: Tue, 17 Jan 2017 19:46:56 +0300
Subject: [R-sig-Geo] covert raster to SOS in days of the month
Message-ID: <CAJgdCD7FdMngLtWDwxnErYA+-vqnQ1BVuTqRo09SSQME9cZH2g@mail.gmail.com>

Dear all,
This is to kindly request for your guidance. I have a raster data (see data
structure below) of start of season (SOS) with pixel valves ranging from 0
- 365.

class       : RasterLayer
dimensions  : 868, 995, 863660  (nrow, ncol, ncell)
resolution  : 0.08321608, 0.08321608  (x, y)
extent      : -25.4, 57.4, -34.8, 37.43156  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : D:\NASA_Maryland\Mobile_testdata\SOS1DOY_mean2.tif
names       : SOS1DOY_mean2
values      : 0, 365  (min, max)

?

?I would like to label or change pixel values of the raster to actual data
of the month and get new raster of SOS in days of the month. See the attach
*.csv? file.

Any suggestions on how I can go a head to covert raster to SOS in days of
the month.

Thanks for your help

Rgds

John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170117/303117a7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Label_raster.csv
Type: text/csv
Size: 5384 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170117/303117a7/attachment.bin>

From Roger.Bivand at nhh.no  Tue Jan 17 19:50:00 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 17 Jan 2017 19:50:00 +0100
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
Message-ID: <alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>

On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:

> Dear all,
>
> I am analysing GPS Data from Chad. I need to first project the latitude 
> and longitudes. I use the package Proj4, the function project for this.
> I have 2 devices and with the data of the 1st device, the projection 
> worked perfectly. But with the data from the other device, I got this 
> error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84 
> +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded 
> limits"
>
> I found that Chad was UTM 33P (Wikipedia UTM: 
> https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system 
> ), but some people could use the notification 33N: 33 for the zone and N 
> for the North hemisphere.
>
> My code is:
> loc <- dat[,c("Longitude","Latitude")
> loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 
> +units=m +no_defs")
>
> Does anybody know where my problem could be?

Well, the error message is coming from inside the proj.4 library: did you 
look at the input object? If one device was returning decimal geographical 
coordinates and the other a string with degrees, minutes and seconds in 
one "number":

library(rgdal)
project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")
project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")

In this setting I get:

> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 
+ellps=WGS84")
          [,1]    [,2]
[1,] 930334.7 1662218
> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 
+ellps=WGS84")
      [,1] [,2]
[1,]  Inf  Inf
Warning message:
In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33 
+ellps=WGS84") :
   1 projected point(s) not finite

but not your error. I suspect that the matrix you are passing contains 
non-geographical coordinates. If you are using the proj4 package (odd 
choice but there you are):

> library(proj4)
> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 
+ellps=WGS84")
          [,1]    [,2]
[1,] 930334.7 1662218
> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 
+ellps=WGS84")
Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33 
+ellps=WGS84") :
   latitude or longitude exceeded limits

confirming that it doesn't handle exceptions other than by a hard fail.

Roger


> Thank you
> Aur?lie
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412

From gbl1 at hi.is  Tue Jan 17 20:32:49 2017
From: gbl1 at hi.is (Gilles Benjamin Leduc)
Date: Tue, 17 Jan 2017 19:32:49 +0000
Subject: [R-sig-Geo]
 =?utf-8?q?=3F=3D=3D=3Futf-8=3Fq=3F__Proj4_-_latitude_?=
 =?utf-8?q?or_longitude_exceeded_limits?=
In-Reply-To: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
Message-ID: <79d-587e7180-3-3d482e00@251974013>

 
 Hi, 

So, if I understand you need to manage GPS coordinate and projected data. I had few issues the first time I faced such data. Are you sure that your projected data use an UTM system or a specific system? 
I think that "loc <- dat[,c("Longitude","Latitude")" is GPS system. Is the other a shapefile? 

What I did: 

I had such a dataset: 

 pointsGPS
           [,1]     [,2]
 [1,] -18.30896 63.45118
 [2,] -20.35166 63.60880
 [3,] -17.86225 63.64588
 [4,] -19.05010 63.40444
 [5,] -17.29260 63.84592
 [6,] -19.41010 63.46001
 [7,] -20.61661 63.71676
 [8,] -20.26965 63.44854
 [9,] -20.27939 63.40519
[10,] -21.37864 63.86440
[11,] -20.59592 63.29990
[12,] -20.59403 63.30314
[13,] -20.59867 63.29820
[14,] -20.60931 63.29921
[15,] -20.60914 63.30391
[16,] -20.59884 63.30877
[17,] -22.02663 64.15252

I made of them a compatible class:

SpatialPoints(pointsGPS)-> pointsGPS  

Then I added the CRS:

 proj4string(pointsGPS) <- CRS(" +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 ")  

Then I projected them: 

PointsISN <- spTransform(pointsGPS, CRS("+proj=lcc +lat_1=64.25 +lat_2=65.75 +lat_0=65 +lon_0=-19 +x_0=500000 +y_0=500000 +ellps=GRS80 +units=m +no_defs ")) 

I had issues to find the CRS to project in, there was a command to obtain the CRS of the shapefile, I think it was  proj4string() but i'm not that sure, I haven't done it for a while.

Good luck, hoping it helps.

Benjamin 


 
Le Mardi 17 Janvier 2017 16:44 GMT, <aurelie.tschopp at vetsuisse.unibe.ch> a ?crit: 
 
> Dear all,
> 
> I am analysing GPS Data from Chad. I need to first project the latitude and longitudes. I use the package Proj4, the function project for this.  I have 2 devices and with the data of the 1st device, the projection worked perfectly. But with the data from the other device, I got this error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded limits"
> 
> I found that Chad was UTM 33P (Wikipedia UTM: https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system ), but some people could use the notification 33N: 33 for the zone and N for the North hemisphere. 
> My code is: loc <- dat[,c("Longitude","Latitude")
> loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
> 
> Does anybody know where my problem could be?
> Thank you
> Aur?lie
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Tue Jan 17 21:48:17 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 17 Jan 2017 20:48:17 +0000
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
	<alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
Message-ID: <CAAcGz98iHPPK6g1RjLYgfJ7NgUiwHACjuoWJhY+VB7kYiz33iw@mail.gmail.com>

Watch out with proj4 btw, it has an obscure bug where a 2 row matrix input
is transposed, mixing longitude and latitude in a way that triggers an out
of bounds error for latitude, only when the mixed abs(longitude) is greater
than 90.

Use the sf package, or rgdal, or mapproj.

Cheers, Mike

On Wed, Jan 18, 2017, 05:51 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:
>
> > Dear all,
> >
> > I am analysing GPS Data from Chad. I need to first project the latitude
> > and longitudes. I use the package Proj4, the function project for this.
> > I have 2 devices and with the data of the 1st device, the projection
> > worked perfectly. But with the data from the other device, I got this
> > error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84
> > +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded
> > limits"
> >
> > I found that Chad was UTM 33P (Wikipedia UTM:
> >
> https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
> > ), but some people could use the notification 33N: 33 for the zone and N
> > for the North hemisphere.
> >
> > My code is:
> > loc <- dat[,c("Longitude","Latitude")
> > loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84
> > +units=m +no_defs")
> >
> > Does anybody know where my problem could be?
>
> Well, the error message is coming from inside the proj.4 library: did you
> look at the input object? If one device was returning decimal geographical
> coordinates and the other a string with degrees, minutes and seconds in
> one "number":
>
> library(rgdal)
> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")
> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")
>
> In this setting I get:
>
> > project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
>           [,1]    [,2]
> [1,] 930334.7 1662218
> > project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
>       [,1] [,2]
> [1,]  Inf  Inf
> Warning message:
> In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
> +ellps=WGS84") :
>    1 projected point(s) not finite
>
> but not your error. I suspect that the matrix you are passing contains
> non-geographical coordinates. If you are using the proj4 package (odd
> choice but there you are):
>
> > library(proj4)
> > project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
>           [,1]    [,2]
> [1,] 930334.7 1662218
> > project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
> Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
> +ellps=WGS84") :
>    latitude or longitude exceeded limits
>
> confirming that it doesn't handle exceptions other than by a hard fail.
>
> Roger
>
>
> > Thank you
> > Aur?lie
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> http://depsy.org/person/434412
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> University of Tasmania Electronic Communications Policy (December, 2014).
> This email is confidential, and is for the intended recipient only.
> Access, disclosure, copying, distribution, or reliance on any of it by
> anyone outside the intended recipient organisation is prohibited and may be
> a criminal offence. Please delete if obtained in error and email
> confirmation to the sender. The views expressed in this email are not
> necessarily the views of the University of Tasmania, unless clearly
> intended otherwise.
> .
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jan 18 10:17:07 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 Jan 2017 10:17:07 +0100
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <CAAcGz98iHPPK6g1RjLYgfJ7NgUiwHACjuoWJhY+VB7kYiz33iw@mail.gmail.com>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
	<alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
	<CAAcGz98iHPPK6g1RjLYgfJ7NgUiwHACjuoWJhY+VB7kYiz33iw@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1701181011040.32198@reclus.nhh.no>

On Tue, 17 Jan 2017, Michael Sumner wrote:

> Watch out with proj4 btw, it has an obscure bug where a 2 row matrix input
> is transposed, mixing longitude and latitude in a way that triggers an out
> of bounds error for latitude, only when the mixed abs(longitude) is greater
> than 90.

You mean:

> library(rgdal)
> crds <- rbind(c(90, 1), c(91, 2))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
          [,1]     [,2]
[1,] 833927.9 110682.8
[2,] 945193.9 221604.0
> crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
           [,1]     [,2]
[1,]  833927.9 110682.8
[2,]  945193.9 221604.0
[3,] 1056324.8 332866.1
> crds <- matrix(c(91, 2), nrow=1)
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
          [,1]   [,2]
[1,] 945193.9 221604

and

> library(proj4)
> crds <- rbind(c(90, 1), c(91, 2))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
   latitude or longitude exceeded limits
> crds <- rbind(c(90, 1), c(90, 2))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
> crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
           [,1]     [,2]
[1,]  833927.9 110682.8
[2,]  945193.9 221604.0
[3,] 1056324.8 332866.1
> crds <- matrix(c(91, 2), nrow=1)
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
          [,1]   [,2]
[1,] 945193.9 221604

right?

I'll take a look and if I see the bug, send a patch to Simon. Please 
confirm that this is what you see.

Best wishes,

Roger

>
> Use the sf package, or rgdal, or mapproj.
>
> Cheers, Mike
>
> On Wed, Jan 18, 2017, 05:51 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:
>>
>>> Dear all,
>>>
>>> I am analysing GPS Data from Chad. I need to first project the latitude
>>> and longitudes. I use the package Proj4, the function project for this.
>>> I have 2 devices and with the data of the 1st device, the projection
>>> worked perfectly. But with the data from the other device, I got this
>>> error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84
>>> +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded
>>> limits"
>>>
>>> I found that Chad was UTM 33P (Wikipedia UTM:
>>>
>> https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
>>> ), but some people could use the notification 33N: 33 for the zone and N
>>> for the North hemisphere.
>>>
>>> My code is:
>>> loc <- dat[,c("Longitude","Latitude")
>>> loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84
>>> +units=m +no_defs")
>>>
>>> Does anybody know where my problem could be?
>>
>> Well, the error message is coming from inside the proj.4 library: did you
>> look at the input object? If one device was returning decimal geographical
>> coordinates and the other a string with degrees, minutes and seconds in
>> one "number":
>>
>> library(rgdal)
>> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")
>> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")
>>
>> In this setting I get:
>>
>>> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
>> +ellps=WGS84")
>>           [,1]    [,2]
>> [1,] 930334.7 1662218
>>> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
>> +ellps=WGS84")
>>       [,1] [,2]
>> [1,]  Inf  Inf
>> Warning message:
>> In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
>> +ellps=WGS84") :
>>    1 projected point(s) not finite
>>
>> but not your error. I suspect that the matrix you are passing contains
>> non-geographical coordinates. If you are using the proj4 package (odd
>> choice but there you are):
>>
>>> library(proj4)
>>> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
>> +ellps=WGS84")
>>           [,1]    [,2]
>> [1,] 930334.7 1662218
>>> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
>> +ellps=WGS84")
>> Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
>> +ellps=WGS84") :
>>    latitude or longitude exceeded limits
>>
>> confirming that it doesn't handle exceptions other than by a hard fail.
>>
>> Roger
>>
>>
>>> Thank you
>>> Aur?lie
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> http://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>> http://depsy.org/person/434412
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> University of Tasmania Electronic Communications Policy (December, 2014).
>> This email is confidential, and is for the intended recipient only.
>> Access, disclosure, copying, distribution, or reliance on any of it by
>> anyone outside the intended recipient organisation is prohibited and may be
>> a criminal offence. Please delete if obtained in error and email
>> confirmation to the sender. The views expressed in this email are not
>> necessarily the views of the University of Tasmania, unless clearly
>> intended otherwise.
>> .
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412

From Roger.Bivand at nhh.no  Wed Jan 18 10:59:11 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 Jan 2017 10:59:11 +0100
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <alpine.LFD.2.20.1701181011040.32198@reclus.nhh.no>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
	<alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
	<CAAcGz98iHPPK6g1RjLYgfJ7NgUiwHACjuoWJhY+VB7kYiz33iw@mail.gmail.com>
	<alpine.LFD.2.20.1701181011040.32198@reclus.nhh.no>
Message-ID: <alpine.LFD.2.20.1701181044170.32198@reclus.nhh.no>

On Wed, 18 Jan 2017, Roger Bivand wrote:

> On Tue, 17 Jan 2017, Michael Sumner wrote:
>
>>  Watch out with proj4 btw, it has an obscure bug where a 2 row matrix
>>  input
>>  is transposed, mixing longitude and latitude in a way that triggers an
>>  out
>>  of bounds error for latitude, only when the mixed abs(longitude) is
>>  greater
>>  than 90.
>
> You mean:
>
>>  library(rgdal)
>>  crds <- rbind(c(90, 1), c(91, 2))
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>         [,1]     [,2]
> [1,] 833927.9 110682.8
> [2,] 945193.9 221604.0
>>  crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>          [,1]     [,2]
> [1,]  833927.9 110682.8
> [2,]  945193.9 221604.0
> [3,] 1056324.8 332866.1
>>  crds <- matrix(c(91, 2), nrow=1)
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>         [,1]   [,2]
> [1,] 945193.9 221604
>
> and
>
>>  library(proj4)
>>  crds <- rbind(c(90, 1), c(91, 2))
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
> Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
>   latitude or longitude exceeded limits
>>  crds <- rbind(c(90, 1), c(90, 2))
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
> Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
>>  crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>          [,1]     [,2]
> [1,]  833927.9 110682.8
> [2,]  945193.9 221604.0
> [3,] 1056324.8 332866.1
>>  crds <- matrix(c(91, 2), nrow=1)
>>  project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>         [,1]   [,2]
> [1,] 945193.9 221604
>
> right?
>
> I'll take a look and if I see the bug, send a patch to Simon. Please confirm 
> that this is what you see.

Lines 20-26 in proj4/R/project.R flip an input matrix with two rows, so 
putting one of the >=abs(90) longitude values in y - for unknown reasons.

# Keep matrix orientation fixed (RSB/MS 170118)
#            if (d[1]==2) {
#                x <- xy[1,]
#                y <- xy[2,]
#            } else {
                 x <- xy[,1]
                 y <- xy[,2]
#            }

With the offending test commented out, we're OK.

> library(proj4)
> crds <- rbind(c(90, 1), c(91, 2))
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
          [,1]     [,2]
[1,] 833927.9 110682.8
[2,] 945193.9 221604.0

The workaround if proj4 is not patched would be to do:

> library(proj4)
> crds <- rbind(c(90, 1), c(91, 2))
> if (dim(crds)[1] == 2) crds <- t(crds)
> project(crds, "+proj=utm +zone=45 +ellps=WGS84")
          [,1]     [,2]
[1,] 833927.9 110682.8
[2,] 945193.9 221604.0

proj4::ptransform() is OK (provided an input object in degrees is 
converted to radians by the user).

Could you check (edited proj4/R/project.R attached)?

Roger

>
> Best wishes,
>
> Roger
>
>>
>>  Use the sf package, or rgdal, or mapproj.
>>
>>  Cheers, Mike
>>
>>  On Wed, Jan 18, 2017, 05:51 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> 
>> >  On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:
>> > 
>> > >  Dear all,
>> > > 
>> > >  I am analysing GPS Data from Chad. I need to first project the 
>> > >  latitude
>> > >  and longitudes. I use the package Proj4, the function project for 
>> > >  this.
>> > >  I have 2 devices and with the data of the 1st device, the projection
>> > >  worked perfectly. But with the data from the other device, I got this
>> > >  error message: "Error in project(loc, "+proj=utm +zone=33 
>> > >  +ellps=WGS84
>> > >  +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded
>> > >  limits"
>> > > 
>> > >  I found that Chad was UTM 33P (Wikipedia UTM:
>> > > 
>> > https: //en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
>> > > ) , but some people could use the notification 33N: 33 for the zone 
>> > > ) and N
>> > >  for the North hemisphere.
>> > > 
>> > >  My code is:
>> > >  loc <- dat[,c("Longitude","Latitude")
>> > >  loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 
>> > >  +datum=WGS84
>> > >  +units=m +no_defs")
>> > > 
>> > >  Does anybody know where my problem could be?
>> > 
>> >  Well, the error message is coming from inside the proj.4 library: did 
>> >  you
>> >  look at the input object? If one device was returning decimal 
>> >  geographical
>> >  coordinates and the other a string with degrees, minutes and seconds in
>> >  one "number":
>> > 
>> >  library(rgdal)
>> >  project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 
>> >  +ellps=WGS84")
>> >  project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 
>> >  +ellps=WGS84")
>> > 
>> >  In this setting I get:
>> > 
>> > >  project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
>> >  +ellps=WGS84")
>> >            [,1]    [,2]
>> >  [1,] 930334.7 1662218
>> > >  project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
>> >  +ellps=WGS84")
>> >        [,1] [,2]
>> >  [1,]  Inf  Inf
>> >  Warning message:
>> >  In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
>> >  +ellps=WGS84") :
>> >     1 projected point(s) not finite
>> > 
>> >  but not your error. I suspect that the matrix you are passing contains
>> >  non-geographical coordinates. If you are using the proj4 package (odd
>> >  choice but there you are):
>> > 
>> > >  library(proj4)
>> > >  project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
>> >  +ellps=WGS84")
>> >            [,1]    [,2]
>> >  [1,] 930334.7 1662218
>> > >  project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
>> >  +ellps=WGS84")
>> >  Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
>> >  +ellps=WGS84") :
>> >     latitude or longitude exceeded limits
>> > 
>> >  confirming that it doesn't handle exceptions other than by a hard fail.
>> > 
>> >  Roger
>> > 
>> > 
>> > >  Thank you
>> > >  Aur?lie
>> > > 
>> > >  _______________________________________________
>> > >  R-sig-Geo mailing list
>> > >  R-sig-Geo at r-project.org
>> > > https: //stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > > 
>> > 
>> >  --
>> >  Roger Bivand
>> >  Department of Economics, Norwegian School of Economics,
>> >  Helleveien 30, N-5045 Bergen, Norway.
>> >  voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> > http: //orcid.org/0000-0003-2392-6140
>> > https: //scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>> > http: //depsy.org/person/434412
>> >  _______________________________________________
>> >  R-sig-Geo mailing list
>> >  R-sig-Geo at r-project.org
>> > https: //stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > 
>> > 
>> >  University of Tasmania Electronic Communications Policy (December, 
>> >  2014).
>> >  This email is confidential, and is for the intended recipient only.
>> >  Access, disclosure, copying, distribution, or reliance on any of it by
>> >  anyone outside the intended recipient organisation is prohibited and 
>> >  may be
>> >  a criminal offence. Please delete if obtained in error and email
>> >  confirmation to the sender. The views expressed in this email are not
>> >  necessarily the views of the University of Tasmania, unless clearly
>> >  intended otherwise.
>> >  .
>> > 
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412
-------------- next part --------------
# Copyright (c) 2007 by Simon Urbanek
#
# part of proj4 R package, license: GPL v2

project <- function(xy, proj, inverse=FALSE, degrees=TRUE, silent=FALSE, ellps.default="sphere") {
    proj <- .proj2char(proj, ellps.default=ellps.default)
    if (is.list(xy)) {
        if (length(xy)<2) stop("input must be at least 2-dimensional")
        if (length(xy)>2 && !silent) warning("more than two dimensions found, using first two")
        x <- xy[[1]]
        y <- xy[[2]]
    } else {
        d <- dim(xy)
        if (is.null(d) && length(xy)==2) {
            x <- xy[1]
            y <- xy[2]
        } else {
            if (length(d) != 2 || (d[1]!=2 && d[2]!=2))
                stop("input must be 2-dimensional")
# Keep matrix orientation fixed (RSB/MS 170118)
#            if (d[1]==2) {
#                x <- xy[1,]
#                y <- xy[2,]
#            } else {
                x <- xy[,1]
                y <- xy[,2]
#            }
        }
    }
    if (!is.numeric(x)) x <- as.numeric(x)
    if (!is.numeric(y)) y <- as.numeric(y)
    if (length(x) < length(y)) {
        if (!silent) warning("x is shorter than y, recycling")
        x <- rep(x, length.out=length(y))
    }
    if (length(y) < length(x)) {
        if (!silent) warning("y is shorter than x, recycling")
        y <- rep(y, length.out=length(x))
    }
    n <- length(x)
    f <- 0:0
    if (inverse) f <- f + 1:1
    if (degrees) f <- f + 2:2
    res <- .C("project", as.character(proj),                
              as.integer(n), x=as.double(x), y=as.double(y),
              f, NAOK=TRUE, PACKAGE=.package.name)
    if (is.list(xy))
        list(x=res$x, y=res$y)
    else
        cbind(res$x, res$y)
}

From mdsumner at gmail.com  Wed Jan 18 11:11:25 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 18 Jan 2017 10:11:25 +0000
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <alpine.LFD.2.20.1701181011040.32198@reclus.nhh.no>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
	<alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
	<CAAcGz98iHPPK6g1RjLYgfJ7NgUiwHACjuoWJhY+VB7kYiz33iw@mail.gmail.com>
	<alpine.LFD.2.20.1701181011040.32198@reclus.nhh.no>
Message-ID: <CAAcGz9_8OMW-KCHS2Hng89mHy8kWZpLSJFCKxaG5eV3h1N1GCA@mail.gmail.com>

Yes that's it, I sent it to the maintainer as a report, and parked my
example here:

https://github.com/mdsumner/proj4/issues/1

I planned to patch it there but can now confirm your fix solves that issue.

(I wasn't sure anyone at all else would even notice so was waiting for the
maintainer).

Thanks for the confirmation and fix.

Thanks, Mike

On Wed, 18 Jan 2017 at 20:17 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 17 Jan 2017, Michael Sumner wrote:
>
> > Watch out with proj4 btw, it has an obscure bug where a 2 row matrix
> input
> > is transposed, mixing longitude and latitude in a way that triggers an
> out
> > of bounds error for latitude, only when the mixed abs(longitude) is
> greater
> > than 90.
>
> You mean:
>
> > library(rgdal)
> > crds <- rbind(c(90, 1), c(91, 2))
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>           [,1]     [,2]
> [1,] 833927.9 110682.8
> [2,] 945193.9 221604.0
> > crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>            [,1]     [,2]
> [1,]  833927.9 110682.8
> [2,]  945193.9 221604.0
> [3,] 1056324.8 332866.1
> > crds <- matrix(c(91, 2), nrow=1)
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>           [,1]   [,2]
> [1,] 945193.9 221604
>
> and
>
> > library(proj4)
> > crds <- rbind(c(90, 1), c(91, 2))
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
> Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
>    latitude or longitude exceeded limits
> > crds <- rbind(c(90, 1), c(90, 2))
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
> Error in project(crds, "+proj=utm +zone=45 +ellps=WGS84") :
> > crds <- rbind(c(90, 1), c(91, 2), c(92, 3))
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>            [,1]     [,2]
> [1,]  833927.9 110682.8
> [2,]  945193.9 221604.0
> [3,] 1056324.8 332866.1
> > crds <- matrix(c(91, 2), nrow=1)
> > project(crds, "+proj=utm +zone=45 +ellps=WGS84")
>           [,1]   [,2]
> [1,] 945193.9 221604
>
> right?
>
> I'll take a look and if I see the bug, send a patch to Simon. Please
> confirm that this is what you see.
>
> Best wishes,
>
> Roger
>
> >
> > Use the sf package, or rgdal, or mapproj.
> >
> > Cheers, Mike
> >
> > On Wed, Jan 18, 2017, 05:51 Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:
> >>
> >>> Dear all,
> >>>
> >>> I am analysing GPS Data from Chad. I need to first project the latitude
> >>> and longitudes. I use the package Proj4, the function project for this.
> >>> I have 2 devices and with the data of the 1st device, the projection
> >>> worked perfectly. But with the data from the other device, I got this
> >>> error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84
> >>> +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded
> >>> limits"
> >>>
> >>> I found that Chad was UTM 33P (Wikipedia UTM:
> >>>
> >>
> https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
> >>> ), but some people could use the notification 33N: 33 for the zone and
> N
> >>> for the North hemisphere.
> >>>
> >>> My code is:
> >>> loc <- dat[,c("Longitude","Latitude")
> >>> loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84
> +datum=WGS84
> >>> +units=m +no_defs")
> >>>
> >>> Does anybody know where my problem could be?
> >>
> >> Well, the error message is coming from inside the proj.4 library: did
> you
> >> look at the input object? If one device was returning decimal
> geographical
> >> coordinates and the other a string with degrees, minutes and seconds in
> >> one "number":
> >>
> >> library(rgdal)
> >> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
> >> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
> +ellps=WGS84")
> >>
> >> In this setting I get:
> >>
> >>> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
> >> +ellps=WGS84")
> >>           [,1]    [,2]
> >> [1,] 930334.7 1662218
> >>> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
> >> +ellps=WGS84")
> >>       [,1] [,2]
> >> [1,]  Inf  Inf
> >> Warning message:
> >> In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
> >> +ellps=WGS84") :
> >>    1 projected point(s) not finite
> >>
> >> but not your error. I suspect that the matrix you are passing contains
> >> non-geographical coordinates. If you are using the proj4 package (odd
> >> choice but there you are):
> >>
> >>> library(proj4)
> >>> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
> >> +ellps=WGS84")
> >>           [,1]    [,2]
> >> [1,] 930334.7 1662218
> >>> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
> >> +ellps=WGS84")
> >> Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33
> >> +ellps=WGS84") :
> >>    latitude or longitude exceeded limits
> >>
> >> confirming that it doesn't handle exceptions other than by a hard fail.
> >>
> >> Roger
> >>
> >>
> >>> Thank you
> >>> Aur?lie
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55 <+47%2055%2095%2093%2055>; e-mail:
> Roger.Bivand at nhh.no
> >> http://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >> http://depsy.org/person/434412
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>
> >> University of Tasmania Electronic Communications Policy (December,
> 2014).
> >> This email is confidential, and is for the intended recipient only.
> >> Access, disclosure, copying, distribution, or reliance on any of it by
> >> anyone outside the intended recipient organisation is prohibited and
> may be
> >> a criminal offence. Please delete if obtained in error and email
> >> confirmation to the sender. The views expressed in this email are not
> >> necessarily the views of the University of Tasmania, unless clearly
> >> intended otherwise.
> >> .
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55 <+47%2055%2095%2093%2055>; e-mail:
> Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> http://depsy.org/person/434412

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From aurelie.tschopp at vetsuisse.unibe.ch  Wed Jan 18 13:53:50 2017
From: aurelie.tschopp at vetsuisse.unibe.ch (aurelie.tschopp at vetsuisse.unibe.ch)
Date: Wed, 18 Jan 2017 12:53:50 +0000
Subject: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits
In-Reply-To: <alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
References: <D2E49BA8575FF74CA28C47CBAEAA267B541A65@AAI-EXCH-MBX2.campus.unibe.ch>
	<alpine.LFD.2.20.1701171921560.22095@reclus.nhh.no>
Message-ID: <D2E49BA8575FF74CA28C47CBAEAA267B541DBE@AAI-EXCH-MBX2.campus.unibe.ch>

Dear all

Thank you very much for your answers. 
In the meantime we found the error (it was really stupid): my latitude and longitudes were not numeric.
Since then everything is working fine with my projection and the my data analysis. Thank you. 
I will read your information on the proj4 bug also. Thank you for that. 

Cheers
Aur?lie

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: mardi 17 janvier 2017 19:50
To: Tschopp, Aur?lie (VETSUISSE)
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Proj4 - latitude or longitude exceeded limits

On Tue, 17 Jan 2017, aurelie.tschopp at vetsuisse.unibe.ch wrote:

> Dear all,
>
> I am analysing GPS Data from Chad. I need to first project the 
> latitude and longitudes. I use the package Proj4, the function project for this.
> I have 2 devices and with the data of the 1st device, the projection 
> worked perfectly. But with the data from the other device, I got this 
> error message: "Error in project(loc, "+proj=utm +zone=33 +ellps=WGS84
> +datum=WGS84 +units=m +no_defs") : latitude or longitude exceeded
> limits"
>
> I found that Chad was UTM 33P (Wikipedia UTM: 
> https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate
> _system ), but some people could use the notification 33N: 33 for the 
> zone and N for the North hemisphere.
>
> My code is:
> loc <- dat[,c("Longitude","Latitude")
> loc_Zone33 <- project(loc, "+proj=utm +zone=33 +ellps=WGS84 
> +datum=WGS84
> +units=m +no_defs")
>
> Does anybody know where my problem could be?

Well, the error message is coming from inside the proj.4 library: did you look at the input object? If one device was returning decimal geographical coordinates and the other a string with degrees, minutes and seconds in one "number":

library(rgdal)
project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33 +ellps=WGS84") project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33 +ellps=WGS84")

In this setting I get:

> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
+ellps=WGS84")
          [,1]    [,2]
[1,] 930334.7 1662218
> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
+ellps=WGS84")
      [,1] [,2]
[1,]  Inf  Inf
Warning message:
In project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33 
+ellps=WGS84") :
   1 projected point(s) not finite

but not your error. I suspect that the matrix you are passing contains non-geographical coordinates. If you are using the proj4 package (odd choice but there you are):

> library(proj4)
> project(matrix(c(19.0, 15.0), nrow=1), "+proj=utm +zone=33
+ellps=WGS84")
          [,1]    [,2]
[1,] 930334.7 1662218
> project(matrix(c(1900, 1500), nrow=1), "+proj=utm +zone=33
+ellps=WGS84")
Error in project(matrix(c(1900, 1500), nrow = 1), "+proj=utm +zone=33 
+ellps=WGS84") :
   latitude or longitude exceeded limits

confirming that it doesn't handle exceptions other than by a hard fail.

Roger


> Thank you
> Aur?lie
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics, Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From jt at pion-economics.co.uk  Wed Jan 18 15:52:56 2017
From: jt at pion-economics.co.uk (jt)
Date: Wed, 18 Jan 2017 14:52:56 +0000
Subject: [R-sig-Geo] Eigenvalues in Eigenvectors - spatial correlation and
 spatial instrumental variables
Message-ID: <6b4af2c826085ce0c0b96abb373d7c36@webmail.names.co.uk>

Hi Everybody,

Recent convert and newcomer. I am interested in exploring the use of
eigenvalues as synthetic instrumental variables in the manner of Le
Gallo and Paez (2013). To do this I need to access the actual
eigenvalues in eigenvectors.  I am aware of the 2009 r-sig-geo
communication regarding potential to use ME() within spdep and the offer
of Professor Bivand to add eigenvalues as an attribute of the output
object when requested.  My question is whether this or any other
mechanism is available to specify eigenvalues within spdep as I do not
think this is currently an option and I cannot identify the code to
implement the adjustment offered in 2009?

Many Thanks

JimT
	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jan 18 20:17:47 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 Jan 2017 20:17:47 +0100
Subject: [R-sig-Geo] Eigenvalues in Eigenvectors - spatial correlation
 and spatial instrumental variables
In-Reply-To: <6b4af2c826085ce0c0b96abb373d7c36@webmail.names.co.uk>
References: <6b4af2c826085ce0c0b96abb373d7c36@webmail.names.co.uk>
Message-ID: <alpine.LFD.2.20.1701181934590.13074@reclus.nhh.no>

On Wed, 18 Jan 2017, jt wrote:

> Hi Everybody,
>
> Recent convert and newcomer. I am interested in exploring the use of
> eigenvalues as synthetic instrumental variables in the manner of Le
> Gallo and Paez (2013).

This appears to be doi:10.1068/a45443, by the way.

> To do this I need to access the actual eigenvalues in eigenvectors.  I 
> am aware of the 2009 r-sig-geo communication regarding potential to use 
> ME() within spdep and the offer of Professor Bivand to add eigenvalues 
> as an attribute of the output object when requested.

The link to the thread may be:

https://stat.ethz.ch/pipermail/r-sig-geo/2009-June/005939.html

although I don't see any offer there, what was mentioned was the matrix 
of eigenvectors "eV".

> My question is whether this or any other mechanism is available to 
> specify eigenvalues within spdep as I do not think this is currently an 
> option and I cannot identify the code to implement the adjustment 
> offered in 2009?

If the article linked by DOI above is the right one, I think you want 
eigenvectors from the doubly centred spatial weights matrix. If you use 
dense matrices, you can get them from:

library(spdep)
data(columbus)
W <- nb2mat(col.gal.nb, style="B")
n <- nrow(W)
one <- rep(1, n)
I_11n <- diag(n) - (one %*% t(one))/n
M <- I_11n %*% W %*% I_11n
e <- eigen(M)
str(e)

Use of eigenvectors is only possible for moderate-to-large n (say US 
Counties), and as noted in the list thread, a brute force search as 
suggested in Le Gallo & P?ez is also subject to the same time problems. 
The ME case is really for the GLM setting, while the SpatialFiltering 
function is closer to your aim of using OLS (or 2SLS).

The article doesn't reference Tiefelsdorf M, Griffith DA. (2007) 
Semiparametric Filtering of Spatial Autocorrelation: The Eigenvector 
Approach. Environment and Planning A, 39 (5) 1193 - 1221, on which 
SpatialFiltering() is based - reducing Moran's I rather than monitoring 
fit to choose which eigenvectors to include.

My guess would be that implementations in pure R (like ME and 
SpatialFiltering) will see poor performance as n grows, and that for 
larger n (larger than 500), you'd need to use C++ via Rcpp and say 
RcppEigen or RcppArmadillo.

Hope this clarifies,

Roger

>
> Many Thanks
>
> JimT
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412

From sanjay.lamsal at monsanto.com  Wed Jan 18 20:40:03 2017
From: sanjay.lamsal at monsanto.com (LAMSAL, SANJAY [AG/1005])
Date: Wed, 18 Jan 2017 19:40:03 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 161, Issue 6
In-Reply-To: <mailman.13.1484046003.8651.r-sig-geo@r-project.org>
References: <mailman.13.1484046003.8651.r-sig-geo@r-project.org>
Message-ID: <8DEB54F46E2E8E4D937EDC2D04B7311B01EBFE44@STLWEXMBXPRD15.na.ds.monsanto.com>

HI Edzer,
Thanks. 

I tried the gstat unconditional simulation, and seems to produce the desired outputs.

I have a follow up two questions 
1. Is there a literature that describes how the unconditional simulation (data processing, normal score transform, post processing, etc) is handled within the gstat package. I did simulation by generating gstat object. I have looked at the gstat manual. 
2. if I got access to 1, I could figure out if the method is useful for zero inflated datasets, or you may have suggestion to it. I understand normal score transform methods (if implemented) would normalize data but with zeros, I am not sure. 

Thanks

Sanjay


-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of r-sig-geo-request at r-project.org
Sent: Tuesday, January 10, 2017 5:00 AM
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 161, Issue 6

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Simulating or bootstrapping of Spatial Data
      (LAMSAL, SANJAY [AG/1005])
   2. Re: Simulating or bootstrapping of Spatial Data (Edzer Pebesma)


----------------------------------------------------------------------

Message: 1
Date: Mon, 9 Jan 2017 19:56:59 +0000
From: "LAMSAL, SANJAY [AG/1005]" <sanjay.lamsal at monsanto.com>
To: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] Simulating or bootstrapping of Spatial Data
Message-ID:
	<8DEB54F46E2E8E4D937EDC2D04B7311B01EB9E31 at STLWEXMBXPRD15.na.ds.monsanto.com>
	
Content-Type: text/plain; charset="UTF-8"

I have a spatial data of soil bacteria concentration and have its semivariogram model. I wanted to simulate spatial scenarios of bacterial concentration in other fields. I could see this as either bootstrapping the bacteria data on spatial grids placed over other fields such that the generated data is spatially autocorrelated (honors the semivariogram model).

In my case, we want to develop spatial patterns of bacterium across several fields, where spatial pattern differ among fields but all patterns honor the same semivariogram model. Can anyone suggest an approach to accomplish this? I see this as being different from sequential simulation using gstat object (package gstat) where the simulated maps are realizations of original scenario.

Thanks

Sanjay



This email and any attachments were sent from a Monsanto email account and may contain confidential and/or privileged information. If you are not the intended recipient, please contact the sender and delete this email and any attachments immediately. Any unauthorized use, including disclosing, printing, storing, copying or distributing this email, is prohibited. All emails and attachments sent to or from Monsanto email accounts may be subject to monitoring, reading, and archiving by Monsanto, including its affiliates and subsidiaries, as permitted by applicable law. Thank you.

	[[alternative HTML version deleted]]



------------------------------

Message: 2
Date: Mon, 9 Jan 2017 21:51:20 +0100
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Simulating or bootstrapping of Spatial Data
Message-ID: <64041420-b607-94be-ff83-61f8b5330244 at uni-muenster.de>
Content-Type: text/plain; charset="windows-1252"

Sanjay,

library(gstat)
demo(ugsim)

gives a demo of a sequential Gaussian unconditional simulation, which you seem to want. Several other simulation methods are found in package RandomFields.

On 09/01/17 20:56, LAMSAL, SANJAY [AG/1005] wrote:
> I have a spatial data of soil bacteria concentration and have its semivariogram model. I wanted to simulate spatial scenarios of bacterial concentration in other fields. I could see this as either bootstrapping the bacteria data on spatial grids placed over other fields such that the generated data is spatially autocorrelated (honors the semivariogram model).
> 
> In my case, we want to develop spatial patterns of bacterium across several fields, where spatial pattern differ among fields but all patterns honor the same semivariogram model. Can anyone suggest an approach to accomplish this? I see this as being different from sequential simulation using gstat object (package gstat) where the simulated maps are realizations of original scenario.
> 
> Thanks
> 
> Sanjay
> 
> 
> 
> This email and any attachments were sent from a Monsanto email account and may contain confidential and/or privileged information. If you are not the intended recipient, please contact the sender and delete this email and any attachments immediately. Any unauthorized use, including disclosing, printing, storing, copying or distributing this email, is prohibited. All emails and attachments sent to or from Monsanto email accounts may be subject to monitoring, reading, and archiving by Monsanto, including its affiliates and subsidiaries, as permitted by applicable law. Thank you.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

--
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170109/3778f785/attachment-0001.bin>

------------------------------

Subject: Digest Footer

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

------------------------------

End of R-sig-Geo Digest, Vol 161, Issue 6
*****************************************
This email and any attachments were sent from a Monsanto email account and may contain confidential and/or privileged information. If you are not the intended recipient, please contact the sender and delete this email and any attachments immediately. Any unauthorized use, including disclosing, printing, storing, copying or distributing this email, is prohibited. All emails and attachments sent to or from Monsanto email accounts may be subject to monitoring, reading, and archiving by Monsanto, including its affiliates and subsidiaries, as permitted by applicable law. Thank you.


From zhang_t_y at hotmail.com  Thu Jan 19 09:35:06 2017
From: zhang_t_y at hotmail.com (Zhang Tianyi)
Date: Thu, 19 Jan 2017 08:35:06 +0000
Subject: [R-sig-Geo] Efficient way to process a time series of MODIS image
In-Reply-To: <alpine.LFD.2.20.1701181934590.13074@reclus.nhh.no>
References: <6b4af2c826085ce0c0b96abb373d7c36@webmail.names.co.uk>,
	<alpine.LFD.2.20.1701181934590.13074@reclus.nhh.no>
Message-ID: <SG2PR0601MB1328BFEB2E3496003176F26FB87E0@SG2PR0601MB1328.apcprd06.prod.outlook.com>

Dear all,


I am working with MODIS data (MOD09A1) with R. I now have a rasterstack data with each layer for each MODIS image.

I found I need to extract time series for each cell to do a set of regular manuplation. I have some possible solutions:

(1) change the values of rasterstack to data.table and row-wisely process this data.table variable by apply()

(2) work on rasterstack itself, and do vectorized programming


I think the second one will be better, but I am not sure because the method 1 is using data.table.

I am wondering what is the most efficient way to do that when you are processing remote sensing data with R?

Thank you very much


Tianyi Zhang

	[[alternative HTML version deleted]]


From loic.dutrieux at conabio.gob.mx  Thu Jan 19 11:24:14 2017
From: loic.dutrieux at conabio.gob.mx (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Thu, 19 Jan 2017 11:24:14 +0100
Subject: [R-sig-Geo] Efficient way to process a time series of MODIS
	image
In-Reply-To: <SG2PR0601MB1328BFEB2E3496003176F26FB87E0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
References: <6b4af2c826085ce0c0b96abb373d7c36@webmail.names.co.uk>
	<alpine.LFD.2.20.1701181934590.13074@reclus.nhh.no>
	<SG2PR0601MB1328BFEB2E3496003176F26FB87E0@SG2PR0601MB1328.apcprd06.prod.outlook.com>
Message-ID: <e6239e18-6722-147d-5ad2-971fe7bff9b1@conabio.gob.mx>

Good question, it's rarely necessary, or a good idea, to convert rasters
to dataframes/data.tables for analysis. For pixel wise operations use
raster::calc() or simple raster arithmetics, which inherits from vector
arithmetics.

Cheers,
Lo?c

On 19/01/2017 09:35, Zhang Tianyi wrote:
> Dear all,
> 
> 
> I am working with MODIS data (MOD09A1) with R. I now have a rasterstack data with each layer for each MODIS image.
> 
> I found I need to extract time series for each cell to do a set of regular manuplation. I have some possible solutions:
> 
> (1) change the values of rasterstack to data.table and row-wisely process this data.table variable by apply()
> 
> (2) work on rasterstack itself, and do vectorized programming
> 
> 
> I think the second one will be better, but I am not sure because the method 1 is using data.table.
> 
> I am wondering what is the most efficient way to do that when you are processing remote sensing data with R?
> 
> Thank you very much
> 
> 
> Tianyi Zhang
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> Email secured by Check Point
>


From malNamalJa at gmx.de  Thu Jan 19 12:31:34 2017
From: malNamalJa at gmx.de (=?UTF-8?Q?=22Jannes_M=C3=BCnchow=22?=)
Date: Thu, 19 Jan 2017 12:31:34 +0100
Subject: [R-sig-Geo] RQGIS release 0.2.0
Message-ID: <trinity-601a3a1d-409b-49fa-9388-e02e37dff1c2-1484825494364@3capp-gmx-bs42>

Dear list members,

today we are happy to announce a new version of RQGIS! RQGIS establishes an interface between R and QGIS, i.e. it allows the user to access the more than 1000 QGIS geoalgorithms from within R. The most important news is that you can run again the most recent QGIS releases (>=2.18.2) with RQGIS without having to modify Python source code. This modification became necessary due to a bug introduced in QGIS 2.16 (see https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181). 

This release fixes also several bugs which we detected thanks to user feedback. To learn more about these, please refer to https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0. 

For more information on RQGIS, how to install it and examples how to use RQGIS, please refer to https://github.com/jannes-m/RQGIS and my https://jannesm.wordpress.com/category/r/.

All the best,

Jannes


From amsantac at hotmail.com  Sat Jan 21 15:51:05 2017
From: amsantac at hotmail.com (Ali Santacruz)
Date: Sat, 21 Jan 2017 14:51:05 +0000
Subject: [R-sig-Geo] RQGIS release 0.2.0
In-Reply-To: <trinity-601a3a1d-409b-49fa-9388-e02e37dff1c2-1484825494364@3capp-gmx-bs42>
References: <trinity-601a3a1d-409b-49fa-9388-e02e37dff1c2-1484825494364@3capp-gmx-bs42>
Message-ID: <MWHPR10MB187253209672B70C69272990C9700@MWHPR10MB1872.namprd10.prod.outlook.com>


Awesome work! Thanks a lot!


I've been able to run QGIS and SAGA algorithms without issues. However, I have some problems running GRASS algorithms,

I'm trying to run r.neighbors from GRASS 7, but the resolution, extent and values of the output raster don't match those of the input,


Here is the code:


# Load raster
library(raster)

r1 <- raster("pred_m1_3000_recl5.tif")
r1


class       : RasterLayer
dimensions  : 837, 849, 710613  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : 0, 849, -837, 0  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : E:\amsantac\dstl\working\pred\pred_m1_3000_recl5.tif
names       : pred_m1_3000_recl5
values      : 5, 110  (min, max)


# Load RQGIS
library(RQGIS)
my_env <- set_env("C:/OSGeo4W64/")
dir_tmp <- tempdir()


# Set parameters for grass7:r.neighbors
params <- get_args_man(alg = "grass7:r.neighbors", qgis_env = my_env)
params$input  <- r1
params$method  <- 2 # "Mode"
params$output  <- file.path(dir_tmp, "rst_out.tif")

params$GRASS_REGION_PARAMETER <- "0,849,-837,0"    # as xmin, xmax, ymin, ymax
params$GRASS_REGION_CELLSIZE_PARAMETER <- "1.0"

out <- run_qgis(alg = "grass7:r.neighbors", params = params, load_output = params$output, qgis_env = my_env)
out


class       : RasterLayer
dimensions  : 1, 7, 7  (nrow, ncol, ncell)
resolution  : 0.1519435, 1  (x, y)
extent      : 0, 1.063604, 0, 1  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
data source : C:\Users\Guest\AppData\Local\Temp\RtmpwJu31Y\rst_out.tif
names       : rst_out



Note the output only has 1 row, 7 cols (vs. 837 rows, 849 cols in input). The CRS has been set as long-lat, while the CRS is NA in the input,


Also note that the resolution has been changed from 1 to 0.1519,


I wonder if there is an issue on how the params$GRASS_REGION_PARAMETER is defined. I have tried different ways eg., "0,849,-837,0" (as xmin, xmax, ymin, ymax), "0,-837,849,0" (as xmin, ymin, xmax, ymax), extent(r1) (which gives error).


The input image (550 kb) can be downloaded from this link: https://www.dropbox.com/s/do95t48foepw62e/pred_m1_3000_recl5.tif?dl=0



Thanks for your help,


Best regards,


Ali



sessionInfo()


R version 3.3.2 (2016-10-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] RQGIS_0.2.0.9000     raster_2.5-8         sp_1.2-3             RevoUtilsMath_10.0.0

loaded via a namespace (and not attached):
[1] RevoUtils_10.0.2 rgdal_1.1-10     tools_3.3.2      Rcpp_0.12.7      grid_3.3.2       lattice_0.20-34


________________________________
De: R-sig-Geo <r-sig-geo-bounces at r-project.org> en nombre de "Jannes M?nchow" <malNamalJa at gmx.de>
Enviado: jueves, 19 de enero de 2017 06:31:34 a. m.
Para: r-sig-geo at r-project.org
Asunto: [R-sig-Geo] RQGIS release 0.2.0

Dear list members,

today we are happy to announce a new version of RQGIS! RQGIS establishes an interface between R and QGIS, i.e. it allows the user to access the more than 1000 QGIS geoalgorithms from within R. The most important news is that you can run again the most recent QGIS releases (>=2.18.2) with RQGIS without having to modify Python source code. This modification became necessary due to a bug introduced in QGIS 2.16 (see https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181).

[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>

GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>
github.com
RQGIS - integrating R with QGIS ... Now that we have a spatial object, we can move on to using RQGIS. First of all, we need to specify all the paths necessary to run ...




This release fixes also several bugs which we detected thanks to user feedback. To learn more about these, please refer to https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0.

[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0>

jannes-m/RQGIS<https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0>
github.com
RQGIS - integrating R with QGIS




For more information on RQGIS, how to install it and examples how to use RQGIS, please refer to https://github.com/jannes-m/RQGIS and my https://jannesm.wordpress.com/category/r/.

Posts about R on jannesm<https://jannesm.wordpress.com/category/r/>
jannesm.wordpress.com
Posts about R written by jannesm



[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS>

GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<https://github.com/jannes-m/RQGIS>
github.com
RQGIS - integrating R with QGIS ... Now that we have a spatial object, we can move on to using RQGIS. First of all, we need to specify all the paths necessary to run ...




All the best,

Jannes

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

R-sig-Geo Info Page - ETH Zurich<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
stat.ethz.ch
R-sig-Geo -- R Special Interest Group on using Geographical data and Mapping About R-sig-Geo




	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Sat Jan 21 18:16:10 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Sat, 21 Jan 2017 18:16:10 +0100
Subject: [R-sig-Geo] RQGIS release 0.2.0
In-Reply-To: <MWHPR10MB187253209672B70C69272990C9700@MWHPR10MB1872.namprd10.prod.outlook.com>
References: <trinity-601a3a1d-409b-49fa-9388-e02e37dff1c2-1484825494364@3capp-gmx-bs42>
	<MWHPR10MB187253209672B70C69272990C9700@MWHPR10MB1872.namprd10.prod.outlook.com>
Message-ID: <CAE=-a0S-=oEV1=XH+JyrYbqezbtBT4WNsaUqRVc2jX-=POLJ1A@mail.gmail.com>

Dear Ali,

a general note: Please write a new mail if you have a specific problem with
a package instead of replying to the last mail related to the package.

Regarding your issue: I think this error relates to your file and its
missing projection and extent information.

I just tried the code using the RQGIS "dem" dataset and everything worked
fine. Also, I?m not sure if "GRASS_REGION_PARAMETER" and
"GRASS_REGION_CELLSIZE_PARAMETER" need to be set at all or you should
better go with the defaults.

If you want to quickly check the algorithm help you can use
`open_help("grass7:r.neighbors")`.

*library(RQGIS)*
*library(raster)*
*r2 <- data("dem")*

*my_env <- set_env()*

*params <- get_args_man(alg = "grass7:r.neighbors", qgis_env = my_env)*
*params$input  <- dem*
*params$method  <- 2 # "Mode"*
*params$output  <- file.path(tempdir(), "rst_out.tif")*

*out <- run_qgis(alg = "grass7:r.neighbors", params = params, *
*                load_output = params$output, qgis_env = my_env)*
*out*

------

macOS, QGIS 2.18.2, GRASS 7.0

You may also want to post such issues at the Github repository
<https://github.com/jannes-m/RQGIS/issues> or at Stackoverflow/GISexchange
using the tag 'rqgis' in the future.
Issues like this which feature large code blocks and are related to a
specific R package can be much better addressed there than by mail.

Best, Patrick





2017-01-21 15:51 GMT+01:00 Ali Santacruz <amsantac at hotmail.com>:

>
> Awesome work! Thanks a lot!
>
>
> I've been able to run QGIS and SAGA algorithms without issues. However, I
> have some problems running GRASS algorithms,
>
> I'm trying to run r.neighbors from GRASS 7, but the resolution, extent and
> values of the output raster don't match those of the input,
>
>
> Here is the code:
>
>
> # Load raster
> library(raster)
>
> r1 <- raster("pred_m1_3000_recl5.tif")
> r1
>
>
> class       : RasterLayer
> dimensions  : 837, 849, 710613  (nrow, ncol, ncell)
> resolution  : 1, 1  (x, y)
> extent      : 0, 849, -837, 0  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> data source : E:\amsantac\dstl\working\pred\pred_m1_3000_recl5.tif
> names       : pred_m1_3000_recl5
> values      : 5, 110  (min, max)
>
>
> # Load RQGIS
> library(RQGIS)
> my_env <- set_env("C:/OSGeo4W64/")
> dir_tmp <- tempdir()
>
>
> # Set parameters for grass7:r.neighbors
> params <- get_args_man(alg = "grass7:r.neighbors", qgis_env = my_env)
> params$input  <- r1
> params$method  <- 2 # "Mode"
> params$output  <- file.path(dir_tmp, "rst_out.tif")
>
> params$GRASS_REGION_PARAMETER <- "0,849,-837,0"    # as xmin, xmax, ymin,
> ymax
> params$GRASS_REGION_CELLSIZE_PARAMETER <- "1.0"
>
> out <- run_qgis(alg = "grass7:r.neighbors", params = params, load_output =
> params$output, qgis_env = my_env)
> out
>
>
> class       : RasterLayer
> dimensions  : 1, 7, 7  (nrow, ncol, ncell)
> resolution  : 0.1519435, 1  (x, y)
> extent      : 0, 1.063604, 0, 1  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
> +towgs84=0,0,0
> data source : C:\Users\Guest\AppData\Local\Temp\RtmpwJu31Y\rst_out.tif
> names       : rst_out
>
>
>
> Note the output only has 1 row, 7 cols (vs. 837 rows, 849 cols in input).
> The CRS has been set as long-lat, while the CRS is NA in the input,
>
>
> Also note that the resolution has been changed from 1 to 0.1519,
>
>
> I wonder if there is an issue on how the params$GRASS_REGION_PARAMETER is
> defined. I have tried different ways eg., "0,849,-837,0" (as xmin, xmax,
> ymin, ymax), "0,-837,849,0" (as xmin, ymin, xmax, ymax), extent(r1) (which
> gives error).
>
>
> The input image (550 kb) can be downloaded from this link:
> https://www.dropbox.com/s/do95t48foepw62e/pred_m1_3000_recl5.tif?dl=0
>
>
>
> Thanks for your help,
>
>
> Best regards,
>
>
> Ali
>
>
>
> sessionInfo()
>
>
> R version 3.3.2 (2016-10-31)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows >= 8 x64 (build 9200)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252    LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C                           LC_TIME=English_United
> States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] RQGIS_0.2.0.9000     raster_2.5-8         sp_1.2-3
>  RevoUtilsMath_10.0.0
>
> loaded via a namespace (and not attached):
> [1] RevoUtils_10.0.2 rgdal_1.1-10     tools_3.3.2      Rcpp_0.12.7
> grid_3.3.2       lattice_0.20-34
>
>
> ________________________________
> De: R-sig-Geo <r-sig-geo-bounces at r-project.org> en nombre de "Jannes
> M?nchow" <malNamalJa at gmx.de>
> Enviado: jueves, 19 de enero de 2017 06:31:34 a. m.
> Para: r-sig-geo at r-project.org
> Asunto: [R-sig-Geo] RQGIS release 0.2.0
>
> Dear list members,
>
> today we are happy to announce a new version of RQGIS! RQGIS establishes
> an interface between R and QGIS, i.e. it allows the user to access the more
> than 1000 QGIS geoalgorithms from within R. The most important news is that
> you can run again the most recent QGIS releases (>=2.18.2) with RQGIS
> without having to modify Python source code. This modification became
> necessary due to a bug introduced in QGIS 2.16 (see
> https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181).
>
> [https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://
> github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>
>
> GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<
> https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>
> github.com
> RQGIS - integrating R with QGIS ... Now that we have a spatial object, we
> can move on to using RQGIS. First of all, we need to specify all the paths
> necessary to run ...
>
>
>
>
> This release fixes also several bugs which we detected thanks to user
> feedback. To learn more about these, please refer to
> https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0.
>
> [https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://
> github.com/jannes-m/RQGIS/releases/tag/v0.2.0>
>
> jannes-m/RQGIS<https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0>
> github.com
> RQGIS - integrating R with QGIS
>
>
>
>
> For more information on RQGIS, how to install it and examples how to use
> RQGIS, please refer to https://github.com/jannes-m/RQGIS and my
> https://jannesm.wordpress.com/category/r/.
>
> Posts about R on jannesm<https://jannesm.wordpress.com/category/r/>
> jannesm.wordpress.com
> Posts about R written by jannesm
>
>
>
> [https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://
> github.com/jannes-m/RQGIS>
>
> GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<
> https://github.com/jannes-m/RQGIS>
> github.com
> RQGIS - integrating R with QGIS ... Now that we have a spatial object, we
> can move on to using RQGIS. First of all, we need to specify all the paths
> necessary to run ...
>
>
>
>
> All the best,
>
> Jannes
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> R-sig-Geo Info Page - ETH Zurich<https://stat.ethz.ch/
> mailman/listinfo/r-sig-geo>
> stat.ethz.ch
> R-sig-Geo -- R Special Interest Group on using Geographical data and
> Mapping About R-sig-Geo
>
>
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From amsantac at hotmail.com  Sat Jan 21 20:43:22 2017
From: amsantac at hotmail.com (Ali Santacruz)
Date: Sat, 21 Jan 2017 19:43:22 +0000
Subject: [R-sig-Geo] RQGIS release 0.2.0
In-Reply-To: <CAE=-a0S-=oEV1=XH+JyrYbqezbtBT4WNsaUqRVc2jX-=POLJ1A@mail.gmail.com>
References: <trinity-601a3a1d-409b-49fa-9388-e02e37dff1c2-1484825494364@3capp-gmx-bs42>
	<MWHPR10MB187253209672B70C69272990C9700@MWHPR10MB1872.namprd10.prod.outlook.com>,
	<CAE=-a0S-=oEV1=XH+JyrYbqezbtBT4WNsaUqRVc2jX-=POLJ1A@mail.gmail.com>
Message-ID: <MWHPR10MB18724EDFCCD213B3DA8F8E4EC9700@MWHPR10MB1872.namprd10.prod.outlook.com>


Dear Patrick,


Thank you very much for your reply.


You're right. It must be an issue with my file. After your email, I tried the example with the dem dataset and it worked well,


Thanks for the other suggestions. I'll keep them in mind,


Best regards,


Ali


________________________________
De: Patrick Schratz <patrick.schratz at gmail.com>
Enviado: s?bado, 21 de enero de 2017 12:16:10 p. m.
Para: Ali Santacruz
Cc: Jannes M?nchow; r-sig-geo at r-project.org
Asunto: Re: [R-sig-Geo] RQGIS release 0.2.0

Dear Ali,

a general note: Please write a new mail if you have a specific problem with a package instead of replying to the last mail related to the package.

Regarding your issue: I think this error relates to your file and its missing projection and extent information.

I just tried the code using the RQGIS "dem" dataset and everything worked fine. Also, I?m not sure if "GRASS_REGION_PARAMETER" and "GRASS_REGION_CELLSIZE_PARAMETER" need to be set at all or you should better go with the defaults.

If you want to quickly check the algorithm help you can use `open_help("grass7:r.neighbors")`.

library(RQGIS)
library(raster)
r2 <- data("dem")

my_env <- set_env()

params <- get_args_man(alg = "grass7:r.neighbors", qgis_env = my_env)
params$input  <- dem
params$method  <- 2 # "Mode"
params$output  <- file.path(tempdir(), "rst_out.tif")

out <- run_qgis(alg = "grass7:r.neighbors", params = params,
                load_output = params$output, qgis_env = my_env)
out

------

macOS, QGIS 2.18.2, GRASS 7.0

You may also want to post such issues at the Github repository<https://github.com/jannes-m/RQGIS/issues> or at Stackoverflow/GISexchange using the tag 'rqgis' in the future.
Issues like this which feature large code blocks and are related to a specific R package can be much better addressed there than by mail.

Best, Patrick





2017-01-21 15:51 GMT+01:00 Ali Santacruz <amsantac at hotmail.com<mailto:amsantac at hotmail.com>>:

[[elided Hotmail spam]]


I've been able to run QGIS and SAGA algorithms without issues. However, I have some problems running GRASS algorithms,

I'm trying to run r.neighbors from GRASS 7, but the resolution, extent and values of the output raster don't match those of the input,


Here is the code:


# Load raster
library(raster)

r1 <- raster("pred_m1_3000_recl5.tif")
r1


class       : RasterLayer
dimensions  : 837, 849, 710613  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : 0, 849, -837, 0  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : E:\amsantac\dstl\working\pred\pred_m1_3000_recl5.tif
names       : pred_m1_3000_recl5
values      : 5, 110  (min, max)


# Load RQGIS
library(RQGIS)
my_env <- set_env("C:/OSGeo4W64/")
dir_tmp <- tempdir()


# Set parameters for grass7:r.neighbors
params <- get_args_man(alg = "grass7:r.neighbors", qgis_env = my_env)
params$input  <- r1
params$method  <- 2 # "Mode"
params$output  <- file.path(dir_tmp, "rst_out.tif")

params$GRASS_REGION_PARAMETER <- "0,849,-837,0"    # as xmin, xmax, ymin, ymax
params$GRASS_REGION_CELLSIZE_PARAMETER <- "1.0"

out <- run_qgis(alg = "grass7:r.neighbors", params = params, load_output = params$output, qgis_env = my_env)
out


class       : RasterLayer
dimensions  : 1, 7, 7  (nrow, ncol, ncell)
resolution  : 0.1519435, 1  (x, y)
extent      : 0, 1.063604, 0, 1  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
data source : C:\Users\Guest\AppData\Local\Temp\RtmpwJu31Y\rst_out.tif
names       : rst_out



Note the output only has 1 row, 7 cols (vs. 837 rows, 849 cols in input). The CRS has been set as long-lat, while the CRS is NA in the input,


Also note that the resolution has been changed from 1 to 0.1519,


I wonder if there is an issue on how the params$GRASS_REGION_PARAMETER is defined. I have tried different ways eg., "0,849,-837,0" (as xmin, xmax, ymin, ymax), "0,-837,849,0" (as xmin, ymin, xmax, ymax), extent(r1) (which gives error).


The input image (550 kb) can be downloaded from this link: https://www.dropbox.com/s/do95t48foepw62e/pred_m1_3000_recl5.tif?dl=0



Thanks for your help,


Best regards,


Ali



sessionInfo()


R version 3.3.2 (2016-10-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)


locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] RQGIS_0.2.0.9000     raster_2.5-8         sp_1.2-3             RevoUtilsMath_10.0.0

loaded via a namespace (and not attached):
[1] RevoUtils_10.0.2 rgdal_1.1-10     tools_3.3.2      Rcpp_0.12.7      grid_3.3.2       lattice_0.20-34


________________________________
De: R-sig-Geo <r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>> en nombre de "Jannes M?nchow" <malNamalJa at gmx.de<mailto:malNamalJa at gmx.de>>
Enviado: jueves, 19 de enero de 2017 06:31:34 a. m.
Para: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Asunto: [R-sig-Geo] RQGIS release 0.2.0

Dear list members,

today we are happy to announce a new version of RQGIS! RQGIS establishes an interface between R and QGIS, i.e. it allows the user to access the more than 1000 QGIS geoalgorithms from within R. The most important news is that you can run again the most recent QGIS releases (>=2.18.2) with RQGIS without having to modify Python source code. This modification became necessary due to a bug introduced in QGIS 2.16 (see https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181).

[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>

GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<https://github.com/jannes-m/RQGIS#rqgis-modifications-v-216-2181>
github.com<http://github.com>
RQGIS - integrating R with QGIS ... Now that we have a spatial object, we can move on to using RQGIS. First of all, we need to specify all the paths necessary to run ...




This release fixes also several bugs which we detected thanks to user feedback. To learn more about these, please refer to https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0.

[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0>

jannes-m/RQGIS<https://github.com/jannes-m/RQGIS/releases/tag/v0.2.0>
github.com<http://github.com>
RQGIS - integrating R with QGIS




For more information on RQGIS, how to install it and examples how to use RQGIS, please refer to https://github.com/jannes-m/RQGIS and my https://jannesm.wordpress.com/category/r/.

Posts about R on jannesm<https://jannesm.wordpress.com/category/r/>
jannesm.wordpress.com<http://jannesm.wordpress.com>
Posts about R written by jannesm



[https://avatars0.githubusercontent.com/u/9986952?v=3&s=400]<https://github.com/jannes-m/RQGIS>

GitHub - jannes-m/RQGIS: RQGIS - integrating R with QGIS<https://github.com/jannes-m/RQGIS>
github.com<http://github.com>
RQGIS - integrating R with QGIS ... Now that we have a spatial object, we can move on to using RQGIS. First of all, we need to specify all the paths necessary to run ...




All the best,

Jannes

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

R-sig-Geo Info Page - ETH Zurich<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
stat.ethz.ch<http://stat.ethz.ch>
R-sig-Geo -- R Special Interest Group on using Geographical data and Mapping About R-sig-Geo




        [[alternative HTML version deleted]]


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Mon Jan 23 17:18:19 2017
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Mon, 23 Jan 2017 17:18:19 +0100
Subject: [R-sig-Geo] Vacancy: Web Services and Geo-computation expert at
 ISRIC --- World Soil Information, Wageningen
Message-ID: <39b24fa7-5db9-5339-4a18-99341e24e625@gmail.com>

Web Services and Geo-computation expert
Published on: January 20, 2017
Location: Wageningen
Scientific field: Natural Sciences
Application deadline: 11 February 2017.

ISRIC --- World Soil Information is looking for a computer scientist / 
software developer specialized in Web Services and Geo-computation with 
affinity for soil information and soil data management. Major duties 
will be to:

- develop web-based services for ISRIC data products, such as WoSIS, 
SoilGrids and future products. This includes the building of user 
interfaces for data export and data import using Web3.0 technologies, 
Web Mapping Services, Web Feature Services and Web Processing Services;
- assist in optimising geo-computation processes (big raster and vector 
data operations) used to develop ISRIC?s global spatial data products;
- assist in installing and optimizing infrastructures for Big Earth Data 
Analytics (Hadoop, SciDB, etc.)
develop distributed systems (e.g. parallel programming, cloud computation);
- maintain and develop a UML schema for XML data exchange in the soil 
domain;

The position will be a full time position on a temporary basis for a 
period of 1.5 years, with a prospect of extension after successful 
evaluation. A part-time assignment of a minimum of 4 days per week is 
negotiable. Salary depends on knowledge and experience with a minimum of 
? 3427,- and a maximum of  ? 5330,- gross per month (Dutch university 
pay scale 11/12), based on full-time (38 hours) employment.

For more info see: 
https://www.wur.nl/en/Jobs/Vacancies/Show/Web-Services-and-Geo-computation-expert.htm

-- 
T. (Tom) Hengl
Researcher @ ISRIC - World Soil Information
Url: http://www.wageningenur.nl/en/Persons/dr.-T-Tom-Hengl.htm
Network: http://profiles.google.com/tom.hengl
Publications: http://scholar.google.com/citations?user=2oYU7S8AAAAJ
ORCID ID: http://orcid.org/0000-0002-9921-5129


From johnwasige at gmail.com  Tue Jan 24 09:23:38 2017
From: johnwasige at gmail.com (John Wasige)
Date: Tue, 24 Jan 2017 11:23:38 +0300
Subject: [R-sig-Geo] Converting raster to a matrix
Message-ID: <CAJgdCD5y+OAHByU+r3wcwN+nBwj1DvTLtVycA-c2ESZKdi+ghA@mail.gmail.com>

?Dear all,
Greetings!

I want to convert a big raster (see attached) a matrix, however, I get the
error below from the script. Anybody with an Idea on what is going wrong in
my script?

###Errors at the following point in the script?

> mat <- as.matrix(rast)Error in .local(x, ...) : 'x' has no values

#####script



?library(raster)
library(rgdal)

setwd('D:/Mobile_testdata')
image <- raster('D:/Mobile_testdata/SOSug_mean2qgis.tif')

rast <-  raster(image)
mat <- as.matrix(rast)

Thanks for your help

Rgds John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SOSug_mean2qgis.tif.aux.xml
Type: text/xml
Size: 1247 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment.xml>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SOSug_mean2qgis.tfw
Type: application/octet-stream
Size: 79 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SOSug_mean2qgis.tif
Type: image/tiff
Size: 4010 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment.tif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SOSug_mean2qgis.tif.vat.cpg
Type: application/octet-stream
Size: 5 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment-0001.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SOSug_mean2qgis.tif.vat.dbf
Type: application/octet-stream
Size: 5498 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/291f6abc/attachment-0002.obj>

From mdsumner at gmail.com  Tue Jan 24 09:41:22 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 24 Jan 2017 08:41:22 +0000
Subject: [R-sig-Geo] Converting raster to a matrix
In-Reply-To: <CAJgdCD5y+OAHByU+r3wcwN+nBwj1DvTLtVycA-c2ESZKdi+ghA@mail.gmail.com>
References: <CAJgdCD5y+OAHByU+r3wcwN+nBwj1DvTLtVycA-c2ESZKdi+ghA@mail.gmail.com>
Message-ID: <CAAcGz9_75B7qTz=voBwV+x6gJ79rpeNK5EEtZB_y3EZs=rrWvw@mail.gmail.com>

What is dim(rast)?

Try raster::readAll(rast) - what happens?

On Tue, Jan 24, 2017, 19:26 John Wasige <johnwasige at gmail.com> wrote:

> ?Dear all,
> Greetings!
>
> I want to convert a big raster (see attached) a matrix, however, I get the
> error below from the script. Anybody with an Idea on what is going wrong in
> my script?
>
> ###Errors at the following point in the script?
>
> > mat <- as.matrix(rast)Error in .local(x, ...) : 'x' has no values
>
> #####script
>
>
>
> ?library(raster)
> library(rgdal)
>
> setwd('D:/Mobile_testdata')
> image <- raster('D:/Mobile_testdata/SOSug_mean2qgis.tif')
>
> rast <-  raster(image)
> mat <- as.matrix(rast)
>
> Thanks for your help
>
> Rgds John
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> University of Tasmania Electronic Communications Policy (December, 2014).
> This email is confidential, and is for the intended recipient only.
> Access, disclosure, copying, distribution, or reliance on any of it by
> anyone outside the intended recipient organisation is prohibited and may be
> a criminal offence. Please delete if obtained in error and email
> confirmation to the sender. The views expressed in this email are not
> necessarily the views of the University of Tasmania, unless clearly
> intended otherwise.
> .
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Tue Jan 24 15:19:36 2017
From: btupper at bigelow.org (Ben Tupper)
Date: Tue, 24 Jan 2017 09:19:36 -0500
Subject: [R-sig-Geo] Converting raster to a matrix
In-Reply-To: <CAJgdCD5y+OAHByU+r3wcwN+nBwj1DvTLtVycA-c2ESZKdi+ghA@mail.gmail.com>
References: <CAJgdCD5y+OAHByU+r3wcwN+nBwj1DvTLtVycA-c2ESZKdi+ghA@mail.gmail.com>
Message-ID: <6274CAB4-526C-4EC3-8408-C217325DB16A@bigelow.org>

Hi,

It doesn't seem to be noted in the documentation for raster::raster(), but when you create a RasterLayer from a RasterLayer,  as in your

> rast <-  raster(image)

step, the values are stripped from the resulting RasterLayer.  Why don't you eliminate that step and retrieve the matrix from your first RasterLayer?

> mat <- as.matrix(image)
> str(mat)
 int [1:68, 1:65] NA NA NA NA NA NA NA NA NA NA ...

Ben




> On Jan 24, 2017, at 3:23 AM, John Wasige <johnwasige at gmail.com> wrote:
> 
> ?Dear all,
> Greetings!
> 
> I want to convert a big raster (see attached) a matrix, however, I get the error below from the script. Anybody with an Idea on what is going wrong in my script?
> 
> ###Errors at the following point in the script?
> 
> > mat <- as.matrix(rast)
> Error in .local(x, ...) : 'x' has no values
> 
> #####script
> 
> 
> ?library(raster)
> library(rgdal)
> 
> setwd('D:/Mobile_testdata')
> image <- raster('D:/Mobile_testdata/SOSug_mean2qgis.tif')
> 
> rast <-  raster(image)
> mat <- as.matrix(rast)
> 
> Thanks for your help
> 
> Rgds John
> 
> <SOSug_mean2qgis.tif.aux.xml><SOSug_mean2qgis.tfw><SOSug_mean2qgis.tif><SOSug_mean2qgis.tif.vat.cpg><SOSug_mean2qgis.tif.vat.dbf>_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org




	[[alternative HTML version deleted]]


From agsubir at gmail.com  Tue Jan 24 16:53:52 2017
From: agsubir at gmail.com (Subir Paul)
Date: Tue, 24 Jan 2017 21:23:52 +0530
Subject: [R-sig-Geo] Help regarding Autoencoder
Message-ID: <CAGEYEEFhu6LDv5a5hUx_5nfkr6aMYMeHQ3OAeB5xRdcL1ThgNA@mail.gmail.com>

Dear All,
I was using "SAENET" package for autoencoding.
I used the following code:
h=SAENET.train(data[,1:200], n.nodes = c(100, 20), unit.type =
("logistic"), lambda = 0.001,
               beta = 0.0001, rho = 0.01, epsilon = 0.01, optim.method =
c("BFGS"),
               rel.tol=sqrt(.Machine$double.eps), max.iterations = 1000)
But its showing the error:
Error in optim(par = theta, fn = J.theta, gr = grad.theta.J, method =
optimizer,  :
  initial value in 'vmmin' is not finite

Can anyone help me regarding this issue?

Thanks in advance.

*With Regards*
*Subir Paul*
*Research Scholar (PhD)*
*Water Resources & Env. Engg.*

*Department of Civil Engineering*
*Indian Institute of Science, Bengaluru*

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Tue Jan 24 19:11:43 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 24 Jan 2017 19:11:43 +0100
Subject: [R-sig-Geo] Help regarding Autoencoder
In-Reply-To: <CAGEYEEFhu6LDv5a5hUx_5nfkr6aMYMeHQ3OAeB5xRdcL1ThgNA@mail.gmail.com>
References: <CAGEYEEFhu6LDv5a5hUx_5nfkr6aMYMeHQ3OAeB5xRdcL1ThgNA@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1701241907220.10795@reclus.nhh.no>

On Tue, 24 Jan 2017, Subir Paul wrote:

> Dear All,
> I was using "SAENET" package for autoencoding.
> I used the following code:
> h=SAENET.train(data[,1:200], n.nodes = c(100, 20), unit.type =
> ("logistic"), lambda = 0.001,
>               beta = 0.0001, rho = 0.01, epsilon = 0.01, optim.method =
> c("BFGS"),
>               rel.tol=sqrt(.Machine$double.eps), max.iterations = 1000)
> But its showing the error:
> Error in optim(par = theta, fn = J.theta, gr = grad.theta.J, method =
> optimizer,  :
>  initial value in 'vmmin' is not finite
>
> Can anyone help me regarding this issue?

Try saying debug(SAENET.train) and stepping through to see what initial 
value is being passed to optim for vmmin. It may be an issue with your 
input data, or it may be something in the function that makes unmet 
assumptions about your data. Running traceback() after such an error 
probably will only show that optim is being passed a a non-finite value 
(divide by zero, log of zero?). Consider asking the package maintainer, 
and if possible provide a small, reproducible example.

Hope this helps,

Roger

>
> Thanks in advance.
>
> *With Regards*
> *Subir Paul*
> *Research Scholar (PhD)*
> *Water Resources & Env. Engg.*
>
> *Department of Civil Engineering*
> *Indian Institute of Science, Bengaluru*
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From martazores at gmail.com  Tue Jan 24 21:06:46 2017
From: martazores at gmail.com (marta azores)
Date: Tue, 24 Jan 2017 19:06:46 -0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>
References: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
	<permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
	<CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>
Message-ID: <CAE3WKgTo5+yb10rgQZkf+OgKjEjo5UCK-TffAJLjW609Q1ZDMA@mail.gmail.com>

Hi guys,

I'm still trying to solve my deal. How I can join the survey boat points
using the shortestpath function, to avoid the land. It's important because
I need an output "spatialLines"(boat surveys) to intersect with points(
species points).
I add several files : script and other layers of information.

Thanks in advance,

Marta

2017-01-16 9:45 GMT-01:00 marta azores <martazores at gmail.com>:

> Hi Jerome,
>
> There are several R packages to join points. However, I have two relevant
> issues with them.
>  -The first,  I need to get the "Lines" from these tracks in "spatial
> Lines". For example, in the adehabitatLT package you can get easily the
> trajectories of the animal but with the class " ltraj". I don't know
>    how transform this object class into spatial lines.
> -The second, when I made the tracks I need to avoid the coast, and I don't
> know how do that in adehabitatLT.
>
> Any idea?
>
> Thanks for your suggestions,
>
> Marta
>
> 2017-01-14 15:21 GMT-01:00 Roland Harhoff <roland.harhoff at uni-muenster.de>
> :
>
>> Hi Marta,
>>
>> and did you check the trajectories package ...?
>>
>> https://cran.r-project.org/web/packages/trajectories/index.html
>>
>> Cheers!
>> Roland
>>
>>
>> J?rome Mathieu schrieb am 2017-01-14:
>> > Hi,
>>
>> > Did you have a look at the package adehabitatLT?
>>
>> > https://cran.r-project.org/web/packages/adehabitatLT/vignett
>> es/adehabitatLT.pdf
>>
>> > It deals with trajectories based on points ordered by date.
>>
>> > Jerome
>>
>>
>> > 2017-01-13 11:41 GMT+01:00 marta azores <martazores at gmail.com>:
>>
>> > > Thanks for your quick reply to my question,
>> > >
>> > > This ten points are ordered by time (date + time), and I know ,the
>> points
>> > > are all connected.  I didn't include the column with the time in this
>> > > example, to make it simple.
>> > >
>> > > After read your messages, I was looking the minimum spanning tree for
>> the
>> > > vertices.
>> > > The advantage with the function "shortestPath" is that you have as
>> result a
>> > > spatial line output, which I need it.
>> > > However, the minimum spanning tree give as output an ordiplot.
>> > >
>> > > Is it possible to transform the ordiplot into spatialLines?
>> > >
>> > > Thanks for your answers
>> > >
>> > > Marta
>> > >
>> > >
>> > >
>> > > 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org>:
>> > >
>> > > > Generically independent of R, A graph and the connectivity between
>> points
>> > > > needs defined before a shortest path algorithm can be applied.  If
>> it
>> > > > assumes all points are connected, than the shortest path will be a
>> > > straight
>> > > > line.  What you are looking for is some sort of  minimum spanning
>> tree
>> > > for
>> > > > the vertices.
>> > > > Eric
>> > > >
>> > > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores <
>> martazores at gmail.com>
>> > > > wrote:
>> > > >
>> > > >> Dear forum members,
>> > > >>
>> > > >> I would like to know how join several points with the aim to track
>> a
>> > > ship.
>> > > >>
>> > > >> After reading the documentation of some packages, I decided to use
>> the
>> > > >> function shortestPath, but I only got the line between the first
>> and the
>> > > >> last location of my points list. I need the complete survey,
>> including
>> > > also
>> > > >> the middle points. I try a loop to build the survey of the boats
>> using
>> > > >> their locations, but It didn't work to me.
>> > > >>
>> > > >>
>> > > >> Any idea?
>> > > >>
>> > > >> Thanks in advance,
>> > > >>
>> > > >> Marta
>> > > >>
>> > > >> #script# it's also attached in a R.file: question loop2.R
>> > > >> ##########################################################
>> > > >> #
>> > > >> #raster# it's attached
>> > > >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
>> > > >> #
>> > > >> #10 points# it's attached
>> > > >> boat <- read.table("C:/Users/Documents/10pontos.csv", header=TRUE,
>> > > >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
>> > > >> head(boat)
>> > > >>
>> > > >> #raster to transitionlayer
>> > > >> trCostS4<- transition(1/azoTS1, mean, directions=4)
>> > > >>
>> > > >> # points to spatialpointsdataframe
>> > > >> x=boat$Long1
>> > > >> y=boat$Lat1
>> > > >> coords = cbind(x, y)
>> > > >> plot(coords)
>> > > >> sp = SpatialPoints(coords, proj4string=CRS("+proj=longlat
>> +ellps=WGS84
>> > > >> +datum=WGS84"), bbox = NULL)
>> > > >> sp
>> > > >> spdf=SpatialPointsDataFrame(sp,boat)
>> > > >> spdf
>> > > >> nrow(spdf)
>> > > >> plot(sp,axes=TRUE)
>> > > >> plot(spdf,add=TRUE, axes=TRUE)
>> > > >>
>> > > >> #shortestpath
>> > > >>
>> > > >> ## 1) this script only join the first point of the list and the
>> last
>> > > one,
>> > > >> and the points in the middle are not used.
>> > > >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
>> > > >> output="SpatialLines")
>> > > >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png (it's
>> attached)
>> > > >>
>> > > >> ## 2) this script didn't work to me
>> > > >>
>> > > >> #first way from website: http://stackoverflow.com/quest
>> > > >> ions/8127066/loop-or-sapply-function-for-multiple-least-
>> > > >> cost-analysis-in-r?answertab=active#tab-top
>> > > >> for(i in 1:nrow(spdf)) {
>> > > >>   # Computation
>> > > >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
>> > > >> output="SpatialLines")
>> > > >>   plot(Costpath)
>> > > >>
>> > > >> }
>> > > >>
>> > > >> #Error in validObject(.Object) :
>> > > >> #invalid class ?SpatialLines? object: bbox should never contain
>> infinite
>> > > >> values
>> > > >>
>> > > >> _______________________________________________
>> > > >> R-sig-Geo mailing list
>> > > >> R-sig-Geo at r-project.org
>> > > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > > >>
>> > > >
>> > > >
>> > >
>> > >         [[alternative HTML version deleted]]
>> > >
>> > > _______________________________________________
>> > > R-sig-Geo mailing list
>> > > R-sig-Geo at r-project.org
>> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > >
>>
>>
>>
>> > --
>> > J?r?me Mathieu <http://www.jerome-mathieu.com/>
>> > Universit? Pierre & Marie Curie <http://www.upmc.fr/>
>> > Institute of Ecology and Environmental Science (Paris)
>> > <https://ieesparis.ufr918.upmc.fr/>
>> > Team EERI
>>
>> > 4 place Jussieu
>> > Tour 44-45, 5th floor, door 514
>> > 75005 Paris
>>
>> > tel: 01 44 27 34 22
>>
>> >       [[alternative HTML version deleted]]
>>
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/fef9941f/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: azoTS1.tif
Type: image/tiff
Size: 1841 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/fef9941f/attachment.tif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: boat2905.csv
Type: text/csv
Size: 585 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/fef9941f/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: question4.R
Type: application/octet-stream
Size: 4659 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/fef9941f/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sp2pontosDT.csv
Type: text/csv
Size: 107 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170124/fef9941f/attachment-0001.bin>

From tristan.bourgeois at gmail.com  Wed Jan 25 11:02:54 2017
From: tristan.bourgeois at gmail.com (Tristan Bourgeois)
Date: Wed, 25 Jan 2017 11:02:54 +0100
Subject: [R-sig-Geo] Distance calculating between points according to a
	river network
Message-ID: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>

Hi,

I'm a R new user and this is also my first post on this mailing list.

I'm currently working on several project with R and I still have not found
a solution for one :

To be concise I'm working with shapefiles representing on a delimited area :

- sewage plant (SpatialPointsDataFrame)
- water quality measurement stations (SpatialPointsDataFrame)
- hydrographic network (SpatialLineDataFrame)

What I want to do is to calculate the distance between each sewage stations
and each measurement stations following the river route.

For now, I have snapped all my points on the river and created a new layer
with both type of point (sewage stations and measurement) in order to split
the lines by the point layer.

I'm looking for a way to get a kind of distance's matrix.

Does anybody has already worked on a similar project ? I'm kind of lost
with all the R packages and functions so any pistes or proposals or idea
will be greatly appreciate.


PS : As I said this is my first post. If I'm not clear about my issue or if
I'm not respecting any posting rules don't hesitate to tell me about.


Cheers


-- 
Tristan Bourgeois
Hydromorphologist
Water Agency of Seine-Normandie Basin

	[[alternative HTML version deleted]]


From reudenbach at uni-marburg.de  Wed Jan 25 11:02:48 2017
From: reudenbach at uni-marburg.de (Chris Reudenbach)
Date: Wed, 25 Jan 2017 11:02:48 +0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgTo5+yb10rgQZkf+OgKjEjo5UCK-TffAJLjW609Q1ZDMA@mail.gmail.com>
References: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
	<permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
	<CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>
	<CAE3WKgTo5+yb10rgQZkf+OgKjEjo5UCK-TffAJLjW609Q1ZDMA@mail.gmail.com>
Message-ID: <367a0b6d-bd14-2bdc-8a4e-8c93213849e0@uni-marburg.de>

Marta,

your problem seems to me more conceptual. The shortestPath 
implementation of a cost analysis is not exactly want you want. You 
would choose it if you have to find an unknown path on a friction 
surface. You would not choose it if you just want to link positions. The 
shortestPath of your implementation can not avoid to touch the island 
because you force it to go there. It is a bit more "expensive" in your 
case 2 units but not forbidden.

Nevertheless there are also some technical issues to address: Even if if 
there is a correction for unprojected data sets it is better to project 
them because it is more stable to calculate cost on an equal area 
projection. Than the spatial resolution of the cost raster should be 
sufficient to meet the distance of the points.

You will find below the example code. Note that I assume that the data 
is an directory as defined by "path_data".

The "path will be plotted consecutively in the plotting window.

hope this clarifies

cheers Chris

#question 4
library(sp)
library(maptools)
library(rgeos)
library(mapview)
library(robubu)
library(raster)

### define data folder
path_data<-"~/proj/boats/data/"

### boat points the locations of the boats are sort by date and time!
boat <- read.table(paste0(path_data,"boat2905.csv"), header=TRUE, 
sep=",", na.strings="NA", dec=".", strip.white=TRUE)
pos<-as.data.frame(cbind(boat$Lat1,boat$Long1))
sp::coordinates(pos) <- ~V2+V1
sp::proj4string(pos) <-CRS("+proj=longlat +datum=WGS84 +no_defs")

### project it to somewhat equal area
boatSP <- sp::spTransform(pos, CRS("+proj=laea +lat_0=30 +lon_0=-30 
+x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))

# cost raster sea and island
azoTS1<- raster::raster(paste0(path_data,"azoTS1.tif"))

### project it to somewhat equal area
azoTS1<- raster::projectRaster(azoTS1,  crs="+proj=laea +lat_0=30 
+lon_0=-30 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs")

###scale  real cost file -> makes it MUCH more expansive to sail over 
land surfaces
azoTS1[azoTS1 ==2]<-100

### increase the spatial resolution
costraw<-disaggregate(azoTS1,fact=c(10, 10))

# prepare it for analysis
transition<- gdistance::transition(1/costraw, mean, directions=8)
trCostS16 <- gdistance::geoCorrection(transition, type="c")

### run first analysis -> will link all boat positions
### note it will NOT avoid sailing over land because it is forced to do 
so by setting the last position on the (rasterized) island
raster::plot(azoTS1)
pathwaylist<- lapply(seq(2:length(boatSP)), function(i){
   costpath<- try(shortestPath(trCostS16, 
boatSP at coords[i,],boatSP at coords[i-1,], output="SpatialLines"),silent = TRUE)
   lines(costpath)
})

### now we import the species point
### just for showing that the cost analysis will work
spcs <- read.table(paste0(path_data,"/sp2pontosDT.csv"), header=TRUE, 
sep=",", na.strings="NA", dec=".", strip.white=TRUE)#Bom test
sp::coordinates(spcs) <- ~Long1+Lat
sp::proj4string(spcs) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
spcsSP <- sp::spTransform(spcs, CRS("+proj=laea +lat_0=30 +lon_0=-30 
+x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))

### run second analysis -> will link all the two species positions
raster::plot(azoTS1)
pathwaylist<- lapply(seq(2:length(spcsSP)), function(i){
   costpath<- try(shortestPath(trCostS16, 
spcsSP at coords[i,],spcsSP at coords[i-1,], output="SpatialLines"),silent = TRUE)
   lines(costpath)
})



On 24.01.2017 21:06, marta azores wrote:
> Hi guys,
>
> I'm still trying to solve my deal. How I can join the survey 
> boat points using the shortestpath function, to avoid the land. It's 
> important because  I need an output "spatialLines"(boat surveys) to 
> intersect with points( species points).
> I add several files : script and other layers of information.
>
> Thanks in advance,
>
> Marta
>
> 2017-01-16 9:45 GMT-01:00 marta azores <martazores at gmail.com 
> <mailto:martazores at gmail.com>>:
>
>     Hi Jerome,
>
>     There are several R packages to join points. However, I have two
>     relevant issues with them.
>      -The first,  I need to get the "Lines" from these tracks in
>     "spatial Lines". For example, in the adehabitatLT package you can
>     get easily the trajectories of the animal but with the class "
>     ltraj". I don't know
>        how transform this object class into spatial lines.
>     -The second, when I made the tracks I need to avoid the coast, and
>     I don't know how do that in adehabitatLT.
>
>     Any idea?
>
>     Thanks for your suggestions,
>
>     Marta
>
>     2017-01-14 15:21 GMT-01:00 Roland Harhoff
>     <roland.harhoff at uni-muenster.de
>     <mailto:roland.harhoff at uni-muenster.de>>:
>
>         Hi Marta,
>
>         and did you check the trajectories package ...?
>
>         https://cran.r-project.org/web/packages/trajectories/index.html
>         <https://cran.r-project.org/web/packages/trajectories/index.html>
>
>         Cheers!
>         Roland
>
>
>         J?rome Mathieu schrieb am 2017-01-14:
>         > Hi,
>
>         > Did you have a look at the package adehabitatLT?
>
>         >
>         https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf
>         <https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf>
>
>         > It deals with trajectories based on points ordered by date.
>
>         > Jerome
>
>
>         > 2017-01-13 11:41 GMT+01:00 marta azores
>         <martazores at gmail.com <mailto:martazores at gmail.com>>:
>
>         > > Thanks for your quick reply to my question,
>         > >
>         > > This ten points are ordered by time (date + time), and I
>         know ,the points
>         > > are all connected.  I didn't include the column with the
>         time in this
>         > > example, to make it simple.
>         > >
>         > > After read your messages, I was looking the minimum
>         spanning tree for the
>         > > vertices.
>         > > The advantage with the function "shortestPath" is that you
>         have as result a
>         > > spatial line output, which I need it.
>         > > However, the minimum spanning tree give as output an ordiplot.
>         > >
>         > > Is it possible to transform the ordiplot into spatialLines?
>         > >
>         > > Thanks for your answers
>         > >
>         > > Marta
>         > >
>         > >
>         > >
>         > > 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org
>         <mailto:carr at nimbios.org>>:
>         > >
>         > > > Generically independent of R, A graph and the
>         connectivity between points
>         > > > needs defined before a shortest path algorithm can be
>         applied.  If it
>         > > > assumes all points are connected, than the shortest path
>         will be a
>         > > straight
>         > > > line.  What you are looking for is some sort of  minimum
>         spanning tree
>         > > for
>         > > > the vertices.
>         > > > Eric
>         > > >
>         > > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores
>         <martazores at gmail.com <mailto:martazores at gmail.com>>
>         > > > wrote:
>         > > >
>         > > >> Dear forum members,
>         > > >>
>         > > >> I would like to know how join several points with the
>         aim to track a
>         > > ship.
>         > > >>
>         > > >> After reading the documentation of some packages, I
>         decided to use the
>         > > >> function shortestPath, but I only got the line between
>         the first and the
>         > > >> last location of my points list. I need the complete
>         survey, including
>         > > also
>         > > >> the middle points. I try a loop to build the survey of
>         the boats using
>         > > >> their locations, but It didn't work to me.
>         > > >>
>         > > >>
>         > > >> Any idea?
>         > > >>
>         > > >> Thanks in advance,
>         > > >>
>         > > >> Marta
>         > > >>
>         > > >> #script# it's also attached in a R.file: question loop2.R
>         > > >> ##########################################################
>         > > >> #
>         > > >> #raster# it's attached
>         > > >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
>         > > >> #
>         > > >> #10 points# it's attached
>         > > >> boat <- read.table("C:/Users/Documents/10pontos.csv",
>         header=TRUE,
>         > > >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
>         > > >> head(boat)
>         > > >>
>         > > >> #raster to transitionlayer
>         > > >> trCostS4<- transition(1/azoTS1, mean, directions=4)
>         > > >>
>         > > >> # points to spatialpointsdataframe
>         > > >> x=boat$Long1
>         > > >> y=boat$Lat1
>         > > >> coords = cbind(x, y)
>         > > >> plot(coords)
>         > > >> sp = SpatialPoints(coords,
>         proj4string=CRS("+proj=longlat +ellps=WGS84
>         > > >> +datum=WGS84"), bbox = NULL)
>         > > >> sp
>         > > >> spdf=SpatialPointsDataFrame(sp,boat)
>         > > >> spdf
>         > > >> nrow(spdf)
>         > > >> plot(sp,axes=TRUE)
>         > > >> plot(spdf,add=TRUE, axes=TRUE)
>         > > >>
>         > > >> #shortestpath
>         > > >>
>         > > >> ## 1) this script only join the first point of the list
>         and the last
>         > > one,
>         > > >> and the points in the middle are not used.
>         > > >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,], spdf[10,],
>         > > >> output="SpatialLines")
>         > > >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png
>         (it's attached)
>         > > >>
>         > > >> ## 2) this script didn't work to me
>         > > >>
>         > > >> #first way from website: http://stackoverflow.com/quest
>         > > >> ions/8127066/loop-or-sapply-function-for-multiple-least-
>         > > >> cost-analysis-in-r?answertab=active#tab-top
>         > > >> for(i in 1:nrow(spdf)) {
>         > > >>   # Computation
>         > > >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
>         > > >> output="SpatialLines")
>         > > >>   plot(Costpath)
>         > > >>
>         > > >> }
>         > > >>
>         > > >> #Error in validObject(.Object) :
>         > > >> #invalid class ?SpatialLines? object: bbox should never
>         contain infinite
>         > > >> values
>         > > >>
>         > > >> _______________________________________________
>         > > >> R-sig-Geo mailing list
>         > > >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         > > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>         > > >>
>         > > >
>         > > >
>         > >
>         > >         [[alternative HTML version deleted]]
>         > >
>         > > _______________________________________________
>         > > R-sig-Geo mailing list
>         > > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>         > >
>
>
>
>         > --
>         > J?r?me Mathieu <http://www.jerome-mathieu.com/
>         <http://www.jerome-mathieu.com/>>
>         > Universit? Pierre & Marie Curie <http://www.upmc.fr/>
>         > Institute of Ecology and Environmental Science (Paris)
>         > <https://ieesparis.ufr918.upmc.fr/
>         <https://ieesparis.ufr918.upmc.fr/>>
>         > Team EERI
>
>         > 4 place Jussieu
>         > Tour 44-45, 5th floor, door 514
>         > 75005 Paris
>
>         > tel: 01 44 27 34 22
>
>         >    [[alternative HTML version deleted]]
>
>         > _______________________________________________
>         > R-sig-Geo mailing list
>         > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From mirzaceng at gmail.com  Wed Jan 25 11:57:18 2017
From: mirzaceng at gmail.com (Mirza Cengic)
Date: Wed, 25 Jan 2017 11:57:18 +0100
Subject: [R-sig-Geo] Distance calculating between points according to a
 river network
In-Reply-To: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
References: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
Message-ID: <CAJAunfeDk7MFy2A0qQ-37RrqVEYWXBZFSO7jO4VaMwU1ewMAyw@mail.gmail.com>

Hi Tristan,

I recently had to do something similar (calculating distance to the next
downstream point), and I was not able to find a solution with R that would
deal with the direction of the flow. Perhaps someone who has deeper
understanding of packages such as iGraph etc. might be able to find a
solution, but I wasn't.
I solved the problem with ArcMap, using HydroTools extension, where you
need to define a geometric network that has a direction, and then the
calculation is pretty straightforward with HydroTools (let me know if you
need more info).
I would prefer to have a scripted solution in an open-source software, but
this worked for me in any case. If anyone has a better way for solving
this, I would love to see how!

Cheers,
Mirza.

	[[alternative HTML version deleted]]


From fabnicola at hotmail.fr  Wed Jan 25 12:01:35 2017
From: fabnicola at hotmail.fr (Nicolas Fabre)
Date: Wed, 25 Jan 2017 11:01:35 +0000
Subject: [R-sig-Geo] unsuscribe
Message-ID: <AM5PR10MB0595E2C98323041A269BCA5DD9740@AM5PR10MB0595.EURPRD10.PROD.OUTLOOK.COM>



	[[alternative HTML version deleted]]


From FloBetz at web.de  Wed Jan 25 12:15:58 2017
From: FloBetz at web.de (Florian Betz)
Date: Wed, 25 Jan 2017 12:15:58 +0100
Subject: [R-sig-Geo] Distance calculating between points according to a
 river network
In-Reply-To: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
References: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
Message-ID: <994e6d7a-3693-1ab3-b66d-97d11f3697be@web.de>

Dear Tristan,

no R solution, but maybe a starting point: You can check out the Grass 
GIS tool v.net.distance 
(https://grass.osgeo.org/grass72/manuals/v.net.distance) what should 
help you. GRASS tools can also be integrated in R via the rgrass7 package.

Good luck!

Flo

Am 25.01.2017 um 11:02 schrieb Tristan Bourgeois:
> Hi,
>
> I'm a R new user and this is also my first post on this mailing list.
>
> I'm currently working on several project with R and I still have not found
> a solution for one :
>
> To be concise I'm working with shapefiles representing on a delimited area :
>
> - sewage plant (SpatialPointsDataFrame)
> - water quality measurement stations (SpatialPointsDataFrame)
> - hydrographic network (SpatialLineDataFrame)
>
> What I want to do is to calculate the distance between each sewage stations
> and each measurement stations following the river route.
>
> For now, I have snapped all my points on the river and created a new layer
> with both type of point (sewage stations and measurement) in order to split
> the lines by the point layer.
>
> I'm looking for a way to get a kind of distance's matrix.
>
> Does anybody has already worked on a similar project ? I'm kind of lost
> with all the R packages and functions so any pistes or proposals or idea
> will be greatly appreciate.
>
>
> PS : As I said this is my first post. If I'm not clear about my issue or if
> I'm not respecting any posting rules don't hesitate to tell me about.
>
>
> Cheers
>
>


From tristan.bourgeois at gmail.com  Wed Jan 25 14:22:04 2017
From: tristan.bourgeois at gmail.com (Tristan Bourgeois)
Date: Wed, 25 Jan 2017 14:22:04 +0100
Subject: [R-sig-Geo] Distance calculating between points according to a
 river network
In-Reply-To: <CAJAunfeDk7MFy2A0qQ-37RrqVEYWXBZFSO7jO4VaMwU1ewMAyw@mail.gmail.com>
References: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
	<CAJAunfeDk7MFy2A0qQ-37RrqVEYWXBZFSO7jO4VaMwU1ewMAyw@mail.gmail.com>
Message-ID: <CACNjsfVYigqS49xCvnw5xHKbevi65M4ShSvdZoZ7uemvT5Y+dw@mail.gmail.com>

Hi Mirza,

Thanks for your quick answer.

Actually I don't want to calculate distance between a point and the next
downstream one.
For example, if there are 4 sewage plant on a river and 7 measurment
stations,I want the distance between each sewage plant and each station.
(water pollution dispersion calculation).
So the flow direction is not that important in my case. The difficulty is
to get the distance between a point and another one following the river
polyline.

In your case, you can add a raster layer with elevation values ans extract
the elevation  for each point of your layer.  Then, for each polyline it is
possible to define a flow direction.
Hope it will help you.




2017-01-25 11:57 GMT+01:00 Mirza Cengic <mirzaceng at gmail.com>:

> Hi Tristan,
>
> I recently had to do something similar (calculating distance to the next
> downstream point), and I was not able to find a solution with R that would
> deal with the direction of the flow. Perhaps someone who has deeper
> understanding of packages such as iGraph etc. might be able to find a
> solution, but I wasn't.
> I solved the problem with ArcMap, using HydroTools extension, where you
> need to define a geometric network that has a direction, and then the
> calculation is pretty straightforward with HydroTools (let me know if you
> need more info).
> I would prefer to have a scripted solution in an open-source software, but
> this worked for me in any case. If anyone has a better way for solving
> this, I would love to see how!
>
> Cheers,
> Mirza.
>



-- 
Tristan Bourgeois

	[[alternative HTML version deleted]]


From jason_romine at fws.gov  Wed Jan 25 17:31:50 2017
From: jason_romine at fws.gov (Romine, Jason)
Date: Wed, 25 Jan 2017 08:31:50 -0800
Subject: [R-sig-Geo] Distance calculating between points according to a
 river network
In-Reply-To: <CACNjsfVYigqS49xCvnw5xHKbevi65M4ShSvdZoZ7uemvT5Y+dw@mail.gmail.com>
References: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
	<CAJAunfeDk7MFy2A0qQ-37RrqVEYWXBZFSO7jO4VaMwU1ewMAyw@mail.gmail.com>
	<CACNjsfVYigqS49xCvnw5xHKbevi65M4ShSvdZoZ7uemvT5Y+dw@mail.gmail.com>
Message-ID: <CAJRFCsvKx+g1ukXYPSm_Wsvu7x34+DBO+QUjCo6noxEw-rVFzg@mail.gmail.com>

The gdistance package in R is what you are looking for:

https://cran.r-project.org/web/packages/gdistance/gdistance.pdf

https://cran.r-project.org/web/packages/gdistance/vignettes/gdistance1.pdf

Best,
Jason

On Wed, Jan 25, 2017 at 5:22 AM, Tristan Bourgeois <
tristan.bourgeois at gmail.com> wrote:

> Hi Mirza,
>
> Thanks for your quick answer.
>
> Actually I don't want to calculate distance between a point and the next
> downstream one.
> For example, if there are 4 sewage plant on a river and 7 measurment
> stations,I want the distance between each sewage plant and each station.
> (water pollution dispersion calculation).
> So the flow direction is not that important in my case. The difficulty is
> to get the distance between a point and another one following the river
> polyline.
>
> In your case, you can add a raster layer with elevation values ans extract
> the elevation  for each point of your layer.  Then, for each polyline it is
> possible to define a flow direction.
> Hope it will help you.
>
>
>
>
> 2017-01-25 11:57 GMT+01:00 Mirza Cengic <mirzaceng at gmail.com>:
>
> > Hi Tristan,
> >
> > I recently had to do something similar (calculating distance to the next
> > downstream point), and I was not able to find a solution with R that
> would
> > deal with the direction of the flow. Perhaps someone who has deeper
> > understanding of packages such as iGraph etc. might be able to find a
> > solution, but I wasn't.
> > I solved the problem with ArcMap, using HydroTools extension, where you
> > need to define a geometric network that has a direction, and then the
> > calculation is pretty straightforward with HydroTools (let me know if you
> > need more info).
> > I would prefer to have a scripted solution in an open-source software,
> but
> > this worked for me in any case. If anyone has a better way for solving
> > this, I would love to see how!
> >
> > Cheers,
> > Mirza.
> >
>
>
>
> --
> Tristan Bourgeois
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
----------------------------------------------------------------------------------
Jason Romine, Ph.D.
Fish and Wildlife Biologist
U.S. Fish & Wildlife Service
Mid-Columbia River National Wildlife Refuge Complex
64 Maple St
Burbank, WA 99323
Cell: 509-792-0123
https://www.fws.gov/mcriver/
Projects, publications, CV <https://jasongromine.wordpress.com/>
----------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From reudenbach at uni-marburg.de  Wed Jan 25 19:42:44 2017
From: reudenbach at uni-marburg.de (Chris Reudenbach)
Date: Wed, 25 Jan 2017 19:42:44 +0100
Subject: [R-sig-Geo] Distance calculating between points according to a
 river network
In-Reply-To: <CAJRFCsvKx+g1ukXYPSm_Wsvu7x34+DBO+QUjCo6noxEw-rVFzg@mail.gmail.com>
References: <CACNjsfVSgdqPqU65WrTvjVwEZT84HpxO_9jO+RRZ46jdYhZkog@mail.gmail.com>
	<CAJAunfeDk7MFy2A0qQ-37RrqVEYWXBZFSO7jO4VaMwU1ewMAyw@mail.gmail.com>
	<CACNjsfVYigqS49xCvnw5xHKbevi65M4ShSvdZoZ7uemvT5Y+dw@mail.gmail.com>
	<CAJRFCsvKx+g1ukXYPSm_Wsvu7x34+DBO+QUjCo6noxEw-rVFzg@mail.gmail.com>
Message-ID: <510c4475-589a-8140-fef8-3c8bae42af4f@uni-marburg.de>

Tristan,

if I understand you right you just want to calculate the distances. So 
no hydro stuff like accumulation flow directions etc.? As well as no 
diffusion modeling of the pollutants.

Most of the traditional vector based GIS stuff is packed into the rgeos 
package. So you might calculated the distances along a graph like in the 
following paste and copy snippet.

cheers Chris



library(rgeos)
library(sp)
# just for visualisation
r <- raster(nrows=6, ncols=7, xmn=0, xmx=7, ymn=0, ymx=6, crs="+proj=utm 
+units=m")
r[] <- c(1, 0, 1, 0, 1, 0, 1,
          0, 1, 0, 1, 0, 1, 0,
          1, 0, 1, 0, 1, 0, 1,
          0, 1, 0, 1, 0, 1, 0,
          1, 0, 1, 0, 1, 0, 1,
          0, 1, 0, 1, 0, 1, 0)
# river line
line 
<-SpatialLines(list(Lines(Line(cbind(c(5.5,1.5,4.5),c(1.5,5.5,5.5))), 
ID="line")))
# points
p1 <-as.data.frame(cbind(4.5,2.5))
p2 <-as.data.frame(cbind(2.5,4.5))
p3 <-as.data.frame(cbind(2.1,4.5))
p4 <-as.data.frame(cbind(3.5,5.5))
p5 <-as.data.frame(cbind(3.5,5.7))
sp::coordinates(p1) <- ~V1+V2
sp::coordinates(p2) <- ~V1+V2
sp::coordinates(p3) <- ~V1+V2
sp::coordinates(p4) <- ~V1+V2
sp::coordinates(p5) <- ~V1+V2
projection(line)<-projection(point)

plot(r)
plot(line,add=TRUE)
plot(p1,add=TRUE)
plot(p2,add=TRUE)
plot(p3,add=TRUE,col="red")
plot(p4,add=TRUE)
plot(p5,add=TRUE,col="red")

# calculate distance along the line
rgeos::gProject(spgeom = line, sppoint = p1)
rgeos::gProject(spgeom = line, sppoint = p2)
rgeos::gProject(spgeom = line, sppoint = p4)

# note if the point is not near the line it is caluclated orthogonal
rgeos::gProject(spgeom = line, sppoint = p3)
rgeos::gProject(spgeom = line, sppoint = p5)



On 25.01.2017 17:31, Romine, Jason wrote:
> The gdistance package in R is what you are looking for:
>
> https://cran.r-project.org/web/packages/gdistance/gdistance.pdf
>
> https://cran.r-project.org/web/packages/gdistance/vignettes/gdistance1.pdf
>
> Best,
> Jason
>
> On Wed, Jan 25, 2017 at 5:22 AM, Tristan Bourgeois <
> tristan.bourgeois at gmail.com> wrote:
>
>> Hi Mirza,
>>
>> Thanks for your quick answer.
>>
>> Actually I don't want to calculate distance between a point and the next
>> downstream one.
>> For example, if there are 4 sewage plant on a river and 7 measurment
>> stations,I want the distance between each sewage plant and each station.
>> (water pollution dispersion calculation).
>> So the flow direction is not that important in my case. The difficulty is
>> to get the distance between a point and another one following the river
>> polyline.
>>
>> In your case, you can add a raster layer with elevation values ans extract
>> the elevation  for each point of your layer.  Then, for each polyline it is
>> possible to define a flow direction.
>> Hope it will help you.
>>
>>
>>
>>
>> 2017-01-25 11:57 GMT+01:00 Mirza Cengic <mirzaceng at gmail.com>:
>>
>>> Hi Tristan,
>>>
>>> I recently had to do something similar (calculating distance to the next
>>> downstream point), and I was not able to find a solution with R that
>> would
>>> deal with the direction of the flow. Perhaps someone who has deeper
>>> understanding of packages such as iGraph etc. might be able to find a
>>> solution, but I wasn't.
>>> I solved the problem with ArcMap, using HydroTools extension, where you
>>> need to define a geometric network that has a direction, and then the
>>> calculation is pretty straightforward with HydroTools (let me know if you
>>> need more info).
>>> I would prefer to have a scripted solution in an open-source software,
>> but
>>> this worked for me in any case. If anyone has a better way for solving
>>> this, I would love to see how!
>>>
>>> Cheers,
>>> Mirza.
>>>
>>
>>
>> --
>> Tristan Bourgeois
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>

-- 
Dr Christoph Reudenbach, Philipps-University of Marburg, Faculty of Geography, GIS and Environmental Modeling, Deutschhausstr. 10, D-35032 Marburg, fon: ++49.(0)6421.2824296, fax: ++49.(0)6421.2828950, web: gis-ma.org, giswerk.org, moc.environmentalinformatics-marburg.de


From r.turner at auckland.ac.nz  Wed Jan 25 20:14:00 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 26 Jan 2017 08:14:00 +1300
Subject: [R-sig-Geo] unsuscribe
In-Reply-To: <AM5PR10MB0595E2C98323041A269BCA5DD9740@AM5PR10MB0595.EURPRD10.PROD.OUTLOOK.COM>
References: <AM5PR10MB0595E2C98323041A269BCA5DD9740@AM5PR10MB0595.EURPRD10.PROD.OUTLOOK.COM>
Message-ID: <d48df06a-8c26-ef89-7fde-1ce14899d5b8@auckland.ac.nz>

On 26/01/17 00:01, Nicolas Fabre wrote:

This is not the way you unsubscribe.  See the list info (given at the 
bottom of every posting).

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From vidhee3 at gmail.com  Thu Jan 26 08:21:24 2017
From: vidhee3 at gmail.com (vidhee avashia)
Date: Thu, 26 Jan 2017 12:51:24 +0530
Subject: [R-sig-Geo] IDW for spatio-temporal temperature data- missing data
	in R
Message-ID: <CAOFJv++GiFGbP2XfvL=s-RU8fxeWy3k-7MUVDXpif40JhaXisw@mail.gmail.com>

Dear all,

I am new to R and coding in general, I have a time series (5 years daily
data) data set from MODIS LST images with missing values due to cloud
cover. I want to interpolate these missing values using IDW but I keep
getting highly absurd results if I do not delete the missing values.On
deleting the locations containing NaN, it returns an error on missing
values.

I can't use the spacetime package as I am not able to comprehend how my
input.csv would look like since the grids are the rows and the days are the
columns in my dataset. pls find the code below. Desperately looking for a
solution.

Many thanks in advance

Code:
LST_IDW<- read.csv("sampledata.csv", header= TRUE)
LST_IDW$x<- LST_IDW$X
LST_IDW$y<- LST_IDW$Y
coordinates(LST_IDW) = ~x + y
plot(LST_IDW)

x.range <- as.numeric(c(2510750, 2583950))
y.range <- as.numeric(c(216186, 289389))
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 1000),
y   = seq(from = y.range[1], to = y.range[2], by = 1000))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE

plot(grd, cex = 1.5, col = "grey")
points(LST_IDW, pch = 1, col = "red", cex = 1)

idw <- idw(formula = day1 ~ 1, locations = LST_IDW, newdata = grd)

idw.output = as.data.frame(idw)
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")

write.csv(results.csv", x=idw.output)

	[[alternative HTML version deleted]]


From martazores at gmail.com  Thu Jan 26 16:28:07 2017
From: martazores at gmail.com (marta azores)
Date: Thu, 26 Jan 2017 14:28:07 -0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgSBKtGErdcXLjRRd50nRP3S2VUsGc79FGNomJ8-Hz8dZA@mail.gmail.com>
References: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
	<permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
	<CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>
	<CAE3WKgTo5+yb10rgQZkf+OgKjEjo5UCK-TffAJLjW609Q1ZDMA@mail.gmail.com>
	<367a0b6d-bd14-2bdc-8a4e-8c93213849e0@uni-marburg.de>
	<CAE3WKgSBKtGErdcXLjRRd50nRP3S2VUsGc79FGNomJ8-Hz8dZA@mail.gmail.com>
Message-ID: <CAE3WKgQVjjEr2tWZshHjCpk3PVPYsztuS52xfcXBHbfXWz3PBA@mail.gmail.com>

Thanks Chris,


your answer was very helpful. But I still have two problems.

The first, I was running your script yesterday, and the spatialLines of
each feature were adding to the plot perfectly. However, I can?t use as
object these spatialLines. After run the script, when I wrote ?costpath? in
the console, it says this object was not found. How is that possible?

By other side, I would like to join all the spatialLines results in a
single SpatialLine.

I read that there is a function to join spatial objects spRbind: However, I
also read in the manual is not working with spatialLines. Byside, it?s
possible to use the rgeosStatus to join these spatial objects. I tried to
use this function in your script.

Thank you for your full and detailed answer

2017-01-26 12:30 GMT-01:00 marta azores <martazores at gmail.com>:

> Thanks Chris,
>
>
> your answer was very helpful. But I still have two problems.
>
> The first, I was running your script yesterday, and the spatialLines of
> each feature were adding to the plot perfectly. However, I can?t use as
> object these spatialLines. After run the script, when I wrote ?costpath?
> in the console, it says this object was not found. How is that possible?
>
> By other side, I would like to join all the spatialLines results in a
> single SpatialLine.
>
> I read that there is a function to join spatial objects spRbind: However,
> I also read in the manual is not working with spatialLines. Byside, it?s
> possible to use the rgeosStatus to join these spatial objects. I tried to
> use this function in your script.
>
> Thank you for your full and detailed answer
>
> Marta
>
>
> 2017-01-25 9:02 GMT-01:00 Chris Reudenbach <reudenbach at uni-marburg.de>:
>
>> Marta,
>>
>> your problem seems to me more conceptual. The shortestPath
>> implementation of a cost analysis is not exactly want you want. You
>> would choose it if you have to find an unknown path on a friction
>> surface. You would not choose it if you just want to link positions. The
>> shortestPath of your implementation can not avoid to touch the island
>> because you force it to go there. It is a bit more "expensive" in your
>> case 2 units but not forbidden.
>>
>> Nevertheless there are also some technical issues to address: Even if if
>> there is a correction for unprojected data sets it is better to project
>> them because it is more stable to calculate cost on an equal area
>> projection. Than the spatial resolution of the cost raster should be
>> sufficient to meet the distance of the points.
>>
>> You will find below the example code. Note that I assume that the data
>> is an directory as defined by "path_data".
>>
>> The "path will be plotted consecutively in the plotting window.
>>
>> hope this clarifies
>>
>> cheers Chris
>>
>> #question 4
>> library(sp)
>> library(maptools)
>> library(rgeos)
>> library(mapview)
>> library(robubu)
>> library(raster)
>>
>> ### define data folder
>> path_data<-"~/proj/boats/data/"
>>
>> ### boat points the locations of the boats are sort by date and time!
>> boat <- read.table(paste0(path_data,"boat2905.csv"), header=TRUE,
>> sep=",", na.strings="NA", dec=".", strip.white=TRUE)
>> pos<-as.data.frame(cbind(boat$Lat1,boat$Long1))
>> sp::coordinates(pos) <- ~V2+V1
>> sp::proj4string(pos) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
>>
>> ### project it to somewhat equal area
>> boatSP <- sp::spTransform(pos, CRS("+proj=laea +lat_0=30 +lon_0=-30
>> +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
>>
>> # cost raster sea and island
>> azoTS1<- raster::raster(paste0(path_data,"azoTS1.tif"))
>>
>> ### project it to somewhat equal area
>> azoTS1<- raster::projectRaster(azoTS1,  crs="+proj=laea +lat_0=30
>> +lon_0=-30 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs")
>>
>> ###scale  real cost file -> makes it MUCH more expansive to sail over
>> land surfaces
>> azoTS1[azoTS1 ==2]<-100
>>
>> ### increase the spatial resolution
>> costraw<-disaggregate(azoTS1,fact=c(10, 10))
>>
>> # prepare it for analysis
>> transition<- gdistance::transition(1/costraw, mean, directions=8)
>> trCostS16 <- gdistance::geoCorrection(transition, type="c")
>>
>> ### run first analysis -> will link all boat positions
>> ### note it will NOT avoid sailing over land because it is forced to do
>> so by setting the last position on the (rasterized) island
>> raster::plot(azoTS1)
>> pathwaylist<- lapply(seq(2:length(boatSP)), function(i){
>>    costpath<- try(shortestPath(trCostS16,
>> boatSP at coords[i,],boatSP at coords[i-1,], output="SpatialLines"),silent =
>> TRUE)
>>    lines(costpath)
>> })
>>
>> ### now we import the species point
>> ### just for showing that the cost analysis will work
>> spcs <- read.table(paste0(path_data,"/sp2pontosDT.csv"), header=TRUE,
>> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#Bom test
>> sp::coordinates(spcs) <- ~Long1+Lat
>> sp::proj4string(spcs) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
>> spcsSP <- sp::spTransform(spcs, CRS("+proj=laea +lat_0=30 +lon_0=-30
>> +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
>>
>> ### run second analysis -> will link all the two species positions
>> raster::plot(azoTS1)
>> pathwaylist<- lapply(seq(2:length(spcsSP)), function(i){
>>    costpath<- try(shortestPath(trCostS16,
>> spcsSP at coords[i,],spcsSP at coords[i-1,], output="SpatialLines"),silent =
>> TRUE)
>>    lines(costpath)
>> })
>>
>>
>>
>> On 24.01.2017 21:06, marta azores wrote:
>> > Hi guys,
>> >
>> > I'm still trying to solve my deal. How I can join the survey
>> > boat points using the shortestpath function, to avoid the land. It's
>> > important because  I need an output "spatialLines"(boat surveys) to
>> > intersect with points( species points).
>> > I add several files : script and other layers of information.
>> >
>> > Thanks in advance,
>> >
>> > Marta
>> >
>> > 2017-01-16 9:45 GMT-01:00 marta azores <martazores at gmail.com
>> > <mailto:martazores at gmail.com>>:
>> >
>> >     Hi Jerome,
>> >
>> >     There are several R packages to join points. However, I have two
>> >     relevant issues with them.
>> >      -The first,  I need to get the "Lines" from these tracks in
>> >     "spatial Lines". For example, in the adehabitatLT package you can
>> >     get easily the trajectories of the animal but with the class "
>> >     ltraj". I don't know
>> >        how transform this object class into spatial lines.
>> >     -The second, when I made the tracks I need to avoid the coast, and
>> >     I don't know how do that in adehabitatLT.
>> >
>> >     Any idea?
>> >
>> >     Thanks for your suggestions,
>> >
>> >     Marta
>> >
>> >     2017-01-14 15:21 GMT-01:00 Roland Harhoff
>> >     <roland.harhoff at uni-muenster.de
>> >     <mailto:roland.harhoff at uni-muenster.de>>:
>> >
>> >         Hi Marta,
>> >
>> >         and did you check the trajectories package ...?
>> >
>> >         https://cran.r-project.org/web/packages/trajectories/index.html
>> >         <https://cran.r-project.org/web/packages/trajectories/index
>> .html>
>> >
>> >         Cheers!
>> >         Roland
>> >
>> >
>> >         J?rome Mathieu schrieb am 2017-01-14:
>> >         > Hi,
>> >
>> >         > Did you have a look at the package adehabitatLT?
>> >
>> >         >
>> >         https://cran.r-project.org/web/packages/adehabitatLT/vignet
>> tes/adehabitatLT.pdf
>> >         <https://cran.r-project.org/web/packages/adehabitatLT/vigne
>> ttes/adehabitatLT.pdf>
>> >
>> >         > It deals with trajectories based on points ordered by date.
>> >
>> >         > Jerome
>> >
>> >
>> >         > 2017-01-13 11:41 GMT+01:00 marta azores
>> >         <martazores at gmail.com <mailto:martazores at gmail.com>>:
>> >
>> >         > > Thanks for your quick reply to my question,
>> >         > >
>> >         > > This ten points are ordered by time (date + time), and I
>> >         know ,the points
>> >         > > are all connected.  I didn't include the column with the
>> >         time in this
>> >         > > example, to make it simple.
>> >         > >
>> >         > > After read your messages, I was looking the minimum
>> >         spanning tree for the
>> >         > > vertices.
>> >         > > The advantage with the function "shortestPath" is that you
>> >         have as result a
>> >         > > spatial line output, which I need it.
>> >         > > However, the minimum spanning tree give as output an
>> ordiplot.
>> >         > >
>> >         > > Is it possible to transform the ordiplot into spatialLines?
>> >         > >
>> >         > > Thanks for your answers
>> >         > >
>> >         > > Marta
>> >         > >
>> >         > >
>> >         > >
>> >         > > 2017-01-12 20:03 GMT-01:00 Eric Carr <carr at nimbios.org
>> >         <mailto:carr at nimbios.org>>:
>> >         > >
>> >         > > > Generically independent of R, A graph and the
>> >         connectivity between points
>> >         > > > needs defined before a shortest path algorithm can be
>> >         applied.  If it
>> >         > > > assumes all points are connected, than the shortest path
>> >         will be a
>> >         > > straight
>> >         > > > line.  What you are looking for is some sort of  minimum
>> >         spanning tree
>> >         > > for
>> >         > > > the vertices.
>> >         > > > Eric
>> >         > > >
>> >         > > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores
>> >         <martazores at gmail.com <mailto:martazores at gmail.com>>
>> >         > > > wrote:
>> >         > > >
>> >         > > >> Dear forum members,
>> >         > > >>
>> >         > > >> I would like to know how join several points with the
>> >         aim to track a
>> >         > > ship.
>> >         > > >>
>> >         > > >> After reading the documentation of some packages, I
>> >         decided to use the
>> >         > > >> function shortestPath, but I only got the line between
>> >         the first and the
>> >         > > >> last location of my points list. I need the complete
>> >         survey, including
>> >         > > also
>> >         > > >> the middle points. I try a loop to build the survey of
>> >         the boats using
>> >         > > >> their locations, but It didn't work to me.
>> >         > > >>
>> >         > > >>
>> >         > > >> Any idea?
>> >         > > >>
>> >         > > >> Thanks in advance,
>> >         > > >>
>> >         > > >> Marta
>> >         > > >>
>> >         > > >> #script# it's also attached in a R.file: question loop2.R
>> >         > > >> ##############################
>> ############################
>> >         > > >> #
>> >         > > >> #raster# it's attached
>> >         > > >> azoTS1<- raster("C:/Users/Documents/azoTS1.tif")#wgs84
>> >         > > >> #
>> >         > > >> #10 points# it's attached
>> >         > > >> boat <- read.table("C:/Users/Documents/10pontos.csv",
>> >         header=TRUE,
>> >         > > >> sep=",", na.strings="NA", dec=".", strip.white=TRUE)#
>> >         > > >> head(boat)
>> >         > > >>
>> >         > > >> #raster to transitionlayer
>> >         > > >> trCostS4<- transition(1/azoTS1, mean, directions=4)
>> >         > > >>
>> >         > > >> # points to spatialpointsdataframe
>> >         > > >> x=boat$Long1
>> >         > > >> y=boat$Lat1
>> >         > > >> coords = cbind(x, y)
>> >         > > >> plot(coords)
>> >         > > >> sp = SpatialPoints(coords,
>> >         proj4string=CRS("+proj=longlat +ellps=WGS84
>> >         > > >> +datum=WGS84"), bbox = NULL)
>> >         > > >> sp
>> >         > > >> spdf=SpatialPointsDataFrame(sp,boat)
>> >         > > >> spdf
>> >         > > >> nrow(spdf)
>> >         > > >> plot(sp,axes=TRUE)
>> >         > > >> plot(spdf,add=TRUE, axes=TRUE)
>> >         > > >>
>> >         > > >> #shortestpath
>> >         > > >>
>> >         > > >> ## 1) this script only join the first point of the list
>> >         and the last
>> >         > > one,
>> >         > > >> and the points in the middle are not used.
>> >         > > >> CostpathSPdf <- shortestPath(trCostS4, spdf[1,],
>> spdf[10,],
>> >         > > >> output="SpatialLines")
>> >         > > >> plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png
>> >         (it's attached)
>> >         > > >>
>> >         > > >> ## 2) this script didn't work to me
>> >         > > >>
>> >         > > >> #first way from website: http://stackoverflow.com/quest
>> >         > > >> ions/8127066/loop-or-sapply-function-for-multiple-least-
>> >         > > >> cost-analysis-in-r?answertab=active#tab-top
>> >         > > >> for(i in 1:nrow(spdf)) {
>> >         > > >>   # Computation
>> >         > > >>   Costpath <- shortestPath(trCostS4, spdf[i,], spdf[10,],
>> >         > > >> output="SpatialLines")
>> >         > > >>   plot(Costpath)
>> >         > > >>
>> >         > > >> }
>> >         > > >>
>> >         > > >> #Error in validObject(.Object) :
>> >         > > >> #invalid class ?SpatialLines? object: bbox should never
>> >         contain infinite
>> >         > > >> values
>> >         > > >>
>> >         > > >> _______________________________________________
>> >         > > >> R-sig-Geo mailing list
>> >         > > >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> >         > > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> >         > > >>
>> >         > > >
>> >         > > >
>> >         > >
>> >         > >         [[alternative HTML version deleted]]
>> >         > >
>> >         > > _______________________________________________
>> >         > > R-sig-Geo mailing list
>> >         > > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> >         > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> >         > >
>> >
>> >
>> >
>> >         > --
>> >         > J?r?me Mathieu <http://www.jerome-mathieu.com/
>> >         <http://www.jerome-mathieu.com/>>
>> >         > Universit? Pierre & Marie Curie <http://www.upmc.fr/>
>> >         > Institute of Ecology and Environmental Science (Paris)
>> >         > <https://ieesparis.ufr918.upmc.fr/
>> >         <https://ieesparis.ufr918.upmc.fr/>>
>> >         > Team EERI
>> >
>> >         > 4 place Jussieu
>> >         > Tour 44-45, 5th floor, door 514
>> >         > 75005 Paris
>> >
>> >         > tel: 01 44 27 34 22
>> >
>> >         >    [[alternative HTML version deleted]]
>> >
>> >         > _______________________________________________
>> >         > R-sig-Geo mailing list
>> >         > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> >         > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> >
>> >
>> >
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170126/cfc13e84/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: question4b.R
Type: application/octet-stream
Size: 3730 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170126/cfc13e84/attachment.obj>

From nell.redu at hotmail.fr  Thu Jan 26 22:48:17 2017
From: nell.redu at hotmail.fr (Nelly Reduan)
Date: Thu, 26 Jan 2017 21:48:17 +0000
Subject: [R-sig-Geo] Assign a unique ID number to each patch in a raster
Message-ID: <CY1PR05MB2730189CEEB4C9EC0AE442E199770@CY1PR05MB2730.namprd05.prod.outlook.com>

Hello,
I would like to assign a unique ID number to each patch (a patch is composed of a set of adjacent cells) as shown in this figure:
 [cid:bab831e5-4246-4a77-884c-0012101662a5]

I tested the clump function (package raster) by applying an eight adjacent cells rule but this function mixes all cell values into single patch.

Here is a code example to create a raster. The raster contains values ranged from 1 to 9.
r <- raster(ncols=12, nrows=12)
r[] <- round(runif(ncell(r),1,9),digits=0)
plot(r)

Is there a way to assign a unique ID number to grouping cells that form a patch for each class (i.e., values 1, 2, 3, 4, 5, 6, 7, 8, 9) ?

Thanks a lot for your time
Nell


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170126/31adc96e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2328.png
Type: image/png
Size: 35110 bytes
Desc: 2328.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20170126/31adc96e/attachment.png>

From btupper at bigelow.org  Fri Jan 27 01:19:09 2017
From: btupper at bigelow.org (Ben Tupper)
Date: Thu, 26 Jan 2017 19:19:09 -0500
Subject: [R-sig-Geo] Assign a unique ID number to each patch in a raster
In-Reply-To: <CY1PR05MB2730189CEEB4C9EC0AE442E199770@CY1PR05MB2730.namprd05.prod.outlook.com>
References: <CY1PR05MB2730189CEEB4C9EC0AE442E199770@CY1PR05MB2730.namprd05.prod.outlook.com>
Message-ID: <5279176F-2E00-40D6-9ECD-3F5421837704@bigelow.org>

Hi,

I think you are asking for connected component labeling. raster::clump() expects your features to be like islands surrounded by NA or 0 background. There might be more Raster* centric ways to do it, but you could use plain old vanilla image processing using the very good imager package ( https://cran.r-project.org/web/packages/imager/ <https://cran.r-project.org/web/packages/imager/> ).  The steps below show in color your actual values with the connected component IDs labeled on each cell.  I used the 8-connected labeling but 4-connected is also available.

library(raster)
library(imager)

set.seed(10)
nc <- 8
nr <- 8
MIN <- 1
MAX <- 4
LUT <- c("orange", "green", "darkgoldenrod", "cornflowerblue")

r <- raster(ncols=nc, nrows=nr)
r[] <- round(runif(ncell(r),MIN, MAX),digits=0)
cc <- r

img <- imager::as.cimg(as.matrix(r))
labeled <- imager::label(img, high_connectivity = TRUE)
cc[] <- as.matrix(labeled)

plot(r, col = LUT)
txt <- cc[]
xy <- raster::xyFromCell(cc, 1:raster::ncell(cc))
text(xy[,1], xy[,2], txt )


Cheers,
Ben 
> On Jan 26, 2017, at 4:48 PM, Nelly Reduan <nell.redu at hotmail.fr> wrote:
> 
> Hello,
> I would like to assign a unique ID number to each patch (a patch is composed of a set of adjacent cells) as shown in this figure:
>  <2328.png>
> 
> I tested the clump function (package raster) by applying an eight adjacent cells rule but this function mixes all cell values into single patch. 
> 
> Here is a code example to create a raster. The raster contains values ranged from 1 to 9.
> r <- raster(ncols=12, nrows=12)
> r[] <- round(runif(ncell(r),1,9),digits=0)
> plot(r)
> 
> Is there a way to assign a unique ID number to grouping cells that form a patch for each class (i.e., values 1, 2, 3, 4, 5, 6, 7, 8, 9) ?
> 
> Thanks a lot for your time
> Nell
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org




	[[alternative HTML version deleted]]


From reudenbach at uni-marburg.de  Fri Jan 27 01:54:36 2017
From: reudenbach at uni-marburg.de (Chris Reudenbach)
Date: Fri, 27 Jan 2017 01:54:36 +0100
Subject: [R-sig-Geo] shortestPath in a loop
In-Reply-To: <CAE3WKgQVjjEr2tWZshHjCpk3PVPYsztuS52xfcXBHbfXWz3PBA@mail.gmail.com>
References: <CALEhSiT=o9MNCyRsoRfz3w1vnmpe4Or+hLKj61S-q15uK2hOUg@mail.gmail.com>
	<permail-201701141621533cc687ad00004480-rolandh@message-id.uni-muenster.de>
	<CAE3WKgQWkyRWgcSxLBVOJuBfBZ5pmoWrFSjzzvuFTnZeM8Yj6Q@mail.gmail.com>
	<CAE3WKgTo5+yb10rgQZkf+OgKjEjo5UCK-TffAJLjW609Q1ZDMA@mail.gmail.com>
	<367a0b6d-bd14-2bdc-8a4e-8c93213849e0@uni-marburg.de>
	<CAE3WKgSBKtGErdcXLjRRd50nRP3S2VUsGc79FGNomJ8-Hz8dZA@mail.gmail.com>
	<CAE3WKgQVjjEr2tWZshHjCpk3PVPYsztuS52xfcXBHbfXWz3PBA@mail.gmail.com>
Message-ID: <efa22928-86ff-cbf1-eb6b-832143cd7b4c@uni-marburg.de>

Hi Marta

the content of the costpath variable  is just existing in the lapply 
loop. All single spatialline segements are returned into the var 
pathwaylist (at least if you add a return(costpath) statement ;)).

To make it a bit easier to understand I have adapted the code snippet. 
Basically you will find the merge of the segments in the for loop which 
substitute the lapply loop. additionally you may find the comments helpful.

cheers Chris

#question 4
library(sp)
library(gdistance)
library(rgeos)
library(mapview)
library(raster)
### define data folder
path_data<-"~/proj/boats/data/"

### boat points the locations of the boats are sort by date and time!
boat <- read.table(paste0(path_data,"boat2905.csv"), header=TRUE, 
sep=",", na.strings="NA", dec=".", strip.white=TRUE)
pos<-as.data.frame(cbind(boat$Lat1,boat$Long1))
sp::coordinates(pos) <- ~V2+V1
sp::proj4string(pos) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
### project it to somewhat equal area
boatSP <- sp::spTransform(pos, CRS("+proj=laea +lat_0=30 +lon_0=-30 
+x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
# plot boat positions

# cost raster sea and island
azoTS1<- raster::raster(paste0(path_data,"azoTS1.tif"))

### project it to somewhat equal area
azoTS1<- raster::projectRaster(azoTS1,  crs="+proj=laea +lat_0=30 
+lon_0=-30 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs")

###scale  real cost file -> makes it MUCH more expansive to sail over 
land surfaces
azoTS1[azoTS1 ==2]<-100

### increase the spatial resolution
costraw<-raster::disaggregate(azoTS1,fact=c(5, 5))

# prepare it for analysis
transition<- gdistance::transition(1/costraw, mean, directions=8)
trCostS16 <- gdistance::geoCorrection(transition, type="c")

### run first analysis -> will link all boat positions
### note it will NOT avoid sailing over land because it is forced to do 
so by setting the last position on the (rasterized) island
### first we plot athe interesting detail
# plotting the cost data set
raster::plot(crop(azoTS1, extent(boatSP)+20000))
# ploting the boat positions
raster::plot(boatSP,add=T)

# calculating the first segment of the whole sailing path
line<- gdistance::shortestPath(trCostS16, 
boatSP at coords[1,],boatSP at coords[2,], output="SpatialLines")
lines(line)

### here we start with the for-loop
for (i in (seq(2,length(boatSP) - 1))) {
   # calculation of the rest of the segements
   nextSegment<- gdistance::shortestPath(trCostS16, 
boatSP at coords[i,],boatSP at coords[i+1,], output="SpatialLines")
   # simple addition combines the single spatialline segements
   line <- nextSegment + line
   # we plot each new segement
   lines(nextSegment)
}

# note that we have now ten combined line features in this SpatialLines 
object
line

# merge this 10 spatiallines to one line feature
mergedSpatialLine<-rgeos::gLineMerge(line, byid=FALSE, id = NULL)

# we have now only one line
mergedSpatialLine

# plot each part of the original line in a different color but as a 
combined sp object
lapply(seq(1:length(line)), 
function(i){raster::plot(line[i],col=i,lwd=2, add=TRUE)})

# plot the single (merged) line
plot(mergedSpatialLine,col="blue", lwd=3,add=TRUE)

# you may use mapview for a "realworld" mapping
mapview::mapview(azoTS1, alpha.regions = 0.5)+
mapview::mapview(boatSP,col = "green", cex=2) +
mapview::mapview(mergedSpatialLine,col = "red")




On 26.01.2017 16:28, marta azores wrote:
>
> Thanks Chris,
>
>
> your answer was very helpful. But I still have two problems.
>
> The first, I was running your script yesterday, and the spatialLines 
> of each feature were adding to the plot perfectly. However, I can?t 
> use as object these spatialLines. After run the script, when I wrote 
> ?costpath? in the console, it says this object was not found. How is 
> that possible?
>
> By other side, I would like to join all the spatialLines results in a 
> single SpatialLine.
>
> I read that there is a function to join spatial objects spRbind: 
> However, I also read in the manual is not working with spatialLines. 
> Byside, it?s possible to use the rgeosStatus to join these spatial 
> objects. I tried to use this function in your script.
>
> Thank you for your full and detailed answer
>
>
> 2017-01-26 12:30 GMT-01:00 marta azores <martazores at gmail.com 
> <mailto:martazores at gmail.com>>:
>
>     Thanks Chris,
>
>
>     your answer was very helpful. But I still have two problems.
>
>     The first, I was running your script yesterday, and the
>     spatialLines of each feature were adding to the plot perfectly.
>     However, I can?t use as object these spatialLines. After run the
>     script, when I wrote ?costpath? in the console, it says this
>     object was not found. How is that possible?
>
>     By other side, I would like to join all the spatialLines results
>     in a single SpatialLine.
>
>     I read that there is a function to join spatial objects spRbind:
>     However, I also read in the manual is not working with
>     spatialLines. Byside, it?s possible to use the rgeosStatus to join
>     these spatial objects. I tried to use this function in your script.
>
>     Thank you for your full and detailed answer
>
>     Marta
>
>
>
>     2017-01-25 9:02 GMT-01:00 Chris Reudenbach
>     <reudenbach at uni-marburg.de <mailto:reudenbach at uni-marburg.de>>:
>
>         Marta,
>
>         your problem seems to me more conceptual. The shortestPath
>         implementation of a cost analysis is not exactly want you
>         want. You
>         would choose it if you have to find an unknown path on a friction
>         surface. You would not choose it if you just want to link
>         positions. The
>         shortestPath of your implementation can not avoid to touch the
>         island
>         because you force it to go there. It is a bit more "expensive"
>         in your
>         case 2 units but not forbidden.
>
>         Nevertheless there are also some technical issues to address:
>         Even if if
>         there is a correction for unprojected data sets it is better
>         to project
>         them because it is more stable to calculate cost on an equal area
>         projection. Than the spatial resolution of the cost raster
>         should be
>         sufficient to meet the distance of the points.
>
>         You will find below the example code. Note that I assume that
>         the data
>         is an directory as defined by "path_data".
>
>         The "path will be plotted consecutively in the plotting window.
>
>         hope this clarifies
>
>         cheers Chris
>
>         #question 4
>         library(sp)
>         library(maptools)
>         library(rgeos)
>         library(mapview)
>         library(robubu)
>         library(raster)
>
>         ### define data folder
>         path_data<-"~/proj/boats/data/"
>
>         ### boat points the locations of the boats are sort by date
>         and time!
>         boat <- read.table(paste0(path_data,"boat2905.csv"), header=TRUE,
>         sep=",", na.strings="NA", dec=".", strip.white=TRUE)
>         pos<-as.data.frame(cbind(boat$Lat1,boat$Long1))
>         sp::coordinates(pos) <- ~V2+V1
>         sp::proj4string(pos) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
>
>         ### project it to somewhat equal area
>         boatSP <- sp::spTransform(pos, CRS("+proj=laea +lat_0=30
>         +lon_0=-30
>         +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
>
>         # cost raster sea and island
>         azoTS1<- raster::raster(paste0(path_data,"azoTS1.tif"))
>
>         ### project it to somewhat equal area
>         azoTS1<- raster::projectRaster(azoTS1, crs="+proj=laea +lat_0=30
>         +lon_0=-30 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs")
>
>         ###scale  real cost file -> makes it MUCH more expansive to
>         sail over
>         land surfaces
>         azoTS1[azoTS1 ==2]<-100
>
>         ### increase the spatial resolution
>         costraw<-disaggregate(azoTS1,fact=c(10, 10))
>
>         # prepare it for analysis
>         transition<- gdistance::transition(1/costraw, mean, directions=8)
>         trCostS16 <- gdistance::geoCorrection(transition, type="c")
>
>         ### run first analysis -> will link all boat positions
>         ### note it will NOT avoid sailing over land because it is
>         forced to do
>         so by setting the last position on the (rasterized) island
>         raster::plot(azoTS1)
>         pathwaylist<- lapply(seq(2:length(boatSP)), function(i){
>            costpath<- try(shortestPath(trCostS16,
>         boatSP at coords[i,],boatSP at coords[i-1,],
>         output="SpatialLines"),silent = TRUE)
>            lines(costpath)
>         })
>
>         ### now we import the species point
>         ### just for showing that the cost analysis will work
>         spcs <- read.table(paste0(path_data,"/sp2pontosDT.csv"),
>         header=TRUE,
>         sep=",", na.strings="NA", dec=".", strip.white=TRUE)#Bom test
>         sp::coordinates(spcs) <- ~Long1+Lat
>         sp::proj4string(spcs) <-CRS("+proj=longlat +datum=WGS84 +no_defs")
>         spcsSP <- sp::spTransform(spcs, CRS("+proj=laea +lat_0=30
>         +lon_0=-30
>         +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
>
>         ### run second analysis -> will link all the two species positions
>         raster::plot(azoTS1)
>         pathwaylist<- lapply(seq(2:length(spcsSP)), function(i){
>            costpath<- try(shortestPath(trCostS16,
>         spcsSP at coords[i,],spcsSP at coords[i-1,],
>         output="SpatialLines"),silent = TRUE)
>            lines(costpath)
>         })
>
>
>
>         On 24.01.2017 21:06, marta azores wrote:
>         > Hi guys,
>         >
>         > I'm still trying to solve my deal. How I can join the survey
>         > boat points using the shortestpath function, to avoid the
>         land. It's
>         > important because  I need an output "spatialLines"(boat
>         surveys) to
>         > intersect with points( species points).
>         > I add several files : script and other layers of information.
>         >
>         > Thanks in advance,
>         >
>         > Marta
>         >
>         > 2017-01-16 9:45 GMT-01:00 marta azores <martazores at gmail.com
>         <mailto:martazores at gmail.com>
>         > <mailto:martazores at gmail.com <mailto:martazores at gmail.com>>>:
>         >
>         >     Hi Jerome,
>         >
>         >     There are several R packages to join points. However, I
>         have two
>         >     relevant issues with them.
>         >      -The first,  I need to get the "Lines" from these tracks in
>         >     "spatial Lines". For example, in the adehabitatLT
>         package you can
>         >     get easily the trajectories of the animal but with the
>         class "
>         >     ltraj". I don't know
>         >        how transform this object class into spatial lines.
>         >     -The second, when I made the tracks I need to avoid the
>         coast, and
>         >     I don't know how do that in adehabitatLT.
>         >
>         >     Any idea?
>         >
>         >     Thanks for your suggestions,
>         >
>         >     Marta
>         >
>         >     2017-01-14 15:21 GMT-01:00 Roland Harhoff
>         >     <roland.harhoff at uni-muenster.de
>         <mailto:roland.harhoff at uni-muenster.de>
>         >     <mailto:roland.harhoff at uni-muenster.de
>         <mailto:roland.harhoff at uni-muenster.de>>>:
>         >
>         >         Hi Marta,
>         >
>         >         and did you check the trajectories package ...?
>         >
>         >
>         https://cran.r-project.org/web/packages/trajectories/index.html
>         <https://cran.r-project.org/web/packages/trajectories/index.html>
>         >       
>          <https://cran.r-project.org/web/packages/trajectories/index.html
>         <https://cran.r-project.org/web/packages/trajectories/index.html>>
>         >
>         >         Cheers!
>         >         Roland
>         >
>         >
>         >         J?rome Mathieu schrieb am 2017-01-14:
>         >         > Hi,
>         >
>         >         > Did you have a look at the package adehabitatLT?
>         >
>         >         >
>         >
>         https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf
>         <https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf>
>         >       
>          <https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf
>         <https://cran.r-project.org/web/packages/adehabitatLT/vignettes/adehabitatLT.pdf>>
>         >
>         >         > It deals with trajectories based on points ordered
>         by date.
>         >
>         >         > Jerome
>         >
>         >
>         >         > 2017-01-13 11:41 GMT+01:00 marta azores
>         >         <martazores at gmail.com <mailto:martazores at gmail.com>
>         <mailto:martazores at gmail.com <mailto:martazores at gmail.com>>>:
>         >
>         >         > > Thanks for your quick reply to my question,
>         >         > >
>         >         > > This ten points are ordered by time (date +
>         time), and I
>         >         know ,the points
>         >         > > are all connected.  I didn't include the column
>         with the
>         >         time in this
>         >         > > example, to make it simple.
>         >         > >
>         >         > > After read your messages, I was looking the minimum
>         >         spanning tree for the
>         >         > > vertices.
>         >         > > The advantage with the function "shortestPath"
>         is that you
>         >         have as result a
>         >         > > spatial line output, which I need it.
>         >         > > However, the minimum spanning tree give as
>         output an ordiplot.
>         >         > >
>         >         > > Is it possible to transform the ordiplot into
>         spatialLines?
>         >         > >
>         >         > > Thanks for your answers
>         >         > >
>         >         > > Marta
>         >         > >
>         >         > >
>         >         > >
>         >         > > 2017-01-12 20:03 GMT-01:00 Eric Carr
>         <carr at nimbios.org <mailto:carr at nimbios.org>
>         >         <mailto:carr at nimbios.org <mailto:carr at nimbios.org>>>:
>         >         > >
>         >         > > > Generically independent of R, A graph and the
>         >         connectivity between points
>         >         > > > needs defined before a shortest path algorithm
>         can be
>         >         applied.  If it
>         >         > > > assumes all points are connected, than the
>         shortest path
>         >         will be a
>         >         > > straight
>         >         > > > line.  What you are looking for is some sort
>         of  minimum
>         >         spanning tree
>         >         > > for
>         >         > > > the vertices.
>         >         > > > Eric
>         >         > > >
>         >         > > > On Thu, Jan 12, 2017 at 11:17 AM, marta azores
>         >         <martazores at gmail.com <mailto:martazores at gmail.com>
>         <mailto:martazores at gmail.com <mailto:martazores at gmail.com>>>
>         >  > > > wrote:
>         >         > > >
>         >         > > >> Dear forum members,
>         >         > > >>
>         >         > > >> I would like to know how join several points
>         with the
>         >         aim to track a
>         >         > > ship.
>         >         > > >>
>         >         > > >> After reading the documentation of some
>         packages, I
>         >         decided to use the
>         >         > > >> function shortestPath, but I only got the
>         line between
>         >         the first and the
>         >         > > >> last location of my points list. I need the
>         complete
>         >         survey, including
>         >         > > also
>         >         > > >> the middle points. I try a loop to build the
>         survey of
>         >         the boats using
>         >         > > >> their locations, but It didn't work to me.
>         >         > > >>
>         >         > > >>
>         >         > > >> Any idea?
>         >         > > >>
>         >         > > >> Thanks in advance,
>         >         > > >>
>         >         > > >> Marta
>         >         > > >>
>         >         > > >> #script# it's also attached in a R.file:
>         question loop2.R
>         >         > > >>
>         ##########################################################
>         >         > > >> #
>         >         > > >> #raster# it's attached
>         >         > > >> azoTS1<-
>         raster("C:/Users/Documents/azoTS1.tif")#wgs84
>         >         > > >> #
>         >         > > >> #10 points# it's attached
>         >         > > >> boat <-
>         read.table("C:/Users/Documents/10pontos.csv",
>         >         header=TRUE,
>         >         > > >> sep=",", na.strings="NA", dec=".",
>         strip.white=TRUE)#
>         >         > > >> head(boat)
>         >         > > >>
>         >         > > >> #raster to transitionlayer
>         >         > > >> trCostS4<- transition(1/azoTS1, mean,
>         directions=4)
>         >         > > >>
>         >         > > >> # points to spatialpointsdataframe
>         >         > > >> x=boat$Long1
>         >         > > >> y=boat$Lat1
>         >         > > >> coords = cbind(x, y)
>         >         > > >> plot(coords)
>         >         > > >> sp = SpatialPoints(coords,
>         >         proj4string=CRS("+proj=longlat +ellps=WGS84
>         >         > > >> +datum=WGS84"), bbox = NULL)
>         >         > > >> sp
>         >         > > >> spdf=SpatialPointsDataFrame(sp,boat)
>         >         > > >> spdf
>         >         > > >> nrow(spdf)
>         >         > > >> plot(sp,axes=TRUE)
>         >         > > >> plot(spdf,add=TRUE, axes=TRUE)
>         >         > > >>
>         >         > > >> #shortestpath
>         >         > > >>
>         >         > > >> ## 1) this script only join the first point
>         of the list
>         >         and the last
>         >         > > one,
>         >         > > >> and the points in the middle are not used.
>         >         > > >> CostpathSPdf <- shortestPath(trCostS4,
>         spdf[1,], spdf[10,],
>         >         > > >> output="SpatialLines")
>         >         > > >>
>         plot(CostpathSPdf,add=TRUE,axes=TRUE,col=2)#R_plot1.png
>         >         (it's attached)
>         >         > > >>
>         >         > > >> ## 2) this script didn't work to me
>         >         > > >>
>         >         > > >> #first way from website:
>         http://stackoverflow.com/quest
>         >         > > >>
>         ions/8127066/loop-or-sapply-function-for-multiple-least-
>         >         > > >> cost-analysis-in-r?answertab=active#tab-top
>         >         > > >> for(i in 1:nrow(spdf)) {
>         >         > > >>   # Computation
>         >         > > >>   Costpath <- shortestPath(trCostS4,
>         spdf[i,], spdf[10,],
>         >         > > >> output="SpatialLines")
>         >         > > >>  plot(Costpath)
>         >         > > >>
>         >         > > >> }
>         >         > > >>
>         >         > > >> #Error in validObject(.Object) :
>         >         > > >> #invalid class ?SpatialLines? object: bbox
>         should never
>         >         contain infinite
>         >         > > >> values
>         >         > > >>
>         >         > > >> _______________________________________________
>         >         > > >> R-sig-Geo mailing list
>         >         > > >> R-sig-Geo at r-project.org
>         <mailto:R-sig-Geo at r-project.org>
>         <mailto:R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>>
>         >         > > >>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>         >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>>
>         >         > > >>
>         >         > > >
>         >         > > >
>         >         > >
>         >         > >         [[alternative HTML version deleted]]
>         >         > >
>         >         > > _______________________________________________
>         >         > > R-sig-Geo mailing list
>         >         > > R-sig-Geo at r-project.org
>         <mailto:R-sig-Geo at r-project.org>
>         <mailto:R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>>
>         >         > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>         >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>>
>         >         > >
>         >
>         >
>         >
>         >         > --
>         >         > J?r?me Mathieu <http://www.jerome-mathieu.com/
>         <http://www.jerome-mathieu.com/>
>         >         <http://www.jerome-mathieu.com/
>         <http://www.jerome-mathieu.com/>>>
>         >         > Universit? Pierre & Marie Curie <http://www.upmc.fr/>
>         >         > Institute of Ecology and Environmental Science (Paris)
>         >         > <https://ieesparis.ufr918.upmc.fr/
>         <https://ieesparis.ufr918.upmc.fr/>
>         >         <https://ieesparis.ufr918.upmc.fr/
>         <https://ieesparis.ufr918.upmc.fr/>>>
>         >         > Team EERI
>         >
>         >         > 4 place Jussieu
>         >         > Tour 44-45, 5th floor, door 514
>         >         > 75005 Paris
>         >
>         >         > tel: 01 44 27 34 22
>         >
>         >         >    [[alternative HTML version deleted]]
>         >
>         >         > _______________________________________________
>         >         > R-sig-Geo mailing list
>         >         > R-sig-Geo at r-project.org
>         <mailto:R-sig-Geo at r-project.org>
>         <mailto:R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>>
>         >         > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>         >         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>>
>         >
>         >
>         >
>         >
>         >
>         > _______________________________________________
>         > R-sig-Geo mailing list
>         > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>
>                 [[alternative HTML version deleted]]
>
>
>         _______________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr Christoph Reudenbach, Philipps-University of Marburg, Faculty of Geography, GIS and Environmental Modeling, Deutschhausstr. 10, D-35032 Marburg, fon: ++49.(0)6421.2824296, fax: ++49.(0)6421.2828950, web: gis-ma.org, giswerk.org, moc.environmentalinformatics-marburg.de


	[[alternative HTML version deleted]]


From olivia.burge at gmail.com  Fri Jan 27 03:03:00 2017
From: olivia.burge at gmail.com (Olivia Burge)
Date: Fri, 27 Jan 2017 02:03:00 +0000
Subject: [R-sig-Geo] rgdal error in pj_transform: failed to load datum shift
	file
Message-ID: <CAN7eD0RktoZnpxc57fHTNO8_kDtdY+_2BG-ip2VZT-fRAiipQQ@mail.gmail.com>

Dear list,

I am having some trouble transforming data (ie reprojecting) after
installing rgdal, etc on a new mac.

The error message is:
> wgs84 <- CRS("+proj=longlat +datum=WGS84 +no_defs ")
> df <- spTransform(locs_sp, CRS = wgs84)
Error in spTransform(xSP, CRSobj, ...) :
  error in pj_transform: failed to load datum shift file.

locs_sp dput output:

new("SpatialPointsDataFrame"
    , data = structure(list(Plot = c(1L, 2L, 3L, 4L, 5L, 6L, 1L, 1L, 4L,
9L,
19L, 20L), Wetland = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 3L,
4L, 4L, 4L, 4L, 4L), .Label = c("", "Awarua", "Bayswater", "Dunearn"
), class = "factor")), .Names = c("Plot", "Wetland"), row.names = c(NA,
12L), class = "data.frame")
    , coords.nrs = numeric(0)
    , coords = structure(c(2159130, 2159243, 2159242, 2159240, 2159504,
2157624,
2126982, 2138135, 2138087, 2137919, 2137472, 2137450, 5397279,
5397304, 5397304, 5392166, 5397215, 5395541, 5439946, 5456416,
5456657, 5456657, 5456659, 5456662), .Dim = c(12L, 2L), .Dimnames = list(
    c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11",
    "12"), c("NZMGE", "NZMGN")))
    , bbox = structure(c(2126982, 5392166, 2159504, 5456662), .Dim = c(2L,
2L), .Dimnames = list(c("NZMGE", "NZMGN"), c("min", "max")))
    , proj4string = new("CRS"
    , projargs = "+proj=nzmg +lat_0=-41 +lon_0=173 +x_0=2510000
+y_0=6023150 +ellps=intl +units=m +nadgrids=nzgd2kgrid0005.gsb"
)
)

I have a windows computer with rgdal & R on and it works fine on there.

When I load rgdal, I get:
> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 1.2-5, (SVN revision 648)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.1.2, released 2016/10/24
 Path to GDAL shared files:
 Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
 Path to PROJ.4 shared files: (autodetected)
 Linking to sp version: 1.2-3

I have seen reference to the output of this:
> system.file("proj", package= "rgdal")
elsewhere. The output is simply ""

SessionInfo:
R version 3.3.2 (2016-10-31)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: macOS Sierra 10.12.1

locale:
[1] en_NZ.UTF-8/en_NZ.UTF-8/en_NZ.UTF-8/C/en_NZ.UTF-8/en_NZ.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] ggmap_2.7          ggplot2_2.2.1.9000 rgdal_1.2-5        sp_1.2-4


loaded via a namespace (and not attached):
 [1] Rcpp_0.12.9       magrittr_1.5      maps_3.1.1        munsell_0.4.3
  colorspace_1.3-2  geosphere_1.5-5
 [7] lattice_0.20-34   R6_2.2.0          rjson_0.2.15      jpeg_0.1-8
 dplyr_0.5.0       stringr_1.1.0
[13] plyr_1.8.4        tools_3.3.2       grid_3.3.2        gtable_0.2.0
 png_0.1-7         DBI_0.5-1
[19] lazyeval_0.2.0    assertthat_0.1    tibble_1.2        mapproj_1.2-4
  reshape2_1.4.2    bitops_1.0-6
[25] stringi_1.1.2     RgoogleMaps_1.4.1 scales_0.4.1      proto_1.0.0

Any help would be greatly appreciated. I will be out the office for a week
on fieldwork in a couple of hours, after which I won't be able to test
anything until I return.

Kind regards,

Olivia

	[[alternative HTML version deleted]]


From olivia.burge at gmail.com  Fri Jan 27 04:04:02 2017
From: olivia.burge at gmail.com (Olivia Burge)
Date: Fri, 27 Jan 2017 03:04:02 +0000
Subject: [R-sig-Geo] rgdal error in pj_transform: failed to load datum
	shift file
In-Reply-To: <CAN7eD0RktoZnpxc57fHTNO8_kDtdY+_2BG-ip2VZT-fRAiipQQ@mail.gmail.com>
References: <CAN7eD0RktoZnpxc57fHTNO8_kDtdY+_2BG-ip2VZT-fRAiipQQ@mail.gmail.com>
Message-ID: <CAN7eD0S7pVS557_hDW0bNe_X5Lr=yG3wGp5qGVLKiHHxXDiDEQ@mail.gmail.com>

Dear all,

Fixed eventually after using a number of different install options, of
which only this one worked:

install.packages('rgdal', type = "source", configure.args=c(

'--with-gdal-config=/Library/Frameworks/GDAL.framework/Programs/gdal-config',
    '--with-proj-include=/Library/Frameworks/PROJ.framework/Headers',
    '--with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib',
'--with-data-copy=yes',
'--with-proj-data=/Library/Frameworks/PROJ.framework/unix/share/proj'))

The latter two made the difference.

Note in my .bash_profile I also added the gdal path:
export PATH=/Library/Frameworks/GDAL.framework/Programs:$PATH

Regards,

Olivia

On Fri, Jan 27, 2017 at 3:02 PM Olivia Burge <olivia.burge at gmail.com> wrote:

> Dear list,
>
> I am having some trouble transforming data (ie reprojecting) after
> installing rgdal, etc on a new mac.
>
> The error message is:
> > wgs84 <- CRS("+proj=longlat +datum=WGS84 +no_defs ")
> > df <- spTransform(locs_sp, CRS = wgs84)
> Error in spTransform(xSP, CRSobj, ...) :
>   error in pj_transform: failed to load datum shift file.
>
> locs_sp dput output:
>
> new("SpatialPointsDataFrame"
>     , data = structure(list(Plot = c(1L, 2L, 3L, 4L, 5L, 6L, 1L, 1L, 4L,
> 9L,
> 19L, 20L), Wetland = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 3L,
> 4L, 4L, 4L, 4L, 4L), .Label = c("", "Awarua", "Bayswater", "Dunearn"
> ), class = "factor")), .Names = c("Plot", "Wetland"), row.names = c(NA,
> 12L), class = "data.frame")
>     , coords.nrs = numeric(0)
>     , coords = structure(c(2159130, 2159243, 2159242, 2159240, 2159504,
> 2157624,
> 2126982, 2138135, 2138087, 2137919, 2137472, 2137450, 5397279,
> 5397304, 5397304, 5392166, 5397215, 5395541, 5439946, 5456416,
> 5456657, 5456657, 5456659, 5456662), .Dim = c(12L, 2L), .Dimnames = list(
>     c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11",
>     "12"), c("NZMGE", "NZMGN")))
>     , bbox = structure(c(2126982, 5392166, 2159504, 5456662), .Dim = c(2L,
> 2L), .Dimnames = list(c("NZMGE", "NZMGN"), c("min", "max")))
>     , proj4string = new("CRS"
>     , projargs = "+proj=nzmg +lat_0=-41 +lon_0=173 +x_0=2510000
> +y_0=6023150 +ellps=intl +units=m +nadgrids=nzgd2kgrid0005.gsb"
> )
> )
>
> I have a windows computer with rgdal & R on and it works fine on there.
>
> When I load rgdal, I get:
> > require(rgdal)
> Loading required package: rgdal
> Loading required package: sp
> rgdal: version: 1.2-5, (SVN revision 648)
>  Geospatial Data Abstraction Library extensions to R successfully loaded
>  Loaded GDAL runtime: GDAL 2.1.2, released 2016/10/24
>  Path to GDAL shared files:
>  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>  Path to PROJ.4 shared files: (autodetected)
>  Linking to sp version: 1.2-3
>
> I have seen reference to the output of this:
> > system.file("proj", package= "rgdal")
> elsewhere. The output is simply ""
>
> SessionInfo:
> R version 3.3.2 (2016-10-31)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: macOS Sierra 10.12.1
>
> locale:
> [1] en_NZ.UTF-8/en_NZ.UTF-8/en_NZ.UTF-8/C/en_NZ.UTF-8/en_NZ.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] ggmap_2.7          ggplot2_2.2.1.9000 rgdal_1.2-5        sp_1.2-4
>
>
> loaded via a namespace (and not attached):
>  [1] Rcpp_0.12.9       magrittr_1.5      maps_3.1.1        munsell_0.4.3
>   colorspace_1.3-2  geosphere_1.5-5
>  [7] lattice_0.20-34   R6_2.2.0          rjson_0.2.15      jpeg_0.1-8
>    dplyr_0.5.0       stringr_1.1.0
> [13] plyr_1.8.4        tools_3.3.2       grid_3.3.2        gtable_0.2.0
>    png_0.1-7         DBI_0.5-1
> [19] lazyeval_0.2.0    assertthat_0.1    tibble_1.2        mapproj_1.2-4
>   reshape2_1.4.2    bitops_1.0-6
> [25] stringi_1.1.2     RgoogleMaps_1.4.1 scales_0.4.1      proto_1.0.0
>
> Any help would be greatly appreciated. I will be out the office for a week
> on fieldwork in a couple of hours, after which I won't be able to test
> anything until I return.
>
> Kind regards,
>
> Olivia
>
>
>
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Fri Jan 27 10:32:06 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 Jan 2017 10:32:06 +0100
Subject: [R-sig-Geo] rgdal error in pj_transform: failed to load datum
 shift file
In-Reply-To: <CAN7eD0S7pVS557_hDW0bNe_X5Lr=yG3wGp5qGVLKiHHxXDiDEQ@mail.gmail.com>
References: <CAN7eD0RktoZnpxc57fHTNO8_kDtdY+_2BG-ip2VZT-fRAiipQQ@mail.gmail.com>
	<CAN7eD0S7pVS557_hDW0bNe_X5Lr=yG3wGp5qGVLKiHHxXDiDEQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1701271027100.5137@reclus.nhh.no>

You didn't say that you were using OSX, and probably originally the CRAN 
OSX rgdal binary. If that is the case, until we get it fixed, please see 
if you can download the equivalent Windows binary package:

https://cran.r-project.org/bin/windows/contrib/3.3/rgdal_1.2-5.zip

unzip it (do not install it), and copy the proj/ and gdal/ folders with
their contents to the folder shown (in R) by:

system.file("", package="rgdal")

The problem you most likely found was that the person building CRAN rgdal 
OSX binaries forgot to set configure arguments to package these two 
folders. You also probably ignored a startup warning.

For rgdal queries, always state verbatim the output of sessionInfo() and 
the output of the startup messages shown when rgdal is loaded and 
attached.

Roger

On Fri, 27 Jan 2017, Olivia Burge wrote:

> Dear all,
>
> Fixed eventually after using a number of different install options, of
> which only this one worked:
>
> install.packages('rgdal', type = "source", configure.args=c(
>
> '--with-gdal-config=/Library/Frameworks/GDAL.framework/Programs/gdal-config',
>    '--with-proj-include=/Library/Frameworks/PROJ.framework/Headers',
>    '--with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib',
> '--with-data-copy=yes',
> '--with-proj-data=/Library/Frameworks/PROJ.framework/unix/share/proj'))
>
> The latter two made the difference.
>
> Note in my .bash_profile I also added the gdal path:
> export PATH=/Library/Frameworks/GDAL.framework/Programs:$PATH
>
> Regards,
>
> Olivia
>
> On Fri, Jan 27, 2017 at 3:02 PM Olivia Burge <olivia.burge at gmail.com> wrote:
>
>> Dear list,
>>
>> I am having some trouble transforming data (ie reprojecting) after
>> installing rgdal, etc on a new mac.
>>
>> The error message is:
>>> wgs84 <- CRS("+proj=longlat +datum=WGS84 +no_defs ")
>>> df <- spTransform(locs_sp, CRS = wgs84)
>> Error in spTransform(xSP, CRSobj, ...) :
>>   error in pj_transform: failed to load datum shift file.
>>
>> locs_sp dput output:
>>
>> new("SpatialPointsDataFrame"
>>     , data = structure(list(Plot = c(1L, 2L, 3L, 4L, 5L, 6L, 1L, 1L, 4L,
>> 9L,
>> 19L, 20L), Wetland = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 3L,
>> 4L, 4L, 4L, 4L, 4L), .Label = c("", "Awarua", "Bayswater", "Dunearn"
>> ), class = "factor")), .Names = c("Plot", "Wetland"), row.names = c(NA,
>> 12L), class = "data.frame")
>>     , coords.nrs = numeric(0)
>>     , coords = structure(c(2159130, 2159243, 2159242, 2159240, 2159504,
>> 2157624,
>> 2126982, 2138135, 2138087, 2137919, 2137472, 2137450, 5397279,
>> 5397304, 5397304, 5392166, 5397215, 5395541, 5439946, 5456416,
>> 5456657, 5456657, 5456659, 5456662), .Dim = c(12L, 2L), .Dimnames = list(
>>     c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11",
>>     "12"), c("NZMGE", "NZMGN")))
>>     , bbox = structure(c(2126982, 5392166, 2159504, 5456662), .Dim = c(2L,
>> 2L), .Dimnames = list(c("NZMGE", "NZMGN"), c("min", "max")))
>>     , proj4string = new("CRS"
>>     , projargs = "+proj=nzmg +lat_0=-41 +lon_0=173 +x_0=2510000
>> +y_0=6023150 +ellps=intl +units=m +nadgrids=nzgd2kgrid0005.gsb"
>> )
>> )
>>
>> I have a windows computer with rgdal & R on and it works fine on there.
>>
>> When I load rgdal, I get:
>>> require(rgdal)
>> Loading required package: rgdal
>> Loading required package: sp
>> rgdal: version: 1.2-5, (SVN revision 648)
>>  Geospatial Data Abstraction Library extensions to R successfully loaded
>>  Loaded GDAL runtime: GDAL 2.1.2, released 2016/10/24
>>  Path to GDAL shared files:
>>  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>>  Path to PROJ.4 shared files: (autodetected)
>>  Linking to sp version: 1.2-3
>>
>> I have seen reference to the output of this:
>>> system.file("proj", package= "rgdal")
>> elsewhere. The output is simply ""
>>
>> SessionInfo:
>> R version 3.3.2 (2016-10-31)
>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> Running under: macOS Sierra 10.12.1
>>
>> locale:
>> [1] en_NZ.UTF-8/en_NZ.UTF-8/en_NZ.UTF-8/C/en_NZ.UTF-8/en_NZ.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] ggmap_2.7          ggplot2_2.2.1.9000 rgdal_1.2-5        sp_1.2-4
>>
>>
>> loaded via a namespace (and not attached):
>>  [1] Rcpp_0.12.9       magrittr_1.5      maps_3.1.1        munsell_0.4.3
>>   colorspace_1.3-2  geosphere_1.5-5
>>  [7] lattice_0.20-34   R6_2.2.0          rjson_0.2.15      jpeg_0.1-8
>>    dplyr_0.5.0       stringr_1.1.0
>> [13] plyr_1.8.4        tools_3.3.2       grid_3.3.2        gtable_0.2.0
>>    png_0.1-7         DBI_0.5-1
>> [19] lazyeval_0.2.0    assertthat_0.1    tibble_1.2        mapproj_1.2-4
>>   reshape2_1.4.2    bitops_1.0-6
>> [25] stringi_1.1.2     RgoogleMaps_1.4.1 scales_0.4.1      proto_1.0.0
>>
>> Any help would be greatly appreciated. I will be out the office for a week
>> on fieldwork in a couple of hours, after which I won't be able to test
>> anything until I return.
>>
>> Kind regards,
>>
>> Olivia
>>
>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From tristan.bourgeois at gmail.com  Fri Jan 27 10:41:53 2017
From: tristan.bourgeois at gmail.com (Tristan Bourgeois)
Date: Fri, 27 Jan 2017 10:41:53 +0100
Subject: [R-sig-Geo] R function checking/transforming CRS layer R function
Message-ID: <CACNjsfXtNwCVt9E=LMOET5HAhcbvUgenOzDtc-TXLDS1+PV4VQ@mail.gmail.com>

Dear all,

I'm trying to build up an r function able to check if the projection system
of a layer is in Lambert93 (WSG code : 2154) .
If the condition is false I want to transform the CRS into Lambert 93.

This is what I wrote :

> CRSfunction<-function(couche)
+ {
+   prj_couche<-CRS(couche)
+   prj<-CRS("+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs")
+   if (prj_couche!=prj)
+     {CRS(couche)="+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs" }
+ }
> CRSfunction(UH)
Error in CRS(couche) : no method for coercing this S4 class to a vector
In addition: Warning message:
In is.na(projargs) : is.na() applied to non-(list or vector) of type 'S4'
Called from: CRS(couche)
Browse[1]> Q


Does anybody can help to deal with the mistake I 've made ??

Plus, I'm not sure the function will work with both raster and shapefiles.

Cheers.


Tristan Bourgeois.
R New User

	[[alternative HTML version deleted]]


From HodgessE at uhd.edu  Fri Jan 27 11:28:18 2017
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 27 Jan 2017 10:28:18 +0000
Subject: [R-sig-Geo] R function checking/transforming CRS layer R
	function
In-Reply-To: <CACNjsfXtNwCVt9E=LMOET5HAhcbvUgenOzDtc-TXLDS1+PV4VQ@mail.gmail.com>
References: <CACNjsfXtNwCVt9E=LMOET5HAhcbvUgenOzDtc-TXLDS1+PV4VQ@mail.gmail.com>
Message-ID: <1485512898337.8799@uhd.edu>

Hi Tristan!

I'm looking at your code right now.  What is your input, please; the UH?

Thanks,
Erin


Erin M. Hodgess
Associate Professor
Department of Mathematics and Statistics
University of Houston - Downtown
mailto: hodgesse at uhd.edu

________________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Tristan Bourgeois <tristan.bourgeois at gmail.com>
Sent: Friday, January 27, 2017 3:41 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] R function checking/transforming CRS layer R function

Dear all,

I'm trying to build up an r function able to check if the projection system
of a layer is in Lambert93 (WSG code : 2154) .
If the condition is false I want to transform the CRS into Lambert 93.

This is what I wrote :

> CRSfunction<-function(couche)
+ {
+   prj_couche<-CRS(couche)
+   prj<-CRS("+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs")
+   if (prj_couche!=prj)
+     {CRS(couche)="+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs" }
+ }
> CRSfunction(UH)
Error in CRS(couche) : no method for coercing this S4 class to a vector
In addition: Warning message:
In is.na(projargs) : is.na() applied to non-(list or vector) of type 'S4'
Called from: CRS(couche)
Browse[1]> Q


Does anybody can help to deal with the mistake I 've made ??

Plus, I'm not sure the function will work with both raster and shapefiles.

Cheers.


Tristan Bourgeois.
R New User

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tristan.bourgeois at gmail.com  Fri Jan 27 11:39:45 2017
From: tristan.bourgeois at gmail.com (Tristan Bourgeois)
Date: Fri, 27 Jan 2017 11:39:45 +0100
Subject: [R-sig-Geo] R function checking/transforming CRS layer R
	function
In-Reply-To: <1485512898337.8799@uhd.edu>
References: <CACNjsfXtNwCVt9E=LMOET5HAhcbvUgenOzDtc-TXLDS1+PV4VQ@mail.gmail.com>
	<1485512898337.8799@uhd.edu>
Message-ID: <CACNjsfVgVBktRCX6on-=2Bw61DaCBVTB8u0gZ7tDPjx0rO1hQw@mail.gmail.com>

Hi Erin !

Yes,   I tried to apply my function to "UH"  which is a shapefile.




2017-01-27 11:28 GMT+01:00 Hodgess, Erin <HodgessE at uhd.edu>:

> Hi Tristan!
>
> I'm looking at your code right now.  What is your input, please; the UH?
>
> Thanks,
> Erin
>
>
> Erin M. Hodgess
> Associate Professor
> Department of Mathematics and Statistics
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
> ________________________________________
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Tristan
> Bourgeois <tristan.bourgeois at gmail.com>
> Sent: Friday, January 27, 2017 3:41 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] R function checking/transforming CRS layer R function
>
> Dear all,
>
> I'm trying to build up an r function able to check if the projection system
> of a layer is in Lambert93 (WSG code : 2154) .
> If the condition is false I want to transform the CRS into Lambert 93.
>
> This is what I wrote :
>
> > CRSfunction<-function(couche)
> + {
> +   prj_couche<-CRS(couche)
> +   prj<-CRS("+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
> +x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs")
> +   if (prj_couche!=prj)
> +     {CRS(couche)="+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
> +x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs" }
> + }
> > CRSfunction(UH)
> Error in CRS(couche) : no method for coercing this S4 class to a vector
> In addition: Warning message:
> In is.na(projargs) : is.na() applied to non-(list or vector) of type 'S4'
> Called from: CRS(couche)
> Browse[1]> Q
>
>
> Does anybody can help to deal with the mistake I 've made ??
>
> Plus, I'm not sure the function will work with both raster and shapefiles.
>
> Cheers.
>
>
> Tristan Bourgeois.
> R New User
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Tristan Bourgeois

	[[alternative HTML version deleted]]


From HodgessE at uhd.edu  Fri Jan 27 12:15:45 2017
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 27 Jan 2017 11:15:45 +0000
Subject: [R-sig-Geo] R function checking/transforming CRS layer R
	function
In-Reply-To: <CACNjsfVgVBktRCX6on-=2Bw61DaCBVTB8u0gZ7tDPjx0rO1hQw@mail.gmail.com>
References: <CACNjsfXtNwCVt9E=LMOET5HAhcbvUgenOzDtc-TXLDS1+PV4VQ@mail.gmail.com>
	<1485512898337.8799@uhd.edu>,
	<CACNjsfVgVBktRCX6on-=2Bw61DaCBVTB8u0gZ7tDPjx0rO1hQw@mail.gmail.com>
Message-ID: <1485515744786.72221@uhd.edu>

Hi again!


Give this bad boy a shot:






CRSfunction<-function(couche)

 {


   prj_couche<-couche at proj4string

   prj_couche_c <- couche at proj4string@projargs

   prj<-CRS("+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3

x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs")

   prj_c <- "+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3

x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs"


   if (prj_couche_c != prj_c){

     couche at proj4string <- prj

           }

 }




Erin M. Hodgess
Associate Professor
Department of Mathematics and Statistics
University of Houston - Downtown
mailto: hodgesse at uhd.edu
________________________________
From: Tristan Bourgeois <tristan.bourgeois at gmail.com>
Sent: Friday, January 27, 2017 4:39 AM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] R function checking/transforming CRS layer R function

Hi Erin !

Yes,   I tried to apply my function to "UH"  which is a shapefile.




2017-01-27 11:28 GMT+01:00 Hodgess, Erin <HodgessE at uhd.edu<mailto:HodgessE at uhd.edu>>:
Hi Tristan!

I'm looking at your code right now.  What is your input, please; the UH?

Thanks,
Erin


Erin M. Hodgess
Associate Professor
Department of Mathematics and Statistics
University of Houston - Downtown
mailto: hodgesse at uhd.edu<mailto:hodgesse at uhd.edu>

________________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>> on behalf of Tristan Bourgeois <tristan.bourgeois at gmail.com<mailto:tristan.bourgeois at gmail.com>>
Sent: Friday, January 27, 2017 3:41 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [R-sig-Geo] R function checking/transforming CRS layer R function

Dear all,

I'm trying to build up an r function able to check if the projection system
of a layer is in Lambert93 (WSG code : 2154) .
If the condition is false I want to transform the CRS into Lambert 93.

This is what I wrote :

> CRSfunction<-function(couche)
+ {
+   prj_couche<-CRS(couche)
+   prj<-CRS("+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs")
+   if (prj_couche!=prj)
+     {CRS(couche)="+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3
+x_0=700000 +y_0=6600000 +ellps=GRS80 +units=m +no_defs" }
+ }
> CRSfunction(UH)
Error in CRS(couche) : no method for coercing this S4 class to a vector
In addition: Warning message:
In is.na<http://is.na>(projargs) : is.na<http://is.na>() applied to non-(list or vector) of type 'S4'
Called from: CRS(couche)
Browse[1]> Q


Does anybody can help to deal with the mistake I 've made ??

Plus, I'm not sure the function will work with both raster and shapefiles.

Cheers.


Tristan Bourgeois.
R New User

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Tristan Bourgeois

	[[alternative HTML version deleted]]


From paul.lantos at duke.edu  Sat Jan 28 06:29:40 2017
From: paul.lantos at duke.edu (Paul Lantos)
Date: Sat, 28 Jan 2017 05:29:40 +0000
Subject: [R-sig-Geo] jitter within polygon
Message-ID: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


	[[alternative HTML version deleted]]


From jbaldwin at fs.fed.us  Sat Jan 28 06:46:55 2017
From: jbaldwin at fs.fed.us (Baldwin, Jim -FS)
Date: Sat, 28 Jan 2017 05:46:55 +0000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
Message-ID: <dbeaf6fd95554271a139b59266245503@CY1PR0204MB0101.001f.mgd2.msft.net>

Sounds like you need a "point-in-polygon" routine to determine if the jittered point is still within the polygon.

R has several such routines.  Here are two:

  pnt.in.poly in the SDMTools package
  point.in.polygon in the sp package

Mathematica has several options, too.

Jim



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Paul Lantos
Sent: Friday, January 27, 2017 9:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




This electronic message contains information generated by the USDA solely for the intended recipients. Any unauthorized interception of this message or the use or disclosure of the information it contains may violate the law and subject the violator to civil or criminal penalties. If you believe you have received this message in error, please notify the sender and delete the email immediately.


From paul.lantos at duke.edu  Sat Jan 28 06:48:35 2017
From: paul.lantos at duke.edu (Paul Lantos)
Date: Sat, 28 Jan 2017 05:48:35 +0000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <dbeaf6fd95554271a139b59266245503@CY1PR0204MB0101.001f.mgd2.msft.net>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
	<dbeaf6fd95554271a139b59266245503@CY1PR0204MB0101.001f.mgd2.msft.net>
Message-ID: <CY1PR05MB191559BEACA41E1C317A181B92490@CY1PR05MB1915.namprd05.prod.outlook.com>

Thanks, Jim. There isn't a way to specify the polygons a priori in order to constrain the jittering?

Paul

-----Original Message-----
From: Baldwin, Jim -FS [mailto:jbaldwin at fs.fed.us] 
Sent: Saturday, January 28, 2017 12:47 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Sounds like you need a "point-in-polygon" routine to determine if the jittered point is still within the polygon.

R has several such routines.  Here are two:

  pnt.in.poly in the SDMTools package
  point.in.polygon in the sp package

Mathematica has several options, too.

Jim



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Paul Lantos
Sent: Friday, January 27, 2017 9:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwIFAg&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=i4hWU9_Gy7AChLfLUddISsWbzbyNPkZ_ooonniSZoIY&s=ner0DbrTVNhQ2EgrDupUQkMsjZKVTOJHFF9CSyjUypU&e= 




This electronic message contains information generated by the USDA solely for the intended recipients. Any unauthorized interception of this message or the use or disclosure of the information it contains may violate the law and subject the violator to civil or criminal penalties. If you believe you have received this message in error, please notify the sender and delete the email immediately.


From obrlsoilau at gmail.com  Sat Jan 28 07:02:52 2017
From: obrlsoilau at gmail.com (obrlsoilau at gmail.com)
Date: Sat, 28 Jan 2017 16:02:52 +1000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
Message-ID: <588c340e.82dc620a.7528b.eb17@mx.google.com>

Maybe try this sampler - https://gist.github.com/obrl-soil/839b192da46978351733483421db22f8 

You?d want to run it multiple times and cycle through the outputs, if I?m interpreting your request correctly.

Cheers
@obrl_soil

From: Paul Lantos
Sent: Saturday, 28 January 2017 3:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From jbaldwin at fs.fed.us  Sat Jan 28 07:21:42 2017
From: jbaldwin at fs.fed.us (Baldwin, Jim -FS)
Date: Sat, 28 Jan 2017 06:21:42 +0000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <CY1PR05MB191559BEACA41E1C317A181B92490@CY1PR05MB1915.namprd05.prod.outlook.com>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
	<dbeaf6fd95554271a139b59266245503@CY1PR0204MB0101.001f.mgd2.msft.net>
	<CY1PR05MB191559BEACA41E1C317A181B92490@CY1PR05MB1915.namprd05.prod.outlook.com>
Message-ID: <003ae3286d984a7288f0932998a8380c@CY1PR0204MB0101.001f.mgd2.msft.net>

Point-in-polygon routines are pretty fast and straightforward to use.  If it's about reducing computing time, then maybe for "irregular" polygons it would be easier to stratify the points into two groups:  those points whose jittering would not go outside the polygon and those that might and only use point-in-polygon on the potentially outside points.  However, I'd try the point-in-polygon route first and see if it is fast enough first.


Jim


-----Original Message-----
From: Paul Lantos [mailto:paul.lantos at duke.edu] 
Sent: Friday, January 27, 2017 9:49 PM
To: Baldwin, Jim -FS <jbaldwin at fs.fed.us>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Thanks, Jim. There isn't a way to specify the polygons a priori in order to constrain the jittering?

Paul

-----Original Message-----
From: Baldwin, Jim -FS [mailto:jbaldwin at fs.fed.us] 
Sent: Saturday, January 28, 2017 12:47 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Sounds like you need a "point-in-polygon" routine to determine if the jittered point is still within the polygon.

R has several such routines.  Here are two:

  pnt.in.poly in the SDMTools package
  point.in.polygon in the sp package

Mathematica has several options, too.

Jim



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Paul Lantos
Sent: Friday, January 27, 2017 9:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwIFAg&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=i4hWU9_Gy7AChLfLUddISsWbzbyNPkZ_ooonniSZoIY&s=ner0DbrTVNhQ2EgrDupUQkMsjZKVTOJHFF9CSyjUypU&e= 




This electronic message contains information generated by the USDA solely for the intended recipients. Any unauthorized interception of this message or the use or disclosure of the information it contains may violate the law and subject the violator to civil or criminal penalties. If you believe you have received this message in error, please notify the sender and delete the email immediately.


From paul.lantos at duke.edu  Sat Jan 28 07:24:46 2017
From: paul.lantos at duke.edu (Paul Lantos)
Date: Sat, 28 Jan 2017 06:24:46 +0000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <003ae3286d984a7288f0932998a8380c@CY1PR0204MB0101.001f.mgd2.msft.net>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
	<dbeaf6fd95554271a139b59266245503@CY1PR0204MB0101.001f.mgd2.msft.net>
	<CY1PR05MB191559BEACA41E1C317A181B92490@CY1PR05MB1915.namprd05.prod.outlook.com>
	<003ae3286d984a7288f0932998a8380c@CY1PR0204MB0101.001f.mgd2.msft.net>
Message-ID: <CY1PR05MB191565AB563D4CFA8403DDA792490@CY1PR05MB1915.namprd05.prod.outlook.com>

Ok, thanks. It's for about 100,000 points within thousands of polygons, and they need to 1) remain within a polygon and 2) retain original attribute data. Could be a challenging workflow...
Paul

-----Original Message-----
From: Baldwin, Jim -FS [mailto:jbaldwin at fs.fed.us] 
Sent: Saturday, January 28, 2017 1:22 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Point-in-polygon routines are pretty fast and straightforward to use.  If it's about reducing computing time, then maybe for "irregular" polygons it would be easier to stratify the points into two groups:  those points whose jittering would not go outside the polygon and those that might and only use point-in-polygon on the potentially outside points.  However, I'd try the point-in-polygon route first and see if it is fast enough first.


Jim


-----Original Message-----
From: Paul Lantos [mailto:paul.lantos at duke.edu] 
Sent: Friday, January 27, 2017 9:49 PM
To: Baldwin, Jim -FS <jbaldwin at fs.fed.us>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Thanks, Jim. There isn't a way to specify the polygons a priori in order to constrain the jittering?

Paul

-----Original Message-----
From: Baldwin, Jim -FS [mailto:jbaldwin at fs.fed.us] 
Sent: Saturday, January 28, 2017 12:47 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
Subject: RE: jitter within polygon

Sounds like you need a "point-in-polygon" routine to determine if the jittered point is still within the polygon.

R has several such routines.  Here are two:

  pnt.in.poly in the SDMTools package
  point.in.polygon in the sp package

Mathematica has several options, too.

Jim



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Paul Lantos
Sent: Friday, January 27, 2017 9:30 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwIFAg&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=i4hWU9_Gy7AChLfLUddISsWbzbyNPkZ_ooonniSZoIY&s=ner0DbrTVNhQ2EgrDupUQkMsjZKVTOJHFF9CSyjUypU&e= 




This electronic message contains information generated by the USDA solely for the intended recipients. Any unauthorized interception of this message or the use or disclosure of the information it contains may violate the law and subject the violator to civil or criminal penalties. If you believe you have received this message in error, please notify the sender and delete the email immediately.


From paul.lantos at duke.edu  Sat Jan 28 07:27:31 2017
From: paul.lantos at duke.edu (Paul Lantos)
Date: Sat, 28 Jan 2017 06:27:31 +0000
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <588c340e.82dc620a.7528b.eb17@mx.google.com>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
	<588c340e.82dc620a.7528b.eb17@mx.google.com>
Message-ID: <CY1PR05MB19154AD1B02E9A68E37FD73392490@CY1PR05MB1915.namprd05.prod.outlook.com>

Thanks, will take a look!

Paul

From: obrlsoilau at gmail.com [mailto:obrlsoilau at gmail.com]
Sent: Saturday, January 28, 2017 1:03 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org; obrl_soil <obrlsoilau at gmail.com>
Subject: RE: [R-sig-Geo] jitter within polygon

Maybe try this sampler - https://gist.github.com/obrl-soil/839b192da46978351733483421db22f8<https://urldefense.proofpoint.com/v2/url?u=https-3A__gist.github.com_obrl-2Dsoil_839b192da46978351733483421db22f8&d=CwMGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=JsxKvUqShLm0BOKkwOldeOLeDanBw61LAAhZ6snUYW4&s=7U1IpidxWg5KFM1OLw0uCC1KWrtiHLMn9m0W6UfKPtQ&e=>

You?d want to run it multiple times and cycle through the outputs, if I?m interpreting your request correctly.

Cheers
@obrl_soil<mailto:obrlsoilau at gmail.com>

From: Paul Lantos<mailto:paul.lantos at duke.edu>
Sent: Saturday, 28 January 2017 3:30 PM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [R-sig-Geo] jitter within polygon

I am trying to figure out how to randomly jitter points within an overlying polygon structure.

I can easily jitter the points themselves, but I would like this to be constrained by the boundaries of polygons containing the points.

This isn't for visualization - I can do that easily enough in GIS. I actually need to generate coordinates.

Thanks,
Paul

Paul M. Lantos, MD, MS GIS, FIDSA, FAAP, FACP                       Contact
Departments of Internal Medicine and Pediatrics                           919-684-6355 (Pediatric Infectious Diseases)
    Pediatric Infectious Diseases                                                                919-681-8263 (Hospital Medicine)
    General Internal Medicine                                                                    paul.lantos at duke.edu<mailto:paul.lantos at duke.edu>
Duke University School of Medicine                                                     @PaulLantos
Duke Global Health Institute


           [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From loic.dutrieux at conabio.gob.mx  Sun Jan 29 20:26:17 2017
From: loic.dutrieux at conabio.gob.mx (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Sun, 29 Jan 2017 13:26:17 -0600
Subject: [R-sig-Geo] getData returns status 403
Message-ID: <bf4a3094-1039-2c7e-179b-cb3cbaa7b155@conabio.gob.mx>

Hi,

Were there any changes made to the ucdavis server, from which getData()
gets its data? I'm trying to download a spatialpolygondataframe of the
world, but it returns a status 403. Can anyone reproduce?
Same thing happens when I try to run the url in the browser or with wget.

Also, is r-forge down right now? I tried to check the development
version of raster but couldn't reach anything.

> library(raster)

> world <- getData(name = 'countries')
trying URL 'http://biogeo.ucdavis.edu/data/gadm2.6/countries_gadm26.rds'
Error in utils::download.file(url = aurl, destfile = fn, method =
"auto",  :
  cannot open URL
'http://biogeo.ucdavis.edu/data/gadm2.6/countries_gadm26.rds'
In addition: Warning message:
In utils::download.file(url = aurl, destfile = fn, method = "auto",  :
  cannot open URL
'http://biogeo.ucdavis.edu/data/gadm2.6/countries_gadm26.rds': HTTP
status was '403 Forbidden'

Cheers,
Lo?c


From hunter.currie at gmail.com  Sun Jan 29 22:49:58 2017
From: hunter.currie at gmail.com (dave)
Date: Sun, 29 Jan 2017 21:49:58 +0000
Subject: [R-sig-Geo] R function checking/transforming CRS layer R
	function
Message-ID: <CABx+ybknobgXW9HJ1s5CqQqoHT0y3C2rUf+XUxMhjj-RDUSQ7w@mail.gmail.com>

If your original data is not in the desired projection, changing the CRS
attributes will not do the transformation for you.  In the case of vector
data, you will need to use spTransform().  For raster data, you might be
able to use projectRaster() but I would recommend using gdalwarp().

I wrote a brief blog post about this question, here:

https://geoanalytic.github.io/coordinate-reference-systems-in-r/

Regards,

David Currie, P.Eng

	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Sun Jan 29 22:56:16 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 30 Jan 2017 10:56:16 +1300
Subject: [R-sig-Geo] jitter within polygon
In-Reply-To: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
References: <CY1PR05MB1915194A5A23651DF1908E3392490@CY1PR05MB1915.namprd05.prod.outlook.com>
Message-ID: <b6fd664b-04e2-720b-9fd1-947a7b6ed92d@auckland.ac.nz>


On 28/01/17 18:29, Paul Lantos wrote:

> I am trying to figure out how to randomly jitter points within an
> overlying polygon structure.
>
> I can easily jitter the points themselves, but I would like this to
> be constrained by the boundaries of polygons containing the points.
>
> This isn't for visualization - I can do that easily enough in GIS. I
> actually need to generate coordinates.

You can do this easily in spatstat by making each polygon into an object 
of class "owin" (see e.g. the "shapefiles" vignette) and then using the 
function rjitter() (with retry=TRUE).

Note that if you have a collection of polygons some of which are close
to being contiguous, it is possible (or at least conceivable) for a 
jittered point to "jump" to a location inside a different polygon. 
Hence if you were to represent your collection of polygons as a single
(disconnected) "owin" object you would run the risk of incurring this 
"jumping" phenomenon.  Hence it would be safer to bundle your collection 
of polygons into a list, and apply rjitter() to each list entry (using 
lapply()).

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From eta6 at cdc.gov  Mon Jan 30 02:20:25 2017
From: eta6 at cdc.gov (Suarez-Soto, Rene J. (ATSDR/DCHI/SSB))
Date: Mon, 30 Jan 2017 01:20:25 +0000
Subject: [R-sig-Geo] rgdal sqlite does not work in QGIS
Message-ID: <28e3a0b1c516497082f86e90df7f87e7@cdc.gov>

I am trying to save some spatial dataframes to a spatialite database that I want to use in QGIS. Every time I try to connect to the database in QGIS I get a "failed to check metadata error". I am using QGIS 2.18.2 and some of the R sessioninfo is below.

I tried using the following example and sample data from rgdal and I get the same erroring QGIS

library(rgdal)
data(nor2k)
rgdal::writeOGR(obj = nor2k, dsn = "geodatabase.sqlite", layer = "norwegian_peaks", overwrite_layer = TRUE, driver = "SQLite")

R version 3.3.2 (2016-10-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1
rgdal version 1.2.5

I tried creating a SpatiaLite database in QGIS and reading it in R using readOGR and it works fine. I see some examples online where writeOGR have the following parameters:

dataset_option="SPATIALITE=YES", layer_option="FORMAT=SPATIALITE"

but it does not seem to work. Any ideas would be appreciated.


	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Jan 30 09:35:17 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 30 Jan 2017 09:35:17 +0100
Subject: [R-sig-Geo] R function checking/transforming CRS layer R
 function
In-Reply-To: <CABx+ybknobgXW9HJ1s5CqQqoHT0y3C2rUf+XUxMhjj-RDUSQ7w@mail.gmail.com>
References: <CABx+ybknobgXW9HJ1s5CqQqoHT0y3C2rUf+XUxMhjj-RDUSQ7w@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1701300932500.3351@reclus.nhh.no>

On Sun, 29 Jan 2017, dave wrote:

> If your original data is not in the desired projection, changing the CRS
> attributes will not do the transformation for you.  In the case of vector
> data, you will need to use spTransform().  For raster data, you might be
> able to use projectRaster() but I would recommend using gdalwarp().

For a properly referenced discussion, see for example "Maps, Coordinate 
Reference Systems and Visualising Geographic Data with mapmisc":

https://journal.r-project.org/archive/2016-1/brown.pdf

Roger

>
> I wrote a brief blog post about this question, here:
>
> https://geoanalytic.github.io/coordinate-reference-systems-in-r/
>

OK, but blog posts have the strength of appearing easy to read, but the 
weakness of being too easy to read ...

Roger

> Regards,
>
> David Currie, P.Eng
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From b.rowlingson at lancaster.ac.uk  Mon Jan 30 15:19:51 2017
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 30 Jan 2017 14:19:51 +0000
Subject: [R-sig-Geo] getData returns status 403
In-Reply-To: <bf4a3094-1039-2c7e-179b-cb3cbaa7b155@conabio.gob.mx>
References: <bf4a3094-1039-2c7e-179b-cb3cbaa7b155@conabio.gob.mx>
Message-ID: <CANVKczPu7hu0XLHRh7bfsYBuaJBk5but9Q1U6ec4Bch5ipMMuA@mail.gmail.com>

On Sun, Jan 29, 2017 at 7:26 PM, Lo?c Dutrieux
<loic.dutrieux at conabio.gob.mx> wrote:
> world <- getData(name = 'countries')

The world countries file download function has a hardcoded version in it:

> raster:::.countries
function (download, path, ...)
{
    filename <- paste(path, "countries.RData", sep = "")
    if (!file.exists(filename)) {
        if (download) {
            theurl <-
paste("http://biogeo.ucdavis.edu/data/gadm2.6/countries_gadm26.rds",
                sep = "")


 and everything else is _gadm28 now. The getData function pastes the
version number "28" into URLS for individual country data.

Suggest you download
http://biogeo.ucdavis.edu/data/gadm2.8/countries_gadm28.rds manually
for now and ping Robert Hijmans with a bug report....

Barry


From Hollister.Jeff at epa.gov  Mon Jan 30 16:02:02 2017
From: Hollister.Jeff at epa.gov (Hollister, Jeff)
Date: Mon, 30 Jan 2017 15:02:02 +0000
Subject: [R-sig-Geo] Elevation data in R: elevatr v0.1.1
Message-ID: <BY2PR09MB0676EE68AF995345CDC9AD2D814B0@BY2PR09MB0676.namprd09.prod.outlook.com>

All,

Just wanted to share this with the group.  A new package for accessing elevation data in R, elevatr, is now on CRAN:  https://cran.r-project.org/package=elevatr

Any questions about the package please let me know either through email or via the issues at https://github.com/jhollist/elevatr

Cheers,
Jeff


*****************************
Dr. Jeffrey W. Hollister
Research Ecologist
27 Tarzwell Drive
Narragansett, RI 02879
(o) 401 782 9655
hollister.jeff at epa.gov
*****************************




	[[alternative HTML version deleted]]


From loic.dutrieux at conabio.gob.mx  Mon Jan 30 20:00:45 2017
From: loic.dutrieux at conabio.gob.mx (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Mon, 30 Jan 2017 13:00:45 -0600
Subject: [R-sig-Geo] getData returns status 403
In-Reply-To: <CANVKczPu7hu0XLHRh7bfsYBuaJBk5but9Q1U6ec4Bch5ipMMuA@mail.gmail.com>
References: <bf4a3094-1039-2c7e-179b-cb3cbaa7b155@conabio.gob.mx>
	<CANVKczPu7hu0XLHRh7bfsYBuaJBk5but9Q1U6ec4Bch5ipMMuA@mail.gmail.com>
Message-ID: <7d989dc7-d13c-9b81-60ca-03f1f15bbff1@conabio.gob.mx>

Thanks for figuring it out Barry. I informed Robert about it.

Cheers,
Lo?c

On 30/01/2017 08:19, Barry Rowlingson wrote:
> On Sun, Jan 29, 2017 at 7:26 PM, Lo?c Dutrieux
> <loic.dutrieux at conabio.gob.mx> wrote:
>> world <- getData(name = 'countries')
> 
> The world countries file download function has a hardcoded version in it:
> 
>> raster:::.countries
> function (download, path, ...)
> {
>     filename <- paste(path, "countries.RData", sep = "")
>     if (!file.exists(filename)) {
>         if (download) {
>             theurl <-
> paste("http://biogeo.ucdavis.edu/data/gadm2.6/countries_gadm26.rds",
>                 sep = "")
> 
> 
>  and everything else is _gadm28 now. The getData function pastes the
> version number "28" into URLS for individual country data.
> 
> Suggest you download
> http://biogeo.ucdavis.edu/data/gadm2.8/countries_gadm28.rds manually
> for now and ping Robert Hijmans with a bug report....
> 
> Barry
> 
> Email secured by Check Point
>


