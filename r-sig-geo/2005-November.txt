From jeanniet at geo.umass.edu  Tue Nov  1 17:46:56 2005
From: jeanniet at geo.umass.edu (Jeanne Thibeault)
Date: Tue, 1 Nov 2005 11:46:56 -0500
Subject: [R-sig-Geo] mapping contours
Message-ID: <200511011646.jA1GkgfV020228@eclogite.geo.umass.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20051101/42522141/attachment.pl>

From jeanniet at geo.umass.edu  Tue Nov  1 18:31:19 2005
From: jeanniet at geo.umass.edu (Jeanne Thibeault)
Date: Tue, 1 Nov 2005 12:31:19 -0500
Subject: [R-sig-Geo] mapping contours
Message-ID: <200511011731.jA1HV3h0021841@eclogite.geo.umass.edu>

I'm basically a beginner with R and would like to know the best and easiest
way to add contour lines of climate data to a map. The data consists of
points of longitude and latitude with one climate variable for each point. I
was able to contour the data using akima, but that only provided me with a
rectangular grid. I would appreciate any suggestions on how to add the
contours to an existing map so that they fit appropriately.

 

Thanks,

Jeanne



From Roger.Bivand at nhh.no  Tue Nov  1 18:36:09 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 1 Nov 2005 18:36:09 +0100 (CET)
Subject: [R-sig-Geo] mapping contours
In-Reply-To: <200511011646.jA1GkgfV020228@eclogite.geo.umass.edu>
Message-ID: <Pine.LNX.4.44.0511011827310.18539-100000@reclus.nhh.no>

On Tue, 1 Nov 2005, Jeanne Thibeault wrote:

> I'm basically a beginner with R and would like to know the best and easiest
> way to add contour lines of climate data to a map. The data consists of
> points of longitude and latitude with one climate variable for each point. I
> was able to contour the data using akima, but that only provided me with a
> rectangular grid. I would appreciate any suggestions on how to add the
> contours to an existing map so that they fit appropriately.
> 

Assuming that you have a base map of some kind plotted already, you can 
use the add=TRUE argument to contour() to overplot with contours. There is 
no function in R to construct contours from irregularly placed points, you 
have to use interp() from tha akima package first (or some other 
interpolator - Tps in the fields package is a good alternative if you like 
splines), and go on from there.

If you need the actual lines, you can get them using contourLines(), and 
plot them afterwards - in contour(), they are never returned to the user. 
But to get contours, you need a regular grid first. If you need to, you 
can mask the regular grid with NA values, which contour() and 
contourLines() will respect.

Hope this helps,

Roger

PS.

Showing an informative excerpt of the code you've already tried may get 
you a more focussed response. Since this is climate data, the fields 
package may already have things you can use.

>  
> 
> Thanks,
> 
> Jeanne
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From agustin at unex.es  Mon Nov  7 16:26:46 2005
From: agustin at unex.es (=?iso-8859-1?Q?Jos=E9_Agust=EDn_Garc=EDa_Garc=EDa?=)
Date: Mon, 7 Nov 2005 16:26:46 +0100
Subject: [R-sig-Geo] image in a projected map
Message-ID: <a06210200bf951ff0c27d@[158.49.31.67]>

Hi all, I am working on some climate data and I 
need to make some projected maps of the results 
of climate models. These results are given in a 
gridded format (lon,lat, z).  I have no problem 
at making contourlines using the package sp and 
spproj, but my problem arise when I am going to 
do an image plot of the data, because the grid is 
regular in lat-long coordinates but not in the 
projected map.  Also, I have problems trying to 
label meridians and parallels.  Any help is 
wellcome.

Sorry for my english

Agustin
-- 
Jos? Agust?n Garc?a
Departamento de F?sica, Universidad de Extremadura
06071 Badajoz, Spain
Tfn. +34-924-289536, Fax. +34-924-289651, email agustin at unex.es



From e.pebesma at geog.uu.nl  Mon Nov  7 18:03:22 2005
From: e.pebesma at geog.uu.nl (Edzer J. Pebesma)
Date: Mon, 07 Nov 2005 18:03:22 +0100
Subject: [R-sig-Geo] image in a projected map
In-Reply-To: <a06210200bf951ff0c27d@[158.49.31.67]>
References: <a06210200bf951ff0c27d@[158.49.31.67]>
Message-ID: <436F88DA.5000008@geog.uu.nl>

Agustin,

If your data are in a format provided by the sp package,
you could try several routes:
1. convert your grid (points) to points, project the points,
and contour there
2. calculate contours in lat/long (but which package can
do this well, esp. around the poles?), project the
contour lines and plot them
3. transform the grid to (many square) polygons, project
these and plot them, as shown in
http://r-spatial.sourceforge.net/xtra/xtra.RHnw.html#spproj

Hope this helps,
--
Edzer

Jos? Agust?n Garc?a Garc?a wrote:

>Hi all, I am working on some climate data and I 
>need to make some projected maps of the results 
>of climate models. These results are given in a 
>gridded format (lon,lat, z).  I have no problem 
>at making contourlines using the package sp and 
>spproj, but my problem arise when I am going to 
>do an image plot of the data, because the grid is 
>regular in lat-long coordinates but not in the 
>projected map.  Also, I have problems trying to 
>label meridians and parallels.  Any help is 
>wellcome.
>
>Sorry for my english
>
>Agustin
>  
>



From Roger.Bivand at nhh.no  Mon Nov  7 18:45:16 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 7 Nov 2005 18:45:16 +0100 (CET)
Subject: [R-sig-Geo] image in a projected map
In-Reply-To: <a06210200bf951ff0c27d@[158.49.31.67]>
Message-ID: <Pine.LNX.4.44.0511071832280.12240-100000@reclus.nhh.no>

On Mon, 7 Nov 2005, Jos? Agust?n Garc?a Garc?a wrote:

> Hi all, I am working on some climate data and I 
> need to make some projected maps of the results 
> of climate models. These results are given in a 
> gridded format (lon,lat, z).  I have no problem 
> at making contourlines using the package sp and 
> spproj, but my problem arise when I am going to 
> do an image plot of the data, because the grid is 
> regular in lat-long coordinates but not in the 
> projected map.  Also, I have problems trying to 
> label meridians and parallels.  Any help is 
> wellcome.

This will depend on your number of grid cells. If the number isn't large, 
say a couple of thousand, then look at:

?as.SpatialPolygons.GridTopology

in sp, which makes the regular grid cells into polygons, which can then be 
projected, and plotted with border="transparent". If there are many cells, 
this will be very time-consuming. The projection only needs doing once, 
but you need to check that the data are being plugged into the correct 
rows to the data frame. The alternative is to export the longlat grid, for 
example as an Arc ASCII grid, add a *.prj file, and use gdalwarp to warp 
to a projected regular grid, but I guess your prefered representation is 
to show the original grid cells projected, not new projected cells.

> 
> Sorry for my english

No problem, thinking through how to do this is not easy anyway.

Roger

> 
> Agustin
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From neteler at itc.it  Tue Nov  8 11:01:34 2005
From: neteler at itc.it (Markus Neteler)
Date: Tue, 8 Nov 2005 11:01:34 +0100
Subject: [R-sig-Geo] 3D map
In-Reply-To: <OF1578BA53.DFC46049-ON882570AA.006B4052-882570AA.006C8EEA@epamail.epa.gov>
References: <BAY105-F34F8DF12CA4C9822F51B69F86A0@phx.gbl>
	<OF1578BA53.DFC46049-ON882570AA.006B4052-882570AA.006C8EEA@epamail.epa.gov>
Message-ID: <20051108100134.GB11332@thuille.itc.it>

On Sun, Oct 30, 2005 at 11:45:29AM -0800, White.Denis at epamail.epa.gov wrote:
> As with any graphic technique, the utility and appropriateness depend on
> the objective of the presentation.  Showing polygons in persective
> according to some attribute is certainly not inherently a bad idea.
> Here are a couple of examples from experimental GIS software develped in
> the 1970s.  ESRI's 3D Analyst has these capabilities and there are
> examples of that software on the web.

I have added a screenshot how to do it in GRASS/Nviz:

 http://grass.itc.it/grass60/screenshots/viz.php
 (at page bottom)

I can send offlist the steps if there is interest.

Markus



From m_nica at hotmail.com  Tue Nov  8 16:19:51 2005
From: m_nica at hotmail.com (Mihai Nica)
Date: Tue, 08 Nov 2005 09:19:51 -0600
Subject: [R-sig-Geo] 3D map
In-Reply-To: <20051108100134.GB11332@thuille.itc.it>
Message-ID: <BAY105-F22F62C1DB41B004934C3A9F8640@phx.gbl>

I would love to play with it. Thanks,

Mihai Nica, ABD
Jackson State University
170 East Griffith Street G5
Jackson, MS 39201
601 914 0361





>From: Markus Neteler <neteler at itc.it>
>To: White.Denis at epamail.epa.gov
>CC: Mihai Nica <m_nica at hotmail.com>, r-sig-geo at stat.math.ethz.ch
>Subject: Re: [R-sig-Geo] 3D map
>Date: Tue, 8 Nov 2005 11:01:34 +0100
>
>On Sun, Oct 30, 2005 at 11:45:29AM -0800, White.Denis at epamail.epa.gov 
>wrote:
> > As with any graphic technique, the utility and appropriateness depend on
> > the objective of the presentation.  Showing polygons in persective
> > according to some attribute is certainly not inherently a bad idea.
> > Here are a couple of examples from experimental GIS software develped in
> > the 1970s.  ESRI's 3D Analyst has these capabilities and there are
> > examples of that software on the web.
>
>I have added a screenshot how to do it in GRASS/Nviz:
>
>  http://grass.itc.it/grass60/screenshots/viz.php
>  (at page bottom)
>
>I can send offlist the steps if there is interest.
>
>Markus



From jeanniet at geo.umass.edu  Tue Nov  8 23:15:55 2005
From: jeanniet at geo.umass.edu (Jeanne Thibeault)
Date: Tue, 8 Nov 2005 17:15:55 -0500
Subject: [R-sig-Geo] adding contours to a projected map
Message-ID: <200511082215.jA8MFbkV000224@eclogite.geo.umass.edu>

Hello,

I'm having a problem adding contours to a projected map. I was able to do it
before I specified a projection. This is the code:

> Sum.80.83.li <-
interp(SummerO18.80.84.df$longitude,SummerO18.80.84.df$latitude,
+ SummerO18.80.84.df$wt18o)
> eurM <- map(database = "world", interior = FALSE, xlim = c(-10,50),
+ ylim = c(35,60), plot = FALSE)
> map("world", interior = FALSE, xlim = c(-10,50), ylim = c(35,60),
+ projection = "bonne", par = 47, col = "slateblue1")
> map.grid(eurM, labels = FALSE, col = "lightgray", lty = 2, nx = 2, ny = 2)
> contour(Sum.80.83.li, add = TRUE)

Everything was coming out nicely until I tried to add the contours. No
contours printed on the map. Any ideas on what is going wrong?

Thanks,
Jeanne



From Roger.Bivand at nhh.no  Wed Nov  9 09:20:54 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 Nov 2005 09:20:54 +0100 (CET)
Subject: [R-sig-Geo] [R] useR! 2006: submission & registration started! (fwd)
Message-ID: <Pine.LNX.4.44.0511090914200.13747-100000@reclus.nhh.no>

I would like to drawn the attention of list participants to useR! 2006 in 
Vienna in June. Spatial statistics are one of the topical areas, and I 
would strongly encourage you to consider attending, and particularly to 
submit abstracts for work in progress. The meeting goes beyond regular 
academic forms, and there is plenty of opportunity to mix, meet people, 
and exchange views on applied data analysis. If you are uncertain about 
submitting a proposal, please contact me off-list about your concerns.

Looking forward to seeing as many R-geo people as can make it to Vienna in 
June!

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


---------- Forwarded message ----------
Date: Wed, 9 Nov 2005 09:02:15 +0100 (CET)
From: Torsten Hothorn <Torsten.Hothorn at rzmail.uni-erlangen.de>
Reply-To: torsten at hothorn.de
To: r-help at stat.math.ethz.ch, r-devel at stat.math.ethz.ch
Cc: user-2006 at R-project.org
Subject: [R] useR! 2006: submission & registration started!


We are happy to inform you that the online abstract submission and
registration for `useR! 2006' is now available online from
  http://www.R-project.org/useR-2006/

This second world meeting of the R user community will take place at
the Wirtschaftsuniversitaet Wien, Vienna, Austria, June 15 to 17 2006.
The conference schedule comprises keynote lectures and user-contributed
sessions as well as half-day tutorials presented by R experts on June 14,
2006, prior to the conference.

Keynote lectures addressing hot topics including data mining, graphics,
marketing or teaching with R will be presented by prominent speakers
including John Chambers, Jan de Leeuw, Brian Everitt, Travor Hastie, John
Fox, Stefano Iacus, Uwe Ligges, Paul Murrell, Peter Rossi, Simon Urbanek
and Sanford Weisberg.

The spectrum of user-contributed sessions will depend on your submissions.
Hence, we invite you to submit abstracts on topics presenting innovations
or exciting applications of R. The call for papers along with the link to
the online abstract submission is available at
  http://www.R-project.org/useR-2006/#Call

Before the start of the official program, half-day tutorials will be
offered on Wednesday, June 14th, a list of topics and speakers can be
found at
  http://www.R-project.org/useR-2006/Tutorials/

A special highlight of the conference will be a panel discussion on
`Getting recognition for excellence in computational statistics'. Editors
of well established journals in both computational and applied statistics
will discuss the impact of recent developments in computational statistics
on peer-reviewed journal publications. Currently, the panelists include
Jan de Leeuw (JSS), Brian Everitt (SMMR), Wolfgang Haerdle (CS), Nicholas
Jewell (SMGMB), Erricos Konthogiorges (CSDA), and Luke Tierney (JCGS).

Early birds fly until January 31st 2006, so now is the perfect time to
write and submit an abstract, register as a participant and plan your trip
to Vienna. The conference web page
  http://www.R-project.org/useR-2006/
has a link to a local hotel booking service and much more news.

See you in Vienna!
Torsten, Achim, David, Bettina, Kurt and Fritz

______________________________________________
R-help at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html



From Roger.Bivand at nhh.no  Wed Nov  9 09:39:34 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 Nov 2005 09:39:34 +0100 (CET)
Subject: [R-sig-Geo] adding contours to a projected map
In-Reply-To: <200511082215.jA8MFbkV000224@eclogite.geo.umass.edu>
Message-ID: <Pine.LNX.4.44.0511090921030.13747-100000@reclus.nhh.no>

On Tue, 8 Nov 2005, Jeanne Thibeault wrote:

> Hello,
> 
> I'm having a problem adding contours to a projected map. I was able to do it
> before I specified a projection. This is the code:
> 
> > Sum.80.83.li <-
> interp(SummerO18.80.84.df$longitude,SummerO18.80.84.df$latitude,
> + SummerO18.80.84.df$wt18o)
> > eurM <- map(database = "world", interior = FALSE, xlim = c(-10,50),
> + ylim = c(35,60), plot = FALSE)
> > map("world", interior = FALSE, xlim = c(-10,50), ylim = c(35,60),
> + projection = "bonne", par = 47, col = "slateblue1")
> > map.grid(eurM, labels = FALSE, col = "lightgray", lty = 2, nx = 2, ny = 2)
> > contour(Sum.80.83.li, add = TRUE)
> 
> Everything was coming out nicely until I tried to add the contours. No
> contours printed on the map. Any ideas on what is going wrong?

contour() is a base graphics generic function, and has no idea where to 
plot, so plots in the input coordinate system xlim = c(-10,50), ylim = 
c(35,60). When map() projects, the output coordinate system is changed:

> library(maps)
> eurobonne <- map("world", interior = FALSE, xlim = c(-10,50), 
+ ylim = c(35,60), projection = "bonne", par = 47, plot=FALSE)
> range(eurobonne$x, na.rm=TRUE)
[1] -0.3668910  0.3308747
> range(eurobonne$y, na.rm=TRUE)
[1] -1.1721820 -0.6617041

so contour() misses the output plot region (y overshoots).

With a little work, you can use contourLines():

res <- contourLines(Sum.80.83.li)
contours_x <- unlist(sapply(res, function(x) c(x$x, NA)))
contours_y <- unlist(sapply(res, function(x) c(x$y, NA)))
contours <- list(x=contours_x, y=contours_y)

gets you contours you can give as an argument to mapproject(), but you'll 
need to handle label positions and values yourself based on res - look at 
str(res[[1]]) to get a view of what the raw contours look like.

plot(mapproject(contours, ...), type="l")

does the plotting.

> 
> Thanks,
> Jeanne
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From v.gomezrubio at imperial.ac.uk  Wed Nov  9 19:00:58 2005
From: v.gomezrubio at imperial.ac.uk (=?ISO-8859-1?Q?=22G=F3mez_Rubio=2C_Virgilio=22?=)
Date: Wed, 09 Nov 2005 18:00:58 +0000
Subject: [R-sig-Geo] Small Area Estimation with R
Message-ID: <4372395A.9090203@imperial.ac.uk>

Dear R users,

First of all, excuse for the cross posting. I am working on Small Area 
Estimation and I was
wondering if someone knows about software to compute GREG, syntehtic and/or
(E)BLUP estimators with R.  I know that it should be posible to compute 
those
estimators using package nlme (for example), but I  thought that perhaps 
someone had already
written  some code to include spatial and/or spatio-temporal random effects.

Thanks in advance. Best regards,

Virgilio



From stanimura-ngs at umin.ac.jp  Sat Nov 12 02:13:23 2005
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Sat, 12 Nov 2005 10:13:23 +0900
Subject: [R-sig-Geo] Small Area Estimation with R
In-Reply-To: <4372395A.9090203@imperial.ac.uk>
References: <4372395A.9090203@imperial.ac.uk>
Message-ID: <20051112101323.e4c57c9f.stanimura-ngs@umin.ac.jp>

Dear Virgilio

It is happy to see Virgilio's e-mail because I am very interested in him as
an author of DCluster and RArcInfo.

Although I know neither GREG nor BLUP, I guess calibrate() in survey
and ranef() in nlme may rouse your interest.

Recently, I found two papers, for which I had been waiting because
these are not draft anymore.  Instead of you, let me introduce here.

V. G{\'o}mez-Rubio and J. Ferr{\'a}ndiz-Ferragud and
 A. L{\'o}pez-Qu{\'i}lez. Detecting clusters of disease with R,
 Journal of Geographical Systems, Volume 7, Issue 2, Jun 2005, Pages
 189 - 206

V. G{\'o}mez-Rubio and J. Ferr{\'a}ndiz-Ferragud.
 RArcInfo: Using GIS data with R, Computers and Geosciences, 2005,
 31 (8), Pages 1000-1006.

A matter of regret is that the word "DCluster" was missed in the title
of "Detecting clusters of disease with R".

Best regards,

--
Susumu Tanimura
Dept. of Socio-environmental Medicine
Inst. of Tropical Medicine, Nagasaki University
TEL 095-849-7865 FAX 095-849-7867
e-mail stanimura-ngs at umin.ac.jp



From leaflovesun at yahoo.ca  Sat Nov 12 22:55:46 2005
From: leaflovesun at yahoo.ca (Leaf Sun)
Date: Sat, 12 Nov 2005 14:55:46 -0700
Subject: [R-sig-Geo] Criteria of the best variogram model
Message-ID: <200511122156.jACLuINB002969@hypatia.math.ethz.ch>

Hi all,

Is there any information about the criteria  of choosing the best semivariogram? Thanks in advance.

Leaf



From v.gomezrubio at imperial.ac.uk  Mon Nov 14 13:24:51 2005
From: v.gomezrubio at imperial.ac.uk (=?ISO-8859-1?Q?=22G=F3mez_Rubio=2C_Virgilio=22?=)
Date: Mon, 14 Nov 2005 12:24:51 +0000
Subject: [R-sig-Geo] Small Area Estimation with R
In-Reply-To: <20051112101323.e4c57c9f.stanimura-ngs@umin.ac.jp>
References: <4372395A.9090203@imperial.ac.uk>
	<20051112101323.e4c57c9f.stanimura-ngs@umin.ac.jp>
Message-ID: <43788213.9040407@imperial.ac.uk>

Dear Susumu,

> Although I know neither GREG nor BLUP, I guess calibrate() in survey
> and ranef() in nlme may rouse your interest.
>   

Thank you very much for yuor comments. The functions that you suggest 
are really a good starting point. In addition, Roger Bivand also has 
pointed out
some interesting links:

http://www.ncrm.ac.uk/events/documents/ComputerWorkshoponUsingMultilevelModelsforSmallAreaEstimation-RayChambersandNikosTzavidis.pdf

and especially:

http://www.ncrm.ac.uk/ss/Workshop%20for%20Summer%20School%201.txt

and other things on http://www.ncrm.ac.uk/ss/


http://www.stat.jyu.fi/sae2005/course.htm (here there are some SAS macros)

http://www.statistics.gov.uk/methods_quality/eurarea/ (this includes an 
extensive review of SAE methods and detailed description of the algorithms)


Although it is not strictly related to R, I think it contains valuable 
information that may be of help to other people interested in
Small Area Estimation.

Best regards,

Virgilio



From koen.hufkens at telenet.be  Wed Nov 16 13:30:26 2005
From: koen.hufkens at telenet.be (Koen Hufkens)
Date: Wed, 16 Nov 2005 13:30:26 +0100
Subject: [R-sig-Geo] Software (R, free matlab toolboxes etc etc...)
Message-ID: <437B2662.6010901@telenet.be>

Hi list(s),

I'm looking for (free) geostatistical software that works with images 
and not as much on point data.

I've been playing around with multiresolution wavelet decompositions and 
I want to collect some statistical information of these images 
(semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
For the time being I used R, the wavethresh package and the spdep 
package. This latter was not optimal because the neighbour list 
constructed by spdep becomes a little to much for my limited computer 
system. So an additional R package would be great, but not necessary. 
Other (free) alternatives would be great.

So what  packages toolboxes etc. are not point based, and can handle 
images? Any idea's, suggestions?

Best regards,
Koen

ps. excuses for double posting if you are a member of both lists, I try 
to cover as much ground as possible in one e-mail.



From Roger.Bivand at nhh.no  Wed Nov 16 15:45:54 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 16 Nov 2005 15:45:54 +0100 (CET)
Subject: [R-sig-Geo] Software (R, free matlab toolboxes etc etc...)
In-Reply-To: <437B2662.6010901@telenet.be>
Message-ID: <Pine.LNX.4.44.0511161431200.2976-100000@reclus.nhh.no>

On Wed, 16 Nov 2005, Koen Hufkens wrote:

> Hi list(s),
> 
> I'm looking for (free) geostatistical software that works with images 
> and not as much on point data.
> 
> I've been playing around with multiresolution wavelet decompositions and 
> I want to collect some statistical information of these images 
> (semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
> For the time being I used R, the wavethresh package and the spdep 
> package. This latter was not optimal because the neighbour list 
> constructed by spdep becomes a little to much for my limited computer 
> system. So an additional R package would be great, but not necessary. 
> Other (free) alternatives would be great.

Please state how large the images are, it isn't obvious what for example 
global Moran's I would give you. Could you answer the same questions of 
subscenes? Are the data likely to be non-stationary? How are you reading 
the data into R, how are they represented? Even geostatistics will be hard 
with many observed points, easier with many points to predict to. 

> 
> So what  packages toolboxes etc. are not point based, and can handle 
> images? Any idea's, suggestions?

You have looked at rimage, I suppose? Could you extend that?

Roger

> 
> Best regards,
> Koen
> 
> ps. excuses for double posting if you are a member of both lists, I try 
> to cover as much ground as possible in one e-mail.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Thu Nov 17 10:36:12 2005
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 17 Nov 2005 09:36:12 +0000
Subject: [R-sig-Geo] Software (R, free matlab toolboxes etc etc...)
In-Reply-To: <437B2662.6010901@telenet.be>
References: <437B2662.6010901@telenet.be>
Message-ID: <437C4F0C.2050805@geo.uu.nl>

Koen Hufkens wrote:

>Hi list(s),
>
>I'm looking for (free) geostatistical software that works with images 
>and not as much on point data.
>
>I've been playing around with multiresolution wavelet decompositions and 
>I want to collect some statistical information of these images 
>(semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
>For the time being I used R, the wavethresh package and the spdep 
>package. This latter was not optimal because the neighbour list 
>constructed by spdep becomes a little to much for my limited computer 
>system. So an additional R package would be great, but not necessary. 
>Other (free) alternatives would be great.
>
>So what  packages toolboxes etc. are not point based, and can handle 
>images? Any idea's, suggestions?
>  
>
Hi Koen,

R package gstat (or the gstat stand-alone program) has two
optimizations built in for calculating semivariograms,  the first for
large data sets, the second for gridded data:
1. it doesn't store the full pairwise distance matrix, but accumulates
semivariance and number of point pairs,
2. for gridded data, it derives distances from row/column index, instead
of recalculating them for each point, and it only evaluates point pairs
for which we know they need evaluation.

The first makes the calculation of semivariances possible within limited
memory, the second one makes the behaviour of the computation
closer to O(n), instead of O(n*n) for the case where you ignore
grid topology---this makes the computation scalable and feasable
for larger grids.

The documentation may not be all too clear on this, and perhaps
the user interface can be improved: not many people need this;
contact me on the gstat-info list for details where needed.
--
Edzer



From rlong at msce.com  Thu Nov 17 20:45:49 2005
From: rlong at msce.com (Randy Long)
Date: Thu, 17 Nov 2005 11:45:49 -0800
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 27, Issue 8
Message-ID: <922911C61772524BA42B43E266DB35BD04C191@MSSC07>

anybody get r to work in ARCGis 9.1? I am curious to see if the dll and hook
are the same as was done before in 8.1.
Thanks

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch]On Behalf Of
r-sig-geo-request at stat.math.ethz.ch
Sent: Thursday, November 17, 2005 3:00 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: R-sig-Geo Digest, Vol 27, Issue 8


Send R-sig-Geo mailing list submissions to
	r-sig-geo at stat.math.ethz.ch

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at stat.math.ethz.ch

You can reach the person managing the list at
	r-sig-geo-owner at stat.math.ethz.ch

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Software (R, free matlab toolboxes etc etc...) (Koen Hufkens)
   2. Re: Software (R, free matlab toolboxes etc etc...) (Roger Bivand)
   3. Re: Software (R, free matlab toolboxes etc etc...)
      (Edzer J. Pebesma)


----------------------------------------------------------------------

Message: 1
Date: Wed, 16 Nov 2005 13:30:26 +0100
From: Koen Hufkens <koen.hufkens at telenet.be>
Subject: [R-sig-Geo] Software (R, free matlab toolboxes etc etc...)
To: AI Geostats mailing list <ai-geostats at unil.ch>,	R geostat list
	<r-sig-geo at stat.math.ethz.ch>
Message-ID: <437B2662.6010901 at telenet.be>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi list(s),

I'm looking for (free) geostatistical software that works with images 
and not as much on point data.

I've been playing around with multiresolution wavelet decompositions and 
I want to collect some statistical information of these images 
(semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
For the time being I used R, the wavethresh package and the spdep 
package. This latter was not optimal because the neighbour list 
constructed by spdep becomes a little to much for my limited computer 
system. So an additional R package would be great, but not necessary. 
Other (free) alternatives would be great.

So what  packages toolboxes etc. are not point based, and can handle 
images? Any idea's, suggestions?

Best regards,
Koen

ps. excuses for double posting if you are a member of both lists, I try 
to cover as much ground as possible in one e-mail.



------------------------------

Message: 2
Date: Wed, 16 Nov 2005 15:45:54 +0100 (CET)
From: Roger Bivand <Roger.Bivand at nhh.no>
Subject: Re: [R-sig-Geo] Software (R, free matlab toolboxes etc
	etc...)
To: Koen Hufkens <koen.hufkens at telenet.be>
Cc: R geostat list <r-sig-geo at stat.math.ethz.ch>
Message-ID: <Pine.LNX.4.44.0511161431200.2976-100000 at reclus.nhh.no>
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 16 Nov 2005, Koen Hufkens wrote:

> Hi list(s),
> 
> I'm looking for (free) geostatistical software that works with images 
> and not as much on point data.
> 
> I've been playing around with multiresolution wavelet decompositions and 
> I want to collect some statistical information of these images 
> (semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
> For the time being I used R, the wavethresh package and the spdep 
> package. This latter was not optimal because the neighbour list 
> constructed by spdep becomes a little to much for my limited computer 
> system. So an additional R package would be great, but not necessary. 
> Other (free) alternatives would be great.

Please state how large the images are, it isn't obvious what for example 
global Moran's I would give you. Could you answer the same questions of 
subscenes? Are the data likely to be non-stationary? How are you reading 
the data into R, how are they represented? Even geostatistics will be hard 
with many observed points, easier with many points to predict to. 

> 
> So what  packages toolboxes etc. are not point based, and can handle 
> images? Any idea's, suggestions?

You have looked at rimage, I suppose? Could you extend that?

Roger

> 
> Best regards,
> Koen
> 
> ps. excuses for double posting if you are a member of both lists, I try 
> to cover as much ground as possible in one e-mail.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



------------------------------

Message: 3
Date: Thu, 17 Nov 2005 09:36:12 +0000
From: "Edzer J. Pebesma" <e.pebesma at geo.uu.nl>
Subject: Re: [R-sig-Geo] Software (R, free matlab toolboxes etc
	etc...)
To: Koen Hufkens <koen.hufkens at telenet.be>
Cc: R geostat list <r-sig-geo at stat.math.ethz.ch>,	AI Geostats mailing
	list <ai-geostats at unil.ch>
Message-ID: <437C4F0C.2050805 at geo.uu.nl>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Koen Hufkens wrote:

>Hi list(s),
>
>I'm looking for (free) geostatistical software that works with images 
>and not as much on point data.
>
>I've been playing around with multiresolution wavelet decompositions and 
>I want to collect some statistical information of these images 
>(semivariance analysis, autocorrelation, Moran's I index, etc etc...). 
>For the time being I used R, the wavethresh package and the spdep 
>package. This latter was not optimal because the neighbour list 
>constructed by spdep becomes a little to much for my limited computer 
>system. So an additional R package would be great, but not necessary. 
>Other (free) alternatives would be great.
>
>So what  packages toolboxes etc. are not point based, and can handle 
>images? Any idea's, suggestions?
>  
>
Hi Koen,

R package gstat (or the gstat stand-alone program) has two
optimizations built in for calculating semivariograms,  the first for
large data sets, the second for gridded data:
1. it doesn't store the full pairwise distance matrix, but accumulates
semivariance and number of point pairs,
2. for gridded data, it derives distances from row/column index, instead
of recalculating them for each point, and it only evaluates point pairs
for which we know they need evaluation.

The first makes the calculation of semivariances possible within limited
memory, the second one makes the behaviour of the computation
closer to O(n), instead of O(n*n) for the case where you ignore
grid topology---this makes the computation scalable and feasable
for larger grids.

The documentation may not be all too clear on this, and perhaps
the user interface can be improved: not many people need this;
contact me on the gstat-info list for details where needed.
--
Edzer



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 27, Issue 8



From stanimura-ngs at umin.ac.jp  Fri Nov 18 03:59:21 2005
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Fri, 18 Nov 2005 11:59:21 +0900
Subject: [R-sig-Geo] updated DCluster
Message-ID: <20051118115921.75617974.stanimura-ngs@umin.ac.jp>

Dear Virgilio and R users

It is happy to see DCluster reinforced.  If possible, please inform us
the changes whenever you updated DCluster > Virgilio
Many of us in this list may have great interest in the DCluster.

As far as my investigation,

$ diff /usr/lib/R/library/DCluster/INDEX INDEX
31a32,33
> lognormalEB             Empirical Bayes Smoothing using a log-normal
>                         model
56a59,60
> test.nb.pois            Likelihood ratio test and Dean's tests for
>                         Overdispertion

Also I found that the name of Roger had newly added in Author section
of DESCRIPTION as a contributor. 

--
Susumu Tanimura



From feurbano at tin.it  Fri Nov 18 13:41:18 2005
From: feurbano at tin.it (feurbano at tin.it)
Date: Fri, 18 Nov 2005 13:41:18 +0100 (GMT+01:00)
Subject: [R-sig-Geo] Non euclidean distance in kernel home range estimation
Message-ID: <30456405.1132317678911.JavaMail.root@pswm3.cp.tin.it>

Ciao,
I am trying to use an estimation of Kernel Home Range (i have 
adehabitate as reference package).

I would like to use a "distance" 
different from the euclidean one. I want to define a "friction" map so 
that the distance will be calculated as a cumulative cost path to 
travel between two points.
i can obtain this distance with the r.cost 
module in GRASS, but i would like to know if i can do the same with 
some R package...
Any idea or any suggestion about this issue?
Thanks a 
lot

Ferdinando



From dag.johan.steinskog at nersc.no  Fri Nov 18 14:00:57 2005
From: dag.johan.steinskog at nersc.no (Dag Johan Steinskog)
Date: Fri, 18 Nov 2005 14:00:57 +0100
Subject: [R-sig-Geo] Filled contour and projection
Message-ID: <437DD089.8050106@nersc.no>

Dear all!

Is it possible to make a plot with filled contour on a map with a 
certain projection? It is not a problem using the mapproject() together 
with contourLines() to make e.g. a stereographic plot with contour 
lines, but it seems rather impossible to use filled.contour() and 
mapproject together in the same way.

In advance, thanks for all your help!

Best Wishes
Dag Johan Steinskog



From drf5n at maplepark.com  Fri Nov 18 22:50:49 2005
From: drf5n at maplepark.com (David Forrest)
Date: Fri, 18 Nov 2005 15:50:49 -0600 (CST)
Subject: [R-sig-Geo] How to set spplot background?
Message-ID: <Pine.LNX.4.58.0511181543440.1333@maplepark.com>

Hi,

The examples on http://r-spatial.sourceforge.net/gallery/ all have dark
grey backgrounds on them.  E.g. :

library(sp)
library(lattice) # required for trellis.par.set():
trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()

data(meuse)
coordinates(meuse)=~x+y

## coloured points plot with legend in plotting area and scales:
spplot(meuse, "zinc", do.log = TRUE,
	key.space=list(x=0.2,y=0.9,corner=c(0,1)),
	scales=list(draw=T))

gives http://r-spatial.sourceforge.net/gallery/fig/fig01.png


What do I have to to do to make the plot have a lighter background?

Also, the later examples on http://r-spatial.sourceforge.net/gallery/ seem
to fail by not finding SpatialPolygons()  Should those examples be
revised?

meuse.sr =
SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))

Dave
-- 
 Dr. David Forrest
 drf at vims.edu                                    (804)684-7900w
 drf5n at maplepark.com                             (804)642-0662h
                                   http://maplepark.com/~drf5n/



From gerifalte28 at hotmail.com  Fri Nov 18 23:35:08 2005
From: gerifalte28 at hotmail.com (Francisco J. Zagmutt)
Date: Fri, 18 Nov 2005 22:35:08 +0000
Subject: [R-sig-Geo] How to set spplot background?
In-Reply-To: <Pine.LNX.4.58.0511181543440.1333@maplepark.com>
Message-ID: <BAY103-F47D1FF1029F5DF99BE3D5A65E0@phx.gbl>

RSiteSearch("background lattice")


Francisco



>From: David Forrest <drf5n at maplepark.com>
>Reply-To: David Forrest <drf5n at maplepark.com>
>To: r-sig-geo at stat.math.ethz.ch
>Subject: [R-sig-Geo] How to set spplot background?
>Date: Fri, 18 Nov 2005 15:50:49 -0600 (CST)
>
>Hi,
>
>The examples on http://r-spatial.sourceforge.net/gallery/ all have dark
>grey backgrounds on them.  E.g. :
>
>library(sp)
>library(lattice) # required for trellis.par.set():
>trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
>
>data(meuse)
>coordinates(meuse)=~x+y
>
>## coloured points plot with legend in plotting area and scales:
>spplot(meuse, "zinc", do.log = TRUE,
>	key.space=list(x=0.2,y=0.9,corner=c(0,1)),
>	scales=list(draw=T))
>
>gives http://r-spatial.sourceforge.net/gallery/fig/fig01.png
>
>
>What do I have to to do to make the plot have a lighter background?
>
>Also, the later examples on http://r-spatial.sourceforge.net/gallery/ seem
>to fail by not finding SpatialPolygons()  Should those examples be
>revised?
>
>meuse.sr =
>SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
>
>Dave
>--
>  Dr. David Forrest
>  drf at vims.edu                                    (804)684-7900w
>  drf5n at maplepark.com                             (804)642-0662h
>                                    http://maplepark.com/~drf5n/
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Fri Nov 18 23:41:06 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Nov 2005 23:41:06 +0100 (CET)
Subject: [R-sig-Geo] [R] Point pattern to grid
In-Reply-To: <200511182211.jAIMB6a8005889@hypatia.math.ethz.ch>
Message-ID: <Pine.LNX.4.44.0511182324440.3807-100000@reclus.nhh.no>

On Fri, 18 Nov 2005, Leaf Sun wrote:

> Hi Roger,
> 
> Thanks again for your kind help.
> 
> Yes, I still use the 200K points data applying this program but the good
> thing is I found it finished in no time.

I'm moving my reply to R-sig-geo, a more suitable list.

> 
> The questions again here are:
> 
> 1)   >try0 <- lapply(split(as(df1, "data.frame"), res), mean)  
> 
> When I tried to replace mean to sum, error looks like this:
> 
> Error in x at data[, i, drop = FALSE] : undefined columns selected 

Please take a small subset of your data (say 25-50 points), and fake the 
grid (say just 4 cells 250x250) to try to reach a function that seems 
suitable. Then write your own function to give the output you need - look 
carefully at ?split and ?lapply. Your function needs to return a single 
vector (which can be a one-row data frame). The nafill values should suit 
the ones you want to return. 

> 
> 2) If I just need to know the number of points in each cells, how can I
> modify the codes. The codes still a bit beyond me.

It might be length() or nrow() in your own function. If you try first with 
a small example, and look at the results of each step in turn - so break:

try0 <- lapply(split(as(df1, "data.frame"), res), mean)

into

try00 <- split(as(df1, "data.frame"), res)

look what is inside a chosen member of the list try00, and try to work it 
out from there. Once your function does what you want, run it on the full 
data set, but still be careful in case impossible values have happened 
(things like dividing by zero). Use summary() on the input point data to 
get a good feel for the spread of the data. You're very close, but you 
need to make these decisions in relation to your research problem, and how 
you've operationalised your observed variables at the points (maybe you 
need to store mean, sd, fivenum, and count for a numerical variable, but 
only you can know).

Roger


> 
> Thanks!
> 
> Leaf
> 
> ======= At 2005-11-18, 01:39:05 you wrote: =======
> 
> >On Thu, 17 Nov 2005, Leaf Sun wrote:
> >
> >> Dear all,
> >> 
> >> I'd like to change a point pattern to a grid of cells and use one of the
> >> variables as the output.
> >> 
> >> e.g.  The point pattern is of a window of (500*500) and several features
> >> such as pH, SoilType etc.  I like to divide it into a grid with cell
> >> size 5*5, and use the mean of the point values falling inside the cell
> >> as the output.
> >> 
> >> Is there any package in R working with this? Thanks in advance!
> >
> >This might have been better posted on R-sig-geo. Try this:
> >
> >library(sp)
> >df1 <- data.frame(x=runif(10000,0,500), y=runif(10000,0,500),
> >  z=rnorm(10000))
> >coordinates(df1) <- c("x", "y")
> >summary(df1) # SpatialPointsDataFrame
> >grd <- GridTopology(c(2.5,2.5), c(5,5), c(100,100))
> >sgrd <- SpatialGrid(grd) #SpatialGrid
> >bbox(sgrd)
> >res <- overlay(sgrd, df1)
> ># find which grid cells the points are in
> >str(res)
> >try0 <- lapply(split(as(df1, "data.frame"), res), mean)
> ># take means by grid cell - assumes all numeric columns in df1
> ># (soil type??) - maybe write a custom function to handle non-numeric 
> ># columns sensibly
> >try01 <- vector(mode="list", length=prod(slot(slot(sgrd, "grid"),
> >  "cells.dim")))
> >nafill <- rep(as.numeric(NA), ncol(as(df1, "data.frame")))
> >try01 <- lapply(try01, function(x) nafill)
> ># make a container to put the means in with the right number of columns
> >try01[as.integer(names(try0))] <- try0
> ># insert means into correct list elements
> >try1 <- data.frame(t(data.frame(try01)))
> ># transpose
> >summary(try1)
> >sgrd1 <- SpatialGridDataFrame(slot(sgrd, "grid"), try1)
> >image(sgrd1, "x")
> >image(sgrd1, "y")
> >image(sgrd1, "z")
> >
> >It goes a bit further than the short description of the sp package in the 
> >latest R-News, and will most likely be a new method for overlay in sp. If 
> >these are your 200K points, it may take a little longer ...
> >
> >> 
> >> Cheers,
> >> 
> >> Leaf
> >> 
> >> 
> >
> >-- 
> >Roger Bivand
> >Economic Geography Section, Department of Economics, Norwegian School of
> >Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >e-mail: Roger.Bivand at nhh.no
> >
> 
> = = = = = = = = = = = = = = = = = = = =
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From drf5n at maplepark.com  Sat Nov 19 00:05:14 2005
From: drf5n at maplepark.com (David Forrest)
Date: Fri, 18 Nov 2005 17:05:14 -0600 (CST)
Subject: [R-sig-Geo] How to set spplot background?
In-Reply-To: <BAY103-F47D1FF1029F5DF99BE3D5A65E0@phx.gbl>
References: <BAY103-F47D1FF1029F5DF99BE3D5A65E0@phx.gbl>
Message-ID: <Pine.LNX.4.58.0511181656410.1333@maplepark.com>

On Fri, 18 Nov 2005, Francisco J. Zagmutt wrote:

> RSiteSearch("background lattice")

Thanks Francisco.

spplot calls trellis stuff, features of which are controlled by
trellis.par.set()

trellis.par.set(theme=col.whitebg()) # works
trellis.par.set(background="white")  # works

col.whitebg() returns a list of light-backgrounded trellis settings that
work together.


>
> Francisco
>
>
>
> >From: David Forrest <drf5n at maplepark.com>
> >Reply-To: David Forrest <drf5n at maplepark.com>
> >To: r-sig-geo at stat.math.ethz.ch
> >Subject: [R-sig-Geo] How to set spplot background?
> >Date: Fri, 18 Nov 2005 15:50:49 -0600 (CST)
> >
> >Hi,
> >
> >The examples on http://r-spatial.sourceforge.net/gallery/ all have dark
> >grey backgrounds on them.  E.g. :
> >
> >library(sp)
> >library(lattice) # required for trellis.par.set():
> >trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
> >
> >data(meuse)
> >coordinates(meuse)=~x+y
> >
> >## coloured points plot with legend in plotting area and scales:
> >spplot(meuse, "zinc", do.log = TRUE,
> >	key.space=list(x=0.2,y=0.9,corner=c(0,1)),
> >	scales=list(draw=T))
> >
> >gives http://r-spatial.sourceforge.net/gallery/fig/fig01.png
> >
> >
> >What do I have to to do to make the plot have a lighter background?
> >
> >Also, the later examples on http://r-spatial.sourceforge.net/gallery/ seem
> >to fail by not finding SpatialPolygons()  Should those examples be
> >revised?
> >
> >meuse.sr =
> >SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
> >
> >Dave
> >--
> >  Dr. David Forrest
> >  drf at vims.edu                                    (804)684-7900w
> >  drf5n at maplepark.com                             (804)642-0662h
> >                                    http://maplepark.com/~drf5n/
> >
> >_______________________________________________
> >R-sig-Geo mailing list
> >R-sig-Geo at stat.math.ethz.ch
> >https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
 Dr. David Forrest
 drf at vims.edu                                    (804)684-7900w
 drf5n at maplepark.com                             (804)642-0662h
                                   http://maplepark.com/~drf5n/



From e.pebesma at geo.uu.nl  Sat Nov 19 10:11:04 2005
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Sat, 19 Nov 2005 09:11:04 +0000
Subject: [R-sig-Geo] How to set spplot background?
In-Reply-To: <Pine.LNX.4.58.0511181543440.1333@maplepark.com>
References: <Pine.LNX.4.58.0511181543440.1333@maplepark.com>
Message-ID: <437EEC28.9020808@geo.uu.nl>

David Forrest wrote:

>...
>Also, the later examples on http://r-spatial.sourceforge.net/gallery/ seem
>to fail by not finding SpatialPolygons()  Should those examples be
>revised?
>
>meuse.sr =
>SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
>
>Dave
>  
>
Dave, we try to keep sp and the gallery on sourceforge synchronised. Did 
you update the
sp package recently?
--
Edzer



From leaflovesun at yahoo.ca  Sun Nov 20 21:11:06 2005
From: leaflovesun at yahoo.ca (Leaf Sun)
Date: Sun, 20 Nov 2005 13:11:06 -0700
Subject: [R-sig-Geo] [R] Point pattern to grid
Message-ID: <200511202011.jAKKBDNB000963@hypatia.math.ethz.ch>


======= At 2005-11-18, 15:41:06 you wrote: =======

>On Fri, 18 Nov 2005, Leaf Sun wrote:
>
>> Hi Roger,
>> 
>> Thanks again for your kind help.
>> 
>> Yes, I still use the 200K points data applying this program but the good
>> thing is I found it finished in no time.
>
>I'm moving my reply to R-sig-geo, a more suitable list.
>
>> 
>> The questions again here are:
>> 
>> 1)   >try0 <- lapply(split(as(df1, "data.frame"), res), mean)  
>> 
>> When I tried to replace mean to sum, error looks like this:
>> 
>> Error in x at data[, i, drop = FALSE] : undefined columns selected 
>
>Please take a small subset of your data (say 25-50 points), and fake the 
>grid (say just 4 cells 250x250) to try to reach a function that seems 
>suitable. Then write your own function to give the output you need - look 
>carefully at ?split and ?lapply. Your function needs to return a single 
>vector (which can be a one-row data frame). The nafill values should suit 
>the ones you want to return. 
>
>> 
>> 2) If I just need to know the number of points in each cells, how can I
>> modify the codes. The codes still a bit beyond me.
>
>It might be length() or nrow() in your own function. If you try first with 
>a small example, and look at the results of each step in turn - so break:
>
>try0 <- lapply(split(as(df1, "data.frame"), res), mean)
>
>into
>
>try00 <- split(as(df1, "data.frame"), res)

Yes, I tracked the outcome of these two lines.

 try00 are always of 3 columns (x,y,z)  , but the strange thing is when I replace mean with  nrow, try0 turns out to be of only one column.

Thus ,  the final image is of one grid matrix X1 could be shown as:          image(sgrd1, "X1")     

>sgrd1 <- SpatialGridDataFrame(slot(sgrd, "grid"), try1)
> >image(sgrd1, "x")
> >image(sgrd1, "y")
> >image(sgrd1, "z")



>
>look what is inside a chosen member of the list try00, and try to work it 
>out from there. Once your function does what you want, run it on the full 
>data set, but still be careful in case impossible values have happened 
>(things like dividing by zero). Use summary() on the input point data to 
>get a good feel for the spread of the data. You're very close, but you 
>need to make these decisions in relation to your research problem, and how 
>you've operationalised your observed variables at the points (maybe you 
>need to store mean, sd, fivenum, and count for a numerical variable, but 
>only you can know).
>
>Roger
>
>
>> 
>> Thanks!
>> 
>> Leaf
>> 
>> ======= At 2005-11-18, 01:39:05 you wrote: =======
>> 
>> >On Thu, 17 Nov 2005, Leaf Sun wrote:
>> >
>> >> Dear all,
>> >> 
>> >> I'd like to change a point pattern to a grid of cells and use one of the
>> >> variables as the output.
>> >> 
>> >> e.g.  The point pattern is of a window of (500*500) and several features
>> >> such as pH, SoilType etc.  I like to divide it into a grid with cell
>> >> size 5*5, and use the mean of the point values falling inside the cell
>> >> as the output.
>> >> 
>> >> Is there any package in R working with this? Thanks in advance!
>> >
>> >This might have been better posted on R-sig-geo. Try this:
>> >
>> >library(sp)
>> >df1 <- data.frame(x=runif(10000,0,500), y=runif(10000,0,500),
>> >  z=rnorm(10000))
>> >coordinates(df1) <- c("x", "y")
>> >summary(df1) # SpatialPointsDataFrame
>> >grd <- GridTopology(c(2.5,2.5), c(5,5), c(100,100))
>> >sgrd <- SpatialGrid(grd) #SpatialGrid
>> >bbox(sgrd)
>> >res <- overlay(sgrd, df1)
>> ># find which grid cells the points are in
>> >str(res)
>> >try0 <- lapply(split(as(df1, "data.frame"), res), mean)
>> ># take means by grid cell - assumes all numeric columns in df1
>> ># (soil type??) - maybe write a custom function to handle non-numeric 
>> ># columns sensibly
>> >try01 <- vector(mode="list", length=prod(slot(slot(sgrd, "grid"),
>> >  "cells.dim")))
>> >nafill <- rep(as.numeric(NA), ncol(as(df1, "data.frame")))
>> >try01 <- lapply(try01, function(x) nafill)
>> ># make a container to put the means in with the right number of columns
>> >try01[as.integer(names(try0))] <- try0
>> ># insert means into correct list elements
>> >try1 <- data.frame(t(data.frame(try01)))
>> ># transpose
>> >summary(try1)
>> >sgrd1 <- SpatialGridDataFrame(slot(sgrd, "grid"), try1)
>> >image(sgrd1, "x")
>> >image(sgrd1, "y")
>> >image(sgrd1, "z")
>> >
>> >It goes a bit further than the short description of the sp package in the 
>> >latest R-News, and will most likely be a new method for overlay in sp. If 
>> >these are your 200K points, it may take a little longer ...
>> >
>> >> 
>> >> Cheers,
>> >> 
>> >> Leaf
>> >> 
>> >> 
>> >
>> >-- 
>> >Roger Bivand
>> >Economic Geography Section, Department of Economics, Norwegian School of
>> >Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> >Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> >e-mail: Roger.Bivand at nhh.no
>> >
>> 
>> = = = = = = = = = = = = = = = = = = = =
>> 
>> 
>
>-- 
>Roger Bivand
>Economic Geography Section, Department of Economics, Norwegian School of
>Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no
>
>

= = = = = = = = = = = = = = = = = = = =



From v.gomezrubio at imperial.ac.uk  Tue Nov 22 20:56:26 2005
From: v.gomezrubio at imperial.ac.uk (=?ISO-8859-1?Q?=22G=F3mez_Rubio=2C_Virgilio=22?=)
Date: Tue, 22 Nov 2005 19:56:26 +0000
Subject: [R-sig-Geo] updated DCluster
In-Reply-To: <20051118115921.75617974.stanimura-ngs@umin.ac.jp>
References: <20051118115921.75617974.stanimura-ngs@umin.ac.jp>
Message-ID: <438377EA.9020308@imperial.ac.uk>

Hi,


Susumu Tanimura wrote:
> Dear Virgilio and R users
>
> It is happy to see DCluster reinforced.  If possible, please inform us
> the changes whenever you updated DCluster > Virgilio
> Many of us in this list may have great interest in the DCluster.
>   
Thanks for the comments and the interest. In the next release of 
DCluster we have fixed a few minor
bugs and we have added:

* Three more tests for overdispersion (with some help by Roger Bivand):
a likelihood  ratio test and another two by Dean.

    Dean, C.B. (1992), Testing for overdispersion in Poisson and
     binomial regression models, _J. Amer. Statist. Assoc._ 87,
     451-457.

* EB smoothed estimator using the log-normal model, as described in

     Clayton, David and Kaldor, John (1987). Empirical Bayes Estimates
     of Age-standardized Relative Risks for Use in Disease Mapping.
     Biometrics 43, 671-681.


Best regards,

Virgilio



From aimi.andrea at gmail.com  Thu Nov 24 11:52:33 2005
From: aimi.andrea at gmail.com (Andrea Aimi)
Date: Thu, 24 Nov 2005 11:52:33 +0100
Subject: [R-sig-Geo] spatial-time smoothing
Message-ID: <29ba3d720511240252k21d99851ga83ad84163ba89ba@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20051124/acf472c2/attachment.pl>

From dwittenberg at uni-bielefeld.de  Mon Nov 28 18:06:24 2005
From: dwittenberg at uni-bielefeld.de (Dennis Wittenberg)
Date: Mon, 28 Nov 2005 18:06:24 +0100
Subject: [R-sig-Geo] Problems with autosearch() in deal-package
Message-ID: <000201c5f43e$20abd910$0301a8c0@skaos>

Hello everybody,

currently I'm trying to understand the autosearch-function in the
deal-package.
I have implemented a data generating function (dat.fr) with variable
sample size T.
The two variables x and z are randomly generated. y depends on x and z.

The R-code:

dat.fr=function(T) 
{ 
u1=matrix(rnorm(T*1),T,1); 
u2=matrix(rnorm(T*1),T,1); 
u3=matrix(rnorm(T*1),T,1); 
x=u1; 
z=u2; 
a=1; 
b=2; 
y=a*x+b*z+u3; 
data.frame(x,y,z) 
} 

Applied to autosearch I expect a network x-->y<--z, no matter which
sample size is used or how often dat.fr() is renewed. 

Unfortunately, for repeated trials, autosearch provides several,
different network-outputs.
Sometimes the output is conform to the expected network, sometimes it
isn't.
I cannot determine the reason for this.

Any help with my problem would be greatly appreciated.

R-code:

df=dat.fr(100)

df.nw=network(df); 
df.prior=jointprior(df.nw,4); 
df.nw=getnetwork(learn(df.nw,df,df.prior)); 
df.search=autosearch(df.nw,df,df.prior,trace=TRUE)

Thanks and best wishes,

Dennis Wittenberg



From reeves at nceas.ucsb.edu  Mon Nov 28 20:41:55 2005
From: reeves at nceas.ucsb.edu (Rick Reeves)
Date: Mon, 28 Nov 2005 11:41:55 -0800
Subject: [R-sig-Geo] R function to match closest points to second point set?
Message-ID: <438B5D83.5060601@nceas.ucsb.edu>


Hello all:

I checked inside most of the R spatial analysis packages, without success,
so I'll ask the list:

I have a set of data collection points georeferenced with lat/long 
coordinates.
The task is to find the closest (in lat/long) matching point in a second 
set of
points (polygon centroids, that I created with R get.Pcent() function).
both point sets are stored in data frames, I would like to record the
index of the matching point as a new column on the first data frame.

Is there an existing R function or package that would support this, or 
get close?
Thanks for any assistance.

Thanks,
Rick R

-- 
Rick Reeves	
Scientific ProgrammerAnalyst
National Center for Ecological Analysis and Synthesis (NCEAS)
University of California, Santa Barbara
reeves at nceas.ucsb.edu
805 892 2533



From Roger.Bivand at nhh.no  Mon Nov 28 21:29:14 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 28 Nov 2005 21:29:14 +0100 (CET)
Subject: [R-sig-Geo] R function to match closest points to second point
 set?
In-Reply-To: <438B5D83.5060601@nceas.ucsb.edu>
Message-ID: <Pine.LNX.4.44.0511282052020.31984-100000@reclus.nhh.no>

On Mon, 28 Nov 2005, Rick Reeves wrote:

> 
> Hello all:
> 
> I checked inside most of the R spatial analysis packages, without success,
> so I'll ask the list:
> 
> I have a set of data collection points georeferenced with lat/long 
> coordinates.
> The task is to find the closest (in lat/long) matching point in a second 
> set of
> points (polygon centroids, that I created with R get.Pcent() function).
> both point sets are stored in data frames, I would like to record the
> index of the matching point as a new column on the first data frame.
> 
> Is there an existing R function or package that would support this, or 
> get close?
> Thanks for any assistance.

Using the Census 2000 county shapefiles for North and South Carolina as an 
example:

> library(maptools)
> nc <- readShapePoly("co37_d00.shp",
+ proj4string=CRS("+proj=longlat  datum=NAD83"))
> sc <- readShapePoly("co45_d00.shp",
+ proj4string=CRS("+proj=longlat datum=NAD83"))
> nc_cents <- t(sapply(slot(nc, "polygons"), function(x) slot(x, 
+ "labpt")))
> nc_n <- nrow(nc_cents)
> sc_cents <- t(sapply(slot(sc, "polygons"), function(x) slot(x, 
+ "labpt")))
> sc_n <- nrow(sc_cents)
> res <- vector(mode="integer", length=nc_n)
> for (i in 1:nc_n) {
+ dists <- spDistsN1(sc_cents, nc_cents[i,], longlat=TRUE)
+ res[i] <- which.min(dists)
+ }
> bbox(sc)
> bbox(nc)
> plot(nc, ylim=c(32,36.6), axes=TRUE)
> plot(sc, add=TRUE, border="blue")
> for (i in 1:nc_n) segments(nc_cents[i,1], nc_cents[i,2], 
+ sc_cents[res[i],1], sc_cents[res[i],2])


The results in km are in the dists matrix, the spDistsN1() function is in 
the sp package which maptools loads. Since you've got your centroids 
already, you don't need the extra stuff, so spDistsN1() in a loop will 
get you there, I needed it for the example. Add the res vector to your 
data frame.

Roger

> 
> Thanks,
> Rick R
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From stratja at auburn.edu  Mon Nov 28 21:39:21 2005
From: stratja at auburn.edu (Jeffrey Stratford)
Date: Mon, 28 Nov 2005 14:39:21 -0600
Subject: [R-sig-Geo] newbie: getting started
Message-ID: <438B1699020000F2000021DA@TMIA1.AUBURN.EDU>

Greetings!  I would appreciate some feedback as to where you think a
newbie should start when learning spatial stats with R.  

I have avian point count data and landscape data (Landsat) over a 70 by
40 km area that I would like to start analyzing.  I have already,
developed some relationships between species richness and landscape
attributes but I completely ignore important spatial problems such as
autocorrelation.

where do I begin?

Many thanks,

Jeff

****************************************
Jeffrey A. Stratford, Ph.D.
Postdoctoral Associate
331 Funchess Hall
Department of Biological Sciences
Auburn University
Auburn, AL 36849
334-329-9198
FAX 334-844-9234
http://www.auburn.edu/~stratja



