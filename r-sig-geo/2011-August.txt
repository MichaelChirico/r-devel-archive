From amorenos1 at ucentral.edu.co  Mon Aug  1 00:13:21 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Sun, 31 Jul 2011 15:13:21 -0700 (PDT)
Subject: [R-sig-Geo] PPP with latitude/longitude coordinates
Message-ID: <1312150401275-6639204.post@n2.nabble.com>

Hello somebady could tell me i f I can create a ppp with latitude and
longitude coordinates...if that's possible how could I do it?. Thanks a lot.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/PPP-with-latitude-longitude-coordinates-tp6639204p6639204.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amorenos1 at ucentral.edu.co  Mon Aug  1 00:25:37 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Sun, 31 Jul 2011 15:25:37 -0700 (PDT)
Subject: [R-sig-Geo] convert (lat -lon) coordinates to cartesian coordinates
Message-ID: <1312151137981-6639235.post@n2.nabble.com>

Hi, I have a list.In the fisrt column are the latitudes, in the second column
are the longitudes, how could i convert this format to cartesian
coordinates, is that possible in R?,Thanks  a lot.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/convert-lat-lon-coordinates-to-cartesian-coordinates-tp6639235p6639235.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.turner at auckland.ac.nz  Mon Aug  1 00:39:47 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 01 Aug 2011 10:39:47 +1200
Subject: [R-sig-Geo] PPP with latitude/longitude coordinates
In-Reply-To: <1312150401275-6639204.post@n2.nabble.com>
References: <1312150401275-6639204.post@n2.nabble.com>
Message-ID: <4E35D9B3.805@auckland.ac.nz>

On 01/08/11 10:13, Angelo Moreno wrote:
> Hello somebady could tell me i f I can create a ppp with latitude and
> longitude coordinates...if that's possible how could I do it?. Thanks a lot.

Well, you can *create* a ppp object with latitude and longitude coordinates,
just the same way you create any ppp object.  Not that the observation 
window
must of course be described in the same coordinate system.

The problem is, what do you do with the object after you've created it?  The
tools in spatstat analyze ppp objects using Euclidean distance calculations,
and these are inappropriate for latitude and longitude coordinates.

So far there is no facility in spatstat for calculating/making use of 
the appropriate
``great circle'' distances that should be used with such coordinates.

There may be tools in the "sp" package which could help you to make some
progress.

     cheers,

         Rolf Turner


From r.turner at auckland.ac.nz  Mon Aug  1 00:45:36 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 01 Aug 2011 10:45:36 +1200
Subject: [R-sig-Geo] convert (lat -lon) coordinates to cartesian
	coordinates
In-Reply-To: <1312151137981-6639235.post@n2.nabble.com>
References: <1312151137981-6639235.post@n2.nabble.com>
Message-ID: <4E35DB10.1050407@auckland.ac.nz>

On 01/08/11 10:25, Angelo Moreno wrote:
> Hi, I have a list.In the fisrt column are the latitudes, in the second column
> are the longitudes, how could i convert this format to cartesian
> coordinates, is that possible in R?,Thanks  a lot.

It's really not that simple.  Latitude and longitude are coordinates on
the surface of a sphere.  Cartesian coordinates are coordinates on a
flat surface.  They are fundamentally incompatible. There are various
***projections*** of regions of a spherical surface onto a plain that 
provide
approximate relationships.  How good these approximations are depends on
the size and shape of the region on the spherical surface.

There may be tools in the "sp" package which could be of use to you.

     cheers,

         Rolf Turner


From mdsumner at gmail.com  Mon Aug  1 01:31:31 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 1 Aug 2011 09:31:31 +1000
Subject: [R-sig-Geo] convert (lat -lon) coordinates to cartesian
	coordinates
In-Reply-To: <4E35DB10.1050407@auckland.ac.nz>
References: <1312151137981-6639235.post@n2.nabble.com>
	<4E35DB10.1050407@auckland.ac.nz>
Message-ID: <CAAcGz9976NFMaqGnpUfSMZ+fbXaXcukhtT-UjsmO7CkAyh7BPA@mail.gmail.com>

As Rolf suggests, there is spTransform in rgdal (supported by sp
package) for general coordinate transformation using the PROJ.4
library.

What  projection is appropriate for *completely* depends on what you
need to do and where your data are from (and their extent), though
there are some pretty general guidelines that can be used to make a
safe decision.

If you just want distance on the WGS84 ellipsoid there is spDistsN1 in
the sp package, but if you want to input projected coordinates into
spatstat functions you'll need to find out what projection is
appropriate from the beginning.

Let us know more about the requirements and it will be easier to make
suggestions.

Cheers, Mike.


On Mon, Aug 1, 2011 at 8:45 AM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
> On 01/08/11 10:25, Angelo Moreno wrote:
>>
>> Hi, I have a list.In the fisrt column are the latitudes, in the second
>> column
>> are the longitudes, how could i convert this format to cartesian
>> coordinates, is that possible in R?,Thanks ?a lot.
>
> It's really not that simple. ?Latitude and longitude are coordinates on
> the surface of a sphere. ?Cartesian coordinates are coordinates on a
> flat surface. ?They are fundamentally incompatible. There are various
> ***projections*** of regions of a spherical surface onto a plain that
> provide
> approximate relationships. ?How good these approximations are depends on
> the size and shape of the region on the spherical surface.
>
> There may be tools in the "sp" package which could be of use to you.
>
> ? ?cheers,
>
> ? ? ? ?Rolf Turner
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From izahn at psych.rochester.edu  Mon Aug  1 17:09:16 2011
From: izahn at psych.rochester.edu (Ista Zahn)
Date: Mon, 1 Aug 2011 11:09:16 -0400
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
Message-ID: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>

Hi all,
I am trying to aggregate the UScensus data for Florida up to the zip
code level using unionSpatialPolygons from the maptools package. This
works for other states, but not for Florida:

## Works
tmp <- county(fips = gsub("^..", "",
countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
"tract")
dat <- as.data.frame(tmp)
tmp.county <- unionSpatialPolygons(tmp, dat$county)

## Returns error
tmp <- county(fips = gsub("^..", "",
countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
"tract")
dat <- as.data.frame(tmp)
tmp.county <- unionSpatialPolygons(tmp, dat$county)
Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
names(ids)[i],  :
  TopologyException: found non-noded intersection between LINESTRING
(-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
0.433456, -0.677839 0.434367) at -0.678743 0.433456

Does anyone have a suggestion about how to do this?

Thanks!

Ista
-- 
Ista Zahn
Graduate student
University of Rochester
Department of Clinical and Social Psychology
http://yourpsyche.org


From izahn at psych.rochester.edu  Mon Aug  1 17:13:31 2011
From: izahn at psych.rochester.edu (Ista Zahn)
Date: Mon, 1 Aug 2011 11:13:31 -0400
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
Message-ID: <CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>

Oops, I got the examples mixed up. The Alabama example works, the
Florida example does not. I also should have given the version info,
as this may well be version specific.

R version 2.13.1 (2011-07-08)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
 [1] rgeos_0.1-8             stringr_0.5             quadprog_1.5-4
 [4] directlabels_1.3        UScensus2000_1.00       gpclib_1.5-1
 [7] UScensus2000cdp_0.03    UScensus2000blkgrp_0.03 UScensus2000tract_0.03
[10] rgdal_0.7-1             maptools_0.8-9          lattice_0.19-30
[13] sp_0.9-84               foreign_0.8-45          ggplot2_0.8.9
[16] proto_0.3-9.2           reshape_0.8.4           plyr_1.5.2

loaded via a namespace (and not attached):
[1] digest_0.5.0 tools_2.13.1
>

On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu> wrote:
> Hi all,
> I am trying to aggregate the UScensus data for Florida up to the zip
> code level using unionSpatialPolygons from the maptools package. This
> works for other states, but not for Florida:
>
> ## Works
> tmp <- county(fips = gsub("^..", "",
> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
> "tract")
> dat <- as.data.frame(tmp)
> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>
> ## Returns error
> tmp <- county(fips = gsub("^..", "",
> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
> "tract")
> dat <- as.data.frame(tmp)
> tmp.county <- unionSpatialPolygons(tmp, dat$county)
> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
> names(ids)[i], ?:
> ?TopologyException: found non-noded intersection between LINESTRING
> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>
> Does anyone have a suggestion about how to do this?
>
> Thanks!
>
> Ista
> --
> Ista Zahn
> Graduate student
> University of Rochester
> Department of Clinical and Social Psychology
> http://yourpsyche.org
>



-- 
Ista Zahn
Graduate student
University of Rochester
Department of Clinical and Social Psychology
http://yourpsyche.org


From Roger.Bivand at nhh.no  Mon Aug  1 20:38:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 1 Aug 2011 20:38:39 +0200 (CEST)
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
	<CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>

On Mon, 1 Aug 2011, Ista Zahn wrote:

> Oops, I got the examples mixed up. The Alabama example works, the
> Florida example does not. I also should have given the version info,
> as this may well be version specific.

You also need to provide the link to the data file, and the code prior to 
what you show. The function county() is not defined anywhere, 
consequently the attribute fields are nothing like tract boundaries such 
as those on:

http://www.census.gov/geo/www/cob/tr2000.html

The lines do intersect (touch), and should not in a topologically correct 
setting; the coordinates seem odd - what is the projection? Did you run 
checkPolygonsHoles() first?

Roger

>
> R version 2.13.1 (2011-07-08)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] rgeos_0.1-8             stringr_0.5             quadprog_1.5-4
> [4] directlabels_1.3        UScensus2000_1.00       gpclib_1.5-1
> [7] UScensus2000cdp_0.03    UScensus2000blkgrp_0.03 UScensus2000tract_0.03
> [10] rgdal_0.7-1             maptools_0.8-9          lattice_0.19-30
> [13] sp_0.9-84               foreign_0.8-45          ggplot2_0.8.9
> [16] proto_0.3-9.2           reshape_0.8.4           plyr_1.5.2
>
> loaded via a namespace (and not attached):
> [1] digest_0.5.0 tools_2.13.1
>>
>
> On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu> wrote:
>> Hi all,
>> I am trying to aggregate the UScensus data for Florida up to the zip
>> code level using unionSpatialPolygons from the maptools package. This
>> works for other states, but not for Florida:
>>
>> ## Works
>> tmp <- county(fips = gsub("^..", "",
>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>> "tract")
>> dat <- as.data.frame(tmp)
>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>
>> ## Returns error
>> tmp <- county(fips = gsub("^..", "",
>> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
>> "tract")
>> dat <- as.data.frame(tmp)
>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
>> names(ids)[i], ?:
>> ?TopologyException: found non-noded intersection between LINESTRING
>> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
>> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>>
>> Does anyone have a suggestion about how to do this?
>>
>> Thanks!
>>
>> Ista
>> --
>> Ista Zahn
>> Graduate student
>> University of Rochester
>> Department of Clinical and Social Psychology
>> http://yourpsyche.org
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From izahn at psych.rochester.edu  Mon Aug  1 20:59:48 2011
From: izahn at psych.rochester.edu (Ista Zahn)
Date: Mon, 1 Aug 2011 14:59:48 -0400
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <14263_1312223893_4E36F293_14263_6767_1_alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
	<CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
	<14263_1312223893_4E36F293_14263_6767_1_alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>
Message-ID: <CA+vqiLHOPHH-hhdVYVYEFMHLM7HfNfSMgPc8NmaT6dTbAbYh_A@mail.gmail.com>

Hi Roger,

On Mon, Aug 1, 2011 at 2:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 1 Aug 2011, Ista Zahn wrote:
>
>> Oops, I got the examples mixed up. The Alabama example works, the
>> Florida example does not. I also should have given the version info,
>> as this may well be version specific.
>
> You also need to provide the link to the data file, and the code prior to
> what you show. The function county() is not defined anywhere, consequently
> the attribute fields are nothing like tract boundaries such as those on:

Sorry I wasn't clear. The data and the county function are in the
UScensus2000 packages. Let me try again. A complete example leading to
the error is

library(UScensus2000)
library(maptools)
data(countyfips)

tmp <- county(fips = gsub("^..", "",
countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
"tract")
dat <- as.data.frame(tmp)
tmp.county <- unionSpatialPolygons(tmp, dat$county)

>
> http://www.census.gov/geo/www/cob/tr2000.html
>
> The lines do intersect (touch), and should not in a topologically correct
> setting; the coordinates seem odd - what is the projection? Did you run
> checkPolygonsHoles() first?

I would if I could figure out how to convert a SpatialPolygons object
to a Polygons object... I'm just getting started with sp.

Thanks,
Ista

>
> Roger
>
>>
>> R version 2.13.1 (2011-07-08)
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods
>> [8] base
>>
>> other attached packages:
>> [1] rgeos_0.1-8 ? ? ? ? ? ? stringr_0.5 ? ? ? ? ? ? quadprog_1.5-4
>> [4] directlabels_1.3 ? ? ? ?UScensus2000_1.00 ? ? ? gpclib_1.5-1
>> [7] UScensus2000cdp_0.03 ? ?UScensus2000blkgrp_0.03 UScensus2000tract_0.03
>> [10] rgdal_0.7-1 ? ? ? ? ? ? maptools_0.8-9 ? ? ? ? ?lattice_0.19-30
>> [13] sp_0.9-84 ? ? ? ? ? ? ? foreign_0.8-45 ? ? ? ? ?ggplot2_0.8.9
>> [16] proto_0.3-9.2 ? ? ? ? ? reshape_0.8.4 ? ? ? ? ? plyr_1.5.2
>>
>> loaded via a namespace (and not attached):
>> [1] digest_0.5.0 tools_2.13.1
>>>
>>
>> On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu>
>> wrote:
>>>
>>> Hi all,
>>> I am trying to aggregate the UScensus data for Florida up to the zip
>>> code level using unionSpatialPolygons from the maptools package. This
>>> works for other states, but not for Florida:
>>>
>>> ## Works
>>> tmp <- county(fips = gsub("^..", "",
>>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>>> "tract")
>>> dat <- as.data.frame(tmp)
>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>
>>> ## Returns error
>>> tmp <- county(fips = gsub("^..", "",
>>> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
>>> "tract")
>>> dat <- as.data.frame(tmp)
>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
>>> names(ids)[i], ?:
>>> ?TopologyException: found non-noded intersection between LINESTRING
>>> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
>>> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>>>
>>> Does anyone have a suggestion about how to do this?
>>>
>>> Thanks!
>>>
>>> Ista
>>> --
>>> Ista Zahn
>>> Graduate student
>>> University of Rochester
>>> Department of Clinical and Social Psychology
>>> http://yourpsyche.org
>>>
>>
>>
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>



-- 
Ista Zahn
Graduate student
University of Rochester
Department of Clinical and Social Psychology
http://yourpsyche.org


From matevz.pavlic at gi-zrmk.si  Mon Aug  1 22:02:56 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Mon, 1 Aug 2011 22:02:56 +0200
Subject: [R-sig-Geo] problems with universal kriging
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90129DECB@gi-zrmk.si>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110801/2099fc73/attachment.pl>

From Roger.Bivand at nhh.no  Mon Aug  1 22:29:49 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 1 Aug 2011 22:29:49 +0200 (CEST)
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <CA+vqiLHOPHH-hhdVYVYEFMHLM7HfNfSMgPc8NmaT6dTbAbYh_A@mail.gmail.com>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
	<CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
	<14263_1312223893_4E36F293_14263_6767_1_alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>
	<CA+vqiLHOPHH-hhdVYVYEFMHLM7HfNfSMgPc8NmaT6dTbAbYh_A@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108012227330.22927@reclus.nhh.no>

On Mon, 1 Aug 2011, Ista Zahn wrote:

> Hi Roger,
>
> On Mon, Aug 1, 2011 at 2:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Mon, 1 Aug 2011, Ista Zahn wrote:
>>
>>> Oops, I got the examples mixed up. The Alabama example works, the
>>> Florida example does not. I also should have given the version info,
>>> as this may well be version specific.
>>
>> You also need to provide the link to the data file, and the code prior to
>> what you show. The function county() is not defined anywhere, consequently
>> the attribute fields are nothing like tract boundaries such as those on:
>
> Sorry I wasn't clear. The data and the county function are in the
> UScensus2000 packages. Let me try again. A complete example leading to
> the error is
>
> library(UScensus2000)

Perhaps contact the package maintainer? It is very possible that the 
package ships with unclean topologies, isn't it? I'll try to look later.

Roger

> library(maptools)
> data(countyfips)
>
> tmp <- county(fips = gsub("^..", "",
> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
> "tract")
> dat <- as.data.frame(tmp)
> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>
>>
>> http://www.census.gov/geo/www/cob/tr2000.html
>>
>> The lines do intersect (touch), and should not in a topologically correct
>> setting; the coordinates seem odd - what is the projection? Did you run
>> checkPolygonsHoles() first?
>
> I would if I could figure out how to convert a SpatialPolygons object
> to a Polygons object... I'm just getting started with sp.
>
> Thanks,
> Ista
>
>>
>> Roger
>>
>>>
>>> R version 2.13.1 (2011-07-08)
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252
>>> [2] LC_CTYPE=English_United States.1252
>>> [3] LC_MONETARY=English_United States.1252
>>> [4] LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods
>>> [8] base
>>>
>>> other attached packages:
>>> [1] rgeos_0.1-8 ? ? ? ? ? ? stringr_0.5 ? ? ? ? ? ? quadprog_1.5-4
>>> [4] directlabels_1.3 ? ? ? ?UScensus2000_1.00 ? ? ? gpclib_1.5-1
>>> [7] UScensus2000cdp_0.03 ? ?UScensus2000blkgrp_0.03 UScensus2000tract_0.03
>>> [10] rgdal_0.7-1 ? ? ? ? ? ? maptools_0.8-9 ? ? ? ? ?lattice_0.19-30
>>> [13] sp_0.9-84 ? ? ? ? ? ? ? foreign_0.8-45 ? ? ? ? ?ggplot2_0.8.9
>>> [16] proto_0.3-9.2 ? ? ? ? ? reshape_0.8.4 ? ? ? ? ? plyr_1.5.2
>>>
>>> loaded via a namespace (and not attached):
>>> [1] digest_0.5.0 tools_2.13.1
>>>>
>>>
>>> On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu>
>>> wrote:
>>>>
>>>> Hi all,
>>>> I am trying to aggregate the UScensus data for Florida up to the zip
>>>> code level using unionSpatialPolygons from the maptools package. This
>>>> works for other states, but not for Florida:
>>>>
>>>> ## Works
>>>> tmp <- county(fips = gsub("^..", "",
>>>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>>>> "tract")
>>>> dat <- as.data.frame(tmp)
>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>>
>>>> ## Returns error
>>>> tmp <- county(fips = gsub("^..", "",
>>>> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
>>>> "tract")
>>>> dat <- as.data.frame(tmp)
>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
>>>> names(ids)[i], ?:
>>>> ?TopologyException: found non-noded intersection between LINESTRING
>>>> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
>>>> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>>>>
>>>> Does anyone have a suggestion about how to do this?
>>>>
>>>> Thanks!
>>>>
>>>> Ista
>>>> --
>>>> Ista Zahn
>>>> Graduate student
>>>> University of Rochester
>>>> Department of Clinical and Social Psychology
>>>> http://yourpsyche.org
>>>>
>>>
>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From vetter at pik-potsdam.de  Tue Aug  2 10:23:09 2011
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Tue, 02 Aug 2011 10:23:09 +0200
Subject: [R-sig-Geo] problems with universal kriging
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B90129DECB@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B90129DECB@gi-zrmk.si>
Message-ID: <4E37B3ED.6050403@pik-potsdam.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110802/9706b628/attachment.pl>

From matevz.pavlic at gi-zrmk.si  Tue Aug  2 10:48:53 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Tue, 2 Aug 2011 10:48:53 +0200
Subject: [R-sig-Geo] problems with universal kriging
In-Reply-To: <4E37B3ED.6050403@pik-potsdam.de>
References: <AD5CA6183570B54F92AA45CE2619F9B90129DECB@gi-zrmk.si>
	<4E37B3ED.6050403@pik-potsdam.de>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90129DF29@gi-zrmk.si>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110802/eb2c825d/attachment.pl>

From andrewaduff at gmail.com  Tue Aug  2 18:58:34 2011
From: andrewaduff at gmail.com (andrewaduff)
Date: Tue, 2 Aug 2011 09:58:34 -0700 (PDT)
Subject: [R-sig-Geo] conversion of ascii grid (or SpatialPixelsDataFrame) to
 adehabitatHR::estUD-class
Message-ID: <1312304314413-6645600.post@n2.nabble.com>

Hi List,

I have a series of ascii grid files representing home range probability
distribution functions.  The home ranges were calculated in various R
packages (adehabitat, bbmm, ks) and I would like generate volume indices
(PHR, VI, BA) for them using Clement Calenge's kerneloverlaphr function in
adehabitatHR.  Does anyone know how to convert an ascii grid (or
SpatialPixelsDataFrame) to an object of class adehabitatHR::estUD-class
("estUDm")?

Thanks in advance,

Andy

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/conversion-of-ascii-grid-or-SpatialPixelsDataFrame-to-adehabitatHR-estUD-class-tp6645600p6645600.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From greenberg at ucdavis.edu  Tue Aug  2 21:26:46 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Tue, 2 Aug 2011 12:26:46 -0700
Subject: [R-sig-Geo] Sampling via polygons question
Message-ID: <CABG0rfuT+N6iN8Wdcs0Kj6+MqquMqsX++FXD2v-jRfgSe3Nikg@mail.gmail.com>

R-sig-geo'ers:

Hoping to get some feedback on this problem.  Given a SpatialPolygons
object with N polygons, I would like to sample (probably via raster's
"extract") a window from a raster() object around *each pixel* falling
with *each polygon*.  I'm not asking about a straight buffer around a
polygon and then sampling via (e.g.) extract -- this is more akin to
converting each polygon to a set of points representing cells of the
raster object, then sampling via a buffer around each of these points.
 The window to be extracted around each location is of a fixed size,
so each point within a polygon should yield the same size output.
Thoughts?  What is the most efficient way to convert a polygon to a
set of points?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From matevz.pavlic at gi-zrmk.si  Tue Aug  2 22:20:53 2011
From: matevz.pavlic at gi-zrmk.si (Matevz Pavlic)
Date: Tue, 2 Aug 2011 13:20:53 -0700 (PDT)
Subject: [R-sig-Geo] problems with universal kriging
In-Reply-To: <4E37B3ED.6050403@pik-potsdam.de>
References: <AD5CA6183570B54F92AA45CE2619F9B90129DDF2@gi-zrmk.si>
	<AD5CA6183570B54F92AA45CE2619F9B90129DECB@gi-zrmk.si>
	<4E37B3ED.6050403@pik-potsdam.de>
Message-ID: <1312316453135-6646333.post@n2.nabble.com>

Tobias, 

thanks a million! It works, don't know why and how, but I could hardly think
of trying that...
thanks, m

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problems-with-universal-kriging-tp6637983p6646333.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From cb1 at ualberta.ca  Wed Aug  3 05:12:09 2011
From: cb1 at ualberta.ca (Colin Bergeron)
Date: Tue, 2 Aug 2011 21:12:09 -0600
Subject: [R-sig-Geo] Convert LatLong to UTM
Message-ID: <CANcFkiRRh4Rstp_-A4ONB6ZY_bSgc-er6sv_QmdAj-fcSCVR1Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110802/8e87e531/attachment.pl>

From pierre.roudier at gmail.com  Wed Aug  3 05:23:43 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 3 Aug 2011 15:23:43 +1200
Subject: [R-sig-Geo] Convert LatLong to UTM
In-Reply-To: <CANcFkiRRh4Rstp_-A4ONB6ZY_bSgc-er6sv_QmdAj-fcSCVR1Q@mail.gmail.com>
References: <CANcFkiRRh4Rstp_-A4ONB6ZY_bSgc-er6sv_QmdAj-fcSCVR1Q@mail.gmail.com>
Message-ID: <CADLQFsPtiQVjfir60twdbMGT5BGXDoyWY5_i4KTe6X3f01jz1w@mail.gmail.com>

Dear Colin,

Using sp and rgdal:

library(rgdal)

LatLong <- data.frame(X = c(56.85359, 56.85478), Y = c(-118.4109, -118.4035))
names(LatLong) <- c("X","Y")

# Convert it to a sp object
coordinates(LatLong) <- ~ Y + X # longitude first

# Add a coordinate reference system
proj4string(LatLong) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")

> LatLong
SpatialPoints:
             Y        X
[1,] -118.4109 56.85359
[2,] -118.4035 56.85478
Coordinate Reference System (CRS) arguments: +proj=longlat +ellps=WGS84
+datum=WGS84 +towgs84=0,0,0

# Project using spTransform
Utm <- spTransform(LatLong, CRS("+proj=utm +zone=11 ellps=WGS84"))

> Utm
SpatialPoints:
          Y       X
[1,] 413958 6301976
[2,] 414412 6302099
Coordinate Reference System (CRS) arguments: +proj=utm +zone=11
+ellps=WGS84

HTH,

Pierre

2011/8/3 Colin Bergeron <cb1 at ualberta.ca>:
> Dear rSigGeo,
>
> I tried to convert a list of LatLong coordinates (in DD format) into UTM
> zone 11 NAD 27. I first tried this from PBSmapping:
>
> library(PBSmapping)
> LatLong<-cbind(c(56.85359, 56.85478),c(-118.4109, -118.4035))
> colnames(LatLong)<-c("X","Y")
>
> attr(LatLong, "projection") <- "LL"
> attr(LatLong, "zone") <-11
> UTM<-convUL(LatLong)
>
>
> #and that's what I get
>> UTM
> ? ? ? ? X ? ? ? ? Y
> 1 14088.69 -16092.76
> 2 14082.61 -16096.32
>
> Now, the UTM values are supposed to be around:
> ? ?X ? ?Y
> 1 414040 ? ? 6301764.2
> 2 414493 ? ? ? ? ? 6301888.39
>
> So, I then tried with rgdal
> library(rgdal)
>
> UTM<-project(LatLong, "+proj=utm +zone=11 ellps=WGS84")
>
> #and that's what i get:
>
> projected point not finite
> projected point not finite
>
> # The possible errors I see are DD format in the LatLong file. Maybe I
> should be able to specify that it is zone 11 north or I think NAD 27 should
> also be specified somewhere. What do you think?
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From Roger.Bivand at nhh.no  Wed Aug  3 13:24:49 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Aug 2011 13:24:49 +0200 (CEST)
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <alpine.LRH.2.00.1108012227330.22927@reclus.nhh.no>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
	<CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
	<14263_1312223893_4E36F293_14263_6767_1_alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>
	<CA+vqiLHOPHH-hhdVYVYEFMHLM7HfNfSMgPc8NmaT6dTbAbYh_A@mail.gmail.com>
	<alpine.LRH.2.00.1108012227330.22927@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1108031317100.28351@reclus.nhh.no>

On Mon, 1 Aug 2011, Roger Bivand wrote:

> On Mon, 1 Aug 2011, Ista Zahn wrote:
>
>> Hi Roger,
>> 
>> On Mon, Aug 1, 2011 at 2:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>> On Mon, 1 Aug 2011, Ista Zahn wrote:
>>> 
>>>> Oops, I got the examples mixed up. The Alabama example works, the
>>>> Florida example does not. I also should have given the version info,
>>>> as this may well be version specific.
>>> 
>>> You also need to provide the link to the data file, and the code prior to
>>> what you show. The function county() is not defined anywhere, consequently
>>> the attribute fields are nothing like tract boundaries such as those on:
>> 
>> Sorry I wasn't clear. The data and the county function are in the
>> UScensus2000 packages. Let me try again. A complete example leading to
>> the error is
>> 
>> library(UScensus2000)
>
> Perhaps contact the package maintainer? It is very possible that the package 
> ships with unclean topologies, isn't it? I'll try to look later.

library(UScensus2000)
library(maptools)
data(countyfips)
tmp <- county(fips = gsub("^..", "", countyfips$fips[countyfips$acronym == 
"fl"]), state = "fl", level = "tract")
dat <- as.data.frame(tmp)
tmp.county <- unionSpatialPolygons(tmp, dat$county)
# fails on (-82.6787 28.4335) == (-82.6787 28.4335)
getScale()
setScale(1e+09)
tmp.county <- unionSpatialPolygons(tmp, dat$county)
# works

The issue is that GEOS assumes that it is working on planar coordinates, 
and allows plenty of trailing significant digits before truncating. With 
geographical coordinates, the nth trailing digit may be the one that 
disambiguates two points. Increasing the scale by one order of magnitude 
is sufficient in this case. I do not see the coordinates you stated 
initially.

Roger

>
> Roger
>
>> library(maptools)
>> data(countyfips)
>> 
>> tmp <- county(fips = gsub("^..", "",
>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>> "tract")
>> dat <- as.data.frame(tmp)
>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>> 
>>> 
>>> http://www.census.gov/geo/www/cob/tr2000.html
>>> 
>>> The lines do intersect (touch), and should not in a topologically correct
>>> setting; the coordinates seem odd - what is the projection? Did you run
>>> checkPolygonsHoles() first?
>> 
>> I would if I could figure out how to convert a SpatialPolygons object
>> to a Polygons object... I'm just getting started with sp.
>> 
>> Thanks,
>> Ista
>> 
>>> 
>>> Roger
>>> 
>>>> 
>>>> R version 2.13.1 (2011-07-08)
>>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>> 
>>>> locale:
>>>> [1] LC_COLLATE=English_United States.1252
>>>> [2] LC_CTYPE=English_United States.1252
>>>> [3] LC_MONETARY=English_United States.1252
>>>> [4] LC_NUMERIC=C
>>>> [5] LC_TIME=English_United States.1252
>>>> 
>>>> attached base packages:
>>>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods
>>>> [8] base
>>>> 
>>>> other attached packages:
>>>> [1] rgeos_0.1-8 ? ? ? ? ? ? stringr_0.5 ? ? ? ? ? ? quadprog_1.5-4
>>>> [4] directlabels_1.3 ? ? ? ?UScensus2000_1.00 ? ? ? gpclib_1.5-1
>>>> [7] UScensus2000cdp_0.03 ? ?UScensus2000blkgrp_0.03 
>>>> UScensus2000tract_0.03
>>>> [10] rgdal_0.7-1 ? ? ? ? ? ? maptools_0.8-9 ? ? ? ? ?lattice_0.19-30
>>>> [13] sp_0.9-84 ? ? ? ? ? ? ? foreign_0.8-45 ? ? ? ? ?ggplot2_0.8.9
>>>> [16] proto_0.3-9.2 ? ? ? ? ? reshape_0.8.4 ? ? ? ? ? plyr_1.5.2
>>>> 
>>>> loaded via a namespace (and not attached):
>>>> [1] digest_0.5.0 tools_2.13.1
>>>>> 
>>>> 
>>>> On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu>
>>>> wrote:
>>>>> 
>>>>> Hi all,
>>>>> I am trying to aggregate the UScensus data for Florida up to the zip
>>>>> code level using unionSpatialPolygons from the maptools package. This
>>>>> works for other states, but not for Florida:
>>>>> 
>>>>> ## Works
>>>>> tmp <- county(fips = gsub("^..", "",
>>>>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>>>>> "tract")
>>>>> dat <- as.data.frame(tmp)
>>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>>> 
>>>>> ## Returns error
>>>>> tmp <- county(fips = gsub("^..", "",
>>>>> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
>>>>> "tract")
>>>>> dat <- as.data.frame(tmp)
>>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>>> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
>>>>> names(ids)[i], ?:
>>>>> ?TopologyException: found non-noded intersection between LINESTRING
>>>>> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
>>>>> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>>>>> 
>>>>> Does anyone have a suggestion about how to do this?
>>>>> 
>>>>> Thanks!
>>>>> 
>>>>> Ista
>>>>> --
>>>>> Ista Zahn
>>>>> Graduate student
>>>>> University of Rochester
>>>>> Department of Clinical and Social Psychology
>>>>> http://yourpsyche.org
>>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>> 
>> 
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From izahn at psych.rochester.edu  Wed Aug  3 13:45:57 2011
From: izahn at psych.rochester.edu (Ista Zahn)
Date: Wed, 3 Aug 2011 07:45:57 -0400
Subject: [R-sig-Geo] Problem with aggregating UScensus2000 FL data
In-Reply-To: <alpine.LRH.2.00.1108031317100.28351@reclus.nhh.no>
References: <CA+vqiLFGmxjm0kbY-KnCXyutyQ6mJr24oQg5gDzjEvZb+oMhMA@mail.gmail.com>
	<CA+vqiLFbx7jF+RNd2f+KDudduFYQ_PYCDCz6u8s_4KunsXeUTw@mail.gmail.com>
	<14263_1312223893_4E36F293_14263_6767_1_alpine.LRH.2.00.1108012034190.22644@reclus.nhh.no>
	<CA+vqiLHOPHH-hhdVYVYEFMHLM7HfNfSMgPc8NmaT6dTbAbYh_A@mail.gmail.com>
	<alpine.LRH.2.00.1108012227330.22927@reclus.nhh.no>
	<alpine.LRH.2.00.1108031317100.28351@reclus.nhh.no>
Message-ID: <CA+vqiLHO6aY3dGKjE-ixTtZ9PHZJET94QqrqThX0akBEfViCuw@mail.gmail.com>

On Wed, Aug 3, 2011 at 7:24 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 1 Aug 2011, Roger Bivand wrote:
>
>> On Mon, 1 Aug 2011, Ista Zahn wrote:
>>
>>> Hi Roger,
>>>
>>> On Mon, Aug 1, 2011 at 2:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>
>>>> On Mon, 1 Aug 2011, Ista Zahn wrote:
>>>>
>>>>> Oops, I got the examples mixed up. The Alabama example works, the
>>>>> Florida example does not. I also should have given the version info,
>>>>> as this may well be version specific.
>>>>
>>>> You also need to provide the link to the data file, and the code prior
>>>> to
>>>> what you show. The function county() is not defined anywhere,
>>>> consequently
>>>> the attribute fields are nothing like tract boundaries such as those on:
>>>
>>> Sorry I wasn't clear. The data and the county function are in the
>>> UScensus2000 packages. Let me try again. A complete example leading to
>>> the error is
>>>
>>> library(UScensus2000)
>>
>> Perhaps contact the package maintainer? It is very possible that the
>> package ships with unclean topologies, isn't it? I'll try to look later.
>
> library(UScensus2000)
> library(maptools)
> data(countyfips)
> tmp <- county(fips = gsub("^..", "", countyfips$fips[countyfips$acronym ==
> "fl"]), state = "fl", level = "tract")
> dat <- as.data.frame(tmp)
> tmp.county <- unionSpatialPolygons(tmp, dat$county)
> # fails on (-82.6787 28.4335) == (-82.6787 28.4335)
> getScale()
> setScale(1e+09)
> tmp.county <- unionSpatialPolygons(tmp, dat$county)
> # works
>
> The issue is that GEOS assumes that it is working on planar coordinates, and
> allows plenty of trailing significant digits before truncating. With
> geographical coordinates, the nth trailing digit may be the one that
> disambiguates two points. Increasing the scale by one order of magnitude is
> sufficient in this case. I do not see the coordinates you stated initially.

Ah! Yes, I am enlightened. Thank you Roger.

-Ista

>
> Roger
>
>>
>> Roger
>>
>>> library(maptools)
>>> data(countyfips)
>>>
>>> tmp <- county(fips = gsub("^..", "",
>>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>>> "tract")
>>> dat <- as.data.frame(tmp)
>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>
>>>>
>>>> http://www.census.gov/geo/www/cob/tr2000.html
>>>>
>>>> The lines do intersect (touch), and should not in a topologically
>>>> correct
>>>> setting; the coordinates seem odd - what is the projection? Did you run
>>>> checkPolygonsHoles() first?
>>>
>>> I would if I could figure out how to convert a SpatialPolygons object
>>> to a Polygons object... I'm just getting started with sp.
>>>
>>> Thanks,
>>> Ista
>>>
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> R version 2.13.1 (2011-07-08)
>>>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>>>
>>>>> locale:
>>>>> [1] LC_COLLATE=English_United States.1252
>>>>> [2] LC_CTYPE=English_United States.1252
>>>>> [3] LC_MONETARY=English_United States.1252
>>>>> [4] LC_NUMERIC=C
>>>>> [5] LC_TIME=English_United States.1252
>>>>>
>>>>> attached base packages:
>>>>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods
>>>>> [8] base
>>>>>
>>>>> other attached packages:
>>>>> [1] rgeos_0.1-8 ? ? ? ? ? ? stringr_0.5 ? ? ? ? ? ? quadprog_1.5-4
>>>>> [4] directlabels_1.3 ? ? ? ?UScensus2000_1.00 ? ? ? gpclib_1.5-1
>>>>> [7] UScensus2000cdp_0.03 ? ?UScensus2000blkgrp_0.03
>>>>> UScensus2000tract_0.03
>>>>> [10] rgdal_0.7-1 ? ? ? ? ? ? maptools_0.8-9 ? ? ? ? ?lattice_0.19-30
>>>>> [13] sp_0.9-84 ? ? ? ? ? ? ? foreign_0.8-45 ? ? ? ? ?ggplot2_0.8.9
>>>>> [16] proto_0.3-9.2 ? ? ? ? ? reshape_0.8.4 ? ? ? ? ? plyr_1.5.2
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] digest_0.5.0 tools_2.13.1
>>>>>>
>>>>>
>>>>> On Mon, Aug 1, 2011 at 11:09 AM, Ista Zahn <izahn at psych.rochester.edu>
>>>>> wrote:
>>>>>>
>>>>>> Hi all,
>>>>>> I am trying to aggregate the UScensus data for Florida up to the zip
>>>>>> code level using unionSpatialPolygons from the maptools package. This
>>>>>> works for other states, but not for Florida:
>>>>>>
>>>>>> ## Works
>>>>>> tmp <- county(fips = gsub("^..", "",
>>>>>> countyfips$fips[countyfips$acronym == "fl"]), state = "fl", level =
>>>>>> "tract")
>>>>>> dat <- as.data.frame(tmp)
>>>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>>>>
>>>>>> ## Returns error
>>>>>> tmp <- county(fips = gsub("^..", "",
>>>>>> countyfips$fips[countyfips$acronym == "al"]), state = "al", level =
>>>>>> "tract")
>>>>>> dat <- as.data.frame(tmp)
>>>>>> tmp.county <- unionSpatialPolygons(tmp, dat$county)
>>>>>> Error in TopologyFunc(groupID(spgeom[ids[[i]]], id[ids[[i]]]),
>>>>>> names(ids)[i], ?:
>>>>>> ?TopologyException: found non-noded intersection between LINESTRING
>>>>>> (-0.640183 0.433522, -0.678743 0.433456) and LINESTRING (-0.678743
>>>>>> 0.433456, -0.677839 0.434367) at -0.678743 0.433456
>>>>>>
>>>>>> Does anyone have a suggestion about how to do this?
>>>>>>
>>>>>> Thanks!
>>>>>>
>>>>>> Ista
>>>>>> --
>>>>>> Ista Zahn
>>>>>> Graduate student
>>>>>> University of Rochester
>>>>>> Department of Clinical and Social Psychology
>>>>>> http://yourpsyche.org
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>
>>>
>>>
>>>
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Ista Zahn
Graduate student
University of Rochester
Department of Clinical and Social Psychology
http://yourpsyche.org


From Roger.Bivand at nhh.no  Wed Aug  3 16:47:02 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Aug 2011 16:47:02 +0200
Subject: [R-sig-Geo] Sampling via polygons question
In-Reply-To: <CABG0rfuT+N6iN8Wdcs0Kj6+MqquMqsX++FXD2v-jRfgSe3Nikg@mail.gmail.com>
References: <CABG0rfuT+N6iN8Wdcs0Kj6+MqquMqsX++FXD2v-jRfgSe3Nikg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108031643440.28448@reclus.nhh.no>

On Tue, 2 Aug 2011, Jonathan Greenberg wrote:

> R-sig-geo'ers:
>
> Hoping to get some feedback on this problem.  Given a SpatialPolygons
> object with N polygons, I would like to sample (probably via raster's
> "extract") a window from a raster() object around *each pixel* falling
> with *each polygon*.  I'm not asking about a straight buffer around a
> polygon and then sampling via (e.g.) extract -- this is more akin to
> converting each polygon to a set of points representing cells of the
> raster object, then sampling via a buffer around each of these points.
> The window to be extracted around each location is of a fixed size,
> so each point within a polygon should yield the same size output.
> Thoughts?  What is the most efficient way to convert a polygon to a
> set of points?

Could you please provide a self-contained code example, possibly with a 
simple downloadable shapefile of polygons covering your case? Are the 
polygons intended to touch? are the buffers in fact the pixels 
(rectangular) or circular? I think I see what you mean, but may well 
misunderstand your intentions.

Roger

>
> --j
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Kevin.Morelle at ulg.ac.be  Wed Aug  3 17:26:56 2011
From: Kevin.Morelle at ulg.ac.be (=?ISO-8859-1?Q?K=E9vin_Morelle?=)
Date: Wed, 03 Aug 2011 17:26:56 +0200
Subject: [R-sig-Geo] SpatStat: creating window from quadrats
Message-ID: <4E3968C0.1080905@ulg.ac.be>

Dear R-sig-geo list members,

I'm using the SpatStat R packages for analysing patterns of wild boar 
damages, considered as my point pattern dataset.
This dataset is quite large, covering almost whole Belgium. I would like 
to make my analysis by quadrats of 10x10km. I thus created quadrats 
covering my points dataset using quadrats function.
There come my question. I would like to retain as my window, only the 
quadrats that contain damage points and remove the one that are empty. I 
have the feeling this question is trivial but I couldn't find any way to 
do that (apart from creating a grid shape in GIS, but would prefer not...).
Thanks for your help,
Regards,

Kevin

-- 
Morelle Kevin
Universit? de Li?ge - Gembloux Agro-Bio Tech
Unit? de Gestion des Ressources foresti?res et des Milieux naturels
--------
University of Li?ge - Gembloux Agro-Bio Tech
Unit of Forest and Nature Management
--------
2, Passage des D?port?s
B-5030  GEMBLOUX
BELGIQUE

T?l : + 32 (0)81 62.22.14
Fax : + 32 (0)81 62.23.01
E-mail : kevin.morelle at ulg.ac.be
Web : http://www.fsagx.ac.be/gf/


From r.m.krug at gmail.com  Wed Aug  3 18:14:01 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Wed, 3 Aug 2011 18:14:01 +0200
Subject: [R-sig-Geo] Problem with writing Raster into grass using gdal
Message-ID: <CAGhLh6FJnqScn7aw5TXJ8dccQsiE82=66i+jDYRoCOWV1rQDMg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110803/ba25789b/attachment.pl>

From marcelino.delacruz at upm.es  Wed Aug  3 18:34:53 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Wed, 03 Aug 2011 17:34:53 +0100
Subject: [R-sig-Geo] SpatStat: creating window from quadrats
In-Reply-To: <4E3968C0.1080905@ulg.ac.be>
Message-ID: <lKJDGNjX.1312389293.3030180.marcelino.delacruz@upm.es>

Hi Kevin,

My answer with an example:

 W <- square(10) # the big window
 Z <- quadrats(W, 4, 5) # the quadrats

 # point pattern of boarddamage in the big window:
 boardd <- rpoispp(0.1, win=W)

# A splited point pattern. Each element is a quadrat with at least one
point
 boardquadrats <- split(boardd, Z, drop=T)

Cheers, Marcelino





Con fecha 3/8/2011, "K?vin Morelle" <Kevin.Morelle at ulg.ac.be> escribi?:

>Dear R-sig-geo list members,
>
>I'm using the SpatStat R packages for analysing patterns of wild boar 
>damages, considered as my point pattern dataset.
>This dataset is quite large, covering almost whole Belgium. I would like 
>to make my analysis by quadrats of 10x10km. I thus created quadrats 
>covering my points dataset using quadrats function.
>There come my question. I would like to retain as my window, only the 
>quadrats that contain damage points and remove the one that are empty. I 
>have the feeling this question is trivial but I couldn't find any way to 
>do that (apart from creating a grid shape in GIS, but would prefer not...).
>Thanks for your help,
>Regards,
>
>Kevin
>
>-- 
>Morelle Kevin
>Universit? de Li?ge - Gembloux Agro-Bio Tech
>Unit? de Gestion des Ressources foresti?res et des Milieux naturels
>--------
>University of Li?ge - Gembloux Agro-Bio Tech
>Unit of Forest and Nature Management
>--------
>2, Passage des D?port?s
>B-5030  GEMBLOUX
>BELGIQUE
>
>T?l : + 32 (0)81 62.22.14
>Fax : + 32 (0)81 62.23.01
>E-mail : kevin.morelle at ulg.ac.be
>Web : http://www.fsagx.ac.be/gf/
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Thierry.ONKELINX at inbo.be  Thu Aug  4 00:11:41 2011
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 3 Aug 2011 22:11:41 +0000
Subject: [R-sig-Geo] cleaning up SpatialLines
Message-ID: <AA818EAD2576BC488B4F623941DA74273B7B07C9@inbomail.inbo.be>

Dear all,

I have a SpatialLinesDataFrame containing a lot of short line fragments. Many of them have exactly one other linefragment at one (or both) of their end vertices. I would like to merge those linefragments to that each line is at both end vertices either connected to at least two other lines or to no other line.

Does someone has an effecient solution for this? Via R or via grass?

I managed already to add a grouping variable to the data.frame. But I still need to find a way to merge the coordinates of the lines from the same Group. See the example below.

Best regards,

Thierry

library(sp)
Raw <- 
SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1), y = c(0, 1, 1)))), ID = 1),
Lines(list(Line(cbind(x = c(2, 2, 1), y = c(0, 1, 1)))), ID = 2),
Lines(list(Line(cbind(x = c(-2, -2), y = c(0, -1)))), ID = 3)
))
Raw <- SpatialLinesDataFrame(Raw, data.frame(ID = 1:3, Group = c(1,1,2)))

Result <- 
        SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1, 2, 2), y = c(0, 1, 1, 1, 0)))), ID = 1),
                        Lines(list(Line(cbind(x = c(-2, -2), y = c(0, -1)))), ID = 2)
                ))
Result <- SpatialLinesDataFrame(Result, data.frame(ID = 1:2, Group = c(1,2)))



From dylan.beaudette at gmail.com  Thu Aug  4 00:45:44 2011
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed, 3 Aug 2011 15:45:44 -0700
Subject: [R-sig-Geo] cleaning up SpatialLines
In-Reply-To: <AA818EAD2576BC488B4F623941DA74273B7B07C9@inbomail.inbo.be>
References: <AA818EAD2576BC488B4F623941DA74273B7B07C9@inbomail.inbo.be>
Message-ID: <CAOGWcHJd4doXQxwdwR32VdU=Scr6xvsNW0a5L1ELGdULYdWAMA@mail.gmail.com>

On Wed, Aug 3, 2011 at 3:11 PM, ONKELINX, Thierry
<Thierry.ONKELINX at inbo.be> wrote:
> Dear all,
>
> I have a SpatialLinesDataFrame containing a lot of short line fragments. Many of them have exactly one other linefragment at one (or both) of their end vertices. I would like to merge those linefragments to that each line is at both end vertices either connected to at least two other lines or to no other line.
>
> Does someone has an effecient solution for this? Via R or via grass?
>
> I managed already to add a grouping variable to the data.frame. But I still need to find a way to merge the coordinates of the lines from the same Group. See the example below.
>
> Best regards,
>
> Thierry
>
> library(sp)
> Raw <-
> SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1), y = c(0, 1, 1)))), ID = 1),
> Lines(list(Line(cbind(x = c(2, 2, 1), y = c(0, 1, 1)))), ID = 2),
> Lines(list(Line(cbind(x = c(-2, -2), y = c(0, -1)))), ID = 3)
> ))
> Raw <- SpatialLinesDataFrame(Raw, data.frame(ID = 1:3, Group = c(1,1,2)))
>
> Result <-
> ? ? ? ?SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1, 2, 2), y = c(0, 1, 1, 1, 0)))), ID = 1),
> ? ? ? ? ? ? ? ? ? ? ? ?Lines(list(Line(cbind(x = c(-2, -2), y = c(0, -1)))), ID = 2)
> ? ? ? ? ? ? ? ?))
> Result <- SpatialLinesDataFrame(Result, data.frame(ID = 1:2, Group = c(1,2)))
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

Would something like this work:

# using your example from above ...
library(rgeos)

# merge lines by group, manually
Raw.u <- gLineMerge(Raw[Raw$Group == 1, ])

# automated approach, using spatial intersection as the criteria for splitting
Raw.u <- gLineMerge(Raw)

... note that IDs are lost in the second, automated approach.
Iterating over IDs might be the safest approach.

Dylan


From manuel.schneider at art.admin.ch  Thu Aug  4 11:39:14 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Thu, 4 Aug 2011 09:39:14 +0000
Subject: [R-sig-Geo] reading gpx using readOGR
References: <CAHT1vpjyj76LJZP1iELUkL5UMa20hN_O7DsxzCyx4WhtfWqA1A@mail.gmail.com>
	<alpine.LRH.2.00.1107231050150.13472@reclus.nhh.no>
	<CAHT1vpj9AxjmO5ufbi6wxapQHX6FWj4mHYqh3EYA9dJ=q1RVsQ@mail.gmail.com>
	<alpine.LRH.2.00.1107231955520.14739@reclus.nhh.no>
	<CAHT1vpgqS+QdEbuJJndV82m+ZLzOu5uyZwYcxRJVt-NkPsnbCA@mail.gmail.com>
	<alpine.LRH.2.00.1107240846350.16717@reclus.nhh.no>
	<CAHT1vpg1Xmo8DL6tVXfqK7eXuvbT6+Cj=mofK-adsWDCdsTvHw@mail.gmail.com>
Message-ID: <loom.20110804T113103-306@post.gmane.org>

Alternatively gpsbabel may be used to translate gpx to e.g. table format and
reading in.

#system call to gpsbabel
system(paste(path_to_gpsbabel," -w -i gpx -f ", infile,".gpx -o openoffice -F ",
outfile,".txt", sep="")) 

#read-in data
d <- read.table(paste(outfile, ".txt", sep=""), h=T)

#conversion of openoffice time format
d$Time <- as.POSIXct(d$Time*86400,origin=as.Date("1899-12-30"), tz="UTC")

HTH
Manuel


From saldanha.plangeo at gmail.com  Thu Aug  4 13:32:15 2011
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Thu, 4 Aug 2011 08:32:15 -0300
Subject: [R-sig-Geo] Highway Distance matrix
Message-ID: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110804/1b4bf6ee/attachment.pl>

From saldanha.plangeo at gmail.com  Thu Aug  4 14:06:07 2011
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Thu, 4 Aug 2011 09:06:07 -0300
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <CANuoaEHUnW_qhyCTZhu5767UtqL88vSadc36T_6Sa=xcRP9jbw@mail.gmail.com>
References: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
	<CANuoaEHUnW_qhyCTZhu5767UtqL88vSadc36T_6Sa=xcRP9jbw@mail.gmail.com>
Message-ID: <CACSWb41zHfLR48Fucqe8ePMYrPhneET4qSKdMV+hUBiuWVMArg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110804/53d3fc78/attachment.pl>

From lubinbin220 at gmail.com  Thu Aug  4 14:00:41 2011
From: lubinbin220 at gmail.com (binbin lu)
Date: Thu, 4 Aug 2011 13:00:41 +0100
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
References: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
Message-ID: <CANuoaEHUnW_qhyCTZhu5767UtqL88vSadc36T_6Sa=xcRP9jbw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110804/52987fda/attachment.pl>

From jeremy.raw at dot.gov  Thu Aug  4 16:37:40 2011
From: jeremy.raw at dot.gov (jeremy.raw at dot.gov)
Date: Thu, 4 Aug 2011 10:37:40 -0400
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
References: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
Message-ID: <B3C9A56C0E6FBF48A7D3ED79E9A7A9C004F4F8F8@OSTMAIL03VS3.ad.dot.gov>

There is certainly no need to go anywhere near ArcGIS for this type of
operation.

The simplest approach would be to look at one of the packages that does
shortest path evaluations on a network.  On CRAN, the igraph package
lets you can do this pretty straightforwardly.  Alternatively, the
travelr package on R-Forge (not actively maintained, but functional for
this purpose) is also available.  Igraph is easier if you are
comfortable with basic graph theory (and translating to and from the
0-based indexing that the current version of igraph uses for node/vertex
numbering), whereas travelr may be easier if you are already comfortable
with transport modeling.

The basic steps are to convert your base map into a suitable
graph/network format (e.g. via what igraph calls an edgelist) and then
to use shortest.paths in igraph, or build.paths and skim.paths in
travelr, to compute the matrix of distances.

Igraph also has a help list where some of the set-up questions for this
type of problem have already been addressed:
https://lists.nongnu.org/mailman/listinfo/igraph-help

I hope that helps!

Jeremy Raw, P.E.
FHWA Office of Planning
jeremy.raw at dot.gov
(202) 366-0986


-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Raphael Saldanha
Sent: Thursday, August 04, 2011 7:32 AM
To: r-sig-geo
Subject: [R-sig-Geo] Highway Distance matrix

Hi,

How can I compute a distance matrix of points (citys) based on a highway
base map?


Regards in advance,

Raphael Saldanha
saldanha.plangeo at gmail.com

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Kevin.Morelle at ulg.ac.be  Thu Aug  4 16:53:54 2011
From: Kevin.Morelle at ulg.ac.be (=?ISO-8859-1?Q?K=E9vin_Morelle?=)
Date: Thu, 04 Aug 2011 16:53:54 +0200
Subject: [R-sig-Geo] SpatStat: creating window from quadrats
In-Reply-To: <lKJDGNjX.1312389293.3030180.marcelino.delacruz@upm.es>
References: <lKJDGNjX.1312389293.3030180.marcelino.delacruz@upm.es>
Message-ID: <4E3AB282.3080804@ulg.ac.be>

Dear Marcelino,

Thanks for your reply...
It works until I have to use 'boardquadrats' as my window. boardquadrats 
is a list including binary image mask, and i have to convert it in a 
window, am I right?
Reading the book from Baddeley, it seems I have to convert it in a 
matrix and then only in a window using 'owin'. But somehow it doesn't 
work...
Sorry with this I'm only discovering R (and Spatial R) very recently.
Thank you for any further help you could provide me,
Regards,

Kevin

Le 03/08/2011 18:34, marcelino.delacruz at upm.es a ?crit :
> Hi Kevin,
>
> My answer with an example:
>
>   W<- square(10) # the big window
>   Z<- quadrats(W, 4, 5) # the quadrats
>
>   # point pattern of boarddamage in the big window:
>   boardd<- rpoispp(0.1, win=W)
>
> # A splited point pattern. Each element is a quadrat with at least one
> point
>   boardquadrats<- split(boardd, Z, drop=T)
>
> Cheers, Marcelino
>
>
>
>
>
> Con fecha 3/8/2011, "K?vin Morelle"<Kevin.Morelle at ulg.ac.be>  escribi?:
>
>> Dear R-sig-geo list members,
>>
>> I'm using the SpatStat R packages for analysing patterns of wild boar
>> damages, considered as my point pattern dataset.
>> This dataset is quite large, covering almost whole Belgium. I would like
>> to make my analysis by quadrats of 10x10km. I thus created quadrats
>> covering my points dataset using quadrats function.
>> There come my question. I would like to retain as my window, only the
>> quadrats that contain damage points and remove the one that are empty. I
>> have the feeling this question is trivial but I couldn't find any way to
>> do that (apart from creating a grid shape in GIS, but would prefer not...).
>> Thanks for your help,
>> Regards,
>>
>> Kevin
>>
>> -- 
>> Morelle Kevin
>> Universit? de Li?ge - Gembloux Agro-Bio Tech
>> Unit? de Gestion des Ressources foresti?res et des Milieux naturels
>> --------
>> University of Li?ge - Gembloux Agro-Bio Tech
>> Unit of Forest and Nature Management
>> --------
>> 2, Passage des D?port?s
>> B-5030  GEMBLOUX
>> BELGIQUE
>>
>> T?l : + 32 (0)81 62.22.14
>> Fax : + 32 (0)81 62.23.01
>> E-mail : kevin.morelle at ulg.ac.be
>> Web : http://www.fsagx.ac.be/gf/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Morelle Kevin
Universit? de Li?ge - Gembloux Agro-Bio Tech
Unit? de Gestion des Ressources foresti?res et des Milieux naturels
--------
University of Li?ge - Gembloux Agro-Bio Tech
Unit of Forest and Nature Management
--------
2, Passage des D?port?s
B-5030  GEMBLOUX
BELGIQUE

T?l : + 32 (0)81 62.22.14
Fax : + 32 (0)81 62.23.01
E-mail : kevin.morelle at ulg.ac.be
Web : http://www.fsagx.ac.be/gf/


From saldanha.plangeo at gmail.com  Thu Aug  4 16:56:20 2011
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Thu, 4 Aug 2011 11:56:20 -0300
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <B3C9A56C0E6FBF48A7D3ED79E9A7A9C004F4F8F6@OSTMAIL03VS3.ad.dot.gov>
References: <CACSWb42U9J+M+LNcGQAYOqG2iVz7Tz-99s1HafOJZs+iLBLf+w@mail.gmail.com>
	<B3C9A56C0E6FBF48A7D3ED79E9A7A9C004F4F8F6@OSTMAIL03VS3.ad.dot.gov>
Message-ID: <CACSWb42RGYjvCMnFA-MTfSx-cUJ5JeaJ0=dB9ktprdUSdmw7EQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110804/d416b134/attachment.pl>

From lubinbin220 at gmail.com  Thu Aug  4 20:36:33 2011
From: lubinbin220 at gmail.com (lubinbin220 at gmail.com)
Date: Thu, 4 Aug 2011 18:36:33 +0000
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <CACSWb42RGYjvCMnFA-MTfSx-cUJ5JeaJ0=dB9ktprdUSdmw7EQ@mail.gmail.com>
Message-ID: <0015174c3cb29a9d4604a9b2429c@google.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110804/843a1676/attachment.pl>

From Roger.Bivand at nhh.no  Thu Aug  4 21:46:18 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 4 Aug 2011 21:46:18 +0200
Subject: [R-sig-Geo] Highway Distance matrix
In-Reply-To: <0015174c3cb29a9d4604a9b2429c@google.com>
References: <0015174c3cb29a9d4604a9b2429c@google.com>
Message-ID: <alpine.LRH.2.00.1108042047340.3692@reclus.nhh.no>

On Thu, 4 Aug 2011, lubinbin220 at gmail.com wrote:

> Hi,
>
> I agree with Jeremy, but it seems that it's not very handy to use igraph to
> compute the shortest path. I have developed a package "shp2graph"to
> transform a road network data set from a SpatialLinesDataFrame. Based on
> this, I have writen a guide to compute the shorest path in R, which is
> available at the following link:
>
> https://sourceforge.net/projects/shp2graph/files/Guide%20for%20computing%20shortest%20paths%20with%20given%20points%20and%20base%20network%20map.pdf/download
>
> If any queries, please email me. Any comment or suggestion is welcome.

And note that it will be presented at useR! in Coventry (UK) on 
Wednesday 17 August, 16.00 - 17.05, B3.03, with other spatial papers (see 
also 11.15 - 12.35, B3.02 same day). All welcome!

Roger

>
> Binbin
>
> On , Raphael Saldanha <saldanha.plangeo at gmail.com> wrote:
>> Thanks Jeremy! I will take a good look on this.
>
>
>
>> On Thu, Aug 4, 2011 at 11:36 AM, jeremy.raw at dot.gov> wrote:
>
>
>
>>> There is certainly no need to go anywhere near ArcGIS for this type of
>
>>> operation.
>
>>>
>
>>> The simplest approach would be to look at one of the packages that does
>
>>> shortest path evaluations on a network. On CRAN, the igraph package
>
>>> lets you can do this pretty straightforwardly. Alternatively, the
>
>>> travelr package on R-Forge (not actively maintained, but functional for
>
>>> this purpose) is also available. Igraph is easier if you are
>
>>> comfortable with basic graph theory (and translating to and from the
>
>>> 0-based indexing that the current version of igraph uses for node/vertex
>
>>> numbering), whereas travelr may be easier if you are already comfortable
>
>>> with transport modeling.
>
>>>
>
>>> The basic steps are to convert your base map into a suitable
>
>>> graph/network format (eg via what igraph calls an edgelist) and then
>
>>> to use shortest.paths in igraph, or build.paths and skim.paths in
>
>>> travelr, to compute the matrix of distances.
>
>>>
>
>>> Igraph also has a help list where some of the set-up questions for this
>
>>> type of problem have already been addressed:
>
>>> https://lists.nongnu.org/mailman/listinfo/igraph-help
>
>>>
>
>>> I hope that helps!
>
>>>
>
>>> Jeremy Raw, PE
>
>>> FHWA Office of Planning
>
>>> jeremy.raw at dot.gov
>
>>> (202) 366-0986
>
>>>
>
>>>
>
>>> -----Original Message-----
>
>>> From: r-sig-geo-bounces at r-project.org
>
>>> [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Raphael Saldanha
>
>>> Sent: Thursday, August 04, 2011 7:32 AM
>
>>> To: r-sig-geo
>
>>> Subject: [R-sig-Geo] Highway Distance matrix
>
>>>
>
>>> Hi,
>
>>>
>
>>> How can I compute a distance matrix of points (citys) based on a highway
>
>>> base map?
>
>>>
>
>>>
>
>>> Regards in advance,
>
>>>
>
>>> Raphael Saldanha
>
>>> saldanha.plangeo at gmail.com
>
>>>
>
>>> [[alternative HTML version deleted]]
>
>>>
>
>>> _______________________________________________
>
>>> R-sig-Geo mailing list
>
>>> R-sig-Geo at r-project.org
>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>>>
>
>
>
>
>
>
>
>> --
>
>> Atenciosamente,
>
>
>
>> Raphael Saldanha
>
>> saldanha.plangeo at gmail.com
>
>
>
>> [[alternative HTML version deleted]]
>
>
>
>> _______________________________________________
>
>> R-sig-Geo mailing list
>
>> R-sig-Geo at r-project.org
>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matzke at berkeley.edu  Fri Aug  5 02:06:33 2011
From: matzke at berkeley.edu (Nick Matzke)
Date: Thu, 4 Aug 2011 17:06:33 -0700
Subject: [R-sig-Geo] histogram of SpatialGridDataFrame values
Message-ID: <4E3B3409.40101@berkeley.edu>

Hi,

So I've loaded a DEM into a SpatialGridDataFrame, and I can 
plot it etc.

However, I would like to make a histogram of the pixel 
values (or just a random sample of the pixel values) to help 
make decisions about the color scheme etc.  Is there an easy 
way to do this?

Cheers!
Nick


-- 
====================================================
Nicholas J. Matzke
Ph.D. Candidate, Graduate Student Researcher

Huelsenbeck Lab
Center for Theoretical Evolutionary Genomics
4151 VLSB (Valley Life Sciences Building)
Department of Integrative Biology
University of California, Berkeley

Graduate Student Instructor, IB200B
Principles of Phylogenetics: Ecology and Evolution
http://ib.berkeley.edu/courses/ib200b/
http://phylo.wikidot.com/


Lab websites:
http://ib.berkeley.edu/people/lab_detail.php?lab=54
http://fisher.berkeley.edu/cteg/hlab.html
Dept. personal page: 
http://ib.berkeley.edu/people/students/person_detail.php?person=370
Lab personal page: 
http://fisher.berkeley.edu/cteg/members/matzke.html
Lab phone: 510-643-6299
Dept. fax: 510-643-6264

Cell phone: 510-301-0179
Email: matzke at berkeley.edu

Mailing address:
Department of Integrative Biology
3060 VLSB #3140
Berkeley, CA 94720-3140

-----------------------------------------------------
"[W]hen people thought the earth was flat, they were wrong. 
When people thought the earth was spherical, they were 
wrong. But if you think that thinking the earth is spherical 
is just as wrong as thinking the earth is flat, then your 
view is wronger than both of them put together."

Isaac Asimov (1989). "The Relativity of Wrong." The 
Skeptical Inquirer, 14(1), 35-44. Fall 1989.
http://chem.tufts.edu/AnswersInScience/RelativityofWrong.htm


From matzke at berkeley.edu  Fri Aug  5 04:04:56 2011
From: matzke at berkeley.edu (Nick Matzke)
Date: Thu, 4 Aug 2011 19:04:56 -0700
Subject: [R-sig-Geo] histogram of SpatialGridDataFrame values
In-Reply-To: <4E3B3409.40101@berkeley.edu>
References: <4E3B3409.40101@berkeley.edu>
Message-ID: <4E3B4FC8.9040303@berkeley.edu>

Nevermind, got it: as.matrix(dem)

On 8/4/11 5:06 PM, Nick Matzke wrote:
> Hi,
>
> So I've loaded a DEM into a SpatialGridDataFrame, and I can
> plot it etc.
>
> However, I would like to make a histogram of the pixel
> values (or just a random sample of the pixel values) to help
> make decisions about the color scheme etc. Is there an easy
> way to do this?
>
> Cheers!
> Nick
>
>

-- 
====================================================
Nicholas J. Matzke
Ph.D. Candidate, Graduate Student Researcher

Huelsenbeck Lab
Center for Theoretical Evolutionary Genomics
4151 VLSB (Valley Life Sciences Building)
Department of Integrative Biology
University of California, Berkeley

Graduate Student Instructor, IB200B
Principles of Phylogenetics: Ecology and Evolution
http://ib.berkeley.edu/courses/ib200b/
http://phylo.wikidot.com/


Lab websites:
http://ib.berkeley.edu/people/lab_detail.php?lab=54
http://fisher.berkeley.edu/cteg/hlab.html
Dept. personal page: 
http://ib.berkeley.edu/people/students/person_detail.php?person=370
Lab personal page: 
http://fisher.berkeley.edu/cteg/members/matzke.html
Lab phone: 510-643-6299
Dept. fax: 510-643-6264

Cell phone: 510-301-0179
Email: matzke at berkeley.edu

Mailing address:
Department of Integrative Biology
3060 VLSB #3140
Berkeley, CA 94720-3140

-----------------------------------------------------
"[W]hen people thought the earth was flat, they were wrong. 
When people thought the earth was spherical, they were 
wrong. But if you think that thinking the earth is spherical 
is just as wrong as thinking the earth is flat, then your 
view is wronger than both of them put together."

Isaac Asimov (1989). "The Relativity of Wrong." The 
Skeptical Inquirer, 14(1), 35-44. Fall 1989.
http://chem.tufts.edu/AnswersInScience/RelativityofWrong.htm


From mdsumner at gmail.com  Fri Aug  5 04:25:04 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 5 Aug 2011 12:25:04 +1000
Subject: [R-sig-Geo] histogram of SpatialGridDataFrame values
In-Reply-To: <4E3B4FC8.9040303@berkeley.edu>
References: <4E3B3409.40101@berkeley.edu>
	<4E3B4FC8.9040303@berkeley.edu>
Message-ID: <CAAcGz9-JfSFkihK6gBptunwpbpNMisN7W=fco1G+LWqnhoQVPw@mail.gmail.com>

More simply perhaps you can get any column by name or number like any
data.frame - this gives all pixel values for the first attribute
(assuming first colname is the default - use names(dem) to find out):

dem$band1

dem[[1]]



On Fri, Aug 5, 2011 at 12:04 PM, Nick Matzke <matzke at berkeley.edu> wrote:
> Nevermind, got it: as.matrix(dem)
>
> On 8/4/11 5:06 PM, Nick Matzke wrote:
>>
>> Hi,
>>
>> So I've loaded a DEM into a SpatialGridDataFrame, and I can
>> plot it etc.
>>
>> However, I would like to make a histogram of the pixel
>> values (or just a random sample of the pixel values) to help
>> make decisions about the color scheme etc. Is there an easy
>> way to do this?
>>
>> Cheers!
>> Nick
>>
>>
>
> --
> ====================================================
> Nicholas J. Matzke
> Ph.D. Candidate, Graduate Student Researcher
>
> Huelsenbeck Lab
> Center for Theoretical Evolutionary Genomics
> 4151 VLSB (Valley Life Sciences Building)
> Department of Integrative Biology
> University of California, Berkeley
>
> Graduate Student Instructor, IB200B
> Principles of Phylogenetics: Ecology and Evolution
> http://ib.berkeley.edu/courses/ib200b/
> http://phylo.wikidot.com/
>
>
> Lab websites:
> http://ib.berkeley.edu/people/lab_detail.php?lab=54
> http://fisher.berkeley.edu/cteg/hlab.html
> Dept. personal page:
> http://ib.berkeley.edu/people/students/person_detail.php?person=370
> Lab personal page: http://fisher.berkeley.edu/cteg/members/matzke.html
> Lab phone: 510-643-6299
> Dept. fax: 510-643-6264
>
> Cell phone: 510-301-0179
> Email: matzke at berkeley.edu
>
> Mailing address:
> Department of Integrative Biology
> 3060 VLSB #3140
> Berkeley, CA 94720-3140
>
> -----------------------------------------------------
> "[W]hen people thought the earth was flat, they were wrong. When people
> thought the earth was spherical, they were wrong. But if you think that
> thinking the earth is spherical is just as wrong as thinking the earth is
> flat, then your view is wronger than both of them put together."
>
> Isaac Asimov (1989). "The Relativity of Wrong." The Skeptical Inquirer,
> 14(1), 35-44. Fall 1989.
> http://chem.tufts.edu/AnswersInScience/RelativityofWrong.htm
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From M.J.Cracknell at utas.edu.au  Fri Aug  5 07:51:41 2011
From: M.J.Cracknell at utas.edu.au (mattc0)
Date: Fri, 05 Aug 2011 15:51:41 +1000
Subject: [R-sig-Geo] Grouping "linked" points
Message-ID: <fc6cb90330456.4e3c118d@utas.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/ac7ea234/attachment.pl>

From thomas.pengo at gmail.com  Fri Aug  5 08:58:55 2011
From: thomas.pengo at gmail.com (Thomas Pengo)
Date: Fri, 5 Aug 2011 08:58:55 +0200
Subject: [R-sig-Geo] Grouping "linked" points
In-Reply-To: <fc6cb90330456.4e3c118d@utas.edu.au>
References: <fc6cb90330456.4e3c118d@utas.edu.au>
Message-ID: <CA+ufgDOoUMjZ-JkAqwObZtjvh6PpeMdYQxipYOmmWS3qR1sp4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/3ad265b6/attachment.pl>

From lists at remoteinformation.com.au  Fri Aug  5 09:38:18 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Fri, 5 Aug 2011 15:38:18 +0800
Subject: [R-sig-Geo] Grouping "linked" points
In-Reply-To: <fc6cb90330456.4e3c118d@utas.edu.au>
References: <fc6cb90330456.4e3c118d@utas.edu.au>
Message-ID: <D1B0EBA8-9DAD-4229-97DC-24971FA47B8F@remoteinformation.com.au>

Matthew,

You might want to look at the graphing packages for this - network, sna, igraph will all help you. What you are describing is probably best thought of as an edgelist, so if using a function such as as.network() you may need to specify that it is 'edgelist'.

example code might look like : (note I'm using a data frame for your data, and the id (row name) will become the vertex.names attribute)

> library(network)
     Classes for Relational Data
Version      1.7 created on      July 7, 2011.
copyright (c) 2005, Carter T. Butts, University of California-Irvine
                    Mark S. Handcock, University of Washington
                    David R. Hunter, Penn State University
                    Martina Morris, University of Washington
For citation information, type citation("network").
Type help("network-package") to get started.
> links <- data.frame(rbind(c(5,3),c(10,16),c(20,1),c(19,8),c(19,1),c(7,11),c(11,13),c(4,13),c(15,20),c(16,2),c(13,7),c(14,16),c(11,8),c(16,12),NULL,NULL,c(12,14),NULL,c(4,5),NULL))
> g <- network(links)
> list.vertex.attributes(g)
[1] "na"           "vertex.names"
> get.vertex.attribute(g,"vertex.names")
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> plot(g)
> ?network

cheers

Ben


On 05/08/2011, at 1:51 PM, mattc0 wrote:

> Hi,
> 
> I have a list of the links shared by n points. Each element of the list represents the ID of a point and the entries for each element indicate the ID's of the points that it is linked with. I would like to group points via their ID's based on these links. There are an unknown number of groups and some points do not share any links.
> 
> I would be grateful for any assistance in pointing me towards a solution. An example list of 20 points with two links for each point is given below.
> 
> links <- list(c(5,3),c(10,16),c(20,1),c(19,8),c(19,1),c(7,11),c(11,13),c(4,13),c(15,20),c(16,2),c(13,7),c(14,16),c(11,8),c(16,12),NULL,NULL,c(12,14),NULL,c(4,5),NULL)
> 
> Thanks in advance,
> 
> Matthew Cracknell
> PhD. Candidate
> 
> ARC Centre of Excellence in Ore Deposits
> University of Tasmania
> Private Bag 79
> Hobart, 7001
> Australia
> 
> Mob: 0409438924 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.m.krug at gmail.com  Fri Aug  5 10:49:07 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 10:49:07 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
Message-ID: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>

Hi

I get an error in writeGDAL(), narrowed down in the call to
tds.out = new("GDALTransientDataset", driver = d.drv, rows = dims[2],
    cols = dims[1], bands = nbands, type = type, options = options,
    fname = fname, handle = NULL)
in create2GDAL.

This error is for me reproducible:
with the attached file, execute:

library(maptools)
library(rgdal)
region <- readAsciiGrid("region.asc.gz")
image(region)
writeGDAL(region, "region.tif")
## RESULT: Error in .local(.Object, ...) : Unable to create dataset

> Sys.info()
                                      sysname
                                      "Linux"
                                      release
                          "2.6.38-10-generic"
                                      version
"#46-Ubuntu SMP Tue Jun 28 15:05:41 UTC 2011"
                                     nodename
                                    "ecolmod"
                                      machine
                                       "i686"
                                        login
                                      "rkrug"
                                         user
                                      "rkrug"

> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: i686-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C
 [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8
 [5] LC_MONETARY=C             LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_GB.utf8       LC_NAME=C
 [9] LC_ADDRESS=C              LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-1     maptools_0.8-9  lattice_0.19-30 sp_0.9-84
[5] foreign_0.8-44

loaded via a namespace (and not attached):
[1] grid_2.13.1  tools_2.13.1
>

Cheers,

Rainer

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology,
UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax (F):       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/237955f7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: region.asc.gz
Type: application/x-gzip
Size: 3515 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/237955f7/attachment.gz>

From Thierry.ONKELINX at inbo.be  Fri Aug  5 10:50:02 2011
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 5 Aug 2011 08:50:02 +0000
Subject: [R-sig-Geo] cleaning up SpatialLines
In-Reply-To: <CAOGWcHJd4doXQxwdwR32VdU=Scr6xvsNW0a5L1ELGdULYdWAMA@mail.gmail.com>
References: <AA818EAD2576BC488B4F623941DA74273B7B07C9@inbomail.inbo.be>
	<CAOGWcHJd4doXQxwdwR32VdU=Scr6xvsNW0a5L1ELGdULYdWAMA@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA74273B7B140C@inbomail.inbo.be>

Thank you Dylan. Your solution works fine.

> -----Oorspronkelijk bericht-----
> Van: Dylan Beaudette [mailto:dylan.beaudette at gmail.com]
> Verzonden: donderdag 4 augustus 2011 0:46
> Aan: ONKELINX, Thierry
> CC: r-sig-geo at stat.math.ethz.ch
> Onderwerp: Re: [R-sig-Geo] cleaning up SpatialLines
> 
> On Wed, Aug 3, 2011 at 3:11 PM, ONKELINX, Thierry
> <Thierry.ONKELINX at inbo.be> wrote:
> > Dear all,
> >
> > I have a SpatialLinesDataFrame containing a lot of short line fragments. Many
> of them have exactly one other linefragment at one (or both) of their end
> vertices. I would like to merge those linefragments to that each line is at both
> end vertices either connected to at least two other lines or to no other line.
> >
> > Does someone has an effecient solution for this? Via R or via grass?
> >
> > I managed already to add a grouping variable to the data.frame. But I still
> need to find a way to merge the coordinates of the lines from the same Group.
> See the example below.
> >
> > Best regards,
> >
> > Thierry
> >
> > library(sp)
> > Raw <-
> > SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1), y = c(0, 1,
> > 1)))), ID = 1), Lines(list(Line(cbind(x = c(2, 2, 1), y = c(0, 1,
> > 1)))), ID = 2), Lines(list(Line(cbind(x = c(-2, -2), y = c(0, -1)))),
> > ID = 3)
> > ))
> > Raw <- SpatialLinesDataFrame(Raw, data.frame(ID = 1:3, Group =
> > c(1,1,2)))
> >
> > Result <-
> > ? ? ? ?SpatialLines(list(Lines(list(Line(cbind(x = c(0, 0, 1, 2, 2), y
> > = c(0, 1, 1, 1, 0)))), ID = 1),
> > ? ? ? ? ? ? ? ? ? ? ? ?Lines(list(Line(cbind(x = c(-2, -2), y = c(0,
> > -1)))), ID = 2)
> > ? ? ? ? ? ? ? ?))
> > Result <- SpatialLinesDataFrame(Result, data.frame(ID = 1:2, Group =
> > c(1,2)))
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> Would something like this work:
> 
> # using your example from above ...
> library(rgeos)
> 
> # merge lines by group, manually
> Raw.u <- gLineMerge(Raw[Raw$Group == 1, ])
> 
> # automated approach, using spatial intersection as the criteria for splitting
> Raw.u <- gLineMerge(Raw)
> 
> ... note that IDs are lost in the second, automated approach.
> Iterating over IDs might be the safest approach.
> 
> Dylan


From Roger.Bivand at nhh.no  Fri Aug  5 11:18:36 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 5 Aug 2011 11:18:36 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>

On Fri, 5 Aug 2011, Rainer M Krug wrote:

> Hi
>
> I get an error in writeGDAL(), narrowed down in the call to
> tds.out = new("GDALTransientDataset", driver = d.drv, rows = dims[2],
>    cols = dims[1], bands = nbands, type = type, options = options,
>    fname = fname, handle = NULL)
> in create2GDAL.
>
> This error is for me reproducible:
> with the attached file, execute:

Thanks for the example. For me all works as expected, system details 
below. You don't say which GDAL version you are running. I'm running rgdal 
from R-forge, but the changes do not affect the GDAL interface (added 
function for drawing a longlat grid over projected data). It is a bit 
surprising that file() in readAsciiGrid() reads a gzip-compressed file, 
but it clearly does both for you and me; readGDAL cannot read the 
compressed file for obvious reasons.

Roger

> library(rgdal)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)
> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: i686-pc-linux-gnu (32-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-2     maptools_0.8-9  lattice_0.19-31 sp_0.9-84
[5] foreign_0.8-45

loaded via a namespace (and not attached):
[1] grid_2.13.1


>
> library(maptools)
> library(rgdal)
> region <- readAsciiGrid("region.asc.gz")
> image(region)
> writeGDAL(region, "region.tif")
> ## RESULT: Error in .local(.Object, ...) : Unable to create dataset
>
>> Sys.info()
>                                      sysname
>                                      "Linux"
>                                      release
>                          "2.6.38-10-generic"
>                                      version
> "#46-Ubuntu SMP Tue Jun 28 15:05:41 UTC 2011"
>                                     nodename
>                                    "ecolmod"
>                                      machine
>                                       "i686"
>                                        login
>                                      "rkrug"
>                                         user
>                                      "rkrug"
>
>> sessionInfo()
> R version 2.13.1 (2011-07-08)
> Platform: i686-pc-linux-gnu (32-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8
> [5] LC_MONETARY=C             LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=en_GB.utf8       LC_NAME=C
> [9] LC_ADDRESS=C              LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.7-1     maptools_0.8-9  lattice_0.19-30 sp_0.9-84
> [5] foreign_0.8-44
>
> loaded via a namespace (and not attached):
> [1] grid_2.13.1  tools_2.13.1
>>
>
> Cheers,
>
> Rainer
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.m.krug at gmail.com  Fri Aug  5 11:33:10 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 11:33:10 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
Message-ID: <CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/b1018591/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug  5 12:12:45 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 5 Aug 2011 12:12:45 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
	<CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>

On Fri, 5 Aug 2011, Rainer M Krug wrote:

> On Fri, Aug 5, 2011 at 11:18 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 5 Aug 2011, Rainer M Krug wrote:
>>
>>  Hi
>>>
>>> I get an error in writeGDAL(), narrowed down in the call to
>>> tds.out = new("GDALTransientDataset", driver = d.drv, rows = dims[2],
>>>   cols = dims[1], bands = nbands, type = type, options = options,
>>>   fname = fname, handle = NULL)
>>> in create2GDAL.
>>>
>>> This error is for me reproducible:
>>> with the attached file, execute:
>>>
>>
>> Thanks for the example. For me all works as expected, system details below.
>> You don't say which GDAL version you are running.
>
>
> Sorry - gdal 1.8.0 from ubuntugis unstable - should I try it with 1.6?
>

Do they have 1.8.1? It shouldn't make any difference, but there have been 
many reports about instability in ubuntu binary GDAL over many versions. I 
only ever build GDAL from source, so I have control over the drivers. The 
binary build train may have assumed particular versions of external shared 
objects, for example.

Could you try:

tf1 <- tempfile()
tf2 <- tempfile()
writeGDAL(region, tf1)
writeGDAL(region, "region.txt", drivername="AAIGrid")
writeGDAL(region, tf2, drivername="AAIGrid")

to write to a different directory and use a different driver?

Roger

>
>
>> I'm running rgdal from R-forge, but the changes do not affect the GDAL
>> interface (added function for drawing a longlat grid over projected data).
>
> OK - the I don't have to try it out.
>
>
>> It is a bit surprising that file() in readAsciiGrid() reads a
>> gzip-compressed file, but it clearly does both for you and me;
>
>
> I just tried it and it worked - it is quite nice.
>
>
>> readGDAL cannot read the compressed file for obvious reasons.
>>
>
> Sure.
>
>
>>
>> Roger
>>
>>  library(rgdal)
>>>
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>>
>>  sessionInfo()
>>>
>> R version 2.13.1 (2011-07-08)
>> Platform: i686-pc-linux-gnu (32-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>
>>  [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
>>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-2     maptools_0.8-9  lattice_0.19-31 sp_0.9-84
>> [5] foreign_0.8-45
>>
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.13.1
>>
>>
>>
>>> library(maptools)
>>> library(rgdal)
>>> region <- readAsciiGrid("region.asc.gz")
>>> image(region)
>>> writeGDAL(region, "region.tif")
>>> ## RESULT: Error in .local(.Object, ...) : Unable to create dataset
>>>
>>>  Sys.info()
>>>>
>>>                                     sysname
>>>                                     "Linux"
>>>                                     release
>>>                         "2.6.38-10-generic"
>>>                                     version
>>> "#46-Ubuntu SMP Tue Jun 28 15:05:41 UTC 2011"
>>>                                    nodename
>>>                                   "ecolmod"
>>>                                     machine
>>>                                      "i686"
>>>                                       login
>>>                                     "rkrug"
>>>                                        user
>>>                                     "rkrug"
>>>
>>>  sessionInfo()
>>>>
>>> R version 2.13.1 (2011-07-08)
>>> Platform: i686-pc-linux-gnu (32-bit)
>>>
>>> locale:
>>> [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C
>>> [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8
>>> [5] LC_MONETARY=C             LC_MESSAGES=en_US.UTF-8
>>> [7] LC_PAPER=en_GB.utf8       LC_NAME=C
>>> [9] LC_ADDRESS=C              LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.7-1     maptools_0.8-9  lattice_0.19-30 sp_0.9-84
>>> [5] foreign_0.8-44
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.13.1  tools_2.13.1
>>>
>>>>
>>>>
>>> Cheers,
>>>
>>> Rainer
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.m.krug at gmail.com  Fri Aug  5 12:27:00 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 12:27:00 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
	<CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>
	<alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>
Message-ID: <CAGhLh6G18KGjN3Ssm3gyDugcSWdQ7VY4kOXdZZth4Ca240q_hQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/02df1726/attachment.pl>

From dicko.ahmadou at gmail.com  Fri Aug  5 12:48:01 2011
From: dicko.ahmadou at gmail.com (ahmadou dicko)
Date: Fri, 5 Aug 2011 10:48:01 +0000
Subject: [R-sig-Geo] Fwd: Problem with writing Raster into grass using gdal
In-Reply-To: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
Message-ID: <CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/6b241c85/attachment.pl>

From r.m.krug at gmail.com  Fri Aug  5 14:01:36 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 14:01:36 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <CAGhLh6G18KGjN3Ssm3gyDugcSWdQ7VY4kOXdZZth4Ca240q_hQ@mail.gmail.com>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
	<CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>
	<alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>
	<CAGhLh6G18KGjN3Ssm3gyDugcSWdQ7VY4kOXdZZth4Ca240q_hQ@mail.gmail.com>
Message-ID: <CAGhLh6HLrsw6MoEj52LLzE=+c6B+vCTGNgEw-4TO+jE07mKR=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/6713bf1f/attachment.pl>

From r.m.krug at gmail.com  Fri Aug  5 14:15:08 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 14:15:08 +0200
Subject: [R-sig-Geo] Fwd: Problem with writing Raster into grass using
	gdal
In-Reply-To: <CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>
Message-ID: <CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/1b859341/attachment.pl>

From rlist at zeidlers.de  Fri Aug  5 14:18:38 2011
From: rlist at zeidlers.de (Julian Zeidler)
Date: Fri, 05 Aug 2011 14:18:38 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <CAGhLh6HLrsw6MoEj52LLzE=+c6B+vCTGNgEw-4TO+jE07mKR=Q@mail.gmail.com>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>	<CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>	<alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>	<CAGhLh6G18KGjN3Ssm3gyDugcSWdQ7VY4kOXdZZth4Ca240q_hQ@mail.gmail.com>
	<CAGhLh6HLrsw6MoEj52LLzE=+c6B+vCTGNgEw-4TO+jE07mKR=Q@mail.gmail.com>
Message-ID: <4E3BDF9E.4040900@zeidlers.de>

Hi Rainer,

I am also running gdal from ubuntugis unstable with rgdal_0.7-1. (on an 
x64 Ubuntu 11.04), so was curious if I was affected as well.

However the test as suggested by Robert works for me without a hitch.

Best,
Julian





Am 05.08.2011 14:01, schrieb Rainer M Krug:
> On Fri, Aug 5, 2011 at 12:27 PM, Rainer M Krug<r.m.krug at gmail.com>  wrote:
>
>>
>> On Fri, Aug 5, 2011 at 12:12 PM, Roger Bivand<Roger.Bivand at nhh.no>  wrote:
>>
>>> On Fri, 5 Aug 2011, Rainer M Krug wrote:
>>>
>>>   On Fri, Aug 5, 2011 at 11:18 AM, Roger Bivand<Roger.Bivand at nhh.no>
>>>> wrote:
>>>>
>>>>   On Fri, 5 Aug 2011, Rainer M Krug wrote:
>>>>>   Hi
>>>>>
>>>>>> I get an error in writeGDAL(), narrowed down in the call to
>>>>>> tds.out = new("GDALTransientDataset", driver = d.drv, rows = dims[2],
>>>>>>   cols = dims[1], bands = nbands, type = type, options = options,
>>>>>>   fname = fname, handle = NULL)
>>>>>> in create2GDAL.
>>>>>>
>>>>>> This error is for me reproducible:
>>>>>> with the attached file, execute:
>>>>>>
>>>>>>
>>>>> Thanks for the example. For me all works as expected, system details
>>>>> below.
>>>>> You don't say which GDAL version you are running.
>>>>>
>>>>
>>>> Sorry - gdal 1.8.0 from ubuntugis unstable - should I try it with 1.6?
>>>>
>>>>
>>> Do they have 1.8.1? It shouldn't make any difference, but there have been
>>> many reports about instability in ubuntu binary GDAL over many versions. I
>>> only ever build GDAL from source, so I have control over the drivers. The
>>> binary build train may have assumed particular versions of external shared
>>> objects, for example.
>>>
>>> Could you try:
>>>
>>> tf1<- tempfile()
>>> tf2<- tempfile()
>>> writeGDAL(region, tf1)
>>> writeGDAL(region, "region.txt", drivername="AAIGrid")
>>> writeGDAL(region, tf2, drivername="AAIGrid")
>>>
>>> to write to a different directory and use a different driver?
>>>
>> Same problem:
>>
>>> tf1<- tempfile()
>>> tf2<- tempfile()
>>> region<- readAsciiGrid("region.asc.gz")
>>> writeGDAL(region, tf1)
>> Error in .local(.Object, ...) : Unable to create dataset
>>> writeGDAL(region, "region.txt", drivername="AAIGrid")
>> Error in .local(.Object, ...) : Unable to create dataset
>>> writeGDAL(region, tf2, drivername="AAIGrid")
>> Error in .local(.Object, ...) : Unable to create dataset
>>> traceback()
>> 7: .Call("RGDAL_CreateDataset", driver, as.integer(c(cols, rows,
>>         bands)), as.integer(typeNum), options, my_tempfile, PACKAGE =
>> "rgdal")
>> 6: .local(.Object, ...)
>> 5: initialize(value, ...)
>> 4: initialize(value, ...)
>> 3: new("GDALTransientDataset", driver = d.drv, rows = dims[2], cols =
>> dims[1],
>>         bands = nbands, type = type, options = options, fname = fname,
>>         handle = NULL)
>> 2: create2GDAL(dataset = dataset, drivername = copy_drivername,
>>         type = type, mvFlag = mvFlag, fname = NULL, setStatistics =
>> setStatistics)
>> 1: writeGDAL(region, tf2, drivername = "AAIGrid")
>> I'll install 1.8.1 from source, reinstall rgdal with that gdal version and
>> give some feedback - could I ask somebody else on the list to try out my
>> example, to see if it is only a local issue or caused b=y gdal?
>>
> OK -
> I compiled gdal 1.8.1,
> installed it in $HOME
> added $HOME/lib to /etc/ld.so.conf
> ran sudo ldconfig
> installed rgdal with  R CMD INSTALL
> --configure-args="--with-gdal-config=/home/rkrug/bin/gdal-config"
>   rgdal_0.7-1.tar.gz
> tried the example again
>
> it worked.
>
> But I still do not know if the problem was locally, or with gdal from
> ubuntugis or 1.8.0? No idea - but I am fine with it.
>
> Thanks a lot,
>
> Rainer
>
>
>> Rainer
>>
>>
>> Roger
>>>
>>>
>>>>   I'm running rgdal from R-forge, but the changes do not affect the GDAL
>>>>> interface (added function for drawing a longlat grid over projected
>>>>> data).
>>>>>
>>>> OK - the I don't have to try it out.
>>>>
>>>>
>>>>   It i a bit surprising that file() in readAsciiGrid() reads a
>>>>> gzip-compressed file, but it clearly does both for you and me;
>>>>>
>>>>
>>>> I just tried it and it worked - it is quite nice.
>>>>
>>>>
>>>>   readGDAL cannot read the compressed file for obvious reasons.
>>>>>
>>>> Sure.
>>>>
>>>>
>>>>
>>>>> Roger
>>>>>
>>>>>   library(rgdal)
>>>>>
>>>>>>   Geospatial Data Abstraction Library extensions to R successfully
>>>>> loaded
>>>>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
>>>>> Path to GDAL shared files: /usr/local/share/gdal
>>>>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>>>>> Path to PROJ.4 shared files: (autodetected)
>>>>>
>>>>>   sessionInfo()
>>>>>
>>>>>>   R version 2.13.1 (2011-07-08)
>>>>> Platform: i686-pc-linux-gnu (32-bit)
>>>>>
>>>>> locale:
>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>
>>>>>   [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
>>>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>
>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] rgdal_0.7-2     maptools_0.8-9  lattice_0.19-31 sp_0.9-84
>>>>> [5] foreign_0.8-45
>>>>>
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_2.13.1
>>>>>
>>>>>
>>>>>
>>>>>   library(maptools)
>>>>>> library(rgdal)
>>>>>> region<- readAsciiGrid("region.asc.gz")
>>>>>> image(region)
>>>>>> writeGDAL(region, "region.tif")
>>>>>> ## RESULT: Error in .local(.Object, ...) : Unable to create dataset
>>>>>>
>>>>>>   Sys.info()
>>>>>>
>>>>>>>                                      sysname
>>>>>>                                     "Linux"
>>>>>>                                     release
>>>>>>                         "2.6.38-10-generic"
>>>>>>                                     version
>>>>>> "#46-Ubuntu SMP Tue Jun 28 15:05:41 UTC 2011"
>>>>>>                                    nodename
>>>>>>                                   "ecolmod"
>>>>>>                                     machine
>>>>>>                                      "i686"
>>>>>>                                       login
>>>>>>                                     "rkrug"
>>>>>>                                        user
>>>>>>                                     "rkrug"
>>>>>>
>>>>>>   sessionInfo()
>>>>>>
>>>>>>>   R version 2.13.1 (2011-07-08)
>>>>>> Platform: i686-pc-linux-gnu (32-bit)
>>>>>>
>>>>>> locale:
>>>>>> [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C
>>>>>> [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8
>>>>>> [5] LC_MONETARY=C             LC_MESSAGES=en_US.UTF-8
>>>>>> [7] LC_PAPER=en_GB.utf8       LC_NAME=C
>>>>>> [9] LC_ADDRESS=C              LC_TELEPHONE=C
>>>>>> [11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] rgdal_0.7-1     maptools_0.8-9  lattice_0.19-30 sp_0.9-84
>>>>>> [5] foreign_0.8-44
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] grid_2.13.1  tools_2.13.1
>>>>>>
>>>>>>
>>>>>>>   Cheers,
>>>>>> Rainer
>>>>>>
>>>>>>
>>>>>>
>>>>>>   --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
>> --
>> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology,
>> UCT), Dipl. Phys. (Germany)
>>
>> Centre of Excellence for Invasion Biology
>> Stellenbosch University
>> South Africa
>>
>> Tel :       +33 - (0)9 53 10 27 44
>> Cell:       +33 - (0)6 85 62 59 98
>> Fax (F):       +33 - (0)9 58 10 27 44
>>
>> Fax (D):    +49 - (0)3 21 21 25 22 44
>>
>> email:      Rainer at krugs.de
>>
>> Skype:      RMkrug
>>
>>
>


From r.m.krug at gmail.com  Fri Aug  5 14:23:43 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 5 Aug 2011 14:23:43 +0200
Subject: [R-sig-Geo] Bug in writeGDAL / create2GDAL?
In-Reply-To: <4E3BDF9E.4040900@zeidlers.de>
References: <CAGhLh6FwBF4vUHZdP6n7a8WYgdAyTi0iCYqEvjkRMDFLYPMxQg@mail.gmail.com>
	<alpine.LRH.2.00.1108051104300.6109@reclus.nhh.no>
	<CAGhLh6EGDgW+BXxmDV4yNP2cKp-R=p4=SGcHe1KOU4VHW2awwg@mail.gmail.com>
	<alpine.LRH.2.00.1108051205190.6509@reclus.nhh.no>
	<CAGhLh6G18KGjN3Ssm3gyDugcSWdQ7VY4kOXdZZth4Ca240q_hQ@mail.gmail.com>
	<CAGhLh6HLrsw6MoEj52LLzE=+c6B+vCTGNgEw-4TO+jE07mKR=Q@mail.gmail.com>
	<4E3BDF9E.4040900@zeidlers.de>
Message-ID: <CAGhLh6H2CkwpJYdJBtpJ09-znKTUQ+o_iog1kNTpDwzUc6iqUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110805/35544b0f/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug  5 14:26:28 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 5 Aug 2011 14:26:28 +0200 (CEST)
Subject: [R-sig-Geo] Fwd: Problem with writing Raster into grass using
 gdal
In-Reply-To: <CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>
	<CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108051425530.6822@reclus.nhh.no>

On Fri, 5 Aug 2011, Rainer M Krug wrote:

> Hi
>
> you might have seen my other post, and the problem seems to be solved now -
> problems with the gdel installation.
>
> Concerning the error in writeRAST6: I would suggest to contact Roger Bivand
> so that can be fixed.

Committed to SVN on R-Forge, project rspatial, module spgrass6, thanks!

Roger

>
> Thanks a lot,
>
> Rainer
>
> On Fri, Aug 5, 2011 at 12:48 PM, ahmadou dicko <dicko.ahmadou at gmail.com>wrote:
>
>> I send this message yesterday, from NABBLE but i guess the server was
>> down...
>>
>> ---------- Forwarded message ----------
>> From: <r-sig-geo-owner at r-project.org>
>> Date: 2011/8/4
>> Subject: Re: Problem with writing Raster into grass using gdal
>> To: dicko.ahmadou at gmail.com
>>
>>
>> You are not allowed to post to this mailing list, and your message has
>> been automatically rejected.  If you think that your messages are
>> being rejected in error, contact the mailing list owner at
>> r-sig-geo-owner at r-project.org.
>>
>>
>>
>> ---------- Message transf?r? ----------
>> From: dicko ahmadou <dicko.ahmadou at gmail.com>
>> To: r-sig-geo at r-project.org
>> Date: Thu, 4 Aug 2011 12:30:32 -0700 (PDT)
>> Subject: Re: Problem with writing Raster into grass using gdal
>> Hi Rainer
>>
>> May be there's a problem with your data or with the GDAL binaries in your
>> installation.
>>
>> Did you have the same problem using for example a raster from the spearfish
>> location ?
>>
>> I have set all the GRASS variable permanently in my .bash_profile.
>> So i can run the following in  emacs (ESS)
>>
>> require(spgrass6)
>> execGRASS("g.mapset", parameters = list(gisdbase =
>> "/home/dickoa/GIS/GRASS/grassdata", location = "spearfish60", mapset =
>> "user1"))
>>
>> G <- gmeta6()
>> str(G)
>>
>> List of 24
>>  $ GISDBASE     : chr "/home/dickoa/GIS/GRASS/grassdata"
>>  $ LOCATION_NAME: chr "spearfish60"
>>  $ MAPSET       : chr "user1"
>>  $ GRASS_GUI    : chr "wxpython"
>>  $ MONITOR      : chr "cairo7"
>>  $ n            : num 4928000
>>  $ s            : num 4914000
>>  $ w            : num 590000
>>  $ e            : num 609000
>>  $ t            : num 1
>>  $ b            : num 0
>>  $ nsres        : num 100
>>  $ nsres3       : num 100
>>  $ ewres        : num 100
>>  $ ewres3       : num 100
>>  $ tbres        : num 1
>>  $ rows         : int 140
>>  $ rows3        : int 140
>>  $ cols         : int 190
>>  $ cols3        : int 190
>>  $ depths       : int 1
>>  $ cells        : chr "26600"
>>  $ cells3       : chr "26600"
>>  $ proj4        : chr "+proj=utm +zone=13 +a=6378206.4 +rf=294.9786982
>> +no_defs +nadgrids=/usr/local/grass-6.4.2svn/etc/nad/conus +to_meter=1.0"
>>  - attr(*, "class")= chr "gmeta6"
>>
>>
>> # the raster soils
>> soil <- readRAST6("soils", plugin = TRUE)
>>
>> #spplot(soil["soils"])
>>
>> # works
>> writeRAST6(soil, "soil2", useGDAL = TRUE)
>>
>>
>> execGRASS("r.info", flags = "r", parameters = list(map = "soil2"))
>> min=1
>> max=54
>>
>> soil$soils <- 2*soil$soils
>>
>> writeRAST6(soil, "soil2", useGDAL = TRUE, overwrite = TRUE)
>> WARNING: Raster map <soil2> already exists and will be overwritten
>> Projection of input dataset and current location appear to match
>>
>> execGRASS("r.info", flags = "r", parameters = list(map = "soil2"))
>> min=2
>> max=108
>>
>> # another attemp without GDAL
>> soil$soils <- soil$soils/4
>>
>> # Failed
>> writeRAST6(soil, "soil2", useGDAL = FALSE, overwrite = TRUE)
>> ERROR: option <output>: <soil2> exists
>>
>> There's a small bug in writeRAST6 which can be easyly fixed :
>>
>> just have to change in the writeRAST6 function this part :
>>
>> execGRASS("r.in.bin", flags = res$flags, parameters = list(input =
>> gtmpfl11,
>>           output = vname, bytes = as.integer(res$bytes), north =
>> as.numeric(res$north)
>>
>> by
>>
>> execGRASS("r.in.bin", flags = flags, parameters = list(input = gtmpfl11,
>>           output = vname, bytes = as.integer(res$bytes), north =
>> as.numeric(res$north)
>>
>>
>>
>> mywriteRAST6  <- function (x, vname, zcol = 1, NODATA = NULL, ignore.stderr
>> = FALSE,
>>   useGDAL = TRUE, overwrite = FALSE, flags = NULL, drivername = "GTiff")
>> {
>>   pid <- as.integer(round(runif(1, 1, 1000)))
>>   gtmpfl1 <- dirname(execGRASS("g.tempfile", parameters = list(pid = pid),
>>       intern = TRUE, ignore.stderr = ignore.stderr))
>>   rtmpfl1 <- ifelse(.Platform$OS.type == "windows" &&
>> (Sys.getenv("OSTYPE") ==
>>       "cygwin"), system(paste("cygpath -w", gtmpfl1, sep = " "),
>>       intern = TRUE), gtmpfl1)
>>   fid <- paste("X", pid, sep = "")
>>   gtmpfl11 <- paste(gtmpfl1, fid, sep = .Platform$file.sep)
>>   rtmpfl11 <- paste(rtmpfl1, fid, sep = .Platform$file.sep)
>>   if (!is.numeric(x at data[[zcol]]))
>>       stop("only numeric columns may be exported")
>>   if (overwrite && !("overwrite" %in% flags))
>>       flags <- c(flags, "overwrite")
>>   Gver <- execGRASS("g.version", intern = TRUE, ignore.stderr =
>> ignore.stderr)
>>   G63 <- !(Gver < "GRASS 6.3")
>>   if (useGDAL && G63) {
>>       gdalD <- gdalDrivers()$name
>>       gdalDGRASS <- execGRASS("r.out.gdal", flags = "l", intern = TRUE,
>>           ignore.stderr = TRUE)
>>       if (!(drivername %in% gdalD))
>>           stop(paste("Requested driver", drivername, "not available in
>> rgdal"))
>>       if (length(grep(drivername, gdalDGRASS)) == 0)
>>           stop(paste("Requested driver", drivername, "not available in
>> GRASS"))
>>       if (is.factor(x at data[[zcol]]))
>>           x at data[[zcol]] <- as.numeric(x at data[[zcol]])
>>       if (!is.numeric(x at data[[zcol]]))
>>           stop("only numeric values may be exported")
>>       if (is.null(NODATA)) {
>>           NODATA <- floor(min(x at data[[zcol]], na.rm = TRUE)) -
>>               1
>>       }
>>       else {
>>           if (!is.finite(NODATA) || !is.numeric(NODATA))
>>               stop("invalid NODATA value")
>>           if (NODATA != round(NODATA))
>>               warning("NODATA rounded to integer")
>>           NODATA <- round(NODATA)
>>       }
>>       sm <- storage.mode(x[[zcol]])
>>       type <- ifelse(sm == "integer", "Int32", "Float32")
>>       res <- writeGDAL(x[zcol], fname = rtmpfl11, type = type,
>>           drivername = drivername, mvFlag = NODATA)
>>       execGRASS("r.in.gdal", flags = flags, parameters = list(input =
>> gtmpfl11,
>>           output = vname), ignore.stderr = ignore.stderr)
>>       DS <- GDAL.open(rtmpfl11, read.only = FALSE)
>>       deleteDataset(DS)
>>   }
>>   else {
>>       res <- writeBinGrid(x, rtmpfl11, attr = zcol, na.value = NODATA)
>>       flags <- c(res$flag, flags)
>>       *execGRASS("r.in.bin", flags = flags, parameters = list(input =
>> gtmpfl11,
>>           output = vname, bytes = as.integer(res$bytes), north =
>> as.numeric(res$north)*,
>>           south = as.numeric(res$south), east = as.numeric(res$east),
>>           west = as.numeric(res$west), rows = as.integer(res$rows),
>>           cols = as.integer(res$cols), anull = as.numeric(res$anull)),
>>           ignore.stderr = ignore.stderr)
>>       unlink(paste(rtmpfl1, list.files(rtmpfl1, pattern = fid),
>>           sep = .Platform$file.sep))
>>   }
>>   invisible(res)
>> }
>>
>>
>>
>> writeRAST6(soil, "soil2", useGDAL = FALSE, overwrite = TRUE)
>>
>> execGRASS("r.info", flags = "r", parameters = list(map = "soil2"))
>> min=0.5
>> max=27
>>
>>
>> my session info is :
>> sessionInfo()
>> R version 2.13.1 (2011-07-08)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=fr_FR.UTF-8       LC_NUMERIC=C
>>  [3] LC_TIME=fr_FR.UTF-8        LC_COLLATE=fr_FR.UTF-8
>>  [5] LC_MONETARY=C              LC_MESSAGES=fr_FR.UTF-8
>>  [7] LC_PAPER=fr_FR.UTF-8       LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] grid      stats     graphics  grDevices utils     datasets
>> [7] methods   base
>>
>> other attached packages:
>>  [1] spgrass6_0.6-28 XML_3.4-0       rgdal_0.7-1
>>  [4] sp_0.9-84       stringr_0.5     ggplot2_0.8.9
>>  [7] proto_0.3-9.2   reshape_0.8.4   plyr_1.6
>> [10] MASS_7.3-14
>>
>> loaded via a namespace (and not attached):
>> [1] lattice_0.19-31 tools_2.13.1
>>
>> --
>> View this message in context:
>>
>> http://r-sig-geo.2731867.n2.nabble.com/Problem-with-writing-Raster-into-grass-using-gdal-tp6649314p6653995.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>>        [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Adrian.Baddeley at csiro.au  Sat Aug  6 04:43:37 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Sat, 6 Aug 2011 10:43:37 +0800
Subject: [R-sig-Geo]  Highway Distance matrix
Message-ID: <57DC18C299094D4299F837570C5DF1C54E8A751CA8@EXWA-MBX01.nexus.csiro.au>

Raphael Saldanha saldanha.plangeo at gmail.com<mailto:saldanha.plangeo at gmail.com> writes:

   > How can I compute a distance matrix of points (citys) based on a highway
   > base map?



The 'spatstat' package has functionality for analysing point patterns on a network of lines.

The function 'pairdist.lpp' will do exactly what you want.



        library(spatstat)

        help(pairdist.lpp)



[NB The current implementation of network analysis in spatstat is temporary and is not suited for very large databases. In a forthcoming version, the network code will be based on the 'igraph' package. ]



Adrian Baddeley


From jeff at ecology.su.se  Mon Aug  8 12:27:39 2011
From: jeff at ecology.su.se (Jeff Ranara)
Date: Mon, 8 Aug 2011 12:27:39 +0200
Subject: [R-sig-Geo] problem in writing shapefiles with writePointsShape()
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>	<CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
	<alpine.LRH.2.00.1108051425530.6822@reclus.nhh.no> 
Message-ID: <004001cc55b5$cc99ba10$65cd2e30$@su.se>

-----Original Message-----
From: Jeff Ranara [mailto:jeff.ranara at stockholmresilience.su.se] 
Sent: Monday, August 08, 2011 12:21 PM
To: 'r-sig-geo at r-project.org'
Subject: problem in writing shapefiles with writePointsShape()

Hi folks,

What am I missing here?  Am I using old routines? Missing some parameter?
Mixing up object types?  

Am under the gun and my time-limited attempts at troubleshooting have given
nada.  Am testing some workarounds in the meantime.  

Perhaps someone knows a quick answer? 

###The data of interest

#> typeof(MVALTARX6C)
#[1] "double"
#> str(MVALTARX6C)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX6C)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#1.38000e+07 5.33000e+12 2.68300e+13 3.65000e+14 1.42700e+14 2.37200e+16 
#       NA's 
#2.79119e+05 

#> typeof(MVALTARX6)
#[1] "double"
#> str(MVALTARX6)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX6)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#3.69600e+03 5.95600e+08 2.41200e+09 3.65300e+10 1.74800e+10 2.08200e+12 
#       NA's 
#2.79119e+05 
#>

#> typeof(MVALTARX3C)
#[1] "double"
#> str(MVALTARX3C)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX3C)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#1.29500e+07 5.33900e+11 1.90900e+12 1.14200e+13 9.17500e+12 4.88700e+15 
#       NA's 
#2.79119e+05

#> typeof(MVALTARX3)
#[1] "double"
#> str(MVALTARX3)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX3)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#3.69600e+03 6.80000e+07 2.56900e+08 1.09700e+09 1.14600e+09 4.28400e+11 
#       NA's 
#2.79119e+05

###WRITTEN TO A SHAPEFILE WITH THE FOLLOWING

new_df = cbind(BRNK01[1:13],
MRVALTARX6,MRVALTAX6C,MRVALTARX3,MRVALTAX3C,
RVALTARX6,RVALTARX6C,RVALTARX3,RVALTARX3C,
BRNK01[14:16], X1000M_6AX,TX1000M_6AX,G?nGAVST?n, 
MVALTARX6,MVALTARX6C,VALTARX6,VALTARX6C,
X300M_3AX,TX300M_3AX,
MVALTARX3,MVALTARX3C,VALTARX3,VALTARX3C,
BRNK01[17:66])

Typeof(BRNK01_SMPL25)

BRANK02_ACC = BRNK01_SMPL25
BRANK02_ACC at data = new_df

writePointsShape(BRANK02_ACC, "Sociotope_noBU_2003_BRNK02_AXC", factor2char
= TRUE, max_nchar=254)

### VALTARX6C and MVALTARX3C end up getting written to the shapefile
completely differently (see below). Both from inspection in ArcGIS and
reading 
#in the shapefile again.  VALTARX6 and MVALTARX3 get written fine.
VALTARX6C and MVALTARX3C are certainly larger values
##but well within the range of doubles

READ_BRANK02_ACC = readShapePoints("Sociotope_noBU_2003_BRNK02_AXC")


> BRANK02_ACC$MVALTARX6C[45:60]
 [1]           NA           NA           NA 2.005397e+12 1.513941e+12
 [6] 1.489291e+12 1.492141e+12 2.759250e+12 2.967822e+12 3.095638e+12
[11] 4.357538e+14 4.325040e+14 4.203615e+14 3.984211e+14 3.957644e+14
[16] 2.598429e+12

> READ_BRANK02_ACC$MVALTARX6C[45:60]
 [1] NA NA NA -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1

> BRANK02_ACC$MVALTARX6[45:60]
 [1]          NA          NA          NA   203110878   153213098   150521517
 [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
[13] 44138848859 41808450805 41503279631   277428340

> READ_BRANK02_ACC$MVALTARX6[45:60]
 [1]          NA          NA          NA   203110878   153213098   150521517
 [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
[13] 44138848859 41808450805 41503279631   277428340

> BRANK02_ACC$MVALTARX3C[45:60]
 [1]           NA           NA           NA 3.475204e+10 3.477973e+10
 [6] 2.867960e+10 2.052463e+10 1.993678e+10 1.986494e+10 1.979308e+10
[11] 2.642534e+12 2.640440e+12 2.642121e+12 2.643803e+12 2.645484e+12
[16] 2.598429e+12'

> READ_BRANK02_ACC$MVALTARX3C[45:60]
 [1]          NA          NA          NA -2147483648 -2147483648 -2147483648
 [7] -2147483648 -2147483648 -2147483648 -2147483648 -2147483648 -2147483648
[13] -2147483648 -2147483648 -2147483648 -2147483648

> BRANK02_ACC$MVALTARX3[45:60]
 [1]        NA        NA        NA   3519760   3519760   2898626   2070447
 [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
[15] 277428340 277428340
>

> READ_BRANK02_ACC$MVALTARX3[45:60]
 [1]        NA        NA        NA   3519760   3519760   2898626   2070447
 [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
[15] 277428340 277428340

Ideas anyone?

Thanks!

Jeff


Jeff Ranara, Ph.D. candidate
Natural Resource Management
Dept of Systems Ecology, and
Stockholm Resilience Center
Stockholm University
SE-106 91 Stockholm, Sweden
Visiting/delivery address: Kr?ftriket 9A
Tel: +46 (0)8 164252, +46 (0)73 7078874
www.stockholmresilience.org/ranara


From jeff at ecology.su.se  Mon Aug  8 12:31:29 2011
From: jeff at ecology.su.se (Jeff Ranara)
Date: Mon, 8 Aug 2011 12:31:29 +0200
Subject: [R-sig-Geo] problem in writing shapefiles with
	writePointsShape() - SKUMT!
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>	<CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
	<alpine.LRH.2.00.1108051425530.6822@reclus.nhh.no> 
Message-ID: <004401cc55b6$559b1f20$00d15d60$@su.se>

HI again,

An update:

Found two workarounds:

1. Dividing MVALTARX6C and MVALTARX3C by 10000 so they're around the same
order or magnitude as MVALTARX6 and MVALTARX3 respectively (both of which
got written fine). Works for me since I am working with relative rankings
and the division maintains the relative order.

2. Tried writing with writeOGR instead and it also worked! 

writeOGR(BRANK02_ACC, ".", "OGR_Sociotope_noBU_2003_BRNK02_AXC",
driver="ESRI Shapefile")


But still, the original problem is "skumt" (Swedish word meaning strange,
odd, queer)

Jeff

Jeff Ranara, Ph.D. candidate
Natural Resource Management
Dept of Systems Ecology, and
Stockholm Resilience Center
Stockholm University
SE-106 91 Stockholm, Sweden
Visiting/delivery address: Kr?ftriket 9A
Tel: +46 (0)8 164252, +46 (0)73 7078874
www.stockholmresilience.org/ranara





-----Original Message-----
From: Jeff Ranara [mailto:jeff.ranara at stockholmresilience.su.se] 
Sent: Monday, August 08, 2011 12:21 PM
To: 'r-sig-geo at r-project.org'
Subject: problem in writing shapefiles with writePointsShape()

Hi folks,

What am I missing here?  Am I using old routines? Missing some parameter?
Mixing up object types?  

Am under the gun and my time-limited attempts at troubleshooting have given
nada.  Am testing some workarounds in the meantime.  

Perhaps someone knows a quick answer? 

###The data of interest

#> typeof(MVALTARX6C)
#[1] "double"
#> str(MVALTARX6C)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX6C)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#1.38000e+07 5.33000e+12 2.68300e+13 3.65000e+14 1.42700e+14 2.37200e+16 
#       NA's 
#2.79119e+05 

#> typeof(MVALTARX6)
#[1] "double"
#> str(MVALTARX6)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX6)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#3.69600e+03 5.95600e+08 2.41200e+09 3.65300e+10 1.74800e+10 2.08200e+12 
#       NA's 
#2.79119e+05 
#>

#> typeof(MVALTARX3C)
#[1] "double"
#> str(MVALTARX3C)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX3C)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#1.29500e+07 5.33900e+11 1.90900e+12 1.14200e+13 9.17500e+12 4.88700e+15 
#       NA's 
#2.79119e+05

#> typeof(MVALTARX3)
#[1] "double"
#> str(MVALTARX3)
# num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
#> summary(MVALTARX3)
#       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
#3.69600e+03 6.80000e+07 2.56900e+08 1.09700e+09 1.14600e+09 4.28400e+11 
#       NA's 
#2.79119e+05

###WRITTEN TO A SHAPEFILE WITH THE FOLLOWING

new_df = cbind(BRNK01[1:13],
MRVALTARX6,MRVALTAX6C,MRVALTARX3,MRVALTAX3C,
RVALTARX6,RVALTARX6C,RVALTARX3,RVALTARX3C,
BRNK01[14:16], X1000M_6AX,TX1000M_6AX,G?nGAVST?n, 
MVALTARX6,MVALTARX6C,VALTARX6,VALTARX6C,
X300M_3AX,TX300M_3AX,
MVALTARX3,MVALTARX3C,VALTARX3,VALTARX3C,
BRNK01[17:66])

Typeof(BRNK01_SMPL25)

BRANK02_ACC = BRNK01_SMPL25
BRANK02_ACC at data = new_df

writePointsShape(BRANK02_ACC, "Sociotope_noBU_2003_BRNK02_AXC", factor2char
= TRUE, max_nchar=254)

### VALTARX6C and MVALTARX3C end up getting written to the shapefile
completely differently (see below). Both from inspection in ArcGIS and
reading 
#in the shapefile again.  VALTARX6 and MVALTARX3 get written fine.
VALTARX6C and MVALTARX3C are certainly larger values
##but well within the range of doubles

READ_BRANK02_ACC = readShapePoints("Sociotope_noBU_2003_BRNK02_AXC")


> BRANK02_ACC$MVALTARX6C[45:60]
 [1]           NA           NA           NA 2.005397e+12 1.513941e+12
 [6] 1.489291e+12 1.492141e+12 2.759250e+12 2.967822e+12 3.095638e+12
[11] 4.357538e+14 4.325040e+14 4.203615e+14 3.984211e+14 3.957644e+14
[16] 2.598429e+12

> READ_BRANK02_ACC$MVALTARX6C[45:60]
 [1] NA NA NA -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1

> BRANK02_ACC$MVALTARX6[45:60]
 [1]          NA          NA          NA   203110878   153213098   150521517
 [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
[13] 44138848859 41808450805 41503279631   277428340

> READ_BRANK02_ACC$MVALTARX6[45:60]
 [1]          NA          NA          NA   203110878   153213098   150521517
 [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
[13] 44138848859 41808450805 41503279631   277428340

> BRANK02_ACC$MVALTARX3C[45:60]
 [1]           NA           NA           NA 3.475204e+10 3.477973e+10
 [6] 2.867960e+10 2.052463e+10 1.993678e+10 1.986494e+10 1.979308e+10
[11] 2.642534e+12 2.640440e+12 2.642121e+12 2.643803e+12 2.645484e+12
[16] 2.598429e+12'

> READ_BRANK02_ACC$MVALTARX3C[45:60]
 [1]          NA          NA          NA -2147483648 -2147483648 -2147483648
 [7] -2147483648 -2147483648 -2147483648 -2147483648 -2147483648 -2147483648
[13] -2147483648 -2147483648 -2147483648 -2147483648

> BRANK02_ACC$MVALTARX3[45:60]
 [1]        NA        NA        NA   3519760   3519760   2898626   2070447
 [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
[15] 277428340 277428340
>

> READ_BRANK02_ACC$MVALTARX3[45:60]
 [1]        NA        NA        NA   3519760   3519760   2898626   2070447
 [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
[15] 277428340 277428340

Ideas anyone?

Thanks!

Jeff


Jeff Ranara, Ph.D. candidate
Natural Resource Management
Dept of Systems Ecology, and
Stockholm Resilience Center
Stockholm University
SE-106 91 Stockholm, Sweden
Visiting/delivery address: Kr?ftriket 9A
Tel: +46 (0)8 164252, +46 (0)73 7078874
www.stockholmresilience.org/ranara


From cam.plouffe at gmail.com  Mon Aug  8 17:29:58 2011
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Mon, 8 Aug 2011 11:29:58 -0400
Subject: [R-sig-Geo] Constructing Polygons using bboxes from
	SpatialPolygonsDataFrame
Message-ID: <CAAN3GgAOcABG0ynMLdbkvBShRoWEELONT-bwGxRNFbQ+MxvgAw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110808/1e1d387b/attachment.pl>

From Roger.Bivand at nhh.no  Mon Aug  8 17:56:34 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 8 Aug 2011 17:56:34 +0200 (CEST)
Subject: [R-sig-Geo] Constructing Polygons using bboxes from
 SpatialPolygonsDataFrame
In-Reply-To: <CAAN3GgAOcABG0ynMLdbkvBShRoWEELONT-bwGxRNFbQ+MxvgAw@mail.gmail.com>
References: <CAAN3GgAOcABG0ynMLdbkvBShRoWEELONT-bwGxRNFbQ+MxvgAw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108081744270.20358@reclus.nhh.no>

On Mon, 8 Aug 2011, Cam Plouffe wrote:

> Hi everyone,
>
> I'm trying to make a function that constructs rectangular polygons based on
> the bounding boxes of other polygons from a SpatialPolygonsDataFrame.  I am
> having a number of errors right now, which I am unsure how to fix.  My code
> is basically as follows:
>
> temp = bbox(spdf_u[1,])
> temp = matrix(temp, ncol = 2)
>
> mat = matrix(nrow = 5, ncol = 2)
> mat[1,1] = temp[1,1]
> mat[1,2] = temp[2,1]
> mat[2,1] = temp[1,1]
> mat[2,2] = temp[2,2]
> mat[3,1] = temp[1,2]
> mat[3,2] = temp[2,2]
> mat[4,1] = temp[1,2]
> mat[4,2] = temp[2,1]
> mat[5,1] = temp[1,1]
> mat[5,2] = temp[2,1]
> rm(temp)
>
> temppoly = Polygon(mat)
> polylist = list(temppoly)
> temppolys = Polygons(polylist)
>
> I'm first encountering an error after I have constructed the Polygon object
> "temppoly".  It seems to have no problems at first, but if I try to plot
> "temppoly", I get the following error:
>
> Error in as.double(y) :
>  cannot coerce type 'S4' to vector of type 'double'

There is not plot method for "Polygon" objects.

>
> I'm also encountering an error when attempting to construct the Polygons
> object "temppolys":
>
> Error in Polygons(polylist) : Single ID required
>

See ?Polygons, and ID is required.

You can re-use things which are already there, and benefit from the *apply 
vectorisation way of doing things (which is worth learning, as it makes 
it easier to do things repeatedly):

library(sp)
library(maptools)
xx <- readShapeSpatial(system.file("shapes/sids.shp",
   package="maptools")[1], IDvar="FIPSNO",
   proj4string=CRS("+proj=longlat +ellps=clrk66"))
# giving some data to play with
bb0 <- lapply(slot(xx, "polygons"), bbox)
# make a list of the bounding boxes of the Polygons objects in the 
# "polygons" slot of xx
bb0[[1]] # show first component
library(splancs)
bb1 <- lapply(bb0, bboxx)
# turn these into matrices using a helper function in splancs
bb1[[1]] # show first component
bb2 <- lapply(bb1, function(x) rbind(x, x[1,]))
# close the matrix rings by appending the first coordinate
bb2[[1]] # show first component
rn <- row.names(xx)
# get the IDs
bb3 <- vector(mode="list", length=length(bb2))
# make somewhere to keep the output
for (i in seq(along=bb3)) bb3[[i]] <- Polygons(list(Polygon(bb2[[i]])),
   ID=rn[i])
# loop over the closed matrix rings, adding the IDs
bb3[[1]] # show first component
bbs <- SpatialPolygons(bb3, proj4string=CRS(proj4string(xx)))
plot(bbs)
# make a "SpatialPolygons" object

You were almost there, thanks for a clear explanation.

Hope this helps,

Roger

> I'm very new to R, so these could be very simply problems, but I'm unable to
> find any reference material about these issues.  If anyone could offer me
> some insight as to why I'm having these errors, and perhaps how to get
> around them, it would be greatly appreciated.  If more code is needed, let
> me know and I'll provide it.
>
> Thanks a lot,
> Cam
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From cam.plouffe at gmail.com  Mon Aug  8 18:17:47 2011
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Mon, 8 Aug 2011 12:17:47 -0400
Subject: [R-sig-Geo] Constructing Polygons using bboxes from
	SpatialPolygonsDataFrame
In-Reply-To: <alpine.LRH.2.00.1108081744270.20358@reclus.nhh.no>
References: <CAAN3GgAOcABG0ynMLdbkvBShRoWEELONT-bwGxRNFbQ+MxvgAw@mail.gmail.com>
	<alpine.LRH.2.00.1108081744270.20358@reclus.nhh.no>
Message-ID: <CAAN3GgD8=VGDL_vuzVT9LG-P0v4L+r3tNo5eYH=T3EawjXOnrw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110808/362011aa/attachment.pl>

From Roger.Bivand at nhh.no  Mon Aug  8 20:44:32 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 8 Aug 2011 20:44:32 +0200 (CEST)
Subject: [R-sig-Geo] problem in writing shapefiles with
 writePointsShape() - SKUMT!
In-Reply-To: <004401cc55b6$559b1f20$00d15d60$@su.se>
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>
	<CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
	<alpine.LRH.2.00.1108051425530.6822@reclus.nhh.no> 
	<004401cc55b6$559b1f20$00d15d60$@su.se>
Message-ID: <alpine.LRH.2.00.1108082023280.21504@reclus.nhh.no>

On Mon, 8 Aug 2011, Jeff Ranara wrote:

> HI again,
>
> An update:
>
> Found two workarounds:
>
> 1. Dividing MVALTARX6C and MVALTARX3C by 10000 so they're around the same
> order or magnitude as MVALTARX6 and MVALTARX3 respectively (both of which
> got written fine). Works for me since I am working with relative rankings
> and the division maintains the relative order.
>
> 2. Tried writing with writeOGR instead and it also worked!
>
> writeOGR(BRANK02_ACC, ".", "OGR_Sociotope_noBU_2003_BRNK02_AXC",
> driver="ESRI Shapefile")
>
>
> But still, the original problem is "skumt" (Swedish word meaning strange,
> odd, queer)

No, just read ?write.dbf (in foreign). You find there that the 
representation "maxes" out at 19 characters, as in DBF specs. In this 
case, a negative scale is generated, which should not happen, but the 
limitation is documented.

So your heuristics are correct, either divide the too large variable by 
some orders of magnitude to allow it to be represented within 19 digits, 
including sign and decimal point, or use the OGR implementation, which 
permits a non-standard larger precision than 19. I'll add a link to 
?write.dbf on ?writeSpatialShape.

Roger

>
> Jeff
>
> Jeff Ranara, Ph.D. candidate
> Natural Resource Management
> Dept of Systems Ecology, and
> Stockholm Resilience Center
> Stockholm University
> SE-106 91 Stockholm, Sweden
> Visiting/delivery address: Kr?ftriket 9A
> Tel: +46 (0)8 164252, +46 (0)73 7078874
> www.stockholmresilience.org/ranara
>
>
>
>
>
> -----Original Message-----
> From: Jeff Ranara [mailto:jeff.ranara at stockholmresilience.su.se]
> Sent: Monday, August 08, 2011 12:21 PM
> To: 'r-sig-geo at r-project.org'
> Subject: problem in writing shapefiles with writePointsShape()
>
> Hi folks,
>
> What am I missing here?  Am I using old routines? Missing some parameter?
> Mixing up object types?
>
> Am under the gun and my time-limited attempts at troubleshooting have given
> nada.  Am testing some workarounds in the meantime.
>
> Perhaps someone knows a quick answer?
>
> ###The data of interest
>
> #> typeof(MVALTARX6C)
> #[1] "double"
> #> str(MVALTARX6C)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX6C)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #1.38000e+07 5.33000e+12 2.68300e+13 3.65000e+14 1.42700e+14 2.37200e+16
> #       NA's
> #2.79119e+05
>
> #> typeof(MVALTARX6)
> #[1] "double"
> #> str(MVALTARX6)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX6)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #3.69600e+03 5.95600e+08 2.41200e+09 3.65300e+10 1.74800e+10 2.08200e+12
> #       NA's
> #2.79119e+05
> #>
>
> #> typeof(MVALTARX3C)
> #[1] "double"
> #> str(MVALTARX3C)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX3C)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #1.29500e+07 5.33900e+11 1.90900e+12 1.14200e+13 9.17500e+12 4.88700e+15
> #       NA's
> #2.79119e+05
>
> #> typeof(MVALTARX3)
> #[1] "double"
> #> str(MVALTARX3)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX3)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #3.69600e+03 6.80000e+07 2.56900e+08 1.09700e+09 1.14600e+09 4.28400e+11
> #       NA's
> #2.79119e+05
>
> ###WRITTEN TO A SHAPEFILE WITH THE FOLLOWING
>
> new_df = cbind(BRNK01[1:13],
> MRVALTARX6,MRVALTAX6C,MRVALTARX3,MRVALTAX3C,
> RVALTARX6,RVALTARX6C,RVALTARX3,RVALTARX3C,
> BRNK01[14:16], X1000M_6AX,TX1000M_6AX,G?nGAVST?n,
> MVALTARX6,MVALTARX6C,VALTARX6,VALTARX6C,
> X300M_3AX,TX300M_3AX,
> MVALTARX3,MVALTARX3C,VALTARX3,VALTARX3C,
> BRNK01[17:66])
>
> Typeof(BRNK01_SMPL25)
>
> BRANK02_ACC = BRNK01_SMPL25
> BRANK02_ACC at data = new_df
>
> writePointsShape(BRANK02_ACC, "Sociotope_noBU_2003_BRNK02_AXC", factor2char
> = TRUE, max_nchar=254)
>
> ### VALTARX6C and MVALTARX3C end up getting written to the shapefile
> completely differently (see below). Both from inspection in ArcGIS and
> reading
> #in the shapefile again.  VALTARX6 and MVALTARX3 get written fine.
> VALTARX6C and MVALTARX3C are certainly larger values
> ##but well within the range of doubles
>
> READ_BRANK02_ACC = readShapePoints("Sociotope_noBU_2003_BRNK02_AXC")
>
>
>> BRANK02_ACC$MVALTARX6C[45:60]
> [1]           NA           NA           NA 2.005397e+12 1.513941e+12
> [6] 1.489291e+12 1.492141e+12 2.759250e+12 2.967822e+12 3.095638e+12
> [11] 4.357538e+14 4.325040e+14 4.203615e+14 3.984211e+14 3.957644e+14
> [16] 2.598429e+12
>
>> READ_BRANK02_ACC$MVALTARX6C[45:60]
> [1] NA NA NA -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
>
>> BRANK02_ACC$MVALTARX6[45:60]
> [1]          NA          NA          NA   203110878   153213098   150521517
> [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
> [13] 44138848859 41808450805 41503279631   277428340
>
>> READ_BRANK02_ACC$MVALTARX6[45:60]
> [1]          NA          NA          NA   203110878   153213098   150521517
> [7]   150521517   286549903   309324823   323817954 45747933230 45442762056
> [13] 44138848859 41808450805 41503279631   277428340
>
>> BRANK02_ACC$MVALTARX3C[45:60]
> [1]           NA           NA           NA 3.475204e+10 3.477973e+10
> [6] 2.867960e+10 2.052463e+10 1.993678e+10 1.986494e+10 1.979308e+10
> [11] 2.642534e+12 2.640440e+12 2.642121e+12 2.643803e+12 2.645484e+12
> [16] 2.598429e+12'
>
>> READ_BRANK02_ACC$MVALTARX3C[45:60]
> [1]          NA          NA          NA -2147483648 -2147483648 -2147483648
> [7] -2147483648 -2147483648 -2147483648 -2147483648 -2147483648 -2147483648
> [13] -2147483648 -2147483648 -2147483648 -2147483648
>
>> BRANK02_ACC$MVALTARX3[45:60]
> [1]        NA        NA        NA   3519760   3519760   2898626   2070447
> [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
> [15] 277428340 277428340
>>
>
>> READ_BRANK02_ACC$MVALTARX3[45:60]
> [1]        NA        NA        NA   3519760   3519760   2898626   2070447
> [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
> [15] 277428340 277428340
>
> Ideas anyone?
>
> Thanks!
>
> Jeff
>
>
> Jeff Ranara, Ph.D. candidate
> Natural Resource Management
> Dept of Systems Ecology, and
> Stockholm Resilience Center
> Stockholm University
> SE-106 91 Stockholm, Sweden
> Visiting/delivery address: Kr?ftriket 9A
> Tel: +46 (0)8 164252, +46 (0)73 7078874
> www.stockholmresilience.org/ranara
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From smaxwell at ucsc.edu  Tue Aug  9 00:07:09 2011
From: smaxwell at ucsc.edu (Sara Maxwell)
Date: Mon, 8 Aug 2011 15:07:09 -0700
Subject: [R-sig-Geo] extracting and manipulating a RasterStack
Message-ID: <EA4EC745-A1B8-4CAC-960B-C4FCDCC8A67D@ucsc.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110808/068adab0/attachment.pl>

From lestes at princeton.edu  Tue Aug  9 05:30:01 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Mon, 8 Aug 2011 23:30:01 -0400
Subject: [R-sig-Geo] extracting and manipulating a RasterStack
In-Reply-To: <EA4EC745-A1B8-4CAC-960B-C4FCDCC8A67D@ucsc.edu>
References: <EA4EC745-A1B8-4CAC-960B-C4FCDCC8A67D@ucsc.edu>
Message-ID: <CALuVVaYjYDmCJBQTHRwXLLYNM6a5V0GpVEyZD7cxDd3K0D0qDA@mail.gmail.com>

Hi Sara,

The following is slightly different from what you are trying to do,
but should give you an area value for cells of a given value, without
having to stack your rasters:

r <- raster(ncol = 10, nrow = 10)
res(r) <- 10  # Giving it a square grid cell, which remakes raster
into 18 rows & 36 columns
r[] <- 1:ncell(r)
plot(r)
z <- ((r == 50) | (r == 75)) * 1 # Binary raster
plot(z)
# The following would give you area in hectares for the selected cells,
# assuming that your actual raster is projected in units of meters
# (e.g. UTM, Albers) unlike the dummy raster here

(sum(getValues(z)) * res(r)[1]^2) / 10000
[1] 0.02

I hope that is somewhat on the mark.

Interestingly, I get the following error when I try to use area:

> t <- area(r)
# Error in b - a : 'b' is missing

Cheers, Lyndon



On Mon, Aug 8, 2011 at 6:07 PM, Sara Maxwell <smaxwell at ucsc.edu> wrote:
> I have been struggling with something seemingly straightforward for several days now, and am hoping for some assistance.
>
> I have calculated the area for cells within a raster, and now want to extract the area for specific cells and sum the area of those cells together. ?I have tried a number of functions such as stackSelect, but think I have had trouble using the proper syntax in my logical statements. I am new to the raster package, however, so this may be my issue.
>
> For example, if I have data that looks like this:
>
> require(raster)
>
> r <- raster(ncol=10, nrow=10)
> r[]=1:ncell(r)
> t <- area(r)
> s <- stack(r, t)
>
> for all values in first layer of s (equivalent to the raster r) with the values 50 and 75, I want to take the corresponding values in the second layer (equivalent to t), create a new raster (call it 'z') where the remaining cells are given a value of 0 (or NA) and finally sum the values of the z.
>
> Any suggestions appreciated.
> Thank you,
> Sara
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jeff at ecology.su.se  Tue Aug  9 07:39:00 2011
From: jeff at ecology.su.se (Jeff Ranara)
Date: Tue, 9 Aug 2011 07:39:00 +0200
Subject: [R-sig-Geo] problem in writing shapefiles with
	writePointsShape() - SKUMT!
In-Reply-To: <alpine.LRH.2.00.1108082023280.21504@reclus.nhh.no>
References: <mailman.3413.1312486248.4468.r-sig-geo@r-project.org>
	<CAP8THHVOMPLCVGnE_pteN-QTChYubocZb8v05dAnfPVw2zpzYA@mail.gmail.com>
	<CAGhLh6FziKiyDQXht8R2TiF8U577iAjg+T59-kUiOJVK1xYxKw@mail.gmail.com>
	<alpine.LRH.2.00.1108051425530.6822@reclus.nhh.no>
	<004401cc55b6$559b1f20$00d15d60$@su.se>
	<alpine.LRH.2.00.1108082023280.21504@reclus.nhh.no>
Message-ID: <000001cc5656$a4853030$ed8f9090$@su.se>


Thanks Roger


-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Monday, August 08, 2011 8:45 PM
To: Jeff Ranara
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] problem in writing shapefiles with
writePointsShape() - SKUMT!

On Mon, 8 Aug 2011, Jeff Ranara wrote:

> HI again,
>
> An update:
>
> Found two workarounds:
>
> 1. Dividing MVALTARX6C and MVALTARX3C by 10000 so they're around the same
> order or magnitude as MVALTARX6 and MVALTARX3 respectively (both of which
> got written fine). Works for me since I am working with relative rankings
> and the division maintains the relative order.
>
> 2. Tried writing with writeOGR instead and it also worked!
>
> writeOGR(BRANK02_ACC, ".", "OGR_Sociotope_noBU_2003_BRNK02_AXC",
> driver="ESRI Shapefile")
>
>
> But still, the original problem is "skumt" (Swedish word meaning strange,
> odd, queer)

No, just read ?write.dbf (in foreign). You find there that the 
representation "maxes" out at 19 characters, as in DBF specs. In this 
case, a negative scale is generated, which should not happen, but the 
limitation is documented.

So your heuristics are correct, either divide the too large variable by 
some orders of magnitude to allow it to be represented within 19 digits, 
including sign and decimal point, or use the OGR implementation, which 
permits a non-standard larger precision than 19. I'll add a link to 
?write.dbf on ?writeSpatialShape.

Roger

>
> Jeff
>
> Jeff Ranara, Ph.D. candidate
> Natural Resource Management
> Dept of Systems Ecology, and
> Stockholm Resilience Center
> Stockholm University
> SE-106 91 Stockholm, Sweden
> Visiting/delivery address: Kr?ftriket 9A
> Tel: +46 (0)8 164252, +46 (0)73 7078874
> www.stockholmresilience.org/ranara
>
>
>
>
>
> -----Original Message-----
> From: Jeff Ranara [mailto:jeff.ranara at stockholmresilience.su.se]
> Sent: Monday, August 08, 2011 12:21 PM
> To: 'r-sig-geo at r-project.org'
> Subject: problem in writing shapefiles with writePointsShape()
>
> Hi folks,
>
> What am I missing here?  Am I using old routines? Missing some parameter?
> Mixing up object types?
>
> Am under the gun and my time-limited attempts at troubleshooting have
given
> nada.  Am testing some workarounds in the meantime.
>
> Perhaps someone knows a quick answer?
>
> ###The data of interest
>
> #> typeof(MVALTARX6C)
> #[1] "double"
> #> str(MVALTARX6C)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX6C)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #1.38000e+07 5.33000e+12 2.68300e+13 3.65000e+14 1.42700e+14 2.37200e+16
> #       NA's
> #2.79119e+05
>
> #> typeof(MVALTARX6)
> #[1] "double"
> #> str(MVALTARX6)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX6)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #3.69600e+03 5.95600e+08 2.41200e+09 3.65300e+10 1.74800e+10 2.08200e+12
> #       NA's
> #2.79119e+05
> #>
>
> #> typeof(MVALTARX3C)
> #[1] "double"
> #> str(MVALTARX3C)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX3C)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #1.29500e+07 5.33900e+11 1.90900e+12 1.14200e+13 9.17500e+12 4.88700e+15
> #       NA's
> #2.79119e+05
>
> #> typeof(MVALTARX3)
> #[1] "double"
> #> str(MVALTARX3)
> # num [1:380000] NA NA NA NA NA NA NA NA NA NA ...
> #> summary(MVALTARX3)
> #       Min.     1st Qu.      Median        Mean     3rd Qu.        Max.
> #3.69600e+03 6.80000e+07 2.56900e+08 1.09700e+09 1.14600e+09 4.28400e+11
> #       NA's
> #2.79119e+05
>
> ###WRITTEN TO A SHAPEFILE WITH THE FOLLOWING
>
> new_df = cbind(BRNK01[1:13],
> MRVALTARX6,MRVALTAX6C,MRVALTARX3,MRVALTAX3C,
> RVALTARX6,RVALTARX6C,RVALTARX3,RVALTARX3C,
> BRNK01[14:16], X1000M_6AX,TX1000M_6AX,G?nGAVST?n,
> MVALTARX6,MVALTARX6C,VALTARX6,VALTARX6C,
> X300M_3AX,TX300M_3AX,
> MVALTARX3,MVALTARX3C,VALTARX3,VALTARX3C,
> BRNK01[17:66])
>
> Typeof(BRNK01_SMPL25)
>
> BRANK02_ACC = BRNK01_SMPL25
> BRANK02_ACC at data = new_df
>
> writePointsShape(BRANK02_ACC, "Sociotope_noBU_2003_BRNK02_AXC",
factor2char
> = TRUE, max_nchar=254)
>
> ### VALTARX6C and MVALTARX3C end up getting written to the shapefile
> completely differently (see below). Both from inspection in ArcGIS and
> reading
> #in the shapefile again.  VALTARX6 and MVALTARX3 get written fine.
> VALTARX6C and MVALTARX3C are certainly larger values
> ##but well within the range of doubles
>
> READ_BRANK02_ACC = readShapePoints("Sociotope_noBU_2003_BRNK02_AXC")
>
>
>> BRANK02_ACC$MVALTARX6C[45:60]
> [1]           NA           NA           NA 2.005397e+12 1.513941e+12
> [6] 1.489291e+12 1.492141e+12 2.759250e+12 2.967822e+12 3.095638e+12
> [11] 4.357538e+14 4.325040e+14 4.203615e+14 3.984211e+14 3.957644e+14
> [16] 2.598429e+12
>
>> READ_BRANK02_ACC$MVALTARX6C[45:60]
> [1] NA NA NA -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
>
>> BRANK02_ACC$MVALTARX6[45:60]
> [1]          NA          NA          NA   203110878   153213098
150521517
> [7]   150521517   286549903   309324823   323817954 45747933230
45442762056
> [13] 44138848859 41808450805 41503279631   277428340
>
>> READ_BRANK02_ACC$MVALTARX6[45:60]
> [1]          NA          NA          NA   203110878   153213098
150521517
> [7]   150521517   286549903   309324823   323817954 45747933230
45442762056
> [13] 44138848859 41808450805 41503279631   277428340
>
>> BRANK02_ACC$MVALTARX3C[45:60]
> [1]           NA           NA           NA 3.475204e+10 3.477973e+10
> [6] 2.867960e+10 2.052463e+10 1.993678e+10 1.986494e+10 1.979308e+10
> [11] 2.642534e+12 2.640440e+12 2.642121e+12 2.643803e+12 2.645484e+12
> [16] 2.598429e+12'
>
>> READ_BRANK02_ACC$MVALTARX3C[45:60]
> [1]          NA          NA          NA -2147483648 -2147483648
-2147483648
> [7] -2147483648 -2147483648 -2147483648 -2147483648 -2147483648
-2147483648
> [13] -2147483648 -2147483648 -2147483648 -2147483648
>
>> BRANK02_ACC$MVALTARX3[45:60]
> [1]        NA        NA        NA   3519760   3519760   2898626   2070447
> [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
> [15] 277428340 277428340
>>
>
>> READ_BRANK02_ACC$MVALTARX3[45:60]
> [1]        NA        NA        NA   3519760   3519760   2898626   2070447
> [8]   2070447   2070447   2070447 277428340 277428340 277428340 277428340
> [15] 277428340 277428340
>
> Ideas anyone?
>
> Thanks!
>
> Jeff
>
>
> Jeff Ranara, Ph.D. candidate
> Natural Resource Management
> Dept of Systems Ecology, and
> Stockholm Resilience Center
> Stockholm University
> SE-106 91 Stockholm, Sweden
> Visiting/delivery address: Kr?ftriket 9A
> Tel: +46 (0)8 164252, +46 (0)73 7078874
> www.stockholmresilience.org/ranara
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From momadou at yahoo.fr  Tue Aug  9 14:38:41 2011
From: momadou at yahoo.fr (Komine)
Date: Tue, 9 Aug 2011 05:38:41 -0700 (PDT)
Subject: [R-sig-Geo] Problem to run a loop
Message-ID: <1312893521629-6667926.post@n2.nabble.com>

Hi, 
I have a problem to run a loop to extract pixel values. The name of my
folder is: Image_Band_LST_2010. Names of images: LSR_279; LST_280; LST_281;
etc.
The extension of the image is (.tif)
I use this code:
 
library(raster)
a <- NULL
Result <- matrix(0,nrow=3,ncol=49)
for(i in 279:327){
a <- raster(paste("C:\\Users\\DISC D\\Image_Band_LST_2010\\LST_",i,sep=""))
Result[1,i-278] <- extract(a, cbind(516689.3630,1689862.3777)) # plot 1
Result[2,i-278] <- extract(a, cbind(452689.3630,1536862.3777)) # plot 2
Result[3,i-278] <- extract(a, cbind(512689.3630,1415862.3777)) # plot 3
} 

The result is: 
Erreur dans .rasterObjectFromFile(x, band = band, objecttype =
"RasterLayer",  : 
  file: C:\Users\DISC D\Image_Band_LST_2010\LST_279 does not exist
  
To solve the problem: I indicated the extension of images for instance:  
a <- raster(paste("C:\\Users\\DISC
D\\Image_Band_LST_2010\\LST_.tif",i,sep=""))

But the result is always bad. 
Can you help me to solve this ptroblem

Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-to-run-a-loop-tp6667926p6667926.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vetter at pik-potsdam.de  Tue Aug  9 14:56:50 2011
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Tue, 09 Aug 2011 14:56:50 +0200
Subject: [R-sig-Geo] Problem to run a loop
In-Reply-To: <1312893521629-6667926.post@n2.nabble.com>
References: <1312893521629-6667926.post@n2.nabble.com>
Message-ID: <4E412E92.4010806@pik-potsdam.de>

Try "/" instead of "\":

C:/Users/DISC D/Image_Band_LST_2010/

Tobias
> Hi,
> I have a problem to run a loop to extract pixel values. The name of my
> folder is: Image_Band_LST_2010. Names of images: LSR_279; LST_280; LST_281;
> etc.
> The extension of the image is (.tif)
> I use this code:
>
> library(raster)
> a<- NULL
> Result<- matrix(0,nrow=3,ncol=49)
> for(i in 279:327){
> a<- raster(paste("C:\\Users\\DISC D\\Image_Band_LST_2010\\LST_",i,sep=""))
> Result[1,i-278]<- extract(a, cbind(516689.3630,1689862.3777)) # plot 1
> Result[2,i-278]<- extract(a, cbind(452689.3630,1536862.3777)) # plot 2
> Result[3,i-278]<- extract(a, cbind(512689.3630,1415862.3777)) # plot 3
> }
>
> The result is:
> Erreur dans .rasterObjectFromFile(x, band = band, objecttype =
> "RasterLayer",  :
>    file: C:\Users\DISC D\Image_Band_LST_2010\LST_279 does not exist
>
> To solve the problem: I indicated the extension of images for instance:
> a<- raster(paste("C:\\Users\\DISC
> D\\Image_Band_LST_2010\\LST_.tif",i,sep=""))
>
> But the result is always bad.
> Can you help me to solve this ptroblem
>
> Komine
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-to-run-a-loop-tp6667926p6667926.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vetter at pik-potsdam.de  Tue Aug  9 15:02:15 2011
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Tue, 09 Aug 2011 15:02:15 +0200
Subject: [R-sig-Geo] Problem to run a loop
In-Reply-To: <1312893521629-6667926.post@n2.nabble.com>
References: <1312893521629-6667926.post@n2.nabble.com>
Message-ID: <4E412FD7.7020308@pik-potsdam.de>

Sorry, but forget what I wrote before.
Tobias
> Hi,
> I have a problem to run a loop to extract pixel values. The name of my
> folder is: Image_Band_LST_2010. Names of images: LSR_279; LST_280; LST_281;
> etc.
> The extension of the image is (.tif)
> I use this code:
>
> library(raster)
> a<- NULL
> Result<- matrix(0,nrow=3,ncol=49)
> for(i in 279:327){
> a<- raster(paste("C:\\Users\\DISC D\\Image_Band_LST_2010\\LST_",i,sep=""))
> Result[1,i-278]<- extract(a, cbind(516689.3630,1689862.3777)) # plot 1
> Result[2,i-278]<- extract(a, cbind(452689.3630,1536862.3777)) # plot 2
> Result[3,i-278]<- extract(a, cbind(512689.3630,1415862.3777)) # plot 3
> }
>
> The result is:
> Erreur dans .rasterObjectFromFile(x, band = band, objecttype =
> "RasterLayer",  :
>    file: C:\Users\DISC D\Image_Band_LST_2010\LST_279 does not exist
>
> To solve the problem: I indicated the extension of images for instance:
> a<- raster(paste("C:\\Users\\DISC
> D\\Image_Band_LST_2010\\LST_.tif",i,sep=""))
>
> But the result is always bad.
> Can you help me to solve this ptroblem
>
> Komine
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-to-run-a-loop-tp6667926p6667926.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dicko.ahmadou at gmail.com  Tue Aug  9 15:17:24 2011
From: dicko.ahmadou at gmail.com (ahmadou dicko)
Date: Tue, 9 Aug 2011 13:17:24 +0000
Subject: [R-sig-Geo] Problem to run a loop
In-Reply-To: <1312893521629-6667926.post@n2.nabble.com>
References: <1312893521629-6667926.post@n2.nabble.com>
Message-ID: <CAP8THHWfNZfYZSOnuUVqJAkbyJyzronKTv7tdfZoOx1zkwsstw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110809/81b3c2d9/attachment.pl>

From s.chamaille at yahoo.fr  Tue Aug  9 16:15:57 2011
From: s.chamaille at yahoo.fr (=?iso-8859-1?Q?Simon_Chamaill=E9?=)
Date: Tue, 9 Aug 2011 15:15:57 +0100 (BST)
Subject: [R-sig-Geo] convert Raster object to bigmatrix object
Message-ID: <1312899357.86634.YahooMailRC@web29309.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110809/5b566395/attachment.pl>

From momadou at yahoo.fr  Tue Aug  9 16:44:02 2011
From: momadou at yahoo.fr (Komine)
Date: Tue, 9 Aug 2011 07:44:02 -0700 (PDT)
Subject: [R-sig-Geo] Problem to run a loop
In-Reply-To: <1312893521629-6667926.post@n2.nabble.com>
References: <1312893521629-6667926.post@n2.nabble.com>
Message-ID: <1312901042615-6668392.post@n2.nabble.com>

Thank you very much for your help. I solved the problem about the loop with
indications of Cheers florian. 
However, before results were showed, I had 49 rows ( equal to the number of
files) indicating: Fixing "AREA_OR_POINT=Point" georeference
What this file mean? 

Thank you in advance 
Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-to-run-a-loop-tp6667926p6668392.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From yiyiwang.ut at gmail.com  Tue Aug  9 18:34:52 2011
From: yiyiwang.ut at gmail.com (Aquarius)
Date: Tue, 9 Aug 2011 09:34:52 -0700 (PDT)
Subject: [R-sig-Geo] [SpatialFiltering] constant std error for eigenvectors
 in the linear model
Message-ID: <1312907692321-6668793.post@n2.nabble.com>

Hi y'all,

I did a simple Spatial Filtering OLS model on land value with explanatory
variables: distance to CBD, slope, and other covaraites. The line of code is
copied below:

results= SpatialFiltering(LandValue_08 ~
Dist2CBD05+distfwy+distmaj+distmin+Slope+periarea, data=lu2,
nb=tmp$neighbours, style="W", ExactEV=TRUE, zero.policy=TRUE)

Then I used the selected 12 eigenvectors in the linear model:

results1=lm(LandValue_08 ~
Dist2CBD05+distfwy+distmaj+distmin+Slope+periarea+fitted(results),
data=lu2);

However, the std. error for the 12 eigenvectors (which serve as "synthetic
variables") are constant with value 9.254, as shown below:

 	Estimate	Stdev	T-Stats	Pr(>|t|)
Constant	24.09	0.799	30.158	< 2e-16
DistCBD	-1.747	0.104	-16.84	< 2e-16
DistFwy	2.221	0.229	9.696	< 2e-16
DistMaj	2.051	0.776	2.642	0.00846
DistMin	-0.8192	0.347	-2.359	0.01866
Slope	-0.2761	0.136	-2.037	0.04209
vec5	-176.8	9.254	-19.1	< 2e-16
vec3	-58.99	9.254	-6.374	3.86E-10
vec4	-53.27	9.254	-5.756	1.42E-08
vec2	49.86	9.254	5.387	1.06E-07
vec14	37.54	9.254	4.057	5.68E-05
vec31	37.50	9.254	4.052	5.79E-05
vec48	38.77	9.254	4.189	3.25E-05
vec57	34.17	9.254	3.692	0.00024
vec19	26.24	9.254	2.836	0.00474
vec33	26.92	9.254	2.909	0.00377
vec61	-32.43	9.254	-3.504	0.00049
vec6	21.04	9.254	2.274	0.02335
vec7	20.49	9.254	2.214	0.02724
vec16	20.90	9.254	2.258	0.02431
vec15	20.48	9.254	2.213	0.02728
vec46	23.87	9.254	2.579	0.01016
vec23	20.47	9.254	2.212	0.02734
vec40	-22.29	9.254	-2.409	0.01634
vec75	28.06	9.254	3.032	0.00254
vec18	18.81	9.254	2.032	0.04259
vec39	20.71	9.254	2.238	0.02561
vec84	28.32	9.254	3.06	0.00232
vec66	-23.46	9.254	-2.535	0.01153
vec86	26.56	9.254	2.87	0.00426
vec92	25.73	9.254	2.78	0.00562
vec12	15.40	9.254	1.664	0.09666


What is the cause for the constant std error?

Thanks a million in advance :)

Yiyi

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/SpatialFiltering-constant-std-error-for-eigenvectors-in-the-linear-model-tp6668793p6668793.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From afischbach at usgs.gov  Tue Aug  9 20:03:56 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Tue, 9 Aug 2011 11:03:56 -0700 (PDT)
Subject: [R-sig-Geo] Walruses and adehabitatHR: class estUDm exclusion
 of non-habitat pixels and summary over all animals
In-Reply-To: <4E0AD902.30108@oncfs.gouv.fr>
References: <1308601895714-6497315.post@n2.nabble.com>
	<4E0AD902.30108@oncfs.gouv.fr>
Message-ID: <1312913036614-6669114.post@n2.nabble.com>

Dear Clement, 

Thank you so much for your elegant reply.
Your code worked well with my walrus data.

To complete the analysis I wish to extract kernel density contours for each
animal
and over all animals in the study.

Is there a means to convert the SpatialPixelDataFrame back into an estUDm?
Is there a means to extract a single set of contours across animals within
the estUDm?

Best Regards, 
Anthony

(My apologies, but the first question above is essentially the same as that
posed by Andrew on 2 August
[http://r-sig-geo.2731867.n2.nabble.com/conversion-of-ascii-grid-or-SpatialPixelsDataFrame-to-adehabitatHR-estUD-class-tp6645600p6645600.html])

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6669114.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From dan.putler at sauder.ubc.ca  Tue Aug  9 22:23:37 2011
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Tue, 9 Aug 2011 13:23:37 -0700
Subject: [R-sig-Geo] A one to many merge involving a spatial data frame
	object
Message-ID: <4E419749.5040002@sauder.ubc.ca>

All,

I'm working with the 2010 TIGER/Line shapefile road data, and I'm 
dealing with alternative road names for the same road segment. There are 
two relevant files in the TIGER collection, the first is the road edge 
shapefile, which has a unique record (and geometry) for each road 
segment. The other is a featnames dbf file which can have multiple 
records for the same road segment (but an ID that identifies the road 
segment). One of the reasons this second file was created was to deal 
with situations where a portion of a road is known by two or more 
different names (for example, Hwy 50 and Main Street). My goal is to 
create a SpatialLinesDataFrame object that contains the unique road 
segment / road name combinations, which will result in a set of line 
geometries that are not unique. I've looked at the spCbind methods, but 
my reading of the documentation suggests it will not address this case 
directly since the feature IDs would not be unique.

I can create a new SpatialLinesDataFrame that has a row for each 
possible unique road segment and road name combination, and I can then 
use spCbind to attach the needed attribute information to this object. 
Unfortunately, the way I can think of creating the SpatialLinesDataFrame 
object is a great example of what *not* to do in S language programming, 
specifically, use a for-loop to "grow" a data frame like object using 
rbind. Below is a snippet of my present code:

   geom1 <- readOGR(dsn=roads_dsn, layer=roads_layer)
   geom1 <- geom1[, "TLID"]
   # Let the nastiness begin. Time to build-up the needed geometries
   geom <- spChFIDs(geom1[geom1$TLID == roadsf$TLID[1],], "1")
   for(i in 2:nrow(roadsf)) {
     new_geom <- spChFIDs(geom1[geom1$TLID == roadsf$TLID[i],], 
as.character(i))
     geom <- rbind(geom, new_geom)
   }

In the code, the data frame "roadsf" contains the attribute data for 
each unique road segment / road name pair, and the variable TLID is the 
unique ID for the road segment geometries. This works, but it is really 
slow (it is CPU bound, but not I/O bound). My question is have I missed 
an easier solution? If I haven't, how could I go about doing this more 
cleverly? Given the need to alter the feature IDs, I don't see a nice 
way to use one the apply family of functions. Alternatively, is this 
just something that is better suited to the use of a spatial database 
tool like PostGIS or SpatiaLite? I can guess the query looks like: 
SELECT * FROM table1 AS a, the_geom FROM table2 AS b WHERE a.id = b.id

Dan


From greenberg at ucdavis.edu  Wed Aug 10 00:51:05 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Tue, 9 Aug 2011 15:51:05 -0700
Subject: [R-sig-Geo] SpatialPolygons to SpatialLines?
Message-ID: <CABG0rfvr5at-t9ktYmNYKbEMvBKoG5Y1e6X9ioDDRe0D7Da-7Q@mail.gmail.com>

R-sig-geo'ers:

Is there a quick way to create a line object from a polygon object
(representing the boundary)?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From lestes at princeton.edu  Wed Aug 10 02:10:15 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Tue, 9 Aug 2011 20:10:15 -0400
Subject: [R-sig-Geo] SpatialPolygons to SpatialLines?
In-Reply-To: <CABG0rfvr5at-t9ktYmNYKbEMvBKoG5Y1e6X9ioDDRe0D7Da-7Q@mail.gmail.com>
References: <CABG0rfvr5at-t9ktYmNYKbEMvBKoG5Y1e6X9ioDDRe0D7Da-7Q@mail.gmail.com>
Message-ID: <CALuVVaZ=q5unwA2vacxFaWOz-FNwJ2TXZZq7kGXbpY0dCu4rVg@mail.gmail.com>

Hi Jonathan,

You can do this as follows:

x <- yourSpatialPolygons
xl <- as(x, "SpatialLines")

e.g.

library(maptools)
library(rgdal)
nc <- readShapePoly(system.file("shapes/sids.shp",
package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
quartz()
plot(nc[1, ], col = "blue")
nc1l <- as(nc[1, ], "SpatialLines")
plot(nc1l, col = "blue")


Cheers, Lyndon



On Tue, Aug 9, 2011 at 6:51 PM, Jonathan Greenberg
<greenberg at ucdavis.edu> wrote:
> R-sig-geo'ers:
>
> Is there a quick way to create a line object from a polygon object
> (representing the boundary)?
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Wed Aug 10 21:11:44 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 10 Aug 2011 12:11:44 -0700
Subject: [R-sig-Geo] convert Raster object to bigmatrix object
In-Reply-To: <1312899357.86634.YahooMailRC@web29309.mail.ird.yahoo.com>
References: <1312899357.86634.YahooMailRC@web29309.mail.ird.yahoo.com>
Message-ID: <CANtt_hy2ZLs82T0qd-+OM_bUR+FKuyPMfn5kZJdJ+fZhfb5J2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110810/a768a54b/attachment.pl>

From rlmanzione at gmail.com  Wed Aug 10 21:49:42 2011
From: rlmanzione at gmail.com (Rodrigo Lilla Manzione)
Date: Wed, 10 Aug 2011 16:49:42 -0300
Subject: [R-sig-Geo] =?iso-8859-1?q?Accuracy_2012_-_First_Call_for_Papers_?=
	=?iso-8859-1?q?-_July_10-13=2C_2012=2C_Florian=F3polis=2C_SC_-_Bra?=
	=?iso-8859-1?q?zil?=
In-Reply-To: <CAE2kf_62fFfFBAXUscg3boQxWhuZC=00G5KNDBCjOqmvk5qeDw@mail.gmail.com>
References: <2E6831F1B7C2448B835482FF632064C3@DOC06>
	<CAE2kf_62fFfFBAXUscg3boQxWhuZC=00G5KNDBCjOqmvk5qeDw@mail.gmail.com>
Message-ID: <CABf+oy6xYSqPJbP-SPtd7YHWMB-=HDjn-gSOc1F-q7LsKB6Ejg@mail.gmail.com>

ACCURACY 2012
International Spatial Accuracy Research Association (ISARA)
The Tenth International Symposium on Spatial Accuracy Assessment in
Natural Resources and Environmental Sciences
July 10-13, 2012
Florian?polis, SC - Brazil

http://2012.spatial-accuracy.org/

TOPICS: All topics concerned with spatial accuracy and uncertainty in a
natural resources and environmental sciences context are appropriate,
for example:

* Semantic uncertainty and vagueness
* Modelling uncertainty using geostatistics
* Propagation of uncertainty in GIS
* Visualizing spatial uncertainty
* Uncertainty in Remote Sensing
* Spatio-temporal uncertainty
* Accuracy and uncertainty of DEMs
* Modelling scale in environmental systems
* Positional uncertainty

PUBLICATION: We welcome the submission of both oral papers and posters.
For both modes of presentation authors are invited to submit abstracts
of no more than 500 words in English on original research.Those
accepted will be presented as oral papers/posters at the symposium and
published as short papers in the symposium proceedings (ISBN listed).
All accepted authors will also be
invited to submit a full paper for consideration towards an special
issue of an international journal.

MODES OF PARTICIPATION: Oral papers and posters. Pre-conference
workshop proposals also welcome.

DEADLINES:

Abstract submission:? December 9th, 2011

Abstract acceptance notification: March 1st, 2012

Short final paper submission: May 11th, 2012

Workshop proposals: October 18th, 2011

Workshop acceptance notification: October 31st, 2011

It is important to mention that this will be the first time the
Spatial Accuracy Group co-organizes a conference with The Commission
on Modelling Geographical System of the International Geographical
Union (IGU-CMGS) on the research area of common interest.

Carlos A. O. Vieira and Francisco Henrique de Oliveira (co-Chairs)
Mariane Dal Santo (Secretary)

Contact: accuracy2012 at cfh.ufsc.br
****************************************
Download a pdf of the full call for papers at:
http://www.accuracy2012.ufsc.br/files/2011/07/Accuracy2012_Flyer.jpg



PS: Sorry for e-mail list crossed.

-- 
Prof. Carlos Antonio Oliveira  Vieira
Departamento de Geoci?ncias ? CFH/UFSC
Trindade - Florian?polis - SC -  Brasil
CEP 88040-900 Cx. Postal 476
Fone: ++55(48)3721-8593   Cel: (48)9915-3653
E-mails: 	carlos.vieira at ufv.br
		carlos.vieira at ufsc.br

Visite o site: www.accuracy2012.ufsc.br


From greenberg at ucdavis.edu  Thu Aug 11 05:39:54 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed, 10 Aug 2011 20:39:54 -0700
Subject: [R-sig-Geo] Merging a list of SpatialPointsDataFrame objects
Message-ID: <CABG0rfv_m-E2_p4kpz-Mh5ZwK9QxRaqL4QrMOvPTYvdeuA45bw@mail.gmail.com>

I used a mapply() statement to create a list of SpatialPointsDataFrame
objects -- each of the list entries is a SpatialPointsDataFrame
object, and each SpatialPointsDataFrame object has the identical @data
*names* (e.g. the dataframe is rbindable for all of the objects).
What I'm wondering is if there is an efficient way to merge all of
these into a single SpatialPointsDataFrame object -- I can (I suppose)
do an rbind or spRbind, but it seems like I'd have to loop through the
list entry one at a time, appending each successive
SpatialPointsDataFrame object into the growing "mega"
SpatialPointsDataFrame.  Is there a cleaner/faster way to do this in
R?  Thanks!

Here's an example using the built in data/examples:

require(sp)
data(meuse) # reload data.frame
coordinates(meuse) = c("x", "y") # specify column names

meuse1=meuse[1:10,]
meuse2=meuse[11:20,]
meuse3=meuse[21:50,]
meuse_list=list(meuse1,meuse2,meuse3)

# Brute Force way:
for(i in 1:length(meuse_list))
{
	if(i==1)
	{
		meuse_merged=meuse_list[[i]]
	} else
	{
		meuse_merged=rbind(meuse_merged,meuse_list[[i]])
	}	
}



--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From mdsumner at gmail.com  Thu Aug 11 05:51:25 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 11 Aug 2011 13:51:25 +1000
Subject: [R-sig-Geo] Merging a list of SpatialPointsDataFrame objects
In-Reply-To: <CABG0rfv_m-E2_p4kpz-Mh5ZwK9QxRaqL4QrMOvPTYvdeuA45bw@mail.gmail.com>
References: <CABG0rfv_m-E2_p4kpz-Mh5ZwK9QxRaqL4QrMOvPTYvdeuA45bw@mail.gmail.com>
Message-ID: <CAAcGz9-DDVHE_doP5-mwgLmL-95uZNUaxExRaeinuqcJT_+oRA@mail.gmail.com>

This is what do.call is for:

 do.call("rbind", meuse_list)




On Thu, Aug 11, 2011 at 1:39 PM, Jonathan Greenberg
<greenberg at ucdavis.edu> wrote:
> I used a mapply() statement to create a list of SpatialPointsDataFrame
> objects -- each of the list entries is a SpatialPointsDataFrame
> object, and each SpatialPointsDataFrame object has the identical @data
> *names* (e.g. the dataframe is rbindable for all of the objects).
> What I'm wondering is if there is an efficient way to merge all of
> these into a single SpatialPointsDataFrame object -- I can (I suppose)
> do an rbind or spRbind, but it seems like I'd have to loop through the
> list entry one at a time, appending each successive
> SpatialPointsDataFrame object into the growing "mega"
> SpatialPointsDataFrame. ?Is there a cleaner/faster way to do this in
> R? ?Thanks!
>
> Here's an example using the built in data/examples:
>
> require(sp)
> data(meuse) # reload data.frame
> coordinates(meuse) = c("x", "y") # specify column names
>
> meuse1=meuse[1:10,]
> meuse2=meuse[11:20,]
> meuse3=meuse[21:50,]
> meuse_list=list(meuse1,meuse2,meuse3)
>
> # Brute Force way:
> for(i in 1:length(meuse_list))
> {
> ? ? ? ?if(i==1)
> ? ? ? ?{
> ? ? ? ? ? ? ? ?meuse_merged=meuse_list[[i]]
> ? ? ? ?} else
> ? ? ? ?{
> ? ? ? ? ? ? ? ?meuse_merged=rbind(meuse_merged,meuse_list[[i]])
> ? ? ? ?}
> }
>
>
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From zenlines at gmail.com  Thu Aug 11 09:16:50 2011
From: zenlines at gmail.com (Brian Oney)
Date: Thu, 11 Aug 2011 09:16:50 +0200
Subject: [R-sig-Geo] Changing the NA value
Message-ID: <4E4381E2.5090600@gmail.com>

Hi All,
I guess I have a few questions:

there are ways to change NA values, such as:

http://r-sig-geo.2731867.n2.nabble.com/NA-raster-replace-td6348031.html

When running a few tests on the different methods that do the same 
thing, I get:
# rast is a raster with appr. 1.5e6 cells
# when I look at str(rast) I see that I can:

 > system.time(rast at file@nodatavalue <- -9995)
    user  system elapsed
       0       0       0
# Or this
 > system.time(rast[is.na(rast)] <- -9996)
    user  system elapsed
    6.55    0.53    7.13
# And finally:
 > system.time(rast <- calc(rast,function(x)ifelse(is.na(x),-9997,x)))
    user  system elapsed
   67.61    0.08   67.83

Will the 1st referencing method listed also work in the future? Is this 
recommended?
How can I change the default NA value i.e. for a session?
I haven't read the do's and don'ts of (R) programming. Where can I do that?

Cheers,
Brian


From s.chamaille at yahoo.fr  Thu Aug 11 09:58:45 2011
From: s.chamaille at yahoo.fr (=?iso-8859-1?Q?Simon_Chamaill=E9?=)
Date: Thu, 11 Aug 2011 08:58:45 +0100 (BST)
Subject: [R-sig-Geo] Re :  convert Raster object to bigmatrix object
In-Reply-To: <CANtt_hy2ZLs82T0qd-+OM_bUR+FKuyPMfn5kZJdJ+fZhfb5J2g@mail.gmail.com>
References: <1312899357.86634.YahooMailRC@web29309.mail.ird.yahoo.com>
	<CANtt_hy2ZLs82T0qd-+OM_bUR+FKuyPMfn5kZJdJ+fZhfb5J2g@mail.gmail.com>
Message-ID: <1313049525.21683.YahooMailNeo@web29304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110811/5fc02c88/attachment.pl>

From julia.dechamps at jesus.ox.ac.uk  Thu Aug 11 11:29:54 2011
From: julia.dechamps at jesus.ox.ac.uk (Julia Dechamps)
Date: Thu, 11 Aug 2011 10:29:54 +0100
Subject: [R-sig-Geo] gstat: Variogram with non-Euclidean Distances
Message-ID: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>

Dear list,

I am wondering whether there is a way to use a contiguity-, graph- or knn-based measure of distance (similar the neighbourhood objects described in "Applied Spatial Data Analysis with R, ch.9.2.2-9.2.4), rather than Euclidean distance, to construct a variogram (in gstat or otherwise). 

The observations I have are very unevenly spaced across a large geographic area and I therefore feel Euclidean distance might not be a good choice.

I have searched the web but unfortunately was not able to find any hints on how I might implement the above.

I would greatly appreciate any advice you might have. 

Regards,
Julia

From lists at remoteinformation.com.au  Thu Aug 11 16:17:38 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Thu, 11 Aug 2011 22:17:38 +0800
Subject: [R-sig-Geo] gstat: Variogram with non-Euclidean Distances
In-Reply-To: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>
References: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>
Message-ID: <2014564E-6EE1-4603-9472-861AD362AAAA@remoteinformation.com.au>

Julia,

I can't help with implementation, but Waller & Gotway discuss non-euclidean distances in geostatistics briefly (p321). Apologies if you already knew this...

cheers

Ben


On 11/08/2011, at 5:29 PM, Julia Dechamps wrote:

> Dear list,
> 
> I am wondering whether there is a way to use a contiguity-, graph- or knn-based measure of distance (similar the neighbourhood objects described in "Applied Spatial Data Analysis with R, ch.9.2.2-9.2.4), rather than Euclidean distance, to construct a variogram (in gstat or otherwise). 
> 
> The observations I have are very unevenly spaced across a large geographic area and I therefore feel Euclidean distance might not be a good choice.
> 
> I have searched the web but unfortunately was not able to find any hints on how I might implement the above.
> 
> I would greatly appreciate any advice you might have. 
> 
> Regards,
> Julia
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mathieu.rajerison at gmail.com  Thu Aug 11 17:59:28 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 11 Aug 2011 17:59:28 +0200
Subject: [R-sig-Geo] gdistance,
 shortest path => "cannot derive coordinates from non-numeric matrix"
Message-ID: <CAGfc75=VY-ce+JwHLzoPVN1iSkn0ryTKUK-JX_RNRoDoBz3sxw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110811/71d6f218/attachment.pl>

From jacobvanetten at yahoo.com  Thu Aug 11 22:44:55 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Thu, 11 Aug 2011 21:44:55 +0100 (BST)
Subject: [R-sig-Geo] gdistance,
	shortest path => "cannot derive coordinates from non-numeric matrix"
In-Reply-To: <CAGfc75=VY-ce+JwHLzoPVN1iSkn0ryTKUK-JX_RNRoDoBz3sxw@mail.gmail.com>
Message-ID: <1313095495.52520.YahooMailClassic@web29718.mail.ird.yahoo.com>

Dear Mathieu,

From what I can see, the error is not due to the TransitionLayer, but is about the coordinates.

The following code works with the versions of gdistance and raster that are currently on CRAN (gdistance_1.1-1, raster_1.9-5):

library(gdistance)
rognes.r <- raster(nrows=50, ncols=50, xmn=887000, xmx=892000, ymn=6285000, ymx=6290000, crs="+proj=utm +zone=31")
rognes.r[] <- 1
rognes.t = transition(rognes.r, transitionFunction = mean, directions=8)
A = c(887543,6286048)
B = c(890911,6289681)
path = shortestPath(rognes.t, A, B, output="SpatialLines")

Next time, provide the results of sessionInfo() when you post to this list. Also, try to provide reproducible code (like in my example). With the information you give now, I can only guess the cause of your problem.

Jacob

--- On Thu, 11/8/11, Mathieu Rajerison <mathieu.rajerison at gmail.com> wrote:

> From: Mathieu Rajerison <mathieu.rajerison at gmail.com>
> Subject: [R-sig-Geo] gdistance, shortest path => "cannot derive coordinates from non-numeric matrix"
> To: r-sig-geo at r-project.org
> Date: Thursday, 11 August, 2011, 17:59
> Hi,
> 
> 
> I'm using gdistance to? determine optimal wildlife
> corridors. My transition
> layer's name is rognes.t, rognes being a city? name.
> 
> I want to determine a corridor between two major ecologic
> niches with
> centroids coordinates A and B.
> 
> But when launching shortestPath, i get the following
> error:
> > rognes.t = transition(rognes.r, transitionFunction =
> mean, directions=8)
> > A = c(887543,6286048)
> > B = c(890911,6289681)
> > path = shortestPath(rognes.t, A, B,
> output="SpatialLines")
> Erreur dans .local(obj, ...) :
> cannot derive coordinates from non-numeric matrix
> De plus : Message d'avis :
> In get.shortest.paths(adjacencyGraph, indexOrigin,
> indexGoal) :
> At structural_properties.c:42
> 
> My transitionMatrix has these characteristics:
> > min(transitionMatrix(rognes.t));
> max(transitionMatrix(rognes.t));
> mean(transitionMatrix(rognes.t))
> [1] 0
> [1] 100
> [1] 0.0009044702
> 
> All values are numeric..
> 
> 
> Any help would be greatly appreciated,
> 
> mathieu
> 
> ??? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From alexandresantosbr at yahoo.com.br  Fri Aug 12 02:48:09 2011
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Thu, 11 Aug 2011 21:48:09 -0300
Subject: [R-sig-Geo] Shapefile in spatstat package
Message-ID: <4E447849.2000303@yahoo.com.br>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110811/1d79a668/attachment.pl>

From lmorandini at ieee.org  Fri Aug 12 08:27:47 2011
From: lmorandini at ieee.org (Luca Morandini)
Date: Fri, 12 Aug 2011 08:27:47 +0200
Subject: [R-sig-Geo] gstat: Variogram with non-Euclidean Distances
In-Reply-To: <2014564E-6EE1-4603-9472-861AD362AAAA@remoteinformation.com.au>
References: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>
	<2014564E-6EE1-4603-9472-861AD362AAAA@remoteinformation.com.au>
Message-ID: <j22h53$ntq$1@dough.gmane.org>

On 08/11/2011 04:17 PM, Ben Madin wrote:
> Julia,
>
> I can't help with implementation, but Waller&  Gotway discuss non-euclidean
> distances in geostatistics briefly (p321).

Same other information on the subject may be found in Shabenberger and Gotway 
("Statistical Methods in Spatial Data Analysis"). The authors state that 
non-euclidean distances may result in non-positive defined covariance matrices, 
hence invalid covariance functions (though multi-dimensional scaling can come to 
the rescue in some cases)... looks like a tricky subject.

Regards,

Luca Morandini
http://www.lucamorandini.it


From mathieu.rajerison at gmail.com  Fri Aug 12 08:58:55 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 12 Aug 2011 08:58:55 +0200
Subject: [R-sig-Geo] gdistance,
 shortest path => "cannot derive coordinates from non-numeric matrix"
In-Reply-To: <1313095495.52520.YahooMailClassic@web29718.mail.ird.yahoo.com>
References: <CAGfc75=VY-ce+JwHLzoPVN1iSkn0ryTKUK-JX_RNRoDoBz3sxw@mail.gmail.com>
	<1313095495.52520.YahooMailClassic@web29718.mail.ird.yahoo.com>
Message-ID: <CAGfc75=JxYaheg6zumd5TEN3zgMDbhg9hB0LYUcVDFGeYZiieQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110812/f277c610/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Aug 12 09:17:18 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 12 Aug 2011 09:17:18 +0200
Subject: [R-sig-Geo] gdistance,
 shortest path => "cannot derive coordinates from non-numeric matrix"
In-Reply-To: <CAGfc75=JxYaheg6zumd5TEN3zgMDbhg9hB0LYUcVDFGeYZiieQ@mail.gmail.com>
References: <CAGfc75=VY-ce+JwHLzoPVN1iSkn0ryTKUK-JX_RNRoDoBz3sxw@mail.gmail.com>
	<1313095495.52520.YahooMailClassic@web29718.mail.ird.yahoo.com>
	<CAGfc75=JxYaheg6zumd5TEN3zgMDbhg9hB0LYUcVDFGeYZiieQ@mail.gmail.com>
Message-ID: <CAGfc75mf0GzkH=66AdAa=8yUxSucMrNtR+OboS2tNtg-gX3XrQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110812/2fd2feea/attachment.pl>

From jacobvanetten at yahoo.com  Fri Aug 12 11:14:48 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 12 Aug 2011 10:14:48 +0100 (BST)
Subject: [R-sig-Geo] gdistance,
	shortest path => "cannot derive coordinates from non-numeric matrix"
In-Reply-To: <CAGfc75mf0GzkH=66AdAa=8yUxSucMrNtR+OboS2tNtg-gX3XrQ@mail.gmail.com>
Message-ID: <1313140488.55529.YahooMailClassic@web29718.mail.ird.yahoo.com>

Oh, but now it throws a straightforward error: "At structural_properties.c:4277 :Couldn't reach some vertices". 

This means that path between A and B does not exist, because they are on different unconnected "islands". Try again, after giving a small positive value to all raster cells that are 0 now.

Something like:

rognes.r[rognes.r<1] <- 1

You don?t have to transform the layer.

Having an NA crs slot in your raster is not a problem in your case, because isLonLat(rognes.r) would give FALSE, which is what you want. 

Jacob.

--- On Fri, 12/8/11, Mathieu Rajerison <mathieu.rajerison at gmail.com> wrote:

> From: Mathieu Rajerison <mathieu.rajerison at gmail.com>
> Subject: Re: [R-sig-Geo] gdistance, shortest path => "cannot derive coordinates from non-numeric matrix"
> To: r-sig-geo at r-project.org
> Date: Friday, 12 August, 2011, 9:17
> The problem seems to come from my
> raster values.
> 
> 1) With all values equal to 1, as in your example, it
> works
> 
> > rognes.r
> class : RasterLayer
> dimensions : 389, 363, 141207 (nrow, ncol, ncell)
> resolution : 25, 25 (x, y)
> extent : 885426, 894501, 6283406, 6293131 (xmin, xmax,
> ymin, ymax)
> coord. ref. : +proj=utm +zone=31
> values : in memory
> min value : 1
> max value : 1
> >(...)
> OK, the path is calculated
> 
> 
> 2) But with my original raster, it doesn't.
> > rognes.r
> class : RasterLayer
> dimensions : 389, 363, 141207 (nrow, ncol, ncell)
> resolution : 25, 25 (x, y)
> extent : 885426, 894501, 6283406, 6293131 (xmin, xmax,
> ymin, ymax)
> coord. ref. : +proj=utm +zone=31
> values : in memory
> min value : 0
> max value : 100
> 
> > summary(rognes.r)
> Cells: 141207
> NAs : 0
> Min. 0.00
> 1st Qu. 0.00
> Median 0.00
> Mean 16.03
> 3rd Qu. 0.00
> Max. 100.00
> 
> > rognes.t = transition(rognes.r, transitionFunction =
> mean, directions=8)
> > A = c(887543,6286048)
> > B = c(890911,6289681)
> > path = shortestPath(rognes.t, A, B,
> output="SpatialLines")
> Erreur dans .local(obj, ...) :
> cannot derive coordinates from non-numeric matrix
> De plus : Message d'avis :
> In get.shortest.paths(adjacencyGraph, indexOrigin,
> indexGoal) :
> At structural_properties.c:4277 :Couldn't reach some
> vertices
> 
> Do you see any problem with my raster values?
> 
> 2011/8/12 Mathieu Rajerison <mathieu.rajerison at gmail.com>
> 
> > I've not specified crs reference when I created my
> raster which is in
> > EPSG:2154. Is it a problem?
> >
> > Do I have to reproject it from EPSG:2154 to Lon/Lat
> before using
> > TransitionLayer calculations?
> >
> >
> > My sessionInfo() is as follows:
> > R version 2.13.1 (2011-07-08)
> > Platform: i386-pc-mingw32/i386 (32-bit)
> >
> > locale:
> > [1] LC_COLLATE=French_France.1252
> LC_CTYPE=French_France.1252
> > [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
> > [5] LC_TIME=French_France.1252
> >
> > attached base packages:
> > [1] stats graphics grDevices utils datasets methods
> base
> >
> > other attached packages:
> > [1] maptools_0.8-9 foreign_0.8-44 gdistance_1.1-1
> > [4] Matrix_0.999375-50 lattice_0.19-30 igraph_0.5.5-2
> > [7] spatstat_1.22-3 RandomFields_2.0.45 deldir_0.0-14
> > [10] mgcv_1.7-6 raster_1.8-39 sp_0.9-83
> >
> > loaded via a namespace (and not attached):
> > [1] grid_2.13.1 nlme_3.1-101 tools_2.13.1
> >
> >
> > Thanks for the quick answer!
> >
> > 2011/8/11 Jacob van Etten <jacobvanetten at yahoo.com>
> >
> >> Dear Mathieu,
> >>
> >> From what I can see, the error is not due to the
> TransitionLayer, but is
> >> about the coordinates.
> >>
> >> The following code works with the versions of
> gdistance and raster that
> >> are currently on CRAN (gdistance_1.1-1,
> raster_1.9-5):
> >>
> >> library(gdistance)
> >> rognes.r <- raster(nrows=50, ncols=50,
> xmn=887000, xmx=892000,
> >> ymn=6285000, ymx=6290000, crs="+proj=utm
> +zone=31")
> >> rognes.r[] <- 1
> >> rognes.t = transition(rognes.r, transitionFunction
> = mean, directions=8)
> >> A = c(887543,6286048)
> >> B = c(890911,6289681)
> >> path = shortestPath(rognes.t, A, B,
> output="SpatialLines")
> >>
> >> Next time, provide the results of sessionInfo()
> when you post to this
> >> list. Also, try to provide reproducible code (like
> in my example). With the
> >> information you give now, I can only guess the
> cause of your problem.
> >>
> >> Jacob
> >>
> >> --- On Thu, 11/8/11, Mathieu Rajerison <mathieu.rajerison at gmail.com>
> >> wrote:
> >>
> >> > From: Mathieu Rajerison <mathieu.rajerison at gmail.com>
> >> > Subject: [R-sig-Geo] gdistance, shortest path
> => "cannot derive
> >> coordinates from non-numeric matrix"
> >> > To: r-sig-geo at r-project.org
> >> > Date: Thursday, 11 August, 2011, 17:59
> >> > Hi,
> >> >
> >> >
> >> > I'm using gdistance to? determine
> optimal wildlife
> >> > corridors. My transition
> >> > layer's name is rognes.t, rognes being a
> city? name.
> >> >
> >> > I want to determine a corridor between two
> major ecologic
> >> > niches with
> >> > centroids coordinates A and B.
> >> >
> >> > But when launching shortestPath, i get the
> following
> >> > error:
> >> > > rognes.t = transition(rognes.r,
> transitionFunction =
> >> > mean, directions=8)
> >> > > A = c(887543,6286048)
> >> > > B = c(890911,6289681)
> >> > > path = shortestPath(rognes.t, A, B,
> >> > output="SpatialLines")
> >> > Erreur dans .local(obj, ...) :
> >> > cannot derive coordinates from non-numeric
> matrix
> >> > De plus : Message d'avis :
> >> > In get.shortest.paths(adjacencyGraph,
> indexOrigin,
> >> > indexGoal) :
> >> > At structural_properties.c:42
> >> >
> >> > My transitionMatrix has these
> characteristics:
> >> > > min(transitionMatrix(rognes.t));
> >> > max(transitionMatrix(rognes.t));
> >> > mean(transitionMatrix(rognes.t))
> >> > [1] 0
> >> > [1] 100
> >> > [1] 0.0009044702
> >> >
> >> > All values are numeric..
> >> >
> >> >
> >> > Any help would be greatly appreciated,
> >> >
> >> > mathieu
> >> >
> >> >? ???[[alternative HTML
> version deleted]]
> >> >
> >> >
> _______________________________________________
> >> > R-sig-Geo mailing list
> >> > R-sig-Geo at r-project.org
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >> >
> >>
> >
> >
> 
> ??? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mathieu.rajerison at gmail.com  Fri Aug 12 11:28:59 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 12 Aug 2011 11:28:59 +0200
Subject: [R-sig-Geo] gdistance,
 shortest path => "cannot derive coordinates from non-numeric matrix"
In-Reply-To: <1313140488.55529.YahooMailClassic@web29718.mail.ird.yahoo.com>
References: <CAGfc75mf0GzkH=66AdAa=8yUxSucMrNtR+OboS2tNtg-gX3XrQ@mail.gmail.com>
	<1313140488.55529.YahooMailClassic@web29718.mail.ird.yahoo.com>
Message-ID: <CAGfc75k=WZKTD480iQ7hrvaNaoP0JWCEmCoPMS0yRPPeLQyacA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110812/19973a7f/attachment.pl>

From Adrian.Baddeley at csiro.au  Fri Aug 12 12:20:13 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 12 Aug 2011 18:20:13 +0800
Subject: [R-sig-Geo]  Shapefile in spatstat package
Message-ID: <57DC18C299094D4299F837570C5DF1C54E8A7635F6@EXWA-MBX01.nexus.csiro.au>

Alexandre dos Santos writes:

 > I was trying to use an object SpatialPolygonsDataFrame in shapefile 
 > format with the package spatstat,
 > I used Baddeley's material "Handling in the shapefiles package of 
 > spatstat", but I could not plot the owin created, 
 > I maked for this purpose:

  > require (maptools)
  > require (spatstat)
  > x <- readShapeSpatial ("mtaremanne92.shp")
  > cregions <- slot (x, "polygons")
  > cregions <- lapply (cregions, function (x) {SpatialPolygons (list (x))})
  > cwindows <- lapply (cregions, as.owin)

The vignette ('Handling shapefiles in the spatstat package') says that these commands 
can be used if 'x' is a 'SpatialPolygons' object.

But in your example, 'x' is a 'SpatialPolygonsDataFrame' object, ... so you first need to extract the SpatialPolygons information: 

  x <- readShapeSpatial ("mtaremanne92.shp")
  y <- as(x, "SpatialPolygons")
  cregions <- slot (y, "polygons")
  cregions <- lapply (cregions, function (z) {SpatialPolygons (list (z))})
  cwindows <- lapply (cregions, as.owin)

Adrian Baddeley
====
Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
Skype: adrian.baddeley


From mathieu.rajerison at gmail.com  Fri Aug 12 13:27:11 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 12 Aug 2011 13:27:11 +0200
Subject: [R-sig-Geo] Filling null values of a raster
Message-ID: <CAGfc75kf6DskbvOOQsp=ZmnParQxBF7WepEk6Owf_e==uh4p3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110812/9cc216c5/attachment.pl>

From pierre.roudier at gmail.com  Sat Aug 13 09:26:34 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Sat, 13 Aug 2011 19:26:34 +1200
Subject: [R-sig-Geo] Filling null values of a raster
In-Reply-To: <CAGfc75kf6DskbvOOQsp=ZmnParQxBF7WepEk6Owf_e==uh4p3g@mail.gmail.com>
References: <CAGfc75kf6DskbvOOQsp=ZmnParQxBF7WepEk6Owf_e==uh4p3g@mail.gmail.com>
Message-ID: <CADLQFsNJT58GHSewLhUJhQR9=dc=_eOsycqkmOwf18Q_b2Q1CQ@mail.gmail.com>

Not aware of any function doing that out-of-the-box in R. But maybe
the answer is in your question: you may as well make use of the
spgrass6 package and call r.fillnulls from R.

HTH,

Pierre

2011/8/12 Mathieu Rajerison <mathieu.rajerison at gmail.com>:
> Hi list,
>
> Is there an R function that fills null values using thin plate splines as
> r.fillnulls from GRASS accomplishes?
>
> Thanks!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From xuanlong.ma at uts.edu.au  Sun Aug 14 06:33:07 2011
From: xuanlong.ma at uts.edu.au (Richard Ma)
Date: Sat, 13 Aug 2011 21:33:07 -0700 (PDT)
Subject: [R-sig-Geo] A question about the "extract" function in package
	"raster"
Message-ID: <1313296387794-6684332.post@n2.nabble.com>

Hi all, 

Suppose I have a raster object, its resolution is 0.25km. Now I want to
extract the value with a spatial point. There is a argument in "extract"
function called "buffer" to set the sampling "radius". If I want to sampling
a 1 km^2 area in my 0.25km resolution raster. How to set the "buffer"? Is
that "buffer = 500"? 

Just very curious how the "buffer" works in grid image. I have read the
document and still very confused. 

Thanks for your kindly help! 

BTW, "raster" is really a great package with lots of useful functions for
image processing. Thank you Robert! 

Regards, 
Richard

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/A-question-about-the-extract-function-in-package-raster-tp6684332p6684332.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Xuanlong.Ma at uts.edu.au  Sun Aug 14 06:35:07 2011
From: Xuanlong.Ma at uts.edu.au (Xuanlong Ma)
Date: Sun, 14 Aug 2011 14:35:07 +1000
Subject: [R-sig-Geo] A question about the "extract" function in package
	"raster"
Message-ID: <CAE5v6PCC_ToBb2A_Wrm5DohB0BrCaK4exiFJZ+P9vL8+QcgR1g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110814/746faf3a/attachment.pl>

From oscar.perpinan at upm.es  Sun Aug 14 16:42:06 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Sun, 14 Aug 2011 16:42:06 +0200
Subject: [R-sig-Geo] Transparency of Raster* objects
In-Reply-To: <1311929449249-6632801.post@n2.nabble.com>
References: <CADLQFsMXx8ohK9+DbROVrri6ZSqj8WAzEwxZW0gYanbYXhjpXA@mail.gmail.com>
	<1311889236089-6631467.post@n2.nabble.com>
	<CADLQFsPBRSjvaU2EO=AMK-BuUzcMRWuSnihqfwbyfZ+_mYJauw@mail.gmail.com>
	<1311929449249-6632801.post@n2.nabble.com>
Message-ID: <20110814164206.23c9469f@upm.es>

Hi,

You can also use the "overlaying" mechanism of latticeExtra, 
with the levelplot method of rasterVis:

library(raster)
library(rasterVis)
library(lattice)
library(latticeExtra)

r <- raster(system.file("external/test.grd", package="raster"))

data(meuse.grid)
coordinates(meuse.grid) <- ~x+y
proj4string(meuse.grid) <- CRS("+init=epsg:28992")
gridded(meuse.grid) <- TRUE
d <- raster(meuse.grid, 'dist')

rPlot <- levelplot(r)
dPlot <- levelplot(d, par.settings=GrTheme, alpha.regions=0.4)

rPlot + dPlot

Besides, you can also add contour lines:

## In the next version of rasterVis a new contourplot method will be
## added as a wrapper to levelplot with these options.
dContour <- levelplot(d, region=FALSE, labels=TRUE, contour=TRUE,
			pretty=TRUE, colorkey=FALSE)

rPlot + dContour

rPlot + dPlot + dContour

Best,

Oscar.

El Fri, 29 Jul 2011
01:50:49 -0700 (PDT) Robert Hijmans <r.hijmans at gmail.com> escribi?:
> Pierre, 
> 
> > The trick is I'm using RColorBrewer, who does not provides this 
> > posibility. 
> 
> No, but the alpha argument to plot (with a Raster* object) does:
> 
> r <- raster(system.file("external/test.grd", package="raster"))
> library(RColorBrewer)
> col <- brewer.pal(9, 'GnBu')
> plot(r, col=col, alpha=0.3)
> 
> > However, what I'm still stuck at using a variable transparency in 
> > space, eg in the meuse.grid dataset, how to make transparency a 
> > function of the distance to the river (the dist attribute) ? 
> 
> I do not know; the below is ugly, but perhaps it provides some ideas:
> 
> 
> 
> library(raster)
> 
> data(meuse.grid)
> coordinates(meuse.grid) <- ~x+y
> proj4string(meuse.grid) <- CRS("+init=epsg:28992")
> gridded(meuse.grid) <- TRUE
> data(meuse.riv)
> meuse.sr =
> SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)),"meuse.riv")))
> 
> r <- raster(meuse.grid, 'dist')
> riv <- rasterize(meuse.sr, r)
> 
> d <- distance(riv)
> d[d > 1000] <- 1000
> d <- 254 * d/1000
> 
> a <- c(0:9, LETTERS[1:6])
> 
> bw <- paste("#000000", rep(a, each=16), rep(a, times=16), sep='')
> plot(r)
> plot(d, col=bw, add=T)
> 
> x11()
> ter <- paste(substr(terrain.colors(254), 1, 7), rep(a, each=16),
> rep(a, times=16), sep='')
> plot(r, col=gray(1:255/255))
> plot(d, col=ter, add=T)
> 
> Best, Robert
> 
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Transparency-of-Raster-objects-tp6628801p6632801.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Mon Aug 15 00:03:04 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 14 Aug 2011 23:03:04 +0100
Subject: [R-sig-Geo] geo meetup at UseR! 2011
Message-ID: <CANVKczOLmL=Kt+gCBK5rEKqB-G1a=EO9qMwWHxJdksf+yuBVtA@mail.gmail.com>

 If any R-sig-geo readers are going to UseR! at Warwick U next week,
there's a plan to meet up on Tuesday evening for a chat about all
things R and spatial.

 So far that's me and Roger Bivand, but there will be others. I think
we'll gather after dinner on Tuesday and find a bar. Watch this space
for further details, or follow @geospacedman (that's me) on Twitter,
or maybe we'll put a post-it note up on the conference notice board.

 Roger suggested we just give coordinates, and anyone competent enough
to find us can join us...

Barry


From HodgessE at uhd.edu  Mon Aug 15 00:42:03 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 14 Aug 2011 17:42:03 -0500
Subject: [R-sig-Geo] more Geostat classes
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DBAC6@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110814/c4a4330c/attachment.pl>

From paul.hiemstra at knmi.nl  Mon Aug 15 10:17:22 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Mon, 15 Aug 2011 08:17:22 +0000
Subject: [R-sig-Geo] A one to many merge involving a spatial data frame
 object
In-Reply-To: <4E419749.5040002@sauder.ubc.ca>
References: <4E419749.5040002@sauder.ubc.ca>
Message-ID: <4E48D612.8020403@knmi.nl>

 On 08/09/2011 08:23 PM, Dan Putler wrote:
> All,
>
> I'm working with the 2010 TIGER/Line shapefile road data, and I'm
> dealing with alternative road names for the same road segment. There
> are two relevant files in the TIGER collection, the first is the road
> edge shapefile, which has a unique record (and geometry) for each road
> segment. The other is a featnames dbf file which can have multiple
> records for the same road segment (but an ID that identifies the road
> segment). One of the reasons this second file was created was to deal
> with situations where a portion of a road is known by two or more
> different names (for example, Hwy 50 and Main Street). My goal is to
> create a SpatialLinesDataFrame object that contains the unique road
> segment / road name combinations, which will result in a set of line
> geometries that are not unique. I've looked at the spCbind methods,
> but my reading of the documentation suggests it will not address this
> case directly since the feature IDs would not be unique.
>
> I can create a new SpatialLinesDataFrame that has a row for each
> possible unique road segment and road name combination, and I can then
> use spCbind to attach the needed attribute information to this object.
> Unfortunately, the way I can think of creating the
> SpatialLinesDataFrame object is a great example of what *not* to do in
> S language programming, specifically, use a for-loop to "grow" a data
> frame like object using rbind. Below is a snippet of my present code:
>
>   geom1 <- readOGR(dsn=roads_dsn, layer=roads_layer)
>   geom1 <- geom1[, "TLID"]
>   # Let the nastiness begin. Time to build-up the needed geometries
>   geom <- spChFIDs(geom1[geom1$TLID == roadsf$TLID[1],], "1")
>   for(i in 2:nrow(roadsf)) {
>     new_geom <- spChFIDs(geom1[geom1$TLID == roadsf$TLID[i],],
> as.character(i))
>     geom <- rbind(geom, new_geom)

In general in R concatenating objects in this way is quite a slow
process (assuming that nrow(roadsf) is quite big). The object geom keeps
on growing and the memory allocated to that object is continuously
updated to allow for the growing object. This is very slow and should be
avoided. Pre-allocating the space needed for geom could speed this code
up quite a bit. Alternatively, I often use functions from the plyr
package to circumvent this problem. However, without a working example
from your side I cannot provide sample code that uses the plyr package.

regards,
Paul

>   }
>
> In the code, the data frame "roadsf" contains the attribute data for
> each unique road segment / road name pair, and the variable TLID is
> the unique ID for the road segment geometries. This works, but it is
> really slow (it is CPU bound, but not I/O bound). My question is have
> I missed an easier solution? If I haven't, how could I go about doing
> this more cleverly? Given the need to alter the feature IDs, I don't
> see a nice way to use one the apply family of functions.
> Alternatively, is this just something that is better suited to the use
> of a spatial database tool like PostGIS or SpatiaLite? I can guess the
> query looks like: SELECT * FROM table1 AS a, the_geom FROM table2 AS b
> WHERE a.id = b.id
>
> Dan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From manuel.schneider at art.admin.ch  Mon Aug 15 10:36:57 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Mon, 15 Aug 2011 08:36:57 +0000
Subject: [R-sig-Geo] Reading a WMS layer as a sp object
References: <BANLkTim9qY06rW4C4Rcqc6hGXsMxMCRt5w@mail.gmail.com>
	<BANLkTikHOhsSJB1Y=S7kO3S0_w8dXXx0sQ@mail.gmail.com>
Message-ID: <loom.20110815T094820-854@post.gmane.org>

Following Michael's advice I'm trying to execute the first example on
http://www.gdal.org/frmt_wms.html and run

gdal_translate <- "C:/Progs/FWTools2.4.7/bin/gdal_translate.exe"
download.file("http://www.gdal.org/frmt_wms_onearth_global_mosaic.xml",
destfile="C:/temp/test.xml")
wms_xml <- "C:/temp/test.xml"
system(paste(gdal_translate, "-of PNG -outsize 512 256", wms_xml, "test.png"))

but I get the following errors

Input file size is 2949120, 1474560
0ERROR 1: GDALWMS: Unable to download block 0, 0.
  URL:
http://onearth.jpl.nasa.gov/wms.cgi?request=GetMap&version=1.1.1&layers=global_mosaic&styles=visual&srs=EPSG:4326&format=image/jpeg&width=512&height=512&bbox=-180.00000000,-166.00000000,76.00000000,90.00000000
  HTTP status code: 0, error: Failed connect to onearth.jpl.nasa.gov:80; No error.
ERROR 1: IReadBlock failed at X offset 0, Y offset 0
ERROR 1: GDALWMS: Unable to download block 5, 5.
  URL:
http://onearth.jpl.nasa.gov/wms.cgi?request=GetMap&version=1.1.1&layers=global_mosaic&styles=visual&srs=EPSG:4326&format=image/jpeg&width=512&height=512&bbox=-179.68750000,89.62500000,-179.62500000,89.68750000
  HTTP status code: 0, error: Failed connect to onearth.jpl.nasa.gov:80; No error.
ERROR 1: IReadBlock failed at X offset 5, Y offset 5
Warning message:
running command 'C:/ManuProgs/FWTools2.4.7/bin/gdal_translate.exe -of JPEG
-outsize 500 250 C:/temp/test.xml test.jpg' had status 1 

Any advice of the experts is acknowledged in advance

Regards
Manuel


From conveymichelle at yahoo.co.uk  Mon Aug 15 11:51:06 2011
From: conveymichelle at yahoo.co.uk (Michelle Convey)
Date: Mon, 15 Aug 2011 10:51:06 +0100 (BST)
Subject: [R-sig-Geo] Mapping exponentials from GWR
Message-ID: <1313401866.24298.YahooMailNeo@web29710.mail.ird.yahoo.com>

Hi there,

I am working on a project with the spgwr package.? I am able to map the coefficients from my GWR analysis and am able to get summary data on the exponentials on the same data, but am not sure how to map them.? I'm probably missing something quite obvious as I am fairly new to this, but any help would be greatly appreciated. Please see a snippet of the code below:

library spgwr
library maptools
library GISTools

## GWR
# Get the bandwidth:
??? a.bw <- gwr.sel(aa~bb, data = data.pt, adapt = TRUE)
??? a.bw
# Create model:
??? gwr.a = gwr(aa~bb, data=data.pt, adapt=a.bw, fit.points=grid1)

# Co-efficients summary:
m <- length(gwr.a$lm$coefficients)
??? CM <- t(apply(as(gwr.a$SDF, "data.frame")[, (1 + (1:m)), drop = FALSE], 
??????? 2, summary))[, c(1:3, 5, 6)]
# This puts it in a matrix:
??? if (is.null(dim(CM))) 
??????? CM <- t(as.matrix(CM))
# Exponentials:
??? CM <- cbind(exp(CM), exp(coefficients(gwr.a$lm)))
# This prints out a summary matrix:
??? colnames(CM) <- c(colnames(CM)[1:5], "Global")
??? printCoefmat(CM)

## MAKE MAP - This only maps the coeffiecients - I would like to be able to map the exponentials
# Plot the results:
??? gwr.a = SpatialPixelsDataFrame(gwr.a$SDF, data.frame(gwr.a$SDF))

# Changes colour and map quantiles:??? 
??? gwr.shades = auto.shading(gwr.res_a$bb, n=4, cols=brewer.pal(4,'Blues'),cutter=quantile.cuts)
??? level.plot(gwr.res_a, index = "LTI", shades = gwr.shades)

Any help would be gratefully received.

Many thanks,
M



From bart at njn.nl  Mon Aug 15 12:31:23 2011
From: bart at njn.nl (bart)
Date: Mon, 15 Aug 2011 12:31:23 +0200
Subject: [R-sig-Geo] Error when projecting polygons into Azimuthal
	Equidistant Projection
Message-ID: <4E48F57B.9060804@njn.nl>

Hi All

First a short introduction to what i'm trying to do, I'm trying to find 
the length of a line going through a point intersecting with the coast 
lines. My thought was to find the right polygon and then re-project it 
to an Azimuthal Equidistant Projection on which an intersection with the 
line could work using gIntersection from the rgeos package.

Some how re-projecting using spTransfrom invalidates the polygon. The 
polygon starts intersecting with itself. Does anyone have any suggestions?

A small example to reproduce the problem:

require(maps)
require(maptools)
require(rgeos)
require(rgdal)
a<-getRgshhsMap(xlim=c(-170, 180),ylim=c( -60,90))
a<-a[1]# get only eurasia
gIsValid(a)
plot(a)
transformed<-spTransform(a, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
gIsValid(transformed)
x<-9.35151 *10^6
y<-3.60185 *10^6
plot(transformed); axis(1); axis(2); points(x,y, col="red")
plot(transformed, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); 
axis(1); axis(2); points(x,y, col="red")


I tried interpolating the segments along a great circle route but that 
did not help:

require(geosphere)
ps<-as.data.frame(SpatialPolygons2PolySet(a))
ps<-ps[ps$SID==1,] 
psnew<-as.data.frame(gcIntermediate(as.matrix(ps[-nrow(ps),c("X","Y")]),as.matrix(ps[-1,c("X","Y")]), 
sepNA=TRUE, addStartEnd=TRUE, n=100))
         psnew<-psnew[!is.na(psnew$lat),]
         psnew<-psnew[!duplicated(psnew),]
         names(psnew)<-c("X","Y")
         psnew$PID<-1
         psnew$POS<-1:nrow(psnew)
         spnew<-PolySet2SpatialPolygons(as.PolySet(psnew,projection="LL"))
         gIsValid(spnew)
         sptra<-spTransform(spnew, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
         x<-9.38019 *10^6
         y<-3.55167 *10^6
         plot(sptra); axis(1); axis(2); points(x,y, col="red")
         plot(sptra, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); 
axis(1); axis(2); points(x,y, col="red")
         plot(sptra, xlim=x+c(-10^4, 10^4), ylim=y+c(-10^4, 10^4)); 
axis(1); axis(2); points(x,y, col="red")
         gIsValid(sptra)

Thanks in advance for any tips

Bart


From j2kennel at gmail.com  Mon Aug 15 18:37:10 2011
From: j2kennel at gmail.com (Jonathan Kennel)
Date: Mon, 15 Aug 2011 12:37:10 -0400
Subject: [R-sig-Geo] gstat: Specify user defined variogram or specify
	covariance matrices
Message-ID: <CABP0dEi6B-WBLbR1nM_1ZBsr-GPhkE+XnFP9vALn8f+SOy=r2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/aced7133/attachment.pl>

From Roger.Bivand at nhh.no  Mon Aug 15 18:51:26 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 15 Aug 2011 18:51:26 +0200
Subject: [R-sig-Geo] Error when projecting polygons into Azimuthal
 Equidistant Projection
In-Reply-To: <4E48F57B.9060804@njn.nl>
References: <4E48F57B.9060804@njn.nl>
Message-ID: <alpine.LRH.2.00.1108151847120.13143@reclus.nhh.no>

On Mon, 15 Aug 2011, bart wrote:

> Hi All
>
> First a short introduction to what i'm trying to do, I'm trying to find the 
> length of a line going through a point intersecting with the coast lines. My 
> thought was to find the right polygon and then re-project it to an Azimuthal 
> Equidistant Projection on which an intersection with the line could work 
> using gIntersection from the rgeos package.
>
> Some how re-projecting using spTransfrom invalidates the polygon. The polygon 
> starts intersecting with itself. Does anyone have any suggestions?

Your choice of +lon_0=-9 is unfortunate and flips Malaysia onto India; 
+lon_0=90 does not lead to meltdown. So it is an artefact of your choice 
of +lon_0 for this projection.

Roger

>
> A small example to reproduce the problem:
>
> require(maps)
> require(maptools)
> require(rgeos)
> require(rgdal)
> a<-getRgshhsMap(xlim=c(-170, 180),ylim=c( -60,90))
> a<-a[1]# get only eurasia
> gIsValid(a)
> plot(a)
> transformed<-spTransform(a, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
> gIsValid(transformed)
> x<-9.35151 *10^6
> y<-3.60185 *10^6
> plot(transformed); axis(1); axis(2); points(x,y, col="red")
> plot(transformed, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); axis(1); 
> axis(2); points(x,y, col="red")
>
>
> I tried interpolating the segments along a great circle route but that did 
> not help:
>
> require(geosphere)
> ps<-as.data.frame(SpatialPolygons2PolySet(a))
> ps<-ps[ps$SID==1,] 
> psnew<-as.data.frame(gcIntermediate(as.matrix(ps[-nrow(ps),c("X","Y")]),as.matrix(ps[-1,c("X","Y")]), 
> sepNA=TRUE, addStartEnd=TRUE, n=100))
>        psnew<-psnew[!is.na(psnew$lat),]
>        psnew<-psnew[!duplicated(psnew),]
>        names(psnew)<-c("X","Y")
>        psnew$PID<-1
>        psnew$POS<-1:nrow(psnew)
>        spnew<-PolySet2SpatialPolygons(as.PolySet(psnew,projection="LL"))
>        gIsValid(spnew)
>        sptra<-spTransform(spnew, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
>        x<-9.38019 *10^6
>        y<-3.55167 *10^6
>        plot(sptra); axis(1); axis(2); points(x,y, col="red")
>        plot(sptra, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); axis(1); 
> axis(2); points(x,y, col="red")
>        plot(sptra, xlim=x+c(-10^4, 10^4), ylim=y+c(-10^4, 10^4)); axis(1); 
> axis(2); points(x,y, col="red")
>        gIsValid(sptra)
>
> Thanks in advance for any tips
>
> Bart
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Mon Aug 15 20:44:09 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 15 Aug 2011 11:44:09 -0700
Subject: [R-sig-Geo] Changing the NA value
In-Reply-To: <4E4381E2.5090600@gmail.com>
References: <4E4381E2.5090600@gmail.com>
Message-ID: <CANtt_hxmPCd7SrY1Q5Un5vYsZWqvpj7UG_WMGLFNnji0Fww+RA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/364bd7ea/attachment.pl>

From cam.plouffe at gmail.com  Mon Aug 15 20:47:34 2011
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Mon, 15 Aug 2011 14:47:34 -0400
Subject: [R-sig-Geo] Segmentation of SpatialLines at Intersection
Message-ID: <CAAN3GgCN3okfqpqZp7XfarmknOqmzwkMGae+T9TcHnW0VqjM9Q@mail.gmail.com>

Hi everybody,

I have a SpatialLines object that I created by using the gBoundary()
function on a SpatialPolygons object.  I've attached a plot ("SpatialLines
Segmentation.png") of the SpatialLines object to this email.  What I would
like to do, is segment these SpatialLines wherever there is an intersection,
or overlap of lines.  After I have segmented these SpatialLines at their
intersections, I will be classifying them as either boundary, interior, or
partition arcs.

I have been looking through various packages that work with spatial data in
R, but I have yet to find a function that can help me classify these lines.
 I can find out the intersection points by using the gIntersection()
function on the given SpatialLines, but I need a function that will take
these intersection points, and break these SpatialLines into the segments I
need.

I realize this description may be a little confusing/vague, and I'm willing
to give any info I can to help with a potential solution.  Frankly, I have
difficulty explaining exactly what I'm trying to do, so if there is
confusion I can try to clarify.  I have attached a second image ("Labelled
Segments.png") to this email that hopefully illustrates the labelled
segments that I want to divide the SpatialLines object into.  Altogether,
for the provided example there should be 10.

If someone could aid me in any way with this problem, I'd be very grateful.

Thanks,
Cam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/633a0f80/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SpatialLines Segmentation.png
Type: image/png
Size: 3296 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/633a0f80/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Labelled Segments.png
Type: image/png
Size: 17793 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/633a0f80/attachment-0001.png>

From zenlines at gmail.com  Mon Aug 15 21:06:18 2011
From: zenlines at gmail.com (Brian Oney)
Date: Mon, 15 Aug 2011 21:06:18 +0200
Subject: [R-sig-Geo] Changing the NA value
In-Reply-To: <CANtt_hxmPCd7SrY1Q5Un5vYsZWqvpj7UG_WMGLFNnji0Fww+RA@mail.gmail.com>
References: <4E4381E2.5090600@gmail.com>
	<CANtt_hxmPCd7SrY1Q5Un5vYsZWqvpj7UG_WMGLFNnji0Fww+RA@mail.gmail.com>
Message-ID: <4E496E2A.1040501@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110815/acb6d209/attachment.pl>

From pierre.roudier at gmail.com  Mon Aug 15 23:26:23 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Mon, 15 Aug 2011 22:26:23 +0100
Subject: [R-sig-Geo] geo meetup at UseR! 2011
In-Reply-To: <CANVKczOLmL=Kt+gCBK5rEKqB-G1a=EO9qMwWHxJdksf+yuBVtA@mail.gmail.com>
References: <CANVKczOLmL=Kt+gCBK5rEKqB-G1a=EO9qMwWHxJdksf+yuBVtA@mail.gmail.com>
Message-ID: <CADLQFsPEapqjnMV4xP_Bq6gasB0wiA1mWKyZ97mE3W2D_hJ-+A@mail.gmail.com>

Hi Barry,

I'll be happy to join :)

I'm sure there's some more spatial useRs out there in Warwick at the moment,

Cheers,

Pierre

2011/8/14 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> ?If any R-sig-geo readers are going to UseR! at Warwick U next week,
> there's a plan to meet up on Tuesday evening for a chat about all
> things R and spatial.
>
> ?So far that's me and Roger Bivand, but there will be others. I think
> we'll gather after dinner on Tuesday and find a bar. Watch this space
> for further details, or follow @geospacedman (that's me) on Twitter,
> or maybe we'll put a post-it note up on the conference notice board.
>
> ?Roger suggested we just give coordinates, and anyone competent enough
> to find us can join us...
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From Jin.Li at ga.gov.au  Tue Aug 16 03:38:40 2011
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Tue, 16 Aug 2011 11:38:40 +1000
Subject: [R-sig-Geo] anisotropy modeling [SEC=UNCLASSIFIED]
In-Reply-To: <4E253933.8070708@uni-muenster.de>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>

Hi All,

Following Edzer's examples, I have tried to test the effects of the specification of alpha in variogram on the results of fit.variogram as below: 

>  v =  variogram(zinc~1,meuse) 
>  v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45) 
>  v90 =  variogram(zinc~1,meuse, alpha = 90, tol.hor = 45) 
>  v090 =  variogram(zinc~1,meuse, alpha=c(0, 90), tol.hor=45) 
>  v45135 =  variogram(zinc~1,meuse, alpha=c(45, 135), tol.hor=45)
>  v2 =  variogram(zinc~1,meuse, alpha=c(0, 45, 90, 135), tol.hor=45) 
 
>   fit.variogram(v, vgm(1, "Exp", 300,  anis=c(90,1)))
  model  psill    range
1   Exp 166238 323.6674
>   fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
  model  psill    range ang1 anis1
1   Exp 166238 3236.674   90   0.1
>   fit.variogram(v090, vgm(1, "Exp", 300, anis=c(90,.1)))
  model    psill    range ang1 anis1
1   Exp 166262.4 3237.814   90   0.1
>   fit.variogram(v45135, vgm(1, "Exp", 300, anis=c(90,.1)))
  model    psill    range ang1 anis1
1   Exp 165919.4 3224.622   90   0.1
>  fit.variogram(v2, vgm(1, "Exp", 300, anis=c(90,.1)))
  model  psill    range ang1 anis1
1   Exp 166091 3231.219   90   0.1


>   fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
  model    psill    range ang1 anis1
1   Exp 146068.7 2772.751   90   0.1
>   fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
  model    psill    range ang1 anis1
1   Exp 200767.2 4027.282   90   0.1

Above results show that using v, v090, v45135 and v2 would produce similar results for anis=c(90, 0.1), suggesting that the specification of alpha in variogram is largely redundant, while using v0 and v90 produced very different results, suggesting a contrary. Could anyone shed a light on this? Thanks.
Jin



-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
Sent: Tuesday, 19 July 2011 5:59 PM
To: shweta jp
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] anisotropy modeling

The description says:

  The automatic fitting is done through fit.variogram.

estimateAnisotropy {intamap} does fit anistropy coefficients.



On 07/18/2011 08:27 PM, shweta jp wrote:
> Is the same true for autofitVariogram {automap} ?
> 
> Shweta
> 
> On Wed, Jul 13, 2011 at 1:13 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>> help(fit.variogram) has the following description:
>>
>>     Fit ranges and/or sills from a simple or nested variogram model to
>>     a sample variogram
>>
>> I suspected it would completely ignore anisotropy settings. However,
>> this seems not to be the case:
>>
>>> library(gstat)
>> Loading required package: sp
>> Loading required package: spacetime
>> Loading required package: zoo
>> Loading required package: xts
>>> loadMeuse()
>>> v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45)
>>> v90 = variogram(zinc~1,meuse, alpha = 90, tol.hor = 45)
>>> v = variogram(zinc~1,meuse)
>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,1)))
>>  model  psill    range
>> 1   Exp 166238 323.6674
>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
>>  model  psill    range ang1 anis1
>> 1   Exp 166238 3236.674   90   0.1
>>> fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
>>  model    psill    range ang1 anis1
>> 1   Exp 146068.7 2772.751   90   0.1
>>> fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
>>  model    psill    range ang1 anis1
>> 1   Exp 200767.2 4027.282   90   0.1
>>>
>>
>>
>> On 07/13/2011 11:34 AM, Matev? Pavli? wrote:
>>> Hi,
>>>
>>> thanks for the reply. Can you explain this a little bit more :
>>> " it assumes the variogram to fit to is in the major (correlation)
>> direction (or averaged over all directions)."
>>>
>>> I don't know exactly ehat it means....
>>> m
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org [mailto:
>> r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>> Sent: Wednesday, July 13, 2011 10:10 AM
>>> To: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] anisotropy modeling
>>>
>>>
>>>
>>> On 07/12/2011 10:52 PM, Matev? Pavli? wrote:
>>>> Hi all,
>>>>
>>>>
>>>>
>>>> i 'm am not entirely sure I understand anisotropy kriging in R.
>>>>
>>>> I have a data set in which is (at least i think so) anisotropy is
>> clearly visible. So I made directional variograms....
>>>>
>>>> So as i understand, the only thing that is different from >normal<
>> kriging is the  >anis< property in which you define the diffrenece of
>> ranges? Is that coreect?
>>>
>>> Yes. Please note that fit.variogram ignores anything about anisotropy, it
>> assumes the variogram to fit to is in the major (correlation) direction (or
>> averaged over all directions).
>>>
>>>>
>>>> Bellow is the code i use :
>>>>
>>>>
>>>>
>>>> a<-5000/7000
>>>>
>>>> print(plot(variogram(Z ~ 1, DF, map = TRUE, cutoff = 15000, width =
>>>> 100), main = "Variogram map, podlaga",col.regions =
>>>> terrain.colors(64)))
>>>>
>>>> v1.a<-variogram(Z~1, DF, alpha=c(45, 135))
>>>>
>>>> (vmf.a <- fit.variogram(v1.a, vgm(2900, "Pen", 5500, 300, anis =
>>>> c(135, a))))
>>>>
>>>> print(plot(v1.a, pl = F, pch = 20, col = "blue"))
>>>>
>>>> print(plot(v1.a, plot.numbers = F, pch = 20, col = "darkblue", model =
>>>> vmf.a))
>>>>
>>>>
>>>>
>>>> podlaga.aniso<-krige(Z~1, DF[-zerodist(DF)[,1],], grd, vmf.a )
>>>>
>>>> print(spplot(podlaga.aniso, zcol="var1.pred",
>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>> key.space="right"))
>>>>
>>>> print(spplot(podlaga.aniso,  zcol="var1.var",
>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>> key.space="right"))
>>>>
>>>> writeGDAL(podlaga.aniso, "podlaga_aniso.tif")
>>>>
>>>>
>>>>
>>>> thanks for info,
>>>>
>>>>
>>>>
>>>> m
>>>>
>>>>
>>>>      [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
>> http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Aug 16 08:48:09 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 16 Aug 2011 08:48:09 +0200 (CEST)
Subject: [R-sig-Geo] Mapping exponentials from GWR
In-Reply-To: <1313401866.24298.YahooMailNeo@web29710.mail.ird.yahoo.com>
References: <1313401866.24298.YahooMailNeo@web29710.mail.ird.yahoo.com>
Message-ID: <alpine.LRH.2.00.1108160820200.15541@reclus.nhh.no>

On Mon, 15 Aug 2011, Michelle Convey wrote:

> Hi there,
>
> I am working on a project with the spgwr package.? I am able to map the coefficients from my GWR analysis and am able to get summary data on the exponentials on the same data, but am not sure how to map them.? I'm probably missing something quite obvious as I am fairly new to this, but any help would be greatly appreciated. Please see a snippet of the code below:
>
> library spgwr
> library maptools

Not needed.

> library GISTools

There is no such package on CRAN. All examples must be fully reproducible.

>
> ## GWR
> # Get the bandwidth:
> ??? a.bw <- gwr.sel(aa~bb, data = data.pt, adapt = TRUE)
> ??? a.bw
> # Create model:
> ??? gwr.a = gwr(aa~bb, data=data.pt, adapt=a.bw, fit.points=grid1)
>
> # Co-efficients summary:
> m <- length(gwr.a$lm$coefficients)
> ??? CM <- t(apply(as(gwr.a$SDF, "data.frame")[, (1 + (1:m)), drop = FALSE],
> ??????? 2, summary))[, c(1:3, 5, 6)]
> # This puts it in a matrix:
> ??? if (is.null(dim(CM)))
> ??????? CM <- t(as.matrix(CM))

Please do mot mess with things you don't need to; gwr.a$SDF is a 
Spatial*DataFrame, so simply do summary() on the relevant columns.
Find the columns by inspecting names(gwr.a$SDF) and say:

summary(gwr.a$SDF[,c("var1", "var2", ...)])

For inspection, summary(gwr.a$SDF) is sufficient. You have copied code 
from within print.gwr() without understanding the underlying objects.

To get the exponents, use the fact that gwr.a$SDF is a
Spatial*DataFrame, so simply say:

gwr.a$SDF$evar1 <- exp(gwr.a$SDF$var1)
...

and repeat summary() with the new variables, and plot() or whatever - I 
suggest spplot() to map coefficients.

Also be aware that GWR is a rather doubtful procedure, as its authors have 
not replied to published documented criticism, and that this package is 
intended to assist research in finding out why it is unreliable. Any 
coefficient variability may indicate model misspecification (but may occur 
when not misspecification is present), which you should correct, rather 
than use GWR.

Roger


> # Exponentials:
> ??? CM <- cbind(exp(CM), exp(coefficients(gwr.a$lm)))
> # This prints out a summary matrix:
> ??? colnames(CM) <- c(colnames(CM)[1:5], "Global")
> ??? printCoefmat(CM)
>
> ## MAKE MAP - This only maps the coeffiecients - I would like to be able to map the exponentials
> # Plot the results:
> ??? gwr.a = SpatialPixelsDataFrame(gwr.a$SDF, data.frame(gwr.a$SDF))
>
> # Changes colour and map quantiles:???
> ??? gwr.shades = auto.shading(gwr.res_a$bb, n=4, cols=brewer.pal(4,'Blues'),cutter=quantile.cuts)
> ??? level.plot(gwr.res_a, index = "LTI", shades = gwr.shades)
>
> Any help would be gratefully received.
>
> Many thanks,
> M
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mathieu.rajerison at gmail.com  Tue Aug 16 09:33:24 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 16 Aug 2011 09:33:24 +0200
Subject: [R-sig-Geo] Segmentation of SpatialLines at Intersection
In-Reply-To: <CAAN3GgCN3okfqpqZp7XfarmknOqmzwkMGae+T9TcHnW0VqjM9Q@mail.gmail.com>
References: <CAAN3GgCN3okfqpqZp7XfarmknOqmzwkMGae+T9TcHnW0VqjM9Q@mail.gmail.com>
Message-ID: <CAGfc75nw0R4BKsWOQo1WEH=bzysKsw-jrsPBNrVWiuWfR2Vf8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110816/d3fde5b2/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Tue Aug 16 12:29:00 2011
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Tue, 16 Aug 2011 12:29:00 +0200
Subject: [R-sig-Geo] anisotropy modeling [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
	<8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
Message-ID: <4E4A466C.6040602@jrc.ec.europa.eu>

Hi Jin,

some comments below:

On 16-Aug-11 3:38, Jin.Li at ga.gov.au wrote:
> Hi All,
>
> Following Edzer's examples, I have tried to test the effects of the specification of alpha in variogram on the results of fit.variogram as below:
>
>>   v =  variogram(zinc~1,meuse)
>>   v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45)
>>   v90 =  variogram(zinc~1,meuse, alpha = 90, tol.hor = 45)
>>   v090 =  variogram(zinc~1,meuse, alpha=c(0, 90), tol.hor=45)
>>   v45135 =  variogram(zinc~1,meuse, alpha=c(45, 135), tol.hor=45)
>>   v2 =  variogram(zinc~1,meuse, alpha=c(0, 45, 90, 135), tol.hor=45)
>
>>    fit.variogram(v, vgm(1, "Exp", 300,  anis=c(90,1)))
>    model  psill    range
> 1   Exp 166238 323.6674
>>    fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model  psill    range ang1 anis1
> 1   Exp 166238 3236.674   90   0.1
>>    fit.variogram(v090, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 166262.4 3237.814   90   0.1
>>    fit.variogram(v45135, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 165919.4 3224.622   90   0.1
>>   fit.variogram(v2, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model  psill    range ang1 anis1
> 1   Exp 166091 3231.219   90   0.1
>
>
>>    fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 146068.7 2772.751   90   0.1
>>    fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 200767.2 4027.282   90   0.1
>
> Above results show that using v, v090, v45135 and v2 would produce similar results for anis=c(90, 0.1), suggesting that the specification of alpha in variogram is largely redundant, while using v0 and v90 produced very different results, suggesting a contrary. Could anyone shed a light on this? Thanks.
> Jin
>

I would not say that the last results are very different, if you plot 
e.g. v2 with the three last models:
m1 = fit.variogram(v2, vgm(1, "Exp", 300, anis=c(90,.1)))
m2 = fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
m3 = fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
plot(v2, m1)
plot(v2, m2)
plot(v2, m3)

you can see that all of them give quite similar fits to the variogram. 
Small fitted range comes together with small fitted psill, which means 
that their shapes will be rather similar. The reason for v0 and v90 
giving different fitted variograms is probably that these just use a 
part of the data set (the angles 0 and 90), whereas the other variograms 
use the complete data set.

For anisotropy modelling, you can also use the 
estimateAnistropy-function in the intamap-package:
 > estimateAnisotropy(meuse, "zinc")
$ratio
[1] 1.618686

$direction
[1] 48.54651

$Q
            Q11       Q22        Q12
[1,] 0.9195639 0.8232523 -0.3870018

$doRotation
[1] TRUE

where the ratio is the inverse (1/ratio) of the one used in gstat. 
Through interpolate with methodName = "automap" (or with 
estimateParameters and spatialPredict if you want to do the steps 
separately), you get a variogram model fitted to the anisotropic sample 
variogram with direction and ratio from estimateAnisotropy.

Cheers,
Jon


>
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
> Sent: Tuesday, 19 July 2011 5:59 PM
> To: shweta jp
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] anisotropy modeling
>
> The description says:
>
>    The automatic fitting is done through fit.variogram.
>
> estimateAnisotropy {intamap} does fit anistropy coefficients.
>
>
>
> On 07/18/2011 08:27 PM, shweta jp wrote:
>> Is the same true for autofitVariogram {automap} ?
>>
>> Shweta
>>
>> On Wed, Jul 13, 2011 at 1:13 PM, Edzer Pebesma<
>> edzer.pebesma at uni-muenster.de>  wrote:
>>
>>> help(fit.variogram) has the following description:
>>>
>>>      Fit ranges and/or sills from a simple or nested variogram model to
>>>      a sample variogram
>>>
>>> I suspected it would completely ignore anisotropy settings. However,
>>> this seems not to be the case:
>>>
>>>> library(gstat)
>>> Loading required package: sp
>>> Loading required package: spacetime
>>> Loading required package: zoo
>>> Loading required package: xts
>>>> loadMeuse()
>>>> v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45)
>>>> v90 = variogram(zinc~1,meuse, alpha = 90, tol.hor = 45)
>>>> v = variogram(zinc~1,meuse)
>>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,1)))
>>>   model  psill    range
>>> 1   Exp 166238 323.6674
>>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model  psill    range ang1 anis1
>>> 1   Exp 166238 3236.674   90   0.1
>>>> fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model    psill    range ang1 anis1
>>> 1   Exp 146068.7 2772.751   90   0.1
>>>> fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model    psill    range ang1 anis1
>>> 1   Exp 200767.2 4027.282   90   0.1
>>>
>>> On 07/13/2011 11:34 AM, Matev? Pavli? wrote:
>>>> Hi,
>>>>
>>>> thanks for the reply. Can you explain this a little bit more :
>>>> " it assumes the variogram to fit to is in the major (correlation)
>>> direction (or averaged over all directions)."
>>>> I don't know exactly ehat it means....
>>>> m
>>>>
>>>> -----Original Message-----
>>>> From: r-sig-geo-bounces at r-project.org [mailto:
>>> r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>> Sent: Wednesday, July 13, 2011 10:10 AM
>>>> To: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] anisotropy modeling
>>>>
>>>>
>>>>
>>>> On 07/12/2011 10:52 PM, Matev? Pavli? wrote:
>>>>> Hi all,
>>>>>
>>>>>
>>>>>
>>>>> i 'm am not entirely sure I understand anisotropy kriging in R.
>>>>>
>>>>> I have a data set in which is (at least i think so) anisotropy is
>>> clearly visible. So I made directional variograms....
>>>>> So as i understand, the only thing that is different from>normal<
>>> kriging is the>anis<  property in which you define the diffrenece of
>>> ranges? Is that coreect?
>>>> Yes. Please note that fit.variogram ignores anything about anisotropy, it
>>> assumes the variogram to fit to is in the major (correlation) direction (or
>>> averaged over all directions).
>>>>> Bellow is the code i use :
>>>>>
>>>>>
>>>>>
>>>>> a<-5000/7000
>>>>>
>>>>> print(plot(variogram(Z ~ 1, DF, map = TRUE, cutoff = 15000, width =
>>>>> 100), main = "Variogram map, podlaga",col.regions =
>>>>> terrain.colors(64)))
>>>>>
>>>>> v1.a<-variogram(Z~1, DF, alpha=c(45, 135))
>>>>>
>>>>> (vmf.a<- fit.variogram(v1.a, vgm(2900, "Pen", 5500, 300, anis =
>>>>> c(135, a))))
>>>>>
>>>>> print(plot(v1.a, pl = F, pch = 20, col = "blue"))
>>>>>
>>>>> print(plot(v1.a, plot.numbers = F, pch = 20, col = "darkblue", model =
>>>>> vmf.a))
>>>>>
>>>>>
>>>>>
>>>>> podlaga.aniso<-krige(Z~1, DF[-zerodist(DF)[,1],], grd, vmf.a )
>>>>>
>>>>> print(spplot(podlaga.aniso, zcol="var1.pred",
>>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>>> key.space="right"))
>>>>>
>>>>> print(spplot(podlaga.aniso,  zcol="var1.var",
>>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>>> key.space="right"))
>>>>>
>>>>> writeGDAL(podlaga.aniso, "podlaga_aniso.tif")
>>>>>
>>>>>
>>>>>
>>>>> thanks for info,
>>>>>
>>>>>
>>>>>
>>>>> m
>>>>>
>>>>>
>>>>>       [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
>>> http://ifgi.uni-muenster.de
>>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>


From sarah.papworth06 at imperial.ac.uk  Tue Aug 16 13:11:47 2011
From: sarah.papworth06 at imperial.ac.uk (Sarah Papworth)
Date: Tue, 16 Aug 2011 12:11:47 +0100
Subject: [R-sig-Geo] model comparisons ruf.fit
Message-ID: <CAF3P+na_Z-t=DjFs0StxRswcvqF_L23PHR-0iOOgRea7ma83JA@mail.gmail.com>

Hi,
I'm modelling resource use using ruf.fit, but I'm a little confused
about the Materns logLik / LS LogLik given by summary(model).

It seems that Materns logLik changes if I change the values for theta,
but stays fairly stable if I change the predictor variables. LS LogLik
stays the same with various values of theta, but changes when
predictor values do.

Presumably I use Materns logLik to find the best theta values (and
lower Materns' logLik suggests a better model??)
and LS Loglik to calculate AIC to compare the predictor variables?

Thanks in advance for any help,
Sarah
-- 
Imperial College London
http://www.iccs.org.uk/sarahpapworth.htm


From bart at njn.nl  Tue Aug 16 13:24:58 2011
From: bart at njn.nl (bart)
Date: Tue, 16 Aug 2011 13:24:58 +0200
Subject: [R-sig-Geo] Error when projecting polygons into Azimuthal
 Equidistant Projection
In-Reply-To: <alpine.LRH.2.00.1108151847120.13143@reclus.nhh.no>
References: <4E48F57B.9060804@njn.nl>
	<alpine.LRH.2.00.1108151847120.13143@reclus.nhh.no>
Message-ID: <4E4A538A.2040908@njn.nl>

Thank you very much for your answer Roger, but the problem is that i 
want to do this operation for a regular grid around the world. Meaning i 
will encounter the error in some places. As far as i understand the 
projection the distance and direction to other locations is only valid 
if lat_0 and lon_0 are the location of interest. So avoiding this 
projection is not an option.

Bart

On 08/15/2011 06:51 PM, Roger Bivand wrote:
> On Mon, 15 Aug 2011, bart wrote:
>
>> Hi All
>>
>> First a short introduction to what i'm trying to do, I'm trying to
>> find the length of a line going through a point intersecting with the
>> coast lines. My thought was to find the right polygon and then
>> re-project it to an Azimuthal Equidistant Projection on which an
>> intersection with the line could work using gIntersection from the
>> rgeos package.
>>
>> Some how re-projecting using spTransfrom invalidates the polygon. The
>> polygon starts intersecting with itself. Does anyone have any
>> suggestions?
>
> Your choice of +lon_0=-9 is unfortunate and flips Malaysia onto India;
> +lon_0=90 does not lead to meltdown. So it is an artefact of your choice
> of +lon_0 for this projection.
>
> Roger
>
>>
>> A small example to reproduce the problem:
>>
>> require(maps)
>> require(maptools)
>> require(rgeos)
>> require(rgdal)
>> a<-getRgshhsMap(xlim=c(-170, 180),ylim=c( -60,90))
>> a<-a[1]# get only eurasia
>> gIsValid(a)
>> plot(a)
>> transformed<-spTransform(a, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
>> gIsValid(transformed)
>> x<-9.35151 *10^6
>> y<-3.60185 *10^6
>> plot(transformed); axis(1); axis(2); points(x,y, col="red")
>> plot(transformed, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5));
>> axis(1); axis(2); points(x,y, col="red")
>>
>>
>> I tried interpolating the segments along a great circle route but that
>> did not help:
>>
>> require(geosphere)
>> ps<-as.data.frame(SpatialPolygons2PolySet(a))
>> ps<-ps[ps$SID==1,]
>> psnew<-as.data.frame(gcIntermediate(as.matrix(ps[-nrow(ps),c("X","Y")]),as.matrix(ps[-1,c("X","Y")]),
>> sepNA=TRUE, addStartEnd=TRUE, n=100))
>> psnew<-psnew[!is.na(psnew$lat),]
>> psnew<-psnew[!duplicated(psnew),]
>> names(psnew)<-c("X","Y")
>> psnew$PID<-1
>> psnew$POS<-1:nrow(psnew)
>> spnew<-PolySet2SpatialPolygons(as.PolySet(psnew,projection="LL"))
>> gIsValid(spnew)
>> sptra<-spTransform(spnew, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
>> x<-9.38019 *10^6
>> y<-3.55167 *10^6
>> plot(sptra); axis(1); axis(2); points(x,y, col="red")
>> plot(sptra, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); axis(1);
>> axis(2); points(x,y, col="red")
>> plot(sptra, xlim=x+c(-10^4, 10^4), ylim=y+c(-10^4, 10^4)); axis(1);
>> axis(2); points(x,y, col="red")
>> gIsValid(sptra)
>>
>> Thanks in advance for any tips
>>
>> Bart
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From julia.dechamps at jesus.ox.ac.uk  Tue Aug 16 15:07:18 2011
From: julia.dechamps at jesus.ox.ac.uk (Julia Dechamps)
Date: Tue, 16 Aug 2011 14:07:18 +0100
Subject: [R-sig-Geo] gstat: Variogram with non-Euclidean Distances
In-Reply-To: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>
References: <F9EB2235ED697C48BC07DCDC4DD85A492750F5DC1D@EXMBX06.ad.oak.ox.ac.uk>
Message-ID: <F9EB2235ED697C48BC07DCDC4DD85A492751DAD82D@EXMBX06.ad.oak.ox.ac.uk>

Ben and Luca,

Thank you very much for your advice and the references.

When using non-Euclidean distance I do precisely run into issue of obtaining non-positive definite correlation matrices,  so I might have to return to Euclidean distance...

Regards,
Julia


________________________________________
From: Julia Dechamps
Sent: 11 August 2011 10:29
To: r-sig-geo at r-project.org
Subject: gstat: Variogram with non-Euclidean Distances

Dear list,

I am wondering whether there is a way to use a contiguity-, graph- or knn-based measure of distance (similar the neighbourhood objects described in "Applied Spatial Data Analysis with R, ch.9.2.2-9.2.4), rather than Euclidean distance, to construct a variogram (in gstat or otherwise).

The observations I have are very unevenly spaced across a large geographic area and I therefore feel Euclidean distance might not be a good choice.

I have searched the web but unfortunately was not able to find any hints on how I might implement the above.

I would greatly appreciate any advice you might have.

Regards,
Julia


From Roger.Bivand at nhh.no  Tue Aug 16 15:31:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 16 Aug 2011 15:31:39 +0200
Subject: [R-sig-Geo] Error when projecting polygons into Azimuthal
 Equidistant Projection
In-Reply-To: <4E4A538A.2040908@njn.nl>
References: <4E48F57B.9060804@njn.nl>
	<alpine.LRH.2.00.1108151847120.13143@reclus.nhh.no>
	<4E4A538A.2040908@njn.nl>
Message-ID: <alpine.LRH.2.00.1108161524040.16439@reclus.nhh.no>

On Tue, 16 Aug 2011, bart wrote:

> Thank you very much for your answer Roger, but the problem is that i want to 
> do this operation for a regular grid around the world. Meaning i will 
> encounter the error in some places. As far as i understand the projection the 
> distance and direction to other locations is only valid if lat_0 and lon_0 
> are the location of interest. So avoiding this projection is not an option.

The underlying projection uses PROJ.4, as I'm sure you are aware. 
Consequently, you should probably choose a different projection, since 
+proj=aeqd will always fail in this way for your choice of +lon_0.

Could you extract the intersection points in rgeos in geographical 
coordinates, and, after finding the appropriate pairs, measure the 
distance with spDistsN1(..., longlat=TRUE)?

Roger

>
> Bart
>
> On 08/15/2011 06:51 PM, Roger Bivand wrote:
>> On Mon, 15 Aug 2011, bart wrote:
>> 
>>> Hi All
>>> 
>>> First a short introduction to what i'm trying to do, I'm trying to
>>> find the length of a line going through a point intersecting with the
>>> coast lines. My thought was to find the right polygon and then
>>> re-project it to an Azimuthal Equidistant Projection on which an
>>> intersection with the line could work using gIntersection from the
>>> rgeos package.
>>> 
>>> Some how re-projecting using spTransfrom invalidates the polygon. The
>>> polygon starts intersecting with itself. Does anyone have any
>>> suggestions?
>> 
>> Your choice of +lon_0=-9 is unfortunate and flips Malaysia onto India;
>> +lon_0=90 does not lead to meltdown. So it is an artefact of your choice
>> of +lon_0 for this projection.
>> 
>> Roger
>> 
>>> 
>>> A small example to reproduce the problem:
>>> 
>>> require(maps)
>>> require(maptools)
>>> require(rgeos)
>>> require(rgdal)
>>> a<-getRgshhsMap(xlim=c(-170, 180),ylim=c( -60,90))
>>> a<-a[1]# get only eurasia
>>> gIsValid(a)
>>> plot(a)
>>> transformed<-spTransform(a, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
>>> gIsValid(transformed)
>>> x<-9.35151 *10^6
>>> y<-3.60185 *10^6
>>> plot(transformed); axis(1); axis(2); points(x,y, col="red")
>>> plot(transformed, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5));
>>> axis(1); axis(2); points(x,y, col="red")
>>> 
>>> 
>>> I tried interpolating the segments along a great circle route but that
>>> did not help:
>>> 
>>> require(geosphere)
>>> ps<-as.data.frame(SpatialPolygons2PolySet(a))
>>> ps<-ps[ps$SID==1,]
>>> psnew<-as.data.frame(gcIntermediate(as.matrix(ps[-nrow(ps),c("X","Y")]),as.matrix(ps[-1,c("X","Y")]),
>>> sepNA=TRUE, addStartEnd=TRUE, n=100))
>>> psnew<-psnew[!is.na(psnew$lat),]
>>> psnew<-psnew[!duplicated(psnew),]
>>> names(psnew)<-c("X","Y")
>>> psnew$PID<-1
>>> psnew$POS<-1:nrow(psnew)
>>> spnew<-PolySet2SpatialPolygons(as.PolySet(psnew,projection="LL"))
>>> gIsValid(spnew)
>>> sptra<-spTransform(spnew, CRS("+proj=aeqd +lon_0=-9 +lat_0=39" ))
>>> x<-9.38019 *10^6
>>> y<-3.55167 *10^6
>>> plot(sptra); axis(1); axis(2); points(x,y, col="red")
>>> plot(sptra, xlim=x+c(-10^5, 10^5), ylim=y+c(-10^5, 10^5)); axis(1);
>>> axis(2); points(x,y, col="red")
>>> plot(sptra, xlim=x+c(-10^4, 10^4), ylim=y+c(-10^4, 10^4)); axis(1);
>>> axis(2); points(x,y, col="red")
>>> gIsValid(sptra)
>>> 
>>> Thanks in advance for any tips
>>> 
>>> Bart
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Tue Aug 16 15:43:48 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 16 Aug 2011 14:43:48 +0100
Subject: [R-sig-Geo] geo meetup at UseR! 2011
In-Reply-To: <CADLQFsPEapqjnMV4xP_Bq6gasB0wiA1mWKyZ97mE3W2D_hJ-+A@mail.gmail.com>
References: <CANVKczOLmL=Kt+gCBK5rEKqB-G1a=EO9qMwWHxJdksf+yuBVtA@mail.gmail.com>
	<CADLQFsPEapqjnMV4xP_Bq6gasB0wiA1mWKyZ97mE3W2D_hJ-+A@mail.gmail.com>
Message-ID: <CANVKczMWz4+zkuZ0s+wP+OnbgxhnV1QWitnofNCFMrEvk8bCDw@mail.gmail.com>

On Mon, Aug 15, 2011 at 10:26 PM, Pierre Roudier
<pierre.roudier at gmail.com> wrote:
> Hi Barry,
>
> I'll be happy to join :)
>
> I'm sure there's some more spatial useRs out there in Warwick at the moment,

 The R-sig-geo meetup will begin at Pierre Roudier's poster at the
poster session tonight, at 9pm. I dont see it in the programme so I
guess its a late-breaking poster, we'll have to search for it. First
person to find it please post coordinates.

Barry


From pierre.roudier at gmail.com  Tue Aug 16 15:55:48 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Tue, 16 Aug 2011 14:55:48 +0100
Subject: [R-sig-Geo] geo meetup at UseR! 2011
In-Reply-To: <CANVKczMWz4+zkuZ0s+wP+OnbgxhnV1QWitnofNCFMrEvk8bCDw@mail.gmail.com>
References: <CANVKczOLmL=Kt+gCBK5rEKqB-G1a=EO9qMwWHxJdksf+yuBVtA@mail.gmail.com>
	<CADLQFsPEapqjnMV4xP_Bq6gasB0wiA1mWKyZ97mE3W2D_hJ-+A@mail.gmail.com>
	<CANVKczMWz4+zkuZ0s+wP+OnbgxhnV1QWitnofNCFMrEvk8bCDw@mail.gmail.com>
Message-ID: <CADLQFsPpGiuq48XxJgpZNrg_o1_KNcJshrJDTaWADQCVvMPCag@mail.gmail.com>

Yes, it is a late-breaking poster (plotKML: a framework for
visualization of space-time data). Blue with some Google Earth
screenshots on it - that hopefully would appeal to the R-spatial
enthusiasts :)

See you there,

Pierre

2011/8/16 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> On Mon, Aug 15, 2011 at 10:26 PM, Pierre Roudier
> <pierre.roudier at gmail.com> wrote:
>> Hi Barry,
>>
>> I'll be happy to join :)
>>
>> I'm sure there's some more spatial useRs out there in Warwick at the moment,
>
> ?The R-sig-geo meetup will begin at Pierre Roudier's poster at the
> poster session tonight, at 9pm. I dont see it in the programme so I
> guess its a late-breaking poster, we'll have to search for it. First
> person to find it please post coordinates.
>
> Barry
>



-- 
Scientist
Landcare Research, New Zealand


From juta.kawalerowicz at stx.ox.ac.uk  Tue Aug 16 17:17:01 2011
From: juta.kawalerowicz at stx.ox.ac.uk (majesty)
Date: Tue, 16 Aug 2011 08:17:01 -0700 (PDT)
Subject: [R-sig-Geo] merging polygons by indices
Message-ID: <1313507821817-6691746.post@n2.nabble.com>

Dear R-sig-geo subscribers, 

I have the following problem, would be grateful for suggestions. I am doing
a research on UK output areas, My .shp file contains output areas for UK but
there are some duplicates. when I type
which(duplicated(shape$output_area)==TRUE) I get indices of 67 duplicates:

[1] 165713 165723 165724 165786 165788 165814 165815 165819 165820 165821
[11] 165822 165827 165900 165974 165978 165985 165989 166132 166142 166300
 
... and so on

I would like to merge them with the output area polygons of the first
original instance of a given output_area, so that for instance I would merge
16712 with 165713 and 165722 with 165723, etc. 

I know I should use unionSpatialPolygons() function from maptools but how to
do it if I want to merge only particular indices (of which I have a list)?

Any input would be appreciated, 
Thanks, 

Juta

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/merging-polygons-by-indices-tp6691746p6691746.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Tue Aug 16 17:45:24 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 16 Aug 2011 17:45:24 +0200 (CEST)
Subject: [R-sig-Geo] merging polygons by indices
In-Reply-To: <1313507821817-6691746.post@n2.nabble.com>
References: <1313507821817-6691746.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1108161743300.16822@reclus.nhh.no>

On Tue, 16 Aug 2011, majesty wrote:

> Dear R-sig-geo subscribers,
>
> I have the following problem, would be grateful for suggestions. I am doing
> a research on UK output areas, My .shp file contains output areas for UK but
> there are some duplicates. when I type
> which(duplicated(shape$output_area)==TRUE) I get indices of 67 duplicates:
>
> [1] 165713 165723 165724 165786 165788 165814 165815 165819 165820 165821
> [11] 165822 165827 165900 165974 165978 165985 165989 166132 166142 166300
>
> ... and so on
>
> I would like to merge them with the output area polygons of the first
> original instance of a given output_area, so that for instance I would merge
> 16712 with 165713 and 165722 with 165723, etc.
>
> I know I should use unionSpatialPolygons() function from maptools but how to
> do it if I want to merge only particular indices (of which I have a list)?

If there is only one Polygons object to be merged, unionSpatialPolygons() 
should just pass it through, so you should be able to use it as it stands. 
Otherwise, you'd have to subset to the group to be treated or not, and 
combine them afterwards.

Roger

>
> Any input would be appreciated,
> Thanks,
>
> Juta
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/merging-polygons-by-indices-tp6691746p6691746.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From juta.kawalerowicz at stx.ox.ac.uk  Tue Aug 16 19:50:08 2011
From: juta.kawalerowicz at stx.ox.ac.uk (majesty)
Date: Tue, 16 Aug 2011 10:50:08 -0700 (PDT)
Subject: [R-sig-Geo] merging polygons by indices
In-Reply-To: <alpine.LRH.2.00.1108161743300.16822@reclus.nhh.no>
References: <1313507821817-6691746.post@n2.nabble.com>
	<alpine.LRH.2.00.1108161743300.16822@reclus.nhh.no>
Message-ID: <1313517008318-6692261.post@n2.nabble.com>

still I am not quiet sure how to achieve this by manipulation of ID. Could
you give an example, say I have 5 polygons in my shapefile shape.shp but
would like to have 4 polygons, where shape[2] is merged with shape[3]. I am
somewhat clueless because ID has to be of equal in length to polygons slot
(in my case 5)

Thanks, 

Juta Kawalerowicz


MPhil Candidate in Sociology
Oxford University


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/merging-polygons-by-indices-tp6691746p6692261.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Aug 17 00:27:32 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 17 Aug 2011 00:27:32 +0200 (CEST)
Subject: [R-sig-Geo] merging polygons by indices
In-Reply-To: <1313517008318-6692261.post@n2.nabble.com>
References: <1313507821817-6691746.post@n2.nabble.com>
	<alpine.LRH.2.00.1108161743300.16822@reclus.nhh.no>
	<1313517008318-6692261.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1108170022480.17570@reclus.nhh.no>

On Tue, 16 Aug 2011, majesty wrote:

> still I am not quiet sure how to achieve this by manipulation of ID. Could
> you give an example, say I have 5 polygons in my shapefile shape.shp but
> would like to have 4 polygons, where shape[2] is merged with shape[3]. I am
> somewhat clueless because ID has to be of equal in length to polygons slot
> (in my case 5)

So maybe try:

shape1 <- unionSpatialPolygons(shape, IDs=as.character(shape$output_area))

which will copy across the unchanged entities, and join the ones with 
multiple output_area IDs. Note that the only way to retrieve the IDs will 
be row.names(shape1), as the function doesn't aggregate other data in 
shape.

Hope this helps,

Roger

>
> Thanks,
>
> Juta Kawalerowicz
>
>
> MPhil Candidate in Sociology
> Oxford University
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/merging-polygons-by-indices-tp6691746p6692261.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Jin.Li at ga.gov.au  Wed Aug 17 03:17:39 2011
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Wed, 17 Aug 2011 11:17:39 +1000
Subject: [R-sig-Geo] anisotropy modeling [SEC=UNCLASSIFIED]
In-Reply-To: <4E4A466C.6040602@jrc.ec.europa.eu>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
	<8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
	<4E4A466C.6040602@jrc.ec.europa.eu>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E349943529AA@EXCCR01.agso.gov.au>

Hi Jon,
Thanks for your kind comments. 
The shape was indeed not expected to change much as the same variogram model (i.e., exp) was used.
Cheers,
Jin
-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Jon Olav Skoien
Sent: Tuesday, 16 August 2011 8:29 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] anisotropy modeling [SEC=UNCLASSIFIED]

Hi Jin,

some comments below:

On 16-Aug-11 3:38, Jin.Li at ga.gov.au wrote:
> Hi All,
>
> Following Edzer's examples, I have tried to test the effects of the specification of alpha in variogram on the results of fit.variogram as below:
>
>>   v =  variogram(zinc~1,meuse)
>>   v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45)
>>   v90 =  variogram(zinc~1,meuse, alpha = 90, tol.hor = 45)
>>   v090 =  variogram(zinc~1,meuse, alpha=c(0, 90), tol.hor=45)
>>   v45135 =  variogram(zinc~1,meuse, alpha=c(45, 135), tol.hor=45)
>>   v2 =  variogram(zinc~1,meuse, alpha=c(0, 45, 90, 135), tol.hor=45)
>
>>    fit.variogram(v, vgm(1, "Exp", 300,  anis=c(90,1)))
>    model  psill    range
> 1   Exp 166238 323.6674
>>    fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model  psill    range ang1 anis1
> 1   Exp 166238 3236.674   90   0.1
>>    fit.variogram(v090, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 166262.4 3237.814   90   0.1
>>    fit.variogram(v45135, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 165919.4 3224.622   90   0.1
>>   fit.variogram(v2, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model  psill    range ang1 anis1
> 1   Exp 166091 3231.219   90   0.1
>
>
>>    fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 146068.7 2772.751   90   0.1
>>    fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
>    model    psill    range ang1 anis1
> 1   Exp 200767.2 4027.282   90   0.1
>
> Above results show that using v, v090, v45135 and v2 would produce similar results for anis=c(90, 0.1), suggesting that the specification of alpha in variogram is largely redundant, while using v0 and v90 produced very different results, suggesting a contrary. Could anyone shed a light on this? Thanks.
> Jin
>

I would not say that the last results are very different, if you plot 
e.g. v2 with the three last models:
m1 = fit.variogram(v2, vgm(1, "Exp", 300, anis=c(90,.1)))
m2 = fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
m3 = fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
plot(v2, m1)
plot(v2, m2)
plot(v2, m3)

you can see that all of them give quite similar fits to the variogram. 
Small fitted range comes together with small fitted psill, which means 
that their shapes will be rather similar. The reason for v0 and v90 
giving different fitted variograms is probably that these just use a 
part of the data set (the angles 0 and 90), whereas the other variograms 
use the complete data set.

For anisotropy modelling, you can also use the 
estimateAnistropy-function in the intamap-package:
 > estimateAnisotropy(meuse, "zinc")
$ratio
[1] 1.618686

$direction
[1] 48.54651

$Q
            Q11       Q22        Q12
[1,] 0.9195639 0.8232523 -0.3870018

$doRotation
[1] TRUE

where the ratio is the inverse (1/ratio) of the one used in gstat. 
Through interpolate with methodName = "automap" (or with 
estimateParameters and spatialPredict if you want to do the steps 
separately), you get a variogram model fitted to the anisotropic sample 
variogram with direction and ratio from estimateAnisotropy.

Cheers,
Jon


>
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
> Sent: Tuesday, 19 July 2011 5:59 PM
> To: shweta jp
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] anisotropy modeling
>
> The description says:
>
>    The automatic fitting is done through fit.variogram.
>
> estimateAnisotropy {intamap} does fit anistropy coefficients.
>
>
>
> On 07/18/2011 08:27 PM, shweta jp wrote:
>> Is the same true for autofitVariogram {automap} ?
>>
>> Shweta
>>
>> On Wed, Jul 13, 2011 at 1:13 PM, Edzer Pebesma<
>> edzer.pebesma at uni-muenster.de>  wrote:
>>
>>> help(fit.variogram) has the following description:
>>>
>>>      Fit ranges and/or sills from a simple or nested variogram model to
>>>      a sample variogram
>>>
>>> I suspected it would completely ignore anisotropy settings. However,
>>> this seems not to be the case:
>>>
>>>> library(gstat)
>>> Loading required package: sp
>>> Loading required package: spacetime
>>> Loading required package: zoo
>>> Loading required package: xts
>>>> loadMeuse()
>>>> v0 = variogram(zinc~1,meuse, alpha = 0, tol.hor = 45)
>>>> v90 = variogram(zinc~1,meuse, alpha = 90, tol.hor = 45)
>>>> v = variogram(zinc~1,meuse)
>>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,1)))
>>>   model  psill    range
>>> 1   Exp 166238 323.6674
>>>> fit.variogram(v, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model  psill    range ang1 anis1
>>> 1   Exp 166238 3236.674   90   0.1
>>>> fit.variogram(v0, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model    psill    range ang1 anis1
>>> 1   Exp 146068.7 2772.751   90   0.1
>>>> fit.variogram(v90, vgm(1, "Exp", 300, anis=c(90,.1)))
>>>   model    psill    range ang1 anis1
>>> 1   Exp 200767.2 4027.282   90   0.1
>>>
>>> On 07/13/2011 11:34 AM, Matev? Pavli? wrote:
>>>> Hi,
>>>>
>>>> thanks for the reply. Can you explain this a little bit more :
>>>> " it assumes the variogram to fit to is in the major (correlation)
>>> direction (or averaged over all directions)."
>>>> I don't know exactly ehat it means....
>>>> m
>>>>
>>>> -----Original Message-----
>>>> From: r-sig-geo-bounces at r-project.org [mailto:
>>> r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>> Sent: Wednesday, July 13, 2011 10:10 AM
>>>> To: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] anisotropy modeling
>>>>
>>>>
>>>>
>>>> On 07/12/2011 10:52 PM, Matev? Pavli? wrote:
>>>>> Hi all,
>>>>>
>>>>>
>>>>>
>>>>> i 'm am not entirely sure I understand anisotropy kriging in R.
>>>>>
>>>>> I have a data set in which is (at least i think so) anisotropy is
>>> clearly visible. So I made directional variograms....
>>>>> So as i understand, the only thing that is different from>normal<
>>> kriging is the>anis<  property in which you define the diffrenece of
>>> ranges? Is that coreect?
>>>> Yes. Please note that fit.variogram ignores anything about anisotropy, it
>>> assumes the variogram to fit to is in the major (correlation) direction (or
>>> averaged over all directions).
>>>>> Bellow is the code i use :
>>>>>
>>>>>
>>>>>
>>>>> a<-5000/7000
>>>>>
>>>>> print(plot(variogram(Z ~ 1, DF, map = TRUE, cutoff = 15000, width =
>>>>> 100), main = "Variogram map, podlaga",col.regions =
>>>>> terrain.colors(64)))
>>>>>
>>>>> v1.a<-variogram(Z~1, DF, alpha=c(45, 135))
>>>>>
>>>>> (vmf.a<- fit.variogram(v1.a, vgm(2900, "Pen", 5500, 300, anis =
>>>>> c(135, a))))
>>>>>
>>>>> print(plot(v1.a, pl = F, pch = 20, col = "blue"))
>>>>>
>>>>> print(plot(v1.a, plot.numbers = F, pch = 20, col = "darkblue", model =
>>>>> vmf.a))
>>>>>
>>>>>
>>>>>
>>>>> podlaga.aniso<-krige(Z~1, DF[-zerodist(DF)[,1],], grd, vmf.a )
>>>>>
>>>>> print(spplot(podlaga.aniso, zcol="var1.pred",
>>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>>> key.space="right"))
>>>>>
>>>>> print(spplot(podlaga.aniso,  zcol="var1.var",
>>>>> col.regions=terrain.colors(64), contour=T, pretty=T, cuts=15,
>>>>> key.space="right"))
>>>>>
>>>>> writeGDAL(podlaga.aniso, "podlaga_aniso.tif")
>>>>>
>>>>>
>>>>>
>>>>> thanks for info,
>>>>>
>>>>>
>>>>>
>>>>> m
>>>>>
>>>>>
>>>>>       [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
>>> http://ifgi.uni-muenster.de
>>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jianyun.fred.wu at gmail.com  Wed Aug 17 05:45:05 2011
From: jianyun.fred.wu at gmail.com (Jianyun Wu)
Date: Wed, 17 Aug 2011 13:45:05 +1000
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
Message-ID: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/89ccf9a6/attachment.pl>

From mdsumner at gmail.com  Wed Aug 17 08:38:54 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 17 Aug 2011 16:38:54 +1000
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
Message-ID: <CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>

At a guess, for a given latitude you could do this where "x" is a
data.frame with columns Longitude, Latitude, Time1, ..., TimeN

x1 <- x["Latitude" == -29, ]

## very simplistically

## drop Latitude, and order by Longitude (assuming Time columns are in
the right order)
x2 <- as.matrix(x1[order(x1$Longitude),  -2]

image(x2)

## with a bit more work, but big assumptions

lon <- sort(x1$Longitude)
tm <- as.numeric(colnames(x2)[-1])

image(lon, tm, x2, main = "Latitude -29", xlab = "Longitude", ylab = "Time")


There's a lot of guessing here for us, can you describe the file more
exactly or provide a link to at least one latitude's worth?

The Spatial classes in sp provide much more structured support for
these grids, and the spacetime package even more for generalizing
further - but they rely on exactly regular grids, which it looks like
you have here.

Cheers, Mike.


On Wed, Aug 17, 2011 at 1:45 PM, Jianyun Wu <jianyun.fred.wu at gmail.com> wrote:
> Dear Experts,
>
> I am trying to plot the Hovmueller Diagram (example below), which is time
> vs. longitude in R.
>
> http://www.esrl.noaa.gov/psd/cgi-bin/hovmoller/timeplot.pl?var=air&level=1000&mon1=1&mon2=1&dy1=1&dy2=31&yr1=2010&yr2=2011&datatype=operational&type=mean&fxdlon=no&postscript=no&lon1=&lon2=&lat1=&lat2=&cint=&lowr=&highr=&size=100&Submit=Create+Plot
>
> But I couldn't make it work at the moment. Could anyone please suggest me
> which package or function in R can plot such a graph?
>
> The data file on hand is like:
>
> Longtitude ? Latitude ? Time1.....................TimeN
> ? 124 ? ? ? ? ? ?-29
> ? 126 ? ? ? ? ? ?-29 ? ? ? ? ?.......................................
> ? 128 ? ? ? ? ? ?-29
> ? ? .. ? ? ? ? ? ? . .
>
> 2520 spatial locations corresponding to an 84 (longitude) by 30 (latitude)
> grid with 2 degree x 2 degree spacing.
>
> Thank and Regards
>
> Fred
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From jianyun.fred.wu at gmail.com  Wed Aug 17 08:53:15 2011
From: jianyun.fred.wu at gmail.com (Jianyun Wu)
Date: Wed, 17 Aug 2011 16:53:15 +1000
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
Message-ID: <CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/922ce9de/attachment.pl>

From aortizbobea at arec.umd.edu  Wed Aug 17 08:58:44 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Tue, 16 Aug 2011 23:58:44 -0700 (PDT)
Subject: [R-sig-Geo] issue importing GRIB1 data with readGDAL
Message-ID: <1313564323700-6694423.post@n2.nabble.com>

Hello everyone,

This is my first post. Thank you in advance for your guidance... 

I would like to combine/overlay/plot together:

1- weather data in GRIB1 format that I'm importing using the "readGDAL"
function (from where I get a "SpatialGridDataFrame" object)

2- political spatial boundaries (counties) from US county shape files (from
where I get a "SpatialPolygonsDataFrame" object)

When trying to plot both objects together I am aware I should have:

1- the same projection (in this case it was obtained directly from readGDAL
when reading the GRIB file: /[+proj=lcc +lat_1=50 +lat_2=50 +lat_0=0
+lon_0=-107 +x_0=0 +y_0=0 +a=6371200 +b=6371200 +units=m +no_defs]/)

2- and the same bounding box (bbox).

The bbox for the Polygons (counties) has coordinates in degrees:
  /       min       max
x -179.14734 179.77847
y   17.88481  71.35256 /

HOWEVER, the bbox for the Grids (weather data) has very odd-looking
coordinates:
/       min     max
x -2061758 4300990
y  3454505 7025435/

These are obviously not degrees... in fact this should read something in the
range of 65W-125W (i.e. x  -125 -65) and 25N-50N (i.e. y   25     50)
corresponding to the lower 48 US States.

As expected, when I try to use "image" (for the grid) followed by "plot"
(for the polygons) the county boundaries/lines don't overlay. So I fear it
is the mismatch between the bbox, stemming from these strange coordinates.

I did some basic introspection in GrADS (I'm new to it) and got some
metadata for the first variable/band (in bold what I consider relevant):

/rec 1:0:date 1985120100 TSOIL kpds5=85 kpds6=112 kpds7=10 levels=(0,10)
grid=255 0-10 cm down anl:
  TSOIL=Soil temp. [K]
  timerange 0 P1 0 P2 0 TimeU 1  nx 196 ny 110 GDS grid 3 num_in_ave 0
missing 0
  center 7 subcenter 15 process 140 Table 131 scan: WE:SN winds(N/S) 
  *Lambert Conf: Lat1 23.705000 Lon1 -125.624000 Lov -107.000000
      Latin1 50.000000 Latin2 50.000000 LatSP 0.000000 LonSP 0.000000*
      North Pole (196 x 110) Dx 32.463000 Dy 32.463000 scan 64 mode 0
  min/max data 248.435 307.56  num bits 10  BDS_Ref 248.435  DecScale 0
BinScale -4/

It seems that something went wrong when importing the GRIB data into R.
Could someone please offer some guidance on how to go about this? 

THANK YOU in advance for your time. 

Ariel

--------
Files and R code:

Test GRIB1 file: http://dss.ucar.edu/download/chifan/test.grb
Shape file: http://www.census.gov/geo/cob/bdy/co/co00shp/co99_d00_shp.zip

test 	<- readGDAL("test.grb")
counties <- readShapePoly("co99_d00.shp", proj4string = CRS(
proj4string(test) ) )

summary(test)
summary(counties)

image(test, attr=2) # map shows up with grid
plot(counties, xlim=c(bbox(test)[1,1], bbox(test)[1,2]), ylim =
c(bbox(test)[2,1], bbox(test)[2,2]), add=TRUE) # nothing shows up on top of
previous map

-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/issue-importing-GRIB1-data-with-readGDAL-tp6694423p6694423.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Aug 17 09:13:16 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 17 Aug 2011 09:13:16 +0200 (CEST)
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108170859570.19139@reclus.nhh.no>

On Wed, 17 Aug 2011, Jianyun Wu wrote:

> Hi Michael,
> Thanks for the reply.
> The data file can be rechieved from the following link:
>
> ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data

>From Edzer Pebesma's notes in demo/CressieWikle.R in spacetime for the 
equator:

library(spacetime)
sst <- as.matrix(read.table("SST011970_032003.dat", header = FALSE))
sst.ll <- as.matrix(read.table("SSTlonlat.dat", header = FALSE))
sst.ll <- SpatialPoints(sst.ll)
proj4string(sst.ll) <- CRS("+proj=longlat +datum=WGS84")
gridded(sst.ll) <- TRUE
sst.y <- rep(1970:2003, each = 12, length.out = 399)
sst.m <- rep(1:12, length.out = 399)
sst.Date <- as.Date(paste(sst.y, sst.m, "01", sep="-"), "%Y-%m-%d")
sst.st <- STFDF(sst.ll, sst.Date, data.frame(sst = as.vector(sst)))
# note that the Spatial slot of this object does not need to be a
# regular grid, any Spatial* object will do; same for the time slot
# see the spacetime vignette
library(rgeos)
# choose latitude
lat <- 0
eq <- SpatialLines(list(Lines(list(Line(rbind(c(0, lat), c(360, lat)))), 
"equator")), CRS(proj4string(sst.st)))
# subset by overlaying latitude line across the grid using rgeos
stplot(sst.st[eq, "1996::2003", drop=F], mode = "xt", 
col.regions=bpy.colors(), cuts = 32, main="Figure 5.1", xlab="Longitude", 
ylab = "Time (Year)", scaleX=1)

Other examples for visualizing figures from Cressie & Wikle (2011) are 
included in the file.

Hope this helps,

Roger

>
> SST011970_032003.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SST011970_032003.dat>
> SSTdata_descrip.txt<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTdata_descrip.txt>
> SSTlandmask.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlandmask.dat>
> SSTlonlat.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlonlat.dat>
> I will try the suggestion you provided, and wait for further comments.
>
> Thank you very much
>
> Fred
>
> On Wed, Aug 17, 2011 at 4:38 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>
>> At a guess, for a given latitude you could do this where "x" is a
>> data.frame with columns Longitude, Latitude, Time1, ..., TimeN
>>
>> x1 <- x["Latitude" == -29, ]
>>
>> ## very simplistically
>>
>> ## drop Latitude, and order by Longitude (assuming Time columns are in
>> the right order)
>> x2 <- as.matrix(x1[order(x1$Longitude),  -2]
>>
>> image(x2)
>>
>> ## with a bit more work, but big assumptions
>>
>> lon <- sort(x1$Longitude)
>> tm <- as.numeric(colnames(x2)[-1])
>>
>> image(lon, tm, x2, main = "Latitude -29", xlab = "Longitude", ylab =
>> "Time")
>>
>>
>> There's a lot of guessing here for us, can you describe the file more
>> exactly or provide a link to at least one latitude's worth?
>>
>> The Spatial classes in sp provide much more structured support for
>> these grids, and the spacetime package even more for generalizing
>> further - but they rely on exactly regular grids, which it looks like
>> you have here.
>>
>> Cheers, Mike.
>>
>>
>> On Wed, Aug 17, 2011 at 1:45 PM, Jianyun Wu <jianyun.fred.wu at gmail.com>
>> wrote:
>>> Dear Experts,
>>>
>>> I am trying to plot the Hovmueller Diagram (example below), which is time
>>> vs. longitude in R.
>>>
>>>
>> http://www.esrl.noaa.gov/psd/cgi-bin/hovmoller/timeplot.pl?var=air&level=1000&mon1=1&mon2=1&dy1=1&dy2=31&yr1=2010&yr2=2011&datatype=operational&type=mean&fxdlon=no&postscript=no&lon1=&lon2=&lat1=&lat2=&cint=&lowr=&highr=&size=100&Submit=Create+Plot
>>>
>>> But I couldn't make it work at the moment. Could anyone please suggest me
>>> which package or function in R can plot such a graph?
>>>
>>> The data file on hand is like:
>>>
>>> Longtitude   Latitude   Time1.....................TimeN
>>>   124            -29
>>>   126            -29          .......................................
>>>   128            -29
>>>     ..             . .
>>>
>>> 2520 spatial locations corresponding to an 84 (longitude) by 30
>> (latitude)
>>> grid with 2 degree x 2 degree spacing.
>>>
>>> Thank and Regards
>>>
>>> Fred
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Wed Aug 17 09:13:59 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 17 Aug 2011 17:13:59 +1000
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
Message-ID: <CAAcGz9_QWJS12xRqj3ooiVvC-dp3SLmAhg5Yr4Nw+E3gHKgT-Q@mail.gmail.com>

Here's an update using the two files you need at a minimum:


## read the entire matrix file
x <- as.matrix(read.table("SST011970_032003.dat"))

## read the coordinates

lonlat <- read.table("SSTlonlat.dat")
names(lonlat) <- c("Longitude", "Latitude")

## choose just one lat
x1 <- x[lonlat$Latitude == -29, ]

ll <- lonlat[lonlat$Latitude == -29, ]

lon <- sort(ll$Longitude)
x2 <- x1[order(ll$Longitude), ]

tm <- 1:ncol(x1)

image(lon, tm, x2, main = "Latitude -29", xlab = "Longitude", ylab =
"Time", useRaster = TRUE, col = rainbow(28))

I will try to have a closer look later to get all the information
available. Please treat this with a grain of salt for now, and ignore
my previous guesses.

Cheers, Mike.

On Wed, Aug 17, 2011 at 4:53 PM, Jianyun Wu <jianyun.fred.wu at gmail.com> wrote:
> Hi Michael,
> Thanks for the reply.
> The data file can be rechieved from the following link:
>
> ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data
>
> SST011970_032003.dat
> SSTdata_descrip.txt
> SSTlandmask.dat
> SSTlonlat.dat
> I will try the suggestion you provided, and wait for further comments.
>
> Thank you very much
>
> Fred
> On Wed, Aug 17, 2011 at 4:38 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>>
>> At a guess, for a given latitude you could do this where "x" is a
>> data.frame with columns Longitude, Latitude, Time1, ..., TimeN
>>
>> x1 <- x["Latitude" == -29, ]
>>
>> ## very simplistically
>>
>> ## drop Latitude, and order by Longitude (assuming Time columns are in
>> the right order)
>> x2 <- as.matrix(x1[order(x1$Longitude), ?-2]
>>
>> image(x2)
>>
>> ## with a bit more work, but big assumptions
>>
>> lon <- sort(x1$Longitude)
>> tm <- as.numeric(colnames(x2)[-1])
>>
>> image(lon, tm, x2, main = "Latitude -29", xlab = "Longitude", ylab =
>> "Time")
>>
>>
>> There's a lot of guessing here for us, can you describe the file more
>> exactly or provide a link to at least one latitude's worth?
>>
>> The Spatial classes in sp provide much more structured support for
>> these grids, and the spacetime package even more for generalizing
>> further - but they rely on exactly regular grids, which it looks like
>> you have here.
>>
>> Cheers, Mike.
>>
>>
>> On Wed, Aug 17, 2011 at 1:45 PM, Jianyun Wu <jianyun.fred.wu at gmail.com>
>> wrote:
>> > Dear Experts,
>> >
>> > I am trying to plot the Hovmueller Diagram (example below), which is
>> > time
>> > vs. longitude in R.
>> >
>> >
>> > http://www.esrl.noaa.gov/psd/cgi-bin/hovmoller/timeplot.pl?var=air&level=1000&mon1=1&mon2=1&dy1=1&dy2=31&yr1=2010&yr2=2011&datatype=operational&type=mean&fxdlon=no&postscript=no&lon1=&lon2=&lat1=&lat2=&cint=&lowr=&highr=&size=100&Submit=Create+Plot
>> >
>> > But I couldn't make it work at the moment. Could anyone please suggest
>> > me
>> > which package or function in R can plot such a graph?
>> >
>> > The data file on hand is like:
>> >
>> > Longtitude ? Latitude ? Time1.....................TimeN
>> > ? 124 ? ? ? ? ? ?-29
>> > ? 126 ? ? ? ? ? ?-29 ? ? ? ? ?.......................................
>> > ? 128 ? ? ? ? ? ?-29
>> > ? ? .. ? ? ? ? ? ? . .
>> >
>> > 2520 spatial locations corresponding to an 84 (longitude) by 30
>> > (latitude)
>> > grid with 2 degree x 2 degree spacing.
>> >
>> > Thank and Regards
>> >
>> > Fred
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From jianyun.fred.wu at gmail.com  Wed Aug 17 09:20:52 2011
From: jianyun.fred.wu at gmail.com (Jianyun Wu)
Date: Wed, 17 Aug 2011 17:20:52 +1000
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <alpine.LRH.2.00.1108170859570.19139@reclus.nhh.no>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
	<alpine.LRH.2.00.1108170859570.19139@reclus.nhh.no>
Message-ID: <CAOMGRDJ-sfe4q14FCMO8rM2tJV3Y9Ct9R5Oc2Zqc-UgLZ1rxnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/b674f771/attachment.pl>

From cam.plouffe at gmail.com  Wed Aug 17 16:34:56 2011
From: cam.plouffe at gmail.com (Cam Plouffe)
Date: Wed, 17 Aug 2011 10:34:56 -0400
Subject: [R-sig-Geo] Segmentation of SpatialLines at Intersection
In-Reply-To: <CAGfc75nw0R4BKsWOQo1WEH=bzysKsw-jrsPBNrVWiuWfR2Vf8g@mail.gmail.com>
References: <CAAN3GgCN3okfqpqZp7XfarmknOqmzwkMGae+T9TcHnW0VqjM9Q@mail.gmail.com>
	<CAGfc75nw0R4BKsWOQo1WEH=bzysKsw-jrsPBNrVWiuWfR2Vf8g@mail.gmail.com>
Message-ID: <CAAN3GgDE+BL5d_YFm3td6eQfq165+aVpb+xaJEQbzOXzQcGRFA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/dd0f5750/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Aug 17 16:56:14 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 17 Aug 2011 16:56:14 +0200
Subject: [R-sig-Geo] Segmentation of SpatialLines at Intersection
In-Reply-To: <CAAN3GgDE+BL5d_YFm3td6eQfq165+aVpb+xaJEQbzOXzQcGRFA@mail.gmail.com>
References: <CAAN3GgCN3okfqpqZp7XfarmknOqmzwkMGae+T9TcHnW0VqjM9Q@mail.gmail.com>
	<CAGfc75nw0R4BKsWOQo1WEH=bzysKsw-jrsPBNrVWiuWfR2Vf8g@mail.gmail.com>
	<CAAN3GgDE+BL5d_YFm3td6eQfq165+aVpb+xaJEQbzOXzQcGRFA@mail.gmail.com>
Message-ID: <CAGfc75=FFqFctrm0Eg3n67x18p=rady+7vqaCM1N3HwWvGp-=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/f6c74414/attachment.pl>

From calamita_giuseppe at yahoo.it  Wed Aug 17 17:37:58 2011
From: calamita_giuseppe at yahoo.it (giuseppe calamita)
Date: Wed, 17 Aug 2011 16:37:58 +0100 (BST)
Subject: [R-sig-Geo] more Geostat classes
In-Reply-To: <mailman.4.1313402403.30134.r-sig-geo@r-project.org>
References: <mailman.4.1313402403.30134.r-sig-geo@r-project.org>
Message-ID: <1313595478.33546.YahooMailNeo@web25904.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/09d1c77b/attachment.pl>

From r.hijmans at gmail.com  Wed Aug 17 18:49:48 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Aug 2011 09:49:48 -0700
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAOMGRDJ-sfe4q14FCMO8rM2tJV3Y9Ct9R5Oc2Zqc-UgLZ1rxnQ@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
	<alpine.LRH.2.00.1108170859570.19139@reclus.nhh.no>
	<CAOMGRDJ-sfe4q14FCMO8rM2tJV3Y9Ct9R5Oc2Zqc-UgLZ1rxnQ@mail.gmail.com>
Message-ID: <CANtt_hw8dxKq5jQ+Q3fHiwHou50o_fP2yDcWnajRiWHPWpYoeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/b50d361b/attachment.pl>

From oscar.perpinan at upm.es  Wed Aug 17 23:03:36 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Wed, 17 Aug 2011 23:03:36 +0200
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
Message-ID: <20110817230336.68139c95@upm.es>

Hi,

You will find a hovmoller function in the rasterVis package:
http://rastervis.r-forge.r-project.org/

With your data:

library(raster)
library(rasterVis)

dat <- read.table('SST011970_032003.dat', header=FALSE)
loc <- read.table('SSTlonlat.dat', header=FALSE)
rasterList <- lapply(dat, function(x)raster(matrix(x, nrow=84, ncol=30),
                                            xmn=min(loc[[1]]),
                                            xmx=max(loc[[1]]),
                                            ymn=min(loc[[2]]),
                                            ymx=max(loc[[2]]),
                                            crs=CRS("+proj=longlat
                                            +datum=WGS84"))) 
s <- stack(rasterList) 
idx <- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month') 
s <- setZ(s, idx)

hovmoller(s)

Best,

Oscar.



-------------
Oscar Perpi??n Lamigueiro
Dpto. de Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com

 El Wed, 17 Aug 2011 16:53:15 +1000
Jianyun Wu <jianyun.fred.wu at gmail.com> escribi?:
> Hi Michael,
> Thanks for the reply.
> The data file can be rechieved from the following link:
> 
> ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data
> 
> SST011970_032003.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SST011970_032003.dat>
> SSTdata_descrip.txt<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTdata_descrip.txt>
> SSTlandmask.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlandmask.dat>
> SSTlonlat.dat<ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlonlat.dat>
> I will try the suggestion you provided, and wait for further comments.
> 
> Thank you very much
> 
> Fred
> 


From r.hijmans at gmail.com  Thu Aug 18 00:10:25 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Aug 2011 15:10:25 -0700
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <20110817230336.68139c95@upm.es>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
	<20110817230336.68139c95@upm.es>
Message-ID: <CANtt_hxi5iypu_2v2_PknJzRzgLyUEFPhDG4aeSn1G1_6LCufA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/edff2c7d/attachment.pl>

From r.hijmans at gmail.com  Thu Aug 18 00:13:06 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Aug 2011 15:13:06 -0700
Subject: [R-sig-Geo] issue importing GRIB1 data with readGDAL
In-Reply-To: <1313564323700-6694423.post@n2.nabble.com>
References: <1313564323700-6694423.post@n2.nabble.com>
Message-ID: <CANtt_hyVNx+CAEmA4SWWgMztBnwHRJNtMUvd6oU1zywrx-LM7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/ab5cd5a3/attachment.pl>

From r.hijmans at gmail.com  Thu Aug 18 00:14:20 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 17 Aug 2011 15:14:20 -0700
Subject: [R-sig-Geo] A question about the "extract" function in package
	"raster"
In-Reply-To: <CAE5v6PCC_ToBb2A_Wrm5DohB0BrCaK4exiFJZ+P9vL8+QcgR1g@mail.gmail.com>
References: <CAE5v6PCC_ToBb2A_Wrm5DohB0BrCaK4exiFJZ+P9vL8+QcgR1g@mail.gmail.com>
Message-ID: <CANtt_hx=+6z89UZYGXFnMeGwiARAUiQ0F8GcgD8kR-ba+_Mesg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110817/f8d15428/attachment.pl>

From aortizbobea at arec.umd.edu  Thu Aug 18 01:44:49 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Wed, 17 Aug 2011 16:44:49 -0700 (PDT)
Subject: [R-sig-Geo] issue importing GRIB1 data with readGDAL
In-Reply-To: <CANtt_hyVNx+CAEmA4SWWgMztBnwHRJNtMUvd6oU1zywrx-LM7g@mail.gmail.com>
References: <1313564323700-6694423.post@n2.nabble.com>
	<CANtt_hyVNx+CAEmA4SWWgMztBnwHRJNtMUvd6oU1zywrx-LM7g@mail.gmail.com>
Message-ID: <1313624689418-6697639.post@n2.nabble.com>

Great Robert! It now works! What a relief...

I imported using:
counties <- readShapePoly("co99_d00.shp", proj4string =
*CRS("+proj=longlat")* ) 

and then proceeded to transforming the projection as you indicated:
countlcc <- spTransform(counties, proj) 

I thought I had done this in my example when reading the shape file... but
it does not work this way: 
counties <- readShapePoly("co99_d00.shp", proj4string = *CRS(
proj4string(test) )* )
 
...suggesting that "readShapePoly" does not transform the projection - it
just reads them!

Thanks a lot!

Ariel OB

-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/issue-importing-GRIB1-data-with-readGDAL-tp6694423p6697639.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From xuanlong.ma at uts.edu.au  Thu Aug 18 06:02:18 2011
From: xuanlong.ma at uts.edu.au (Richard Ma)
Date: Wed, 17 Aug 2011 21:02:18 -0700 (PDT)
Subject: [R-sig-Geo] A question about the "extract" function in package
	"raster"
In-Reply-To: <CANtt_hx=+6z89UZYGXFnMeGwiARAUiQ0F8GcgD8kR-ba+_Mesg@mail.gmail.com>
References: <CAE5v6PCC_ToBb2A_Wrm5DohB0BrCaK4exiFJZ+P9vL8+QcgR1g@mail.gmail.com>
	<CANtt_hx=+6z89UZYGXFnMeGwiARAUiQ0F8GcgD8kR-ba+_Mesg@mail.gmail.com>
Message-ID: <1313640138000-6698058.post@n2.nabble.com>

Hi Robert,

If I understood correctly, the mechanism behind the "extract" function is
that,  ever cell has a center with a coordinate. The "extract" function will
calculate the distance between the sampling point and nearby cell center. If
the distance less than the buffer, then this cell will be include to
calculate the area mean or other "fun" argument defined functions. 

This function is really helpful for me.

Thanks for your explanation.

Cheers,
Richard



Robert Hijmans wrote:
> 
> Richard,
> 
> A circular buffer with a radius of 500 m gives you an area of   pi * 500^2
> If you want an area of 1000m2 you  should use a radius of  sqrt(1000 / pi)
> 
> Note that in this case, a cell is "inside" the buffer if the buffer
> overlaps
>  with the cell center.
> 
> Hope this helps,
> Robert
> 
> 
> 
>> Just very curious how the "buffer" works in grid image. I have read the
>> document and still very confused.
>>
>> Thanks for your kindly help!
>>
>> BTW, "raster" is really a great package with lots of useful functions for
>> image processing. Thank you Robert!
>>
>> Regards,
>> Richard
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


-----
Richard Ma
PhD student, Ecology & Remote Sensing
Climate Change Cluster, Department of Environment Science
University of Technology, Sydney
http://everydropr.wordpress.com
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/A-question-about-the-extract-function-in-package-raster-tp6684335p6698058.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Jin.Li at ga.gov.au  Fri Aug 19 03:37:59 2011
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Fri, 19 Aug 2011 11:37:59 +1000
Subject: [R-sig-Geo] Kriging wiht anisotropy modeling using great circle
 distance in gstat [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
	<8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E349943529B5@EXCCR01.agso.gov.au>

Hi All,

I tried to do kriging with anisotropy using great circle distance as bellow. 

> library(gstat)
> loadMeuse()
> 
> require(rgdal)
>   proj4string(meuse) = CRS("+init=epsg:28992")
>   meuse.ll = spTransform(meuse, CRS("+proj=longlat"))
> 
> data(meuse.grid)
>   coordinates(meuse.grid) = ~x+y
>   proj4string(meuse.grid) = CRS("+init=epsg:28992")
>   meuse.grid.ll = spTransform(meuse.grid, CRS("+proj=longlat"))
>
> v =  variogram(zinc~1,meuse, alpha=c(0, 45, 90, 135), tol.hor=45)  
> m1<-fit.variogram(v, vgm(1, "Exp", 3,  anis=c(90,0.1)))
>   ok<-krige(log(zinc)~1, meuse.ll, meuse.grid.ll, m1)
[using ordinary kriging]
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  : 
  gstat: value not allowed for: for long/lat data, anisotropy cannot be defined
>  

It produced an error message as above. If the anisotropy specification is removed, it works.

This was done in: 
> Sys.info()
  sysname                      release                      version 
  "Windows"                    "XP"         "build 2600, Service Pack 3" 
                                      
Is there anything wrong in my code or it is a bug? Any suggestions are appreciated!

Regards,
Jin           


From johan.vandewauw at gmail.com  Fri Aug 19 16:49:26 2011
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Fri, 19 Aug 2011 16:49:26 +0200
Subject: [R-sig-Geo] Kriging wiht anisotropy modeling using great circle
 distance in gstat [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E349943529B5@EXCCR01.agso.gov.au>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
	<8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
	<8D2A822B1C6C2A44ABEB777AA83FA0E349943529B5@EXCCR01.agso.gov.au>
Message-ID: <CAJOp35nv7txc7uagt4BM-x8vkJPnRCxaTnBjKn9A2nZDsa7iXw@mail.gmail.com>

On Fri, Aug 19, 2011 at 3:37 AM,  <Jin.Li at ga.gov.au> wrote:

> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, ?:
> ?gstat: value not allowed for: for long/lat data, anisotropy cannot be defined
>>
>
> Is there anything wrong in my code or it is a bug? Any suggestions are appreciated!
>

As you can read from the error message, nothing is wrong with your
code or with gstat, but anisotropy is not supported when you use great
circle distances.

Sincerely Yours
Johan


From juta.kawalerowicz at stx.ox.ac.uk  Fri Aug 19 19:17:10 2011
From: juta.kawalerowicz at stx.ox.ac.uk (majesty)
Date: Fri, 19 Aug 2011 10:17:10 -0700 (PDT)
Subject: [R-sig-Geo] merging polygons by indices
In-Reply-To: <alpine.LRH.2.00.1108170022480.17570@reclus.nhh.no>
References: <1313507821817-6691746.post@n2.nabble.com>
	<alpine.LRH.2.00.1108161743300.16822@reclus.nhh.no>
	<1313517008318-6692261.post@n2.nabble.com>
	<alpine.LRH.2.00.1108170022480.17570@reclus.nhh.no>
Message-ID: <1313774230098-6704213.post@n2.nabble.com>

Thanks Roger, it worked well!

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/merging-polygons-by-indices-tp6691746p6704213.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Fri Aug 19 19:25:56 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 19 Aug 2011 10:25:56 -0700 (PDT)
Subject: [R-sig-Geo]
	=?utf-8?q?Calculating_areas_on_Earth=E2=80=99s_surfac?=
	=?utf-8?q?e?=
In-Reply-To: <j091uj$q3a$1@dough.gmane.org>
References: <j091uj$q3a$1@dough.gmane.org>
Message-ID: <1313774756457-6704251.post@n2.nabble.com>

Dear Karl,

For the area of a spherical polygon, you could do

library(geosphere)
areaPolygon(xy)

I do not know how accurate this is relative to your alternative approaches. 

Robert


> Calculating areas on Earth?s surface 

> I?m interested in the distortion in apparent area from various
> projections, 
> and need to calculate the *real* area of various polygons (or grid cells). 
> In an earlier post on this list, it was suggested to use a equal-area 
> projection. This partly works, but the accuracy is not good enough for 
> measuring the distortion for my purpose (I guess an accuracy < 0.05% for 
> moderately large areas would be OK). 
>  
> Here?s a simple example: 
>
> library(sp) 
> library(rgdal) 
>
> unproj=CRS("+init=epsg:4326")                  # Unprojected, i.e.
> longitudes and latitudes 
> xy=GridTopology(c(0,55),c(8, 4), c(5,5))       # Small grid (covering
> Norway) 
> xy=as.SpatialPolygons.GridTopology(xy, unproj) # Grid as polygons 
>
> # Calculate the area of a polygons using the 'proj' projection 
> calcArea=function(xy, proj) { 
>  xy.trans=spTransform(xy, proj) 
>  sapply( xy.trans at polygons, function(x) x at area)/1e6 
> } 
>
> # Various equal-area projections 
> proj1=CRS("+proj=moll +lat_0=65 +lon_0=10") # Mollweide 
> proj2=CRS("+proj=sinu +lat_0=65 +lon_0=10") # Sinusoidal 
> proj3=CRS("+proj=tcea +lat_0=65 +lon_0=10") # Transverse Cylindrical 
> proj4=CRS("+init=epsg:32633")               # UTM 33N (*not* equal area) 
>
> # Areas according to the different projections all differ 
> a1=calcArea(xy, proj1) 
> a2=calcArea(xy, proj2) 
> a3=calcArea(xy, proj3) 
> a4=calcArea(xy, proj4) 
>
> # All areas calculated using Mollweide are small than the areas 
> # calculated using the sinusoidal projection: 
> all(a1&lt;a2) 
&gt;
> Since the areas from the various projections all differ, I?m not sure
> which 
> one is most accurate. Does anyone know of a ?real? area function available 
> somewhere in R, which can calculate the area of simple polygons on the WGS
> 84 
> ellipsoid (or perhaps even a spherical approximation would be good
> enough). 
> It would be very useful for drawing maps showing the distortion in area
> for 
> various projections. 
>
> -- 
> Karl Ove Hufthammer 
>


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Calculating-areas-on-Earth-s-surface-tp6606454p6704251.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From matevz.pavlic at gi-zrmk.si  Sat Aug 20 16:50:27 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Sat, 20 Aug 2011 16:50:27 +0200
Subject: [R-sig-Geo] krige error
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9012DD9BF@gi-zrmk.si>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110820/1c9cb7a6/attachment.pl>

From matevz.pavlic at gi-zrmk.si  Sat Aug 20 17:13:40 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Sat, 20 Aug 2011 17:13:40 +0200
Subject: [R-sig-Geo] krige error
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9012DD9C0@gi-zrmk.si>

What i found out so far is that it has to be something with data...i raplaced just the column in other krige code and i got the same error. I also got :

> Mag.K<-krige(MGCN_IGRF~1, DF[-zerodist(DF)[,1],], grd, vmf, nmax=nmx)
Error in gstat.formula(d$formula, d$data) : 
  no response variable present in formula

Krigging data is as follows :
>> quantile(DF$MGCN_IGRF, seq(0,1,by=0.1))
      0%      10%      20%      30%      40%      50%      60%      70%      80%      90%     100% 
-351.960 -113.550 -103.130  -97.210  -90.970  -84.215  -75.032  -60.790  -42.740  -21.326  500.400

Can the negaiteve values have this effect?

regards, m


From oscar.perpinan at upm.es  Sat Aug 20 18:50:45 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Sat, 20 Aug 2011 18:50:45 +0200
Subject: [R-sig-Geo] Time vs. Longitude (Hovmueller Diagram)
In-Reply-To: <CANtt_hxi5iypu_2v2_PknJzRzgLyUEFPhDG4aeSn1G1_6LCufA@mail.gmail.com>
References: <CAOMGRDJcoTDt8Jd3+P9A1hZJpHq1ETvcYrS6oAPAeeBnfjd6Sg@mail.gmail.com>
	<CAAcGz9_be7k1OgrA7_VF2m=00N6bEcef9VbD142XX_3HZqyBLA@mail.gmail.com>
	<CAOMGRDLaBmsFmXH2FzhUppU3zhF10C9bXQs4x8pv1XJf6kFcLQ@mail.gmail.com>
	<20110817230336.68139c95@upm.es>
	<CANtt_hxi5iypu_2v2_PknJzRzgLyUEFPhDG4aeSn1G1_6LCufA@mail.gmail.com>
Message-ID: <20110820185045.0799847a@upm.es>

Yes, you are right. Thanks for the correction.

Besides, I have found a bug when add.contour=FALSE. Tomorrow I will
upload to R-Forge a new version of rasterVis to fix this bug and to
improve the labelling of the x-axis.

Best,

Oscar.
El Wed, 17 Aug 2011 15:10:25 -0700
"Robert J. Hijmans" <r.hijmans at gmail.com> escribi?:
> Oscar, I believe that the raster values are in the wrong place in your
> example. I think the below script corrects that. Best, Robert
> 
> library(rasterVis)
> dat <- read.table('SST011970_032003.dat', header=FALSE)
> loc <- read.table('SSTlonlat.dat', header=FALSE)
> 
> sp <- SpatialPointsDataFrame(loc, dat)
> gridded(sp) <- TRUE
> s <- brick(sp)
> # (an alternative route would be rasterFromXYZ)
> 
> idx <- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
> s <- setZ(s, idx)
> 
> hovmoller(s)
> 
> On Wed, Aug 17, 2011 at 2:03 PM, Oscar Perpi?an Lamigueiro <
> oscar.perpinan at upm.es> wrote:
> 
> > Hi,
> >
> > You will find a hovmoller function in the rasterVis package:
> > http://rastervis.r-forge.r-project.org/
> >
> > With your data:
> >
> > library(raster)
> > library(rasterVis)
> >
> > dat <- read.table('SST011970_032003.dat', header=FALSE)
> > loc <- read.table('SSTlonlat.dat', header=FALSE)
> > rasterList <- lapply(dat, function(x)raster(matrix(x, nrow=84,
> > ncol=30), xmn=min(loc[[1]]),
> >                                            xmx=max(loc[[1]]),
> >                                            ymn=min(loc[[2]]),
> >                                            ymx=max(loc[[2]]),
> >                                            crs=CRS("+proj=longlat
> >                                            +datum=WGS84")))
> > s <- stack(rasterList)
> > idx <- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
> > s <- setZ(s, idx)
> >
> > hovmoller(s)
> >
> > Best,
> >
> > Oscar.
> >
> >
> >
> > -------------
> > Oscar Perpi??n Lamigueiro
> > Dpto. de Ingenier?a El?ctrica
> > EUITI-UPM
> >
> > http://procomun.wordpress.com
> >
> >  El Wed, 17 Aug 2011 16:53:15 +1000
> > Jianyun Wu <jianyun.fred.wu at gmail.com> escribi?:
> > > Hi Michael,
> > > Thanks for the reply.
> > > The data file can be rechieved from the following link:
> > >
> > > ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data
> > >
> > > SST011970_032003.dat<
> > ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SST011970_032003.dat
> > >
> > > SSTdata_descrip.txt<
> > ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTdata_descrip.txt
> > >
> > > SSTlandmask.dat<
> > ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlandmask.dat
> > >
> > > SSTlonlat.dat<
> > ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/SSTlonlat.dat
> > >
> > > I will try the suggestion you provided, and wait for further
> > > comments.
> > >
> > > Thank you very much
> > >
> > > Fred
> > >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >


From pascaltitle at gmail.com  Sun Aug 21 02:28:28 2011
From: pascaltitle at gmail.com (Pascal Title)
Date: Sat, 20 Aug 2011 17:28:28 -0700
Subject: [R-sig-Geo] gbuffer in meters
Message-ID: <CAPSA=yf2wTMHVoFXpj-=2ahVMw9kZSymQX7nt14fJSEWkfzwEw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110820/2e5624cc/attachment.pl>

From r.hijmans at gmail.com  Sun Aug 21 07:32:11 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 20 Aug 2011 22:32:11 -0700
Subject: [R-sig-Geo] gbuffer in meters
In-Reply-To: <CAPSA=yf2wTMHVoFXpj-=2ahVMw9kZSymQX7nt14fJSEWkfzwEw@mail.gmail.com>
References: <CAPSA=yf2wTMHVoFXpj-=2ahVMw9kZSymQX7nt14fJSEWkfzwEw@mail.gmail.com>
Message-ID: <CANtt_hy2xfmj5TuZ0HAKm-9fZSCEVccFaCdJRowf7P+=YwfbTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110820/dc353a0b/attachment.pl>

From senator at ecotoxicology.de  Sun Aug 21 11:38:31 2011
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Sun, 21 Aug 2011 11:38:31 +0200
Subject: [R-sig-Geo] Videos of the GEOSTAT summer school freely
	available and downloadable
In-Reply-To: <0EDFDA89-C1CF-437F-A41D-09C6CAEF101D@uni-landau.de>
References: <2A8C0AC9-B878-4AFD-A235-F8023ACA4A4A@ecotoxicology.de>
	<0EDFDA89-C1CF-437F-A41D-09C6CAEF101D@uni-landau.de>
Message-ID: <F8317615-2DB7-4594-9CB5-72CED9788853@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110821/a8676027/attachment.pl>

From Jin.Li at ga.gov.au  Mon Aug 22 01:26:23 2011
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Mon, 22 Aug 2011 09:26:23 +1000
Subject: [R-sig-Geo] Kriging wiht anisotropy modeling using great circle
 distance in gstat [SEC=UNCLASSIFIED]
In-Reply-To: <CAJOp35nv7txc7uagt4BM-x8vkJPnRCxaTnBjKn9A2nZDsa7iXw@mail.gmail.com>
References: <AD5CA6183570B54F92AA45CE2619F9B90129D60A@gi-zrmk.si>
	<4E1D52D6.2050701@uni-muenster.de>
	<AD5CA6183570B54F92AA45CE2619F9B90129D651@gi-zrmk.si>
	<4E1DD225.9000002@uni-muenster.de>
	<CAMRBF3B9e1mDOpkpdDU7bOnX17Dxb-VG2Y6tBrG1EmBo_2zqvQ@mail.gmail.com>
	<4E253933.8070708@uni-muenster.de>
	<8D2A822B1C6C2A44ABEB777AA83FA0E3498CC0C605@EXCCR01.agso.gov.au>
	<8D2A822B1C6C2A44ABEB777AA83FA0E349943529B5@EXCCR01.agso.gov.au>
	<CAJOp35nv7txc7uagt4BM-x8vkJPnRCxaTnBjKn9A2nZDsa7iXw@mail.gmail.com>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E349943529B9@EXCCR01.agso.gov.au>

Thank you Johan for the clarification.
Given this limitation with gstat, I was wondering if there is any package in R or so that supports kriging with anisotropy modelling using great circle distance. Or is gstat going to be developed to overcome this limitation? Thank you in advance!
Kind regards,
Jin


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Johan Van de Wauw
Sent: Saturday, 20 August 2011 12:49 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Kriging wiht anisotropy modeling using great circle distance in gstat [SEC=UNCLASSIFIED]

On Fri, Aug 19, 2011 at 3:37 AM,  <Jin.Li at ga.gov.au> wrote:

> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, ?:
> ?gstat: value not allowed for: for long/lat data, anisotropy cannot be defined
>>
>
> Is there anything wrong in my code or it is a bug? Any suggestions are appreciated!
>

As you can read from the error message, nothing is wrong with your
code or with gstat, but anisotropy is not supported when you use great
circle distances.

Sincerely Yours
Johan

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From xuanlong.ma at uts.edu.au  Mon Aug 22 04:03:55 2011
From: xuanlong.ma at uts.edu.au (Richard Ma)
Date: Sun, 21 Aug 2011 19:03:55 -0700 (PDT)
Subject: [R-sig-Geo] How to apply a local polynomial regression function to
 a RasterStack object by "calc" function?
Message-ID: <1313978635920-6709955.post@n2.nabble.com>

Hi all,

I have a RasterStack with 23 layers. Now I want to fit a local polynomial
regression through 23 layers. I use the package "KernSmooth" to fit the
regression function. 

Here is the example data, you can download them from my Dropbox folder, it's
a native raster package format:
http://dl.dropbox.com/u/19228076/cmg_stack.grd
http://dl.dropbox.com/u/19228076/cmg_stack.gri

Here is my code:
#########################################
require(raster)
require(KernSmooth)

cmg.stack <- stack("cmg_stack.grd")

# Calculate the bandwidth for each cell
time <- seq(1, 353, 16)
fun.bw <- function(x) dpill(x, x = time, gridsize = 365)
bw <- calc(cmg.stack, fun.bw)  # This line do works

# Create a function to apply the "locpoly" function
fun.lp <- function(x) {yvalues <- locpoly(x = time, y = x, bandwidth = bw,
gridsize = 365)$y
return(values)}

########################
## However, I got an error:
########################

> cmg.stack.lp <- calc(cmg.stack, fun.lp, progress = "text")
Error in .local(x, fun, ...) : cannot use this function

#########################################

Can you please point my problem? Is that possible to apply this function by
"calc"? Or are there any other solution to my question?

Thanks in advance for any help.

Sincerely,
Richard

-----
Richard Ma
PhD student, Ecology & Remote Sensing
Climate Change Cluster, Department of Environment Science
University of Technology, Sydney
http://everydropr.wordpress.com
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-apply-a-local-polynomial-regression-function-to-a-RasterStack-object-by-calc-function-tp6709955p6709955.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From xuanlong.ma at uts.edu.au  Mon Aug 22 04:12:23 2011
From: xuanlong.ma at uts.edu.au (Richard Ma)
Date: Sun, 21 Aug 2011 19:12:23 -0700 (PDT)
Subject: [R-sig-Geo] How to apply a local polynomial regression function to
 a RasterStack object by "calc" function?
Message-ID: <1313979143346-6709976.post@n2.nabble.com>

Hi all, 

I have a RasterStack with 23 layers. Now I want to fit a local polynomial
regression through 23 layers. I use the package "KernSmooth" to fit the
regression function. 

Here is the example data, you can download them from my Dropbox folder, it's
a native raster package format: 
http://dl.dropbox.com/u/19228076/cmg_stack.grd
http://dl.dropbox.com/u/19228076/cmg_stack.gri

Here is my code: 
######################################### 
require(raster) 
require(KernSmooth) 

cmg.stack <- stack("cmg_stack.grd") 

# Calculate the bandwidth for each cell 
time <- seq(1, 353, 16)
gs <- 365
fun.bw <- function(x) dpill(x, x = time, gridsize = gs) 
bw <- calc(cmg.stack, fun.bw)  # This line works fine 

# Create a function to apply the "locpoly" function 
fun.lp <- function(x) {yvalues <- locpoly(x = time, y = x, bandwidth = bw,
gridsize = gs)$y 
return(yvalues)} 

#########################################
#### However, I got an error: 
#########################################

> cmg.stack.lp <- calc(cmg.stack, fun.lp, progress = "text") 
Error in .local(x, fun, ...) : cannot use this function 

######################################### 

Can you please point my problem? Is that possible to apply this function by
"calc"? Or are there any other solution to my question? 

Thanks in advance for any help. 

Sincerely, 
Richard


-----
Richard Ma
PhD student, Ecology & Remote Sensing
Climate Change Cluster, Department of Environment Science
University of Technology, Sydney
http://everydropr.wordpress.com
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-apply-a-local-polynomial-regression-function-to-a-RasterStack-object-by-calc-function-tp6709976p6709976.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From gos47 at hotmail.com  Mon Aug 22 06:59:03 2011
From: gos47 at hotmail.com (=?iso-8859-1?Q?Gaspar_Reyes_P=F3ndigo?=)
Date: Sun, 21 Aug 2011 23:59:03 -0500
Subject: [R-sig-Geo]  Error slot
Message-ID: <BLU0-SMTP1593CC5DF219EAF3FB99251B72F0@phx.gbl>

Hi, Dear R-SIG-GEO User

I am new user R 2.13 (spgrass6) from GRASS-GIS 6.4.1-5, under Mac OS X 10.68. I have the following problem, when preparing the data before run R's princomp() function in R from GRASS,  there was an error. The line of code is copied below:


#########################################
library(spgrass6)

G <- gmeta6()

ATC <- readRAST6(c('Acrf_1993_b1','Acrf_1993_b2','Acrf_1993_b3','Acrf_1993_b4','Acrf_1993_b5','Acrf_1993_b7'))

ATC.nas <- which(is.na(ATC at data$Acrf_1993_b1) & is.na(ATC at data$Acrf_1993_b2) & is.na(ATC at data$Acrf_1993_b3) & is.na(ATC at data$Acrf_1993_b4) & is.na(ATC at data$Acrf_1993_b5) & is.na(ATC at data$Acrf_1993_b7))

ATC.ms.values <- which(!is.na(ATC at data$Acrf_1993_b1) & !is.na(ATC at data$Acrf_1993_b2) & !is.na(ATC at data$Acrf_1993_b3) & !is.na(ATC at data$Acrf_1993_b4) & !is.na(ATC at data$Acrf_1993_b5) & !is.na(ATC at data$Acrf_1993_b7))

#######################################
####  I got the following error message  
#######################################
ATC.ms.nonas <- ATC.ms.values at data[ATC.ms.values, ]
Error: tentativa de obtener un slot "data" de un objeto de una clase b?sica ("integer") sin slots
#########################################

Can you please point my problem? and How do I fix my problem?
Thanks in advance for any help. 

NOTE:I followed the guide of http://grass.osgeo.org/wiki/Principal_Components_Analysis # Using_R.27s_princomp.28.29_function for  PRINCOMP() function.
NOTE: the images are LANDSAT 5 TM


Gaspar Reyes P?ndigo
Universidad del Mar, Oaxaca, M?xico
Campus Puerto-?ngel
Carretera principal Puerto ?ngel Zipolite km 1.5 
C.P. 70902

From Roger.Bivand at nhh.no  Mon Aug 22 09:36:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 22 Aug 2011 09:36:37 +0200 (CEST)
Subject: [R-sig-Geo] Error slot
In-Reply-To: <BLU0-SMTP1593CC5DF219EAF3FB99251B72F0@phx.gbl>
References: <BLU0-SMTP1593CC5DF219EAF3FB99251B72F0@phx.gbl>
Message-ID: <alpine.LRH.2.00.1108220930400.10038@reclus.nhh.no>

On Sun, 21 Aug 2011, Gaspar Reyes P?ndigo wrote:

> Hi, Dear R-SIG-GEO User
>
> I am new user R 2.13 (spgrass6) from GRASS-GIS 6.4.1-5, under Mac OS X 
> 10.68. I have the following problem, when preparing the data before run 
> R's princomp() function in R from GRASS, there was an error. The line of 
> code is copied below:
>

Please only post to one list at a time, and wait patiently for an answer.


>
> #########################################
> library(spgrass6)
>
> G <- gmeta6()
>
> ATC <- > readRAST6(c('Acrf_1993_b1','Acrf_1993_b2','Acrf_1993_b3','Acrf_1993_b4','Acrf_1993_b5','Acrf_1993_b7'))
>
> ATC.nas <- which(is.na(ATC at data$Acrf_1993_b1) & is.na(ATC at data$Acrf_1993_b2) & is.na(ATC at data$Acrf_1993_b3) & is.na(ATC at data$Acrf_1993_b4) & is.na(ATC at data$Acrf_1993_b5) & is.na(ATC at data$Acrf_1993_b7))
>

Never access columns with ... at data$... which is exactly the same as 
...$...

> ATC.ms.values <- which(!is.na(ATC at data$Acrf_1993_b1) & !is.na(ATC at data$Acrf_1993_b2) & !is.na(ATC at data$Acrf_1993_b3) & !is.na(ATC at data$Acrf_1993_b4) & !is.na(ATC at data$Acrf_1993_b5) & !is.na(ATC at data$Acrf_1993_b7))
>
> #######################################
> ####  I got the following error message
> #######################################
> ATC.ms.nonas <- ATC.ms.values at data[ATC.ms.values, ]

str(ATC.ms.values) is certainly integer. I believe that you want to say 
either (may need casting to SpatialPixelsDataFrame first):

ATC.ms.nonas <- ATC[ATC.ms.values,]

or

ATC.ms.nonas <- as(ATC, "data.frame")[ATC.ms.values,]


> Error: tentativa de obtener un slot "data" de un objeto de una clase 
> b?sica ("integer") sin slots

which is very clear. Do use str() or class() to check the objects you are 
using.

Roger

> #########################################
>
> Can you please point my problem? and How do I fix my problem?
> Thanks in advance for any help.
>
> NOTE:I followed the guide of http://grass.osgeo.org/wiki/Principal_Components_Analysis # Using_R.27s_princomp.28.29_function for  PRINCOMP() function.
> NOTE: the images are LANDSAT 5 TM
>
>
> Gaspar Reyes P?ndigo
> Universidad del Mar, Oaxaca, M?xico
> Campus Puerto-?ngel
> Carretera principal Puerto ?ngel Zipolite km 1.5
> C.P. 70902
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jon.skoien at jrc.ec.europa.eu  Mon Aug 22 09:48:59 2011
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Mon, 22 Aug 2011 09:48:59 +0200
Subject: [R-sig-Geo] krige error
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B9012DD9C0@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B9012DD9C0@gi-zrmk.si>
Message-ID: <4E5209EB.1010306@jrc.ec.europa.eu>

It is difficult to know exactly what happens without seeing a 
reproducible example, but did you check the results of zerodist(DF) and 
DF[-zerodist(DF)[,1],]? The error below can come if there are no points 
that are within the limits of zerodist, not sure if the error in your 
first email could have a similar reason.

loadMeuse()
zerodist(meuse)
meuse[-zerodist(meuse)[,1],]
vmod = vgm(1, "Exp", 500, 0)
kres = krige(zinc~1, meuse[-zerodist(meuse)[,1],], meuse.grid, vmod)


Cheers,
Jon

On 20-Aug-11 17:13, Matev? Pavli? wrote:
> What i found out so far is that it has to be something with data...i raplaced just the column in other krige code and i got the same error. I also got :
>
>> Mag.K<-krige(MGCN_IGRF~1, DF[-zerodist(DF)[,1],], grd, vmf, nmax=nmx)
> Error in gstat.formula(d$formula, d$data) :
>    no response variable present in formula
>
> Krigging data is as follows :
>>> quantile(DF$MGCN_IGRF, seq(0,1,by=0.1))
>        0%      10%      20%      30%      40%      50%      60%      70%      80%      90%     100%
> -351.960 -113.550 -103.130  -97.210  -90.970  -84.215  -75.032  -60.790  -42.740  -21.326  500.400
>
> Can the negaiteve values have this effect?
>
> regards, m
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From matevz.pavlic at gi-zrmk.si  Mon Aug 22 12:36:27 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Mon, 22 Aug 2011 12:36:27 +0200
Subject: [R-sig-Geo] krige error
In-Reply-To: <4E5209EB.1010306@jrc.ec.europa.eu>
References: <AD5CA6183570B54F92AA45CE2619F9B9012DD9C0@gi-zrmk.si>
	<4E5209EB.1010306@jrc.ec.europa.eu>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9012DDA65@gi-zrmk.si>

Hi, thanks for the help. 

Class says as follows :

> class(DF)
[1] "SpatialPointsDataFrame"
attr(,"package")
[1] "sp"
> class(grd)
[1] "SpatialPixels"
attr(,"package")
[1] "sp

Anyway, the problem was, as Jan Olav Skoien  suggested, with the zerodist().

Tnx, m

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Jon Olav Skoien
Sent: Monday, August 22, 2011 9:49 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] krige error

It is difficult to know exactly what happens without seeing a reproducible example, but did you check the results of zerodist(DF) and DF[-zerodist(DF)[,1],]? The error below can come if there are no points that are within the limits of zerodist, not sure if the error in your first email could have a similar reason.

loadMeuse()
zerodist(meuse)
meuse[-zerodist(meuse)[,1],]
vmod = vgm(1, "Exp", 500, 0)
kres = krige(zinc~1, meuse[-zerodist(meuse)[,1],], meuse.grid, vmod)


Cheers,
Jon

On 20-Aug-11 17:13, Matev? Pavli? wrote:
> What i found out so far is that it has to be something with data...i raplaced just the column in other krige code and i got the same error. I also got :
>
>> Mag.K<-krige(MGCN_IGRF~1, DF[-zerodist(DF)[,1],], grd, vmf, nmax=nmx)
> Error in gstat.formula(d$formula, d$data) :
>    no response variable present in formula
>
> Krigging data is as follows :
>>> quantile(DF$MGCN_IGRF, seq(0,1,by=0.1))
>        0%      10%      20%      30%      40%      50%      60%      70%      80%      90%     100%
> -351.960 -113.550 -103.130  -97.210  -90.970  -84.215  -75.032  
> -60.790  -42.740  -21.326  500.400
>
> Can the negaiteve values have this effect?
>
> regards, m
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From christian.kamenik at giub.unibe.ch  Mon Aug 22 17:49:40 2011
From: christian.kamenik at giub.unibe.ch (Christian Kamenik)
Date: Mon, 22 Aug 2011 17:49:40 +0200
Subject: [R-sig-Geo] spacetime: remove NAs from STSDF object
Message-ID: <4E527A94.1020409@giub.unibe.ch>

Dear all,

I have observations in space and time with quite a lot of missing values 
that I want to arrange in a space-time sparse data-frame object (STSDF 
from package 'spacetime'). For simplicity, I first created a 
spatio-temporal full grid data frame (which I call my.STFDF) that 
included all the missing observations. Then I did the following:

my.STSDF <- as(my.STFDF, "STSDF")
slot(my.STSDF,'index') <- 
matrix(slot(my.STSDF,'index')[complete.cases(slot(my.STSDF,'data'))],ncol=2)
slot(my.STSDF,'data') <- 
slot(my.STSDF,'data')[complete.cases(slot(my.STSDF,'data')),]

This is the first time I try the spacetime package, and I was wondering 
if the code above would be an appropriate way of dealing with STFDF and 
STSDF objects.

Many thanks in advance, Christian

-

-----------------------------------------------
Oeschger Centre for Climate Change Research, Institute of Geography&  Institute of Plant Sciences
University of Bern

http://www.stomatocysts.unibe.ch/kamenik
mailto: christian.kamenik at giub.unibe.ch

Postal address:
Dr. Christian Kamenik
Institute of Geography
Erlachstrasse 9a, Trakt 3
3012 Bern, Switzerland

Tel. +41 (0)31 631 5091
Fax +41 (0)31 631 43 38


From etiennebr at gmail.com  Mon Aug 22 20:40:15 2011
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 22 Aug 2011 14:40:15 -0400
Subject: [R-sig-Geo] Working on tiled raster
Message-ID: <CALjAYt5+_hxFh0_HiKQBNmudMSJ=SOWJhEtW=Tq0QjZMm=QhVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110822/464176a3/attachment.pl>

From r.hijmans at gmail.com  Tue Aug 23 01:37:17 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 22 Aug 2011 16:37:17 -0700
Subject: [R-sig-Geo] Working on tiled raster
In-Reply-To: <CALjAYt5+_hxFh0_HiKQBNmudMSJ=SOWJhEtW=Tq0QjZMm=QhVQ@mail.gmail.com>
References: <CALjAYt5+_hxFh0_HiKQBNmudMSJ=SOWJhEtW=Tq0QjZMm=QhVQ@mail.gmail.com>
Message-ID: <CANtt_hyiLyRTaVC1GHRKcMm6+5H2aLbdgbzRWBF1RLaJ9z92FQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110822/0c5b39c1/attachment.pl>

From r.hijmans at gmail.com  Tue Aug 23 01:47:16 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 22 Aug 2011 16:47:16 -0700
Subject: [R-sig-Geo] How to apply a local polynomial regression function
 to a RasterStack object by "calc" function?
In-Reply-To: <1313979143346-6709976.post@n2.nabble.com>
References: <1313979143346-6709976.post@n2.nabble.com>
Message-ID: <CANtt_hw_htmVquQygh-VgAaVzLkZ7z95rfLF+5M0rUaisF6g=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110822/95912d76/attachment.pl>

From xuanlong.ma at uts.edu.au  Tue Aug 23 02:17:37 2011
From: xuanlong.ma at uts.edu.au (Richard Ma)
Date: Mon, 22 Aug 2011 17:17:37 -0700 (PDT)
Subject: [R-sig-Geo] How to apply a local polynomial regression function
 to a RasterStack object by "calc" function?
In-Reply-To: <CANtt_hw_htmVquQygh-VgAaVzLkZ7z95rfLF+5M0rUaisF6g=g@mail.gmail.com>
References: <1313979143346-6709976.post@n2.nabble.com>
	<CANtt_hw_htmVquQygh-VgAaVzLkZ7z95rfLF+5M0rUaisF6g=g@mail.gmail.com>
Message-ID: <1314058657857-6714317.post@n2.nabble.com>

Hi Robert,

Thank you so much! Problem solved.

As you said, function "locpoly" can't receive a RasterLayer as argument, why
after we stack them, the function works?

Here I paste all my code:
###################################
Aug 22, 2011
Sydney, OZ
Richard Ma
Local polynomial smoothing raster images

# Package required
require(raster)
require(KernSmooth)

# Read the data in
dir <- ("/Users/forestinthesea/Downloads/")
file <- ("cmg_stack.grd")

cmg.stack <- stack(paste(dir, file, sep = ""))

# Calculate the smoothing bandwidth
time <- seq(1, 353, 16)
gs <- 353
fun.bw <- function(x) dpill(x, x = time, gridsize = gs)
bw <- calc(cmg.stack, fun.bw)

# Local polynomial smoothing
s <- stack(bw, cmg.stack)
fun.lp <- function(x) {locpoly(x = time, y = x[-1], bandwidth = x[1],
gridsize = gs)$y}
cmg.stack.lp <- calc(s, fun.lp, progress = "text" )
###################################

Regards,
Richard


Robert Hijmans wrote:
> 
> Richard,
> 
> You are supplying a RasterLayer as the value of the bandwidth argument of
> function "locpoly". That is not what locpoly expects, but I think you can
> let raster::calc deal with that like this:
> 
> s <- stack(bw, cmg.stack)
> fun.lp <- function(x) {locpoly(x = time, y = x[-1], bandwidth = x[1],
> gridsize = gs)$y}
> cmg.stack.lp <- calc(cmg.stack, fun.lp, progress = "text")
> 
> Robert
> 


-----
Richard Ma
PhD student, Ecology & Remote Sensing
Climate Change Cluster, Department of Environment Science
University of Technology, Sydney
http://everydropr.wordpress.com
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-apply-a-local-polynomial-regression-function-to-a-RasterStack-object-by-calc-function-tp6709976p6714317.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From paul.hiemstra at knmi.nl  Tue Aug 23 09:20:13 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Tue, 23 Aug 2011 07:20:13 +0000
Subject: [R-sig-Geo] krige error
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B9012DD9BF@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B9012DD9BF@gi-zrmk.si>
Message-ID: <4E5354AD.2040608@knmi.nl>

 Dear Matevz,

Please provide us with a reproducible example. At this stage we can only
guess what is going wrong.

regards,
Paul

On 08/20/2011 02:50 PM, Matev? Pavli? wrote:
> Hi all, 
>
>  
>
> i am having problems with krige() predisction. When i use this line :
>
>  
>
>> Mag.K<-krige(DF1$MGCN_IGRF~1, DF1[-zerodist(DF1)[,1],], grd, vmfMag, nmax=nmx)
> Error: too few spatial dimensions: 0
>
> In addition: Warning messages:
>
> 1: In min(x) : no non-missing arguments to min; returning Inf
>
> 2: In max(x) : no non-missing arguments to max; returning -Inf
>
> 3: In min(x) : no non-missing arguments to min; returning Inf
>
> 4: In max(x) : no non-missing arguments to max; returning -Inf
>
>  
>
> I get : Too few spatial dimension : 0 error
>
>  
>
> When i use IDW it works perfectly....Any ideas?
>
>  
>
> regards, m
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From mathieu.rajerison at gmail.com  Tue Aug 23 10:02:23 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 23 Aug 2011 10:02:23 +0200
Subject: [R-sig-Geo] Videos of the GEOSTAT summer school freely
 available and downloadable
In-Reply-To: <F8317615-2DB7-4594-9CB5-72CED9788853@ecotoxicology.de>
References: <2A8C0AC9-B878-4AFD-A235-F8023ACA4A4A@ecotoxicology.de>
	<0EDFDA89-C1CF-437F-A41D-09C6CAEF101D@uni-landau.de>
	<F8317615-2DB7-4594-9CB5-72CED9788853@ecotoxicology.de>
Message-ID: <CAGfc75m_ibQYmQCcav2O4H0r6wCSH+VrfREgPxdkYi7NsP=gpw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110823/60480184/attachment.pl>

From rolo at imm.dtu.dk  Tue Aug 23 10:13:35 2011
From: rolo at imm.dtu.dk (=?iso-8859-1?Q?Roland_L=F6we?=)
Date: Tue, 23 Aug 2011 10:13:35 +0200
Subject: [R-sig-Geo] Neighborhood filtering
Message-ID: <AAD1945C8FDCF0488D845356BF31DB7204A03733@WINEXCHANGE5.win.dtu.dk>

This may be a classic problem but I couldn't find a solution in the lists so far. I'm trying to run a filter on radar data, where a pixels result value is predicted as weighted average of the values in a 3x3 neighborhood in the current time step.
For one time step the operation could look like

filter<-matrix(rep(1/9,9),3)
          [,1]      [,2]      [,3]
[1,] 0.1111111 0.1111111 0.1111111
[2,] 0.1111111 0.1111111 0.1111111
[3,] 0.1111111 0.1111111 0.1111111

base<-matrix(runif(100,0.0,2),10)
      [,1]       [,2]      [,3]       [,4]       [,5]      [,6]       [,7]       [,8]       [,9]      [,10]
 [1,] 1.2748495 1.64100480 1.7629353 1.04471073 0.17636041 0.7920916 1.81948900 0.28150594 0.40615944 0.33799927
 [2,] 0.9134852 1.04947132 1.7847194 0.28143589 0.25744083 1.4310364 1.48369795 1.04006404 0.51538211 1.54781491
 [3,] 1.4310985 1.01676632 1.8475540 1.97060630 0.01470109 0.2014272 1.79969115 1.04854042 0.90953386 0.02998074
 [4,] 1.7304672 0.93514790 0.1203939 0.69291092 0.34618531 1.5409637 0.58926745 1.61994100 1.66063354 0.69013138
 [5,] 0.7535980 0.64312043 1.2213976 0.03293221 1.70696788 1.6062746 0.06455516 0.62512456 1.94994886 0.52073311
 [6,] 1.6559531 0.35279738 0.5878466 1.99312250 1.98113265 0.4076653 1.60588111 1.77600453 0.73479768 1.99889307
 [7,] 0.1142795 0.22586611 0.2603767 0.33145144 1.37324328 0.8435238 0.78651141 0.46745984 0.93032790 1.20699560
 [8,] 1.9036901 1.71863581 0.6056311 1.83853173 1.82158619 0.3230073 0.17650283 0.02147692 0.02384052 1.56027144
 [9,] 1.8832814 1.38824498 0.7263898 1.63432910 1.65317872 1.4431693 1.06139030 1.08942924 0.15570795 1.21371980
[10,] 0.5374888 0.03651226 1.3404380 1.23004404 1.99562437 1.4025763 1.35752389 0.39377822 1.03457161 0.90385665

result<-matrix(ncol=8,nrow=8)
for (i in c(2:9)){
  for (j in c(2:9)){
  result[(i-1),(j-1)]<-sum(base[(i-1):(i+1),(j-1):(j+1)]*filter)
}
}

          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]      [,8]
[1,] 1.4135427 1.3776893 1.0156071 0.6855345 0.8862151 1.0997271 1.0337849 0.6796645
[2,] 1.2032338 1.0776673 0.8128831 0.7485231 0.8516012 1.1949588 1.1851946 1.0068913
[3,] 1.0777271 0.9423144 0.8837388 0.9014410 0.8744482 1.0106428 1.1408040 1.0060631
[4,] 0.8889691 0.7310744 0.9647655 1.1453506 1.0943215 1.0928531 1.1806838 1.2862453
[5,] 0.6461373 0.6276568 1.0542745 1.1418126 1.1528617 0.9092223 0.9934012 1.1344761
[6,] 0.8250085 0.8793621 1.1992136 1.2125849 1.0354504 0.7120037 0.7247559 0.9688964
[7,] 0.9807106 0.9699396 1.1383020 1.2513357 1.0535681 0.6902746 0.5236274 0.7410255
[8,] 1.1267014 1.1687508 1.4273059 1.4824497 1.2482844 0.8076505 0.5904691 0.7107391


I will have to run this operation about 300.000 times in a parameter estimation routine, so I was wondering if anyone could point me at an efficient way of filtering that avoids the nested for loop.
Thanks.
Roland?  
?


From matevz.pavlic at gi-zrmk.si  Tue Aug 23 10:21:01 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Tue, 23 Aug 2011 10:21:01 +0200
Subject: [R-sig-Geo] krige error
In-Reply-To: <4E5354AD.2040608@knmi.nl>
References: <AD5CA6183570B54F92AA45CE2619F9B9012DD9BF@gi-zrmk.si>
	<4E5354AD.2040608@knmi.nl>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9012DDB2B@gi-zrmk.si>

Paul, 

i found out the problem. It was , as Jan Olav suggested, the problem with zerodist(). When I leave the zerodist() part of the code out it works perfectly.

thanks anyways for the help, 

m

-----Original Message-----
From: Paul Hiemstra [mailto:paul.hiemstra at knmi.nl] 
Sent: Tuesday, August 23, 2011 9:20 AM
To: Matev? Pavli?
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] krige error

 Dear Matevz,

Please provide us with a reproducible example. At this stage we can only guess what is going wrong.

regards,
Paul

On 08/20/2011 02:50 PM, Matev? Pavli? wrote:
> Hi all,
>
>  
>
> i am having problems with krige() predisction. When i use this line :
>
>  
>
>> Mag.K<-krige(DF1$MGCN_IGRF~1, DF1[-zerodist(DF1)[,1],], grd, vmfMag, 
>> nmax=nmx)
> Error: too few spatial dimensions: 0
>
> In addition: Warning messages:
>
> 1: In min(x) : no non-missing arguments to min; returning Inf
>
> 2: In max(x) : no non-missing arguments to max; returning -Inf
>
> 3: In min(x) : no non-missing arguments to min; returning Inf
>
> 4: In max(x) : no non-missing arguments to max; returning -Inf
>
>  
>
> I get : Too few spatial dimension : 0 error
>
>  
>
> When i use IDW it works perfectly....Any ideas?
>
>  
>
> regards, m
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


--
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI) Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39 P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From mathieu.rajerison at gmail.com  Tue Aug 23 10:41:43 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 23 Aug 2011 10:41:43 +0200
Subject: [R-sig-Geo] Neighborhood filtering
In-Reply-To: <AAD1945C8FDCF0488D845356BF31DB7204A03733@WINEXCHANGE5.win.dtu.dk>
References: <AAD1945C8FDCF0488D845356BF31DB7204A03733@WINEXCHANGE5.win.dtu.dk>
Message-ID: <CAGfc75kq3-LZt1GvPcQRi8OjD_2t1ok9ECEkCWWSkqWTgPZQzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110823/6b51b751/attachment.pl>

From juta.kawalerowicz at stx.ox.ac.uk  Tue Aug 23 13:38:36 2011
From: juta.kawalerowicz at stx.ox.ac.uk (Juta Kawalerowicz)
Date: Tue, 23 Aug 2011 12:38:36 +0100
Subject: [R-sig-Geo] read.gal() for large data sets
Message-ID: <BE8C4D3FFC7C2D49830176E9D80106958F06323CF8@EXMBX04.ad.oak.ox.ac.uk>

Dear List, 

I am looking for a general strategy for the following problem. I have a large data set with 200 000 rows and 50 variables. Along the lines of Anselin's R workbook I have used GeoDa to creata weights (200 Mb file), but when I am trying to do read them into R by using 

library(spdep)
weights<-read.gal("weights.gal")

it does not seem to work (or maybe I should to wait for more than one hour?). My computer runs on i7-2630QM CPU with 4 GB RAM. Any suggestions? In principle - could somebody advise me on what are the strategies for spatial analysis on large data sets? 

Thanks, 
Juta

From etienne.ollion at gmail.com  Tue Aug 23 14:18:29 2011
From: etienne.ollion at gmail.com (Etienne)
Date: Tue, 23 Aug 2011 05:18:29 -0700 (PDT)
Subject: [R-sig-Geo] Coloring continents
Message-ID: <1314101909581-6715944.post@n2.nabble.com>

Hi, 

I believe there is an easy answer to my question, but I looked it up a bit
and could not find anything. 
I'm trying to have a simple world map (or better projection, if any) colored
by continent. 
One way to do that would be to enter a value for each country, but there is
certainly an alternative to this time-costly & alienating solution, right?

Any help appreciated, 

Regards, 
Etienne

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Coloring-continents-tp6715944p6715944.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From bibiko at eva.mpg.de  Tue Aug 23 14:49:17 2011
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Tue, 23 Aug 2011 14:49:17 +0200
Subject: [R-sig-Geo] Coloring continents
In-Reply-To: <1314101909581-6715944.post@n2.nabble.com>
References: <1314101909581-6715944.post@n2.nabble.com>
Message-ID: <442CB1BA-681A-4973-BE65-E4033E407AB5@eva.mpg.de>


On 23 Aug 2011, at 14:18, Etienne wrote:

> I believe there is an easy answer to my question, but I looked it up a bit
> and could not find anything. 
> I'm trying to have a simple world map (or better projection, if any) colored
> by continent. 
> One way to do that would be to enter a value for each country, but there is
> certainly an alternative to this time-costly & alienating solution, right?

Hi,

a very quick solution would be to use the data set "wrld_simpl" of package "maptools". Look at 

wrld_simpl at data

Here you find the column "REGION".


Then you can do the following:

library(maptools)
data(wrld_simpl)
my_cols <- c()
my_cols[20]  <- "red"
my_cols[3]  <- "green"
my_cols[143]  <- "blue"
my_cols[151]  <- "yellow"
my_cols[10]  <- "brown"
my_cols[1]  <- "white"
plot(wrld_simpl, col=my_cols[wrld_simpl at data$REGION+1])


Note: +1 is here necessary to catch the region "0"

The only problem is Russia since it belongs to Europe and Asia.

Cheers,

--Hans



**********************************************************
Hans-Joerg Bibiko
Max Planck Institute for Evolutionary Anthropology
Department of Linguistics
Deutscher Platz 6     phone:   +49 (0) 341 3550 341
D-04103 Leipzig       fax:     +49 (0) 341 3550 333
Germany               e-mail:  bibiko[AT]eva.mpg.de


From etiennebr at gmail.com  Tue Aug 23 15:21:18 2011
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 23 Aug 2011 09:21:18 -0400
Subject: [R-sig-Geo] Working on tiled raster
In-Reply-To: <CANtt_hyiLyRTaVC1GHRKcMm6+5H2aLbdgbzRWBF1RLaJ9z92FQ@mail.gmail.com>
References: <CALjAYt5+_hxFh0_HiKQBNmudMSJ=SOWJhEtW=Tq0QjZMm=QhVQ@mail.gmail.com>
	<CANtt_hyiLyRTaVC1GHRKcMm6+5H2aLbdgbzRWBF1RLaJ9z92FQ@mail.gmail.com>
Message-ID: <CALjAYt5eMQUrL2Gu1pDKrx2nJdS_zHSvG8TTwEaZQ2uES3bXxQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110823/25eae186/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Aug 23 15:59:58 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 23 Aug 2011 15:59:58 +0200
Subject: [R-sig-Geo] spacetime: remove NAs from STSDF object
In-Reply-To: <4E527A94.1020409@giub.unibe.ch>
References: <4E527A94.1020409@giub.unibe.ch>
Message-ID: <4E53B25E.8010509@uni-muenster.de>



On 08/22/2011 05:49 PM, Christian Kamenik wrote:
> Dear all,
> 
> I have observations in space and time with quite a lot of missing values
> that I want to arrange in a space-time sparse data-frame object (STSDF
> from package 'spacetime'). For simplicity, I first created a
> spatio-temporal full grid data frame (which I call my.STFDF) that
> included all the missing observations. Then I did the following:
> 
> my.STSDF <- as(my.STFDF, "STSDF")

Christian,

this single line should do, as the coercion does exactly that --
removing all the missing valued S/T combinations. If it doesn't, please
report.

Best regards,

> slot(my.STSDF,'index') <-
> matrix(slot(my.STSDF,'index')[complete.cases(slot(my.STSDF,'data'))],ncol=2)
> 
> slot(my.STSDF,'data') <-
> slot(my.STSDF,'data')[complete.cases(slot(my.STSDF,'data')),]
> 
> This is the first time I try the spacetime package, and I was wondering
> if the code above would be an appropriate way of dealing with STFDF and
> STSDF objects.
> 
> Many thanks in advance, Christian
> 
> -
> 
> -----------------------------------------------
> Oeschger Centre for Climate Change Research, Institute of Geography& 
> Institute of Plant Sciences
> University of Bern
> 
> http://www.stomatocysts.unibe.ch/kamenik
> mailto: christian.kamenik at giub.unibe.ch
> 
> Postal address:
> Dr. Christian Kamenik
> Institute of Geography
> Erlachstrasse 9a, Trakt 3
> 3012 Bern, Switzerland
> 
> Tel. +41 (0)31 631 5091
> Fax +41 (0)31 631 43 38
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mathieu.rajerison at gmail.com  Tue Aug 23 18:14:42 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 23 Aug 2011 18:14:42 +0200
Subject: [R-sig-Geo] Questions about stplot (spacetime package)
Message-ID: <CAGfc75mLDBgKL4U-eZg6W5SZ8qV=QzbaBwtgnzwNM4Re48DcQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110823/eb9f616f/attachment.pl>

From Roger.Bivand at nhh.no  Tue Aug 23 19:47:57 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 23 Aug 2011 19:47:57 +0200 (CEST)
Subject: [R-sig-Geo] read.gal() for large data sets
In-Reply-To: <BE8C4D3FFC7C2D49830176E9D80106958F06323CF8@EXMBX04.ad.oak.ox.ac.uk>
References: <BE8C4D3FFC7C2D49830176E9D80106958F06323CF8@EXMBX04.ad.oak.ox.ac.uk>
Message-ID: <alpine.LRH.2.00.1108231928500.17219@reclus.nhh.no>

On Tue, 23 Aug 2011, Juta Kawalerowicz wrote:

> Dear List,
>
> I am looking for a general strategy for the following problem. I have a 
> large data set with 200 000 rows and 50 variables. Along the lines of 
> Anselin's R workbook I have used GeoDa to creata weights (200 Mb file), 
> but when I am trying to do read them into R by using
>
> library(spdep)
> weights<-read.gal("weights.gal")
>
> it does not seem to work (or maybe I should to wait for more than one 
> hour?).

read.gal() is quite complicated inside, because the IDs used may not be 
the integers 1:n, so needs to read in the data and manipulate it a good 
deal. I think that you also have many neighbours, as if you have a 200MB 
file and use integers 1:200000, taking 7 characters per integer on 
average, you have almost 1500 neighbours. This is far from sparse. I 
suggest generating the neighbour object in R directly if you can, as the 
smoothing effect of such a large number of neighbours on average may be 
very powerful, and may not represent the spatial process adequately. 
Depending on what you want to do with the data, you may prefer a 
graph-based or kNN approach.

> My computer runs on i7-2630QM CPU with 4 GB RAM. Any suggestions? In 
> principle - could somebody advise me on what are the strategies for 
> spatial analysis on large data sets?

4GB is not large, as most newer machines can run in 64-bit mode, and 
handle much more without trouble, this sounds like a standard laptop. I 
don't think that there is an obvious answer to your question, as 
approaches will vary greatly depending on what kind of analysis you want 
to do, and at least partly on whether the data are planar or use 
geographical (unprojected) coordinates, forcing the use of Great Circle 
distances.

If your analysis is embarassingly parallelisable and you have plenty of 
memory, you can use all your cores at once; you need more memory because 
each core uses the data and in most systems needs its own copy of part of 
the data set. One copy of your data as a matrix is about 80MB in the R 
workspace, which isn't large as such; the "lm" object from regressing one 
column on the others is about 200MB, but can be made smaller. But whether 
say Moran's I of 200000 observations tells a great deal is another matter, 
it depends on the problem you are analysing and how you have set out your 
model.

Hope this clarifies,

Roger

>
> Thanks,
> Juta
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rolo at imm.dtu.dk  Tue Aug 23 20:06:38 2011
From: rolo at imm.dtu.dk (=?iso-8859-1?Q?Roland_L=F6we?=)
Date: Tue, 23 Aug 2011 20:06:38 +0200
Subject: [R-sig-Geo] Neighborhood filtering
Message-ID: <AAD1945C8FDCF0488D845356BF31DB7204A039D7@WINEXCHANGE5.win.dtu.dk>

Nice, thanks. That's what I'm looking for. 
It looks, like the for-loops may run faster (I tested on 10000 iterations of the above operation) but I'll try again  with the actual data.

------------------------------

Message: 11
Date: Tue, 23 Aug 2011 10:41:43 +0200
From: Mathieu Rajerison <mathieu.rajerison at gmail.com>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Neighborhood filtering
Message-ID:
	<CAGfc75kq3-LZt1GvPcQRi8OjD_2t1ok9ECEkCWWSkqWTgPZQzA at mail.gmail.com>
Content-Type: text/plain

Hi,

I think all you need is in raster package.

You could transform your matrix into a RasterLayer object

Then apply focalFilter function on your RasterLayer using your matrix of weights

http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=raster:focalFilter

Hope this helps

2011/8/23 Roland L?we <rolo at imm.dtu.dk>

> This may be a classic problem but I couldn't find a solution in the 
> lists so far. I'm trying to run a filter on radar data, where a pixels 
> result value is predicted as weighted average of the values in a 3x3 
> neighborhood in the current time step.
> For one time step the operation could look like
>
> filter<-matrix(rep(1/9,9),3)
>          [,1]      [,2]      [,3]
> [1,] 0.1111111 0.1111111 0.1111111
> [2,] 0.1111111 0.1111111 0.1111111
> [3,] 0.1111111 0.1111111 0.1111111
>
> base<-matrix(runif(100,0.0,2),10)
>      [,1]       [,2]      [,3]       [,4]       [,5]      [,6]       [,7]
>     [,8]       [,9]      [,10]
>  [1,] 1.2748495 1.64100480 1.7629353 1.04471073 0.17636041 0.7920916
> 1.81948900 0.28150594 0.40615944 0.33799927  [2,] 0.9134852 1.04947132 
> 1.7847194 0.28143589 0.25744083 1.4310364
> 1.48369795 1.04006404 0.51538211 1.54781491  [3,] 1.4310985 1.01676632 
> 1.8475540 1.97060630 0.01470109 0.2014272
> 1.79969115 1.04854042 0.90953386 0.02998074  [4,] 1.7304672 0.93514790 
> 0.1203939 0.69291092 0.34618531 1.5409637
> 0.58926745 1.61994100 1.66063354 0.69013138  [5,] 0.7535980 0.64312043 
> 1.2213976 0.03293221 1.70696788 1.6062746
> 0.06455516 0.62512456 1.94994886 0.52073311  [6,] 1.6559531 0.35279738 
> 0.5878466 1.99312250 1.98113265 0.4076653
> 1.60588111 1.77600453 0.73479768 1.99889307  [7,] 0.1142795 0.22586611 
> 0.2603767 0.33145144 1.37324328 0.8435238
> 0.78651141 0.46745984 0.93032790 1.20699560  [8,] 1.9036901 1.71863581 
> 0.6056311 1.83853173 1.82158619 0.3230073
> 0.17650283 0.02147692 0.02384052 1.56027144  [9,] 1.8832814 1.38824498 
> 0.7263898 1.63432910 1.65317872 1.4431693
> 1.06139030 1.08942924 0.15570795 1.21371980 [10,] 0.5374888 0.03651226 
> 1.3404380 1.23004404 1.99562437 1.4025763
> 1.35752389 0.39377822 1.03457161 0.90385665
>
> result<-matrix(ncol=8,nrow=8)
> for (i in c(2:9)){
>  for (j in c(2:9)){
>  result[(i-1),(j-1)]<-sum(base[(i-1):(i+1),(j-1):(j+1)]*filter)
> }
> }
>
>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
>    [,8]
> [1,] 1.4135427 1.3776893 1.0156071 0.6855345 0.8862151 1.0997271 
> 1.0337849
> 0.6796645
> [2,] 1.2032338 1.0776673 0.8128831 0.7485231 0.8516012 1.1949588 
> 1.1851946
> 1.0068913
> [3,] 1.0777271 0.9423144 0.8837388 0.9014410 0.8744482 1.0106428 
> 1.1408040
> 1.0060631
> [4,] 0.8889691 0.7310744 0.9647655 1.1453506 1.0943215 1.0928531 
> 1.1806838
> 1.2862453
> [5,] 0.6461373 0.6276568 1.0542745 1.1418126 1.1528617 0.9092223 
> 0.9934012
> 1.1344761
> [6,] 0.8250085 0.8793621 1.1992136 1.2125849 1.0354504 0.7120037 
> 0.7247559
> 0.9688964
> [7,] 0.9807106 0.9699396 1.1383020 1.2513357 1.0535681 0.6902746 
> 0.5236274
> 0.7410255
> [8,] 1.1267014 1.1687508 1.4273059 1.4824497 1.2482844 0.8076505 
> 0.5904691
> 0.7107391
>
>
> I will have to run this operation about 300.000 times in a parameter 
> estimation routine, so I was wondering if anyone could point me at an 
> efficient way of filtering that avoids the nested for loop.
> Thanks.
> Roland
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 96, Issue 21


From spluque at gmail.com  Tue Aug 23 21:16:47 2011
From: spluque at gmail.com (Sebastian P. Luque)
Date: Tue, 23 Aug 2011 14:16:47 -0500
Subject: [R-sig-Geo] rgdal cannot load shared object
Message-ID: <87fwksos4g.fsf@kolob.subpolar.dyndns.org>

Hello,

I'm on a Debian sid system, and after a an upgrade of packages ('apt-get
upgrade') over the weekend, loading rgdal no longer works:

---<--------------------cut here---------------start------------------->---
R> library(rgdal)
Loading required package: sp
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '/usr/local/lib/R/site-library/rgdal/libs/rgdal.so':
  /usr/lib/libgdal1.7.0.so.1: undefined symbol: _ZN6libdap10AISConnectC1ERKSs
Error: package/namespace load failed for 'rgdal'
R> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8     LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8   
 [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_0.9-84           slmisc_0.8.9        latticeExtra_0.6-18 RColorBrewer_1.0-5  lattice_0.19-31    

loaded via a namespace (and not attached):
[1] grid_2.13.1
---<--------------------cut here---------------end--------------------->---

For libgdal libraries the system has:

---<--------------------cut here---------------start------------------->---
$ apt-show-versions -r -p 'libgdal.+'
libgdal-doc/sid uptodate 1.7.3-5
libgdal1-1.6.0/squeeze uptodate 1.6.3-4+b1
libgdal1-1.7.0/sid uptodate 1.7.3-5
libgdal1-dev/sid uptodate 1.7.3-5
---<--------------------cut here---------------end--------------------->---

I could remove the 1.6.0 version, but some packages still require it.

Does rgdal need to be updated due to new gdal libraries, or is this a
Debian-specific problem?  I posted to the R Debian list yesterday, so
apologies if you read this twice.

Cheers,

-- 
Seb


From gos47 at hotmail.com  Wed Aug 24 06:55:28 2011
From: gos47 at hotmail.com (=?iso-8859-1?Q?Gaspar_Reyes_P=F3ndigo?=)
Date: Tue, 23 Aug 2011 23:55:28 -0500
Subject: [R-sig-Geo] Error slot
In-Reply-To: <CAP8THHVDx_sbmAgD-Sq3F6gw58DQMJBLnC7TowmFGpWjbYcNmQ@mail.gmail.com>
References: <BLU0-SMTP1593CC5DF219EAF3FB99251B72F0@phx.gbl>
	<CAP8THHVDx_sbmAgD-Sq3F6gw58DQMJBLnC7TowmFGpWjbYcNmQ@mail.gmail.com>
Message-ID: <BLU0-SMTP27664A311D5B7B6B7C4A1A4B7110@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110823/feb0e8d9/attachment.pl>

From gos47 at hotmail.com  Wed Aug 24 07:06:12 2011
From: gos47 at hotmail.com (=?iso-8859-1?Q?Gaspar_Reyes_P=F3ndigo?=)
Date: Wed, 24 Aug 2011 00:06:12 -0500
Subject: [R-sig-Geo] Videos of the GEOSTAT summer school freely
	available and downloadable
In-Reply-To: <CAGfc75m_ibQYmQCcav2O4H0r6wCSH+VrfREgPxdkYi7NsP=gpw@mail.gmail.com>
References: <2A8C0AC9-B878-4AFD-A235-F8023ACA4A4A@ecotoxicology.de>
	<0EDFDA89-C1CF-437F-A41D-09C6CAEF101D@uni-landau.de>
	<F8317615-2DB7-4594-9CB5-72CED9788853@ecotoxicology.de>
	<CAGfc75m_ibQYmQCcav2O4H0r6wCSH+VrfREgPxdkYi7NsP=gpw@mail.gmail.com>
Message-ID: <BLU0-SMTP1248D787FBEE7761FC115A5B7110@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110824/0b8f28ab/attachment.pl>

From martin_brandt at gmx.net  Wed Aug 24 11:07:47 2011
From: martin_brandt at gmx.net (Martin)
Date: Wed, 24 Aug 2011 02:07:47 -0700 (PDT)
Subject: [R-sig-Geo] importing and exporting multiple rasters and keeping
 original filename
Message-ID: <1314176867665-6719381.post@n2.nabble.com>

Hi,

I have a little problem. I want to import a bunch of rasters to R, do some
modifications, and export them again. 

I import them, create a stack or brick, and write everything to a multiband
file which can be opened by GRASS with writeRaster. However, doing this, all
original filenames are lost (I tried all possible formats).

Is there a way to save a stack to a multiband file and keep the original
names, or do I have to work with loops and seperate raster files?

like that:

for (f in list.files(pattern='1999_*')){ 
assign(f, raster(f)) 
} 

that works, but isn't very neat, and I struggle using loops with
writeRaster...





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/importing-and-exporting-multiple-rasters-and-keeping-original-filename-tp6719381p6719381.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vandita at iirs.gov.in  Wed Aug 24 11:51:22 2011
From: vandita at iirs.gov.in (Vandita Srivastava)
Date: Wed, 24 Aug 2011 16:21:22 +0630
Subject: [R-sig-Geo] Problem calling readGDAL (R package rgdal) from Matlab
In-Reply-To: <1314176867665-6719381.post@n2.nabble.com>
References: <1314176867665-6719381.post@n2.nabble.com>
Message-ID: <20110824095122.M79023@iirs.gov.in>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110824/d26f9960/attachment.pl>

From vandita at iirs.gov.in  Wed Aug 24 11:49:18 2011
From: vandita at iirs.gov.in (Vandita Srivastava)
Date: Wed, 24 Aug 2011 16:19:18 +0630
Subject: [R-sig-Geo] importing and exporting multiple rasters and
	keeping original filename
In-Reply-To: <1314176867665-6719381.post@n2.nabble.com>
References: <1314176867665-6719381.post@n2.nabble.com>
Message-ID: <20110824094006.M99251@iirs.gov.in>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110824/b85f88c2/attachment.pl>

From matthieu.stigler at gmail.com  Wed Aug 24 11:53:12 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Wed, 24 Aug 2011 11:53:12 +0200
Subject: [R-sig-Geo] Strategy to crop margins in map by spplot()?
Message-ID: <4E54CA08.9020709@gmail.com>

Hi

I would like to plot a map in a latex document, but would like to remove 
the big margins above and below the map in the pdf...

How can one remove these margins, and yet produce a rectangular map as 
shown on screen? I did not find the arguments in the spplot() to change 
the margins? Or is it simpler to try to crop it in latex directly?

Thanks!

Matthieu


From Roger.Bivand at nhh.no  Wed Aug 24 12:32:07 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 24 Aug 2011 12:32:07 +0200 (CEST)
Subject: [R-sig-Geo] Problem calling readGDAL (R package rgdal) from
 Matlab
In-Reply-To: <20110824095122.M79023@iirs.gov.in>
References: <1314176867665-6719381.post@n2.nabble.com>
	<20110824095122.M79023@iirs.gov.in>
Message-ID: <alpine.LRH.2.00.1108241224080.21383@reclus.nhh.no>

On Wed, 24 Aug 2011, Vandita Srivastava wrote:

> To: r-sig-geo at r-project.org
>
> Subject:
>
> Problem calling readGDAL (R package rgdal) from Matlab
>
> Hi,

Good, you've realised that you posted with someone else's subject. 
However still very bad, because you posted in the original poster's 
thread (twice), once with his subject, once with yours. When posting, 
never, ever, use an existing thread for a new posting. Alway start a new 
thread by writing a new completely email to the list.

>
> I am facing a problem while trying to call R (version 2.13.1) functions 
> from within Matlab (Version 7.8.0 R2009a).
>
> I am trying to read an image via RGDAL in R for further processing in R. 
> I get following error when I try to do this from Matlab:
>
> K>> evalR('img <- readgdal("testimg_p.tif")');

Why would you expect R from Matlab or anything else not to be 
case-sensitive? The function is named readGDAL(), so use its name. There 
is no readgdal() function, is there?

Roger

> ??? Error using ==> evalR at 58
> Problem evaluating command img <-
> readgdal("testimg_p.tif").
> Invoke Error, Dispatch Exception: Object is static;
> operation not allowed
>
> I have an open R session and also have called rgdal library before i executed this command and there was no error on any stage before this. From R the command works fine and I checked it. Here is the R prompt status:
>
>> img <- readGDAL("testimg_p.tif")
> testimg_p.tif has GDAL driver GTiff
> and has 280 rows and 272 columns
>
> Kindly help me solve this problem.
>
> Waiting for response/solution to my problem.
>
> Regards,
>
> Vandita
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zenlines at gmail.com  Wed Aug 24 13:12:12 2011
From: zenlines at gmail.com (Brian Oney)
Date: Wed, 24 Aug 2011 13:12:12 +0200
Subject: [R-sig-Geo] Strategy to crop margins in map by spplot()?
Message-ID: <4E54DC8C.7080807@gmail.com>

Hi Matthieu,
As spplot is "just" a wrapper for the lattice package. It helps to 
know/learn a thing about the lattice package.
The control of graphical parameters in the lattice package is extremely 
fine.

Here is one working example changing the layout parameters:
library(sp)
library(lattice) # required for trellis.par.set():
trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()

data(meuse)
coordinates(meuse)=~x+y
## coloured points plot with legend in plotting area and scales:
spplot(meuse, "zinc", do.log = TRUE,
     key.space=list(x=0.2,y=0.9,corner=c(0,1)),
     scales=list(draw=T))

### Do a bit of exploring in lattice
trellis.pars.save <- trellis.par.get() # for good measure
trellis.pars <- trellis.par.get()
names(trellis.pars)
names(trellis.pars$layout.heights)
layout.height <- trellis.par.get("layout.heights")
names(layout.height)
layout.height$top.padding
layout.height$top.padding <- 0 ### here is where margins etc. can be changed

trellis.par.set(layout.heights = layout.height)
### now try it again
spplot(meuse, "zinc", do.log = TRUE,
     key.space=list(x=0.2,y=0.9,corner=c(0,1)),
     scales=list(draw=T))
windows() ### open a new plotting device to compare with other plots

### Put it back to the defaults
trellis.par.set(layout.heights = trellis.pars.save$layout.heights)

I recall that sweaving with the lattice package presents some problems, 
but can't remember exactly. If there are problems, I would "manually" 
insert it i.e.:


<<echo=FALSE,results=tex>>=
### this should work but not so sure.
png(file="graph.png", width = 4, height = 5,units='in',res=900)
spplot(something)
dev.null <- dev.off()
cat("\\includegraphics[width=0.95\\textwidth]{graph}\n\n", sep="")
@

hth,
Brian


From Roger.Bivand at nhh.no  Wed Aug 24 13:30:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 24 Aug 2011 13:30:37 +0200
Subject: [R-sig-Geo] rgdal cannot load shared object
In-Reply-To: <87fwksos4g.fsf@kolob.subpolar.dyndns.org>
References: <87fwksos4g.fsf@kolob.subpolar.dyndns.org>
Message-ID: <alpine.LRH.2.00.1108241317350.21383@reclus.nhh.no>

On Tue, 23 Aug 2011, Sebastian P. Luque wrote:

> Hello,
>
> I'm on a Debian sid system, and after a an upgrade of packages ('apt-get
> upgrade') over the weekend, loading rgdal no longer works:

Debian GIS packages are not reliable. The CRAN debian checks failed in 
mid-May with a libgdal upgrade, which got resolved after some time without 
clear diagnoses - possibly an upstream dependency issue in something one 
libgdal build depended on and another not. General advice with Debian and 
derivative systems is to install GDAL from source if possible to avoid 
this kind of issue. The feel of the error message is that some components 
have been built with different C++ versions, so your question about 
re-installing rgdal for upgraded GDAL binaries has two answers, no if C++ 
and its libraries have not changed, yes if they have.

I haven't seen a reply on R-sig-debian, so please report back there too if 
you make progress.

Hope this helps,

Roger

>
> ---<--------------------cut here---------------start------------------->---
> R> library(rgdal)
> Loading required package: sp
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared object '/usr/local/lib/R/site-library/rgdal/libs/rgdal.so':
>  /usr/lib/libgdal1.7.0.so.1: undefined symbol: _ZN6libdap10AISConnectC1ERKSs
> Error: package/namespace load failed for 'rgdal'
> R> sessionInfo()
> R version 2.13.1 (2011-07-08)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8     LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
> [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_0.9-84           slmisc_0.8.9        latticeExtra_0.6-18 RColorBrewer_1.0-5  lattice_0.19-31
>
> loaded via a namespace (and not attached):
> [1] grid_2.13.1
> ---<--------------------cut here---------------end--------------------->---
>
> For libgdal libraries the system has:
>
> ---<--------------------cut here---------------start------------------->---
> $ apt-show-versions -r -p 'libgdal.+'
> libgdal-doc/sid uptodate 1.7.3-5
> libgdal1-1.6.0/squeeze uptodate 1.6.3-4+b1
> libgdal1-1.7.0/sid uptodate 1.7.3-5
> libgdal1-dev/sid uptodate 1.7.3-5
> ---<--------------------cut here---------------end--------------------->---
>
> I could remove the 1.6.0 version, but some packages still require it.
>
> Does rgdal need to be updated due to new gdal libraries, or is this a
> Debian-specific problem?  I posted to the R Debian list yesterday, so
> apologies if you read this twice.
>
> Cheers,
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matthieu.stigler at gmail.com  Wed Aug 24 14:16:03 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Wed, 24 Aug 2011 14:16:03 +0200
Subject: [R-sig-Geo] Strategy to crop margins in map by spplot()?
In-Reply-To: <4E54DC8C.7080807@gmail.com>
References: <4E54DC8C.7080807@gmail.com>
Message-ID: <4E54EB83.80107@gmail.com>

Thanks a lot Brian!

It seems however that spplot() creates the big above/bottom margins with 
another trick than layout.height$top.padding.... I tried removing 
everything, yet I still have huge margins...

Any idea which parameter to change to remove margins? See code below!

Thanks!!!

Matthieu

library(maptools)
library(lattice)

data(wrld_simpl) #sorry, this is so slow, but is the only polygon 
shapefile available by default I think?
x11(type="Xlib") #should be slightly faster
spplot(wrld_simpl, "SUBREGION")

theme.novpadding <-
    list(layout.heights =
         list(top.padding = 0,
              main.key.padding = 0,
              key.axis.padding = 0,
              axis.xlab.padding = 0,
              xlab.key.padding = 0,
              key.sub.padding = 0,
              bottom.padding = 0),
         layout.widths =
         list(left.padding = 0,
              key.ylab.padding = 0,
              ylab.axis.padding = 0,
              axis.key.padding = 0,
              right.padding = 0))
spplot(wrld_simpl, "SUBREGION",    par.settings = theme.novpadding)

Le 24/08/2011 13:12, Brian Oney a ?crit :
> Hi Matthieu,
> As spplot is "just" a wrapper for the lattice package. It helps to 
> know/learn a thing about the lattice package.
> The control of graphical parameters in the lattice package is 
> extremely fine.
>
> Here is one working example changing the layout parameters:
> library(sp)
> library(lattice) # required for trellis.par.set():
> trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
>
> data(meuse)
> coordinates(meuse)=~x+y
> ## coloured points plot with legend in plotting area and scales:
> spplot(meuse, "zinc", do.log = TRUE,
>     key.space=list(x=0.2,y=0.9,corner=c(0,1)),
>     scales=list(draw=T))
>
> ### Do a bit of exploring in lattice
> trellis.pars.save <- trellis.par.get() # for good measure
> trellis.pars <- trellis.par.get()
> names(trellis.pars)
> names(trellis.pars$layout.heights)
> layout.height <- trellis.par.get("layout.heights")
> names(layout.height)
> layout.height$top.padding
> layout.height$top.padding <- 0 ### here is where margins etc. can be 
> changed
>
> trellis.par.set(layout.heights = layout.height)
> ### now try it again
> spplot(meuse, "zinc", do.log = TRUE,
>     key.space=list(x=0.2,y=0.9,corner=c(0,1)),
>     scales=list(draw=T))
> windows() ### open a new plotting device to compare with other plots
>
> ### Put it back to the defaults
> trellis.par.set(layout.heights = trellis.pars.save$layout.heights)
>
> I recall that sweaving with the lattice package presents some 
> problems, but can't remember exactly. If there are problems, I would 
> "manually" insert it i.e.:
>
>
> <<echo=FALSE,results=tex>>=
> ### this should work but not so sure.
> png(file="graph.png", width = 4, height = 5,units='in',res=900)
> spplot(something)
> dev.null <- dev.off()
> cat("\\includegraphics[width=0.95\\textwidth]{graph}\n\n", sep="")
> @
>
> hth,
> Brian
>


From roman.lustrik at gmail.com  Wed Aug 24 14:33:31 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 24 Aug 2011 14:33:31 +0200
Subject: [R-sig-Geo] importing and exporting multiple rasters and
 keeping original filename
In-Reply-To: <CABUG3Fs3_Vp5vH3iLi5icuRyhpxG0hsfNT2cz+FJDVKDH=Envw@mail.gmail.com>
References: <1314176867665-6719381.post@n2.nabble.com>
	<CAHT1vpgvjX6AFrxoy9Nas+=+oBLV_nmMT-GRcEBe+68rpdQ-zw@mail.gmail.com>
	<CABUG3Fs3_Vp5vH3iLi5icuRyhpxG0hsfNT2cz+FJDVKDH=Envw@mail.gmail.com>
Message-ID: <CAHT1vpg4UuqTvfW-eZh6OU7ubJu41BKijovnaObYDK2PNfFwyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110824/dc869a34/attachment.pl>

From zenlines at gmail.com  Wed Aug 24 14:35:37 2011
From: zenlines at gmail.com (Brian Oney)
Date: Wed, 24 Aug 2011 14:35:37 +0200
Subject: [R-sig-Geo] Strategy to crop margins in map by spplot()?
In-Reply-To: <4E54EB83.80107@gmail.com>
References: <4E54DC8C.7080807@gmail.com> <4E54EB83.80107@gmail.com>
Message-ID: <4E54F019.5060807@gmail.com>

Hi Matthieu,
I was afraid of something like that. However, I see a difference with my 
plots.

Taking your code:

library(maptools)
library(lattice)

data(wrld_simpl) # the meuse data set has a nice way to create polygons, 
but no matter, the behavior is not different for different types of 
vector data
# x11(type="Xlib") # couldn't get this to work, but oh well
spplot(wrld_simpl, "SUBREGION")

cut.val <- -5 ### Just to force it.
theme.novpadding <-
    list(layout.heights =
         list(top.padding = cut.val,
              main.key.padding = cut.val,
              key.axis.padding = cut.val,
              axis.xlab.padding = cut.val,
              xlab.key.padding = cut.val,
              key.sub.padding = cut.val,
              bottom.padding = cut.val),
         layout.widths =
         list(left.padding = cut.val,
              key.ylab.padding = cut.val,
              ylab.axis.padding = cut.val,
              axis.key.padding = cut.val,
              right.padding = cut.val))

spplot(wrld_simpl, "SUBREGION",    par.settings = theme.novpadding)

Don't forget that spplot parameters: xlim and ylim are derived by 
default from the bounding box (xlim = bbox(obj)[1, ], ylim = 
bbox(obj)[2, ], thereby retaining the aspect ratio).
Therefore, if you have a "landscape"-oriented object, and you try to 
plot/save as .png with png() parameters where width is less that height 
(i.e. some ratio different than you aspect ration), R will do exactly 
what you tell it to, giving you big margins.

There are many ways to skin a cat. I would check the latter, before 
trying the former. R and the lattice plot functions have pretty good 
default values and for good reason.

hth,
Brian

On 8/24/2011 2:16 PM, Matthieu Stigler wrote:
> library(maptools)
> library(lattice)
>
> data(wrld_simpl) #sorry, this is so slow, but is the only polygon 
> shapefile available by default I think?
> x11(type="Xlib") #should be slightly faster
> spplot(wrld_simpl, "SUBREGION")
>
> theme.novpadding <-
>    list(layout.heights =
>         list(top.padding = 0,
>              main.key.padding = 0,
>              key.axis.padding = 0,
>              axis.xlab.padding = 0,
>              xlab.key.padding = 0,
>              key.sub.padding = 0,
>              bottom.padding = 0),
>         layout.widths =
>         list(left.padding = 0,
>              key.ylab.padding = 0,
>              ylab.axis.padding = 0,
>              axis.key.padding = 0,
>              right.padding = 0))
> spplot(wrld_simpl, "SUBREGION",    par.settings = theme.novpadding)


From martin_brandt at gmx.net  Wed Aug 24 15:32:29 2011
From: martin_brandt at gmx.net (Martin)
Date: Wed, 24 Aug 2011 06:32:29 -0700 (PDT)
Subject: [R-sig-Geo] importing and exporting multiple rasters and
 keeping original filename
In-Reply-To: <CAHT1vpg4UuqTvfW-eZh6OU7ubJu41BKijovnaObYDK2PNfFwyA@mail.gmail.com>
References: <1314176867665-6719381.post@n2.nabble.com>
	<CAHT1vpg4UuqTvfW-eZh6OU7ubJu41BKijovnaObYDK2PNfFwyA@mail.gmail.com>
Message-ID: <1314192749145-6720171.post@n2.nabble.com>

thanks Roman, that works :-)



-----
Martin Brandt

Department of Geography and
Regional Research
UZA II, Althanstr. 14
1090 Wien, AUSTRIA
http://geooekologie.univie.ac.at
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/importing-and-exporting-multiple-rasters-and-keeping-original-filename-tp6719381p6720171.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Jan.Quets at ua.ac.be  Wed Aug 24 17:15:49 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Wed, 24 Aug 2011 15:15:49 +0000
Subject: [R-sig-Geo] using 'for loop' for assigning saved function values of
 function envelope in spatstsat
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC014A7@xmail32.ad.ua.ac.be>

Hello I would like to put the code at the end of the mail in a for loop like:

for (i in 1:999){
  sims[i][[1]] = attr(env,"simfuns")$???
}

This is obviously not a problem for the left side of the equations.
However I have no clue what should replace the sim1, sim2, ..., sim999
creating and using a list of strings with objects the strings 'sim1', 'sim2',..., 'sim999' does not work. 

env is a envelope from spatstat where the argument 'savefuns' is set to 'TRUE'

Anyone an idea how to do this?

Thanks,
Jan

sims=list()
sims[1][[1]] = attr(env,"simfuns")$sim1
sims[2][[1]] = attr(env,"simfuns")$sim2
sims[3][[1]] = attr(env,"simfuns")$sim3
sims[4][[1]] = attr(env,"simfuns")$sim4
sims[5][[1]] = attr(env,"simfuns")$sim5
sims[6][[1]] = attr(env,"simfuns")$sim6
sims[7][[1]] = attr(env,"simfuns")$sim7
sims[8][[1]] = attr(env,"simfuns")$sim8
sims[9][[1]] = attr(env,"simfuns")$sim9
sims[10][[1]] = attr(env,"simfuns")$sim10

. . .

sims[999][[1]]=attr(env,"simfuns")$sim999

From spluque at gmail.com  Wed Aug 24 17:19:16 2011
From: spluque at gmail.com (Sebastian P.Luque)
Date: Wed, 24 Aug 2011 10:19:16 -0500
Subject: [R-sig-Geo] rgdal cannot load shared object
In-Reply-To: <alpine.LRH.2.00.1108241317350.21383@reclus.nhh.no> (Roger
	Bivand's message of "Wed, 24 Aug 2011 13:30:37 +0200")
References: <87fwksos4g.fsf@kolob.subpolar.dyndns.org>
	<alpine.LRH.2.00.1108241317350.21383@reclus.nhh.no>
Message-ID: <87vctmon0r.fsf@kolob.subpolar.dyndns.org>

On Wed, 24 Aug 2011 13:30:37 +0200,
Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 23 Aug 2011, Sebastian P. Luque wrote:
>> Hello,

>> I'm on a Debian sid system, and after a an upgrade of packages
>> ('apt-get upgrade') over the weekend, loading rgdal no longer works:

> Debian GIS packages are not reliable. The CRAN debian checks failed in
> mid-May with a libgdal upgrade, which got resolved after some time
> without clear diagnoses - possibly an upstream dependency issue in
> something one libgdal build depended on and another not. General
> advice with Debian and derivative systems is to install GDAL from
> source if possible to avoid this kind of issue. The feel of the error
> message is that some components have been built with different C++
> versions, so your question about re-installing rgdal for upgraded GDAL
> binaries has two answers, no if C++ and its libraries have not
> changed, yes if they have.

> I haven't seen a reply on R-sig-debian, so please report back there
> too if you make progress.

Thanks Roger; I tried reinstalling rgdal, and got some more clues
following install.packages("rgdal") (relevant lines only):

---<--------------------cut here---------------start------------------->---
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3366: ./proj_conf_test: No such file or directory
PROJ.4 Version 4.7 or earlier
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3409: ./proj_conf_test: No such file or directory
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3459: ./proj_conf_test: No such file or directory
---<--------------------cut here---------------end--------------------->---

and:

---<--------------------cut here---------------start------------------->---
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3366: ./proj_conf_test: No such file or directory
PROJ.4 Version 4.7 or earlier
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3409: ./proj_conf_test: No such file or directory
/usr/lib/libgdal1.7.0.so: undefined reference to `libdap::AISConnect::AISConnect(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: ld returned 1 exit status
./configure: line 3459: ./proj_conf_test: No such file or directory
---<--------------------cut here---------------end--------------------->---

in addition to the error I previously reported.  So AFAICS, it seems
like a problem with Debian sid's libgdal1-1.7.0 or one of the libdap
packages, given the "undefined reference to
'libdap::AISConnect::AISConnect(std::basic_string<char,
std::char_traits<char>, std::allocator<char> > const&)' line.

Cheers,

-- 
Seb


From roman.lustrik at gmail.com  Wed Aug 24 18:03:41 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 24 Aug 2011 18:03:41 +0200
Subject: [R-sig-Geo] using 'for loop' for assigning saved function
 values of function envelope in spatstsat
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC014A7@xmail32.ad.ua.ac.be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC014A7@xmail32.ad.ua.ac.be>
Message-ID: <CAHT1vpiELzzXnjesDcLWMbSgQcedW4EyxmbEfw1=XnnOZoe=FQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110824/ea6778af/attachment.pl>

From Jan.Quets at ua.ac.be  Wed Aug 24 18:58:42 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Wed, 24 Aug 2011 16:58:42 +0000
Subject: [R-sig-Geo] using 'for loop' for assigning saved function
 values of function envelope in spatstsat
In-Reply-To: <CAHT1vpiELzzXnjesDcLWMbSgQcedW4EyxmbEfw1=XnnOZoe=FQ@mail.gmail.com>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC014A7@xmail32.ad.ua.ac.be>,
	<CAHT1vpiELzzXnjesDcLWMbSgQcedW4EyxmbEfw1=XnnOZoe=FQ@mail.gmail.com>
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC014ED@xmail32.ad.ua.ac.be>

env is an object created with the function envelope in spatstat.

env has an attribute "simfuns" which you can "see" by typing:

attr(env,"simfuns")

this attribute of envelope is in itself a list (or whatever it is called?) of (in this case) 99 vectors

the first vector you can access by typing:

attr(env,"simfuns")$sim1

the 39th one (for example) by

attr(env,"simfuns")$sim39

let's say I create a list named 'a' with of the five first vectors of attr(env,"simfuns"). I do this like this:

A=list()

A[1][[1]] = attr(env,"simfuns")$sim1
A[2][[1]] = attr(env,"simfuns")$sim2
A[3][[1]] = attr(env,"simfuns")$sim3
A[4][[1]] = attr(env,"simfuns")$sim4
A[5][[1]] = attr(env,"simfuns")$sim5


However this is a rather cumbersome way to assign these vectors to list A, especially if there are much more vectors in attr(env,"simfuns") to assign to list A (in this case 99).

a for loop would be the right tool to do this, but I don't know how to do because the code below didn't work:

B=list()

for (i in 1:99){
B[i][[1]]=paste("sim",i,sep="")
}

for (i in 1:99){
A[i][[1]] = attr(env,"simfuns")$B[i][[1]]
}

I hope it is more clear now,

Thank you!

________________________________________
Van: romunov at gmail.com [romunov at gmail.com] namens Roman Lu?trik [roman.lustrik at gmail.com]
Verzonden: woensdag 24 augustus 2011 18:03
Aan: Quets Jan
CC: r-sig-geo at r-project.org
Onderwerp: Re: [R-sig-Geo] using 'for loop' for assigning saved function values of function envelope in spatstsat

You can try paste and "[" (or "[[", depends on your needs).

x <- list(sim = 1:3)
x[paste("sim", 1, sep = "")]

Cheers,
Roman

p.s.
What you're trying to do seems a bit "hacky". What exactly are you trying to achieve, maybe there's a more elegant solution?





On Wed, Aug 24, 2011 at 5:15 PM, Quets Jan <Jan.Quets at ua.ac.be<mailto:Jan.Quets at ua.ac.be>> wrote:
Hello I would like to put the code at the end of the mail in a for loop like:

for (i in 1:999){
 sims[i][[1]] = attr(env,"simfuns")$???
}

This is obviously not a problem for the left side of the equations.
However I have no clue what should replace the sim1, sim2, ..., sim999
creating and using a list of strings with objects the strings 'sim1', 'sim2',..., 'sim999' does not work.

env is a envelope from spatstat where the argument 'savefuns' is set to 'TRUE'

Anyone an idea how to do this?

Thanks,
Jan

sims=list()
sims[1][[1]] = attr(env,"simfuns")$sim1
sims[2][[1]] = attr(env,"simfuns")$sim2
sims[3][[1]] = attr(env,"simfuns")$sim3
sims[4][[1]] = attr(env,"simfuns")$sim4
sims[5][[1]] = attr(env,"simfuns")$sim5
sims[6][[1]] = attr(env,"simfuns")$sim6
sims[7][[1]] = attr(env,"simfuns")$sim7
sims[8][[1]] = attr(env,"simfuns")$sim8
sims[9][[1]] = attr(env,"simfuns")$sim9
sims[10][[1]] = attr(env,"simfuns")$sim10

. . .

sims[999][[1]]=attr(env,"simfuns")$sim999
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
In God we trust, all others bring data.


From mathieu.rajerison at gmail.com  Thu Aug 25 10:12:55 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 25 Aug 2011 10:12:55 +0200
Subject: [R-sig-Geo] spacetime::stplot: problem overlaying a SpatialLines
 object over a STIDF points map
Message-ID: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/ce50849e/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Aug 25 12:35:17 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 25 Aug 2011 12:35:17 +0200
Subject: [R-sig-Geo] spacetime::stplot: problem overlaying a
 SpatialLines object over a STIDF points map
In-Reply-To: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>
References: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>
Message-ID: <4E562565.8080303@uni-muenster.de>

Hi Mathieu,

the idea behind stplot is indeed that it should be as easy as spplot,
hence its name. This idea is however much easier than practice, as the
number of possible (and useful) plots for S/T data might be quite large.

I would be helpful if you could provide (or generate) a simple data set
of your type (STIDF), explain what it represents, and tell how you'd
want it to be plotted. Does stplot(ciotat.t) give what you want, i.e. is
passing the sp.layout the only problem?

Best regards,
--
Edzer


On 08/25/2011 10:12 AM, Mathieu Rajerison wrote:
> Hi,
> 
> 
> I have a STIDF points object named ciotat.t that I've tried to plot with a
> city contour named contour.
> 
> I tried this but it doesn't work:
>> stplot(ciotat.t, sp.layout= list("sp.lines", contour))
> 
> Also, this doesn't work:
>> stplot(ciotat.t, panel=function(...) {
>    sp.lines(contour)
>    panel.pointsplot(...)
>  })
> 
> I thought it was as easy as with spplot.The documentation tells that
> arguments are passed on to spplot in case of stplot.STFDF, and to xyplot in
> case of
> stplot.STIDF. So, the method may be a little different in my case (STIDF)?
> 
> Any help would be appreciated,
> 
> Mathieu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mathieu.rajerison at gmail.com  Thu Aug 25 13:28:39 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 25 Aug 2011 13:28:39 +0200
Subject: [R-sig-Geo] spacetime::stplot: problem overlaying a
 SpatialLines object over a STIDF points map
In-Reply-To: <4E562565.8080303@uni-muenster.de>
References: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>
	<4E562565.8080303@uni-muenster.de>
Message-ID: <CAGfc75kKxoD97bTCG4qOxRkDC1UH+Rrb1GX6zZobQQtOoWopKA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/eb5ed144/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Aug 25 13:56:05 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 25 Aug 2011 13:56:05 +0200
Subject: [R-sig-Geo] spacetime::stplot: problem overlaying a
 SpatialLines object over a STIDF points map
In-Reply-To: <CAGfc75kKxoD97bTCG4qOxRkDC1UH+Rrb1GX6zZobQQtOoWopKA@mail.gmail.com>
References: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>	<4E562565.8080303@uni-muenster.de>
	<CAGfc75kKxoD97bTCG4qOxRkDC1UH+Rrb1GX6zZobQQtOoWopKA@mail.gmail.com>
Message-ID: <4E563855.3080602@uni-muenster.de>

Thanks; for your case, with current spacetime,

stplot(ciotat.t, panel=function(x,y,...) {
   panel.xyplot(x,y,...)
   sp.lines(contour)
 }
)

might do what you need; I'll look into having sp.layout work the same
way as it does in spplot, for stplot'ing STIDF objects.

Best wishes,

On 08/25/2011 01:28 PM, Mathieu Rajerison wrote:
> Hi Edzer,
> 
> 
> Thanks for your answer.
> 
> stplot(ciotat.t) gives a good result:
> http://www.imagup.com/data/1128936911.html
> 
> It represents evolution of urbanization along time, each point being the
> date and location of the first building for the city "La Ciotat".
> 
> The object is irregular because each spatial location appears one time. I'd
> like to overlay the city contour of "La Ciotat" to better vizualize it.
> http://data.imagup.com/10/1128936911.png
> 
> I've sent on your email my STIDF object ciotat.t and my SpatialLines object
> contour I want to be overlaid, if you have some time to look after it.
> 
> Thanks a lot,
> 
> 
> Mathieu
> 
> 2011/8/25 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> 
>> Hi Mathieu,
>>
>> the idea behind stplot is indeed that it should be as easy as spplot,
>> hence its name. This idea is however much easier than practice, as the
>> number of possible (and useful) plots for S/T data might be quite large.
>>
>> I would be helpful if you could provide (or generate) a simple data set
>> of your type (STIDF), explain what it represents, and tell how you'd
>> want it to be plotted. Does stplot(ciotat.t) give what you want, i.e. is
>> passing the sp.layout the only problem?
>>
>> Best regards,
>> --
>> Edzer
>>
>>
>> On 08/25/2011 10:12 AM, Mathieu Rajerison wrote:
>>> Hi,
>>>
>>>
>>> I have a STIDF points object named ciotat.t that I've tried to plot with
>> a
>>> city contour named contour.
>>>
>>> I tried this but it doesn't work:
>>>> stplot(ciotat.t, sp.layout= list("sp.lines", contour))
>>>
>>> Also, this doesn't work:
>>>> stplot(ciotat.t, panel=function(...) {
>>>    sp.lines(contour)
>>>    panel.pointsplot(...)
>>>  })
>>>
>>> I thought it was as easy as with spplot.The documentation tells that
>>> arguments are passed on to spplot in case of stplot.STFDF, and to xyplot
>> in
>>> case of
>>> stplot.STIDF. So, the method may be a little different in my case
>> (STIDF)?
>>>
>>> Any help would be appreciated,
>>>
>>> Mathieu
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From karl at huftis.org  Thu Aug 25 15:22:45 2011
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 25 Aug 2011 15:22:45 +0200
Subject: [R-sig-Geo] Setting FID values when saving GML files with writeOGR
Message-ID: <j35ib5$h64$1@dough.gmane.org>

Dear list members,

Is it possible to define which FID values should be used when 
saving a SpatialPointsDataFrame to a GML files using writeOGR 
(rgdal package)?

The FID values are stored as <ogr:layername fid="F0"> (and F1, 
F2, ?). If I insert a new row in the SPDF, most features change 
their FID, which creates much unneccessary noise in our VCS,
so I would like to use an already existing ID as the FID.

I have tried change both the row.names and adding columns named
?fid? and ?gml_id?, the writeOGR still only uses F0, F1, ? as 
the FIDs.

-- 
Karl Ove Hufthammer


From worx.of.mine at gmail.com  Thu Aug 25 16:00:04 2011
From: worx.of.mine at gmail.com (Reza Salimi-Khorshidi)
Date: Thu, 25 Aug 2011 15:00:04 +0100
Subject: [R-sig-Geo] Choropleth in R
Message-ID: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/0644dce7/attachment.pl>

From timothy.mutsvari at student.kuleuven.be  Thu Aug 25 16:17:02 2011
From: timothy.mutsvari at student.kuleuven.be (Timothy Mutsvari)
Date: Thu, 25 Aug 2011 14:17:02 +0000
Subject: [R-sig-Geo] CAR proper
Message-ID: <F795270DDEB9C349B91D761F9E2551BD08388D01@ICTS-S-MBX1.luna.kuleuven.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/cd133687/attachment.pl>

From spluque at gmail.com  Thu Aug 25 16:20:14 2011
From: spluque at gmail.com (Sebastian P. Luque)
Date: Thu, 25 Aug 2011 09:20:14 -0500
Subject: [R-sig-Geo] rgdal cannot load shared object
In-Reply-To: <CAGhLh6H--51ZN-Z_t=tnDkQopM6PAdCmWRKxCpqNbjPXQdVXfw@mail.gmail.com>
	(Rainer M. Krug's message of "Thu, 25 Aug 2011 11:15:35 +0200")
References: <87ty99qzb0.fsf@kolob.subpolar.dyndns.org>
	<87hb56om1q.fsf@kolob.subpolar.dyndns.org>
	<CAGhLh6H--51ZN-Z_t=tnDkQopM6PAdCmWRKxCpqNbjPXQdVXfw@mail.gmail.com>
Message-ID: <87aaaxmv35.fsf@kolob.subpolar.dyndns.org>

On Thu, 25 Aug 2011 11:15:35 +0200,
Rainer M Krug <r.m.krug at gmail.com> wrote:

> On Wed, Aug 24, 2011 at 5:40 PM, Sebastian P. Luque <spluque at gmail.com>wrote:
>> On Wed, 24 Aug 2011 13:30:37 +0200,
>> Roger Bivand <Roger.Bivand at nhh.no> wrote:

>> > On Tue, 23 Aug 2011, Sebastian P. Luque wrote:
>> >> Hello,

>> >> I'm on a Debian sid system, and after a an upgrade of packages >>
>> ('apt-get upgrade') over the weekend, loading rgdal no longer works:

>> > Debian GIS packages are not reliable. The CRAN debian checks failed
>> in > mid-May with a libgdal upgrade, which got resolved after some
>> time > without clear diagnoses - possibly an upstream dependency
>> issue in > something one libgdal build depended on and another
>> not. General > advice with Debian and derivative systems is to
>> install GDAL from > source if possible to avoid this kind of
>> issue. The feel of the error > message is that some components have
>> been built with different C++ > versions, so your question about
>> re-installing rgdal for upgraded GDAL > binaries has two answers, no
>> if C++ and its libraries have not > changed, yes if they have.

>> > I haven't seen a reply on R-sig-debian, so please report back there
>> > too if you make progress.

>> Thanks Roger; I tried reinstalling rgdal, and got some more clues
>> following install.packages("rgdal") (relevant lines only):

>> /usr/lib/libgdal1.7.0.so: undefined reference to
>> `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3366: ./proj_conf_test: No
>> such file or directory PROJ.4 Version 4.7 or earlier
>> /usr/lib/libgdal1.7.0.so: undefined reference to
>> `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3409: ./proj_conf_test: No
>> such file or directory /usr/lib/libgdal1.7.0.so: undefined reference
>> to `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3459: ./proj_conf_test: No
>> such file or directory

>> and:

>> /usr/lib/libgdal1.7.0.so: undefined reference to
>> `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3366: ./proj_conf_test: No
>> such file or directory PROJ.4 Version 4.7 or earlier
>> /usr/lib/libgdal1.7.0.so: undefined reference to
>> `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3409: ./proj_conf_test: No
>> such file or directory /usr/lib/libgdal1.7.0.so: undefined reference
>> to `libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' collect2: ld
>> returned 1 exit status ./configure: line 3459: ./proj_conf_test: No
>> such file or directory

>> in addition to the error I previously reported.  So AFAICS, it seems
>> like a problem with Debian sid's libgdal1-1.7.0 or one of the libdap
>> packages, given the "undefined reference to
>> 'libdap::AISConnect::AISConnect(std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> > const&)' line.


> In my experience, proj usually points to something related to proj4 -
> are you sure that proj4 os properly installed, including dev files
> (not sure if needed, but likely)?

I think the problem comes from this bug:

http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=638294

because when I found this conflict, I went ahead and used "dpkg -i
--force-overwrite ..", which may have botched my libdap.  It looks like
we will soon have a new version.

Cheers,

-- 
Seb


From mathieu.rajerison at gmail.com  Thu Aug 25 17:07:40 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 25 Aug 2011 17:07:40 +0200
Subject: [R-sig-Geo] spacetime::stplot: problem overlaying a
 SpatialLines object over a STIDF points map
In-Reply-To: <4E563855.3080602@uni-muenster.de>
References: <CAGfc75mvE8a-T=XZuvky8+Eh479fHFZyvfbWFw2b4vKZyktM5w@mail.gmail.com>
	<4E562565.8080303@uni-muenster.de>
	<CAGfc75kKxoD97bTCG4qOxRkDC1UH+Rrb1GX6zZobQQtOoWopKA@mail.gmail.com>
	<4E563855.3080602@uni-muenster.de>
Message-ID: <CAGfc75k00WFfZir8ryLUVOZ-R2fEtEfWqSxWz7U0Hx9XSkW1SA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/38b04525/attachment.pl>

From lists at remoteinformation.com.au  Thu Aug 25 17:52:11 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Thu, 25 Aug 2011 23:52:11 +0800
Subject: [R-sig-Geo] Choropleth in R
In-Reply-To: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>
References: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>
Message-ID: <B90D9545-ABD8-4D38-B872-8EB916026A07@remoteinformation.com.au>

Try this book:

Bivand, R. S., Pebesma, E. J., & Gomez-Rubio, V. (2008). Applied spatial data analysis with R. Use R!, Use R! Series (p. 378). Springer.

Also, try to avoid cross-posting to multiple lists.

cheers

Ben


On 25/08/2011, at 10:00 PM, Reza Salimi-Khorshidi wrote:

> Hi all,
> I would like to use R in order to generate a Heatmap/Choropleth overlaid on
> the UK map. Can someone please help with finding the right package/code? Any
> help is much appreciated.
> Best, Reza
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ah3881 at bristol.ac.uk  Thu Aug 25 18:01:32 2011
From: ah3881 at bristol.ac.uk (Alice Hughes)
Date: Thu, 25 Aug 2011 17:01:32 +0100
Subject: [R-sig-Geo] Choropleth in R
In-Reply-To: <B90D9545-ABD8-4D38-B872-8EB916026A07@remoteinformation.com.au>
References: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>
	<B90D9545-ABD8-4D38-B872-8EB916026A07@remoteinformation.com.au>
Message-ID: <1923.172.21.95.38.1314288092.squirrel@webmail.bris.ac.uk>

Hello All

What extension/script should I use to run general mixed models in R

Thanks

Alice

On Thu, August 25, 2011 4:52 pm, Ben Madin wrote:
> Try this book:
>
> Bivand, R. S., Pebesma, E. J., & Gomez-Rubio, V. (2008). Applied spatial
> data analysis with R. Use R!, Use R! Series (p. 378). Springer.
>
> Also, try to avoid cross-posting to multiple lists.
>
> cheers
>
> Ben
>
>
> On 25/08/2011, at 10:00 PM, Reza Salimi-Khorshidi wrote:
>
>> Hi all,
>> I would like to use R in order to generate a Heatmap/Choropleth overlaid
>> on
>> the UK map. Can someone please help with finding the right package/code?
>> Any
>> help is much appreciated.
>> Best, Reza
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


--


From edzer.pebesma at uni-muenster.de  Thu Aug 25 23:19:45 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 25 Aug 2011 23:19:45 +0200
Subject: [R-sig-Geo] time slot in space-time sparse data frame
 (spacetime package)
In-Reply-To: <CAKRQQ2TGC3h5VX=SW3uDDsvYdxwhX6+L==t-OrHCiexyzrB4Kg@mail.gmail.com>
References: <CAKRQQ2TGC3h5VX=SW3uDDsvYdxwhX6+L==t-OrHCiexyzrB4Kg@mail.gmail.com>
Message-ID: <4E56BC71.8020402@uni-muenster.de>

Hi Jochen,

On 07/25/2011 06:54 PM, Jochen Albrecht wrote:
> Hi:
> 1. I am working with the spacetime package and have successfully ingested a
> dataset into its *irregular* space-time data frame using coordinates for
> space, an xts object for time and auxiliary data for the attribute data.
> Next I tried to create a sparse space-time data frame (i.e. a grid) using
> the same pieces of data is successfully used before, plus the additional
> index. The STSDF function choked on the xts data that I tried to provide it
> with. The documentation on the sparse space-time data frame is, excuse the
> pun, sparse. There is no indication that the data structure to represent
> time is any different. The exact error message I get is:
> Error in checkSlotAssignment(object, name, value) :
>   c("assignment of an object of class \"POSIXct\" is not valid for slot
> \"time\" in an object of class \"ST\"; is(value, \"xts\") is not TRUE",
> "assignment of an object of class \"POSIXt\" is not valid for slot \"time\"
> in an object of class \"ST\"; is(value, \"xts\") is not TRUE")

this has been improved; updating the package should be sufficient.

> 
> 2.  Unrelated to this I have a more general question of understanding. After
> creating and plotting the irregular space-time data frame, I tried to coerce
> it into a full grid, alas without success. Section 7.2 of the vignette
> illustrates how to move from a full grid to a sparse or irregular one and
> then back again. Could it be that starting with an irregular one does not
> work? I kind of would understand that because mere coercion does not provide
> all the information needed - which is why I ended up trying to create the
> gridded data frames directly (my first question).

This is indeed a bug; it will "work" in the next version (now in svn).
The bug occurs when no duplicate locations or time points are present;
if this is the case, coercion to the sparse or full grid representations
may not give what you want, it does not interpolation / aggregation /
density or whatever analysis you have in mind.

The following will work, but as you see, object sizes explode for the
STFDF representation if the data ARE irregular.

> library(spacetime)
> n = 1000
> x = runif(n)
> y = runif(n)
> t = Sys.time()+ runif(n)
> x = STIDF(SpatialPoints(cbind(x,y)), t, data.frame(x = runif(n)))
> object.size(x)
43236 bytes
> object.size(as(x, "STSDF"))
51404 bytes
> object.size(as(x, "STFDF"))
8031244 bytes

You may want, as an initial analysis, use the method over (see the
over.pdf vignette) to overlay your data with a regular ST layout, and
e.g. count or average something from your irregular data in the new ST
"blocks" you define.

> 
> 3.  Finally, the data that I am trying to massage are buoy paths expressed
> as a good 22 million individual space-time points. I was thinking of using
> the irregular space-time data frame structure to create the 14,855 buoy
> paths (all buoys send their location information every six hours, some buoys
> survive for up to eight years) and then to interpolate ocean current
> surfaces similar to the Irish wind example in the spacetime vignette. The
> vignette example uses full grids; will I be able to do that with the sparse
> space-time data frames because the full matrix of the full grid would
> certainly go beyond the capabilities of 'R'?

That depends on your soft- and hardware setup and the interpolation you
have in mind.

There is also a vignette describing how to work on subsets of larger
tables in a PostGIS data base -- admittedly a proof of concept work, but
it might be provide a starting point in case capacity is your problem.

Your email has been unanswered for a month; if you're still trying this
path (or perhaps found another), I'm interested to hear your experience.

Best regards,

> 
> Cheers,
>      Jochen
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Aug 26 08:42:44 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 26 Aug 2011 08:42:44 +0200 (CEST)
Subject: [R-sig-Geo] CAR proper
In-Reply-To: <F795270DDEB9C349B91D761F9E2551BD08388D01@ICTS-S-MBX1.luna.kuleuven.be>
References: <F795270DDEB9C349B91D761F9E2551BD08388D01@ICTS-S-MBX1.luna.kuleuven.be>
Message-ID: <alpine.LRH.2.00.1108260836490.29853@reclus.nhh.no>

On Thu, 25 Aug 2011, Timothy Mutsvari wrote:

>
> Dear users,
>
>  I'm getting the following error when trying to compile my BUGS code: 
> "error for node v[1] of type SpatialCARNormal.Node first argument vector 
> has wrong length.'

Is this an openBUGS question, an R question, or both? Could you provide 
sample R code using R2OpenBUGS if the latter? If you are using R, how did 
you calculate the vectors needed? are they the same or different lengths 
in R?

Roger

>    Here, v is a vector that has the car.normal prior of the form: v[1:N] ~ car.normal(Adj[],weights[],Num[],tau.c)
>
> Also,  - Num is vector of length N giving the number of neighbors for each node             - Adj is a vector of length = sum of Num[], with each entry being the index of a neighbor             - weights is a vector of length = sum of Num[], with each entry being 1. The model is syntactically correct and the data loads as well, but I get the above error when I compile. The data file is too large to attach here though I'd be happy to figure out a way to share it otherwise.      I've been stuck on this for over a month now and any help will be greatly appreciated.  I'm using OpenBUGS.
>
>
> model{  for (i in 1:N) {                Y[i] ~ dbin(p[i], 1)
> logit(p[i]) <- b0 + b1*income[i] + v[i]
> }
> v[1:N] ~ car.normal(Adj[],weights [],Num[],tau.c)
> b0 ~ dflat()
> b1 ~ dflat
> tau.c ~ dgamma(0.001, 0.001)
> }
>
> Regards,
> Timothy
> [L-Biostat]
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From leslaura at gmail.com  Fri Aug 26 08:47:43 2011
From: leslaura at gmail.com (Laura S)
Date: Thu, 25 Aug 2011 23:47:43 -0700
Subject: [R-sig-Geo] Ideas appreciated for spatial structure analysis
Message-ID: <CAHLsRK=ymaFNZc3_6JotNx5k2J=riV3SHPpwr5dVmJzP7FoTWg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110825/a50daa8f/attachment.pl>

From Adrian.Baddeley at csiro.au  Fri Aug 26 10:42:38 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 26 Aug 2011 16:42:38 +0800
Subject: [R-sig-Geo] using 'for loop' for assigning saved function values of
 function envelope in spatstsat
Message-ID: <57DC18C299094D4299F837570C5DF1C54E8A763616@EXWA-MBX01.nexus.csiro.au>

Jan Quets wrote:

> env is a envelope from spatstat where the argument 'savefuns' is set to 'TRUE'

> I would like to put the code at the end of the mail in a for loop like:

> for (i in 1:999){
>   sims[i][[1]] = attr(env,"simfuns")$???
> }

According to `help(envelope)' in the package 'spatstat',
  
          If savefuns=TRUE, the return value has an attribute "simfuns" 
          which is an object of class "fv" containing the summary functions 
          computed for each of the nsim simulated patterns. 

So if you do

          sf <- attr(env, "simfuns")

then 'sf' is an object of the class 'fv'. 

If you look at help(fv) you'll see that an 'fv' object inherits the class 'data.frame'.
(To convert it to just a data frame, use as.data.frame.) The "$" operator uses the method for data frames, so typing sf$sim42 just means you're extracting the column named 'sim42' from the data frame 'sf'. 

You want to extract several, selected, columns from 'sf' and store them as entries in a list. Suppose you want all the columns sim1, sim2, ...., sim999 but not the column labelled "r". Then do:

        df <- as.data.frame(sf)
        wantcolumns <- (names(df) != "r")
        subdf <- df[, wantcolumns]
        sims <- as.list(subdf)

Then sims[[i]] will be a vector containing the values of the i-th simulated function.

I'm not really sure what you're trying to do. It should be possible and easier to work with the data frame 'df' or 'subdf'

regards

Adrian Baddeley 


From christian.kamenik at giub.unibe.ch  Fri Aug 26 11:30:16 2011
From: christian.kamenik at giub.unibe.ch (Christian Kamenik)
Date: Fri, 26 Aug 2011 02:30:16 -0700 (PDT)
Subject: [R-sig-Geo] spacetime: remove NAs from STSDF object
In-Reply-To: <4E53B25E.8010509@uni-muenster.de>
References: <4E527A94.1020409@giub.unibe.ch> <4E53B25E.8010509@uni-muenster.de>
Message-ID: <1314351016115-6728013.post@n2.nabble.com>

Dear Edzer,

my.STSDF <- as(my.STFDF, "STSDF") does exactly what it should. I have a
STSDF object with several columns of data that have NAs for one variable but
not for other variables. I wanted to keep only those observations in space
and time that had data (no NAs) for all variables (see complete.cases).

Thanks, Christian


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spacetime-remove-NAs-from-STSDF-object-tp6712092p6728013.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mathieu.rajerison at gmail.com  Fri Aug 26 14:16:15 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 26 Aug 2011 14:16:15 +0200
Subject: [R-sig-Geo] stplot: choosing constant time interval between plots
Message-ID: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110826/5d21b126/attachment.pl>

From Jan.Quets at ua.ac.be  Fri Aug 26 14:55:02 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Fri, 26 Aug 2011 12:55:02 +0000
Subject: [R-sig-Geo] using 'for loop' for assigning saved function
 values of function envelope in spatstsat
In-Reply-To: <57DC18C299094D4299F837570C5DF1C54E8A763616@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C54E8A763616@EXWA-MBX01.nexus.csiro.au>
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC015BF@xmail32.ad.ua.ac.be>

Thank you,

this is what I need!
________________________________________
Van: Adrian.Baddeley at csiro.au [Adrian.Baddeley at csiro.au]
Verzonden: vrijdag 26 augustus 2011 10:42
Aan: r-sig-geo at r-project.org
CC: Quets Jan; Adrian.Baddeley at csiro.au; r.turner at auckland.ac.nz
Onderwerp: [R-sig-Geo] using 'for loop' for assigning saved function values of function envelope in spatstsat

Jan Quets wrote:

> env is a envelope from spatstat where the argument 'savefuns' is set to 'TRUE'

> I would like to put the code at the end of the mail in a for loop like:

> for (i in 1:999){
>   sims[i][[1]] = attr(env,"simfuns")$???
> }

According to `help(envelope)' in the package 'spatstat',

          If savefuns=TRUE, the return value has an attribute "simfuns"
          which is an object of class "fv" containing the summary functions
          computed for each of the nsim simulated patterns.

So if you do

          sf <- attr(env, "simfuns")

then 'sf' is an object of the class 'fv'.

If you look at help(fv) you'll see that an 'fv' object inherits the class 'data.frame'.
(To convert it to just a data frame, use as.data.frame.) The "$" operator uses the method for data frames, so typing sf$sim42 just means you're extracting the column named 'sim42' from the data frame 'sf'.

You want to extract several, selected, columns from 'sf' and store them as entries in a list. Suppose you want all the columns sim1, sim2, ...., sim999 but not the column labelled "r". Then do:

        df <- as.data.frame(sf)
        wantcolumns <- (names(df) != "r")
        subdf <- df[, wantcolumns]
        sims <- as.list(subdf)

Then sims[[i]] will be a vector containing the values of the i-th simulated function.

I'm not really sure what you're trying to do. It should be possible and easier to work with the data frame 'df' or 'subdf'

regards

Adrian Baddeley


From jamesbond6 at gmail.com  Fri Aug 26 15:40:03 2011
From: jamesbond6 at gmail.com (=?ISO-8859-2?Q?Micha=B3_Kwieci=F1ski?=)
Date: Fri, 26 Aug 2011 15:40:03 +0200
Subject: [R-sig-Geo] ASCII grid file - extracting data after import with
	readGDAL()
Message-ID: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>

Hi,

I am having difficulty in reading data for further use that is in
ASCII grid format (it's the UN population data from
http://sedac.ciesin.columbia.edu/gpw). I used readGDAL function which
leaves me with SpatialGridDataFrame class object, but apart from
creating simple image with

map = readGDAL("eur.asc", region.dim=c(889,1050), output.dim=c(889,1050))
image(map, col=topo.colors(256, alpha=1))

, I have no clue how to operate on this object. All I can see it
contains x and y coordinates, but any head() or summary() does not
provide me with information on how to refer to the actual data that
ASCII grid contains. And yet the image can be generated properly, so
the data obviously is somewhere there! I can see I theoretically
should find something under map["z"], but all I have is an error:

Error in `[.data.frame`(x at data, , i, drop = FALSE) :
  undefined columns selected



Or entire problem may be stated in terms of question: how do I set
colours for map like that (
http://sedac.ciesin.columbia.edu/gpw/maps/poldens.pdf )? (let's say I
want to manually set intervals for colouring the variable that is in
the grid file)

This is not the goal of my work with this data, but I believe the
solution do this problem has very much in common with general
operations on data from ascii grid file. Disregarding the need to
create beautiful maps, I can always try to use read.table (oh, wait,
the 5 MB bit freezes my R) and then use this data for other complex
spatial calculations that require also other data to be combined with
data from grid, but right now my problem is just as specified above.


Or maybe I should have used something else than readGDAL?


I am using R2.9.2, as any later version leaves me with blank output
instead of the image I want. Don't know the reason for it, but I
thought I will stay with the version that works instead of unnecessary
troubleshooting. I also wrote a program in C that extracted the europe
part of the world data, so that my ASCII file is 5 MB instead of 117
MB, but it appears to be OK, so I don't think the problem lies here.


From alexander.arpaci at boku.ac.at  Fri Aug 26 15:49:11 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Fri, 26 Aug 2011 15:49:11 +0200
Subject: [R-sig-Geo] Antw: ASCII grid file - extracting data after import
 with readGDAL()
Message-ID: <4E57C077020000030002292C@gwia1.boku.ac.at>

Hello,
I use the raster package for asci files 
it works great and has a very hands on access to get statistics or do
any kind of raster operations
hth
a


MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 
>>> Micha* Kwieci*ski 26.08.11 15.41 Uhr >>>
Hi,

I am having difficulty in reading data for further use that is in
ASCII grid format (it's the UN population data from
http://sedac.ciesin.columbia.edu/gpw). I used readGDAL function which
leaves me with SpatialGridDataFrame class object, but apart from
creating simple image with

map = readGDAL("eur.asc", region.dim=c(889,1050),
output.dim=c(889,1050))
image(map, col=topo.colors(256, alpha=1))

, I have no clue how to operate on this object. All I can see it
contains x and y coordinates, but any head() or summary() does not
provide me with information on how to refer to the actual data that
ASCII grid contains. And yet the image can be generated properly, so
the data obviously is somewhere there! I can see I theoretically
should find something under map["z"], but all I have is an error:

Error in `[.data.frame`(x at data, , i, drop = FALSE) :
  undefined columns selected



Or entire problem may be stated in terms of question: how do I set
colours for map like that (
http://sedac.ciesin.columbia.edu/gpw/maps/poldens.pdf )? (let's say I
want to manually set intervals for colouring the variable that is in
the grid file)

This is not the goal of my work with this data, but I believe the
solution do this problem has very much in common with general
operations on data from ascii grid file. Disregarding the need to
create beautiful maps, I can always try to use read.table (oh, wait,
the 5 MB bit freezes my R) and then use this data for other complex
spatial calculations that require also other data to be combined with
data from grid, but right now my problem is just as specified above.


Or maybe I should have used something else than readGDAL?


I am using R2.9.2, as any later version leaves me with blank output
instead of the image I want. Don't know the reason for it, but I
thought I will stay with the version that works instead of unnecessary
troubleshooting. I also wrote a program in C that extracted the europe
part of the world data, so that my ASCII file is 5 MB instead of 117
MB, but it appears to be OK, so I don't think the problem lies here.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From forrest at ufl.edu  Fri Aug 26 15:57:59 2011
From: forrest at ufl.edu (Forrest Stevens)
Date: Fri, 26 Aug 2011 09:57:59 -0400
Subject: [R-sig-Geo] ASCII grid file - extracting data after import with
	readGDAL()
In-Reply-To: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>
References: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>
Message-ID: <CAEBQMMnyGjyqt-47jFPkoOHT8W0i4g1=a0m3Hbef5pYFNOU9-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110826/4207e68e/attachment.pl>

From timothy.mutsvari at student.kuleuven.be  Fri Aug 26 15:58:37 2011
From: timothy.mutsvari at student.kuleuven.be (Timothy Mutsvari)
Date: Fri, 26 Aug 2011 13:58:37 +0000
Subject: [R-sig-Geo] CAR model
Message-ID: <F795270DDEB9C349B91D761F9E2551BD0838963E@ICTS-S-MBX1.luna.kuleuven.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110826/24f532dc/attachment.pl>

From landis at isciences.com  Fri Aug 26 16:26:50 2011
From: landis at isciences.com (Matthew Landis)
Date: Fri, 26 Aug 2011 10:26:50 -0400
Subject: [R-sig-Geo] ASCII grid file - extracting data after import with
 readGDAL()
In-Reply-To: <CAEBQMMnyGjyqt-47jFPkoOHT8W0i4g1=a0m3Hbef5pYFNOU9-g@mail.gmail.com>
References: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>
	<CAEBQMMnyGjyqt-47jFPkoOHT8W0i4g1=a0m3Hbef5pYFNOU9-g@mail.gmail.com>
Message-ID: <4E57AD2A.4090800@isciences.com>

If you want to see more info of the dataset, you can also view it with

str(map at data)

or
head(map at data)

Matt



On 8/26/2011 9:57 AM, Forrest Stevens wrote:
> As you said, readGDAL will give you a SpatialGridDataFrame object, which
> behaves much like a normal data.framet.  Your best bet is to run it through
> names to see what data are available to work with:
>
> names(map)
>
> Like a regular data.frame this will give you the bands or data read in from
> your ASCII grid, on which you can pull subsets or index like you would a
> normal vector (e.g. pretend your map object has "band1" as its only data,
> you can pull a subset of the first 10 grid values like this:
>
> map$band1[1:10]
>
> I hope that gets you closer to solving the rest of your question,

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From jamesbond6 at gmail.com  Fri Aug 26 16:45:02 2011
From: jamesbond6 at gmail.com (=?ISO-8859-2?Q?Micha=B3_Kwieci=F1ski?=)
Date: Fri, 26 Aug 2011 16:45:02 +0200
Subject: [R-sig-Geo] ASCII grid file - extracting data after import with
	readGDAL()
In-Reply-To: <4E57AD2A.4090800@isciences.com>
References: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>
	<CAEBQMMnyGjyqt-47jFPkoOHT8W0i4g1=a0m3Hbef5pYFNOU9-g@mail.gmail.com>
	<4E57AD2A.4090800@isciences.com>
Message-ID: <CACG6uXREyvBXCD8TDwB6i7nQt_xUZ47TqbjVNnvuaT=gB9Boxw@mail.gmail.com>

Learning about existence of "band1" was what I actually needed. Apart
from one bigger spatial econometrics project, I haven't done much work
with R yet, so I still lack some knowledge on basic operations - I
will try to remember about the names() function next time. I thought
the problem would lie somewhere deeper, shame on me.

> I use the raster package for asci files

It looks promising, I'll have a look into it. Thanks for the tip.

Thank you all for prompt replies and help, much appreciated.

Regards,
Michal Kwiecinski

2011/8/26 Matthew Landis <landis at isciences.com>:
> If you want to see more info of the dataset, you can also view it with
>
> str(map at data)
>
> or
> head(map at data)
>
> Matt
>
>
>
> On 8/26/2011 9:57 AM, Forrest Stevens wrote:
>>
>> As you said, readGDAL will give you a SpatialGridDataFrame object, which
>> behaves much like a normal data.framet. ?Your best bet is to run it
>> through
>> names to see what data are available to work with:
>>
>> names(map)
>>
>> Like a regular data.frame this will give you the bands or data read in
>> from
>> your ASCII grid, on which you can pull subsets or index like you would a
>> normal vector (e.g. pretend your map object has "band1" as its only data,
>> you can pull a subset of the first 10 grid values like this:
>>
>> map$band1[1:10]
>>
>> I hope that gets you closer to solving the rest of your question,
>
> --
> ~~~~~~~~~~~~~~~~~~~~~~~~~~
> Matthew Landis, Ph.D.
> Research Scientist
> ISciences, LLC
> 61 Main St. Suite 200
> Burlington VT 05401
> 802.864.2999
> ~~~~~~~~~~~~~~~~~~~~~~~~~~
>
>


From darribas at unizar.es  Fri Aug 26 18:01:06 2011
From: darribas at unizar.es (Daniel Arribas-Bel)
Date: Fri, 26 Aug 2011 18:01:06 +0200
Subject: [R-sig-Geo] Choropleth in R
Message-ID: <CAKrCUaUALTv7hCFF86BpxUVztj0p_1=4uqLQ3xnWWTD2+-0MQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110826/cbc13ed7/attachment.pl>

From landis at isciences.com  Fri Aug 26 19:09:26 2011
From: landis at isciences.com (Matthew Landis)
Date: Fri, 26 Aug 2011 13:09:26 -0400
Subject: [R-sig-Geo] ASCII grid file - extracting data after import with
 readGDAL()
In-Reply-To: <CACG6uXREyvBXCD8TDwB6i7nQt_xUZ47TqbjVNnvuaT=gB9Boxw@mail.gmail.com>
References: <CACG6uXQf24u8MSsHnZRtZm+jv6FKBMw==8MnH68b36pwkvRM7w@mail.gmail.com>
	<CAEBQMMnyGjyqt-47jFPkoOHT8W0i4g1=a0m3Hbef5pYFNOU9-g@mail.gmail.com>
	<4E57AD2A.4090800@isciences.com>
	<CACG6uXREyvBXCD8TDwB6i7nQt_xUZ47TqbjVNnvuaT=gB9Boxw@mail.gmail.com>
Message-ID: <4E57D346.4090803@isciences.com>

No worries.  good luck!

On 8/26/2011 10:45 AM, Micha? Kwieci?ski wrote:
> Learning about existence of "band1" was what I actually needed. Apart
> from one bigger spatial econometrics project, I haven't done much work
> with R yet, so I still lack some knowledge on basic operations - I
> will try to remember about the names() function next time. I thought
> the problem would lie somewhere deeper, shame on me.

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From Roger.Bivand at nhh.no  Fri Aug 26 19:45:34 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 26 Aug 2011 19:45:34 +0200
Subject: [R-sig-Geo] Setting FID values when saving GML files with
 writeOGR
In-Reply-To: <j35ib5$h64$1@dough.gmane.org>
References: <j35ib5$h64$1@dough.gmane.org>
Message-ID: <alpine.LRH.2.00.1108261939120.31153@reclus.nhh.no>

On Thu, 25 Aug 2011, Karl Ove Hufthammer wrote:

> Dear list members,
>
> Is it possible to define which FID values should be used when 
> saving a SpatialPointsDataFrame to a GML files using writeOGR 
> (rgdal package)?
>
> The FID values are stored as <ogr:layername fid="F0"> (and F1, 
> F2, ?). If I insert a new row in the SPDF, most features change 
> their FID, which creates much unneccessary noise in our VCS,
> so I would like to use an already existing ID as the FID.
>
> I have tried change both the row.names and adding columns named
> ?fid? and ?gml_id?, the writeOGR still only uses F0, F1, ? as 
> the FIDs.

No FID is set in writeOGR() in the underlying C++ function writeOGR(). One 
could be set, but only as unique integers >= 0, not as the row.names() 
which are strings. The result is that default FID are written. It would be 
possible to modify the function to add integer FID, I think, but they 
would have to be valid unique integers. I think that what gets 
written from there depends on the driver internals, which the 
function does not reach. Would this help? Patches welcome!

Best wishes,

Roger

>
> -- 
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Fri Aug 26 19:55:35 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 26 Aug 2011 19:55:35 +0200
Subject: [R-sig-Geo] stplot: choosing constant time interval between
	plots
In-Reply-To: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>
References: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>
Message-ID: <4E57DE17.1050403@uni-muenster.de>

Mathieu,

as stplot for STIDF's is still pretty "bare", or simple, you might as
well work directly with xyplot from lattice. Having your data, it turns
out you only have a limited number of dates, the following seems to work:

library(lattice)
xyplot(y_sref~x_sref|time,  as.data.frame(ciotat.t),
   scales=list(draw=F), asp="iso", xlab=NULL, ylab=NULL,
   panel = function(x,y,...) {
      sp.lines(contour);
      panel.xyplot(x,y,...)
   }
)

as stplot assumes time is irregular, it uses

xyplot(y_sref~x_sref | equal.count(time), ...

which bins time into a small number of classes.

Hth,

On 08/26/2011 02:16 PM, Mathieu Rajerison wrote:
> Hi,
> 
> 
> I have a question about stplot.
> 
> Let's say I'd like to plot via multi-panel a series of plots separated by a
> given time interval. How can I accomplish that?
> 
> Also, let's say this time interval is specified between thow given time
> instances, for example: every week between 14/07/11 and 28/08/11.
> 
> Is there a way in stplot to perform these operations?
> 
> 
> Any help would be greatly appreciated
> 
> *Again congrats for the powerful and easy-to-use spacetime package with
> strong documentation!*
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Aug 26 20:36:03 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 26 Aug 2011 20:36:03 +0200
Subject: [R-sig-Geo] Setting FID values when saving GML files with
 writeOGR
In-Reply-To: <alpine.LRH.2.00.1108261939120.31153@reclus.nhh.no>
References: <j35ib5$h64$1@dough.gmane.org>
	<alpine.LRH.2.00.1108261939120.31153@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1108262024570.31153@reclus.nhh.no>

On Fri, 26 Aug 2011, Roger Bivand wrote:

> On Thu, 25 Aug 2011, Karl Ove Hufthammer wrote:
>
>> Dear list members,
>> 
>> Is it possible to define which FID values should be used when saving a 
>> SpatialPointsDataFrame to a GML files using writeOGR (rgdal package)?
>> 
>> The FID values are stored as <ogr:layername fid="F0"> (and F1, F2, ?). If I 
>> insert a new row in the SPDF, most features change their FID, which creates 
>> much unneccessary noise in our VCS,
>> so I would like to use an already existing ID as the FID.
>> 
>> I have tried change both the row.names and adding columns named
>> ?fid? and ?gml_id?, the writeOGR still only uses F0, F1, ? as the FIDs.
>
> No FID is set in writeOGR() in the underlying C++ function writeOGR(). One 
> could be set, but only as unique integers >= 0, not as the row.names() which 
> are strings. The result is that default FID are written. It would be possible 
> to modify the function to add integer FID, I think, but they would have to be 
> valid unique integers. I think that what gets written from there depends on 
> the driver internals, which the function does not reach. Would this help? 
> Patches welcome!

Indeed, the driver internals are a possible solution, see:

http://www.gdal.org/ogr/drv_gml.html

which suggests that some reading is possible in OGR >= 1.8.0, but that 
writing will first come with OGR >= 1.9.0, that is the development 
version, I believe. If this really matters for you, please look carefully 
at commits on the GDAL trunk in the GML driver. I think that there have 
been recent developments, with increased speed claimed. Consequently, 
there isn't much that can be done from the R side, you'll need an rgdal 
built against a future version of GDAL/OGR.

Roger

>
> Best wishes,
>
> Roger
>
>> 
>> -- 
>> Karl Ove Hufthammer
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From ferdy at cict.fr  Fri Aug 26 21:00:35 2011
From: ferdy at cict.fr (Jean-Baptiste Ferdy)
Date: Fri, 26 Aug 2011 21:00:35 +0200
Subject: [R-sig-Geo] how to initialize corStruct with a distance matrix
Message-ID: <1314385235.1782.32.camel@pascal>

Dear R-users,

I'd like to use a corStruct matrix in fitting a binomial model, but I
need to define it using a pre-calculated distance matrix (instead of
feeding it with spatial coordinates). Do you have any idea on how to do
this in a simple manner?

So far the only way I could imagine was to define my own corStruct class
that computes the correlation matrix from the distance matrix. I've ried
it and it works for a simple model. But when it comes to adding a nugget
to corStruct, I am stuck.

Any help would be greatly appreciated...
-- 
Jean-Baptiste Ferdy
?volution et Diversit? Biologique (EDB) - UMR CNRS-UPS 5174
Universit? Paul Sabatier - Toulouse III
118 Route de Narbonne. Bat IV R3, entr?e b2
31 062 Toulouse Cedex 9
FRANCE                      

Tel: (33) 05 61 55 73 44
Fax: (33) 05 61 55 73 27


From Jan.Quets at ua.ac.be  Sun Aug 28 00:32:00 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Sat, 27 Aug 2011 22:32:00 +0000
Subject: [R-sig-Geo] can a (modified) pairdist() output be used as a basis
 for calculating a pcf
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC01645@xmail32.ad.ua.ac.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110827/aaffd99c/attachment.pl>

From martin.renner at stonebow.otago.ac.nz  Sun Aug 28 07:51:22 2011
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Sat, 27 Aug 2011 21:51:22 -0800
Subject: [R-sig-Geo] spgrass6 does not load any long
Message-ID: <5DD81927-B71C-472A-BE22-81CE48889F1B@stonebow.otago.ac.nz>

Hi,

after starting R --vanilla within grass 6.4.1 on Debian amd64 squeeze, I get the following error message when calling 
> library (spgrass6)
Loading required package: spgrass6
Error : .onLoad failed in loadNamespace() for 'spgrass6', details:
  call: read.dcf(gisrc)
  error: Line starting 't ...' is malformed!

I'm running the up-to-date versions of spgrass6, sp, etc. with proj4 and gdal libraries from Debian. R version is 2.13.0. Any pointers on how to resolve this would be much appreciated. Cheers,

Martin



Martin Renner					mrenner at gmx.com
Post-doctoral Fellow				phone: 907-226 4672
University of Washington			   or: 907-235 0728
School of Aquatic and Fishery Sciences		Seattle, USA


From Roger.Bivand at nhh.no  Sun Aug 28 16:16:11 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 28 Aug 2011 16:16:11 +0200 (CEST)
Subject: [R-sig-Geo] spgrass6 does not load any long
In-Reply-To: <5DD81927-B71C-472A-BE22-81CE48889F1B@stonebow.otago.ac.nz>
References: <5DD81927-B71C-472A-BE22-81CE48889F1B@stonebow.otago.ac.nz>
Message-ID: <alpine.LRH.2.00.1108281601160.5451@reclus.nhh.no>

On Sat, 27 Aug 2011, Martin Renner wrote:

> Hi,
>
> after starting R --vanilla within grass 6.4.1 on Debian amd64 squeeze, I 
> get the following error message when calling
>> library (spgrass6)
> Loading required package: spgrass6
> Error : .onLoad failed in loadNamespace() for 'spgrass6', details:
>  call: read.dcf(gisrc)
>  error: Line starting 't ...' is malformed!

The error message is clear, your .gisrc file is malformed. I suggest 
running in R before library(spgrass6):

gisrc <- Sys.getenv("GISRC")
gisrc

to discover its name, and then examining the contents with, for example,

file.show(gisrc)

inside R. The keys and values should be arranged in the format described 
in ?read.dcf. Mine in a spearfish session is:

GISDBASE: /home/rsb/topics/grassdata
LOCATION_NAME: spearfish60
MAPSET: rsb
MONITOR: x0
GRASS_GUI: wxpython

for example. It may be that something has overwritten your gisrc file, so 
you may need to correct it. Within GRASS before starting R you can check 
it by saying:

cat $GISRC

Also look for any stale gisrc* files that may be being copied across when 
GRASS starts.

Hope this helps,

Roger

>
> I'm running the up-to-date versions of spgrass6, sp, etc. with proj4 and 
> gdal libraries from Debian. R version is 2.13.0. Any pointers on how to 
> resolve this would be much appreciated. Cheers,
>
> Martin
>
>
>
> Martin Renner					mrenner at gmx.com
> Post-doctoral Fellow				phone: 907-226 4672
> University of Washington			   or: 907-235 0728
> School of Aquatic and Fishery Sciences		Seattle, USA
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matthew at matthewvavrek.com  Mon Aug 29 04:24:43 2011
From: matthew at matthewvavrek.com (Matthew Vavrek)
Date: Sun, 28 Aug 2011 22:24:43 -0400
Subject: [R-sig-Geo] layout.north.arrow not pointing to actual north
In-Reply-To: <mailman.11.1314439205.16639.r-sig-geo@r-project.org>
References: <mailman.11.1314439205.16639.r-sig-geo@r-project.org>
Message-ID: <4E5AF86B.20303@matthewvavrek.com>

I'm not sure if I'm going about this the right way, but I've been trying 
to create some relatively basic base maps in R (I've found the export 
formats better than the GIS I use) using the plot function for a 
SpatialLines object (spplot seemed like too much for my purposes, as I 
just want a map showing my location). I'm plotting a projected map, and 
the latitudes/longitudes are not parallel with the margins of the plot, 
as it uses the same projection as a larger map and I'm trying to keep 
the same view between them. However, when I plot the north arrow using 
layout.north.arrow() it gives me a north arrow that is lined up with the 
margin of the plot, not true north. the code I'm using looks like this:

plot(projected.map)
SpatialPolygonsRescale(layout.north.arrow(1), offset = 
c(2490000,4930000), scale = 40000, plot.grid=F)

The scale bar using layout.scale.bar() looks OK though, although that 
might just be misleading and actually needs to be adjusted as well. Is 
there anywhere that layout.north.arrow is actually explained, or 
SpatialPolygonsRescale? I also have no idea if what I'm doing even makes 
much sense, as I don't know if you can mix lattice and normal plot items.

Thanks
Matthew


From Adrian.Baddeley at csiro.au  Mon Aug 29 06:01:31 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Mon, 29 Aug 2011 12:01:31 +0800
Subject: [R-sig-Geo] [R-sig-geo] can a (modified) pairdist() output be used
 as a basis for calculating a pcf
In-Reply-To: <mailman.15.1314525605.22584.r-sig-geo@r-project.org>
References: <mailman.15.1314525605.22584.r-sig-geo@r-project.org>
Message-ID: <57DC18C299094D4299F837570C5DF1C54E8A76361F@EXWA-MBX01.nexus.csiro.au>

Jan Quets <Jan.Quets at ua.ac.be> heeft geschreven:

> suppose that I want to change the pcf function in such a way that it 
> doesn't 'use' the distribution of point-to-point distances,
> but instead 'uses' the distribution of edge-to-edge distances.
>  [ ... ]
> is it possible in spatstat to [... ] calculate the (modified)-pcf 
> in an easy way by use of some specific spatstat functions?

      Yes. 
	As a temporary measure, you could use the (currently undocumented)
      function 'compilepcf'. 
	You need something like the following invocation:

           f <- compilepcf(D, r=handle.r.b.args(window=W))

      where D is the pairwise distance matrix, and W is the window containing the
      data. The result is an 'fv' class object. You may have to rescale it 
      using eval.fv. 

      Of course you'll need to think carefully about what this calculation means,
      in order to decide how to rescale it, etc. 

      For the usual pair correlation function, you would have to subsequently 
      divide f(r) by 2 * pi * r. This normalisation is not carried out by 'compilepcf'.

      This will not work in spatstat 2 where we will have a different mechanism that 
      is faster. 

> to calculate a square matrix of edge-to-edge distances (E2E):
> for (i in 1:100){
> for (j in 1:100){
>  sumradii[i,j] = vmrad$marks[i] + vmrad$marks[j]
> }
> }
> E2E = pairdist(vmrad) - sumradii

      You can do this faster using

        sumradii <- outer(marks(vmrad), marks(vmrad), "+")

      You will also need to reset the diagonal of 'E2E' to infinity so that it 
      is not used:

         diag(E2E) <- Inf

Adrian Baddeley


From mathieu.rajerison at gmail.com  Mon Aug 29 10:31:38 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 29 Aug 2011 10:31:38 +0200
Subject: [R-sig-Geo] stplot: choosing constant time interval between
	plots
In-Reply-To: <4E57DE17.1050403@uni-muenster.de>
References: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>
	<4E57DE17.1050403@uni-muenster.de>
Message-ID: <CAGfc75nHd8zMCvNQ_JzhWZabbguzqC8mtTu6BFD_fdPCAJVNFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110829/2e66e00e/attachment.pl>

From momadou at yahoo.fr  Mon Aug 29 15:43:48 2011
From: momadou at yahoo.fr (Komine)
Date: Mon, 29 Aug 2011 06:43:48 -0700 (PDT)
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
Message-ID: <1314625427986-6737676.post@n2.nabble.com>

Hi, 
I want to do  maps of changes for NDVI for several days. When I use a map 1
for day 1, map 2 for day 2, map 3 for day 3 etc? in a same page, differences
between maps were not visible.  For this reason, I want to do  maps of
changes using differences between pixels value (or NDVI value) . Thus I want
to extract coordinates and NDVI value for each pixel of my image (the image
covers all a country). However, I have not all the pixel coordinates, but I
have the coordinates of the image.  
Please how to extract coordinates and NDVI value for each pixel of my image
when I don?t know the coordinates of all pixels. I use R. 
Sorry for my bad English.
Thank you in advance
 
Komine 


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/To-extract-coordinates-and-NDVI-value-for-each-pixel-tp6737676p6737676.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mathieu.rajerison at gmail.com  Mon Aug 29 17:21:13 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 29 Aug 2011 17:21:13 +0200
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
In-Reply-To: <1314625427986-6737676.post@n2.nabble.com>
References: <1314625427986-6737676.post@n2.nabble.com>
Message-ID: <CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110829/3c1b26dc/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Aug 29 17:51:54 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 29 Aug 2011 17:51:54 +0200
Subject: [R-sig-Geo] stplot: choosing constant time interval
	between	plots
In-Reply-To: <CAGfc75nHd8zMCvNQ_JzhWZabbguzqC8mtTu6BFD_fdPCAJVNFQ@mail.gmail.com>
References: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>	<4E57DE17.1050403@uni-muenster.de>
	<CAGfc75nHd8zMCvNQ_JzhWZabbguzqC8mtTu6BFD_fdPCAJVNFQ@mail.gmail.com>
Message-ID: <4E5BB59A.1060900@uni-muenster.de>

Mathieu,

you may want to look into cut methods for Date, e.g. in your example:

xyplot(y_sref~x_sref|cut(time,4), as.data.frame(ciotat.t))



On 08/29/2011 10:31 AM, Mathieu Rajerison wrote:
> Ok,
> 
> May I ask you another question?
> 
> When I use parameter number for stplot, how does it decide to split plots by
> number?
> 
> The orange mark on the top of each plot shows me that it isn't by equal time
> intervals. I guess it is by equal object count?
> 
> Is there a way to indicate time periods on top of each plot?
> 
> Thanks
> 
> 
> 2011/8/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> 
>> Mathieu,
>>
>> as stplot for STIDF's is still pretty "bare", or simple, you might as
>> well work directly with xyplot from lattice. Having your data, it turns
>> out you only have a limited number of dates, the following seems to work:
>>
>> library(lattice)
>> xyplot(y_sref~x_sref|time,  as.data.frame(ciotat.t),
>>   scales=list(draw=F), asp="iso", xlab=NULL, ylab=NULL,
>>   panel = function(x,y,...) {
>>      sp.lines(contour);
>>      panel.xyplot(x,y,...)
>>   }
>> )
>>
>> as stplot assumes time is irregular, it uses
>>
>> xyplot(y_sref~x_sref | equal.count(time), ...
>>
>> which bins time into a small number of classes.
>>
>> Hth,
>>
>> On 08/26/2011 02:16 PM, Mathieu Rajerison wrote:
>>> Hi,
>>>
>>>
>>> I have a question about stplot.
>>>
>>> Let's say I'd like to plot via multi-panel a series of plots separated by
>> a
>>> given time interval. How can I accomplish that?
>>>
>>> Also, let's say this time interval is specified between thow given time
>>> instances, for example: every week between 14/07/11 and 28/08/11.
>>>
>>> Is there a way in stplot to perform these operations?
>>>
>>>
>>> Any help would be greatly appreciated
>>>
>>> *Again congrats for the powerful and easy-to-use spacetime package with
>>> strong documentation!*
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From martin.renner at stonebow.otago.ac.nz  Mon Aug 29 18:31:29 2011
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Mon, 29 Aug 2011 08:31:29 -0800
Subject: [R-sig-Geo] spgrass6 does not load any long
In-Reply-To: <alpine.LRH.2.00.1108281601160.5451@reclus.nhh.no>
References: <5DD81927-B71C-472A-BE22-81CE48889F1B@stonebow.otago.ac.nz>
	<alpine.LRH.2.00.1108281601160.5451@reclus.nhh.no>
Message-ID: <7A99C0A4-CBDC-41F6-ABFA-25E7FB1C8437@stonebow.otago.ac.nz>

Thank you for the answer, Roger! Sys.getenv("GISRC") let to a tmp file, but that was a copy of the .grassrc6 in my home directory. Editing .grassrc6 fixed it and now GRASS and R can talk to each other again. 

Again, thank you for the help! 

Martin



On 28 Aug 2011, at 6:16 , Roger Bivand wrote:

> On Sat, 27 Aug 2011, Martin Renner wrote:
> 
>> Hi,
>> 
>> after starting R --vanilla within grass 6.4.1 on Debian amd64 squeeze, I get the following error message when calling
>>> library (spgrass6)
>> Loading required package: spgrass6
>> Error : .onLoad failed in loadNamespace() for 'spgrass6', details:
>> call: read.dcf(gisrc)
>> error: Line starting 't ...' is malformed!
> 
> The error message is clear, your .gisrc file is malformed. I suggest running in R before library(spgrass6):
> 
> gisrc <- Sys.getenv("GISRC")
> gisrc
> 
> to discover its name, and then examining the contents with, for example,
> 
> file.show(gisrc)
> 
> inside R. The keys and values should be arranged in the format described in ?read.dcf. Mine in a spearfish session is:
> 
> GISDBASE: /home/rsb/topics/grassdata
> LOCATION_NAME: spearfish60
> MAPSET: rsb
> MONITOR: x0
> GRASS_GUI: wxpython
> 
> for example. It may be that something has overwritten your gisrc file, so you may need to correct it. Within GRASS before starting R you can check it by saying:
> 
> cat $GISRC
> 
> Also look for any stale gisrc* files that may be being copied across when GRASS starts.
> 
> Hope this helps,
> 
> Roger
> 
>> 
>> I'm running the up-to-date versions of spgrass6, sp, etc. with proj4 and gdal libraries from Debian. R version is 2.13.0. Any pointers on how to resolve this would be much appreciated. Cheers,
>> 
>> Martin
>> 
>> 
>> 
>> Martin Renner					mrenner at gmx.com
>> Post-doctoral Fellow				phone: 907-226 4672
>> University of Washington			   or: 907-235 0728
>> School of Aquatic and Fishery Sciences		Seattle, USA
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 


From Jan.Quets at ua.ac.be  Mon Aug 29 21:47:33 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Mon, 29 Aug 2011 19:47:33 +0000
Subject: [R-sig-Geo] [R-sig-geo] can a (modified) pairdist() output be
 used as a basis for calculating a pcf
In-Reply-To: <57DC18C299094D4299F837570C5DF1C54E8A76361F@EXWA-MBX01.nexus.csiro.au>
References: <mailman.15.1314525605.22584.r-sig-geo@r-project.org>,
	<57DC18C299094D4299F837570C5DF1C54E8A76361F@EXWA-MBX01.nexus.csiro.au>
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE1DC01729@xmail32.ad.ua.ac.be>

great!

could you in short describe what you mean by rescaling?

is this rescaling also needed when comparing this 'modified-pcf' relative to an envelope of 'modified-pcfs' which resulted from simulations of an appropriate nullmodel (i.e. random non-overlapping circles)?

I have indeed to be cautious what the implications are of these modifications...,  

best,
Jan
________________________________________
Van: Adrian.Baddeley at csiro.au [Adrian.Baddeley at csiro.au]
Verzonden: maandag 29 augustus 2011 6:01
Aan: r-sig-geo at r-project.org
CC: Quets Jan; Adrian.Baddeley at csiro.au; r.turner at auckland.ac.nz
Onderwerp: [R-sig-geo] can a (modified) pairdist() output be used as a basis for calculating a pcf

Jan Quets <Jan.Quets at ua.ac.be> heeft geschreven:

> suppose that I want to change the pcf function in such a way that it
> doesn't 'use' the distribution of point-to-point distances,
> but instead 'uses' the distribution of edge-to-edge distances.
>  [ ... ]
> is it possible in spatstat to [... ] calculate the (modified)-pcf
> in an easy way by use of some specific spatstat functions?

      Yes.
        As a temporary measure, you could use the (currently undocumented)
      function 'compilepcf'.
        You need something like the following invocation:

           f <- compilepcf(D, r=handle.r.b.args(window=W))

      where D is the pairwise distance matrix, and W is the window containing the
      data. The result is an 'fv' class object. You may have to rescale it
      using eval.fv.

      Of course you'll need to think carefully about what this calculation means,
      in order to decide how to rescale it, etc.

      For the usual pair correlation function, you would have to subsequently
      divide f(r) by 2 * pi * r. This normalisation is not carried out by 'compilepcf'.

      This will not work in spatstat 2 where we will have a different mechanism that
      is faster.

> to calculate a square matrix of edge-to-edge distances (E2E):
> for (i in 1:100){
> for (j in 1:100){
>  sumradii[i,j] = vmrad$marks[i] + vmrad$marks[j]
> }
> }
> E2E = pairdist(vmrad) - sumradii

      You can do this faster using

        sumradii <- outer(marks(vmrad), marks(vmrad), "+")

      You will also need to reset the diagonal of 'E2E' to infinity so that it
      is not used:

         diag(E2E) <- Inf

Adrian Baddeley


From momadou at yahoo.fr  Mon Aug 29 23:30:43 2011
From: momadou at yahoo.fr (Komine)
Date: Mon, 29 Aug 2011 14:30:43 -0700 (PDT)
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
In-Reply-To: <CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
References: <1314625427986-6737676.post@n2.nabble.com>
	<CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
Message-ID: <1314653443152-6739772.post@n2.nabble.com>

Thank you Mathieu,
 I'm sorry to respond late to your feedback. I take into account your
suggestions and links provided to answer you again this weekend because I am
a long journey and I will not have internet.

Komine 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/To-extract-coordinates-and-NDVI-value-for-each-pixel-tp6737676p6739772.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jpark at stat.tamu.edu  Tue Aug 30 03:38:55 2011
From: jpark at stat.tamu.edu (jpark at stat.tamu.edu)
Date: Mon, 29 Aug 2011 20:38:55 -0500 (CDT)
Subject: [R-sig-Geo] [Fwd: Re: estimation in gstat]
Message-ID: <49844.71.113.240.209.1314668335.squirrel@m1.stat.tamu.edu>


How are you?

I am working on research using gstat package fitting universal kriging
models using fit.variogram() with one covariate.

I have been looking for features in gstat to get estimates of beta,
coefficients of covariate (intercept and a coefficient of covariate).


Since I could not find the way to get them, I am emailing you to ask how I
can get the estimates of beta. It would be of great help if you let me
know it.

Thank you !


Best,
Jincheol Park


From Changying.Shao at fish.wa.gov.au  Tue Aug 30 11:18:46 2011
From: Changying.Shao at fish.wa.gov.au (Changying Shao)
Date: Tue, 30 Aug 2011 09:18:46 +0000
Subject: [R-sig-Geo] Crabs data analysis help
Message-ID: <E5900715EAC7D841898ADFD712708DFA131A71@parrotfish12.fish.wa.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110830/35f620a2/attachment.pl>

From oscar.perpinan at upm.es  Tue Aug 30 13:04:36 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Tue, 30 Aug 2011 13:04:36 +0200
Subject: [R-sig-Geo] Choropleth in R
In-Reply-To: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>
References: <CADniDBCduCj_8sJ1fwmM-wAeC_bk03KBiPpgdLtt5EnhwkG=VA@mail.gmail.com>
Message-ID: <20110830130436.77e16383@OPL-EUITI>

You can use spplot from sp. Some examples:

http://blog.revolutionanalytics.com/2009/10/geographic-maps-in-r.html
http://ryouready.wordpress.com/2009/11/16/infomaps-using-r-visualizing-german-unemployment-rates-by-color-on-a-map/
http://news.mrdwab.com/2010/05/16/choropleth-party-with-r/

Best,

Oscar.


-------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com

-----------------------------------------
>Hi all,
>I would like to use R in order to generate a Heatmap/Choropleth
>overlaid on the UK map. Can someone please help with finding the right
>package/code? Any help is much appreciated.
>Best, Reza
>
>	[[alternative HTML version deleted]]


From Changying.Shao at fish.wa.gov.au  Wed Aug 31 03:49:21 2011
From: Changying.Shao at fish.wa.gov.au (Changying Shao)
Date: Wed, 31 Aug 2011 01:49:21 +0000
Subject: [R-sig-Geo] Crabs data analysis help
In-Reply-To: <E5900715EAC7D841898ADFD712708DFA131A71@parrotfish12.fish.wa.gov.au>
Message-ID: <E5900715EAC7D841898ADFD712708DFA131B00@parrotfish12.fish.wa.gov.au>

Hi, all

I'm currently working on the crabs catch rates by Latitude/Longitude for females and
males for the period 1993-2010. I can't use point process methods for such data because there is a catch rate attached to each point location given by LL.

Does anyone know the natural model for such data? like a Poisson random variable with mean that may depend on sex, spatial location, and time. Really appreciate your help. Thanks in advance.

Cheers
Changying

Changying Shao|  Stock Assessment and Data Analysis
WA Fisheries and Marine Research Laboratories


From mathieu.rajerison at gmail.com  Wed Aug 31 15:05:14 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 31 Aug 2011 15:05:14 +0200
Subject: [R-sig-Geo] stplot: choosing constant time interval between
	plots
In-Reply-To: <4E5BB59A.1060900@uni-muenster.de>
References: <CAGfc75nMEvfyhVzETA4Badt4npmw417A39KA2LuLXuhO8tzs=Q@mail.gmail.com>
	<4E57DE17.1050403@uni-muenster.de>
	<CAGfc75nHd8zMCvNQ_JzhWZabbguzqC8mtTu6BFD_fdPCAJVNFQ@mail.gmail.com>
	<4E5BB59A.1060900@uni-muenster.de>
Message-ID: <CAGfc75mnnR5hQGJUd8jOc0nqavQZ9HoeiALSxakf0ixPRRswQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110831/621a434d/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Aug 31 15:12:18 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 31 Aug 2011 15:12:18 +0200
Subject: [R-sig-Geo] spatstat - how to choose an optimal bandwidth for
	smooth.ppp?
Message-ID: <CAGfc75mUG6vHsng_XD1O36EkJkm5n8mS6gAsZAALdfCR72_PyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110831/f0623554/attachment.pl>

From sara.kleyer at uni-bamberg.de  Wed Aug 31 16:54:15 2011
From: sara.kleyer at uni-bamberg.de (Sara Kleyer)
Date: Wed, 31 Aug 2011 16:54:15 +0200
Subject: [R-sig-Geo] problem with likfit and na.action
Message-ID: <4E5E4B17.9080600@uni-bamberg.de>

Hi:

when running the following command, the prediction works fine, but 
missing values are deleted in the dataset:

geo <- as.geodata(fakeland, coords.col=2:3, data.col=9, covar.col=4:8)
cov.est<-likfit(geo, cov.model="powered.exponential", 
ini.cov.pars=c(1,1), kappa=1, trend="1st")
kri.set<-krige.control(type.krige="ok", trend.d="1st", trend.l="1st", 
obj.model=cov.est)
schatz<-krige.conv(geo, locations=cord, krige=kri.set)

However, if I modify the na.action in geo to na.action="ifcovar",  the 
same likfit-command returns
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
          arguments for the maximisation function.
         For further details see documentation for optim.
likfit: It is highly advisable to run this function several
         times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
Fehler in if (sumnegloglik > (.Machine$double.xmax^0.5) | sumnegloglik 
==  :
   Fehlender Wert, wo TRUE/FALSE n?tig ist

And the prediction doesn't work any more.

What ist the problem about that?

Thanks a lot for your help!

Sara


From pierluigi.derosa at gmail.com  Wed Aug 31 18:27:53 2011
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Wed, 31 Aug 2011 18:27:53 +0200
Subject: [R-sig-Geo] spdep installing failure
Message-ID: <CAAgsrZgp_UaWKrG56tSnKNE0vHbM8QEFM-f-Q_5WZU_p3Co7Xg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110831/93f93fd8/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Aug 31 19:18:36 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 31 Aug 2011 19:18:36 +0200
Subject: [R-sig-Geo] spdep installing failure
In-Reply-To: <CAAgsrZgp_UaWKrG56tSnKNE0vHbM8QEFM-f-Q_5WZU_p3Co7Xg@mail.gmail.com>
References: <CAAgsrZgp_UaWKrG56tSnKNE0vHbM8QEFM-f-Q_5WZU_p3Co7Xg@mail.gmail.com>
Message-ID: <4E5E6CEC.2030907@uni-muenster.de>

We need to have the full output of the install.packages() command to
find out where things go wrong.

In any case, the blas-dev and/or some atlas-dev libraries need to be
installed on your system before you can install spdep.

On 08/31/2011 06:27 PM, pierluigi de rosa wrote:
> Dear list
> I have some problem installing spdep package on ubuntu 10.10 linux.
> I have installed the packages liblapack-dev and r-base-dev but if i run:
> install.packages("spdep",dep=T)
> i have this error:
> /usr/bin/ld: cannot find -lf77blas
> /usr/bin/ld: cannot find -latlas
> collect2: ld returned 1 exit status
> make: *** [spdep.so] Errore 1
> ERROR: compilation failed for package ?spdep?
> 
> does any one can help me?
> thanks
> Pierluigi
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Wed Aug 31 19:20:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 31 Aug 2011 19:20:47 +0200 (CEST)
Subject: [R-sig-Geo] spdep installing failure
In-Reply-To: <CAAgsrZgp_UaWKrG56tSnKNE0vHbM8QEFM-f-Q_5WZU_p3Co7Xg@mail.gmail.com>
References: <CAAgsrZgp_UaWKrG56tSnKNE0vHbM8QEFM-f-Q_5WZU_p3Co7Xg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1108311910550.16515@reclus.nhh.no>

On Wed, 31 Aug 2011, pierluigi de rosa wrote:

> Dear list
> I have some problem installing spdep package on ubuntu 10.10 linux.
> I have installed the packages liblapack-dev and r-base-dev but if i run:
> install.packages("spdep",dep=T)
> i have this error:
> /usr/bin/ld: cannot find -lf77blas
> /usr/bin/ld: cannot find -latlas
> collect2: ld returned 1 exit status
> make: *** [spdep.so] Errore 1
> ERROR: compilation failed for package ?spdep?

I would advise against binary installs of R on Debian/Ubuntu if you need 
contributed packages (like gstat, spatstat, splancs, sp, or in fact most 
R-spatial packages with compiled code) unless you are prepared to work 
hard at fulfilling dependencies. Did you install R-base as decribed on 
http://cran.r-project.org/bin/linux/ubuntu/ ?

My assumption is that you lack most of the dependencies needed to install 
source packages with compiled code. Consider asking on R-sig-debian to 
determine which, or search their archives to see if this is a FAQ:

https://stat.ethz.ch/mailman/listinfo/r-sig-debian

Hope this helps,

Roger

>
> does any one can help me?
> thanks
> Pierluigi
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


