From @|||ch @end|ng |rom u@|@edu  Fri Jan  6 18:02:48 2023
From: @|||ch @end|ng |rom u@|@edu (Alexander Ilich)
Date: Fri, 6 Jan 2023 17:02:48 +0000
Subject: [R-sig-Geo] getting data from an nc file
In-Reply-To: <CABxY9BNs6Fz6M_0wHy37BRR420jWOhqqg6vEevsLdreQxrvBfQ@mail.gmail.com>
References: <CABxY9BNs6Fz6M_0wHy37BRR420jWOhqqg6vEevsLdreQxrvBfQ@mail.gmail.com>
Message-ID: <BN0PR08MB7341C5C599CE44BA6A077CD7C6FB9@BN0PR08MB7341.namprd08.prod.outlook.com>

HDF Viewer<https://www.hdfgroup.org/downloads/hdfview/> can be a good way to look at the structure of nc files to see where different information is stored in the file.
________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Nick Wray <nickmwray at gmail.com>
Sent: Wednesday, November 9, 2022 5:53 AM
To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] getting data from an nc file

Hello

I am trying to get rainfall data from the UK chess-met site

https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcatalogue.ceh.ac.uk%2Fdatastore%2Feidchub%2F2ab15bf0-ad08-415c-ba64-831168be7293%2Fprecip%2F&amp;data=05%7C01%7Cailich%40usf.edu%7C39cfc2a140934dc323d408dac240b9c0%7C741bf7dee2e546df8d6782607df9deaa%7C0%7C0%7C638060296454914830%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=AJ5Q%2BWYYGxbXJZjHxisFdGAAomjtIWn95k5r9vtXniw%3D&amp;reserved=0

and here there are a large number of nc files eg

"chess-met_precip_gb_1km_daily_20150101-20150131.nc"

I?ve found various sources on the net for opening nc files, and getting the
data but when I try instructions like

nc_data<-nc_open("chess-met_precip_gb_1km_daily_20150101-20150131.nc")

lon <- ncvar_get(nc_data, "lon")

lon



the code works but all I get is a series of element numbers and no data:

[,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]
[,10]    [,11]    [,12]

          [,13]    [,14]    [,15]    [,16]    [,17]    [,18]    [,19]
[,20]    [,21]    [,22]    [,23]    [,24]



And similarly for latitude

But if I open the nc file as a raster I get a raster precipitation plot of
Great Britain, which rather suggests that the lat and long values are in
there somewhere

Can anyone help with getting the actual data sets out of an nc file?

Thanks Nick Wray

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=05%7C01%7Cailich%40usf.edu%7C39cfc2a140934dc323d408dac240b9c0%7C741bf7dee2e546df8d6782607df9deaa%7C0%7C0%7C638060296454914830%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=dOzJYz06Zy8XUTh05KFvBI%2BMF3n0clxcgCsILupkkps%3D&amp;reserved=0
[EXTERNAL EMAIL] DO NOT CLICK links or attachments unless you recognize the sender and know the content is safe.

	[[alternative HTML version deleted]]


From kmcou||b @end|ng |rom gm@||@com  Fri Jan 13 16:36:19 2023
From: kmcou||b @end|ng |rom gm@||@com (Kapo Coulibaly)
Date: Fri, 13 Jan 2023 07:36:19 -0800
Subject: [R-sig-Geo] getting data from an nc file
In-Reply-To: <BN0PR08MB7341C5C599CE44BA6A077CD7C6FB9@BN0PR08MB7341.namprd08.prod.outlook.com>
References: <CABxY9BNs6Fz6M_0wHy37BRR420jWOhqqg6vEevsLdreQxrvBfQ@mail.gmail.com>
 <BN0PR08MB7341C5C599CE44BA6A077CD7C6FB9@BN0PR08MB7341.namprd08.prod.outlook.com>
Message-ID: <CANcefXZog5pPZBdS-SAahrK8nY++vkZrLkvUoMdVQzuaovZyiQ@mail.gmail.com>

Hey Alexander,

I can look into it for you but your links didn't work for me. One is broken
and the other leads to a page where logging is required. If you can share
an example file I would see if I can help.

On Fri, Jan 6, 2023 at 9:03 AM Alexander Ilich <ailich at usf.edu> wrote:

> HDF Viewer<https://www.hdfgroup.org/downloads/hdfview/> can be a good way
> to look at the structure of nc files to see where different information is
> stored in the file.
> ________________________________
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Nick Wray <
> nickmwray at gmail.com>
> Sent: Wednesday, November 9, 2022 5:53 AM
> To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] getting data from an nc file
>
> Hello
>
> I am trying to get rainfall data from the UK chess-met site
>
>
> https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcatalogue.ceh.ac.uk%2Fdatastore%2Feidchub%2F2ab15bf0-ad08-415c-ba64-831168be7293%2Fprecip%2F&amp;data=05%7C01%7Cailich%40usf.edu%7C39cfc2a140934dc323d408dac240b9c0%7C741bf7dee2e546df8d6782607df9deaa%7C0%7C0%7C638060296454914830%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=AJ5Q%2BWYYGxbXJZjHxisFdGAAomjtIWn95k5r9vtXniw%3D&amp;reserved=0
>
> and here there are a large number of nc files eg
>
> "chess-met_precip_gb_1km_daily_20150101-20150131.nc"
>
> I?ve found various sources on the net for opening nc files, and getting the
> data but when I try instructions like
>
> nc_data<-nc_open("chess-met_precip_gb_1km_daily_20150101-20150131.nc")
>
> lon <- ncvar_get(nc_data, "lon")
>
> lon
>
>
>
> the code works but all I get is a series of element numbers and no data:
>
> [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
>  [,9]
> [,10]    [,11]    [,12]
>
>           [,13]    [,14]    [,15]    [,16]    [,17]    [,18]    [,19]
> [,20]    [,21]    [,22]    [,23]    [,24]
>
>
>
> And similarly for latitude
>
> But if I open the nc file as a raster I get a raster precipitation plot of
> Great Britain, which rather suggests that the lat and long values are in
> there somewhere
>
> Can anyone help with getting the actual data sets out of an nc file?
>
> Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
>
> https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=05%7C01%7Cailich%40usf.edu%7C39cfc2a140934dc323d408dac240b9c0%7C741bf7dee2e546df8d6782607df9deaa%7C0%7C0%7C638060296454914830%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=dOzJYz06Zy8XUTh05KFvBI%2BMF3n0clxcgCsILupkkps%3D&amp;reserved=0
> [EXTERNAL EMAIL] DO NOT CLICK links or attachments unless you recognize
> the sender and know the content is safe.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From g|u@eppe@@m@tu||| @end|ng |rom gm@||@com  Thu Jan 19 20:20:35 2023
From: g|u@eppe@@m@tu||| @end|ng |rom gm@||@com (Giuseppe Amatulli)
Date: Thu, 19 Jan 2023 20:20:35 +0100
Subject: [R-sig-Geo] Course: Geocomputation and Machine Learning for
 Environmental Applications -2023
Message-ID: <CAKoiDHK4FM-SDFamb8HFm68WiuC6O8Mh4tmAq1mGMTFPcmB5Fw@mail.gmail.com>

Dear Colleagues,

In view of enhancing computation skills in the geographic domain, Spatial
 Ecology <http://spatial-ecology.net/>  is organising a two-month training
course: Geocomputation and Machine Learning for Environmental Applications
<http://spatial-ecology.net/course-geocomputation-machine-learning-for-environmental-applications-intermediate-level-2023/>
.

The course will be offered on-line with a supplementary 5-day (or 10-day)
in-person segment at the University of Basilicata, in the magnificent town
of Matera
<https://www.google.com/maps/place/75100+Matera,+Province+of+Matera,+Italy/@40.6646012,16.5651092,13z/data=!3m1!4b1!4m5!3m4!1s0x13477ee2482b152b:0x8f6a4ae10da9360!8m2!3d40.666379!4d16.6043199>,
Italy. This is a wonderful opportunity for PhD students, Post-Docs and
professionals to acquire advanced computational skills with a Linux
computer.

Please forward to announce this opportunity within your network.

Sincerely, Giuseppe Amatulli  & Spatial Ecology ? Team

*Geocomputation and Machine Learning for Environmental Applications
<http://spatial-ecology.net/course-geocomputation-machine-learning-for-environmental-applications-intermediate-level-2023/>.**
(April,
May, June, 2023)*

In this course, students will be introduced to an array of powerful
open-source geocomputation tools and machine learning methodologies under
Linux environment. Students who have never been exposed to programming
under Linux are expected to reach the stage where they feel confident in
using very advanced open source data processing routines. Students with a
precedent programming background will find the course beneficial in
enhancing their programming skills for better modelling and coding
proficiency. Our dual teaching aim is to equip attendees with powerful
tools as well as rendering their abilities of continuing independent
development afterwards. The acquired skills will be beneficial, not only
for GIS related applications, but also for general data processing and
applied statistical computing in a number of fields. These essentially lay
the foundation for career development as a data scientist in the geographic
domain.

More information and registration:

www.spatial-ecology.net
twitter: @BigDataEcology

-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
School of the Environment
Yale University
New Haven, CT, USA
06511
Twitter: @BigDataEcology
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/

	[[alternative HTML version deleted]]


From @trev|@@n| @end|ng |rom |u@v@|t  Mon Jan 23 12:30:14 2023
From: @trev|@@n| @end|ng |rom |u@v@|t (Sebastiano Trevisani)
Date: Mon, 23 Jan 2023 12:30:14 +0100
Subject: [R-sig-Geo] strange issue of memory converting a raster to a data
 frame
Message-ID: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>

Dear list members,

In converting a raster as the one below to a data frame, I have an issue of
memory allocation only when I use a specific pc, and in particular the one
with more memory. To be more precise (using same version of R 4.2.2 and
Terra terra 1.6.47, by means of as.data.frame() function):

with a I5 processor with 8Gb of memory, windows 10 it works

with a I7 processor with 16gb of memory, windows 11 it doesn't

I'm not able to figure out a possible explanation!
Any suggestions on what to check?


SpatRaster
dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
resolution  : 30, 30  (x, y)
extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
ymax)
coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
source      : multyMadRes2c.tif



Sebastiano

*      Sebastiano Trevisani, Ph.D.*
*            Associate Professor*
*Applied and Environmental Geology*


*  https://orcid.org/0000-0001-8436-7798
<https://orcid.org/0000-0001-8436-7798>*
*IUAV University of Venice: www.iuav.it <http://www.iuav.it/>*

*Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
*"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
* riflettono in alcun modo una posizione ufficiale dello IUAV "*
*"The views expressed are purely those of the writer and may not in
any circumstances be regarded as stating an official position of the IUAV."*

	[[alternative HTML version deleted]]


From Lo|c@DUTRIEUX @end|ng |rom ec@europ@@eu  Mon Jan 23 17:35:55 2023
From: Lo|c@DUTRIEUX @end|ng |rom ec@europ@@eu (DUTRIEUX Loic)
Date: Mon, 23 Jan 2023 16:35:55 +0000
Subject: [R-sig-Geo] 
 strange issue of memory converting a raster to a data frame
In-Reply-To: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
References: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
Message-ID: <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>

Hi Sebastiano,

Try comparing terra::terraOptions() and terra::mem_info(r) on both systems. Just guessing there but it could be that terra is trying to do everything in memory and failing on your 16GB system, while taking a memory friendly route on your 8GB system.

Cheers,
Lo?c
________________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Sebastiano Trevisani <strevisani at iuav.it>
Sent: 23 January 2023 12:30:14
To: r-sig-geo
Subject: [R-sig-Geo] strange issue of memory converting a raster to a data frame

Dear list members,

In converting a raster as the one below to a data frame, I have an issue of
memory allocation only when I use a specific pc, and in particular the one
with more memory. To be more precise (using same version of R 4.2.2 and
Terra terra 1.6.47, by means of as.data.frame() function):

with a I5 processor with 8Gb of memory, windows 10 it works

with a I7 processor with 16gb of memory, windows 11 it doesn't

I'm not able to figure out a possible explanation!
Any suggestions on what to check?


SpatRaster
dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
resolution  : 30, 30  (x, y)
extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
ymax)
coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
source      : multyMadRes2c.tif



Sebastiano

*      Sebastiano Trevisani, Ph.D.*
*            Associate Professor*
*Applied and Environmental Geology*


*  https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
<https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$ >*
*IUAV University of Venice: https://urldefense.com/v3/__http://www.iuav.it__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ag_1m0F$  <https://urldefense.com/v3/__http://www.iuav.it/__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9cV-rY9s$ >*

*Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
*"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
* riflettono in alcun modo una posizione ufficiale dello IUAV "*
*"The views expressed are purely those of the writer and may not in
any circumstances be regarded as stating an official position of the IUAV."*

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-geo__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ScsuXEI$


From @trev|@@n| @end|ng |rom |u@v@|t  Mon Jan 23 18:32:53 2023
From: @trev|@@n| @end|ng |rom |u@v@|t (Sebastiano Trevisani)
Date: Mon, 23 Jan 2023 18:32:53 +0100
Subject: [R-sig-Geo] 
 strange issue of memory converting a raster to a data frame
In-Reply-To: <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>
References: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
 <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>
Message-ID: <CAC8_bdGz=DxHvVDCSNS3WiYrT=+EFFNOd9SeShEn61G2vtakHQ@mail.gmail.com>

Hi  Lo?c,

thank you for your suggestion! this was one of the possibilities I checked.
However, I tried with terra.options() to change the memfrac parameter from
0.6 to 0.1, so as to force the writing on disc, but things didn't work.
It seems like it is working as 32 bit system, but the R the installation
seems right to 64. Probably I'm missing something very obvious.
I will try to build a reproducible example without the need to upload all
the file.

Thanks again,

Sebastiano

*      Sebastiano Trevisani, Ph.D.*
*            Associate Professor*
*Applied and Environmental Geology*


*  https://orcid.org/0000-0001-8436-7798
<https://orcid.org/0000-0001-8436-7798>*
*IUAV University of Venice: www.iuav.it <http://www.iuav.it/>*

*Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
*"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
* riflettono in alcun modo una posizione ufficiale dello IUAV "*
*"The views expressed are purely those of the writer and may not in
any circumstances be regarded as stating an official position of the IUAV."*


On Mon, Jan 23, 2023 at 5:36 PM DUTRIEUX Loic <Loic.DUTRIEUX at ec.europa.eu>
wrote:

> Hi Sebastiano,
>
> Try comparing terra::terraOptions() and terra::mem_info(r) on both
> systems. Just guessing there but it could be that terra is trying to do
> everything in memory and failing on your 16GB system, while taking a memory
> friendly route on your 8GB system.
>
> Cheers,
> Lo?c
> ________________________________________
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Sebastiano
> Trevisani <strevisani at iuav.it>
> Sent: 23 January 2023 12:30:14
> To: r-sig-geo
> Subject: [R-sig-Geo] strange issue of memory converting a raster to a data
> frame
>
> Dear list members,
>
> In converting a raster as the one below to a data frame, I have an issue of
> memory allocation only when I use a specific pc, and in particular the one
> with more memory. To be more precise (using same version of R 4.2.2 and
> Terra terra 1.6.47, by means of as.data.frame() function):
>
> with a I5 processor with 8Gb of memory, windows 10 it works
>
> with a I7 processor with 16gb of memory, windows 11 it doesn't
>
> I'm not able to figure out a possible explanation!
> Any suggestions on what to check?
>
>
> SpatRaster
> dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
> resolution  : 30, 30  (x, y)
> extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
> ymax)
> coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
> source      : multyMadRes2c.tif
>
>
>
> Sebastiano
>
> *      Sebastiano Trevisani, Ph.D.*
> *            Associate Professor*
> *Applied and Environmental Geology*
>
>
> *
> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
> <
> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
> >*
> *IUAV University of Venice:
> https://urldefense.com/v3/__http://www.iuav.it__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ag_1m0F$
> <
> https://urldefense.com/v3/__http://www.iuav.it/__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9cV-rY9s$
> >*
>
> *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
> 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
> *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
> * riflettono in alcun modo una posizione ufficiale dello IUAV "*
> *"The views expressed are purely those of the writer and may not in
> any circumstances be regarded as stating an official position of the
> IUAV."*
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
>
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-geo__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ScsuXEI$
>

	[[alternative HTML version deleted]]


From v|@d@@m|h@e@e|95 @end|ng |rom gm@||@com  Mon Jan 23 18:48:08 2023
From: v|@d@@m|h@e@e|95 @end|ng |rom gm@||@com (Vlad Amihaesei)
Date: Mon, 23 Jan 2023 10:48:08 -0700
Subject: [R-sig-Geo] 
 strange issue of memory converting a raster to a data frame
In-Reply-To: <CAC8_bdGz=DxHvVDCSNS3WiYrT=+EFFNOd9SeShEn61G2vtakHQ@mail.gmail.com>
References: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
 <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>
 <CAC8_bdGz=DxHvVDCSNS3WiYrT=+EFFNOd9SeShEn61G2vtakHQ@mail.gmail.com>
Message-ID: <CAAQaj81UtqsGOQ65NWvj+j-XYVKryBF6+Hkr=H3ZUdof8rAXJQ@mail.gmail.com>

You can try converting each layer to data frame instead of all the layers
at once time. You can do this using a loop.

r <- terra::rast(file.nc)

df<- NULL

for( i in 1:nlyr(r)){
r1 <-  r[[i]]
r1.df <- as.data.frame(r1,xy =T)
df <- rbind(df, r1.df)
}

Best  regards

Vlad Alexandru AMIHAESEI


On Mon, Jan 23, 2023 at 10:33 AM Sebastiano Trevisani <strevisani at iuav.it>
wrote:

> Hi  Lo?c,
>
> thank you for your suggestion! this was one of the possibilities I checked.
> However, I tried with terra.options() to change the memfrac parameter from
> 0.6 to 0.1, so as to force the writing on disc, but things didn't work.
> It seems like it is working as 32 bit system, but the R the installation
> seems right to 64. Probably I'm missing something very obvious.
> I will try to build a reproducible example without the need to upload all
> the file.
>
> Thanks again,
>
> Sebastiano
>
> *      Sebastiano Trevisani, Ph.D.*
> *            Associate Professor*
> *Applied and Environmental Geology*
>
>
> *  https://orcid.org/0000-0001-8436-7798
> <https://orcid.org/0000-0001-8436-7798>*
> *IUAV University of Venice: www.iuav.it <http://www.iuav.it/>*
>
> *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
> 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
> *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
> * riflettono in alcun modo una posizione ufficiale dello IUAV "*
> *"The views expressed are purely those of the writer and may not in
> any circumstances be regarded as stating an official position of the
> IUAV."*
>
>
> On Mon, Jan 23, 2023 at 5:36 PM DUTRIEUX Loic <Loic.DUTRIEUX at ec.europa.eu>
> wrote:
>
> > Hi Sebastiano,
> >
> > Try comparing terra::terraOptions() and terra::mem_info(r) on both
> > systems. Just guessing there but it could be that terra is trying to do
> > everything in memory and failing on your 16GB system, while taking a
> memory
> > friendly route on your 8GB system.
> >
> > Cheers,
> > Lo?c
> > ________________________________________
> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
> Sebastiano
> > Trevisani <strevisani at iuav.it>
> > Sent: 23 January 2023 12:30:14
> > To: r-sig-geo
> > Subject: [R-sig-Geo] strange issue of memory converting a raster to a
> data
> > frame
> >
> > Dear list members,
> >
> > In converting a raster as the one below to a data frame, I have an issue
> of
> > memory allocation only when I use a specific pc, and in particular the
> one
> > with more memory. To be more precise (using same version of R 4.2.2 and
> > Terra terra 1.6.47, by means of as.data.frame() function):
> >
> > with a I5 processor with 8Gb of memory, windows 10 it works
> >
> > with a I7 processor with 16gb of memory, windows 11 it doesn't
> >
> > I'm not able to figure out a possible explanation!
> > Any suggestions on what to check?
> >
> >
> > SpatRaster
> > dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
> > resolution  : 30, 30  (x, y)
> > extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
> > ymax)
> > coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
> > source      : multyMadRes2c.tif
> >
> >
> >
> > Sebastiano
> >
> > *      Sebastiano Trevisani, Ph.D.*
> > *            Associate Professor*
> > *Applied and Environmental Geology*
> >
> >
> > *
> >
> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
> > <
> >
> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
> > >*
> > *IUAV University of Venice:
> >
> https://urldefense.com/v3/__http://www.iuav.it__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ag_1m0F$
> > <
> >
> https://urldefense.com/v3/__http://www.iuav.it/__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9cV-rY9s$
> > >*
> >
> > *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
> > 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
> > *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
> > * riflettono in alcun modo una posizione ufficiale dello IUAV "*
> > *"The views expressed are purely those of the writer and may not in
> > any circumstances be regarded as stating an official position of the
> > IUAV."*
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> >
> >
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-geo__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ScsuXEI$
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @trev|@@n| @end|ng |rom |u@v@|t  Mon Jan 23 19:18:44 2023
From: @trev|@@n| @end|ng |rom |u@v@|t (Sebastiano Trevisani)
Date: Mon, 23 Jan 2023 19:18:44 +0100
Subject: [R-sig-Geo] 
 strange issue of memory converting a raster to a data frame
In-Reply-To: <CAAQaj81UtqsGOQ65NWvj+j-XYVKryBF6+Hkr=H3ZUdof8rAXJQ@mail.gmail.com>
References: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
 <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>
 <CAC8_bdGz=DxHvVDCSNS3WiYrT=+EFFNOd9SeShEn61G2vtakHQ@mail.gmail.com>
 <CAAQaj81UtqsGOQ65NWvj+j-XYVKryBF6+Hkr=H3ZUdof8rAXJQ@mail.gmail.com>
Message-ID: <CAC8_bdHqYL2TyuDf6wy3xYkezbYu32HJDj09tCZCAjkrEz5BGg@mail.gmail.com>

Thank you Vlad!
This is a good solution, I keep it for future.

My issue is that I would like to understand why things don't work in the
best performing PC.

I'll do more experiments, to isolate the issue.

Sebastiano



Sebastiano



Il lun 23 gen 2023, 18:48 Vlad Amihaesei <vlad.amihaesei95 at gmail.com> ha
scritto:

> You can try converting each layer to data frame instead of all the layers
> at once time. You can do this using a loop.
>
> r <- terra::rast(file.nc)
>
> df<- NULL
>
> for( i in 1:nlyr(r)){
> r1 <-  r[[i]]
> r1.df <- as.data.frame(r1,xy =T)
> df <- rbind(df, r1.df)
> }
>
> Best  regards
>
> Vlad Alexandru AMIHAESEI
>
>
> On Mon, Jan 23, 2023 at 10:33 AM Sebastiano Trevisani <strevisani at iuav.it>
> wrote:
>
>> Hi  Lo?c,
>>
>> thank you for your suggestion! this was one of the possibilities I
>> checked.
>> However, I tried with terra.options() to change the memfrac parameter from
>> 0.6 to 0.1, so as to force the writing on disc, but things didn't work.
>> It seems like it is working as 32 bit system, but the R the installation
>> seems right to 64. Probably I'm missing something very obvious.
>> I will try to build a reproducible example without the need to upload all
>> the file.
>>
>> Thanks again,
>>
>> Sebastiano
>>
>> *      Sebastiano Trevisani, Ph.D.*
>> *            Associate Professor*
>> *Applied and Environmental Geology*
>>
>>
>> *  https://orcid.org/0000-0001-8436-7798
>> <https://orcid.org/0000-0001-8436-7798>*
>> *IUAV University of Venice: www.iuav.it <http://www.iuav.it/>*
>>
>> *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
>> 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
>> *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
>> * riflettono in alcun modo una posizione ufficiale dello IUAV "*
>> *"The views expressed are purely those of the writer and may not in
>> any circumstances be regarded as stating an official position of the
>> IUAV."*
>>
>>
>> On Mon, Jan 23, 2023 at 5:36 PM DUTRIEUX Loic <Loic.DUTRIEUX at ec.europa.eu
>> >
>> wrote:
>>
>> > Hi Sebastiano,
>> >
>> > Try comparing terra::terraOptions() and terra::mem_info(r) on both
>> > systems. Just guessing there but it could be that terra is trying to do
>> > everything in memory and failing on your 16GB system, while taking a
>> memory
>> > friendly route on your 8GB system.
>> >
>> > Cheers,
>> > Lo?c
>> > ________________________________________
>> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
>> Sebastiano
>> > Trevisani <strevisani at iuav.it>
>> > Sent: 23 January 2023 12:30:14
>> > To: r-sig-geo
>> > Subject: [R-sig-Geo] strange issue of memory converting a raster to a
>> data
>> > frame
>> >
>> > Dear list members,
>> >
>> > In converting a raster as the one below to a data frame, I have an
>> issue of
>> > memory allocation only when I use a specific pc, and in particular the
>> one
>> > with more memory. To be more precise (using same version of R 4.2.2 and
>> > Terra terra 1.6.47, by means of as.data.frame() function):
>> >
>> > with a I5 processor with 8Gb of memory, windows 10 it works
>> >
>> > with a I7 processor with 16gb of memory, windows 11 it doesn't
>> >
>> > I'm not able to figure out a possible explanation!
>> > Any suggestions on what to check?
>> >
>> >
>> > SpatRaster
>> > dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
>> > resolution  : 30, 30  (x, y)
>> > extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
>> > ymax)
>> > coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
>> > source      : multyMadRes2c.tif
>> >
>> >
>> >
>> > Sebastiano
>> >
>> > *      Sebastiano Trevisani, Ph.D.*
>> > *            Associate Professor*
>> > *Applied and Environmental Geology*
>> >
>> >
>> > *
>> >
>> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
>> > <
>> >
>> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
>> > >*
>> > *IUAV University of Venice:
>> >
>> https://urldefense.com/v3/__http://www.iuav.it__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ag_1m0F$
>> > <
>> >
>> https://urldefense.com/v3/__http://www.iuav.it/__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9cV-rY9s$
>> > >*
>> >
>> > *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
>> > 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
>> > *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
>> > * riflettono in alcun modo una posizione ufficiale dello IUAV "*
>> > *"The views expressed are purely those of the writer and may not in
>> > any circumstances be regarded as stating an official position of the
>> > IUAV."*
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> >
>> >
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-geo__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ScsuXEI$
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From mg@ @end|ng |rom ccee@ucm@e@  Mon Jan 23 20:11:44 2023
From: mg@ @end|ng |rom ccee@ucm@e@ (MIGUEL GOMEZ DE ANTONIO)
Date: Mon, 23 Jan 2023 20:11:44 +0100
Subject: [R-sig-Geo] Problem with writing a function that attaches atributes
 from polygons of a shapefile to the points of a grid
Message-ID: <CAFMmzH7Bq9MyBR0XSsw2nOnBi4Bgg=6JZV7Yt=3h_T7FW0pF2g@mail.gmail.com>

Hi all,

I need to create a function that georreference covariates that are not
available at the point level but at a census tract or any other
administrative polygon level (cities, regions, etc.).

My last goal is to create my own function that attaches the values of a
census tract shapefile to the points of the grid in an observation window.
Then I would like to kernel smooth it to obtain a covariate that is
continouos in the observation window that contains the grid points.

I am guessing that my problem is either in creating an object of the class
sf when adding the dataframe to the sfg object or when using the function
st_join () that is supposed to add the attributes of the polygon to the
points located in it.



#I first created the coordinates of the points of the grid in the
observation window "madrid_sqr_m" xy<-gridcentres(madrid_sqr_m,150,150)#
"madrid_sqr_m" is just the boundary of the grid (class owin)

#Then I created a sfg object multipolygon

x=as.numeric(xy$x)

y=as.numeric(xy$y)

XY=data.frame(x,y)

xy=as.matrix(XY)

xy=st_multipoint(xy)#creo el objeto sfg que es un conjunto de puntos
(multypoligon)

xy_crs=st_sfc(xy, crs=25830)#add the proyected reference system

xy_crs

#add the dataframe to have an object of class sf. NOT SURE IF I AM DOING
THIS RIGHT. THE GRID POINTS HAVE NOT ATTRIBUTES SO THE DATAFRAME SHOULD BE
EMPTY, ISN`T?

df <- data.frame(nombre = c("grid"))#

grid_sf=st_sf(df, xy_crs)#

class(grid_sf)# #Add the covariates of a shapefile named "Catfiscal", which
is a census tract polygon, to the points of the grid

join<-st_join(grid_sf,Catfiscal)# PROBLEM MIGHT BE HERE BECAUSE IS NOT
ASIGNING TO EACH GRID POINT THE COVARIATES OF THE POLIGONS

x=join$categoria# "categoria" is the covariate I would like to add to the
points of the grid once I convert the sf object into a "ppp" object of the
Spatstat

join.ppp<-as.ppp(st_coordinates(join), madrid_sqr_m)#"madrid_sqr_m" is just
the boundary of the grid (class owin)

grid_con_cat_f.ppp<-setmarks(join.ppp,x) **

*#Error in `marks<-.ppp`(`*tmp*`, value = value) : # number of points !=
number of marks ** *

density.CATF<-Smooth.ppp(grid_con_cat_f.ppp)

I have been stuck on this several weeks os any advice with be very much
appreciated
Thanks for your help

Miguel

	[[alternative HTML version deleted]]


From m@rce||no@de|@cruz @end|ng |rom urjc@e@  Mon Jan 23 21:59:39 2023
From: m@rce||no@de|@cruz @end|ng |rom urjc@e@ (Marcelino de la Cruz Rot)
Date: Mon, 23 Jan 2023 21:59:39 +0100
Subject: [R-sig-Geo] 
 Problem with writing a function that attaches atributes
 from polygons of a shapefile to the points of a grid
In-Reply-To: <CAFMmzH7Bq9MyBR0XSsw2nOnBi4Bgg=6JZV7Yt=3h_T7FW0pF2g@mail.gmail.com>
References: <CAFMmzH7Bq9MyBR0XSsw2nOnBi4Bgg=6JZV7Yt=3h_T7FW0pF2g@mail.gmail.com>
Message-ID: <f6093726-c792-b103-19cf-7e72c9c359ac@urjc.es>

Hi Miguel,
Maybe this way:


xy<-gridcentres(madrid_sqr_m,150,150)
xy.df <- as.data.frame(xy)
xy_sf <- st_as_sf(xy.df, coords=1:2)
xy_crs <- st_sfc(xy_sf, crs=25830)
xy_joined <- st_join(xy_crs, Catfiscal)
join.ppp <- ppp(st_coordinates(xy_joined)[,"X"], 
st_coordinates(xy_joined)[,"Y"], window=madrid_sqr_m, marks 
=xy_joined$categoria)

Cheers,
Marcelino




El 23/01/2023 a las 20:11, MIGUEL GOMEZ DE ANTONIO escribi?:
> [No suele recibir correo electr?nico de mga at ccee.ucm.es. Descubra por qu? esto es importante en https://aka.ms/LearnAboutSenderIdentification ]
>
> Hi all,
>
> I need to create a function that georreference covariates that are not
> available at the point level but at a census tract or any other
> administrative polygon level (cities, regions, etc.).
>
> My last goal is to create my own function that attaches the values of a
> census tract shapefile to the points of the grid in an observation window.
> Then I would like to kernel smooth it to obtain a covariate that is
> continouos in the observation window that contains the grid points.
>
> I am guessing that my problem is either in creating an object of the class
> sf when adding the dataframe to the sfg object or when using the function
> st_join () that is supposed to add the attributes of the polygon to the
> points located in it.
>
>
>
> #I first created the coordinates of the points of the grid in the
> observation window "madrid_sqr_m" xy<-gridcentres(madrid_sqr_m,150,150)#
> "madrid_sqr_m" is just the boundary of the grid (class owin)
>
> #Then I created a sfg object multipolygon
>
> x=as.numeric(xy$x)
>
> y=as.numeric(xy$y)
>
> XY=data.frame(x,y)
>
> xy=as.matrix(XY)
>
> xy=st_multipoint(xy)#creo el objeto sfg que es un conjunto de puntos
> (multypoligon)
>
> xy_crs=st_sfc(xy, crs=25830)#add the proyected reference system
>
> xy_crs
>
> #add the dataframe to have an object of class sf. NOT SURE IF I AM DOING
> THIS RIGHT. THE GRID POINTS HAVE NOT ATTRIBUTES SO THE DATAFRAME SHOULD BE
> EMPTY, ISN`T?
>
> df <- data.frame(nombre = c("grid"))#
>
> grid_sf=st_sf(df, xy_crs)#
>
> class(grid_sf)# #Add the covariates of a shapefile named "Catfiscal", which
> is a census tract polygon, to the points of the grid
>
> join<-st_join(grid_sf,Catfiscal)# PROBLEM MIGHT BE HERE BECAUSE IS NOT
> ASIGNING TO EACH GRID POINT THE COVARIATES OF THE POLIGONS
>
> x=join$categoria# "categoria" is the covariate I would like to add to the
> points of the grid once I convert the sf object into a "ppp" object of the
> Spatstat
>
> join.ppp<-as.ppp(st_coordinates(join), madrid_sqr_m)#"madrid_sqr_m" is just
> the boundary of the grid (class owin)
>
> grid_con_cat_f.ppp<-setmarks(join.ppp,x) **
>
> *#Error in `marks<-.ppp`(`*tmp*`, value = value) : # number of points !=
> number of marks ** *
>
> density.CATF<-Smooth.ppp(grid_con_cat_f.ppp)
>
> I have been stuck on this several weeks os any advice with be very much
> appreciated
> Thanks for your help
>
> Miguel
>
>          [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Marcelino de la Cruz Rot
Coordinador funcional de Biolog?a
Depto. de Biolog?a y Geolog?a
F?sica y Qu?mica Inorg?nica
Universidad Rey Juan Carlos
M?stoles Espa?a


From m||uj|@b @end|ng |rom gm@||@com  Tue Jan 24 12:13:20 2023
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Tue, 24 Jan 2023 12:13:20 +0100
Subject: [R-sig-Geo] Extract CRU data
Message-ID: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>

Greetings everyone,

I have a question on extracting country-level data from CRU (
https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/).
The data for each variable are available for individual countries and I am
struggling to download all of them. Can I extract all the files in R then
merge? Thanks so much.

Best,

Milu

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Tue Jan 24 13:44:58 2023
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Tue, 24 Jan 2023 12:44:58 +0000
Subject: [R-sig-Geo] Extract CRU data
In-Reply-To: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>
References: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>
Message-ID: <CANVKczP7dz70J6W9a6oVdmUfUF+WViUMewLF1nZOjL5sWUEdPA@mail.gmail.com>

Are you asking if there's a way to automate the download of a list of links
from that page? You could write an R script to get the HTML, then find all
the HTML <A> tags, and then get the URLs in the link addresses, and there's
packages for doing this kind of web scraping.

But for this kind of thing it might be easier to use a web browser add-on -
I have "Down Them All" set up on Firefox, and with a click or two I can get
a list of all the link URLs and hit a button that downloads everything to a
single folder. Once done, I can use standard R functions to list all the
downloaded files and read them. Took about 20 seconds to do for this page,
and now I have a folder of 292 .tmp.per files.

Barry


On Tue, Jan 24, 2023 at 11:13 AM Miluji Sb <milujisb at gmail.com> wrote:

> Greetings everyone,
>
> I have a question on extracting country-level data from CRU (
>
> https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/
> ).
> The data for each variable are available for individual countries and I am
> struggling to download all of them. Can I extract all the files in R then
> merge? Thanks so much.
>
> Best,
>
> Milu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @trev|@@n| @end|ng |rom |u@v@|t  Tue Jan 24 15:27:54 2023
From: @trev|@@n| @end|ng |rom |u@v@|t (Sebastiano Trevisani)
Date: Tue, 24 Jan 2023 15:27:54 +0100
Subject: [R-sig-Geo] 
 strange issue of memory converting a raster to a data frame
In-Reply-To: <CAC8_bdHqYL2TyuDf6wy3xYkezbYu32HJDj09tCZCAjkrEz5BGg@mail.gmail.com>
References: <CAC8_bdFR4Aq-9ewKcrhdLVeZb2i9fi471E9wjT8enZ2S5jzqZA@mail.gmail.com>
 <66a7e9a5f6e2424ea77fdc406a8521ce@ec.europa.eu>
 <CAC8_bdGz=DxHvVDCSNS3WiYrT=+EFFNOd9SeShEn61G2vtakHQ@mail.gmail.com>
 <CAAQaj81UtqsGOQ65NWvj+j-XYVKryBF6+Hkr=H3ZUdof8rAXJQ@mail.gmail.com>
 <CAC8_bdHqYL2TyuDf6wy3xYkezbYu32HJDj09tCZCAjkrEz5BGg@mail.gmail.com>
Message-ID: <CAC8_bdHBpvj2VXQ1uDzpgxw9CMPf=Yw65LY6NssoPP4M6RA=vQ@mail.gmail.com>

Dear Vlad and Loic,


Some more info on the issue; the error ("Error: cannot allocate vector of
size 1.7 Gb") shows a random behaviour, sometimes things work (e.g., after
a reboot) and sometimes not.

 Anyway this is a reproducible example:

theTest=rast(nrows=5000, ncols=5000, nlyrs=18, xmin=0, ymin=0,
vals=3333.333)
mem_info(theTest)
theDataFrame=as.data.frame(theTest)



Sebastiano




On Mon, Jan 23, 2023 at 7:18 PM Sebastiano Trevisani <strevisani at iuav.it>
wrote:

> Thank you Vlad!
> This is a good solution, I keep it for future.
>
> My issue is that I would like to understand why things don't work in the
> best performing PC.
>
> I'll do more experiments, to isolate the issue.
>
> Sebastiano
>
>
>
> Sebastiano
>
>
>
> Il lun 23 gen 2023, 18:48 Vlad Amihaesei <vlad.amihaesei95 at gmail.com> ha
> scritto:
>
>> You can try converting each layer to data frame instead of all the layers
>> at once time. You can do this using a loop.
>>
>> r <- terra::rast(file.nc)
>>
>> df<- NULL
>>
>> for( i in 1:nlyr(r)){
>> r1 <-  r[[i]]
>> r1.df <- as.data.frame(r1,xy =T)
>> df <- rbind(df, r1.df)
>> }
>>
>> Best  regards
>>
>> Vlad Alexandru AMIHAESEI
>>
>>
>> On Mon, Jan 23, 2023 at 10:33 AM Sebastiano Trevisani <strevisani at iuav.it>
>> wrote:
>>
>>> Hi  Lo?c,
>>>
>>> thank you for your suggestion! this was one of the possibilities I
>>> checked.
>>> However, I tried with terra.options() to change the memfrac parameter
>>> from
>>> 0.6 to 0.1, so as to force the writing on disc, but things didn't work.
>>> It seems like it is working as 32 bit system, but the R the installation
>>> seems right to 64. Probably I'm missing something very obvious.
>>> I will try to build a reproducible example without the need to upload all
>>> the file.
>>>
>>> Thanks again,
>>>
>>> Sebastiano
>>>
>>> *      Sebastiano Trevisani, Ph.D.*
>>> *            Associate Professor*
>>> *Applied and Environmental Geology*
>>>
>>>
>>> *  https://orcid.org/0000-0001-8436-7798
>>> <https://orcid.org/0000-0001-8436-7798>*
>>> *IUAV University of Venice: www.iuav.it <http://www.iuav.it/>*
>>>
>>> *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
>>> 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
>>> *"Le opinioni espresse sono riferibili esclusivamente all'autore e non *
>>> * riflettono in alcun modo una posizione ufficiale dello IUAV "*
>>> *"The views expressed are purely those of the writer and may not in
>>> any circumstances be regarded as stating an official position of the
>>> IUAV."*
>>>
>>>
>>> On Mon, Jan 23, 2023 at 5:36 PM DUTRIEUX Loic <
>>> Loic.DUTRIEUX at ec.europa.eu>
>>> wrote:
>>>
>>> > Hi Sebastiano,
>>> >
>>> > Try comparing terra::terraOptions() and terra::mem_info(r) on both
>>> > systems. Just guessing there but it could be that terra is trying to do
>>> > everything in memory and failing on your 16GB system, while taking a
>>> memory
>>> > friendly route on your 8GB system.
>>> >
>>> > Cheers,
>>> > Lo?c
>>> > ________________________________________
>>> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
>>> Sebastiano
>>> > Trevisani <strevisani at iuav.it>
>>> > Sent: 23 January 2023 12:30:14
>>> > To: r-sig-geo
>>> > Subject: [R-sig-Geo] strange issue of memory converting a raster to a
>>> data
>>> > frame
>>> >
>>> > Dear list members,
>>> >
>>> > In converting a raster as the one below to a data frame, I have an
>>> issue of
>>> > memory allocation only when I use a specific pc, and in particular the
>>> one
>>> > with more memory. To be more precise (using same version of R 4.2.2 and
>>> > Terra terra 1.6.47, by means of as.data.frame() function):
>>> >
>>> > with a I5 processor with 8Gb of memory, windows 10 it works
>>> >
>>> > with a I7 processor with 16gb of memory, windows 11 it doesn't
>>> >
>>> > I'm not able to figure out a possible explanation!
>>> > Any suggestions on what to check?
>>> >
>>> >
>>> > SpatRaster
>>> > dimensions  : 5000, 5000, 18  (nrow, ncol, nlyr)
>>> > resolution  : 30, 30  (x, y)
>>> > extent      : -8526.878, 141473.1, 4110588, 4260588  (xmin, xmax, ymin,
>>> > ymax)
>>> > coord. ref. : WGS 84 / UTM zone 45N (EPSG:32645)
>>> > source      : multyMadRes2c.tif
>>> >
>>> >
>>> >
>>> > Sebastiano
>>> >
>>> > *      Sebastiano Trevisani, Ph.D.*
>>> > *            Associate Professor*
>>> > *Applied and Environmental Geology*
>>> >
>>> >
>>> > *
>>> >
>>> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
>>> > <
>>> >
>>> https://urldefense.com/v3/__https://orcid.org/0000-0001-8436-7798__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9YxpzJmj$
>>> > >*
>>> > *IUAV University of Venice:
>>> >
>>> https://urldefense.com/v3/__http://www.iuav.it__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ag_1m0F$
>>> > <
>>> >
>>> https://urldefense.com/v3/__http://www.iuav.it/__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9cV-rY9s$
>>> > >*
>>> >
>>> > *Address: Dorsoduro 2206,  Venice 30123, Italy Tel:    +39. 041. 257
>>> > 1299Mail:    strevisani at iuav.it <strevisani at iuav.it> *
>>> > *"Le opinioni espresse sono riferibili esclusivamente all'autore e non
>>> *
>>> > * riflettono in alcun modo una posizione ufficiale dello IUAV "*
>>> > *"The views expressed are purely those of the writer and may not in
>>> > any circumstances be regarded as stating an official position of the
>>> > IUAV."*
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> >
>>> >
>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-geo__;!!DOxrgLBm!H86VAGwO3fNqAu4LS2hmv13aheZ9hGMiMmD7ZTN2sVxV-iuyV04Q_dV_lK5KNQauD3mFclNlC8a2LSlyZehq9ScsuXEI$
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>

	[[alternative HTML version deleted]]


From grzegorz @end|ng |rom @@p|j@@zko@net  Tue Jan 24 18:29:11 2023
From: grzegorz @end|ng |rom @@p|j@@zko@net (Grzegorz Sapijaszko)
Date: Tue, 24 Jan 2023 18:29:11 +0100
Subject: [R-sig-Geo] Extract CRU data
In-Reply-To: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>
References: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>
Message-ID: <9be62b1252ae418e842ce957c3a8b62926109a23.camel@sapijaszko.net>

On Tue, 2023-01-24 at 12:13 +0100, Miluji Sb wrote:
> Greetings everyone,
> 
> I have a question on extracting country-level data from CRU (
> https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/
> ).


Something like:

To get all links/filenames in one table:

a <-
rvest::read_html("https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/
") 

tbl <- a |>
  rvest::html_table() |>
  as.data.frame()

tbl <- tbl[-c(1,2),]

To download them all to specific directory

my_download_function <- function(myurl ="", output_dir = "data") {
  if(!dir.exists({{output_dir}})) {dir.create({{output_dir}})}
  .destfile = paste0({{output_dir}}, "/", {{myurl}})
  .myurl <-
paste0("https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/
", {{myurl}})
  download.file(url = .myurl, destfile = .destfile, method = "wget",
extra = "-c --progress=bar:force")  
  NULL
}

invisible(lapply(seq(nrow(tbl)), function(i)
my_download_function(tbl[i,1], "data")))

Now, having it locally you can read them one by one with read.csv,
like:

f <- list.files(path = "data", pattern = "crucy*", full.names = TRUE)
read.csv(f[i], skip = 3, header = TRUE)

It doesn't make sense without adding additional information about
country/territotry, but at least you have starting point.

Regards,
Grzegorz


From m@p|no|@10 @end|ng |rom gm@||@com  Tue Jan 24 23:29:35 2023
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Tue, 24 Jan 2023 16:29:35 -0600
Subject: [R-sig-Geo] geodata package: CMIP6 climate model data downloading
 error
Message-ID: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>

Dear list members,

I am trying to download CMIP6 climate model data using the R package
geodata but I got this error message:

bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
var="bioc", path = "climate_ckange")
trying URL '
https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
'
Error in utils::download.file(url = url, destfile = filename, quiet =
quiet,  :
  cannot open URL '
https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
'
download failed

I cannot even download the data using the worldclim website.


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Institutional website: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From b|@|ev||@t @end|ng |rom gm@||@com  Wed Jan 25 08:27:18 2023
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Wed, 25 Jan 2023 08:27:18 +0100
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
Message-ID: <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>

Dear Manuel,

There are some broken links in the WorldClim website. If you find one, 
you can write to info at worldclim.org. Although I have negative 
experiences, you should try this way.
Anyway, the global, non-tiled raster can be downloaded from this link:
https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif

Have a nice week,
?kos

_________
?kos Bede-Fazekas
Centre for Ecological Research, Hungary

2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
> Dear list members,
>
> I am trying to download CMIP6 climate model data using the R package
> geodata but I got this error message:
>
> bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
> var="bioc", path = "climate_ckange")
> trying URL '
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> '
> Error in utils::download.file(url = url, destfile = filename, quiet =
> quiet,  :
>    cannot open URL '
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> '
> download failed
>
> I cannot even download the data using the worldclim website.
>
>


From m||uj|@b @end|ng |rom gm@||@com  Wed Jan 25 12:02:58 2023
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Wed, 25 Jan 2023 12:02:58 +0100
Subject: [R-sig-Geo] Extract CRU data
In-Reply-To: <CANVKczP7dz70J6W9a6oVdmUfUF+WViUMewLF1nZOjL5sWUEdPA@mail.gmail.com>
References: <CAMLwc7NLn-0u68mS8PyW9OqaW1wJTXDBQg84igJ1Ozo5+ABtFQ@mail.gmail.com>
 <CANVKczP7dz70J6W9a6oVdmUfUF+WViUMewLF1nZOjL5sWUEdPA@mail.gmail.com>
Message-ID: <CAMLwc7OuujD5i9rdffwwXpdxo9DYVZcj251U22s_9=eV5UM2qQ@mail.gmail.com>

That indeed was the most efficient solution. Thank you!

On Tue, Jan 24, 2023 at 1:45 PM Barry Rowlingson <b.rowlingson at gmail.com>
wrote:

> Are you asking if there's a way to automate the download of a list of
> links from that page? You could write an R script to get the HTML, then
> find all the HTML <A> tags, and then get the URLs in the link addresses,
> and there's packages for doing this kind of web scraping.
>
> But for this kind of thing it might be easier to use a web browser add-on
> - I have "Down Them All" set up on Firefox, and with a click or two I can
> get a list of all the link URLs and hit a button that downloads everything
> to a single folder. Once done, I can use standard R functions to list all
> the downloaded files and read them. Took about 20 seconds to do for this
> page, and now I have a folder of 292 .tmp.per files.
>
> Barry
>
>
> On Tue, Jan 24, 2023 at 11:13 AM Miluji Sb <milujisb at gmail.com> wrote:
>
>> Greetings everyone,
>>
>> I have a question on extracting country-level data from CRU (
>>
>> https://crudata.uea.ac.uk/cru/data/hrg/cru_ts_4.06/crucy.2205251923.v4.06/countries/tmp/
>> ).
>> The data for each variable are available for individual countries and I am
>> struggling to download all of them. Can I extract all the files in R then
>> merge? Thanks so much.
>>
>> Best,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From |@b@@t|n @end|ng |rom @@ton@@c@uk  Wed Jan 25 13:11:12 2023
From: |@b@@t|n @end|ng |rom @@ton@@c@uk (Lucy Bastin)
Date: Wed, 25 Jan 2023 12:11:12 +0000
Subject: [R-sig-Geo] Two research positions (environmental informatics and
 data science) on the project 'AllData4GreenDeal' - Birmingham, UK
In-Reply-To: <DU2PR01MB88145D21E8B16BF2721F87C7C0CE9@DU2PR01MB8814.eurprd01.prod.exchangelabs.com>
References: <DU2PR01MB88142FD4D302CBE9BB573B7BC0359@DU2PR01MB8814.eurprd01.p
 rod.exchangelabs.com>
 <DU2PR01MB8814F25DA05C13F30CBA86E1C0CE9@DU2PR01MB8814.eurprd01.prod.exchangelabs.com>
 <DU2PR01MB88145D21E8B16BF2721F87C7C0CE9@DU2PR01MB8814.eurprd01.prod.exchangelabs.com>
Message-ID: <DU2PR01MB8814FAD5A93F5805723812BBC0CE9@DU2PR01MB8814.eurprd01.prod.exchangelabs.com>

Are you looking for a challenging and rewarding job where you can mobilise diverse data for practical environmental decision-making and communicate the results to a wide audience? We are advertising two research posts on the Horizon Europe / InnovateUK project 'All Data For Green Deal' (https://www.ad4gd.eu/)

The post holders will join the highly-respected School of Informatics and Digital Engineering at Aston University (Birmingham, UK) working with a consortium of expert partners from across Europe.

AD4GD's goal is to enable integration of data from remote sensing, citizen science, Internet of Things (IoT), socio-economic data and VREs / research infrastructures, to deliver interoperable, scalable and reliable services that support decision-making around Green Deal priorities. The Aston University team will work on interdisciplinary tasks to lay the groundwork for three exciting pilot studies focussing on pollution, biodiversity and climate change, and will then coordinate the implementation of those pilot studies.

Postdoctoral Research Associate in applied informatics / FAIR and interoperable environmental data science
Full job details: https://tinyurl.com/aston-pdra-fair
To apply: https://jobs.aston.ac.uk/Vacancy.aspx?ref=R230014

Research Assistant/ Postdoctoral Research Associate in environmental / geospatial modelling and data management
Full job details: https://tinyurl.com/aston-ra-pdra-env
To apply: https://jobs.aston.ac.uk/Vacancy.aspx?ref=R230015

Please submit your application with contact details of 3 referees, a CV, and covering letter stating why you are interested and what you would bring to the project. For informal enquires or further information, please directly contact Dr Lucy Bastin (l.bastin at aston.ac.uk<mailto:l.bastin at aston.ac.uk>).  The closing date for applications is 15th February.



	[[alternative HTML version deleted]]


From rd@-geo@p@t|@|-|g @end|ng |rom rd@-group@@org  Wed Jan 25 13:11:22 2023
From: rd@-geo@p@t|@|-|g @end|ng |rom rd@-group@@org (doctorluz via Geospatial IG)
Date: Wed, 25 Jan 2023 12:11:22 +0000
Subject: [R-sig-Geo] [rda-geospatial-ig] Two research positions
 (environmental informatics and data science) on the project
 'AllData4GreenDeal' - Birmingham, UK
Message-ID: <DU2PR01MB8814FAD5A93F5805723812BBC0CE9@DU2PR01MB8814.eurprd01.prod.exchangelabs.com>

Are you looking for a challenging and rewarding job where you can mobilise diverse data for practical environmental decision-making and communicate the results to a wide audience? We are advertising two research posts on the Horizon Europe / InnovateUK project 'All Data For Green Deal' (https://www.ad4gd.eu/)

The post holders will join the highly-respected School of Informatics and Digital Engineering at Aston University (Birmingham, UK) working with a consortium of expert partners from across Europe.

AD4GD's goal is to enable integration of data from remote sensing, citizen science, Internet of Things (IoT), socio-economic data and VREs / research infrastructures, to deliver interoperable, scalable and reliable services that support decision-making around Green Deal priorities. The Aston University team will work on interdisciplinary tasks to lay the groundwork for three exciting pilot studies focussing on pollution, biodiversity and climate change, and will then coordinate the implementation of those pilot studies.

Postdoctoral Research Associate in applied informatics / FAIR and interoperable environmental data science
Full job details: https://tinyurl.com/aston-pdra-fair
To apply: https://jobs.aston.ac.uk/Vacancy.aspx?ref=R230014

Research Assistant/ Postdoctoral Research Associate in environmental / geospatial modelling and data management
Full job details: https://tinyurl.com/aston-ra-pdra-env
To apply: https://jobs.aston.ac.uk/Vacancy.aspx?ref=R230015

Please submit your application with contact details of 3 referees, a CV, and covering letter stating why you are interested and what you would bring to the project. For informal enquires or further information, please directly contact Dr Lucy Bastin (l.bastin at aston.ac.uk<mailto:l.bastin at aston.ac.uk>).  The closing date for applications is 15th February.





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20230125/cf312d8b/attachment.html>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20230125/cf312d8b/attachment-0001.html>

From m@p|no|@10 @end|ng |rom gm@||@com  Wed Jan 25 15:48:15 2023
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 25 Jan 2023 08:48:15 -0600
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
 <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
Message-ID: <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>

Thank you very much ?kos.

It didn't work either.

Is there any other package that allows to download future climate change
scenarios?

Manuel



El mi?, 25 ene 2023 a las 1:27, Bede-Fazekas ?kos (<bfalevlist at gmail.com>)
escribi?:

> Dear Manuel,
>
> There are some broken links in the WorldClim website. If you find one,
> you can write to info at worldclim.org. Although I have negative
> experiences, you should try this way.
> Anyway, the global, non-tiled raster can be downloaded from this link:
>
> https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif
>
> Have a nice week,
> ?kos
>
> _________
> ?kos Bede-Fazekas
> Centre for Ecological Research, Hungary
>
> 2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
> > Dear list members,
> >
> > I am trying to download CMIP6 climate model data using the R package
> > geodata but I got this error message:
> >
> > bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
> > var="bioc", path = "climate_ckange")
> > trying URL '
> >
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> > '
> > Error in utils::download.file(url = url, destfile = filename, quiet =
> > quiet,  :
> >    cannot open URL '
> >
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> > '
> > download failed
> >
> > I cannot even download the data using the worldclim website.
> >
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Institutional website: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Wed Jan 25 16:00:43 2023
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Wed, 25 Jan 2023 16:00:43 +0100
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
 <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
 <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
Message-ID: <3b2bb870-9de5-ba22-af79-ac336b4fceb1@uni-muenster.de>



On 25/01/2023 15:48, Manuel Sp?nola wrote:
> Thank you very much ?kos.
> 
> It didn't work either.
> 
> Is there any other package that allows to download future climate change
> scenarios?

CMIP6 data is being uploaded as Zarr files on the google cloud; a blog 
post that gives examples of downloading some parts of it, using packages 
stars and sf, is here:
https://r-spatial.org/r/2022/09/13/zarr.html

> 
> Manuel
> 
> 
> 
> El mi?, 25 ene 2023 a las 1:27, Bede-Fazekas ?kos (<bfalevlist at gmail.com>)
> escribi?:
> 
>> Dear Manuel,
>>
>> There are some broken links in the WorldClim website. If you find one,
>> you can write to info at worldclim.org. Although I have negative
>> experiences, you should try this way.
>> Anyway, the global, non-tiled raster can be downloaded from this link:
>>
>> https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif
>>
>> Have a nice week,
>> ?kos
>>
>> _________
>> ?kos Bede-Fazekas
>> Centre for Ecological Research, Hungary
>>
>> 2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
>>> Dear list members,
>>>
>>> I am trying to download CMIP6 climate model data using the R package
>>> geodata but I got this error message:
>>>
>>> bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
>>> var="bioc", path = "climate_ckange")
>>> trying URL '
>>>
>> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>>> '
>>> Error in utils::download.file(url = url, destfile = filename, quiet =
>>> quiet,  :
>>>     cannot open URL '
>>>
>> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>>> '
>>> download failed
>>>
>>> I cannot even download the data using the worldclim website.
>>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From b|@|ev||@t @end|ng |rom gm@||@com  Wed Jan 25 16:02:41 2023
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Wed, 25 Jan 2023 16:02:41 +0100
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
 <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
 <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
Message-ID: <65b06467-1e90-d512-a783-8ba472d408af@gmail.com>

Dear Manuel,

for me this link 
(https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif) 
works perfectly in Firefox browser. It starts downloading the geoTiff file.
I think it should work with download.file() from R as well.

Alternatively, you can try package "easyclimate". I have no experience 
with this package, only read the scientific paper about this: 
https://www.sciencedirect.com/science/article/pii/S1364815223000130?dgcid=rss_sd_all
Please note that it is about daily climate instead of long-term averages.

HTH,
?kos
_________
?kos Bede-Fazekas
Centre for Ecological Research, Hungary

2023.01.25. 15:48 keltez?ssel, Manuel Sp?nola ?rta:
> Thank you very much ?kos.
>
> It didn't work either.
>
> Is there any other package that?allows to download future climate 
> change scenarios?
>
> Manuel
>
>
>
> El mi?, 25 ene 2023 a las 1:27, Bede-Fazekas ?kos 
> (<bfalevlist at gmail.com>) escribi?:
>
>     Dear Manuel,
>
>     There are some broken links in the WorldClim website. If you find
>     one,
>     you can write to info at worldclim.org. Although I have negative
>     experiences, you should try this way.
>     Anyway, the global, non-tiled raster can be downloaded from this link:
>     https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif
>
>     Have a nice week,
>     ?kos
>
>     _________
>     ?kos Bede-Fazekas
>     Centre for Ecological Research, Hungary
>
>     2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
>     > Dear list members,
>     >
>     > I am trying to download CMIP6 climate model data using the R package
>     > geodata but I got this error message:
>     >
>     > bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126",
>     "2021-2040",
>     > var="bioc", path = "climate_ckange")
>     > trying URL '
>     >
>     https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>     > '
>     > Error in utils::download.file(url = url, destfile = filename,
>     quiet =
>     > quiet,? :
>     >? ? cannot open URL '
>     >
>     https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>     > '
>     > download failed
>     >
>     > I cannot even download the data using the worldclim website.
>     >
>     >
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> -- 
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mailto:mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Institutional website: ICOMVIS 
> <http://www.icomvis.una.ac.cr/index.php/manuel>
> Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From m@p|no|@10 @end|ng |rom gm@||@com  Wed Jan 25 16:08:04 2023
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 25 Jan 2023 09:08:04 -0600
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <3b2bb870-9de5-ba22-af79-ac336b4fceb1@uni-muenster.de>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
 <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
 <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
 <3b2bb870-9de5-ba22-af79-ac336b4fceb1@uni-muenster.de>
Message-ID: <CABkCotQ4KD6en2GnRF0gBvOHuEgcC7HpBR=YP4N=8wDC49o+9g@mail.gmail.com>

Thank you very much Edzer.

El mi?, 25 ene 2023 a las 9:00, Edzer Pebesma (<
edzer.pebesma at uni-muenster.de>) escribi?:

>
>
> On 25/01/2023 15:48, Manuel Sp?nola wrote:
> > Thank you very much ?kos.
> >
> > It didn't work either.
> >
> > Is there any other package that allows to download future climate change
> > scenarios?
>
> CMIP6 data is being uploaded as Zarr files on the google cloud; a blog
> post that gives examples of downloading some parts of it, using packages
> stars and sf, is here:
> https://r-spatial.org/r/2022/09/13/zarr.html
>
> >
> > Manuel
> >
> >
> >
> > El mi?, 25 ene 2023 a las 1:27, Bede-Fazekas ?kos (<bfalevlist at gmail.com
> >)
> > escribi?:
> >
> >> Dear Manuel,
> >>
> >> There are some broken links in the WorldClim website. If you find one,
> >> you can write to info at worldclim.org. Although I have negative
> >> experiences, you should try this way.
> >> Anyway, the global, non-tiled raster can be downloaded from this link:
> >>
> >>
> https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif
> >>
> >> Have a nice week,
> >> ?kos
> >>
> >> _________
> >> ?kos Bede-Fazekas
> >> Centre for Ecological Research, Hungary
> >>
> >> 2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
> >>> Dear list members,
> >>>
> >>> I am trying to download CMIP6 climate model data using the R package
> >>> geodata but I got this error message:
> >>>
> >>> bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
> >>> var="bioc", path = "climate_ckange")
> >>> trying URL '
> >>>
> >>
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> >>> '
> >>> Error in utils::download.file(url = url, destfile = filename, quiet =
> >>> quiet,  :
> >>>     cannot open URL '
> >>>
> >>
> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
> >>> '
> >>> download failed
> >>>
> >>> I cannot even download the data using the worldclim website.
> >>>
> >>>
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Institutional website: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From m@p|no|@10 @end|ng |rom gm@||@com  Wed Jan 25 16:08:55 2023
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 25 Jan 2023 09:08:55 -0600
Subject: [R-sig-Geo] 
 geodata package: CMIP6 climate model data downloading error
In-Reply-To: <65b06467-1e90-d512-a783-8ba472d408af@gmail.com>
References: <CABkCotT0qyi1Kf_wkPFKv+GuPKXMvRU5M60KSQTFswTOa4gX-g@mail.gmail.com>
 <ba307ff3-601c-bbed-037b-b629b6c8c6d5@gmail.com>
 <CABkCotRUyWYMOEBkjeQyPKoSrgKcrVQJ8Uurb_Mvgw=O=kyRkg@mail.gmail.com>
 <65b06467-1e90-d512-a783-8ba472d408af@gmail.com>
Message-ID: <CABkCotSxW=OGjvfCR-sVwse2JkdaYi8RJawcLHFyQjdK8cy6yA@mail.gmail.com>

Thank you very much ?kos.

I was trying in Safari, I switched to firefox, and seems to work.

Manuel

El mi?, 25 ene 2023 a las 9:02, Bede-Fazekas ?kos (<bfalevlist at gmail.com>)
escribi?:

> Dear Manuel,
>
> for me this link (
> https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif)
> works perfectly in Firefox browser. It starts downloading the geoTiff file.
> I think it should work with download.file() from R as well.
>
> Alternatively, you can try package "easyclimate". I have no experience
> with this package, only read the scientific paper about this:
> https://www.sciencedirect.com/science/article/pii/S1364815223000130?dgcid=rss_sd_all
> Please note that it is about daily climate instead of long-term averages.
>
> HTH,
> ?kos
> _________
> ?kos Bede-Fazekas
> Centre for Ecological Research, Hungary
>
> 2023.01.25. 15:48 keltez?ssel, Manuel Sp?nola ?rta:
>
> Thank you very much ?kos.
>
> It didn't work either.
>
> Is there any other package that allows to download future climate change
> scenarios?
>
> Manuel
>
>
>
> El mi?, 25 ene 2023 a las 1:27, Bede-Fazekas ?kos (<bfalevlist at gmail.com>)
> escribi?:
>
>> Dear Manuel,
>>
>> There are some broken links in the WorldClim website. If you find one,
>> you can write to info at worldclim.org. Although I have negative
>> experiences, you should try this way.
>> Anyway, the global, non-tiled raster can be downloaded from this link:
>>
>> https://geodata.ucdavis.edu/cmip6/30s/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040.tif
>>
>> Have a nice week,
>> ?kos
>>
>> _________
>> ?kos Bede-Fazekas
>> Centre for Ecological Research, Hungary
>>
>> 2023.01.24. 23:29 keltez?ssel, Manuel Sp?nola ?rta:
>> > Dear list members,
>> >
>> > I am trying to download CMIP6 climate model data using the R package
>> > geodata but I got this error message:
>> >
>> > bio <- cmip6_tile(lon = -84, lat = 10,"ACCESS-CM2", "126", "2021-2040",
>> > var="bioc", path = "climate_ckange")
>> > trying URL '
>> >
>> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>> > '
>> > Error in utils::download.file(url = url, destfile = filename, quiet =
>> > quiet,  :
>> >    cannot open URL '
>> >
>> https://geodata.ucdavis.edu/cmip6/tiles/ACCESS-CM2/ssp126/wc2.1_30s_bioc_ACCESS-CM2_ssp126_2021-2040_tile-28.tif
>> > '
>> > download failed
>> >
>> > I cannot even download the data using the worldclim website.
>> >
>> >
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Institutional website: ICOMVIS
> <http://www.icomvis.una.ac.cr/index.php/manuel>
> Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app
>
>
>

-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Institutional website: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From m@p|no|@10 @end|ng |rom gm@||@com  Wed Jan 25 16:22:37 2023
From: m@p|no|@10 @end|ng |rom gm@||@com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 25 Jan 2023 09:22:37 -0600
Subject: [R-sig-Geo] Announcig 2 R data packages with geospatial data for
 Costa Rica and Central America
Message-ID: <CABkCotQFX0Cvaf2=WwMYtgiYVBgef=Xw8RBMFasjLDQP-n89Lw@mail.gmail.com>

Dear list members,

I would like to announce 2 R packages with geospatial data:

cageo, an R package with geospatial data of Central America.

https://github.com/ManuelSpinola/cageo

crgeo, an R package with geospatial data of Costa Rica

https://github.com/ManuelSpinola/crgeo

-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Institutional website: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Blog sobre Ciencia de Datos: https://mspinola-ciencia-de-datos.netlify.app

	[[alternative HTML version deleted]]


From @gutreuter @end|ng |rom gm@||@com  Wed Jan 25 18:37:34 2023
From: @gutreuter @end|ng |rom gm@||@com (Steve Gutreuter)
Date: Wed, 25 Jan 2023 12:37:34 -0500
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
Message-ID: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>

Is it safe to re-scale sf geometry coordinates from meters to
kilometers using, for example:

sfobj$geometry <- sfobj$geometry / 1000  

It seems to work, but I understand too little about spatial data to
know whether that practice is actually safe.  I am working with spatial
data in a continental-scale equidistant conic projection, and the units
are meters.  It seems that kilometers would be better suited stochastic
partial differential equation modeling on a finite-element mesh, but
maybe that is a moot point.

Any and all advice will be much appreciated.

Thanks!
-- 
Steve Gutreuter

	[[alternative HTML version deleted]]


From jo@|@h@p@rry @end|ng |rom gm@||@com  Wed Jan 25 18:42:21 2023
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Wed, 25 Jan 2023 12:42:21 -0500
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
Message-ID: <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>

I wonder if `units::set_units()` is a better fit for the job
https://r-quantities.github.io/units/articles/measurement_units_in_R.html

On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
wrote:

> Is it safe to re-scale sf geometry coordinates from meters to
> kilometers using, for example:
>
> sfobj$geometry <- sfobj$geometry / 1000
>
> It seems to work, but I understand too little about spatial data to
> know whether that practice is actually safe.  I am working with spatial
> data in a continental-scale equidistant conic projection, and the units
> are meters.  It seems that kilometers would be better suited stochastic
> partial differential equation modeling on a finite-element mesh, but
> maybe that is a moot point.
>
> Any and all advice will be much appreciated.
>
> Thanks!
> --
> Steve Gutreuter
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Wed Jan 25 18:49:21 2023
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Wed, 25 Jan 2023 18:49:21 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
Message-ID: <2f0075b5-d1f8-0eae-21f5-98c0e8ad4461@uni-muenster.de>

I guess the question is: "safe for what?" - if numerical errors are a 
problem without rescaling, then you should do it. You might be able to 
choose the rescaling factor such that these errors are minimized.

On 25/01/2023 18:37, Steve Gutreuter wrote:
> Is it safe to re-scale sf geometry coordinates from meters to
> kilometers using, for example:
> 
> sfobj$geometry <- sfobj$geometry / 1000
> 
> It seems to work, but I understand too little about spatial data to
> know whether that practice is actually safe.  I am working with spatial
> data in a continental-scale equidistant conic projection, and the units
> are meters.  It seems that kilometers would be better suited stochastic
> partial differential equation modeling on a finite-element mesh, but
> maybe that is a moot point.
> 
> Any and all advice will be much appreciated.
> 
> Thanks!

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Wed Jan 25 18:52:09 2023
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Wed, 25 Jan 2023 18:52:09 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
Message-ID: <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>



On 25/01/2023 18:42, Josiah Parry wrote:
> I wonder if `units::set_units()` is a better fit for the job
> https://r-quantities.github.io/units/articles/measurement_units_in_R.html

It could definitely tell you which number to choose when going from, 
say, US feet to km. Coordinates in sf geometries are not stored as units 
objects, unit info is encoded in the CRS. st_transform can do 
transformations and conversions between different CRSs, unit conversions 
is a special case of that.

> 
> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
> wrote:
> 
>> Is it safe to re-scale sf geometry coordinates from meters to
>> kilometers using, for example:
>>
>> sfobj$geometry <- sfobj$geometry / 1000
>>
>> It seems to work, but I understand too little about spatial data to
>> know whether that practice is actually safe.  I am working with spatial
>> data in a continental-scale equidistant conic projection, and the units
>> are meters.  It seems that kilometers would be better suited stochastic
>> partial differential equation modeling on a finite-element mesh, but
>> maybe that is a moot point.
>>
>> Any and all advice will be much appreciated.
>>
>> Thanks!
>> --
>> Steve Gutreuter
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From n|ko@@tz|ok@@ @end|ng |rom gm@||@com  Fri Jan 27 20:53:38 2023
From: n|ko@@tz|ok@@ @end|ng |rom gm@||@com (Nikolaos Tziokas)
Date: Fri, 27 Jan 2023 19:53:38 +0000
Subject: [R-sig-Geo] GWmodel - create prediction raster at a finer spatial
 scale when using multiple independent variables
Message-ID: <CAGg5H0ZixyC7XgAtjhwgQR65FADbzDe-n6g+MX+Zf+3S4mhQjw@mail.gmail.com>

I am using the package GWmodel to predict at a finer spatial scale.
Basically, I want my output to be a single raster layer. For the GWR, I am
using one dependent and 2 independent variables. I don't know how to create
the prediction raster.

When using only one independent variable it's easy. For example:

library(GWmodel)
library(sp)
library(raster)

wd = "path/"
provoliko = "EPSG:7767"

# this is my fine res raster
tirs = raster(paste0(wd, "tirs.tif"))
regpoints <- as(tirs, "SpatialPoints")

# this df contains the coarse res variables
block.data = read.csv(paste0(wd, "block.data.csv"))

coordinates(block.data) <- c("x", "y")
proj4string(block.data) <- provoliko

eq1 <- ntl ~ tirs
abw = bw.gwr(eq1,
             data = block.data,
             approach = "AIC",
             kernel = "gaussian",
             adaptive = TRUE,
             p = 2,
             parallel.method = "omp",
             parallel.arg = "omp")

ab_gwr = gwr.basic(eq1,
                   data = block.data,
                   regression.points = regpoints,
                   bw = abw,
                   kernel = "gaussian",
                   adaptive = TRUE,
                   p = 2,
                   F123.test = FALSE,
                   cv = FALSE,
                   parallel.method = "omp",
                   parallel.arg = "omp")

ab_gwr

sp <- ab_gwr$SDF
sf <- st_as_sf(sp)

# intercept
intercept = as.data.frame(sf$Intercept)
intercept = SpatialPointsDataFrame(data = intercept, coords = regpoints)
gridded(intercept) <- TRUE
intercept <- raster(intercept)
raster::crs(intercept) <- provoliko

# slope
slope = as.data.frame(sf$tirs)
slope = SpatialPointsDataFrame(data = slope, coords = regpoints)
gridded(slope) <- TRUE
slope <- raster(slope)
raster::crs(slope) <- provoliko

gwr_pred = intercept + slope * s

writeRaster(gwr_pred,
            paste0(wd, "ntl_gwr.tif"),
            overwrite = TRUE)

When using multiple independent variables, I tried to stack them before I
convert them to spatialPoints, but then I don't know what to set in the
slope parameter.

-- 
Tziokas Nikolaos
Cartographer

Tel:(+44)07561120302
LinkedIn <http://linkedin.com/in/nikolaos-tziokas-896081130>

	[[alternative HTML version deleted]]


From @ndre@@g||@rd| @end|ng |rom un|m|b@|t  Tue Jan 31 12:12:11 2023
From: @ndre@@g||@rd| @end|ng |rom un|m|b@|t (Andrea Gilardi)
Date: Tue, 31 Jan 2023 12:12:11 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
Message-ID: <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>

>  st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.

Dear all, I'm sorry if this is a trivial or stupid question but I was
wondering if you could provide an example of using st_transform to
apply a unit conversion transformation. For example, if I define
something like

library(sf)
pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
in North Italy
st_crs(3003) # units are expressed in metres

can I use st_transform to convert the unit measurement of pt from
metres to km and preserve that information in the CRS?

Thanks
Andrea


Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
<edzer.pebesma at uni-muenster.de> ha scritto:
>
>
>
> On 25/01/2023 18:42, Josiah Parry wrote:
> > I wonder if `units::set_units()` is a better fit for the job
> > https://r-quantities.github.io/units/articles/measurement_units_in_R.html
>
> It could definitely tell you which number to choose when going from,
> say, US feet to km. Coordinates in sf geometries are not stored as units
> objects, unit info is encoded in the CRS. st_transform can do
> transformations and conversions between different CRSs, unit conversions
> is a special case of that.
>
> >
> > On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
> > wrote:
> >
> >> Is it safe to re-scale sf geometry coordinates from meters to
> >> kilometers using, for example:
> >>
> >> sfobj$geometry <- sfobj$geometry / 1000
> >>
> >> It seems to work, but I understand too little about spatial data to
> >> know whether that practice is actually safe.  I am working with spatial
> >> data in a continental-scale equidistant conic projection, and the units
> >> are meters.  It seems that kilometers would be better suited stochastic
> >> partial differential equation modeling on a finite-element mesh, but
> >> maybe that is a moot point.
> >>
> >> Any and all advice will be much appreciated.
> >>
> >> Thanks!
> >> --
> >> Steve Gutreuter
> >>
> >>          [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Jan 31 12:33:36 2023
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 31 Jan 2023 12:33:36 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
Message-ID: <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>



On 31/01/2023 12:12, Andrea Gilardi wrote:
>>   st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
> 
> Dear all, I'm sorry if this is a trivial or stupid question but I was
> wondering if you could provide an example of using st_transform to
> apply a unit conversion transformation. For example, if I define
> something like
> 
> library(sf)
> pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
> in North Italy
> st_crs(3003) # units are expressed in metres
> 
> can I use st_transform to convert the unit measurement of pt from
> metres to km and preserve that information in the CRS?

It seems so, using proj4strings (not recommended, but simple):

library(sp)
demo(meuse, echo = FALSE, ask = FALSE)
library(sf)
# Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
st_as_sf(meuse) |> st_bbox()
#   xmin   ymin   xmax   ymax
# 178605 329714 181390 333611
st_crs(meuse)$proj4string
# [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889 
+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
st_as_sf(meuse) |>
   st_transform("+proj=sterea +lat_0=52.1561605555556 
+lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 
+ellps=bessel +units=km +no_defs") |>
   st_bbox()
#    xmin    ymin    xmax    ymax
# 178.605 329.714 181.390 333.611

The better way would be to modify WKT representations of CRSs.

> 
> Thanks
> Andrea
> 
> 
> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> ha scritto:
>>
>>
>>
>> On 25/01/2023 18:42, Josiah Parry wrote:
>>> I wonder if `units::set_units()` is a better fit for the job
>>> https://r-quantities.github.io/units/articles/measurement_units_in_R.html
>>
>> It could definitely tell you which number to choose when going from,
>> say, US feet to km. Coordinates in sf geometries are not stored as units
>> objects, unit info is encoded in the CRS. st_transform can do
>> transformations and conversions between different CRSs, unit conversions
>> is a special case of that.
>>
>>>
>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
>>> wrote:
>>>
>>>> Is it safe to re-scale sf geometry coordinates from meters to
>>>> kilometers using, for example:
>>>>
>>>> sfobj$geometry <- sfobj$geometry / 1000
>>>>
>>>> It seems to work, but I understand too little about spatial data to
>>>> know whether that practice is actually safe.  I am working with spatial
>>>> data in a continental-scale equidistant conic projection, and the units
>>>> are meters.  It seems that kilometers would be better suited stochastic
>>>> partial differential equation modeling on a finite-element mesh, but
>>>> maybe that is a moot point.
>>>>
>>>> Any and all advice will be much appreciated.
>>>>
>>>> Thanks!
>>>> --
>>>> Steve Gutreuter
>>>>
>>>>           [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics
>> Heisenbergstrasse 2, 48151 Muenster, Germany
>> Phone: +49 251 8333081
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From @ndre@@g||@rd| @end|ng |rom un|m|b@|t  Tue Jan 31 14:47:48 2023
From: @ndre@@g||@rd| @end|ng |rom un|m|b@|t (Andrea Gilardi)
Date: Tue, 31 Jan 2023 14:47:48 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
Message-ID: <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>

Thank you very much for your example! I briefly checked the examples
reported in ?st_transform and the docs at the PROJ website around
"Unit conversion"
(https://proj.org/operations/conversions/unitconvert.html) and I found
that the following code also seems to work (although with a warning
message that I'm not sure I understand):

library(sp)
demo(meuse, echo = FALSE, ask = FALSE)
library(sf)
#> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
sf_proj_network(TRUE)
#> [1] "https://cdn.proj.org"
st_as_sf(meuse) |> st_bbox()
#>   xmin   ymin   xmax   ymax
#> 178605 329714 181390 333611
meuse2 <- st_as_sf(meuse) |>
  st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
+xy_in=m +xy_out=km")
#> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not found in
#> PROJ-suggested candidate transformations
st_bbox(meuse2)
#>    xmin    ymin    xmax    ymax
#> 178.605 329.714 181.390 333.611

I think this might be easier than manually adjusting the WKT
representation of the CRS, but I'm not sure that this is really a
recommended way to transform units since, for some reason, it does not
modify the CRS of the objects which makes any analysis very difficult:

all.equal(st_crs(meuse), st_crs(meuse2))
#> [1] TRUE
library(mapview)
mapview(meuse) # seems right
mapview(meuse2) # completely off

Andrea

Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
<edzer.pebesma at uni-muenster.de> ha scritto:
>
>
>
> On 31/01/2023 12:12, Andrea Gilardi wrote:
> >>   st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
> >
> > Dear all, I'm sorry if this is a trivial or stupid question but I was
> > wondering if you could provide an example of using st_transform to
> > apply a unit conversion transformation. For example, if I define
> > something like
> >
> > library(sf)
> > pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
> > in North Italy
> > st_crs(3003) # units are expressed in metres
> >
> > can I use st_transform to convert the unit measurement of pt from
> > metres to km and preserve that information in the CRS?
>
> It seems so, using proj4strings (not recommended, but simple):
>
> library(sp)
> demo(meuse, echo = FALSE, ask = FALSE)
> library(sf)
> # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
> st_as_sf(meuse) |> st_bbox()
> #   xmin   ymin   xmax   ymax
> # 178605 329714 181390 333611
> st_crs(meuse)$proj4string
> # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
> st_as_sf(meuse) |>
>    st_transform("+proj=sterea +lat_0=52.1561605555556
> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> +ellps=bessel +units=km +no_defs") |>
>    st_bbox()
> #    xmin    ymin    xmax    ymax
> # 178.605 329.714 181.390 333.611
>
> The better way would be to modify WKT representations of CRSs.
>
> >
> > Thanks
> > Andrea
> >
> >
> > Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de> ha scritto:
> >>
> >>
> >>
> >> On 25/01/2023 18:42, Josiah Parry wrote:
> >>> I wonder if `units::set_units()` is a better fit for the job
> >>> https://r-quantities.github.io/units/articles/measurement_units_in_R.html
> >>
> >> It could definitely tell you which number to choose when going from,
> >> say, US feet to km. Coordinates in sf geometries are not stored as units
> >> objects, unit info is encoded in the CRS. st_transform can do
> >> transformations and conversions between different CRSs, unit conversions
> >> is a special case of that.
> >>
> >>>
> >>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
> >>> wrote:
> >>>
> >>>> Is it safe to re-scale sf geometry coordinates from meters to
> >>>> kilometers using, for example:
> >>>>
> >>>> sfobj$geometry <- sfobj$geometry / 1000
> >>>>
> >>>> It seems to work, but I understand too little about spatial data to
> >>>> know whether that practice is actually safe.  I am working with spatial
> >>>> data in a continental-scale equidistant conic projection, and the units
> >>>> are meters.  It seems that kilometers would be better suited stochastic
> >>>> partial differential equation modeling on a finite-element mesh, but
> >>>> maybe that is a moot point.
> >>>>
> >>>> Any and all advice will be much appreciated.
> >>>>
> >>>> Thanks!
> >>>> --
> >>>> Steve Gutreuter
> >>>>
> >>>>           [[alternative HTML version deleted]]
> >>>>
> >>>> _______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at r-project.org
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>
> >>>
> >>>        [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >> --
> >> Edzer Pebesma
> >> Institute for Geoinformatics
> >> Heisenbergstrasse 2, 48151 Muenster, Germany
> >> Phone: +49 251 8333081
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081


From jo@|@h@p@rry @end|ng |rom gm@||@com  Tue Jan 31 14:56:26 2023
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Tue, 31 Jan 2023 08:56:26 -0500
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
Message-ID: <CAL3ufU+80p2UNX+jqiVbjRWmvbPwLqMtfDPLdhcTZOMgr8BqSw@mail.gmail.com>

While the package interface isn't the friendliest, I think the crsuggest
package may be of interest for you. It's helpful for finding an appropriate
CRS in the units you need given an input CRS.

https://github.com/walkerke/crsuggest

I've used this to find an appropriate CRS and then transform based on the
top suggestion.

On Tue, Jan 31, 2023 at 8:48 AM Andrea Gilardi <andrea.gilardi at unimib.it>
wrote:

> Thank you very much for your example! I briefly checked the examples
> reported in ?st_transform and the docs at the PROJ website around
> "Unit conversion"
> (https://proj.org/operations/conversions/unitconvert.html) and I found
> that the following code also seems to work (although with a warning
> message that I'm not sure I understand):
>
> library(sp)
> demo(meuse, echo = FALSE, ask = FALSE)
> library(sf)
> #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
> sf_proj_network(TRUE)
> #> [1] "https://cdn.proj.org"
> st_as_sf(meuse) |> st_bbox()
> #>   xmin   ymin   xmax   ymax
> #> 178605 329714 181390 333611
> meuse2 <- st_as_sf(meuse) |>
>   st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
> +xy_in=m +xy_out=km")
> #> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not
> found in
> #> PROJ-suggested candidate transformations
> st_bbox(meuse2)
> #>    xmin    ymin    xmax    ymax
> #> 178.605 329.714 181.390 333.611
>
> I think this might be easier than manually adjusting the WKT
> representation of the CRS, but I'm not sure that this is really a
> recommended way to transform units since, for some reason, it does not
> modify the CRS of the objects which makes any analysis very difficult:
>
> all.equal(st_crs(meuse), st_crs(meuse2))
> #> [1] TRUE
> library(mapview)
> mapview(meuse) # seems right
> mapview(meuse2) # completely off
>
> Andrea
>
> Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> ha scritto:
> >
> >
> >
> > On 31/01/2023 12:12, Andrea Gilardi wrote:
> > >>   st_transform can do transformations and conversions between
> different CRSs, unit conversions is a special case of that.
> > >
> > > Dear all, I'm sorry if this is a trivial or stupid question but I was
> > > wondering if you could provide an example of using st_transform to
> > > apply a unit conversion transformation. For example, if I define
> > > something like
> > >
> > > library(sf)
> > > pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
> > > in North Italy
> > > st_crs(3003) # units are expressed in metres
> > >
> > > can I use st_transform to convert the unit measurement of pt from
> > > metres to km and preserve that information in the CRS?
> >
> > It seems so, using proj4strings (not recommended, but simple):
> >
> > library(sp)
> > demo(meuse, echo = FALSE, ask = FALSE)
> > library(sf)
> > # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
> > st_as_sf(meuse) |> st_bbox()
> > #   xmin   ymin   xmax   ymax
> > # 178605 329714 181390 333611
> > st_crs(meuse)$proj4string
> > # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
> > st_as_sf(meuse) |>
> >    st_transform("+proj=sterea +lat_0=52.1561605555556
> > +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> > +ellps=bessel +units=km +no_defs") |>
> >    st_bbox()
> > #    xmin    ymin    xmax    ymax
> > # 178.605 329.714 181.390 333.611
> >
> > The better way would be to modify WKT representations of CRSs.
> >
> > >
> > > Thanks
> > > Andrea
> > >
> > >
> > > Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
> > > <edzer.pebesma at uni-muenster.de> ha scritto:
> > >>
> > >>
> > >>
> > >> On 25/01/2023 18:42, Josiah Parry wrote:
> > >>> I wonder if `units::set_units()` is a better fit for the job
> > >>>
> https://r-quantities.github.io/units/articles/measurement_units_in_R.html
> > >>
> > >> It could definitely tell you which number to choose when going from,
> > >> say, US feet to km. Coordinates in sf geometries are not stored as
> units
> > >> objects, unit info is encoded in the CRS. st_transform can do
> > >> transformations and conversions between different CRSs, unit
> conversions
> > >> is a special case of that.
> > >>
> > >>>
> > >>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <
> sgutreuter at gmail.com>
> > >>> wrote:
> > >>>
> > >>>> Is it safe to re-scale sf geometry coordinates from meters to
> > >>>> kilometers using, for example:
> > >>>>
> > >>>> sfobj$geometry <- sfobj$geometry / 1000
> > >>>>
> > >>>> It seems to work, but I understand too little about spatial data to
> > >>>> know whether that practice is actually safe.  I am working with
> spatial
> > >>>> data in a continental-scale equidistant conic projection, and the
> units
> > >>>> are meters.  It seems that kilometers would be better suited
> stochastic
> > >>>> partial differential equation modeling on a finite-element mesh, but
> > >>>> maybe that is a moot point.
> > >>>>
> > >>>> Any and all advice will be much appreciated.
> > >>>>
> > >>>> Thanks!
> > >>>> --
> > >>>> Steve Gutreuter
> > >>>>
> > >>>>           [[alternative HTML version deleted]]
> > >>>>
> > >>>> _______________________________________________
> > >>>> R-sig-Geo mailing list
> > >>>> R-sig-Geo at r-project.org
> > >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >>>>
> > >>>
> > >>>        [[alternative HTML version deleted]]
> > >>>
> > >>> _______________________________________________
> > >>> R-sig-Geo mailing list
> > >>> R-sig-Geo at r-project.org
> > >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >>
> > >> --
> > >> Edzer Pebesma
> > >> Institute for Geoinformatics
> > >> Heisenbergstrasse 2, 48151 Muenster, Germany
> > >> Phone: +49 251 8333081
> > >>
> > >> _______________________________________________
> > >> R-sig-Geo mailing list
> > >> R-sig-Geo at r-project.org
> > >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > --
> > Edzer Pebesma
> > Institute for Geoinformatics
> > Heisenbergstrasse 2, 48151 Muenster, Germany
> > Phone: +49 251 8333081
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Jan 31 15:28:53 2023
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 31 Jan 2023 15:28:53 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
Message-ID: <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>

Yes, the pipeline approach bypasses GDAL, and doesn't result in an 
object with an appropriate CRS as a consequence.

On 31/01/2023 14:47, Andrea Gilardi wrote:
> Thank you very much for your example! I briefly checked the examples
> reported in ?st_transform and the docs at the PROJ website around
> "Unit conversion"
> (https://proj.org/operations/conversions/unitconvert.html) and I found
> that the following code also seems to work (although with a warning
> message that I'm not sure I understand):
> 
> library(sp)
> demo(meuse, echo = FALSE, ask = FALSE)
> library(sf)
> #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
> sf_proj_network(TRUE)
> #> [1] "https://cdn.proj.org"
> st_as_sf(meuse) |> st_bbox()
> #>   xmin   ymin   xmax   ymax
> #> 178605 329714 181390 333611
> meuse2 <- st_as_sf(meuse) |>
>    st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
> +xy_in=m +xy_out=km")
> #> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not found in
> #> PROJ-suggested candidate transformations
> st_bbox(meuse2)
> #>    xmin    ymin    xmax    ymax
> #> 178.605 329.714 181.390 333.611
> 
> I think this might be easier than manually adjusting the WKT
> representation of the CRS, but I'm not sure that this is really a
> recommended way to transform units since, for some reason, it does not
> modify the CRS of the objects which makes any analysis very difficult:
> 
> all.equal(st_crs(meuse), st_crs(meuse2))
> #> [1] TRUE
> library(mapview)
> mapview(meuse) # seems right
> mapview(meuse2) # completely off
> 
> Andrea
> 
> Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> ha scritto:
>>
>>
>>
>> On 31/01/2023 12:12, Andrea Gilardi wrote:
>>>>    st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
>>>
>>> Dear all, I'm sorry if this is a trivial or stupid question but I was
>>> wondering if you could provide an example of using st_transform to
>>> apply a unit conversion transformation. For example, if I define
>>> something like
>>>
>>> library(sf)
>>> pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
>>> in North Italy
>>> st_crs(3003) # units are expressed in metres
>>>
>>> can I use st_transform to convert the unit measurement of pt from
>>> metres to km and preserve that information in the CRS?
>>
>> It seems so, using proj4strings (not recommended, but simple):
>>
>> library(sp)
>> demo(meuse, echo = FALSE, ask = FALSE)
>> library(sf)
>> # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
>> st_as_sf(meuse) |> st_bbox()
>> #   xmin   ymin   xmax   ymax
>> # 178605 329714 181390 333611
>> st_crs(meuse)$proj4string
>> # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
>> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
>> st_as_sf(meuse) |>
>>     st_transform("+proj=sterea +lat_0=52.1561605555556
>> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>> +ellps=bessel +units=km +no_defs") |>
>>     st_bbox()
>> #    xmin    ymin    xmax    ymax
>> # 178.605 329.714 181.390 333.611
>>
>> The better way would be to modify WKT representations of CRSs.
>>
>>>
>>> Thanks
>>> Andrea
>>>
>>>
>>> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
>>> <edzer.pebesma at uni-muenster.de> ha scritto:
>>>>
>>>>
>>>>
>>>> On 25/01/2023 18:42, Josiah Parry wrote:
>>>>> I wonder if `units::set_units()` is a better fit for the job
>>>>> https://r-quantities.github.io/units/articles/measurement_units_in_R.html
>>>>
>>>> It could definitely tell you which number to choose when going from,
>>>> say, US feet to km. Coordinates in sf geometries are not stored as units
>>>> objects, unit info is encoded in the CRS. st_transform can do
>>>> transformations and conversions between different CRSs, unit conversions
>>>> is a special case of that.
>>>>
>>>>>
>>>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Is it safe to re-scale sf geometry coordinates from meters to
>>>>>> kilometers using, for example:
>>>>>>
>>>>>> sfobj$geometry <- sfobj$geometry / 1000
>>>>>>
>>>>>> It seems to work, but I understand too little about spatial data to
>>>>>> know whether that practice is actually safe.  I am working with spatial
>>>>>> data in a continental-scale equidistant conic projection, and the units
>>>>>> are meters.  It seems that kilometers would be better suited stochastic
>>>>>> partial differential equation modeling on a finite-element mesh, but
>>>>>> maybe that is a moot point.
>>>>>>
>>>>>> Any and all advice will be much appreciated.
>>>>>>
>>>>>> Thanks!
>>>>>> --
>>>>>> Steve Gutreuter
>>>>>>
>>>>>>            [[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics
>>>> Heisenbergstrasse 2, 48151 Muenster, Germany
>>>> Phone: +49 251 8333081
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics
>> Heisenbergstrasse 2, 48151 Muenster, Germany
>> Phone: +49 251 8333081

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From @ndre@@g||@rd| @end|ng |rom un|m|b@|t  Tue Jan 31 15:35:57 2023
From: @ndre@@g||@rd| @end|ng |rom un|m|b@|t (Andrea Gilardi)
Date: Tue, 31 Jan 2023 15:35:57 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
 <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
Message-ID: <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com>

Thanks again to both of you for the suggestion and the explanation.

Kind regards
Andrea

Il giorno mar 31 gen 2023 alle ore 15:28 Edzer Pebesma
<edzer.pebesma at uni-muenster.de> ha scritto:
>
> Yes, the pipeline approach bypasses GDAL, and doesn't result in an
> object with an appropriate CRS as a consequence.
>
> On 31/01/2023 14:47, Andrea Gilardi wrote:
> > Thank you very much for your example! I briefly checked the examples
> > reported in ?st_transform and the docs at the PROJ website around
> > "Unit conversion"
> > (https://proj.org/operations/conversions/unitconvert.html) and I found
> > that the following code also seems to work (although with a warning
> > message that I'm not sure I understand):
> >
> > library(sp)
> > demo(meuse, echo = FALSE, ask = FALSE)
> > library(sf)
> > #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
> > sf_proj_network(TRUE)
> > #> [1] "https://cdn.proj.org"
> > st_as_sf(meuse) |> st_bbox()
> > #>   xmin   ymin   xmax   ymax
> > #> 178605 329714 181390 333611
> > meuse2 <- st_as_sf(meuse) |>
> >    st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
> > +xy_in=m +xy_out=km")
> > #> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not found in
> > #> PROJ-suggested candidate transformations
> > st_bbox(meuse2)
> > #>    xmin    ymin    xmax    ymax
> > #> 178.605 329.714 181.390 333.611
> >
> > I think this might be easier than manually adjusting the WKT
> > representation of the CRS, but I'm not sure that this is really a
> > recommended way to transform units since, for some reason, it does not
> > modify the CRS of the objects which makes any analysis very difficult:
> >
> > all.equal(st_crs(meuse), st_crs(meuse2))
> > #> [1] TRUE
> > library(mapview)
> > mapview(meuse) # seems right
> > mapview(meuse2) # completely off
> >
> > Andrea
> >
> > Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de> ha scritto:
> >>
> >>
> >>
> >> On 31/01/2023 12:12, Andrea Gilardi wrote:
> >>>>    st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
> >>>
> >>> Dear all, I'm sorry if this is a trivial or stupid question but I was
> >>> wondering if you could provide an example of using st_transform to
> >>> apply a unit conversion transformation. For example, if I define
> >>> something like
> >>>
> >>> library(sf)
> >>> pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
> >>> in North Italy
> >>> st_crs(3003) # units are expressed in metres
> >>>
> >>> can I use st_transform to convert the unit measurement of pt from
> >>> metres to km and preserve that information in the CRS?
> >>
> >> It seems so, using proj4strings (not recommended, but simple):
> >>
> >> library(sp)
> >> demo(meuse, echo = FALSE, ask = FALSE)
> >> library(sf)
> >> # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
> >> st_as_sf(meuse) |> st_bbox()
> >> #   xmin   ymin   xmax   ymax
> >> # 178605 329714 181390 333611
> >> st_crs(meuse)$proj4string
> >> # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
> >> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
> >> st_as_sf(meuse) |>
> >>     st_transform("+proj=sterea +lat_0=52.1561605555556
> >> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> >> +ellps=bessel +units=km +no_defs") |>
> >>     st_bbox()
> >> #    xmin    ymin    xmax    ymax
> >> # 178.605 329.714 181.390 333.611
> >>
> >> The better way would be to modify WKT representations of CRSs.
> >>
> >>>
> >>> Thanks
> >>> Andrea
> >>>
> >>>
> >>> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
> >>> <edzer.pebesma at uni-muenster.de> ha scritto:
> >>>>
> >>>>
> >>>>
> >>>> On 25/01/2023 18:42, Josiah Parry wrote:
> >>>>> I wonder if `units::set_units()` is a better fit for the job
> >>>>> https://r-quantities.github.io/units/articles/measurement_units_in_R.html
> >>>>
> >>>> It could definitely tell you which number to choose when going from,
> >>>> say, US feet to km. Coordinates in sf geometries are not stored as units
> >>>> objects, unit info is encoded in the CRS. st_transform can do
> >>>> transformations and conversions between different CRSs, unit conversions
> >>>> is a special case of that.
> >>>>
> >>>>>
> >>>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
> >>>>> wrote:
> >>>>>
> >>>>>> Is it safe to re-scale sf geometry coordinates from meters to
> >>>>>> kilometers using, for example:
> >>>>>>
> >>>>>> sfobj$geometry <- sfobj$geometry / 1000
> >>>>>>
> >>>>>> It seems to work, but I understand too little about spatial data to
> >>>>>> know whether that practice is actually safe.  I am working with spatial
> >>>>>> data in a continental-scale equidistant conic projection, and the units
> >>>>>> are meters.  It seems that kilometers would be better suited stochastic
> >>>>>> partial differential equation modeling on a finite-element mesh, but
> >>>>>> maybe that is a moot point.
> >>>>>>
> >>>>>> Any and all advice will be much appreciated.
> >>>>>>
> >>>>>> Thanks!
> >>>>>> --
> >>>>>> Steve Gutreuter
> >>>>>>
> >>>>>>            [[alternative HTML version deleted]]
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> R-sig-Geo mailing list
> >>>>>> R-sig-Geo at r-project.org
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>>>
> >>>>>
> >>>>>         [[alternative HTML version deleted]]
> >>>>>
> >>>>> _______________________________________________
> >>>>> R-sig-Geo mailing list
> >>>>> R-sig-Geo at r-project.org
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>
> >>>> --
> >>>> Edzer Pebesma
> >>>> Institute for Geoinformatics
> >>>> Heisenbergstrasse 2, 48151 Muenster, Germany
> >>>> Phone: +49 251 8333081
> >>>>
> >>>> _______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at r-project.org
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >> --
> >> Edzer Pebesma
> >> Institute for Geoinformatics
> >> Heisenbergstrasse 2, 48151 Muenster, Germany
> >> Phone: +49 251 8333081
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jan 31 15:50:29 2023
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 31 Jan 2023 15:50:29 +0100 (CET)
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
 <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
 <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com>
Message-ID: <85a26e97-3418-ada8-a8a7-86ea5a88de70@reclus2.nhh.no>

On Tue, 31 Jan 2023, Andrea Gilardi wrote:

> Thanks again to both of you for the suggestion and the explanation.

Using:

meuse1 <- st_as_sf(meuse)
meuse2 <- st_transform(meuse1, sub("units=m", "units=km",
   st_crs(meuse1)$proj4string))

gives

st_crs(meuse2)

Coordinate Reference System:
   User input: +proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889 
+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=km +no_defs
   wkt:
PROJCRS["unknown",
     BASEGEOGCRS["unknown",
         DATUM["Unknown based on Bessel 1841 ellipsoid",
             ELLIPSOID["Bessel 1841",6377397.155,299.1528128,
                 LENGTHUNIT["metre",1,
                     ID["EPSG",9001]]]],
         PRIMEM["Greenwich",0,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8901]]],
     CONVERSION["unknown",
         METHOD["Oblique Stereographic",
             ID["EPSG",9809]],
         PARAMETER["Latitude of natural origin",52.1561605555556,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8801]],
         PARAMETER["Longitude of natural origin",5.38763888888889,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8802]],
         PARAMETER["Scale factor at natural origin",0.9999079,
             SCALEUNIT["unity",1],
             ID["EPSG",8805]],
         PARAMETER["False easting",155,
             LENGTHUNIT["kilometre",1000],
             ID["EPSG",8806]],
         PARAMETER["False northing",463,
             LENGTHUNIT["kilometre",1000],
             ID["EPSG",8807]]],
     CS[Cartesian,2],
         AXIS["(E)",east,
             ORDER[1],
             LENGTHUNIT["kilometre",1000,
                 ID["EPSG",9036]]],
         AXIS["(N)",north,
             ORDER[2],
             LENGTHUNIT["kilometre",1000,
                 ID["EPSG",9036]]]]

which does preserve the units, but does not preserve the datum. So may be 
suitable when the output is never sent to others.

Roger

>
> Kind regards
> Andrea
>
> Il giorno mar 31 gen 2023 alle ore 15:28 Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> ha scritto:
>>
>> Yes, the pipeline approach bypasses GDAL, and doesn't result in an
>> object with an appropriate CRS as a consequence.
>>
>> On 31/01/2023 14:47, Andrea Gilardi wrote:
>>> Thank you very much for your example! I briefly checked the examples
>>> reported in ?st_transform and the docs at the PROJ website around
>>> "Unit conversion"
>>> (https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fproj.org%2Foperations%2Fconversions%2Funitconvert.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=fVmKdcLGpNo7%2F%2Bn%2FEOiMs3qOX8lssLIh%2BW%2FLZkGjywk%3D&reserved=0) and I found
>>> that the following code also seems to work (although with a warning
>>> message that I'm not sure I understand):
>>>
>>> library(sp)
>>> demo(meuse, echo = FALSE, ask = FALSE)
>>> library(sf)
>>> #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
>>> sf_proj_network(TRUE)
>>> #> [1] "https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdn.proj.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rJdG7JgaY786%2BqOgeRTufTMdoGzmw97dvLb%2BUa6eYOc%3D&reserved=0"
>>> st_as_sf(meuse) |> st_bbox()
>>> #>   xmin   ymin   xmax   ymax
>>> #> 178605 329714 181390 333611
>>> meuse2 <- st_as_sf(meuse) |>
>>>    st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
>>> +xy_in=m +xy_out=km")
>>> #> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not found in
>>> #> PROJ-suggested candidate transformations
>>> st_bbox(meuse2)
>>> #>    xmin    ymin    xmax    ymax
>>> #> 178.605 329.714 181.390 333.611
>>>
>>> I think this might be easier than manually adjusting the WKT
>>> representation of the CRS, but I'm not sure that this is really a
>>> recommended way to transform units since, for some reason, it does not
>>> modify the CRS of the objects which makes any analysis very difficult:
>>>
>>> all.equal(st_crs(meuse), st_crs(meuse2))
>>> #> [1] TRUE
>>> library(mapview)
>>> mapview(meuse) # seems right
>>> mapview(meuse2) # completely off
>>>
>>> Andrea
>>>
>>> Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
>>> <edzer.pebesma at uni-muenster.de> ha scritto:
>>>>
>>>>
>>>>
>>>> On 31/01/2023 12:12, Andrea Gilardi wrote:
>>>>>>    st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
>>>>>
>>>>> Dear all, I'm sorry if this is a trivial or stupid question but I was
>>>>> wondering if you could provide an example of using st_transform to
>>>>> apply a unit conversion transformation. For example, if I define
>>>>> something like
>>>>>
>>>>> library(sf)
>>>>> pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
>>>>> in North Italy
>>>>> st_crs(3003) # units are expressed in metres
>>>>>
>>>>> can I use st_transform to convert the unit measurement of pt from
>>>>> metres to km and preserve that information in the CRS?
>>>>
>>>> It seems so, using proj4strings (not recommended, but simple):
>>>>
>>>> library(sp)
>>>> demo(meuse, echo = FALSE, ask = FALSE)
>>>> library(sf)
>>>> # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
>>>> st_as_sf(meuse) |> st_bbox()
>>>> #   xmin   ymin   xmax   ymax
>>>> # 178605 329714 181390 333611
>>>> st_crs(meuse)$proj4string
>>>> # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
>>>> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
>>>> st_as_sf(meuse) |>
>>>>     st_transform("+proj=sterea +lat_0=52.1561605555556
>>>> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>>>> +ellps=bessel +units=km +no_defs") |>
>>>>     st_bbox()
>>>> #    xmin    ymin    xmax    ymax
>>>> # 178.605 329.714 181.390 333.611
>>>>
>>>> The better way would be to modify WKT representations of CRSs.
>>>>
>>>>>
>>>>> Thanks
>>>>> Andrea
>>>>>
>>>>>
>>>>> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
>>>>> <edzer.pebesma at uni-muenster.de> ha scritto:
>>>>>>
>>>>>>
>>>>>>
>>>>>> On 25/01/2023 18:42, Josiah Parry wrote:
>>>>>>> I wonder if `units::set_units()` is a better fit for the job
>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-quantities.github.io%2Funits%2Farticles%2Fmeasurement_units_in_R.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yBdfWvCeDu9W2Y9yXC5uRKA0QnzVdoZVWOr9KXfjK50%3D&reserved=0
>>>>>>
>>>>>> It could definitely tell you which number to choose when going from,
>>>>>> say, US feet to km. Coordinates in sf geometries are not stored as units
>>>>>> objects, unit info is encoded in the CRS. st_transform can do
>>>>>> transformations and conversions between different CRSs, unit conversions
>>>>>> is a special case of that.
>>>>>>
>>>>>>>
>>>>>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
>>>>>>> wrote:
>>>>>>>
>>>>>>>> Is it safe to re-scale sf geometry coordinates from meters to
>>>>>>>> kilometers using, for example:
>>>>>>>>
>>>>>>>> sfobj$geometry <- sfobj$geometry / 1000
>>>>>>>>
>>>>>>>> It seems to work, but I understand too little about spatial data to
>>>>>>>> know whether that practice is actually safe.  I am working with spatial
>>>>>>>> data in a continental-scale equidistant conic projection, and the units
>>>>>>>> are meters.  It seems that kilometers would be better suited stochastic
>>>>>>>> partial differential equation modeling on a finite-element mesh, but
>>>>>>>> maybe that is a moot point.
>>>>>>>>
>>>>>>>> Any and all advice will be much appreciated.
>>>>>>>>
>>>>>>>> Thanks!
>>>>>>>> --
>>>>>>>> Steve Gutreuter
>>>>>>>>
>>>>>>>>            [[alternative HTML version deleted]]
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>>>>>
>>>>>>>
>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>>>
>>>>>> --
>>>>>> Edzer Pebesma
>>>>>> Institute for Geoinformatics
>>>>>> Heisenbergstrasse 2, 48151 Muenster, Germany
>>>>>> Phone: +49 251 8333081
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics
>>>> Heisenbergstrasse 2, 48151 Muenster, Germany
>>>> Phone: +49 251 8333081
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics
>> Heisenbergstrasse 2, 48151 Muenster, Germany
>> Phone: +49 251 8333081
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @ndre@@g||@rd| @end|ng |rom un|m|b@|t  Tue Jan 31 18:36:18 2023
From: @ndre@@g||@rd| @end|ng |rom un|m|b@|t (Andrea Gilardi)
Date: Tue, 31 Jan 2023 18:36:18 +0100
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <85a26e97-3418-ada8-a8a7-86ea5a88de70@reclus2.nhh.no>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
 <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
 <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com>
 <85a26e97-3418-ada8-a8a7-86ea5a88de70@reclus2.nhh.no>
Message-ID: <CAP+kri-JLGw34qCh9p_S0KrsUSD1mJYaZi+KTjwkiD+3vOEsWQ@mail.gmail.com>

Thanks, Roger. That's not a common problem (at least for me), but it
is typically useful to adjust the unit of measurement when I need to
integrate sf objects with other packages (e.g. spatstat) where the
numerical algorithm might benefit from rescaling.

Andrea

Il giorno mar 31 gen 2023 alle ore 15:50 Roger Bivand
<Roger.Bivand at nhh.no> ha scritto:
>
> On Tue, 31 Jan 2023, Andrea Gilardi wrote:
>
> > Thanks again to both of you for the suggestion and the explanation.
>
> Using:
>
> meuse1 <- st_as_sf(meuse)
> meuse2 <- st_transform(meuse1, sub("units=m", "units=km",
>    st_crs(meuse1)$proj4string))
>
> gives
>
> st_crs(meuse2)
>
> Coordinate Reference System:
>    User input: +proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=km +no_defs
>    wkt:
> PROJCRS["unknown",
>      BASEGEOGCRS["unknown",
>          DATUM["Unknown based on Bessel 1841 ellipsoid",
>              ELLIPSOID["Bessel 1841",6377397.155,299.1528128,
>                  LENGTHUNIT["metre",1,
>                      ID["EPSG",9001]]]],
>          PRIMEM["Greenwich",0,
>              ANGLEUNIT["degree",0.0174532925199433],
>              ID["EPSG",8901]]],
>      CONVERSION["unknown",
>          METHOD["Oblique Stereographic",
>              ID["EPSG",9809]],
>          PARAMETER["Latitude of natural origin",52.1561605555556,
>              ANGLEUNIT["degree",0.0174532925199433],
>              ID["EPSG",8801]],
>          PARAMETER["Longitude of natural origin",5.38763888888889,
>              ANGLEUNIT["degree",0.0174532925199433],
>              ID["EPSG",8802]],
>          PARAMETER["Scale factor at natural origin",0.9999079,
>              SCALEUNIT["unity",1],
>              ID["EPSG",8805]],
>          PARAMETER["False easting",155,
>              LENGTHUNIT["kilometre",1000],
>              ID["EPSG",8806]],
>          PARAMETER["False northing",463,
>              LENGTHUNIT["kilometre",1000],
>              ID["EPSG",8807]]],
>      CS[Cartesian,2],
>          AXIS["(E)",east,
>              ORDER[1],
>              LENGTHUNIT["kilometre",1000,
>                  ID["EPSG",9036]]],
>          AXIS["(N)",north,
>              ORDER[2],
>              LENGTHUNIT["kilometre",1000,
>                  ID["EPSG",9036]]]]
>
> which does preserve the units, but does not preserve the datum. So may be
> suitable when the output is never sent to others.
>
> Roger
>
> >
> > Kind regards
> > Andrea
> >
> > Il giorno mar 31 gen 2023 alle ore 15:28 Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de> ha scritto:
> >>
> >> Yes, the pipeline approach bypasses GDAL, and doesn't result in an
> >> object with an appropriate CRS as a consequence.
> >>
> >> On 31/01/2023 14:47, Andrea Gilardi wrote:
> >>> Thank you very much for your example! I briefly checked the examples
> >>> reported in ?st_transform and the docs at the PROJ website around
> >>> "Unit conversion"
> >>> (https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fproj.org%2Foperations%2Fconversions%2Funitconvert.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=fVmKdcLGpNo7%2F%2Bn%2FEOiMs3qOX8lssLIh%2BW%2FLZkGjywk%3D&reserved=0) and I found
> >>> that the following code also seems to work (although with a warning
> >>> message that I'm not sure I understand):
> >>>
> >>> library(sp)
> >>> demo(meuse, echo = FALSE, ask = FALSE)
> >>> library(sf)
> >>> #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 7.2.1; sf_use_s2() is TRUE
> >>> sf_proj_network(TRUE)
> >>> #> [1] "https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdn.proj.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rJdG7JgaY786%2BqOgeRTufTMdoGzmw97dvLb%2BUa6eYOc%3D&reserved=0"
> >>> st_as_sf(meuse) |> st_bbox()
> >>> #>   xmin   ymin   xmax   ymax
> >>> #> 178605 329714 181390 333611
> >>> meuse2 <- st_as_sf(meuse) |>
> >>>    st_transform(pipeline = "+proj=pipeline +step +proj=unitconvert
> >>> +xy_in=m +xy_out=km")
> >>> #> Warning in st_transform.sfc(st_geometry(x), crs, ...): pipeline not found in
> >>> #> PROJ-suggested candidate transformations
> >>> st_bbox(meuse2)
> >>> #>    xmin    ymin    xmax    ymax
> >>> #> 178.605 329.714 181.390 333.611
> >>>
> >>> I think this might be easier than manually adjusting the WKT
> >>> representation of the CRS, but I'm not sure that this is really a
> >>> recommended way to transform units since, for some reason, it does not
> >>> modify the CRS of the objects which makes any analysis very difficult:
> >>>
> >>> all.equal(st_crs(meuse), st_crs(meuse2))
> >>> #> [1] TRUE
> >>> library(mapview)
> >>> mapview(meuse) # seems right
> >>> mapview(meuse2) # completely off
> >>>
> >>> Andrea
> >>>
> >>> Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma
> >>> <edzer.pebesma at uni-muenster.de> ha scritto:
> >>>>
> >>>>
> >>>>
> >>>> On 31/01/2023 12:12, Andrea Gilardi wrote:
> >>>>>>    st_transform can do transformations and conversions between different CRSs, unit conversions is a special case of that.
> >>>>>
> >>>>> Dear all, I'm sorry if this is a trivial or stupid question but I was
> >>>>> wondering if you could provide an example of using st_transform to
> >>>>> apply a unit conversion transformation. For example, if I define
> >>>>> something like
> >>>>>
> >>>>> library(sf)
> >>>>> pt <- st_sfc(st_point(c(1500000, 5000000)), crs = 3003) # some place
> >>>>> in North Italy
> >>>>> st_crs(3003) # units are expressed in metres
> >>>>>
> >>>>> can I use st_transform to convert the unit measurement of pt from
> >>>>> metres to km and preserve that information in the CRS?
> >>>>
> >>>> It seems so, using proj4strings (not recommended, but simple):
> >>>>
> >>>> library(sp)
> >>>> demo(meuse, echo = FALSE, ask = FALSE)
> >>>> library(sf)
> >>>> # Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ 9.1.1; sf_use_s2() is TRUE
> >>>> st_as_sf(meuse) |> st_bbox()
> >>>> #   xmin   ymin   xmax   ymax
> >>>> # 178605 329714 181390 333611
> >>>> st_crs(meuse)$proj4string
> >>>> # [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889
> >>>> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"
> >>>> st_as_sf(meuse) |>
> >>>>     st_transform("+proj=sterea +lat_0=52.1561605555556
> >>>> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> >>>> +ellps=bessel +units=km +no_defs") |>
> >>>>     st_bbox()
> >>>> #    xmin    ymin    xmax    ymax
> >>>> # 178.605 329.714 181.390 333.611
> >>>>
> >>>> The better way would be to modify WKT representations of CRSs.
> >>>>
> >>>>>
> >>>>> Thanks
> >>>>> Andrea
> >>>>>
> >>>>>
> >>>>> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma
> >>>>> <edzer.pebesma at uni-muenster.de> ha scritto:
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> On 25/01/2023 18:42, Josiah Parry wrote:
> >>>>>>> I wonder if `units::set_units()` is a better fit for the job
> >>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-quantities.github.io%2Funits%2Farticles%2Fmeasurement_units_in_R.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yBdfWvCeDu9W2Y9yXC5uRKA0QnzVdoZVWOr9KXfjK50%3D&reserved=0
> >>>>>>
> >>>>>> It could definitely tell you which number to choose when going from,
> >>>>>> say, US feet to km. Coordinates in sf geometries are not stored as units
> >>>>>> objects, unit info is encoded in the CRS. st_transform can do
> >>>>>> transformations and conversions between different CRSs, unit conversions
> >>>>>> is a special case of that.
> >>>>>>
> >>>>>>>
> >>>>>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <sgutreuter at gmail.com>
> >>>>>>> wrote:
> >>>>>>>
> >>>>>>>> Is it safe to re-scale sf geometry coordinates from meters to
> >>>>>>>> kilometers using, for example:
> >>>>>>>>
> >>>>>>>> sfobj$geometry <- sfobj$geometry / 1000
> >>>>>>>>
> >>>>>>>> It seems to work, but I understand too little about spatial data to
> >>>>>>>> know whether that practice is actually safe.  I am working with spatial
> >>>>>>>> data in a continental-scale equidistant conic projection, and the units
> >>>>>>>> are meters.  It seems that kilometers would be better suited stochastic
> >>>>>>>> partial differential equation modeling on a finite-element mesh, but
> >>>>>>>> maybe that is a moot point.
> >>>>>>>>
> >>>>>>>> Any and all advice will be much appreciated.
> >>>>>>>>
> >>>>>>>> Thanks!
> >>>>>>>> --
> >>>>>>>> Steve Gutreuter
> >>>>>>>>
> >>>>>>>>            [[alternative HTML version deleted]]
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> R-sig-Geo mailing list
> >>>>>>>> R-sig-Geo at r-project.org
> >>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> >>>>>>>>
> >>>>>>>
> >>>>>>>         [[alternative HTML version deleted]]
> >>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> R-sig-Geo mailing list
> >>>>>>> R-sig-Geo at r-project.org
> >>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> >>>>>>
> >>>>>> --
> >>>>>> Edzer Pebesma
> >>>>>> Institute for Geoinformatics
> >>>>>> Heisenbergstrasse 2, 48151 Muenster, Germany
> >>>>>> Phone: +49 251 8333081
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> R-sig-Geo mailing list
> >>>>>> R-sig-Geo at r-project.org
> >>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> >>>>
> >>>> --
> >>>> Edzer Pebesma
> >>>> Institute for Geoinformatics
> >>>> Heisenbergstrasse 2, 48151 Muenster, Germany
> >>>> Phone: +49 251 8333081
> >>
> >> --
> >> Edzer Pebesma
> >> Institute for Geoinformatics
> >> Heisenbergstrasse 2, 48151 Muenster, Germany
> >> Phone: +49 251 8333081
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> >
>
> --
> Roger Bivand
> Emeritus Professor
> Department of Economics, Norwegian School of Economics,
> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
> e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @gutreuter @end|ng |rom gm@||@com  Tue Jan 31 20:00:59 2023
From: @gutreuter @end|ng |rom gm@||@com (Steve Gutreuter)
Date: Tue, 31 Jan 2023 14:00:59 -0500
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <CAP+kri-JLGw34qCh9p_S0KrsUSD1mJYaZi+KTjwkiD+3vOEsWQ@mail.gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
 <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
 <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com>
 <85a26e97-3418-ada8-a8a7-86ea5a88de70@reclus2.nhh.no>
 <CAP+kri-JLGw34qCh9p_S0KrsUSD1mJYaZi+KTjwkiD+3vOEsWQ@mail.gmail.com>
Message-ID: <c831b83627f4eaa26b4f5e4602262dd617c9fc39.camel@gmail.com>

The need to re-scale the measurement units of the coordinates may not
be commonplace, but it is also not unreasonable. So, given that R rgdal
is to be retired in 2023, what is the "correct" way to preserve the new
units and the datum?
Thanks to all,Steve

On Tue, 2023-01-31 at 18:36 +0100, Andrea Gilardi wrote:
> Thanks, Roger. That's not a common problem (at least for me), but
> itis typically useful to adjust the unit of measurement when I need
> tointegrate sf objects with other packages (e.g. spatstat) where
> thenumerical algorithm might benefit from rescaling.
> Andrea
> Il giorno mar 31 gen 2023 alle ore 15:50 Roger Bivand<
> Roger.Bivand at nhh.no> ha scritto:
> > On Tue, 31 Jan 2023, Andrea Gilardi wrote:
> > > Thanks again to both of you for the suggestion and the
> > > explanation.
> > 
> > Using:
> > meuse1 <- st_as_sf(meuse)meuse2 <- st_transform(meuse1,
> > sub("units=m", "units=km",   st_crs(meuse1)$proj4string))
> > gives
> > st_crs(meuse2)
> > Coordinate Reference System:   User input: +proj=sterea
> > +lat_0=52.1561605555556 +lon_0=5.38763888888889+k=0.9999079
> > +x_0=155000 +y_0=463000 +ellps=bessel +units=km
> > +no_defs   wkt:PROJCRS["unknown",     BASEGEOGCRS["unknown",       
> >   DATUM["Unknown based on Bessel 1841
> > ellipsoid",             ELLIPSOID["Bessel
> > 1841",6377397.155,299.1528128,                 LENGTHUNIT["metre",1
> > ,                     ID["EPSG",9001]]]],         PRIMEM["Greenwich
> > ",0,             ANGLEUNIT["degree",0.0174532925199433],           
> >   ID["EPSG",8901]]],     CONVERSION["unknown",         METHOD["Obli
> > que
> > Stereographic",             ID["EPSG",9809]],         PARAMETER["La
> > titude of natural
> > origin",52.1561605555556,             ANGLEUNIT["degree",0.01745329
> > 25199433],             ID["EPSG",8801]],         PARAMETER["Longitu
> > de of natural
> > origin",5.38763888888889,             ANGLEUNIT["degree",0.01745329
> > 25199433],             ID["EPSG",8802]],         PARAMETER["Scale
> > factor at natural
> > origin",0.9999079,             SCALEUNIT["unity",1],             ID
> > ["EPSG",8805]],         PARAMETER["False
> > easting",155,             LENGTHUNIT["kilometre",1000],            
> >  ID["EPSG",8806]],         PARAMETER["False
> > northing",463,             LENGTHUNIT["kilometre",1000],           
> >   ID["EPSG",8807]]],     CS[Cartesian,2],         AXIS["(E)",east, 
> >             ORDER[1],             LENGTHUNIT["kilometre",1000,     
> >             ID["EPSG",9036]]],         AXIS["(N)",north,           
> >   ORDER[2],             LENGTHUNIT["kilometre",1000,               
> >   ID["EPSG",9036]]]]
> > which does preserve the units, but does not preserve the datum. So
> > may besuitable when the output is never sent to others.
> > Roger
> > > Kind regardsAndrea
> > > Il giorno mar 31 gen 2023 alle ore 15:28 Edzer Pebesma<
> > > edzer.pebesma at uni-muenster.de> ha scritto:
> > > > Yes, the pipeline approach bypasses GDAL, and doesn't result in
> > > > anobject with an appropriate CRS as a consequence.
> > > > On 31/01/2023 14:47, Andrea Gilardi wrote:
> > > > > Thank you very much for your example! I briefly checked the
> > > > > examplesreported in ?st_transform and the docs at the PROJ
> > > > > website around"Unit conversion"(
> > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fproj.org%2Foperations%2Fconversions%2Funitconvert.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=fVmKdcLGpNo7%2F%2Bn%2FEOiMs3qOX8lssLIh%2BW%2FLZkGjywk%3D&reserved=0
> > > > > ) and I foundthat the following code also seems to work
> > > > > (although with a warningmessage that I'm not sure I
> > > > > understand):
> > > > > library(sp)demo(meuse, echo = FALSE, ask =
> > > > > FALSE)library(sf)#> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ
> > > > > 7.2.1; sf_use_s2() is TRUEsf_proj_network(TRUE)#> [1] "
> > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdn.proj.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rJdG7JgaY786%2BqOgeRTufTMdoGzmw97dvLb%2BUa6eYOc%3D&reserved=0"st_as_sf(meuse)
> > > > > |> st_bbox()#>   xmin   ymin   xmax   ymax#> 178605 329714
> > > > > 181390 333611meuse2 <- st_as_sf(meuse)
> > > > > |>   st_transform(pipeline = "+proj=pipeline +step
> > > > > +proj=unitconvert+xy_in=m +xy_out=km")#> Warning in
> > > > > st_transform.sfc(st_geometry(x), crs, ...): pipeline not
> > > > > found in#> PROJ-suggested candidate
> > > > > transformationsst_bbox(meuse2)#>    xmin    ymin    xmax    y
> > > > > max#> 178.605 329.714 181.390 333.611
> > > > > I think this might be easier than manually adjusting the
> > > > > WKTrepresentation of the CRS, but I'm not sure that this is
> > > > > really arecommended way to transform units since, for some
> > > > > reason, it does notmodify the CRS of the objects which makes
> > > > > any analysis very difficult:
> > > > > all.equal(st_crs(meuse), st_crs(meuse2))#> [1]
> > > > > TRUElibrary(mapview)mapview(meuse) # seems
> > > > > rightmapview(meuse2) # completely off
> > > > > Andrea
> > > > > Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma<
> > > > > edzer.pebesma at uni-muenster.de> ha scritto:
> > > > > > 
> > > > > > On 31/01/2023 12:12, Andrea Gilardi wrote:
> > > > > > > >    st_transform can do transformations and conversions
> > > > > > > > between different CRSs, unit conversions is a special
> > > > > > > > case of that.
> > > > > > > 
> > > > > > > Dear all, I'm sorry if this is a trivial or stupid
> > > > > > > question but I waswondering if you could provide an
> > > > > > > example of using st_transform toapply a unit conversion
> > > > > > > transformation. For example, if I definesomething like
> > > > > > > library(sf)pt <- st_sfc(st_point(c(1500000, 5000000)),
> > > > > > > crs = 3003) # some placein North Italyst_crs(3003) #
> > > > > > > units are expressed in metres
> > > > > > > can I use st_transform to convert the unit measurement of
> > > > > > > pt frommetres to km and preserve that information in the
> > > > > > > CRS?
> > > > > > 
> > > > > > It seems so, using proj4strings (not recommended, but
> > > > > > simple):
> > > > > > library(sp)demo(meuse, echo = FALSE, ask =
> > > > > > FALSE)library(sf)# Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ
> > > > > > 9.1.1; sf_use_s2() is TRUEst_as_sf(meuse) |>
> > > > > > st_bbox()#   xmin   ymin   xmax   ymax# 178605 329714
> > > > > > 181390 333611st_crs(meuse)$proj4string# [1] "+proj=sterea
> > > > > > +lat_0=52.1561605555556 +lon_0=5.38763888888889+k=0.9999079
> > > > > > +x_0=155000 +y_0=463000 +ellps=bessel +units=m
> > > > > > +no_defs"st_as_sf(meuse) |>    st_transform("+proj=sterea
> > > > > > +lat_0=52.1561605555556+lon_0=5.38763888888889 +k=0.9999079
> > > > > > +x_0=155000 +y_0=463000+ellps=bessel +units=km +no_defs")
> > > > > > |>    st_bbox()#    xmin    ymin    xmax    ymax# 178.605
> > > > > > 329.714 181.390 333.611
> > > > > > The better way would be to modify WKT representations of
> > > > > > CRSs.
> > > > > > > ThanksAndrea
> > > > > > > 
> > > > > > > Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma<
> > > > > > > edzer.pebesma at uni-muenster.de> ha scritto:
> > > > > > > > 
> > > > > > > > On 25/01/2023 18:42, Josiah Parry wrote:
> > > > > > > > > I wonder if `units::set_units()` is a better fit for
> > > > > > > > > the job
> > > > > > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-quantities.github.io%2Funits%2Farticles%2Fmeasurement_units_in_R.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yBdfWvCeDu9W2Y9yXC5uRKA0QnzVdoZVWOr9KXfjK50%3D&reserved=0
> > > > > > > > 
> > > > > > > > It could definitely tell you which number to choose
> > > > > > > > when going from,say, US feet to km. Coordinates in sf
> > > > > > > > geometries are not stored as unitsobjects, unit info is
> > > > > > > > encoded in the CRS. st_transform can dotransformations
> > > > > > > > and conversions between different CRSs, unit
> > > > > > > > conversionsis a special case of that.
> > > > > > > > > On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <
> > > > > > > > > sgutreuter at gmail.com>wrote:
> > > > > > > > > > Is it safe to re-scale sf geometry coordinates from
> > > > > > > > > > meters tokilometers using, for example:
> > > > > > > > > > sfobj$geometry <- sfobj$geometry / 1000
> > > > > > > > > > It seems to work, but I understand too little about
> > > > > > > > > > spatial data toknow whether that practice is
> > > > > > > > > > actually safe.  I am working with spatialdata in a
> > > > > > > > > > continental-scale equidistant conic projection, and
> > > > > > > > > > the unitsare meters.  It seems that kilometers
> > > > > > > > > > would be better suited stochasticpartial
> > > > > > > > > > differential equation modeling on a finite-element
> > > > > > > > > > mesh, butmaybe that is a moot point.
> > > > > > > > > > Any and all advice will be much appreciated.
> > > > > > > > > > Thanks!--Steve Gutreuter
> > > > > > > > > >            [[alternative HTML version deleted]]
> > > > > > > > > > _______________________________________________R-
> > > > > > > > > > sig-Geo mailing listR-sig-Geo at r-project.org
> > > > > > > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> > > > > > > > > > 
> > > > > > > > > 
> > > > > > > > >         [[alternative HTML version deleted]]
> > > > > > > > > _______________________________________________R-sig-
> > > > > > > > > Geo mailing listR-sig-Geo at r-project.org
> > > > > > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> > > > > > > > 
> > > > > > > > --Edzer PebesmaInstitute for
> > > > > > > > GeoinformaticsHeisenbergstrasse 2, 48151 Muenster,
> > > > > > > > GermanyPhone: +49 251 8333081
> > > > > > > > _______________________________________________R-sig-
> > > > > > > > Geo mailing listR-sig-Geo at r-project.org
> > > > > > > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> > > > > > 
> > > > > > --Edzer PebesmaInstitute for
> > > > > > GeoinformaticsHeisenbergstrasse 2, 48151 Muenster,
> > > > > > GermanyPhone: +49 251 8333081
> > > > 
> > > > --Edzer PebesmaInstitute for GeoinformaticsHeisenbergstrasse 2,
> > > > 48151 Muenster, GermanyPhone: +49 251 8333081
> > > 
> > > _______________________________________________R-sig-Geo mailing 
> > > listR-sig-Geo at r-project.org
> > > https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
> > > 
> > 
> > --Roger BivandEmeritus ProfessorDepartment of Economics, Norwegian
> > School of Economics,Postboks 3490 Ytre Sandviken, 5045 Bergen,
> > Norway.e-mail: Roger.Bivand at nhh.no
> > https://orcid.org/0000-0003-2392-6140
> > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> 
> _______________________________________________R-sig-Geo mailing 
> listR-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jan 31 20:37:54 2023
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 31 Jan 2023 20:37:54 +0100 (CET)
Subject: [R-sig-Geo] Re-scale units of coordinates in sf geometry?
In-Reply-To: <c831b83627f4eaa26b4f5e4602262dd617c9fc39.camel@gmail.com>
References: <f21f4f5d169b4a298639f827d460a4810cfcaa97.camel@gmail.com>
 <CAL3ufULz9jVpyJppvRpgd1P2D4ZaDOvm6HfE7ZDSN=W-w457wA@mail.gmail.com>
 <6aa381cf-01f6-621e-1587-b5261898ad34@uni-muenster.de>
 <CAP+kri-J1-rq3-NCJtY-=N5FwrQiJd1yJj4sxEaTFwib3QZRxA@mail.gmail.com>
 <455df74b-fd31-a96d-7202-e9dc0a0070aa@uni-muenster.de>
 <CAP+kri_F5W8oTpvEAJaO3ey1jzSGsFbT2JoqRUF5EzS8aFG=BA@mail.gmail.com>
 <e1c5057a-ee67-d08a-d198-a5bd2eb2e7dd@uni-muenster.de>
 <CAP+kri9sq6N2fmA9=HZEyUCMh-f3CY-awL7BwEy9Bb85niz-9A@mail.gmail.com> 
 <85a26e97-3418-ada8-a8a7-86ea5a88de70@reclus2.nhh.no>
 <CAP+kri-JLGw34qCh9p_S0KrsUSD1mJYaZi+KTjwkiD+3vOEsWQ@mail.gmail.com>
 <c831b83627f4eaa26b4f5e4602262dd617c9fc39.camel@gmail.com>
Message-ID: <e7b18e93-a177-5d39-8d98-b42142d4957@reclus2.nhh.no>

On Tue, 31 Jan 2023, Steve Gutreuter wrote:

> The need to re-scale the measurement units of the coordinates may not
> be commonplace, but it is also not unreasonable. So, given that R rgdal
> is to be retired in 2023, what is the "correct" way to preserve the new
> units and the datum?

Sorry, there is no easy way both to deviate from an authorised CRS, such 
as "EPSG:28992", and still be conformant, unless the authoriser has 
covered that case. Only three +datum= values still exist in PROJ strings 
for PROJ > 5, WGS84, NAD83 and NAD27. There are no +towgs84= values at 
all. All the values are stored in proj.db, as are candidate transformation 
pipelines. The same applies to current rgdal, the underlying PROJ and GDAL 
code is the same in sf, terra and rgdal.

This operation is a conversion rather than a transformation, and is 
lossless, but it isn't possible to approach through the legacy PROJ 
string. It might be possible to edit a PROJJSON representation of 
EPSG:28992 to convert the units and the false easting and northing values, 
but the output will not be EPSG:28992, so the "id" component would have to 
be deleted, see projinfo -o PROJJSON "EPSG:28992" if you also have PROJ 
applications installed. The idea would be to create a valid PROJJSON 
string and use it as the crs= argument to sf::st_transform().

For too much detail on CRS etc., possibly look at 
https://www.youtube.com/watch?v=o0yMeb_UdE4&list=PLzREt6r1NenmWEidssmLm-VO_YmAh4pq9&index=2 
or just the slides 
https://rsbivand.github.io/csds_jan23/csds_crs_workshop_230119.html, but 
note that the presented version in that talk is in error at 74:27 as 
described in 
https://rsbivand.github.io/csds_jan23/csds_crs_workshop_230131.html - the 
latter should definitely be preferred.

Roger

> Thanks to all,Steve
>
> On Tue, 2023-01-31 at 18:36 +0100, Andrea Gilardi wrote:
>> Thanks, Roger. That's not a common problem (at least for me), but
>> itis typically useful to adjust the unit of measurement when I need
>> tointegrate sf objects with other packages (e.g. spatstat) where
>> thenumerical algorithm might benefit from rescaling.
>> Andrea
>> Il giorno mar 31 gen 2023 alle ore 15:50 Roger Bivand<
>> Roger.Bivand at nhh.no> ha scritto:
>>> On Tue, 31 Jan 2023, Andrea Gilardi wrote:
>>>> Thanks again to both of you for the suggestion and the
>>>> explanation.
>>>
>>> Using:
>>> meuse1 <- st_as_sf(meuse)meuse2 <- st_transform(meuse1,
>>> sub("units=m", "units=km",   st_crs(meuse1)$proj4string))
>>> gives
>>> st_crs(meuse2)
>>> Coordinate Reference System:   User input: +proj=sterea
>>> +lat_0=52.1561605555556 +lon_0=5.38763888888889+k=0.9999079
>>> +x_0=155000 +y_0=463000 +ellps=bessel +units=km
>>> +no_defs   wkt:PROJCRS["unknown",     BASEGEOGCRS["unknown",
>>>   DATUM["Unknown based on Bessel 1841
>>> ellipsoid",             ELLIPSOID["Bessel
>>> 1841",6377397.155,299.1528128,                 LENGTHUNIT["metre",1
>>> ,                     ID["EPSG",9001]]]],         PRIMEM["Greenwich
>>> ",0,             ANGLEUNIT["degree",0.0174532925199433],
>>>   ID["EPSG",8901]]],     CONVERSION["unknown",         METHOD["Obli
>>> que
>>> Stereographic",             ID["EPSG",9809]],         PARAMETER["La
>>> titude of natural
>>> origin",52.1561605555556,             ANGLEUNIT["degree",0.01745329
>>> 25199433],             ID["EPSG",8801]],         PARAMETER["Longitu
>>> de of natural
>>> origin",5.38763888888889,             ANGLEUNIT["degree",0.01745329
>>> 25199433],             ID["EPSG",8802]],         PARAMETER["Scale
>>> factor at natural
>>> origin",0.9999079,             SCALEUNIT["unity",1],             ID
>>> ["EPSG",8805]],         PARAMETER["False
>>> easting",155,             LENGTHUNIT["kilometre",1000],
>>>  ID["EPSG",8806]],         PARAMETER["False
>>> northing",463,             LENGTHUNIT["kilometre",1000],
>>>   ID["EPSG",8807]]],     CS[Cartesian,2],         AXIS["(E)",east,
>>>             ORDER[1],             LENGTHUNIT["kilometre",1000,
>>>             ID["EPSG",9036]]],         AXIS["(N)",north,
>>>   ORDER[2],             LENGTHUNIT["kilometre",1000,
>>>   ID["EPSG",9036]]]]
>>> which does preserve the units, but does not preserve the datum. So
>>> may besuitable when the output is never sent to others.
>>> Roger
>>>> Kind regardsAndrea
>>>> Il giorno mar 31 gen 2023 alle ore 15:28 Edzer Pebesma<
>>>> edzer.pebesma at uni-muenster.de> ha scritto:
>>>>> Yes, the pipeline approach bypasses GDAL, and doesn't result in
>>>>> anobject with an appropriate CRS as a consequence.
>>>>> On 31/01/2023 14:47, Andrea Gilardi wrote:
>>>>>> Thank you very much for your example! I briefly checked the
>>>>>> examplesreported in ?st_transform and the docs at the PROJ
>>>>>> website around"Unit conversion"(
>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fproj.org%2Foperations%2Fconversions%2Funitconvert.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=fVmKdcLGpNo7%2F%2Bn%2FEOiMs3qOX8lssLIh%2BW%2FLZkGjywk%3D&reserved=0
>>>>>> ) and I foundthat the following code also seems to work
>>>>>> (although with a warningmessage that I'm not sure I
>>>>>> understand):
>>>>>> library(sp)demo(meuse, echo = FALSE, ask =
>>>>>> FALSE)library(sf)#> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ
>>>>>> 7.2.1; sf_use_s2() is TRUEsf_proj_network(TRUE)#> [1] "
>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdn.proj.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rJdG7JgaY786%2BqOgeRTufTMdoGzmw97dvLb%2BUa6eYOc%3D&reserved=0"st_as_sf(meuse)
>>>>>> |> st_bbox()#>   xmin   ymin   xmax   ymax#> 178605 329714
>>>>>> 181390 333611meuse2 <- st_as_sf(meuse)
>>>>>> |>   st_transform(pipeline = "+proj=pipeline +step
>>>>>> +proj=unitconvert+xy_in=m +xy_out=km")#> Warning in
>>>>>> st_transform.sfc(st_geometry(x), crs, ...): pipeline not
>>>>>> found in#> PROJ-suggested candidate
>>>>>> transformationsst_bbox(meuse2)#>    xmin    ymin    xmax    y
>>>>>> max#> 178.605 329.714 181.390 333.611
>>>>>> I think this might be easier than manually adjusting the
>>>>>> WKTrepresentation of the CRS, but I'm not sure that this is
>>>>>> really arecommended way to transform units since, for some
>>>>>> reason, it does notmodify the CRS of the objects which makes
>>>>>> any analysis very difficult:
>>>>>> all.equal(st_crs(meuse), st_crs(meuse2))#> [1]
>>>>>> TRUElibrary(mapview)mapview(meuse) # seems
>>>>>> rightmapview(meuse2) # completely off
>>>>>> Andrea
>>>>>> Il giorno mar 31 gen 2023 alle ore 12:33 Edzer Pebesma<
>>>>>> edzer.pebesma at uni-muenster.de> ha scritto:
>>>>>>>
>>>>>>> On 31/01/2023 12:12, Andrea Gilardi wrote:
>>>>>>>>>    st_transform can do transformations and conversions
>>>>>>>>> between different CRSs, unit conversions is a special
>>>>>>>>> case of that.
>>>>>>>>
>>>>>>>> Dear all, I'm sorry if this is a trivial or stupid
>>>>>>>> question but I waswondering if you could provide an
>>>>>>>> example of using st_transform toapply a unit conversion
>>>>>>>> transformation. For example, if I definesomething like
>>>>>>>> library(sf)pt <- st_sfc(st_point(c(1500000, 5000000)),
>>>>>>>> crs = 3003) # some placein North Italyst_crs(3003) #
>>>>>>>> units are expressed in metres
>>>>>>>> can I use st_transform to convert the unit measurement of
>>>>>>>> pt frommetres to km and preserve that information in the
>>>>>>>> CRS?
>>>>>>>
>>>>>>> It seems so, using proj4strings (not recommended, but
>>>>>>> simple):
>>>>>>> library(sp)demo(meuse, echo = FALSE, ask =
>>>>>>> FALSE)library(sf)# Linking to GEOS 3.11.1, GDAL 3.6.2, PROJ
>>>>>>> 9.1.1; sf_use_s2() is TRUEst_as_sf(meuse) |>
>>>>>>> st_bbox()#   xmin   ymin   xmax   ymax# 178605 329714
>>>>>>> 181390 333611st_crs(meuse)$proj4string# [1] "+proj=sterea
>>>>>>> +lat_0=52.1561605555556 +lon_0=5.38763888888889+k=0.9999079
>>>>>>> +x_0=155000 +y_0=463000 +ellps=bessel +units=m
>>>>>>> +no_defs"st_as_sf(meuse) |>    st_transform("+proj=sterea
>>>>>>> +lat_0=52.1561605555556+lon_0=5.38763888888889 +k=0.9999079
>>>>>>> +x_0=155000 +y_0=463000+ellps=bessel +units=km +no_defs")
>>>>>>> |>    st_bbox()#    xmin    ymin    xmax    ymax# 178.605
>>>>>>> 329.714 181.390 333.611
>>>>>>> The better way would be to modify WKT representations of
>>>>>>> CRSs.
>>>>>>>> ThanksAndrea
>>>>>>>>
>>>>>>>> Il giorno mer 25 gen 2023 alle ore 18:58 Edzer Pebesma<
>>>>>>>> edzer.pebesma at uni-muenster.de> ha scritto:
>>>>>>>>>
>>>>>>>>> On 25/01/2023 18:42, Josiah Parry wrote:
>>>>>>>>>> I wonder if `units::set_units()` is a better fit for
>>>>>>>>>> the job
>>>>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-quantities.github.io%2Funits%2Farticles%2Fmeasurement_units_in_R.html&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yBdfWvCeDu9W2Y9yXC5uRKA0QnzVdoZVWOr9KXfjK50%3D&reserved=0
>>>>>>>>>
>>>>>>>>> It could definitely tell you which number to choose
>>>>>>>>> when going from,say, US feet to km. Coordinates in sf
>>>>>>>>> geometries are not stored as unitsobjects, unit info is
>>>>>>>>> encoded in the CRS. st_transform can dotransformations
>>>>>>>>> and conversions between different CRSs, unit
>>>>>>>>> conversionsis a special case of that.
>>>>>>>>>> On Wed, Jan 25, 2023 at 12:37 PM Steve Gutreuter <
>>>>>>>>>> sgutreuter at gmail.com>wrote:
>>>>>>>>>>> Is it safe to re-scale sf geometry coordinates from
>>>>>>>>>>> meters tokilometers using, for example:
>>>>>>>>>>> sfobj$geometry <- sfobj$geometry / 1000
>>>>>>>>>>> It seems to work, but I understand too little about
>>>>>>>>>>> spatial data toknow whether that practice is
>>>>>>>>>>> actually safe.  I am working with spatialdata in a
>>>>>>>>>>> continental-scale equidistant conic projection, and
>>>>>>>>>>> the unitsare meters.  It seems that kilometers
>>>>>>>>>>> would be better suited stochasticpartial
>>>>>>>>>>> differential equation modeling on a finite-element
>>>>>>>>>>> mesh, butmaybe that is a moot point.
>>>>>>>>>>> Any and all advice will be much appreciated.
>>>>>>>>>>> Thanks!--Steve Gutreuter
>>>>>>>>>>>            [[alternative HTML version deleted]]
>>>>>>>>>>> _______________________________________________R-
>>>>>>>>>>> sig-Geo mailing listR-sig-Geo at r-project.org
>>>>>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>         [[alternative HTML version deleted]]
>>>>>>>>>> _______________________________________________R-sig-
>>>>>>>>>> Geo mailing listR-sig-Geo at r-project.org
>>>>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>>>>>>
>>>>>>>>> --Edzer PebesmaInstitute for
>>>>>>>>> GeoinformaticsHeisenbergstrasse 2, 48151 Muenster,
>>>>>>>>> GermanyPhone: +49 251 8333081
>>>>>>>>> _______________________________________________R-sig-
>>>>>>>>> Geo mailing listR-sig-Geo at r-project.org
>>>>>>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>>>>
>>>>>>> --Edzer PebesmaInstitute for
>>>>>>> GeoinformaticsHeisenbergstrasse 2, 48151 Muenster,
>>>>>>> GermanyPhone: +49 251 8333081
>>>>>
>>>>> --Edzer PebesmaInstitute for GeoinformaticsHeisenbergstrasse 2,
>>>>> 48151 Muenster, GermanyPhone: +49 251 8333081
>>>>
>>>> _______________________________________________R-sig-Geo mailing
>>>> listR-sig-Geo at r-project.org
>>>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7C9087c8564fa9442f824e08db0398f02f%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638107727639842599%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=krfLyCtoYG5Iw%2FnktA5LqG%2BfNIcaNXIWmWEDzkUfpK0%3D&reserved=0
>>>>
>>>
>>> --Roger BivandEmeritus ProfessorDepartment of Economics, Norwegian
>>> School of Economics,Postboks 3490 Ytre Sandviken, 5045 Bergen,
>>> Norway.e-mail: Roger.Bivand at nhh.no
>>> https://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>> _______________________________________________R-sig-Geo mailing
>> listR-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


