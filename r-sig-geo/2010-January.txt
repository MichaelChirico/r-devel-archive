From Roger.Bivand at nhh.no  Fri Jan  1 19:54:06 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 1 Jan 2010 19:54:06 +0100 (CET)
Subject: [R-sig-Geo] POSIX* objects and writeOGR()
In-Reply-To: <4B3C5FE1.5090507@gmail.com>
References: <4B3BB4EC.6060203@gmail.com>
	<522664f80912301230m4616ebd4y2e835e0cfc20da9a@mail.gmail.com>
	<4B3C5FE1.5090507@gmail.com>
Message-ID: <alpine.LRH.2.00.1001011941520.6681@reclus.nhh.no>

On Thu, 31 Dec 2009, Agustin Lobo wrote:

> Thanks!
>
> I see that creating a temporary SPDF with that variable casted
> as character is the only way to run writeOGR().
>
> Would it be possible adding
> an option i.e. POSIXtoCHAR=T to writeOGR() so that such a conversion is
> automated?

POSIXt *is* converted to character by default, and has been since the 
writeOGR() function was added to the package. The issues with time and 
data handling were in readOGR(), where these are now converted to String 
before reading.

If the identification of POSIXt columns hasn't worked for you with 
writeOGR(), please provide a reproducible example and I'll try to fix it, 
but I think that this "just works".

Best wishes,

Roger

>
> Agus
>
> Michael Sumner wrote:
>> POSIXlt stores the date-times as a list of vectors decomposed into the
>> (still numeric) component parts ("sec", "min", "hour", "mday", "mon",
>> "year", "wday", "yday", "isdst") so that cannot be stored as a single
>> column in the data frame - you would need 9 columns.
>> 
>> 
>> Compare these to see the underlying structure:
>> 
>> tm <- Sys.time()
>> ## POSIXct
>> unclass(tm)
>> ## POSIXlt
>> unclass(as.POSIXlt(tm))
>> 
>> You can just cast to character, directly or with format - see
>> ?strptime for the full set of format tokens available. For example:
>>
>>  as.character(tm)
>> ##[1] "2009-12-31 07:28:01"
>> format(tm, "%Y/%b/%a %H:%M:%S")
>> ##[1] "2009/Dec/Thu 07:28:01"
>> 
>> Hope that helps.
>> 
>> Regards, Mike.
>> 
>> 
>> On Thu, Dec 31, 2009 at 7:15 AM, Agustin Lobo <alobolistas at gmail.com> 
>> wrote:
>>> This might be a bit off-topic.
>>> I have to export as shape an Sp.Poly.DF in which
>>> one of the variables records date and time as POSIXtc. As
>>> writeOGR() complains about the POSIXct variable, I'm
>>> trying to convert to POSIXlt, which I think that will be
>>> accepted (another alternative would be coverting to an
>>> string char, but prefer to keep the SPDF object with
>>> a correct class definition for that variable).
>>> Let's call patata the table of the SPDF.
>>> 
>>>> class(patata$Tima)
>>> [1] "POSIXt"  "POSIXct"
>>> 
>>>> patata$Tima[1]
>>> [1] "2009-09-26 09:57:24 CEST"
>>> 
>>>> as.POSIXlt(patata$Tima[1])
>>> [1] "2009-09-26 09:57:24 CEST"
>>> 
>>>> class(as.POSIXlt(patata$Tima[1]))
>>> [1] "POSIXt"  "POSIXlt"
>>> 
>>> So I was happy, but:
>>> 
>>>> patata$Tima <- as.POSIXlt(patata$Tima)
>>> Error in `$<-.data.frame`(`*tmp*`, "Tima", value = list(sec = c(24, 33,  :
>>>  replacement has 9 rows, data has 44
>>> Calls: $<- -> $<-.data.frame
>>> 
>>> 
>>> Is there any way I can put the POSIXlt object in the table (patata) of the
>>> SPDF object?
>>> 
>>> Thanks!
>>> 
>>> Agus
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From nsicad at gmail.com  Sat Jan  2 03:14:41 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Sat, 2 Jan 2010 09:14:41 +0700
Subject: [R-sig-Geo] How to implement Org2Org "-dcso NameField=..." in rgdal,
	writeOGR() 	KML
Message-ID: <f7bd71731001011814y2eb30661td9ee89b1aeb39922@mail.gmail.com>

Hi,

I would like to minic this Org2Ogr command (below) to write shapefile
to KML. How do I do this in rgdal,  " -dcso NameField=Name_2"

Org2Ogr command:
~~~~~~~~~
Org2Org -f KML NZL_3.kml NZL_adm3.shp -dcso NameField=Name_2

~~~~~~~~~

Rgdal

~~~~~~~~~~
library(rgdal)

mymap<-readOGR("NZL_adm3.shp", layer="NZL_adm3")

writeOGR(mymap,"NZL_3.kml", driver="KML", layer="NZL_adm3", "something
should be here")

~~~~~~~~~~

Thanks in advance.

Noli


From nsicad at gmail.com  Sat Jan  2 11:04:50 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Sat, 2 Jan 2010 17:04:50 +0700
Subject: [R-sig-Geo] In is.na(e2) : is.na() applied to non-(list or vector)
	of type 'NULL' in Shapefile and CSV Data
Message-ID: <f7bd71731001020204h16007113p3d544c48e27ea65b@mail.gmail.com>

Hi,

I am trying to join harvest_cut.csv (csv table) from LP linear
programming run to shapefile (*.dbf). I got some problem (below).

This is what I am trying to do
1.Read area from the shapefile as input to LP model. Data (Croptype, Age, Area)
2.Get result / output harvest_cut.csv
3.Link back my LP result to shapefile
4. Use spplot to display results

Problem in #3, I need to put a CROP_ID in my harvest_cut.csv before I
merge the harvest_cut data to Forest Stand shapefile.

Problem here:

for (i in 1:length(harvest.dat$Period)){
if ((forest.dat$CROPTYPE == harvest.dat$CROPTYPE) (forest.dat$AGECLASS
== harvest.dat$Cut_Age)) {harvest.dat$CROP_ID <- forest.dat$CROP_ID}
else { }
}

Any idea how to fix this? Any possible solution if this is not applicable

Thanks in advance

~~~~~~~~~~~~~~
# Reading and writing dbf from Shapefile
#JOIN BY ATTRIBUTES


getwd()
setwd('C:\\Down2\\R_forestmgt\\Carbon\\')

library(maptools)
library(sp)
library(foreign)

forest <- readShapePoly('C:\\Down2\\R_forestmgt\\Carbon\\ForestCarbonStand')

slot(forest,"data")

forest.dat <- slot(forest, "data")
forest.dat

harvest.dat <- read.csv('C:\\Down2\\R_forestmgt\\Carbon\\forest_cut.csv')

harvest.dat


names(harvest.dat) = c("Period", "CROP_ID", "Croptype", "Cut_Age", "Area_Cut")

# Problem here

for (i in 1:length(harvest.dat$Period)){
if ((forest.dat$CROPTYPE == harvest.dat$CROPTYPE) (forest.dat$AGECLASS
== harvest.dat$Cut_Age)) {harvest.dat$CROP_ID <- forest.dat$CROP_ID}
else { }
}

....

~~~~~~~~~~~~~
Error
...
233     15      15      OTO      31   56.720757
234     15      15      OTO      32 1360.429308
235     16      16      OTO      31 2025.898274
Error: attempt to apply non-function
In addition: Warning message:
In is.na(e2) : is.na() applied to non-(list or vector) of type 'NULL'
Execution halted
>Exit code: 1    Time: 3.692


From Roger.Bivand at nhh.no  Sun Jan  3 16:20:37 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 3 Jan 2010 16:20:37 +0100
Subject: [R-sig-Geo] How to implement Org2Org "-dcso NameField=..." in
	rgdal, writeOGR() KML
References: <f7bd71731001011814y2eb30661td9ee89b1aeb39922@mail.gmail.com>
Message-ID: <AD51AB79BC327C40AB2C7EB75D57A3C4051304@TOLAR.valuta.nhh.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100103/df100e90/attachment.pl>

From andy.south at cefas.co.uk  Mon Jan  4 13:04:09 2010
From: andy.south at cefas.co.uk (Andy South (Cefas))
Date: Mon, 4 Jan 2010 12:04:09 -0000
Subject: [R-sig-Geo] color category SpatialGridDataFrame and rworldmap
In-Reply-To: <mailman.9.1262343603.10993.r-sig-geo@stat.math.ethz.ch>
Message-ID: <04A370231C10664C88B28D1EF74F487901493710@LOWEXPRESS.corp.cefas.co.uk>


Dear Patrick & Renaud,

Categorical maps are one of the issues we have looked at in a new
package 'rworldmap' that we've been developing. Coincidentally I
submitted the first version to Cran for consideration yesterday.

The package and source can currently be downloaded from : 
http://code.google.com/p/rworld/downloads/list

With a SpatialGridDataFrame containing categorical data, default
plotting should be as easy as :

library(rworldmap)
mapGriddedData(sGDF, catMethod='categorical')

#colours can be changed by e.g.
mapGriddedData(sGDF, catMethod='categorical',
colourPalette=c('red','white','blue'))
#or
mapGriddedData(sGDF, catMethod='categorical',
colourPalette=c("#E5F5E0","#A1D99B","#31A354"))

A default legend is added and there are options for modifying it.

The package concentrates on displaying global data, either gridded or
referenced by country. 

I'll be interested to hear any feedback that you or others have,

This builds particularly on the packages sp, maptools and fields, so
thanks go out to all those that have contributed to those packages. 

Happy new year,
Andy

Dr Andy South 
Leader Spatial Information, Fisheries 
Cefas, Pakefield Road, Lowestoft , Suffolk, NR33 0HT, UK 

Tel: +44 (0)1502 524213
Fax: +44 (0)1502 513865 

www.cefas.co.uk 



Message: 1
Date: Thu, 31 Dec 2009 12:07:03 +0100
From: Renaud Lancelot <renaud.lancelot at cirad.fr>
Subject: Re: [R-sig-Geo] color category SpatialGridDataFrame
	SpatialPolygonsDataFrame Corine Land Cover Global Land Cover
2000
To: patrick.giraudoux at univ-fcomte.fr
Cc: r-sig-geo at stat.math.ethz.ch
Message-ID: <4B3C85D7.7050600 at cirad.fr>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Dear Patrick,

I recently met this issue. I finally used image() on the
SpatialGridDataFrame, defining the appropriate colors using the col
argument (?tonnant, non ;-)). I have defined the legend using legend(),
and I used split.screen() to arrange the plots. If you wish, I can send
you the whole stuff (data and code) in a private message (huge
datasets).

Renaud

Patrick Giraudoux a ?crit :
> Dear all,
> 
> I am wondering what is the safest way to handle colors when 
> SpatialGridDataFrame data are categories. spplot() or image() are 
> extremely convenient when attributes are continuous variables or so 
> (eg altitude, rainfall, etc...), but the colorRamp() system and the 
> col.regions, col arguments, though extremely powerful in other cases, 
> is not really adapted to category data such as Corine LandCover or 
> Global Land Cover 2000 codes. Thus to link pixels to the right color 
> may be quite tedious (however I may have missed something...).
> 
> One option I though about was to change raster into shapefile (or 
> SpatialGrid into SpatialPolygons objects), but again the straight way 
> to get right colors is not evident.
> 
> Any idea ?
> 
> Patrick
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

--
Renaud Lancelot
EDEN Project, coordinator
http://www.eden-fp6project.net/
<< EDEN International Conference, Montpellier,  10-12 May 2010 >>
<<   http://international-conference2010.eden-fp6project.net/  >>

UMR CIRAD-INRA "Contr?le des maladies animales exotiques et ?mergentes"
Joint research unit "Control of emerging and exotic animal diseases"

CIRAD, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier
http://www.cirad.fr  http://bluetongue.cirad.fr/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 95 Secr. +33 4 67 59 37
37  - Cell. +33 6 77 52 08 69




***********************************************************************************
This email and any attachments are intended for the name...{{dropped:10}}


From peter.adler at usu.edu  Mon Jan  4 20:18:48 2010
From: peter.adler at usu.edu (Peter Adler)
Date: Mon, 04 Jan 2010 12:18:48 -0700
Subject: [R-sig-Geo] newbie rgdal projection problem
Message-ID: <4B423F18.5030009@usu.edu>

Dear R-sig-geo,

I am new to RGDAL and PROJ4, and am having trouble projecting a raster 
dataset.

The dataset is a 721 x 721 cell raster of snow cover from the NSIDC. The 
projection information is here:
http://nsidc.org/data/atlas/epsg_3408.html

My command:

D=readGDAL("annual_snow_trend_ease.tif",
  p4s="+proj=laea +lat_0=90 +lon_0=0 +x_0=0 +y_0=0 +a=6371228 +b=6371228 
+units=m +no_defs")

gets executed, but is followed by the warning message:

annual_snow_trend_ease.tif has GDAL driver GTiff
and has 721 rows and 721 columns
Warning message:
In readGDAL("annual_snow_trend_ease.tif", p4s = "+init=epsg:3408") :
  GeoTransform values not available

Using:

D=readGDAL("annual_snow_trend_ease.tif",
  p4s="+init=epsg:3408")

gives the same result.

I am running R 2.10 on a Windows Vista machine. I think I have all the 
required libraries installed. When I load rgdal, I see:
Loading required package: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.6.2, released 2009/07/31
Path to GDAL shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008
Path to PROJ.4 shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/proj

Thanks for your help,

Peter

-- Peter Adler Dept. of Wildland Resources and the Ecology Center 5230 
Old Main Utah State University Logan, UT 84322 tel: (435) 797-1021 
email: peter.adler at usu.edu http://www.cnr.usu.edu/htm/facstaff/adler-web

-- 
Peter Adler
Dept. of Wildland Resources and the Ecology Center
5230 Old Main
Utah State University
Logan, UT 84322
tel: (435) 797-1021  email: peter.adler at usu.edu
http://www.cnr.usu.edu/htm/facstaff/adler-web


From Roger.Bivand at nhh.no  Mon Jan  4 20:37:27 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 4 Jan 2010 20:37:27 +0100 (CET)
Subject: [R-sig-Geo] newbie rgdal projection problem
In-Reply-To: <4B423F18.5030009@usu.edu>
References: <4B423F18.5030009@usu.edu>
Message-ID: <alpine.LRH.2.00.1001042025510.14399@reclus.nhh.no>

On Mon, 4 Jan 2010, Peter Adler wrote:

> Dear R-sig-geo,
>
> I am new to RGDAL and PROJ4, and am having trouble projecting a raster 
> dataset.
>
> The dataset is a 721 x 721 cell raster of snow cover from the NSIDC. The 
> projection information is here:
> http://nsidc.org/data/atlas/epsg_3408.html
>
> My command:
>
> D=readGDAL("annual_snow_trend_ease.tif",
> p4s="+proj=laea +lat_0=90 +lon_0=0 +x_0=0 +y_0=0 +a=6371228 +b=6371228 
> +units=m +no_defs")
>
> gets executed, but is followed by the warning message:
>
> annual_snow_trend_ease.tif has GDAL driver GTiff
> and has 721 rows and 721 columns
> Warning message:
> In readGDAL("annual_snow_trend_ease.tif", p4s = "+init=epsg:3408") :
> GeoTransform values not available


The message is not related to the projection, but to the underlying 
dimensions of the image - it is being read as a 721 by 721 picture, with 
no location of the NW cell, and no cell sizes. This rather suggests that 
the Tiff file is not a GeoTiff, otherwise these values should have been 
present. Are you using the "browse image files" rather than the snow cover 
data (I don't think so)? Omit the p4s= value, and report summary() of the 
imported object - I think you'll see that it has coordinates 0-721 in each 
dimension or some such.

Roger

>
> Using:
>
> D=readGDAL("annual_snow_trend_ease.tif",
> p4s="+init=epsg:3408")
>
> gives the same result.
>
> I am running R 2.10 on a Windows Vista machine. I think I have all the 
> required libraries installed. When I load rgdal, I see:
> Loading required package: sp
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.6.2, released 2009/07/31
> Path to GDAL shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008
> Path to PROJ.4 shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/proj
>
> Thanks for your help,
>
> Peter
>
> -- Peter Adler Dept. of Wildland Resources and the Ecology Center 5230 Old 
> Main Utah State University Logan, UT 84322 tel: (435) 797-1021 email: 
> peter.adler at usu.edu http://www.cnr.usu.edu/htm/facstaff/adler-web
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Mon Jan  4 23:46:21 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 4 Jan 2010 22:46:21 +0000
Subject: [R-sig-Geo] Creating random (but believable) geographies
In-Reply-To: <4B389493.6050000@bitwrit.com.au>
References: <d8ad40b50912280233t3ace4156uac152ef8bc009c3a@mail.gmail.com>
	<4B389493.6050000@bitwrit.com.au>
Message-ID: <d8ad40b51001041446l5ace86cv133365798a7bc240@mail.gmail.com>

Here's a link to a blog entry I've just written on my code for doing this:

http://geospaced.blogspot.com/2010/01/generating-fake-geographies.html

The code isn't available yet, it needs a bit of cleaning up and
documenting, but if anyone wants the raw code then I can scrape it up
for you!

Barry


From julleeyaw at yahoo.ca  Tue Jan  5 02:04:40 2010
From: julleeyaw at yahoo.ca (Julie Lee-Yaw)
Date: Mon, 4 Jan 2010 17:04:40 -0800 (PST)
Subject: [R-sig-Geo] PBSmapping importShapefile question
In-Reply-To: <1262244393.8296bdcalexandre.villers@cebc.cnrs.fr>
Message-ID: <857589.92982.qm@web30606.mail.mud.yahoo.com>

Hi again,

Thanks to those who helped me with my earlier post. I've installed rgdal and have made some progress but I'm now stuck on an error message that I don't know how to interpret.

I have imported one shapefile that is projected in the CRS that I want. I then import another shapefile that is not projected using the PBSmapping function. To project it to the same CRS, I use use the spTranform function from rgdal. Plotting them together, I get a map that generally looks correct. My code is:

shape1=readShapePoly("file1", proj4string=CRS("+proj=laea +lat_0=90 +lon_0=-100 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"))   
shape1PS=SpatialPolygons2PolySet(shape1)
shape2<-importShapefile("file2.shp",readDBF=FALSE)
shape2Proj=spTransform(shape2,CRS("+proj=laea +lat_0=90 +lon_0=-100 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"))
shape2PS=SpatialPolygons2PolySet(shape2Proj)
plotPolys(shape1PS)
addPolys(shape2PS)

This plots everything but returns the following warning message: 

"Warning message:
In .checkProjection(projectionPlot, projectionPoly) :
  The data's 'projection' attribute (1) differs from the
projection of the plot region (NA)."

My first question is whether this message is just saying the plot is a little off (e.g. one shapefile ends up outside the plot's boundaries) or whether my two shapefiles are still not in a common projection and thus will give me problems in my downstream polygon overlay analysis.

I'm also wondering if someone might be able to clarify what "projection=1" means when you use the PBSmapping function "importShapefile" and the .prj file does not specify 'GEO' nor 'PROJ' with 'UTM' elsewhere? What projection gets assigned in this case?

Thanks!

Julie

--- On Thu, 12/31/09, alexandre villers <alexandre.villers at cebc.cnrs.fr> wrote:

> From: alexandre villers <alexandre.villers at cebc.cnrs.fr>
> Subject: Re: [R-sig-Geo] stuck on importing and projecting shapefiles
> To: julleeyaw at yahoo.ca
> Cc: r-sig-geo at stat.math.ethz.ch
> Received: Thursday, December 31, 2009, 2:26 AM
> Hey Julie,
> 
> The main problem, for what I understood of working with R
> and spatial objects, is that you are using the wrong tools
> to import your data. Maptools is mostly deprecated for all
> the import export function with shapefile/rasters (but still
> holds interesting ones for other jobs).
> You'll have to struggle a bit and get rgdal to work on your
> Mac ! http://cran.r-project.org/bin/macosx/
> Once this is done, it will be much easier to do the job.
> GDAL is a very powerful, essential tool to import export
> data to/from R. So get to the help list for MAC, the forum
> and check if
> - rgdal is compatible for your version of R MAC
> - look for all the packages necessary to compile this
> packages (I couldn't download and compile rgdal with linux
> ubuntu because a small package was missing...). Just check
> through the documentation which packages are necessary to
> compile rgdal with MAC.
> 
> Once this is done, your work will be much more simple
> 
> You will find all the help you need on the rgdal/sp
> helpfile and on the Internet. But do not hesitate to ask
> questions on the list.
> 
> 
> Best regards and good luck.
> 
> Alex
> 
> PS: I'm pretty sure a R / rgdal /MAC user will help you
> with this !
> 
> -----Original Message-----
> From: Julie Lee-Yaw <julleeyaw at yahoo.ca>
> To: r-sig-geo at stat.math.ethz.ch
> Date: Wed, 30 Dec 2009 15:32:46 -0800 (PST)
> Subject: [R-sig-Geo] stuck on importing and projecting
> shapefiles
> 
> Hi,
> I am new to both R and spatial data and am very stuck on
> what I think should be a simple analysis. I am trying to do
> a polygon overlay analysis of two shapefiles from different
> sources. Before proceeding to my overlay functions, I am
> trying to plot my shapefiles to double check that they line
> up properly. In R, I am using PBSmapping and maptools and
> the following script:
> 
> ## read in first shapefile using maptools so I can pull out
> only those polygons that are labeled "blue"
> 
> s1=readShapePoly("shapefile1")
> s1blue=s1[s1$SYMB=="BLUE",]
> s1PS=SpatialPolygons2PolySet(sp1blue)
> shape1=combinePolys(sp1PS)
> attr(shape1,"projection")<-"LL"
> 
> ## read in second shapefile using PBSmapping routine (in
> this case, I need to use importShapefile because I have
> previously modified this function to import only select
> polygons from this file
> 
> shape2<-importShapefile("shapefile2", projection="LL")
> 
> ## trying to plot both together:
> 
> plotPolys(shape1) ##produces reasonable looking plot
> addPolys(shape2)
> 
> ## I get the following error message
> 
> In .checkProjection(projectionPlot, projectionPoly) :
> ? The data's 'projection' attribute (LL) differs from the
> projection of the plot region (NA).
> 
> This leads me to think that the projections are different
> and thus my downstream calculations of intersection areas
> will be off. The first shapefile is projected and has the
> following prj file attached:
> 
> PROJCS["Clarke_1866_Lambert_Conformal_Conic",GEOGCS["GCS_Clarke_1866",DATUM["D_Clarke_1866",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-95.0],PARAMETER["Standard_Parallel_1",49.0],PARAMETER["Standard_Parallel_2",77.0],PARAMETER["Latitude_Of_Origin",49.0],UNIT["Meter",1.0]]
> 
> The second shapefile is unprojected and the metadata
> indicates:
> projection parameters: units: decimal degrees
> Datum: North America 1983
> 
> Since I'm using a MAC and can't figure out how to load
> rgdal, I have tried importing both shapefiles into QGIS (a
> separate GIS program), reprojecting them and exporting them
> from there and re-applying my R code but I get the same
> error message. Does anyone have any suggestions as to what I
> might be doing wrong and how I can get these shapefiles into
> a common projection so that I can calculate the area of
> their intersection? Thanks in advance for the help!
> 
> 
> 
> Alexandre Villers
> PhD. Candidate
> Team Agripop
> CEBC CNRS UPR 1934
> 79360 Beauvoir sur Niort
> 
> Phone: +33 (0)549 099 613
> 
> 
> __________ Information from ESET Mail Security, version of
> virus signature database 4730 (20091230) __________
> 
> The message was checked by ESET Mail Security.
> http://www.eset.com
> 
> 
> 


      __________________________________________________________________
Be smarter than spam. See how smart SpamGuard is at giving junk email the boot with t

From jasonkrupert at yahoo.com  Tue Jan  5 03:34:53 2010
From: jasonkrupert at yahoo.com (Jason Rupert)
Date: Mon, 4 Jan 2010 18:34:53 -0800 (PST)
Subject: [R-sig-Geo] Newbie Question...
Message-ID: <614730.92683.qm@web56002.mail.re3.yahoo.com>

At the suggestion of Walmes Zeviani I downloaded and am taking a look at the sp package.

In an attempt to get going, can someone offer a suggestion about how to convert the below over to a version that uses the sp package? 

data(volcano)
x <- 10*(1:nrow(volcano))
y <- 10*(1:ncol(volcano))

image(x, y, volcano,col = terrain.colors(100),axes = FALSE)
contour(x, y, volcano, levels = seq(90, 200, by=5),add = TRUE, col ="peru")
axis(1, at = seq(100, 800, by = 100))
axis(2, at = seq(100, 600, by = 100))
box()
title(main = "Maunga Whau Volcano",font.main = 4)

Thanks for any feedback and insights.


From mdsumner at gmail.com  Tue Jan  5 03:45:03 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 5 Jan 2010 13:45:03 +1100
Subject: [R-sig-Geo] Newbie Question...
In-Reply-To: <614730.92683.qm@web56002.mail.re3.yahoo.com>
References: <614730.92683.qm@web56002.mail.re3.yahoo.com>
Message-ID: <522664f81001041845y6cde22fdqbd36cab6e7dab927@mail.gmail.com>

Here's one way. I'm not sure about how to control the aspect ratio
(something I've been meaning to check for a while now).

library(sp)
data(volcano)
x <- 10*(1:nrow(volcano))
y <- 10*(1:ncol(volcano))

## image xyz list
imlist <- list(x = x, y = y, z = volcano)

## SpatialGridDataFrame (image2Grid is v. simple, see definition)
imspdf <- image2Grid(imlist)

image(imspdf, col = terrain.colors(100),axes = FALSE, asp = "")
contour(imspdf, levels = seq(90, 200, by=5),add = TRUE, col ="peru")
axis(1, at = seq(100, 800, by = 100))
axis(2, at = seq(100, 600, by = 100))
box()
title(main = "Maunga Whau Volcano",font.main = 4)



On Tue, Jan 5, 2010 at 1:34 PM, Jason Rupert <jasonkrupert at yahoo.com> wrote:
> At the suggestion of Walmes Zeviani I downloaded and am taking a look at the sp package.
>
> In an attempt to get going, can someone offer a suggestion about how to convert the below over to a version that uses the sp package?
>
> data(volcano)
> x <- 10*(1:nrow(volcano))
> y <- 10*(1:ncol(volcano))
>
> image(x, y, volcano,col = terrain.colors(100),axes = FALSE)
> contour(x, y, volcano, levels = seq(90, 200, by=5),add = TRUE, col ="peru")
> axis(1, at = seq(100, 800, by = 100))
> axis(2, at = seq(100, 600, by = 100))
> box()
> title(main = "Maunga Whau Volcano",font.main = 4)
>
> Thanks for any feedback and insights.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Tue Jan  5 08:22:54 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 05 Jan 2010 08:22:54 +0100
Subject: [R-sig-Geo] Newbie Question...
In-Reply-To: <522664f81001041845y6cde22fdqbd36cab6e7dab927@mail.gmail.com>
References: <614730.92683.qm@web56002.mail.re3.yahoo.com>
	<522664f81001041845y6cde22fdqbd36cab6e7dab927@mail.gmail.com>
Message-ID: <4B42E8CE.5000501@uni-muenster.de>



Michael Sumner wrote:
> Here's one way. I'm not sure about how to control the aspect ratio
> (something I've been meaning to check for a while now).
>   
somewhat of a non-newby answer to Michael: asp is set in plot.Spatial, 
and if the default value of NA is passed, set to:

    if (is.na(asp)) asp <- ifelse(is.na(proj4string(x)) || is.projected(x),
        1.0, 1/cos((mean(ylim) * pi)/180))

i.e. 1.0, or a somewhat more sensible value for longlat data.

if you override the NA default with "", asp is taken from the device 
geometry -- the plot fills the device. For geographic data this usually 
means arbitrary stretching in some direction.

> library(sp)
> data(volcano)
> x <- 10*(1:nrow(volcano))
> y <- 10*(1:ncol(volcano))
>
> ## image xyz list
> imlist <- list(x = x, y = y, z = volcano)
>
> ## SpatialGridDataFrame (image2Grid is v. simple, see definition)
> imspdf <- image2Grid(imlist)
>
> image(imspdf, col = terrain.colors(100),axes = FALSE, asp = "")
> contour(imspdf, levels = seq(90, 200, by=5),add = TRUE, col ="peru")
> axis(1, at = seq(100, 800, by = 100))
> axis(2, at = seq(100, 600, by = 100))
> box()
> title(main = "Maunga Whau Volcano",font.main = 4)
>
>
>
> On Tue, Jan 5, 2010 at 1:34 PM, Jason Rupert <jasonkrupert at yahoo.com> wrote:
>   
>> At the suggestion of Walmes Zeviani I downloaded and am taking a look at the sp package.
>>
>> In an attempt to get going, can someone offer a suggestion about how to convert the below over to a version that uses the sp package?
>>
>> data(volcano)
>> x <- 10*(1:nrow(volcano))
>> y <- 10*(1:ncol(volcano))
>>
>> image(x, y, volcano,col = terrain.colors(100),axes = FALSE)
>> contour(x, y, volcano, levels = seq(90, 200, by=5),add = TRUE, col ="peru")
>> axis(1, at = seq(100, 800, by = 100))
>> axis(2, at = seq(100, 600, by = 100))
>> box()
>> title(main = "Maunga Whau Volcano",font.main = 4)
>>
>> Thanks for any feedback and insights.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From laure.velez at hotmail.fr  Tue Jan  5 11:37:52 2010
From: laure.velez at hotmail.fr (laure velez)
Date: Tue, 5 Jan 2010 11:37:52 +0100
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <c8b158011001050121s26a9b2d1u905d15f495a31c2e@mail.gmail.com>
References: <BLU144-W10CBC6EEE212196A96A55F9B730@phx.gbl>,
	<c8b158011001050121s26a9b2d1u905d15f495a31c2e@mail.gmail.com>
Message-ID: <BLU144-W20A527FFD254E4F9120F4A9B730@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/4344b162/attachment.pl>

From Roger.Bivand at nhh.no  Tue Jan  5 11:49:27 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 11:49:27 +0100 (CET)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <BLU144-W20A527FFD254E4F9120F4A9B730@phx.gbl>
References: <BLU144-W10CBC6EEE212196A96A55F9B730@phx.gbl>,
	<c8b158011001050121s26a9b2d1u905d15f495a31c2e@mail.gmail.com>
	<BLU144-W20A527FFD254E4F9120F4A9B730@phx.gbl>
Message-ID: <alpine.LRH.2.00.1001051146440.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, laure velez wrote:

>
> Dear list member,
>
> Although the answer to this might be straightforward I'm struggling with this issue for weeks now :
>
> I have a shapefile (only one polygon) and a raster (.tif). I would like to know the value of each pixel on the raster which overlap with the polygon in the shapefile.
> I had various tries but none did work :
>
> library(rgdal)
>
> pol = readOGR(?shape.shp?, layer = ?shape?)
> grid = readGDAL(?raster.tif?)
> overlay(grid,pol)
>
> With this I obtain ?NA? for all pixels
>
> Could you help me ?

Please try:

image(grid, axes=TRUE)
plot(pol, add=TRUE)

If the polygon doesn't show up in the correct place, do examine summary() 
output for both objects. I suspect that the coordinate values of the 
objects - seem in the bounding boxes in the summary output - do not 
overlap, probably because the coordinate reference systems differ.

Roger

>
> Thanks in advance,
>
> Laure
>
>
> Please find attached the shape and the raster
>
>
>
> Vous ?tes ?tudiants ? B?n?ficiez de Windows 7 ? 35? !  D?couvrez notre offre !
> _________________________________________________________________
> [[elided Hotmail spam]]
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From adam.a28 at wp.pl  Tue Jan  5 12:48:49 2010
From: adam.a28 at wp.pl (Adam A)
Date: Tue, 05 Jan 2010 12:48:49 +0100
Subject: [R-sig-Geo] prism maps
Message-ID: <4b432721cf6db4.56596556@wp.pl>

Hello!

Can I make prism maps in R ????

----------------------------------------------------
Kibicuj bia?o-czerwonym w Zakopanem
Najwi?ksza impreza sportowa tej zimy!
Zobacz zdj?cia:
http://klik.wp.pl/?adr=http%3A%2F%2Fcorto.www.wp.pl%2Fas%2Fskoki_galeria.html&sid=942


From laure.velez at hotmail.fr  Tue Jan  5 13:43:49 2010
From: laure.velez at hotmail.fr (laure velez)
Date: Tue, 5 Jan 2010 13:43:49 +0100
Subject: [R-sig-Geo] raster / polygon overlay
In-Reply-To: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
References: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
Message-ID: <BLU144-W34DD2150963B9D50D5C4BA9B730@phx.gbl>



Many thanks for the fast replies,



@ Roger : polygons and raster are ok (see attached file).

@  Johannes : I have already try this but the result was not satisfying, using a SpatialPointsDataFrame do not solve the problem as the points are not  inside the polygon (see attached file).

I guess the problem arises because of the raster resolution that is to large ....

Any suggestion would be appreciated,

Please find attached a plot showing the raster (image), the polygon and the centroid of the raster cells : 

image(grid, axes=TRUE)
plot(pol, add=TRUE)
points(coordinates(grid))

Regards,

Laure.
 		 	   		  
_________________________________________________________________
[[elided Hotmail spam]]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/2a958e2d/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ex.jpg
Type: image/jpeg
Size: 20164 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/2a958e2d/attachment.jpg>

From Roger.Bivand at nhh.no  Tue Jan  5 13:58:41 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 13:58:41 +0100 (CET)
Subject: [R-sig-Geo] raster / polygon overlay
In-Reply-To: <BLU144-W34DD2150963B9D50D5C4BA9B730@phx.gbl>
References: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
	<BLU144-W34DD2150963B9D50D5C4BA9B730@phx.gbl>
Message-ID: <alpine.LRH.2.00.1001051353320.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, laure velez wrote:

>
>
> Many thanks for the fast replies,
>
>
>
> @ Roger : polygons and raster are ok (see attached file).
>
> @  Johannes : I have already try this but the result was not satisfying, using a SpatialPointsDataFrame do not solve the problem as the points are not  inside the polygon (see attached file).
>
> I guess the problem arises because of the raster resolution that is to large ....
>
> Any suggestion would be appreciated,
>
> Please find attached a plot showing the raster (image), the polygon and the centroid of the raster cells :
>
> image(grid, axes=TRUE)
> plot(pol, add=TRUE)
> points(coordinates(grid))


Yes, none of the big grid centres falls inside the small polygon. Could I 
suggest that you subset the grid to the area near the polygon (try it out 
by hand, plotting until you have say 16 grid cells)? Then resample using 
spsample with type="regular" to generate say 1600 new points, using 
overlay on the input polygon and on the coercion of the small grid to work 
out which sample points fall into which big grid cell and into the input 
polygon. If you need more precision, increase the number of points per big 
cell from 100.

Roger

>
> Regards,
>
> Laure.
>
> _________________________________________________________________
> [[elided Hotmail spam]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Jan  5 14:09:59 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 14:09:59 +0100 (CET)
Subject: [R-sig-Geo] prism maps
In-Reply-To: <4b432721cf6db4.56596556@wp.pl>
References: <4b432721cf6db4.56596556@wp.pl>
Message-ID: <alpine.LRH.2.00.1001051400220.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, Adam A wrote:

> Hello!
>
> Can I make prism maps in R ????

library(fortunes)
fortune("Yoda")

But should you want to - they do seem to be much more open to 
misinterpretation than more conservative representations?

Roger

>
> ----------------------------------------------------
> Kibicuj bia?o-czerwonym w Zakopanem
> Najwi?ksza impreza sportowa tej zimy!
> Zobacz zdj?cia:
> http://klik.wp.pl/?adr=http%3A%2F%2Fcorto.www.wp.pl%2Fas%2Fskoki_galeria.html&sid=942
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Thomas.Adams at noaa.gov  Tue Jan  5 14:25:30 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Tue, 05 Jan 2010 08:25:30 -0500
Subject: [R-sig-Geo] prism maps
In-Reply-To: <4b432721cf6db4.56596556@wp.pl>
References: <4b432721cf6db4.56596556@wp.pl>
Message-ID: <4B433DCA.8000107@noaa.gov>

Adam,

Do you mean PRISM maps such as these: http://www.prism.oregonstate.edu/ 
? If yes, then the question would be, do you want to duplicate the PRISM 
methodology or effectively get similar results? One could use universal 
kriging using gstat or methods proposed by

Tom


Adam A wrote:
> Hello!
>
> Can I make prism maps in R ????
>
> ----------------------------------------------------
> Kibicuj bia?o-czerwonym w Zakopanem
> Najwi?ksza impreza sportowa tej zimy!
> Zobacz zdj?cia:
> http://klik.wp.pl/?adr=http%3A%2F%2Fcorto.www.wp.pl%2Fas%2Fskoki_galeria.html&sid=942
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From diederik.strubbe at ua.ac.be  Tue Jan  5 14:30:03 2010
From: diederik.strubbe at ua.ac.be (Strubbe Diederik)
Date: Tue, 5 Jan 2010 14:30:03 +0100
Subject: [R-sig-Geo] Spatial correlogram - Problems with creating
	neigbourhood list and weights
Message-ID: <C9854550FEF14846A136100B3EC52F73B6B8C0@xmail05.ad.ua.ac.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/82123cfa/attachment.pl>

From laure.velez at hotmail.fr  Tue Jan  5 14:46:32 2010
From: laure.velez at hotmail.fr (laure velez)
Date: Tue, 5 Jan 2010 14:46:32 +0100
Subject: [R-sig-Geo] raster / polygon overlay
In-Reply-To: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
References: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
Message-ID: <BLU144-W86D481D75DDDD52F0BD2D9B730@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/97f608f4/attachment.pl>

From Roger.Bivand at nhh.no  Tue Jan  5 15:07:14 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 15:07:14 +0100 (CET)
Subject: [R-sig-Geo] Spatial correlogram - Problems with creating
 neigbourhood list and weights
In-Reply-To: <C9854550FEF14846A136100B3EC52F73B6B8C0@xmail05.ad.ua.ac.be>
References: <C9854550FEF14846A136100B3EC52F73B6B8C0@xmail05.ad.ua.ac.be>
Message-ID: <alpine.LRH.2.00.1001051455250.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, Strubbe Diederik wrote:

> Dear all,
>
> I have a dataset with several lat-long coordinates (48) and corresponding residuals values (not a grid). Using the spdep package, I try to create a correlogram of these residuals according to several lags (i.e. distance classes) but I can?t seem to get the neighborhood and weights right?
>
> Below, I show the main parts of the code and the results:
>
> rnp <- read.table ("D:/Diederik/RESID_WITH_DISTANCE.csv",sep=",",header=T)
> resids <- rnp$RESID
>
> ##create neighbourhood list and make symmetric##
> xy <- cbind(rnp$X, rnp$Y)
> rnp_nb <-knn2nb(knearneigh(xy, longlat=TRUE))
> rnp_nb <-make.sym.nb(rnp_nb)
> rnp_nb

You have chosen a k=1 first nearest neighbour scheme, was this intended?

>
> Neighbour list object:
> Number of regions: 48
> Number of nonzero links: 66
> Percentage nonzero weights: 2.864583
> Average number of links: 1.375
>
> ##create weights##
> rnp_w <- nb2listw(rnp_nb,glist=NULL,style="W",zero.policy=FALSE)
> rnp_w
>
> Characteristics of weights list object:
> Neighbour list object:
> Number of regions: 48
> Number of nonzero links: 66
> Percentage nonzero weights: 2.864583
> Average number of links: 1.375
>
> Weights style: W
> Weights constants summary:
>   n   nn S0       S1       S2
> W 48 2304 48 73.72222 209.3333
>
> ## Moran's I test for spatial autocorrelation##
> moran.test(resids, rnp_w, randomisation=TRUE, ?)
>
>        Moran's I test under randomisation
>
> data:  resids
> weights: rnp_w
> Moran I statistic standard deviate = -0.3353, p-value = 0.6313
> alternative hypothesis: greater
> sample estimates:
> Moran I statistic       Expectation          Variance
>      -0.08060979       -0.02127660        0.03130522
>

Note that Moran's I for this symmetrized first nearest neighbour scheme is 
not significant.

>
>
>
> ##make a correlogram##
> sp.correlogram(rnp_nb, resids, order=16, method="I", zero.policy=TRUE)
>
> Error in nb2listw(nblags[[i]], style = style, zero.policy = zero.policy) :
>  No valid observations

This is most likely a result of your choice of symmtrized first nearest 
neighbours, leading to many graph components and/or the unrealistically 
high order=:

library(spdep)
data(columbus)
nbk1 <- knn2nb(knearneigh(cbind(columbus$X, columbus$Y)))
snbk1 <- make.sym.nb(nbk1)
n.comp.nb(snbk1)$nc
plot(snbk1, cbind(columbus$X, columbus$Y))
moran.test(columbus$CRIME, nb2listw(snbk1))
sp.correlogram(snbk1, columbus$CRIME, order=6, method="I",
  zero.policy=TRUE)
sp.correlogram(snbk1, columbus$CRIME, order=7, method="I",
  zero.policy=TRUE)

Try reducing order= to something realistic, but also consider a denser, 
more connected, representation of neighbours.

Hope this helps,

Roger

> In addition: Warning message:
> In moran.test(var, listw, randomisation = randomisation, zero.policy = zero.policy) :
>  Out-of-range p-value: reconsider test arguments
>
>
> Moran.test seems to work fine, but the sp.correlogram doesn?t?  Do I ? in any way- have to attach the weigths (rnp_w) to the neighourhood list (rnp_nb)?
>
> Many thanks!!
>
> Diederik
>
> PS: R-version 2.9.2, Package spdep version 0.4-56, Windows Vista Home Premium Service Pack 2 on Acer Extensa 5630
>
> Dr. Diederik Strubbe
> Evolutionary Ecology Group
> Department of Biology
> University of Antwerp
> Groenenborgerlaan 171
> 2020 Antwerpen, Belgium
> tel: +32 3 265 3464
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From hi_ono2001 at ybb.ne.jp  Tue Jan  5 15:28:05 2010
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Tue, 5 Jan 2010 23:28:05 +0900 (JST)
Subject: [R-sig-Geo] prism maps
In-Reply-To: <4B433DCA.8000107@noaa.gov>
Message-ID: <20100105142805.94879.qmail@web10511.mail.ogk.yahoo.co.jp>

Hello.

 How about this.


http://translate.google.co.jp/translate?js=y&prev=_t&hl=ja&ie=UTF-8&layout=1&eotf=1&u=http%3A%2F%2Fwww.okada.jp.org%2FRWiki%2F%3FGoogleEarth%25A4%25C8R%23d46aa784&sl=ja&tl=en

 Original language is Japanese.



                           Regards.       

--- Thomas Adams <Thomas.Adams at noaa.gov> wrote:

> Adam,
> 
> Do you mean PRISM maps such as these:
> http://www.prism.oregonstate.edu/ 
> ? If yes, then the question would be, do you want to
> duplicate the PRISM 
> methodology or effectively get similar results? One
> could use universal 
> kriging using gstat or methods proposed by
> 
> Tom
> 
> 
> Adam A wrote:
> > Hello!
> >
> > Can I make prism maps in R ????
> >
> >
> ----------------------------------------------------
> > Kibicuj bia??o-czerwonym w Zakopanem
> > Najwi??ksza impreza sportowa tej zimy!
> > Zobacz zdj??cia:
> >
>
http://klik.wp.pl/?adr=http%3A%2F%2Fcorto.www.wp.pl%2Fas%2Fskoki_galeria.html&sid=942
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >   
> 
> 
> -- 
> Thomas E Adams
> National Weather Service
> Ohio River Forecast Center
> 1901 South State Route 134
> Wilmington, OH 45177
> 
> EMAIL:	thomas.adams at noaa.gov
> 
> VOICE:	937-383-0528
> FAX:	937-383-0033
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From marco.helbich at gmx.at  Tue Jan  5 17:24:21 2010
From: marco.helbich at gmx.at (Marco Helbich)
Date: Tue, 05 Jan 2010 17:24:21 +0100
Subject: [R-sig-Geo] mixed geographically weighted regression
Message-ID: <20100105162421.175140@gmx.net>

Dear list,

I am trying to fit a mixed geographically weighted regression model (with adaptive kernel) using the spgwr package, i.e. I want to hold some of the coefficients fixed at the global level. Thus, I have the following questions:

1. Which is the most efficient way to estimate such a model? 
a) I found the posting http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg00984.html where Roger recommended to first fit a global model, then the GWR using the residuals. 
b) The method proposed in Mei et al. (2006,  pp. 588-589, see http://www.envplan.com/abstract.cgi?id=a3768) first computes the projection matrix of the locally varying part (called S_v) and uses this in a second step to derive the fixed coefficients (this seems to me like an application of the FWL-theorem see http://en.wikipedia.org/wiki/FWL_theorem). 

2. In order to follow this method, I first have to find the kernel weights at each point. The help-file says that these can be found in the SpatialPointsDataFrame (SDF), but I could not get it from there. Where can I extract them?

We are using such a code:
library(spgwr)
data(georgia)
g.adapt.gauss <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + PctBlack, data=gSRDF, adapt=TRUE)
res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + PctBlack, data=gSRDF, adapt=g.adapt.gauss)
res.adpt$SDF

I hope my problem is clear and appreciate every hint! Thank you!

Best regards
Marco

-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3.5 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/atbrowser


From Roger.Bivand at nhh.no  Tue Jan  5 18:00:50 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 18:00:50 +0100 (CET)
Subject: [R-sig-Geo] mixed geographically weighted regression
In-Reply-To: <20100105162421.175140@gmx.net>
References: <20100105162421.175140@gmx.net>
Message-ID: <alpine.LRH.2.00.1001051745370.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, Marco Helbich wrote:

> Dear list,
>
> I am trying to fit a mixed geographically weighted regression model (with adaptive kernel) using the spgwr package, i.e. I want to hold some of the coefficients fixed at the global level. Thus, I have the following questions:
>
> 1. Which is the most efficient way to estimate such a model?
> a) I found the posting http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg00984.html where Roger recommended to first fit a global model, then the GWR using the residuals.
> b) The method proposed in Mei et al. (2006,  pp. 588-589, see http://www.envplan.com/abstract.cgi?id=a3768) first computes the projection matrix of the locally varying part (called S_v) and uses this in a second step to derive the fixed coefficients (this seems to me like an application of the FWL-theorem see http://en.wikipedia.org/wiki/FWL_theorem).
>
> 2. In order to follow this method, I first have to find the kernel 
> weights at each point. The help-file says that these can be found in the 
> SpatialPointsDataFrame (SDF), but I could not get it from there. Where 
> can I extract them?

The sums of weights for each fit point are in the returned object, but 
this is not what you (do not) want. The S_v matrix in the paper (eq. 3) is 
returned as the hat matrix, I believe. Since you have S_v, you do not need 
the W(u_i, v_i) weights (a diagonal matrix for each fit (and data) point 
i). Given S_v, the unnumbered equation in the middle of the page gives you 
\hat{\beta_c}, doesn't it? I think that I would pre-multiply X_c and Y by 
(I - S_v), then use QR methods to complete, if I wanted to proceed with 
this.

Because of concerns about how these things are done, and how they are 
represented in the literature, I'd look for corrobotation - being able to 
reproduce others' published results for example.

Hope this helps,

Roger

>
> We are using such a code:
> library(spgwr)
> data(georgia)
> g.adapt.gauss <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + PctBlack, data=gSRDF, adapt=TRUE)
> res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + PctBlack, data=gSRDF, adapt=g.adapt.gauss)
> res.adpt$SDF
>
> I hope my problem is clear and appreciate every hint! Thank you!
>
> Best regards
> Marco
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Jan  5 18:54:08 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jan 2010 18:54:08 +0100 (CET)
Subject: [R-sig-Geo] mixed geographically weighted regression
In-Reply-To: <20100105175039.175120@gmx.net>
References: <20100105162421.175140@gmx.net>
	<alpine.LRH.2.00.1001051745370.16833@reclus.nhh.no>
	<20100105175039.175120@gmx.net>
Message-ID: <alpine.LRH.2.00.1001051852420.16833@reclus.nhh.no>

On Tue, 5 Jan 2010, Marco Helbich wrote:

> Dear Roger,
>
> thank you for your quick response!
>
> If I understand it correctly, the hat matrix is calculated using all 
> explanatory variables. In my case, however, I would need to restrict the 
> column space to those covariates where I assume varying coefficients (as 
> in eq. (3)), and for this purpose I would need to calculate S_v by hand. 
> Therefore, I would need the weight matrices for every observation. Or is 
> there an easier way?

Naturally. Use the hat matrix from a regular GWR fit with only X_v 
included, as the paper (seems to) describe.

Roger

>
> Kind regards,
>
> Marco
>
>
> -------- Original-Nachricht --------
>> Datum: Tue, 5 Jan 2010 18:00:50 +0100 (CET)
>> Von: Roger Bivand <Roger.Bivand at nhh.no>
>> An: Marco Helbich <marco.helbich at gmx.at>
>> CC: r-sig-geo at stat.math.ethz.ch
>> Betreff: Re: [R-sig-Geo] mixed geographically weighted regression
>
>> On Tue, 5 Jan 2010, Marco Helbich wrote:
>>
>>> Dear list,
>>>
>>> I am trying to fit a mixed geographically weighted regression model
>> (with adaptive kernel) using the spgwr package, i.e. I want to hold some of the
>> coefficients fixed at the global level. Thus, I have the following
>> questions:
>>>
>>> 1. Which is the most efficient way to estimate such a model?
>>> a) I found the posting
>> http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg00984.html where Roger recommended to first fit a global model,
>> then the GWR using the residuals.
>>> b) The method proposed in Mei et al. (2006,  pp. 588-589, see
>> http://www.envplan.com/abstract.cgi?id=a3768) first computes the projection matrix of
>> the locally varying part (called S_v) and uses this in a second step to
>> derive the fixed coefficients (this seems to me like an application of the
>> FWL-theorem see http://en.wikipedia.org/wiki/FWL_theorem).
>>>
>>> 2. In order to follow this method, I first have to find the kernel
>>> weights at each point. The help-file says that these can be found in the
>>> SpatialPointsDataFrame (SDF), but I could not get it from there. Where
>>> can I extract them?
>>
>> The sums of weights for each fit point are in the returned object, but
>> this is not what you (do not) want. The S_v matrix in the paper (eq. 3) is
>> returned as the hat matrix, I believe. Since you have S_v, you do not need
>> the W(u_i, v_i) weights (a diagonal matrix for each fit (and data) point
>> i). Given S_v, the unnumbered equation in the middle of the page gives you
>> \hat{\beta_c}, doesn't it? I think that I would pre-multiply X_c and Y by
>> (I - S_v), then use QR methods to complete, if I wanted to proceed with
>> this.
>>
>> Because of concerns about how these things are done, and how they are
>> represented in the literature, I'd look for corrobotation - being able to
>> reproduce others' published results for example.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> We are using such a code:
>>> library(spgwr)
>>> data(georgia)
>>> g.adapt.gauss <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB
>> + PctPov + PctBlack, data=gSRDF, adapt=TRUE)
>>> res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov
>> + PctBlack, data=gSRDF, adapt=g.adapt.gauss)
>>> res.adpt$SDF
>>>
>>> I hope my problem is clear and appreciate every hint! Thank you!
>>>
>>> Best regards
>>> Marco
>>>
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marco.helbich at gmx.at  Tue Jan  5 18:50:39 2010
From: marco.helbich at gmx.at (Marco Helbich)
Date: Tue, 05 Jan 2010 18:50:39 +0100
Subject: [R-sig-Geo] mixed geographically weighted regression
In-Reply-To: <alpine.LRH.2.00.1001051745370.16833@reclus.nhh.no>
References: <20100105162421.175140@gmx.net>
	<alpine.LRH.2.00.1001051745370.16833@reclus.nhh.no>
Message-ID: <20100105175039.175120@gmx.net>

Dear Roger,

thank you for your quick response! 

If I understand it correctly, the hat matrix is calculated using all explanatory variables. In my case, however, I would need to restrict the column space to those covariates where I assume varying coefficients (as in eq. (3)), and for this purpose I would need to calculate S_v by hand. Therefore, I would need the weight matrices for every observation. Or is there an easier way? 

Kind regards,

Marco


-------- Original-Nachricht --------
> Datum: Tue, 5 Jan 2010 18:00:50 +0100 (CET)
> Von: Roger Bivand <Roger.Bivand at nhh.no>
> An: Marco Helbich <marco.helbich at gmx.at>
> CC: r-sig-geo at stat.math.ethz.ch
> Betreff: Re: [R-sig-Geo] mixed geographically weighted regression

> On Tue, 5 Jan 2010, Marco Helbich wrote:
> 
> > Dear list,
> >
> > I am trying to fit a mixed geographically weighted regression model
> (with adaptive kernel) using the spgwr package, i.e. I want to hold some of the
> coefficients fixed at the global level. Thus, I have the following
> questions:
> >
> > 1. Which is the most efficient way to estimate such a model?
> > a) I found the posting
> http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg00984.html where Roger recommended to first fit a global model,
> then the GWR using the residuals.
> > b) The method proposed in Mei et al. (2006,  pp. 588-589, see
> http://www.envplan.com/abstract.cgi?id=a3768) first computes the projection matrix of
> the locally varying part (called S_v) and uses this in a second step to
> derive the fixed coefficients (this seems to me like an application of the
> FWL-theorem see http://en.wikipedia.org/wiki/FWL_theorem).
> >
> > 2. In order to follow this method, I first have to find the kernel 
> > weights at each point. The help-file says that these can be found in the
> > SpatialPointsDataFrame (SDF), but I could not get it from there. Where 
> > can I extract them?
> 
> The sums of weights for each fit point are in the returned object, but 
> this is not what you (do not) want. The S_v matrix in the paper (eq. 3) is
> returned as the hat matrix, I believe. Since you have S_v, you do not need
> the W(u_i, v_i) weights (a diagonal matrix for each fit (and data) point 
> i). Given S_v, the unnumbered equation in the middle of the page gives you
> \hat{\beta_c}, doesn't it? I think that I would pre-multiply X_c and Y by 
> (I - S_v), then use QR methods to complete, if I wanted to proceed with 
> this.
> 
> Because of concerns about how these things are done, and how they are 
> represented in the literature, I'd look for corrobotation - being able to 
> reproduce others' published results for example.
> 
> Hope this helps,
> 
> Roger
> 
> >
> > We are using such a code:
> > library(spgwr)
> > data(georgia)
> > g.adapt.gauss <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld + PctFB
> + PctPov + PctBlack, data=gSRDF, adapt=TRUE)
> > res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov
> + PctBlack, data=gSRDF, adapt=g.adapt.gauss)
> > res.adpt$SDF
> >
> > I hope my problem is clear and appreciate every hint! Thank you!
> >
> > Best regards
> > Marco
> >
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3.5 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/atbrowser


From cara.tobin at epfl.ch  Tue Jan  5 22:31:03 2010
From: cara.tobin at epfl.ch (Tobin Cara)
Date: Tue, 5 Jan 2010 22:31:03 +0100
Subject: [R-sig-Geo] Kriging concept question
Message-ID: <EDB94195DABE64488928DD39E53B8FC68BDFD3E93E@REX2.intranet.epfl.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/16310ba4/attachment.pl>

From Joshua.Mailhiot at dfo-mpo.gc.ca  Tue Jan  5 23:15:36 2010
From: Joshua.Mailhiot at dfo-mpo.gc.ca (Mailhiot, Joshua)
Date: Tue, 5 Jan 2010 14:15:36 -0800
Subject: [R-sig-Geo] Question about a spatial non-square cells error in R
Message-ID: <63F107BCC37AEA49A75FD94AA3E07CB005312229@pacpbsex01.pac.dfo-mpo.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100105/2cab75aa/attachment.pl>

From pierre.roudier at gmail.com  Wed Jan  6 06:04:04 2010
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 6 Jan 2010 16:04:04 +1100
Subject: [R-sig-Geo] Testing if a point-pattern is on a regular grid
Message-ID: <e4178da61001052104i4fe7e4d7w8d1e5c0bfd17a278@mail.gmail.com>

Dear list,

I'm looking for an easy way to test if a point pattern (I got a data
frame of x and y coordinates) is on a regular grid or not.

I'm aware of the gridded() function in sp(), but this function is
devoted to assign rather than to test, as far as I know. I'm pretty
sure there's an easy way to do that though....

Any suggestions ?

Thanks,

Pierre


From nsicad at gmail.com  Wed Jan  6 07:16:43 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Wed, 6 Jan 2010 13:16:43 +0700
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon in
	spplot / plot - possible?
Message-ID: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>

Hi,

I have problem transposing my database table which is to be merged /
joined with the shapefile file (*.dbf) inorder to have one-to-one
relationship with shapefile polygon. As we know that inorder for the
polygon to be rendered in GIS, it has to have one-to-ope relationship.

One to many table:

Poly_ID Period Age
01           1       32
01           2       34
02           1       30
03           2       21


One to one table

Poly_ID Period1 Period2 Period3
01            32           34
02             30
03                           21
04                                    35

Now,  is it possible to use one-to-many table for mapping using spplot / plot?

The result data I am trying to map using spplot has 1 to 70 years
periods. I want to produce maps per period, for 10 years or more for
forest management regimes in forest stand.

Any alternative?

Thanks in advance.

Noli


From Roger.Bivand at nhh.no  Wed Jan  6 08:25:01 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Jan 2010 08:25:01 +0100 (CET)
Subject: [R-sig-Geo] Testing if a point-pattern is on a regular grid
In-Reply-To: <e4178da61001052104i4fe7e4d7w8d1e5c0bfd17a278@mail.gmail.com>
References: <e4178da61001052104i4fe7e4d7w8d1e5c0bfd17a278@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001060816470.20241@reclus.nhh.no>

On Wed, 6 Jan 2010, Pierre Roudier wrote:

> Dear list,
>
> I'm looking for an easy way to test if a point pattern (I got a data
> frame of x and y coordinates) is on a regular grid or not.
>
> I'm aware of the gridded() function in sp(), but this function is
> devoted to assign rather than to test, as far as I know. I'm pretty
> sure there's an easy way to do that though....

Use try(points2grid()) - if this returns an object of class "try-error", 
the points do not lie on a grid.

Roger

>
> Any suggestions ?
>
> Thanks,
>
> Pierre
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Jan  6 08:27:04 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Jan 2010 08:27:04 +0100 (CET)
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon
 in spplot / plot - possible?
In-Reply-To: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
References: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001060825400.20241@reclus.nhh.no>

On Wed, 6 Jan 2010, Noli Sicad wrote:

> Hi,
>
> I have problem transposing my database table which is to be merged /
> joined with the shapefile file (*.dbf) inorder to have one-to-one
> relationship with shapefile polygon. As we know that inorder for the
> polygon to be rendered in GIS, it has to have one-to-ope relationship.

Review ?reshape to convert to wide format before trying to merge into 
your object for using spplot().

Roger

>
> One to many table:
>
> Poly_ID Period Age
> 01           1       32
> 01           2       34
> 02           1       30
> 03           2       21
>
>
> One to one table
>
> Poly_ID Period1 Period2 Period3
> 01            32           34
> 02             30
> 03                           21
> 04                                    35
>
> Now,  is it possible to use one-to-many table for mapping using spplot / plot?
>
> The result data I am trying to map using spplot has 1 to 70 years
> periods. I want to produce maps per period, for 10 years or more for
> forest management regimes in forest stand.
>
> Any alternative?
>
> Thanks in advance.
>
> Noli
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Jan  6 08:45:22 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Jan 2010 08:45:22 +0100 (CET)
Subject: [R-sig-Geo] Question about a spatial non-square cells error in R
In-Reply-To: <63F107BCC37AEA49A75FD94AA3E07CB005312229@pacpbsex01.pac.dfo-mpo.ca>
References: <63F107BCC37AEA49A75FD94AA3E07CB005312229@pacpbsex01.pac.dfo-mpo.ca>
Message-ID: <alpine.LRH.2.00.1001060827240.20241@reclus.nhh.no>

On Tue, 5 Jan 2010, Mailhiot, Joshua wrote:

> Hi folks,
>
> Long-time lurker, first time poster here. I have a conundrum that
> perhaps you might have come across. I'm getting an error when I try to
> compile some of my R spatial code:
>
> Error in write.asciigrid(xx2_res["NPHS"], newHSmap_asc, attr = 1,
> na.value = -9999) :
>  Asciigrid does not support grids with non-square cells
>
> This is telling me that the xy grid I'm working with is using cells that
> aren't exactly square. This is very curious, so I checked out the
> structure of the object I'm working with:

Josh:

You have print()ed the values with more digits, but all.equal() - 
handling fuzz - and identical() may not be the same:

cs <- slot(slot(xx2_res, "grid"), "cellsize")
all.equal(cs[1], cs[2])
identical(cs[1], cs[2])
cs[1] == cs[2]

The function uses == internally. Repair by assigning 
rep(mean(cs), 2) to slot(slot(xx2_res, "grid"), "cellsize")

slot(slot(xx2_res, "grid"), "cellsize") <- rep(mean(cs), 2)

and check:

cs <- slot(slot(xx2_res, "grid"), "cellsize")
all.equal(cs[1], cs[2])
identical(cs[1], cs[2])

If this doesn't resolve the problem, please try the equivalent driver in 
rgdal in writeGDAL(). I'm seeing differences at the 1e-13 level being 
detected on my platform (Linux 64-bit), but all IEEE double precision 
machines should perform in the same way.

Roger
>
>
>> str(xx2_res)
> Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
>  ..@ data       :'data.frame': 480760 obs. of  9 variables:
>  .. ..$ v      : num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  .. ..$ paID   : num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  .. ..$ patchD : num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  .. ..$ NP1    : logi [1:480760] NA NA NA NA NA NA ...
>  .. ..$ preNP2 : logi [1:480760] NA NA NA NA NA NA ...
>  .. ..$ NP2    : num [1:480760] NA NA NA NA NA NA NA NA NA NA ...
>  .. ..$ out2   : num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  .. ..$ HSvalue: num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  .. ..$ NPHS   : num [1:480760] 0 0 0 0 0 0 0 0 0 0 ...
>  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3
> slots
>  .. .. ..@ cellcentre.offset: Named num [1:2] 780952 363416
>  .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>  .. .. ..@ cellsize         : Named num [1:2] 500 500
>  .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>  .. .. ..@ cells.dim        : Named int [1:2] 808 595
>  .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>  ..@ grid.index : int(0)
>  ..@ coords     : num [1:2, 1:2] 780952 1184452 363416 660416
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : NULL
>  .. .. ..$ : chr [1:2] "s1" "s2"
>  ..@ bbox       : num [1:2, 1:2] 780702 363166 1184702 660666
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : chr [1:2] "s1" "s2"
>  .. .. ..$ : chr [1:2] "min" "max"
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr NA
>
>
> Or, the cell sizes extracted from that structure above:
>
>> print(slot(slot(xx2_res, "grid"), "cellsize"), digits=20)
> s1  s2
> 500 500
>
>
> Having both s1 and s2 being equal in the cell size slot indicates a
> square cell, as was shown in advice given in a similar problem in this
> usergroup. When I searched this error elsewhere and here, the problem
> tends to be that there is a "fuzziness" in the cell size numbers (way
> down in the decimals, like 500.000000002 x 500.000000000004) that is
> solved by rounding or forcing. That does not appear to be the case in my
> issue.
>
> Have any of you come across this error before? Is there something
> obvious I'm missing here, perhaps?
>
> Thanks for any assistance!
>
> Cheers,
> Josh
>
> Joshua Mailhiot
> Aquatic Science Biologist
> Pacific Biological Station
> Fisheries and Oceans Canada
> 3190 Hammond Bay Road, Nanaimo, BC V9T 6N7
> Joshua.Mailhiot at dfo-mpo.gc.ca
> Telephone: 250-729-8381
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Wed Jan  6 09:44:25 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 6 Jan 2010 08:44:25 +0000
Subject: [R-sig-Geo] Creating random (but believable) geographies
In-Reply-To: <d8ad40b51001041446l5ace86cv133365798a7bc240@mail.gmail.com>
References: <d8ad40b50912280233t3ace4156uac152ef8bc009c3a@mail.gmail.com>
	<4B389493.6050000@bitwrit.com.au>
	<d8ad40b51001041446l5ace86cv133365798a7bc240@mail.gmail.com>
Message-ID: <d8ad40b51001060044p7aa0247dp10c2b36fd5ad4139@mail.gmail.com>

There's been a bit of interest in my code so I'll try and make an R
package out of it very soon.

Also I've discovered some slight modification can make
authentic-looking river networks - I've added a bit to my blog post to
show what they look like - scroll to bottom of:

 http://geospaced.blogspot.com/2010/01/generating-fake-geographies.html

That's what I did yesterday instead of packaging the existing code -
sorry, but I can't help tinkering!

Barry


From nsicad at gmail.com  Wed Jan  6 09:44:52 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Wed, 6 Jan 2010 15:44:52 +0700
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon
	in spplot / plot - possible?
In-Reply-To: <alpine.LRH.2.00.1001060825400.20241@reclus.nhh.no>
References: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
	<alpine.LRH.2.00.1001060825400.20241@reclus.nhh.no>
Message-ID: <f7bd71731001060044v22596388ma7845c82bb44c5a6@mail.gmail.com>

> Review ?reshape to convert to wide format before trying to merge into
> your object for using spplot().
>
> Roger

OK. The answer is not possible.

I have been studying reshape - cast and melt.  The illustration submit
in my earlier post, can be easily done. But here is the real data
(below) is bit harder.

I have more problem deleting shapefile polygons that doesn't have data
in dbf.  I am just learning to use R in the last weeks. I have to find
some example script how to do polygon delete. I am reading sp package.
Searching in the archives of various list.

Thanks, Noli
~~~~~~~~~


Input data

C_ID    CROP  Period    Age
83      SORI    1       31
84      SORI    1       32
85      SORI    1       33
86      SORI          1        34
82      SORI       2            28
83      SORI        2   29
84      SORI       2    30
93      SORM    2       35
62      OTRM    3       30
82      SORI        3      27
3       SORM    3       35
82      SORI    4       26
4       SORM    4       34
5       OTRI           5                25
5       OTRM    5       29
5       SORM    5       32
5       SORM    5       33
5       SORM    5       35
6       OTRI    6       22
6       OTRI         6       23
6       OTRI       6        24
6       OTRM    6       26
6       OTRM    6       27
6       OTRM    6       28
7       OTRM    7       26
8       OTRM    8       26
9       OTRM    9       26
10      OTRM    10      24
10      OTRM    10      25
10      OTRM    10      26
10      SORM    10      31

Desired table
C_ID    CROP    P 1     P 2     P 3     P 4     P 5     P 6     P 7
 P 8     P 9     P 10
- Hide quoted text -
83      SORI      31
84      SORI      32
85      SORI      33
86      SORI      34
82      SORI            28
83      SORI            29
84      SORI            30
93      SORM            35
62      OTRM            30
82      SORI                    27
3       SORM                    35
82      SORI                            26
4       SORM                            34
5       OTRI                                    25
5       OTRM                                    29
5       SORM                                    32
5       SORM                                    33
5       SORM                                    35
6       OTRI                                            22
6       OTRI                                            23
6       OTRI                                            24
6       OTRM                                            26
6       OTRM                                            27
6       OTRM                                            28
7       OTRM                                                    26
8       OTRM                                                            26
9       OTRM
         26
10      OTRM
                 24
10      OTRM
                 25
10      OTRM
                 26
10      SORM
                 31


From Roger.Bivand at nhh.no  Wed Jan  6 10:07:51 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Jan 2010 10:07:51 +0100 (CET)
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon
 in spplot / plot - possible?
In-Reply-To: <f7bd71731001060044v22596388ma7845c82bb44c5a6@mail.gmail.com>
References: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
	<alpine.LRH.2.00.1001060825400.20241@reclus.nhh.no>
	<f7bd71731001060044v22596388ma7845c82bb44c5a6@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001061004080.20241@reclus.nhh.no>

On Wed, 6 Jan 2010, Noli Sicad wrote:

>> Review ?reshape to convert to wide format before trying to merge into
>> your object for using spplot().
>>
>> Roger
>
> OK. The answer is not possible.
>
> I have been studying reshape - cast and melt.  The illustration submit
> in my earlier post, can be easily done. But here is the real data
> (below) is bit harder.

If you start with reshape in the stats package, not the reshape package, 
it may be easier. Using reshape is always hard, but the wide format is 
what you need. There is no provision for one-to-many for spatial features.

>
> I have more problem deleting shapefile polygons that doesn't have data
> in dbf.  I am just learning to use R in the last weeks. I have to find
> some example script how to do polygon delete. I am reading sp package.
> Searching in the archives of various list.

You delete spatial features from a Spatial* or Spatial*DataFrame object in 
the usual way with the "[" operator. Just treat them as data.frame objects 
as a first approximation.

Roger

>
> Thanks, Noli
> ~~~~~~~~~
>
>
> Input data
>
> C_ID    CROP  Period    Age
> 83      SORI    1       31
> 84      SORI    1       32
> 85      SORI    1       33
> 86      SORI          1        34
> 82      SORI       2            28
> 83      SORI        2   29
> 84      SORI       2    30
> 93      SORM    2       35
> 62      OTRM    3       30
> 82      SORI        3      27
> 3       SORM    3       35
> 82      SORI    4       26
> 4       SORM    4       34
> 5       OTRI           5                25
> 5       OTRM    5       29
> 5       SORM    5       32
> 5       SORM    5       33
> 5       SORM    5       35
> 6       OTRI    6       22
> 6       OTRI         6       23
> 6       OTRI       6        24
> 6       OTRM    6       26
> 6       OTRM    6       27
> 6       OTRM    6       28
> 7       OTRM    7       26
> 8       OTRM    8       26
> 9       OTRM    9       26
> 10      OTRM    10      24
> 10      OTRM    10      25
> 10      OTRM    10      26
> 10      SORM    10      31
>
> Desired table
> C_ID    CROP    P 1     P 2     P 3     P 4     P 5     P 6     P 7
> P 8     P 9     P 10
> - Hide quoted text -
> 83      SORI      31
> 84      SORI      32
> 85      SORI      33
> 86      SORI      34
> 82      SORI            28
> 83      SORI            29
> 84      SORI            30
> 93      SORM            35
> 62      OTRM            30
> 82      SORI                    27
> 3       SORM                    35
> 82      SORI                            26
> 4       SORM                            34
> 5       OTRI                                    25
> 5       OTRM                                    29
> 5       SORM                                    32
> 5       SORM                                    33
> 5       SORM                                    35
> 6       OTRI                                            22
> 6       OTRI                                            23
> 6       OTRI                                            24
> 6       OTRM                                            26
> 6       OTRM                                            27
> 6       OTRM                                            28
> 7       OTRM                                                    26
> 8       OTRM                                                            26
> 9       OTRM
>         26
> 10      OTRM
>                 24
> 10      OTRM
>                 25
> 10      OTRM
>                 26
> 10      SORM
>                 31
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Wed Jan  6 10:23:02 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 6 Jan 2010 09:23:02 +0000
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon
	in spplot / plot - possible?
In-Reply-To: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
References: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
Message-ID: <d8ad40b51001060123j42259d0hb91808fab1eef8ea@mail.gmail.com>

On Wed, Jan 6, 2010 at 6:16 AM, Noli Sicad <nsicad at gmail.com> wrote:
> Hi,
>
> I have problem transposing my database table which is to be merged /
> joined with the shapefile file (*.dbf) inorder to have one-to-one
> relationship with shapefile polygon. As we know that inorder for the
> polygon to be rendered in GIS, it has to have one-to-ope relationship.

 Depends on your GIS! Shapefiles only have a 1-1 relationship, but
that's because they are a bit rubbish. If you use a proper spatial
database then you can do one-many. This is an application for a
PostGIS or Spatialite database, and if your GIS can read that (Qgis
for example) then you are sorted.

> One to many table:
>
> Poly_ID Period Age
> 01 ? ? ? ? ? 1 ? ? ? 32
> 01 ? ? ? ? ? 2 ? ? ? 34
> 02 ? ? ? ? ? 1 ? ? ? 30
> 03 ? ? ? ? ? 2 ? ? ? 21
>
>
> One to one table
>
> Poly_ID Period1 Period2 Period3
> 01 ? ? ? ? ? ?32 ? ? ? ? ? 34
> 02 ? ? ? ? ? ? 30
> 03 ? ? ? ? ? ? ? ? ? ? ? ? ? 21
> 04 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?35
>
> Now, ?is it possible to use one-to-many table for mapping using spplot / plot?
>
> The result data I am trying to map using spplot has 1 to 70 years
> periods. I want to produce maps per period, for 10 years or more for
> forest management regimes in forest stand.

 I wouldn't reshape the data in R to create a possibly sparse matrix,
and then have to code in column names with expressions (e.g.
data[,paste("Year",y,sep="")], which I think is icky). I would just
create a spatial polygons/points data set with just an ID column, and
put your ID/Period/Age data in a non-spatial data frame. Then when you
want to plot a particular thing, just match up the data with the
spatial data and plot (using the 'match' function).

Barry


From nsicad at gmail.com  Wed Jan  6 11:05:57 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Wed, 6 Jan 2010 17:05:57 +0700
Subject: [R-sig-Geo] One-to-many table relationship to shapefile polygon
	in spplot / plot - possible?
In-Reply-To: <d8ad40b51001060123j42259d0hb91808fab1eef8ea@mail.gmail.com>
References: <f7bd71731001052216x2d542776mf4a89dde95f0b8c8@mail.gmail.com>
	<d8ad40b51001060123j42259d0hb91808fab1eef8ea@mail.gmail.com>
Message-ID: <f7bd71731001060205h56336680sc90c687ae79b9fb4@mail.gmail.com>

>  Depends on your GIS! Shapefiles only have a 1-1 relationship, but
> that's because they are a bit rubbish. If you use a proper spatial
> database then you can do one-many. This is an application for a
> PostGIS or Spatialite database, and if your GIS can read that (Qgis
> for example) then you are sorted.

I want to do it in R. R can do quick and pretty graphs and maps!


>> The result data I am trying to map using spplot has 1 to 70 years
>> periods. I want to produce maps per period, for 10 years or more for
>> forest management regimes in forest stand.
>
>  I wouldn't reshape the data in R to create a possibly sparse matrix,
> and then have to code in column names with expressions (e.g.
> data[,paste("Year",y,sep="")], which I think is icky). I would just
> create a spatial polygons/points data set with just an ID column, and
> put your ID/Period/Age data in a non-spatial data frame. Then when you
> want to plot a particular thing, just match up the data with the
> spatial data and plot (using the 'match' function).

This is what actually I wanted!

"column names with expressions (e.g. data[,paste("Year",y,sep="")]" in
shapefile database?

Yes, created Crop_ID which is supposed to be Polygon ID in my
foreststand.dbf. I have also Crop_ID, Period, Age in non spatial table
i.e. harvest.dbf

This is the harvest.dbf
names(harvest.dat) = c("CROP_ID", "CROPTYPE",
"Period","Ini_Age","Cut_Age", "Area_Cut")

Barry, any snippet how to use match in spplot or plot.

Thanks. Noli


From hengl at spatial-analyst.net  Wed Jan  6 13:00:51 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 06 Jan 2010 13:00:51 +0100
Subject: [R-sig-Geo] Kriging concept question
In-Reply-To: <EDB94195DABE64488928DD39E53B8FC68BDFD3E93E@REX2.intranet.epfl.ch>
References: <EDB94195DABE64488928DD39E53B8FC68BDFD3E93E@REX2.intranet.epfl.ch>
Message-ID: <4B447B73.2050108@spatial-analyst.net>

Tobin Cara wrote:
> Hello,
> 
> I have recently read an interesting article about integrating Limited Area Models (LAMs) into kriging with external drift for temperature (Libert? et al. link below).
> 
> www.wmo.int/pages/prog/www/IMOP/.../IOM.../P2(05)_Perini_Italy.doc

This URL is incomplete. Please check.

> 
> As I understand, it seems that the authors generated variograms with the differences between the closest LAM grid point and the ground point. Then, they used kriging with external drift where the ground observation stations were the primary data and the secondary data was the LAM.
> 
> Conceptually, is it possible to generate a variogram with differences and then krig the data rather than the differences?

I am not 100% sure what do you mean by "differences". If you mean 
residuals, then the answer is positive (the variogram HAS to be of the 
residuals and not of the target variable). KED (or what I prefer to call 
regression-kriging) in a moving window is in fact probably more general 
approach than global analysis. For example you can be very relaxed about 
stationarity assumptions. The problem is that, for each prediction 
point, you will need to fit both the trend model (LAM?) and estimate a 
local variogram (using global variogram and local regression models 
means 'cheating'), which is probably very time consuming! In fact, I am 
not aware of any applications of KED with moving window (maybe I missed 
some?).

For more info see also section 2.2 in my book:
http://spatial-analyst.net/book/Regressionkriging

HTH

T. Hengl
GEOSTAT 2010 - THE Spatial Data Analysis event of the year!
http://geostat2010.info

> 
> I would appreciate anyone's explanations or corrections to my understanding.
> 
> Thank you,
> 
> Cara
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From marco.helbich at gmx.at  Wed Jan  6 13:49:47 2010
From: marco.helbich at gmx.at (Marco Helbich)
Date: Wed, 06 Jan 2010 13:49:47 +0100
Subject: [R-sig-Geo] mixed geographically weighted regression
In-Reply-To: <alpine.LRH.2.00.1001051852420.16833@reclus.nhh.no>
References: <20100105162421.175140@gmx.net>
	<alpine.LRH.2.00.1001051745370.16833@reclus.nhh.no>
	<20100105175039.175120@gmx.net>
	<alpine.LRH.2.00.1001051852420.16833@reclus.nhh.no>
Message-ID: <20100106124947.245010@gmx.net>

Great, thank you for giving me a hand!

Best regards
Marco


-------- Original-Nachricht --------
> Datum: Tue, 5 Jan 2010 18:54:08 +0100 (CET)
> Von: Roger Bivand <Roger.Bivand at nhh.no>
> An: Marco Helbich <marco.helbich at gmx.at>
> CC: r-sig-geo at stat.math.ethz.ch
> Betreff: Re: [R-sig-Geo] mixed geographically weighted regression

> On Tue, 5 Jan 2010, Marco Helbich wrote:
> 
> > Dear Roger,
> >
> > thank you for your quick response!
> >
> > If I understand it correctly, the hat matrix is calculated using all 
> > explanatory variables. In my case, however, I would need to restrict the
> > column space to those covariates where I assume varying coefficients (as
> > in eq. (3)), and for this purpose I would need to calculate S_v by hand.
> > Therefore, I would need the weight matrices for every observation. Or is
> > there an easier way?
> 
> Naturally. Use the hat matrix from a regular GWR fit with only X_v 
> included, as the paper (seems to) describe.
> 
> Roger
> 
> >
> > Kind regards,
> >
> > Marco
> >
> >
> > -------- Original-Nachricht --------
> >> Datum: Tue, 5 Jan 2010 18:00:50 +0100 (CET)
> >> Von: Roger Bivand <Roger.Bivand at nhh.no>
> >> An: Marco Helbich <marco.helbich at gmx.at>
> >> CC: r-sig-geo at stat.math.ethz.ch
> >> Betreff: Re: [R-sig-Geo] mixed geographically weighted regression
> >
> >> On Tue, 5 Jan 2010, Marco Helbich wrote:
> >>
> >>> Dear list,
> >>>
> >>> I am trying to fit a mixed geographically weighted regression model
> >> (with adaptive kernel) using the spgwr package, i.e. I want to hold
> some of the
> >> coefficients fixed at the global level. Thus, I have the following
> >> questions:
> >>>
> >>> 1. Which is the most efficient way to estimate such a model?
> >>> a) I found the posting
> >> http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg00984.html
> where Roger recommended to first fit a global model,
> >> then the GWR using the residuals.
> >>> b) The method proposed in Mei et al. (2006,  pp. 588-589, see
> >> http://www.envplan.com/abstract.cgi?id=a3768) first computes the
> projection matrix of
> >> the locally varying part (called S_v) and uses this in a second step to
> >> derive the fixed coefficients (this seems to me like an application of
> the
> >> FWL-theorem see http://en.wikipedia.org/wiki/FWL_theorem).
> >>>
> >>> 2. In order to follow this method, I first have to find the kernel
> >>> weights at each point. The help-file says that these can be found in
> the
> >>> SpatialPointsDataFrame (SDF), but I could not get it from there. Where
> >>> can I extract them?
> >>
> >> The sums of weights for each fit point are in the returned object, but
> >> this is not what you (do not) want. The S_v matrix in the paper (eq. 3)
> is
> >> returned as the hat matrix, I believe. Since you have S_v, you do not
> need
> >> the W(u_i, v_i) weights (a diagonal matrix for each fit (and data)
> point
> >> i). Given S_v, the unnumbered equation in the middle of the page gives
> you
> >> \hat{\beta_c}, doesn't it? I think that I would pre-multiply X_c and Y
> by
> >> (I - S_v), then use QR methods to complete, if I wanted to proceed with
> >> this.
> >>
> >> Because of concerns about how these things are done, and how they are
> >> represented in the literature, I'd look for corrobotation - being able
> to
> >> reproduce others' published results for example.
> >>
> >> Hope this helps,
> >>
> >> Roger
> >>
> >>>
> >>> We are using such a code:
> >>> library(spgwr)
> >>> data(georgia)
> >>> g.adapt.gauss <- gwr.sel(PctBach ~ TotPop90 + PctRural + PctEld +
> PctFB
> >> + PctPov + PctBlack, data=gSRDF, adapt=TRUE)
> >>> res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB +
> PctPov
> >> + PctBlack, data=gSRDF, adapt=g.adapt.gauss)
> >>> res.adpt$SDF
> >>>
> >>> I hope my problem is clear and appreciate every hint! Thank you!
> >>>
> >>> Best regards
> >>> Marco
> >>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Economic Geography Section, Department of Economics, Norwegian School
> of
> >> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >> e-mail: Roger.Bivand at nhh.no
> >
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

-- 
Preisknaller: GMX DSL Flatrate f?r nur 16,99 Euro/mtl.!
http://portal.gmx.net/de/go/dsl02


From hi_ono2001 at ybb.ne.jp  Wed Jan  6 15:04:24 2010
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Wed, 6 Jan 2010 23:04:24 +0900 (JST)
Subject: [R-sig-Geo] Testing if a point-pattern is on a regular grid
In-Reply-To: <alpine.LRH.2.00.1001060816470.20241@reclus.nhh.no>
Message-ID: <20100106140424.49418.qmail@web10514.mail.ogk.yahoo.co.jp>

Hello.

 I have an idea using Thiessenn or voronoi by tripack.

 Extending this "points2grid()" method for grid polygon
data will make calculation of spatial weight matrices of
spdep better?


 Regards   

--- Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 6 Jan 2010, Pierre Roudier wrote:
> 
> > Dear list,
> >
> > I'm looking for an easy way to test if a point
> pattern (I got a data
> > frame of x and y coordinates) is on a regular grid
> or not.
> >
> > I'm aware of the gridded() function in sp(), but
> this function is
> > devoted to assign rather than to test, as far as I
> know. I'm pretty
> > sure there's an easy way to do that though....
> 
> Use try(points2grid()) - if this returns an object
> of class "try-error", 
> the points do not lie on a grid.
> 
> Roger
> 
> >
> > Any suggestions ?
> >
> > Thanks,
> >
> > Pierre
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics,
> Norwegian School of
> Economics and Business Administration, Helleveien
> 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From pierre.roudier at gmail.com  Thu Jan  7 01:01:39 2010
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Thu, 7 Jan 2010 11:01:39 +1100
Subject: [R-sig-Geo] Testing if a point-pattern is on a regular grid
In-Reply-To: <alpine.LRH.2.00.1001060816470.20241@reclus.nhh.no>
References: <e4178da61001052104i4fe7e4d7w8d1e5c0bfd17a278@mail.gmail.com> 
	<alpine.LRH.2.00.1001060816470.20241@reclus.nhh.no>
Message-ID: <e4178da61001061601x5c426c19pb4d4e09dab27e9e2@mail.gmail.com>

Thanks Roger.

Exactly what I was looking for.

Pierre

2010/1/6 Roger Bivand <Roger.Bivand at nhh.no>:
> On Wed, 6 Jan 2010, Pierre Roudier wrote:
>
>> Dear list,
>>
>> I'm looking for an easy way to test if a point pattern (I got a data
>> frame of x and y coordinates) is on a regular grid or not.
>>
>> I'm aware of the gridded() function in sp(), but this function is
>> devoted to assign rather than to test, as far as I know. I'm pretty
>> sure there's an easy way to do that though....
>
> Use try(points2grid()) - if this returns an object of class "try-error", the
> points do not lie on a grid.
>
> Roger
>
>>
>> Any suggestions ?
>>
>> Thanks,
>>
>> Pierre
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


From nsicad at gmail.com  Thu Jan  7 05:31:15 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Thu, 7 Jan 2010 11:31:15 +0700
Subject: [R-sig-Geo] Deleting shapefile polygon with no attribute / record
Message-ID: <f7bd71731001062031r8ca588o509dfc82440cce1d@mail.gmail.com>

# Deleting shapefile polygons that doesn't much with record in the
merge dbf file

I want to do:
1. Delete polygons that doesn't have a match with record in joined /
merge table of the shapefile.
    (Done transpose and merging - joined to one-to-one relationship already.)
2. Create a subset of the polygon and save shapefile or just save the
revise shapefile
3. Open in shapefile in QGIS and do spplot.

~~~~~~~~~~~~~~
from 1 to 93 polygon
   if table ID == polygon_ID then print("Polygon OK")
       else delete the polygon

How do I delete the polygon and save?

~~~~~~~~~~~~~	
getwd()
setwd('C:\\Down2\\R_forestmgt\\modelIII\\')

library(rgdal)

forest <- readOGR(".",  "ForestStand")

forest.dat <- slot(forest, "data") <------ is this necessary?
xlength<-nrow(forest.dat)

for (i in 1:xlength)
       if (forest.dat$ID[x] == forest[ID[x] {print("Polygon OK")
	} else { Delele Polygon}	

writeOGR(forest, ".", "ForestStandNew", "ESRI Shapefile")
~~~~~~~~~~~~~~~~~

The script above doesn't run because I don't know how to delete
polygons. Any ideas how to do this?


Thanks in advance.

Noli


From nsicad at gmail.com  Thu Jan  7 07:43:49 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Thu, 7 Jan 2010 13:43:49 +0700
Subject: [R-sig-Geo] subsetting shapefile polygons with separate table
	criteria
Message-ID: <f7bd71731001062243p144707b8m23a5c4cd9314b3d5@mail.gmail.com>

# Subseting shapefile before merging tables - join table

I realised that deleting the polygon with does match wit the record is
not possible since, I can read the shapefile at all. But still I need
to know how to delete / subset polygons.

I think this is more workable.

1. Read shapefile polygons from foreststand.shp
2. Match harvest.dbf table with polygon ID foreststand.shp
3. Subset shapefile polygon that matches
4. Write subset into a new shapefile

~~~~~~~~~~~
getwd()
setwd('C:\\Down2\\R_forestmgt\\modelIII\\')

library(rgdal)
library(maptools)

#forest <- readOGR(".",  "ForestStand")

forest <- readShapePoly("ForestStand")

harvest< read.csv('forest_cut.csv')

#Match

index <- match(harvest$CROP_ID, forest$CROP_ID , nomatch = 0)

# subset polygon.
# use this index here for setting

mypoly <- subset(forest,            Index)

#Save shapefile
writeOGR(mypoly, ".", "ForestStandNew", "ESRI Shapefile")

~~~~~~~~~~~~

Any ideas how to do this?

Thanks in advance.

Noli


From Roger.Bivand at nhh.no  Thu Jan  7 08:07:26 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Jan 2010 08:07:26 +0100 (CET)
Subject: [R-sig-Geo] Deleting shapefile polygon with no attribute /
 record
In-Reply-To: <f7bd71731001062031r8ca588o509dfc82440cce1d@mail.gmail.com>
References: <f7bd71731001062031r8ca588o509dfc82440cce1d@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001070801030.24246@reclus.nhh.no>

On Thu, 7 Jan 2010, Noli Sicad wrote:

> # Deleting shapefile polygons that doesn't much with record in the
> merge dbf file

I have already told you to use "["

new_obj <- obj[keep,]

where keep may be an integer vector of row numbers, a logical vector of 
TRUE/FALSE values, or (for newer versions of sp) a negative integer vector 
of entities to drop. So maybe:

keep <- !is.na(obj$x)

As I said before, think of Spatial*DataFrame objects as data.frame objects 
and use the same operators as a first approximation which will usually 
work, as indeed it has to for Spatial*DataFrame objects to function as the 
data= argument in the (formula, data) S language White Book abstraction 
that underpins most analysis in S/R.

Roger

>
> I want to do:
> 1. Delete polygons that doesn't have a match with record in joined /
> merge table of the shapefile.
>    (Done transpose and merging - joined to one-to-one relationship already.)
> 2. Create a subset of the polygon and save shapefile or just save the
> revise shapefile
> 3. Open in shapefile in QGIS and do spplot.
>
> ~~~~~~~~~~~~~~
> from 1 to 93 polygon
>   if table ID == polygon_ID then print("Polygon OK")
>       else delete the polygon
>
> How do I delete the polygon and save?
>
> ~~~~~~~~~~~~~
> getwd()
> setwd('C:\\Down2\\R_forestmgt\\modelIII\\')
>
> library(rgdal)
>
> forest <- readOGR(".",  "ForestStand")
>
> forest.dat <- slot(forest, "data") <------ is this necessary?
> xlength<-nrow(forest.dat)
>
> for (i in 1:xlength)
>       if (forest.dat$ID[x] == forest[ID[x] {print("Polygon OK")
> 	} else { Delele Polygon}
>
> writeOGR(forest, ".", "ForestStandNew", "ESRI Shapefile")
> ~~~~~~~~~~~~~~~~~
>
> The script above doesn't run because I don't know how to delete
> polygons. Any ideas how to do this?
>
>
> Thanks in advance.
>
> Noli
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kevin.middel at ontario.ca  Thu Jan  7 16:48:37 2010
From: kevin.middel at ontario.ca (Middel, Kevin (MNR))
Date: Thu, 7 Jan 2010 10:48:37 -0500
Subject: [R-sig-Geo] Problems reading netcdf with RGDAL
Message-ID: <CCDDC32576408C439603A89A635A892A05D2AFC4@CTSPITDCEMMVX12.cihs.ad.gov.on.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100107/12b70c09/attachment.pl>

From Roger.Bivand at nhh.no  Thu Jan  7 18:16:27 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Jan 2010 18:16:27 +0100 (CET)
Subject: [R-sig-Geo] Problems reading netcdf with RGDAL
In-Reply-To: <CCDDC32576408C439603A89A635A892A05D2AFC4@CTSPITDCEMMVX12.cihs.ad.gov.on.ca>
References: <CCDDC32576408C439603A89A635A892A05D2AFC4@CTSPITDCEMMVX12.cihs.ad.gov.on.ca>
Message-ID: <alpine.LRH.2.00.1001071809270.28869@reclus.nhh.no>

On Thu, 7 Jan 2010, Middel, Kevin (MNR) wrote:

> Hi,
>
> I am trying to read a netcdf file and create spatial grid files
> compatible with a GIS from the various time arrays, but ran into a
> problem right off with rgdal.  The .nc file contains daily air
> temperatures across North America for a given year.
>
>
>
> Using the command:
>> GDALinfo("air.2m.1979.nc")

Where is your sessionInfo() information? Does gdalDrivers() include the 
NetCDF driver (no, you are on Windows using the standard binary rgdal 
package - guesses based on the file path quoted below)? Have you read 
file.show(system.file("README.windows", package="rgdal")), which tells you 
how to install rgdal from source on Windows to access extra drivers 
depending on external software?

The user needing more exotic drivers (those not provided by GDAL itself) 
has to provide the external dependencies and install from the source 
package on all platforms. If ncdf can import the data, please use that if 
you do not want to install rgdal from source.

Hope this helps,

Roger

>
>
> I get the error:
> CPL ERROR 4: `air.2m.1979.nc' not recognised as a supported file format.
>
>
>
> Error in .local(.Object, ...) :
>
>  `air.2m.1979.nc' not recognised as a supported file format.
>
>
>
> I am able read the file using the package ncdf, and the utility ncdump,
> as well as view the data in panoply, so I'm not sure what I'm doing
> incorrectly.   I've also tried using FWTools to view the data and in
> this program the image is inverted (N-S).  Finally I've had a look at
> the data using GDALInfo installed with FWTools and have pasted the
> output below, as well as the output from NCDump.
>
>
>
> It's probably pretty obvious that I'm new to this format, so any
> help/guidance anyone can provide would be greatly appreciated.
>
>
>
> Thanks in advance,
>
> Kevin
>
>
>
> GDALInfo Output:
>
>
>
> Driver: netCDF/Network Common Data Format
>
> Files: d:\databases\climate\narr\air.2m.1979.nc
>
> Size is 512, 512
>
> Coordinate System is `'
>
> Metadata:
>
>  NC_GLOBAL#standardpar1=50
>
>  NC_GLOBAL#standardpar2=50
>
>  NC_GLOBAL#centerlon=-107
>
>  NC_GLOBAL#centerlat=50
>
>  NC_GLOBAL#latcorners=1.000001e+000, 8.979450e-001, 4.635440e+001,
> 4.663433e+001
>
>  NC_GLOBAL#loncorners=-1.455000e+002, -6.832005e+001, -2.569891e+000,
> 1.486418e+002
>
>  NC_GLOBAL#stream=s1
>
>  NC_GLOBAL#title=Daily NARR
>
>  NC_GLOBAL#Conventions=CF-1.0
>
>  NC_GLOBAL#history=On Thu Feb  9 16:48:19 2006 single precision time
> renamed oldtime,
>
> values transferred to double precision new time variable.
>
> created 2005 by Jeff Whitaker
>
>  NC_GLOBAL#institution=National Centers for Environmental Prediction
>
>  NC_GLOBAL#platform=Model
>
>
> NC_GLOBAL#references=http://wwwt.emc.ncep.noaa.gov/mmb/rreanl/index.html
>
> http://www.cdc.noaa.gov/cdc/data.narr.html
>
> Subdatasets:
>
>
> SUBDATASET_1_NAME=NETCDF:"d:\databases\climate\narr\air.2m.1979.nc":lat
>
>  SUBDATASET_1_DESC=[277x349] latitude (32-bit floating-point)
>
>
> SUBDATASET_2_NAME=NETCDF:"d:\databases\climate\narr\air.2m.1979.nc":lon
>
>  SUBDATASET_2_DESC=[277x349] longitude (32-bit floating-point)
>
>
> SUBDATASET_3_NAME=NETCDF:"d:\databases\climate\narr\air.2m.1979.nc":time
> _bnds
>
>  SUBDATASET_3_DESC=[365x2] time_bnds (64-bit floating-point)
>
>
> SUBDATASET_4_NAME=NETCDF:"d:\databases\climate\narr\air.2m.1979.nc":air
>
>  SUBDATASET_4_DESC=[365x277x349] air_temperature (8-bit integer)
>
> Corner Coordinates:
>
> Upper Left  (    0.0,    0.0)
>
> Lower Left  (    0.0,  512.0)
>
> Upper Right (  512.0,    0.0)
>
> Lower Right (  512.0,  512.0)
>
> Center      (  256.0,  256.0)
>
>
>
>
>
> NCDump Output:
>
>
>
> netcdf air.2m.1979 {
>
> dimensions:
>
>        time = UNLIMITED ; // (365 currently)
>
>        y = 277 ;
>
>        x = 349 ;
>
>        nbnds = 2 ;
>
> variables:
>
>        float lat(y, x) ;
>
>                lat:long_name = "latitude coordinate" ;
>
>                lat:units = "degrees_north" ;
>
>                lat:axis = "Y" ;
>
>                lat:coordinate_defines = "point" ;
>
>                lat:standard_name = "latitude" ;
>
>        float lon(y, x) ;
>
>                lon:units = "degrees_east" ;
>
>                lon:long_name = "longitude coordinate" ;
>
>                lon:axis = "X" ;
>
>                lon:coordinate_defines = "point" ;
>
>                lon:standard_name = "longitude" ;
>
>        float x(x) ;
>
>                x:long_name = "eastward distance from southwest corner
> of domain in projection coordinates" ;
>
>                x:units = "m" ;
>
>                x:standard_name = "projection_x_coordinate" ;
>
>        float y(y) ;
>
>                y:long_name = "northward distance from southwest corner
> of domain in projection coordinates" ;
>
>                y:units = "m" ;
>
>                y:standard_name = "projection_y_coordinate" ;
>
>        int Lambert_Conformal ;
>
>                Lambert_Conformal:grid_mapping_name =
> "lambert_conformal_conic" ;
>
>                Lambert_Conformal:standard_parallel = 50., 50. ;
>
>                Lambert_Conformal:longitude_of_central_meridian = -107.
> ;
>
>                Lambert_Conformal:latitude_of_projection_origin = 50. ;
>
>                Lambert_Conformal:false_easting = 5632642.22547 ;
>
>                Lambert_Conformal:false_northing = 4612545.65137 ;
>
>        double time(time) ;
>
>                time:units = "hours since 1800-1-1 00:00:0.0" ;
>
>                time:long_name = "analysis time" ;
>
>                time:axis = "T" ;
>
>                time:standard_name = "time" ;
>
>                time:coordinate_defines = "start" ;
>
>                time:delta_t = "0000-00-01 00:00:00" ;
>
>                time:actual_range = 1569072., 1577808. ;
>
>                time:avg_period = "0000-00-01 00:00:00" ;
>
>        double time_bnds(time, nbnds) ;
>
>                time_bnds:long_name = "Time Boundaries" ;
>
>        short air(time, y, x) ;
>
>                air:units = "K" ;
>
>                air:long_name = "Daily Air Temperature at 2 m" ;
>
>                air:unpacked_valid_range = 151.f, 400.f ;
>
>                air:precision = 0.003799786f ;
>
>                air:actual_range = 219.7989f, 312.3237f ;
>
>                air:missing_value = 32767s ;
>
>                air:valid_range = -32765s, 32765s ;
>
>                air:_FillValue = -32767s ;
>
>                air:GRIB_name = "TMP" ;
>
>                air:GRIB_id = 11 ;
>
>                air:var_desc = "Air temperature" ;
>
>                air:standard_name = "air_temperature" ;
>
>                air:level_desc = "2 m" ;
>
>                air:dataset = "NARR Daily Averages" ;
>
>                air:statistic = "Mean" ;
>
>                air:parent_stat = "Individual Obs" ;
>
>                air:grid_mapping = "Lambert_Conformal" ;
>
>                air:coordinates = "lat lon" ;
>
>                air:add_offset = 275.5f ;
>
>                air:scale_factor = 0.003799786f ;
>
>                air:cell_methods = "time: mean (of 8 3-hourly values in
> one day)" ;
>
>
>
> // global attributes:
>
>                :standardpar1 = 50. ;
>
>                :standardpar2 = 50.000001 ;
>
>                :centerlon = -107. ;
>
>                :centerlat = 50. ;
>
>                :latcorners = 1.000001f, 0.897945f, 46.3544f, 46.63433f
> ;
>
>                :loncorners = -145.5f, -68.32005f, -2.569891f, 148.6418f
> ;
>
>                :stream = "s1" ;
>
>                :title = "Daily NARR" ;
>
>                :Conventions = "CF-1.0" ;
>
>                :history = "On Thu Feb  9 16:48:19 2006 single precision
> time renamed oldtime,\n",
>
>                        "values transferred to double precision new time
> variable.\n",
>
>                        "created 2005 by Jeff Whitaker" ;
>
>                :institution = "National Centers for Environmental
> Prediction" ;
>
>                :platform = "Model" ;
>
>                :references =
> "http://wwwt.emc.ncep.noaa.gov/mmb/rreanl/index.html\n",
>
>                        "http://www.cdc.noaa.gov/cdc/data.narr.html" ;
>
> }
>
>
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From sdveloz at ucdavis.edu  Thu Jan  7 19:30:08 2010
From: sdveloz at ucdavis.edu (Samuel Veloz)
Date: Thu, 7 Jan 2010 10:30:08 -0800
Subject: [R-sig-Geo] Problems reading netcdf with RGDAL
In-Reply-To: <alpine.LRH.2.00.1001071809270.28869@reclus.nhh.no>
References: <CCDDC32576408C439603A89A635A892A05D2AFC4@CTSPITDCEMMVX12.cihs.ad.gov.on.ca>
	<alpine.LRH.2.00.1001071809270.28869@reclus.nhh.no>
Message-ID: <afa5c2d41001071030t29b84425wf33dba3c298fccea@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100107/0ec55318/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Jan  7 23:53:50 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 7 Jan 2010 22:53:50 +0000
Subject: [R-sig-Geo] Creating random (but believable) geographies
In-Reply-To: <d8ad40b51001041446l5ace86cv133365798a7bc240@mail.gmail.com>
References: <d8ad40b50912280233t3ace4156uac152ef8bc009c3a@mail.gmail.com>
	<4B389493.6050000@bitwrit.com.au>
	<d8ad40b51001041446l5ace86cv133365798a7bc240@mail.gmail.com>
Message-ID: <d8ad40b51001071453r70f12187qfe311aa54ecec131@mail.gmail.com>

Hi all,

 I've bundled my fake region and river generators into a source tarball here:

http://www.maths.lancs.ac.uk/~rowlings/Software/Fakeplace/

 no Windows zip, but there's no C code in it so installation into
Windows isn't that difficult. I wont be building a windows zip until I
get it into R-forge. If someone else wants to import it into R-forge,
then great.

Barry


From florian.endel at gmail.com  Fri Jan  8 01:00:44 2010
From: florian.endel at gmail.com (Florian Endel)
Date: Fri, 08 Jan 2010 01:00:44 +0100
Subject: [R-sig-Geo] spplot - sort legend (colorkey)
Message-ID: <4B4675AC.3090509@gmail.com>

Hi,

I downloaded and ploted maps from http://gadm.org/ for Austria and a 
special province:

### <CODE> ###

library(sp)
library(RColorBrewer)

# load from web
con <- url("http://gadm.org/data/rda/AUT_adm2.RData")
print(load(con)) # gadm hold all the data!
close(con)

# select one province
noe = new("SpatialPolygonsDataFrame")
noe = gadm[gadm$NAME_1=="Nieder\xf6sterreich",]

noe$NAME_1 = factor(noe$NAME_1)
noe$NAME_2 = factor(noe$NAME_2)

# utf8
noe_bez_names = iconv(noe$NAME_2, "ISO_8859-2", "UTF-8")
noe$bez = factor(noe_bez_names)

# plot
col = rainbow(length(levels(noe$bez)))
spplot(noe, zcol="bez", col.regions=col, col="white", scales=list(draw = 
TRUE), colorkey=TRUE)

### </CODE> ###

everything just works fine, but the legend (colorkey) is ordered in the 
wrong direction...

How can I rearrange / sort the legend?

--
greets
FloE


From edzer.pebesma at uni-muenster.de  Fri Jan  8 07:56:44 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 08 Jan 2010 07:56:44 +0100
Subject: [R-sig-Geo] spplot - sort legend (colorkey)
In-Reply-To: <4B4675AC.3090509@gmail.com>
References: <4B4675AC.3090509@gmail.com>
Message-ID: <4B46D72C.2020702@uni-muenster.de>

Florian, please try

noe$bez1 = factor(noe$bez, levels = rev(levels(noe$bez)))
spplot(noe, zcol="bez1", col.regions=rev(col), col="white", 
scales=list(draw = TRUE), colorkey=TRUE)

Florian Endel wrote:
> Hi,
>
> I downloaded and ploted maps from http://gadm.org/ for Austria and a 
> special province:
>
> ### <CODE> ###
>
> library(sp)
> library(RColorBrewer)
>
> # load from web
> con <- url("http://gadm.org/data/rda/AUT_adm2.RData")
> print(load(con)) # gadm hold all the data!
> close(con)
>
> # select one province
> noe = new("SpatialPolygonsDataFrame")
> noe = gadm[gadm$NAME_1=="Nieder\xf6sterreich",]
>
> noe$NAME_1 = factor(noe$NAME_1)
> noe$NAME_2 = factor(noe$NAME_2)
>
> # utf8
> noe_bez_names = iconv(noe$NAME_2, "ISO_8859-2", "UTF-8")
> noe$bez = factor(noe_bez_names)
>
> # plot
> col = rainbow(length(levels(noe$bez)))
> spplot(noe, zcol="bez", col.regions=col, col="white", scales=list(draw 
> = TRUE), colorkey=TRUE)
>
> ### </CODE> ###
>
> everything just works fine, but the legend (colorkey) is ordered in 
> the wrong direction...
>
> How can I rearrange / sort the legend?
>
> -- 
> greets
> FloE
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From bibiko at eva.mpg.de  Fri Jan  8 10:11:20 2010
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Fri, 8 Jan 2010 10:11:20 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
Message-ID: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>

Hi,

I've a tiny question. Is there an annotated river dataset available? By 'annotated' I mean that rivers are ranked by a sort of relevance/size/length or whatever. The problem is that I have an huge SpatialLines object called 'rivers' which shows ~23200 rivers  but I have to draw a map which only shows the most largest ones (let's say 100 to 150) plus one to three rivers for a country.

Many thanks in advance for any hint.

--Hans

From karl at huftis.org  Fri Jan  8 11:40:57 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Fri, 8 Jan 2010 11:40:57 +0100
Subject: [R-sig-Geo] Datum/CRS for the worldHires map data
Message-ID: <MPG.25b12a22b2e730759896c6@news.gmane.org>

Dear list users

I frequently use, and rather like, the worldHires map in 'mapdata'. The 
resolution is quite good (compared to the 'world' map).

However, by overlaying some data on a worldHires map (at around long = 
25.7 and lat = 70.9) I discovered that the map was quite inaccurate. The 
actual shape of the shorelines are quite good, but they are displaced 
(compare the maps with the maps in Google Earth and the shoreline data 
at http://rimmer.ngdc.noaa.gov/mgg/coast/getcoast.html).

The reason is obviously that the worldHires map is not in the WGS 84 
datum (which is reasonable, considering the age of the data). But which 
datum is it in? I could find no information on this in the helpfile, or 
on the referenced Web page? Does anybody on this list know, and perhaps 
have a ready-made CRS strings I can use to project it?

Also, does there exist any other R map packages with maps of this 
resolution (plain shoreline data without any additional metadata would 
be OK), preferably with the maps actually included in the package, and 
not downloading them from the Internet on demand?

-- 
Karl Ove Hufthammer


From sebastiano.trevisani at libero.it  Fri Jan  8 11:49:37 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Fri, 08 Jan 2010 11:49:37 +0100
Subject: [R-sig-Geo] madogram
In-Reply-To: <mailman.9.1262862003.30603.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1262862003.30603.r-sig-geo@stat.math.ethz.ch>
Message-ID: <01NI7SAN2XJ4000UZC@mx1.pd.cnr.it>


>Dear list members

I would like to calculate the madogram but in the
libraries I'm using (gstat) it seems not possible.
Have you any idea how I could do that ?
Thank you in advance for your help...

Sebas


From karl at huftis.org  Fri Jan  8 12:20:09 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Fri, 8 Jan 2010 12:20:09 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
Message-ID: <MPG.25b1334856ee33c99896c7@news.gmane.org>

On Fri, 8 Jan 2010 10:11:20 +0100 Hans-J?rg Bibiko <bibiko at eva.mpg.de> 
wrote:
> I've a tiny question. Is there an annotated river dataset available?
> By 'annotated' I mean that rivers are ranked by a sort of 
> relevance/size/length or whatever. The problem is that I have an huge 
> SpatialLines object called 'rivers' which shows ~23200 rivers  but I 
> have to draw a map which only shows the most largest ones (let's say 
> 100 to 150) plus one to three rivers for a country.

How about using the 'SpatialLinesLengths' function? Try get the 100 
largest rivers, you can use

big.rivers=rivers[rev(order(SpatialLineLengths(rivers)))[1:100],]

'SpatialLinesLengths' may have a bug, though. At least for one of my 
data, it gives a 'non-finite line lengths' error message on one of the 
(finite!) lines.

-- 
Karl Ove Hufthammer


From bibiko at eva.mpg.de  Fri Jan  8 13:25:24 2010
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Fri, 8 Jan 2010 13:25:24 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
In-Reply-To: <MPG.25b1334856ee33c99896c7@news.gmane.org>
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
	<MPG.25b1334856ee33c99896c7@news.gmane.org>
Message-ID: <01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>

On Jan 8, 2010, at 12:20 PM, Karl Ove Hufthammer wrote:
> On Fri, 8 Jan 2010 10:11:20 +0100 Hans-J?rg Bibiko <bibiko at eva.mpg.de> 
> wrote:
>> I've a tiny question. Is there an annotated river dataset available?
>> By 'annotated' I mean that rivers are ranked by a sort of 
>> relevance/size/length or whatever. The problem is that I have an huge 
>> SpatialLines object called 'rivers' which shows ~23200 rivers  but I 
>> have to draw a map which only shows the most largest ones (let's say 
>> 100 to 150) plus one to three rivers for a country.
> 
> How about using the 'SpatialLinesLengths' function? Try get the 100 
> largest rivers, you can use

Thanks for the hint!
The absolute length can make sense of course but if I need also the largest rivers of a smaller island then this fails or it's much more tricky to handle/select.
I thought that there's a good representative collection of the world's rivers available.

Anyway, thanks a lot.

--Hans

From b.rowlingson at lancaster.ac.uk  Fri Jan  8 13:41:25 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 8 Jan 2010 12:41:25 +0000
Subject: [R-sig-Geo] Is there an annotated river dataset available?
In-Reply-To: <01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
	<MPG.25b1334856ee33c99896c7@news.gmane.org>
	<01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>
Message-ID: <d8ad40b51001080441u10fd3ca7n34a70511ab12e966@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100108/1073d787/attachment.pl>

From freddy.vate01 at gmail.com  Fri Jan  8 13:48:04 2010
From: freddy.vate01 at gmail.com (=?UTF-8?Q?Freddy_L=C3=B3pez?=)
Date: Sat, 9 Jan 2010 08:18:04 +1930
Subject: [R-sig-Geo] madogram
In-Reply-To: <01NI7SAN2XJ4000UZC@mx1.pd.cnr.it>
References: <mailman.9.1262862003.30603.r-sig-geo@stat.math.ethz.ch> 
	<01NI7SAN2XJ4000UZC@mx1.pd.cnr.it>
Message-ID: <cac512fc1001080448jc33f725vbeb5d056107a8663@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100109/ad8b4eb6/attachment.pl>

From bibiko at eva.mpg.de  Fri Jan  8 14:01:52 2010
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Fri, 8 Jan 2010 14:01:52 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
In-Reply-To: <d8ad40b51001080441u10fd3ca7n34a70511ab12e966@mail.gmail.com>
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
	<MPG.25b1334856ee33c99896c7@news.gmane.org>
	<01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>
	<d8ad40b51001080441u10fd3ca7n34a70511ab12e966@mail.gmail.com>
Message-ID: <8D65937C-AEF4-40F6-BC23-7B80A9B69C07@eva.mpg.de>


On Jan 8, 2010, at 1:41 PM, Barry Rowlingson wrote:
> http://www.naturalearthdata.com/downloads/10m-physical-vectors/
> 
>  the one with "scale ranks and tappering" has some metadata which might relate to size...

Ah, yes. Thanks a lot!!

This kind of data I looked for :)

--Hans

From sebastiano.trevisani at libero.it  Fri Jan  8 14:05:31 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Fri, 08 Jan 2010 14:05:31 +0100
Subject: [R-sig-Geo] madogram
In-Reply-To: <cac512fc1001080448jc33f725vbeb5d056107a8663@mail.gmail.com>
References: <mailman.9.1262862003.30603.r-sig-geo@stat.math.ethz.ch>
	<01NI7SAN2XJ4000UZC@mx1.pd.cnr.it>
	<cac512fc1001080448jc33f725vbeb5d056107a8663@mail.gmail.com>
Message-ID: <01NI7X15ZKS2000UZC@mx1.pd.cnr.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100108/316fa1e0/attachment.pl>

From karl at huftis.org  Fri Jan  8 14:29:12 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Fri, 8 Jan 2010 14:29:12 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
	<MPG.25b1334856ee33c99896c7@news.gmane.org>
	<01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>
Message-ID: <MPG.25b1519739d0af689896c8@news.gmane.org>

On Fri, 8 Jan 2010 13:25:24 +0100 Hans-J?rg Bibiko <bibiko at eva.mpg.de> 
wrote:
> Thanks for the hint!
> The absolute length can make sense of course but if I need also 
> the largest rivers of a smaller island then this fails or it's much 
> more tricky to handle/select.

Not really. You could for example use 'ddply' from the 'plyr' package 
to get the names/IDs of the longest rivers for each country/island/...
Then select the rivers with these names/IDs.

-- 
Karl Ove Hufthammer


From bibiko at eva.mpg.de  Fri Jan  8 14:40:40 2010
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Fri, 8 Jan 2010 14:40:40 +0100
Subject: [R-sig-Geo] Is there an annotated river dataset available?
In-Reply-To: <MPG.25b1519739d0af689896c8@news.gmane.org>
References: <C035ABB0-D2C9-473B-9C37-615FFCE7DA33@eva.mpg.de>
	<MPG.25b1334856ee33c99896c7@news.gmane.org>
	<01F3F0BF-68CD-4F5C-BBBC-573A967F061C@eva.mpg.de>
	<MPG.25b1519739d0af689896c8@news.gmane.org>
Message-ID: <B9E0AC8C-F223-4C72-985A-665A4AF963A0@eva.mpg.de>


On Jan 8, 2010, at 2:29 PM, Karl Ove Hufthammer wrote:

> On Fri, 8 Jan 2010 13:25:24 +0100 Hans-J?rg Bibiko <bibiko at eva.mpg.de> 
> wrote:
>> Thanks for the hint!
>> The absolute length can make sense of course but if I need also 
>> the largest rivers of a smaller island then this fails or it's much 
>> more tricky to handle/select.
> 
> Not really. You could for example use 'ddply' from the 'plyr' package 
> to get the names/IDs of the longest rivers for each country/island/...
> Then select the rivers with these names/IDs.

Yes, but my dataset has no names or IDs and furthermore I've just encountered that my rivers are split into line segments :(
The only chance would be to combine these segments and select those rivers/lines which are inside of country/island polygons.

Thanks,

--Hans

From hengl at spatial-analyst.net  Fri Jan  8 14:58:33 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 8 Jan 2010 14:58:33 +0100
Subject: [R-sig-Geo] raster / polygon overlay
In-Reply-To: <BLU144-W86D481D75DDDD52F0BD2D9B730@phx.gbl>
References: <mailman.17.1262689203.3371.r-sig-geo@stat.math.ethz.ch>
	<BLU144-W86D481D75DDDD52F0BD2D9B730@phx.gbl>
Message-ID: <001901ca906a$aae3cf30$00ab6d90$@net>

Dear Laure,

If this is still actual, here are few tips on how to aggregate continuous information (rasters) given some polygon maps.

---------------------
# obtain a polygon map e.g. World countries:
> load(url("http://spatial-analyst.net/DATA/WorldPolyCountries.Rdata"))
> str(WorldPolyCountries at data)
'data.frame':   246 obs. of  11 variables:
 $ FIPS     : Factor w/ 243 levels "AA","AC","AE",..: 2 5 6 7 8 10 11 12 13 17 ...
 $ ISO2     : Factor w/ 246 levels "AD","AE","AF",..: 4 61 17 6 7 9 12 11 14 24 ...
 $ ISO3     : Factor w/ 246 levels "ABW","AFG","AGO",..: 15 64 18 6 11 3 12 10 16 25 ...
 $ UN       : int  28 12 31 8 51 24 16 32 36 48 ...
 $ NAME     : Factor w/ 246 levels "Afghanistan",..: 10 4 16 3 12 7 5 11 14 18 ...
 $ AREA     : int  44 238174 8260 2740 2820 124670 20 273669 768230 71 ...
 $ POP2005  : int  83039 32854159 8352021 3153731 3017661 16095214 64051 38747148 20310208 724788 ...
 $ REGION   : int  19 2 142 150 142 2 9 19 9 142 ...
 $ SUBREGION: int  29 15 145 39 145 17 61 5 53 145 ...
 $ LON      : num  -61.78 2.63 47.4 20.07 44.56 ...
 $ LAT      : num  17.1 28.2 40.4 41.1 40.5 ...
> writeOGR(WorldPolyCountries, "WorldPolyCountries.shp", "WorldPolyCountries", "ESRI Shapefile")

# download some rasters, e.g. global elevations:
> download.file("http://spatial-analyst.net/worldmaps/globedem.zip", destfile=paste(getwd(), "/glodedem.zip", sep=""))
> unzip(paste(getwd(), "/glodedem.zip", sep=""))
> rsaga.esri.to.sgrd(in.grids="globedem.asc", out.sgrd="globedem.sgrd", in.path=getwd())

# Get grid Statistics for Polygons using SAGA GIS:
# rsaga.get.usage("shapes_grid", 2)
> rsaga.geoprocessor(lib="shapes_grid", module=2, param=list(GRID="globedem.sgrd", POLY="WorldPolyCountries.shp", RESULT="WorldPolyCountries.shp", QUANTILES=TRUE, QUANTILE_STEP=2))

# To have more control, read maps R:
> worldgrid <- readGDAL("globedem.asc")
> names(worldgrid) <- "globedem"
> pixelsize <- worldgrid at grid@cellsize[1]

# convert Polygons to rasters:
> rsaga.geoprocessor(lib="grid_gridding", module=0, param=list(GRID="WorldCountries.sgrd", INPUT="WorldPolyCountries.shp", FIELD=3, LINE_TYPE=0, TARGET_TYPE=0, USER_CELL_SIZE=pixelsize, USER_X_EXTENT_MIN=worldgrid at bbox[1,1]+pixelsize/2, USER_X_EXTENT_MAX=worldgrid at bbox[1,2], USER_Y_EXTENT_MIN=worldgrid at bbox[2,1]+pixelsize/2, USER_Y_EXTENT_MAX=worldgrid at bbox[2,2]-pixelsize/2))
# read to R:
> worldgrid$UN <- as.factor(readGDAL("WorldCountries.sdat")$band1)

# aggregate:
> globedem.stats <- boxplot(worldgrid$globedem ~ worldgrid$UN, plot=FALSE)
# match the country names:
> UN.name <- merge(data.frame(UN=as.integer(globedem.stats$names)), WorldPolyCountries at data[,c("UN","NAME")], by="UN")
> globedem.stats$NAME <- UN.name$NAME
> data.frame(elev=globedem.stats$stats[3,], country=globedem.stats$NAME)[order(globedem.stats$stats[3,], decreasing=TRUE)[1:10],]
    elev     country
204 3396  Tajikistan
19  2802      Bhutan
114 2738  Kyrgyzstan
117 2192     Lesotho
6   2082     Andorra
16  1876     Armenia
85  1774   Greenland
174 1620      Rwanda
1   1588 Afghanistan
142 1566       Nepal

# 10 highest countries in the World...
---------------------

If you need to downscale gridded maps, then consider also using SAGA GIS, which has a very flexible down/up-scaling functionality:

http://spatial-analyst.net/wiki/index.php?title=Export_maps_to_GE#Rescaling_maps_in_SAGA_GIS 


HTH

T. Hengl
http://home.medewerker.uva.nl/t.hengl/ 



> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of laure velez
> Sent: Tuesday, January 05, 2010 2:47 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] raster / polygon overlay
> 
> 
> 
> Thanks again for the fast reply,
> 
> 
> 
> In fact this problem is only a tiny part of the project and I'll need
> 
> to run this overlay operation over more than 600 polygons (watersheds)
> 
> to get mean values (and standard error) of ~10 environmental variables
> 
> (rasters that are not at the same resolution, i.e 2.5 degrees or 0.1
> 
> degrees). Furthermore I will have to overlay the watershed polygons
> 
> with polygons of landcover.
> 
> 
> 
> The scale of this project is regional (the whole Mediterranean basin)
> 
> thus the number (and size) of rasters preclude analyses to be run at
> 
> the entire scale of the project.
> 
> 
> 
> Thus I can imagine the following automated process :
> 
> 
> 
> 1. calculate a buffer around the watershed polygon.
> 
> 
> 
> 2. subset the grid area that overlay with the buffer (will it work
> 
> with big grid cells ?)
> 
> 
> 
> 3. spsample the raster to a finer resolution (the number of new
> 
> samples will depend on the initial resolution of the raster), what
> 
> about using the bb argument of the spsample function ?
> 
> 
> 
> 3. overlay this resampled raster with the watershed polygon.
> 
> 
> 
> 4. get statistics (mean, sd, ...) from the resulting dataset.
> 
> 
> 
> As a newbie I would like to get some help (function names) for those
> 
> different steps (specifically 1 (buffer), 2 (grid subset)).
> 
> 
> 
> Thanks again for all your useful advices,
> 
> 
> 
> Laure.
> 
> _________________________________________________________________
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From muhammad.rahiz at ouce.ox.ac.uk  Fri Jan  8 17:04:49 2010
From: muhammad.rahiz at ouce.ox.ac.uk (Muhammad Rahiz)
Date: Fri, 08 Jan 2010 16:04:49 +0000
Subject: [R-sig-Geo] readAsciiGrid - change color
Message-ID: <4B4757A1.8080709@ouce.ox.ac.uk>

Hello all,

I have gridded data which I loaded using the readAsciiGrid function.

 > x <- read.AsciiGrid("data.txt, plot.image=TRUE).
 > image(x)

This works OK but how do I:

1. know what values are assigned to which color/shade

2. change the color template e.g. rainbow

3. insert a color bar?

Thanks.

Muhammad

-- 
Muhammad Rahiz  |  Doctoral Student in Regional Climate Modeling					
Climate Research Laboratory, School of Geography & the Environment	
Oxford University Centre for the Environment
South Parks Road, Oxford, OX1 3QY, United Kingdom 
Tel: +44 (0)1865-285194	 Mobile: +44 (0)7854-625974
Email: muhammad.rahiz at ouce.ox.ac.uk


From muhammad.rahiz at ouce.ox.ac.uk  Fri Jan  8 17:16:02 2010
From: muhammad.rahiz at ouce.ox.ac.uk (Muhammad Rahiz)
Date: Fri, 08 Jan 2010 16:16:02 +0000
Subject: [R-sig-Geo] readAsciiGrid - change color
In-Reply-To: <4B4757A1.8080709@ouce.ox.ac.uk>
References: <4B4757A1.8080709@ouce.ox.ac.uk>
Message-ID: <4B475A42.6030700@ouce.ox.ac.uk>

I can use image.plot()

Muhammad Rahiz  |  Doctoral Student in Regional Climate Modeling					
Climate Research Laboratory, School of Geography & the Environment	
Oxford University Centre for the Environment
South Parks Road, Oxford, OX1 3QY, United Kingdom 
Tel: +44 (0)1865-285194	 Mobile: +44 (0)7854-625974
Email: muhammad.rahiz at ouce.ox.ac.uk






Muhammad Rahiz wrote:
> Hello all,
>
> I have gridded data which I loaded using the readAsciiGrid function.
>
>  > x <- read.AsciiGrid("data.txt, plot.image=TRUE).
>  > image(x)
>
> This works OK but how do I:
>
> 1. know what values are assigned to which color/shade
>
> 2. change the color template e.g. rainbow
>
> 3. insert a color bar?
>
> Thanks.
>
> Muhammad
>
>


From kevin.middel at ontario.ca  Fri Jan  8 17:37:25 2010
From: kevin.middel at ontario.ca (Middel, Kevin (MNR))
Date: Fri, 8 Jan 2010 11:37:25 -0500
Subject: [R-sig-Geo] Problems reading netcdf with RGDAL
In-Reply-To: <afa5c2d41001071030t29b84425wf33dba3c298fccea@mail.gmail.com>
Message-ID: <CCDDC32576408C439603A89A635A892A05D2AFCC@CTSPITDCEMMVX12.cihs.ad.gov.on.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100108/fc3fc9a7/attachment.pl>

From nils.weidmann at googlemail.com  Fri Jan  8 19:40:40 2010
From: nils.weidmann at googlemail.com (Nils B. Weidmann)
Date: Fri, 08 Jan 2010 13:40:40 -0500
Subject: [R-sig-Geo] MGRS conversion
Message-ID: <4B477C28.7070807@googlemail.com>

Hi all,

is there a way to convert Military Grid (MGRS) coordinates to lat/long 
using R's spatial packages? Thanks for any advice you may have!

Best
Nils
-- 
Nils B. Weidmann
Woodrow Wilson School
Princeton University
http://nils.weidmann.ws


From dan.putler at sauder.ubc.ca  Fri Jan  8 19:47:15 2010
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Fri, 08 Jan 2010 10:47:15 -0800
Subject: [R-sig-Geo] MGRS conversion
In-Reply-To: <22426_1262976087_1262976087_4B477C28.7070807@googlemail.com>
References: <22426_1262976087_1262976087_4B477C28.7070807@googlemail.com>
Message-ID: <1262976435.6886.24.camel@whitebox>

Hi Nils,

Likely via the spTransform function in the rgdal package.

Dan

On Fri, 2010-01-08 at 13:40 -0500, Nils B. Weidmann wrote:
> Hi all,
> 
> is there a way to convert Military Grid (MGRS) coordinates to lat/long 
> using R's spatial packages? Thanks for any advice you may have!
> 
> Best
> Nils
-- 
Dan Putler
Sauder School of Business
University of British Columbia


From Roger.Bivand at nhh.no  Fri Jan  8 20:12:44 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Jan 2010 20:12:44 +0100 (CET)
Subject: [R-sig-Geo] MGRS conversion
In-Reply-To: <1262976435.6886.24.camel@whitebox>
References: <22426_1262976087_1262976087_4B477C28.7070807@googlemail.com>
	<1262976435.6886.24.camel@whitebox>
Message-ID: <alpine.LRH.2.00.1001081954040.3677@reclus.nhh.no>

On Fri, 8 Jan 2010, Dan Putler wrote:

> Hi Nils,
>
> Likely via the spTransform function in the rgdal package.
>

But I believe a user-written wrapper would be needed to translate MGRS 
first to +proj=utm with zone number, or Universal Polar Stereographic near 
Poles, 100km square IDs, etc. Scanning the PROJ.4 list suggests that 
nobody has done this. In addition, the real authorities have left little 
doubt that MGRS is a very bad idea if used outside its originating context 
(easy errors, UTM zone transition problems, etc) - see the PROJ.4 list 
archives for May 2006 for a taste:

http://lists.maptools.org/pipermail/proj/2006-May/002216.html

http://lists.maptools.org/pipermail/proj/2006-May/002235.html

So that's why it isn't there, with the motivation. Thw wikipedia page 
gives enough details for a simple hack in some places, but if you can 
source the data in a "real" coordinate reference system, you would be 
on a much sounder footing.

Hope this helps,

Roger

> Dan
>
> On Fri, 2010-01-08 at 13:40 -0500, Nils B. Weidmann wrote:
>> Hi all,
>>
>> is there a way to convert Military Grid (MGRS) coordinates to lat/long
>> using R's spatial packages? Thanks for any advice you may have!
>>
>> Best
>> Nils
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From nils.weidmann at googlemail.com  Fri Jan  8 20:16:16 2010
From: nils.weidmann at googlemail.com (Nils B. Weidmann)
Date: Fri, 8 Jan 2010 14:16:16 -0500
Subject: [R-sig-Geo] MGRS conversion
In-Reply-To: <1262976435.6886.24.camel@whitebox>
References: <22426_1262976087_1262976087_4B477C28.7070807@googlemail.com>
	<1262976435.6886.24.camel@whitebox>
Message-ID: <d33b14fa1001081116g5ffff56do49981bf11cf7735d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100108/13fb2762/attachment.pl>

From mdsumner at gmail.com  Fri Jan  8 22:00:12 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 9 Jan 2010 08:00:12 +1100
Subject: [R-sig-Geo] readAsciiGrid - change color
In-Reply-To: <4B475A42.6030700@ouce.ox.ac.uk>
References: <4B4757A1.8080709@ouce.ox.ac.uk> <4B475A42.6030700@ouce.ox.ac.uk>
Message-ID: <522664f81001081300s581a67ffv1a162c6b9c5e5523@mail.gmail.com>

spplot(x)

On Sat, Jan 9, 2010 at 3:16 AM, Muhammad Rahiz
<muhammad.rahiz at ouce.ox.ac.uk> wrote:
> I can use image.plot()
>
> Muhammad Rahiz ?| ?Doctoral Student in Regional Climate Modeling
>
> Climate Research Laboratory, School of Geography & the Environment
> Oxford University Centre for the Environment
> South Parks Road, Oxford, OX1 3QY, United Kingdom Tel: +44 (0)1865-285194
> ?Mobile: +44 (0)7854-625974
> Email: muhammad.rahiz at ouce.ox.ac.uk
>
>
>
>
>
>
> Muhammad Rahiz wrote:
>>
>> Hello all,
>>
>> I have gridded data which I loaded using the readAsciiGrid function.
>>
>> ?> x <- read.AsciiGrid("data.txt, plot.image=TRUE).
>> ?> image(x)
>>
>> This works OK but how do I:
>>
>> 1. know what values are assigned to which color/shade
>>
>> 2. change the color template e.g. rainbow
>>
>> 3. insert a color bar?
>>
>> Thanks.
>>
>> Muhammad
>>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From florian.endel at gmail.com  Fri Jan  8 10:41:52 2010
From: florian.endel at gmail.com (Florian Endel)
Date: Fri, 08 Jan 2010 10:41:52 +0100
Subject: [R-sig-Geo] spplot - sort legend (colorkey)
In-Reply-To: <4B46D72C.2020702@uni-muenster.de>
References: <4B4675AC.3090509@gmail.com> <4B46D72C.2020702@uni-muenster.de>
Message-ID: <4B46FDE0.9080501@gmail.com>

Thanks - it worked perfectly :)

--
Florian


Edzer Pebesma wrote:
> Florian, please try
> 
> noe$bez1 = factor(noe$bez, levels = rev(levels(noe$bez)))
> spplot(noe, zcol="bez1", col.regions=rev(col), col="white", 
> scales=list(draw = TRUE), colorkey=TRUE)
> 
> Florian Endel wrote:
>> Hi,
>>
>> I downloaded and ploted maps from http://gadm.org/ for Austria and a 
>> special province:
>>
>> ### <CODE> ###
>>
>> library(sp)
>> library(RColorBrewer)
>>
>> # load from web
>> con <- url("http://gadm.org/data/rda/AUT_adm2.RData")
>> print(load(con)) # gadm hold all the data!
>> close(con)
>>
>> # select one province
>> noe = new("SpatialPolygonsDataFrame")
>> noe = gadm[gadm$NAME_1=="Nieder\xf6sterreich",]
>>
>> noe$NAME_1 = factor(noe$NAME_1)
>> noe$NAME_2 = factor(noe$NAME_2)
>>
>> # utf8
>> noe_bez_names = iconv(noe$NAME_2, "ISO_8859-2", "UTF-8")
>> noe$bez = factor(noe_bez_names)
>>
>> # plot
>> col = rainbow(length(levels(noe$bez)))
>> spplot(noe, zcol="bez", col.regions=col, col="white", scales=list(draw 
>> = TRUE), colorkey=TRUE)
>>
>> ### </CODE> ###
>>
>> everything just works fine, but the legend (colorkey) is ordered in 
>> the wrong direction...
>>
>> How can I rearrange / sort the legend?
>>
>> -- 
>> greets
>> FloE
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
>


From muhammad.rahiz at ouce.ox.ac.uk  Sun Jan 10 15:09:40 2010
From: muhammad.rahiz at ouce.ox.ac.uk (Muhammad Rahiz)
Date: Sun, 10 Jan 2010 14:09:40 +0000
Subject: [R-sig-Geo] Tweak legend in image.plot()
Message-ID: <4B49DFA4.8040707@ouce.ox.ac.uk>

Hi all,

I've plotted my data using;
 > image.plot(data, zlim=c(0,800), add=FALSE, nlevel=100, horizontal=T, 
legend.shrink=0.5, legend.width=.8, col=tim.colors(100))

 From here, I'd like to make adjustments to the legend like;

1. Reversing the scale.
For example, the legend plots zlim as 0= blue to 800=red. Since I'm 
dealing with rainfall data, it's more visually logical to express 
highest precipitation as blue. Hence 0 = red to 800 = blue would be desired.

2. Shifting the legend up by 2inches from the bottom of the page

3. Changing the legend's font size/type.

Does anyone have any suggestions?



Muhammad

-- 
Muhammad Rahiz  |  Doctoral Student in Regional Climate Modeling
Climate Research Laboratory, School of Geography & the Environment	
Oxford University Centre for the Environment, University of Oxford
South Parks Road, Oxford, OX1 3QY, United Kingdom
Tel: +44 (0)1865-285194	 Mobile: +44 (0)7854-625974
Email: muhammad.rahiz at ouce.ox.ac.uk


From hengl at spatial-analyst.net  Mon Jan 11 10:46:32 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 11 Jan 2010 10:46:32 +0100
Subject: [R-sig-Geo] GEOSTAT 2010 Summer School, 27 June - 4 July 2010;
	University of Plasencia, Spain
In-Reply-To: <4B38714D.9040605@spatial-analyst.net>
References: <4B38714D.9040605@spatial-analyst.net>
Message-ID: <000001ca92a2$f5212db0$df638910$@net>


Dear R-sig-geo,

In relation with our preparations for the GEOSTAT 2010 summer school, it would be of great help if some of you would consider printing and posting the announcement for the summer school via e.g. news board at your department/institute. This way also people off this mailing list (but with potentially high motivation) might consider applying. For more info see:

http://geostat2010.info/flyer

A PDF of the flyer can be obtained from here:

http://geostat2010.info/system/files/GEOSTAT2010_flyer.pdf  [1.5 MB]

Thank you!

T. Hengl
http://home.medewerker.uva.nl/t.hengl/ 



> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Tomislav Hengl
> Sent: Monday, December 28, 2009 9:50 AM
> To: r-sig-geo
> Cc: Victor Olaya; Olaf Conrad
> Subject: [R-sig-Geo] GEOSTAT 2010 Summer School, 27 June - 4 July 2010;
> University of Plasencia, Spain
> 
> 
> GEOSTAT 2010 Summer School
> 27 June - 4 July 2010; University of Plasencia, Spain
> 
> This is the first call for participation in the GEOSTAT 2010 Summer
> School. GEOSTAT focuses on important aspects of statistical analysis of
> spatial and spatio-temporal data using open source / free GIS tools: R,
> SAGA GIS, GRASS GIS, Quantum GIS, GDAL, Google Earth and similar. The
> course participants learn how to move data back and forth between
> different environments, how to produce scripts and automate analysis. We
> welcome also R beginners and users needing refresh courses in
> programming. This year, we would also like to introduce/promote topics
> such as: web-based computing, WPS client-server environments, 3D and 4D
> geostatistics, combining R+SAGA/GRASS. This is a 5-day course with two
> parallel sessions, which means that there will be total 7 full-day
> blocks (three days with parallel sessions) of lectures; the last day of
> the summer school participants can present their research problems and
> ask for feedback from the whole summer school. For more info see:
> 
> http://geostat2010.info/Info
> 
> -------------------------------------------------------------
> LECTURERS:
> Roger Bivand (nhh.no), Edzer Pebesma (uni-muenster.de), Gerard Heuvelink
> (wur.nl), Olaf Conrad (geowiss.uni-hamburg.de), Tomislav Hengl (uva.nl)
> and Victor Olaya Ferrero (unex.es)
> 
> -------------------------------------------------------------
> DEADLINE TO REGISTER:
> 15th February 2010; online at:
> 
> http://geostat2010.info/deadline_registration
> 
> -------------------------------------------------------------
> SELECTION OF CANDIDATES:
> The participants will be selected using the following criteria:
> 
> 1. your publication record / academic position;
> 2. previous involvement in the open source activities (R-sig-geo,
> conferences and workshops)
> 3. distance from the venue (more distant applications have advantage);
> 4. time of application (first-come-first-served);
> 
> -------------------------------------------------------------
> FEES:
> To be determined; usually between 200-300 EUR (excluding accommodation
> costs). 5-6 double bed rooms (in-house accommodation) available at
> subsidized price for participants who reside in, and are nationals of an
> ODA country (http://www.oecd.org/dataoecd/32/40/43540882.pdf). Subject
> to availability.
> 
> -------------------------------------------------------------
> CONTACT (Local organizers):
> Victor Olaya Ferrero (volaya at unex.es), Tomislav Hengl (T.Hengl at uva.nl)
> and Juan Carlos Jim?nez (jcfernan at unex.es)
> URL: www.geostat2010.info
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From p.hiemstra at geo.uu.nl  Mon Jan 11 14:00:56 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 11 Jan 2010 14:00:56 +0100
Subject: [R-sig-Geo] Tweak legend in image.plot()
In-Reply-To: <4B49DFA4.8040707@ouce.ox.ac.uk>
References: <4B49DFA4.8040707@ouce.ox.ac.uk>
Message-ID: <4B4B2108.3010209@geo.uu.nl>

Muhammad Rahiz wrote:
> Hi all,
>
> I've plotted my data using;
> > image.plot(data, zlim=c(0,800), add=FALSE, nlevel=100, horizontal=T, 
> legend.shrink=0.5, legend.width=.8, col=tim.colors(100))
>
> From here, I'd like to make adjustments to the legend like;
>
> 1. Reversing the scale.
> For example, the legend plots zlim as 0= blue to 800=red. Since I'm 
> dealing with rainfall data, it's more visually logical to express 
> highest precipitation as blue. Hence 0 = red to 800 = blue would be 
> desired.
try: col = rev(tim.colors(100))

In addition, consider using the spatial classes provided by the 
sp-package to plot your data. See [1] for some examples of spatial plot.

cheers,
Paul

[1] 
http://wiki.r-project.org/rwiki/doku.php?id=tips:spatial-data:spatial_data_visualization
>
> 2. Shifting the legend up by 2inches from the bottom of the page
>
> 3. Changing the legend's font size/type.
>
> Does anyone have any suggestions?
>
>
>
> Muhammad
>


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From karl at huftis.org  Mon Jan 11 14:45:42 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Mon, 11 Jan 2010 14:45:42 +0100
Subject: [R-sig-Geo] Datum/CRS for the worldHires map data
References: <MPG.25b12a22b2e730759896c6@news.gmane.org>
Message-ID: <MPG.25b549f2ae4185cf9896cc@news.gmane.org>

On Fri, 8 Jan 2010 11:40:57 +0100 Karl Ove Hufthammer <karl at huftis.org> 
wrote:
> The reason is obviously that the worldHires map is not in the WGS 84 
> datum (which is reasonable, considering the age of the data). But which 
> datum is it in? I could find no information on this in the helpfile, or 
> on the referenced Web page? Does anybody on this list know, and perhaps 
> have a ready-made CRS strings I can use to project it?
> 
> Also, does there exist any other R map packages with maps of this 
> resolution (plain shoreline data without any additional metadata would 
> be OK), preferably with the maps actually included in the package, and 
> not downloading them from the Internet on demand?

Reading the ASDAR book (which I'm slowly working my way through), I 
discovered the 'Rgsshs' function in the 'maptools' package, which 
provides maps from the very nice Global Self-consistant Hierarchical 
High-resolution Shorelines database. The data have to be downloaded 
separately.

The data is in the WGS84, and does not suffer from the same problem as 
the worldHiresdata (even though it looks like parts of it is based on 
the same source).

My only issue with it is that using 'Rgshhs' is quite slow at the 
highest resolution, since, for example, selecting a tiny island in 
Norway will import the entire shoreline for the Eurasia continent, which 
is treated as one big polygon. Clipping this to the chosen xlim + ylim 
takes several minutes and much memory (as documented in the help file). 
Turning of clipping makes the import much faster, but it's still slow, 
and of course the resulting object takes up much memory (and uses a bit 
more time to render).

-- 
Karl Ove Hufthammer


From nsicad at gmail.com  Tue Jan 12 03:54:22 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Tue, 12 Jan 2010 09:54:22 +0700
Subject: [R-sig-Geo] Is latest Rgdal support spatialite
Message-ID: <f7bd71731001111854o4f91db40y203f27e22dfef62f@mail.gmail.com>

Hi,

Anybody know, if the latest update (3 January 2010) of Rgdal supports
spatialite - GDAL 1.7.0?


Thanks. Noli

~~~~~~~~~~~~~~~~~~~~~~~~`
http://www.gdal.org/ogr/drv_sqlite.html

from the site.
~~~~~~~~~~~~~~~~~~
Using the SpatiaLite library (Spatial extension for SQLite)
(Starting with GDAL 1.7.0)

The SQLite driver can read and write SpatiaLite databases without
needing to load the SpatiaLite library. But if you configure GDAL/OGR
with explicit linking to SpatiaLite library (version >= 2.3), you can
take advantage of all the extension functions provided by this
library, such as spatial indexes, spatial functions, etc...

A few examples :

# Duplicate the sample database provided with SpatiaLite (does not
need explicit linking with SpatiaLite)
ogr2ogr -f SQLite testspatialite.sqlite test-2.3.sqlite  -dsco SPATIALITE=YES

# Add a spatial index on the geometry column of the Towns table (needs
explicit linking with SpatiaLite)
ogrinfo testspatialite.sqlite -sql "SELECT CreateSpatialIndex('Towns',
'geometry')"

# Make a request with a spatial filter (needs explicit linking with SpatiaLite)
ogrinfo testspatialite.sqlite \
     -sql "SELECT Name, asText(geometry) FROM Towns WHERE
MBRWithin(geometry, BuildMBR(754000, 4692000, 770000, 4924000))"


From nsicad at gmail.com  Tue Jan 12 11:12:57 2010
From: nsicad at gmail.com (Noli Sicad)
Date: Tue, 12 Jan 2010 17:12:57 +0700
Subject: [R-sig-Geo] Is latest Rgdal support spatialite
In-Reply-To: <f7bd71731001111854o4f91db40y203f27e22dfef62f@mail.gmail.com>
References: <f7bd71731001111854o4f91db40y203f27e22dfef62f@mail.gmail.com>
Message-ID: <f7bd71731001120212l4c13bdabp623900f83a471643@mail.gmail.com>

No. GDAL 1.7.0 not yet released.

http://www.mail-archive.com/gdal-dev at lists.osgeo.org/msg05330.html
http://svn.osgeo.org/gdal/trunk/gdal/NEWS

Noli

On 1/12/10, Noli Sicad <nsicad at gmail.com> wrote:
> Hi,
>
> Anybody know, if the latest update (3 January 2010) of Rgdal supports
> spatialite - GDAL 1.7.0?
>
>
> Thanks. Noli
>
> ~~~~~~~~~~~~~~~~~~~~~~~~`
> http://www.gdal.org/ogr/drv_sqlite.html
>
> from the site.
> ~~~~~~~~~~~~~~~~~~
> Using the SpatiaLite library (Spatial extension for SQLite)
> (Starting with GDAL 1.7.0)
>
> The SQLite driver can read and write SpatiaLite databases without
> needing to load the SpatiaLite library. But if you configure GDAL/OGR
> with explicit linking to SpatiaLite library (version >= 2.3), you can
> take advantage of all the extension functions provided by this
> library, such as spatial indexes, spatial functions, etc...
>
> A few examples :
>
> # Duplicate the sample database provided with SpatiaLite (does not
> need explicit linking with SpatiaLite)
> ogr2ogr -f SQLite testspatialite.sqlite test-2.3.sqlite  -dsco
> SPATIALITE=YES
>
> # Add a spatial index on the geometry column of the Towns table (needs
> explicit linking with SpatiaLite)
> ogrinfo testspatialite.sqlite -sql "SELECT CreateSpatialIndex('Towns',
> 'geometry')"
>
> # Make a request with a spatial filter (needs explicit linking with
> SpatiaLite)
> ogrinfo testspatialite.sqlite \
>      -sql "SELECT Name, asText(geometry) FROM Towns WHERE
> MBRWithin(geometry, BuildMBR(754000, 4692000, 770000, 4924000))"
>


From Roger.Bivand at nhh.no  Tue Jan 12 11:35:15 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 12 Jan 2010 11:35:15 +0100 (CET)
Subject: [R-sig-Geo] Is latest Rgdal support spatialite
In-Reply-To: <f7bd71731001111854o4f91db40y203f27e22dfef62f@mail.gmail.com>
References: <f7bd71731001111854o4f91db40y203f27e22dfef62f@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001121001001.2004@reclus.nhh.no>

On Tue, 12 Jan 2010, Noli Sicad wrote:

> Hi,
>
> Anybody know, if the latest update (3 January 2010) of Rgdal supports
> spatialite - GDAL 1.7.0?
>

I'm afraid that your question is not precise. The rgdal package supports 
all the GDAL raster and OGR vector drivers supported in the DLL/shared 
object for GDAL on your system. This version is reported when the rgdal 
package is loaded. On systems other than Windows using the CRAN binary 
package, this may be chosen by the user - it has nothing to do with the 
rgdal package. The gdalDrivers() and ogrDrivers() functions report which 
drivers are supported in the installed GDAL/OGR DLL.

If you mean the rgdal Windows CRAN binary package, then the current 
version of GDAL is 1.6.3. Note that 1.7.0 has not been released, and is 
expected by the beginning of February - as your later posting reports. In 
any case, we depend on the goodwill of Uwe Ligges to make it possible to 
provide the binary package, which should have as few external dependencies 
as possible. The driver you ask about has external dependencies, so will 
not be considered for the CRAN Windows binary. See

file.show(system.file("README.windows", package="rgdal"))

for other build options, for example against the Windows FWTools 
distribution of GDAL. See also the SQLiteMap package for a feasible 
alternative not using GDAL/OGR drivers.

Hope this is sufficiently clear,

Roger


>
> Thanks. Noli
>
> ~~~~~~~~~~~~~~~~~~~~~~~~`
> http://www.gdal.org/ogr/drv_sqlite.html
>
> from the site.
> ~~~~~~~~~~~~~~~~~~
> Using the SpatiaLite library (Spatial extension for SQLite)
> (Starting with GDAL 1.7.0)
>
> The SQLite driver can read and write SpatiaLite databases without
> needing to load the SpatiaLite library. But if you configure GDAL/OGR
> with explicit linking to SpatiaLite library (version >= 2.3), you can
> take advantage of all the extension functions provided by this
> library, such as spatial indexes, spatial functions, etc...
>
> A few examples :
>
> # Duplicate the sample database provided with SpatiaLite (does not
> need explicit linking with SpatiaLite)
> ogr2ogr -f SQLite testspatialite.sqlite test-2.3.sqlite  -dsco SPATIALITE=YES
>
> # Add a spatial index on the geometry column of the Towns table (needs
> explicit linking with SpatiaLite)
> ogrinfo testspatialite.sqlite -sql "SELECT CreateSpatialIndex('Towns',
> 'geometry')"
>
> # Make a request with a spatial filter (needs explicit linking with SpatiaLite)
> ogrinfo testspatialite.sqlite \
>     -sql "SELECT Name, asText(geometry) FROM Towns WHERE
> MBRWithin(geometry, BuildMBR(754000, 4692000, 770000, 4924000))"
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From sebastiano.trevisani at libero.it  Wed Jan 13 15:43:08 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Wed, 13 Jan 2010 15:43:08 +0100
Subject: [R-sig-Geo] anisotropy - intamap
Message-ID: <01NIEZWJDRES001C0Z@mx1.pd.cnr.it>

Dear list members

I have a tecnical question in relation to the calculation of 
variogram anisotropy in presence of a trend with estimateParameters function.
I have a data set "w" with a clear trend (degree 1) so I would like 
to calculate geometric anisotropy of residuals.
I do the following:
  bingo=createIntamapObject(observations=w,formulaString=as.formula(z~x+y),params=getIntamapParams(),class="automap")
  estimateParameters(bingo,model=c("Pow"))->p

But when I go to check for anisotropy I have the impression that the 
anisotropy calculated is relative to the raw variogram not to the residual one:
Is it possible?
Is there something wrong in my expression?
Thank you in advance for your help.

Bye
Sebastiano


From karl at huftis.org  Wed Jan 13 16:10:57 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 13 Jan 2010 16:10:57 +0100
Subject: [R-sig-Geo] Datum/CRS for the worldHires map data
References: <MPG.25b12a22b2e730759896c6@news.gmane.org>
	<MPG.25b549f2ae4185cf9896cc@news.gmane.org>
Message-ID: <MPG.25b800ef5db32149896ce@news.gmane.org>

On Mon, 11 Jan 2010 14:45:42 +0100 Karl Ove Hufthammer <karl at huftis.org> 
wrote:
>> The reason is obviously that the worldHires map is not in the WGS 84 
>> datum (which is reasonable, considering the age of the data). But 
>> which datum is it in?

In case anybody is interested in this information: I have contacted Paul 
Wessel, one of the developers of the GSHHS data. It looks like the 
original data is poorly documented, but the WDB data *might* be in
WGS 72. However, there are probably also other systematic effects such 
as bad digitisation, format conversions &c. I guess this is the reason 
behind the inaccuracy I observed (in *practice* there are not very big 
differences between WGS 72 and WGS 84, even though the two models are 
completely different).

However, the story doesn't end here. It looks the 'worldHires' data in 
'mapdata' is actually different from the version at
http://rimmer.ngdc.noaa.gov/ (select 'World Data Bank II from the drop-
down menu). It's not better, just different.

For instance, compare the area at long = c(25,26), lat = c(70.8, 71.05).

Here is some code that does this. It assumes you have already downloaded 
the GSHHS data (see the Rgshhs help page) and the WDB data from
http://rimmer.ngdc.noaa.gov/ to the currenct directory.

As you can see, the WDB data is shifted from the (correct) GSHHS data. 
But also *some* of the WDB polygons differ between the worldHires 
version and NGDC version. For instance, the polygon for the upper island 
is identical in the two data sets, but the lower land area polygon is 
shifted.

library(maps)
library(mapdata)
library(maptools)

xlim=c(25, 26)
ylim=c(70.8, 71.05)

map1 = Rgshhs("gshhs/gshhs_f.b", xlim=xlim, ylim=ylim, no.clip=TRUE)
plot(map1$SP, xlim=xlim, ylim=ylim, col="black")
map("worldHires", xlim=xlim, ylim=ylim, add=TRUE, col="red", lw=3)
map2 = read.table("24513.dat") # Change the filename here
lines(map2,col="green", lw=2)

-- 
Karl Ove Hufthammer


From Roger.Bivand at nhh.no  Wed Jan 13 19:48:43 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 13 Jan 2010 19:48:43 +0100 (CET)
Subject: [R-sig-Geo] Changes in the sp package
Message-ID: <alpine.LRH.2.00.1001131938280.25617@reclus.nhh.no>

A number of changes have been made in the sp package which may affect 
users. Version 0.9-56 is now on CRAN and is the first release containing 
the changes.

The changes involve the creation of Polygon, Polygons, and SpatialPolygons 
objects in C rather than R code, and in the exposure of these C functions 
to other packages (less important for now). I see speedups of about four 
times in reading large polygon shapefiles in readOGR() in rgdal, and 
similarly in readShapeSpatial() in maptools (which remains slower), 
because the sp instantiation functions called there also call the C 
functions inside sp.

They have been tried out following an announcement on this list last 
month:

https://stat.ethz.ch/pipermail/r-sig-geo/2009-December/007224.html

with no significant problems reported. The only visible change appears to 
be the names of the dimensions in the bounding box of SpatialPolygons 
objects, which now are c("x", "y").

Thanks to Micah Altman, the "[" subsetting method for 
SpatialPolygonDataFrame objects has also been speeded up, again by about 
4x - this does not involve C code.

If changes are noticed, please contact me directly with a reproducible 
example.

Thanks in advance for your cooperation,

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Thu Jan 14 10:27:17 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Jan 2010 10:27:17 +0100
Subject: [R-sig-Geo] Best way to calculate distance between geographical
	points
Message-ID: <MPG.25b901dd54bad269896d0@news.gmane.org>

Dear list members

I have found three functions for calculating the distance between 
geographical points, 'geo.dist' in the 'oce' package, 'rdist.earth' in 
the 'fields' package, and 'spDistsN1' in the 'sp' package. They all give 
slightly difference answers, so my question is: which of them is best, 
i.e., gives the most accurate answer?

When it comes to performance, the 'rbenchmark' package shows that (at 
least on calculating a single distance), 'spDistsN1' is the fastest, 
'geo.dist' takes twice as long, and 'rdist.earth' takes about five times 
as long (as 'spDistsN1').

-- 
Karl Ove Hufthammer


From karl at huftis.org  Thu Jan 14 10:56:42 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Jan 2010 10:56:42 +0100
Subject: [R-sig-Geo] Best way to calculate distance between geographical
	points
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
Message-ID: <MPG.25b908c588a53e369896d1@news.gmane.org>

On Thu, 14 Jan 2010 10:27:17 +0100 Karl Ove Hufthammer <karl at huftis.org> 
wrote:
> I have found three functions for calculating the distance between 
> geographical points, 'geo.dist' in the 'oce' package, 'rdist.earth' in 
> the 'fields' package, and 'spDistsN1' in the 'sp' package. They all give 
> slightly difference answers, so my question is: which of them is best, 
> i.e., gives the most accurate answer?

One simple test would be to calculate the circumference of the earth at 
the equator and the meridian. But this test gives conflicting answers.

According to Wikipedia, "http://en.wikipedia.org/wiki/Earth" the 
equatorial circumference is 40075.02 km and the meridional circumference 
is 40007.86 km.

When calculating half the equatorial circumference, 'spDistsN1' is best, 
and gives the *exact* answer, while 'rdist.earth' is close (less than 
one km difference), and 'geo.dist' is far from the correct answer 
(133.92 km difference). So it would initially seem that 'spDistsN1' is 
the one to use, and one should avoid 'geo.dist'.

But when calculating the meridional distance, 'geo.dist' gives the exact 
answer, while both 'rdist.earth' and 'spDistsN1' are both off by about 
34 km (but in difference directions).

So which to use is still an open question ...

Here is the code I used:

library(oce)
library(fields)
library(sp)

# Equatorial
lt1=0
lt2=0
lg1=0
lg2=180

a=matrix(c(lg1,lt1),nrow=1)
b=matrix(c(lg2,lt2),nrow=1)

# Calculated distance
geod.dist(lt1,lg1,lt2,lg2)
rdist.earth(a,b, miles=FALSE)
spDistsN1(a,b, longlat=TRUE)

# Correct distance (according to Wikipedia)
40075.02/2


# Meridional
lt1=-90
lt2=90
lg1=0
lg2=0

a=matrix(c(lg1,lt1),nrow=1)
b=matrix(c(lg2,lt2),nrow=1)

# Calculated distance
geod.dist(lt1,lg1,lt2,lg2)
rdist.earth(a,b, miles=FALSE)
spDistsN1(a,b, longlat=TRUE)

# Correct distance (according to Wikipedia)
40007.86/2 

-- 
Karl Ove Hufthammer


From Thierry.ONKELINX at inbo.be  Thu Jan 14 11:55:06 2010
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Thu, 14 Jan 2010 11:55:06 +0100
Subject: [R-sig-Geo] Best way to calculate distance between
	geographicalpoints
In-Reply-To: <MPG.25b908c588a53e369896d1@news.gmane.org>
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
	<MPG.25b908c588a53e369896d1@news.gmane.org>
Message-ID: <2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>

Dear Karl,

I think that the relative errors are more relevant than absolute errors.
The relative error on the equatorial circumference for "geo.dist" is
0.33%, which is not that accurate. The relative error on the meridional
distance is only about 0.085%, which should accurant enough for most
applications.

Just my 2 eurocents.

Thierry


------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek
team Biometrie & Kwaliteitszorg
Gaverstraat 4
9500 Geraardsbergen
Belgium

Research Institute for Nature and Forest
team Biometrics & Quality Assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium

tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Karl Ove Hufthammer
Verzonden: donderdag 14 januari 2010 10:57
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] Best way to calculate distance between
geographicalpoints

On Thu, 14 Jan 2010 10:27:17 +0100 Karl Ove Hufthammer <karl at huftis.org>
wrote:
> I have found three functions for calculating the distance between 
> geographical points, 'geo.dist' in the 'oce' package, 'rdist.earth' in

> the 'fields' package, and 'spDistsN1' in the 'sp' package. They all 
> give slightly difference answers, so my question is: which of them is 
> best, i.e., gives the most accurate answer?

One simple test would be to calculate the circumference of the earth at
the equator and the meridian. But this test gives conflicting answers.

According to Wikipedia, "http://en.wikipedia.org/wiki/Earth" the
equatorial circumference is 40075.02 km and the meridional circumference
is 40007.86 km.

When calculating half the equatorial circumference, 'spDistsN1' is best,
and gives the *exact* answer, while 'rdist.earth' is close (less than
one km difference), and 'geo.dist' is far from the correct answer
(133.92 km difference). So it would initially seem that 'spDistsN1' is
the one to use, and one should avoid 'geo.dist'.

But when calculating the meridional distance, 'geo.dist' gives the exact
answer, while both 'rdist.earth' and 'spDistsN1' are both off by about
34 km (but in difference directions).

So which to use is still an open question ...

Here is the code I used:

library(oce)
library(fields)
library(sp)

# Equatorial
lt1=0
lt2=0
lg1=0
lg2=180

a=matrix(c(lg1,lt1),nrow=1)
b=matrix(c(lg2,lt2),nrow=1)

# Calculated distance
geod.dist(lt1,lg1,lt2,lg2)
rdist.earth(a,b, miles=FALSE)
spDistsN1(a,b, longlat=TRUE)

# Correct distance (according to Wikipedia)
40075.02/2


# Meridional
lt1=-90
lt2=90
lg1=0
lg2=0

a=matrix(c(lg1,lt1),nrow=1)
b=matrix(c(lg2,lt2),nrow=1)

# Calculated distance
geod.dist(lt1,lg1,lt2,lg2)
rdist.earth(a,b, miles=FALSE)
spDistsN1(a,b, longlat=TRUE)

# Correct distance (according to Wikipedia)
40007.86/2 

--
Karl Ove Hufthammer

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Druk dit bericht a.u.b. niet onnodig af.
Please do not print this message unnecessarily.

Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.


From jacobvanetten at yahoo.com  Thu Jan 14 12:14:04 2010
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Thu, 14 Jan 2010 03:14:04 -0800 (PST)
Subject: [R-sig-Geo] Best way to calculate distance between
	geographicalpoints
In-Reply-To: <2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>
Message-ID: <36640.43536.qm@web32907.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100114/bd39c9b4/attachment.pl>

From Roger.Bivand at nhh.no  Thu Jan 14 12:27:04 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Jan 2010 12:27:04 +0100 (CET)
Subject: [R-sig-Geo] Best way to calculate distance between
 geographicalpoints
In-Reply-To: <2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
	<MPG.25b908c588a53e369896d1@news.gmane.org>
	<2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>
Message-ID: <alpine.LRH.2.00.1001141205300.12049@reclus.nhh.no>

On Thu, 14 Jan 2010, ONKELINX, Thierry wrote:

> Dear Karl,
>
> I think that the relative errors are more relevant than absolute errors.
> The relative error on the equatorial circumference for "geo.dist" is
> 0.33%, which is not that accurate. The relative error on the meridional
> distance is only about 0.085%, which should accurant enough for most
> applications.

>From the code of rdist.earth(), it is using a sphere with a 6378388m 
parameter (which is like the International 1909 ellipsoid, but a sphere). 
geod.dist() is using WGS84 a=6378137.0  rf=298.257223563:

http://code.google.com/p/r-oce/source/browse/trunk/R/misc.R

near line 280. The code under spDistsN1() uses WGS84 values, but with the 
radius in km:

http://r-spatial.cvs.sourceforge.net/viewvc/r-spatial/sp/src/gcdist.c?revision=1.6&view=markup

So in principle geod.dist() and spDistsN1(..., longlat=TRUE) should yield 
equivalent results, because their assumptions are the same.

Several of the references suggest that the geographic pole should not be 
input. It looks as though the oce implementation handles this more 
gracefully than sp.

Hope this helps,

Roger

>
> Just my 2 eurocents.
>
> Thierry
>
>
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek
> team Biometrie & Kwaliteitszorg
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
>
> Research Institute for Nature and Forest
> team Biometrics & Quality Assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
>
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to
> say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of
> data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-geo-bounces at stat.math.ethz.ch
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Karl Ove Hufthammer
> Verzonden: donderdag 14 januari 2010 10:57
> Aan: r-sig-geo at stat.math.ethz.ch
> Onderwerp: Re: [R-sig-Geo] Best way to calculate distance between
> geographicalpoints
>
> On Thu, 14 Jan 2010 10:27:17 +0100 Karl Ove Hufthammer <karl at huftis.org>
> wrote:
>> I have found three functions for calculating the distance between
>> geographical points, 'geo.dist' in the 'oce' package, 'rdist.earth' in
>
>> the 'fields' package, and 'spDistsN1' in the 'sp' package. They all
>> give slightly difference answers, so my question is: which of them is
>> best, i.e., gives the most accurate answer?
>
> One simple test would be to calculate the circumference of the earth at
> the equator and the meridian. But this test gives conflicting answers.
>
> According to Wikipedia, "http://en.wikipedia.org/wiki/Earth" the
> equatorial circumference is 40075.02 km and the meridional circumference
> is 40007.86 km.
>
> When calculating half the equatorial circumference, 'spDistsN1' is best,
> and gives the *exact* answer, while 'rdist.earth' is close (less than
> one km difference), and 'geo.dist' is far from the correct answer
> (133.92 km difference). So it would initially seem that 'spDistsN1' is
> the one to use, and one should avoid 'geo.dist'.
>
> But when calculating the meridional distance, 'geo.dist' gives the exact
> answer, while both 'rdist.earth' and 'spDistsN1' are both off by about
> 34 km (but in difference directions).
>
> So which to use is still an open question ...
>
> Here is the code I used:
>
> library(oce)
> library(fields)
> library(sp)
>
> # Equatorial
> lt1=0
> lt2=0
> lg1=0
> lg2=180
>
> a=matrix(c(lg1,lt1),nrow=1)
> b=matrix(c(lg2,lt2),nrow=1)
>
> # Calculated distance
> geod.dist(lt1,lg1,lt2,lg2)
> rdist.earth(a,b, miles=FALSE)
> spDistsN1(a,b, longlat=TRUE)
>
> # Correct distance (according to Wikipedia)
> 40075.02/2
>
>
> # Meridional
> lt1=-90
> lt2=90
> lg1=0
> lg2=0
>
> a=matrix(c(lg1,lt1),nrow=1)
> b=matrix(c(lg2,lt2),nrow=1)
>
> # Calculated distance
> geod.dist(lt1,lg1,lt2,lg2)
> rdist.earth(a,b, miles=FALSE)
> spDistsN1(a,b, longlat=TRUE)
>
> # Correct distance (according to Wikipedia)
> 40007.86/2
>
> --
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Druk dit bericht a.u.b. niet onnodig af.
> Please do not print this message unnecessarily.
>
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer
> en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
> door een geldig ondertekend document. The views expressed in  this message
> and any annex are purely those of the writer and may not be regarded as stating
> an official position of INBO, as long as the message is not confirmed by a duly
> signed document.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Thu Jan 14 12:47:02 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Jan 2010 12:47:02 +0100
Subject: [R-sig-Geo] Best way to calculate distance between
	geographicalpoints
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
	<MPG.25b908c588a53e369896d1@news.gmane.org>
	<2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>
	<alpine.LRH.2.00.1001141205300.12049@reclus.nhh.no>
Message-ID: <MPG.25b9229c74b677ff9896d2@news.gmane.org>

On Thu, 14 Jan 2010 12:27:04 +0100 (CET) Roger Bivand 
<Roger.Bivand at nhh.no> wrote:
> So in principle geod.dist() and spDistsN1(..., longlat=TRUE) should yield 
> equivalent results, because their assumptions are the same.
> 
> Several of the references suggest that the geographic pole should not be 
> input. It looks as though the oce implementation handles this more 
> gracefully than sp.
> 
> Hope this helps,

It does. Thanks.

BTW, is there a reason 'spDistsN1' handle longitude 360 different from 
longitude 0? For example, the distance between 0,0 and 0,0 is 0, but the 
distance between 0,0 and 360,0 is about 1e-12. This is of course not a 
problem; I was just wondering on the reason (since 360,0 is for all 
practical *correctly* handled -- it's just not handled equal to 0,0).

-- 
Karl Ove Hufthammer


From Roger.Bivand at nhh.no  Thu Jan 14 14:52:29 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Jan 2010 14:52:29 +0100 (CET)
Subject: [R-sig-Geo] Best way to calculate distance between
 geographicalpoints
In-Reply-To: <MPG.25b9229c74b677ff9896d2@news.gmane.org>
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
	<MPG.25b908c588a53e369896d1@news.gmane.org>
	<2E9C414912813E4EB981326983E0A10406F2ACC0@inboexch.inbo.be>
	<alpine.LRH.2.00.1001141205300.12049@reclus.nhh.no>
	<MPG.25b9229c74b677ff9896d2@news.gmane.org>
Message-ID: <alpine.LRH.2.00.1001141429350.12049@reclus.nhh.no>

On Thu, 14 Jan 2010, Karl Ove Hufthammer wrote:

> On Thu, 14 Jan 2010 12:27:04 +0100 (CET) Roger Bivand
> <Roger.Bivand at nhh.no> wrote:
>> So in principle geod.dist() and spDistsN1(..., longlat=TRUE) should yield
>> equivalent results, because their assumptions are the same.
>>
>> Several of the references suggest that the geographic pole should not be
>> input. It looks as though the oce implementation handles this more
>> gracefully than sp.
>>
>> Hope this helps,
>
> It does. Thanks.
>
> BTW, is there a reason 'spDistsN1' handle longitude 360 different from
> longitude 0? For example, the distance between 0,0 and 0,0 is 0, but the
> distance between 0,0 and 360,0 is about 1e-12. This is of course not a
> problem; I was just wondering on the reason (since 360,0 is for all
> practical *correctly* handled -- it's just not handled equal to 0,0).

The C function now tests for equality in the longitude and latitude pairs, 
but arguably should catch this. Equality is taken here as an absolute 
difference of less than .Machine$double.eps, about 2.220446e-16. I've 
committed a change to sourceforge, setting distance to 0.0 for

(|lat0 - lat1| < fuzz) && (|lon0 - lon1| < fuzz)

as before, but also:

(|lat0 - lat1| < fuzz) && (((|lon0| + |lon1|) - 360.0) < fuzz)

which seems to handle your case, and others - like -170, 190. Comments 
welcome.

Roger

>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From j.skoien at geo.uu.nl  Thu Jan 14 15:19:09 2010
From: j.skoien at geo.uu.nl (Jon Olav Skoien)
Date: Thu, 14 Jan 2010 15:19:09 +0100
Subject: [R-sig-Geo] anisotropy - intamap
In-Reply-To: <01NIEZWJDRES001C0Z@mx1.pd.cnr.it>
References: <01NIEZWJDRES001C0Z@mx1.pd.cnr.it>
Message-ID: <4B4F27DD.8020202@geo.uu.nl>

Hi Seba,

Your impression was unfortunately right, in the current version of the 
package on CRAN it is not possible for the anisotropy detection method 
to take trends into account. Although the trend and the anisotropy 
parameters should ideally be estimated jointly, I think it would be a 
decent approximation to estimate the trend first, and the anisotropy 
from these residuals. This has been included in a test version that you 
can download from:

http://www.intamap.org/downloads/intamap_1.3-3.zip
http://www.intamap.org/downloads/intamap_1.3-3.tar.gz

I will check the results of the change a bit more, then upload to CRAN.

Cheers,
Jon


seba wrote:
> Dear list members
>
> I have a tecnical question in relation to the calculation of variogram 
> anisotropy in presence of a trend with estimateParameters function.
> I have a data set "w" with a clear trend (degree 1) so I would like to 
> calculate geometric anisotropy of residuals.
> I do the following:
>  bingo=createIntamapObject(observations=w,formulaString=as.formula(z~x+y),params=getIntamapParams(),class="automap") 
>
>  estimateParameters(bingo,model=c("Pow"))->p
>
> But when I go to check for anisotropy I have the impression that the 
> anisotropy calculated is relative to the raw variogram not to the 
> residual one:
> Is it possible?
> Is there something wrong in my expression?
> Thank you in advance for your help.
>
> Bye
> Sebastiano
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From sebastiano.trevisani at libero.it  Thu Jan 14 15:34:49 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Thu, 14 Jan 2010 15:34:49 +0100
Subject: [R-sig-Geo] anisotropy - intamap
In-Reply-To: <4B4F27DD.8020202@geo.uu.nl>
References: <01NIEZWJDRES001C0Z@mx1.pd.cnr.it> <4B4F27DD.8020202@geo.uu.nl>
Message-ID: <01NIGDW5AJTA001FLH@mx1.pd.cnr.it>

Hi Jon

Thank you for the quick reply.
For my job I did my task (this morning) exactly following the 
procedure you mentioned (i.e. I calculated first the residuals)
and now things work well, very well!
I think that the proposed approximation is the only one possible, 
i.e. first remove the trend and then check for anisotropy of residuals.
As soon as possible I'll try the package you changed.
Again, thank you for the support!
Sebas


At 15.19 14/01/2010, Jon Olav Skoien wrote:
>Hi Seba,
>
>Your impression was unfortunately right, in the current version of 
>the package on CRAN it is not possible for the anisotropy detection 
>method to take trends into account. Although the trend and the 
>anisotropy parameters should ideally be estimated jointly, I think 
>it would be a decent approximation to estimate the trend first, and 
>the anisotropy from these residuals. This has been included in a 
>test version that you can download from:
>
>http://www.intamap.org/downloads/intamap_1.3-3.zip
>http://www.intamap.org/downloads/intamap_1.3-3.tar.gz
>
>I will check the results of the change a bit more, then upload to CRAN.
>
>Cheers,
>Jon
>
>
>seba wrote:
>>Dear list members
>>
>>I have a tecnical question in relation to the calculation of 
>>variogram anisotropy in presence of a trend with estimateParameters function.
>>I have a data set "w" with a clear trend (degree 1) so I would like 
>>to calculate geometric anisotropy of residuals.
>>I do the following:
>> 
>>bingo=createIntamapObject(observations=w,formulaString=as.formula(z~x+y),params=getIntamapParams(),class="automap") 
>>
>>  estimateParameters(bingo,model=c("Pow"))->p
>>
>>But when I go to check for anisotropy I have the impression that 
>>the anisotropy calculated is relative to the raw variogram not to 
>>the residual one:
>>Is it possible?
>>Is there something wrong in my expression?
>>Thank you in advance for your help.
>>
>>Bye
>>Sebastiano
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at stat.math.ethz.ch
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From cara.tobin at epfl.ch  Thu Jan 14 18:02:58 2010
From: cara.tobin at epfl.ch (Tobin Cara)
Date: Thu, 14 Jan 2010 18:02:58 +0100
Subject: [R-sig-Geo] Inverse Distance Weighting and Treating kriged data
 before cross validation
Message-ID: <EDB94195DABE64488928DD39E53B8FC68BE3039660@REX2.intranet.epfl.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100114/63006b89/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 14 19:17:12 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Jan 2010 10:17:12 -0800
Subject: [R-sig-Geo] Best way to calculate distance between geographical
	points
In-Reply-To: <MPG.25b901dd54bad269896d0@news.gmane.org>
References: <MPG.25b901dd54bad269896d0@news.gmane.org>
Message-ID: <dc22b2571001141017x40cd6caar544d87bd170fe0fd@mail.gmail.com>

In the geosphere package on R-Forge there are a number of distance
functions (from law of cosines to more complex) as well as related
spherical trig functions, such as computing paths along a
great-circle. There is also pointDistance in the raster package.

Robert

On Thu, Jan 14, 2010 at 1:27 AM, Karl Ove Hufthammer <karl at huftis.org> wrote:
> Dear list members
>
> I have found three functions for calculating the distance between
> geographical points, 'geo.dist' in the 'oce' package, 'rdist.earth' in
> the 'fields' package, and 'spDistsN1' in the 'sp' package. They all give
> slightly difference answers, so my question is: which of them is best,
> i.e., gives the most accurate answer?
>
> When it comes to performance, the 'rbenchmark' package shows that (at
> least on calculating a single distance), 'spDistsN1' is the fastest,
> 'geo.dist' takes twice as long, and 'rdist.earth' takes about five times
> as long (as 'spDistsN1').
>
> --
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Fri Jan 15 12:14:54 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 15 Jan 2010 12:14:54 +0100
Subject: [R-sig-Geo] Inverse Distance Weighting and Treating kriged data
 before cross validation
In-Reply-To: <EDB94195DABE64488928DD39E53B8FC68BE3039660@REX2.intranet.epfl.ch>
References: <EDB94195DABE64488928DD39E53B8FC68BE3039660@REX2.intranet.epfl.ch>
Message-ID: <4B504E2E.9030102@uni-muenster.de>

Dear Cara,

one way would be to copy krige.cv to your own function and modify this; 
I would recommend this if you want leave-one-out cross validation.

If n-fold cross validation is good enough for a few folds, e.g. because 
you have plenty of data, then I would do the whole procedure "manually", 
using predict, krige or idw on the points of a particular fold using the 
data from the remaining folds.
--
Edzer


Tobin Cara wrote:
> Hello,
>
> I am using inverse distance weighting with gstat for temperature just to compare it with other kriging methods. For a temperature field, I have removed the elevation effect at the stations by normalizing all stations to the lowest with a lapse rate of -6.5 deg C /1000 m.
>
> Now, I want to krig the normalized data and then add back the lapse rate multiplied by the difference in elevation to get the real temperatures at all real elevations. However, how can I do this before cross validation?
>
> I only know cross validation with the following command where it does not allow manipulation of the kriged field before cross validation:
>
> crossval_idw <- krige.cv(Temp93hr~1, DataCoordhr)
>
> Thank you in advance for your help.
>
> Cheers,
>
> Cara
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From cara.tobin at epfl.ch  Fri Jan 15 15:26:28 2010
From: cara.tobin at epfl.ch (Tobin Cara)
Date: Fri, 15 Jan 2010 15:26:28 +0100
Subject: [R-sig-Geo] RE : Inverse Distance Weighting and Treating kriged
 data before cross validation
In-Reply-To: <4B504E2E.9030102@uni-muenster.de>
References: <EDB94195DABE64488928DD39E53B8FC68BE3039660@REX2.intranet.epfl.ch>,
	<4B504E2E.9030102@uni-muenster.de>
Message-ID: <EDB94195DABE64488928DD39E53B8FC68BE3039662@REX2.intranet.epfl.ch>

Hello Prof. Pebesma,

I would like to use leave-one-out cross validation to have a fair comparison with my other methods. 

Could you explain further how to copy krige.cv to my own function and modify? Can I open up the krige.cv code somewhere? I am still new to R.

Thank you in advance,

Cara
________________________________________
De : Edzer Pebesma [edzer.pebesma at uni-muenster.de]
Date d'envoi : vendredi, 15. janvier 2010 12:14
? : Tobin Cara
Cc : r-sig-geo at stat.math.ethz.ch
Objet : Re: [R-sig-Geo] Inverse Distance Weighting and Treating kriged data before cross validation

Dear Cara,

one way would be to copy krige.cv to your own function and modify this;
I would recommend this if you want leave-one-out cross validation.

If n-fold cross validation is good enough for a few folds, e.g. because
you have plenty of data, then I would do the whole procedure "manually",
using predict, krige or idw on the points of a particular fold using the
data from the remaining folds.
--
Edzer


Tobin Cara wrote:
> Hello,
>
> I am using inverse distance weighting with gstat for temperature just to compare it with other kriging methods. For a temperature field, I have removed the elevation effect at the stations by normalizing all stations to the lowest with a lapse rate of -6.5 deg C /1000 m.
>
> Now, I want to krig the normalized data and then add back the lapse rate multiplied by the difference in elevation to get the real temperatures at all real elevations. However, how can I do this before cross validation?
>
> I only know cross validation with the following command where it does not allow manipulation of the kriged field before cross validation:
>
> crossval_idw <- krige.cv(Temp93hr~1, DataCoordhr)
>
> Thank you in advance for your help.
>
> Cheers,
>
> Cara
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

From edzer.pebesma at uni-muenster.de  Fri Jan 15 15:50:18 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 15 Jan 2010 15:50:18 +0100
Subject: [R-sig-Geo] RE : Inverse Distance Weighting and Treating kriged
 data before cross validation
In-Reply-To: <EDB94195DABE64488928DD39E53B8FC68BE3039662@REX2.intranet.epfl.ch>
References: <EDB94195DABE64488928DD39E53B8FC68BE3039660@REX2.intranet.epfl.ch>,
	<4B504E2E.9030102@uni-muenster.de>
	<EDB94195DABE64488928DD39E53B8FC68BE3039662@REX2.intranet.epfl.ch>
Message-ID: <4B5080AA.2040301@uni-muenster.de>

mykrige.cv = gstat:::krige.cv.spatial
mykrige.cv = edit(mykrige.cv)

then, you will find out that you will have to do the same with gstat.cv, 
and that gstat.cv is rather cryptic as it deals with cokriging of which 
ordinary kriging is a special case.

Maybe it wasn't such a good idea after all if you're new to R, sorry.

Tobin Cara wrote:
> Hello Prof. Pebesma,
>
> I would like to use leave-one-out cross validation to have a fair comparison with my other methods. 
>
> Could you explain further how to copy krige.cv to my own function and modify? Can I open up the krige.cv code somewhere? I am still new to R.
>
> Thank you in advance,
>
> Cara
> ________________________________________
> De : Edzer Pebesma [edzer.pebesma at uni-muenster.de]
> Date d'envoi : vendredi, 15. janvier 2010 12:14
> ? : Tobin Cara
> Cc : r-sig-geo at stat.math.ethz.ch
> Objet : Re: [R-sig-Geo] Inverse Distance Weighting and Treating kriged data before cross validation
>
> Dear Cara,
>
> one way would be to copy krige.cv to your own function and modify this;
> I would recommend this if you want leave-one-out cross validation.
>
> If n-fold cross validation is good enough for a few folds, e.g. because
> you have plenty of data, then I would do the whole procedure "manually",
> using predict, krige or idw on the points of a particular fold using the
> data from the remaining folds.
> --
> Edzer
>
>
> Tobin Cara wrote:
>   
>> Hello,
>>
>> I am using inverse distance weighting with gstat for temperature just to compare it with other kriging methods. For a temperature field, I have removed the elevation effect at the stations by normalizing all stations to the lowest with a lapse rate of -6.5 deg C /1000 m.
>>
>> Now, I want to krig the normalized data and then add back the lapse rate multiplied by the difference in elevation to get the real temperatures at all real elevations. However, how can I do this before cross validation?
>>
>> I only know cross validation with the following command where it does not allow manipulation of the kriged field before cross validation:
>>
>> crossval_idw <- krige.cv(Temp93hr~1, DataCoordhr)
>>
>> Thank you in advance for your help.
>>
>> Cheers,
>>
>> Cara
>>
>>       [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From cara.tobin at epfl.ch  Fri Jan 15 17:04:58 2010
From: cara.tobin at epfl.ch (Tobin Cara)
Date: Fri, 15 Jan 2010 17:04:58 +0100
Subject: [R-sig-Geo] ordinary kriging and elevation with GSTAT
Message-ID: <EDB94195DABE64488928DD39E53B8FC68BE3039665@REX2.intranet.epfl.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100115/f682db8a/attachment.pl>

From reeves at nceas.ucsb.edu  Fri Jan 15 18:37:48 2010
From: reeves at nceas.ucsb.edu (rick reeves)
Date: Fri, 15 Jan 2010 09:37:48 -0800
Subject: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon Overlay
 with R Spatial objects..
Message-ID: <4B50A7EC.3000902@nceas.ucsb.edu>

Hello List:

I have been reviewing techniques within R for performing the GIS-like 
operation
'polygon algebra'  (computing the union and intersection of polygons within
two SpatialPolygonDataFrame objects). The goal is to combine two polygon
data frames, to produce a new polygon data frames that contain the union
or intersection of the two input sets.

Thus far, the only method that I have found for this is the combinePolys()
method within the PBSmapping package. The PBSmapping routines work
well, but require the transformation out of the SpatialXXXDataFrame classes.

The overlay() method within sp seems like the best routine for this job 
as it
performs intersection operations on pairs of Spatial objects, but it
does not appear to operate on two SpatialPolygonDataFrame objects.
So I have not tried to use it for this.

Do other packages contain polygon algebra routines that operate on the 
Spatial classes?
If not, are there any alternatives to the PBSmapping methods?

Thanks,
Rick R



-- 
Rick Reeves
Scientific Programmer/Analyst and Data Manager
National Center for Ecological Analysis and Synthesis
UC Santa Barbara
www.nceas.ucsb.edu
805 892 2533


From Roger.Bivand at nhh.no  Fri Jan 15 20:00:30 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
Subject: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
 Overlay with R Spatial objects..
In-Reply-To: <4B50A7EC.3000902@nceas.ucsb.edu>
References: <4B50A7EC.3000902@nceas.ucsb.edu>
Message-ID: <alpine.LRH.2.00.1001151932080.18465@reclus.nhh.no>

On Fri, 15 Jan 2010, rick reeves wrote:

> Hello List:
>
> I have been reviewing techniques within R for performing the GIS-like 
> operation 'polygon algebra' (computing the union and intersection of 
> polygons within two SpatialPolygonDataFrame objects). The goal is to 
> combine two polygon data frames, to produce a new polygon data frames 
> that contain the union or intersection of the two input sets.
>
> Thus far, the only method that I have found for this is the 
> combinePolys() method within the PBSmapping package. The PBSmapping 
> routines work well, but require the transformation out of the 
> SpatialXXXDataFrame classes.

For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps 
better, don't look yet. The underlying problem is the license of the 
gpclib package, which should be avoided. The reason for attention to 
package licenses is that CRAN is getting very large, and taking 
responsibility for distributing non-free software through package 
dependencies needs to be automated. So GPL and other free packages should 
not depend on or suggest non-free packages, because users (including 
commercial users) may not be aware that they are using packages with 
non-free licences. Some of these users already block the installation of 
free packages with "upstream" non-free dependencies, and more will do so 
in the future.

One solution is the R-Forge rgeos package, which I'm working on.

https://r-forge.r-project.org/projects/rgeos/

Before long, again thanks to Uwe Ligges and others, we should have a 
working production line for Windows binary packages with GEOS 3.1.1 
included. Linux distributions have binaries or can install from source; 
OSX has a Kyngchaos framework to handle the external dependency on GEOS.

rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN, will 
be used by maptools in unionSpatialPolygons() if rgeos is available.

GEOS has the necessary functions to do what you would like, but someone 
has to write the R and C code and add it to rgeos. The current 
SpatialLinesIntersections() function returns a SpatialPointsDataFrame 
object with the IDs if the intersecting lines, but more is needed for 
SpatialPolygons intersection. The handling of the data frame variables is 
far from obvious too - just copying across count or rate variables isn't 
appropriate. Most likely the handling of the data slots would have to be 
done by hand for the new SpatialPolygons objects based on the intersecting 
ID values.

R-Forge has the possibility for new developers to join projects ...

Hope this helps,

Roger

>
> The overlay() method within sp seems like the best routine for this job as it
> performs intersection operations on pairs of Spatial objects, but it
> does not appear to operate on two SpatialPolygonDataFrame objects.
> So I have not tried to use it for this.
>
> Do other packages contain polygon algebra routines that operate on the 
> Spatial classes?
> If not, are there any alternatives to the PBSmapping methods?
>
> Thanks,
> Rick R
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pcrutcher at gmail.com  Sun Jan 17 02:35:03 2010
From: pcrutcher at gmail.com (Patrick Crutcher)
Date: Sat, 16 Jan 2010 17:35:03 -0800
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
Message-ID: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100116/d175365c/attachment.pl>

From p.hiemstra at geo.uu.nl  Sun Jan 17 11:31:45 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Sun, 17 Jan 2010 11:31:45 +0100
Subject: [R-sig-Geo] ordinary kriging and elevation with GSTAT
In-Reply-To: <EDB94195DABE64488928DD39E53B8FC68BE3039665@REX2.intranet.epfl.ch>
References: <EDB94195DABE64488928DD39E53B8FC68BE3039665@REX2.intranet.epfl.ch>
Message-ID: <4B52E711.2030101@geo.uu.nl>

Tobin Cara wrote:
> Hello,
>
> If I generate a variogram with an outside program on the x-y plane, would this variogram be valid for ordinary kriging in gstat? I am giving gstat the x,y,z coordinates and I am trying to predict at the elevations of a digital elevation model.
>
> Thank you in advance for taking the time to answer such a basic question.
>
> Cheers,
>
> Cara
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Hi,

I would say there is no reason why not. But what do you mean by 
variogram, I think the variogram model. To use the model in R you only 
need to put it into the correct format.

library(automap)
data(meuse)
coordinates(meuse) = ~x+y
kr = autoKrige(meuse)
class(kr$var_model)
kr$var_model
str(kr$var_model)

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From nikko at hailmail.net  Sun Jan 17 17:23:18 2010
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Sun, 17 Jan 2010 08:23:18 -0800
Subject: [R-sig-Geo] Status of gpclib license (was: Alternate methods:
 Polygon Algebra / Polygon Overlay with R Spatial objects..)
In-Reply-To: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1263745398.28631.1355102339@webmail.messagingengine.com>

Hi Roger,
I thought I remembered that at some point you had contacted the author
of gpclib and gotten permission to release the package under gpl. Has
that changed or is senility completely catching up with me.

Nicholas


> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: rick reeves <reeves at nceas.ucsb.edu>
> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
> 	Overlay with R Spatial objects..
> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
> 
> On Fri, 15 Jan 2010, rick reeves wrote:
> 
> > Hello List:
> >
> > I have been reviewing techniques within R for performing the GIS-like 
> > operation 'polygon algebra' (computing the union and intersection of 
> > polygons within two SpatialPolygonDataFrame objects). The goal is to 
> > combine two polygon data frames, to produce a new polygon data frames 
> > that contain the union or intersection of the two input sets.
> >
> > Thus far, the only method that I have found for this is the 
> > combinePolys() method within the PBSmapping package. The PBSmapping 
> > routines work well, but require the transformation out of the 
> > SpatialXXXDataFrame classes.
> 
> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps 
> better, don't look yet. The underlying problem is the license of the 
> gpclib package, which should be avoided. The reason for attention to 
> package licenses is that CRAN is getting very large, and taking 
> responsibility for distributing non-free software through package 
> dependencies needs to be automated. So GPL and other free packages should 
> not depend on or suggest non-free packages, because users (including 
> commercial users) may not be aware that they are using packages with 
> non-free licences. Some of these users already block the installation of 
> free packages with "upstream" non-free dependencies, and more will do so 
> in the future.
> 
> One solution is the R-Forge rgeos package, which I'm working on.
> 
> https://r-forge.r-project.org/projects/rgeos/
> 
> Before long, again thanks to Uwe Ligges and others, we should have a 
> working production line for Windows binary packages with GEOS 3.1.1 
> included. Linux distributions have binaries or can install from source; 
> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
> 
> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
> will 
> be used by maptools in unionSpatialPolygons() if rgeos is available.
> 
> GEOS has the necessary functions to do what you would like, but someone 
> has to write the R and C code and add it to rgeos. The current 
> SpatialLinesIntersections() function returns a SpatialPointsDataFrame 
> object with the IDs if the intersecting lines, but more is needed for 
> SpatialPolygons intersection. The handling of the data frame variables is 
> far from obvious too - just copying across count or rate variables isn't 
> appropriate. Most likely the handling of the data slots would have to be 
> done by hand for the new SpatialPolygons objects based on the
> intersecting 
> ID values.
> 
> R-Forge has the possibility for new developers to join projects ...
> 
> Hope this helps,
> 
> Roger
> 
> >
> > The overlay() method within sp seems like the best routine for this job as it
> > performs intersection operations on pairs of Spatial objects, but it
> > does not appear to operate on two SpatialPolygonDataFrame objects.
> > So I have not tried to use it for this.
> >
> > Do other packages contain polygon algebra routines that operate on the 
> > Spatial classes?
> > If not, are there any alternatives to the PBSmapping methods?
> >
> > Thanks,
> > Rick R
> >
> >
> >
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 77, Issue 13
> *****************************************


From edzer.pebesma at uni-muenster.de  Sun Jan 17 17:44:59 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 17 Jan 2010 17:44:59 +0100
Subject: [R-sig-Geo] Status of gpclib license
In-Reply-To: <1263745398.28631.1355102339@webmail.messagingengine.com>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
	<1263745398.28631.1355102339@webmail.messagingengine.com>
Message-ID: <4B533E8B.6090802@uni-muenster.de>

Nicholas,

this is unlikely; if true, the author would have done well to update his 
software page http://www.cs.manchester.ac.uk/~toby/alan/software/ and 
the corresponding wikipedia entry, 
http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library

Even (some) universities can these days be very picky with licensing 
when someone at the administration level smells money revenues from 
software developed by one of the employees; they might claim that 
anything produced by the employees in work time is owned by the university.

Best wishes,
--
Edzer

Nicholas Lewin-Koh wrote:
> Hi Roger,
> I thought I remembered that at some point you had contacted the author
> of gpclib and gotten permission to release the package under gpl. Has
> that changed or is senility completely catching up with me.
>
> Nicholas
>
>
>   
>> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
>> From: Roger Bivand <Roger.Bivand at nhh.no>
>> To: rick reeves <reeves at nceas.ucsb.edu>
>> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
>> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
>> 	Overlay with R Spatial objects..
>> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
>> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
>>
>> On Fri, 15 Jan 2010, rick reeves wrote:
>>
>>     
>>> Hello List:
>>>
>>> I have been reviewing techniques within R for performing the GIS-like 
>>> operation 'polygon algebra' (computing the union and intersection of 
>>> polygons within two SpatialPolygonDataFrame objects). The goal is to 
>>> combine two polygon data frames, to produce a new polygon data frames 
>>> that contain the union or intersection of the two input sets.
>>>
>>> Thus far, the only method that I have found for this is the 
>>> combinePolys() method within the PBSmapping package. The PBSmapping 
>>> routines work well, but require the transformation out of the 
>>> SpatialXXXDataFrame classes.
>>>       
>> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps 
>> better, don't look yet. The underlying problem is the license of the 
>> gpclib package, which should be avoided. The reason for attention to 
>> package licenses is that CRAN is getting very large, and taking 
>> responsibility for distributing non-free software through package 
>> dependencies needs to be automated. So GPL and other free packages should 
>> not depend on or suggest non-free packages, because users (including 
>> commercial users) may not be aware that they are using packages with 
>> non-free licences. Some of these users already block the installation of 
>> free packages with "upstream" non-free dependencies, and more will do so 
>> in the future.
>>
>> One solution is the R-Forge rgeos package, which I'm working on.
>>
>> https://r-forge.r-project.org/projects/rgeos/
>>
>> Before long, again thanks to Uwe Ligges and others, we should have a 
>> working production line for Windows binary packages with GEOS 3.1.1 
>> included. Linux distributions have binaries or can install from source; 
>> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
>>
>> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
>> will 
>> be used by maptools in unionSpatialPolygons() if rgeos is available.
>>
>> GEOS has the necessary functions to do what you would like, but someone 
>> has to write the R and C code and add it to rgeos. The current 
>> SpatialLinesIntersections() function returns a SpatialPointsDataFrame 
>> object with the IDs if the intersecting lines, but more is needed for 
>> SpatialPolygons intersection. The handling of the data frame variables is 
>> far from obvious too - just copying across count or rate variables isn't 
>> appropriate. Most likely the handling of the data slots would have to be 
>> done by hand for the new SpatialPolygons objects based on the
>> intersecting 
>> ID values.
>>
>> R-Forge has the possibility for new developers to join projects ...
>>
>> Hope this helps,
>>
>> Roger
>>
>>     
>>> The overlay() method within sp seems like the best routine for this job as it
>>> performs intersection operations on pairs of Spatial objects, but it
>>> does not appear to operate on two SpatialPolygonDataFrame objects.
>>> So I have not tried to use it for this.
>>>
>>> Do other packages contain polygon algebra routines that operate on the 
>>> Spatial classes?
>>> If not, are there any alternatives to the PBSmapping methods?
>>>
>>> Thanks,
>>> Rick R
>>>
>>>
>>>
>>>
>>>       
>> -- 
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> End of R-sig-Geo Digest, Vol 77, Issue 13
>> *****************************************
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From nikko at hailmail.net  Sun Jan 17 18:48:37 2010
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Sun, 17 Jan 2010 09:48:37 -0800
Subject: [R-sig-Geo] Status of gpclib license
In-Reply-To: <4B533E8B.6090802@uni-muenster.de>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
	<1263745398.28631.1355102339@webmail.messagingengine.com>
	<4B533E8B.6090802@uni-muenster.de>
Message-ID: <1263750517.9031.1355110401@webmail.messagingengine.com>

Hi,
Thanks, I must be remembering something else then. I hope I am not APOE4
+/+.

Nicholas

On Sun, 17 Jan 2010 17:44 +0100, "Edzer Pebesma"
<edzer.pebesma at uni-muenster.de> wrote:
> Nicholas,
> 
> this is unlikely; if true, the author would have done well to update his 
> software page http://www.cs.manchester.ac.uk/~toby/alan/software/ and 
> the corresponding wikipedia entry, 
> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
> 
> Even (some) universities can these days be very picky with licensing 
> when someone at the administration level smells money revenues from 
> software developed by one of the employees; they might claim that 
> anything produced by the employees in work time is owned by the
> university.
> 
> Best wishes,
> --
> Edzer
> 
> Nicholas Lewin-Koh wrote:
> > Hi Roger,
> > I thought I remembered that at some point you had contacted the author
> > of gpclib and gotten permission to release the package under gpl. Has
> > that changed or is senility completely catching up with me.
> >
> > Nicholas
> >
> >
> >   
> >> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
> >> From: Roger Bivand <Roger.Bivand at nhh.no>
> >> To: rick reeves <reeves at nceas.ucsb.edu>
> >> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
> >> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
> >> 	Overlay with R Spatial objects..
> >> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
> >> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
> >>
> >> On Fri, 15 Jan 2010, rick reeves wrote:
> >>
> >>     
> >>> Hello List:
> >>>
> >>> I have been reviewing techniques within R for performing the GIS-like 
> >>> operation 'polygon algebra' (computing the union and intersection of 
> >>> polygons within two SpatialPolygonDataFrame objects). The goal is to 
> >>> combine two polygon data frames, to produce a new polygon data frames 
> >>> that contain the union or intersection of the two input sets.
> >>>
> >>> Thus far, the only method that I have found for this is the 
> >>> combinePolys() method within the PBSmapping package. The PBSmapping 
> >>> routines work well, but require the transformation out of the 
> >>> SpatialXXXDataFrame classes.
> >>>       
> >> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps 
> >> better, don't look yet. The underlying problem is the license of the 
> >> gpclib package, which should be avoided. The reason for attention to 
> >> package licenses is that CRAN is getting very large, and taking 
> >> responsibility for distributing non-free software through package 
> >> dependencies needs to be automated. So GPL and other free packages should 
> >> not depend on or suggest non-free packages, because users (including 
> >> commercial users) may not be aware that they are using packages with 
> >> non-free licences. Some of these users already block the installation of 
> >> free packages with "upstream" non-free dependencies, and more will do so 
> >> in the future.
> >>
> >> One solution is the R-Forge rgeos package, which I'm working on.
> >>
> >> https://r-forge.r-project.org/projects/rgeos/
> >>
> >> Before long, again thanks to Uwe Ligges and others, we should have a 
> >> working production line for Windows binary packages with GEOS 3.1.1 
> >> included. Linux distributions have binaries or can install from source; 
> >> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
> >>
> >> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
> >> will 
> >> be used by maptools in unionSpatialPolygons() if rgeos is available.
> >>
> >> GEOS has the necessary functions to do what you would like, but someone 
> >> has to write the R and C code and add it to rgeos. The current 
> >> SpatialLinesIntersections() function returns a SpatialPointsDataFrame 
> >> object with the IDs if the intersecting lines, but more is needed for 
> >> SpatialPolygons intersection. The handling of the data frame variables is 
> >> far from obvious too - just copying across count or rate variables isn't 
> >> appropriate. Most likely the handling of the data slots would have to be 
> >> done by hand for the new SpatialPolygons objects based on the
> >> intersecting 
> >> ID values.
> >>
> >> R-Forge has the possibility for new developers to join projects ...
> >>
> >> Hope this helps,
> >>
> >> Roger
> >>
> >>     
> >>> The overlay() method within sp seems like the best routine for this job as it
> >>> performs intersection operations on pairs of Spatial objects, but it
> >>> does not appear to operate on two SpatialPolygonDataFrame objects.
> >>> So I have not tried to use it for this.
> >>>
> >>> Do other packages contain polygon algebra routines that operate on the 
> >>> Spatial classes?
> >>> If not, are there any alternatives to the PBSmapping methods?
> >>>
> >>> Thanks,
> >>> Rick R
> >>>
> >>>
> >>>
> >>>
> >>>       
> >> -- 
> >> Roger Bivand
> >> Economic Geography Section, Department of Economics, Norwegian School of
> >> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >> e-mail: Roger.Bivand at nhh.no
> >>
> >>
> >>
> >> ------------------------------
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>
> >> End of R-sig-Geo Digest, Vol 77, Issue 13
> >> *****************************************
> >>     
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >   
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster 
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 


From Roger.Bivand at nhh.no  Sun Jan 17 20:07:58 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 17 Jan 2010 20:07:58 +0100 (CET)
Subject: [R-sig-Geo] Status of gpclib license
In-Reply-To: <1263750517.9031.1355110401@webmail.messagingengine.com>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
	<1263745398.28631.1355102339@webmail.messagingengine.com>
	<4B533E8B.6090802@uni-muenster.de>
	<1263750517.9031.1355110401@webmail.messagingengine.com>
Message-ID: <alpine.LRH.2.00.1001171949260.26208@reclus.nhh.no>

On Sun, 17 Jan 2010, Nicholas Lewin-Koh wrote:

> Hi,
> Thanks, I must be remembering something else then. I hope I am not APOE4
> +/+.

Hi Nicholas,

I wouldn't worry more than we all have to! About 5 years ago an attempt 
was made to find out what the license of the underlying C code was, but 
did not resolve the situation. The gpc C code states:

"This software is free for non-commercial use. It may be copied, modified, 
and redistributed provided that this copyright notice is preserved on all 
copies. The intellectual property rights of the algorithms used reside 
with the University of Manchester Advanced Interfaces Group.

You may not use this software, in whole or in part, in support of any 
commercial product without the express consent of the author.

There is no warranty or other guarantee of fitness of this software for 
any purpose. It is provided solely "as is"."

The meaning of "in support of any commercial product" is not clear, so 
gpclib is non-free.

When CRAN had few packages, and packages had few dependencies, users could 
control the licenses of packages loaded into the R engine manually (if 
they cared - they should!). Now it needs automating, so that from 2.10.0, 
R ships with a database of known licenses (in share/licences), which are 
linked in CRAN too. The License: field is now parsed automatically, and 
will, as I mentioned before but repeat as a "heads up" to others reading 
this reply, be used to allow users installing packages to set thresholds 
such as "only free" before long.

Best wishes,

Roger

>
> Nicholas
>
> On Sun, 17 Jan 2010 17:44 +0100, "Edzer Pebesma"
> <edzer.pebesma at uni-muenster.de> wrote:
>> Nicholas,
>>
>> this is unlikely; if true, the author would have done well to update his
>> software page http://www.cs.manchester.ac.uk/~toby/alan/software/ and
>> the corresponding wikipedia entry,
>> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
>>
>> Even (some) universities can these days be very picky with licensing
>> when someone at the administration level smells money revenues from
>> software developed by one of the employees; they might claim that
>> anything produced by the employees in work time is owned by the
>> university.
>>
>> Best wishes,
>> --
>> Edzer
>>
>> Nicholas Lewin-Koh wrote:
>>> Hi Roger,
>>> I thought I remembered that at some point you had contacted the author
>>> of gpclib and gotten permission to release the package under gpl. Has
>>> that changed or is senility completely catching up with me.
>>>
>>> Nicholas
>>>
>>>
>>>
>>>> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
>>>> From: Roger Bivand <Roger.Bivand at nhh.no>
>>>> To: rick reeves <reeves at nceas.ucsb.edu>
>>>> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
>>>> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
>>>> 	Overlay with R Spatial objects..
>>>> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
>>>> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
>>>>
>>>> On Fri, 15 Jan 2010, rick reeves wrote:
>>>>
>>>>
>>>>> Hello List:
>>>>>
>>>>> I have been reviewing techniques within R for performing the GIS-like
>>>>> operation 'polygon algebra' (computing the union and intersection of
>>>>> polygons within two SpatialPolygonDataFrame objects). The goal is to
>>>>> combine two polygon data frames, to produce a new polygon data frames
>>>>> that contain the union or intersection of the two input sets.
>>>>>
>>>>> Thus far, the only method that I have found for this is the
>>>>> combinePolys() method within the PBSmapping package. The PBSmapping
>>>>> routines work well, but require the transformation out of the
>>>>> SpatialXXXDataFrame classes.
>>>>>
>>>> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps
>>>> better, don't look yet. The underlying problem is the license of the
>>>> gpclib package, which should be avoided. The reason for attention to
>>>> package licenses is that CRAN is getting very large, and taking
>>>> responsibility for distributing non-free software through package
>>>> dependencies needs to be automated. So GPL and other free packages should
>>>> not depend on or suggest non-free packages, because users (including
>>>> commercial users) may not be aware that they are using packages with
>>>> non-free licences. Some of these users already block the installation of
>>>> free packages with "upstream" non-free dependencies, and more will do so
>>>> in the future.
>>>>
>>>> One solution is the R-Forge rgeos package, which I'm working on.
>>>>
>>>> https://r-forge.r-project.org/projects/rgeos/
>>>>
>>>> Before long, again thanks to Uwe Ligges and others, we should have a
>>>> working production line for Windows binary packages with GEOS 3.1.1
>>>> included. Linux distributions have binaries or can install from source;
>>>> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
>>>>
>>>> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
>>>> will
>>>> be used by maptools in unionSpatialPolygons() if rgeos is available.
>>>>
>>>> GEOS has the necessary functions to do what you would like, but someone
>>>> has to write the R and C code and add it to rgeos. The current
>>>> SpatialLinesIntersections() function returns a SpatialPointsDataFrame
>>>> object with the IDs if the intersecting lines, but more is needed for
>>>> SpatialPolygons intersection. The handling of the data frame variables is
>>>> far from obvious too - just copying across count or rate variables isn't
>>>> appropriate. Most likely the handling of the data slots would have to be
>>>> done by hand for the new SpatialPolygons objects based on the
>>>> intersecting
>>>> ID values.
>>>>
>>>> R-Forge has the possibility for new developers to join projects ...
>>>>
>>>> Hope this helps,
>>>>
>>>> Roger
>>>>
>>>>
>>>>> The overlay() method within sp seems like the best routine for this job as it
>>>>> performs intersection operations on pairs of Spatial objects, but it
>>>>> does not appear to operate on two SpatialPolygonDataFrame objects.
>>>>> So I have not tried to use it for this.
>>>>>
>>>>> Do other packages contain polygon algebra routines that operate on the
>>>>> Spatial classes?
>>>>> If not, are there any alternatives to the PBSmapping methods?
>>>>>
>>>>> Thanks,
>>>>> Rick R
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>> --
>>>> Roger Bivand
>>>> Economic Geography Section, Department of Economics, Norwegian School of
>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>>
>>>> ------------------------------
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>> End of R-sig-Geo Digest, Vol 77, Issue 13
>>>> *****************************************
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sun Jan 17 20:53:34 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 17 Jan 2010 20:53:34 +0100 (CET)
Subject: [R-sig-Geo] Status of gpclib license
In-Reply-To: <alpine.LRH.2.00.1001171949260.26208@reclus.nhh.no>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
	<1263745398.28631.1355102339@webmail.messagingengine.com>
	<4B533E8B.6090802@uni-muenster.de>
	<1263750517.9031.1355110401@webmail.messagingengine.com>
	<alpine.LRH.2.00.1001171949260.26208@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1001172041470.26208@reclus.nhh.no>

On Sun, 17 Jan 2010, Roger Bivand wrote:

> On Sun, 17 Jan 2010, Nicholas Lewin-Koh wrote:
>
>> Hi,
>> Thanks, I must be remembering something else then. I hope I am not APOE4
>> +/+.
>
> Hi Nicholas,
>
...
>
> When CRAN had few packages, and packages had few dependencies, users could 
> control the licenses of packages loaded into the R engine manually (if they 
> cared - they should!). Now it needs automating, so that from 2.10.0, R ships 
> with a database of known licenses (in share/licences), which are linked in 
> CRAN too. The License: field is now parsed automatically, and will, as I 
> mentioned before but repeat as a "heads up" to others reading this reply, be 
> used to allow users installing packages to set thresholds such as "only free" 
> before long.
>

"Before long" is now: if the filters= argument in available.packages() is 
set to "license/FOSS", you can see which are which. It can then be used to 
verify installed packages and potentially set policies in organisations 
needing to do that. Work on the graph of dependencies between packages is 
progressing ...

Roger

> Best wishes,
>
> Roger
>
>> 
>> Nicholas
>> 
>> On Sun, 17 Jan 2010 17:44 +0100, "Edzer Pebesma"
>> <edzer.pebesma at uni-muenster.de> wrote:
>>> Nicholas,
>>> 
>>> this is unlikely; if true, the author would have done well to update his
>>> software page http://www.cs.manchester.ac.uk/~toby/alan/software/ and
>>> the corresponding wikipedia entry,
>>> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
>>> 
>>> Even (some) universities can these days be very picky with licensing
>>> when someone at the administration level smells money revenues from
>>> software developed by one of the employees; they might claim that
>>> anything produced by the employees in work time is owned by the
>>> university.
>>> 
>>> Best wishes,
>>> --
>>> Edzer
>>> 
>>> Nicholas Lewin-Koh wrote:
>>>> Hi Roger,
>>>> I thought I remembered that at some point you had contacted the author
>>>> of gpclib and gotten permission to release the package under gpl. Has
>>>> that changed or is senility completely catching up with me.
>>>> 
>>>> Nicholas
>>>> 
>>>> 
>>>> 
>>>>> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
>>>>> From: Roger Bivand <Roger.Bivand at nhh.no>
>>>>> To: rick reeves <reeves at nceas.ucsb.edu>
>>>>> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
>>>>> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
>>>>> 	Overlay with R Spatial objects..
>>>>> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
>>>>> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
>>>>> 
>>>>> On Fri, 15 Jan 2010, rick reeves wrote:
>>>>> 
>>>>> 
>>>>>> Hello List:
>>>>>> 
>>>>>> I have been reviewing techniques within R for performing the GIS-like
>>>>>> operation 'polygon algebra' (computing the union and intersection of
>>>>>> polygons within two SpatialPolygonDataFrame objects). The goal is to
>>>>>> combine two polygon data frames, to produce a new polygon data frames
>>>>>> that contain the union or intersection of the two input sets.
>>>>>> 
>>>>>> Thus far, the only method that I have found for this is the
>>>>>> combinePolys() method within the PBSmapping package. The PBSmapping
>>>>>> routines work well, but require the transformation out of the
>>>>>> SpatialXXXDataFrame classes.
>>>>>> 
>>>>> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps
>>>>> better, don't look yet. The underlying problem is the license of the
>>>>> gpclib package, which should be avoided. The reason for attention to
>>>>> package licenses is that CRAN is getting very large, and taking
>>>>> responsibility for distributing non-free software through package
>>>>> dependencies needs to be automated. So GPL and other free packages 
>>>>> should
>>>>> not depend on or suggest non-free packages, because users (including
>>>>> commercial users) may not be aware that they are using packages with
>>>>> non-free licences. Some of these users already block the installation of
>>>>> free packages with "upstream" non-free dependencies, and more will do so
>>>>> in the future.
>>>>> 
>>>>> One solution is the R-Forge rgeos package, which I'm working on.
>>>>> 
>>>>> https://r-forge.r-project.org/projects/rgeos/
>>>>> 
>>>>> Before long, again thanks to Uwe Ligges and others, we should have a
>>>>> working production line for Windows binary packages with GEOS 3.1.1
>>>>> included. Linux distributions have binaries or can install from source;
>>>>> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
>>>>> 
>>>>> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
>>>>> will
>>>>> be used by maptools in unionSpatialPolygons() if rgeos is available.
>>>>> 
>>>>> GEOS has the necessary functions to do what you would like, but someone
>>>>> has to write the R and C code and add it to rgeos. The current
>>>>> SpatialLinesIntersections() function returns a SpatialPointsDataFrame
>>>>> object with the IDs if the intersecting lines, but more is needed for
>>>>> SpatialPolygons intersection. The handling of the data frame variables 
>>>>> is
>>>>> far from obvious too - just copying across count or rate variables isn't
>>>>> appropriate. Most likely the handling of the data slots would have to be
>>>>> done by hand for the new SpatialPolygons objects based on the
>>>>> intersecting
>>>>> ID values.
>>>>> 
>>>>> R-Forge has the possibility for new developers to join projects ...
>>>>> 
>>>>> Hope this helps,
>>>>> 
>>>>> Roger
>>>>> 
>>>>> 
>>>>>> The overlay() method within sp seems like the best routine for this job 
>>>>>> as it
>>>>>> performs intersection operations on pairs of Spatial objects, but it
>>>>>> does not appear to operate on two SpatialPolygonDataFrame objects.
>>>>>> So I have not tried to use it for this.
>>>>>> 
>>>>>> Do other packages contain polygon algebra routines that operate on the
>>>>>> Spatial classes?
>>>>>> If not, are there any alternatives to the PBSmapping methods?
>>>>>> 
>>>>>> Thanks,
>>>>>> Rick R
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>> --
>>>>> Roger Bivand
>>>>> Economic Geography Section, Department of Economics, Norwegian School of
>>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>> 
>>>>> 
>>>>> 
>>>>> ------------------------------
>>>>> 
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> 
>>>>> 
>>>>> End of R-sig-Geo Digest, Vol 77, Issue 13
>>>>> *****************************************
>>>>> 
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From ahunter at ucalgary.ca  Sun Jan 17 23:39:55 2010
From: ahunter at ucalgary.ca (Andrew Hunter)
Date: Sun, 17 Jan 2010 15:39:55 -0700
Subject: [R-sig-Geo] Thematic Map
Message-ID: <7AE08245-B84A-40D9-9321-057886DD0B66@ucalgary.ca>

Hi I am using Waller & Gotways Leukaemia data and am trying to create a plot of county population using RColorBrewer using the following:

plotvar <- NY8$POP8
plotvar <- rank(plotvar)
nclr <- 8
plotclr <- brewer.pal(nclr,"PuOr")
colornum <- cut(plotvar, nclr, labels=FALSE)
colorcode <- plotclr[colornum]
plot(NY8, fg=colorcode)

But get the following error:

> plot(NY8, fg=colorcode)
Error in plot.window(xlim = xlim, ylim = ylim, asp = asp, ...) : 
  graphical parameter "fg" has the wrong length

fg contains 281 color assignments and there are 281 polygons in the NY county data.

Using R v. 2.10.1 for Mac OS
Any guidance would be appreciated.

Regards

Andrew Hunter PEng RPSurv PhD
Assistant Professor
Department of Geomatics Engineering
Schulich School of Engineering
University of Calgary

T: +403.220.7377
F: +403.284.1980
E: ahunter (at) ucalgary (dot) ca
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


From b.rowlingson at lancaster.ac.uk  Sun Jan 17 23:50:13 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 17 Jan 2010 22:50:13 +0000
Subject: [R-sig-Geo] Thematic Map
In-Reply-To: <7AE08245-B84A-40D9-9321-057886DD0B66@ucalgary.ca>
References: <7AE08245-B84A-40D9-9321-057886DD0B66@ucalgary.ca>
Message-ID: <d8ad40b51001171450q4cf0ebach2356771bc15cfc01@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100117/6af1c1f1/attachment.pl>

From nikko at hailmail.net  Mon Jan 18 01:07:31 2010
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Sun, 17 Jan 2010 16:07:31 -0800
Subject: [R-sig-Geo] Status of gpclib license
In-Reply-To: <alpine.LRH.2.00.1001172041470.26208@reclus.nhh.no>
References: <mailman.17.1263639604.879.r-sig-geo@stat.math.ethz.ch>
	<1263745398.28631.1355102339@webmail.messagingengine.com>
	<4B533E8B.6090802@uni-muenster.de>
	<1263750517.9031.1355110401@webmail.messagingengine.com><alpine.LRH.2.00.1001171949260.26208@reclus.nhh.no>
	<alpine.LRH.2.00.1001172041470.26208@reclus.nhh.no>
Message-ID: <1263773251.15751.1355150549@webmail.messagingengine.com>

Hi Roger,
Thanks, yes I was aware of the license filtering, and the changes. This
has been very helpful for us at work where we are very commercial and
for profit, and need to keep careful track of what is on our computers.

Maybe it was PBSmapping I was remembering. 

Cheers
Nicholas

On Sun, 17 Jan 2010 20:53 +0100, "Roger Bivand" <Roger.Bivand at nhh.no>
wrote:
> On Sun, 17 Jan 2010, Roger Bivand wrote:
> 
> > On Sun, 17 Jan 2010, Nicholas Lewin-Koh wrote:
> >
> >> Hi,
> >> Thanks, I must be remembering something else then. I hope I am not APOE4
> >> +/+.
> >
> > Hi Nicholas,
> >
> ...
> >
> > When CRAN had few packages, and packages had few dependencies, users could 
> > control the licenses of packages loaded into the R engine manually (if they 
> > cared - they should!). Now it needs automating, so that from 2.10.0, R ships 
> > with a database of known licenses (in share/licences), which are linked in 
> > CRAN too. The License: field is now parsed automatically, and will, as I 
> > mentioned before but repeat as a "heads up" to others reading this reply, be 
> > used to allow users installing packages to set thresholds such as "only free" 
> > before long.
> >
> 
> "Before long" is now: if the filters= argument in available.packages() is 
> set to "license/FOSS", you can see which are which. It can then be used
> to 
> verify installed packages and potentially set policies in organisations 
> needing to do that. Work on the graph of dependencies between packages is 
> progressing ...
> 
> Roger
> 
> > Best wishes,
> >
> > Roger
> >
> >> 
> >> Nicholas
> >> 
> >> On Sun, 17 Jan 2010 17:44 +0100, "Edzer Pebesma"
> >> <edzer.pebesma at uni-muenster.de> wrote:
> >>> Nicholas,
> >>> 
> >>> this is unlikely; if true, the author would have done well to update his
> >>> software page http://www.cs.manchester.ac.uk/~toby/alan/software/ and
> >>> the corresponding wikipedia entry,
> >>> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
> >>> 
> >>> Even (some) universities can these days be very picky with licensing
> >>> when someone at the administration level smells money revenues from
> >>> software developed by one of the employees; they might claim that
> >>> anything produced by the employees in work time is owned by the
> >>> university.
> >>> 
> >>> Best wishes,
> >>> --
> >>> Edzer
> >>> 
> >>> Nicholas Lewin-Koh wrote:
> >>>> Hi Roger,
> >>>> I thought I remembered that at some point you had contacted the author
> >>>> of gpclib and gotten permission to release the package under gpl. Has
> >>>> that changed or is senility completely catching up with me.
> >>>> 
> >>>> Nicholas
> >>>> 
> >>>> 
> >>>> 
> >>>>> Date: Fri, 15 Jan 2010 20:00:30 +0100 (CET)
> >>>>> From: Roger Bivand <Roger.Bivand at nhh.no>
> >>>>> To: rick reeves <reeves at nceas.ucsb.edu>
> >>>>> Cc: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
> >>>>> Subject: Re: [R-sig-Geo] Alternate methods: Polygon Algebra / Polygon
> >>>>> 	Overlay with R Spatial objects..
> >>>>> Message-ID: <alpine.LRH.2.00.1001151932080.18465 at reclus.nhh.no>
> >>>>> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
> >>>>> 
> >>>>> On Fri, 15 Jan 2010, rick reeves wrote:
> >>>>> 
> >>>>> 
> >>>>>> Hello List:
> >>>>>> 
> >>>>>> I have been reviewing techniques within R for performing the GIS-like
> >>>>>> operation 'polygon algebra' (computing the union and intersection of
> >>>>>> polygons within two SpatialPolygonDataFrame objects). The goal is to
> >>>>>> combine two polygon data frames, to produce a new polygon data frames
> >>>>>> that contain the union or intersection of the two input sets.
> >>>>>> 
> >>>>>> Thus far, the only method that I have found for this is the
> >>>>>> combinePolys() method within the PBSmapping package. The PBSmapping
> >>>>>> routines work well, but require the transformation out of the
> >>>>>> SpatialXXXDataFrame classes.
> >>>>>> 
> >>>>> For union, aka dissolve, see unionSpatialPolygons() in maptools. Perhaps
> >>>>> better, don't look yet. The underlying problem is the license of the
> >>>>> gpclib package, which should be avoided. The reason for attention to
> >>>>> package licenses is that CRAN is getting very large, and taking
> >>>>> responsibility for distributing non-free software through package
> >>>>> dependencies needs to be automated. So GPL and other free packages 
> >>>>> should
> >>>>> not depend on or suggest non-free packages, because users (including
> >>>>> commercial users) may not be aware that they are using packages with
> >>>>> non-free licences. Some of these users already block the installation of
> >>>>> free packages with "upstream" non-free dependencies, and more will do so
> >>>>> in the future.
> >>>>> 
> >>>>> One solution is the R-Forge rgeos package, which I'm working on.
> >>>>> 
> >>>>> https://r-forge.r-project.org/projects/rgeos/
> >>>>> 
> >>>>> Before long, again thanks to Uwe Ligges and others, we should have a
> >>>>> working production line for Windows binary packages with GEOS 3.1.1
> >>>>> included. Linux distributions have binaries or can install from source;
> >>>>> OSX has a Kyngchaos framework to handle the external dependency on GEOS.
> >>>>> 
> >>>>> rgeos has unionSpatialPolygonsGEOS(), which, when rgeos reaches CRAN,
> >>>>> will
> >>>>> be used by maptools in unionSpatialPolygons() if rgeos is available.
> >>>>> 
> >>>>> GEOS has the necessary functions to do what you would like, but someone
> >>>>> has to write the R and C code and add it to rgeos. The current
> >>>>> SpatialLinesIntersections() function returns a SpatialPointsDataFrame
> >>>>> object with the IDs if the intersecting lines, but more is needed for
> >>>>> SpatialPolygons intersection. The handling of the data frame variables 
> >>>>> is
> >>>>> far from obvious too - just copying across count or rate variables isn't
> >>>>> appropriate. Most likely the handling of the data slots would have to be
> >>>>> done by hand for the new SpatialPolygons objects based on the
> >>>>> intersecting
> >>>>> ID values.
> >>>>> 
> >>>>> R-Forge has the possibility for new developers to join projects ...
> >>>>> 
> >>>>> Hope this helps,
> >>>>> 
> >>>>> Roger
> >>>>> 
> >>>>> 
> >>>>>> The overlay() method within sp seems like the best routine for this job 
> >>>>>> as it
> >>>>>> performs intersection operations on pairs of Spatial objects, but it
> >>>>>> does not appear to operate on two SpatialPolygonDataFrame objects.
> >>>>>> So I have not tried to use it for this.
> >>>>>> 
> >>>>>> Do other packages contain polygon algebra routines that operate on the
> >>>>>> Spatial classes?
> >>>>>> If not, are there any alternatives to the PBSmapping methods?
> >>>>>> 
> >>>>>> Thanks,
> >>>>>> Rick R
> >>>>>> 
> >>>>>> 
> >>>>>> 
> >>>>>> 
> >>>>>> 
> >>>>> --
> >>>>> Roger Bivand
> >>>>> Economic Geography Section, Department of Economics, Norwegian School of
> >>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >>>>> e-mail: Roger.Bivand at nhh.no
> >>>>> 
> >>>>> 
> >>>>> 
> >>>>> ------------------------------
> >>>>> 
> >>>>> _______________________________________________
> >>>>> R-sig-Geo mailing list
> >>>>> R-sig-Geo at stat.math.ethz.ch
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>> 
> >>>>> 
> >>>>> End of R-sig-Geo Digest, Vol 77, Issue 13
> >>>>> *****************************************
> >>>>> 
> >>>> 
> >>>> _______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at stat.math.ethz.ch
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>> 
> >>> 
> >>> --
> >>> Edzer Pebesma
> >>> Institute for Geoinformatics (ifgi), University of M?nster
> >>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> >>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> >>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> >>> 
> >> 
> >
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Mon Jan 18 08:06:21 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 17 Jan 2010 23:06:21 -0800
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
Message-ID: <dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>

Patrick,

I have had some success with plotting sp objects on top of G maps with
this function


gmap <- function(xy, maptype='terrain', ...) {
    require(RgoogleMaps)
	fun = points
	if (inherits(xy, 'Spatial')) {
		b = bbox(xy)
		if (inherits(xy, 'SpatialPoints')) {
			xy = coordinates(xy)
		} else {
			x = unlist(lapply(xy at polygons, function(i)slot(i, 'Polygons')))
			x = lapply(x, function(x)slot(x, 'coords'))
			xy = matrix(ncol=2, nr=0)
			for (i in 1:length(x)) xy = rbind(xy, x[[i]], c(NA,NA))
			fun = lines
		}
	} else {
		b = rbind(range(xy[,1], na.rm=TRUE), range(xy[,2], na.rm=TRUE))
	}
	mykey <-  ### fill in your google maps API key for http://localhost/
    gm <- GetMap.bbox(key=localhostkey, lonR=b[1,], latR=b[2,], maptype=maptype)
    tmp <- PlotOnStaticMap(gm, lon=xy[,1], lat=xy[,2], FUN=fun, verbose=0, ... )
}


a = matrix(runif(100)*100-50, ncol=2)
gmap(a)

library(sp)
gmap(SpatialPoints(a), col='red', cex=2, pch='+')

library(maptools)
data(wrld_simpl)
hti = wrld_simpl[wrld_simpl$ISO3=='HTI',]
gmap(hti, lwd=2, col='red')


Hth,
Robert


On Sat, Jan 16, 2010 at 5:35 PM, Patrick Crutcher <pcrutcher at gmail.com> wrote:
> I have some shapefiles I want to plot over Google Maps tiles. I have
> polygons, lines and point data. What's the most efficient way to do this?
> One path might be to use the pkg RgoogleMaps, however, it is still unclear
> to me how to do this. I assume using PlotonStaticMap with some combination
> of reformatting the shapefile data. Thanks.
>
> P.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From milton.ruser at gmail.com  Mon Jan 18 08:37:27 2010
From: milton.ruser at gmail.com (milton ruser)
Date: Mon, 18 Jan 2010 02:37:27 -0500
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>
Message-ID: <3aaf1a031001172337t1e7e39adoef756ef5d7af7fb2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100118/50211400/attachment.pl>

From r.hijmans at gmail.com  Mon Jan 18 08:50:42 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 17 Jan 2010 23:50:42 -0800
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <3aaf1a031001172337t1e7e39adoef756ef5d7af7fb2@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>
	<3aaf1a031001172337t1e7e39adoef756ef5d7af7fb2@mail.gmail.com>
Message-ID: <dc22b2571001172350o18f6ca0fw48c1584dc503481@mail.gmail.com>

Dear Milton,

You need a Google maps API key for this. If you have a Google account,
you can request one for http://localhost/
at http://code.google.com/apis/maps/signup.html

I have made this more explicit by adding a mykey argument to the function:

gmap <- function(xy, maptype='terrain', mykey, ...) {
    require(RgoogleMaps)
	fun = points
	if (inherits(xy, 'Spatial')) {
		b = bbox(xy)
		if (inherits(xy, 'SpatialPoints')) {
			xy = coordinates(xy)
		} else {
			x = unlist(lapply(xy at polygons, function(i)slot(i, 'Polygons')))
			x = lapply(x, function(x)slot(x, 'coords'))
			xy = matrix(ncol=2, nr=0)
			for (i in 1:length(x)) xy = rbind(xy, x[[i]], c(NA,NA))
			fun = lines
		}
	} else {
		b = rbind(range(xy[,1], na.rm=TRUE), range(xy[,2], na.rm=TRUE))
	}
    gm <- GetMap.bbox(key=mykey, lonR=b[1,], latR=b[2,], maptype=maptype)
    tmp <- PlotOnStaticMap(gm, lon=xy[,1], lat=xy[,2], FUN=fun, verbose=0, ... )
}


Robert

On Sun, Jan 17, 2010 at 11:37 PM, milton ruser <milton.ruser at gmail.com> wrote:
> Dear prof. Robert Hijmans,
>
> I tryed your suggestion (under Vista), but got the following errors:
>
>> gmap(a)
> Loading required package: RgoogleMaps
> Error in paste(googleurl, "center=", center, "&zoom=", zoom, "&size=",? :
> ? object 'localhostkey' not found
>> sessionInfo()
> R version 2.9.0 alpha (2009-03-26 r48224)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
> other attached packages:
> [1] maptools_0.7-20?? foreign_0.8-34??? sp_0.9-32???????? RgoogleMaps_1.1.6
> fortunes_1.3-6
> loaded via a namespace (and not attached):
> [1] grid_2.9.0????? lattice_0.17-20 tools_2.9.0
>
> Any idea?
>
> bests
>
> milton
>
>
> On Mon, Jan 18, 2010 at 2:06 AM, Robert J. Hijmans <r.hijmans at gmail.com>
> wrote:
>>
>> Patrick,
>>
>> I have had some success with plotting sp objects on top of G maps with
>> this function
>>
>>
>> gmap <- function(xy, maptype='terrain', ...) {
>> ? ?require(RgoogleMaps)
>> ? ? ? ?fun = points
>> ? ? ? ?if (inherits(xy, 'Spatial')) {
>> ? ? ? ? ? ? ? ?b = bbox(xy)
>> ? ? ? ? ? ? ? ?if (inherits(xy, 'SpatialPoints')) {
>> ? ? ? ? ? ? ? ? ? ? ? ?xy = coordinates(xy)
>> ? ? ? ? ? ? ? ?} else {
>> ? ? ? ? ? ? ? ? ? ? ? ?x = unlist(lapply(xy at polygons, function(i)slot(i,
>> 'Polygons')))
>> ? ? ? ? ? ? ? ? ? ? ? ?x = lapply(x, function(x)slot(x, 'coords'))
>> ? ? ? ? ? ? ? ? ? ? ? ?xy = matrix(ncol=2, nr=0)
>> ? ? ? ? ? ? ? ? ? ? ? ?for (i in 1:length(x)) xy = rbind(xy, x[[i]],
>> c(NA,NA))
>> ? ? ? ? ? ? ? ? ? ? ? ?fun = lines
>> ? ? ? ? ? ? ? ?}
>> ? ? ? ?} else {
>> ? ? ? ? ? ? ? ?b = rbind(range(xy[,1], na.rm=TRUE), range(xy[,2],
>> na.rm=TRUE))
>> ? ? ? ?}
>> ? ? ? ?mykey <- ?### fill in your google maps API key for
>> http://localhost/
>> ? ?gm <- GetMap.bbox(key=localhostkey, lonR=b[1,], latR=b[2,],
>> maptype=maptype)
>> ? ?tmp <- PlotOnStaticMap(gm, lon=xy[,1], lat=xy[,2], FUN=fun, verbose=0,
>> ... )
>> }
>>
>>
>> a = matrix(runif(100)*100-50, ncol=2)
>> gmap(a)
>>
>> library(sp)
>> gmap(SpatialPoints(a), col='red', cex=2, pch='+')
>>
>> library(maptools)
>> data(wrld_simpl)
>> hti = wrld_simpl[wrld_simpl$ISO3=='HTI',]
>> gmap(hti, lwd=2, col='red')
>>
>>
>> Hth,
>> Robert
>>
>>
>> On Sat, Jan 16, 2010 at 5:35 PM, Patrick Crutcher <pcrutcher at gmail.com>
>> wrote:
>> > I have some shapefiles I want to plot over Google Maps tiles. I have
>> > polygons, lines and point data. What's the most efficient way to do
>> > this?
>> > One path might be to use the pkg RgoogleMaps, however, it is still
>> > unclear
>> > to me how to do this. I assume using PlotonStaticMap with some
>> > combination
>> > of reformatting the shapefile data. Thanks.
>> >
>> > P.
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at stat.math.ethz.ch
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From milton.ruser at gmail.com  Mon Jan 18 09:23:35 2010
From: milton.ruser at gmail.com (milton ruser)
Date: Mon, 18 Jan 2010 03:23:35 -0500
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <dc22b2571001172350o18f6ca0fw48c1584dc503481@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>
	<3aaf1a031001172337t1e7e39adoef756ef5d7af7fb2@mail.gmail.com>
	<dc22b2571001172350o18f6ca0fw48c1584dc503481@mail.gmail.com>
Message-ID: <3aaf1a031001180023m6ada70eer109f6ad86a149cc1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100118/3869b874/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Jan 18 09:40:05 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 18 Jan 2010 08:40:05 +0000
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <3aaf1a031001180023m6ada70eer109f6ad86a149cc1@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<dc22b2571001172306y74886248v9b100a5f231d1dd9@mail.gmail.com>
	<3aaf1a031001172337t1e7e39adoef756ef5d7af7fb2@mail.gmail.com>
	<dc22b2571001172350o18f6ca0fw48c1584dc503481@mail.gmail.com>
	<3aaf1a031001180023m6ada70eer109f6ad86a149cc1@mail.gmail.com>
Message-ID: <d8ad40b51001180040m4235c043j95ccb8c17085b8bc@mail.gmail.com>

On Mon, Jan 18, 2010 at 8:23 AM, milton ruser <milton.ruser at gmail.com> wrote:
> Hi prof. Hijmans,
>
> Its Cool!
> Is there a similar facility for google earth? Plotting from R on a google
> earth session?!
>

 To put data onto Google Earth then you need to make a KML file. You
can probably do this with writeOGR from the rgdal package, or the kml*
functions in maptools - but if you want to do anything fancy then you
need to write your own KML file from your data. I have found the
'brewer' package useful for writing templates to make KML files.

 You'll have to study the KML specification from Google as well.

Barry


-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From hengl at spatial-analyst.net  Mon Jan 18 09:52:12 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 18 Jan 2010 09:52:12 +0100
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
Message-ID: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>


Hi Patrick,

I was breaking my head with this problem for one afternoon. Being more
a GIS person, my ideas was that one should be able to get a
StaticGoogleMaps image to some GIS format, i.e. to convert it to a
SpatialGridDataFrame. Then it is rather easy to overlay
points/lines/polygons using the spplot function (or to export to some
external GIS format e.g. geotiff). The procedure is now explained on
p.103-105 in my book (http://spatial-analyst.net/book/DataSources).
Here is the complete code:

http://spatial-analyst.net/book/getStaticGoogleMaps.R

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


Quoting Patrick Crutcher <pcrutcher at gmail.com>:

> I have some shapefiles I want to plot over Google Maps tiles. I have
> polygons, lines and point data. What's the most efficient way to do this?
> One path might be to use the pkg RgoogleMaps, however, it is still unclear
> to me how to do this. I assume using PlotonStaticMap with some combination
> of reformatting the shapefile data. Thanks.
>
> P.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>




----- End forwarded message -----


From roland.kaiser at sbg.ac.at  Mon Jan 18 13:49:37 2010
From: roland.kaiser at sbg.ac.at (Roland Kaiser)
Date: Mon, 18 Jan 2010 13:49:37 +0100
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
Message-ID: <E30F75BC-1041-4EF5-8900-27D4DD93C02A@sbg.ac.at>

Hi Patrik,

like Tom suggested you may also want to download google maps tiles
directly, mosaic them and warp to your desired projection.

Tom's code getStaticGoogleMaps.R is a great thing!
However, I can't run it on Mac OSX, because I failed to
compile SAGA GIS. Instead developed code that calls GDAL programs.

If you work on Mac OSX or another UNIX system
you may try the script temporally here:

http://www.users.sbg.ac.at/~9722152/fetchGE/fetchGE.zip

Documentation is in file FetchGE.R
You need to install GDAL, python and wget, as well as library(rgdal).

Best wishes,

Roland

>
> Hi Patrick,
>
> I was breaking my head with this problem for one afternoon. Being more
> a GIS person, my ideas was that one should be able to get a
> StaticGoogleMaps image to some GIS format, i.e. to convert it to a
> SpatialGridDataFrame. Then it is rather easy to overlay
> points/lines/polygons using the spplot function (or to export to some
> external GIS format e.g. geotiff). The procedure is now explained on
> p.103-105 in my book (http://spatial-analyst.net/book/DataSources).
> Here is the complete code:
>
> http://spatial-analyst.net/book/getStaticGoogleMaps.R
>
> T. Hengl
> http://home.medewerker.uva.nl/t.hengl/
>
>
> Quoting Patrick Crutcher <pcrutcher at gmail.com>:
>
>> I have some shapefiles I want to plot over Google Maps tiles. I have
>> polygons, lines and point data. What's the most efficient way to  
>> do this?
>> One path might be to use the pkg RgoogleMaps, however, it is still  
>> unclear
>> to me how to do this. I assume using PlotonStaticMap with some  
>> combination
>> of reformatting the shapefile data. Thanks.
>>
>> P.
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>
> ----- End forwarded message -----
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Mon Jan 18 13:59:29 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 18 Jan 2010 12:59:29 +0000
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <E30F75BC-1041-4EF5-8900-27D4DD93C02A@sbg.ac.at>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<E30F75BC-1041-4EF5-8900-27D4DD93C02A@sbg.ac.at>
Message-ID: <d8ad40b51001180459t529d6a3pdb3452273f3ba094@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100118/ef9d4a1f/attachment.pl>

From markus.loecher at gmail.com  Mon Jan 18 20:47:57 2010
From: markus.loecher at gmail.com (Markus Loecher)
Date: Mon, 18 Jan 2010 14:47:57 -0500
Subject: [R-sig-Geo] Fwd: Plotting shapefiles on top of Google map tiles
In-Reply-To: <mailman.868.1263832288.4241.r-sig-geo@stat.math.ethz.ch>
References: <mailman.868.1263832288.4241.r-sig-geo@stat.math.ethz.ch>
Message-ID: <bf460e021001181147t2769e3d6vf14aa894b2c68daa@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100118/b21d6bae/attachment.pl>

From Adrian.Baddeley at csiro.au  Tue Jan 19 03:14:02 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Tue, 19 Jan 2010 10:14:02 +0800
Subject: [R-sig-Geo] status of gpclib licence
In-Reply-To: <mailman.9.1263812404.26774.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1263812404.26774.r-sig-geo@stat.math.ethz.ch>
Message-ID: <57DC18C299094D4299F837570C5DF1C52B0C2E6F62@EXWA-MBX01.nexus.csiro.au>


Nicholas Lewin-Koh and others have asked about the licence for the R package 'gpclib'. This is based on the C library 'gpclib' by Alan Murtagh which has a non-GPL licence.

Recently I contacted the licence holders for the C library, with a formal request that the licence be changed to GPL. After contacting Alan Murtagh they replied that it has been decided, definitively, not to alter the licence.

Hence we are currently looking for a FOSS replacement for gpclib. Any volunteers?

In the meantime, packages that depend on gpclib could use the following strategy that we have adopted for 'spatstat'. The 'spatstat' package previously 'Depend'ed on gpclib. I have reorganised spatstat so that it only 'Suggests' gpclib, and the gpclib-dependent code can be enabled or disabled using a flag, spatstat.options("gpclib") which is initialised to FALSE. If you are an academic or non-profit, set spatstat.options(gpclib=TRUE). If you're commercial, leave it as FALSE and have a nice day...

Adrian Baddeley


From Roger.Bivand at nhh.no  Tue Jan 19 10:25:44 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Jan 2010 10:25:44 +0100 (CET)
Subject: [R-sig-Geo] status of gpclib licence
In-Reply-To: <57DC18C299094D4299F837570C5DF1C52B0C2E6F62@EXWA-MBX01.nexus.csiro.au>
References: <mailman.9.1263812404.26774.r-sig-geo@stat.math.ethz.ch>
	<57DC18C299094D4299F837570C5DF1C52B0C2E6F62@EXWA-MBX01.nexus.csiro.au>
Message-ID: <alpine.LRH.2.00.1001190947480.24342@reclus.nhh.no>

On Tue, 19 Jan 2010, Adrian.Baddeley at csiro.au wrote:

>
> Nicholas Lewin-Koh and others have asked about the licence for the R 
> package 'gpclib'. This is based on the C library 'gpclib' by Alan 
> Murtagh which has a non-GPL licence.
>
> Recently I contacted the licence holders for the C library, with a 
> formal request that the licence be changed to GPL. After contacting Alan 
> Murtagh they replied that it has been decided, definitively, not to 
> alter the licence.
>
> Hence we are currently looking for a FOSS replacement for gpclib. Any 
> volunteers?

Adrian,

The rgeos package on R-Forge is almost ready for release.

https://r-forge.r-project.org/projects/rgeos/
http://trac.osgeo.org/geos/

The proof-of-concept has been to link it tightly to sp classes at the C 
level. The way GEOS is structured makes tight coupling hard to avoid - so 
similar R <-> C interfaces will be needed for other packages. Because it 
isn't just for clipping, it doesn't fit the hole left by gpclib neatly.

Finally, it has an external dependency, the GEOS DLL and headers, which 
can be met for Windows binary packages with Uwe Ligges' help (tried but 
not yet operative on R-Forge, ready to roll when rgeos is on CRAN). For 
Unix/Linux users, either install GEOS from source or binaries (works on 
Debian/Ubuntu - libgeos, libgeos-c1, libgeos-dev), for OSX using the 
Kyngchaos GEOS framework (untried http://www.kyngchaos.com/ -> software -> 
frameworks).

An alternative that ought to be followed up at least as proof-of-concept 
is the Boost GGL library:

http://reviews.slashgeo.org/article.pl?sid=09/11/30/1638211
http://trac.osgeo.org/ggl

Build for GGL is as other Boost software, through a mystical graph of 
C++ headers - like the R RBGL package, which ships with the Boost headers 
in a gzipped tar archive in src/ to create the Boost framework at compile 
time. It is, however, not C++ written as C, it is modern C++. So for me, 
the GEOS C API was easier to handle (for a chosen definition of easier).

>
> In the meantime, packages that depend on gpclib could use the following 
> strategy that we have adopted for 'spatstat'. The 'spatstat' package 
> previously 'Depend'ed on gpclib. I have reorganised spatstat so that it 
> only 'Suggests' gpclib, and the gpclib-dependent code can be enabled or 
> disabled using a flag, spatstat.options("gpclib") which is initialised 
> to FALSE. If you are an academic or non-profit, set 
> spatstat.options(gpclib=TRUE). If you're commercial, leave it as FALSE 
> and have a nice day...

Even if you are academic, but doing contracted research, I'd be concerned 
with the lack of clarity in:

"Commercial use of GPC (for example: product development / commercial 
research)"

http://www.cs.manchester.ac.uk/~toby/alan/software/#Licensing

which is very much broader than compiling GPC into software for sale. I 
guess it depends on your half-full/half-empty status ...

Unreleased maptools on the sourceforge r-spatial project follows your lead 
on this (different mechanism - flag hidden in environment, same 
principle), but where rgeos is present, uses that instead everywhere 
gpclib was used before. Partly because of the use of C, it yields the same 
results quicker. I'd be very grateful for anyone able to install source 
packages trying out rgeos, and then installing maptools from a cvs 
checkout from r-spatial. When I have some feedback, I'll release.

Helpers very welcome!

Roger

>
> Adrian Baddeley
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zua3 at cornell.edu  Wed Jan 20 00:59:53 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Tue, 19 Jan 2010 18:59:53 -0500
Subject: [R-sig-Geo] Merging shape files?
In-Reply-To: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
Message-ID: <4B564779.5040509@cornell.edu>

Hi:
I like use R for data mining, organization, manipulation and mapping of 
SSURO data of USA. I have already done first two; I need help for 
mapping these data.in R   It will be appreciated if someone helps me to 
solve following three issues:

*1.       How do I merge several  shape files?*
I like to merge several shape files to create a single shape file. All 
files are same structure but different names and in different folders. 
Below I mentioned how all shape files are organized in different folder. 
I want to write a function that I can use to merge the shape files.
 
*File organization:*
.../State_name/soil_ia001/spatial/file_name01.shp
.../State_name/soil_ia003/spatial/file_name03.shp
.../State_name/soil_ia005/spatial/file_name05.shp
.
. .../State_name/soil_ia21/spatial/file_name21.shp
 
*DBF file associated   all shape files look like below: *
 
ID            AREASYMBOL    SPATIALVER       MUSYM               MUKEY
1              IA001                    2                              
822D2                    402210
2              IA001                     2                              
24C2                      402161
3              IA001                     2                              
93D2                      402217
4              IA001                     2                              
W                           1857266
5              IA001                     2                              
W                           1857266
6              IA001                     2                              
370C                      402177
7              IA001                     2                              
570B                      402190
                -------
 *
2.       My second question is: I like to join a table with this above 
mentioned shape   using a conmen ID like MUKEY.  How do I do this?*
*3.       My third question is: how do I convert this shape file to a 
grid (as a TIFF format or others? ) that I open some other software?*

Thanks
Zia
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100119/a6b1ffcb/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100119/a6b1ffcb/attachment.vcf>

From nikko at hailmail.net  Wed Jan 20 06:14:49 2010
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Tue, 19 Jan 2010 21:14:49 -0800
Subject: [R-sig-Geo]  status of gpclib licence
In-Reply-To: <mailman.9.1263898804.19274.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1263898804.19274.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1263964489.27698.1355572779@webmail.messagingengine.com>

Hi, 
Thank you for contacting the license holders. Nice to get this
resolved definitively, though shame that they are not willing to open
the license. The good news is that on Rogers good advice I took a
look at ggl and it seems to be very nice. geos looks nice too, but
ggl is more generic and could be used to do clipping in higher
dimensions, cool. If I can get some minimal examples working with ggl
I will be sure and post.

Nicholas 

> ------------------------------
>
> Message: 5 Date: Tue, 19 Jan 2010 10:25:44 +0100 (CET) From: Roger
> Bivand <Roger.Bivand at nhh.no> To: Adrian.Baddeley at csiro.au
> Cc: r-sig-geo at stat.math.ethz.ch Subject: Re: [R-sig-Geo] status of
>     gpclib licence Message-ID:
>     <alpine.LRH.2.00.1001190947480.24342 at reclus.nhh.no> Content-Type:
>     TEXT/PLAIN; charset=US-ASCII; format=flowed
>
> On Tue, 19 Jan 2010, Adrian.Baddeley at csiro.au wrote:
>
> >
> > Nicholas Lewin-Koh and others have asked about the licence for the R
> > package 'gpclib'. This is based on the C library 'gpclib' by Alan
> > Murtagh which has a non-GPL licence.
> >
> > Recently I contacted the licence holders for the C library, with a
> > formal request that the licence be changed to GPL. After contacting
> > Alan Murtagh they replied that it has been decided, definitively,
> > not to alter the licence.
> >
> > Hence we are currently looking for a FOSS replacement for gpclib.
> > Any volunteers?
>
> Adrian,
>
> The rgeos package on R-Forge is almost ready for release.
>
> https://r-forge.r-project.org/projects/rgeos/
> http://trac.osgeo.org/geos/
>
> The proof-of-concept has been to link it tightly to sp classes at the
> C level. The way GEOS is structured makes tight coupling hard to avoid
> - so similar R <-> C interfaces will be needed for other packages.
> Because it isn't just for clipping, it doesn't fit the hole left by
> gpclib neatly.
>
> Finally, it has an external dependency, the GEOS DLL and headers,
> which can be met for Windows binary packages with Uwe Ligges' help
> (tried but not yet operative on R-Forge, ready to roll when rgeos is
> on CRAN). For Unix/Linux users, either install GEOS from source or
> binaries (works on Debian/Ubuntu - libgeos, libgeos-c1, libgeos-dev),
> for OSX using the Kyngchaos GEOS framework (untried
> http://www.kyngchaos.com/ -> software -> frameworks).
>
> An alternative that ought to be followed up at least as proof-of-
> concept is the Boost GGL library:
>
> http://reviews.slashgeo.org/article.pl?sid=09/11/30/1638211
> http://trac.osgeo.org/ggl
>
> Build for GGL is as other Boost software, through a mystical graph of
> C++ headers - like the R RBGL package, which ships with the Boost
> headers in a gzipped tar archive in src/ to create the Boost framework
> at compile time. It is, however, not C++ written as C, it is modern
> C++. So for me, the GEOS C API was easier to handle (for a chosen
> definition of easier).
>
> >
> > In the meantime, packages that depend on gpclib could use the
> > following strategy that we have adopted for 'spatstat'. The
> > 'spatstat' package previously 'Depend'ed on gpclib. I have
> > reorganised spatstat so that it only 'Suggests' gpclib, and the gpclib-
> > dependent code can be enabled or disabled using a flag,
> > spatstat.options("gpclib") which is initialised to FALSE. If you are
> > an academic or non-profit, set spatstat.options(gpclib=TRUE). If
> > you're commercial, leave it as FALSE and have a nice day...
>
> Even if you are academic, but doing contracted research, I'd be
> concerned with the lack of clarity in:
>
> "Commercial use of GPC (for example: product development / commercial
> research)"
>
> http://www.cs.manchester.ac.uk/~toby/alan/software/#Licensing
>
> which is very much broader than compiling GPC into software for sale.
> I guess it depends on your half-full/half-empty status ...
>
> Unreleased maptools on the sourceforge r-spatial project follows your
> lead on this (different mechanism - flag hidden in environment, same
> principle), but where rgeos is present, uses that instead everywhere
> gpclib was used before. Partly because of the use of C, it yields the
> same results quicker. I'd be very grateful for anyone able to install
> source packages trying out rgeos, and then installing maptools from a
> cvs checkout from r-spatial. When I have some feedback, I'll release.
>
> Helpers very welcome!
>
> Roger
>
> >
> > Adrian Baddeley
> >
> > _______________________________________________
> > R-sig-Geo mailing list R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand Economic Geography Section, Department of Economics,
> Norwegian School of Economics and Business Administration, Helleveien
> 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
>
> ------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> End of R-sig-Geo Digest, Vol 77, Issue 16
> *****************************************


From milton.ruser at gmail.com  Wed Jan 20 06:39:12 2010
From: milton.ruser at gmail.com (milton ruser)
Date: Wed, 20 Jan 2010 00:39:12 -0500
Subject: [R-sig-Geo] Merging shape files?
In-Reply-To: <4B564779.5040509@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu>
Message-ID: <3aaf1a031001192139k42bb560cs820399c8208ffcae@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/851cf616/attachment.pl>

From gisxperts at web.de  Wed Jan 20 08:57:47 2010
From: gisxperts at web.de (Hannes Reuter)
Date: Wed, 20 Jan 2010 08:57:47 +0100
Subject: [R-sig-Geo] Merging shape files?
In-Reply-To: <4B564779.5040509@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu>
Message-ID: <4B56B77B.3020203@web.de>

Dear Zia,

1)check GDAL (www.gdal.org) using the ogr2ogr function -append as well 
as the RGDAL library out.
2)
3) -->gdal_rasterize  --> check as well the RGDAL library out. make sure 
you have a decent version of RGDAL/GDAL as I believe that the rasterize 
just came in the las two versions or so.

hannes

Zia Ahmed schrieb:
> Hi:
> I like use R for data mining, organization, manipulation and mapping of 
> SSURO data of USA. I have already done first two; I need help for 
> mapping these data.in R   It will be appreciated if someone helps me to 
> solve following three issues:
> 
> *1.       How do I merge several  shape files?*
> I like to merge several shape files to create a single shape file. All 
> files are same structure but different names and in different folders. 
> Below I mentioned how all shape files are organized in different folder. 
> I want to write a function that I can use to merge the shape files.
>  
> *File organization:*
> ?/State_name/soil_ia001/spatial/file_name01.shp
> ?/State_name/soil_ia003/spatial/file_name03.shp
> ?/State_name/soil_ia005/spatial/file_name05.shp
> .
> . ?/State_name/soil_ia21/spatial/file_name21.shp
>  
> *DBF file associated   all shape files look like below: *
>  
> ID            AREASYMBOL    SPATIALVER       MUSYM               MUKEY
> 1              IA001                    2                              
> 822D2                    402210
> 2              IA001                     2                              
> 24C2                      402161
> 3              IA001                     2                              
> 93D2                      402217
> 4              IA001                     2                              
> W                           1857266
> 5              IA001                     2                              
> W                           1857266
> 6              IA001                     2                              
> 370C                      402177
> 7              IA001                     2                              
> 570B                      402190
>                 -------
>  *
> 2.       My second question is: I like to join a table with this above 
> mentioned shape   using a conmen ID like MUKEY.  How do I do this?*
> *3.       My third question is: how do I convert this shape file to a 
> grid (as a TIFF format or others? ) that I open some other software?*
> 
> Thanks
> Zia
>  
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alexandre.villers at cebc.cnrs.fr  Wed Jan 20 09:17:49 2010
From: alexandre.villers at cebc.cnrs.fr (alexandre villers)
Date: Wed, 20 Jan 2010 09:17:49 +0100
Subject: [R-sig-Geo] Merging shape files?
Message-ID: <1263975469.81cf07calexandre.villers@cebc.cnrs.fr>

Hello,

Have a look at spRbind-methods {maptools package}
It may work for what you want (someone will correct me if I'm wrong).
But, almost for sure, GRASS will be faster (look at the spgrass6 package)

Best regards

Alex

-----Original Message-----
From: Zia Ahmed <zua3 at cornell.edu>
To: sig-geo <r-sig-geo at stat.math.ethz.ch>
Date: Tue, 19 Jan 2010 18:59:53 -0500
Subject: [R-sig-Geo] Merging shape files?

Hi:
I like use R for data mining, organization, manipulation and mapping of 
SSURO data of USA. I have already done first two; I need help for 
mapping these data.in R   It will be appreciated if someone helps me to 
solve following three issues:

*1.       How do I merge several  shape files?*
I like to merge several shape files to create a single shape file. All 
files are same structure but different names and in different folders. 
Below I mentioned how all shape files are organized in different folder. 
I want to write a function that I can use to merge the shape files.
 
*File organization:*
.../State_name/soil_ia001/spatial/file_name01.shp
.../State_name/soil_ia003/spatial/file_name03.shp
.../State_name/soil_ia005/spatial/file_name05.shp
.
. .../State_name/soil_ia21/spatial/file_name21.shp
 
*DBF file associated   all shape files look like below: *
 
ID            AREASYMBOL    SPATIALVER       MUSYM               MUKEY
1              IA001                    2                              
822D2                    402210
2              IA001                     2                              
24C2                      402161
3              IA001                     2                              
93D2                      402217
4              IA001                     2                              
W                           1857266
5              IA001                     2                              
W                           1857266
6              IA001                     2                              
370C                      402177
7              IA001                     2                              
570B                      402190
                -------
 *
2.       My second question is: I like to join a table with this above 
mentioned shape   using a conmen ID like MUKEY.  How do I do this?*
*3.       My third question is: how do I convert this shape file to a 
grid (as a TIFF format or others? ) that I open some other software?*

Thanks
Zia
 



__________ Information from ESET Mail Security, version of virus signature database 4787 (20100119) __________

The message was checked by ESET Mail Security.
http://www.eset.com



Alexandre Villers
PhD. Candidate
Team Agripop
CEBC CNRS UPR 1934
79360 Beauvoir sur Niort

Phone: +33 (0)549 099 613 


__________ Information from ESET Mail Security, version of virus signature database 4788 (20100120) __________

The message was checked by ESET Mail Security.
http://www.eset.com


From Virgilio.Gomez at uclm.es  Wed Jan 20 12:42:29 2010
From: Virgilio.Gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Wed, 20 Jan 2010 12:42:29 +0100
Subject: [R-sig-Geo] Call for papers:  useR! 2010  conference
Message-ID: <1263987749.3106.21.camel@Virgilio-Gomez>

Dear all,

I believe that this conference will be of interest to some of the people on this list.
We are hoping to organise a specific session(s) on spatial and spatio-temporal
data analysis, depending on the number of submissions. There will also
be a 3-hour tutorial on spatial data analysis the day before the conference
starts.

Please, forward this call for papers to your departments, research groups, etc.

Best wishes,

Virgilio

---


useR! 2010 Call for papers

useR! 2010, the R user conference, will take place at the Gaithersburg,
Maryland, USA campus of the National Institute of Standards and
Technology (NIST) from 2010-07-21 to 2010-07-23. Pre-conference
tutorials will take place on July 20.

As for the predecessor conferences, the program consists of two parts: 

     1. invited lectures discussing new R developments and exciting
        applications of R, 
     2. user-contributed presentations reflecting the wide range of
        fields in which R is used to analyze data.

A major goal of the useR! conference is to bring users from various
fields together and provide a platform for discussion and exchange of
ideas: both in the formal framework of presentations as well as in the
informal part of the conference in Gaithersburg.


Prior to the conference, on 2010-07-20, there are tutorials offered at
the conference site. Each tutorial has a length of 3 hours and takes
place either in the morning or afternoon.

We invite all R users to submit abstracts presenting innovations or
exciting applications of R on topics such as:

      * Applied Statistics & Biostatistics 
      * Bayesian Statistics 
      * Bioinformatics 
      * Chemometrics and Computational Physics 
      * Data Mining 
      * Econometrics & Finance 
      * Environmetrics & Ecological Modeling 
      * High Performance Computing 
      * Machine Learning 
      * Marketing & Business Analytics 
      * Psychometrics 
      * Robust Statistics 
      * Social network analysis 
      * Spatial Statistics 
      * Statistics in the Social and Political Sciences 
      * Teaching 
      * Visualization & Graphics 
      * and many more.
To submit an abstract, generate a pdf file using a template (preferred)
for pdfTeX or for OpenOffice Writer and commercial friends, or generate
a plain txt file. Submit the file via the abstract submission interface.
Please keep abstracts to one page. 

A poster session will be held the evening of July 21, 2010. Participants
who wish to present their work via a poster in this session may submit a
poster abstract using the poster abstract submission interface. Poster
abstracts should be in the same format as regular abstracts. 


The abstracts associated with accepted talks and posters will be made
available online.

Deadline for submission of abstracts: March 1, 2010.

More information about this conference can be found at the conference
website: http://user2010.org


From zua3 at cornell.edu  Wed Jan 20 22:14:49 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 20 Jan 2010 16:14:49 -0500
Subject: [R-sig-Geo] Helping with write a function.  Merging shape files?
In-Reply-To: <4B56B77B.3020203@web.de>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>
Message-ID: <4B577249.8050705@cornell.edu>

Thanks! I am trying to write a function to merge or combine several 
shape files.

First I try to use following function when all shape files in one 
folder. It showed error.

setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Test1")
library(rgdal)
## obtain shapefile names in current directory
fs <- list.files(pattern = "shp")
 ## read the first one
 d <- readOGR(fs[1], gsub(".shp", "", fs[1]))
 for (i in 2:length(fs)) {
 d.tmp <- readOGR(fs[i], gsub(".shp", "", fs[i]))
 }
 d <- rbind(d, d.tmp)
 >  d <- rbind(d, d.tmp)
Error in validObject(.Object) :
invalid class "SpatialPolygons" object: non-unique Polygons ID slot values


Then I am trying to use following code, but it did  not work. it  
_created a empty layer. _I think I did something wrong.  Any idea, __

# Code for similar file name (shape.shp)
setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Testf")
library(rgdal)

files <- list.files(pattern = "shp")  # get all the names in the directory
files <- files[file.info(files)$isdir]  # only keep the directories

layer<- file('layer.shp')  # output file
for (Dir in files){
    input <- readOGR(file.path(Dir, "shape.shp")) 
    rbind(input, layer)  
}
close(layer)

I have a situations  like   all shape files are different names 
(like...001.shp, ...003.shp, ....005.shp  so on ) and were saved in 
different folders (like fn001, fn003, fn005....... If someone helps me 
to write correct code  for solving this it will be great.

Zia 

Hannes Reuter wrote:
> Dear Zia,
>
> 1)check GDAL (www.gdal.org) using the ogr2ogr function -append as well 
> as the RGDAL library out.
> 2)
> 3) -->gdal_rasterize  --> check as well the RGDAL library out. make 
> sure you have a decent version of RGDAL/GDAL as I believe that the 
> rasterize just came in the las two versions or so.
>
> hannes
>
> Zia Ahmed schrieb:
>> Hi:
>> I like use R for data mining, organization, manipulation and mapping 
>> of SSURO data of USA. I have already done first two; I need help for 
>> mapping these data.in R   It will be appreciated if someone helps me 
>> to solve following three issues:
>>
>> *1.       How do I merge several  shape files?*
>> I like to merge several shape files to create a single shape file. 
>> All files are same structure but different names and in different 
>> folders. Below I mentioned how all shape files are organized in 
>> different folder. I want to write a function that I can use to merge 
>> the shape files.
>>  
>> *File organization:*
>> ?/State_name/soil_ia001/spatial/file_name01.shp
>> ?/State_name/soil_ia003/spatial/file_name03.shp
>> ?/State_name/soil_ia005/spatial/file_name05.shp
>> .
>> . ?/State_name/soil_ia21/spatial/file_name21.shp
>>  
>> *DBF file associated   all shape files look like below: *
>>  
>> ID            AREASYMBOL    SPATIALVER       MUSYM               MUKEY
>> 1              IA001                    
>> 2                              822D2                    402210
>> 2              IA001                     
>> 2                              24C2                      402161
>> 3              IA001                     
>> 2                              93D2                      402217
>> 4              IA001                     
>> 2                              W                           1857266
>> 5              IA001                     
>> 2                              W                           1857266
>> 6              IA001                     
>> 2                              370C                      402177
>> 7              IA001                     
>> 2                              570B                      402190
>>                 -------
>>  *
>> 2.       My second question is: I like to join a table with this 
>> above mentioned shape   using a conmen ID like MUKEY.  How do I do 
>> this?*
>> *3.       My third question is: how do I convert this shape file to a 
>> grid (as a TIFF format or others? ) that I open some other software?*
>>
>> Thanks
>> Zia
>>  
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/2aed8f54/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/2aed8f54/attachment.vcf>

From pcrutcher at gmail.com  Wed Jan 20 23:41:08 2010
From: pcrutcher at gmail.com (Patrick Crutcher)
Date: Wed, 20 Jan 2010 14:41:08 -0800
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <bf460e021001180831q2554043cwb04df24d572bef87@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<bf460e021001171813w4ad48a05v4857443dff4ebfbe@mail.gmail.com>
	<bf460e021001180831q2554043cwb04df24d572bef87@mail.gmail.com>
Message-ID: <7d4c2811001201441o2f2979a4w67bfb4aaf9e5990a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/34b77dca/attachment.pl>

From biozealot21 at gmail.com  Thu Jan 21 02:38:10 2010
From: biozealot21 at gmail.com (Matt Beard)
Date: Wed, 20 Jan 2010 20:38:10 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape files?
In-Reply-To: <4B577249.8050705@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>
	<4B577249.8050705@cornell.edu>
Message-ID: <9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>

Zia,

The error you received was 'invalid class "SpatialPolygons" object:
non-unique Polygons ID slot values'.
Renaming the Polygons IDs so that they are unique should fix your problem.

The following code along with some test shapefiles I used are attached.

library(rgdal)
setwd("C:/test")

# obtain shapefiles in current directory
files <- list.files(pattern = "shp")

# get polygons from first file
data.first <- readOGR(files[1], gsub(".shp","",files[1]))
polygons <- slot(data.first, "polygons")

# add polygons from remaining files
for (i in 2:length(files)) {
   data.temp <- readOGR(files[i], gsub(".shp","",files[i]))
   polygons <- c(slot(data.temp, "polygons"),polygons)
}

# rename IDs of Polygons
for (i in 1:length(polygons)) {
   slot(polygons[[i]], "ID") <- paste(i)
}

# ain't that spatial
spatialPolygons <- SpatialPolygons(polygons)
spdf <- SpatialPolygonsDataFrame(spatialPolygons,
data.frame(fakeData=1:length(polygons)))

# output combined results
plot(spatialPolygons)
writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", driver="ESRI
Shapefile")

# end of code

My test shapefiles had very different attribute tables, so I didn't bother
combining the data tables.
However, the code above should at least show you that your method can work.

I found it interesting that when I combined the polygons in the opposite
order:
polygons <- c(polygons,slot(data.temp, "polygons"))

the SoutheasternStates polygons completely covered up the Florida polygons
in QGis, but
the Florida polygons showed up when plotting in R:
plot(spatialPolygons)

Does the R 'plot' function order the polygons before displaying them? Is it
possible to view the code
for a function like plot(SpatialPolygons)?

Matt










On Wed, Jan 20, 2010 at 4:14 PM, Zia Ahmed <zua3 at cornell.edu> wrote:

>  Thanks! I am trying to write a function to merge or combine several shape
> files.
>
> First I try to use following function when all shape files in one folder.
> It showed error.
>
> setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Test1")
> library(rgdal)
> ## obtain shapefile names in current directory
> fs <- list.files(pattern = "shp")
>  ## read the first one
>  d <- readOGR(fs[1], gsub(".shp", "", fs[1]))
>  for (i in 2:length(fs)) {
>  d.tmp <- readOGR(fs[i], gsub(".shp", "", fs[i]))
>  }
>  d <- rbind(d, d.tmp)
> >  d <- rbind(d, d.tmp)
> Error in validObject(.Object) :
> invalid class "SpatialPolygons" object: non-unique Polygons ID slot values
>
>
> Then I am trying to use following code, but it did  not work. it  *created
> a empty layer. *I think I did something wrong.  Any idea, **
>
> # Code for similar file name (shape.shp)
> setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Testf")
> library(rgdal)
>
> files <- list.files(pattern = "shp")  # get all the names in the directory
> files <- files[file.info(files)$isdir]  # only keep the directories
>
> layer<- file('layer.shp')  # output file
> for (Dir in files){
>     input <- readOGR(file.path(Dir, "shape.shp"))
>     rbind(input, layer)
> }
> close(layer)
>
> I have a situations  like   all shape files are different names
> (like...001.shp, ...003.shp, ....005.shp  so on ) and were saved in
> different folders (like fn001, fn003, fn005....... If someone helps me to
> write correct code  for solving this it will be great.
>
> Zia
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/aa6ba726/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.zip
Type: application/zip
Size: 67885 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/aa6ba726/attachment.zip>

From zua3 at cornell.edu  Thu Jan 21 02:56:37 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 20 Jan 2010 20:56:37 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape files?
In-Reply-To: <9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>	
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>	
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
Message-ID: <4B57B455.6090208@cornell.edu>

Thank you so much Matt. I will try this code with my data. I like to 
merge  all shape files of a county  (SSURGO polygons) and want to  
create a single shape file for a state. I did it before for 15  states 
of NE-region of USA. I used ArcGIS. I do not like to work with ArcGIS.
I now it is not possible to do this kind of analysis in R under Windows 
O/S due  to memory issue. Once I able to run this code correctly, then I 
will  try this code in my new linux system (32 GB memory )

Thanks again

Zia
Matt Beard wrote:
> Zia,
>
> The error you received was 'invalid class "SpatialPolygons" object: 
> non-unique Polygons ID slot values'.
> Renaming the Polygons IDs so that they are unique should fix your problem.
>
> The following code along with some test shapefiles I used are attached.
>
> library(rgdal)
> setwd("C:/test")
>
> # obtain shapefiles in current directory
> files <- list.files(pattern = "shp")
>
> # get polygons from first file
> data.first <- readOGR(files[1], gsub(".shp","",files[1]))
> polygons <- slot(data.first, "polygons")
>
> # add polygons from remaining files
> for (i in 2:length(files)) {
>    data.temp <- readOGR(files[i], gsub(".shp","",files[i]))
>    polygons <- c(slot(data.temp, "polygons"),polygons)
> }
>
> # rename IDs of Polygons
> for (i in 1:length(polygons)) {
>    slot(polygons[[i]], "ID") <- paste(i)
> }
>
> # ain't that spatial
> spatialPolygons <- SpatialPolygons(polygons)
> spdf <- SpatialPolygonsDataFrame(spatialPolygons, 
> data.frame(fakeData=1:length(polygons)))
>
> # output combined results
> plot(spatialPolygons)
> writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", 
> driver="ESRI Shapefile")
>
> # end of code
>
> My test shapefiles had very different attribute tables, so I didn't 
> bother combining the data tables.
> However, the code above should at least show you that your method can 
> work.
>
> I found it interesting that when I combined the polygons in the 
> opposite order:
> polygons <- c(polygons,slot(data.temp, "polygons"))
>
> the SoutheasternStates polygons completely covered up the Florida 
> polygons in QGis, but
> the Florida polygons showed up when plotting in R:
> plot(spatialPolygons)
>
> Does the R 'plot' function order the polygons before displaying them? 
> Is it possible to view the code
> for a function like plot(SpatialPolygons)?
>
> Matt
>
>
>
>
>
>
>
>
>
>
> On Wed, Jan 20, 2010 at 4:14 PM, Zia Ahmed <zua3 at cornell.edu 
> <mailto:zua3 at cornell.edu>> wrote:
>
>     Thanks! I am trying to write a function to merge or combine
>     several shape files.
>
>     First I try to use following function when all shape files in one
>     folder. It showed error.
>
>     setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Test1")
>     library(rgdal)
>     ## obtain shapefile names in current directory
>     fs <- list.files(pattern = "shp")
>      ## read the first one
>      d <- readOGR(fs[1], gsub(".shp", "", fs[1]))
>      for (i in 2:length(fs)) {
>      d.tmp <- readOGR(fs[i], gsub(".shp", "", fs[i]))
>      }
>      d <- rbind(d, d.tmp)
>     >  d <- rbind(d, d.tmp)
>     Error in validObject(.Object) :
>     invalid class "SpatialPolygons" object: non-unique Polygons ID
>     slot values
>
>
>     Then I am trying to use following code, but it did  not work. it 
>     _created a empty layer. _I think I did something wrong.  Any idea,
>
>     # Code for similar file name (shape.shp)
>     setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Testf")
>     library(rgdal)
>
>     files <- list.files(pattern = "shp")  # get all the names in the
>     directory
>     files <- files[file.info <http://file.info>(files)$isdir]  # only
>     keep the directories
>
>     layer<- file('layer.shp')  # output file
>     for (Dir in files){
>         input <- readOGR(file.path(Dir, "shape.shp")) 
>         rbind(input, layer)  
>     }
>     close(layer)
>
>     I have a situations  like   all shape files are different names
>     (like...001.shp, ...003.shp, ....005.shp  so on ) and were saved
>     in different folders (like fn001, fn003, fn005....... If someone
>     helps me to write correct code  for solving this it will be great.
>
>     Zia 
>


From markus.loecher at gmail.com  Thu Jan 21 03:20:38 2010
From: markus.loecher at gmail.com (Markus Loecher)
Date: Wed, 20 Jan 2010 21:20:38 -0500
Subject: [R-sig-Geo] Plotting shapefiles on top of Google map tiles
In-Reply-To: <7d4c2811001201441o2f2979a4w67bfb4aaf9e5990a@mail.gmail.com>
References: <7d4c2811001161735u1d8ca836q16ab18e0d5fc3490@mail.gmail.com>
	<bf460e021001171813w4ad48a05v4857443dff4ebfbe@mail.gmail.com>
	<bf460e021001180831q2554043cwb04df24d572bef87@mail.gmail.com>
	<7d4c2811001201441o2f2979a4w67bfb4aaf9e5990a@mail.gmail.com>
Message-ID: <bf460e021001201820n507dbf54u7821af41cc692c3a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100120/108376a8/attachment.pl>

From zua3 at cornell.edu  Thu Jan 21 03:40:56 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 20 Jan 2010 21:40:56 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape files?
In-Reply-To: <9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>	
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>	
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
Message-ID: <4B57BEB8.1050103@cornell.edu>

Hi Matt,

Your  code  work perfectly. As a test run, I am able to merge lower 48 
states and create a polygon of Con. USA when  all files are in one  
folder.  But  SSURGO data  organized like  following way (not exactly)
state_name (wd)/
     state_001 (subfolder)/spatial/several shape files (a_shape001.shp, 
*poly_shape001.shp,* l_shape001.shp)
     state_003 (subfolder)/spatial/several shape files (a_shape003.shp, 
*poly_shape003.shp*,  l_shape003.shp)
     state_005 (subfolder)/spatial/several shape files (a_shape005.shp, 
*poly_shape005.shp*,  l_shape005.shp)
---------
     state_065 (subfolder)/spatial/several shape files (a_shape065.shp, 
*poly_shape065.shp*,  l_shape065.shp)

like this.

I like to select one shape file (suppose *poly_shape-----.shp*)   from 
each  of sub folder of  my working directory and merge them together. Is 
there any way to do this in a loop?
Thanks again
Zia

Matt Beard wrote:
> Zia,
>
> The error you received was 'invalid class "SpatialPolygons" object: 
> non-unique Polygons ID slot values'.
> Renaming the Polygons IDs so that they are unique should fix your problem.
>
> The following code along with some test shapefiles I used are attached.
>
> library(rgdal)
> setwd("C:/test")
>
> # obtain shapefiles in current directory
> files <- list.files(pattern = "shp")
>
> # get polygons from first file
> data.first <- readOGR(files[1], gsub(".shp","",files[1]))
> polygons <- slot(data.first, "polygons")
>
> # add polygons from remaining files
> for (i in 2:length(files)) {
>    data.temp <- readOGR(files[i], gsub(".shp","",files[i]))
>    polygons <- c(slot(data.temp, "polygons"),polygons)
> }
>
> # rename IDs of Polygons
> for (i in 1:length(polygons)) {
>    slot(polygons[[i]], "ID") <- paste(i)
> }
>
> # ain't that spatial
> spatialPolygons <- SpatialPolygons(polygons)
> spdf <- SpatialPolygonsDataFrame(spatialPolygons, 
> data.frame(fakeData=1:length(polygons)))
>
> # output combined results
> plot(spatialPolygons)
> writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", 
> driver="ESRI Shapefile")
>
> # end of code
>
> My test shapefiles had very different attribute tables, so I didn't 
> bother combining the data tables.
> However, the code above should at least show you that your method can 
> work.
>
> I found it interesting that when I combined the polygons in the 
> opposite order:
> polygons <- c(polygons,slot(data.temp, "polygons"))
>
> the SoutheasternStates polygons completely covered up the Florida 
> polygons in QGis, but
> the Florida polygons showed up when plotting in R:
> plot(spatialPolygons)
>
> Does the R 'plot' function order the polygons before displaying them? 
> Is it possible to view the code
> for a function like plot(SpatialPolygons)?
>
> Matt
>
>
>
>
>
>
>
>
>
>
> On Wed, Jan 20, 2010 at 4:14 PM, Zia Ahmed <zua3 at cornell.edu 
> <mailto:zua3 at cornell.edu>> wrote:
>
>     Thanks! I am trying to write a function to merge or combine
>     several shape files.
>
>     First I try to use following function when all shape files in one
>     folder. It showed error.
>
>     setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Test1")
>     library(rgdal)
>     ## obtain shapefile names in current directory
>     fs <- list.files(pattern = "shp")
>      ## read the first one
>      d <- readOGR(fs[1], gsub(".shp", "", fs[1]))
>      for (i in 2:length(fs)) {
>      d.tmp <- readOGR(fs[i], gsub(".shp", "", fs[i]))
>      }
>      d <- rbind(d, d.tmp)
>     >  d <- rbind(d, d.tmp)
>     Error in validObject(.Object) :
>     invalid class "SpatialPolygons" object: non-unique Polygons ID
>     slot values
>
>
>     Then I am trying to use following code, but it did  not work. it 
>     _created a empty layer. _I think I did something wrong.  Any idea,
>
>     # Code for similar file name (shape.shp)
>     setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Testf")
>     library(rgdal)
>
>     files <- list.files(pattern = "shp")  # get all the names in the
>     directory
>     files <- files[file.info <http://file.info>(files)$isdir]  # only
>     keep the directories
>
>     layer<- file('layer.shp')  # output file
>     for (Dir in files){
>         input <- readOGR(file.path(Dir, "shape.shp")) 
>         rbind(input, layer)  
>     }
>     close(layer)
>
>     I have a situations  like   all shape files are different names
>     (like...001.shp, ...003.shp, ....005.shp  so on ) and were saved
>     in different folders (like fn001, fn003, fn005....... If someone
>     helps me to write correct code  for solving this it will be great.
>
>     Zia 
>


From seanpor at acm.org  Thu Jan 21 06:50:01 2010
From: seanpor at acm.org (Sean O'Riordain)
Date: Thu, 21 Jan 2010 05:50:01 +0000
Subject: [R-sig-Geo] Helping with write a function. Merging shape files?
In-Reply-To: <4B57BEB8.1050103@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
	<4B57BEB8.1050103@cornell.edu>
Message-ID: <8ed68eed1001202150u62e41e34k118b87ad11951cd1@mail.gmail.com>

Hi Zia,

Can I suggest that you have a good read of
?list.files
and in particular the section on pattern=...

and possibly also
?glob2rx

so you might be modifying Matt's script by changing to
list.files(glob2rx('poly_shape.*.shp'))
or similar

cheers,
Sean


On Thu, Jan 21, 2010 at 2:40 AM, Zia Ahmed <zua3 at cornell.edu> wrote:
> Hi Matt,
>
> Your ?code ?work perfectly. As a test run, I am able to merge lower 48
> states and create a polygon of Con. USA when ?all files are in one ?folder.
> ?But ?SSURGO data ?organized like ?following way (not exactly)
> state_name (wd)/
> ? ?state_001 (subfolder)/spatial/several shape files (a_shape001.shp,
> *poly_shape001.shp,* l_shape001.shp)
> ? ?state_003 (subfolder)/spatial/several shape files (a_shape003.shp,
> *poly_shape003.shp*, ?l_shape003.shp)
> ? ?state_005 (subfolder)/spatial/several shape files (a_shape005.shp,
> *poly_shape005.shp*, ?l_shape005.shp)
> ---------
> ? ?state_065 (subfolder)/spatial/several shape files (a_shape065.shp,
> *poly_shape065.shp*, ?l_shape065.shp)
>
> like this.
>
> I like to select one shape file (suppose *poly_shape-----.shp*) ? from each
> ?of sub folder of ?my working directory and merge them together. Is there
> any way to do this in a loop?
> Thanks again
> Zia
>
> Matt Beard wrote:
>>
>> Zia,
>>
>> The error you received was 'invalid class "SpatialPolygons" object:
>> non-unique Polygons ID slot values'.
>> Renaming the Polygons IDs so that they are unique should fix your problem.
>>
>> The following code along with some test shapefiles I used are attached.
>>
>> library(rgdal)
>> setwd("C:/test")
>>
>> # obtain shapefiles in current directory
>> files <- list.files(pattern = "shp")
>>
>> # get polygons from first file
>> data.first <- readOGR(files[1], gsub(".shp","",files[1]))
>> polygons <- slot(data.first, "polygons")
>>
>> # add polygons from remaining files
>> for (i in 2:length(files)) {
>> ? data.temp <- readOGR(files[i], gsub(".shp","",files[i]))
>> ? polygons <- c(slot(data.temp, "polygons"),polygons)
>> }
>>
>> # rename IDs of Polygons
>> for (i in 1:length(polygons)) {
>> ? slot(polygons[[i]], "ID") <- paste(i)
>> }
>>
>> # ain't that spatial
>> spatialPolygons <- SpatialPolygons(polygons)
>> spdf <- SpatialPolygonsDataFrame(spatialPolygons,
>> data.frame(fakeData=1:length(polygons)))
>>
>> # output combined results
>> plot(spatialPolygons)
>> writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", driver="ESRI
>> Shapefile")
>>
>> # end of code
>>
>> My test shapefiles had very different attribute tables, so I didn't bother
>> combining the data tables.
>> However, the code above should at least show you that your method can
>> work.
>>
>> I found it interesting that when I combined the polygons in the opposite
>> order:
>> polygons <- c(polygons,slot(data.temp, "polygons"))
>>
>> the SoutheasternStates polygons completely covered up the Florida polygons
>> in QGis, but
>> the Florida polygons showed up when plotting in R:
>> plot(spatialPolygons)
>>
>> Does the R 'plot' function order the polygons before displaying them? Is
>> it possible to view the code
>> for a function like plot(SpatialPolygons)?
>>
>> Matt
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> On Wed, Jan 20, 2010 at 4:14 PM, Zia Ahmed <zua3 at cornell.edu
>> <mailto:zua3 at cornell.edu>> wrote:
>>
>> ? ?Thanks! I am trying to write a function to merge or combine
>> ? ?several shape files.
>>
>> ? ?First I try to use following function when all shape files in one
>> ? ?folder. It showed error.
>>
>> ? ?setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Test1")
>> ? ?library(rgdal)
>> ? ?## obtain shapefile names in current directory
>> ? ?fs <- list.files(pattern = "shp")
>> ? ? ## read the first one
>> ? ? d <- readOGR(fs[1], gsub(".shp", "", fs[1]))
>> ? ? for (i in 2:length(fs)) {
>> ? ? d.tmp <- readOGR(fs[i], gsub(".shp", "", fs[i]))
>> ? ? }
>> ? ? d <- rbind(d, d.tmp)
>> ? ?> ?d <- rbind(d, d.tmp)
>> ? ?Error in validObject(.Object) :
>> ? ?invalid class "SpatialPolygons" object: non-unique Polygons ID
>> ? ?slot values
>>
>>
>> ? ?Then I am trying to use following code, but it did ?not work. it
>> ?_created a empty layer. _I think I did something wrong. ?Any idea,
>>
>> ? ?# Code for similar file name (shape.shp)
>> ? ?setwd("E:/Zia/SURRGO_Data/SSURGO_RAW_DATA/Testf")
>> ? ?library(rgdal)
>>
>> ? ?files <- list.files(pattern = "shp") ?# get all the names in the
>> ? ?directory
>> ? ?files <- files[file.info <http://file.info>(files)$isdir] ?# only
>> ? ?keep the directories
>>
>> ? ?layer<- file('layer.shp') ?# output file
>> ? ?for (Dir in files){
>> ? ? ? ?input <- readOGR(file.path(Dir, "shape.shp")) ? ? ? ?rbind(input,
>> layer) ? ? ?}
>> ? ?close(layer)
>>
>> ? ?I have a situations ?like ? all shape files are different names
>> ? ?(like...001.shp, ...003.shp, ....005.shp ?so on ) and were saved
>> ? ?in different folders (like fn001, fn003, fn005....... If someone
>> ? ?helps me to write correct code ?for solving this it will be great.
>>
>> ? ?Zia
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From julleeyaw at yahoo.ca  Thu Jan 21 22:42:16 2010
From: julleeyaw at yahoo.ca (Julie Lee-Yaw)
Date: Thu, 21 Jan 2010 13:42:16 -0800 (PST)
Subject: [R-sig-Geo] quick projection question
Message-ID: <632535.55150.qm@web30603.mail.mud.yahoo.com>

Hi,

I am trying to reproject a shapefile in R. The current projection that I am using is a lambert equal area projection defined by the proj4string:

+proj=laea +lat_0=90 +lon_0=-100 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs

I've since decided that it would be better for my calculations (areas of polygons in Canada) if the projection was centred at 60 degrees latitude instead of at the north pole. To reproject the shapefile using rgdal, is it simply sufficient to enter the following proj4string as an argument (e.g. just change the value of +lat_0)?

e.g. 
spProj=spTransform(file,CRS("+proj=laea +lat_0=60 +lon_0=-100 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"))

is this the proper way to chance the latitude of origin? or am I missing a step that is needed to create a custom CRS?

Thanks!

Julie





      __________________________________________________________________
[[elided Yahoo spam]]


From laura.poggio at gmail.com  Fri Jan 22 09:25:46 2010
From: laura.poggio at gmail.com (Laura Poggio)
Date: Fri, 22 Jan 2010 08:25:46 +0000
Subject: [R-sig-Geo] SpatialGridDataFrame to data.frame
Message-ID: <e027b8751001220025v113b090ub7d0cd1fee2b2779@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100122/3d70afa7/attachment.pl>

From stefano at casalegno.net  Fri Jan 22 10:21:36 2010
From: stefano at casalegno.net (Stefano Casalegno)
Date: Fri, 22 Jan 2010 10:21:36 +0100
Subject: [R-sig-Geo] SpatialGridDataFrame to data.frame
In-Reply-To: <e027b8751001220025v113b090ub7d0cd1fee2b2779@mail.gmail.com>
References: <e027b8751001220025v113b090ub7d0cd1fee2b2779@mail.gmail.com>
Message-ID: <38566B17-0D5F-4373-B718-7DE3127E189B@casalegno.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100122/392e9f2d/attachment.pl>

From laura.poggio at gmail.com  Fri Jan 22 10:32:52 2010
From: laura.poggio at gmail.com (Laura Poggio)
Date: Fri, 22 Jan 2010 09:32:52 +0000
Subject: [R-sig-Geo] SpatialGridDataFrame to data.frame
In-Reply-To: <38566B17-0D5F-4373-B718-7DE3127E189B@casalegno.net>
References: <e027b8751001220025v113b090ub7d0cd1fee2b2779@mail.gmail.com>
	<38566B17-0D5F-4373-B718-7DE3127E189B@casalegno.net>
Message-ID: <e027b8751001220132v72da875avb5aa783e01ae2e9b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100122/369cbfb6/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 22 15:40:24 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 22 Jan 2010 15:40:24 +0100 (CET)
Subject: [R-sig-Geo] quick projection question
In-Reply-To: <632535.55150.qm@web30603.mail.mud.yahoo.com>
References: <632535.55150.qm@web30603.mail.mud.yahoo.com>
Message-ID: <alpine.LRH.2.00.1001221535550.16861@reclus.nhh.no>

On Thu, 21 Jan 2010, Julie Lee-Yaw wrote:

> Hi,
>
> I am trying to reproject a shapefile in R. The current projection that I 
> am using is a lambert equal area projection defined by the proj4string:
>
> +proj=laea +lat_0=90 +lon_0=-100 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 
> +units=m +no_defs
>
> I've since decided that it would be better for my calculations (areas of 
> polygons in Canada) if the projection was centred at 60 degrees latitude 
> instead of at the north pole. To reproject the shapefile using rgdal, is 
> it simply sufficient to enter the following proj4string as an argument 
> (e.g. just change the value of +lat_0)?
>
> e.g.
> spProj=spTransform(file,CRS("+proj=laea +lat_0=60 +lon_0=-100 +x_0=0 
> +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"))
>
> is this the proper way to chance the latitude of origin? or am I missing 
> a step that is needed to create a custom CRS?

This looks OK, please try it and see, perhaps by seeing if a further 
transformation to longlat and export to KML, maybe for a chosen subset of 
polygons if there are many. Viewing in GE would then show if the transfom 
from your custom CRS transfomed further to geographical coordinates ends 
up in the "right" place.

Roger

>
> Thanks!
>
> Julie
>
>
>
>
>
>      __________________________________________________________________
> [[elided Yahoo spam]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zua3 at cornell.edu  Sat Jan 23 04:45:19 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Fri, 22 Jan 2010 22:45:19 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape file with
	all fields?
In-Reply-To: <9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>	
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>	
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
Message-ID: <4B5A70CF.1040207@cornell.edu>

Hi Matt:
With help of Jim Holtman  (my R Guru!), I am able to modified your code 
for selecting  particular type  of shape  files from  different folders 
and able to  combine them together. Thank you so much!
However, final polygon does not contain any filed  (suppose county name, 
FIPS code  etc) of  the shape files those I used for merging . How do I 
keep these fields  in  my final polygon.   Any idea?
Thanks
Zia

# Rode for combing Code
library(rgdal)
setwd("D:/test")
files <- list.files(pattern="soilmu_a_ny.*.shp$", 
recursive=TRUE,full.names=TRUE)

# Get polygons from first file

data.first <- readOGR(files[1],gsub("^.*/(.*).shp$", "\\1", files[1]))
polygons <- slot(data.first, "polygons")

# add polygons from remaining files

for (i in 2:length(files)) {
    data.temp <- readOGR(files[i], gsub("^.*/(.*).shp$", "\\1",files[i]))
    polygons <- c(slot(data.temp, "polygons"),polygons)
    }

# rename IDs of Polygons

for (i in 1:length(polygons)) {
slot(polygons[[i]], "ID") <- paste(i)
    }

# ain't that spatial

spatialPolygons <- SpatialPolygons(polygons)
spdf <- SpatialPolygonsDataFrame(spatialPolygons,
data.frame(NewID =1:length(polygons)))

# output combined results
plot(spatialPolygons)
writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", 
driver="ESRI Shapefile")


From seanpor at acm.org  Sat Jan 23 09:57:24 2010
From: seanpor at acm.org (Sean O'Riordain)
Date: Sat, 23 Jan 2010 08:57:24 +0000
Subject: [R-sig-Geo] Helping with write a function. Merging shape file
	with all fields?
In-Reply-To: <4B5A70CF.1040207@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
	<4B5A70CF.1040207@cornell.edu>
Message-ID: <8ed68eed1001230057x706bb91ega87a5de4a0fb0599@mail.gmail.com>

Hi Zia,

I don't know whether it will work for you, but I was able to read in
fairly boundary polygons (11k lines) and merge them using spRbind()

Not sure if it's exactly what you want as I'm pretty much a beginner
over here on r-sig-geo...

cheers,
Sean


On Sat, Jan 23, 2010 at 3:45 AM, Zia Ahmed <zua3 at cornell.edu> wrote:
> Hi Matt:
> With help of Jim Holtman ?(my R Guru!), I am able to modified your code for
> selecting ?particular type ?of shape ?files from ?different folders and able
> to ?combine them together. Thank you so much!
> However, final polygon does not contain any filed ?(suppose county name,
> FIPS code ?etc) of ?the shape files those I used for merging . How do I keep
> these fields ?in ?my final polygon. ? Any idea?
> Thanks
> Zia
>
> # Rode for combing Code
> library(rgdal)
> setwd("D:/test")
> files <- list.files(pattern="soilmu_a_ny.*.shp$",
> recursive=TRUE,full.names=TRUE)
>
> # Get polygons from first file
>
> data.first <- readOGR(files[1],gsub("^.*/(.*).shp$", "\\1", files[1]))
> polygons <- slot(data.first, "polygons")
>
> # add polygons from remaining files
>
> for (i in 2:length(files)) {
> ? data.temp <- readOGR(files[i], gsub("^.*/(.*).shp$", "\\1",files[i]))
> ? polygons <- c(slot(data.temp, "polygons"),polygons)
> ? }
>
> # rename IDs of Polygons
>
> for (i in 1:length(polygons)) {
> slot(polygons[[i]], "ID") <- paste(i)
> ? }
>
> # ain't that spatial
>
> spatialPolygons <- SpatialPolygons(polygons)
> spdf <- SpatialPolygonsDataFrame(spatialPolygons,
> data.frame(NewID =1:length(polygons)))
>
> # output combined results
> plot(spatialPolygons)
> writeOGR(spdf, dsn="C:/test/combined.shp", layer="combined", driver="ESRI
> Shapefile")
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From biozealot21 at gmail.com  Sat Jan 23 11:35:22 2010
From: biozealot21 at gmail.com (Matt Beard)
Date: Sat, 23 Jan 2010 05:35:22 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape file
	with all fields?
In-Reply-To: <4B5A70CF.1040207@cornell.edu>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>
	<4B577249.8050705@cornell.edu>
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>
	<4B5A70CF.1040207@cornell.edu>
Message-ID: <9e6818f31001230235q402437as22b8c5b2a0a1cd47@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100123/4e345cca/attachment.pl>

From michael.denslow at gmail.com  Sat Jan 23 18:20:21 2010
From: michael.denslow at gmail.com (Michael Denslow)
Date: Sat, 23 Jan 2010 12:20:21 -0500
Subject: [R-sig-Geo] help installing package webmaps
Message-ID: <b440a3f81001230920k76608321r7d2b73e9983c2b55@mail.gmail.com>

After reading this thread:
http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg06797.html

I thought I would try out the package webmaps.

So I ran the following script

install.packages("webmaps",
	repos="http://R-Forge.R-project.org", dependencies = TRUE, type =
'source') # Mac binary was not found

After the first run there was a message about package pixmap not being
available, so I installed it from CRAN.

Then I ran the above script again and got this message:


also installing the dependency ?brew?

trying URL 'http://R-Forge.R-project.org/src/contrib/bpm_1.0.tar.gz'
Content type 'application/x-gzip' length 28510 bytes (27 Kb)
opened URL
==================================================
downloaded 27 Kb

trying URL 'http://R-Forge.R-project.org/src/contrib/weather_0.2.tar.gz'
Content type 'application/x-gzip' length 8454 bytes
opened URL
==================================================
downloaded 8454 bytes

* installing *source* package ?bpm? ...
** R
** data
** inst
** preparing package for lazy loading
** help
No man pages found in package  ?bpm?
*** installing help indices
** building package indices ...
* DONE (bpm)
* installing *source* package ?weather? ...
** R
** preparing package for lazy loading
Loading required package: sp

raster version 0.9.9-3 (17-January-2010)
** help
*** installing help indices
** building package indices ...
* DONE (weather)

The downloaded packages are in
	?/private/var/folders/jb/jbg8gZ5FFbuNBOCxKXW6yE+++TI/-Tmp-/RtmpgKbeA4/downloaded_packages?
Updating HTML index of packages in '.Library'


When I try to load the library I get:

library(webmaps)
Error in library(webmaps) : there is no package called 'webmaps'

Can anyone help me understand what I am doing wrong here?
Also is there a way to tell what the package dependencies are for a
package hosted on R forge?

Thanks for an help you can provide,

Michael


> sessionInfo()
R version 2.10.1 (2009-12-14)
x86_64-apple-darwin9.8.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.10.1

-- 
Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Department of Biology
Appalachian State University
Boone, North Carolina U.S.A.
-- AND --
Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org

36.214177, -81.681480 +/- 3103 meters


From b.rowlingson at lancaster.ac.uk  Sat Jan 23 18:55:19 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 23 Jan 2010 17:55:19 +0000
Subject: [R-sig-Geo] help installing package webmaps
In-Reply-To: <b440a3f81001230920k76608321r7d2b73e9983c2b55@mail.gmail.com>
References: <b440a3f81001230920k76608321r7d2b73e9983c2b55@mail.gmail.com>
Message-ID: <d8ad40b51001230955y515dc1e2n52a2bc4234d7bade@mail.gmail.com>

[list owner: sorry I first sent this with the wrong email address]

On Sat, Jan 23, 2010 at 5:20 PM, Michael Denslow
<michael.denslow at gmail.com> wrote:

> install.packages("webmaps",
>        repos="http://R-Forge.R-project.org", dependencies = TRUE, type =
> 'source') # Mac binary was not found

 There's no Mac binary because there's no rgdal on R-forge. There's
probably enough spatial packages on there that it wouldn't be a
reasonable request for them to have it..

> trying URL 'http://R-Forge.R-project.org/src/contrib/weather_0.2.tar.gz'
> Content type 'application/x-gzip' length 8454 bytes

> * installing *source* package ?weather? ...
[...]
> ** building package indices ...
> * DONE (weather)

 'weather'? I don't know why my webmaps, or brew, would need that -
did you mistype 'webmaps'?

 That would explain:

> library(webmaps)
> Error in library(webmaps) : there is no package called 'webmaps'

> Can anyone help me understand what I am doing wrong here?

 My hypothesis is that you typed 'weather' instead of 'webmaps' :)
There is a package on r-forge called 'weather'.

> Also is there a way to tell what the package dependencies are for a
> package hosted on R forge?

 Look at the DESCRIPTION file in the SCM section:

https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/DESCRIPTION?rev=23&root=webmaps&view=markup

For webmaps you'll need:

Depends: sp, rgdal, brew, pixmap

Hope that helps!

Barry


--
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From michael.denslow at gmail.com  Sat Jan 23 19:40:27 2010
From: michael.denslow at gmail.com (Michael Denslow)
Date: Sat, 23 Jan 2010 13:40:27 -0500
Subject: [R-sig-Geo] help installing package webmaps
In-Reply-To: <d8ad40b51001230955y515dc1e2n52a2bc4234d7bade@mail.gmail.com>
References: <b440a3f81001230920k76608321r7d2b73e9983c2b55@mail.gmail.com>
	<d8ad40b51001230955y515dc1e2n52a2bc4234d7bade@mail.gmail.com>
Message-ID: <b440a3f81001231040h2c3b5de5of049bc3a795b4637@mail.gmail.com>

Hi Barry!

On Sat, Jan 23, 2010 at 12:55 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> [list owner: sorry I first sent this with the wrong email address]
>
> On Sat, Jan 23, 2010 at 5:20 PM, Michael Denslow
> <michael.denslow at gmail.com> wrote:
>
>> install.packages("webmaps",
>> ? ? ? ?repos="http://R-Forge.R-project.org", dependencies = TRUE, type =
>> 'source') # Mac binary was not found
>
> ?There's no Mac binary because there's no rgdal on R-forge. There's
> probably enough spatial packages on there that it wouldn't be a
> reasonable request for them to have it..

Got it and rgdal for Mac OS is a whole other issue....

>
>> trying URL 'http://R-Forge.R-project.org/src/contrib/weather_0.2.tar.gz'
>> Content type 'application/x-gzip' length 8454 bytes
>
>> * installing *source* package ?weather? ...
> [...]
>> ** building package indices ...
>> * DONE (weather)
>
> ?'weather'? I don't know why my webmaps, or brew, would need that -
> did you mistype 'webmaps'?
>
> ?That would explain:
>
>> library(webmaps)
>> Error in library(webmaps) : there is no package called 'webmaps'
>
>> Can anyone help me understand what I am doing wrong here?
>
> ?My hypothesis is that you typed 'weather' instead of 'webmaps' :)
> There is a package on r-forge called 'weather'.


This is strange. I would not rule out a misspelling on my part but I
tried the script again after installing all of the needed dependencies
from CRAN and it still installs weather. I also tried to install
webmaps from the Mac GUI and same thing happens. This is even after
restarting R.

So I downloaded the source files and ran in the Terminal

cd ~/Downloads
R CMD INSTALL webmaps_1.2.tar.gz

And all is well. Thanks for your help, I am going through the vignette now.

Michael

>> Also is there a way to tell what the package dependencies are for a
>> package hosted on R forge?
>
> ?Look at the DESCRIPTION file in the SCM section:
>
> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/DESCRIPTION?rev=23&root=webmaps&view=markup
>
> For webmaps you'll need:
>
> Depends: sp, rgdal, brew, pixmap
>
> Hope that helps!
>
> Barry
>
>
> --
> blog: http://geospaced.blogspot.com/
> web: http://www.maths.lancs.ac.uk/~rowlings
> web: http://www.rowlingson.com/
> twitter: http://twitter.com/geospacedman
> pics: http://www.flickr.com/photos/spacedman
>



-- 
Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Department of Biology
Appalachian State University
Boone, North Carolina U.S.A.
-- AND --
Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org

36.214177, -81.681480 +/- 3103 meters


From zua3 at cornell.edu  Sat Jan 23 20:29:10 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Sat, 23 Jan 2010 14:29:10 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape file
	with all fields?
In-Reply-To: <9e6818f31001230235q402437as22b8c5b2a0a1cd47@mail.gmail.com>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>	
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>	
	<4B577249.8050705@cornell.edu>	
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>	
	<4B5A70CF.1040207@cornell.edu>
	<9e6818f31001230235q402437as22b8c5b2a0a1cd47@mail.gmail.com>
Message-ID: <4B5B4E06.8050101@cornell.edu>

Thanks  a lot! I will try accordingly.
Thanks again
Zia

Matt Beard wrote:
> Zia,
>
> Does this work?
> Set your working directory and your output filename.
>
> library(rgdal)
> library(maptools)
> setwd("C:/test")                                              # CHANGE 
> THIS
> combinedShp <- "C:/test/combined.shp"           # CHANGE THIS
>
> # obtain shapefiles in current directory
> files <- list.files(pattern = "shp")
> uid <- 1
>
> # get polygons from first file
> poly.data <- readOGR(files[1], gsub(".shp","",files[1]))
> n <- length(slot(poly.data, "polygons"))
> poly.data <- spChFIDs(poly.data, as.character(uid:(uid+n-1)))
> uid <- uid + n
>
> # add polygons from remaining files
> for (i in 2:length(files)) {
>    temp.data <- readOGR(files[i], gsub(".shp","",files[i]))
>    n <- length(slot(temp.data, "polygons"))
>    temp.data <- spChFIDs(temp.data, as.character(uid:(uid+n-1)))
>    uid <- uid + n
>    poly.data <- spRbind(poly.data,temp.data)
> }
>
> writeOGR(poly.data, dsn=combinedShp, layer="combined", driver="ESRI 
> Shapefile")
>
>
> Matt Beard
> Purdue University
>
>
>
>
> On Fri, Jan 22, 2010 at 10:45 PM, Zia Ahmed <zua3 at cornell.edu 
> <mailto:zua3 at cornell.edu>> wrote:
>
>     Hi Matt:
>     With help of Jim Holtman  (my R Guru!), I am able to modified your
>     code for selecting  particular type  of shape  files from
>      different folders and able to  combine them together. Thank you
>     so much!
>     However, final polygon does not contain any filed  (suppose county
>     name, FIPS code  etc) of  the shape files those I used for merging
>     . How do I keep these fields  in  my final polygon.   Any idea?
>     Thanks
>     Zia
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100123/aefaf358/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100123/aefaf358/attachment.vcf>

From zua3 at cornell.edu  Mon Jan 25 04:25:06 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Sun, 24 Jan 2010 22:25:06 -0500
Subject: [R-sig-Geo] Helping with write a function. Merging shape file
	with all fields?
In-Reply-To: <9e6818f31001230235q402437as22b8c5b2a0a1cd47@mail.gmail.com>
References: <20100118095212.a9r9hiun4gc08sw8@spatial-analyst.net>	
	<4B564779.5040509@cornell.edu> <4B56B77B.3020203@web.de>	
	<4B577249.8050705@cornell.edu>	
	<9e6818f31001201738m41f1ac1arec84327275b4ba72@mail.gmail.com>	
	<4B5A70CF.1040207@cornell.edu>
	<9e6818f31001230235q402437as22b8c5b2a0a1cd47@mail.gmail.com>
Message-ID: <4B5D0F12.8050507@cornell.edu>

Thank you so much  Matt! It works perfectly. This R-code saves lot of my 
of my time. I appreciate you help.

Zia


Matt Beard wrote:
> Zia,
>
> Does this work?
> Set your working directory and your output filename.
>
> library(rgdal)
> library(maptools)
> setwd("C:/test")                                              # CHANGE 
> THIS
> combinedShp <- "C:/test/combined.shp"           # CHANGE THIS
>
> # obtain shapefiles in current directory
> files <- list.files(pattern = "shp")
> uid <- 1
>
> # get polygons from first file
> poly.data <- readOGR(files[1], gsub(".shp","",files[1]))
> n <- length(slot(poly.data, "polygons"))
> poly.data <- spChFIDs(poly.data, as.character(uid:(uid+n-1)))
> uid <- uid + n
>
> # add polygons from remaining files
> for (i in 2:length(files)) {
>    temp.data <- readOGR(files[i], gsub(".shp","",files[i]))
>    n <- length(slot(temp.data, "polygons"))
>    temp.data <- spChFIDs(temp.data, as.character(uid:(uid+n-1)))
>    uid <- uid + n
>    poly.data <- spRbind(poly.data,temp.data)
> }
>
> writeOGR(poly.data, dsn=combinedShp, layer="combined", driver="ESRI 
> Shapefile")
>
>
> Matt Beard
> Purdue University
>
>
>
>
> On Fri, Jan 22, 2010 at 10:45 PM, Zia Ahmed <zua3 at cornell.edu 
> <mailto:zua3 at cornell.edu>> wrote:
>
>     Hi Matt:
>     With help of Jim Holtman  (my R Guru!), I am able to modified your
>     code for selecting  particular type  of shape  files from
>      different folders and able to  combine them together. Thank you
>     so much!
>     However, final polygon does not contain any filed  (suppose county
>     name, FIPS code  etc) of  the shape files those I used for merging
>     . How do I keep these fields  in  my final polygon.   Any idea?
>     Thanks
>     Zia
>


From tobias.michele at gmail.com  Mon Jan 25 05:16:14 2010
From: tobias.michele at gmail.com (Michele Tobias)
Date: Sun, 24 Jan 2010 20:16:14 -0800
Subject: [R-sig-Geo] Raster Sample Data
Message-ID: <4B5D1B0E.4020306@gmail.com>

I'm looking for some raster data to use to with the Raster package (it's 
for students to work with in a class) and I was wondering if anyone had 
some suggestions of any sample datasets that come with other R 
packages.  I've found the Meuse.grid data that comes with the SP Package 
which is a good start, but I'd also like to find some other data.  
Vegetation reflectance data would be ideal so we can do some NDVI 
calculations, but anything we can logically run some mathematical 
operations on would work.  It would also be good if the files were of a 
relatively small size.  Downloading full Landsat scenes, for example, 
will be pretty cumbersome.

Thanks for your help!

best,
Michele

PhD Candidate
Geography Graduate Group
University of California, Davis
mmtobias at ucdavis.edu


From sjmyers at syr.edu  Mon Jan 25 06:07:41 2010
From: sjmyers at syr.edu (Seth J Myers)
Date: Mon, 25 Jan 2010 05:07:41 +0000
Subject: [R-sig-Geo] ggwr residual types question and a few others
Message-ID: <1376A5E559F71E428D5C19542879F85C02A588F9@BL2PRD0102MB030.prod.exchangelabs.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100125/8383e9d3/attachment.pl>

From milton.ruser at gmail.com  Mon Jan 25 07:13:23 2010
From: milton.ruser at gmail.com (milton ruser)
Date: Mon, 25 Jan 2010 01:13:23 -0500
Subject: [R-sig-Geo] Raster Sample Data
In-Reply-To: <4B5D1B0E.4020306@gmail.com>
References: <4B5D1B0E.4020306@gmail.com>
Message-ID: <3aaf1a031001242213s562d79b3ya9febc352632afa0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100125/6769e258/attachment.ksh>

From j.m.signer at gmail.com  Mon Jan 25 08:22:01 2010
From: j.m.signer at gmail.com (Johannes Signer)
Date: Mon, 25 Jan 2010 08:22:01 +0100
Subject: [R-sig-Geo] Raster Sample Data
In-Reply-To: <4B5D1B0E.4020306@gmail.com>
References: <4B5D1B0E.4020306@gmail.com>
Message-ID: <aa7630001001242322k56359a71wc5bb51018d72fe33@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100125/ddc7ae94/attachment.pl>

From hengl at spatial-analyst.net  Mon Jan 25 09:15:46 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 25 Jan 2010 09:15:46 +0100
Subject: [R-sig-Geo] Raster Sample Data
In-Reply-To: <4B5D1B0E.4020306@gmail.com>
References: <4B5D1B0E.4020306@gmail.com>
Message-ID: <4B5D5332.8010702@spatial-analyst.net>


Here are several data sets that I try to maintain and improve always:

DEMs for testing geomorphometry algorithms:
http://geomorphometry.org/content/data-sets

The Baranja hill data set includes many rasters of different type:
http://geomorphometry.org/content/baranja-hill

We used in in our book (http://geomorphometry.org/book).

Data sets for testing geostatistical apps:
http://spatial-analyst.net/book/data-sets

10 km resolution publicly available world maps:
http://spatial-analyst.net/wiki/index.php?title=Global_datasets

HTH

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


Michele Tobias wrote:
> I'm looking for some raster data to use to with the Raster package (it's 
> for students to work with in a class) and I was wondering if anyone had 
> some suggestions of any sample datasets that come with other R 
> packages.  I've found the Meuse.grid data that comes with the SP Package 
> which is a good start, but I'd also like to find some other data.  
> Vegetation reflectance data would be ideal so we can do some NDVI 
> calculations, but anything we can logically run some mathematical 
> operations on would work.  It would also be good if the files were of a 
> relatively small size.  Downloading full Landsat scenes, for example, 
> will be pretty cumbersome.
> 
> Thanks for your help!
> 
> best,
> Michele
> 
> PhD Candidate
> Geography Graduate Group
> University of California, Davis
> mmtobias at ucdavis.edu
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Mon Jan 25 10:53:57 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 25 Jan 2010 10:53:57 +0100
Subject: [R-sig-Geo] ggwr residual types question and a few others
In-Reply-To: <1376A5E559F71E428D5C19542879F85C02A588F9@BL2PRD0102MB030.prod.exchangelabs.com>
References: <1376A5E559F71E428D5C19542879F85C02A588F9@BL2PRD0102MB030.prod.exchangelabs.com>
Message-ID: <4B5D6A35.9090602@uni-muenster.de>

Seth, I believe that response residuals are the residuals obtaind by 
(measurement - prediction) on the measurement scale ([0,1], for logit); 
working residuals are the residuals obtained in the last step of the 
weighted minimization, i.e. on the transformed measurements. Note that 
predictions are not 0 or 1, but usually somewhere between 0 and 1.

Individual elements of the object returned can be obtained by addressing 
them explicitly. Finding out how they are called, e.g. by

example(gwr)
names(nc)
lapply(nc,class)
summary(nc$SDF)

for the additional fields, you probably need to specify more input 
arguments (e.g. hatmatrix, fit.points). Look into the help page of gwr, 
and please provide us with a reproducable example!
--
Edzer

Seth J Myers wrote:
> Hi,
>
> First post, thanks for this list.  I've just spent the last few days learning how to use ggwr in spgwr.  I fit a glm with family=binomial(link="logit"), and have discovered how to export my SpatialPointsDataFrame as a text file so I can work with it in other packages I'm more familiar with (not ready to tackle the full R learning curve yet).  I have a few basic questions first, for a logistic regression I understand pearson and deviance residuals, but what would the residual types of response and working be?  I specified response thinking it would be binary response(0 or 1) - probability of 1, but it returned values that indicate this isn't the case.  Also, in the spgwr documentation it states that ggwr returns a SpatialPointsDataFrame of class "gwr" and that its "data" slot can (will?) have the following: fit.points, weights, GWR coefficient estimates, R-sqaured, and coefficient standard errors.  So, far the output I get from exporting mymodel to a txt using write.table or !
>  viewed on the screen by simply mymodel$SDF only includes the following: row ID, intercept value, coefficient estimates for predictors, dispersion (always 1 in my case), working_resids, and x and y coordinates.  Is there some 'switch' internal to ggwr function or something else to specify to get such things as SE of coefficients and (more importantly to me) a residual that truly is reponse(0 or 1)-prediction(0 to 1)?  Thanks. -Seth Myers
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From ervan.rutishauser at cirad.fr  Mon Jan 25 13:27:14 2010
From: ervan.rutishauser at cirad.fr (Ervan Rutishauser)
Date: Mon, 25 Jan 2010 13:27:14 +0100
Subject: [R-sig-Geo] Enlarge figure in spatstat
Message-ID: <000801ca9db9$b9af8980$2d0e9c80$@rutishauser@cirad.fr>

Dear all,

I wonder how to resize a figure in spatstat, as it currently appears with
large
Margins (useless for me). I would like to enlarge my figure at maximum in
the windows and
optionally add some legend...
Thank you very much for any tips!

Best regards,
Ervan

______________________________________________________________________
Ervan Rutishauser
CIRAD - UMR AMAP 
PS1-Bd de la Lironde
34398 Montpellier cedex 5
phone: 04.67.61.53.90



	[[alternative HTML version deleted]]


From rhurlin at gwdg.de  Mon Jan 25 22:04:47 2010
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Mon, 25 Jan 2010 22:04:47 +0100
Subject: [R-sig-Geo] rgdal 64bit Windows version?
Message-ID: <4B5E076F.7@gwdg.de>

Some days ago Brian Ripley and Uwe Ligges announced an update to 
MinGW-w64 builds for 64-bit Windows on R-devel at . This daily version 
works really nice. But it is not fully applicable at this time because 
of some missing packages.

I am in particular interested in a 64-bit version of rgdal, which 
depends on a 64-bit version of gdal(.dll). Is their anything known about 
what is planned with this important part of spatial software?

Thanks for answering,
Rainer Hurling


From mdsumner at gmail.com  Mon Jan 25 22:25:43 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 26 Jan 2010 08:25:43 +1100
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <4B5E076F.7@gwdg.de>
References: <4B5E076F.7@gwdg.de>
Message-ID: <522664f81001251325hc4b2bd5y6389af5aa75c6855@mail.gmail.com>

I suspect you'll need to build GDAL for yourself and then build rgdal
on top of that, since rgdal depends upon a pre-installation of GDAL.
The gdal-dev list is the appropriate place for discussing the first
step.

Colleagues have succesfully built 64-bit Windows GDAL from the 1.6.0
release using extra binaries (HDF4/5, NetCDF, etc.) from here:
http://vbkto.dyndns.org:1280/sdk/Default.aspx

There are notes on build rgdal for Windows here, but I've not done it
myself for a while:

file.show(system.file("README.windows", package="rgdal"))

I am keen to try this for myself, but it will not be for a while yet.

Best regards,
Mike

On Tue, Jan 26, 2010 at 8:04 AM, Rainer Hurling <rhurlin at gwdg.de> wrote:
> Some days ago Brian Ripley and Uwe Ligges announced an update to MinGW-w64
> builds for 64-bit Windows on R-devel at . This daily version works really nice.
> But it is not fully applicable at this time because of some missing
> packages.
>
> I am in particular interested in a 64-bit version of rgdal, which depends on
> a 64-bit version of gdal(.dll). Is their anything known about what is
> planned with this important part of spatial software?
>
> Thanks for answering,
> Rainer Hurling
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Mon Jan 25 22:35:02 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 25 Jan 2010 22:35:02 +0100 (CET)
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <4B5E076F.7@gwdg.de>
References: <4B5E076F.7@gwdg.de>
Message-ID: <alpine.LRH.2.00.1001252212570.4666@reclus.nhh.no>

On Mon, 25 Jan 2010, Rainer Hurling wrote:

> Some days ago Brian Ripley and Uwe Ligges announced an update to MinGW-w64 
> builds for 64-bit Windows on R-devel at . This daily version works really nice. 
> But it is not fully applicable at this time because of some missing packages.
>
> I am in particular interested in a 64-bit version of rgdal, which depends on 
> a 64-bit version of gdal(.dll). Is their anything known about what is planned 
> with this important part of spatial software?

For this, a 64-bit MSYS is required. If someone who has a 64-bit Windows 
system can take the initiative on this, I would be very grateful - I have 
no access to any such system. Brian Ripley and Uwe Ligges have been in 
touch with me on this, and so far have put it aside until packages without 
external dependencies are done. It really does depend on our community 
building PROJ.4, EXPAT, and GDAL from source under 64-bit MSYS on a 
Windows 64-bit system using the same build train as other w64 packages, if 
we want it done.

Roger

>
> Thanks for answering,
> Rainer Hurling
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Tue Jan 26 00:50:32 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Jan 2010 00:50:32 +0100
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <4B5E076F.7@gwdg.de>
References: <4B5E076F.7@gwdg.de>
Message-ID: <4B5E2E48.6040805@uni-muenster.de>

Rainer, you could start trying to find out whether there is a MinGW-w64 
build of gdal around. If it's there, it should be fairly easy to port 
rgdal to this new target.

Rainer Hurling wrote:
> Some days ago Brian Ripley and Uwe Ligges announced an update to 
> MinGW-w64 builds for 64-bit Windows on R-devel at . This daily version 
> works really nice. But it is not fully applicable at this time because 
> of some missing packages.
>
> I am in particular interested in a 64-bit version of rgdal, which 
> depends on a 64-bit version of gdal(.dll). Is their anything known 
> about what is planned with this important part of spatial software?
>
> Thanks for answering,
> Rainer Hurling
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tech_dev at wildintellect.com  Tue Jan 26 05:11:55 2010
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Mon, 25 Jan 2010 20:11:55 -0800
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <alpine.LRH.2.00.1001252212570.4666@reclus.nhh.no>
References: <4B5E076F.7@gwdg.de>
	<alpine.LRH.2.00.1001252212570.4666@reclus.nhh.no>
Message-ID: <4B5E6B8B.7080809@wildintellect.com>

It might be wise to collaborate with the OSGeo4W project.
http://trac.osgeo.org/osgeo4w/
Many of the developers who deal with proj,gdal etc are behind this
project and there's a lot of good knowledge about MSYS in the group.

A 64bit version of OSGeo4W binaries seems like a good goal to introduce
that will directly lead to 64bit support in RGDAL.

Alex

Roger Bivand wrote:
> On Mon, 25 Jan 2010, Rainer Hurling wrote:
> 
>> Some days ago Brian Ripley and Uwe Ligges announced an update to
>> MinGW-w64 builds for 64-bit Windows on R-devel at . This daily version
>> works really nice. But it is not fully applicable at this time because
>> of some missing packages.
>>
>> I am in particular interested in a 64-bit version of rgdal, which
>> depends on a 64-bit version of gdal(.dll). Is their anything known
>> about what is planned with this important part of spatial software?
> 
> For this, a 64-bit MSYS is required. If someone who has a 64-bit Windows
> system can take the initiative on this, I would be very grateful - I
> have no access to any such system. Brian Ripley and Uwe Ligges have been
> in touch with me on this, and so far have put it aside until packages
> without external dependencies are done. It really does depend on our
> community building PROJ.4, EXPAT, and GDAL from source under 64-bit MSYS
> on a Windows 64-bit system using the same build train as other w64
> packages, if we want it done.
> 
> Roger
> 
>>
>> Thanks for answering,
>> Rainer Hurling


From rusers.sh at gmail.com  Tue Jan 26 05:32:57 2010
From: rusers.sh at gmail.com (rusers.sh)
Date: Mon, 25 Jan 2010 23:32:57 -0500
Subject: [R-sig-Geo] Intersection between polygons
Message-ID: <a835c81e1001252032y7f388ebcmb52f0e5470f65970@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100125/d67592bc/attachment.pl>

From alobolistas at gmail.com  Tue Jan 26 08:45:08 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 26 Jan 2010 08:45:08 +0100
Subject: [R-sig-Geo] points to lines and/or polygons
Message-ID: <f96702321001252345w7ada52bp6152392d0c1f280a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/7177f434/attachment.pl>

From mccallum at iiasa.ac.at  Tue Jan 26 09:22:14 2010
From: mccallum at iiasa.ac.at (Ian McCallum)
Date: Tue, 26 Jan 2010 09:22:14 +0100
Subject: [R-sig-Geo] R spatial matrix to SpatialGridDataFrame
Message-ID: <201001260822.o0Q8MLNL000743@amazon.iiasa.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/d651d7dc/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 26 09:53:44 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Jan 2010 09:53:44 +0100
Subject: [R-sig-Geo] R spatial matrix to SpatialGridDataFrame
In-Reply-To: <201001260822.o0Q8MLNL000743@amazon.iiasa.ac.at>
References: <201001260822.o0Q8MLNL000743@amazon.iiasa.ac.at>
Message-ID: <4B5EAD98.5060705@uni-muenster.de>

Something seems to have changed, since 2006 ... The following should work:

library(sp)
d <- list(x  =1:10, y = 22:31, z = matrix(1:100, 10, 10))
image(d)
gt <- GridTopology(cellcentre.offset = c(d$x[1], d$y[1]),
cellsize = c(diff(d$x[1:2]), diff(d$y[1:2])), cells.dim = dim(d$z))
grd.atts <- SpatialGridDataFrame(gt, data.frame(depth =
    as.vector(d$z[,ncol(d$z):1])))
image(grd.atts, axes=TRUE)


Ian McCallum wrote:
> Greetings,
>
> I am trying to export a matrix out to an arcinfo asciigrid.
> Write tables might work.
> Better is perhaps write.asciigrid or writeGDAL
> To do that however, i need to convert my matrix into a Spatial Grid.
>
> I came across a thread (from R. Bivand in 2006) that seems to address 
> what i need to do.
> However if i plug this into R, it fails. I run R 2.10.1 on win XP.
> Any ideas on why this is crashing, and how to export a matrix to 
> arcinfo asciigrid would be great.
>
> Thanks
> Ian
>
>
>  > library(sp)
>  > d <- list(x  =1:10, y = 22:31, z = matrix(1:100, 10, 10))
>  > image(d)
>  > gt <- GridTopology(cellcentre.offset = c(d$x[1], d$y[1]),
> +     cellsize = c(diff(d$x[1:2]), diff(d$y[1:2])), cells.dim = dim(d$z))
>  > grd.atts <- SpatialGridDataFrame(gt, list(depth =
> +     as.vector(d$z[,ncol(d$z):1])))
> Error in validObject(.Object) :
>    invalid class "SpatialGridDataFrame" object: invalid object for 
> slot "data" in class "SpatialGridDataFrame": got class "list", should 
> be or extend class "data.frame"
>  > image(grd.atts, axes=TRUE)
> Error in image(grd.atts, axes = TRUE) : object 'grd.atts' not found
>
>
>
>
>
>
> ___________________________________________
> Ian McCallum
> Forestry Program
> International Institute for Applied Systems Analysis
> Schlossplatz 1, A-2361 Laxenburg, Austria
> Phone: +43 2236 807-328
> Fax: +43 2236 807-599 or 71313
> E-mail: mccallum at iiasa.ac.at
> Web: http://www.iiasa.ac.at/Research/FOR/
> ___________________________________________
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Tue Jan 26 10:18:47 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Jan 2010 10:18:47 +0100 (CET)
Subject: [R-sig-Geo] R spatial matrix to SpatialGridDataFrame
In-Reply-To: <4B5EAD98.5060705@uni-muenster.de>
References: <201001260822.o0Q8MLNL000743@amazon.iiasa.ac.at>
	<4B5EAD98.5060705@uni-muenster.de>
Message-ID: <alpine.LRH.2.00.1001261006010.14416@reclus.nhh.no>

On Tue, 26 Jan 2010, Edzer Pebesma wrote:

> Something seems to have changed, since 2006 ... The following should work:

Specifically, when the data.frame class was changed in R in mid-2006 
(earlier, all data.frames had row.names as long and large character 
vectors), you switched the data= slot from our home-made AttributeList 
class to data.frame:

http://r-spatial.cvs.sourceforge.net/viewvc/r-spatial/sp/R/Class-SpatialGridDataFrame.R?r1=1.4&r2=1.5

change checked in 19 September. I'd forgotten about that, and it does 
point up the need when looking for tips in the mailing list archives to 
see whether the class definition now matches the one that held when the 
advice was given. Going through:

file.show(system.file("ChangeLog", package="sp"))

one can see the change, but it is seriously hard to check whether older 
advice is still relevant. Some is, some isn't, I'm afraid. The message 
that warns about that change is from 28 Sept. 2006:

http://n2.nabble.com/Please-read-before-upgrading-to-R-2-4-0-td2762640.html#a2762640

We do try to post such heads-up messages when appropriate, but archive 
searches on other keys will not locate them.

Does anyone want to add a timeline of class defintion changes to the wiki, 
so that archive tips can be checked?

Roger

>
> library(sp)
> d <- list(x  =1:10, y = 22:31, z = matrix(1:100, 10, 10))
> image(d)
> gt <- GridTopology(cellcentre.offset = c(d$x[1], d$y[1]),
> cellsize = c(diff(d$x[1:2]), diff(d$y[1:2])), cells.dim = dim(d$z))
> grd.atts <- SpatialGridDataFrame(gt, data.frame(depth =
>   as.vector(d$z[,ncol(d$z):1])))
> image(grd.atts, axes=TRUE)
>
>
> Ian McCallum wrote:
>> Greetings,
>> 
>> I am trying to export a matrix out to an arcinfo asciigrid.
>> Write tables might work.
>> Better is perhaps write.asciigrid or writeGDAL
>> To do that however, i need to convert my matrix into a Spatial Grid.
>> 
>> I came across a thread (from R. Bivand in 2006) that seems to address what 
>> i need to do.
>> However if i plug this into R, it fails. I run R 2.10.1 on win XP.
>> Any ideas on why this is crashing, and how to export a matrix to arcinfo 
>> asciigrid would be great.
>> 
>> Thanks
>> Ian
>> 
>>
>>  > library(sp)
>>  > d <- list(x  =1:10, y = 22:31, z = matrix(1:100, 10, 10))
>>  > image(d)
>>  > gt <- GridTopology(cellcentre.offset = c(d$x[1], d$y[1]),
>> +     cellsize = c(diff(d$x[1:2]), diff(d$y[1:2])), cells.dim = dim(d$z))
>>  > grd.atts <- SpatialGridDataFrame(gt, list(depth =
>> +     as.vector(d$z[,ncol(d$z):1])))
>> Error in validObject(.Object) :
>>    invalid class "SpatialGridDataFrame" object: invalid object for slot 
>> "data" in class "SpatialGridDataFrame": got class "list", should be or 
>> extend class "data.frame"
>>  > image(grd.atts, axes=TRUE)
>> Error in image(grd.atts, axes = TRUE) : object 'grd.atts' not found
>> 
>> 
>> 
>> 
>> 
>> 
>> ___________________________________________
>> Ian McCallum
>> Forestry Program
>> International Institute for Applied Systems Analysis
>> Schlossplatz 1, A-2361 Laxenburg, Austria
>> Phone: +43 2236 807-328
>> Fax: +43 2236 807-599 or 71313
>> E-mail: mccallum at iiasa.ac.at
>> Web: http://www.iiasa.ac.at/Research/FOR/
>> ___________________________________________
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rhurlin at gwdg.de  Tue Jan 26 11:57:27 2010
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue, 26 Jan 2010 11:57:27 +0100
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <alpine.LRH.2.00.1001252212570.4666@reclus.nhh.no>
References: <4B5E076F.7@gwdg.de>
	<alpine.LRH.2.00.1001252212570.4666@reclus.nhh.no>
Message-ID: <4B5ECA97.5020802@gwdg.de>

Am 25.01.2010 22:35 (UTC+1) schrieb Roger Bivand:
> On Mon, 25 Jan 2010, Rainer Hurling wrote:
>
>> Some days ago Brian Ripley and Uwe Ligges announced an update to
>> MinGW-w64 builds for 64-bit Windows on R-devel at . This daily version
>> works really nice. But it is not fully applicable at this time because
>> of some missing packages.
>>
>> I am in particular interested in a 64-bit version of rgdal, which
>> depends on a 64-bit version of gdal(.dll). Is their anything known
>> about what is planned with this important part of spatial software?
>
> For this, a 64-bit MSYS is required. If someone who has a 64-bit Windows
> system can take the initiative on this, I would be very grateful - I
> have no access to any such system. Brian Ripley and Uwe Ligges have been
> in touch with me on this, and so far have put it aside until packages
> without external dependencies are done. It really does depend on our
> community building PROJ.4, EXPAT, and GDAL from source under 64-bit MSYS
> on a Windows 64-bit system using the same build train as other w64
> packages, if we want it done.

Thanks, Roger and Edzer for answering.

I know of this procedure. I was only interested if there is something 
known about purposes of these projects (like a timeline or testing 
prereleases) so that the R community can build a 64-bit rgdal version in 
the near future.

I am only working with FreeBSD. Our staff members mostly use Windows, 
increasingly the 64-bit versions. I am asking for that people. 
Unfortunately we are not able to build our 64-bit windows versions for 
ourselves (administrated windows machines).

Rainer


From rhurlin at gwdg.de  Tue Jan 26 12:01:45 2010
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue, 26 Jan 2010 12:01:45 +0100
Subject: [R-sig-Geo] rgdal 64bit Windows version?
In-Reply-To: <522664f81001251325hc4b2bd5y6389af5aa75c6855@mail.gmail.com>
References: <4B5E076F.7@gwdg.de>
	<522664f81001251325hc4b2bd5y6389af5aa75c6855@mail.gmail.com>
Message-ID: <4B5ECB99.4040602@gwdg.de>

Am 25.01.2010 22:25 (UTC+1) schrieb Michael Sumner:
> I suspect you'll need to build GDAL for yourself and then build rgdal
> on top of that, since rgdal depends upon a pre-installation of GDAL.
> The gdal-dev list is the appropriate place for discussing the first
> step.
>
> Colleagues have succesfully built 64-bit Windows GDAL from the 1.6.0
> release using extra binaries (HDF4/5, NetCDF, etc.) from here:
> http://vbkto.dyndns.org:1280/sdk/Default.aspx

Thanks, Michael, for this interesting link.

Unfortunately we are not able to build our own versions on windows 
machines because of administrative reasons. I will have a look at it in 
my spare time ;-)

Rainer

> There are notes on build rgdal for Windows here, but I've not done it
> myself for a while:
>
> file.show(system.file("README.windows", package="rgdal"))
>
> I am keen to try this for myself, but it will not be for a while yet.
>
> Best regards,
> Mike
>
> On Tue, Jan 26, 2010 at 8:04 AM, Rainer Hurling<rhurlin at gwdg.de>  wrote:
>> Some days ago Brian Ripley and Uwe Ligges announced an update to MinGW-w64
>> builds for 64-bit Windows on R-devel at . This daily version works really nice.
>> But it is not fully applicable at this time because of some missing
>> packages.
>>
>> I am in particular interested in a 64-bit version of rgdal, which depends on
>> a 64-bit version of gdal(.dll). Is their anything known about what is
>> planned with this important part of spatial software?


From Roger.Bivand at nhh.no  Tue Jan 26 13:54:27 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Jan 2010 13:54:27 +0100 (CET)
Subject: [R-sig-Geo] points to lines and/or polygons
In-Reply-To: <f96702321001252345w7ada52bp6152392d0c1f280a@mail.gmail.com>
References: <f96702321001252345w7ada52bp6152392d0c1f280a@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001261350580.14929@reclus.nhh.no>

On Tue, 26 Jan 2010, Agustin Lobo wrote:

> Hi!
> Package StatDA
> provides background geoinformation as a set of coordinates:
>> str(kola.background)
> List of 4
> $ boundary:'data.frame':       50 obs. of  2 variables:
>  ..$ V1: num [1:50] 388650 388160 386587 384035 383029 ...
>  ..$ V2: num [1:50] 7892400 7881248 7847303 7790797 7769214 ...
> $ coast   :'data.frame':       6259 obs. of  2 variables:
>  ..$ V1: num [1:6259] 438431 439102 439102 439643 439643 ...
>  ..$ V2: num [1:6259] 7895619 7896495 7896495 7895800 7895542 ...
> $ borders :'data.frame':       504 obs. of  2 variables:
>  ..$ V1: num [1:504] 417575 417704 418890 420308 422731 ...
>  ..$ V2: num [1:504] 7612984 7612984 7613293 7614530 7615972 ...
> $ lakes   :'data.frame':       6003 obs. of  2 variables:
>  ..$ V1: num [1:6003] 547972 546915 NA 547972 547172 ...
>  ..$ V2: num [1:6003] 7815109 7815599 NA 7815109 7813873 ...
>
> is there any spatial function aready availale to convert these coordinates
> into Spatial Lines and Spatial Polygons?

This seems to work at least for SpatialLines - for polygons, the rings may 
need to be closed:

library(StatDA)
data(kola.background)
xy <- kola.background$boundary
names(xy) <- c("x", "y")
library(maptools)
bdy <- map2SpatialLines(xy)
plot(bdy)

The data are in the legacy S format (like the maps package).

Roger


>
> Thanks
>
> Agus
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Tue Jan 26 16:02:27 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Tue, 26 Jan 2010 16:02:27 +0100
Subject: [R-sig-Geo] Distance to (nearest) polygon
Message-ID: <MPG.25c9226ee5625bb49896d3@news.gmane.org>

Dear list members

Is there an easy and preferably fast way to measure the distance from a  
of (large) number of points to the nearest polygon? spDistsN1 seems to 
only want to measure the distance between points.

For example, I need the distance between points at sea to the nearest 
land area (as defined by for example the 'world' dataset).

It's not very important which polygon, e.g., country, the given distance 
is to. It would be nice if the 'distance' from points that are inside 
the polygons were zero or negative, but it's not required -- distance to 
the polygon border, e.g., shoreline, would be OK.

-- 
Karl Ove Hufthammer


From Roger.Bivand at nhh.no  Tue Jan 26 16:27:23 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Jan 2010 16:27:23 +0100 (CET)
Subject: [R-sig-Geo] Distance to (nearest) polygon
In-Reply-To: <MPG.25c9226ee5625bb49896d3@news.gmane.org>
References: <MPG.25c9226ee5625bb49896d3@news.gmane.org>
Message-ID: <alpine.LRH.2.00.1001261625260.17754@reclus.nhh.no>

On Tue, 26 Jan 2010, Karl Ove Hufthammer wrote:

> Dear list members
>
> Is there an easy and preferably fast way to measure the distance from a
> of (large) number of points to the nearest polygon? spDistsN1 seems to
> only want to measure the distance between points.
>
> For example, I need the distance between points at sea to the nearest
> land area (as defined by for example the 'world' dataset).
>
> It's not very important which polygon, e.g., country, the given distance
> is to. It would be nice if the 'distance' from points that are inside
> the polygons were zero or negative, but it's not required -- distance to
> the polygon border, e.g., shoreline, would be OK.

There are methods for point to line segment distances in spatstat. 
Further, for projected (planar) coordinates, this could be added to 
R-Forge rgeos; for geographical coordinates Boost ggl would be needed.

Roger

>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From els.verfaillie at ugent.be  Tue Jan 26 17:00:29 2010
From: els.verfaillie at ugent.be (Els Verfaillie)
Date: Tue, 26 Jan 2010 17:00:29 +0100
Subject: [R-sig-Geo] maxdist for kriging with an external drift
Message-ID: <005d01ca9ea0$aed17900$0c746b00$@verfaillie@ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/2092e27d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 26 17:05:03 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Jan 2010 17:05:03 +0100
Subject: [R-sig-Geo] maxdist for kriging with an external drift
In-Reply-To: <005d01ca9ea0$aed17900$0c746b00$@verfaillie@ugent.be>
References: <005d01ca9ea0$aed17900$0c746b00$@verfaillie@ugent.be>
Message-ID: <4B5F12AF.5070302@uni-muenster.de>

Yes, that is right.

Els Verfaillie wrote:
> Dear list,
>
>  
>
> I want to use Kriging with an external drift for a sedimentological dataset
> of grain-size that has a linear relation with the depth. 
>
> Am I correct that when I set a 'maxdist' using the krige command, that a
> trend for the primary variable (grain-size) is calculated as a local linear
> function of the secondary variable (depth)? Is this function thus different
> for each interpolation window? 
>
>  
>
> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>
>  
>
> Thank you for your help.
>
>  
>
> Best regards,
>
> Els Verfaillie
>
>  
>
> ______________________________________________
>
> Dr. Els Verfaillie
>
> Carto-GIS cluster
>
> Ghent University (UGent) - Department of Geography
>
> ______________________________________________
>
>  
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From cutberto.paredes at gmail.com  Tue Jan 26 17:45:00 2010
From: cutberto.paredes at gmail.com (=?ISO-8859-1?Q?Cutberto_Uriel_Paredes_Hern=E1ndez?=)
Date: Tue, 26 Jan 2010 16:45:00 +0000
Subject: [R-sig-Geo] maxdist for kriging with an external drift
In-Reply-To: <4B5F12AF.5070302@uni-muenster.de>
References: <4B5F12AF.5070302@uni-muenster.de>
Message-ID: <8f1fabf91001260845n632ad13ek418a695e27110de8@mail.gmail.com>

Dear Edzer,

Would it be correct to say then that if a neighbourhood is specified
in the krige command the result would be that of Kriging with an
External Drift (KED), otherwise it would be that of Simple Kriging
with varying local means (SKlm)?

Apologies for posting on this thread but I was about to post a
similiar question.

Thanks, Cutberto.

2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> Yes, that is right.
>
> Els Verfaillie wrote:
>>
>> Dear list,
>>
>>
>> I want to use Kriging with an external drift for a sedimentological
>> dataset
>> of grain-size that has a linear relation with the depth.
>> Am I correct that when I set a 'maxdist' using the krige command, that a
>> trend for the primary variable (grain-size) is calculated as a local
>> linear
>> function of the secondary variable (depth)? Is this function thus
>> different
>> for each interpolation window?
>>
>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>
>>
>> Thank you for your help.
>>
>>
>> Best regards,
>>
>> Els Verfaillie
>>
>>
>> ______________________________________________
>>
>> Dr. Els Verfaillie
>>
>> Carto-GIS cluster
>>
>> Ghent University (UGent) - Department of Geography
>>
>> ______________________________________________
>>
>>
>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
> ?http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
> ?e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.aluizio at gmail.com  Tue Jan 26 18:02:40 2010
From: r.aluizio at gmail.com (Rodrigo Aluizio)
Date: Tue, 26 Jan 2010 15:02:40 -0200
Subject: [R-sig-Geo] Edit a Sptial Lines Object
Message-ID: <4b5f2052.9c15f10a.7b9d.0861@mx.google.com>

Hi list, I?m trying to insert some coordinates at the end of an object
(attached) component (BP[1]).

But I?m not able to do so. I can?t isolate the coordinates, if I use the
?@lines? it turns into a list, but I need to keep the SpatialLines and S4
structure, then I will be able to transform the closed lines into polygons.

So, How can I insert the coordinates that will close the BP[1] line into
this object without changing the object properties. Any Ideas?

Thank you in advance.

 

-------------------------------------------------------------

MSc.  <mailto:r.aluizio at gmail.com> Rodrigo Aluizio

Centro de Estudos do Mar/UFPR
Laborat?rio de Micropaleontologia
Avenida Beira Mar s/n - CEP 83255-000
Pontal do Paran? - PR - Brasil
Fone: (41) 3511-8657

Fax: (41) 3455-3623



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/63ec934e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: BP.Rdata
Type: application/octet-stream
Size: 39731 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/63ec934e/attachment.obj>

From edzer.pebesma at uni-muenster.de  Tue Jan 26 21:11:47 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Jan 2010 21:11:47 +0100
Subject: [R-sig-Geo] maxdist for kriging with an external drift
In-Reply-To: <8f1fabf91001260845n632ad13ek418a695e27110de8@mail.gmail.com>
References: <4B5F12AF.5070302@uni-muenster.de>
	<8f1fabf91001260845n632ad13ek418a695e27110de8@mail.gmail.com>
Message-ID: <4B5F4C83.7040808@uni-muenster.de>

Oh, geostatistics and its funny naming conventions!

I see local models vs. global models as a completely different modelling 
aspect (model decision, basically) then the SK/OK/UK differences. When 
building on the same tradition / body of literature you quote: in that 
case KED would be a special form of UK, having only a single 
non-coordinate predictor called 'external drift'.

In my eyes (and that of the literature with more mathematical 
statistical grounding, such as Cressie 1993 and others), the difference 
between SK on the one hand and OK/UK on the other is that SK assumes 
that you know the mean or mean structure. SKlm is then residual kriging 
added to a known mean function.

In the gstat R package you obtain SK by specifying a beta value (for the 
mean); SKlm by specifying one or more predictors and passing the (known) 
regression coefficients as beta; you obtain OK/UK by not specifying 
beta; a formula ending on ~1 results in OK with an unknown mean only.

Ah, and then SK = simple kriging, OK = ordinary kriging, UK = universal 
kriging.
--
Edzer

Cutberto Uriel Paredes Hern?ndez wrote:
> Dear Edzer,
>
> Would it be correct to say then that if a neighbourhood is specified
> in the krige command the result would be that of Kriging with an
> External Drift (KED), otherwise it would be that of Simple Kriging
> with varying local means (SKlm)?
>
> Apologies for posting on this thread but I was about to post a
> similiar question.
>
> Thanks, Cutberto.
>
> 2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>   
>> Yes, that is right.
>>
>> Els Verfaillie wrote:
>>     
>>> Dear list,
>>>
>>>
>>> I want to use Kriging with an external drift for a sedimentological
>>> dataset
>>> of grain-size that has a linear relation with the depth.
>>> Am I correct that when I set a 'maxdist' using the krige command, that a
>>> trend for the primary variable (grain-size) is calculated as a local
>>> linear
>>> function of the secondary variable (depth)? Is this function thus
>>> different
>>> for each interpolation window?
>>>
>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>
>>>
>>> Thank you for your help.
>>>
>>>
>>> Best regards,
>>>
>>> Els Verfaillie
>>>
>>>
>>> ______________________________________________
>>>
>>> Dr. Els Verfaillie
>>>
>>> Carto-GIS cluster
>>>
>>> Ghent University (UGent) - Department of Geography
>>>
>>> ______________________________________________
>>>
>>>
>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>       
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
>>  http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>  e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From paulojus at c3sl.ufpr.br  Tue Jan 26 21:31:00 2010
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Tue, 26 Jan 2010 18:31:00 -0200 (BRST)
Subject: [R-sig-Geo] maxdist for kriging with an external drift
In-Reply-To: <4B5F4C83.7040808@uni-muenster.de>
References: <4B5F12AF.5070302@uni-muenster.de>
	<8f1fabf91001260845n632ad13ek418a695e27110de8@mail.gmail.com>
	<4B5F4C83.7040808@uni-muenster.de>
Message-ID: <alpine.DEB.1.10.1001261822570.28905@dalmore.c3sl.ufpr.br>

May be worth adding here that, despite algorithms and the
"funny naming conventions" (good descrition Edzer!)
SK and others are diferent in the following way:

SK, as described in Edzer post, assumes you **know** the mean, in other 
words, there is no uncertainty about it.
On the other hand, variants such as OK, UK, KED, SKlm uses (explicitly 
or implicitly) estimated means.
Therefore, such uncertainty has to be propagated and reflected in the 
predictions.

Suposse the fixed mean in SK is the same as the (implicitly) estimated by 
OK. The point predictions will be the same, however, the uncertainty 
around them will not (and should not) refleting  the uncertainty (or lack 
of it) in the process mean.
The prediction variance expressions for SK ond OK will reflect this
whatever the kriging neighborhood is used.

best
P.J.

On Tue, 26 Jan 2010, Edzer Pebesma wrote:

> Oh, geostatistics and its funny naming conventions!
>
> I see local models vs. global models as a completely different modelling 
> aspect (model decision, basically) then the SK/OK/UK differences. When 
> building on the same tradition / body of literature you quote: in that case 
> KED would be a special form of UK, having only a single non-coordinate 
> predictor called 'external drift'.
>
> In my eyes (and that of the literature with more mathematical statistical 
> grounding, such as Cressie 1993 and others), the difference between SK on the 
> one hand and OK/UK on the other is that SK assumes that you know the mean or 
> mean structure. SKlm is then residual kriging added to a known mean function.
>
> In the gstat R package you obtain SK by specifying a beta value (for the 
> mean); SKlm by specifying one or more predictors and passing the (known) 
> regression coefficients as beta; you obtain OK/UK by not specifying beta; a 
> formula ending on ~1 results in OK with an unknown mean only.
>
> Ah, and then SK = simple kriging, OK = ordinary kriging, UK = universal 
> kriging.
> --
> Edzer
>
> Cutberto Uriel Paredes Hern?ndez wrote:
>> Dear Edzer,
>> 
>> Would it be correct to say then that if a neighbourhood is specified
>> in the krige command the result would be that of Kriging with an
>> External Drift (KED), otherwise it would be that of Simple Kriging
>> with varying local means (SKlm)?
>> 
>> Apologies for posting on this thread but I was about to post a
>> similiar question.
>> 
>> Thanks, Cutberto.
>> 
>> 2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>> 
>>> Yes, that is right.
>>> 
>>> Els Verfaillie wrote:
>>> 
>>>> Dear list,
>>>> 
>>>> 
>>>> I want to use Kriging with an external drift for a sedimentological
>>>> dataset
>>>> of grain-size that has a linear relation with the depth.
>>>> Am I correct that when I set a 'maxdist' using the krige command, that a
>>>> trend for the primary variable (grain-size) is calculated as a local
>>>> linear
>>>> function of the secondary variable (depth)? Is this function thus
>>>> different
>>>> for each interpolation window?
>>>> 
>>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>> 
>>>> 
>>>> Thank you for your help.
>>>> 
>>>> 
>>>> Best regards,
>>>> 
>>>> Els Verfaillie
>>>> 
>>>> 
>>>> ______________________________________________
>>>> 
>>>> Dr. Els Verfaillie
>>>> 
>>>> Carto-GIS cluster
>>>> 
>>>> Ghent University (UGent) - Department of Geography
>>>> 
>>>> ______________________________________________
>>>> 
>>>> 
>>>> 
>>>>
>>>>        [[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> 
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e
>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763
>>>  http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>>  e.pebesma at wwu.de
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> 
>
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e 
> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763 
> http://ifgi.uni-muenster.de http://www.52north.org/geostatistics 
> e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus



From rusers.sh at gmail.com  Wed Jan 27 04:53:15 2010
From: rusers.sh at gmail.com (rusers.sh)
Date: Tue, 26 Jan 2010 22:53:15 -0500
Subject: [R-sig-Geo] Convert grids with 0/1 attribute to polygons with
	neighbor grids of same values merged
Message-ID: <a835c81e1001261953w69656b0cg3400793f92a4a412@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/8b6bca67/attachment.pl>

From rusers.sh at gmail.com  Wed Jan 27 05:26:18 2010
From: rusers.sh at gmail.com (rusers.sh)
Date: Tue, 26 Jan 2010 23:26:18 -0500
Subject: [R-sig-Geo] complement part of a polygon in another polygon
Message-ID: <a835c81e1001262026ub45a630v8bad1297a756771b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/bbc43f28/attachment.pl>

From martin.renner at stonebow.otago.ac.nz  Wed Jan 27 09:06:41 2010
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Tue, 26 Jan 2010 23:06:41 -0900
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
Message-ID: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>

Hi All,

I want to kirg fish and seabird densities within an estuary which has several arms. Since neither organisms cross land, the appropriate distances would not be euclidian but over-water (as fish swim). There are several papers, describing this problem and how to deal with it (see below), but I have not found an easily accessible implementation. Is anybody aware of a solution in R?

Best,
Martin



@article{Rathbun:1998aa,
	Author = {Rathbun, Stephen L.},
	Journal = {Environmetrics},
	Number = {2},
	Pages = {109--129},
	Title = {Spatial modelling in irregularly shaped regions: kriging estuaries},
	Volume = {9},
	Year = {1998}}

@article{Little:1997aa,
	Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne E.},
	Journal = {Journal of Experimental Marine Biology and Ecology},
	Number = {1},
	Pages = {1--11},
	Title = {Kriging in estuaries: as the crow flies, or as the fish swims?},
	Volume = {213},
	Year = {1997}}




Martin Renner				
US Geological Survey			
Alaska Science Center			


From karl at huftis.org  Wed Jan 27 10:17:12 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 27 Jan 2010 10:17:12 +0100
Subject: [R-sig-Geo] Distance to (nearest) polygon
References: <MPG.25c9226ee5625bb49896d3@news.gmane.org>
	<alpine.LRH.2.00.1001261625260.17754@reclus.nhh.no>
Message-ID: <MPG.25ca23071e15ccd89896d4@news.gmane.org>

On Tue, 26 Jan 2010 16:27:23 +0100 (CET) Roger Bivand 
<Roger.Bivand at nhh.no> wrote:

>> For example, I need the distance between points at sea to the nearest
>> land area (as defined by for example the 'world' dataset).
> 
> There are methods for point to line segment distances in spatstat. 
> Further, for projected (planar) coordinates, this could be added to 
> R-Forge rgeos; for geographical coordinates Boost ggl would be needed.
 
Thanks. The 'nncross' function in 'spatstat' does essentially do what I 
need. Unfortunately, I work with geographical coordinates (spanning 
about 15 degrees of latitude), so the results are not perfect (using 
plain long/lat coordinates), but they will probably be an adequate 
approximation.

BTW, for my application, I'm not interested in the distance per se, only 
in the points (e.g., boats) within a certain distance from the polygon 
(land). So I have also thought about a possible solution of using an 
expanded polygon, expanded in a certain number of kilometers outwards, 
and then using point-in-polygon (i.e., 'overlay') to find the points 
that are inside this new polygon. But I couldn't find a function to 
'grow' a polygon in this way.

-- 
Karl Ove Hufthammer


From mdsumner at gmail.com  Wed Jan 27 10:29:15 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 27 Jan 2010 20:29:15 +1100
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
Message-ID: <522664f81001270129g2a80ea2n62e8e6c3442fc7e@mail.gmail.com>

Not kriging as such, but check out the soap-film smoothing in package mgcv:

http://www.maths.bath.ac.uk/~sw283/simon/papers/soap.pdf

FWIW, there are binning methods with MCMC in the package
tripEstimation that have similar features, but they are particularly
focussed on individual track estimation and probably not easily
applied. Is location uncertainty a big issue for your data? What are
the input locations?

Cheers, Mike.


On Wed, Jan 27, 2010 at 7:06 PM, Martin Renner
<martin.renner at stonebow.otago.ac.nz> wrote:
> Hi All,
>
> I want to kirg fish and seabird densities within an estuary which has several arms. Since neither organisms cross land, the appropriate distances would not be euclidian but over-water (as fish swim). There are several papers, describing this problem and how to deal with it (see below), but I have not found an easily accessible implementation. Is anybody aware of a solution in R?
>
> Best,
> Martin
>
>
>
> @article{Rathbun:1998aa,
> ? ? ? ?Author = {Rathbun, Stephen L.},
> ? ? ? ?Journal = {Environmetrics},
> ? ? ? ?Number = {2},
> ? ? ? ?Pages = {109--129},
> ? ? ? ?Title = {Spatial modelling in irregularly shaped regions: kriging estuaries},
> ? ? ? ?Volume = {9},
> ? ? ? ?Year = {1998}}
>
> @article{Little:1997aa,
> ? ? ? ?Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne E.},
> ? ? ? ?Journal = {Journal of Experimental Marine Biology and Ecology},
> ? ? ? ?Number = {1},
> ? ? ? ?Pages = {1--11},
> ? ? ? ?Title = {Kriging in estuaries: as the crow flies, or as the fish swims?},
> ? ? ? ?Volume = {213},
> ? ? ? ?Year = {1997}}
>
>
>
>
> Martin Renner
> US Geological Survey
> Alaska Science Center
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Adrian.Baddeley at csiro.au  Wed Jan 27 12:20:42 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Wed, 27 Jan 2010 19:20:42 +0800
Subject: [R-sig-Geo]  Enlarge figure in spatstat
Message-ID: <57DC18C299094D4299F837570C5DF1C52B0C2F69E7@EXWA-MBX01.nexus.csiro.au>

Ervan Rutishauser ervan.rutishauser at cirad.fr<mailto:ervan.rutishauser at cirad.fr> writes:

> I wonder how to resize a figure in spatstat, as it currently appears with large
> margins (useless for me). I would like to enlarge my figure at maximum in
> the windows and optionally add some legend...



The plot commands in 'spatstat' call the basic R graphics package.

Use the graphics parameters in par() to control them.

To reduce margin size, use the parameters 'mar' and 'oma' in par()



To remove the maximum possible space outside the plot area,

      oldpar <- par(mar=rep(0,4), oma=rep(0,4))

      plot(X, main="")

      par(oldpar)

where 'X' is a spatstat object.



Many of the plots in spatstat use equal scales on the x and y axes, so if the object to be plotted does not have the same aspect ratio (height over width) as the plottable region, there will inevitably be some blank space. You can visualise this by re-sizing a graphics window to different shapes.



For plotting to a postscript file (etc) you would need to call postscript() with the arguments 'width' and 'height' set to appropriate values so that the plottable region has the same aspect ratio as the object. One way to do this automatically:



                         B <- as.rectangle(X)

                         R <- with(B, diff(yrange)/diff(xrange))

                         w <- 6

                         h <- round(R * w, 1)

                         postscript("X.eps", horizontal=FALSE, width=w, height=h)

                         ...





Adrian Baddeley

---


From alobolistas at gmail.com  Wed Jan 27 13:28:40 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 27 Jan 2010 13:28:40 +0100
Subject: [R-sig-Geo] points to lines and/or polygons
In-Reply-To: <alpine.LRH.2.00.1001261350580.14929@reclus.nhh.no>
References: <f96702321001252345w7ada52bp6152392d0c1f280a@mail.gmail.com>
	<alpine.LRH.2.00.1001261350580.14929@reclus.nhh.no>
Message-ID: <f96702321001270428j749da0ear4e680baf715e8650@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100127/c03ef64b/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jan 27 13:46:58 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Jan 2010 13:46:58 +0100 (CET)
Subject: [R-sig-Geo] points to lines and/or polygons
In-Reply-To: <f96702321001270428j749da0ear4e680baf715e8650@mail.gmail.com>
References: <f96702321001252345w7ada52bp6152392d0c1f280a@mail.gmail.com>
	<alpine.LRH.2.00.1001261350580.14929@reclus.nhh.no>
	<f96702321001270428j749da0ear4e680baf715e8650@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001271340520.24097@reclus.nhh.no>

On Wed, 27 Jan 2010, Agustin Lobo wrote:

> Thanks, one clarification:
> If I do:
>> data(kola.background)
>> xy <- kola.background$coast
>> names(xy) <- c("x", "y")
>> class(xy)
> [1] "data.frame"
>
> How is it that I can run successfully:
> coast <- map2SpatialLines(xy)
>
> if the help page states that the argument must be of "map" class?:
> map2SpatialLines(map, IDs=NULL, proj4string = CRS(as.character(NA)))
> Arguments
> mapa map object defined in the maps package and returned by the map function
> ?

The maps package is the main (geographical) source using the legacy S 
format, where lines (or polygons) are separated by NA rows in a two-column 
matrix. This is described in ?lines. Think of the simplest format for a 
pen plotter, where NA picks up the pen. As the format is used by other 
sources (including base graphics), the function doesn't check that the 
class is "map", but converting from this class is its main use.

Roger

>
> Also,
>> str(coast,max.level=2)
> Formal class 'SpatialLines' [package "sp"] with 3 slots
>  ..@ lines      :List of 142
>  ..@ bbox       : num [1:2, 1:2] 378389 7388684 865816 7900281
>  .. ..- attr(*, "dimnames")=List of 2
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>
> which is the criteria by which  map2SpatialLines() starts a new line?
>
> Just in case anybody might be curious, after doing what you suggested, I do
> the following to save as shape:
> require(rgdal)
> str(coast,max.level=2) #from which I know there are 142 Lines
> coastdata <- data.frame(ID=1:142,name=rep("",142),stringsAsFactors=F)
> row.names(coastdata) <- 1:142
> coast <- SpatialLinesDataFrame(sl=coast, data=coastdata, match.ID = TRUE)
> writeOGR(coast,dsn="Kolacoast",layer="Kolacoasts",driver="ESRI Shapefile")
>
> Agus
>
> 2010/1/26 Roger Bivand <Roger.Bivand at nhh.no>
>
>> On Tue, 26 Jan 2010, Agustin Lobo wrote:
>>
>>  Hi!
>>> Package StatDA
>>> provides background geoinformation as a set of coordinates:
>>>
>>>> str(kola.background)
>>>>
>>> List of 4
>>> $ boundary:'data.frame':       50 obs. of  2 variables:
>>>  ..$ V1: num [1:50] 388650 388160 386587 384035 383029 ...
>>>  ..$ V2: num [1:50] 7892400 7881248 7847303 7790797 7769214 ...
>>> $ coast   :'data.frame':       6259 obs. of  2 variables:
>>>  ..$ V1: num [1:6259] 438431 439102 439102 439643 439643 ...
>>>  ..$ V2: num [1:6259] 7895619 7896495 7896495 7895800 7895542 ...
>>> $ borders :'data.frame':       504 obs. of  2 variables:
>>>  ..$ V1: num [1:504] 417575 417704 418890 420308 422731 ...
>>>  ..$ V2: num [1:504] 7612984 7612984 7613293 7614530 7615972 ...
>>> $ lakes   :'data.frame':       6003 obs. of  2 variables:
>>>  ..$ V1: num [1:6003] 547972 546915 NA 547972 547172 ...
>>>  ..$ V2: num [1:6003] 7815109 7815599 NA 7815109 7813873 ...
>>>
>>> is there any spatial function aready availale to convert these coordinates
>>> into Spatial Lines and Spatial Polygons?
>>>
>>
>> This seems to work at least for SpatialLines - for polygons, the rings may
>> need to be closed:
>>
>> library(StatDA)
>> data(kola.background)
>> xy <- kola.background$boundary
>> names(xy) <- c("x", "y")
>> library(maptools)
>> bdy <- map2SpatialLines(xy)
>> plot(bdy)
>>
>> The data are in the legacy S format (like the maps package).
>>
>> Roger
>>
>>
>>
>>> Thanks
>>>
>>> Agus
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From roland.kaiser at sbg.ac.at  Wed Jan 27 16:51:26 2010
From: roland.kaiser at sbg.ac.at (Roland Kaiser)
Date: Wed, 27 Jan 2010 16:51:26 +0100
Subject: [R-sig-Geo] [R-sig-eco] scatter plot of coordinates
In-Reply-To: <4D405B4872E4E54A95966E6CF909E7F325F0231E09@anton>
References: <4D405B4872E4E54A95966E6CF909E7F325F0231E09@anton>
Message-ID: <3616ABD0-39CE-4573-8484-6B423949891F@sbg.ac.at>

Julia,

my preferred way of plotting spatial data
is to use spatial classes as provided by package(sp).

library(sp)
library(maps)

pts <- data.frame(lng = seq(10,15,1),
		lat = seq(45,50,1),
		date = seq(2000,2005,1))

#	coerce to class SpatialPointsDataFrame		
coordinates(pts) <- ~lng+lat

#	attribute date is stored in slot data
slot(pts, "data") # equivalent to pts at data

map(xlim = c(8,17), ylim = c(43,52))
points(df)
text(df, labels = df at data$date)

Cheers,

Rolond

> Hello!
> I have a dataset with the date and positions -  Lat and Long columns
> How do I make a scatter  plot?
> Do I have to cbind the Lat and Long columns?
> Any suggestions will be much appreciated!
> Thank you
> Julia
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology


From alobolistas at gmail.com  Wed Jan 27 18:27:19 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 27 Jan 2010 18:27:19 +0100
Subject: [R-sig-Geo] coordinates() of SpatialLines DF
Message-ID: <f96702321001270927i702d145ekd608100ff2f1a13e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100127/bb87a6cc/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jan 27 19:46:21 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Jan 2010 19:46:21 +0100 (CET)
Subject: [R-sig-Geo] coordinates() of SpatialLines DF
In-Reply-To: <f96702321001270927i702d145ekd608100ff2f1a13e@mail.gmail.com>
References: <f96702321001270927i702d145ekd608100ff2f1a13e@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001271932110.25048@reclus.nhh.no>

On Wed, 27 Jan 2010, Agustin Lobo wrote:

> HI,
>
> I'm confused by the following:
>> xter <-
> readOGR(dsn="/media/Transcend/PROVI/MARICEL2/x_terRiverBasin",layer="x_ter")
>> class(xter)
> [1] "SpatialLinesDataFrame"
> attr(,"package")
> [1] "sp"
>> delme <- coordinates(xter)
>> class(delme)
> [1] "list"
>
> The manual page of coordinates states:
> Value
> usually an object of class SpatialPointsDataFrame; if the coordinates set
> cover the full set of variables in object, an object of class SpatialPoints
> is returned
>
> why don't I get a SpatialPointsDataFrame?

Because "usually" you do get a SpatialPointsDataFrame from coordinates<- 
(set) on a data.frame. coordinates (get) is a matrix for SpatialPoints* 
and the classes that inherit (SpatialPixels*, SpatialGrids* - cell 
centres), and for SpatialPolygons* - label points.

See for the extraction method:

getMethod("coordinates", "Line")
getMethod("coordinates", "Lines")
getMethod("coordinates", "SpatialLines")

to see what is happening in this case - you get a list of lists of 
coordinate matrices. Using the Norwegian coastline from maptools:

library(maptools)
library(maps)
nor_coast_lines <- map("world", interior=FALSE, plot=FALSE, xlim=c(4,32),
   ylim=c(58,72))
nor_coast_lines <- pruneMap(nor_coast_lines, xlim=c(4,32), ylim=c(58,72))
nor_coast_lines_sp <- map2SpatialLines(nor_coast_lines,
   proj4string=CRS("+proj=longlat +datum=wgs84"))
plot(nor_coast_lines_sp, axes=TRUE)
crdl0 <- coordinates(nor_coast_lines_sp)
crdl1 <- sapply(crdl0, function(x) do.call("rbind", x))
crdl2 <- do.call("rbind", crdl1)
lines(crdl2[chull(crdl2),], type="l", col="red")

using do.call() of "rbind" to stack the coordinate matrices.

Roger


>
> Anyway, is there any way to get object "delme" to become a 2 col. data frame
> or matrix? What I want is the cloud of points
> to calculate the convex hull and get an estimate of the polygon of the
> basin.
>
> Thanks
>
> Agus
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Wed Jan 27 20:32:33 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 27 Jan 2010 11:32:33 -0800
Subject: [R-sig-Geo] Distance to (nearest) polygon
In-Reply-To: <MPG.25ca23071e15ccd89896d4@news.gmane.org>
References: <MPG.25c9226ee5625bb49896d3@news.gmane.org>
	<alpine.LRH.2.00.1001261625260.17754@reclus.nhh.no>
	<MPG.25ca23071e15ccd89896d4@news.gmane.org>
Message-ID: <dc22b2571001271132r1fcd88b3y37e277bc2d2ef282@mail.gmail.com>

if you have a high precision coast line relative to the distances you
want to estimate, you could compute the distance of each point to the
nearest node of your coast line.
Here illustrated with a quick hack example based on what Roger just
send in response to Agus:

library(raster) # to get the data
fra = getData('GADM', country='FRA', level=0)
fra = as(fra, 'SpatialLines')
crd <- coordinates(fra)
crd <- sapply(crd, function(x) do.call("rbind", x))
# returns a vector, not sure why, but this fixes it
crd <- matrix(crd, ncol=2)
# plot(crd, cex=0.1)
min(pointDistance(c(-5,46), crd, type='GreatCircle'))

Robert


On Wed, Jan 27, 2010 at 1:17 AM, Karl Ove Hufthammer <karl at huftis.org> wrote:
> On Tue, 26 Jan 2010 16:27:23 +0100 (CET) Roger Bivand
> <Roger.Bivand at nhh.no> wrote:
>
>>> For example, I need the distance between points at sea to the nearest
>>> land area (as defined by for example the 'world' dataset).
>>
>> There are methods for point to line segment distances in spatstat.
>> Further, for projected (planar) coordinates, this could be added to
>> R-Forge rgeos; for geographical coordinates Boost ggl would be needed.
>
> Thanks. The 'nncross' function in 'spatstat' does essentially do what I
> need. Unfortunately, I work with geographical coordinates (spanning
> about 15 degrees of latitude), so the results are not perfect (using
> plain long/lat coordinates), but they will probably be an adequate
> approximation.
>
> BTW, for my application, I'm not interested in the distance per se, only
> in the points (e.g., boats) within a certain distance from the polygon
> (land). So I have also thought about a possible solution of using an
> expanded polygon, expanded in a certain number of kilometers outwards,
> and then using point-in-polygon (i.e., 'overlay') to find the points
> that are inside this new polygon. But I couldn't find a function to
> 'grow' a polygon in this way.
>
> --
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jorgefernandosaraiva at gmail.com  Wed Jan 27 20:39:06 2010
From: jorgefernandosaraiva at gmail.com (Jorge Fernando Saraiva de Menezes)
Date: Wed, 27 Jan 2010 17:39:06 -0200
Subject: [R-sig-Geo] negative local R2 in gwr
Message-ID: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100127/da3fc2f8/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jan 27 21:01:49 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Jan 2010 21:01:49 +0100 (CET)
Subject: [R-sig-Geo] negative local R2 in gwr
In-Reply-To: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001272053180.25048@reclus.nhh.no>

On Wed, 27 Jan 2010, Jorge Fernando Saraiva de Menezes wrote:

> Dear all,
>
> I have started to use gwr in data of species counts in islands of the
> western hemisphere, but  the gwr() output contains negative locals R2s,
> especially when bandwith value are low. This happen also when I use the
> optimal bandwidth choosed by gwr.sel() with CV. Does anybody knows what
> could cause this problem?
>
> Here the code that I used (all variables continuos):
>
>> attach(islands)

No, please don't use attach(), it is irrelevant here (as would coords= be 
if you use an sp class as is recommended).

>> bnd = gwr.sel(RICHNESS ~ log(AREA) + DISTANCIA, data=islands,
   coords=cbind(islands$LONG,islands$LAT))
>> gwr(RICHNESS ~ log(AREA) + DISTANCIA, data=islands,
  coords=cbind(islands$LONG,islands$LAT), bnd)
>

(do use spaces in quoted commands to reduce mailer mangling).

Please document this using a dataset that others have access to 
(preferably a built-in data set, such as meuse in sp). Please state what 
version of spgwr you are trying to use, local R2 has changed fairly 
recently, and continues not to be well founded (GWR3's local R2 cannot be 
reproduced, the current ones are from the unpublished GWR4).

With a very tight bandwidth (longlat coordinates maybe, why not use GC 
distances?), the sum of weights (reported - always store the output 
object) may be little more than unity - the local R2 could go almost 
anywhere. Have you looked at pairs() of the local coefficients?

Roger

>
> Thanks,
> Jorge Menezes
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zua3 at cornell.edu  Wed Jan 27 22:58:34 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 27 Jan 2010 16:58:34 -0500
Subject: [R-sig-Geo] Combing attribute table with polygon??
In-Reply-To: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
Message-ID: <4B60B70A.8020409@cornell.edu>

I have created one data table and one polygon in R. Both have a similar 
type of column.  I want to combine or join them with this column or 
field ("MUKEY").  Then  I will convert this polygon  as  a ESRI  shape 
file.
But  when  I  used  spCbind,   I got error. I think i miss something here.
Is there any way join attribute table with polygon? Thanks
Zia

poly.data1 <- spCbind(poly.data, data.table)
 Error in spCbind(poly.data, data.table) : different numbers of rows


names(poly.data) # polygoan
[1] "AREASYMBOL" "SPATIALVER" "MUSYM"      "MUKEY"    
 > names(data.table) # data
 [1] "MUKEY" "Sand"  "Silt"  "Clay"  "pH"    "CEC"   "EC"    "SAR"   "CaCO3"
[10] "SOM"   "BD"    "AWC"   "KSAT"  "Kf"    "Kw"    "LL"    "LEP" 

 > length(poly.data$MUKEY)
[1] 76969
 > length(data.table$MUKEY)
[1] 184
 >


poly.data1 <- spCbind(poly.data, data.table)

combinedShp1 <- "D:/test/combined1.shp" 
writeOGR(poly.data1, dsn=combinedShp1, layer="combined1", driver="ESRI 
Shapefile")


From macq at llnl.gov  Wed Jan 27 23:03:50 2010
From: macq at llnl.gov (Don MacQueen)
Date: Wed, 27 Jan 2010 14:03:50 -0800
Subject: [R-sig-Geo] "subset" a large raster object
Message-ID: <p06240805c7865a110997@[128.115.67.9]>

I have a SpatialGridDataFrame named tmp.lc [see below for part of the 
str() information on it] obtained by using readGDAL() on an image 
file.

I would like to subset it in the sense of finding the portions of the 
raster image that meet a defined criterion, so that I can use, for 
example, chull() to find a polygon that surrounds that portion of the 
raster.

For a relatively small object (150x150) I can do the job by 
converting to SpatialPointsDataFrame. Then subsetting is easly. See 
example below.

But when I go to the full 5100x5400 image the method fails due to 
insufficient memory. Similarly if I use rasterToPoints() from the 
raster package from R-forge.

I would appreciate suggestions for an alternative.
(perhaps GRASS, to which I have just a very small amount of exposure?)

Thanks
-Don


## start with object tmp.lc
ick <- SpatialPointsDataFrame(coordinates(tmp.lc), tmp.lc at data, 
proj4string=CRS(proj4string(tmp.lc)))
bah <- ick[ ick at data$band1 %in% 22:24 ,]


>  str(tmp.lc)
Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
   ..@ data       :'data.frame': 22500 obs. of  1 variable:
   .. ..$ band1: int [1:22500] 11 11 11 11 11 11 11 11 11 11 ...
   ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots


>  str(bah)
Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
   ..@ data       :'data.frame': 4032 obs. of  1 variable:
   .. ..$ band1: int [1:4032] 22 22 22 22 22 22 22 22 22 23 ...


>  sessionInfo()
R version 2.10.1 (2009-12-14)
i386-apple-darwin8.11.1

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
  [1] raster_0.9.9-4  spatstat_1.17-5 deldir_0.0-11   mgcv_1.6-1 
rmacq_1.0-2     rgdal_0.6-12    maptools_0.7-29
  [8] lattice_0.17-26 sp_0.9-56       foreign_0.8-39

loaded via a namespace (and not attached):
[1] Matrix_0.999375-33 grid_2.10.1        nlme_3.1-96 
tcltk_2.10.1       tools_2.10.1


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062


From r.hijmans at gmail.com  Thu Jan 28 02:21:40 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 27 Jan 2010 17:21:40 -0800
Subject: [R-sig-Geo] Combing attribute table with polygon??
In-Reply-To: <4B60B70A.8020409@cornell.edu>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
	<4B60B70A.8020409@cornell.edu>
Message-ID: <dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>

Zia, something like this might work as long as MUKEY has no NA values:

poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)

Robert

On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
> I have created one data table and one polygon in R. Both have a similar type
> of column. ?I want to combine or join them with this column or field
> ("MUKEY"). ?Then ?I will convert this polygon ?as ?a ESRI ?shape file.
> But ?when ?I ?used ?spCbind, ? I got error. I think i miss something here.
> Is there any way join attribute table with polygon? Thanks
> Zia
>
> poly.data1 <- spCbind(poly.data, data.table)
> Error in spCbind(poly.data, data.table) : different numbers of rows
>
>
> names(poly.data) # polygoan
> [1] "AREASYMBOL" "SPATIALVER" "MUSYM" ? ? ?"MUKEY" ? ?> names(data.table) #
> data
> [1] "MUKEY" "Sand" ?"Silt" ?"Clay" ?"pH" ? ?"CEC" ? "EC" ? ?"SAR" ? "CaCO3"
> [10] "SOM" ? "BD" ? ?"AWC" ? "KSAT" ?"Kf" ? ?"Kw" ? ?"LL" ? ?"LEP"
>> length(poly.data$MUKEY)
> [1] 76969
>> length(data.table$MUKEY)
> [1] 184
>>
>
>
> poly.data1 <- spCbind(poly.data, data.table)
>
> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Thu Jan 28 02:49:00 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 27 Jan 2010 17:49:00 -0800
Subject: [R-sig-Geo] "subset" a large raster object
In-Reply-To: <p06240805c7865a110997@128.115.67.9>
References: <p06240805c7865a110997@128.115.67.9>
Message-ID: <dc22b2571001271749x16e4233ve94ffaa1344000d@mail.gmail.com>

Don,

I am guessing that you did not provide a function to rasterToPoints to
subset the values. That should work if the number of cells within the
range specified is not extremely large.

r = raster(filename, band=1)
p = rasterToPoints(r, fun=function(x){x > 21 & x < 25})


If you need to combine various bands, you could first do some raster
processing as in:

r = raster(filename, band=1)
s = r > 21 & r < 25
s[!s] = NA

#or
s = reclass(r, c(-Inf, 11, NA, 22, 24, 1, 25, Inf, NA))
# 1/NA result

r = raster(filename, band=2)
s2 = reclass(r, c(-Inf, 11, NA, 22, 24, 1, 25, Inf, NA))

etc

s = s * s2 * ...

all of that should worn on a file of (practically) any size.
then

p = pointsToRaster(s)

Robert


On Wed, Jan 27, 2010 at 2:03 PM, Don MacQueen <macq at llnl.gov> wrote:
> I have a SpatialGridDataFrame named tmp.lc [see below for part of the str()
> information on it] obtained by using readGDAL() on an image file.
>
> I would like to subset it in the sense of finding the portions of the raster
> image that meet a defined criterion, so that I can use, for example, chull()
> to find a polygon that surrounds that portion of the raster.
>
> For a relatively small object (150x150) I can do the job by converting to
> SpatialPointsDataFrame. Then subsetting is easly. See example below.
>
> But when I go to the full 5100x5400 image the method fails due to
> insufficient memory. Similarly if I use rasterToPoints() from the raster
> package from R-forge.
>
> I would appreciate suggestions for an alternative.
> (perhaps GRASS, to which I have just a very small amount of exposure?)
>
> Thanks
> -Don
>
>
> ## start with object tmp.lc
> ick <- SpatialPointsDataFrame(coordinates(tmp.lc), tmp.lc at data,
> proj4string=CRS(proj4string(tmp.lc)))
> bah <- ick[ ick at data$band1 %in% 22:24 ,]
>
>
>> ?str(tmp.lc)
>
> Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
> ?..@ data ? ? ? :'data.frame': 22500 obs. of ?1 variable:
> ?.. ..$ band1: int [1:22500] 11 11 11 11 11 11 11 11 11 11 ...
> ?..@ grid ? ? ? :Formal class 'GridTopology' [package "sp"] with 3 slots
>
>
>> ?str(bah)
>
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
> ?..@ data ? ? ? :'data.frame': 4032 obs. of ?1 variable:
> ?.. ..$ band1: int [1:4032] 22 22 22 22 22 22 22 22 22 23 ...
>
>
>> ?sessionInfo()
>
> R version 2.10.1 (2009-12-14)
> i386-apple-darwin8.11.1
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
> other attached packages:
> ?[1] raster_0.9.9-4 ?spatstat_1.17-5 deldir_0.0-11 ? mgcv_1.6-1 rmacq_1.0-2
> ? ? rgdal_0.6-12 ? ?maptools_0.7-29
> ?[8] lattice_0.17-26 sp_0.9-56 ? ? ? foreign_0.8-39
>
> loaded via a namespace (and not attached):
> [1] Matrix_0.999375-33 grid_2.10.1 ? ? ? ?nlme_3.1-96 tcltk_2.10.1
> tools_2.10.1
>
>
> --
> --------------------------------------
> Don MacQueen
> Environmental Protection Department
> Lawrence Livermore National Laboratory
> Livermore, CA, USA
> 925-423-1062
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From zua3 at cornell.edu  Thu Jan 28 03:29:33 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 27 Jan 2010 21:29:33 -0500
Subject: [R-sig-Geo] Combing attribute table with polygon??
In-Reply-To: <dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>	
	<4B60B70A.8020409@cornell.edu>
	<dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>
Message-ID: <4B60F68D.1050607@cornell.edu>

Thank you so much Roberts! it works.

Zia

Robert J. Hijmans wrote:
> Zia, something like this might work as long as MUKEY has no NA values:
>
> poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>
> Robert
>
> On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>   
>> I have created one data table and one polygon in R. Both have a similar type
>> of column.  I want to combine or join them with this column or field
>> ("MUKEY").  Then  I will convert this polygon  as  a ESRI  shape file.
>> But  when  I  used  spCbind,   I got error. I think i miss something here.
>> Is there any way join attribute table with polygon? Thanks
>> Zia
>>
>> poly.data1 <- spCbind(poly.data, data.table)
>> Error in spCbind(poly.data, data.table) : different numbers of rows
>>
>>
>> names(poly.data) # polygoan
>> [1] "AREASYMBOL" "SPATIALVER" "MUSYM"      "MUKEY"    > names(data.table) #
>> data
>> [1] "MUKEY" "Sand"  "Silt"  "Clay"  "pH"    "CEC"   "EC"    "SAR"   "CaCO3"
>> [10] "SOM"   "BD"    "AWC"   "KSAT"  "Kf"    "Kw"    "LL"    "LEP"
>>     
>>> length(poly.data$MUKEY)
>>>       
>> [1] 76969
>>     
>>> length(data.table$MUKEY)
>>>       
>> [1] 184
>>     
>> poly.data1 <- spCbind(poly.data, data.table)
>>
>> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
>> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>


From zua3 at cornell.edu  Thu Jan 28 03:59:14 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 27 Jan 2010 21:59:14 -0500
Subject: [R-sig-Geo] Shows error when I try to write shape file-Re: Combing
 attribute table with polygon??
In-Reply-To: <4B60F68D.1050607@cornell.edu>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>		<4B60B70A.8020409@cornell.edu>	<dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>
	<4B60F68D.1050607@cornell.edu>
Message-ID: <4B60FD82.2050106@cornell.edu>

Hi, Roberts,
In my last mail, I mentioned it works fine,  but when I try write shape 
file after merging it shows error. I think I need to  define  spatial 
object or data frame after merging. I do not know  how to do this. 
Thanks again.
Zia

 > poly.data1 = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
 > names(poly.data1) # polygoan
 [1] "MUKEY"      "AREASYMBOL" "SPATIALVER" "MUSYM"      "Sand"     
 [6] "Silt"       "Clay"       "pH"         "CEC"        "EC"       
[11] "SAR"        "CaCO3"      "SOM"        "BD"         "AWC"      
[16] "KSAT"       "Kf"         "Kw"         "LL"         "LEP"      

 >polyShp <- "D:/test/mapunit_poly.shp" 
 > writeOGR(poly.data1, dsn=polyShp, layer="mapunit_poly", driver="ESRI 
Shapefile")
Error in writeOGR(poly.data1, dsn = polyShp, layer = "mapunit_poly", 
driver = "ESRI Shapefile") :
  obj of wrong class

Zia Ahmed wrote:
> Thank you so much Roberts! it works.
>
> Zia
>
> Robert J. Hijmans wrote:
>> Zia, something like this might work as long as MUKEY has no NA values:
>>
>> poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>
>> Robert
>>
>> On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>>  
>>> I have created one data table and one polygon in R. Both have a 
>>> similar type
>>> of column.  I want to combine or join them with this column or field
>>> ("MUKEY").  Then  I will convert this polygon  as  a ESRI  shape file.
>>> But  when  I  used  spCbind,   I got error. I think i miss something 
>>> here.
>>> Is there any way join attribute table with polygon? Thanks
>>> Zia
>>>
>>> poly.data1 <- spCbind(poly.data, data.table)
>>> Error in spCbind(poly.data, data.table) : different numbers of rows
>>>
>>>
>>> names(poly.data) # polygoan
>>> [1] "AREASYMBOL" "SPATIALVER" "MUSYM"      "MUKEY"    > 
>>> names(data.table) #
>>> data
>>> [1] "MUKEY" "Sand"  "Silt"  "Clay"  "pH"    "CEC"   "EC"    "SAR"   
>>> "CaCO3"
>>> [10] "SOM"   "BD"    "AWC"   "KSAT"  "Kf"    "Kw"    "LL"    "LEP"
>>>    
>>>> length(poly.data$MUKEY)
>>>>       
>>> [1] 76969
>>>    
>>>> length(data.table$MUKEY)
>>>>       
>>> [1] 184
>>>     poly.data1 <- spCbind(poly.data, data.table)
>>>
>>> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
>>> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From adrian at maths.uwa.edu.au  Thu Jan 28 12:01:21 2010
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Thu, 28 Jan 2010 19:01:21 +0800
Subject: [R-sig-Geo]  complement part of a polygon in another polygon
Message-ID: <4B616E81.90407@maths.uwa.edu.au>


User 'rusers.sh' asks a question about the library 'spatstat':

 > intersect.owin() works for intersection.
 > Say polygon B located inside A. Is there any function in R for us to
 > get the complement part of  B in  polygon A?

See complement.owin.
Try
        Bcom <- complement.owin(B, frame=bounding.box(A))
        AminB <- intersect.owin(A, Bcom)

If you want the answer to be a polygon, you'll need to set 
spatstat.options(gpclib=TRUE), unless A is a rectangle.

Adrian Baddeley


From Pilar.Tugores at ba.ieo.es  Wed Jan 27 17:35:58 2010
From: Pilar.Tugores at ba.ieo.es (Pilar Tugores Ferra)
Date: Wed, 27 Jan 2010 17:35:58 +0100
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <522664f81001270129g2a80ea2n62e8e6c3442fc7e@mail.gmail.com>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
	<522664f81001270129g2a80ea2n62e8e6c3442fc7e@mail.gmail.com>
Message-ID: <0838E01493845742A4D4039EA34EB1C1957373@ieopalma2.ba.ieo.es>

Hi, Martin
Two years ago there was a similar discussion on the list:
http://markmail.org/message/tw7ulpxbgixieyys

If I understand it properly, your problem is you need to compute your variogram using non-euclidian distances.
As far as I know, there is no package in R that can do so (correct me if I am wrong). 
There is a function LCP_Krige that I think you can find on the net. It is not an R function but a mixture of ArcGis 8.x and Matlab. Maybe you can use it or try to adapt it to R...
Jensen, OP, MC Christman and TJ Mller. 2006. Landscape-based geostatistics: a case study of the distribution of blue crab in Chesapeake Bay. Envirometrics. 17:605-621.
I was interested in applying this sort of analysis but I didn't suceed.
I hope you are more lacky!

Cheers,
Pilar 



M? Pilar Tugores Ferr?
PhD Student
Instituto Espa?ol de Oceanograf?a
Centro Oceanogr?fico de Baleares
Muelle de Poniente s/n
07015 Palma de Mallorca
Baleares, Espa?a
Telf.: (34) 971 133759


-----Mensaje original-----
De: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] En nombre de Michael Sumner
Enviado el: 27 January 2010 10:29
Para: Martin Renner
CC: r-sig-geo at stat.math.ethz.ch
Asunto: Re: [R-sig-Geo] kriging as fish swim, not as crows fly

Not kriging as such, but check out the soap-film smoothing in package mgcv:

http://www.maths.bath.ac.uk/~sw283/simon/papers/soap.pdf

FWIW, there are binning methods with MCMC in the package
tripEstimation that have similar features, but they are particularly
focussed on individual track estimation and probably not easily
applied. Is location uncertainty a big issue for your data? What are
the input locations?

Cheers, Mike.


On Wed, Jan 27, 2010 at 7:06 PM, Martin Renner
<martin.renner at stonebow.otago.ac.nz> wrote:
> Hi All,
>
> I want to kirg fish and seabird densities within an estuary which has several arms. Since neither organisms cross land, the appropriate distances would not be euclidian but over-water (as fish swim). There are several papers, describing this problem and how to deal with it (see below), but I have not found an easily accessible implementation. Is anybody aware of a solution in R?
>
> Best,
> Martin
>
>
>
> @article{Rathbun:1998aa,
> ? ? ? ?Author = {Rathbun, Stephen L.},
> ? ? ? ?Journal = {Environmetrics},
> ? ? ? ?Number = {2},
> ? ? ? ?Pages = {109--129},
> ? ? ? ?Title = {Spatial modelling in irregularly shaped regions: kriging estuaries},
> ? ? ? ?Volume = {9},
> ? ? ? ?Year = {1998}}
>
> @article{Little:1997aa,
> ? ? ? ?Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne E.},
> ? ? ? ?Journal = {Journal of Experimental Marine Biology and Ecology},
> ? ? ? ?Number = {1},
> ? ? ? ?Pages = {1--11},
> ? ? ? ?Title = {Kriging in estuaries: as the crow flies, or as the fish swims?},
> ? ? ? ?Volume = {213},
> ? ? ? ?Year = {1997}}
>
>
>
>
> Martin Renner
> US Geological Survey
> Alaska Science Center
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From famuvie at alumni.uv.es  Thu Jan 28 13:42:00 2010
From: famuvie at alumni.uv.es (=?windows-1252?Q?Facundo_Mu=F1oz?=)
Date: Thu, 28 Jan 2010 13:42:00 +0100
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
Message-ID: <4B618618.6080400@alumni.uv.es>

Hi Martin.

I have succeeded in doing something like that.
Please see http://dx.doi.org/10.1016/j.mcm.2009.05.021.

I used GRASS for the computation of the non-euclidean distances and 
modified the geoR library in order to be able to estimate de variograms 
and perform kriging prediction with those "customized" distances.

Both the GRASS script for computing distances and the modified geoR 
library are open source and available at 
http://www.geeitema.org/guenmap/index.jsp?opcion=resultados


I hope it helps.
	?acu.-


Martin Renner escribi?:
> Hi All,
> 
> I want to kirg fish and seabird densities within an estuary which has several arms. Since neither organisms cross land, the appropriate distances would not be euclidian but over-water (as fish swim). There are several papers, describing this problem and how to deal with it (see below), but I have not found an easily accessible implementation. Is anybody aware of a solution in R?
> 
> Best,
> Martin
> 
> 
> 
> @article{Rathbun:1998aa,
> 	Author = {Rathbun, Stephen L.},
> 	Journal = {Environmetrics},
> 	Number = {2},
> 	Pages = {109--129},
> 	Title = {Spatial modelling in irregularly shaped regions: kriging estuaries},
> 	Volume = {9},
> 	Year = {1998}}
> 
> @article{Little:1997aa,
> 	Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne E.},
> 	Journal = {Journal of Experimental Marine Biology and Ecology},
> 	Number = {1},
> 	Pages = {1--11},
> 	Title = {Kriging in estuaries: as the crow flies, or as the fish swims?},
> 	Volume = {213},
> 	Year = {1997}}
> 
> 
> 
> 
> Martin Renner				
> US Geological Survey			
> Alaska Science Center


From Bjarke.Christensen at sydbank.dk  Thu Jan 28 14:43:52 2010
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Thu, 28 Jan 2010 14:43:52 +0100
Subject: [R-sig-Geo] Fill pattern in plot.SpatialPolygons
Message-ID: <OF16C0C60B.15B6C9A9-ONC12576B9.004B1E46-C12576B9.004B6DAF@bdpnet.dk>


Hi,

Is it possible to plot SpatialPolygons using a fill pattern, so that the
polygon is filled not with a solid color but with lines, dots or the like?

Thanks in advance,
Bjarke Christensen


From Roger.Bivand at nhh.no  Thu Jan 28 14:56:39 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Jan 2010 14:56:39 +0100 (CET)
Subject: [R-sig-Geo] Fill pattern in plot.SpatialPolygons
In-Reply-To: <OF16C0C60B.15B6C9A9-ONC12576B9.004B1E46-C12576B9.004B6DAF@bdpnet.dk>
References: <OF16C0C60B.15B6C9A9-ONC12576B9.004B1E46-C12576B9.004B6DAF@bdpnet.dk>
Message-ID: <alpine.LRH.2.00.1001281450360.28162@reclus.nhh.no>

On Thu, 28 Jan 2010, Bjarke Christensen wrote:

>
> Hi,
>
> Is it possible to plot SpatialPolygons using a fill pattern, so that the
> polygon is filled not with a solid color but with lines, dots or the like?

If the angle= and density= arguments as described in ?polygon give you 
what you want, yes. They may be used like col=.

Getting a cross-hatch means over-plotting for the affected polygons, again 
in the usual way - the same can be done to mix solid colour and lines.

Roger

>
> Thanks in advance,
> Bjarke Christensen
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Thu Jan 28 18:59:59 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 28 Jan 2010 09:59:59 -0800
Subject: [R-sig-Geo] Shows error when I try to write shape file-Re:
	Combing attribute table with polygon??
In-Reply-To: <4B60FD82.2050106@cornell.edu>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
	<4B60B70A.8020409@cornell.edu>
	<dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>
	<4B60F68D.1050607@cornell.edu> <4B60FD82.2050106@cornell.edu>
Message-ID: <dc22b2571001280959i2b49884du797f9c317e528dea@mail.gmail.com>

Here is reproducible example, #1 fails because what I suspect is a bug
in merge, but #2 works. Robert

 library(maptools)
 data(wrld_simpl)
# create some data to merge with
 m = sort(unique(wrld_simpl at data$REGION))
 m = cbind(m, 1:length(m))
 colnames(m) = c('REGION', 'v')
# merge
 wrld_simpl at data = merge(wrld_simpl at data, m, by='REGION', all.x=TRUE,
sort=FALSE)

# but this does not work:
col = terrain.colors(nrow(m))
plot(wrld_simpl, col=col[wrld_simpl$v])
# he data.frame is rearanged; despite "sort=FALSE"
# this looks like a bug in merge to me. Anyone, am I wrong?


Therefore, I would do

library(maptools)
data(wrld_simpl)
# get the data.frame out of the SPGDF; to simplify code
d = wrld_simpl at data
# add a sort key
d$sort = 1:nrow(d)
# create some data to merge with
 m = sort(unique(d$REGION))
 m = cbind(m, 1:length(m))
 colnames(m) = c('REGION', 'v')
# merge
 x = merge(d, m, by='REGION', all.x=TRUE)
# sort
 x = x[order(x$sort),]
# put the data back
 wrld_simpl at data = x


# now it works
col = terrain.colors(nrow(m))
plot(wrld_simpl, col=col[wrld_simpl$v])


On Wed, Jan 27, 2010 at 6:59 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
> Hi, Roberts,
> In my last mail, I mentioned it works fine, ?but when I try write shape file
> after merging it shows error. I think I need to ?define ?spatial object or
> data frame after merging. I do not know ?how to do this. Thanks again.
> Zia
>
>> poly.data1 = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>> names(poly.data1) # polygoan
> [1] "MUKEY" ? ? ?"AREASYMBOL" "SPATIALVER" "MUSYM" ? ? ?"Sand" ? ? [6]
> "Silt" ? ? ? "Clay" ? ? ? "pH" ? ? ? ? "CEC" ? ? ? ?"EC" ? ? ? [11] "SAR"
> ? ? ?"CaCO3" ? ? ?"SOM" ? ? ? ?"BD" ? ? ? ? "AWC" ? ? ?[16] "KSAT"
> "Kf" ? ? ? ? "Kw" ? ? ? ? "LL" ? ? ? ? "LEP"
>>polyShp <- "D:/test/mapunit_poly.shp" > writeOGR(poly.data1, dsn=polyShp,
>> layer="mapunit_poly", driver="ESRI Shapefile")
> Error in writeOGR(poly.data1, dsn = polyShp, layer = "mapunit_poly", driver
> = "ESRI Shapefile") :
> ?obj of wrong class
>
> Zia Ahmed wrote:
>>
>> Thank you so much Roberts! it works.
>>
>> Zia
>>
>> Robert J. Hijmans wrote:
>>>
>>> Zia, something like this might work as long as MUKEY has no NA values:
>>>
>>> poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>>
>>> Robert
>>>
>>> On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>>>
>>>>
>>>> I have created one data table and one polygon in R. Both have a similar
>>>> type
>>>> of column. ?I want to combine or join them with this column or field
>>>> ("MUKEY"). ?Then ?I will convert this polygon ?as ?a ESRI ?shape file.
>>>> But ?when ?I ?used ?spCbind, ? I got error. I think i miss something
>>>> here.
>>>> Is there any way join attribute table with polygon? Thanks
>>>> Zia
>>>>
>>>> poly.data1 <- spCbind(poly.data, data.table)
>>>> Error in spCbind(poly.data, data.table) : different numbers of rows
>>>>
>>>>
>>>> names(poly.data) # polygoan
>>>> [1] "AREASYMBOL" "SPATIALVER" "MUSYM" ? ? ?"MUKEY" ? ?>
>>>> names(data.table) #
>>>> data
>>>> [1] "MUKEY" "Sand" ?"Silt" ?"Clay" ?"pH" ? ?"CEC" ? "EC" ? ?"SAR"
>>>> "CaCO3"
>>>> [10] "SOM" ? "BD" ? ?"AWC" ? "KSAT" ?"Kf" ? ?"Kw" ? ?"LL" ? ?"LEP"
>>>>
>>>>>
>>>>> length(poly.data$MUKEY)
>>>>>
>>>>
>>>> [1] 76969
>>>>
>>>>>
>>>>> length(data.table$MUKEY)
>>>>>
>>>>
>>>> [1] 184
>>>> ? ?poly.data1 <- spCbind(poly.data, data.table)
>>>>
>>>> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
>>>> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From zua3 at cornell.edu  Thu Jan 28 19:14:25 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Thu, 28 Jan 2010 13:14:25 -0500
Subject: [R-sig-Geo] transparent polygon outline Re: Shows error when I try
 to write shape file-Re: Combing attribute table with polygon??
In-Reply-To: <dc22b2571001280959i2b49884du797f9c317e528dea@mail.gmail.com>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>	
	<4B60B70A.8020409@cornell.edu>	
	<dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>	
	<4B60F68D.1050607@cornell.edu> <4B60FD82.2050106@cornell.edu>
	<dc22b2571001280959i2b49884du797f9c317e528dea@mail.gmail.com>
Message-ID: <4B61D401.60607@cornell.edu>

I think I can use this accordingly. Thank you so much. I have a simple 
question. How do I plot a map without boundary (transparency)  ? I have 
to plot a shape files with  thousands of polygons!
Thanks again zia

# now it works
col = terrain.colors(nrow(m))
plot(wrld_simpl, col=col[wrld_simpl$v])



Robert J. Hijmans wrote:
> Here is reproducible example, #1 fails because what I suspect is a bug
> in merge, but #2 works. Robert
>
>  library(maptools)
>  data(wrld_simpl)
> # create some data to merge with
>  m = sort(unique(wrld_simpl at data$REGION))
>  m = cbind(m, 1:length(m))
>  colnames(m) = c('REGION', 'v')
> # merge
>  wrld_simpl at data = merge(wrld_simpl at data, m, by='REGION', all.x=TRUE,
> sort=FALSE)
>
> # but this does not work:
> col = terrain.colors(nrow(m))
> plot(wrld_simpl, col=col[wrld_simpl$v])
> # he data.frame is rearanged; despite "sort=FALSE"
> # this looks like a bug in merge to me. Anyone, am I wrong?
>
>
> Therefore, I would do
>
> library(maptools)
> data(wrld_simpl)
> # get the data.frame out of the SPGDF; to simplify code
> d = wrld_simpl at data
> # add a sort key
> d$sort = 1:nrow(d)
> # create some data to merge with
>  m = sort(unique(d$REGION))
>  m = cbind(m, 1:length(m))
>  colnames(m) = c('REGION', 'v')
> # merge
>  x = merge(d, m, by='REGION', all.x=TRUE)
> # sort
>  x = x[order(x$sort),]
> # put the data back
>  wrld_simpl at data = x
>
>
> # now it works
> col = terrain.colors(nrow(m))
> plot(wrld_simpl, col=col[wrld_simpl$v])
>
>
> On Wed, Jan 27, 2010 at 6:59 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>   
>> Hi, Roberts,
>> In my last mail, I mentioned it works fine,  but when I try write shape file
>> after merging it shows error. I think I need to  define  spatial object or
>> data frame after merging. I do not know  how to do this. Thanks again.
>> Zia
>>
>>     
>>> poly.data1 = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>> names(poly.data1) # polygoan
>>>       
>> [1] "MUKEY"      "AREASYMBOL" "SPATIALVER" "MUSYM"      "Sand"     [6]
>> "Silt"       "Clay"       "pH"         "CEC"        "EC"       [11] "SAR"
>>      "CaCO3"      "SOM"        "BD"         "AWC"      [16] "KSAT"
>> "Kf"         "Kw"         "LL"         "LEP"
>>     
>>> polyShp <- "D:/test/mapunit_poly.shp" > writeOGR(poly.data1, dsn=polyShp,
>>> layer="mapunit_poly", driver="ESRI Shapefile")
>>>       
>> Error in writeOGR(poly.data1, dsn = polyShp, layer = "mapunit_poly", driver
>> = "ESRI Shapefile") :
>>  obj of wrong class
>>
>> Zia Ahmed wrote:
>>     
>>> Thank you so much Roberts! it works.
>>>
>>> Zia
>>>
>>> Robert J. Hijmans wrote:
>>>       
>>>> Zia, something like this might work as long as MUKEY has no NA values:
>>>>
>>>> poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>>>
>>>> Robert
>>>>
>>>> On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>>>>
>>>>         
>>>>> I have created one data table and one polygon in R. Both have a similar
>>>>> type
>>>>> of column.  I want to combine or join them with this column or field
>>>>> ("MUKEY").  Then  I will convert this polygon  as  a ESRI  shape file.
>>>>> But  when  I  used  spCbind,   I got error. I think i miss something
>>>>> here.
>>>>> Is there any way join attribute table with polygon? Thanks
>>>>> Zia
>>>>>
>>>>> poly.data1 <- spCbind(poly.data, data.table)
>>>>> Error in spCbind(poly.data, data.table) : different numbers of rows
>>>>>
>>>>>
>>>>> names(poly.data) # polygoan
>>>>> [1] "AREASYMBOL" "SPATIALVER" "MUSYM"      "MUKEY"    >
>>>>> names(data.table) #
>>>>> data
>>>>> [1] "MUKEY" "Sand"  "Silt"  "Clay"  "pH"    "CEC"   "EC"    "SAR"
>>>>> "CaCO3"
>>>>> [10] "SOM"   "BD"    "AWC"   "KSAT"  "Kf"    "Kw"    "LL"    "LEP"
>>>>>
>>>>>           
>>>>>> length(poly.data$MUKEY)
>>>>>>
>>>>>>             
>>>>> [1] 76969
>>>>>
>>>>>           
>>>>>> length(data.table$MUKEY)
>>>>>>
>>>>>>             
>>>>> [1] 184
>>>>>    poly.data1 <- spCbind(poly.data, data.table)
>>>>>
>>>>> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
>>>>> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>           
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>       
>>     
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100128/52bcc468/attachment.vcf>

From r.hijmans at gmail.com  Thu Jan 28 19:23:26 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 28 Jan 2010 10:23:26 -0800
Subject: [R-sig-Geo] transparent polygon outline Re: Shows error when I
	try to write shape file-Re: Combing attribute table with polygon??
In-Reply-To: <4B61D401.60607@cornell.edu>
References: <d81b9e0a1001271139k2db855f5qa371c52dc14e34b3@mail.gmail.com>
	<4B60B70A.8020409@cornell.edu>
	<dc22b2571001271721s31a6f6d6ya0bb5da0d9f5ed6f@mail.gmail.com>
	<4B60F68D.1050607@cornell.edu> <4B60FD82.2050106@cornell.edu>
	<dc22b2571001280959i2b49884du797f9c317e528dea@mail.gmail.com>
	<4B61D401.60607@cornell.edu>
Message-ID: <dc22b2571001281023y30255802p3c5ffb93da494761@mail.gmail.com>

Zia:

?polygon

plot(wrld_simpl, col=col[wrld_simpl$v], border=NA)

or:

plot(wrld_simpl, col=col[wrld_simpl$v], border=col[wrld_simpl$v])


Robert

On Thu, Jan 28, 2010 at 10:14 AM, Zia Ahmed <zua3 at cornell.edu> wrote:
> I think I can use this accordingly. Thank you so much. I have a simple
> question. How do I plot a map without boundary (transparency) ?? I have to
> plot a shape files with ?thousands of polygons!
> Thanks again zia
>
> # now it works
> col = terrain.colors(nrow(m))
> plot(wrld_simpl, col=col[wrld_simpl$v])
>
>
>
> Robert J. Hijmans wrote:
>>
>> Here is reproducible example, #1 fails because what I suspect is a bug
>> in merge, but #2 works. Robert
>>
>> ?library(maptools)
>> ?data(wrld_simpl)
>> # create some data to merge with
>> ?m = sort(unique(wrld_simpl at data$REGION))
>> ?m = cbind(m, 1:length(m))
>> ?colnames(m) = c('REGION', 'v')
>> # merge
>> ?wrld_simpl at data = merge(wrld_simpl at data, m, by='REGION', all.x=TRUE,
>> sort=FALSE)
>>
>> # but this does not work:
>> col = terrain.colors(nrow(m))
>> plot(wrld_simpl, col=col[wrld_simpl$v])
>> # he data.frame is rearanged; despite "sort=FALSE"
>> # this looks like a bug in merge to me. Anyone, am I wrong?
>>
>>
>> Therefore, I would do
>>
>> library(maptools)
>> data(wrld_simpl)
>> # get the data.frame out of the SPGDF; to simplify code
>> d = wrld_simpl at data
>> # add a sort key
>> d$sort = 1:nrow(d)
>> # create some data to merge with
>> ?m = sort(unique(d$REGION))
>> ?m = cbind(m, 1:length(m))
>> ?colnames(m) = c('REGION', 'v')
>> # merge
>> ?x = merge(d, m, by='REGION', all.x=TRUE)
>> # sort
>> ?x = x[order(x$sort),]
>> # put the data back
>> ?wrld_simpl at data = x
>>
>>
>> # now it works
>> col = terrain.colors(nrow(m))
>> plot(wrld_simpl, col=col[wrld_simpl$v])
>>
>>
>> On Wed, Jan 27, 2010 at 6:59 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>>
>>>
>>> Hi, Roberts,
>>> In my last mail, I mentioned it works fine, ?but when I try write shape
>>> file
>>> after merging it shows error. I think I need to ?define ?spatial object
>>> or
>>> data frame after merging. I do not know ?how to do this. Thanks again.
>>> Zia
>>>
>>>
>>>>
>>>> poly.data1 = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>>> names(poly.data1) # polygoan
>>>>
>>>
>>> [1] "MUKEY" ? ? ?"AREASYMBOL" "SPATIALVER" "MUSYM" ? ? ?"Sand" ? ? [6]
>>> "Silt" ? ? ? "Clay" ? ? ? "pH" ? ? ? ? "CEC" ? ? ? ?"EC" ? ? ? [11] "SAR"
>>> ? ? "CaCO3" ? ? ?"SOM" ? ? ? ?"BD" ? ? ? ? "AWC" ? ? ?[16] "KSAT"
>>> "Kf" ? ? ? ? "Kw" ? ? ? ? "LL" ? ? ? ? "LEP"
>>>
>>>>
>>>> polyShp <- "D:/test/mapunit_poly.shp" > writeOGR(poly.data1,
>>>> dsn=polyShp,
>>>> layer="mapunit_poly", driver="ESRI Shapefile")
>>>>
>>>
>>> Error in writeOGR(poly.data1, dsn = polyShp, layer = "mapunit_poly",
>>> driver
>>> = "ESRI Shapefile") :
>>> ?obj of wrong class
>>>
>>> Zia Ahmed wrote:
>>>
>>>>
>>>> Thank you so much Roberts! it works.
>>>>
>>>> Zia
>>>>
>>>> Robert J. Hijmans wrote:
>>>>
>>>>>
>>>>> Zia, something like this might work as long as MUKEY has no NA values:
>>>>>
>>>>> poly.data = merge(poly.data, data.table, by="MUKEY" ,all.x = TRUE)
>>>>>
>>>>> Robert
>>>>>
>>>>> On Wed, Jan 27, 2010 at 1:58 PM, Zia Ahmed <zua3 at cornell.edu> wrote:
>>>>>
>>>>>
>>>>>>
>>>>>> I have created one data table and one polygon in R. Both have a
>>>>>> similar
>>>>>> type
>>>>>> of column. ?I want to combine or join them with this column or field
>>>>>> ("MUKEY"). ?Then ?I will convert this polygon ?as ?a ESRI ?shape file.
>>>>>> But ?when ?I ?used ?spCbind, ? I got error. I think i miss something
>>>>>> here.
>>>>>> Is there any way join attribute table with polygon? Thanks
>>>>>> Zia
>>>>>>
>>>>>> poly.data1 <- spCbind(poly.data, data.table)
>>>>>> Error in spCbind(poly.data, data.table) : different numbers of rows
>>>>>>
>>>>>>
>>>>>> names(poly.data) # polygoan
>>>>>> [1] "AREASYMBOL" "SPATIALVER" "MUSYM" ? ? ?"MUKEY" ? ?>
>>>>>> names(data.table) #
>>>>>> data
>>>>>> [1] "MUKEY" "Sand" ?"Silt" ?"Clay" ?"pH" ? ?"CEC" ? "EC" ? ?"SAR"
>>>>>> "CaCO3"
>>>>>> [10] "SOM" ? "BD" ? ?"AWC" ? "KSAT" ?"Kf" ? ?"Kw" ? ?"LL" ? ?"LEP"
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> length(poly.data$MUKEY)
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> [1] 76969
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> length(data.table$MUKEY)
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> [1] 184
>>>>>> ? poly.data1 <- spCbind(poly.data, data.table)
>>>>>>
>>>>>> combinedShp1 <- "D:/test/combined1.shp" writeOGR(poly.data1,
>>>>>> dsn=combinedShp1, layer="combined1", driver="ESRI Shapefile")
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>
>>>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>


From epistat at gmail.com  Fri Jan 29 01:25:39 2010
From: epistat at gmail.com (zhijie zhang)
Date: Thu, 28 Jan 2010 19:25:39 -0500
Subject: [R-sig-Geo] Convert grids with 0/1 attribute to polygons with
	neighbor grids of same values merged
In-Reply-To: <2fc17e31001271913qefd004ejb3fa8e0235081313@mail.gmail.com>
References: <2fc17e31001271913qefd004ejb3fa8e0235081313@mail.gmail.com>
Message-ID: <2fc17e31001281625k38031db2n3b63884ffe3c8a6f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100128/99b2c50e/attachment.pl>

From musche1 at comcast.net  Fri Jan 29 05:58:31 2010
From: musche1 at comcast.net (musche1 at comcast.net)
Date: Fri, 29 Jan 2010 04:58:31 +0000 (UTC)
Subject: [R-sig-Geo] help with areal interpolation I think
In-Reply-To: <2083374966.430051264740300428.JavaMail.root@sz0111a.emeryville.ca.mail.comcast.net>
Message-ID: <1516849282.433601264741111513.JavaMail.root@sz0111a.emeryville.ca.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/2a55ba58/attachment.pl>

From musche1 at comcast.net  Fri Jan 29 05:58:31 2010
From: musche1 at comcast.net (musche1 at comcast.net)
Date: Fri, 29 Jan 2010 04:58:31 +0000 (UTC)
Subject: [R-sig-Geo] help with areal interpolation I think
In-Reply-To: <2083374966.430051264740300428.JavaMail.root@sz0111a.emeryville.ca.mail.comcast.net>
Message-ID: <1516849282.433601264741111513.JavaMail.root@sz0111a.emeryville.ca.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/2a55ba58/attachment-0001.pl>

From martin.renner at stonebow.otago.ac.nz  Thu Jan 28 17:57:43 2010
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Thu, 28 Jan 2010 07:57:43 -0900
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <4B618618.6080400@alumni.uv.es>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
	<4B618618.6080400@alumni.uv.es>
Message-ID: <817DAECA-F1E0-4066-AAF0-D35EDE48411A@stonebow.otago.ac.nz>

Hi Facu,

great, this is just what I have been looking for. You say that your modifications to geoR are open source. On your website I found the geoR.dll file, but no source code. The .dll is of little use platforms other than windows. Is there any way I could get the source? 

Thank you for the help! Best,

Martin



On 28 Jan 2010, at 03:42 , Facundo Mu?oz wrote:

> Hi Martin.
> 
> I have succeeded in doing something like that.
> Please see http://dx.doi.org/10.1016/j.mcm.2009.05.021.
> 
> I used GRASS for the computation of the non-euclidean distances and modified the geoR library in order to be able to estimate de variograms and perform kriging prediction with those "customized" distances.
> 
> Both the GRASS script for computing distances and the modified geoR library are open source and available at http://www.geeitema.org/guenmap/index.jsp?opcion=resultados
> 
> 
> I hope it helps.
> 	?acu.-
> 
> 
> Martin Renner escribi?:
>> Hi All,
>> I want to kirg fish and seabird densities within an estuary which has several arms. Since neither organisms cross land, the appropriate distances would not be euclidian but over-water (as fish swim). There are several papers, describing this problem and how to deal with it (see below), but I have not found an easily accessible implementation. Is anybody aware of a solution in R?
>> Best,
>> Martin
>> @article{Rathbun:1998aa,
>> 	Author = {Rathbun, Stephen L.},
>> 	Journal = {Environmetrics},
>> 	Number = {2},
>> 	Pages = {109--129},
>> 	Title = {Spatial modelling in irregularly shaped regions: kriging estuaries},
>> 	Volume = {9},
>> 	Year = {1998}}
>> @article{Little:1997aa,
>> 	Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne E.},
>> 	Journal = {Journal of Experimental Marine Biology and Ecology},
>> 	Number = {1},
>> 	Pages = {1--11},
>> 	Title = {Kriging in estuaries: as the crow flies, or as the fish swims?},
>> 	Volume = {213},
>> 	Year = {1997}}
>> Martin Renner				
>> US Geological Survey			
>> Alaska Science Center			
> 


From pierre.roudier at gmail.com  Fri Jan 29 08:16:17 2010
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Fri, 29 Jan 2010 18:16:17 +1100
Subject: [R-sig-Geo] knearneigh() computing efficiency on large datasets
Message-ID: <e4178da61001282316n2945e229wb09827ed7295e32f@mail.gmail.com>

Dear list,

I am processing gridded data like DEMs, imported in R from geotiff
files. Of course, such data is regularly gridded, but very often with
NA values. In the framwork of some tests, I have to generate a
neighbourhood of the DEM, so that to extract local extrema of the
layer. For this task, I wrote a function based on  the knearneig()
function from the spdep package, with k=4 or k=8, to generate and
analyse the neighbourhood of each point.

Unfortunately, I often have to process big datasets (let's say grids
with between  50,000 and 350,000 points), and that's working but
knearneigh() takes *hours* to process.

Does anybody would have any suggestion to improve the efficiency of this step ?

Thanks,

Pierre


From edzer.pebesma at uni-muenster.de  Fri Jan 29 08:45:38 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 29 Jan 2010 08:45:38 +0100
Subject: [R-sig-Geo] knearneigh() computing efficiency on large datasets
In-Reply-To: <e4178da61001282316n2945e229wb09827ed7295e32f@mail.gmail.com>
References: <e4178da61001282316n2945e229wb09827ed7295e32f@mail.gmail.com>
Message-ID: <4B629222.3050706@uni-muenster.de>

Pierre Roudier wrote:
> Dear list,
>
> I am processing gridded data like DEMs, imported in R from geotiff
> files. Of course, such data is regularly gridded, but very often with
> NA values. In the framwork of some tests, I have to generate a
> neighbourhood of the DEM, so that to extract local extrema of the
> layer. For this task, I wrote a function based on  the knearneig()
> function from the spdep package, with k=4 or k=8, to generate and
> analyse the neighbourhood of each point.
>
> Unfortunately, I often have to process big datasets (let's say grids
> with between  50,000 and 350,000 points), and that's working but
> knearneigh() takes *hours* to process.
>
> Does anybody would have any suggestion to improve the efficiency of this step ?
>   
the algorithm (knn.c file in the spdep sources) seems to compute all 
distances between all grid cells, and for each grid cell find the 
nearest k by some kind of insertion sort. That makes it general for all 
kinds of spatial data points, including irregularly spread ones, but 
makes it also inefficient (because O(n^2) with n the number of grid 
cells) for large data sets.

Suggestions to improve this would be to use an index structure (for the 
generic case of possibly irregularly spread data) such as the PR-bucket 
quadtree used in package gstat (nsearch.c), or specifically for gridded 
data to write a special knearneigh() that exploits the grid indexing 
already present: you can explicitly address the nearest 4/8/12/... 
neighbours by using row/col indexes. In this latter case you'd probably 
want to rewrite the test function for the full grid, instead of looping 
over the cells.
> Thanks,
>
> Pierre
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster 
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de 
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Fri Jan 29 09:13:43 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 29 Jan 2010 00:13:43 -0800
Subject: [R-sig-Geo] knearneigh() computing efficiency on large datasets
In-Reply-To: <e4178da61001282316n2945e229wb09827ed7295e32f@mail.gmail.com>
References: <e4178da61001282316n2945e229wb09827ed7295e32f@mail.gmail.com>
Message-ID: <dc22b2571001290013g379171d0o15f82222673a3361@mail.gmail.com>

You can try one of the 'focal' functions of the raster package on
R-Forge. Not particularly fast either, but probably much faster that
what you have now. Robert

On Thu, Jan 28, 2010 at 11:16 PM, Pierre Roudier
<pierre.roudier at gmail.com> wrote:
> Dear list,
>
> I am processing gridded data like DEMs, imported in R from geotiff
> files. Of course, such data is regularly gridded, but very often with
> NA values. In the framwork of some tests, I have to generate a
> neighbourhood of the DEM, so that to extract local extrema of the
> layer. For this task, I wrote a function based on ?the knearneig()
> function from the spdep package, with k=4 or k=8, to generate and
> analyse the neighbourhood of each point.
>
> Unfortunately, I often have to process big datasets (let's say grids
> with between ?50,000 and 350,000 points), and that's working but
> knearneigh() takes *hours* to process.
>
> Does anybody would have any suggestion to improve the efficiency of this step ?
>
> Thanks,
>
> Pierre
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.m.krug at gmail.com  Fri Jan 29 12:41:41 2010
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 29 Jan 2010 13:41:41 +0200
Subject: [R-sig-Geo] Problem with readRAST6
Message-ID: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/9cec8ba8/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 29 13:32:43 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Jan 2010 13:32:43 +0100 (CET)
Subject: [R-sig-Geo] Problem with readRAST6
In-Reply-To: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>
References: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001291317440.31949@reclus.nhh.no>

On Fri, 29 Jan 2010, Rainer M Krug wrote:

> Hi
>
> I have a question concerning readRAST6 and the plugin. When I use the
> default (plugin=NULL), I get the error below,

Well, this does happen. I never knowingly use the plugins for raster or 
vector any more, because I have multiple GDAL and GRASS installations, and 
the cross-dependencies take more time to manage than any accruing benefit. 
Use plugin=TRUE to avoid the sanity check.

If you would like to find the cause, please run debug(readRAST6) first, 
then run the command, and print out the values of gg (returned by 
gmeta6()), and fninfo (returned by GDALinfo). The values of gg$n and 
fninfo[5] are found to differ, but gg$w and fninfo[4] not. It could be 
that fninfo[5] is set wrongly; in GDALinfo, it is:

         ysign <- sign(gt[6])
         offset.y <- ifelse(ysign < 0, gt[4] + ysign * d[1] *
             abs(cellsize[2]), gt[4] + abs(cellsize[2]))

where gt is the vector of values returned by RGDAL_GetGeoTransform from 
the file-specific driver, and d[1] is the number of rows.

If you in addition say debug(GDALinfo), and print the values of gt, we 
could see whether the values seem sane for this driver. They "must" be 
anyway for reading with plugin=TRUE to work, because they set up the 
GridTopology for the object read in; checking with gdalinfo of the same 
raster would also be helpful.

Short answer, use plugin=TRUE if you want to use it.

Hope this helps,

Roger

>
>> x <- readRAST6("MASK")
> raster map/current region mismatch detected in components:
>           cols            rows origin.northing  origin.easting
>           TRUE            TRUE           FALSE            TRUE
> set plugin=TRUE to override; continuing with plugin=FALSE
>
> I am absolutely sure, that the raster map:
>
>
>> execGRASS("r.info", parameters=list(map="MASK"))
> +----------------------------------------------------------------------------+
> | Layer:    MASK                           Date: Fri Jan 29 13:19:03 2010
> |
> | Mapset:   HLsim_Rtmpe2v0qc               Login of Creator: rkrug
>  |
> | Location: grass
> |
> | DataBase: /home/rkrug/Documents/Projects/HakeaLandscape/trunc/
>  |
> | Title:    Reclass of region in HLsim_Rtmpe2v0qc ( MASK )
>  |
> | Timestamp: none
> |
> |----------------------------------------------------------------------------|
> |
> |
> |   Type of Map:  reclass              Number of Categories: 1
>  |
> |   Data Type:    CELL
>  |
> |   Rows:         520
> |
> |   Columns:      192
> |
> |   Total Cells:  99840
> |
> |        Projection: UTM (zone -34)
> |
> |            N:    6247000    S:    6195000   Res:   100
>  |
> |            E:     270200    W:     251000   Res:   100
>  |
> |   Range of data:    min = 1  max = 1
>  |
> |
> |
> |   Data Source:
>  |
> |    Reclassified map based on:
> |
> |      Map [region] in mapset [HLsim_Rtmpe2v0qc]
>  |
> |
> |
> |   Data Description:
> |
> |    generated by r.reclass
> |
> |
> |
> |
> |
> |----------------------------------------------------------------------------|
> |   Reclassification of [region] in mapset [HLsim_Rtmpe2v0qc]
> |
> |
> |
> |         Category        Original categories
> |
> |
> |
> |          1              1
> |
> +----------------------------------------------------------------------------+
>
>> execGRASS("g.region", flags="p")
> projection: 1 (UTM)
> zone:       -34
> datum:      wgs84
> ellipsoid:  wgs84
> north:      6247000
> south:      6195000
> west:       251000
> east:       270200
> nsres:      100
>
> gdal info:
>
>> library(rgdal)
> Loading required package: sp
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.6.3, released 2009/11/19
> Path to GDAL shared files: /usr/share/gdal16
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009
> Path to PROJ.4 shared files: (autodetected)
>
>> sessionInfo()
> R version 2.10.1 (2009-12-14)
> i486-pc-linux-gnu
>
> locale:
> [1] LC_CTYPE=en_ZA.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_ZA.UTF-8        LC_COLLATE=en_ZA.UTF-8
> [5] LC_MONETARY=C              LC_MESSAGES=en_ZA.UTF-8
> [7] LC_PAPER=en_ZA.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_ZA.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] multicore_0.1-3 RSQLite_0.8-0   DBI_0.2-5       spgrass6_0.6-12
> [5] XML_2.6-0       maptools_0.7-29 lattice_0.18-3  foreign_0.8-38
> [9] simecol_0.6-9   deSolve_1.6     rgdal_0.6-24    sp_0.9-52
>
> loaded via a namespace (and not attached):
> [1] grid_2.10.1  tools_2.10.1
>>
>
> Cheers,
>
> Rainer
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.m.krug at gmail.com  Fri Jan 29 13:34:08 2010
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 29 Jan 2010 14:34:08 +0200
Subject: [R-sig-Geo] Problem with readRAST6
In-Reply-To: <alpine.LRH.2.00.1001291317440.31949@reclus.nhh.no>
References: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>
	<alpine.LRH.2.00.1001291317440.31949@reclus.nhh.no>
Message-ID: <fb7c7e871001290434w65cbf4b6l78567be1ded02bec@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/02428fa9/attachment.pl>

From jacobvanetten at yahoo.com  Fri Jan 29 13:50:30 2010
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 29 Jan 2010 04:50:30 -0800 (PST)
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <0838E01493845742A4D4039EA34EB1C1957373@ieopalma2.ba.ieo.es>
Message-ID: <290114.68867.qm@web32907.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/60472567/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 29 13:51:00 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Jan 2010 13:51:00 +0100 (CET)
Subject: [R-sig-Geo] Problem with readRAST6
In-Reply-To: <fb7c7e871001290434w65cbf4b6l78567be1ded02bec@mail.gmail.com>
References: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>
	<alpine.LRH.2.00.1001291317440.31949@reclus.nhh.no>
	<fb7c7e871001290434w65cbf4b6l78567be1ded02bec@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001291339020.31949@reclus.nhh.no>

On Fri, 29 Jan 2010, Rainer M Krug wrote:

> On Fri, Jan 29, 2010 at 2:32 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 29 Jan 2010, Rainer M Krug wrote:
>>
>>  Hi
>>>
>>> I have a question concerning readRAST6 and the plugin. When I use the
>>> default (plugin=NULL), I get the error below,
>>>
>>
>> Well, this does happen. I never knowingly use the plugins for raster or
>> vector any more, because I have multiple GDAL and GRASS installations, and
>> the cross-dependencies take more time to manage than any accruing benefit.
>> Use plugin=TRUE to avoid the sanity check.
>>
>> If you would like to find the cause, please run debug(readRAST6) first,
>> then run the command, and print out the values of gg (returned by gmeta6()),
>> and fninfo (returned by GDALinfo). The values of gg$n and fninfo[5] are
>> found to differ, but gg$w and fninfo[4] not. It could be that fninfo[5] is
>> set wrongly; in GDALinfo, it is:
>>
>>        ysign <- sign(gt[6])
>>        offset.y <- ifelse(ysign < 0, gt[4] + ysign * d[1] *
>>            abs(cellsize[2]), gt[4] + abs(cellsize[2]))
>>
>> where gt is the vector of values returned by RGDAL_GetGeoTransform from the
>> file-specific driver, and d[1] is the number of rows.
>>
>> If you in addition say debug(GDALinfo), and print the values of gt, we
>> could see whether the values seem sane for this driver. They "must" be
>> anyway for reading with plugin=TRUE to work, because they set up the
>> GridTopology for the object read in; checking with gdalinfo of the same
>> raster would also be helpful.
>>
>> Short answer, use plugin=TRUE if you want to use it.
>>
>
> Thanks Roger - I'll probably do that.
>
>
> But what are the advantages / disadvantages of using the plugin or not?


Because the data are read directly from the GRASS GISDBASE file into R 
memory without the writing and reading of an intermediary GTiff/shapefile, 
the plugin may be faster. From earlier discussions on the grass-stats 
list, this is the usual justification.

Roger

>
> Rainer
>
>
>> Hope this helps,
>>
>> Roger
>>
>>
>>
>>>  x <- readRAST6("MASK")
>>>>
>>> raster map/current region mismatch detected in components:
>>>          cols            rows origin.northing  origin.easting
>>>          TRUE            TRUE           FALSE            TRUE
>>> set plugin=TRUE to override; continuing with plugin=FALSE
>>>
>>> I am absolutely sure, that the raster map:
>>>
>>>
>>>  execGRASS("r.info", parameters=list(map="MASK"))
>>>>
>>>
>>> +----------------------------------------------------------------------------+
>>> | Layer:    MASK                           Date: Fri Jan 29 13:19:03 2010
>>> |
>>> | Mapset:   HLsim_Rtmpe2v0qc               Login of Creator: rkrug
>>>  |
>>> | Location: grass
>>> |
>>> | DataBase: /home/rkrug/Documents/Projects/HakeaLandscape/trunc/
>>>  |
>>> | Title:    Reclass of region in HLsim_Rtmpe2v0qc ( MASK )
>>>  |
>>> | Timestamp: none
>>> |
>>>
>>> |----------------------------------------------------------------------------|
>>> |
>>> |
>>> |   Type of Map:  reclass              Number of Categories: 1
>>>  |
>>> |   Data Type:    CELL
>>>  |
>>> |   Rows:         520
>>> |
>>> |   Columns:      192
>>> |
>>> |   Total Cells:  99840
>>> |
>>> |        Projection: UTM (zone -34)
>>> |
>>> |            N:    6247000    S:    6195000   Res:   100
>>>  |
>>> |            E:     270200    W:     251000   Res:   100
>>>  |
>>> |   Range of data:    min = 1  max = 1
>>>  |
>>> |
>>> |
>>> |   Data Source:
>>>  |
>>> |    Reclassified map based on:
>>> |
>>> |      Map [region] in mapset [HLsim_Rtmpe2v0qc]
>>>  |
>>> |
>>> |
>>> |   Data Description:
>>> |
>>> |    generated by r.reclass
>>> |
>>> |
>>> |
>>> |
>>> |
>>>
>>> |----------------------------------------------------------------------------|
>>> |   Reclassification of [region] in mapset [HLsim_Rtmpe2v0qc]
>>> |
>>> |
>>> |
>>> |         Category        Original categories
>>> |
>>> |
>>> |
>>> |          1              1
>>> |
>>>
>>> +----------------------------------------------------------------------------+
>>>
>>>  execGRASS("g.region", flags="p")
>>>>
>>> projection: 1 (UTM)
>>> zone:       -34
>>> datum:      wgs84
>>> ellipsoid:  wgs84
>>> north:      6247000
>>> south:      6195000
>>> west:       251000
>>> east:       270200
>>> nsres:      100
>>>
>>> gdal info:
>>>
>>>  library(rgdal)
>>>>
>>> Loading required package: sp
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.6.3, released 2009/11/19
>>> Path to GDAL shared files: /usr/share/gdal16
>>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009
>>> Path to PROJ.4 shared files: (autodetected)
>>>
>>>  sessionInfo()
>>>>
>>> R version 2.10.1 (2009-12-14)
>>> i486-pc-linux-gnu
>>>
>>> locale:
>>> [1] LC_CTYPE=en_ZA.UTF-8       LC_NUMERIC=C
>>> [3] LC_TIME=en_ZA.UTF-8        LC_COLLATE=en_ZA.UTF-8
>>> [5] LC_MONETARY=C              LC_MESSAGES=en_ZA.UTF-8
>>> [7] LC_PAPER=en_ZA.UTF-8       LC_NAME=C
>>> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_ZA.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] multicore_0.1-3 RSQLite_0.8-0   DBI_0.2-5       spgrass6_0.6-12
>>> [5] XML_2.6-0       maptools_0.7-29 lattice_0.18-3  foreign_0.8-38
>>> [9] simecol_0.6-9   deSolve_1.6     rgdal_0.6-24    sp_0.9-52
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.10.1  tools_2.10.1
>>>
>>>>
>>>>
>>> Cheers,
>>>
>>> Rainer
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.m.krug at gmail.com  Fri Jan 29 13:57:33 2010
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 29 Jan 2010 14:57:33 +0200
Subject: [R-sig-Geo] Problem with readRAST6
In-Reply-To: <alpine.LRH.2.00.1001291339020.31949@reclus.nhh.no>
References: <fb7c7e871001290341r263d602aw14a3fd1959d2f7a4@mail.gmail.com>
	<alpine.LRH.2.00.1001291317440.31949@reclus.nhh.no>
	<fb7c7e871001290434w65cbf4b6l78567be1ded02bec@mail.gmail.com>
	<alpine.LRH.2.00.1001291339020.31949@reclus.nhh.no>
Message-ID: <fb7c7e871001290457t45bd6f2dj23c4f4bf987450ac@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/bff085b4/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 29 15:13:10 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Jan 2010 15:13:10 +0100 (CET)
Subject: [R-sig-Geo] Convert grids with 0/1 attribute to polygons with
 neighbor grids of same values merged
In-Reply-To: <2fc17e31001281625k38031db2n3b63884ffe3c8a6f@mail.gmail.com>
References: <2fc17e31001271913qefd004ejb3fa8e0235081313@mail.gmail.com>
	<2fc17e31001281625k38031db2n3b63884ffe3c8a6f@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001291507510.31949@reclus.nhh.no>

On Thu, 28 Jan 2010, zhijie zhang wrote:

>
>  Sorry. It seems that the above idea is not easy to get through. I tried it
> for some time.
>  Hope Someone else can solve it.

Almost there - you needed:

spol1 <- unionSpatialPolygons(as(spol, "SpatialPolygons"),
   as.character(spol$xvs))

image(grd, axes=TRUE)
plot(spol1, add=TRUE)

to complete, then I guess promotion back to a SpatialPolygonsDataFrame, 
then writing out for each type separately to shapefile.

Roger

>
> On Wed, Jan 27, 2010 at 10:13 PM, zhijie zhang <epistat at gmail.com> wrote:
>
>> Hi,
>>   I cannot successfully do it, but may provide my idea on this. Somebody
>> else may solve it.
>> ###Example Data###
>> library(maptools)
>> gt <- GridTopology(c(0.05,0.05), c(0.1,0.1), c(10,10))
>> xv<-rnorm(length(coordinates(gt)[,1]))
>> xvs<-ifelse(xv>0.2,1,0)
>> grd <- SpatialGridDataFrame(gt,
>> data.frame(xvs),proj4string=CRS(as.character(NA)))
>> #grdM<-as.matrix(data.frame(coordinates(grd),grd at data))
>> #grdM[1:5,]
>> spplot(grd)
>> ####Transform into polygons####
>> spix <- as(grd, "SpatialPixelsDataFrame")
>> spol <- as(spix, "SpatialPolygonsDataFrame")
>> ####Create two subset polygons based on 0 or 1######
>> spol1<-spol[spol$xvs==1,]
>> plot(spol1)  #Four polygons
>> spol0<-spol[spol$xvs==0,]
>> plot(spol0)  #one separate grid and a large irregualr polygon
>> #From their plots,we can see they can merge into four polygons for "spol1"
>> and two polygons for "spol0".
>> ###If we plot their neighbors, it will be more clear to see how many
>> polygons there should be after merging ######
>> library(spdep)
>> nbs<-poly2nb(spol1, queen=TRUE)
>> plot(spol1)  #Four polygons
>> plot.nb(nbs, coordinates(spol1),add=TRUE)
>>
>> nbs2<-poly2nb(spol0, queen=TRUE)
>> plot(spol0)  #Two polygons
>> plot.nb(nbs2, coordinates(spol0),add=TRUE)
>> ###############
>>   I wonder whether it is feasible for the following idea based on the queen
>> neighbors.
>> Step1:We can first select one grid, and merge it with its queen neighbors.
>> Then generate a new polygon for this merged grids.
>> Step2: Continue to merge the newly generated polygon with its queen
>> neighbors. Then generate a newer polygon for these merged grids.
>>   Repeat step1 and step2 until all the related grids were merged. This is
>> one separate large polygon.
>>  Step3: Then select another isolated grid, and repeat the step1 and step2
>> to generate another polygon.
>>   Continue....Until all the separated polygons were merged.That is the
>> queen neighbors will be zero finally.
>>   Is this possible? Hope someone can solve this.
>>   Some other ideas maybe better.
>>
>>
>>
>> On Wed, Jan 27, 2010 at 6:00 AM, <r-sig-geo-request at stat.math.ethz.ch>wrote:
>>
>>> Send R-sig-Geo mailing list submissions to
>>>        r-sig-geo at stat.math.ethz.ch
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>        https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> or, via email, send a message with subject or body 'help' to
>>>        r-sig-geo-request at stat.math.ethz.ch
>>>
>>> You can reach the person managing the list at
>>>        r-sig-geo-owner at stat.math.ethz.ch
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than "Re: Contents of R-sig-Geo digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>   1. Re: rgdal 64bit Windows version? (Rainer Hurling)
>>>   2. Re: points to lines and/or polygons (Roger Bivand)
>>>   3. Distance to (nearest) polygon (Karl Ove Hufthammer)
>>>   4. Re: Distance to (nearest) polygon (Roger Bivand)
>>>   5. maxdist for kriging with an external drift (Els Verfaillie)
>>>   6. Re: maxdist for kriging with an external drift (Edzer Pebesma)
>>>   7. Re: maxdist for kriging with an external drift
>>>      (Cutberto Uriel Paredes Hern?ndez)
>>>   8. Edit a Sptial Lines Object (Rodrigo Aluizio)
>>>   9. Re: maxdist for kriging with an external drift (Edzer Pebesma)
>>>  10. Re: maxdist for kriging with an external drift
>>>      (Paulo Justiniano Ribeiro Jr)
>>>  11. Convert grids with 0/1 attribute to polygons with neighbor
>>>      grids of same values merged (rusers.sh)
>>>  12. Re: complement part of a polygon in another polygon (rusers.sh)
>>>  13. kriging as fish swim, not as crows fly (Martin Renner)
>>>  14. Re: Distance to (nearest) polygon (Karl Ove Hufthammer)
>>>  15. Re: kriging as fish swim, not as crows fly (Michael Sumner)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Tue, 26 Jan 2010 12:01:45 +0100
>>> From: Rainer Hurling <rhurlin at gwdg.de>
>>> To: Michael Sumner <mdsumner at gmail.com>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] rgdal 64bit Windows version?
>>> Message-ID: <4B5ECB99.4040602 at gwdg.de>
>>> Content-Type: text/plain; charset=UTF-8; format=flowed
>>>
>>> Am 25.01.2010 22:25 (UTC+1) schrieb Michael Sumner:
>>>> I suspect you'll need to build GDAL for yourself and then build rgdal
>>>> on top of that, since rgdal depends upon a pre-installation of GDAL.
>>>> The gdal-dev list is the appropriate place for discussing the first
>>>> step.
>>>>
>>>> Colleagues have succesfully built 64-bit Windows GDAL from the 1.6.0
>>>> release using extra binaries (HDF4/5, NetCDF, etc.) from here:
>>>> http://vbkto.dyndns.org:1280/sdk/Default.aspx
>>>
>>> Thanks, Michael, for this interesting link.
>>>
>>> Unfortunately we are not able to build our own versions on windows
>>> machines because of administrative reasons. I will have a look at it in
>>> my spare time ;-)
>>>
>>> Rainer
>>>
>>>> There are notes on build rgdal for Windows here, but I've not done it
>>>> myself for a while:
>>>>
>>>> file.show(system.file("README.windows", package="rgdal"))
>>>>
>>>> I am keen to try this for myself, but it will not be for a while yet.
>>>>
>>>> Best regards,
>>>> Mike
>>>>
>>>> On Tue, Jan 26, 2010 at 8:04 AM, Rainer Hurling<rhurlin at gwdg.de>
>>>  wrote:
>>>>> Some days ago Brian Ripley and Uwe Ligges announced an update to
>>> MinGW-w64
>>>>> builds for 64-bit Windows on R-devel at . This daily version works really
>>> nice.
>>>>> But it is not fully applicable at this time because of some missing
>>>>> packages.
>>>>>
>>>>> I am in particular interested in a 64-bit version of rgdal, which
>>> depends on
>>>>> a 64-bit version of gdal(.dll). Is their anything known about what is
>>>>> planned with this important part of spatial software?
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 2
>>> Date: Tue, 26 Jan 2010 13:54:27 +0100 (CET)
>>> From: Roger Bivand <Roger.Bivand at nhh.no>
>>> To: Agustin Lobo <alobolistas at gmail.com>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] points to lines and/or polygons
>>> Message-ID: <alpine.LRH.2.00.1001261350580.14929 at reclus.nhh.no>
>>> Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
>>>
>>> On Tue, 26 Jan 2010, Agustin Lobo wrote:
>>>
>>>> Hi!
>>>> Package StatDA
>>>> provides background geoinformation as a set of coordinates:
>>>>> str(kola.background)
>>>> List of 4
>>>> $ boundary:'data.frame':       50 obs. of  2 variables:
>>>>  ..$ V1: num [1:50] 388650 388160 386587 384035 383029 ...
>>>>  ..$ V2: num [1:50] 7892400 7881248 7847303 7790797 7769214 ...
>>>> $ coast   :'data.frame':       6259 obs. of  2 variables:
>>>>  ..$ V1: num [1:6259] 438431 439102 439102 439643 439643 ...
>>>>  ..$ V2: num [1:6259] 7895619 7896495 7896495 7895800 7895542 ...
>>>> $ borders :'data.frame':       504 obs. of  2 variables:
>>>>  ..$ V1: num [1:504] 417575 417704 418890 420308 422731 ...
>>>>  ..$ V2: num [1:504] 7612984 7612984 7613293 7614530 7615972 ...
>>>> $ lakes   :'data.frame':       6003 obs. of  2 variables:
>>>>  ..$ V1: num [1:6003] 547972 546915 NA 547972 547172 ...
>>>>  ..$ V2: num [1:6003] 7815109 7815599 NA 7815109 7813873 ...
>>>>
>>>> is there any spatial function aready availale to convert these
>>> coordinates
>>>> into Spatial Lines and Spatial Polygons?
>>>
>>> This seems to work at least for SpatialLines - for polygons, the rings may
>>> need to be closed:
>>>
>>> library(StatDA)
>>> data(kola.background)
>>> xy <- kola.background$boundary
>>> names(xy) <- c("x", "y")
>>> library(maptools)
>>> bdy <- map2SpatialLines(xy)
>>> plot(bdy)
>>>
>>> The data are in the legacy S format (like the maps package).
>>>
>>> Roger
>>>
>>>
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 3
>>> Date: Tue, 26 Jan 2010 16:02:27 +0100
>>> From: Karl Ove Hufthammer <karl at huftis.org>
>>> To: r-sig-geo at stat.math.ethz.ch
>>> Subject: [R-sig-Geo] Distance to (nearest) polygon
>>> Message-ID: <MPG.25c9226ee5625bb49896d3 at news.gmane.org>
>>> Content-Type: text/plain; charset="us-ascii"
>>>
>>> Dear list members
>>>
>>> Is there an easy and preferably fast way to measure the distance from a
>>> of (large) number of points to the nearest polygon? spDistsN1 seems to
>>> only want to measure the distance between points.
>>>
>>> For example, I need the distance between points at sea to the nearest
>>> land area (as defined by for example the 'world' dataset).
>>>
>>> It's not very important which polygon, e.g., country, the given distance
>>> is to. It would be nice if the 'distance' from points that are inside
>>> the polygons were zero or negative, but it's not required -- distance to
>>> the polygon border, e.g., shoreline, would be OK.
>>>
>>> --
>>> Karl Ove Hufthammer
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 4
>>> Date: Tue, 26 Jan 2010 16:27:23 +0100 (CET)
>>> From: Roger Bivand <Roger.Bivand at nhh.no>
>>> To: Karl Ove Hufthammer <karl at huftis.org>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] Distance to (nearest) polygon
>>> Message-ID: <alpine.LRH.2.00.1001261625260.17754 at reclus.nhh.no>
>>> Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
>>>
>>> On Tue, 26 Jan 2010, Karl Ove Hufthammer wrote:
>>>
>>>> Dear list members
>>>>
>>>> Is there an easy and preferably fast way to measure the distance from a
>>>> of (large) number of points to the nearest polygon? spDistsN1 seems to
>>>> only want to measure the distance between points.
>>>>
>>>> For example, I need the distance between points at sea to the nearest
>>>> land area (as defined by for example the 'world' dataset).
>>>>
>>>> It's not very important which polygon, e.g., country, the given distance
>>>> is to. It would be nice if the 'distance' from points that are inside
>>>> the polygons were zero or negative, but it's not required -- distance to
>>>> the polygon border, e.g., shoreline, would be OK.
>>>
>>> There are methods for point to line segment distances in spatstat.
>>> Further, for projected (planar) coordinates, this could be added to
>>> R-Forge rgeos; for geographical coordinates Boost ggl would be needed.
>>>
>>> Roger
>>>
>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 5
>>> Date: Tue, 26 Jan 2010 17:00:29 +0100
>>> From: "Els Verfaillie" <els.verfaillie at ugent.be>
>>> To: <r-sig-geo at stat.math.ethz.ch>
>>> Subject: [R-sig-Geo] maxdist for kriging with an external drift
>>> Message-ID: <005d01ca9ea0$aed17900$0c746b00$@verfaillie at ugent.be>
>>> Content-Type: text/plain
>>>
>>> Dear list,
>>>
>>>
>>>
>>> I want to use Kriging with an external drift for a sedimentological
>>> dataset
>>> of grain-size that has a linear relation with the depth.
>>>
>>> Am I correct that when I set a 'maxdist' using the krige command, that a
>>> trend for the primary variable (grain-size) is calculated as a local
>>> linear
>>> function of the secondary variable (depth)? Is this function thus
>>> different
>>> for each interpolation window?
>>>
>>>
>>>
>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>
>>>
>>>
>>> Thank you for your help.
>>>
>>>
>>>
>>> Best regards,
>>>
>>> Els Verfaillie
>>>
>>>
>>>
>>> ______________________________________________
>>>
>>> Dr. Els Verfaillie
>>>
>>> Carto-GIS cluster
>>>
>>> Ghent University (UGent) - Department of Geography
>>>
>>> ______________________________________________
>>>
>>>
>>>
>>>
>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 6
>>> Date: Tue, 26 Jan 2010 17:05:03 +0100
>>> From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
>>> To: Els Verfaillie <els.verfaillie at ugent.be>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] maxdist for kriging with an external drift
>>> Message-ID: <4B5F12AF.5070302 at uni-muenster.de>
>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>
>>> Yes, that is right.
>>>
>>> Els Verfaillie wrote:
>>>> Dear list,
>>>>
>>>>
>>>>
>>>> I want to use Kriging with an external drift for a sedimentological
>>> dataset
>>>> of grain-size that has a linear relation with the depth.
>>>>
>>>> Am I correct that when I set a 'maxdist' using the krige command, that a
>>>> trend for the primary variable (grain-size) is calculated as a local
>>> linear
>>>> function of the secondary variable (depth)? Is this function thus
>>> different
>>>> for each interpolation window?
>>>>
>>>>
>>>>
>>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>>
>>>>
>>>>
>>>> Thank you for your help.
>>>>
>>>>
>>>>
>>>> Best regards,
>>>>
>>>> Els Verfaillie
>>>>
>>>>
>>>>
>>>> ______________________________________________
>>>>
>>>> Dr. Els Verfaillie
>>>>
>>>> Carto-GIS cluster
>>>>
>>>> Ghent University (UGent) - Department of Geography
>>>>
>>>> ______________________________________________
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 7
>>> Date: Tue, 26 Jan 2010 16:45:00 +0000
>>> From: Cutberto Uriel Paredes Hern?ndez  <cutberto.paredes at gmail.com>
>>> To: Edzer Pebesma <edzer.pebesma at uni-muenster.de>,
>>>        r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] maxdist for kriging with an external drift
>>> Message-ID:
>>>        <8f1fabf91001260845n632ad13ek418a695e27110de8 at mail.gmail.com>
>>> Content-Type: text/plain; charset=ISO-8859-1
>>>
>>> Dear Edzer,
>>>
>>> Would it be correct to say then that if a neighbourhood is specified
>>> in the krige command the result would be that of Kriging with an
>>> External Drift (KED), otherwise it would be that of Simple Kriging
>>> with varying local means (SKlm)?
>>>
>>> Apologies for posting on this thread but I was about to post a
>>> similiar question.
>>>
>>> Thanks, Cutberto.
>>>
>>> 2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>>>> Yes, that is right.
>>>>
>>>> Els Verfaillie wrote:
>>>>>
>>>>> Dear list,
>>>>>
>>>>>
>>>>> I want to use Kriging with an external drift for a sedimentological
>>>>> dataset
>>>>> of grain-size that has a linear relation with the depth.
>>>>> Am I correct that when I set a 'maxdist' using the krige command, that
>>> a
>>>>> trend for the primary variable (grain-size) is calculated as a local
>>>>> linear
>>>>> function of the secondary variable (depth)? Is this function thus
>>>>> different
>>>>> for each interpolation window?
>>>>>
>>>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>>>
>>>>>
>>>>> Thank you for your help.
>>>>>
>>>>>
>>>>> Best regards,
>>>>>
>>>>> Els Verfaillie
>>>>>
>>>>>
>>>>> ______________________________________________
>>>>>
>>>>> Dr. Els Verfaillie
>>>>>
>>>>> Carto-GIS cluster
>>>>>
>>>>> Ghent University (UGent) - Department of Geography
>>>>>
>>>>> ______________________________________________
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler
>>> Stra?e
>>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251
>>> 8339763
>>>> ?http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>>> ?e.pebesma at wwu.de
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 8
>>> Date: Tue, 26 Jan 2010 15:02:40 -0200
>>> From: "Rodrigo Aluizio" <r.aluizio at gmail.com>
>>> To: "R Help" <r-sig-geo at stat.math.ethz.ch>
>>> Subject: [R-sig-Geo] Edit a Sptial Lines Object
>>> Message-ID: <4b5f2052.9c15f10a.7b9d.0861 at mx.google.com>
>>> Content-Type: text/plain; charset="iso-8859-1"
>>>
>>> Hi list, I?m trying to insert some coordinates at the end of an object
>>> (attached) component (BP[1]).
>>>
>>> But I?m not able to do so. I can?t isolate the coordinates, if I use the
>>> ?@lines? it turns into a list, but I need to keep the SpatialLines and S4
>>> structure, then I will be able to transform the closed lines into
>>> polygons.
>>>
>>> So, How can I insert the coordinates that will close the BP[1] line into
>>> this object without changing the object properties. Any Ideas?
>>>
>>> Thank you in advance.
>>>
>>>
>>>
>>> -------------------------------------------------------------
>>>
>>> MSc.  <mailto:r.aluizio at gmail.com> Rodrigo Aluizio
>>>
>>> Centro de Estudos do Mar/UFPR
>>> Laborat?rio de Micropaleontologia
>>> Avenida Beira Mar s/n - CEP 83255-000
>>> Pontal do Paran? - PR - Brasil
>>> Fone: (41) 3511-8657
>>>
>>> Fax: (41) 3455-3623
>>>
>>>
>>>
>>> -------------- next part --------------
>>> An HTML attachment was scrubbed...
>>> URL: <
>>> https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/63ec934e/attachment-0001.html
>>>>
>>> -------------- next part --------------
>>> A non-text attachment was scrubbed...
>>> Name: BP.Rdata
>>> Type: application/octet-stream
>>> Size: 39731 bytes
>>> Desc: not available
>>> URL: <
>>> https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100126/63ec934e/attachment-0001.obj
>>>>
>>>
>>> ------------------------------
>>>
>>> Message: 9
>>> Date: Tue, 26 Jan 2010 21:11:47 +0100
>>> From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
>>> To: Cutberto Uriel Paredes Hern?ndez    <cutberto.paredes at gmail.com>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] maxdist for kriging with an external drift
>>> Message-ID: <4B5F4C83.7040808 at uni-muenster.de>
>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>
>>> Oh, geostatistics and its funny naming conventions!
>>>
>>> I see local models vs. global models as a completely different modelling
>>> aspect (model decision, basically) then the SK/OK/UK differences. When
>>> building on the same tradition / body of literature you quote: in that
>>> case KED would be a special form of UK, having only a single
>>> non-coordinate predictor called 'external drift'.
>>>
>>> In my eyes (and that of the literature with more mathematical
>>> statistical grounding, such as Cressie 1993 and others), the difference
>>> between SK on the one hand and OK/UK on the other is that SK assumes
>>> that you know the mean or mean structure. SKlm is then residual kriging
>>> added to a known mean function.
>>>
>>> In the gstat R package you obtain SK by specifying a beta value (for the
>>> mean); SKlm by specifying one or more predictors and passing the (known)
>>> regression coefficients as beta; you obtain OK/UK by not specifying
>>> beta; a formula ending on ~1 results in OK with an unknown mean only.
>>>
>>> Ah, and then SK = simple kriging, OK = ordinary kriging, UK = universal
>>> kriging.
>>> --
>>> Edzer
>>>
>>> Cutberto Uriel Paredes Hern?ndez wrote:
>>>> Dear Edzer,
>>>>
>>>> Would it be correct to say then that if a neighbourhood is specified
>>>> in the krige command the result would be that of Kriging with an
>>>> External Drift (KED), otherwise it would be that of Simple Kriging
>>>> with varying local means (SKlm)?
>>>>
>>>> Apologies for posting on this thread but I was about to post a
>>>> similiar question.
>>>>
>>>> Thanks, Cutberto.
>>>>
>>>> 2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>>>>
>>>>> Yes, that is right.
>>>>>
>>>>> Els Verfaillie wrote:
>>>>>
>>>>>> Dear list,
>>>>>>
>>>>>>
>>>>>> I want to use Kriging with an external drift for a sedimentological
>>>>>> dataset
>>>>>> of grain-size that has a linear relation with the depth.
>>>>>> Am I correct that when I set a 'maxdist' using the krige command, that
>>> a
>>>>>> trend for the primary variable (grain-size) is calculated as a local
>>>>>> linear
>>>>>> function of the secondary variable (depth)? Is this function thus
>>>>>> different
>>>>>> for each interpolation window?
>>>>>>
>>>>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>>>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>>>>
>>>>>>
>>>>>> Thank you for your help.
>>>>>>
>>>>>>
>>>>>> Best regards,
>>>>>>
>>>>>> Els Verfaillie
>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>>
>>>>>> Dr. Els Verfaillie
>>>>>>
>>>>>> Carto-GIS cluster
>>>>>>
>>>>>> Ghent University (UGent) - Department of Geography
>>>>>>
>>>>>> ______________________________________________
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>        [[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>
>>>>> --
>>>>> Edzer Pebesma
>>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler
>>> Stra?e
>>>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251
>>> 8339763
>>>>>  http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>>>>  e.pebesma at wwu.de
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 10
>>> Date: Tue, 26 Jan 2010 18:31:00 -0200 (BRST)
>>> From: Paulo Justiniano Ribeiro Jr <paulojus at c3sl.ufpr.br>
>>> To: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] maxdist for kriging with an external drift
>>> Message-ID: <alpine.DEB.1.10.1001261822570.28905 at dalmore.c3sl.ufpr.br>
>>> Content-Type: text/plain; charset="iso-8859-1"; Format="flowed"
>>>
>>> May be worth adding here that, despite algorithms and the
>>> "funny naming conventions" (good descrition Edzer!)
>>> SK and others are diferent in the following way:
>>>
>>> SK, as described in Edzer post, assumes you **know** the mean, in other
>>> words, there is no uncertainty about it.
>>> On the other hand, variants such as OK, UK, KED, SKlm uses (explicitly
>>> or implicitly) estimated means.
>>> Therefore, such uncertainty has to be propagated and reflected in the
>>> predictions.
>>>
>>> Suposse the fixed mean in SK is the same as the (implicitly) estimated by
>>> OK. The point predictions will be the same, however, the uncertainty
>>> around them will not (and should not) refleting  the uncertainty (or lack
>>> of it) in the process mean.
>>> The prediction variance expressions for SK ond OK will reflect this
>>> whatever the kriging neighborhood is used.
>>>
>>> best
>>> P.J.
>>>
>>> On Tue, 26 Jan 2010, Edzer Pebesma wrote:
>>>
>>>> Oh, geostatistics and its funny naming conventions!
>>>>
>>>> I see local models vs. global models as a completely different modelling
>>>> aspect (model decision, basically) then the SK/OK/UK differences. When
>>>> building on the same tradition / body of literature you quote: in that
>>> case
>>>> KED would be a special form of UK, having only a single non-coordinate
>>>> predictor called 'external drift'.
>>>>
>>>> In my eyes (and that of the literature with more mathematical
>>> statistical
>>>> grounding, such as Cressie 1993 and others), the difference between SK
>>> on the
>>>> one hand and OK/UK on the other is that SK assumes that you know the
>>> mean or
>>>> mean structure. SKlm is then residual kriging added to a known mean
>>> function.
>>>>
>>>> In the gstat R package you obtain SK by specifying a beta value (for the
>>>> mean); SKlm by specifying one or more predictors and passing the (known)
>>>> regression coefficients as beta; you obtain OK/UK by not specifying
>>> beta; a
>>>> formula ending on ~1 results in OK with an unknown mean only.
>>>>
>>>> Ah, and then SK = simple kriging, OK = ordinary kriging, UK = universal
>>>> kriging.
>>>> --
>>>> Edzer
>>>>
>>>> Cutberto Uriel Paredes Hern?ndez wrote:
>>>>> Dear Edzer,
>>>>>
>>>>> Would it be correct to say then that if a neighbourhood is specified
>>>>> in the krige command the result would be that of Kriging with an
>>>>> External Drift (KED), otherwise it would be that of Simple Kriging
>>>>> with varying local means (SKlm)?
>>>>>
>>>>> Apologies for posting on this thread but I was about to post a
>>>>> similiar question.
>>>>>
>>>>> Thanks, Cutberto.
>>>>>
>>>>> 2010/1/26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>>>>>
>>>>>> Yes, that is right.
>>>>>>
>>>>>> Els Verfaillie wrote:
>>>>>>
>>>>>>> Dear list,
>>>>>>>
>>>>>>>
>>>>>>> I want to use Kriging with an external drift for a sedimentological
>>>>>>> dataset
>>>>>>> of grain-size that has a linear relation with the depth.
>>>>>>> Am I correct that when I set a 'maxdist' using the krige command,
>>> that a
>>>>>>> trend for the primary variable (grain-size) is calculated as a local
>>>>>>> linear
>>>>>>> function of the secondary variable (depth)? Is this function thus
>>>>>>> different
>>>>>>> for each interpolation window?
>>>>>>>
>>>>>>> d50.ked.dir50 <- krige(D50F~depth, locations=ds50, newdata=Depth,
>>>>>>> model=d50.fit.var.50, nmin=2, nmax=16, maxdist=9000)
>>>>>>>
>>>>>>>
>>>>>>> Thank you for your help.
>>>>>>>
>>>>>>>
>>>>>>> Best regards,
>>>>>>>
>>>>>>> Els Verfaillie
>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>>
>>>>>>> Dr. Els Verfaillie
>>>>>>>
>>>>>>> Carto-GIS cluster
>>>>>>>
>>>>>>> Ghent University (UGent) - Department of Geography
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>        [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>>
>>>>>> --
>>>>>> Edzer Pebesma
>>>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler
>>> Stra?e
>>>>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251
>>> 8339763
>>>>>>  http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>>>>>  e.pebesma at wwu.de
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>
>>>>
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics (ifgi), University of M?nster Weseler
>>> Stra?e
>>>> 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251
>>> 8339763
>>>> http://ifgi.uni-muenster.de http://www.52north.org/geostatistics
>>>> e.pebesma at wwu.de
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> Paulo Justiniano Ribeiro Jr
>>> LEG (Laboratorio de Estatistica e Geoinformacao)
>>> Universidade Federal do Parana
>>> Caixa Postal 19.081
>>> CEP 81.531-990
>>> Curitiba, PR  -  Brasil
>>> Tel: (+55) 41 3361 3573
>>> Fax: (+55) 41 3361 3141
>>> e-mail: paulojus AT  ufpr  br
>>> http://www.leg.ufpr.br/~paulojus
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 11
>>> Date: Tue, 26 Jan 2010 22:53:15 -0500
>>> From: "rusers.sh" <rusers.sh at gmail.com>
>>> To: r-sig-geo at stat.math.ethz.ch
>>> Subject: [R-sig-Geo] Convert grids with 0/1 attribute to polygons with
>>>        neighbor grids of same values merged
>>> Message-ID:
>>>        <a835c81e1001261953w69656b0cg3400793f92a4a412 at mail.gmail.com>
>>> Content-Type: text/plain
>>>
>>> Dear all,
>>>  Somebody has discussed the similar question before, "converting grid
>>> objects to spatial polygon objects and export as shapefile (
>>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-December/007163.html)",
>>> where
>>> they have successfully convert the grids into spatial polygons. But the
>>> generated polygons didnot merge any original grids.
>>>   Now, i have a grid dataset, its attribute is 0/1 variable. So finally i
>>> hope to get two shape files, one is its attribute being 0, another
>>> is attribute being 1. But particularly, i hope to merge the grids if their
>>> attribute's values are same, so the final polygon maybe irregular,which is
>>> different from the previous post. Note each shape files may have several
>>> polygons after merging because the grids with same value are not all in
>>> the
>>> similar positions. That means i only want to merge those close grids with
>>> same value in adjacent positions, and not expect to generate a big polygon
>>> with some holes in it.The main problem maybe how to merge those adjacent
>>> grids with same values into polygons.
>>> #Example data
>>> gt <- GridTopology(c(0.05,0.05), c(0.1,0.1), c(10,10))
>>> xv<-rnorm(length(coordinates(gt)[,1]))
>>> xvs<-ifelse(xv>0.2,1,0)
>>> grd <- SpatialGridDataFrame(gt,
>>> data.frame(xvs),proj4string=CRS(as.character(NA)))
>>> grdM<-as.matrix(data.frame(coordinates(grd),grd at data))
>>> grdM[1:5,]
>>>  Any ideas on this? I'd appreciate any suggestions or help.
>>>  Thanks.
>>>
>>> --
>>> -----------------
>>> Jane Chang
>>> Queen's
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 12
>>> Date: Tue, 26 Jan 2010 23:26:18 -0500
>>> From: "rusers.sh" <rusers.sh at gmail.com>
>>> To: Alexandre Villers <alexandre.villersav at laposte.net>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] complement part of a polygon in another
>>>        polygon
>>> Message-ID:
>>>        <a835c81e1001262026ub45a630v8bad1297a756771b at mail.gmail.com>
>>> Content-Type: text/plain
>>>
>>> intersect.owin() works for intersection.
>>>  Say polygon B located inside A. Is there any function in R for us to get
>>> the complement part of  B in  polygon A?
>>>
>>> 2010/1/26 Alexandre Villers <alexandre.villersav at laposte.net>
>>>
>>>> Good morning,
>>>>
>>>> You can have a look at union.owin() and intersection.owin() in spatstat.
>>>> You just need to convert from so objects to spatstat object and back...
>>>> Best regards
>>>>
>>>> Alex
>>>>
>>>>
>>>
>>>
>>> --
>>> -----------------
>>> Jane Chang
>>> Queen's
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 13
>>> Date: Tue, 26 Jan 2010 23:06:41 -0900
>>> From: Martin Renner <martin.renner at stonebow.otago.ac.nz>
>>> To: r-sig-geo at stat.math.ethz.ch
>>> Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
>>> Message-ID:
>>>        <498D5289-7BAA-4D6E-BE6B-F202895BFEF2 at stonebow.otago.ac.nz>
>>> Content-Type: text/plain; charset=us-ascii
>>>
>>> Hi All,
>>>
>>> I want to kirg fish and seabird densities within an estuary which has
>>> several arms. Since neither organisms cross land, the appropriate distances
>>> would not be euclidian but over-water (as fish swim). There are several
>>> papers, describing this problem and how to deal with it (see below), but I
>>> have not found an easily accessible implementation. Is anybody aware of a
>>> solution in R?
>>>
>>> Best,
>>> Martin
>>>
>>>
>>>
>>> @article{Rathbun:1998aa,
>>>        Author = {Rathbun, Stephen L.},
>>>        Journal = {Environmetrics},
>>>        Number = {2},
>>>        Pages = {109--129},
>>>        Title = {Spatial modelling in irregularly shaped regions: kriging
>>> estuaries},
>>>        Volume = {9},
>>>        Year = {1998}}
>>>
>>> @article{Little:1997aa,
>>>        Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne
>>> E.},
>>>        Journal = {Journal of Experimental Marine Biology and Ecology},
>>>        Number = {1},
>>>        Pages = {1--11},
>>>        Title = {Kriging in estuaries: as the crow flies, or as the fish
>>> swims?},
>>>        Volume = {213},
>>>        Year = {1997}}
>>>
>>>
>>>
>>>
>>> Martin Renner
>>> US Geological Survey
>>> Alaska Science Center
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 14
>>> Date: Wed, 27 Jan 2010 10:17:12 +0100
>>> From: Karl Ove Hufthammer <karl at huftis.org>
>>> To: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] Distance to (nearest) polygon
>>> Message-ID: <MPG.25ca23071e15ccd89896d4 at news.gmane.org>
>>> Content-Type: text/plain; charset="us-ascii"
>>>
>>> On Tue, 26 Jan 2010 16:27:23 +0100 (CET) Roger Bivand
>>> <Roger.Bivand at nhh.no> wrote:
>>>
>>>>> For example, I need the distance between points at sea to the nearest
>>>>> land area (as defined by for example the 'world' dataset).
>>>>
>>>> There are methods for point to line segment distances in spatstat.
>>>> Further, for projected (planar) coordinates, this could be added to
>>>> R-Forge rgeos; for geographical coordinates Boost ggl would be needed.
>>>
>>> Thanks. The 'nncross' function in 'spatstat' does essentially do what I
>>> need. Unfortunately, I work with geographical coordinates (spanning
>>> about 15 degrees of latitude), so the results are not perfect (using
>>> plain long/lat coordinates), but they will probably be an adequate
>>> approximation.
>>>
>>> BTW, for my application, I'm not interested in the distance per se, only
>>> in the points (e.g., boats) within a certain distance from the polygon
>>> (land). So I have also thought about a possible solution of using an
>>> expanded polygon, expanded in a certain number of kilometers outwards,
>>> and then using point-in-polygon (i.e., 'overlay') to find the points
>>> that are inside this new polygon. But I couldn't find a function to
>>> 'grow' a polygon in this way.
>>>
>>> --
>>> Karl Ove Hufthammer
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> Message: 15
>>> Date: Wed, 27 Jan 2010 20:29:15 +1100
>>> From: Michael Sumner <mdsumner at gmail.com>
>>> To: Martin Renner <martin.renner at stonebow.otago.ac.nz>
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] kriging as fish swim, not as crows fly
>>> Message-ID:
>>>        <522664f81001270129g2a80ea2n62e8e6c3442fc7e at mail.gmail.com>
>>> Content-Type: text/plain; charset=UTF-8
>>>
>>> Not kriging as such, but check out the soap-film smoothing in package
>>> mgcv:
>>>
>>> http://www.maths.bath.ac.uk/~sw283/simon/papers/soap.pdf
>>>
>>> FWIW, there are binning methods with MCMC in the package
>>> tripEstimation that have similar features, but they are particularly
>>> focussed on individual track estimation and probably not easily
>>> applied. Is location uncertainty a big issue for your data? What are
>>> the input locations?
>>>
>>> Cheers, Mike.
>>>
>>>
>>> On Wed, Jan 27, 2010 at 7:06 PM, Martin Renner
>>> <martin.renner at stonebow.otago.ac.nz> wrote:
>>>> Hi All,
>>>>
>>>> I want to kirg fish and seabird densities within an estuary which has
>>> several arms. Since neither organisms cross land, the appropriate distances
>>> would not be euclidian but over-water (as fish swim). There are several
>>> papers, describing this problem and how to deal with it (see below), but I
>>> have not found an easily accessible implementation. Is anybody aware of a
>>> solution in R?
>>>>
>>>> Best,
>>>> Martin
>>>>
>>>>
>>>>
>>>> @article{Rathbun:1998aa,
>>>> ? ? ? ?Author = {Rathbun, Stephen L.},
>>>> ? ? ? ?Journal = {Environmetrics},
>>>> ? ? ? ?Number = {2},
>>>> ? ? ? ?Pages = {109--129},
>>>> ? ? ? ?Title = {Spatial modelling in irregularly shaped regions: kriging
>>> estuaries},
>>>> ? ? ? ?Volume = {9},
>>>> ? ? ? ?Year = {1998}}
>>>>
>>>> @article{Little:1997aa,
>>>> ? ? ? ?Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne
>>> E.},
>>>> ? ? ? ?Journal = {Journal of Experimental Marine Biology and Ecology},
>>>> ? ? ? ?Number = {1},
>>>> ? ? ? ?Pages = {1--11},
>>>> ? ? ? ?Title = {Kriging in estuaries: as the crow flies, or as the fish
>>> swims?},
>>>> ? ? ? ?Volume = {213},
>>>> ? ? ? ?Year = {1997}}
>>>>
>>>>
>>>>
>>>>
>>>> Martin Renner
>>>> US Geological Survey
>>>> Alaska Science Center
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> End of R-sig-Geo Digest, Vol 77, Issue 24
>>> *****************************************
>>>
>>
>>
>>
>> --
>> With Kind Regards,
>>
>> oooO:::::::::
>> (..):::::::::
>> :\.(:::Oooo::
>> ::\_)::(..)::
>> :::::::)./:::
>> ::::::(_/::::
>> :::::::::::::
>> [***********************************************************************]
>> ZhiJie Zhang ,PhD
>> Dept.of Epidemiology, School of Public Health,Fudan University
>> Office:Room 443, Building 8
>> Office Tel./Fax.:+86-21-54237410
>> Address:No. 138 Yi Xue Yuan Road,Shanghai,China
>> Postcode:200032
>> Email:epistat at gmail.com <Email%3Aepistat at gmail.com>
>> Website: www.statABC.com
>> [***********************************************************************]
>> oooO:::::::::
>> (..):::::::::
>> :\.(:::Oooo::
>> ::\_)::(..)::
>> :::::::)./:::
>> ::::::(_/::::
>> :::::::::::::
>>
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From famuvie at alumni.uv.es  Fri Jan 29 16:44:17 2010
From: famuvie at alumni.uv.es (=?windows-1252?Q?Facundo_Mu=F1oz?=)
Date: Fri, 29 Jan 2010 16:44:17 +0100
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <817DAECA-F1E0-4066-AAF0-D35EDE48411A@stonebow.otago.ac.nz>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
	<4B618618.6080400@alumni.uv.es>
	<817DAECA-F1E0-4066-AAF0-D35EDE48411A@stonebow.otago.ac.nz>
Message-ID: <4B630251.1040306@alumni.uv.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/c5f83b9f/attachment.pl>

From jthayn at ilstu.edu  Fri Jan 29 17:02:04 2010
From: jthayn at ilstu.edu (Jonathan Thayn)
Date: Fri, 29 Jan 2010 10:02:04 -0600
Subject: [R-sig-Geo] NDVI time-series filter
Message-ID: <5CDBB1ED-CA5B-408F-AB22-9654B0019F29@ilstu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/94cf56d9/attachment.pl>

From cedric.briand at lavilaine.com  Fri Jan 29 17:20:46 2010
From: cedric.briand at lavilaine.com (=?iso-8859-1?Q?C=E9dric_Briand?=)
Date: Fri, 29 Jan 2010 17:20:46 +0100
Subject: [R-sig-Geo] rgdal problem when connecting with postgres
Message-ID: <0B5A5F37D041584DA358BC2E1D73A4B502B0C98C54@dc-01.lavilaine.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/b4d4c382/attachment.pl>

From alobolistas at gmail.com  Fri Jan 29 17:27:01 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 29 Jan 2010 17:27:01 +0100
Subject: [R-sig-Geo] Overlay spatial lines on raster
Message-ID: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/8651fb5c/attachment.pl>

From Greg.Snow at imail.org  Fri Jan 29 18:11:24 2010
From: Greg.Snow at imail.org (Greg Snow)
Date: Fri, 29 Jan 2010 10:11:24 -0700
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC62F94CBF92@LP-EXMBVS10.CO.IHC.COM>

Another approach that might be simpler (or it may oversimplify and not give good results) is to compute the distances between your points as the fish swim, then use multi dimensional scaling (cmdscale function or others) to get a set of points that represent those distances and do the rest of your analysis on the transformed points.


-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Martin Renner
> Sent: Wednesday, January 27, 2010 1:07 AM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
> 
> Hi All,
> 
> I want to kirg fish and seabird densities within an estuary which has
> several arms. Since neither organisms cross land, the appropriate
> distances would not be euclidian but over-water (as fish swim). There
> are several papers, describing this problem and how to deal with it
> (see below), but I have not found an easily accessible implementation.
> Is anybody aware of a solution in R?
> 
> Best,
> Martin
> 
> 
> 
> @article{Rathbun:1998aa,
> 	Author = {Rathbun, Stephen L.},
> 	Journal = {Environmetrics},
> 	Number = {2},
> 	Pages = {109--129},
> 	Title = {Spatial modelling in irregularly shaped regions: kriging
> estuaries},
> 	Volume = {9},
> 	Year = {1998}}
> 
> @article{Little:1997aa,
> 	Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne
> E.},
> 	Journal = {Journal of Experimental Marine Biology and Ecology},
> 	Number = {1},
> 	Pages = {1--11},
> 	Title = {Kriging in estuaries: as the crow flies, or as the fish
> swims?},
> 	Volume = {213},
> 	Year = {1997}}
> 
> 
> 
> 
> Martin Renner
> US Geological Survey
> Alaska Science Center
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Fri Jan 29 18:54:56 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 29 Jan 2010 18:54:56 +0100
Subject: [R-sig-Geo] Overlay spatial lines on raster
In-Reply-To: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>
References: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>
Message-ID: <f96702321001290954k3e8bc168w5c94127df68024b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100129/05672d06/attachment.pl>

From r.hijmans at gmail.com  Fri Jan 29 19:00:31 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 29 Jan 2010 10:00:31 -0800
Subject: [R-sig-Geo] Overlay spatial lines on raster
In-Reply-To: <f96702321001290954k3e8bc168w5c94127df68024b@mail.gmail.com>
References: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>
	<f96702321001290954k3e8bc168w5c94127df68024b@mail.gmail.com>
Message-ID: <dc22b2571001291000l31bdb1bbx7dd89fa3d2725e17@mail.gmail.com>

How about something like:

library(raster)
r = linesToRaster(xter, xterpdata, field = "ID" )
v = zonal(xterpdata, r, mean)

v now shold has the mean value of the raster for each line ID and you
can merge those back


On Fri, Jan 29, 2010 at 9:54 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Partially answering myself:
> This is what I've done until now:
>
> xter <-
> readOGR(dsn="/media/Transcend/PROVI/MARICEL2/x_terRiverBasin",layer="x_ter")
>> class(xter)
> [1] "SpatialLinesDataFrame"
> attr(,"package")
> [1] "sp"
>
> xterp <- coordinates(xter)
> xterp <- sapply(xterp, function(x) do.call("rbind", x))
> xterp <- do.call("rbind",xterp)
>
> as told by Roger.
>
> Now:
> require(raster)
> r <- raster("test.tif")
> xterpdata <- xyValues(r,xterp)
> xterp2 <- data.frame(utmx=xterp[,1], utmy=xterp[,2], NO3_2007=xterpdata)
> coordinates(xterp2) <- c("utmx", "utmy")
>
> So I get to step 2, but don't see how to convert from the points
> to the lines again (to get xterl). The problem is that when I did:
> xterp <- sapply(xterp, function(x) do.call("rbind", x))
> xterp <- do.call("rbind",xterp)
>
> I lost the IDs of the lines. So I would need to keep the IDs of the lines
> for each point in the result of
> coordinates() to be able of going back to the lines once I've put the raster
> values in the data slot of the xterp
>
> I'll keep on, but any help would be much appreciated.
>
> Agus
>
> 2010/1/29 Agustin Lobo <alobolistas at gmail.com>
>
>> Hi!
>>
>> My goal is to colorcode a river network according to the values of
>> a raster map (which comes from an interpolation). The spatial lines are
>> imported
>> from a shapefile. The raster could be imported or I could run the
>> interpolation in R.
>>
>> As what I'm planing could be rather involved, I prefer asking before:
>>
>> 1. Convert spatial lines to spatial points as discussed earlier this week.
>> 2. Overlay points on the raster and get the values for the points in a
>> Spatial Points Data Frame
>> 3. Convert the Spatial Points Data Frame into Spatial Lines Data Frame
>> 4. writeOGR() to shapefile.
>>
>> The main question is: is the data frame of the points going to be
>> transferred to the lines
>> at step 3?
>>
>> THnaks
>>
>> Agus
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Fri Jan 29 20:11:19 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Jan 2010 20:11:19 +0100 (CET)
Subject: [R-sig-Geo] rgdal problem when connecting with postgres
In-Reply-To: <0B5A5F37D041584DA358BC2E1D73A4B502B0C98C54@dc-01.lavilaine.local>
References: <0B5A5F37D041584DA358BC2E1D73A4B502B0C98C54@dc-01.lavilaine.local>
Message-ID: <alpine.LRH.2.00.1001292001040.31949@reclus.nhh.no>

On Fri, 29 Jan 2010, C?dric Briand wrote:

> Dear list members
> We are using R 2.10.1 and rgdal Version: 0.6-20, and are working with 
> windows XP.

If you mean the Windows binary rgdal package, then the answer is in

file.show(system.file("README", package="rgdal"))
file.show(system.file("README.windows", package="rgdal"))

The Windows binary package builds the minimal set of drivers, with only 
one external dependency (expat for reading GPX and KML). The file refered 
to describes how you might build rgdal from source, using FWTools or 
OSGEO4W as the provider of GDAL and its dependent DLLs. If you do try this 
out (look for the chunk beginning: "Initial notes for OSGeo4W"), and if:

source(system.file("OSGeo4W_test", package="rgdal"), echo=TRUE)

works, as well as PostGIS access, please let me know.

Roger


> Following the nice example found at 
> http://wiki.intamap.org/index.php/PostGIS<http://wiki.intamap.org/index.php/PostGIS> 
> we tried to connect to our postgres database
>

PS. That example was run on Linux with GDAL built with PostGIS, and rgdal 
installed as a source package.

> library(rgdal)
> trial = readOGR("PG:dbname=CCM", "riversegments")
>
>
> This does not work. We have tried to use ogr2ogr and examples found at
>
> http://www.bostongis.com/?content_name=ogr_cheatsheet
>
> and they work fine particularly we were able to connect to our database using the following script
>
>
> C:\OSGeo4W\bin\ogr2ogr -f "ESRI Shapefile" C:\base\basesig\essai.shp PG:"host=localhost user=postgres dbname=CCM password=postgres port=5433" "riversegments
>
>
>
>
>
> As this works we translated the more complex dsn into the rgdal command line
>
>
>
> require(rgdal)
>
> readOGR(dsn="PG:host=locahost user=postgres dbname=CCM password=postgres port=5433",layer="riversegments")
>
>
>
> but it always returns a "Cannot open file" error :
>
>
>
>> require(rgdal)
>
> Le chargement a n?cessit? le package : rgdal
>
> Le chargement a n?cessit? le package : sp
>
> Geospatial Data Abstraction Library extensions to R successfully loaded
>
> Loaded GDAL runtime: GDAL 1.6.2, released 2009/07/31
>
> Path to GDAL shared files: C:/Program Files/R/R-2.10.0/library/rgdal/gdal
>
> Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008
>
> Path to PROJ.4 shared files: C:/Program Files/R/R-2.10.0/library/rgdal/proj
>
>> readOGR(dsn="PG:host=localhost dbname=CCM user=postgres passwd=postgres port=5433",layer="riversegments")
>
> Erreur dans ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) :   Cannot open file
>
>
> The ogrInfo in command line found at 'C:\OSGeo4W\bin\ogrInfo.exe' does seem to work (it does not return any error)
>
>
>
> The reason behind this failure seems to be that PostgresSQL is not listed in the drivers availaible with the package.
>
>> ogrDrivers()
>
>             name write
>
> 1          AVCBin FALSE
>
> 2          AVCE00 FALSE
>
> 3             BNA  TRUE
>
> 4             CSV  TRUE
>
> 5             DGN  TRUE
>
> 6  ESRI Shapefile  TRUE
>
> 7      Geoconcept  TRUE
>
> 8         GeoJSON  TRUE
>
> 9             GML  TRUE
>
> 10            GMT  TRUE
>
> 11            GPX  TRUE
>
> 12            KML  TRUE
>
> 13   MapInfo File  TRUE
>
> 14         Memory  TRUE
>
> 15            REC FALSE
>
> 16            S57  TRUE
>
> 17           SDTS FALSE
>
> 18          TIGER  TRUE
>
> 19        UK .NTF FALSE
>
> 20            VRT FALSE
>
> 21         XPlane FALSE
>
>
>
> After many trials we are at a loss on how to add a driver to the drivers in R. So any hint would be really valuable.
>
>
>
> C?dric
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From martin.renner at stonebow.otago.ac.nz  Sat Jan 30 04:15:57 2010
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Fri, 29 Jan 2010 18:15:57 -0900
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC62F94CBF92@LP-EXMBVS10.CO.IHC.COM>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC62F94CBF92@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <E69B7E27-36B0-46D5-97D4-92239872B2C5@stonebow.otago.ac.nz>

Hi Gregory,

An ingenious idea! I guess it would work but I'd be a little bit concerned about the alignment of the predicted surface. For now, I'll try Facu's method and see how that goes.

Best,
Martin


On 29 Jan 2010, at 08:11 , Greg Snow wrote:

> Another approach that might be simpler (or it may oversimplify and not give good results) is to compute the distances between your points as the fish swim, then use multi dimensional scaling (cmdscale function or others) to get a set of points that represent those distances and do the rest of your analysis on the transformed points.
> 
> 
> -- 
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
> 
> 
>> -----Original Message-----
>> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
>> bounces at stat.math.ethz.ch] On Behalf Of Martin Renner
>> Sent: Wednesday, January 27, 2010 1:07 AM
>> To: r-sig-geo at stat.math.ethz.ch
>> Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
>> 
>> Hi All,
>> 
>> I want to kirg fish and seabird densities within an estuary which has
>> several arms. Since neither organisms cross land, the appropriate
>> distances would not be euclidian but over-water (as fish swim). There
>> are several papers, describing this problem and how to deal with it
>> (see below), but I have not found an easily accessible implementation.
>> Is anybody aware of a solution in R?
>> 
>> Best,
>> Martin
>> 
>> 
>> 
>> @article{Rathbun:1998aa,
>> 	Author = {Rathbun, Stephen L.},
>> 	Journal = {Environmetrics},
>> 	Number = {2},
>> 	Pages = {109--129},
>> 	Title = {Spatial modelling in irregularly shaped regions: kriging
>> estuaries},
>> 	Volume = {9},
>> 	Year = {1998}}
>> 
>> @article{Little:1997aa,
>> 	Author = {Little, Laurie S. and Edwards, Don and Porter, Dwayne
>> E.},
>> 	Journal = {Journal of Experimental Marine Biology and Ecology},
>> 	Number = {1},
>> 	Pages = {1--11},
>> 	Title = {Kriging in estuaries: as the crow flies, or as the fish
>> swims?},
>> 	Volume = {213},
>> 	Year = {1997}}
>> 
>> 
>> 
>> 
>> Martin Renner
>> US Geological Survey
>> Alaska Science Center
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From paulo.mailing.list at gmail.com  Sat Jan 30 09:45:34 2010
From: paulo.mailing.list at gmail.com (Paulo Eduardo Cardoso)
Date: Sat, 30 Jan 2010 08:45:34 +0000
Subject: [R-sig-Geo] plot polygons - transparent holes/island
Message-ID: <e805f391001300045o1d17574fwa7dec7710cde2c64@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100130/59d4ce11/attachment.pl>

From hengl at spatial-analyst.net  Sat Jan 30 10:29:19 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Sat, 30 Jan 2010 10:29:19 +0100
Subject: [R-sig-Geo] NDVI time-series filter
In-Reply-To: <5CDBB1ED-CA5B-408F-AB22-9654B0019F29@ilstu.edu>
References: <5CDBB1ED-CA5B-408F-AB22-9654B0019F29@ilstu.edu>
Message-ID: <000001caa18e$b2f4b510$18de1f30$@net>


Dear Jonathan,

Interesting topic. Please send us also your code example and if possible part of your dataset (I assume it is a SpatialGridDataFrame?).

Operations on lists can be speed up by using lapply and by implementing your own functions, consider also running Rprof to check which operation is using the most time (read more in "R inferno" or e.g. here: http://manuals.bioinformatics.ucr.edu/home/programming-in-r#Progr_noloops), eventually if the operation is so complex, you simply cannot anticipate to have the results within few minutes (except if you try using super or grid computing; see http://cran.r-project.org/web/views/HighPerformanceComputing.html).

HTH,

T. Hengl
http://home.medewerker.uva.nl/t.hengl/ 


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Jonathan Thayn
> Sent: Friday, January 29, 2010 5:02 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] NDVI time-series filter
> 
> I need to smooth a collection of annual NDVI time-series data for a fairly large
> image. Right now I am using an interruptive method that compares the difference
> between each point and the mean of its two neighbors. This process repeats until
> a threshold is reached. It works well, but it takes a long time. When I process
> the image without smoothing the data it takes about 2 hours ? with the smoothing
> it looks like it will take up to 7 days.
> 
> The method needs to elevate troughs in the data but retain the peaks ? I assume
> that any troughs are really cloud contamination and that the peaks are accurate
> NDVI values. Does anyone know of such a smoother that isn't so time consuming?
> 
> 
> Jonathan B. Thayn, Ph.D.
> Illinois State University
> Department of Geography - Geology
> 200A Felmley Hall
> Normal, Illinois 61790-4400
> 
> (309) 438-8112
> jthayn at ilstu.edu
> my.ilstu.edu/~jthayn
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]


From famuvie at alumni.uv.es  Sat Jan 30 10:55:37 2010
From: famuvie at alumni.uv.es (=?windows-1252?Q?Facundo_Mu=F1oz?=)
Date: Sat, 30 Jan 2010 10:55:37 +0100
Subject: [R-sig-Geo] kriging as fish swim, not as crows fly
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC62F94CBF92@LP-EXMBVS10.CO.IHC.COM>
References: <498D5289-7BAA-4D6E-BE6B-F202895BFEF2@stonebow.otago.ac.nz>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC62F94CBF92@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <4B640219.2090704@alumni.uv.es>

Multidimensional Scaling (MDS) is certainly an option to be considered.
Its suitability depends, of course, on the specific application.

In my case, which is conceptually similar to Martin's, that option was 
discarded.
And I think I can explain why whith this single image:

http://www.geeitema.org/doc/guenmap/docs/distances.gif

Here, three types of distances between all pairs from a set of points 
are compared.
The reference distance (red) is the "cost based" distance (or "water 
distance"), which is the minimum distance measured within the 
"permisible" region (i.e. "as the fish swims").
In black are represented the corresponding euclidean distances, while in 
blue, the corresponding MDS distances (in 2D).

As you can see, the MDS approach corrects the "bias" in the long terrm.
However the variability around the "correct" value holds.

So, while it provides the best overall euclidean approximation, it does 
not account for the behaviour due to the shape of the region.
Since the latter was what we was looking for, we discarded this approach.

One could try to use MDS with higher dimension. But it does not improve 
things very much, specially if you have regions with "holes".
Distances in such regions don't have an euclidean representation 
regardless of the dimension.

Bests
?acu.-


Greg Snow escribi?:
> Another approach that might be simpler (or it may oversimplify and not give good results) is to compute the distances between your points as the fish swim, then use multi dimensional scaling (cmdscale function or others) to get a set of points that represent those distances and do the rest of your analysis on the transformed points.
>
>
>


From alobolistas at gmail.com  Sat Jan 30 14:03:39 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 30 Jan 2010 14:03:39 +0100
Subject: [R-sig-Geo] Overlay spatial lines on raster
In-Reply-To: <dc22b2571001291000l31bdb1bbx7dd89fa3d2725e17@mail.gmail.com>
References: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>
	<f96702321001290954k3e8bc168w5c94127df68024b@mail.gmail.com>
	<dc22b2571001291000l31bdb1bbx7dd89fa3d2725e17@mail.gmail.com>
Message-ID: <f96702321001300503o4e96ff1j492da3888527e859@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100130/2ed2863e/attachment.pl>

From Roger.Bivand at nhh.no  Sat Jan 30 15:08:55 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 30 Jan 2010 15:08:55 +0100 (CET)
Subject: [R-sig-Geo] plot polygons - transparent holes/island
In-Reply-To: <e805f391001300045o1d17574fwa7dec7710cde2c64@mail.gmail.com>
References: <e805f391001300045o1d17574fwa7dec7710cde2c64@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001301458340.5068@reclus.nhh.no>

On Sat, 30 Jan 2010, Paulo Eduardo Cardoso wrote:

> I'd like to plot a SPDF with two objects, one of them buffering the other
> "island". How can I set the "island" transparent?
> Similarly, keeping the outer polygon only, how can the hole still
> transparent?

Polygons objects are plotted largest to smallest, as are Polygon objects 
in each Polygons object. Each Polygons object and all its constituent 
Polygon objects are painted the colour chosen for that Polygons object.

If you want the holes Polygon objects to overpaint their containing 
Polygon objects, in the base graphics plot() method, you set the pbg= 
argument to the background colour (not "transparent", this will let you 
see the painted Polygon below). In the spplot method, this is handled 
internally by reading the trellis.par.get()$background value, and using it 
if not "transparent", or "white" if it is "transparent".

Both approaches depend on the hole slot of the Polygon object being 
correctly set.

R graphics do not analyse objects leaving out say holes, they overpaint. 
This is because the holes are not "known" in advance by the functions 
being executed.

Hope this helps,

Roger

>
> Thanks in advance,
>
> Paulo E. Cardoso
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Sun Jan 31 01:57:15 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 30 Jan 2010 16:57:15 -0800
Subject: [R-sig-Geo] Overlay spatial lines on raster
In-Reply-To: <f96702321001300503o4e96ff1j492da3888527e859@mail.gmail.com>
References: <f96702321001290827ka7f8fd0s3cb68714da23e19d@mail.gmail.com>
	<f96702321001290954k3e8bc168w5c94127df68024b@mail.gmail.com>
	<dc22b2571001291000l31bdb1bbx7dd89fa3d2725e17@mail.gmail.com>
	<f96702321001300503o4e96ff1j492da3888527e859@mail.gmail.com>
Message-ID: <dc22b2571001301657u1f292750udf8aeaaae0222ca7@mail.gmail.com>

Hi Agus, thank you. You were right about the cause of the problem ---
I patched it in version 0.9.9-5, now on R-Forge (and should be
available for automatic install within 24 hours); the function could
use some optimization for speed but at least it works now for
SpatialLines* with a larger extent then the target RasterLayer.

# simple example
library(raster)
library(maptools)
data(wrld_simpl)
r = raster(xmn=-10, xmx=20, ymn=37, ymx=43, ncol=360, nrow=72)
r = linesToRaster(wrld_simpl, r, progress='text')
plot(r)
plot(wrld_simpl, add=T)


# example using zonal as I proposed in your original question, but
here with polygonsToRaster
# What is (roughly) the mean latitude of each country?

x = raster()
# res(x) = 0.1    # higher res, slower, but more small countries are included
x = polygonsToRaster(wrld_simpl, x, progress='text')
y = raster(x)
y[] = rep(yFromRow(y, 1:nrow(y)), each=ncol(y))
z = zonal(y, x, mean)
res= data.frame(wrld_simpl[z[,'zone'], 'NAME'], lat=z[,2])
res[order(res[,2]), ]

Robert



On Sat, Jan 30, 2010 at 5:03 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Thanks Robert,
>
> The raster package is a magician's chest!
> I get an error, though:
>
>> class(xter)
> [1] "SpatialLinesDataFrame"
> attr(,"package")
> [1] "sp"
>
>> class(r)
> [1] "RasterLayer"
> attr(,"package")
> [1] "raster"
>
>> lr = linesToRaster(xter, r, field = "ID_GRAFIC" )
> [1] "A"
> ???? rows cols
> [1,]??? 1?? -1
> [2,]?? -1?? -1
> ???????? [,1]??? [,2]
> [1,] 413809.3 4685685
> [1]? 413786.5 4685646.9? 413810.1 4685686.4
> Error in col1:col2 : NA/NaN argument
> Calls: linesToRaster -> .getCols
>
> I think because the extent of the raster is smaller than the extent of the
> lines
>> extent(xter)
> class?????? : Extent
> xmin??????? : 412792
> xmax??????? : 517648.1
> ymin??????? : 4624794
> ymax??????? : 4698657
>
>> extent(r)
> class?????? : Extent
> xmin??????? : 424389
> xmax??????? : 512711
> ymin??????? : 4636016
> ymax??????? : 4685685
>
> which I can visualize with:
>> plot(extent(xter))
>> plot(extent(r),col="red",add=T)
>
> The problem is that I cannot find the way to clip xter to the extent of r.
> pruneMap() assumes a map object and
> I guess that we cannot convert from Spatial Lines to map.
>
> I've tried
>> delme <- xter
>> delme at bbox <- bbox(r)
>
> but still get the same problem:
>> lr = linesToRaster(delme, r, field = "ID_GRAFIC" )
> [1] "A"
> ???? rows cols
> [1,]??? 1?? -1
> [2,]?? -1?? -1
> ???? [,1] [,2]
> [1,]?? NA?? NA
> [1]? 413786.5 4685646.9? 413810.1 4685686.4
> Error in col1:col2 : NA/NaN argument
> Calls: linesToRaster -> .getCols
>
> Agus
>
> 2010/1/29 Robert J. Hijmans <r.hijmans at gmail.com>
>>
>> How about something like:
>>
>> library(raster)
>> r = linesToRaster(xter, xterpdata, field = "ID" )
>> v = zonal(xterpdata, r, mean)
>>
>> v now shold has the mean value of the raster for each line ID and you
>> can merge those back
>>
>>
>> On Fri, Jan 29, 2010 at 9:54 AM, Agustin Lobo <alobolistas at gmail.com>
>> wrote:
>> > Partially answering myself:
>> > This is what I've done until now:
>> >
>> > xter <-
>> >
>> > readOGR(dsn="/media/Transcend/PROVI/MARICEL2/x_terRiverBasin",layer="x_ter")
>> >> class(xter)
>> > [1] "SpatialLinesDataFrame"
>> > attr(,"package")
>> > [1] "sp"
>> >
>> > xterp <- coordinates(xter)
>> > xterp <- sapply(xterp, function(x) do.call("rbind", x))
>> > xterp <- do.call("rbind",xterp)
>> >
>> > as told by Roger.
>> >
>> > Now:
>> > require(raster)
>> > r <- raster("test.tif")
>> > xterpdata <- xyValues(r,xterp)
>> > xterp2 <- data.frame(utmx=xterp[,1], utmy=xterp[,2], NO3_2007=xterpdata)
>> > coordinates(xterp2) <- c("utmx", "utmy")
>> >
>> > So I get to step 2, but don't see how to convert from the points
>> > to the lines again (to get xterl). The problem is that when I did:
>> > xterp <- sapply(xterp, function(x) do.call("rbind", x))
>> > xterp <- do.call("rbind",xterp)
>> >
>> > I lost the IDs of the lines. So I would need to keep the IDs of the
>> > lines
>> > for each point in the result of
>> > coordinates() to be able of going back to the lines once I've put the
>> > raster
>> > values in the data slot of the xterp
>> >
>> > I'll keep on, but any help would be much appreciated.
>> >
>> > Agus
>> >
>> > 2010/1/29 Agustin Lobo <alobolistas at gmail.com>
>> >
>> >> Hi!
>> >>
>> >> My goal is to colorcode a river network according to the values of
>> >> a raster map (which comes from an interpolation). The spatial lines are
>> >> imported
>> >> from a shapefile. The raster could be imported or I could run the
>> >> interpolation in R.
>> >>
>> >> As what I'm planing could be rather involved, I prefer asking before:
>> >>
>> >> 1. Convert spatial lines to spatial points as discussed earlier this
>> >> week.
>> >> 2. Overlay points on the raster and get the values for the points in a
>> >> Spatial Points Data Frame
>> >> 3. Convert the Spatial Points Data Frame into Spatial Lines Data Frame
>> >> 4. writeOGR() to shapefile.
>> >>
>> >> The main question is: is the data frame of the points going to be
>> >> transferred to the lines
>> >> at step 3?
>> >>
>> >> THnaks
>> >>
>> >> Agus
>> >>
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at stat.math.ethz.ch
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>
>


From paulo.mailing.list at gmail.com  Sun Jan 31 02:01:31 2010
From: paulo.mailing.list at gmail.com (Paulo Eduardo Cardoso)
Date: Sun, 31 Jan 2010 01:01:31 +0000
Subject: [R-sig-Geo] plot polygons - transparent holes/island
In-Reply-To: <alpine.LRH.2.00.1001301458340.5068@reclus.nhh.no>
References: <e805f391001300045o1d17574fwa7dec7710cde2c64@mail.gmail.com>
	<alpine.LRH.2.00.1001301458340.5068@reclus.nhh.no>
Message-ID: <e805f391001301701p725ca5adu4095c035f8b6262a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100131/88727931/attachment.pl>

From rusers.sh at gmail.com  Sun Jan 31 04:41:33 2010
From: rusers.sh at gmail.com (rusers.sh)
Date: Sat, 30 Jan 2010 22:41:33 -0500
Subject: [R-sig-Geo] generate simulation data for a theoretical spatial model
Message-ID: <a835c81e1001301941o3497c7a7q7ec94b89f5574ed3@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100130/39d101fa/attachment.pl>

From hengl at spatial-analyst.net  Sun Jan 31 10:11:47 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Sun, 31 Jan 2010 10:11:47 +0100
Subject: [R-sig-Geo] generate simulation data for a theoretical spatial
 model
Message-ID: <4B654953.4070102@spatial-analyst.net>


Dear rusers.sh,

Here are few simple examples of how to simulate (not-normal)
distributions and point processes using geoR and spatstat:

http://spatial-analyst.net/book/node/388

See also:

http://leg.ufpr.br/geoR/geoRdoc/vignette/geoRintro/geoRintrose8.html#x9-120008

I guess that covariates can be also included (I guess that you then need
to switch to conditional simulations - not sure).

This should also work for lattice (polygon) data so that you will have
jumps in values (but I guess you would still work in gridded systems?).

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


rusers.sh wrote:
> Hi all,
>   In classical statistics, we always need to generate a theoretical model
> such as y=a+b1*x1+b2*x2+e to study some new estimation content. I am
> wondering how to generate the similar spatial dataset for a theoretical
> model.
> Say y is response variable, x1 and x2 are explanatory variables.
> 1. If y is a continous variable, how should we generate the dataset for a
> theoretical spatial point process model in R?
> 2. If y is a continous variable, how should we generate the dataset for a
> theoretical spatial lattice data model in R?
> 3. If y is 0/1 binary variable, how should we generate the dataset for a
> theoretical spatial point process model in R?
> 4. If y is 0/1 binary variable, how should we generate the dataset for a
> ttheoretical spatial lattice data in R?
>   spatstat and other packages allow us to generate a dataset of a specified
> point process and other models, but it seems that they donot allow us to
> include possible explanatory variables into a theoretical model. Maybe i
> missed some ideas in them.
>   Anybody can express some ideas or point out some useful resources on the
> above four different situations? Small examples in R are preferred.
>   Thanks a lot.
>


From Roger.Bivand at nhh.no  Sun Jan 31 11:16:34 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 31 Jan 2010 11:16:34 +0100 (CET)
Subject: [R-sig-Geo] plot polygons - transparent holes/island
In-Reply-To: <e805f391001301701p725ca5adu4095c035f8b6262a@mail.gmail.com>
References: <e805f391001300045o1d17574fwa7dec7710cde2c64@mail.gmail.com>
	<alpine.LRH.2.00.1001301458340.5068@reclus.nhh.no>
	<e805f391001301701p725ca5adu4095c035f8b6262a@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1001311115220.9029@reclus.nhh.no>

On Sun, 31 Jan 2010, Paulo Eduardo Cardoso wrote:

> Roger,
>
> I really thank you for you comments. You are always available to explain
> everything, and that's a fortune for forum users.
> But I still with the same problem. I did,'t understand how to leave the
> inner hole or the inner polygon transparent, in order to see any other layer
> plotter at first.
> Should I send a simple example?

Please do, either code for a provided data set, or code and a link to the 
URL where the data set is available.

Roger

>
> 2010/1/30 Roger Bivand <Roger.Bivand at nhh.no>
>
>> On Sat, 30 Jan 2010, Paulo Eduardo Cardoso wrote:
>>
>>  I'd like to plot a SPDF with two objects, one of them buffering the other
>>> "island". How can I set the "island" transparent?
>>> Similarly, keeping the outer polygon only, how can the hole still
>>> transparent?
>>>
>>
>> Polygons objects are plotted largest to smallest, as are Polygon objects in
>> each Polygons object. Each Polygons object and all its constituent Polygon
>> objects are painted the colour chosen for that Polygons object.
>>
>> If you want the holes Polygon objects to overpaint their containing Polygon
>> objects, in the base graphics plot() method, you set the pbg= argument to
>> the background colour (not "transparent", this will let you see the painted
>> Polygon below). In the spplot method, this is handled internally by reading
>> the trellis.par.get()$background value, and using it if not "transparent",
>> or "white" if it is "transparent".
>>
>> Both approaches depend on the hole slot of the Polygon object being
>> correctly set.
>>
>> R graphics do not analyse objects leaving out say holes, they overpaint.
>> This is because the holes are not "known" in advance by the functions being
>> executed.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> Thanks in advance,
>>>
>>> Paulo E. Cardoso
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From cedric.briand at lavilaine.com  Sun Jan 31 22:27:31 2010
From: cedric.briand at lavilaine.com (=?iso-8859-1?Q?C=E9dric_Briand?=)
Date: Sun, 31 Jan 2010 22:27:31 +0100
Subject: [R-sig-Geo] RE :  rgdal problem when connecting with postgres
In-Reply-To: <alpine.LRH.2.00.1001292001040.31949@reclus.nhh.no>
References: <0B5A5F37D041584DA358BC2E1D73A4B502B0C98C54@dc-01.lavilaine.local>,
	<alpine.LRH.2.00.1001292001040.31949@reclus.nhh.no>
Message-ID: <0B5A5F37D041584DA358BC2E1D73A4B502B0CEC5EC@dc-01.lavilaine.local>

Dear Roger

Thank you for your answer. 

I have done the following :
-----------------------------------------
Run in OSGeo4W console, after setting:
set OSGEO4W_BUILD=yes
set GDAL_HOME=%OSGEO4W_ROOT%
download rgdal sources
cd C:/rgdal/src
using visuel c++ (vc9) command line
cl /MT /Ox /EHsc /D "WIN32" /c /I "C:/Program Files/R/R-2.10.1/include" /I C:/OSGeo4W/include /I "C:\Program Files\Microsoft Visual Studio 9.0\VC\include" /D OSGEO4W *.cpp
-------------------------------------------------------
at this point, following your insctructions,  I need a rdll.lib, and was not able to produce it ...

I understand I have to download the source and try the following code, but it fails. 

C:\R-2.10.1\src\gnuwin32>make R.exp
-------------------------------------------------
gcc -std=gnu99 -I../include -I. -I../extra -DHAVE_CONFIG_H -DR_DLL_BUILD  -O3 -W
all -pedantic   -c console.c -o console.o
console.c:23:20: error: config.h: No such file or directory
console.c:73: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'Ch
aracterMode'
console.c: In function 'console_normalkeyin':
console.c:1357: error: 'CharacterMode' undeclared (first use in this function)
console.c:1357: error: (Each undeclared identifier is reported only once
console.c:1357: error: for each function it appears in.)
console.c:1357: error: 'RGui' undeclared (first use in this function)
make: *** [console.o] Error 1
---------------------------------------------------
C?dric

________________________________________
De : Roger Bivand [Roger.Bivand at nhh.no]
Date d'envoi : vendredi 29 janvier 2010 20:11
? : C?dric Briand
Cc : r-sig-geo at stat.math.ethz.ch
Objet : Re: [R-sig-Geo] rgdal problem when connecting with postgres

On Fri, 29 Jan 2010, C?dric Briand wrote:

> Dear list members
> We are using R 2.10.1 and rgdal Version: 0.6-20, and are working with
> windows XP.

If you mean the Windows binary rgdal package, then the answer is in

file.show(system.file("README", package="rgdal"))
file.show(system.file("README.windows", package="rgdal"))

The Windows binary package builds the minimal set of drivers, with only
one external dependency (expat for reading GPX and KML). The file refered
to describes how you might build rgdal from source, using FWTools or
OSGEO4W as the provider of GDAL and its dependent DLLs. If you do try this
out (look for the chunk beginning: "Initial notes for OSGeo4W"), and if:

source(system.file("OSGeo4W_test", package="rgdal"), echo=TRUE)

works, as well as PostGIS access, please let me know.

Roger


> Following the nice example found at
> http://wiki.intamap.org/index.php/PostGIS<http://wiki.intamap.org/index.php/PostGIS>
> we tried to connect to our postgres database
>

PS. That example was run on Linux with GDAL built with PostGIS, and rgdal
installed as a source package.

> library(rgdal)
> trial = readOGR("PG:dbname=CCM", "riversegments")
>
>
> This does not work. We have tried to use ogr2ogr and examples found at
>
> http://www.bostongis.com/?content_name=ogr_cheatsheet
>
> and they work fine particularly we were able to connect to our database using the following script
>
>
> C:\OSGeo4W\bin\ogr2ogr -f "ESRI Shapefile" C:\base\basesig\essai.shp PG:"host=localhost user=postgres dbname=CCM password=postgres port=5433" "riversegments
>
>
>
>
>
> As this works we translated the more complex dsn into the rgdal command line
>
>
>
> require(rgdal)
>
> readOGR(dsn="PG:host=locahost user=postgres dbname=CCM password=postgres port=5433",layer="riversegments")
>
>
>
> but it always returns a "Cannot open file" error :
>
>
>
>> require(rgdal)
>
> Le chargement a n?cessit? le package : rgdal
>
> Le chargement a n?cessit? le package : sp
>
> Geospatial Data Abstraction Library extensions to R successfully loaded
>
> Loaded GDAL runtime: GDAL 1.6.2, released 2009/07/31
>
> Path to GDAL shared files: C:/Program Files/R/R-2.10.0/library/rgdal/gdal
>
> Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008
>
> Path to PROJ.4 shared files: C:/Program Files/R/R-2.10.0/library/rgdal/proj
>
>> readOGR(dsn="PG:host=localhost dbname=CCM user=postgres passwd=postgres port=5433",layer="riversegments")
>
> Erreur dans ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) :   Cannot open file
>
>
> The ogrInfo in command line found at 'C:\OSGeo4W\bin\ogrInfo.exe' does seem to work (it does not return any error)
>
>
>
> The reason behind this failure seems to be that PostgresSQL is not listed in the drivers availaible with the package.
>
>> ogrDrivers()
>
>             name write
>
> 1          AVCBin FALSE
>
> 2          AVCE00 FALSE
>
> 3             BNA  TRUE
>
> 4             CSV  TRUE
>
> 5             DGN  TRUE
>
> 6  ESRI Shapefile  TRUE
>
> 7      Geoconcept  TRUE
>
> 8         GeoJSON  TRUE
>
> 9             GML  TRUE
>
> 10            GMT  TRUE
>
> 11            GPX  TRUE
>
> 12            KML  TRUE
>
> 13   MapInfo File  TRUE
>
> 14         Memory  TRUE
>
> 15            REC FALSE
>
> 16            S57  TRUE
>
> 17           SDTS FALSE
>
> 18          TIGER  TRUE
>
> 19        UK .NTF FALSE
>
> 20            VRT FALSE
>
> 21         XPlane FALSE
>
>
>
> After many trials we are at a loss on how to add a driver to the drivers in R. So any hint would be really valuable.
>
>
>
> C?dric
>
>
>
>
>       [[alternative HTML version deleted]]
>
>

--
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

