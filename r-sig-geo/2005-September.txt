From Roger.Bivand at nhh.no  Mon Sep  5 09:26:29 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Sep 2005 09:26:29 +0200 (CEST)
Subject: [R-sig-Geo] your mail
In-Reply-To: <4.3.1.20050901152914.00a84270@192.168.1.1>
Message-ID: <Pine.LNX.4.44.0509050822580.32566-100000@reclus.nhh.no>

Dear Md. Moshiur Rahman,

You sent your question to the list administrator, not to the list, so I am 
sending my reply to you and the list.

The simple answer is at the end, but first the complicated answer ...

It would be useful to know which file formats you have access to for your 
data. 

You are correct in saying that the e00 and binary coverages are from
Arc/Info, which many years ago ran only on minicomputers under many
operating systems (Unix, Vax VMS, ...), but never Windows nor Linux (PC
ArcInfo was a different programme running under DOS and 16-bit Windows up
to Windows 95).

ArcView was never more than a "viewer" when first designed, but ESRI - the 
authors of Arc/Info - found that their main customers wanted a 
Windows-based product. For this reason, the newer ArcGIS only runs on 
Windows (I believe), and can use both the legacy e00 and binary coverages 
inherited from Arc/Info, and the simple shapefile format added to ArcView 
as it developed.

The difference between the e00/binary coverage format and shapefiles is
that the former, original Arc/Info files describe the geometry of the
stored objects in a more complicted way. Each line is only stored once,
and the "arc/node" data model builds the lines into more complex
structures - indeed, the product names Arc/Info, ArcView, and ArcGIS refer
directly to the use of this structure. Shapefiles just contain lines or
ring polygons for each object, so contiguous objects have duplicated
border lines in the data.

If the only software you have is ArcView 3.2, then it is possible that the
data representation you have is as shapefiles for ArcView. 

PC ArcInfo 3.5.1 seems to have been discontinued in about 1999, and I
cannot find any documentation on its vector file formats. If PC ArcInfo
3.5.1 can exchange data with ArcView 3.2, then you can move your data to
the shapefile format. There is also a legacy format UNGEN used in
Arc/Info, which may allow you to export data from PC ArcInfo. This format
is described at:

http://www.census.gov/geo/www/cob/ascii_info.html

Since it is an ASCII format, it should be possible to write simple 
functions to read UNGEN (Ungenerate) geometry data into R, but if you have 
not written R functions using connections and readLines() before, you may 
need help.

The simple answer: if you have your data in ArcView already, then I
suggest you read ArcView shapefiles into R, using the maptools package (or
alternatively the shapefiles package), both on CRAN.

Hope this helps,

Roger Bivand


On Mon, 5 Sep 2005, Md. Moshiur Rahman PhD wrote:

> 
> I am a faculty of Department of Statistics, Jahangirnagar University of 
> BANGLADESH.
> 
> Presently I am trying to use RArcInfo in R of Windows version, but the 
> problem I faced is that I cannot import coverage file of Bangladesh. One of 
> my fellow colleague in the Department of Geography are using WINDOWS 
> version ArcView GIS 3.2 and ArcInfo 3.5.1.
> 
> Following lines are from RArcInfo help pages:
> avctoe00                : Converts a ARC/INFO binary coverage into an ESRI 
> E00 file
> e00toavc                : Converts an ESRI E00 file into an Arc/Info V 7.x 
> binary coverage
> read.coverage   :  Function for retrieving basic data from a given coverage
> 
> My colleague informed me that he cannot make ESRI E00 file or ARC/INFO 
> binary coverage in Windows version of ArcView GIS 3.2 and ArcInfo 3.5.1. He 
> also told me that E00 and Arc/Info V 7.x binary coverage are of Unix or 
> Linux files.
> 
> I will be ever grateful if you could please let me know the following at 
> your earliest conveniences:
>          1. How can I make ESRI E00 file in Windows computer
>           2. How can I make ARC/INFO binary coverage in Windows computer
> If I can make E00 file or a coverage, I think I can then use avctoe00, 
> e00toavc and read.coverage
> 
> Can I do above matter in windows computer. Actually I already spent more 
> that one months in this  matter but I could not success.
> 
> I am looking forward for your kind email and assistance in this regard.
> Thanking you in advance.
> 
> Sincerely yours
> 
> Md. Moshiur Rahman Ph.D.
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From fernando.gonzalez at iver.es  Mon Sep  5 13:42:51 2005
From: fernando.gonzalez at iver.es (=?iso-8859-1?Q?Fernando_Gonz=E1lez_Cort=E9s?=)
Date: Mon, 5 Sep 2005 13:42:51 +0200
Subject: [R-sig-Geo] help with spatial interpolation
Message-ID: <007a01c5b20e$f2971100$3700a8c0@iver.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20050905/ac0fd4c6/attachment.pl>

From fernando.gonzalez at iver.es  Wed Sep  7 08:20:35 2005
From: fernando.gonzalez at iver.es (=?iso-8859-1?Q?Fernando_Gonz=E1lez_Cort=E9s?=)
Date: Wed, 7 Sep 2005 08:20:35 +0200
Subject: [R-sig-Geo] help with spatial interpolation
References: <001d01c5b33b$a1b62b80$94dc6f80@mission>
Message-ID: <001401c5b374$421492f0$3700a8c0@iver.es>

I think I've solved the problem. I used the maptools library to read the
points from a shapefile and the fields library to obtain the grid. Here is
the script:

library(maptools)
points <- read.shape("points2d")
x <- array(0, c(length(points$Shapes),2))
for (i in 1:length(points$Shapes)) { x[i,1] <-
points$Shapes[[i]]$verts[,1] }
for (i in 1:length(points$Shapes)) { x[i,2] <-
points$Shapes[[i]]$verts[,2] }
y = points$att.data[[2]]
library(fields)
fit <- Tps(x, y)
fit.prediction <- predict.se(fit)
out <- predict.surface(fit, nx=1000, ny=1000)
png()
par(mai=c(0,0,0,0))
image(out, axes=FALSE, col=gray((100 - 0:100) / 100))
dev.off()

Bye

----- Original Message ----- 
From: "Rick Reeves" <reeves at nceas.ucsb.edu>
To: "'Fernando Gonz?lez Cort?s'" <fernando.gonzalez at iver.es>
Sent: Wednesday, September 07, 2005 1:35 AM
Subject: RE: [R-sig-Geo] help with spatial interpolation


Fernando:

The shapefiles package is a likely candidate.

Regards,

Rick Reeves
Scientific Programmer/Analyst
National Center for Ecological Analysis and Synthesis (NCEAS)
University of California, Santa Barbara CA 93101
805 892 2534
reeves at nceas.ucsb.edu



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Fernando Gonz?lez
Cort?s
Sent: Monday, September 05, 2005 4:43 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] help with spatial interpolation

Hello,

    I have the following problem: I have a set of 3d points irregularly
spaced. I have to obtain a grid with the interpolated values between the
points and I have to use a spline interpolation. I have seen some R packages
that perform some kind of interpolation but I don't know which one should I
use. Can anyone help me to find the right one?
    I just used the 'Tps' method of the 'fields' package and i've obtained a
nice graphic. Does anyone knows how to export the result of the
interpolation to be used in a GIS application?

Thanks in advance
Fernando
[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From naren_svk at yahoo.com  Wed Sep  7 17:39:14 2005
From: naren_svk at yahoo.com (Narendran Kodandapani)
Date: Wed, 7 Sep 2005 08:39:14 -0700 (PDT)
Subject: [R-sig-Geo] logistic regressions
Message-ID: <20050907153914.67318.qmail@web33301.mail.mud.yahoo.com>

Hi all,

Is it possible to conduct a logistic regression in R
using a range of probabilities in a response variable,
and subsequently will it be possible to apply weights
to each observation and rerun the logistic regression.

Thanks,

Naren
PhD Candidate,
MSU,
USA



From Roger.Bivand at nhh.no  Wed Sep  7 20:46:15 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Sep 2005 20:46:15 +0200 (CEST)
Subject: [R-sig-Geo] sp 0.8-1 has incompatible changes
Message-ID: <Pine.LNX.4.44.0509072041290.7066-100000@reclus.nhh.no>

Package sp, with classes and methods for spatial data, has version 0.8-1
now released on CRAN. The new version contains a number of incompatible
changes w.r.t. 0.7-10, both at the binary level (slot names) and the
interface level (class names and functions provided). The motivation
for this was moving to a more logical naming structure and less data
replication.

The incompatible changes are:
============================
+ SpatialRings are now called SpatialPolygons
  - SpatialPolygons now consist of a list of Polygons, where each
  Polygons object has one or more (single) Polygon objects.
+ SpatialRingsDataFrame are now called SpatialPolygonsDataFrame
+ SpatialLines now consist of a list of Lines objects, where each
  Lines object has one or more (single) Line objects.
+ Polygons, Polygon, Lines and Line do not contain projection or
  bounding box information anymore.

Further changes:
method "[", plot, show and summary are now present for all classes,
and implemented in S4 style.

package maptools now depends on sp:
+ Reading sp objects from shapefiles is now done with functions
  readShapePoly and readShapeLines


Further changes:
===============
+ by default, axes are not drawn on maps. This saves space,
  and usually the numerical values shown are little informative,
  and the titles are obvious (e.g. "x", "y"; "northing", "easting").
+ x-axis and y-axis labels can no more be plotted through plot().
  [they still can be plotted optionally through spplot()]
+ for unprojected data, if axes are drawn the values shown
  are e.g. 35oE, 22oN (o replaced with the degree symbol)
  and also positive degrees S and W, direction reversed;
  this further removes the need to add labels "latitude"
  and "longitude".  see 
  http://r-spatial.sourceforge.net/gallery/#fig21.R
  for an example.
+ spplot for grids and polygons can now plot categorical
  variables; see 
  http://r-spatial.sourceforge.net/gallery/#fig21.R
  for an example.

Edzer Pebesma and Roger Bivand

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From maechler at deb2.ethz.ch  Wed Sep  7 23:05:22 2005
From: maechler at deb2.ethz.ch (Martin Maechler)
Date: Wed, 7 Sep 2005 23:05:22 +0200
Subject: [R-sig-Geo] logistic regressions
In-Reply-To: <20050907153914.67318.qmail@web33301.mail.mud.yahoo.com>
References: <20050907153914.67318.qmail@web33301.mail.mud.yahoo.com>
Message-ID: <17183.22034.158814.138214@deb2.ethz.ch>


This is not related really to "Geo" AFAICS, so why don't ask such a
question on R-help, instead?

>>>>> "Narendran" == Narendran Kodandapani <naren_svk at yahoo.com>
>>>>>     on Wed, 7 Sep 2005 08:39:14 -0700 (PDT) writes:

    Narendran> Hi all, Is it possible to conduct a logistic
    Narendran> regression in R using a range of probabilities in
    Narendran> a response variable, and subsequently will it be
    Narendran> possible to apply weights to each observation and
    Narendran> rerun the logistic regression.

    Narendran> Thanks,

    Narendran> Naren PhD Candidate, MSU, USA

    Narendran> _______________________________________________
    Narendran> R-sig-Geo mailing list
    Narendran> R-sig-Geo at stat.math.ethz.ch
    Narendran> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Fri Sep  9 10:44:48 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Sep 2005 10:44:48 +0200 (CEST)
Subject: [R-sig-Geo] [R] shapefiles manipulations ??
In-Reply-To: <20050909081813.96508.qmail@web25709.mail.ukl.yahoo.com>
Message-ID: <Pine.LNX.4.44.0509091036520.11434-100000@reclus.nhh.no>

On Fri, 9 Sep 2005, justin bem wrote:

> cheers ,
>  I need help in shapefile manipulations. I have two shapefiles of my
> country Cameroon. The first contain 10 provinces and each province
> contains a certain number of administratives units. I dont have ESRI Arc
> view. I want to add a admistrative unit of the center province to the
> map with 10 province.
>  
> Is it possible to to take a peace of shapefile and combining it to another ?

In principle, yes. There are two R packages (maptools and shapefiles) that 
read and write shapefiles, and the newly released combination of maptools 
and the sp package should be able to handle this.

Since sp has objects defined down to the simple polygons, extracting a 
subset from one map and inserting it into another should not be too 
difficult.

The specific difficulty will be both to add the administrative unit, and 
to adjust the borders of the province that it belongs to. I suggest 
following this up on the R-sig-geo list; if you can make your shapefiles 
available (perhaps on a website), together with details of which 
administrative unit needs to be inserted, help should be forthcoming.

>  
> Thanks !
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From umusus at net.nagasaki-u.ac.jp  Fri Sep  9 12:34:36 2005
From: umusus at net.nagasaki-u.ac.jp (Susumu Tanimura)
Date: Fri, 09 Sep 2005 19:34:36 +0900
Subject: [R-sig-Geo] linewidth of polygon
Message-ID: <20050909193436.05d5f2d6.umusus@net.nagasaki-u.ac.jp>

Dear Roger and all members in this list,

This is request for the next version of maptools.  

A polygon map sometime has so small polygon that its fg color is
invisible because boundary color covers all inside of the polygon.

My at hoc solution is to edit output eps file with emacs, and change
the value of linewidth directory.  It is, however, troublesome job.

It is very nice if we can assign the value of linewidth when we use
plot.Map.  Or even option to remove boundary itself.

--
Susumu Tanimura
Dept. of Socio-environmental Medicine
Inst. of Tropical Medicine, Nagasaki University
TEL 095-849-7865 FAX 095-849-7867
e-mail stanimura-ngs at umin.ac.jp



From mdsumner at utas.edu.au  Fri Sep  9 12:59:18 2005
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Fri, 09 Sep 2005 20:59:18 +1000
Subject: [R-sig-Geo] linewidth of polygon
In-Reply-To: <20050909193436.05d5f2d6.umusus@net.nagasaki-u.ac.jp>
References: <20050909193436.05d5f2d6.umusus@net.nagasaki-u.ac.jp>
Message-ID: <43216B06.3030602@utas.edu.au>

Hello,

>My at hoc solution is to edit output eps file with emacs, and change
>the value of linewidth directory.  It is, however, troublesome job.
>
>  
>
You might try this (here lwd is being passed to lower level plot functions)

pl <- read.shape("pl.shp")      

plot(pl, lwd = 0.5)

However ?par reveals
...
     'lwd' The line width, a _positive_ number, defaulting to '1'.  The
          interpretation is device-specific, and some devices do not
          implement line widths less than one.

and I certainly don't see a difference with either postscript() or pdf() 
- Windows XP. 

I don't know enough about the various devices - eps() etc. -  to know if 
this is likely to be helpful.

>It is very nice if we can assign the value of linewidth when we use
>plot.Map.  Or even option to remove boundary itself.
>  
>

This will plot no boundary at all ("ol" is an argument of plot.Map):

plot(pl, ol = NA)

I hope that helps.

Cheers, Mike.



From Roger.Bivand at nhh.no  Fri Sep  9 13:26:09 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Sep 2005 13:26:09 +0200 (CEST)
Subject: [R-sig-Geo] linewidth of polygon
In-Reply-To: <43216B06.3030602@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0509091315480.11517-100000@reclus.nhh.no>

On Fri, 9 Sep 2005, Michael Sumner wrote:

> Hello,
> 
> >My at hoc solution is to edit output eps file with emacs, and change
> >the value of linewidth directory.  It is, however, troublesome job.
> >
> >  
> >
> You might try this (here lwd is being passed to lower level plot functions)
> 
> pl <- read.shape("pl.shp")      
> 
> plot(pl, lwd = 0.5)
> 
> However ?par reveals
> ...
>      'lwd' The line width, a _positive_ number, defaulting to '1'.  The
>           interpretation is device-specific, and some devices do not
>           implement line widths less than one.
> 
> and I certainly don't see a difference with either postscript() or pdf() 
> - Windows XP. 

No, I believe 1 is the lowest you get. I think that the visual effect can 
be varied by increasing the plot area or other fiddling around when 
opening a device. As far as I know, plot.Map() does not successfully pass 
lwd= either, I'll add the ... to plot.Map calls to polygon(), which will 
permit thicker borders, will be in 0.5-2.

> 
> I don't know enough about the various devices - eps() etc. -  to know if 
> this is likely to be helpful.
> 
> >It is very nice if we can assign the value of linewidth when we use
> >plot.Map.  Or even option to remove boundary itself.
> >  
> >
> 
> This will plot no boundary at all ("ol" is an argument of plot.Map):
> 
> plot(pl, ol = NA)
> 

Or plot(pl, ol = "transparent").

Both lwd= and setting border= to transprent do work in the plot methods 
for classes in the sp package, and maptools from 0.5-1 depends on sp. 
Getting thinner than 1 is open, though.

> I hope that helps.
> 
> Cheers, Mike.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From stanimura-ngs at umin.ac.jp  Fri Sep  9 20:00:46 2005
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Sat, 10 Sep 2005 03:00:46 +0900
Subject: [R-sig-Geo] linewidth of polygon
In-Reply-To: <Pine.LNX.4.44.0509091315480.11517-100000@reclus.nhh.no>
References: <43216B06.3030602@utas.edu.au>
	<Pine.LNX.4.44.0509091315480.11517-100000@reclus.nhh.no>
Message-ID: <20050910030046.5f20e416.stanimura-ngs@umin.ac.jp>

Dear Roger and Mike,

Thank you for advice.  

>  I'll add the ... to plot.Map calls to polygon(),
> which will  permit thicker borders, will be in 0.5-2.

This is what I expected. Thanks.  

> > This will plot no boundary at all ("ol" is an argument of plot.Map):
> > 
> > plot(pl, ol = NA)
> > 
> 
> Or plot(pl, ol = "transparent").

Oh, I did not know.  Maybe no document was given?

--
Susumu Tanimura



From mdsumner at utas.edu.au  Sun Sep 11 04:02:16 2005
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Sun, 11 Sep 2005 12:02:16 +1000
Subject: [R-sig-Geo] mapproject - datum and units
Message-ID: <43239028.7000105@utas.edu.au>


Hello, what datum and unit is used by the mapproject function?

I'm trying to georegister the coordinates returned by mapproject() in a 
GIS (Manifold). 

I'm using

proj='azequalarea',orient=c(-36.92,174.6,0)

as in the map.grid example for New Zealand.

Assuming the coordinate system "Lambert Azimuthal Equal Area", on datum 
"World Geodetic (1984)", I can get the registration close (within 100 
km) by using a local scale of 10, 000 km - however this procedure is 
quite ad hoc, and I'd like to know more about how this is specified in R. 
(See xml below for my "close" registration by changing the scale).

I'm quite sure that the unit and datum details are not specified in the 
documentation for mapproject, and I can't find them in the source code 
(but I'm a bit lost there anyway). 

Cheers, Mike.


<?xml version="1.0" encoding="UTF-8"?>
<preset>
   <name>Lambert Azimuthal Equal Area</name>
   <datum>World Geodetic 1984 (WGS84)</datum>
   <system>Lambert Azimuthal Equal Area</system>
   <unit>Kilometer</unit>
   <majorAxis>6.378137000000000000000000e+006</majorAxis>
   <eccentricity>8.181919084262148600000000e-002</eccentricity>
   <centerX>0.000000000000000000000000e+000</centerX>
   <centerY>0.000000000000000000000000e+000</centerY>
   <centerZ>0.000000000000000000000000e+000</centerZ>
   <scaleX>1.000000000000000000000000e+000</scaleX>
   <localScaleX>1.000000000000000000000000e+007</localScaleX>
   <scaleY>1.000000000000000000000000e+000</scaleY>
   <localScaleY>1.000000000000000000000000e+007</localScaleY>
   <falseEasting>0.000000000000000000000000e+000</falseEasting>
   <localOffsetX>0.000000000000000000000000e+000</localOffsetX>
   <falseNorthing>0.000000000000000000000000e+000</falseNorthing>
   <localOffsetY>0.000000000000000000000000e+000</localOffsetY>
   <centerLat>-3.692000000000000200000000e+001</centerLat>
   <centerLon>1.745999999999999900000000e+002</centerLon>
</preset>



From paul.hewson at plymouth.ac.uk  Tue Sep 13 14:43:11 2005
From: paul.hewson at plymouth.ac.uk (Paul Hewson)
Date: Tue, 13 Sep 2005 13:43:11 +0100
Subject: [R-sig-Geo] Merging separate polygons in administrative entities
Message-ID: <52A8091888A23F47A013223014B6E9FE04A0BB53@03-CSEXCH.uopnet.plymouth.ac.uk>

Hello,
 
I've imported a file from ArcView which should contain around 300 administrative entities.   However, I have over 600 polygons, mainly because of islands.  I can do mapping and so on by using the merge command.
 
Is there a way of rearranging the data so that islands etc. are associated with the adminstrative entity.   I want to do neighouring (poly2nb) and I get a lot of blank entries because all the islands are seen as distinct entities, whereas they should presumably only be 300 $shapes in the polylist?
 
I assume this may have arisen because of the way I handled the data in ArcView.
 
Thanks for any help
 
Paul Hewson
Lecturer in Statistics
University of Plymouth



From Roger.Bivand at nhh.no  Tue Sep 13 16:48:06 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Sep 2005 16:48:06 +0200 (CEST)
Subject: [R-sig-Geo] Merging separate polygons in administrative entities
In-Reply-To: <52A8091888A23F47A013223014B6E9FE04A0BB53@03-CSEXCH.uopnet.plymouth.ac.uk>
Message-ID: <Pine.LNX.4.44.0509131633320.28550-100000@reclus.nhh.no>

On Tue, 13 Sep 2005, Paul Hewson wrote:

> Hello,

>  I've imported a file from ArcView which should contain around 300
> administrative entities.  However, I have over 600 polygons, mainly
> because of islands.  I can do mapping and so on by using the merge
> command.
>  

> Is there a way of rearranging the data so that islands etc. are
> associated with the adminstrative entity.  I want to do neighouring
> (poly2nb) and I get a lot of blank entries because all the islands are
> seen as distinct entities, whereas they should presumably only be 300
> $shapes in the polylist?
>  

Yes, it should be possible. What you'll need to check first is that the
att.data contain a suitable ID column with the 300 or so unique output
IDs, which contain duplicates in the input. The sp and maptools packages
contain the functionality you'll need, though it's a bit rough for now. 
The steps are to read the shapefile:

library(maptools) # maptools > 0.5, depends on sp > 0.8
myshp <- read.shape("myshp.shp")

then convert to SpatialPolygons aggregating the geometries by ID:

IDs <- myshp$att.data$myID_field
SP <- maptools:::.asSpatialPolygonsShapes(myshp$Shapes, IDs=IDs)

and back to the polylist object (it's a bit simplistic, the sp objects 
are more advanced):

plist <- maptools:::.SpP2polylist(SP)

Do watch the attr(plist, "region.id") - it will contain your IDs uniquely,
but may not be in the same order as you might think. How you aggregate
what else is in att.data will be up to you. Please let me know how this
goes - the functionality can be exposed easier than using the package
namespace :::  operators.

Roger


> I assume this may have arisen because of the way I handled the data in
> ArcView.
>  
> Thanks for any help
>  
> Paul Hewson
> Lecturer in Statistics
> University of Plymouth
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Tue Sep 13 18:54:41 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Sep 2005 18:54:41 +0200 (CEST)
Subject: [R-sig-Geo] mapproject - datum and units
In-Reply-To: <43239028.7000105@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0509131655321.28550-100000@reclus.nhh.no>

On Sun, 11 Sep 2005, Michael Sumner wrote:

> 
> Hello, what datum and unit is used by the mapproject function?
> 
> I'm trying to georegister the coordinates returned by mapproject() in a 
> GIS (Manifold). 
> 
> I'm using
> 
> proj='azequalarea',orient=c(-36.92,174.6,0)
> 
> as in the map.grid example for New Zealand.
> 
> Assuming the coordinate system "Lambert Azimuthal Equal Area", on datum 
> "World Geodetic (1984)", I can get the registration close (within 100 
> km) by using a local scale of 10, 000 km - however this procedure is 
> quite ad hoc, and I'd like to know more about how this is specified in R. 
> (See xml below for my "close" registration by changing the scale).
> 
> I'm quite sure that the unit and datum details are not specified in the 
> documentation for mapproject, and I can't find them in the source code 
> (but I'm a bit lost there anyway). 

I think the C source is the documentation, it's:

/************************************************************

Copyright (C) 1998, Lucent Technologies
All rights reserved

************************************************************/

#include "map.h"

int
Xazequalarea(struct place *place, double *x, double *y)
{
	double r;
	r = sqrt(1. - place->nlat.s);
	*x = - r * place->wlon.s;
	*y = - r * place->wlon.c;
	return(1);
}

proj
azequalarea(void)
{
	return(Xazequalarea);
}

where map.h says:

struct coord {
	double l;	/* lat or lon in radians*/
	double s;	/* sin */
	double c;	/* cos */
};
struct place {
	struct coord nlat;
	struct coord wlon;
};

but I'm about as enlightened as you, I'm afraid. The PROJ.4 system is 
better documented, package spproj on the r-spatial repository.

Roger


> 
> Cheers, Mike.
> 
> 
> <?xml version="1.0" encoding="UTF-8"?>
> <preset>
>    <name>Lambert Azimuthal Equal Area</name>
>    <datum>World Geodetic 1984 (WGS84)</datum>
>    <system>Lambert Azimuthal Equal Area</system>
>    <unit>Kilometer</unit>
>    <majorAxis>6.378137000000000000000000e+006</majorAxis>
>    <eccentricity>8.181919084262148600000000e-002</eccentricity>
>    <centerX>0.000000000000000000000000e+000</centerX>
>    <centerY>0.000000000000000000000000e+000</centerY>
>    <centerZ>0.000000000000000000000000e+000</centerZ>
>    <scaleX>1.000000000000000000000000e+000</scaleX>
>    <localScaleX>1.000000000000000000000000e+007</localScaleX>
>    <scaleY>1.000000000000000000000000e+000</scaleY>
>    <localScaleY>1.000000000000000000000000e+007</localScaleY>
>    <falseEasting>0.000000000000000000000000e+000</falseEasting>
>    <localOffsetX>0.000000000000000000000000e+000</localOffsetX>
>    <falseNorthing>0.000000000000000000000000e+000</falseNorthing>
>    <localOffsetY>0.000000000000000000000000e+000</localOffsetY>
>    <centerLat>-3.692000000000000200000000e+001</centerLat>
>    <centerLon>1.745999999999999900000000e+002</centerLon>
> </preset>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From amsantac at hotmail.com  Wed Sep 14 00:34:27 2005
From: amsantac at hotmail.com (=?iso-8859-1?B?QWztIFNhbnRhY3J1eg==?=)
Date: Tue, 13 Sep 2005 22:34:27 +0000
Subject: [R-sig-Geo] Generating random points
Message-ID: <BAY20-F1522190DBA1B61E21F13C4C99C0@phx.gbl>

Hi,

I need to generate (randomly) n points inside the boundary of a polygon,

is there any function that can handle this?

Sincerely,

Al? M. Santacruz
Corporaci?n Centro de Investigaci?n en Ecosistemas y Cambio Global (C&B)
http://www.carbonoybosques.org
Tel: (574) 230 08 76
Calle 51 72-07 Int. 708
Medell?n (Colombia)



From White.Denis at epamail.epa.gov  Wed Sep 14 00:53:12 2005
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Tue, 13 Sep 2005 15:53:12 -0700
Subject: [R-sig-Geo] Generating random points
In-Reply-To: <BAY20-F1522190DBA1B61E21F13C4C99C0@phx.gbl>
Message-ID: <OFA552DECC.A039D332-ON8825707B.007D8175-8825707B.007DB876@epamail.epa.gov>

csr                 package:splancs                 R Documentation

Generate completely spatially random points on a polygon

Description:

     Generate completely spatially random points on a polygon.

Usage:

     csr(poly,npoints)

Arguments:

    poly: A polygon data set.

 npoints: The number of points to generate.

Details:

     'csr' generates points randomly in the bounding box of 'poly,'
     then uses  'pip' to extract those in the polygon. If the number of
     points remaining is less than that required, 'csr' generates some
     more points in the bounding box until at least 'npoints' remain
     inside the polygon. If too many points are generated then the list
     of points is truncated.

     Uses 'runif()' to generate random numbers and so updates
     '.Random.seed', the standard S random number generator seed.

... etc.


r-sig-geo-bounces at stat.math.ethz.ch wrote on 2005-09-13 15:34:27:

> Hi,
>
> I need to generate (randomly) n points inside the boundary of a
polygon,
>
> is there any function that can handle this?
>
> Sincerely,
>
> Al? M. Santacruz
> Corporaci?n Centro de Investigaci?n en Ecosistemas y Cambio Global
(C&B)
> http://www.carbonoybosques.org
> Tel: (574) 230 08 76
> Calle 51 72-07 Int. 708
> Medell?n (Colombia)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From adrian at maths.uwa.edu.au  Wed Sep 14 12:32:08 2005
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Wed, 14 Sep 2005 18:32:08 +0800
Subject: [R-sig-Geo]  Generating random points
Message-ID: <17191.64552.769024.269790@maths.uwa.edu.au>


> I need to generate (randomly) n points inside the boundary of a polygon,
> is there any function that can handle this?

For this kind of functionality, use the `spatstat' package
which offers (for example)

      rpoint                  Generate N Random Points
      runifpoint              Generate N Uniform Random Points
      rpoispp                 Generate Poisson Point Pattern
      stratrand               Stratified random point pattern

Adrian Baddeley



From Roger.Bivand at nhh.no  Fri Sep 16 08:48:58 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Sep 2005 08:48:58 +0200 (CEST)
Subject: [R-sig-Geo] ChangeLog for maptools 0.5-2
In-Reply-To: <20050916081657.2f733e59.stanimura-ngs@umin.ac.jp>
Message-ID: <Pine.LNX.4.44.0509160841350.4324-100000@reclus.nhh.no>

On Fri, 16 Sep 2005, Susumu Tanimura wrote:

> Dear Roger Bivand,
> 
> Thank you for maintaining maptools.  
> 
> No changelog of 0.5-2 was given when
> > maptools(TRUE).

Sorry, I'll put it in, but it won't appear until 0.5-3:

0.5-2	The suggested dependency on splancs has been removed, and the 
dotsInPolys() and symbolsInPolys() function have been re-written to use 
sample.Polygons() from sp. Because sp respects holes, users may find that 
if polygon rings are taken (wrongly) to be holes, they will not receive 
any dots/symbols. The examples on the help pages show how to use wrapper 
package spgpc from the r-spatial repository to remedy this. Also the lwd= 
argument is now passed through in plot.Map().

Nice to know that you are keeping an eye on me!

Best wishes,

Roger

> 
> Best regards,
> 
> --
> Susumu Tanimura
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sat Sep 17 10:06:07 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Sep 2005 10:06:07 +0200 (CEST)
Subject: [R-sig-Geo] Question:manipulating spatial data using
 combination of Maptools and Splancs
In-Reply-To: <BAY21-F2F76D27E061A265A61A93BC900@phx.gbl>
Message-ID: <Pine.LNX.4.44.0509170959050.8255-100000@reclus.nhh.no>

On Sat, 17 Sep 2005, kostas karis wrote:

> Thank you for your advice but i still have a problem...Everything goes fine 
> till the plotting (as usual).When i try the code you posted for the 
> conversion i get the following message:
> 
> Error in coordinates(quakes) : no direct or inherited method for function 
> 'coordinates' for this call
> 
> i don't have a clue what this means...

Please always include the commands you gave, here in particular the
command(s) creating the quakes object - other list participants cannot see
your computer screen. All the error message says is that it is not a
SpatialPoints* object, so you have not done:

> quakes <- readShapePoints("quakes.shp")
> quakes_pts <- coordinates(quakes)

as I suggested. I also suggest moving this thread to the R-sig-geo list - 
subscription details on the "Spatial" Task View on CRAN:

http://cran.r-project.org/src/contrib/Views/Spatial.html

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kostaskaris at hotmail.com  Mon Sep 19 12:00:49 2005
From: kostaskaris at hotmail.com (kostas karis)
Date: Mon, 19 Sep 2005 10:00:49 +0000
Subject: [R-sig-Geo] Question:manipulating spatial data using
	combination of Maptools and Splancs
In-Reply-To: <Pine.LNX.4.44.0509170959050.8255-100000@reclus.nhh.no>
Message-ID: <BAY21-F261DC9F92865435EA66A2BBC920@phx.gbl>

I ran the commands as you suggested and it rans ok, until the ploting

>akto<-readShapePoly("akto.shp")
>quakes<-readShapePoints("QD15.shp")
>ls()
[1] "akto"   "quakes"
>sp_quakes<-coordinates(quakes)
>sp_akto<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(getSpPpolygonsSlot(akto)[[1]])[[1]])

when i type
>polymap(sp_akto)

the shape that the device plots isn't right. the rings and shapes indices 
are correct but the output is wrong. I used another shapefile with more 
shapes and i get the following error:

>nomoi<-readShapePoly("nomoi.shp",verbose=T)
Shapefile type: Polygon, (5), # of Shapes: 52
>sp_nomoi<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(
+getSpPpolygonsSlot(nomoi)[[52]])[[52]])
Error in getPolygonsPolygonsSlot(getSpPpolygonsSlot(nomoi)[[52]])[[52]] :
        subscript out of bounds


I currently write my Msc thesis and i am using open-source programs for the 
processing of spatial data. I am using R for the spatial statistics part but 
this is the first time that i use this program so i would really appreciate 
your help.

_________________________________________________________________
Don't just search. Find. Check out the new MSN Search!



From Roger.Bivand at nhh.no  Mon Sep 19 14:30:32 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Sep 2005 14:30:32 +0200 (CEST)
Subject: [R-sig-Geo] Question:manipulating spatial data using
 combination of Maptools and Splancs
In-Reply-To: <BAY21-F261DC9F92865435EA66A2BBC920@phx.gbl>
Message-ID: <Pine.LNX.4.44.0509191422390.20258-100000@reclus.nhh.no>

On Mon, 19 Sep 2005, kostas karis wrote:

> I ran the commands as you suggested and it rans ok, until the ploting
> 
> >akto<-readShapePoly("akto.shp")
> >quakes<-readShapePoints("QD15.shp")
> >ls()
> [1] "akto"   "quakes"
> >sp_quakes<-coordinates(quakes)
> >sp_akto<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(getSpPpolygonsSlot(akto)[[1]])[[1]])
> 
> when i type
> >polymap(sp_akto)
> 
> the shape that the device plots isn't right. the rings and shapes indices 
> are correct but the output is wrong. 

What do: "isn't right" and "wrong" mean in this context? Maybe you could 
attach the shapefiles to me off-list, with some specification of which 
ring in which polygon shapefile is the relevant one for your points - I 
still can't see over your shoulder?

> I used another shapefile with more 
> shapes and i get the following error:
> 
> >nomoi<-readShapePoly("nomoi.shp",verbose=T)
> Shapefile type: Polygon, (5), # of Shapes: 52
> >sp_nomoi<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(
> +getSpPpolygonsSlot(nomoi)[[52]])[[52]])
> Error in getPolygonsPolygonsSlot(getSpPpolygonsSlot(nomoi)[[52]])[[52]] :
>         subscript out of bounds

Yes, the first 52 is OK, but the second one refers to the 52nd ring in the 
52nd multipolygon object. Try:

getSpPnParts(nomoi)

to see how many consituent rings there are in each polygon object - to get 
the last ring of the last polygon, you would need 52 and 
getSpPnParts(nomoi)[52] - the final ring. I guess there are not as many as 
52.

> 
> 
> I currently write my Msc thesis and i am using open-source programs for the 
> processing of spatial data. I am using R for the spatial statistics part but 
> this is the first time that i use this program so i would really appreciate 
> your help.
> 
> _________________________________________________________________
> Don't just search. Find. Check out the new MSN Search! 
> http://search.msn.click-url.com/go/onm00200636ave/direct/01/
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kostaskaris at hotmail.com  Mon Sep 19 17:38:20 2005
From: kostaskaris at hotmail.com (kostas karis)
Date: Mon, 19 Sep 2005 15:38:20 +0000
Subject: [R-sig-Geo] Question:manipulating spatial data using
	combination of Maptools and Splancs
Message-ID: <BAY21-F267B62539D6F20E374E853BC920@phx.gbl>

Dear Roger,
This is my fourth mail to u (we can call it a date :))
Ok, u are right that my mails were vague..It's the first time i ask help 
from a a mailing list so i'am a little unfamiliar with the process.i'll try 
to be more specific.Now i have 2 questions
I wrote the code as you suggested and after the conversion the kernel 
crashes again.I suspect it's the nx and ny options but i don't know how to 
adjust them.

>library(splancs)

Spatial Point Pattern Analysis Code in S-Plus

Version 2 - Spatial and Space-Time analysis
>library(maptools)
Loading required package: foreign
Loading required package: sp
>akto<-readShapePoly("Export_sterea_mac.shp",verbose=T)
Shapefile type: Polygon, (5), # of Shapes: 1
>quakes<-readShapePoints("QD15.shp")
>plot(akto)
>plot(quakes,add=T)
>sp_quakes<-coordinates(quakes)
>getSpPnParts(akto)
[1] 1
>sp_akto<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(getSpPpolygonsSlot(akto)[[1]])[[1]])
>polymap(sp_akto)
>image(kernel2d(sp_quakes,sp_akto, h0=15,nx=100,ny=100),add=T)
Error in bbox(poly) : no direct or inherited method for function 'bbox' for 
this call (???)


In the above session i have used a single ring polygon.What if i wanted to 
import a polygon with many rings?My objective here is to import my countries 
boundaries (Greece). U realize that it's a polygon with many rings because 
it has many islands. When i ran the same code as above i take the following 
output:

>akto2<-readShapePoly("akto.shp",verbose=T)
Shapefile type: Polygon, (5), # of Shapes: 1
>getSpPnParts(akto)
[1] 2024

How can i convert all the rings?



From Roger.Bivand at nhh.no  Mon Sep 19 18:40:27 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Sep 2005 18:40:27 +0200 (CEST)
Subject: [R-sig-Geo] Question:manipulating spatial data using
 combination of Maptools and Splancs
In-Reply-To: <BAY21-F267B62539D6F20E374E853BC920@phx.gbl>
Message-ID: <Pine.LNX.4.44.0509191826090.20258-100000@reclus.nhh.no>

On Mon, 19 Sep 2005, kostas karis wrote:

> Dear Roger,
> This is my fourth mail to u (we can call it a date :))
> Ok, u are right that my mails were vague..It's the first time i ask help 
> from a a mailing list so i'am a little unfamiliar with the process.i'll try 
> to be more specific.

Well, you're doing pretty well, keep it up and you'll be answering other 
peoples' questions before long, it's how we all begin!

> Now i have 2 questions
> I wrote the code as you suggested and after the conversion the kernel 
> crashes again.I suspect it's the nx and ny options but i don't know how to 

Warning - only say "crash" when R error terminates (dies totally). Here R 
was still alive, you just hit an error condition. Like the difference 
between hitting a truck head on and taking a wrong turn in a city you 
don't know ...

> adjust them.
> 
> >library(splancs)
> 
> Spatial Point Pattern Analysis Code in S-Plus
> 
> Version 2 - Spatial and Space-Time analysis
> >library(maptools)
> Loading required package: foreign
> Loading required package: sp
> >akto<-readShapePoly("Export_sterea_mac.shp",verbose=T)
> Shapefile type: Polygon, (5), # of Shapes: 1
> >quakes<-readShapePoints("QD15.shp")
> >plot(akto)
> >plot(quakes,add=T)
> >sp_quakes<-coordinates(quakes)
> >getSpPnParts(akto)
> [1] 1
> >sp_akto<-getPolygonCoordsSlot(getPolygonsPolygonsSlot(getSpPpolygonsSlot(akto)[[1]])[[1]])
> >polymap(sp_akto)
> >image(kernel2d(sp_quakes,sp_akto, h0=15,nx=100,ny=100),add=T)
> Error in bbox(poly) : no direct or inherited method for function 'bbox' for 
> this call (???)
> 

OK, this is a conflict between sp and splancs, both of which define 
functions called bbox but differently. The only current solution is not to 
say library(splancs) until you have finished all the sp functions - this 
will be fixed before long. the h0 value - the bandwidth - will need 
choosing depending on the scales of your coordinates and their relative 
placing - 15 in metres is different from 15 in km. nx and ny are OK.

> 
> In the above session i have used a single ring polygon.What if i wanted to 
> import a polygon with many rings?My objective here is to import my countries 
> boundaries (Greece). 

Well, splancs only handles a single ring, that is all you get. I'm rather 
unsure what point process of interest could be studied on 2000+ polygons 
at the same time - and if they are quakes, I don't think you need to use 
coastlines for more than display. You may simply be able to use the 
coastlines as coastlines, plotted on top of the density output, since 
quakes will also happen under the sea, right? Use sbox() in splancs on 
sp_quakes, that will give a rectangular bounding box extended a little on 
all sides. However, if your points are quakes, they will have dates and 
intensities, I think? Have you perhaps had a chance to look at the article 
on seismology in R in the 2005 (1) number of R News? Maybe some of the 
functions used there would suit you - they are not on CRAN, but do work, 
the access references are in the article.

Hope this helps,

Roger

> U realize that it's a polygon with many rings because 
> it has many islands. When i ran the same code as above i take the following 
> output:
> 
> >akto2<-readShapePoly("akto.shp",verbose=T)
> Shapefile type: Polygon, (5), # of Shapes: 1
> >getSpPnParts(akto)
> [1] 2024
> 
> How can i convert all the rings?
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kostaskaris at hotmail.com  Tue Sep 20 11:08:41 2005
From: kostaskaris at hotmail.com (kostas karis)
Date: Tue, 20 Sep 2005 09:08:41 +0000
Subject: [R-sig-Geo] Question:manipulating spatial data using
 combination of Maptools and Splancs
In-Reply-To: <Pine.LNX.4.44.0509191826090.20258-100000@reclus.nhh.no>
Message-ID: <BAY21-F4CCBC06E93C0C600427D4BC950@phx.gbl>

Roger hi,
First of all, i finally made the code ran thanks to your advices.Thank u 
very much.U are right that i need the coastline only for display and 
specifically, i need only the mainland as my main objective is to find, if 
there is, a correlation between seismicity and rainfall (hydrologically 
induced earthquakes).The thing is that the coastline of Greece is very 
fragmented, not solid as France or Spain for example.So , by default i have 
to use a polygon with more than one ring. Do you suggest that this is a task 
that cannot be done with R?
I have read the latest R news and i have checked the sslib.I think it 'll be 
of some use along the way. Thanks again for the tip!

K.



From Roger.Bivand at nhh.no  Tue Sep 20 13:03:09 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Sep 2005 13:03:09 +0200 (CEST)
Subject: [R-sig-Geo] Question:manipulating spatial data using
 combination of Maptools and Splancs
In-Reply-To: <BAY21-F4CCBC06E93C0C600427D4BC950@phx.gbl>
Message-ID: <Pine.LNX.4.44.0509201256521.21663-100000@reclus.nhh.no>

On Tue, 20 Sep 2005, kostas karis wrote:

> Roger hi,
> First of all, i finally made the code ran thanks to your advices.Thank u 
> very much.U are right that i need the coastline only for display and 
> specifically, i need only the mainland as my main objective is to find, if 
> there is, a correlation between seismicity and rainfall (hydrologically 
> induced earthquakes).The thing is that the coastline of Greece is very 
> fragmented, not solid as France or Spain for example.So , by default i have 
> to use a polygon with more than one ring. Do you suggest that this is a task 
> that cannot be done with R?

Well, it is not feasible to use multiple rings in splancs. The spatstat 
package lets you use multiple rings, but I'm far from sure how many rings 
is a sensible number. If your research question is as you describe it, you 
can subset to take one ring, or a small number of rings with the largest 
areas and numbers of events. But in any case, you may be needing to look 
for association between seismicity and rainfall in time and space, that 
extreme precipitation events precede seismicity? I think that sorting that 
out first might give some more handles, and importing polygons is then not 
such an important problem. If the polygon shapefile only needs to be an 
outline for visualisation, you can also use readShapeLines() in maptools.

Roger

> I have read the latest R news and i have checked the sslib.I think it 'll be 
> of some use along the way. Thanks again for the tip!
> 
> K.
> 
> _________________________________________________________________
> Express yourself instantly with MSN Messenger! Download today it's FREE! 
> http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From naren_svk at yahoo.com  Wed Sep 21 16:53:55 2005
From: naren_svk at yahoo.com (Narendran Kodandapani)
Date: Wed, 21 Sep 2005 07:53:55 -0700 (PDT)
Subject: [R-sig-Geo] covariances
Message-ID: <20050921145355.18945.qmail@web33301.mail.mud.yahoo.com>

Hi all,

I have obtained the variogram and model for a set of
counties in my study area for a z attribute.  I would
now like to estimate the pairwise covariances among
the counties by using the parameters from the fitted
model and calculate the spatial correlations between
the counties. Where can I view the results?

Thanks,

Naren



From Roger.Bivand at nhh.no  Thu Sep 22 09:30:50 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 Sep 2005 09:30:50 +0200 (CEST)
Subject: [R-sig-Geo] covariances
In-Reply-To: <20050921145355.18945.qmail@web33301.mail.mud.yahoo.com>
Message-ID: <Pine.LNX.4.44.0509220927100.23765-100000@reclus.nhh.no>

On Wed, 21 Sep 2005, Narendran Kodandapani wrote:

> Hi all,
> 
> I have obtained the variogram and model for a set of
> counties in my study area for a z attribute.  I would
> now like to estimate the pairwise covariances among
> the counties by using the parameters from the fitted
> model and calculate the spatial correlations between
> the counties. Where can I view the results?

In the geoR package, you will find functions cov.spatial() and 
varcov.spatial(), which may provide a place to start.


> 
> Thanks,
> 
> Naren
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hi_ono2001 at yahoo.co.jp  Tue Sep 27 09:46:34 2005
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Tue, 27 Sep 2005 16:46:34 +0900 (JST)
Subject: [R-sig-Geo] About C API of GEOS for sp packages
Message-ID: <20050927074634.89340.qmail@web1710.mail.yahoo.co.jp>

Hello.

 Currently C API of GEOS seems to be available according
to http://geos.refractions.net/ro/CVS.txt.

 Current spgpclib cannot be used for commercial use.

 I think it will be better to use GEOS(its license is GPL,
probably) , based on OpenGIS and has more functions than
gpclib.

 Has sp packages dev. team any plan to develop new sp
package employing GEOS instead of gpclib?


 Regards.



From Jordi.Molins at drkw.com  Tue Sep 27 11:33:11 2005
From: Jordi.Molins at drkw.com (Molins, Jordi)
Date: Tue, 27 Sep 2005 11:33:11 +0200
Subject: [R-sig-Geo] newbie question in fitting data to surfaces
Message-ID: <C5A76BA0CA4D734CA725124C4D6397AC032191E2@ibfftce502.de.ad.drkw.net>


Hello,

I am new in this list. I have a problem and I think that the solution to
this problem can be found using spatial statistics, but I do not know how.

My problem is the following: I have a matrix of data, of around 6 rows and 5
columns. In reality, I have a time series, where at each point in time, I
have a matrix.

Usually (but not always) the maximum is at the position (1,1). Given any
position (i,j), the positions to the right and below are smaller numbers.
For example, 

21.75	21	20.3	18.9	17.4
21.1	20.5 ...
.
.
.
15.6	14.8	14.5	14.3	14.2

In my "world", if I have a row of data (1D, as opposed to 2D) I typically
fit a parameterized function to this data (e.g., theta_1 + (theta_2 +
theta_3 * x) exp(-x / theta_4), where x is the row of data). I get the
numbers theta_1, ..., theta_4 and I am happy.

However, now I have a matrix of data. Of course, I could fit a function for
each of the rows (or columns) and report the thetas for each row (or
column). But I guess that there should be a way to keep the dependencies
between rows (or columns).

Has anybody found a problem like this? Is there a predefined function (with
several thetas) that could cope with data like this one, and is easy to
calibrate? 

Thank you in advance

Jordi



--------------------------------------------------------------------------------
The information contained herein is confidential and is inte...{{dropped}}



From e.pebesma at geog.uu.nl  Tue Sep 27 11:36:15 2005
From: e.pebesma at geog.uu.nl (Edzer J. Pebesma)
Date: Tue, 27 Sep 2005 11:36:15 +0200
Subject: [R-sig-Geo] About C API of GEOS for sp packages
In-Reply-To: <20050927074634.89340.qmail@web1710.mail.yahoo.co.jp>
References: <20050927074634.89340.qmail@web1710.mail.yahoo.co.jp>
Message-ID: <4339128F.4080109@geog.uu.nl>

Hisaji ONO wrote:

>Hello.
>
> Currently C API of GEOS seems to be available according
>to http://geos.refractions.net/ro/CVS.txt.
>
> Current spgpclib cannot be used for commercial use.
>
> I think it will be better to use GEOS(its license is GPL,
>probably) , based on OpenGIS and has more functions than
>gpclib.
>
> Has sp packages dev. team any plan to develop new sp
>package employing GEOS instead of gpclib?
>
>
> Regards.
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  
>
Hisaji, the sp development team has discussed this,
and we have contacted the gpclib group to  find out
what exactly the limitations are.

It seems that the limitations are related to developing
software using gpclib, rather than using the code
that has been developed with gpclib. If we
were in whatever sense paid to develop sp (and
spgpclib), we would have obligations to the gpclib
developers. We are however not involved in this with
a commercial goal, and so are free to develop using
gpclib without restrictions. The licence restrictions
do not hold for the code developed, or to use by
end-users.

The gpclib group has chosen not to distribute gpclib
under the GPL because that would impose too much
restrictions on further possible uses of gpclib in other
applications. They have also allowed for using gpclib
non-commercially in applications distributed under
the GPL, without enforcing restrictions on the application(s)
redistributed.

So, we don't see actually problems in using or
redistributing R packages that use (include) gpclib.

GEOS is certainly a library that we would like to use,
but none of us is really familiar with the code, and
none of us is _very_ experienced in using C++; we
consider it as a major effort with low priority.

There's also the issue of how much GIS functionality
do we want, and need, in the R environment?

Which of the functionality in GEOS do you think is
missing from gpclib, and needed in R?
--
Edzer



From Jordi.Molins at drkw.com  Tue Sep 27 12:52:24 2005
From: Jordi.Molins at drkw.com (Molins, Jordi)
Date: Tue, 27 Sep 2005 12:52:24 +0200
Subject: [R-sig-Geo] newbie question in fitting data to surfaces
Message-ID: <C5A76BA0CA4D734CA725124C4D6397AC032191E3@ibfftce502.de.ad.drkw.net>

Just an addition to the question I have asked before:

one easy way would be to fit:

- a global constant (to account for the average of the points of the
matrix);
- a plane to account for linear terms (in the example below, it should be a
plane with both negative partial derivatives with respect "x" and "y")
- a quadratic form in 2 dimensions to account for "curvature" terms
- maybe a cubic form

Is there an easy way to perform this, or some analogous solution?

Thank you

Jordi

------------------------------------


Hello,

I am new in this list. I have a problem and I think that the solution to
this problem can be found using spatial statistics, but I do not know how.

My problem is the following: I have a matrix of data, of around 6 rows and 5
columns. In reality, I have a time series, where at each point in time, I
have a matrix.

Usually (but not always) the maximum is at the position (1,1). Given any
position (i,j), the positions to the right and below are smaller numbers.
For example, 

21.75	21	20.3	18.9	17.4
21.1	20.5 ...
.
.
.
15.6	14.8	14.5	14.3	14.2

In my "world", if I have a row of data (1D, as opposed to 2D) I typically
fit a parameterized function to this data (e.g., theta_1 + (theta_2 +
theta_3 * x) exp(-x / theta_4), where x is the row of data). I get the
numbers theta_1, ..., theta_4 and I am happy.

However, now I have a matrix of data. Of course, I could fit a function for
each of the rows (or columns) and report the thetas for each row (or
column). But I guess that there should be a way to keep the dependencies
between rows (or columns).

Has anybody found a problem like this? Is there a predefined function (with
several thetas) that could cope with data like this one, and is easy to
calibrate? 

Thank you in advance

Jordi



--------------------------------------------------------------------------------
The information contained herein is confidential and is inte...{{dropped}}



From Roger.Bivand at nhh.no  Tue Sep 27 12:55:35 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Sep 2005 12:55:35 +0200 (CEST)
Subject: [R-sig-Geo] About C API of GEOS for sp packages
In-Reply-To: <20050927074634.89340.qmail@web1710.mail.yahoo.co.jp>
Message-ID: <Pine.LNX.4.44.0509271006270.6236-100000@reclus.nhh.no>

On Tue, 27 Sep 2005, Hisaji ONO wrote:

> Hello.
> 
>  Currently C API of GEOS seems to be available according
> to http://geos.refractions.net/ro/CVS.txt.
> 
>  Current spgpclib cannot be used for commercial use.

This is not correct. The maintainer of gpclib has been asked to modify his 
license terms to the correct one, i.e. that the source code of the 
underlying C library may not be incorporated into a commercial software 
product and/or sold. Note that the much larger PBSmapping package includes 
the full gpc C library, which is GPL there. We now have an spPBS wrapper 
from sp classes to PBSmapping, but have not investigated using that route 
to cut out the mistake in the R package gpclib's maintainer's 
understanding of the licence of the underlying C library. 

The easiest is still to try to convince Roger Peng that he should correct
the license line in DESCRIPTION in the package in line with what
PBSmapping does, i.e.  GPL, which provides all the protection Alan Murta
needs (and which his team agreed to in correspondence with the PBSmapping
maintainers). Maybe if Roger gets email from someone other than me about
this, it might help?

> 
>  I think it will be better to use GEOS(its license is GPL,
> probably) , based on OpenGIS and has more functions than
> gpclib.
> 
>  Has sp packages dev. team any plan to develop new sp
> package employing GEOS instead of gpclib?

We are open to contributions, but are generally sceptical about C++ code 
because of portability issues, and even more sceptical to Java, which 
simply does not integrate well with R in a portable way.

Roger

> 
> 
>  Regards.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hi_ono2001 at yahoo.co.jp  Wed Sep 28 08:17:10 2005
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Wed, 28 Sep 2005 15:17:10 +0900 (JST)
Subject: [R-sig-Geo] Couldn't load "rmap_1.1.0.zip" to R 2.1.1 for Win
In-Reply-To: <Pine.LNX.4.44.0509271006270.6236-100000@reclus.nhh.no>
Message-ID: <20050928061710.62520.qmail@web1704.mail.yahoo.co.jp>

Thank you for your response for my question.

 I have another question of loading "rmap_1.1.0.zip" to R
2.1.1 on Windows XP.

 R2.1.1 said "'Rmap' is not valid package. It was probably
installed in < 2.0.0. " on loading this rmap.

 Will you not support Rmap for R 2.1.x since (sp)maptools
has replaced Rmap?


 Regards.



From Roger.Bivand at nhh.no  Wed Sep 28 09:06:01 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Sep 2005 09:06:01 +0200 (CEST)
Subject: [R-sig-Geo] Couldn't load "rmap_1.1.0.zip" to R 2.1.1 for Win
In-Reply-To: <20050928061710.62520.qmail@web1704.mail.yahoo.co.jp>
Message-ID: <Pine.LNX.4.44.0509280850460.7185-100000@reclus.nhh.no>

On Wed, 28 Sep 2005, Hisaji ONO wrote:

> Thank you for your response for my question.
> 
>  I have another question of loading "rmap_1.1.0.zip" to R
> 2.1.1 on Windows XP.
> 
>  R2.1.1 said "'Rmap' is not valid package. It was probably
> installed in < 2.0.0. " on loading this rmap.
> 
>  Will you not support Rmap for R 2.1.x since (sp)maptools
> has replaced Rmap?

Please remind me where the Windows binary package came from - is it the 
product of your own success with MSYS? Part of the functionality for map 
projections is in the spproj package, another part for shapefiles is in 
the maptools (and/or shapefiles) packages, but no OGR support is available 
elsewhere. Making a new binary build with fresh PROJ.4, shapelib, and OGR 
under MSYS is an option.

In time merging OGR support into rgdal is logical, contributions? The 
rgdal package CVS is also on sourceforge, at:

http://rgdal.sourceforge.net/

The use of sp classes with rgdal rasterobjects is being followed up, so 
doing the same for OGR would seem sensible. Finally, spproj should perhaps 
also be merged with rgdal, since rgdal has an indirect external dependence 
on the PROJ.4 library and metadata anyway. The maptools package does not 
have an external dependence, because the shapelib C files are copied there 
and in the foreign package (for DBF).

Roger

> 
> 
>  Regards.
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hi_ono2001 at ybb.ne.jp  Wed Sep 28 09:39:49 2005
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Wed, 28 Sep 2005 16:39:49 +0900 (JST)
Subject: [R-sig-Geo] Couldn't load "rmap_1.1.0.zip" to R 2.1.1 for Win
In-Reply-To: <Pine.LNX.4.44.0509280850460.7185-100000@reclus.nhh.no>
Message-ID: <20050928073949.82948.qmail@web1710.mail.yahoo.co.jp>

THank your for your response.

> Please remind me where the Windows binary package
> came from - is it the 
> product of your own success with MSYS? Part of the

 I've used Rmap binaries available in your site,
"http://spatial.nhh.no/R/Devel/".


 Regards.



From Roger.Bivand at nhh.no  Wed Sep 28 11:04:32 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Sep 2005 11:04:32 +0200 (CEST)
Subject: [R-sig-Geo] Couldn't load "rmap_1.1.0.zip" to R 2.1.1 for Win
In-Reply-To: <20050928073949.82948.qmail@web1710.mail.yahoo.co.jp>
Message-ID: <Pine.LNX.4.44.0509281101440.7185-100000@reclus.nhh.no>

On Wed, 28 Sep 2005, Hisaji ONO wrote:

> THank your for your response.
> 
> > Please remind me where the Windows binary package
> > came from - is it the 
> > product of your own success with MSYS? Part of the
> 
>  I've used Rmap binaries available in your site,
> "http://spatial.nhh.no/R/Devel/".

Oops! The package needs a fair bit of attention to get it to pass R CMD
check (which has got more difficult since < 2.0), I'll try to move on this
fairly soon. If anyone else has changed code in Rmap that they can
contribute - just the OGR interface, please let me know off-list.

Roger

> 
> 
>  Regards.
>  
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hi_ono2001 at ybb.ne.jp  Wed Sep 28 11:33:47 2005
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Wed, 28 Sep 2005 18:33:47 +0900 (JST)
Subject: [R-sig-Geo] Couldn't load "rmap_1.1.0.zip" to R 2.1.1 for Win
In-Reply-To: <Pine.LNX.4.44.0509281101440.7185-100000@reclus.nhh.no>
Message-ID: <20050928093347.40457.qmail@web1709.mail.yahoo.co.jp>

Thank your for your quick response.

 If possible, keep old version for R1.9.x, please.

 Regards.

 
> Oops! The package needs a fair bit of attention to
> get it to pass R CMD
> check (which has got more difficult since < 2.0),
> I'll try to move on this
> fairly soon. If anyone else has changed code in Rmap
> that they can
> contribute - just the OGR interface, please let me
> know off-list.



From michela.cameletti at unimib.it  Wed Sep 28 17:42:59 2005
From: michela.cameletti at unimib.it (michela.cameletti)
Date: Wed, 28 Sep 2005 17:42:59 +0200
Subject: [R-sig-Geo] Handling realisations with geoR
Message-ID: <web-8468736@pablo.unimib.it>

Hi,
I'm Michela Cameletti from University of Bergamo (Italy); 
I'm a Phd student.
I'd like to do a geostatistical analysis of air pollution 
data: I have daily PM10 data (particulate matters with a 
diameter under 10 micron) for 10 monitoring stations (with 
x-y coordinates) and for a year.
For example, I have data in such a matrix (first and 
second columns contain the coordinates, the following 
columns cointain the data for the days of the year 203-one 
column for one day, the monitors are the same):
x	        y	  01/01/2003	 02/01/2003	,,,
555239	4988304	45	47	
557204	4989070	53	53	
604029	4961961	32	32	
605812	4960410	30	30	
628704	4950970	29	29	
629112	4949311	50	22	
631916	4950046	38	11	
So I think I have 365 realisations of the same process but 
can't handle this data with geoR package neither with the 
"realisations" options.
Can you help me please?
Thank you in advance,
best regards,
Michela CAmeletti



From paulojus at est.ufpr.br  Wed Sep 28 18:12:42 2005
From: paulojus at est.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 28 Sep 2005 13:12:42 -0300 (BRT)
Subject: [R-sig-Geo] Handling realisations with geoR
In-Reply-To: <web-8468736@pablo.unimib.it>
References: <web-8468736@pablo.unimib.it>
Message-ID: <Pine.LNX.4.63.0509281311010.10606@est.ufpr.br>

Michela

the option for realisations in geoR (in particular in the function likfit)
uses data in a different format: you need a vector indicating the 
realisations for each datum

If you have further enquires feel free to contact me directly

P.J.



On Wed, 28 Sep 2005, michela.cameletti wrote:

> Hi,
> I'm Michela Cameletti from University of Bergamo (Italy);
> I'm a Phd student.
> I'd like to do a geostatistical analysis of air pollution
> data: I have daily PM10 data (particulate matters with a
> diameter under 10 micron) for 10 monitoring stations (with
> x-y coordinates) and for a year.
> For example, I have data in such a matrix (first and
> second columns contain the coordinates, the following
> columns cointain the data for the days of the year 203-one
> column for one day, the monitors are the same):
> x	        y	  01/01/2003	 02/01/2003	,,,
> 555239	4988304	45	47
> 557204	4989070	53	53
> 604029	4961961	32	32
> 605812	4960410	30	30
> 628704	4950970	29	29
> 629112	4949311	50	22
> 631916	4950046	38	11
> So I think I have 365 realisations of the same process but
> can't handle this data with geoR package neither with the
> "realisations" options.
> Can you help me please?
> Thank you in advance,
> best regards,
> Michela CAmeletti
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

Paulo Justiniano Ribeiro Jr
LEG (Laborat?rio de Estat?stica e Geoinforma??o)
Departamento de Estat?stica
Universidade Federal do Paran?
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
Fax: (+55) 41 3361 3141
e-mail: paulojus at est.ufpr.br
http://www.est.ufpr.br/~paulojus

From michela.cameletti at unimib.it  Wed Sep 28 18:46:50 2005
From: michela.cameletti at unimib.it (michela.cameletti)
Date: Wed, 28 Sep 2005 18:46:50 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <web-8470571@pablo.unimib.it>

Thank you for your reply.
unfortunately I haven't understood how to put the data in 
the matrix and the realisations in the vector.
Could you be so kind to give me a little example? (I've 
done a lot of tries but I didn't succeed in doing it).
Thank you so much for your help,
Michela



From paulojus at est.ufpr.br  Wed Sep 28 19:04:27 2005
From: paulojus at est.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 28 Sep 2005 14:04:27 -0300 (BRT)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <web-8470571@pablo.unimib.it>
References: <web-8470571@pablo.unimib.it>
Message-ID: <Pine.LNX.4.63.0509281400080.10606@est.ufpr.br>

Supose you have a data-frame "foo" which is something like:

CoordX  CoordY Var  Real
    1       1   10   1
    1       2   11   1
    2       1   9    1
    2       2   8    1
    1       1   11   2
    1       2   13   2
    1       3   8    1

then you can read it as a geodata with:

foo.gd <- as.geodata(foo, realizations = 4)

and your geodata will be ready to be used.
For instance in likfit():

likfit(foo.gd, ini=c(2, .5), real=realisations)



On Wed, 28 Sep 2005, michela.cameletti wrote:

> Thank you for your reply.
> unfortunately I haven't understood how to put the data in
> the matrix and the realisations in the vector.
> Could you be so kind to give me a little example? (I've
> done a lot of tries but I didn't succeed in doing it).
> Thank you so much for your help,
> Michela
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

Paulo Justiniano Ribeiro Jr
LEG (Laborat?rio de Estat?stica e Geoinforma??o)
Departamento de Estat?stica
Universidade Federal do Paran?
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
Fax: (+55) 41 3361 3141
e-mail: paulojus at est.ufpr.br
http://www.est.ufpr.br/~paulojus

From hi_ono2001 at yahoo.co.jp  Thu Sep 29 09:46:19 2005
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Thu, 29 Sep 2005 16:46:19 +0900 (JST)
Subject: [R-sig-Geo] Couldn't access to DCluster support site
Message-ID: <20050929074619.24031.qmail@web1705.mail.yahoo.co.jp>

Hi.

 Recently I couldn't access to DCluster support site,
http://matheron.uv.es/~virgil/Rpackages/DCluster.

 Had this site been moved?


 Regards.



From Roger.Bivand at nhh.no  Thu Sep 29 12:49:01 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Sep 2005 12:49:01 +0200 (CEST)
Subject: [R-sig-Geo] maptools
In-Reply-To: <433bbedf.67d241d7.7369.fffffe9a@mx.gmail.com>
Message-ID: <Pine.LNX.4.44.0509291241300.8853-100000@reclus.nhh.no>

On Thu, 29 Sep 2005, Joao Pedro Azevedo wrote:

> I'm having trouble posting the message below on R-geo mailing list, and
> maybe you could easily help me.
> 
> 
> Hello all,
> I've been using the syntax below to plot a few maps with R, however I would
> like to know if would be possible to omit the box with y and x coordinates.
> I've gone through the online help and did not manage to find anything that
> seemed to do the job.
> Many help will be more than welcomed!
> Cheers,
> JP
> 
> 
> 
> library(maptools)
> x <- read.shape(system.file("shapes/sids.shp", package="maptools")[1])
> plot(x)
> nParts <- sapply(x$Shapes, function(x) attr(x, "nPart"))
> table(nParts)
> cols <- c("azure", "blue", "orange")
> fgs <- cols[nParts]
> plot(x, fg=fgs)
> res <- plot(x, auxvar=x$att.data$BIR74)
> str(res)
> res <- plot(x, auxvar=x$att.data$BIR74, type="e",ol = "transparent",
> prbg=NULL)
> str(res)
> 

Just using the "Map" created by read.shape(), the plot.Map() function 
allows but wronly passes through arguments to plot:

> library(maptools)
> x <- read.shape(system.file("shapes/sids.shp", package="maptools")[1])
Shapefile type: Polygon, (5), # of Shapes: 100
> plot(x, axes=FALSE, ann=FALSE)
There were 50 or more warnings (use warnings() to see the first 50)

Using the newer and much better supported mechanisms in the sp package 
(note that maptools depends on sp from version 0.5-*):

> xsp <- readShapePoly(system.file("shapes/sids.shp", 
+ package="maptools")[1], proj4string=CRS("+proj=longlat"))
> plot(xsp)
> nParts <- getSpPnParts(xsp)
> cols <- c("azure", "blue", "orange")
> fgs <- cols[nParts]
> plot(xsp, col=fgs)

and even:

> plot(xsp, col=fgs, axes=TRUE)

That is, the default for plot of Spatial* objects defined in sp is not to 
plot axes or annotate. We are encouraging users to try out the sp class 
objects rather than the legacy ones.

Best wishes,

Roger

> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jp.statalist at gmail.com  Thu Sep 29 18:54:48 2005
From: jp.statalist at gmail.com (JP Azevedo)
Date: Thu, 29 Sep 2005 13:54:48 -0300
Subject: [R-sig-Geo] Maptools and readShapePoly
Message-ID: <433c1c5d.343f68e6.2b31.668d@mx.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20050929/f7a277be/attachment.pl>

From jp.statalist at gmail.com  Thu Sep 29 19:01:40 2005
From: jp.statalist at gmail.com (JP Azevedo)
Date: Thu, 29 Sep 2005 14:01:40 -0300
Subject: [R-sig-Geo] Maptools and readShapePoly
Message-ID: <433c1df8.622d8102.789b.0249@mx.gmail.com>



From Roger.Bivand at nhh.no  Thu Sep 29 21:31:23 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Sep 2005 21:31:23 +0200 (CEST)
Subject: [R-sig-Geo] Maptools and readShapePoly
In-Reply-To: <433c1c5d.343f68e6.2b31.668d@mx.gmail.com>
Message-ID: <Pine.LNX.4.44.0509292111130.4133-100000@reclus.nhh.no>

On Thu, 29 Sep 2005, JP Azevedo wrote:

> Dear all,
> 
>  
> 
> I'm trying to use maptools to produce some figures using the Brazilian
> municipalities shape files (5,500 municipalities and ~9mb).
> 
>  
> 
> I've ran some examples suggested by Roger which worked fine with the
> sids.shp demo file.
> 
>  
> 
> library(maptools)
> 
>  
> 
> xsp <- readShapePoly(system.file("shapes/sids.shp",package="maptools")[1],
> proj4string=CRS("+proj=longlat"))
> 
> plot(xsp)
> 
>  
> 
> brks <- seq(min(xsp$BIR74), max(xsp$BIR74), length=7) 
> 
> brks
> 
> cols <- colorRampPalette(c("lightpink", "red"))(length(brks)-1) 
> 
> cols
> 
>  
> 
> plot(xsp, col=cols[findInterval(xsp$BIR74, brks, all.inside=TRUE)])
> 
>  
> 
>  
> 
> However, whenever I try to load the Brazilian data, R just stalls, and
> nothing happens.
> 

"stalls" suggests that you have hit an error condition and that the 
program has terminated abnormally. I think you just have to wait for it to 
finish working. If you have any system monitor, you can track whether the 
processor is fully occupied, and whether your disk is swapping (by ear).

>  
> 
> brasilsp <-
> readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",package="mapto
> ols")[1], proj4string=CRS("+proj=longlat +ellps=clrk66"))
> 

Well, using the very complicated system.file() function, which is only 
needed for accessing, surprisingly, system files shipped with the maptools 
package, makes things opaque.

> brasilsp <- readShapePoly("Brasil_municipios_2001.shp", 
+ proj4string=CRS("*")),

where * is the correct projection string for your shapefile, is easier. 
Maybe the projection string isn't important for you now.

This will take a long time for 5000+ polygons, especially if the 
boundaries are very detailed and have many islands and lakes. A map of 
Australia with about 40K polygons and about 147 Mb was read successfully 
(as far as I recall a longer lunch break on a regular office PC). I'll 
have another try with the same shapefile on a 1.5GHz machine.

However, very few useful statistical procedures can be done on this much 
data, and visualization, which involved drawing each polygon separately, 
is not going to be fast. R is not a GIS, and if visualising this kind of 
data is your main concern, I would recommend Terraview, QGIS, or other 
software aiming to get something to screen fast. 

Roger

>  
> 
> plot(brasilsp)
> 
>  
> 
> I've also tried to use the old  read.shape, which work fine the overall
> plot.
> 
>  
> 
> x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
> package="maptools")[1])
> 
>  
> 
> plot(x, axes=FALSE, xlab = "", ylab = "")
> 
>  
> 
> plot(x, axes=FALSE, xlab = "", ylab = "", ol = "transparent")
> 
>  
> 
> However, if I try to use the auxvar option, I get an error message.
> 
>  
> 
> plot(x, auxvar=x$att.data$TOTAL, type="e",ol = "transparent", prbg=NULL)
> 
>  
> 
> Error in plot.Map(x, auxvar = x$att.data$TOTAL, type = "e", ol =
> "transparent", :
> 
>  
> 
>  
> 
> Any help will be much appreciated.
> 
>  
> 
> Cheers,
> 
>  
> 
> JP
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ahertel at atmos.uiuc.edu  Thu Sep 29 21:42:23 2005
From: ahertel at atmos.uiuc.edu (Anne Hertel)
Date: Thu, 29 Sep 2005 14:42:23 -0500
Subject: [R-sig-Geo] Adding maps to a filled contour plot
Message-ID: <web-7086743@atmos.uiuc.edu>

Hi,

I am trying to plot a filled contour map and overlay it with a map, but I'm having trouble with the map. The map is plotted, but it is stretched out over the color bar, and doesn't stay within the plotting area. If I just use the 'contour' function the 'map' function works fine, but I want the contours filled in.

Here's the code:
filled.contour(cor.enso.map, x=seq(-126.5625,-64.6875,,23),y=seq(23.720175,51.625732,,11),xlab='longitude',ylab='latitude')
map(xlim=c(-127,-65),ylim=c(23,52),add=T)

where cor.enso.map is a matrix of size [23,11].

How do I make the map stay within the plotting area?

Thanks,
Anne Hertel


------------------------------------------------------------
Anne M. K. Hertel
Grad. Student & Research Assistant
Department of Atmospheric Sciences
University of Illinois at Urbana-Champaign
Annex II, room 204
Phone: (217) 333 6296



From Roger.Bivand at nhh.no  Fri Sep 30 08:41:20 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Sep 2005 08:41:20 +0200 (CEST)
Subject: [R-sig-Geo] Maptools and readShapePoly
In-Reply-To: <Pine.LNX.4.44.0509292111130.4133-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0509300821570.15619-100000@reclus.nhh.no>

On Thu, 29 Sep 2005, Roger Bivand wrote:

> On Thu, 29 Sep 2005, JP Azevedo wrote:
> 
> > Dear all,
> > 
> >  
> > 
> > I'm trying to use maptools to produce some figures using the Brazilian
> > municipalities shape files (5,500 municipalities and ~9mb).
> > 
> >  
> > 
> > I've ran some examples suggested by Roger which worked fine with the
> > sids.shp demo file.
> > 
> >  
> > 
> > library(maptools)
> > 
> >  
> > 
> > xsp <- readShapePoly(system.file("shapes/sids.shp",package="maptools")[1],
> > proj4string=CRS("+proj=longlat"))
> > 
> > plot(xsp)
> > 
> >  
> > 
> > brks <- seq(min(xsp$BIR74), max(xsp$BIR74), length=7) 
> > 
> > brks
> > 
> > cols <- colorRampPalette(c("lightpink", "red"))(length(brks)-1) 
> > 
> > cols
> > 
> >  
> > 
> > plot(xsp, col=cols[findInterval(xsp$BIR74, brks, all.inside=TRUE)])
> > 
> >  
> > 
> >  
> > 
> > However, whenever I try to load the Brazilian data, R just stalls, and
> > nothing happens.
> > 
> 
> "stalls" suggests that you have hit an error condition and that the 
> program has terminated abnormally. I think you just have to wait for it to 
> finish working. If you have any system monitor, you can track whether the 
> processor is fully occupied, and whether your disk is swapping (by ear).
> 
> >  
> > 
> > brasilsp <-
> > readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",package="mapto
> > ols")[1], proj4string=CRS("+proj=longlat +ellps=clrk66"))
> > 
> 
> Well, using the very complicated system.file() function, which is only 
> needed for accessing, surprisingly, system files shipped with the maptools 
> package, makes things opaque.
> 
> > brasilsp <- readShapePoly("Brasil_municipios_2001.shp", 
> + proj4string=CRS("*")),
> 
> where * is the correct projection string for your shapefile, is easier. 
> Maybe the projection string isn't important for you now.
> 
> This will take a long time for 5000+ polygons, especially if the 
> boundaries are very detailed and have many islands and lakes. A map of 
> Australia with about 40K polygons and about 147 Mb was read successfully 
> (as far as I recall a longer lunch break on a regular office PC). I'll 
> have another try with the same shapefile on a 1.5GHz machine.

The test on the big Australian shapefile:

> version
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    2                
minor    1.1              
year     2005             
month    06               
day      20               
language R       
> library(maptools)
Loading required package: foreign
Loading required package: sp
> system.time(bigshp <- readShapePoly("test1.shp"))
[1] 1952.79  118.77 2593.95    0.00    0.00
> object.size(bigshp)
[1] 216375656
> file.info("test1.shp")$size
[1] 147221660
> file.info("test1.dbf")$size
[1] 6940350
> np <- getSpPnParts(bigshp)
> length(np)
[1] 40349
> sum(np)
[1] 41209
> system.time(plot(bigshp))
[1]   94.77   25.71 1559.77    0.00    0.00

The R process ran to well over physical memory (1GB), so the difference 
between user time (the first number) and elapsed time (the third number) 
was swapping (my disk is not very fast). So the read took of the order av 
45 minutes, and could have been faster with more memory.

None of the small polygons were visible on the screen plot at all, with 
transparent borders, they might have got a pixel.

This is closer to your scenario:

> library(maptools)
Loading required package: foreign
Loading required package: sp
> system.time(bigshp <- readShapePoly("co99_d00.shp"))
[1] 131.30   0.61 134.28   0.00   0.00
> object.size(bigshp)
[1] 19088508
> file.info("co99_d00.dbf")$size
[1] 733012
> file.info("co99_d00.shp")$size
[1] 13108428
> np <- getSpPnParts(bigshp)
> length(np)
[1] 3489
> sum(np)
[1] 3525
> system.time(plot(bigshp))
[1] 4.53 0.32 5.43 0.00 0.00

which is for over 3000 counties in the US (continental and all islands, 
file from the US Census site). I think that is acceptable, given that the 
SpatialPolygonsDataFrame object can be saved as an R binary object and 
loaded when needed - it doesn't have to ve read from a shapefile every 
time.

Roger

> 
> However, very few useful statistical procedures can be done on this much 
> data, and visualization, which involved drawing each polygon separately, 
> is not going to be fast. R is not a GIS, and if visualising this kind of 
> data is your main concern, I would recommend Terraview, QGIS, or other 
> software aiming to get something to screen fast. 
> 
> Roger
> 
> >  
> > 
> > plot(brasilsp)
> > 
> >  
> > 
> > I've also tried to use the old  read.shape, which work fine the overall
> > plot.
> > 
> >  
> > 
> > x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
> > package="maptools")[1])
> > 
> >  
> > 
> > plot(x, axes=FALSE, xlab = "", ylab = "")
> > 
> >  
> > 
> > plot(x, axes=FALSE, xlab = "", ylab = "", ol = "transparent")
> > 
> >  
> > 
> > However, if I try to use the auxvar option, I get an error message.
> > 
> >  
> > 
> > plot(x, auxvar=x$att.data$TOTAL, type="e",ol = "transparent", prbg=NULL)
> > 
> >  
> > 
> > Error in plot.Map(x, auxvar = x$att.data$TOTAL, type = "e", ol =
> > "transparent", :
> > 
> >  
> > 
> >  
> > 
> > Any help will be much appreciated.
> > 
> >  
> > 
> > Cheers,
> > 
> >  
> > 
> > JP
> > 
> >  
> > 
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jp.statalist at gmail.com  Fri Sep 30 12:09:16 2005
From: jp.statalist at gmail.com (JP Azevedo)
Date: Fri, 30 Sep 2005 07:09:16 -0300
Subject: [R-sig-Geo] Maptools and readShapePoly
In-Reply-To: <Pine.LNX.4.44.0509300821570.15619-100000@reclus.nhh.no>
Message-ID: <433d0ed3.3a8e93a8.775e.ffffffd4@mx.gmail.com>

Dear Roger,

Many thanks for your attention on this matter.

Last night I was trying to implement your suggestions but things did not get
got as I expected. I've only manage to load the shape files using the old
read.shape, however I did not manage to color the figure according to an
auxvar. My priority is to try to use the readShapePoly.

I'm running this from a Centrino 1.73 with 1.5 Gb of RAM. 


These are to examples of the readShapePoly syntax and both of them yield
error messages.

> 
> 
> brasilsp <- readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",
package="maptools")[1], proj4string=CRS("*"))
Error in "dimnames<-.data.frame"(`*tmp*`, value = list(c("0", "1", "2",  : 
        invalid 'dimnames' given for data frame
> 
> brasilsp <- readShapePoly("shapes\Brasil_municipios_2001.shp",
proj4string=CRS("*"))
Error in read.shape(filen = fn, verbose = verbose) : 
        unable to open file
> 
> 
>


When I use the old read.shape, I manage to load and plot the shape file if I
use the full command, however the other two attempts fail. 

> 
> x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
package="maptools")[1])
Shapefile type: Polygon, (5), # of Shapes: 5563
> 
> x <- read.shape("shapes/Brasil_municipios_2001.shp", package="maptools")
Error in read.shape("shapes/Brasil_municipios_2001.shp", package =
"maptools") : 
        unused argument(s) (package ...)
> 
> x <- read.shape("shapes/Brasil_municipios_2001.shp")
Error in read.shape("shapes/Brasil_municipios_2001.shp") : 
        unable to open file
> 
>


Cheers,

JP

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Friday, September 30, 2005 3:41 AM
To: JP Azevedo
Cc: R-sig-Geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Maptools and readShapePoly

On Thu, 29 Sep 2005, Roger Bivand wrote:

> On Thu, 29 Sep 2005, JP Azevedo wrote:
> 
> > Dear all,
> > 
> >  
> > 
> > I'm trying to use maptools to produce some figures using the Brazilian
> > municipalities shape files (5,500 municipalities and ~9mb).
> > 
> >  
> > 
> > I've ran some examples suggested by Roger which worked fine with the
> > sids.shp demo file.
> > 
> >  
> > 
> > library(maptools)
> > 
> >  
> > 
> > xsp <-
readShapePoly(system.file("shapes/sids.shp",package="maptools")[1],
> > proj4string=CRS("+proj=longlat"))
> > 
> > plot(xsp)
> > 
> >  
> > 
> > brks <- seq(min(xsp$BIR74), max(xsp$BIR74), length=7) 
> > 
> > brks
> > 
> > cols <- colorRampPalette(c("lightpink", "red"))(length(brks)-1) 
> > 
> > cols
> > 
> >  
> > 
> > plot(xsp, col=cols[findInterval(xsp$BIR74, brks, all.inside=TRUE)])
> > 
> >  
> > 
> >  
> > 
> > However, whenever I try to load the Brazilian data, R just stalls, and
> > nothing happens.
> > 
> 
> "stalls" suggests that you have hit an error condition and that the 
> program has terminated abnormally. I think you just have to wait for it to

> finish working. If you have any system monitor, you can track whether the 
> processor is fully occupied, and whether your disk is swapping (by ear).
> 
> >  
> > 
> > brasilsp <-
> >
readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",package="mapto
> > ols")[1], proj4string=CRS("+proj=longlat +ellps=clrk66"))
> > 
> 
> Well, using the very complicated system.file() function, which is only 
> needed for accessing, surprisingly, system files shipped with the maptools

> package, makes things opaque.
> 
> > brasilsp <- readShapePoly("Brasil_municipios_2001.shp", 
> + proj4string=CRS("*")),
> 
> where * is the correct projection string for your shapefile, is easier. 
> Maybe the projection string isn't important for you now.
> 
> This will take a long time for 5000+ polygons, especially if the 
> boundaries are very detailed and have many islands and lakes. A map of 
> Australia with about 40K polygons and about 147 Mb was read successfully 
> (as far as I recall a longer lunch break on a regular office PC). I'll 
> have another try with the same shapefile on a 1.5GHz machine.

The test on the big Australian shapefile:

> version
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    2                
minor    1.1              
year     2005             
month    06               
day      20               
language R       
> library(maptools)
Loading required package: foreign
Loading required package: sp
> system.time(bigshp <- readShapePoly("test1.shp"))
[1] 1952.79  118.77 2593.95    0.00    0.00
> object.size(bigshp)
[1] 216375656
> file.info("test1.shp")$size
[1] 147221660
> file.info("test1.dbf")$size
[1] 6940350
> np <- getSpPnParts(bigshp)
> length(np)
[1] 40349
> sum(np)
[1] 41209
> system.time(plot(bigshp))
[1]   94.77   25.71 1559.77    0.00    0.00

The R process ran to well over physical memory (1GB), so the difference 
between user time (the first number) and elapsed time (the third number) 
was swapping (my disk is not very fast). So the read took of the order av 
45 minutes, and could have been faster with more memory.

None of the small polygons were visible on the screen plot at all, with 
transparent borders, they might have got a pixel.

This is closer to your scenario:

> library(maptools)
Loading required package: foreign
Loading required package: sp
> system.time(bigshp <- readShapePoly("co99_d00.shp"))
[1] 131.30   0.61 134.28   0.00   0.00
> object.size(bigshp)
[1] 19088508
> file.info("co99_d00.dbf")$size
[1] 733012
> file.info("co99_d00.shp")$size
[1] 13108428
> np <- getSpPnParts(bigshp)
> length(np)
[1] 3489
> sum(np)
[1] 3525
> system.time(plot(bigshp))
[1] 4.53 0.32 5.43 0.00 0.00

which is for over 3000 counties in the US (continental and all islands, 
file from the US Census site). I think that is acceptable, given that the 
SpatialPolygonsDataFrame object can be saved as an R binary object and 
loaded when needed - it doesn't have to ve read from a shapefile every 
time.

Roger

> 
> However, very few useful statistical procedures can be done on this much 
> data, and visualization, which involved drawing each polygon separately, 
> is not going to be fast. R is not a GIS, and if visualising this kind of 
> data is your main concern, I would recommend Terraview, QGIS, or other 
> software aiming to get something to screen fast. 
> 
> Roger
> 
> >  
> > 
> > plot(brasilsp)
> > 
> >  
> > 
> > I've also tried to use the old  read.shape, which work fine the overall
> > plot.
> > 
> >  
> > 
> > x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
> > package="maptools")[1])
> > 
> >  
> > 
> > plot(x, axes=FALSE, xlab = "", ylab = "")
> > 
> >  
> > 
> > plot(x, axes=FALSE, xlab = "", ylab = "", ol = "transparent")
> > 
> >  
> > 
> > However, if I try to use the auxvar option, I get an error message.
> > 
> >  
> > 
> > plot(x, auxvar=x$att.data$TOTAL, type="e",ol = "transparent", prbg=NULL)
> > 
> >  
> > 
> > Error in plot.Map(x, auxvar = x$att.data$TOTAL, type = "e", ol =
> > "transparent", :
> > 
> >  
> > 
> >  
> > 
> > Any help will be much appreciated.
> > 
> >  
> > 
> > Cheers,
> > 
> >  
> > 
> > JP
> > 
> >  
> > 
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Sep 30 12:47:16 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Sep 2005 12:47:16 +0200 (CEST)
Subject: [R-sig-Geo] Maptools and readShapePoly
In-Reply-To: <433d0ed3.3a8e93a8.775e.ffffffd4@mx.gmail.com>
Message-ID: <Pine.LNX.4.44.0509301217010.15787-100000@reclus.nhh.no>

On Fri, 30 Sep 2005, JP Azevedo wrote:

> Dear Roger,
> 
> Many thanks for your attention on this matter.
> 
> Last night I was trying to implement your suggestions but things did not get
> got as I expected. I've only manage to load the shape files using the old
> read.shape, however I did not manage to color the figure according to an
> auxvar. My priority is to try to use the readShapePoly.
> 
> I'm running this from a Centrino 1.73 with 1.5 Gb of RAM. 
> 

Please also post the output of:

> version
> library(maptools)
> maptools()
> read.dcf(system.file("DESCRIPTION", package="sp"))[2]

so that we know what your system is.

> 
> These are to examples of the readShapePoly syntax and both of them yield
> error messages.
> 
> > 
> > 
> > brasilsp <- readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",
> package="maptools")[1], proj4string=CRS("*"))
> Error in "dimnames<-.data.frame"(`*tmp*`, value = list(c("0", "1", "2",  : 
>         invalid 'dimnames' given for data frame
> > 
> > brasilsp <- readShapePoly("shapes\Brasil_municipios_2001.shp",
> proj4string=CRS("*"))
> Error in read.shape(filen = fn, verbose = verbose) : 
>         unable to open file
> > 

I already suggested that you review where you keep your files. Please 
never keep your own data inside the installed package directory tree, this 
is quite unnecessary, and your files will be lost if you update the 
package. Just keep your own shapefiles where you will be working (that is, 
not where R is installed or where the packages are installed). On Windows, 
you can easily change the working directory for R from the GUI File -> 
menu, or use setwd(). On Windows you can also choose the shapefile 
interactively by saying:

brasilsp <- readShapePoly(file.choose())

ignoring the proj4string unless you need it.

Once you can access the shapefile without putting it in harm's way in the 
package own directory tree, we can get back to the 

Error in "dimnames<-.data.frame"(`*tmp*`, value = list(c("0", "1", "2",  :
        invalid 'dimnames' given for data frame

question. If you can put the shapefile components in a zip archive on a 
website, I can access them and see where that problem might be.

Roger

PS: the system.file() function is used in the examples to be able to 
distribute shapefiles with the package, which may be installed by users in 
varying locations. It is _not_ intended in any way to suggest that this 
is the only place the function looks for data. 


> > 
> >
> 
> 
> When I use the old read.shape, I manage to load and plot the shape file if I
> use the full command, however the other two attempts fail. 
> 
> > 
> > x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
> package="maptools")[1])
> Shapefile type: Polygon, (5), # of Shapes: 5563
> > 
> > x <- read.shape("shapes/Brasil_municipios_2001.shp", package="maptools")
> Error in read.shape("shapes/Brasil_municipios_2001.shp", package =
> "maptools") : 
>         unused argument(s) (package ...)
> > 
> > x <- read.shape("shapes/Brasil_municipios_2001.shp")
> Error in read.shape("shapes/Brasil_municipios_2001.shp") : 
>         unable to open file
> > 
> >
> 
> 
> Cheers,
> 
> JP
> 
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
> Sent: Friday, September 30, 2005 3:41 AM
> To: JP Azevedo
> Cc: R-sig-Geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Maptools and readShapePoly
> 
> On Thu, 29 Sep 2005, Roger Bivand wrote:
> 
> > On Thu, 29 Sep 2005, JP Azevedo wrote:
> > 
> > > Dear all,
> > > 
> > >  
> > > 
> > > I'm trying to use maptools to produce some figures using the Brazilian
> > > municipalities shape files (5,500 municipalities and ~9mb).
> > > 
> > >  
> > > 
> > > I've ran some examples suggested by Roger which worked fine with the
> > > sids.shp demo file.
> > > 
> > >  
> > > 
> > > library(maptools)
> > > 
> > >  
> > > 
> > > xsp <-
> readShapePoly(system.file("shapes/sids.shp",package="maptools")[1],
> > > proj4string=CRS("+proj=longlat"))
> > > 
> > > plot(xsp)
> > > 
> > >  
> > > 
> > > brks <- seq(min(xsp$BIR74), max(xsp$BIR74), length=7) 
> > > 
> > > brks
> > > 
> > > cols <- colorRampPalette(c("lightpink", "red"))(length(brks)-1) 
> > > 
> > > cols
> > > 
> > >  
> > > 
> > > plot(xsp, col=cols[findInterval(xsp$BIR74, brks, all.inside=TRUE)])
> > > 
> > >  
> > > 
> > >  
> > > 
> > > However, whenever I try to load the Brazilian data, R just stalls, and
> > > nothing happens.
> > > 
> > 
> > "stalls" suggests that you have hit an error condition and that the 
> > program has terminated abnormally. I think you just have to wait for it to
> 
> > finish working. If you have any system monitor, you can track whether the 
> > processor is fully occupied, and whether your disk is swapping (by ear).
> > 
> > >  
> > > 
> > > brasilsp <-
> > >
> readShapePoly(system.file("shapes/Brasil_municipios_2001.shp",package="mapto
> > > ols")[1], proj4string=CRS("+proj=longlat +ellps=clrk66"))
> > > 
> > 
> > Well, using the very complicated system.file() function, which is only 
> > needed for accessing, surprisingly, system files shipped with the maptools
> 
> > package, makes things opaque.
> > 
> > > brasilsp <- readShapePoly("Brasil_municipios_2001.shp", 
> > + proj4string=CRS("*")),
> > 
> > where * is the correct projection string for your shapefile, is easier. 
> > Maybe the projection string isn't important for you now.
> > 
> > This will take a long time for 5000+ polygons, especially if the 
> > boundaries are very detailed and have many islands and lakes. A map of 
> > Australia with about 40K polygons and about 147 Mb was read successfully 
> > (as far as I recall a longer lunch break on a regular office PC). I'll 
> > have another try with the same shapefile on a 1.5GHz machine.
> 
> The test on the big Australian shapefile:
> 
> > version
>          _                
> platform i686-pc-linux-gnu
> arch     i686             
> os       linux-gnu        
> system   i686, linux-gnu  
> status                    
> major    2                
> minor    1.1              
> year     2005             
> month    06               
> day      20               
> language R       
> > library(maptools)
> Loading required package: foreign
> Loading required package: sp
> > system.time(bigshp <- readShapePoly("test1.shp"))
> [1] 1952.79  118.77 2593.95    0.00    0.00
> > object.size(bigshp)
> [1] 216375656
> > file.info("test1.shp")$size
> [1] 147221660
> > file.info("test1.dbf")$size
> [1] 6940350
> > np <- getSpPnParts(bigshp)
> > length(np)
> [1] 40349
> > sum(np)
> [1] 41209
> > system.time(plot(bigshp))
> [1]   94.77   25.71 1559.77    0.00    0.00
> 
> The R process ran to well over physical memory (1GB), so the difference 
> between user time (the first number) and elapsed time (the third number) 
> was swapping (my disk is not very fast). So the read took of the order av 
> 45 minutes, and could have been faster with more memory.
> 
> None of the small polygons were visible on the screen plot at all, with 
> transparent borders, they might have got a pixel.
> 
> This is closer to your scenario:
> 
> > library(maptools)
> Loading required package: foreign
> Loading required package: sp
> > system.time(bigshp <- readShapePoly("co99_d00.shp"))
> [1] 131.30   0.61 134.28   0.00   0.00
> > object.size(bigshp)
> [1] 19088508
> > file.info("co99_d00.dbf")$size
> [1] 733012
> > file.info("co99_d00.shp")$size
> [1] 13108428
> > np <- getSpPnParts(bigshp)
> > length(np)
> [1] 3489
> > sum(np)
> [1] 3525
> > system.time(plot(bigshp))
> [1] 4.53 0.32 5.43 0.00 0.00
> 
> which is for over 3000 counties in the US (continental and all islands, 
> file from the US Census site). I think that is acceptable, given that the 
> SpatialPolygonsDataFrame object can be saved as an R binary object and 
> loaded when needed - it doesn't have to ve read from a shapefile every 
> time.
> 
> Roger
> 
> > 
> > However, very few useful statistical procedures can be done on this much 
> > data, and visualization, which involved drawing each polygon separately, 
> > is not going to be fast. R is not a GIS, and if visualising this kind of 
> > data is your main concern, I would recommend Terraview, QGIS, or other 
> > software aiming to get something to screen fast. 
> > 
> > Roger
> > 
> > >  
> > > 
> > > plot(brasilsp)
> > > 
> > >  
> > > 
> > > I've also tried to use the old  read.shape, which work fine the overall
> > > plot.
> > > 
> > >  
> > > 
> > > x <- read.shape(system.file("shapes/Brasil_municipios_2001.shp",
> > > package="maptools")[1])
> > > 
> > >  
> > > 
> > > plot(x, axes=FALSE, xlab = "", ylab = "")
> > > 
> > >  
> > > 
> > > plot(x, axes=FALSE, xlab = "", ylab = "", ol = "transparent")
> > > 
> > >  
> > > 
> > > However, if I try to use the auxvar option, I get an error message.
> > > 
> > >  
> > > 
> > > plot(x, auxvar=x$att.data$TOTAL, type="e",ol = "transparent", prbg=NULL)
> > > 
> > >  
> > > 
> > > Error in plot.Map(x, auxvar = x$att.data$TOTAL, type = "e", ol =
> > > "transparent", :
> > > 
> > >  
> > > 
> > >  
> > > 
> > > Any help will be much appreciated.
> > > 
> > >  
> > > 
> > > Cheers,
> > > 
> > >  
> > > 
> > > JP
> > > 
> > >  
> > > 
> > > 
> > > 	[[alternative HTML version deleted]]
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > 
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From greg.snow at ihc.com  Fri Sep 30 19:58:35 2005
From: greg.snow at ihc.com (Greg Snow)
Date: Fri, 30 Sep 2005 11:58:35 -0600
Subject: [R-sig-Geo] Adding maps to a filled contour plot
Message-ID: <s33d2877.034@lp-msg1.co.ihc.com>

try this:

filled.contour(cor.enso.map,
x=seq(-126.5625,-64.6875,,23),y=seq(23.720175,51.625732,,11),xlab='longitude',ylab='latitude',
plot.axes={map(xlim=c(-127,-65),ylim=c(23,52),add=T)  } )

The problem is that filled.contour uses the layout function to divide
the device into 2 pieces and plots the contour plot in 1 piece and the
color bar in the other.  When the function ends you have just the whole
device without the information on how it was split.

By passing the call to map in the plot.axes statement, it will plot the
map while the layout is still in effect and only plot it in the right
piece.

Hope this helps,


Greg Snow, Ph.D.
Statistical Data Center, LDS Hospital
Intermountain Health Care
greg.snow at ihc.com
(801) 408-8111

>>> "Anne Hertel" <ahertel at atmos.uiuc.edu> 09/29/05 01:42PM >>>
Hi,

I am trying to plot a filled contour map and overlay it with a map, but
I'm having trouble with the map. The map is plotted, but it is stretched
out over the color bar, and doesn't stay within the plotting area. If I
just use the 'contour' function the 'map' function works fine, but I
want the contours filled in.

Here's the code:
filled.contour(cor.enso.map,
x=seq(-126.5625,-64.6875,,23),y=seq(23.720175,51.625732,,11),xlab='longitude',ylab='latitude')
map(xlim=c(-127,-65),ylim=c(23,52),add=T)

where cor.enso.map is a matrix of size [23,11].

How do I make the map stay within the plotting area?

Thanks,
Anne Hertel


------------------------------------------------------------
Anne M. K. Hertel
Grad. Student & Research Assistant
Department of Atmospheric Sciences
University of Illinois at Urbana-Champaign
Annex II, room 204
Phone: (217) 333 6296

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch 
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From spluque at gmail.com  Fri Sep 30 21:57:28 2005
From: spluque at gmail.com (Sebastian Luque)
Date: Fri, 30 Sep 2005 14:57:28 -0500
Subject: [R-sig-Geo] clipping in maptools
Message-ID: <871x36gwgn.fsf@gmail.com>

Hi,

I'm using package maptools for reading and plotting shape files, and am
looking for a way to "clip" the shapes for plotting only.  More
precisely, I need to plot only a certain region of the original shape file
by providing the N, S, E, and W latitudes and longitudes that bound the
region.  If this is not possible in maptools, can somebody please suggest
a package to do this sort of manipulation?


Thanks in advance,

-- 
Sebastian P. Luque



From Roger.Bivand at nhh.no  Fri Sep 30 23:38:39 2005
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Sep 2005 23:38:39 +0200 (CEST)
Subject: [R-sig-Geo] clipping in maptools
In-Reply-To: <871x36gwgn.fsf@gmail.com>
Message-ID: <Pine.LNX.4.44.0509302325290.17069-100000@reclus.nhh.no>

On Fri, 30 Sep 2005, Sebastian Luque wrote:

> Hi,
> 
> I'm using package maptools for reading and plotting shape files, and am
> looking for a way to "clip" the shapes for plotting only.  More
> precisely, I need to plot only a certain region of the original shape file
> by providing the N, S, E, and W latitudes and longitudes that bound the
> region.  If this is not possible in maptools, can somebody please suggest
> a package to do this sort of manipulation?
> 

> library(maptools)
Loading required package: foreign
Loading required package: sp
> xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], 
+ proj4string=CRS("+proj=longlat +ellps=clrk66"))
> plot(xx, border="blue", axes=TRUE, las=1)
> plot(xx, border="blue", axes=TRUE, las=1, xlim=c(-82,-78), xaxs="i")

Using the plot method for sp class SpatialPolygons, the xlim= and ylim=
arguments do what you want. They do in plot.polylist() too, but in
plot.Map() you get warnings when the arguments are passed to plotting
functions that don't know about them.

If you have an updated maptools package - which depends on the sp package 
being installed too, just use xlim= and ylim= to define your plot area, or 
with older maptools versions (< 0.5) use plot.polylist(). Both the plot 
method for Spatial Polygons and plot.polylist respect the xaxs= and yaxs= 
arguments (setting them to "i" bounds the axes tightly to the *lim= 
values, the default value of "r" "grows" the axes 4% at each end, see ?par 
for details).

> 
> Thanks in advance,
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



