From j@ck@onmrodrigue@ @ending from gm@il@com  Sun Nov  4 01:13:31 2018
From: j@ck@onmrodrigue@ @ending from gm@il@com (Jackson Rodrigues)
Date: Sat, 3 Nov 2018 21:13:31 -0300
Subject: [R-sig-Geo] Mean every 12 layers (months)
Message-ID: <CAPL76w_bt5QbWXodVM1jHWAgUep6gLD1w8Nb7A=FN696DCax-A@mail.gmail.com>

Hi fellows,

My name is Jackson.

I have 2 questions. I am gratful for any help for anyone.

----------------------
*Question 1*
Regarding extracting multiple mean from long raster file.
 I want to reduce 6000 layers (1 per month) to 500 (1 per year)

library(raster)
>TS20 = brick("trace.20.10200-09701BP.cam2.h0.TS.nc", level=1, var="TS")
#It extents from 10200 BP to 9701 BP- a total of 6000 layers (1 per month)
>TS20 = rotate(TS20)
>TS20
class       : RasterBrick
dimensions  : 48, 96, 4608, 6000  (nrow, ncol, ncell, nlayers)
resolution  : 3.75, 3.708898  (x, y)
extent      : -178.125, 181.875, -89.01354, 89.01354  (xmin, xmax, ymin,
ymax)

>indices<-rep(1:6000,each=12) #found somewhere 6000 layers / 12 months =
500 annual layers
>s.mean<-stackApply(TS20, indices, fun = mean)
Warning message:
In ind[] <- indices :
  number of items to replace is not a multiple of replacement length

#Why do I get this warning message?  My raster has 6000 layers, so my
indices should work, or not?
---------------------------
*Question 2*
how could rename my layers combining years and months ?
For example?
Layer 1 should be TS20$10200.Jan
Layer 2 should be TS20$10200.Feb
...
Layer 6000 should be TS20$9701.Dec

In the end I will calculate seasonal mean. So, this is why I would like to
rename them.

Thank you all,

Jackson

	[[alternative HTML version deleted]]


From niko@@m@@tr@nton@@ @ending from gm@il@com  Sun Nov  4 01:44:35 2018
From: niko@@m@@tr@nton@@ @ending from gm@il@com (Nikos Mastrantonas)
Date: Sun, 4 Nov 2018 00:44:35 +0000
Subject: [R-sig-Geo] Mean every 12 layers (months)
In-Reply-To: <CAPL76w_bt5QbWXodVM1jHWAgUep6gLD1w8Nb7A=FN696DCax-A@mail.gmail.com>
References: <CAPL76w_bt5QbWXodVM1jHWAgUep6gLD1w8Nb7A=FN696DCax-A@mail.gmail.com>
Message-ID: <CAG=+uQyGGeq-OBqV1uHqP3qnEoMVFZaVcz0UPEPzOZ_n7DJAPQ@mail.gmail.com>

Hi Jackson,

Regarding your first question, your indices vector has 6000X12 elements,
since you repeat each number 12 times.
You could maybe do:
indices <- rep(1:500,each=12), so you end up with 6000 elements

For the second question, one way you could do that is to add the zoo
package and do the following:
library(zoo)
TS20 at z$date <- as.yearmon(...) # give a vector with the dates of the layers
with this way you will have the date of each layer in a 'date' format and
thus you will be able to easily select the layers you want on a later stage
(eg, choose specific months, specific years, etc).
Otherwise, you could use:
names(TS20) <- ... # give a vector with the new layer names

Hope the info can be helpful to you.

Thanks,
Nikos

*-------------------------------------------------------*
*Nikolaos Mastrantonas*

*Phone: *+44 (0) 7599 843061
*E-mail: nikos.mastrantonas at gmail.com <nikos.mastrantonas at gmail.com>*
*Linkedin*: nikolaosmastrantonas
<http://www.linkedin.com/in/nikolaosmastrantonas>


On Sun, 4 Nov 2018 at 00:14, Jackson Rodrigues <jacksonmrodrigues at gmail.com>
wrote:

> Hi fellows,
>
> My name is Jackson.
>
> I have 2 questions. I am gratful for any help for anyone.
>
> ----------------------
> *Question 1*
> Regarding extracting multiple mean from long raster file.
>  I want to reduce 6000 layers (1 per month) to 500 (1 per year)
>
> library(raster)
> >TS20 = brick("trace.20.10200-09701BP.cam2.h0.TS.nc", level=1, var="TS")
> #It extents from 10200 BP to 9701 BP- a total of 6000 layers (1 per month)
> >TS20 = rotate(TS20)
> >TS20
> class       : RasterBrick
> dimensions  : 48, 96, 4608, 6000  (nrow, ncol, ncell, nlayers)
> resolution  : 3.75, 3.708898  (x, y)
> extent      : -178.125, 181.875, -89.01354, 89.01354  (xmin, xmax, ymin,
> ymax)
>
> >indices<-rep(1:6000,each=12) #found somewhere 6000 layers / 12 months =
> 500 annual layers
> >s.mean<-stackApply(TS20, indices, fun = mean)
> Warning message:
> In ind[] <- indices :
>   number of items to replace is not a multiple of replacement length
>
> #Why do I get this warning message?  My raster has 6000 layers, so my
> indices should work, or not?
> ---------------------------
> *Question 2*
> how could rename my layers combining years and months ?
> For example?
> Layer 1 should be TS20$10200.Jan
> Layer 2 should be TS20$10200.Feb
> ...
> Layer 6000 should be TS20$9701.Dec
>
> In the end I will calculate seasonal mean. So, this is why I would like to
> rename them.
>
> Thank you all,
>
> Jackson
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From miluji@b @ending from gm@il@com  Sun Nov  4 18:39:55 2018
From: miluji@b @ending from gm@il@com (Miluji Sb)
Date: Sun, 4 Nov 2018 18:39:55 +0100
Subject: [R-sig-Geo] Raster to rasterbrick does not preserve Date/Time
Message-ID: <CAMLwc7NXecPCWSz873-zNq7vxr7Mzhd=LsvsCbVZbYcrut4JFg@mail.gmail.com>

Dear all,

I have a raster with multiple variables and date/time information;

      time  Size:17164   *** is unlimited ***
            standard_name: time
            bounds: time_bnds
            units: day as %Y%m%d.%f
            calendar: proleptic_gregorian
        bnds  Size:2

My goal is to convert the raster file to rasterbrick for extraction
purposes;

rbrick <- brick(r,  values=TRUE, varname="var1")

However, after conversion - the date/time information is not preserved. How
can I preserve this information?

class       : RasterBrick
dimensions  : 600, 1440, 864000, 17164  (nrow, ncol, ncell, nlayers)
resolution  : 0.25, 0.25  (x, y)
extent      : -180, 180, -60, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
data source : /work/ncfile.nc4
names       : X19700101.4375, X19700102.4375, X19700103.4375,
X19700104.4375, X19700105.4375, X19700106.4375, X19700107.4375,
X19700108.4375, X19700109.4375, X19700110.4375, X19700111.4375,
X19700112.4375, X19700113.4375, X19700114.4375, X19700115.4375, ...
z-value     : 19700101.4375, 20161231.4375 (min, max)
varname     : var1

Any help will be greatly appreciated!

Sincerely,

Milu

	[[alternative HTML version deleted]]


From btupper @ending from bigelow@org  Sun Nov  4 23:08:14 2018
From: btupper @ending from bigelow@org (Ben Tupper)
Date: Sun, 4 Nov 2018 17:08:14 -0500
Subject: [R-sig-Geo] Raster to rasterbrick does not preserve Date/Time
In-Reply-To: <CAMLwc7NXecPCWSz873-zNq7vxr7Mzhd=LsvsCbVZbYcrut4JFg@mail.gmail.com>
References: <CAMLwc7NXecPCWSz873-zNq7vxr7Mzhd=LsvsCbVZbYcrut4JFg@mail.gmail.com>
Message-ID: <13E271F3-6B86-402F-93B9-88E0348C561D@bigelow.org>

Hi,

I'm not sure about reading the datetime stamp directly form the file, but you have enough info to convert the z-value which is well described in your ncdf.  I'm not familiar with the '%.f' format specifier, but it looks like it is a fractional day.  Something like this perhaps will work?

z      <- raster::getZ(rbick)
z0     <- floor(z)
zf     <- z - z0
dt     <- as.POSIXct(as.character(z0), format = "%Y%m%d") + 24*60*60*zf
rbrick <- raster::setZ(rbrick, z, name = 'datetime')

You'll need to think through the timezone issues that might arise.  as.POSIXct() has arguments that can help you with that.

Cheers,
Ben


> On Nov 4, 2018, at 12:39 PM, Miluji Sb <milujisb at gmail.com> wrote:
> 
> Dear all,
> 
> I have a raster with multiple variables and date/time information;
> 
>      time  Size:17164   *** is unlimited ***
>            standard_name: time
>            bounds: time_bnds
>            units: day as %Y%m%d.%f
>            calendar: proleptic_gregorian
>        bnds  Size:2
> 
> My goal is to convert the raster file to rasterbrick for extraction
> purposes;
> 
> rbrick <- brick(r,  values=TRUE, varname="var1")
> 
> However, after conversion - the date/time information is not preserved. How
> can I preserve this information?
> 
> class       : RasterBrick
> dimensions  : 600, 1440, 864000, 17164  (nrow, ncol, ncell, nlayers)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -180, 180, -60, 90  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : /work/ncfile.nc4
> names       : X19700101.4375, X19700102.4375, X19700103.4375,
> X19700104.4375, X19700105.4375, X19700106.4375, X19700107.4375,
> X19700108.4375, X19700109.4375, X19700110.4375, X19700111.4375,
> X19700112.4375, X19700113.4375, X19700114.4375, X19700115.4375, ...
> z-value     : 19700101.4375, 20161231.4375 (min, max)
> varname     : var1
> 
> Any help will be greatly appreciated!
> 
> Sincerely,
> 
> Milu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/


From p@trick@gir@udoux @ending from univ-fcomte@fr  Mon Nov  5 14:02:05 2018
From: p@trick@gir@udoux @ending from univ-fcomte@fr (Patrick Giraudoux)
Date: Mon, 5 Nov 2018 14:02:05 +0100
Subject: [R-sig-Geo] Reordering geographical coordinates clockwise to make a
 polygon
Message-ID: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>

Dear listers,

There is an interesting post here: 
https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order 
dealing on the issue. However, I would like to know if a function has 
been already developped in a R package.

I am coping with a young colleague's shapefile where borders of polygons 
have been drawn as lines quite inconsistently. To change this 
SpatialLinesDataFrame into a SpatialPoints object is easy. The idea is 
to? select the points? bordering each polygon (delete the others), 
define the point set as a Polygon, then rebuild step by step a 
SpatialPolygonsDataFrame with all its (~25) polygons. It would be much 
quicker than to redraw one by one the 5160 data points (two times on 
borders shared by two polygons).

The problem is that the points must be reordered clockwise (the way 
lines making the? borders is all except clockwise) before making them a 
polygon.

Any function already developped for that ?

Cheers,

Patrick




	[[alternative HTML version deleted]]


From edzer@pebe@m@ @ending from uni-muen@ter@de  Mon Nov  5 16:31:39 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Mon, 5 Nov 2018 16:31:39 +0100
Subject: [R-sig-Geo] 
 Reordering geographical coordinates clockwise to make a polygon
In-Reply-To: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
References: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
Message-ID: <3877f171-9063-e11f-2d62-770b1d259239@uni-muenster.de>

Look for argument check_ring_dir in the documentation of sf::st_read.

On 11/5/18 2:02 PM, Patrick Giraudoux wrote:
> Dear listers,
> 
> There is an interesting post here: 
> https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order 
> dealing on the issue. However, I would like to know if a function has 
> been already developped in a R package.
> 
> I am coping with a young colleague's shapefile where borders of polygons 
> have been drawn as lines quite inconsistently. To change this 
> SpatialLinesDataFrame into a SpatialPoints object is easy. The idea is 
> to? select the points? bordering each polygon (delete the others), 
> define the point set as a Polygon, then rebuild step by step a 
> SpatialPolygonsDataFrame with all its (~25) polygons. It would be much 
> quicker than to redraw one by one the 5160 data points (two times on 
> borders shared by two polygons).
> 
> The problem is that the points must be reordered clockwise (the way 
> lines making the? borders is all except clockwise) before making them a 
> polygon.
> 
> Any function already developped for that ?
> 
> Cheers,
> 
> Patrick
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181105/c4434aea/attachment.bin>

From p@trick@gir@udoux @ending from univ-fcomte@fr  Mon Nov  5 17:35:19 2018
From: p@trick@gir@udoux @ending from univ-fcomte@fr (Patrick Giraudoux)
Date: Mon, 5 Nov 2018 17:35:19 +0100
Subject: [R-sig-Geo] 
 Reordering geographical coordinates clockwise to make a polygon
In-Reply-To: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
References: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
Message-ID: <46cc9a24-2c92-1219-364b-f4588d0a813f@univ-fcomte.fr>


Apologize to answer to myself: the way described below would work only 
if there are no concave "peninsula" towards north or south inside the 
polygon. Even thinking about an alternate solution, e.g. the Traveling 
Salesman Problem (TSP), ie. the shortest route linking all points, one 
could get wrong since points of? a narrowpeninsula could have points 
closest to the opposite border than from the next point on the border...

Suppose we are stuck, and should redraw polygons by hand


Le 05/11/2018 ? 14:02, Patrick Giraudoux a ?crit?:
>
> Dear listers,
>
> There is an interesting post here: 
> https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order 
> dealing on the issue. However, I would like to know if a function has 
> been already developped in a R package.
>
> I am coping with a young colleague's shapefile where borders of 
> polygons have been drawn as lines quite inconsistently. To change this 
> SpatialLinesDataFrame into a SpatialPoints object is easy. The idea is 
> to? select the points? bordering each polygon (delete the others), 
> define the point set as a Polygon, then rebuild step by step a 
> SpatialPolygonsDataFrame with all its (~25) polygons. It would be much 
> quicker than to redraw one by one the 5160 data points (two times on 
> borders shared by two polygons).
>
> The problem is that the points must be reordered clockwise (the way 
> lines making the? borders is all except clockwise) before making them 
> a polygon.
>
> Any function already developped for that ?
>
> Cheers,
>
> Patrick
>
>
>


	[[alternative HTML version deleted]]


From edzer@pebe@m@ @ending from uni-muen@ter@de  Mon Nov  5 19:25:59 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Mon, 5 Nov 2018 19:25:59 +0100
Subject: [R-sig-Geo] 
 Reordering geographical coordinates clockwise to make a polygon
In-Reply-To: <46cc9a24-2c92-1219-364b-f4588d0a813f@univ-fcomte.fr>
References: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
 <46cc9a24-2c92-1219-364b-f4588d0a813f@univ-fcomte.fr>
Message-ID: <269f8afb-af35-1c72-de4d-9b2aa6082032@uni-muenster.de>

Sorry for my previous answer, I didn't get the question fully.

I'm afraid I still don't get the question fully, but functions that
might help are sf::st_line_merge (creates a LINESTRING from line pieces)
and sf::st_polygonize (creates a polygon from a LINESTRING that forms a
closed ring)

On 11/5/18 5:35 PM, Patrick Giraudoux wrote:
> 
> Apologize to answer to myself: the way described below would work only 
> if there are no concave "peninsula" towards north or south inside the 
> polygon. Even thinking about an alternate solution, e.g. the Traveling 
> Salesman Problem (TSP), ie. the shortest route linking all points, one 
> could get wrong since points of? a narrowpeninsula could have points 
> closest to the opposite border than from the next point on the border...
> 
> Suppose we are stuck, and should redraw polygons by hand
> 
> 
> Le 05/11/2018 ? 14:02, Patrick Giraudoux a ?crit?:
>>
>> Dear listers,
>>
>> There is an interesting post here: 
>> https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order 
>> dealing on the issue. However, I would like to know if a function has 
>> been already developped in a R package.
>>
>> I am coping with a young colleague's shapefile where borders of 
>> polygons have been drawn as lines quite inconsistently. To change this 
>> SpatialLinesDataFrame into a SpatialPoints object is easy. The idea is 
>> to? select the points? bordering each polygon (delete the others), 
>> define the point set as a Polygon, then rebuild step by step a 
>> SpatialPolygonsDataFrame with all its (~25) polygons. It would be much 
>> quicker than to redraw one by one the 5160 data points (two times on 
>> borders shared by two polygons).
>>
>> The problem is that the points must be reordered clockwise (the way 
>> lines making the? borders is all except clockwise) before making them 
>> a polygon.
>>
>> Any function already developped for that ?
>>
>> Cheers,
>>
>> Patrick
>>
>>
>>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181105/ad5df84e/attachment.bin>

From md@umner @ending from gm@il@com  Mon Nov  5 20:41:13 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Tue, 6 Nov 2018 06:41:13 +1100
Subject: [R-sig-Geo] 
 Reordering geographical coordinates clockwise to make a polygon
In-Reply-To: <269f8afb-af35-1c72-de4d-9b2aa6082032@uni-muenster.de>
References: <d4661cd5-5f6e-9f6b-db72-83016b4b1631@univ-fcomte.fr>
 <46cc9a24-2c92-1219-364b-f4588d0a813f@univ-fcomte.fr>
 <269f8afb-af35-1c72-de4d-9b2aa6082032@uni-muenster.de>
Message-ID: <CAAcGz9_MN=eC++YGjQu9fsJfC1HN5DZyWjCnEfoBOYeZEfwjWQ@mail.gmail.com>

alphahull or a hand-crafted "triangulate and cull long/large triangles"
might be workable options (geometry and RTriangle have the fastest and most
useful triangulation functions).

It's not generally a tractable problem afaics.  Some refs that came up in
recent discussions:

https://pdfs.semanticscholar.org/669b/1415cd64d39f1e44fd90c2b9d9453c42581b.pdf

http://erikdemaine.org/polygonization/

Cheers, Mike.

On Tue, 6 Nov 2018 at 05:26 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

> Sorry for my previous answer, I didn't get the question fully.
>
> I'm afraid I still don't get the question fully, but functions that
> might help are sf::st_line_merge (creates a LINESTRING from line pieces)
> and sf::st_polygonize (creates a polygon from a LINESTRING that forms a
> closed ring)
>
> On 11/5/18 5:35 PM, Patrick Giraudoux wrote:
> >
> > Apologize to answer to myself: the way described below would work only
> > if there are no concave "peninsula" towards north or south inside the
> > polygon. Even thinking about an alternate solution, e.g. the Traveling
> > Salesman Problem (TSP), ie. the shortest route linking all points, one
> > could get wrong since points of  a narrowpeninsula could have points
> > closest to the opposite border than from the next point on the border...
> >
> > Suppose we are stuck, and should redraw polygons by hand
> >
> >
> > Le 05/11/2018 ? 14:02, Patrick Giraudoux a ?crit :
> >>
> >> Dear listers,
> >>
> >> There is an interesting post here:
> >>
> https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order
> >> dealing on the issue. However, I would like to know if a function has
> >> been already developped in a R package.
> >>
> >> I am coping with a young colleague's shapefile where borders of
> >> polygons have been drawn as lines quite inconsistently. To change this
> >> SpatialLinesDataFrame into a SpatialPoints object is easy. The idea is
> >> to  select the points  bordering each polygon (delete the others),
> >> define the point set as a Polygon, then rebuild step by step a
> >> SpatialPolygonsDataFrame with all its (~25) polygons. It would be much
> >> quicker than to redraw one by one the 5160 data points (two times on
> >> borders shared by two polygons).
> >>
> >> The problem is that the points must be reordered clockwise (the way
> >> lines making the  borders is all except clockwise) before making them
> >> a polygon.
> >>
> >> Any function already developped for that ?
> >>
> >> Cheers,
> >>
> >> Patrick
> >>
> >>
> >>
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081 <+49%20251%208333081>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From miluji@b @ending from gm@il@com  Mon Nov  5 21:59:44 2018
From: miluji@b @ending from gm@il@com (Miluji Sb)
Date: Mon, 5 Nov 2018 21:59:44 +0100
Subject: [R-sig-Geo] Raster to rasterbrick does not preserve Date/Time
In-Reply-To: <13E271F3-6B86-402F-93B9-88E0348C561D@bigelow.org>
References: <CAMLwc7NXecPCWSz873-zNq7vxr7Mzhd=LsvsCbVZbYcrut4JFg@mail.gmail.com>
 <13E271F3-6B86-402F-93B9-88E0348C561D@bigelow.org>
Message-ID: <CAMLwc7P26BHVcDdGQ0psqHJn7Cmjcd-+KzuCAkNonv2Bu5m8ew@mail.gmail.com>

Thank you, Ben! This works well.

Sincerely,

Milu

On Sun, Nov 4, 2018 at 11:08 PM Ben Tupper <btupper at bigelow.org> wrote:

> Hi,
>
> I'm not sure about reading the datetime stamp directly form the file, but
> you have enough info to convert the z-value which is well described in your
> ncdf.  I'm not familiar with the '%.f' format specifier, but it looks like
> it is a fractional day.  Something like this perhaps will work?
>
> z      <- raster::getZ(rbick)
> z0     <- floor(z)
> zf     <- z - z0
> dt     <- as.POSIXct(as.character(z0), format = "%Y%m%d") + 24*60*60*zf
> rbrick <- raster::setZ(rbrick, z, name = 'datetime')
>
> You'll need to think through the timezone issues that might arise.
> as.POSIXct() has arguments that can help you with that.
>
> Cheers,
> Ben
>
>
> > On Nov 4, 2018, at 12:39 PM, Miluji Sb <milujisb at gmail.com> wrote:
> >
> > Dear all,
> >
> > I have a raster with multiple variables and date/time information;
> >
> >      time  Size:17164   *** is unlimited ***
> >            standard_name: time
> >            bounds: time_bnds
> >            units: day as %Y%m%d.%f
> >            calendar: proleptic_gregorian
> >        bnds  Size:2
> >
> > My goal is to convert the raster file to rasterbrick for extraction
> > purposes;
> >
> > rbrick <- brick(r,  values=TRUE, varname="var1")
> >
> > However, after conversion - the date/time information is not preserved.
> How
> > can I preserve this information?
> >
> > class       : RasterBrick
> > dimensions  : 600, 1440, 864000, 17164  (nrow, ncol, ncell, nlayers)
> > resolution  : 0.25, 0.25  (x, y)
> > extent      : -180, 180, -60, 90  (xmin, xmax, ymin, ymax)
> > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > data source : /work/ncfile.nc4
> > names       : X19700101.4375, X19700102.4375, X19700103.4375,
> > X19700104.4375, X19700105.4375, X19700106.4375, X19700107.4375,
> > X19700108.4375, X19700109.4375, X19700110.4375, X19700111.4375,
> > X19700112.4375, X19700113.4375, X19700114.4375, X19700115.4375, ...
> > z-value     : 19700101.4375, 20161231.4375 (min, max)
> > varname     : var1
> >
> > Any help will be greatly appreciated!
> >
> > Sincerely,
> >
> > Milu
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From miluji@b @ending from gm@il@com  Mon Nov  5 22:25:13 2018
From: miluji@b @ending from gm@il@com (Miluji Sb)
Date: Mon, 5 Nov 2018 22:25:13 +0100
Subject: [R-sig-Geo] Match European cities to Coordinates/NUTS 2
Message-ID: <CAMLwc7Oru8cjnn7oWLhPM_v2JzSUZ0yPtxcYHviUyh6roqg=Dg@mail.gmail.com>

I have a dataframe (more than 50,000 observations), where one of the
variables is the city that unit is location. The units are all in Europe.

My goal is to assign NUTS-2 code to each of these cities. However, I am not
aware of any direct way of achieving this, so I wanted to first assign
coordinates to the cities and then use the 'over' function to match with
NUTS regions from EU shapefile.

I have tried to use 'geocode' from the ggmap package but there is a 2,500
per day limit. Is there any other solution? Any help will be greatly
appreciated.

Sincerely,

Milu

	[[alternative HTML version deleted]]


From d@dim@t19 @ending from gm@il@com  Tue Nov  6 14:22:24 2018
From: d@dim@t19 @ending from gm@il@com (Dadirai Matarira)
Date: Tue, 6 Nov 2018 15:22:24 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 182, Issue 13
In-Reply-To: <mailman.26950.5.1540897201.22214.r-sig-geo@r-project.org>
References: <mailman.26950.5.1540897201.22214.r-sig-geo@r-project.org>
Message-ID: <CAAKodyF=ZS5Z7dRZcQ8zFTVtWO+Z+Jr9nfcubbOb6n_casG=UA@mail.gmail.com>

I am doing NDVI time series analysis using MODIS data.I have produced my
map for NDVI trends.I produced five classes of the trends.
1.How do I calculate percentage areas for each category and the areas
represented by each category?
2.How do I determine area represented by my study area?

On Tue, Oct 30, 2018 at 1:02 PM <r-sig-geo-request at r-project.org> wrote:

> Send R-sig-Geo mailing list submissions to
>         r-sig-geo at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
>         r-sig-geo-request at r-project.org
>
> You can reach the person managing the list at
>         r-sig-geo-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
>
>
> Today's Topics:
>
>    1. Cost distance in spatial weight matrix (Roozbeh Valavi)
>    2. Re: Cost distance in spatial weight matrix
>       (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 29 Oct 2018 23:42:06 +1100
> From: Roozbeh Valavi <rvalavi at student.unimelb.edu.au>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Cost distance in spatial weight matrix
> Message-ID:
>         <
> CAH-s5PM4GJ1Y92QMyYEUv4AS9gVS2SnL1zhNCTOpOTbsd2hQQw at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Dear list,
>
> I wonder if it is possible to add some kind of cost/weighting when creating
> a spatial weight matrix to be used in a spatial lag model? I want to
> consider the effect of elevation as a cost for calculating distance to the
> neighbours.
> I am using spdep for creating the W and splm for the model.
>
> Thank you in advance,
> Roozbeh
> --
> *Roozbeh Valavi*
> PhD Candidate
> The Quantitative & Applied Ecology Group <http://qaeco.com/>
> School of BioSciences | Faculty of Science
> The University of Melbourne, VIC 3010, Australia
> Mobile: +61 423 283 238
>
>         [[alternative HTML version deleted]]
>
>
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 29 Oct 2018 14:48:43 +0100
> From: =?UTF-8?Q?Facundo_Mu=c3=b1oz?= <facundo.munoz at cirad.fr>
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Cost distance in spatial weight matrix
> Message-ID: <692c3f9c-38e1-9428-8de7-8f573d10ee29 at cirad.fr>
> Content-Type: text/plain; charset="utf-8"
>
> Dear Roozbeh,
>
> package geoRcb [1]* provides function distmatGen() [2], which computes a
> cost-based distance matrix between any two sets of locations, given a
> raster cost surface (such as elevation). The function uses package
> gdistance to actually perform the computations, and it does not depend
> on anything else in the package, so you can simply copy it to your code
> base.
>
> Is that what you were looking for?
>
> ?acu.-
>
>
>
> [1] https://github.com/famuvie/geoRcb/
>
> [2] https://github.com/famuvie/geoRcb/blob/master/R/distmatGen.R
>
> * Disclaimer: I'm the author.
>
>
> On 10/29/18 1:42 PM, Roozbeh Valavi wrote:
> > Dear list,
> >
> > I wonder if it is possible to add some kind of cost/weighting when
> creating
> > a spatial weight matrix to be used in a spatial lag model? I want to
> > consider the effect of elevation as a cost for calculating distance to
> the
> > neighbours.
> > I am using spdep for creating the W and splm for the model.
> >
> > Thank you in advance,
> > Roozbeh
>
>         [[alternative HTML version deleted]]
>
>
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ------------------------------
>
> End of R-sig-Geo Digest, Vol 182, Issue 13
> ******************************************

	[[alternative HTML version deleted]]


From @lexi@di@@@nt @ending from gm@il@com  Tue Nov  6 15:55:49 2018
From: @lexi@di@@@nt @ending from gm@il@com (Antonis Alexiadis)
Date: Tue, 6 Nov 2018 14:55:49 +0000
Subject: [R-sig-Geo] Varying measurement error in Kriging predictions
Message-ID: <CAE=zgG7Vt157xAPgnc0cVrGF8xCJUx78g3p7r0HCE1Vioc7aQQ@mail.gmail.com>

Hello, my question is how can I implement known varying measurement error
in my
Kriging predictions?

I have two separate datasets: the first one is a 2-D dataset that includes
the observations and
the second is the a 2-D dataset that includes the measurement error in each
specific location.
The measurement error dataset follows a structure, it's not random (which
can be characterized via the use of the experimental variogram).

I have searched a lot online on how to incorporate the measurement
uncertainty in
Kriging predictions but it seems to still be an open question in the forums
(a paper solving this issue has been developed by William F. Christensen
titled as: Filtered Kriging for Spatial Data with Heterogeneous Measurement
Error Variances). I have tried to use gstat and incorporate the variances
using the weights functionality but after I do the kriging and visualize
the predicted variance field, even though it qualitatively resembles the
defined one, the values of the variances are magnitudes lower than the ones
proposed.

Does anyone have an idea on how to solve it, or aware of some
software-package that
has already implemented this functionality? (It's quite tough to understand
the stated paper already, rather having to program
its contents) .


Thank you.

Regards,
Antonios.

	[[alternative HTML version deleted]]


From jeremy@kr@ft @ending from p@rkbob@com  Tue Nov  6 18:31:22 2018
From: jeremy@kr@ft @ending from p@rkbob@com (Jeremy Kraft)
Date: Tue, 6 Nov 2018 18:31:22 +0100
Subject: [R-sig-Geo] Problem installing rgdal
Message-ID: <CAJmmtc-W8BJy+8fu8iho72e4QYfj4076bAkmWqR2n9tQwq2WZw@mail.gmail.com>

Hello,

I'm trying to reinstall rgdal, but I have a problem with the sqlite
dependency.
Below is the R output.

Does someone knows how to solve the problem?

Thanks,

Jeremy

-------------------------------------------------------------------------------------------------------------------------------
jeremy at yuri-HP-ProBook-640-G1:/$ R

R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> install.packages('rgdal')
Installing package into ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4?
(as ?lib? is unspecified)
trying URL 'https://cloud.r-project.org/src/contrib/rgdal_1.3-6.tar.gz'
Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/lib/R
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: C++11 support available
configure: rgdal: 1.3-6
checking for /usr/bin/svnversion... no
configure: svn revision: 773
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.2.3
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... no
checking gdal: linking with --libs and --dep-libs... no
/usr/bin/ld: /usr/lib/libgdal.a(genbindataset.o): relocation R_X86_64_32
against `.rodata.str1.8' can not be used when making a PIE object;
recompile with -fPIC
/usr/bin/ld: /usr/lib/libgdal.a(geotiff.o): relocation R_X86_64_32 against
`.rodata.str1.1' can not be used when making a PIE object; recompile with
-fPIC
/usr/bin/ld: /usr/lib/libgdal.a(gff_dataset.o): relocation R_X86_64_32S
against hidden symbol `_ZTV10GFFDataset' can not be used when making a PIE
object

*
* Long list
*
/usr/bin/ld: /usr/lib/libgdal.a(gmlhandler.o): relocation R_X86_64_32
against `.rodata.str1.1' can not be used when making a PIE object;
recompile with -fPIC
/usr/bin/ld: /usr/lib/libgdal.a(ili2handler.o): relocation R_X86_64_32S
against hidden symbol `_ZTV11ILI2Handler' can not be used when making a PIE
object
/usr/bin/ld: /usr/lib/libgdal.a(nashandler.o): relocation R_X86_64_32
against `.rodata.str1.8' can not be used when making a PIE object;
recompile with -fPIC
/usr/bin/ld: /usr/lib/libgdal.a(ntf_codelist.o): relocation R_X86_64_32
against `.rodata.str1.1' can not be used when making a PIE object;
recompile with -fPIC
/usr/bin/ld: /usr/lib/libgdal.a(ntf_estlayers.o): relocation R_X86_64_32S
against hidden symbol `_ZN11OGRNTFLayer12GetLayerDefnEv' can not be used
when making a PIE object
/usr/bin/ld: /usr/lib/libgdal.a(ntf_raster.o): relocation R_X86_64_32S
against hidden symbol `_ZTV17OGRNTFRasterLayer' can not be used when making
a PIE object
/usr/bin/ld: /usr/lib/libgdal.a(ogrmssqlgeometryparser.o): relocation
R_X86_64_32S against `.rodata' can not be used when making a PIE object;
recompile with -fPIC
/usr/bin/ld: final link failed: Nonrepresentable section on output
collect2: error: ld returned 1 exit status
/usr/bin/ld: /usr/lib/libgdal.a(ogrsqliteapiroutines.o): undefined
reference to symbol 'sqlite3_prepare'
/usr/lib/x86_64-linux-gnu/libsqlite3.so.0: error adding symbols: DSO
missing from command line
collect2: error: ld returned 1 exit status
configure: Install failure: compilation and/or linkage problems.
configure: error: GDALAllRegister not found in libgdal.
ERROR: configuration failed for package ?rgdal?
* removing ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4/rgdal?

The downloaded source packages are in
    ?/tmp/RtmpKSJ85K/downloaded_packages?
Warning message:
In install.packages("rgdal") :
  installation of package ?rgdal? had non-zero exit status

	[[alternative HTML version deleted]]


From tech_dev @ending from wildintellect@com  Tue Nov  6 19:12:19 2018
From: tech_dev @ending from wildintellect@com (Alex M)
Date: Tue, 6 Nov 2018 10:12:19 -0800
Subject: [R-sig-Geo] Problem installing rgdal
In-Reply-To: <CAJmmtc-W8BJy+8fu8iho72e4QYfj4076bAkmWqR2n9tQwq2WZw@mail.gmail.com>
References: <CAJmmtc-W8BJy+8fu8iho72e4QYfj4076bAkmWqR2n9tQwq2WZw@mail.gmail.com>
Message-ID: <50a65e29-c037-d359-59dc-b3e666348858@wildintellect.com>

On 11/6/18 09:31, Jeremy Kraft wrote:
> Hello,
> 
> I'm trying to reinstall rgdal, but I have a problem with the sqlite
> dependency.
> Below is the R output.
> 
> Does someone knows how to solve the problem?
> 
> Thanks,
> 
> Jeremy
> 
> -------------------------------------------------------------------------------------------------------------------------------
> jeremy at yuri-HP-ProBook-640-G1:/$ R
> 
> R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
> Copyright (C) 2018 The R Foundation for Statistical Computing
> Platform: x86_64-pc-linux-gnu (64-bit)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
>> install.packages('rgdal')
> Installing package into ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4?
> (as ?lib? is unspecified)
> trying URL 'https://cloud.r-project.org/src/contrib/rgdal_1.3-6.tar.gz'
> Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
> 
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: R_HOME: /usr/lib/R
> configure: CC: gcc -std=gnu99
> configure: CXX: g++
> configure: C++11 support available
> configure: rgdal: 1.3-6
> checking for /usr/bin/svnversion... no
> configure: svn revision: 773
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.2.3
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... no
> checking gdal: linking with --libs and --dep-libs... no
> /usr/bin/ld: /usr/lib/libgdal.a(genbindataset.o): relocation R_X86_64_32
> against `.rodata.str1.8' can not be used when making a PIE object;
> recompile with -fPIC
> /usr/bin/ld: /usr/lib/libgdal.a(geotiff.o): relocation R_X86_64_32 against
> `.rodata.str1.1' can not be used when making a PIE object; recompile with
> -fPIC
> /usr/bin/ld: /usr/lib/libgdal.a(gff_dataset.o): relocation R_X86_64_32S
> against hidden symbol `_ZTV10GFFDataset' can not be used when making a PIE
> object
> 
> *
> * Long list
> *
> /usr/bin/ld: /usr/lib/libgdal.a(gmlhandler.o): relocation R_X86_64_32
> against `.rodata.str1.1' can not be used when making a PIE object;
> recompile with -fPIC
> /usr/bin/ld: /usr/lib/libgdal.a(ili2handler.o): relocation R_X86_64_32S
> against hidden symbol `_ZTV11ILI2Handler' can not be used when making a PIE
> object
> /usr/bin/ld: /usr/lib/libgdal.a(nashandler.o): relocation R_X86_64_32
> against `.rodata.str1.8' can not be used when making a PIE object;
> recompile with -fPIC
> /usr/bin/ld: /usr/lib/libgdal.a(ntf_codelist.o): relocation R_X86_64_32
> against `.rodata.str1.1' can not be used when making a PIE object;
> recompile with -fPIC
> /usr/bin/ld: /usr/lib/libgdal.a(ntf_estlayers.o): relocation R_X86_64_32S
> against hidden symbol `_ZN11OGRNTFLayer12GetLayerDefnEv' can not be used
> when making a PIE object
> /usr/bin/ld: /usr/lib/libgdal.a(ntf_raster.o): relocation R_X86_64_32S
> against hidden symbol `_ZTV17OGRNTFRasterLayer' can not be used when making
> a PIE object
> /usr/bin/ld: /usr/lib/libgdal.a(ogrmssqlgeometryparser.o): relocation
> R_X86_64_32S against `.rodata' can not be used when making a PIE object;
> recompile with -fPIC
> /usr/bin/ld: final link failed: Nonrepresentable section on output
> collect2: error: ld returned 1 exit status
> /usr/bin/ld: /usr/lib/libgdal.a(ogrsqliteapiroutines.o): undefined
> reference to symbol 'sqlite3_prepare'
> /usr/lib/x86_64-linux-gnu/libsqlite3.so.0: error adding symbols: DSO
> missing from command line
> collect2: error: ld returned 1 exit status
> configure: Install failure: compilation and/or linkage problems.
> configure: error: GDALAllRegister not found in libgdal.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4/rgdal?
> 
> The downloaded source packages are in
>     ?/tmp/RtmpKSJ85K/downloaded_packages?
> Warning message:
> In install.packages("rgdal") :
>   installation of package ?rgdal? had non-zero exit status
> 
>

Looks like an issue with your system libgdal-dev package, perhaps
reinstall the system dependencies. Which OS are you installing on?

Thanks,
Alex


From @loboli@t@@ @ending from gm@il@com  Wed Nov  7 10:02:24 2018
From: @loboli@t@@ @ending from gm@il@com (Agustin Lobo)
Date: Wed, 7 Nov 2018 10:02:24 +0100
Subject: [R-sig-Geo] gdalUtils::gdal_translate()
Message-ID: <CAG4NReKsRSCyiPjKEjvNMe_AcVhkceOn5-cBVVaS=1kpCP8-8g@mail.gmail.com>

I find the following problem when trying gdal_translate():
>  gdal_translate(src_dataset=file.path(dirMAJAIma,"imain20.vrt"),
+             dst_dataset="test.tif",
+             ot="Int16",projwin=ext at xmin,ext at ymax,ext at xmax,ext at ymin)
Error in gdal_chooseInstallation(hasDrivers = of) :
  No installations match.

Other functions in gdalUtils do work and gdal_translate works on the
Debian terminal.
Does igdal_translate() work for other people?
Thanks
Agus

sessionInfo()
R version 3.5.0 (2018-04-23)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux buster/sid

Matrix products: default
BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
LC_TIME=en_GB.UTF-8
 [4] LC_COLLATE=en_GB.UTF-8     LC_MONETARY=en_GB.UTF-8
LC_MESSAGES=en_GB.UTF-8
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_GB.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] gdalUtils_2.0.1.14 rgdal_1.3-6        R.utils_2.7.0
R.oo_1.22.0        R.methodsS3_1.7.1
[6] raster_2.7-15      sp_1.3-1

loaded via a namespace (and not attached):
 [1] compiler_3.5.0   tools_3.5.0      yaml_2.2.0       Rcpp_0.12.19
  codetools_0.2-15 grid_3.5.0
 [7] iterators_1.0.10 foreach_1.4.4    knitr_1.20       lattice_0.20-35


From @ilvi@@fl@herty @ending from gm@il@com  Wed Nov  7 14:35:35 2018
From: @ilvi@@fl@herty @ending from gm@il@com (Silvia Flaherty)
Date: Wed, 7 Nov 2018 10:35:35 -0300
Subject: [R-sig-Geo] Random forest script - problems with training areas
 polygon?
Message-ID: <CALT2rd9x7vXTp7CMtQpKqYS+29=j62HJvpQ3GYYO5nMozK4K=w@mail.gmail.com>

Hi all,



I have been working with the random forest R script and have had no
problems at all up to now.

I recently modified the training areas shapefile. It?s actually an edited
version of the original shapefile (which worked just fine). Same
projection, etc, only the areas are smaller and more specific. That's the
only input I changes. The script reads the shapefile but it doesn't do the
classification.



The error  I get is:

 Error in `[.data.frame`(satValues, , 2) : undefined columns selected



Checking line by line, he problem seems to be (line 139 of the loop):

satValues <- extract(satImage, class_data[i,], cellnumbers=TRUE, df=TRUE)





I?m not very skilled at using R but I?m quite OK with GIS. I have tried
editing the shapefile again, saving it as another file, etc. Same result.



Any ideas what could be going wrong?

Thanks!



Silvia


<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
Libre
de virus. www.avast.com
<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
<#m_542342069031620777_DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>

	[[alternative HTML version deleted]]


From rom@n@lu@trik @ending from gm@il@com  Wed Nov  7 15:03:02 2018
From: rom@n@lu@trik @ending from gm@il@com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 7 Nov 2018 15:03:02 +0100
Subject: [R-sig-Geo] Random forest script - problems with training areas
 polygon?
In-Reply-To: <CALT2rd9x7vXTp7CMtQpKqYS+29=j62HJvpQ3GYYO5nMozK4K=w@mail.gmail.com>
References: <CALT2rd9x7vXTp7CMtQpKqYS+29=j62HJvpQ3GYYO5nMozK4K=w@mail.gmail.com>
Message-ID: <CAHT1vphgF7te2+hPmW63rNM=XB6+OD+360JeZAwec9-_xC_ofg@mail.gmail.com>

Can you make a reproducible example (data, scripts)? Have you tried
debugging your code?

Cheers,
Roman

On Wed, Nov 7, 2018 at 2:36 PM Silvia Flaherty <silvia.flaherty at gmail.com>
wrote:

> Hi all,
>
>
>
> I have been working with the random forest R script and have had no
> problems at all up to now.
>
> I recently modified the training areas shapefile. It?s actually an edited
> version of the original shapefile (which worked just fine). Same
> projection, etc, only the areas are smaller and more specific. That's the
> only input I changes. The script reads the shapefile but it doesn't do the
> classification.
>
>
>
> The error  I get is:
>
>  Error in `[.data.frame`(satValues, , 2) : undefined columns selected
>
>
>
> Checking line by line, he problem seems to be (line 139 of the loop):
>
> satValues <- extract(satImage, class_data[i,], cellnumbers=TRUE, df=TRUE)
>
>
>
>
>
> I?m not very skilled at using R but I?m quite OK with GIS. I have tried
> editing the shapefile again, saving it as another file, etc. Same result.
>
>
>
> Any ideas what could be going wrong?
>
> Thanks!
>
>
>
> Silvia
>
>
> <
> https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail
> >
> Libre
> de virus. www.avast.com
> <
> https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail
> >
> <#m_542342069031620777_DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Wed Nov  7 15:07:41 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Wed, 7 Nov 2018 15:07:41 +0100
Subject: [R-sig-Geo] Random forest script - problems with training areas
 polygon?
In-Reply-To: <CAHT1vphgF7te2+hPmW63rNM=XB6+OD+360JeZAwec9-_xC_ofg@mail.gmail.com>
References: <CALT2rd9x7vXTp7CMtQpKqYS+29=j62HJvpQ3GYYO5nMozK4K=w@mail.gmail.com>
 <CAHT1vphgF7te2+hPmW63rNM=XB6+OD+360JeZAwec9-_xC_ofg@mail.gmail.com>
Message-ID: <CADvFi5q=axkWbzPqrY3Q5Rx3wUDxPyzo-9YVahjOEjpQLwqbxA@mail.gmail.com>

Silvia,
you say that the areas of the shapefile are smaller. Do they intersect
pixels centroids? The help of function 'extract' says the following (which
might be relevant for your case?):

If y represents polygons, the extract method returns the values of the
cells of a Raster* object that are covered by a polygon. A cell is covered
if its center is inside the polygon (but see the weights  option for
considering partly covered cells; and argument small for getting values for
small polygons anyway).

Cheers
Hugo

Roman Lu?trik <roman.lustrik at gmail.com> escreveu no dia quarta, 7/11/2018
?(s) 15:03:

> Can you make a reproducible example (data, scripts)? Have you tried
> debugging your code?
>
> Cheers,
> Roman
>
> On Wed, Nov 7, 2018 at 2:36 PM Silvia Flaherty <silvia.flaherty at gmail.com>
> wrote:
>
> > Hi all,
> >
> >
> >
> > I have been working with the random forest R script and have had no
> > problems at all up to now.
> >
> > I recently modified the training areas shapefile. It?s actually an edited
> > version of the original shapefile (which worked just fine). Same
> > projection, etc, only the areas are smaller and more specific. That's the
> > only input I changes. The script reads the shapefile but it doesn't do
> the
> > classification.
> >
> >
> >
> > The error  I get is:
> >
> >  Error in `[.data.frame`(satValues, , 2) : undefined columns selected
> >
> >
> >
> > Checking line by line, he problem seems to be (line 139 of the loop):
> >
> > satValues <- extract(satImage, class_data[i,], cellnumbers=TRUE, df=TRUE)
> >
> >
> >
> >
> >
> > I?m not very skilled at using R but I?m quite OK with GIS. I have tried
> > editing the shapefile again, saving it as another file, etc. Same result.
> >
> >
> >
> > Any ideas what could be going wrong?
> >
> > Thanks!
> >
> >
> >
> > Silvia
> >
> >
> > <
> >
> https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail
> > >
> > Libre
> > de virus. www.avast.com
> > <
> >
> https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail
> > >
> > <#m_542342069031620777_DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> In God we trust, all others bring data.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tech_dev @ending from wildintellect@com  Wed Nov  7 18:33:02 2018
From: tech_dev @ending from wildintellect@com (Alex M)
Date: Wed, 7 Nov 2018 09:33:02 -0800
Subject: [R-sig-Geo] Problem installing rgdal
In-Reply-To: <CAJmmtc8LWoMpROqitP66oM8v1sSkn7JmsYBG43JH4T8j4QKqgw@mail.gmail.com>
References: <CAJmmtc-W8BJy+8fu8iho72e4QYfj4076bAkmWqR2n9tQwq2WZw@mail.gmail.com>
 <50a65e29-c037-d359-59dc-b3e666348858@wildintellect.com>
 <CAJmmtc8LWoMpROqitP66oM8v1sSkn7JmsYBG43JH4T8j4QKqgw@mail.gmail.com>
Message-ID: <314c6937-96b0-a30f-e7ed-f3cea4c6b878@wildintellect.com>

Jeremy,

Please keep the thread on list so every-one can see the
discussion/solution (reply-all).

I don't have a 18.10 box to test on quickly. But can you review what
steps you did, ie: what system packages did you install before
attempting to install rgdal? Usually you need libgdal-dev libproj-dev
and perhaps libsqlite3-dev libgeos-dev (all of these are supposed to be
dependencies of libgdal-dev).

Also it might be good to jump this over to the R-sig-debian list where
many people are familiar with the OS
https://stat.ethz.ch/mailman/listinfo/r-sig-debian (also covers ubuntu &
mint, all debian derivatives). One option is usually the marutter ppa
which has system packages for cran libraries, however it doesn't appear
to support 18.10 yet
http://sites.psu.edu/theubunturblog/installing-r-in-ubuntu/

Thanks,
Alex


On 11/7/18 01:51, Jeremy Kraft wrote:
> I'm on linux, ubuntu 18.10. I've been trying to reinstall  libgdal-dev but
> that did not solve the problem.
> 
> Thanks,
> 
> On Tue, Nov 6, 2018 at 7:12 PM Alex M <tech_dev at wildintellect.com> wrote:
> 
>> On 11/6/18 09:31, Jeremy Kraft wrote:
>>> Hello,
>>>
>>> I'm trying to reinstall rgdal, but I have a problem with the sqlite
>>> dependency.
>>> Below is the R output.
>>>
>>> Does someone knows how to solve the problem?
>>>
>>> Thanks,
>>>
>>> Jeremy
>>>
>>>
>> -------------------------------------------------------------------------------------------------------------------------------
>>> jeremy at yuri-HP-ProBook-640-G1:/$ R
>>>
>>> R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
>>> Copyright (C) 2018 The R Foundation for Statistical Computing
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>>   Natural language support but running in an English locale
>>>
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>>
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>>
>>>> install.packages('rgdal')
>>> Installing package into ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4?
>>> (as ?lib? is unspecified)
>>> trying URL 'https://cloud.r-project.org/src/contrib/rgdal_1.3-6.tar.gz'
>>> Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
>>> ==================================================
>>> downloaded 1.6 MB
>>>
>>> * installing *source* package ?rgdal? ...
>>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>>> configure: R_HOME: /usr/lib/R
>>> configure: CC: gcc -std=gnu99
>>> configure: CXX: g++
>>> configure: C++11 support available
>>> configure: rgdal: 1.3-6
>>> checking for /usr/bin/svnversion... no
>>> configure: svn revision: 773
>>> checking for gdal-config... /usr/bin/gdal-config
>>> checking gdal-config usability... yes
>>> configure: GDAL: 2.2.3
>>> checking GDAL version >= 1.11.4... yes
>>> checking gdal: linking with --libs only... no
>>> checking gdal: linking with --libs and --dep-libs... no
>>> /usr/bin/ld: /usr/lib/libgdal.a(genbindataset.o): relocation R_X86_64_32
>>> against `.rodata.str1.8' can not be used when making a PIE object;
>>> recompile with -fPIC
>>> /usr/bin/ld: /usr/lib/libgdal.a(geotiff.o): relocation R_X86_64_32
>> against
>>> `.rodata.str1.1' can not be used when making a PIE object; recompile with
>>> -fPIC
>>> /usr/bin/ld: /usr/lib/libgdal.a(gff_dataset.o): relocation R_X86_64_32S
>>> against hidden symbol `_ZTV10GFFDataset' can not be used when making a
>> PIE
>>> object
>>>
>>> *
>>> * Long list
>>> *
>>> /usr/bin/ld: /usr/lib/libgdal.a(gmlhandler.o): relocation R_X86_64_32
>>> against `.rodata.str1.1' can not be used when making a PIE object;
>>> recompile with -fPIC
>>> /usr/bin/ld: /usr/lib/libgdal.a(ili2handler.o): relocation R_X86_64_32S
>>> against hidden symbol `_ZTV11ILI2Handler' can not be used when making a
>> PIE
>>> object
>>> /usr/bin/ld: /usr/lib/libgdal.a(nashandler.o): relocation R_X86_64_32
>>> against `.rodata.str1.8' can not be used when making a PIE object;
>>> recompile with -fPIC
>>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_codelist.o): relocation R_X86_64_32
>>> against `.rodata.str1.1' can not be used when making a PIE object;
>>> recompile with -fPIC
>>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_estlayers.o): relocation R_X86_64_32S
>>> against hidden symbol `_ZN11OGRNTFLayer12GetLayerDefnEv' can not be used
>>> when making a PIE object
>>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_raster.o): relocation R_X86_64_32S
>>> against hidden symbol `_ZTV17OGRNTFRasterLayer' can not be used when
>> making
>>> a PIE object
>>> /usr/bin/ld: /usr/lib/libgdal.a(ogrmssqlgeometryparser.o): relocation
>>> R_X86_64_32S against `.rodata' can not be used when making a PIE object;
>>> recompile with -fPIC
>>> /usr/bin/ld: final link failed: Nonrepresentable section on output
>>> collect2: error: ld returned 1 exit status
>>> /usr/bin/ld: /usr/lib/libgdal.a(ogrsqliteapiroutines.o): undefined
>>> reference to symbol 'sqlite3_prepare'
>>> /usr/lib/x86_64-linux-gnu/libsqlite3.so.0: error adding symbols: DSO
>>> missing from command line
>>> collect2: error: ld returned 1 exit status
>>> configure: Install failure: compilation and/or linkage problems.
>>> configure: error: GDALAllRegister not found in libgdal.
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4/rgdal?
>>>
>>> The downloaded source packages are in
>>>     ?/tmp/RtmpKSJ85K/downloaded_packages?
>>> Warning message:
>>> In install.packages("rgdal") :
>>>   installation of package ?rgdal? had non-zero exit status
>>>
>>>
>>
>> Looks like an issue with your system libgdal-dev package, perhaps
>> reinstall the system dependencies. Which OS are you installing on?
>>
>> Thanks,
>> Alex
>>
>>
>


From tech_dev @ending from wildintellect@com  Wed Nov  7 19:17:43 2018
From: tech_dev @ending from wildintellect@com (Alex M)
Date: Wed, 7 Nov 2018 10:17:43 -0800
Subject: [R-sig-Geo] gdalUtils::gdal_translate()
In-Reply-To: <CAG4NReKsRSCyiPjKEjvNMe_AcVhkceOn5-cBVVaS=1kpCP8-8g@mail.gmail.com>
References: <CAG4NReKsRSCyiPjKEjvNMe_AcVhkceOn5-cBVVaS=1kpCP8-8g@mail.gmail.com>
Message-ID: <c773d1ba-1035-4afb-bb7d-058df5f7b4b0@wildintellect.com>

gdal_translate does work fine for me on R 3.4

That error sounds like your install is having issues picking what gdal
installation to use.
?gdal_chooseInstallation

perhaps your install was not found correctly amd you need to run
gdal_setInstallation?

But I also see something in your call that looks off to me.

Based on the docs projwin takes a numeric vector. Which to me should
look like projwin=c(ext at xmin,ext at ymax,ext at xmax,ext at ymin)

Thanks,
Alex

On 11/7/18 01:02, Agustin Lobo wrote:
> I find the following problem when trying gdal_translate():
>>  gdal_translate(src_dataset=file.path(dirMAJAIma,"imain20.vrt"),
> +             dst_dataset="test.tif",
> +             ot="Int16",projwin=ext at xmin,ext at ymax,ext at xmax,ext at ymin)
> Error in gdal_chooseInstallation(hasDrivers = of) :
>   No installations match.
> 
> Other functions in gdalUtils do work and gdal_translate works on the
> Debian terminal.
> Does igdal_translate() work for other people?
> Thanks
> Agus
> 
> sessionInfo()
> R version 3.5.0 (2018-04-23)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Debian GNU/Linux buster/sid
> 
> Matrix products: default
> BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
> 
> locale:
>  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> LC_TIME=en_GB.UTF-8
>  [4] LC_COLLATE=en_GB.UTF-8     LC_MONETARY=en_GB.UTF-8
> LC_MESSAGES=en_GB.UTF-8
>  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_GB.UTF-8
> LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] gdalUtils_2.0.1.14 rgdal_1.3-6        R.utils_2.7.0
> R.oo_1.22.0        R.methodsS3_1.7.1
> [6] raster_2.7-15      sp_1.3-1
> 
> loaded via a namespace (and not attached):
>  [1] compiler_3.5.0   tools_3.5.0      yaml_2.2.0       Rcpp_0.12.19
>   codetools_0.2-15 grid_3.5.0
>  [7] iterators_1.0.10 foreach_1.4.4    knitr_1.20       lattice_0.20-35
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer@pebe@m@ @ending from uni-muen@ter@de  Thu Nov  8 08:47:57 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Thu, 8 Nov 2018 08:47:57 +0100
Subject: [R-sig-Geo] Varying measurement error in Kriging predictions
In-Reply-To: <CAE=zgG7Vt157xAPgnc0cVrGF8xCJUx78g3p7r0HCE1Vioc7aQQ@mail.gmail.com>
References: <CAE=zgG7Vt157xAPgnc0cVrGF8xCJUx78g3p7r0HCE1Vioc7aQQ@mail.gmail.com>
Message-ID: <1eb6bc6a-38aa-648c-9517-181f9e795c64@uni-muenster.de>

Please read p 74, "Kriging data with known measurement errors", of
http://gstat.org/gstat.pdf . It refers to a method published by Delhomme
(1978). The software was written long before the Christensen paper you
mention, to which I don't have access.


On 11/6/18 3:55 PM, Antonis Alexiadis wrote:
> Hello, my question is how can I implement known varying measurement error
> in my
> Kriging predictions?
> 
> I have two separate datasets: the first one is a 2-D dataset that includes
> the observations and
> the second is the a 2-D dataset that includes the measurement error in each
> specific location.
> The measurement error dataset follows a structure, it's not random (which
> can be characterized via the use of the experimental variogram).
> 
> I have searched a lot online on how to incorporate the measurement
> uncertainty in
> Kriging predictions but it seems to still be an open question in the forums
> (a paper solving this issue has been developed by William F. Christensen
> titled as: Filtered Kriging for Spatial Data with Heterogeneous Measurement
> Error Variances). I have tried to use gstat and incorporate the variances
> using the weights functionality but after I do the kriging and visualize
> the predicted variance field, even though it qualitatively resembles the
> defined one, the values of the variances are magnitudes lower than the ones
> proposed.
> 
> Does anyone have an idea on how to solve it, or aware of some
> software-package that
> has already implemented this functionality? (It's quite tough to understand
> the stated paper already, rather having to program
> its contents) .
> 
> 
> Thank you.
> 
> Regards,
> Antonios.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181108/625c4b84/attachment.bin>

From @loboli@t@@ @ending from gm@il@com  Thu Nov  8 10:04:17 2018
From: @loboli@t@@ @ending from gm@il@com (Agustin Lobo)
Date: Thu, 8 Nov 2018 10:04:17 +0100
Subject: [R-sig-Geo] gdalUtils::gdal_translate()
In-Reply-To: <c773d1ba-1035-4afb-bb7d-058df5f7b4b0@wildintellect.com>
References: <CAG4NReKsRSCyiPjKEjvNMe_AcVhkceOn5-cBVVaS=1kpCP8-8g@mail.gmail.com>
 <c773d1ba-1035-4afb-bb7d-058df5f7b4b0@wildintellect.com>
Message-ID: <CAG4NReJxDc4TXgBdDVnb1J2p01fnGkM_Ecg63Ad1YELWSq+geQ@mail.gmail.com>

Alex,
It was not a problem with the gdal installation, I had already checked:
> gdal_setInstallation()
> getOption("gdalUtils_gdalPath")[[1]]$path
[1] "/usr/bin/"
> getOption("gdalUtils_gdalPath")[[1]]$version
version
"2.3.2"
> getOption("gdalUtils_gdalPath")[[1]]$date
        date
"2018-09-21"

Also note that the rest of gdalUtilities do work.

But thanks to your spotting of the missing c(), the error message
vanishes out. So it was a problem of my mistake with the missing c()
+ a wrong error message that was totally misleading me.

Many thanks!

Agus

On Wed, Nov 7, 2018 at 7:18 PM Alex M <tech_dev at wildintellect.com> wrote:
>
> gdal_translate does work fine for me on R 3.4
>
> That error sounds like your install is having issues picking what gdal
> installation to use.
> ?gdal_chooseInstallation
>
> perhaps your install was not found correctly amd you need to run
> gdal_setInstallation?
>
> But I also see something in your call that looks off to me.
>
> Based on the docs projwin takes a numeric vector. Which to me should
> look like projwin=c(ext at xmin,ext at ymax,ext at xmax,ext at ymin)
>
> Thanks,
> Alex
>
> On 11/7/18 01:02, Agustin Lobo wrote:
> > I find the following problem when trying gdal_translate():
> >>  gdal_translate(src_dataset=file.path(dirMAJAIma,"imain20.vrt"),
> > +             dst_dataset="test.tif",
> > +             ot="Int16",projwin=ext at xmin,ext at ymax,ext at xmax,ext at ymin)
> > Error in gdal_chooseInstallation(hasDrivers = of) :
> >   No installations match.
> >
> > Other functions in gdalUtils do work and gdal_translate works on the
> > Debian terminal.
> > Does igdal_translate() work for other people?
> > Thanks
> > Agus
> >
> > sessionInfo()
> > R version 3.5.0 (2018-04-23)
> > Platform: x86_64-pc-linux-gnu (64-bit)
> > Running under: Debian GNU/Linux buster/sid
> >
> > Matrix products: default
> > BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
> > LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
> >
> > locale:
> >  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> > LC_TIME=en_GB.UTF-8
> >  [4] LC_COLLATE=en_GB.UTF-8     LC_MONETARY=en_GB.UTF-8
> > LC_MESSAGES=en_GB.UTF-8
> >  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> > LC_ADDRESS=C
> > [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_GB.UTF-8
> > LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] gdalUtils_2.0.1.14 rgdal_1.3-6        R.utils_2.7.0
> > R.oo_1.22.0        R.methodsS3_1.7.1
> > [6] raster_2.7-15      sp_1.3-1
> >
> > loaded via a namespace (and not attached):
> >  [1] compiler_3.5.0   tools_3.5.0      yaml_2.2.0       Rcpp_0.12.19
> >   codetools_0.2-15 grid_3.5.0
> >  [7] iterators_1.0.10 foreach_1.4.4    knitr_1.20       lattice_0.20-35
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jeremy@kr@ft @ending from p@rkbob@com  Thu Nov  8 10:11:45 2018
From: jeremy@kr@ft @ending from p@rkbob@com (Jeremy Kraft)
Date: Thu, 8 Nov 2018 10:11:45 +0100
Subject: [R-sig-Geo] Problem installing rgdal
In-Reply-To: <314c6937-96b0-a30f-e7ed-f3cea4c6b878@wildintellect.com>
References: <CAJmmtc-W8BJy+8fu8iho72e4QYfj4076bAkmWqR2n9tQwq2WZw@mail.gmail.com>
 <50a65e29-c037-d359-59dc-b3e666348858@wildintellect.com>
 <CAJmmtc8LWoMpROqitP66oM8v1sSkn7JmsYBG43JH4T8j4QKqgw@mail.gmail.com>
 <314c6937-96b0-a30f-e7ed-f3cea4c6b878@wildintellect.com>
Message-ID: <CAJmmtc9oN3kQZEHXR32hQNJ0H6Av1Yap8RXOLAsOPfFEdn=iPQ@mail.gmail.com>

Thanks Alex for the help!

I managed to solve the problem:

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
I did:
? ubuntu-gis repository wasn't added correctly, but was added 5 times. I
removed everything ubuntu-gis related from `sources.list.d`
? I removed and purged `r-base`, `r-core`, `gdal-bin`, `libgdal-dev`, and
did autoremove aufterwards.
? rebooted
? added ubuntu-gis correctly (the way their webpage suggested), installed
`gdal-bin`, `libgdal-dev`, `R` + packages. No errors whatsoever.


On Wed, Nov 7, 2018 at 6:33 PM Alex M <tech_dev at wildintellect.com> wrote:

> Jeremy,
>
> Please keep the thread on list so every-one can see the
> discussion/solution (reply-all).
>
> I don't have a 18.10 box to test on quickly. But can you review what
> steps you did, ie: what system packages did you install before
> attempting to install rgdal? Usually you need libgdal-dev libproj-dev
> and perhaps libsqlite3-dev libgeos-dev (all of these are supposed to be
> dependencies of libgdal-dev).
>
> Also it might be good to jump this over to the R-sig-debian list where
> many people are familiar with the OS
> https://stat.ethz.ch/mailman/listinfo/r-sig-debian (also covers ubuntu &
> mint, all debian derivatives). One option is usually the marutter ppa
> which has system packages for cran libraries, however it doesn't appear
> to support 18.10 yet
> http://sites.psu.edu/theubunturblog/installing-r-in-ubuntu/
>
> Thanks,
> Alex
>
>
> On 11/7/18 01:51, Jeremy Kraft wrote:
> > I'm on linux, ubuntu 18.10. I've been trying to reinstall  libgdal-dev
> but
> > that did not solve the problem.
> >
> > Thanks,
> >
> > On Tue, Nov 6, 2018 at 7:12 PM Alex M <tech_dev at wildintellect.com>
> wrote:
> >
> >> On 11/6/18 09:31, Jeremy Kraft wrote:
> >>> Hello,
> >>>
> >>> I'm trying to reinstall rgdal, but I have a problem with the sqlite
> >>> dependency.
> >>> Below is the R output.
> >>>
> >>> Does someone knows how to solve the problem?
> >>>
> >>> Thanks,
> >>>
> >>> Jeremy
> >>>
> >>>
> >>
> -------------------------------------------------------------------------------------------------------------------------------
> >>> jeremy at yuri-HP-ProBook-640-G1:/$ R
> >>>
> >>> R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
> >>> Copyright (C) 2018 The R Foundation for Statistical Computing
> >>> Platform: x86_64-pc-linux-gnu (64-bit)
> >>>
> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
> >>> You are welcome to redistribute it under certain conditions.
> >>> Type 'license()' or 'licence()' for distribution details.
> >>>
> >>>   Natural language support but running in an English locale
> >>>
> >>> R is a collaborative project with many contributors.
> >>> Type 'contributors()' for more information and
> >>> 'citation()' on how to cite R or R packages in publications.
> >>>
> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
> >>> 'help.start()' for an HTML browser interface to help.
> >>> Type 'q()' to quit R.
> >>>
> >>>> install.packages('rgdal')
> >>> Installing package into
> ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4?
> >>> (as ?lib? is unspecified)
> >>> trying URL 'https://cloud.r-project.org/src/contrib/rgdal_1.3-6.tar.gz
> '
> >>> Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
> >>> ==================================================
> >>> downloaded 1.6 MB
> >>>
> >>> * installing *source* package ?rgdal? ...
> >>> ** package ?rgdal? successfully unpacked and MD5 sums checked
> >>> configure: R_HOME: /usr/lib/R
> >>> configure: CC: gcc -std=gnu99
> >>> configure: CXX: g++
> >>> configure: C++11 support available
> >>> configure: rgdal: 1.3-6
> >>> checking for /usr/bin/svnversion... no
> >>> configure: svn revision: 773
> >>> checking for gdal-config... /usr/bin/gdal-config
> >>> checking gdal-config usability... yes
> >>> configure: GDAL: 2.2.3
> >>> checking GDAL version >= 1.11.4... yes
> >>> checking gdal: linking with --libs only... no
> >>> checking gdal: linking with --libs and --dep-libs... no
> >>> /usr/bin/ld: /usr/lib/libgdal.a(genbindataset.o): relocation
> R_X86_64_32
> >>> against `.rodata.str1.8' can not be used when making a PIE object;
> >>> recompile with -fPIC
> >>> /usr/bin/ld: /usr/lib/libgdal.a(geotiff.o): relocation R_X86_64_32
> >> against
> >>> `.rodata.str1.1' can not be used when making a PIE object; recompile
> with
> >>> -fPIC
> >>> /usr/bin/ld: /usr/lib/libgdal.a(gff_dataset.o): relocation R_X86_64_32S
> >>> against hidden symbol `_ZTV10GFFDataset' can not be used when making a
> >> PIE
> >>> object
> >>>
> >>> *
> >>> * Long list
> >>> *
> >>> /usr/bin/ld: /usr/lib/libgdal.a(gmlhandler.o): relocation R_X86_64_32
> >>> against `.rodata.str1.1' can not be used when making a PIE object;
> >>> recompile with -fPIC
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ili2handler.o): relocation R_X86_64_32S
> >>> against hidden symbol `_ZTV11ILI2Handler' can not be used when making a
> >> PIE
> >>> object
> >>> /usr/bin/ld: /usr/lib/libgdal.a(nashandler.o): relocation R_X86_64_32
> >>> against `.rodata.str1.8' can not be used when making a PIE object;
> >>> recompile with -fPIC
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_codelist.o): relocation R_X86_64_32
> >>> against `.rodata.str1.1' can not be used when making a PIE object;
> >>> recompile with -fPIC
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_estlayers.o): relocation
> R_X86_64_32S
> >>> against hidden symbol `_ZN11OGRNTFLayer12GetLayerDefnEv' can not be
> used
> >>> when making a PIE object
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ntf_raster.o): relocation R_X86_64_32S
> >>> against hidden symbol `_ZTV17OGRNTFRasterLayer' can not be used when
> >> making
> >>> a PIE object
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ogrmssqlgeometryparser.o): relocation
> >>> R_X86_64_32S against `.rodata' can not be used when making a PIE
> object;
> >>> recompile with -fPIC
> >>> /usr/bin/ld: final link failed: Nonrepresentable section on output
> >>> collect2: error: ld returned 1 exit status
> >>> /usr/bin/ld: /usr/lib/libgdal.a(ogrsqliteapiroutines.o): undefined
> >>> reference to symbol 'sqlite3_prepare'
> >>> /usr/lib/x86_64-linux-gnu/libsqlite3.so.0: error adding symbols: DSO
> >>> missing from command line
> >>> collect2: error: ld returned 1 exit status
> >>> configure: Install failure: compilation and/or linkage problems.
> >>> configure: error: GDALAllRegister not found in libgdal.
> >>> ERROR: configuration failed for package ?rgdal?
> >>> * removing ?/home/jeremy/R/x86_64-pc-linux-gnu-library/3.4/rgdal?
> >>>
> >>> The downloaded source packages are in
> >>>     ?/tmp/RtmpKSJ85K/downloaded_packages?
> >>> Warning message:
> >>> In install.packages("rgdal") :
> >>>   installation of package ?rgdal? had non-zero exit status
> >>>
> >>>
> >>
> >> Looks like an issue with your system libgdal-dev package, perhaps
> >> reinstall the system dependencies. Which OS are you installing on?
> >>
> >> Thanks,
> >> Alex
> >>
> >>
> >
>
>

-- 
Jeremy Kraft
Data Scientist

Parkbob GmbH
jeremy.kraft at parkbob.com <ivan.kasanicky at parkbob.com>
www.parkbob.com
FN 430551 p FB-Gericht: Handelsgericht Wien

The contents of this e-mail message and any attachments are confidential
and are intended solely for the addressee. This transmission is sent in
trust, for the sole purpose of delivery to the intended recipient. If you
have received this transmission in error, any use, reproduction or
dissemination of this transmission is strictly prohibited. If you are not
the intended recipient, please immediately *notify* the sender by reply
e-mail or phone and *delete* this message and its attachments, if any.

	[[alternative HTML version deleted]]


From pg@udhee@h @ending from gm@il@com  Thu Nov  8 14:50:38 2018
From: pg@udhee@h @ending from gm@il@com (sudheesh pai)
Date: Thu, 8 Nov 2018 14:50:38 +0100
Subject: [R-sig-Geo] R code for inverse distance to a power
Message-ID: <CA+2PVpFgZ6iZ7kpJFzgQNoa7rtdj59JPhw5GPiJDReLPK1LoHw@mail.gmail.com>

Hi,

I am looking for an R code to replace the inverse distance to a power
algorithm in QGIS, which has the input as point shape file. the parameters
of algorithm are radius 1 (R1), radius 2 (R2) and the z parameter.
Also, my CRS is 3006 which means that i have to specify R1 and R2 in
meters.

If some one has an example, kindly let me know.

Thank you

-- 
SUDHEESH.P.G
pgsudheesh at gmail.com

	[[alternative HTML version deleted]]


From tech_dev @ending from wildintellect@com  Fri Nov  9 00:42:45 2018
From: tech_dev @ending from wildintellect@com (Alex M)
Date: Thu, 8 Nov 2018 15:42:45 -0800
Subject: [R-sig-Geo] R code for inverse distance to a power
In-Reply-To: <CA+2PVpFgZ6iZ7kpJFzgQNoa7rtdj59JPhw5GPiJDReLPK1LoHw@mail.gmail.com>
References: <CA+2PVpFgZ6iZ7kpJFzgQNoa7rtdj59JPhw5GPiJDReLPK1LoHw@mail.gmail.com>
Message-ID: <26d7545f-648a-afab-8f9d-c4b03a9b664c@wildintellect.com>

On 11/8/18 05:50, sudheesh pai wrote:
> Hi,
> 
> I am looking for an R code to replace the inverse distance to a power
> algorithm in QGIS, which has the input as point shape file. the parameters
> of algorithm are radius 1 (R1), radius 2 (R2) and the z parameter.
> Also, my CRS is 3006 which means that i have to specify R1 and R2 in
> meters.
> 
> If some one has an example, kindly let me know.
> 
> Thank you
> 

Sounds like you are talking about Inverse Distance Weighted functions
(IDW). Yes the gstat package has a function for that.

Example:
https://mgimond.github.io/Spatial/interpolation-in-r.html

Enjoy,
Alex


From public @ending from c@re@g@@net  Mon Nov 12 05:14:12 2018
From: public @ending from c@re@g@@net (Richard Careaga)
Date: Sun, 11 Nov 2018 20:14:12 -0800
Subject: [R-sig-Geo] How to extract values in an sf Points object
Message-ID: <CAKQZOLVAATn9WuGNmrfA2LVrxiUBX-sawXRZHAxN7qVyymAAzA@mail.gmail.com>

I have a a **tibble** containing objects of class **sfc_POINT** such as

    # A tibble: 1 x 1
              geometry
    *          <POINT [?]>
    1 (-86.82857 32.78871)

where, of course, the two dbl represent longitude and latitude that I wish
to combine to another data frame for plotting as the centroids of
geographic units that can be (1) adjusted manually for position (it's a
more or less permanent basemap, so I only have to do this once) and (2)
optionally located on a thematic map, in my case, the US. (I apologize for
our current political situation.)

Although I can do this by subsetting

    str(foo[[1]][2])
    num 32.8

to get the latitude of a point (which, blessedly is only displayed, not
truncated to one decimal) and by making the second subindex [[1]] for
latitude, what I want is to do this at a pass for a tibble column of 50.

This is possible, of course, with some fancy footwork and, if I had to do
it 50 times, I would. Before that, however, I'd like to be sure I haven't
missed a recipe.

My plan is to use this with the **usmap** package to create a standardized,
projected base map on which to create thematic maps. The package returns a
*ggplot* friendly object of a converted shapefile of US states and
optionally counties and subsets of states. **And** it insets Alaska and
Hawaii and discards  the farflung territories. Since the boundaries (for
now) of the states are stable, once created, it can be saved as an Rda
object along with its centroid data and dyplr::inner_joint on the state
fips.

Again, the object is to decompose a POINT object -- (-86.82857 32.78871)
into a list c(-86.82857, 32.78871) or some other structure amenable to
tidyverse treatment.

Thanks in advance.

Richard Careaga
Unaffiliated (so much more a gracious term than permanently unemployable)
@technocrat
https://technocrat.rbind.io

	[[alternative HTML version deleted]]


From tim@how@rd @ending from dec@ny@gov  Tue Nov 13 16:10:23 2018
From: tim@how@rd @ending from dec@ny@gov (Howard, Tim G (DEC))
Date: Tue, 13 Nov 2018 15:10:23 +0000
Subject: [R-sig-Geo] stars::RasterIO using extent info?
Message-ID: <BN6PR09MB1524AED29DC64354B46E92D3A8C20@BN6PR09MB1524.namprd09.prod.outlook.com>

Dear list, 

I am exploring the different options for reading parts of large imagery object in stars, as discussed here:

https://r-spatial.github.io/stars/articles/proxy.html

My ultimate goal is to read into RAM only a clipped portion of a large raster (well, actually a raster stack, but taking baby steps here).  

My immediate question: the `RasterIO` option of read_stars defines cell offsets and cell counts (*Size). Is there a straightforward way to calculate these values given extent information?

Reproducible example (mostly taken from here: https://www.r-spatial.org/r/2018/03/22/stars2.html):

library(stars)
tif <- system.file("tif/L7_ETMs.tif", package = "stars")
x <- read_stars(tif) # read entire tif into ram
x <- x[,,,1] #get just one layer for now
# calculate a circular polygon at the center of the raster
pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)
plot(x)
# interestingly, I don't think the circle is in the right place when plotted
plot(st_geometry(pol), add = TRUE, border = "red")
# this is what I'd like to be able to restrict to what is read in memory:
plot(x[pol])

## read only portion of tif using proxy object
x <- read_stars(tif, proxy = TRUE) 
x <- x[,,,1]
y <- st_as_stars(x[pol])
plot(y) # this is cropped to the extent (but not the circle - let's not worry about that right now)

Question: can I do the equivalent with the RasterIO options in stars?  Said another way, instead of setting up the proxy, can I map my extent object (or bounding box) directly to the cell count values needed for RasterIO?


Thanks in advance for any tips. 
Tim


From edzer@pebe@m@ @ending from uni-muen@ter@de  Tue Nov 13 17:26:16 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Tue, 13 Nov 2018 17:26:16 +0100
Subject: [R-sig-Geo] stars::RasterIO using extent info?
In-Reply-To: <BN6PR09MB1524AED29DC64354B46E92D3A8C20@BN6PR09MB1524.namprd09.prod.outlook.com>
References: <BN6PR09MB1524AED29DC64354B46E92D3A8C20@BN6PR09MB1524.namprd09.prod.outlook.com>
Message-ID: <9d037da7-dc9c-9886-d6fc-5864cf8b4a17@uni-muenster.de>



On 11/13/18 4:10 PM, Howard, Tim G (DEC) via R-sig-Geo wrote:
> Dear list, 
> 
> I am exploring the different options for reading parts of large imagery object in stars, as discussed here:
> 
> https://r-spatial.github.io/stars/articles/proxy.html
> 
> My ultimate goal is to read into RAM only a clipped portion of a large raster (well, actually a raster stack, but taking baby steps here).  
> 
> My immediate question: the `RasterIO` option of read_stars defines cell offsets and cell counts (*Size). Is there a straightforward way to calculate these values given extent information?
> 
> Reproducible example (mostly taken from here: https://www.r-spatial.org/r/2018/03/22/stars2.html):
> 
> library(stars)
> tif <- system.file("tif/L7_ETMs.tif", package = "stars")
> x <- read_stars(tif) # read entire tif into ram
> x <- x[,,,1] #get just one layer for now
> # calculate a circular polygon at the center of the raster
> pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)
> plot(x)
> # interestingly, I don't think the circle is in the right place when plotted
> plot(st_geometry(pol), add = TRUE, border = "red")
> # this is what I'd like to be able to restrict to what is read in memory:
> plot(x[pol])
> 
> ## read only portion of tif using proxy object
> x <- read_stars(tif, proxy = TRUE) 
> x <- x[,,,1]
> y <- st_as_stars(x[pol])
> plot(y) # this is cropped to the extent (but not the circle - let's not worry about that right now)
> 
> Question: can I do the equivalent with the RasterIO options in stars?  Said another way, instead of setting up the proxy, can I map my extent object (or bounding box) directly to the cell count values needed for RasterIO?

stars can do the math, and so can you; it is explained here:

https://r-spatial.github.io/stars/articles/data_model.html

stars uses some functions directly from GDAL which it doesn't expose to
the user, but there is no magic going on here.

> 
> 
> Thanks in advance for any tips. 
> Tim
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181113/c462b0d1/attachment.bin>

From erinm@hodge@@ @ending from gm@il@com  Wed Nov 14 07:13:41 2018
From: erinm@hodge@@ @ending from gm@il@com (Erin Hodgess)
Date: Tue, 13 Nov 2018 23:13:41 -0700
Subject: [R-sig-Geo] citing the spatio-temporal kriging vignette
Message-ID: <CACxE24=hXCZyBUskM6kSF5c_C+hEgQzeT-ZGWh-AA-O8zE5pQA@mail.gmail.com>

Hello!

What is the correct way to cite the (very fine) vignette on spatio-temporal
kriging, please?

Thanks,
Erin

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Wed Nov 14 09:13:40 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Wed, 14 Nov 2018 09:13:40 +0100
Subject: [R-sig-Geo] citing the spatio-temporal kriging vignette
In-Reply-To: <CACxE24=hXCZyBUskM6kSF5c_C+hEgQzeT-ZGWh-AA-O8zE5pQA@mail.gmail.com>
References: <CACxE24=hXCZyBUskM6kSF5c_C+hEgQzeT-ZGWh-AA-O8zE5pQA@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1811140910080.4479@reclus.nhh.no>

On Wed, 14 Nov 2018, Erin Hodgess wrote:

> Hello!
>
> What is the correct way to cite the (very fine) vignette on spatio-temporal
> kriging, please?

Unless it has changed a lot since publication, print(citation("gstat"), 
bibtex=TRUE) gives among others:

@Article{,
     title = {Spatio-Temporal Interpolation using gstat},
     author = {Benedikt Gr?ler and Edzer Pebesma and Gerard Heuvelink},
     year = {2016},
     journal = {The R Journal},
     volume = {8},
     issue = {1},
     pages = {204-218},
     url = {https://journal.r-project.org/archive/2016-1/na-pebesma-heuvelink.pdf}
}

but should currently be (different URL):

@article{RJ-2016-014,
   author = {Benedikt Gr?ler and Edzer Pebesma and Gerard Heuvelink},
   title = {{Spatio-Temporal Interpolation using gstat}},
   year = {2016},
   journal = {{The R Journal}},
   url = {https://journal.r-project.org/archive/2016/RJ-2016-014/index.html},
   pages = {204--218},
   volume = {8},
   number = {1}
}

Roger

>
> Thanks,
> Erin
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From erinm@hodge@@ @ending from gm@il@com  Wed Nov 14 09:54:05 2018
From: erinm@hodge@@ @ending from gm@il@com (Erin Hodgess)
Date: Wed, 14 Nov 2018 01:54:05 -0700
Subject: [R-sig-Geo] citing the spatio-temporal kriging vignette
In-Reply-To: <alpine.LFD.2.21.1811140910080.4479@reclus.nhh.no>
References: <CACxE24=hXCZyBUskM6kSF5c_C+hEgQzeT-ZGWh-AA-O8zE5pQA@mail.gmail.com>
 <alpine.LFD.2.21.1811140910080.4479@reclus.nhh.no>
Message-ID: <CACxE24=g3hsSQaB2Z=kK+K0+tvSNo2rDPjxyrrNTt8EtQJcsyg@mail.gmail.com>

Awesome!

Thanks so much!
Erin

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Wed, Nov 14, 2018 at 1:13 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 14 Nov 2018, Erin Hodgess wrote:
>
> > Hello!
> >
> > What is the correct way to cite the (very fine) vignette on
> spatio-temporal
> > kriging, please?
>
> Unless it has changed a lot since publication, print(citation("gstat"),
> bibtex=TRUE) gives among others:
>
> @Article{,
>      title = {Spatio-Temporal Interpolation using gstat},
>      author = {Benedikt Gr?ler and Edzer Pebesma and Gerard Heuvelink},
>      year = {2016},
>      journal = {The R Journal},
>      volume = {8},
>      issue = {1},
>      pages = {204-218},
>      url = {
> https://journal.r-project.org/archive/2016-1/na-pebesma-heuvelink.pdf}
> }
>
> but should currently be (different URL):
>
> @article{RJ-2016-014,
>    author = {Benedikt Gr?ler and Edzer Pebesma and Gerard Heuvelink},
>    title = {{Spatio-Temporal Interpolation using gstat}},
>    year = {2016},
>    journal = {{The R Journal}},
>    url = {
> https://journal.r-project.org/archive/2016/RJ-2016-014/index.html},
>    pages = {204--218},
>    volume = {8},
>    number = {1}
> }
>
> Roger
>
> >
> > Thanks,
> > Erin
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From m@c@deurloo @ending from uv@@nl  Wed Nov 14 11:33:44 2018
From: m@c@deurloo @ending from uv@@nl (Deurloo, Marinus)
Date: Wed, 14 Nov 2018 10:33:44 +0000
Subject: [R-sig-Geo] st_transform problem
Message-ID: <0d68e168eae74d7b9887f54150b20573@uva.nl>

I have a shapefile from CBS/Kadaster in EPSG:28992 (Amersfoort / RD New) projection and I use st_transform to reproject to EPSG:4326.
Small R script example:


setwd("c:/testTransform")
library("sf")
polyPurmerend <- st_read(dsn = "c:/testTransform", layer = "Purmerend",stringsAsFactors = FALSE)
polyPurmerend_WGS84 <- st_transform(polyPurmerend,4326)
st_write(polyPurmerend_WGS84,dsn=paste0("","Purmerend_WGS84",".gpkg"),"polygon", layer_options="OVERWRITE=YES")

Unfortunately the resulting layer is at a different position.

[cid:7954d268-0209-4785-bc33-32c08ec236d0]

I cannot figure out why.

Rinus Deurloo
University of Amsterdam.




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181114/03d4c055/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pastedImage.png
Type: image/png
Size: 35402 bytes
Desc: pastedImage.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181114/03d4c055/attachment.png>

From tim@how@rd @ending from dec@ny@gov  Wed Nov 14 16:26:34 2018
From: tim@how@rd @ending from dec@ny@gov (Howard, Tim G (DEC))
Date: Wed, 14 Nov 2018 15:26:34 +0000
Subject: [R-sig-Geo] stars::RasterIO using extent info?
In-Reply-To: <mailman.26983.3.1542193202.58156.r-sig-geo@r-project.org>
References: <mailman.26983.3.1542193202.58156.r-sig-geo@r-project.org>
Message-ID: <BN6PR09MB152451F77CE01D4882E2CCCAA8C30@BN6PR09MB1524.namprd09.prod.outlook.com>

Ok, fair enough that there's no magic involved. I've worked through the details with the small example as follows. The result is only a couple of cells different in each direction.

library(stars)
tif <- system.file("tif/L7_ETMs.tif", package = "stars")
x <- read_stars(tif) 
x <- x[,,,1]
# calculate a circular polygon at the center of the raster
pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)

bb_pol <- st_bbox(pol)

xoff <- st_dimensions(x)$x$offset
xdelt <- st_dimensions(x)$x$delta
yoff <- st_dimensions(x)$y$offset
ydelt <- st_dimensions(x)$y$delta
cropXoff <- (bb_pol$xmin - xoff + xdelt)/xdelt
cropXsize <- (bb_pol$xmax - bb_pol$xmin)/xdelt
cropYoff <- (bb_pol$ymin - yoff + ydelt)/ydelt
cropYsize <- (bb_pol$ymax - bb_pol$ymin)/ydelt

# if ydelt is negative, get abs of ysize and move yoffset to the top
if(cropYsize < 0){
  cropYsize <- abs(cropYsize)
  cropYoff <- cropYoff - cropYsize  
}

rasterio <- list(nXOff = cropXoff, nYOff = cropYoff, nXSize = cropXsize, nYSize = cropYsize, bands = c(1))
(z = read_stars(tif, RasterIO = rasterio))
plot(z)

# crop it if desired
plot(z[pol])

## compare to proxy method

x <- read_stars(tif, proxy = TRUE) 
x <- x[,,,1]
y <- st_as_stars(x[pol])
plot(y)

# only a couple of cells off!
z
y




------------------------------
Date: Tue, 13 Nov 2018 17:26:16 +0100
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] stars::RasterIO using extent info?
Message-ID: <9d037da7-dc9c-9886-d6fc-5864cf8b4a17 at uni-muenster.de>
Content-Type: text/plain; charset="utf-8"



On 11/13/18 4:10 PM, Howard, Tim G (DEC) via R-sig-Geo wrote:
> Dear list,
>
> I am exploring the different options for reading parts of large imagery object in stars, as discussed here:
>
> https://r-spatial.github.io/stars/articles/proxy.html
>
> My ultimate goal is to read into RAM only a clipped portion of a large raster (well, actually a raster stack, but taking baby steps here).
>
> My immediate question: the `RasterIO` option of read_stars defines cell offsets and cell counts (*Size). Is there a straightforward way to calculate these values given extent information?
>
> Reproducible example (mostly taken from here:  https://www.r-spatial.org/r/2018/03/22/stars2.html):
>
> library(stars)
> tif <- system.file("tif/L7_ETMs.tif", package = "stars")
> x <- read_stars(tif) # read entire tif into ram
> x <- x[,,,1] #get just one layer for now
> # calculate a circular polygon at the center of the raster
> pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)
> plot(x)
> # interestingly, I don't think the circle is in the right place when plotted
> plot(st_geometry(pol), add = TRUE, border = "red")
> # this is what I'd like to be able to restrict to what is read in memory:
> plot(x[pol])
>
> ## read only portion of tif using proxy object
> x <- read_stars(tif, proxy = TRUE)
> x <- x[,,,1]
> y <- st_as_stars(x[pol])
> plot(y) # this is cropped to the extent (but not the circle - let's not worry about that right now)
>
> Question: can I do the equivalent with the RasterIO options in stars?? Said another way, instead of setting up the proxy, can I map my extent object (or bounding box) directly to the cell count values needed for RasterIO?

stars can do the math, and so can you; it is explained here:

https://r-spatial.github.io/stars/articles/data_model.html

stars uses some functions directly from GDAL which it doesn't expose to
the user, but there is no magic going on here.

>
>
> Thanks in advance for any tips.
> Tim
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From md@umner @ending from gm@il@com  Wed Nov 14 23:55:29 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Thu, 15 Nov 2018 09:55:29 +1100
Subject: [R-sig-Geo] stars::RasterIO using extent info?
In-Reply-To: <BN6PR09MB152451F77CE01D4882E2CCCAA8C30@BN6PR09MB1524.namprd09.prod.outlook.com>
References: <mailman.26983.3.1542193202.58156.r-sig-geo@r-project.org>
 <BN6PR09MB152451F77CE01D4882E2CCCAA8C30@BN6PR09MB1524.namprd09.prod.outlook.com>
Message-ID: <CAAcGz981kyOfkOVi1UwdUAv7bMVjo+A2+bL0DcGVFf5-N5y=5w@mail.gmail.com>

FWIW I have a raster-delivering-front-end for RasterIO in this dev package:

https://github.com/hypertidy/lazyraster

It uses the more obvious extent() idioms and will even use an open plot if
nothing else is specified.

(It uses an independent binding to GDAL in the vapour package).

That might help, or not. It's on my list to find a sensible way for stars
to leverage this obvious ease-of-use.  rgdal::readGDAL always had an
interface to RasterIO, but only raster ever made use of that, and it's
indirect - raster doesn't allow a mix of extent and resolution in its
approach.

Cheers, Mike.

On Thu, 15 Nov 2018 at 02:27 Howard, Tim G (DEC) via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Ok, fair enough that there's no magic involved. I've worked through the
> details with the small example as follows. The result is only a couple of
> cells different in each direction.
>
> library(stars)
> tif <- system.file("tif/L7_ETMs.tif", package = "stars")
> x <- read_stars(tif)
> x <- x[,,,1]
> # calculate a circular polygon at the center of the raster
> pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)
>
> bb_pol <- st_bbox(pol)
>
> xoff <- st_dimensions(x)$x$offset
> xdelt <- st_dimensions(x)$x$delta
> yoff <- st_dimensions(x)$y$offset
> ydelt <- st_dimensions(x)$y$delta
> cropXoff <- (bb_pol$xmin - xoff + xdelt)/xdelt
> cropXsize <- (bb_pol$xmax - bb_pol$xmin)/xdelt
> cropYoff <- (bb_pol$ymin - yoff + ydelt)/ydelt
> cropYsize <- (bb_pol$ymax - bb_pol$ymin)/ydelt
>
> # if ydelt is negative, get abs of ysize and move yoffset to the top
> if(cropYsize < 0){
>   cropYsize <- abs(cropYsize)
>   cropYoff <- cropYoff - cropYsize
> }
>
> rasterio <- list(nXOff = cropXoff, nYOff = cropYoff, nXSize = cropXsize,
> nYSize = cropYsize, bands = c(1))
> (z = read_stars(tif, RasterIO = rasterio))
> plot(z)
>
> # crop it if desired
> plot(z[pol])
>
> ## compare to proxy method
>
> x <- read_stars(tif, proxy = TRUE)
> x <- x[,,,1]
> y <- st_as_stars(x[pol])
> plot(y)
>
> # only a couple of cells off!
> z
> y
>
>
>
>
> ------------------------------
> Date: Tue, 13 Nov 2018 17:26:16 +0100
> From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] stars::RasterIO using extent info?
> Message-ID: <9d037da7-dc9c-9886-d6fc-5864cf8b4a17 at uni-muenster.de>
> Content-Type: text/plain; charset="utf-8"
>
>
>
> On 11/13/18 4:10 PM, Howard, Tim G (DEC) via R-sig-Geo wrote:
> > Dear list,
> >
> > I am exploring the different options for reading parts of large imagery
> object in stars, as discussed here:
> >
> > https://r-spatial.github.io/stars/articles/proxy.html
> >
> > My ultimate goal is to read into RAM only a clipped portion of a large
> raster (well, actually a raster stack, but taking baby steps here).
> >
> > My immediate question: the `RasterIO` option of read_stars defines cell
> offsets and cell counts (*Size). Is there a straightforward way to
> calculate these values given extent information?
> >
> > Reproducible example (mostly taken from here:
> https://www.r-spatial.org/r/2018/03/22/stars2.html):
> >
> > library(stars)
> > tif <- system.file("tif/L7_ETMs.tif", package = "stars")
> > x <- read_stars(tif) # read entire tif into ram
> > x <- x[,,,1] #get just one layer for now
> > # calculate a circular polygon at the center of the raster
> > pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>%
> st_buffer(500)
> > plot(x)
> > # interestingly, I don't think the circle is in the right place when
> plotted
> > plot(st_geometry(pol), add = TRUE, border = "red")
> > # this is what I'd like to be able to restrict to what is read in memory:
> > plot(x[pol])
> >
> > ## read only portion of tif using proxy object
> > x <- read_stars(tif, proxy = TRUE)
> > x <- x[,,,1]
> > y <- st_as_stars(x[pol])
> > plot(y) # this is cropped to the extent (but not the circle - let's not
> worry about that right now)
> >
> > Question: can I do the equivalent with the RasterIO options in stars?
> Said another way, instead of setting up the proxy, can I map my extent
> object (or bounding box) directly to the cell count values needed for
> RasterIO?
>
> stars can do the math, and so can you; it is explained here:
>
> https://r-spatial.github.io/stars/articles/data_model.html
>
> stars uses some functions directly from GDAL which it doesn't expose to
> the user, but there is no magic going on here.
>
> >
> >
> > Thanks in advance for any tips.
> > Tim
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081 <+49%20251%208333081>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From tim@how@rd @ending from dec@ny@gov  Thu Nov 15 13:31:11 2018
From: tim@how@rd @ending from dec@ny@gov (Howard, Tim G (DEC))
Date: Thu, 15 Nov 2018 12:31:11 +0000
Subject: [R-sig-Geo] stars::RasterIO using extent info?
In-Reply-To: <CAAcGz981kyOfkOVi1UwdUAv7bMVjo+A2+bL0DcGVFf5-N5y=5w@mail.gmail.com>
References: <mailman.26983.3.1542193202.58156.r-sig-geo@r-project.org>
 <BN6PR09MB152451F77CE01D4882E2CCCAA8C30@BN6PR09MB1524.namprd09.prod.outlook.com>
 <CAAcGz981kyOfkOVi1UwdUAv7bMVjo+A2+bL0DcGVFf5-N5y=5w@mail.gmail.com>
Message-ID: <BN6PR09MB15240250F4D027BEE9907F9EA8DC0@BN6PR09MB1524.namprd09.prod.outlook.com>

Mike, 
Thanks for the feedback - I'll check it out. 
Best, 
Tim

From: Michael Sumner [mailto:mdsumner at gmail.com] 
Sent: Wednesday, November 14, 2018 5:55 PM
To: Howard, Tim G (DEC) <tim.howard at dec.ny.gov>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] stars::RasterIO using extent info?

FWIW I have a raster-delivering-front-end for RasterIO in this dev package:? 

https://github.com/hypertidy/lazyraster

It uses the more obvious extent() idioms and will even use an open plot if nothing else is specified.?

(It uses an independent binding to GDAL in the vapour package).?

That might help, or not. It's on my list to find a sensible way for stars to leverage this obvious ease-of-use.? rgdal::readGDAL always had an interface to RasterIO, but only raster ever made use of that, and it's indirect - raster doesn't allow a mix of extent and resolution in its approach.?

Cheers, Mike.?

On Thu, 15 Nov 2018 at 02:27 Howard, Tim G (DEC) via R-sig-Geo <mailto:r-sig-geo at r-project.org> wrote:
Ok, fair enough that there's no magic involved. I've worked through the details with the small example as follows. The result is only a couple of cells different in each direction.

library(stars)
tif <- system.file("tif/L7_ETMs.tif", package = "stars")
x <- read_stars(tif) 
x <- x[,,,1]
# calculate a circular polygon at the center of the raster
pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)

bb_pol <- st_bbox(pol)

xoff <- st_dimensions(x)$x$offset
xdelt <- st_dimensions(x)$x$delta
yoff <- st_dimensions(x)$y$offset
ydelt <- st_dimensions(x)$y$delta
cropXoff <- (bb_pol$xmin - xoff + xdelt)/xdelt
cropXsize <- (bb_pol$xmax - bb_pol$xmin)/xdelt
cropYoff <- (bb_pol$ymin - yoff + ydelt)/ydelt
cropYsize <- (bb_pol$ymax - bb_pol$ymin)/ydelt

# if ydelt is negative, get abs of ysize and move yoffset to the top
if(cropYsize < 0){
? cropYsize <- abs(cropYsize)
? cropYoff <- cropYoff - cropYsize? 
}

rasterio <- list(nXOff = cropXoff, nYOff = cropYoff, nXSize = cropXsize, nYSize = cropYsize, bands = c(1))
(z = read_stars(tif, RasterIO = rasterio))
plot(z)

# crop it if desired
plot(z[pol])

## compare to proxy method

x <- read_stars(tif, proxy = TRUE) 
x <- x[,,,1]
y <- st_as_stars(x[pol])
plot(y)

# only a couple of cells off!
z
y




------------------------------
Date: Tue, 13 Nov 2018 17:26:16 +0100
From: Edzer Pebesma <mailto:edzer.pebesma at uni-muenster.de>
To: mailto:r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] stars::RasterIO using extent info?
Message-ID: <mailto:9d037da7-dc9c-9886-d6fc-5864cf8b4a17 at uni-muenster.de>
Content-Type: text/plain; charset="utf-8"



On 11/13/18 4:10 PM, Howard, Tim G (DEC) via R-sig-Geo wrote:
> Dear list,
>
> I am exploring the different options for reading parts of large imagery object in stars, as discussed here:
>
> https://r-spatial.github.io/stars/articles/proxy.html
>
> My ultimate goal is to read into RAM only a clipped portion of a large raster (well, actually a raster stack, but taking baby steps here).
>
> My immediate question: the `RasterIO` option of read_stars defines cell offsets and cell counts (*Size). Is there a straightforward way to calculate these values given extent information?
>
> Reproducible example (mostly taken from here:? https://www.r-spatial.org/r/2018/03/22/stars2.html):
>
> library(stars)
> tif <- system.file("tif/L7_ETMs.tif", package = "stars")
> x <- read_stars(tif) # read entire tif into ram
> x <- x[,,,1] #get just one layer for now
> # calculate a circular polygon at the center of the raster
> pol <- x %>% st_bbox() %>% st_as_sfc() %>% st_centroid() %>% st_buffer(500)
> plot(x)
> # interestingly, I don't think the circle is in the right place when plotted
> plot(st_geometry(pol), add = TRUE, border = "red")
> # this is what I'd like to be able to restrict to what is read in memory:
> plot(x[pol])
>
> ## read only portion of tif using proxy object
> x <- read_stars(tif, proxy = TRUE)
> x <- x[,,,1]
> y <- st_as_stars(x[pol])
> plot(y) # this is cropped to the extent (but not the circle - let's not worry about that right now)
>
> Question: can I do the equivalent with the RasterIO options in stars?? Said another way, instead of setting up the proxy, can I map my extent object (or bounding box) directly to the cell count values needed for RasterIO?

stars can do the math, and so can you; it is explained here:

https://r-spatial.github.io/stars/articles/data_model.html

stars uses some functions directly from GDAL which it doesn't expose to
the user, but there is no magic going on here.

>
>
> Thanks in advance for any tips.
> Tim
>
> _______________________________________________
> R-sig-Geo mailing list
> mailto:R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: tel:+49%20251%208333081

_______________________________________________
R-sig-Geo mailing list
mailto:R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

From em@nuele@cord@no @ending from gm@il@com  Sat Nov 17 13:57:41 2018
From: em@nuele@cord@no @ending from gm@il@com (Emanuele Cordano)
Date: Sat, 17 Nov 2018 13:57:41 +0100
Subject: [R-sig-Geo] rgdal segmentation fault during installation
Message-ID: <CAKw81f_-crT+fhS0EwWGHBDpGPnx-viGeoipYJMPrLDvaLxu-A@mail.gmail.com>

Dear list,

I got the following segmentation fault error when I try to install rgdal on
my local Ubuntu 16.04 LTS machine. Did anyone encounter something similar?
Please below the error message with traceback and R session info.
Similar problems appears on
https://stackoverflow.com/questions/50064673/cannot-install-rgdal-package-in-local-server-an-irrecoverable-exception-occurre
which remains unsolved . In my case (see below)  all checks, PROJ4
included,  were OK!

Thank you for any kind of feedback
Best
Emanuele Cordano

user at machine:~$ R

R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> install.packages("rgdal")
Installing package into ?/home/ecor/R/x86_64-pc-linux-gnu-library/3.5?
(as ?lib? is unspecified)
trying URL 'http://cran.r-project.org/src/contrib/rgdal_1.3-6.tar.gz'
Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: R_HOME: /usr/lib/R
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: C++11 support available
configure: rgdal: 1.3-6
checking for /usr/bin/svnversion... yes
configure: svn revision: 773
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.1.3
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... yes
checking GDAL: /usr/share/gdal/2.1/pcs.csv readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 4.9.2
checking proj_api.h presence and usability... yes
checking PROJ version >= 4.8.0... yes
checking projects.h presence and usability... yes
checking PROJ.4: epsg found and readable... yes
checking PROJ.4: conus found and readable... yes
configure: Package CPP flags:  -I/usr/include/gdal
configure: Package LIBS:  -L/usr/lib -lgdal -lproj
configure: creating ./config.status
config.status: creating src/Makevars
** libs
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c OGR_write.cpp -o OGR_write.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c gdal-bindings.cpp -o gdal-bindings.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g  -c inverser.c -o inverser.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o local_stubs.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c ogr_geom.cpp -o ogr_geom.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o ogr_polygons.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c ogr_proj.cpp -o ogr_proj.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c ogrdrivers.cpp -o ogrdrivers.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c ogrsource.cpp -o ogrsource.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
-I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
-O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
-D_FORTIFY_SOURCE=2 -g -c projectit.cpp -o projectit.o
g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions
-Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o
local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o
projectit.o -L/usr/lib -lgdal -lproj -L/usr/lib/R/lib -lR
installing to /home/ecor/R/x86_64-pc-linux-gnu-library/3.5/rgdal/libs
** R
** data
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded

 *** caught segfault ***
address 0x20, cause 'memory not mapped'

Traceback:
 1: assign("has_proj_def.dat", .Call("PROJ4_proj_def_dat_Installed",
PACKAGE = "rgdal"), envir = .RGDAL_CACHE)
 2: fun(libname, pkgname)
 3: doTryCatch(return(expr), name, parentenv, handler)
 4: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5: tryCatchList(expr, classes, parentenv, handlers)
 6: tryCatch(fun(libname, pkgname), error = identity)
 7: runHook(".onLoad", env, package.lib, package)
 8: loadNamespace(package, lib.loc)
 9: doTryCatch(return(expr), name, parentenv, handler)
10: tryCatchOne(expr, names, parentenv, handlers[[1L]])
11: tryCatchList(expr, classes, parentenv, handlers)
12: tryCatch({    attr(package, "LibPath") <- which.lib.loc    ns <-
loadNamespace(package, lib.loc)    env <- attachNamespace(ns, pos = pos,
deps)}, error = function(e) {    P <- if (!is.null(cc <- conditionCall(e)))
        paste(" in", deparse(cc)[1L])    else ""    msg <-
gettextf("package or namespace load failed for %s%s:\n %s",
sQuote(package), P, conditionMessage(e))    if (logical.return)
message(paste("Error:", msg), domain = NA)    else stop(msg, call. = FALSE,
domain = NA)})
13: library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return
= TRUE)
14: withCallingHandlers(expr, packageStartupMessage = function(c)
invokeRestart("muffleMessage"))
15: suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,
character.only = TRUE, logical.return = TRUE))
16: doTryCatch(return(expr), name, parentenv, handler)
17: tryCatchOne(expr, names, parentenv, handlers[[1L]])
18: tryCatchList(expr, classes, parentenv, handlers)
19: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if
(!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))
        call <- sys.call(-4L)        dcall <- deparse(call)[1L]
 prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        sm <-
strsplit(conditionMessage(e), "\n")[[1L]]        w <- 14L + nchar(dcall,
type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w
<- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type =
"b")        if (w > LONG)             prefix <- paste0(prefix, "\n  ")    }
   else prefix <- "Error : "    msg <- paste0(prefix, conditionMessage(e),
"\n")    .Internal(seterrmessage(msg[1L]))    if (!silent &&
isTRUE(getOption("show.error.messages"))) {        cat(msg, file = outFile)
       .Internal(printDeferredWarnings())    }    invisible(structure(msg,
class = "try-error", condition = e))})
20: try(suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,
character.only = TRUE, logical.return = TRUE)))
21: tools:::.test_load_package("rgdal",
"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5")
An irrecoverable exception occurred. R is aborting now ...
Segmentation fault (core dumped)
ERROR: loading failed
* removing ?/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/rgdal?

The downloaded source packages are in
?/tmp/Rtmpq9SibK/downloaded_packages?
Warning message:
In install.packages("rgdal") :
  installation of package ?rgdal? had non-zero exit status
> sessionInfo()
R version 3.5.1 (2018-07-02)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 16.04.5 LTS

Matrix products: default
BLAS: /usr/lib/libblas/libblas.so.3.6.0
LAPACK: /usr/lib/lapack/liblapack.so.3.6.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_IE.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_IE.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_IE.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_IE.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_3.5.1 tools_3.5.1
>

-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @ending from uni-muen@ter@de  Sat Nov 17 14:04:59 2018
From: edzer@pebe@m@ @ending from uni-muen@ter@de (Edzer Pebesma)
Date: Sat, 17 Nov 2018 14:04:59 +0100
Subject: [R-sig-Geo] rgdal segmentation fault during installation
In-Reply-To: <CAKw81f_-crT+fhS0EwWGHBDpGPnx-viGeoipYJMPrLDvaLxu-A@mail.gmail.com>
References: <CAKw81f_-crT+fhS0EwWGHBDpGPnx-viGeoipYJMPrLDvaLxu-A@mail.gmail.com>
Message-ID: <7e9c0137-5e77-8849-b058-e240e9924c6f@uni-muenster.de>

It looks like you have multiple versions of GDAL and/or PROJ installed
on your system; see https://github.com/r-spatial/sf the section on
"Multiple GDAL, GEOS and/or PROJ versions on your system" and there the
link to https://github.com/r-spatial/sf/issues/844 which contains a very
ugly solution (setting LD_LIBRARY_PATH from within R).

On 11/17/18 1:57 PM, Emanuele Cordano wrote:
> Dear list,
> 
> I got the following segmentation fault error when I try to install rgdal on
> my local Ubuntu 16.04 LTS machine. Did anyone encounter something similar?
> Please below the error message with traceback and R session info.
> Similar problems appears on
> https://stackoverflow.com/questions/50064673/cannot-install-rgdal-package-in-local-server-an-irrecoverable-exception-occurre
> which remains unsolved . In my case (see below)  all checks, PROJ4
> included,  were OK!
> 
> Thank you for any kind of feedback
> Best
> Emanuele Cordano
> 
> user at machine:~$ R
> 
> R version 3.5.1 (2018-07-02) -- "Feather Spray"
> Copyright (C) 2018 The R Foundation for Statistical Computing
> Platform: x86_64-pc-linux-gnu (64-bit)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> [Previously saved workspace restored]
> 
>> install.packages("rgdal")
> Installing package into ?/home/ecor/R/x86_64-pc-linux-gnu-library/3.5?
> (as ?lib? is unspecified)
> trying URL 'http://cran.r-project.org/src/contrib/rgdal_1.3-6.tar.gz'
> Content type 'application/x-gzip' length 1666975 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
> 
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: R_HOME: /usr/lib/R
> configure: CC: gcc -std=gnu99
> configure: CXX: g++
> configure: C++11 support available
> configure: rgdal: 1.3-6
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 773
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.1.3
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: /usr/share/gdal/2.1/pcs.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 4.9.2
> checking proj_api.h presence and usability... yes
> checking PROJ version >= 4.8.0... yes
> checking projects.h presence and usability... yes
> checking PROJ.4: epsg found and readable... yes
> checking PROJ.4: conus found and readable... yes
> configure: Package CPP flags:  -I/usr/include/gdal
> configure: Package LIBS:  -L/usr/lib -lgdal -lproj
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c OGR_write.cpp -o OGR_write.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c gdal-bindings.cpp -o gdal-bindings.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g  -c inverser.c -o inverser.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o local_stubs.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c ogr_geom.cpp -o ogr_geom.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o ogr_polygons.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c ogr_proj.cpp -o ogr_proj.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c ogrdrivers.cpp -o ogrdrivers.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c ogrsource.cpp -o ogrsource.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include/gdal
> -I"/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/sp/include"    -fpic  -g
> -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g -c projectit.cpp -o projectit.o
> g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions
> -Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o
> local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o
> projectit.o -L/usr/lib -lgdal -lproj -L/usr/lib/R/lib -lR
> installing to /home/ecor/R/x86_64-pc-linux-gnu-library/3.5/rgdal/libs
> ** R
> ** data
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded
> 
>  *** caught segfault ***
> address 0x20, cause 'memory not mapped'
> 
> Traceback:
>  1: assign("has_proj_def.dat", .Call("PROJ4_proj_def_dat_Installed",
> PACKAGE = "rgdal"), envir = .RGDAL_CACHE)
>  2: fun(libname, pkgname)
>  3: doTryCatch(return(expr), name, parentenv, handler)
>  4: tryCatchOne(expr, names, parentenv, handlers[[1L]])
>  5: tryCatchList(expr, classes, parentenv, handlers)
>  6: tryCatch(fun(libname, pkgname), error = identity)
>  7: runHook(".onLoad", env, package.lib, package)
>  8: loadNamespace(package, lib.loc)
>  9: doTryCatch(return(expr), name, parentenv, handler)
> 10: tryCatchOne(expr, names, parentenv, handlers[[1L]])
> 11: tryCatchList(expr, classes, parentenv, handlers)
> 12: tryCatch({    attr(package, "LibPath") <- which.lib.loc    ns <-
> loadNamespace(package, lib.loc)    env <- attachNamespace(ns, pos = pos,
> deps)}, error = function(e) {    P <- if (!is.null(cc <- conditionCall(e)))
>         paste(" in", deparse(cc)[1L])    else ""    msg <-
> gettextf("package or namespace load failed for %s%s:\n %s",
> sQuote(package), P, conditionMessage(e))    if (logical.return)
> message(paste("Error:", msg), domain = NA)    else stop(msg, call. = FALSE,
> domain = NA)})
> 13: library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return
> = TRUE)
> 14: withCallingHandlers(expr, packageStartupMessage = function(c)
> invokeRestart("muffleMessage"))
> 15: suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,
> character.only = TRUE, logical.return = TRUE))
> 16: doTryCatch(return(expr), name, parentenv, handler)
> 17: tryCatchOne(expr, names, parentenv, handlers[[1L]])
> 18: tryCatchList(expr, classes, parentenv, handlers)
> 19: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if
> (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))
>         call <- sys.call(-4L)        dcall <- deparse(call)[1L]
>  prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        sm <-
> strsplit(conditionMessage(e), "\n")[[1L]]        w <- 14L + nchar(dcall,
> type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w
> <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type =
> "b")        if (w > LONG)             prefix <- paste0(prefix, "\n  ")    }
>    else prefix <- "Error : "    msg <- paste0(prefix, conditionMessage(e),
> "\n")    .Internal(seterrmessage(msg[1L]))    if (!silent &&
> isTRUE(getOption("show.error.messages"))) {        cat(msg, file = outFile)
>        .Internal(printDeferredWarnings())    }    invisible(structure(msg,
> class = "try-error", condition = e))})
> 20: try(suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,
> character.only = TRUE, logical.return = TRUE)))
> 21: tools:::.test_load_package("rgdal",
> "/home/ecor/R/x86_64-pc-linux-gnu-library/3.5")
> An irrecoverable exception occurred. R is aborting now ...
> Segmentation fault (core dumped)
> ERROR: loading failed
> * removing ?/home/ecor/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
> 
> The downloaded source packages are in
> ?/tmp/Rtmpq9SibK/downloaded_packages?
> Warning message:
> In install.packages("rgdal") :
>   installation of package ?rgdal? had non-zero exit status
>> sessionInfo()
> R version 3.5.1 (2018-07-02)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 16.04.5 LTS
> 
> Matrix products: default
> BLAS: /usr/lib/libblas/libblas.so.3.6.0
> LAPACK: /usr/lib/lapack/liblapack.so.3.6.0
> 
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_IE.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_IE.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_IE.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_IE.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_3.5.1 tools_3.5.1
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181117/02ea5a64/attachment.bin>

From yud @ending from m@il@montcl@ir@edu  Sat Nov 17 20:59:38 2018
From: yud @ending from m@il@montcl@ir@edu (Danlin Yu)
Date: Sat, 17 Nov 2018 14:59:38 -0500
Subject: [R-sig-Geo] logLik value of the spml spatial panel model
In-Reply-To: <A86EFA63-858D-450B-AB91-DCA733111FC3@mac.com>
References: <92164cd4-6b69-2011-c727-344e1a0dffb9@mail.montclair.edu>
 <87ftwvkur2.fsf@gmail.com>
 <35561a02-d828-5dee-2419-3675984b160a@mail.montclair.edu>
 <87y3amy4sh.fsf@gmail.com>
 <alpine.LFD.2.21.1810251020210.10346@reclus.nhh.no>
 <87d0ryxtyh.fsf@gmail.com>
 <DB36B6DC36CFD746A374F62BE5B5C5BD06C29E0F@D3MBXSRVTV3.corp.generali.net>
 <6f478054-474b-52a7-6a83-2a3df5eb7566@mail.montclair.edu>
 <DB36B6DC36CFD746A374F62BE5B5C5BD06C29EE8@D3MBXSRVTV3.corp.generali.net>
 <A86EFA63-858D-450B-AB91-DCA733111FC3@mac.com>
Message-ID: <7cf8d3b5-0d18-dafc-6f15-035dd9487f20@mail.montclair.edu>

Dear Dr. Piras: This is great. Thank you very much for the response.

Best,

Danlin


On 2018/11/14 16:32, Gianfranco Piras wrote:
> Sorry for the very slow reply. I was  looking back at the email exchange and this problem sounded familiar.
>
> I have had another user contacting me because he was experiencing the same issue with the pooled model. He also compared the value of the likelihood from R with the value that he was obtaining with codes in Matlab (in the spatial econometrics toolbox).  Anyway, Roger was right when he said that the log-likelihood  from the "fix? was calculated omitting constants. I fixed this specific problem a long time ago, but since the email that was sent to me by the other user had several  other questions (which I didn?t had time to address),  I never committed the new version on R-forge.
>
> Anyway, here is a script and the updated package. I will try to get to the other questions asap and finally upload to CRAN.
>
> Sorry  for any inconvenience related to my delay!
>
> Best,
> G.
>
>
>
>
>      
>
>
>
>> On Oct 25, 2018, at 10:56 AM, Millo Giovanni <giovanni.millo at generali.com> wrote:
>>
>> Correct. It should not be used for comparing FE to anything else. In particular, comparisons between FE and RE specifications have to concentrate on the treatment of the individual effects.
>>
>> Best, Giovanni
>>
>> -----Messaggio originale-----
>> Da: Danlin Yu [mailto:yud at mail.montclair.edu]
>> Inviato: gioved? 25 ottobre 2018 16:54
>> A: Millo Giovanni; Jeremie Juste; Roger Bivand
>> Cc: r-sig-geo at r-project.org; Gianfranco Piras
>> Oggetto: Re: R: [R-sig-Geo] logLik value of the spml spatial panel model
>>
>> This is great response. Thank you all, Giovanni, Roger and Jeremie.
>> Based on the response, it seems that the LL element for fixed effect
>> model is only useful for optimization, but not cross model comparison?
>> The fixed effect spatial lag panel model, however, does produce the LL
>> value. Does that mean this LL value shall not be used for model
>> comparison purpose as well?
>>
>> Thank you all.
>>
>> Best,
>>
>> Danlin
>>
>>
>> On 2018/10/25 8:46, Millo Giovanni wrote:
>>> Hello. Thanks for keeping us posted.
>>>
>>> As was aptly observed, while RE and pooled models do actually have a logLik element, FE ones don't but there's a reason. While it is not difficult to output the  LL for the FE models too, like Jeremie did (or perhaps even setting quiet=FALSE and taking the last loglikelihood value from optimization), we never managed to decide whether outputting this is appropriate or not. In fact the LL element from the procedure is relative to the "pooled" model on demeaned data, so it is sort of a crossbred likelihood; most people asking for it want it to compare to the LL of the random effects model or similar uses, which I would not advise.
>>>
>>> Gianfranco (author of the FE stuff) do please step in if appropriate.
>>> Best,
>>> Giovanni
>>>
>>> -----Messaggio originale-----
>>> Da: Jeremie Juste [mailto:jeremiejuste at gmail.com]
>>> Inviato: gioved? 25 ottobre 2018 11:21
>>> A: Roger Bivand
>>> Cc: Danlin Yu; r-sig-geo at r-project.org; Millo Giovanni; Gianfranco Piras
>>> Oggetto: Re: [R-sig-Geo] logLik value of the spml spatial panel model
>>>
>>>
>>> Hello,
>>>
>>> Thanks for the feedback.
>>>
>>> Here is the diff. It is my first one so I'm not sure I'm doing everything right. :-)
>>>
>>>
>>> modified   R/likelihoodsFE.R
>>> @@ -459,7 +459,7 @@ if(Hess) asyv <- NULL  else asyv <- asyv
>>>
>>>
>>> -       return<-list(coeff=betas, rho = rho, s2 = s2, rest.se = rest.se, rho.se = rho.se, s2.se = s2.se, asyvar1=asyvar1, residuals = r, asyv = asyv)
>>> +    return<-list(coeff=betas, rho = rho, s2 = s2, rest.se = rest.se,
>>> + rho.se = rho.se, s2.se = s2.se, ll=LL, asyvar1=asyvar1, residuals = r,
>>> + asyv = asyv)
>>>   }
>>>
>>> I have compressed splm with the modification with the .git inside. I have installed the modified package again and checked that the modification worked.
>>>
>>>> fespaterr <- spml(fm, data = Produc, listw = mat2listw(usaww),
>>>> model="within", spatial.error="b", Hess = FALSE) fespaterr$logLik
>>>> It may be,however, that there was a reason for omitting it, so checks
>>>> to verify that it actually is a logLik value on the same basis as
>>>> other logLik values (not from an abbreviated log-likelihood function
>>>> used for fitting by omitting constants) would be helpful. It would be
>>>> good to provide logLik methods for the ML fitted model objects.
>>> I have checked that it is the logLik that correspond to the estimation of the rho.
>>>
>>> Best regards,
>>>
>>> Jeremie
>>>
>>>
>>>
>>>
>>> Ai sensi del Reg. UE 2016/679 e normativa vigente si precisa che le informazioni contenute in questo messaggio sono riservate ed a uso esclusivo del destinatario. Qualora il messaggio in parola Le fosse pervenuto per errore, La invitiamo ad eliminarlo senza copiarlo e a non inoltrarlo a terzi, dandocene gentilmente comunicazione. Grazie.
>>>
>>> Pursuant to Italian Law and EU Reg. 2016/679, you are hereby informed that this message contains confidential information intended only for the use of the addressee. If you are not the addressee, and have received this message by mistake, please delete it and immediately notify us. You may not copy or disseminate this message to anyone. Thank you.
>> -- 
>> ___________________________________________
>> Danlin Yu, Ph.D.
>> Professor of GIS and Urban Geography
>> Department of Earth & Environmental Studies
>> Montclair State University
>> Montclair, NJ, 07043
>> Tel: 973-655-4313
>> Fax: 973-655-4072
>> Office: CELS 314
>> Email: yud at mail.montclair.edu
>> webpage: csam.montclair.edu/~yu
>>

-- 
___________________________________________
Danlin Yu, Ph.D.
Professor of GIS and Urban Geography
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
Office: CELS 314
Email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu


	[[alternative HTML version deleted]]


From @lex@ndre@@nto@br @ending from y@hoo@com@br  Sun Nov 18 14:10:06 2018
From: @lex@ndre@@nto@br @ending from y@hoo@com@br (ASANTOS)
Date: Sun, 18 Nov 2018 10:10:06 -0300
Subject: [R-sig-Geo] Pixel calculation using extract() in geoTiff raster:
 faster and free of computer lock in R
Message-ID: <5bc12a4b-1199-932f-1c47-c4078b815b67@yahoo.com.br>

Dear R-sig-geo Members,

 ??? I've like to use R and raster package (extract() function) for 
pixel calculations (SD, Skewness and Kurtosis in 1? unit radius of a 
buffer) in a geoTiff raster, but my original geoTiff image has 
6244(nrow), 8721(ncol) and 54453924 (ncell) dimensions. This image size 
causes slow computation process or computer lock, for example in my code 
below:

### <code r>
#Packages
library(raster)
library(moments) #Measures of Skewness and Kurtosis

## Create artificial raster for my geoTiff simulation - dimensions? of 
my original geoTiff: 6244, 8721, 54453924? (nrow, ncol, ncell)
r <- raster(nc=8721, nr=6244)
r <- setValues(r, round(runif(ncell(r))* 255))

#Extract all pixel coordinates in raster
coord_r<-coordinates(r)

#Extract standard deviation, skewness and kurtosis
Buffer<-1
SD<-function (x, na.rm = TRUE)
{
if (is.matrix(x))
 ??? apply(x, 2, sd, na.rm = na.rm)
else if (is.vector(x))
 ??? sqrt(var(x, na.rm = na.rm))
else if (is.data.frame(x))
 ??? sapply(x, sd, na.rm = na.rm)
else sqrt(var(as.vector(x), na.rm = na.rm))
}
desv_pad_R<-extract(r, coord_r, buffer = Buffer, fun = SD)
str(desv_pad_R)
sk_R <-extract(r,coord_r,buffer=Buffer, fun=skewness, na.rm = TRUE)
str(sk_R)
k_R <-extract(r,coord_r,buffer=Buffer, fun=kurtosis, na.rm = TRUE)
str(k_R)
# <END code>

 ??? There are different approaches (eg. integration with SAGA GIS or 
GRASS, convert image to ASCII) for my problem?

Thanks in advanced,

Alexandre

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 99686-6970 (VIVO) (+55) 65 3221-2674 (FIXO)

         alexandre.santos at cas.ifmt.edu.br
Lattes: http://lattes.cnpq.br/1360403201088680
OrcID: orcid.org/0000-0001-8232-6722
Researchgate: www.researchgate.net/profile/Alexandre_Santos10
LinkedIn: br.linkedin.com/in/alexandre-dos-santos-87961635
Mendeley:www.mendeley.com/profiles/alexandre-dos-santos6/


From hugo@gco@t@ @ending from gm@il@com  Sun Nov 18 17:02:39 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Sun, 18 Nov 2018 17:02:39 +0100
Subject: [R-sig-Geo] 
 Pixel calculation using extract() in geoTiff raster:
 faster and free of computer lock in R
In-Reply-To: <5bc12a4b-1199-932f-1c47-c4078b815b67@yahoo.com.br>
References: <5bc12a4b-1199-932f-1c47-c4078b815b67@yahoo.com.br>
Message-ID: <CADvFi5pCUNvVzFoCsNMJ4vwVMUga4s5ns=4eivDspm-E=Q82+A@mail.gmail.com>

Hi Alexandre,

it seems to me this is a job for function 'focal' rather then 'extract'.
Even if so, I'm not sure about the speed it would take.

Cheers
Hugo

ASANTOS via R-sig-Geo <r-sig-geo at r-project.org> escreveu no dia domingo,
18/11/2018 ?(s) 14:10:

> Dear R-sig-geo Members,
>
>      I've like to use R and raster package (extract() function) for
> pixel calculations (SD, Skewness and Kurtosis in 1  unit radius of a
> buffer) in a geoTiff raster, but my original geoTiff image has
> 6244(nrow), 8721(ncol) and 54453924 (ncell) dimensions. This image size
> causes slow computation process or computer lock, for example in my code
> below:
>
> ### <code r>
> #Packages
> library(raster)
> library(moments) #Measures of Skewness and Kurtosis
>
> ## Create artificial raster for my geoTiff simulation - dimensions  of
> my original geoTiff: 6244, 8721, 54453924  (nrow, ncol, ncell)
> r <- raster(nc=8721, nr=6244)
> r <- setValues(r, round(runif(ncell(r))* 255))
>
> #Extract all pixel coordinates in raster
> coord_r<-coordinates(r)
>
> #Extract standard deviation, skewness and kurtosis
> Buffer<-1
> SD<-function (x, na.rm = TRUE)
> {
> if (is.matrix(x))
>      apply(x, 2, sd, na.rm = na.rm)
> else if (is.vector(x))
>      sqrt(var(x, na.rm = na.rm))
> else if (is.data.frame(x))
>      sapply(x, sd, na.rm = na.rm)
> else sqrt(var(as.vector(x), na.rm = na.rm))
> }
> desv_pad_R<-extract(r, coord_r, buffer = Buffer, fun = SD)
> str(desv_pad_R)
> sk_R <-extract(r,coord_r,buffer=Buffer, fun=skewness, na.rm = TRUE)
> str(sk_R)
> k_R <-extract(r,coord_r,buffer=Buffer, fun=kurtosis, na.rm = TRUE)
> str(k_R)
> # <END code>
>
>      There are different approaches (eg. integration with SAGA GIS or
> GRASS, convert image to ASCII) for my problem?
>
> Thanks in advanced,
>
> Alexandre
>
> --
> ======================================================================
> Alexandre dos Santos
> Prote??o Florestal
> IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
> Campus C?ceres
> Caixa Postal 244
> Avenida dos Ramires, s/n
> Bairro: Distrito Industrial
> C?ceres - MT                      CEP: 78.200-000
> Fone: (+55) 65 99686-6970 (VIVO) (+55) 65 3221-2674 (FIXO)
>
>          alexandre.santos at cas.ifmt.edu.br
> Lattes: http://lattes.cnpq.br/1360403201088680
> OrcID: orcid.org/0000-0001-8232-6722
> Researchgate: www.researchgate.net/profile/Alexandre_Santos10
> LinkedIn: br.linkedin.com/in/alexandre-dos-santos-87961635
> Mendeley:www.mendeley.com/profiles/alexandre-dos-santos6/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From j@ck@onmrodrigue@ @ending from gm@il@com  Mon Nov 19 12:32:06 2018
From: j@ck@onmrodrigue@ @ending from gm@il@com (Jackson Rodrigues)
Date: Mon, 19 Nov 2018 09:32:06 -0200
Subject: [R-sig-Geo] set up months to a time serie
Message-ID: <CAPL76w9OxkXKB5+V9bGrSLsShBE6Qj+iXQZ10QEPxcrdtaFr3g@mail.gmail.com>

Dear all,

I am trying to set a sequence of  48000 months to a simulation between
10200 - 6201  before present.

However I always get the following message
Error in charToDate(TS) : #character string is not in a standard
unambiguous format
Could anyone help me?
####
library(zoo)
TS1<-brick("TS1.nc")
# dimensions  : 12, 12, 144, 48000  (nrow, ncol, ncell, nlayers)
TS1 <- as.yearmon(10200 - seq(0, 48000)/12)

####

Moreover, I would like to detect changes inside my rasterbrick serie, I
read that package bfast can detect changes in such of time series and
files, anyone experienced with bfast could help me with it as well?

thank you all,

Best

Jackson

	[[alternative HTML version deleted]]


From rjrich@rd1984 @ending from gm@il@com  Mon Nov 19 16:34:41 2018
From: rjrich@rd1984 @ending from gm@il@com (Richard)
Date: Mon, 19 Nov 2018 10:34:41 -0500
Subject: [R-sig-Geo] Dealing with non-nested geographic units using the
 RQGIS and tigris R packages
Message-ID: <CADeu1H8LVG5MTsA5FUXgj4UMsG4pWykkA1KerFaHuF2XjhYntQ@mail.gmail.com>

I recently came across this tutorial suggesting that the RQGIS and tigris R
packages could be used to overcome issues with non-nested geographies:

https://rpubs.com/corey_sparks/256942

I'm trying to apply this to some data I have where I would like to look at
Census Block Groups nested within Zip Code Tabulation Areas. Specifically,
I'd like to compute a segregation index using Census Block Groups as the
lower units and Zip Code Tabulation Areas as the higher level units.

I am confused about how these R packages deal with this issue of non-nested
units. Here's the explanation from the tutorial:

"In order to get around this problem [non-nested units], we can use the
QGIS application to perform a geographic intersection between two spatial
polygon layers that we want to use. This will allow us to merge the
population data at the census tract level to a higher level, so we can
calculate a segregation index."

Can anyone say more about how this is possible? I can run the code in the
tutorial but I don't understand what it's doing.

Thanks!

	[[alternative HTML version deleted]]


From genovev@@gonz@lez-mireli@ @ending from hi@no  Tue Nov 20 10:22:38 2018
From: genovev@@gonz@lez-mireli@ @ending from hi@no (Gonzalez-Mirelis, Genoveva)
Date: Tue, 20 Nov 2018 09:22:38 +0000
Subject: [R-sig-Geo] Unable to use factors in raster::predict
In-Reply-To: <038cddaa5f5e4cd69b4f1931e3fc8457@hi.no>
References: <72bb1e34802d468babf7372d1f138c11@hi.no>
 <038cddaa5f5e4cd69b4f1931e3fc8457@hi.no>
Message-ID: <46412b3d4c4e48d996323abf9bb84094@hi.no>

Dear list,

I would like to use the 'predict' function in the 'raster' package in an implementation of species distribution modelling with a couple of factor variables. My case can be set up exactly as the cforest example listed in the help file. Unfortunately, I cannot get the example to work: it throws an error because of the unused argument 'factors', which I need. Here is the code I am referring to:

# create a RasterStack or RasterBrick with with a set of predictor layers
logo <- brick(system.file("external/rlogo.grd", package="raster"))
names(logo)

# known presence and absence points
p <- matrix(c(48, 48, 48, 53, 50, 46, 54, 70, 84, 85, 74, 84, 95, 85,
              66, 42, 26, 4, 19, 17, 7, 14, 26, 29, 39, 45, 51, 56, 46, 38, 31,
              22, 34, 60, 70, 73, 63, 46, 43, 28), ncol=2)

a <- matrix(c(22, 33, 64, 85, 92, 94, 59, 27, 30, 64, 60, 33, 31, 9,
              99, 67, 15, 5, 4, 30, 8, 37, 42, 27, 19, 69, 60, 73, 3, 5, 21,
              37, 52, 70, 74, 9, 13, 4, 17, 47), ncol=2)

# extract values for points
xy <- rbind(cbind(1, p), cbind(0, a))
v <- data.frame(cbind(pa=xy[,1], extract(logo, xy[,2:3])))

# cforest (other Random Forest implementation) example with factors argument

v$red <- as.factor(round(v$red/100))
logo$red <- round(logo[[1]]/100)

library(party)
m <- cforest(pa~., control=cforest_unbiased(mtry=3), data=v)
f <- list(levels(v$red))
names(f) <- 'red'
pc <- predict( m,logo, OOB=TRUE, factors=f)

Error in RET at prediction_weights(newdata = newdata, mincriterion = mincriterion,  :
  unused argument (factors = f)


Note that I needed to change the order in the arguments in the last line. If I run it the way it was in the example, like this:

pc <- predict(logo, m, OOB=TRUE, factors=f)


then the error is the following:


Error in v[cells, ] <- predv :

  number of items to replace is not a multiple of replacement length

Also note that if I run the line without the 'factors' argument the resulting value (r) is a matrix, and not a raster object.

I am using Package 'raster' version 2.6-7 on Windows 7 (where this worked fine in the past).

Many thanks for any help,

Genoveva

Genoveva Gonzalez Mirelis, Scientist
Institute of Marine Research
Nordnesgaten 50
5005 Bergen, Norway
Phone number +47 55238510


	[[alternative HTML version deleted]]


From l@r@@@fp@@ilv@ @ending from gm@il@com  Tue Nov 20 16:09:09 2018
From: l@r@@@fp@@ilv@ @ending from gm@il@com (Lara Silva)
Date: Tue, 20 Nov 2018 14:09:09 -0100
Subject: [R-sig-Geo] Doubt: add a boderline map
Message-ID: <CALN9TERi67z0QwEzJwF5VhWBHmaFZHRcW=PM5FXPHQBRsQ8anQ@mail.gmail.com>

Hello,

I got a map through the plot function.

Code:

map <-plot(proj$A_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)

However I needed to add a border line in my study area to become more
perceptible (Figure 1).

I tried the border(), rect () functions  but it gave error.

So, I tried to create a border line

Code:
nc.sids <- readShapePoly("PoligonoSM.shp")

plot(nc.sids, asp=1, main="")

nc.border <- unionSpatialPolygons(nc.sids, rep(1, nrow(nc.sids)))
plot(nc.border, asp=1, main="")


But I am having a lot of difficulties in building the script.

How can cross the information of the 2 plots?

https://www.dropbox.com/sh/y5by1sxjcvdl6rh/AAAIF4srkChW2FxeEfFG4d_ta?dl=0
Thanks.

	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Tue Nov 20 20:11:36 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Tue, 20 Nov 2018 20:11:36 +0100
Subject: [R-sig-Geo] Unable to use factors in raster::predict
In-Reply-To: <46412b3d4c4e48d996323abf9bb84094@hi.no>
References: <72bb1e34802d468babf7372d1f138c11@hi.no>
 <038cddaa5f5e4cd69b4f1931e3fc8457@hi.no>
 <46412b3d4c4e48d996323abf9bb84094@hi.no>
Message-ID: <CADvFi5pHqfs4+PTV65JHVUvgzyZqTmaQ_r007K8ZkXfOKiU-NQ@mail.gmail.com>

This is not of much help, but I run the code, and the line
pc <- predict(logo, m, OOB=TRUE, factors=f)
did work fine. I got a Rasterlayer, which is the R logo with pixels ranging
from 0 to 1.
Hugo

Gonzalez-Mirelis, Genoveva via R-sig-Geo <r-sig-geo at r-project.org> escreveu
no dia ter?a, 20/11/2018 ?(s) 10:23:

> Dear list,
>
> I would like to use the 'predict' function in the 'raster' package in an
> implementation of species distribution modelling with a couple of factor
> variables. My case can be set up exactly as the cforest example listed in
> the help file. Unfortunately, I cannot get the example to work: it throws
> an error because of the unused argument 'factors', which I need. Here is
> the code I am referring to:
>
> # create a RasterStack or RasterBrick with with a set of predictor layers
> logo <- brick(system.file("external/rlogo.grd", package="raster"))
> names(logo)
>
> # known presence and absence points
> p <- matrix(c(48, 48, 48, 53, 50, 46, 54, 70, 84, 85, 74, 84, 95, 85,
>               66, 42, 26, 4, 19, 17, 7, 14, 26, 29, 39, 45, 51, 56, 46,
> 38, 31,
>               22, 34, 60, 70, 73, 63, 46, 43, 28), ncol=2)
>
> a <- matrix(c(22, 33, 64, 85, 92, 94, 59, 27, 30, 64, 60, 33, 31, 9,
>               99, 67, 15, 5, 4, 30, 8, 37, 42, 27, 19, 69, 60, 73, 3, 5,
> 21,
>               37, 52, 70, 74, 9, 13, 4, 17, 47), ncol=2)
>
> # extract values for points
> xy <- rbind(cbind(1, p), cbind(0, a))
> v <- data.frame(cbind(pa=xy[,1], extract(logo, xy[,2:3])))
>
> # cforest (other Random Forest implementation) example with factors
> argument
>
> v$red <- as.factor(round(v$red/100))
> logo$red <- round(logo[[1]]/100)
>
> library(party)
> m <- cforest(pa~., control=cforest_unbiased(mtry=3), data=v)
> f <- list(levels(v$red))
> names(f) <- 'red'
> pc <- predict( m,logo, OOB=TRUE, factors=f)
>
> Error in RET at prediction_weights(newdata = newdata, mincriterion =
> mincriterion,  :
>   unused argument (factors = f)
>
>
> Note that I needed to change the order in the arguments in the last line.
> If I run it the way it was in the example, like this:
>
> pc <- predict(logo, m, OOB=TRUE, factors=f)
>
>
> then the error is the following:
>
>
> Error in v[cells, ] <- predv :
>
>   number of items to replace is not a multiple of replacement length
>
> Also note that if I run the line without the 'factors' argument the
> resulting value (r) is a matrix, and not a raster object.
>
> I am using Package 'raster' version 2.6-7 on Windows 7 (where this worked
> fine in the past).
>
> Many thanks for any help,
>
> Genoveva
>
> Genoveva Gonzalez Mirelis, Scientist
> Institute of Marine Research
> Nordnesgaten 50
> 5005 Bergen, Norway
> Phone number +47 55238510
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Tue Nov 20 20:15:47 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Tue, 20 Nov 2018 20:15:47 +0100
Subject: [R-sig-Geo] Doubt: add a boderline map
In-Reply-To: <CALN9TERi67z0QwEzJwF5VhWBHmaFZHRcW=PM5FXPHQBRsQ8anQ@mail.gmail.com>
References: <CALN9TERi67z0QwEzJwF5VhWBHmaFZHRcW=PM5FXPHQBRsQ8anQ@mail.gmail.com>
Message-ID: <CADvFi5pYBK9rwL4GpmYu+azD7E0UsgZjyWcfq9wABZodfJHkYw@mail.gmail.com>

Hi Lara,

have you tried to run the following?

map <-plot(proj$A_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)

plot(nc.sids, asp=1, main="", add=TRUE)

Hugo

Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia ter?a, 20/11/2018
?(s) 16:04:

> Hello,
>
> I got a map through the plot function.
>
> Code:
>
> map <-plot(proj$A_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)
>
> However I needed to add a border line in my study area to become more
> perceptible (Figure 1).
>
> I tried the border(), rect () functions  but it gave error.
>
> So, I tried to create a border line
>
> Code:
> nc.sids <- readShapePoly("PoligonoSM.shp")
>
> plot(nc.sids, asp=1, main="")
>
> nc.border <- unionSpatialPolygons(nc.sids, rep(1, nrow(nc.sids)))
> plot(nc.border, asp=1, main="")
>
>
> But I am having a lot of difficulties in building the script.
>
> How can cross the information of the 2 plots?
>
> https://www.dropbox.com/sh/y5by1sxjcvdl6rh/AAAIF4srkChW2FxeEfFG4d_ta?dl=0
> Thanks.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Jorge@C@no @ending from l@htm@@c@uk  Wed Nov 21 13:57:08 2018
From: Jorge@C@no @ending from l@htm@@c@uk (Jorge Cano)
Date: Wed, 21 Nov 2018 12:57:08 +0000
Subject: [R-sig-Geo] job position on geostatistics at the London School of
 Hygiene & Tropical Medicine
Message-ID: <DB7PR10MB2443E1683C9358856710CF19D0DA0@DB7PR10MB2443.EURPRD10.PROD.OUTLOOK.COM>

Dear community,

We are looking for a geostatistician interested in spatial modelling of infectious diseases to join our group (London Applied and Spatial Epidemiology Research group) at the London School of Hygiene & Tropical Medicine. More details in the link below. Also, further information in our research projects in these links: www.thiswormyworld.org<http://www.thiswormyworld.org/> / http://laser.lshtm.ac.uk/

__________________________________________________________________________

Assistant Professor in Spatial Statistics and Epidemiology
Dept of Disease Control, LSHTM
Salary: ?45,878 to ?52,520 per annum, inclusive.
Closing Date:  Wednesday 05 December 2018

The successful applicant will be conducting research on the epidemiology and control of neglected tropical diseases (NTDs) in sub-Saharan Africa. This research is a component of the Expanded Special Project for the Elimination of NTDs within the Africa Region of the WHO. The post-holder will be responsible for leading the development and implementation of appropriate statistical methods to quantify the spatial distribution of NTDs.
Job Description and application: https://jobs.lshtm.ac.uk/vacancy.aspx?ref=ITD-DCD-2018-24


Thanks,

________________________________________________________
Jorge Cano | Assistant Professor | Department of Disease Control
London Applied & Spatial Epidemiology Research Group (LASER)
www.thiswormyworld.org<http://www.thiswormyworld.org/> / http://laser.lshtm.ac.uk/
T: +44 (0) 20 7927 2584



	[[alternative HTML version deleted]]


From l@r@@@fp@@ilv@ @ending from gm@il@com  Wed Nov 21 17:46:44 2018
From: l@r@@@fp@@ilv@ @ending from gm@il@com (Lara Silva)
Date: Wed, 21 Nov 2018 15:46:44 -0100
Subject: [R-sig-Geo] Doubt: add a boderline map
In-Reply-To: <CADvFi5pYBK9rwL4GpmYu+azD7E0UsgZjyWcfq9wABZodfJHkYw@mail.gmail.com>
References: <CALN9TERi67z0QwEzJwF5VhWBHmaFZHRcW=PM5FXPHQBRsQ8anQ@mail.gmail.com>
 <CADvFi5pYBK9rwL4GpmYu+azD7E0UsgZjyWcfq9wABZodfJHkYw@mail.gmail.com>
Message-ID: <CALN9TETV92=iS_3DxP0Er8c970rOkQpng+s7FP-u2eZL_=HnhQ@mail.gmail.com>

Yes, it worked.

Thank you very much!

Lara

Hugo Costa <hugoagcosta at gmail.com> escreveu no dia ter?a, 20/11/2018 ?(s)
18:15:

> Hi Lara,
>
> have you tried to run the following?
>
> map <-plot(proj$A_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)
>
> plot(nc.sids, asp=1, main="", add=TRUE)
>
> Hugo
>
> Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia ter?a, 20/11/2018
> ?(s) 16:04:
>
>> Hello,
>>
>> I got a map through the plot function.
>>
>> Code:
>>
>> map <-plot(proj$A_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
>> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)
>>
>> However I needed to add a border line in my study area to become more
>> perceptible (Figure 1).
>>
>> I tried the border(), rect () functions  but it gave error.
>>
>> So, I tried to create a border line
>>
>> Code:
>> nc.sids <- readShapePoly("PoligonoSM.shp")
>>
>> plot(nc.sids, asp=1, main="")
>>
>> nc.border <- unionSpatialPolygons(nc.sids, rep(1, nrow(nc.sids)))
>> plot(nc.border, asp=1, main="")
>>
>>
>> But I am having a lot of difficulties in building the script.
>>
>> How can cross the information of the 2 plots?
>>
>> https://www.dropbox.com/sh/y5by1sxjcvdl6rh/AAAIF4srkChW2FxeEfFG4d_ta?dl=0
>> Thanks.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From j@imebg27 @ending from gm@il@com  Fri Nov 23 04:42:12 2018
From: j@imebg27 @ending from gm@il@com (=?UTF-8?Q?Jaime_Burbano_Gir=C3=B3n?=)
Date: Thu, 22 Nov 2018 22:42:12 -0500
Subject: [R-sig-Geo] Problem with initGRASS
Message-ID: <CADiqS84Ud=FSqYVtmOz_-FRjRsUz4C6C5UkxKWGRfXt4WWhRQQ@mail.gmail.com>

Hi everyone,

I'm trying to use GRASS in R, but I can't get to initialize it. I'm using
Ubuntu 18.04 and GRASS 7.4.2. This is the system information:

Versi?n de GRASS: 7.4.2

Revisi?n SVN de GRASS: exported

Fecha de compilaci?n: 2018-10-28

Construir plataforma: x86_64-pc-linux-gnu

GDAL: 2.2.3

PROJ.4: 4.9.3

GEOS: 3.6.2

SQLite: 3.22.0

Python: 2.7.15rc1

wxPython: 3.0.2.0

Plataforma: Linux-4.15.0-38-generic-x86_64-with-Ubuntu-18.04-bionic


I'm running: > initGRASS(gisBase="/usr/lib/grass74/bin",override=T)
And this is the error:

sh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv:
not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1:
g.version: not foundError in system(paste("g.version", get("addEXE",
envir = .GRASS_CACHE),  :
  error in running commandAdem?s: Warning messages:1: In
system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
 error in running command2: In system(paste(paste("g.gisenv",
get("addEXE", envir = .GRASS_CACHE),  :  error in running command3: In
system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
 error in running command4: In system(paste(paste("g.gisenv",
get("addEXE", envir = .GRASS_CACHE),  :  error in running command5: In
system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
 error in running command


I verified that g.gisenv and g.version are located in /usr/lib/grass74/bin.
Any suggestion?

Thanks in advance.

Best,

Jaime.
-- 
Jaime Burbano Gir?n
Estudiante Doctoral
Doctorado en Estudios Ambientales y Rurales
Pontificia Universidad Javeriana
Bogot?, Colombia
(57-1) 3208320 Ext. 4844

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Fri Nov 23 09:44:28 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Fri, 23 Nov 2018 09:44:28 +0100
Subject: [R-sig-Geo] Problem with initGRASS
In-Reply-To: <CADiqS84Ud=FSqYVtmOz_-FRjRsUz4C6C5UkxKWGRfXt4WWhRQQ@mail.gmail.com>
References: <CADiqS84Ud=FSqYVtmOz_-FRjRsUz4C6C5UkxKWGRfXt4WWhRQQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1811230904190.11570@reclus.nhh.no>

On Fri, 23 Nov 2018, Jaime Burbano Gir?n wrote:

> Hi everyone,
>
> I'm trying to use GRASS in R, but I can't get to initialize it. I'm using
> Ubuntu 18.04 and GRASS 7.4.2. This is the system information:
>
> Versi?n de GRASS: 7.4.2
>
> Revisi?n SVN de GRASS: exported
>
> Fecha de compilaci?n: 2018-10-28
>
> Construir plataforma: x86_64-pc-linux-gnu
>
> GDAL: 2.2.3
>
> PROJ.4: 4.9.3
>
> GEOS: 3.6.2
>
> SQLite: 3.22.0
>
> Python: 2.7.15rc1
>
> wxPython: 3.0.2.0
>
> Plataforma: Linux-4.15.0-38-generic-x86_64-with-Ubuntu-18.04-bionic
>
>
> I'm running: > initGRASS(gisBase="/usr/lib/grass74/bin",override=T)
> And this is the error:

No, ?initGRASS says:

gisBase: The directory path to GRASS binaries and libraries

and grass74/bin only contains (for me):

$ ls bin
grass74

which is a Python script, ASCII text executable. Trying

grass74/grass-7.4.2

(no idea where your installer puts this):

$ ls grass-7.4.2
AUTHORS           contributors_extra.csv  fonts    REQUIREMENTS.html
bin               COPYING                 GPL.TXT  scripts
CHANGES           demolocation            gui      share
CITING            docs                    include  tools
config.status     driver                  INSTALL  translators.csv
contributors.csv  etc                     lib

which contains the binaries in bin and the libraries in lib. The required 
string is what is set in the shell variable GISBASE when running GRASS 
interactively:

echo $GISBASE

hence the name of the argument. initGRASS() cannot discover this as GRASS 
is not running, and has not set its environment variables. I have added a 
test looking for a directory called bin in the directory given as the 
gisBase argument, check on https://r-forge.r-project.org/R/?group_id=2020 
to see when rgrass7 0.1-13 (Rev: 68) has build status current, try that 
with your current setting, the correct setting and report back.

Hope this clarifies,

Roger


>
> sh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv:
> not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1:
> g.version: not foundError in system(paste("g.version", get("addEXE",
> envir = .GRASS_CACHE),  :
>  error in running commandAdem?s: Warning messages:1: In
> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
> error in running command2: In system(paste(paste("g.gisenv",
> get("addEXE", envir = .GRASS_CACHE),  :  error in running command3: In
> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
> error in running command4: In system(paste(paste("g.gisenv",
> get("addEXE", envir = .GRASS_CACHE),  :  error in running command5: In
> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),  :
> error in running command
>
>
> I verified that g.gisenv and g.version are located in /usr/lib/grass74/bin.
> Any suggestion?
>
> Thanks in advance.
>
> Best,
>
> Jaime.
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From reudenb@ch @ending from uni-m@rburg@de  Fri Nov 23 09:52:56 2018
From: reudenb@ch @ending from uni-m@rburg@de (Chris Reudenbach)
Date: Fri, 23 Nov 2018 09:52:56 +0100
Subject: [R-sig-Geo] Problem with initGRASS
In-Reply-To: <alpine.LFD.2.21.1811230904190.11570@reclus.nhh.no>
References: <CADiqS84Ud=FSqYVtmOz_-FRjRsUz4C6C5UkxKWGRfXt4WWhRQQ@mail.gmail.com>
 <alpine.LFD.2.21.1811230904190.11570@reclus.nhh.no>
Message-ID: <65dab3f2-43db-eb48-dc08-ad9b8eb4ecce@uni-marburg.de>

Jaime,

if the location of your GRASS installation is not known you may also 
give the link2GI package a try.

try link2GI::linkGRASS7() for a "brute force" searching and linking. 
This should setup your enviroment for using the newest GRASS version.

cheers Chris

On 23/11/2018 09:44, Roger Bivand wrote:
> On Fri, 23 Nov 2018, Jaime Burbano Gir?n wrote:
>
>> Hi everyone,
>>
>> I'm trying to use GRASS in R, but I can't get to initialize it. I'm 
>> using
>> Ubuntu 18.04 and GRASS 7.4.2. This is the system information:
>>
>> Versi?n de GRASS: 7.4.2
>>
>> Revisi?n SVN de GRASS: exported
>>
>> Fecha de compilaci?n: 2018-10-28
>>
>> Construir plataforma: x86_64-pc-linux-gnu
>>
>> GDAL: 2.2.3
>>
>> PROJ.4: 4.9.3
>>
>> GEOS: 3.6.2
>>
>> SQLite: 3.22.0
>>
>> Python: 2.7.15rc1
>>
>> wxPython: 3.0.2.0
>>
>> Plataforma: Linux-4.15.0-38-generic-x86_64-with-Ubuntu-18.04-bionic
>>
>>
>> I'm running: > initGRASS(gisBase="/usr/lib/grass74/bin",override=T)
>> And this is the error:
>
> No, ?initGRASS says:
>
> gisBase: The directory path to GRASS binaries and libraries
>
> and grass74/bin only contains (for me):
>
> $ ls bin
> grass74
>
> which is a Python script, ASCII text executable. Trying
>
> grass74/grass-7.4.2
>
> (no idea where your installer puts this):
>
> $ ls grass-7.4.2
> AUTHORS?????????? contributors_extra.csv? fonts REQUIREMENTS.html
> bin?????????????? COPYING???????????????? GPL.TXT? scripts
> CHANGES?????????? demolocation??????????? gui????? share
> CITING??????????? docs??????????????????? include? tools
> config.status???? driver????????????????? INSTALL? translators.csv
> contributors.csv? etc???????????????????? lib
>
> which contains the binaries in bin and the libraries in lib. The 
> required string is what is set in the shell variable GISBASE when 
> running GRASS interactively:
>
> echo $GISBASE
>
> hence the name of the argument. initGRASS() cannot discover this as 
> GRASS is not running, and has not set its environment variables. I 
> have added a test looking for a directory called bin in the directory 
> given as the gisBase argument, check on 
> https://r-forge.r-project.org/R/?group_id=2020 to see when rgrass7 
> 0.1-13 (Rev: 68) has build status current, try that with your current 
> setting, the correct setting and report back.
>
> Hope this clarifies,
>
> Roger
>
>
>>
>> sh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv:
>> not foundsh: 1: g.gisenv: not foundsh: 1: g.gisenv: not foundsh: 1:
>> g.version: not foundError in system(paste("g.version", get("addEXE",
>> envir = .GRASS_CACHE),? :
>> ?error in running commandAdem?s: Warning messages:1: In
>> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),? :
>> error in running command2: In system(paste(paste("g.gisenv",
>> get("addEXE", envir = .GRASS_CACHE),? :? error in running command3: In
>> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),? :
>> error in running command4: In system(paste(paste("g.gisenv",
>> get("addEXE", envir = .GRASS_CACHE),? :? error in running command5: In
>> system(paste(paste("g.gisenv", get("addEXE", envir = .GRASS_CACHE),? :
>> error in running command
>>
>>
>> I verified that g.gisenv and g.version are located in 
>> /usr/lib/grass74/bin.
>> Any suggestion?
>>
>> Thanks in advance.
>>
>> Best,
>>
>> Jaime.
>>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr Christoph Reudenbach, Philipps-University of Marburg, Faculty of Geography, GIS and Environmental Modeling, Deutschhausstr. 10, D-35032 Marburg, fon: ++49.(0)6421.2824296, fax: ++49.(0)6421.2828950, web: gis-ma.org, giswerk.org, moc.environmentalinformatics-marburg.de


	[[alternative HTML version deleted]]


From l@r@@@fp@@ilv@ @ending from gm@il@com  Fri Nov 23 14:36:02 2018
From: l@r@@@fp@@ilv@ @ending from gm@il@com (Lara Silva)
Date: Fri, 23 Nov 2018 12:36:02 -0100
Subject: [R-sig-Geo] How to change axis (plot map)?
Message-ID: <CALN9TEROBaO08kFkvpjkw=FrMur4OTrwBjJ7qYz33pzSGfNaFA@mail.gmail.com>

Hello,

 I am trying to change the scale/number of x-axis and y-axis (map plot -
Figure 1).

https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0
For example:

x-axis: 465000,480000, 500000 (min. med. max values)
The same idea for y-axis ....

Code:

plot(proj22PA$OB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)


plot(proj22PA$PittOB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
main= "", xlab ="x.coords", ylab="y.coords",
cex.axis=caxis,xlim=c(465000,500000,480000), ylim=c(4270000,4300000))

Do not change ... The map has shifted. Probably, I need a new function or
modified the argumente for link the information.


Another hypothesis

plot(proj22PA$Pittosporum_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis,
xaxt="n",yaxt="n")

axis(1, seq(450000,480000,500000)) - x.axis
axis(2, seq(4270000,425000,4300000)) - y.axis

Output - Figure 2. I can not add the "numbers".

https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0

Is it possible change the scale of legend (200, 400, 600, 800)?

Any suggestion for my doubts/problems?

Thanks,

Silva

	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Fri Nov 23 22:27:25 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Fri, 23 Nov 2018 22:27:25 +0100
Subject: [R-sig-Geo] How to change axis (plot map)?
In-Reply-To: <CALN9TEROBaO08kFkvpjkw=FrMur4OTrwBjJ7qYz33pzSGfNaFA@mail.gmail.com>
References: <CALN9TEROBaO08kFkvpjkw=FrMur4OTrwBjJ7qYz33pzSGfNaFA@mail.gmail.com>
Message-ID: <CADvFi5o2VfcimbUt2B4rhJyt15Z99A2+y9hmfV2Wcxxhuu=kwQ@mail.gmail.com>

Probably you're looking for arguments xaxp and yaxp, used like this:
plot(1:100,xaxp=c(0,100,4), yaxp=c(0,100,2))

Please look for more info in the help. Also, if you intend to make maps,
possibly you should spend some time getting familiar with packages, such as
ggplot2 or tmap.

Cheers
Hugo


Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia sexta, 23/11/2018
?(s) 14:31:

> Hello,
>
>  I am trying to change the scale/number of x-axis and y-axis (map plot -
> Figure 1).
>
> https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0
> For example:
>
> x-axis: 465000,480000, 500000 (min. med. max values)
> The same idea for y-axis ....
>
> Code:
>
> plot(proj22PA$OB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)
>
>
> plot(proj22PA$PittOB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
> main= "", xlab ="x.coords", ylab="y.coords",
> cex.axis=caxis,xlim=c(465000,500000,480000), ylim=c(4270000,4300000))
>
> Do not change ... The map has shifted. Probably, I need a new function or
> modified the argumente for link the information.
>
>
> Another hypothesis
>
> plot(proj22PA$Pittosporum_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis,
> xaxt="n",yaxt="n")
>
> axis(1, seq(450000,480000,500000)) - x.axis
> axis(2, seq(4270000,425000,4300000)) - y.axis
>
> Output - Figure 2. I can not add the "numbers".
>
> https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0
>
> Is it possible change the scale of legend (200, 400, 600, 800)?
>
> Any suggestion for my doubts/problems?
>
> Thanks,
>
> Silva
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Fri Nov 23 23:13:20 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Fri, 23 Nov 2018 23:13:20 +0100
Subject: [R-sig-Geo] How to sum area of adjacent patches?
Message-ID: <CADvFi5p_scWchr7ZZuYcQ4k0kFEh+0UGwuPhPxBmKsuT596k8A@mail.gmail.com>

Deal all,

I'm merging several rasters representing patches of forest, and the pixel
values represent the area of the patches. The patches' area should be
summed along the edges of the merged rasters. I provide a reproducible
example. Any help is welcome.
Hugo

library(raster)
r1<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=0, ymx=1)
r2<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=1, ymx=2)
r1[]<-c(rep(24,24), rep(0,76))
r2[]<-c(rep(0,86), rep(14,14))
par(mfrow=c(2,2)); plot(r1,main="r1"); plot(r2,main="r2")


r3<-merge(r1,r2) ; plot(r3, main="merged rasters")

# do something

r3[r3>0]<-38     ; plot(r3, main="desired result")

	[[alternative HTML version deleted]]


From btupper @ending from bigelow@org  Fri Nov 23 23:58:53 2018
From: btupper @ending from bigelow@org (Ben Tupper)
Date: Fri, 23 Nov 2018 17:58:53 -0500
Subject: [R-sig-Geo] How to sum area of adjacent patches?
In-Reply-To: <CADvFi5p_scWchr7ZZuYcQ4k0kFEh+0UGwuPhPxBmKsuT596k8A@mail.gmail.com>
References: <CADvFi5p_scWchr7ZZuYcQ4k0kFEh+0UGwuPhPxBmKsuT596k8A@mail.gmail.com>
Message-ID: <6791E406-F4B1-4767-941C-24F6365432D6@bigelow.org>

Hi,

I think you may need to use raster::clump() and table() to label your regions.  Check out an old message about clump...

https://stat.ethz.ch/pipermail/r-sig-geo/2017-January/025346.html

It's sort of cumbersome, but I think the following works...


library(raster)
r1<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=0, ymx=1)
r2<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=1, ymx=2)
r1[]<-c(rep(24,24), rep(0,76))
r2[]<-c(rep(0,86), rep(14,14))
par(mfrow=c(3,2)); plot(r1,main="r1"); plot(r2,main="r2")


r3<-merge(r1,r2) ; plot(r3, main="merged rasters")

r3 <- r3
r4[r4>0]<-38     ; plot(r4, main="desired result")

r5 <- clump(r3) ; plot(r5, main = 'clumped')
r5[is.na(r5)] <- 0

r5t <- table(getValues(r5))
for (i in names(r5t)[-1]){
	id <- as.numeric(i)
	print(id)
	r5[r5 == id] <- r5t[i]
}

plot(r5, main = 'relabeled with area')


Cheers,
Ben

P.S. Years ago I used a language called IDL.  It's histogram function has an output keyword called reverse_indices (more here https://www.harrisgeospatial.com/docs/HISTOGRAM.html#H_835179117_677188 and here http://www.idlcoyote.com/tips/histogram_tutorial.html )  - super useful!  Your situation just begs for that same solution in R.





> On Nov 23, 2018, at 5:13 PM, Hugo Costa <hugoagcosta at gmail.com> wrote:
> 
> Deal all,
> 
> I'm merging several rasters representing patches of forest, and the pixel
> values represent the area of the patches. The patches' area should be
> summed along the edges of the merged rasters. I provide a reproducible
> example. Any help is welcome.
> Hugo
> 
> library(raster)
> r1<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=0, ymx=1)
> r2<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=1, ymx=2)
> r1[]<-c(rep(24,24), rep(0,76))
> r2[]<-c(rep(0,86), rep(14,14))
> par(mfrow=c(2,2)); plot(r1,main="r1"); plot(r2,main="r2")
> 
> 
> r3<-merge(r1,r2) ; plot(r3, main="merged rasters")
> 
> # do something
> 
> r3[r3>0]<-38     ; plot(r3, main="desired result")
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/


From hugo@gco@t@ @ending from gm@il@com  Sat Nov 24 00:48:24 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Sat, 24 Nov 2018 00:48:24 +0100
Subject: [R-sig-Geo] How to sum area of adjacent patches?
In-Reply-To: <6791E406-F4B1-4767-941C-24F6365432D6@bigelow.org>
References: <CADvFi5p_scWchr7ZZuYcQ4k0kFEh+0UGwuPhPxBmKsuT596k8A@mail.gmail.com>
 <6791E406-F4B1-4767-941C-24F6365432D6@bigelow.org>
Message-ID: <CADvFi5qg5vEhjy5DU2=kc2f_Ba901P5T1C87BQCV_KhHD+hpOQ@mail.gmail.com>

Hi Ben,
thank you for your help. Clump is a possibility, however I was looking for
something different. In my real data, 9 rasters have to be merged (1
central raster and the 8 surrounding rasters), and running clump after
merging 9 rasters is slow and memory consuming. And this has to be repeated
thousands of times (hopefully in parallel with the rasters in memory). I
didn't explain these details to make the message short.
I'll continue searching for more alternatives, and all ideas are welcome.
Thanks
Hugo

Ben Tupper <btupper at bigelow.org> escreveu no dia sexta, 23/11/2018 ?(s)
23:58:

> Hi,
>
> I think you may need to use raster::clump() and table() to label your
> regions.  Check out an old message about clump...
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2017-January/025346.html
>
> It's sort of cumbersome, but I think the following works...
>
>
> library(raster)
> r1<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=0, ymx=1)
> r2<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=1, ymx=2)
> r1[]<-c(rep(24,24), rep(0,76))
> r2[]<-c(rep(0,86), rep(14,14))
> par(mfrow=c(3,2)); plot(r1,main="r1"); plot(r2,main="r2")
>
>
> r3<-merge(r1,r2) ; plot(r3, main="merged rasters")
>
> r3 <- r3
> r4[r4>0]<-38     ; plot(r4, main="desired result")
>
> r5 <- clump(r3) ; plot(r5, main = 'clumped')
> r5[is.na(r5)] <- 0
>
> r5t <- table(getValues(r5))
> for (i in names(r5t)[-1]){
>         id <- as.numeric(i)
>         print(id)
>         r5[r5 == id] <- r5t[i]
> }
>
> plot(r5, main = 'relabeled with area')
>
>
> Cheers,
> Ben
>
> P.S. Years ago I used a language called IDL.  It's histogram function has
> an output keyword called reverse_indices (more here
> https://www.harrisgeospatial.com/docs/HISTOGRAM.html#H_835179117_677188
> and here http://www.idlcoyote.com/tips/histogram_tutorial.html )  - super
> useful!  Your situation just begs for that same solution in R.
>
>
>
>
>
> > On Nov 23, 2018, at 5:13 PM, Hugo Costa <hugoagcosta at gmail.com> wrote:
> >
> > Deal all,
> >
> > I'm merging several rasters representing patches of forest, and the pixel
> > values represent the area of the patches. The patches' area should be
> > summed along the edges of the merged rasters. I provide a reproducible
> > example. Any help is welcome.
> > Hugo
> >
> > library(raster)
> > r1<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=0, ymx=1)
> > r2<-raster(nrows=10, ncols=10, xmn=0, xmx=1, ymn=1, ymx=2)
> > r1[]<-c(rep(24,24), rep(0,76))
> > r2[]<-c(rep(0,86), rep(14,14))
> > par(mfrow=c(2,2)); plot(r1,main="r1"); plot(r2,main="r2")
> >
> >
> > r3<-merge(r1,r2) ; plot(r3, main="merged rasters")
> >
> > # do something
> >
> > r3[r3>0]<-38     ; plot(r3, main="desired result")
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From l@r@@@fp@@ilv@ @ending from gm@il@com  Sat Nov 24 18:50:25 2018
From: l@r@@@fp@@ilv@ @ending from gm@il@com (Lara Silva)
Date: Sat, 24 Nov 2018 16:50:25 -0100
Subject: [R-sig-Geo] How to change axis (plot map)?
In-Reply-To: <CADvFi5o2VfcimbUt2B4rhJyt15Z99A2+y9hmfV2Wcxxhuu=kwQ@mail.gmail.com>
References: <CALN9TEROBaO08kFkvpjkw=FrMur4OTrwBjJ7qYz33pzSGfNaFA@mail.gmail.com>
 <CADvFi5o2VfcimbUt2B4rhJyt15Z99A2+y9hmfV2Wcxxhuu=kwQ@mail.gmail.com>
Message-ID: <CALN9TESGpMVmpEsqbQxSH9adBL4CKXw5OO3=Sf7sC6CoVMb3YQ@mail.gmail.com>

Hi Hugo,
thank you for your help and advices.

Regards,

Silva

Hugo Costa <hugoagcosta at gmail.com> escreveu no dia sexta, 23/11/2018 ?(s)
20:27:

> Probably you're looking for arguments xaxp and yaxp, used like this:
> plot(1:100,xaxp=c(0,100,4), yaxp=c(0,100,2))
>
> Please look for more info in the help. Also, if you intend to make maps,
> possibly you should spend some time getting familiar with packages, such as
> ggplot2 or tmap.
>
> Cheers
> Hugo
>
>
> Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia sexta, 23/11/2018
> ?(s) 14:31:
>
>> Hello,
>>
>>  I am trying to change the scale/number of x-axis and y-axis (map plot -
>> Figure 1).
>>
>> https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0
>> For example:
>>
>> x-axis: 465000,480000, 500000 (min. med. max values)
>> The same idea for y-axis ....
>>
>> Code:
>>
>> plot(proj22PA$OB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
>> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis)
>>
>>
>> plot(proj22PA$PittOB_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
>> main= "", xlab ="x.coords", ylab="y.coords",
>> cex.axis=caxis,xlim=c(465000,500000,480000), ylim=c(4270000,4300000))
>>
>> Do not change ... The map has shifted. Probably, I need a new function or
>> modified the argumente for link the information.
>>
>>
>> Another hypothesis
>>
>> plot(proj22PA$Pittosporum_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
>> main= "", xlab ="x.coords", ylab="y.coords", cex.axis=caxis,
>> xaxt="n",yaxt="n")
>>
>> axis(1, seq(450000,480000,500000)) - x.axis
>> axis(2, seq(4270000,425000,4300000)) - y.axis
>>
>> Output - Figure 2. I can not add the "numbers".
>>
>> https://www.dropbox.com/sh/34nddj3405q3a6p/AACe-_23Wx7bZRETYIOYjsiQa?dl=0
>>
>> Is it possible change the scale of legend (200, 400, 600, 800)?
>>
>> Any suggestion for my doubts/problems?
>>
>> Thanks,
>>
>> Silva
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From l@r@@@fp@@ilv@ @ending from gm@il@com  Thu Nov 29 17:47:22 2018
From: l@r@@@fp@@ilv@ @ending from gm@il@com (Lara Silva)
Date: Thu, 29 Nov 2018 15:47:22 -0100
Subject: [R-sig-Geo] How to manipulatechange the space between the numbers
 of axes (equal interval)? How to add a legend to a map (plot raster)?
Message-ID: <CALN9TER3W-4HCiNYzPGvpCNRJW7tUJ9W_b--vSL60xJLHTYkeg@mail.gmail.com>

Hello,
 I?m trying to plot a map in R. Is it possible to change the values of
x.axis and y.axis and have the same interval (space between the numbers)?
 How to add a legend for the map?

https://www.dropbox.com/s/60tavy6vez33mw3/Plot_map.tiff?dl=0

> class(proj22PA$P_EMmeanByROC_mergedAlgo_mergedRun_mergedData)
[1] "RasterLayer"
attr(,"package")
[1] "raster"
>
> proj22PA$P_EMmeanByROC_mergedAlgo_mergedRun_mergedData
class       : RasterLayer
band        : 2  (of  2  bands)
dimensions  : 277, 412, 114124  (nrow, ncol, ncell)
resolution  : 100, 100  (x, y)
extent      : 461214, 502414, 4272892, 4300592  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : grid
names       : P_EMmeanByROC_mergedAlgo_mergedRun_mergedData
values      : 42, 924  (min, max)

>

Code:

plot(proj22PA$P_EMmeanByROC_mergedAlgo_mergedRun_mergedData,
axes=FALSE,legend=FALSE,box=FALSE,par(mar=c(3,3,0.5,0.5),mgp=c(2,1,0)))
axis(side = 1, at =c(470000,480000,500000),labels= c("470000", "480000",
"500000"))
axis(side = 2, at =c(4272892,4300592),labels= c("4272892", "4300592"))
box()

Regards,

Silva

	[[alternative HTML version deleted]]


From webbe @ending from ufl@edu  Thu Nov 29 18:53:19 2018
From: webbe @ending from ufl@edu (Elizabeth Webb)
Date: Thu, 29 Nov 2018 17:53:19 +0000
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
Message-ID: <1543514000035.79466@ufl.edu>

I am using GLASS albedo data stored here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for post-2000 data (MODIS). My end goal is to create a raster stack of each month that contains white sky albedo data from 1982-2015. The problem I have run into is that the MODIS and AVHRR data are in different spatial reference systems and I can't seem to reproject them to be in the same system.

I convert from hdf to tif using R like this:

fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
        ".../modis.tif")
gdal_translate(get_subdatasets(fileavhrr)[8], projwin = c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like data north of 50 degrees

avhrr<- raster(".../avhrr.tif")

#class       : RasterLayer
#dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
#resolution  : 0.05, 0.05  (x, y)
#extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

modis<- raster(".../modis.tif")

#class       : RasterLayer
#dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
#resolution  : 154.4376, 308.8751  (x, y)
#extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
    +b=6371007.181 +units=m +no_defs
#values      : -32768, 32767  (min, max)

Here are things I have tried:

1.) Use the MODIS Reprojection Tool<https://lpdaac.usgs.gov/tools/modis_reprojection_tool>. For whatever reason, this tool seems to think the subdatasets of the MODIS .hdf files are only one tile (the upper left most tile, tile 0,0) and not the global dataset. My understanding is that the MODIS data are global (not in tiles?), so I do not know why the MRT is doing this.


2.) Use the raster package in R.

projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")

This returns a raster with values that are all NA:

class       : RasterLayer
dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
resolution  : 0.05, 0.05  (x, y)
extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
values      : NA, NA  (min, max)

3.) Use the gdalUtils package in R:

gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile= ".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )

This returns a raster with essentially no spatial extent.

gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
#class       : RasterLayer
#dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
#resolution  : 0.02801551, 0.02801573  (x, y)
#extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

Any ideas on why reprojecting this MODIS data is so difficult?


	[[alternative HTML version deleted]]


From md@umner @ending from gm@il@com  Thu Nov 29 20:38:21 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 30 Nov 2018 06:38:21 +1100
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <1543514000035.79466@ufl.edu>
References: <1543514000035.79466@ufl.edu>
Message-ID: <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>

Fwiw there shouldn't be any need to convert from hdf to tif - could you
please try this?

x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")

If that works it at least removes some steps from your process.

Cheers, Mike.

On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:

> I am using GLASS albedo data stored here<
> ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
> and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
> post-2000 data (MODIS). My end goal is to create a raster stack of each
> month that contains white sky albedo data from 1982-2015. The problem I
> have run into is that the MODIS and AVHRR data are in different spatial
> reference systems and I can't seem to reproject them to be in the same
> system.
>
> I convert from hdf to tif using R like this:
>
> fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
> filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
> gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
>         ".../modis.tif")
> gdal_translate(get_subdatasets(fileavhrr)[8], projwin = c(-180,90,180,50),
> dst_dataset = ".../avhrr.tif") #ideally I'd only like data north of 50
> degrees
>
> avhrr<- raster(".../avhrr.tif")
>
> #class       : RasterLayer
> #dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
> #resolution  : 0.05, 0.05  (x, y)
> #extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
> #values      : -32768, 32767  (min, max)
>
> modis<- raster(".../modis.tif")
>
> #class       : RasterLayer
> #dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
> #resolution  : 154.4376, 308.8751  (x, y)
> #extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
> ymax)
> #coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
>     +b=6371007.181 +units=m +no_defs
> #values      : -32768, 32767  (min, max)
>
> Here are things I have tried:
>
> 1.) Use the MODIS Reprojection Tool<
> https://lpdaac.usgs.gov/tools/modis_reprojection_tool>. For whatever
> reason, this tool seems to think the subdatasets of the MODIS .hdf files
> are only one tile (the upper left most tile, tile 0,0) and not the global
> dataset. My understanding is that the MODIS data are global (not in
> tiles?), so I do not know why the MRT is doing this.
>
>
> 2.) Use the raster package in R.
>
> projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")
>
> This returns a raster with values that are all NA:
>
> class       : RasterLayer
> dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
> resolution  : 0.05, 0.05  (x, y)
> extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
> values      : NA, NA  (min, max)
>
> 3.) Use the gdalUtils package in R:
>
> gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
> ".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )
>
> This returns a raster with essentially no spatial extent.
>
> gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
> #class       : RasterLayer
> #dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
> #resolution  : 0.02801551, 0.02801573  (x, y)
> #extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
> #values      : -32768, 32767  (min, max)
>
> Any ideas on why reprojecting this MODIS data is so difficult?
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From md@umner @ending from gm@il@com  Thu Nov 29 20:39:32 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 30 Nov 2018 06:39:32 +1100
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
References: <1543514000035.79466@ufl.edu>
 <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
Message-ID: <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>

Ah, never mind - it's the subdataset discovery that's probably not easy
with rgdal.
Sorry for the noise.

Mike.

On Fri, 30 Nov 2018 at 06:38 Michael Sumner <mdsumner at gmail.com> wrote:

> Fwiw there shouldn't be any need to convert from hdf to tif - could you
> please try this?
>
> x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")
>
> If that works it at least removes some steps from your process.
>
> Cheers, Mike.
>
> On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:
>
>> I am using GLASS albedo data stored here<
>> ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
>> and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
>> post-2000 data (MODIS). My end goal is to create a raster stack of each
>> month that contains white sky albedo data from 1982-2015. The problem I
>> have run into is that the MODIS and AVHRR data are in different spatial
>> reference systems and I can't seem to reproject them to be in the same
>> system.
>>
>> I convert from hdf to tif using R like this:
>>
>> fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
>> filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
>> gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
>>         ".../modis.tif")
>> gdal_translate(get_subdatasets(fileavhrr)[8], projwin =
>> c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like
>> data north of 50 degrees
>>
>> avhrr<- raster(".../avhrr.tif")
>>
>> #class       : RasterLayer
>> #dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
>> #resolution  : 0.05, 0.05  (x, y)
>> #extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>> #values      : -32768, 32767  (min, max)
>>
>> modis<- raster(".../modis.tif")
>>
>> #class       : RasterLayer
>> #dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
>> #resolution  : 154.4376, 308.8751  (x, y)
>> #extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
>> ymax)
>> #coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
>>     +b=6371007.181 +units=m +no_defs
>> #values      : -32768, 32767  (min, max)
>>
>> Here are things I have tried:
>>
>> 1.) Use the MODIS Reprojection Tool<
>> https://lpdaac.usgs.gov/tools/modis_reprojection_tool>. For whatever
>> reason, this tool seems to think the subdatasets of the MODIS .hdf files
>> are only one tile (the upper left most tile, tile 0,0) and not the global
>> dataset. My understanding is that the MODIS data are global (not in
>> tiles?), so I do not know why the MRT is doing this.
>>
>>
>> 2.) Use the raster package in R.
>>
>> projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")
>>
>> This returns a raster with values that are all NA:
>>
>> class       : RasterLayer
>> dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
>> resolution  : 0.05, 0.05  (x, y)
>> extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>> values      : NA, NA  (min, max)
>>
>> 3.) Use the gdalUtils package in R:
>>
>> gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
>> ".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )
>>
>> This returns a raster with essentially no spatial extent.
>>
>> gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
>> #class       : RasterLayer
>> #dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
>> #resolution  : 0.02801551, 0.02801573  (x, y)
>> #extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>> #values      : -32768, 32767  (min, max)
>>
>> Any ideas on why reprojecting this MODIS data is so difficult?
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From tech_dev @ending from wildintellect@com  Thu Nov 29 21:08:41 2018
From: tech_dev @ending from wildintellect@com (Alex M)
Date: Thu, 29 Nov 2018 12:08:41 -0800
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
References: <1543514000035.79466@ufl.edu>
 <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
 <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
Message-ID: <fdb2d397-60ce-df20-45bc-e1146043e6f1@wildintellect.com>

gdalUtils has a get_subdatasets() which is really helpful here, it's
just a gdalinfo with grep.

Here's what my code looks like for reprojecting, what I found is that
even if the hdf has the proj definition, gdal tools don't seem to use it
right, so I specify the proj string as the s_srs or a_srs.

.modis_warp <- function(output, t_srs="EPSG:4326", ...){
  # Multiple sources say this is the proj definition of the MODIS Sinusoidal
  MODIS_SRS <- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs"

  CO <- c("COMPRESS=DEFLATE","PREDICTOR=2","ZLEVEL=9")

  catcher <- tryCatch(
    gdalwarp(output[1]
             , output[2]
             , s_srs=MODIS_SRS
             , t_srs=t_srs
             , of="GTiff"
             #, srcnodata
             #, dstnodata
             , "-multi"
             #, paste0("-wo NUM_THREADS=",ncpu)#Multithread computatation
             , CO
             , output)
  )

  return(catcher)
}

Sure you could transform the raster in "memory" but that will probably
right a temp grd file to the system anyways, might as well just convert
it to a multi-band tiff for ease of use.

Thanks,
Alex

On 11/29/18 11:39, Michael Sumner wrote:
> Ah, never mind - it's the subdataset discovery that's probably not easy
> with rgdal.
> Sorry for the noise.
> 
> Mike.
> 
> On Fri, 30 Nov 2018 at 06:38 Michael Sumner <mdsumner at gmail.com> wrote:
> 
>> Fwiw there shouldn't be any need to convert from hdf to tif - could you
>> please try this?
>>
>> x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")
>>
>> If that works it at least removes some steps from your process.
>>
>> Cheers, Mike.
>>
>> On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:
>>
>>> I am using GLASS albedo data stored here<
>>> ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
>>> and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
>>> post-2000 data (MODIS). My end goal is to create a raster stack of each
>>> month that contains white sky albedo data from 1982-2015. The problem I
>>> have run into is that the MODIS and AVHRR data are in different spatial
>>> reference systems and I can't seem to reproject them to be in the same
>>> system.
>>>
>>> I convert from hdf to tif using R like this:
>>>
>>> fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
>>> filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
>>> gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
>>>         ".../modis.tif")
>>> gdal_translate(get_subdatasets(fileavhrr)[8], projwin =
>>> c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like
>>> data north of 50 degrees
>>>
>>> avhrr<- raster(".../avhrr.tif")
>>>
>>> #class       : RasterLayer
>>> #dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
>>> #resolution  : 0.05, 0.05  (x, y)
>>> #extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> modis<- raster(".../modis.tif")
>>>
>>> #class       : RasterLayer
>>> #dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
>>> #resolution  : 154.4376, 308.8751  (x, y)
>>> #extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
>>> ymax)
>>> #coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
>>>     +b=6371007.181 +units=m +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> Here are things I have tried:
>>>
>>> 1.) Use the MODIS Reprojection Tool<
>>> https://lpdaac.usgs.gov/tools/modis_reprojection_tool>. For whatever
>>> reason, this tool seems to think the subdatasets of the MODIS .hdf files
>>> are only one tile (the upper left most tile, tile 0,0) and not the global
>>> dataset. My understanding is that the MODIS data are global (not in
>>> tiles?), so I do not know why the MRT is doing this.
>>>
>>>
>>> 2.) Use the raster package in R.
>>>
>>> projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")
>>>
>>> This returns a raster with values that are all NA:
>>>
>>> class       : RasterLayer
>>> dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
>>> resolution  : 0.05, 0.05  (x, y)
>>> extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
>>> coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> values      : NA, NA  (min, max)
>>>
>>> 3.) Use the gdalUtils package in R:
>>>
>>> gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
>>> ".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )
>>>
>>> This returns a raster with essentially no spatial extent.
>>>
>>> gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
>>> #class       : RasterLayer
>>> #dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
>>> #resolution  : 0.02801551, 0.02801573  (x, y)
>>> #extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> Any ideas on why reprojecting this MODIS data is so difficult?
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From md@umner @ending from gm@il@com  Thu Nov 29 21:16:41 2018
From: md@umner @ending from gm@il@com (Michael Sumner)
Date: Fri, 30 Nov 2018 07:16:41 +1100
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
References: <1543514000035.79466@ufl.edu>
 <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
 <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
Message-ID: <CAAcGz99z-yHcgNi_6quj_3eR0qZrVTMKjRrW7ckKGfBN48RKUg@mail.gmail.com>

To answer the "Any ideas on why reprojecting this MODIS data is so
difficult?" - it's that the sinusoidal projection is actually pretty
exotic, it matches the daily aggregation of L2 geophysical variables from
individual swaths (multiple per day) into L3 bins (aggregated daily, then
into longer time periods with bin identity maintained). I personally think
it's a bad choice for a regular gridded product, but it's a way of
"regularizing" the L3 bins, which are quite abstract and hard to use. The
L3 bins are a ragged array of bins at regular latitude intervals, a
diminishing number of bins as absolute latitude increases towards each
pole.  Described here:

https://oceancolor.gsfc.nasa.gov/docs/format/l3bins/

My answer to the "how to reproject the sinusoidal grid to regular longlat"
is - you should not do that. The sinusoidal grid is faithful to the
statistical properties of the L3 bins, though not to the bin geometries
themselves. One is meant to query the sinusoidal grid for the data needed,
it's really inappropriate to stretch those data out by resampling/
reprojection.  (I don't know if the sinusoidal-regular-grid creators have
written down this rationale).

Generally one can reproject vector points, polygons, lines into the
sinusoidal projection and use extractions in that coordinate system, and
that's what I'd recommend. (Using the L3 bins is also possible in R but
it's a long story about how to do that).

 Just a question: do you download the auxialiary .hdf.xml files that
accompany the .hdf files?   They perhaps contain extra information that
GDAL can interpret.

Using some inside knowledge, delve into subdatasets with stars/sf:

(sds <- sf::gdal_subdatasets("GLASS02B06.V04.A2013169.2017128.hdf"))

x <- stars::read_stars(sds[[1]])

x
stars object with 2 dimensions and 1 attribute
attribute(s), summary of first 1e+05 cells:
 HDF4_EOS:EOS_GRID:"GLASS02B06.V04.A2013169.2017128.hdf":GLASS02B06:ABD_BSA_VIS
 Min.   : NA

 1st Qu.: NA

 Median : NA

 Mean   :NaN

 3rd Qu.: NA

 Max.   : NA

 NA's   :1e+05

dimension(s):
  from   to    offset    delta                       refsys point values
x    1 7200 -20015109  154.438 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [x]
y    1 3600  10007555 -308.875 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [y]


plot(x)
sf::st_bbox(x)
     xmin      ymin      xmax      ymax
-20015109   8895604 -18903159  10007555

And OMG! To my disgust we see these data are not in sinusoidal projection
at all, but in Equidistant Cylindrical (the -20015109 is approximately the
distance from the prime meridian to the anti meridian along the equator
(i.e about pi * 6378137m).   So, I don't trust these in-situ metadata at
all.  I see this stuff gets messed up fairly frequently, perhaps it's a
GDAL problem interpreting the metadata from the file, or perhaps it's
actually mis-applied in the hdf - finding out requires careful examination
of the metadata, as does choice of datum (as follows).

Using stars to read and raster to "fix it" (raster just because I'm more
sure of my steps that way):

r <- setExtent(stars:::st_as_raster(x), extent(-180, 180, -90, 90))
projection(r) <- "+proj=longlat +datum=WGS84"
plot(r)
maps::map(add = T)
plot(extent(r), add = TRUE)

## convince yourself the extent is correct with things like:
abline(h = c(-90, 90), col = "red")

That use of "datum=WGS84" may well be incorrect, but compared to trying to
project data from a completely mis applied projection it's an improvement.

HTH

Cheers, Mike.




On Fri, 30 Nov 2018 at 06:39 Michael Sumner <mdsumner at gmail.com> wrote:

> Ah, never mind - it's the subdataset discovery that's probably not easy
> with rgdal.
> Sorry for the noise.
>
> Mike.
>
> On Fri, 30 Nov 2018 at 06:38 Michael Sumner <mdsumner at gmail.com> wrote:
>
>> Fwiw there shouldn't be any need to convert from hdf to tif - could you
>> please try this?
>>
>> x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")
>>
>> If that works it at least removes some steps from your process.
>>
>> Cheers, Mike.
>>
>> On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:
>>
>>> I am using GLASS albedo data stored here<
>>> ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
>>> and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
>>> post-2000 data (MODIS). My end goal is to create a raster stack of each
>>> month that contains white sky albedo data from 1982-2015. The problem I
>>> have run into is that the MODIS and AVHRR data are in different spatial
>>> reference systems and I can't seem to reproject them to be in the same
>>> system.
>>>
>>> I convert from hdf to tif using R like this:
>>>
>>> fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
>>> filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
>>> gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
>>>         ".../modis.tif")
>>> gdal_translate(get_subdatasets(fileavhrr)[8], projwin =
>>> c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like
>>> data north of 50 degrees
>>>
>>> avhrr<- raster(".../avhrr.tif")
>>>
>>> #class       : RasterLayer
>>> #dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
>>> #resolution  : 0.05, 0.05  (x, y)
>>> #extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> modis<- raster(".../modis.tif")
>>>
>>> #class       : RasterLayer
>>> #dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
>>> #resolution  : 154.4376, 308.8751  (x, y)
>>> #extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
>>> ymax)
>>> #coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
>>>     +b=6371007.181 +units=m +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> Here are things I have tried:
>>>
>>> 1.) Use the MODIS Reprojection Tool<
>>> https://lpdaac.usgs.gov/tools/modis_reprojection_tool>. For whatever
>>> reason, this tool seems to think the subdatasets of the MODIS .hdf files
>>> are only one tile (the upper left most tile, tile 0,0) and not the global
>>> dataset. My understanding is that the MODIS data are global (not in
>>> tiles?), so I do not know why the MRT is doing this.
>>>
>>>
>>> 2.) Use the raster package in R.
>>>
>>> projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")
>>>
>>> This returns a raster with values that are all NA:
>>>
>>> class       : RasterLayer
>>> dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
>>> resolution  : 0.05, 0.05  (x, y)
>>> extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
>>> coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> values      : NA, NA  (min, max)
>>>
>>> 3.) Use the gdalUtils package in R:
>>>
>>> gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
>>> ".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )
>>>
>>> This returns a raster with essentially no spatial extent.
>>>
>>> gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
>>> #class       : RasterLayer
>>> #dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
>>> #resolution  : 0.02801551, 0.02801573  (x, y)
>>> #extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
>>> #coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
>>> #values      : -32768, 32767  (min, max)
>>>
>>> Any ideas on why reprojecting this MODIS data is so difficult?
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From kkilp@trick @ending from r@m@@@mi@mi@edu  Thu Nov 29 21:40:04 2018
From: kkilp@trick @ending from r@m@@@mi@mi@edu (Kilpatrick, Katherine A)
Date: Thu, 29 Nov 2018 20:40:04 +0000
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <CAAcGz99z-yHcgNi_6quj_3eR0qZrVTMKjRrW7ckKGfBN48RKUg@mail.gmail.com>
References: <1543514000035.79466@ufl.edu>
 <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
 <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
 <CAAcGz99z-yHcgNi_6quj_3eR0qZrVTMKjRrW7ckKGfBN48RKUg@mail.gmail.com>
Message-ID: <2FB072F6-57F5-43A2-8A46-11011B49ED03@miami.edu>

FYI The link that Mike provided is for ocean color products the GLASS land products use a different grid?see this link.

https://modis-land.gsfc.nasa.gov/MODLAND_grid.html

K




On Nov 29, 2018, at 3:16 PM, Michael Sumner <mdsumner at gmail.com<mailto:mdsumner at gmail.com>> wrote:

To answer the "Any ideas on why reprojecting this MODIS data is so
difficult?" - it's that the sinusoidal projection is actually pretty
exotic, it matches the daily aggregation of L2 geophysical variables from
individual swaths (multiple per day) into L3 bins (aggregated daily, then
into longer time periods with bin identity maintained). I personally think
it's a bad choice for a regular gridded product, but it's a way of
"regularizing" the L3 bins, which are quite abstract and hard to use. The
L3 bins are a ragged array of bins at regular latitude intervals, a
diminishing number of bins as absolute latitude increases towards each
pole.  Described here:

https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Foceancolor.gsfc.nasa.gov%2Fdocs%2Fformat%2Fl3bins%2F&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=r4qRfvtrxz2uNp0QQtKoz0X3eAkOcPTrUqg4fUHv5GI%3D&amp;reserved=0

My answer to the "how to reproject the sinusoidal grid to regular longlat"
is - you should not do that. The sinusoidal grid is faithful to the
statistical properties of the L3 bins, though not to the bin geometries
themselves. One is meant to query the sinusoidal grid for the data needed,
it's really inappropriate to stretch those data out by resampling/
reprojection.  (I don't know if the sinusoidal-regular-grid creators have
written down this rationale).

Generally one can reproject vector points, polygons, lines into the
sinusoidal projection and use extractions in that coordinate system, and
that's what I'd recommend. (Using the L3 bins is also possible in R but
it's a long story about how to do that).

Just a question: do you download the auxialiary .hdf.xml files that
accompany the .hdf files?   They perhaps contain extra information that
GDAL can interpret.

Using some inside knowledge, delve into subdatasets with stars/sf:

(sds <- sf::gdal_subdatasets("GLASS02B06.V04.A2013169.2017128.hdf"))

x <- stars::read_stars(sds[[1]])

x
stars object with 2 dimensions and 1 attribute
attribute(s), summary of first 1e+05 cells:
HDF4_EOS:EOS_GRID:"GLASS02B06.V04.A2013169.2017128.hdf":GLASS02B06:ABD_BSA_VIS
Min.   : NA

1st Qu.: NA

Median : NA

Mean   :NaN

3rd Qu.: NA

Max.   : NA

NA's   :1e+05

dimension(s):
 from   to    offset    delta                       refsys point values
x    1 7200 -20015109  154.438 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [x]
y    1 3600  10007555 -308.875 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [y]


plot(x)
sf::st_bbox(x)
    xmin      ymin      xmax      ymax
-20015109   8895604 -18903159  10007555

And OMG! To my disgust we see these data are not in sinusoidal projection
at all, but in Equidistant Cylindrical (the -20015109 is approximately the
distance from the prime meridian to the anti meridian along the equator
(i.e about pi * 6378137m).   So, I don't trust these in-situ metadata at
all.  I see this stuff gets messed up fairly frequently, perhaps it's a
GDAL problem interpreting the metadata from the file, or perhaps it's
actually mis-applied in the hdf - finding out requires careful examination
of the metadata, as does choice of datum (as follows).

Using stars to read and raster to "fix it" (raster just because I'm more
sure of my steps that way):

r <- setExtent(stars:::st_as_raster(x), extent(-180, 180, -90, 90))
projection(r) <- "+proj=longlat +datum=WGS84"
plot(r)
maps::map(add = T)
plot(extent(r), add = TRUE)

## convince yourself the extent is correct with things like:
abline(h = c(-90, 90), col = "red")

That use of "datum=WGS84" may well be incorrect, but compared to trying to
project data from a completely mis applied projection it's an improvement.

HTH

Cheers, Mike.




On Fri, 30 Nov 2018 at 06:39 Michael Sumner <mdsumner at gmail.com> wrote:

Ah, never mind - it's the subdataset discovery that's probably not easy
with rgdal.
Sorry for the noise.

Mike.

On Fri, 30 Nov 2018 at 06:38 Michael Sumner <mdsumner at gmail.com> wrote:

Fwiw there shouldn't be any need to convert from hdf to tif - could you
please try this?

x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")

If that works it at least removes some steps from your process.

Cheers, Mike.

On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:

I am using GLASS albedo data stored here<
ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
post-2000 data (MODIS). My end goal is to create a raster stack of each
month that contains white sky albedo data from 1982-2015. The problem I
have run into is that the MODIS and AVHRR data are in different spatial
reference systems and I can't seem to reproject them to be in the same
system.

I convert from hdf to tif using R like this:

fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
       ".../modis.tif")
gdal_translate(get_subdatasets(fileavhrr)[8], projwin =
c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like
data north of 50 degrees

avhrr<- raster(".../avhrr.tif")

#class       : RasterLayer
#dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
#resolution  : 0.05, 0.05  (x, y)
#extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

modis<- raster(".../modis.tif")

#class       : RasterLayer
#dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
#resolution  : 154.4376, 308.8751  (x, y)
#extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
ymax)
#coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
   +b=6371007.181 +units=m +no_defs
#values      : -32768, 32767  (min, max)

Here are things I have tried:

1.) Use the MODIS Reprojection Tool<
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flpdaac.usgs.gov%2Ftools%2Fmodis_reprojection_tool&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=WnSIC3kBe%2Fc5%2FeqiAlJxVjhm2BPs9h1XC%2FiPFfp4JCg%3D&amp;reserved=0>. For whatever
reason, this tool seems to think the subdatasets of the MODIS .hdf files
are only one tile (the upper left most tile, tile 0,0) and not the global
dataset. My understanding is that the MODIS data are global (not in
tiles?), so I do not know why the MRT is doing this.


2.) Use the raster package in R.

projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")

This returns a raster with values that are all NA:

class       : RasterLayer
dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
resolution  : 0.05, 0.05  (x, y)
extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
values      : NA, NA  (min, max)

3.) Use the gdalUtils package in R:

gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )

This returns a raster with essentially no spatial extent.

gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
#class       : RasterLayer
#dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
#resolution  : 0.02801551, 0.02801573  (x, y)
#extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

Any ideas on why reprojecting this MODIS data is so difficult?


       [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=NLV%2FZLET%2FHxlxlsl93Laqra4z5A5bDdleHi198Uxh0I%3D&amp;reserved=0

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=NLV%2FZLET%2FHxlxlsl93Laqra4z5A5bDdleHi198Uxh0I%3D&amp;reserved=0


	[[alternative HTML version deleted]]


From webbe @ending from ufl@edu  Fri Nov 30 05:09:15 2018
From: webbe @ending from ufl@edu (Elizabeth Webb)
Date: Fri, 30 Nov 2018 04:09:15 +0000
Subject: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no
 spatial extent)
In-Reply-To: <2FB072F6-57F5-43A2-8A46-11011B49ED03@miami.edu>
References: <1543514000035.79466@ufl.edu>
 <CAAcGz98Xs35NBe3wmG=hPafSU6KshnsOxzmKUnRkY1aSTujs9Q@mail.gmail.com>
 <CAAcGz98Cq3+RJcTsmNYwTC9DwwP5YMZ3k-BaWJv5OmMo7fJgQA@mail.gmail.com>
 <CAAcGz99z-yHcgNi_6quj_3eR0qZrVTMKjRrW7ckKGfBN48RKUg@mail.gmail.com>,
 <2FB072F6-57F5-43A2-8A46-11011B49ED03@miami.edu>
Message-ID: <1543550955052.80190@ufl.edu>

Thank you Katherine and Mike.   You helped identify the major problem, which is that the metadata is incorrect.  The MODIS GLASS product is a climate modeling dataset and as such it is in cylindrical equidistant projection (the metadata incorrectly label it as the sinusoidal grid).  [I'm writing this just to clarify,  I certainly didn't understand this before your emails earlier today.]  The AVHRR data appear to be in the same projection (cylindrical equidistant).  The next step should just be to convert the MODIS units to lat/long.  However, the AVHRR data does not specify a datum per se (see below).


As a follow up, because I am new to this, when converting the MODIS units to lat/long, what should I use as a datum?  Or, given that both MODIS and AVHRR appear to be in the climate modeling grid format, can we assume their datums already match?


AVHRR Datum info:

GEOGCS[\"Unknown datum based upon the Clarke 1866 ellipsoid\","
 [6] "    DATUM[\"Not specified (based on Clarke 1866 spheroid)\","
 [7] "        SPHEROID[\"Clarke 1866\",6378206.4,294.9786982138982,"
 [8] "            AUTHORITY[\"EPSG\",\"7008\"]]],"
 [9] "    PRIMEM[\"Greenwich\",0],"
[10] "    UNIT[\"degree\",0.0174532925199433]]"
[11] "Origin = (-180.000000000000000,90.000000000000000)"
[12] "Pixel Size = (0.050000000000000,-0.050000000000000)"



*Note ESPG 7008<https://epsg.io/7008-ellipsoid> says the units are in meters.  Other options exist, such as ESPG 4008<https://epsg.io/4008>, unknown datum based on the Clarke 1866 elipsoid exist.


Thanks for the help so far and for any future help that might come my way.


Elizabeth

________________________________
From: Kilpatrick, Katherine A <kkilpatrick at rsmas.miami.edu>
Sent: Thursday, November 29, 2018 3:40 PM
To: Michael Sumner
Cc: Elizabeth Webb; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Reproject MODIS data using R (results in NAs or no spatial extent)

FYI The link that Mike provided is for ocean color products the GLASS land products use a different grid?see this link.

https://modis-land.gsfc.nasa.gov/MODLAND_grid.html<https://urldefense.proofpoint.com/v2/url?u=https-3A__modis-2Dland.gsfc.nasa.gov_MODLAND-5Fgrid.html&d=DwMGaQ&c=pZJPUDQ3SB9JplYbifm4nt2lEVG5pWx2KikqINpWlZM&r=KpmI6Vdu2He-hM565ejK5Q&m=6y9mIOW6mOGqZ8k_68J89wbwswkZx5iN0QPOMcOQCIw&s=nZLE2iJ2s4P03oznAf9jhIYLo8_O4nbdqj3YRCf4irs&e=>

K




On Nov 29, 2018, at 3:16 PM, Michael Sumner <mdsumner at gmail.com<mailto:mdsumner at gmail.com>> wrote:

To answer the "Any ideas on why reprojecting this MODIS data is so
difficult?" - it's that the sinusoidal projection is actually pretty
exotic, it matches the daily aggregation of L2 geophysical variables from
individual swaths (multiple per day) into L3 bins (aggregated daily, then
into longer time periods with bin identity maintained). I personally think
it's a bad choice for a regular gridded product, but it's a way of
"regularizing" the L3 bins, which are quite abstract and hard to use. The
L3 bins are a ragged array of bins at regular latitude intervals, a
diminishing number of bins as absolute latitude increases towards each
pole.  Described here:

https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Foceancolor.gsfc.nasa.gov%2Fdocs%2Fformat%2Fl3bins%2F&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=r4qRfvtrxz2uNp0QQtKoz0X3eAkOcPTrUqg4fUHv5GI%3D&amp;reserved=0<https://urldefense.proofpoint.com/v2/url?u=https-3A__na01.safelinks.protection.outlook.com_-3Furl-3Dhttps-253A-252F-252Foceancolor.gsfc.nasa.gov-252Fdocs-252Fformat-252Fl3bins-252F-26amp-3Bdata-3D02-257C01-257Ckkilpatrick-2540rsmas.miami.edu-257C08935d04ff104c1b75fd08d65637a4f5-257C2a144b72f23942d48c0e6f0f17c48e33-257C0-257C0-257C636791194328942432-26amp-3Bsdata-3Dr4qRfvtrxz2uNp0QQtKoz0X3eAkOcPTrUqg4fUHv5GI-253D-26amp-3Breserved-3D0&d=DwMGaQ&c=pZJPUDQ3SB9JplYbifm4nt2lEVG5pWx2KikqINpWlZM&r=KpmI6Vdu2He-hM565ejK5Q&m=6y9mIOW6mOGqZ8k_68J89wbwswkZx5iN0QPOMcOQCIw&s=j5HW0q-bCYjevZppbmv_FnjcMCcz3MDRIA3O7k3uGEM&e=>

My answer to the "how to reproject the sinusoidal grid to regular longlat"
is - you should not do that. The sinusoidal grid is faithful to the
statistical properties of the L3 bins, though not to the bin geometries
themselves. One is meant to query the sinusoidal grid for the data needed,
it's really inappropriate to stretch those data out by resampling/
reprojection.  (I don't know if the sinusoidal-regular-grid creators have
written down this rationale).

Generally one can reproject vector points, polygons, lines into the
sinusoidal projection and use extractions in that coordinate system, and
that's what I'd recommend. (Using the L3 bins is also possible in R but
it's a long story about how to do that).

Just a question: do you download the auxialiary .hdf.xml files that
accompany the .hdf files?   They perhaps contain extra information that
GDAL can interpret.

Using some inside knowledge, delve into subdatasets with stars/sf:

(sds <- sf::gdal_subdatasets("GLASS02B06.V04.A2013169.2017128.hdf"))

x <- stars::read_stars(sds[[1]])

x
stars object with 2 dimensions and 1 attribute
attribute(s), summary of first 1e+05 cells:
HDF4_EOS:EOS_GRID:"GLASS02B06.V04.A2013169.2017128.hdf":GLASS02B06:ABD_BSA_VIS
Min.   : NA

1st Qu.: NA

Median : NA

Mean   :NaN

3rd Qu.: NA

Max.   : NA

NA's   :1e+05

dimension(s):
 from   to    offset    delta                       refsys point values
x    1 7200 -20015109  154.438 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [x]
y    1 3600  10007555 -308.875 +proj=sinu +lon_0=0 +x_0=...    NA   NULL [y]


plot(x)
sf::st_bbox(x)
    xmin      ymin      xmax      ymax
-20015109   8895604 -18903159  10007555

And OMG! To my disgust we see these data are not in sinusoidal projection
at all, but in Equidistant Cylindrical (the -20015109 is approximately the
distance from the prime meridian to the anti meridian along the equator
(i.e about pi * 6378137m).   So, I don't trust these in-situ metadata at
all.  I see this stuff gets messed up fairly frequently, perhaps it's a
GDAL problem interpreting the metadata from the file, or perhaps it's
actually mis-applied in the hdf - finding out requires careful examination
of the metadata, as does choice of datum (as follows).

Using stars to read and raster to "fix it" (raster just because I'm more
sure of my steps that way):

r <- setExtent(stars:::st_as_raster(x), extent(-180, 180, -90, 90))
projection(r) <- "+proj=longlat +datum=WGS84"
plot(r)
maps::map(add = T)
plot(extent(r), add = TRUE)

## convince yourself the extent is correct with things like:
abline(h = c(-90, 90), col = "red")

That use of "datum=WGS84" may well be incorrect, but compared to trying to
project data from a completely mis applied projection it's an improvement.

HTH

Cheers, Mike.




On Fri, 30 Nov 2018 at 06:39 Michael Sumner <mdsumner at gmail.com> wrote:

Ah, never mind - it's the subdataset discovery that's probably not easy
with rgdal.
Sorry for the noise.

Mike.

On Fri, 30 Nov 2018 at 06:38 Michael Sumner <mdsumner at gmail.com> wrote:

Fwiw there shouldn't be any need to convert from hdf to tif - could you
please try this?

x <- readGDAL( ".../GLASS02B05.V04.A1990161.2018062.hdf")

If that works it at least removes some steps from your process.

Cheers, Mike.

On Fri, Nov 30, 2018, 05:03 Elizabeth Webb <webbe at ufl.edu> wrote:

I am using GLASS albedo data stored here<
ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/AVHRR/> for pre-2000 (AVHRR) data
and here<ftp://ftp.glcf.umd.edu/glcf/GLASS/ABD/MODIS/0.05D/> for
post-2000 data (MODIS). My end goal is to create a raster stack of each
month that contains white sky albedo data from 1982-2015. The problem I
have run into is that the MODIS and AVHRR data are in different spatial
reference systems and I can't seem to reproject them to be in the same
system.

I convert from hdf to tif using R like this:

fileavhrr <- ".../GLASS02B05.V04.A1990161.2018062.hdf"
filemodis<-".../GLASS02B06.V04.A2013169.2017128.hdf"
gdal_translate(get_subdatasets(filemodis)[10], dst_dataset =
       ".../modis.tif")
gdal_translate(get_subdatasets(fileavhrr)[8], projwin =
c(-180,90,180,50), dst_dataset = ".../avhrr.tif") #ideally I'd only like
data north of 50 degrees

avhrr<- raster(".../avhrr.tif")

#class       : RasterLayer
#dimensions  : 800, 7200, 5760000  (nrow, ncol, ncell)
#resolution  : 0.05, 0.05  (x, y)
#extent      : -180, 180, 50, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

modis<- raster(".../modis.tif")

#class       : RasterLayer
#dimensions  : 3600, 7200, 25920000  (nrow, ncol, ncell)
#resolution  : 154.4376, 308.8751  (x, y)
#extent   : -20015109, -18903159, 8895604, 10007555  (xmin, xmax, ymin,
ymax)
#coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
   +b=6371007.181 +units=m +no_defs
#values      : -32768, 32767  (min, max)

Here are things I have tried:

1.) Use the MODIS Reprojection Tool<
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flpdaac.usgs.gov%2Ftools%2Fmodis_reprojection_tool&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=WnSIC3kBe%2Fc5%2FeqiAlJxVjhm2BPs9h1XC%2FiPFfp4JCg%3D&amp;reserved=0>. For whatever
reason, this tool seems to think the subdatasets of the MODIS .hdf files
are only one tile (the upper left most tile, tile 0,0) and not the global
dataset. My understanding is that the MODIS data are global (not in
tiles?), so I do not know why the MRT is doing this.


2.) Use the raster package in R.

projectedMODIS <- projectRaster(modis,avhrr,method="bilinear")

This returns a raster with values that are all NA:

class       : RasterLayer
dimensions  : 800, 7200, 5760000  (nrow,> ncol, ncell)
resolution  : 0.05, 0.05  (x, y)
extent      : -180, 180,> 50, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
values      : NA, NA  (min, max)

3.) Use the gdalUtils package in R:

gdalwarp(srcfile=get_subdatasets(filemodis)[10], dstfile=
".../gdalMODIS_avhrr.tif", s_srs = crs(modis), t_srs =crs(avhrr) )

This returns a raster with essentially no spatial extent.

gdalMODISavhrr<-raster(".../gdalMODIS_avhrr.tif")
#class       : RasterLayer
#dimensions  : 357, 12850, 4587450  (nrow, ncol, ncell)
#resolution  : 0.02801551, 0.02801573  (x, y)
#extent      : -180, 179.9993, 79.99838, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +ellps=clrk66 +no_defs
#values      : -32768, 32767  (min, max)

Any ideas on why reprojecting this MODIS data is so difficult?


       [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=NLV%2FZLET%2FHxlxlsl93Laqra4z5A5bDdleHi198Uxh0I%3D&amp;reserved=0

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

--
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=02%7C01%7Ckkilpatrick%40rsmas.miami.edu%7C08935d04ff104c1b75fd08d65637a4f5%7C2a144b72f23942d48c0e6f0f17c48e33%7C0%7C0%7C636791194328942432&amp;sdata=NLV%2FZLET%2FHxlxlsl93Laqra4z5A5bDdleHi198Uxh0I%3D&amp;reserved=0


	[[alternative HTML version deleted]]


From tom@hengl @ending from gm@il@com  Fri Nov 30 10:36:11 2018
From: tom@hengl @ending from gm@il@com (Tomislav Hengl)
Date: Fri, 30 Nov 2018 10:36:11 +0100
Subject: [R-sig-Geo] =?utf-8?q?Summer_School_on_spatial_and_spatiotempora?=
 =?utf-8?q?l_computing=3A_processing_large-scale_Earth_observation_=28IfGI?=
 =?utf-8?b?LCBVbml2ZXJzaXR5IG9mIE3DvG5zdGVyLCBTZXB0IDHigJM3LCAyMDE5KQ==?=
Message-ID: <a87c7c0b-4ad0-03be-7f94-f10535c356b9@gmail.com>


Registrations for the 2019 Summer School on spatial and spatiotemporal 
computing: processing large-scale Earth observation (University of 
M?nster, Sept 1?7, 2019) are now open. For more info see:

https://opengeohub.org/summer_school_2019

Registration deadline: 15th of February 2019 24:00 CET.

This summer school is limited to 65 participants. In the case of higher 
number of applications invitations candidates will be selected based on 
a ranking system, which is based on: solidarity, academic output and 
contributions to the open source projects. To remove geographical bias, 
participants coming from more distant areas have a priority on the 
rankings list.

Lecturers:
- Edzer Pebesma: Analyzing large amounts of Earth Observation data with 
R and openEO
- Roger Bivand: Not just R-spatial: sustaining open source geospatial 
software stacks / Data, data everywhere, nor any drop to analyse 
(without making brave assumptions about how the data represent 
underlying processes)
- Michael Sumner: Computer graphics data structures for geo-spatial / 
Building a data library and R toolkit for domain-specific research group 
/ Challenges of working with data in polar regions
- Markus Neteler: Cloud based processing of geo and Earth observation 
data / Introduction to GRASS GIS / Advanced data analysis in GRASS GIS
- Veronica Andreo: Analysis of space-time satellite data for disease 
ecology applications with GRASS GIS and R stats / Analyzing space-time 
satellite data with GRASS GIS for environmental monitoring
- Martijn Tennekes: Creating thematic maps in R (tmap package)
- Tomislav Hengl: Computing with large rasters in R: introduction to 
tiling and parallelization / Spatial and Spatiotemporal prediction using 
ensemble Machine Learning
- Hanna Meyer: Machine learning strategies for spatio-temporal data
- Anita Graser: Analyzing movement data
- Madlene Nussbaum: Mastering machine learning for spatial prediction - 
overview and introduction in methods / model selection and 
interpretation, uncertainty
- Meng Lu: Assessment of global air pollution exposure

Dates:
- February 15th 2019 ? Registration deadline;
- Mid March 2019 ? All invitation letters send to applicants;
- May 15th 2019 ? Deadline for settling registration fees (working 
programme confirmed);
- July 15th 2019 ? Final programme, data sets and exercises published;
- Sun 1st September to Sun 8th September 2019 (arrival Sunday, departure 
Sunday; 7 night accommodation) Summer School;

Note: OpenGeoHub Summer school will be held week after the FOSS4G 
conference (Bucharest, 26?30 August 2019).

Registration fees:
The registrations fees for this Summer School will be in the range 
400?500 EUR. Registration fees cover costs of using facilities, lunch 
and coffee breaks, administration costs, local travel costs, and costs 
of travel and accommodation for lecturers. Participants from ODA 
countries (employed by an organization or company in ODA-listed country; 
http://www.oecd.org/dac/stats/daclist.htm) typically receive a 
subsidized price for the registration costs. Also, full-time students 
(MSc or PhD level) are offered subsidized price, provided that they are, 
at the moment of application, not employed at any University or research 
institute.

Summer school hosts:
This Summer School is hosted by the Institute for Geoinformatics (ifgi), 
Heisenbergstr. 2, 48149 M?nster. Local organizing committee:
- prof. dr. Edzer Pebesma: Summer School programme, discussion sessions,
- dr. Christian Knoth: logistics, lecture rooms, accommodation, social 
programme,

OpenGeoHub is a not-for-profit research foundation with headquarters in 
Wageningen, the Netherlands (Stichting OpenGeoHub, KvK 71844570). The 
main goal of the OpenGeoHub is to promote publishing and sharing of Open 
Geographical and Geoscientific Data and using and developing of Open 
Source Software.

Follow us:
https://twitter.com/opengeohub
https://www.youtube.com/c/OpenGeoHubFoundation
https://business.facebook.com/Opengeohub-foundation-274552396602535/
https://plus.google.com/communities/103560544243938791437


From Virgilio@Gomez @ending from uclm@e@  Fri Nov 30 20:22:02 2018
From: Virgilio@Gomez @ending from uclm@e@ (Virgilio Gomez Rubio)
Date: Fri, 30 Nov 2018 19:22:02 +0000
Subject: [R-sig-Geo] JSS Special Issue on Bayesian Statistics
Message-ID: <713A85FC-FBE9-480D-A236-792BA3C42910@uclm.es>

The Journal of Statistical Software (JSS) now reached an impact factor of over 22, and recently ended highest in the category "statistics and probability" on the ISI web of knowledge ranking.

Special issues of JSS are very popular and get a lot of citations.  We now invite papers for a special issue of the Journal of Statistical Software on "Bayesian Statistics". The conditions are the regular ones of JSS submissions [1], but the special issue aims at bringing together articles presenting open-source software developed by the authors focusing on (but not limited to) the following topics:

* Bayesian modelling and inference.
* Software for Bayesian Data Analysis.
* Software for Bayesian Statistics.
* Model selection and assessment.
* Priors in Bayesian analysis.
* Visualization of results.
* Bayesian data analysis of highly structured data.
* High-performance computing for Bayesian data analysis.
* Bayesian methods for the analysis of ?Big Data?.

Authors who intend to submit an article for this special issue are strongly encouraged to submit paper title, authors, and a preliminary abstract to Virgilio.Gomez at uclm.es or michela.cameletti at unibg.it before December 31st, 2018.

Guest editors for this special issue are:

 Dr. Michela Cameletti (University of Bergamo, Italy)
 Dr. Virgilio Gomez-Rubio (University of Castilla-La Mancha, Spain)
 Prof. Martyn Plummer (Warwick University, UK)

Deadline for papers is Jun 30th, 2019. Submissions must clearly state that they are to be considered for this Special Issue, by mentioning it in the cover letter or by leaving a comment in the upload form.

[1] http://www.jstatsoft.org/

With best regards,

---
Virgilio G?mez Rubio
Escuela de Ingenieros Industriales
Universidad de Castilla-La Mancha
Avda Espa?a s/n
02071 Albacete (Spain)


