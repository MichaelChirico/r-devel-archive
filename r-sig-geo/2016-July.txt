From adrian.baddeley at curtin.edu.au  Fri Jul  1 03:51:50 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Fri, 1 Jul 2016 01:51:50 +0000
Subject: [R-sig-Geo]  analysis of point patterns
Message-ID: <D39BEB0F.2362%Adrian.Baddeley@curtin.edu.au>

Lars-Daniel Weber <Lars-Daniel.Weber at gmx.de> writes:

>I've got a road network (polylines) with points on it as geodata. The
>points have quality measurements of the paving within a distance of 10 to
>20 metres. I'd like to run a analysis on these points to detect
>autocorrelation and hot spots with good and bad paving quality: high-high
>(etc). Local Moran's I might be a good solution from my point of view.
>
>I thought of creating 5 classes of quality from 1 (bad) to 6 (perfect)
>and put it into Local Moran's I. Is this a good approach to get some
>analysis out of the data?
>
>Which packages would you suggest? Or would it be better to write it on my
>own? I can export the point data to LAT;LON;CLASS to do easy processing
>in R.


The R package SSN is designed for geostatistics on a network (originally,
river and stream networks) and has full functionality but is initially
restricted to networks without loops. However it may also be able to
handle a general road network, depending on what you need.

In the R package ?spatstat? there is infrastructure for data on linear
networks (classes linnet, lpp etc). The current release does not cover
geostatistical methods, but you can compute shortest-path distances in the
network and construct your own Moran?s I.


Adrian Baddeley


From Lars-Daniel.Weber at gmx.de  Fri Jul  1 04:37:21 2016
From: Lars-Daniel.Weber at gmx.de (Lars-Daniel Weber)
Date: Fri, 1 Jul 2016 04:37:21 +0200
Subject: [R-sig-Geo] analysis of point patterns
In-Reply-To: <D39BEB0F.2362%Adrian.Baddeley@curtin.edu.au>
References: <D39BEB0F.2362%Adrian.Baddeley@curtin.edu.au>
Message-ID: <trinity-84237390-efac-41e5-8938-e894b95b1913-1467340641249@3capp-gmx-bs17>

> Gesendet: Freitag, 01. Juli 2016 um 03:51 Uhr
> Von: "Adrian Baddeley" <adrian.baddeley at curtin.edu.au>
> An: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Cc: "Greg McSwiggan" <qfengineers at gmail.com>, "Gopalan Nair" <gopalan.nair at uwa.edu.au>, "Lars-Daniel.Weber at gmx.de" <Lars-Daniel.Weber at gmx.de>
>
> The R package SSN is designed for geostatistics on a network (originally,
> river and stream networks) and has full functionality but is initially
> restricted to networks without loops. However it may also be able to
> handle a general road network, depending on what you need.
> 
> In the R package ?spatstat? there is infrastructure for data on linear
> networks (classes linnet, lpp etc). The current release does not cover
> geostatistical methods, but you can compute shortest-path distances in the
> network and construct your own Moran?s I.

Thanks for your answer. Actually, I don't know what I should do with the data.
Don't laugh please. It was addition data, I've got from a laserscanning session;
read at the bottom for more information.

I thought, Local "Moran's I" would be a good idea, to find High-High clusters.
These would indicate a "bad paving quality" and the actual need to fix it.
High-Low/Low-High outliers might be an indication for: "uh, there might be
problems in the near future".

What do you think? It's neither homework, nor a commercial task. The actual
homework is to work with the LIDAR data (extraction of trees and buildings).
I'm junst interested, what statistics I could run on the data to find a
pattern.

Best regards,
Lars-Daniel


From dexter.locke at gmail.com  Fri Jul  1 16:45:06 2016
From: dexter.locke at gmail.com (Dexter Locke)
Date: Fri, 1 Jul 2016 10:45:06 -0400
Subject: [R-sig-Geo] spatial anova
In-Reply-To: <CADkZ+_UN63fn+WOiof_v7hcpXtipJ2r93rH-5=VacOGdBkOf4Q@mail.gmail.com>
References: <DUB112-W113FEE2BA896A3CC1C6E696A9220@phx.gbl>
	<CADkZ+_UN63fn+WOiof_v7hcpXtipJ2r93rH-5=VacOGdBkOf4Q@mail.gmail.com>
Message-ID: <CAA=SVwHr_vpUHoPjiw5J6vjjfA8SsNuaM-yJUdBskmQTo4u==g@mail.gmail.com>

Normally I would agree with Steve, but this is a topic I'm interested in
and have searched extensively. I have not yet found a useable
implementation. If there is some R code that can do this, I would love to
hear about it.

In April Babak Naimi <naimi.b at gmail.com> posted on this list a very similar
question, but I did not see any replies.

For the underlying maths, see these papers:

Griffith, D. A. (1978). A spatially adjusted ANOVA model. *Geographical
Analysis*, *X*(3), 298?301. doi:10.1016/0166-0462(92)90034-X

Griffith, D. A. (1992). A spatially adjusted N-way ANOVA model. *Regional
Science and Urban Economics*, *22*(3), 347?369.
doi:10.1016/0166-0462(92)90034-X

These are also related:

Long, J. a., Nelson, T. a., & Wulder, M. a. (2010). Local indicators for
categorical data: Impacts of scaling decisions. *Canadian Geographer*, *54*(1),
15?28. doi:10.1111/j.1541-0064.2009.00300.x

Pietrzak, M. B., Wilk, J., Kossowski, T., & Bivand, R. (2014). The
application of local indicators for categorical data (LICD) in the spatial
analysis of economic development, (14). Retrieved from
http://ideas.repec.org/p/pes/wpaper/2014no14.html

The old SpaceStat used to have a spatial anova option (white paper by
Anselin):

http://siteresources.worldbank.org/INTPGI/Resources/342674-1092157888460/Anselin.spacestatTutorial.pdf

SpaceStat 4 appears to be able to perform a spatial anova:

https://www.biomedware.com/files/SpaceStat_4.0_Documentation.pdf


Just to be sure I hadn't missed anything I double checked and found this:

library(spdep); help(joincount.multi) and joincount.test(). So it looks
like Roger Bivand provided the needed code once again! Thanks so much.

HTH,
Dexter




On Tue, Jun 28, 2016 at 12:20 PM, Steve Friedman <friedman.steve at gmail.com>
wrote:

> I would start by reading google and R posts regarding spatial anova. There
> is plenty of help among that literature.  Formulate your model, share it,
> and then you might have better questions.
>
> Steve
>
> On Tuesday, June 28, 2016, Csany22 csany <csany22 at hotmail.com> wrote:
>
> > Hi R-sig-geo people,
> >
> >
> > what would be the best way to run spatial anova in R? I have a dependent
> > (continuous), independent (categorical) variables and lat and long fo
> reach
> > of the cell(pixel) based observations. I need to run anova. as would like
> > to compare the means (Tukey) of the independent variable.
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org <javascript:;>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> Steve Friedman
> Cell: 517-648-6290
> Web:  www.envisioningecosystemsdecisions.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From afischbach at usgs.gov  Fri Jul  1 20:48:32 2016
From: afischbach at usgs.gov (Fischbach, Anthony)
Date: Fri, 1 Jul 2016 10:48:32 -0800
Subject: [R-sig-Geo] projectRaster across the antimeridian
Message-ID: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>

The solution to the previous post addressing projection of rasters across
the antimeridian
(
http://r-sig-geo.2731867.n2.nabble.com/coercing-marmap-bathy-object-to-raster-spanning-the-antimeridian-td7589828.html#a7589841
)
no-longer functions
(as of 24 June 2016).

Below I offer permutations of the solution offered in the previous post,
to no avail.

Is this a bug in the raster package, or may my code be adjusted to produce
a projected raster that includes both the western and eastern hemisphere of
the original image?

-Tony

require(sp)
require(raster)
setwd('D:/Temp')
## Define projections
prj.geo<-CRS('+proj=longlat +datum=WGS84')
prj.StudyArea <- CRS("+proj=aeqd +lat_0=70 +lon_0=-170")
prj.StudyAreaPositive <- CRS("+proj=aeqd +lat_0=70 +lon_0=190")
## Download geoJPEG
Yesterday <- Sys.Date() -1
cat(URL<- format(Yesterday, '
http://lance-modis.eosdis.nasa.gov/subsets/index.php?subset=BeringSea.%Y%j.terra.721.2km.jpg'),
fill=T)
cat(DestFile<-format(Yesterday,'BeringSea.%Y%j.terra.721.2km.jpg' ,
sep=""), fill=T)##
try(ds<-download.file(url=URL, destfile=DestFile, method="libcurl", quiet =
F, mode = "wb", cacheOK = F))
## Cast as raster stack
BS.terra<-stack(DestFile)
## Assign projection
projection(BS.terra)<- prj.geo
ymax(BS.terra) <- 70
ymin(BS.terra) <- 58
xmax(BS.terra) = 360-155
xmin(BS.terra) = 360-190
## project the raster stack
(BS.terra.sa1<-projectRaster(from=BS.terra,  res=5000,
crs=prj.StudyAreaPositive, method='ngb', over=TRUE))
(BS.terra.sa2<-projectRaster(from=BS.terra,  res=5000,
crs=prj.StudyAreaPositive, method='ngb', over=F))
(BS.terra.sa3<-projectRaster(from=BS.terra,  res=5000, crs=prj.StudyArea,
method='ngb', over=TRUE))
(BS.terra.sa4<-projectRaster(from=BS.terra,  res=5000, crs=prj.StudyArea,
method='ngb', over=F))
## plot
par(mfrow=c(5,1))
plotRGB(BS.terra)
plotRGB(BS.terra.sa1)
plotRGB(BS.terra.sa2)
plotRGB(BS.terra.sa3)
plotRGB(BS.terra.sa4)
#

	[[alternative HTML version deleted]]


From DanielTurenne at hotmail.com  Fri Jul  1 23:47:35 2016
From: DanielTurenne at hotmail.com (Dan Turenne)
Date: Fri, 1 Jul 2016 21:47:35 +0000
Subject: [R-sig-Geo] determining values for nmax, nmin and maxdist
Message-ID: <BLUPR12MB0625594062A6EF1DD52BFFD2B7250@BLUPR12MB0625.namprd12.prod.outlook.com>

Hello listers,


As part of the research I am doing I'm attempting to fit some kriging models, and I was wondering if there are any "rule of thumb" guidelines for selecting the values for the nmax, nmin and maxdist parameters?  Intuitively I would set maxdist equal to the range of the variogram but I'm not sure about the other parameters.  Any advice on this subject would be appreciated.


Thanks,


Daniel Turenne

University of Manitoba

	[[alternative HTML version deleted]]


From timjp at unimelb.edu.au  Sat Jul  2 02:34:17 2016
From: timjp at unimelb.edu.au (Tim Peterson)
Date: Sat, 2 Jul 2016 10:34:17 +1000
Subject: [R-sig-Geo] determining values for nmax, nmin and maxdist
In-Reply-To: <BLUPR12MB0625594062A6EF1DD52BFFD2B7250@BLUPR12MB0625.namprd12.prod.outlook.com>
References: <BLUPR12MB0625594062A6EF1DD52BFFD2B7250@BLUPR12MB0625.namprd12.prod.outlook.com>
Message-ID: <57770C09.3000207@unimelb.edu.au>

Hi Daniel,

I've never had much success with rules of thumb (eg variogram range). I 
suggest you look into more objective approaches - eg see paper below. 
When I've played with global methods similar to Abedini I've found that 
cross-validation errors (with and without replacement) show a search 
distance that gives a minimum error. Re local  search distance 
estimation (see Abedini), I suspect that for any moderate to large 
problem the computations becomes prohibitive.

M.J. Abedini, M. Nasseri, D.H. Burn, The use of a genetic 
algorithm-based search strategy in geostatistics: application to a set 
of anisotropic piezometric head data, Computers & Geosciences, Volume 
41, April 2012, Pages 136-146, ISSN 0098-3004, 
http://dx.doi.org/10.1016/j.cageo.2011.08.024

Cheers

Tim

On 07/02/2016 07:47 AM, Dan Turenne wrote:
> Hello listers,
>
>
> As part of the research I am doing I'm attempting to fit some kriging models, and I was wondering if there are any "rule of thumb" guidelines for selecting the values for the nmax, nmin and maxdist parameters?  Intuitively I would set maxdist equal to the range of the variogram but I'm not sure about the other parameters.  Any advice on this subject would be appreciated.
>
>
> Thanks,
>
>
> Daniel Turenne
>
> University of Manitoba
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
--------------------
Dr. Tim Peterson

The Department of Infrastructure Engineering
The University of Melbourne, 3010 Australia
T: +61 3 8344 9950 <tel:%2B61%203%208344%209950>, M: +61 0438 385 937 
<tel:%2B61%200438%20385%20937>

Dept. profile : 
http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
Google Scholar: 
http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao

	[[alternative HTML version deleted]]


From mel at mbacou.com  Sat Jul  2 02:46:34 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 1 Jul 2016 20:46:34 -0400
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
Message-ID: <2b298628-d18d-3c3f-2823-f572c02aacd6@mbacou.com>

Tony,
I can confirm this seems like an issue with `projectRaster()`. Using 
`gdalwarp` instead on the same tile seems to work.

# Download geoTIFF
BS.terra <- 
curl::curl_download("https://lance.modaps.eosdis.nasa.gov/imagery/subsets/?subset=BeringSea.2016182.terra.721.2km.tif",
   "BeringSea.2016182.terra.721.2km.tif")
BS.terra <- brick("BeringSea.2016182.terra.721.2km.tif")

# Reproject using `gdalwarp`
system("gdalwarp -overwrite -s_srs EPSG:4326 -t_srs EPSG:3035 -multi -of 
GTiff BeringSea.20e16182.terra.721.2km.tif 
BeringSea.2016182.terra.721.2km.azi.tif")

# Load reprojected raster
BS.terra.sa1 <- brick("BeringSea.2016182.terra.721.2km.azi.tif")

# Reproject with projectRaster()
BS.terra.sa2 <- projectRaster(from=BS.terra, crs=CRS("+init=epsg:3035"))

# Plot
par(mfrow=c(2,1))
plotRGB(BS.terra)
plotRGB(BS.terra.sa1)

# This one errors out
plotRGB(BS.terra.sa2)
 > Error in grDevices::rgb(RGB[, 1], RGB[, 2], RGB[, 3], alpha = alpha, 
max = scale) :
   color intensity -0.00130533, not in [0,1]

See https://dl.dropboxusercontent.com/u/30925475/Capture.PNG

--Mel.

On 7/1/2016 2:48 PM, Fischbach, Anthony wrote:
> The solution to the previous post addressing projection of rasters across
> the antimeridian
> (
> http://r-sig-geo.2731867.n2.nabble.com/coercing-marmap-bathy-object-to-raster-spanning-the-antimeridian-td7589828.html#a7589841
> )
> no-longer functions
> (as of 24 June 2016).
>
> Below I offer permutations of the solution offered in the previous post,
> to no avail.
>
> Is this a bug in the raster package, or may my code be adjusted to produce
> a projected raster that includes both the western and eastern hemisphere of
> the original image?
>
> -Tony
>
> require(sp)
> require(raster)
> setwd('D:/Temp')
> ## Define projections
> prj.geo<-CRS('+proj=longlat +datum=WGS84')
> prj.StudyArea <- CRS("+proj=aeqd +lat_0=70 +lon_0=-170")
> prj.StudyAreaPositive <- CRS("+proj=aeqd +lat_0=70 +lon_0=190")
> ## Download geoJPEG
> Yesterday <- Sys.Date() -1
> cat(URL<- format(Yesterday, '
> http://lance-modis.eosdis.nasa.gov/subsets/index.php?subset=BeringSea.%Y%j.terra.721.2km.jpg'),
> fill=T)
> cat(DestFile<-format(Yesterday,'BeringSea.%Y%j.terra.721.2km.jpg' ,
> sep=""), fill=T)##
> try(ds<-download.file(url=URL, destfile=DestFile, method="libcurl", quiet =
> F, mode = "wb", cacheOK = F))
> ## Cast as raster stack
> BS.terra<-stack(DestFile)
> ## Assign projection
> projection(BS.terra)<- prj.geo
> ymax(BS.terra) <- 70
> ymin(BS.terra) <- 58
> xmax(BS.terra) = 360-155
> xmin(BS.terra) = 360-190
> ## project the raster stack
> (BS.terra.sa1<-projectRaster(from=BS.terra,  res=5000,
> crs=prj.StudyAreaPositive, method='ngb', over=TRUE))
> (BS.terra.sa2<-projectRaster(from=BS.terra,  res=5000,
> crs=prj.StudyAreaPositive, method='ngb', over=F))
> (BS.terra.sa3<-projectRaster(from=BS.terra,  res=5000, crs=prj.StudyArea,
> method='ngb', over=TRUE))
> (BS.terra.sa4<-projectRaster(from=BS.terra,  res=5000, crs=prj.StudyArea,
> method='ngb', over=F))
> ## plot
> par(mfrow=c(5,1))
> plotRGB(BS.terra)
> plotRGB(BS.terra.sa1)
> plotRGB(BS.terra.sa2)
> plotRGB(BS.terra.sa3)
> plotRGB(BS.terra.sa4)
> #
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From clusk at waikato.ac.nz  Sun Jul  3 08:56:43 2016
From: clusk at waikato.ac.nz (Chris Lusk)
Date: Sun, 3 Jul 2016 18:56:43 +1200
Subject: [R-sig-Geo] how to label points on a google map?
Message-ID: <CABqyKtsmU6xCHqQJm1v=Fx=2GDDeg0bscMPWL5im3L+EYnpwUA@mail.gmail.com>

Hi - I'd appreciate any suggestions as to how I can superimpose numbers
over the coloured symbols I've plotted on a google map using the code
below. The numbers I want to use as labels are in the 1st column of the
table. I've seen a couple of solutions online, but neither has worked for
me.
..........

library(ggplot2)
library(ggmap)

Rangitikei <- read.table(text="number lon lat
11  175.74 -39.55
10  175.72 -39.65
9  175.97 -39.7
8  175.78 -39.81
7  175.67 -39.84
6  175.894 -39.84
5  175.96 -39.85
4  175.60 -39.90
3  175.37 -39.905
2  175.53 -39.96
1  175.60 -39.99", header = TRUE, strip.white = TRUE)

# Get the map
RangitikeiMap <- get_googlemap(center = c(lon = 175.736, lat = -39.8),
maptype='roadmap', zoom=10)

# Plot the points on the map
ggmap(RangitikeiMap) +
  geom_point(data=Rangitikei, aes(x=lon, y=lat), colour="gold2", size=6,
alpha=.7)
.........


Dr. Chris Lusk
Senior Research Fellow
Environmental Research Institute
The University of Waikato
Private Bag 3105, Hamilton
New Zealand / Aotearoa
http://sci.waikato.ac.nz/sites/clusk/
Ph 64 7 838 4205
Senior Editor, *NZ J Botany*
~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~

	[[alternative HTML version deleted]]


From mauriziomarchi85 at gmail.com  Sun Jul  3 15:34:00 2016
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Sun, 3 Jul 2016 15:34:00 +0200
Subject: [R-sig-Geo] Extraterrestrial solar radiation
Message-ID: <CANJhsN3AQ8gduDfSu7uNjdNN5MGosOFAR5wrfoObEPZNWVbuQw@mail.gmail.com>

Hello everybody,
I need help to calculate the extraterrestrial solar radiation for my
country using R (or GRASS GIS but I would rather R). I have the DEM of the
country and I would like to calculate the extraterrestrial solar radiation
for the whole territory . My goal is to calculate the moisture deficit
using the fomula
MD = Potential evapotranspiration - Precipitation

Regards, maurizio

-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From vetter at pik-potsdam.de  Sun Jul  3 15:38:26 2016
From: vetter at pik-potsdam.de (Tobias Vetter)
Date: Sun, 3 Jul 2016 15:38:26 +0200
Subject: [R-sig-Geo] Extraterrestrial solar radiation
In-Reply-To: <CANJhsN3AQ8gduDfSu7uNjdNN5MGosOFAR5wrfoObEPZNWVbuQw@mail.gmail.com>
References: <CANJhsN3AQ8gduDfSu7uNjdNN5MGosOFAR5wrfoObEPZNWVbuQw@mail.gmail.com>
Message-ID: <8d431c59-3bff-9db1-9bad-736e0a19160a@pik-potsdam.de>

Look at this package:

https://cran.r-project.org/web/packages/sirad/index.html

Hope this helps.

Tobias


Am 03/07/2016 um 3:34 PM schrieb Maurizio Marchi:
> Hello everybody,
> I need help to calculate the extraterrestrial solar radiation for my
> country using R (or GRASS GIS but I would rather R). I have the DEM of the
> country and I would like to calculate the extraterrestrial solar radiation
> for the whole territory . My goal is to calculate the moisture deficit
> using the fomula
> MD = Potential evapotranspiration - Precipitation
>
> Regards, maurizio
>


From tony.gray at utoronto.ca  Sun Jul  3 17:34:19 2016
From: tony.gray at utoronto.ca (Tony Gray)
Date: Sun, 3 Jul 2016 15:34:19 +0000
Subject: [R-sig-Geo]  how to label points on a google map?
Message-ID: <DEE8BDF8F6DAD542BB352587B6B2533B0125C5A78D@arborexmbx1p.UTORARBOR.UTORAD.Utoronto.ca>

Hi Chris...

I am no R guru, but I create maps like yours frequently. 

Using geom_text works for me. Like this:

-------------------------------------

library(ggplot2)
library(ggmap)

Rangitikei <- read.table(text="number lon lat
                         11  175.74 -39.55
                         10  175.72 -39.65
                         9  175.97 -39.7
                         8  175.78 -39.81
                         7  175.67 -39.84
                         6  175.894 -39.84
                         5  175.96 -39.85
                         4  175.60 -39.90
                         3  175.37 -39.905
                         2  175.53 -39.96
                         1  175.60 -39.99", header = TRUE, strip.white = TRUE)

# Get the map
RangitikeiMap <- get_googlemap(center = c(lon = 175.736, lat = -39.8),
                               maptype='roadmap', zoom=10)

# Plot the points on the map
ggmap(RangitikeiMap) +
  geom_point(data=Rangitikei, aes(x=lon, y=lat), colour="gold2", size=6,
             alpha=.7) +
    geom_text(data = Rangitikei, aes(x = lon, y = lat, label = number), size = 4)

-------------------------------------

Hope this works for you. 

-- Tony


---------------------
Anthony Gray, PhD
Director, Strategic Research
Office of the President
Office: +1 416 978 8792 / Mobile: +1 647 291 4894  
University of Toronto
Simcoe Hall, 27 King's College Circle, Room 206
Toronto ON M5S 1A1 Canada




Date: Sun, 3 Jul 2016 18:56:43 +1200
> Hi - I'd appreciate any suggestions as to how I can superimpose numbers
> over the coloured symbols I've plotted on a google map using the code
> below. The numbers I want to use as labels are in the 1st column of the
> table. I've seen a couple of solutions online, but neither has worked for
> me.
> ..........
> 
> library(ggplot2)
> library(ggmap)
> 
> Rangitikei <- read.table(text="number lon lat
> 11  175.74 -39.55
> 10  175.72 -39.65
> 9  175.97 -39.7
> 8  175.78 -39.81
> 7  175.67 -39.84
> 6  175.894 -39.84
> 5  175.96 -39.85
> 4  175.60 -39.90
> 3  175.37 -39.905
> 2  175.53 -39.96
> 1  175.60 -39.99", header = TRUE, strip.white = TRUE)
> 
> # Get the map
> RangitikeiMap <- get_googlemap(center = c(lon = 175.736, lat = -39.8),
> maptype='roadmap', zoom=10)
> 
> # Plot the points on the map
> ggmap(RangitikeiMap) +
>   geom_point(data=Rangitikei, aes(x=lon, y=lat), colour="gold2", size=6,
> alpha=.7)
> .........
> 
> 
> Dr. Chris Lusk
> Senior Research Fellow
> Environmental Research Institute
> The University of Waikato
> Private Bag 3105, Hamilton
> New Zealand / Aotearoa
> http://sci.waikato.ac.nz/sites/clusk/
> Ph 64 7 838 4205
> Senior Editor, *NZ J Botany*
> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~







From kent3737 at gmail.com  Sun Jul  3 18:20:28 2016
From: kent3737 at gmail.com (Kent Johnson)
Date: Sun, 3 Jul 2016 12:20:28 -0400
Subject: [R-sig-Geo] how to label points on a google map?
Message-ID: <CAPP0wyhMYHXV3qPQ0a3gJA0-+CmvEpd31QouB4Q3s6eXzAL4Qw@mail.gmail.com>

On Sun, Jul 3, 2016 at 6:00 AM, <r-sig-geo-request at r-project.org> wrote:
>
> Subject: [R-sig-Geo] how to label points on a google map?
> Message-ID:
>         <CABqyKtsmU6xCHqQJm1v=Fx=
> 2GDDeg0bscMPWL5im3L+EYnpwUA at mail.gmail.com>
> Content-Type: text/plain; charset="UTF-8"
>
> Hi - I'd appreciate any suggestions as to how I can superimpose numbers
> over the coloured symbols I've plotted on a google map using the code
> below. The numbers I want to use as labels are in the 1st column of the
> table. I've seen a couple of solutions online, but neither has worked for
> me.
> ..........
>
> library(ggplot2)
> library(ggmap)
>
> Rangitikei <- read.table(text="number lon lat
> 11  175.74 -39.55
> 10  175.72 -39.65
> 9  175.97 -39.7
> 8  175.78 -39.81
> 7  175.67 -39.84
> 6  175.894 -39.84
> 5  175.96 -39.85
> 4  175.60 -39.90
> 3  175.37 -39.905
> 2  175.53 -39.96
> 1  175.60 -39.99", header = TRUE, strip.white = TRUE)
>
> # Get the map
> RangitikeiMap <- get_googlemap(center = c(lon = 175.736, lat = -39.8),
> maptype='roadmap', zoom=10)
>
> # Plot the points on the map
> ggmap(RangitikeiMap) +
>   geom_point(data=Rangitikei, aes(x=lon, y=lat), colour="gold2", size=6,
> alpha=.7)
>
>
Add
 + geom_text(data=Rangitikei, aes(x=lon, y=lat, label=number))
to the code above.

Kent

	[[alternative HTML version deleted]]


From isaquedanielre at hotmail.com  Mon Jul  4 02:32:10 2016
From: isaquedanielre at hotmail.com (Isaque Daniel)
Date: Mon, 4 Jul 2016 00:32:10 +0000
Subject: [R-sig-Geo] How to create an ellipse buffer using
 SpatialPointsDataFrame?
In-Reply-To: <57737A30.7030009@web.de>
References: <CO1PR20MB0773604CC53D3EC8003BD0F6C9230@CO1PR20MB0773.namprd20.prod.outlook.com>,
	<57737A30.7030009@web.de>
Message-ID: <SN2PR20MB0784E10878BFF03CDE8D56A0C9380@SN2PR20MB0784.namprd20.prod.outlook.com>

Hi Florian,


Thank's for your advice!
Best

Isaque


------------------------------------------------------------------------------------------------------------------
Eng. Agr. Isaque Daniel Rocha Eberhardt
Mestre em Sensoriamento Remoto - Instituto Nacional de Pesquisas Espaciais (INPE)
Doutorando em Transportes - Universidade de Bras??lia (UNB)
Mobile: +55 (061) 99015658
------------------------------------------------------------------------------------------------------------------
Agronomist engineer
Master in Remote Sensing - National  Institute for Space Research (INPE) - Brazil
PHD Student in Transport - Bras??lia University (UNB)


________________________________
De: R-sig-Geo <r-sig-geo-bounces at r-project.org> em nome de Florian Betz <FloBetz at web.de>
Enviado: quarta-feira, 29 de junho de 2016 07:35
Para: r-sig-geo at r-project.org
Assunto: Re: [R-sig-Geo] How to create an ellipse buffer using SpatialPointsDataFrame?

Dear Isaque,

you could check out the v.buffer module in GRASS GIS which has a buffer
distance for a major and minor axis. I never tried it out, but maybe
this is what you are looking for...

You can run the GRASS commands also from R using the rgrass7 package.

1) Initialize the R-GRASS connection using initGRASS()
2)running the v.buffer module via execGRASS(cmd="v.buffer", ...)


Regards,

Flo



Am 29.06.2016 um 03:26 schrieb Isaque Daniel:
> Hi everyone,
>
>
> I have been working in a model for spatial analysis and my problem now is generate some ellipses around of SpatialPointsDataFrame.
>
>
> I looking for some similar gBuffer of rgeos, but until now I can't find a solution.
>
> Any suggestion?
>
> Thanks in advance
>
> Best
> Isaque
>
>
> ------------------------------------------------------------------------------------------------------------------
> Agronomist engineer
> Master in Remote Sensing - National  Institute for Space Research (INPE) - Brazil
> PHD Student in Transport - Brazilia University (UNB)
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
R-sig-Geo - R Special Interest Group on using Geographical ...<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
stat.ethz.ch
R-sig-Geo -- R Special Interest Group on using Geographical data and Mapping About R-sig-Geo




_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From mauriziomarchi85 at gmail.com  Mon Jul  4 18:13:32 2016
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Mon, 4 Jul 2016 18:13:32 +0200
Subject: [R-sig-Geo] Extraterrestrial solar radiation
Message-ID: <CANJhsN2Umoac=apZSrHrzScWk0e-Rzu-z3t3icAs+9qXg1ji5A@mail.gmail.com>

Hi Tobias,
many thanks for your reply. The package is good even if I would have to
work a little bit bore to have a raster map for each month (sum of daily
values). I will keep on searching for but, in the mean time I will also try
to work with this package.
many thanks again. :)

-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From afischbach at usgs.gov  Tue Jul  5 19:19:47 2016
From: afischbach at usgs.gov (Fischbach, Anthony)
Date: Tue, 5 Jul 2016 09:19:47 -0800
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
Message-ID: <CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>

Melanie,

Thank you for directing me to the direct system call of the gdal gdalwarp
function.
I tried this on my machine, but received an error 127, which suggests an
issue with the path designation on my Windows workstation
(sessionInfo() and rgdal library call printed below).
To address it I confirmed that gdal is in my Windows PATH environment ()
after completely deleting and reinstalled r and gdal.
Unfortunately the problem persists.

Benoit, Does the sessionInfo or rgdal library call printed below suggest a
reason as to why the script works on your workstation, but not mine?

I appreciate all your help.

-Tony

----
> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C

[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.5-8 rgdal_1.1-10 sp_1.2-3

loaded via a namespace (and not attached):
[1] Rcpp_0.12.5     grid_3.3.1      lattice_0.20-33

> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 1.1-10, (SVN revision 622)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
 Path to GDAL shared files: C:/Program Files/R/R-3.3.1/library/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
 Path to PROJ.4 shared files: C:/Program Files/R/R-3.3.1/library/rgdal/proj
 Linking to sp version: 1.2-3
----

	[[alternative HTML version deleted]]


From afischbach at usgs.gov  Tue Jul  5 20:14:06 2016
From: afischbach at usgs.gov (Fischbach, Anthony)
Date: Tue, 5 Jul 2016 10:14:06 -0800
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
	<CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
Message-ID: <CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>

By stepping back to the previous r version (3.2.5) on my workstation
(sessionInfo and rgdal library call printed below),
I am able to obtain the results indicated by Benoit.

Somewhere in this new r version and rasterProject function, we are getting
a problem.

-Tony
---
sessionInfo()
R version 3.2.5 (2016-04-14)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C

[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.5-2 sp_1.2-3

loaded via a namespace (and not attached):
[1] rgdal_1.1-10    Rcpp_0.12.5     grid_3.2.5      lattice_0.20-33
> require(rgdal)
Loading required package: rgdal
rgdal: version: 1.1-10, (SVN revision 622)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
 Path to GDAL shared files: C:/Program Files/R/R-3.2.5/library/rgdal/gdal
 GDAL does not use iconv for recoding strings.
 Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
 Path to PROJ.4 shared files: C:/Program Files/R/R-3.2.5/library/rgdal/proj
 Linking to sp version: 1.2-3
>
--- END ---

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Tue Jul  5 20:25:30 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Jul 2016 20:25:30 +0200
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
	<CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
	<CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>

On Tue, 5 Jul 2016, Fischbach, Anthony wrote:

> By stepping back to the previous r version (3.2.5) on my workstation
> (sessionInfo and rgdal library call printed below),
> I am able to obtain the results indicated by Benoit.

Could you please repeat the sessionInfo and rgdal startup messages for the 
failing R 3.3.1 run? Do you know whether the issue arose between R 3.2.5 
and R 3.3.0, or R 3.3.0 and R 3.3.1 (for the same version of rgdal)? The C 
and C++ compilers used < 3.3.0 and >= 3.3.0 changed, so there is a 
difference in the way that the binaries were built on Windows. I don't 
have easy access to Windows, but could check further if you could provide 
this information.

Roger

>
> Somewhere in this new r version and rasterProject function, we are getting
> a problem.
>
> -Tony
> ---
> sessionInfo()
> R version 3.2.5 (2016-04-14)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.5-2 sp_1.2-3
>
> loaded via a namespace (and not attached):
> [1] rgdal_1.1-10    Rcpp_0.12.5     grid_3.2.5      lattice_0.20-33
>> require(rgdal)
> Loading required package: rgdal
> rgdal: version: 1.1-10, (SVN revision 622)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
> Path to GDAL shared files: C:/Program Files/R/R-3.2.5/library/rgdal/gdal
> GDAL does not use iconv for recoding strings.
> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
> Path to PROJ.4 shared files: C:/Program Files/R/R-3.2.5/library/rgdal/proj
> Linking to sp version: 1.2-3
>>
> --- END ---
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From afischbach at usgs.gov  Tue Jul  5 20:40:25 2016
From: afischbach at usgs.gov (Fischbach, Anthony)
Date: Tue, 5 Jul 2016 10:40:25 -0800
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
	<CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
	<CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>
	<alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>
Message-ID: <CA+ZRYj-02te86pad1-+tiVwdupov=JnLAmKJs=u7Can3aj_zpg@mail.gmail.com>

Thank you Roger,
Here is the sessionInfo and rgdal printout.
> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C
                  LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
> library(rgdal)
Loading required package: sp
rgdal: version: 1.1-10, (SVN revision 622)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
 Path to GDAL shared files: C:/Program Files/R/R-3.3.1/library/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
 Path to PROJ.4 shared files: C:/Program Files/R/R-3.3.1/library/rgdal/proj
 Linking to sp version: 1.2-3
>

I am afraid that I do not have a version 3.3.0 still installed, however, I
first noticed the error on 21 June 2016.
This makes me suspect that the issue occurred with the transition from
3.3.0 to 3.3.1.

-Tony


Anthony Fischbach, Wildlife Biologist
USGS Alaska Science Center Walrus Research Program
4210 University Drive (Glen Olds Hall room 369)
Anchorage, AK 99508

voice: (907) 786-7145

http://alaska.usgs.gov/science/biology/walrus/

On Tue, Jul 5, 2016 at 10:25 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 5 Jul 2016, Fischbach, Anthony wrote:
>
> By stepping back to the previous r version (3.2.5) on my workstation
>> (sessionInfo and rgdal library call printed below),
>> I am able to obtain the results indicated by Benoit.
>>
>
> Could you please repeat the sessionInfo and rgdal startup messages for the
> failing R 3.3.1 run? Do you know whether the issue arose between R 3.2.5
> and R 3.3.0, or R 3.3.0 and R 3.3.1 (for the same version of rgdal)? The C
> and C++ compilers used < 3.3.0 and >= 3.3.0 changed, so there is a
> difference in the way that the binaries were built on Windows. I don't have
> easy access to Windows, but could check further if you could provide this
> information.
>
> Roger
>
>
>> Somewhere in this new r version and rasterProject function, we are getting
>> a problem.
>>
>> -Tony
>> ---
>> sessionInfo()
>> R version 3.2.5 (2016-04-14)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.5-2 sp_1.2-3
>>
>> loaded via a namespace (and not attached):
>> [1] rgdal_1.1-10    Rcpp_0.12.5     grid_3.2.5      lattice_0.20-33
>>
>>> require(rgdal)
>>>
>> Loading required package: rgdal
>> rgdal: version: 1.1-10, (SVN revision 622)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>> Path to GDAL shared files: C:/Program Files/R/R-3.2.5/library/rgdal/gdal
>> GDAL does not use iconv for recoding strings.
>> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>> Path to PROJ.4 shared files: C:/Program Files/R/R-3.2.5/library/rgdal/proj
>> Linking to sp version: 1.2-3
>>
>>>
>>> --- END ---
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> http://depsy.org/person/434412
>

	[[alternative HTML version deleted]]


From mel at mbacou.com  Wed Jul  6 02:51:03 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Tue, 5 Jul 2016 20:51:03 -0400
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
	<CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
	<CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>
	<alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>
Message-ID: <3b868202-50f6-bd1c-c5ec-fd1030bb0cb0@mbacou.com>

Here is my own sessionInfo (I do have problems using `projectRaster()` 
across the antemeridian even with R 3.2.1 and rgdal 1.1-10, but 
`gdalwarp` works for me).

```

R version 3.2.1 (2015-06-18)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

other attached packages:
[1] rgdal_1.1-10 raster_2.5-8 sp_1.2-3     rj_2.0.5-2

loaded via a namespace (and not attached):
[1] rj.gd_2.0.0-1   Rcpp_0.12.5     grid_3.2.1 lattice_0.20-33

```


On 7/5/2016 2:25 PM, Roger Bivand wrote:
> On Tue, 5 Jul 2016, Fischbach, Anthony wrote:
>
>> By stepping back to the previous r version (3.2.5) on my workstation
>> (sessionInfo and rgdal library call printed below),
>> I am able to obtain the results indicated by Benoit.
>
> Could you please repeat the sessionInfo and rgdal startup messages for 
> the failing R 3.3.1 run? Do you know whether the issue arose between R 
> 3.2.5 and R 3.3.0, or R 3.3.0 and R 3.3.1 (for the same version of 
> rgdal)? The C and C++ compilers used < 3.3.0 and >= 3.3.0 changed, so 
> there is a difference in the way that the binaries were built on 
> Windows. I don't have easy access to Windows, but could check further 
> if you could provide this information.
>
> Roger
>
>>
>> Somewhere in this new r version and rasterProject function, we are 
>> getting
>> a problem.
>>
>> -Tony
>> ---
>> sessionInfo()
>> R version 3.2.5 (2016-04-14)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods base
>>
>> other attached packages:
>> [1] raster_2.5-2 sp_1.2-3
>>
>> loaded via a namespace (and not attached):
>> [1] rgdal_1.1-10    Rcpp_0.12.5     grid_3.2.5 lattice_0.20-33
>>> require(rgdal)
>> Loading required package: rgdal
>> rgdal: version: 1.1-10, (SVN revision 622)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>> Path to GDAL shared files: C:/Program Files/R/R-3.2.5/library/rgdal/gdal
>> GDAL does not use iconv for recoding strings.
>> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>> Path to PROJ.4 shared files: C:/Program 
>> Files/R/R-3.2.5/library/rgdal/proj
>> Linking to sp version: 1.2-3
>>>
>> --- END ---
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From mel at mbacou.com  Wed Jul  6 03:03:49 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Tue, 5 Jul 2016 21:03:49 -0400
Subject: [R-sig-Geo] projectRaster across the antimeridian
In-Reply-To: <3b868202-50f6-bd1c-c5ec-fd1030bb0cb0@mbacou.com>
References: <CA+ZRYj_C3qZBgovt6KtgHjhie=L+zXiHRke9UQDOhZVRiL_LWA@mail.gmail.com>
	<9a254dc1-4ac2-25fb-e19c-9814664f920d@mbacou.com>
	<CA+ZRYj_spdJoU3XZnq8OoTKo_eSAvq4w+qCNw9MibvuMVDq7XA@mail.gmail.com>
	<CA+ZRYj-SgkX5mtgD6CMKCdLumTcsC2Q+4kPTqtYXoY2L8Q0mCw@mail.gmail.com>
	<alpine.LFD.2.20.1607052020320.9521@reclus.nhh.no>
	<3b868202-50f6-bd1c-c5ec-fd1030bb0cb0@mbacou.com>
Message-ID: <d694869f-284c-4b78-2b65-5fcda9b13368@mbacou.com>

Same behavior on a Linux server with R 3.3.0 and rgdal 1.1-8. Session 
details below. The reprojected raster is missing it's western half.

```

R version 3.3.0 (2016-05-03)
Platform: x86_64-redhat-linux-gnu (64-bit)
Running under: CentOS release 6.8 (Final)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C LC_TIME=en_US.UTF-8
  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8 
LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

other attached packages:
[1] rgdal_1.1-8  raster_2.5-2 sp_1.2-3

loaded via a namespace (and not attached):
[1] tools_3.3.0     curl_0.9.7      Rcpp_0.12.4 grid_3.3.0      
lattice_0.20-33

```


On 7/5/2016 8:51 PM, Bacou, Melanie wrote:
> Here is my own sessionInfo (I do have problems using `projectRaster()` 
> across the antemeridian even with R 3.2.1 and rgdal 1.1-10, but 
> `gdalwarp` works for me).
>
> ```
>
> R version 3.2.1 (2015-06-18)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods base
>
> other attached packages:
> [1] rgdal_1.1-10 raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>
> loaded via a namespace (and not attached):
> [1] rj.gd_2.0.0-1   Rcpp_0.12.5     grid_3.2.1 lattice_0.20-33
>
> ```
>
>
> On 7/5/2016 2:25 PM, Roger Bivand wrote:
>> On Tue, 5 Jul 2016, Fischbach, Anthony wrote:
>>
>>> By stepping back to the previous r version (3.2.5) on my workstation
>>> (sessionInfo and rgdal library call printed below),
>>> I am able to obtain the results indicated by Benoit.
>>
>> Could you please repeat the sessionInfo and rgdal startup messages 
>> for the failing R 3.3.1 run? Do you know whether the issue arose 
>> between R 3.2.5 and R 3.3.0, or R 3.3.0 and R 3.3.1 (for the same 
>> version of rgdal)? The C and C++ compilers used < 3.3.0 and >= 3.3.0 
>> changed, so there is a difference in the way that the binaries were 
>> built on Windows. I don't have easy access to Windows, but could 
>> check further if you could provide this information.
>>
>> Roger
>>
>>>
>>> Somewhere in this new r version and rasterProject function, we are 
>>> getting
>>> a problem.
>>>
>>> -Tony
>>> ---
>>> sessionInfo()
>>> R version 3.2.5 (2016-04-14)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>>
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>
>>> other attached packages:
>>> [1] raster_2.5-2 sp_1.2-3
>>>
>>> loaded via a namespace (and not attached):
>>> [1] rgdal_1.1-10    Rcpp_0.12.5     grid_3.2.5 lattice_0.20-33
>>>> require(rgdal)
>>> Loading required package: rgdal
>>> rgdal: version: 1.1-10, (SVN revision 622)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
>>> Path to GDAL shared files: C:/Program 
>>> Files/R/R-3.2.5/library/rgdal/gdal
>>> GDAL does not use iconv for recoding strings.
>>> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>>> Path to PROJ.4 shared files: C:/Program 
>>> Files/R/R-3.2.5/library/rgdal/proj
>>> Linking to sp version: 1.2-3
>>>>
>>> --- END ---
>>>
>>>     [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160705/903d3df3/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: nfdkmalcofanekeb.png
Type: image/png
Size: 27097 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160705/903d3df3/attachment.png>

From guillaume.girish at gmail.com  Thu Jul  7 23:10:08 2016
From: guillaume.girish at gmail.com (Guillaume Clair)
Date: Thu, 7 Jul 2016 23:10:08 +0200
Subject: [R-sig-Geo] Trend significance bfast
Message-ID: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>

Hi,

I'm using the function (and package) bfast to work on some NDVI MODIS datas
in Kenya.

I modified the original function in order to extract directly the only
datas that I need, i.e. the trend component (Tt) and the dates of
breakpoints in trend (bp.Vt)

I'd like to process the results in order to get the slopes (this I managed
since it is easy math), and also very importantly I would like to get some
significance of the trend, like it is generally possible to get with the
parameter ANOVA = T in the plot.bfast function. We can see an exemple of
the result HERE <http://fr.tinypic.com/r/doo3l0/9>.

I have two separate questions, the first one is critical, the second is
more out of curiosity in order to understand something that I don't
understand for now :

- in the source code of the function plot.bfast (
https://github.com/cran/bfast/blob/d8d853096d628b62251c6d302319fa95c14e0206/R/plot.bfast.R),
the lines 36 and 37 are processing the ANOVA parameter. Could someone
explain me what is the seasonal() function which is used, and which I
cannot find anywhere ? What I would like to do is to adapt/create my own
script in order to get the same information directly from my own processed
datas (only Tt and bp.Vt), since I cannot process it again by lack of
computing power. I hope the absence of the ci.Vt won't be a problem...

- does someone know why sometime the ANOVA parameter doesn't work ? And
instead return an error

Error in out$bp.Wt$datatsp : $ operator is invalid for atomic vectors

with a plotting just partially made...

Thank you all for your attention.

Best regards.

Guillaume

R Version : 3.3.1

Platform : x86_64-w64-mingw32

	[[alternative HTML version deleted]]


From mel at mbacou.com  Fri Jul  8 07:51:14 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 8 Jul 2016 01:51:14 -0400
Subject: [R-sig-Geo] Trend significance bfast
In-Reply-To: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
References: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
Message-ID: <6152c5d0-b21a-377f-e739-cf1020fa3641@mbacou.com>

Guillaume,
See https://www.rforge.net/doc/packages/hydroTSM/seasonalfunction.html 
for the `zoo:seasonal()` function. In general just look into the 
package's NAMESPACE to see which libraries are imported.

--Mel.


On 7/7/2016 5:10 PM, Guillaume Clair wrote:
> Hi,
>
> I'm using the function (and package) bfast to work on some NDVI MODIS datas
> in Kenya.
>
> I modified the original function in order to extract directly the only
> datas that I need, i.e. the trend component (Tt) and the dates of
> breakpoints in trend (bp.Vt)
>
> I'd like to process the results in order to get the slopes (this I managed
> since it is easy math), and also very importantly I would like to get some
> significance of the trend, like it is generally possible to get with the
> parameter ANOVA = T in the plot.bfast function. We can see an exemple of
> the result HERE <http://fr.tinypic.com/r/doo3l0/9>.
>
> I have two separate questions, the first one is critical, the second is
> more out of curiosity in order to understand something that I don't
> understand for now :
>
> - in the source code of the function plot.bfast (
> https://github.com/cran/bfast/blob/d8d853096d628b62251c6d302319fa95c14e0206/R/plot.bfast.R),
> the lines 36 and 37 are processing the ANOVA parameter. Could someone
> explain me what is the seasonal() function which is used, and which I
> cannot find anywhere ? What I would like to do is to adapt/create my own
> script in order to get the same information directly from my own processed
> datas (only Tt and bp.Vt), since I cannot process it again by lack of
> computing power. I hope the absence of the ci.Vt won't be a problem...
>
> - does someone know why sometime the ANOVA parameter doesn't work ? And
> instead return an error
>
> Error in out$bp.Wt$datatsp : $ operator is invalid for atomic vectors
>
> with a plotting just partially made...
>
> Thank you all for your attention.
>
> Best regards.
>
> Guillaume
>
> R Version : 3.3.1
>
> Platform : x86_64-w64-mingw32
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mel at mbacou.com  Fri Jul  8 07:58:55 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 8 Jul 2016 01:58:55 -0400
Subject: [R-sig-Geo] Trend significance bfast
In-Reply-To: <6152c5d0-b21a-377f-e739-cf1020fa3641@mbacou.com>
References: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
	<6152c5d0-b21a-377f-e739-cf1020fa3641@mbacou.com>
Message-ID: <2e9945dc-d08f-d3da-d51a-196e2408db05@mbacou.com>

Sorry, sent that too fast. `seasonal()` is defined in the bfast package 
here:
https://github.com/cran/bfast/blob/master/R/seasonal.R

--Mel.


On 7/8/2016 1:51 AM, Bacou, Melanie wrote:
> Guillaume,
> See https://www.rforge.net/doc/packages/hydroTSM/seasonalfunction.html 
> for the `zoo:seasonal()` function. In general just look into the 
> package's NAMESPACE to see which libraries are imported.
>
> --Mel.
>
>
> On 7/7/2016 5:10 PM, Guillaume Clair wrote:
>> Hi,
>>
>> I'm using the function (and package) bfast to work on some NDVI MODIS 
>> datas
>> in Kenya.
>>
>> I modified the original function in order to extract directly the only
>> datas that I need, i.e. the trend component (Tt) and the dates of
>> breakpoints in trend (bp.Vt)
>>
>> I'd like to process the results in order to get the slopes (this I 
>> managed
>> since it is easy math), and also very importantly I would like to get 
>> some
>> significance of the trend, like it is generally possible to get with the
>> parameter ANOVA = T in the plot.bfast function. We can see an exemple of
>> the result HERE <http://fr.tinypic.com/r/doo3l0/9>.
>>
>> I have two separate questions, the first one is critical, the second is
>> more out of curiosity in order to understand something that I don't
>> understand for now :
>>
>> - in the source code of the function plot.bfast (
>> https://github.com/cran/bfast/blob/d8d853096d628b62251c6d302319fa95c14e0206/R/plot.bfast.R), 
>>
>> the lines 36 and 37 are processing the ANOVA parameter. Could someone
>> explain me what is the seasonal() function which is used, and which I
>> cannot find anywhere ? What I would like to do is to adapt/create my own
>> script in order to get the same information directly from my own 
>> processed
>> datas (only Tt and bp.Vt), since I cannot process it again by lack of
>> computing power. I hope the absence of the ci.Vt won't be a problem...
>>
>> - does someone know why sometime the ANOVA parameter doesn't work ? And
>> instead return an error
>>
>> Error in out$bp.Wt$datatsp : $ operator is invalid for atomic vectors
>>
>> with a plotting just partially made...
>>
>> Thank you all for your attention.
>>
>> Best regards.
>>
>> Guillaume
>>
>> R Version : 3.3.1
>>
>> Platform : x86_64-w64-mingw32
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mel at mbacou.com  Fri Jul  8 08:03:46 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 8 Jul 2016 02:03:46 -0400
Subject: [R-sig-Geo] Trend significance bfast
In-Reply-To: <2e9945dc-d08f-d3da-d51a-196e2408db05@mbacou.com>
References: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
	<6152c5d0-b21a-377f-e739-cf1020fa3641@mbacou.com>
	<2e9945dc-d08f-d3da-d51a-196e2408db05@mbacou.com>
Message-ID: <8e82d740-c5cb-eaaf-0141-e047d6fc2968@mbacou.com>

Note that NDVI trend decomposition is also available in package 
greenbrown by Matthias Forkel :
http://greenbrown.r-forge.r-project.org/trends.php


On 7/8/2016 1:58 AM, Bacou, Melanie wrote:
> Sorry, sent that too fast. `seasonal()` is defined in the bfast 
> package here:
> https://github.com/cran/bfast/blob/master/R/seasonal.R
>
> --Mel.
>
>
> On 7/8/2016 1:51 AM, Bacou, Melanie wrote:
>> Guillaume,
>> See 
>> https://www.rforge.net/doc/packages/hydroTSM/seasonalfunction.html 
>> for the `zoo:seasonal()` function. In general just look into the 
>> package's NAMESPACE to see which libraries are imported.
>>
>> --Mel.
>>
>>
>> On 7/7/2016 5:10 PM, Guillaume Clair wrote:
>>> Hi,
>>>
>>> I'm using the function (and package) bfast to work on some NDVI 
>>> MODIS datas
>>> in Kenya.
>>>
>>> I modified the original function in order to extract directly the only
>>> datas that I need, i.e. the trend component (Tt) and the dates of
>>> breakpoints in trend (bp.Vt)
>>>
>>> I'd like to process the results in order to get the slopes (this I 
>>> managed
>>> since it is easy math), and also very importantly I would like to 
>>> get some
>>> significance of the trend, like it is generally possible to get with 
>>> the
>>> parameter ANOVA = T in the plot.bfast function. We can see an 
>>> exemple of
>>> the result HERE <http://fr.tinypic.com/r/doo3l0/9>.
>>>
>>> I have two separate questions, the first one is critical, the second is
>>> more out of curiosity in order to understand something that I don't
>>> understand for now :
>>>
>>> - in the source code of the function plot.bfast (
>>> https://github.com/cran/bfast/blob/d8d853096d628b62251c6d302319fa95c14e0206/R/plot.bfast.R), 
>>>
>>> the lines 36 and 37 are processing the ANOVA parameter. Could someone
>>> explain me what is the seasonal() function which is used, and which I
>>> cannot find anywhere ? What I would like to do is to adapt/create my 
>>> own
>>> script in order to get the same information directly from my own 
>>> processed
>>> datas (only Tt and bp.Vt), since I cannot process it again by lack of
>>> computing power. I hope the absence of the ci.Vt won't be a problem...
>>>
>>> - does someone know why sometime the ANOVA parameter doesn't work ? And
>>> instead return an error
>>>
>>> Error in out$bp.Wt$datatsp : $ operator is invalid for atomic vectors
>>>
>>> with a plotting just partially made...
>>>
>>> Thank you all for your attention.
>>>
>>> Best regards.
>>>
>>> Guillaume
>>>
>>> R Version : 3.3.1
>>>
>>> Platform : x86_64-w64-mingw32
>>>
>>>     [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From jan.verbesselt at wur.nl  Fri Jul  8 15:55:10 2016
From: jan.verbesselt at wur.nl (Verbesselt, Jan)
Date: Fri, 8 Jul 2016 13:55:10 +0000
Subject: [R-sig-Geo] Trend significance bfast
In-Reply-To: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
References: <CA+VOk58Zv=TU97w=6sUMAK4gQ9+BhqpcusT_yFn9KaqVJHDYCQ@mail.gmail.com>
Message-ID: <A9E17BF6-36F0-4E4C-988D-28F786890668@wur.nl>

Dear Guillaume,

1) seasonal is a ?helper? function for the plot.bfast() function in case ANOVA = TRUE
https://github.com/cran/bfast/blob/master/R/plot.bfast.R 
https://github.com/cran/bfast/blob/master/R/seasonal.R

2) regarding your error
 out$bp.Wt$datatsp : $ operator is invalid for atomic vectors

Try out the most recent bfast package from here:
http://r-forge.r-project.org/R/?group_id=533
(version 1.5.9, and just have submitted this version to CRAN)

In case you obtain that error again ? please provide a reproducible example ? and I try to help and search for a solution.

Hope this helps,
Jan

-- 
https://www.wageningenur.nl/en/Persons/Jan-Verbesselt.htm


From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Guillaume Clair <guillaume.girish at gmail.com>
Date: Thursday 7 July 2016 at 23:10
To: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] Trend significance bfast

Hi,

I'm using the function (and package) bfast to work on some NDVI MODIS datas
in Kenya.

I modified the original function in order to extract directly the only
datas that I need, i.e. the trend component (Tt) and the dates of
breakpoints in trend (bp.Vt)

I'd like to process the results in order to get the slopes (this I managed
since it is easy math), and also very importantly I would like to get some
significance of the trend, like it is generally possible to get with the
parameter ANOVA = T in the plot.bfast function. We can see an exemple of
the result HERE <http://fr.tinypic.com/r/doo3l0/9>.

I have two separate questions, the first one is critical, the second is
more out of curiosity in order to understand something that I don't
understand for now :

- in the source code of the function plot.bfast (
https://github.com/cran/bfast/blob/d8d853096d628b62251c6d302319fa95c14e0206/R/plot.bfast.R),
the lines 36 and 37 are processing the ANOVA parameter. Could someone
explain me what is the seasonal() function which is used, and which I
cannot find anywhere ? What I would like to do is to adapt/create my own
script in order to get the same information directly from my own processed
datas (only Tt and bp.Vt), since I cannot process it again by lack of
computing power. I hope the absence of the ci.Vt won't be a problem...

- does someone know why sometime the ANOVA parameter doesn't work ? And
instead return an error

Error in out$bp.Wt$datatsp : $ operator is invalid for atomic vectors

with a plotting just partially made...

Thank you all for your attention.

Best regards.

Guillaume

R Version : 3.3.1

Platform : x86_64-w64-mingw32

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




From TinaACormier at gmail.com  Fri Jul  8 16:31:13 2016
From: TinaACormier at gmail.com (Tina Cormier)
Date: Fri, 8 Jul 2016 10:31:13 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
Message-ID: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>

Hi all,

Looking for help aggregating some field data subplots to the plot level
(data currently in shapefile format). I have clusters of 4 points (4
subplots = 1 plot). I'd like to create a circle around each cluster that is
the smallest circle that would encompass all 4 points. Sort of like a
convex hull, but a circle (convex hull, in this case, would give me a
triangle because of the layout of the subplots). I am familiar with (and
use frequently) the typical geo packages in R - with rgdal, sp, raster, and
maptools being my most frequent flyers. Is there a function I'm missing in
these (or some other) packages that might be able to help me out? In the
attribute table, I have a unique ID for each plot/cluster. So for each plot
ID (in this case, consisting of 4 subplots), I'd like to build a circle
around all of the subplots.

> str(pts)
Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 160 obs. of  12 variables:
  .. ..$ Plot      : num [1:160] 1 1 1 1 2 2 2 2 3 3 ...
  .. ..$ Subplot   : num [1:160] 1 2 3 4 1 2 3 4 1 2 ...

I should also mention that it's not always 4 points (subplots), and they
aren't always covering the same size area on the ground, so buffering by a
constant distance isn't the answer. I have subset out 3 plots (so 12
subplots) into a test file here:
https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip

I have R version 3.3.0. I know it's customary to include code for what I've
tried, buuuut, that would be a blank canvas at this point. Googling hasn't
really been fruitful for this issue, so I thought you folks might have some
good ideas!

Thanks,
Tina

	[[alternative HTML version deleted]]


From mel at mbacou.com  Fri Jul  8 22:59:04 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 8 Jul 2016 16:59:04 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
In-Reply-To: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>
References: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>
Message-ID: <9acbcc68-5ed5-2e2f-33ca-44826eac52a0@mbacou.com>

Seems the simplest might be to use the circle that contains your points' 
bounding box (same center as the bbox and with a diameter equal to its 
diagonal?
Spatial circles may be defined as SpatialPolygonsDataFrame using 
sampSurf::spCircle().
https://cran.r-project.org/web/packages/sampSurf/sampSurf.pdf
--Mel.


On 7/8/2016 10:31 AM, Tina Cormier wrote:
> Hi all,
>
> Looking for help aggregating some field data subplots to the plot level
> (data currently in shapefile format). I have clusters of 4 points (4
> subplots = 1 plot). I'd like to create a circle around each cluster that is
> the smallest circle that would encompass all 4 points. Sort of like a
> convex hull, but a circle (convex hull, in this case, would give me a
> triangle because of the layout of the subplots). I am familiar with (and
> use frequently) the typical geo packages in R - with rgdal, sp, raster, and
> maptools being my most frequent flyers. Is there a function I'm missing in
> these (or some other) packages that might be able to help me out? In the
> attribute table, I have a unique ID for each plot/cluster. So for each plot
> ID (in this case, consisting of 4 subplots), I'd like to build a circle
> around all of the subplots.
>
>> str(pts)
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>    ..@ data       :'data.frame': 160 obs. of  12 variables:
>    .. ..$ Plot      : num [1:160] 1 1 1 1 2 2 2 2 3 3 ...
>    .. ..$ Subplot   : num [1:160] 1 2 3 4 1 2 3 4 1 2 ...
>
> I should also mention that it's not always 4 points (subplots), and they
> aren't always covering the same size area on the ground, so buffering by a
> constant distance isn't the answer. I have subset out 3 plots (so 12
> subplots) into a test file here:
> https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip
>
> I have R version 3.3.0. I know it's customary to include code for what I've
> tried, buuuut, that would be a blank canvas at this point. Googling hasn't
> really been fruitful for this issue, so I thought you folks might have some
> good ideas!
>
> Thanks,
> Tina
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From isa_may_kennes at hotmail.com  Sat Jul  9 00:30:50 2016
From: isa_may_kennes at hotmail.com (Isa-May Kennes)
Date: Fri, 8 Jul 2016 22:30:50 +0000
Subject: [R-sig-Geo] Graph of attribute per postal code
Message-ID: <DB5PR06MB1256339EB1F52E56BA13B53BD93C0@DB5PR06MB1256.eurprd06.prod.outlook.com>

Dear all,


I am quite new to R and have a question related to making graphs based on postal codes.

I have a dateset in which each element has a postal code in Belgium, dataset$zip. There are some other attributes like the exposure in days, dataset$exposure.

I would like to make a plot of the map of Belgium, with for different ranges of exposures different colors per postal code. It could for example resemble something like this (not the upper right graph):

[http://www.eurosurveillance.org/images/dynamic/EE/V20N01/Hens_fig2.png]


How can I achieve this?


Thanks in advance,

Bestregards,

Isa-May

	[[alternative HTML version deleted]]


From DanielTurenne at hotmail.com  Sat Jul  9 01:36:18 2016
From: DanielTurenne at hotmail.com (Dan Turenne)
Date: Fri, 8 Jul 2016 23:36:18 +0000
Subject: [R-sig-Geo] Spatio temporal neighborhoods in Gstat
Message-ID: <BLUPR12MB0625058BF71E31DDCFBE2D78B73C0@BLUPR12MB0625.namprd12.prod.outlook.com>

Hello R-Sig-Geo,


I was wondering if anyone might be able to shed some light on how the search neighborhoods work in the krigeST function?  I understand the concept of the anisotropy ratio (For example if the ratio=0.5 then an observation 2 time units away is the same "distance" as an observation 1 distance unit away) but the documentation for krigeST in gstat says "In particular, it does not support block kriging or kriging in a distance-based neighbourhood".  Does this mean that the search neighborhood is entirely determined by nMax?  The documentation says nMax describes the maximum number of spatio temporal neighbors to use but is it possible that less then nMax will be used?


In a related question, does the amount of lags included  in the spatio temporal variogram determine the range of the temporal neighborhood?  For example if the variogram model only includes 5 time lags is it possible that an observation that is 6 time units away will be included in the kriging prediction?  Based on what I know about 2D kriging I would assume that it is possible and the semivariance value is simply equal to the sill in this case, but I want to know if there is any downside to including more time lags beyond increasing computation time.  Any help on this subject would be greatly appreciated.


Sincerely,


Daniel Turenne

University of Manitoba

	[[alternative HTML version deleted]]


From adrian.baddeley at curtin.edu.au  Sat Jul  9 12:38:07 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Sat, 9 Jul 2016 10:38:07 +0000
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points (Tina
	Cormier)
In-Reply-To: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
Message-ID: <SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>

Tina Cormier <TinaACormier at gmail.com> wrote:

> I'd like to create a circle around each cluster that is
> the smallest circle that would encompass all 4 points.

The circumcircle.

Try the following:

<https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip><https://stat.ethz.ch/mailman/listinfo/r-sig-geo>library(spatstat)

circumcircle <- function(x, ...) {   UseMethod("circumcircle") }

circumcircle.owin <- function(x, ...) {
  d2 <- fardist(x, ..., squared=TRUE)
  z <- where.min(d2)
  r <- sqrt(min(d2))
  w <- disc(centre=z, radius=r)
  return(w)
}

circumcircle.ppp <- function(x, ...) {
  circumcircle(convexhull(x))
}


Adrian Baddeley

	[[alternative HTML version deleted]]


From TinaACormier at gmail.com  Sat Jul  9 17:02:05 2016
From: TinaACormier at gmail.com (Tina Cormier)
Date: Sat, 9 Jul 2016 11:02:05 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
In-Reply-To: <9acbcc68-5ed5-2e2f-33ca-44826eac52a0@mbacou.com>
References: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>
	<9acbcc68-5ed5-2e2f-33ca-44826eac52a0@mbacou.com>
Message-ID: <CAFfx768U399orBJKQV5aj6V+rujd8TAW9LM_qJ1enC9J8F1FBQ@mail.gmail.com>

Thanks Melanie,

That is a great, workable solution. Thank you...I'll try that!

Tina
On Jul 8, 2016 4:59 PM, "Bacou, Melanie" <mel at mbacou.com> wrote:

> Seems the simplest might be to use the circle that contains your points'
> bounding box (same center as the bbox and with a diameter equal to its
> diagonal?
> Spatial circles may be defined as SpatialPolygonsDataFrame using
> sampSurf::spCircle().
> https://cran.r-project.org/web/packages/sampSurf/sampSurf.pdf
> --Mel.
>
>
> On 7/8/2016 10:31 AM, Tina Cormier wrote:
>
>> Hi all,
>>
>> Looking for help aggregating some field data subplots to the plot level
>> (data currently in shapefile format). I have clusters of 4 points (4
>> subplots = 1 plot). I'd like to create a circle around each cluster that
>> is
>> the smallest circle that would encompass all 4 points. Sort of like a
>> convex hull, but a circle (convex hull, in this case, would give me a
>> triangle because of the layout of the subplots). I am familiar with (and
>> use frequently) the typical geo packages in R - with rgdal, sp, raster,
>> and
>> maptools being my most frequent flyers. Is there a function I'm missing in
>> these (or some other) packages that might be able to help me out? In the
>> attribute table, I have a unique ID for each plot/cluster. So for each
>> plot
>> ID (in this case, consisting of 4 subplots), I'd like to build a circle
>> around all of the subplots.
>>
>> str(pts)
>>>
>> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>>    ..@ data       :'data.frame': 160 obs. of  12 variables:
>>    .. ..$ Plot      : num [1:160] 1 1 1 1 2 2 2 2 3 3 ...
>>    .. ..$ Subplot   : num [1:160] 1 2 3 4 1 2 3 4 1 2 ...
>>
>> I should also mention that it's not always 4 points (subplots), and they
>> aren't always covering the same size area on the ground, so buffering by a
>> constant distance isn't the answer. I have subset out 3 plots (so 12
>> subplots) into a test file here:
>> https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip
>>
>> I have R version 3.3.0. I know it's customary to include code for what
>> I've
>> tried, buuuut, that would be a blank canvas at this point. Googling hasn't
>> really been fruitful for this issue, so I thought you folks might have
>> some
>> good ideas!
>>
>> Thanks,
>> Tina
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From mel at mbacou.com  Sun Jul 10 02:50:53 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Sat, 9 Jul 2016 20:50:53 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
 (Tina Cormier)
In-Reply-To: <SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
Message-ID: <b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>

Interesting problem, it seems the exact approach is given by Fischer, 
2003 and is implemented in a C++ CGAL package (see 
http://stackoverflow.com/questions/9063453/how-to-compute-the-smallest-bounding-sphere-enclosing-other-bounding-spheres).

I haven't found any binding for R, but there's an implementation in 
PostGIS `ST_MinimumBoundingCircle()` (see 
http://postgis.net/docs/ST_MinimumBoundingCircle.html).

Others might be more up to date.
--Mel.


On 7/9/2016 6:38 AM, Adrian Baddeley wrote:
> Tina Cormier <TinaACormier at gmail.com> wrote:
>
>> I'd like to create a circle around each cluster that is
>> the smallest circle that would encompass all 4 points.
> The circumcircle.
>
> Try the following:
>
> <https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip><https://stat.ethz.ch/mailman/listinfo/r-sig-geo>library(spatstat)
>
> circumcircle <- function(x, ...) {   UseMethod("circumcircle") }
>
> circumcircle.owin <- function(x, ...) {
>    d2 <- fardist(x, ..., squared=TRUE)
>    z <- where.min(d2)
>    r <- sqrt(min(d2))
>    w <- disc(centre=z, radius=r)
>    return(w)
> }
>
> circumcircle.ppp <- function(x, ...) {
>    circumcircle(convexhull(x))
> }
>
>
> Adrian Baddeley
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From hiztirab at yahoo.com  Sun Jul 10 10:45:10 2016
From: hiztirab at yahoo.com (Iztirab Hussain)
Date: Sun, 10 Jul 2016 08:45:10 +0000 (UTC)
Subject: [R-sig-Geo] Learning hydroGOF Package
References: <56373575.1400951.1468140310579.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <56373575.1400951.1468140310579.JavaMail.yahoo@mail.yahoo.com>

Hi,?I am quite new here on this forum.
Basically ?i have to learn hydroGOF package of Rstudio so is there any video tutorial/ training/exercise/ workshop or lecture about hydroGOF package?I could not found more then txt tutorial of this package which is bit difficult to pick up for me.

Regards
HiztirabBeijing. ChinaChinese Academy of Sciences
	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Sun Jul 10 14:44:20 2016
From: englishchristophera at gmail.com (chris english)
Date: Sun, 10 Jul 2016 15:44:20 +0300
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
	(Tina Cormier)
In-Reply-To: <b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
Message-ID: <CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>

Mel,

Not a full implementation, but indicator of how one might do,
https://rforge.net/rcgal/git.html, that Simon Urbanek styles : rcgal - R
interface to a (small) subset of CGAL,
and has inside (function) that takes arbitrary shape files and x/y to say
inside or not.

CGAL is a darn fine library and I guess you'd pick and choose which parts
you'd wrap for your purposes.

Chris

On Sun, Jul 10, 2016 at 3:50 AM, Bacou, Melanie <mel at mbacou.com> wrote:

> Interesting problem, it seems the exact approach is given by Fischer, 2003
> and is implemented in a C++ CGAL package (see
> http://stackoverflow.com/questions/9063453/how-to-compute-the-smallest-bounding-sphere-enclosing-other-bounding-spheres
> ).
>
> I haven't found any binding for R, but there's an implementation in
> PostGIS `ST_MinimumBoundingCircle()` (see
> http://postgis.net/docs/ST_MinimumBoundingCircle.html).
>
> Others might be more up to date.
> --Mel.
>
>
>
> On 7/9/2016 6:38 AM, Adrian Baddeley wrote:
>
>> Tina Cormier <TinaACormier at gmail.com> wrote:
>>
>> I'd like to create a circle around each cluster that is
>>> the smallest circle that would encompass all 4 points.
>>>
>> The circumcircle.
>>
>> Try the following:
>>
>> <https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip><
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo>library(spatstat)
>>
>> circumcircle <- function(x, ...) {   UseMethod("circumcircle") }
>>
>> circumcircle.owin <- function(x, ...) {
>>    d2 <- fardist(x, ..., squared=TRUE)
>>    z <- where.min(d2)
>>    r <- sqrt(min(d2))
>>    w <- disc(centre=z, radius=r)
>>    return(w)
>> }
>>
>> circumcircle.ppp <- function(x, ...) {
>>    circumcircle(convexhull(x))
>> }
>>
>>
>> Adrian Baddeley
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Sun Jul 10 15:01:54 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 10 Jul 2016 13:01:54 +0000
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
	(Tina Cormier)
In-Reply-To: <CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
	<CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
Message-ID: <CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>

I also have a (much more simplistic) use of CGAL here, for a different
algorithm but may help for seeing how to leverage it:

https://github.com/mdsumner/cgalgris

I've abandoned that now in favour of RTriangle, but still very interested
in uses of CGAL with R if anyone knows any more.

Cheers, Mike

On Sun, Jul 10, 2016, 22:44 chris english <englishchristophera at gmail.com>
wrote:

> Mel,
>
> Not a full implementation, but indicator of how one might do,
> https://rforge.net/rcgal/git.html, that Simon Urbanek styles : rcgal - R
> interface to a (small) subset of CGAL,
> and has inside (function) that takes arbitrary shape files and x/y to say
> inside or not.
>
> CGAL is a darn fine library and I guess you'd pick and choose which parts
> you'd wrap for your purposes.
>
> Chris
>
> On Sun, Jul 10, 2016 at 3:50 AM, Bacou, Melanie <mel at mbacou.com> wrote:
>
> > Interesting problem, it seems the exact approach is given by Fischer,
> 2003
> > and is implemented in a C++ CGAL package (see
> >
> http://stackoverflow.com/questions/9063453/how-to-compute-the-smallest-bounding-sphere-enclosing-other-bounding-spheres
> > ).
> >
> > I haven't found any binding for R, but there's an implementation in
> > PostGIS `ST_MinimumBoundingCircle()` (see
> > http://postgis.net/docs/ST_MinimumBoundingCircle.html).
> >
> > Others might be more up to date.
> > --Mel.
> >
> >
> >
> > On 7/9/2016 6:38 AM, Adrian Baddeley wrote:
> >
> >> Tina Cormier <TinaACormier at gmail.com> wrote:
> >>
> >> I'd like to create a circle around each cluster that is
> >>> the smallest circle that would encompass all 4 points.
> >>>
> >> The circumcircle.
> >>
> >> Try the following:
> >>
> >> <https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip
> ><
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo>library(spatstat)
> >>
> >> circumcircle <- function(x, ...) {   UseMethod("circumcircle") }
> >>
> >> circumcircle.owin <- function(x, ...) {
> >>    d2 <- fardist(x, ..., squared=TRUE)
> >>    z <- where.min(d2)
> >>    r <- sqrt(min(d2))
> >>    w <- disc(centre=z, radius=r)
> >>    return(w)
> >> }
> >>
> >> circumcircle.ppp <- function(x, ...) {
> >>    circumcircle(convexhull(x))
> >> }
> >>
> >>
> >> Adrian Baddeley
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From Giacomo_May94 at gmx.de  Sun Jul 10 21:34:40 2016
From: Giacomo_May94 at gmx.de (Giacomo May)
Date: Sun, 10 Jul 2016 21:34:40 +0200
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
Message-ID: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>

Dear R-users,
I am trying to add +1 to the cell value of certain cells in a raster. I have the cell numbers of the cells on which I'd like to perform said computation saved in a vector. I have a working code but with a large vector and raster it takes ages:

r <- raster(ncol=5,nrow=5)
r[] <- 0
vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
for(i in 1:length(vec))
{
r[vec[i]] <- r[vec[i]] + 1
}

I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work properly, it just sets the values of the cells stored in the vector to 1. Does anybody know a faster way to do this ? Thanks in advance!


From tea3rd at gmail.com  Sun Jul 10 21:45:05 2016
From: tea3rd at gmail.com (Thomas Adams)
Date: Sun, 10 Jul 2016 14:45:05 -0500
Subject: [R-sig-Geo] Learning hydroGOF Package
In-Reply-To: <56373575.1400951.1468140310579.JavaMail.yahoo@mail.yahoo.com>
References: <56373575.1400951.1468140310579.JavaMail.yahoo.ref@mail.yahoo.com>
	<56373575.1400951.1468140310579.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAGxgkWhbmtV1Ck68jijekTK9MD7E6b_JhTgiGG8SqdVt_kU0Yw@mail.gmail.com>

Try Googling "hydroGOF"; you'll find:

https://cran.r-project.org/web/packages/hydroGOF/vignettes/hydroGOF_Vignette.pdf
http://www.slideshare.net/hzambran/egu2012-11549go-fsforextremeevents4web
http://www.slideshare.net/hzambran/egu2010-ra-statisticalenvironmentfordoinghydrologicalanalysis-9095709

http://scisoft-net-map.isri.cmu.edu/application/hydroGOF/used_with

https://gist.github.com/johnDorian/773aa58633d6c4261a24
https://www.mpimet.mpg.de/fileadmin/land/Interaction/Documentation.pdf




On Sun, Jul 10, 2016 at 3:45 AM, Iztirab Hussain via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hi, I am quite new here on this forum.
> Basically  i have to learn hydroGOF package of Rstudio so is there any
> video tutorial/ training/exercise/ workshop or lecture about hydroGOF
> package?I could not found more then txt tutorial of this package which is
> bit difficult to pick up for me.
>
> Regards
> HiztirabBeijing. ChinaChinese Academy of Sciences
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Sun Jul 10 21:50:56 2016
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 10 Jul 2016 12:50:56 -0700
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
	(Tina Cormier)
In-Reply-To: <CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
	<CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
	<CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>
Message-ID: <CANtt_hy4COsPUG1LsZ00jq7Jte1EfJoVjr0jDKuhdWHFgCytSQ@mail.gmail.com>

Here is a solution using optimization

library(raster)
library(rgeos)

set.seed(7)
n <- 4
xy <- cbind(runif(n), runif(n))

f <- function(p) { max(pointDistance(rbind(p), xy, lonlat=FALSE)) }
p <- optim(colMeans(xy), f)
cc <- buffer(SpatialPoints(rbind(p$par)), width=p$value, quadsegs=45)

plot(cc)
points(xy, pch=20, cex=1.5)
points(rbind(p$par), pch='*', col='red', cex=3)
lines(rbind(p$par, c(p$par[1]+p$value, p$par[2])), col='blue', lwd=2, lty=2)
text(p$par[1]+0.5*p$value, p$par[2], paste("radius =", round(p$value,
2)), pos=3, cex=.85)
text(p$par[1], p$par[2], labels=paste0("(",paste(round(p$par, 2),
collapse=", "), ")"), pos=1, cex=.75)

Best, Robert

On Sun, Jul 10, 2016 at 6:01 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> I also have a (much more simplistic) use of CGAL here, for a different
> algorithm but may help for seeing how to leverage it:
>
> https://github.com/mdsumner/cgalgris
>
> I've abandoned that now in favour of RTriangle, but still very interested
> in uses of CGAL with R if anyone knows any more.
>
> Cheers, Mike
>
> On Sun, Jul 10, 2016, 22:44 chris english <englishchristophera at gmail.com>
> wrote:
>
>> Mel,
>>
>> Not a full implementation, but indicator of how one might do,
>> https://rforge.net/rcgal/git.html, that Simon Urbanek styles : rcgal - R
>> interface to a (small) subset of CGAL,
>> and has inside (function) that takes arbitrary shape files and x/y to say
>> inside or not.
>>
>> CGAL is a darn fine library and I guess you'd pick and choose which parts
>> you'd wrap for your purposes.
>>
>> Chris
>>
>> On Sun, Jul 10, 2016 at 3:50 AM, Bacou, Melanie <mel at mbacou.com> wrote:
>>
>> > Interesting problem, it seems the exact approach is given by Fischer,
>> 2003
>> > and is implemented in a C++ CGAL package (see
>> >
>> http://stackoverflow.com/questions/9063453/how-to-compute-the-smallest-bounding-sphere-enclosing-other-bounding-spheres
>> > ).
>> >
>> > I haven't found any binding for R, but there's an implementation in
>> > PostGIS `ST_MinimumBoundingCircle()` (see
>> > http://postgis.net/docs/ST_MinimumBoundingCircle.html).
>> >
>> > Others might be more up to date.
>> > --Mel.
>> >
>> >
>> >
>> > On 7/9/2016 6:38 AM, Adrian Baddeley wrote:
>> >
>> >> Tina Cormier <TinaACormier at gmail.com> wrote:
>> >>
>> >> I'd like to create a circle around each cluster that is
>> >>> the smallest circle that would encompass all 4 points.
>> >>>
>> >> The circumcircle.
>> >>
>> >> Try the following:
>> >>
>> >> <https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip
>> ><
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo>library(spatstat)
>> >>
>> >> circumcircle <- function(x, ...) {   UseMethod("circumcircle") }
>> >>
>> >> circumcircle.owin <- function(x, ...) {
>> >>    d2 <- fardist(x, ..., squared=TRUE)
>> >>    z <- where.min(d2)
>> >>    r <- sqrt(min(d2))
>> >>    w <- disc(centre=z, radius=r)
>> >>    return(w)
>> >> }
>> >>
>> >> circumcircle.ppp <- function(x, ...) {
>> >>    circumcircle(convexhull(x))
>> >> }
>> >>
>> >>
>> >> Adrian Baddeley
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From btupper at bigelow.org  Sun Jul 10 23:59:16 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Sun, 10 Jul 2016 17:59:16 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
References: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
Message-ID: <6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>

Hi,

I stub my toe on this all the time (and wish I didn't).  The behavior isn't limited to raster - the replacement operator `[` in general doesn't update the left had side like my wild imagination might allow.  It's just a function and so it must make a copy of the input.

This note seen here ?`[` sort of points out the issue... "Subassignment is done sequentially, so if an index is specified more than once the latest assigned value for an index will result."  Between that, the phase of the moon and the pass-by-value stuff my brain starts to jumble. 

On the other hand, if you have dependable indices and are simply incrementing you can leverage table() for your purpose.

x <- rep(0,5)
i <- c(1,1,1,4)
ti <- table(i)
tindex <- as.numeric(names(ti))
x[tindex] <- x[tindex] + ti

Likewise for raster

library(raster)
r <- raster(ncol=5,nrow=5)
r[] <- 0
vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
tvec <- table(vec)
tindex <- as.integer(names(tvec))
r[tindex] <- r[tindex] + tvec

I hope there are smarter/faster ways, but in the meantime it might speed things along for you.  


Ben


> On Jul 10, 2016, at 3:34 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
> 
> Dear R-users,
> I am trying to add +1 to the cell value of certain cells in a raster. I have the cell numbers of the cells on which I'd like to perform said computation saved in a vector. I have a working code but with a large vector and raster it takes ages:
> 
> r <- raster(ncol=5,nrow=5)
> r[] <- 0
> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
> for(i in 1:length(vec))
> {
> r[vec[i]] <- r[vec[i]] + 1
> }
> 
> I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work properly, it just sets the values of the cells stored in the vector to 1. Does anybody know a faster way to do this ? Thanks in advance!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


From vijaylulla at gmail.com  Mon Jul 11 00:45:01 2016
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Sun, 10 Jul 2016 18:45:01 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>
References: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
	<6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>
Message-ID: <CAKkiGbt=1m5dNeY-hk2UQvLpV+EU_Z-P9sLJKjupfi_EvsYxGw@mail.gmail.com>

Maybe something like this?

R> r <- raster(nrows=5,ncols=5)
R> r[] <- 0
R> idx <- matrix(c(1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE) # four corners of
the raster!
R> r[idx] <- r[idx] + 1
R> image(r)

>From R's ?`[` : When indexing arrays by '[' a single argument 'i' can be a
matrix with as many columns as there are dimensions of 'x'; the result is
then a vector with elements corresponding to the sets of indices in each
row of 'i'.


On Sun, Jul 10, 2016 at 5:59 PM, Ben Tupper <btupper at bigelow.org> wrote:

> Hi,
>
> I stub my toe on this all the time (and wish I didn't).  The behavior
> isn't limited to raster - the replacement operator `[` in general doesn't
> update the left had side like my wild imagination might allow.  It's just a
> function and so it must make a copy of the input.
>
> This note seen here ?`[` sort of points out the issue... "Subassignment is
> done sequentially, so if an index is specified more than once the latest
> assigned value for an index will result."  Between that, the phase of the
> moon and the pass-by-value stuff my brain starts to jumble.
>
> On the other hand, if you have dependable indices and are simply
> incrementing you can leverage table() for your purpose.
>
> x <- rep(0,5)
> i <- c(1,1,1,4)
> ti <- table(i)
> tindex <- as.numeric(names(ti))
> x[tindex] <- x[tindex] + ti
>
> Likewise for raster
>
> library(raster)
> r <- raster(ncol=5,nrow=5)
> r[] <- 0
> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
> tvec <- table(vec)
> tindex <- as.integer(names(tvec))
> r[tindex] <- r[tindex] + tvec
>
> I hope there are smarter/faster ways, but in the meantime it might speed
> things along for you.
>
>
> Ben
>
>
> > On Jul 10, 2016, at 3:34 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
> >
> > Dear R-users,
> > I am trying to add +1 to the cell value of certain cells in a raster. I
> have the cell numbers of the cells on which I'd like to perform said
> computation saved in a vector. I have a working code but with a large
> vector and raster it takes ages:
> >
> > r <- raster(ncol=5,nrow=5)
> > r[] <- 0
> > vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
> > for(i in 1:length(vec))
> > {
> > r[vec[i]] <- r[vec[i]] + 1
> > }
> >
> > I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work
> properly, it just sets the values of the cells stored in the vector to 1.
> Does anybody know a faster way to do this ? Thanks in advance!
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or
> tweet them to #MaineJellies -- include date, time, and location, as well as
> any descriptive information such as size or type.  Learn more at
> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Mon Jul 11 01:54:57 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Sun, 10 Jul 2016 19:54:57 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <CAKkiGbt=1m5dNeY-hk2UQvLpV+EU_Z-P9sLJKjupfi_EvsYxGw@mail.gmail.com>
References: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
	<6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>
	<CAKkiGbt=1m5dNeY-hk2UQvLpV+EU_Z-P9sLJKjupfi_EvsYxGw@mail.gmail.com>
Message-ID: <E62FD6B5-D75C-4BF3-B60F-2AA22F6C1CD5@bigelow.org>

Hi,

Interesting.  How would you use the matrix approach to increment a particular cell more than once with a single subassignment?  If I repeat the upper left raster coord in the matrix 3 times it still yields a value of 1 up there.

library(raster)
r <- raster(nrows=5,ncols=5)
r[] <- 0
idx <- matrix(c(1,1,1,1,1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE) 
r[idx] <- r[idx] + 1
plot(r)
range(getValues(r))
#[1] 0 1

I could be misreading the original posting, but I think the desire is that the result will be increment for each repeated index using just one subassignment.  

Cheers,
Ben


> On Jul 10, 2016, at 6:45 PM, Vijay Lulla <vijaylulla at gmail.com> wrote:
> 
> Maybe something like this?
> 
> R> r <- raster(nrows=5,ncols=5)
> R> r[] <- 0
> R> idx <- matrix(c(1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE) # four corners of the raster!
> R> r[idx] <- r[idx] + 1
> R> image(r)
> 
> From R's ?`[` : When indexing arrays by '[' a single argument 'i' can be a matrix with as many columns as there are dimensions of 'x'; the result is then a vector with elements corresponding to the sets of indices in each row of 'i'.
> 
> 
> On Sun, Jul 10, 2016 at 5:59 PM, Ben Tupper <btupper at bigelow.org <mailto:btupper at bigelow.org>> wrote:
> Hi,
> 
> I stub my toe on this all the time (and wish I didn't).  The behavior isn't limited to raster - the replacement operator `[` in general doesn't update the left had side like my wild imagination might allow.  It's just a function and so it must make a copy of the input.
> 
> This note seen here ?`[` sort of points out the issue... "Subassignment is done sequentially, so if an index is specified more than once the latest assigned value for an index will result."  Between that, the phase of the moon and the pass-by-value stuff my brain starts to jumble.
> 
> On the other hand, if you have dependable indices and are simply incrementing you can leverage table() for your purpose.
> 
> x <- rep(0,5)
> i <- c(1,1,1,4)
> ti <- table(i)
> tindex <- as.numeric(names(ti))
> x[tindex] <- x[tindex] + ti
> 
> Likewise for raster
> 
> library(raster)
> r <- raster(ncol=5,nrow=5)
> r[] <- 0
> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
> tvec <- table(vec)
> tindex <- as.integer(names(tvec))
> r[tindex] <- r[tindex] + tvec
> 
> I hope there are smarter/faster ways, but in the meantime it might speed things along for you.
> 
> 
> Ben
> 
> 
> > On Jul 10, 2016, at 3:34 PM, Giacomo May <Giacomo_May94 at gmx.de <mailto:Giacomo_May94 at gmx.de>> wrote:
> >
> > Dear R-users,
> > I am trying to add +1 to the cell value of certain cells in a raster. I have the cell numbers of the cells on which I'd like to perform said computation saved in a vector. I have a working code but with a large vector and raster it takes ages:
> >
> > r <- raster(ncol=5,nrow=5)
> > r[] <- 0
> > vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
> > for(i in 1:length(vec))
> > {
> > r[vec[i]] <- r[vec[i]] + 1
> > }
> >
> > I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work properly, it just sets the values of the cells stored in the vector to 1. Does anybody know a faster way to do this ? Thanks in advance!
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org <http://www.bigelow.org/>
> 
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org <mailto:jellyfish at bigelow.org> or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/ <https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


	[[alternative HTML version deleted]]


From vijaylulla at gmail.com  Mon Jul 11 02:58:06 2016
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Sun, 10 Jul 2016 20:58:06 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <E62FD6B5-D75C-4BF3-B60F-2AA22F6C1CD5@bigelow.org>
References: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
	<6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>
	<CAKkiGbt=1m5dNeY-hk2UQvLpV+EU_Z-P9sLJKjupfi_EvsYxGw@mail.gmail.com>
	<E62FD6B5-D75C-4BF3-B60F-2AA22F6C1CD5@bigelow.org>
Message-ID: <CAKkiGbsNfYbrE4SwOiQsNqXVPXJnv+yHop5H7pv6Paz_ff1peg@mail.gmail.com>

OOPS!  I appear to have misunderstood the question then, Ben.  I'm unsure
how to increment a particular cell more than once.

Please pardon the noise.

On Sun, Jul 10, 2016 at 7:54 PM, Ben Tupper <btupper at bigelow.org> wrote:

> Hi,
>
> Interesting.  How would you use the matrix approach to increment a
> particular cell more than once with a single subassignment?  If I repeat
> the upper left raster coord in the matrix 3 times it still yields a value
> of 1 up there.
>
> library(raster)
> r <- raster(nrows=5,ncols=5)
> r[] <- 0
> idx <- matrix(c(1,1,1,1,1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE)
> r[idx] <- r[idx] + 1
> plot(r)
> range(getValues(r))
> #[1] 0 1
>
> I could be misreading the original posting, but I think the desire is that
> the result will be increment for each repeated index using just one
> subassignment.
>
> Cheers,
> Ben
>
>
> On Jul 10, 2016, at 6:45 PM, Vijay Lulla <vijaylulla at gmail.com> wrote:
>
> Maybe something like this?
>
> R> r <- raster(nrows=5,ncols=5)
> R> r[] <- 0
> R> idx <- matrix(c(1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE) # four corners of
> the raster!
> R> r[idx] <- r[idx] + 1
> R> image(r)
>
> From R's ?`[` : When indexing arrays by '[' a single argument 'i' can be a
> matrix with as many columns as there are dimensions of 'x'; the result is
> then a vector with elements corresponding to the sets of indices in each
> row of 'i'.
>
>
> On Sun, Jul 10, 2016 at 5:59 PM, Ben Tupper <btupper at bigelow.org> wrote:
>
>> Hi,
>>
>> I stub my toe on this all the time (and wish I didn't).  The behavior
>> isn't limited to raster - the replacement operator `[` in general doesn't
>> update the left had side like my wild imagination might allow.  It's just a
>> function and so it must make a copy of the input.
>>
>> This note seen here ?`[` sort of points out the issue... "Subassignment
>> is done sequentially, so if an index is specified more than once the latest
>> assigned value for an index will result."  Between that, the phase of the
>> moon and the pass-by-value stuff my brain starts to jumble.
>>
>> On the other hand, if you have dependable indices and are simply
>> incrementing you can leverage table() for your purpose.
>>
>> x <- rep(0,5)
>> i <- c(1,1,1,4)
>> ti <- table(i)
>> tindex <- as.numeric(names(ti))
>> x[tindex] <- x[tindex] + ti
>>
>> Likewise for raster
>>
>> library(raster)
>> r <- raster(ncol=5,nrow=5)
>> r[] <- 0
>> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
>> tvec <- table(vec)
>> tindex <- as.integer(names(tvec))
>> r[tindex] <- r[tindex] + tvec
>>
>> I hope there are smarter/faster ways, but in the meantime it might speed
>> things along for you.
>>
>>
>> Ben
>>
>>
>> > On Jul 10, 2016, at 3:34 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
>> >
>> > Dear R-users,
>> > I am trying to add +1 to the cell value of certain cells in a raster. I
>> have the cell numbers of the cells on which I'd like to perform said
>> computation saved in a vector. I have a working code but with a large
>> vector and raster it takes ages:
>> >
>> > r <- raster(ncol=5,nrow=5)
>> > r[] <- 0
>> > vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
>> > for(i in 1:length(vec))
>> > {
>> > r[vec[i]] <- r[vec[i]] + 1
>> > }
>> >
>> > I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work
>> properly, it just sets the values of the cells stored in the vector to 1.
>> Does anybody know a faster way to do this ? Thanks in advance!
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>>
>> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or
>> tweet them to #MaineJellies -- include date, time, and location, as well as
>> any descriptive information such as size or type.  Learn more at
>> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org
> or tweet them to #MaineJellies -- include date, time, and location, as well
> as any descriptive information such as size or type.  Learn more at
> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>
>

	[[alternative HTML version deleted]]


From ruettenauer at sowi.uni-kl.de  Mon Jul 11 11:13:10 2016
From: ruettenauer at sowi.uni-kl.de (=?iso-8859-1?Q?Tobias_R=FCttenauer?=)
Date: Mon, 11 Jul 2016 11:13:10 +0200
Subject: [R-sig-Geo] Graph of attribute per postal code
In-Reply-To: <DB5PR06MB1256339EB1F52E56BA13B53BD93C0@DB5PR06MB1256.eurprd06.prod.outlook.com>
References: <DB5PR06MB1256339EB1F52E56BA13B53BD93C0@DB5PR06MB1256.eurprd06.prod.outlook.com>
Message-ID: <001801d1db54$71f8c680$55ea5380$@sowi.uni-kl.de>

Dear Isa-May,

I think the easiest way is to use the choropleth command of the GISTools
package (ggplot is another option). However, you have to transform your
dataframe into a SpatialPolygonsDataFrame. That means you need to merge your
dataframe to a shapefile or some other spatial projection of Belgium (see
package sp).

You can find some examples for choropleth mapping here:
https://rpubs.com/chrisbrunsdon/958

To include four different graphs in one plot you have to set the graphical
parameters to par(mfrow=c(2,2)):

library(GISTools)
data(georgia)

shades1 <- auto.shading(georgia$MedInc, n = 6, cutter = rangeCuts, cols =
brewer.pal(6, 
 
"Greens"))
shades2 <- auto.shading(georgia$PctBlack, n = 6, cutter = rangeCuts, cols =
brewer.pal(6, 
 
"Blues"))
shades3 <- auto.shading(georgia$PctPov, n = 6, cutter = rangeCuts, cols =
brewer.pal(6, 
 
"Reds"))
shades4 <- auto.shading(georgia$PctEld, n = 6, cutter = rangeCuts, cols =
brewer.pal(6, 
 
"Greys"))

par(mfrow=c(2,2),oma=c(0,0,0,0), mar=c(0,0,0,0))   # 2 graphs per col, 2
graphs per row, no margins

choropleth(georgia, georgia$MedInc, shades1)
choro.legend(-82, 35.27, shades1, title = "MedInc", cex=0.8, bty="n")

choropleth(georgia, georgia$PctBlack, shades2)
choro.legend(-82, 35.27, shades2, title = "PctBlack", cex=0.8, bty="n")

choropleth(georgia, georgia$PctPov, shades3)
choro.legend(-82, 35.27, shades3, title = "PctPov", cex=0.8, bty="n")

choropleth(georgia, georgia$PctEld, shades4)
choro.legend(-82, 35.27, shades4, title = "PctEld", cex=0.8, bty="n")

par(mfrow=c(1,1))

A very good introduction to spatial mapping can be found in Brunsdon &
Comber (2015): "An indroduction to R for spatial analysis and mapping",
Sage.

Best
Tobias



> -----Urspr?ngliche Nachricht-----
> Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von
Isa-
> May Kennes
> Gesendet: 09 July 2016 00:31
> An: r-sig-geo at r-project.org
> Betreff: [R-sig-Geo] Graph of attribute per postal code
> 
> Dear all,
> 
> 
> I am quite new to R and have a question related to making graphs based on
> postal codes.
> 
> I have a dateset in which each element has a postal code in Belgium,
> dataset$zip. There are some other attributes like the exposure in days,
> dataset$exposure.
> 
> I would like to make a plot of the map of Belgium, with for different
ranges of
> exposures different colors per postal code. It could for example resemble
> something like this (not the upper right graph):
> 
> [http://www.eurosurveillance.org/images/dynamic/EE/V20N01/Hens_fig2.png]
> 
> 
> How can I achieve this?
> 
> 
> Thanks in advance,
> 
> Bestregards,
> 
> Isa-May
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From loic.dutrieux at wur.nl  Mon Jul 11 15:13:54 2016
From: loic.dutrieux at wur.nl (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Mon, 11 Jul 2016 15:13:54 +0200
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <CAKkiGbsNfYbrE4SwOiQsNqXVPXJnv+yHop5H7pv6Paz_ff1peg@mail.gmail.com>
References: <trinity-cb6c0788-43d0-44f1-8078-c34296ccf47a-1468179280242@3capp-gmx-bs59>
	<6A787763-0392-46C2-98E8-16A4E0D4353C@bigelow.org>
	<CAKkiGbt=1m5dNeY-hk2UQvLpV+EU_Z-P9sLJKjupfi_EvsYxGw@mail.gmail.com>
	<E62FD6B5-D75C-4BF3-B60F-2AA22F6C1CD5@bigelow.org>
	<CAKkiGbsNfYbrE4SwOiQsNqXVPXJnv+yHop5H7pv6Paz_ff1peg@mail.gmail.com>
Message-ID: <57839B92.6080702@wur.nl>

This works fine for me:

library(raster)

r <- raster(ncol=5,nrow=5)
r[] <- 0
vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
a <- data.frame(table(vec))
a$vec <- as.numeric(a$vec) # Not very elegant coercion, there must be a 
better way
r[a$vec] <- r[a$vec] + a$Freq[a$vec]

Cheers,
Lo?c

On 07/11/2016 02:58 AM, Vijay Lulla wrote:
> OOPS!  I appear to have misunderstood the question then, Ben.  I'm unsure
> how to increment a particular cell more than once.
>
> Please pardon the noise.
>
> On Sun, Jul 10, 2016 at 7:54 PM, Ben Tupper <btupper at bigelow.org> wrote:
>
>> Hi,
>>
>> Interesting.  How would you use the matrix approach to increment a
>> particular cell more than once with a single subassignment?  If I repeat
>> the upper left raster coord in the matrix 3 times it still yields a value
>> of 1 up there.
>>
>> library(raster)
>> r <- raster(nrows=5,ncols=5)
>> r[] <- 0
>> idx <- matrix(c(1,1,1,1,1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE)
>> r[idx] <- r[idx] + 1
>> plot(r)
>> range(getValues(r))
>> #[1] 0 1
>>
>> I could be misreading the original posting, but I think the desire is that
>> the result will be increment for each repeated index using just one
>> subassignment.
>>
>> Cheers,
>> Ben
>>
>>
>> On Jul 10, 2016, at 6:45 PM, Vijay Lulla <vijaylulla at gmail.com> wrote:
>>
>> Maybe something like this?
>>
>> R> r <- raster(nrows=5,ncols=5)
>> R> r[] <- 0
>> R> idx <- matrix(c(1,1,1,5,5,1,5,5),ncol=2,byrow=TRUE) # four corners of
>> the raster!
>> R> r[idx] <- r[idx] + 1
>> R> image(r)
>>
>>  From R's ?`[` : When indexing arrays by '[' a single argument 'i' can be a
>> matrix with as many columns as there are dimensions of 'x'; the result is
>> then a vector with elements corresponding to the sets of indices in each
>> row of 'i'.
>>
>>
>> On Sun, Jul 10, 2016 at 5:59 PM, Ben Tupper <btupper at bigelow.org> wrote:
>>
>>> Hi,
>>>
>>> I stub my toe on this all the time (and wish I didn't).  The behavior
>>> isn't limited to raster - the replacement operator `[` in general doesn't
>>> update the left had side like my wild imagination might allow.  It's just a
>>> function and so it must make a copy of the input.
>>>
>>> This note seen here ?`[` sort of points out the issue... "Subassignment
>>> is done sequentially, so if an index is specified more than once the latest
>>> assigned value for an index will result."  Between that, the phase of the
>>> moon and the pass-by-value stuff my brain starts to jumble.
>>>
>>> On the other hand, if you have dependable indices and are simply
>>> incrementing you can leverage table() for your purpose.
>>>
>>> x <- rep(0,5)
>>> i <- c(1,1,1,4)
>>> ti <- table(i)
>>> tindex <- as.numeric(names(ti))
>>> x[tindex] <- x[tindex] + ti
>>>
>>> Likewise for raster
>>>
>>> library(raster)
>>> r <- raster(ncol=5,nrow=5)
>>> r[] <- 0
>>> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
>>> tvec <- table(vec)
>>> tindex <- as.integer(names(tvec))
>>> r[tindex] <- r[tindex] + tvec
>>>
>>> I hope there are smarter/faster ways, but in the meantime it might speed
>>> things along for you.
>>>
>>>
>>> Ben
>>>
>>>
>>>> On Jul 10, 2016, at 3:34 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
>>>>
>>>> Dear R-users,
>>>> I am trying to add +1 to the cell value of certain cells in a raster. I
>>> have the cell numbers of the cells on which I'd like to perform said
>>> computation saved in a vector. I have a working code but with a large
>>> vector and raster it takes ages:
>>>>
>>>> r <- raster(ncol=5,nrow=5)
>>>> r[] <- 0
>>>> vec <- c(1,1,1,3,4,5,6,7,8,8,8,9)
>>>> for(i in 1:length(vec))
>>>> {
>>>> r[vec[i]] <- r[vec[i]] + 1
>>>> }
>>>>
>>>> I have already tried to use r[vec] <- r[vec] + 1 but that doesn't work
>>> properly, it just sets the values of the cells stored in the vector to 1.
>>> Does anybody know a faster way to do this ? Thanks in advance!
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> Ben Tupper
>>> Bigelow Laboratory for Ocean Sciences
>>> 60 Bigelow Drive, P.O. Box 380
>>> East Boothbay, Maine 04544
>>> http://www.bigelow.org
>>>
>>> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or
>>> tweet them to #MaineJellies -- include date, time, and location, as well as
>>> any descriptive information such as size or type.  Learn more at
>>> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>>
>> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org
>> or tweet them to #MaineJellies -- include date, time, and location, as well
>> as any descriptive information such as size or type.  Learn more at
>> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From TinaACormier at gmail.com  Mon Jul 11 17:26:25 2016
From: TinaACormier at gmail.com (Tina Cormier)
Date: Mon, 11 Jul 2016 11:26:25 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
In-Reply-To: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>
References: <CAFfx76-ty8G6GhUGps3hnC2tY56WyPVrhxnePD0CmV4Nvh4S6A@mail.gmail.com>
Message-ID: <CAFfx76_LTnDhZ3TBZ5_s5PLGnAPqi8Zhs0SCCFNU7+qX0W27Pg@mail.gmail.com>

Wow! I'm humbled that you all took the time to help me out! You had great
suggestions and sent along some very handy functions. I have the idea now
of what I need to do - find the longest distance between two points in the
cluster, the midpoint of that line is the center of the circle, and there
are numerous ways to create the circle, but once you have the radius, you
can just buffer the center point. Fantastically simple. Someone also
suggested using PostGIS (ST_MinimumBoundingCircle), which I will definitely
try. I have a postgreSQL db that I use for some simple stuff, and I'm not a
guru by any means, but this will help me gain a little more experience.

Thank you again, and I can't wait to pay if forward the next time someone
asks about a topic I know well!

Cheers,
Tina
***********************************************************************
In SUMMARY, functions that solve this problem are listed below:

1. Using a *3-liner* from Robert Hijmans, using optimization:
library(raster)
library(rgeos)

set.seed(7)
n <- 4
xy <- cbind(runif(n), runif(n))




*f <- function(p) { max(pointDistance(rbind(p), xy, lonlat=FALSE)) }p <-
optim(colMeans(xy), f)cc <- buffer(SpatialPoints(rbind(p$par)),
width=p$value, quadsegs=45)*
plot(cc)
points(xy, pch=20, cex=1.5)
points(rbind(p$par), pch='*', col='red', cex=3)
lines(rbind(p$par, c(p$par[1]+p$value, p$par[2])), col='blue', lwd=2, lty=2)
text(p$par[1]+0.5*p$value, p$par[2], paste("radius =", round(p$value,
2)), pos=3, cex=.85)
text(p$par[1], p$par[2], labels=paste0("(",paste(round(p$par, 2),
collapse=", "), ")"), pos=1, cex=.75)
***********************************************************************

2. A function from Adrian Baddeley using spatstat
library(spatstat)

circumcircle <- function(x, ...) {   UseMethod("circumcircle") }

circumcircle.owin <- function(x, ...) {
  d2 <- fardist(x, ..., squared=TRUE)
  z <- where.min(d2)
  r <- sqrt(min(d2))
  w <- disc(centre=z, radius=r)
  return(w)
}

circumcircle.ppp <- function(x, ...) {
  circumcircle(convexhull(x))
}
***********************************************************************

3. A handy link that walks through the process in a bit longer way around,
but still works:
http://www.uni-kiel.de/psychologie/rexrepos/posts/diagBounding.html


On Fri, Jul 8, 2016 at 10:31 AM, Tina Cormier <TinaACormier at gmail.com>
wrote:

> Hi all,
>
> Looking for help aggregating some field data subplots to the plot level
> (data currently in shapefile format). I have clusters of 4 points (4
> subplots = 1 plot). I'd like to create a circle around each cluster that is
> the smallest circle that would encompass all 4 points. Sort of like a
> convex hull, but a circle (convex hull, in this case, would give me a
> triangle because of the layout of the subplots). I am familiar with (and
> use frequently) the typical geo packages in R - with rgdal, sp, raster, and
> maptools being my most frequent flyers. Is there a function I'm missing in
> these (or some other) packages that might be able to help me out? In the
> attribute table, I have a unique ID for each plot/cluster. So for each plot
> ID (in this case, consisting of 4 subplots), I'd like to build a circle
> around all of the subplots.
>
> > str(pts)
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>   ..@ data       :'data.frame': 160 obs. of  12 variables:
>   .. ..$ Plot      : num [1:160] 1 1 1 1 2 2 2 2 3 3 ...
>   .. ..$ Subplot   : num [1:160] 1 2 3 4 1 2 3 4 1 2 ...
>
> I should also mention that it's not always 4 points (subplots), and they
> aren't always covering the same size area on the ground, so buffering by a
> constant distance isn't the answer. I have subset out 3 plots (so 12
> subplots) into a test file here:
> https://dl.dropboxusercontent.com/u/72421241/test_subplotsToPlots.zip
>
> I have R version 3.3.0. I know it's customary to include code for what
> I've tried, buuuut, that would be a blank canvas at this point. Googling
> hasn't really been fruitful for this issue, so I thought you folks might
> have some good ideas!
>
> Thanks,
> Tina
>

	[[alternative HTML version deleted]]


From Giacomo_May94 at gmx.de  Mon Jul 11 18:21:54 2016
From: Giacomo_May94 at gmx.de (Giacomo May)
Date: Mon, 11 Jul 2016 18:21:54 +0200
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
Message-ID: <trinity-de2803c4-0eb3-4045-9c51-160fd4ca1986-1468254113875@3capp-gmx-bs22>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160711/66e37844/attachment.html>

From btupper at bigelow.org  Mon Jul 11 18:33:57 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Mon, 11 Jul 2016 12:33:57 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <trinity-de2803c4-0eb3-4045-9c51-160fd4ca1986-1468254113875@3capp-gmx-bs22>
References: <trinity-de2803c4-0eb3-4045-9c51-160fd4ca1986-1468254113875@3capp-gmx-bs22>
Message-ID: <454A0EE2-BF9E-45A3-BBE2-8C08882F1733@bigelow.org>

Hi Giacomo,

I am interested to know which you find fastest - perhaps you could let us know some timing results?

Thanks,
Ben

> On Jul 11, 2016, at 12:21 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
> 
> Thanks for all the replies. In case anyone is interested, I asked the same question on stackexchange and got the following answer:
> 
> library(dplyr)
> cel <- data_frame(cell = vec)
> tab <- cel %>% group_by(cell) %>% summarize(val = n())
> ## update your raster
> r[tab$cell] <- tab$val
> 
> I will try the soultions you guys suggested as well, thanks a lot again !
> Best,
> Giacomo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


	[[alternative HTML version deleted]]


From Giacomo_May94 at gmx.de  Mon Jul 11 19:21:52 2016
From: Giacomo_May94 at gmx.de (Giacomo May)
Date: Mon, 11 Jul 2016 19:21:52 +0200
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <454A0EE2-BF9E-45A3-BBE2-8C08882F1733@bigelow.org>
References: <trinity-de2803c4-0eb3-4045-9c51-160fd4ca1986-1468254113875@3capp-gmx-bs22>,
	<454A0EE2-BF9E-45A3-BBE2-8C08882F1733@bigelow.org>
Message-ID: <trinity-fd0abcf2-e77f-4ca5-83ef-115c0db075e1-1468257712583@3capp-gmx-bs22>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160711/2cc1d823/attachment.html>

From btupper at bigelow.org  Mon Jul 11 23:33:04 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Mon, 11 Jul 2016 17:33:04 -0400
Subject: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
In-Reply-To: <trinity-fd0abcf2-e77f-4ca5-83ef-115c0db075e1-1468257712583@3capp-gmx-bs22>
References: <trinity-de2803c4-0eb3-4045-9c51-160fd4ca1986-1468254113875@3capp-gmx-bs22>
	<454A0EE2-BF9E-45A3-BBE2-8C08882F1733@bigelow.org>
	<trinity-fd0abcf2-e77f-4ca5-83ef-115c0db075e1-1468257712583@3capp-gmx-bs22>
Message-ID: <499D7E18-5B57-4859-89A0-5A10F638BAB7@bigelow.org>

Hi,

dplyr is faster for larger datasets compared to using table.  I tried adjusting the value of n below and for larger n (my typical situtation) dplyr stayed very fast while tablulate/table took more time.  

A good lesson for me - start using dplyr everyday!

Thanks,
Ben

library(raster)
library(dplyr)

# @param r raster
# @param cells cell indices to be incremented, repeats are honored
# @return updated raster
increment_by_tabulate <- function(r, cells){
   n <- ncell(r)
   tbl <- tabulate(cells, n)
   tcell <- 1:n
   r[tcell] <- r[tcell] + tbl
   r
}

# @param r raster
# @param cells cell indices to be incremented, repeats are honored
# @return updated raster
increment_by_table <- function(r, cells){
   tbl <- table(cells)
   tcell <- as.integer(names(tbl))
   r[tcell] <- r[tcell] + tbl
   r
}

# @param r raster
# @param cells cell indices to be incremented, repeats are honored
# @return updated raster
increment_by_dplyr <- function(r, cells){
   cel <- data_frame(cell = cells)
   tab <- cel %>% group_by(cell) %>% summarize(val = n())
   r[tab$cell] <- tab$val
   r
}

n <- 500
r <- raster(ncol=n,nrow=n)
r[] <- 0
cells <- sample(1:(n*n), 2*n*n, replace = TRUE)
system.time( r1 <- increment_by_tabulate(r, cells) )
system.time( r2 <- increment_by_table(r, cells) )
system.time( r3 <- increment_by_dplyr(r, cells) )
identical(r1,r2)
identical(r1,r3)

> On Jul 11, 2016, at 1:21 PM, Giacomo May <Giacomo_May94 at gmx.de> wrote:
> 
> Hi Ben,
> I am happy if I can be of help. So I have tried the two suggestions (one from stackexchange, which i provided, and one from the mailing list, from Loic to be exact) and the only one working properly was the one from stackexchange. it was very fast, it took 1 second max. If you want me to try anything else out for you just let me know.
> best,
> Giacomo
>  
> Gesendet: Montag, 11. Juli 2016 um 18:33 Uhr
> Von: "Ben Tupper" <btupper at bigelow.org>
> An: "Giacomo May" <Giacomo_May94 at gmx.de>
> Cc: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] Add +1 to current value of a cell in a raster in R
> Hi Giacomo,
>  
> I am interested to know which you find fastest - perhaps you could let us know some timing results?
>  
> Thanks,
> Ben
>  
> On Jul 11, 2016, at 12:21 PM, Giacomo May <Giacomo_May94 at gmx.de <>> wrote:
>  
> Thanks for all the replies. In case anyone is interested, I asked the same question on stackexchange and got the following answer:
> 
> library(dplyr)
> cel <- data_frame(cell = vec)
> tab <- cel %>% group_by(cell) %>% summarize(val = n())
> ## update your raster
> r[tab$cell] <- tab$val
> 
> I will try the soultions you guys suggested as well, thanks a lot again !
> Best,
> Giacomo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo> 
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org <http://www.bigelow.org/>
>  
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org <> or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/ <https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/>_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


	[[alternative HTML version deleted]]


From fe.gimeno at gmail.com  Mon Jul 11 23:48:12 2016
From: fe.gimeno at gmail.com (Fernando Gimeno)
Date: Mon, 11 Jul 2016 18:48:12 -0300
Subject: [R-sig-Geo] extract value of raster attribute with polygon
Message-ID: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>

i have a raster with attribute table and i need extract values with a
polygon. Help me please.

COMUNAS<-shapefile("COMUNAS.shp")
RAST<-raster("raster_23052016/for_GDB/comb_viii.tif")

COMUNAS<-spTransform(COMUNAS,CRS("+proj=utm +zone=18 +south +ellps=WGS84
+datum=WGS84 +units=m +no_defs"))

dbf<-read.dbf("raster_23052016/for_GDB/comb_viii.tif.vat.dbf")

r <- ratify(RAST)
rat <- levels(r)[[1]]
rat<-c(rat,dbf)
rat<-as.data.frame(rat)
levels(r) <- rat

COMUNAS$BAL_CO2_CO <- extract(r, COMUNAS, fun = sum, na.rm = TRUE)

-- 
*Fernando J. Gimeno Molina*
*Licenciado en Geograf?a, Universidad de Chile*
*Ge?grafo, Universidad de Chile*
*Mc(c) Gesti?n y Planificaci?n Ambiental, Universidad de Chile*
*Diploma en Geom?tica Aplicada, Universidad de Chile*

	[[alternative HTML version deleted]]


From adrian.baddeley at curtin.edu.au  Tue Jul 12 03:06:16 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Tue, 12 Jul 2016 01:06:16 +0000
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
 (Tina Cormier)
In-Reply-To: <CAL-PXjBLZO5MOd-a+4E6UdV32ggnd=xqt9aVOTkW8qNn-cfLmA@mail.gmail.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
	<CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
	<CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>,
	<CAL-PXjBLZO5MOd-a+4E6UdV32ggnd=xqt9aVOTkW8qNn-cfLmA@mail.gmail.com>
Message-ID: <SG2PR02MB1373D0BF031083EFBE1B79AEA4300@SG2PR02MB1373.apcprd02.prod.outlook.com>

Tina Cormier <tinaacormier at gmail.com> writes:


> I have the idea now of what I need to do -

> find the longest distance between two points in the cluster,

> the midpoint of that line is the center of the circle,


Sorry, but that is not right.


The circumcircle of a set of points must pass through 3 of the points (if there are at least 3 points). The circumradius is not equal to the maximum distance between all pairs of points.


Think of an equilateral triangle: three points, each pair separated by the same distance 's'.


The circumcentre (the centre of the minimal circle) is the point at the centre of the triangle.

The circumradius is s/sqrt(3), not s/2.


Adrian


Prof Adrian Baddeley DSc FAA

Department of Mathematics and Statistics

Curtin University, Perth, Western Australia


________________________________
From: Tina Cormier <tinaacormier at gmail.com>
Sent: Monday, 11 July 2016 11:15 PM
To: Michael Sumner
Cc: chris english; Bacou, Melanie; Adrian Baddeley; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Minimum bounding circle from cluster of points (Tina Cormier)

Wow! I'm humbled that you all took the time to help me out! You had great suggestions and sent along some very handy functions. I have the idea now of what I need to do - find the longest distance between two points in the cluster, the midpoint of that line is the center of the circle, and there are numerous ways to create the circle, but once you have the radius, you can just buffer it. Fantastically simple. Someone also suggested using PostGIS (ST_MinimumBoundingCircle), which I will definitely try. I have a postgreSQL db that I use for some simple stuff, and I'm not a guru by any means, but this will help me gain a little more experience.

Thank you again, and I can't wait to pay if forward the next time someone asks about a topic I know well!

Cheers,
Tina


	[[alternative HTML version deleted]]


From mel at mbacou.com  Tue Jul 12 03:38:10 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Mon, 11 Jul 2016 21:38:10 -0400
Subject: [R-sig-Geo] extract value of raster attribute with polygon
In-Reply-To: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>
References: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>
Message-ID: <bf697ca7-23a2-fe32-7703-fc335462b4d6@mbacou.com>

Simply refer to the documentation for `raster::extract(..., factors=TRUE)`.

http://www.inside-r.org/packages/cran/raster/docs/extract

--Mel.


On 7/11/2016 5:48 PM, Fernando Gimeno wrote:
> i have a raster with attribute table and i need extract values with a
> polygon. Help me please.
>
> COMUNAS<-shapefile("COMUNAS.shp")
> RAST<-raster("raster_23052016/for_GDB/comb_viii.tif")
>
> COMUNAS<-spTransform(COMUNAS,CRS("+proj=utm +zone=18 +south +ellps=WGS84
> +datum=WGS84 +units=m +no_defs"))
>
> dbf<-read.dbf("raster_23052016/for_GDB/comb_viii.tif.vat.dbf")
>
> r <- ratify(RAST)
> rat <- levels(r)[[1]]
> rat<-c(rat,dbf)
> rat<-as.data.frame(rat)
> levels(r) <- rat
>
> COMUNAS$BAL_CO2_CO <- extract(r, COMUNAS, fun = sum, na.rm = TRUE)
>


From mel at mbacou.com  Tue Jul 12 04:07:13 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Mon, 11 Jul 2016 22:07:13 -0400
Subject: [R-sig-Geo] extract value of raster attribute with polygon
In-Reply-To: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>
References: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>
Message-ID: <36d63414-35f1-47dd-6adb-9b4bcf3703b9@mbacou.com>

Also when summarizing classified rasters, it is usual to use the `mode` 
function (instead of `sum`) since you're typically interested in the 
dominant class.


On 7/11/2016 5:48 PM, Fernando Gimeno wrote:
> i have a raster with attribute table and i need extract values with a
> polygon. Help me please.
>
> COMUNAS<-shapefile("COMUNAS.shp")
> RAST<-raster("raster_23052016/for_GDB/comb_viii.tif")
>
> COMUNAS<-spTransform(COMUNAS,CRS("+proj=utm +zone=18 +south +ellps=WGS84
> +datum=WGS84 +units=m +no_defs"))
>
> dbf<-read.dbf("raster_23052016/for_GDB/comb_viii.tif.vat.dbf")
>
> r <- ratify(RAST)
> rat <- levels(r)[[1]]
> rat<-c(rat,dbf)
> rat<-as.data.frame(rat)
> levels(r) <- rat
>
> COMUNAS$BAL_CO2_CO <- extract(r, COMUNAS, fun = sum, na.rm = TRUE)
>


From fe.gimeno at gmail.com  Tue Jul 12 21:22:04 2016
From: fe.gimeno at gmail.com (Fernando Gimeno)
Date: Tue, 12 Jul 2016 16:22:04 -0300
Subject: [R-sig-Geo] extract value of raster attribute with polygon
In-Reply-To: <36d63414-35f1-47dd-6adb-9b4bcf3703b9@mbacou.com>
References: <CACs6gjWzfKobEqukeMDckUYCSzpXdg1P4HVsz-A6PHvvxo7Zog@mail.gmail.com>
	<36d63414-35f1-47dd-6adb-9b4bcf3703b9@mbacou.com>
Message-ID: <CACs6gjW1utpF9WdVeg8Cj9=KaZHJ9fFiOHGF6E54MDLqqXP_GA@mail.gmail.com>

many thank.

i have a raster with attribute table of seven attributes, i want only
extract the sum value of one attribute with a poligon. I need assign value
in attribute table for those  poligon

2016-07-11 23:07 GMT-03:00 Bacou, Melanie <mel at mbacou.com>:

> Also when summarizing classified rasters, it is usual to use the `mode`
> function (instead of `sum`) since you're typically interested in the
> dominant class.
>
>
> On 7/11/2016 5:48 PM, Fernando Gimeno wrote:
>
>> i have a raster with attribute table and i need extract values with a
>> polygon. Help me please.
>>
>> COMUNAS<-shapefile("COMUNAS.shp")
>> RAST<-raster("raster_23052016/for_GDB/comb_viii.tif")
>>
>> COMUNAS<-spTransform(COMUNAS,CRS("+proj=utm +zone=18 +south +ellps=WGS84
>> +datum=WGS84 +units=m +no_defs"))
>>
>> dbf<-read.dbf("raster_23052016/for_GDB/comb_viii.tif.vat.dbf")
>>
>> r <- ratify(RAST)
>> rat <- levels(r)[[1]]
>> rat<-c(rat,dbf)
>> rat<-as.data.frame(rat)
>> levels(r) <- rat
>>
>> COMUNAS$BAL_CO2_CO <- extract(r, COMUNAS, fun = sum, na.rm = TRUE)
>>
>>
>


-- 
*Fernando J. Gimeno Molina*
*Licenciado en Geograf?a, Universidad de Chile*
*Ge?grafo, Universidad de Chile*
*Mc(c) Gesti?n y Planificaci?n Ambiental, Universidad de Chile*
*Diploma en Geom?tica Aplicada, Universidad de Chile*

	[[alternative HTML version deleted]]


From arilamstein at gmail.com  Wed Jul 13 17:22:55 2016
From: arilamstein at gmail.com (arilamstein at gmail.com)
Date: Wed, 13 Jul 2016 08:22:55 -0700
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
Message-ID: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>

Hi everyone,

I wanted to let people here know that I am sponsoring the "R Shapefile
Contest":

http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/

For the last few years I've done a lot of work with creating choropleth
maps of government datasets. But I've also felt a bit limited, in that I
don't know the full range of analyses that R can do with shapefiles.

I'm hoping that this contest can get a lot of submissions which really show
off the types of analyses that can be done with R and shapefiles.

If you have the time and interest, please consider submitting an entry! If
you would like to support the contest but aren't able to submit an entry
yourself, please considering sharing news about it with your colleagues,
via social media, etc.

Ari

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Wed Jul 13 19:44:28 2016
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 13 Jul 2016 18:44:28 +0100
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
Message-ID: <CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>

On Wed, Jul 13, 2016 at 4:22 PM,  <arilamstein at gmail.com> wrote:
> Hi everyone,
>
> I wanted to let people here know that I am sponsoring the "R Shapefile
> Contest":
>
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/
>
> For the last few years I've done a lot of work with creating choropleth
> maps of government datasets. But I've also felt a bit limited, in that I
> don't know the full range of analyses that R can do with shapefiles.
>
> I'm hoping that this contest can get a lot of submissions which really show
> off the types of analyses that can be done with R and shapefiles.

 I have a brilliant analysis I would have loved to submit to this
contest but the agency from which I got the data has been enlightened
enough not to use the clunky, outdated, and limited "shapefile" format
and has released the data as a modern, OGC-standard GeoPackage. My
variables have long names, my metadata is stored with my data, and its
all in one file instead of six. But sadly, because you limit the
contest with "The analysis must ... do something with a shapefile" I
can't compete.

 Shapefiles are an awful, awful format which Esri didn't think people
would actually use. They should not be encouraged. Maybe I'll start a
GeoPackage contest. Or you could just have a geospatial vector data
contest and not discriminate against data formats.

Barry


From Lars-Daniel.Weber at gmx.de  Thu Jul 14 02:19:34 2016
From: Lars-Daniel.Weber at gmx.de (Lars-Daniel Weber)
Date: Thu, 14 Jul 2016 02:19:34 +0200
Subject: [R-sig-Geo] paid statistic service?
Message-ID: <trinity-9df0350c-a200-41ea-9a16-314ec0faa69c-1468455574890@3capp-gmx-bs13>

Hi there,

I really need help with my paper... can anyone tell me a paid statistic service?
All the statisticans I've talked do, doesn't have a clue about "geo".

Maybe I don't need spatial information at all ... but I'm neither a statistican,
nor do the papers on the web help me to figure this out.

You can send me a private E-Mail with offers. The results of the paper
(R-code, SQL code etc.) will be published as OpenSource of course.

Best regards,
Lars-Daniel Weber


From englishchristophera at gmail.com  Thu Jul 14 17:43:43 2016
From: englishchristophera at gmail.com (chris english)
Date: Thu, 14 Jul 2016 18:43:43 +0300
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
Message-ID: <CAASFQpSGDmkXyVD93S0BH=5Y4v=F+H4B6p0P=pRLa3urNZPumQ@mail.gmail.com>

? have less brilliant analysis but tend like others to think that the
future may not/should not shape up as shapefiles.

Chris
On Jul 13, 2016 20:44, "Barry Rowlingson" <b.rowlingson at lancaster.ac.uk>
wrote:

> On Wed, Jul 13, 2016 at 4:22 PM,  <arilamstein at gmail.com> wrote:
> > Hi everyone,
> >
> > I wanted to let people here know that I am sponsoring the "R Shapefile
> > Contest":
> >
> >
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/
> >
> > For the last few years I've done a lot of work with creating choropleth
> > maps of government datasets. But I've also felt a bit limited, in that I
> > don't know the full range of analyses that R can do with shapefiles.
> >
> > I'm hoping that this contest can get a lot of submissions which really
> show
> > off the types of analyses that can be done with R and shapefiles.
>
>  I have a brilliant analysis I would have loved to submit to this
> contest but the agency from which I got the data has been enlightened
> enough not to use the clunky, outdated, and limited "shapefile" format
> and has released the data as a modern, OGC-standard GeoPackage. My
> variables have long names, my metadata is stored with my data, and its
> all in one file instead of six. But sadly, because you limit the
> contest with "The analysis must ... do something with a shapefile" I
> can't compete.
>
>  Shapefiles are an awful, awful format which Esri didn't think people
> would actually use. They should not be encouraged. Maybe I'll start a
> GeoPackage contest. Or you could just have a geospatial vector data
> contest and not discriminate against data formats.
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From bob at rudis.net  Thu Jul 14 19:14:13 2016
From: bob at rudis.net (boB Rudis)
Date: Thu, 14 Jul 2016 13:14:13 -0400
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
Message-ID: <CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>

IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
means it can read GeoPackage files. If that's true, then I'm sure Ari
wldn't mind it being classified as a "shapefile".

Barry: (this is in lieu of a google search on my part after work) do
you have any links to some public GeoPackage files handy to paste?

On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> OGC-standard GeoPackage


From Roger.Bivand at nhh.no  Thu Jul 14 19:36:48 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Jul 2016 17:36:48 +0000
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>,
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
Message-ID: <4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>

The CRAN Windows and OSX rgdal binaries have supported GPKG for some time now. It would be great to give the driver some traction.

Roger

Roger Bivand
Norwegian School of Economics
Bergen, Norway



On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net<mailto:bob at rudis.net>> wrote:

IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
means it can read GeoPackage files. If that's true, then I'm sure Ari
wldn't mind it being classified as a "shapefile".

Barry: (this is in lieu of a google search on my part after work) do
you have any links to some public GeoPackage files handy to paste?

On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> OGC-standard GeoPackage

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From bob at rudis.net  Thu Jul 14 19:39:53 2016
From: bob at rudis.net (boB Rudis)
Date: Thu, 14 Jul 2016 13:39:53 -0400
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
	<4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
Message-ID: <CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>

Escaped a meeting and saw that there are sample files on the geopkg site.

I'll do my best (tho I'm not nearly as skilled & geo-connected as
Roger, Barry, et al) to blog the heck out of this format. It's insane
that shp is so prevalent. This is a super nice format.

On Thu, Jul 14, 2016 at 1:36 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> The CRAN Windows and OSX rgdal binaries have supported GPKG for some time
> now. It would be great to give the driver some traction.
>
> Roger
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
>
>
>
> On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net> wrote:
>
> IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
> means it can read GeoPackage files. If that's true, then I'm sure Ari
> wldn't mind it being classified as a "shapefile".
>
> Barry: (this is in lieu of a google search on my part after work) do
> you have any links to some public GeoPackage files handy to paste?
>
> On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>> OGC-standard GeoPackage
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From arilamstein at gmail.com  Thu Jul 14 20:50:34 2016
From: arilamstein at gmail.com (arilamstein at gmail.com)
Date: Thu, 14 Jul 2016 11:50:34 -0700
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
	<4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
	<CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>
Message-ID: <CAEO2kuKJ_Vq0sQqZjXKFK8PWUgpFmLUJk+E+YrZ4GEbpfrWprA@mail.gmail.com>

I have updated the contest page to clarify that entries that use the
GeoPackage format are welcome:

http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update

On Thu, Jul 14, 2016 at 10:39 AM, boB Rudis <bob at rudis.net> wrote:

> Escaped a meeting and saw that there are sample files on the geopkg site.
>
> I'll do my best (tho I'm not nearly as skilled & geo-connected as
> Roger, Barry, et al) to blog the heck out of this format. It's insane
> that shp is so prevalent. This is a super nice format.
>
> On Thu, Jul 14, 2016 at 1:36 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > The CRAN Windows and OSX rgdal binaries have supported GPKG for some time
> > now. It would be great to give the driver some traction.
> >
> > Roger
> >
> > Roger Bivand
> > Norwegian School of Economics
> > Bergen, Norway
> >
> >
> >
> >
> > On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net>
> wrote:
> >
> > IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
> > means it can read GeoPackage files. If that's true, then I'm sure Ari
> > wldn't mind it being classified as a "shapefile".
> >
> > Barry: (this is in lieu of a google search on my part after work) do
> > you have any links to some public GeoPackage files handy to paste?
> >
> > On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
> > <b.rowlingson at lancaster.ac.uk> wrote:
> >> OGC-standard GeoPackage
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From stachel2 at msu.edu  Thu Jul 14 22:00:48 2016
From: stachel2 at msu.edu (stachel2 at msu.edu)
Date: Thu, 14 Jul 2016 16:00:48 -0400
Subject: [R-sig-Geo] Annoucing the R Shapefile Contest
Message-ID: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>

I wrote a **very** elementary blog post showing how to use the
GeoPackage format with R:
http://jsta.github.io/2016/07/14/geopackage-r.html


From r.hijmans at gmail.com  Thu Jul 14 22:04:53 2016
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Jul 2016 13:04:53 -0700
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CAEO2kuKJ_Vq0sQqZjXKFK8PWUgpFmLUJk+E+YrZ4GEbpfrWprA@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
	<4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
	<CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>
	<CAEO2kuKJ_Vq0sQqZjXKFK8PWUgpFmLUJk+E+YrZ4GEbpfrWprA@mail.gmail.com>
Message-ID: <CANtt_hxuvc-UQCEZzAn-o=erdjC_VyxjQTvbLL=QkA7amsE4Xw@mail.gmail.com>

That still misses the point completely. Geopackage is just another
format out of many. For a map you make in R, it normally should not
matter how the data used may have been stored. Perhaps it would be
more appropriate to call it the SpatialPolygons contest; but I think
that what you have in mind is a "mapping contest".

you can download geopackage data from gadm.org

Robert

On Thu, Jul 14, 2016 at 11:50 AM,  <arilamstein at gmail.com> wrote:
> I have updated the contest page to clarify that entries that use the
> GeoPackage format are welcome:
>
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update
>
> On Thu, Jul 14, 2016 at 10:39 AM, boB Rudis <bob at rudis.net> wrote:
>
>> Escaped a meeting and saw that there are sample files on the geopkg site.
>>
>> I'll do my best (tho I'm not nearly as skilled & geo-connected as
>> Roger, Barry, et al) to blog the heck out of this format. It's insane
>> that shp is so prevalent. This is a super nice format.
>>
>> On Thu, Jul 14, 2016 at 1:36 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> > The CRAN Windows and OSX rgdal binaries have supported GPKG for some time
>> > now. It would be great to give the driver some traction.
>> >
>> > Roger
>> >
>> > Roger Bivand
>> > Norwegian School of Economics
>> > Bergen, Norway
>> >
>> >
>> >
>> >
>> > On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net>
>> wrote:
>> >
>> > IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
>> > means it can read GeoPackage files. If that's true, then I'm sure Ari
>> > wldn't mind it being classified as a "shapefile".
>> >
>> > Barry: (this is in lieu of a google search on my part after work) do
>> > you have any links to some public GeoPackage files handy to paste?
>> >
>> > On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
>> > <b.rowlingson at lancaster.ac.uk> wrote:
>> >> OGC-standard GeoPackage
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From arilamstein at gmail.com  Thu Jul 14 23:06:15 2016
From: arilamstein at gmail.com (arilamstein at gmail.com)
Date: Thu, 14 Jul 2016 14:06:15 -0700
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CANtt_hxuvc-UQCEZzAn-o=erdjC_VyxjQTvbLL=QkA7amsE4Xw@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
	<4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
	<CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>
	<CAEO2kuKJ_Vq0sQqZjXKFK8PWUgpFmLUJk+E+YrZ4GEbpfrWprA@mail.gmail.com>
	<CANtt_hxuvc-UQCEZzAn-o=erdjC_VyxjQTvbLL=QkA7amsE4Xw@mail.gmail.com>
Message-ID: <CAEO2kuJEO5z6-4yzPHeX2MTqXHgWs=D=H1hp-AYRckDu_9YunA@mail.gmail.com>

Hi Robert,

Thanks for clarifying. I have updated the copy again:

http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update

I think that this addresses the concerns that have been raised on this
list. Can you confirm?

Thanks.

Ari

On Thu, Jul 14, 2016 at 1:04 PM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> That still misses the point completely. Geopackage is just another
> format out of many. For a map you make in R, it normally should not
> matter how the data used may have been stored. Perhaps it would be
> more appropriate to call it the SpatialPolygons contest; but I think
> that what you have in mind is a "mapping contest".
>
> you can download geopackage data from gadm.org
>
> Robert
>
> On Thu, Jul 14, 2016 at 11:50 AM,  <arilamstein at gmail.com> wrote:
> > I have updated the contest page to clarify that entries that use the
> > GeoPackage format are welcome:
> >
> >
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update
> >
> > On Thu, Jul 14, 2016 at 10:39 AM, boB Rudis <bob at rudis.net> wrote:
> >
> >> Escaped a meeting and saw that there are sample files on the geopkg
> site.
> >>
> >> I'll do my best (tho I'm not nearly as skilled & geo-connected as
> >> Roger, Barry, et al) to blog the heck out of this format. It's insane
> >> that shp is so prevalent. This is a super nice format.
> >>
> >> On Thu, Jul 14, 2016 at 1:36 PM, Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> >> > The CRAN Windows and OSX rgdal binaries have supported GPKG for some
> time
> >> > now. It would be great to give the driver some traction.
> >> >
> >> > Roger
> >> >
> >> > Roger Bivand
> >> > Norwegian School of Economics
> >> > Bergen, Norway
> >> >
> >> >
> >> >
> >> >
> >> > On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net>
> >> wrote:
> >> >
> >> > IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm assuming)
> >> > means it can read GeoPackage files. If that's true, then I'm sure Ari
> >> > wldn't mind it being classified as a "shapefile".
> >> >
> >> > Barry: (this is in lieu of a google search on my part after work) do
> >> > you have any links to some public GeoPackage files handy to paste?
> >> >
> >> > On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
> >> > <b.rowlingson at lancaster.ac.uk> wrote:
> >> >> OGC-standard GeoPackage
> >> >
> >> > _______________________________________________
> >> > R-sig-Geo mailing list
> >> > R-sig-Geo at r-project.org
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Fri Jul 15 00:34:29 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 14 Jul 2016 22:34:29 +0000
Subject: [R-sig-Geo] Announcing the R Shapefile Contest
In-Reply-To: <CAEO2kuJEO5z6-4yzPHeX2MTqXHgWs=D=H1hp-AYRckDu_9YunA@mail.gmail.com>
References: <CAEO2kuJxQHw09m1yg7GkV3ip7nTc_WxgmiMENuTpGq9OrBDgAw@mail.gmail.com>
	<CANVKczN7+4d4bZj+XCi_cAjxYR9fkp5c3sLnKC=WPf+KHr73tg@mail.gmail.com>
	<CAJ4QxaPVkWLSp-pN2yf3U-9cMEAhpsCMZOKDT16P5anLwKgzuA@mail.gmail.com>
	<4F58C8D16A2DF6F4.53b64ff2-4d56-45a5-9cc2-c58c284af95a@mail.outlook.com>
	<CAJ4QxaPEThE8Fw91CWjakgETjcryS2zBNZMGpGm9AF5vOz2Tpg@mail.gmail.com>
	<CAEO2kuKJ_Vq0sQqZjXKFK8PWUgpFmLUJk+E+YrZ4GEbpfrWprA@mail.gmail.com>
	<CANtt_hxuvc-UQCEZzAn-o=erdjC_VyxjQTvbLL=QkA7amsE4Xw@mail.gmail.com>
	<CAEO2kuJEO5z6-4yzPHeX2MTqXHgWs=D=H1hp-AYRckDu_9YunA@mail.gmail.com>
Message-ID: <CAAcGz98pNqVeb7EXijqEZRHzYNVKGd6=N1rzWMPkv2DLHh-E7Q@mail.gmail.com>

I am sympathetic here, there is just no good general word for these "vector
layers". Manifold calls them drawings, which I prefer but that doesn't work
for layers that can only store one type of topology (points, lines or
areas/'polygons'). Not sure what MapInfo and other mixed-topology systems
use but probably worth finding out.

If there is a decent nomenclature I'd like to see it. "Shapefile" is sadly
a word that works beyond the legacy ESRI Shapefile format.

Cheers, Mike

On Fri, Jul 15, 2016, 07:06 <arilamstein at gmail.com> wrote:

> Hi Robert,
>
> Thanks for clarifying. I have updated the copy again:
>
>
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update
>
> I think that this addresses the concerns that have been raised on this
> list. Can you confirm?
>
> Thanks.
>
> Ari
>
> On Thu, Jul 14, 2016 at 1:04 PM, Robert J. Hijmans <r.hijmans at gmail.com>
> wrote:
>
> > That still misses the point completely. Geopackage is just another
> > format out of many. For a map you make in R, it normally should not
> > matter how the data used may have been stored. Perhaps it would be
> > more appropriate to call it the SpatialPolygons contest; but I think
> > that what you have in mind is a "mapping contest".
> >
> > you can download geopackage data from gadm.org
> >
> > Robert
> >
> > On Thu, Jul 14, 2016 at 11:50 AM,  <arilamstein at gmail.com> wrote:
> > > I have updated the contest page to clarify that entries that use the
> > > GeoPackage format are welcome:
> > >
> > >
> >
> http://www.arilamstein.com/blog/2016/07/12/announcing-r-shapefile-contest/#update
> > >
> > > On Thu, Jul 14, 2016 at 10:39 AM, boB Rudis <bob at rudis.net> wrote:
> > >
> > >> Escaped a meeting and saw that there are sample files on the geopkg
> > site.
> > >>
> > >> I'll do my best (tho I'm not nearly as skilled & geo-connected as
> > >> Roger, Barry, et al) to blog the heck out of this format. It's insane
> > >> that shp is so prevalent. This is a super nice format.
> > >>
> > >> On Thu, Jul 14, 2016 at 1:36 PM, Roger Bivand <Roger.Bivand at nhh.no>
> > wrote:
> > >> > The CRAN Windows and OSX rgdal binaries have supported GPKG for some
> > time
> > >> > now. It would be great to give the driver some traction.
> > >> >
> > >> > Roger
> > >> >
> > >> > Roger Bivand
> > >> > Norwegian School of Economics
> > >> > Bergen, Norway
> > >> >
> > >> >
> > >> >
> > >> >
> > >> > On Thu, Jul 14, 2016 at 7:16 PM +0200, "boB Rudis" <bob at rudis.net>
> > >> wrote:
> > >> >
> > >> > IIRC at least the r-forge rgdal supports GDAL 2.0 which (I'm
> assuming)
> > >> > means it can read GeoPackage files. If that's true, then I'm sure
> Ari
> > >> > wldn't mind it being classified as a "shapefile".
> > >> >
> > >> > Barry: (this is in lieu of a google search on my part after work) do
> > >> > you have any links to some public GeoPackage files handy to paste?
> > >> >
> > >> > On Wed, Jul 13, 2016 at 1:44 PM, Barry Rowlingson
> > >> > <b.rowlingson at lancaster.ac.uk> wrote:
> > >> >> OGC-standard GeoPackage
> > >> >
> > >> > _______________________________________________
> > >> > R-sig-Geo mailing list
> > >> > R-sig-Geo at r-project.org
> > >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >>
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From tcorms at gmail.com  Tue Jul 12 14:02:05 2016
From: tcorms at gmail.com (Tina Cormier)
Date: Tue, 12 Jul 2016 08:02:05 -0400
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
	(Tina Cormier)
In-Reply-To: <SG2PR02MB1373D0BF031083EFBE1B79AEA4300@SG2PR02MB1373.apcprd02.prod.outlook.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
	<CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
	<CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>
	<CAL-PXjBLZO5MOd-a+4E6UdV32ggnd=xqt9aVOTkW8qNn-cfLmA@mail.gmail.com>
	<SG2PR02MB1373D0BF031083EFBE1B79AEA4300@SG2PR02MB1373.apcprd02.prod.outlook.com>
Message-ID: <CAFfx76-7R8SGEyaAxbbpACg6FZyJNi4R1wbBrFFPHmDg7-fJDw@mail.gmail.com>

Ah, thank you for the correction, Adrian. Admittedly, I'm a little foggy on
the geometry. Specifically, why we would need to cross through 3 points,
rather than 2 as in the method I described above (which was suggested to me
by other posters here and in the QGIS forum). I'm not questioning THAT it
works (as I have used the function that you wrote, as well as the one that
Robert wrote), and both cross through 3 points and capture the whole
cluster, even in a situation where the points are unevenly spaced and there
are 12 of them. I know what a circumcircle is; I'm just curious if the
other method I described above is incorrect to use. Perhaps the geometry
lesson is outside the scope of my original question and of the list, but if
not, I'd love to hear the synopsis.

Thank you to Adrian and Robert for sending me functions for this issue!
Tina



 [image: Inline image 1]

On Mon, Jul 11, 2016 at 9:06 PM, Adrian Baddeley <
adrian.baddeley at curtin.edu.au> wrote:

> Tina Cormier <tinaacormier at gmail.com> writes:
>
>
> > I have the idea now of what I need to do -
>
> > find the longest distance between two points in the cluster,
>
> > the midpoint of that line is the center of the circle,
>
>
> Sorry, but that is not right.
>
>
> The circumcircle of a set of points must pass through 3 of the points (if
> there are at least 3 points). The circumradius is not equal to the maximum
> distance between all pairs of points.
>
>
> Think of an equilateral triangle: three points, each pair separated by the
> same distance 's'.
>
>
> The circumcentre (the centre of the minimal circle) is the point at the
> centre of the triangle.
>
> The circumradius is s/sqrt(3), not s/2.
>
>
> Adrian
>
>
> Prof Adrian Baddeley DSc FAA
>
> Department of Mathematics and Statistics
>
> Curtin University, Perth, Western Australia
>
>
> ------------------------------
> *From:* Tina Cormier <tinaacormier at gmail.com>
> *Sent:* Monday, 11 July 2016 11:15 PM
> *To:* Michael Sumner
> *Cc:* chris english; Bacou, Melanie; Adrian Baddeley;
> r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Minimum bounding circle from cluster of points
> (Tina Cormier)
>
> Wow! I'm humbled that you all took the time to help me out! You had great
> suggestions and sent along some very handy functions. I have the idea now
> of what I need to do - find the longest distance between two points in the
> cluster, the midpoint of that line is the center of the circle, and there
> are numerous ways to create the circle, but once you have the radius, you
> can just buffer it. Fantastically simple. Someone also suggested using
> PostGIS (ST_MinimumBoundingCircle), which I will definitely try. I have a
> postgreSQL db that I use for some simple stuff, and I'm not a guru by any
> means, but this will help me gain a little more experience.
>
> Thank you again, and I can't wait to pay if forward the next time someone
> asks about a topic I know well!
>
> Cheers,
> Tina
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160712/b9e1910f/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screen Shot 2016-07-12 at 7.50.50 AM.png
Type: image/png
Size: 40202 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160712/b9e1910f/attachment.png>

From adrian.baddeley at curtin.edu.au  Wed Jul 13 04:55:52 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Wed, 13 Jul 2016 02:55:52 +0000
Subject: [R-sig-Geo] Minimum bounding circle from cluster of points
 (Tina Cormier)
In-Reply-To: <CAFfx76-7R8SGEyaAxbbpACg6FZyJNi4R1wbBrFFPHmDg7-fJDw@mail.gmail.com>
References: <mailman.11.1468058402.10552.r-sig-geo@r-project.org>
	<SG2PR02MB137320E840DDED7B14642BCFA43D0@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<b58f97a0-c7e8-870c-99e5-21b6480644e4@mbacou.com>
	<CAASFQpR-uxgEYpTaZq=HX4g7Vs_Wia2uNSLN_1xxmgyJw_Ah-A@mail.gmail.com>
	<CAAcGz99KsL2yBLXBgJVPYHyZatauK+mSWyZTNXzsF-E5Y1ZjrQ@mail.gmail.com>
	<CAL-PXjBLZO5MOd-a+4E6UdV32ggnd=xqt9aVOTkW8qNn-cfLmA@mail.gmail.com>
	<SG2PR02MB1373D0BF031083EFBE1B79AEA4300@SG2PR02MB1373.apcprd02.prod.outlook.com>
	<CAFfx76-7R8SGEyaAxbbpACg6FZyJNi4R1wbBrFFPHmDg7-fJDw@mail.gmail.com>
Message-ID: <D3ABC809.24C2%Adrian.Baddeley@curtin.edu.au>


 > Specifically, why we would need to cross through 3 points, rather than 2

Essentially because a circle is uniquely determined by 3 points on the circle, not by 2.

The diagram in Tina's email shows an example where the radius of the minimum bounding circle is greater than half the maximum distance between any two points. Another example is the equilateral triangle.

Adrian

From: Tina Cormier <tcorms at gmail.com<mailto:tcorms at gmail.com>>
Date: Tuesday, 12 July 2016 8:02 pm
To: Adrian Baddeley <Adrian.Baddeley at curtin.edu.au<mailto:Adrian.Baddeley at curtin.edu.au>>
Cc: Michael Sumner <mdsumner at gmail.com<mailto:mdsumner at gmail.com>>, chris english <englishchristophera at gmail.com<mailto:englishchristophera at gmail.com>>, "Bacou, Melanie" <mel at mbacou.com<mailto:mel at mbacou.com>>, "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
Subject: Re: [R-sig-Geo] Minimum bounding circle from cluster of points (Tina Cormier)

Ah, thank you for the correction, Adrian. Admittedly, I'm a little foggy on the geometry. Specifically, why we would need to cross through 3 points, rather than 2 as in the method I described above (which was suggested to me by other posters here and in the QGIS forum). I'm not questioning THAT it works (as I have used the function that you wrote, as well as the one that Robert wrote), and both cross through 3 points and capture the whole cluster, even in a situation where the points are unevenly spaced and there are 12 of them. I know what a circumcircle is; I'm just curious if the other method I described above is incorrect to use. Perhaps the geometry lesson is outside the scope of my original question and of the list, but if not, I'd love to hear the synopsis.

Thank you to Adrian and Robert for sending me functions for this issue!
Tina



 [Inline image 1]

On Mon, Jul 11, 2016 at 9:06 PM, Adrian Baddeley <adrian.baddeley at curtin.edu.au<mailto:adrian.baddeley at curtin.edu.au>> wrote:

Tina Cormier <tinaacormier at gmail.com<mailto:tinaacormier at gmail.com>> writes:


> I have the idea now of what I need to do -

> find the longest distance between two points in the cluster,

> the midpoint of that line is the center of the circle,


Sorry, but that is not right.


The circumcircle of a set of points must pass through 3 of the points (if there are at least 3 points). The circumradius is not equal to the maximum distance between all pairs of points.


Think of an equilateral triangle: three points, each pair separated by the same distance 's'.


The circumcentre (the centre of the minimal circle) is the point at the centre of the triangle.

The circumradius is s/sqrt(3), not s/2.


Adrian


Prof Adrian Baddeley DSc FAA

Department of Mathematics and Statistics

Curtin University, Perth, Western Australia


________________________________
From: Tina Cormier <tinaacormier at gmail.com<mailto:tinaacormier at gmail.com>>
Sent: Monday, 11 July 2016 11:15 PM
To: Michael Sumner
Cc: chris english; Bacou, Melanie; Adrian Baddeley; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] Minimum bounding circle from cluster of points (Tina Cormier)

Wow! I'm humbled that you all took the time to help me out! You had great suggestions and sent along some very handy functions. I have the idea now of what I need to do - find the longest distance between two points in the cluster, the midpoint of that line is the center of the circle, and there are numerous ways to create the circle, but once you have the radius, you can just buffer it. Fantastically simple. Someone also suggested using PostGIS (ST_MinimumBoundingCircle), which I will definitely try. I have a postgreSQL db that I use for some simple stuff, and I'm not a guru by any means, but this will help me gain a little more experience.

Thank you again, and I can't wait to pay if forward the next time someone asks about a topic I know well!

Cheers,
Tina


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160713/db0a5253/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screen Shot 2016-07-12 at 7.50.50 AM.png
Type: image/png
Size: 40202 bytes
Desc: Screen Shot 2016-07-12 at 7.50.50 AM.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160713/db0a5253/attachment.png>

From Rainer at krugs.de  Fri Jul 15 10:32:20 2016
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 15 Jul 2016 10:32:20 +0200
Subject: [R-sig-Geo] Annoucing the R Shapefile Contest
In-Reply-To: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>
	(stachel2@msu.edu's message of "Thu, 14 Jul 2016 16:00:48 -0400")
References: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>
Message-ID: <m2h9bruwrv.fsf@krugs.de>

stachel2 at msu.edu writes:

> I wrote a **very** elementary blog post showing how to use the
> GeoPackage format with R:
> http://jsta.github.io/2016/07/14/geopackage-r.html
>

This is nice - thanks.

One general problem I see in =contrast to the shape file is it's
simplicity for writing and reading in GeoPackage format: you need the
swiss army knife package rgdal. This works perfectly, don't get me
wrong, but from the user perspective it is much easier to use one
command without having to specify dsn and driver, as you can do with
shapefiles (e.g. in the package maptools).

It would be great if there would be a wrapper package around rgdal to
make the usage of GeoPackage easier. It shouldn't be to difficult just
to put the basic functions into a package (writeGPG(), readGPG(), ...).

I just created a github (https://github.com/rkrug/rGeoPackage) wherer
ideas can be collected for this package.

Please join in and post suggestions for functions and functionality
here or on the github page - I won't have much time before end of August.

Cheers,

Rainer

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160715/f46e03bf/attachment.bin>

From mel at mbacou.com  Fri Jul 15 10:57:08 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 15 Jul 2016 04:57:08 -0400
Subject: [R-sig-Geo] Annoucing the R Shapefile Contest
In-Reply-To: <m2h9bruwrv.fsf@krugs.de>
References: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>
	<m2h9bruwrv.fsf@krugs.de>
Message-ID: <7dd6ec3e-8077-cd0f-fbb0-dc65f7fda9a2@mbacou.com>

Just chiming in, but I don't see any reason for wrapping `readOGR()` and 
`writeOGR()`. For the sake of code portability and readability, the fact 
that these 2 functions work for a myriad of vector-based GIS formats is 
a great thing. You can skip naming parameters to save typing if that's 
an issue:

readOGR("my_folder", "cities")
writeOGR(cities, "my_folder", "cities", "GPKG")
writeOGR(cities, "my_folder", "cities", "ESRI Shapefile")

Also contrary to others I see a benefit to saving an object's geometry 
and attributes in 2 separate files, can save I/O operations. Anyone who 
works with GeoJSON files knows these can also become very large and 
cumbersome. The main problem with shapefiles is the DBF specification 
that's a little outdated.

--Mel.


On 7/15/2016 4:32 AM, Rainer M Krug wrote:
> stachel2 at msu.edu writes:
>
>> I wrote a **very** elementary blog post showing how to use the
>> GeoPackage format with R:
>> http://jsta.github.io/2016/07/14/geopackage-r.html
>>
> This is nice - thanks.
>
> One general problem I see in =contrast to the shape file is it's
> simplicity for writing and reading in GeoPackage format: you need the
> swiss army knife package rgdal. This works perfectly, don't get me
> wrong, but from the user perspective it is much easier to use one
> command without having to specify dsn and driver, as you can do with
> shapefiles (e.g. in the package maptools).
>
> It would be great if there would be a wrapper package around rgdal to
> make the usage of GeoPackage easier. It shouldn't be to difficult just
> to put the basic functions into a package (writeGPG(), readGPG(), ...).
>
> I just created a github (https://github.com/rkrug/rGeoPackage) wherer
> ideas can be collected for this package.
>
> Please join in and post suggestions for functions and functionality
> here or on the github page - I won't have much time before end of August.
>
> Cheers,
>
> Rainer
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From Rainer at krugs.de  Fri Jul 15 11:06:40 2016
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 15 Jul 2016 11:06:40 +0200
Subject: [R-sig-Geo] Annoucing the R Shapefile Contest
In-Reply-To: <7dd6ec3e-8077-cd0f-fbb0-dc65f7fda9a2@mbacou.com> (Melanie
	Bacou's message of "Fri, 15 Jul 2016 04:57:08 -0400")
References: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>
	<m2h9bruwrv.fsf@krugs.de>
	<7dd6ec3e-8077-cd0f-fbb0-dc65f7fda9a2@mbacou.com>
Message-ID: <m2a8hjuv6n.fsf@krugs.de>

"Bacou, Melanie" <mel at mbacou.com> writes:

> Just chiming in, but I don't see any reason for wrapping `readOGR()` and 
> `writeOGR()`.

readability and simplicity for the user - for advanced users (which
understand that dsn can mean many different things and have no problem
with different drivers), writeOGR is perfect because of it's
flexibility. For the beginner, writeOGR is difficult to use (own
experience) because of it's flexibility.

> For the sake of code portability and readability, the fact 
> that these 2 functions work for a myriad of vector-based GIS formats is 
> a great thing.

I agree.

> You can skip naming parameters to save typing if that's 
> an issue:
>
> readOGR("my_folder", "cities")
> writeOGR(cities, "my_folder", "cities", "GPKG")
> writeOGR(cities, "my_folder", "cities", "ESRI Shapefile")

Skipping naming parameters is, my personal opinion, a bad idea as it
makes code much less readable. If I am not using a command for some time,
I have to look up what the parameter mean.

>
> Also contrary to others I see a benefit to saving an object's geometry 
> and attributes in 2 separate files, can save I/O operations. Anyone who 
> works with GeoJSON files knows these can also become very large and 
> cumbersome. The main problem with shapefiles is the DBF specification 
> that's a little outdated.
>
> --Mel.
>
>
> On 7/15/2016 4:32 AM, Rainer M Krug wrote:
>> stachel2 at msu.edu writes:
>>
>>> I wrote a **very** elementary blog post showing how to use the
>>> GeoPackage format with R:
>>> http://jsta.github.io/2016/07/14/geopackage-r.html
>>>
>> This is nice - thanks.
>>
>> One general problem I see in =contrast to the shape file is it's
>> simplicity for writing and reading in GeoPackage format: you need the
>> swiss army knife package rgdal. This works perfectly, don't get me
>> wrong, but from the user perspective it is much easier to use one
>> command without having to specify dsn and driver, as you can do with
>> shapefiles (e.g. in the package maptools).
>>
>> It would be great if there would be a wrapper package around rgdal to
>> make the usage of GeoPackage easier. It shouldn't be to difficult just
>> to put the basic functions into a package (writeGPG(), readGPG(), ...).
>>
>> I just created a github (https://github.com/rkrug/rGeoPackage) wherer
>> ideas can be collected for this package.
>>
>> Please join in and post suggestions for functions and functionality
>> here or on the github page - I won't have much time before end of August.
>>
>> Cheers,
>>
>> Rainer
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> 	[[alternative HTML version deleted]]

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160715/95cbe9d5/attachment.bin>

From mdsumner at gmail.com  Fri Jul 15 11:33:57 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 15 Jul 2016 09:33:57 +0000
Subject: [R-sig-Geo] Annoucing the R Shapefile Contest
In-Reply-To: <m2a8hjuv6n.fsf@krugs.de>
References: <20160714160048.13492qa5zc5xqnow@mail.msu.edu>
	<m2h9bruwrv.fsf@krugs.de>
	<7dd6ec3e-8077-cd0f-fbb0-dc65f7fda9a2@mbacou.com>
	<m2a8hjuv6n.fsf@krugs.de>
Message-ID: <CAAcGz9_wGtsAmdJ4svoH4vKZZ=RSqFxi2KLt=4SCACv97j_7XQ@mail.gmail.com>

On Fri, Jul 15, 2016, 19:07 Rainer M Krug <Rainer at krugs.de> wrote:

> "Bacou, Melanie" <mel at mbacou.com> writes:
>
> > Just chiming in, but I don't see any reason for wrapping `readOGR()` and
> > `writeOGR()`.
>
> readability and simplicity for the user - for advanced users (which
> understand that dsn can mean many different things and have no problem
> with different drivers), writeOGR is perfect because of it's
> flexibility. For the beginner, writeOGR is difficult to use (own
> experience) because of it's flexibility.
>
> > For the sake of code portability and readability, the fact
> > that these 2 functions work for a myriad of vector-based GIS formats is
> > a great thing.
>
> I agree.
>
> > You can skip naming parameters to save typing if that's
> > an issue:
> >
> > readOGR("my_folder", "cities")
> > writeOGR(cities, "my_folder", "cities", "GPKG")
> > writeOGR(cities, "my_folder", "cities", "ESRI Shapefile")
>
> Skipping naming parameters is, my personal opinion, a bad idea as it
> makes code much less readable. If I am not using a command for some time,
> I have to look up what the parameter mean.
>
> >
> > Also contrary to others I see a benefit to saving an object's geometry
> > and attributes in 2 separate files, can save I/O operations.



It is easy to read the attributes from Geopackage with standard SQLite
(dplyr provides further simplification too).

FWIW, all the tables are transparently available, though the geometry is
packed as WKB.

Cheers, Mike

Anyone who
> > works with GeoJSON files knows these can also become very large and
> > cumbersome. The main problem with shapefiles is the DBF specification
> > that's a little outdated.
> >
> > --Mel.
> >
> >
> > On 7/15/2016 4:32 AM, Rainer M Krug wrote:
> >> stachel2 at msu.edu writes:
> >>
> >>> I wrote a **very** elementary blog post showing how to use the
> >>> GeoPackage format with R:
> >>> http://jsta.github.io/2016/07/14/geopackage-r.html
> >>>
> >> This is nice - thanks.
> >>
> >> One general problem I see in =contrast to the shape file is it's
> >> simplicity for writing and reading in GeoPackage format: you need the
> >> swiss army knife package rgdal. This works perfectly, don't get me
> >> wrong, but from the user perspective it is much easier to use one
> >> command without having to specify dsn and driver, as you can do with
> >> shapefiles (e.g. in the package maptools).
> >>
> >> It would be great if there would be a wrapper package around rgdal to
> >> make the usage of GeoPackage easier. It shouldn't be to difficult just
> >> to put the basic functions into a package (writeGPG(), readGPG(), ...).
> >>
> >> I just created a github (https://github.com/rkrug/rGeoPackage) wherer
> >> ideas can be collected for this package.
> >>
> >> Please join in and post suggestions for functions and functionality
> >> here or on the github page - I won't have much time before end of
> August.
> >>
> >> Cheers,
> >>
> >> Rainer
> >>
> >>
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >       [[alternative HTML version deleted]]
>
> --
> Rainer M. Krug
> email: Rainer<at>krugs<dot>de
> PGP: 0x0F52F982
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From paul.lantos at duke.edu  Fri Jul 15 13:40:04 2016
From: paul.lantos at duke.edu (Paul Lantos)
Date: Fri, 15 Jul 2016 11:40:04 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14
In-Reply-To: <mailman.4.1468576803.18491.r-sig-geo@r-project.org>
References: <mailman.4.1468576803.18491.r-sig-geo@r-project.org>
Message-ID: <y01l684psn0o52htgfbx5w0l.1468581709481@email.android.com>

ESRI / ArcGIS has moved beyond shapefiles too with the advent of geodatabases. In a GIS environment these are superior to shapefiles in many ways, and ESRI in its own training and help resources encourage geodatabases over shapefiles. As far as I've seen only SpaceStat has made itself compatible with geodatabases. But I think that it's a high priority for R, QGIS, etc to adopt the geodatabase as a common format, esp to facilitate interchange with ArcGIS.


-------- Original message --------
From: r-sig-geo-request at r-project.org
Date: 7/15/16 6:07 AM (GMT-05:00)
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 155, Issue 14

Send R-sig-Geo mailing list submissions to
        r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
        r-sig-geo-request at r-project.org

You can reach the person managing the list at
        r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."

	[[alternative HTML version deleted]]


From tech_dev at wildintellect.com  Fri Jul 15 17:30:42 2016
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Fri, 15 Jul 2016 08:30:42 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14
In-Reply-To: <y01l684psn0o52htgfbx5w0l.1468581709481@email.android.com>
References: <mailman.4.1468576803.18491.r-sig-geo@r-project.org>
	<y01l684psn0o52htgfbx5w0l.1468581709481@email.android.com>
Message-ID: <578901A2.3090104@wildintellect.com>

rgdal has a geodatabase driver (gdal in QGIS too)

Standardizing on the format is impossible unless ESRI opens the
specification. Currently open source tools, even using ESRI SDK can not
read Rasters from geodatabase, relation based values in vectors, and
have little or no write ability. Also ESRI gdb formats are not backwards
compatible with each other, if you write a file with the newest Arc it's
only usable with the newest versions.

I convert all gdb I receive into either gpkg or spatialite which FYI
ArcGIS can read both of those now. For whatever reason ESRI has not
implemented the ability to write to those formats yet.

-Alex

On 07/15/2016 04:40 AM, Paul Lantos wrote:
> ESRI / ArcGIS has moved beyond shapefiles too with the advent of geodatabases. In a GIS environment these are superior to shapefiles in many ways, and ESRI in its own training and help resources encourage geodatabases over shapefiles. As far as I've seen only SpaceStat has made itself compatible with geodatabases. But I think that it's a high priority for R, QGIS, etc to adopt the geodatabase as a common format, esp to facilitate interchange with ArcGIS.
> 
> 
> -------- Original message --------
> From: r-sig-geo-request at r-project.org
> Date: 7/15/16 6:07 AM (GMT-05:00)
> To: r-sig-geo at r-project.org
> Subject: R-sig-Geo Digest, Vol 155, Issue 14
> 
> Send R-sig-Geo mailing list submissions to
>         r-sig-geo at r-project.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
>         r-sig-geo-request at r-project.org
> 
> You can reach the person managing the list at
>         r-sig-geo-owner at r-project.org
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From paul.lantos at duke.edu  Fri Jul 15 17:35:04 2016
From: paul.lantos at duke.edu (Paul Lantos)
Date: Fri, 15 Jul 2016 15:35:04 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14
In-Reply-To: <578901A2.3090104@wildintellect.com>
References: <mailman.4.1468576803.18491.r-sig-geo@r-project.org>
	<y01l684psn0o52htgfbx5w0l.1468581709481@email.android.com>
	<578901A2.3090104@wildintellect.com>
Message-ID: <CY1PR05MB1915FED24722C480B477090392330@CY1PR05MB1915.namprd05.prod.outlook.com>

Hi Alex, the commercial stats program SpaceStat (Biomedware) can both read and write geodatabase files. Second, I've had geodatabase files from ArcGIS 10.3.1 used without any problem by colleagues running 10.0.0. I haven't tried this with geodatabases containing complex topology rules, but for basic combinations of rasters and vectors there's been no problem at all.

Paul

-----Original Message-----
From: Alex Mandel [mailto:tech_dev at wildintellect.com] 
Sent: Friday, July 15, 2016 11:31 AM
To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14

rgdal has a geodatabase driver (gdal in QGIS too)

Standardizing on the format is impossible unless ESRI opens the specification. Currently open source tools, even using ESRI SDK can not read Rasters from geodatabase, relation based values in vectors, and have little or no write ability. Also ESRI gdb formats are not backwards compatible with each other, if you write a file with the newest Arc it's only usable with the newest versions.

I convert all gdb I receive into either gpkg or spatialite which FYI ArcGIS can read both of those now. For whatever reason ESRI has not implemented the ability to write to those formats yet.

-Alex

On 07/15/2016 04:40 AM, Paul Lantos wrote:
> ESRI / ArcGIS has moved beyond shapefiles too with the advent of geodatabases. In a GIS environment these are superior to shapefiles in many ways, and ESRI in its own training and help resources encourage geodatabases over shapefiles. As far as I've seen only SpaceStat has made itself compatible with geodatabases. But I think that it's a high priority for R, QGIS, etc to adopt the geodatabase as a common format, esp to facilitate interchange with ArcGIS.
> 
> 
> -------- Original message --------
> From: r-sig-geo-request at r-project.org
> Date: 7/15/16 6:07 AM (GMT-05:00)
> To: r-sig-geo at r-project.org
> Subject: R-sig-Geo Digest, Vol 155, Issue 14
> 
> Send R-sig-Geo mailing list submissions to
>         r-sig-geo at r-project.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
>         
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dsig-2Dgeo&d=CwIC-g&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHL
> R0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=4SG34ZYbVp
> VdBftPWPPoE1R-qnPX6Wcprp73RDmi44o&s=QHnuyzs8I2c8iGjeuozlcAfM-aeb77TlAt
> 7Q9LU-QrM&e= or, via email, send a message with subject or body 'help' 
> to
>         r-sig-geo-request at r-project.org
> 
> You can reach the person managing the list at
>         r-sig-geo-owner at r-project.org
> 
> When replying, please edit your Subject line so it is more specific 
> than "Re: Contents of R-sig-Geo digest..."
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dsig-2Dgeo&d=CwIC-g&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHL
> R0Sj_gZ4adc&r=pCiIbVPBNWU0azo0D48ChUH_fawb-FalNVOf1sUn1r4&m=4SG34ZYbVpVdBftPWPPoE1R-qnPX6Wcprp73RDmi44o&s=QHnuyzs8I2c8iGjeuozlcAfM-aeb77TlAt7Q9LU-QrM&e=
> 


From tech_dev at wildintellect.com  Fri Jul 15 23:10:39 2016
From: tech_dev at wildintellect.com (Alex M)
Date: Fri, 15 Jul 2016 14:10:39 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14
In-Reply-To: <9164cd2ff9844192b5df0a539f7b96ce@RED-INF-MXMB-P3.esri.com>
References: <mailman.4.1468576803.18491.r-sig-geo@r-project.org>
	<y01l684psn0o52htgfbx5w0l.1468581709481@email.android.com>
	<578901A2.3090104@wildintellect.com>
	<9164cd2ff9844192b5df0a539f7b96ce@RED-INF-MXMB-P3.esri.com>
Message-ID: <5789514F.4090500@wildintellect.com>

Shaun,

Thanks I hadn't seen the write functionality before, but last time I
looked was a year ago. Very unclear what version they introduced the
writing, seems to be 10.4 released at the end of 2015. I suspect the
machines around here are still running 10.3

Any idea if you can direct edit those formats like other layers in Arc
(I should give it a try)?

Thanks,
-Alex

On 07/15/2016 09:24 AM, Shaun Walbridge wrote:
> Alex,
> 
> The Geodatabase issue and what the most appropriate storage format is for a standard is a complex topic so I won't jump into it, but wanted to mention that ArcGIS supports writing to both Geopackages and Spatalite databases and has for the past few releases. This can be accomplished in a few ways, including using the CreateSQLiteDatabase tool [1].
> 
> Cheers,
> Shaun
> 
> 1. http://desktop.arcgis.com/en/arcmap/latest/tools/data-management-toolbox/create-sqlite-database.htm
> 
> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Alex Mandel
> Sent: Friday, July 15, 2016 11:31 AM
> To: Paul Lantos <paul.lantos at duke.edu>; r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] R-sig-Geo Digest, Vol 155, Issue 14
> 
> rgdal has a geodatabase driver (gdal in QGIS too)
> 
> Standardizing on the format is impossible unless ESRI opens the specification. Currently open source tools, even using ESRI SDK can not read Rasters from geodatabase, relation based values in vectors, and have little or no write ability. Also ESRI gdb formats are not backwards compatible with each other, if you write a file with the newest Arc it's only usable with the newest versions.
> 
> I convert all gdb I receive into either gpkg or spatialite which FYI ArcGIS can read both of those now. For whatever reason ESRI has not implemented the ability to write to those formats yet.
> 
> -Alex
> 
> On 07/15/2016 04:40 AM, Paul Lantos wrote:
>> ESRI / ArcGIS has moved beyond shapefiles too with the advent of geodatabases. In a GIS environment these are superior to shapefiles in many ways, and ESRI in its own training and help resources encourage geodatabases over shapefiles. As far as I've seen only SpaceStat has made itself compatible with geodatabases. But I think that it's a high priority for R, QGIS, etc to adopt the geodatabase as a common format, esp to facilitate interchange with ArcGIS.
>>
>>
>> -------- Original message --------
>> From: r-sig-geo-request at r-project.org
>> Date: 7/15/16 6:07 AM (GMT-05:00)
>> To: r-sig-geo at r-project.org
>> Subject: R-sig-Geo Digest, Vol 155, Issue 14
>>
>> Send R-sig-Geo mailing list submissions to
>>         r-sig-geo at r-project.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>>         
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
>> man_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkc
>> UCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=SGUF8qW8cnoIz6ic76VZu7Bgk7bDFCv
>> WboA3bewZTHU&s=RZXiOGDMUuqbppFHzIRDaxFCLvTof4HQQNYr9XdyXBo&e=
>> or, via email, send a message with subject or body 'help' to
>>         r-sig-geo-request at r-project.org
>>
>> You can reach the person managing the list at
>>         r-sig-geo-owner at r-project.org
>>
>> When replying, please edit your Subject line so it is more specific 
>> than "Re: Contents of R-sig-Geo digest..."
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
>> man_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkc
>> UCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=SGUF8qW8cnoIz6ic76VZu7Bgk7bDFCv
>> WboA3bewZTHU&s=RZXiOGDMUuqbppFHzIRDaxFCLvTof4HQQNYr9XdyXBo&e=
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=YFaRLkcUCdDkLrpTbNOUV9J1CwYBCTMwgm5tdQkRSm4&m=SGUF8qW8cnoIz6ic76VZu7Bgk7bDFCvWboA3bewZTHU&s=RZXiOGDMUuqbppFHzIRDaxFCLvTof4HQQNYr9XdyXBo&e= 
>


From clusk at waikato.ac.nz  Mon Jul 18 06:57:04 2016
From: clusk at waikato.ac.nz (Chris Lusk)
Date: Mon, 18 Jul 2016 16:57:04 +1200
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
Message-ID: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>

Hi - I've made a map to show the spatial arrangement of my plots, and would
now like to add a scale bar (in hundreds of metres) and a north arrow. I've
seen several solutions online, most of which threw error messages when I
tried them. Although the solution below doesn't give an error message, it
doesn't actually add anything to the map!

Any advice would be appreciated.

Chris
..........

library(ggplot2)
library(ggmap)
library(maps)
library(GISTools)

##Coordinates of four types of plots
Gaps <- read.table(text="lon lat
176.431823     -38.086894
176.4329002     -38.08855667
176.4286505     -38.08421246
176.4239767     -38.08297953
176.4306576     -38.09032491
176.4181457     -38.08283416
176.4325089     -38.09042394
176.4243027     -38.08215021
176.4220882     -38.08720573
176.430974    -38.093108", header = TRUE, strip.white = TRUE)

Understorey <- read.table(text="lon lat
176.431523   -38.086965
176.418408   -38.082935
176.4244189     -38.08242069
176.4287644     -38.08372266
176.4240118     -38.0823004
176.4333778     -38.08853369
176.4217424     -38.0876122
176.4309304     -38.09055117
176.4324084     -38.0907023
176.430821   -38.093687", header = TRUE, strip.white = TRUE)

Treeferns <- read.table(text="lon lat
176.432134      -38.086298
176.4246547     -38.08226916
176.4335132     -38.08801622
176.4183628     -38.08260261
176.429       -38.08413018
176.4213997     -38.08710868
176.4304333     -38.09064678
176.4324081     -38.0909994
176.4242689     -38.08264669
176.429837      -38.093061", header = TRUE, strip.white = TRUE)

Margins <- read.table(text="lon lat
176.4225302     -38.08177849
176.427018     -38.08879161
176.4207786     -38.08356826
176.4315118     -38.08251629
176.426456     -38.08920441
176.426010   -38.088253
176.422526   -38.082794
176.421399   -38.084780
176.429339   -38.092742", header = TRUE, strip.white = TRUE)

## Get the map at right zoom level
OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
maptype='hybrid', zoom=15)

## Plot the points on the map
ggmap(OkatainaMap) +
  geom_point(data=Gaps, aes(x=lon, y=lat), pch=15, colour="chartreuse1",
size=2.5, alpha=1) +
  geom_point(data=Understorey, aes(x=lon, y=lat), pch=21, colour="gray40",
bg="black", size=3, alpha=1) +
  geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23, colour="gray40",
bg="blue", size=2.5, alpha=1) +
  geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
size=2.5, alpha=1)

##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)

map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")

...................


Dr. Chris Lusk
Senior Research Fellow
Environmental Research Institute
The University of Waikato
Private Bag 3105, Hamilton
New Zealand / Aotearoa
http://sci.waikato.ac.nz/sites/clusk/
Ph 64 7 838 4205
Senior Editor, *NZ J Botany*
~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jul 18 09:10:03 2016
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 18 Jul 2016 09:10:03 +0200
Subject: [R-sig-Geo] Simple features for R, part 2
Message-ID: <578C80CB.8010704@uni-muenster.de>

There's a second blog post on the ISC project "Simple features for R",
describing progress up to date and planned future steps, at:

http://r-spatial.org/r/2016/07/18/sf2.html

Comments are welcome!
-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160718/b51e04c2/attachment.bin>

From florian.detsch at staff.uni-marburg.de  Mon Jul 18 09:31:10 2016
From: florian.detsch at staff.uni-marburg.de (Florian Detsch)
Date: Mon, 18 Jul 2016 09:31:10 +0200
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
In-Reply-To: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
References: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
Message-ID: <578C85BE.3080907@staff.uni-marburg.de>

Chris,

here is a rather manual lattice-based approach that might point you in 
the right direction. dismo::gmap(..., rgb = TRUE) returns a Raster* 
object that can easily be transformed to a list compatible with 
'sp.layout' by using mapview::rgb2spLayout(...). Note that if you want 
to stick with latlon coordinates (EPSG:4326), but display the scale bar 
in meters, you are required to specify dismo::gmap(..., lonlat = TRUE) 
and adjust the 'scale' argument used to create the scale bar accordingly.

Best,
Florian


library(dismo)
library(mapview)

## get map using `dismo::gmap`
OkatainaMap <- gmap(extent(176.425, 176.425, -38.0845, -38.0845),
                     type = 'hybrid', scale = 2, zoom = 15, rgb = TRUE)

## scale bar
scale <- list("SpatialPolygonsRescale", layout.scale.bar(), scale = 500,
               offset = c(19638250, -4592600), fill = c("white", "black"))
text1 <- list("sp.text", c(19638250, -4592670), "0", cex = .75, font = 2)
text2 <- list("sp.text", c(19638800, -4592670), "500 m", cex = .75, font 
= 2)

## north arrow
arrow <- list("SpatialPolygonsRescale", layout.north.arrow(type = 1),
               offset = c(19638450, -4592500), scale = 300)

## display data
spplot(OkatainaMap[[1]], colorkey = FALSE, col.regions = "transparent",
        scales = list(draw = TRUE),
        sp.layout = list(rgb2spLayout(OkatainaMap), arrow, scale, text1, 
text2))


On 18.07.2016 06:57, Chris Lusk wrote:
> Hi - I've made a map to show the spatial arrangement of my plots, and would
> now like to add a scale bar (in hundreds of metres) and a north arrow. I've
> seen several solutions online, most of which threw error messages when I
> tried them. Although the solution below doesn't give an error message, it
> doesn't actually add anything to the map!
>
> Any advice would be appreciated.
>
> Chris
> ..........
>
> library(ggplot2)
> library(ggmap)
> library(maps)
> library(GISTools)
>
> ##Coordinates of four types of plots
> Gaps <- read.table(text="lon lat
> 176.431823     -38.086894
> 176.4329002     -38.08855667
> 176.4286505     -38.08421246
> 176.4239767     -38.08297953
> 176.4306576     -38.09032491
> 176.4181457     -38.08283416
> 176.4325089     -38.09042394
> 176.4243027     -38.08215021
> 176.4220882     -38.08720573
> 176.430974    -38.093108", header = TRUE, strip.white = TRUE)
>
> Understorey <- read.table(text="lon lat
> 176.431523   -38.086965
> 176.418408   -38.082935
> 176.4244189     -38.08242069
> 176.4287644     -38.08372266
> 176.4240118     -38.0823004
> 176.4333778     -38.08853369
> 176.4217424     -38.0876122
> 176.4309304     -38.09055117
> 176.4324084     -38.0907023
> 176.430821   -38.093687", header = TRUE, strip.white = TRUE)
>
> Treeferns <- read.table(text="lon lat
> 176.432134      -38.086298
> 176.4246547     -38.08226916
> 176.4335132     -38.08801622
> 176.4183628     -38.08260261
> 176.429       -38.08413018
> 176.4213997     -38.08710868
> 176.4304333     -38.09064678
> 176.4324081     -38.0909994
> 176.4242689     -38.08264669
> 176.429837      -38.093061", header = TRUE, strip.white = TRUE)
>
> Margins <- read.table(text="lon lat
> 176.4225302     -38.08177849
> 176.427018     -38.08879161
> 176.4207786     -38.08356826
> 176.4315118     -38.08251629
> 176.426456     -38.08920441
> 176.426010   -38.088253
> 176.422526   -38.082794
> 176.421399   -38.084780
> 176.429339   -38.092742", header = TRUE, strip.white = TRUE)
>
> ## Get the map at right zoom level
> OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
> maptype='hybrid', zoom=15)
>
> ## Plot the points on the map
> ggmap(OkatainaMap) +
>    geom_point(data=Gaps, aes(x=lon, y=lat), pch=15, colour="chartreuse1",
> size=2.5, alpha=1) +
>    geom_point(data=Understorey, aes(x=lon, y=lat), pch=21, colour="gray40",
> bg="black", size=3, alpha=1) +
>    geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23, colour="gray40",
> bg="blue", size=2.5, alpha=1) +
>    geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
> size=2.5, alpha=1)
>
> ##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)
>
> map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
> north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")
>
> ...................
>
>
> Dr. Chris Lusk
> Senior Research Fellow
> Environmental Research Institute
> The University of Waikato
> Private Bag 3105, Hamilton
> New Zealand / Aotearoa
> http://sci.waikato.ac.nz/sites/clusk/
> Ph 64 7 838 4205
> Senior Editor, *NZ J Botany*
> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Florian Detsch (M.Sc. Physical Geography)
Environmental Informatics
Department of Geography
Philipps-Universit?t Marburg
Deutschhausstra?e 12
35032 (parcel post: 35037) Marburg, Germany

Phone: +49 (0) 6421 28-25323
Web: http://umweltinformatik-marburg.de/en/staff/florian-detsch/


From Rainer at krugs.de  Mon Jul 18 10:16:54 2016
From: Rainer at krugs.de (Rainer M Krug)
Date: Mon, 18 Jul 2016 10:16:54 +0200
Subject: [R-sig-Geo] Installing rgdal with gdal 2.0 on Mac using homebrew
Message-ID: <m21t2ruzrd.fsf@krugs.de>

Hi

I want to install rgdal for using gdal 2.0. The standard gdal package in
homebrew provides gdal 1.11.3, and gdal-20 is installed by using the
osgeo/osgeo4mac/gdal-20 formula, so gdal 2.1.0 is installed in

/usr/local/opt/gdal-20/

If I simply say

,----
| install.packages("rgdal, type="source")
`----

rgdal is installed without problems, but using gdal 1.11.3.

But I want to use gdal 2.1.0


The info from the gdal-20 formula says:

,----
| If you build your
| own software and it requires this formula, you'll need to add to your
| build variables:
| 
|     LDFLAGS:  -L/usr/local/opt/gdal-20/lib
|     CPPFLAGS: -I/usr/local/opt/gdal-20/include
`----

So I did the following to install rgdal:

,----
| > install.packages("rgdal", type = "source", configure.args = "--with-gdal-config=/usr/local/opt/gdal-20/bin/gdal-config;LDFLAGS=-L/usr/local/opt/gdal-20/lib;CPPFLAGS=-I/usr/local/opt/gdal-20/include")
| Installing package into ?/usr/local/lib/R/3.3/site-library?
| (as ?lib? is unspecified)
| trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.1-10.tar.gz'
| Content type 'application/x-gzip' length 1653393 bytes (1.6 MB)
| ==================================================
| downloaded 1.6 MB
| 
| * installing *source* package ?rgdal? ...
| ** package ?rgdal? successfully unpacked and MD5 sums checked
| configure: CC: clang
| configure: CXX: clang++
| configure: rgdal: 1.1-10
| checking for /usr/bin/svnversion... yes
| configure: svn revision: 622
| configure: gdal-config set to /usr/local/opt/gdal-20/bin/gdal-config
| checking gdal-config exists... yes
| checking gdal-config executable... yes
| checking gdal-config usability... yes
| configure: GDAL: 2.1.0
| checking GDAL version >= 1.6.3... yes
| configure: experimental conditional use of GDAL2
| checking for gcc... clang
| checking whether the C compiler works... yes
| checking for C compiler default output file name... a.out
| checking for suffix of executables... 
| checking whether we are cross compiling... no
| checking for suffix of object files... o
| checking whether we are using the GNU C compiler... yes
| checking whether clang accepts -g... yes
| checking for clang option to accept ISO C89... none needed
| checking how to run the C preprocessor... clang -E
| checking for grep that handles long lines and -e... /usr/bin/grep
| checking for egrep... /usr/bin/grep -E
| checking for ANSI C header files... 
| rm: conftest.dSYM: is a directory
| rm: conftest.dSYM: is a directory
| yes
| checking for sys/types.h... yes
| checking for sys/stat.h... yes
| checking for stdlib.h... yes
| checking for string.h... yes
| checking for memory.h... yes
| checking for strings.h... yes
| checking for inttypes.h... yes
| checking for stdint.h... yes
| checking for unistd.h... yes
| checking gdal.h usability... yes
| checking gdal.h presence... yes
| checking for gdal.h... yes
| checking gdal: linking with --libs only... yes
| checking GDAL: /usr/local/Cellar/gdal-20/2.1.0/share/gdal/pcs.csv readable... yes
| checking proj_api.h usability... yes
| checking proj_api.h presence... yes
| checking for proj_api.h... yes
| checking for pj_init_plus in -lproj... yes
| configure: PROJ.4 version: > 4.8.0
| checking PROJ.4: epsg found and readable... yes
| checking PROJ.4: conus found and readable... yes
| configure: Package CPP flags:  -I/usr/local/Cellar/gdal-20/2.1.0/include
| configure: Package LIBS:  -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj
| configure: creating ./config.status
| config.status: creating src/Makevars
| ** libs
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c OGR_write.cpp -o OGR_write.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c gdal-bindings.cpp -o gdal-bindings.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c init.c -o init.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c inverser.c -o inverser.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c local_stubs.c -o local_stubs.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_geom.cpp -o ogr_geom.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_polygons.c -o ogr_polygons.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_proj.cpp -o ogr_proj.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrdrivers.cpp -o ogrdrivers.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrsource.cpp -o ogrsource.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c projectit.cpp -o projectit.o
| clang++ -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -L/usr/local/Cellar/r/3.3.1/R.framework/Resources/lib -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj -F/usr/local/Cellar/r/3.3.1/R.framework/.. -framework R -lintl -Wl,-framework -Wl,CoreFoundation
| installing to /usr/local/lib/R/3.3/site-library/rgdal/libs
| ** R
| ** data
| ** inst
| ** preparing package for lazy loading
| ** help
| *** installing help indices
| ** building package indices
| ** installing vignettes
| ** testing if installed package can be loaded
| Error in dyn.load(file, DLLpath = DLLpath, ...) : 
|   unable to load shared object '/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so':
|   dlopen(/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so, 6): Symbol not found: _GDALOpenEx
|   Referenced from: /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
|   Expected in: flat namespace
|  in /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
| Error: loading failed
| Execution halted
| ERROR: loading failed
| * removing ?/usr/local/lib/R/3.3/site-library/rgdal?
| * restoring previous ?/usr/local/lib/R/3.3/site-library/rgdal?
| Warning in install.packages :
|   installation of package ?rgdal? had non-zero exit status
| 
| The downloaded source packages are in
| 	?/private/var/folders/50/wcr5bjwn75q595n6x82gxj280000gn/T/RtmpP8byD0/downloaded_packages?
| >
`----

So it is using gdal 2.1.0 during compilation and installation.

My understanding is now (but I might be wrong), that everything works in the building step, but
when loading, it still tries to use the gdal 1.11.3 installation to run.

What am I missing here?

Thanks,

Rainer



-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160718/3aa4a340/attachment.bin>

From w1malik at gmail.com  Mon Jul 18 14:04:15 2016
From: w1malik at gmail.com (Malik Waseem Ali)
Date: Mon, 18 Jul 2016 12:04:15 +0000
Subject: [R-sig-Geo] How to read multiple raster and serial correlation
	between series of rasters
In-Reply-To: <AABC7F55-E312-47BD-A955-504775A4D8A8@bigelow.org>
References: <SNT151-W95DFBC94C5A64DB9BCC09DEB440@phx.gbl>
	<SNT151-W34862FD0FE44241E21C057EB580@phx.gbl>
	<SNT151-W95D592F086E45017383B3DEB380@phx.gbl>
	<AABC7F55-E312-47BD-A955-504775A4D8A8@bigelow.org>
Message-ID: <CABTj=b8M83bfksOCRVxcRL9kQH8SjuB74fmYUk1FR3hev=XeUg@mail.gmail.com>

I have asked the below mentioned question a month before. Please guide me
if the question is not properly asked to the list member.
>
> Waseem Ali
>
>
> From: w1malik at gmail.com
> To: r-help at r-project.org
> Subject: FW: How to read multiple raster and serial correlation between
series of rasters
> Date: Thu, 2 Jun 2016 16:10:08 +0500
>
>
>
>
>
>
>
> Dear members,
> With little effort in producing the code to read all nc files for Carbon
dioxide variables I have produced the following code:
> library(ncdf)ncfiles <- list.files("C:/site-download/AIRS/",
pattern='\\.nc$', full.names = TRUE)ncfilesncfname <-
ncfiles[1]ncfnamedname <-
"mole_fraction_of_carbon_dioxide_in_free_troposphere"ncin <-
open.ncdf(ncfname)print(ncin)lon <- get.var.ncdf(ncin, "Longitude")nlon <-
dim(lon)head(lon)lat <- get.var.ncdf(ncin, "Latitude")nlat <-
dim(lat)head(lat)print(c(nlon, nlat))co2array <- get.var.ncdf(ncin,
"mole_fraction_of_carbon_dioxide_in_free_troposphere")fillvalue <-
att.get.ncdf(ncin, "mole_fraction_of_carbon_dioxide_in_free_troposphere",
"Missval")fillvalueco2array[co2array == fillvalue] <-
NAlibrary(RColorBrewer)image(co2array, col = rev(brewer.pal(10,
"RdBu")))grid <- expand.grid(lon = lon, lat = lat)lonlat <-
expand.grid(lon, lat)lonlathead(lonlat)m <- 1co2.vec <-
as.vector(co2array)length(co2.vec)co2.df01 <- data.frame(cbind(lonlat,
co2.vec*1000000))names(co2.df01) <- c("lon", "lat", paste("co2",
as.character(m), sep = "_"))head(na.omit(co2.df01), 20)csvfile <-
"co20020901.csv"write.table(na.omit(co2.df01), csvfile, row.names = FALSE,
sep = ",")With the help of this code I can dump the values of Carbon
dioxide variables in latitude and longitude wise. sample of the csv file is
as under:      lon  lat    co2_126  -117.5 89.5 381.802050   -57.5 89.5
373.8030147 -175.0 88.0 382.7285148 -172.5 88.0 373.6800152 -162.5 88.0
371.6560153 -160.0 88.0 373.4450154 -157.5 88.0 374.3705I need help to tune
code to do this with iterative code for whole 120 raster to write it into
csv file. Column names should be like as 200301, 200302....up to 200312.
This starts from the January of 2003 till December of 2003 and so on for
the next year.   My next task to do the same for LST variable retrievable
from MODIS LST product of 0.05 degree resolution which is in hdf file
formate [I am trying to write the code to interpret the variable ]. I want
to resample it first to have on same spatial resolution as my first raster
then write to the another csv file in the same way before. After writing it
into the csv files I want to correlate the both variables and serial
correlation. Please guide to do it using R or any other way to deal with
the situations I have briefly explained. Also suggest for interpolation for
carbon dioxide variable first to make the raster layer. It may have missing
some values.
> Waseem Ali
>
> From: w1malik at hotmail.com
> To: r-help at r-project.org
> Subject: How to real multiple raster and serial correlation between
series of rasters
> Date: Sun, 29 May 2016 23:39:18 +0500
>
>
>
>
>
>
>
> Hi,
> I have 120 raster (10 years) files
> in tif format of one variable (say X1) and same numbers for second
variables (Say
> X2). Each raster consists the mean monthly values of corresponding
variables. I
> want to write a script in R which operates the following operations:
>
> ?
> First reads the one by one
> raster from folder and save into the objects.
>
> ?
> Resample/aggregate the both
> raster over same spatial resolution 2? x 2.5?.
>
> ?
> After resampling the all
> raster over same resolution, conversions of all raster to points by using
the
> rasterToPoint() function of raster library.
>
> ?
> After retrieving the same
> monthly raster values (like month of January for X1 and X2) into data
frame, I
> want to compute regression and correlation values for all 120 raster for
both
> variables (X1 and X2) and save into the data frame.
>
> Is there any way out to deal with
> such task.
>
>
> library(raster)
>
> x <- list.files("C:/site-download/",
> pattern = "*.tif", full.names = TRUE)
>
> x1 <- raster(x1)
>
> p <- as(x1, 'SpatialPixels')
>
> plot(x1)
>
> points(p)
> Resultant figure has been attached for you for only x1 variable. I have
also attached the X1 and X2 variable tif raster for January 2002 for
computation purpose. I need to operate it through loop for reading all
these rasters and computing the correlation of each pairs. My next step to
compute the Lag -1 correlations which is Serial Correlation for both
variables.
> Waseem Ali
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet
them to #MaineJellies -- include date, time, and location, as well as any
descriptive information such as size or type.  Learn more at
https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Jul 18 14:08:41 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 18 Jul 2016 12:08:41 +0000
Subject: [R-sig-Geo] Installing rgdal with gdal 2.0 on Mac using homebrew
In-Reply-To: <m21t2ruzrd.fsf@krugs.de>
References: <m21t2ruzrd.fsf@krugs.de>
Message-ID: <4F58C8D16A2DF6F4.80e2522b-43b8-4011-8ee4-3e232b259538@mail.outlook.com>

Sounds like an LDPATH issue, where the gdal 1 dylib is found before gdal 2.

Roger Bivand
Norwegian School of Economics
Bergen, Norway



On Mon, Jul 18, 2016 at 10:18 AM +0200, "Rainer M Krug" <Rainer at krugs.de<mailto:Rainer at krugs.de>> wrote:

Hi

I want to install rgdal for using gdal 2.0. The standard gdal package in
homebrew provides gdal 1.11.3, and gdal-20 is installed by using the
osgeo/osgeo4mac/gdal-20 formula, so gdal 2.1.0 is installed in

/usr/local/opt/gdal-20/

If I simply say

,----
| install.packages("rgdal, type="source")
`----

rgdal is installed without problems, but using gdal 1.11.3.

But I want to use gdal 2.1.0


The info from the gdal-20 formula says:

,----
| If you build your
| own software and it requires this formula, you'll need to add to your
| build variables:
|
|     LDFLAGS:  -L/usr/local/opt/gdal-20/lib
|     CPPFLAGS: -I/usr/local/opt/gdal-20/include
`----

So I did the following to install rgdal:

,----
| > install.packages("rgdal", type = "source", configure.args = "--with-gdal-config=/usr/local/opt/gdal-20/bin/gdal-config;LDFLAGS=-L/usr/local/opt/gdal-20/lib;CPPFLAGS=-I/usr/local/opt/gdal-20/include")
| Installing package into ?/usr/local/lib/R/3.3/site-library?
| (as ?lib? is unspecified)
| trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.1-10.tar.gz'
| Content type 'application/x-gzip' length 1653393 bytes (1.6 MB)
| ==================================================
| downloaded 1.6 MB
|
| * installing *source* package ?rgdal? ...
| ** package ?rgdal? successfully unpacked and MD5 sums checked
| configure: CC: clang
| configure: CXX: clang++
| configure: rgdal: 1.1-10
| checking for /usr/bin/svnversion... yes
| configure: svn revision: 622
| configure: gdal-config set to /usr/local/opt/gdal-20/bin/gdal-config
| checking gdal-config exists... yes
| checking gdal-config executable... yes
| checking gdal-config usability... yes
| configure: GDAL: 2.1.0
| checking GDAL version >= 1.6.3... yes
| configure: experimental conditional use of GDAL2
| checking for gcc... clang
| checking whether the C compiler works... yes
| checking for C compiler default output file name... a.out
| checking for suffix of executables...
| checking whether we are cross compiling... no
| checking for suffix of object files... o
| checking whether we are using the GNU C compiler... yes
| checking whether clang accepts -g... yes
| checking for clang option to accept ISO C89... none needed
| checking how to run the C preprocessor... clang -E
| checking for grep that handles long lines and -e... /usr/bin/grep
| checking for egrep... /usr/bin/grep -E
| checking for ANSI C header files...
| rm: conftest.dSYM: is a directory
| rm: conftest.dSYM: is a directory
| yes
| checking for sys/types.h... yes
| checking for sys/stat.h... yes
| checking for stdlib.h... yes
| checking for string.h... yes
| checking for memory.h... yes
| checking for strings.h... yes
| checking for inttypes.h... yes
| checking for stdint.h... yes
| checking for unistd.h... yes
| checking gdal.h usability... yes
| checking gdal.h presence... yes
| checking for gdal.h... yes
| checking gdal: linking with --libs only... yes
| checking GDAL: /usr/local/Cellar/gdal-20/2.1.0/share/gdal/pcs.csv readable... yes
| checking proj_api.h usability... yes
| checking proj_api.h presence... yes
| checking for proj_api.h... yes
| checking for pj_init_plus in -lproj... yes
| configure: PROJ.4 version: > 4.8.0
| checking PROJ.4: epsg found and readable... yes
| checking PROJ.4: conus found and readable... yes
| configure: Package CPP flags:  -I/usr/local/Cellar/gdal-20/2.1.0/include
| configure: Package LIBS:  -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj
| configure: creating ./config.status
| config.status: creating src/Makevars
| ** libs
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c OGR_write.cpp -o OGR_write.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c gdal-bindings.cpp -o gdal-bindings.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c init.c -o init.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c inverser.c -o inverser.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c local_stubs.c -o local_stubs.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_geom.cpp -o ogr_geom.o
| clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_polygons.c -o ogr_polygons.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_proj.cpp -o ogr_proj.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrdrivers.cpp -o ogrdrivers.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrsource.cpp -o ogrsource.o
| clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c projectit.cpp -o projectit.o
| clang++ -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -L/usr/local/Cellar/r/3.3.1/R.framework/Resources/lib -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj -F/usr/local/Cellar/r/3.3.1/R.framework/.. -framework R -lintl -Wl,-framework -Wl,CoreFoundation
| installing to /usr/local/lib/R/3.3/site-library/rgdal/libs
| ** R
| ** data
| ** inst
| ** preparing package for lazy loading
| ** help
| *** installing help indices
| ** building package indices
| ** installing vignettes
| ** testing if installed package can be loaded
| Error in dyn.load(file, DLLpath = DLLpath, ...) :
|   unable to load shared object '/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so':
|   dlopen(/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so, 6): Symbol not found: _GDALOpenEx
|   Referenced from: /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
|   Expected in: flat namespace
|  in /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
| Error: loading failed
| Execution halted
| ERROR: loading failed
| * removing ?/usr/local/lib/R/3.3/site-library/rgdal?
| * restoring previous ?/usr/local/lib/R/3.3/site-library/rgdal?
| Warning in install.packages :
|   installation of package ?rgdal? had non-zero exit status
|
| The downloaded source packages are in
|        ?/private/var/folders/50/wcr5bjwn75q595n6x82gxj280000gn/T/RtmpP8byD0/downloaded_packages?
| >
`----

So it is using gdal 2.1.0 during compilation and installation.

My understanding is now (but I might be wrong), that everything works in the building step, but
when loading, it still tries to use the gdal 1.11.3 installation to run.

What am I missing here?

Thanks,

Rainer



--
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982

	[[alternative HTML version deleted]]


From mspinola10 at gmail.com  Mon Jul 18 14:32:33 2016
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Mon, 18 Jul 2016 06:32:33 -0600
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
In-Reply-To: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
References: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
Message-ID: <CABkCotQWTy4RPumKNG2gytaDGfb0K2F_D7tcJPg5scdskA10HA@mail.gmail.com>

Or you can try the package ggsn with the package ggmap

Manuel

2016-07-17 22:57 GMT-06:00 Chris Lusk <clusk at waikato.ac.nz>:

> Hi - I've made a map to show the spatial arrangement of my plots, and would
> now like to add a scale bar (in hundreds of metres) and a north arrow. I've
> seen several solutions online, most of which threw error messages when I
> tried them. Although the solution below doesn't give an error message, it
> doesn't actually add anything to the map!
>
> Any advice would be appreciated.
>
> Chris
> ..........
>
> library(ggplot2)
> library(ggmap)
> library(maps)
> library(GISTools)
>
> ##Coordinates of four types of plots
> Gaps <- read.table(text="lon lat
> 176.431823     -38.086894
> 176.4329002     -38.08855667
> 176.4286505     -38.08421246
> 176.4239767     -38.08297953
> 176.4306576     -38.09032491
> 176.4181457     -38.08283416
> 176.4325089     -38.09042394
> 176.4243027     -38.08215021
> 176.4220882     -38.08720573
> 176.430974    -38.093108", header = TRUE, strip.white = TRUE)
>
> Understorey <- read.table(text="lon lat
> 176.431523   -38.086965
> 176.418408   -38.082935
> 176.4244189     -38.08242069
> 176.4287644     -38.08372266
> 176.4240118     -38.0823004
> 176.4333778     -38.08853369
> 176.4217424     -38.0876122
> 176.4309304     -38.09055117
> 176.4324084     -38.0907023
> 176.430821   -38.093687", header = TRUE, strip.white = TRUE)
>
> Treeferns <- read.table(text="lon lat
> 176.432134      -38.086298
> 176.4246547     -38.08226916
> 176.4335132     -38.08801622
> 176.4183628     -38.08260261
> 176.429       -38.08413018
> 176.4213997     -38.08710868
> 176.4304333     -38.09064678
> 176.4324081     -38.0909994
> 176.4242689     -38.08264669
> 176.429837      -38.093061", header = TRUE, strip.white = TRUE)
>
> Margins <- read.table(text="lon lat
> 176.4225302     -38.08177849
> 176.427018     -38.08879161
> 176.4207786     -38.08356826
> 176.4315118     -38.08251629
> 176.426456     -38.08920441
> 176.426010   -38.088253
> 176.422526   -38.082794
> 176.421399   -38.084780
> 176.429339   -38.092742", header = TRUE, strip.white = TRUE)
>
> ## Get the map at right zoom level
> OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
> maptype='hybrid', zoom=15)
>
> ## Plot the points on the map
> ggmap(OkatainaMap) +
>   geom_point(data=Gaps, aes(x=lon, y=lat), pch=15, colour="chartreuse1",
> size=2.5, alpha=1) +
>   geom_point(data=Understorey, aes(x=lon, y=lat), pch=21, colour="gray40",
> bg="black", size=3, alpha=1) +
>   geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23, colour="gray40",
> bg="blue", size=2.5, alpha=1) +
>   geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
> size=2.5, alpha=1)
>
> ##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)
>
> map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
> north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")
>
> ...................
>
>
> Dr. Chris Lusk
> Senior Research Fellow
> Environmental Research Institute
> The University of Waikato
> Private Bag 3105, Hamilton
> New Zealand / Aotearoa
> http://sci.waikato.ac.nz/sites/clusk/
> Ph 64 7 838 4205
> Senior Editor, *NZ J Botany*
> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Mon Jul 18 14:36:02 2016
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Mon, 18 Jul 2016 14:36:02 +0200
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
In-Reply-To: <CABkCotQWTy4RPumKNG2gytaDGfb0K2F_D7tcJPg5scdskA10HA@mail.gmail.com>
References: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
	<CABkCotQWTy4RPumKNG2gytaDGfb0K2F_D7tcJPg5scdskA10HA@mail.gmail.com>
Message-ID: <578CCD32.9030600@gmail.com>

My suggestion would be the wonderful tmap package. It is, however, using 
OpenStreetMap rather than google for background maps AFAIK.

Tim

On 18.07.2016 14:32, Manuel Sp?nola wrote:
> Or you can try the package ggsn with the package ggmap
>
> Manuel
>
> 2016-07-17 22:57 GMT-06:00 Chris Lusk <clusk at waikato.ac.nz>:
>
>> Hi - I've made a map to show the spatial arrangement of my plots, and would
>> now like to add a scale bar (in hundreds of metres) and a north arrow. I've
>> seen several solutions online, most of which threw error messages when I
>> tried them. Although the solution below doesn't give an error message, it
>> doesn't actually add anything to the map!
>>
>> Any advice would be appreciated.
>>
>> Chris
>> ..........
>>
>> library(ggplot2)
>> library(ggmap)
>> library(maps)
>> library(GISTools)
>>
>> ##Coordinates of four types of plots
>> Gaps <- read.table(text="lon lat
>> 176.431823     -38.086894
>> 176.4329002     -38.08855667
>> 176.4286505     -38.08421246
>> 176.4239767     -38.08297953
>> 176.4306576     -38.09032491
>> 176.4181457     -38.08283416
>> 176.4325089     -38.09042394
>> 176.4243027     -38.08215021
>> 176.4220882     -38.08720573
>> 176.430974    -38.093108", header = TRUE, strip.white = TRUE)
>>
>> Understorey <- read.table(text="lon lat
>> 176.431523   -38.086965
>> 176.418408   -38.082935
>> 176.4244189     -38.08242069
>> 176.4287644     -38.08372266
>> 176.4240118     -38.0823004
>> 176.4333778     -38.08853369
>> 176.4217424     -38.0876122
>> 176.4309304     -38.09055117
>> 176.4324084     -38.0907023
>> 176.430821   -38.093687", header = TRUE, strip.white = TRUE)
>>
>> Treeferns <- read.table(text="lon lat
>> 176.432134      -38.086298
>> 176.4246547     -38.08226916
>> 176.4335132     -38.08801622
>> 176.4183628     -38.08260261
>> 176.429       -38.08413018
>> 176.4213997     -38.08710868
>> 176.4304333     -38.09064678
>> 176.4324081     -38.0909994
>> 176.4242689     -38.08264669
>> 176.429837      -38.093061", header = TRUE, strip.white = TRUE)
>>
>> Margins <- read.table(text="lon lat
>> 176.4225302     -38.08177849
>> 176.427018     -38.08879161
>> 176.4207786     -38.08356826
>> 176.4315118     -38.08251629
>> 176.426456     -38.08920441
>> 176.426010   -38.088253
>> 176.422526   -38.082794
>> 176.421399   -38.084780
>> 176.429339   -38.092742", header = TRUE, strip.white = TRUE)
>>
>> ## Get the map at right zoom level
>> OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
>> maptype='hybrid', zoom=15)
>>
>> ## Plot the points on the map
>> ggmap(OkatainaMap) +
>>    geom_point(data=Gaps, aes(x=lon, y=lat), pch=15, colour="chartreuse1",
>> size=2.5, alpha=1) +
>>    geom_point(data=Understorey, aes(x=lon, y=lat), pch=21, colour="gray40",
>> bg="black", size=3, alpha=1) +
>>    geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23, colour="gray40",
>> bg="blue", size=2.5, alpha=1) +
>>    geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
>> size=2.5, alpha=1)
>>
>> ##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)
>>
>> map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
>> north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")
>>
>> ...................
>>
>>
>> Dr. Chris Lusk
>> Senior Research Fellow
>> Environmental Research Institute
>> The University of Waikato
>> Private Bag 3105, Hamilton
>> New Zealand / Aotearoa
>> http://sci.waikato.ac.nz/sites/clusk/
>> Ph 64 7 838 4205
>> Senior Editor, *NZ J Botany*
>> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
Raum 00A08
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From Rainer at krugs.de  Mon Jul 18 14:40:20 2016
From: Rainer at krugs.de (Rainer M Krug)
Date: Mon, 18 Jul 2016 14:40:20 +0200
Subject: [R-sig-Geo] Installing rgdal with gdal 2.0 on Mac using homebrew
In-Reply-To: <4F58C8D16A2DF6F4.80e2522b-43b8-4011-8ee4-3e232b259538@mail.outlook.com>
	(Roger Bivand's message of "Mon, 18 Jul 2016 12:08:41 +0000")
References: <m21t2ruzrd.fsf@krugs.de>
	<4F58C8D16A2DF6F4.80e2522b-43b8-4011-8ee4-3e232b259538@mail.outlook.com>
Message-ID: <m27fcjt8zv.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> Sounds like an LDPATH issue, where the gdal 1 dylib is found before gdal 2.

Hm. Shouldn't, if I supply LDFLAGS, these libraries be used when
running (loading) rgdal, or am I missing something here?

LDPATH as well as LD_LIBRARY_PATH are not set in bash

,----
| > Sys.getenv("LDPATH")
| [1] ""
| > Sys.getenv("LD_LIBRARY_PATH")
| [1] ""
| >
`----

Rainer

>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
>
>
> On Mon, Jul 18, 2016 at 10:18 AM +0200, "Rainer M Krug" <Rainer at krugs.de<mailto:Rainer at krugs.de>> wrote:
>
> Hi
>
> I want to install rgdal for using gdal 2.0. The standard gdal package in
> homebrew provides gdal 1.11.3, and gdal-20 is installed by using the
> osgeo/osgeo4mac/gdal-20 formula, so gdal 2.1.0 is installed in
>
> /usr/local/opt/gdal-20/
>
> If I simply say
>
> ,----
> | install.packages("rgdal, type="source")
> `----
>
> rgdal is installed without problems, but using gdal 1.11.3.
>
> But I want to use gdal 2.1.0
>
>
> The info from the gdal-20 formula says:
>
> ,----
> | If you build your
> | own software and it requires this formula, you'll need to add to your
> | build variables:
> |
> |     LDFLAGS:  -L/usr/local/opt/gdal-20/lib
> |     CPPFLAGS: -I/usr/local/opt/gdal-20/include
> `----
>
> So I did the following to install rgdal:
>
> ,----
> | > install.packages("rgdal", type = "source", configure.args =
> | > "--with-gdal-config=/usr/local/opt/gdal-20/bin/gdal-config;LDFLAGS=-L/usr/local/opt/gdal-20/lib;CPPFLAGS=-I/usr/local/opt/gdal-20/include")
> | Installing package into ?/usr/local/lib/R/3.3/site-library?
> | (as ?lib? is unspecified)
> | trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.1-10.tar.gz'
> | Content type 'application/x-gzip' length 1653393 bytes (1.6 MB)
> | ==================================================
> | downloaded 1.6 MB
> |
> | * installing *source* package ?rgdal? ...
> | ** package ?rgdal? successfully unpacked and MD5 sums checked
> | configure: CC: clang
> | configure: CXX: clang++
> | configure: rgdal: 1.1-10
> | checking for /usr/bin/svnversion... yes
> | configure: svn revision: 622
> | configure: gdal-config set to /usr/local/opt/gdal-20/bin/gdal-config
> | checking gdal-config exists... yes
> | checking gdal-config executable... yes
> | checking gdal-config usability... yes
> | configure: GDAL: 2.1.0
> | checking GDAL version >= 1.6.3... yes
> | configure: experimental conditional use of GDAL2
> | checking for gcc... clang
> | checking whether the C compiler works... yes
> | checking for C compiler default output file name... a.out
> | checking for suffix of executables...
> | checking whether we are cross compiling... no
> | checking for suffix of object files... o
> | checking whether we are using the GNU C compiler... yes
> | checking whether clang accepts -g... yes
> | checking for clang option to accept ISO C89... none needed
> | checking how to run the C preprocessor... clang -E
> | checking for grep that handles long lines and -e... /usr/bin/grep
> | checking for egrep... /usr/bin/grep -E
> | checking for ANSI C header files...
> | rm: conftest.dSYM: is a directory
> | rm: conftest.dSYM: is a directory
> | yes
> | checking for sys/types.h... yes
> | checking for sys/stat.h... yes
> | checking for stdlib.h... yes
> | checking for string.h... yes
> | checking for memory.h... yes
> | checking for strings.h... yes
> | checking for inttypes.h... yes
> | checking for stdint.h... yes
> | checking for unistd.h... yes
> | checking gdal.h usability... yes
> | checking gdal.h presence... yes
> | checking for gdal.h... yes
> | checking gdal: linking with --libs only... yes
> | checking GDAL: /usr/local/Cellar/gdal-20/2.1.0/share/gdal/pcs.csv readable... yes
> | checking proj_api.h usability... yes
> | checking proj_api.h presence... yes
> | checking for proj_api.h... yes
> | checking for pj_init_plus in -lproj... yes
> | configure: PROJ.4 version: > 4.8.0
> | checking PROJ.4: epsg found and readable... yes
> | checking PROJ.4: conus found and readable... yes
> | configure: Package CPP flags:  -I/usr/local/Cellar/gdal-20/2.1.0/include
> | configure: Package LIBS:  -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj
> | configure: creating ./config.status
> | config.status: creating src/Makevars
> | ** libs
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c OGR_write.cpp -o OGR_write.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c gdal-bindings.cpp -o gdal-bindings.o
> | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c init.c -o init.o
> | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c inverser.c -o inverser.o
> | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c local_stubs.c -o local_stubs.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_geom.cpp -o ogr_geom.o
> | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_polygons.c -o ogr_polygons.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogr_proj.cpp -o ogr_proj.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrdrivers.cpp -o ogrdrivers.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c ogrsource.cpp -o ogrsource.o
> | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include"   -fPIC  -g -O2  -c projectit.cpp -o projectit.o
> | clang++ -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -L/usr/local/Cellar/r/3.3.1/R.framework/Resources/lib -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj -F/usr/local/Cellar/r/3.3.1/R.framework/.. -framework R -lintl -Wl,-framework -Wl,CoreFoundation
> | installing to /usr/local/lib/R/3.3/site-library/rgdal/libs
> | ** R
> | ** data
> | ** inst
> | ** preparing package for lazy loading
> | ** help
> | *** installing help indices
> | ** building package indices
> | ** installing vignettes
> | ** testing if installed package can be loaded
> | Error in dyn.load(file, DLLpath = DLLpath, ...) :
> |   unable to load shared object '/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so':
> |   dlopen(/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so, 6): Symbol not found: _GDALOpenEx
> |   Referenced from: /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
> |   Expected in: flat namespace
> |  in /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so
> | Error: loading failed
> | Execution halted
> | ERROR: loading failed
> | * removing ?/usr/local/lib/R/3.3/site-library/rgdal?
> | * restoring previous ?/usr/local/lib/R/3.3/site-library/rgdal?
> | Warning in install.packages :
> |   installation of package ?rgdal? had non-zero exit status
> |
> | The downloaded source packages are in
> |        ?/private/var/folders/50/wcr5bjwn75q595n6x82gxj280000gn/T/RtmpP8byD0/downloaded_packages?
> | >
> `----
>
> So it is using gdal 2.1.0 during compilation and installation.
>
> My understanding is now (but I might be wrong), that everything works in the building step, but
> when loading, it still tries to use the gdal 1.11.3 installation to run.
>
> What am I missing here?
>
> Thanks,
>
> Rainer
>
>
>
> --
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
>
> Tel :       +33 - (0)9 53 10 27 44
> Cell:       +33 - (0)6 85 62 59 98
> Fax :       +33 - (0)9 58 10 27 44
>
> Fax (D):    +49 - (0)3 21 21 25 22 44
>
> email:      Rainer at krugs.de
>
> Skype:      RMkrug
>
> PGP: 0x0F52F982
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160718/9aa4dbb9/attachment.bin>

From Roger.Bivand at nhh.no  Mon Jul 18 14:47:48 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 18 Jul 2016 12:47:48 +0000
Subject: [R-sig-Geo] Installing rgdal with gdal 2.0 on Mac using homebrew
In-Reply-To: <m27fcjt8zv.fsf@krugs.de>
References: <m21t2ruzrd.fsf@krugs.de>
	<4F58C8D16A2DF6F4.80e2522b-43b8-4011-8ee4-3e232b259538@mail.outlook.com>,
	<m27fcjt8zv.fsf@krugs.de>
Message-ID: <4F58C8D16A2DF6F4.b022aaa0-75ce-4a48-a84a-9e5e4a5a6d80@mail.outlook.com>

I don't know the OSX incantation, but if gdal 1 is found first, you'd need to put gdal 2 on the path before it.

Roger Bivand
Norwegian School of Economics
Bergen, Norway

Fra: Rainer M Krug
Sendt: mandag 18. juli, 14.40
Emne: Re: Installing rgdal with gdal 2.0 on Mac using homebrew
Til: Roger Bivand
Kopi: r-sig-geo at r-project.org

Roger Bivand writes: > Sounds like an LDPATH issue, where the gdal 1 dylib is found before gdal 2. Hm. Shouldn't, if I supply LDFLAGS, these libraries be used when running (loading) rgdal, or am I missing something here? LDPATH as well as LD_LIBRARY_PATH are not set in bash ,---- | > Sys.getenv("LDPATH") | [1] "" | > Sys.getenv("LD_LIBRARY_PATH") | [1] "" | > `---- Rainer > > Roger Bivand > Norwegian School of Economics > Bergen, Norway > > > > On Mon, Jul 18, 2016 at 10:18 AM +0200, "Rainer M Krug" > wrote: > > Hi > > I want to install rgdal for using gdal 2.0. The standard gdal package in > homebrew provides gdal 1.11.3, and gdal-20 is installed by using the > osgeo/osgeo4mac/gdal-20 formula, so gdal 2.1.0 is installed in > > /usr/local/opt/gdal-20/ > > If I simply say > > ,---- > | install.packages("rgdal, type="source") > `---- > > rgdal is installed without problems, but using gdal 1.11.3. > > But I want to use gdal 2.1.0 > > > The info from the gdal-20 formula says: > > ,---- > | If you build your > | own software and it requires this formula, you'll need to add to your > | build variables: > | > | LDFLAGS: -L/usr/local/opt/gdal-20/lib > | CPPFLAGS: -I/usr/local/opt/gdal-20/include > `---- > > So I did the following to install rgdal: > > ,---- > | > install.packages("rgdal", type = "source", configure.args = > | > "--with-gdal-config=/usr/local/opt/gdal-20/bin/gdal-config;LDFLAGS=-L/usr/local/opt/gdal-20/lib;CPPFLAGS=-I/usr/local/opt/gdal-20/include") > | Installing package into ?/usr/local/lib/R/3.3/site-library? > | (as ?lib? is unspecified) > | trying URL 'https://cran.rstudio.com/src/contrib/rgdal_1.1-10.tar.gz' > | Content type 'application/x-gzip' length 1653393 bytes (1.6 MB) > | ================================================== > | downloaded 1.6 MB > | > | * installing *source* package ?rgdal? ... > | ** package ?rgdal? successfully unpacked and MD5 sums checked > | configure: CC: clang > | configure: CXX: clang++ > | configure: rgdal: 1.1-10 > | checking for /usr/bin/svnversion... yes > | configure: svn revision: 622 > | configure: gdal-config set to /usr/local/opt/gdal-20/bin/gdal-config > | checking gdal-config exists... yes > | checking gdal-config executable... yes > | checking gdal-config usability... yes > | configure: GDAL: 2.1.0 > | checking GDAL version >= 1.6.3... yes > | configure: experimental conditional use of GDAL2 > | checking for gcc... clang > | checking whether the C compiler works... yes > | checking for C compiler default output file name... a.out > | checking for suffix of executables... > | checking whether we are cross compiling... no > | checking for suffix of object files... o > | checking whether we are using the GNU C compiler... yes > | checking whether clang accepts -g... yes > | checking for clang option to accept ISO C89... none needed > | checking how to run the C preprocessor... clang -E > | checking for grep that handles long lines and -e... /usr/bin/grep > | checking for egrep... /usr/bin/grep -E > | checking for ANSI C header files... > | rm: conftest.dSYM: is a directory > | rm: conftest.dSYM: is a directory > | yes > | checking for sys/types.h... yes > | checking for sys/stat.h... yes > | checking for stdlib.h... yes > | checking for string.h... yes > | checking for memory.h... yes > | checking for strings.h... yes > | checking for inttypes.h... yes > | checking for stdint.h... yes > | checking for unistd.h... yes > | checking gdal.h usability... yes > | checking gdal.h presence... yes > | checking for gdal.h... yes > | checking gdal: linking with --libs only... yes > | checking GDAL: /usr/local/Cellar/gdal-20/2.1.0/share/gdal/pcs.csv readable... yes > | checking proj_api.h usability... yes > | checking proj_api.h presence... yes > | checking for proj_api.h... yes > | checking for pj_init_plus in -lproj... yes > | configure: PROJ.4 version: > 4.8.0 > | checking PROJ.4: epsg found and readable... yes > | checking PROJ.4: conus found and readable... yes > | configure: Package CPP flags: -I/usr/local/Cellar/gdal-20/2.1.0/include > | configure: Package LIBS: -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj > | configure: creating ./config.status > | config.status: creating src/Makevars > | ** libs > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c OGR_write.cpp -o OGR_write.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c gdal-bindings.cpp -o gdal-bindings.o > | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c init.c -o init.o > | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c inverser.c -o inverser.o > | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c local_stubs.c -o local_stubs.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c ogr_geom.cpp -o ogr_geom.o > | clang -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c ogr_polygons.c -o ogr_polygons.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c ogr_proj.cpp -o ogr_proj.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c ogrdrivers.cpp -o ogrdrivers.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c ogrsource.cpp -o ogrsource.o > | clang++ -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG -I/usr/local/Cellar/gdal-20/2.1.0/include -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/opt/openssl/include -I/usr/local/include -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c projectit.cpp -o projectit.o > | clang++ -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -L/usr/local/Cellar/r/3.3.1/R.framework/Resources/lib -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib -L/usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj -F/usr/local/Cellar/r/3.3.1/R.framework/.. -framework R -lintl -Wl,-framework -Wl,CoreFoundation > | installing to /usr/local/lib/R/3.3/site-library/rgdal/libs > | ** R > | ** data > | ** inst > | ** preparing package for lazy loading > | ** help > | *** installing help indices > | ** building package indices > | ** installing vignettes > | ** testing if installed package can be loaded > | Error in dyn.load(file, DLLpath = DLLpath, ...) : > | unable to load shared object '/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so': > | dlopen(/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so, 6): Symbol not found: _GDALOpenEx > | Referenced from: /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so > | Expected in: flat namespace > | in /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so > | Error: loading failed > | Execution halted > | ERROR: loading failed > | * removing ?/usr/local/lib/R/3.3/site-library/rgdal? > | * restoring previous ?/usr/local/lib/R/3.3/site-library/rgdal? > | Warning in install.packages : > | installation of package ?rgdal? had non-zero exit status > | > | The downloaded source packages are in > | ?/private/var/folders/50/wcr5bjwn75q595n6x82gxj280000gn/T/RtmpP8byD0/downloaded_packages? > | > > `---- > > So it is using gdal 2.1.0 during compilation and installation. > > My understanding is now (but I might be wrong), that everything works in the building step, but > when loading, it still tries to use the gdal 1.11.3 installation to run. > > What am I missing here? > > Thanks, > > Rainer > > > > -- > Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany) > > Centre of Excellence for Invasion Biology > Stellenbosch University > South Africa > > Tel : +33 - (0)9 53 10 27 44 > Cell: +33 - (0)6 85 62 59 98 > Fax : +33 - (0)9 58 10 27 44 > > Fax (D): +49 - (0)3 21 21 25 22 44 > > email: Rainer at krugs.de > > Skype: RMkrug > > PGP: 0x0F52F982 > > [[alternative HTML version deleted]] > > _______________________________________________ > R-sig-Geo mailing list > R-sig-Geo at r-project.org > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Rainer M. Krug email: Rainerkrugsde PGP: 0x0F52F982

	[[alternative HTML version deleted]]


From Rainer at krugs.de  Mon Jul 18 14:58:47 2016
From: Rainer at krugs.de (Rainer M Krug)
Date: Mon, 18 Jul 2016 14:58:47 +0200
Subject: [R-sig-Geo] Installing rgdal with gdal 2.0 on Mac using homebrew
In-Reply-To: <4F58C8D16A2DF6F4.b022aaa0-75ce-4a48-a84a-9e5e4a5a6d80@mail.outlook.com>
	(Roger Bivand's message of "Mon, 18 Jul 2016 12:47:48 +0000")
References: <m21t2ruzrd.fsf@krugs.de>
	<4F58C8D16A2DF6F4.80e2522b-43b8-4011-8ee4-3e232b259538@mail.outlook.com>
	<m27fcjt8zv.fsf@krugs.de>
	<4F58C8D16A2DF6F4.b022aaa0-75ce-4a48-a84a-9e5e4a5a6d80@mail.outlook.com>
Message-ID: <m237n7t854.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> I don't know the OSX incantation, but if gdal 1 is found first, you'd need to put gdal 2 on the path before it.

But than gdal 2 libraries would be always used which I also don't want to do.

Rainer

>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
> Fra: Rainer M Krug
> Sendt: mandag 18. juli, 14.40
> Emne: Re: Installing rgdal with gdal 2.0 on Mac using homebrew
> Til: Roger Bivand
> Kopi: r-sig-geo at r-project.org
>
> Roger Bivand writes: > Sounds like an LDPATH issue, where the gdal 1
> dylib is found before gdal 2. Hm. Shouldn't, if I supply LDFLAGS,
> these libraries be used when running (loading) rgdal, or am I missing
> something here? LDPATH as well as LD_LIBRARY_PATH are not set in bash
> ,---- | > Sys.getenv("LDPATH") | [1] "" | >
> Sys.getenv("LD_LIBRARY_PATH") | [1] "" | > `---- Rainer > > Roger
> Bivand > Norwegian School of Economics > Bergen, Norway > > > > On
> Mon, Jul 18, 2016 at 10:18 AM +0200, "Rainer M Krug" > wrote: > > Hi >
>> I want to install rgdal for using gdal 2.0. The standard gdal
> package in > homebrew provides gdal 1.11.3, and gdal-20 is installed
> by using the > osgeo/osgeo4mac/gdal-20 formula, so gdal 2.1.0 is
> installed in > > /usr/local/opt/gdal-20/ > > If I simply say > > ,----
>> | install.packages("rgdal, type="source") > `---- > > rgdal is
> installed without problems, but using gdal 1.11.3. > > But I want to
> use gdal 2.1.0 > > > The info from the gdal-20 formula says: > > ,----
>> | If you build your > | own software and it requires this formula,
> you'll need to add to your > | build variables: > | > | LDFLAGS:
> -L/usr/local/opt/gdal-20/lib > | CPPFLAGS:
> -I/usr/local/opt/gdal-20/include > `---- > > So I did the following to
> install rgdal: > > ,---- > | > install.packages("rgdal", type =
> "source", configure.args = > | >
> "--with-gdal-config=/usr/local/opt/gdal-20/bin/gdal-config;LDFLAGS=-L/usr/local/opt/gdal-20/lib;CPPFLAGS=-I/usr/local/opt/gdal-20/include")
>> | Installing package into ?/usr/local/lib/R/3.3/site-library?
>> | (as ?lib? is unspecified) > | trying URL
> 'https://cran.rstudio.com/src/contrib/rgdal_1.1-10.tar.gz' > | Content
> type 'application/x-gzip' length 1653393 bytes (1.6 MB) > |
> ================================================== > | downloaded 1.6
> MB > | > | * installing *source* package ?rgdal? ... > | **
> package ?rgdal? successfully unpacked and MD5 sums checked > |
> configure: CC: clang > | configure: CXX: clang++ > | configure: rgdal:
> 1.1-10 > | checking for /usr/bin/svnversion... yes > | configure: svn
> revision: 622 > | configure: gdal-config set to
> /usr/local/opt/gdal-20/bin/gdal-config > | checking gdal-config
> exists... yes > | checking gdal-config executable... yes > | checking
> gdal-config usability... yes > | configure: GDAL: 2.1.0 > | checking
> GDAL version >= 1.6.3... yes > | configure: experimental conditional
> use of GDAL2 > | checking for gcc... clang > | checking whether the C
> compiler works... yes > | checking for C compiler default output file
> name... a.out > | checking for suffix of executables... > | checking
> whether we are cross compiling... no > | checking for suffix of object
> files... o > | checking whether we are using the GNU C compiler... yes
>> | checking whether clang accepts -g... yes > | checking for clang
> option to accept ISO C89... none needed > | checking how to run the C
> preprocessor... clang -E > | checking for grep that handles long lines
> and -e... /usr/bin/grep > | checking for egrep... /usr/bin/grep -E > |
> checking for ANSI C header files... > | rm: conftest.dSYM: is a
> directory > | rm: conftest.dSYM: is a directory > | yes > | checking
> for sys/types.h... yes > | checking for sys/stat.h... yes > | checking
> for stdlib.h... yes > | checking for string.h... yes > | checking for
> memory.h... yes > | checking for strings.h... yes > | checking for
> inttypes.h... yes > | checking for stdint.h... yes > | checking for
> unistd.h... yes > | checking gdal.h usability... yes > | checking
> gdal.h presence... yes > | checking for gdal.h... yes > | checking
> gdal: linking with --libs only... yes > | checking GDAL:
> /usr/local/Cellar/gdal-20/2.1.0/share/gdal/pcs.csv readable... yes > |
> checking proj_api.h usability... yes > | checking proj_api.h
> presence... yes > | checking for proj_api.h... yes > | checking for
> pj_init_plus in -lproj... yes > | configure: PROJ.4 version: > 4.8.0 >
> | checking PROJ.4: epsg found and readable... yes > | checking PROJ.4:
> conus found and readable... yes > | configure: Package CPP flags:
> -I/usr/local/Cellar/gdal-20/2.1.0/include > | configure: Package LIBS:
> -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj > | configure:
> creating ./config.status > | config.status: creating src/Makevars > |
> ** libs > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> OGR_write.cpp -o OGR_write.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> gdal-bindings.cpp -o gdal-bindings.o > | clang
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> init.c -o init.o > | clang
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> inverser.c -o inverser.o > | clang
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> local_stubs.c -o local_stubs.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> ogr_geom.cpp -o ogr_geom.o > | clang
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> ogr_polygons.c -o ogr_polygons.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> ogr_proj.cpp -o ogr_proj.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> ogrdrivers.cpp -o ogrdrivers.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> ogrsource.cpp -o ogrsource.o > | clang++
> -I/usr/local/Cellar/r/3.3.1/R.framework/Resources/include -DNDEBUG
> -I/usr/local/Cellar/gdal-20/2.1.0/include
> -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include
> -I/usr/local/opt/openssl/include -I/usr/local/include
> -I"/usr/local/lib/R/3.3/site-library/sp/include" -fPIC -g -O2 -c
> projectit.cpp -o projectit.o > | clang++ -dynamiclib
> -Wl,-headerpad_max_install_names -undefined dynamic_lookup
> -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib
> -L/usr/local/opt/readline/lib -L/usr/local/opt/openssl/lib
> -L/usr/local/lib -L/usr/local/Cellar/r/3.3.1/R.framework/Resources/lib
> -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib
> -L/usr/local/opt/openssl/lib -L/usr/local/lib -o rgdal.so OGR_write.o
> gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o
> ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o
> -L/usr/local/Cellar/gdal-20/2.1.0/lib -lgdal -lproj
> -F/usr/local/Cellar/r/3.3.1/R.framework/.. -framework R -lintl
> -Wl,-framework -Wl,CoreFoundation > | installing to
> /usr/local/lib/R/3.3/site-library/rgdal/libs > | ** R > | ** data > |
> ** inst > | ** preparing package for lazy loading > | ** help > | ***
> installing help indices > | ** building package indices > | **
> installing vignettes > | ** testing if installed package can be loaded
>> | Error in dyn.load(file, DLLpath = DLLpath, ...) : > | unable to
> load shared object
> '/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so': > |
> dlopen(/usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so, 6):
> Symbol not found: _GDALOpenEx > | Referenced from:
> /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so > | Expected in:
> flat namespace > | in
> /usr/local/lib/R/3.3/site-library/rgdal/libs/rgdal.so > | Error:
> loading failed > | Execution halted > | ERROR: loading failed > | *
> removing ?/usr/local/lib/R/3.3/site-library/rgdal? > | *
> restoring previous ?/usr/local/lib/R/3.3/site-library/rgdal? > |
> Warning in install.packages : > | installation of package
> ?rgdal? had non-zero exit status > | > | The downloaded source
> packages are in > |
> ?/private/var/folders/50/wcr5bjwn75q595n6x82gxj280000gn/T/RtmpP8byD0/downloaded_packages?
>> | > > `---- > > So it is using gdal 2.1.0 during compilation and
> installation. > > My understanding is now (but I might be wrong), that
> everything works in the building step, but > when loading, it still
> tries to use the gdal 1.11.3 installation to run. > > What am I
> missing here? > > Thanks, > > Rainer > > > > -- > Rainer M. Krug, PhD
> (Conservation Ecology, SUN), MSc (Conservation Biology, UCT),
> Dipl. Phys. (Germany) > > Centre of Excellence for Invasion Biology >
> Stellenbosch University > South Africa > > Tel : +33 - (0)9 53 10 27
> 44 > Cell: +33 - (0)6 85 62 59 98 > Fax : +33 - (0)9 58 10 27 44 > >
> Fax (D): +49 - (0)3 21 21 25 22 44 > > email: Rainer at krugs.de > >
> Skype: RMkrug > > PGP: 0x0F52F982 > > [[alternative HTML version
> deleted]] > > _______________________________________________ >
> R-sig-Geo mailing list > R-sig-Geo at r-project.org >
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Rainer M. Krug
> email: Rainerkrugsde PGP: 0x0F52F982
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160718/2701de12/attachment.bin>

From mel at mbacou.com  Mon Jul 18 17:16:31 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Mon, 18 Jul 2016 11:16:31 -0400
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
In-Reply-To: <578CCD32.9030600@gmail.com>
References: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
	<CABkCotQWTy4RPumKNG2gytaDGfb0K2F_D7tcJPg5scdskA10HA@mail.gmail.com>
	<578CCD32.9030600@gmail.com>
Message-ID: <508a8c5c-82cb-ffab-213f-f35ea93bbce6@mbacou.com>

No self promotion, but in case you're looking for code examples using 
leaflet plugins (scalebar and minimap) available through `tmap` :
http://tools.harvestchoice.org/ar/ (code is linked at the bottom of the 
page).

--Mel.


On 7/18/2016 8:36 AM, Tim Appelhans wrote:
> My suggestion would be the wonderful tmap package. It is, however, 
> using OpenStreetMap rather than google for background maps AFAIK.
>
> Tim
>
> On 18.07.2016 14:32, Manuel Sp?nola wrote:
>> Or you can try the package ggsn with the package ggmap
>>
>> Manuel
>>
>> 2016-07-17 22:57 GMT-06:00 Chris Lusk <clusk at waikato.ac.nz>:
>>
>>> Hi - I've made a map to show the spatial arrangement of my plots, 
>>> and would
>>> now like to add a scale bar (in hundreds of metres) and a north 
>>> arrow. I've
>>> seen several solutions online, most of which threw error messages 
>>> when I
>>> tried them. Although the solution below doesn't give an error 
>>> message, it
>>> doesn't actually add anything to the map!
>>>
>>> Any advice would be appreciated.
>>>
>>> Chris
>>> ..........
>>>
>>> library(ggplot2)
>>> library(ggmap)
>>> library(maps)
>>> library(GISTools)
>>>
>>> ##Coordinates of four types of plots
>>> Gaps <- read.table(text="lon lat
>>> 176.431823     -38.086894
>>> 176.4329002     -38.08855667
>>> 176.4286505     -38.08421246
>>> 176.4239767     -38.08297953
>>> 176.4306576     -38.09032491
>>> 176.4181457     -38.08283416
>>> 176.4325089     -38.09042394
>>> 176.4243027     -38.08215021
>>> 176.4220882     -38.08720573
>>> 176.430974    -38.093108", header = TRUE, strip.white = TRUE)
>>>
>>> Understorey <- read.table(text="lon lat
>>> 176.431523   -38.086965
>>> 176.418408   -38.082935
>>> 176.4244189     -38.08242069
>>> 176.4287644     -38.08372266
>>> 176.4240118     -38.0823004
>>> 176.4333778     -38.08853369
>>> 176.4217424     -38.0876122
>>> 176.4309304     -38.09055117
>>> 176.4324084     -38.0907023
>>> 176.430821   -38.093687", header = TRUE, strip.white = TRUE)
>>>
>>> Treeferns <- read.table(text="lon lat
>>> 176.432134      -38.086298
>>> 176.4246547     -38.08226916
>>> 176.4335132     -38.08801622
>>> 176.4183628     -38.08260261
>>> 176.429       -38.08413018
>>> 176.4213997     -38.08710868
>>> 176.4304333     -38.09064678
>>> 176.4324081     -38.0909994
>>> 176.4242689     -38.08264669
>>> 176.429837      -38.093061", header = TRUE, strip.white = TRUE)
>>>
>>> Margins <- read.table(text="lon lat
>>> 176.4225302     -38.08177849
>>> 176.427018     -38.08879161
>>> 176.4207786     -38.08356826
>>> 176.4315118     -38.08251629
>>> 176.426456     -38.08920441
>>> 176.426010   -38.088253
>>> 176.422526   -38.082794
>>> 176.421399   -38.084780
>>> 176.429339   -38.092742", header = TRUE, strip.white = TRUE)
>>>
>>> ## Get the map at right zoom level
>>> OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
>>> maptype='hybrid', zoom=15)
>>>
>>> ## Plot the points on the map
>>> ggmap(OkatainaMap) +
>>>    geom_point(data=Gaps, aes(x=lon, y=lat), pch=15, 
>>> colour="chartreuse1",
>>> size=2.5, alpha=1) +
>>>    geom_point(data=Understorey, aes(x=lon, y=lat), pch=21, 
>>> colour="gray40",
>>> bg="black", size=3, alpha=1) +
>>>    geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23, 
>>> colour="gray40",
>>> bg="blue", size=2.5, alpha=1) +
>>>    geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
>>> size=2.5, alpha=1)
>>>
>>> ##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)
>>>
>>> map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
>>> north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")
>>>
>>> ...................
>>>
>>>
>>> Dr. Chris Lusk
>>> Senior Research Fellow
>>> Environmental Research Institute
>>> The University of Waikato
>>> Private Bag 3105, Hamilton
>>> New Zealand / Aotearoa
>>> http://sci.waikato.ac.nz/sites/clusk/
>>> Ph 64 7 838 4205
>>> Senior Editor, *NZ J Botany*
>>> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>


From dosc3612 at colorado.edu  Mon Jul 18 18:34:06 2016
From: dosc3612 at colorado.edu (Dominik Schneider)
Date: Mon, 18 Jul 2016 10:34:06 -0600
Subject: [R-sig-Geo] putting scalebar and north arrow on google map
In-Reply-To: <508a8c5c-82cb-ffab-213f-f35ea93bbce6@mbacou.com>
References: <CABqyKtsdKYYK_1T-E0RYQKxXvxEGbVHXsygZYJPtxxvdg+cNAA@mail.gmail.com>
	<CABkCotQWTy4RPumKNG2gytaDGfb0K2F_D7tcJPg5scdskA10HA@mail.gmail.com>
	<578CCD32.9030600@gmail.com>
	<508a8c5c-82cb-ffab-213f-f35ea93bbce6@mbacou.com>
Message-ID: <CAF1jk_mzHk3B2EomjcCPNk7e=2ffCnQaHCTFpw-3XGyg+zW+2g@mail.gmail.com>

+1 ggsn

On Mon, Jul 18, 2016 at 9:16 AM, Bacou, Melanie <mel at mbacou.com> wrote:

> No self promotion, but in case you're looking for code examples using
> leaflet plugins (scalebar and minimap) available through `tmap` :
> http://tools.harvestchoice.org/ar/ (code is linked at the bottom of the
> page).
>
> --Mel.
>
>
>
> On 7/18/2016 8:36 AM, Tim Appelhans wrote:
>
>> My suggestion would be the wonderful tmap package. It is, however, using
>> OpenStreetMap rather than google for background maps AFAIK.
>>
>> Tim
>>
>> On 18.07.2016 14:32, Manuel Sp?nola wrote:
>>
>>> Or you can try the package ggsn with the package ggmap
>>>
>>> Manuel
>>>
>>> 2016-07-17 22:57 GMT-06:00 Chris Lusk <clusk at waikato.ac.nz>:
>>>
>>> Hi - I've made a map to show the spatial arrangement of my plots, and
>>>> would
>>>> now like to add a scale bar (in hundreds of metres) and a north arrow.
>>>> I've
>>>> seen several solutions online, most of which threw error messages when I
>>>> tried them. Although the solution below doesn't give an error message,
>>>> it
>>>> doesn't actually add anything to the map!
>>>>
>>>> Any advice would be appreciated.
>>>>
>>>> Chris
>>>> ..........
>>>>
>>>> library(ggplot2)
>>>> library(ggmap)
>>>> library(maps)
>>>> library(GISTools)
>>>>
>>>> ##Coordinates of four types of plots
>>>> Gaps <- read.table(text="lon lat
>>>> 176.431823     -38.086894
>>>> 176.4329002     -38.08855667
>>>> 176.4286505     -38.08421246
>>>> 176.4239767     -38.08297953
>>>> 176.4306576     -38.09032491
>>>> 176.4181457     -38.08283416
>>>> 176.4325089     -38.09042394
>>>> 176.4243027     -38.08215021
>>>> 176.4220882     -38.08720573
>>>> 176.430974    -38.093108", header = TRUE, strip.white = TRUE)
>>>>
>>>> Understorey <- read.table(text="lon lat
>>>> 176.431523   -38.086965
>>>> 176.418408   -38.082935
>>>> 176.4244189     -38.08242069
>>>> 176.4287644     -38.08372266
>>>> 176.4240118     -38.0823004
>>>> 176.4333778     -38.08853369
>>>> 176.4217424     -38.0876122
>>>> 176.4309304     -38.09055117
>>>> 176.4324084     -38.0907023
>>>> 176.430821   -38.093687", header = TRUE, strip.white = TRUE)
>>>>
>>>> Treeferns <- read.table(text="lon lat
>>>> 176.432134      -38.086298
>>>> 176.4246547     -38.08226916
>>>> 176.4335132     -38.08801622
>>>> 176.4183628     -38.08260261
>>>> 176.429       -38.08413018
>>>> 176.4213997     -38.08710868
>>>> 176.4304333     -38.09064678
>>>> 176.4324081     -38.0909994
>>>> 176.4242689     -38.08264669
>>>> 176.429837      -38.093061", header = TRUE, strip.white = TRUE)
>>>>
>>>> Margins <- read.table(text="lon lat
>>>> 176.4225302     -38.08177849
>>>> 176.427018     -38.08879161
>>>> 176.4207786     -38.08356826
>>>> 176.4315118     -38.08251629
>>>> 176.426456     -38.08920441
>>>> 176.426010   -38.088253
>>>> 176.422526   -38.082794
>>>> 176.421399   -38.084780
>>>> 176.429339   -38.092742", header = TRUE, strip.white = TRUE)
>>>>
>>>> ## Get the map at right zoom level
>>>> OkatainaMap <- get_googlemap(center = c(lon = 176.425, lat = -38.0845),
>>>> maptype='hybrid', zoom=15)
>>>>
>>>> ## Plot the points on the map
>>>> ggmap(OkatainaMap) +
>>>>    geom_point(data=Gaps, aes(x=lon, y=lat), pch=15,
>>>> colour="chartreuse1",
>>>> size=2.5, alpha=1) +
>>>>    geom_point(data=Understorey, aes(x=lon, y=lat), pch=21,
>>>> colour="gray40",
>>>> bg="black", size=3, alpha=1) +
>>>>    geom_point(data=Treeferns, aes(x=lon, y=lat), pch=23,
>>>> colour="gray40",
>>>> bg="blue", size=2.5, alpha=1) +
>>>>    geom_point(data=Margins, aes(x=lon, y=lat), pch=17, colour="orange",
>>>> size=2.5, alpha=1)
>>>>
>>>> ##Add scale and north arrow (NEITHER COMMAND WORKS FOR ME)
>>>>
>>>> map.scale(x=176.42,y=-38.092, ratio=FALSE, relwidth=0.2, col="white")
>>>> north.arrow(xb=176.435, yb=-38.079, len=0.02, lab="N", col="white")
>>>>
>>>> ...................
>>>>
>>>>
>>>> Dr. Chris Lusk
>>>> Senior Research Fellow
>>>> Environmental Research Institute
>>>> The University of Waikato
>>>> Private Bag 3105, Hamilton
>>>> New Zealand / Aotearoa
>>>> http://sci.waikato.ac.nz/sites/clusk/
>>>> Ph 64 7 838 4205
>>>> Senior Editor, *NZ J Botany*
>>>> ~  ~  ~  ~  ~  ~  ~  ~  ~  ~  ~
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>
>>>
>>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Guy.Bayegnak at gov.ab.ca  Mon Jul 18 20:13:52 2016
From: Guy.Bayegnak at gov.ab.ca (Guy Bayegnak)
Date: Mon, 18 Jul 2016 18:13:52 +0000
Subject: [R-sig-Geo] Geographically weighted regression on categorical
	variable
Message-ID: <71D4D04D426B3B488D6C7FE26376FDE72AD9076D@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>


Hi All,

I am trying to perform geographically weighted regression on categorical variables.  The majority of answers I found on the web suggest that this is not doable or not recommended.  I found only one post from Roger Bivan (https://stat.ethz.ch/pipermail/r-help/2007-September/141586.html ) that indicated that it was possible, and that the R-sig-geo list is more focused on this kind of question. I have therefore registered, but I am not sure if the mailing list is "searchable".

I have point data collected over a geographical area A.  My data are groundwater quality type. And I have 3 types. When I plot it of a map it looks like 2 of the types are clustered and occur next to each other.  My suspicion is that these two clustered type may be influenced by their proximity to the some potential sources.  I used the spatstats package to explore the data,  using L-cross function.  The result of the analysis show that the 3 types appear to be influenced by the source, although the two groundwater that are clustered appear to deviate much more from the theoretical L-cross.  Now I am trying to explore the relationship between the water types and the potential source using geographically weighted regression on categorical variables.  Most of the material a read deals with continuous variables, and tend to focus on areal (polygons) features rather than point features.

Is there any way to perform geographically weighted regression on points categorical variables using R?

Thanks,
GAB




This email and any files transmitted with it are confide...{{dropped:7}}


From dosc3612 at colorado.edu  Mon Jul 18 21:09:36 2016
From: dosc3612 at colorado.edu (Dominik Schneider)
Date: Mon, 18 Jul 2016 13:09:36 -0600
Subject: [R-sig-Geo] Geographically weighted regression on categorical
	variable
In-Reply-To: <71D4D04D426B3B488D6C7FE26376FDE72AD9076D@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
References: <71D4D04D426B3B488D6C7FE26376FDE72AD9076D@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
Message-ID: <CAF1jk_mitL3H3WJAwYBtqnu4Z5KofLHW41YehewqkthaCweWyA@mail.gmail.com>

Sorry I don't know the answer but you can search here:
http://grokbase.com/g/r/r-sig-geo

On Mon, Jul 18, 2016 at 12:13 PM, Guy Bayegnak <Guy.Bayegnak at gov.ab.ca>
wrote:

>
> Hi All,
>
> I am trying to perform geographically weighted regression on categorical
> variables.  The majority of answers I found on the web suggest that this is
> not doable or not recommended.  I found only one post from Roger Bivan (
> https://stat.ethz.ch/pipermail/r-help/2007-September/141586.html ) that
> indicated that it was possible, and that the R-sig-geo list is more focused
> on this kind of question. I have therefore registered, but I am not sure if
> the mailing list is "searchable".
>
> I have point data collected over a geographical area A.  My data are
> groundwater quality type. And I have 3 types. When I plot it of a map it
> looks like 2 of the types are clustered and occur next to each other.  My
> suspicion is that these two clustered type may be influenced by their
> proximity to the some potential sources.  I used the spatstats package to
> explore the data,  using L-cross function.  The result of the analysis show
> that the 3 types appear to be influenced by the source, although the two
> groundwater that are clustered appear to deviate much more from the
> theoretical L-cross.  Now I am trying to explore the relationship between
> the water types and the potential source using geographically weighted
> regression on categorical variables.  Most of the material a read deals
> with continuous variables, and tend to focus on areal (polygons) features
> rather than point features.
>
> Is there any way to perform geographically weighted regression on points
> categorical variables using R?
>
> Thanks,
> GAB
>
>
>
>
> This email and any files transmitted with it are confide...{{dropped:7}}
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From yaara.rotman at yahoo.com  Tue Jul 19 04:42:29 2016
From: yaara.rotman at yahoo.com (yaara.rotman at yahoo.com)
Date: Tue, 19 Jul 2016 02:42:29 +0000 (UTC)
Subject: [R-sig-Geo] storing data frame as SpatialPixelsDataFrame with
 coordinate intervals not constant
References: <621139237.1461229.1468896149214.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <621139237.1461229.1468896149214.JavaMail.yahoo@mail.yahoo.com>

 Hi All,
I am trying to?store my bird tracking data?(data frame,??wfg), which contains the following, to a SpatialPixelsDataFrame class, in order to estimate the utilization distribution using BRB function in the adehabitatHR package.
head(wfg)  bird             Date      lon      lat
 BYH003 2015-03-03 16:01 116.3377 29.17813
 BYH003 2015-02-24 17:00 116.5762 29.15807
 BYH003  2015-02-15 9:01 116.5378 29.15275
 BYH003  2015-03-26 2:00 116.1493 29.69087
 BYH003 2015-04-07 18:00 123.2714 42.80138
 BYH003  2015-02-28 2:00 116.5735 29.15929

I am first storing in a SpatialPointsDataFrame.

> wfgP <- SpatialPointsDataFrame(wfg [, c("lon", "lat")], wfg)
## I then want to store it into SpatialPixelsDataFrame
??? SpatialPixelsDataFrame(wfgP[c("lon", "lat")], wfgP, tolerance = sqrt(.Machine$double.eps))
result in the error:Error in points2grid(points, tolerance, round) : 
  dimension 1 : coordinate intervals are not constant I read that because my coordinates intervals are not constant, I should set the tolerance intervals. But this still doesn't allow the storing of SpatialPixels.
I tried different tolerance values, but still couldn't solve it.
Can I actually store this data set in SpatialPixelsDataFrame? If someone can point out on my mistake, I will highly appreciate.

Cheers,Yaara




	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Tue Jul 19 07:47:49 2016
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 19 Jul 2016 07:47:49 +0200
Subject: [R-sig-Geo] storing data frame as SpatialPixelsDataFrame with
 coordinate intervals not constant
In-Reply-To: <621139237.1461229.1468896149214.JavaMail.yahoo@mail.yahoo.com>
References: <621139237.1461229.1468896149214.JavaMail.yahoo.ref@mail.yahoo.com>
	<621139237.1461229.1468896149214.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <578DBF05.3020209@uni-muenster.de>



On 19/07/16 04:42, Yaara via R-sig-Geo wrote:
>  Hi All,
> I am trying to store my bird tracking data (data frame,  wfg), which contains the following, to a SpatialPixelsDataFrame class, in order to estimate the utilization distribution using BRB function in the adehabitatHR package.
> head(wfg)  bird             Date      lon      lat
>  BYH003 2015-03-03 16:01 116.3377 29.17813
>  BYH003 2015-02-24 17:00 116.5762 29.15807
>  BYH003  2015-02-15 9:01 116.5378 29.15275
>  BYH003  2015-03-26 2:00 116.1493 29.69087
>  BYH003 2015-04-07 18:00 123.2714 42.80138
>  BYH003  2015-02-28 2:00 116.5735 29.15929
> 
> I am first storing in a SpatialPointsDataFrame.
> 
>> wfgP <- SpatialPointsDataFrame(wfg [, c("lon", "lat")], wfg)
> ## I then want to store it into SpatialPixelsDataFrame
>     SpatialPixelsDataFrame(wfgP[c("lon", "lat")], wfgP, tolerance = sqrt(.Machine$double.eps))
> result in the error:Error in points2grid(points, tolerance, round) : 
>   dimension 1 : coordinate intervals are not constant I read that because my coordinates intervals are not constant, I should set the tolerance intervals. But this still doesn't allow the storing of SpatialPixels.
> I tried different tolerance values, but still couldn't solve it.
> Can I actually store this data set in SpatialPixelsDataFrame? If someone can point out on my mistake, I will highly appreciate.


SpatialPixelsDataFrame are there for data whose spatial coordinates
coincide with a location on a regular grid. Typical tracking data
results in locations that are completely irregular. tolerance tries to
find the grid if data are nearly on a grid. In your case, they are not
nearly on a grid.

Hth,

> 
> Cheers,Yaara
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160719/aa9e84cf/attachment.bin>

From yaara.rotman at yahoo.com  Tue Jul 19 09:30:18 2016
From: yaara.rotman at yahoo.com (yaara.rotman at yahoo.com)
Date: Tue, 19 Jul 2016 07:30:18 +0000 (UTC)
Subject: [R-sig-Geo] storing data frame as SpatialPixelsDataFrame with
 coordinate intervals not constant
In-Reply-To: <578DBF05.3020209@uni-muenster.de>
References: <621139237.1461229.1468896149214.JavaMail.yahoo.ref@mail.yahoo.com>
	<621139237.1461229.1468896149214.JavaMail.yahoo@mail.yahoo.com>
	<578DBF05.3020209@uni-muenster.de>
Message-ID: <1635395540.1545585.1468913418789.JavaMail.yahoo@mail.yahoo.com>

Many thank you for your quick reply,
Does anyone have a suggestion for a method to calculate the utilization density (UD) in this kind of data set?

I used the kernelUD() function in the adehabitatHR package, with smoothig parameter= "href", but wonder if this is appropriate in the case of my data.
Thanks,Yaara
 

    On Tuesday, July 19, 2016 1:48 PM, Edzer Pebesma <edzer.pebesma at uni-muenster.de> wrote:
 

 

On 19/07/16 04:42, Yaara via R-sig-Geo wrote:
>? Hi All,
> I am trying to store my bird tracking data (data frame,? wfg), which contains the following, to a SpatialPixelsDataFrame class, in order to estimate the utilization distribution using BRB function in the adehabitatHR package.
> head(wfg)? bird? ? ? ? ? ? Date? ? ? lon? ? ? lat
>? BYH003 2015-03-03 16:01 116.3377 29.17813
>? BYH003 2015-02-24 17:00 116.5762 29.15807
>? BYH003? 2015-02-15 9:01 116.5378 29.15275
>? BYH003? 2015-03-26 2:00 116.1493 29.69087
>? BYH003 2015-04-07 18:00 123.2714 42.80138
>? BYH003? 2015-02-28 2:00 116.5735 29.15929
> 
> I am first storing in a SpatialPointsDataFrame.
> 
>> wfgP <- SpatialPointsDataFrame(wfg [, c("lon", "lat")], wfg)
> ## I then want to store it into SpatialPixelsDataFrame
>? ? SpatialPixelsDataFrame(wfgP[c("lon", "lat")], wfgP, tolerance = sqrt(.Machine$double.eps))
> result in the error:Error in points2grid(points, tolerance, round) : 
>? dimension 1 : coordinate intervals are not constant I read that because my coordinates intervals are not constant, I should set the tolerance intervals. But this still doesn't allow the storing of SpatialPixels.
> I tried different tolerance values, but still couldn't solve it.
> Can I actually store this data set in SpatialPixelsDataFrame? If someone can point out on my mistake, I will highly appreciate.


SpatialPixelsDataFrame are there for data whose spatial coordinates
coincide with a location on a regular grid. Typical tracking data
results in locations that are completely irregular. tolerance tries to
find the grid if data are nearly on a grid. In your case, they are not
nearly on a grid.

Hth,

> 
> Cheers,Yaara
> 
> 
> 
> 
> ??? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics? (ifgi),? University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:? http://www.jstatsoft.org/
Computers & Geosciences:? http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info/

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

  
	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Tue Jul 19 10:09:53 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 19 Jul 2016 08:09:53 +0000
Subject: [R-sig-Geo] storing data frame as SpatialPixelsDataFrame with
 coordinate intervals not constant
In-Reply-To: <1635395540.1545585.1468913418789.JavaMail.yahoo@mail.yahoo.com>
References: <621139237.1461229.1468896149214.JavaMail.yahoo.ref@mail.yahoo.com>
	<621139237.1461229.1468896149214.JavaMail.yahoo@mail.yahoo.com>
	<578DBF05.3020209@uni-muenster.de>
	<1635395540.1545585.1468913418789.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAAcGz9-3wzSm+xY4K-3iAZddJ+Fd5PdnQ3fY=4eU-POarnDbxg@mail.gmail.com>

On Tue, Jul 19, 2016, 17:30 Yaara via R-sig-Geo <r-sig-geo at r-project.org>
wrote:

> Many thank you for your quick reply,
> Does anyone have a suggestion for a method to calculate the utilization
> density (UD) in this kind of data set?
>
> I used the kernelUD() function in the adehabitatHR package, with smoothig
> parameter= "href", but wonder if this is appropriate in the case of my data.
>



Interpolation like this is really a model and so requires careeful
oversight from you. We don't have enough information to know what's
appropriate for you.

You can apply more general "gridding" to points, start with
raster::rasterize and raster:: interpolate for pointers to general methods,
many provided by other packaged.

Since you have tracking data the methods in adehabitatHR are probably
better than many others. An alternative to give simple time-spent in area
is implemented in the trip package as a rasterize method, but requires
another structure built from the same data. There are many coercion methods
for analogous structures, but these "as(x, 'type')" functions are scattered
around they can take some finding.

Look at different "trajectory" packages and explore what they do in more
detail.

raster() understands adehabitatHR objects so I recommend using that for
more general handling of the gridded outputs.

Cheers, Mike

Thanks,Yaara
>
>
>     On Tuesday, July 19, 2016 1:48 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
>
>
>
>
> On 19/07/16 04:42, Yaara via R-sig-Geo wrote:
> >  Hi All,
> > I am trying to store my bird tracking data (data frame,  wfg), which
> contains the following, to a SpatialPixelsDataFrame class, in order to
> estimate the utilization distribution using BRB function in the
> adehabitatHR package.
> > head(wfg)  bird            Date      lon      lat
> >  BYH003 2015-03-03 16:01 116.3377 29.17813
> >  BYH003 2015-02-24 17:00 116.5762 29.15807
> >  BYH003  2015-02-15 9:01 116.5378 29.15275
> >  BYH003  2015-03-26 2:00 116.1493 29.69087
> >  BYH003 2015-04-07 18:00 123.2714 42.80138
> >  BYH003  2015-02-28 2:00 116.5735 29.15929
> >
> > I am first storing in a SpatialPointsDataFrame.
> >
> >> wfgP <- SpatialPointsDataFrame(wfg [, c("lon", "lat")], wfg)
> > ## I then want to store it into SpatialPixelsDataFrame
> >    SpatialPixelsDataFrame(wfgP[c("lon", "lat")], wfgP, tolerance =
> sqrt(.Machine$double.eps))
> > result in the error:Error in points2grid(points, tolerance, round) :
> >  dimension 1 : coordinate intervals are not constant I read that because
> my coordinates intervals are not constant, I should set the tolerance
> intervals. But this still doesn't allow the storing of SpatialPixels.
> > I tried different tolerance values, but still couldn't solve it.
> > Can I actually store this data set in SpatialPixelsDataFrame? If someone
> can point out on my mistake, I will highly appreciate.
>
>
> SpatialPixelsDataFrame are there for data whose spatial coordinates
> coincide with a location on a regular grid. Typical tracking data
> results in locations that are completely irregular. tolerance tries to
> find the grid if data are nearly on a grid. In your case, they are not
> nearly on a grid.
>
> Hth,
>
> >
> > Cheers,Yaara
> >
> >
> >
> >
> >     [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics  (ifgi),  University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:  http://www.jstatsoft.org/
> Computers & Geosciences:  http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Tue Jul 19 12:50:30 2016
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 19 Jul 2016 11:50:30 +0100
Subject: [R-sig-Geo] Geographically weighted regression on categorical
	variable
In-Reply-To: <71D4D04D426B3B488D6C7FE26376FDE72AD9076D@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
References: <71D4D04D426B3B488D6C7FE26376FDE72AD9076D@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
Message-ID: <CANVKczP6ktUrgbaAQYZg6OL=GC7WRUWBSVwoV8uHRC4gqpNAoQ@mail.gmail.com>

I don't think the point pattern analysis will help you at all - your
sampling locations aren't a point pattern (although they form a
pattern of points) - their location has been decided by whoever
decided where to take the samples. Point pattern analysis is
appropriate where you are interested in the process that produced the
pattern of points.

If you had continuous data the answer might be obvious - kriging with
distance-to-source as a regression covariate, and then your answer as
to whether your continuous variable was related to the distance would
be inferred from the regression parameter and its standard error, as
per any GLM. I think there's an example like this for gstat where the
usual meuse data set is used to model Zinc with distance-to-river as a
covariate.

Your complication is that your categorical variable makes it a
*multinomial* regression problem. If this wasn't a spatial problem,
and your data were independent samples in some sort of designed
experiment, then standard multinomial regression techniques can be
applied and out pop estimates and standard errors of the regression
coefficients of your distance-to-source covariate. You could, as an
initial experiment, treat your data like this and see what happens.

But you have spatial data, and hence spatially correlated
observations, so you can't just throw it into a standard multinomial
and believe the inference. You would seem to want some sort of
multinomial regression kriging approach, but I can't find anything
appropriate. Discussions over coffee with colleagues just now
dissolved into all sorts of stuff I don't understand, but maybe we'll
come up with something after a few more coffees.

Barry






On Mon, Jul 18, 2016 at 7:13 PM, Guy Bayegnak <Guy.Bayegnak at gov.ab.ca> wrote:
>
> Hi All,
>
> I am trying to perform geographically weighted regression on categorical variables.  The majority of answers I found on the web suggest that this is not doable or not recommended.  I found only one post from Roger Bivan (https://stat.ethz.ch/pipermail/r-help/2007-September/141586.html ) that indicated that it was possible, and that the R-sig-geo list is more focused on this kind of question. I have therefore registered, but I am not sure if the mailing list is "searchable".
>
> I have point data collected over a geographical area A.  My data are groundwater quality type. And I have 3 types. When I plot it of a map it looks like 2 of the types are clustered and occur next to each other.  My suspicion is that these two clustered type may be influenced by their proximity to the some potential sources.  I used the spatstats package to explore the data,  using L-cross function.  The result of the analysis show that the 3 types appear to be influenced by the source, although the two groundwater that are clustered appear to deviate much more from the theoretical L-cross.  Now I am trying to explore the relationship between the water types and the potential source using geographically weighted regression on categorical variables.  Most of the material a read deals with continuous variables, and tend to focus on areal (polygons) features rather than point features.
>
> Is there any way to perform geographically weighted regression on points categorical variables using R?
>
> Thanks,
> GAB
>
>
>
>
> This email and any files transmitted with it are confide...{{dropped:7}}
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From loic.dutrieux at wur.nl  Wed Jul 20 12:13:26 2016
From: loic.dutrieux at wur.nl (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Wed, 20 Jul 2016 12:13:26 +0200
Subject: [R-sig-Geo] raster overlay: apply function on multiple RasterBrick
Message-ID: <578F4EC6.1060804@wur.nl>

Hi everyone,

I'm struggling to apply a function on multiple RasterBrick with 
raster::overlay.
In the dummy example below the idea is that the function takes two 
numeric vectors and returns the slope of the linear model. Therefore I 
would expect to have a RasterLayer in return with slope for each pixel.
Overlay complains that the function is not vectorized.
I tried to wrap fun in a mapply call to vectorize the function over x 
and y but that did not work either.
Any ideas?

####
library(raster)

b1 <- brick(ncol=10, nrow=10, nl=15)
b1[] <- rnorm(length(b1), 3, 2)
b2 <- b1 * b1

# Define function to compute slope
fun <- function(x, y) {
   model <- lm(y ~ x)
   model$coefficients[[2]]
}

# Test function for two numeric vectors of same length
fun(c(1,2,3,4), c(4,2,6,7))

# Use function within overlay
out <- overlay(b1, b2, fun = fun2)


Cheers,
Lo?c


From vijaylulla at gmail.com  Wed Jul 20 17:17:13 2016
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Wed, 20 Jul 2016 11:17:13 -0400
Subject: [R-sig-Geo] raster overlay: apply function on multiple
	RasterBrick
In-Reply-To: <578F4EC6.1060804@wur.nl>
References: <578F4EC6.1060804@wur.nl>
Message-ID: <CAKkiGbvMBDxdMF=NbfxN_zUZ2poopOg2DWGXpTuAoVVPfN-zDA@mail.gmail.com>

I'm not sure that this is the best way but I think this does what you want.

R> b1 <- brick(ncol=10,nrow=10,nl=15)
R> b1[] <- rnorm(length(b1),3,2)
R> b2 <- b1*b2
R> b3 <- stack(b1,b2)
R> fun3 <- function(x) { lm(x[16:30] ~ x[1:15])$coefficients[[2]] }
R> out3 <- calc(b3, fun3)

This is similar to one of the examples under ?`calc`.

HTH,
Vijay

On Wed, Jul 20, 2016 at 6:13 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl> wrote:

> Hi everyone,
>
> I'm struggling to apply a function on multiple RasterBrick with
> raster::overlay.
> In the dummy example below the idea is that the function takes two numeric
> vectors and returns the slope of the linear model. Therefore I would expect
> to have a RasterLayer in return with slope for each pixel.
> Overlay complains that the function is not vectorized.
> I tried to wrap fun in a mapply call to vectorize the function over x and
> y but that did not work either.
> Any ideas?
>
> ####
> library(raster)
>
> b1 <- brick(ncol=10, nrow=10, nl=15)
> b1[] <- rnorm(length(b1), 3, 2)
> b2 <- b1 * b1
>
> # Define function to compute slope
> fun <- function(x, y) {
>   model <- lm(y ~ x)
>   model$coefficients[[2]]
> }
>
> # Test function for two numeric vectors of same length
> fun(c(1,2,3,4), c(4,2,6,7))
>
> # Use function within overlay
> out <- overlay(b1, b2, fun = fun2)
>
>
> Cheers,
> Lo?c
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Wed Jul 20 18:04:03 2016
From: englishchristophera at gmail.com (chris english)
Date: Wed, 20 Jul 2016 19:04:03 +0300
Subject: [R-sig-Geo] Simple features for R, part 2
In-Reply-To: <578C80CB.8010704@uni-muenster.de>
References: <578C80CB.8010704@uni-muenster.de>
Message-ID: <CAASFQpRhNfWMCSyQGa=_PHiyiKcNMKYWZ7DG6w3yRWW8Nse5zQ@mail.gmail.com>

Edzer,

I especially appreciate it is all S3 and can be heterogeneous under
'geometrycollection'.  Tests, of course, are important and
having fully fledged GEOS (though this may have to, eventually, cede to
something like CGAL if the drive is additionally to 3+d).
As to dimentionality (3d+) in GDAL-land, Frank and now Evan have been
implementing variations for the past 10 years, even as
4dim gets expressed as 3dim, it doesn't error. So perhaps is is a function
of post-processing after GDAL for achieving higher dimensionality for
visualizatioin
and other purposes. So now to become an adept at lists of sets of lists.
Just wish I'd noticed this a little while ago.

Chris English

On Mon, Jul 18, 2016 at 10:10 AM, Edzer Pebesma <
edzer.pebesma at uni-muenster.de> wrote:

> There's a second blog post on the ISC project "Simple features for R",
> describing progress up to date and planned future steps, at:
>
> http://r-spatial.org/r/2016/07/18/sf2.html
>
> Comments are welcome!
> --
> Edzer Pebesma
> Institute for Geoinformatics  (ifgi),  University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tim.howard at dec.ny.gov  Wed Jul 20 20:04:40 2016
From: tim.howard at dec.ny.gov (Howard, Tim G (DEC))
Date: Wed, 20 Jul 2016 18:04:40 +0000
Subject: [R-sig-Geo] raster: extract with different methods (simple,
 bilinear) among layers in brick?
Message-ID: <BN6PR09MB1409A36EA38C152A87EA2DF3A8080@BN6PR09MB1409.namprd09.prod.outlook.com>

Hi all,
I have a raster brick for which I'd like to extract data from each layer to a point dataset, but I'd like to use method="simple" for some of the layers and method="bilinear" for others. 

It looks like the call to extract won't take a vector for method like this:

x <- extract(myBrick, mySpatialPoints, method=c("simple","bilinear","bilinear"))

my ugly hack is to loop it like this:
    
listOfMethods <- c("simple","bilinear","bilinear")

for(k in 1:nrow(listOfMethods)){
      x <- extract(myBrick [[k]], mySpatialPoints, method= listOfMethods [[k]], sp=TRUE)
      if(k == 1){
        y <- x
      } else {
        layerName <- names(x at data)[ncol(x at data)]
        y at data <- cbind(y at data, x at data[,layerName])
        names(y at data)[length(names(y at data))] <- layerName
      }
    }


Any suggestions for a better approach?  

Aside: Note the myBrick[[k]] syntax (which is pretty fast!). I spent a while trying to use layer=1, nl=1 in the call like this:

x <- extract(myBrick, mySpatialPoints, layer=k, nl=1, method= listOfMethods [[k]], sp=TRUE)

but that consistently resulted in this error:

Error in cvv[cells, ] : incorrect number of dimensions

Thanks in advance, 
Tim


From HodgessE at uhd.edu  Thu Jul 21 00:11:23 2016
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 20 Jul 2016 22:11:23 +0000
Subject: [R-sig-Geo] gamma from fitVariogram output vs. Covariance matrix
Message-ID: <FF9DB805FC41CC4E95825A50F6806302B4A75F5C@columbia.uhd.campus>

Hello everyone:

I have a question about the gamma output which appears with the fitVariogram results, please.

Here is a sample output:
$ exp_var  :Classes ?gstatVariogram? and 'data.frame': 12 obs. of  6 variables:
  ..$ np     : num [1:12] 181 499 844 1758 2356 ...
  ..$ dist   : num [1:12] 22.4 52.2 85.4 126.4 176.9 ...
  ..$ gamma  : num [1:12] 116033 138020 133462 133186 134257 ...
  ..$ dir.hor: num [1:12] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ dir.ver: num [1:12] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ id     : Factor w/ 1 level "var1": 1 1 1 1 1 1 1 1 1 1 ...


And you notice there are 12 values.  However, there are 1000 values in the actual data set itself. I realize that there are point-pairs selected in order to produce the gamma values.  But how would this relate to either a covariance or correlation matrix, please?

Thanks in advance,
Sincerely,
Erin




Erin M. Hodgess
Associate Professor
Department of Mathematics and Statistics
University of Houston - Downtown
mailto: hodgesse at uhd.edu

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Thu Jul 21 06:27:41 2016
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 20 Jul 2016 21:27:41 -0700
Subject: [R-sig-Geo] raster: extract with different methods (simple,
 bilinear) among layers in brick?
In-Reply-To: <BN6PR09MB1409A36EA38C152A87EA2DF3A8080@BN6PR09MB1409.namprd09.prod.outlook.com>
References: <BN6PR09MB1409A36EA38C152A87EA2DF3A8080@BN6PR09MB1409.namprd09.prod.outlook.com>
Message-ID: <CANtt_hxtqUMMwFfMHznyh-VC9BHszVOTv6u1THVOLt6U=O_dbg@mail.gmail.com>

Tim, here is an an approach:

library(raster)
b <- brick(system.file("external/rlogo.grd", package="raster"))
p <- SpatialPoints(cbind(sample(77,10), sample(77,10)))

methods <- c("bilinear","simple","bilinear")
k <- methods == "simple"
x1 <- extract(b[[which(k), drop=F]], p)
x2 <- extract(b[[which(!k), drop=F]], p, method='bilinear')
x <- cbind(x1, x2)
x <- x[, names(b)]


Robert

On Wed, Jul 20, 2016 at 11:04 AM, Howard, Tim G (DEC)
<tim.howard at dec.ny.gov> wrote:
> Hi all,
> I have a raster brick for which I'd like to extract data from each layer to a point dataset, but I'd like to use method="simple" for some of the layers and method="bilinear" for others.
>
> It looks like the call to extract won't take a vector for method like this:
>
> x <- extract(myBrick, mySpatialPoints, method=c("simple","bilinear","bilinear"))
>
> my ugly hack is to loop it like this:
>
> listOfMethods <- c("simple","bilinear","bilinear")
>
> for(k in 1:nrow(listOfMethods)){
>       x <- extract(myBrick [[k]], mySpatialPoints, method= listOfMethods [[k]], sp=TRUE)
>       if(k == 1){
>         y <- x
>       } else {
>         layerName <- names(x at data)[ncol(x at data)]
>         y at data <- cbind(y at data, x at data[,layerName])
>         names(y at data)[length(names(y at data))] <- layerName
>       }
>     }
>
>
> Any suggestions for a better approach?
>
> Aside: Note the myBrick[[k]] syntax (which is pretty fast!). I spent a while trying to use layer=1, nl=1 in the call like this:
>
> x <- extract(myBrick, mySpatialPoints, layer=k, nl=1, method= listOfMethods [[k]], sp=TRUE)
>
> but that consistently resulted in this error:
>
> Error in cvv[cells, ] : incorrect number of dimensions
>
> Thanks in advance,
> Tim
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tim.howard at dec.ny.gov  Thu Jul 21 17:34:09 2016
From: tim.howard at dec.ny.gov (Howard, Tim G (DEC))
Date: Thu, 21 Jul 2016 15:34:09 +0000
Subject: [R-sig-Geo] raster: extract with different methods (simple,
 bilinear) among layers in brick?
In-Reply-To: <CANtt_hxtqUMMwFfMHznyh-VC9BHszVOTv6u1THVOLt6U=O_dbg@mail.gmail.com>
References: <BN6PR09MB1409A36EA38C152A87EA2DF3A8080@BN6PR09MB1409.namprd09.prod.outlook.com>
	<CANtt_hxtqUMMwFfMHznyh-VC9BHszVOTv6u1THVOLt6U=O_dbg@mail.gmail.com>
Message-ID: <BN6PR09MB1409D5C5F9B953B8C4F6AAD8A8090@BN6PR09MB1409.namprd09.prod.outlook.com>

Robert,
Very slick. Thank you!  I had thought about splitting by method and running only twice, but hadn't come up with an approach yet. 

Perfect. 
Thanks again,
Tim

> -----Original Message-----
> From: Robert J. Hijmans [mailto:r.hijmans at gmail.com]
> Sent: Thursday, July 21, 2016 12:28 AM
> To: Howard, Tim G (DEC) <tim.howard at dec.ny.gov>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] raster: extract with different methods (simple,
> bilinear) among layers in brick?
> 
> ATTENTION: This email came from an external source. Do not open
> attachments or click on links from unknown senders or unexpected emails.
> 
> 
> Tim, here is an an approach:
> 
> library(raster)
> b <- brick(system.file("external/rlogo.grd", package="raster")) p <-
> SpatialPoints(cbind(sample(77,10), sample(77,10)))
> 
> methods <- c("bilinear","simple","bilinear") k <- methods == "simple"
> x1 <- extract(b[[which(k), drop=F]], p)
> x2 <- extract(b[[which(!k), drop=F]], p, method='bilinear') x <- cbind(x1, x2) x
> <- x[, names(b)]
> 
> 
> Robert
> 
> On Wed, Jul 20, 2016 at 11:04 AM, Howard, Tim G (DEC)
> <tim.howard at dec.ny.gov> wrote:
> > Hi all,
> > I have a raster brick for which I'd like to extract data from each layer to a
> point dataset, but I'd like to use method="simple" for some of the layers and
> method="bilinear" for others.
> >
> > It looks like the call to extract won't take a vector for method like this:
> >
> > x <- extract(myBrick, mySpatialPoints,
> > method=c("simple","bilinear","bilinear"))
> >
> > my ugly hack is to loop it like this:
> >
> > listOfMethods <- c("simple","bilinear","bilinear")
> >
> > for(k in 1:nrow(listOfMethods)){
> >       x <- extract(myBrick [[k]], mySpatialPoints, method= listOfMethods
> [[k]], sp=TRUE)
> >       if(k == 1){
> >         y <- x
> >       } else {
> >         layerName <- names(x at data)[ncol(x at data)]
> >         y at data <- cbind(y at data, x at data[,layerName])
> >         names(y at data)[length(names(y at data))] <- layerName
> >       }
> >     }
> >
> >
> > Any suggestions for a better approach?
> >
> > Aside: Note the myBrick[[k]] syntax (which is pretty fast!). I spent a while
> trying to use layer=1, nl=1 in the call like this:
> >
> > x <- extract(myBrick, mySpatialPoints, layer=k, nl=1, method=
> > listOfMethods [[k]], sp=TRUE)
> >
> > but that consistently resulted in this error:
> >
> > Error in cvv[cells, ] : incorrect number of dimensions
> >
> > Thanks in advance,
> > Tim
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From milujisb at gmail.com  Thu Jul 21 22:57:27 2016
From: milujisb at gmail.com (Miluji Sb)
Date: Thu, 21 Jul 2016 22:57:27 +0200
Subject: [R-sig-Geo] Aggregate data to lower resolution
Message-ID: <CAMLwc7My+kU70wNV0z9DdYCcLAAm0B+5wYxkJfw1X=5+D79wtQ@mail.gmail.com>

Dear all,

I have the following GDP data by latitude and longitude at 0.5 degree by
0.5 degree.

temp <- dput(head(ptsDF,10))
structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
-67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
-54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
-53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
c("longitude",
"latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
82L, 95L, 108L, 121L), class = "data.frame")

I would like to aggregate the data 1 degree by 1 degree. I understand that
the first step is to convert to raster. I have tried:

rasterDF <- rasterFromXYZ(temp)
r <- aggregate(rasterDF,fact=2, fun=sum)

But this does not seem to work. Could anyone help me out please? Thank you
in advance.

Sincerely,

Milu

	[[alternative HTML version deleted]]


From loic.dutrieux at wur.nl  Thu Jul 21 23:28:26 2016
From: loic.dutrieux at wur.nl (=?UTF-8?Q?Lo=c3=afc_Dutrieux?=)
Date: Thu, 21 Jul 2016 23:28:26 +0200
Subject: [R-sig-Geo] Aggregate data to lower resolution
In-Reply-To: <CAMLwc7My+kU70wNV0z9DdYCcLAAm0B+5wYxkJfw1X=5+D79wtQ@mail.gmail.com>
References: <CAMLwc7My+kU70wNV0z9DdYCcLAAm0B+5wYxkJfw1X=5+D79wtQ@mail.gmail.com>
Message-ID: <57913E7A.2030209@wur.nl>

Hi Milu,

The code you provided works perfectly on my computer. What doesn't work 
in your case? Do you get an error message?

Cheers,
Lo?c

On 21/07/2016 22:57, Miluji Sb wrote:
> Dear all,
>
> I have the following GDP data by latitude and longitude at 0.5 degree by
> 0.5 degree.
>
> temp <- dput(head(ptsDF,10))
> structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
> -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
> -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
> -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
> 0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
> c("longitude",
> "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
> 82L, 95L, 108L, 121L), class = "data.frame")
>
> I would like to aggregate the data 1 degree by 1 degree. I understand that
> the first step is to convert to raster. I have tried:
>
> rasterDF <- rasterFromXYZ(temp)
> r <- aggregate(rasterDF,fact=2, fun=sum)
>
> But this does not seem to work. Could anyone help me out please? Thank you
> in advance.
>
> Sincerely,
>
> Milu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From milujisb at gmail.com  Fri Jul 22 10:08:33 2016
From: milujisb at gmail.com (Miluji Sb)
Date: Fri, 22 Jul 2016 10:08:33 +0200
Subject: [R-sig-Geo] Aggregate data to lower resolution
In-Reply-To: <57913E7A.2030209@wur.nl>
References: <CAMLwc7My+kU70wNV0z9DdYCcLAAm0B+5wYxkJfw1X=5+D79wtQ@mail.gmail.com>
	<57913E7A.2030209@wur.nl>
Message-ID: <CAMLwc7PfjeTbhtE8qWHtr7dHv5FKrdGifpwzT0GQmFJOE2-ojA@mail.gmail.com>

Dear Loic,

Thank you for your reply. When I run this code on the whole data set (that
has all the countries in the world) - I get mostly NAs. The attributes are:

class       : RasterLayer
dimensions  : 135, 359, 48465  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : -178.5, 180.5, -55.5, 79.5  (xmin, xmax, ymin, ymax)
coord. ref. : NA
data source : in memory
names       : GDP
values      : 0, 750.533  (min, max)

Do I need to get rid of the NAs? Or is there something wrong? Thanks again.

Sincerely,

Milu

On Thu, Jul 21, 2016 at 11:28 PM, Lo?c Dutrieux <loic.dutrieux at wur.nl>
wrote:

> Hi Milu,
>
> The code you provided works perfectly on my computer. What doesn't work in
> your case? Do you get an error message?
>
> Cheers,
> Lo?c
>
>
> On 21/07/2016 22:57, Miluji Sb wrote:
>
>> Dear all,
>>
>> I have the following GDP data by latitude and longitude at 0.5 degree by
>> 0.5 degree.
>>
>> temp <- dput(head(ptsDF,10))
>> structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
>> -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
>> -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
>> -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
>> 0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
>> c("longitude",
>> "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
>> 82L, 95L, 108L, 121L), class = "data.frame")
>>
>> I would like to aggregate the data 1 degree by 1 degree. I understand that
>> the first step is to convert to raster. I have tried:
>>
>> rasterDF <- rasterFromXYZ(temp)
>> r <- aggregate(rasterDF,fact=2, fun=sum)
>>
>> But this does not seem to work. Could anyone help me out please? Thank you
>> in advance.
>>
>> Sincerely,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mel at mbacou.com  Fri Jul 22 22:55:23 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 22 Jul 2016 16:55:23 -0400
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
Message-ID: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>

Hi,
I'm getting weird results trying to rbind a list of 
SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the 
code below used to merge all 3 country boundaries, but instead I now get 
a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?

Thx, --Mel.

 > library(raster)
 > m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM", 
country=x, level=1))
 > m <- rbind(m, makeUniqueIDs=T)
 > sapply(m, class)
[1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
[4] "logical"                  "SpatialPolygonsDataFrame" "logical"

 > sessionInfo()
R version 3.2.1 (2015-06-18)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United 
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

other attached packages:
[1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2

loaded via a namespace (and not attached):
[1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33

-- 
Melanie BACOU
International Food Policy Research Institute
Snr. Program Manager, Spatial Data and Analytics
Work   +1(202)862-5699
E-mail m.bacou at cgiar.org
Visit  www.harvestchoice.org


From englishchristophera at gmail.com  Fri Jul 22 23:24:43 2016
From: englishchristophera at gmail.com (chris english)
Date: Sat, 23 Jul 2016 00:24:43 +0300
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
Message-ID: <CAASFQpTjSj2fU_PMCRJuhdLhH6iF3HCaEqjai+gkyyVjvXwn0w@mail.gmail.com>

Mel,

> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
country=x, level=1))
I get: (after GDAM downloads)
trying URL 'http://biogeo.ucdavis.edu/data/gadm2.8/rds/TZA_adm1.rds'
Content type 'unknown' length 1152781 bytes (1.1 MB)
==================================================
downloaded 1.1 MB

trying URL 'http://biogeo.ucdavis.edu/data/gadm2.8/rds/UGA_adm1.rds'
Content type 'unknown' length 1749955 bytes (1.7 MB)
==================================================
downloaded 1.7 MB

trying URL 'http://biogeo.ucdavis.edu/data/gadm2.8/rds/GHA_adm1.rds'
Content type 'unknown' length 164023 bytes (160 KB)
==================================================
downloaded 160 KB

> m <- rbind(m, makeUniqueIDs=T)
> head(m)
              [,1] [,2] [,3]
m             ?    ?    ?
makeUniqueIDs TRUE TRUE TRUE
> m
              [,1] [,2] [,3]
m             ?    ?    ?
makeUniqueIDs TRUE TRUE TRUE
> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
country=x, level=1))

## Now I have this data locally

> m
[[1]]
class       : SpatialPolygonsDataFrame
features    : 30
extent      : 29.32717, 40.44514, -11.7457, -0.9857875  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
+towgs84=0,0,0
variables   : 13
names       : OBJECTID, ID_0, ISO,   NAME_0, ID_1,        NAME_1, HASC_1,
CCN_1, CCA_1, TYPE_1, ENGTYPE_1, NL_NAME_1,       VARNAME_1
min values  :        1,  227, TZA, Tanzania,    1,        Arusha,  TZ.AS,
 NA,    01,   Mkoa,    Region,          ,
max values  :        9,  227, TZA, Tanzania,    9, Zanzibar West,  TZ.ZW,
 NA,    55,   Mkoa,    Region,          , Mjini Magharibi

[[2]]
class       : SpatialPolygonsDataFrame
features    : 58
extent      : 29.5715, 35.00027, -1.48214, 4.234466  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
+towgs84=0,0,0
variables   : 13
names       : OBJECTID, ID_0, ISO, NAME_0, ID_1,   NAME_1, HASC_1, CCN_1,
CCA_1,     TYPE_1,  ENGTYPE_1, NL_NAME_1, VARNAME_1
min values  :        1,  239, UGA, Uganda,    1, Adjumani,       ,    NA,
   ,   District,   District,          ,
max values  :        9,  239, UGA, Uganda,    9,    Yumbe,  UG.YU,    NA,
 41, Water body, Water body,          ,   Luweero

[[3]]
class       : SpatialPolygonsDataFrame
features    : 10
extent      : -3.255419, 1.19177, 4.738751, 11.1733  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
+towgs84=0,0,0
variables   : 13
names       : OBJECTID, ID_0, ISO, NAME_0, ID_1,  NAME_1, HASC_1, CCN_1,
CCA_1, TYPE_1, ENGTYPE_1, NL_NAME_1, VARNAME_1
min values  :        1,   87, GHA,  Ghana,    1, Ashanti,  GH.AA,    NA,
   , Region,    Region,          ,
max values  :        9,   87, GHA,  Ghana,    9, Western,  GH.WP,    NA,
   , Region,    Region,          ,

>

I'm a little puzzled as well, but "TZA", "UGA" & "GHA" seem to have found
their way to min/max values and presumably this is as it should be.
Chris





On Fri, Jul 22, 2016 at 11:55 PM, Bacou, Melanie <mel at mbacou.com> wrote:

> Hi,
> I'm getting weird results trying to rbind a list of
> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the code
> below used to merge all 3 country boundaries, but instead I now get a list
> with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>
> Thx, --Mel.
>
> > library(raster)
> > m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
> country=x, level=1))
> > m <- rbind(m, makeUniqueIDs=T)
> > sapply(m, class)
> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>
> > sessionInfo()
> R version 3.2.1 (2015-06-18)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods base
>
> other attached packages:
> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>
> loaded via a namespace (and not attached):
> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>
> --
> Melanie BACOU
> International Food Policy Research Institute
> Snr. Program Manager, Spatial Data and Analytics
> Work   +1(202)862-5699
> E-mail m.bacou at cgiar.org
> Visit  www.harvestchoice.org
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Fri Jul 22 23:53:50 2016
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 22 Jul 2016 23:53:50 +0200
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
Message-ID: <5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>

The correct call to rbind would be

mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)

with sp on CRAN this doesn't work; with the version on github it does.

An alternative with sp from CRAN is to make the IDs unique by hand:

spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
mm = rbind(m[[1]], m[[2]], m[[3]])


On 22/07/16 22:55, Bacou, Melanie wrote:
> Hi,
> I'm getting weird results trying to rbind a list of
> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
> code below used to merge all 3 country boundaries, but instead I now get
> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
> 
> Thx, --Mel.
> 
>> library(raster)
>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
> country=x, level=1))
>> m <- rbind(m, makeUniqueIDs=T)
>> sapply(m, class)
> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
> 
>> sessionInfo()
> R version 3.2.1 (2015-06-18)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
> 
> locale:
> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods base
> 
> other attached packages:
> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
> 
> loaded via a namespace (and not attached):
> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
> 

-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160722/110e6c76/attachment.bin>

From mel at mbacou.com  Sat Jul 23 05:00:00 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Fri, 22 Jul 2016 23:00:00 -0400
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
Message-ID: <22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>

Thanks! I wonder why the original syntax passing a list used to work (I 
believe).

For a much longer (and unknown) list of SpatialPolygonsDataFrames could 
an approach using do.call() work instead? I tried but:

 > m <- do.call(rbind, m, makeUniqueIDs=T)
Error in do.call(rbind, m, makeUniqueIDs = T) :
   unused argument (makeUniqueIDs = T)

# This works though but takes an extra step
 > spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
 > spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
 > spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
 > m <- do.call(rbind, m)
 > class(m)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"

--Mel.

On 7/22/2016 5:53 PM, Edzer Pebesma wrote:
> The correct call to rbind would be
>
> mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)
>
> with sp on CRAN this doesn't work; with the version on github it does.
>
> An alternative with sp from CRAN is to make the IDs unique by hand:
>
> spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
> spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
> spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
> mm = rbind(m[[1]], m[[2]], m[[3]])
>
>
> On 22/07/16 22:55, Bacou, Melanie wrote:
>> Hi,
>> I'm getting weird results trying to rbind a list of
>> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
>> code below used to merge all 3 country boundaries, but instead I now get
>> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>>
>> Thx, --Mel.
>>
>>> library(raster)
>>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
>> country=x, level=1))
>>> m <- rbind(m, makeUniqueIDs=T)
>>> sapply(m, class)
>> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
>> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>>
>>> sessionInfo()
>> R version 3.2.1 (2015-06-18)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods base
>>
>> other attached packages:
>> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>>
>> loaded via a namespace (and not attached):
>> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Sat Jul 23 05:09:32 2016
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 23 Jul 2016 15:09:32 +1200
Subject: [R-sig-Geo] [FORGED] Re:  Problems with rbind(list(),
 makeUniqueIDs=T)
In-Reply-To: <22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
	<22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
Message-ID: <0eb27ba8-7166-6a70-f609-b97b758597f7@auckland.ac.nz>

On 23/07/16 15:00, Bacou, Melanie wrote:
> Thanks! I wonder why the original syntax passing a list used to work (I
> believe).
>
> For a much longer (and unknown) list of SpatialPolygonsDataFrames could
> an approach using do.call() work instead? I tried but:
>
>  > m <- do.call(rbind, m, makeUniqueIDs=T)
> Error in do.call(rbind, m, makeUniqueIDs = T) :
>    unused argument (makeUniqueIDs = T)

<SNIP>

The syntax has to be do.call(function,list.of.args.to.function).

In this case:

     do.call(rbind,c(m,list(makeUniqueIDs=TRUE)))

BTW --- *don't* use the abbreviation "T" for "TRUE".  The object T is 
over-writeable (whereas TRUE is not!) and this can lead on occasion to 
mysterious errors accompanied by incomprehensible error messages.

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From edzer.pebesma at uni-muenster.de  Sat Jul 23 11:28:14 2016
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 23 Jul 2016 11:28:14 +0200
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
	<22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
Message-ID: <0f3de489-dcee-cf96-dab1-796168753b8c@uni-muenster.de>



On 23/07/16 05:00, Bacou, Melanie wrote:
> Thanks! I wonder why the original syntax passing a list used to work (I 
> believe).

It shouldn't have worked:

> rbind(list(1,2,3))
     [,1] [,2] [,3]
[1,] 1    2    3
> rbind(1,2,3)
     [,1]
[1,]    1
[2,]    2
[3,]    3

> 
> For a much longer (and unknown) list of SpatialPolygonsDataFrames could 
> an approach using do.call() work instead? I tried but:
> 
>  > m <- do.call(rbind, m, makeUniqueIDs=T)
> Error in do.call(rbind, m, makeUniqueIDs = T) :
>    unused argument (makeUniqueIDs = T)

See Rolf's email for the correct way of using do.call; with sp from CRAN
it still doesn't work. As an alternative to installing sp from github
directly, you could source the relevant rbind methods from github in
your script:

rbind.SpatialPolygons = function(..., makeUniqueIDs = FALSE) {
	dots = list(...)
	names(dots) <- NULL
	stopifnot(identicalCRS(dots))
	# checkIDSclash(dots)
	pl = do.call(c, lapply(dots, function(x) slot(x, "polygons")))
	if (makeUniqueIDs)
		pl = makeUniqueIDs(pl)
	SpatialPolygons(pl, proj4string = CRS(proj4string(dots[[1]])))
}
rbind.SpatialPolygonsDataFrame <- function(..., makeUniqueIDs = TRUE) {
	dots = list(...)
	names(dots) <- NULL # bugfix Clement Calenge 100417
	lst = lapply(dots, function(x) as(x, "SpatialPolygons"))
	lst$makeUniqueIDs = makeUniqueIDs
	pl = do.call(rbind.SpatialPolygons, lst)
	df = do.call(rbind, lapply(dots, function(x) x at data))
	SpatialPolygonsDataFrame(pl, df, match.ID = FALSE)
}

> 
> # This works though but takes an extra step
>  > spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>  > spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>  > spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>  > m <- do.call(rbind, m)
>  > class(m)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"
> 
> --Mel.
> 
> On 7/22/2016 5:53 PM, Edzer Pebesma wrote:
>> The correct call to rbind would be
>>
>> mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)
>>
>> with sp on CRAN this doesn't work; with the version on github it does.
>>
>> An alternative with sp from CRAN is to make the IDs unique by hand:
>>
>> spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>> spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>> spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>> mm = rbind(m[[1]], m[[2]], m[[3]])
>>
>>
>> On 22/07/16 22:55, Bacou, Melanie wrote:
>>> Hi,
>>> I'm getting weird results trying to rbind a list of
>>> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
>>> code below used to merge all 3 country boundaries, but instead I now get
>>> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>>>
>>> Thx, --Mel.
>>>
>>>> library(raster)
>>>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
>>> country=x, level=1))
>>>> m <- rbind(m, makeUniqueIDs=T)
>>>> sapply(m, class)
>>> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
>>> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>>>
>>>> sessionInfo()
>>> R version 3.2.1 (2015-06-18)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>
>>> other attached packages:
>>> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>>>
>>> loaded via a namespace (and not attached):
>>> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics  (ifgi),  University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160723/bac4d493/attachment.bin>

From mel at mbacou.com  Sat Jul 23 13:10:35 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Sat, 23 Jul 2016 07:10:35 -0400
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <0f3de489-dcee-cf96-dab1-796168753b8c@uni-muenster.de>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
	<22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
	<0f3de489-dcee-cf96-dab1-796168753b8c@uni-muenster.de>
Message-ID: <fcb2094b-c67e-6958-919d-4e5252f707db@mbacou.com>

Edzer, Rolf,
Many thanks for the clarification!
Just to confirm that Rolf's `do.call()` example works for me using the 
latest GitHub commit.

 > m <- lapply(c("TZA", "ETH", "GHA"), function(x) getData("GADM", 
country=x, level=1))
# with sp_1.2-3
 > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
Error in SpatialPolygonsDataFrame(pl, df) :
   row.names of data and Polygons IDs do not match
# with sp_1.2-4
 > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
 > class(m)
[1] "SpatialPolygonsDataFrame"

--Mel.


On 7/23/2016 5:28 AM, Edzer Pebesma wrote:
>
> On 23/07/16 05:00, Bacou, Melanie wrote:
>> Thanks! I wonder why the original syntax passing a list used to work (I
>> believe).
> It shouldn't have worked:
>
>> rbind(list(1,2,3))
>       [,1] [,2] [,3]
> [1,] 1    2    3
>> rbind(1,2,3)
>       [,1]
> [1,]    1
> [2,]    2
> [3,]    3
>
>> For a much longer (and unknown) list of SpatialPolygonsDataFrames could
>> an approach using do.call() work instead? I tried but:
>>
>>   > m <- do.call(rbind, m, makeUniqueIDs=T)
>> Error in do.call(rbind, m, makeUniqueIDs = T) :
>>     unused argument (makeUniqueIDs = T)
> See Rolf's email for the correct way of using do.call; with sp from CRAN
> it still doesn't work. As an alternative to installing sp from github
> directly, you could source the relevant rbind methods from github in
> your script:
>
> rbind.SpatialPolygons = function(..., makeUniqueIDs = FALSE) {
> 	dots = list(...)
> 	names(dots) <- NULL
> 	stopifnot(identicalCRS(dots))
> 	# checkIDSclash(dots)
> 	pl = do.call(c, lapply(dots, function(x) slot(x, "polygons")))
> 	if (makeUniqueIDs)
> 		pl = makeUniqueIDs(pl)
> 	SpatialPolygons(pl, proj4string = CRS(proj4string(dots[[1]])))
> }
> rbind.SpatialPolygonsDataFrame <- function(..., makeUniqueIDs = TRUE) {
> 	dots = list(...)
> 	names(dots) <- NULL # bugfix Clement Calenge 100417
> 	lst = lapply(dots, function(x) as(x, "SpatialPolygons"))
> 	lst$makeUniqueIDs = makeUniqueIDs
> 	pl = do.call(rbind.SpatialPolygons, lst)
> 	df = do.call(rbind, lapply(dots, function(x) x at data))
> 	SpatialPolygonsDataFrame(pl, df, match.ID = FALSE)
> }
>
>> # This works though but takes an extra step
>>   > spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>   > spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>   > spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>   > m <- do.call(rbind, m)
>>   > class(m)
>> [1] "SpatialPolygonsDataFrame"
>> attr(,"package")
>> [1] "sp"
>>
>> --Mel.
>>
>> On 7/22/2016 5:53 PM, Edzer Pebesma wrote:
>>> The correct call to rbind would be
>>>
>>> mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)
>>>
>>> with sp on CRAN this doesn't work; with the version on github it does.
>>>
>>> An alternative with sp from CRAN is to make the IDs unique by hand:
>>>
>>> spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>> spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>> spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>> mm = rbind(m[[1]], m[[2]], m[[3]])
>>>
>>>
>>> On 22/07/16 22:55, Bacou, Melanie wrote:
>>>> Hi,
>>>> I'm getting weird results trying to rbind a list of
>>>> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
>>>> code below used to merge all 3 country boundaries, but instead I now get
>>>> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>>>>
>>>> Thx, --Mel.
>>>>
>>>>> library(raster)
>>>>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
>>>> country=x, level=1))
>>>>> m <- rbind(m, makeUniqueIDs=T)
>>>>> sapply(m, class)
>>>> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
>>>> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>>>>
>>>>> sessionInfo()
>>>> R version 3.2.1 (2015-06-18)
>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>>
>>>> locale:
>>>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>>>> States.1252
>>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>>> [5] LC_TIME=English_United States.1252
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>
>>>> other attached packages:
>>>> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Sat Jul 23 23:04:04 2016
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 23 Jul 2016 14:04:04 -0700
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <fcb2094b-c67e-6958-919d-4e5252f707db@mbacou.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
	<22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
	<0f3de489-dcee-cf96-dab1-796168753b8c@uni-muenster.de>
	<fcb2094b-c67e-6958-919d-4e5252f707db@mbacou.com>
Message-ID: <CANtt_hxZG+rU4_oBRze+smhcnCpW2UfohP7ZnjJUUWKmGv-h=w@mail.gmail.com>

The raster way would be:

library(raster)
m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
country=x, level=1))
m <- do.call(bind, m)

Robert

On Sat, Jul 23, 2016 at 4:10 AM, Bacou, Melanie <mel at mbacou.com> wrote:
> Edzer, Rolf,
> Many thanks for the clarification!
> Just to confirm that Rolf's `do.call()` example works for me using the
> latest GitHub commit.
>
>  > m <- lapply(c("TZA", "ETH", "GHA"), function(x) getData("GADM",
> country=x, level=1))
> # with sp_1.2-3
>  > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
> Error in SpatialPolygonsDataFrame(pl, df) :
>    row.names of data and Polygons IDs do not match
> # with sp_1.2-4
>  > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
>  > class(m)
> [1] "SpatialPolygonsDataFrame"
>
> --Mel.
>
>
> On 7/23/2016 5:28 AM, Edzer Pebesma wrote:
>>
>> On 23/07/16 05:00, Bacou, Melanie wrote:
>>> Thanks! I wonder why the original syntax passing a list used to work (I
>>> believe).
>> It shouldn't have worked:
>>
>>> rbind(list(1,2,3))
>>       [,1] [,2] [,3]
>> [1,] 1    2    3
>>> rbind(1,2,3)
>>       [,1]
>> [1,]    1
>> [2,]    2
>> [3,]    3
>>
>>> For a much longer (and unknown) list of SpatialPolygonsDataFrames could
>>> an approach using do.call() work instead? I tried but:
>>>
>>>   > m <- do.call(rbind, m, makeUniqueIDs=T)
>>> Error in do.call(rbind, m, makeUniqueIDs = T) :
>>>     unused argument (makeUniqueIDs = T)
>> See Rolf's email for the correct way of using do.call; with sp from CRAN
>> it still doesn't work. As an alternative to installing sp from github
>> directly, you could source the relevant rbind methods from github in
>> your script:
>>
>> rbind.SpatialPolygons = function(..., makeUniqueIDs = FALSE) {
>>       dots = list(...)
>>       names(dots) <- NULL
>>       stopifnot(identicalCRS(dots))
>>       # checkIDSclash(dots)
>>       pl = do.call(c, lapply(dots, function(x) slot(x, "polygons")))
>>       if (makeUniqueIDs)
>>               pl = makeUniqueIDs(pl)
>>       SpatialPolygons(pl, proj4string = CRS(proj4string(dots[[1]])))
>> }
>> rbind.SpatialPolygonsDataFrame <- function(..., makeUniqueIDs = TRUE) {
>>       dots = list(...)
>>       names(dots) <- NULL # bugfix Clement Calenge 100417
>>       lst = lapply(dots, function(x) as(x, "SpatialPolygons"))
>>       lst$makeUniqueIDs = makeUniqueIDs
>>       pl = do.call(rbind.SpatialPolygons, lst)
>>       df = do.call(rbind, lapply(dots, function(x) x at data))
>>       SpatialPolygonsDataFrame(pl, df, match.ID = FALSE)
>> }
>>
>>> # This works though but takes an extra step
>>>   > spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>>   > spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>>   > spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>>   > m <- do.call(rbind, m)
>>>   > class(m)
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>>
>>> --Mel.
>>>
>>> On 7/22/2016 5:53 PM, Edzer Pebesma wrote:
>>>> The correct call to rbind would be
>>>>
>>>> mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)
>>>>
>>>> with sp on CRAN this doesn't work; with the version on github it does.
>>>>
>>>> An alternative with sp from CRAN is to make the IDs unique by hand:
>>>>
>>>> spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>>> spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>>> spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>>> mm = rbind(m[[1]], m[[2]], m[[3]])
>>>>
>>>>
>>>> On 22/07/16 22:55, Bacou, Melanie wrote:
>>>>> Hi,
>>>>> I'm getting weird results trying to rbind a list of
>>>>> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
>>>>> code below used to merge all 3 country boundaries, but instead I now get
>>>>> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>>>>>
>>>>> Thx, --Mel.
>>>>>
>>>>>> library(raster)
>>>>>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
>>>>> country=x, level=1))
>>>>>> m <- rbind(m, makeUniqueIDs=T)
>>>>>> sapply(m, class)
>>>>> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
>>>>> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>>>>>
>>>>>> sessionInfo()
>>>>> R version 3.2.1 (2015-06-18)
>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>>>
>>>>> locale:
>>>>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>>>>> States.1252
>>>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>>>> [5] LC_TIME=English_United States.1252
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>
>>>>> other attached packages:
>>>>> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From p.gaffron at tuhh.de  Sun Jul 24 16:01:41 2016
From: p.gaffron at tuhh.de (Philine Gaffron)
Date: Sun, 24 Jul 2016 16:01:41 +0200
Subject: [R-sig-Geo] Comparing strength of correlation in spatial regression
	models
Message-ID: <d6a7618a-f050-a401-5dc1-a1049a430ffe@tuhh.de>

Dear all,

I am using a spatial regression model (errorsarlm from package spdep) to 
find out about correlation between different metrics for emission loads 
from road traffic received at residential receptor points. The emissions 
metrics have been generated with different methods (like 'sum of vehicle 
kilometres travelled within a buffer' or 'Gaussian plume dispersion 
models') that have very different resource requirements. I would like to 
ascertain which of the three less resource intensive methods I have used 
yields results that correlate most strongly with the results from the 
dispersion model (which is the most involved method).

Is it appropriate in this to compare the Nagelkerke pseudo R^2 values 
for the different spatial models or would another parameter be more 
appropriate (I am using the Akaike Information Criterion to ascertain 
goodness of fit of the spatial over the linear model).

Any hints are greatly appreciated.

Philine

Here is an example of the code I am using with the corresponding output 
(with model, variable and data names simplified for easier reading):

model_1<- errorsarlm(PM_exh ~ VKT, data = PM25, listw=PM25_listw)
summary(model_1, Nagelkerke = TRUE, digits = 4, signif.stars = TRUE)

# Call:errorsarlm(formula = PM_exh ~ VKT, data = PM25, listw=PM25_listw)
#
# Residuals:
#   Min       1Q   Median       3Q      Max
# -4.06775 -0.57955 -0.19595  0.41926  9.87816
#
# Type: error
# Coefficients: (asymptotic standard errors)
# Estimate Std. Error z value  Pr(>|z|)
# (Intercept)  1.35249    0.27593  4.9017 9.503e-07
# VKT  11.71968    0.20272 57.8128 < 2.2e-16
#
# Lambda: 0.95187, LR test value: 4168.2, p-value: < 2.22e-16
# Asymptotic standard error: 0.0064455
# z-value: 147.68, p-value: < 2.22e-16
# Wald statistic: 21809, p-value: < 2.22e-16
#
# Log likelihood: -9130.636 for error model
# ML residual variance (sigma squared): 1.0538, (sigma: 1.0266)
# Nagelkerke pseudo-R-squared: 0.73261
# Number of observations: 6251
# Number of parameters estimated: 4
# AIC: 18269, (AIC for lm: 22435)
-- 

Philine Gaffron
/Institute for Transport Planning and Logistics/
Hamburg University of Technology
/Germany/


From yud at mail.montclair.edu  Sun Jul 24 17:59:05 2016
From: yud at mail.montclair.edu (Danlin Yu)
Date: Sun, 24 Jul 2016 11:59:05 -0400
Subject: [R-sig-Geo] Comparing strength of correlation in spatial
 regression models
In-Reply-To: <d6a7618a-f050-a401-5dc1-a1049a430ffe@tuhh.de>
References: <d6a7618a-f050-a401-5dc1-a1049a430ffe@tuhh.de>
Message-ID: <62bd7beb-1d89-ed68-009d-3441a9c150f5@mail.montclair.edu>

Hi, Philine:

I always use AIC for not just goodness of fit, but a base to compare 
which model might tells a better story. In addition, I think the 
log-likelihood value is a good candidate, too. It is, after all, a 
"likelihood" measure, so a larger likelihood value, a better model.

Hope this helps.

Danlin


On 7/24/2016 10:01 AM, Philine Gaffron wrote:
> Dear all,
>
> I am using a spatial regression model (errorsarlm from package spdep) 
> to find out about correlation between different metrics for emission 
> loads from road traffic received at residential receptor points. The 
> emissions metrics have been generated with different methods (like 
> 'sum of vehicle kilometres travelled within a buffer' or 'Gaussian 
> plume dispersion models') that have very different resource 
> requirements. I would like to ascertain which of the three less 
> resource intensive methods I have used yields results that correlate 
> most strongly with the results from the dispersion model (which is the 
> most involved method).
>
> Is it appropriate in this to compare the Nagelkerke pseudo R^2 values 
> for the different spatial models or would another parameter be more 
> appropriate (I am using the Akaike Information Criterion to ascertain 
> goodness of fit of the spatial over the linear model).
>
> Any hints are greatly appreciated.
>
> Philine
>
> Here is an example of the code I am using with the corresponding 
> output (with model, variable and data names simplified for easier 
> reading):
>
> model_1<- errorsarlm(PM_exh ~ VKT, data = PM25, listw=PM25_listw)
> summary(model_1, Nagelkerke = TRUE, digits = 4, signif.stars = TRUE)
>
> # Call:errorsarlm(formula = PM_exh ~ VKT, data = PM25, listw=PM25_listw)
> #
> # Residuals:
> #   Min       1Q   Median       3Q      Max
> # -4.06775 -0.57955 -0.19595  0.41926  9.87816
> #
> # Type: error
> # Coefficients: (asymptotic standard errors)
> # Estimate Std. Error z value  Pr(>|z|)
> # (Intercept)  1.35249    0.27593  4.9017 9.503e-07
> # VKT  11.71968    0.20272 57.8128 < 2.2e-16
> #
> # Lambda: 0.95187, LR test value: 4168.2, p-value: < 2.22e-16
> # Asymptotic standard error: 0.0064455
> # z-value: 147.68, p-value: < 2.22e-16
> # Wald statistic: 21809, p-value: < 2.22e-16
> #
> # Log likelihood: -9130.636 for error model
> # ML residual variance (sigma squared): 1.0538, (sigma: 1.0266)
> # Nagelkerke pseudo-R-squared: 0.73261
> # Number of observations: 6251
> # Number of parameters estimated: 4
> # AIC: 18269, (AIC for lm: 22435)


-- 
___________________________________________
Danlin Yu, Ph.D.
Professor of GIS and Urban Geography
Associate Editor of ASCE Journal of Urban Planning & Development
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu


From mel at mbacou.com  Sun Jul 24 19:23:28 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Sun, 24 Jul 2016 13:23:28 -0400
Subject: [R-sig-Geo] Problems with rbind(list(), makeUniqueIDs=T)
In-Reply-To: <CANtt_hxZG+rU4_oBRze+smhcnCpW2UfohP7ZnjJUUWKmGv-h=w@mail.gmail.com>
References: <3d83a581-2cba-99ac-961d-b57d25b10756@mbacou.com>
	<5d179274-1be1-1fb5-e3d3-3eaa641e84f5@uni-muenster.de>
	<22ae608c-6561-5a95-eb93-cdcda9027094@mbacou.com>
	<0f3de489-dcee-cf96-dab1-796168753b8c@uni-muenster.de>
	<fcb2094b-c67e-6958-919d-4e5252f707db@mbacou.com>
	<CANtt_hxZG+rU4_oBRze+smhcnCpW2UfohP7ZnjJUUWKmGv-h=w@mail.gmail.com>
Message-ID: <d45fd9a6-eae8-1cce-c67e-533276f1996b@mbacou.com>

Robert,
Great, thanks for pointing `raster::bind()` out as well. Guess I should 
re-read the vignette periodically!
--Mel.


On 7/23/2016 5:04 PM, Robert J. Hijmans wrote:
> The raster way would be:
>
> library(raster)
> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
> country=x, level=1))
> m <- do.call(bind, m)
>
> Robert
>
> On Sat, Jul 23, 2016 at 4:10 AM, Bacou, Melanie <mel at mbacou.com> wrote:
>> Edzer, Rolf,
>> Many thanks for the clarification!
>> Just to confirm that Rolf's `do.call()` example works for me using the
>> latest GitHub commit.
>>
>>   > m <- lapply(c("TZA", "ETH", "GHA"), function(x) getData("GADM",
>> country=x, level=1))
>> # with sp_1.2-3
>>   > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
>> Error in SpatialPolygonsDataFrame(pl, df) :
>>     row.names of data and Polygons IDs do not match
>> # with sp_1.2-4
>>   > m <- do.call(rbind, c(m, list(makeUniqueIDs=TRUE)))
>>   > class(m)
>> [1] "SpatialPolygonsDataFrame"
>>
>> --Mel.
>>
>>
>> On 7/23/2016 5:28 AM, Edzer Pebesma wrote:
>>> On 23/07/16 05:00, Bacou, Melanie wrote:
>>>> Thanks! I wonder why the original syntax passing a list used to work (I
>>>> believe).
>>> It shouldn't have worked:
>>>
>>>> rbind(list(1,2,3))
>>>        [,1] [,2] [,3]
>>> [1,] 1    2    3
>>>> rbind(1,2,3)
>>>        [,1]
>>> [1,]    1
>>> [2,]    2
>>> [3,]    3
>>>
>>>> For a much longer (and unknown) list of SpatialPolygonsDataFrames could
>>>> an approach using do.call() work instead? I tried but:
>>>>
>>>>    > m <- do.call(rbind, m, makeUniqueIDs=T)
>>>> Error in do.call(rbind, m, makeUniqueIDs = T) :
>>>>      unused argument (makeUniqueIDs = T)
>>> See Rolf's email for the correct way of using do.call; with sp from CRAN
>>> it still doesn't work. As an alternative to installing sp from github
>>> directly, you could source the relevant rbind methods from github in
>>> your script:
>>>
>>> rbind.SpatialPolygons = function(..., makeUniqueIDs = FALSE) {
>>>        dots = list(...)
>>>        names(dots) <- NULL
>>>        stopifnot(identicalCRS(dots))
>>>        # checkIDSclash(dots)
>>>        pl = do.call(c, lapply(dots, function(x) slot(x, "polygons")))
>>>        if (makeUniqueIDs)
>>>                pl = makeUniqueIDs(pl)
>>>        SpatialPolygons(pl, proj4string = CRS(proj4string(dots[[1]])))
>>> }
>>> rbind.SpatialPolygonsDataFrame <- function(..., makeUniqueIDs = TRUE) {
>>>        dots = list(...)
>>>        names(dots) <- NULL # bugfix Clement Calenge 100417
>>>        lst = lapply(dots, function(x) as(x, "SpatialPolygons"))
>>>        lst$makeUniqueIDs = makeUniqueIDs
>>>        pl = do.call(rbind.SpatialPolygons, lst)
>>>        df = do.call(rbind, lapply(dots, function(x) x at data))
>>>        SpatialPolygonsDataFrame(pl, df, match.ID = FALSE)
>>> }
>>>
>>>> # This works though but takes an extra step
>>>>    > spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>>>    > spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>>>    > spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>>>    > m <- do.call(rbind, m)
>>>>    > class(m)
>>>> [1] "SpatialPolygonsDataFrame"
>>>> attr(,"package")
>>>> [1] "sp"
>>>>
>>>> --Mel.
>>>>
>>>> On 7/22/2016 5:53 PM, Edzer Pebesma wrote:
>>>>> The correct call to rbind would be
>>>>>
>>>>> mm = rbind(m[[1]], m[[2]], m[[3]], makeUniqueIDs=T)
>>>>>
>>>>> with sp on CRAN this doesn't work; with the version on github it does.
>>>>>
>>>>> An alternative with sp from CRAN is to make the IDs unique by hand:
>>>>>
>>>>> spChFIDs(m[[1]]) <- paste0("A", seq(length(m[[1]])))
>>>>> spChFIDs(m[[2]]) <- paste0("B", seq(length(m[[2]])))
>>>>> spChFIDs(m[[3]]) <- paste0("C", seq(length(m[[3]])))
>>>>> mm = rbind(m[[1]], m[[2]], m[[3]])
>>>>>
>>>>>
>>>>> On 22/07/16 22:55, Bacou, Melanie wrote:
>>>>>> Hi,
>>>>>> I'm getting weird results trying to rbind a list of
>>>>>> SpatialPolygonsDataFrames with R 3.2.1 and raster 2.5.8. I believe the
>>>>>> code below used to merge all 3 country boundaries, but instead I now get
>>>>>> a list with 6 elements (incl. 3 logical TRUE). Am I doing something wrong?
>>>>>>
>>>>>> Thx, --Mel.
>>>>>>
>>>>>>> library(raster)
>>>>>>> m <- lapply(c("TZA", "UGA", "GHA"), function(x) getData("GADM",
>>>>>> country=x, level=1))
>>>>>>> m <- rbind(m, makeUniqueIDs=T)
>>>>>>> sapply(m, class)
>>>>>> [1] "SpatialPolygonsDataFrame" "logical" "SpatialPolygonsDataFrame"
>>>>>> [4] "logical"                  "SpatialPolygonsDataFrame" "logical"
>>>>>>
>>>>>>> sessionInfo()
>>>>>> R version 3.2.1 (2015-06-18)
>>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>>>>
>>>>>> locale:
>>>>>> [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United
>>>>>> States.1252
>>>>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>>>>> [5] LC_TIME=English_United States.1252
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] raster_2.5-8 sp_1.2-3     rj_2.0.5-2
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] rj.gd_2.0.0-1   Rcpp_0.12.6     grid_3.2.1 lattice_0.20-33
>>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dan.l.warren at gmail.com  Mon Jul 25 02:34:12 2016
From: dan.l.warren at gmail.com (Dan Warren)
Date: Mon, 25 Jul 2016 10:34:12 +1000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
Message-ID: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>

This is not an error per se so much as just something very weird that I
have noticed with a project I've been working on recently.  I'm wondering
if anyone here has any insight as to what may be causing this behavior.  I
haven't yet been able to duplicate it with simulated rasters (more info on
that below), but it appears very reliably with real environmental data
including the PC rasters for Cuba I have hosted here:

https://github.com/danlwarren/ENMTools/tree/master/test/testdata

What's happening is this: if I go to extract data from those rasters using
occurrence points, the amount of time it takes increases very rapidly up to
exactly 250 points, and falls dramatically after that.  So dramatically
that it takes over two minutes to extract data for 250 points but just
under three seconds for 251.  I've established that it's not a question of
the points themselves being wonky, because it happens with random points as
well.


extract.test <- function(env, N){
      extract(env, randomPoints(env, N))
}

env.files <- list.files(path = "testdata/", pattern = "pc", full.names =
TRUE)
env <- stack(env.files)

system.time(extract.test(env, 250))

   user  system elapsed
  2.807   0.084   2.891

system.time(extract.test(env, 251))

   user  system elapsed
124.562   0.516 125.061

numpoints,time
1,1.54
5,3.93
10,6.764
50,29.939
100,61.431
150,79.295
200,110.283
250,120.118
251,2.748
252,2.756
254,2.767
500,2.876
1000,3.153

The data being extracted looks perfectly reasonable in all cases.  It's not
just these layers, either.  Although (as I mentioned above) I have yet to
come up with simulated rasters that show this behavior, I see this behavior
for both of the sets of rasters for real environmental data that I've
tried.  The results above are from a PCA on Worldclim data for Cuba, but I
just tried them on some Climond data I've got for Australia and I get the
same behavior.  Those rasters are much larger, though, and a result the
times are longer; 251 points took about 43 seconds, whereas I just had to
give up and stop the 250 point extraction after about 30 minutes.

As for those simulated rasters, I've tried the following:

Plain grids of sequential numbers
As above, but with a bunch of NAs added
Filling the Cuban rasters with sequential numbers
Filling the Cuban rasters with random numbers from a uniform (0,1)
distribution

None of those show this issue.  Anyone have any thoughts about what might
be going on here?

	[[alternative HTML version deleted]]


From dan.l.warren at gmail.com  Mon Jul 25 03:34:43 2016
From: dan.l.warren at gmail.com (Dan Warren)
Date: Mon, 25 Jul 2016 11:34:43 +1000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
In-Reply-To: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
References: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
Message-ID: <CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>

Just realized I pasted in the results backwards.  It should have been

system.time(extract.test(env, 250))

   user  system elapsed
124.562   0.516 125.061

system.time(extract.test(env, 251))

   user  system elapsed
  2.807   0.084   2.891



Dan Warren, Ph.D.
Department of Biology
Macquarie University
Email: dan.warren at mq.edu.au <dan.warren at anu.edu.au>
Phone (US): 530-848-3809
Phone (Australia): 0468 696 897
Phone (Work): 02 9850 8587
Skype: dan.l.warren
Google Scholar
<https://scholar.google.com/citations?user=NTzu9c8AAAAJ&hl=en>  Orcid
<http://orcid.org/0000-0002-8747-2451>  ResearcherID
<http://www.researcherid.com/rid/B-3821-2010>  Scopus
<http://www.scopus.com/authid/detail.url?authorId=7202133982>

On Mon, Jul 25, 2016 at 10:34 AM, Dan Warren <dan.l.warren at gmail.com> wrote:

> This is not an error per se so much as just something very weird that I
> have noticed with a project I've been working on recently.  I'm wondering
> if anyone here has any insight as to what may be causing this behavior.  I
> haven't yet been able to duplicate it with simulated rasters (more info on
> that below), but it appears very reliably with real environmental data
> including the PC rasters for Cuba I have hosted here:
>
> https://github.com/danlwarren/ENMTools/tree/master/test/testdata
>
> What's happening is this: if I go to extract data from those rasters using
> occurrence points, the amount of time it takes increases very rapidly up to
> exactly 250 points, and falls dramatically after that.  So dramatically
> that it takes over two minutes to extract data for 250 points but just
> under three seconds for 251.  I've established that it's not a question of
> the points themselves being wonky, because it happens with random points as
> well.
>
>
> extract.test <- function(env, N){
>       extract(env, randomPoints(env, N))
> }
>
> env.files <- list.files(path = "testdata/", pattern = "pc", full.names =
> TRUE)
> env <- stack(env.files)
>
> system.time(extract.test(env, 250))
>
>    user  system elapsed
>   2.807   0.084   2.891
>
> system.time(extract.test(env, 251))
>
>    user  system elapsed
> 124.562   0.516 125.061
>
> numpoints,time
> 1,1.54
> 5,3.93
> 10,6.764
> 50,29.939
> 100,61.431
> 150,79.295
> 200,110.283
> 250,120.118
> 251,2.748
> 252,2.756
> 254,2.767
> 500,2.876
> 1000,3.153
>
> The data being extracted looks perfectly reasonable in all cases.  It's
> not just these layers, either.  Although (as I mentioned above) I have yet
> to come up with simulated rasters that show this behavior, I see this
> behavior for both of the sets of rasters for real environmental data that
> I've tried.  The results above are from a PCA on Worldclim data for Cuba,
> but I just tried them on some Climond data I've got for Australia and I get
> the same behavior.  Those rasters are much larger, though, and a result the
> times are longer; 251 points took about 43 seconds, whereas I just had to
> give up and stop the 250 point extraction after about 30 minutes.
>
> As for those simulated rasters, I've tried the following:
>
> Plain grids of sequential numbers
> As above, but with a bunch of NAs added
> Filling the Cuban rasters with sequential numbers
> Filling the Cuban rasters with random numbers from a uniform (0,1)
> distribution
>
> None of those show this issue.  Anyone have any thoughts about what might
> be going on here?
>
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Mon Jul 25 04:15:02 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 25 Jul 2016 02:15:02 +0000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
In-Reply-To: <CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>
References: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
	<CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>
Message-ID: <CAAcGz9_qUdLQPc+avP=bzLGN41ez7mJ4hd3H_D+9V6u8GPop2g@mail.gmail.com>

On Mon, 25 Jul 2016 at 11:35 Dan Warren <dan.l.warren at gmail.com> wrote:

> Just realized I pasted in the results backwards.  It should have been
>
> system.time(extract.test(env, 250))
>
>    user  system elapsed
> 124.562   0.516 125.061
>
> system.time(extract.test(env, 251))
>
>    user  system elapsed
>   2.807   0.084   2.891
>
>
>
>
I don't see the effect.

Perhaps it was fixed in recent version of raster?

Please post reproducible details, I downloaded your data files to
"test/testdata/" to try this.

Cheers, Mike.


library(raster)
library(dismo)
extract.test <- function(env, N){
  extract(env, dismo::randomPoints(env, N))
}

env.files <- list.files(path = "test/testdata/", pattern = "pc", full.names
=
                          TRUE)
env <- raster::stack(env.files)

library(rbenchmark)
benchmark(n250 = extract.test(env, 250),
          n251 = extract.test(env, 251), replications = 4)
# test replications elapsed relative user.self sys.self user.child sys.child
# 1 n250            4    6.31    1.008      5.13     1.14         NA
 NA
# 2 n251            4    6.26    1.000      5.02     1.22         NA
 NA
devtools::session_info()
# Session info
-------------------------------------------------------------------------------------------------------------------------------
#   setting  value
# version  R version 3.3.1 Patched (2016-07-09 r70874)
# system   x86_64, mingw32
# ui       RStudio (0.99.1261)
# language (EN)
# collate  English_Australia.1252
# tz       Australia/Hobart
# date     2016-07-25
#
# Packages
-----------------------------------------------------------------------------------------------------------------------------------
#   package    * version date       source
# devtools   * 1.12.0  2016-06-24 CRAN (R 3.3.1)
# digest       0.6.9   2016-01-08 CRAN (R 3.3.1)
# dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.1)
# evaluate     0.9     2016-04-29 CRAN (R 3.3.1)
# htmltools    0.3.5   2016-03-21 CRAN (R 3.3.1)
# knitr        1.13    2016-05-09 CRAN (R 3.3.1)
# lattice      0.20-33 2015-07-14 CRAN (R 3.3.1)
# magrittr     1.5     2014-11-22 CRAN (R 3.3.1)
# memoise      1.0.0   2016-01-29 CRAN (R 3.3.1)
# raster     * 2.5-8   2016-06-02 CRAN (R 3.3.1)
# rbenchmark * 1.0.0   2012-08-30 CRAN (R 3.3.0)
# Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.1)
# rgdal        1.1-10  2016-05-12 CRAN (R 3.3.1)
# rmarkdown    1.0.2   2016-07-19 Github (rstudio/rmarkdown at b65e177)
# sp         * 1.2-3   2016-04-14 CRAN (R 3.3.1)
# stringi      1.1.1   2016-05-27 CRAN (R 3.3.0)
# stringr      1.0.0   2015-04-30 CRAN (R 3.3.1)
# withr        1.0.2   2016-06-20 CRAN (R 3.3.1)





> Dan Warren, Ph.D.
> Department of Biology
> Macquarie University
> Email: dan.warren at mq.edu.au <dan.warren at anu.edu.au>
> Phone (US): 530-848-3809
> Phone (Australia): 0468 696 897
> Phone (Work): 02 9850 8587
> Skype: dan.l.warren
> Google Scholar
> <https://scholar.google.com/citations?user=NTzu9c8AAAAJ&hl=en>  Orcid
> <http://orcid.org/0000-0002-8747-2451>  ResearcherID
> <http://www.researcherid.com/rid/B-3821-2010>  Scopus
> <http://www.scopus.com/authid/detail.url?authorId=7202133982>
>
> On Mon, Jul 25, 2016 at 10:34 AM, Dan Warren <dan.l.warren at gmail.com>
> wrote:
>
> > This is not an error per se so much as just something very weird that I
> > have noticed with a project I've been working on recently.  I'm wondering
> > if anyone here has any insight as to what may be causing this behavior.
> I
> > haven't yet been able to duplicate it with simulated rasters (more info
> on
> > that below), but it appears very reliably with real environmental data
> > including the PC rasters for Cuba I have hosted here:
> >
> > https://github.com/danlwarren/ENMTools/tree/master/test/testdata
> >
> > What's happening is this: if I go to extract data from those rasters
> using
> > occurrence points, the amount of time it takes increases very rapidly up
> to
> > exactly 250 points, and falls dramatically after that.  So dramatically
> > that it takes over two minutes to extract data for 250 points but just
> > under three seconds for 251.  I've established that it's not a question
> of
> > the points themselves being wonky, because it happens with random points
> as
> > well.
> >
> >
> > extract.test <- function(env, N){
> >       extract(env, randomPoints(env, N))
> > }
> >
> > env.files <- list.files(path = "testdata/", pattern = "pc", full.names =
> > TRUE)
> > env <- stack(env.files)
> >
> > system.time(extract.test(env, 250))
> >
> >    user  system elapsed
> >   2.807   0.084   2.891
> >
> > system.time(extract.test(env, 251))
> >
> >    user  system elapsed
> > 124.562   0.516 125.061
> >
> > numpoints,time
> > 1,1.54
> > 5,3.93
> > 10,6.764
> > 50,29.939
> > 100,61.431
> > 150,79.295
> > 200,110.283
> > 250,120.118
> > 251,2.748
> > 252,2.756
> > 254,2.767
> > 500,2.876
> > 1000,3.153
> >
> > The data being extracted looks perfectly reasonable in all cases.  It's
> > not just these layers, either.  Although (as I mentioned above) I have
> yet
> > to come up with simulated rasters that show this behavior, I see this
> > behavior for both of the sets of rasters for real environmental data that
> > I've tried.  The results above are from a PCA on Worldclim data for Cuba,
> > but I just tried them on some Climond data I've got for Australia and I
> get
> > the same behavior.  Those rasters are much larger, though, and a result
> the
> > times are longer; 251 points took about 43 seconds, whereas I just had to
> > give up and stop the 250 point extraction after about 30 minutes.
> >
> > As for those simulated rasters, I've tried the following:
> >
> > Plain grids of sequential numbers
> > As above, but with a bunch of NAs added
> > Filling the Cuban rasters with sequential numbers
> > Filling the Cuban rasters with random numbers from a uniform (0,1)
> > distribution
> >
> > None of those show this issue.  Anyone have any thoughts about what might
> > be going on here?
> >
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From dan.l.warren at gmail.com  Mon Jul 25 04:24:06 2016
From: dan.l.warren at gmail.com (Dan Warren)
Date: Mon, 25 Jul 2016 12:24:06 +1000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
In-Reply-To: <CAAcGz9_qUdLQPc+avP=bzLGN41ez7mJ4hd3H_D+9V6u8GPop2g@mail.gmail.com>
References: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
	<CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>
	<CAAcGz9_qUdLQPc+avP=bzLGN41ez7mJ4hd3H_D+9V6u8GPop2g@mail.gmail.com>
Message-ID: <CAA8qk716ehL39PXDgXtoaeOB0z57drLdL5ABag1-kjsr3=KYnA@mail.gmail.com>

How very odd.  I'm using R 3.3.0, but as far as I can tell I'm using the
same package versions as you.  I've tried this on two machines (12 core Mac
Pro and an older Macbook Pro) and I'm getting the same phenomenon on both.
Could it be a weird OSX thing?  I'll try updating R and then if it still
persists I'll bootcamp over into Windows and see if it's happening for me
there.


My session info (sorry for not including that the first time):

Session info
----------------------------------------------------------------------------------------------------------------------------------------
 setting  value
 version  R version 3.3.0 (2016-05-03)
 system   x86_64, darwin13.4.0
 ui       RStudio (0.99.491)
 language (EN)
 collate  en_AU.UTF-8
 tz       Australia/Sydney
 date     2016-07-25

Packages
--------------------------------------------------------------------------------------------------------------------------------------------
 package    * version date       source
 colorspace   1.2-6   2015-03-11 CRAN (R 3.3.0)
 devtools     1.12.0  2016-06-24 CRAN (R 3.3.0)
 digest       0.6.9   2016-01-08 CRAN (R 3.3.0)
 dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.0)
 ENMTools   * 0.1     2016-07-25 local
 ggplot2    * 2.1.0   2016-03-01 CRAN (R 3.3.0)
 gridExtra  * 2.2.1   2016-02-29 CRAN (R 3.3.0)
 gtable       0.2.0   2016-02-26 CRAN (R 3.3.0)
 highr        0.6     2016-05-09 CRAN (R 3.3.0)
 knitr      * 1.13    2016-05-09 CRAN (R 3.3.0)
 lattice      0.20-33 2015-07-14 CRAN (R 3.3.0)
 memoise      1.0.0   2016-01-29 CRAN (R 3.3.0)
 munsell      0.4.3   2016-02-13 CRAN (R 3.3.0)
 plyr       * 1.8.4   2016-06-08 CRAN (R 3.3.0)
 raster     * 2.5-8   2016-06-02 CRAN (R 3.3.0)
 Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.0)
 rgeos      * 0.3-19  2016-04-04 CRAN (R 3.3.0)
 rJava        0.9-8   2016-01-07 CRAN (R 3.3.0)
 scales       0.4.0   2016-02-26 CRAN (R 3.3.0)
 sp         * 1.2-3   2016-04-14 CRAN (R 3.3.0)
 viridis    * 0.3.4   2016-03-12 CRAN (R 3.3.0)
 withr        1.0.2   2016-06-20 CRAN (R 3.3.0)


On Mon, Jul 25, 2016 at 12:15 PM, Michael Sumner <mdsumner at gmail.com> wrote:

>
>
> On Mon, 25 Jul 2016 at 11:35 Dan Warren <dan.l.warren at gmail.com> wrote:
>
>> Just realized I pasted in the results backwards.  It should have been
>>
>> system.time(extract.test(env, 250))
>>
>>    user  system elapsed
>> 124.562   0.516 125.061
>>
>> system.time(extract.test(env, 251))
>>
>>    user  system elapsed
>>   2.807   0.084   2.891
>>
>>
>>
>>
> I don't see the effect.
>
> Perhaps it was fixed in recent version of raster?
>
> Please post reproducible details, I downloaded your data files to
> "test/testdata/" to try this.
>
> Cheers, Mike.
>
>
> library(raster)
> library(dismo)
> extract.test <- function(env, N){
>   extract(env, dismo::randomPoints(env, N))
> }
>
> env.files <- list.files(path = "test/testdata/", pattern = "pc",
> full.names =
>                           TRUE)
> env <- raster::stack(env.files)
>
> library(rbenchmark)
> benchmark(n250 = extract.test(env, 250),
>           n251 = extract.test(env, 251), replications = 4)
> # test replications elapsed relative user.self sys.self user.child
> sys.child
> # 1 n250            4    6.31    1.008      5.13     1.14         NA
>  NA
> # 2 n251            4    6.26    1.000      5.02     1.22         NA
>  NA
> devtools::session_info()
> # Session info
> -------------------------------------------------------------------------------------------------------------------------------
> #   setting  value
> # version  R version 3.3.1 Patched (2016-07-09 r70874)
> # system   x86_64, mingw32
> # ui       RStudio (0.99.1261)
> # language (EN)
> # collate  English_Australia.1252
> # tz       Australia/Hobart
> # date     2016-07-25
> #
> # Packages
> -----------------------------------------------------------------------------------------------------------------------------------
> #   package    * version date       source
> # devtools   * 1.12.0  2016-06-24 CRAN (R 3.3.1)
> # digest       0.6.9   2016-01-08 CRAN (R 3.3.1)
> # dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.1)
> # evaluate     0.9     2016-04-29 CRAN (R 3.3.1)
> # htmltools    0.3.5   2016-03-21 CRAN (R 3.3.1)
> # knitr        1.13    2016-05-09 CRAN (R 3.3.1)
> # lattice      0.20-33 2015-07-14 CRAN (R 3.3.1)
> # magrittr     1.5     2014-11-22 CRAN (R 3.3.1)
> # memoise      1.0.0   2016-01-29 CRAN (R 3.3.1)
> # raster     * 2.5-8   2016-06-02 CRAN (R 3.3.1)
> # rbenchmark * 1.0.0   2012-08-30 CRAN (R 3.3.0)
> # Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.1)
> # rgdal        1.1-10  2016-05-12 CRAN (R 3.3.1)
> # rmarkdown    1.0.2   2016-07-19 Github (rstudio/rmarkdown at b65e177)
> # sp         * 1.2-3   2016-04-14 CRAN (R 3.3.1)
> # stringi      1.1.1   2016-05-27 CRAN (R 3.3.0)
> # stringr      1.0.0   2015-04-30 CRAN (R 3.3.1)
> # withr        1.0.2   2016-06-20 CRAN (R 3.3.1)
>
>
>
>
>
>> Dan Warren, Ph.D.
>> Department of Biology
>> Macquarie University
>> Email: dan.warren at mq.edu.au <dan.warren at anu.edu.au>
>> Phone (US): 530-848-3809
>> Phone (Australia): 0468 696 897
>> Phone (Work): 02 9850 8587
>> Skype: dan.l.warren
>> Google Scholar
>> <https://scholar.google.com/citations?user=NTzu9c8AAAAJ&hl=en>  Orcid
>> <http://orcid.org/0000-0002-8747-2451>  ResearcherID
>> <http://www.researcherid.com/rid/B-3821-2010>  Scopus
>> <http://www.scopus.com/authid/detail.url?authorId=7202133982>
>>
>>
>> On Mon, Jul 25, 2016 at 10:34 AM, Dan Warren <dan.l.warren at gmail.com>
>> wrote:
>>
>> > This is not an error per se so much as just something very weird that I
>> > have noticed with a project I've been working on recently.  I'm
>> wondering
>> > if anyone here has any insight as to what may be causing this
>> behavior.  I
>> > haven't yet been able to duplicate it with simulated rasters (more info
>> on
>> > that below), but it appears very reliably with real environmental data
>> > including the PC rasters for Cuba I have hosted here:
>> >
>> > https://github.com/danlwarren/ENMTools/tree/master/test/testdata
>> >
>> > What's happening is this: if I go to extract data from those rasters
>> using
>> > occurrence points, the amount of time it takes increases very rapidly
>> up to
>> > exactly 250 points, and falls dramatically after that.  So dramatically
>> > that it takes over two minutes to extract data for 250 points but just
>> > under three seconds for 251.  I've established that it's not a question
>> of
>> > the points themselves being wonky, because it happens with random
>> points as
>> > well.
>> >
>> >
>> > extract.test <- function(env, N){
>> >       extract(env, randomPoints(env, N))
>> > }
>> >
>> > env.files <- list.files(path = "testdata/", pattern = "pc", full.names =
>> > TRUE)
>> > env <- stack(env.files)
>> >
>> > system.time(extract.test(env, 250))
>> >
>> >    user  system elapsed
>> >   2.807   0.084   2.891
>> >
>> > system.time(extract.test(env, 251))
>> >
>> >    user  system elapsed
>> > 124.562   0.516 125.061
>> >
>> > numpoints,time
>> > 1,1.54
>> > 5,3.93
>> > 10,6.764
>> > 50,29.939
>> > 100,61.431
>> > 150,79.295
>> > 200,110.283
>> > 250,120.118
>> > 251,2.748
>> > 252,2.756
>> > 254,2.767
>> > 500,2.876
>> > 1000,3.153
>> >
>> > The data being extracted looks perfectly reasonable in all cases.  It's
>> > not just these layers, either.  Although (as I mentioned above) I have
>> yet
>> > to come up with simulated rasters that show this behavior, I see this
>> > behavior for both of the sets of rasters for real environmental data
>> that
>> > I've tried.  The results above are from a PCA on Worldclim data for
>> Cuba,
>> > but I just tried them on some Climond data I've got for Australia and I
>> get
>> > the same behavior.  Those rasters are much larger, though, and a result
>> the
>> > times are longer; 251 points took about 43 seconds, whereas I just had
>> to
>> > give up and stop the 250 point extraction after about 30 minutes.
>> >
>> > As for those simulated rasters, I've tried the following:
>> >
>> > Plain grids of sequential numbers
>> > As above, but with a bunch of NAs added
>> > Filling the Cuban rasters with sequential numbers
>> > Filling the Cuban rasters with random numbers from a uniform (0,1)
>> > distribution
>> >
>> > None of those show this issue.  Anyone have any thoughts about what
>> might
>> > be going on here?
>> >
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>

	[[alternative HTML version deleted]]


From dan.l.warren at gmail.com  Mon Jul 25 04:29:32 2016
From: dan.l.warren at gmail.com (Dan Warren)
Date: Mon, 25 Jul 2016 12:29:32 +1000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
In-Reply-To: <CAA8qk716ehL39PXDgXtoaeOB0z57drLdL5ABag1-kjsr3=KYnA@mail.gmail.com>
References: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
	<CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>
	<CAAcGz9_qUdLQPc+avP=bzLGN41ez7mJ4hd3H_D+9V6u8GPop2g@mail.gmail.com>
	<CAA8qk716ehL39PXDgXtoaeOB0z57drLdL5ABag1-kjsr3=KYnA@mail.gmail.com>
Message-ID: <CAA8qk72Pa4kf7FY4QwU6RWs-3LVHRm04VM9x48dCOVcU+xXaNw@mail.gmail.com>

Updating to R 3.3.1 fixed it.  Thanks!  Still baffled as to why the sudden
dropoff between 250 and 251, but as long as it's working all is well.

Cheers!


On Mon, Jul 25, 2016 at 12:24 PM, Dan Warren <dan.l.warren at gmail.com> wrote:

> How very odd.  I'm using R 3.3.0, but as far as I can tell I'm using the
> same package versions as you.  I've tried this on two machines (12 core Mac
> Pro and an older Macbook Pro) and I'm getting the same phenomenon on both.
> Could it be a weird OSX thing?  I'll try updating R and then if it still
> persists I'll bootcamp over into Windows and see if it's happening for me
> there.
>
>
> My session info (sorry for not including that the first time):
>
> Session info
> ----------------------------------------------------------------------------------------------------------------------------------------
>  setting  value
>  version  R version 3.3.0 (2016-05-03)
>  system   x86_64, darwin13.4.0
>  ui       RStudio (0.99.491)
>  language (EN)
>  collate  en_AU.UTF-8
>  tz       Australia/Sydney
>  date     2016-07-25
>
> Packages
> --------------------------------------------------------------------------------------------------------------------------------------------
>  package    * version date       source
>  colorspace   1.2-6   2015-03-11 CRAN (R 3.3.0)
>  devtools     1.12.0  2016-06-24 CRAN (R 3.3.0)
>  digest       0.6.9   2016-01-08 CRAN (R 3.3.0)
>  dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.0)
>  ENMTools   * 0.1     2016-07-25 local
>  ggplot2    * 2.1.0   2016-03-01 CRAN (R 3.3.0)
>  gridExtra  * 2.2.1   2016-02-29 CRAN (R 3.3.0)
>  gtable       0.2.0   2016-02-26 CRAN (R 3.3.0)
>  highr        0.6     2016-05-09 CRAN (R 3.3.0)
>  knitr      * 1.13    2016-05-09 CRAN (R 3.3.0)
>  lattice      0.20-33 2015-07-14 CRAN (R 3.3.0)
>  memoise      1.0.0   2016-01-29 CRAN (R 3.3.0)
>  munsell      0.4.3   2016-02-13 CRAN (R 3.3.0)
>  plyr       * 1.8.4   2016-06-08 CRAN (R 3.3.0)
>  raster     * 2.5-8   2016-06-02 CRAN (R 3.3.0)
>  Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.0)
>  rgeos      * 0.3-19  2016-04-04 CRAN (R 3.3.0)
>  rJava        0.9-8   2016-01-07 CRAN (R 3.3.0)
>  scales       0.4.0   2016-02-26 CRAN (R 3.3.0)
>  sp         * 1.2-3   2016-04-14 CRAN (R 3.3.0)
>  viridis    * 0.3.4   2016-03-12 CRAN (R 3.3.0)
>  withr        1.0.2   2016-06-20 CRAN (R 3.3.0)
>
>
> On Mon, Jul 25, 2016 at 12:15 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
>
>>
>>
>> On Mon, 25 Jul 2016 at 11:35 Dan Warren <dan.l.warren at gmail.com> wrote:
>>
>>> Just realized I pasted in the results backwards.  It should have been
>>>
>>> system.time(extract.test(env, 250))
>>>
>>>    user  system elapsed
>>> 124.562   0.516 125.061
>>>
>>> system.time(extract.test(env, 251))
>>>
>>>    user  system elapsed
>>>   2.807   0.084   2.891
>>>
>>>
>>>
>>>
>> I don't see the effect.
>>
>> Perhaps it was fixed in recent version of raster?
>>
>> Please post reproducible details, I downloaded your data files to
>> "test/testdata/" to try this.
>>
>> Cheers, Mike.
>>
>>
>> library(raster)
>> library(dismo)
>> extract.test <- function(env, N){
>>   extract(env, dismo::randomPoints(env, N))
>> }
>>
>> env.files <- list.files(path = "test/testdata/", pattern = "pc",
>> full.names =
>>                           TRUE)
>> env <- raster::stack(env.files)
>>
>> library(rbenchmark)
>> benchmark(n250 = extract.test(env, 250),
>>           n251 = extract.test(env, 251), replications = 4)
>> # test replications elapsed relative user.self sys.self user.child
>> sys.child
>> # 1 n250            4    6.31    1.008      5.13     1.14         NA
>>    NA
>> # 2 n251            4    6.26    1.000      5.02     1.22         NA
>>    NA
>> devtools::session_info()
>> # Session info
>> -------------------------------------------------------------------------------------------------------------------------------
>> #   setting  value
>> # version  R version 3.3.1 Patched (2016-07-09 r70874)
>> # system   x86_64, mingw32
>> # ui       RStudio (0.99.1261)
>> # language (EN)
>> # collate  English_Australia.1252
>> # tz       Australia/Hobart
>> # date     2016-07-25
>> #
>> # Packages
>> -----------------------------------------------------------------------------------------------------------------------------------
>> #   package    * version date       source
>> # devtools   * 1.12.0  2016-06-24 CRAN (R 3.3.1)
>> # digest       0.6.9   2016-01-08 CRAN (R 3.3.1)
>> # dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.1)
>> # evaluate     0.9     2016-04-29 CRAN (R 3.3.1)
>> # htmltools    0.3.5   2016-03-21 CRAN (R 3.3.1)
>> # knitr        1.13    2016-05-09 CRAN (R 3.3.1)
>> # lattice      0.20-33 2015-07-14 CRAN (R 3.3.1)
>> # magrittr     1.5     2014-11-22 CRAN (R 3.3.1)
>> # memoise      1.0.0   2016-01-29 CRAN (R 3.3.1)
>> # raster     * 2.5-8   2016-06-02 CRAN (R 3.3.1)
>> # rbenchmark * 1.0.0   2012-08-30 CRAN (R 3.3.0)
>> # Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.1)
>> # rgdal        1.1-10  2016-05-12 CRAN (R 3.3.1)
>> # rmarkdown    1.0.2   2016-07-19 Github (rstudio/rmarkdown at b65e177)
>> # sp         * 1.2-3   2016-04-14 CRAN (R 3.3.1)
>> # stringi      1.1.1   2016-05-27 CRAN (R 3.3.0)
>> # stringr      1.0.0   2015-04-30 CRAN (R 3.3.1)
>> # withr        1.0.2   2016-06-20 CRAN (R 3.3.1)
>>
>>
>>
>>
>>
>>> Dan Warren, Ph.D.
>>> Department of Biology
>>> Macquarie University
>>> Email: dan.warren at mq.edu.au <dan.warren at anu.edu.au>
>>> Phone (US): 530-848-3809
>>> Phone (Australia): 0468 696 897
>>> Phone (Work): 02 9850 8587
>>> Skype: dan.l.warren
>>> Google Scholar
>>> <https://scholar.google.com/citations?user=NTzu9c8AAAAJ&hl=en>  Orcid
>>> <http://orcid.org/0000-0002-8747-2451>  ResearcherID
>>> <http://www.researcherid.com/rid/B-3821-2010>  Scopus
>>> <http://www.scopus.com/authid/detail.url?authorId=7202133982>
>>>
>>>
>>> On Mon, Jul 25, 2016 at 10:34 AM, Dan Warren <dan.l.warren at gmail.com>
>>> wrote:
>>>
>>> > This is not an error per se so much as just something very weird that I
>>> > have noticed with a project I've been working on recently.  I'm
>>> wondering
>>> > if anyone here has any insight as to what may be causing this
>>> behavior.  I
>>> > haven't yet been able to duplicate it with simulated rasters (more
>>> info on
>>> > that below), but it appears very reliably with real environmental data
>>> > including the PC rasters for Cuba I have hosted here:
>>> >
>>> > https://github.com/danlwarren/ENMTools/tree/master/test/testdata
>>> >
>>> > What's happening is this: if I go to extract data from those rasters
>>> using
>>> > occurrence points, the amount of time it takes increases very rapidly
>>> up to
>>> > exactly 250 points, and falls dramatically after that.  So dramatically
>>> > that it takes over two minutes to extract data for 250 points but just
>>> > under three seconds for 251.  I've established that it's not a
>>> question of
>>> > the points themselves being wonky, because it happens with random
>>> points as
>>> > well.
>>> >
>>> >
>>> > extract.test <- function(env, N){
>>> >       extract(env, randomPoints(env, N))
>>> > }
>>> >
>>> > env.files <- list.files(path = "testdata/", pattern = "pc", full.names
>>> =
>>> > TRUE)
>>> > env <- stack(env.files)
>>> >
>>> > system.time(extract.test(env, 250))
>>> >
>>> >    user  system elapsed
>>> >   2.807   0.084   2.891
>>> >
>>> > system.time(extract.test(env, 251))
>>> >
>>> >    user  system elapsed
>>> > 124.562   0.516 125.061
>>> >
>>> > numpoints,time
>>> > 1,1.54
>>> > 5,3.93
>>> > 10,6.764
>>> > 50,29.939
>>> > 100,61.431
>>> > 150,79.295
>>> > 200,110.283
>>> > 250,120.118
>>> > 251,2.748
>>> > 252,2.756
>>> > 254,2.767
>>> > 500,2.876
>>> > 1000,3.153
>>> >
>>> > The data being extracted looks perfectly reasonable in all cases.  It's
>>> > not just these layers, either.  Although (as I mentioned above) I have
>>> yet
>>> > to come up with simulated rasters that show this behavior, I see this
>>> > behavior for both of the sets of rasters for real environmental data
>>> that
>>> > I've tried.  The results above are from a PCA on Worldclim data for
>>> Cuba,
>>> > but I just tried them on some Climond data I've got for Australia and
>>> I get
>>> > the same behavior.  Those rasters are much larger, though, and a
>>> result the
>>> > times are longer; 251 points took about 43 seconds, whereas I just had
>>> to
>>> > give up and stop the 250 point extraction after about 30 minutes.
>>> >
>>> > As for those simulated rasters, I've tried the following:
>>> >
>>> > Plain grids of sequential numbers
>>> > As above, but with a bunch of NAs added
>>> > Filling the Cuban rasters with sequential numbers
>>> > Filling the Cuban rasters with random numbers from a uniform (0,1)
>>> > distribution
>>> >
>>> > None of those show this issue.  Anyone have any thoughts about what
>>> might
>>> > be going on here?
>>> >
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> Kingston Tasmania 7050 Australia
>>
>>
>

	[[alternative HTML version deleted]]


From matzke at nimbios.org  Mon Jul 25 04:35:04 2016
From: matzke at nimbios.org (Nick Matzke)
Date: Mon, 25 Jul 2016 12:35:04 +1000
Subject: [R-sig-Geo] Odd behavior of dismo's extract function
In-Reply-To: <CAA8qk72Pa4kf7FY4QwU6RWs-3LVHRm04VM9x48dCOVcU+xXaNw@mail.gmail.com>
References: <CAA8qk73EbGCWa9uofE64_axuM4G3BjRh=ni8rnZ4AZb1M2g=Jw@mail.gmail.com>
	<CAA8qk71DHKkRc5g2N_B-MqJvp+K1gbLPSmeb5fAvucJNY90GFA@mail.gmail.com>
	<CAAcGz9_qUdLQPc+avP=bzLGN41ez7mJ4hd3H_D+9V6u8GPop2g@mail.gmail.com>
	<CAA8qk716ehL39PXDgXtoaeOB0z57drLdL5ABag1-kjsr3=KYnA@mail.gmail.com>
	<CAA8qk72Pa4kf7FY4QwU6RWs-3LVHRm04VM9x48dCOVcU+xXaNw@mail.gmail.com>
Message-ID: <CAJdu7BBs=qMhs+DH860XRLprDR1MB3FY0+Mko7BSaVgvLdtMOw@mail.gmail.com>

I am on R 3.3.1 and don't get the huge time difference.  There is a tiny
decrease though from 250 to 251:

=============
wd = "~/Downloads/extract_weirdness/"
setwd(wd)

library(raster)
library(dismo)


extract.test <- function(env, N){
      extract(env, randomPoints(env, N))
}

env.files <- list.files(path = ".", pattern = "pc", full.names =
TRUE)
env <- stack(env.files)


system.time(extract.test(env, 250))

   user  system elapsed
  1.455   0.043   1.492
Warning message:
In couldBeLonLat(mask) : CRS is NA. Assuming it is longitude/latitude


system.time(extract.test(env, 251))   user  system elapsed
  1.137   0.033   1.158
Warning message:
In couldBeLonLat(mask) : CRS is NA. Assuming it is longitude/latitude
=============

...but I won't worry about it myself.  Thanks for the solution though, that
was weird behavior!
Nick




On Mon, Jul 25, 2016 at 12:29 PM, Dan Warren <dan.l.warren at gmail.com> wrote:

> Updating to R 3.3.1 fixed it.  Thanks!  Still baffled as to why the sudden
> dropoff between 250 and 251, but as long as it's working all is well.
>
> Cheers!
>
>
> On Mon, Jul 25, 2016 at 12:24 PM, Dan Warren <dan.l.warren at gmail.com>
> wrote:
>
> > How very odd.  I'm using R 3.3.0, but as far as I can tell I'm using the
> > same package versions as you.  I've tried this on two machines (12 core
> Mac
> > Pro and an older Macbook Pro) and I'm getting the same phenomenon on
> both.
> > Could it be a weird OSX thing?  I'll try updating R and then if it still
> > persists I'll bootcamp over into Windows and see if it's happening for me
> > there.
> >
> >
> > My session info (sorry for not including that the first time):
> >
> > Session info
> >
> ----------------------------------------------------------------------------------------------------------------------------------------
> >  setting  value
> >  version  R version 3.3.0 (2016-05-03)
> >  system   x86_64, darwin13.4.0
> >  ui       RStudio (0.99.491)
> >  language (EN)
> >  collate  en_AU.UTF-8
> >  tz       Australia/Sydney
> >  date     2016-07-25
> >
> > Packages
> >
> --------------------------------------------------------------------------------------------------------------------------------------------
> >  package    * version date       source
> >  colorspace   1.2-6   2015-03-11 CRAN (R 3.3.0)
> >  devtools     1.12.0  2016-06-24 CRAN (R 3.3.0)
> >  digest       0.6.9   2016-01-08 CRAN (R 3.3.0)
> >  dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.0)
> >  ENMTools   * 0.1     2016-07-25 local
> >  ggplot2    * 2.1.0   2016-03-01 CRAN (R 3.3.0)
> >  gridExtra  * 2.2.1   2016-02-29 CRAN (R 3.3.0)
> >  gtable       0.2.0   2016-02-26 CRAN (R 3.3.0)
> >  highr        0.6     2016-05-09 CRAN (R 3.3.0)
> >  knitr      * 1.13    2016-05-09 CRAN (R 3.3.0)
> >  lattice      0.20-33 2015-07-14 CRAN (R 3.3.0)
> >  memoise      1.0.0   2016-01-29 CRAN (R 3.3.0)
> >  munsell      0.4.3   2016-02-13 CRAN (R 3.3.0)
> >  plyr       * 1.8.4   2016-06-08 CRAN (R 3.3.0)
> >  raster     * 2.5-8   2016-06-02 CRAN (R 3.3.0)
> >  Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.0)
> >  rgeos      * 0.3-19  2016-04-04 CRAN (R 3.3.0)
> >  rJava        0.9-8   2016-01-07 CRAN (R 3.3.0)
> >  scales       0.4.0   2016-02-26 CRAN (R 3.3.0)
> >  sp         * 1.2-3   2016-04-14 CRAN (R 3.3.0)
> >  viridis    * 0.3.4   2016-03-12 CRAN (R 3.3.0)
> >  withr        1.0.2   2016-06-20 CRAN (R 3.3.0)
> >
> >
> > On Mon, Jul 25, 2016 at 12:15 PM, Michael Sumner <mdsumner at gmail.com>
> > wrote:
> >
> >>
> >>
> >> On Mon, 25 Jul 2016 at 11:35 Dan Warren <dan.l.warren at gmail.com> wrote:
> >>
> >>> Just realized I pasted in the results backwards.  It should have been
> >>>
> >>> system.time(extract.test(env, 250))
> >>>
> >>>    user  system elapsed
> >>> 124.562   0.516 125.061
> >>>
> >>> system.time(extract.test(env, 251))
> >>>
> >>>    user  system elapsed
> >>>   2.807   0.084   2.891
> >>>
> >>>
> >>>
> >>>
> >> I don't see the effect.
> >>
> >> Perhaps it was fixed in recent version of raster?
> >>
> >> Please post reproducible details, I downloaded your data files to
> >> "test/testdata/" to try this.
> >>
> >> Cheers, Mike.
> >>
> >>
> >> library(raster)
> >> library(dismo)
> >> extract.test <- function(env, N){
> >>   extract(env, dismo::randomPoints(env, N))
> >> }
> >>
> >> env.files <- list.files(path = "test/testdata/", pattern = "pc",
> >> full.names =
> >>                           TRUE)
> >> env <- raster::stack(env.files)
> >>
> >> library(rbenchmark)
> >> benchmark(n250 = extract.test(env, 250),
> >>           n251 = extract.test(env, 251), replications = 4)
> >> # test replications elapsed relative user.self sys.self user.child
> >> sys.child
> >> # 1 n250            4    6.31    1.008      5.13     1.14         NA
> >>    NA
> >> # 2 n251            4    6.26    1.000      5.02     1.22         NA
> >>    NA
> >> devtools::session_info()
> >> # Session info
> >>
> -------------------------------------------------------------------------------------------------------------------------------
> >> #   setting  value
> >> # version  R version 3.3.1 Patched (2016-07-09 r70874)
> >> # system   x86_64, mingw32
> >> # ui       RStudio (0.99.1261)
> >> # language (EN)
> >> # collate  English_Australia.1252
> >> # tz       Australia/Hobart
> >> # date     2016-07-25
> >> #
> >> # Packages
> >>
> -----------------------------------------------------------------------------------------------------------------------------------
> >> #   package    * version date       source
> >> # devtools   * 1.12.0  2016-06-24 CRAN (R 3.3.1)
> >> # digest       0.6.9   2016-01-08 CRAN (R 3.3.1)
> >> # dismo      * 1.1-1   2016-06-16 CRAN (R 3.3.1)
> >> # evaluate     0.9     2016-04-29 CRAN (R 3.3.1)
> >> # htmltools    0.3.5   2016-03-21 CRAN (R 3.3.1)
> >> # knitr        1.13    2016-05-09 CRAN (R 3.3.1)
> >> # lattice      0.20-33 2015-07-14 CRAN (R 3.3.1)
> >> # magrittr     1.5     2014-11-22 CRAN (R 3.3.1)
> >> # memoise      1.0.0   2016-01-29 CRAN (R 3.3.1)
> >> # raster     * 2.5-8   2016-06-02 CRAN (R 3.3.1)
> >> # rbenchmark * 1.0.0   2012-08-30 CRAN (R 3.3.0)
> >> # Rcpp         0.12.5  2016-05-14 CRAN (R 3.3.1)
> >> # rgdal        1.1-10  2016-05-12 CRAN (R 3.3.1)
> >> # rmarkdown    1.0.2   2016-07-19 Github (rstudio/rmarkdown at b65e177)
> >> # sp         * 1.2-3   2016-04-14 CRAN (R 3.3.1)
> >> # stringi      1.1.1   2016-05-27 CRAN (R 3.3.0)
> >> # stringr      1.0.0   2015-04-30 CRAN (R 3.3.1)
> >> # withr        1.0.2   2016-06-20 CRAN (R 3.3.1)
> >>
> >>
> >>
> >>
> >>
> >>> Dan Warren, Ph.D.
> >>> Department of Biology
> >>> Macquarie University
> >>> Email: dan.warren at mq.edu.au <dan.warren at anu.edu.au>
> >>> Phone (US): 530-848-3809
> >>> Phone (Australia): 0468 696 897
> >>> Phone (Work): 02 9850 8587
> >>> Skype: dan.l.warren
> >>> Google Scholar
> >>> <https://scholar.google.com/citations?user=NTzu9c8AAAAJ&hl=en>  Orcid
> >>> <http://orcid.org/0000-0002-8747-2451>  ResearcherID
> >>> <http://www.researcherid.com/rid/B-3821-2010>  Scopus
> >>> <http://www.scopus.com/authid/detail.url?authorId=7202133982>
> >>>
> >>>
> >>> On Mon, Jul 25, 2016 at 10:34 AM, Dan Warren <dan.l.warren at gmail.com>
> >>> wrote:
> >>>
> >>> > This is not an error per se so much as just something very weird
> that I
> >>> > have noticed with a project I've been working on recently.  I'm
> >>> wondering
> >>> > if anyone here has any insight as to what may be causing this
> >>> behavior.  I
> >>> > haven't yet been able to duplicate it with simulated rasters (more
> >>> info on
> >>> > that below), but it appears very reliably with real environmental
> data
> >>> > including the PC rasters for Cuba I have hosted here:
> >>> >
> >>> > https://github.com/danlwarren/ENMTools/tree/master/test/testdata
> >>> >
> >>> > What's happening is this: if I go to extract data from those rasters
> >>> using
> >>> > occurrence points, the amount of time it takes increases very rapidly
> >>> up to
> >>> > exactly 250 points, and falls dramatically after that.  So
> dramatically
> >>> > that it takes over two minutes to extract data for 250 points but
> just
> >>> > under three seconds for 251.  I've established that it's not a
> >>> question of
> >>> > the points themselves being wonky, because it happens with random
> >>> points as
> >>> > well.
> >>> >
> >>> >
> >>> > extract.test <- function(env, N){
> >>> >       extract(env, randomPoints(env, N))
> >>> > }
> >>> >
> >>> > env.files <- list.files(path = "testdata/", pattern = "pc",
> full.names
> >>> =
> >>> > TRUE)
> >>> > env <- stack(env.files)
> >>> >
> >>> > system.time(extract.test(env, 250))
> >>> >
> >>> >    user  system elapsed
> >>> >   2.807   0.084   2.891
> >>> >
> >>> > system.time(extract.test(env, 251))
> >>> >
> >>> >    user  system elapsed
> >>> > 124.562   0.516 125.061
> >>> >
> >>> > numpoints,time
> >>> > 1,1.54
> >>> > 5,3.93
> >>> > 10,6.764
> >>> > 50,29.939
> >>> > 100,61.431
> >>> > 150,79.295
> >>> > 200,110.283
> >>> > 250,120.118
> >>> > 251,2.748
> >>> > 252,2.756
> >>> > 254,2.767
> >>> > 500,2.876
> >>> > 1000,3.153
> >>> >
> >>> > The data being extracted looks perfectly reasonable in all cases.
> It's
> >>> > not just these layers, either.  Although (as I mentioned above) I
> have
> >>> yet
> >>> > to come up with simulated rasters that show this behavior, I see this
> >>> > behavior for both of the sets of rasters for real environmental data
> >>> that
> >>> > I've tried.  The results above are from a PCA on Worldclim data for
> >>> Cuba,
> >>> > but I just tried them on some Climond data I've got for Australia and
> >>> I get
> >>> > the same behavior.  Those rasters are much larger, though, and a
> >>> result the
> >>> > times are longer; 251 points took about 43 seconds, whereas I just
> had
> >>> to
> >>> > give up and stop the 250 point extraction after about 30 minutes.
> >>> >
> >>> > As for those simulated rasters, I've tried the following:
> >>> >
> >>> > Plain grids of sequential numbers
> >>> > As above, but with a bunch of NAs added
> >>> > Filling the Cuban rasters with sequential numbers
> >>> > Filling the Cuban rasters with random numbers from a uniform (0,1)
> >>> > distribution
> >>> >
> >>> > None of those show this issue.  Anyone have any thoughts about what
> >>> might
> >>> > be going on here?
> >>> >
> >>> >
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >> --
> >> Dr. Michael Sumner
> >> Software and Database Engineer
> >> Australian Antarctic Division
> >> 203 Channel Highway
> >> Kingston Tasmania 7050 Australia
> >>
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From ptitle at umich.edu  Sun Jul 24 17:41:16 2016
From: ptitle at umich.edu (Pascal Title)
Date: Sun, 24 Jul 2016 11:41:16 -0400
Subject: [R-sig-Geo] how to write ESRI grids from R
Message-ID: <CAPSA=ycCuAmc25JESmsU89ispvcBKR_x7tOMaYF6kaUH2JgSsQ@mail.gmail.com>

I am trying to convert some rasters to the formats in which the WorldClim
dataset is provided: generic grids and ESRI grids.
The generic grids are provided as 2 files, a .bil and .hdr.
The ESRI grids are provided as a directory of .adf files and a info
directory.

I find that writing a raster with writeRaster() from the raster package
with format = 'EHdr' generates 4 files, with extensions ".aux.xml", ".hdr",
".prj" and ".bil". This seems to be the "generic grid" format, with some
additional files.

However, I can't find the ESRI grid format in R. Is the reason that it is a
proprietary format and I need to go through ArcGIS, or is it possible to
use this format in R?

Thanks!
-Pascal

-- 
Pascal Title
PhD candidate | Rabosky Lab <http://www.raboskylab.org/>
Dept of Ecology and Evolutionary Biology
University of Michigan
ptitle at umich.edu

pascaltitle.weebly.com

	[[alternative HTML version deleted]]


From mel at mbacou.com  Mon Jul 25 10:40:18 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Mon, 25 Jul 2016 04:40:18 -0400
Subject: [R-sig-Geo] how to write ESRI grids from R
In-Reply-To: <CAPSA=ycCuAmc25JESmsU89ispvcBKR_x7tOMaYF6kaUH2JgSsQ@mail.gmail.com>
References: <CAPSA=ycCuAmc25JESmsU89ispvcBKR_x7tOMaYF6kaUH2JgSsQ@mail.gmail.com>
Message-ID: <69bfd39c-40ac-33d1-2869-d12a78f281b9@mbacou.com>

You can use:
writeGDAL(x, drivername="AAIGrid", ...)
or simply use a ".asc" file extention:
writeRaster(x, filename="fileName.asc", ...)

See raster::WriteFormats().

--Mel.


On 7/24/2016 11:41 AM, Pascal Title wrote:
> I am trying to convert some rasters to the formats in which the WorldClim
> dataset is provided: generic grids and ESRI grids.
> The generic grids are provided as 2 files, a .bil and .hdr.
> The ESRI grids are provided as a directory of .adf files and a info
> directory.
>
> I find that writing a raster with writeRaster() from the raster package
> with format = 'EHdr' generates 4 files, with extensions ".aux.xml", ".hdr",
> ".prj" and ".bil". This seems to be the "generic grid" format, with some
> additional files.
>
> However, I can't find the ESRI grid format in R. Is the reason that it is a
> proprietary format and I need to go through ArcGIS, or is it possible to
> use this format in R?
>
> Thanks!
> -Pascal
>


From milujisb at gmail.com  Mon Jul 25 15:01:54 2016
From: milujisb at gmail.com (Miluji Sb)
Date: Mon, 25 Jul 2016 15:01:54 +0200
Subject: [R-sig-Geo] Country names from coordinates
Message-ID: <CAMLwc7MSr9n-hQpqY4txLUEqzi9hUy_9vdSbFKPykkeLcwYJ+Q@mail.gmail.com>

I have the following data at 0.5 degree by 0.5 degree.

temp <- dput(head(ptsDF,10))
structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
-67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
-54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
-53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
c("longitude",
"latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
82L, 95L, 108L, 121L), class = "data.frame")

I would like add the corresponding country names to each of the
coordinates. This is what I have done:

library(data.table)
library(rgdal)
library(reshape2)
library(dplyr)
library(tidyr)
library(lubridate)
library(maps)
library(countrycode)
library(ggplot2)
library(raster)

coord_cells <-temp [,c(1,2)]
pts_cells <-
SpatialPoints(coord_cells,proj4string=CRS(proj4string(worldmap)))
indices_cells <- over(pts_cells, worldmap,na.rm=TRUE)
foo_cells<-indices_cells[,c(3,5)] # Keep ISO3 and country names only
new_data <- cbind(foo_cells, temp)

However, I get a large number of NAs for coordinates which should have
corresponding countries. What am I doing wrong? Any suggestions? Thank you.

Sincerely,

Milu

	[[alternative HTML version deleted]]


From mel at mbacou.com  Mon Jul 25 17:41:54 2016
From: mel at mbacou.com (Bacou, Melanie)
Date: Mon, 25 Jul 2016 11:41:54 -0400
Subject: [R-sig-Geo] Country names from coordinates
In-Reply-To: <CAMLwc7MSr9n-hQpqY4txLUEqzi9hUy_9vdSbFKPykkeLcwYJ+Q@mail.gmail.com>
References: <CAMLwc7MSr9n-hQpqY4txLUEqzi9hUy_9vdSbFKPykkeLcwYJ+Q@mail.gmail.com>
Message-ID: <d74585c0-f210-0b58-1bde-430fb59bae9d@mbacou.com>

Here is an approach using raster::extract(). I assume your point 
locations are unprojected.

library(raster)
library(tmap)

data(World)
proj4string(World)
# [1] "+proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 
+units=m +no_defs +towgs84=0,0,0"

pts <- SpatialPointsDataFrame(temp [, c(1,2)], temp, 
proj4string=CRS("+init=epsg:4326"))
# Reproject World
World <- spTransform(World, CRS("+init=epsg:4326"))
# Extract and append World attributes at pts point locations
pts <- extract(World, pts, sp=TRUE)

--Mel.


On 7/25/2016 9:01 AM, Miluji Sb wrote:
> I have the following data at 0.5 degree by 0.5 degree.
>
> temp <- dput(head(ptsDF,10))
> structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
> -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
> -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
> -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
> 0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
> c("longitude",
> "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
> 82L, 95L, 108L, 121L), class = "data.frame")
>
> I would like add the corresponding country names to each of the
> coordinates. This is what I have done:
>
> library(data.table)
> library(rgdal)
> library(reshape2)
> library(dplyr)
> library(tidyr)
> library(lubridate)
> library(maps)
> library(countrycode)
> library(ggplot2)
> library(raster)
>
> coord_cells <-temp [,c(1,2)]
> pts_cells <-
> SpatialPoints(coord_cells,proj4string=CRS(proj4string(worldmap)))
> indices_cells <- over(pts_cells, worldmap,na.rm=TRUE)
> foo_cells<-indices_cells[,c(3,5)] # Keep ISO3 and country names only
> new_data <- cbind(foo_cells, temp)
>
> However, I get a large number of NAs for coordinates which should have
> corresponding countries. What am I doing wrong? Any suggestions? Thank you.
>
> Sincerely,
>
> Milu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Jul 25 20:38:00 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 25 Jul 2016 20:38:00 +0200
Subject: [R-sig-Geo] Country names from coordinates
In-Reply-To: <d74585c0-f210-0b58-1bde-430fb59bae9d@mbacou.com>
References: <CAMLwc7MSr9n-hQpqY4txLUEqzi9hUy_9vdSbFKPykkeLcwYJ+Q@mail.gmail.com>
	<d74585c0-f210-0b58-1bde-430fb59bae9d@mbacou.com>
Message-ID: <alpine.LFD.2.20.1607252035030.18559@reclus.nhh.no>

On Mon, 25 Jul 2016, Bacou, Melanie wrote:

> Here is an approach using raster::extract(). I assume your point locations 
> are unprojected.

Offline, OK, but online you may use the geonames package, which requires a 
valid geonames user name:

library(geonames)
options(geonamesUsername="<me>")
res <- vector(mode="list", length=nrow(ptsDF))
for (i in 1:nrow(ptsDF)) res[[i]] <- try(GNcountryCode(ptsDF$latitude[i],
  ptsDF$longitude[i], radius=50))
res

using radius= to catch a slightly offshore point in Chile in the example.

Roger

>
> library(raster)
> library(tmap)
>
> data(World)
> proj4string(World)
> # [1] "+proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m 
> +no_defs +towgs84=0,0,0"
>
> pts <- SpatialPointsDataFrame(temp [, c(1,2)], temp, 
> proj4string=CRS("+init=epsg:4326"))
> # Reproject World
> World <- spTransform(World, CRS("+init=epsg:4326"))
> # Extract and append World attributes at pts point locations
> pts <- extract(World, pts, sp=TRUE)
>
> --Mel.
>
>
> On 7/25/2016 9:01 AM, Miluji Sb wrote:
>>  I have the following data at 0.5 degree by 0.5 degree.
>>
>>  temp <- dput(head(ptsDF,10))
>>  structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
>>  -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
>>  -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
>>  -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
>>  0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
>>  c("longitude",
>>  "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
>>  82L, 95L, 108L, 121L), class = "data.frame")
>>
>>  I would like add the corresponding country names to each of the
>>  coordinates. This is what I have done:
>>
>>  library(data.table)
>>  library(rgdal)
>>  library(reshape2)
>>  library(dplyr)
>>  library(tidyr)
>>  library(lubridate)
>>  library(maps)
>>  library(countrycode)
>>  library(ggplot2)
>>  library(raster)
>>
>>  coord_cells <-temp [,c(1,2)]
>>  pts_cells <-
>>  SpatialPoints(coord_cells,proj4string=CRS(proj4string(worldmap)))
>>  indices_cells <- over(pts_cells, worldmap,na.rm=TRUE)
>>  foo_cells<-indices_cells[,c(3,5)] # Keep ISO3 and country names only
>>  new_data <- cbind(foo_cells, temp)
>>
>>  However, I get a large number of NAs for coordinates which should have
>>  corresponding countries. What am I doing wrong? Any suggestions? Thank
>>  you.
>>
>>  Sincerely,
>>
>>  Milu
>>
>>   [[alternative HTML version deleted]]
>>
>>  _______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at r-project.org
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412


From Celine.Trmal at cerema.fr  Tue Jul 26 11:33:24 2016
From: Celine.Trmal at cerema.fr (=?UTF-8?Q?=22TRMAL_C=C3=A9line_=2D_CEREMA=2FDTerMed=2FDREC=2FSRILH=22?=)
Date: Tue, 26 Jul 2016 11:33:24 +0200
Subject: [R-sig-Geo] Format data frame of a shp file
Message-ID: <57972E64.2090607@cerema.fr>

Hello

I'm modifying shape file in R.
When exporting with writeOGR or writeSpatialShape, the data frame has 
not the good format, too many digits for numeric.
I tried format(layer at data[,4],digits=1) but it didn't work?

Any ideas? Thanks in advance
-- 

*C?line TRMAL *
*Ing?nieur Charg?e d'Etudes
**DREC/Service Risques Inondations, Littoraux et Hydrauliques **- T?l.: 
04 42 24 76 77 *
*Direction Territoriale M?diterran?e
*
Centre d??tudes et d?expertise sur les risques, l?environnement, la 
mobilit? et l?am?nagement
www.cerema.fr <http://www.cerema.fr>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160726/85d8cd96/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cerema.png
Type: image/png
Size: 6094 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20160726/85d8cd96/attachment.png>

From Roger.Bivand at nhh.no  Tue Jul 26 11:35:56 2016
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Jul 2016 11:35:56 +0200
Subject: [R-sig-Geo] Format data frame of a shp file
In-Reply-To: <57972E64.2090607@cerema.fr>
References: <57972E64.2090607@cerema.fr>
Message-ID: <alpine.LFD.2.20.1607261135140.2577@reclus.nhh.no>

On Tue, 26 Jul 2016, "TRMAL C?line - CEREMA/DTerMed/DREC/SRILH" wrote:

> Hello
>
> I'm modifying shape file in R.
> When exporting with writeOGR or writeSpatialShape, the data frame has 
> not the good format, too many digits for numeric.

Please provide a reproducible example.

Roger

> I tried format(layer at data[,4],digits=1) but it didn't work?
>
> Any ideas? Thanks in advance
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
http://depsy.org/person/434412

From milujisb at gmail.com  Tue Jul 26 18:19:45 2016
From: milujisb at gmail.com (Miluji Sb)
Date: Tue, 26 Jul 2016 18:19:45 +0200
Subject: [R-sig-Geo] Country names from coordinates
In-Reply-To: <alpine.LFD.2.20.1607252035030.18559@reclus.nhh.no>
References: <CAMLwc7MSr9n-hQpqY4txLUEqzi9hUy_9vdSbFKPykkeLcwYJ+Q@mail.gmail.com>
	<d74585c0-f210-0b58-1bde-430fb59bae9d@mbacou.com>
	<alpine.LFD.2.20.1607252035030.18559@reclus.nhh.no>
Message-ID: <CAMLwc7O=hP93GGxTnXYv0F=Ds-AYuMCpmjLyJomX_-wmFn8mFA@mail.gmail.com>

Dear Melanie,

Your solution works great! Thank you so much.

Dear Roger,

While this solution also works, I get the following error:  "error code 19
from server: the hourly limit of 2000 credits for milu has been exceeded.
Please throttle your requests or use the commercial service".

It seems there's a limit to the amount of requests to the packages. Thank
you though!

Is there a way to plot the data for a particular country (e.g. Germany) by
latitude and longitude?

temp <- dput(head(ptsDF,10))
structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
-67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
-54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
-53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
c("longitude",
"latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
82L, 95L, 108L, 121L), class = "data.frame")

I have tried the following but doesn't work. Thanks again

pts_germany <- pts[(pts$country=="Germany"),]

mapCountryData(deu, nameColumnToPlot= "GDP", mapRegion="Germany",
catMethod="fixedWidth")

On Mon, Jul 25, 2016 at 8:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Mon, 25 Jul 2016, Bacou, Melanie wrote:
>
> Here is an approach using raster::extract(). I assume your point locations
>> are unprojected.
>>
>
> Offline, OK, but online you may use the geonames package, which requires a
> valid geonames user name:
>
> library(geonames)
> options(geonamesUsername="<me>")
> res <- vector(mode="list", length=nrow(ptsDF))
> for (i in 1:nrow(ptsDF)) res[[i]] <- try(GNcountryCode(ptsDF$latitude[i],
>  ptsDF$longitude[i], radius=50))
> res
>
> using radius= to catch a slightly offshore point in Chile in the example.
>
> Roger
>
>
>
>> library(raster)
>> library(tmap)
>>
>> data(World)
>> proj4string(World)
>> # [1] "+proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
>> +units=m +no_defs +towgs84=0,0,0"
>>
>> pts <- SpatialPointsDataFrame(temp [, c(1,2)], temp,
>> proj4string=CRS("+init=epsg:4326"))
>> # Reproject World
>> World <- spTransform(World, CRS("+init=epsg:4326"))
>> # Extract and append World attributes at pts point locations
>> pts <- extract(World, pts, sp=TRUE)
>>
>> --Mel.
>>
>>
>> On 7/25/2016 9:01 AM, Miluji Sb wrote:
>>
>>>  I have the following data at 0.5 degree by 0.5 degree.
>>>
>>>  temp <- dput(head(ptsDF,10))
>>>  structure(list(longitude = c(-68.25, -67.75, -67.25, -68.25,
>>>  -67.75, -67.25, -71.25, -70.75, -69.25, -68.75), latitude = c(-54.75,
>>>  -54.75, -54.75, -54.25, -54.25, -54.25, -53.75, -53.75, -53.75,
>>>  -53.75), GDP = c(1.683046, 0.3212307, 0.0486207, 0.1223268, 0.0171909,
>>>  0.0062104, 0.22379, 0.1406729, 0.0030038, 0.0057422)), .Names =
>>>  c("longitude",
>>>  "latitude", "GDP"), row.names = c(4L, 17L, 30L, 43L, 56L, 69L,
>>>  82L, 95L, 108L, 121L), class = "data.frame")
>>>
>>>  I would like add the corresponding country names to each of the
>>>  coordinates. This is what I have done:
>>>
>>>  library(data.table)
>>>  library(rgdal)
>>>  library(reshape2)
>>>  library(dplyr)
>>>  library(tidyr)
>>>  library(lubridate)
>>>  library(maps)
>>>  library(countrycode)
>>>  library(ggplot2)
>>>  library(raster)
>>>
>>>  coord_cells <-temp [,c(1,2)]
>>>  pts_cells <-
>>>  SpatialPoints(coord_cells,proj4string=CRS(proj4string(worldmap)))
>>>  indices_cells <- over(pts_cells, worldmap,na.rm=TRUE)
>>>  foo_cells<-indices_cells[,c(3,5)] # Keep ISO3 and country names only
>>>  new_data <- cbind(foo_cells, temp)
>>>
>>>  However, I get a large number of NAs for coordinates which should have
>>>  corresponding countries. What am I doing wrong? Any suggestions? Thank
>>>  you.
>>>
>>>  Sincerely,
>>>
>>>  Milu
>>>
>>>   [[alternative HTML version deleted]]
>>>
>>>  _______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> http://depsy.org/person/434412
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From nickeubank at gmail.com  Tue Jul 26 19:46:12 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Tue, 26 Jul 2016 17:46:12 +0000
Subject: [R-sig-Geo] Isotropic edge correction unbiasedness
Message-ID: <CAFWQgOnyGFREv-u1gYQ+0C=i9XnARMAm0hRpeE8XnAo8BNuJKQ@mail.gmail.com>

Hi All,


Using `kest` to estimate a ripley's K for a country. The authors of the
package suggest isotropic is best when computationally tractable for
irregular shapes, but I noticed in Ripley (1988) that this correction is
only "unbiased provided E is convex", where E is the boundaries of study.

With that said, the picture in Ripley (1988) illustrating this correction
is NOT convex (it's a kidney shape).

I know this isn't quite an "r-implementation" question, but: anyone know if
isotropic correction is unbiased for an odd shape like a country-outline
(in this case Sweden)? Or should i use the `border` correction?

Thanks!

Nick

	[[alternative HTML version deleted]]


From nickeubank at gmail.com  Tue Jul 26 20:37:22 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Tue, 26 Jul 2016 18:37:22 +0000
Subject: [R-sig-Geo] `kest` radius limits?
Message-ID: <CAFWQgOnSWYbDZ+OPytBJRMU1Noi82iZktrBmQBn=SEb1bs_XvQ@mail.gmail.com>

I'm running kest on points in Sweden (which is about 200km wide at its
narrowest) with 'border' correction and lots and lots of points.

However, I can't get estimates of K(r) for radii beyond ~160km. I bumped
`rmax`, and if I plot my results, the null model line extends  to the
`rmax` value, but the K(r) estimates just stop at ~160km.

The K(r) values aren't exploding so it's not an overflow problem, and given
the height of the country (~1,400km) there should be plenty of points to
catch.

Any suggestions for why this might occur would be appreciated. And sorry
for the double inquiries in short order.

Thanks!

Nick

	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Wed Jul 27 00:47:20 2016
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Wed, 27 Jul 2016 00:47:20 +0200
Subject: [R-sig-Geo] Global gridded soil data (https://SoilGrids.org)
Message-ID: <e2656eeb-cdd2-e8d9-2e3d-948785b27609@gmail.com>

For those of you that need soil data for your modeling / analytics,

This is to inform you that we have recently done a major update of our 
SoilGrids system (https://soilgrids.org). The new predictions are now 
available at 250 m globally for 7 standard depths (0, 5, 15, 30, 60, 
100, 200 cm). We distribute predictions of standard chemical (soil pH, 
organic carbon, CEC) and physical soil properties (texture fractions, 
bulk density, coarse fragments, depth to bedrock) but also predictions 
of soil classes (USDA and WRB classification systems). These data are 
distributed under the Open Data Base License (i.e. the same license used 
by OpenStreetMap).

You can download the data directly via FTP 
(ftp://ftp.soilgrids.org/data/recent/) or by using the Web Coverage 
Service (http://webservices.isric.org/geoserver/wcs). I wrote a short 
tutorial that explains how to grab blocks of data using GDAL WCS driver 
(http://gsif.isric.org/doku.php?id=wiki:tutorial_soilgrids#wcs_data_access). 
Let me know if you are aware of any 'easier' way to subset and resample 
SoilGrids via WCS.

SoilGrids are also available via REST API (http://rest.soilgrids.org) 
hence at point locations you can fetch majority of values by using GSIF 
package (http://gsif.r-forge.r-project.org/REST.SoilGrids.html). Please 
try not to use this function to fetch values for large number of points 
as this can become very time consuming (the average response time per 
point is about 0.6 sec).

I would also like to mention that this project was fully implemented in 
R / OSGeo software (which on the end worked out very smoothly even 
though we had to crunch terrabytes of remote sensing data). We are 
really grateful to all creators of packages we have used, especially to 
the authors of the ranger, xgboost, snowfall, caret, raster and rgdal 
packages and SAGA GIS and GDAL, which are the backbone of the spatial 
prediction system. I could spend a lifetime thanking the package authors 
for sharing their talent and creations with us.

PS: We have a separate mailing list for SoilGrids 
(https://groups.google.com/forum/#!forum/global-soil-information) mainly 
used by soil scientists / soil data experts, but if it is a generic 
spatial analysis problem, then I will do my best to answer it via 
R-sig-geo.

cheers,

T. Hengl


From adrian.baddeley at curtin.edu.au  Wed Jul 27 12:25:04 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Wed, 27 Jul 2016 10:25:04 +0000
Subject: [R-sig-Geo] Isotropic edge correction unbiasedness
In-Reply-To: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
Message-ID: <HK2PR02MB1362270257F94C7BC933FEF0A40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>

Nick Eubank writes:


> Using `kest` to estimate a ripley's K for a country.

This is a question about the 'spatstat' package.
The function name is 'Kest'.

> The authors of the package suggest isotropic is best when computationally tractable for
> irregular shapes, but I noticed in Ripley (1988) that this correction is
> only "unbiased provided E is convex", where E is the boundaries of study.

This is covered at length in Chapter 7 of the 'spatstat book'
<https://www.crcpress.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200

The isotropic corrected estimate is unbiased for all r < R, where R is the radius of the smallest circle that encloses the entire window (assuming the window is connected).

> With that said, the picture in Ripley (1988) illustrating this correction
> is NOT convex (it's a kidney shape).

So the statement above applies to this window.

> I know this isn't quite an "r-implementation" question, but: anyone know if
> isotropic correction is unbiased for an odd shape like a country-outline
> (in this case Sweden)? Or should i use the `border` correction?

Use the isotropic correction.

Adrian Baddeley




	[[alternative HTML version deleted]]


From adrian.baddeley at curtin.edu.au  Wed Jul 27 12:36:42 2016
From: adrian.baddeley at curtin.edu.au (Adrian Baddeley)
Date: Wed, 27 Jul 2016 10:36:42 +0000
Subject: [R-sig-Geo] `kest` radius limits?
In-Reply-To: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
Message-ID: <HK2PR02MB136202541798CD17D4681E2AA40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>

Nick Eubank writes:

> I'm running kest on points in Sweden (which is about 200km wide at its
> narrowest) with 'border' correction and lots and lots of points.

> However, I can't get estimates of K(r) for radii beyond ~160km. I bumped
> `rmax`, and if I plot my results, the null model line extends  to the
> `rmax` value, but the K(r) estimates just stop at ~160km.

For the border correction, the estimate of K(r) becomes NA (and is not plotted) as soon as there are no data points that lie more than 'r' units away from the boundary. If the maximum distance from any data point to the boundary of Sweden is 160 km, then this is the behaviour I would expect.

All explained in chapter 7 of the spatstat book.

If you print a summary function object, the output shows the "recommended range" of distance values and the full "available range". By default, the plots of summary functions use the "recommended range" of distance values rather than the full "available range". To override this, when you plot the summary function, use 'xlim' to control the range of 'r' values. (xlim should be an argument in the 'plot' call).

Adrian Baddeley



	[[alternative HTML version deleted]]


From isaquedanielre at hotmail.com  Wed Jul 27 13:48:04 2016
From: isaquedanielre at hotmail.com (Isaque Daniel)
Date: Wed, 27 Jul 2016 11:48:04 +0000
Subject: [R-sig-Geo] Global gridded soil data (https://SoilGrids.org)
In-Reply-To: <e2656eeb-cdd2-e8d9-2e3d-948785b27609@gmail.com>
References: <e2656eeb-cdd2-e8d9-2e3d-948785b27609@gmail.com>
Message-ID: <SN2PR20MB078413CFE2D0A1AD14D2311CC90F0@SN2PR20MB0784.namprd20.prod.outlook.com>

Incredible job T. Hengl!!!

What data you use for South America?
There are some documentation about the generation of data?

Thanks in advance
Isaque


------------------------------------------------------------------------------------------------------------------
Eng. Agr. Isaque Daniel Rocha Eberhardt
Mestre em Sensoriamento Remoto - Instituto Nacional de Pesquisas Espaciais (INPE)
Doutorando em Transportes - Universidade de Bras??lia (UNB)
Mobile: +55 (061) 99015658
------------------------------------------------------------------------------------------------------------------
Agronomist engineer
Master in Remote Sensing - National  Institute for Space Research (INPE) - Brazil
PHD Student in Transport - Bras??lia University (UNB)


________________________________
De: R-sig-Geo <r-sig-geo-bounces at r-project.org> em nome de Tomislav Hengl <tom.hengl at gmail.com>
Enviado: ter?a-feira, 26 de julho de 2016 22:47
Para: r-sig-geo at r-project.org
Assunto: [R-sig-Geo] Global gridded soil data (https://SoilGrids.org)

For those of you that need soil data for your modeling / analytics,

This is to inform you that we have recently done a major update of our
SoilGrids system (https://soilgrids.org). The new predictions are now
SoilGrids | ISRIC<https://soilgrids.org/>
soilgrids.org
SoilGrids: global gridded soil information ... We use cookies to customize user experience and collect usage data. By using this app you agree to our use of cookies ...


available at 250 m globally for 7 standard depths (0, 5, 15, 30, 60,
100, 200 cm). We distribute predictions of standard chemical (soil pH,
organic carbon, CEC) and physical soil properties (texture fractions,
bulk density, coarse fragments, depth to bedrock) but also predictions
of soil classes (USDA and WRB classification systems). These data are
distributed under the Open Data Base License (i.e. the same license used
by OpenStreetMap).

You can download the data directly via FTP
(ftp://ftp.soilgrids.org/data/recent/) or by using the Web Coverage
Service (http://webservices.isric.org/geoserver/wcs). I wrote a short
tutorial that explains how to grab blocks of data using GDAL WCS driver
(http://gsif.isric.org/doku.php?id=wiki:tutorial_soilgrids#wcs_data_access).
Let me know if you are aware of any 'easier' way to subset and resample
SoilGrids via WCS.

SoilGrids are also available via REST API (http://rest.soilgrids.org)
hence at point locations you can fetch majority of values by using GSIF
package (http://gsif.r-forge.r-project.org/REST.SoilGrids.html). Please
try not to use this function to fetch values for large number of points
as this can become very time consuming (the average response time per
point is about 0.6 sec).

I would also like to mention that this project was fully implemented in
R / OSGeo software (which on the end worked out very smoothly even
though we had to crunch terrabytes of remote sensing data). We are
really grateful to all creators of packages we have used, especially to
the authors of the ranger, xgboost, snowfall, caret, raster and rgdal
packages and SAGA GIS and GDAL, which are the backbone of the spatial
prediction system. I could spend a lifetime thanking the package authors
for sharing their talent and creations with us.

PS: We have a separate mailing list for SoilGrids
(https://groups.google.com/forum/#!forum/global-soil-information) mainly
used by soil scientists / soil data experts, but if it is a generic
spatial analysis problem, then I will do my best to answer it via
R-sig-geo.

cheers,

T. Hengl

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From Guy.Bayegnak at gov.ab.ca  Wed Jul 27 19:48:43 2016
From: Guy.Bayegnak at gov.ab.ca (Guy Bayegnak)
Date: Wed, 27 Jul 2016 17:48:43 +0000
Subject: [R-sig-Geo] dclf.test output.
Message-ID: <71D4D04D426B3B488D6C7FE26376FDE72AD95DA9@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>

Hi all,
I have some marked spatial points and I am trying to assess the relative association between different types of points using the  Diggle-Cressie-Loosmore-Ford test of CSR.
My observations are of 4 categories (A,B,C,D) and I am trying to assess 3 categories (A,B,C,) against one  (D), and I get the output provided below. Knowing the sampling  area, I know category "D" and category "B" tend to occur all across the sampling area.
What I am trying to prove is that category  "A" and "C" tend to be clustered around "D".  But  u values I am getting are all positive, and the p-value are all 0.01. However, the dclf.test between A-D and C-D returns a u value at least 3 times as large than that of B-D.
My question is: how do I interpret these values. Does it still show  clustering of A and C relative to D?  if yes how do I interpret the output of dclf.test between B and D?
Thanks,
GAB



Diggle-Cressie-Loosmore-Ford test of CSR
        Monte Carlo test based on 99 simulations
        Summary function: Kcross["A", "D"](r)
        Reference function: theoretical
        Alternative: two.sided
        Interval of distance values: [0, 1.05769125]
        Test statistic: Integral of squared absolute deviation
        Deviation = observed minus theoretical

data:  Data.ppp
u = 54.931, rank = 1, p-value = 0.01

Diggle-Cressie-Loosmore-Ford test of CSR
        Monte Carlo test based on 99 simulations
        Summary function: Kcross["B", "D"](r)
        Reference function: theoretical
        Alternative: two.sided
        Interval of distance values: [0, 1.05769125]
        Test statistic: Integral of squared absolute deviation
        Deviation = observed minus theoretical

data:  Data.ppp
u = 19.315, rank = 1, p-value = 0.01

Diggle-Cressie-Loosmore-Ford test of CSR
        Monte Carlo test based on 99 simulations
        Summary function: Kcross["C", "D"](r)
        Reference function: theoretical
        Alternative: two.sided
        Interval of distance values: [0, 1.05769125]
        Test statistic: Integral of squared absolute deviation
        Deviation = observed minus theoretical

data:  Data.ppp
u = 46.829, rank = 1, p-value = 0.01





This email and any files transmitted with it are confide...{{dropped:7}}


From nickeubank at gmail.com  Wed Jul 27 19:58:26 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Wed, 27 Jul 2016 17:58:26 +0000
Subject: [R-sig-Geo] Isotropic edge correction unbiasedness
In-Reply-To: <HK2PR02MB1362270257F94C7BC933FEF0A40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
	<HK2PR02MB1362270257F94C7BC933FEF0A40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
Message-ID: <CAFWQgOkKiYa6j4tdNNbKmLRyoJGVCiLLPWorb_ByHn4t3onupA@mail.gmail.com>

Great, thanks so much for taking the time to answer this Adrian! And for
the book link!

On Wed, Jul 27, 2016 at 3:25 AM Adrian Baddeley <
adrian.baddeley at curtin.edu.au> wrote:

> Nick Eubank writes:
>
>
> > Using `kest` to estimate a ripley's K for a country.
>
> This is a question about the 'spatstat' package.
> The function name is 'Kest'.
>
> > The authors of the package suggest isotropic is best when
> computationally tractable for
> > irregular shapes, but I noticed in Ripley (1988) that this correction is
> > only "unbiased provided E is convex", where E is the boundaries of study.
>
> This is covered at length in Chapter 7 of the 'spatstat book'
> <
> https://www.crcpress.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200
>
> The isotropic corrected estimate is unbiased for all r < R, where R is the
> radius of the smallest circle that encloses the entire window (assuming the
> window is connected).
>
> > With that said, the picture in Ripley (1988) illustrating this correction
> > is NOT convex (it's a kidney shape).
>
> So the statement above applies to this window.
>
> > I know this isn't quite an "r-implementation" question, but: anyone know
> if
> > isotropic correction is unbiased for an odd shape like a country-outline
> > (in this case Sweden)? Or should i use the `border` correction?
>
> Use the isotropic correction.
>
>
> Adrian Baddeley
>
>
>
>

	[[alternative HTML version deleted]]


From nickeubank at gmail.com  Wed Jul 27 20:10:32 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Wed, 27 Jul 2016 18:10:32 +0000
Subject: [R-sig-Geo] `kest` radius limits?
In-Reply-To: <HK2PR02MB136202541798CD17D4681E2AA40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
	<HK2PR02MB136202541798CD17D4681E2AA40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
Message-ID: <CAFWQgOkd3HoSAkHiUzeckCJ9aA8C_KW2=P8RSZUj0+5BFHFfeg@mail.gmail.com>

Thanks Adrian. I think my confusion is that there are lots of points that
are more than r units away.

Sweden is basically a tall, thin rectangle. It's ~260km wide at its
narrowest point, but it's 1400km tall. And my point density is pretty high,
so for any point, there are lots of other points at more than 160km (just
not in all directions). In other words, the maximum distance from any point
to the boundary is NOT 160km. Thus my confusion.

Also, I've been overriding the `xlim` too -- the x-axis of the plot window
runs all the way to the value I want (300km), and the null poisson model
runs to 300km, it's just the estimates of k(r) that stop.

I don't think I can send pics to the r-geos list, but I'll email the image
to you.

(Ordered your book, btw)



On Wed, Jul 27, 2016 at 3:36 AM Adrian Baddeley <
adrian.baddeley at curtin.edu.au> wrote:

> Nick Eubank writes:
>
> > I'm running kest on points in Sweden (which is about 200km wide at its
> > narrowest) with 'border' correction and lots and lots of points.
>
> > However, I can't get estimates of K(r) for radii beyond ~160km. I bumped
> > `rmax`, and if I plot my results, the null model line extends  to the
> > `rmax` value, but the K(r) estimates just stop at ~160km.
>
> For the border correction, the estimate of K(r) becomes NA (and is not
> plotted) as soon as there are no data points that lie more than 'r' units
> away from the boundary. If the maximum distance from any data point to the
> boundary of Sweden is 160 km, then this is the behaviour I would expect.
>
> All explained in chapter 7 of the spatstat book.
>
> If you print a summary function object, the output shows the "recommended
> range" of distance values and the full "available range". By default, the
> plots of summary functions use the "recommended range" of distance values
> rather than the full "available range". To override this, when you plot the
> summary function, use 'xlim' to control the range of 'r' values. (xlim
> should be an argument in the 'plot' call).
>
> Adrian Baddeley
>
>
>

	[[alternative HTML version deleted]]


From nickeubank at gmail.com  Wed Jul 27 21:30:06 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Wed, 27 Jul 2016 19:30:06 +0000
Subject: [R-sig-Geo] `kest` radius limits?
In-Reply-To: <CAFWQgOkd3HoSAkHiUzeckCJ9aA8C_KW2=P8RSZUj0+5BFHFfeg@mail.gmail.com>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
	<HK2PR02MB136202541798CD17D4681E2AA40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
	<CAFWQgOkd3HoSAkHiUzeckCJ9aA8C_KW2=P8RSZUj0+5BFHFfeg@mail.gmail.com>
Message-ID: <CAFWQgOko2+JKi95fLZbiGwVeoXdF021ecQYmSisDDy=YWfDmhA@mail.gmail.com>

OH! I apologize. Just got the copy of your ebook and now I understand -- I
had mis-understood the nature of the border correction. Squared away now.
Thanks again!

On Wed, Jul 27, 2016 at 11:10 AM Nick Eubank <nickeubank at gmail.com> wrote:

> Thanks Adrian. I think my confusion is that there are lots of points that
> are more than r units away.
>
> Sweden is basically a tall, thin rectangle. It's ~260km wide at its
> narrowest point, but it's 1400km tall. And my point density is pretty high,
> so for any point, there are lots of other points at more than 160km (just
> not in all directions). In other words, the maximum distance from any
> point to the boundary is NOT 160km. Thus my confusion.
>
> Also, I've been overriding the `xlim` too -- the x-axis of the plot window
> runs all the way to the value I want (300km), and the null poisson model
> runs to 300km, it's just the estimates of k(r) that stop.
>
> I don't think I can send pics to the r-geos list, but I'll email the image
> to you.
>
> (Ordered your book, btw)
>
>
>
> On Wed, Jul 27, 2016 at 3:36 AM Adrian Baddeley <
> adrian.baddeley at curtin.edu.au> wrote:
>
>> Nick Eubank writes:
>>
>> > I'm running kest on points in Sweden (which is about 200km wide at its
>> > narrowest) with 'border' correction and lots and lots of points.
>>
>> > However, I can't get estimates of K(r) for radii beyond ~160km. I bumped
>> > `rmax`, and if I plot my results, the null model line extends  to the
>> > `rmax` value, but the K(r) estimates just stop at ~160km.
>>
>> For the border correction, the estimate of K(r) becomes NA (and is not
>> plotted) as soon as there are no data points that lie more than 'r' units
>> away from the boundary. If the maximum distance from any data point to the
>> boundary of Sweden is 160 km, then this is the behaviour I would expect.
>>
>> All explained in chapter 7 of the spatstat book.
>>
>> If you print a summary function object, the output shows the "recommended
>> range" of distance values and the full "available range". By default,
>> the plots of summary functions use the "recommended range" of distance
>> values rather than the full "available range". To override this, when you
>> plot the summary function, use 'xlim' to control the range of 'r' values.
>> (xlim should be an argument in the 'plot' call).
>>
>> Adrian Baddeley
>>
>>
>>

	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Wed Jul 27 23:47:39 2016
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 28 Jul 2016 09:47:39 +1200
Subject: [R-sig-Geo] dclf.test output.
In-Reply-To: <71D4D04D426B3B488D6C7FE26376FDE72AD95DA9@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
References: <71D4D04D426B3B488D6C7FE26376FDE72AD95DA9@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
Message-ID: <f6e3a2c2-e1cd-9407-25c8-542210689672@auckland.ac.nz>


I gather that your problem is that you expect to reject the null 
hypothesis of "no clustering" for A vs. D and for C vs. D, but *not* to 
reject it for B vs. D.

I *think* that your problem might be the fact that you are using a 
two-sided test, which gives, roughly speaking, a test of "no 
association" rather than a test of "no clustering".  It could be the 
case that points of types B and D tend to *avoid* each other, so you get 
"significant" association between B and D, although the B points do the 
opposite of clustering around D points.

It's hard to tell for sure without a *reproducible example* (!!!).  We 
don't have access to Data.ppp.

Try using alternative="greater" in your call to dclf.test() and see if 
the results are more in keeping with your expectations.

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

On 28/07/16 05:48, Guy Bayegnak wrote:

> Hi all, I have some marked spatial points and I am trying to assess
> therelative association between different types of points using the
> Diggle-Cressie-Loosmore-Ford test of CSR.
> My observations are of 4 categories (A,B,C,D) and I am trying to
> assess 3 categories (A,B,C,) against one (D), and I get the output
> provided below. Knowing the sampling area, I know category "D" and
> category "B" tend to occur all across the sampling area.
> What I am trying to prove is that category "A" and "C" tend to be
> clustered around "D". But u values I am getting are all positive, and
> the p-value are all 0.01. However, the dclf.test between A-D and C-D
> returns a u value at least 3 times as large than that of B-D.
> My question is: how do I interpret these values. Does it still show
> clustering of A and C relative to D? if yes how do I interpret the
> output of dclf.test between B and D?
> Thanks, GAB
>
>
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["A", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 54.931, rank = 1, p-value = 0.01
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["B", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 19.315, rank = 1, p-value = 0.01
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["C", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 46.829, rank = 1, p-value = 0.01


From Guy.Bayegnak at gov.ab.ca  Thu Jul 28 00:59:23 2016
From: Guy.Bayegnak at gov.ab.ca (Guy Bayegnak)
Date: Wed, 27 Jul 2016 22:59:23 +0000
Subject: [R-sig-Geo] dclf.test output.
In-Reply-To: <f6e3a2c2-e1cd-9407-25c8-542210689672@auckland.ac.nz>
References: <71D4D04D426B3B488D6C7FE26376FDE72AD95DA9@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
	<f6e3a2c2-e1cd-9407-25c8-542210689672@auckland.ac.nz>
Message-ID: <71D4D04D426B3B488D6C7FE26376FDE72AD9615A@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>

Thanks for your response Rolf,
You summarized it correctly.  However, B and D do not necessarily avoid each other. They could and do in fact occur next to each other at times just by coincidence, simply because both categories tend to occur all over the place, while I think A and C are influenced by D. I included the alternative="greater" but I still get the same results.
A sample of my data is provided below( I have more than 800 points).

Longitude        Latitude               Type
1 -113.1923      51.02913       C
2 -113.2013      52.83306       A
3 -113.6834     51.06585        A
4 -113.0295      50.97140       C
5 -113.2366      50.96440       A
6 -113.5849      51.37568       A
7 -113.6877      51.09027       D
8 -113.5371      51.82780       D

 I used the following code and got the results provided earlier:


dclf.test(Data.ppp,Kcross, i = "A", j = "D", alternative="greater" ,correction = "border")
dclf.test(Data.ppp,Kcross, i = "B", j = "D", alternative="greater" ,correction = "border")
dclf.test(Data.ppp,Kcross, i = "C", j = "D", alternative="greater" ,correction = "border")




Thanks,
GAB

-----Original Message-----
From: Rolf Turner [mailto:r.turner at auckland.ac.nz]
Sent: Wednesday, July 27, 2016 3:48 PM
To: Guy Bayegnak
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] dclf.test output.


I gather that your problem is that you expect to reject the null hypothesis of "no clustering" for A vs. D and for C vs. D, but *not* to reject it for B vs. D.

I *think* that your problem might be the fact that you are using a two-sided test, which gives, roughly speaking, a test of "no association" rather than a test of "no clustering".  It could be the case that points of types B and D tend to *avoid* each other, so you get "significant" association between B and D, although the B points do the opposite of clustering around D points.

It's hard to tell for sure without a *reproducible example* (!!!).  We don't have access to Data.ppp.

Try using alternative="greater" in your call to dclf.test() and see if the results are more in keeping with your expectations.

cheers,

Rolf Turner

--
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

On 28/07/16 05:48, Guy Bayegnak wrote:

> Hi all, I have some marked spatial points and I am trying to assess
> therelative association between different types of points using the
> Diggle-Cressie-Loosmore-Ford test of CSR.
> My observations are of 4 categories (A,B,C,D) and I am trying to
> assess 3 categories (A,B,C,) against one (D), and I get the output
> provided below. Knowing the sampling area, I know category "D" and
> category "B" tend to occur all across the sampling area.
> What I am trying to prove is that category "A" and "C" tend to be
> clustered around "D". But u values I am getting are all positive, and
> the p-value are all 0.01. However, the dclf.test between A-D and C-D
> returns a u value at least 3 times as large than that of B-D.
> My question is: how do I interpret these values. Does it still show
> clustering of A and C relative to D? if yes how do I interpret the
> output of dclf.test between B and D?
> Thanks, GAB
>
>
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["A", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 54.931, rank = 1, p-value = 0.01
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["B", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 19.315, rank = 1, p-value = 0.01
>
> Diggle-Cressie-Loosmore-Ford test of CSR
>         Monte Carlo test based on 99 simulations
>         Summary function: Kcross["C", "D"](r)
>         Reference function: theoretical
>         Alternative: two.sided
>         Interval of distance values: [0, 1.05769125]
>         Test statistic: Integral of squared absolute deviation
>         Deviation = observed minus theoretical
>
> data:  Data.ppp
> u = 46.829, rank = 1, p-value = 0.01


This email and any files transmitted with it are confide...{{dropped:7}}


From r.turner at auckland.ac.nz  Thu Jul 28 01:49:30 2016
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 28 Jul 2016 11:49:30 +1200
Subject: [R-sig-Geo] dclf.test output.
In-Reply-To: <71D4D04D426B3B488D6C7FE26376FDE72AD9615A@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
References: <71D4D04D426B3B488D6C7FE26376FDE72AD95DA9@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
	<f6e3a2c2-e1cd-9407-25c8-542210689672@auckland.ac.nz>
	<71D4D04D426B3B488D6C7FE26376FDE72AD9615A@EDM-GOA-EXCH122.goa.ds.gov.ab.ca>
Message-ID: <85bf6cbb-6586-3564-bc24-cbea322cf67e@auckland.ac.nz>


(1) It would then appear to be the case that points of types B and D 
*do* tend to cluster together despite your expectations.

(2) What is the appearance of an envelope plot just for the Kcross 
function between B and D?

(3) If these ideas don't clear up the problem, perhaps you could make 
the data set available to me, off-list, and I could have a go at 
exploring the pattern and see if I can understand what's going on.

(4) It is always possible that there is something that I haven't 
properly comprehended in respect of these issues.  In particular I now 
feel a little bit nervous about the fact that as it stands your test is 
based on simulations of patterns that are CSRI (completely spatially 
random with independence of types).  It might be the case that this is 
inappropriate.  I'll have to think about this a bit more.

(5) I am a bit puzzled by the fact that you get "the same results" when 
you use alternative="greater".  Generally a one-sided test should yield
a smaller p-value than a two-sided test when the data are "pointing in 
the direction of the alternative hypothesis".

E.g.:

set.seed(42)
E <- envelope(ants,fun=Kcross,i="Cataglyphis",j="Messor",
               savepatterns=TRUE)
dclf.test(E) # Gives a p-value of 0.7
dclf.test(E,alternative="greater") # gives a p-value of 0.23

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

On 28/07/16 10:59, Guy Bayegnak wrote:
> Thanks for your response Rolf,
> You summarized it correctly.  However, B and D do not necessarily avoid each other. They could and do in fact occur next to each other at times just by coincidence, simply because both categories tend to occur all over the place, while I think A and C are influenced by D. I included the alternative="greater" but I still get the same results.
> A sample of my data is provided below( I have more than 800 points).
>
> Longitude        Latitude               Type
> 1 -113.1923      51.02913       C
> 2 -113.2013      52.83306       A
> 3 -113.6834     51.06585        A
> 4 -113.0295      50.97140       C
> 5 -113.2366      50.96440       A
> 6 -113.5849      51.37568       A
> 7 -113.6877      51.09027       D
> 8 -113.5371      51.82780       D
>
>  I used the following code and got the results provided earlier:
>
>
> dclf.test(Data.ppp,Kcross, i = "A", j = "D", alternative="greater" ,correction = "border")
> dclf.test(Data.ppp,Kcross, i = "B", j = "D", alternative="greater" ,correction = "border")
> dclf.test(Data.ppp,Kcross, i = "C", j = "D", alternative="greater" ,correction = "border")
>
>
>
>
> Thanks,
> GAB
>
> -----Original Message-----
> From: Rolf Turner [mailto:r.turner at auckland.ac.nz]
> Sent: Wednesday, July 27, 2016 3:48 PM
> To: Guy Bayegnak
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] dclf.test output.
>
>
> I gather that your problem is that you expect to reject the null hypothesis of "no clustering" for A vs. D and for C vs. D, but *not* to reject it for B vs. D.
>
> I *think* that your problem might be the fact that you are using a two-sided test, which gives, roughly speaking, a test of "no association" rather than a test of "no clustering".  It could be the case that points of types B and D tend to *avoid* each other, so you get "significant" association between B and D, although the B points do the opposite of clustering around D points.
>
> It's hard to tell for sure without a *reproducible example* (!!!).  We don't have access to Data.ppp.
>
> Try using alternative="greater" in your call to dclf.test() and see if the results are more in keeping with your expectations.
>
> cheers,
>
> Rolf Turner
>
> --
> Technical Editor ANZJS
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> On 28/07/16 05:48, Guy Bayegnak wrote:
>
>> Hi all, I have some marked spatial points and I am trying to assess
>> therelative association between different types of points using the
>> Diggle-Cressie-Loosmore-Ford test of CSR.
>> My observations are of 4 categories (A,B,C,D) and I am trying to
>> assess 3 categories (A,B,C,) against one (D), and I get the output
>> provided below. Knowing the sampling area, I know category "D" and
>> category "B" tend to occur all across the sampling area.
>> What I am trying to prove is that category "A" and "C" tend to be
>> clustered around "D". But u values I am getting are all positive, and
>> the p-value are all 0.01. However, the dclf.test between A-D and C-D
>> returns a u value at least 3 times as large than that of B-D.
>> My question is: how do I interpret these values. Does it still show
>> clustering of A and C relative to D? if yes how do I interpret the
>> output of dclf.test between B and D?
>> Thanks, GAB
>>
>>
>>
>> Diggle-Cressie-Loosmore-Ford test of CSR
>>         Monte Carlo test based on 99 simulations
>>         Summary function: Kcross["A", "D"](r)
>>         Reference function: theoretical
>>         Alternative: two.sided
>>         Interval of distance values: [0, 1.05769125]
>>         Test statistic: Integral of squared absolute deviation
>>         Deviation = observed minus theoretical
>>
>> data:  Data.ppp
>> u = 54.931, rank = 1, p-value = 0.01
>>
>> Diggle-Cressie-Loosmore-Ford test of CSR
>>         Monte Carlo test based on 99 simulations
>>         Summary function: Kcross["B", "D"](r)
>>         Reference function: theoretical
>>         Alternative: two.sided
>>         Interval of distance values: [0, 1.05769125]
>>         Test statistic: Integral of squared absolute deviation
>>         Deviation = observed minus theoretical
>>
>> data:  Data.ppp
>> u = 19.315, rank = 1, p-value = 0.01
>>
>> Diggle-Cressie-Loosmore-Ford test of CSR
>>         Monte Carlo test based on 99 simulations
>>         Summary function: Kcross["C", "D"](r)
>>         Reference function: theoretical
>>         Alternative: two.sided
>>         Interval of distance values: [0, 1.05769125]
>>         Test statistic: Integral of squared absolute deviation
>>         Deviation = observed minus theoretical
>>
>> data:  Data.ppp
>> u = 46.829, rank = 1, p-value = 0.01


From tom.hengl at gmail.com  Thu Jul 28 11:05:00 2016
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Thu, 28 Jul 2016 11:05:00 +0200
Subject: [R-sig-Geo] Global gridded soil data (https://SoilGrids.org)
In-Reply-To: <SN2PR20MB078413CFE2D0A1AD14D2311CC90F0@SN2PR20MB0784.namprd20.prod.outlook.com>
References: <e2656eeb-cdd2-e8d9-2e3d-948785b27609@gmail.com>
	<SN2PR20MB078413CFE2D0A1AD14D2311CC90F0@SN2PR20MB0784.namprd20.prod.outlook.com>
Message-ID: <3a84f614-fb7f-5d8e-487c-37072394cd32@gmail.com>


Isaque,


You can access about 60% of point data used for training via the WoSIS 
Web Feature Service 
(http://www.isric.org/content/wosis-distribution-set) - I think most of 
points available for Latin America are available via this service. We 
are hoping that national government agencies will donate even more point 
data, so that we can gradually improve the maps as in: 
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0105992#pone-0105992-g013


Thank you and BR,


On 27-7-2016 13:48, Isaque Daniel wrote:
>
> Incredible job T. Hengl!!!
>
> What data you use for South America?
> There are some documentation about the generation of data?
>
> Thanks in advance
> Isaque
>
>
> ------------------------------------------------------------------------------------------------------------------
> Eng. Agr. Isaque Daniel Rocha Eberhardt
> Mestre em Sensoriamento Remoto - Instituto Nacional de Pesquisas 
> Espaciais (INPE)
> Doutorando em Transportes - Universidade de Bras??lia (UNB)
> Mobile: +55 (061) 99015658
> ------------------------------------------------------------------------------------------------------------------
> Agronomist engineer
> Master in Remote Sensing - National  Institute for Space Research 
> (INPE) - Brazil
> PHD Student in Transport - Bras??lia University (UNB)
>
>
> ------------------------------------------------------------------------
> *De:* R-sig-Geo <r-sig-geo-bounces at r-project.org> em nome de Tomislav 
> Hengl <tom.hengl at gmail.com>
> *Enviado:* ter?a-feira, 26 de julho de 2016 22:47
> *Para:* r-sig-geo at r-project.org
> *Assunto:* [R-sig-Geo] Global gridded soil data (https://SoilGrids.org)
> For those of you that need soil data for your modeling / analytics,
>
> This is to inform you that we have recently done a major update of our
> SoilGrids system (https://soilgrids.org). The new predictions are now
> SoilGrids | ISRIC <https://soilgrids.org/>
> soilgrids.org
> SoilGrids: global gridded soil information ... We use cookies to 
> customize user experience and collect usage data. By using this app 
> you agree to our use of cookies ...
>
>
> available at 250 m globally for 7 standard depths (0, 5, 15, 30, 60,
> 100, 200 cm). We distribute predictions of standard chemical (soil pH,
> organic carbon, CEC) and physical soil properties (texture fractions,
> bulk density, coarse fragments, depth to bedrock) but also predictions
> of soil classes (USDA and WRB classification systems). These data are
> distributed under the Open Data Base License (i.e. the same license used
> by OpenStreetMap).
>
> You can download the data directly via FTP
> (ftp://ftp.soilgrids.org/data/recent/) or by using the Web Coverage
> Service (http://webservices.isric.org/geoserver/wcs). I wrote a short
> tutorial that explains how to grab blocks of data using GDAL WCS driver
> (http://gsif.isric.org/doku.php?id=wiki:tutorial_soilgrids#wcs_data_access). 
>
> Let me know if you are aware of any 'easier' way to subset and resample
> SoilGrids via WCS.
>
> SoilGrids are also available via REST API (http://rest.soilgrids.org)
> hence at point locations you can fetch majority of values by using GSIF
> package (http://gsif.r-forge.r-project.org/REST.SoilGrids.html). Please
> try not to use this function to fetch values for large number of points
> as this can become very time consuming (the average response time per
> point is about 0.6 sec).
>
> I would also like to mention that this project was fully implemented in
> R / OSGeo software (which on the end worked out very smoothly even
> though we had to crunch terrabytes of remote sensing data). We are
> really grateful to all creators of packages we have used, especially to
> the authors of the ranger, xgboost, snowfall, caret, raster and rgdal
> packages and SAGA GIS and GDAL, which are the backbone of the spatial
> prediction system. I could spend a lifetime thanking the package authors
> for sharing their talent and creations with us.
>
> PS: We have a separate mailing list for SoilGrids
> (https://groups.google.com/forum/#!forum/global-soil-information 
> <https://groups.google.com/forum/#%21forum/global-soil-information>) 
> mainly
> used by soil scientists / soil data experts, but if it is a generic
> spatial analysis problem, then I will do my best to answer it via
> R-sig-geo.
>
> cheers,
>
> T. Hengl
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From nickeubank at gmail.com  Thu Jul 28 20:54:03 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Thu, 28 Jul 2016 18:54:03 +0000
Subject: [R-sig-Geo] Isotropic edge correction unbiasedness
In-Reply-To: <CAFWQgOkKiYa6j4tdNNbKmLRyoJGVCiLLPWorb_ByHn4t3onupA@mail.gmail.com>
References: <mailman.11.1469613603.18304.r-sig-geo@r-project.org>
	<HK2PR02MB1362270257F94C7BC933FEF0A40F0@HK2PR02MB1362.apcprd02.prod.outlook.com>
	<CAFWQgOkKiYa6j4tdNNbKmLRyoJGVCiLLPWorb_ByHn4t3onupA@mail.gmail.com>
Message-ID: <CAFWQgOmv8McSGTTx_1-_6OrABpnfZAygW4XUxAKgwkv1GiL8zQ@mail.gmail.com>

Hi Adrian,

One followup I can't find answered in the book -- is there an analogue to
the isotropic edge correction in kest.fft? Or does it only do border?

Thanks!

Nick

On Wed, Jul 27, 2016 at 10:58 AM Nick Eubank <nickeubank at gmail.com> wrote:

> Great, thanks so much for taking the time to answer this Adrian! And for
> the book link!
>
> On Wed, Jul 27, 2016 at 3:25 AM Adrian Baddeley <
> adrian.baddeley at curtin.edu.au> wrote:
>
>> Nick Eubank writes:
>>
>>
>> > Using `kest` to estimate a ripley's K for a country.
>>
>> This is a question about the 'spatstat' package.
>> The function name is 'Kest'.
>>
>> > The authors of the package suggest isotropic is best when
>> computationally tractable for
>> > irregular shapes, but I noticed in Ripley (1988) that this correction is
>> > only "unbiased provided E is convex", where E is the boundaries of
>> study.
>>
>> This is covered at length in Chapter 7 of the 'spatstat book'
>> <
>> https://www.crcpress.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200
>>
>> The isotropic corrected estimate is unbiased for all r < R, where R is
>> the radius of the smallest circle that encloses the entire window (assuming
>> the window is connected).
>>
>> > With that said, the picture in Ripley (1988) illustrating this
>> correction
>> > is NOT convex (it's a kidney shape).
>>
>> So the statement above applies to this window.
>>
>> > I know this isn't quite an "r-implementation" question, but: anyone
>> know if
>> > isotropic correction is unbiased for an odd shape like a country-outline
>> > (in this case Sweden)? Or should i use the `border` correction?
>>
>> Use the isotropic correction.
>>
>>
>> Adrian Baddeley
>>
>>
>>
>>

	[[alternative HTML version deleted]]


From thi_veloso at yahoo.com.br  Fri Jul 29 04:52:30 2016
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Fri, 29 Jul 2016 02:52:30 +0000 (UTC)
Subject: [R-sig-Geo] Incorrect month order in zApply function
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>

Dear all,

I am using the raster package to calculate monthly averages of climatic variables.

Essentially, this is the function I use:

library(raster)

# Create date sequence
idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")

# Create raster stack and assign dates
r <- raster(ncol=5, nrow=5)
s <- stack(lapply(1:length(idx), function(x) setValues(r, runif(ncell(r)))))
s <- setZ(s, idx)

# Calculate monthly average
x <- zApply(s, by=months, mean, name=month.abb[])

names(x)
[1] "April" "August" "December" "February" "January" "July" "June" 
[8] "March" "May" "November" "October" "September"
getZ(x)
[1] "April" "August" "December" "February" "January" "July" "June" 
[8] "March" "May" "November" "October" "September"


The problem here is the output of both names(x) and getZ(x). It looks like a random month order is returned (even though I provide the labels), which makes me confused about the results.


By performing the same calculation in a different software and comparing the results, I came to realize that the order of months for the results by raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
 
How can I control the way raster delivers the object names after using zApply, in order to sort the months in the "natural" order?

Greetings, -- Thiago V. dos Santos

PhD student
Land and Atmospheric Science
University of Minnesota


From HodgessE at uhd.edu  Fri Jul 29 06:00:57 2016
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 29 Jul 2016 04:00:57 +0000
Subject: [R-sig-Geo] a spatial data set recommendation, please
Message-ID: <FF9DB805FC41CC4E95825A50F6806302B4A854DE@challenger.uhd.campus>

Hello!

Could anyone recommend some good spatial data sets with one or two variables with 5000+ observations, please?

I've been looking, probably not in the right place. Just getting little sets.

Thanks,
Erin


Erin M. Hodgess
Associate Professor
Department of Mathematics and Statistics
University of Houston - Downtown
mailto: hodgesse at uhd.edu

	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Fri Jul 29 09:02:33 2016
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Fri, 29 Jul 2016 09:02:33 +0200
Subject: [R-sig-Geo] a spatial data set recommendation, please
In-Reply-To: <FF9DB805FC41CC4E95825A50F6806302B4A854DE@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F6806302B4A854DE@challenger.uhd.campus>
Message-ID: <3afa5611-8bb9-5718-0f73-465c58d7f7ed@gmail.com>


Hi Erin,

I think you are looking for a point data set that is available under 
some public access license? For which area: global? regional/national? 
local?

One data set I like to use for geostatistical mapping is the National 
Geochemical Survey database (http://mrdata.usgs.gov/geochem/) because it 
is very consistent, multivariate and well documented. Another large 
point data set under public access is the NCSS Soil Characterization 
Database (http://ncsslabdatamart.sc.egov.usda.gov/), but these are only 
USA-available of course.

For global data sets, I would look at for example at the daily meteo 
data from Global Historical Climatology Network 
(https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn), 
which I think is partially available via the meteo package 
(http://www.rdocumentation.org/packages/meteo/versions/0.1-5).

Does it has to be inside a package? I've put in my GSIF package small 
sample of the geochemical DB: 
http://gsif.r-forge.r-project.org/geochm.html but it contains 'only' 
2681 points :(

HTH


On 29-7-2016 6:00, Hodgess, Erin wrote:
> Hello!
>
> Could anyone recommend some good spatial data sets with one or two variables with 5000+ observations, please?
>
> I've been looking, probably not in the right place. Just getting little sets.
>
> Thanks,
> Erin
>
>
> Erin M. Hodgess
> Associate Professor
> Department of Mathematics and Statistics
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tim.appelhans at gmail.com  Fri Jul 29 10:07:47 2016
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 29 Jul 2016 10:07:47 +0200
Subject: [R-sig-Geo] a spatial data set recommendation, please
In-Reply-To: <FF9DB805FC41CC4E95825A50F6806302B4A854DE@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F6806302B4A854DE@challenger.uhd.campus>
Message-ID: <579B0ED3.7000002@gmail.com>

There is ggmap::crime with 80k+ observations. Again, these are point data

On 29.07.2016 06:00, Hodgess, Erin wrote:
> Hello!
>
> Could anyone recommend some good spatial data sets with one or two variables with 5000+ observations, please?
>
> I've been looking, probably not in the right place. Just getting little sets.
>
> Thanks,
> Erin
>
>
> Erin M. Hodgess
> Associate Professor
> Department of Mathematics and Statistics
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
Raum 00A08
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From dosc3612 at colorado.edu  Fri Jul 29 16:52:56 2016
From: dosc3612 at colorado.edu (Dominik Schneider)
Date: Fri, 29 Jul 2016 08:52:56 -0600
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAF1jk_mGs=NAkK0t4NppmV=XaU9ZP7X7tYywPWBX4Hq_LLub1w@mail.gmail.com>

Sorry I'm not sure how to fix this, but it looks like the months are  in
alphanumeric order, indicating they are being treated as a factor. Might be
worth a bug report?



On Thursday, July 28, 2016, Thiago V. dos Santos via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Dear all,
>
> I am using the raster package to calculate monthly averages of climatic
> variables.
>
> Essentially, this is the function I use:
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(lapply(1:length(idx), function(x) setValues(r,
> runif(ncell(r)))))
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> names(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
> getZ(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
>
>
> The problem here is the output of both names(x) and getZ(x). It looks like
> a random month order is returned (even though I provide the labels), which
> makes me confused about the results.
>
>
> By performing the same calculation in a different software and comparing
> the results, I came to realize that the order of months for the results by
> raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>
> How can I control the way raster delivers the object names after using
> zApply, in order to sort the months in the "natural" order?
>
> Greetings, -- Thiago V. dos Santos
>
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Fri Jul 29 17:12:38 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Fri, 29 Jul 2016 11:12:38 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <CAF1jk_mGs=NAkK0t4NppmV=XaU9ZP7X7tYywPWBX4Hq_LLub1w@mail.gmail.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<CAF1jk_mGs=NAkK0t4NppmV=XaU9ZP7X7tYywPWBX4Hq_LLub1w@mail.gmail.com>
Message-ID: <CCB7AB58-1747-414D-9849-E490F7FC2BD1@bigelow.org>

Hi,

Might you simply reorder the stack after zApply()?

> x2 <- x[[month.name]]
> names(x2)
 [1] "January"   "February"  "March"     "April"     "May"       "June"     
 [7] "July"      "August"    "September" "October"   "November"  "December" 

Cheers,
Ben



> On Jul 29, 2016, at 10:52 AM, Dominik Schneider <dosc3612 at colorado.edu> wrote:
> 
> Sorry I'm not sure how to fix this, but it looks like the months are  in
> alphanumeric order, indicating they are being treated as a factor. Might be
> worth a bug report?
> 
> 
> 
> On Thursday, July 28, 2016, Thiago V. dos Santos via R-sig-Geo <
> r-sig-geo at r-project.org> wrote:
> 
>> Dear all,
>> 
>> I am using the raster package to calculate monthly averages of climatic
>> variables.
>> 
>> Essentially, this is the function I use:
>> 
>> library(raster)
>> 
>> # Create date sequence
>> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>> 
>> # Create raster stack and assign dates
>> r <- raster(ncol=5, nrow=5)
>> s <- stack(lapply(1:length(idx), function(x) setValues(r,
>> runif(ncell(r)))))
>> s <- setZ(s, idx)
>> 
>> # Calculate monthly average
>> x <- zApply(s, by=months, mean, name=month.abb[])
>> 
>> names(x)
>> [1] "April" "August" "December" "February" "January" "July" "June"
>> [8] "March" "May" "November" "October" "September"
>> getZ(x)
>> [1] "April" "August" "December" "February" "January" "July" "June"
>> [8] "March" "May" "November" "October" "September"
>> 
>> 
>> The problem here is the output of both names(x) and getZ(x). It looks like
>> a random month order is returned (even though I provide the labels), which
>> makes me confused about the results.
>> 
>> 
>> By performing the same calculation in a different software and comparing
>> the results, I came to realize that the order of months for the results by
>> raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>> 
>> How can I control the way raster delivers the object names after using
>> zApply, in order to sort the months in the "natural" order?
>> 
>> Greetings, -- Thiago V. dos Santos
>> 
>> PhD student
>> Land and Atmospheric Science
>> University of Minnesota
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


From vinhdizzo at gmail.com  Fri Jul 29 17:20:20 2016
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Fri, 29 Jul 2016 08:20:20 -0700
Subject: [R-sig-Geo] Plotting USA map with each state's shape or size
	reflective of a metric
In-Reply-To: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
References: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
Message-ID: <CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>

Hi everyone,

Does anyone know if this is possible with R? An example can be found here:
http://projects.fivethirtyeight.com/2016-election-forecast/ (a few plots
down).

Appreciate any references you point me to. Thanks!

Vinh

	[[alternative HTML version deleted]]


From nickeubank at gmail.com  Fri Jul 29 18:00:56 2016
From: nickeubank at gmail.com (Nick Eubank)
Date: Fri, 29 Jul 2016 16:00:56 +0000
Subject: [R-sig-Geo] Plotting USA map with each state's shape or size
 reflective of a metric
In-Reply-To: <CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>
References: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
	<CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>
Message-ID: <CAFWQgO=PnV70WLOjpR5dAif=R-Lb69do5LAfvRCtLw_MBD=kuw@mail.gmail.com>

Not sure how to do in R (can do in arcgis), but you might find the term
"Cartogram" useful on google -- that's the "term of art" for those maps.

On Fri, Jul 29, 2016 at 8:20 AM Vinh Nguyen <vinhdizzo at gmail.com> wrote:

> Hi everyone,
>
> Does anyone know if this is possible with R? An example can be found here:
> http://projects.fivethirtyeight.com/2016-election-forecast/ (a few plots
> down).
>
> Appreciate any references you point me to. Thanks!
>
> Vinh
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From vijaylulla at gmail.com  Fri Jul 29 19:35:22 2016
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Fri, 29 Jul 2016 13:35:22 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAKkiGbtiAigiwujOhD+CcspccQbzixd3X0tFEshfLFfAD1xTgA@mail.gmail.com>

Maybe like this?

R> m <- function(x) ordered(months(x),labels=month.name)
R> x1 <- zApply(s, by=m, mean, name=month.abb[])
R> names(x1) # Appears to have natural ordering
R> all(x[] == x1[]) # TRUE

I'm not sure how using factors will impact other aspects of your project.
HTH,
Vijay.

On Thu, Jul 28, 2016 at 10:52 PM, Thiago V. dos Santos via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Dear all,
>
> I am using the raster package to calculate monthly averages of climatic
> variables.
>
> Essentially, this is the function I use:
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(lapply(1:length(idx), function(x) setValues(r,
> runif(ncell(r)))))
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> names(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
> getZ(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
>
>
> The problem here is the output of both names(x) and getZ(x). It looks like
> a random month order is returned (even though I provide the labels), which
> makes me confused about the results.
>
>
> By performing the same calculation in a different software and comparing
> the results, I came to realize that the order of months for the results by
> raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>
> How can I control the way raster delivers the object names after using
> zApply, in order to sort the months in the "natural" order?
>
> Greetings, -- Thiago V. dos Santos
>
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From kkilpatrick at rsmas.miami.edu  Fri Jul 29 21:07:45 2016
From: kkilpatrick at rsmas.miami.edu (Kay Kilpatrick)
Date: Fri, 29 Jul 2016 15:07:45 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>

Hi

The various Apply functions always return the output in simple 
alphabetical order when the factor label is a character, regardless of 
the order of the factor in the calling argument.

Ben had a correct solution --- simply reorder the output from Zapply.

Alternatively you could use a numeric representation for the month label 
using by = as.numeric(months(x). The output would then be in increasing 
numeric order from 1 -12.

I do not believe Vijay's suggestion is proper. It does not reorder the 
output --- instead it changes the label of a given monthly mean eg. The 
value for Jan. would then be labeled as Apr.

k

On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
> Dear all,
>
> I am using the raster package to calculate monthly averages of climatic variables.
>
> Essentially, this is the function I use:
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(lapply(1:length(idx), function(x) setValues(r, runif(ncell(r)))))
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> names(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
> getZ(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
>
>
> The problem here is the output of both names(x) and getZ(x). It looks like a random month order is returned (even though I provide the labels), which makes me confused about the results.
>
>
> By performing the same calculation in a different software and comparing the results, I came to realize that the order of months for the results by raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>   
> How can I control the way raster delivers the object names after using zApply, in order to sort the months in the "natural" order?
>
> Greetings, -- Thiago V. dos Santos
>
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=


-- 
Katherine (Kay) Kilpatrick
University of Miami/RSMAS
Ocean Science Department
Satellite Remote Sensing Laboratory
MSC 231
4600 Rickenbacker Cswy
Miami, Fl
ph: 305-962-3069
kkilpatrick at rsmas.miami.edu


From thi_veloso at yahoo.com.br  Fri Jul 29 21:20:24 2016
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Fri, 29 Jul 2016 19:20:24 +0000 (UTC)
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
Message-ID: <1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>

Thanks everyone for their suggestions.

Reordering the output of zApply would be a WRONG solution, because the layers are already ordered from Jan to Dec.

It is just the NAMES that are misaligned, which can cause a bit of confusion.

I already contacted Robert about this issue and we should see a solution soon.
 Greetings,
 -- Thiago V. dos Santos

PhD student
Land and Atmospheric Science
University of Minnesota



On Friday, July 29, 2016 2:09 PM, Kay Kilpatrick <kkilpatrick at rsmas.miami.edu> wrote:
Hi

The various Apply functions always return the output in simple 
alphabetical order when the factor label is a character, regardless of 
the order of the factor in the calling argument.

Ben had a correct solution --- simply reorder the output from Zapply.

Alternatively you could use a numeric representation for the month label 
using by = as.numeric(months(x). The output would then be in increasing 
numeric order from 1 -12.

I do not believe Vijay's suggestion is proper. It does not reorder the 
output --- instead it changes the label of a given monthly mean eg. The 
value for Jan. would then be labeled as Apr.

k

On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
> Dear all,
>
> I am using the raster package to calculate monthly averages of climatic variables.
>
> Essentially, this is the function I use:
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(lapply(1:length(idx), function(x) setValues(r, runif(ncell(r)))))
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> names(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
> getZ(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
>
>
> The problem here is the output of both names(x) and getZ(x). It looks like a random month order is returned (even though I provide the labels), which makes me confused about the results.
>
>
> By performing the same calculation in a different software and comparing the results, I came to realize that the order of months for the results by raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>  
> How can I control the way raster delivers the object names after using zApply, in order to sort the months in the "natural" order?
>
> Greetings, -- Thiago V. dos Santos
>
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=


-- 
Katherine (Kay) Kilpatrick
University of Miami/RSMAS
Ocean Science Department
Satellite Remote Sensing Laboratory
MSC 231
4600 Rickenbacker Cswy
Miami, Fl
ph: 305-962-3069
kkilpatrick at rsmas.miami.edu


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From englishchristophera at gmail.com  Sat Jul 30 00:35:46 2016
From: englishchristophera at gmail.com (chris english)
Date: Sat, 30 Jul 2016 01:35:46 +0300
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <CAASFQpSh6PHJHGbhQEjk9=U8R9ix3vSRpOGO72J+Ryc8gLtnsQ@mail.gmail.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
	<1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>
	<CAASFQpSh6PHJHGbhQEjk9=U8R9ix3vSRpOGO72J+Ryc8gLtnsQ@mail.gmail.com>
Message-ID: <CAASFQpSsZYUHC0OGy0=6Ar_RieWwLhYvHbztHM-HQ+y031j+EA@mail.gmail.com>

Thiago,

I understand you're in discussion with Robert about code changes; but,
absent these, why wouldn't Ben's solution be sufficient, assuming the code
change might simply issue a warning that the names output will be
alphanumeric and a second step might be required to conform for
presentation or analytical purposes. Just wondering. Thanks.
Chris

On Jul 29, 2016 22:20, "Thiago V. dos Santos via R-sig-Geo" <
r-sig-geo at r-project.org> wrote:

Thanks everyone for their suggestions.

Reordering the output of zApply would be a WRONG solution, because the
layers are already ordered from Jan to Dec.

It is just the NAMES that are misaligned, which can cause a bit of
confusion.

I already contacted Robert about this issue and we should see a solution
soon.
 Greetings,
 -- Thiago V. dos Santos

PhD student
Land and Atmospheric Science
University of Minnesota



On Friday, July 29, 2016 2:09 PM, Kay Kilpatrick <
kkilpatrick at rsmas.miami.edu> wrote:
Hi

The various Apply functions always return the output in simple
alphabetical order when the factor label is a character, regardless of
the order of the factor in the calling argument.

Ben had a correct solution --- simply reorder the output from Zapply.

Alternatively you could use a numeric representation for the month label
using by = as.numeric(months(x). The output would then be in increasing
numeric order from 1 -12.

I do not believe Vijay's suggestion is proper. It does not reorder the
output --- instead it changes the label of a given monthly mean eg. The
value for Jan. would then be labeled as Apr.

k

On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
> Dear all,
>
> I am using the raster package to calculate monthly averages of climatic
variables.
>
> Essentially, this is the function I use:
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(lapply(1:length(idx), function(x) setValues(r,
runif(ncell(r)))))
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> names(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
> getZ(x)
> [1] "April" "August" "December" "February" "January" "July" "June"
> [8] "March" "May" "November" "October" "September"
>
>
> The problem here is the output of both names(x) and getZ(x). It looks
like a random month order is returned (even though I provide the labels),
which makes me confused about the results.
>
>
> By performing the same calculation in a different software and comparing
the results, I came to realize that the order of months for the results by
raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>
> How can I control the way raster delivers the object names after using
zApply, in order to sort the months in the "natural" order?
>
> Greetings, -- Thiago V. dos Santos
>
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
>
https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=


--
Katherine (Kay) Kilpatrick
University of Miami/RSMAS
Ocean Science Department
Satellite Remote Sensing Laboratory
MSC 231
4600 Rickenbacker Cswy
Miami, Fl
ph: 305-962-3069
kkilpatrick at rsmas.miami.edu


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Sat Jul 30 01:17:01 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Fri, 29 Jul 2016 19:17:01 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
	<1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <D7FB2BA4-F2AA-4026-BCEB-439F33F7C6F7@bigelow.org>

Hi,

I reworked your example a bit so that it encompasses just one year, and the value of each layer is the month number for the Z index.  Sure enough, the mean month number values look like they are mismatched relative to the layer name.  Example below - sorry about line-wrapping.  Uhoh.

Cheers,
Ben

library(raster)

# Create date sequence
idx <- seq(as.Date("1996/1/1"), as.Date("1996/12/31"), by = "day")

mon_num <- as.numeric(format(idx, "%m"))

# Create raster stack and assign dates
r <- raster(ncol=5, nrow=5)
s <- stack(
    lapply(1:length(idx), 
        function(x) setValues(r, rep(mon_num[x],ncell(r)))
        )
    )
s <- setZ(s, idx)

# Calculate monthly average
x <- zApply(s, by=months, mean, name=month.abb[])

x
# class       : RasterBrick 
# dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
# resolution  : 72, 36  (x, y)
# extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
# data source : in memory
# names       : April, August, December, February, January, July, June, March, May, November, October, September 
# min values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12 
# max values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12 


> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.6 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] raster_2.5-8 sp_1.2-3    

loaded via a namespace (and not attached):
[1] rgdal_1.1-10    Rcpp_0.12.6     grid_3.3.1      lattice_0.20-33


> On Jul 29, 2016, at 3:20 PM, Thiago V. dos Santos via R-sig-Geo <r-sig-geo at r-project.org> wrote:
> 
> Thanks everyone for their suggestions.
> 
> Reordering the output of zApply would be a WRONG solution, because the layers are already ordered from Jan to Dec.
> 
> It is just the NAMES that are misaligned, which can cause a bit of confusion.
> 
> I already contacted Robert about this issue and we should see a solution soon.
> Greetings,
> -- Thiago V. dos Santos
> 
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> 
> 
> 
> On Friday, July 29, 2016 2:09 PM, Kay Kilpatrick <kkilpatrick at rsmas.miami.edu> wrote:
> Hi
> 
> The various Apply functions always return the output in simple 
> alphabetical order when the factor label is a character, regardless of 
> the order of the factor in the calling argument.
> 
> Ben had a correct solution --- simply reorder the output from Zapply.
> 
> Alternatively you could use a numeric representation for the month label 
> using by = as.numeric(months(x). The output would then be in increasing 
> numeric order from 1 -12.
> 
> I do not believe Vijay's suggestion is proper. It does not reorder the 
> output --- instead it changes the label of a given monthly mean eg. The 
> value for Jan. would then be labeled as Apr.
> 
> k
> 
> On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
>> Dear all,
>> 
>> I am using the raster package to calculate monthly averages of climatic variables.
>> 
>> Essentially, this is the function I use:
>> 
>> library(raster)
>> 
>> # Create date sequence
>> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
>> 
>> # Create raster stack and assign dates
>> r <- raster(ncol=5, nrow=5)
>> s <- stack(lapply(1:length(idx), function(x) setValues(r, runif(ncell(r)))))
>> s <- setZ(s, idx)
>> 
>> # Calculate monthly average
>> x <- zApply(s, by=months, mean, name=month.abb[])
>> 
>> names(x)
>> [1] "April" "August" "December" "February" "January" "July" "June"
>> [8] "March" "May" "November" "October" "September"
>> getZ(x)
>> [1] "April" "August" "December" "February" "January" "July" "June"
>> [8] "March" "May" "November" "October" "September"
>> 
>> 
>> The problem here is the output of both names(x) and getZ(x). It looks like a random month order is returned (even though I provide the labels), which makes me confused about the results.
>> 
>> 
>> By performing the same calculation in a different software and comparing the results, I came to realize that the order of months for the results by raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
>> 
>> How can I control the way raster delivers the object names after using zApply, in order to sort the months in the "natural" order?
>> 
>> Greetings, -- Thiago V. dos Santos
>> 
>> PhD student
>> Land and Atmospheric Science
>> University of Minnesota
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=
> 
> 
> -- 
> Katherine (Kay) Kilpatrick
> University of Miami/RSMAS
> Ocean Science Department
> Satellite Remote Sensing Laboratory
> MSC 231
> 4600 Rickenbacker Cswy
> Miami, Fl
> ph: 305-962-3069
> kkilpatrick at rsmas.miami.edu
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


From vijaylulla at gmail.com  Sat Jul 30 04:27:38 2016
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Fri, 29 Jul 2016 22:27:38 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <D7FB2BA4-F2AA-4026-BCEB-439F33F7C6F7@bigelow.org>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
	<1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>
	<D7FB2BA4-F2AA-4026-BCEB-439F33F7C6F7@bigelow.org>
Message-ID: <CAKkiGbtdnQXjY8KpExeEHdRjtRXj4G5Fi+xSXnYy1O-cmd_pEA@mail.gmail.com>

Ben,
You're right about a mistake in my code but it is not use of ordered
function.  It is that I shouldn't have used the name argument.  Following
your example this is what I get:

> m <- function(x) ordered(months(x), labels=month.name)
> x1 <- zApply(s, by=m, mean) # no name argument.
> x1
# class       : RasterBrick
# dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
# resolution  : 72, 36  (x, y)
# extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
# data source : in memory
# names       : January, February, March, April, May, June, July, August,
September, October, November, December
# min values  :       1,        2,     3,     4,   5,    6,    7,
8,         9,      10,       11,       12
# max values  :       1,        2,     3,     4,   5,    6,    7,
8,         9,      10,       11,       12
#             : January, February, March, April, May, June, July, August,
September, October, November, December

Thanks for pointing out the mistake,
Vijay.


On Fri, Jul 29, 2016 at 7:17 PM, Ben Tupper <btupper at bigelow.org> wrote:

> Hi,
>
> I reworked your example a bit so that it encompasses just one year, and
> the value of each layer is the month number for the Z index.  Sure enough,
> the mean month number values look like they are mismatched relative to the
> layer name.  Example below - sorry about line-wrapping.  Uhoh.
>
> Cheers,
> Ben
>
> library(raster)
>
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("1996/12/31"), by = "day")
>
> mon_num <- as.numeric(format(idx, "%m"))
>
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(
>     lapply(1:length(idx),
>         function(x) setValues(r, rep(mon_num[x],ncell(r)))
>         )
>     )
> s <- setZ(s, idx)
>
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
>
> x
> # class       : RasterBrick
> # dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
> # resolution  : 72, 36  (x, y)
> # extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> # coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> # data source : in memory
> # names       : April, August, December, February, January, July, June,
> March, May, November, October, September
> # min values  :     1,      2,        3,        4,       5,    6,    7,
>  8,   9,       10,      11,        12
> # max values  :     1,      2,        3,        4,       5,    6,    7,
>  8,   9,       10,      11,        12
>
>
> > sessionInfo()
> R version 3.3.1 (2016-06-21)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.6 (El Capitan)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.5-8 sp_1.2-3
>
> loaded via a namespace (and not attached):
> [1] rgdal_1.1-10    Rcpp_0.12.6     grid_3.3.1      lattice_0.20-33
>
>
> > On Jul 29, 2016, at 3:20 PM, Thiago V. dos Santos via R-sig-Geo <
> r-sig-geo at r-project.org> wrote:
> >
> > Thanks everyone for their suggestions.
> >
> > Reordering the output of zApply would be a WRONG solution, because the
> layers are already ordered from Jan to Dec.
> >
> > It is just the NAMES that are misaligned, which can cause a bit of
> confusion.
> >
> > I already contacted Robert about this issue and we should see a solution
> soon.
> > Greetings,
> > -- Thiago V. dos Santos
> >
> > PhD student
> > Land and Atmospheric Science
> > University of Minnesota
> >
> >
> >
> > On Friday, July 29, 2016 2:09 PM, Kay Kilpatrick <
> kkilpatrick at rsmas.miami.edu> wrote:
> > Hi
> >
> > The various Apply functions always return the output in simple
> > alphabetical order when the factor label is a character, regardless of
> > the order of the factor in the calling argument.
> >
> > Ben had a correct solution --- simply reorder the output from Zapply.
> >
> > Alternatively you could use a numeric representation for the month label
> > using by = as.numeric(months(x). The output would then be in increasing
> > numeric order from 1 -12.
> >
> > I do not believe Vijay's suggestion is proper. It does not reorder the
> > output --- instead it changes the label of a given monthly mean eg. The
> > value for Jan. would then be labeled as Apr.
> >
> > k
> >
> > On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
> >> Dear all,
> >>
> >> I am using the raster package to calculate monthly averages of climatic
> variables.
> >>
> >> Essentially, this is the function I use:
> >>
> >> library(raster)
> >>
> >> # Create date sequence
> >> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
> >>
> >> # Create raster stack and assign dates
> >> r <- raster(ncol=5, nrow=5)
> >> s <- stack(lapply(1:length(idx), function(x) setValues(r,
> runif(ncell(r)))))
> >> s <- setZ(s, idx)
> >>
> >> # Calculate monthly average
> >> x <- zApply(s, by=months, mean, name=month.abb[])
> >>
> >> names(x)
> >> [1] "April" "August" "December" "February" "January" "July" "June"
> >> [8] "March" "May" "November" "October" "September"
> >> getZ(x)
> >> [1] "April" "August" "December" "February" "January" "July" "June"
> >> [8] "March" "May" "November" "October" "September"
> >>
> >>
> >> The problem here is the output of both names(x) and getZ(x). It looks
> like a random month order is returned (even though I provide the labels),
> which makes me confused about the results.
> >>
> >>
> >> By performing the same calculation in a different software and
> comparing the results, I came to realize that the order of months for the
> results by raster should, in fact, be
> Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
> >>
> >> How can I control the way raster delivers the object names after using
> zApply, in order to sort the months in the "natural" order?
> >>
> >> Greetings, -- Thiago V. dos Santos
> >>
> >> PhD student
> >> Land and Atmospheric Science
> >> University of Minnesota
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >>
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=
> >
> >
> > --
> > Katherine (Kay) Kilpatrick
> > University of Miami/RSMAS
> > Ocean Science Department
> > Satellite Remote Sensing Laboratory
> > MSC 231
> > 4600 Rickenbacker Cswy
> > Miami, Fl
> > ph: 305-962-3069
> > kkilpatrick at rsmas.miami.edu
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or
> tweet them to #MaineJellies -- include date, time, and location, as well as
> any descriptive information such as size or type.  Learn more at
> https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Sat Jul 30 14:51:43 2016
From: btupper at bigelow.org (Ben Tupper)
Date: Sat, 30 Jul 2016 08:51:43 -0400
Subject: [R-sig-Geo] Incorrect month order in zApply function
In-Reply-To: <CAKkiGbtdnQXjY8KpExeEHdRjtRXj4G5Fi+xSXnYy1O-cmd_pEA@mail.gmail.com>
References: <920141574.6225732.1469760750592.JavaMail.yahoo.ref@mail.yahoo.com>
	<920141574.6225732.1469760750592.JavaMail.yahoo@mail.yahoo.com>
	<9d686d72-6834-8a66-7422-c8700b2f7ee0@rsmas.miami.edu>
	<1683319255.6505118.1469820024122.JavaMail.yahoo@mail.yahoo.com>
	<D7FB2BA4-F2AA-4026-BCEB-439F33F7C6F7@bigelow.org>
	<CAKkiGbtdnQXjY8KpExeEHdRjtRXj4G5Fi+xSXnYy1O-cmd_pEA@mail.gmail.com>
Message-ID: <2D1633E3-F419-4544-8046-5204C2A75D77@bigelow.org>

Hi Vijay,

Whoops!  I think you misunderstood my message - I didn't think I was pointing out a mistake on your part.  My 'uhoh' was pointing out surprising behavior on the part of zApply.

If I use my earlier edited example and remove the "name=" argument to zApply, the results still make my forehead get all wrinkled up as the month labels don't align with the results.

library(raster)

# Create date sequence
idx <- seq(as.Date("1996/1/1"), as.Date("1996/12/31"), by = "day")
mon_num <- as.numeric(format(idx, "%m"))

# Create raster stack and assign dates
r <- raster(ncol=5, nrow=5)
s <- stack(
    lapply(1:length(idx), 
        function(x) setValues(r, rep(mon_num[x],ncell(r)))
        )
    )
s <- setZ(s, idx)

# Calculate monthly average
x <- zApply(s, by=months, fun = mean)
x
#class       : RasterBrick 
#dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
#resolution  : 72, 36  (x, y)
#extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
#data source : in memory
#names       : April, August, December, February, January, July, June, March, May, November, October, September 
#min values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12 
#max values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12 
#            : April, August, December, February, January, July, June, March, May, November, October, September 


So, what the heck does the "by=" do if not group the layers by month?  I can't see why you need to define your own aggregation m() to get it to work (and I am impressed that you did get it to work.)

Cheers,
Ben




> On Jul 29, 2016, at 10:27 PM, Vijay Lulla <vijaylulla at gmail.com> wrote:
> 
> Ben,
> You're right about a mistake in my code but it is not use of ordered function.  It is that I shouldn't have used the name argument.  Following your example this is what I get:
> 
> > m <- function(x) ordered(months(x), labels=month.name <http://month.name/>)
> > x1 <- zApply(s, by=m, mean) # no name argument.
> > x1
> # class       : RasterBrick 
> # dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
> # resolution  : 72, 36  (x, y)
> # extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> # coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> # data source : in memory
> # names       : January, February, March, April, May, June, July, August, September, October, November, December 
> # min values  :       1,        2,     3,     4,   5,    6,    7,      8,         9,      10,       11,       12 
> # max values  :       1,        2,     3,     4,   5,    6,    7,      8,         9,      10,       11,       12 
> #             : January, February, March, April, May, June, July, August, September, October, November, December
> 
> Thanks for pointing out the mistake,
> Vijay.
> 
> 
> On Fri, Jul 29, 2016 at 7:17 PM, Ben Tupper <btupper at bigelow.org <mailto:btupper at bigelow.org>> wrote:
> Hi,
> 
> I reworked your example a bit so that it encompasses just one year, and the value of each layer is the month number for the Z index.  Sure enough, the mean month number values look like they are mismatched relative to the layer name.  Example below - sorry about line-wrapping.  Uhoh.
> 
> Cheers,
> Ben
> 
> library(raster)
> 
> # Create date sequence
> idx <- seq(as.Date("1996/1/1"), as.Date("1996/12/31"), by = "day")
> 
> mon_num <- as.numeric(format(idx, "%m"))
> 
> # Create raster stack and assign dates
> r <- raster(ncol=5, nrow=5)
> s <- stack(
>     lapply(1:length(idx),
>         function(x) setValues(r, rep(mon_num[x],ncell(r)))
>         )
>     )
> s <- setZ(s, idx)
> 
> # Calculate monthly average
> x <- zApply(s, by=months, mean, name=month.abb[])
> 
> x
> # class       : RasterBrick
> # dimensions  : 5, 5, 25, 12  (nrow, ncol, ncell, nlayers)
> # resolution  : 72, 36  (x, y)
> # extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> # coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> # data source : in memory
> # names       : April, August, December, February, January, July, June, March, May, November, October, September
> # min values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12
> # max values  :     1,      2,        3,        4,       5,    6,    7,     8,   9,       10,      11,        12
> 
> 
> > sessionInfo()
> R version 3.3.1 (2016-06-21)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.6 (El Capitan)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] raster_2.5-8 sp_1.2-3
> 
> loaded via a namespace (and not attached):
> [1] rgdal_1.1-10    Rcpp_0.12.6     grid_3.3.1      lattice_0.20-33
> 
> 
> > On Jul 29, 2016, at 3:20 PM, Thiago V. dos Santos via R-sig-Geo <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>> wrote:
> >
> > Thanks everyone for their suggestions.
> >
> > Reordering the output of zApply would be a WRONG solution, because the layers are already ordered from Jan to Dec.
> >
> > It is just the NAMES that are misaligned, which can cause a bit of confusion.
> >
> > I already contacted Robert about this issue and we should see a solution soon.
> > Greetings,
> > -- Thiago V. dos Santos
> >
> > PhD student
> > Land and Atmospheric Science
> > University of Minnesota
> >
> >
> >
> > On Friday, July 29, 2016 2:09 PM, Kay Kilpatrick <kkilpatrick at rsmas.miami.edu <mailto:kkilpatrick at rsmas.miami.edu>> wrote:
> > Hi
> >
> > The various Apply functions always return the output in simple
> > alphabetical order when the factor label is a character, regardless of
> > the order of the factor in the calling argument.
> >
> > Ben had a correct solution --- simply reorder the output from Zapply.
> >
> > Alternatively you could use a numeric representation for the month label
> > using by = as.numeric(months(x). The output would then be in increasing
> > numeric order from 1 -12.
> >
> > I do not believe Vijay's suggestion is proper. It does not reorder the
> > output --- instead it changes the label of a given monthly mean eg. The
> > value for Jan. would then be labeled as Apr.
> >
> > k
> >
> > On 7/28/16 10:52 PM, Thiago V. dos Santos via R-sig-Geo wrote:
> >> Dear all,
> >>
> >> I am using the raster package to calculate monthly averages of climatic variables.
> >>
> >> Essentially, this is the function I use:
> >>
> >> library(raster)
> >>
> >> # Create date sequence
> >> idx <- seq(as.Date("1996/1/1"), as.Date("2010/12/31"), by = "day")
> >>
> >> # Create raster stack and assign dates
> >> r <- raster(ncol=5, nrow=5)
> >> s <- stack(lapply(1:length(idx), function(x) setValues(r, runif(ncell(r)))))
> >> s <- setZ(s, idx)
> >>
> >> # Calculate monthly average
> >> x <- zApply(s, by=months, mean, name=month.abb[])
> >>
> >> names(x)
> >> [1] "April" "August" "December" "February" "January" "July" "June"
> >> [8] "March" "May" "November" "October" "September"
> >> getZ(x)
> >> [1] "April" "August" "December" "February" "January" "July" "June"
> >> [8] "March" "May" "November" "October" "September"
> >>
> >>
> >> The problem here is the output of both names(x) and getZ(x). It looks like a random month order is returned (even though I provide the labels), which makes me confused about the results.
> >>
> >>
> >> By performing the same calculation in a different software and comparing the results, I came to realize that the order of months for the results by raster should, in fact, be Jan-Feb-Mar-Apr-May-Jun-Jul-Aug-Sep-Oct-Nov-Dec
> >>
> >> How can I control the way raster delivers the object names after using zApply, in order to sort the months in the "natural" order?
> >>
> >> Greetings, -- Thiago V. dos Santos
> >>
> >> PhD student
> >> Land and Atmospheric Science
> >> University of Minnesota
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e= <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=CwICAg&c=y2w-uYmhgFWijp_IQN0DhA&r=VXzrzLaooo912e5bVVEO_z5cHQXu_22lipAXBkfCXjM&m=tzdb3kN3Nxjo7NbPkPVqtF269bJen1bf3AzSHEwd7CA&s=zuokuoKIDT6cOaBD2J6ePy1klmf1J3-f3BynP_G5I-g&e=>
> >
> >
> > --
> > Katherine (Kay) Kilpatrick
> > University of Miami/RSMAS
> > Ocean Science Department
> > Satellite Remote Sensing Laboratory
> > MSC 231
> > 4600 Rickenbacker Cswy
> > Miami, Fl
> > ph: 305-962-3069 <tel:305-962-3069>
> > kkilpatrick at rsmas.miami.edu <mailto:kkilpatrick at rsmas.miami.edu>
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 
> 
> 
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org <http://www.bigelow.org/>
> 
> Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org <mailto:jellyfish at bigelow.org> or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/ <https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Report Gulf of Maine jellyfish sightings to jellyfish at bigelow.org or tweet them to #MaineJellies -- include date, time, and location, as well as any descriptive information such as size or type.  Learn more at https://www.bigelow.org/research/srs/nick-record/nick-record-laboratory/mainejellies/


	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Sat Jul 30 15:40:33 2016
From: englishchristophera at gmail.com (chris english)
Date: Sat, 30 Jul 2016 06:40:33 -0700
Subject: [R-sig-Geo] Plotting USA map with each state's shape or size
 reflective of a metric
In-Reply-To: <CAASFQpS6Q7PZy9Frm4E-S5w2vPUPNY8sHvkRTsc_mZxpT4XYvg@mail.gmail.com>
References: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
	<CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>
	<CAFWQgO=PnV70WLOjpR5dAif=R-Lb69do5LAfvRCtLw_MBD=kuw@mail.gmail.com>
	<CAASFQpS6Q7PZy9Frm4E-S5w2vPUPNY8sHvkRTsc_mZxpT4XYvg@mail.gmail.com>
Message-ID: <CAASFQpQq7tr75WVj9AP+jzrP_jjZTx+VrUYvV=S1E-rBaZtLLg@mail.gmail.com>

Try r-bloggers cartogram for worked examples in R.
Chris

On Jul 29, 2016 19:01, "Nick Eubank" <nickeubank at gmail.com> wrote:

Not sure how to do in R (can do in arcgis), but you might find the term
"Cartogram" useful on google -- that's the "term of art" for those maps.

On Fri, Jul 29, 2016 at 8:20 AM Vinh Nguyen <vinhdizzo at gmail.com> wrote:

> Hi everyone,
>
> Does anyone know if this is possible with R? An example can be found here:
> http://projects.fivethirtyeight.com/2016-election-forecast/ (a few plots
> down).
>
> Appreciate any references you point me to. Thanks!
>
> Vinh
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From vinhdizzo at gmail.com  Sat Jul 30 15:57:22 2016
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Sat, 30 Jul 2016 06:57:22 -0700
Subject: [R-sig-Geo] Plotting USA map with each state's shape or size
 reflective of a metric
In-Reply-To: <CAASFQpQq7tr75WVj9AP+jzrP_jjZTx+VrUYvV=S1E-rBaZtLLg@mail.gmail.com>
References: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
	<CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>
	<CAFWQgO=PnV70WLOjpR5dAif=R-Lb69do5LAfvRCtLw_MBD=kuw@mail.gmail.com>
	<CAASFQpS6Q7PZy9Frm4E-S5w2vPUPNY8sHvkRTsc_mZxpT4XYvg@mail.gmail.com>
	<CAASFQpQq7tr75WVj9AP+jzrP_jjZTx+VrUYvV=S1E-rBaZtLLg@mail.gmail.com>
Message-ID: <CA+2DmwhYB+CA9v3BCjZf-1OX_eOQY0KvusC9Mt8occ6V0asF0A@mail.gmail.com>

I was able to find examples (some from R bloggers) after googling R
cartograms. Thanks Nick and Chris.

Shapefiles did show up relative to metric, but they look very distorted and
I'm not sure it conveys information the best way possible.

Anyone run into hexbin examples or something similar to the original post?
That is, not necessarily shapefiles. Approximate location and shapes are
fine. Thanks!

On Jul 30, 2016 6:40 AM, "chris english" <englishchristophera at gmail.com>
wrote:

> Try r-bloggers cartogram for worked examples in R.
> Chris
>
> On Jul 29, 2016 19:01, "Nick Eubank" <nickeubank at gmail.com> wrote:
>
> Not sure how to do in R (can do in arcgis), but you might find the term
> "Cartogram" useful on google -- that's the "term of art" for those maps.
>
> On Fri, Jul 29, 2016 at 8:20 AM Vinh Nguyen <vinhdizzo at gmail.com> wrote:
>
> > Hi everyone,
> >
> > Does anyone know if this is possible with R? An example can be found
> here:
> > http://projects.fivethirtyeight.com/2016-election-forecast/ (a few plots
> > down).
> >
> > Appreciate any references you point me to. Thanks!
> >
> > Vinh
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Sat Jul 30 16:17:51 2016
From: englishchristophera at gmail.com (chris english)
Date: Sat, 30 Jul 2016 17:17:51 +0300
Subject: [R-sig-Geo] Plotting USA map with each state's shape or size
 reflective of a metric
In-Reply-To: <CA+2DmwhYB+CA9v3BCjZf-1OX_eOQY0KvusC9Mt8occ6V0asF0A@mail.gmail.com>
References: <CA+2Dmwj2EnPwAWDz3XRaFHt=6EVTrTnwg_8zDuYRFJ0HTD29Zw@mail.gmail.com>
	<CA+2DmwiA7DcdAwUae7Nto9wjrroS3tyPVP4V4ddQhC7VVqj6mg@mail.gmail.com>
	<CAFWQgO=PnV70WLOjpR5dAif=R-Lb69do5LAfvRCtLw_MBD=kuw@mail.gmail.com>
	<CAASFQpS6Q7PZy9Frm4E-S5w2vPUPNY8sHvkRTsc_mZxpT4XYvg@mail.gmail.com>
	<CAASFQpQq7tr75WVj9AP+jzrP_jjZTx+VrUYvV=S1E-rBaZtLLg@mail.gmail.com>
	<CA+2DmwhYB+CA9v3BCjZf-1OX_eOQY0KvusC9Mt8occ6V0asF0A@mail.gmail.com>
Message-ID: <CAASFQpTGggycRwM6QLZreVsZ5eAE4PzDcNtsACrBz63XXRwJ0g@mail.gmail.com>

Vinh,
Perhaps an interesting crosswalk between hex and equal area maps with
github code linked.
https://www.google.com.cy/url?sa=t&source=web&rct=j&url=https://blog.diegovalle.net/2015/06/mexican-2015-election.html&ved=0ahUKEwiNlLutrpvOAhWE7BQKHcCHCfUQFggmMAQ&usg=AFQjCNF7ycTpUYPohPUsOmqLOJeTWFZyag
A somewhat confusing link coming out of a lmgtfy on a phone, but I think
crosswalks like this might be more useful as you have at least two
expressions of what you are trying to represent.
HTH, chris

On Jul 30, 2016 16:57, "Vinh Nguyen" <vinhdizzo at gmail.com> wrote:

> I was able to find examples (some from R bloggers) after googling R
> cartograms. Thanks Nick and Chris.
>
> Shapefiles did show up relative to metric, but they look very distorted
> and I'm not sure it conveys information the best way possible.
>
> Anyone run into hexbin examples or something similar to the original post?
> That is, not necessarily shapefiles. Approximate location and shapes are
> fine. Thanks!
>
> On Jul 30, 2016 6:40 AM, "chris english" <englishchristophera at gmail.com>
> wrote:
>
>> Try r-bloggers cartogram for worked examples in R.
>> Chris
>>
>> On Jul 29, 2016 19:01, "Nick Eubank" <nickeubank at gmail.com> wrote:
>>
>> Not sure how to do in R (can do in arcgis), but you might find the term
>> "Cartogram" useful on google -- that's the "term of art" for those maps.
>>
>> On Fri, Jul 29, 2016 at 8:20 AM Vinh Nguyen <vinhdizzo at gmail.com> wrote:
>>
>> > Hi everyone,
>> >
>> > Does anyone know if this is possible with R? An example can be found
>> here:
>> > http://projects.fivethirtyeight.com/2016-election-forecast/ (a few
>> plots
>> > down).
>> >
>> > Appreciate any references you point me to. Thanks!
>> >
>> > Vinh
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>

	[[alternative HTML version deleted]]


