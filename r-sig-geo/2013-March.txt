From etiennebr at gmail.com  Fri Mar  1 00:13:36 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Thu, 28 Feb 2013 18:13:36 -0500
Subject: [R-sig-Geo] Antw: arithmetic with layers from a raster
	stack/brick
In-Reply-To: <512FCF700200002700018AA9@gwia2.boku.ac.at>
References: <512FCF700200002700018AA9@gwia2.boku.ac.at>
Message-ID: <CALjAYt7jHSTxkNaDv10=A-cXWAzHos=nc9cY+Gpe4_LnUSV_pg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130228/6c8e9d3a/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Mar  1 02:22:21 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 01 Mar 2013 01:22:21 +0000
Subject: [R-sig-Geo] Large Prediction Variances with gstat
In-Reply-To: <1362086426948-7582882.post@n2.nabble.com>
References: <1362086426948-7582882.post@n2.nabble.com>
Message-ID: <513002CD.6020009@uni-muenster.de>

predict.lm gives prediction errors for the mean, where gstat gives 
prediction errors for single observations, identical to

 > summary(pred.variance) + lm.zn.pred$residual.scale^2
     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
0.224297 0.231328 0.233698 0.236858 0.240198 0.301258

If you ask gstat to make predictions for blocks, using linear 
regression, it predicts the mean instead of individual observations, 
which is equivalent to kriging with a pure nugget effect:

 > gstat.lm.zn.pred<-krige(log(zinc)~x+y+elev, dat.mod, 
newdata=dat.pred, block=1)
[ordinary or weighted least squares prediction]
 > summary(gstat.lm.zn.pred at data) #gstat results
    var1.pred        var1.var
  Min.   :4.061   Min.   :0.006409
  1st Qu.:4.974   1st Qu.:0.013438
  Median :5.335   Median :0.015809
  Mean   :5.303   Mean   :0.018970
  3rd Qu.:5.618   3rd Qu.:0.022309
  Max.   :6.262   Max.   :0.083373


On 02/28/2013 09:20 PM, Jesse Berman wrote:
> Hi All,
>
> First time post, so please excuse any omissions/confusion.  I am performing
> a series of prediction models using gstat and discovered that prediction
> variance of spatially dependent data with OLS models was larger than those
> of kriging models.  This is counter-intuitive to the assumption that
> treating spatially dependent data as IID will result in artificially
> shrunken prediction variances.  Anyhow, to better understand how gstat
> treats OLS predictions, I reproduced an OLS prediction with the base package
> ('predict' and 'predict.lm') and found that while I got identical beta's, I
> got substantially higher variances with gstat.
>
> Can anyone shed some light as to why gstat might be giving these larger
> prediction variances when performing an OLS model?  (see reproducible
> example below)
>
> Regards and thanks for the help,
> Jesse
>
> library(gstat)
> data(meuse)
> coordinates(meuse) = ~x+y
> meuse.ns<-as.data.frame(meuse) #non-spatial Meuse data
>
> #Data sets for modeling and prediction; spatial and non-spatial
> dat.mod<-meuse[1:100,]
> dat.pred<-meuse[101:155,]
> dat.ns.mod<-meuse.ns[1:100,]
> dat.ns.pred<-meuse.ns[101:155,]
>
> #Linear Model Prediction with base package
> lm.zn<-lm(log(zinc)~x+y+elev, data=dat.mod)
> lm.zn.pred<-predict(lm.zn, dat.pred, se.fit=TRUE)
> pred.variance<-(lm.zn.pred$se.fit)^2
>
> #Linear Model Prediction with gstat
> gstat.lm.zn.pred<-krige(log(zinc)~x+y+elev, dat.mod, newdata=dat.pred)
>
> #Compare Results
> summary(gstat.lm.zn.pred at data) #gstat results
> summary(lm.zn.pred$fit)
> summary(pred.variance) #base model prediction variance
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Large-Prediction-Variances-with-gstat-tp7582882.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From zua3 at cornell.edu  Fri Mar  1 03:24:04 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Fri, 1 Mar 2013 02:24:04 +0000
Subject: [R-sig-Geo] Extract max. pixel value from a set geoTif raster image
 and create a new geoTIF image with these max values
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B9601FB01@CH1PRD0410MB391.namprd04.prod.outlook.com>

       Dear list,
       I like to  extract  max. pixel value from a set  geoTif raster image and create a new geoTIf  image  with these max values. Is it possible to do this with R "raster" package?  
       Thanks
       Zia
       


From HodgessE at uhd.edu  Fri Mar  1 03:26:18 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 1 Mar 2013 02:26:18 +0000
Subject: [R-sig-Geo] crop and overlay question
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292D7CC@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/810700a4/attachment.pl>

From berman.jesse at gmail.com  Fri Mar  1 05:44:02 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Thu, 28 Feb 2013 20:44:02 -0800 (PST)
Subject: [R-sig-Geo] crop and overlay question
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021292D7CC@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F68063021292D7CC@challenger.uhd.campus>
Message-ID: <1362113042981-7582896.post@n2.nabble.com>

Hi Erin,

I'm sure someone else will have a more elegant solution, but if you need a
quick fix try this (adapted from your posted code)

Jesse

tmp <- map("state","Texas",fill=TRUE,plot=FALSE) 
texas.boundary <- map2SpatialPolygons(tmp, IDs=tmp$names,
proj4string=CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0")) 
texas1.boundary <- spTransform(texas.boundary,CRS("+proj=aea +lat_1=27.5
+lat_2=35 +lat_0=18 +lon_0=-100 +x_0=1500000 +y_0=6000000 +ellps=GRS80
+datum=NAD83 +units=m +no_defs") ) 
grd <- SpatialPoints(makegrid(texas1.boundary, n=300))

# New steps 
Overlay<-overlay(grd, texas1.boundary) #To find out which points fall within
the TX boundary
grd at coords<-cbind(grd at coords,Overlay) #To mark those points outside TX with
an NA
tex.grid<-na.exclude(as.data.frame(grd)) # Transfers to non-spatial
dataframe to remove NA points
coordinates(tex.grid)=~x1+x2 # Now turn back into spatial points dataframe
proj4string(tex.grid)=("+proj=aea +lat_1=27.5 +lat_2=35 +lat_0=18
+lon_0=-100 +x_0=1500000 +y_0=6000000 +ellps=GRS80 +datum=NAD83 +units=m
+no_defs")
plot(tex.grid)



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/crop-and-overlay-question-tp7582894p7582896.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Fri Mar  1 06:02:55 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 28 Feb 2013 21:02:55 -0800
Subject: [R-sig-Geo] plot raster over google map
In-Reply-To: <CD556DCD.3F09%rossahmed@gmail.com>
References: <CANtt_hze6TwfMnfE3bzncC2d2bNwKhFMLb6U+=Va2kFrRgq5sg@mail.gmail.com>
	<CD556DCD.3F09%rossahmed@gmail.com>
Message-ID: <CANtt_hzCAj4+hP4uS_LjMuaGsG+hPbOWw0QgMO3JBYspnpofyg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130228/0c412f29/attachment.pl>

From roman.lustrik at gmail.com  Fri Mar  1 08:27:18 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 1 Mar 2013 08:27:18 +0100
Subject: [R-sig-Geo] Extract max. pixel value from a set geoTif raster
 image and create a new geoTIF image with these max values
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B9601FB01@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B9601FB01@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <CAHT1vphpwQNBmEPQD-RSvmrENsXYdXuE44K0z9iH+X5==L4EEw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/e5a1dd97/attachment.pl>

From HodgessE at uhd.edu  Fri Mar  1 08:46:13 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 1 Mar 2013 07:46:13 +0000
Subject: [R-sig-Geo] crop and overlay question
In-Reply-To: <1362113042981-7582896.post@n2.nabble.com>
References: <FF9DB805FC41CC4E95825A50F68063021292D7CC@challenger.uhd.campus>,
	<1362113042981-7582896.post@n2.nabble.com>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292D89F@challenger.uhd.campus>

this is great!  Thank you!

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Jesse Berman [berman.jesse at gmail.com]
Sent: Thursday, February 28, 2013 10:44 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] crop and overlay question

Hi Erin,

I'm sure someone else will have a more elegant solution, but if you need a
quick fix try this (adapted from your posted code)

Jesse

tmp <- map("state","Texas",fill=TRUE,plot=FALSE)
texas.boundary <- map2SpatialPolygons(tmp, IDs=tmp$names,
proj4string=CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
texas1.boundary <- spTransform(texas.boundary,CRS("+proj=aea +lat_1=27.5
+lat_2=35 +lat_0=18 +lon_0=-100 +x_0=1500000 +y_0=6000000 +ellps=GRS80
+datum=NAD83 +units=m +no_defs") )
grd <- SpatialPoints(makegrid(texas1.boundary, n=300))

# New steps
Overlay<-overlay(grd, texas1.boundary) #To find out which points fall within
the TX boundary
grd at coords<-cbind(grd at coords,Overlay) #To mark those points outside TX with
an NA
tex.grid<-na.exclude(as.data.frame(grd)) # Transfers to non-spatial
dataframe to remove NA points
coordinates(tex.grid)=~x1+x2 # Now turn back into spatial points dataframe
proj4string(tex.grid)=("+proj=aea +lat_1=27.5 +lat_2=35 +lat_0=18
+lon_0=-100 +x_0=1500000 +y_0=6000000 +ellps=GRS80 +datum=NAD83 +units=m
+no_defs")
plot(tex.grid)



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/crop-and-overlay-question-tp7582894p7582896.html
Sent from the R-sig-geo mailing list archive at Nabble.com.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rossahmed at googlemail.com  Fri Mar  1 09:12:37 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 01 Mar 2013 08:12:37 +0000
Subject: [R-sig-Geo] plot raster over google map
In-Reply-To: <CANtt_hzCAj4+hP4uS_LjMuaGsG+hPbOWw0QgMO3JBYspnpofyg@mail.gmail.com>
Message-ID: <CD561310.3F25%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/6ccc5be2/attachment.pl>

From oscar.perpinan at gmail.com  Fri Mar  1 10:17:24 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Fri, 01 Mar 2013 10:17:24 +0100
Subject: [R-sig-Geo] Antw: arithmetic with layers from a
	raster	stack/brick
In-Reply-To: <CALjAYt7jHSTxkNaDv10=A-cXWAzHos=nc9cY+Gpe4_LnUSV_pg@mail.gmail.com>
References: <512FCF700200002700018AA9@gwia2.boku.ac.at>,
	<CALjAYt7jHSTxkNaDv10=A-cXWAzHos=nc9cY+Gpe4_LnUSV_pg@mail.gmail.com>
Message-ID: <87obf3pjh7.fsf@gmail.com>

Hi,

Another solution:

r <- raster(nrows=2, ncols=2)
r[] <- 1:ncell(r)
s <- stack(r, r, r, r)
names(s) <- letters[1:4]

## all the layers
sum(s)
## only a subset
sum(subset(s, c('a', 'b')))

Best,

Oscar.

Etienne B. Racine <etiennebr at gmail.com> writes:

> I wouldn't recommend using this for general purpose, but this should work:
>
> for (i in 1:nlayers(s)) {
>   assign(names(s)[i], s[[i]])
> }
>
> Etienne
>
>
> 2013/2/28 Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at>
>
>> Dear Ani,
>>
>>
>> Your "a" and "b" are not objects, they are the name the layers in your
>> object "s". So you can't treat it that way.
>>
>>
>> Maybe this is what you want?
>>
>>
>> require(raster)
>> r<- raster(nrows=2, ncols=2)
>> r[]<-1:ncell(r)
>> s<-stack(r,r)
>> names(s)<-c("a","b")
>>
>>
>>
>> r1<- s[["a"]] + s[["b"]]
>>
>>
>> Matteo
>>
>> >>> aniruddha ghosh  28.02.13 21.26 Uhr >>>
>> Dear List,
>>
>> I'm trying to perform some arithmetic operation with layers of a raster
>> object. What I'm trying is
>>
>> >require(raster)
>> >r<- raster(nrows=2, ncols=2)
>> >r[]<-1:ncell(r)
>> >s<-stack(r,r)
>> >names(s)<-c("a","b")
>>
>> # now I want to add the layers of the raster "r" using their corresponding
>> names,i.e. "a" and "b" so that I get
>>
>> >r1<-a+b
>>
>> I don't want to use subset (or any other methods) to define "a" or "b".
>> This may be very trivial, but I couldn't do it.
>>
>> Any suggestions?
>>
>> Thanks
>> --
>> Ani
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From rossahmed at googlemail.com  Fri Mar  1 14:56:49 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 01 Mar 2013 13:56:49 +0000
Subject: [R-sig-Geo] project google map to Sinusoidal
Message-ID: <CD566421.3F37%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/39471cbe/attachment.pl>

From zua3 at cornell.edu  Fri Mar  1 15:38:01 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Fri, 1 Mar 2013 14:38:01 +0000
Subject: [R-sig-Geo] Extract max.... es: PROBLEM writing geotiff
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/5766bbe1/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Fri Mar  1 15:42:04 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Fri, 01 Mar 2013 15:42:04 +0100
Subject: [R-sig-Geo] Antw:  project google map to Sinusoidal
In-Reply-To: <CD566421.3F37%rossahmed@gmail.com>
References: <CD566421.3F37%rossahmed@gmail.com>
Message-ID: <5130CC4C0200002700018ACC@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/4ad9b23e/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Fri Mar  1 15:48:40 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Fri, 01 Mar 2013 15:48:40 +0100
Subject: [R-sig-Geo] Antw: Re: Extract max.... es: PROBLEM writing geotiff
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <5130CDD80200002700018AD2@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/85cfa7c3/attachment.pl>

From rafael.wueest at wsl.ch  Fri Mar  1 15:50:14 2013
From: rafael.wueest at wsl.ch (=?windows-1252?Q?Rafael_W=FCest?=)
Date: Fri, 1 Mar 2013 15:50:14 +0100
Subject: [R-sig-Geo] Extract max.... es: PROBLEM writing geotiff
In-Reply-To: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>
Message-ID: <42400804-9ABA-4025-8248-F570A0B46DB9@wsl.ch>

Hi Zia

try

# Writing tiff file:

tr <- "L://MODIS_DATA//NDVI/max.tif"
writeRaster(r,tr)

HTH
Rafael


On 01.03.2013, at 15:38, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:

> 
> Thanks everybody. It works fine with following codes for extracting  max value from list from a huge data set (max pixel value of  NDVI from May to August  for CO, NM, WY and KS states) .  But I have a problem with writing a  geotiff file. This is first time I am working with rgdal. I was looking for   appropriate code in R-sig-Geo Archives<https://stat.ethz.ch/pipermail/r-sig-geo/> for solving this problem.  But I do not find any possible solution for doing this (may be it is due to my limiting   understanding of  rgdal working environment). Any suggestion will be appreciated.
> Thanks again
> Zia
> 
> rm(list=ls(all=TRUE))
> # Get Max values
> library(raster)
> library(rgdal)
> 
> setwd("L:/MODIS_DATA/NDVI")
> files <- list.files(pattern='.tif$')
> 
> s <- stack(files)
> r <- max(s)
> str(r)
> plot(r)
> 
> # Writing tiff file:
> 
> tr <- "L://MODIS_DATA//NDVI/max.tif"
> writeGDAL(r, tf, drivername="GTiff", options="TFW=YES")
> 
> ?Error in function (classes, fdef, mtable)  :
>  unable to find an inherited method for function ?gridded? for signature ?"RasterLayer"??
> 
> 
> 
> 
> 
> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:romunov at gmail.com] On Behalf Of Roman Lu?trik
> Sent: Friday, March 01, 2013 2:27 AM
> To: Zia Uddin Ahmed
> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> Subject: Re: [R-sig-Geo] Extract max. pixel value from a set geoTif raster image and create a new geoTIF image with these max values
> 
> Yes. You will also want to install rgdal, if you haven't already. You can read and write files with readOGR() and writeOGR(), while raster functions are quite intuitive to work with. See raster package vignette and drop us a line if you have any more questions.
> 
> Cheers,
> Roman
> 
> 
> On Fri, Mar 1, 2013 at 3:24 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:zua3 at cornell.edu>> wrote:
>       Dear list,
>       I like to  extract  max. pixel value from a set  geoTif raster image and create a new geoTIf  image  with these max values. Is it possible to do this with R "raster" package?
>       Thanks
>       Zia
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> --
> In God we trust, all others bring data.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From rossahmed at googlemail.com  Fri Mar  1 17:17:44 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 01 Mar 2013 16:17:44 +0000
Subject: [R-sig-Geo] Antw:  project google map to Sinusoidal
In-Reply-To: <5130CC4C0200002700018ACC@gwia2.boku.ac.at>
Message-ID: <CD56835E.3F42%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/090a0ff3/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Fri Mar  1 17:56:31 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Fri, 01 Mar 2013 17:56:31 +0100
Subject: [R-sig-Geo] Antw:  project google map to Sinusoidal
Message-ID: <5130EBCF0200002700018AFB@gwia2.boku.ac.at>

Ross, here the area using rgeos...but again I think a GIS System is much
more suited for this type of things... Matteo


myExtent <- extent(c(-1.87710, -1.772096, 55.61399, 55.682171))
r <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84 +datum=WGS84")
 
myRaster <- projectExtent(r,crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0
+a=6371007.181 +b=6371007.181 +units=m +no_defs")
  
res1km <- obeyRes(extent(myRaster),resolution=sqrt(1)*1000)
myRaster1km <- raster(ext=res1km$extent, ncol=res1km$cols,
nrows=res1km$rows,crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs")
 
myRaster1km[] <- runif(ncell(myRaster1km),0,10)
 
g  <- gmap(myExtent, type='hybrid', interpolate=T, rgb=TRUE, zoom=13)
gg <- projectRaster(g, method="ngb",crs= "+proj=sinu +lon_0=0 +x_0=0
+y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs")


pols <- rasterToPolygons(myRaster1km)


plotRGB(gg)
plot(pols,add=T)
 
a <- drawPoly()
projection(a) <- projection(gg)
require(rgeos)
gArea(a) # area of a in mapunit [qm]
cell <- cellFromPolygon(myRaster1km,a)[[1]]
 


>>> Ross Ahmed  03/01/13 5:09 PM >>>
Hi Matteo

Yes  that?s almost exactly what I want. However, I need to be able to
see
the fields in the google map, as can be seen here:

myExtent <- extent(c(-1.87710, -1.772096, 55.61399, 55.682171))
g <- gmap(myExtent, type='hybrid', interpolate=T, lonlat=T, zoom=13)
plot(g)

My plan is to draw a polygon around the boundary of each field, and
calculate area of each field.

If the google map cannot be projected to Sinusoidal, perhaps I could
first
draw the polygons on the WSG84 google map, then re-project each polygon
to
Sinusoidal?

Thanks
Ross

From:  Matteo Mattiuzzi 
Date:  Friday, 1 March 2013 14:42
To:  Ross Ahmed , 
Subject:  Antw: [R-sig-Geo] project google map to Sinusoidal

myExtent <- extent(c(-1.87710, -1.772096, 55.61399, 55.682171))
r <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84 +datum=WGS84")
 
myRaster <- projectExtent(r,crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0
+a=6371007.181 +b=6371007.181 +units=m +no_defs")
 
  
res1km <- obeyRes(extent(myRaster),resolution=sqrt(1)*1000)
myRaster1km <- 
raster(ext=res1km$extent,ncol=res1km$cols,nrows=res1km$rows,crs="+proj=sinu
+lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs")
 
myRaster1km[] <- runif(ncell(myRaster1km),0,10)
 
g <- gmap(myExtent, type='hybrid', interpolate=T, lonlat=T)
gg <- projectRaster(g,crs= "+proj=sinu +lon_0=0 +x_0=0 +y_0=0
+a=6371007.181
+b=6371007.181 +units=m +no_defs")
pols <- rasterToPolygons(myRaster1km)
plot(gg)
plot(pols,add=T)
 
a <- drawPoly()
projection(a) <- projection(gg)
cell <- cellFromPolygon(myRaster1km,a)[[1]]
 
myRaster1km[cell]


From zua3 at cornell.edu  Fri Mar  1 17:19:39 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Fri, 1 Mar 2013 16:19:39 +0000
Subject: [R-sig-Geo] Extract max.... es: PROBLEM writing geotiff
In-Reply-To: <42400804-9ABA-4025-8248-F570A0B46DB9@wsl.ch>
References: <38AE5D3AB285FB4EB7F8683E9E383B960EA12A89@CH1PRD0410MB391.namprd04.prod.outlook.com>
	<42400804-9ABA-4025-8248-F570A0B46DB9@wsl.ch>
Message-ID: <38AE5D3AB285FB4EB7F8683E9E383B960EA12AD0@CH1PRD0410MB391.namprd04.prod.outlook.com>

Thanks,  it works fine. I appreciate your help. 
Zia

-----Original Message-----
From: Rafael W?est [mailto:rafael.wueest at wsl.ch] 
Sent: Friday, March 01, 2013 9:50 AM
To: Zia Uddin Ahmed
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Extract max.... es: PROBLEM writing geotiff

Hi Zia

try

# Writing tiff file:

tr <- "L://MODIS_DATA//NDVI/max.tif"
writeRaster(r,tr)

HTH
Rafael


On 01.03.2013, at 15:38, Zia Uddin Ahmed <zua3 at cornell.edu> wrote:

> 
> Thanks everybody. It works fine with following codes for extracting  max value from list from a huge data set (max pixel value of  NDVI from May to August  for CO, NM, WY and KS states) .  But I have a problem with writing a  geotiff file. This is first time I am working with rgdal. I was looking for   appropriate code in R-sig-Geo Archives<https://stat.ethz.ch/pipermail/r-sig-geo/> for solving this problem.  But I do not find any possible solution for doing this (may be it is due to my limiting   understanding of  rgdal working environment). Any suggestion will be appreciated.
> Thanks again
> Zia
> 
> rm(list=ls(all=TRUE))
> # Get Max values
> library(raster)
> library(rgdal)
> 
> setwd("L:/MODIS_DATA/NDVI")
> files <- list.files(pattern='.tif$')
> 
> s <- stack(files)
> r <- max(s)
> str(r)
> plot(r)
> 
> # Writing tiff file:
> 
> tr <- "L://MODIS_DATA//NDVI/max.tif"
> writeGDAL(r, tf, drivername="GTiff", options="TFW=YES")
> 
> "Error in function (classes, fdef, mtable)  :
>  unable to find an inherited method for function 'gridded' for signature '"RasterLayer"'"
> 
> 
> 
> 
> 
> From: romunov at gmail.com<mailto:romunov at gmail.com> [mailto:romunov at gmail.com] On Behalf Of Roman Lu?trik
> Sent: Friday, March 01, 2013 2:27 AM
> To: Zia Uddin Ahmed
> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> Subject: Re: [R-sig-Geo] Extract max. pixel value from a set geoTif raster image and create a new geoTIF image with these max values
> 
> Yes. You will also want to install rgdal, if you haven't already. You can read and write files with readOGR() and writeOGR(), while raster functions are quite intuitive to work with. See raster package vignette and drop us a line if you have any more questions.
> 
> Cheers,
> Roman
> 
> 
> On Fri, Mar 1, 2013 at 3:24 AM, Zia Uddin Ahmed <zua3 at cornell.edu<mailto:zua3 at cornell.edu>> wrote:
>       Dear list,
>       I like to  extract  max. pixel value from a set  geoTif raster image and create a new geoTIf  image  with these max values. Is it possible to do this with R "raster" package?
>       Thanks
>       Zia
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> --
> In God we trust, all others bring data.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From r.hijmans at gmail.com  Fri Mar  1 19:04:22 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 1 Mar 2013 10:04:22 -0800
Subject: [R-sig-Geo] project google map to Sinusoidal
In-Reply-To: <CD566421.3F37%rossahmed@gmail.com>
References: <CD566421.3F37%rossahmed@gmail.com>
Message-ID: <CANtt_hwEpf+K9S29PnuB1vigDcenLU5HxBU__+r+6KgULSO9jw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/8e90689a/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Mar  1 19:07:03 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 1 Mar 2013 18:07:03 +0000
Subject: [R-sig-Geo] Antw: project google map to Sinusoidal
In-Reply-To: <0ecf1db3dbcf4524bc6afa255492c648@EX-0-HT0.lancs.local>
References: <5130CC4C0200002700018ACC@gwia2.boku.ac.at>
	<0ecf1db3dbcf4524bc6afa255492c648@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMvHRdKKAUr914-FRDWa3osS5TAUfEoB=g_ruuEQCjr6Q@mail.gmail.com>

On Fri, Mar 1, 2013 at 4:17 PM, Ross Ahmed <rossahmed at googlemail.com> wrote:

> My plan is to draw a polygon around the boundary of each field, and
> calculate area of each field.

You haven't read the google maps terms and conditions, have you?

8. I?d like to trace a map using your imagery. Can I?

You may not use Google Maps or Google Earth as the basis for tracing
your own maps or other geographic content.

http://www.google.co.uk/permissions/geoguidelines.html

Barry


From me.kanth at gmail.com  Fri Mar  1 19:28:58 2013
From: me.kanth at gmail.com (Srikanth Sivashankaran)
Date: Fri, 1 Mar 2013 13:28:58 -0500
Subject: [R-sig-Geo] An r implementation for Bayesian Model
	Averaging/Selection of SAR/SEM models?
Message-ID: <CALZQ_ru-_tP2Y2kB+6gmGdrsLx7qWucZO3m+htBPyVJWCo37GQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130301/cf51279e/attachment.pl>

From smckay at rand.org  Sat Mar  2 02:16:54 2013
From: smckay at rand.org (Mckay, Shawn)
Date: Sat, 2 Mar 2013 01:16:54 +0000
Subject: [R-sig-Geo] segmentGoolgeMaps does not plot pie charts
Message-ID: <5D0948A37D1C384580C2C715171423C249DC36BE@smmb2.rand.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130302/1de572d6/attachment.pl>

From dan.strobridge at westonsolutions.com  Sat Mar  2 03:57:31 2013
From: dan.strobridge at westonsolutions.com (dan)
Date: Fri, 1 Mar 2013 18:57:31 -0800 (PST)
Subject: [R-sig-Geo] Spatial interpolation of river network observations
In-Reply-To: <4B02726D.4050002@Tudor.lu>
References: <4B02726D.4050002@Tudor.lu>
Message-ID: <1362193051026-7582932.post@n2.nabble.com>

Hi there.  I have a similar objective and request as Ulrich but am dealing
with hundreds of observations in groundwater.  

I've been using the EarthVisions software by Dynamic Graphics to generate 3D
conceptual models of contaminant plumes in groundwater for several years
now.  The software provides both a minimum tension algorithm (similar to a
thin-plate spline as far as I can tell) and an implementation of GSLIB's
KT3D.  Both can be used to generate crude estimates of contaminant
distribution that are acceptable for general remedial design considerations
but neither approach has ever generated what I would consider a truly
realistic looking plume.  This is not a slight on the software but instead
due to the fact that every site I've ever worked on involves a heterogeneous
aquifer that results in groundwater plumes that violate the assumption of
stationarity.  

I also perform groundwater modeling for some of the more complex sites and
have attempted to condition universal kriging implementations to the results
of groundwater simulations.  While these results have been slightly more
realistic looking, there is still a large amount of uncertainty associated
with them and most projects cannot afford the added expense of groundwater
flow and contaminant transport modeling.  I am hoping to simultaneously
improve the realism of my conceptual models, the geostatistical rigor of my
analysis, and to alleviate the need for transport modeling.

The tandem approach posed by Rivest and Marcotte, 2012 seems to me a very
reasonable one.  It entails 1) a coordinate transformation to warp the 3D
cartesian grid into a 3D space that describes the location of each grid cell
relative to one or more 3D flow lines (presumably derived through particle
tracking on a calibrated flow model), and 2) covariance functions that
relate observed groundwater concentrations to observations of groundwater
head.  In my case, the 3D head distribution would likely just be a 3D grid
interpolated from numerous water levels in wells completed at a variety of
depths and the flow lines would likely be coarsely digitized from the head
field and adjusted to account for places where the underlying geologic
framework model did not seem to be honored by the head distribution.

The problem is that I'm new to R and only have a couple graduate level
courses in geostatistics under my belt.  I've spent the entire day searching
this forum as well as crantastic for leads on how to accomplish either of
the two improvements to my workflow and haven't come up with much.  I've
bookmarked a couple links to R packages (eg. regress) that I believe will
help me develop the covariance functions but am not seeing anything
regarding tools that will allow me to perform complex 3D coordinate
transformations based on one or more 3D linestrings represents idealized
conceptual groundwater flowpaths.    

My primary question is whether any R packages exist that would enable me to
derive a 3D grid of "flow coordinates" based on multiple 3D line entities. 
I would certainly welcome any input as to packages for deriving the
covariance between concentration and head as well.

Thanks much,
Dan

Rivest, M. and D. Marcotte.  2012.  Kriging groundwater solute
concentrations using flow coordinates and nonstationary covariance
functions.  Journal of Hydrology.  Volumes 472-473. Pg. 238-253.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-interpolation-of-river-network-observations-tp4017573p7582932.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From famuvie at alumni.uv.es  Sat Mar  2 09:11:11 2013
From: famuvie at alumni.uv.es (=?windows-1252?Q?Facundo_Mu=F1oz?=)
Date: Sat, 2 Mar 2013 09:11:11 +0100
Subject: [R-sig-Geo] Spatial interpolation of river network observations
In-Reply-To: <D22E14BD0FC740D4A0D998A3C4591D4D@pcibed193>
References: <4B02726D.4050002@Tudor.lu>
	<D22E14BD0FC740D4A0D998A3C4591D4D@pcibed193>
Message-ID: <5131B41F.5090403@alumni.uv.es>

Hi Ultrich,

unfortunately, the approach Tom mentioned accounts for non-Euclidean 
distances, but not for downstream direction, as it asumes stationarity 
and *isotropy* with respect to the hydrologic distances.

In the line of Tom's suggestion, you might be interested in looking at 
the 'soap' R package for smooth interpolation in funny regions.

Bests
?acu.-

El 17/11/09 12:45, Tomislav Hengl escribi?:
> Hi Ultrich,
>
> Facundo Mu?oz apparently made a GRASS function to derive distances along streams:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2009-November/006851.html
>
> 17 observations only? That is really tight for any geostatistical analysis (on top, you want to do 3
> dimensions!). I would instead consider fitting a smooth surface (splines) / simulating the flow
> processes.
>
>
> all the best,
>
> T. Hengl
> http://home.medewerker.uva.nl/t.hengl/
>
>> -----Original Message-----
>> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf
>> Of Ulrich Leopold
>> Sent: Tuesday, November 17, 2009 10:53 AM
>> To: R-sig-geo list; grass-user at lists.osgeo.org
>> Subject: [R-sig-Geo] Spatial interpolation of river network observations
>>
>> Dear all,
>>
>> I would like to interpolate 17 pollution observations in a storage lake
>> in 3 dimensions (x,y,z).
>>
>> As I understand variogram analysis and kriging are not straightforward
>> as we are dealing with non-euclidean (hydrologic) distances and
>> down-stream direction.
>>
>> Could someone point me to some algorithms which can roughly estimate the
>> 3d pollution body accounting for hydrologic distances?
>>
>> Attached is a file which shows the sampling locations and the storage lake.
>>
>> Thanks very much.
>>
>> Best regards,
>> Ulrich
>>
>>
>> --
>> ______________________________________________________________________
>>
>> Ulrich Leopold
>>
>> Resource Centre for Environmental Technologies, Public Research Centre
>> Henri Tudor, Technoport Schlassgoart, 66 rue de Luxembourg, P.O. BOX
>> 144, L-4002 Esch-sur-Alzette, Luxembourg
>>
>> tel: +352 42 5591 618
>> fax: +352 42 5591 555
>> mobile: +352 691 304813
>> http://www.crte.lu , http://www.tudor.lu
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From matteo.mattiuzzi at boku.ac.at  Sat Mar  2 19:00:10 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Sat, 02 Mar 2013 19:00:10 +0100
Subject: [R-sig-Geo] Antw: Re:  project google map to Sinusoidal
Message-ID: <51324C3A0200002700018B25@gwia2.boku.ac.at>

Hi,
Robert is right, obeyRes is not required as the function res() does exactly what obeyRes was tought for...
I wrote that function because I had to create rasters with a given resolution to fit as good as possible into a given extent and I was trying to do that with raster() that has no "res" argument + obeyRes. So obeyRes was calculation the available ncol/nrow argument in raster()!
But rasterExtent + res() does the job perfectly!
Thanks Matteo




>>> "Robert J. Hijmans"  01.03.13 19.05 Uhr >>>
There is some confusion here:
To get a google map in a sinusoidial projection you can do

library(dismo)
# extent
e <- extent(c(-1.87710, -1.772096, 55.61399, 55.682171))
# google map
g <- gmap(e, type='hybrid')
#projection
prj <- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181
+units=m +no_defs"
# project
s1 <- projectRaster(g, crs=prj)
# done



# for more control
# create empty raster
r <- raster(ext=e,crs="+proj=longlat +ellps=WGS84 +datum=WGS84")
# project extent
r <- projectExtent(r,crs=prj)
# set resolution to desired value
# your value of 1000 seemed too large here.
# I do not think you should obeyRes here
# (I am not sure what it is useful for)
res(r) <- 100
# project
s2 <- projectRaster(g, r)


Hope this clarifies.
Robert

On Fri, Mar 1, 2013 at 5:56 AM, Ross Ahmed  wrote:

> Hi all
>
> I have this raster:
>
> myExtent <- extent(c(-1.87710, -1.772096, 55.61399, 55.682171))
> r <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84 +datum=WGS84")
>
> Ive projected the raster to an equal area projection (Sinusoidal):
>
> myRaster <- projectExtent(r,crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0
> +a=6371007.181 +b=6371007.181 +units=m +no_defs")
>
> Using the obeyRes function kindly given to me by Matteo Mattiuzzi
> (
> https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130224/3247ffd4/atta
> chment.pl), I made each cell in the raster 1km^2:
>
> res1km <- obeyRes(extent(myRaster),resolution=sqrt(1)*1000)
> myRaster1km <- raster(ext=res1km$extent,ncol=res1km$cols,nrows=res1km$rows,
>                       crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
> +b=6371007.181 +units=m +no_defs")
>
> I've downloaded a google map with long/lat projection:
>
> g <- gmap(myExtent, type='hybrid', interpolate=T, lonlat=T)
>
> I'm now trying to project the google map using Sinusoidal (ie, same as
> myRaster1km). I've two functions:
>
> gg <- projectRaster(g, CRS("+proj=sinu +lon_0=0 +x_0=0 +y_0=0
> +a=6371007.181
> +b=6371007.181 +units=m +no_defs"))
> gg <- projectExtent(g,crs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
> +b=6371007.181 +units=m +no_defs")
>
> How can I plot the google map using Sinusoidal? Ultimately, my aim is 1.
> plot gg 2. plot the myRaster1km over gg 3. draw polygons in each cell of
> the
> myRaster1km and have R recognise which cell I'm drawing in.
>
> Once again, many thanks for help in advance and apologies for any
> ignorance.
>
> Ross
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jminming at yahoo.com  Sun Mar  3 09:05:34 2013
From: jminming at yahoo.com (Jin Minming)
Date: Sun, 3 Mar 2013 08:05:34 +0000 (GMT)
Subject: [R-sig-Geo] Jin Minming
Message-ID: <1362297934.37963.YahooMailNeo@web171706.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130303/8f595b96/attachment.pl>

From senator at ecotoxicology.de  Sun Mar  3 09:19:45 2013
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Sun, 3 Mar 2013 09:19:45 +0100
Subject: [R-sig-Geo] DAAD Summer School Spatial Ecotoxicology
Message-ID: <93205AF1-14A0-4E2C-A811-D74D8621892E@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130303/97dd996c/attachment.pl>

From lucasantini85 at hotmail.com  Sun Mar  3 12:09:14 2013
From: lucasantini85 at hotmail.com (Oritteropus)
Date: Sun, 3 Mar 2013 03:09:14 -0800 (PST)
Subject: [R-sig-Geo] Distance calculation
Message-ID: <1362308954485-7582941.post@n2.nabble.com>

Hi all, 

I intend to use gDistance function in rgeos package to measure the distance
among a large number of polygons (at various latitudes) in a vector map, to
a maximum distance of 1000 km in various directions.
It works rapidly compared to other methods but I have a few doubts about it:

1) Is the distance calculated corrected for the projection used? If not,
would the error be relevant at a scale of 1000 km? To what extent?
 Which projection would you suggest to reduce the error?

2) Is there any other function running in latlong and giving the corrected
geodesic distance?

3) My second problem is that gDistance calculate straight line distance,
however what I need is the distance through the dry lands. e.g. the distance
between a polygon in Italy and one in Greece should be calculated through
the dry lands, not through the sea. Is there any way to do this in a vector
function? Otherwise, should I use a different function combining vector and
raster maps?


Any suggestion would be greatly appreciated, thank you in advance!

Luca



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Distance-calculation-tp7582941.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From kathryn.lee1 at students.mq.edu.au  Mon Mar  4 04:27:43 2013
From: kathryn.lee1 at students.mq.edu.au (kalee)
Date: Sun, 3 Mar 2013 19:27:43 -0800 (PST)
Subject: [R-sig-Geo] for loop with kde (ks package) function not working
Message-ID: <1362367662813-7582943.post@n2.nabble.com>

Hi all,

I am trying to run a for loop 1000 times to randomly sample spatial points
and then pass these coordinates to the kde function in the 'ks' package.
When I look at the output from the random selection of points that code
seems to be working fine (i.e. each iteration of the for loop produces
different values). However, when I look at the results from the kde function
the first two outputs are different and then each iteration after that just
produces the exact same values. I've posted a simplified example of my code
(simulating data instead of running through the random selection process)
but it produces the same errors when I look at the results. I'm sure I'm
missing something really obvious I'm just not sure where to look. 

Many thanks

Code:

library(ks)

setwd("/Users/kalee/Documents/Feb 2013/")

for (i in 1:5 ) {

x <- sample(-300:250, 100, replace = TRUE)
y <- sample(-30:50, 100, replace = TRUE)

xy <- cbind(x, y)

ID <- sample(1:22, 100, replace = TRUE)


dat <- as.data.frame(cbind(ID, xy))


set.seed(8192)
dat$X2 <- jitter(dat$x)
dat$Y2 <- jitter(dat$y)



idh <- split(dat, list(dat$ID), drop = TRUE)
y <- lapply(idh, "[", c('X2','Y2')) 
x <- Filter(function (t) nrow(unique(t)) > 5, y)

myfun1<- function(x, k) {
     H.s <- Hpi(x[[k]], binned = TRUE)
     KDE <- kde(x[[k]], H=H.s, binned = TRUE)
     cont <- contourSizes(KDE, cont = c(95), approx = TRUE)
     return(cont)
  }


  results95 <- rep(0, length(unique(x)))
  for (j in 1:length(results95)) results95[j] <- myfun1(x, j)

  z <- as.matrix(x)
  m <- dimnames(z)
  l <-list(m[[1]], results95)

  write.csv(l, file = paste("blues_function test",i,".csv"))
}

Example of results:

Iteration 1:

1	1	22659.13004
2	2	26688.41093
3	3	19403.62449
4	4	26710.38738
5	9	18968.71687
6	11	31870.62336
7	19	11019.08475
8	22	4163.867828


Iteration 2:

1	3	34613.00041
2	4	32962.57106
3	8	21379.64701
4	12	29499.05166
5	14	12065.95155
6	16	26973.81732
7	18	23929.58449

Iteration 3 onwards:

1	3	34613.00041
2	4	32962.57106
3	8	21379.64701
4	12	29499.05166
5	14	12065.95155
6	16	26973.81732
7	18	23929.58449




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/for-loop-with-kde-ks-package-function-not-working-tp7582943.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From forrest at ufl.edu  Mon Mar  4 06:50:31 2013
From: forrest at ufl.edu (Forrest Stevens)
Date: Mon, 4 Mar 2013 00:50:31 -0500
Subject: [R-sig-Geo] for loop with kde (ks package) function not working
In-Reply-To: <1362367662813-7582943.post@n2.nabble.com>
References: <1362367662813-7582943.post@n2.nabble.com>
Message-ID: <CAEBQMMmQAbo-9zUC2mAPzhKYZsuk69CxEV1HtEeGjNpu859mNQ@mail.gmail.com>

> I am trying to run a for loop 1000 times to randomly sample spatial points
...
> different values). However, when I look at the results from the kde function
> the first two outputs are different and then each iteration after that just
> produces the exact same values.

Hi Kathryn, I believe the problem you're facing is that you are
setting the random seed each time through your loop, which effectively
resets the random number generation to the same point, and therefore
duplicates your random sample each time.  The key is to move the
set.seed() call outside your for() loop.

Hopefully that solves it for you,
Forrest

> Code:
>
> library(ks)
>
> setwd("/Users/kalee/Documents/Feb 2013/")
> set.seed(8192)
>
> for (i in 1:5 ) {
>
> x <- sample(-300:250, 100, replace = TRUE)
> y <- sample(-30:50, 100, replace = TRUE)
>
> xy <- cbind(x, y)
>
> ID <- sample(1:22, 100, replace = TRUE)
>
>
> dat <- as.data.frame(cbind(ID, xy))
>
>
> dat$X2 <- jitter(dat$x)
> dat$Y2 <- jitter(dat$y)
>
>
>
> idh <- split(dat, list(dat$ID), drop = TRUE)
> y <- lapply(idh, "[", c('X2','Y2'))
> x <- Filter(function (t) nrow(unique(t)) > 5, y)
>
> myfun1<- function(x, k) {
>      H.s <- Hpi(x[[k]], binned = TRUE)
>      KDE <- kde(x[[k]], H=H.s, binned = TRUE)
>      cont <- contourSizes(KDE, cont = c(95), approx = TRUE)
>      return(cont)
>   }
>
>
>   results95 <- rep(0, length(unique(x)))
>   for (j in 1:length(results95)) results95[j] <- myfun1(x, j)
>
>   z <- as.matrix(x)
>   m <- dimnames(z)
>   l <-list(m[[1]], results95)
>
>   write.csv(l, file = paste("blues_function test",i,".csv"))
> }

-- 
Ph.D. Candidate, QSE3 IGERT Fellow
Department of Geography
Land Use and Environmental Change Institute
University of Florida
www.clas.ufl.edu/users/forrest


From milan.kili11 at gmail.com  Mon Mar  4 07:38:02 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Mon, 4 Mar 2013 07:38:02 +0100
Subject: [R-sig-Geo] segmentGoolgeMaps does not plot pie charts
In-Reply-To: <CAPSaU--KE_VpjM34RM0ZtHv+Da9-VhpxR4dKPt7p2t3SrBuaHQ@mail.gmail.com>
References: <5D0948A37D1C384580C2C715171423C249DC36BE@smmb2.rand.org>
	<CAPSaU--KE_VpjM34RM0ZtHv+Da9-VhpxR4dKPt7p2t3SrBuaHQ@mail.gmail.com>
Message-ID: <CAPSaU-9Uh_s0axRqfWB1hyOOuLOCRqRH3WZLsNMmbWdY1X3r1w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130304/b1c24b29/attachment.pl>

From mathieu.rajerison at gmail.com  Mon Mar  4 11:33:19 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 4 Mar 2013 11:33:19 +0100
Subject: [R-sig-Geo] Spatial points to lines/polygons
In-Reply-To: <511977D0.4090307@gmail.com>
References: <511977D0.4090307@gmail.com>
Message-ID: <CAGfc75m+tQ5iBRqQrih3mpZKpTg4s6R3h+yVcDAWLB1mxGpgSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130304/2133bc49/attachment.pl>

From rossahmed at googlemail.com  Mon Mar  4 15:09:10 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Mon, 4 Mar 2013 14:09:10 +0000
Subject: [R-sig-Geo] Antw: project google map to Sinusoidal
In-Reply-To: <CANVKczMvHRdKKAUr914-FRDWa3osS5TAUfEoB=g_ruuEQCjr6Q@mail.gmail.com>
References: <5130CC4C0200002700018ACC@gwia2.boku.ac.at>
	<0ecf1db3dbcf4524bc6afa255492c648@EX-0-HT0.lancs.local>
	<CANVKczMvHRdKKAUr914-FRDWa3osS5TAUfEoB=g_ruuEQCjr6Q@mail.gmail.com>
Message-ID: <C88105AC-29D7-4957-B173-D9F2F5448A79@gmail.com>

So I intend to take measurements, not make maps, using Google maps. Is this still against their policy?

If this is still a problem, are there alternatives to google maps that can be used in R or a GIS?

Thanks
Ross

On 1 Mar 2013, at 18:07, Barry Rowlingson <b.rowlingson at lancaster.ac.uk> wrote:

> On Fri, Mar 1, 2013 at 4:17 PM, Ross Ahmed <rossahmed at googlemail.com> wrote:
> 
>> My plan is to draw a polygon around the boundary of each field, and
>> calculate area of each field.
> 
> You haven't read the google maps terms and conditions, have you?
> 
> 8. I?d like to trace a map using your imagery. Can I?
> 
> You may not use Google Maps or Google Earth as the basis for tracing
> your own maps or other geographic content.
> 
> http://www.google.co.uk/permissions/geoguidelines.html
> 
> Barry


From b.rowlingson at lancaster.ac.uk  Mon Mar  4 16:14:16 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 4 Mar 2013 15:14:16 +0000
Subject: [R-sig-Geo] Antw: project google map to Sinusoidal
In-Reply-To: <0a0f0ed080da4c4bbb60b7108fcf763a@EX-0-HT0.lancs.local>
References: <5130CC4C0200002700018ACC@gwia2.boku.ac.at>
	<0ecf1db3dbcf4524bc6afa255492c648@EX-0-HT0.lancs.local>
	<CANVKczMvHRdKKAUr914-FRDWa3osS5TAUfEoB=g_ruuEQCjr6Q@mail.gmail.com>
	<0a0f0ed080da4c4bbb60b7108fcf763a@EX-0-HT0.lancs.local>
Message-ID: <CANVKczNCBLfT9HhcSP+d2=Qh-V3jUHPX52opAbq_YF9bhV+AfQ@mail.gmail.com>

On Mon, Mar 4, 2013 at 2:09 PM, Ross Ahmed <rossahmed at googlemail.com> wrote:
> So I intend to take measurements, not make maps, using Google maps. Is this still against their policy?
>
> If this is still a problem, are there alternatives to google maps that can be used in R or a GIS?

 That could be a big grey area. I think you'll have to resolve this
between yourself, your conscience, and possibly some lawyers...

 The OpenStreetMap project have discovered they can use Yahoo Aerial
Imagery for tracing, so I assume you can use that but I think the
coverage and resolution is not as good as Google's.

Barry


From ppanday at clarku.edu  Mon Mar  4 20:12:00 2013
From: ppanday at clarku.edu (ppanday)
Date: Mon, 4 Mar 2013 11:12:00 -0800 (PST)
Subject: [R-sig-Geo] Aggregate within another grid extent
Message-ID: <1362424319951-7582952.post@n2.nabble.com>

Hello

I have a rasterbrick with MODIS 1km pixels for an study region. How do I
aggregate all the MODIS pixels that fall within another raster layer with
0.5 degree resolution and take the average time series? There are not
necessarily the same number of MODIS pixels within the 0.5 grid.

Thanks,
Prajjwal



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Aggregate-within-another-grid-extent-tp7582952.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Mon Mar  4 20:24:38 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 4 Mar 2013 11:24:38 -0800
Subject: [R-sig-Geo] Aggregate within another grid extent
In-Reply-To: <1362424319951-7582952.post@n2.nabble.com>
References: <1362424319951-7582952.post@n2.nabble.com>
Message-ID: <CANtt_hx1is7E2Nev1fnNtu8wwuVq2anuiyGan++Tbp_23WvyYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130304/3348a2cf/attachment.pl>

From joshmobrien at gmail.com  Mon Mar  4 21:35:07 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Mon, 4 Mar 2013 12:35:07 -0800
Subject: [R-sig-Geo] raster::crop() can fail when cropped region is too
 large to process in memory.
Message-ID: <CAOwKfPRHYZcXKGesN5DK4up7qcu466uskNH7c-=h4ic6ts=5Gw@mail.gmail.com>

Hi all,

The raster package function crop() can fail for certain sufficiently
large cropping extents (in terms of number of rows and columns needing
to be extracted).

The raster I'd like to crop is stored on the disk (i.e. fromDisk(r)
--> TRUE) and I'm writing the results to a file: the problem seems to
be that the 'canProcessFromMemory' test in the crop() function is not
conservative enough.  (To see the statement I'm referring to, do
'getMethod("crop", signature="Raster") and look for the if/then block
beginning "if (canProcessInMemory(out, 3)) {"

Here is an example that's reproducible on my 32-bit Windows XP
machine, running the current R-devel and raster package version
2.0.41. Do be aware that the first step -- creating a large example
raster -- may take several (up to 10?) minutes:

###############################################

## (1) In one R session create a large raster and save it to disk
library(raster)
r <- raster(ncol=4502, nrow=5738)
r[] <- 1:length(r)
writeRaster(r, filename="bigRast")

## (2) Then, from another clean R session in the same directory
library(raster)
r <- raster("bigRast")
E <- extent(c(-179, 179, -89, 89))
crop(r, E, filename="smallerRast")
## Error: cannot allocate vector of size 193.8 Mb

###############################################

My temporary fix has been to use trace() to edit crop's "Raster"
method so that it writes in blocks whenever canProcessInMemory(out,
10) is FALSE. That's obviously overkill, but it does work.

Unless I'm missing something, this is basically a bug report, though
I'd be happy to learn of any other better workarounds.

Cheers,

Josh


From brigittehogan at gmail.com  Tue Mar  5 01:18:06 2013
From: brigittehogan at gmail.com (Brigitte Hogan)
Date: Mon, 4 Mar 2013 19:18:06 -0500
Subject: [R-sig-Geo] Kcross and envelope
Message-ID: <CAKMbqgCkGTYsXoEHhYVgUh_-x_mq1sPV4GL210qE0nbtDVwXyA@mail.gmail.com>

Hi All,

I have run into an unexpected outcome using Kcross() and envelope()
that  I hope someone can explain.  My question is, why does envelope()
produce different curves when no edge correction is specified and when
correction is set as "none"? I would expect these curves to be closely
the same, if not identical. For example:

library(spatstat)
data(lansing)
x <- lansing
Kx.en1 <- envelope(unique(x), fun=Kcross, nsim=99, nrank=2)
Kx.en2 <- envelope(unique(x), fun=Kcross, nsim=99, nrank=2, correction="none")
par(mfrow=c(1,2))
plot(Kx.en1)
plot(Kx.en2)

I am also puzzled why the red theoretical line leaves the envelope in
the second plot. I thought that the hi and lo values always bound the
theoretical. The help file (?envelope) does not give a default for
'correction', but says a border correction can be passed to the
function fun using ... . That makes me think there is no 'default' for
border correction in envelope - am I  mistaken?

A related question is why using envelope to calculate Kcross does not
give the same result for the 'obs' line as using a simple Kcross with
'correction="none"'.

Kx.data <- Kcross(x, correction=c("none", "border"))
Kx.en <- envelope(x, fun=Kcross, nrank=2, nsim=99)
par(mfrow=c(1,1))
plot(Kx.en, legend=NULL, main="")
plot(Kx.data, cbind(border,un)~r, col=c("blue","black"), lty=c(1,1),
	lwd=2, legend=TRUE, legendmath=FALSE, add=TRUE)

With these two plots. I was expecting the 'un' line in the second plot
(thick black line) to be the same as the 'obs' line in the first (thin
black line).

Thank you in advance for the help.


Brigitte


From r.turner at auckland.ac.nz  Tue Mar  5 03:19:24 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 05 Mar 2013 15:19:24 +1300
Subject: [R-sig-Geo] Kcross and envelope
In-Reply-To: <CAKMbqgCkGTYsXoEHhYVgUh_-x_mq1sPV4GL210qE0nbtDVwXyA@mail.gmail.com>
References: <CAKMbqgCkGTYsXoEHhYVgUh_-x_mq1sPV4GL210qE0nbtDVwXyA@mail.gmail.com>
Message-ID: <5135562C.80200@auckland.ac.nz>


Thank you for your interest in "spatstat" and for your clearly expressed
questions.

Please see in-line below.

On 03/05/2013 01:18 PM, Brigitte Hogan wrote:
> Hi All,
>
> I have run into an unexpected outcome using Kcross() and envelope()
> that  I hope someone can explain.  My question is, why does envelope()
> produce different curves when no edge correction is specified and when
> correction is set as "none"? I would expect these curves to be closely
> the same, if not identical.
     See below.
> For example:
>
> library(spatstat)
> data(lansing)
> x <- lansing
> Kx.en1 <- envelope(unique(x), fun=Kcross, nsim=99, nrank=2)
> Kx.en2 <- envelope(unique(x), fun=Kcross, nsim=99, nrank=2, correction="none")
> par(mfrow=c(1,2))
> plot(Kx.en1)
> plot(Kx.en2)
>
> I am also puzzled why the red theoretical line leaves the envelope in
> the second plot. I thought that the hi and lo values always bound the
> theoretical.
     Well, that's not *quite* correct.  It depends on the nature of the
     "simulate" argument.  Here however, with simulate unspecified,
     the simulations are done under CSR so the estimates of Kcross
     used to form the envelope all have expected value pi*r^2.

     What you are seeing is simply the strong biasing effect of failing
     to make an edge correction.  You can observe the same phenomenon
     with a simple K function estimate.  E.g.:

     set.seed(42)
     X <- rpoispp(800)
     E <- envelope(X,correction="none")
     plot(E)
> The help file (?envelope) does not give a default for
> 'correction', but says a border correction can be passed to the
> function fun using ... . That makes me think there is no 'default' for
> border correction in envelope - am I  mistaken?
     Well, yes.  The envelope() function actually uses the "best" edge 
correction by
     default, although this fact is not explicitly stated in the help 
for envelope().  The
     "best" edge correction (to quote from the help for Kest())
> Selects the best edge correction that is available for the geometry of 
> the window. Currently this is Ripley's isotropic correction for a 
> rectangular or polygonal window, and the translation correction for 
> masks. 
     Since the lansing data set has a rectangular window, envelope() 
will use the isotropic
     edge correction by default in the example you use.

     We will try to clarify this issue in the help for envelope() in a 
future release
     of spatstat.
> A related question is why using envelope to calculate Kcross does not
> give the same result for the 'obs' line as using a simple Kcross with
> 'correction="none"'.
>
> Kx.data <- Kcross(x, correction=c("none", "border"))
> Kx.en <- envelope(x, fun=Kcross, nrank=2, nsim=99)
> par(mfrow=c(1,1))
> plot(Kx.en, legend=NULL, main="")
> plot(Kx.data, cbind(border,un)~r, col=c("blue","black"), lty=c(1,1),
> 	lwd=2, legend=TRUE, legendmath=FALSE, add=TRUE)
>
> With these two plots. I was expecting the 'un' line in the second plot
> (thick black line) to be the same as the 'obs' line in the first (thin
> black line).
     The answer is the same; envelope() is using the isotropic edge 
correction
     here, since no correction was specified.

         cheers,

             Rolf Turner


From r.hijmans at gmail.com  Tue Mar  5 07:41:46 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 4 Mar 2013 22:41:46 -0800
Subject: [R-sig-Geo] raster::crop() can fail when cropped region is too
 large to process in memory.
In-Reply-To: <CAOwKfPRHYZcXKGesN5DK4up7qcu466uskNH7c-=h4ic6ts=5Gw@mail.gmail.com>
References: <CAOwKfPRHYZcXKGesN5DK4up7qcu466uskNH7c-=h4ic6ts=5Gw@mail.gmail.com>
Message-ID: <CANtt_hxghW-jHLzo0=fvM4L=-mHhXT4zHiFY3UJetSKh_3E8SA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130304/c4fddec8/attachment.pl>

From HodgessE at uhd.edu  Tue Mar  5 08:21:58 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 5 Mar 2013 07:21:58 +0000
Subject: [R-sig-Geo] stplot question
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/ac34a172/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Mar  5 09:12:56 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 05 Mar 2013 09:12:56 +0100
Subject: [R-sig-Geo] stplot question
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>
Message-ID: <5135A908.7020100@uni-muenster.de>

Erin, See the help of xyplot in package lattice, in particular argument
layout.

On 03/05/2013 08:21 AM, Hodgess, Erin wrote:
> Hello!
> 
> I have a spatio-temporal data set with 23 cities and 11 years of annual data.
> 
> I have made it through krigeST without any problem.
> 
> I use stplot and it works fine.  It puts all of the plots on one page.
> 
> My question:  is there a way to have each of the stplots on separate pages, please?
> 
> Thanks,
> Erin
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From HodgessE at uhd.edu  Tue Mar  5 09:39:53 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 5 Mar 2013 08:39:53 +0000
Subject: [R-sig-Geo] stplot question
In-Reply-To: <5135A908.7020100@uni-muenster.de>
References: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>,
	<5135A908.7020100@uni-muenster.de>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292EE45@challenger.uhd.campus>

Thank you!

I have:

stplot(kr3, layout=c(0,11))

Now, of course, one more thing, please:  the plots run one after another.  Is there a way to do one at a time, please?  My ideal is to have 11 png files.

Thanks again,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Edzer Pebesma [edzer.pebesma at uni-muenster.de]
Sent: Tuesday, March 05, 2013 2:12 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] stplot question

Erin, See the help of xyplot in package lattice, in particular argument
layout.

On 03/05/2013 08:21 AM, Hodgess, Erin wrote:
> Hello!
>
> I have a spatio-temporal data set with 23 cities and 11 years of annual data.
>
> I have made it through krigeST without any problem.
>
> I use stplot and it works fine.  It puts all of the plots on one page.
>
> My question:  is there a way to have each of the stplots on separate pages, please?
>
> Thanks,
> Erin
>
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Tue Mar  5 10:00:53 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 05 Mar 2013 10:00:53 +0100
Subject: [R-sig-Geo] stplot question
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021292EE45@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>,
	<5135A908.7020100@uni-muenster.de>
	<FF9DB805FC41CC4E95825A50F68063021292EE45@challenger.uhd.campus>
Message-ID: <5135B445.2060209@uni-muenster.de>

Erin, if you don't specify the filename argument of the png file but
leave it to the default value, you will end up with

Rplot001.png
Rplot002.png
...
Rplot011.png

See how the default is constructed to understand how you can modify this
to your taste.

On 03/05/2013 09:39 AM, Hodgess, Erin wrote:
> Thank you!
> 
> I have:
> 
> stplot(kr3, layout=c(0,11))
> 
> Now, of course, one more thing, please:  the plots run one after another.  Is there a way to do one at a time, please?  My ideal is to have 11 png files.
> 
> Thanks again,
> Erin
> 
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Edzer Pebesma [edzer.pebesma at uni-muenster.de]
> Sent: Tuesday, March 05, 2013 2:12 AM
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] stplot question
> 
> Erin, See the help of xyplot in package lattice, in particular argument
> layout.
> 
> On 03/05/2013 08:21 AM, Hodgess, Erin wrote:
>> Hello!
>>
>> I have a spatio-temporal data set with 23 cities and 11 years of annual data.
>>
>> I have made it through krigeST without any problem.
>>
>> I use stplot and it works fine.  It puts all of the plots on one page.
>>
>> My question:  is there a way to have each of the stplots on separate pages, please?
>>
>> Thanks,
>> Erin
>>
>>
>>       [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From s.meyer at lmu.de  Tue Mar  5 11:24:51 2013
From: s.meyer at lmu.de (Swen Meyer)
Date: Tue, 05 Mar 2013 11:24:51 +0100
Subject: [R-sig-Geo] Transform 2or 3 raster with texture information in soil
 triangle classes.
In-Reply-To: <5135B445.2060209@uni-muenster.de>
References: <FF9DB805FC41CC4E95825A50F68063021292ED7B@challenger.uhd.campus>,
	<5135A908.7020100@uni-muenster.de>
	<FF9DB805FC41CC4E95825A50F68063021292EE45@challenger.uhd.campus>
	<5135B445.2060209@uni-muenster.de>
Message-ID: <5135C7F3.7010402@lmu.de>

Dear All,
does anyone maybe know a R script or a software tool that transforms a 
set of texture rasters (sand , silt , caly) into one classified raster 
according the German triangle ??Bodenkundliche Kartieranleitung 1994. I 
know that SAGA GIS does have such a function but I think the results are 
classified according the USDA classification.
Thank you in advance,
Swen


From fabian.ries at hydrology.uni-freiburg.de  Tue Mar  5 14:32:47 2013
From: fabian.ries at hydrology.uni-freiburg.de (Fabian Ries)
Date: Tue, 05 Mar 2013 14:32:47 +0100
Subject: [R-sig-Geo] Spatial interpolation of rainfall timeseries with e.g.
	spacetime
Message-ID: <CD5BB28F.8FAE%fabian.ries@hydrology.uni-freiburg.de>

Dear all,

I work on rainfall-runoff processes in a semi-arid area. I have time
series of about 15 rainfall stations within a small area (300 sqkm) and
want to perform spatial interpolation (idw or kriging) on a 5min-timestep.
Runoff processes respond in my research area often to short peaks of
rainfall intensity - therefore I need to work on this short time
intervals. 

First I would like to perform spatial interpolation on a 5 min time step
but exclude time intervals with no rain so I receive a data set with about
5000 time steps for a single year.
Second I want to build sums of hourly, daily, monthly and yearly rainfall
on a grid base to apply water balance calculations.
Finally I want to create a regular time series of mean rainfall over my
watersheds on the 5 min time steps by the use of spatial polygons.

In the beginning I tried to realize simple IDW interpolation considering
the time steps with rainfall in a for-loop but I get stuck in the
aggregation step for hourly, daily, ... rainfall because of the time gaps
in my data deleting the no rain time steps.
Then I found the package spacetime which seems to offer exactly the
functionality I need. Following the Ireland wind example I could not
understand how to modify the example with kriging using simple IDW method.
Can someone give me a hint how to apply IDW over a spatial time series?

I had also problems applying extract(grid, raster, fun=mean) on
spatialpolygonsdataframe and spatialgriddataframe. Is it only working for
the class spatialpolygons?
I import my polygons by using readOGR(?) and the raster by
read.asciigrid(?).

The rainfall data I use has the following format:

Station	Station01	Station02	Station03	Station04	Station05	Station06	Station
07	Station08	Station09
PosX	180000	195900	181950	192150	179550	176750	182950	170400	173100
PosY	157550	150950	154550	141650	154700	157050	158450	147800	133500
01.03.2012 00:05	0	0	0	0	0	0	0.0	0.2	0.2
01.03.2012 00:10	0	0	0	0	0	0	0.0	0	0.1
01.03.2012 00:15	0	0	0	0	0	0	0.0	0.4	0.1
01.03.2012 00:20	0.2	0	0	0	0.2	0	0.0	0.2	0.1
01.03.2012 00:25	0.2	0	0.2	0	0.4	0.4	0.2	0.4	0.1
01.03.2012 00:30	0	0	0.4	0	0.4	0.2	0.4	0.6	0.1
01.03.2012 00:35	0.2	0	0.2	0	0.2	0.2	0.2	0.6	0.1
01.03.2012 00:40	0.2	0	0.2	0	0.4	0.2	0.2	0.8	0.0
01.03.2012 00:45	0	0	0.4	0	0.4	0.4	0.4	0.4	0.0
01.03.2012 00:50	0.2	0	0.4	0	0.2	0.2	0.4	0.2	0.0
01.03.2012 00:55	0.2	0	0	0	0.6	0.2	0.0	0.2	0.0
01.03.2012 01:00	0	0	0.4	0	0.2	0.2	0.4	0.2	0.1
01.03.2012 01:05	0.2	0	0.2	0	0.2	0.2	0.2	0	0.1
01.03.2012 01:10	0.2	0	0.2	0	0.2	0.2	0.2	0	0.0
01.03.2012 01:15	0	0	0	0	0.2	0.4	0.0	0	0.0
01.03.2012 01:20	0	0	0.2	0	0	0	0.2	0	0.0
01.03.2012 01:25	0	0	0	0	0.2	0.2	0.0	0	0.0
01.03.2012 01:30	0	0	0	0	0	0	0.0	0	0.0
01.03.2012 01:35	0.2	0	0	0	0	0	0.0	0	0.0
01.03.2012 01:40	0	0	0	0	0	0	0.0	0	0.0
01.03.2012 01:45	0	0	0	0	0	0	0.0	0	0.0
01.03.2012 01:50	0	0	0	0	0	0	0.0	0	0.0
01.03.2012 01:55	0	0	0	0	0	0	0.0	0	0.0
01.03.2012 02:00	0	0	0	0	0	0	0.0	0	0.0


Any help is kindly appreciated.
Best regards
Fabian


From shoebodh at gmail.com  Tue Mar  5 15:36:13 2013
From: shoebodh at gmail.com (Subodh Acharya)
Date: Tue, 5 Mar 2013 09:36:13 -0500
Subject: [R-sig-Geo] Directional correlograms
Message-ID: <CAFu8PB+autM_DNqFXp1KcpN8SNvOVQW9KadU3T3AXGgZctxt2w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/d2527f80/attachment.pl>

From swagathnavin82 at gmail.com  Tue Mar  5 16:17:04 2013
From: swagathnavin82 at gmail.com (Swagath Navin)
Date: Tue, 05 Mar 2013 16:17:04 +0100
Subject: [R-sig-Geo] creating a SGDF with transformed coordinates and
	spatial aggregation
Message-ID: <51360C70.7050401@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/f8fc712e/attachment.pl>

From swagathnavin82 at gmail.com  Tue Mar  5 16:38:49 2013
From: swagathnavin82 at gmail.com (Swagath Navin)
Date: Tue, 05 Mar 2013 16:38:49 +0100
Subject: [R-sig-Geo] creating a SGDF with transformed coordinates and
	spatial aggregation
In-Reply-To: <mailman.9.1362049203.8316.r-sig-geo@r-project.org>
References: <mailman.9.1362049203.8316.r-sig-geo@r-project.org>
Message-ID: <51361189.4070403@gmail.com>

Sorry..i am resending my mail again ..first mail i sent as HTML format
Dear all,

I have a large data frame in form of (Lon, Lat, Value) ((coordinates in 
EPSG:3035). I can convert the data frame into a object of class SGDF 
using the following commands:

coordinates(df)=~x+y
proj4string(df)=CRS("+init=epsg:3035")
gridded(pts) = TRUE
fullgrid(pts)=TRUE

getGridTopology(df)

                      x       y
cellcentre.offset 2638500 1430500
cellsize             5000    5000
cells.dim             664     797

However, when i transform the coordinates to EPSG:4326 and then try to 
convert it to a SGDF, i get the following error:

coordinates(df)=~x+y
proj4string(df)=CRS("+init=epsg:3035")
pts = spTransform(df,CRS("+init=epsg:4326"))
gridded(df) = TRUE

suggested tolerance minimum: 0.154774
Error in points2grid(points, tolerance, round) :
   dimension 1 : coordinate intervals are not constant

Any ideas, how i can obtain a regular grid.

And off-course a reproducible example:

x=c(5013500, 5018500, 4883500, 4888500, 4893500, 4898500, 4908500, 
4948500, 4953500, 4958500, 4963500, 4973500, 4978500, 4988500, 5008500, 
5013500, 5028500, 4878500, 4883500, 4888500, 4893500, 4898500, 4903500, 
4928500, 4963500, 4968500, 4973500, 4978500, 4983500, 4988500)

y=c(5395500, 5395500, 5390500, 5390500, 5390500, 5390500, 5390500, 
5390500, 5390500, 5390500, 5390500, 5390500, 5390500, 5390500, 5390500, 
5390500, 5390500, 5385500, 5385500, 5385500, 5385500, 5385500, 5385500, 
5385500, 5385500, 5385500, 5385500, 5385500, 5385500, 5385500)

z=c(1.74, 1.74, 1.82, 1.82, 1.82, 1.81, 1.81, 1.78, 1.77, 1.77, 1.76, 
1.76, 1.75, 1.74, 1.73, 1.73, 1.72, 1.82, 1.82, 1.81, 1.81, 1.80, 1.80, 
1.78, 1.75, 1.75, 1.74, 1.74, 1.73, 1.73)

df1=data.frame(x,y,z)
coordinates(df1) <- c("x", "y")
proj4string(df1)=CRS("+init=epsg:3035")
df1 = spTransform(df1,CRS("+init=epsg:4326"))

gridded(df1)=TRUE
suggested tolerance minimum: 0.311581
Error in points2grid(points, tolerance, round) :
   dimension 1 : coordinate intervals are not constant

And with the example data, the spatial resolution is 5 km * 5 km and i 
would like to aggregate  to 15*15 km. The new cellsize would be now an 
average of the corresponding values in 3*3 cells. Also what to do if 
come grid cells contain NA. I would be thankful if people could provide 
some ideas on how to get around this.

Thanks a lot for your time.

Navin


From cmclauchlan at upei.ca  Tue Mar  5 16:41:14 2013
From: cmclauchlan at upei.ca (Christine Lynn Mc Lauchlan)
Date: Tue, 5 Mar 2013 11:41:14 -0400
Subject: [R-sig-Geo] Topographical Data SOS
Message-ID: <CAM_kZXG4cqMVH5OTqLBnzE50QdLLyTxYsB19MvbyWf_yMkkA7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/6e7b0a35/attachment.pl>

From joshmobrien at gmail.com  Tue Mar  5 17:48:26 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Tue, 5 Mar 2013 08:48:26 -0800 (PST)
Subject: [R-sig-Geo] raster::crop() can fail when cropped region is too
 large to process in memory.
In-Reply-To: <CANtt_hxghW-jHLzo0=fvM4L=-mHhXT4zHiFY3UJetSKh_3E8SA@mail.gmail.com>
References: <CAOwKfPRHYZcXKGesN5DK4up7qcu466uskNH7c-=h4ic6ts=5Gw@mail.gmail.com>
	<CANtt_hxghW-jHLzo0=fvM4L=-mHhXT4zHiFY3UJetSKh_3E8SA@mail.gmail.com>
Message-ID: <1362502106815-7582968.post@n2.nabble.com>

Robert Hijmans wrote
> Josh,
> 
> Thanks for reporting this, I will make 'crop' more conservative. The
> easiest way to deal with this (I believe rare) problem is to change the
> default setting of "maxmemory":
> 
> rasterOptions(maxmemory=1e+07)
> 
> After that,
> 
> crop(r, E, filename="smallerRast")
> 
> will likely run without a problem (although I cannot know for sure).
> 
> Robert

Robert,

Thanks! I can confirm that setting maxmemory to 1e7 solves the problem.

I believe that you may want to up n in canProcessInMemory, to n=5 (rather
than n=4).  With a bit of poking around, I found cases in which crop will
fail even when canProcessInMemory(out, 4) --> TRUE, but wherever
canProcessInMemory(out, 5) --> TRUE, the operation succeeds.

Here's an example where crop fails when canProcessInMemory(out, 4) --> TRUE:

r <- raster("bigRast")
E <- extent(c(-179, 179, -89, 69))
crop(r, E, filename="smallerRast") 

In my use case, editing crop() to use canProcessInMemory(out, 5) made
everything run smoothly, whereas one in five or so of cropping operations
were failing when I used the default.

Thanks for all of your work on this remarkable package,

Josh 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/raster-crop-can-fail-when-cropped-region-is-too-large-to-process-in-memory-tp7582954p7582968.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From joshmobrien at gmail.com  Tue Mar  5 17:53:24 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Tue, 5 Mar 2013 08:53:24 -0800 (PST)
Subject: [R-sig-Geo] raster::crop() can fail when cropped region is too
 large to process in memory.
In-Reply-To: <1362502106815-7582968.post@n2.nabble.com>
References: <CAOwKfPRHYZcXKGesN5DK4up7qcu466uskNH7c-=h4ic6ts=5Gw@mail.gmail.com>
	<CANtt_hxghW-jHLzo0=fvM4L=-mHhXT4zHiFY3UJetSKh_3E8SA@mail.gmail.com>
	<1362502106815-7582968.post@n2.nabble.com>
Message-ID: <1362502404924-7582969.post@n2.nabble.com>

Josh O'Brien wrote
> I believe that you may want to up n in canProcessInMemory, to n=5 (rather
> than n=4).  

Just to clarify, I am referring here to the call to canProcessInMemory
inside of crop(), not to canProcessInMemory's default value of n.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/raster-crop-can-fail-when-cropped-region-is-too-large-to-process-in-memory-tp7582954p7582969.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From swagathnavin82 at gmail.com  Tue Mar  5 19:39:37 2013
From: swagathnavin82 at gmail.com (CIO Student)
Date: Tue, 5 Mar 2013 19:39:37 +0100
Subject: [R-sig-Geo] Re. Topographical Data SOS
References: <CAM_kZXFw62UtKfPE2aO_95AoRZOYG=Dzz8qcprmLj6nF0EwKEw@mail.gmail.com>
Message-ID: <042F027B-1069-4A43-B483-143EC1366ECC@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/5522866c/attachment.pl>

From HodgessE at uhd.edu  Tue Mar  5 21:18:21 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 5 Mar 2013 20:18:21 +0000
Subject: [R-sig-Geo] question about image function
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/21c8fed5/attachment.pl>

From mdsumner at gmail.com  Tue Mar  5 21:41:39 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 6 Mar 2013 07:41:39 +1100
Subject: [R-sig-Geo] question about image function
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>
Message-ID: <CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/86cbeb5a/attachment.pl>

From clint at ecy.wa.gov  Tue Mar  5 21:46:30 2013
From: clint at ecy.wa.gov (Clint Bowman)
Date: Tue, 5 Mar 2013 12:46:30 -0800 (PST)
Subject: [R-sig-Geo] question about image function
In-Reply-To: <CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>
References: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>
	<CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1303051243560.12944@ecy.wa.gov>

When using png in a loop, especially one where the loop index is an 
integer, I usually make use of the "%02d" in the file name, e.g., 
png("pred_%02d_a.png",...)

Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Quality Modeler		INTERNET:	clint at math.utah.edu
Department of Ecology		VOICE:		(360) 407-6815
PO Box 47600			FAX:		(360) 407-7534
Olympia, WA 98504-7600

         USPS:           PO Box 47600, Olympia, WA 98504-7600
         Parcels:        300 Desmond Drive, Lacey, WA 98503-1274

On Wed, 6 Mar 2013, Michael Sumner wrote:

> I don't see filename defined, or any packages required. Is it the png files
> that are a problem or the 'kmlsetup' output? (whatever that is)
>
> See the animation package for extremely simplifed image frame creation btw
>
> On Wednesday, March 6, 2013, Hodgess, Erin wrote:
>
>> Hello again!
>>
>> I'm running into a problem with the image function within a loop.  When I
>> put it to the screen, it works fine, but when I put it to a PNG file, the
>> picture doesn't change.
>>
>> Here is the code:
>>
>> for(i in 1:11) {
>> j1 <- (i-1)*n2 + 1
>> j2 <- i*n2
>>
>>  predx <- data.frame(pred=kr3$var1.pred[j1:j2],lon=kr3 at sp
>> @coords[,1],lat=kr3 at sp@coords[,2])
>>
>>  coordinates(predx) <- ~lon+lat
>>  proj4string(predx) <- proj4string(kr3)
>>  predx.wgs84 <- spTransform(predx,CRS("+proj=longlat +datum=WGS84"))
>>  llSPix <- as(llSGDF, "SpatialPixelsDataFrame")
>>  (st <- system.time(llSPix$pred <- idw(pred ~ 1,
>>  loc=predx.wgs84,newdata = llSPix, nmax = 16)$var1.pred))
>>  cat("stuff",i,"\n")
>> f1 <- paste("pred",i,"a.png",sep="")
>> #Works fine
>> image(llSPix,"pred",col=bpy.colors(),main=f1)
>>
>>
>>  assign("file1",f1)
>>  cat("filen",file1,"\n")
>>  png(filename = file1, width = GRD.wgs84$width,
>>  height = GRD.wgs84$height,bg="transparent")
>>  par(mar = c(0, 0, 0, 0), xaxs = "i", yaxs = "i")
>>  image(llSPix, "pred", col = bpy.colors())
>>  dev.off()
>>  kmlsetup(obj = GRD.wgs84, kmlfile =filename,
>>  imagefile = file1, name =as.character(2000+i))
>>
>> }
>>
>> Has anyone run into this before, please?
>>
>> Thanks,
>> Erin
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <javascript:;>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> -- 
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From HodgessE at uhd.edu  Tue Mar  5 21:45:21 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 5 Mar 2013 20:45:21 +0000
Subject: [R-sig-Geo] question about image function
In-Reply-To: <CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>
References: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>,
	<CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F316@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130305/59719825/attachment.pl>

From HodgessE at uhd.edu  Tue Mar  5 22:33:29 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 5 Mar 2013 21:33:29 +0000
Subject: [R-sig-Geo] question about image function
In-Reply-To: <alpine.LRH.2.03.1303051243560.12944@ecy.wa.gov>
References: <FF9DB805FC41CC4E95825A50F68063021292F2BD@challenger.uhd.campus>
	<CAAcGz988wwbxzSgpdngUAZgciwLxXabk7ebgKKDAz3-FOXe81w@mail.gmail.com>,
	<alpine.LRH.2.03.1303051243560.12944@ecy.wa.gov>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F351@challenger.uhd.campus>

That was it...thanks so much!

________________________________________
From: Clint Bowman [clint at ecy.wa.gov]
Sent: Tuesday, March 05, 2013 2:46 PM
To: Michael Sumner
Cc: Hodgess, Erin; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] question about image function

When using png in a loop, especially one where the loop index is an
integer, I usually make use of the "%02d" in the file name, e.g.,
png("pred_%02d_a.png",...)

Clint Bowman                    INTERNET:       clint at ecy.wa.gov
Air Quality Modeler             INTERNET:       clint at math.utah.edu
Department of Ecology           VOICE:          (360) 407-6815
PO Box 47600                    FAX:            (360) 407-7534
Olympia, WA 98504-7600

         USPS:           PO Box 47600, Olympia, WA 98504-7600
         Parcels:        300 Desmond Drive, Lacey, WA 98503-1274

On Wed, 6 Mar 2013, Michael Sumner wrote:

> I don't see filename defined, or any packages required. Is it the png files
> that are a problem or the 'kmlsetup' output? (whatever that is)
>
> See the animation package for extremely simplifed image frame creation btw
>
> On Wednesday, March 6, 2013, Hodgess, Erin wrote:
>
>> Hello again!
>>
>> I'm running into a problem with the image function within a loop.  When I
>> put it to the screen, it works fine, but when I put it to a PNG file, the
>> picture doesn't change.
>>
>> Here is the code:
>>
>> for(i in 1:11) {
>> j1 <- (i-1)*n2 + 1
>> j2 <- i*n2
>>
>>  predx <- data.frame(pred=kr3$var1.pred[j1:j2],lon=kr3 at sp
>> @coords[,1],lat=kr3 at sp@coords[,2])
>>
>>  coordinates(predx) <- ~lon+lat
>>  proj4string(predx) <- proj4string(kr3)
>>  predx.wgs84 <- spTransform(predx,CRS("+proj=longlat +datum=WGS84"))
>>  llSPix <- as(llSGDF, "SpatialPixelsDataFrame")
>>  (st <- system.time(llSPix$pred <- idw(pred ~ 1,
>>  loc=predx.wgs84,newdata = llSPix, nmax = 16)$var1.pred))
>>  cat("stuff",i,"\n")
>> f1 <- paste("pred",i,"a.png",sep="")
>> #Works fine
>> image(llSPix,"pred",col=bpy.colors(),main=f1)
>>
>>
>>  assign("file1",f1)
>>  cat("filen",file1,"\n")
>>  png(filename = file1, width = GRD.wgs84$width,
>>  height = GRD.wgs84$height,bg="transparent")
>>  par(mar = c(0, 0, 0, 0), xaxs = "i", yaxs = "i")
>>  image(llSPix, "pred", col = bpy.colors())
>>  dev.off()
>>  kmlsetup(obj = GRD.wgs84, kmlfile =filename,
>>  imagefile = file1, name =as.character(2000+i))
>>
>> }
>>
>> Has anyone run into this before, please?
>>
>> Thanks,
>> Erin
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <javascript:;>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From philip.greenwood at unimelb.edu.au  Wed Mar  6 00:20:18 2013
From: philip.greenwood at unimelb.edu.au (Philip Greenwood)
Date: Tue, 5 Mar 2013 23:20:18 +0000
Subject: [R-sig-Geo] writeOGR(GeoJSON) to string instead of file
Message-ID: <F3820943-5796-4ED6-BDC1-04DFA042D7BF@unimelb.edu.au>

Hi all,

This is a re-post from a few weeks ago.

I'm using writeOGR{rgdal} to a create GeoJSON temporary file then reading the file and passing as a string in Java. It would be really nice to avoid writing the temporary file, and have writeOGR return a GeoJSON string.

Is this possible?

My project requires passing spatial data from R to Java, and then storing data as GeoJSON. I'm using RServe to interface between R and Java. 

Thanks.

Philip Greenwood

Geospatial and Analytics eEnabler 
Australian Urban Research Infrastructure Network (AURIN)
308 Doug McDonell Building, University of Melbourne
Tel: +61-(0)3-9035-8549
philip.greenwood at unimelb.edu.au


From HodgessE at uhd.edu  Wed Mar  6 03:07:11 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 6 Mar 2013 02:07:11 +0000
Subject: [R-sig-Geo] ground overlays in KML
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F512@challenger.uhd.campus>

Hello again.

I'm not sure if I should ask this here, but I thought it might be a place to start:

I'm producing PNG files for ground overlays in Google Earth.  After some help from you this afternoon, my png files are ready.  However, the files do not run in sequence in Google Earth.  It shows the last file only.

Here is a little bit of the code:

<kml xmlns:xsd="http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd" xmlns:xmlns="http://www.opengis.net/kml/2.2/" version="1.0">
<Document>
<Folder>
<GroundOverlay>
<name>2001</name>
<TimeSpan><begin> 2001-01-01 </begin>
<end> 2001-12-31 </end></TimeSpan>
<Icon><href>preda_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2002</name>
<TimeSpan><begin> 2002-01-01 </begin>
<end> 2002-12-31 </end></TimeSpan>
<Icon><href>predb_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2003</name>
<TimeSpan><begin> 2003-01-01 </begin>
<end> 2003-12-31 </end></TimeSpan>
<Icon><href>predc_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay>
</Folder>
</Document>
<kml>



I'm also attaching the png files.

Thanks for any help.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/7c8220b8/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: preda_01.png
Type: image/png
Size: 1636 bytes
Desc: preda_01.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/7c8220b8/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: predb_01.png
Type: image/png
Size: 1664 bytes
Desc: predb_01.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/7c8220b8/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: predc_01.png
Type: image/png
Size: 1717 bytes
Desc: predc_01.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/7c8220b8/attachment-0002.png>

From sglish at hotmail.com  Wed Mar  6 04:11:00 2013
From: sglish at hotmail.com (Chris English)
Date: Tue, 5 Mar 2013 22:11:00 -0500
Subject: [R-sig-Geo] ground overlays in KML
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021292F512@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F68063021292F512@challenger.uhd.campus>
Message-ID: <BAY172-W45B5E361644867CA159B16C5E40@phx.gbl>


I imagine the final image is the last written. ?

https://developers.google.com/kml/documentation/time?
explores various methods and additional tags employed for rendering sequences
and controlling overlays.
Hope it is in the right direction.

Chris

From: HodgessE at uhd.edu
To: r-sig-geo at r-project.org
Date: Wed, 6 Mar 2013 02:07:11 +0000
Subject: [R-sig-Geo] ground overlays in KML

Hello again.

I'm not sure if I should ask this here, but I thought it might be a place to start:

I'm producing PNG files for ground overlays in Google Earth.? After some help from you this afternoon, my png files are ready.? However, the files do not run in sequence in Google Earth.? It shows the last file only.

Here is a little bit of the code:

<kml xmlns:xsd="http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd" xmlns:xmlns="http://www.opengis.net/kml/2.2/" version="1.0">
<Document>
<Folder>
<GroundOverlay>
<name>2001</name>
<TimeSpan><begin> 2001-01-01 </begin>
<end> 2001-12-31 </end></TimeSpan>
<Icon><href>preda_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2002</name>
<TimeSpan><begin> 2002-01-01 </begin>
<end> 2002-12-31 </end></TimeSpan>
<Icon><href>predb_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2003</name>
<TimeSpan><begin> 2003-01-01 </begin>
<end> 2003-12-31 </end></TimeSpan>
<Icon><href>predc_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay>
</Folder>
</Document>
<kml>



I'm also attaching the png files.? 

Thanks for any help.



_______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo 		 	   		  

From HodgessE at uhd.edu  Wed Mar  6 04:44:53 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 6 Mar 2013 03:44:53 +0000
Subject: [R-sig-Geo] ground overlays in KML
In-Reply-To: <BAY172-W45B5E361644867CA159B16C5E40@phx.gbl>
References: <FF9DB805FC41CC4E95825A50F68063021292F512@challenger.uhd.campus>,
	<BAY172-W45B5E361644867CA159B16C5E40@phx.gbl>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F610@challenger.uhd.campus>

I had seen this today too...it doesn't seem to work either?

Thanks though.
Erin

________________________________________
From: Chris English [sglish at hotmail.com]
Sent: Tuesday, March 05, 2013 9:11 PM
To: Hodgess, Erin; Help R-Sig_Geo
Subject: RE: [R-sig-Geo] ground overlays in KML

I imagine the final image is the last written.

https://developers.google.com/kml/documentation/time
explores various methods and additional tags employed for rendering sequences
and controlling overlays.
Hope it is in the right direction.

Chris

From: HodgessE at uhd.edu
To: r-sig-geo at r-project.org
Date: Wed, 6 Mar 2013 02:07:11 +0000
Subject: [R-sig-Geo] ground overlays in KML

Hello again.

I'm not sure if I should ask this here, but I thought it might be a place to start:

I'm producing PNG files for ground overlays in Google Earth.  After some help from you this afternoon, my png files are ready.  However, the files do not run in sequence in Google Earth.  It shows the last file only.

Here is a little bit of the code:

<kml xmlns:xsd="http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd" xmlns:xmlns="http://www.opengis.net/kml/2.2/" version="1.0">
<Document>
<Folder>
<GroundOverlay>
<name>2001</name>
<TimeSpan><begin> 2001-01-01 </begin>
<end> 2001-12-31 </end></TimeSpan>
<Icon><href>preda_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2002</name>
<TimeSpan><begin> 2002-01-01 </begin>
<end> 2002-12-31 </end></TimeSpan>
<Icon><href>predb_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay><GroundOverlay>
<name>2003</name>
<TimeSpan><begin> 2003-01-01 </begin>
<end> 2003-12-31 </end></TimeSpan>
<Icon><href>predc_01.png</href><viewBoundScale>0.75</viewBoundScale></Icon>
<LatLonBox><north>36.48445398908</north><south>25.9875545196567</south><east>-93.5186130430667</east><west>-106.704257739431</west></LatLonBox>
</GroundOverlay>
</Folder>
</Document>
<kml>



I'm also attaching the png files.

Thanks for any help.



_______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed Mar  6 09:08:13 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Mar 2013 09:08:13 +0100
Subject: [R-sig-Geo] writeOGR(GeoJSON) to string instead of file
In-Reply-To: <F3820943-5796-4ED6-BDC1-04DFA042D7BF@unimelb.edu.au>
References: <F3820943-5796-4ED6-BDC1-04DFA042D7BF@unimelb.edu.au>
Message-ID: <alpine.LRH.2.03.1303060849550.31540@reclus.nhh.no>

On Wed, 6 Mar 2013, Philip Greenwood wrote:

> Hi all,
>
> This is a re-post from a few weeks ago.
>
> I'm using writeOGR{rgdal} to a create GeoJSON temporary file then 
> reading the file and passing as a string in Java. It would be really 
> nice to avoid writing the temporary file, and have writeOGR return a 
> GeoJSON string.
>
> Is this possible?

See:

http://www.gdal.org/ogr/drv_geojson.html

which implies no. The write driver writes to a file as far as I can see, 
unless you try the VSI route, dsn="/vsistdout/", but that output goes 
straight to the console, not through R. If you can find a way to access 
this output stream, you may be lucky.

Roger

library(rgdal)
cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")
writeOGR(cities[1:10,], "/vsistdout/", "cities", driver="GeoJSON")


>
> My project requires passing spatial data from R to Java, and then 
> storing data as GeoJSON. I'm using RServe to interface between R and 
> Java.
>
> Thanks.
>
> Philip Greenwood
>
> Geospatial and Analytics eEnabler
> Australian Urban Research Infrastructure Network (AURIN)
> 308 Doug McDonell Building, University of Melbourne
> Tel: +61-(0)3-9035-8549
> philip.greenwood at unimelb.edu.au
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Wed Mar  6 09:45:13 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 6 Mar 2013 08:45:13 +0000
Subject: [R-sig-Geo] ground overlays in KML
In-Reply-To: <aa145aebf57a419f8db0b94773e32ed1@EX-1-HT0.lancs.local>
References: <aa145aebf57a419f8db0b94773e32ed1@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMSkPJWQ8VYTvwk1sSwRVHAt6PbUbt7wiV6DDc+KokmuA@mail.gmail.com>

On Wed, Mar 6, 2013 at 2:07 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hello again.
>
> I'm not sure if I should ask this here, but I thought it might be a place to
> start:
>
> I'm producing PNG files for ground overlays in Google Earth.  After some
> help from you this afternoon, my png files are ready.  However, the files do
> not run in sequence in Google Earth.  It shows the last file only.
>
> Here is a little bit of the code:

 This works for me, except..

> <kml xmlns:xsd="http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd"
> xmlns:xmlns="http://www.opengis.net/kml/2.2/" version="1.0">
...
> </Document>
> <kml>

 that last tag should be a closing </kml> - but google earth
complained until I changed it so maybe thats a typo that happened when
you chooped a data file up to put in the email! Take CARE!

 Now, you don't say exactly what you are doing. All we have is "the
files do not run in sequence in Google Earth. It shows the last file
only".

 Well, yes, that's because the last one is on top of the others. You
are trying to do some kind of animation? So what have you done with
the animation controller?

 The animation controller has a start and end marker. Initially the
markers will be at the limits of the start and end of the timepoints
of your data. Hit the 'play' button (aka "click to toggle time slider
animation") and it will animate the start point only. The end doesn't
change. Since your top image has an end point within the time range
for all times, it stays visible. What is happening is that the images
underneath it are being animated, but you don't see that because they
are hidden under the top one at all time points.

So... drag the time END point back so it nudges up to the start point
marker. Now that will put the top layers out of range, and just reveal
the earliest bottom layer. Hit play again....

 That's what I do to get an animation. As time goes forward, I see the
blue area shrinking, in three steps.

Barry


From rossahmed at googlemail.com  Wed Mar  6 10:36:32 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Wed, 06 Mar 2013 09:36:32 +0000
Subject: [R-sig-Geo] eastings/northings to long/lat
Message-ID: <CD5CBEA0.3FB8%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/76e49424/attachment.pl>

From mdsumner at gmail.com  Wed Mar  6 11:09:27 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 6 Mar 2013 21:09:27 +1100
Subject: [R-sig-Geo] eastings/northings to long/lat
In-Reply-To: <CD5CBEA0.3FB8%rossahmed@gmail.com>
References: <CD5CBEA0.3FB8%rossahmed@gmail.com>
Message-ID: <CAAcGz98yKWA1745RtYGC4SVkuOoZcJvMNmdUujwhdXKe_YwipQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/f5357a9d/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Mar  6 11:15:09 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 6 Mar 2013 10:15:09 +0000
Subject: [R-sig-Geo] eastings/northings to long/lat
In-Reply-To: <459f9d52eeb24957bacc82661578f1bd@EX-1-HT0.lancs.local>
References: <459f9d52eeb24957bacc82661578f1bd@EX-1-HT0.lancs.local>
Message-ID: <CANVKczON6wYKoqh1ANp5a1AHFmORFpvfrfazUmqMoNkNeoNKMA@mail.gmail.com>

If these are eastings and northings in the UK and based on the OSGB
National Grid system, then you just use the code I told you about last
week or so....

The only problem might be if you don't know what grid square they came from.



On Wed, Mar 6, 2013 at 9:36 AM, Ross Ahmed <rossahmed at googlemail.com> wrote:
> I have these eastings and northings:
>
> easting <- c(626550, 583550, 584083, 584550, 518437)
> northing <- c(169550, 172550, 173989, 169550, 160768)
>
> Is there a way to convert to long/lat in R? Attempts to code through
> googling have failed.
>
> Thanks
> Ross
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From babuawara at gmail.com  Wed Mar  6 11:21:24 2013
From: babuawara at gmail.com (vikram ranga)
Date: Wed, 6 Mar 2013 15:51:24 +0530
Subject: [R-sig-Geo] eastings/northings to long/lat
In-Reply-To: <CD5CBEA0.3FB8%rossahmed@gmail.com>
References: <CD5CBEA0.3FB8%rossahmed@gmail.com>
Message-ID: <CAL-ALVFQJqeas6aGEfPm5wO6vxtcwUbemt7nB-CQ=ALkux0Bow@mail.gmail.com>

Hi Ross,
which projection does it have??
I think it can be done using spTransform but for that you need to
provide projection info.

This code might be useful
# need library (rgdal) and (sp).
a<-data.frame(easting,northing)
coordinates(a)= ~easting + northing
proj4string(a)<-CRS("Need projection info here")
# use spTransform now
a1<-spTranform(a,CRS("+proj=longlat +ellps=....."))
coordinates(a1) #would yield longlat info

Cheers,

Vikram.


On Wed, Mar 6, 2013 at 3:06 PM, Ross Ahmed <rossahmed at googlemail.com> wrote:
>
> I have these eastings and northings:
>
> easting <- c(626550, 583550, 584083, 584550, 518437)
> northing <- c(169550, 172550, 173989, 169550, 160768)
>
> Is there a way to convert to long/lat in R? Attempts to code through
> googling have failed.
>
> Thanks
> Ross
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Martin.Biuw at nina.no  Wed Mar  6 11:21:49 2013
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Wed, 6 Mar 2013 10:21:49 +0000
Subject: [R-sig-Geo] readGDAL re-mapping data to 0-255
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/1c16ab80/attachment.pl>

From mdsumner at gmail.com  Wed Mar  6 12:07:56 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 6 Mar 2013 22:07:56 +1100
Subject: [R-sig-Geo] readGDAL re-mapping data to 0-255
In-Reply-To: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
References: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
Message-ID: <CAAcGz9-p-uRAQ6ri_f3ToONq=7qYGz1N-EmDiFhReeaSaHPL=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130306/72175629/attachment.pl>

From Roger.Bivand at nhh.no  Wed Mar  6 12:47:23 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Mar 2013 12:47:23 +0100
Subject: [R-sig-Geo] readGDAL re-mapping data to 0-255
In-Reply-To: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
References: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
Message-ID: <alpine.LRH.2.03.1303061244510.31540@reclus.nhh.no>

On Wed, 6 Mar 2013, Biuw, Martin wrote:

> Hi,
> I'm using readGDAL to read data from a geoTiff file. The valid data 
> range of the single band is -26 to 0. I have two versions of the file, 
> one with a NoDataValue = -9999 and one with NoDataValue = -128. When 
> reading the version with -9999 everything works great, and I get the 
> data values in band1 mapped correctly on the original interval. But when 
> I use the version of the file with NoDataValue = -128, these band1 data 
> values get re-mapped to 0-255.

This appears to indicate that the files do not only differ in NoDataValue, 
but also in storage form. Does examining the output of GDALinfo() on both 
tell you anything? Is one a signed 16-bit integer, the other Byte? Maybe 
paste some of the output into a follow-up?

Roger

> I remember reading a helpfile or R-sig 
> post on why the NoDataValue has such an effect, or what can be done to 
> get around it. But can't for the life of me find that message anymore. 
> The reason I need to use the file with NoDataValue = -128 is that this 
> is in UTM 35 while the other one is in UTM 33. Since it's a 
> SpatialGridDataFrames, I'd rather not use spTransform on it, since this 
> turns it into a SpatialPointsDataFrame. The files were originally 
> created (by someone else) in ArcGIS, so I could always ask them to 
> re-create them with correct NoDataValue. But maybe there's a way to 
> explicitly tell readGDAL how to treat the data values? I've desperately 
> been looking for any help on this, but must be looking in the wrong 
> place....
> Thanks in advance,
> Martin
>
> ________________________________________________________________
> Martin Biuw (PhD)
> Researcher
>
> Norwegian Institute for Nature Research - NINA
> Postal address: Framsenteret, 9296 Troms?, NORWAY
> Delivery/Visiting address: Framsenteret, Hjalmar Johansens gate 14, 9007 Troms?, NORWAY
> Phone: +47 77 75 04 17 * Cell: +47 40 72 96 15 * Fax: +47 77 75 04 01 * www.nina.no<http://www.nina.no/>
> ________________________________________________________________
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Martin.Biuw at nina.no  Wed Mar  6 12:53:33 2013
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Wed, 6 Mar 2013 11:53:33 +0000
Subject: [R-sig-Geo] readGDAL re-mapping data to 0-255
In-Reply-To: <alpine.LRH.2.03.1303061244510.31540@reclus.nhh.no>
References: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
	<alpine.LRH.2.03.1303061244510.31540@reclus.nhh.no>
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F832F3048@NINSRV05.nina.no>

Ah, that was the problem.
The file with -9999 that works fine is Int16:

       apparent band summary:
         GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
       1  Int16  -26    0 -3.130923 3.832138           TRUE       -9999

While the other one is Byte:
    
      apparent band summary:
         GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
       1   Byte  -26    0 -3.089263 3.864005           TRUE        -128

So this sort of problem basically stems from the way ArcGIS saves the geoTiff depending on the data range? Or is there a way to specify to readGDAL how to deal with Byte or Int16 data?
Thanks for the help!
Martin

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: 06 March 2013 12:47
To: Biuw, Martin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] readGDAL re-mapping data to 0-255

On Wed, 6 Mar 2013, Biuw, Martin wrote:

> Hi,
> I'm using readGDAL to read data from a geoTiff file. The valid data 
> range of the single band is -26 to 0. I have two versions of the file, 
> one with a NoDataValue = -9999 and one with NoDataValue = -128. When 
> reading the version with -9999 everything works great, and I get the 
> data values in band1 mapped correctly on the original interval. But 
> when I use the version of the file with NoDataValue = -128, these 
> band1 data values get re-mapped to 0-255.

This appears to indicate that the files do not only differ in NoDataValue, but also in storage form. Does examining the output of GDALinfo() on both tell you anything? Is one a signed 16-bit integer, the other Byte? Maybe paste some of the output into a follow-up?

Roger

> I remember reading a helpfile or R-sig post on why the NoDataValue has 
> such an effect, or what can be done to get around it. But can't for 
> the life of me find that message anymore.
> The reason I need to use the file with NoDataValue = -128 is that this 
> is in UTM 35 while the other one is in UTM 33. Since it's a 
> SpatialGridDataFrames, I'd rather not use spTransform on it, since 
> this turns it into a SpatialPointsDataFrame. The files were originally 
> created (by someone else) in ArcGIS, so I could always ask them to 
> re-create them with correct NoDataValue. But maybe there's a way to 
> explicitly tell readGDAL how to treat the data values? I've 
> desperately been looking for any help on this, but must be looking in 
> the wrong place....
> Thanks in advance,
> Martin
>
> ________________________________________________________________
> Martin Biuw (PhD)
> Researcher
>
> Norwegian Institute for Nature Research - NINA Postal address: 
> Framsenteret, 9296 Troms?, NORWAY Delivery/Visiting address: 
> Framsenteret, Hjalmar Johansens gate 14, 9007 Troms?, NORWAY
> Phone: +47 77 75 04 17 * Cell: +47 40 72 96 15 * Fax: +47 77 75 04 01 
> * www.nina.no<http://www.nina.no/> 
> ________________________________________________________________
>
>
> 	[[alternative HTML version deleted]]
>
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics, Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Mar  6 13:26:04 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 6 Mar 2013 13:26:04 +0100
Subject: [R-sig-Geo] readGDAL re-mapping data to 0-255
In-Reply-To: <32BF359C0C4F9446BEBFBB9FB405C61F832F3048@NINSRV05.nina.no>
References: <32BF359C0C4F9446BEBFBB9FB405C61F832F2FF4@NINSRV05.nina.no>
	<alpine.LRH.2.03.1303061244510.31540@reclus.nhh.no>
	<32BF359C0C4F9446BEBFBB9FB405C61F832F3048@NINSRV05.nina.no>
Message-ID: <alpine.LRH.2.03.1303061310240.31540@reclus.nhh.no>

On Wed, 6 Mar 2013, Biuw, Martin wrote:

> Ah, that was the problem.
> The file with -9999 that works fine is Int16:
>
>       apparent band summary:
>         GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
>       1  Int16  -26    0 -3.130923 3.832138           TRUE       -9999
>
> While the other one is Byte:
>
>      apparent band summary:
>         GDType Bmin Bmax     Bmean      Bsd hasNoDataValue NoDataValue
>       1   Byte  -26    0 -3.089263 3.864005           TRUE        -128
>
> So this sort of problem basically stems from the way ArcGIS saves the 
> geoTiff depending on the data range? Or is there a way to specify to 
> readGDAL how to deal with Byte or Int16 data?

If the input data are Byte, you may try the rgdal toSigned() function:

x <- c(1:10, 127:129, 240:256)
toSigned(x, 8)

which probably will not respect the -128, but you can then untangle that 
later with is.na(). You'll need to check the output as the function is not 
used often and may not do what you need. The function was added to the 
package in September 2009:

https://stat.ethz.ch/pipermail/r-sig-geo/2009-September/006387.html

Hope this helps,

Roger

> Thanks for the help!
> Martin
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: 06 March 2013 12:47
> To: Biuw, Martin
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] readGDAL re-mapping data to 0-255
>
> On Wed, 6 Mar 2013, Biuw, Martin wrote:
>
>> Hi,
>> I'm using readGDAL to read data from a geoTiff file. The valid data
>> range of the single band is -26 to 0. I have two versions of the file,
>> one with a NoDataValue = -9999 and one with NoDataValue = -128. When
>> reading the version with -9999 everything works great, and I get the
>> data values in band1 mapped correctly on the original interval. But
>> when I use the version of the file with NoDataValue = -128, these
>> band1 data values get re-mapped to 0-255.
>
> This appears to indicate that the files do not only differ in NoDataValue, but also in storage form. Does examining the output of GDALinfo() on both tell you anything? Is one a signed 16-bit integer, the other Byte? Maybe paste some of the output into a follow-up?
>
> Roger
>
>> I remember reading a helpfile or R-sig post on why the NoDataValue has
>> such an effect, or what can be done to get around it. But can't for
>> the life of me find that message anymore.
>> The reason I need to use the file with NoDataValue = -128 is that this
>> is in UTM 35 while the other one is in UTM 33. Since it's a
>> SpatialGridDataFrames, I'd rather not use spTransform on it, since
>> this turns it into a SpatialPointsDataFrame. The files were originally
>> created (by someone else) in ArcGIS, so I could always ask them to
>> re-create them with correct NoDataValue. But maybe there's a way to
>> explicitly tell readGDAL how to treat the data values? I've
>> desperately been looking for any help on this, but must be looking in
>> the wrong place....
>> Thanks in advance,
>> Martin
>>
>> ________________________________________________________________
>> Martin Biuw (PhD)
>> Researcher
>>
>> Norwegian Institute for Nature Research - NINA Postal address:
>> Framsenteret, 9296 Troms?, NORWAY Delivery/Visiting address:
>> Framsenteret, Hjalmar Johansens gate 14, 9007 Troms?, NORWAY
>> Phone: +47 77 75 04 17 * Cell: +47 40 72 96 15 * Fax: +47 77 75 04 01
>> * www.nina.no<http://www.nina.no/>
>> ________________________________________________________________
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics, Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From HodgessE at uhd.edu  Wed Mar  6 16:42:07 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 6 Mar 2013 15:42:07 +0000
Subject: [R-sig-Geo] ground overlays in KML
In-Reply-To: <CANVKczMSkPJWQ8VYTvwk1sSwRVHAt6PbUbt7wiV6DDc+KokmuA@mail.gmail.com>
References: <aa145aebf57a419f8db0b94773e32ed1@EX-1-HT0.lancs.local>,
	<CANVKczMSkPJWQ8VYTvwk1sSwRVHAt6PbUbt7wiV6DDc+KokmuA@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021292F86E@challenger.uhd.campus>

The slider was exactly what I needed.  Thanks so much!

Erin

________________________________________
From: b.rowlingson at gmail.com [b.rowlingson at gmail.com] on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
Sent: Wednesday, March 06, 2013 2:45 AM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] ground overlays in KML

On Wed, Mar 6, 2013 at 2:07 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hello again.
>
> I'm not sure if I should ask this here, but I thought it might be a place to
> start:
>
> I'm producing PNG files for ground overlays in Google Earth.  After some
> help from you this afternoon, my png files are ready.  However, the files do
> not run in sequence in Google Earth.  It shows the last file only.
>
> Here is a little bit of the code:

 This works for me, except..

> <kml xmlns:xsd="http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd"
> xmlns:xmlns="http://www.opengis.net/kml/2.2/" version="1.0">
...
> </Document>
> <kml>

 that last tag should be a closing </kml> - but google earth
complained until I changed it so maybe thats a typo that happened when
you chooped a data file up to put in the email! Take CARE!

 Now, you don't say exactly what you are doing. All we have is "the
files do not run in sequence in Google Earth. It shows the last file
only".

 Well, yes, that's because the last one is on top of the others. You
are trying to do some kind of animation? So what have you done with
the animation controller?

 The animation controller has a start and end marker. Initially the
markers will be at the limits of the start and end of the timepoints
of your data. Hit the 'play' button (aka "click to toggle time slider
animation") and it will animate the start point only. The end doesn't
change. Since your top image has an end point within the time range
for all times, it stays visible. What is happening is that the images
underneath it are being animated, but you don't see that because they
are hidden under the top one at all time points.

So... drag the time END point back so it nudges up to the start point
marker. Now that will put the top layers out of range, and just reveal
the earliest bottom layer. Hit play again....

 That's what I do to get an animation. As time goes forward, I see the
blue area shrinking, in three steps.

Barry


From arudolph at PIRE.org  Thu Mar  7 04:51:05 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Wed, 6 Mar 2013 22:51:05 -0500
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with more
 than one polygon
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>

Hi,

I was given the following code to determine whether the spatial distribution of attribute=1 is significantly different from the spatial distribution of attribute=0
given that the points (overall) are not randomly distributed in space.


BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
summary(BaltCity2)

x<-BaltCity2 at polygons[[1]]@Polygons 
x 
summary(x)
# this shows that the baltimore polygon is a single shape
# the Baltimore shapefile is projected in meters, so the following code converts meters to miles
coords<-slot(x[[1]],"coords")
coords<-coords[167:1,]
coords<-coords[-1,]
coords.mi<-coords*0.000621371192 
summary(coords.mi)

play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
           window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))

I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.  

However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters. 
When I plot the following in R, the points from my data file map onto the shapefile and both are in meters

plot(NYCBB)
u<-RDS_TSO$RDS_new==0
points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")

However, when I use the code below to convert the meters to miles:

x<-NYBorough at polygons[[1]]@Polygons
x
# there are 8910 rows in x
summary(x)
# x is 5 different shapes compared to one like in the baltimore example above
     Length Class   Mode
[1,] 1      Polygon S4  
[2,] 1      Polygon S4  
[3,] 1      Polygon S4  
[4,] 1      Polygon S4  
[5,] 1      Polygon S4  

coords<-slot(x[[1]],"coords")
coords
# Now there are only 47 rows - with the baltimore data there was no reduction - I suspect it is being limited in some way
coords<-coords[19:1,]
coords
coords<-coords[-1,]
coords
NYBorough.coords.mi<-coords*0.000621371192 
NYBorough.coords.mi

then, when I try to convert my data x,y coordinates from meters to miles and create a shape with the NYBorough owin, I get a warning that all of the points fall outside the window

RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192,
           window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[,2])))

I received the following warning:
Warning message:
In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
  217 points were rejected as lying outside the specified window

This is puzzling, because when they are plotted using the following code, they overlap

plot(NYBorough)
points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")

and there are only 217 points in this group, so it appears that they are all rejected.

I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
I get the same warning with both shapefiles.

Does it seem like the error is resulting from the shapefile I am using or some other error in the code?

Any help would be very much appreciated.

Thanks!

Abby


From marcelino.delacruz at upm.es  Thu Mar  7 08:53:03 2013
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 07 Mar 2013 08:53:03 +0100
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
In-Reply-To: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
Message-ID: <5138475F.5010707@upm.es>

Hi,
My first advise is to point you to the vignette about "handling 
shapeles in the spatstat package" .Go to section 3.2.5 "Objects of 
class SpatialPolygons".

In short, you could do something like this:

BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
play2<-ppp(play$X_m,play$Y_m, window=as.owin(BaltCity2))

...if you want to combine all polygons inside baltcity_mdsp83m.shp in 
just one window. See the section section 3.2.5 "Objects of class 
SpatialPolygons" for the other option (having different windows from 
each indiviual polygon).

As you can see, I also removed the "meter to miles" conversion because 
it's unnecesary  if both the shapes and the  play$X_m and play$Y_m 
coordinates are in the same units (metres)


HTH,
Marcelino


El 07/03/2013 4:51, Abby Rudolph escribi?:
> Hi,
>
> I was given the following code to determine whether the spatial distribution of attribute=1 is significantly different from the spatial distribution of attribute=0
> given that the points (overall) are not randomly distributed in space.
>
>
> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
> summary(BaltCity2)
>
> x<-BaltCity2 at polygons[[1]]@Polygons
> x
> summary(x)
> # this shows that the baltimore polygon is a single shape
> # the Baltimore shapefile is projected in meters, so the following code converts meters to miles
> coords<-slot(x[[1]],"coords")
> coords<-coords[167:1,]
> coords<-coords[-1,]
> coords.mi<-coords*0.000621371192
> summary(coords.mi)
>
> play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
>             window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))
>
> I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.
>
> However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters.
> When I plot the following in R, the points from my data file map onto the shapefile and both are in meters
>
> plot(NYCBB)
> u<-RDS_TSO$RDS_new==0
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
> points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")
>
> However, when I use the code below to convert the meters to miles:
>
> x<-NYBorough at polygons[[1]]@Polygons
> x
> # there are 8910 rows in x
> summary(x)
> # x is 5 different shapes compared to one like in the baltimore example above
>       Length Class   Mode
> [1,] 1      Polygon S4
> [2,] 1      Polygon S4
> [3,] 1      Polygon S4
> [4,] 1      Polygon S4
> [5,] 1      Polygon S4
>
> coords<-slot(x[[1]],"coords")
> coords
> # Now there are only 47 rows - with the baltimore data there was no reduction - I suspect it is being limited in some way
> coords<-coords[19:1,]
> coords
> coords<-coords[-1,]
> coords
> NYBorough.coords.mi<-coords*0.000621371192
> NYBorough.coords.mi
>
> then, when I try to convert my data x,y coordinates from meters to miles and create a shape with the NYBorough owin, I get a warning that all of the points fall outside the window
>
> RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192,
>             window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[,2])))
>
> I received the following warning:
> Warning message:
> In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
>    217 points were rejected as lying outside the specified window
>
> This is puzzling, because when they are plotted using the following code, they overlap
>
> plot(NYBorough)
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>
> and there are only 217 points in this group, so it appears that they are all rejected.
>
> I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
> I get the same warning with both shapefiles.
>
> Does it seem like the error is resulting from the shapefile I am using or some other error in the code?
>
> Any help would be very much appreciated.
>
> Thanks!
>
> Abby
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a Vegetal
Universidad Polit?cnica de Madrid
Madrid, Espa?a


From mauriziomarchi85 at gmail.com  Thu Mar  7 12:29:56 2013
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Thu, 7 Mar 2013 12:29:56 +0100
Subject: [R-sig-Geo] Memory...
Message-ID: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130307/1a101545/attachment.pl>

From tobias.scholl at nephele-idea.de  Thu Mar  7 12:58:01 2013
From: tobias.scholl at nephele-idea.de (tobias.scholl at nephele-idea.de)
Date: Thu, 07 Mar 2013 12:58:01 +0100
Subject: [R-sig-Geo] Memory...
In-Reply-To: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>
References: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>
Message-ID: <20130307125801.39u9h1izdws40g4w@webmail.nephele-idea.de>

Hi Maurizio,

Indeed, you might get troubles with your RAM, when using huge data  
frames in R since they are completely loaded into the RAM.
What could help you is the Big memory Package.

http://cran.r-project.org/web/packages/bigmemory/index.html

Cheers,
Tobias


Quoting Maurizio Marchi <mauriziomarchi85 at gmail.com>:

> Hi everybody,
> I have to calculate some new columns in a data frame with 1971000   
> lines adding
> 57 new columns but R crashes every time...
> I think it's a problem of memory allocation, so I would like to know how I
> can change the memory settings...
> I'm on Ubuntu 12.04 64-bit
>
> Thanks,
> --
> Maurizio Marchi
>  ID skype: maurizioxyz
> *Ubuntu 12.04 (Precise Pangolin)*
> *"Il bello dell'open-source ? che le domande possono essere poste alla
> fonte"*
> *utente linux 552.742*
>
> 	[[alternative HTML version deleted]]
>
>


From swagathnavin82 at gmail.com  Thu Mar  7 14:29:24 2013
From: swagathnavin82 at gmail.com (Swagath Navin)
Date: Thu, 07 Mar 2013 14:29:24 +0100
Subject: [R-sig-Geo] gdalwarp gives different cellsize when re-projected
Message-ID: <51389634.8020909@gmail.com>

Dear all,

I have a large data-frame with Lon, Lat , Value . Coordinates projected 
in EPSG:3035 with a resolution of 5 kmx5 km. I converted this into a 
SGDF. My goal was to project the file into EPSG:4326 with a resolution 
of 0.05. For re-projecting  i converted the file to tif using

writeGDAL(df, "file.tif")

and used the gdalwarp

gdalwarp file.tif outfile.tif -t_srs "+init=epsg:4326"

However while comparing both files the cell size is different.

getGridTopology(file1)
                         x       y
cellcentre.offset 2638500 1430500
cellsize             5000    5000
cells.dim             664     797
projargs: chr " +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"

getGridTopology(file2)
                            x            y
cellcentre.offset  -31.31150705  34.11186136
cellsize             0.06515996   0.06515996
cells.dim         1254.00000000 580.00000000

projargs: chr " +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 
+towgs84=0,0,0"

Can anyone please tell me where it went wrong.

Thanks for your time.


From villers.alexandre at gmail.com  Thu Mar  7 14:52:15 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Thu, 07 Mar 2013 15:52:15 +0200
Subject: [R-sig-Geo] gdalwarp gives different cellsize when re-projected
In-Reply-To: <51389634.8020909@gmail.com>
References: <51389634.8020909@gmail.com>
Message-ID: <51389B8F.5050804@gmail.com>

Hello,

Well, given you went from a projected to a geographic coordinates 
system, you changed the unit of the grid from meters to degrees.
So I wouldn't be surprised and I guess nothing went wrong as long you 
specified the correct EPSG for your original file.

HTH

Alex

On 07/03/2013 15:29, Swagath Navin wrote:
> Dear all,
>
> I have a large data-frame with Lon, Lat , Value . Coordinates 
> projected in EPSG:3035 with a resolution of 5 kmx5 km. I converted 
> this into a SGDF. My goal was to project the file into EPSG:4326 with 
> a resolution of 0.05. For re-projecting  i converted the file to tif 
> using
>
> writeGDAL(df, "file.tif")
>
> and used the gdalwarp
>
> gdalwarp file.tif outfile.tif -t_srs "+init=epsg:4326"
>
> However while comparing both files the cell size is different.
>
> getGridTopology(file1)
>                         x       y
> cellcentre.offset 2638500 1430500
> cellsize             5000    5000
> cells.dim             664     797
> projargs: chr " +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 
> +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>
> getGridTopology(file2)
>                            x            y
> cellcentre.offset  -31.31150705  34.11186136
> cellsize             0.06515996   0.06515996
> cells.dim         1254.00000000 580.00000000
>
> projargs: chr " +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 
> +towgs84=0,0,0"
>
> Can anyone please tell me where it went wrong.
>
> Thanks for your time.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From arudolph at PIRE.org  Thu Mar  7 15:30:59 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Thu, 7 Mar 2013 09:30:59 -0500
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
In-Reply-To: <5138475F.5010707@upm.es>
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
	<5138475F.5010707@upm.es>
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45B3EBC287F@MDMBX.PIRE.org>

Hi Marcelino,

I think what I would like to do is convert the shapefile comprised of multiple polygons into a single object of class owin.
However, when I use the code as(NYCBorough, "owin")
I get the following error:
Error in owin(poly = opls): Polygon data contain overlaps between polygons.

Is there a way to get around this?

Regarding the miles part, I need to convert both to miles for a calculation that comes later on in my code.

Thanks,
Abby

-----Original Message-----
From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
Sent: Thursday, March 07, 2013 2:53 AM
To: Abby Rudolph
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon

Hi,
My first advise is to point you to the vignette about "handling shape les in the spatstat package" .Go to section 3.2.5 "Objects of class SpatialPolygons".

In short, you could do something like this:

BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
play2<-ppp(play$X_m,play$Y_m, window=as.owin(BaltCity2))

...if you want to combine all polygons inside baltcity_mdsp83m.shp in just one window. See the section section 3.2.5 "Objects of class SpatialPolygons" for the other option (having different windows from each indiviual polygon).

As you can see, I also removed the "meter to miles" conversion because it's unnecesary  if both the shapes and the  play$X_m and play$Y_m coordinates are in the same units (metres)


HTH,
Marcelino


El 07/03/2013 4:51, Abby Rudolph escribi?:
> Hi,
>
> I was given the following code to determine whether the spatial 
> distribution of attribute=1 is significantly different from the spatial distribution of attribute=0 given that the points (overall) are not randomly distributed in space.
>
>
> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
> summary(BaltCity2)
>
> x<-BaltCity2 at polygons[[1]]@Polygons
> x
> summary(x)
> # this shows that the baltimore polygon is a single shape # the 
> Baltimore shapefile is projected in meters, so the following code 
> converts meters to miles
> coords<-slot(x[[1]],"coords")
> coords<-coords[167:1,]
> coords<-coords[-1,]
> coords.mi<-coords*0.000621371192
> summary(coords.mi)
>
> play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
>             window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))
>
> I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.
>
> However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters.
> When I plot the following in R, the points from my data file map onto 
> the shapefile and both are in meters
>
> plot(NYCBB)
> u<-RDS_TSO$RDS_new==0
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
> points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")
>
> However, when I use the code below to convert the meters to miles:
>
> x<-NYBorough at polygons[[1]]@Polygons
> x
> # there are 8910 rows in x
> summary(x)
> # x is 5 different shapes compared to one like in the baltimore example above
>       Length Class   Mode
> [1,] 1      Polygon S4
> [2,] 1      Polygon S4
> [3,] 1      Polygon S4
> [4,] 1      Polygon S4
> [5,] 1      Polygon S4
>
> coords<-slot(x[[1]],"coords")
> coords
> # Now there are only 47 rows - with the baltimore data there was no 
> reduction - I suspect it is being limited in some way 
> coords<-coords[19:1,] coords coords<-coords[-1,] coords
> NYBorough.coords.mi<-coords*0.000621371192
> NYBorough.coords.mi
>
> then, when I try to convert my data x,y coordinates from meters to 
> miles and create a shape with the NYBorough owin, I get a warning that 
> all of the points fall outside the window
>
> RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192,
>             
> window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[
> ,2])))
>
> I received the following warning:
> Warning message:
> In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
>    217 points were rejected as lying outside the specified window
>
> This is puzzling, because when they are plotted using the following 
> code, they overlap
>
> plot(NYBorough)
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>
> and there are only 217 points in this group, so it appears that they are all rejected.
>
> I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
> I get the same warning with both shapefiles.
>
> Does it seem like the error is resulting from the shapefile I am using or some other error in the code?
>
> Any help would be very much appreciated.
>
> Thanks!
>
> Abby
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


--
Marcelino de la Cruz Rot
Depto. de Biolog?a Vegetal
Universidad Polit?cnica de Madrid
Madrid, Espa?a


From arudolph at PIRE.org  Thu Mar  7 16:05:25 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Thu, 7 Mar 2013 10:05:25 -0500
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
	<5138475F.5010707@upm.es> 
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45B3EBC28C9@MDMBX.PIRE.org>

I just wanted to clarify from my previous email that if I use spatstat.options(checkpolygons=FALSE), I am able to create this polygon.  However, I believe that for the code that follows, meters is too small of a unit and I need the data in miles.  Is there anyway to convert to miles from meters at this stage?

Thanks,
Abby

-----Original Message-----
From: Abby Rudolph 
Sent: Thursday, March 07, 2013 9:31 AM
To: 'Marcelino de la Cruz'
Cc: r-sig-geo at r-project.org
Subject: RE: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon

Hi Marcelino,

I think what I would like to do is convert the shapefile comprised of multiple polygons into a single object of class owin.
However, when I use the code as(NYCBorough, "owin") I get the following error:
Error in owin(poly = opls): Polygon data contain overlaps between polygons.

Is there a way to get around this?

Regarding the miles part, I need to convert both to miles for a calculation that comes later on in my code.

Thanks,
Abby

-----Original Message-----
From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
Sent: Thursday, March 07, 2013 2:53 AM
To: Abby Rudolph
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon

Hi,
My first advise is to point you to the vignette about "handling shape les in the spatstat package" .Go to section 3.2.5 "Objects of class SpatialPolygons".

In short, you could do something like this:

BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
play2<-ppp(play$X_m,play$Y_m, window=as.owin(BaltCity2))

...if you want to combine all polygons inside baltcity_mdsp83m.shp in just one window. See the section section 3.2.5 "Objects of class SpatialPolygons" for the other option (having different windows from each indiviual polygon).

As you can see, I also removed the "meter to miles" conversion because it's unnecesary  if both the shapes and the  play$X_m and play$Y_m coordinates are in the same units (metres)


HTH,
Marcelino


El 07/03/2013 4:51, Abby Rudolph escribi?:
> Hi,
>
> I was given the following code to determine whether the spatial 
> distribution of attribute=1 is significantly different from the spatial distribution of attribute=0 given that the points (overall) are not randomly distributed in space.
>
>
> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
> summary(BaltCity2)
>
> x<-BaltCity2 at polygons[[1]]@Polygons
> x
> summary(x)
> # this shows that the baltimore polygon is a single shape # the 
> Baltimore shapefile is projected in meters, so the following code 
> converts meters to miles
> coords<-slot(x[[1]],"coords")
> coords<-coords[167:1,]
> coords<-coords[-1,]
> coords.mi<-coords*0.000621371192
> summary(coords.mi)
>
> play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
>             window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))
>
> I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.
>
> However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters.
> When I plot the following in R, the points from my data file map onto 
> the shapefile and both are in meters
>
> plot(NYCBB)
> u<-RDS_TSO$RDS_new==0
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
> points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")
>
> However, when I use the code below to convert the meters to miles:
>
> x<-NYBorough at polygons[[1]]@Polygons
> x
> # there are 8910 rows in x
> summary(x)
> # x is 5 different shapes compared to one like in the baltimore example above
>       Length Class   Mode
> [1,] 1      Polygon S4
> [2,] 1      Polygon S4
> [3,] 1      Polygon S4
> [4,] 1      Polygon S4
> [5,] 1      Polygon S4
>
> coords<-slot(x[[1]],"coords")
> coords
> # Now there are only 47 rows - with the baltimore data there was no 
> reduction - I suspect it is being limited in some way 
> coords<-coords[19:1,] coords coords<-coords[-1,] coords
> NYBorough.coords.mi<-coords*0.000621371192
> NYBorough.coords.mi
>
> then, when I try to convert my data x,y coordinates from meters to 
> miles and create a shape with the NYBorough owin, I get a warning that 
> all of the points fall outside the window
>
> RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192
> ,
>             
> window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[
> ,2])))
>
> I received the following warning:
> Warning message:
> In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
>    217 points were rejected as lying outside the specified window
>
> This is puzzling, because when they are plotted using the following 
> code, they overlap
>
> plot(NYBorough)
> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>
> and there are only 217 points in this group, so it appears that they are all rejected.
>
> I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
> I get the same warning with both shapefiles.
>
> Does it seem like the error is resulting from the shapefile I am using or some other error in the code?
>
> Any help would be very much appreciated.
>
> Thanks!
>
> Abby
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


--
Marcelino de la Cruz Rot
Depto. de Biolog?a Vegetal
Universidad Polit?cnica de Madrid
Madrid, Espa?a


From marcelino.delacruz at upm.es  Thu Mar  7 16:05:54 2013
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 07 Mar 2013 16:05:54 +0100
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
In-Reply-To: <0F5A69EADAE27F44B09561937B83C3A45B3EBC287F@MDMBX.PIRE.org>
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
	<5138475F.5010707@upm.es>
	<0F5A69EADAE27F44B09561937B83C3A45B3EBC287F@MDMBX.PIRE.org>
Message-ID: <5138ACD2.9090202@upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130307/1cde6305/attachment.pl>

From corey.sparks at UTSA.EDU  Thu Mar  7 16:13:04 2013
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Thu, 7 Mar 2013 07:13:04 -0800 (PST)
Subject: [R-sig-Geo] GWR with some parameters held constant
Message-ID: <1362669184279-7583002.post@n2.nabble.com>

Dear List,
This is more of a conceptual question. Let's say I have a regression model
with a gaussian outcome and two continuous predictors and the model shows
evidence of nonstationarity in one of the beta parameters for the
predictors, but not the other. In this case I may be interested in using GWR
to model the nonstationarity in the first parameter, while holding the
second constant at its OLS estimate. I've used GWR in the past with great
effect, but I think this is an interesting scenario.  I would really like to
hear what everyone thinks about this, and if it would be possible to hack
the gwr() code to make this model possible.

it would be like this:
library(spgwr)
data(columbus)

col.lm <- lm(crime ~ income + housing, data=columbus)
summary(col.lm)
#gives beta (housing) = -0.27

#Let's say that this is assumed stationary, I basically want to keep this
constant in the model, would a quick and dirty way to do this just be:
#this doesn't work of course

col.bw <- gwr.sel(crime ~ income + -(.27*housing), data=columbus,
                  coords=cbind(columbus$x, columbus$y))
col.gauss <- gwr(crime ~ income + -(.27*housing), data=columbus,
                 coords=cbind(columbus$x, columbus$y), bandwidth=col.bw)

#And I would want to get the GWR estimates for the location specific effect
of income, while holding the effect of housing constant.

Thanks all for any ideas
Corey Sparks





-----
Corey Sparks
Assistant professor
Department of Demography
The University of Texas at San Antonio
501 West Cesar E Chavez Blvd
San Antonio TX 78207
Corey.sparks 'at' utsa.edu
210 458 3166 &lt;tel:210%20458%203166&gt;
Latitude: 29.423614  /  Longitude: -98.504282
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/GWR-with-some-parameters-held-constant-tp7583002.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From marcelino.delacruz at upm.es  Thu Mar  7 16:13:33 2013
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 07 Mar 2013 16:13:33 +0100
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
In-Reply-To: <0F5A69EADAE27F44B09561937B83C3A45B3EBC28C9@MDMBX.PIRE.org>
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
	<5138475F.5010707@upm.es>
	<0F5A69EADAE27F44B09561937B83C3A45B3EBC28C9@MDMBX.PIRE.org>
Message-ID: <5138AE9D.8060009@upm.es>

You can convert at a later stage (i.e. once you have created the ppp 
object) with the functions rescale.ppp and unitname



El 07/03/2013 16:05, Abby Rudolph escribi?:
> I just wanted to clarify from my previous email that if I use spatstat.options(checkpolygons=FALSE), I am able to create this polygon.  However, I believe that for the code that follows, meters is too small of a unit and I need the data in miles.  Is there anyway to convert to miles from meters at this stage?
>
> Thanks,
> Abby
>
> -----Original Message-----
> From: Abby Rudolph
> Sent: Thursday, March 07, 2013 9:31 AM
> To: 'Marcelino de la Cruz'
> Cc: r-sig-geo at r-project.org
> Subject: RE: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon
>
> Hi Marcelino,
>
> I think what I would like to do is convert the shapefile comprised of multiple polygons into a single object of class owin.
> However, when I use the code as(NYCBorough, "owin") I get the following error:
> Error in owin(poly = opls): Polygon data contain overlaps between polygons.
>
> Is there a way to get around this?
>
> Regarding the miles part, I need to convert both to miles for a calculation that comes later on in my code.
>
> Thanks,
> Abby
>
> -----Original Message-----
> From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
> Sent: Thursday, March 07, 2013 2:53 AM
> To: Abby Rudolph
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon
>
> Hi,
> My first advise is to point you to the vignette about "handling shape les in the spatstat package" .Go to section 3.2.5 "Objects of class SpatialPolygons".
>
> In short, you could do something like this:
>
> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
> play2<-ppp(play$X_m,play$Y_m, window=as.owin(BaltCity2))
>
> ...if you want to combine all polygons inside baltcity_mdsp83m.shp in just one window. See the section section 3.2.5 "Objects of class SpatialPolygons" for the other option (having different windows from each indiviual polygon).
>
> As you can see, I also removed the "meter to miles" conversion because it's unnecesary  if both the shapes and the  play$X_m and play$Y_m coordinates are in the same units (metres)
>
>
> HTH,
> Marcelino
>
>
> El 07/03/2013 4:51, Abby Rudolph escribi?:
>> Hi,
>>
>> I was given the following code to determine whether the spatial
>> distribution of attribute=1 is significantly different from the spatial distribution of attribute=0 given that the points (overall) are not randomly distributed in space.
>>
>>
>> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
>> summary(BaltCity2)
>>
>> x<-BaltCity2 at polygons[[1]]@Polygons
>> x
>> summary(x)
>> # this shows that the baltimore polygon is a single shape # the
>> Baltimore shapefile is projected in meters, so the following code
>> converts meters to miles
>> coords<-slot(x[[1]],"coords")
>> coords<-coords[167:1,]
>> coords<-coords[-1,]
>> coords.mi<-coords*0.000621371192
>> summary(coords.mi)
>>
>> play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
>>              window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))
>>
>> I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.
>>
>> However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters.
>> When I plot the following in R, the points from my data file map onto
>> the shapefile and both are in meters
>>
>> plot(NYCBB)
>> u<-RDS_TSO$RDS_new==0
>> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>> points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")
>>
>> However, when I use the code below to convert the meters to miles:
>>
>> x<-NYBorough at polygons[[1]]@Polygons
>> x
>> # there are 8910 rows in x
>> summary(x)
>> # x is 5 different shapes compared to one like in the baltimore example above
>>        Length Class   Mode
>> [1,] 1      Polygon S4
>> [2,] 1      Polygon S4
>> [3,] 1      Polygon S4
>> [4,] 1      Polygon S4
>> [5,] 1      Polygon S4
>>
>> coords<-slot(x[[1]],"coords")
>> coords
>> # Now there are only 47 rows - with the baltimore data there was no
>> reduction - I suspect it is being limited in some way
>> coords<-coords[19:1,] coords coords<-coords[-1,] coords
>> NYBorough.coords.mi<-coords*0.000621371192
>> NYBorough.coords.mi
>>
>> then, when I try to convert my data x,y coordinates from meters to
>> miles and create a shape with the NYBorough owin, I get a warning that
>> all of the points fall outside the window
>>
>> RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192
>> ,
>>              
>> window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[
>> ,2])))
>>
>> I received the following warning:
>> Warning message:
>> In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
>>     217 points were rejected as lying outside the specified window
>>
>> This is puzzling, because when they are plotted using the following
>> code, they overlap
>>
>> plot(NYBorough)
>> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>>
>> and there are only 217 points in this group, so it appears that they are all rejected.
>>
>> I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
>> I get the same warning with both shapefiles.
>>
>> Does it seem like the error is resulting from the shapefile I am using or some other error in the code?
>>
>> Any help would be very much appreciated.
>>
>> Thanks!
>>
>> Abby
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Marcelino de la Cruz Rot
> Depto. de Biolog?a Vegetal
> Universidad Polit?cnica de Madrid
> Madrid, Espa?a
>
>


-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a Vegetal
Universidad Polit?cnica de Madrid
Madrid, Espa?a


From cmontes at arauco.cl  Thu Mar  7 16:29:00 2013
From: cmontes at arauco.cl (Cristian Montes)
Date: Thu, 7 Mar 2013 07:29:00 -0800 (PST)
Subject: [R-sig-Geo] TPS with linear predictors
Message-ID: <1362670140228-7583004.post@n2.nabble.com>

Hello,

I am trying to add linear predictions to my thinn-plate spline model. 
Fitting the model works fine, however I don?t get to produce a map
afterwards.  Any ideas?

Cristi?n

library(RODBC)    
library(sp)       
library(rgdal)    
library(fields)   
library(maptools) 
library(raster)


#The following is my database for model fitting
my_file <- odbcConnectExcel2007("PTOS_FIN2_mat.xlsx")
data   <- sqlFetch(my_file, "PTOS_FIN2_mat")
close(my_file)

coordinates(data) <- c("X_COORD", "Y_COORD")

data.tp            <- Tps( coordinates(data),
                                            data$IS_W,
                                            Z = c(mpar = data$M_PARENTAL),  
                                            scale.type = "unscaled")

#Eventually I could add more than one linear predictor using cbind as in
Z=cbind(mpar=data$M_PARENTAL, clay = data$M_ARCILLA)



#Now I read the grids from Hdrive.
my_matpar   <- readGDAL("mat_par1.tif")

#Transform them to lists to get each vector for interpolation
my_matpar <- as.image.SpatialGridDataFrame(my_matpar)

data.predicho      <- predict.surface(data.tp, grid.list = list(X_COORD =
my_matpar$x,
                                                                Y_COORD =
my_matpar$y),  Z= my_matpar$z)


However this last line doesn?t work.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/TPS-with-linear-predictors-tp7583004.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From arudolph at PIRE.org  Thu Mar  7 16:32:13 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Thu, 7 Mar 2013 10:32:13 -0500
Subject: [R-sig-Geo] random spatial distribution code / shapefiles with
 more than one polygon
In-Reply-To: <5138AE9D.8060009@upm.es>
References: <0F5A69EADAE27F44B09561937B83C3A45B3E852BE9@MDMBX.PIRE.org>
	<5138475F.5010707@upm.es>
	<0F5A69EADAE27F44B09561937B83C3A45B3EBC28C9@MDMBX.PIRE.org>
	<5138AE9D.8060009@upm.es>
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45B3EBC2916@MDMBX.PIRE.org>

Thanks so much!  I really appreciate your help!

Abby

-----Original Message-----
From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
Sent: Thursday, March 07, 2013 10:14 AM
To: Abby Rudolph
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon

You can convert at a later stage (i.e. once you have created the ppp 
object) with the functions rescale.ppp and unitname



El 07/03/2013 16:05, Abby Rudolph escribi?:
> I just wanted to clarify from my previous email that if I use spatstat.options(checkpolygons=FALSE), I am able to create this polygon.  However, I believe that for the code that follows, meters is too small of a unit and I need the data in miles.  Is there anyway to convert to miles from meters at this stage?
>
> Thanks,
> Abby
>
> -----Original Message-----
> From: Abby Rudolph
> Sent: Thursday, March 07, 2013 9:31 AM
> To: 'Marcelino de la Cruz'
> Cc: r-sig-geo at r-project.org
> Subject: RE: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon
>
> Hi Marcelino,
>
> I think what I would like to do is convert the shapefile comprised of multiple polygons into a single object of class owin.
> However, when I use the code as(NYCBorough, "owin") I get the following error:
> Error in owin(poly = opls): Polygon data contain overlaps between polygons.
>
> Is there a way to get around this?
>
> Regarding the miles part, I need to convert both to miles for a calculation that comes later on in my code.
>
> Thanks,
> Abby
>
> -----Original Message-----
> From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
> Sent: Thursday, March 07, 2013 2:53 AM
> To: Abby Rudolph
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] random spatial distribution code / shapefiles with more than one polygon
>
> Hi,
> My first advise is to point you to the vignette about "handling shape les in the spatstat package" .Go to section 3.2.5 "Objects of class SpatialPolygons".
>
> In short, you could do something like this:
>
> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
> play2<-ppp(play$X_m,play$Y_m, window=as.owin(BaltCity2))
>
> ...if you want to combine all polygons inside baltcity_mdsp83m.shp in just one window. See the section section 3.2.5 "Objects of class SpatialPolygons" for the other option (having different windows from each indiviual polygon).
>
> As you can see, I also removed the "meter to miles" conversion because it's unnecesary  if both the shapes and the  play$X_m and play$Y_m coordinates are in the same units (metres)
>
>
> HTH,
> Marcelino
>
>
> El 07/03/2013 4:51, Abby Rudolph escribi?:
>> Hi,
>>
>> I was given the following code to determine whether the spatial
>> distribution of attribute=1 is significantly different from the spatial distribution of attribute=0 given that the points (overall) are not randomly distributed in space.
>>
>>
>> BaltCity2<-readShapePoly("baltcity_mdsp83m.shp")
>> summary(BaltCity2)
>>
>> x<-BaltCity2 at polygons[[1]]@Polygons
>> x
>> summary(x)
>> # this shows that the baltimore polygon is a single shape # the
>> Baltimore shapefile is projected in meters, so the following code
>> converts meters to miles
>> coords<-slot(x[[1]],"coords")
>> coords<-coords[167:1,]
>> coords<-coords[-1,]
>> coords.mi<-coords*0.000621371192
>> summary(coords.mi)
>>
>> play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
>>              window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))
>>
>> I am able to get the program to work when I use the Baltimore shapefile because the polygon is a single shape.
>>
>> However, when I apply this code to data I have collected from New York City, I have problems.  I am wondering if the problem is the result of the NYC shapefile having multiple polygons and water gaps.  I have been attempting this code with two different NYC shapefiles.  The first is from NYC Bytes.  I brought it into ArcMap and projected it into meters.
>> When I plot the following in R, the points from my data file map onto
>> the shapefile and both are in meters
>>
>> plot(NYCBB)
>> u<-RDS_TSO$RDS_new==0
>> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>> points(RDS_TSOm$X_m[!u],RDS_TSOm$Y_m[!u],pch=5,col="red")
>>
>> However, when I use the code below to convert the meters to miles:
>>
>> x<-NYBorough at polygons[[1]]@Polygons
>> x
>> # there are 8910 rows in x
>> summary(x)
>> # x is 5 different shapes compared to one like in the baltimore example above
>>        Length Class   Mode
>> [1,] 1      Polygon S4
>> [2,] 1      Polygon S4
>> [3,] 1      Polygon S4
>> [4,] 1      Polygon S4
>> [5,] 1      Polygon S4
>>
>> coords<-slot(x[[1]],"coords")
>> coords
>> # Now there are only 47 rows - with the baltimore data there was no
>> reduction - I suspect it is being limited in some way
>> coords<-coords[19:1,] coords coords<-coords[-1,] coords
>> NYBorough.coords.mi<-coords*0.000621371192
>> NYBorough.coords.mi
>>
>> then, when I try to convert my data x,y coordinates from meters to
>> miles and create a shape with the NYBorough owin, I get a warning that
>> all of the points fall outside the window
>>
>> RDS<-ppp(RDS_TSOm$X_m[u]*0.000621371192,RDS_TSOm$Y_m[u]*0.000621371192
>> ,
>>              
>> window=owin(poly=list(x=NYBorough.coords.mi[,1],y=NYBorough.coords.mi[
>> ,2])))
>>
>> I received the following warning:
>> Warning message:
>> In ppp(RDS_TSOm$X_m[u] * 0.000621371192, RDS_TSOm$Y_m[u] * 0.000621371192,  :
>>     217 points were rejected as lying outside the specified window
>>
>> This is puzzling, because when they are plotted using the following
>> code, they overlap
>>
>> plot(NYBorough)
>> points(RDS_TSOm$X_m[u],RDS_TSOm$Y_m[u],pch=5,col="yellow")
>>
>> and there are only 217 points in this group, so it appears that they are all rejected.
>>
>> I've also tried downloading the TIGER files from the US Census and merging all 5 boroughs, projecting the data in arcmap into meters and opening in R.
>> I get the same warning with both shapefiles.
>>
>> Does it seem like the error is resulting from the shapefile I am using or some other error in the code?
>>
>> Any help would be very much appreciated.
>>
>> Thanks!
>>
>> Abby
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Marcelino de la Cruz Rot
> Depto. de Biolog?a Vegetal
> Universidad Polit?cnica de Madrid
> Madrid, Espa?a
>
>


-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a Vegetal
Universidad Polit?cnica de Madrid
Madrid, Espa?a


From Roger.Bivand at nhh.no  Thu Mar  7 18:56:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Mar 2013 18:56:41 +0100
Subject: [R-sig-Geo] GWR with some parameters held constant
In-Reply-To: <1362669184279-7583002.post@n2.nabble.com>
References: <1362669184279-7583002.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1303071838110.6627@reclus.nhh.no>

On Thu, 7 Mar 2013, Corey Sparks wrote:

> Dear List,
> This is more of a conceptual question. Let's say I have a regression model
> with a gaussian outcome and two continuous predictors and the model shows
> evidence of nonstationarity in one of the beta parameters for the
> predictors, but not the other. In this case I may be interested in using GWR
> to model the nonstationarity in the first parameter, while holding the
> second constant at its OLS estimate. I've used GWR in the past with great
> effect, but I think this is an interesting scenario.  I would really like to
> hear what everyone thinks about this, and if it would be possible to hack
> the gwr() code to make this model possible.
>
> it would be like this:
> library(spgwr)
> data(columbus)
>
> col.lm <- lm(crime ~ income + housing, data=columbus)
> summary(col.lm)
> #gives beta (housing) = -0.27
>
> #Let's say that this is assumed stationary, I basically want to keep this
> constant in the model, would a quick and dirty way to do this just be:
> #this doesn't work of course
>
> col.bw <- gwr.sel(crime ~ income + -(.27*housing), data=columbus,
>                  coords=cbind(columbus$x, columbus$y))
> col.gauss <- gwr(crime ~ income + -(.27*housing), data=columbus,
>                 coords=cbind(columbus$x, columbus$y), bandwidth=col.bw)

Either of:

col.lm <- lm(crime ~ housing, data=columbus)
columbus$pred_crime <- predict(col.lm)
col.bw <- gwr.sel(pred_crime ~ income, data=columbus,
   coords=cbind(columbus$x, columbus$y))
col.gauss <- gwr(pred_crime ~ income, data=columbus,
   coords=cbind(columbus$x, columbus$y), bandwidth=col.bw)

col.lm <- lm(crime ~ income + housing, data=columbus)
columbus$h27 <- coef(col.lm)[3]*columbus$housing
col.bw <- gwr.sel(crime ~ income + offset(h27), data=columbus,
   coords=cbind(columbus$x, columbus$y))
col.gauss <- gwr(crime ~ income + offset(h27), data=columbus,
   coords=cbind(columbus$x, columbus$y), bandwidth=col.bw)

do something, the first one includes an intercept twice, the second 
relies on the offset term being handled correctly, which unfortunately it 
isn't. Given the doubts about GWR in Paez et al. 2011, I haven't thought 
it worth the trouble to use more time on the package. I don't think the 
gwrr package offers this variant.

Roger

>
> #And I would want to get the GWR estimates for the location specific effect
> of income, while holding the effect of housing constant.
>
> Thanks all for any ideas
> Corey Sparks
>
>
>
>
>
> -----
> Corey Sparks
> Assistant professor
> Department of Demography
> The University of Texas at San Antonio
> 501 West Cesar E Chavez Blvd
> San Antonio TX 78207
> Corey.sparks 'at' utsa.edu
> 210 458 3166 &lt;tel:210%20458%203166&gt;
> Latitude: 29.423614  /  Longitude: -98.504282
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/GWR-with-some-parameters-held-constant-tp7583002.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From corey.sparks at UTSA.EDU  Thu Mar  7 19:07:41 2013
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Thu, 7 Mar 2013 10:07:41 -0800 (PST)
Subject: [R-sig-Geo] GWR with some parameters held constant
In-Reply-To: <alpine.LRH.2.03.1303071838110.6627@reclus.nhh.no>
References: <1362669184279-7583002.post@n2.nabble.com>
	<alpine.LRH.2.03.1303071838110.6627@reclus.nhh.no>
Message-ID: <1362679661952-7583007.post@n2.nabble.com>

Thanks, the first method seems more straight forward, especially if the
offset() term doesn't really work, kind of like a gwr meets two stage least
squares solution.  Thank you for your thoughts
CS



-----
Corey Sparks
Assistant professor
Department of Demography
The University of Texas at San Antonio
501 West Cesar E Chavez Blvd
San Antonio TX 78207
Corey.sparks 'at' utsa.edu
210 458 3166 &lt;tel:210%20458%203166&gt;
Latitude: 29.423614  /  Longitude: -98.504282
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/GWR-with-some-parameters-held-constant-tp7583002p7583007.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From swagathnavin82 at gmail.com  Thu Mar  7 22:14:47 2013
From: swagathnavin82 at gmail.com (Swagath)
Date: Thu, 07 Mar 2013 22:14:47 +0100
Subject: [R-sig-Geo] gdalwarp gives different cellsize when re-projected
In-Reply-To: <51389B8F.5050804@gmail.com>
References: <51389634.8020909@gmail.com> <51389B8F.5050804@gmail.com>
Message-ID: <51390347.4080101@gmail.com>

Hello,

Thank you very much for your reply. After some careful reading about 
GDAL i was able to change the resolution once i re-projected the grid.

i used the following command

gdalwarp outfile2.tif outfile3.tif -tr 0.05 0.05

outfile2.tif-0.065 resolution
outfile3.tif-0.05 resolution

Thanks,
Navin

On 3/7/13 2:52 PM, Alexandre Villers wrote:
> Hello,
>
> Well, given you went from a projected to a geographic coordinates
> system, you changed the unit of the grid from meters to degrees.
> So I wouldn't be surprised and I guess nothing went wrong as long you
> specified the correct EPSG for your original file.
>
> HTH
>
> Alex
>
> On 07/03/2013 15:29, Swagath Navin wrote:
>> Dear all,
>>
>> I have a large data-frame with Lon, Lat , Value . Coordinates
>> projected in EPSG:3035 with a resolution of 5 kmx5 km. I converted
>> this into a SGDF. My goal was to project the file into EPSG:4326 with
>> a resolution of 0.05. For re-projecting  i converted the file to tif
>> using
>>
>> writeGDAL(df, "file.tif")
>>
>> and used the gdalwarp
>>
>> gdalwarp file.tif outfile.tif -t_srs "+init=epsg:4326"
>>
>> However while comparing both files the cell size is different.
>>
>> getGridTopology(file1)
>>                         x       y
>> cellcentre.offset 2638500 1430500
>> cellsize             5000    5000
>> cells.dim             664     797
>> projargs: chr " +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000
>> +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>>
>> getGridTopology(file2)
>>                            x            y
>> cellcentre.offset  -31.31150705  34.11186136
>> cellsize             0.06515996   0.06515996
>> cells.dim         1254.00000000 580.00000000
>>
>> projargs: chr " +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
>> +towgs84=0,0,0"
>>
>> Can anyone please tell me where it went wrong.
>>
>> Thanks for your time.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>


From roman.lustrik at gmail.com  Fri Mar  8 07:44:14 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 8 Mar 2013 07:44:14 +0100
Subject: [R-sig-Geo] Memory...
In-Reply-To: <20130307125801.39u9h1izdws40g4w@webmail.nephele-idea.de>
References: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>
	<20130307125801.39u9h1izdws40g4w@webmail.nephele-idea.de>
Message-ID: <CAHT1vphnrAGpLXEZCWjsZb2gzsia=_8ZbXb0SJoi81cjfxXF4g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/476eef86/attachment.pl>

From swagathnavin82 at gmail.com  Fri Mar  8 08:43:06 2013
From: swagathnavin82 at gmail.com (Swagath)
Date: Fri, 08 Mar 2013 08:43:06 +0100
Subject: [R-sig-Geo] coordinates in Albers Equal Area Conic projection
Message-ID: <5139968A.3050106@gmail.com>

Not an expert in reading or interpreting map-projections. I have data 
set with the following description.

     The coordinates are in Albers Equal Area Conic projection, with the 
following projection settings: Scale = 1; False Easting(m) = 5000000; 
False Northing(m) = 0; Longitude Origin = 20; Latitude Origin = 0; 
Standard Parallel 1 = 45; Standard Parallel 2 = 55, and the Ellipsoid is 
WGS 84.

I tired to set the right coordinate system:

proj4string(df) = CRS("+proj=aea 
+lon_0=20+lat_0=0+lat_1=45+lat_2=55+x_0=5000000+y_0=0+ellps=wgs84+units=m")

I appreciate suggestions on what I might be missing.

Thanks, Navin


From mdsumner at gmail.com  Fri Mar  8 09:30:12 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 8 Mar 2013 19:30:12 +1100
Subject: [R-sig-Geo] coordinates in Albers Equal Area Conic projection
In-Reply-To: <5139968A.3050106@gmail.com>
References: <5139968A.3050106@gmail.com>
Message-ID: <CAAcGz99WEMZkV5NEL+hux5tswTm97+p20t7HpenXgFMLEfj-pw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/65f044f3/attachment.pl>

From fabian.ries at hydrology.uni-freiburg.de  Fri Mar  8 11:00:35 2013
From: fabian.ries at hydrology.uni-freiburg.de (Fabian Ries)
Date: Fri, 08 Mar 2013 11:00:35 +0100
Subject: [R-sig-Geo] assign coordinates(...) possible on rows?
Message-ID: <CD5F7553.907F%fabian.ries@hydrology.uni-freiburg.de>

Dear all,

I want to realize spatial analysis on rainfall data on a five minute time
step. 
The data has the following format.

Station		Stat_01	Stat_02	Stat_03	Stat_04	
X		180000	195900	181950	192150	
Y		157550	150950	154550	141650	
30.04.11 00:05	0	0	0	0
30.04.11 00:10	0	0	0	0
30.04.11 00:15	0	0	0	0
30.04.11 00:20	0	0	0	0
30.04.11 00:25	0.2	0.4	1.2	0
30.04.11 00:30	0	0	0	0
30.04.11 00:35	0	0	0	0
30.04.11 00:40	0	0	0	0
30.04.11 00:45	0	0	0	0
30.04.11 00:50	0	0	0	0

When I convert the data now into SpatialPointsDataFrame I have to assign
coordinates(data) <? ~X+Y. All examples I saw until now are transposing
the data first so that the coordinates are changed to columns. If I follow
these examples and convert my data with t(data) I end up with a
SpatialPointsDataFrame with a huge amount of columns and have performance
problems to do some simple calculations through every object in the
dataframe.

I'm happy about any help
Cheers
Fabian


From julian at hafro.is  Fri Mar  8 11:18:09 2013
From: julian at hafro.is (Julian Burgos)
Date: Fri, 8 Mar 2013 10:18:09 -0000 (GMT)
Subject: [R-sig-Geo] Problem with raster package and netcdf file
Message-ID: <57081.82.134.28.207.1362737889.squirrel@www.hafro.is>

Dear list,

I am having some troubles opening accessing a raster in the netCDF format.
 The file is bathimetric data from GEBCO:
http://www.gebco.net/data_and_products/gridded_bathymetry_data/

If I use the ncdf4 package to open and access the data, I have no issues:

library(ncdf4)
> d <- nc_open("gebco_08_-82_37_63_80.nc")
> z <- as.vector(ncvar_get(d,varid="z"))
> head(z)
[1]  19  40  61  83 106 128


But if I try to use the raster package to access the file and create a
raster object, I get the following error:

bat <- raster(file="gebco_08_-82_37_63_80",varname="z")
Error in .varName(nc, varname, warn = warn) :
  varname: z does not exist in the file. Select one from:

... and no varnames are listed.


If I do not define a variable name and let the raster package choose it, I
get this:

> bat <- raster(file="gebco_08_-82_37_63_80",varname="z")
Error in .varName(nc, varname, warn = warn) :

The description of the netCDF file is as following:

> d
[1] "File gebco_08_-82_37_63_80.nc (NC_FORMAT_CLASSIC):"
[1] ""
[1] "     6 variables:"
[1] "        double x_range[side]   "
[1] "            units: user_x_unit"
[1] "        double y_range[side]   "
[1] "            units: user_y_unit"
[1] "        short z_range[side]   "
[1] "            units: user_z_unit"
[1] "        double spacing[side]   "
[1] "        int dimension[side]   "
[1] "        short z[xysize]   "
[1] "            scale_factor: 1"
[1] "            add_offset: 0"
[1] "            node_offset: 1"
[1] ""
[1] "     2 dimensions:"
[1] "        side  Size:2"
[1] "        xysize  Size:89784000"
[1] ""
[1] "    2 global attributes:"
[1] "        title: GEBCO_08 Grid"
[1] "        source: 20100927"

I am using R 15.2 on Linux (Fedora), raster 2.1-8, and ncdf4 version
ncdf4_1.6.1_20120411.
Any help will be welcomed!

Julian

-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From rossahmed at googlemail.com  Fri Mar  8 12:08:42 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 08 Mar 2013 11:08:42 +0000
Subject: [R-sig-Geo] randomly sample points
Message-ID: <CD5F773A.3FF5%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/61374225/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Mar  8 14:49:13 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 8 Mar 2013 14:49:13 +0100
Subject: [R-sig-Geo] randomly sample points
In-Reply-To: <CD5F773A.3FF5%rossahmed@gmail.com>
References: <CD5F773A.3FF5%rossahmed@gmail.com>
Message-ID: <CAGfc75mddje=8vmsYb2dR_p0iymjtGZOVo4vO93TOcg00Bj1=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/241897c6/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Mar  8 14:49:44 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 8 Mar 2013 14:49:44 +0100
Subject: [R-sig-Geo] randomly sample points
In-Reply-To: <CAGfc75mddje=8vmsYb2dR_p0iymjtGZOVo4vO93TOcg00Bj1=g@mail.gmail.com>
References: <CD5F773A.3FF5%rossahmed@gmail.com>
	<CAGfc75mddje=8vmsYb2dR_p0iymjtGZOVo4vO93TOcg00Bj1=g@mail.gmail.com>
Message-ID: <CAGfc75nmAsWGjFWoTpWGOULX6-K+LVFs4Y943H_6SycJqLVf1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/04859a05/attachment.pl>

From smckay at rand.org  Fri Mar  8 18:08:59 2013
From: smckay at rand.org (Mckay, Shawn)
Date: Fri, 8 Mar 2013 17:08:59 +0000
Subject: [R-sig-Geo] Click issue segmentGoogleMaps
Message-ID: <5D0948A37D1C384580C2C715171423C249DC4946@smmb2.rand.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/9e571bc8/attachment.pl>

From milan.kili11 at gmail.com  Fri Mar  8 20:33:17 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Fri, 8 Mar 2013 20:33:17 +0100
Subject: [R-sig-Geo] Click issue segmentGoogleMaps ( pie for
 plotGoogleMaps, spplot and plotKML)
Message-ID: <CAPSaU-_QshTNjkFfUK237LFQWHuQNT0gL_pUKukbYrFWjNB1RA@mail.gmail.com>

Hi,

This is the bug in segment function, infoWindows at the moment this
works only for 3 variables. I'm sending to you alternative solution.
I'll fix it in new version of package. There will be fixed version of
segmentGoogleMaps, and added pie function which can be used for
sppplot and plotKML.

library('plotGoogleMaps')
data(meuse)
coordinates(meuse)<-~x+y
proj4string(meuse) <- CRS('+init=epsg:28992')

#################################################################################


# Function creates SPolyDF from points, piecharts from points  ,
modified from #plotGoogleMaps package
#
pie<-function(SPDF,
              zcol=1:length(SPDF at data),
              scalelist=TRUE,  # TRUE proportional, FALSE pie charts same size
              max.radius=100,  #m
              do.sqrt = TRUE,
              colPalette=rainbow(ncol(SPDF at data[,zcol])),
              fillColor=rainbow(length(zcol)),
              strokeColor="red"){

  ####  FUNCTION modified from plotGoogleMaps package

  createSphereSegment <- function(partOfSP,
                                  max.radius=100,  #m
                                  key.entries = as.numeric(partOfSP at data),
                                  scalelist=1,
                                  do.sqrt = TRUE,
                                  fillColor=rainbow(length(key.entries)),
                                  strokeColor="red",
                                  id=length(key.entries)) {

    center=coordinates(partOfSP)
    fillColor<-as.character(substr(fillColor,1,7))

    obj = as(partOfSP, "SpatialPointsDataFrame")
    z = as.numeric(partOfSP at data)
    # avoid negative values
    if (min(key.entries)<0 ){
      ke<-abs(min(key.entries))+ key.entries+mean(key.entries)
    }else{ke<-key.entries+min(key.entries)}     # no zeros for radius vecor
    # creating a vector for subgroupes
    if(do.sqrt){
      scale.level<- sqrt(ke/(max(ke)) ) }else{scale.level<-ke/(max(ke))}
    radius.level<-max.radius*scale.level
    # list of radiuses for createSphereCircle
    radius.vector<-   radius.level
    dfi<-cbind(rep(NA,1+length(radius.vector)))
    dfi[1]=0

    if(max(scale.level)==0)
    {scale.level=0.1
     scalelist=0.01}

    dfi[2:(length(radius.vector)+1)]=360/sum(scale.level)*  scale.level


    fi= cbind(rep(NA,2*length(radius.vector)) )
    dfi=as.numeric(dfi)
    for (i in (seq(2,length(fi),by=2))){
      fi[i]=sum(dfi[1:(i/2+1)])
    }
    fi[1]=0
    for (i in (seq(3,length(fi),by=2))){
      fi[i]=fi[i-1]
    }


    radius.vector=scalelist*max.radius/6378000

    lat1 <- (pi/180)* center[2];
    lng1 <- (pi/180)* center[1];

    paths<-as.list(rep(NA,length(radius.vector)))

    for(ik in (seq(2,length(fi),by=2))){
      radius<-  radius.vector

      coords<-cbind(rep(NA,11),rep(NA,11))
      coords[1,]  <- c(  center[,1], center[,2])
      j<-2
      for (i in seq(fi[ik-1],fi[ik],length.out=10)) {
        tc <- (pi/180)*i
        y <- asin(sin(lat1)*cos(radius)+cos(lat1)*sin(radius)*cos(tc))
        dlng <-
atan2(sin(tc)*sin(radius)*cos(lat1),cos(radius)-sin(lat1)*sin(y))
        x <- ((lng1-dlng+pi) %% (2*pi)) - pi

        coords[j,1] <-c(x*(180/pi))
        coords[j,2] <-c(y*(180/pi))
        j<-j+1
      }



      lonlat<-coords
      paths[[ik/2]]<-rbind(lonlat,lonlat[1,])
    }
    pol=paths
    lonlat<-rbind( paths[[1]],paths[[1]][1,])
    pol[[1]]<-Polygon(lonlat,hole=FALSE)
    pol[[1]]<-Polygons(list(pol[[1]]),ID=id-1)

    for(i in (2:(length(paths)))){
      lonlat<-rbind( paths[[i]],paths[[i]][1,])
      pol[[i]]<-Polygon(lonlat,hole=FALSE)
      pol[[i]]<-Polygons(list(pol[[i]]),ID=id-i)   }


    return(pol)

  }

  SP <-as(SPDF, "SpatialPointsDataFrame")
  SP.ll <- spTransform(SP, CRS("+proj=longlat +datum=WGS84"))
  SP.ll<-SP.ll[,zcol]

  if(strokeColor!=""){
    rgbc<-col2rgb(strokeColor)
    strokeColor<-rgb(rgbc[1],rgbc[2],rgbc[3],maxColorValue=255) }

  if(!is.null(colPalette)){
    rgbc<-col2rgb(colPalette)
    colPalette<-apply(rgbc,2,function(x) rgb(x[1],x[2],x[3],maxColorValue=255))}
  if(scalelist){
    xdata<-SP at data[,zcol]
    xdata <- apply(xdata, 2L, function(x) (x - min(x, na.rm =
TRUE))/diff(range(x, na.rm = TRUE)))
    xsum <- apply(xdata, 1L,function(x) ( sum(x)))
    scalelist<-xsum/max(xsum)
    scalelist<-sqrt(scalelist)} else{
scalelist<-rep(1,length(SP.ll at coords[,1])) }

  Pols<-as.list(rep(NA,length(SP.ll[,1])))
  Srl<-Pols
  num=(rep(NA,length(zcol)*length(SP.ll at data[,1])) )
  for(i in 1:length(SP.ll at data[,1])){
    Pols[[i]]<-createSphereSegment(SP.ll[i,zcol],
                                   max.radius=max.radius,  #m
                                   key.entries = ,
                                   scalelist= scalelist[i],
                                   do.sqrt = do.sqrt,
                                   fillColor=colPalette,
                                   strokeColor= strokeColor,
                                   id=i*length(as.numeric(SP.ll at data[i,zcol])))
    num[i*length(zcol)-(0:(length(zcol)-1))]=i

  }

  id=num  # rep(1:length(zcol),length(SP.ll at data[,1]))
  dat=data.frame(id)
  SP$id=1: length(SP.ll at data[,1])
  dat=merge(dat,SP at data)
  Pols=unlist(Pols)
  SPl<-SpatialPolygons(Pols,proj4string=SP.ll at proj4string)
  SPldf<-SpatialPolygonsDataFrame(SPl,dat,match.ID = FALSE)
  return(SPldf)
}

###########################  END OF FUNCTION pie ###############################
#
a=pie(meuse,zcol=c('zinc','lead','copper'))
a$col=rep(c('zinc','lead','copper'),155)
m=plotGoogleMaps(a,zcol='col',colPalette=c('red','green','blue') )

# this works for 2 or more variables.

 a=pie(meuse,zcol=c('zinc','lead','copper','dist.m'))
 a$col=rep(c('zinc','lead','copper','dist.m'),155)
 m=plotGoogleMaps(a,zcol='col',colPalette=rainbow(4) )

# you can use it for spplot
 a$col=rep(1:4,155)
 spplot(a,zcol='col', col.regions=rainbow(4))

# or for plotKML
plotKML(a)

Hope this helps.

Best,
Kili


On 3/8/13, Mckay, Shawn <smckay at rand.org> wrote:
> All,
>
> I am using the segmentGoogleMaps function to plot pie charts.   After
> running the function, the pie charts are not on the map (clicking loc puts
> the charts on the map).  The real problem is that when I click on the pie
> icon, the balloon does not appear.  When using the plotGoogleMaps function
> the balloon will appear when the icon is clicked.
>
> coordinates(loc) <- ~Lon+Lat
> proj4string(loc) <- CRS("+proj=longlat")
>
>
> m2 <- segmentGoogleMaps(loc,clickable =
> TRUE,zcol=c('a','b','c','d','e','f'),mapTypeId='ROADMAP',filename='excess.htm',max.radius
> = 300000)
>
>
> thx
>
> shawn
>
> __________________________________________________________________________
>
> This email message is for the sole use of the intended...{{dropped:20}}


From milan.kili11 at gmail.com  Fri Mar  8 20:54:45 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Fri, 8 Mar 2013 20:54:45 +0100
Subject: [R-sig-Geo] Click issue segmentGoogleMaps ( pie for
 plotGoogleMaps, spplot and plotKML)
In-Reply-To: <CAPSaU-_QshTNjkFfUK237LFQWHuQNT0gL_pUKukbYrFWjNB1RA@mail.gmail.com>
References: <CAPSaU-_QshTNjkFfUK237LFQWHuQNT0gL_pUKukbYrFWjNB1RA@mail.gmail.com>
Message-ID: <CAPSaU-9g7fCXQ=6jyv3ckFPr1XDTBUKJHv6w0aWXXm4yxm=kwA@mail.gmail.com>

 Hi,

 This is the bug in segment function,at the moment, infoWindow
 works only for 3 variables. I'm sending to you alternative solution.
 I'll fix it in new version of package. There will be fixed version of
 segmentGoogleMaps, and added pie function which can be used for
 spplot and plotKML.

 library('plotGoogleMaps')
 data(meuse)
 coordinates(meuse)<-~x+y
 proj4string(meuse) <- CRS('+init=epsg:28992')

 source('pie.R')

 a=pie(meuse,zcol=c('zinc','lead','copper'))
 a$col=rep(c('zinc','lead','copper'),155)
 m=plotGoogleMaps(a,zcol='col',colPalette=c('red','green','blue') )

 # this works for 2 or more variables.

  a=pie(meuse,zcol=c('zinc','lead','copper','dist.m'))
  a$col=rep(c('zinc','lead','copper','dist.m'),155)
  m=plotGoogleMaps(a,zcol='col',colPalette=rainbow(4) )

 # you can use it for spplot
  a$col=rep(1:4,155)
  spplot(a,zcol='col', col.regions=rainbow(4))

 # or for plotKML
 plotKML(a)

 Hope this helps.

 Best,
 Kili
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pie.R
Type: application/octet-stream
Size: 5047 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/2da96ae2/attachment.obj>

From amerinoviteri at gmail.com  Sat Mar  9 04:33:20 2013
From: amerinoviteri at gmail.com (Andres Merino-Viteri)
Date: Fri, 8 Mar 2013 22:33:20 -0500
Subject: [R-sig-Geo] Non overlaid random points
Message-ID: <CAHRdQt_7wtDbs2D6aUxtLQi=5O7h6WoWpuzB2E_7oiMzgLpUmw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130308/dfa12746/attachment.pl>

From mdsumner at gmail.com  Sat Mar  9 05:24:36 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 9 Mar 2013 15:24:36 +1100
Subject: [R-sig-Geo] Problem with raster package and netcdf file
In-Reply-To: <57081.82.134.28.207.1362737889.squirrel@www.hafro.is>
References: <57081.82.134.28.207.1362737889.squirrel@www.hafro.is>
Message-ID: <CAAcGz98=zBgEvoQy7FvWNp3KzQnTJoZFcEvwvaV6nWdMD-tv7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130309/81a2a1f8/attachment.pl>

From HodgessE at uhd.edu  Sun Mar 10 04:14:09 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 10 Mar 2013 03:14:09 +0000
Subject: [R-sig-Geo] a possible extension to spatial/spatio-temporal?
Message-ID: <FF9DB805FC41CC4E95825A50F6806302129322B5@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130310/0506d546/attachment.pl>

From r.hijmans at gmail.com  Sun Mar 10 07:16:36 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 9 Mar 2013 22:16:36 -0800
Subject: [R-sig-Geo] Non overlaid random points
In-Reply-To: <CAHRdQt_7wtDbs2D6aUxtLQi=5O7h6WoWpuzB2E_7oiMzgLpUmw@mail.gmail.com>
References: <CAHRdQt_7wtDbs2D6aUxtLQi=5O7h6WoWpuzB2E_7oiMzgLpUmw@mail.gmail.com>
Message-ID: <CANtt_hxRVHgZpcXfYx+XjKikhwR0U2qLVFnBxox1N8_rmvi_Yw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130309/b3ed7aae/attachment.pl>

From r.hijmans at gmail.com  Sun Mar 10 07:17:54 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 9 Mar 2013 22:17:54 -0800
Subject: [R-sig-Geo] randomly sample points
In-Reply-To: <CAGfc75nmAsWGjFWoTpWGOULX6-K+LVFs4Y943H_6SycJqLVf1A@mail.gmail.com>
References: <CD5F773A.3FF5%rossahmed@gmail.com>
	<CAGfc75mddje=8vmsYb2dR_p0iymjtGZOVo4vO93TOcg00Bj1=g@mail.gmail.com>
	<CAGfc75nmAsWGjFWoTpWGOULX6-K+LVFs4Y943H_6SycJqLVf1A@mail.gmail.com>
Message-ID: <CANtt_hzNVDvXJtPpomYBbZ0qXnKMcbwHAVa=FiXCqGc-n-+icQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130309/002a36fd/attachment.pl>

From phytophthorasb at yahoo.com  Sun Mar 10 19:48:00 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Sun, 10 Mar 2013 11:48:00 -0700 (PDT)
Subject: [R-sig-Geo] LocalG in spdep to calculate Gi*
Message-ID: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130310/9a37b833/attachment.pl>

From sheila_leite at hotmail.com  Mon Mar 11 01:36:54 2013
From: sheila_leite at hotmail.com (Sheila C Ferreira Leite)
Date: Mon, 11 Mar 2013 00:36:54 +0000
Subject: [R-sig-Geo] Format the ggplot2 map - Overlapping labels
Message-ID: <BAY158-w3227D20E0191D830EEA55FFBE10@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130311/8a04e7df/attachment.pl>

From oscar.perpinan at gmail.com  Mon Mar 11 08:05:00 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Mon, 11 Mar 2013 08:05:00 +0100
Subject: [R-sig-Geo] Format the ggplot2 map - Overlapping labels
In-Reply-To: <BAY158-w3227D20E0191D830EEA55FFBE10@phx.gbl>
References: <BAY158-w3227D20E0191D830EEA55FFBE10@phx.gbl>
Message-ID: <CAMLL7b=PhKTTj3tWn3qYwzsLR+oQGwNc7MpVWgGLpdRa+aM=qg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130311/90ed1ecd/attachment.pl>

From naimi at itc.nl  Mon Mar 11 12:23:01 2013
From: naimi at itc.nl (Babak Naimi)
Date: Mon, 11 Mar 2013 12:23:01 +0100
Subject: [R-sig-Geo] LocalG in spdep to calculate Gi*
Message-ID: <021F462EDC7F2B42A7038E9F9D47826126F71E5E86@itcnt27.itc.nl>

Hi Juliann,

You can use lisa function in usdm package which I implemented for calculating some of local statistics including local Gi* for raster data.

Hope this would help.

Cheers,
Babak


----------------------------------------------------------------------

Message: 1
Date: Sun, 10 Mar 2013 11:48:00 -0700 (PDT)
From: Empty Empty <phytophthorasb at yahoo.com>
To: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] LocalG in spdep to calculate Gi*
Message-ID:
        <1362941280.23258.YahooMailNeo at web142503.mail.bf1.yahoo.com>
Content-Type: text/plain

Hi,

I'm still a beginner at R and I'm trying also to learn some statistical techniques I haven't used before. Any suggestions will be appreciated.
???????? I have fairly large data sets (1 km population and climate data at a continent scale) that were originally raster. I couldn't figure out how to do local Gi* on a raster? -I'd love to know if there is a way to do it- so we've converted to points (and subset one country for learning how to do it). So my points are on a regular grid and I'm trying to use localG in spdep.
???????? What I have figured out is that I need to calculate neighbors (various options, e.g. knearneigh, but which one is appropriate depends on data - any guidance on determining which is appropriate?), then make that into an nb object (e.g. knn2nb), then make that into a spatial weights matrix or listw object (e.g.nb2listw, again pointers toward figuring out style would be welcome), then I can run localG. Am I on track so far?
??????? Then I want to somehow calculate statistical significance and plot the Gi* as a map. With so many points and comparisons, how do you figure out a critical value? Is it even possible/meaningful to calculate significance? The output R is the raw Gi* value (not a z-score), right?
??????? What I have below (gleaned from R help and some course notes I found online) worked on the subset and on the full continent data set and I got results that look reasonable and match up well with what my colleague did with another method. I guess that means my questions are more statistical than R, I apologize if this isn't the right place to ask those questions.
??????? I think that I could make the script more concise by not making each step into its own object, but I wasn't sure if I would need them again and each step takes a long time on the full data set. What is considered best practice in this regard?

library(spdep)
library(RANN)
library(rgdal)
library(classInt)

ethipt<-readOGR(".","ethipt")

coords<-coordinates(ethipt)
eth.knn <- knearneigh(coords, k=4,longlat = F, RANN= T) #calculate neighbors (still need to determine appropriate method & K)

eth.gal.nb<-knn2nb(eth.knn)? #make nb object

eth.listw <- nb2listw(include.self(eth.gal.nb), style="W")??? #give spatial weights to the neighbors list as listw object (still need to check appropriate "style")

ethG<-localG(ethipt$GRID_CODE,eth.listw)???? #calculate Gi*

#plot critical values of Gi*

sig3 <- classIntervals(ethG, n=3, style="fixed",
?????????????????????? fixedBreaks=c(min(ethG),-3.886, 3.886, max(ethG)))???? #3.886 isn't right CV -too many points? ?
cs<-c('blue','white','red') # blue = below -3, white = intermediate, red = above 3

sigcol <- findColours(sig3, cs)? # Map classes to colors

plot(ethipt, col=sigcol, axes=TRUE)
title("Local Gi* with 3.886 as critical value")
legend("left", fill=attr(sigcol, 'palette'), legend = names(attr(sigcol, 'table')))

Thanks a lot for any suggestions,

Juliann
        [[alternative HTML version deleted]]


From potts.a at gmail.com  Mon Mar 11 14:14:47 2013
From: potts.a at gmail.com (Alastair Potts)
Date: Mon, 11 Mar 2013 15:14:47 +0200
Subject: [R-sig-Geo] Species localities to richness maps - combining
	rasterize() and focal()
Message-ID: <CAG_8N1YCGDrXMtC-L-V+Ecn9L5RqbaWVomYsU1Jun-9huOKOGg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130311/21deaac1/attachment.pl>

From ppanday at clarku.edu  Mon Mar 11 16:06:38 2013
From: ppanday at clarku.edu (ppanday)
Date: Mon, 11 Mar 2013 08:06:38 -0700 (PDT)
Subject: [R-sig-Geo] extract by polygon ID
Message-ID: <1363014398250-7583031.post@n2.nabble.com>

Hi 

I have a vector polygon which has 3 categories. I am trying to extract a
raster(and rastergroup) using this vector and then summarize by the Id (3
polygon categories). Thanking ahead for any suggestions. 

Prajjwal

> test.vec
class       : SpatialPolygonsDataFrame 
nfeatures   : 1736 
extent      : -52.54233, -52.27729, -13.16048, -12.68169  (xmin, xmax, ymin,
ymax)
coord. ref. : NA 
nvariables  : 1
names       : Id 
min values  :  0 
max values  :  3

 







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extract-by-polygon-ID-tp7583031.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ancuervo at gmail.com  Mon Mar 11 19:23:56 2013
From: ancuervo at gmail.com (Angela)
Date: Mon, 11 Mar 2013 11:23:56 -0700 (PDT)
Subject: [R-sig-Geo] Problem with BioGeomancer server
Message-ID: <1363026236573-7583032.post@n2.nabble.com>

Hi

Do you know what is going on with Biogeomancer server? It has been imposible
to access to their web page: http://bg.berkeley.edu/latest

Thanks

Angela



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-BioGeomancer-server-tp7583032.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From etiennebr at gmail.com  Mon Mar 11 21:35:14 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 11 Mar 2013 16:35:14 -0400
Subject: [R-sig-Geo] extract by polygon ID
In-Reply-To: <1363014398250-7583031.post@n2.nabble.com>
References: <1363014398250-7583031.post@n2.nabble.com>
Message-ID: <CALjAYt6VDQKKC5g3Driq+B4=WH6anQfjKdnkSDsai23=ABqXHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130311/19ba7c9f/attachment.pl>

From joshmobrien at gmail.com  Tue Mar 12 00:16:14 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Mon, 11 Mar 2013 16:16:14 -0700
Subject: [R-sig-Geo] Checking for equivalence of PROJ4 strings.
Message-ID: <CAOwKfPTTHRvH_VCTxv0YH3W7qorgvWrAO55toa4J9_hNzqiTbQ@mail.gmail.com>

Hello,

Is there a better / more official / less error-prone way than the
following to check the equivalence of two PROJ4 strings?

checkProjEquivalence <- function(SP, crs1, crs2) {
    cc1 <- coordinates(spTransform(SP, crs1))
    cc2 <- coordinates(spTransform(SP, crs2))
    identical(cc1, cc2)
}

## Example inputs
crs1 <- CRS("+proj=utm +zone=11 +datum=NAD83 +units=m +no_defs
+ellps=GRS80 +towgs84=0,0,0")
crs2 <- CRS("+proj=utm +zone=11 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
+units=m +no_defs")
SP <- SpatialPoints(cbind(457900, 4918700), proj4string = crs1)

## Trying it out
checkProjEquivalence(SP, crs1, crs2)
## [1] TRUE


From jrcoyle at live.unc.edu  Tue Mar 12 13:32:40 2013
From: jrcoyle at live.unc.edu (Coyle, Jes)
Date: Tue, 12 Mar 2013 12:32:40 +0000
Subject: [R-sig-Geo] Species localities to richness maps - combining
 rasterize() and focal()
Message-ID: <6AAB634439FAC241941BA3CAA04F59E48C2C08FD@BY2PRD0310MB389.namprd03.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130312/4ec9b1a7/attachment.pl>

From dbprovete at gmail.com  Tue Mar 12 15:55:20 2013
From: dbprovete at gmail.com (Diogo B. Provete)
Date: Tue, 12 Mar 2013 09:55:20 -0500
Subject: [R-sig-Geo] Spatial correlogram with missing data
Message-ID: <CALJB7JRc9GoZobx3gEMcAWFeS-MsxBTf-+AkDDx+HTM8MnOD2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130312/50980a96/attachment.pl>

From giuseppe.amatulli at gmail.com  Tue Mar 12 22:26:03 2013
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Tue, 12 Mar 2013 16:26:03 -0500
Subject: [R-sig-Geo] Memory...
In-Reply-To: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>
References: <CANJhsN2+tcJeUPopEavrD9XD57e=tMwyVCwZKvOx9HopUgGgpg@mail.gmail.com>
Message-ID: <CAKoiDHK_SP=G-9ThKU0xYKmFLJzt1poZhw9sFXog1orHzX_dqw@mail.gmail.com>

Ciao Maurizio
- Try to build up your table outside R and enter in R just with the
columns/rows that you need.

- If you are fitting the model use y=resp  , x=prdictors rather others
formulas  (e.g.:  y ~  )
- Every time that you delate a file rm() use gc() to reallocate memory

- Bash and awk can handling large data set, and can be useful for
preselecting columns and row and also for making some basic
statistical analyse ( see
http://www.spatial-ecology.net/dokuwiki/doku.php?id=wiki:geo_tools :
Dealing with simple statistic in large txt file )

- You can also sampling your data adding a random column with awk and
make an if condition
awk '{ if ( rand() > 0.5)    print $1   }' input.txt   > output.txt
check for more examples and issues how use rand() & srand()

- Sorting/ranking action are very demanding in R so try to do in bash.

- Should be possible to use the swap from R but it will became extremely slow.

Ciao

--
Giuseppe Amatulli
Web: www.spatial-ecology.net


On 7 March 2013 05:29, Maurizio Marchi <mauriziomarchi85 at gmail.com> wrote:
> Hi everybody,
> I have to calculate some new columns in a data frame with 1971000 lines adding
> 57 new columns but R crashes every time...
> I think it's a problem of memory allocation, so I would like to know how I
> can change the memory settings...
> I'm on Ubuntu 12.04 64-bit
>
> Thanks,
> --
> Maurizio Marchi
>  ID skype: maurizioxyz
> *Ubuntu 12.04 (Precise Pangolin)*
> *"Il bello dell'open-source ? che le domande possono essere poste alla
> fonte"*
> *utente linux 552.742*
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



--
Giuseppe Amatulli
Web: www.spatial-ecology.net


From HodgessE at uhd.edu  Wed Mar 13 00:35:37 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 12 Mar 2013 23:35:37 +0000
Subject: [R-sig-Geo] questions about STIDF objects
Message-ID: <FF9DB805FC41CC4E95825A50F6806302129345B5@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130312/35451b16/attachment.pl>

From lily_franknich at yahoo.com  Wed Mar 13 03:12:45 2013
From: lily_franknich at yahoo.com (Lilis Husna)
Date: Wed, 13 Mar 2013 10:12:45 +0800 (SGT)
Subject: [R-sig-Geo] spatial autocorrelation for categorical data.
In-Reply-To: <mailman.11.1362999604.23330.r-sig-geo@r-project.org>
References: <mailman.11.1362999604.23330.r-sig-geo@r-project.org>
Message-ID: <1363140765.96921.YahooMailNeo@web192902.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130313/014b233d/attachment.pl>

From damianmaddalena at gmail.com  Wed Mar 13 03:43:28 2013
From: damianmaddalena at gmail.com (Damian Maddalena)
Date: Tue, 12 Mar 2013 22:43:28 -0400
Subject: [R-sig-Geo] xvalid or similar with krige.bayes()
Message-ID: <513FE7D0.7010606@gmail.com>

Greetings:

I need to perform LOOCV for krige.bayes().  I want to compare the output 
of krige.bayes to the output of other interpolation methods. I can do 
LOOCV easily for other interpolation methods using xvalid() in geoR or 
krige.cv() in gstat but I cannot find any code examples that demonstrate 
how this can be done for a krige.bayes() object.

Any help would be greatly appreciated.

Thank you.

-Damian


From Roger.Bivand at nhh.no  Wed Mar 13 08:22:50 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 13 Mar 2013 08:22:50 +0100
Subject: [R-sig-Geo] spatial autocorrelation for categorical data.
In-Reply-To: <1363140765.96921.YahooMailNeo@web192902.mail.sg3.yahoo.com>
References: <mailman.11.1362999604.23330.r-sig-geo@r-project.org>
	<1363140765.96921.YahooMailNeo@web192902.mail.sg3.yahoo.com>
Message-ID: <alpine.LRH.2.03.1303130818490.29692@reclus.nhh.no>

On Wed, 13 Mar 2013, Lilis Husna wrote:

> Is there any spatial autocorrelation chek (like Moran's I) for 
> categorical data?

See joincount.test() joincount.multi() in spdep, and do read the help 
pages and the references named on the help pages, especially Cliff & Ord 
(1981) for the background. Googling on Moran join count gives lots of 
hits.

Hope this helps,

Roger

>
>
>
> Best Regards,
> Lilis Nurul Husna
> Institute of Statistics?
>
> Jakarta
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From villers.alexandre at gmail.com  Wed Mar 13 08:30:23 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Wed, 13 Mar 2013 09:30:23 +0200
Subject: [R-sig-Geo] Spatial correlogram with missing data
In-Reply-To: <CALJB7JRc9GoZobx3gEMcAWFeS-MsxBTf-+AkDDx+HTM8MnOD2g@mail.gmail.com>
References: <CALJB7JRc9GoZobx3gEMcAWFeS-MsxBTf-+AkDDx+HTM8MnOD2g@mail.gmail.com>
Message-ID: <51402B0F.4040600@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130313/428b3221/attachment.pl>

From ben.graeler at uni-muenster.de  Wed Mar 13 09:49:52 2013
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Wed, 13 Mar 2013 09:49:52 +0100
Subject: [R-sig-Geo] questions about STIDF objects
In-Reply-To: <FF9DB805FC41CC4E95825A50F6806302129345B5@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F6806302129345B5@challenger.uhd.campus>
Message-ID: <51403DB0.9080209@uni-muenster.de>

Dear Erin,

currently, all spatio-temporal covariance models in gstat support STFDF 
while only the sum-metric model can deal with STSDF as well. However, 
implementing STSDF and STIDF support for the other covariance functions 
is on the wish list.

Best wishes,

  Ben

On 13.03.2013 00:35, Hodgess, Erin wrote:
> Hello!
>
> Is there a way to do kriging on an STIDF object, please?  Probably not, but I thought that I'd check.
>
> Thanks,
> Erin
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de


From jminming at yahoo.com  Wed Mar 13 15:55:56 2013
From: jminming at yahoo.com (Jin Minming)
Date: Wed, 13 Mar 2013 14:55:56 +0000 (GMT)
Subject: [R-sig-Geo] FW: 3/13/2013 3:55:55 PM
Message-ID: <1363186556.67306.YahooMailNeo@web171704.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130313/c404795f/attachment.pl>

From paulojus at c3sl.ufpr.br  Wed Mar 13 18:37:57 2013
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 13 Mar 2013 14:37:57 -0300 (BRT)
Subject: [R-sig-Geo] xvalid or similar with krige.bayes()
In-Reply-To: <513FE7D0.7010606@gmail.com>
References: <513FE7D0.7010606@gmail.com>
Message-ID: <alpine.DEB.2.00.1303131434120.1858@macalan.c3sl.ufpr.br>

Well this is not that straightfoward (or uniquely defined)
since you need to specify what would 
be the "point prediction" in the Bayesian kriging.
The posterior mean is a candidate, but not uniquely defined.
Besides the analysis will be quite timing consuming
when running krige.bayes() for each of the location left aside

I personally would go for other measures of fit
but if you realy find CV within the Bayesian approach you can write
a simple loop call to the leaving-one-out



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Tue, 12 Mar 2013, Damian Maddalena wrote:

> Greetings:
>
> I need to perform LOOCV for krige.bayes().  I want to compare the output of 
> krige.bayes to the output of other interpolation methods. I can do LOOCV 
> easily for other interpolation methods using xvalid() in geoR or krige.cv() 
> in gstat but I cannot find any code examples that demonstrate how this can be 
> done for a krige.bayes() object.
>
> Any help would be greatly appreciated.
>
> Thank you.
>
> -Damian
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From damianmaddalena at gmail.com  Wed Mar 13 18:59:49 2013
From: damianmaddalena at gmail.com (Damian Maddalena)
Date: Wed, 13 Mar 2013 13:59:49 -0400
Subject: [R-sig-Geo] xvalid or similar with krige.bayes()
In-Reply-To: <alpine.DEB.2.00.1303131434120.1858@macalan.c3sl.ufpr.br>
References: <513FE7D0.7010606@gmail.com>
	<alpine.DEB.2.00.1303131434120.1858@macalan.c3sl.ufpr.br>
Message-ID: <5140BE95.4000200@gmail.com>

Thank you for your reply, Paulo.

As long I can find a statistically valid method to compare the Bayesian 
kriging surfaces to the others I will be happy. I don't necessarily need 
CV. It was just what I knew for the other interpolation methods.

Please forgive my simple question, but can you please suggest a few 
terms that I might use to search for "others measures of fit?" Something 
that I could search to find some good code examples.  I am fairly new to 
coding in R and having something to examine and modify would be a big help.

Thank you.

-Damian




On 03/13/2013 01:37 PM, Paulo Justiniano Ribeiro Jr wrote:
> Well this is not that straightfoward (or uniquely defined)
> since you need to specify what would be the "point prediction" in the 
> Bayesian kriging.
> The posterior mean is a candidate, but not uniquely defined.
> Besides the analysis will be quite timing consuming
> when running krige.bayes() for each of the location left aside
>
> I personally would go for other measures of fit
> but if you realy find CV within the Bayesian approach you can write
> a simple loop call to the leaving-one-out
>
>
>
> Paulo Justiniano Ribeiro Jr
> LEG (Laboratorio de Estatistica e Geoinformacao)
> Universidade Federal do Parana
> Caixa Postal 19.081
> CEP 81.531-990
> Curitiba, PR  -  Brasil
> Tel: (+55) 41 3361 3573
> VOIP: (+55) (41) (3361 3600) 1053 1066
> Fax: (+55) 41 3361 3141
> e-mail: paulojus AT  ufpr  br
> http://www.leg.ufpr.br/~paulojus
>
> On Tue, 12 Mar 2013, Damian Maddalena wrote:
>
>> Greetings:
>>
>> I need to perform LOOCV for krige.bayes().  I want to compare the 
>> output of krige.bayes to the output of other interpolation methods. I 
>> can do LOOCV easily for other interpolation methods using xvalid() in 
>> geoR or krige.cv() in gstat but I cannot find any code examples that 
>> demonstrate how this can be done for a krige.bayes() object.
>>
>> Any help would be greatly appreciated.
>>
>> Thank you.
>>
>> -Damian
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


From julleeyaw at yahoo.ca  Wed Mar 13 21:58:54 2013
From: julleeyaw at yahoo.ca (Julie Lee-Yaw)
Date: Wed, 13 Mar 2013 13:58:54 -0700 (PDT)
Subject: [R-sig-Geo] dismo package: using biasfile when calling maxent
Message-ID: <1363208334.90976.YahooMailClassic@web142503.mail.bf1.yahoo.com>

Hi All,

Does anyone know how to incorporate a biasfile into a maxent run set up from the R package dismo?

Or is it even possible to run dismo's maxent command with a bias file?

Here's what I've tried:

mybias<-raster(file.choose())  # load bias grid of same extent and resolution as raster layers

## Attempt 1
test1<-maxent(rasters,localities,removeDuplicates=TRUE, args="biasfile=mybias")

# Result
Error in file(con, "r") : cannot open the connection
In addition: Warning message:
In file(con, "r") :
  cannot open file '/var/folders/rm/kftt7_jj5h70d5kgypw6njwr0000gn/T/R_raster_tmp/maxent/7322841707/species.lambdas': No such file or directory

## Attempt 2
test2<-maxent(rasters,localities,removeDuplicates=TRUE, args="biasfile=/Users/Documents/mybias.asc") # use path name instead

# Result
Error in file(con, "r") : cannot open the connection
In addition: Warning message:
In file(con, "r") :
  cannot open file '/var/folders/rm/kftt7_jj5h70d5kgypw6njwr0000gn/T/R_raster_tmp/maxent/02810774444/species.lambdas': No such file or directory


## Attempt 3

test4<-maxent(rasters,localities,removeDuplicates=TRUE, biasfile=mybias)

# This runs but the bias file seems to be ignored. That is, the bias file isn't listed as a parameter in the html file of the results (when running maxent directly the output html file mentions the bias file under the "Raw data output and control parameters" section)

Thanks!

Julie


From r.hijmans at gmail.com  Thu Mar 14 01:42:37 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 13 Mar 2013 17:42:37 -0700
Subject: [R-sig-Geo] dismo package: using biasfile when calling maxent
In-Reply-To: <1363208334.90976.YahooMailClassic@web142503.mail.bf1.yahoo.com>
References: <1363208334.90976.YahooMailClassic@web142503.mail.bf1.yahoo.com>
Message-ID: <CANtt_hxh-p8Hxv67n2dMMzqpbUxJfp4FyUkzoUpVrx2epNtqow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130313/95558176/attachment.pl>

From hnstedu at 163.com  Thu Mar 14 04:28:05 2013
From: hnstedu at 163.com (hnstedu)
Date: Thu, 14 Mar 2013 11:28:05 +0800 (CST)
Subject: [R-sig-Geo] Questions on the spatial weight matrix in spdep
Message-ID: <1351114.16907.13d66f0babb.Coremail.hnstedu@163.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130314/7c1dfb3c/attachment.pl>

From juantomas.sayago at gmail.com  Thu Mar 14 04:37:02 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Wed, 13 Mar 2013 23:37:02 -0400
Subject: [R-sig-Geo] Questions on the spatial weight matrix in spdep
In-Reply-To: <1351114.16907.13d66f0babb.Coremail.hnstedu@163.com>
References: <1351114.16907.13d66f0babb.Coremail.hnstedu@163.com>
Message-ID: <CAEOXpNBgeo_B5DKLXEBGpO+m17H+=hpZvHZ5ERrKFExMJOoWQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130313/a6495414/attachment.pl>

From buitenwerf at em.uni-frankfurt.de  Thu Mar 14 09:44:10 2013
From: buitenwerf at em.uni-frankfurt.de (Robert Buitenwerf)
Date: Thu, 14 Mar 2013 10:44:10 +0200
Subject: [R-sig-Geo] How to use select function in raster with use="pol"?
Message-ID: <51418DDA.7080607@em.uni-frankfurt.de>

Dear all,

The select function in raster seems really neat and works well for rectangles i.e. use="rec".

I can't get good results for selecting polygons though i.e. use="pol".

I do:

r <- raster(nrow=10, ncol=10)
r[] <- 1:ncell(r)
plot(r)
s <- select(r, use="pol")

After clicking on the image multiple times in the shape that I want I press escape (running R on 64bit Windows 7). A polygon of the wanted shape is drawn onto the raster, but the new object s is not created. I get this error:

Error in as.vector(y) : no method for coercing this S4 class to a vector


Perhaps I shouldn't use escape to tell select I'm done, but I can't figure out what else to do...

It would also be nice if the polygon lines were drawn while clicking the image (not only afterwards) so that you can see what you're doing?


Thanks,
Robert


From jon.skoien at jrc.ec.europa.eu  Thu Mar 14 10:28:20 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Thu, 14 Mar 2013 10:28:20 +0100
Subject: [R-sig-Geo] Alternative to bivariate interpolation from
	akima-package
Message-ID: <51419834.1040502@jrc.ec.europa.eu>

Dear list,

A function in the intamap package currently uses the bivariate 
interpolation method for irregularly spaced data from the akima package. 
This dependency is a problem because of license mismatch (intamap is GPL 
 >=2, akima has an exclusively non-commercial license). Does anyone know 
about a good alternative to this method?
The method must be able to interpolate from an irregularly spaced 
observation network to a grid, and the interpolated surface must be 
smooth, i.e., differentiable. The method should ideally be fast also for 
larger data sets. The thin plate splines regression in the fields 
package (Tps) seems to produce a smooth surface, but struggles with 
memory consumption when the observation network is large (>2000 points).
mba.surf in the MBA package is very fast, but it could run into problems 
with heterogeneous sampling patterns.

Any other suggestions? Is there a natural neighbor interpolation method 
implemented in R?

Best wishes,
Jon



-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From Roger.Bivand at nhh.no  Thu Mar 14 10:37:18 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Mar 2013 10:37:18 +0100
Subject: [R-sig-Geo] Alternative to bivariate interpolation from
 akima-package
In-Reply-To: <51419834.1040502@jrc.ec.europa.eu>
References: <51419834.1040502@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.03.1303141034090.776@reclus.nhh.no>

I've suggested this as a project for GSoC 2013:

https://groups.google.com/forum/?fromgroups#!topic/gsoc-r/8ZUQCVlyodk

If you know of capable students, please recommend this to them. It's best 
to coordinate efforts, I think.

Roger

On Thu, 14 Mar 2013, Jon Olav Skoien wrote:

> Dear list,
>
> A function in the intamap package currently uses the bivariate interpolation 
> method for irregularly spaced data from the akima package. This dependency is 
> a problem because of license mismatch (intamap is GPL >=2, akima has an 
> exclusively non-commercial license). Does anyone know about a good 
> alternative to this method?
> The method must be able to interpolate from an irregularly spaced observation 
> network to a grid, and the interpolated surface must be smooth, i.e., 
> differentiable. The method should ideally be fast also for larger data sets. 
> The thin plate splines regression in the fields package (Tps) seems to 
> produce a smooth surface, but struggles with memory consumption when the 
> observation network is large (>2000 points).
> mba.surf in the MBA package is very fast, but it could run into problems with 
> heterogeneous sampling patterns.
>
> Any other suggestions? Is there a natural neighbor interpolation method 
> implemented in R?
>
> Best wishes,
> Jon
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Thu Mar 14 12:11:29 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 14 Mar 2013 22:11:29 +1100
Subject: [R-sig-Geo] Problem with raster package and netcdf file
In-Reply-To: <CAAcGz98=zBgEvoQy7FvWNp3KzQnTJoZFcEvwvaV6nWdMD-tv7g@mail.gmail.com>
References: <57081.82.134.28.207.1362737889.squirrel@www.hafro.is>
	<CAAcGz98=zBgEvoQy7FvWNp3KzQnTJoZFcEvwvaV6nWdMD-tv7g@mail.gmail.com>
Message-ID: <CAAcGz9_zq7PtVWowZbWV7RdtDPpAy09d9cZYAmjX6E6rHfwNYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130314/f68f9973/attachment.pl>

From gustavodalposso at hotmail.com  Thu Mar 14 13:49:40 2013
From: gustavodalposso at hotmail.com (Gustavo Dalposso)
Date: Thu, 14 Mar 2013 12:49:40 +0000
Subject: [R-sig-Geo] about spatial proximity matrix
Message-ID: <BAY172-W33053A0F17688DE140640BBBEC0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130314/1326fb6a/attachment.pl>

From r.hijmans at gmail.com  Thu Mar 14 17:39:46 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Mar 2013 09:39:46 -0700
Subject: [R-sig-Geo] How to use select function in raster with use="pol"?
In-Reply-To: <51418DDA.7080607@em.uni-frankfurt.de>
References: <51418DDA.7080607@em.uni-frankfurt.de>
Message-ID: <CANtt_hy53mfKMJfg8QVskEnhroUXsMfxHSVOhQwM6f4jKK6ryA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130314/0a685996/attachment.pl>

From rossahmed at googlemail.com  Thu Mar 14 21:59:42 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Thu, 14 Mar 2013 20:59:42 +0000
Subject: [R-sig-Geo] transfer raster values to dataframe
Message-ID: <CD67EABE.4197%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130314/2eb5df6b/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Thu Mar 14 22:37:19 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Thu, 14 Mar 2013 22:37:19 +0100
Subject: [R-sig-Geo] Antw:  transfer raster values to dataframe
Message-ID: <5142511F0200002700018E2C@gwia2.boku.ac.at>

Dear Ross,


set.seed(1234)
myPointsSp <- data.frame(x=rnorm(10, mean=1.23347499, sd=0.002),
y=rnorm(10, mean=52.00096, sd=0.002))
coordinates(myPointsSp) <- c('x', 'y')
proj4string(myPointsSp) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")

# make raster
myExtent <- extent(myPointsSp)
myRaster <- raster(ext=myExtent, crs="+proj=longlat +ellps=WGS84 +datum=WGS84", ncol=2, nrow=2)

# assign values to raster
myRaster[] <- rnorm(4)



myPointsDf <- as.data.frame(myPointsSp)

# I think a simple extract is what you are looking for:
myPointsDf <- extract(myRaster,myPointsSp)


# Matteo

>>> Ross Ahmed  14.03.13 22.00 Uhr >>>
I need to transfer the values from a raster to a dataframe programatically.
Hopefully code below should explain what I need but let me know if not.

# make spatial points
set.seed(1234)
myPointsSp <- data.frame(x=rnorm(10, mean=1.23347499, sd=0.002),
y=rnorm(10, mean=52.00096, sd=0.002))
coordinates(myPointsSp) <- c('x', 'y')
proj4string(myPointsSp) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")

# make raster
myExtent <- extent((bbox(myPointsSp)))
myRaster <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84
+datum=WGS84", ncol=2, nrow=2)

# assign values to raster
myRaster[] <- rnorm(4)

# cell number of raster that points fall in
myPointsDf <- as.data.frame(myPointsSp)
myPointsDf$cell.number <- cellFromXY(myRaster, myPointsSp)

# this is what I need - value of cell number transferring to myPointsDf. How
can 
# I do this programatically?
myPointsDf$cell.value <- c(0.3574899,  0.3054585,  0.7327708, 0.7327708,
-1.2390943, 0.3054585,
                           -1.2390943, -1.2390943,  0.3574899, 0.3574899)


Thanks
Ross



    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From matteo.mattiuzzi at boku.ac.at  Thu Mar 14 23:00:33 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Thu, 14 Mar 2013 23:00:33 +0100
Subject: [R-sig-Geo] Antw:  transfer raster values to dataframe
Message-ID: <5142569D0200002700018E36@gwia2.boku.ac.at>

And of coarse the last step was not completely right:
...
myPointsDf <- as.data.frame(myPointsSp)
vals <- extract(myRaster,myPointsSp)
myPointsDf <- cbind(myPointsDf,vals)



so now the values are in your data.frame, or maybe also this is ok:


myDf <- extract(myRaster,myPointsSp,df=TRUE)





>>> Ross Ahmed  14.03.13 22.00 Uhr >>>
I need to transfer the values from a raster to a dataframe programatically.
Hopefully code below should explain what I need but let me know if not.

# make spatial points
set.seed(1234)
myPointsSp <- data.frame(x=rnorm(10, mean=1.23347499, sd=0.002),
y=rnorm(10, mean=52.00096, sd=0.002))
coordinates(myPointsSp) <- c('x', 'y')
proj4string(myPointsSp) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")

# make raster
myExtent <- extent((bbox(myPointsSp)))
myRaster <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84
+datum=WGS84", ncol=2, nrow=2)

# assign values to raster
myRaster[] <- rnorm(4)

# cell number of raster that points fall in
myPointsDf <- as.data.frame(myPointsSp)
myPointsDf$cell.number <- cellFromXY(myRaster, myPointsSp)

# this is what I need - value of cell number transferring to myPointsDf. How
can 
# I do this programatically?
myPointsDf$cell.value <- c(0.3574899,  0.3054585,  0.7327708, 0.7327708,
-1.2390943, 0.3054585,
                           -1.2390943, -1.2390943,  0.3574899, 0.3574899)


Thanks
Ross



    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From babuawara at gmail.com  Fri Mar 15 07:33:48 2013
From: babuawara at gmail.com (vikram ranga)
Date: Fri, 15 Mar 2013 12:03:48 +0530
Subject: [R-sig-Geo] Error in model frame while using ppm function
Message-ID: <CAL-ALVEqr9gLT4xAoA0H7u=xzWG7_irg4R-EHxCQQLPn=3SiFA@mail.gmail.com>

Dear list,

I am having this error while running ppm function from spatstat package:

Error in model.frame.default(formula = fmla, data = glmdata, subset =
.mpl.SUBSET,  :
  variable lengths differ (found for 'variables$var1')

What i was trying to do:- is shown using toy example:
#require(spatstat) #require(sp)
a<-owin(poly = list(list(x = c(1, 8, 1), y = c(1, 1, 8)),list(x = c(3,
3, 4, 4), y = c(3, 4, 4, 3)),list(x=c(0,0.8,0),y=c(0,0,3)))) # makes
polygons
p<-rpoispp(a) # planar points
a.im<-as.im(a)
p<-rpoispp(a.im)
var1<-runif(p$n)
var2<-runif(p$n)
var3<-runif(p$n)
variables<-cbind(var1,var2,var3)
ppm.test<-ppm(p,~variables$var1+variables$var2+variables$var3,data=variables,method="ho")

Error in model.frame.default(formula = fmla, data = glmdata, subset =
.mpl.SUBSET,  :
  variable lengths differ (found for 'variables$var1')

However, the length of variables do not differ with ppp "p" but error
shows variable lengths differ.
I could not figure out why r throwing this error


The session info is:
R version 2.15.2 (2012-10-26)
Platform: i386-w64-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_India.1252  LC_CTYPE=English_India.1252
[3] LC_MONETARY=English_India.1252 LC_NUMERIC=C
[5] LC_TIME=English_India.1252

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
 [1] data.table_1.8.8 raster_2.0-41    rgdal_0.8-4      maptools_0.8-22
 [5] lattice_0.20-10  foreign_0.8-51   rgeos_0.2-12     sp_1.0-5
 [9] spatstat_1.31-0  deldir_0.0-21    mgcv_1.7-22

loaded via a namespace (and not attached):
[1] Matrix_1.0-9 nlme_3.1-105 tools_2.15.2



Any help is greatly appreciated.

Vikram.


From rossahmed at googlemail.com  Fri Mar 15 09:36:39 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 15 Mar 2013 08:36:39 +0000
Subject: [R-sig-Geo] Antw:  transfer raster values to dataframe
In-Reply-To: <5142569D0200002700018E36@gwia2.boku.ac.at>
Message-ID: <CD688E09.41A8%rossahmed@gmail.com>

Great, many thanks Matteo.


On 14/03/2013 22:00, "Matteo Mattiuzzi" <matteo.mattiuzzi at boku.ac.at>
wrote:

>And of coarse the last step was not completely right:
>...
>myPointsDf <- as.data.frame(myPointsSp)
>vals <- extract(myRaster,myPointsSp)
>myPointsDf <- cbind(myPointsDf,vals)
>
>
>
>so now the values are in your data.frame, or maybe also this is ok:
>
>
>myDf <- extract(myRaster,myPointsSp,df=TRUE)
>
>
>
>
>
>>>> Ross Ahmed  14.03.13 22.00 Uhr >>>
>I need to transfer the values from a raster to a dataframe
>programatically.
>Hopefully code below should explain what I need but let me know if not.
>
># make spatial points
>set.seed(1234)
>myPointsSp <- data.frame(x=rnorm(10, mean=1.23347499, sd=0.002),
>y=rnorm(10, mean=52.00096, sd=0.002))
>coordinates(myPointsSp) <- c('x', 'y')
>proj4string(myPointsSp) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>
># make raster
>myExtent <- extent((bbox(myPointsSp)))
>myRaster <- raster(ext=myExtent,crs="+proj=longlat +ellps=WGS84
>+datum=WGS84", ncol=2, nrow=2)
>
># assign values to raster
>myRaster[] <- rnorm(4)
>
># cell number of raster that points fall in
>myPointsDf <- as.data.frame(myPointsSp)
>myPointsDf$cell.number <- cellFromXY(myRaster, myPointsSp)
>
># this is what I need - value of cell number transferring to myPointsDf.
>How
>can 
># I do this programatically?
>myPointsDf$cell.value <- c(0.3574899,  0.3054585,  0.7327708, 0.7327708,
>-1.2390943, 0.3054585,
>                           -1.2390943, -1.2390943,  0.3574899, 0.3574899)
>
>
>Thanks
>Ross
>
>
>
>    [[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From alessandrosamuel at yahoo.com.br  Fri Mar 15 14:59:23 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Fri, 15 Mar 2013 06:59:23 -0700 (PDT)
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
Message-ID: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130315/e004c345/attachment.pl>

From r.turner at auckland.ac.nz  Fri Mar 15 21:45:49 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 16 Mar 2013 09:45:49 +1300
Subject: [R-sig-Geo] Error in model frame while using ppm function
In-Reply-To: <CAL-ALVEqr9gLT4xAoA0H7u=xzWG7_irg4R-EHxCQQLPn=3SiFA@mail.gmail.com>
References: <CAL-ALVEqr9gLT4xAoA0H7u=xzWG7_irg4R-EHxCQQLPn=3SiFA@mail.gmail.com>
Message-ID: <5143887D.1040605@auckland.ac.nz>


There appears to be a lot of confusion (and unnecessary complication)
in what you've done, but the basic problem is with the way that you
are handling your covariates.  See inline below:

On 03/15/2013 07:33 PM, vikram ranga wrote:
> Dear list,
>
> I am having this error while running ppm function from spatstat package:
>
> Error in model.frame.default(formula = fmla, data = glmdata, subset =
> .mpl.SUBSET,  :
>    variable lengths differ (found for 'variables$var1')
>
> What i was trying to do:- is shown using toy example:
> #require(spatstat) #require(sp)
> a<-owin(poly = list(list(x = c(1, 8, 1), y = c(1, 1, 8)),list(x = c(3,
> 3, 4, 4), y = c(3, 4, 4, 3)),list(x=c(0,0.8,0),y=c(0,0,3)))) # makes
> polygons
> p<-rpoispp(a) # planar points
     This cannot possibly be what you actually did; this would have
     thrown an error.
> a.im<-as.im(a)
> p<-rpoispp(a.im)
     Why are you fooling about with images here?  Just do something like

     p <- rpoispp(100)

     to produce a pattern for illustrative purposes.
> var1<-runif(p$n)
> var2<-runif(p$n)
> var3<-runif(p$n)
> variables<-cbind(var1,var2,var3)
     This is where you really go wrong.  The variables object will be a 
matrix.
     You need it to be either a *data frame* --- having the same number of
     rows as the number of points in the quadrature scheme for the model
     --- or (better) a list of *images* each of which provides a 
covariate defined
     (effectively) at every point of the observation window.
> ppm.test<-ppm(p,~variables$var1+variables$var2+variables$var3,data=variables,method="ho")

     This is completely syntactically wrong in respect of the handling 
of "variables".
     Moreover the use of method "ho" here is silly.  You are fitting a 
Poisson model
     and thus the pseudolikelihood is the "real live likelihood". Hence 
using the Huang-Ogata
     method is redundant.

     Try:

     a<-owin(poly = list(list(x = c(1, 8, 1), y = c(1, 1, 8)),
                                   list(x = c(3,3, 4, 4), y = c(3, 4, 4, 
3)),
                                   list(x=c(0,0.8,0),y=c(0,0,3))))
     p <- rpoispp(100,win=a)
     Q <- quadscheme(p)
     U <- union.quad(Q)
     variables <- data.frame(
                         var1 = runif(npoints(U)),
                         var2 = runif(npoints(U)),
                         var3 = runif(npoints(U)))
     fit <- ppm(Q,~var1+var2+var3,covariates=variables)

     Or better:

     var1 <- 
im(runif(128^2),xcol=seq(0,8,length=128),yrow=seq(0,8,length=128))
     var2 <- 
im(runif(128^2),xcol=seq(0,8,length=128),yrow=seq(0,8,length=128))
     var3 <- 
im(runif(128^2),xcol=seq(0,8,length=128),yrow=seq(0,8,length=128))
     fit2   <- 
ppm(p,~var1+var2+var3,covariates=list(var1=var1,var2=var2,var3=var3))

>
> Error in model.frame.default(formula = fmla, data = glmdata, subset =
> .mpl.SUBSET,  :
>    variable lengths differ (found for 'variables$var1')
>
> However, the length of variables do not differ with ppp "p" but error
> shows variable lengths differ.
> I could not figure out why r throwing this error

     The error is thrown because your syntax is completely wrong.
     Going into the details of what is happening would be 
counter-productive.

     cheers,

         Rolf Turner


From alobolistas at gmail.com  Sat Mar 16 11:15:47 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 16 Mar 2013 11:15:47 +0100
Subject: [R-sig-Geo] create a 3d shapefile ?
Message-ID: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>

Is it possible to write point ESRI shapefiles with x,y,z
coordinates using writeOGR()?
According to what I've been able to find, it seems
that spatial points can have 3 coordinates while
spatial lines cannot. Nevertheless, coordinates() accepts
2 arguments (x,y) only. So actually, do not know how to define
x,y,z coordinates for spatial points (data frame) objects.
Is it possible?

Thanks,

Agus


From r.hijmans at gmail.com  Sat Mar 16 13:52:06 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 16 Mar 2013 05:52:06 -0700
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
Message-ID: <CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130316/52ffcbeb/attachment.pl>

From mdsumner at gmail.com  Sat Mar 16 14:00:12 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 17 Mar 2013 00:00:12 +1100
Subject: [R-sig-Geo] create a 3d shapefile ?
In-Reply-To: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
References: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
Message-ID: <CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130317/af626226/attachment.pl>

From omphalodes.verna at yahoo.com  Sat Mar 16 15:38:29 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Sat, 16 Mar 2013 07:38:29 -0700 (PDT)
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
Message-ID: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>

Dear list.

I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea.
Thanks to all,
OV

RCode:
library(rgeos)
library(sp)
n <- 5
xy <- cbind(runif(n), runif(n), runif(n), runif(n))
LLine <- vector("list", n)
LLines <- vector("list", n)
for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
SPLines <- SpatialLines(LLines)
SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
plot(SPLines, col = getSLLinesIDSlots(SPLines))
plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
SPLpolyA <- SPLpoly
SPLpolyB <- SPLpoly
gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
plot(gU, col = rainbow(length(gU)))



From Roger.Bivand at nhh.no  Sat Mar 16 16:34:02 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 16 Mar 2013 16:34:02 +0100
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Dear list.
>
> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' 
> function (in attached code only 5). Final result should be polygons with 
> unique ID (using attached code it is), but when I plot them (colors by 
> ID value), there are only 5 polygons.?Please, give me some idea. Thanks 
> to all, OV

Are you mistaking gUnion() for gUnaryUnion()?

gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))

Roger

>
> RCode:
> library(rgeos)
> library(sp)
> n <- 5
> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
> LLine <- vector("list", n)
> LLines <- vector("list", n)
> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
> SPLines <- SpatialLines(LLines)
> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
> plot(SPLines, col = getSLLinesIDSlots(SPLines))
> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
> SPLpolyA <- SPLpoly
> SPLpolyB <- SPLpoly
> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
> plot(gU, col = rainbow(length(gU)))
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From omphalodes.verna at yahoo.com  Sat Mar 16 18:26:50 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Sat, 16 Mar 2013 10:26:50 -0700 (PDT)
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
Message-ID: <1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>

Thanks Roger!

No, there is no mistaking. This is kind of dissolve function. But I need overlapping / intersection of polygons, where common polygons have unique ID

Thanks




----- Original Message -----
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Omphalodes Verna <omphalodes.verna at yahoo.com>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Sent: Saturday, March 16, 2013 4:34 PM
Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Dear list.
> 
> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea. Thanks to all, OV

Are you mistaking gUnion() for gUnaryUnion()?

gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))

Roger

> 
> RCode:
> library(rgeos)
> library(sp)
> n <- 5
> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
> LLine <- vector("list", n)
> LLines <- vector("list", n)
> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
> SPLines <- SpatialLines(LLines)
> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
> plot(SPLines, col = getSLLinesIDSlots(SPLines))
> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
> SPLpolyA <- SPLpoly
> SPLpolyB <- SPLpoly
> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
> plot(gU, col = rainbow(length(gU)))
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sat Mar 16 19:38:43 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 16 Mar 2013 19:38:43 +0100
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
	<1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1303161932060.11542@reclus.nhh.no>

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Thanks Roger!
>
> No, there is no mistaking. This is kind of dissolve function. But I need 
> overlapping / intersection of polygons, where common polygons have 
> unique ID

Well, certainly your example is unclear. You are taking the unions 
byid=TRUE of 5 Polygons objects with the same objects, so if you start 
with

set.seed(1)

you get:

> gArea(SPLpoly, byid=TRUE)
          1          2          3          4          5
0.04823433 0.03769229 0.04274933 0.06575346 0.09910228

and

> gArea(gU, byid=TRUE)
        1 1        1 2        1 3        1 4        1 5        2 1
0.04823433 0.06825532 0.09098365 0.11398779 0.14733661 0.06825532
        2 2        2 3        2 4        2 5        3 1        3 2
0.03769229 0.08044161 0.10344575 0.13679457 0.09098365 0.08044161
        3 3        3 4        3 5        4 1        4 2        4 3
0.04274933 0.10850279 0.14076253 0.11398779 0.10344575 0.10850279
        4 4        4 5        5 1        5 2        5 3        5 4
0.06575346 0.14303501 0.14733661 0.13679457 0.14076253 0.14303501
        5 5
0.09910228

where 1 1, 2 2, etc. agree with the single Polygons values. If byid=TRUE, 
you get the union of the two Polygons objects, see:

plot(gU[2])

and

gEquals(gU[2], gU[6])

It isn't clear what you want.

Roger

>
> Thanks
>
>
>
>
> ----- Original Message -----
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Sent: Saturday, March 16, 2013 4:34 PM
> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
>
> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
>
>> Dear list.
>> 
>> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea. Thanks to all, OV
>
> Are you mistaking gUnion() for gUnaryUnion()?
>
> gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))
>
> Roger
>
>> 
>> RCode:
>> library(rgeos)
>> library(sp)
>> n <- 5
>> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
>> LLine <- vector("list", n)
>> LLines <- vector("list", n)
>> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
>> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
>> SPLines <- SpatialLines(LLines)
>> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
>> plot(SPLines, col = getSLLinesIDSlots(SPLines))
>> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
>> SPLpolyA <- SPLpoly
>> SPLpolyB <- SPLpoly
>> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
>> plot(gU, col = rainbow(length(gU)))
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From omphalodes.verna at yahoo.com  Sat Mar 16 20:00:13 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Sat, 16 Mar 2013 12:00:13 -0700 (PDT)
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <alpine.LRH.2.03.1303161932060.11542@reclus.nhh.no>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
	<1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161932060.11542@reclus.nhh.no>
Message-ID: <1363460413.91376.YahooMailNeo@web164905.mail.bf1.yahoo.com>

Sorry for my confusion: I would like to get this:?http://farm5.static.flickr.com/4102/4862739641_eacbbd8313.jpg

Input polygons are A, B and C, and I would like to get polygons:
A
B
C
AB!C
A!BC
!ABC
ABC

I hope, now it is clear.

Thanks, OV


----- Original Message -----
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Omphalodes Verna <omphalodes.verna at yahoo.com>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Sent: Saturday, March 16, 2013 7:38 PM
Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Thanks Roger!
> 
> No, there is no mistaking. This is kind of dissolve function. But I need overlapping / intersection of polygons, where common polygons have unique ID

Well, certainly your example is unclear. You are taking the unions byid=TRUE of 5 Polygons objects with the same objects, so if you start with

set.seed(1)

you get:

> gArea(SPLpoly, byid=TRUE)
? ? ? ?  1? ? ? ? ? 2? ? ? ? ? 3? ? ? ? ? 4? ? ? ? ? 5
0.04823433 0.03769229 0.04274933 0.06575346 0.09910228

and

> gArea(gU, byid=TRUE)
? ? ?  1 1? ? ? ? 1 2? ? ? ? 1 3? ? ? ? 1 4? ? ? ? 1 5? ? ? ? 2 1
0.04823433 0.06825532 0.09098365 0.11398779 0.14733661 0.06825532
? ? ?  2 2? ? ? ? 2 3? ? ? ? 2 4? ? ? ? 2 5? ? ? ? 3 1? ? ? ? 3 2
0.03769229 0.08044161 0.10344575 0.13679457 0.09098365 0.08044161
? ? ?  3 3? ? ? ? 3 4? ? ? ? 3 5? ? ? ? 4 1? ? ? ? 4 2? ? ? ? 4 3
0.04274933 0.10850279 0.14076253 0.11398779 0.10344575 0.10850279
? ? ?  4 4? ? ? ? 4 5? ? ? ? 5 1? ? ? ? 5 2? ? ? ? 5 3? ? ? ? 5 4
0.06575346 0.14303501 0.14733661 0.13679457 0.14076253 0.14303501
? ? ?  5 5
0.09910228

where 1 1, 2 2, etc. agree with the single Polygons values. If byid=TRUE, you get the union of the two Polygons objects, see:

plot(gU[2])

and

gEquals(gU[2], gU[6])

It isn't clear what you want.

Roger

> 
> Thanks
> 
> 
> 
> 
> ----- Original Message -----
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Sent: Saturday, March 16, 2013 4:34 PM
> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
> 
> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
> 
>> Dear list.
>> 
>> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea. Thanks to all, OV
> 
> Are you mistaking gUnion() for gUnaryUnion()?
> 
> gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))
> 
> Roger
> 
>> 
>> RCode:
>> library(rgeos)
>> library(sp)
>> n <- 5
>> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
>> LLine <- vector("list", n)
>> LLines <- vector("list", n)
>> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
>> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
>> SPLines <- SpatialLines(LLines)
>> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
>> plot(SPLines, col = getSLLinesIDSlots(SPLines))
>> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
>> SPLpolyA <- SPLpoly
>> SPLpolyB <- SPLpoly
>> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
>> plot(gU, col = rainbow(length(gU)))
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 

-- Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From samanmonfared1 at gmail.com  Sat Mar 16 20:18:45 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Sat, 16 Mar 2013 22:48:45 +0330
Subject: [R-sig-Geo] spatio-temporal data
Message-ID: <CAOytA4avAyCArmUz3_2n_tatXJAw_s429JRbaa20cPYjfOB0Vw@mail.gmail.com>

Dear All,
I want to construct a ST class data with spacetime package.
Observations are cancer mortality rate in 15 fixed locations for
sparse time in 7 years.
I don't know how input my data as a locations and time. I have seen example
data air and fires in this package but I can't understand how they constructed.
for example can I input my data as a below then construct a st class?how?

locations      x      y    time
   point1    cord1   cord2  time1
   point1    cord1   cord2  time2
      .        .       .      .
      .        .       .      .
Best.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From Roger.Bivand at nhh.no  Sat Mar 16 21:31:31 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 16 Mar 2013 21:31:31 +0100
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <1363460413.91376.YahooMailNeo@web164905.mail.bf1.yahoo.com>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
	<1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161932060.11542@reclus.nhh.no>
	<1363460413.91376.YahooMailNeo@web164905.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1303162127440.11542@reclus.nhh.no>

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Sorry for my confusion: I would like to get 
> this:?http://farm5.static.flickr.com/4102/4862739641_eacbbd8313.jpg

There are four operators: gUnion, gDifference, gSymdifference and 
gIntersection. You seem to need combinations of these, so reading up on 
the underlying concepts, for instance in the JTS documentation:

http://www.vividsolutions.com/jts/bin/JTS%20Technical%20Specs.pdf

Roger

>
> Input polygons are A, B and C, and I would like to get polygons:
> A
> B
> C
> AB!C
> A!BC
> !ABC
> ABC
>
> I hope, now it is clear.
>
> Thanks, OV
>
>
> ----- Original Message -----
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Sent: Saturday, March 16, 2013 7:38 PM
> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
>
> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
>
>> Thanks Roger!
>> 
>> No, there is no mistaking. This is kind of dissolve function. But I need overlapping / intersection of polygons, where common polygons have unique ID
>
> Well, certainly your example is unclear. You are taking the unions byid=TRUE of 5 Polygons objects with the same objects, so if you start with
>
> set.seed(1)
>
> you get:
>
>> gArea(SPLpoly, byid=TRUE)
> ? ? ? ?  1? ? ? ? ? 2? ? ? ? ? 3? ? ? ? ? 4? ? ? ? ? 5
> 0.04823433 0.03769229 0.04274933 0.06575346 0.09910228
>
> and
>
>> gArea(gU, byid=TRUE)
> ? ? ?  1 1? ? ? ? 1 2? ? ? ? 1 3? ? ? ? 1 4? ? ? ? 1 5? ? ? ? 2 1
> 0.04823433 0.06825532 0.09098365 0.11398779 0.14733661 0.06825532
> ? ? ?  2 2? ? ? ? 2 3? ? ? ? 2 4? ? ? ? 2 5? ? ? ? 3 1? ? ? ? 3 2
> 0.03769229 0.08044161 0.10344575 0.13679457 0.09098365 0.08044161
> ? ? ?  3 3? ? ? ? 3 4? ? ? ? 3 5? ? ? ? 4 1? ? ? ? 4 2? ? ? ? 4 3
> 0.04274933 0.10850279 0.14076253 0.11398779 0.10344575 0.10850279
> ? ? ?  4 4? ? ? ? 4 5? ? ? ? 5 1? ? ? ? 5 2? ? ? ? 5 3? ? ? ? 5 4
> 0.06575346 0.14303501 0.14733661 0.13679457 0.14076253 0.14303501
> ? ? ?  5 5
> 0.09910228
>
> where 1 1, 2 2, etc. agree with the single Polygons values. If byid=TRUE, you get the union of the two Polygons objects, see:
>
> plot(gU[2])
>
> and
>
> gEquals(gU[2], gU[6])
>
> It isn't clear what you want.
>
> Roger
>
>> 
>> Thanks
>> 
>> 
>> 
>> 
>> ----- Original Message -----
>> From: Roger Bivand <Roger.Bivand at nhh.no>
>> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
>> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
>> Sent: Saturday, March 16, 2013 4:34 PM
>> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
>> 
>> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
>> 
>>> Dear list.
>>> 
>>> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea. Thanks to all, OV
>> 
>> Are you mistaking gUnion() for gUnaryUnion()?
>> 
>> gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))
>> 
>> Roger
>> 
>>> 
>>> RCode:
>>> library(rgeos)
>>> library(sp)
>>> n <- 5
>>> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
>>> LLine <- vector("list", n)
>>> LLines <- vector("list", n)
>>> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
>>> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
>>> SPLines <- SpatialLines(LLines)
>>> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
>>> plot(SPLines, col = getSLLinesIDSlots(SPLines))
>>> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
>>> SPLpolyA <- SPLpoly
>>> SPLpolyB <- SPLpoly
>>> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
>>> plot(gU, col = rainbow(length(gU)))
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> -- Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>> 
>
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From omphalodes.verna at yahoo.com  Sun Mar 17 09:07:29 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Sun, 17 Mar 2013 01:07:29 -0700 (PDT)
Subject: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
In-Reply-To: <alpine.LRH.2.03.1303162127440.11542@reclus.nhh.no>
References: <1363444709.6074.YahooMailNeo@web164901.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161630500.10942@reclus.nhh.no>
	<1363454810.28885.YahooMailNeo@web164903.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303161932060.11542@reclus.nhh.no>
	<1363460413.91376.YahooMailNeo@web164905.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1303162127440.11542@reclus.nhh.no>
Message-ID: <1363507649.50950.YahooMailNeo@web164905.mail.bf1.yahoo.com>

Roger, thanks for your nicely explanation. This is due to ESRI ''contamination'', where Union is what I want.


OV


----- Original Message -----
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Omphalodes Verna <omphalodes.verna at yahoo.com>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Sent: Saturday, March 16, 2013 9:31 PM
Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)

On Sat, 16 Mar 2013, Omphalodes Verna wrote:

> Sorry for my confusion: I would like to get 
> this:?http://farm5.static.flickr.com/4102/4862739641_eacbbd8313.jpg

There are four operators: gUnion, gDifference, gSymdifference and 
gIntersection. You seem to need combinations of these, so reading up on 
the underlying concepts, for instance in the JTS documentation:

http://www.vividsolutions.com/jts/bin/JTS%20Technical%20Specs.pdf

Roger

>
> Input polygons are A, B and C, and I would like to get polygons:
> A
> B
> C
> AB!C
> A!BC
> !ABC
> ABC
>
> I hope, now it is clear.
>
> Thanks, OV
>
>
> ----- Original Message -----
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Sent: Saturday, March 16, 2013 7:38 PM
> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
>
> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
>
>> Thanks Roger!
>> 
>> No, there is no mistaking. This is kind of dissolve function. But I need overlapping / intersection of polygons, where common polygons have unique ID
>
> Well, certainly your example is unclear. You are taking the unions byid=TRUE of 5 Polygons objects with the same objects, so if you start with
>
> set.seed(1)
>
> you get:
>
>> gArea(SPLpoly, byid=TRUE)
> ? ? ? ?? 1? ? ? ? ? 2? ? ? ? ? 3? ? ? ? ? 4? ? ? ? ? 5
> 0.04823433 0.03769229 0.04274933 0.06575346 0.09910228
>
> and
>
>> gArea(gU, byid=TRUE)
> ? ? ?? 1 1? ? ? ? 1 2? ? ? ? 1 3? ? ? ? 1 4? ? ? ? 1 5? ? ? ? 2 1
> 0.04823433 0.06825532 0.09098365 0.11398779 0.14733661 0.06825532
> ? ? ?? 2 2? ? ? ? 2 3? ? ? ? 2 4? ? ? ? 2 5? ? ? ? 3 1? ? ? ? 3 2
> 0.03769229 0.08044161 0.10344575 0.13679457 0.09098365 0.08044161
> ? ? ?? 3 3? ? ? ? 3 4? ? ? ? 3 5? ? ? ? 4 1? ? ? ? 4 2? ? ? ? 4 3
> 0.04274933 0.10850279 0.14076253 0.11398779 0.10344575 0.10850279
> ? ? ?? 4 4? ? ? ? 4 5? ? ? ? 5 1? ? ? ? 5 2? ? ? ? 5 3? ? ? ? 5 4
> 0.06575346 0.14303501 0.14733661 0.13679457 0.14076253 0.14303501
> ? ? ?? 5 5
> 0.09910228
>
> where 1 1, 2 2, etc. agree with the single Polygons values. If byid=TRUE, you get the union of the two Polygons objects, see:
>
> plot(gU[2])
>
> and
>
> gEquals(gU[2], gU[6])
>
> It isn't clear what you want.
>
> Roger
>
>> 
>> Thanks
>> 
>> 
>> 
>> 
>> ----- Original Message -----
>> From: Roger Bivand <Roger.Bivand at nhh.no>
>> To: Omphalodes Verna <omphalodes.verna at yahoo.com>
>> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
>> Sent: Saturday, March 16, 2013 4:34 PM
>> Subject: Re: [R-sig-Geo] Union sp polygons ID (rgoes and sp)
>> 
>> On Sat, 16 Mar 2013, Omphalodes Verna wrote:
>> 
>>> Dear list.
>>> 
>>> I would like to do union of many?polygons?in R (rgeos) with ''gUnion'' function (in attached code only 5). Final result should be polygons with unique ID (using attached code it is), but when I plot them (colors by ID value), there are only 5 polygons.?Please, give me some idea. Thanks to all, OV
>> 
>> Are you mistaking gUnion() for gUnaryUnion()?
>> 
>> gU = gUnaryUnion(SPLpoly, id=rep("1", length(SPLpoly)))
>> 
>> Roger
>> 
>>> 
>>> RCode:
>>> library(rgeos)
>>> library(sp)
>>> n <- 5
>>> xy <- cbind(runif(n), runif(n), runif(n), runif(n))
>>> LLine <- vector("list", n)
>>> LLines <- vector("list", n)
>>> for(i in 1:n) LLine[[i]] <- Line(rbind(xy[i, 1:2], xy[i, 3:4]))
>>> for(i in 1:n) LLines[[i]] <- Lines(LLine[[i]], ID = i)
>>> SPLines <- SpatialLines(LLines)
>>> SPLpoly <- gBuffer(SPLines, width = 0.05, byid = TRUE)
>>> plot(SPLines, col = getSLLinesIDSlots(SPLines))
>>> plot(SPLpoly, add = TRUE, col = getSLLinesIDSlots(SPLines))
>>> SPLpolyA <- SPLpoly
>>> SPLpolyB <- SPLpoly
>>> gU = gUnion(SPLpolyA, SPLpolyB, ?byid = TRUE)
>>> plot(gU, col = rainbow(length(gU)))
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> -- Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>> 
>
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hengl at spatial-analyst.net  Sun Mar 17 12:25:31 2013
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Sun, 17 Mar 2013 12:25:31 +0100
Subject: [R-sig-Geo] spatio-temporal data
In-Reply-To: <CAOytA4avAyCArmUz3_2n_tatXJAw_s429JRbaa20cPYjfOB0Vw@mail.gmail.com>
References: <CAOytA4avAyCArmUz3_2n_tatXJAw_s429JRbaa20cPYjfOB0Vw@mail.gmail.com>
Message-ID: <5145A82B.10204@spatial-analyst.net>


That is a good question (I had the same problem when I started using the 
spacetime package). It is all, of course, explained in the spacetime 
package vignette (http://CRAN.R-project.org/package=spacetime), but one 
more time:

To create an object of any class you can always use the command "new" 
(http://stat.ethz.ch/R-manual/R-devel/library/methods/html/new.html). 
For example, to create an object of type STIDF you would use:

new("STIDF", STI(sp, time, endTime), data = data)

But the creators of the spacetime package have also prepared methods 
that would do that for you 
(https://r-forge.r-project.org/scm/viewvc.php/pkg/R/STIDF-methods.R?view=markup&root=spacetime) 
e.g.:

## load the data:
data(HRtemp08)

## format the time column:
HRtemp08$ctime <- as.POSIXct(HRtemp08$DATE, format="%Y-%m-%dT%H:%M:%SZ")

## create a STIDF object:
library(spacetime)
sp <- SpatialPoints(HRtemp08[,c("Lon","Lat")])
proj4string(sp) <- CRS("+proj=longlat +datum=WGS84")
HRtemp08.st <- STIDF(sp, time = HRtemp08$ctime, data = 
HRtemp08[,c("NAME","TEMP")])

See also:

http://plotkml.r-forge.r-project.org/layer.STIDF.html

HTH,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

On 16/03/2013 20:18, Saman Monfared wrote:
> Dear All,
> I want to construct a ST class data with spacetime package.
> Observations are cancer mortality rate in 15 fixed locations for
> sparse time in 7 years.
> I don't know how input my data as a locations and time. I have seen example
> data air and fires in this package but I can't understand how they constructed.
> for example can I input my data as a below then construct a st class?how?
>
> locations      x      y    time
>     point1    cord1   cord2  time1
>     point1    cord1   cord2  time2
>        .        .       .      .
>        .        .       .      .
> Best.
>


From alexandresantosbr at yahoo.com.br  Sun Mar 17 12:54:01 2013
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Sun, 17 Mar 2013 07:54:01 -0400
Subject: [R-sig-Geo] Problem with SpatialPolygons.SpatialPixels object
Message-ID: <5145AED9.5030909@yahoo.com.br>

Dear list members,

     I'm trying to create a as.SpatialPolygons.SpatialPixels object with 
sp package, normally this function works, but I try to use without 
success, above a example in this list posted by Dr. Justiniano:

##
require(sp)
set.seed(12)
xy <- cbind(runif(n=500,min=0, max=20),
              runif(n=500,min=0, max=20))
## points
pontos <- SpatialPoints(xy)
## grid of "quadrats"
## i. as SpatialGrid
grid <- SpatialGrid(grid = GridTopology(c(0.5,0.5), c(1,1), c(20,20)))
## ii. as SpatialPixels
gridPix <- grid
fullgrid(gridPix) <- FALSE
## iii. as SpatialPolygons
gridPol <- as.SpatialPolygons.SpatialPixels(gridPix)
#
     And my question is whats is happening with the 
as.SpatialPolygons.SpatialPixels() function?

Thanks

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
Coordenador do curso T?cnico em Florestas
Vice Coordenador do curso de Engenharia Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 8132-8112 (TIM)   (+55) 65 9686-6970 (VIVO)

         alexandre.santos at cas.ifmt.edu.br


From edzer.pebesma at uni-muenster.de  Sun Mar 17 13:11:28 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 17 Mar 2013 13:11:28 +0100
Subject: [R-sig-Geo] Problem with SpatialPolygons.SpatialPixels object
In-Reply-To: <5145AED9.5030909@yahoo.com.br>
References: <5145AED9.5030909@yahoo.com.br>
Message-ID: <5145B2F0.1010705@uni-muenster.de>

the function is no longer exported as function, but rather as coerce method:

gridPol <- as(gridPix, "SpatialPolygons")

will call this function. Calling the old function can be done with

gridPol <- sp:::as.SpatialPolygons.SpatialPixels(gridPix)

but is not recommended - names of unexported functions may change
without warning.

On 03/17/2013 12:54 PM, ASANTOS wrote:
> Dear list members,
> 
>     I'm trying to create a as.SpatialPolygons.SpatialPixels object with
> sp package, normally this function works, but I try to use without
> success, above a example in this list posted by Dr. Justiniano:
> 
> ##
> require(sp)
> set.seed(12)
> xy <- cbind(runif(n=500,min=0, max=20),
>              runif(n=500,min=0, max=20))
> ## points
> pontos <- SpatialPoints(xy)
> ## grid of "quadrats"
> ## i. as SpatialGrid
> grid <- SpatialGrid(grid = GridTopology(c(0.5,0.5), c(1,1), c(20,20)))
> ## ii. as SpatialPixels
> gridPix <- grid
> fullgrid(gridPix) <- FALSE
> ## iii. as SpatialPolygons
> gridPol <- as.SpatialPolygons.SpatialPixels(gridPix)
> #
>     And my question is whats is happening with the
> as.SpatialPolygons.SpatialPixels() function?
> 
> Thanks
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From nazargis at gmail.com  Mon Mar 18 04:32:40 2013
From: nazargis at gmail.com (Nazaruddin Nad)
Date: Mon, 18 Mar 2013 10:32:40 +0700
Subject: [R-sig-Geo] (no subject)
Message-ID: <CACnYrQMtcXr_tAM6gXLvcEUU_D1trJui4PksdMkN_sTw2zTTsQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130318/8ed37914/attachment.pl>

From alobolistas at gmail.com  Mon Mar 18 07:33:00 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 18 Mar 2013 07:33:00 +0100
Subject: [R-sig-Geo] create a 3d shapefile ?
In-Reply-To: <CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>
References: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
	<CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>
Message-ID: <CAG4NReLWqDgT0xZr=uL9QPXQ0cy=K6Ut1oxXT81VpS=gsqGzOA@mail.gmail.com>

Thanks, this is what seemed to me, but the following phrase from the sp pdf
"The classes document where the spatial location
information resides, for 2D or 3D data"

and some scattered info such as
http://gis.stackexchange.com/questions/43342/how-to-use-z-coordinate-in-qgis
http://grokbase.com/t/r/r-sig-geo/127s88jzc6/problem-extracting-z-value-from-line-shapefile

make me think that some support for x,y,x coordinates actually exists
in sp and perhaps writeOGR() could
have taken advantage of it.

I've got very good advice on how to create the 3d shapefiles using
simple python scripting in the qgis list, I insert the link:
http://osgeo-org.1560.n6.nabble.com/create-3d-shapefile-and-or-GPX-tp5040855p5040863.html

Agus

On Sat, Mar 16, 2013 at 2:00 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> It is not possible.
>
> Cheers, Mike
>
> On Saturday, March 16, 2013, Agustin Lobo wrote:
>
>> Is it possible to write point ESRI shapefiles with x,y,z
>> coordinates using writeOGR()?
>> According to what I've been able to find, it seems
>> that spatial points can have 3 coordinates while
>> spatial lines cannot. Nevertheless, coordinates() accepts
>> 2 arguments (x,y) only. So actually, do not know how to define
>> x,y,z coordinates for spatial points (data frame) objects.
>> Is it possible?
>>
>> Thanks,
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <javascript:;>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Mon Mar 18 08:54:32 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 18 Mar 2013 18:54:32 +1100
Subject: [R-sig-Geo]  create a 3d shapefile ?
In-Reply-To: <CAG4NReLWqDgT0xZr=uL9QPXQ0cy=K6Ut1oxXT81VpS=gsqGzOA@mail.gmail.com>
References: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
	<CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>
	<CAG4NReLWqDgT0xZr=uL9QPXQ0cy=K6Ut1oxXT81VpS=gsqGzOA@mail.gmail.com>
Message-ID: <CAAcGz9_MDNEmFY9iQUDbEVy-+zVpaqiVfEbSQe3fd28OV4A9wQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130318/fa474ed1/attachment.pl>

From alobolistas at gmail.com  Mon Mar 18 10:19:43 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 18 Mar 2013 10:19:43 +0100
Subject: [R-sig-Geo] create a 3d shapefile ?
In-Reply-To: <CAAcGz9_MDNEmFY9iQUDbEVy-+zVpaqiVfEbSQe3fd28OV4A9wQ@mail.gmail.com>
References: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
	<CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>
	<CAG4NReLWqDgT0xZr=uL9QPXQ0cy=K6Ut1oxXT81VpS=gsqGzOA@mail.gmail.com>
	<CAAcGz9_MDNEmFY9iQUDbEVy-+zVpaqiVfEbSQe3fd28OV4A9wQ@mail.gmail.com>
Message-ID: <CAG4NReKLyLmK9NFYFkUYDtG-pZmwg=Dv5=RXPtCc1_+X-Om6Dw@mail.gmail.com>

Actually my current need is writing aerial waypoints as gpx files with
x,y,z to be used in the field with a gps program
(ie. oruxmaps) for an android tablet.
I do create the waypoints in R (as I plan the campaign with R), so my
problem is not reading 3d shapefiles, but writing the 3d waypoints
either to gpx directly
or to shapefile and then convert to gpx with i.e. gpsbabel.
My understanding is that rgdal/sp cirrently support reading 3d
shapefiles but not actually writing 3d spatial points DF

Agus

On Mon, Mar 18, 2013 at 8:54 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> It's actually something I have long wanted to explore, but rgdal source is
> still out of reach to me (just need to spend enough time). I think it would
> be useful to read and write 3 and possibly 4-d objects, and apart from the
> class validation and read/write this is possible for points and lines if
> you generalize bbox. It would obviously break for a lot of downstream uses
> of sp though.
>
> Reading from shapefiles with Z would be enough for a lot of things, perhaps
> it's worth chasing that and making a special class that won't break
> anything else (Roger Bivand explained this offlist some time ago, and I can
> do that but it's the read I want to figure out myself).  But, it has been a
> long time since I compiled rgdal so even simple exploration is a way off
> for me.
>
> Note that polygons in OGC are composed of linear rings and so unless your
> polys are composed completely of individual triangle facets they are rarely
> going to be of any use. Lines are much simpler but still pose complications
> for validation in 2d (think of intersecting lines) compared to 3d or higher.
>
> As a workaround you can use gdal to extract the data to something more
> generic, as here
> https://stat.ethz.ch/pipermail/r-sig-geo/2009-November/006866.html
>
>
> Cheers, Mike
>
>
>
> On Monday, March 18, 2013, Agustin Lobo wrote:
>
>> Thanks, this is what seemed to me, but the following phrase from the sp pdf
>> "The classes document where the spatial location
>> information resides, for 2D or 3D data"
>>
>> and some scattered info such as
>>
>> http://gis.stackexchange.com/questions/43342/how-to-use-z-coordinate-in-qgis
>>
>> http://grokbase.com/t/r/r-sig-geo/127s88jzc6/problem-extracting-z-value-from-line-shapefile
>>
>> make me think that some support for x,y,x coordinates actually exists
>> in sp and perhaps writeOGR() could
>> have taken advantage of it.
>>
>> I've got very good advice on how to create the 3d shapefiles using
>> simple python scripting in the qgis list, I insert the link:
>>
>> http://osgeo-org.1560.n6.nabble.com/create-3d-shapefile-and-or-GPX-tp5040855p5040863.html
>>
>> Agus
>>
>> On Sat, Mar 16, 2013 at 2:00 PM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>> > It is not possible.
>> >
>> > Cheers, Mike
>> >
>> > On Saturday, March 16, 2013, Agustin Lobo wrote:
>> >
>> >> Is it possible to write point ESRI shapefiles with x,y,z
>> >> coordinates using writeOGR()?
>> >> According to what I've been able to find, it seems
>> >> that spatial points can have 3 coordinates while
>> >> spatial lines cannot. Nevertheless, coordinates() accepts
>> >> 2 arguments (x,y) only. So actually, do not know how to define
>> >> x,y,z coordinates for spatial points (data frame) objects.
>> >> Is it possible?
>> >>
>> >> Thanks,
>> >>
>> >> Agus
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org <javascript:;>
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >
>> > --
>> > Michael Sumner
>> > Hobart, Australia
>> > e-mail: mdsumner at gmail.com
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alessandrosamuel at yahoo.com.br  Mon Mar 18 12:51:55 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Mon, 18 Mar 2013 04:51:55 -0700 (PDT)
Subject: [R-sig-Geo] Custom variogram models in gstat
Message-ID: <1363607515.96924.YahooMailNeo@web141401.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130318/1cbc8e3f/attachment.pl>

From alessandrosamuel at yahoo.com.br  Mon Mar 18 12:52:59 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Mon, 18 Mar 2013 04:52:59 -0700 (PDT)
Subject: [R-sig-Geo] Custom variogram models in gstat
Message-ID: <1363607579.86494.YahooMailNeo@web141402.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130318/db52b478/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Mar 18 13:16:33 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 18 Mar 2013 13:16:33 +0100
Subject: [R-sig-Geo] Custom variogram models in gstat
In-Reply-To: <1363607579.86494.YahooMailNeo@web141402.mail.bf1.yahoo.com>
References: <1363607579.86494.YahooMailNeo@web141402.mail.bf1.yahoo.com>
Message-ID: <514705A1.9070206@uni-muenster.de>

Alessandro, you have two options:

First, gstat is open source, is written modular, so it is fairly
straightforward to add variogram models, but this has to be done at the
level of C code. src/vario_fn.c and src/vario_fn.h are the files to look
at; search for 'bess' and add yours. If you do, please consider
contributing your modifications back to us.

Second option is to pre-calculate values of your model in a table, and
provide the to gstat as a set of values to work with, see an example in:

https://r-forge.r-project.org/scm/viewvc.php/pkg/tests/covtable.R?view=markup&root=gstat

Hth,
--
Edzer

On 03/18/2013 12:52 PM, Alessandro Samuel Rosa wrote:
> 
> Hi, is it possible to use 
> custom variogram models in gstat? I have a data set with a hole effect. 
> I've been searching the literature and found out that the Bessel model (J type) is the most appropriate (see Webster and Oliver, 2007). gstat has Bessel K. Does anyone knows a solution?
>  
> Alessandro Samuel-Rosa
> Postgraduate Course in Agronomy - Soil Science
> Federal Rural University of Rio de Janeiro
> Serop?dica, Rio de Janeiro, Brazil
> soil-scientist.net
> 
> "If we had obeyed our elders, the high priests in our field of science when we were young, if we had relied on them to guide our research, then we should still be grappling with the legacy of John Stuart Mill and Aristotle. No; it is for the young to have their ideas, and for us older ones to allow those ideas to bubble to the surface. We may modify them, channel them, challenge them,  criticize them; but at all events we should encourage them. The young and their ideas are our future." Richard Webster (1994)
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alobolistas at gmail.com  Mon Mar 18 17:49:49 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 18 Mar 2013 17:49:49 +0100
Subject: [R-sig-Geo] create a 3d shapefile ?
In-Reply-To: <CAG4NReKLyLmK9NFYFkUYDtG-pZmwg=Dv5=RXPtCc1_+X-Om6Dw@mail.gmail.com>
References: <CAG4NReLwFwZ-P+cQHFOwkCCvBCU4f6wdaQBupXgOSkY5+xpQ_w@mail.gmail.com>
	<CAAcGz992W9G=hdqc1texPfQ1pBsxgQL5yHnNNsDB97bv3Qs8ig@mail.gmail.com>
	<CAG4NReLWqDgT0xZr=uL9QPXQ0cy=K6Ut1oxXT81VpS=gsqGzOA@mail.gmail.com>
	<CAAcGz9_MDNEmFY9iQUDbEVy-+zVpaqiVfEbSQe3fd28OV4A9wQ@mail.gmail.com>
	<CAG4NReKLyLmK9NFYFkUYDtG-pZmwg=Dv5=RXPtCc1_+X-Om6Dw@mail.gmail.com>
Message-ID: <CAG4NReK-EPfhnDUeMdYFNCAMvHWRpcw44euYG-V2aU41HBH-Bg@mail.gmail.com>

Actually a simple workaround is writing a csv and then using
gpsbabel to convert into gpx:

command <- "gpsbabel -w -i unicsv -f wpAlfacs13_2000lonlat.csv -o gpx
-F wpAlfacs13_2000lonlat.gpx"
system(command)

care must be taken with the names of the csv following the keywords
defined for unicsv by gpsbabel (I think,
http://www.gpsbabel.org/htmldoc-1.4.2/fmt_unicsv.html
is a bit obscure in this regard)

In my case:

names(wpAlfacs13_2000lonlat at data)
[1] "name" "lon"  "lat"  "alt"  "fl"

field "fl" is lost but  "lon"  "lat"  "alt" successfully create a 3d
waypoints gpx file and "name" propagates to the wp names.

Agus


On Mon, Mar 18, 2013 at 10:19 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Actually my current need is writing aerial waypoints as gpx files with
> x,y,z to be used in the field with a gps program
> (ie. oruxmaps) for an android tablet.
> I do create the waypoints in R (as I plan the campaign with R), so my
> problem is not reading 3d shapefiles, but writing the 3d waypoints
> either to gpx directly
> or to shapefile and then convert to gpx with i.e. gpsbabel.
> My understanding is that rgdal/sp cirrently support reading 3d
> shapefiles but not actually writing 3d spatial points DF
>
> Agus
>
> On Mon, Mar 18, 2013 at 8:54 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>> It's actually something I have long wanted to explore, but rgdal source is
>> still out of reach to me (just need to spend enough time). I think it would
>> be useful to read and write 3 and possibly 4-d objects, and apart from the
>> class validation and read/write this is possible for points and lines if
>> you generalize bbox. It would obviously break for a lot of downstream uses
>> of sp though.
>>
>> Reading from shapefiles with Z would be enough for a lot of things, perhaps
>> it's worth chasing that and making a special class that won't break
>> anything else (Roger Bivand explained this offlist some time ago, and I can
>> do that but it's the read I want to figure out myself).  But, it has been a
>> long time since I compiled rgdal so even simple exploration is a way off
>> for me.
>>
>> Note that polygons in OGC are composed of linear rings and so unless your
>> polys are composed completely of individual triangle facets they are rarely
>> going to be of any use. Lines are much simpler but still pose complications
>> for validation in 2d (think of intersecting lines) compared to 3d or higher.
>>
>> As a workaround you can use gdal to extract the data to something more
>> generic, as here
>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-November/006866.html
>>
>>
>> Cheers, Mike
>>
>>
>>
>> On Monday, March 18, 2013, Agustin Lobo wrote:
>>
>>> Thanks, this is what seemed to me, but the following phrase from the sp pdf
>>> "The classes document where the spatial location
>>> information resides, for 2D or 3D data"
>>>
>>> and some scattered info such as
>>>
>>> http://gis.stackexchange.com/questions/43342/how-to-use-z-coordinate-in-qgis
>>>
>>> http://grokbase.com/t/r/r-sig-geo/127s88jzc6/problem-extracting-z-value-from-line-shapefile
>>>
>>> make me think that some support for x,y,x coordinates actually exists
>>> in sp and perhaps writeOGR() could
>>> have taken advantage of it.
>>>
>>> I've got very good advice on how to create the 3d shapefiles using
>>> simple python scripting in the qgis list, I insert the link:
>>>
>>> http://osgeo-org.1560.n6.nabble.com/create-3d-shapefile-and-or-GPX-tp5040855p5040863.html
>>>
>>> Agus
>>>
>>> On Sat, Mar 16, 2013 at 2:00 PM, Michael Sumner <mdsumner at gmail.com>
>>> wrote:
>>> > It is not possible.
>>> >
>>> > Cheers, Mike
>>> >
>>> > On Saturday, March 16, 2013, Agustin Lobo wrote:
>>> >
>>> >> Is it possible to write point ESRI shapefiles with x,y,z
>>> >> coordinates using writeOGR()?
>>> >> According to what I've been able to find, it seems
>>> >> that spatial points can have 3 coordinates while
>>> >> spatial lines cannot. Nevertheless, coordinates() accepts
>>> >> 2 arguments (x,y) only. So actually, do not know how to define
>>> >> x,y,z coordinates for spatial points (data frame) objects.
>>> >> Is it possible?
>>> >>
>>> >> Thanks,
>>> >>
>>> >> Agus
>>> >>
>>> >> _______________________________________________
>>> >> R-sig-Geo mailing list
>>> >> R-sig-Geo at r-project.org <javascript:;>
>>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >>
>>> >
>>> >
>>> > --
>>> > Michael Sumner
>>> > Hobart, Australia
>>> > e-mail: mdsumner at gmail.com
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> Michael Sumner
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From daniel.flo at skogoglandskap.no  Tue Mar 19 09:02:59 2013
From: daniel.flo at skogoglandskap.no (=?iso-8859-1?Q?Daniel_Fl=F8?=)
Date: Tue, 19 Mar 2013 08:02:59 +0000
Subject: [R-sig-Geo] Question about geoTIFF
Message-ID: <C5353251F5B2EB419DBD9D1341E24F3B48BBC1CB@exdb1.ad.skogoglandskap.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130319/58d53001/attachment.pl>

From kridox at ymail.com  Tue Mar 19 09:34:24 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 19 Mar 2013 17:34:24 +0900
Subject: [R-sig-Geo] Question about geoTIFF
In-Reply-To: <C5353251F5B2EB419DBD9D1341E24F3B48BBC1CB@exdb1.ad.skogoglandskap.no>
References: <C5353251F5B2EB419DBD9D1341E24F3B48BBC1CB@exdb1.ad.skogoglandskap.no>
Message-ID: <51482310.90806@ymail.com>

Hi,

If you use the "raster" package to read the geoTIFF, you can use 
"getValues" (whole data) or "extract" (spatial selection).

HTH,
Pascal


On 19/03/13 17:02, Daniel Fl? wrote:
> Hi,
>
> I have downloaded forestry inventory file in geoTIFF format successfully, and the goal is to extract the data of the cells in the geoTIFF file for use in R calculations. So far, I use the raster package to handle the TIFF file (display map etc), but I cannot figure out how to extract the data and store it to a .csv file. Any one that can help?
>
> Thank you.
>
> Daniel Fl?
> PhD Fellow, Forest Health
> The Norwegian Forest and Landscape Institute
> Pb 115, NO-1431 ?s
> Office:   (+47) 64 94 90 28
> Mobile: (+47) 91 14 52 74
> Skype:    floe.daniel
> -----------------------------------------------------------------
> www.skogoglandskap.no<http://www.skogoglandskap.no/>
> -----------------------------------------------------------------
>
>
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From amen.alyaari at bordeaux.inra.fr  Tue Mar 19 10:53:59 2013
From: amen.alyaari at bordeaux.inra.fr (Amen Alyaari)
Date: Tue, 19 Mar 2013 10:53:59 +0100
Subject: [R-sig-Geo] stack problem
Message-ID: <514835B7.8030108@bordeaux.inra.fr>

Hello All,

I have several rasters that I want to do some calculations ,basically 
calculating the moving average.

             dir2 <- list.files("D:\\2010+2011", "*.bin", full.names = 
TRUE)
            saf=stack(dir2)

code

           movi <-  overlay(stack(saf),fun=function(x) movingFun(x, 
fun=mean, n=3,  na.rm=TRUE))
              Error in .overlayList(x, fun = fun, filename = filename, 
...) :
          cannot use this formula, probably because it is not vectorized
  I then checked the data but found that all values were returned as NA 
and this may explain why I am getting the error.

when the files are stacked ,all in all are NAs
         saf
        class       : RasterStack
        dimensions  : 720, 1440, 1036800, 601  (nrow, ncol, ncell, nlayers)
        resolution  : 0.25, 0.25  (x, y)
        extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
       coord. ref. : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 
+no_defs
      names       : Vol_025_H//00_1_wgs84, Vol_025_H//00_1_wgs84, 
Vol_025_H//00_1_wgs84,    Vol_025_H//00_1_wgs84, Vol_025_H//00_1_wgs84, 
Vol_025_H//00_1_wgs84, , ...
     min values  :                    NA,                    
NA,                    NA,                       NA,                    
NA,                    NA,                    NA,                     
NA,                    NA,                    NA,                    
NA,                    NA,                    NA,                    
NA,                    NA, ...
     max values  :                    NA,                    
NA,                    NA,                    NA,                    
NA,                    NA,                    NA,                    
NA,                    NA,                    NA,                    
NA,                       NA,                    NA,                    
NA,                    NA, ...


something is wrong because there is no NAs in my files. All  values are 
up to 9999. I wonder why this is happening, I checked the files 
separately(summary) and everything was right!as you can see bellow:

               summary(saf)
              ol_025_H14_2011092000_1_wgs84 
Vol_025_H14_2011092100_1_wgs84   Vol_025_H14_2011092200_1_wgs84 
Vol_025_H14_2011092300_1_wgs84 Vol_025_H14_2011092400_1_wgs84
       Min.                           0.00000                      
0.0000000                            0.0000000                      
0.0000000                      0.0000000
      1st Qu.                        0.31883                      
0.3163167                      0.3146436                      
0.3113111                      0.3064551
      Median                      9999.00000                   
9999.0000000                   9999.0000000                   
9999.0000000                   9999.0000000
      3rd Qu.                     9999.00000                   
9999.0000000                   9999.0000000                   
9999.0000000                   9999.0000000
       Max.                        9999.00000                   
9999.0000000                   9999.0000000                   
9999.0000000                   9999.0000000
      NA's                           0.00000                      
0.0000000                        0.0000000                      0.00000

   I checked with only two files, but I got the same error:

               class       : RasterStack
         dimensions  : 720, 1440, 1036800, 2  (nrow, ncol, ncell, nlayers)
         resolution  : 0.25, 0.25  (x, y)
         extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
         coord. ref. : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 
+no_defs
        names       : Vol_025_H14_2010011400_1_wgs84, 
Vol_025_H14_2010011500_1_wgs84
         min values  :                             
NA,                             NA
         max values  :                             
NA,                             NA

 > summary(saf)
               Vol_025_H14_2010011400_1_wgs84 
Vol_025_H14_2010011500_1_wgs84
         Min.                             0.000                          
0.000
         1st Qu.                          0.159                          
0.159
         Median                        9999.000                       
9999.000
         3rd Qu.                       9999.000                       
9999.000
         Max.                          9999.000                       
9999.000
        NA's                             0.000                          
0.000
I am grateful to anyhelp

download the two files I checked here: 
https://echange-fichiers.inra.fr/get?k=bWqfIVMDR5UgQnff6eU

-- 
Amen Alyaari, UPMC
PhD student
Unit of Functional Ecology&  Environmental Physics [EPHYSE]
National Institute of Agricultural Research [INRA].
71, Avenue Edouard Bourlaux
33140 Villenave d'Ornon
T?l?phone : +33(0) 5 57 12 24 27
Fax : +33 (0)5 57 12 24 20
FRANCE


From n.anselm at fu-berlin.de  Tue Mar 19 12:14:48 2013
From: n.anselm at fu-berlin.de (N. Anselm)
Date: Tue, 19 Mar 2013 12:14:48 +0100
Subject: [R-sig-Geo] RSAGA catchment area (flow tracing) with AsterGDEM
Message-ID: <2b067d29e4aef53b1941a9f6900676e9@posteo.de>

dear list,

I use R for scripting in saga gis. Mostly it works fine, but I dont 
know why the catchment area (flow tracing) does not work with the ASTER 
scene. In saga it works,
so it should be something in my 'code'. I tried METHOD as well as 
Method (there seems to be inconsistency in saga), I tried 
CORRECT=FALSE,False,0 and not,
none of it worked, possibly it's something completely different.

Maybe someone of you can give advice?
thank you very much,

n. anselm




workenv<-rsaga.env(workspace=".",path="/usr/bin",modules="/usr/lib/saga")

rsaga.geoprocessor(lib="ta_hydrology",module=2,env=workenv,param=list(DEM="aster_nosink.sgrd",CAREA="aster_catchmentarea",CSLOPE="aster_catchmentslope",STEP=1,Method=0,MINDQV=0.0,CORRECT=FALSE))

> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: i686-pc-linux-gnu (32-bit)

locale:
  [1] LC_CTYPE=de_DE.UTF-8          LC_NUMERIC=C
  [3] LC_TIME=de_DE.UTF-8           LC_COLLATE=de_DE.UTF-8
  [5] LC_MONETARY=de_DE.UTF-8       LC_MESSAGES=de_DE.UTF-8
  [7] LC_PAPER=de_DE.UTF-8          LC_NAME=de_DE.UTF-8
  [9] LC_ADDRESS=de_DE.UTF-8        LC_TELEPHONE=de_DE.UTF-8
[11] LC_MEASUREMENT=de_DE.UTF-8    LC_IDENTIFICATION=de_DE.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.0-41  RSAGA_0.93-2   plyr_1.8       shapefiles_0.7 
foreign_0.8-48
[6] gstat_1.0-16   sp_1.0-5       rkward_0.5.6

loaded via a namespace (and not attached):
[1] grid_2.14.1      intervals_0.13.3 lattice_0.20-0   spacetime_1.0-4
[5] tools_2.14.1     xts_0.9-3        zoo_1.7-9


From oscar.perpinan at gmail.com  Tue Mar 19 13:26:58 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Tue, 19 Mar 2013 13:26:58 +0100
Subject: [R-sig-Geo] Problem with projection in NetCDF file
In-Reply-To: <87fw0ogoxz.fsf@gmail.com>
References: <87fw0ogoxz.fsf@gmail.com>
Message-ID: <87y5dj60dp.fsf@gmail.com>

Hello,

If anyone is interested in the datasets related to my last question, I finally
managed to work with them using these proj4 strings:

2D: http://mandeo.meteogalicia.es/thredds/catalogos/WRF_2D/catalog.html
"+proj=lcc +lon_0=-14.1 +lat_0=34.823 +lat_1=43 +lat_2=43 +x_0=536402.3 +y_0=-18558.61 +units=km +ellps=WGS84"

3D: http://mandeo.meteogalicia.es/thredds/catalogos/WRF/catalog_grib.html
"+proj=lcc +lon_0=-14.1 +lat_0=43 +lat_1=43 +lat_2=43 +units=km +ellps=WGS84 +a=6371400 +b=6371400"

Best,

Oscar.

Oscar Perpi??n Lamigueiro <oscar.perpinan at gmail.com> writes:

> I am trying to use the NetCDF files available at the
> Meteogalicia-THREDDS server
> (http://www.meteogalicia.es/web/modelos/threddsIndex.action). I am
> having problems with the projection parameters (see figure attached for
> a quick understanding of the problem).

-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From amen.alyaari at bordeaux.inra.fr  Tue Mar 19 13:58:21 2013
From: amen.alyaari at bordeaux.inra.fr (Amen Alyaari)
Date: Tue, 19 Mar 2013 13:58:21 +0100
Subject: [R-sig-Geo] addition information to my previous question
Message-ID: <514860ED.4080107@bordeaux.inra.fr>

Hello,

Now I know where is exactly the problem, it is when I use sd(standard 
deviation) as  a function instead of mean
> movi <-  overlay(stack(saf),fun=function(x) movingFun(x, fun=mean, 
> n=3,  na.rm=TRUE)) ####  worked well
     sd <-  overlay(stack(saf),fun=function(x) movingFun(x, fun=sd, n=3, 
  na.rm=TRUE)) ####  did not work!!!!

Any idea please on how to resolve it because I need both sd and mean

-- 
Amen Alyaari, UPMC
PhD student
Unit of Functional Ecology&  Environmental Physics [EPHYSE]
National Institute of Agricultural Research [INRA].
71, Avenue Edouard Bourlaux
33140 Villenave d'Ornon
T?l?phone : +33(0) 5 57 12 24 27
Fax : +33 (0)5 57 12 24 20
FRANCE


From rhurlin at gwdg.de  Tue Mar 19 14:39:18 2013
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue, 19 Mar 2013 14:39:18 +0100
Subject: [R-sig-Geo] RSAGA catchment area (flow tracing) with AsterGDEM
In-Reply-To: <2b067d29e4aef53b1941a9f6900676e9@posteo.de>
References: <2b067d29e4aef53b1941a9f6900676e9@posteo.de>
Message-ID: <51486A86.9050106@gwdg.de>

Am 19.03.2013 12:14 (UTC+1) schrieb N. Anselm:
> dear list,
> 
> I use R for scripting in saga gis. Mostly it works fine, but I dont know
> why the catchment area (flow tracing) does not work with the ASTER
> scene. In saga it works,
> so it should be something in my 'code'. I tried METHOD as well as Method
> (there seems to be inconsistency in saga), I tried CORRECT=FALSE,False,0
> and not,
> none of it worked, possibly it's something completely different.
> 
> Maybe someone of you can give advice?
> thank you very much,
> 
> n. anselm
> 
> 
> workenv<-rsaga.env(workspace=".",path="/usr/bin",modules="/usr/lib/saga")
> 
> rsaga.geoprocessor(lib="ta_hydrology",module=2,env=workenv,param=list(DEM="aster_nosink.sgrd",CAREA="aster_catchmentarea",CSLOPE="aster_catchmentslope",STEP=1,Method=0,MINDQV=0.0,CORRECT=FALSE))

Hmm, it seems that your DEM= should be changed into ELEVATION=

But I may be wrong because I am working with the upcoming version 2.1.0
on FreeBSD with R-devel and RSAGA-0.93-2.

HTH,
Rainer


>> sessionInfo()
> R version 2.14.1 (2011-12-22)
> Platform: i686-pc-linux-gnu (32-bit)
> 
> locale:
>  [1] LC_CTYPE=de_DE.UTF-8          LC_NUMERIC=C
>  [3] LC_TIME=de_DE.UTF-8           LC_COLLATE=de_DE.UTF-8
>  [5] LC_MONETARY=de_DE.UTF-8       LC_MESSAGES=de_DE.UTF-8
>  [7] LC_PAPER=de_DE.UTF-8          LC_NAME=de_DE.UTF-8
>  [9] LC_ADDRESS=de_DE.UTF-8        LC_TELEPHONE=de_DE.UTF-8
> [11] LC_MEASUREMENT=de_DE.UTF-8    LC_IDENTIFICATION=de_DE.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] raster_2.0-41  RSAGA_0.93-2   plyr_1.8       shapefiles_0.7
> foreign_0.8-48
> [6] gstat_1.0-16   sp_1.0-5       rkward_0.5.6
> 
> loaded via a namespace (and not attached):
> [1] grid_2.14.1      intervals_0.13.3 lattice_0.20-0   spacetime_1.0-4
> [5] tools_2.14.1     xts_0.9-3        zoo_1.7-9


From etiennebr at gmail.com  Tue Mar 19 14:54:05 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 19 Mar 2013 09:54:05 -0400
Subject: [R-sig-Geo] addition information to my previous question
In-Reply-To: <514860ED.4080107@bordeaux.inra.fr>
References: <514860ED.4080107@bordeaux.inra.fr>
Message-ID: <CALjAYt6svM26t2pONmmtfTULSFxx5+US8g99RbxQMyYA3OX-wQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130319/cdc08947/attachment.pl>

From amen.alyaari at bordeaux.inra.fr  Tue Mar 19 15:41:35 2013
From: amen.alyaari at bordeaux.inra.fr (Amen Alyaari)
Date: Tue, 19 Mar 2013 15:41:35 +0100
Subject: [R-sig-Geo] addition information to my previous question
In-Reply-To: <CALjAYt6svM26t2pONmmtfTULSFxx5+US8g99RbxQMyYA3OX-wQ@mail.gmail.com>
References: <514860ED.4080107@bordeaux.inra.fr>
	<CALjAYt6svM26t2pONmmtfTULSFxx5+US8g99RbxQMyYA3OX-wQ@mail.gmail.com>
Message-ID: <5148791F.3070706@bordeaux.inra.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130319/d30f4d2f/attachment.pl>

From tan.afreebird at gmail.com  Tue Mar 19 16:00:25 2013
From: tan.afreebird at gmail.com (ToNoY)
Date: Tue, 19 Mar 2013 08:00:25 -0700 (PDT)
Subject: [R-sig-Geo] calculate semivariogram values and perform kriging BY
 HAND for a simple dataset
Message-ID: <1363705225898-7583097.post@n2.nabble.com>

Can anyone tell me how to calculate semivariogram values by hand for point C
and D considering the distance between point A and B? say I have the
following data points:

point A: 60 (X-cord), 50 (Y-cord), & 1.2 (Z)
point B: 30 (X-cord), 20 (Y-cord), & 2.1 (Z)
point C: 20 (X-cord), 50 (Y-cord), & ? (Z)
point D: 60 (X-cord), 50 (Y-cord), & ? (Z)

Now, say, the best fit for model for the semivariogram is given by a
spherical model as:

 y(h) = C0 + C(1-e^(h/a))

where, C0 = nugget effect, h = distance, and a = range. How can I do
ordinary kriging by hand to estimate the Z value at point C and D. Also, how
much weight (w) should be given to ZA and ZB while estimating ZC
(ZC=w1*ZA+w2*ZB) or ZD (ZD=w1*ZA+w2*ZB)? Thanks in advance.




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/calculate-semivariogram-values-and-perform-kriging-BY-HAND-for-a-simple-dataset-tp7583097.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From etiennebr at gmail.com  Tue Mar 19 16:24:59 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 19 Mar 2013 11:24:59 -0400
Subject: [R-sig-Geo] addition information to my previous question
In-Reply-To: <5148791F.3070706@bordeaux.inra.fr>
References: <514860ED.4080107@bordeaux.inra.fr>
	<CALjAYt6svM26t2pONmmtfTULSFxx5+US8g99RbxQMyYA3OX-wQ@mail.gmail.com>
	<5148791F.3070706@bordeaux.inra.fr>
Message-ID: <CALjAYt6Ln73hZRNcJddSLvveoPNfV9DsC=kropdAKdyirKbHEQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130319/b61d84fa/attachment.pl>

From sarah.goslee at gmail.com  Tue Mar 19 16:25:16 2013
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Tue, 19 Mar 2013 11:25:16 -0400
Subject: [R-sig-Geo] calculate semivariogram values and perform kriging
 BY HAND for a simple dataset
In-Reply-To: <1363705225898-7583097.post@n2.nabble.com>
References: <1363705225898-7583097.post@n2.nabble.com>
Message-ID: <CAM_vju=aZHjMFjMKR4baUYKrgx0Se3crzxscQOKVtXhNrhkcGg@mail.gmail.com>

Hi,

This sounds rather like homework.

On Tue, Mar 19, 2013 at 11:00 AM, ToNoY <tan.afreebird at gmail.com> wrote:
> Can anyone tell me how to calculate semivariogram values by hand for point C

And by hand? How is this an R question?

If you have an R question, by all means ask here. If you have a
homework question, please ask your professor or TA. If you have a
general stats question, StackOverflow is a good choice.

Sarah

> and D considering the distance between point A and B? say I have the
> following data points:
>
> point A: 60 (X-cord), 50 (Y-cord), & 1.2 (Z)
> point B: 30 (X-cord), 20 (Y-cord), & 2.1 (Z)
> point C: 20 (X-cord), 50 (Y-cord), & ? (Z)
> point D: 60 (X-cord), 50 (Y-cord), & ? (Z)
>
> Now, say, the best fit for model for the semivariogram is given by a
> spherical model as:
>
>  y(h) = C0 + C(1-e^(h/a))
>
> where, C0 = nugget effect, h = distance, and a = range. How can I do
> ordinary kriging by hand to estimate the Z value at point C and D. Also, how
> much weight (w) should be given to ZA and ZB while estimating ZC
> (ZC=w1*ZA+w2*ZB) or ZD (ZD=w1*ZA+w2*ZB)? Thanks in advance.
>
>


--
Sarah Goslee
http://www.functionaldiversity.org


From Meyerha at students.uni-marburg.de  Tue Mar 19 17:25:17 2013
From: Meyerha at students.uni-marburg.de (Hanna Meyer)
Date: Tue, 19 Mar 2013 17:25:17 +0100
Subject: [R-sig-Geo] plotRGB and graphical parameters
Message-ID: <CAHicjGsAY0JMEWLOqb9x7P5ghCVFWACSXwcRSsCp9nRMKrU2bQ@mail.gmail.com>

Hello all,

I tried to plot a raster with plotRGB and realized that some of the
graphical parameters seem to be ignored.

for example:
b <- brick(system.file("external/rlogo.grd", package="raster"))
plotRGB(b, 3, 2, 1,axes=T,las=0,cex.axis=2,main="test")

in this way las,cex.axis and main are ignored although graphical
parameters could be used according to the plotRGB help.
Some of the ignored parameters can be set if par is set before the plot command:

par(las=2,cex.axis=2)
plotRGB(b, 3, 2, 1,axes=T)
title(main="Test")

However it doesn't work for las=0 because the labels are still not
parallel to the yaxis. Further, somehow for some other rasters
cex.axis is ignored even in this way.
Does anyone knows the problem and has an idea how to overcome this?

Many thanks
Hanna


From tan.afreebird at gmail.com  Tue Mar 19 17:29:16 2013
From: tan.afreebird at gmail.com (ToNoY)
Date: Tue, 19 Mar 2013 09:29:16 -0700 (PDT)
Subject: [R-sig-Geo] calculate semivariogram values and perform kriging
 BY HAND for a simple dataset
In-Reply-To: <CAM_vju=aZHjMFjMKR4baUYKrgx0Se3crzxscQOKVtXhNrhkcGg@mail.gmail.com>
References: <1363705225898-7583097.post@n2.nabble.com>
	<CAM_vju=aZHjMFjMKR4baUYKrgx0Se3crzxscQOKVtXhNrhkcGg@mail.gmail.com>
Message-ID: <1363710556015-7583101.post@n2.nabble.com>

@Sarah Goslee: Calculation by hand is the basic that everyone should know
before using R functions. I've prepared this for my students and I thought I
should know, in general, the level of difficulty it poses. Indeed, people do
miracles with R, but there are only a few who understands the underlying
statistics (what's happening behind the scene). For such problems, "GeoR"
can do such things in the blink of the eye -- who cares what it's doing??






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/calculate-semivariogram-values-and-perform-kriging-BY-HAND-for-a-simple-dataset-tp7583097p7583101.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alessandrosamuel at yahoo.com.br  Tue Mar 19 19:38:04 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Tue, 19 Mar 2013 11:38:04 -0700 (PDT)
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
	<CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>
Message-ID: <1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130319/3ba6e1fd/attachment.pl>

From rossahmed at googlemail.com  Wed Mar 20 09:15:01 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Wed, 20 Mar 2013 08:15:01 +0000
Subject: [R-sig-Geo] raster nearest neighbours
Message-ID: <CD6F2085.4326%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/464ef5b3/attachment.pl>

From rafael.wueest at wsl.ch  Wed Mar 20 09:49:24 2013
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Wed, 20 Mar 2013 09:49:24 +0100
Subject: [R-sig-Geo] raster nearest neighbours
In-Reply-To: <CD6F2085.4326%rossahmed@gmail.com>
References: <CD6F2085.4326%rossahmed@gmail.com>
Message-ID: <72D67BF2-2D84-4ABF-A5FE-A1055CCADEB1@wsl.ch>

Hi Ross

Try

points2<-rasterToPoints(raster2,spatial=TRUE)
distraster<-distanceFromPoints(raster1,points2)
distmasked<-mask(distraster,raster1,inverse=TRUE)

yourraster<-merge(distmasked<3000,raster1)

HTH,
Rafael

On 20.03.2013, at 09:15, Ross Ahmed <rossahmed at googlemail.com> wrote:

> Hi all,
> 
> I have two rasters with the same extent and resolution, similar to these
> two:
> 
> raster2 <- raster1 <- raster(ext=extent(-1.95214, -1.69421, 55.60090,
> 55.72476), crs="+proj=longlat +ellps=WGS84 +datum=WGS84", ncol=50, nrow=50)
> 
> I also have two data frames with point locations (of the species Brent
> Goose) similar to these two:
> 
> df1 <- data.frame(long=rnorm(100, -1.76901, 0.05),
>                  lat=rnorm(100, 55.62953, 0.05))
> coordinates(df1) <- c('long', 'lat')
> proj4string(df1) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84?)
> 
> df2 <- data.frame(long=rnorm(100, -1.90490, 0.05),
>                  lat=rnorm(100, 55.69847, 0.05))
> coordinates(df2) <- c('long', 'lat')
> proj4string(df2) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
> 
> I have assigned TRUE to raster cells which contain a point as follows:
> 
> raster1[cellFromXY(raster1, df1)] <- TRUE
> raster2[cellFromXY(raster2, df2)] <- TRUE
> 
> For any cells that are NA in raster1, I need to assign them to TRUE if the
> following condition is met: a TRUE raster2 cell in within 3km of a TRUE
> raster1 cell.
> 
> Is this possible? Let me know if my question is unclear.
> 
> Ross
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest/index_EN


From alban.thomas.fr at gmail.com  Wed Mar 20 11:52:05 2013
From: alban.thomas.fr at gmail.com (alban thomas)
Date: Wed, 20 Mar 2013 11:52:05 +0100
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
	<CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>
	<1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
Message-ID: <CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/648b0462/attachment.pl>

From David.Stephens at cefas.co.uk  Wed Mar 20 15:04:08 2013
From: David.Stephens at cefas.co.uk (David Stephens (Cefas))
Date: Wed, 20 Mar 2013 14:04:08 -0000
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com><CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com><1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
	<CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>
Message-ID: <04A370231C10664C88B28D1EF74F487903E92C10@LOWEXPRESS.corp.cefas.co.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/63aa2ddc/attachment.pl>

From alexander.brenning at uwaterloo.ca  Wed Mar 20 15:13:23 2013
From: alexander.brenning at uwaterloo.ca (Alexander Brenning)
Date: Wed, 20 Mar 2013 14:13:23 +0000
Subject: [R-sig-Geo] RSAGA catchment area (flow tracing) with AsterGDEM
In-Reply-To: <7751194102F32C41B664258D78FE5BC53C8C6862@connmbx5>
References: <7751194102F32C41B664258D78FE5BC53C8C6862@connmbx5>
Message-ID: <7751194102F32C41B664258D78FE5BC53C8C69B1@connmbx5>

Hi Oscar,

it works on my computer with argument name ELEVATION instead of DEM as shown in the SAGA GIS usage information.

library(RSAGA)
setwd("C:/TEMP")
workenv = rsaga.env()
rsaga.geoprocessor(lib="ta_hydrology",module=2,env=workenv,param=list(ELEVATION="dem.sgrd",CAREA="dem_catchmentarea",CSLOPE="dem_catchmentslope",STEP=1,Method=0,MINDQV=0.0,CORRECT=FALSE))

Always check rsaga.get.usage when having trouble using SAGA GIS arguments:

rsaga.get.usage("ta_hydrology",2)

Cheers
  Alex



Date: Tue, 19 Mar 2013 14:39:18 +0100
From: Rainer Hurling <rhurlin at gwdg.de>
To: "N. Anselm" <n.anselm at fu-berlin.de>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] RSAGA catchment area (flow tracing) with
        AsterGDEM
Message-ID: <51486A86.9050106 at gwdg.de>
Content-Type: text/plain; charset=ISO-8859-1

Am 19.03.2013 12:14 (UTC+1) schrieb N. Anselm:
> dear list,
>
> I use R for scripting in saga gis. Mostly it works fine, but I dont know
> why the catchment area (flow tracing) does not work with the ASTER
> scene. In saga it works,
> so it should be something in my 'code'. I tried METHOD as well as Method
> (there seems to be inconsistency in saga), I tried CORRECT=FALSE,False,0
> and not,
> none of it worked, possibly it's something completely different.
>
> Maybe someone of you can give advice?
> thank you very much,
>
> n. anselm
>
>
> workenv<-rsaga.env(workspace=".",path="/usr/bin",modules="/usr/lib/saga")
>
> rsaga.geoprocessor(lib="ta_hydrology",module=2,env=workenv,param=list(DEM="aster_nosink.sgrd",CAREA="aster_catchmentarea",CSLOPE="aster_catchmentslope",STEP=1,Method=0,MINDQV=0.0,CORRECT=FALSE))

Hmm, it seems that your DEM= should be changed into ELEVATION=

But I may be wrong because I am working with the upcoming version 2.1.0
on FreeBSD with R-devel and RSAGA-0.93-2.

HTH,
Rainer


>> sessionInfo()
> R version 2.14.1 (2011-12-22)
> Platform: i686-pc-linux-gnu (32-bit)
>
> locale:
>  [1] LC_CTYPE=de_DE.UTF-8          LC_NUMERIC=C
>  [3] LC_TIME=de_DE.UTF-8           LC_COLLATE=de_DE.UTF-8
>  [5] LC_MONETARY=de_DE.UTF-8       LC_MESSAGES=de_DE.UTF-8
>  [7] LC_PAPER=de_DE.UTF-8          LC_NAME=de_DE.UTF-8
>  [9] LC_ADDRESS=de_DE.UTF-8        LC_TELEPHONE=de_DE.UTF-8
> [11] LC_MEASUREMENT=de_DE.UTF-8    LC_IDENTIFICATION=de_DE.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.0-41  RSAGA_0.93-2   plyr_1.8       shapefiles_0.7
> foreign_0.8-48
> [6] gstat_1.0-16   sp_1.0-5       rkward_0.5.6
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.1      intervals_0.13.3 lattice_0.20-0   spacetime_1.0-4
> [5] tools_2.14.1     xts_0.9-3        zoo_1.7-9

--
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
UW: https://uwaterloo.ca/gem/people-profiles/alexander-brenning
Academia.edu: http://uwaterloo.academia.edu/AlexanderBrenning
LinkedIn: http://ca.linkedin.com/pub/alexander-brenning/3/242/440


From l.hilger at ku.de  Wed Mar 20 16:19:39 2013
From: l.hilger at ku.de (Ludwig Hilger)
Date: Wed, 20 Mar 2013 08:19:39 -0700 (PDT)
Subject: [R-sig-Geo] RSAGA and a custom module
Message-ID: <1363792779572-7583108.post@n2.nabble.com>

Dear list,

A colleague of mine has written a SAGA module doing a Cut/Fill calculation
(which works fine from SAGA GUI) and I want to use it from within R. I have
copied the *.dll of the module to the modules folder of SAGA. I successfully
connect to SAGA but then I cannot find the module (i.e. using
rsaga.get.modules() or rsaga.get.libraries()). Is there a way to use
self-made modules with RSAGA? This is SAGA 2.0.6.

Thanks a lot in advance,

Ludwig

sessionInfo():
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
LC_TIME=German_Germany.1252    

attached base packages:
[1] grDevices datasets  splines   graphics  stats     tcltk     utils    
methods   base     

other attached packages:
 [1] RSAGA_0.93-2     plyr_1.7.1       shapefiles_0.6   foreign_0.8-52  
gstat_1.0-14     spacetime_0.8-0  xts_0.8-8        zoo_1.7-9        sp_1.0-5        
svSocket_0.9-53  TinnR_1.0-5      R2HTML_2.2      
[13] Hmisc_3.9-3      survival_2.36-14

loaded via a namespace (and not attached):
[1] cluster_1.14.3  grid_2.15.2     lattice_0.20-10 svMisc_0.9-65  
tools_2.15.2




-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RSAGA-and-a-custom-module-tp7583108.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alessandrosamuel at yahoo.com.br  Wed Mar 20 19:38:09 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Wed, 20 Mar 2013 11:38:09 -0700 (PDT)
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <04A370231C10664C88B28D1EF74F487903E92C10@LOWEXPRESS.corp.cefas.co.uk>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com><CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com><1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
	<CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>
	<04A370231C10664C88B28D1EF74F487903E92C10@LOWEXPRESS.corp.cefas.co.uk>
Message-ID: <1363804689.45528.YahooMailNeo@web141404.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/65cd6337/attachment.pl>

From frtorrie at unina.it  Wed Mar 20 22:31:51 2013
From: frtorrie at unina.it (frtorrie at unina.it)
Date: Wed, 20 Mar 2013 22:31:51 +0100
Subject: [R-sig-Geo] (no subject)
Message-ID: <20130320223151.16271c1vue7w29xj@inbox.unina.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/cea498b9/attachment.pl>

From mspinola10 at gmail.com  Wed Mar 20 22:55:49 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Wed, 20 Mar 2013 15:55:49 -0600
Subject: [R-sig-Geo] Error message in adehabitatHR
Message-ID: <CABkCotTMgWWbd3s_gAZtdknrensWE=GADr-VMP_-p3kmSVH=zw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130320/86ad34a0/attachment.pl>

From grothered at gmail.com  Thu Mar 21 02:48:30 2013
From: grothered at gmail.com (Gareth Davies)
Date: Thu, 21 Mar 2013 12:48:30 +1100
Subject: [R-sig-Geo] plotRGB and graphical parameters
Message-ID: <514A66EE.6080600@gmail.com>

Hi Hannah,
One work-around is to avoid plotting the axes at first, and then add 
them later.
Because plotRGB takes up the margins of the graphics device, you have to 
explicitly add in margins to get this to work

Example:

###
library(raster)
b <- brick(system.file("external/rlogo.grd", package="raster"))
par(oma=c(3,3,3,3)) # Add margins
plotRGB(b, 3, 2, 1,axes=F,main="test")
axis(side=1,cex.axis=2)
axis(side=2,las=0,cex.axis=2)
###

In my experience, forcing the axis parameters in the axis function will 
work.


Cheers,
G.


From edzer.pebesma at uni-muenster.de  Thu Mar 21 09:29:34 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 21 Mar 2013 09:29:34 +0100
Subject: [R-sig-Geo] Error message in adehabitatHR
In-Reply-To: <CABkCotTMgWWbd3s_gAZtdknrensWE=GADr-VMP_-p3kmSVH=zw@mail.gmail.com>
References: <CABkCotTMgWWbd3s_gAZtdknrensWE=GADr-VMP_-p3kmSVH=zw@mail.gmail.com>
Message-ID: <514AC4EE.4060703@uni-muenster.de>



On 03/20/2013 10:55 PM, Manuel Sp?nola wrote:
> Dear list members, sorry for cross posting but I didn?t get a solution from
> the R-sig-ecology,
> 
> When working with adehabitatHR after fitting a kernel I got the following
> erro message that I don?'t understand:
> 
>> kud <- kernelUD(analisisUtm[,5], h="href")
>> kud
> ********** Utilization distribution of several Animals ************
> 
> Type: probability density
> Smoothing parameter estimated with a  href smoothing parameter
> This object is a list with one component per animal.
> Each component is an object of class estUD
> See estUD-class for more information
> 
>> class(kud)
> [1] "estUDm"
>>
>> ver <- getverticeshr(kud, percent=95)
> Error: identicalCRS(x, y) is not TRUE

because of a change in sp and in R, adehabitatHR had to change from
using the deprecated overlay() to using over(), and this led to a change
in getverticeshr(). In contrast to overlay(), over() checks that both
its arguments have identical CRS, which was not the case here.

@Clement: I guess that in getverticeshr.r, line 42, the
SpatialPolygons() call needs to pass on the CRS as second argument named
"proj4string". You might want to check the other occasions of changes
from overlay() into over().

> 
> 
> Best,
> 
> Manuel
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mauricio.zambrano at jrc.ec.europa.eu  Thu Mar 21 11:20:31 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 21 Mar 2013 11:20:31 +0100
Subject: [R-sig-Geo] raster directions to vectorial lines (Stream to Feature)
Message-ID: <514ADEEF.8000106@jrc.ec.europa.eu>

Dear List,

I have a raster file representing flow directions, and I would like to 
know if is there any function for transforming this raster file into a 
vectorial representation (with lines)

The original raster only has 9 possible values:

1: 225 deg (South-West)
2: 270 deg (South)
3: 315 deg (South-East)
4: 180 deg (West)
5: NA (no flow)
6:   0 deg (East)
7: 135 deg (North-West)
8:  90 deg (North)
9:  45 deg (North-East)

I can use the function 'reclassify' provided by the raster package to 
re-class the 9 values into the corresponding decimal degrees.
However, I don't know how to create a line from each cell centre to the 
next cell, following the direction stored in each cell.

My colleagues do this with the 'Stream to Feature' tool of Spatial 
Analyst (ArcGis 10.0, 
http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//009z00000058000000.htm), 
but I would like to do it in R.

I would highly appreciate any ideas about how to carry out this task in R.

Thanks in advance,

Mauricio Zambrano-Bigiarini
-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:10}}


From alexander.brenning at uwaterloo.ca  Thu Mar 21 14:19:07 2013
From: alexander.brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 21 Mar 2013 13:19:07 +0000
Subject: [R-sig-Geo] RSAGA and a custom module
Message-ID: <7751194102F32C41B664258D78FE5BC53C8C8072@connmbx5>

Hi Ludwig,

RSAGA functions - including rsaga.get.usage and rsaga.get.modules - use the saga_cmd command line interface to access modules. So if saga_cmd was able to see your module, so should RSAGA. Is it possible that your module isn't fully integrated into saga_cmd? If that's the case, you may want to discuss this issue in one of the forums on the SAGA GIS sourceforge project website
http://sourceforge.net/projects/saga-gis/

On the other hand, rsaga.get.libraries actually just lists the names of all .dll files located in the (default or specified) modules folder. So if your library is not included in that list, maybe your folder settings are incorrect? Most RSAGA functions take an 'env' argument, which is a list that is populated through a call to rsaga.env(); you may specify a 'modules' path in the rsaga.env call. Similarly, rsaga.get.libraries takes an optional 'path' argument that specifies where to search for libraries.

I hope this helps
  Alex


Date: Wed, 20 Mar 2013 08:19:39 -0700 (PDT)
From: Ludwig Hilger <l.hilger at ku.de>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] RSAGA and a custom module
Message-ID: <1363792779572-7583108.post at n2.nabble.com>
Content-Type: text/plain; charset=UTF-8

Dear list,

A colleague of mine has written a SAGA module doing a Cut/Fill calculation
(which works fine from SAGA GUI) and I want to use it from within R. I have
copied the *.dll of the module to the modules folder of SAGA. I successfully
connect to SAGA but then I cannot find the module (i.e. using
rsaga.get.modules() or rsaga.get.libraries()). Is there a way to use
self-made modules with RSAGA? This is SAGA 2.0.6.

Thanks a lot in advance,

Ludwig

sessionInfo():
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252
LC_MONETARY=German_Germany.1252 LC_NUMERIC=C
LC_TIME=German_Germany.1252

attached base packages:
[1] grDevices datasets  splines   graphics  stats     tcltk     utils
methods   base

other attached packages:
 [1] RSAGA_0.93-2     plyr_1.7.1       shapefiles_0.6   foreign_0.8-52
gstat_1.0-14     spacetime_0.8-0  xts_0.8-8        zoo_1.7-9        sp_1.0-5
svSocket_0.9-53  TinnR_1.0-5      R2HTML_2.2
[13] Hmisc_3.9-3      survival_2.36-14

loaded via a namespace (and not attached):
[1] cluster_1.14.3  grid_2.15.2     lattice_0.20-10 svMisc_0.9-65
tools_2.15.2




-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RSAGA-and-a-custom-module-tp7583108.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


--
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
UW: https://uwaterloo.ca/gem/people-profiles/alexander-brenning
Academia.edu: http://uwaterloo.academia.edu/AlexanderBrenning
LinkedIn: http://ca.linkedin.com/pub/alexander-brenning/3/242/440


From pgalpern at gmail.com  Thu Mar 21 15:00:15 2013
From: pgalpern at gmail.com (Paul Galpern)
Date: Thu, 21 Mar 2013 09:00:15 -0500
Subject: [R-sig-Geo] Expected behaviour of over() at polygon corners (sp
	package)
Message-ID: <514B126F.8030206@gmail.com>

Dear R-sig-geo:

I am not sure whether the following is the intended behaviour of 
sp::over() in this situation.  When a point falls on the mutual corner 
of three square polygons over() returns NA.  One of these polygons 
contains a hole in which the other two are embedded.

The following toy example uses SpatialPolygons derived from a raster 
created with raster::rasterToPolygons(..., dissolve=TRUE) as this is the 
process I am using to create the polygons, and the result I am getting 
may be an artefact of this.

## Create example raster
library(raster)
rasCells <- matrix(c(1, 1, 2, 2, 1, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1), 4, 4)
ras <- raster(rasCells)
## Convert to SpatialPolygons
rasPoly <- rasterToPolygons(ras, dissolve=TRUE)

## Spatial overlay
## over() returns NA
pt <- cbind(0.5, 0.5)
over(SpatialPoints(pt), rasPoly)

## The offending point falls at the mutual corner of three polygons
plot(ras)
points(pt)

I recognize that there are other ways around this.  Using 
raster::extract() is equivalent, and I can jitter the point, for 
example.  But wondering what the intended behaviour of over() is, here.

Thanks--as always--to the creators of these fine tools,
Paul

-- 
Paul Galpern
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From omphalodes.verna at yahoo.com  Thu Mar 21 18:03:50 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Thu, 21 Mar 2013 10:03:50 -0700 (PDT)
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
	raster)
Message-ID: <1363885430.43330.YahooMailNeo@web164902.mail.bf1.yahoo.com>

Dear list.

I am asking for advice for getting verticale profile of DEM along line object. I konw, it is easy for one straight line (distance and extract functions) also with using a combination of GRASS and R ( http://casoilresource.lawr.ucdavis.edu/drupal/node/375 ). Is in R possible to do this.

Thanks to all. OV

Here is a sample code:

library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")


From matteo.mattiuzzi at boku.ac.at  Thu Mar 21 19:52:08 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Thu, 21 Mar 2013 19:52:08 +0100
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
 raster)
Message-ID: <514B64E80200002700018F6B@gwia2.boku.ac.at>

Dear Omphalodes,


library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")


S1<-SpatialLines(list(S1)) # I'm not practic in sp, but this at least works!
extract(r,S1)



Matteo

>>> Omphalodes Verna  03/21/13 6:06 PM >>>
Dear list.

I am asking for advice for getting verticale profile of DEM along line object. I konw, it is easy for one straight line (distance and extract functions) also with using a combination of GRASS and R ( http://casoilresource.lawr.ucdavis.edu/drupal/node/375 ). Is in R possible to do this.

Thanks to all. OV

Here is a sample code:

library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pharriso at uwaterloo.ca  Thu Mar 21 20:45:59 2013
From: pharriso at uwaterloo.ca (Philip Harrison)
Date: Thu, 21 Mar 2013 15:45:59 -0400
Subject: [R-sig-Geo] adehabitatHR kernalBB batch processing
Message-ID: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>

Hi

I am attempting to use the kernalBB function from adehabitatHR. Now it  
works just fine with just one fish, however I have quite a number of  
fish and would like to run the analysis on all the fish in one  
go-while maintaining individual sig 1 estimates. See below for example  
coding...

library(adehabitatHR)
library(adehabitatLT)
data(puechabonsp)

loc$DT <-as.POSIXct(strptime(loc$Date, format='%y%m%d' ))
ltraj <- as.ltraj(coordinates(loc), loc$DT, id = loc$Name, burst = loc$Name,
+ typeII = TRUE)

sig255<-liker(ltraj, sig2 = 255, rangesig1 = c(0, 1000))

*****************************************

Maximization of the log-likelihood for parameter
sig1 of brownian bridge

Brock : Sig1 = 2.002 Sig2 = 255
Calou : Sig1 = 0 Sig2 = 255
Chou : Sig1 = 1.001 Sig2 = 255
Jean : Sig1 = 2.002 Sig2 = 255

##so now I would like to run the kernalBB on all 4 fish individually.
##so i tried...

> tataall <- kernelbb(ltraj, sig1 = sig255, sig2 = 255, grid = 100,byburst=T)

#Error in sig1^2 : non-numeric argument to binary operator

##I dont have a great deal of experience working with list formats-  
can anyone ##assist me in calling the relevent sig 1 for each fish?



#now if I know I can used a fixed sig 1 for all fine ie
> tataall <- kernelbb(ltraj, sig1 = 1, sig2 = 255, grid = 100,byburst=T)


##I am sure it is something stupid and easy....

##I see that when you do a similar thing for the D function in the BRB  
function it seems to work fine  (I assume that this is using differing  
D levels for each fish..)

vv2<- BRB.likD(ltraj, Dr=c(1,50000), Tmax = 5*(24*60*60) + 1, Lmin = 0.1)
testud <-BRB(ltraj, D =vv2, Tmax =5*(24*60*60) + 1, Lmin =0.1, hmin = 100)


finally, I notice that we get some zero sig 1 values both in my  
dataset and in the example of Calou. Is this an issue?

Thanks for any help

Phil H.

p.s. im running
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)
adehabitatHR_0.4.2 adehabitatLT_0.3.6


From j.m.signer at gmail.com  Thu Mar 21 23:13:34 2013
From: j.m.signer at gmail.com (Johannes Signer)
Date: Thu, 21 Mar 2013 23:13:34 +0100
Subject: [R-sig-Geo] adehabitatHR kernalBB batch processing
In-Reply-To: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
References: <20130321154559.10262297vrmgbatc@www.nexusmail.uwaterloo.ca>
Message-ID: <CAC8qavtwv052W_azSUaHJFFE8NDyxAZraOUfe5Zyo8tdBdddyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130321/fae96338/attachment.pl>

From spluque at gmail.com  Fri Mar 22 00:05:18 2013
From: spluque at gmail.com (Sebastian P. Luque)
Date: Thu, 21 Mar 2013 18:05:18 -0500
Subject: [R-sig-Geo] xlim in SpatialPoints plot method
Message-ID: <87li9gfj69.fsf@kolob.subpolar.dyndns.org>

Hi,

It seems as if xlim is interpreted strangely with SpatialPoints:

example("SpatialPoints-class", ask=FALSE)
plot(S, xlim=c(0, 5), axes=TRUE)
plot(S, xlim=c(0, 6), axes=TRUE)
plot(S, xlim=c(0, 7), axes=TRUE)
plot(S, xlim=c(3, 5), axes=TRUE)
# But ylim makes sense:
plot(S, ylim=c(0, 5), axes=TRUE)
plot(S, ylim=c(0, 3), axes=TRUE)
plot(S, ylim=c(1, 4), axes=TRUE)

R> sessionInfo()
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_1.0-6            slmisc_1.0          latticeExtra_0.6-24 RColorBrewer_1.0-5  lattice_0.20-14    

loaded via a namespace (and not attached):
[1] compiler_2.15.3 grid_2.15.3     tools_2.15.3   


What is going on?

Cheers,

-- 
Seb


From mdsumner at gmail.com  Fri Mar 22 00:46:22 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 22 Mar 2013 10:46:22 +1100
Subject: [R-sig-Geo] xlim in SpatialPoints plot method
In-Reply-To: <87li9gfj69.fsf@kolob.subpolar.dyndns.org>
References: <87li9gfj69.fsf@kolob.subpolar.dyndns.org>
Message-ID: <CAAcGz9-_rubaOb20Vis+OOVYTX0fc_uVEcymywcK0zCeFjirFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130322/aa0a56f9/attachment.pl>

From spluque at gmail.com  Fri Mar 22 03:24:38 2013
From: spluque at gmail.com (Sebastian P. Luque)
Date: Thu, 21 Mar 2013 21:24:38 -0500
Subject: [R-sig-Geo] xlim in SpatialPoints plot method
In-Reply-To: <CAAcGz9-_rubaOb20Vis+OOVYTX0fc_uVEcymywcK0zCeFjirFQ@mail.gmail.com>
	(Michael Sumner's message of "Fri, 22 Mar 2013 10:46:22 +1100")
References: <87li9gfj69.fsf@kolob.subpolar.dyndns.org>
	<CAAcGz9-_rubaOb20Vis+OOVYTX0fc_uVEcymywcK0zCeFjirFQ@mail.gmail.com>
Message-ID: <87d2usf9y1.fsf@kolob.subpolar.dyndns.org>

On Fri, 22 Mar 2013 10:46:22 +1100,
Michael Sumner <mdsumner at gmail.com> wrote:

> I think it's the aspect ratio, which the Spatial plot method controls
> more heavily than plot.default.

> Does plot(S, xlim=c(3, 5), axes=TRUE, asp = 0) give what you were
> after?

Yes, thanks!

-- 
Seb


From gavan.mcgrath at uwa.edu.au  Fri Mar 22 05:31:14 2013
From: gavan.mcgrath at uwa.edu.au (Gavan McGrath)
Date: Fri, 22 Mar 2013 12:31:14 +0800
Subject: [R-sig-Geo] raster directions to vectorial lines (Stream to
	Feature)
Message-ID: <F9CC8F918F2B7B458329EC1DF9D15B7704FCDE0653@ITS-WIN-063.staffad.uwa.edu.au>

Hi Mauricio,

Below is a simple pair of functions for plotting a flow network over an image which should achieve what you were after.  You may want to play around with how your flow direction numbers 1 -9 match up with those in the lookupfidr function. Its a bit cluncky but gets the job done.

The function fdirPlot takes as input a matrix imData the background image, and a matrix fdirs of flow direction integers.

Good luck.


lookupfdir <-function(fdir) {
   switch(paste(fdir,"",sep=""),
       '1' = c(-1,-1),
       '2' = c(-1,0),
       '3' = c(-1,1),
       '4' = c(0,1),
       '5' = c(1,1),
       '6' = c(1,0),
       '7' = c(1,-1),
       '8' = c(0,-1),
       '9' = c(0,0),
           c(-2,-2)
   )
}

fdirPlot <- function(imData,fdirs) {
  dimDat<- dim(imData)
  image(imData,axes=FALSE)
  for (i in 1:dimDat[1]) {
  for (j in 1:dimDat[2]) {
  dxdy <- lookupfdir(fdirs[i,j])
  if (dxdy[1] != -2) {
   lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-dxdy[1]-0.5,j-dxdy[2]-0.5)/dimDat[1]))
   } else {
          if (i==1) {
            lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-1.5,j-0.5)/dimDat[1]))
          } else {
                if (i==dimDat[1]) {
                    lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i+1-0.5,j-0.5)/dimDat[1]))
                 } else {
                        if (j==1) { 
                          lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-0.5,j-1-0.5)/dimDat[1]))
                        } else {
                               if (j==dimDat[2]) {
		                 lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-0.5,j+1-0.5)/dimDat[1]))
                               }
                          }
                     }
             }
      }
  }
  }
}

Gavan McGrath


From clement.calenge at oncfs.gouv.fr  Fri Mar 22 09:00:11 2013
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Fri, 22 Mar 2013 09:00:11 +0100
Subject: [R-sig-Geo] Error message in adehabitatHR
In-Reply-To: <514AC4EE.4060703@uni-muenster.de>
References: <CABkCotTMgWWbd3s_gAZtdknrensWE=GADr-VMP_-p3kmSVH=zw@mail.gmail.com>
	<514AC4EE.4060703@uni-muenster.de>
Message-ID: <514C0F8B.7000106@oncfs.gouv.fr>

On 03/21/2013 09:29 AM, Edzer Pebesma wrote:
> On 03/20/2013 10:55 PM, Manuel Sp?nola wrote:
>> Dear list members, sorry for cross posting but I didn?t get a solution from
>> the R-sig-ecology,
>>
>> When working with adehabitatHR after fitting a kernel I got the following
>> erro message that I don?'t understand:
>>
>>> kud <- kernelUD(analisisUtm[,5], h="href")
>>> kud
>> ********** Utilization distribution of several Animals ************
>>
>> Type: probability density
>> Smoothing parameter estimated with a  href smoothing parameter
>> This object is a list with one component per animal.
>> Each component is an object of class estUD
>> See estUD-class for more information
>>
>>> class(kud)
>> [1] "estUDm"
>>> ver <- getverticeshr(kud, percent=95)
>> Error: identicalCRS(x, y) is not TRUE
> because of a change in sp and in R, adehabitatHR had to change from
> using the deprecated overlay() to using over(), and this led to a change
> in getverticeshr(). In contrast to overlay(), over() checks that both
> its arguments have identical CRS, which was not the case here.
>
> @Clement: I guess that in getverticeshr.r, line 42, the
> SpatialPolygons() call needs to pass on the CRS as second argument named
> "proj4string". You might want to check the other occasions of changes
> from overlay() into over().

Oops? I overlooked this aspect when changing overlay() for over(). I 
will correct these bugs today.
Sorry for the bugs,
Best,

Cl?ment Calenge





>
>>
>> Best,
>>
>> Manuel
>>
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From l.hilger at ku.de  Fri Mar 22 09:23:57 2013
From: l.hilger at ku.de (Ludwig Hilger)
Date: Fri, 22 Mar 2013 01:23:57 -0700 (PDT)
Subject: [R-sig-Geo] RSAGA and a custom module
In-Reply-To: <7751194102F32C41B664258D78FE5BC53C8C8072@connmbx5>
References: <1363792779572-7583108.post@n2.nabble.com>
	<7751194102F32C41B664258D78FE5BC53C8C8072@connmbx5>
Message-ID: <1363940637782-7583126.post@n2.nabble.com>

Der Mr. Brenning,

thank you for the fast reply! Yes, when specifiying the path attributes, I
can find the module. This brings me to a reated issue. I have three SAGA
versions on the computer (because of I do not know how to compile the custom
module for 64 bit). If I connect to 2.0.8 32 bit by:

rsaga.env(path = "C:/Program Files (x86)/SAGA-GIS_2.0.8_32bit", modules =
"C:/Program Files (x86)/SAGA-GIS_2.0.8_32bit/modules")

I get the correct response, but R does not seem to store this connection, if
I enter rsaga.env() in the next line I get the connection to my SAGA 2.1.0
64 bit. As I result, I need to specify the env parameter in every call to
rsaga.geprocessor() if I want to use the 2.0.8 32 bit version (from which
the module was compiled). It is not a great problem, but do you know why
that could be?

Once again, thank you very much!
Ludwig



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RSAGA-and-a-custom-module-tp7583108p7583126.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alexander.brenning at uwaterloo.ca  Fri Mar 22 14:33:58 2013
From: alexander.brenning at uwaterloo.ca (Alexander Brenning)
Date: Fri, 22 Mar 2013 13:33:58 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 115, Issue 22
In-Reply-To: <mailman.11.1363950004.2536.r-sig-geo@r-project.org>
References: <mailman.11.1363950004.2536.r-sig-geo@r-project.org>
Message-ID: <7751194102F32C41B664258D78FE5BC53C8C88B5@connmbx5>

Hi Ludwig,

rsaga.env doesn't save anything in a global variable like the R function options does; it simply creates a list with verified settings. See e.g. Example code in the rsaga.env help file.

Here an example for Windows, using your folder name:

library(RSAGA)

# SAGA GIS binaries in C:/Pr....._32bit,
# modules by default in the 'modules' subfolder of 'path':
myenv <- rsaga.env(path = "C:/Program Files (x86)/SAGA-GIS_2.0.8_32bit")
myenv # have a look at the contents

# now call a modules using these customized RSAGA settings:
# note the env = myenv argument:
rsaga.hillshade("dem","hillshade",env=myenv)
# 'dem.sgrd' must be in myenv$workspace, SAGA GIS in myenv$path, etc.

I hope this helps
  Alex

Date: Fri, 22 Mar 2013 01:23:57 -0700 (PDT)
From: Ludwig Hilger <l.hilger at ku.de>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] RSAGA and a custom module
Message-ID: <1363940637782-7583126.post at n2.nabble.com>
Content-Type: text/plain; charset=UTF-8

Der Mr. Brenning,

thank you for the fast reply! Yes, when specifiying the path attributes, I
can find the module. This brings me to a reated issue. I have three SAGA
versions on the computer (because of I do not know how to compile the custom
module for 64 bit). If I connect to 2.0.8 32 bit by:

rsaga.env(path = "C:/Program Files (x86)/SAGA-GIS_2.0.8_32bit", modules =
"C:/Program Files (x86)/SAGA-GIS_2.0.8_32bit/modules")

I get the correct response, but R does not seem to store this connection, if
I enter rsaga.env() in the next line I get the connection to my SAGA 2.1.0
64 bit. As I result, I need to specify the env parameter in every call to
rsaga.geprocessor() if I want to use the 2.0.8 32 bit version (from which
the module was compiled). It is not a great problem, but do you know why
that could be?

Once again, thank you very much!
Ludwig



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RSAGA-and-a-custom-module-tp7583108p7583126.html
Sent from the R-sig-geo mailing list archive at Nabble.com.




--
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
UW: https://uwaterloo.ca/gem/people-profiles/alexander-brenning
Academia.edu: http://uwaterloo.academia.edu/AlexanderBrenning
LinkedIn: http://ca.linkedin.com/pub/alexander-brenning/3/242/440


From amock at gmx.li  Fri Mar 22 15:17:04 2013
From: amock at gmx.li (amock at gmx.li)
Date: Fri, 22 Mar 2013 15:17:04 +0100 (CET)
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
Message-ID: <trinity-2664a0ac-c40a-4963-bf0a-6038394a130b-1363961824378@3capp-gmx-bs29>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130322/3f92b9d6/attachment.html>

From amock at gmx.li  Fri Mar 22 15:20:14 2013
From: amock at gmx.li (Philipp Reiter)
Date: Fri, 22 Mar 2013 15:20:14 +0100 (CET)
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
Message-ID: <trinity-b88c43e8-cc02-4276-8f63-36daa4966560-1363962014740@3capp-gmx-bs29>

Hey there,

I?ve got a problem concerning exporting a raster*-Object as nc-File:
When exporting rasterLayers or rasterBricks as nc-Files with writeRaster from the raster-Package, easting and northing in the resulting nc-File are switched, which results in a rotated plot. I can correct this afterwards, but it should be possible to be correct right away?!

Example code for a rasterLayer:
tmp <- raster(readGDAL(?example.asc?,p4s="+init=epsg:31467"))
writeRaster(tmp, filename=?export.nc?, format="CDF", overwrite=TRUE)
nc <- open.ncdf("export.nc")
x <- get.var.ncdf(nc,?easting?)
y <- get.var.ncdf(nc,?northing?)

R version 2.15.3 (2013-03-01)
Platform: x86_64-w64-mingw32/x64 (64-bit)
ncdf_1.6.6    raster_2.1-16 rgdal_0.8-5   sp_1.0-6


I hope someone can give me a hint! Thanks in advance!
Philipp


From kridox at ymail.com  Fri Mar 22 15:48:11 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Fri, 22 Mar 2013 23:48:11 +0900
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
In-Reply-To: <trinity-b88c43e8-cc02-4276-8f63-36daa4966560-1363962014740@3capp-gmx-bs29>
References: <trinity-b88c43e8-cc02-4276-8f63-36daa4966560-1363962014740@3capp-gmx-bs29>
Message-ID: <514C6F2B.1040603@ymail.com>

Hi,

What are the dimension of 'example.asc'? Generally, in netCDF file, the 
first dimension is longitude, second is latitude.

Regards,
Pascal

Le 13/03/22 23:20, Philipp Reiter a ?crit :
> Hey there,
>
> I?ve got a problem concerning exporting a raster*-Object as nc-File:
> When exporting rasterLayers or rasterBricks as nc-Files with writeRaster from the raster-Package, easting and northing in the resulting nc-File are switched, which results in a rotated plot. I can correct this afterwards, but it should be possible to be correct right away?!
>
> Example code for a rasterLayer:
> tmp <- raster(readGDAL(?example.asc?,p4s="+init=epsg:31467"))
> writeRaster(tmp, filename=?export.nc?, format="CDF", overwrite=TRUE)
> nc <- open.ncdf("export.nc")
> x <- get.var.ncdf(nc,?easting?)
> y <- get.var.ncdf(nc,?northing?)
>
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> ncdf_1.6.6    raster_2.1-16 rgdal_0.8-5   sp_1.0-6
>
>
> I hope someone can give me a hint! Thanks in advance!
> Philipp
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Fri Mar 22 16:24:50 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 22 Mar 2013 08:24:50 -0700
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
In-Reply-To: <trinity-2664a0ac-c40a-4963-bf0a-6038394a130b-1363961824378@3capp-gmx-bs29>
References: <trinity-2664a0ac-c40a-4963-bf0a-6038394a130b-1363961824378@3capp-gmx-bs29>
Message-ID: <CANtt_hxpRP2KQJp_OKoTgenDaMfEuCopRVYzncg4qj=E5B=NyQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130322/349a4497/attachment.pl>

From smithtiffanyt at gmail.com  Fri Mar 22 18:13:10 2013
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Fri, 22 Mar 2013 13:13:10 -0400
Subject: [R-sig-Geo] Aggregate using Shapefile
Message-ID: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>

Hi all,

I'm looking to use a shapefile to aggregate a raster layer. Here's what I have so far:

indexAL<-raster("myfile.nc")
ALshp<-readShapePoly("ALzipcodes.shp")
ALrst<-rasterize(ALshp,indexAL,fun=mean)

"indexAL" has a finer resolution than "ALrst", and I'd like to aggregate "indexAL" up to the scale of "ALrst" in a way that I'm able to create a map in the end. I've used "extract", but am not sure then how to map that output. "aggregate" doesn't seem flexible enough to use a shapefile (or raster layer). Any suggestions?

Thanks,
Tiffany 


From amock at gmx.li  Mon Mar 25 11:55:03 2013
From: amock at gmx.li (Philipp Reiter)
Date: Mon, 25 Mar 2013 11:55:03 +0100 (CET)
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
Message-ID: <trinity-fdcbaa34-bf95-49eb-993e-18e5fa2e749b-1364208903085@3capp-gmx-bs22>

Hi Robert and Pascal,
?
thanks for the tips, but my problem isn't completely solved. The explicit laebling of x and y works, but doesn't change the rotation.
I followed Pascals hint:
My raster*-Object has the dimensons: "220 171 x".
When I export this raster*-Obejct as posted below as nc-file and reimport it with the ncdf-Package, the dimensions are: "171 220 x". The explicit labeling doesn't change that. The first dimension is always 171 in the nc-file, no matter if its names 'easting' or 'northing'. To me it looks like raster and ncdf interpret x and y differently?!
?
Beste regards
Philipp
?
?
Philipp,

You are right, the labels easting and northing are reversed. I will fix
that. You can set them yourself as illustrated below:

library(raster)
tmp<- raster(nr=5, nc=10,crs='+proj=utm +zone=12')
tmp[] <- 1:ncell(tmp)
writeRaster(tmp, filename='export.nc', format="CDF", overwrite=TRUE,
xname='easting', yname='northing')
raster('export.nc')

nc <- open.ncdf("export.nc")
get.var.ncdf(nc,"easting")

Robert

On Fri, Mar 22, 2013 at 7:17 AM, <amock at gmx.li> wrote:

>
>  Hey there,
> I?ve got a problem concerning exporting a raster*-Object as nc-File:
> When exporting rasterLayers or rasterBricks as nc-Files with writeRaster
> from the raster-Package, easting and northing in the resulting nc-File are
> switched, which results in a rotated plot. I can correct this afterwards,
> but it should be possible to be correct right away?!
>
> Example code for a rasterLayer:
> tmp <- raster(readGDAL(?example.asc?,p4s="+init=epsg:31467"))
> writeRaster(tmp, filename=?export.nc?, format="CDF", overwrite=TRUE)
> nc <- open.ncdf("export.nc")
> x <- get.var.ncdf(nc,?easting?)
> y <- get.var.ncdf(nc,?northing?)
>
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> ncdf_1.6.6    raster_2.1-16 rgdal_0.8-5   sp_1.0-6
>
> I hope someone can give me a hint! Thanks in advance!
> Philipp
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From alban.thomas.fr at gmail.com  Mon Mar 25 12:11:56 2013
From: alban.thomas.fr at gmail.com (alban thomas)
Date: Mon, 25 Mar 2013 12:11:56 +0100
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <1363804689.45528.YahooMailNeo@web141404.mail.bf1.yahoo.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
	<CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>
	<1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
	<CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>
	<04A370231C10664C88B28D1EF74F487903E92C10@LOWEXPRESS.corp.cefas.co.uk>
	<1363804689.45528.YahooMailNeo@web141404.mail.bf1.yahoo.com>
Message-ID: <CAGJgWrUDdGqj9aD7K9E_Vuh4Kd+uvgdkf++9Cadbkao2Y5tKcg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/c114da6d/attachment.pl>

From alessandrosamuel at yahoo.com.br  Mon Mar 25 13:34:52 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Mon, 25 Mar 2013 05:34:52 -0700 (PDT)
Subject: [R-sig-Geo] Correcting missing scan lines in satelite images
In-Reply-To: <CAGJgWrUDdGqj9aD7K9E_Vuh4Kd+uvgdkf++9Cadbkao2Y5tKcg@mail.gmail.com>
References: <1363355963.3239.YahooMailNeo@web141406.mail.bf1.yahoo.com>
	<CANtt_hx6mWN3PAj5OkysPfD2AYCZLXYctU9ypG7wpjSeLMb1jQ@mail.gmail.com>
	<1363718284.31710.YahooMailNeo@web141402.mail.bf1.yahoo.com>
	<CAGJgWrWwDiQSruUUcbS1hLanL4U=8uYZnd3zvZGfdpw_Yn3nAg@mail.gmail.com>
	<04A370231C10664C88B28D1EF74F487903E92C10@LOWEXPRESS.corp.cefas.co.uk>
	<1363804689.45528.YahooMailNeo@web141404.mail.bf1.yahoo.com>
	<CAGJgWrUDdGqj9aD7K9E_Vuh4Kd+uvgdkf++9Cadbkao2Y5tKcg@mail.gmail.com>
Message-ID: <1364214892.94112.YahooMailNeo@web141405.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/55c8e0b9/attachment.pl>

From alessandrosamuel at yahoo.com.br  Mon Mar 25 14:02:53 2013
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Mon, 25 Mar 2013 06:02:53 -0700 (PDT)
Subject: [R-sig-Geo] Custom variogram models in gstat
Message-ID: <1364216573.55561.YahooMailNeo@web141403.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/ead931ab/attachment.pl>

From Yan.Boulanger at RNCan-NRCan.gc.ca  Mon Mar 25 15:45:59 2013
From: Yan.Boulanger at RNCan-NRCan.gc.ca (Boulanger, Yan)
Date: Mon, 25 Mar 2013 14:45:59 +0000
Subject: [R-sig-Geo] Change raster value according to an overlay procedure
Message-ID: <D3557409FD94BA41AE028A1E573716D646FA67D7@S-BSC-MBX2.nrn.nrcan.gc.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/f69f9957/attachment.pl>

From r.hijmans at gmail.com  Mon Mar 25 16:55:50 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 25 Mar 2013 08:55:50 -0700
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
In-Reply-To: <trinity-fdcbaa34-bf95-49eb-993e-18e5fa2e749b-1364208903085@3capp-gmx-bs22>
References: <trinity-fdcbaa34-bf95-49eb-993e-18e5fa2e749b-1364208903085@3capp-gmx-bs22>
Message-ID: <CANtt_hz2Tx3PQS5XiZuakfspoB_YgqsyfdqQAQesaACVw5pOYw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/8bb31871/attachment.pl>

From r.hijmans at gmail.com  Mon Mar 25 17:03:31 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 25 Mar 2013 09:03:31 -0700
Subject: [R-sig-Geo] Change raster value according to an overlay
	procedure
In-Reply-To: <D3557409FD94BA41AE028A1E573716D646FA67D7@S-BSC-MBX2.nrn.nrcan.gc.ca>
References: <D3557409FD94BA41AE028A1E573716D646FA67D7@S-BSC-MBX2.nrn.nrcan.gc.ca>
Message-ID: <CANtt_hzgA4PpM5gc--5MSbCw6VBbMDEvrpm9o3FTRevxE_gRGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/163e853b/attachment.pl>

From r.hijmans at gmail.com  Mon Mar 25 17:07:19 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 25 Mar 2013 09:07:19 -0700
Subject: [R-sig-Geo] Aggregate using Shapefile
In-Reply-To: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>
References: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>
Message-ID: <CANtt_hxQrydHAQWZaZ5Zzj35RHbSDa0o2kschNeAKDhSwL2UjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/48422516/attachment.pl>

From smithtiffanyt at gmail.com  Mon Mar 25 17:32:12 2013
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Mon, 25 Mar 2013 12:32:12 -0400
Subject: [R-sig-Geo] Aggregate using Shapefile
In-Reply-To: <CANtt_hxQrydHAQWZaZ5Zzj35RHbSDa0o2kschNeAKDhSwL2UjQ@mail.gmail.com>
References: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>
	<CANtt_hxQrydHAQWZaZ5Zzj35RHbSDa0o2kschNeAKDhSwL2UjQ@mail.gmail.com>
Message-ID: <7A464E83-FF88-432E-9393-28797A0E5FF9@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/f1fe2fc9/attachment.pl>

From Yan.Boulanger at RNCan-NRCan.gc.ca  Mon Mar 25 18:10:14 2013
From: Yan.Boulanger at RNCan-NRCan.gc.ca (Boulanger, Yan)
Date: Mon, 25 Mar 2013 17:10:14 +0000
Subject: [R-sig-Geo] Change raster value according to an overlay
 procedure
In-Reply-To: <CANtt_hzgA4PpM5gc--5MSbCw6VBbMDEvrpm9o3FTRevxE_gRGw@mail.gmail.com>
References: <D3557409FD94BA41AE028A1E573716D646FA67D7@S-BSC-MBX2.nrn.nrcan.gc.ca>
	<CANtt_hzgA4PpM5gc--5MSbCw6VBbMDEvrpm9o3FTRevxE_gRGw@mail.gmail.com>
Message-ID: <D3557409FD94BA41AE028A1E573716D646FA6853@S-BSC-MBX2.nrn.nrcan.gc.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/1ce8f448/attachment.pl>

From r.hijmans at gmail.com  Mon Mar 25 20:31:12 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 25 Mar 2013 12:31:12 -0700
Subject: [R-sig-Geo] Change raster value according to an overlay
	procedure
In-Reply-To: <D3557409FD94BA41AE028A1E573716D646FA6853@S-BSC-MBX2.nrn.nrcan.gc.ca>
References: <D3557409FD94BA41AE028A1E573716D646FA67D7@S-BSC-MBX2.nrn.nrcan.gc.ca>
	<CANtt_hzgA4PpM5gc--5MSbCw6VBbMDEvrpm9o3FTRevxE_gRGw@mail.gmail.com>
	<D3557409FD94BA41AE028A1E573716D646FA6853@S-BSC-MBX2.nrn.nrcan.gc.ca>
Message-ID: <CANtt_hxfyev5ZJju8kQ7qeMLbgZn8Jjcqj4enUv_1M+KPd+u9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/59eecc14/attachment.pl>

From r.hijmans at gmail.com  Mon Mar 25 20:33:22 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 25 Mar 2013 12:33:22 -0700
Subject: [R-sig-Geo] Aggregate using Shapefile
In-Reply-To: <7A464E83-FF88-432E-9393-28797A0E5FF9@gmail.com>
References: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>
	<CANtt_hxQrydHAQWZaZ5Zzj35RHbSDa0o2kschNeAKDhSwL2UjQ@mail.gmail.com>
	<7A464E83-FF88-432E-9393-28797A0E5FF9@gmail.com>
Message-ID: <CANtt_hxD62-+pLe2=YiNCo+Bk5PRTo8M8KH0MhMU0Hg4z4w30Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130325/cced0e00/attachment.pl>

From thi_veloso at yahoo.com.br  Tue Mar 26 04:16:31 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 25 Mar 2013 20:16:31 -0700 (PDT)
Subject: [R-sig-Geo] Increasing font size in a levelplot graphic
Message-ID: <1364267791.70628.YahooMailNeo@web121902.mail.ne1.yahoo.com>

Dear R-SIGgers,

This question is related to the rasterVis package. Please reproduce the following plot:

library(raster)
library(rasterVis)

r1=r2=r3=raster(nr=100, nc=100)
r1[]<-r2[]<-r3[]<-1:ncell(r1)
s<-stack(r1,r2,r3)
levelplot(s)

On my Mac, I think the text size is too small. Increasing picture dimensions won't work - graph size will increase but text still looks small.

So my question arises: how can I increase axis, scale and title font size in a levelplot graphic? I've skimmed over both rasterVis and lattice documentation and haven't found any clues.


Any help appreciated.

Best regards,
Thiago.


From kridox at ymail.com  Tue Mar 26 04:52:48 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 26 Mar 2013 12:52:48 +0900
Subject: [R-sig-Geo] Increasing font size in a levelplot graphic
In-Reply-To: <1364267791.70628.YahooMailNeo@web121902.mail.ne1.yahoo.com>
References: <1364267791.70628.YahooMailNeo@web121902.mail.ne1.yahoo.com>
Message-ID: <51511B90.50306@ymail.com>

Hi,

For example:

p.strip <- list(cex=1.5, lines=2, fontface='bold')
ckey <- list(labels=list(cex=1.5, col='magenta'), height=0.5)
x.scale <- list(cex=1, alternating=1, col='red')
y.scale <- list(cex=1, alternating=1, col='blue')

levelplot(s, colorkey=ckey, par.strip.text=p.strip, 
scales=list(x=x.scale, y=y.scale))

HTH,
Pascal


On 26/03/13 12:16, Thiago V. dos Santos wrote:
> Dear R-SIGgers,
>
> This question is related to the rasterVis package. Please reproduce the following plot:
>
> library(raster)
> library(rasterVis)
>
> r1=r2=r3=raster(nr=100, nc=100)
> r1[]<-r2[]<-r3[]<-1:ncell(r1)
> s<-stack(r1,r2,r3)
> levelplot(s)
>
> On my Mac, I think the text size is too small. Increasing picture dimensions won't work - graph size will increase but text still looks small.
>
> So my question arises: how can I increase axis, scale and title font size in a levelplot graphic? I've skimmed over both rasterVis and lattice documentation and haven't found any clues.
>
>
> Any help appreciated.
>
> Best regards,
> Thiago.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From amock at gmx.li  Tue Mar 26 08:10:02 2013
From: amock at gmx.li (Philipp Reiter)
Date: Tue, 26 Mar 2013 08:10:02 +0100 (CET)
Subject: [R-sig-Geo] writeRaster - netcdf - Rotation
Message-ID: <trinity-14f2cfca-88bd-40e9-b5ee-ffb392436f9c-1364281802621@3capp-gmx-bs28>

Hi Robert,
?
sure, m x n can be represented by n x m, but I was confused that after reimporting data as nc I have to transpose and rasterize it first before plotting. Because normally I don't have to do any of those two.
?
?
When I plot the examples from you,
?
image(tmp)
equals
image(writeRaster(tmp, filename='export.nc', format="CDF", overwrite=TRUE, xname='easting', yname='northing'))
and also equals
image(raster('export.nc'))
?
but
image(get.var.ncdf(nc,"layer")) doesn't and I have to transpose and rasterize it first:
image(t(raster(get.var.ncdf(nc,"layer"))))? # Now the plot is correct
?
The last plot is what got me confused. Maybe u can tell me why in this case the transposition and rasterize is needed?
?
Regards,
Philipp
?
?
?
Philipp,

A matrix of dimensions n x m can be represented as m x n, and my example
shows that the data are clearly equivalent (please build on this example if
you have further queries; it is not very helpful to refer to data we cannot
see):

library(raster)
tmp<- raster(nr=5, nc=10,crs='+proj=utm +zone=12')
tmp[] <- 1:ncell(tmp)
r <- writeRaster(tmp, filename='export.nc', format="CDF", overwrite=TRUE,
xname='easting', yname='northing')
all(values(tmp) == values(r))

nc <- open.ncdf("export.nc")
get.var.ncdf(nc,"easting")
get.var.ncdf(nc,"layer")

# result is the same as:
r <- raster('export.nc')
t(as.matrix(r))


Robert




On Mon, Mar 25, 2013 at 3:55 AM, Philipp Reiter <amock at gmx.li> wrote:

> Hi Robert and Pascal,
>
> thanks for the tips, but my problem isn't completely solved. The explicit
> laebling of x and y works, but doesn't change the rotation.
> I followed Pascals hint:
> My raster*-Object has the dimensons: "220 171 x".
> When I export this raster*-Obejct as posted below as nc-file and reimport
> it with the ncdf-Package, the dimensions are: "171 220 x". The explicit
> labeling doesn't change that. The first dimension is always 171 in the
> nc-file, no matter if its names 'easting' or 'northing'. To me it looks
> like raster and ncdf interpret x and y differently?!
>
> Beste regards
> Philipp
>
>
> Philipp,
>
> You are right, the labels easting and northing are reversed. I will fix
> that. You can set them yourself as illustrated below:
>
> library(raster)
> tmp<- raster(nr=5, nc=10,crs='+proj=utm +zone=12')
> tmp[] <- 1:ncell(tmp)
> writeRaster(tmp, filename='export.nc', format="CDF", overwrite=TRUE,
> xname='easting', yname='northing')
> raster('export.nc')
>
> nc <- open.ncdf("export.nc")
> get.var.ncdf(nc,"easting")
>
> Robert
>
> On Fri, Mar 22, 2013 at 7:17 AM, <amock at gmx.li> wrote:
>
> >
> > Hey there,
> > I?ve got a problem concerning exporting a raster*-Object as nc-File:
> > When exporting rasterLayers or rasterBricks as nc-Files with writeRaster
> > from the raster-Package, easting and northing in the resulting nc-File
> are
> > switched, which results in a rotated plot. I can correct this afterwards,
> > but it should be possible to be correct right away?!
> >
> > Example code for a rasterLayer:
> > tmp <- raster(readGDAL(?example.asc?,p4s="+init=epsg:31467"))
> > writeRaster(tmp, filename=?export.nc?, format="CDF", overwrite=TRUE)
> > nc <- open.ncdf("export.nc")
> > x <- get.var.ncdf(nc,?easting?)
> > y <- get.var.ncdf(nc,?northing?)
> >
> > R version 2.15.3 (2013-03-01)
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > ncdf_1.6.6 raster_2.1-16 rgdal_0.8-5 sp_1.0-6
> >
> > I hope someone can give me a hint! Thanks in advance!
> > Philipp
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo[https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&selection=tfol11b9dc8701907a64][https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&selection=tfol11b9dc8701907a64[https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2F3c.gmx.net%2Fmail%2Fclient%2Fdereferrer%3FredirectUrl%3Dhttps%253A%252F%252Fstat.ethz.ch%252Fmailman%252Flistinfo%252Fr-sig-geo%26selection%3Dtfol11b9dc8701907a64&selection=tfol11b9dc8701907a64]]
> >
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo[https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&selection=tfol11b9dc8701907a64][https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&selection=tfol11b9dc8701907a64[https://3c.gmx.net/mail/client/dereferrer?redirectUrl=https%3A%2F%2F3c.gmx.net%2Fmail%2Fclient%2Fdereferrer%3FredirectUrl%3Dhttps%253A%252F%252Fstat.ethz.ch%252Fmailman%252Flistinfo%252Fr-sig-geo%26selection%3Dtfol11b9dc8701907a64&selection=tfol11b9dc8701907a64]]


From oscar.perpinan at gmail.com  Tue Mar 26 10:40:51 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Tue, 26 Mar 2013 10:40:51 +0100
Subject: [R-sig-Geo] Increasing font size in a levelplot graphic
In-Reply-To: <51511B90.50306@ymail.com>
References: <1364267791.70628.YahooMailNeo@web121902.mail.ne1.yahoo.com>,
	<51511B90.50306@ymail.com>
Message-ID: <87620e8png.fsf@gmail.com>

Hi,

On the other hand, perhaps your problem arises when you export the
graphic using large values for width and height without modifying the
resolution.

Try this:

library(raster)
library(rasterVis)

r <- raster()
r <- init(r, runif)

## res=72 if none is provided
png('smallFontSize.png', width=4000, height=4000)
levelplot(r)
dev.off()

png('correctFontSize.png', width=4000, height=4000, res=600)
levelplot(r)
dev.off()


Best,

Oscar.
Pascal Oettli <kridox at ymail.com> writes:

> Hi,
>
> For example:
>
> p.strip <- list(cex=1.5, lines=2, fontface='bold')
> ckey <- list(labels=list(cex=1.5, col='magenta'), height=0.5)
> x.scale <- list(cex=1, alternating=1, col='red')
> y.scale <- list(cex=1, alternating=1, col='blue')
>
> levelplot(s, colorkey=ckey, par.strip.text=p.strip, 
> scales=list(x=x.scale, y=y.scale))
>
> HTH,
> Pascal
>
>
> On 26/03/13 12:16, Thiago V. dos Santos wrote:
>> Dear R-SIGgers,
>>
>> This question is related to the rasterVis package. Please reproduce the following plot:
>>
>> library(raster)
>> library(rasterVis)
>>
>> r1=r2=r3=raster(nr=100, nc=100)
>> r1[]<-r2[]<-r3[]<-1:ncell(r1)
>> s<-stack(r1,r2,r3)
>> levelplot(s)
>>
>> On my Mac, I think the text size is too small. Increasing picture dimensions won't work - graph size will increase but text still looks small.
>>
>> So my question arises: how can I increase axis, scale and title font size in a levelplot graphic? I've skimmed over both rasterVis and lattice documentation and haven't found any clues.
>>
>>
>> Any help appreciated.
>>
>> Best regards,
>> Thiago.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From k.ranalter at gmail.com  Tue Mar 26 10:20:05 2013
From: k.ranalter at gmail.com (Kurt Ranalter)
Date: Tue, 26 Mar 2013 10:20:05 +0100
Subject: [R-sig-Geo] Slivers in thinned spatial polygon
Message-ID: <CABXgnVmbQCqRRLui9BTPbQ6V5CpKKXjhLOcwR7ttN85wMyPmug@mail.gmail.com>

Dear list,

while trying to simplify a SpatialPolygons object by means of the
thinnedSpatialPoly function of the maptools package, I've encountered
the following problem.

As far as I understand things, setting the topologyPreserve option to
TRUE should allow one to avoid slivers. However, when I use the
function in this way, this does not seem to happen: see for instance
the graph produced by the following example session.

> require(maptools)
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
Loading required package: grid
Loading required package: lattice
Checking rgeos availability: TRUE
> require(maps)
Loading required package: maps
>
> map <- map("italy", plot = FALSE)
> sp <- map2SpatialPolygons(map, IDs = map$names)
>
> t <- sp at polygons[[114]]
> a <- sp at polygons[[16]]
>
> ta <- SpatialPolygons(list(t, a))
>
> ta.thin <- thinnedSpatialPoly(ta, tolerance = 0.02,
+                               topologyPreserve = TRUE)
Loading required package: rgeos
rgeos: (SVN revision 360)
 GEOS runtime version: 3.3.5-CAPI-1.7.5
 Polygon checking: TRUE
>
> plot(ta, border = "grey")
> plot(ta.thin, add = TRUE)

I'm not sure whether I'm just missing something obvious. Any help
would be much appreciated.

Best wishes,

Kurt


From pingyang.whu at gmail.com  Tue Mar 26 15:27:50 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Tue, 26 Mar 2013 10:27:50 -0400
Subject: [R-sig-Geo] Plot several BoxPlots
In-Reply-To: <CAK8gSG_yztVq3rTJQdRhMh4rsdm_-VQjkXtZmTVRuMDnuJFjyA@mail.gmail.com>
References: <CAK8gSG_yztVq3rTJQdRhMh4rsdm_-VQjkXtZmTVRuMDnuJFjyA@mail.gmail.com>
Message-ID: <CAK8gSG_-cuZHvvp8dRnbjqwKYjSsAsU34SLfk6p6Y==t2xzFOg@mail.gmail.com>

Hi R users,

I saw a plot like this:
[image: Inline image 1]
I am wondering how to generate this plot (especially plotting the three
items for each season), Can anyone here give me some hints/instructions on
this plot?

Thanks and Regards,

-- 
Ping Yang, Ph.D.
CUNY Environmental Crossroads Initiative
The City College of New York - CUNY
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130326/636c4dab/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 36290 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130326/636c4dab/attachment.png>

From smithtiffanyt at gmail.com  Tue Mar 26 16:49:15 2013
From: smithtiffanyt at gmail.com (Tiffany Smith)
Date: Tue, 26 Mar 2013 11:49:15 -0400
Subject: [R-sig-Geo] Aggregate using Shapefile
In-Reply-To: <CANtt_hxD62-+pLe2=YiNCo+Bk5PRTo8M8KH0MhMU0Hg4z4w30Q@mail.gmail.com>
References: <DE436105-525A-4F25-9AB2-86C608C9120B@gmail.com>
	<CANtt_hxQrydHAQWZaZ5Zzj35RHbSDa0o2kschNeAKDhSwL2UjQ@mail.gmail.com>
	<7A464E83-FF88-432E-9393-28797A0E5FF9@gmail.com>
	<CANtt_hxD62-+pLe2=YiNCo+Bk5PRTo8M8KH0MhMU0Hg4z4w30Q@mail.gmail.com>
Message-ID: <ACCC4298-2C7C-43DD-9736-4DBB5C7954D4@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130326/c18a3573/attachment.pl>

From pingyang.whu at gmail.com  Tue Mar 26 18:13:33 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Tue, 26 Mar 2013 13:13:33 -0400
Subject: [R-sig-Geo] R Package for Climatology particular for netCDF file
Message-ID: <CAK8gSG--Cwxo1e9nm-RuT7Yw5KxyB7zuA_SUuBALbac3ABsLfQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130326/af0e059f/attachment.pl>

From thi_veloso at yahoo.com.br  Tue Mar 26 19:39:46 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Tue, 26 Mar 2013 11:39:46 -0700 (PDT)
Subject: [R-sig-Geo] Increasing font size in a levelplot graphic
In-Reply-To: <87620e8png.fsf@gmail.com>
References: <1364267791.70628.YahooMailNeo@web121902.mail.ne1.yahoo.com>,
	<51511B90.50306@ymail.com> <87620e8png.fsf@gmail.com>
Message-ID: <1364323186.51874.YahooMailNeo@web121904.mail.ne1.yahoo.com>

Oscar and Pascal,

Thank you for the suggestions. Both of them solved my problem.

Best,
Thiago.


----- Original Message -----
From: Oscar Perpi??n Lamigueiro <oscar.perpinan at gmail.com>
To: Pascal Oettli <kridox at ymail.com>
Cc: Thiago V. dos Santos <thi_veloso at yahoo.com.br>; R-SIG list <r-sig-geo at r-project.org>
Sent: Tuesday, March 26, 2013 4:40 AM
Subject: Re: [R-sig-Geo] Increasing font size in a levelplot graphic

Hi,

On the other hand, perhaps your problem arises when you export the
graphic using large values for width and height without modifying the
resolution.

Try this:

library(raster)
library(rasterVis)

r <- raster()
r <- init(r, runif)

## res=72 if none is provided
png('smallFontSize.png', width=4000, height=4000)
levelplot(r)
dev.off()

png('correctFontSize.png', width=4000, height=4000, res=600)
levelplot(r)
dev.off()


Best,

Oscar.
Pascal Oettli <kridox at ymail.com> writes:

> Hi,
>
> For example:
>
> p.strip <- list(cex=1.5, lines=2, fontface='bold')
> ckey <- list(labels=list(cex=1.5, col='magenta'), height=0.5)
> x.scale <- list(cex=1, alternating=1, col='red')
> y.scale <- list(cex=1, alternating=1, col='blue')
>
> levelplot(s, colorkey=ckey, par.strip.text=p.strip, 
> scales=list(x=x.scale, y=y.scale))
>
> HTH,
> Pascal
>
>
> On 26/03/13 12:16, Thiago V. dos Santos wrote:
>> Dear R-SIGgers,
>>
>> This question is related to the rasterVis package. Please reproduce the following plot:
>>
>> library(raster)
>> library(rasterVis)
>>
>> r1=r2=r3=raster(nr=100, nc=100)
>> r1[]<-r2[]<-r3[]<-1:ncell(r1)
>> s<-stack(r1,r2,r3)
>> levelplot(s)
>>
>> On my Mac, I think the text size is too small. Increasing picture dimensions won't work - graph size will increase but text still looks small.
>>
>> So my question arises: how can I increase axis, scale and title font size in a levelplot graphic? I've skimmed over both rasterVis and lattice documentation and haven't found any clues.
>>
>>
>> Any help appreciated.
>>
>> Best regards,
>> Thiago.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan



From Roger.Bivand at nhh.no  Tue Mar 26 20:11:32 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Mar 2013 20:11:32 +0100
Subject: [R-sig-Geo] Too many zero's for the quantile style in the
 function of 'classIntervals'
In-Reply-To: <1364282334.1712.YahooMailNeo@web15108.mail.cnb.yahoo.com>
References: <1364282334.1712.YahooMailNeo@web15108.mail.cnb.yahoo.com>
Message-ID: <alpine.LRH.2.03.1303262010070.11930@reclus.nhh.no>

Please never post HTML, it wastes bandwidth and is unnecessary.

If you run quantile() on the same data, you see the same outcome. Maybe 
try a more suitable style?

Roger Bivand

On Tue, 26 Mar 2013, Xing Zhao wrote:

> Hi,?all
> ?
> This?question?is?a?relevant?problem?for?mapping?sequential?color?according?to?crude?rate.
> There?are?a?lot?of?zero's,?so?the?usual?'classIntervals'?function?doesn't?work.
> A?simple?example,
>> ?library(classInt)
>> ?dat?<-?c(rep(0,4),1,2,3,4)
>> ?dat
> [1]?0?0?0?0?1?2?3?4
>> ?classIntervals(dat,?n?=?4,?style?=?'quantile')
> style:?quantile
> ??one?of?4?possible?partitions?of?this?variable?into?4?classes
> ?????[0,0)????[0,0.5)?[0.5,2.25)???[2.25,4]?
> ?????????0??????????4??????????2??????????2?
> I?intended?to?categorize?the?crude?rate?to?4?groups.?But?the?result?turns?out?to?be?3?groups.?And?this?manipulation?is?related?to?the?subsequent?'findColours'?function.
> I?know?there?must?be?some?complex?methods?to?deal?with?this?problem.?For?instance,?extracting?the?zero's?first,?'classIntervals'?the?remaing.?But?this?would?cause?trouble?to?the?'findColours'?function.
> I?want?some?simple?ones,?which?can?be?smoothly?connected?with?the?subsequent?'findColours'?function.
> ?
> Thank?you?in?advance
> ?
> Zhao?Xing
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From thi_veloso at yahoo.com.br  Tue Mar 26 20:11:45 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Tue, 26 Mar 2013 12:11:45 -0700 (PDT)
Subject: [R-sig-Geo] R Package for Climatology particular for netCDF file
In-Reply-To: <CAK8gSG--Cwxo1e9nm-RuT7Yw5KxyB7zuA_SUuBALbac3ABsLfQ@mail.gmail.com>
References: <CAK8gSG--Cwxo1e9nm-RuT7Yw5KxyB7zuA_SUuBALbac3ABsLfQ@mail.gmail.com>
Message-ID: <1364325105.36564.YahooMailNeo@web121902.mail.ne1.yahoo.com>

Yang,

The closer of what you are asking for that I know is the RNCEP package, which deals with reanalysis data. Package clim.pact used to provide some useful methods (like EOF and PCA), but for some reason it was descontinued.

However, all the packages you mentioned provide a way to take advantage of R's flexibility and allow you to develop you own methods.

Best,
Thiago.


----- Original Message -----
From: ping yang <pingyang.whu at gmail.com>
To: dpierce at ucsd.edu; R-sig-Geo at r-project.org
Cc: 
Sent: Tuesday, March 26, 2013 12:13 PM
Subject: [R-sig-Geo] R Package for Climatology particular for netCDF file

Dear Dr. Pierce and R specialists,

I am much appreciated your work on ncdf(ncdf4 and RnetCDF) packages,
however, I am wondering if those package can go further.

Is there a package for calculating climate statistics ,e.g. monthly mean,
seasonal mean, yearly mean,spatial mean( like gridboxmean in CDO), and
climatology for multiyear analysis in R or CRAN ? and Is there a plotting
library for the climate variables particularly for NetCDF.

I found a little trivial when I plan to do statistical based on daily data
for long history (I do it using some tools but not efficient, everytime I
need to generate a file and then use ncdf funcitons to read and then plot.

Thanks,

Ping
-- 
Ping Yang, Ph.D.
CUNY Environmental Crossroads Initiative
The City College of New York - CUNY

??? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From d.orme at imperial.ac.uk  Tue Mar 26 21:34:20 2013
From: d.orme at imperial.ac.uk (Orme, David)
Date: Tue, 26 Mar 2013 20:34:20 +0000
Subject: [R-sig-Geo] Calculating physical distance along accumulative cost
	distance paths
Message-ID: <495E3A8F73863D4A8BCFD8969C18B3784B240CD2@icexch-m6.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130326/dcd3abfb/attachment.pl>

From jacobvanetten at yahoo.com  Wed Mar 27 04:08:02 2013
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Wed, 27 Mar 2013 03:08:02 +0000 (GMT)
Subject: [R-sig-Geo] Calculating physical distance along accumulative
	cost distance paths
In-Reply-To: <495E3A8F73863D4A8BCFD8969C18B3784B240CD2@icexch-m6.ic.ac.uk>
References: <495E3A8F73863D4A8BCFD8969C18B3784B240CD2@icexch-m6.ic.ac.uk>
Message-ID: <1364353682.50755.YahooMailNeo@web133203.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130327/088c6851/attachment.pl>

From Thierry.ONKELINX at inbo.be  Wed Mar 27 12:13:56 2013
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 27 Mar 2013 11:13:56 +0000
Subject: [R-sig-Geo] GRTS sampling
In-Reply-To: <CALyPt8xBxcSKAon592q8smEyY1wpMF93D5i6Gdyiqa1OxV9J-Q@mail.gmail.com>
References: <1360593929427-7582569.post@n2.nabble.com>
	<CALyPt8xBxcSKAon592q8smEyY1wpMF93D5i6Gdyiqa1OxV9J-Q@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA7427B0F8040C@inbomail.inbo.be>

Dear all,

I have put the code that I've posted before into a package. The package is available on R-forge.

install.packages("GRTS", repos="http://R-Forge.R-project.org")

Any comments are welcome.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey



On Mon, Feb 11, 2013 at 6:45 AM, Dick Brus <dick.brus at wur.nl> wrote:

> I try to understand the hierarchical randomization as applied in the
> GRTS design.
>
> I randomized 16 points on a square grid, see R script below. The
> argument do.sample was set to FALSE, so that the result consists of a
> dataframe of all 16 points instead of a GRTS sample. When plotting the
> order of the points it appears that the numbers 1-4 are not always in
> different subsquares (of which there are four) , for instance points 1
> and 3 are both in the lower-right subsquare. What am I doing wrong?
>
> library(spsurvey)
>
> frame<-expand.grid(x=seq(from=1,to=4,by=1),y=seq(from=1,to=4,by=1))
>
> #population size (total number of sampling units in Kandahar)
> N<-nrow(frame)
>
> #set number of sampling units (sample size) to be selected
> n<-4
>
> design<-list(None=list(panel=c(Panel1=n), seltype="Equal",
> caty.n=c("Caty 1"=n), over=0)) x<-frame$x y<-frame$y index<-1:N
> att<-data.frame(x=x,y=y,ids=index)
>
> #do.sample=FALSE gives all sampling units in hierarchical? randomized
> order res<-grts(design, DesignID="Site", SiteBegin=1, type.frame="finite",
>          src.frame="att.frame", in.shape=NULL, sp.object=NULL,
> att.frame=att,
>          id=NULL, xcoord="x", ycoord="y", stratum=NULL, mdcaty=NULL,
> startlev=2,
>          maxlev=11, maxtry=1000, shift.grid=FALSE,
> do.sample=rep(FALSE, length(design)),
>          shapefile=FALSE, prjfilename=NULL, out.shape="sample")
> frame.randomized<-data.frame(res$xcoord,res$ycoord)
> names(frame.randomized)<-c("x","y")
> frame.randomized$id<-1:N
>
> png(file = "GRTSRandomizedFrameSquare.png", width = 480, height = 480)
> print(
>   ggplot(data = frame.randomized) +
>     geom_text(
>       data = frame.randomized,
>       mapping = aes(
>         x = x,
>         y = y,
>         label = id
>       ),
>       size = 5
>     ) +
>     coord_equal()
> )
> dev.off()
>
> <
> http://r-sig-geo.2731867.n2.nabble.com/file/n7582569/GRTSRandomizedFra
> meSquare.png
> >
>
>
>
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/GRTS-sampling-tp7582569.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From saeidi.va at gmail.com  Wed Mar 27 14:10:25 2013
From: saeidi.va at gmail.com (vahideh saeidi)
Date: Wed, 27 Mar 2013 21:10:25 +0800
Subject: [R-sig-Geo] GRTS sampling
In-Reply-To: <AA818EAD2576BC488B4F623941DA7427B0F8040C@inbomail.inbo.be>
References: <1360593929427-7582569.post@n2.nabble.com>
	<CALyPt8xBxcSKAon592q8smEyY1wpMF93D5i6Gdyiqa1OxV9J-Q@mail.gmail.com>
	<AA818EAD2576BC488B4F623941DA7427B0F8040C@inbomail.inbo.be>
Message-ID: <CAMoBj2gsOfZzJSNt9Mbrxvcg=Z40h6byQ83RR_OtzVD-7t5Kcw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130327/b44b1334/attachment.pl>

From saeidi.va at gmail.com  Wed Mar 27 14:14:39 2013
From: saeidi.va at gmail.com (vahideh saeidi)
Date: Wed, 27 Mar 2013 21:14:39 +0800
Subject: [R-sig-Geo]  Converting tiff to rst
Message-ID: <CAMoBj2geLfvQnKQRZjECP3N=PvA5tNGS7fd6NpOoN3TZJDMuqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130327/42d6f246/attachment.pl>

From lukaslehnert at googlemail.com  Wed Mar 27 14:40:54 2013
From: lukaslehnert at googlemail.com (Lukas Lehnert)
Date: Wed, 27 Mar 2013 14:40:54 +0100
Subject: [R-sig-Geo] Converting tiff to rst
In-Reply-To: <CAMoBj2geLfvQnKQRZjECP3N=PvA5tNGS7fd6NpOoN3TZJDMuqA@mail.gmail.com>
References: <CAMoBj2geLfvQnKQRZjECP3N=PvA5tNGS7fd6NpOoN3TZJDMuqA@mail.gmail.com>
Message-ID: <5857761.rCxMUnqERY@kobold>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130327/a5492662/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Wed Mar 27 15:01:55 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Wed, 27 Mar 2013 15:01:55 +0100
Subject: [R-sig-Geo] raster directions to vectorial lines (Stream to
 Feature)
In-Reply-To: <F9CC8F918F2B7B458329EC1DF9D15B7704FCDE0653@ITS-WIN-063.staffad.uwa.edu.au>
References: <F9CC8F918F2B7B458329EC1DF9D15B7704FCDE0653@ITS-WIN-063.staffad.uwa.edu.au>
Message-ID: <5152FBD3.1070505@jrc.ec.europa.eu>


On 22/03/13 05:31, Gavan McGrath wrote:
> Hi Mauricio,
>
> Below is a simple pair of functions for plotting a flow network over an image which should achieve what you were after.  You may want to play around with how your flow direction numbers 1 -9 match up with those in the lookupfidr function. Its a bit cluncky but gets the job done.
>
> The function fdirPlot takes as input a matrix imData the background image, and a matrix fdirs of flow direction integers.
>
> Good luck.

Thank you very much Gavan for you valuable help, and apologise for my 
late reply.

With slight modifications to the code you gave me, I managed to do what 
I want on the screen device:

------------- START reproducible example ----------------
lookupfdir <-function(fdir) {
    switch(paste(fdir,"",sep=""),
        '1' = c(-1,-1),
        '4' = c(-1,0),
        '7' = c(-1,1),
        '8' = c(0,1),
        '9' = c(1,1),
        '6' = c(1,0),
        '3' = c(1,-1),
        '2' = c(0,-1),
        '5' = c(0,0),
            c(-2,-2)
    )
} # 'lookupfdir' end

fdirPlot <- function(imData,fdirs) {
   dimDat<- dim(imData)
   Ly    <- dimDat[1] - 1
   Lx    <- dimDat[2] - 1
   centres.x <- seq(0,1, length.out=dimDat[2])
   centres.y <- seq(0,1, length.out=dimDat[1])
   image(t(imData),axes=FALSE)
   for (i in centres.x) { # x direction
     for (j in centres.y) { # y direction
     dxdy <- lookupfdir(fdirs[i+1,j+1])
     dx   <- dxdy[1]/Lx
     dy   <- dxdy[2]/Ly
     if (dxdy[1] != -2)
      lines( rbind( c(i, j), c(i + dx, j + dy) ) )
     } # IF end
   } # FOR j end
} # 'fdirPlot' end

# Testing
imData <- matrix(rnorm(30), ncol=3, nrow=2)
fdirs  <- matrix(9, ncol=3, nrow=2)

fdirPlot(imData, fdirs)
------------- END reproducible example ----------------


However, I would like to do the same as before but over a raster file:


# creating the two rasters from the scratch
library(raster)
imData         <- raster(nrows=2, ncols=3, xmn=0, xmx=10,  ymn=0, ymx=5)
values(imData) <- rnorm(6)

fdirs     <- raster(nrows=2, ncols=3, xmn=0, xmx=10,  ymn=0, ymx=5)
values(r) <- 9

However, I do not know how to plot the lines over the raster and then 
save the resulting lines as a shapefile.

Do you -or somebody else- have any advice about how to do it ?

Thank in advance for your help,

Mauricio

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
Linux user #454569 -- Ubuntu user #17469
=================================================
"It is not enough to have knowledge;
one must also apply it" (Goethe)
>
>
> lookupfdir <-function(fdir) {
>     switch(paste(fdir,"",sep=""),
>         '1' = c(-1,-1),
>         '2' = c(-1,0),
>         '3' = c(-1,1),
>         '4' = c(0,1),
>         '5' = c(1,1),
>         '6' = c(1,0),
>         '7' = c(1,-1),
>         '8' = c(0,-1),
>         '9' = c(0,0),
>             c(-2,-2)
>     )
> }
>
> fdirPlot <- function(imData,fdirs) {
>    dimDat<- dim(imData)
>    image(imData,axes=FALSE)
>    for (i in 1:dimDat[1]) {
>    for (j in 1:dimDat[2]) {
>    dxdy <- lookupfdir(fdirs[i,j])
>    if (dxdy[1] != -2) {
>     lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-dxdy[1]-0.5,j-dxdy[2]-0.5)/dimDat[1]))
>     } else {
>            if (i==1) {
>              lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-1.5,j-0.5)/dimDat[1]))
>            } else {
>                  if (i==dimDat[1]) {
>                      lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i+1-0.5,j-0.5)/dimDat[1]))
>                   } else {
>                          if (j==1) {
>                            lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-0.5,j-1-0.5)/dimDat[1]))
>                          } else {
>                                 if (j==dimDat[2]) {
> 		                 lines(rbind(c(i-0.5,j-0.5)/dimDat[1],c(i-0.5,j+1-0.5)/dimDat[1]))
>                                 }
>                            }
>                       }
>               }
>        }
>    }
>    }
> }
>
> Gavan McGrath
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From samanmonfared1 at gmail.com  Thu Mar 28 13:03:08 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Thu, 28 Mar 2013 16:33:08 +0430
Subject: [R-sig-Geo] NA in ST-variogram
Message-ID: <CAOytA4a2saXDxKxcXXzP=ZrrmyEWEU+LiTVbfo0EYsqUmBSGTw@mail.gmail.com>

Dear All,
I have some problem in ST modeling using gstat.
 my program is :

library(gstat)
data<-read.table("cancer.txt",header=TRUE)
value<-runif(105)
sp = cbind(data$x,data$y)
row.names(sp) = paste("point", 1:nrow(sp), sep="")
sp = SpatialPoints(sp)
time = as.POSIXct("2003-01-01")+360*(0:6)
time
mydata = data.frame(length(sp)*length(time),value)
IDs = paste("ID",1:length(mydata))
stfdf = STFDF(sp, time, mydata)
vv<-variogramST(value~1,stfdf,tlags = 1:10,cutoff=300000, width =30000/20)
plot(vv,map=T)
library(lattice)
wireframe(gamma~spacelag*timelag+1, vv, drape=F,col.regions=bpy.colors)

Error: NAs are not allowed ........

How can I solve this problem.

I use blow program to fit ST variogram function

ExpVgmMetric = function(x, s, t, nugget = 0) {
 h = sqrt(s^2 + (x[3] * as.numeric(t))^2)
 ifelse(h == 0, 0, nugget + x[1] * (1 - exp(-h / x[2])))
}
ExpFitFn = function(x, gfn, v, trace = FALSE, ...) {
mod = gfn(x, v$spacelag, v$timelag, ...)
resid = v$gamma - mod
if (trace)
print(c(x, MSE = mean(resid^2)))
mean(resid^2)
}
pars.M = optim(c(sill = 5, range = 169, anis = 0), ExpFitFn,
gfn = ExpVgmMetric, v = vv, nugget = 0)
pars.M$par
vv$model = ExpVgmMetric(pars.M$par, vv$spacelag, vv$timelag, nugget = 0)
plot(vv)

but  it's sill is negative and in plot part model only has a single
value and dose not change by changing spatial and temporal lags.

Best,
Saman.

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From rossahmed at googlemail.com  Fri Mar 29 13:26:50 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 29 Mar 2013 12:26:50 +0000
Subject: [R-sig-Geo] intersection of polygons
Message-ID: <CD7B390A.44CC%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130329/03fc65af/attachment.pl>

From Roger.Bivand at nhh.no  Fri Mar 29 13:54:43 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Mar 2013 13:54:43 +0100
Subject: [R-sig-Geo] intersection of polygons
In-Reply-To: <CD7B390A.44CC%rossahmed@gmail.com>
References: <CD7B390A.44CC%rossahmed@gmail.com>
Message-ID: <alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>

On Fri, 29 Mar 2013, Ross Ahmed wrote:

> Hi all,
>
> I have this list of polygons:
>
> library(sp)
> p1 <- Polygon(cbind(c(-1.672487,-1.663689,-1.663185,-1.672258,-1.672487),
>                    c(55.58951,55.58948,55.58249,55.58260,55.58951)))
> p2 <- Polygon(cbind(c(-1.663689, -1.655508, -1.65514, -1.6633, -1.663689),
>                    c(55.589485, 55.589554, 55.582396, 55.582428,
> 55.589485)))
> p3 <- Polygon(cbind(c(-1.672224, -1.663046, -1.662525, -1.672137,
> -1.672224),
>                    c(55.582142, 55.582044, 55.575139, 55.575348,
> 55.582142)))
>
> sp1 <- Polygons(list(Polygon(p1)),"p1")
> sp2 <- Polygons(list(Polygon(p2)),"p2")
> sp3 <- Polygons(list(Polygon(p3)),"p3")
> spAll <- SpatialPolygons(list(sp1, sp2, sp3))
> proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>
>
> ?.and also this single polygon:
>
> poly1 <- Polygon(cbind(c(-1.666566, -1.659071, -1.658532, -1.666459,
> -1.666566),
>                       c(55.586296, 55.586357, 55.580414, 55.580505,
> 55.586296)))
> spoly1 <- Polygons(list(Polygon(poly1)),"poly1")
> spoly1 <- SpatialPolygons(list(spoly1))
> proj4string(spoly1) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>
>
> I need to find the proportion of ?spoly1? that is overlapped by ?sp1?,
> ?sp2?, ?sp3? and no polygon. The output should be something like:
>
> 0.40, 0.30, 0.20, 0.10

library(rgeos)
gArea(spoly1)
gArea(gIntersection(spAll, spoly1, byid=TRUE), byid=TRUE)/gArea(spoly1)

but note the warnings. You'll need to project both objects to get a proper 
measure.

Roger

>
> Thanks
> Ross
>
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Fri Mar 29 14:01:27 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 29 Mar 2013 14:01:27 +0100
Subject: [R-sig-Geo] intersection of polygons
In-Reply-To: <alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>
References: <CD7B390A.44CC%rossahmed@gmail.com>
	<alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>
Message-ID: <515590A7.3060304@uni-muenster.de>



On 03/29/2013 01:54 PM, Roger Bivand wrote:
> On Fri, 29 Mar 2013, Ross Ahmed wrote:
> 
>> Hi all,
>>
>> I have this list of polygons:
>>
>> library(sp)
>> p1 <- Polygon(cbind(c(-1.672487,-1.663689,-1.663185,-1.672258,-1.672487),
>>                    c(55.58951,55.58948,55.58249,55.58260,55.58951)))
>> p2 <- Polygon(cbind(c(-1.663689, -1.655508, -1.65514, -1.6633,
>> -1.663689),
>>                    c(55.589485, 55.589554, 55.582396, 55.582428,
>> 55.589485)))
>> p3 <- Polygon(cbind(c(-1.672224, -1.663046, -1.662525, -1.672137,
>> -1.672224),
>>                    c(55.582142, 55.582044, 55.575139, 55.575348,
>> 55.582142)))
>>
>> sp1 <- Polygons(list(Polygon(p1)),"p1")
>> sp2 <- Polygons(list(Polygon(p2)),"p2")
>> sp3 <- Polygons(list(Polygon(p3)),"p3")
>> spAll <- SpatialPolygons(list(sp1, sp2, sp3))
>> proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>>
>>
>> ?.and also this single polygon:
>>
>> poly1 <- Polygon(cbind(c(-1.666566, -1.659071, -1.658532, -1.666459,
>> -1.666566),
>>                       c(55.586296, 55.586357, 55.580414, 55.580505,
>> 55.586296)))
>> spoly1 <- Polygons(list(Polygon(poly1)),"poly1")
>> spoly1 <- SpatialPolygons(list(spoly1))
>> proj4string(spoly1) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>>
>>
>> I need to find the proportion of ?spoly1? that is overlapped by ?sp1?,
>> ?sp2?, ?sp3? and no polygon. The output should be something like:
>>
>> 0.40, 0.30, 0.20, 0.10
> 
> library(rgeos)
> gArea(spoly1)
> gArea(gIntersection(spAll, spoly1, byid=TRUE), byid=TRUE)/gArea(spoly1)
> 
> but note the warnings. You'll need to project both objects to get a
> proper measure.

Would errors instead of warnings not be more appropriate in this case?

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.m.krug at gmail.com  Fri Mar 29 14:18:09 2013
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 29 Mar 2013 14:18:09 +0100
Subject: [R-sig-Geo] BUG in set.pluginOption() in spGRASS6
Message-ID: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130329/d0a95ca1/attachment.pl>

From rossahmed at googlemail.com  Fri Mar 29 14:20:49 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 29 Mar 2013 13:20:49 +0000
Subject: [R-sig-Geo] intersection of polygons
In-Reply-To: <alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>
References: <CD7B390A.44CC%rossahmed@gmail.com>
	<alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>
Message-ID: <EE2DDEF7-E02D-4CFA-B9F8-7E8B79726D42@gmail.com>

Many thanks Roger. 

I thought proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84") took care of projection, but obviously not. How do I project?

Ross

On 29 Mar 2013, at 12:54, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 29 Mar 2013, Ross Ahmed wrote:
> 
>> Hi all,
>> 
>> I have this list of polygons:
>> 
>> library(sp)
>> p1 <- Polygon(cbind(c(-1.672487,-1.663689,-1.663185,-1.672258,-1.672487),
>>                   c(55.58951,55.58948,55.58249,55.58260,55.58951)))
>> p2 <- Polygon(cbind(c(-1.663689, -1.655508, -1.65514, -1.6633, -1.663689),
>>                   c(55.589485, 55.589554, 55.582396, 55.582428,
>> 55.589485)))
>> p3 <- Polygon(cbind(c(-1.672224, -1.663046, -1.662525, -1.672137,
>> -1.672224),
>>                   c(55.582142, 55.582044, 55.575139, 55.575348,
>> 55.582142)))
>> 
>> sp1 <- Polygons(list(Polygon(p1)),"p1")
>> sp2 <- Polygons(list(Polygon(p2)),"p2")
>> sp3 <- Polygons(list(Polygon(p3)),"p3")
>> spAll <- SpatialPolygons(list(sp1, sp2, sp3))
>> proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>> 
>> 
>> ?.and also this single polygon:
>> 
>> poly1 <- Polygon(cbind(c(-1.666566, -1.659071, -1.658532, -1.666459,
>> -1.666566),
>>                      c(55.586296, 55.586357, 55.580414, 55.580505,
>> 55.586296)))
>> spoly1 <- Polygons(list(Polygon(poly1)),"poly1")
>> spoly1 <- SpatialPolygons(list(spoly1))
>> proj4string(spoly1) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>> 
>> 
>> I need to find the proportion of ?spoly1? that is overlapped by ?sp1?,
>> ?sp2?, ?sp3? and no polygon. The output should be something like:
>> 
>> 0.40, 0.30, 0.20, 0.10
> 
> library(rgeos)
> gArea(spoly1)
> gArea(gIntersection(spAll, spoly1, byid=TRUE), byid=TRUE)/gArea(spoly1)
> 
> but note the warnings. You'll need to project both objects to get a proper measure.
> 
> Roger
> 
>> 
>> Thanks
>> Ross
>> 
>> 
>> 
>>    [[alternative HTML version deleted]]
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 


From edzer.pebesma at uni-muenster.de  Fri Mar 29 15:19:23 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 29 Mar 2013 15:19:23 +0100
Subject: [R-sig-Geo] intersection of polygons
In-Reply-To: <EE2DDEF7-E02D-4CFA-B9F8-7E8B79726D42@gmail.com>
References: <CD7B390A.44CC%rossahmed@gmail.com>
	<alpine.LRH.2.03.1303291353300.24489@reclus.nhh.no>
	<EE2DDEF7-E02D-4CFA-B9F8-7E8B79726D42@gmail.com>
Message-ID: <5155A2EB.4070709@uni-muenster.de>



On 03/29/2013 02:20 PM, Ross Ahmed wrote:
> Many thanks Roger. 
> 
> I thought proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84") took care of projection, but obviously not. 

No, it only sets the proj4string, which is NA if not set; +proj=longlat
indicates unprojected data, i.e. coordinates reflect longitude and latitude.

> How do I project?

with spTransform in package rgdal - you need to choose a target CRS for
this.

> 
> Ross
> 
> On 29 Mar 2013, at 12:54, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
>> On Fri, 29 Mar 2013, Ross Ahmed wrote:
>>
>>> Hi all,
>>>
>>> I have this list of polygons:
>>>
>>> library(sp)
>>> p1 <- Polygon(cbind(c(-1.672487,-1.663689,-1.663185,-1.672258,-1.672487),
>>>                   c(55.58951,55.58948,55.58249,55.58260,55.58951)))
>>> p2 <- Polygon(cbind(c(-1.663689, -1.655508, -1.65514, -1.6633, -1.663689),
>>>                   c(55.589485, 55.589554, 55.582396, 55.582428,
>>> 55.589485)))
>>> p3 <- Polygon(cbind(c(-1.672224, -1.663046, -1.662525, -1.672137,
>>> -1.672224),
>>>                   c(55.582142, 55.582044, 55.575139, 55.575348,
>>> 55.582142)))
>>>
>>> sp1 <- Polygons(list(Polygon(p1)),"p1")
>>> sp2 <- Polygons(list(Polygon(p2)),"p2")
>>> sp3 <- Polygons(list(Polygon(p3)),"p3")
>>> spAll <- SpatialPolygons(list(sp1, sp2, sp3))
>>> proj4string(spAll) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>>>
>>>
>>> ?.and also this single polygon:
>>>
>>> poly1 <- Polygon(cbind(c(-1.666566, -1.659071, -1.658532, -1.666459,
>>> -1.666566),
>>>                      c(55.586296, 55.586357, 55.580414, 55.580505,
>>> 55.586296)))
>>> spoly1 <- Polygons(list(Polygon(poly1)),"poly1")
>>> spoly1 <- SpatialPolygons(list(spoly1))
>>> proj4string(spoly1) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
>>>
>>>
>>> I need to find the proportion of ?spoly1? that is overlapped by ?sp1?,
>>> ?sp2?, ?sp3? and no polygon. The output should be something like:
>>>
>>> 0.40, 0.30, 0.20, 0.10
>>
>> library(rgeos)
>> gArea(spoly1)
>> gArea(gIntersection(spAll, spoly1, byid=TRUE), byid=TRUE)/gArea(spoly1)
>>
>> but note the warnings. You'll need to project both objects to get a proper measure.
>>
>> Roger
>>
>>>
>>> Thanks
>>> Ross
>>>
>>>
>>>
>>>    [[alternative HTML version deleted]]
>>
>> -- 
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From rossahmed at googlemail.com  Fri Mar 29 16:32:47 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 29 Mar 2013 15:32:47 +0000
Subject: [R-sig-Geo] extract polygon
Message-ID: <CD7B649F.44DD%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130329/c5a09433/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Mar 29 17:07:27 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 29 Mar 2013 17:07:27 +0100
Subject: [R-sig-Geo] extract polygon
In-Reply-To: <CD7B649F.44DD%rossahmed@gmail.com>
References: <CD7B649F.44DD%rossahmed@gmail.com>
Message-ID: <5155BC3F.9080008@uni-muenster.de>

Ross, what you want is subsetting, not extraction.

have you tried:

newSPDF <- columbus[30,]

Reading introductory material such as
http://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf
is also a good way to learn the first steps.

Bests,


On 03/29/2013 04:32 PM, Ross Ahmed wrote:
> Lets say I have a several polygons stored in a SpatialPolygonsDataFrame
> object. Using ?columbus? in maptools as an example:
> 
> setwd(system.file("shapes", package="maptools"))
> columbus <- readShapeSpatial("columbus.shp?)
> 
> I want to extract a polygon 30 from ?columbus?, and assign it to a new
> SpatialPolygonsDataFrame object. I?ve tried?
> 
> newSPDF <- Polygons(list(columbus at polygons[[30]]), "29?)
> 
> ?but this didn?t work. How can I do this?
> 
> Thanks
> Ross
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From andreasft at gmail.com  Fri Mar 29 20:14:02 2013
From: andreasft at gmail.com (=?ISO-8859-1?Q?Andreas_For=F8_Tollefsen?=)
Date: Fri, 29 Mar 2013 20:14:02 +0100
Subject: [R-sig-Geo] McSpatial discontinued
Message-ID: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130329/be9d2c97/attachment.pl>

From Roger.Bivand at nhh.no  Fri Mar 29 21:10:18 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Mar 2013 21:10:18 +0100
Subject: [R-sig-Geo] McSpatial discontinued
In-Reply-To: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>
References: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>

On Fri, 29 Mar 2013, Andreas For? Tollefsen wrote:

> Dear r-sig-geo people,
>
> I have previously used the McSpatial package. However, according to it's 
> website it is removed from the CRAN library. Hence, it is not available 
> for R 2.15.3.
>
> Does anyone know if the project is closed down?

I do not know specifically, but CRAN policies with regard to dependency on 
non-free software (McSpatial depends on akima, which has a non-free 
license) have been been made clearer. Packages depending on akima and 
others with similar status must modify their own licenses, or split out 
the functions involved, obliging the user to opt into the non-free license 
of the upstream dependency.

You may download the source package from the CRAN package archives:

http://cran.r-project.org/src/contrib/Archive/McSpatial/

and install it from source yourself.

In this case, its author, Daniel McMillen and I are hoping that a 
replacement for akima will be an adopted Google Summer of Coding project 
if R gets enough project slots - see:

https://groups.google.com/forum/?fromgroups#!topic/gsoc-r/8ZUQCVlyodk

If/when that happens, we will have a viable alternative under a free 
license.

CRAN has to be concerned about license management, because (if one was a 
lawyer, I am not!) funded research might be seen as a commercial activity, 
as might courses for which participants pay. So many universities and 
research labs are asking for better control of the licenses of R 
contributed packages, and CRAN is trying to help to sort things out.

Hope this clarifies,

Roger

>
> Andreas
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mlt at gmx.us  Sat Mar 30 06:12:12 2013
From: mlt at gmx.us (Mikhail Titov)
Date: Sat, 30 Mar 2013 00:12:12 -0500
Subject: [R-sig-Geo] drawing order in spplot and Line width in sp maps
In-Reply-To: <44B20622.3070903@geo.uu.nl> (Edzer J. Pebesma's message of "Mon, 
	10 Jul 2006 09:47:46 +0200")
References: <44AA8B9A.7030200@sclc.ecosur.mx> <44ABB62B.5080505@geo.uu.nl>
	<44AD31A5.9080801@sclc.ecosur.mx>
	<39388.131.211.65.133.1152210792.squirrel@webmail.geo.uu.nl>
	<44AD7AB3.2040402@sclc.ecosur.mx> <44B20622.3070903@geo.uu.nl>
Message-ID: <9q07gkpmpxv.fsf@gmx.us>

Hi, All!

I know I'm excavating an old thread[1] (and top posting) but that is
exactly what bugs me.

I am surprised to see that I can't pass lwd directly to spplot's main
plot and not extra layouts. I can pass lwd to sp.polygons but not to
spplot directly :( Here is an incomplete snippet showing what I've tried

,----[ How do I change line width of shp polygons supplied to spplot? ]
| spplot(shp, names(d), col="grey80", lwd=5, cuts=5,
| #        par.settings = simpleTheme(lwd=3),
|       par.settings = list(superpose.polygon = list(lwd=5)),
|        panel = function(...) {
| #          panel.polygonsplot(..., lwd=3)
|          panel.polygonsplot(...)
|          sp.panel.layout(list(l.wshd, l.streams, l.struc))
|          if (panel.number()==1) {
|            sp.panel.layout(list(l.north, l.scale.bar, l.scale.text))
|          }
|        },
|        colorkey = list(
|          labels=list(
|            at = labelat,
|            labels = labeltext
|            )
|          ),
|        names.attr=droplevels(unique(rest$case)),
|        col.regions=rev(greens(14, .6))[-1])#rev(heat.colors(100)))
`----

I see that lwd for my layouts apply well, e.g., for l.wshd & l.streams
in the example above. However I can't seem to figure out how to make shp
lines thinner. I do have several variables to plot on a few panels.

Did I miss something?

P.S. Not quite related question but how does levelplot (?) estimates
color scale labels? If I leave colorkey alone, I get misplaced labels
provided cuts=5. For now, I do something like

,----[ Dirty fix for ticks & label alignment ]
| dd.rng <- range(unlist(dd), finite=TRUE)
| delta <- diff(dd.rng)
| labelat <- seq(dd.rng[1] - delta*.07, dd.rng[2] + delta*.07, length.out=7)
| labeltext <- format(exp(labelat), digits=2)
`----

I feel like there is almost a standard function for that but I can't
recall its name. Would you mind reminding if there is any?

On Mon, Jul 10, 2006 at  2:47 AM, "Edzer J. Pebesma" <e.pebesma at geo.uu.nl> wrote:
> Duncan Golicher wrote:
>> Great. Thanks so much. It was obvious really.
>> You also seem to have come up with one solution to the line width 
>> question asked a couple of days ago,  as this works.
>>
>> spplot(chisgrid, "dem", panel = function(x,y, ...){
>>     panel.gridplot(x,y,...)
>>     sp.polygons(municipios, col=1,fill=0,lwd=3,lty=2)
>>     })
>>
>>
>>   
> Yes, or:
>
> spplot(chisgrid, "dem", sp.layout=list("sp.polygons", municipios, col=1, 
> fill=0, lwd=3, lty=2, first=F))


Footnotes: 
[1]  https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001174.html

-- 
Mikhail


From lborger at cebc.cnrs.fr  Sat Mar 30 12:27:47 2013
From: lborger at cebc.cnrs.fr (lborger)
Date: Sat, 30 Mar 2013 12:27:47 +0100
Subject: [R-sig-Geo] paques
In-Reply-To: <mailman.13.1364641203.25837.r-sig-geo@r-project.org>
References: <mailman.13.1364641203.25837.r-sig-geo@r-project.org>
Message-ID: <WC20130330112747.730483@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130330/9edf254b/attachment.pl>

From hi_ono2001 at ybb.ne.jp  Sat Mar 30 14:07:48 2013
From: hi_ono2001 at ybb.ne.jp (hi_ono2001 at ybb.ne.jp)
Date: Sat, 30 Mar 2013 22:07:48 +0900 (JST)
Subject: [R-sig-Geo] McSpatial discontinued
In-Reply-To: <alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>
Message-ID: <107964.43136.qm@web200202.mail.kks.yahoo.co.jp>

Hello.

 This package's binaries are available from following site.

  http://cran.cermin.lipi.go.id/web/packages/McSpatial/index.html


 FYI


--- On Sat, 2013/3/30, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 29 Mar 2013, Andreas For? Tollefsen wrote:
> 
> > Dear r-sig-geo people,
> > 
> > I have previously used the McSpatial package. However, according to it's website it is removed from the CRAN library. Hence, it is not available for R 2.15.3.
> > 
> > Does anyone know if the project is closed down?
> 
> I do not know specifically, but CRAN policies with regard to dependency on non-free software (McSpatial depends on akima, which has a non-free license) have been been made clearer. Packages depending on akima and others with similar status must modify their own licenses, or split out the functions involved, obliging the user to opt into the non-free license of the upstream dependency.
> 
> You may download the source package from the CRAN package archives:
> 
> http://cran.r-project.org/src/contrib/Archive/McSpatial/
> 
> and install it from source yourself.
> 
> In this case, its author, Daniel McMillen and I are hoping that a replacement for akima will be an adopted Google Summer of Coding project if R gets enough project slots - see:
> 
> https://groups.google.com/forum/?fromgroups#!topic/gsoc-r/8ZUQCVlyodk
> 
> If/when that happens, we will have a viable alternative under a free license.
> 
> CRAN has to be concerned about license management, because (if one was a lawyer, I am not!) funded research might be seen as a commercial activity, as might courses for which participants pay. So many universities and research labs are asking for better control of the licenses of R contributed packages, and CRAN is trying to help to sort things out.
> 
> Hope this clarifies,
> 
> Roger
> 
> > 
> > Andreas
> > 
> > ??? [[alternative HTML version deleted]]
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Sat Mar 30 14:35:41 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 30 Mar 2013 14:35:41 +0100
Subject: [R-sig-Geo] drawing order in spplot and Line width in sp maps
In-Reply-To: <9q07gkpmpxv.fsf@gmx.us>
References: <44AA8B9A.7030200@sclc.ecosur.mx> <44ABB62B.5080505@geo.uu.nl>
	<44AD31A5.9080801@sclc.ecosur.mx>
	<39388.131.211.65.133.1152210792.squirrel@webmail.geo.uu.nl>
	<44AD7AB3.2040402@sclc.ecosur.mx> <44B20622.3070903@geo.uu.nl>
	<9q07gkpmpxv.fsf@gmx.us>
Message-ID: <5156EA2D.8090302@uni-muenster.de>

Thanks Mikhail,

lwd seems to work if you preceed the spplot command with a

set_Polypath(FALSE)

I just committed a change to sp on r-forge that makes it work too
without setting this command.

On 03/30/2013 06:12 AM, Mikhail Titov wrote:
> Hi, All!
> 
> I know I'm excavating an old thread[1] (and top posting) but that is
> exactly what bugs me.
> 
> I am surprised to see that I can't pass lwd directly to spplot's main
> plot and not extra layouts. I can pass lwd to sp.polygons but not to
> spplot directly :( Here is an incomplete snippet showing what I've tried
> 
> ,----[ How do I change line width of shp polygons supplied to spplot? ]
> | spplot(shp, names(d), col="grey80", lwd=5, cuts=5,
> | #        par.settings = simpleTheme(lwd=3),
> |       par.settings = list(superpose.polygon = list(lwd=5)),
> |        panel = function(...) {
> | #          panel.polygonsplot(..., lwd=3)
> |          panel.polygonsplot(...)
> |          sp.panel.layout(list(l.wshd, l.streams, l.struc))
> |          if (panel.number()==1) {
> |            sp.panel.layout(list(l.north, l.scale.bar, l.scale.text))
> |          }
> |        },
> |        colorkey = list(
> |          labels=list(
> |            at = labelat,
> |            labels = labeltext
> |            )
> |          ),
> |        names.attr=droplevels(unique(rest$case)),
> |        col.regions=rev(greens(14, .6))[-1])#rev(heat.colors(100)))
> `----
> 
> I see that lwd for my layouts apply well, e.g., for l.wshd & l.streams
> in the example above. However I can't seem to figure out how to make shp
> lines thinner. I do have several variables to plot on a few panels.
> 
> Did I miss something?
> 
> P.S. Not quite related question but how does levelplot (?) estimates
> color scale labels? If I leave colorkey alone, I get misplaced labels
> provided cuts=5. For now, I do something like
> 
> ,----[ Dirty fix for ticks & label alignment ]
> | dd.rng <- range(unlist(dd), finite=TRUE)
> | delta <- diff(dd.rng)
> | labelat <- seq(dd.rng[1] - delta*.07, dd.rng[2] + delta*.07, length.out=7)
> | labeltext <- format(exp(labelat), digits=2)
> `----
> 
> I feel like there is almost a standard function for that but I can't
> recall its name. Would you mind reminding if there is any?
> 
> On Mon, Jul 10, 2006 at  2:47 AM, "Edzer J. Pebesma" <e.pebesma at geo.uu.nl> wrote:
>> Duncan Golicher wrote:
>>> Great. Thanks so much. It was obvious really.
>>> You also seem to have come up with one solution to the line width 
>>> question asked a couple of days ago,  as this works.
>>>
>>> spplot(chisgrid, "dem", panel = function(x,y, ...){
>>>     panel.gridplot(x,y,...)
>>>     sp.polygons(municipios, col=1,fill=0,lwd=3,lty=2)
>>>     })
>>>
>>>
>>>   
>> Yes, or:
>>
>> spplot(chisgrid, "dem", sp.layout=list("sp.polygons", municipios, col=1, 
>> fill=0, lwd=3, lty=2, first=F))
> 
> 
> Footnotes: 
> [1]  https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001174.html
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tea3rd at gmail.com  Sat Mar 30 14:54:38 2013
From: tea3rd at gmail.com (Thomas Adams)
Date: Sat, 30 Mar 2013 09:54:38 -0400
Subject: [R-sig-Geo] McSpatial discontinued
In-Reply-To: <alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>
References: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>
	<alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>
Message-ID: <CAGxgkWje-CXOxCXjobBACOdQUeZ_=UaE+zTTuV=gAJpYtDOJrw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130330/61bcca61/attachment.pl>

From Roger.Bivand at nhh.no  Sat Mar 30 18:42:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 30 Mar 2013 18:42:41 +0100
Subject: [R-sig-Geo] McSpatial discontinued
In-Reply-To: <CAGxgkWje-CXOxCXjobBACOdQUeZ_=UaE+zTTuV=gAJpYtDOJrw@mail.gmail.com>
References: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>
	<alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>
	<CAGxgkWje-CXOxCXjobBACOdQUeZ_=UaE+zTTuV=gAJpYtDOJrw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1303301836460.28684@reclus.nhh.no>

On Sat, 30 Mar 2013, Thomas Adams wrote:

> Roger,
>
> I don't understand; since akima is freely available for download (and other
> packages use akima) from CRAN, how does this licensing work? Are the
> developers using akima in their packages paying a fee to the akima
> developer? Just curious...

If you read:

https://groups.google.com/forum/?fromgroups#!topic/gsoc-r/8ZUQCVlyodk

and the link to the ACM license, it should be clear, for non-commercial 
use, the end user is not encumbered, but commercial use as defined 
in that license requires permission. Someone downloading a CRAN package 
which depends on akima, could find themselves in breach of this 
stipulation unawares. Changes on CRAN aim to ensure that no user should be 
able to do this without having "opted in", hence the tightening of 
policies with regard to packages like akima.

Hope this clarifies,

Roger

>
> Thank you,
> Tom
>
>
> On Fri, Mar 29, 2013 at 4:10 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 29 Mar 2013, Andreas For? Tollefsen wrote:
>>
>>  Dear r-sig-geo people,
>>>
>>> I have previously used the McSpatial package. However, according to it's
>>> website it is removed from the CRAN library. Hence, it is not available for
>>> R 2.15.3.
>>>
>>> Does anyone know if the project is closed down?
>>>
>>
>> I do not know specifically, but CRAN policies with regard to dependency on
>> non-free software (McSpatial depends on akima, which has a non-free
>> license) have been been made clearer. Packages depending on akima and
>> others with similar status must modify their own licenses, or split out the
>> functions involved, obliging the user to opt into the non-free license of
>> the upstream dependency.
>>
>> You may download the source package from the CRAN package archives:
>>
>> http://cran.r-project.org/src/**contrib/Archive/McSpatial/<http://cran.r-project.org/src/contrib/Archive/McSpatial/>
>>
>> and install it from source yourself.
>>
>> In this case, its author, Daniel McMillen and I are hoping that a
>> replacement for akima will be an adopted Google Summer of Coding project if
>> R gets enough project slots - see:
>>
>> https://groups.google.com/**forum/?fromgroups#!topic/gsoc-**r/8ZUQCVlyodk<https://groups.google.com/forum/?fromgroups#!topic/gsoc-r/8ZUQCVlyodk>
>>
>> If/when that happens, we will have a viable alternative under a free
>> license.
>>
>> CRAN has to be concerned about license management, because (if one was a
>> lawyer, I am not!) funded research might be seen as a commercial activity,
>> as might courses for which participants pay. So many universities and
>> research labs are asking for better control of the licenses of R
>> contributed packages, and CRAN is trying to help to sort things out.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>
>>
>>> Andreas
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sat Mar 30 18:43:53 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 30 Mar 2013 18:43:53 +0100
Subject: [R-sig-Geo] BUG in set.pluginOption() in spGRASS6
In-Reply-To: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>
References: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1303301843150.28684@reclus.nhh.no>

On Fri, 29 Mar 2013, Rainer M Krug wrote:

> Hi
>
> using spgrass6_0.7-15 on Ubuntu, there is an error in the function
> set.pluginOption() as it always raises an error "logical argument required".
>
> The Check
>
> if (!is.logical(value) || !is.null(value)) stop("logical argument required")
>
> always returns TRUE and therefore always raises the error.

Please try the recent commit to R-forge, spgrass6 module, rspatial 
project.

Roger

>
> Cheers,
>
> Rainer
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tea3rd at gmail.com  Sat Mar 30 19:25:58 2013
From: tea3rd at gmail.com (Thomas Adams)
Date: Sat, 30 Mar 2013 14:25:58 -0400
Subject: [R-sig-Geo] McSpatial discontinued
In-Reply-To: <alpine.LRH.2.03.1303301836460.28684@reclus.nhh.no>
References: <CAGMz7DnGAKX=u3ohqWvit4w3=LDCCQhbAPyei0f7Bu-PqLb8DA@mail.gmail.com>
	<alpine.LRH.2.03.1303292059050.25465@reclus.nhh.no>
	<CAGxgkWje-CXOxCXjobBACOdQUeZ_=UaE+zTTuV=gAJpYtDOJrw@mail.gmail.com>
	<alpine.LRH.2.03.1303301836460.28684@reclus.nhh.no>
Message-ID: <CAGxgkWi-mJzacVf110hD92kiRWH-FJ4Jz4x+Uew-4b4+OELUiw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130330/855b66d2/attachment.pl>

From mlt at gmx.us  Sat Mar 30 21:43:43 2013
From: mlt at gmx.us (Mikhail Titov)
Date: Sat, 30 Mar 2013 15:43:43 -0500
Subject: [R-sig-Geo] drawing order in spplot and Line width in sp maps
In-Reply-To: <5156EA2D.8090302@uni-muenster.de> (Edzer Pebesma's message of
	"Sat, 30 Mar 2013 14:35:41 +0100")
References: <44AA8B9A.7030200@sclc.ecosur.mx> <44ABB62B.5080505@geo.uu.nl>
	<44AD31A5.9080801@sclc.ecosur.mx>
	<39388.131.211.65.133.1152210792.squirrel@webmail.geo.uu.nl>
	<44AD7AB3.2040402@sclc.ecosur.mx> <44B20622.3070903@geo.uu.nl>
	<9q07gkpmpxv.fsf@gmx.us> <5156EA2D.8090302@uni-muenster.de>
Message-ID: <9q0r4iwlitc.fsf@gmx.us>

On Sat, Mar 30, 2013 at  8:35 AM, Edzer Pebesma <edzer.pebesma at uni-muenster.de> wrote:
> Thanks Mikhail,
>
> lwd seems to work if you preceed the spplot command with a
>
> set_Polypath(FALSE)

Thank you for making these wonderful packages!

This did the trick! I would never ever guess what was missing...

However this breaks colors for _sp.polygons_ if several were used :(
E.g. in my example I had

,----[ Only first color is effective with set_Polypath(FALSE) ]
| l.wshd <- list("sp.polygons", bdry, col=c("magenta", "blue"), lwd=1.5)
`----

So I had to have a logical block in panel function

,----[ snippet from a function supplied as panel ]
|          set_Polypath(FALSE)
|          panel.polygonsplot(...)
|          set_Polypath(TRUE)
|          sp.panel.layout(list(l.wshd, l.streams, l.struc))
`----

I guess it is hard to hit 2 birds with 1 stone...

> I just committed a change to sp on r-forge that makes it work too
> without setting this command.

I'll check it out once it propagates to a binary package @CRAN.

Also I feel like that documentation is misleading a bit regarding _cuts_
saying that it is for SpatialPointsDataFrame only. It appears that it does
change # of breaks for polygon just fine.


P.S. I thought I found an answer to my question about padding when I came
across [1]. However it looks like axis.padding is not for z values...

> On 03/30/2013 06:12 AM, Mikhail Titov wrote:
>> Hi, All!
>> 
>> I know I'm excavating an old thread[1] (and top posting) but that is
>> exactly what bugs me.
>> 
>> I am surprised to see that I can't pass lwd directly to spplot's main
>> plot and not extra layouts. I can pass lwd to sp.polygons but not to
>> spplot directly :( Here is an incomplete snippet showing what I've tried
>> 
>> ,----[ How do I change line width of shp polygons supplied to spplot? ]
>> | spplot(shp, names(d), col="grey80", lwd=5, cuts=5,
>> | #        par.settings = simpleTheme(lwd=3),
>> |       par.settings = list(superpose.polygon = list(lwd=5)),
>> |        panel = function(...) {
>> | #          panel.polygonsplot(..., lwd=3)
>> |          panel.polygonsplot(...)
>> |          sp.panel.layout(list(l.wshd, l.streams, l.struc))
>> |          if (panel.number()==1) {
>> |            sp.panel.layout(list(l.north, l.scale.bar, l.scale.text))
>> |          }
>> |        },
>> |        colorkey = list(
>> |          labels=list(
>> |            at = labelat,
>> |            labels = labeltext
>> |            )
>> |          ),
>> |        names.attr=droplevels(unique(rest$case)),
>> |        col.regions=rev(greens(14, .6))[-1])#rev(heat.colors(100)))
>> `----
>> 
>> I see that lwd for my layouts apply well, e.g., for l.wshd & l.streams
>> in the example above. However I can't seem to figure out how to make shp
>> lines thinner. I do have several variables to plot on a few panels.
>> 
>> Did I miss something?
>> 
>> P.S. Not quite related question but how does levelplot (?) estimates
>> color scale labels? If I leave colorkey alone, I get misplaced labels
>> provided cuts=5. For now, I do something like
>> 
>> ,----[ Dirty fix for ticks & label alignment ]
>> | dd.rng <- range(unlist(dd), finite=TRUE)
>> | delta <- diff(dd.rng)
>> | labelat <- seq(dd.rng[1] - delta*.07, dd.rng[2] + delta*.07, length.out=7)
>> | labeltext <- format(exp(labelat), digits=2)
>> `----
>> 
>> I feel like there is almost a standard function for that but I can't
>> recall its name. Would you mind reminding if there is any?

Footnotes: 
[1]  https://r-forge.r-project.org/scm/viewvc.php/pkg/R/levelplot.R?view=markup&root=lattice

-- 
Mikhail


