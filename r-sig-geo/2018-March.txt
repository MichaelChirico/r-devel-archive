From martin.hulenyi at vlada.gov.sk  Mon Mar  5 16:53:59 2018
From: martin.hulenyi at vlada.gov.sk (=?iso-8859-2?Q?Hul=E9nyi_Martin?=)
Date: Mon, 5 Mar 2018 15:53:59 +0000
Subject: [R-sig-Geo] Problem with splm
Message-ID: <cb5fc9e5731f4df8bba6232cdbcebcbd@UVEX2.uvsr.sk>

Hello,

when I run the spatial 2sls from the splm package using the spgm command, I get an error that the panel is unbalanced, even though it is balanced: The data
str(pdata.natura1)
Classes 'pdata.frame' and 'data.frame': 4680 obs. of  63 variables
The spatial weight matrix (inverse distance):
    str(dm1.lw)
    List of 3
     $ style     : chr "W"
     $ neighbours:List of 260
     $ weights   :List of 260
The conducted regression:
spgr01<-spgm(rgrowthpc~lrgdp0pc+lefpayr,
             data=pdata.natura1, listw=dm1.lw,
             model="within", lag=TRUE, spatial.error= TRUE,
             endog=~lefpayr, instruments=~area_prop,
             method="w2sls"
             )
Error in spsarargm(formula = formula, data = data, index = index, listw = listw,  :
  Estimation method unavailable for unbalanced panels
However:
is.pbalanced(pdata.natura1)
[1] TRUE
Can anyone please tell me where is the mistake?

Best regards,

Martin
[eco.jpg]       Pred vytla?en?m tohto mailu zv?te pros?m vplyv na ?ivotn? prostredie. ?akujeme.
Please consider the environment before printing this e-mail. Thanks

	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Mar  7 17:14:17 2018
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 7 Mar 2018 16:14:17 +0000
Subject: [R-sig-Geo] How to identify spatially varying regression
 coefficients in GWmodel?
Message-ID: <YQXPR0101MB1397919EC22D970F23AE2FCD90D80@YQXPR0101MB1397.CANPRD01.PROD.OUTLOOK.COM>

Dear all,


I am looking to use gwr.mixed in the GWmodel R package.


I want to identify which of my independent (explanatory) coefficients are:

i) Global (i.e., Fixed) and ii) Spatially Varying (i.e., Local).


Is there anyway to do a statistical test via GWmodel to determine which of my variables are global or locally varying ?


thank you

Joe.



	[[alternative HTML version deleted]]


From ashimkapoor at gmail.com  Fri Mar  9 12:30:57 2018
From: ashimkapoor at gmail.com (Ashim Kapoor)
Date: Fri, 9 Mar 2018 17:00:57 +0530
Subject: [R-sig-Geo] Making a leaflet visualization, using 2 shapefiles
Message-ID: <CAC8=1eo_7_XAE3zZknh1ynLJW_5UAEhieKOa1AEanL+naF9-aQ@mail.gmail.com>

Dear all,

Here is what I want to do. I have regions in a country and subregions
within those regions. I need to make a leaflet visualization so that when I
hover over a point in the map, 2 things should happen :

1. The entire region boundary should be highlighted.
2. The tooltip should show the name of the subregion and the region.

I have 2 shapefiles,one for region and one for subregion. I can use one at
a time but requirements need inputs from both the shapefiles.

I asked this query,along with a minimal working example here :

https://stackoverflow.com/questions/48924514/using-data-from-2-shapefiles-with-leaflet-in-r?noredirect=1#comment84855712_48924514

I did not receive any replies  so I am asking this query once again here.

Best Regards,
Ashim.

	[[alternative HTML version deleted]]


From David.Hine at landandwater.com.au  Sun Mar 11 03:26:29 2018
From: David.Hine at landandwater.com.au (David Hine)
Date: Sun, 11 Mar 2018 12:26:29 +1000
Subject: [R-sig-Geo] Making a leaflet visualization, using 2 shapefiles
In-Reply-To: <CAC8=1eo_7_XAE3zZknh1ynLJW_5UAEhieKOa1AEanL+naF9-aQ@mail.gmail.com>
References: <CAC8=1eo_7_XAE3zZknh1ynLJW_5UAEhieKOa1AEanL+naF9-aQ@mail.gmail.com>
Message-ID: <d5a0219d-1436-2bb0-bc3a-ca77977533b2@landandwater.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180311/f2205354/attachment.html>

From ashimkapoor at gmail.com  Mon Mar 12 09:17:28 2018
From: ashimkapoor at gmail.com (Ashim Kapoor)
Date: Mon, 12 Mar 2018 13:47:28 +0530
Subject: [R-sig-Geo] Making a leaflet visualization, using 2 shapefiles
In-Reply-To: <d5a0219d-1436-2bb0-bc3a-ca77977533b2@landandwater.com.au>
References: <CAC8=1eo_7_XAE3zZknh1ynLJW_5UAEhieKOa1AEanL+naF9-aQ@mail.gmail.com>
 <d5a0219d-1436-2bb0-bc3a-ca77977533b2@landandwater.com.au>
Message-ID: <CAC8=1equMLhcvF2AW_-zkrw5azVj3dKezKg7hXbmiooE47s1sA@mail.gmail.com>

Dear David,

Many thanks for your reply. Alright, I will take this discussion forward on
a leaflet discussion forum.

Best Regards,
Ashim



On Sun, Mar 11, 2018 at 7:56 AM, David Hine <David.Hine at landandwater.com.au>
wrote:

> Hi Ashim
>
> This is really a leaflet question. You can explore options at the leaflet
> website: http://leafletjs.com/plugins.html#markers--renderers
>
> A capable javascript developer could help you solve the problem. There are
> probably several strategies. This one might be a start:
> https://github.com/jacobtoye/Leaflet.iconlabel
>
> regards
>
> David
>
> On 9/03/2018 9:30 PM, Ashim Kapoor wrote:
>
> Dear all,
>
> Here is what I want to do. I have regions in a country and subregions
> within those regions. I need to make a leaflet visualization so that when I
> hover over a point in the map, 2 things should happen :
>
> 1. The entire region boundary should be highlighted.
> 2. The tooltip should show the name of the subregion and the region.
>
> I have 2 shapefiles,one for region and one for subregion. I can use one at
> a time but requirements need inputs from both the shapefiles.
>
> I asked this query,along with a minimal working example here :
> https://stackoverflow.com/questions/48924514/using-data-from-2-shapefiles-with-leaflet-in-r?noredirect=1#comment84855712_48924514
>
>
> I did not receive any replies  so I am asking this query once again here.
>
> Best Regards,
> Ashim.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing listR-sig-Geo at r-project.orghttps://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> --
> [image: Land and Water Management logo]
>
> * David Hine*
> Land and Water Management PL
> 29 Pacific Pde
> <https://maps.google.com/?q=29+Pacific+Pde+%0D%0A++++++++++++++++Mission+Beach,+Qld+4852+%0D%0A++++++++++++++++Australia&entry=gmail&source=g>
> Mission Beach, Qld 4852
> Australia
>
> m: 0429 886 146 +61 429 886 146
> t: (07) 4015 3470 +61 7 4015 3470
>
>
> Land and Water Management PL <http://www.landandwater.com.au>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From milujisb at gmail.com  Wed Mar 14 20:53:16 2018
From: milujisb at gmail.com (Miluji Sb)
Date: Wed, 14 Mar 2018 20:53:16 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
Message-ID: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>

Dear all,

Please forgive my inexperience with spatial downscaling. I am interested in
spatial downscaling of global temperature to grid cell. Is there a package
in R that can perform this function?

Any help/guidance will be highly appreciated.

Sincerely,

Milu

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Mar 14 21:54:55 2018
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 14 Mar 2018 20:54:55 +0000
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
Message-ID: <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>

Try ClimDown package, otherwise more generally raster function disaggregate.

Cheers

On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:

> Dear all,
>
> Please forgive my inexperience with spatial downscaling. I am interested in
> spatial downscaling of global temperature to grid cell. Is there a package
> in R that can perform this function?
>
> Any help/guidance will be highly appreciated.
>
> Sincerely,
>
> Milu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From milujisb at gmail.com  Wed Mar 14 22:15:23 2018
From: milujisb at gmail.com (Miluji Sb)
Date: Wed, 14 Mar 2018 22:15:23 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
 <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
Message-ID: <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>

Thanks again! Looking into this right now.

Sincerely,

Milu

On Wed, Mar 14, 2018 at 9:54 PM, Michael Sumner <mdsumner at gmail.com> wrote:

> Try ClimDown package, otherwise more generally raster function
> disaggregate.
>
> Cheers
>
> On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:
>
>> Dear all,
>>
>> Please forgive my inexperience with spatial downscaling. I am interested
>> in
>> spatial downscaling of global temperature to grid cell. Is there a package
>> in R that can perform this function?
>>
>> Any help/guidance will be highly appreciated.
>>
>> Sincerely,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
> Kingston Tasmania 7050 Australia
> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>
>

	[[alternative HTML version deleted]]


From bfalevlist at gmail.com  Thu Mar 15 09:34:48 2018
From: bfalevlist at gmail.com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Thu, 15 Mar 2018 09:34:48 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
 <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
 <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>
Message-ID: <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>

Dear Milu,

You can use any spatial interpolation method as statistical downscaling 
approach. See package gstat for IDW (inverse distance weighted) and 
several types of kriging. In case of temperature, you might use 
elevation data from a DEM or radiation data as auxiliary variables in 
those interpolation methods (e.g. regression kriging) that can handle 
auxiliary data.

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2018.03.14. 22:15 keltez?ssel, Miluji Sb ?rta:
> Thanks again! Looking into this right now.
>
> Sincerely,
>
> Milu
>
> On Wed, Mar 14, 2018 at 9:54 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>
>> Try ClimDown package, otherwise more generally raster function
>> disaggregate.
>>
>> Cheers
>>
>> On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:
>>
>>> Dear all,
>>>
>>> Please forgive my inexperience with spatial downscaling. I am interested
>>> in
>>> spatial downscaling of global temperature to grid cell. Is there a package
>>> in R that can perform this function?
>>>
>>> Any help/guidance will be highly appreciated.
>>>
>>> Sincerely,
>>>
>>> Milu
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> --
>> Dr. Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> 203 Channel Highway
>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>> Kingston Tasmania 7050 Australia
>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g>
>>
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tom.hengl at gmail.com  Thu Mar 15 11:52:15 2018
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Thu, 15 Mar 2018 11:52:15 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
 <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
 <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>
 <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>
Message-ID: <258f7b18-40a4-d585-1b85-a00d44481fc2@gmail.com>


For downscaling, and especially if you work with relatively smooth 
surfaces and large rasters, I recommend using gdalwarp cubicspline 
technique e.g. (http://www.gdal.org/gdalwarp.html):

gdalwarp input.tif output.tif -r "cubicspline" -tr 250 250 -co 
"COMPRESS=DEFLATE"

If you prefer to do it via R command line then either use 
system('gdalwarp ...') or consider using 
https://cran.r-project.org/web/packages/gdalUtils/

SAGA GIS also has few similar options for downscaling 
(http://www.saga-gis.org/saga_tool_doc/2.3.0/grid_tools_0.html) and is 
efficient with large rasters (it can be easily parallelized).

T. Hengl

On 03/15/2018 09:34 AM, Bede-Fazekas ?kos wrote:
> Dear Milu,
> 
> You can use any spatial interpolation method as statistical downscaling 
> approach. See package gstat for IDW (inverse distance weighted) and 
> several types of kriging. In case of temperature, you might use 
> elevation data from a DEM or radiation data as auxiliary variables in 
> those interpolation methods (e.g. regression kriging) that can handle 
> auxiliary data.
> 
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
> 
> 
> 2018.03.14. 22:15 keltez?ssel, Miluji Sb ?rta:
>> Thanks again! Looking into this right now.
>>
>> Sincerely,
>>
>> Milu
>>
>> On Wed, Mar 14, 2018 at 9:54 PM, Michael Sumner <mdsumner at gmail.com> 
>> wrote:
>>
>>> Try ClimDown package, otherwise more generally raster function
>>> disaggregate.
>>>
>>> Cheers
>>>
>>> On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:
>>>
>>>> Dear all,
>>>>
>>>> Please forgive my inexperience with spatial downscaling. I am 
>>>> interested
>>>> in
>>>> spatial downscaling of global temperature to grid cell. Is there a 
>>>> package
>>>> in R that can perform this function?
>>>>
>>>> Any help/guidance will be highly appreciated.
>>>>
>>>> Sincerely,
>>>>
>>>> Milu
>>>>
>>>> ???????? [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>> -- 
>>> Dr. Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> 203 Channel Highway
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g> 
>>>
>>> Kingston Tasmania 7050 Australia
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tasmania+7050+Australia&entry=gmail&source=g> 
>>>
>>>
>>>
>> ????[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From milujisb at gmail.com  Thu Mar 15 12:54:54 2018
From: milujisb at gmail.com (Miluji Sb)
Date: Thu, 15 Mar 2018 12:54:54 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
 <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
 <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>
 <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>
Message-ID: <CAMLwc7MfgpvVyWZ6XCGhgqEJw3y9o0SjLR6nUU+2tX+=F=q+5w@mail.gmail.com>

 Thank you for your replies. I will try with the packages you mentioned -
they look very useful, I guess my issue is that all I have a vector of
global mean. Thanks again!

Sincerely,

Milu


On Thu, Mar 15, 2018 at 9:34 AM, Bede-Fazekas ?kos <bfalevlist at gmail.com>
wrote:

> Dear Milu,
>
> You can use any spatial interpolation method as statistical downscaling
> approach. See package gstat for IDW (inverse distance weighted) and several
> types of kriging. In case of temperature, you might use elevation data from
> a DEM or radiation data as auxiliary variables in those interpolation
> methods (e.g. regression kriging) that can handle auxiliary data.
>
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
>
>
>
> 2018.03.14. 22:15 keltez?ssel, Miluji Sb ?rta:
>
>> Thanks again! Looking into this right now.
>>
>> Sincerely,
>>
>> Milu
>>
>> On Wed, Mar 14, 2018 at 9:54 PM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>>
>> Try ClimDown package, otherwise more generally raster function
>>> disaggregate.
>>>
>>> Cheers
>>>
>>> On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:
>>>
>>> Dear all,
>>>>
>>>> Please forgive my inexperience with spatial downscaling. I am interested
>>>> in
>>>> spatial downscaling of global temperature to grid cell. Is there a
>>>> package
>>>> in R that can perform this function?
>>>>
>>>> Any help/guidance will be highly appreciated.
>>>>
>>>> Sincerely,
>>>>
>>>> Milu
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> --
>>> Dr. Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> 203 Channel Highway
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tas
>>> mania+7050+Australia&entry=gmail&source=g>
>>> Kingston Tasmania 7050 Australia
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tas
>>> mania+7050+Australia&entry=gmail&source=g>
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jwism002 at odu.edu  Thu Mar 15 15:56:12 2018
From: jwism002 at odu.edu (Jeri Wisman)
Date: Thu, 15 Mar 2018 10:56:12 -0400
Subject: [R-sig-Geo] Kernel density code issue
Message-ID: <CACPuJ4m1vCUBuFLfca_4r_b1dK2Lemah2yXCwebiVxmZ2bHvqw@mail.gmail.com>

Hi all -

I am currently working on a code to run a kernel density estimation using
13 individual tracking data (csv files) that was collected on common tern
seabirds in eastern VA using GPS tags. I have gotten the code to create
individual KUDs for each tag, but am having issues combining the 13 to
create a cumulative KUD. Any suggestions? Current code is attached.

Cheers,
*Jeri Wisman* | Masters Candidate
Old Dominion University
Department of Biological Sciences
Mills Godwin Building, Room 312
Norfolk VA 23529 USA

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180315/00545f53/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: COTE_2017_KernelDensity_code_JLW.R
Type: application/octet-stream
Size: 2983 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180315/00545f53/attachment.obj>

From karsten at terragis.net  Thu Mar 15 15:57:31 2018
From: karsten at terragis.net (karsten)
Date: Thu, 15 Mar 2018 15:57:31 +0100
Subject: [R-sig-Geo] Spatial Downscaling in R
In-Reply-To: <CAMLwc7MfgpvVyWZ6XCGhgqEJw3y9o0SjLR6nUU+2tX+=F=q+5w@mail.gmail.com>
References: <CAMLwc7Py9=xdx2+Kewo1zahdVnaBfYU+Rs_F+0boGFxWFHv1sA@mail.gmail.com>
 <CAAcGz986k6MqgTjT1vbGzeur7PRfLuGOQ5ZG-D7ch3AbC2dkKQ@mail.gmail.com>
 <CAMLwc7Ntdo7UMKer0g8ndcwaRhfQmWztVVjo9HkpZ9Px7eZKqA@mail.gmail.com>
 <6b341f82-2aad-e2c3-c3ba-c6ff67af4b71@gmail.com>
 <CAMLwc7MfgpvVyWZ6XCGhgqEJw3y9o0SjLR6nUU+2tX+=F=q+5w@mail.gmail.com>
Message-ID: <C2DB4A3E41C742A383ADDFD02B74BCC2@terragispc>

Hi Milu,

if you meant you are lacking raster data sources for temperatures or
rainfall here are some I used extensively for agricultural research projects
in Africa

Rainfall (37 years of global modelled data): CHIRPS at about 5km resolution
http://chg.geog.ucsb.edu/data/index.html
ftp://ftp.chg.ucsb.edu/pub/org/chg/products/CHIRPS-2.0/

Temperature (not Global but has Africa e.g.) from FEWS
https://earlywarning.usgs.gov/fews -> data download (data since 2002
and more 

also look at http://www.ccafs-climate.org/
and http://www.ccafs-climate.org/data_spatial_downscaling/ 

Cheers
Karsten


-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Miluji
Sb
Sent: Donnerstag, 15. M?rz 2018 12:55
To: Bede-Fazekas ?kos; tom.hengl at gmail.com
Cc: R-sig-geo mailing list
Subject: Re: [R-sig-Geo] Spatial Downscaling in R

 Thank you for your replies. I will try with the packages you mentioned -
they look very useful, I guess my issue is that all I have a vector of
global mean. Thanks again!

Sincerely,

Milu


On Thu, Mar 15, 2018 at 9:34 AM, Bede-Fazekas ?kos <bfalevlist at gmail.com>
wrote:

> Dear Milu,
>
> You can use any spatial interpolation method as statistical 
> downscaling approach. See package gstat for IDW (inverse distance 
> weighted) and several types of kriging. In case of temperature, you 
> might use elevation data from a DEM or radiation data as auxiliary 
> variables in those interpolation methods (e.g. regression kriging) that
can handle auxiliary data.
>
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
>
>
>
> 2018.03.14. 22:15 keltez?ssel, Miluji Sb ?rta:
>
>> Thanks again! Looking into this right now.
>>
>> Sincerely,
>>
>> Milu
>>
>> On Wed, Mar 14, 2018 at 9:54 PM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>>
>> Try ClimDown package, otherwise more generally raster function
>>> disaggregate.
>>>
>>> Cheers
>>>
>>> On Thu, 15 Mar 2018, 06:53 Miluji Sb, <milujisb at gmail.com> wrote:
>>>
>>> Dear all,
>>>>
>>>> Please forgive my inexperience with spatial downscaling. I am 
>>>> interested in spatial downscaling of global temperature to grid 
>>>> cell. Is there a package in R that can perform this function?
>>>>
>>>> Any help/guidance will be highly appreciated.
>>>>
>>>> Sincerely,
>>>>
>>>> Milu
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> --
>>> Dr. Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> 203 Channel Highway
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tas
>>> mania+7050+Australia&entry=gmail&source=g>
>>> Kingston Tasmania 7050 Australia
>>> <https://maps.google.com/?q=203+Channel+Highway+Kingston+Tas
>>> mania+7050+Australia&entry=gmail&source=g>
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sat Mar 17 18:35:22 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Mar 2018 18:35:22 +0100
Subject: [R-sig-Geo] rgdal 1.2-18 on CRAN - does PROJ.4 5.0.0 work for you?
Message-ID: <alpine.LFD.2.21.1803171830240.8761@reclus.nhh.no>

The latest version of rgdal is on CRAN, and I'd like to ask those users 
who are installing from source and using PROJ.4 5.0.0 to pay particular 
attention to any issues arising. Please do this as a matter of urgency, as 
we have a small window of four days before the PROJ.4 5.0.1 bugfix release 
reaches RC.

Hoping for input (even messages that everything works),

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From public at careaga.net  Sun Mar 18 18:57:06 2018
From: public at careaga.net (Richard Careaga)
Date: Sun, 18 Mar 2018 18:57:06 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 175, Issue 8
In-Reply-To: <mailman.26401.3.1521370801.3635.r-sig-geo@r-project.org>
References: <mailman.26401.3.1521370801.3635.r-sig-geo@r-project.org>
Message-ID: <CAKQZOLUL6pgcKSqRYO3MXimGTP9HhThQME0C6ygD3+eREz5nZg@mail.gmail.com>

Mac High Sierra users will need to debug installation of PROJ.4 5.0.0 from
source first (work in progress <g>). Please tell me that latest rgdal will
work with proj.4 4.9.3, I hope?



On March 18, 2018 at 4:01:44 AM, r-sig-geo-request at r-project.org (
r-sig-geo-request at r-project.org) wrote:

PROJ.4 5.0.0

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Sun Mar 18 19:29:37 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 18 Mar 2018 19:29:37 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 175, Issue 8
In-Reply-To: <CAKQZOLUL6pgcKSqRYO3MXimGTP9HhThQME0C6ygD3+eREz5nZg@mail.gmail.com>
References: <mailman.26401.3.1521370801.3635.r-sig-geo@r-project.org>
 <CAKQZOLUL6pgcKSqRYO3MXimGTP9HhThQME0C6ygD3+eREz5nZg@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1803181924550.10851@reclus.nhh.no>

On Sun, 18 Mar 2018, Richard Careaga wrote:

> Mac High Sierra users will need to debug installation of PROJ.4 5.0.0 from
> source first (work in progress <g>). Please tell me that latest rgdal will
> work with proj.4 4.9.3, I hope?
>

Yes, backward compatibility continues to be important, and Windows and OSX 
CRAN binaries are < 5.0.0. However, in a year or so, we may be ready to 
switch, and then no further maintenance will be done for the < 5.0.* 
code. It will entail moving away from rgdal::spTransform() and 
rgdal::project() as they are now structured, and rather using a fully 
qualified pipeline inside PROJ, without first transforming to WGS84 then 
on to the target representation.

Roger

>
>
> On March 18, 2018 at 4:01:44 AM, r-sig-geo-request at r-project.org (
> r-sig-geo-request at r-project.org) wrote:
>
> PROJ.4 5.0.0
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From chino_tones at hotmail.com  Mon Mar 19 03:05:57 2018
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Mon, 19 Mar 2018 02:05:57 +0000
Subject: [R-sig-Geo] predict for spatial filtering in spdep
Message-ID: <YQXPR0101MB1397B88734855B5D7F20C02C90D40@YQXPR0101MB1397.CANPRD01.PROD.OUTLOOK.COM>

Dear all,


In the spdep  package, there is an eigenvector spatial filtering function (SpatialFiltering).

In the package document, it can be used with Linear regression (lm) to remove

spatial autocorrelation by adding it to the lm formula as a covariate.


The example does not provide though, how to apply this Spatial filtering regression (sfr) on

unseen (hold-out) sample data. I'd like to predict on 'test' data using the fitted sfr model.

Any insight is welcome.


chris


	[[alternative HTML version deleted]]


From kenneth at kidscodejeunesse.org  Mon Mar 19 16:34:33 2018
From: kenneth at kidscodejeunesse.org (Kenneth Dyson)
Date: Mon, 19 Mar 2018 11:34:33 -0400
Subject: [R-sig-Geo] Labelling a fortified GADM map plotted with ggplot and
 geom_map
Message-ID: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>

Reffered here from the?R-Help mailing list:

I am having trouble getting data labels to display over the provinces in a GADM map of Canada.
Specifically, I need the variable "Number" from the data set "by_province", grouped by "region", to appear on the corresponding regions of the map.

The data set "by_province" looks like this:

long? ? ? lat? ? ? ? ? order? hole piece ? ? ? ? ? ? ? ? ? region ? ? ? ? ? ? ? ?group ? ? Number
-110.37074 60.00006 ? ? ? 1 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132
-110.36250 60.00006 ? ? ? 2 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ??Alberta.1? ? 132
-110.35103 60.00006 ? ? ? 3 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132

and the data set "tract" is the map data without the "Number" variable.

I looked into working this out from by researching the geom_map function here: http://ggplot2.tidyverse.org/reference/geom_map.html

my code looks like this:
# get the raw map data
can_map <- getData('GADM', country = "CAN", level = 1) # download map level with provinces
tract <- fortify(can_map, region = "NAME_1") # transforms data from shapefiles into a dataframe that ggplot can understand, from http://www.kevjohnson.org/making-maps-in-r/

# create subsets of the kcj data if needed, for example by year
kids_data_2017 <- subset(kids_data, year == 2017) # data for the year 2017
kids_data_2018 <- subset(kids_data, year == 2018) # data for the year 2018

# extract the needed data
kids_province_data <- data.table::data.table(kids_data_2017$Province_Territory__c, kids_data_2017$Number_of_kids__c)
names(kids_province_data)[1] <- "Province"
names(kids_province_data)[2] <- "Number"

# sum the data by province
kids_province_sums <- aggregate(.~Province, data = kids_province_data, sum)

# join the data to the map
names(tract)[6] <- "region"
names(kids_province_sums)[1] <- "region"
by_province <- left_join(tract, kids_province_sums)

# create the data map
kids_map <- ggplot(by_province, aes(map_id = region)) +? ? ? ? ? ? ? #plots the map in by_province separating by region
?? ? ? ? ? geom_map(aes(fill = Number), ? ? ? ? ? ? ? ? ? ? ? ? ? ? #generates aestheticsa for the plot
? ? ? ? ? ? ? ? ? ? map = tract,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #takes the data from tract
? ? ? ? ? ? ? ? ? ? color = "#ffffff",? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #makes the color of the borders between regions white
? ? ? ? ? ? ? ? ? ? size = 0.15) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the thickness of the boarder lines
?? ? ? ? ? coord_map("polyconic") + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the coordinates to polyconic (rounded lat and long)
?? ? ? ? ? scale_fill_gradient(name = "Children Reached", ? ? ? ? ? #sets the gradient of the value scale: names the scale
?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? low = grey_2,? ? ? ? ? ? ? ? ? ? ? ? ? ? #color of the low end
?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? high = orange_1) + ? ? ? ? ? ? ? ? ? ? ? #color of the high end
?? ? ? ? ? expand_limits(x = tract$long,? ? ? ? ? ? ? ? ? ? ? ? ? ? #ensure limits include all values for all plots
?? ? ? ? ? ? ? ? ? ? ? ? y = tract$lat) +
?? ? ? ? ? labs(x = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #add labels, no x title
? ? ? ? ? ? ? ? y = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #no y title
? ? ? ? ? ? ? ? title = "Number of Children Reached by Province", ? ? ? #map title
? ? ? ? ? ? ? ? subtitle = "2017") +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #map subtitle
?? ? ? ? ? geom_text(data = by_province,? ? ? ? ? ? ? ? ? ? ? ? ? ? #add a text layer
?? ? ? ? ? ? ? ? ? ? aes(long,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #aethetics for the text, x axis
?? ? ? ? ? ? ? ? ? ? ? ? lat, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #y axis
?? ? ? ? ? ? ? ? ? ? ? ? label = Number,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #the value to display
?? ? ? ? ? ? ? ? ? ? ? ? size=3)) + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #size of the text
?? ? ? ? ? theme(axis.ticks = element_blank(),? ? ? ? ? ? ? ? ? ? ? #theme of the graph, no axis ticks
?? ? ? ? ? ? ? ? axis.text = element_blank(), ? ? ? ? ? ? ? ? ? ? ? ? ? #no axis text
?? ? ? ? ? ? ? ? panel.background = element_blank(),? ? ? ? ? ? ? ? ? ? #blank background
?? ? ? ? ? ? ? ? panel.border = element_blank())? ? ? ? ? ? ? ? ? ? ? ? #blank border

# save as png
ggsave(kids_map, file = "kids_map.png", width = 6, height = 4.5, type = "cairo-png?)


I have asked this question on stack overflow, and was refered to this answer:
https://stackoverflow.com/questions/9441436/ggplot-centered-names-on-a-map

The solution there did not fix my problem, though it did get me closer.
The solution on that post is using a single vector of labels.

My post on stackoverflow has images of my output:
https://stackoverflow.com/questions/49118323/labelling-a-map-plotted-with-geom-map

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Mar 19 17:40:31 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Mar 2018 17:40:31 +0100
Subject: [R-sig-Geo] 
 Labelling a fortified GADM map plotted with ggplot and geom_map
In-Reply-To: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>
References: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>
Message-ID: <alpine.LFD.2.21.1803191737260.19723@reclus.nhh.no>

On Mon, 19 Mar 2018, Kenneth Dyson wrote:

> Reffered here from the?R-Help mailing list:
>
> I am having trouble getting data labels to display over the provinces in 
> a GADM map of Canada. Specifically, I need the variable "Number" from 
> the data set "by_province", grouped by "region", to appear on the 
> corresponding regions of the map.

You are making life unnecessarily difficult. Use the tmap package instead, 
see for example:

https://www.johnmackintosh.com/2017-09-01-easy-maps-with-tmap/

using the sf representation and forgetting ggplot2 (the development 
version supports geom_sf, but hasn't been released).

Roger

>
> The data set "by_province" looks like this:
>
> long? ? ? lat? ? ? ? ? order? hole piece ? ? ? ? ? ? ? ? ? region ? ? ? ? ? ? ? ?group ? ? Number
> -110.37074 60.00006 ? ? ? 1 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132
> -110.36250 60.00006 ? ? ? 2 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ??Alberta.1? ? 132
> -110.35103 60.00006 ? ? ? 3 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132
>
> and the data set "tract" is the map data without the "Number" variable.
>
> I looked into working this out from by researching the geom_map function here: http://ggplot2.tidyverse.org/reference/geom_map.html
>
> my code looks like this:
> # get the raw map data
> can_map <- getData('GADM', country = "CAN", level = 1) # download map level with provinces
> tract <- fortify(can_map, region = "NAME_1") # transforms data from shapefiles into a dataframe that ggplot can understand, from http://www.kevjohnson.org/making-maps-in-r/
>
> # create subsets of the kcj data if needed, for example by year
> kids_data_2017 <- subset(kids_data, year == 2017) # data for the year 2017
> kids_data_2018 <- subset(kids_data, year == 2018) # data for the year 2018
>
> # extract the needed data
> kids_province_data <- data.table::data.table(kids_data_2017$Province_Territory__c, kids_data_2017$Number_of_kids__c)
> names(kids_province_data)[1] <- "Province"
> names(kids_province_data)[2] <- "Number"
>
> # sum the data by province
> kids_province_sums <- aggregate(.~Province, data = kids_province_data, sum)
>
> # join the data to the map
> names(tract)[6] <- "region"
> names(kids_province_sums)[1] <- "region"
> by_province <- left_join(tract, kids_province_sums)
>
> # create the data map
> kids_map <- ggplot(by_province, aes(map_id = region)) +? ? ? ? ? ? ? #plots the map in by_province separating by region
> ?? ? ? ? ? geom_map(aes(fill = Number), ? ? ? ? ? ? ? ? ? ? ? ? ? ? #generates aestheticsa for the plot
> ? ? ? ? ? ? ? ? ? ? map = tract,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #takes the data from tract
> ? ? ? ? ? ? ? ? ? ? color = "#ffffff",? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #makes the color of the borders between regions white
> ? ? ? ? ? ? ? ? ? ? size = 0.15) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the thickness of the boarder lines
> ?? ? ? ? ? coord_map("polyconic") + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the coordinates to polyconic (rounded lat and long)
> ?? ? ? ? ? scale_fill_gradient(name = "Children Reached", ? ? ? ? ? #sets the gradient of the value scale: names the scale
> ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? low = grey_2,? ? ? ? ? ? ? ? ? ? ? ? ? ? #color of the low end
> ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? high = orange_1) + ? ? ? ? ? ? ? ? ? ? ? #color of the high end
> ?? ? ? ? ? expand_limits(x = tract$long,? ? ? ? ? ? ? ? ? ? ? ? ? ? #ensure limits include all values for all plots
> ?? ? ? ? ? ? ? ? ? ? ? ? y = tract$lat) +
> ?? ? ? ? ? labs(x = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #add labels, no x title
> ? ? ? ? ? ? ? ? y = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #no y title
> ? ? ? ? ? ? ? ? title = "Number of Children Reached by Province", ? ? ? #map title
> ? ? ? ? ? ? ? ? subtitle = "2017") +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #map subtitle
> ?? ? ? ? ? geom_text(data = by_province,? ? ? ? ? ? ? ? ? ? ? ? ? ? #add a text layer
> ?? ? ? ? ? ? ? ? ? ? aes(long,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #aethetics for the text, x axis
> ?? ? ? ? ? ? ? ? ? ? ? ? lat, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #y axis
> ?? ? ? ? ? ? ? ? ? ? ? ? label = Number,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #the value to display
> ?? ? ? ? ? ? ? ? ? ? ? ? size=3)) + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #size of the text
> ?? ? ? ? ? theme(axis.ticks = element_blank(),? ? ? ? ? ? ? ? ? ? ? #theme of the graph, no axis ticks
> ?? ? ? ? ? ? ? ? axis.text = element_blank(), ? ? ? ? ? ? ? ? ? ? ? ? ? #no axis text
> ?? ? ? ? ? ? ? ? panel.background = element_blank(),? ? ? ? ? ? ? ? ? ? #blank background
> ?? ? ? ? ? ? ? ? panel.border = element_blank())? ? ? ? ? ? ? ? ? ? ? ? #blank border
>
> # save as png
> ggsave(kids_map, file = "kids_map.png", width = 6, height = 4.5, type = "cairo-png?)
>
>
> I have asked this question on stack overflow, and was refered to this answer:
> https://stackoverflow.com/questions/9441436/ggplot-centered-names-on-a-map
>
> The solution there did not fix my problem, though it did get me closer.
> The solution on that post is using a single vector of labels.
>
> My post on stackoverflow has images of my output:
> https://stackoverflow.com/questions/49118323/labelling-a-map-plotted-with-geom-map
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From kenneth at kidscodejeunesse.org  Mon Mar 19 18:25:02 2018
From: kenneth at kidscodejeunesse.org (Kenneth Dyson)
Date: Mon, 19 Mar 2018 13:25:02 -0400
Subject: [R-sig-Geo] 
 Labelling a fortified GADM map plotted with ggplot and geom_map
In-Reply-To: <alpine.LFD.2.21.1803191737260.19723@reclus.nhh.no>
References: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>
 <alpine.LFD.2.21.1803191737260.19723@reclus.nhh.no>
Message-ID: <7ebd3c33-b97d-4d3d-a117-7eaf5f95653b@Spark>

Pardon, mistakenly hit reply instead of reply-all.

Thanks for taking interest

I can?t figure out how to merge my collected data into the shapefile without first changing it to a df.
Is there something simple I am missing?
I will read up on tmap in greater detail asap, but if there is a simple solution to getting the data into the shape file and plotting with data labels please let me know.

Cheers

On Mar 19, 2018, 12:40 PM -0400, Roger Bivand <Roger.Bivand at nhh.no>, wrote:
> On Mon, 19 Mar 2018, Kenneth Dyson wrote:
>
> > Reffered here from the?R-Help mailing list:
> >
> > I am having trouble getting data labels to display over the provinces in
> > a GADM map of Canada. Specifically, I need the variable "Number" from
> > the data set "by_province", grouped by "region", to appear on the
> > corresponding regions of the map.
>
> You are making life unnecessarily difficult. Use the tmap package instead,
> see for example:
>
> https://www.johnmackintosh.com/2017-09-01-easy-maps-with-tmap/
>
> using the sf representation and forgetting ggplot2 (the development
> version supports geom_sf, but hasn't been released).
>
> Roger
>
> >
> > The data set "by_province" looks like this:
> >
> > long? ? ? lat? ? ? ? ? order? hole piece ? ? ? ? ? ? ? ? ? region ? ? ? ? ? ? ? ?group ? ? Number
> > -110.37074 60.00006 ? ? ? 1 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132
> > -110.36250 60.00006 ? ? ? 2 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ??Alberta.1? ? 132
> > -110.35103 60.00006 ? ? ? 3 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132
> >
> > and the data set "tract" is the map data without the "Number" variable.
> >
> > I looked into working this out from by researching the geom_map function here: http://ggplot2.tidyverse.org/reference/geom_map.html
> >
> > my code looks like this:
> > # get the raw map data
> > can_map <- getData('GADM', country = "CAN", level = 1) # download map level with provinces
> > tract <- fortify(can_map, region = "NAME_1") # transforms data from shapefiles into a dataframe that ggplot can understand, from http://www.kevjohnson.org/making-maps-in-r/
> >
> > # create subsets of the kcj data if needed, for example by year
> > kids_data_2017 <- subset(kids_data, year == 2017) # data for the year 2017
> > kids_data_2018 <- subset(kids_data, year == 2018) # data for the year 2018
> >
> > # extract the needed data
> > kids_province_data <- data.table::data.table(kids_data_2017$Province_Territory__c, kids_data_2017$Number_of_kids__c)
> > names(kids_province_data)[1] <- "Province"
> > names(kids_province_data)[2] <- "Number"
> >
> > # sum the data by province
> > kids_province_sums <- aggregate(.~Province, data = kids_province_data, sum)
> >
> > # join the data to the map
> > names(tract)[6] <- "region"
> > names(kids_province_sums)[1] <- "region"
> > by_province <- left_join(tract, kids_province_sums)
> >
> > # create the data map
> > kids_map <- ggplot(by_province, aes(map_id = region)) +? ? ? ? ? ? ? #plots the map in by_province separating by region
> > ?? ? ? ? ? geom_map(aes(fill = Number), ? ? ? ? ? ? ? ? ? ? ? ? ? ? #generates aestheticsa for the plot
> > ? ? ? ? ? ? ? ? ? ? map = tract,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #takes the data from tract
> > ? ? ? ? ? ? ? ? ? ? color = "#ffffff",? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #makes the color of the borders between regions white
> > ? ? ? ? ? ? ? ? ? ? size = 0.15) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the thickness of the boarder lines
> > ?? ? ? ? ? coord_map("polyconic") + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the coordinates to polyconic (rounded lat and long)
> > ?? ? ? ? ? scale_fill_gradient(name = "Children Reached", ? ? ? ? ? #sets the gradient of the value scale: names the scale
> > ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? low = grey_2,? ? ? ? ? ? ? ? ? ? ? ? ? ? #color of the low end
> > ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? high = orange_1) + ? ? ? ? ? ? ? ? ? ? ? #color of the high end
> > ?? ? ? ? ? expand_limits(x = tract$long,? ? ? ? ? ? ? ? ? ? ? ? ? ? #ensure limits include all values for all plots
> > ?? ? ? ? ? ? ? ? ? ? ? ? y = tract$lat) +
> > ?? ? ? ? ? labs(x = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #add labels, no x title
> > ? ? ? ? ? ? ? ? y = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #no y title
> > ? ? ? ? ? ? ? ? title = "Number of Children Reached by Province", ? ? ? #map title
> > ? ? ? ? ? ? ? ? subtitle = "2017") +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #map subtitle
> > ?? ? ? ? ? geom_text(data = by_province,? ? ? ? ? ? ? ? ? ? ? ? ? ? #add a text layer
> > ?? ? ? ? ? ? ? ? ? ? aes(long,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #aethetics for the text, x axis
> > ?? ? ? ? ? ? ? ? ? ? ? ? lat, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #y axis
> > ?? ? ? ? ? ? ? ? ? ? ? ? label = Number,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #the value to display
> > ?? ? ? ? ? ? ? ? ? ? ? ? size=3)) + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #size of the text
> > ?? ? ? ? ? theme(axis.ticks = element_blank(),? ? ? ? ? ? ? ? ? ? ? #theme of the graph, no axis ticks
> > ?? ? ? ? ? ? ? ? axis.text = element_blank(), ? ? ? ? ? ? ? ? ? ? ? ? ? #no axis text
> > ?? ? ? ? ? ? ? ? panel.background = element_blank(),? ? ? ? ? ? ? ? ? ? #blank background
> > ?? ? ? ? ? ? ? ? panel.border = element_blank())? ? ? ? ? ? ? ? ? ? ? ? #blank border
> >
> > # save as png
> > ggsave(kids_map, file = "kids_map.png", width = 6, height = 4.5, type = "cairo-png?)
> >
> >
> > I have asked this question on stack overflow, and was refered to this answer:
> > https://stackoverflow.com/questions/9441436/ggplot-centered-names-on-a-map
> >
> > The solution there did not fix my problem, though it did get me closer.
> > The solution on that post is using a single vector of labels.
> >
> > My post on stackoverflow has images of my output:
> > https://stackoverflow.com/questions/49118323/labelling-a-map-plotted-with-geom-map
> >
> > [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Mar 19 18:27:59 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Mar 2018 17:27:59 +0000
Subject: [R-sig-Geo] 
 Labelling a fortified GADM map plotted with ggplot and geom_map
In-Reply-To: <7ebd3c33-b97d-4d3d-a117-7eaf5f95653b@Spark>
References: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>
 <alpine.LFD.2.21.1803191737260.19723@reclus.nhh.no>,
 <7ebd3c33-b97d-4d3d-a117-7eaf5f95653b@Spark>
Message-ID: <BDBEEBC63E3A2C25.6783b15a-76a3-46ac-a4d3-6e82b6c77be1@mail.outlook.com>

Please see the vignettes of the sf package, usually a careful merge() works, and you cease having to fortify.

Roger Bivand
Norwegian School of Economics
Bergen, Norway



Fra: Kenneth Dyson
Sendt: mandag 19. mars, 18.26
Emne: Re: [R-sig-Geo]  Labelling a fortified GADM map plotted with ggplot and geom_map
Kopi: r-sig-geo at r-project.org


Pardon, mistakenly hit reply instead of reply-all. Thanks for taking interest I can?t figure out how to merge my collected data into the shapefile without first changing it to a df. Is there something simple I am missing? I will read up on tmap in greater detail asap, but if there is a simple solution to getting the data into the shape file and plotting with data labels please let me know. Cheers On Mar 19, 2018, 12:40 PM -0400, Roger Bivand , wrote: > On Mon, 19 Mar 2018, Kenneth Dyson wrote: > > > Reffered here from the R-Help mailing list: > > > > I am having trouble getting data labels to display over the provinces in > > a GADM map of Canada. Specifically, I need the variable "Number" from > > the data set "by_province", grouped by "region", to appear on the > > corresponding regions of the map. > > You are making life unnecessarily difficult. Use the tmap package instead, > see for example: > > https://www.johnmackintosh.com/2017-09-01-easy-maps-with-tmap/ > > using the sf representation and forgetting ggplot2 (the development > version supports geom_sf, but hasn't been released). > > Roger > > > > > The data set "by_province" looks like this: > > > > long      lat          order  hole piece                   region                group     Number > > -110.37074 60.00006       1 FALSE     1            Alberta            Alberta.1    132 > > -110.36250 60.00006       2 FALSE     1            Alberta            Alberta.1    132 > > -110.35103 60.00006       3 FALSE     1            Alberta            Alberta.1    132 > > > > and the data set "tract" is the map data without the "Number" variable. > > > > I looked into working this out from by researching the geom_map function here: http://ggplot2.tidyverse.org/reference/geom_map.html > > > > my code looks like this: > > # get the raw map data > > can_map > tract > > > # create subsets of the kcj data if needed, for example by year > > kids_data_2017 > kids_data_2018 > > > # extract the needed data > > kids_province_data > names(kids_province_data)[1] > names(kids_province_data)[2] > > > # sum the data by province > > kids_province_sums > > > # join the data to the map > > names(tract)[6] > names(kids_province_sums)[1] > by_province > > > # create the data map > > kids_map >            geom_map(aes(fill = Number),                             #generates aestheticsa for the plot > >                     map = tract,                                        #takes the data from tract > >                     color = "#ffffff",                                  #makes the color of the borders between regions white > >                     size = 0.15) +                                      #sets the thickness of the boarder lines > >            coord_map("polyconic") +                                 #sets the coordinates to polyconic (rounded lat and long) > >            scale_fill_gradient(name = "Children Reached",           #sets the gradient of the value scale: names the scale > >                                low = grey_2,                            #color of the low end > >                                high = orange_1) +                       #color of the high end > >            expand_limits(x = tract$long,                            #ensure limits include all values for all plots > >                          y = tract$lat) + > >            labs(x = NULL,                                           #add labels, no x title > >                 y = NULL,                                               #no y title > >                 title = "Number of Children Reached by Province",       #map title > >                 subtitle = "2017") +                                    #map subtitle > >            geom_text(data = by_province,                            #add a text layer > >                      aes(long,                                          #aethetics for the text, x axis > >                          lat,                                               #y axis > >                          label = Number,                                    #the value to display > >                          size=3)) +                                         #size of the text > >            theme(axis.ticks = element_blank(),                      #theme of the graph, no axis ticks > >                  axis.text = element_blank(),                           #no axis text > >                  panel.background = element_blank(),                    #blank background > >                  panel.border = element_blank())                        #blank border > > > > # save as png > > ggsave(kids_map, file = "kids_map.png", width = 6, height = 4.5, type = "cairo-png?) > > > > > > I have asked this question on stack overflow, and was refered to this answer: > > https://stackoverflow.com/questions/9441436/ggplot-centered-names-on-a-map > > > > The solution there did not fix my problem, though it did get me closer. > > The solution on that post is using a single vector of labels. > > > > My post on stackoverflow has images of my output: > > https://stackoverflow.com/questions/49118323/labelling-a-map-plotted-with-geom-map > > > > [[alternative HTML version deleted]] > > > > _______________________________________________ > > R-sig-Geo mailing list > > R-sig-Geo at r-project.org > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > > > > -- > Roger Bivand > Department of Economics, Norwegian School of Economics, > Helleveien 30, N-5045 Bergen, Norway. > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no > http://orcid.org/0000-0003-2392-6140 > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en [[alternative HTML version deleted]] _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From olatunde.mosobalaje at covenantuniversity.edu.ng  Tue Mar 20 08:30:03 2018
From: olatunde.mosobalaje at covenantuniversity.edu.ng (Olatunde Mosobalaje)
Date: Tue, 20 Mar 2018 08:30:03 +0100
Subject: [R-sig-Geo] How to request a directional Variogram Cloud in gstat
Message-ID: <CAO1OqVTCdW_cRPj93dpPpg9beCKSjKuDFp9X74W9NnULhg+nCQ@mail.gmail.com>

Hail, all.

I am a bit new to gstat but am getting along well. I try requesting a
variogram cloud computation and plotting in gstat by specifying *alpha* and
setting *cloud* = TRUE in a variogram call. However, the outcome is no
different from the omnidirectional variogram cloud I got when I did not
specify *alpha*. How may I get this done?

Thank you, all.

Olatunde

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Tue Mar 20 10:20:22 2018
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 20 Mar 2018 10:20:22 +0100
Subject: [R-sig-Geo] 
 How to request a directional Variogram Cloud in gstat
In-Reply-To: <CAO1OqVTCdW_cRPj93dpPpg9beCKSjKuDFp9X74W9NnULhg+nCQ@mail.gmail.com>
References: <CAO1OqVTCdW_cRPj93dpPpg9beCKSjKuDFp9X74W9NnULhg+nCQ@mail.gmail.com>
Message-ID: <1baf518c-fbd1-9679-977a-1d3165471fa7@uni-muenster.de>



On 03/20/2018 08:30 AM, Olatunde Mosobalaje wrote:
> Hail, all.
> 
> I am a bit new to gstat but am getting along well. I try requesting a
> variogram cloud computation and plotting in gstat by specifying *alpha* and
> setting *cloud* = TRUE in a variogram call. However, the outcome is no
> different from the omnidirectional variogram cloud I got when I did not
> specify *alpha*. How may I get this done?

You need to set tol.hor to something smaller than 90 in order to get a
directional variogram.

> 
> Thank you, all.
> 
> Olatunde
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From Marc.J.Naura at cranfield.ac.uk  Tue Mar 20 12:12:47 2018
From: Marc.J.Naura at cranfield.ac.uk (Naura, Marc)
Date: Tue, 20 Mar 2018 11:12:47 +0000
Subject: [R-sig-Geo] applying a regression kriging model outside gstats
Message-ID: <deaecc44085c48e9a7774edd32a8e4a9@CCEXCHMAIL-1.cns.cranfield.ac.uk>

Hi,
I have produced a regression kriging model using gstats that I want to deliver to a wide range of users to predict values for new sites using the web or as part of a simple computer software (e.g. Visual Basic software).  Is there a simple way of doing that or do I need to use R and gstats to produce predictions?
Many thanks
Marc

From tom.hengl at gmail.com  Tue Mar 20 12:30:47 2018
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Tue, 20 Mar 2018 12:30:47 +0100
Subject: [R-sig-Geo] applying a regression kriging model outside gstats
In-Reply-To: <deaecc44085c48e9a7774edd32a8e4a9@CCEXCHMAIL-1.cns.cranfield.ac.uk>
References: <deaecc44085c48e9a7774edd32a8e4a9@CCEXCHMAIL-1.cns.cranfield.ac.uk>
Message-ID: <e9f19d04-0372-27f4-412b-33986f306811@gmail.com>


Ordinary kriging and hence also RK are matrix algebra 
(http://spatial-analyst.net/book/system/files/RK5points.zip <-- look for 
the excel file). If you have model parameters (betas, vgm parameters), 
then it should be relatively easy to implement to generate predictions 
(you do not need gstat or similar). Problems might happen if the number 
of points is very high >>1000 so solving matrices can take time (in 
which case using a search radius etc is a good idea) or if you have to 
generate predictions for large areas... or you do not work with a linear 
model...

HTH,

T. Hengl

On 03/20/2018 12:12 PM, Naura, Marc wrote:
> Hi,
> I have produced a regression kriging model using gstats that I want to deliver to a wide range of users to predict values for new sites using the web or as part of a simple computer software (e.g. Visual Basic software).  Is there a simple way of doing that or do I need to use R and gstats to produce predictions?
> Many thanks
> Marc
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From b.rowlingson at lancaster.ac.uk  Tue Mar 20 13:40:42 2018
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 20 Mar 2018 12:40:42 +0000
Subject: [R-sig-Geo] applying a regression kriging model outside gstats
In-Reply-To: <deaecc44085c48e9a7774edd32a8e4a9@CCEXCHMAIL-1.cns.cranfield.ac.uk>
References: <deaecc44085c48e9a7774edd32a8e4a9@CCEXCHMAIL-1.cns.cranfield.ac.uk>
Message-ID: <CANVKczMM2Uhx-+Z5P5qwftN7mrQxk1x=ywS1+dWBJw3LvaGsHA@mail.gmail.com>

On Tue, Mar 20, 2018 at 11:12 AM, Naura, Marc <Marc.J.Naura at cranfield.ac.uk>
wrote:

> Hi,
> I have produced a regression kriging model using gstats that I want to
> deliver to a wide range of users to predict values for new sites using the
> web or as part of a simple computer software (e.g. Visual Basic software).
> Is there a simple way of doing that or do I need to use R and gstats to
> produce predictions?
>

If you don't want to reimplement kriging in VIsual Basic and "using the
web" means what I think it means, you can make your model accessible via
something like Shiny or one of the other R-Web interfaces described in the
R Web Technology Task View.

These methods qualify as "simple", for some values of "simple"....

Barry

	[[alternative HTML version deleted]]


From nico.hahn at yahoo.de  Tue Mar 20 15:01:45 2018
From: nico.hahn at yahoo.de (Nico Hahn)
Date: Tue, 20 Mar 2018 14:01:45 +0000 (UTC)
Subject: [R-sig-Geo] Density on worldmap
References: <943941656.6125603.1521554505247.ref@mail.yahoo.com>
Message-ID: <943941656.6125603.1521554505247@mail.yahoo.com>

Dear all,

I'm trying to plot a density on a worldmap using ggplot2.? I have three variables: Freq, Latitude and Longitude.? However most of my points are around the same coordinates, which is why my density is displayed red there. Is there a way that the displayed density dependts on the variable Freq instead of the amount of points in the area?

My current code:
rel = as.data.frame(matrix(0, nrow = 6, ncol = 3))
rel[,1] = c(1,0,0,0.73,0.94,1)
rel[,2] = c(34.55040,34.16807,36.02210,36.09917,36.35868,32.12694)
rel[,3] = c(40.88923, 45.10331, 43.40581, 43.32750, 43.15194, 45.23083)
colnames(rel) = c("Freq", "Latitude", "Longitude")

map = get_map(location = c(lon=43, lat=36), zoom = 6)
ggmap(map) + 
? geom_density2d(aes(x=Longitude, y=Latitude), 
???????????????? data =? rel ,size = 0.3) +
? stat_density2d(data = rel, aes(x=Longitude, y=Latitude,
??????????????????????????????? fill = ..level.., 
???????????????????????????????? alpha = ..level..), size =0.01, bins = 16,
???????????????? geom = "polygon") + 
? scale_fill_gradient(low = "green", high = "red") +
? scale_alpha(range = c(0, 0.3), guide = FALSE) +
? geom_point(aes(x=Longitude, y=Latitude, colour = Freq),alpha = 0.75, size=5, data = rel)+
scale_colour_gradient(low = "#3afff4", high = "#fc0000") 

I would like the density to be displayed in red everywhere where red points are present.

Thanks,
Nico

	[[alternative HTML version deleted]]


From kenneth at kidscodejeunesse.org  Tue Mar 20 18:57:47 2018
From: kenneth at kidscodejeunesse.org (Kenneth Dyson)
Date: Tue, 20 Mar 2018 13:57:47 -0400
Subject: [R-sig-Geo] 
 Labelling a fortified GADM map plotted with ggplot and geom_map
In-Reply-To: <BDBEEBC63E3A2C25.6783b15a-76a3-46ac-a4d3-6e82b6c77be1@mail.outlook.com>
References: <8a861512-cd2f-4729-88f1-a0743e12e6b2@Spark>
 <alpine.LFD.2.21.1803191737260.19723@reclus.nhh.no>
 <7ebd3c33-b97d-4d3d-a117-7eaf5f95653b@Spark>
 <BDBEEBC63E3A2C25.6783b15a-76a3-46ac-a4d3-6e82b6c77be1@mail.outlook.com>
Message-ID: <34ea67ea-4d7f-430f-978a-9e0854ec34b7@Spark>

Thanks Roger,

I have been able to gererate a rudimentary map with my data, thanks to your directions.
Much appreciated.
This is where I am at so far:

> library(tmap)
> library(tmaptools)
> library(viridis)
> library(sf)
>
> # read in the map shapefile as a "simple features" (sf)
> can_map <- read_shape("~/gdrive_kcj/r-projects/kcj_kids_map/CAN_adm1.shp", as.sf = TRUE)
>
> # create subsets of the kcj data if needed, for example by year
> kids_data_2017 <- subset(kids_data, year == 2017) # data for the year 2017
> kids_data_2018 <- subset(kids_data, year == 2018) # data for the year 2018
>
> # extract the needed data
> kids_province_data <- data.table::data.table(kids_data_2017$Province_Territory__c, kids_data_2017$Number_of_kids__c)
> names(kids_province_data)[1] <- "NAME_1"
> names(kids_province_data)[2] <- "Number"
>
> # sum the data by province
> kids_province_sums <- aggregate(.~NAME_1, data = kids_province_data, sum)
>
> # join the data to the map
> by_province <- merge(can_map, kids_province_sums, by = "NAME_1")
>
> # use tmap package to draw map
> kids_map <- tm_shape(by_province) +
> ? tm_polygons("Number", ?title = "Children Reached", subtitle = "2017") +
> ? tm_text("Number") +
> ? tm_style_natural() +
> ? tm_legend(text.size=1,
> ? ? ? ? ? ? title.size=1.2,
> ? ? ? ? ? ? position = c("left","top"),
> ? ? ? ? ? ? bg.color = "white",
> ? ? ? ? ? ? bg.alpha=.2,
> ? ? ? ? ? ? frame="gray50",
> ? ? ? ? ? ? height=.6)
>
>
I will continue to explore the tmap documentation to fine tune it!

Cheers



On Mar 19, 2018, 1:28 PM -0400, Roger Bivand <Roger.Bivand at nhh.no>, wrote:
> Please see the vignettes of the sf package, usually a careful merge() works, and you cease having to fortify.
>
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
>
>
>
> Fra: Kenneth Dyson
> Sendt: mandag 19. mars, 18.26
> Emne: Re: [R-sig-Geo]? Labelling a fortified GADM map plotted with ggplot and geom_map
> Kopi: r-sig-geo at r-project.org
>
>
> Pardon, mistakenly hit reply instead of reply-all. Thanks for taking interest I can?t figure out how to merge my collected data into the shapefile without first changing it to a df. Is there something simple I am missing? I will read up on tmap in greater detail asap, but if there is a simple solution to getting the data into the shape file and plotting with data labels please let me know. Cheers On Mar 19, 2018, 12:40 PM -0400, Roger Bivand , wrote: > On Mon, 19 Mar 2018, Kenneth Dyson wrote: > > > Reffered here from the?R-Help mailing list: > > > > I am having trouble getting data labels to display over the provinces in > > a GADM map of Canada. Specifically, I need the variable "Number" from > > the data set "by_province", grouped by "region", to appear on the > > corresponding regions of the map. > > You are making life unnecessarily difficult. Use the tmap package instead, > see for example: > > https://www.johnmackintosh.com/2017-09-01-easy-maps-with-tmap/ > > using the sf representation and forgetting ggplot2 (the development > version supports geom_sf, but hasn't been released). > > Roger > > > > > The data set "by_province" looks like this: > > > > long? ? ? lat? ? ? ? ? order? hole piece ? ? ? ? ? ? ? ? ? region ? ? ? ? ? ? ? ?group ? ? Number > > -110.37074 60.00006 ? ? ? 1 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132 > > -110.36250 60.00006 ? ? ? 2 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ??Alberta.1? ? 132 > > -110.35103 60.00006 ? ? ? 3 FALSE ? ? 1 ? ? ? ? ? ?Alberta? ? ? ? ? ? Alberta.1? ? 132 > > > > and the data set "tract" is the map data without the "Number" variable. > > > > I looked into working this out from by researching the geom_map function here: http://ggplot2.tidyverse.org/reference/geom_map.html > > > > my code looks like this: > > # get the raw map data > > can_map > tract > > > # create subsets of the kcj data if needed, for example by year > > kids_data_2017 > kids_data_2018 > > > # extract the needed data > > kids_province_data > names(kids_province_data)[1] > names(kids_province_data)[2] > > > # sum the data by province > > kids_province_sums > > > # join the data to the map > > names(tract)[6] > names(kids_province_sums)[1] > by_province > > > # create the data map > > kids_map > ?? ? ? ? ? geom_map(aes(fill = Number), ? ? ? ? ? ? ? ? ? ? ? ? ? ? #generates aestheticsa for the plot > > ? ? ? ? ? ? ? ? ? ? map = tract,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #takes the data from tract > > ? ? ? ? ? ? ? ? ? ? color = "#ffffff",? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #makes the color of the borders between regions white > > ? ? ? ? ? ? ? ? ? ? size = 0.15) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the thickness of the boarder lines > > ?? ? ? ? ? coord_map("polyconic") + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #sets the coordinates to polyconic (rounded lat and long) > > ?? ? ? ? ? scale_fill_gradient(name = "Children Reached", ? ? ? ? ? #sets the gradient of the value scale: names the scale > > ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? low = grey_2,? ? ? ? ? ? ? ? ? ? ? ? ? ? #color of the low end > > ?? ? ? ? ? ? ? ? ? ? ? ? ? ? ? high = orange_1) + ? ? ? ? ? ? ? ? ? ? ? #color of the high end > > ?? ? ? ? ? expand_limits(x = tract$long,? ? ? ? ? ? ? ? ? ? ? ? ? ? #ensure limits include all values for all plots > > ?? ? ? ? ? ? ? ? ? ? ? ? y = tract$lat) + > > ?? ? ? ? ? labs(x = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #add labels, no x title > > ? ? ? ? ? ? ? ? y = NULL, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #no y title > > ? ? ? ? ? ? ? ? title = "Number of Children Reached by Province", ? ? ? #map title > > ? ? ? ? ? ? ? ? subtitle = "2017") +? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #map subtitle > > ?? ? ? ? ? geom_text(data = by_province,? ? ? ? ? ? ? ? ? ? ? ? ? ? #add a text layer > > ?? ? ? ? ? ? ? ? ? ? aes(long,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #aethetics for the text, x axis > > ?? ? ? ? ? ? ? ? ? ? ? ? lat, ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #y axis > > ?? ? ? ? ? ? ? ? ? ? ? ? label = Number,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #the value to display > > ?? ? ? ? ? ? ? ? ? ? ? ? size=3)) + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? #size of the text > > ?? ? ? ? ? theme(axis.ticks = element_blank(),? ? ? ? ? ? ? ? ? ? ? #theme of the graph, no axis ticks > > ?? ? ? ? ? ? ? ? axis.text = element_blank(), ? ? ? ? ? ? ? ? ? ? ? ? ? #no axis text > > ?? ? ? ? ? ? ? ? panel.background = element_blank(),? ? ? ? ? ? ? ? ? ? #blank background > > ?? ? ? ? ? ? ? ? panel.border = element_blank())? ? ? ? ? ? ? ? ? ? ? ? #blank border > > > > # save as png > > ggsave(kids_map, file = "kids_map.png", width = 6, height = 4.5, type = "cairo-png?) > > > > > > I have asked this question on stack overflow, and was refered to this answer: > > https://stackoverflow.com/questions/9441436/ggplot-centered-names-on-a-map > > > > The solution there did not fix my problem, though it did get me closer. > > The solution on that post is using a single vector of labels. > > > > My post on stackoverflow has images of my output: > > https://stackoverflow.com/questions/49118323/labelling-a-map-plotted-with-geom-map > > > > [[alternative HTML version deleted]] > > > > _______________________________________________ > > R-sig-Geo mailing list > > R-sig-Geo at r-project.org > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > > > > -- > Roger Bivand > Department of Economics, Norwegian School of Economics, > Helleveien 30, N-5045 Bergen, Norway. > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no > http://orcid.org/0000-0003-2392-6140 > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en [[alternative HTML version deleted]] _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Mar 21 00:57:01 2018
From: Jin.Li at ga.gov.au (Li Jin)
Date: Tue, 20 Mar 2018 23:57:01 +0000
Subject: [R-sig-Geo] =?windows-1252?q?A_new_version_=281=2E1=2E0=29_of_th?=
 =?windows-1252?q?e_=93spm=94_package_for_spatial_predictive_modelling_ree?=
 =?windows-1252?q?lased_on_CRAN_=5BSEC=3DUNCLASSIFIED=5D?=
Message-ID: <094bd838b77241cbb33a98781023cb83@win-exch-prod03.prod.lan>

Dear R users,



A new version (1.1.0) of the ?spm? package for spatial predictive modelling  is now available on CRAN.



The introductory vignette is available here:

https://cran.rstudio.com/web/packages/spm/vignettes/spm.html



There are several new enhancements to the package including a fast version of random forest in using ranger (rg) library(ranger) and the ability to convert relevant error measures to accuracy measure (VEcv).  A full list of changes are shown below.



New Features:

1. Added eight functions to implement random forest using ranger (rg) in library(ranger).

2. Added a new function, tovecv, to convert relevant error measures to accuracy measure (VEcv).

3. Added some accuracy measures for categorical data and one further accuracy measure for numerical data in function pred.acc.

4. Added the variances of predictions to relevant prediction functions.

5. Revised RFcv etc. to use pred.acc.

6. Removed samples with missing values in data(hard).

6. Updated vignette accordingly.



Comments,  suggestions and contributions are welcome and much appreciated!.



Kind regards,

Jin Li, PhD | Spatial Modeller / Computational Statistician
National Earth and Marine Observations | Environmental Geoscience Division
t:  +61 2 6249 9899    www.ga.gov.au<http://www.ga.gov.au/>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180320/a8eca9da/attachment.html>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: mg_info.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20180320/a8eca9da/attachment.txt>

From nevil.amos at gmail.com  Thu Mar 22 02:37:00 2018
From: nevil.amos at gmail.com (nevil amos)
Date: Thu, 22 Mar 2018 12:37:00 +1100
Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
 mapedit::selectmod
Message-ID: <CAN9eD7kz2RJjsT1qNyh6yrmmdnuCVpB7NGKyimvN7Qr7Ez5iGw@mail.gmail.com>

Hi I  am  putting together a shiny map app in which I want to allow for
selection or deselection of polygons from  a map layer.
Importantly At the beginning of the process I would like a subset of the
polygons to be already selected ( and they can then be deselected using a
click if required).
The final set of selected polygons is then saved to disk.

Ideally I would like to be able ( eg using a shiny action button) to reset
the selection to the pre-selected polygons.

I have the basic click select working fine, but cannot work out how to
pre-select some polygons so that they are dis as selected ( and can be
deselected with a click) at the start of the process.
Secondly is there a way to reset the selection to the pre-selected set.

The pre-selected polygon ids will change  depending on another interactive.

toy example of code is below  with comments about the two issues that I
cannot figure out:

library(shiny)
library(mapedit)
library(leaflet)
outputDir<-getwd()
saveData <- function(data,fileName) {
  # Write the file to the local system
  write.csv(
    x = data,
    file = file.path(outputDir, fileName),
    row.names = FALSE, quote = TRUE
  )
}


# An example se of preslected values for the polygon layer
# in the real app this will change based on other selections in the UI
preselected1<-gadmCHE$NAME_1[1:3]
preselected2<-gadmCHE$NAME_1[5:8]


ui <- fluidPage(
  radioButtons(inputId = "presel",label = "Preselection",choiceNames =
c("preselected1","preselected2"),choices =
c("preselected1","preselected2")),
  actionButton("startSel", "Show Polygons"),
  actionButton("endSel", "Do not Save"),
  actionButton("saveSel","Save Revised Selection"),
  actionButton("resetSel","Reset Selection\n does not work at the moment"),
  selectModUI("selector")

)

server <- function(input, output) {

  ns <<- NS("selector")

  base_map <- leaflet() %>%
  addTiles()%>%
  addPolygons(data =gadmCHE,
              label = ~NAME_1,
              layerId = ~NAME_1,
              group="Polygons")
  #####
  #####
  ####HOW can I feed in the preslected ids to the process so they
  ####are displayed when the polygons group is shown ?
  Selects<<-callModule(selectMod,
                    "selector",
                    base_map,
                    styleFalse = list(fillOpacity =0,
                                      weight = 1,
                                      opacity = 1),
                    styleTrue = list(fillOpacity = 1,
                                     weight= 1,
                                     opacity = 0))
  leafletProxy(ns("map"))%>%
    hideGroup("Polygons")

  observe({selOuts<-Selects()
  selOuts<<-selOuts
  selOut<<-t(selOuts[selOuts$selected==TRUE,"id"])})


  observeEvent(input$startSel,{
*    #####*
*    ####HOW can I feed in the preslected ids to the process so they*
*    ####are displayed when the polygons group is shown ?*
    leafletProxy(ns("map"))%>%
      showGroup("Polygons")})

   observeEvent(input$resetSel,{
    * ####*
*     ####*
*     ####How can I reset the polygons to the preselected set?*
    leafletProxy(ns("map"))%>%
      showGroup("Polygons")})

  observeEvent(input$endSel,{
    leafletProxy(ns("map"))%>%
      hideGroup("Polygons")})

  observeEvent(input$saveSel,{
    outname<-"Revision.csv"
    saveData(selOut,outname)
    rm(outname)
  })

}


shinyApp(ui = ui, server = server)

	[[alternative HTML version deleted]]


From kent3737 at gmail.com  Thu Mar 22 14:11:50 2018
From: kent3737 at gmail.com (Kent Johnson)
Date: Thu, 22 Mar 2018 09:11:50 -0400
Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
 mapedit::selectmod
Message-ID: <CAPP0wyjXuM8zwJkiRFOPeCJLyJ0txPaRR5t5Huap4x0Dc1iHYQ@mail.gmail.com>

On Thu, Mar 22, 2018 at 7:00 AM, <r-sig-geo-request at r-project.org> wrote:
>
> Message: 1
> Date: Thu, 22 Mar 2018 12:37:00 +1100
> From: nevil amos <nevil.amos at gmail.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
>         mapedit::selectmod
>
> Hi I  am  putting together a shiny map app in which I want to allow for
> selection or deselection of polygons from  a map layer.
> Importantly At the beginning of the process I would like a subset of the
> polygons to be already selected ( and they can then be deselected using a
> click if required).
> The final set of selected polygons is then saved to disk.
>
> Ideally I would like to be able ( eg using a shiny action button) to reset
> the selection to the pre-selected polygons.


I did something very similar to this using just leaflet and shiny (no
mapedit). I was drawing many polygons and wanted to change the state of a
polygon based on a click.

I don't have the code handy, but basically it was
- create an initial map drawing the polygons with the desired initial
state. Use a unique layerId for each polygon.
- listen to input$map_shape_click with observeEvent. On click, remove the
clicked polygon from the map with leaflet::removeShape(leafletProxy('map',
input$map_shape_click$layerId), change the state of the polygon, and add it
back to the map.
 - Save the state when a "Save" button is clicked.

If there are polygons you don't want to respond to clicks, you will have to
filter them out in the click handler using layerId.

See the Inputs/Events section of the leaflet docs here for more
information: https://rstudio.github.io/leaflet/shiny.html

HTH,
kent

	[[alternative HTML version deleted]]


From patrick.giraudoux at univ-fcomte.fr  Thu Mar 22 16:31:02 2018
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Thu, 22 Mar 2018 16:31:02 +0100
Subject: [R-sig-Geo] sampling with a "cluster" constraints
Message-ID: <61f9e36e-3c61-4099-45ff-7ad705948e3d@univ-fcomte.fr>

Dear Listers,

Everybody is probably used with sp:spsample, which permits to produce 
points locations at random or on a regular grid. Is anybody aware of a 
package permitting similarly to produce points locations in a field with 
various degrees of clustering. The idea is to produce points in a field 
with various degrees of clustering repetedly,? and to compare statistics 
to observed data.? E.g. observations in the real world are clustered; 
one computes a statistics, e.g. the distance of each observation to a 
feature (e.g. to a road network); then one compute B=999 similarly 
clustered distributions randomly and the corresponding statistics. This 
would allow to compute how likely the observed statistics is.

Any hint welcome!

Best,

Patrick


	[[alternative HTML version deleted]]


From kent3737 at gmail.com  Thu Mar 22 20:44:13 2018
From: kent3737 at gmail.com (Kent Johnson)
Date: Thu, 22 Mar 2018 15:44:13 -0400
Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
 mapedit::selectmod
In-Reply-To: <CAPP0wyjXuM8zwJkiRFOPeCJLyJ0txPaRR5t5Huap4x0Dc1iHYQ@mail.gmail.com>
References: <CAPP0wyjXuM8zwJkiRFOPeCJLyJ0txPaRR5t5Huap4x0Dc1iHYQ@mail.gmail.com>
Message-ID: <CAPP0wyjuHvpsEP4CXH0D6hubQOp1Ngwfv7uAKCKpbTz7LqRiow@mail.gmail.com>

Here is a minimal example:

https://gist.github.com/kent37/63c55c0bbdb0640d8c43369cdeeebdd2



Kent

On Thu, Mar 22, 2018 at 9:11 AM, Kent Johnson <kent3737 at gmail.com> wrote:

> On Thu, Mar 22, 2018 at 7:00 AM, <r-sig-geo-request at r-project.org> wrote:
>>
>> Message: 1
>> Date: Thu, 22 Mar 2018 12:37:00 +1100
>> From: nevil amos <nevil.amos at gmail.com>
>> To: r-sig-geo at r-project.org
>> Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
>>         mapedit::selectmod
>>
>> Hi I  am  putting together a shiny map app in which I want to allow for
>> selection or deselection of polygons from  a map layer.
>> Importantly At the beginning of the process I would like a subset of the
>> polygons to be already selected ( and they can then be deselected using a
>> click if required).
>> The final set of selected polygons is then saved to disk.
>>
>> Ideally I would like to be able ( eg using a shiny action button) to reset
>> the selection to the pre-selected polygons.
>
>
> I did something very similar to this using just leaflet and shiny (no
> mapedit). I was drawing many polygons and wanted to change the state of a
> polygon based on a click.
>
> I don't have the code handy, but basically it was
> - create an initial map drawing the polygons with the desired initial
> state. Use a unique layerId for each polygon.
> - listen to input$map_shape_click with observeEvent. On click, remove the
> clicked polygon from the map with leaflet::removeShape(leafletProxy('map',
> input$map_shape_click$layerId), change the state of the polygon, and add
> it back to the map.
>  - Save the state when a "Save" button is clicked.
>
> If there are polygons you don't want to respond to clicks, you will have
> to filter them out in the click handler using layerId.
>
> See the Inputs/Events section of the leaflet docs here for more
> information: https://rstudio.github.io/leaflet/shiny.html
>
> HTH,
> kent
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Fri Mar 23 08:59:07 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Mar 2018 08:59:07 +0100
Subject: [R-sig-Geo] sampling with a "cluster" constraints
In-Reply-To: <61f9e36e-3c61-4099-45ff-7ad705948e3d@univ-fcomte.fr>
References: <61f9e36e-3c61-4099-45ff-7ad705948e3d@univ-fcomte.fr>
Message-ID: <alpine.LFD.2.21.1803230857280.9170@reclus.nhh.no>

Just a thought - spatstat? This has had line segements too for some time, 
maybe chapter 17 in the spatstat book?

Roger

On Thu, 22 Mar 2018, Patrick Giraudoux wrote:

> Dear Listers,
>
> Everybody is probably used with sp:spsample, which permits to produce
> points locations at random or on a regular grid. Is anybody aware of a
> package permitting similarly to produce points locations in a field with
> various degrees of clustering. The idea is to produce points in a field
> with various degrees of clustering repetedly,? and to compare statistics
> to observed data.? E.g. observations in the real world are clustered;
> one computes a statistics, e.g. the distance of each observation to a
> feature (e.g. to a road network); then one compute B=999 similarly
> clustered distributions randomly and the corresponding statistics. This
> would allow to compute how likely the observed statistics is.
>
> Any hint welcome!
>
> Best,
>
> Patrick
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From patrick.giraudoux at univ-fcomte.fr  Fri Mar 23 09:22:22 2018
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Fri, 23 Mar 2018 09:22:22 +0100
Subject: [R-sig-Geo] sampling with a "cluster" constraints
In-Reply-To: <alpine.LFD.2.21.1803230857280.9170@reclus.nhh.no>
References: <61f9e36e-3c61-4099-45ff-7ad705948e3d@univ-fcomte.fr>
 <alpine.LFD.2.21.1803230857280.9170@reclus.nhh.no>
Message-ID: <8513a53d-18bc-2663-c301-79175260ab54@univ-fcomte.fr>

Le 23/03/2018 ? 08:59, Roger Bivand a ?crit?:
> Just a thought - spatstat? This has had line segements too for some 
> time, maybe chapter 17 in the spatstat book?
>
> Roger 

Thanks Roger. I will check this. If nothing comes out, I am thinking 
about developping a quick and dirty home-made function based on negative 
binomial distribution where a "clustering" (dispersion) parameter can be 
tuned... Hence, shit stats for hazel grouse and capercaillie shit 
distribution :-D...

Patric


From patrick.giraudoux at univ-fcomte.fr  Fri Mar 23 09:44:04 2018
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Fri, 23 Mar 2018 09:44:04 +0100
Subject: [R-sig-Geo] sampling with a "cluster" constraints
In-Reply-To: <alpine.LFD.2.21.1803230857280.9170@reclus.nhh.no>
References: <61f9e36e-3c61-4099-45ff-7ad705948e3d@univ-fcomte.fr>
 <alpine.LFD.2.21.1803230857280.9170@reclus.nhh.no>
Message-ID: <07f547b4-b666-db03-76b4-e50392534ec4@univ-fcomte.fr>

Le 23/03/2018 ? 08:59, Roger Bivand a ?crit?:
> Just a thought - spatstat? This has had line segements too for some 
> time, maybe chapter 17 in the spatstat book?
>
> Roger 

Indeed. There are at least two possibilities: simulations using either 
Matern process or Neyman-Scott Point Process with Variance Gamma cluster 
kernel... Will see how it could be applicable in my case. Thanks again 
for the hint, Roger.

Patrick


From nevil.amos at gmail.com  Sun Mar 25 14:14:36 2018
From: nevil.amos at gmail.com (nevil amos)
Date: Sun, 25 Mar 2018 23:14:36 +1100
Subject: [R-sig-Geo] Fwd: "Preselecting" shapes on leaflet map shiny using
 mapedit::selectmod
In-Reply-To: <CAN9eD7mD-=XSS4HFyU8Os_hREFMDCcui3BYFwDkE4f4dhuZibw@mail.gmail.com>
References: <CAPP0wyjXuM8zwJkiRFOPeCJLyJ0txPaRR5t5Huap4x0Dc1iHYQ@mail.gmail.com>
 <CAPP0wyjuHvpsEP4CXH0D6hubQOp1Ngwfv7uAKCKpbTz7LqRiow@mail.gmail.com>
 <CAN9eD7mD-=XSS4HFyU8Os_hREFMDCcui3BYFwDkE4f4dhuZibw@mail.gmail.com>
Message-ID: <CAN9eD7=t9AW+pWr0Tdr9k3F4qHSzn9-+cBQcdmV3KtO=yXXG9Q@mail.gmail.com>

---------- Forwarded message ----------
From: nevil amos <nevil.amos at gmail.com>
Date: 25 March 2018 at 23:12
Subject: Re: "Preselecting" shapes on leaflet map shiny using
mapedit::selectmod
To: Kent Johnson <kent3737 at gmail.com>


Tahnks,

I have adapted your code a litle to get further towards what I need., could
not work out how to respond on the git gist site so sending to you direct.

I have now set up the app so that it initially shows the preselected
polygons, but does not allow clicking to change the selection.    changing
the radio button "turns on" the selection,  but when I change the button
back to no it does not trun it off again.  how do I trun of the
map_shape_click again?

thanks again for your help


# Draw a map which responds to clicks by toggling the selection state
# of the clicked polygon.
library(shiny)
library(leaflet)
library(sf)

nc=st_as_sf(gadmCHE)
nc$selected<-0
# Initial selection
nc$selected[nc$NAME_1%in%c("Aargau", "Appenzell Ausserrhoden", "Appenzell
Innerrhoden",
                           "Basel-Landschaft", "Basel-Stadt", "Bern",
"Fribourg")]<-1
ui <- fluidPage(
  titlePanel("Leaflet selection demo"),
  radioButtons(inputId = "selectable",label = "allow selection by
clicking?",choiceNames = c("no","yes"),choices =  c("no","yes")),
  leafletOutput('map')
)

server <- function(input, output) {
  output$map = renderLeaflet({
    leaflet() %>% addTiles() %>%
      addPolygons(data=nc, fillColor=~c('red', 'blue')[selected+1],
                  layerId=~NAME_1,
                  label=~NAME_1)
  })
  observe({
    if (input$selectable=="yes"){
      observeEvent(input$map_shape_click, ignoreInit=TRUE, {
        id = input$map_shape_click$id
        map = leafletProxy('map') %>%
          removeShape(id)

        nc_local = nc
        ix = which(nc_local$NAME_1==id)
        nc_local$selected[ix] = 1 - nc_local$selected[ix]
        nc <<- nc_local

        map %>% addPolygons(data=nc_local[ix,], fillColor=~c('red',
'blue')[selected+1],
                            layerId=id)
      })
    }else{
      #make the map  not selectable
    }
  }
  )

  xx<<-nc[nc$selected==1]
}

shinyApp(ui = ui, server = server)

On 23 March 2018 at 06:44, Kent Johnson <kent3737 at gmail.com> wrote:

> Here is a minimal example:
>
> https://gist.github.com/kent37/63c55c0bbdb0640d8c43369cdeeebdd2
>
>
>
> Kent
>
> On Thu, Mar 22, 2018 at 9:11 AM, Kent Johnson <kent3737 at gmail.com> wrote:
>
>> On Thu, Mar 22, 2018 at 7:00 AM, <r-sig-geo-request at r-project.org> wrote:
>>>
>>> Message: 1
>>> Date: Thu, 22 Mar 2018 12:37:00 +1100
>>> From: nevil amos <nevil.amos at gmail.com>
>>> To: r-sig-geo at r-project.org
>>> Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
>>>         mapedit::selectmod
>>>
>>> Hi I  am  putting together a shiny map app in which I want to allow for
>>> selection or deselection of polygons from  a map layer.
>>> Importantly At the beginning of the process I would like a subset of the
>>> polygons to be already selected ( and they can then be deselected using a
>>> click if required).
>>> The final set of selected polygons is then saved to disk.
>>>
>>> Ideally I would like to be able ( eg using a shiny action button) to
>>> reset
>>> the selection to the pre-selected polygons.
>>
>>
>> I did something very similar to this using just leaflet and shiny (no
>> mapedit). I was drawing many polygons and wanted to change the state of a
>> polygon based on a click.
>>
>> I don't have the code handy, but basically it was
>> - create an initial map drawing the polygons with the desired initial
>> state. Use a unique layerId for each polygon.
>> - listen to input$map_shape_click with observeEvent. On click, remove the
>> clicked polygon from the map with leaflet::removeShape(leafletProxy('map',
>> input$map_shape_click$layerId), change the state of the polygon, and add
>> it back to the map.
>>  - Save the state when a "Save" button is clicked.
>>
>> If there are polygons you don't want to respond to clicks, you will have
>> to filter them out in the click handler using layerId.
>>
>> See the Inputs/Events section of the leaflet docs here for more
>> information: https://rstudio.github.io/leaflet/shiny.html
>>
>> HTH,
>> kent
>>
>
>

	[[alternative HTML version deleted]]


From kent3737 at gmail.com  Mon Mar 26 14:26:09 2018
From: kent3737 at gmail.com (Kent Johnson)
Date: Mon, 26 Mar 2018 08:26:09 -0400
Subject: [R-sig-Geo] "Preselecting" shapes on leaflet map shiny using
 mapedit::selectmod
Message-ID: <CAPP0wygNDF49Ksm_dZ376aMGXhWKwk_-VC9NE=hr-bi7nBmAOw@mail.gmail.com>

>
> Date: Sun, 25 Mar 2018 23:14:36 +1100
> From: nevil amos <nevil.amos at gmail.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Fwd: "Preselecting" shapes on leaflet map shiny
>         using mapedit::selectmod
>
> Tahnks,
>
> I have adapted your code a litle to get further towards what I need., could
> not work out how to respond on the git gist site so sending to you direct.
>
> I have now set up the app so that it initially shows the preselected
> polygons, but does not allow clicking to change the selection.    changing
> the radio button "turns on" the selection,  but when I change the button
> back to no it does not trun it off again.  how do I trun of the
> map_shape_click again?
>

Remove the observe() and put the check for input$selectable inside
observeEvent(). If the input is not selectable then you ignore the click
event; if it is selectable then you handle the click. You don't need to
respond directly to changes in input$selectable.


> thanks again for your help
>
>
> # Draw a map which responds to clicks by toggling the selection state
> # of the clicked polygon.
> library(shiny)
> library(leaflet)
> library(sf)
>
> nc=st_as_sf(gadmCHE)
> nc$selected<-0
> # Initial selection
> nc$selected[nc$NAME_1%in%c("Aargau", "Appenzell Ausserrhoden", "Appenzell
> Innerrhoden",
>                            "Basel-Landschaft", "Basel-Stadt", "Bern",
> "Fribourg")]<-1
> ui <- fluidPage(
>   titlePanel("Leaflet selection demo"),
>   radioButtons(inputId = "selectable",label = "allow selection by
> clicking?",choiceNames = c("no","yes"),choices =  c("no","yes")),
>   leafletOutput('map')
> )
>
> server <- function(input, output) {
>   output$map = renderLeaflet({
>     leaflet() %>% addTiles() %>%
>       addPolygons(data=nc, fillColor=~c('red', 'blue')[selected+1],
>                   layerId=~NAME_1,
>                   label=~NAME_1)
>   })
>   observe({
>     if (input$selectable=="yes"){
>       observeEvent(input$map_shape_click, ignoreInit=TRUE, {
>         id = input$map_shape_click$id
>         map = leafletProxy('map') %>%
>           removeShape(id)
>
>         nc_local = nc
>         ix = which(nc_local$NAME_1==id)
>         nc_local$selected[ix] = 1 - nc_local$selected[ix]
>         nc <<- nc_local
>
>         map %>% addPolygons(data=nc_local[ix,], fillColor=~c('red',
> 'blue')[selected+1],
>                             layerId=id)
>       })
>     }else{
>       #make the map  not selectable
>     }
>   }
>   )
>
>   xx<<-nc[nc$selected==1]
> }
>
> shinyApp(ui = ui, server = server)

	[[alternative HTML version deleted]]


From paulofelipe.feitosa at gmail.com  Wed Mar 28 03:48:22 2018
From: paulofelipe.feitosa at gmail.com (Paulo Felipe)
Date: Tue, 27 Mar 2018 22:48:22 -0300
Subject: [R-sig-Geo] Using main memory as cache to raster objects
Message-ID: <CAEh=gUY+zx5gz+z01Vt-gmw+W7KQARojoJ=4M9TnQ6hG_xsO4A@mail.gmail.com>

Hello everyone, I am trying to use main memory in R as cache to rasters
objects, but I am having some problems with overwriting rasters in disk.

To implement the cache, I am limiting the number of rasters that can be
used in the S3 class cacheManager
<https://github.com/ufcg-lsd/SEBAL/blob/sebal-experiment/workspace/R/cacheManager.R>
.

The main features that I am trying to implement is:

   1. put a raster object, already allocated, in the cacheManager
   2. get a raster object from the cacheManager

As we know, in the first feature exist a border case, that is when the
number of raster objects is greater than the cacheManager size. In this
case, I just save in disk one of the rasters objects and put the new raster in
the cacheManager.

This solution appears be reachable, at least to me, but I am stuck in the
save to disk part. To save rasters in disk I tried to use the functions
'writeRaster' and 'writeValues'.

Specifically, my problem is when I already had a version of the same raster
written on disk, this seems to be solvable using the 'overwrite=TRUE'
parameter in the functions 'writeRaster' and 'writeValues', but I got some
errors in each implementation:

   1. writeRaster - 'filenames of source and target should be different' you
   can see this error message in the raster package code
   <https://github.com/cran/raster/blob/2.6-7/R/writeRaster.R>;
   2. writeValues - save the rasters in the disk, but when I read the
   raster from disk, all values came as NA.

Note that I have little experience with rasters and R, if you see anything
stupid or stranger, please alert me.

So, anyone has a suggestion of a better implementation to save the rasters
in disk? Or can see any error in the save in disk implementation?

*OBS: you can reproduce the error that I got just running this code
<https://github.com/ufcg-lsd/SEBAL/blob/sebal-experiment/workspace/R/cacheManager.R#L138>.*

-- 

*Paulo Felipe*

	[[alternative HTML version deleted]]


From rbarnes at umn.edu  Fri Mar 30 23:41:57 2018
From: rbarnes at umn.edu (Richard Barnes)
Date: Fri, 30 Mar 2018 15:41:57 -0600
Subject: [R-sig-Geo] Terrain Analysis
Message-ID: <51a1f2ce-6460-e052-a124-469c684929f3@umn.edu>

I am thinking of building an R wrapper for my RichDEM raster terrain
analysis library (https://richdem.readthedocs.io/en/latest/).

The library's been designed in C++ with this in mind. The only
requirement is the ability to pass pointers to raw POD arrays to the
library.

My question is: which R package would be best to use for storing/loading
raster data?

Best regards,
Richard Barnes


From alexandresantosbr at yahoo.com.br  Sat Mar 31 23:36:31 2018
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Sat, 31 Mar 2018 17:36:31 -0400
Subject: [R-sig-Geo] Estimate of the intensity of a point process,
 as a function of a marked point process as covariate.
Message-ID: <f56bf85a-30d9-2977-7dd3-2af7171bfcff@yahoo.com.br>

Dear R Sig Geo Members,

 ??? I've like to know if there are any function in any package for 
estimation density in a marked point process (e.g. geographic position 
and size of ants nests in square meters). My goal will be represents the 
density of ants nest estimated, but use nests sizes as covariate, this 
is possible?

Thanks in advanced,

Alexandre

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 99686-6970 (VIVO) (+55) 65 3221-2674 (FIXO)

         alexandre.santos at cas.ifmt.edu.br
Lattes: http://lattes.cnpq.br/1360403201088680
OrcID: orcid.org/0000-0001-8232-6722
Researchgate: www.researchgate.net/profile/Alexandre_Santos10
LinkedIn: br.linkedin.com/in/alexandre-dos-santos-87961635
Mendeley:www.mendeley.com/profiles/alexandre-dos-santos6/


