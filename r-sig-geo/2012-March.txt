From chrjan70 at gmail.com  Thu Mar  1 01:40:31 2012
From: chrjan70 at gmail.com (Christian Jansson)
Date: Wed, 29 Feb 2012 21:40:31 -0300
Subject: [R-sig-Geo] Get coordinates from huge shapefiles.
In-Reply-To: <CAAcGz9_vt5nAcOzt7nCNtMstVzXZgLm+N0yhWAVzWRkmFnkcNA@mail.gmail.com>
References: <CAAHdiqxBLMgLnwb77gwFmq-bEzJ-TUOP6KgjhONTO=0PJwCZ0Q@mail.gmail.com>
	<CAAcGz981PLRmzcEQxTKh_R_Zcu+eMBTOEHZB7VCL4-LvjatHPg@mail.gmail.com>
	<CAAcGz9_vt5nAcOzt7nCNtMstVzXZgLm+N0yhWAVzWRkmFnkcNA@mail.gmail.com>
Message-ID: <CAAHdiqxdpAz1tmZJW4pyQXSiPNw9QNrpx+5POPN5YKNtMHzAHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120229/76b612aa/attachment.pl>

From jwittische at hotmail.com  Thu Mar  1 03:04:39 2012
From: jwittische at hotmail.com (Julian WITTISCHE)
Date: Thu, 1 Mar 2012 02:04:39 +0000
Subject: [R-sig-Geo] using Arc/Info binary grid format files in R
Message-ID: <DUB112-W135AF409B973E6DFAAF98BCF6C0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/ccd546d1/attachment.pl>

From lyndon.estes at gmail.com  Thu Mar  1 04:08:10 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Wed, 29 Feb 2012 22:08:10 -0500
Subject: [R-sig-Geo] using Arc/Info binary grid format files in R
In-Reply-To: <DUB112-W135AF409B973E6DFAAF98BCF6C0@phx.gbl>
References: <DUB112-W135AF409B973E6DFAAF98BCF6C0@phx.gbl>
Message-ID: <CALuVVaasM1ub8nUqzN864d0PE8Bck-wkdE1mKHA+v-uiTRoUFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120229/347ba83e/attachment.pl>

From senawusl at yahoo.com  Thu Mar  1 05:18:39 2012
From: senawusl at yahoo.com (senani karunaratne)
Date: Wed, 29 Feb 2012 20:18:39 -0800 (PST)
Subject: [R-sig-Geo] Re-projection of stacked rasters
Message-ID: <1330575519.81148.YahooMailNeo@web113207.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120229/836df9cd/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Mar  1 07:46:22 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 01 Mar 2012 07:46:22 +0100
Subject: [R-sig-Geo] Get coordinates from huge shapefiles.
In-Reply-To: <CAAHdiqxdpAz1tmZJW4pyQXSiPNw9QNrpx+5POPN5YKNtMHzAHw@mail.gmail.com>
References: <CAAHdiqxBLMgLnwb77gwFmq-bEzJ-TUOP6KgjhONTO=0PJwCZ0Q@mail.gmail.com>
	<CAAcGz981PLRmzcEQxTKh_R_Zcu+eMBTOEHZB7VCL4-LvjatHPg@mail.gmail.com>
	<CAAcGz9_vt5nAcOzt7nCNtMstVzXZgLm+N0yhWAVzWRkmFnkcNA@mail.gmail.com>
	<CAAHdiqxdpAz1tmZJW4pyQXSiPNw9QNrpx+5POPN5YKNtMHzAHw@mail.gmail.com>
Message-ID: <4F4F1B3E.9070506@uni-muenster.de>

Mike, I am not sure, but the following toy example, which builds on the
toy data in vignette("sp"), might help:

library(sp)
Sr1 = Polygon(cbind(c(2,4,4,1,2),c(2,3,5,4,2)))
Sr2 = Polygon(cbind(c(5,4,2,5),c(2,3,2,2)))
Sr3 = Polygon(cbind(c(4,4,5,10,4),c(5,3,2,5,5)))
Sr4 = Polygon(cbind(c(5,6,6,5,5),c(4,4,3,3,4)), hole = TRUE)
Srs1 = Polygons(list(Sr1), "s1")
Srs2 = Polygons(list(Sr2), "s2")
Srs3 = Polygons(list(Sr3, Sr4), "s3/4")
SpP = SpatialPolygons(list(Srs1,Srs2,Srs3), 1:3)
spdf = SpatialPolygonsDataFrame(SpP, data.frame(a=1:3), match.ID=F)
as(spdf, "SpatialLinesDataFrame")
as(as(spdf, "SpatialLinesDataFrame"), "SpatialPointsDataFrame")
as.data.frame(as(as(spdf, "SpatialLinesDataFrame"),
"SpatialPointsDataFrame"))


On 03/01/2012 01:40 AM, Christian Jansson wrote:
> Hi Mike.
> 
> Thanks a lot! It helped one step further.
> 
> I understand that this: "lapply(p at polygons, function(x)
> dim(x at Polygons[[1]]@coords))"
> gives me the number of points per polygon, and that xy is a table of all
> coordinates. So if for example the first value in the lapply above is 14,
> then the first 14 rows of xy belong to polygon 1. How can I efficiently add
> a third column to add the polygon number per coordinate pair?
> 
> Best Regards,
> /Chris
> 
> On Wed, Feb 29, 2012 at 5:44 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> 
>> Sorry, that should have been "x at y" for the raw access to S4 elements.
>>
>> On Thu, Mar 1, 2012 at 7:44 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>>> You can do this:
>>>
>>> https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007619.html
>>>
>>> (The email archive, or my browser has auto-converted "x @ y" symbols
>>> to "x at y" rather helpfully so you will need to fix that if that's
>>> what you see).
>>>
>>> The fortify tools (in ggplot2) and the geometry/topology-sense in
>>> rgeos are important to consider though, fortify is trying to build a
>>> table that still stores all the topology so that (for e.g.) ggplot2
>>> can work with it in a standard way.
>>>
>>> Raw extraction does not take any care with whether the polygons make
>>> sense, but that takes work since shapefiles just don't store that
>>> information, they are just sets of ring boundaries and it's up to the
>>> software using them to build the actual topology. My code at that post
>>> just drops the final duplicated coordinate . . .
>>>
>>> Cheers, Mike.
>>>
>>> On Thu, Mar 1, 2012 at 5:15 AM, Christian Jansson <chrjan70 at gmail.com>
>> wrote:
>>>> Hi,
>>>>
>>>> Thanks to everyone on this list. It is a true source of help!
>>>>
>>>> I'm reading huge shapefiles like this:
>>>>
>>>> shp_0 <- rgdal::readOGR(dsn="dir", layer="TheLayer")
>>>>
>>>> There are two columns in the shp_0 at data: bin1 and bin2.
>>>>
>>>> I need to get a table with three columns: id, X, Y.
>>>>
>>>> First I do this:
>>>> shp_0 at data$id = rownames(shp_0 at data)
>>>>
>>>> When I then run this:
>>>> tbl_coords <-fortify.SpatialPolygonsDataFrame(shp_0)
>>>> I get: "Using bin1 to define regions.
>>>> Error in createPolygonsComment(p) :
>>>>  rgeos_PolyCreateComment: orphaned hole, cannot find containing polygon
>>>> for hole at index 3"
>>>>
>>>> After reading in previous messages on this email-list, I tried:
>>>>
>>>> slot(shp_0, "polygons") <- lapply(slot(shp_0, "polygons"),
>>>> checkPolygonsHoles), which proceeds to a new R-prompt with no issue
>>>> mentioned.
>>>>
>>>> But everytime I then run
>>>> shp_1 <- unionSpatialPolygons(shp_0, as.character(shp_0$id))
>>>> I get another crasch:
>>>> "This application has requested the Runtime to terminate it in an
>> unusual
>>>> way.
>>>> Please contact the application's support team for more information."
>>>>
>>>> How can I get the coordinates per polygon in one large table? I know
>> how to
>>>> get them per polygon, but to rbind more than 30 000 polygons take
>> forever.
>>>> To get the areas is easy "sapply(shp_0 at polygons, function(x) x at area)",
>> but
>>>> the coords are deeper into the sp-object and I don't know how to
>> "apply-it
>>>> out".
>>>>
>>>> Thank you very much for all help.
>>>>
>>>> /Chris
>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Michael Sumner
>>> Institute for Marine and Antarctic Studies, University of Tasmania
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From camille.leclerc at ymail.com  Thu Mar  1 09:28:03 2012
From: camille.leclerc at ymail.com (Camille Leclerc)
Date: Thu, 1 Mar 2012 08:28:03 +0000 (GMT)
Subject: [R-sig-Geo] Calculating the distance metric between two raster
	layers
Message-ID: <1330590483.21844.YahooMailNeo@web132106.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/471e54fe/attachment.pl>

From aliceschaffhauser at yahoo.fr  Thu Mar  1 10:51:56 2012
From: aliceschaffhauser at yahoo.fr (alice schaffhauser)
Date: Thu, 1 Mar 2012 09:51:56 +0000 (GMT)
Subject: [R-sig-Geo] Density
In-Reply-To: <1329990929.32811.YahooMailNeo@web171604.mail.ir2.yahoo.com>
References: <1329821662.11728.YahooMailNeo@web171616.mail.ir2.yahoo.com>
	<1329990929.32811.YahooMailNeo@web171604.mail.ir2.yahoo.com>
Message-ID: <1330595516.6110.YahooMailNeo@web171601.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/ca940eb4/attachment.pl>

From lisa.freudenberger at web.de  Thu Mar  1 11:42:13 2012
From: lisa.freudenberger at web.de (Lisa Freudenberger)
Date: Thu, 1 Mar 2012 11:42:13 +0100 (CET)
Subject: [R-sig-Geo] (no subject)
Message-ID: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/882d94b3/attachment.html>

From edzer.pebesma at uni-muenster.de  Thu Mar  1 16:03:08 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 01 Mar 2012 16:03:08 +0100
Subject: [R-sig-Geo] speed problem with %over% function
In-Reply-To: <161DC602615F6943A19BAEA3DBF2E4B90186A462064A@HARFANG.intranet.mrn.gouv>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A462064A@HARFANG.intranet.mrn.gouv>
Message-ID: <4F4F8FAC.1050900@uni-muenster.de>

Bastien, your report is very helpful.

I believe I managed to get overlay()'s efficiency back into the over()
methods. Because of the way the code is set up for over(), the
efficiency gain will propagate to all over() methods where the second
argument has attributes. Committed to svn on r-forge; will submit to
CRAN after all dependency tests passed.

Gregor's example now runs in less than 400 Mb RAM, in 22 secs.

Bastiens:
> ### The overlay() function
> system.time(plac.dans.contour1 <- overlay(grille.plac, shape) )
   user  system elapsed
  2.920   0.000   2.928
> system.time(plac.dans.contour2<-grille.plac%over%shape)
   user  system elapsed
  6.444   0.028   6.493
so there's still some overhead going on, but less dramatic.

The reason for deprecating overlay() is not so much that it doesn't
work, but its inconsistency: overlay(x,y) does the same as overlay(y,x)
for certain combinations x,y (notably points,polygons). Improving its
behaviour would break any script that depend on the inconsistency.

In contrast, over(x,y) consistently retrieves the index of y, or if y
has attributes the attributes of y, at spatial locations of x. Note that
that operation is asymmetrical: over(x,y) does not equal over(y,x) if x
and y differ.

Best regards,


On 02/29/2012 05:19 PM, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:
> Thanks to Francis and Edzer for their responses.
> 
> I been working on my problem for the last 2 days and I managed to get some very interesting information.  I also prepared a reproducible example so people can try it.
> 
> I've found 3 functions that do the thing I want:
> 1) %over%
> 2) overlay()  (which is deprecated)
> 3) gIntersection()  (from the rgeos package)
> 
> So I've tried them all on my data to compare the speed between each of them and ArcGIS.  The punchline of my analysis is that %over% is the slowest (and by a lot) of all functions including ArcGIS.  overlay() is the fastest.
> 
> To get these results, here is a reproducible example:
> 
> ### first, download the shapes from:
> ### http://www.nceas.ucsb.edu/files/scicomp/demo/read-write-shapefiles.zip
> ### This is not my files, I took them from the example at:
> ### http://www.nceas.ucsb.edu/scicomp/usecases/ReadWriteESRIShapeFiles
> 
> ###  Use the rgdal library to read the files
>> library(rgdal)
>> shape <- readOGR("C:\\Documents and Settings\\ferba1\\Bureau\\shape","nw-counties")
> OGR data source with driver: ESRI Shapefile
> Source: "C:\Documents and Settings\ferba1\Bureau\shape", layer: "nw-counties"
> with 208 features and 8 fields
> Feature type: wkbPolygon with 2 dimensions
> 
> # choose only one territory to make the analysis easier
>> shape <- shape[shape at data$COUNTYNAME=="Lemhi",]
>> plot(shape, axes=T)
> 
>> etendu <- bbox(shape)
> 
> # this code is used to transfer km in degre-decimals. It's not necessary to
> # understand it for this problem.  The only important part is that you can
> # change "separation" to increase the density of the grid. "separation"
> # represent the distance between the grid point, in that example 0.5km.
>> separation <- 0.5
>> circ.minlat <- 2*pi*6378.16*cos(pi*etendu[2,1]/180)
>> pas.degre.lon <- circ.minlat/360
>> nb.degre.lon <- separation/pas.degre.lon
>> pas.degre.lat <- 111.3199
>> nb.degre.lat <- separation/pas.degre.lat
> ###
> 
> # make the grid
>> grille.plac <- GridTopology(etendu[,1],
> +                             cellsize=c(nb.degre.lon,nb.degre.lat),
> +                             cells.dim=(ceiling((etendu[,2]-etendu[,1])/c(nb.degre.lon,nb.degre.lat))+2))
> 
>> grille.plac <- coordinates(grille.plac)
> 
>> grille.plac <- SpatialPointsDataFrame( grille.plac,data.frame(plac_ID=1:nrow(grille.plac)), proj4string = CRS(proj4string(shape)))
> 
> 
>> points(grille.plac,col="blue", pch=".")
> 
> ### The overlay() function
>> system.time(plac.dans.contour1 <- overlay(grille.plac, shape) )
>    user  system elapsed
>    2.33    0.00    2.34
>> grille.plac1 <- grille.plac[!is.na(plac.dans.contour1),]
>> points(grille.plac1,col="red", pch=".")
> 
> ###  The %over% function
>> system.time(plac.dans.contour2<-grille.plac%over%shape)
>    user  system elapsed
>  953.72    2.33  960.80
>> grille.plac2 <- grille.plac[!is.na(plac.dans.contour2)[,1],]
>> points(grille.plac2,col="yellow", pch=".")
> 
> ###  The gIntersection() function
> library(rgeos)
>> system.time(grille.plac3 <- gIntersection(grille.plac, shape))
>    user  system elapsed
>   37.83    0.05   37.99
>> points(grille.plac3,col="green", pch=".")
> 
> ###  end of code
> 
> As you can see, the %over% function is the slowest with 961 seconds to run.  The overlay() function was the best with 2.34 seconds to run.  The gIntersection was in the middle with 38 seconds to run.  Finally, the intersection tool of ArcGIS took 20 seconds to do the same thing.  Those times seem to be context specific, as in my problem, gIntersection() was the slowest with 799 seconds, while %over% did the task in 250 seconds and overlay() in 119.  overlay() was still the fastest function.
> 
> So, it seems there clearly is room for amelioration of the %over% function.  And my next question is, why is overlay() deprecated? In the help, it says: "This function is deprecated, as it has some inconsistences." but I did not find any reference on what are those "inconsistences".  Going from overlay() to %over% seems more like a downgrade than a upgrade to me.  I implemented overlay() in my code instead of %over%, saving an incredible amount of time. However I'm a little stressed about it as it may cause problems or I may lose the function in a future version of the sp package.
> 
> So I guess anybody motivated to ameliorate the %over% function could start by understanding the difference between it and the overlay() function.  Sadly, I'm no programmer so I can' help here.
> 
> Best regards,
> Bastien Ferland-Raymond
> 
> 
> Date: Tue, 28 Feb 2012 11:38:04 -0500
> From: Francis Markham <francis.markham at anu.edu.au>
> 
> I've had examples in the past where using %over% from the sp package takes
> all available RAM (7GB) and several hours, while ArcGIS takes about 300MB
> and 5 minutes, so I would agree that there is plenty of room for
> improvement here. I'll try to give a reproducable example in the coming
> weeks when I return from travel.
> 
> This is a critical issue for me insofar as spatial joins are a routine
> procedure for me and but without reasonable speed for producedures such as
> this I cannot perform all my analysis in R, making for a more complex,
> error prone work flow and scuttling the possibility of "reproducable
> research."
> 
> On a related note, does the 'sp' package have an accessible bug tracker?
> I'd like to be able to contribute to improving this very useful package if
> at all possible, but I'm not sure where to begin.
> 
> Warm regards,
> 
> Francis Markham
> Research Associate
> Fenner School of Environment and Society
> Australian National University
> 
> On 27 February 2012 19:18, Edzer Pebesma <edzer.pebesma at uni-muenster.de>wrote:
> 
>> Dear Bastien,
>>
>> the %over% method was primary written to work, and it seems that it did.
>>
>> It is hard to tell why ArcGIS is so much faster without access to its
>> source code, and your data. Chances are that it uses a spatial index,
>> and R does not.
>>
>> Talking about spatial indexes, you might want to try %over% in package
>> rgeos (essentially after loading rgeos) as that seems to use a spatial
>> index. Providing a reproducible example is always more inviting for
>> someone on the list (possible me) to look deeper into this.
>>
>> If you want to obtain points on a regular grid within a polygon,
>> sp::spsample with type "regular" may be an alternative route. Package
>> raster may have more efficient routines for many things.
>>
>> On 02/27/2012 09:54 AM, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:
>>> Dear geo-list,
>>>
>>> I'm just starting using R and the rgdal package to manage and create
>> some shapes and I am hitting some speed issues while using the %over%
>> function. R is significantly slower than ArcGIS.
>>>
>>> Here is what I'm doing (I've shorten the code to make it easier to
>> follow, I don't expect it to be reproducible).
>>>
>>> # I first load a shape giving the perimeter of the territory of interest
>>> terr <- readOGR("D:\\Couches GIS\\06152\\contour",
>> "contour_carto06152_Project")
>>>
>>> # I then want to make a grid of points.  The grid is very dense and
>> rectangular
>>> # to do so, I first make a gridtopology
>>> grille.plac.temp1 <- GridTopology(...)
>>>
>>> # and get all the coordinates from the grid
>>> grille.plac.temp2 <- coordinates(grille.plac.temp1)
>>>
>>> # and finally transform it to a SpatialPointsDataFrame object
>>> grille.plac <-
>> SpatialPointsDataFrame(grille.plac.temp2,data.frame(1:nrow(grille.plac.temp2)),proj4string
>> =CRS(proj4string(terr)))
>>>
>>> # The grid is very big as it is a rectangle in which you can fit the
>> territory shape
>>> # (which is of irregular shape). I then want to reduce it's size by
>> keeping only
>>> # to points from the grid that are in the territory.  I use the %over%
>> function to do
>>> # that.  This is the slow part.
>>> system.time(plac.dans.contour<-grille.plac%over%contour)
>>>    user  system elapsed
>>> 1420.23    9.57 1435.17
>>>
>>> # I then make a new shape with only the points from the grid that are in
>> the territory
>>> grille.plac.reduce <- grille.plac[as.vector(!is.na(plac.dans.contour)),]
>>>
>>>
>>> This code works fine and produce what I want it to produce. However, the
>> %over% functions takes 24 minutes to run, while ArcGIS can run it in less
>> than 1 minute with the intersect tool.  Is there a more efficient function
>> than %over% to do what I want?  Is it normal that ArcGIS is that much
>> faster than R in that case?
>>>
>>> Thanks for your help,
>>>
>>> Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
>>> Division des orientations et projets sp?ciaux
>>> Direction des inventaires forestiers
>>> Minist?re des Ressources naturelles et de la Faune du Qu?bec
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
>         [[alternative HTML version deleted]]
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From basille at ase-research.org  Thu Mar  1 16:18:37 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Thu, 01 Mar 2012 10:18:37 -0500
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>
Message-ID: <4F4F934D.8090805@ase-research.org>

Dear Lisa,

Please use a sensible subject in the future (I corrected it for better 
archiving and to help you get more answers).

The specialization can not be interpreted in terms of explained variance. 
The specialization on any axis is the ratio of the available variance over 
the used variance, which do not sum up to 1 on every axis. The 
specialization values are given by the eigenvalues of an enfa object. Let's 
take the example in ?enfa:

library(adehabitatHS)

data(lynxjura)
map <- lynxjura$map
locs <- lynxjura$locs
locs <- locs[slot(locs, "data")[,2]!="D",]
slot(map,"data")[,4] <- sqrt(slot(map,"data")[,4])
tab <- slot(map, "data")
pr <- slot(count.points(locs, map), "data")[,1]
pc <- dudi.pca(tab, scannf = FALSE)
(enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))

Here, the variance available on the first axis of specialization is 1.57 
times higher than the variance used on this axis. We can actually compute 
these values using the ratio of variances:

niche1 <- enfa1$li[rep(1:length(enfa1$pr), enfa1$pr), ]
sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe1^2)/sum(niche1$Spe1^2)
sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe2^2)/sum(niche1$Spe2^2)
enfa1$s

Note, however, that the marginality axis also accounts for some 
marginality. To compute the specialization on the marginality axis, it is 
exactly the same approach:

sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar - 
mean(niche1$Mar))^2)

Hope this helps,
Mathieu.


Le 01/03/2012 05:42, Lisa Freudenberger a ?crit :
> Dear all,
>
> I hope this is the right place to post my question and that someone might
> be able to help me. I am performing an ENFA with species data and
> environmental variables unsing the adehabitat package. What I know how to
> get are the eigenvalues of the specialization axes and the coefficients for
> all environmental variables.
>
> However I was wondering how you can calculate the percentage of variance
> (specialization) explained by each axis from these data. As I know the
> marginality axis always explains the whole marginality as well as part of
> the specialization. My initial thought was to sum up all eigenvalues and
> calculate the proportional values for each eigenvalue, meaning
> eigenvalue/sum of eigenvalues. But as I do not get an eigenvalue for the
> marginality axis I can?t build the sum of all of them.
>
> Does anyone of you have an idea how to solve this problem?
>
> Any help is appreciated!
>
> All the best
> Lisa
>
>
> Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r iPhone
> und Android.
> *https://produkte.web.de/freemail_mobile_startseite/*
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From godina at dal.ca  Thu Mar  1 16:39:23 2012
From: godina at dal.ca (Aurelie C.Godin)
Date: Thu, 1 Mar 2012 07:39:23 -0800 (PST)
Subject: [R-sig-Geo] Loosmore and Ford (2006) Goodness-of-fit (GoF) test for
	CSR
Message-ID: <1330616363370-7332928.post@n2.nabble.com>

Dear all, 

I am trying to use Loosmore and Ford (2006) GoF test for CSR. I was
wondering if anyone here is familiar with this test and could help me coding
it with my data. Or perhaps suggest something else.

The authors provided an R source code and user's guide for the
implementation of their statistical test described in their paper. Available
at: http://www.esapubs.org/archive/ecol/E087/120/suppl-1.htm#anchorAuthors
http://www.esapubs.org/archive/ecol/E087/120/suppl-1.htm#anchorAuthors 

There are multiple steps and I am not quiet sure if I need to run them all
or not... but regardless, I get an error message at step 1 (see below)!

 "GR" is my point pattern (with my marks of specific interest) and it is a
subset of "OT". Basically, I want to test the Ho : that my marks (GR) are
distributed randomly within the non-random spatial distribution of my event
(OT).

http://r-sig-geo.2731867.n2.nabble.com/file/n7332928/OTGR.RData OTGR.RData 

> OT
 planar point pattern: 2691 points 
window: polygonal boundary
enclosing rectangle: [-80, -57.6343] x [66.25, 78.16666] units  

> GR 
 planar point pattern: 563 points 
window: polygonal boundary
enclosing rectangle: [-80, -57.6343] x [66.25, 78.16666] units  

Loosmore & Ford GoF 

source("http://www.esapubs.org/archive/ecol/E087/120/cedl_scr.r")
library(spatstat)
# STEP 1 in Loosmore & Ford R code
# gen.ext.pp.list() generates an external CSR point pattern list.  
#Note, this function overwrites any externally named variables `my.pp.list'
and `pp.indx' if they already exist.                                 
# input variables:                                                       
#  - nsim.pp is the number of simulated point patterns in this list    
#  - npts is the number of points in each pattern                        
#  - type is the pattern type to be generated                             

gen.ext.pp.list <- function(99, GR$n, type="CSR")
{
  # create a blank list at the top level environment
  my.pp.list <<- c()   # should be equivalent to <<- NULL
  # now popoulate it with the appropriate patterns.
  for (i in 1:99)
    if (type=="CSR")
      my.pp.list[[i]] <<- runifpoint(GR$n)
  else    # for now, just have an inhibition option
    my.pp.list[[i]] <<- rSSI(r=0.0045, n=GR$n,
                             giveup=10000)
  
  # lastly, create the top level index to the pattern list
  pp.indx <<- 1
  # nothing to return because the list is created externally.
  return(0)
}

>Error: object 'type' not found

Thank you very much in advance,
Best,



 

-----
Aurelie Cosandey-Godin
Ph.D. Student, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Loosmore-and-Ford-2006-Goodness-of-fit-GoF-test-for-CSR-tp7332928p7332928.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Virgilio.Gomez at uclm.es  Thu Mar  1 20:36:20 2012
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Thu, 01 Mar 2012 20:36:20 +0100
Subject: [R-sig-Geo] Strange results in DCluster package
In-Reply-To: <1330459743739-7326832.post@n2.nabble.com>
References: <1330459743739-7326832.post@n2.nabble.com>
Message-ID: <1330630580.3364.4.camel@Virgilio-Gomez>

Dear Corey,

Many thanks for reporting this. I have checked your code and the data and 
I cannot find a problem in
kn.iscluster. The only issue is that the log-test statistic in some
cases is large (e.g., 12225.064474) and when the test statistic is
computed, then R returns Inf.

I have changed the code so that argument log.v=TRUE can be set in a call
to opgam() and it is passed to kn.iscluster. Hence, the log-test
statistic is returned. The package should appear on CRAN in one day or two but I 
can send you the source code if you are in a hurry.

With the new version, you can write:

knres<-opgam(data=sa, thegrid=sa[,c("x", "y")], alpha=.05, R=999, 
iscluster=kn.iscluster, fractpop=.25, model="poisson", mle=mle, log.v=TRUE) 


and you will get something like this:

           x       y    statistic cluster pvalue size
1   549400.3 3255340 12225.064474       1  0.001    1
2   550731.4 3255426  9525.112869       1  0.001    4
3   550353.6 3253989  6416.805872       1  0.001    8
4   548815.9 3254113 10258.441514       1  0.001    3
(...)

In order to get the most likely cluster, you can compare the 
returned (log)-statistics.

Hope this helps.

Best,

Virgilio


From E.Couce.07 at bristol.ac.uk  Thu Mar  1 21:46:02 2012
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Thu, 1 Mar 2012 12:46:02 -0800 (PST)
Subject: [R-sig-Geo] writeRaster can't find driver
Message-ID: <1330634762932-7334042.post@n2.nabble.com>

Dear all,

having recently updated my versions of R and of the raster library, I'm
encountering problems when writing out geographical data with commands that
previously worked fine. The error appears to be due to "missing drivers":

> require(raster)
Loading required package: raster
raster version 1.9-70 (27-February-2012)
> writeRaster(grid_raster, filename='test.bil', format='EHdr',
> overwrite=TRUE)
Error in .local(.Object, ...) : No driver registered with name: BIL

However the 'EHdr' driver is installed, so I dont really understand why
writeRaster can't find it:

>  writeFormats()
      name        long_name                                
 [1,] "raster"    "R-raster"                               
 [2,] "SAGA"      "SAGA GIS"                               
 [3,] "IDRISI"    "IDRISI"                                 
 [4,] "BIL"       "Band by Line"                           
 [5,] "BSQ"       "Band Sequential"                        
 [6,] "BIP"       "Band by Pixel"                          
 [7,] "ascii"     "Arc ASCII"                              
 [8,] "ADRG"      "ARC Digitized Raster Graphics"          
 [9,] "BMP"       "MS Windows Device Independent Bitmap"   
[10,] "BT"        "VTP .bt (Binary Terrain) 1.3 Format"    
[11,] "EHdr"      "ESRI .hdr Labelled"                     
[12,] "ELAS"      "ELAS"                                   
[13,] "ENVI"      "ENVI .hdr Labelled"                     
[14,] "ERS"       "ERMapper .ers Labelled"                 
[15,] "FITS"      "Flexible Image Transport System"        
[16,] "GSBG"      "Golden Software Binary Grid (.grd)"     
[17,] "GTiff"     "GeoTIFF"                                
[18,] "GTX"       "NOAA Vertical Datum .GTX"               
[19,] "HDF4Image" "HDF4 Dataset"                           
[20,] "HFA"       "Erdas Imagine Images (.img)"            
[21,] "IDA"       "Image Data and Analysis"                
[22,] "ILWIS"     "ILWIS Raster Map"                       
[23,] "INGR"      "Intergraph Raster"                      
[24,] "ISIS2"     "USGS Astrogeology ISIS cube (Version 2)"
[25,] "JP2ECW"    "ERDAS JPEG2000 (SDK 3.x)"               
[26,] "LAN"       "Erdas .LAN/.GIS"                        
[27,] "Leveller"  "Leveller heightfield"                   
[28,] "netCDF"    "Network Common Data Format"             
[29,] "NITF"      "National Imagery Transmission Format"   
[30,] "NTv2"      "NTv2 Datum Grid Shift"                  
[31,] "PAux"      "PCI .aux Labelled"                      
[32,] "PCIDSK"    "PCIDSK Database File"                   
[33,] "PNM"       "Portable Pixmap Format (netpbm)"        
[34,] "RMF"       "Raster Matrix Format"                   
[35,] "RST"       "Idrisi Raster A.1"                      
[36,] "SAGA"      "SAGA GIS Binary Grid (.sdat)"           
[37,] "SGI"       "SGI Image File Format 1.0"              
[38,] "Terragen"  "Terragen heightfield"   

Information about my system:

> sessionInfo()
R version 2.14.2 (2012-02-29)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] raster_1.9-70 rgdal_0.7-8   sp_0.9-95    

loaded via a namespace (and not attached):
[1] grid_2.14.2    lattice_0.20-0 tools_2.14.2  


Any help would be greatly appreciated!

Cheers
Elena 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/writeRaster-can-t-find-driver-tp7334042p7334042.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Fri Mar  2 01:41:11 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 1 Mar 2012 16:41:11 -0800
Subject: [R-sig-Geo] writeRaster can't find driver
In-Reply-To: <1330634762932-7334042.post@n2.nabble.com>
References: <1330634762932-7334042.post@n2.nabble.com>
Message-ID: <CANtt_hxYa1GSXrAs3t6uCG3Mrt2TVqaiK0Qk0d8Th80kUDhq7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/785e6033/attachment.pl>

From JhunjhnuwalaK at landcareresearch.co.nz  Fri Mar  2 02:51:15 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Fri, 2 Mar 2012 14:51:15 +1300
Subject: [R-sig-Geo] reading a list of text files as rasters
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/ba3b30b8/attachment.pl>

From HodgessE at uhd.edu  Fri Mar  2 03:38:11 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 1 Mar 2012 20:38:11 -0600
Subject: [R-sig-Geo] trouble with writeOGR
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58E86@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/19cae6f3/attachment.pl>

From lyndon.estes at gmail.com  Fri Mar  2 03:55:15 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Thu, 1 Mar 2012 21:55:15 -0500
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <CALuVVaY75dwQaLpzMb0H-8C5G+nFXbRFvDawcCSjAY8KSOScHA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/57f24126/attachment.pl>

From JhunjhnuwalaK at landcareresearch.co.nz  Fri Mar  2 04:00:36 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Fri, 2 Mar 2012 16:00:36 +1300
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <CALuVVaY75dwQaLpzMb0H-8C5G+nFXbRFvDawcCSjAY8KSOScHA@mail.gmail.com>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
	<CALuVVaY75dwQaLpzMb0H-8C5G+nFXbRFvDawcCSjAY8KSOScHA@mail.gmail.com>
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D32F7@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/7a4756e7/attachment.pl>

From lyndon.estes at gmail.com  Fri Mar  2 04:10:57 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Thu, 1 Mar 2012 22:10:57 -0500
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D32F7@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
	<CALuVVaY75dwQaLpzMb0H-8C5G+nFXbRFvDawcCSjAY8KSOScHA@mail.gmail.com>
	<F2969C1B08CBEE42B78C04C280D578E73BFD4D32F7@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <CALuVVaYGHX8xk9WRbGHS7X0Xv+fffxKdQWZse4yf7kJtkh6kKg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/ccb32023/attachment.pl>

From lyndon.estes at gmail.com  Fri Mar  2 04:28:44 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Thu, 1 Mar 2012 22:28:44 -0500
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3308@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
	<CALuVVaY75dwQaLpzMb0H-8C5G+nFXbRFvDawcCSjAY8KSOScHA@mail.gmail.com>
	<F2969C1B08CBEE42B78C04C280D578E73BFD4D32F7@donkey.landcare.ad.landcareresearch.co.nz>
	<CALuVVaYGHX8xk9WRbGHS7X0Xv+fffxKdQWZse4yf7kJtkh6kKg@mail.gmail.com>
	<F2969C1B08CBEE42B78C04C280D578E73BFD4D3308@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <CALuVVaasZ8LhmHJ17019BKiNjkVWdqGrP1W6U4ROKdsC1CW-BA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/88a12143/attachment.pl>

From r.hijmans at gmail.com  Fri Mar  2 05:18:09 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 1 Mar 2012 20:18:09 -0800
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <CANtt_hw0Fk7d8vkbpi1tPXqSJF9zC_6EsQY195M_49j91F7x9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/48da7965/attachment.pl>

From r.hijmans at gmail.com  Fri Mar  2 06:36:23 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 1 Mar 2012 21:36:23 -0800
Subject: [R-sig-Geo] Re-projection of stacked rasters
In-Reply-To: <1330575519.81148.YahooMailNeo@web113207.mail.gq1.yahoo.com>
References: <1330575519.81148.YahooMailNeo@web113207.mail.gq1.yahoo.com>
Message-ID: <CANtt_hzcGvd4Sjgweru=oHdymgrok0Y4PWg-bKWNkLVd7gWxgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120301/daccdba0/attachment.pl>

From cebulmer at telus.net  Fri Mar  2 07:23:46 2012
From: cebulmer at telus.net (Chuck Bulmer)
Date: Thu, 1 Mar 2012 22:23:46 -0800 (PST)
Subject: [R-sig-Geo] rsaga multi.local.function
In-Reply-To: <4F4C01FA.7080208@uwaterloo.ca>
References: <000301ccf4a8$a5abbb00$f1033100$@telus.net>
	<4F4C01FA.7080208@uwaterloo.ca>
Message-ID: <1330669426748-7335569.post@n2.nabble.com>

Thanks for your reply Alex.

I am applying randomForest as a classification problem. 

and the outcome is a parent material class expressed as character (M,F,G,C
etc).

Here is the code I'm using for rf (reduced to 3 variables):

PGMRF<- randomForest(PGM_1 ~ ELEV+AACN+CNBL, data=PGM, importance=TRUE,
proximity=FALSE, TYPE=classification)


.. and the first lines of the data file PGM:
      PGM_1      ELEV      AACN      CNBL
1         M 1433.43 164.87 1268.56 


.. and the first line of output from the predict method   
PGMpred <- predict(PGMRF, PGM)
print (PGMpred)
1     2     3     4     5     6     7     8     9    10    11    12    13 
 M     M     M     M     M     M     M     M     M     M     M     M     M 

So it seems the rf prediction is working.. (?)
All I need to do now (I think) is to predict for each cell in the area based
on the values in a set of grids, then assign the results to a grid.

I'm new to this so undoubtedly have made some mistakes,,, 

Could you possibly suggest an alternative method if I've got it wrong??

ps I have tried again on a separate computer and get the same results as in
my original post, so it seems that 'sometimes', multi.local.function is able
to convert the characters to numeric and write them to the grid, but not
always.. Multi.focal.function seems to do that 'conversion' more reliably..
Curious!

Thanks again

Chuck



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rsaga-multi-local-function-tp7319490p7335569.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From marcelino.delacruz at upm.es  Fri Mar  2 08:18:11 2012
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Fri, 02 Mar 2012 08:18:11 +0100
Subject: [R-sig-Geo] Loosmore and Ford (2006) Goodness-of-fit (GoF) test
	for CSR
In-Reply-To: <1330616363370-7332928.post@n2.nabble.com>
Message-ID: <mTEvdhsG.1330672691.5123510.marcelino.delacruz@upm.es>

Hi Aurelie,

Please find below my own version of the Loosmore and Ford GOF test.

You only need to compute an envelope object  with the argument
savefuns=TRUE, and then run Lof.gof on the result.

Example:

>data(nztrees)
>nztrees.env <- envelope(nztrees, Kest, r=seq(0, 25, by=0.5),savefuns=TRUE)
> LF.gof(nztrees.env)
$u
[1] 126421.9

$p
[1] 0.29


LF.gof gives you the result of the summary statistic (u) and its p-value
(p)

The arguments of LF.gof are "X" = the envelope object and "rmin" and
"rmax" that define the limits of integration to compute the summary
statistics.

By the way, maybe I'm wrong but it seems to me that you are trying to
test the random labelling hypothesis instead of CSR.
If this is true, you should go this way:

# first create a list of simulated patterns
nsim  <- 99
GROT <- superimpose(GR, OT)
sim <-list()
for (i in 1:nsim) {sim[[i]] = rlabel(GROT); sim[[i]] <-
sim[[i]][sim[[i]]$marks=="GR"]}

# then compute the envelopes

GR.env <- envelope (GR, Kest, simulate = sim)

# then compute the GOF test

LF.gof(GR.env)



HTH,

Marcelino





#############################################################################
#
#  Loosmore and Ford (2006) GOF test
#
#############################################################################

LF.gof<- function(X, rmin=NULL, rmax=NULL){
   require(spatstat)

    gmin <- NULL
    gmax <- NULL

    r <- as.data.frame(attributes(X)$simfuns)[,1]

     H1 <- X$obs

    Hi <- as.data.frame(attributes(X)$simfuns)[,-1]

   #Join observed and simulated functions
    H <- cbind(H1,Hi)

    # select the range of integrable results
    if (!is.null(rmin)) gmin <- r >= rmin
    if (!is.null(rmax)) gmax <- r  <= rmax

    if (!is.null(gmin) & !is.null(gmax)){ simfuns <- simfuns[gmin &
gmax,]; Hobs <- Hobs[gmin & gmax]}
    if (!is.null(gmin) & is.null(gmax)) {simfuns <- simfuns[gmin,]; Hobs
<- Hobs[gmin]}
    if (is.null(gmin) & !is.null(gmax)) {simfuns <- simfuns[gmax,]; Hobs
<- Hobs[gmax]}

    s <- dim(H)[2]

    # compute summary statistics for the observed (i.e., first) pattern
    Hmeans <- rowSums (H[,-1],  na.rm = FALSE)/(s-1)
    u <- sum((H[,1]-Hmeans)^2)

     # compute summary statistics for the simulated patterns
     for ( i in 2:s) {
         Himeans <- rowSums (H[,-i])/(s-1)
         u <- c(u, sum((H[,i]-Himeans)^2))
       }
     p <-  1-((rank(u)[1]-1)/(s))

return(list(u=u[1], p=p))
}
###############################################################################
















Con fecha 1/3/2012, "Aurelie C.Godin" <godina at dal.ca> escribi?:

>Dear all,
>
>I am trying to use Loosmore and Ford (2006) GoF test for CSR. I was
>wondering if anyone here is familiar with this test and could help me coding
>it with my data. Or perhaps suggest something else.
>
>The authors provided an R source code and user's guide for the
>implementation of their statistical test described in their paper. Available
>at: http://www.esapubs.org/archive/ecol/E087/120/suppl-1.htm#anchorAuthors
>http://www.esapubs.org/archive/ecol/E087/120/suppl-1.htm#anchorAuthors
>
>There are multiple steps and I am not quiet sure if I need to run them all
>or not... but regardless, I get an error message at step 1 (see below)!
>
> "GR" is my point pattern (with my marks of specific interest) and it is a
>subset of "OT". Basically, I want to test the Ho : that my marks (GR) are
>distributed randomly within the non-random spatial distribution of my event
>(OT).
>
>http://r-sig-geo.2731867.n2.nabble.com/file/n7332928/OTGR.RData OTGR.RData
>
>> OT
> planar point pattern: 2691 points
>window: polygonal boundary
>enclosing rectangle: [-80, -57.6343] x [66.25, 78.16666] units
>
>> GR
> planar point pattern: 563 points
>window: polygonal boundary
>enclosing rectangle: [-80, -57.6343] x [66.25, 78.16666] units
>
>Loosmore & Ford GoF
>
>source("http://www.esapubs.org/archive/ecol/E087/120/cedl_scr.r")
>library(spatstat)
># STEP 1 in Loosmore & Ford R code
># gen.ext.pp.list() generates an external CSR point pattern list.
>#Note, this function overwrites any externally named variables `my.pp.list'
>and `pp.indx' if they already exist.
># input variables:
>#  - nsim.pp is the number of simulated point patterns in this list
>#  - npts is the number of points in each pattern
>#  - type is the pattern type to be generated
>
>gen.ext.pp.list <- function(99, GR$n, type="CSR")
>{
>  # create a blank list at the top level environment
>  my.pp.list <<- c()   # should be equivalent to <<- NULL
>  # now popoulate it with the appropriate patterns.
>  for (i in 1:99)
>    if (type=="CSR")
>      my.pp.list[[i]] <<- runifpoint(GR$n)
>  else    # for now, just have an inhibition option
>    my.pp.list[[i]] <<- rSSI(r=0.0045, n=GR$n,
>                             giveup=10000)
>
>  # lastly, create the top level index to the pattern list
>  pp.indx <<- 1
>  # nothing to return because the list is created externally.
>  return(0)
>}
>
>>Error: object 'type' not found
>
>Thank you very much in advance,
>Best,
>
>
>
>
>
>-----
>Aurelie Cosandey-Godin
>Ph.D. Student, Department of Biology, Dalhousie University
>Industrial Graduate Fellow, WWF-Canada
>Email: godina at dal.ca | Web: wormlab.biology.dal.ca
>
>--
>View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Loosmore-and-Ford-2006-Goodness-of-fit-GoF-test-for-CSR-tp7332928p7332928.html
>Sent from the R-sig-geo mailing list archive at Nabble.com.
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From lisa.freudenberger at web.de  Fri Mar  2 09:16:03 2012
From: lisa.freudenberger at web.de (Lisa Freudenberger)
Date: Fri, 2 Mar 2012 09:16:03 +0100 (CET)
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <4F4F934D.8090805@ase-research.org>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>,
	<4F4F934D.8090805@ase-research.org>
Message-ID: <trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/666cbb90/attachment.html>

From JhunjhnuwalaK at landcareresearch.co.nz  Fri Mar  2 12:03:30 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Sat, 3 Mar 2012 00:03:30 +1300
Subject: [R-sig-Geo] reading a list of text files as rasters
In-Reply-To: <CANtt_hw0Fk7d8vkbpi1tPXqSJF9zC_6EsQY195M_49j91F7x9Q@mail.gmail.com>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D328B@donkey.landcare.ad.landcareresearch.co.nz>
	<CANtt_hw0Fk7d8vkbpi1tPXqSJF9zC_6EsQY195M_49j91F7x9Q@mail.gmail.com>
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3354@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120303/3dabdf0e/attachment.pl>

From JRadinger at gmx.at  Fri Mar  2 12:28:10 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Fri, 02 Mar 2012 12:28:10 +0100
Subject: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack
Message-ID: <20120302112810.282040@gmx.net>

Hi,

I want to use raster maps for Species Distribution Modelling (SDM) with
the package 'dismo'. Therefore I load several rastermaps (around 60) with the readRAST6 command. For further processing I want to transform them into a raster stack. Each of the raster has the same spatial extent and the same resolution (per rastermap: around 765000 cells, thereof 760000 NA's, 5000 non null cells).

The readRAST6 command to load all rasters in one step into a SpatialGridDataFrame works really good (1-2 min). The problem now is the tranformation into a stack. This takes very long time (I waited for 45 min), the CPU is mostly 100%, the pyhsical memory usage 3 GB (only a few MB left) and the virtual memory usage for R 3 GB, the HDD activity 20-30 MB/Sec data written. So my Computer seem to be at its maximum, and I don't have access to a faster/better one. I am doint all my R processes within an Eclipse workspace.

What I do:
rast <- readRAST6(rast.list, cat=(FALSE,length(rast.list)), ignore.stderr=TRUE, plugin=NULL)

rast.stack <- stack(rast)


Is there any way how I can improve the performance? As most of the raster cells are NULL cells maybe there is a special way consider that? Or splitting the SpatialGridDataFrame up and recombining the stacks in the end?
Or saving substeps to the harddisk?
Any help/suggestion is mostly welcome!

Best regards,
Johannes

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From j.m.signer at gmail.com  Fri Mar  2 13:25:29 2012
From: j.m.signer at gmail.com (Johannes Signer)
Date: Fri, 2 Mar 2012 13:25:29 +0100
Subject: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack
In-Reply-To: <20120302112810.282040@gmx.net>
References: <20120302112810.282040@gmx.net>
Message-ID: <CAC8qavu8JDe5J-pPJUMwCZ-aRQD134Q-bzB0jG8T-0dBf398Gw@mail.gmail.com>

Hello,

not sure if it works for you, but why not directly build a raster
stack (example below).

Hope this helps,
Johannes

# ---------------------------------------------------------------------------- #
library(raster)

# Create dummy data
r1 <- raster(nrows=1000, ncols=800, xmn=0, xmx=100)
r1 <- setValues(r1, rnorm(800000))

# write dummy rasters
sapply(1:60, function(x) writeRaster(r1, paste("r", x, ".tif",
sep=""), overwrite=T))

# Read read raster into a stack
system.time(r <- stack <- do.call("stack",
lapply(list.files(pattern="*.tif"), raster)))

# on a 3 GB netbook this took just a bit more than 11 seconds

On Fri, Mar 2, 2012 at 12:28 PM, Johannes Radinger <JRadinger at gmx.at> wrote:
> Hi,
>
> I want to use raster maps for Species Distribution Modelling (SDM) with
> the package 'dismo'. Therefore I load several rastermaps (around 60) with the readRAST6 command. For further processing I want to transform them into a raster stack. Each of the raster has the same spatial extent and the same resolution (per rastermap: around 765000 cells, thereof 760000 NA's, 5000 non null cells).
>
> The readRAST6 command to load all rasters in one step into a SpatialGridDataFrame works really good (1-2 min). The problem now is the tranformation into a stack. This takes very long time (I waited for 45 min), the CPU is mostly 100%, the pyhsical memory usage 3 GB (only a few MB left) and the virtual memory usage for R 3 GB, the HDD activity 20-30 MB/Sec data written. So my Computer seem to be at its maximum, and I don't have access to a faster/better one. I am doint all my R processes within an Eclipse workspace.
>
> What I do:
> rast <- readRAST6(rast.list, cat=(FALSE,length(rast.list)), ignore.stderr=TRUE, plugin=NULL)
>
> rast.stack <- stack(rast)
>
>
> Is there any way how I can improve the performance? As most of the raster cells are NULL cells maybe there is a special way consider that? Or splitting the SpatialGridDataFrame up and recombining the stacks in the end?
> Or saving substeps to the harddisk?
> Any help/suggestion is mostly welcome!
>
> Best regards,
> Johannes
>
> --
>
> Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From JRadinger at gmx.at  Fri Mar  2 13:37:31 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Fri, 02 Mar 2012 13:37:31 +0100
Subject: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack
In-Reply-To: <CAC8qavu8JDe5J-pPJUMwCZ-aRQD134Q-bzB0jG8T-0dBf398Gw@mail.gmail.com>
References: <20120302112810.282040@gmx.net>
	<CAC8qavu8JDe5J-pPJUMwCZ-aRQD134Q-bzB0jG8T-0dBf398Gw@mail.gmail.com>
Message-ID: <20120302123731.282070@gmx.net>

Hi,

I am not sure what you mean exactly with building a raster stack directly?
My original raster files are GRASS GIS raster files in a GRASS GIS mapset. AFAIK these files can only be loaded with readRAST6 (with the result of a SpatialGridDataFrame).

So I am not quite sure if you mean I have to use a differnet process to built the stack as my original files are no tifs (like the example).

best regards,
Johannes

-------- Original-Nachricht --------
> Datum: Fri, 2 Mar 2012 13:25:29 +0100
> Von: Johannes Signer <j.m.signer at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack

> Hello,
> 
> not sure if it works for you, but why not directly build a raster
> stack (example below).
> 
> Hope this helps,
> Johannes
> 
> #
> ---------------------------------------------------------------------------- #
> library(raster)
> 
> # Create dummy data
> r1 <- raster(nrows=1000, ncols=800, xmn=0, xmx=100)
> r1 <- setValues(r1, rnorm(800000))
> 
> # write dummy rasters
> sapply(1:60, function(x) writeRaster(r1, paste("r", x, ".tif",
> sep=""), overwrite=T))
> 
> # Read read raster into a stack
> system.time(r <- stack <- do.call("stack",
> lapply(list.files(pattern="*.tif"), raster)))
> 
> # on a 3 GB netbook this took just a bit more than 11 seconds
> 
> On Fri, Mar 2, 2012 at 12:28 PM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> > Hi,
> >
> > I want to use raster maps for Species Distribution Modelling (SDM) with
> > the package 'dismo'. Therefore I load several rastermaps (around 60)
> with the readRAST6 command. For further processing I want to transform them
> into a raster stack. Each of the raster has the same spatial extent and the
> same resolution (per rastermap: around 765000 cells, thereof 760000 NA's,
> 5000 non null cells).
> >
> > The readRAST6 command to load all rasters in one step into a
> SpatialGridDataFrame works really good (1-2 min). The problem now is the tranformation
> into a stack. This takes very long time (I waited for 45 min), the CPU is
> mostly 100%, the pyhsical memory usage 3 GB (only a few MB left) and the
> virtual memory usage for R 3 GB, the HDD activity 20-30 MB/Sec data written.
> So my Computer seem to be at its maximum, and I don't have access to a
> faster/better one. I am doint all my R processes within an Eclipse workspace.
> >
> > What I do:
> > rast <- readRAST6(rast.list, cat=(FALSE,length(rast.list)),
> ignore.stderr=TRUE, plugin=NULL)
> >
> > rast.stack <- stack(rast)
> >
> >
> > Is there any way how I can improve the performance? As most of the
> raster cells are NULL cells maybe there is a special way consider that? Or
> splitting the SpatialGridDataFrame up and recombining the stacks in the end?
> > Or saving substeps to the harddisk?
> > Any help/suggestion is mostly welcome!
> >
> > Best regards,
> > Johannes
> >
> > --
> >
> > Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From basille at ase-research.org  Fri Mar  2 14:40:44 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 02 Mar 2012 08:40:44 -0500
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>,
	<4F4F934D.8090805@ase-research.org>
	<trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>
Message-ID: <4F50CDDC.1090702@ase-research.org>

Well, of course you can, technically, no-one's stopping you :)

However, the sum of specialization values (in your case: 7.65) does not 
represent anything at all. Each specialization value is a variance ratio, 
so that I don't know what would be a sum of variance ratio (maybe a mean 
would make more sense, but it does not help you here). In addition, 
specialization axes are only orthogonal to the marginality axis, and not 
necessarily to each other (while the scores on each of them are 
uncorrelated). I don't quite know if the sum, or even the mean, of such 
not-orthogonal axes would make any sense, in a geometric way...

Finally, if you're interested to test the significance of the ENFA, you can 
have a look at 'randtest.enfa', which tests the first specialization 
eigenvalue (it follows that, if the first is significant, every eigenvalue 
that you selected with a sensible method is significant too). I would not 
especially recommend it, since the ENFA is essentially an exploratory 
analysis, but it's better to know that this function exists.

Hope this helps,
Mathieu.


Le 02/03/2012 03:16, Lisa Freudenberger a ?crit :
> Dear Mathieu,
>
> thank you for your quick response and the clarification. Sorry I did not
> fill in a subject. I have actually never been active in a mailing list before.
>
> You are saying that the eigenvalues are the specialization values and that
> the specialization accounted for by the marginality can also be calculated
> as described by your script. Can?t I then use the value of the
> specialization accounted for by the marginality axis to sum it up with the
> eigenvalues of the specialization axes to calculate a proportion of
> specialization explained by the marginality axis and by each specialization
> axis?
>
> For example:
>
> ev_mar<-sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar -
> mean(niche1$Mar))^2)
>
> and then to calculate the proportion for the example of the first
> eigenvalue of 1.565:
>
> 1.565/sum(enfa1$s+ev_mar)
> [1] 0.2045417
>
> Greetings
> Lisa
>
> *Gesendet:* Donnerstag, 01. M?rz 2012 um 16:18 Uhr
> *Von:* "Mathieu Basille" <basille at ase-research.org>
> *An:* r-sig-geo at r-project.org
> *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
> Dear Lisa,
>
> Please use a sensible subject in the future (I corrected it for better
> archiving and to help you get more answers).
>
> The specialization can not be interpreted in terms of explained variance.
> The specialization on any axis is the ratio of the available variance over
> the used variance, which do not sum up to 1 on every axis. The
> specialization values are given by the eigenvalues of an enfa object. Let's
> take the example in ?enfa:
>
> library(adehabitatHS)
>
> data(lynxjura)
> map <- lynxjura$map
> locs <- lynxjura$locs
> locs <- locs[slot(locs, "data")[,2]!="D",]
> slot(map,"data")[,4] <- sqrt(slot(map,"data")[,4])
> tab <- slot(map, "data")
> pr <- slot(count.points(locs, map), "data")[,1]
> pc <- dudi.pca(tab, scannf = FALSE)
> (enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))
>
> Here, the variance available on the first axis of specialization is 1.57
> times higher than the variance used on this axis. We can actually compute
> these values using the ratio of variances:
>
> niche1 <- enfa1$li[rep(1:length(enfa1$pr), enfa1$pr), ]
> sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe1^2)/sum(niche1$Spe1^2)
> sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe2^2)/sum(niche1$Spe2^2)
> enfa1$s
>
> Note, however, that the marginality axis also accounts for some
> marginality. To compute the specialization on the marginality axis, it is
> exactly the same approach:
>
> sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar -
> mean(niche1$Mar))^2)
>
> Hope this helps,
> Mathieu.
>
>
> Le 01/03/2012 05:42, Lisa Freudenberger a ?crit :
>  > Dear all,
>  >
>  > I hope this is the right place to post my question and that someone might
>  > be able to help me. I am performing an ENFA with species data and
>  > environmental variables unsing the adehabitat package. What I know how to
>  > get are the eigenvalues of the specialization axes and the coefficients for
>  > all environmental variables.
>  >
>  > However I was wondering how you can calculate the percentage of variance
>  > (specialization) explained by each axis from these data. As I know the
>  > marginality axis always explains the whole marginality as well as part of
>  > the specialization. My initial thought was to sum up all eigenvalues and
>  > calculate the proportional values for each eigenvalue, meaning
>  > eigenvalue/sum of eigenvalues. But as I do not get an eigenvalue for the
>  > marginality axis I can?t build the sum of all of them.
>  >
>  > Does anyone of you have an idea how to solve this problem?
>  >
>  > Any help is appreciated!
>  >
>  > All the best
>  > Lisa
>  >
>  >
>  > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r iPhone
>  > und Android.
>  > *https://produkte.web.de/freemail_mobile_startseite/*
>  >
>  >
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
>
> ~$ whoami
> Mathieu Basille, Post-Doc
>
> ~$ locate
> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
> + Centre d'?tude de la For?t
> D?partement de Biologie
> Universit? Laval, Qu?bec
>
> ~$ info
> http://ase-research.org/basille
>
> ~$ fortune
> ``If you can't win by reason, go for volume.''
> Calvin, by Bill Watterson.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r iPhone
> und Android.
> *https://produkte.web.de/freemail_mobile_startseite/*
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From E.Couce.07 at bristol.ac.uk  Fri Mar  2 15:07:42 2012
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Fri, 2 Mar 2012 06:07:42 -0800 (PST)
Subject: [R-sig-Geo] writeRaster can't find driver
In-Reply-To: <CANtt_hxYa1GSXrAs3t6uCG3Mrt2TVqaiK0Qk0d8Th80kUDhq7w@mail.gmail.com>
References: <1330634762932-7334042.post@n2.nabble.com>
	<CANtt_hxYa1GSXrAs3t6uCG3Mrt2TVqaiK0Qk0d8Th80kUDhq7w@mail.gmail.com>
Message-ID: <1330697262449-7336695.post@n2.nabble.com>

Thanks a lot, Robert!

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/writeRaster-can-t-find-driver-tp7334042p7336695.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From godina at dal.ca  Fri Mar  2 16:08:44 2012
From: godina at dal.ca (Aurelie C.Godin)
Date: Fri, 2 Mar 2012 07:08:44 -0800 (PST)
Subject: [R-sig-Geo] Loosmore and Ford (2006) Goodness-of-fit (GoF) test
	for CSR
In-Reply-To: <mTEvdhsG.1330672691.5123510.marcelino.delacruz@upm.es>
References: <1330616363370-7332928.post@n2.nabble.com>
	<mTEvdhsG.1330672691.5123510.marcelino.delacruz@upm.es>
Message-ID: <1330700924548-7336880.post@n2.nabble.com>

Thank you Marcelino!

You are right, I am trying to test the random labelling hypothesis instead
of CSR.
I've been able to run your LF.gof with the nztrees dataset, however, when I
test the envelope with the simulated rlabel list and run the LF.gof I get an
error message:
http://r-sig-geo.2731867.n2.nabble.com/file/n7336880/OTGR.RData OTGR.RData 

> LF.gof(GR.env) 
Error in `[.data.frame`(as.data.frame(attributes(X)$simfuns), , 1) : 
  undefined columns selected

I've also tried the following coding for which I still get the same error
message.

# Precomputed list of point patterns
OTim<-as.im(OT)#create a pixel image of the point pattern of all my events
(OT)
# Simulate GR$n random point patterns within OTim
Xlist <- list()
for (i in 1:198) Xlist[[i]] <-  rpoint(563,OTim)
#compute the envelope
EE<-envelope(GR,Kest,simulate=Xlist)
> LF.gof(EE)
Error in `[.data.frame`(as.data.frame(attributes(X)$simfuns), , 1) : 
  undefined columns selected

I thought that the above code would give me a similar result then your code,
but I do get quiet different plots. Is this simply because of the pixel
image? Or is there something else here that I'm missing? 

Any ideas of what can cause this error message?
Thank you very much,


-----
Aurelie Cosandey-Godin
Ph.D. Student, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Loosmore-and-Ford-2006-Goodness-of-fit-GoF-test-for-CSR-tp7332928p7336880.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lisa.freudenberger at web.de  Fri Mar  2 18:25:06 2012
From: lisa.freudenberger at web.de (lisa_web_de)
Date: Fri, 02 Mar 2012 18:25:06 +0100
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <4F50CDDC.1090702@ase-research.org>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>,
	<4F4F934D.8090805@ase-research.org>
	<trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>,
	<4F50CDDC.1090702@ase-research.org>
Message-ID: <4F510272.7060507@web.de>

Thank you Mathieu,
sorry for pushing this point. I understand why you think it does not 
make any sense to compute the proportion. I am just wondering what 
Hirzel for example did in his paper
Hirzel et al 2002 Ecological Niche Factor Analysis: How to compute 
habitat suitability maps without absence data? Ecology 83(7) 2027-2036.

Greetings
Lisa


*Gesendet:* Freitag, 02. M?rz 2012 um 14:40 Uhr
*Von:* "Mathieu Basille" <basille at ase-research.org>
*An:* r-sig-geo at r-project.org
*Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
Well, of course you can, technically, no-one's stopping you :)

However, the sum of specialization values (in your case: 7.65) does not
represent anything at all. Each specialization value is a variance ratio,
so that I don't know what would be a sum of variance ratio (maybe a mean
would make more sense, but it does not help you here). In addition,
specialization axes are only orthogonal to the marginality axis, and not
necessarily to each other (while the scores on each of them are
uncorrelated). I don't quite know if the sum, or even the mean, of such
not-orthogonal axes would make any sense, in a geometric way...

Finally, if you're interested to test the significance of the ENFA, you can
have a look at 'randtest.enfa', which tests the first specialization
eigenvalue (it follows that, if the first is significant, every eigenvalue
that you selected with a sensible method is significant too). I would not
especially recommend it, since the ENFA is essentially an exploratory
analysis, but it's better to know that this function exists.

Hope this helps,
Mathieu.


Le 02/03/2012 03:16, Lisa Freudenberger a ?crit :
 > Dear Mathieu,
 >
 > thank you for your quick response and the clarification. Sorry I did not
 > fill in a subject. I have actually never been active in a mailing 
list before.
 >
 > You are saying that the eigenvalues are the specialization values and 
that
 > the specialization accounted for by the marginality can also be 
calculated
 > as described by your script. Can?t I then use the value of the
 > specialization accounted for by the marginality axis to sum it up 
with the
 > eigenvalues of the specialization axes to calculate a proportion of
 > specialization explained by the marginality axis and by each 
specialization
 > axis?
 >
 > For example:
 >
 > ev_mar<-sum(enfa1$pr)/length(enfa1$pr) * 
sum(enfa1$li$Mar^2)/sum((niche1$Mar -
 > mean(niche1$Mar))^2)
 >
 > and then to calculate the proportion for the example of the first
 > eigenvalue of 1.565:
 >
 > 1.565/sum(enfa1$s+ev_mar)
 > [1] 0.2045417
 >
 > Greetings
 > Lisa
 >
 > *Gesendet:* Donnerstag, 01. M?rz 2012 um 16:18 Uhr
 > *Von:* "Mathieu Basille" <basille at ase-research.org>
 > *An:* r-sig-geo at r-project.org
 > *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
 > Dear Lisa,
 >
 > Please use a sensible subject in the future (I corrected it for better
 > archiving and to help you get more answers).
 >
 > The specialization can not be interpreted in terms of explained variance.
 > The specialization on any axis is the ratio of the available variance 
over
 > the used variance, which do not sum up to 1 on every axis. The
 > specialization values are given by the eigenvalues of an enfa object. 
Let's
 > take the example in ?enfa:
 >
 > library(adehabitatHS)
 >
 > data(lynxjura)
 > map <- lynxjura$map
 > locs <- lynxjura$locs
 > locs <- locs[slot(locs, "data")[,2]!="D",]
 > slot(map,"data")[,4] <- sqrt(slot(map,"data")[,4])
 > tab <- slot(map, "data")
 > pr <- slot(count.points(locs, map), "data")[,1]
 > pc <- dudi.pca(tab, scannf = FALSE)
 > (enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))
 >
 > Here, the variance available on the first axis of specialization is 1.57
 > times higher than the variance used on this axis. We can actually compute
 > these values using the ratio of variances:
 >
 > niche1 <- enfa1$li[rep(1:length(enfa1$pr), enfa1$pr), ]
 > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe1^2)/sum(niche1$Spe1^2)
 > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe2^2)/sum(niche1$Spe2^2)
 > enfa1$s
 >
 > Note, however, that the marginality axis also accounts for some
 > marginality. To compute the specialization on the marginality axis, it is
 > exactly the same approach:
 >
 > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar -
 > mean(niche1$Mar))^2)
 >
 > Hope this helps,
 > Mathieu.
 >
 >
 > Le 01/03/2012 05:42, Lisa Freudenberger a ?crit :
 > > Dear all,
 > >
 > > I hope this is the right place to post my question and that someone 
might
 > > be able to help me. I am performing an ENFA with species data and
 > > environmental variables unsing the adehabitat package. What I know 
how to
 > > get are the eigenvalues of the specialization axes and the 
coefficients for
 > > all environmental variables.
 > >
 > > However I was wondering how you can calculate the percentage of 
variance
 > > (specialization) explained by each axis from these data. As I know the
 > > marginality axis always explains the whole marginality as well as 
part of
 > > the specialization. My initial thought was to sum up all 
eigenvalues and
 > > calculate the proportional values for each eigenvalue, meaning
 > > eigenvalue/sum of eigenvalues. But as I do not get an eigenvalue 
for the
 > > marginality axis I can?t build the sum of all of them.
 > >
 > > Does anyone of you have an idea how to solve this problem?
 > >
 > > Any help is appreciated!
 > >
 > > All the best
 > > Lisa
 > >
 > >
 > > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r 
iPhone
 > > und Android.
 > > *https://produkte.web.de/freemail_mobile_startseite/*
 > >
 > >
 > >
 > > _______________________________________________
 > > R-sig-Geo mailing list
 > > R-sig-Geo at r-project.org
 > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 >
 > --
 >
 > ~$ whoami
 > Mathieu Basille, Post-Doc
 >
 > ~$ locate
 > Laboratoire d'?cologie Comportementale et de Conservation de la Faune
 > + Centre d'?tude de la For?t
 > D?partement de Biologie
 > Universit? Laval, Qu?bec
 >
 > ~$ info
 > http://ase-research.org/basille
 >
 > ~$ fortune
 > ``If you can't win by reason, go for volume.''
 > Calvin, by Bill Watterson.
 >
 > _______________________________________________
 > R-sig-Geo mailing list
 > R-sig-Geo at r-project.org
 > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 >
 >
 > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r 
iPhone
 > und Android.
 > *https://produkte.web.de/freemail_mobile_startseite/*
 >
 >
 >
 > _______________________________________________
 > R-sig-Geo mailing list
 > R-sig-Geo at r-project.org
 > https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From chrjan70 at gmail.com  Fri Mar  2 18:42:01 2012
From: chrjan70 at gmail.com (Christian Jansson)
Date: Fri, 2 Mar 2012 14:42:01 -0300
Subject: [R-sig-Geo] readOGR default unit?
Message-ID: <CAAHdiqwmtzJ8O2Rr18RtMMTK3yQr5hJf-3wHXJtjKQjxABCwzQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/7970ae51/attachment.pl>

From basille at ase-research.org  Fri Mar  2 18:47:51 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Fri, 02 Mar 2012 12:47:51 -0500
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <4F510272.7060507@web.de>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>,
	<4F4F934D.8090805@ase-research.org>
	<trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>,
	<4F50CDDC.1090702@ase-research.org> <4F510272.7060507@web.de>
Message-ID: <4F5107C7.50405@ase-research.org>

Well, that is a tricky question! :)

Alexandre Hirzel et al. did exactly what you wanted to achieve, i.e. they 
computed the proportion of each eigenvalue to the sum of eigenvalues. But 
to me, it is just a ad-hoc measurement, with no real meaning (in this case, 
it is quite different from, e.g. PCA eigenvalues). Instead, I would rely on 
the value itself, i.e. the ratio of variances on each axis (including 
marginality), which conveys an immediate meaning easy to interpret.

Mathieu.


Le 02/03/2012 12:25, lisa_web_de a ?crit :
> Thank you Mathieu,
> sorry for pushing this point. I understand why you think it does not make
> any sense to compute the proportion. I am just wondering what Hirzel for
> example did in his paper
> Hirzel et al 2002 Ecological Niche Factor Analysis: How to compute habitat
> suitability maps without absence data? Ecology 83(7) 2027-2036.
>
> Greetings
> Lisa
>
>
> *Gesendet:* Freitag, 02. M?rz 2012 um 14:40 Uhr
> *Von:* "Mathieu Basille" <basille at ase-research.org>
> *An:* r-sig-geo at r-project.org
> *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
> Well, of course you can, technically, no-one's stopping you :)
>
> However, the sum of specialization values (in your case: 7.65) does not
> represent anything at all. Each specialization value is a variance ratio,
> so that I don't know what would be a sum of variance ratio (maybe a mean
> would make more sense, but it does not help you here). In addition,
> specialization axes are only orthogonal to the marginality axis, and not
> necessarily to each other (while the scores on each of them are
> uncorrelated). I don't quite know if the sum, or even the mean, of such
> not-orthogonal axes would make any sense, in a geometric way...
>
> Finally, if you're interested to test the significance of the ENFA, you can
> have a look at 'randtest.enfa', which tests the first specialization
> eigenvalue (it follows that, if the first is significant, every eigenvalue
> that you selected with a sensible method is significant too). I would not
> especially recommend it, since the ENFA is essentially an exploratory
> analysis, but it's better to know that this function exists.
>
> Hope this helps,
> Mathieu.
>
>
> Le 02/03/2012 03:16, Lisa Freudenberger a ?crit :
>  > Dear Mathieu,
>  >
>  > thank you for your quick response and the clarification. Sorry I did not
>  > fill in a subject. I have actually never been active in a mailing list
> before.
>  >
>  > You are saying that the eigenvalues are the specialization values and that
>  > the specialization accounted for by the marginality can also be calculated
>  > as described by your script. Can?t I then use the value of the
>  > specialization accounted for by the marginality axis to sum it up with the
>  > eigenvalues of the specialization axes to calculate a proportion of
>  > specialization explained by the marginality axis and by each specialization
>  > axis?
>  >
>  > For example:
>  >
>  > ev_mar<-sum(enfa1$pr)/length(enfa1$pr) *
> sum(enfa1$li$Mar^2)/sum((niche1$Mar -
>  > mean(niche1$Mar))^2)
>  >
>  > and then to calculate the proportion for the example of the first
>  > eigenvalue of 1.565:
>  >
>  > 1.565/sum(enfa1$s+ev_mar)
>  > [1] 0.2045417
>  >
>  > Greetings
>  > Lisa
>  >
>  > *Gesendet:* Donnerstag, 01. M?rz 2012 um 16:18 Uhr
>  > *Von:* "Mathieu Basille" <basille at ase-research.org>
>  > *An:* r-sig-geo at r-project.org
>  > *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
>  > Dear Lisa,
>  >
>  > Please use a sensible subject in the future (I corrected it for better
>  > archiving and to help you get more answers).
>  >
>  > The specialization can not be interpreted in terms of explained variance.
>  > The specialization on any axis is the ratio of the available variance over
>  > the used variance, which do not sum up to 1 on every axis. The
>  > specialization values are given by the eigenvalues of an enfa object. Let's
>  > take the example in ?enfa:
>  >
>  > library(adehabitatHS)
>  >
>  > data(lynxjura)
>  > map <- lynxjura$map
>  > locs <- lynxjura$locs
>  > locs <- locs[slot(locs, "data")[,2]!="D",]
>  > slot(map,"data")[,4] <- sqrt(slot(map,"data")[,4])
>  > tab <- slot(map, "data")
>  > pr <- slot(count.points(locs, map), "data")[,1]
>  > pc <- dudi.pca(tab, scannf = FALSE)
>  > (enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))
>  >
>  > Here, the variance available on the first axis of specialization is 1.57
>  > times higher than the variance used on this axis. We can actually compute
>  > these values using the ratio of variances:
>  >
>  > niche1 <- enfa1$li[rep(1:length(enfa1$pr), enfa1$pr), ]
>  > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe1^2)/sum(niche1$Spe1^2)
>  > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Spe2^2)/sum(niche1$Spe2^2)
>  > enfa1$s
>  >
>  > Note, however, that the marginality axis also accounts for some
>  > marginality. To compute the specialization on the marginality axis, it is
>  > exactly the same approach:
>  >
>  > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar -
>  > mean(niche1$Mar))^2)
>  >
>  > Hope this helps,
>  > Mathieu.
>  >
>  >
>  > Le 01/03/2012 05:42, Lisa Freudenberger a ?crit :
>  > > Dear all,
>  > >
>  > > I hope this is the right place to post my question and that someone might
>  > > be able to help me. I am performing an ENFA with species data and
>  > > environmental variables unsing the adehabitat package. What I know how to
>  > > get are the eigenvalues of the specialization axes and the
> coefficients for
>  > > all environmental variables.
>  > >
>  > > However I was wondering how you can calculate the percentage of variance
>  > > (specialization) explained by each axis from these data. As I know the
>  > > marginality axis always explains the whole marginality as well as part of
>  > > the specialization. My initial thought was to sum up all eigenvalues and
>  > > calculate the proportional values for each eigenvalue, meaning
>  > > eigenvalue/sum of eigenvalues. But as I do not get an eigenvalue for the
>  > > marginality axis I can?t build the sum of all of them.
>  > >
>  > > Does anyone of you have an idea how to solve this problem?
>  > >
>  > > Any help is appreciated!
>  > >
>  > > All the best
>  > > Lisa
>  > >
>  > >
>  > > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r
> iPhone
>  > > und Android.
>  > > *https://produkte.web.de/freemail_mobile_startseite/*
>  > >
>  > >
>  > >
>  > > _______________________________________________
>  > > R-sig-Geo mailing list
>  > > R-sig-Geo at r-project.org
>  > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  >
>  > --
>  >
>  > ~$ whoami
>  > Mathieu Basille, Post-Doc
>  >
>  > ~$ locate
>  > Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>  > + Centre d'?tude de la For?t
>  > D?partement de Biologie
>  > Universit? Laval, Qu?bec
>  >
>  > ~$ info
>  > http://ase-research.org/basille
>  >
>  > ~$ fortune
>  > ``If you can't win by reason, go for volume.''
>  > Calvin, by Bill Watterson.
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  >
>  >
>  > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r iPhone
>  > und Android.
>  > *https://produkte.web.de/freemail_mobile_startseite/*
>  >
>  >
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From tarabridwell at gmail.com  Fri Mar  2 19:12:38 2012
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Fri, 2 Mar 2012 10:12:38 -0800
Subject: [R-sig-Geo] Apply rasterize so that it includes ALL cells touching
	a polygon
Message-ID: <CAELQJc0-LgTYEjDutCJVC1HJz5rcEDzQYar7xe7mLvFuGpBkug@mail.gmail.com>

Hi list members,
I have seen this post
(http://r-sig-geo.2731867.n2.nabble.com/Clip-a-raster-tt5635474.html#a5639429)
but I am wondering if there is a more straightforward way have
rasterize include ALL of the cells touching a polygon and not just
those where more than half the edge is covered.

Some code:

# I import the polygon:
polygon <- readOGR(".","nms",p4s = "+proj=longlat +ellps=WGS84 +datum=WGS84")

# I read in my raster
r1 <- readGDAL("raster", p4s = "+proj=longlat +ellps=WGS84 +datum=WGS84")
r1.r <- raster(r1)
polygon.r <- rasterize(polygon, r1.r, fun=max)

Thanks,
Tara


From macqueen1 at llnl.gov  Fri Mar  2 21:03:52 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 2 Mar 2012 12:03:52 -0800
Subject: [R-sig-Geo] spplot handling of overlapping points?
Message-ID: <CB7667A8.8D25B%macqueen1@llnl.gov>

I have a SpatialPointsDataFrame object in which many points are very close
together, such that the markers (plotting characters) tend to overlap. (Of
course, this depends on marker size and the scale at which I plot; if I
"zoom in" there is less overlap.)

It appears that when markers overlap, spplot() places a marker associated
with the larger value after, and therefore on top of, a marker associated
with a smaller value.

Am I correct? Or more generally, what is the algorithm that determines the
order in which markers are added?


I have searched ?spplot and related help pages and haven't found an
explanation (at least, not yet).

I can add that I don't believe markers are placed in the order in which
they appear in the SpatialPointsDataFrame. I say this because when I
attempt to reproduce an spplot using base graphics plot() I have to sort
from smallest to largest value to succeed.

I can probably provide a small reproducible example if necessary, but I'm
hoping it's not necessary.

Here are my actual commands.

  tmps is the SpatialPointsDataFrame.
  tmp is coordinates(tmps)
(they have the same number of rows in the same order)

Note that I'm using the cuts argument to break a continuous variable
('cpm2') into bins. I have carefully matched the colors in tmps$col2 with
the cbin.cols object passed to spplot(), and the break points for the bin
boundaries, so I believe that everything else that could affect the final
appearance, other than the order in which the markers are placed, is
controlled.

#1 using spplot
spplot(tmps,c('cpm2'),
   key.space='right',
   legendEntries=cbin.lbls,
   cuts=cbin.brks,
   col.regions=cbin.cols,
   cex=0.4)

#2 using base graphics
plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)



Thanks
-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062


From r.hijmans at gmail.com  Fri Mar  2 21:32:39 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 2 Mar 2012 12:32:39 -0800
Subject: [R-sig-Geo] Apply rasterize so that it includes ALL cells
 touching a polygon
In-Reply-To: <CAELQJc0-LgTYEjDutCJVC1HJz5rcEDzQYar7xe7mLvFuGpBkug@mail.gmail.com>
References: <CAELQJc0-LgTYEjDutCJVC1HJz5rcEDzQYar7xe7mLvFuGpBkug@mail.gmail.com>
Message-ID: <CANtt_hxuWBSG+P3p-_rHdXQ5Xgwq5rMEUw5E69qC8f4YNc80Xg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/ec5b82d8/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Mar  2 21:48:36 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 02 Mar 2012 21:48:36 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <CB7667A8.8D25B%macqueen1@llnl.gov>
References: <CB7667A8.8D25B%macqueen1@llnl.gov>
Message-ID: <4F513224.4050004@uni-muenster.de>

Don,

spplot essentially does this:

df = data.frame(x=runif(100),y=runif(100),z=rnorm(100))
library(lattice)
xyplot(y~x,groups=cut(df$z,5),df,pch=16,cex=5, col=grey((1:5)/6),
  asp="iso")

for SpatialPointsDataFrame objects. So yes, it seems that the plotting
order is determined by value.

I guess that what you would have liked is the data order, i.e.

xyplot(y~x,col=grey((1:5)/6)[cut(df$z,5)],df,pch=16,cex=5)

and I think that is more reasonable to expect (and would allow for
randomization).

Best regards,

On 03/02/2012 09:03 PM, MacQueen, Don wrote:
> I have a SpatialPointsDataFrame object in which many points are very close
> together, such that the markers (plotting characters) tend to overlap. (Of
> course, this depends on marker size and the scale at which I plot; if I
> "zoom in" there is less overlap.)
> 
> It appears that when markers overlap, spplot() places a marker associated
> with the larger value after, and therefore on top of, a marker associated
> with a smaller value.
> 
> Am I correct? Or more generally, what is the algorithm that determines the
> order in which markers are added?
> 
> 
> I have searched ?spplot and related help pages and haven't found an
> explanation (at least, not yet).
> 
> I can add that I don't believe markers are placed in the order in which
> they appear in the SpatialPointsDataFrame. I say this because when I
> attempt to reproduce an spplot using base graphics plot() I have to sort
> from smallest to largest value to succeed.
> 
> I can probably provide a small reproducible example if necessary, but I'm
> hoping it's not necessary.
> 
> Here are my actual commands.
> 
>   tmps is the SpatialPointsDataFrame.
>   tmp is coordinates(tmps)
> (they have the same number of rows in the same order)
> 
> Note that I'm using the cuts argument to break a continuous variable
> ('cpm2') into bins. I have carefully matched the colors in tmps$col2 with
> the cbin.cols object passed to spplot(), and the break points for the bin
> boundaries, so I believe that everything else that could affect the final
> appearance, other than the order in which the markers are placed, is
> controlled.
> 
> #1 using spplot
> spplot(tmps,c('cpm2'),
>    key.space='right',
>    legendEntries=cbin.lbls,
>    cuts=cbin.brks,
>    col.regions=cbin.cols,
>    cex=0.4)
> 
> #2 using base graphics
> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
> 
> 
> 
> Thanks
> -Don
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Fri Mar  2 21:51:00 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 2 Mar 2012 12:51:00 -0800
Subject: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack
In-Reply-To: <20120302123731.282070@gmx.net>
References: <20120302112810.282040@gmx.net>
	<CAC8qavu8JDe5J-pPJUMwCZ-aRQD134Q-bzB0jG8T-0dBf398Gw@mail.gmail.com>
	<20120302123731.282070@gmx.net>
Message-ID: <CANtt_hwZnM_6qnzjDdceyHPzD18s5YyDbwMzgAMDh1XDp+7UYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/b7d0d434/attachment.pl>

From r.hijmans at gmail.com  Sat Mar  3 00:41:47 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 2 Mar 2012 15:41:47 -0800
Subject: [R-sig-Geo] Calculating the distance metric between two raster
	layers
In-Reply-To: <1330590483.21844.YahooMailNeo@web132106.mail.ird.yahoo.com>
References: <1330590483.21844.YahooMailNeo@web132106.mail.ird.yahoo.com>
Message-ID: <CANtt_hyi9-b9_CWA4nQ4SeePfE67eZa0yQo-ds+=8yPJEg91qA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120302/5ab92065/attachment.pl>

From JhunjhnuwalaK at landcareresearch.co.nz  Sat Mar  3 12:42:16 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Sun, 4 Mar 2012 00:42:16 +1300
Subject: [R-sig-Geo] looping over files
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D33B5@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120304/77551694/attachment.pl>

From Roger.Bivand at nhh.no  Sat Mar  3 16:36:11 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 Mar 2012 16:36:11 +0100 (CET)
Subject: [R-sig-Geo] readOGR default unit?
In-Reply-To: <CAAHdiqwmtzJ8O2Rr18RtMMTK3yQr5hJf-3wHXJtjKQjxABCwzQ@mail.gmail.com>
References: <CAAHdiqwmtzJ8O2Rr18RtMMTK3yQr5hJf-3wHXJtjKQjxABCwzQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203031606220.4924@reclus.nhh.no>

On Fri, 2 Mar 2012, Christian Jansson wrote:

> Hi,
>
> I read some MapInfo TAB-files (or MID MIF, same result) like this:
> shp_0 <- rgdal::readOGR(dsn=fnP, layer=xR)
>
> When I look at summary(shp_0) I get:
> -------------------------------------------
> Is projected: FALSE
> proj4string :
> [+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0]
> -------------------------------------------
>
> Note: "No units="!
>
> The coordinates I read are lat long and show up correctly when I plot them
> on maps. But the problem is I need to use the Area-info for each polygon,
> and the values associated to each polygon are extremely low, like
> 0.000323445. The largest area-number I've ever seen is 0.04.. The polygons
> should be in the tens or hundreds of square kilometers.

If the representation of the coordinate reference system in the source 
file did not include units, they will not be present in the object read. 
The units here are - of course - decimal degrees, so why you would expect 
measurements of area in a metric is a misunderstanding on your part. You 
can try areaPolygon() in geosphere:

library(maptools)
xx <- readShapeSpatial(system.file("shapes/sids.shp",
  package="maptools")[1], IDvar="FIPSNO",
  proj4string=CRS("+proj=longlat +ellps=clrk66"))
library(geosphere)
res <- lapply(slot(xx, "polygons"),
  function(x) sapply(slot(x, "Polygons"),
  function(y) areaPolygon(slot(y, "coords"), r=6378.137)))
summary(unlist(res))
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#  41.78  799.00 1182.00 1179.00 1464.00 2456.00
# in square km for this r.

Or project with spTransform in rgdal:

library(rgdal)
proj4string(xx) <- CRS("+proj=longlat +datum=NAD27")
xxlcc <- spTransform(xx, CRS("+init=epsg:3631"))
res1 <- lapply(slot(xxlcc, "polygons"), function(x)
  sapply(slot(x, "Polygons"), slot, "area")/1000000)
summary(unlist(res1))
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#  41.68  797.20 1179.00 1176.00 1461.00 2450.00


for this datum transformation and projection (and choice of sphere 
parameters in areaPolygon).

Hope this helps,

Roger

>
> I suspect the readOGR is using another default-unit than meters. How can I
> know what it is or how to set it, so that readOGR calculate areas I can use?
>
> By the way, if I look in the Mapinfo-MIF file, it has "CoordSys Earth
> Projection 1,104". Not sure if that is relevant here.
>
> Have a great weekend everyone.
>
> /Chris
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From 538280 at gmail.com  Sat Mar  3 17:07:07 2012
From: 538280 at gmail.com (Greg Snow)
Date: Sat, 3 Mar 2012 09:07:07 -0700
Subject: [R-sig-Geo] looping over files
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D33B5@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D33B5@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <CAFEqCdx=b1aEdZaGi9=gYVmQzPAQDXv8iHGoyN+yp9nZJzrfBQ@mail.gmail.com>

A couple of options:

Use the paste or sprintf functions to create your file names vector.
This works if you want all combinations, or a very specific set of
names.

Use list.files to get the list of all the file names in the
folder/directory, then use the grep function to extract just the files
that match your pattern.

Either way you can use lapply on the list of files to read and process
the files.

On Sat, Mar 3, 2012 at 4:42 AM, Kanika Jhunjhnuwala
<JhunjhnuwalaK at landcareresearch.co.nz> wrote:
> Hi
>
> I have been trying to loop over lists of files while specifying variables. I am not getting anywhere.
>
> There are basically 3 variables month, year and modelname. My files have the format "tas_",year,"_" ,month,"_", modelname,".txt". I basically want to loop through all the models and put all the data pertaining to that model and year in one list while also naming the list as modelname,"_",year. So basically each list will be 12 long with the files from each month (jan through dec). I have tried using list.files but I do not think you can specify variables in the pattern.
>
> Files<- list.files(path="eg/", pattern="tas_",year,"_" ,month,"_", modelname,".txt", full.names=TRUE)
>
> Does anyone know how to do this? I have 12 models and 2 different years and I want to get all the months of a single year and single model in a single list of files (ie 12 files in a list) with each list specified by the modelname and year.
>
> Thanks
>
> Kanika
>
>
> ________________________________
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From Roger.Bivand at nhh.no  Sat Mar  3 17:27:00 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 Mar 2012 17:27:00 +0100 (CET)
Subject: [R-sig-Geo] Density
In-Reply-To: <1330595516.6110.YahooMailNeo@web171601.mail.ir2.yahoo.com>
References: <1329821662.11728.YahooMailNeo@web171616.mail.ir2.yahoo.com>
	<1329990929.32811.YahooMailNeo@web171604.mail.ir2.yahoo.com>
	<1330595516.6110.YahooMailNeo@web171601.mail.ir2.yahoo.com>
Message-ID: <alpine.LRH.2.02.1203031644020.4924@reclus.nhh.no>

On Thu, 1 Mar 2012, alice schaffhauser wrote:

> Hi everybody, I have a data base on a plant species with records 
> attached to the centers of grid cells. Because I don't have softwares as 
> arcgis, I'd like to learn spatial analyses with R (and qgis?). I have 
> wgs84 coordinates and 3 status for the species population (casual=50 
> plants; unknown=500; established=1500).I just tried to see data with a 
> simple plot but I must represent the density of population.

It is impossible to understand your description of your input data. From 
your earlier post:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-February/014291.html

to which you attached data (never a good idea, links to websites are 
always better), you could have done:

tab <- read.table("baseat_part.txt", header=TRUE, sep="\t")
library(sp)
coordinates(tab) <- c("WGS84_E", "WGS84_N")
proj4string(tab) <- CRS("+proj=longlat +datum=WGS84")
plot(tab)
spplot(tab, "status", col.regions=1:3)
table(tab$status)

However:

zerodist(tab)

reports many repeated points, so displaying the points by category is 
impossible to do sensibly, because they overlap.


> I found kde2d but I don't know if kernel suits and what it means. I 
> think that I can use it with the three populations status but I don't 
> know how.

No, you should not try methods unless you actually understand what they 
do. The function you refer to is a two-dimensional density plot, and is 
suited to point patterns, where one knows that all the objects belonging 
to the patterns have been observed. This looks like Austria, and assuming 
that it is, you could use tools for marked point patterns in spatstat, but 
preferably after projection, downloading national boundaries from GADM:

http://www.filefactory.com/file/c2a3441/n/AUT_adm0_RData

library(rgdal)
tab_lcc <- spTransform(tab, CRS("+init=epsg:3416"))
load("AUT_adm0.RData")
gadm_lcc <- spTransform(gadm, CRS("+init=epsg:3416"))
library(maptools)
library(spatstat)
spatstat.options(checkpolygons=FALSE)
# Polygon contains duplicated vertices and is self-intersecting
poly.owin <- as(gadm_lcc, "owin")
spatstat.options(checkpolygons=TRUE)
xy <- coordinates(tab_lcc)
points.ppp <- ppp(xy[,1], xy[,2], marks=tab_lcc$status, window=poly.owin)
# errors, some points not in Austria
plot(split(points.ppp), nrows=3)
Mask2 <- spsample(gadm_lcc, n=5000, type="regular")
XY <- coordinates(Mask2)
XY <- list(x=XY[,1], y=XY[,2])
Z <- density(split(points.ppp), xy=XY)
plot(Z, nrows=3)

Note that this is just an example, and only respects the point support of 
the data, not a grid size. The densities presuppose that all of the area 
has been surveyed with equal intensity in principle - this is a point 
pattern. If observations have not been made in any areas, they should be 
excluded from the window (here all of Austria).

Perhaps reading up on the methods involved would help?

Hope this clarifies,

Roger


> The grid resolution can vary ('1' means 3km of resolution and '2' means 
> 6 km so I must assign them to the first ones). I just heard about 
> krigeage (autokrige?) and nearest neighbors but I don't know how to use 
> them to calculate the number of plants by grid cell. The objective is to 
> have 'net cbf' format because I must transfer the distribution map to a 
> pollen emission map for a transport model. Thanks for your help! Alice 
> ------------------------------------------------ Alice SCHAFFHAUSER
>
> ------------------------------------------------
>
> tab <- read.table("base_at_part.txt", header=T, sep="\t")
> tab
> dim(tab)
> names(tab)
> summary(tab)
> plot(tab$WGS84_E,tab$WGS84_N, col="blue", xlab="WGS84 E", ylab="WGS84 N")
> ?
> #density histogram years
> hist(tab$year_record,?
> ???? probability=TRUE, breaks=20, col="light blue")
> points(density(tab$year_record, bw=1),? type='l', lwd=3, col='black')
> ?
> #density (kernel density estimation)
> library(MASS)?
> kde2d(tab$WGS84_E,tab$WGS84_N) -> tmp?
> filled.contour(tmp, color.palette = topo.colors)
> tmp
>
> ------------------------------------------------
> grid_cell??? status??? resolution??? year_record??? Y-LEFT??? X-LEFT??? y1??? y2??? x1??? x2??? WGS84_N??? WGS84_E??? x??? y
> 7764/2??? unknown??? 1??? 1999??? 4815??? 1625??? 48??? 15.5??? 16??? 25.5??? 48.2583333333333??? 16.425??? 16.4583333333??? 48.275
> 7658/1??? unknown??? 1??? 2005??? 4821??? 1520??? 48??? 21.5??? 15??? 20.5??? 48.3583333333333??? 15.3416666666667??? 15.375??? 48.375
> 7646/3??? unknown??? 1??? 2001??? 4818??? 1320??? 48??? 18.5??? 13??? 20.5??? 48.3083333333333??? 13.3416666666667??? 13.375??? 48.325
> 7850/2??? casual??? 1??? 2000??? 4809??? 1405??? 48??? 9.5??? 14??? 5.5??? 48.1583333333333??? 14.0916666666667??? 14.125??? 48.175
> 7745/1??? casual??? 1??? 1999??? 4815??? 1310??? 48??? 15.5??? 13??? 10.5??? 48.2583333333333??? 13.175??? 13.2083333333??? 48.275
> 7646/1??? unknown??? 1??? 2001??? 4821??? 1320??? 48??? 21.5??? 13??? 20.5??? 48.3583333333333??? 13.3416666666667??? 13.375??? 48.375
> 7842/4??? unknown??? 1??? 2002??? 4806??? 1245??? 48??? 6.5??? 12??? 45.5??? 48.1083333333333??? 12.7583333333333??? 12.7916666667??? 48.125
> 7446/2??? casual??? 2 ?? 2002??? 4833??? 1325??? 48??? 33.5??? 13??? 25.5??? 48.5583333333333??? 13.425??? 13.4583333333??? 48.575
> 7846/1??? casual??? 1??? 2002??? 4809??? 1320??? 48??? 9.5??? 13??? 20.5??? 48.1583333333333??? 13.3416666666667??? 13.375??? 48.175
> 7849/2??? unknown??? 1??? 2001??? 4809??? 1355??? 48??? 9.5??? 13??? 55.5??? 48.1583333333333??? 13.925??? 13.9583333333??? 48.175
> 7943/1??? unknown??? 1??? 2002??? 4803??? 1250??? 48??? 3.5??? 12??? 50.5??? 48.0583333333333??? 12.8416666666667??? 12.875??? 48.075
> 7646/4??? casual??? 1??? 2002??? 4818??? 1325??? 48??? 18.5??? 13??? 25.5??? 48.3083333333333??? 13.425??? 13.4583333333??? 48.325
> 8764/1??? unknown??? 2 ? 1974??? 4715??? 1620??? 47??? 15.5??? 16??? 20.5??? 47.2583333333333??? 16.3416666666667??? 16.375??? 47.275
> 7746/4??? established??? 1??? 2000??? 4812??? 1325??? 48??? 12.5??? 13??? 25.5??? 48.2083333333333??? 13.425??? 13.4583333333??? 48.225
> 7646/3??? unknown??? 1??? 2002??? 4818??? 1320??? 48??? 18.5??? 13??? 20.5??? 48.3083333333333??? 13.3416666666667??? 13.375??? 48.325
> 7745/4??? established??? 1??? 2002??? 4812??? 1315??? 48??? 12.5??? 13??? 15.5??? 48.2083333333333??? 13.2583333333333??? 13.2916666667??? 48.225
> 7747/2??? casual??? 1??? 2003??? 4815??? 1335??? 48??? 15.5??? 13??? 35.5??? 48.2583333333333??? 13.5916666666667??? 13.625??? 48.275
> 8146/2??? unknown??? 1??? 2003??? 4751??? 1325??? 47??? 51.5??? 13??? 25.5??? 47.8583333333333??? 13.425??? 13.4583333333??? 47.875
> 7646/1??? unknown??? 1??? 2003??? 4821??? 1320??? 48??? 21.5??? 13??? 20.5??? 48.3583333333333??? 13.3416666666667??? 13.375??? 48.375
> 7842/2??? unknown??? 1??? 2003??? 4809??? 1245??? 48??? 9.5??? 12??? 45.5??? 48.1583333333333??? 12.7583333333333??? 12.7916666667??? 48.175
> 7546/3??? unknown??? 1??? 2003??? 4824??? 1320??? 48??? 24.5??? 13??? 20.5??? 48.4083333333333??? 13.3416666666667??? 13.375??? 48.425
> 7752/4??? established??? 1??? 2003??? 4812??? 1425??? 48??? 12.5??? 14??? 25.5??? 48.2083333333333??? 14.425??? 14.4583333333??? 48.225
> 7863/4??? unknown??? 1??? 2004??? 4806??? 1615??? 48??? 6.5??? 16??? 15.5??? 48.1083333333333??? 16.2583333333333??? 16.2916666667??? 48.125
> 7963/1??? established??? 2 ?? 2003??? 4803??? 1610??? 48??? 3.5??? 16??? 10.5??? 48.0583333333333??? 16.175??? 16.2083333333??? 48.075
> 7849/2??? unknown??? 1??? 2003??? 4809??? 1355??? 48??? 9.5??? 13??? 55.5??? 48.1583333333333??? 13.925??? 13.9583333333??? 48.175
> 7752/4??? established??? 1??? 2003??? 4812??? 1425??? 48??? 12.5??? 14??? 25.5??? 48.2083333333333??? 14.425??? 14.4583333333??? 48.225
> 7850/4??? unknown??? 1??? 2003??? 4806??? 1405??? 48??? 6.5??? 14??? 5.5??? 48.1083333333333??? 14.0916666666667??? 14.125??? 48.125
> 7848/1??? unknown??? 2 ?? 2003??? 4809??? 1340??? 48??? 9.5??? 13??? 40.5??? 48.1583333333333??? 13.675??? 13.7083333333??? 48.175
> 7849/2??? unknown??? 1??? 2003??? 4809??? 1355??? 48??? 9.5??? 13??? 55.5??? 48.1583333333333??? 13.925??? 13.9583333333??? 48.175
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kevingoulding at gmail.com  Sun Mar  4 18:52:36 2012
From: kevingoulding at gmail.com (Kevin Goulding)
Date: Sun, 4 Mar 2012 10:52:36 -0700
Subject: [R-sig-Geo] alpha hull (ahull) to polygon shapefile
Message-ID: <CAAprShQDxyj8GH28ofNEP4-HwQO6cNdJ54Xj7kv2i=H3JWxPcg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120304/21f47884/attachment.pl>

From a.bevan at ucl.ac.uk  Sun Mar  4 20:03:20 2012
From: a.bevan at ucl.ac.uk (Andrew Bevan)
Date: Sun, 4 Mar 2012 20:03:20 +0100
Subject: [R-sig-Geo] alpha hull (ahull) to polygon shapefile
In-Reply-To: <CAAprShQDxyj8GH28ofNEP4-HwQO6cNdJ54Xj7kv2i=H3JWxPcg@mail.gmail.com>
References: <CAAprShQDxyj8GH28ofNEP4-HwQO6cNdJ54Xj7kv2i=H3JWxPcg@mail.gmail.com>
Message-ID: <A8754DBD-99E5-4303-9450-4A2CA9D4D3A3@ucl.ac.uk>

Dear Kevin

As far as I remember, the ahull class object stores its information in arcs that are not a straight conversion to standard GIS-style lines or polygons. I played with the following function some time ago and it is very rough (apologies in advance), but it works for my purposes. Its starting point was a script for conversion to lines only by Dylan Beaudette that the latter may be sufficient for you (http://casoilresource.lawr.ucdavis.edu/drupal/node/919). In contrast, the version below models the alphahull arcs with a user-defined line segment increment and tries to borrow a polygon-building method from the ASDAR book to create a SpatialPolygonsDataFrame object. Both the function and a toy example below.

Andy

########################

ah2sp <- function(x, increment=360, rnd=10, proj4string=CRS(as.character(NA))){
  require(alphahull)
  require(maptools)
  if (class(x) != "ahull"){
    stop("x needs to be an ahull class object")
  }
  # Extract the edges from the ahull object as a dataframe
  xdf <- as.data.frame(x$arcs)
  # Remove all cases where the coordinates are all the same      
  xdf <- subset(xdf,xdf$r > 0)
  res <- NULL
  if (nrow(xdf) > 0){
    # Convert each arc to a line segment
    linesj <- list()
    prevx<-NULL
    prevy<-NULL
    j<-1
    for(i in 1:nrow(xdf)){
      rowi <- xdf[i,]
      v <- c(rowi$v.x, rowi$v.y)
      theta <- rowi$theta
      r <- rowi$r
      cc <- c(rowi$c1, rowi$c2)
      # Arcs need to be redefined as strings of points. Work out the number of points to allocate in this arc segment.
      ipoints <- 2 + round(increment * (rowi$theta / 2),0)
      # Calculate coordinates from arc() description for ipoints along the arc.
      angles <- anglesArc(v, theta)
      seqang <- seq(angles[1], angles[2], length = ipoints)
      x <- round(cc[1] + r * cos(seqang),rnd)
      y <- round(cc[2] + r * sin(seqang),rnd)
      # Check for line segments that should be joined up and combine their coordinates
      if (is.null(prevx)){
        prevx<-x
        prevy<-y
      } else if (x[1] == round(prevx[length(prevx)],rnd) && y[1] == round(prevy[length(prevy)],rnd)){
          if (i == nrow(xdf)){
          #We have got to the end of the dataset
            prevx<-append(prevx,x[2:ipoints])
            prevy<-append(prevy,y[2:ipoints])
            prevx[length(prevx)]<-prevx[1]
            prevy[length(prevy)]<-prevy[1]
            coordsj<-cbind(prevx,prevy)
            colnames(coordsj)<-NULL
            # Build as Line and then Lines class
            linej <- Line(coordsj)
            linesj[[j]] <- Lines(linej, ID = as.character(j))
          } else {
            prevx<-append(prevx,x[2:ipoints])
            prevy<-append(prevy,y[2:ipoints])
          }
        } else {
      # We have got to the end of a set of lines, and there are several such sets, so convert the whole of this one to a line segment and reset.
          prevx[length(prevx)]<-prevx[1]
          prevy[length(prevy)]<-prevy[1]
          coordsj<-cbind(prevx,prevy)
          colnames(coordsj)<-NULL
      # Build as Line and then Lines class
          linej <- Line(coordsj)
          linesj[[j]] <- Lines(linej, ID = as.character(j))
          j<-j+1
          prevx<-NULL
          prevy<-NULL
        }
    }
    # Promote to SpatialLines
    lspl <- SpatialLines(linesj)
    # Convert lines to polygons
    # Pull out Lines slot and check which lines have start and end points that are the same
    lns <- slot(lspl, "lines")
    polys <- sapply(lns, function(x) { 
      crds <- slot(slot(x, "Lines")[[1]], "coords")
      identical(crds[1, ], crds[nrow(crds), ])
    }) 
    # Select those that do and convert to SpatialPolygons
    polyssl <- lspl[polys]
    list_of_Lines <- slot(polyssl, "lines")
    sppolys <- SpatialPolygons(list(Polygons(lapply(list_of_Lines, function(x) { Polygon(slot(slot(x, "Lines")[[1]], "coords")) }), ID = "1")), proj4string=proj4string)
    # Create a set of ids in a dataframe, then promote to SpatialPolygonsDataFrame
    hid <- sapply(slot(sppolys, "polygons"), function(x) slot(x, "ID"))
    areas <- sapply(slot(sppolys, "polygons"), function(x) slot(x, "area"))
    df <- data.frame(hid,areas)
    names(df) <- c("HID","Area")
    rownames(df) <- df$HID
    res <- SpatialPolygonsDataFrame(sppolys, data=df)
    res <- res[which(res at data$Area > 0),]
  }  
  return(res)
}


########################

#So for example:
library(alphahull)
library(maptools)
n <- 300
theta <- runif(n,0,2*pi)
r <- sqrt(runif(n,0.25^2,0.5^2))
x <- cbind(0.5+r*cos(theta),0.5+r*sin(theta))
a <- ahull(x, alpha = 0.1)
plot(a)

#Convert
b <- ah2sp(a)
plot(b, col="lightgrey", pbg="white")

#Write to shapefile
writeSpatialShape(b, "b")



On 4 Mar 2012, at 18:52, Kevin Goulding wrote:

> I would like to convert a point shapefile into a polygon shapefile
> containing an alpha hull of the points.  I've imported the point shapefile
> and calculated the desired alpha hull:
> 
> #######################################
> require(spdep)
> require(alphahull)
> 
> ccPoints=readShapeSpatial('myshapefile')
> a=5000
> 
> x.coords <- coordinates(ccPoints)
> x.ah <- ahull(x.coords[,1], x.coords[,2], alpha=a)
> 
> # plot the concave alpha hull:
> # plot(x.ah,col='purple',add=T,asp=1,cex=0, pch=4)
> # looks good...
> 
> # now, would like to export alpha hull as a shapefile with a single polygon
> # something like this:
> # write.shp(x.ah, file = 'ahull-shapefile.shp')
> #######################################
> 
> How do I output a polygon shapefile containing the alpha hull?
> 
> Many thanks, Kevin
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From kevingoulding at gmail.com  Sun Mar  4 21:34:45 2012
From: kevingoulding at gmail.com (Kevin Goulding)
Date: Sun, 4 Mar 2012 13:34:45 -0700
Subject: [R-sig-Geo] alpha hull (ahull) to polygon shapefile
In-Reply-To: <8D4E7B51-354E-488D-8CC9-3D89B29CAD3D@ucl.ac.uk>
References: <CAAprShQDxyj8GH28ofNEP4-HwQO6cNdJ54Xj7kv2i=H3JWxPcg@mail.gmail.com>
	<A8754DBD-99E5-4303-9450-4A2CA9D4D3A3@ucl.ac.uk>
	<CAAprShRp=NxzE+=5Hsihr9aHTgm+V-rhQAGwdWCYHC7KcLK9Nw@mail.gmail.com>
	<8D4E7B51-354E-488D-8CC9-3D89B29CAD3D@ucl.ac.uk>
Message-ID: <CAAprShTzOnXSA-jBYm-6asXwGkje0egYGM6qBB0L+94MLR1M+w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120304/a1e3b839/attachment.pl>

From JhunjhnuwalaK at landcareresearch.co.nz  Sun Mar  4 21:48:26 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Mon, 5 Mar 2012 09:48:26 +1300
Subject: [R-sig-Geo] looping over files
In-Reply-To: <CAHT1vphmVZSZFiQn6AqhCFgpaybj0ZKTWAEyw_gnpUsXxZ22dA@mail.gmail.com>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D33B5@donkey.landcare.ad.landcareresearch.co.nz>
	<CAHT1vpgqQ7rObpwv932XVJRC6ChK6-SvpwU7QntbxPTHV73hSQ@mail.gmail.com>
	<F2969C1B08CBEE42B78C04C280D578E73BFD4D33B6@donkey.landcare.ad.landcareresearch.co.nz>
	<CAHT1vpgDdj0yU6S6potMChrSY6VKD3+8ghRJvY16PXYDjrvhGQ@mail.gmail.com>
	<CAHT1vphmVZSZFiQn6AqhCFgpaybj0ZKTWAEyw_gnpUsXxZ22dA@mail.gmail.com>
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3482@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120305/19382682/attachment.pl>

From JRadinger at gmx.at  Mon Mar  5 12:14:44 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Mon, 05 Mar 2012 12:14:44 +0100
Subject: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack
In-Reply-To: <CANtt_hwZnM_6qnzjDdceyHPzD18s5YyDbwMzgAMDh1XDp+7UYA@mail.gmail.com>
References: <20120302112810.282040@gmx.net>
	<CAC8qavu8JDe5J-pPJUMwCZ-aRQD134Q-bzB0jG8T-0dBf398Gw@mail.gmail.com>
	<20120302123731.282070@gmx.net>
	<CANtt_hwZnM_6qnzjDdceyHPzD18s5YyDbwMzgAMDh1XDp+7UYA@mail.gmail.com>
Message-ID: <20120305111444.171300@gmx.net>

Hi,

-------- Original-Nachricht --------
> Datum: Fri, 2 Mar 2012 12:51:00 -0800
> Von: "Robert J. Hijmans" <r.hijmans at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] Performance SpatialGridDataFrame to rasterStack

> Johannes,
> 
> please provide your  sessionInfo()  which is particularly relevant for
> this
> type (performance related) questions. I am guessing you are using a mac,
> as
> there have been some similar reports with macs; apparently performance can
> get a tremendous hit when RAM is exhausted and gets swapped to disk.

Yes, as you already guessed, I am working on a Mac. Here my sessionInfo():
>  sessionInfo()
R version 2.14.2 (2012-02-29)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.7-8    raster_1.9-70  spgrass6_0.7-9 XML_3.9-4      sp_0.9-95     
[6] rj_1.0.0-3    

loaded via a namespace (and not attached):
[1] grid_2.14.2    lattice_0.20-0 rj.gd_1.0.0-1  tools_2.14.2


Anyway... I followed your suggestion to save the single rasters to my harddisk as a e.g. tiff and then load them with raster("file") directly from the file. As my rasters in GRASS are already created by a script it is an easy step to save them as GeoTIFF directly within the script-run. So I don't need to import them to R with spgrass6, I can even skip the spgrass6 package then completlely.
There are just two things I have in mind:
1) the export settings of GRASS GIS (GeoTIFF), what about Null-Values, color tables, etc. Does anyone have experience with that already?
2) How to create a loop that loads all rasters from a special folder on my computer (basically all files of one folder).

Best regards,
Johannes




> 
> You have 60 rasters in memory, and then copy them into a RasterStack. To
> avoid that, I think that Johannes Signer solution might indeed work, as
> you
> could have a loop in which you use readRast to read a  raster, save it to
> disk (e.g. 'grd' or 'tif') and keep the filenames in a vector or list.
> Then
> make a stack using the filenames, and there should be no memory issue.
> 
> Robert
> 
> On Fri, Mar 2, 2012 at 4:37 AM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> 
> > Hi,
> >
> > I am not sure what you mean exactly with building a raster stack
> directly?
> > My original raster files are GRASS GIS raster files in a GRASS GIS
> mapset.
> > AFAIK these files can only be loaded with readRAST6 (with the result of
> a
> > SpatialGridDataFrame).
> >
> > So I am not quite sure if you mean I have to use a differnet process to
> > built the stack as my original files are no tifs (like the example).
> >
> > best regards,
> > Johannes
> >
> > -------- Original-Nachricht --------
> > > Datum: Fri, 2 Mar 2012 13:25:29 +0100
> > > Von: Johannes Signer <j.m.signer at gmail.com>
> > > An: Johannes Radinger <JRadinger at gmx.at>
> > > CC: r-sig-geo at r-project.org
> > > Betreff: Re: [R-sig-Geo] Performance SpatialGridDataFrame to
> rasterStack
> >
> > > Hello,
> > >
> > > not sure if it works for you, but why not directly build a raster
> > > stack (example below).
> > >
> > > Hope this helps,
> > > Johannes
> > >
> > > #
> > >
> >
> ----------------------------------------------------------------------------
> > #
> > > library(raster)
> > >
> > > # Create dummy data
> > > r1 <- raster(nrows=1000, ncols=800, xmn=0, xmx=100)
> > > r1 <- setValues(r1, rnorm(800000))
> > >
> > > # write dummy rasters
> > > sapply(1:60, function(x) writeRaster(r1, paste("r", x, ".tif",
> > > sep=""), overwrite=T))
> > >
> > > # Read read raster into a stack
> > > system.time(r <- stack <- do.call("stack",
> > > lapply(list.files(pattern="*.tif"), raster)))
> > >
> > > # on a 3 GB netbook this took just a bit more than 11 seconds
> > >
> > > On Fri, Mar 2, 2012 at 12:28 PM, Johannes Radinger <JRadinger at gmx.at>
> > > wrote:
> > > > Hi,
> > > >
> > > > I want to use raster maps for Species Distribution Modelling (SDM)
> with
> > > > the package 'dismo'. Therefore I load several rastermaps (around 60)
> > > with the readRAST6 command. For further processing I want to transform
> > them
> > > into a raster stack. Each of the raster has the same spatial extent
> and
> > the
> > > same resolution (per rastermap: around 765000 cells, thereof 760000
> NA's,
> > > 5000 non null cells).
> > > >
> > > > The readRAST6 command to load all rasters in one step into a
> > > SpatialGridDataFrame works really good (1-2 min). The problem now is
> the
> > tranformation
> > > into a stack. This takes very long time (I waited for 45 min), the CPU
> is
> > > mostly 100%, the pyhsical memory usage 3 GB (only a few MB left) and
> the
> > > virtual memory usage for R 3 GB, the HDD activity 20-30 MB/Sec data
> > written.
> > > So my Computer seem to be at its maximum, and I don't have access to a
> > > faster/better one. I am doint all my R processes within an Eclipse
> > workspace.
> > > >
> > > > What I do:
> > > > rast <- readRAST6(rast.list, cat=(FALSE,length(rast.list)),
> > > ignore.stderr=TRUE, plugin=NULL)
> > > >
> > > > rast.stack <- stack(rast)
> > > >
> > > >
> > > > Is there any way how I can improve the performance? As most of the
> > > raster cells are NULL cells maybe there is a special way consider
> that?
> > Or
> > > splitting the SpatialGridDataFrame up and recombining the stacks in
> the
> > end?
> > > > Or saving substeps to the harddisk?
> > > > Any help/suggestion is mostly welcome!
> > > >
> > > > Best regards,
> > > > Johannes
> > > >
> > > > --
> > > >
> > > > Jetzt informieren:
> http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > --
> >
> > Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From lisa.freudenberger at web.de  Mon Mar  5 12:53:59 2012
From: lisa.freudenberger at web.de (Lisa Freudenberger)
Date: Mon, 05 Mar 2012 12:53:59 +0100
Subject: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
In-Reply-To: <4F5107C7.50405@ase-research.org>
References: <trinity-e8669a29-051c-45da-b013-cf2b6cae93f0-1330598533750@3capp-webde-bs32.dlan.cinetic.de>,
	<4F4F934D.8090805@ase-research.org>
	<trinity-1e66a952-7969-4149-8dcd-f4a604bbfd3e-1330676162987@3capp-webde-bs49.dlan.cinetic.de>,
	<4F50CDDC.1090702@ase-research.org> <4F510272.7060507@web.de>
	<4F5107C7.50405@ase-research.org>
Message-ID: <4F54A957.9090004@web.de>

Ok thanks again for your help. I will talk to the other coauthors what 
to do and if to include the percentage values. At least I know now how 
to calculate them. It has been a pleasure discussing this issue with you 
:-)
Lisa

On 02.03.2012 18:47, Mathieu Basille wrote:
> Well, that is a tricky question! :)
>
> Alexandre Hirzel et al. did exactly what you wanted to achieve, i.e. 
> they computed the proportion of each eigenvalue to the sum of 
> eigenvalues. But to me, it is just a ad-hoc measurement, with no real 
> meaning (in this case, it is quite different from, e.g. PCA 
> eigenvalues). Instead, I would rely on the value itself, i.e. the 
> ratio of variances on each axis (including marginality), which conveys 
> an immediate meaning easy to interpret.
>
> Mathieu.
>
>
> Le 02/03/2012 12:25, lisa_web_de a ?crit :
>> Thank you Mathieu,
>> sorry for pushing this point. I understand why you think it does not 
>> make
>> any sense to compute the proportion. I am just wondering what Hirzel for
>> example did in his paper
>> Hirzel et al 2002 Ecological Niche Factor Analysis: How to compute 
>> habitat
>> suitability maps without absence data? Ecology 83(7) 2027-2036.
>>
>> Greetings
>> Lisa
>>
>>
>> *Gesendet:* Freitag, 02. M?rz 2012 um 14:40 Uhr
>> *Von:* "Mathieu Basille" <basille at ase-research.org>
>> *An:* r-sig-geo at r-project.org
>> *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in ENFA
>> Well, of course you can, technically, no-one's stopping you :)
>>
>> However, the sum of specialization values (in your case: 7.65) does not
>> represent anything at all. Each specialization value is a variance 
>> ratio,
>> so that I don't know what would be a sum of variance ratio (maybe a mean
>> would make more sense, but it does not help you here). In addition,
>> specialization axes are only orthogonal to the marginality axis, and not
>> necessarily to each other (while the scores on each of them are
>> uncorrelated). I don't quite know if the sum, or even the mean, of such
>> not-orthogonal axes would make any sense, in a geometric way...
>>
>> Finally, if you're interested to test the significance of the ENFA, 
>> you can
>> have a look at 'randtest.enfa', which tests the first specialization
>> eigenvalue (it follows that, if the first is significant, every 
>> eigenvalue
>> that you selected with a sensible method is significant too). I would 
>> not
>> especially recommend it, since the ENFA is essentially an exploratory
>> analysis, but it's better to know that this function exists.
>>
>> Hope this helps,
>> Mathieu.
>>
>>
>> Le 02/03/2012 03:16, Lisa Freudenberger a ?crit :
>> > Dear Mathieu,
>> >
>> > thank you for your quick response and the clarification. Sorry I 
>> did not
>> > fill in a subject. I have actually never been active in a mailing list
>> before.
>> >
>> > You are saying that the eigenvalues are the specialization values 
>> and that
>> > the specialization accounted for by the marginality can also be 
>> calculated
>> > as described by your script. Can?t I then use the value of the
>> > specialization accounted for by the marginality axis to sum it up 
>> with the
>> > eigenvalues of the specialization axes to calculate a proportion of
>> > specialization explained by the marginality axis and by each 
>> specialization
>> > axis?
>> >
>> > For example:
>> >
>> > ev_mar<-sum(enfa1$pr)/length(enfa1$pr) *
>> sum(enfa1$li$Mar^2)/sum((niche1$Mar -
>> > mean(niche1$Mar))^2)
>> >
>> > and then to calculate the proportion for the example of the first
>> > eigenvalue of 1.565:
>> >
>> > 1.565/sum(enfa1$s+ev_mar)
>> > [1] 0.2045417
>> >
>> > Greetings
>> > Lisa
>> >
>> > *Gesendet:* Donnerstag, 01. M?rz 2012 um 16:18 Uhr
>> > *Von:* "Mathieu Basille" <basille at ase-research.org>
>> > *An:* r-sig-geo at r-project.org
>> > *Betreff:* Re: [R-sig-Geo] Meaning of specialization eigenvalues in 
>> ENFA
>> > Dear Lisa,
>> >
>> > Please use a sensible subject in the future (I corrected it for better
>> > archiving and to help you get more answers).
>> >
>> > The specialization can not be interpreted in terms of explained 
>> variance.
>> > The specialization on any axis is the ratio of the available 
>> variance over
>> > the used variance, which do not sum up to 1 on every axis. The
>> > specialization values are given by the eigenvalues of an enfa 
>> object. Let's
>> > take the example in ?enfa:
>> >
>> > library(adehabitatHS)
>> >
>> > data(lynxjura)
>> > map <- lynxjura$map
>> > locs <- lynxjura$locs
>> > locs <- locs[slot(locs, "data")[,2]!="D",]
>> > slot(map,"data")[,4] <- sqrt(slot(map,"data")[,4])
>> > tab <- slot(map, "data")
>> > pr <- slot(count.points(locs, map), "data")[,1]
>> > pc <- dudi.pca(tab, scannf = FALSE)
>> > (enfa1 <- enfa(pc, pr, scannf = FALSE, nf = 3))
>> >
>> > Here, the variance available on the first axis of specialization is 
>> 1.57
>> > times higher than the variance used on this axis. We can actually 
>> compute
>> > these values using the ratio of variances:
>> >
>> > niche1 <- enfa1$li[rep(1:length(enfa1$pr), enfa1$pr), ]
>> > sum(enfa1$pr)/length(enfa1$pr) * 
>> sum(enfa1$li$Spe1^2)/sum(niche1$Spe1^2)
>> > sum(enfa1$pr)/length(enfa1$pr) * 
>> sum(enfa1$li$Spe2^2)/sum(niche1$Spe2^2)
>> > enfa1$s
>> >
>> > Note, however, that the marginality axis also accounts for some
>> > marginality. To compute the specialization on the marginality axis, 
>> it is
>> > exactly the same approach:
>> >
>> > sum(enfa1$pr)/length(enfa1$pr) * sum(enfa1$li$Mar^2)/sum((niche1$Mar -
>> > mean(niche1$Mar))^2)
>> >
>> > Hope this helps,
>> > Mathieu.
>> >
>> >
>> > Le 01/03/2012 05:42, Lisa Freudenberger a ?crit :
>> > > Dear all,
>> > >
>> > > I hope this is the right place to post my question and that 
>> someone might
>> > > be able to help me. I am performing an ENFA with species data and
>> > > environmental variables unsing the adehabitat package. What I 
>> know how to
>> > > get are the eigenvalues of the specialization axes and the
>> coefficients for
>> > > all environmental variables.
>> > >
>> > > However I was wondering how you can calculate the percentage of 
>> variance
>> > > (specialization) explained by each axis from these data. As I 
>> know the
>> > > marginality axis always explains the whole marginality as well as 
>> part of
>> > > the specialization. My initial thought was to sum up all 
>> eigenvalues and
>> > > calculate the proportional values for each eigenvalue, meaning
>> > > eigenvalue/sum of eigenvalues. But as I do not get an eigenvalue 
>> for the
>> > > marginality axis I can?t build the sum of all of them.
>> > >
>> > > Does anyone of you have an idea how to solve this problem?
>> > >
>> > > Any help is appreciated!
>> > >
>> > > All the best
>> > > Lisa
>> > >
>> > >
>> > > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r
>> iPhone
>> > > und Android.
>> > > *https://produkte.web.de/freemail_mobile_startseite/*
>> > >
>> > >
>> > >
>> > > _______________________________________________
>> > > R-sig-Geo mailing list
>> > > R-sig-Geo at r-project.org
>> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> > --
>> >
>> > ~$ whoami
>> > Mathieu Basille, Post-Doc
>> >
>> > ~$ locate
>> > Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>> > + Centre d'?tude de la For?t
>> > D?partement de Biologie
>> > Universit? Laval, Qu?bec
>> >
>> > ~$ info
>> > http://ase-research.org/basille
>> >
>> > ~$ fortune
>> > ``If you can't win by reason, go for volume.''
>> > Calvin, by Bill Watterson.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>> > Ihr WEB.DE Postfach immer dabei: die kostenlose WEB.DE Mail App f?r 
>> iPhone
>> > und Android.
>> > *https://produkte.web.de/freemail_mobile_startseite/*
>> >
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From amonleong at wanadoo.es  Mon Mar  5 13:23:39 2012
From: amonleong at wanadoo.es (TM)
Date: Mon, 5 Mar 2012 13:23:39 +0100
Subject: [R-sig-Geo] Probability map of presence(1)-absence(0) data
	including trend and covariate
In-Reply-To: <alpine.LRH.2.02.1202211105590.8671@reclus.nhh.no>
References: <alpine.LRH.2.02.1202211105590.8671@reclus.nhh.no>
Message-ID: <1E17B1B99AA64616B2C82AC04C6FAC7E@ub.edu>

Hi,
I want to create a biodiversity species (probability) map of Spain from 
presence(1)-absence(0) data (approx. 100 sites, and 3 species) and also I 
have data from 400 metereological stations in Spain (Coordinates, 
temperature, rain, hight, etc). I have been looking at using indicator 
kriging on each species layer.

Can I transform this data somehow to still be able to krige? (i.e can I use 
Universal Kriging on binary data?)

If some form of kriging is appropriate, I presume I should model the 
variogram to the same (overall) distance for each species. Is it ok to have 
a different lag distance/number of lags for each species or all species? Are 
there general rules for specifying lag distances?

I also have some metereological data which I could use as a covariate. Is 
Cokriging appropriate to use when one dataset is binary and the other is 
continuous? Does the data need to be co-located?

Are there better statistical methods (in R or other software) to use when 
interpolating presence-absence data, including with a trend and covariate? 
Any references or code in R etc would be much appreciated.

At last, How can I add time dimension to probability map, because I have 
also temperature and rain time series?

Apologies for quite so many questions. Thanks very much

Toni
Departament of Statistics
University of Barcelona


From marcelino.delacruz at upm.es  Mon Mar  5 14:01:32 2012
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 05 Mar 2012 14:01:32 +0100
Subject: [R-sig-Geo] Loosmore and Ford (2006) Goodness-of-fit (GoF) test
 for CSR
In-Reply-To: <1330700924548-7336880.post@n2.nabble.com>
References: <1330616363370-7332928.post@n2.nabble.com>
	<mTEvdhsG.1330672691.5123510.marcelino.delacruz@upm.es>
	<1330700924548-7336880.post@n2.nabble.com>
Message-ID: <201203051301.q25D1a7r028679@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120305/ac796945/attachment.pl>

From marcelino.delacruz at upm.es  Mon Mar  5 14:14:11 2012
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 05 Mar 2012 14:14:11 +0100
Subject: [R-sig-Geo] Probability map of presence(1)-absence(0) data
 including trend and covariate
In-Reply-To: <1E17B1B99AA64616B2C82AC04C6FAC7E@ub.edu>
References: <alpine.LRH.2.02.1202211105590.8671@reclus.nhh.no>
	<1E17B1B99AA64616B2C82AC04C6FAC7E@ub.edu>
Message-ID: <201203051314.q25DEF8Q030872@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120305/5bb1b80f/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Mar  5 14:40:22 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 Mar 2012 14:40:22 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <CB7667A8.8D25B%macqueen1@llnl.gov>
References: <CB7667A8.8D25B%macqueen1@llnl.gov>
Message-ID: <4F54C246.1060606@uni-muenster.de>

This has now been changed/repared in sp on r-forge (svn), and will
appear from sp 0.9-97 on. A test run would be:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y
spplot(xyz, cex=10)

which used to plot points in value order, and does now in data record order.

I put up resulting graphs, for comparison, at
http://ifgi.uni-muenster.de/~epebe_01/xyz.html

As this change may make some of your spplot's for points different, if
there are objections against this change (which I consider an
improvement, if not a bug fix), it is time now to let me / us know.

On 03/02/2012 09:03 PM, MacQueen, Don wrote:
> I have a SpatialPointsDataFrame object in which many points are very close
> together, such that the markers (plotting characters) tend to overlap. (Of
> course, this depends on marker size and the scale at which I plot; if I
> "zoom in" there is less overlap.)
> 
> It appears that when markers overlap, spplot() places a marker associated
> with the larger value after, and therefore on top of, a marker associated
> with a smaller value.
> 
> Am I correct? Or more generally, what is the algorithm that determines the
> order in which markers are added?
> 
> 
> I have searched ?spplot and related help pages and haven't found an
> explanation (at least, not yet).
> 
> I can add that I don't believe markers are placed in the order in which
> they appear in the SpatialPointsDataFrame. I say this because when I
> attempt to reproduce an spplot using base graphics plot() I have to sort
> from smallest to largest value to succeed.
> 
> I can probably provide a small reproducible example if necessary, but I'm
> hoping it's not necessary.
> 
> Here are my actual commands.
> 
>   tmps is the SpatialPointsDataFrame.
>   tmp is coordinates(tmps)
> (they have the same number of rows in the same order)
> 
> Note that I'm using the cuts argument to break a continuous variable
> ('cpm2') into bins. I have carefully matched the colors in tmps$col2 with
> the cbin.cols object passed to spplot(), and the break points for the bin
> boundaries, so I believe that everything else that could affect the final
> appearance, other than the order in which the markers are placed, is
> controlled.
> 
> #1 using spplot
> spplot(tmps,c('cpm2'),
>    key.space='right',
>    legendEntries=cbin.lbls,
>    cuts=cbin.brks,
>    col.regions=cbin.cols,
>    cex=0.4)
> 
> #2 using base graphics
> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
> 
> 
> 
> Thanks
> -Don
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From amonleong at wanadoo.es  Mon Mar  5 15:39:12 2012
From: amonleong at wanadoo.es (TM)
Date: Mon, 5 Mar 2012 15:39:12 +0100
Subject: [R-sig-Geo] Probability map of presence(1)-absence(0) data
	including trend and covariate
In-Reply-To: <201203051314.q25DEF8Q030872@smtp.upm.es>
References: <alpine.LRH.2.02.1202211105590.8671@reclus.nhh.no>
	<1E17B1B99AA64616B2C82AC04C6FAC7E@ub.edu>
	<201203051314.q25DEF8Q030872@smtp.upm.es>
Message-ID: <DA6971947D69430FAEAE566871A1AF81@ub.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120305/ceee9a5a/attachment.pl>

From marcelino.delacruz at upm.es  Mon Mar  5 16:05:51 2012
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 05 Mar 2012 16:05:51 +0100
Subject: [R-sig-Geo] Probability map of presence(1)-absence(0) data
 including trend and covariate
In-Reply-To: <DA6971947D69430FAEAE566871A1AF81@ub.edu>
References: <alpine.LRH.2.02.1202211105590.8671@reclus.nhh.no>
	<1E17B1B99AA64616B2C82AC04C6FAC7E@ub.edu>
	<201203051314.q25DEF8Q030872@smtp.upm.es>
	<DA6971947D69430FAEAE566871A1AF81@ub.edu>
Message-ID: <201203051505.q25F5tZ3015351@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120305/17b402ae/attachment.pl>

From macqueen1 at llnl.gov  Mon Mar  5 16:36:01 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 5 Mar 2012 07:36:01 -0800
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <4F54C246.1060606@uni-muenster.de>
Message-ID: <CB7A19E0.8D619%macqueen1@llnl.gov>

Edzer,

I think you've done the right thing -- and thank you for the quick
response.

Ironically, in the application that brought this up plotting higher values
on top was convenient, because higher values are of more interest.
However, I can still have higher values on top simply by sorting before
plotting. The user now has more control, and this is good.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 3/5/12 5:40 AM, "Edzer Pebesma" <edzer.pebesma at uni-muenster.de> wrote:

>This has now been changed/repared in sp on r-forge (svn), and will
>appear from sp 0.9-97 on. A test run would be:
>
>library(sp)
>xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
>coordinates(xyz)=~x+y
>spplot(xyz, cex=10)
>
>which used to plot points in value order, and does now in data record
>order.
>
>I put up resulting graphs, for comparison, at
>http://ifgi.uni-muenster.de/~epebe_01/xyz.html
>
>As this change may make some of your spplot's for points different, if
>there are objections against this change (which I consider an
>improvement, if not a bug fix), it is time now to let me / us know.
>
>On 03/02/2012 09:03 PM, MacQueen, Don wrote:
>> I have a SpatialPointsDataFrame object in which many points are very
>>close
>> together, such that the markers (plotting characters) tend to overlap.
>>(Of
>> course, this depends on marker size and the scale at which I plot; if I
>> "zoom in" there is less overlap.)
>> 
>> It appears that when markers overlap, spplot() places a marker
>>associated
>> with the larger value after, and therefore on top of, a marker
>>associated
>> with a smaller value.
>> 
>> Am I correct? Or more generally, what is the algorithm that determines
>>the
>> order in which markers are added?
>> 
>> 
>> I have searched ?spplot and related help pages and haven't found an
>> explanation (at least, not yet).
>> 
>> I can add that I don't believe markers are placed in the order in which
>> they appear in the SpatialPointsDataFrame. I say this because when I
>> attempt to reproduce an spplot using base graphics plot() I have to sort
>> from smallest to largest value to succeed.
>> 
>> I can probably provide a small reproducible example if necessary, but
>>I'm
>> hoping it's not necessary.
>> 
>> Here are my actual commands.
>> 
>>   tmps is the SpatialPointsDataFrame.
>>   tmp is coordinates(tmps)
>> (they have the same number of rows in the same order)
>> 
>> Note that I'm using the cuts argument to break a continuous variable
>> ('cpm2') into bins. I have carefully matched the colors in tmps$col2
>>with
>> the cbin.cols object passed to spplot(), and the break points for the
>>bin
>> boundaries, so I believe that everything else that could affect the
>>final
>> appearance, other than the order in which the markers are placed, is
>> controlled.
>> 
>> #1 using spplot
>> spplot(tmps,c('cpm2'),
>>    key.space='right',
>>    legendEntries=cbin.lbls,
>>    cuts=cbin.brks,
>>    col.regions=cbin.cols,
>>    cex=0.4)
>> 
>> #2 using base graphics
>> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
>> 
>> 
>> 
>> Thanks
>> -Don
>> 
>
>-- 
>Edzer Pebesma
>Institute for Geoinformatics (ifgi), University of M?nster
>Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Mon Mar  5 16:58:36 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 Mar 2012 16:58:36 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <CB7A19E0.8D619%macqueen1@llnl.gov>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
Message-ID: <4F54E2AC.6040707@uni-muenster.de>


On 03/05/2012 04:36 PM, MacQueen, Don wrote:
> Edzer,
> 
> I think you've done the right thing -- and thank you for the quick
> response.
> 
> Ironically, in the application that brought this up plotting higher values
> on top was convenient, because higher values are of more interest.
> However, I can still have higher values on top simply by sorting before
> plotting. The user now has more control, and this is good.

Right, the old behaviour is obtained by reordering the data, as in:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10), z = rnorm(100))
coordinates(xyz)=~x+y
spplot(xyz[order(xyz$z),], cex=10)
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From godina at dal.ca  Mon Mar  5 18:53:20 2012
From: godina at dal.ca (Aurelie C.Godin)
Date: Mon, 5 Mar 2012 09:53:20 -0800 (PST)
Subject: [R-sig-Geo] Loosmore and Ford (2006) Goodness-of-fit (GoF) test
	for CSR
In-Reply-To: <201203051301.q25D1a7r028679@smtp.upm.es>
References: <1330616363370-7332928.post@n2.nabble.com>
	<mTEvdhsG.1330672691.5123510.marcelino.delacruz@upm.es>
	<1330700924548-7336880.post@n2.nabble.com>
	<201203051301.q25D1a7r028679@smtp.upm.es>
Message-ID: <1330970000931-7345737.post@n2.nabble.com>

Thank you again Marcelino!
This works just perfectly!
Best,
Aurelie

-----
Aurelie Cosandey-Godin
Ph.D. Student, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Loosmore-and-Ford-2006-Goodness-of-fit-GoF-test-for-CSR-tp7332928p7345737.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From JhunjhnuwalaK at landcareresearch.co.nz  Tue Mar  6 00:16:49 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Tue, 6 Mar 2012 12:16:49 +1300
Subject: [R-sig-Geo] adjusting and moving scale
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3978@donkey.landcare.ad.landcareresearch.co.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/faab5292/attachment.pl>

From zua3 at cornell.edu  Tue Mar  6 02:49:56 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Mon, 05 Mar 2012 20:49:56 -0500
Subject: [R-sig-Geo] Population weighted Centroids?
In-Reply-To: <4F54E2AC.6040707@uni-muenster.de>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de>
Message-ID: <4F556D44.2040208@cornell.edu>

Is there anyway to calculate population weighted centroids of a spatial 
polygon   in R? Any idea will be appreciated. Thanks
Zia


-- 
---------------------
Zia Ahmed, PhD
Research Associate
Department of Crop and Soil Sciences
1002 Bradfield Hall, Cornell University
Ithaca, NY 14853-4203
t. 607.255.9387
f. 607.255.3207
email zua3 at cornell.edu


From edzer.pebesma at uni-muenster.de  Tue Mar  6 07:56:16 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 06 Mar 2012 07:56:16 +0100
Subject: [R-sig-Geo] adjusting and moving scale
In-Reply-To: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3978@donkey.landcare.ad.landcareresearch.co.nz>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3978@donkey.landcare.ad.landcareresearch.co.nz>
Message-ID: <4F55B510.8000805@uni-muenster.de>

Kanika, maybe something at

http://r-spatial.sourceforge.net/gallery/

resembles what you're looking for?

On 03/06/2012 12:16 AM, Kanika Jhunjhnuwala wrote:
> 
> Hi
> 
> I have 12 maps of the same area with a colour distribution which shows the change of temperature in this area. I have managed to plot them all on one jpeg with the same scale. How do I then move the scale so it is not on every little map but rather off to the side and only once and how do I control the tick marks on it
> Thanks
> 
> Kanika
> 
> ________________________________
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From b.rowlingson at lancaster.ac.uk  Tue Mar  6 09:02:02 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 6 Mar 2012 08:02:02 +0000
Subject: [R-sig-Geo] Population weighted Centroids?
In-Reply-To: <4F556D44.2040208@cornell.edu>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F556D44.2040208@cornell.edu>
Message-ID: <CANVKczPpwUzpvSef5ncx2LyK2JS8xjPvUxQS0KWOO=mBMygjrA@mail.gmail.com>

On Tue, Mar 6, 2012 at 1:49 AM, Zia Ahmed <zua3 at cornell.edu> wrote:
> Is there anyway to calculate population weighted centroids of a spatial
> polygon ? in R? Any idea will be appreciated. Thanks

 Some more clues would be appreciated! What's your data? A set of
points representing cities with populations and an additional set of
polygons? Or a raster population density and a set of polygons? Or
something else?

 Either way it can be done, but unless you tell us more precisely what
your problem is we'll all be wasting our time!

Barry


From e.polaina at gmail.com  Tue Mar  6 14:08:37 2012
From: e.polaina at gmail.com (Ester Polaina Lacambra)
Date: Tue, 6 Mar 2012 14:08:37 +0100
Subject: [R-sig-Geo] Projection of a shapefile
Message-ID: <CAB3kvzNyAzsbCWhCrWr4CySo7N6xYXt8pe==b0gE+PbO4Vs6uQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/32a180fc/attachment.pl>

From saldanha.plangeo at gmail.com  Tue Mar  6 14:13:13 2012
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Tue, 6 Mar 2012 10:13:13 -0300
Subject: [R-sig-Geo] Projection of a shapefile
In-Reply-To: <CAB3kvzNyAzsbCWhCrWr4CySo7N6xYXt8pe==b0gE+PbO4Vs6uQ@mail.gmail.com>
References: <CAB3kvzNyAzsbCWhCrWr4CySo7N6xYXt8pe==b0gE+PbO4Vs6uQ@mail.gmail.com>
Message-ID: <CACSWb416fthsCw5pZNGzxt4Ty3KU05yhbTN9kANB9-fs-NUvqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/25499fda/attachment.pl>

From Roger.Bivand at nhh.no  Tue Mar  6 14:24:25 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Mar 2012 14:24:25 +0100 (CET)
Subject: [R-sig-Geo] Projection of a shapefile
In-Reply-To: <CAB3kvzNyAzsbCWhCrWr4CySo7N6xYXt8pe==b0gE+PbO4Vs6uQ@mail.gmail.com>
References: <CAB3kvzNyAzsbCWhCrWr4CySo7N6xYXt8pe==b0gE+PbO4Vs6uQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203061416410.21694@reclus.nhh.no>

On Tue, 6 Mar 2012, Ester Polaina Lacambra wrote:

> Hello everyone,
>
> This is going to sound quite silly, but I'm an amateur R user and after a
> while I haven't been able to find the solution for my problem...
> I've got a shapefile coming from ArcMap 10, with a Projected Coordinate
> System: World_Cylindrical_Equal_Area (I chose that one when I was measuring
> areas); and a Geographic Coordinate System: GCS_WGS_1984.
>
> I read it with R by using:
>
> WCountries <- readShapePoly("myfile",ID="COUNTRY")
>

readShapeSpatial() in maptools cannot read any projection information - it 
uses shapelib, which ignores projections. Use the readOGR() function in 
rgdal instead. Do not be surprised if the Arc description is not matched, 
it is not a gold standard; an EPSG code has at least as good authority.

The coordinates you see are what you asked Arc to export, they are in the 
coordinate reference system you specified.

Roger

>
> When I use the expresion "coordinates(WCountries)" some apparently UTM
> coordinates appear. How do I know how R has calculated this? because
> it keeps saying:
>
>
> Is projected: NA
> proj4string : [NA]
>
>
>
> Thank you very much!!
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From JRadinger at gmx.at  Tue Mar  6 14:45:06 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Tue, 06 Mar 2012 14:45:06 +0100
Subject: [R-sig-Geo] Using "Mask" for SDMs (Maxent) with Dismo
Message-ID: <20120306134506.322650@gmx.net>

Hi,

I have several environmental rasters (loaded as stack/brick) in R which I want to use as predictors for Species Distribution Models (preferably Maxent) with the dismo-package. Some of the predictors are habitat specific variables and are restricted to a river (like a line of raster cells, all land is NA) while others cover the total spatial extent (climatic variables). Thus I've also created a raster MASK which indicates the cells that have values (that are non-NAs) in ALL maps.

Now I've two questions:
1) How can I use such a MASK within e.g. maxent to restrict my background points and predictions etc. only to these cells?
2) How can I simply exclude presence points that are outside these masking raster cells? I want only those samples (presences of my species) that are sampled within my defined rivers.


Thank you,

Johannes
-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From rafael.wueest at wsl.ch  Tue Mar  6 15:11:37 2012
From: rafael.wueest at wsl.ch (=?iso-8859-1?Q?Rafael_W=FCest?=)
Date: Tue, 6 Mar 2012 15:11:37 +0100
Subject: [R-sig-Geo] Using "Mask" for SDMs (Maxent) with Dismo
In-Reply-To: <20120306134506.322650@gmx.net>
References: <20120306134506.322650@gmx.net>
Message-ID: <C3F39529-A27C-4699-8F4E-7ABD036B3290@wsl.ch>

Hi Johannes,

On 06.03.2012, at 14:45, Johannes Radinger wrote:

> Hi,
> 
> I have several environmental rasters (loaded as stack/brick) in R which I want to use as predictors for Species Distribution Models (preferably Maxent) with the dismo-package. Some of the predictors are habitat specific variables and are restricted to a river (like a line of raster cells, all land is NA) while others cover the total spatial extent (climatic variables). Thus I've also created a raster MASK which indicates the cells that have values (that are non-NAs) in ALL maps.
> 
> Now I've two questions:
> 1) How can I use such a MASK within e.g. maxent to restrict my background points and predictions etc. only to these cells?

you can use the mask command from the raster package. something like

newstack<-mask(yourstack,yourmask)

each layer in the newstack will only contain values in those cells that are indicated in your MASK raster. This way, maxent will only sample from those that are left...

> 2) How can I simply exclude presence points that are outside these masking raster cells? I want only those samples (presences of my species) that are sampled within my defined rivers.

There might be more elegant ways, but you can use the extract command:

extentraster<-setValues(yourstack[[1]],1)
index<-extract(extentraster,yourpoints)

Those points with NAs in the index are not within the extent of your raster stack.

HTH, Rafael

> 
> 
> Thank you,
> 
> Johannes
> -- 
> 
> Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Rafael W?est
Swiss Federal Research Institute WSL
Z?rcherstrasse 111
8903 Birmensdorf
Switzerland

+41 44 7392126
rafael.wueest at wsl.ch
http://www.wsl.ch/info/mitarbeitende/wueest


From camille.leclerc at ymail.com  Tue Mar  6 15:30:18 2012
From: camille.leclerc at ymail.com (Camille Leclerc)
Date: Tue, 6 Mar 2012 14:30:18 +0000 (GMT)
Subject: [R-sig-Geo] Getting a new raster layer without the values of region
	shapefile
Message-ID: <1331044218.55751.YahooMailNeo@web132101.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/22f6b312/attachment.pl>

From JRadinger at gmx.at  Tue Mar  6 15:36:25 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Tue, 06 Mar 2012 15:36:25 +0100
Subject: [R-sig-Geo] writeRaster and coord ref problem
Message-ID: <20120306143625.217200@gmx.net>

Hi,

I need to load some data from the Worldclim Database and reproject them
to some other, already existing rasters. Because I don't want to use the reprojected rasters from the memory I want to save the brick as a GeoTiff (like the other rasters) using writeRaster. But somehow writeRaster() changes the coord. ref. line and drops "+datum=Potsdam". Here what I am doing:

> WC.bio <- projectRaster(getData("worldclim", var="bio", res=0.5, lon=9.3, lat=54.5),second.map)
> WC.bio
class       : RasterBrick 
dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
resolution  : 50, 50  (x, y)
extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0 
values      : in memory
min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0   52.1   28.0  151.0 ... 
max values  :   85   68   29 5964  210  -16  229  156   35  161 ...

> writeRaster(WC.bio, "/path/to/file.tif", format="GTiff", overwrite = TRUE)
class       : RasterBrick 
dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
resolution  : 50, 50  (x, y)
extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +towgs84=606,23,413,0,0,0,0 +units=m +no_defs 
values      : /Users/Johannes Radinger/Documents/IGB/IMPACT_Data/Treene/SDM/Predictors/WC.bio.tif 
min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0   52.1   28.0  151.0 ... 
max values  :   85   68   29 5964  210  -16  229  156   35  161 ... 


This is a problem to my as I want to combine the other maps with the reprojected Worldclim maps into a new stack from the files. But these files have different projections....

Best regards,
Johannes


From JRadinger at gmx.at  Tue Mar  6 16:09:28 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Tue, 06 Mar 2012 16:09:28 +0100
Subject: [R-sig-Geo] subset() for spatialPointsDataFrame
Message-ID: <20120306150928.20350@gmx.net>

Hi,

I just wanted to know how I have to use the 
subset() command for a SpatialPointsDataFrame correctly.

I'd like to get all records of the SpatialPointsDataFrame where the column "value" is > 0. Furthermore I want to select only two columns of that dataframe with these records. The subset command would be:

subset(points.df, value > 0 , select = c(column1, column2))

When I do that I get following error:

Error in subset.SpatialPointsDataFrame(points.df, value > 0, select = c(column1,  : 
  Object 'value' not found

I also tried:
subset(points.df, points.df["value"] > 0 , select = c(column1, column2))

Error in points.df["value"] > 0 : 
  Vergleich (6) ist nur f"ur atomare und Listentypen m"oglich (sorry is in German)...

Best regards,
Johannes

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From mauricio.zambrano at jrc.ec.europa.eu  Tue Mar  6 16:49:40 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 06 Mar 2012 16:49:40 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <4F54C246.1060606@uni-muenster.de>
References: <CB7667A8.8D25B%macqueen1@llnl.gov>
	<4F54C246.1060606@uni-muenster.de>
Message-ID: <4F563214.5060209@jrc.ec.europa.eu>

On 05/03/12 14:40, Edzer Pebesma wrote:
> This has now been changed/repared in sp on r-forge (svn), and will
> appear from sp 0.9-97 on. A test run would be:
>
> library(sp)
> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
> coordinates(xyz)=~x+y
> spplot(xyz, cex=10)
>
> which used to plot points in value order, and does now in data record order.
>
> I put up resulting graphs, for comparison, at
> http://ifgi.uni-muenster.de/~epebe_01/xyz.html
>
> As this change may make some of your spplot's for points different, if
> there are objections against this change (which I consider an
> improvement, if not a bug fix), it is time now to let me / us know.

Would it be possible to set a degree of transparency  for the 
overlapping points in spplot ?

Thanks in advance,

Mauricio Zambrano-Bigiarini
-
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)


>
> On 03/02/2012 09:03 PM, MacQueen, Don wrote:
>> I have a SpatialPointsDataFrame object in which many points are very close
>> together, such that the markers (plotting characters) tend to overlap. (Of
>> course, this depends on marker size and the scale at which I plot; if I
>> "zoom in" there is less overlap.)
>>
>> It appears that when markers overlap, spplot() places a marker associated
>> with the larger value after, and therefore on top of, a marker associated
>> with a smaller value.
>>
>> Am I correct? Or more generally, what is the algorithm that determines the
>> order in which markers are added?
>>
>>
>> I have searched ?spplot and related help pages and haven't found an
>> explanation (at least, not yet).
>>
>> I can add that I don't believe markers are placed in the order in which
>> they appear in the SpatialPointsDataFrame. I say this because when I
>> attempt to reproduce an spplot using base graphics plot() I have to sort
>> from smallest to largest value to succeed.
>>
>> I can probably provide a small reproducible example if necessary, but I'm
>> hoping it's not necessary.
>>
>> Here are my actual commands.
>>
>>    tmps is the SpatialPointsDataFrame.
>>    tmp is coordinates(tmps)
>> (they have the same number of rows in the same order)
>>
>> Note that I'm using the cuts argument to break a continuous variable
>> ('cpm2') into bins. I have carefully matched the colors in tmps$col2 with
>> the cbin.cols object passed to spplot(), and the break points for the bin
>> boundaries, so I believe that everything else that could affect the final
>> appearance, other than the order in which the markers are placed, is
>> controlled.
>>
>> #1 using spplot
>> spplot(tmps,c('cpm2'),
>>     key.space='right',
>>     legendEntries=cbin.lbls,
>>     cuts=cbin.brks,
>>     col.regions=cbin.cols,
>>     cex=0.4)
>>
>> #2 using base graphics
>> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
>>
>>
>>
>> Thanks
>> -Don
>>
>


-


From sturgeon09 at gmail.com  Tue Mar  6 16:53:11 2012
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Tue, 6 Mar 2012 10:53:11 -0500
Subject: [R-sig-Geo] subset() for spatialPointsDataFrame
In-Reply-To: <20120306150928.20350@gmx.net>
References: <20120306150928.20350@gmx.net>
Message-ID: <CAH3FZ05O+vaY5M1b=M1m++zJTazRnCZHN1-jDQot7zsMCxhs_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/90b7d959/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Mar  6 16:55:11 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 06 Mar 2012 16:55:11 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <4F563214.5060209@jrc.ec.europa.eu>
References: <CB7667A8.8D25B%macqueen1@llnl.gov>
	<4F54C246.1060606@uni-muenster.de>
	<4F563214.5060209@jrc.ec.europa.eu>
Message-ID: <4F56335F.50009@uni-muenster.de>

Yes, look for argument alpha e.g. in ?rgb or ?bpy.colors

On 03/06/2012 04:49 PM, Mauricio Zambrano-Bigiarini wrote:
> On 05/03/12 14:40, Edzer Pebesma wrote:
>> This has now been changed/repared in sp on r-forge (svn), and will
>> appear from sp 0.9-97 on. A test run would be:
>>
>> library(sp)
>> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
>> coordinates(xyz)=~x+y
>> spplot(xyz, cex=10)
>>
>> which used to plot points in value order, and does now in data record
>> order.
>>
>> I put up resulting graphs, for comparison, at
>> http://ifgi.uni-muenster.de/~epebe_01/xyz.html
>>
>> As this change may make some of your spplot's for points different, if
>> there are objections against this change (which I consider an
>> improvement, if not a bug fix), it is time now to let me / us know.
> 
> Would it be possible to set a degree of transparency  for the
> overlapping points in spplot ?
> 
> Thanks in advance,
> 
> Mauricio Zambrano-Bigiarini
> -
> =======================================================
> FLOODS Action
> Water Resources Unit (H01)
> Institute for Environment and Sustainability (IES)
> European Commission, Joint Research Centre (JRC)
> webinfo    : http://floods.jrc.ec.europa.eu/
> =======================================================
> DISCLAIMER:
> "The views expressed are purely those of the writer
> and may not in any circumstances be regarded as stating
> an official position of the European Commission."
> =======================================================
> Linux user #454569 -- Ubuntu user #17469
> =======================================================
> "If Columbus had turned back, no one would have blamed him.
> Of course, no one would have remembered him either."
> (Source Unknown)
> 
> 
>>
>> On 03/02/2012 09:03 PM, MacQueen, Don wrote:
>>> I have a SpatialPointsDataFrame object in which many points are very
>>> close
>>> together, such that the markers (plotting characters) tend to
>>> overlap. (Of
>>> course, this depends on marker size and the scale at which I plot; if I
>>> "zoom in" there is less overlap.)
>>>
>>> It appears that when markers overlap, spplot() places a marker
>>> associated
>>> with the larger value after, and therefore on top of, a marker
>>> associated
>>> with a smaller value.
>>>
>>> Am I correct? Or more generally, what is the algorithm that
>>> determines the
>>> order in which markers are added?
>>>
>>>
>>> I have searched ?spplot and related help pages and haven't found an
>>> explanation (at least, not yet).
>>>
>>> I can add that I don't believe markers are placed in the order in which
>>> they appear in the SpatialPointsDataFrame. I say this because when I
>>> attempt to reproduce an spplot using base graphics plot() I have to sort
>>> from smallest to largest value to succeed.
>>>
>>> I can probably provide a small reproducible example if necessary, but
>>> I'm
>>> hoping it's not necessary.
>>>
>>> Here are my actual commands.
>>>
>>>    tmps is the SpatialPointsDataFrame.
>>>    tmp is coordinates(tmps)
>>> (they have the same number of rows in the same order)
>>>
>>> Note that I'm using the cuts argument to break a continuous variable
>>> ('cpm2') into bins. I have carefully matched the colors in tmps$col2
>>> with
>>> the cbin.cols object passed to spplot(), and the break points for the
>>> bin
>>> boundaries, so I believe that everything else that could affect the
>>> final
>>> appearance, other than the order in which the markers are placed, is
>>> controlled.
>>>
>>> #1 using spplot
>>> spplot(tmps,c('cpm2'),
>>>     key.space='right',
>>>     legendEntries=cbin.lbls,
>>>     cuts=cbin.brks,
>>>     col.regions=cbin.cols,
>>>     cex=0.4)
>>>
>>> #2 using base graphics
>>> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
>>>
>>>
>>>
>>> Thanks
>>> -Don
>>>
>>
> 
> 
> -

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sturgeon09 at gmail.com  Tue Mar  6 17:03:29 2012
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Tue, 6 Mar 2012 11:03:29 -0500
Subject: [R-sig-Geo] trouble with writeOGR
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58E86@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58E86@BALI.uhd.campus>
Message-ID: <CAH3FZ04jRp1kJU9i9UkjkjzvsV9CJyQmmMsoDLTd5vHLoztcEg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/f2f0b616/attachment.pl>

From JRadinger at gmx.at  Tue Mar  6 17:04:46 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Tue, 06 Mar 2012 17:04:46 +0100
Subject: [R-sig-Geo] subset() for spatialPointsDataFrame
In-Reply-To: <CAH3FZ05O+vaY5M1b=M1m++zJTazRnCZHN1-jDQot7zsMCxhs_g@mail.gmail.com>
References: <20120306150928.20350@gmx.net>
	<CAH3FZ05O+vaY5M1b=M1m++zJTazRnCZHN1-jDQot7zsMCxhs_g@mail.gmail.com>
Message-ID: <20120306160446.45890@gmx.net>

Hi,

-------- Original-Nachricht --------
> Datum: Tue, 6 Mar 2012 10:53:11 -0500
> Von: Samuel Turgeon <sturgeon09 at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] subset() for spatialPointsDataFrame

> Hi Johannes,
> 
> did you transform your SpatialPointsDataFrame to a regular data.frame?
> 
> point.df=data.frame(point.spdf)
> subset(points.df, points.df[,"value"] > 0 , select = c(1, 2))
> coordinates(points.df) = ~X + Y ##You should keep those columns (X,Y) in
> the subset command in order to backtransform the dataframe in a
> SpatialPointsDataFrame
> points.spdf=point.df

thank you.. thats what I also came up so far... I was just wondering
if there is a more direct way with a spdf as I have to do several subsets and it would be nice if I don't have to do the retransformation each time.


/johannes


> 
> hope this helps
> 
> Sam
> 
> On Tue, Mar 6, 2012 at 10:09 AM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> 
> > Hi,
> >
> > I just wanted to know how I have to use the
> > subset() command for a SpatialPointsDataFrame correctly.
> >
> > I'd like to get all records of the SpatialPointsDataFrame where the
> column
> > "value" is > 0. Furthermore I want to select only two columns of that
> > dataframe with these records. The subset command would be:
> >
> > subset(points.df, value > 0 , select = c(column1, column2))
> >
> > When I do that I get following error:
> >
> > Error in subset.SpatialPointsDataFrame(points.df, value > 0, select =
> > c(column1,  :
> >  Object 'value' not found
> >
> > I also tried:
> > subset(points.df, points.df["value"] > 0 , select = c(column1, column2))
> >
> > Error in points.df["value"] > 0 :
> >  Vergleich (6) ist nur f"ur atomare und Listentypen m"oglich (sorry is
> in
> > German)...
> >
> > Best regards,
> > Johannes
> >
> > --
> >
> > Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From mauricio.zambrano at jrc.ec.europa.eu  Tue Mar  6 17:11:46 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 06 Mar 2012 17:11:46 +0100
Subject: [R-sig-Geo] spplot handling of overlapping points?
In-Reply-To: <4F56335F.50009@uni-muenster.de>
References: <CB7667A8.8D25B%macqueen1@llnl.gov>
	<4F54C246.1060606@uni-muenster.de> <4F563214.5060209@jrc.ec.europa.eu>
	<4F56335F.50009@uni-muenster.de>
Message-ID: <4F563742.70708@jrc.ec.europa.eu>

On 06/03/12 16:55, Edzer Pebesma wrote:
> Yes, look for argument alpha e.g. in ?rgb or ?bpy.colors

Thank you very much Edzer. It works perfectly:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y
spplot(xyz, cex=10, alpha=0.7)

Cheers,

Mauricio

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)
>
> On 03/06/2012 04:49 PM, Mauricio Zambrano-Bigiarini wrote:
>> On 05/03/12 14:40, Edzer Pebesma wrote:
>>> This has now been changed/repared in sp on r-forge (svn), and will
>>> appear from sp 0.9-97 on. A test run would be:
>>>
>>> library(sp)
>>> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
>>> coordinates(xyz)=~x+y
>>> spplot(xyz, cex=10)
>>>
>>> which used to plot points in value order, and does now in data record
>>> order.
>>>
>>> I put up resulting graphs, for comparison, at
>>> http://ifgi.uni-muenster.de/~epebe_01/xyz.html
>>>
>>> As this change may make some of your spplot's for points different, if
>>> there are objections against this change (which I consider an
>>> improvement, if not a bug fix), it is time now to let me / us know.
>>
>> Would it be possible to set a degree of transparency  for the
>> overlapping points in spplot ?
>>
>> Thanks in advance,
>>
>> Mauricio Zambrano-Bigiarini
>> -
>> =======================================================
>> FLOODS Action
>> Water Resources Unit (H01)
>> Institute for Environment and Sustainability (IES)
>> European Commission, Joint Research Centre (JRC)
>> webinfo    : http://floods.jrc.ec.europa.eu/
>> =======================================================
>> DISCLAIMER:
>> "The views expressed are purely those of the writer
>> and may not in any circumstances be regarded as stating
>> an official position of the European Commission."
>> =======================================================
>> Linux user #454569 -- Ubuntu user #17469
>> =======================================================
>> "If Columbus had turned back, no one would have blamed him.
>> Of course, no one would have remembered him either."
>> (Source Unknown)
>>
>>
>>>
>>> On 03/02/2012 09:03 PM, MacQueen, Don wrote:
>>>> I have a SpatialPointsDataFrame object in which many points are very
>>>> close
>>>> together, such that the markers (plotting characters) tend to
>>>> overlap. (Of
>>>> course, this depends on marker size and the scale at which I plot; if I
>>>> "zoom in" there is less overlap.)
>>>>
>>>> It appears that when markers overlap, spplot() places a marker
>>>> associated
>>>> with the larger value after, and therefore on top of, a marker
>>>> associated
>>>> with a smaller value.
>>>>
>>>> Am I correct? Or more generally, what is the algorithm that
>>>> determines the
>>>> order in which markers are added?
>>>>
>>>>
>>>> I have searched ?spplot and related help pages and haven't found an
>>>> explanation (at least, not yet).
>>>>
>>>> I can add that I don't believe markers are placed in the order in which
>>>> they appear in the SpatialPointsDataFrame. I say this because when I
>>>> attempt to reproduce an spplot using base graphics plot() I have to sort
>>>> from smallest to largest value to succeed.
>>>>
>>>> I can probably provide a small reproducible example if necessary, but
>>>> I'm
>>>> hoping it's not necessary.
>>>>
>>>> Here are my actual commands.
>>>>
>>>>     tmps is the SpatialPointsDataFrame.
>>>>     tmp is coordinates(tmps)
>>>> (they have the same number of rows in the same order)
>>>>
>>>> Note that I'm using the cuts argument to break a continuous variable
>>>> ('cpm2') into bins. I have carefully matched the colors in tmps$col2
>>>> with
>>>> the cbin.cols object passed to spplot(), and the break points for the
>>>> bin
>>>> boundaries, so I believe that everything else that could affect the
>>>> final
>>>> appearance, other than the order in which the markers are placed, is
>>>> controlled.
>>>>
>>>> #1 using spplot
>>>> spplot(tmps,c('cpm2'),
>>>>      key.space='right',
>>>>      legendEntries=cbin.lbls,
>>>>      cuts=cbin.brks,
>>>>      col.regions=cbin.cols,
>>>>      cex=0.4)
>>>>
>>>> #2 using base graphics
>>>> plot(tmp[,1],tmp[,2], asp=1, cex=0.6, pch=16, col=tmps$col2)
>>>>
>>>>
>>>>
>>>> Thanks
>>>> -Don
>>>>
>>>
>>
>>
>> -
>


From tom.gottfried at tum.de  Tue Mar  6 17:21:19 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Tue, 06 Mar 2012 17:21:19 +0100
Subject: [R-sig-Geo] subset() for spatialPointsDataFrame
In-Reply-To: <CAH3FZ05O+vaY5M1b=M1m++zJTazRnCZHN1-jDQot7zsMCxhs_g@mail.gmail.com>
References: <20120306150928.20350@gmx.net>
	<CAH3FZ05O+vaY5M1b=M1m++zJTazRnCZHN1-jDQot7zsMCxhs_g@mail.gmail.com>
Message-ID: <4F56397F.1070504@tum.de>

Am 06.03.2012 16:53, schrieb Samuel Turgeon:
> Hi Johannes,
>
> did you transform your SpatialPointsDataFrame to a regular data.frame?
>
> point.df=data.frame(point.spdf)
> subset(points.df, points.df[,"value"]>  0 , select = c(1, 2))

Indexing with the correct number of dimensions as done here (in contrast 
to Johannes' original command) should work well also with a 
SpatialPointsDataFrame.

And Johannes: Might I remind you that you asked almost the same question 
a few weeks ago 
(https://stat.ethz.ch/pipermail/r-sig-geo/2012-February/014111.html)? 
You might read this (and I would like to emphasize the second paragraph 
here):
http://www.r-project.org/posting-guide.html

Regards,
Tom

> coordinates(points.df) = ~X + Y ##You should keep those columns (X,Y) in
> the subset command in order to backtransform the dataframe in a
> SpatialPointsDataFrame
> points.spdf=point.df
>
> hope this helps
>
> Sam
>
> On Tue, Mar 6, 2012 at 10:09 AM, Johannes Radinger<JRadinger at gmx.at>  wrote:
>
>> Hi,
>>
>> I just wanted to know how I have to use the
>> subset() command for a SpatialPointsDataFrame correctly.
>>
>> I'd like to get all records of the SpatialPointsDataFrame where the column
>> "value" is>  0. Furthermore I want to select only two columns of that
>> dataframe with these records. The subset command would be:
>>
>> subset(points.df, value>  0 , select = c(column1, column2))
>>
>> When I do that I get following error:
>>
>> Error in subset.SpatialPointsDataFrame(points.df, value>  0, select =
>> c(column1,  :
>>   Object 'value' not found
>>
>> I also tried:
>> subset(points.df, points.df["value"]>  0 , select = c(column1, column2))
>>
>> Error in points.df["value"]>  0 :
>>   Vergleich (6) ist nur f"ur atomare und Listentypen m"oglich (sorry is in
>> German)...
>>
>> Best regards,
>> Johannes
>>
>> --
>>
>> Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From r.hijmans at gmail.com  Tue Mar  6 18:20:09 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Mar 2012 09:20:09 -0800
Subject: [R-sig-Geo] writeRaster and coord ref problem
In-Reply-To: <20120306143625.217200@gmx.net>
References: <20120306143625.217200@gmx.net>
Message-ID: <CANtt_hwdGtgQOgeD0d8BEXCwu9H4vqmK91g+VNHxc-JOp8fjxg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/1eab47e8/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Tue Mar  6 18:23:11 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 06 Mar 2012 18:23:11 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
Message-ID: <4F5647FF.7090708@jrc.ec.europa.eu>

Hi all,


I need to produce two different spplot figures of spatial points, and I 
would like to ask your help for the creation of the second one:

1) the first figure has to show the values but without any legend:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y
spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)

(I don't have any problem with this)


2) The second figure has to show ONLY the legend for the values of the 
previous figure (without plotting the points), inside the plotting area.

I tried with:

spplot(xyz, cex=0, alpha=0.7, auto.key=TRUE, key.space="center")

but it doesn't work.


I know that "center" is not a valid argument for 'key.space', but I 
don't figure out how to produce this second figure.


I would really appreciate any help with this.

Thanks in advance,

Mauricio Zambrano-Bigiarni

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:11}}


From r.hijmans at gmail.com  Tue Mar  6 18:27:30 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Mar 2012 09:27:30 -0800
Subject: [R-sig-Geo] Using "Mask" for SDMs (Maxent) with Dismo
In-Reply-To: <20120306134506.322650@gmx.net>
References: <20120306134506.322650@gmx.net>
Message-ID: <CANtt_hyxrBBUcNSgCeNUXXnXLWFMJNXdM9989G+C3JzpMeaQgg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/b350546e/attachment.pl>

From r.hijmans at gmail.com  Tue Mar  6 18:33:58 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Mar 2012 09:33:58 -0800
Subject: [R-sig-Geo] Getting a new raster layer without the values of
 region shapefile
In-Reply-To: <1331044218.55751.YahooMailNeo@web132101.mail.ird.yahoo.com>
References: <1331044218.55751.YahooMailNeo@web132101.mail.ird.yahoo.com>
Message-ID: <CANtt_hzJSKYcRy9jHbUanPsDuKVD7nub4FJdHubnH7_zxQQJ9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/3612ac4e/attachment.pl>

From spareeth at gmail.com  Tue Mar  6 20:07:44 2012
From: spareeth at gmail.com (sajid pareeth)
Date: Wed, 7 Mar 2012 00:37:44 +0530
Subject: [R-sig-Geo] error reading ncdf files
Message-ID: <CAO7vHBGibyUuU8DP1krbQ3pMhTwUiaugBAvLzAWBnCCK=83ZVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120307/594e1480/attachment.pl>

From r.hijmans at gmail.com  Tue Mar  6 20:40:08 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Mar 2012 11:40:08 -0800
Subject: [R-sig-Geo] error reading ncdf files
In-Reply-To: <CAO7vHBGibyUuU8DP1krbQ3pMhTwUiaugBAvLzAWBnCCK=83ZVw@mail.gmail.com>
References: <CAO7vHBGibyUuU8DP1krbQ3pMhTwUiaugBAvLzAWBnCCK=83ZVw@mail.gmail.com>
Message-ID: <CANtt_hzi2dVbaptXvnYCz87_PE6mkors6QAAEgBBbKD5f-zF1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/44225b9f/attachment.pl>

From JhunjhnuwalaK at landcareresearch.co.nz  Tue Mar  6 21:29:27 2012
From: JhunjhnuwalaK at landcareresearch.co.nz (Kanika Jhunjhnuwala)
Date: Wed, 7 Mar 2012 09:29:27 +1300
Subject: [R-sig-Geo] adjusting and moving scale
In-Reply-To: <4F55B510.8000805@uni-muenster.de>
References: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3978@donkey.landcare.ad.landcareresearch.co.nz>
	<4F55B510.8000805@uni-muenster.de>
Message-ID: <F2969C1B08CBEE42B78C04C280D578E73BFD4D3C57@donkey.landcare.ad.landcareresearch.co.nz>

Yes perfect thanks.

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
Sent: Tuesday, 6 March 2012 7:56 p.m.
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] adjusting and moving scale

Kanika, maybe something at

http://r-spatial.sourceforge.net/gallery/

resembles what you're looking for?

On 03/06/2012 12:16 AM, Kanika Jhunjhnuwala wrote:
>
> Hi
>
> I have 12 maps of the same area with a colour distribution which shows
> the change of temperature in this area. I have managed to plot them
> all on one jpeg with the same scale. How do I then move the scale so
> it is not on every little map but rather off to the side and only once
> and how do I control the tick marks on it Thanks
>
> Kanika
>
> ________________________________
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare
> Research New Zealand Limited. http://www.landcareresearch.co.nz
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Please consider the environment before printing this email
Warning:  This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz


From iflybyu at gmail.com  Tue Mar  6 22:55:15 2012
From: iflybyu at gmail.com (mark allen)
Date: Tue, 6 Mar 2012 13:55:15 -0800
Subject: [R-sig-Geo] simple return calculation on getSymbols data
Message-ID: <CAEPFHAvS510VMhWTMEdgMs+tpKmN-cR9_BTwgpbH=6DTCLuYpQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/bb994666/attachment.pl>

From lord.ben.stewart at gmail.com  Wed Mar  7 04:22:53 2012
From: lord.ben.stewart at gmail.com (Benjamin Stewart)
Date: Tue, 6 Mar 2012 22:22:53 -0500
Subject: [R-sig-Geo] Creating a Shapefile from a List of Polygons
Message-ID: <CAN+Mroj_YKZhRy3A9jhBP7KNoOECZi1G4Rfr+8S2+mUmXEoNuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120306/7042e227/attachment.pl>

From spareeth at gmail.com  Wed Mar  7 06:42:57 2012
From: spareeth at gmail.com (sajid pareeth)
Date: Wed, 7 Mar 2012 11:12:57 +0530
Subject: [R-sig-Geo] error reading ncdf files
In-Reply-To: <CANtt_hzi2dVbaptXvnYCz87_PE6mkors6QAAEgBBbKD5f-zF1A@mail.gmail.com>
References: <CAO7vHBGibyUuU8DP1krbQ3pMhTwUiaugBAvLzAWBnCCK=83ZVw@mail.gmail.com>
	<CANtt_hzi2dVbaptXvnYCz87_PE6mkors6QAAEgBBbKD5f-zF1A@mail.gmail.com>
Message-ID: <CAO7vHBGiePbgHRjyXGSK1FOOwHpGS6KgZ9rchF-52OX5KcRq_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120307/900e61d4/attachment.pl>

From valdounet at gmail.com  Wed Mar  7 09:18:42 2012
From: valdounet at gmail.com (Vlad)
Date: Wed, 07 Mar 2012 09:18:42 +0100
Subject: [R-sig-Geo] Creating a Shapefile from a List of Polygons
In-Reply-To: <CAN+Mroj_YKZhRy3A9jhBP7KNoOECZi1G4Rfr+8S2+mUmXEoNuQ@mail.gmail.com>
References: <CAN+Mroj_YKZhRy3A9jhBP7KNoOECZi1G4Rfr+8S2+mUmXEoNuQ@mail.gmail.com>
Message-ID: <4F5719E2.2090103@gmail.com>

Hi Benjamin,

I don't know if you have read carefully the help on 
SpatialPolygonsDataFrame but it is written about the "data" arugment :

"the number of rows in ?data? should equal the number of Polygons-class 
objects in ?Sr?"

In your example 'spPolys' correspond to 'Sr' and is a SpatialPolygons 
which length is 1.
You should build a SpatialPolygons with length equal to the number of 
rows of polyData.
The code below should help you :

xx <- mapply (
             FUN=function(x, y) Polygons(list(x), y),
             polyList, paste('FUBAR', 1:length(polyList), sep='.'),
             SIMPLIFY=FALSE)

spPolys <- SpatialPolygons(xx)
polyData <- data.frame (test=1:length(spPolys)) # actually the datayou 
want to use
dfReturn <- SpatialPolygonsDataFrame (spPolys, polyData, match.ID=FALSE)

Best,

Vlad

-------
Vladislav Navel

SCAN
www.scan-datamining.com

Le 07/03/2012 04:22, Benjamin Stewart a ?crit :
> I feel like I have done this before, so I am sorry if I have made a stupid
> mistake, however, I am out of ideas.
>
> I am trying to make a shapefile out of a list of polygons. I want to
> include the a data frame as well, but I can't seem to create a
> SpatialPolygons-Class longer than one object. The one object has all the
> individual features when I map it, but it is only one object. Here is my
> code:
>
>       xx = Polygons(polyList, "FUBAR")
>       spPolys = SpatialPolygons(list(xx))
>       polyData = (The data frame I want to use)
>       dfReturn = SpatialPolygonsDataFrame(spPolys, polyData, match.ID=F)
>
> Any ideas? If I replace the polyData with data.frame(ID = 1) stupid thing
> works!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From JRadinger at gmx.at  Wed Mar  7 11:22:47 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Wed, 07 Mar 2012 11:22:47 +0100
Subject: [R-sig-Geo] Using "Mask" for SDMs (Maxent) with Dismo
In-Reply-To: <CANtt_hyxrBBUcNSgCeNUXXnXLWFMJNXdM9989G+C3JzpMeaQgg@mail.gmail.com>
References: <20120306134506.322650@gmx.net>
	<CANtt_hyxrBBUcNSgCeNUXXnXLWFMJNXdM9989G+C3JzpMeaQgg@mail.gmail.com>
Message-ID: <20120307102247.157650@gmx.net>

Hi Rafael,
Hi Robert, 

-------- Original-Nachricht --------
> Datum: Tue, 6 Mar 2012 09:27:30 -0800
> Von: "Robert J. Hijmans" <r.hijmans at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] Using "Mask" for SDMs (Maxent) with Dismo

> Johannes,
> 
> On Tue, Mar 6, 2012 at 5:45 AM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> 
> > Hi,
> >
> > I have several environmental rasters (loaded as stack/brick) in R which
> I
> > want to use as predictors for Species Distribution Models (preferably
> > Maxent) with the dismo-package. Some of the predictors are habitat
> specific
> > variables and are restricted to a river (like a line of raster cells,
> all
> > land is NA) while others cover the total spatial extent (climatic
> > variables). Thus I've also created a raster MASK which indicates the
> cells
> > that have values (that are non-NAs) in ALL maps.
> >
> > Now I've two questions:
> > 1) How can I use such a MASK within e.g. maxent to restrict my
> background
> > points and predictions etc. only to these cells?
> >
> 
> That is automatic. All cells with NA values are removed. However,
> background sampling might suffer in this case, and it could be good to
> make
> your own background sample using the "randomPoints" function (that takes a
> mask layer as argument).

Thank you for your answer. I used Rafaels approach (newstack<-mask(yourstack,yourmask)) to get "ready" maps which I'll use further on. And I'll use randomPoints to get my background samples...


> 
> 
> 
> > 2) How can I simply exclude presence points that are outside these
> masking
> > raster cells? I want only those samples (presences of my species) that
> are
> > sampled within my defined rivers.
> >
> >
> That is automatic, only points with values for all layers are maintained.
> If you are not sure, you can of course also extract the values for the
> points and remove all rows with NAs. Please see the help files and the
> vignette!

Also here I used Rafaels' approach:
df$index <- extract(mask,df)
df <- df[!is.na(df$index),]

That works really fine. Thank you for all your help!

/Johannes


> 
> Robert
> 
> 
> 
> > Thank you,
> >
> > Johannes
> > --
> >
> > Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From JRadinger at gmx.at  Wed Mar  7 11:29:14 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Wed, 07 Mar 2012 11:29:14 +0100
Subject: [R-sig-Geo] writeRaster and coord ref problem
In-Reply-To: <CANtt_hwdGtgQOgeD0d8BEXCwu9H4vqmK91g+VNHxc-JOp8fjxg@mail.gmail.com>
References: <20120306143625.217200@gmx.net>
	<CANtt_hwdGtgQOgeD0d8BEXCwu9H4vqmK91g+VNHxc-JOp8fjxg@mail.gmail.com>
Message-ID: <20120307102914.157650@gmx.net>

Hi again,

I also tried your example and I can reproduce the problem in contrast to you. After opening a fresh session, here is what I get:

> library(raster)
Lade n"otiges Paket: sp
raster version 1.9-70 (27-February-2012)
> crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0"
> r <- raster(nc=10, nr=10, crs=crs)
> r[] <- 1:ncell(r)
> b <- brick(r,r,r)
> x <- writeRaster(b, 'datum.tif', overwrite=TRUE)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
Path to GDAL shared files: /Users/Johannes Radinger/Library/R/2.14/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: /Users/Johannes Radinger/Library/R/2.14/library/rgdal/proj
> x
class       : RasterBrick 
dimensions  : 10, 10, 100, 3  (nrow, ncol, ncell, nlayers)
resolution  : 36, 18  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +towgs84=606,23,413,0,0,0,0 +units=m +no_defs 
values      : /Users/Johannes Radinger/Documents/Eclipse_workspace/datum.tif 
min values  : 1 1 1 
max values  : 100 100 100 

> sessionInfo()
R version 2.14.2 (2012-02-29)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.7-8   raster_1.9-70 sp_0.9-95     rj_1.0.0-3   

loaded via a namespace (and not attached):
[1] grid_2.14.2    lattice_0.20-0 rj.gd_1.0.0-1  tools_2.14.2  



What might cause the problem? Is there any bug I should report? Maybe the problem is platform specific (I use a Mac) or has something to do with my version of GDAL/PROJ4?
Any suggestions?

In the meanwhile I'll try your approach with resetting the CRS: 
projection(x) <- crs

/Johannes



-------- Original-Nachricht --------
> Datum: Tue, 6 Mar 2012 09:20:09 -0800
> Von: "Robert J. Hijmans" <r.hijmans at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] writeRaster and coord ref problem

> Johannes, it works for me:
> 
> library(raster)
> crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0"
> r <- raster(nc=10, nr=10, crs=crs)
> r[] <- 1:ncell(r)
> b <- brick(r,r,r)
> x <- writeRaster(b, 'datum.tif', overwrite=TRUE)
> 
> > x
> class       : RasterBrick
> dimensions  : 10, 10, 100, 3  (nrow, ncol, ncell, nlayers)
> resolution  : 36, 18  (x, y)
> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0
> values      : datum.tif
> min values  : 1 1 1
> max values  : 100 100 100
> 
> 
> If for some reason part of the proj.4 description is lost, you can set it
> again with something like
> 
> projection(x) <- crs
> 
> > sessionInfo()
> R version 2.14.1 (2011-12-22)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
> 
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252    LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C                           LC_TIME=English_United
> States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] rgdal_0.7-5   raster_1.9-71 sp_0.9-93
> 
> loaded via a namespace (and not attached):
> [1] grid_2.14.1    lattice_0.20-0
> 
> 
> Best, Robert
> 
> On Tue, Mar 6, 2012 at 6:36 AM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> 
> > Hi,
> >
> > I need to load some data from the Worldclim Database and reproject them
> > to some other, already existing rasters. Because I don't want to use the
> > reprojected rasters from the memory I want to save the brick as a
> GeoTiff
> > (like the other rasters) using writeRaster. But somehow writeRaster()
> > changes the coord. ref. line and drops "+datum=Potsdam". Here what I am
> > doing:
> >
> > > WC.bio <- projectRaster(getData("worldclim", var="bio", res=0.5,
> > lon=9.3, lat=54.5),second.map)
> > > WC.bio
> > class       : RasterBrick
> > dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
> > resolution  : 50, 50  (x, y)
> > extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0
> > values      : in memory
> > min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0   52.1
> > 28.0  151.0 ...
> > max values  :   85   68   29 5964  210  -16  229  156   35  161 ...
> >
> > > writeRaster(WC.bio, "/path/to/file.tif", format="GTiff", overwrite =
> > TRUE)
> > class       : RasterBrick
> > dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
> > resolution  : 50, 50  (x, y)
> > extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > +ellps=bessel +towgs84=606,23,413,0,0,0,0 +units=m +no_defs
> > values      : /Users/Johannes
> > Radinger/Documents/IGB/IMPACT_Data/Treene/SDM/Predictors/WC.bio.tif
> > min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0   52.1
> > 28.0  151.0 ...
> > max values  :   85   68   29 5964  210  -16  229  156   35  161 ...
> >
> >
> > This is a problem to my as I want to combine the other maps with the
> > reprojected Worldclim maps into a new stack from the files. But these
> files
> > have different projections....
> >
> > Best regards,
> > Johannes
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From jon.skoien at jrc.ec.europa.eu  Wed Mar  7 11:57:01 2012
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Wed, 07 Mar 2012 11:57:01 +0100
Subject: [R-sig-Geo] spplot with legend only,
 and legend inside the plotting area
In-Reply-To: <4F5647FF.7090708@jrc.ec.europa.eu>
References: <4F5647FF.7090708@jrc.ec.europa.eu>
Message-ID: <4F573EFD.4090509@jrc.ec.europa.eu>

Hi Mauricio,

Maybe not the most elegant solution, but one possibility is to extract 
the colors and text of the legend from the spplot-object and plot it 
with legend():
p1 = spplot(xyz, cex=10, alpha=0.7)
str(p1)
# This has auto.key = "bottom" by default.
cols = p1$legend$bottom$args$key$points$col
txt = p1$legend$bottom$args$key$text[[1]]
plot.new()
legend(0.3,0.7, legend = txt, fill = cols, border = cols, bty = "n")

legend() has lots of parameters that can help you adjusting the plot if 
you need to modify the layout.

Cheers,
Jon

On 06-Mar-12 18:23, Mauricio Zambrano-Bigiarini wrote:
> Hi all,
>
>
> I need to produce two different spplot figures of spatial points, and 
> I would like to ask your help for the creation of the second one:
>
> 1) the first figure has to show the values but without any legend:
>
> library(sp)
> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
> coordinates(xyz)=~x+y
> spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
>
> (I don't have any problem with this)
>
>
> 2) The second figure has to show ONLY the legend for the values of the 
> previous figure (without plotting the points), inside the plotting area.
>
> I tried with:
>
> spplot(xyz, cex=0, alpha=0.7, auto.key=TRUE, key.space="center")
>
> but it doesn't work.
>
>
> I know that "center" is not a valid argument for 'key.space', but I 
> don't figure out how to produce this second figure.
>
>
> I would really appreciate any help with this.
>
> Thanks in advance,
>
> Mauricio Zambrano-Bigiarni
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From oscar.perpinan at upm.es  Wed Mar  7 13:11:53 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 07 Mar 2012 13:11:53 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <4F5647FF.7090708@jrc.ec.europa.eu> (Mauricio
	Zambrano-Bigiarini's message of "Tue, 06 Mar 2012 18:23:11 +0100")
References: <4F5647FF.7090708@jrc.ec.europa.eu>
Message-ID: <87ty201ugm.fsf@upm.es>

Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu> writes:

> I need to produce two different spplot figures of spatial points, and
> I would like to ask your help for the creation of the second one:
>
> 1) the first figure has to show the values but without any legend:
>
> library(sp)
> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
> coordinates(xyz)=~x+y
> spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
>
> (I don't have any problem with this)
>
>
> 2) The second figure has to show ONLY the legend for the values of the
> previous figure (without plotting the points), inside the plotting
> area.
>
> I tried with:
>
> spplot(xyz, cex=0, alpha=0.7, auto.key=TRUE, key.space="center")

Hello,

Try this:

spplot(xyz, auto.key=list(x=.5, y=.5), cex=0)

Change the values of x,y for your convenience. You can also find useful
"corner" instead of x,y. For more information read the "auto.key", "key" and
"legend" parts of the help page of xyplot.

Cheers,

Oscar.
-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From mathieu.rajerison at gmail.com  Wed Mar  7 15:04:18 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 7 Mar 2012 15:04:18 +0100
Subject: [R-sig-Geo] tilted satellite projection
Message-ID: <CAGfc75=V9sN8YZ+5S6G7VnmLzPwcEjqbfRmw2g7+VDo_NM0qnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120307/117f17e8/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Wed Mar  7 17:38:58 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Wed, 07 Mar 2012 17:38:58 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <87ty201ugm.fsf@upm.es>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
Message-ID: <4F578F22.3010306@jrc.ec.europa.eu>

On 07/03/12 13:11, Oscar Perpi??n Lamigueiro wrote:
> Mauricio Zambrano-Bigiarini<mauricio.zambrano at jrc.ec.europa.eu>  writes:
>
>> I need to produce two different spplot figures of spatial points, and
>> I would like to ask your help for the creation of the second one:
>>
>> 1) the first figure has to show the values but without any legend:
>>
>> library(sp)
>> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
>> coordinates(xyz)=~x+y
>> spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
>>
>> (I don't have any problem with this)
>>
>>
>> 2) The second figure has to show ONLY the legend for the values of the
>> previous figure (without plotting the points), inside the plotting
>> area.
>>
>> I tried with:
>>
>> spplot(xyz, cex=0, alpha=0.7, auto.key=TRUE, key.space="center")
>
> Hello,
>
> Try this:
>
> spplot(xyz, auto.key=list(x=.5, y=.5), cex=0)
>
> Change the values of x,y for your convenience. You can also find useful
> "corner" instead of x,y. For more information read the "auto.key", "key" and
> "legend" parts of the help page of xyplot.
>
> Cheers,
>
> Oscar.

Thank you very much you both Oscar and Jon for your help.

I'm almost there...

The real problem appears when I try to produce several spplots within 
the same figure (each one of them for a different spatial area), with a 
unique legend for all the figures (that is the reason why I can not use 
'legend' command).

For example, while trying to produce 4 different plots within the same 
figure:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y

# only to get the default values from 'auto.key'
dummy <- spplot(xyz, cex=10, alpha=0.7)

# This has auto.key = "bottom" by default.
cols = dummy$legend$bottom$args$key$points$col
txt = dummy$legend$bottom$args$key$text[[1]]

# number of elements in the legend
n <- length(cols)

p1 <- spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
p2 <- p1
p3 <- p1

# only the legend
p4 <- spplot(xyz, cex=0, auto.key=list(x=.5, y=.5, corner = c(0.5, 0.5), 
title="my legend") )

print(p1, split = c(1, 1, 2, 2), more = TRUE)
print(p2, split = c(2, 1, 2, 2), more = TRUE)
print(p3, split = c(1, 2, 2, 2), more = TRUE)
print(p4, split = c(2, 2, 2, 2), more = FALSE)

--------
The previous solution has two problems (for me) that I couldn't solve:
1) the colors for the symbols are not correct
2) The symbols are plotted at the right side of the legend, while I 
would like to have them on the left side


I tried to solve the 2nd problem by using 'key' instead of 'auto.key':

p4 <- spplot(xyz, cex=0,
              key = list(x = 0.5, y = 0.5, corner = c(0.5, 0.5),
                         title="my legend", text = list(txt),
                         points = list(pch = rep(16, length = n),
                                       col = cols,
                                       cex = rep(1.5, length = n)
		                      )
		       )
               )

print(p1, split = c(1, 1, 2, 2), more = TRUE)
print(p2, split = c(2, 1, 2, 2), more = TRUE)
print(p3, split = c(1, 2, 2, 2), more = TRUE)
print(p4, split = c(2, 2, 2, 2), more = FALSE)


and now the colors are correct, but the legend appears at the bottom of 
the plotting area, not in the centre as before.


Does it mean that spplot ignores the x, y, and corner arguments in 'key' ?


 > sessionInfo() # part of it
R version 2.14.1 (2011-12-22)
Platform: x86_64-redhat-linux-gnu (64-bit)
.
.
.

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] sp_0.9-95         lattice_0.20-0

loaded via a namespace (and not attached):
[1] cluster_1.14.2 grid_2.14.1    Hmisc_3.9-2


Thanks in advance,

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)


From oscar.perpinan at upm.es  Wed Mar  7 17:51:51 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 07 Mar 2012 17:51:51 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <4F578F22.3010306@jrc.ec.europa.eu> (Mauricio
	Zambrano-Bigiarini's message of "Wed, 07 Mar 2012 17:38:58 +0100")
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu>
Message-ID: <87boo8jqvs.fsf@upm.es>

Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu> writes:

> On 07/03/12 13:11, Oscar Perpi??n Lamigueiro wrote:
>> Mauricio Zambrano-Bigiarini<mauricio.zambrano at jrc.ec.europa.eu>  writes:
>>
> The real problem appears when I try to produce several spplots within
> the same figure (each one of them for a different spatial area), with
> a unique legend for all the figures (that is the reason why I can not
> use 'legend' command).

Then you could use c.trellis:

With your example:

c(dummy, dummy, dummy, dummy).

Inside c() you can define the 'layout' and decide if you want to merge
legends with 'merge.legends'.

Oscar.

>
>> sessionInfo() # part of it
> R version 2.14.1 (2011-12-22)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> .
> .
> .
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_0.9-95         lattice_0.20-0
>
> loaded via a namespace (and not attached):
> [1] cluster_1.14.2 grid_2.14.1    Hmisc_3.9-2
>
>
> Thanks in advance,
>
> Mauricio Zambrano-Bigiarini

-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From m.shapiera22 at gmail.com  Wed Mar  7 23:08:41 2012
From: m.shapiera22 at gmail.com (Melanie Shapiera)
Date: Wed, 7 Mar 2012 18:38:41 -0330
Subject: [R-sig-Geo] problems in shortestPath()?
Message-ID: <CAK5WTcGpHaFATY3toqSqDrrVr2JBrWPo2O02h=btn-Xea-rGJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120307/4fb26d4e/attachment.pl>

From hzambran.newsgroups at gmail.com  Wed Mar  7 23:30:18 2012
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano-Bigiarini)
Date: Wed, 7 Mar 2012 23:30:18 +0100
Subject: [R-sig-Geo] spplot with legend only,
 and legend inside the plotting area
In-Reply-To: <87boo8jqvs.fsf@upm.es>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu> <87boo8jqvs.fsf@upm.es>
Message-ID: <CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>

2012/3/7 Oscar Perpi??n Lamigueiro <oscar.perpinan at upm.es>:
> Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu> writes:
>
>> On 07/03/12 13:11, Oscar Perpi??n Lamigueiro wrote:
>>> Mauricio Zambrano-Bigiarini<mauricio.zambrano at jrc.ec.europa.eu> ?writes:
>>>
>> The real problem appears when I try to produce several spplots within
>> the same figure (each one of them for a different spatial area), with
>> a unique legend for all the figures (that is the reason why I can not
>> use 'legend' command).
>
> Then you could use c.trellis:
>
> With your example:
>
> c(dummy, dummy, dummy, dummy).
>
> Inside c() you can define the 'layout' and decide if you want to merge
> legends with 'merge.legends'.
>
> Oscar.

Thanks Oscar.

i followed the examples in c.trellis, but it doesn't work:

library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y

# only to get the default values from 'auto.key'
dummy <- spplot(xyz, cex=10, alpha=0.7)

# checking that 'dummy' is a trellis
class(dummy)

library(lattice)
cObj <- c(dummy, dummy)
update(cObj)

Error en eval(expr, envir, enclos) :
  '...' usado en un contexto incorrecto # EN: '...' used in an invalid context

Also, in the documentation of c.trellis, it is mentioned that "Many
properties of the display, such as titles, axis settings and aspect
ratio will be taken from the first object only.", so if the spatial
extent of the figures are different, 'c.trellis' shouldn't do the
work, right ?

Thanks again,

Mauricio

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo ? ?: http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"There is only one pretty child in the world, and every mother has it."
(Chinese Proverb)
=======================================================
http://c2.com/cgi/wiki?HowToAskQuestionsTheSmartWay


From cebulmer at telus.net  Thu Mar  8 02:20:22 2012
From: cebulmer at telus.net (Chuck Bulmer)
Date: Wed, 7 Mar 2012 17:20:22 -0800 (PST)
Subject: [R-sig-Geo] rsaga multi.local.function
In-Reply-To: <000301ccf4a8$a5abbb00$f1033100$@telus.net>
References: <000301ccf4a8$a5abbb00$f1033100$@telus.net>
Message-ID: <1331169622792-7353658.post@n2.nabble.com>

Resolved...

The following work around accomplishes what I'm trying to do.

library(raster)
t<-stack("ELEV.asc", "AACN.asc", "CNBL.asc")
predict(t, PGMRF, filename = "predicted_output.asc", fun = predict, se.fit =
TRUE)

The coded material types (C, F, G, L, M) appear as numbers (1,2,3,4,5) in
the "predicted_output.asc" raster.

All is well !

Chuck



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rsaga-multi-local-function-tp7319490p7353658.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From oscar.perpinan at upm.es  Thu Mar  8 09:21:32 2012
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Thu, 8 Mar 2012 09:21:32 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu> <87boo8jqvs.fsf@upm.es>
	<CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>
Message-ID: <CAMLL7bm63cpx9X_z7mhtBLYvRB8xSauMwbM8ofA-t15Sx_dSTQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/40ee5911/attachment.pl>

From spareeth at gmail.com  Thu Mar  8 11:46:41 2012
From: spareeth at gmail.com (sajid pareeth)
Date: Thu, 8 Mar 2012 16:16:41 +0530
Subject: [R-sig-Geo] counting the depressions(group of negative numbers)
 over time from a raster brick
Message-ID: <CAO7vHBFEhTic=GsaMas=YedbxLO=yXY=P6d7+XjW+9M0ZvAX8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/45bdf3f6/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Thu Mar  8 12:10:57 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 08 Mar 2012 12:10:57 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <CAMLL7bm63cpx9X_z7mhtBLYvRB8xSauMwbM8ofA-t15Sx_dSTQ@mail.gmail.com>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu> <87boo8jqvs.fsf@upm.es>
	<CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>
	<CAMLL7bm63cpx9X_z7mhtBLYvRB8xSauMwbM8ofA-t15Sx_dSTQ@mail.gmail.com>
Message-ID: <4F5893C1.30204@jrc.ec.europa.eu>

On 08/03/12 09:21, Oscar Perpi?an wrote:
> Sorry: I forgot to say that you need latticeExtrato use c.trellis.Then:
> library(latticeExtra)
> c(dummy, dummy, dummy, dummy).
>
Thanks Oscar !. I didn't realise about 'latticeExtra' instead of lattice...

One last question. By using c(), is it possible to put different axis 
labels for each plot ?

-------------- START ----------------
library(sp)
xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
coordinates(xyz)=~x+y

# Different spatial extent for the 2nd dummy set
xyz2 = data.frame(expand.grid(x=100:200,y=100:200),rnorm(10201))
coordinates(xyz2)=~x+y

# only to get the default values from 'auto.key'
dummy <- spplot(xyz, cex=2, alpha=0.7, xlab="X1", ylab="Y1", 
scales=list(draw=TRUE))
dummy2 <- spplot(xyz2, cex=2, alpha=0.7, xlab="X2", ylab="Y2")

# checking that 'dummy' is a trellis
class(dummy)

library(lattice)
library(latticeExtra)
cObj <- c(dummy, dummy2, dummy, dummy2, layout=c(2,4), merge.legends=FALSE)
update(cObj)

-------------- END ----------------

in the previous figure, xlab and ylab are set the same for all the 
plots, even if for two of them they are different ...

Thanks in advance,

Mauricio

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)


From JRadinger at gmx.at  Thu Mar  8 12:13:37 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Thu, 08 Mar 2012 12:13:37 +0100
Subject: [R-sig-Geo] Dismo Maxent - Error with evaluate(),
	missing layers (or wrong names)
Message-ID: <20120308111337.79400@gmx.net>

Hi,

I am running multiple Maxent models for a list of 40 species in a loop.
Within the loop I am splitting the presence points into a train dataset
and a test dataset. All the model fitting and the prediction works fine,
there is just a problem with some species and evaluate().
What I am doing and the error:

#witholding a 20%(1/5) sample for testing 
> fold <- kfold(subset.occ, k=5)
> occtest <- subset.occ[fold == 1, ]
> occtrain <- subset.occ[fold != 1, ]

> occtest
            coordinates              species
4025 (3525400, 6055500) N.Gesamt.Meerforelle
> occtrain
            coordinates              species
4021 (3527250, 6060480) N.Gesamt.Meerforelle
4023 (3526100, 6058550) N.Gesamt.Meerforelle
4056 (3522320, 6048620) N.Gesamt.Meerforelle
4066 (3526840, 6060240) N.Gesamt.Meerforelle
4090 (3527920, 6063450) N.Gesamt.Meerforelle

> evaluate(me, p=occtest, a=bg, x=predictors)
Fehler in .local(object, ...) : missing layers (or wrong names)


I guess that is related to the number of occtest-samples. As there
is only one sample I might get this error. I just wanted
to get a proof if I am right with this guess, as the error message
is difficult to interpret to me.

thank you!

cheers,
/johannes



-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From valdounet at gmail.com  Thu Mar  8 14:08:58 2012
From: valdounet at gmail.com (Vlad)
Date: Thu, 08 Mar 2012 14:08:58 +0100
Subject: [R-sig-Geo] counting the depressions(group of negative numbers)
 over time from a raster brick
In-Reply-To: <CAO7vHBFEhTic=GsaMas=YedbxLO=yXY=P6d7+XjW+9M0ZvAX8g@mail.gmail.com>
References: <CAO7vHBFEhTic=GsaMas=YedbxLO=yXY=P6d7+XjW+9M0ZvAX8g@mail.gmail.com>
Message-ID: <4F58AF6A.7030804@gmail.com>

Hi Sajid,

you don't need to transform anything to a data.frame.
Instead you may use the function 'calc' with a function that calculate 
the two values you are looking for.
(see the help page on 'calc').
I think the following function will do what you expect to :

theFun <- function(x)
{
       start.grp <- which (x < 0 & c(TRUE, x[-length(x)]) >= 0)
       end.grp <- which (x < 0 & c(x[-1], TRUE) >= 0)
       nb.grps <- length(start.grp)
       if (nb.grps > 0) {
               grps <-  rep (NA, length(x))
               grps[x<0] <- unlist(mapply (rep, 1:nb.grps, 
end.grp-start.grp+1, SIMPLIFY=FALSE))
               sum.val <- sum (tapply(x[x<0], grps[x<0], min))
               return (c(nb.grps, sum.val))
       } else {
               return(c(0, 0))
       }

}

calc (cntneg, theFun)

Best,

Vlad

---
Vladislav Navel
SCAN
www.scan-datamining.com


Le 08/03/2012 11:46, sajid pareeth a ?crit :
> Dear all
>
> I am trying to count the number of group of depressions (negative
> values) from a climate data set and have least idea on how to go about it.
> Let me explain the scenario.
> I have a raster brick with 468 layers and and each layer has 7458 cells.
>
>
>> cntnegclass       : RasterBrick
> dimensions  : 66, 113, 7458, 468  (nrow, ncol, ncell, nlayers)
> resolution  : 0.108, 0.108  (x, y)
> extent      : 77.946, 90.15, 24.946, 32.074  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> values      : in memory
> min values  : -359.51 -341.21 -315.45 -148.10 -187.39  -52.87  -66.72
> -52.17 -286.81 -306.74 ...
> max values  :  -7.589   0.000   0.000   0.000   0.000   0.000   0.000
>   0.000   0.000   0.000 ...
>
>
>
> Now for example lets take the 5000th pixel
>
>> cntneg[5000]
> Which will give me 468 values of that pixel over time.
>
>
> [1]  -90.795107  -89.990016  -94.840754    0.000000  -15.085517    0.000000
>    [7]    0.000000    0.000000    0.000000  -12.469657 -114.757702 -115.372023
>   [13] -107.194478  -92.916680 -115.105817 -113.205776 -115.003430  -62.175070
>   [19]    0.000000    0.000000    0.000000  -72.358073 -105.006508 -115.372023
>   [25]  -48.836959 -102.314928 -113.271826 -115.372023  -79.530055    0.000000
>   [31]    0.000000    0.000000    0.000000  -15.048987 -115.208204 -115.372023
>   [37] -115.003430 -108.757617 -113.122594 -115.372023 -111.699048  -17.618498
>   [43]    0.000000    0.000000
>
>
> Now here I need to do two tasks
>
> 1) count number of times the rainfall went below the average - those with
> negative values. And zeros are with positive RF values (which i converted
> to zero using reclass) for the ease of calculation.
> In the above example I want to pick the group of negative numbers and
> count. ie,  (-90.795107  -89.990016  -94.840754), (-15.085517), (
> -12.469657 -114.757702 -115.372023,  -107.194478  -92.916680 -115.105817
> -113.205776 -115.003430  -62.175070), (-72.358073 -105.006508 -115.372023,
> -48.836959 -102.314928 -113.271826 -115.372023  -79.530055)  etc. The
> resulted layer pixel value should be the count of these groups, which in
> this case is 5. Like wise need to do for all the pixels along time
> dimension.
>
> 2) For each group I want to pick the minimum values and resulted pixel will
> have the sum of those minimum values. If a group has one value, keep the
> same.
>
> I am stuck to start with this process. I am assuming I need to convert the
> brick into dataframe and do this.
>
> Can any one help me in giving a lead on how to go about it?
>
> Really appreciate any help.
>
>
> Sorry if the explanation is confusing.
>
> Regards
>
> Sajid
>
>
>
>
>
>


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Thu Mar  8 14:15:51 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Thu, 8 Mar 2012 08:15:51 -0500
Subject: [R-sig-Geo] problems in shortestPath()?
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B90186A462065E@HARFANG.intranet.mrn.gouv>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/591fa41a/attachment.pl>

From momadou at yahoo.fr  Thu Mar  8 15:48:22 2012
From: momadou at yahoo.fr (Komine)
Date: Thu, 8 Mar 2012 06:48:22 -0800 (PST)
Subject: [R-sig-Geo] redundancy of coordinates of pixels
In-Reply-To: <1329164396533-7281771.post@n2.nabble.com>
References: <1326140234659-7169408.post@n2.nabble.com>
	<1329164396533-7281771.post@n2.nabble.com>
Message-ID: <1331218102309-7355090.post@n2.nabble.com>

Hi everybody, 
I try to use the advice from Roger Bivand to get the redundant coordinates 
of my pixels.
In the r help I found this example code:

>nn2(data, query, k=min(10,nrow(data)),treetype=c("kd","bd"),
>searchtype=c("standard","priority","radius"),radius=0.0,eps=0.0)

I tried to adapt it according my aim:

>redon<-read.table("C:\\Users\\Documents\\RepPixel.txt",sep="",dec=",",header=TRUE)
>nn2(redon,query,k=min(10,nrow(redon)),treetype=c("kd","bd"),
>searchtype=c("priority"),eps<0.0)

The result is not good. 
Can you help me solve this problem
Thank you in advance 
KOMINE

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/redundancy-of-coordinates-of-pixels-tp7169408p7355090.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Thu Mar  8 15:59:25 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Thu, 08 Mar 2012 15:59:25 +0100
Subject: [R-sig-Geo] redundancy of coordinates of pixels
In-Reply-To: <1331218102309-7355090.post@n2.nabble.com>
References: <1326140234659-7169408.post@n2.nabble.com>	<1329164396533-7281771.post@n2.nabble.com>
	<1331218102309-7355090.post@n2.nabble.com>
Message-ID: <4F58C94D.4020608@tum.de>

Am 08.03.2012 15:48, schrieb Komine:
> Hi everybody,
> I try to use the advice from Roger Bivand to get the redundant coordinates
> of my pixels.
> In the r help I found this example code:
>
>> nn2(data, query, k=min(10,nrow(data)),treetype=c("kd","bd"),
>> searchtype=c("standard","priority","radius"),radius=0.0,eps=0.0)
>
> I tried to adapt it according my aim:
>
>> redon<-read.table("C:\\Users\\Documents\\RepPixel.txt",sep="",dec=",",header=TRUE)
>> nn2(redon,query,k=min(10,nrow(redon)),treetype=c("kd","bd"),
>> searchtype=c("priority"),eps<0.0)
>
> The result is not good.
> Can you help me solve this problem

Which problem? Maybe you can help us help you by first reading the 
posting guide: http://www.r-project.org/posting-guide.html

HTH
Tom

> Thank you in advance
> KOMINE
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/redundancy-of-coordinates-of-pixels-tp7169408p7355090.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From momadou at yahoo.fr  Thu Mar  8 16:28:18 2012
From: momadou at yahoo.fr (Komine)
Date: Thu, 8 Mar 2012 07:28:18 -0800 (PST)
Subject: [R-sig-Geo] redundancy of coordinates of pixels
In-Reply-To: <4F58C94D.4020608@tum.de>
References: <1326140234659-7169408.post@n2.nabble.com>
	<1329164396533-7281771.post@n2.nabble.com>
	<1331218102309-7355090.post@n2.nabble.com>
	<4F58C94D.4020608@tum.de>
Message-ID: <1331220498719-7355260.post@n2.nabble.com>

Thank Tom for your observation.You are right, my question was not clear.
When I run my code. I have this error message that I translated from french
to english: 
>Error in nrow (query): object'query' not found

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/redundancy-of-coordinates-of-pixels-tp7169408p7355260.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mauricio.zambrano at jrc.ec.europa.eu  Thu Mar  8 17:59:49 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 08 Mar 2012 17:59:49 +0100
Subject: [R-sig-Geo] spplot with legend only,
 and legend inside the plotting area
In-Reply-To: <4F578F22.3010306@jrc.ec.europa.eu>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu>
Message-ID: <4F58E585.7010306@jrc.ec.europa.eu>

On 07/03/12 17:38, Mauricio Zambrano-Bigiarini wrote:
>
> I'm almost there...
>
> The real problem appears when I try to produce several spplots within
> the same figure (each one of them for a different spatial area), with a
> unique legend for all the figures (that is the reason why I can not use
> 'legend' command).
>
> For example, while trying to produce 4 different plots within the same
> figure:
>
> library(sp)
> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
> coordinates(xyz)=~x+y
>
> # only to get the default values from 'auto.key'
> dummy <- spplot(xyz, cex=10, alpha=0.7)
>
> # This has auto.key = "bottom" by default.
> cols = dummy$legend$bottom$args$key$points$col
> txt = dummy$legend$bottom$args$key$text[[1]]
>
> # number of elements in the legend
> n <- length(cols)
>
> p1 <- spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
> p2 <- p1
> p3 <- p1
>
> # only the legend
> p4 <- spplot(xyz, cex=0, auto.key=list(x=.5, y=.5, corner = c(0.5, 0.5),
> title="my legend") )
>
> print(p1, split = c(1, 1, 2, 2), more = TRUE)
> print(p2, split = c(2, 1, 2, 2), more = TRUE)
> print(p3, split = c(1, 2, 2, 2), more = TRUE)
> print(p4, split = c(2, 2, 2, 2), more = FALSE)
>
> --------
> The previous solution has two problems (for me) that I couldn't solve:
> 1) the colors for the symbols are not correct
> 2) The symbols are plotted at the right side of the legend, while I
> would like to have them on the left side

I just solved the two previous problems, and I share the solution now 
just in case it be useful for somebody else in the future:

library(sp)
mydata <- rnorm(100)
xyz = data.frame(expand.grid(x=1:10,y=1:10), mydata)
coordinates(xyz)=~x+y

# only to get the default values from 'auto.key'
dummy <- spplot(xyz, cex=10, alpha=0.7)

# This has auto.key = "bottom" by default.
cols = dummy$legend$bottom$args$key$points$col
txt = dummy$legend$bottom$args$key$text[[1]]

# number of elements in the legend
n <- length(cols)

p1 <- spplot(xyz, cex=10, alpha=0.7, auto.key=FALSE)
p2 <- p1
p3 <- p1

# legend levels
cuts <- unique( quantile( as.numeric(mydata), probs=c(0.25, 0.5, 0.75, 
1), na.rm=TRUE) )
gof.levels <- cut(mydata, cuts)

# only the legend, in an empty plot
library(lattice)
p4 <- xyplot(1~1, type="n", xlab="", ylab="",
        groups=gof.levels,
        scales=list(draw=FALSE),

        # automatic legend
        key = list(x = .5, y = .5, corner = c(0.5, 0.5),
                  title="legend",
                  points = list(pch=16, col=cols, cex=1.5),
                  text = list(as.character(txt))
                  ),
        # removing outter box.
        #From: 
https://stat.ethz.ch/pipermail/r-help/2007-September/140098.html
        par.settings = list(axis.line = list(col = "transparent")),
        axis = function(side, ...) {
            axis.default(side = side, ...)
        },
        )

# Creating the final figure
print(p1, split = c(1, 1, 2, 2), more = TRUE)
print(p2, split = c(2, 1, 2, 2), more = TRUE)
print(p3, split = c(1, 2, 2, 2), more = TRUE)
print(p4, split = c(2, 2, 2, 2), more = FALSE)



>
>
> I tried to solve the 2nd problem by using 'key' instead of 'auto.key':
>
> p4 <- spplot(xyz, cex=0,
> key = list(x = 0.5, y = 0.5, corner = c(0.5, 0.5),
> title="my legend", text = list(txt),
> points = list(pch = rep(16, length = n),
> col = cols,
> cex = rep(1.5, length = n)
> )
> )
> )
>
> print(p1, split = c(1, 1, 2, 2), more = TRUE)
> print(p2, split = c(2, 1, 2, 2), more = TRUE)
> print(p3, split = c(1, 2, 2, 2), more = TRUE)
> print(p4, split = c(2, 2, 2, 2), more = FALSE)
>
>
> and now the colors are correct, but the legend appears at the bottom of
> the plotting area, not in the centre as before.
>
>
> Does it mean that spplot ignores the x, y, and corner arguments in 'key' ?
>
>
>  > sessionInfo() # part of it
> R version 2.14.1 (2011-12-22)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> .
> .
> .
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
>
> other attached packages:
> [1] sp_0.9-95 lattice_0.20-0
>
> loaded via a namespace (and not attached):
> [1] cluster_1.14.2 grid_2.14.1 Hmisc_3.9-2
>
>
> Thanks in advance,
>
> Mauricio Zambrano-Bigiarini
>


-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), Italy
webinfo    : http://floods.jrc.ec.europa.eu/
work-phone : (+39)-(0332)-789588
work-fax   : (+39)-(0332)-786653
=======================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:11}}


From oscar.perpinan at upm.es  Thu Mar  8 18:22:58 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 08 Mar 2012 18:22:58 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <4F5893C1.30204@jrc.ec.europa.eu> (Mauricio Zambrano-Bigiarini's
	message of "Thu, 08 Mar 2012 12:10:57 +0100")
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu> <87boo8jqvs.fsf@upm.es>
	<CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>
	<CAMLL7bm63cpx9X_z7mhtBLYvRB8xSauMwbM8ofA-t15Sx_dSTQ@mail.gmail.com>
	<4F5893C1.30204@jrc.ec.europa.eu>
Message-ID: <87wr6v6m8d.fsf@upm.es>

Mauricio Zambrano-Bigiarini <mauricio.zambrano at jrc.ec.europa.eu> writes:

> Thanks Oscar !. I didn't realise about 'latticeExtra' instead of lattice...
>
> One last question. By using c(), is it possible to put different axis
> labels for each plot ?
> -------------- START ----------------
> library(sp)
> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
> coordinates(xyz)=~x+y
>
> # Different spatial extent for the 2nd dummy set
> xyz2 = data.frame(expand.grid(x=100:200,y=100:200),rnorm(10201))
> coordinates(xyz2)=~x+y
>
> # only to get the default values from 'auto.key'
> dummy <- spplot(xyz, cex=2, alpha=0.7, xlab="X1", ylab="Y1",
> scales=list(draw=TRUE))
> dummy2 <- spplot(xyz2, cex=2, alpha=0.7, xlab="X2", ylab="Y2")
>
> # checking that 'dummy' is a trellis
> class(dummy)
>
> library(lattice)
> library(latticeExtra)
> cObj <- c(dummy, dummy2, dummy, dummy2, layout=c(2,4), merge.legends=FALSE)
> update(cObj)
>
> -------------- END ----------------

Yes, it is possible. You have to modify the parameters with update:

cObj <- c(dummy, dummy2, dummy, dummy2)
update(cObj, xlab=c('X1', 'X2'), ylab.right='Y2')

Best,

Oscar.
-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From mauricio.zambrano at jrc.ec.europa.eu  Thu Mar  8 18:33:25 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 08 Mar 2012 18:33:25 +0100
Subject: [R-sig-Geo] spplot with legend only,
	and legend inside the plotting area
In-Reply-To: <87wr6v6m8d.fsf@upm.es>
References: <4F5647FF.7090708@jrc.ec.europa.eu> <87ty201ugm.fsf@upm.es>
	<4F578F22.3010306@jrc.ec.europa.eu> <87boo8jqvs.fsf@upm.es>
	<CAHYf9PkigSHJmY35zfxSgsfGCfVOPj619aDURzy7W7BCMdFbpw@mail.gmail.com>
	<CAMLL7bm63cpx9X_z7mhtBLYvRB8xSauMwbM8ofA-t15Sx_dSTQ@mail.gmail.com>
	<4F5893C1.30204@jrc.ec.europa.eu> <87wr6v6m8d.fsf@upm.es>
Message-ID: <4F58ED65.2060500@jrc.ec.europa.eu>

On 08/03/12 18:22, Oscar Perpi??n Lamigueiro wrote:
> Mauricio Zambrano-Bigiarini<mauricio.zambrano at jrc.ec.europa.eu>  writes:
>
>> Thanks Oscar !. I didn't realise about 'latticeExtra' instead of lattice...
>>
>> One last question. By using c(), is it possible to put different axis
>> labels for each plot ?
>> -------------- START ----------------
>> library(sp)
>> xyz = data.frame(expand.grid(x=1:10,y=1:10),rnorm(100))
>> coordinates(xyz)=~x+y
>>
>> # Different spatial extent for the 2nd dummy set
>> xyz2 = data.frame(expand.grid(x=100:200,y=100:200),rnorm(10201))
>> coordinates(xyz2)=~x+y
>>
>> # only to get the default values from 'auto.key'
>> dummy<- spplot(xyz, cex=2, alpha=0.7, xlab="X1", ylab="Y1",
>> scales=list(draw=TRUE))
>> dummy2<- spplot(xyz2, cex=2, alpha=0.7, xlab="X2", ylab="Y2")
>>
>> # checking that 'dummy' is a trellis
>> class(dummy)
>>
>> library(lattice)
>> library(latticeExtra)
>> cObj<- c(dummy, dummy2, dummy, dummy2, layout=c(2,4), merge.legends=FALSE)
>> update(cObj)
>>
>> -------------- END ----------------
>
> Yes, it is possible. You have to modify the parameters with update:
>
> cObj<- c(dummy, dummy2, dummy, dummy2)
> update(cObj, xlab=c('X1', 'X2'), ylab.right='Y2')
>
> Best,

Thanks Oscar !.

Now I know two solutions for the initial problem :)

All the best,

Mauricio

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)


From burtonshank at gmail.com  Thu Mar  8 21:15:10 2012
From: burtonshank at gmail.com (Burton Shank)
Date: Thu, 8 Mar 2012 15:15:10 -0500
Subject: [R-sig-Geo] GWR: set initial bandwidth value for gwr.sel()
Message-ID: <CAE22u=pSCvR+EvCjsJuR1FxAEbz8BjYPH-2P4AG0LG6f5FWYdg@mail.gmail.com>

Is there a way to set the initial bandwidth for gwr.sel() when doing
geographically weighted regression?

It looks like gwr.sel() calls optimize() which accepts a min/max range
for parameters but not an initial value. I'd rather not constrain the
bandwidth. However, I often send different subsets of the same dataset
to gwr.sel and would like to speed up the optimization process by
passing a value from the last call to the function.

Solutions?

thanks,

Burton Shank


From Roger.Bivand at nhh.no  Thu Mar  8 21:23:56 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Mar 2012 21:23:56 +0100 (CET)
Subject: [R-sig-Geo] GWR: set initial bandwidth value for gwr.sel()
In-Reply-To: <CAE22u=pSCvR+EvCjsJuR1FxAEbz8BjYPH-2P4AG0LG6f5FWYdg@mail.gmail.com>
References: <CAE22u=pSCvR+EvCjsJuR1FxAEbz8BjYPH-2P4AG0LG6f5FWYdg@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203082122340.9646@reclus.nhh.no>

On Thu, 8 Mar 2012, Burton Shank wrote:

> Is there a way to set the initial bandwidth for gwr.sel() when doing
> geographically weighted regression?
>
> It looks like gwr.sel() calls optimize() which accepts a min/max range
> for parameters but not an initial value. I'd rather not constrain the
> bandwidth. However, I often send different subsets of the same dataset
> to gwr.sel and would like to speed up the optimization process by
> passing a value from the last call to the function.
>
> Solutions?

Just set the bandwidth manually. gwr.sel() does use optimize(), which does 
not take a start value (optim() does, but does not work well for line 
search).

Hope this clarifies,

Roger

>
> thanks,
>
> Burton Shank
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mspinola10 at gmail.com  Fri Mar  9 00:06:56 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 8 Mar 2012 17:06:56 -0600
Subject: [R-sig-Geo] Error in function gbif package dismo
Message-ID: <CABkCotS4kJFhDkxvd5rjY=nddbBUAVz-pttcnLYgdf2Hz7Yk3Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/1e0e5247/attachment.pl>

From sharonb_m at yahoo.com  Fri Mar  9 01:14:49 2012
From: sharonb_m at yahoo.com (Sharon Baruch-Mordo)
Date: Thu, 8 Mar 2012 16:14:49 -0800 (PST)
Subject: [R-sig-Geo] Sum value of points that intersect a subset of a network
Message-ID: <1331252089.18322.YahooMailNeo@web43140.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/ba3714c7/attachment.pl>

From r.hijmans at gmail.com  Fri Mar  9 07:27:27 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 8 Mar 2012 22:27:27 -0800
Subject: [R-sig-Geo] Error in function gbif package dismo
In-Reply-To: <CABkCotS4kJFhDkxvd5rjY=nddbBUAVz-pttcnLYgdf2Hz7Yk3Q@mail.gmail.com>
References: <CABkCotS4kJFhDkxvd5rjY=nddbBUAVz-pttcnLYgdf2Hz7Yk3Q@mail.gmail.com>
Message-ID: <CANtt_hxpmOiiQbtc3=g2c_Lw_sqC_ZL6aU9q0kQL3c32BxXstA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/35adf997/attachment.pl>

From r.hijmans at gmail.com  Fri Mar  9 07:55:34 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 8 Mar 2012 22:55:34 -0800
Subject: [R-sig-Geo] writeRaster and coord ref problem
In-Reply-To: <20120307102914.157650@gmx.net>
References: <20120306143625.217200@gmx.net>
	<CANtt_hwdGtgQOgeD0d8BEXCwu9H4vqmK91g+VNHxc-JOp8fjxg@mail.gmail.com>
	<20120307102914.157650@gmx.net>
Message-ID: <CANtt_hxJ_kpSg2rLurzCgkGck1h5BKO9qYyQP2_9gPGRREpAVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120308/22c1a014/attachment.pl>

From JRadinger at gmx.at  Fri Mar  9 11:48:25 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Fri, 09 Mar 2012 11:48:25 +0100
Subject: [R-sig-Geo] writeRaster and coord ref problem
In-Reply-To: <CANtt_hxJ_kpSg2rLurzCgkGck1h5BKO9qYyQP2_9gPGRREpAVQ@mail.gmail.com>
References: <20120306143625.217200@gmx.net>
	<CANtt_hwdGtgQOgeD0d8BEXCwu9H4vqmK91g+VNHxc-JOp8fjxg@mail.gmail.com>
	<20120307102914.157650@gmx.net>
	<CANtt_hxJ_kpSg2rLurzCgkGck1h5BKO9qYyQP2_9gPGRREpAVQ@mail.gmail.com>
Message-ID: <20120309104825.310390@gmx.net>

Hi Robert,

thank you for helping me sourcing the problem.
Here what I get (there is not problem with CRS(crs)):

from a totally fresh session:

> library(rgdal)
Lade n"otiges Paket: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
Path to GDAL shared files: /Users/Johannes Radinger/Library/R/2.14/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: /Users/Johannes Radinger/Library/R/2.14/library/rgdal/proj
> crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0" 
> CRS(crs)
CRS arguments:
 +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +datum=potsdam
+units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0
> sessionInfo()
R version 2.14.2 (2012-02-29)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.7-8 sp_0.9-95   rj_1.0.0-3 

loaded via a namespace (and not attached):
[1] grid_2.14.2    lattice_0.20-0 rj.gd_1.0.0-1  tools_2.14.2

My rgdal package for Mac OSX was installed as mentioned on the CRAN-website (http://cran.r-project.org/web/packages/rgdal/index.html)



anything else I can/should test...?

/johannes

PS: @Roger: I set you CC as you are the maintainer of the rgdal-package and might be interested in that Problem.



-------- Original-Nachricht --------
> Datum: Thu, 8 Mar 2012 22:55:34 -0800
> Von: "Robert J. Hijmans" <r.hijmans at gmail.com>
> An: Johannes Radinger <JRadinger at gmx.at>
> CC: r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] writeRaster and coord ref problem

> Johannes,
> 
> Yes, that smells like something is wrong with your GDAL/PROJ4. Can you try
> this:
> 
> library(rgdal)
> 
> crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> +datum=potsdam +units=m +no_defs +ellps=bessel +towgs84=606.0,23.0,413.0"
> 
> CRS(crs)
> 
> For me, it returns:
> CRS arguments:
>  +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +datum=potsdam
> +units=m +no_defs
> +ellps=bessel +towgs84=606.0,23.0,413.0
> 
> Robert
> 
> On Wed, Mar 7, 2012 at 2:29 AM, Johannes Radinger <JRadinger at gmx.at>
> wrote:
> 
> > Hi again,
> >
> > I also tried your example and I can reproduce the problem in contrast to
> > you. After opening a fresh session, here is what I get:
> >
> > > library(raster)
> > Lade n"otiges Paket: sp
> > raster version 1.9-70 (27-February-2012)
> > > crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > +datum=potsdam +units=m +no_defs +ellps=bessel
> +towgs84=606.0,23.0,413.0"
> > > r <- raster(nc=10, nr=10, crs=crs)
> > > r[] <- 1:ncell(r)
> > > b <- brick(r,r,r)
> > > x <- writeRaster(b, 'datum.tif', overwrite=TRUE)
> > Geospatial Data Abstraction Library extensions to R successfully loaded
> > Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
> > Path to GDAL shared files: /Users/Johannes
> > Radinger/Library/R/2.14/library/rgdal/gdal
> > Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> > Path to PROJ.4 shared files: /Users/Johannes
> > Radinger/Library/R/2.14/library/rgdal/proj
> > > x
> > class       : RasterBrick
> > dimensions  : 10, 10, 100, 3  (nrow, ncol, ncell, nlayers)
> > resolution  : 36, 18  (x, y)
> > extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > +ellps=bessel +towgs84=606,23,413,0,0,0,0 +units=m +no_defs
> > values      : /Users/Johannes
> > Radinger/Documents/Eclipse_workspace/datum.tif
> > min values  : 1 1 1
> > max values  : 100 100 100
> >
> > > sessionInfo()
> > R version 2.14.2 (2012-02-29)
> > Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
> >
> > locale:
> > [1] C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] rgdal_0.7-8   raster_1.9-70 sp_0.9-95     rj_1.0.0-3
> >
> > loaded via a namespace (and not attached):
> > [1] grid_2.14.2    lattice_0.20-0 rj.gd_1.0.0-1  tools_2.14.2
> >
> >
> >
> > What might cause the problem? Is there any bug I should report? Maybe
> the
> > problem is platform specific (I use a Mac) or has something to do with
> my
> > version of GDAL/PROJ4?
> > Any suggestions?
> >
> > In the meanwhile I'll try your approach with resetting the CRS:
> > projection(x) <- crs
> >
> > /Johannes
> >
> >
> >
> > -------- Original-Nachricht --------
> > > Datum: Tue, 6 Mar 2012 09:20:09 -0800
> > > Von: "Robert J. Hijmans" <r.hijmans at gmail.com>
> > > An: Johannes Radinger <JRadinger at gmx.at>
> > > CC: r-sig-geo at r-project.org
> > > Betreff: Re: [R-sig-Geo] writeRaster and coord ref problem
> >
> > > Johannes, it works for me:
> > >
> > > library(raster)
> > > crs <- "+proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > > +datum=potsdam +units=m +no_defs +ellps=bessel
> +towgs84=606.0,23.0,413.0"
> > > r <- raster(nc=10, nr=10, crs=crs)
> > > r[] <- 1:ncell(r)
> > > b <- brick(r,r,r)
> > > x <- writeRaster(b, 'datum.tif', overwrite=TRUE)
> > >
> > > > x
> > > class       : RasterBrick
> > > dimensions  : 10, 10, 100, 3  (nrow, ncol, ncell, nlayers)
> > > resolution  : 36, 18  (x, y)
> > > extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
> > > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > > +datum=potsdam +units=m +no_defs +ellps=bessel
> +towgs84=606.0,23.0,413.0
> > > values      : datum.tif
> > > min values  : 1 1 1
> > > max values  : 100 100 100
> > >
> > >
> > > If for some reason part of the proj.4 description is lost, you can set
> it
> > > again with something like
> > >
> > > projection(x) <- crs
> > >
> > > > sessionInfo()
> > > R version 2.14.1 (2011-12-22)
> > > Platform: x86_64-pc-mingw32/x64 (64-bit)
> > >
> > > locale:
> > > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> > > States.1252    LC_MONETARY=English_United States.1252
> > > [4] LC_NUMERIC=C                           LC_TIME=English_United
> > > States.1252
> > >
> > > attached base packages:
> > > [1] stats     graphics  grDevices utils     datasets  methods   base
> > >
> > > other attached packages:
> > > [1] rgdal_0.7-5   raster_1.9-71 sp_0.9-93
> > >
> > > loaded via a namespace (and not attached):
> > > [1] grid_2.14.1    lattice_0.20-0
> > >
> > >
> > > Best, Robert
> > >
> > > On Tue, Mar 6, 2012 at 6:36 AM, Johannes Radinger <JRadinger at gmx.at>
> > > wrote:
> > >
> > > > Hi,
> > > >
> > > > I need to load some data from the Worldclim Database and reproject
> them
> > > > to some other, already existing rasters. Because I don't want to use
> > the
> > > > reprojected rasters from the memory I want to save the brick as a
> > > GeoTiff
> > > > (like the other rasters) using writeRaster. But somehow
> writeRaster()
> > > > changes the coord. ref. line and drops "+datum=Potsdam". Here what I
> am
> > > > doing:
> > > >
> > > > > WC.bio <- projectRaster(getData("worldclim", var="bio", res=0.5,
> > > > lon=9.3, lat=54.5),second.map)
> > > > > WC.bio
> > > > class       : RasterBrick
> > > > dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
> > > > resolution  : 50, 50  (x, y)
> > > > extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin,
> > > ymax)
> > > > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > > > +datum=potsdam +units=m +no_defs +ellps=bessel
> > +towgs84=606.0,23.0,413.0
> > > > values      : in memory
> > > > min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0  
> 52.1
> > > > 28.0  151.0 ...
> > > > max values  :   85   68   29 5964  210  -16  229  156   35  161 ...
> > > >
> > > > > writeRaster(WC.bio, "/path/to/file.tif", format="GTiff", overwrite
> =
> > > > TRUE)
> > > > class       : RasterBrick
> > > > dimensions  : 912, 840, 766080, 19  (nrow, ncol, ncell, nlayers)
> > > > resolution  : 50, 50  (x, y)
> > > > extent      : 3505300, 3547300, 6025800, 6071400  (xmin, xmax, ymin,
> > > ymax)
> > > > coord. ref. : +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0
> > > > +ellps=bessel +towgs84=606,23,413,0,0,0,0 +units=m +no_defs
> > > > values      : /Users/Johannes
> > > > Radinger/Documents/IGB/IMPACT_Data/Treene/SDM/Predictors/WC.bio.tif
> > > > min values  :   78.0   58.0   26.0 5675.8  194.0  -24.0  214.0  
> 52.1
> > > > 28.0  151.0 ...
> > > > max values  :   85   68   29 5964  210  -16  229  156   35  161 ...
> > > >
> > > >
> > > > This is a problem to my as I want to combine the other maps with the
> > > > reprojected Worldclim maps into a new stack from the files. But
> these
> > > files
> > > > have different projections....
> > > >
> > > > Best regards,
> > > > Johannes
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> >
> > --
> > NEU: FreePhone 3-fach-Flat mit kostenlosem Smartphone!
> > Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
> >

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From macqueen1 at llnl.gov  Fri Mar  9 16:27:34 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 9 Mar 2012 07:27:34 -0800
Subject: [R-sig-Geo] subset() for spatialPointsDataFrame
In-Reply-To: <20120306150928.20350@gmx.net>
Message-ID: <CB7F60F6.8DF6F%macqueen1@llnl.gov>

Try

  points.df[points.df$value > 0, c('column1','column')]

(or possibly using   points.df at data$value instead of points.df$value

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 3/6/12 7:09 AM, "Johannes Radinger" <JRadinger at gmx.at> wrote:

>Hi,
>
>I just wanted to know how I have to use the
>subset() command for a SpatialPointsDataFrame correctly.
>
>I'd like to get all records of the SpatialPointsDataFrame where the
>column "value" is > 0. Furthermore I want to select only two columns of
>that dataframe with these records. The subset command would be:
>
>subset(points.df, value > 0 , select = c(column1, column2))
>
>When I do that I get following error:
>
>Error in subset.SpatialPointsDataFrame(points.df, value > 0, select =
>c(column1,  : 
>  Object 'value' not found
>
>I also tried:
>subset(points.df, points.df["value"] > 0 , select = c(column1, column2))
>
>Error in points.df["value"] > 0 :
>  Vergleich (6) ist nur f"ur atomare und Listentypen m"oglich (sorry is
>in German)...
>
>Best regards,
>Johannes
>
>-- 
>
>Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mspinola10 at gmail.com  Fri Mar  9 16:59:16 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 9 Mar 2012 09:59:16 -0600
Subject: [R-sig-Geo] Error in function gbif package dismo
In-Reply-To: <CANtt_hxpmOiiQbtc3=g2c_Lw_sqC_ZL6aU9q0kQL3c32BxXstA@mail.gmail.com>
References: <CABkCotS4kJFhDkxvd5rjY=nddbBUAVz-pttcnLYgdf2Hz7Yk3Q@mail.gmail.com>
	<CANtt_hxpmOiiQbtc3=g2c_Lw_sqC_ZL6aU9q0kQL3c32BxXstA@mail.gmail.com>
Message-ID: <CABkCotSEREN-QJOjEjMCfBsOnwZ0AR=MgXwGn5Ta02iVq=WyRw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120309/14fe41de/attachment.pl>

From hengl at spatial-analyst.net  Fri Mar  9 17:16:13 2012
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 09 Mar 2012 17:16:13 +0100
Subject: [R-sig-Geo] GEOSTAT 2012 Summer School 3-8 September, IfGI,
	University of Muenster
Message-ID: <4F5A2CCD.4000602@spatial-analyst.net>


This is the first call for the GEOSTAT 2012 Summer School for PhD 
students and R-sig-geo enthusiasts that will be held this year at the 
Institute for Geoinformatics of the University of Muenster, Germany in 
the period from 3-8(11) September. The topics include:

Roger Bivand: Spatial and spacetime classes in R
Gerard Heuvelink: Spatial aggregation and disaggregation methods
Edzer Pebesma: R as a GIS: overlay/aggregate, rgeos, osmar, networks
Markus Neteler and Markus Metz: GRASS GIS tutorial
Soeren Gebbert: TGRASS (time-GRASS) tutorial
Volker Wichman: SAGA GIS tutorial
Tomislav Hengl: plotKML tutorial
Benedikt Gr?ler: Spatio-temporal geostatistics

The registrations are now Open:

http://www.geostat-course.org/Muenster_2012

Important dates:
- Registration deadline: 15th of April
- Published rankings: 1th of May
- Deadline for paying the registration fees: 1th of June (no extensions 
possible)
- Final program of the summer school: 1th of July

This summer school is limited to 45 participants.

for all other issues, please feel free to contact us:

-----------------
T. (Tom) Hengl [http://www.vcard.wur.nl/Views/Profile/View.aspx?id=37263]
B. (Ben) Gr?ler [http://ifgi.uni-muenster.de/staff/benedikt-graeler]
E. (Edzer) Pebesma [http://ifgi.uni-muenster.de/staff/edzer-pebesma]


From lee.hachadoorian at gmail.com  Fri Mar  9 20:44:50 2012
From: lee.hachadoorian at gmail.com (Lee Hachadoorian)
Date: Fri, 9 Mar 2012 14:44:50 -0500
Subject: [R-sig-Geo] subset() for SpatialPOLYGONSDataFrame
Message-ID: <CANnCtnKndj1iFNV-YCuFY5aG=v+JVawrn4chcBC3DHYFHMfXsw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120309/637b4995/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Mar  9 21:02:21 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 09 Mar 2012 21:02:21 +0100
Subject: [R-sig-Geo] subset() for SpatialPOLYGONSDataFrame
In-Reply-To: <CANnCtnKndj1iFNV-YCuFY5aG=v+JVawrn4chcBC3DHYFHMfXsw@mail.gmail.com>
References: <CANnCtnKndj1iFNV-YCuFY5aG=v+JVawrn4chcBC3DHYFHMfXsw@mail.gmail.com>
Message-ID: <4F5A61CD.3010102@uni-muenster.de>

Lee,

sp does not provide a subset method for SpatialPolygonsDataFrame objects:

> library(sp)
> methods(subset)
[1] subset.data.frame              subset.default
[3] subset.matrix                  subset.SpatialPixels*
[5] subset.SpatialPixelsDataFrame* subset.SpatialPoints*
[7] subset.SpatialPointsDataFrame*

   Non-visible functions are asterisked

this means that when you do call it, subset.default will be called as
the fall-back:

> subset.default
function (x, subset, ...)
{
    if (!is.logical(subset))
        stop("'subset' must be logical")
    x[subset & !is.na(subset)]
}

as you can see, this will lead to the expression:

somePolygons[somePolygons$someColumn == subsetCriteria]

which didn't give an error but leads to column selection rather than row
selection.

To be short: the subset method you want is not there in sp.


On 03/09/2012 08:44 PM, Lee Hachadoorian wrote:
> Following thread re: subsetting a SpatialPointsDataFrame. Poking around and
> found some unexpected behavior with a SpatialPolygonsDataFrame. The subset
> argument appears to be interpreted as select. That is:
> 
> subsetPolygons = subset(somePolygons, somePolygons$someColumn ==
> subsetCriteria)
> 
> returns all rows (all polygons), but the dataframe in the data slot only
> has columns selected by the logical vector spdfThis$someColumn ==
> "something". This of course is the behavior expected if I specified the
> select argument instead of the subset argument. I tried this explicitly
> naming the subset argument (subset = ...), rather than implicitly, and
> observed the same behavior.
> 
> Doing the same thing with a SpatialPointsDataFrame appears to work as
> expected.
> 
> Not uploading my data, but the actual code I ran, so you can scan it for
> stupid errors is:
> 
> #Using SpatialPolygonsDataFrame
> #Produces map of New York City with only Manhattan
> plot(spdfBoro[spdfBoro$boro_code == 1,])
> 
> #Produces map of New York City with five boros, every fifth column appears
> in data frame
> plot(subset(spdfBoro, spdfBoro$boro_code == 1))
> 
> #Using SpatialPointsDataFrame
> #Produces map of point locations in New York City, only those points in
> Manhattan
> plot(sndfWf1[sndfWf1$borough == "New York",])
> 
> #Produces map of point locations in New York City, only those points in
> Manhattan
> plot(subset(sndfWf1, sndfWf1$borough == "New York"))
> 
> Am I doing something wrong?
> 
> Regards,
> --Lee
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Lee.Hachadoorian+L at gmail.com  Fri Mar  9 21:31:26 2012
From: Lee.Hachadoorian+L at gmail.com (Lee Hachadoorian)
Date: Fri, 9 Mar 2012 15:31:26 -0500
Subject: [R-sig-Geo] subset() for SpatialPOLYGONSDataFrame
In-Reply-To: <4F5A61CD.3010102@uni-muenster.de>
References: <CANnCtnKndj1iFNV-YCuFY5aG=v+JVawrn4chcBC3DHYFHMfXsw@mail.gmail.com>
	<4F5A61CD.3010102@uni-muenster.de>
Message-ID: <CANnCtnJvqCh9g-ZXFy5vUxu=LZ4PBWBrpaYbVbrCJgYWxtEauA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120309/e7175491/attachment.pl>

From mspinola10 at gmail.com  Fri Mar  9 23:48:48 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 9 Mar 2012 16:48:48 -0600
Subject: [R-sig-Geo] Error in function buffer in package raster
Message-ID: <CABkCotQkwC2LKEWBtAhn2QHsTOwFvbVqgpznufzJVvSKn5Z=Ow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120309/a46d4938/attachment.pl>

From r.hijmans at gmail.com  Sat Mar 10 00:15:25 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 9 Mar 2012 15:15:25 -0800
Subject: [R-sig-Geo] Error in function buffer in package raster
In-Reply-To: <CABkCotQkwC2LKEWBtAhn2QHsTOwFvbVqgpznufzJVvSKn5Z=Ow@mail.gmail.com>
References: <CABkCotQkwC2LKEWBtAhn2QHsTOwFvbVqgpznufzJVvSKn5Z=Ow@mail.gmail.com>
Message-ID: <CANtt_hwUS8nSN9Eqbjzxy7zvhrZxDJXCzaA=sGkeVBsPt9GghA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120309/8fb8df3c/attachment.pl>

From mspinola10 at gmail.com  Sat Mar 10 14:48:35 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 10 Mar 2012 07:48:35 -0600
Subject: [R-sig-Geo] Error in function buffer in package raster
In-Reply-To: <CANtt_hwUS8nSN9Eqbjzxy7zvhrZxDJXCzaA=sGkeVBsPt9GghA@mail.gmail.com>
References: <CABkCotQkwC2LKEWBtAhn2QHsTOwFvbVqgpznufzJVvSKn5Z=Ow@mail.gmail.com>
	<CANtt_hwUS8nSN9Eqbjzxy7zvhrZxDJXCzaA=sGkeVBsPt9GghA@mail.gmail.com>
Message-ID: <CABkCotRJ0bT15D8TdKOavAVAx5OiVuGK5S+gOBmTJN8U9svaKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120310/4a6384b3/attachment.pl>

From pingyang.whu at gmail.com  Sat Mar 10 15:52:21 2012
From: pingyang.whu at gmail.com (ping yang)
Date: Sat, 10 Mar 2012 07:52:21 -0700
Subject: [R-sig-Geo] Aggregate time series grid data temporally
Message-ID: <CAK8gSG_iuc_bZ6jVOy_YMAb_Rn9Qb4e_9jMK7kwr+VTn919_gg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120310/5f4c8298/attachment.pl>

From HodgessE at uhd.edu  Sat Mar 10 23:37:35 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 10 Mar 2012 16:37:35 -0600
Subject: [R-sig-Geo] "visualize this" book
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58EDC@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120310/d1953de1/attachment.pl>

From ashlytownsen at gmail.com  Sat Mar 10 23:58:24 2012
From: ashlytownsen at gmail.com (Ashly Townsen)
Date: Sat, 10 Mar 2012 16:58:24 -0600
Subject: [R-sig-Geo] Kcross question
Message-ID: <CALVyxyGRKDr85sS-9GPsQnhhnN2kaUn5e7KEi4pTTyoOFZdVWQ@mail.gmail.com>

Hi,

I am creating a bivariate K analysis with the spatstat package.  The code I
used is below, but perhaps a little explanation is preferable first.  I am
trying to analyze the location of peacekeeping operations relative to
battle clusters in countries experiencing a civil war (I am a poli. sci.
graduate student).  The analysis should tell me if peacekeeping locations
are located near different types of battle clusters (this example is low,
med, high deaths) and I have created an output graph that should illustrate
how each compares to the other.  The data is all GIS (long, lat) coded and
I have used the country's border as the bound.  The main question I am
struggling over is related to the r (radius?) value in the kcross command.
 Is there a way to force the r to use my desired increments (I know the
help files says this is possible)?  I would prefer an output that is in
kilometers or meters.  If not, how do I determine the value of r in an unit
measurement?  I have seen a few outputs with x axes labels reading r= .5
meters but I can't figure out how to do this myself.  I have tried to use
the breaks argument but I can't seem to get the function work.  Is there a
pre-step I need to conduct to establish my GIS data as a certain projection
or tell R how my data is coded?   I have also attached the output if you
wish to take a look and let me know if you need additional information.

Thanks in advance,


Ashly Adam Townsen
University of Illinois
Department of Political Science



## CREATE BOUND (FOR DRC)
drc <- readShapePoly("drc2", repair=TRUE)
bound.drc <- as.owin(drc, "owin")

## BRING BACK AS MULTITYPE PPP
data.ppp <- scanpp("DRC_BD.txt", window=bound.drc, multitype=TRUE)

#### YEAR 2004 ####

## LOW BATTLE DEATHS
bik.low.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross,
i="490LowBD2004", j="490pko2004", nsim=100)

## MED BATTLE DEATHS
bik.med.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross,
i="490MedBD2004", j="490pko2004", nsim=100)

## HIGH BATTLE DEATHS
bik.high.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross,
i="490HighBD2004", j="490pko2004", nsim=100)

## Creating Plot objects
drc.low.2004 <- data.frame(bik.low.drc.sim.2004[0:50])
drc.low.data.2004 <- drc.low.2004$obs - drc.low.2004$theo

drc.med.2004 <- data.frame(bik.med.drc.sim.2004[0:50])
drc.med.data.2004 <- drc.med.2004$obs - drc.med.2004$theo

drc.high.2004 <- data.frame(bik.high.drc.sim.2004[0:50])
drc.high.data.2004 <- drc.high.2004$obs - drc.high.2004$theo

plot(drc.low.data.2004, type="s", main="Clustering of Battle Deaths and
Peacekeeping Operations, DRC 2004", ylab="Observed - Expected",
xlab="Distance", lty=1, col="black", ylim=c(-1, 10))
lines(drc.med.data.2004, type="s", lty=1, col="blue")
lines(drc.high.data.2004, type="s", lty=1, col="red")
abline(h=0, lty=3, col="gray21")
legend("topleft", inset=0, c("Low BD","Med BD","High BD"), fill=c("black",
"blue", "red"), cex=0.75, horiz=TRUE)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120310/38675024/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DRC_ALL_2004.pdf
Type: application/pdf
Size: 5662 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120310/38675024/attachment.pdf>

From r.turner at auckland.ac.nz  Sun Mar 11 05:16:48 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sun, 11 Mar 2012 17:16:48 +1300
Subject: [R-sig-Geo] Kcross question
In-Reply-To: <CALVyxyGRKDr85sS-9GPsQnhhnN2kaUn5e7KEi4pTTyoOFZdVWQ@mail.gmail.com>
References: <CALVyxyGRKDr85sS-9GPsQnhhnN2kaUn5e7KEi4pTTyoOFZdVWQ@mail.gmail.com>
Message-ID: <4F5C2730.9010303@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120311/93895972/attachment.pl>

From joona.lehtomaki at cs.helsinki.fi  Sun Mar 11 09:50:35 2012
From: joona.lehtomaki at cs.helsinki.fi (=?ISO-8859-1?Q?Joona_Lehtom=E4ki?=)
Date: Sun, 11 Mar 2012 10:50:35 +0200
Subject: [R-sig-Geo] "visualize this" book
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58EDC@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58EDC@BALI.uhd.campus>
Message-ID: <4F5C675B.4040600@cs.helsinki.fi>

Hi Erin,

While not strictly R-sig-geo related, here are few pointers.

> The code for download is in Python.  Does anyone know if it is
> available in R?  Or should I give myself a crash course in Python
> this week (spring break) and "translate"?

I think Nathan (Yau, the author) is trying to introduce a variety of 
tools and languages suitable for people with different objectives and 
backgrounds. R seems to be his favourite tool for many tasks, so there 
is quite a lot of code in R there as well. You can download much of the 
source code here:

http://book.flowingdata.com/downloads.html

Learning Python is still a good idea!

Hope this helps,

Joona

-- 

Joona Lehtom?ki
Doctoral Student

Metapopulation Research Group
Department of Biosciences
PO Box 65 (Viikinkaari 1)
00014 University of Helsinki
Finland

email: joona.lehtomaki at helsinki.fi
www:   http://www.helsinki.fi/science/metapop/People/Joona.htm

Tel: 	+358 (0)9 191 57715 (work)
	+358 (0)40 826 9069 (mobile)


From agus.camacho at gmail.com  Sun Mar 11 15:32:18 2012
From: agus.camacho at gmail.com (Agus Camacho)
Date: Sun, 11 Mar 2012 11:32:18 -0300
Subject: [R-sig-Geo] dealing with NAs during Species Distribution Modelling
Message-ID: <CALsJ7pRKQ-aMYgGVx961eCYzNuteM2usSNRa__LGk=cApizL0A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120311/f5bc5607/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Mar 11 17:19:38 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 11 Mar 2012 17:19:38 +0100
Subject: [R-sig-Geo] subset() for SpatialPOLYGONSDataFrame
In-Reply-To: <CANnCtnJvqCh9g-ZXFy5vUxu=LZ4PBWBrpaYbVbrCJgYWxtEauA@mail.gmail.com>
References: <CANnCtnKndj1iFNV-YCuFY5aG=v+JVawrn4chcBC3DHYFHMfXsw@mail.gmail.com>
	<4F5A61CD.3010102@uni-muenster.de>
	<CANnCtnJvqCh9g-ZXFy5vUxu=LZ4PBWBrpaYbVbrCJgYWxtEauA@mail.gmail.com>
Message-ID: <4F5CD09A.6050704@uni-muenster.de>

sp_0.9-97 is now on CRAN, and contains a subset method that should work,
compatible to subset.data.frame, for all objects deriving from class
Spatial.

In addition, the spplot points plotting order discussed in this thread:
https://stat.ethz.ch/pipermail/r-sig-geo/2012-March/014399.html
was resolved.


On 03/09/2012 09:31 PM, Lee Hachadoorian wrote:
> I have always relied on spdfThis[spdfThis$column == criteria,], and I
> was surprised to find out you could subset() a SpatialPointsDataFrame.
> When I heard that, I tested it on SpatialPolygonsDataFrame without
> checking the methods.
> 
> Thanks for clarifying, and for explicating the underlying logic. 
> 
> --Lee
> 
> On Fri, Mar 9, 2012 at 3:02 PM, Edzer Pebesma
> <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> wrote:
> 
>     Lee,
> 
>     sp does not provide a subset method for SpatialPolygonsDataFrame
>     objects:
> 
>     > library(sp)
>     > methods(subset)
>     [1] subset.data.frame              subset.default
>     [3] subset.matrix                  subset.SpatialPixels*
>     [5] subset.SpatialPixelsDataFrame* subset.SpatialPoints*
>     [7] subset.SpatialPointsDataFrame*
> 
>       Non-visible functions are asterisked
> 
>     this means that when you do call it, subset.default will be called as
>     the fall-back:
> 
>     > subset.default
>     function (x, subset, ...)
>     {
>        if (!is.logical(subset))
>            stop("'subset' must be logical")
>        x[subset & !is.na <http://is.na>(subset)]
>     }
> 
>     as you can see, this will lead to the expression:
> 
>     somePolygons[somePolygons$someColumn == subsetCriteria]
> 
>     which didn't give an error but leads to column selection rather than row
>     selection.
> 
>     To be short: the subset method you want is not there in sp.
> 
> 
>     On 03/09/2012 08:44 PM, Lee Hachadoorian wrote:
>     > Following thread re: subsetting a SpatialPointsDataFrame. Poking
>     around and
>     > found some unexpected behavior with a SpatialPolygonsDataFrame.
>     The subset
>     > argument appears to be interpreted as select. That is:
>     >
>     > subsetPolygons = subset(somePolygons, somePolygons$someColumn ==
>     > subsetCriteria)
>     >
>     > returns all rows (all polygons), but the dataframe in the data
>     slot only
>     > has columns selected by the logical vector spdfThis$someColumn ==
>     > "something". This of course is the behavior expected if I
>     specified the
>     > select argument instead of the subset argument. I tried this
>     explicitly
>     > naming the subset argument (subset = ...), rather than implicitly, and
>     > observed the same behavior.
>     >
>     > Doing the same thing with a SpatialPointsDataFrame appears to work as
>     > expected.
>     >
>     > Not uploading my data, but the actual code I ran, so you can scan
>     it for
>     > stupid errors is:
>     >
>     > #Using SpatialPolygonsDataFrame
>     > #Produces map of New York City with only Manhattan
>     > plot(spdfBoro[spdfBoro$boro_code == 1,])
>     >
>     > #Produces map of New York City with five boros, every fifth column
>     appears
>     > in data frame
>     > plot(subset(spdfBoro, spdfBoro$boro_code == 1))
>     >
>     > #Using SpatialPointsDataFrame
>     > #Produces map of point locations in New York City, only those
>     points in
>     > Manhattan
>     > plot(sndfWf1[sndfWf1$borough == "New York",])
>     >
>     > #Produces map of point locations in New York City, only those
>     points in
>     > Manhattan
>     > plot(subset(sndfWf1, sndfWf1$borough == "New York"))
>     >
>     > Am I doing something wrong?
>     >
>     > Regards,
>     > --Lee
>     >
> 
>     --
>     Edzer Pebesma
>     Institute for Geoinformatics (ifgi), University of M?nster
>     Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>     8333081, Fax: +49 251 8339763 <tel:%2B49%20251%208339763>
>      http://ifgi.uni-muenster.de
>     http://www.52north.org/geostatistics      e.pebesma at wwu.de
>     <mailto:e.pebesma at wwu.de>
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From cjpauw at gmail.com  Sun Mar 11 20:03:13 2012
From: cjpauw at gmail.com (christiaan pauw)
Date: Sun, 11 Mar 2012 21:03:13 +0200
Subject: [R-sig-Geo] problem with OpenStreetMap
Message-ID: <CAJESSmad+BPBy_FzF68x8Ny-Yup7CHcDOtEmw895HZN7sg6Njg@mail.gmail.com>

Hi Everbody

I read this blog about the new OpenStreetMap package
(http://www.r-bloggers.com/plot-maps-like-a-boss/), downloaded the
package and tried out the example.

The first example is:

library(OpenStreetMap)
library(rgdal)
map <- openmap(c(70,-179), c(-70,179))
plot(map)

It looked simple enough. However, this resulted in an error which
appears to be related to the fact that my R version is 2.14.0 and the
package ?OpenStreetMap? was built under R version 2.14.1  (see below
together with sessionInfo())

Is this correct or is it perhaps something else.

regards
Christiaan

> library(OpenStreetMap)
Loading required package: rJava
Loading required package: sp
Loading required package: maptools
Loading required package: foreign
Loading required package: lattice
Checking rgeos availability: FALSE
 	Note: when rgeos is not available, polygon geometry 	computations in
maptools depend on gpclib,
 	which has a restricted licence. It is disabled by default;
 	to enable gpclib, type gpclibPermit()
Loading required package: raster
raster version 1.9-70 (27-February-2012)
Warning messages:
1: package ?OpenStreetMap? was built under R version 2.14.1
2: package ?raster? was built under R version 2.14.1
> library(rgdal)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
Path to GDAL shared files:
/Users/christiaanpauw/Library/R/2.14/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files:
/Users/christiaanpauw/Library/R/2.14/library/rgdal/proj
> map <- openmap(c(70,-179), c(-70,179))
Error in .jcall("RJavaTools", "Ljava/lang/Object;", "invokeMethod", cl,  :
  java.lang.InternalError: Can't start the AWT because Java was
started on the first thread.  Make sure StartOnFirstThread is not
specified in your application's Info.plist or on the command line
> plot(map)
Error in plot.window(...) : need finite 'xlim' values
In addition: Warning messages:
1: In xy.coords(x, y, xlabel, ylabel, log) : NAs introduced by coercion
2: In xy.coords(x, y, xlabel, ylabel, log) : NAs introduced by coercion
3: In min(x) : no non-missing arguments to min; returning Inf
4: In max(x) : no non-missing arguments to max; returning -Inf
5: In min(x) : no non-missing arguments to min; returning Inf
6: In max(x) : no non-missing arguments to max; returning -Inf

Sessio Info below:

> sessionInfo()
R version 2.14.0 (2011-10-31)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US/en_US/en_US/C/en_US/en_US

attached base packages:
[1] grid      splines   stats     graphics  grDevices utils
datasets  methods   base

other attached packages:
 [1] rgdal_0.7-5       maps_2.2-2        OpenStreetMap_0.2
raster_1.9-70     maptools_0.8-10
 [6] foreign_0.8-46    rJava_0.9-2       portfolio_0.4-5
nlme_3.1-102      Hmisc_3.9-0
[11] ggplot2_0.8.9     proto_0.3-9.2     reshape_0.8.4     plyr_1.6
      reporttools_1.0.6
[16] xtable_1.6-0      doBy_4.4.3        MASS_7.3-16       snow_0.3-8
      lme4_0.999375-42
[21] Matrix_1.0-1      lattice_0.20-0    multcomp_1.2-8
mvtnorm_0.9-9991  R2HTML_2.2
[26] survival_2.36-10  descr_0.4.2       TeachingDemos_2.7
prettyR_2.0-1     sp_0.9-93

loaded via a namespace (and not attached):
[1] cluster_1.14.1 digest_0.5.1   stats4_2.14.0  tools_2.14.0

--
Christiaan Pauw
Nova Institute
www.nova.org.za


From r.hijmans at gmail.com  Sun Mar 11 20:54:31 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 11 Mar 2012 12:54:31 -0700
Subject: [R-sig-Geo] problem with OpenStreetMap
In-Reply-To: <CAJESSmad+BPBy_FzF68x8Ny-Yup7CHcDOtEmw895HZN7sg6Njg@mail.gmail.com>
References: <CAJESSmad+BPBy_FzF68x8Ny-Yup7CHcDOtEmw895HZN7sg6Njg@mail.gmail.com>
Message-ID: <CANtt_hyXDaLF3nkXytYm9cf7sHEbpOyYUA1q5sG=snMOnGDvcg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120311/a03833f4/attachment.pl>

From r.hijmans at gmail.com  Sun Mar 11 21:00:05 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 11 Mar 2012 13:00:05 -0700
Subject: [R-sig-Geo] dealing with NAs during Species Distribution
	Modelling
In-Reply-To: <CALsJ7pRKQ-aMYgGVx961eCYzNuteM2usSNRa__LGk=cApizL0A@mail.gmail.com>
References: <CALsJ7pRKQ-aMYgGVx961eCYzNuteM2usSNRa__LGk=cApizL0A@mail.gmail.com>
Message-ID: <CANtt_hxYwJusPnv-HooX+Yg9Ghkev43-1U1-iEUAFM7UL9zhew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120311/b52b5108/attachment.pl>

From Adrian.Baddeley at csiro.au  Mon Mar 12 01:30:32 2012
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Mon, 12 Mar 2012 08:30:32 +0800
Subject: [R-sig-Geo] Kcross question
In-Reply-To: <4F5C2730.9010303@auckland.ac.nz>
References: <CALVyxyGRKDr85sS-9GPsQnhhnN2kaUn5e7KEi4pTTyoOFZdVWQ@mail.gmail.com>,
	<4F5C2730.9010303@auckland.ac.nz>
Message-ID: <57DC18C299094D4299F837570C5DF1C558C829EE03@EXWA-MBX01.nexus.csiro.au>

In addition to Rolf's comments:

      In spatstat version 1, all computations are performed using the Euclidean distance. If your data were originally recorded as latitude, longitude
      coordinates then ideally it would be better to measure the great circle (geodesic) distance between points, and to compute the Kcross function (etc)
      using these distances; but we have not yet released any code in spatstat to do this. We are working on it. 

      In the meantime the best strategy is to project the lat, long coordinates using a suitable projection (see the packages spproj and maptools) 
      and then to use spatstat to calculate Kcross etc.

      Adrian Baddeley
       
________________________________________
From: Rolf Turner [r.turner at auckland.ac.nz]
Sent: Sunday, 11 March 2012 12:16 PM
To: Ashly Townsen
Cc: r-sig-geo at r-project.org; Baddeley, Adrian (CMIS, Floreat)
Subject: Re: [R-sig-Geo] Kcross question

(1) At the present time "spatstat" has no facilities for for projecting one
coordinate system onto another.  There are tools, in the "sp" package,
for doing such projection, but I have no experience in using them.  Others
on this list will be able to help you.

(2) In respect of the "r" and "breaks" argument:   The help says not to mess
with "breaks" in normal circumstances. If you want to ``use your own increments''
just specify the "r" argument, making sure that the entries of "r" are non-negative,
and strictly increasing.  And the first entry of "r" is 0.

But *WHY* do you want to specify ``your own increments''?  You are advised
not to do so, and there is no indication in what you have written as how specifying
your own "r" vector would make the task of analysing your data any easier.

(3) If you want ``output that is in kilometres or metres'' then you must specify
the coordinates of your pattern in kilometres or metres.  That is, you must
project your long and lat coordinates onto a flat surface on which distance
is measured in the required units.  I *think* that ``UTM'' is the system you are,
or may be, after but I may be talking through my hat here.  Others may advise
you more wisely.

Note that if you get your coordinates set up as, e.g., kilometres, you may wish
to specify the window for your pattern using argument unitname="kilometres".
The default x-axis label for your envelope plot will then include "kilometres".

(4) It is not clear to me what you are really getting out of using the Kcross()
function anyway.  If I were analysing such data I would start by forming a
distance map for each of the patterns of battle clusters and then use that
distance map as a covariate in a model to predict the intensity of the peace
keeping operation pattern.  Using the rhohat() function could be revealing.

    cheers,

        Rolf Turner

On 11/03/12 11:58, Ashly Townsen wrote:
Hi,

I am creating a bivariate K analysis with the spatstat package.  The code I used is below, but perhaps a little explanation is preferable first.  I am trying to analyze the location of peacekeeping operations relative to battle clusters in countries experiencing a civil war (I am a poli. sci. graduate student).  The analysis should tell me if peacekeeping locations are located near different types of battle clusters (this example is low, med, high deaths) and I have created an output graph that should illustrate how each compares to the other.  The data is all GIS (long, lat) coded and I have used the country's border as the bound.  The main question I am struggling over is related to the r (radius?) value in the kcross command.  Is there a way to force the r to use my desired increments (I know the help files says this is possible)?  I would prefer an output that is in kilometers or meters.  If not, how do I determine the value of r in an unit measurement?  I have seen a few outputs with x axes labels reading r= .5 meters but I can't figure out how to do this myself.  I have tried to use the breaks argument but I can't seem to get the function work.  Is there a pre-step I need to conduct to establish my GIS data as a certain projection or tell R how my data is coded?   I have also attached the output if you wish to take a look and let me know if you need additional information.

Thanks in advance,


Ashly Adam Townsen
University of Illinois
Department of Political Science



## CREATE BOUND (FOR DRC)
drc <- readShapePoly("drc2", repair=TRUE)
bound.drc <- as.owin(drc, "owin")

## BRING BACK AS MULTITYPE PPP
data.ppp <- scanpp("DRC_BD.txt", window=bound.drc, multitype=TRUE)

#### YEAR 2004 ####

## LOW BATTLE DEATHS
bik.low.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross, i="490LowBD2004", j="490pko2004", nsim=100)

## MED BATTLE DEATHS
bik.med.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross, i="490MedBD2004", j="490pko2004", nsim=100)

## HIGH BATTLE DEATHS
bik.high.drc.sim.2004 <- envelope(data.ppp, correction="best", Kcross, i="490HighBD2004", j="490pko2004", nsim=100)

## Creating Plot objects
drc.low.2004 <- data.frame(bik.low.drc.sim.2004[0:50])
drc.low.data.2004 <- drc.low.2004$obs - drc.low.2004$theo

drc.med.2004 <- data.frame(bik.med.drc.sim.2004[0:50])
drc.med.data.2004 <- drc.med.2004$obs - drc.med.2004$theo

drc.high.2004 <- data.frame(bik.high.drc.sim.2004[0:50])
drc.high.data.2004 <- drc.high.2004$obs - drc.high.2004$theo

plot(drc.low.data.2004, type="s", main="Clustering of Battle Deaths and Peacekeeping Operations, DRC 2004", ylab="Observed - Expected", xlab="Distance", lty=1, col="black", ylim=c(-1, 10))
lines(drc.med.data.2004, type="s", lty=1, col="blue")
lines(drc.high.data.2004, type="s", lty=1, col="red")
abline(h=0, lty=3, col="gray21")
legend("topleft", inset=0, c("Low BD","Med BD","High BD"), fill=c("black", "blue", "red"), cex=0.75, horiz=TRUE)





_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From senawusl at yahoo.com  Mon Mar 12 03:38:00 2012
From: senawusl at yahoo.com (senani karunaratne)
Date: Sun, 11 Mar 2012 19:38:00 -0700 (PDT)
Subject: [R-sig-Geo]  Aggregate time series grid data temporally
Message-ID: <1331519880.87344.YahooMailNeo@web113205.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120311/e8e5ca4c/attachment.pl>

From oscar.perpinan at upm.es  Mon Mar 12 12:34:23 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Mon, 12 Mar 2012 12:34:23 +0100
Subject: [R-sig-Geo] Aggregate time series grid data temporally
In-Reply-To: <1331519880.87344.YahooMailNeo@web113205.mail.gq1.yahoo.com>
	(senani karunaratne's message of "Sun, 11 Mar 2012 19:38:00 -0700
	(PDT)")
References: <1331519880.87344.YahooMailNeo@web113205.mail.gq1.yahoo.com>
Message-ID: <877gyq8340.fsf@upm.es>

senani karunaratne <senawusl at yahoo.com> writes:
> Hi Ping, 
>
> You can read your grid files to R. 
>
> Recently I? read monthly grid data for time series and they can be stacked in R. 
>
> Use package Raster for stacking purpose. Code I used is given below
>
> setwd ("D:\\WORKINGS")
> # check your data in folder
> dir()
> library (raster)
> # list all files of interest:
> weather<- list.files()
> # Read to R:
> require (raster)
> stacked <- stack (lapply(weather,raster))
>
> Look for help file of the raster package where you can get aggregates etc
> This approach is very simple and it works for me. 

Besides, the 'setZ' and 'zApply' functions of the 'raster' package could be useful for you since
you are using raster time series.

Best,

Oscar.
>
> Date: Sat, 10 Mar 2012 07:52:21 -0700
> From: ping yang <pingyang.whu at gmail.com>
> To: R-sig-Geo at r-project.org
> Subject: [R-sig-Geo] Aggregate time series grid data temporally
> Message-ID:
> ??? <CAK8gSG_iuc_bZ6jVOy_YMAb_Rn9Qb4e_9jMK7kwr+VTn919_gg at mail.gmail.com>
> Content-Type: text/plain
>
> Hi,
>
> I am a newbie of R, I have time series (6 hours) weather data(represented
> as muti-layer grids), what I plan to do is to aggregate these grids
> temporally(from 6 hours to daily), Can I do it with R? some instructions or
> suggestions?
>
> Thanks,
>
> Ping
> ----------
> Ping Yang, Ph.D.
> Postdoctoral Research Associate
> CUNY EnVironmental Crossroads Initiative
> ?
> senani karunaratne
> University of Sydney
> Australia
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From zua3 at cornell.edu  Mon Mar 12 14:53:01 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Mon, 12 Mar 2012 09:53:01 -0400
Subject: [R-sig-Geo] Help: Create several  ESRI Shape files in a Loop
In-Reply-To: <4F54E2AC.6040707@uni-muenster.de>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de>
Message-ID: <4F5DFFBD.2040601@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/14fc8dc8/attachment.pl>

From saldanha.plangeo at gmail.com  Mon Mar 12 15:13:50 2012
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 12 Mar 2012 11:13:50 -0300
Subject: [R-sig-Geo] Help: Create several ESRI Shape files in a Loop
In-Reply-To: <4F5DFFBD.2040601@cornell.edu>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F5DFFBD.2040601@cornell.edu>
Message-ID: <CACSWb41eP1AEX+5GcaHq3P-VzsY6TQEgh8LtV6kn4OwQ5rC2hQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/12f5d9c2/attachment.pl>

From roman.lustrik at gmail.com  Mon Mar 12 15:16:28 2012
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 12 Mar 2012 15:16:28 +0100
Subject: [R-sig-Geo] Help: Create several ESRI Shape files in a Loop
In-Reply-To: <4F5DFFBD.2040601@cornell.edu>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F5DFFBD.2040601@cornell.edu>
Message-ID: <CAHT1vpjDOK3LWwP=cFxKDmFqJTthBRFmu06DxWidnsQu0F_vGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/e1bb281e/attachment.pl>

From saldanha.plangeo at gmail.com  Mon Mar 12 15:20:21 2012
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 12 Mar 2012 11:20:21 -0300
Subject: [R-sig-Geo] Help: Create several ESRI Shape files in a Loop
In-Reply-To: <CACSWb41eP1AEX+5GcaHq3P-VzsY6TQEgh8LtV6kn4OwQ5rC2hQ@mail.gmail.com>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F5DFFBD.2040601@cornell.edu>
	<CACSWb41eP1AEX+5GcaHq3P-VzsY6TQEgh8LtV6kn4OwQ5rC2hQ@mail.gmail.com>
Message-ID: <CACSWb41Bch00KW9eOi8_f1+yzQsesc9Ax2vg+c=Eyyokm5AK2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/600375b5/attachment.pl>

From zua3 at cornell.edu  Mon Mar 12 18:06:57 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Mon, 12 Mar 2012 13:06:57 -0400
Subject: [R-sig-Geo] Help: Create several ESRI Shape files in a Loop
In-Reply-To: <CACSWb41Bch00KW9eOi8_f1+yzQsesc9Ax2vg+c=Eyyokm5AK2Q@mail.gmail.com>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F5DFFBD.2040601@cornell.edu>
	<CACSWb41eP1AEX+5GcaHq3P-VzsY6TQEgh8LtV6kn4OwQ5rC2hQ@mail.gmail.com>
	<CACSWb41Bch00KW9eOi8_f1+yzQsesc9Ax2vg+c=Eyyokm5AK2Q@mail.gmail.com>
Message-ID: <4F5E2D31.5070004@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/cc309fcb/attachment.pl>

From tomte.tumetot at gmx.ch  Mon Mar 12 18:34:49 2012
From: tomte.tumetot at gmx.ch (Thomas Hoffmann)
Date: Mon, 12 Mar 2012 18:34:49 +0100
Subject: [R-sig-Geo] trouble readOGR
Message-ID: <20120312173449.4470@gmx.net>

Dear all,

I try to import an Mapinfo file to R and get following error message:

> tmp = readOGR(fi.tab[k],layer=fi[k])
OGR data source with driver: MapInfo File 
Source: "25545700.TAB", layer: "25545700"
with 40401 features and 3 fields
Fehler in make.names(fldnms, unique = TRUE) : 
  ung?ltige multibyte Zeichenkette 3

however ogrInfo obtains:

> ogrInfo(fi.tab[k], layer=fi[k])
Source: "25545700.TAB", layer: "25545700"
Driver: MapInfo File number of rows 40401 
Feature type: wkbPoint with 2 dimensions
+proj=tmerc +lat_0=0 +lon_0=6 +k=1 +x_0=2500000 +y_0=0 +ellps=bessel +towgs84=582,105,414,1.04,0.35,-3.08,8.3 +units=m +no_defs  
Number of fields: 3 
     name type length typeName
1  Rechts    2      0     Real
2    Hoch    2      0     Real
3 H\xf6he    2      0     Real

Any advice how to handle the problem?

Thanks
Thomas

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From b.rowlingson at lancaster.ac.uk  Mon Mar 12 19:38:10 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 12 Mar 2012 18:38:10 +0000
Subject: [R-sig-Geo] trouble readOGR
In-Reply-To: <20120312173449.4470@gmx.net>
References: <20120312173449.4470@gmx.net>
Message-ID: <CANVKczMfv9odvdFNo6U1X5DB9-Xt5q6da15g9hwrdTcxNEpu+w@mail.gmail.com>

On Mon, Mar 12, 2012 at 5:34 PM, Thomas Hoffmann <tomte.tumetot at gmx.ch> wrote:
> Dear all,
>
> I try to import an Mapinfo file to R and get following error message:
>
>> tmp = readOGR(fi.tab[k],layer=fi[k])
> OGR data source with driver: MapInfo File
> Source: "25545700.TAB", layer: "25545700"
> with 40401 features and 3 fields
> Fehler in make.names(fldnms, unique = TRUE) :
> ?ung?ltige multibyte Zeichenkette 3
>
> however ogrInfo obtains:
>
>> ogrInfo(fi.tab[k], layer=fi[k])
> Source: "25545700.TAB", layer: "25545700"
> Driver: MapInfo File number of rows 40401
> Feature type: wkbPoint with 2 dimensions
> +proj=tmerc +lat_0=0 +lon_0=6 +k=1 +x_0=2500000 +y_0=0 +ellps=bessel +towgs84=582,105,414,1.04,0.35,-3.08,8.3 +units=m +no_defs
> Number of fields: 3
> ? ? name type length typeName
> 1 ?Rechts ? ?2 ? ? ?0 ? ? Real
> 2 ? ?Hoch ? ?2 ? ? ?0 ? ? Real
> 3 H\xf6he ? ?2 ? ? ?0 ? ? Real

 Have you tried:

 readOGR(fi.tab[k],layer=fi[k],input_field_name_encoding="latin1")

It's that pesky \xf6 in there. R doesn't know what encoding it is:

> readOGR(".","e")
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "e"
with 10 features and 1 fields
Error in make.names(fldnms, unique = TRUE) : invalid multibyte string 1
> readOGR(".","e",input_field_name_encoding="latin1")
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "e"
with 10 features and 1 fields
Feature type: wkbPoint with 2 dimensions
   coordinates       H?he
1       (1, 1) 0.50774675
[etc]

Barry


From dprosser at usgs.gov  Mon Mar 12 23:57:41 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Mon, 12 Mar 2012 15:57:41 -0700 (PDT)
Subject: [R-sig-Geo] apply monte carlo simulation for each cell in a matrix
 (originally raster)
Message-ID: <1331593061937-7367094.post@n2.nabble.com>

Hi all,

I hope you forgive me for this cross-post. I requested help a few days ago
on the general R-help board but haven't received a response. I think that a
solution can most likely be answered by someone familiar with working with
large spatial datasets.

I have raster datasets exported from ArcGRID format into ASCII text files,
read successfully into R. They are large - 4848 x 4053 cells. I am running
monte-carlo simulations using the mc2d package (mcstoc function) and am
having a difficult time applying (or looping) the simulations for each cell
in my matrix.

Below is the code I've been using to test the process on reduced (2x2)
matrices, followed by error messages. 
Below that I post the link to (and complete text) from my initial inquiry on
Saturday.

Thank you kindly for any help you might be able to provide.

________________________________________________________________________
#Code - using 2x2 example matrices for each raster:
#terms in bold are the rasters from which I want to pull data for the mcstoc
function

#Construct reduced (2x2) matrices for testing code
Pmn<- matrix(c(3.5, 2.1, 2.9, 3.2), nrow=2)
Psd<- matrix(c(0.108, 0.117, 0.092, 0.125), nrow=2)
Wab<- matrix(c(47, 33, 56, 44), nrow=2)
m<- matrix(nrow=2, ncol=2)
 
library(mc2d) #load package

#create mcnodes for use in mcstoc (since array arguments not permitted as
determined by Error 1)
dPmn<- mcdata(Pmn, type="0")
dPsd<- mcdata(Psd, type="0")
dWab<- mcdata(Wab, type="0")

ndunc(1001)
for (i in m) {
stPte <- mcstoc(rnorm, type="U", *dPmn*, *dPsd*, rtrunc=TRUE, linf=0)
stWab <- mcstoc(rtriang, type="U", min=0, mode=*dWab*, max=75)
risk <- stPte * stWab 
}
____________________________________________________________________________

Error 1:
Error in function (argsd, typethismc)  : 
  Array prohibited in mcstoc as parameter. Use an mcnode instead (in
response to this, I have created the  code above, but now get Error 2 below)

Error 2:
Error in mcdata(Pmn, type = "0") : 
  The array size is not compatible with the node dimension. Should be of
dim: 1 1 1

____________________________________________________________________________
Initial post can be found at:
http://r.789695.n4.nabble.com/Draw-values-from-multiple-data-sets-as-inputs-to-a-Monte-Carlo-function-then-apply-across-entire-matx-td4462874.html 

3/10/2012
Hi all, 

I am trying to implement a Monte-Carlo simulation for each cell in a 
spatial matrix (using mcd2 package) . 
I have figured out how to conduct the simulation using data from a single 
location (where I manually input distribution parameters into the R code), 
but am having trouble (a) adjusting the code to pull input variables from 
my various data sets and then (b) applying the entire process across each 
of the cells of the matrices. 

I have been doing a lot of reading about loops (a big no-no?), apply, and 
ddply, but can not quite figure it out. 

Here is the situation: 

Data: 
I have (for simplicity) 3 spatial raster data sets (each 4848 x 4053 
cells) as ASCII files: 
-Poultry density (mean value in each cell) 
-Poultry density (standard deviation in each cell) 
-Wild bird density (single estimate in each cell) 
I read them into R using read.table. The data look correct: 
Pmn <- read.table("D:/Data/PoultryMeans.txt") 
Psd <- read.table("D:/Data/PoultryStDev.txt") 
Wde <- read.table("D:/Data/WildBirdDensity.txt") 

The Model: 
In the Monte-Carlo simulation, Poultry and Wild birds have different 
distributions (normal and triangle, respectively). 
Below are the 2 lines of code that use the mcstoc function to draw the 
samples. 
The values in bold are ones that I would like to draw from the data tables 
I read in above. 
For example, 3.5 would be cell (i,j) in the Poultry MEAN density table; 
0.108 would be cell (i,j) in the Poultry STDEV table; and 47 the single 
estimate for cell (i,j) of the Wild bird density table. 

Poultry <- mcstoc(rnorm, type="U", 3.5, 0.108, rtrunc=TRUE, linf=0) 
Wild <- mcstoc(rtriang, type="U", min=0, mode=47, max=75) 
Risk <- Poultry * Wild        #this is the risk function the MC is applied 
to 

Questions: 
1) How can I edit the Poultry and Wild variables above to read the data 
values directly from the 3 input tables (i.e., replacing 3.5, 0.108, and 
47 with some variable name for the data table and using a loop?? Or 
somehow use apply or ddply?) 
2) Have the entire process be run for every cell in the 4848 x 4053 
matrix? 

Thank you for any help you can provide to get me moving forward! 
Diann 

3/12/2012
Dear all,

I have developed a loop but receive an error (error 1 below) because the
mcstoc function prohibits arrays. I tried creating an mcnode to represent
the data frame, but received Error 2 below (array size not compatible with
node dimension).

I'm still at a loss on how to apply the Monte-Carlo simulation for each cell
in a matrix. There is an mcapply function, but I did not have success
applying it. Any insight would be much appreciated. 

Error 1:
Error in function (argsd, typethismc)  : 
  Array prohibited in mcstoc as parameter. Use an mcnode instead

Error 2:
Error in mcdata(Pmn, type = "0") : 
  The array size is not compatible with the node dimension. Should be of
dim: 1 1 1

________________________________________________________________________
#Code - using 2x2 example matrices for each raster:

#Construct reduced (2x2) matrices for testing code
Pmn<- matrix(c(3.5, 2.1, 2.9, 3.2), nrow=2)
Psd<- matrix(c(0.108, 0.117, 0.092, 0.125), nrow=2)
Wab<- matrix(c(47, 33, 56, 44), nrow=2)
m<- matrix(nrow=2, ncol=2)
 
library(mc2d) #load package

#create mcnodes for use in mcstoc (since array arguments not permitted)
dPmn<- mcdata(Pmn, type="0")
dPsd<- mcdata(Psd, type="0")
dWab<- mcdata(Wab, type="0")

ndunc(1001)
for (i in m) {
stPte <- mcstoc(rnorm, type="U", dPmn, dPsd, rtrunc=TRUE, linf=0)
stWab <- mcstoc(rtriang, type="U", min=0, mode=dWab, max=75)
risk <- stPte * stWab 
}
____________________________________________________________________________



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/apply-monte-carlo-simulation-for-each-cell-in-a-matrix-originally-raster-tp7367094p7367094.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue Mar 13 01:34:31 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 12 Mar 2012 17:34:31 -0700
Subject: [R-sig-Geo] apply monte carlo simulation for each cell in a
 matrix (originally raster)
In-Reply-To: <1331593061937-7367094.post@n2.nabble.com>
References: <1331593061937-7367094.post@n2.nabble.com>
Message-ID: <CANtt_hwoK8EE_8QyBiC8Hb2iAD_TGB+ocJe1_Bq0gQPw2CfsxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120312/5f51062f/attachment.pl>

From dprosser at usgs.gov  Tue Mar 13 06:30:18 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Mon, 12 Mar 2012 22:30:18 -0700 (PDT)
Subject: [R-sig-Geo] apply monte carlo simulation for each cell in a
 matrix (originally raster)
In-Reply-To: <1331593061937-7367094.post@n2.nabble.com>
References: <1331593061937-7367094.post@n2.nabble.com>
Message-ID: <1331616618036-7367555.post@n2.nabble.com>

Robert, thank you very much! I believe this sets me on the right path.

2 issues I'm looking into:

1) I do receive an S4 error after the as.matrix(x) step:
> as.matrix(x)
/Error in as.vector(data) : 
  no method for coercing this S4 class to a vector/

2) Perhaps related, I'm not sure if I'm losing the variance measures around
the estimate (mean risk) or if I'm not using the correct function to
retrieve them. For example, "summary(node)" should give me the median, mean,
2.5% and 97.5% variance measures for each cell. "summary(x)" gives me:

> summary(x)
Cells:  4 
NAs  :  0            
Min.     77.36
1st Qu. 114.10
Median  126.70
Mean    118.30
3rd Qu. 130.90
Max.    142.30


which is information summarized across the matrix.
             [,1]     [,2]
[1,] 142.13677 125.7188
[2,]  75.59303 128.8319
 
Ultimately, I want matrix/raster outputs for mean risk, plus the upper and
lower bounds.
Will keep digging. Thank you for your time!



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/apply-monte-carlo-simulation-for-each-cell-in-a-matrix-originally-raster-tp7367094p7367555.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ssubra at yahoo.com  Tue Mar 13 10:13:15 2012
From: ssubra at yahoo.com (Subramanian Swaminathan)
Date: Tue, 13 Mar 2012 02:13:15 -0700 (PDT)
Subject: [R-sig-Geo] Missing values impuation in OpenBugs
Message-ID: <1331629995.83373.YahooMailNeo@web163104.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/47b4c3fc/attachment.pl>

From mathieu.rajerison at gmail.com  Tue Mar 13 10:35:41 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 13 Mar 2012 10:35:41 +0100
Subject: [R-sig-Geo] One lot <-> several owners : duplicating geometries
Message-ID: <CAGfc75=sjRBohhe5e76=inLrSZy1g1wbkQAi-m3pbBtshFO33g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/096f0681/attachment.pl>

From advaitgodbole at gmail.com  Tue Mar 13 10:41:22 2012
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Tue, 13 Mar 2012 15:11:22 +0530
Subject: [R-sig-Geo] hourly time series
Message-ID: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/5a2e0c39/attachment.pl>

From advaitgodbole at gmail.com  Tue Mar 13 10:44:33 2012
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Tue, 13 Mar 2012 15:14:33 +0530
Subject: [R-sig-Geo] hourly time series
In-Reply-To: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>
References: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>
Message-ID: <CAFdqCxvKC1FZoM_tKc+DULL6KNGraN4gHEuhPeeUQcMBEcUjFw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/b96882ba/attachment.pl>

From HodgessE at uhd.edu  Tue Mar 13 10:52:06 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 13 Mar 2012 04:52:06 -0500
Subject: [R-sig-Geo] hourly time series
References: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58EF4@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/815a5c30/attachment.pl>

From advaitgodbole at gmail.com  Tue Mar 13 11:03:30 2012
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Tue, 13 Mar 2012 15:33:30 +0530
Subject: [R-sig-Geo] hourly time series
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58EF4@BALI.uhd.campus>
References: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>
	<586A4828D7AAA04CA9B258C50A28DA200BF58EF4@BALI.uhd.campus>
Message-ID: <CAFdqCxuQZVXwUHLgAcYKqj32+=t+cuCnTaBToUcV311yQ1kpnA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/f476c8c4/attachment.pl>

From jjcabrera20 at yahoo.com.mx  Tue Mar 13 11:42:16 2012
From: jjcabrera20 at yahoo.com.mx (jjcabrera20)
Date: Tue, 13 Mar 2012 03:42:16 -0700 (PDT)
Subject: [R-sig-Geo] Convert a Matrix into a SpatialGridDataFrame
Message-ID: <1331635336363-7368054.post@n2.nabble.com>

Hello everybody there!!
Maybe a silly question but for doing some manipulation on values of a
SpatialGridDataFrame I transformed it into a matrix like this
*Matrix<- as.matrix(SpatialGridDataFrame)*
now I want to go back and turn the matrix again into SpatialGridDataFrame,
but I can't find the way.
The matrix is still the same (number of rows and columns, grid size,
projection) as the original.

Thanks 

Jorge

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Convert-a-Matrix-into-a-SpatialGridDataFrame-tp7368054p7368054.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From valdounet at gmail.com  Tue Mar 13 12:13:13 2012
From: valdounet at gmail.com (Vlad)
Date: Tue, 13 Mar 2012 12:13:13 +0100
Subject: [R-sig-Geo] hourly time series
In-Reply-To: <CAFdqCxuQZVXwUHLgAcYKqj32+=t+cuCnTaBToUcV311yQ1kpnA@mail.gmail.com>
References: <CAFdqCxvgQwjneO0-4PstY1iYUWRL9nVOROvSqSqWKb2etL-_ng@mail.gmail.com>
	<586A4828D7AAA04CA9B258C50A28DA200BF58EF4@BALI.uhd.campus>
	<CAFdqCxuQZVXwUHLgAcYKqj32+=t+cuCnTaBToUcV311yQ1kpnA@mail.gmail.com>
Message-ID: <4F5F2BC9.8010807@gmail.com>

Hi Advait,

if you want to keep all time properties, the package "timetools" may 
help you to do so.
This package defines the class "TimeIntervalDataFrame" which can be a 
good start to look at.

Best,

Vlad

-----
Vladislav Navel

SCAN
www.scan-datamining.com

Le 13/03/2012 11:03, Advait Godbole a ?crit :
> I want to run the analysis on hourly data, in the sense that I would like
> to retain the hourly resolution while still being able to identify seasonal
> variation and month-to-month (or week-to-week) trends. I am not sure
> whether I am being clear in a mathematical sense, or if the above is
> possible - please excuse, I am new to time series.
>
> Thanks!
> advait
>
> On Tue, Mar 13, 2012 at 3:22 PM, Hodgess, Erin<HodgessE at uhd.edu>  wrote:
>
>> **
>>
>> Do you want to run the analysis on the hourly data or some aggregate of
>> it, please?
>>
>> thanks,
>> erin
>>
>>
>> Erin M. Hodgess, PhD
>> Associate Professor
>> Department of Computer and Mathematical Sciences
>> University of Houston - Downtown
>> mailto: hodgesse at uhd.edu
>>
>>
>>
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org on behalf of Advait Godbole
>> Sent: Tue 3/13/2012 4:41 AM
>> To: r-sig-geo at r-project.org
>> Subject: [R-sig-Geo] hourly time series
>>
>> Dear all,
>>
>> I have one year's worth of hourly data, starting from 1st April 2010 and
>> ending on 31st March 2011. I would like to perform time series analysis on
>> it. Not having used "ts" before, I am having trouble setting it up to
>> correctly represent the data. I have R reading in the time series via:
>> *wind_ts<- ts(wind.MH,start=1,frequency=1)*
>>
>>
>> where "wind.MH" is a 8760x1 matrix object. I then tried to decompose the
>> time series with the following error:
>> *wind_ts_components<- decompose(wind_ts)*
>> *Error in decompose(wind_ts) : time series has no or less than 2 periods*
>>
>>
>> The dataset is the hourly wind generation for Maharashtra, India and has
>> some seasonality associated with the Indian monsoon. Ultimately, this is
>> what I would like to identify. I imagine that correctly setting the "start"
>> and "frequency" parameters is necessary to be able to parse the dataset
>>   into months and seasons.
>>
>> I would greatly appreciate help on how to handle this and any leads on time
>> series analysis for hourly data in general.
>>
>> Regards,
>> --
>> advait godbole
>> analyst, prayas energy group
>> pune, india
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>


From jjcabrera20 at yahoo.com.mx  Tue Mar 13 12:27:58 2012
From: jjcabrera20 at yahoo.com.mx (jjcabrera20)
Date: Tue, 13 Mar 2012 04:27:58 -0700 (PDT)
Subject: [R-sig-Geo] Looping though pixels in a SpatialGridDataFrame
In-Reply-To: <CAGfc75=25JC_i9LD4rUtJbK2pOJ0h1AL99etL4M7cRXVuZkuuQ@mail.gmail.com>
References: <1324422003.7287.YahooMailNeo@web160606.mail.bf1.yahoo.com>
	<CAGfc75=25JC_i9LD4rUtJbK2pOJ0h1AL99etL4M7cRXVuZkuuQ@mail.gmail.com>
Message-ID: <1331638078726-7368151.post@n2.nabble.com>

Thanks friend you saved a life, I will take a look on this and If I have
further questions I will refer to you

Jorge

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Looping-though-pixels-in-a-SpatialGridDataFrame-tp7113586p7368151.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jjcabrera20 at yahoo.com.mx  Tue Mar 13 12:41:05 2012
From: jjcabrera20 at yahoo.com.mx (jjcabrera20)
Date: Tue, 13 Mar 2012 04:41:05 -0700 (PDT)
Subject: [R-sig-Geo] Convert a Matrix into a SpatialGridDataFrame
In-Reply-To: <1331635336363-7368054.post@n2.nabble.com>
References: <1331635336363-7368054.post@n2.nabble.com>
Message-ID: <1331638865286-7368191.post@n2.nabble.com>

Found this, but still I need to convert this into a SpatialGridDataFrame.
*NewRaster<-raster(Matrix, xmn=167620, xmx=171745, ymn=443660, ymx=448110,
crs=OriginalSpatialGridDataFrame at proj4string)*

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Convert-a-Matrix-into-a-SpatialGridDataFrame-tp7368054p7368191.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zua3 at cornell.edu  Tue Mar 13 14:25:32 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Tue, 13 Mar 2012 09:25:32 -0400
Subject: [R-sig-Geo] Asking Help again: Re: Help: Create several ESRI Shape
 files in a Loop
In-Reply-To: <CACSWb41Bch00KW9eOi8_f1+yzQsesc9Ax2vg+c=Eyyokm5AK2Q@mail.gmail.com>
References: <CB7A19E0.8D619%macqueen1@llnl.gov>
	<4F54E2AC.6040707@uni-muenster.de> <4F5DFFBD.2040601@cornell.edu>
	<CACSWb41eP1AEX+5GcaHq3P-VzsY6TQEgh8LtV6kn4OwQ5rC2hQ@mail.gmail.com>
	<CACSWb41Bch00KW9eOi8_f1+yzQsesc9Ax2vg+c=Eyyokm5AK2Q@mail.gmail.com>
Message-ID: <4F5F4ACC.8030102@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/eeebd368/attachment.pl>

From martijn.smit at vu.nl  Tue Mar 13 17:24:07 2012
From: martijn.smit at vu.nl (Smit, M.J.)
Date: Tue, 13 Mar 2012 16:24:07 +0000
Subject: [R-sig-Geo] Predict leads to 'non-conformable arguments'
Message-ID: <FBA2943645E7EA43A9ED44966DBAB9E508FDDAA4@PEXMB001A.vu.local>

Dear list,

I'm trying to do a scenario analysis by changing a few values in the dataset, and running 'predict' from spdep both before and after. However, I get 'non-comformable arguments', even when I just add the old dataset as 'newdata='. What is happening?

My lagsarlm runs fine; so does the first prediction ("pred1"). It is the second one that fails.
A sample of my code:
dat2 <- data.frame(NUTS_ID,COUNTRY,SPEND,<and 20 other variables> )
wgdist2 <- mat2listw(matgdist,dat2$NUTS_ID)
durbland <- lagsarlm(form_land,dat2,wgdist2,type="mixed")
summary(durbland)
pred1 <- predict(durbland,NULL,wgdist2,zero.policy=TRUE)
pred2 <- predict(durbland,dat2,wgdist2,zero.policy=TRUE) # Note this fails, although the data is identical.

... and the last command always gets me 
Error in X %*% B : non-conformable arguments

even before I get to executing
dat2$SPEND[dat2$COUNTRY=="PL"] <- dat2$SPEND[dat2$COUNTRY=="PL"]*2

Best regards, 
Martijn


From dprosser at usgs.gov  Tue Mar 13 20:13:01 2012
From: dprosser at usgs.gov (Diann J Prosser)
Date: Tue, 13 Mar 2012 15:13:01 -0400
Subject: [R-sig-Geo] apply monte carlo simulation for each cell in a
 matrix (originally raster)
In-Reply-To: <CANtt_hyvH--Lc2NpsPTyo1b_S+srdydidGgfVxpks7RuJsxO0A@mail.gmail.com>
References: <1331593061937-7367094.post@n2.nabble.com>	<1331616618036-7367555.post@n2.nabble.com>
	<CANtt_hy_Ymsg7OZqXmqkt3x3UWOdEhj61J=VKXFOubfRH3OnLA@mail.gmail.com>	<OF7059575D.73DA3933-ON852579C0.002363B6-852579C0.0023BAEF@LocalDomain>
	<OFC1853C64.37C4DDC1-ON852579C0.0029344C-852579C0.002A793E@usgs.gov>
	<CANtt_hyvH--Lc2NpsPTyo1b_S+srdydidGgfVxpks7RuJsxO0A@mail.gmail.com>
Message-ID: <OF207D2B60.17969570-ON852579C0.0066CB12-852579C0.00699029@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120313/e51cd9ee/attachment.pl>

From Roger.Bivand at nhh.no  Wed Mar 14 07:37:56 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2012 07:37:56 +0100 (CET)
Subject: [R-sig-Geo] Predict leads to 'non-conformable arguments'
In-Reply-To: <FBA2943645E7EA43A9ED44966DBAB9E508FDDAA4@PEXMB001A.vu.local>
References: <FBA2943645E7EA43A9ED44966DBAB9E508FDDAA4@PEXMB001A.vu.local>
Message-ID: <alpine.LRH.2.02.1203140735570.6255@reclus.nhh.no>

On Tue, 13 Mar 2012, Smit, M.J. wrote:

> Dear list,
>
> I'm trying to do a scenario analysis by changing a few values in the 
> dataset, and running 'predict' from spdep both before and after. 
> However, I get 'non-comformable arguments', even when I just add the old 
> dataset as 'newdata='. What is happening?

Please do provide reproducible cases. This isn't, as you neither use built 
in data, nor a link to your own data.

Also always name arguments to functions as this disambiguates the calls, 
and avoids helpers having to look the arguments up.

Roger

>
> My lagsarlm runs fine; so does the first prediction ("pred1"). It is the second one that fails.
> A sample of my code:
> dat2 <- data.frame(NUTS_ID,COUNTRY,SPEND,<and 20 other variables> )
> wgdist2 <- mat2listw(matgdist,dat2$NUTS_ID)
> durbland <- lagsarlm(form_land,dat2,wgdist2,type="mixed")
> summary(durbland)
> pred1 <- predict(durbland,NULL,wgdist2,zero.policy=TRUE)
> pred2 <- predict(durbland,dat2,wgdist2,zero.policy=TRUE) # Note this fails, although the data is identical.
>
> ... and the last command always gets me
> Error in X %*% B : non-conformable arguments
>
> even before I get to executing
> dat2$SPEND[dat2$COUNTRY=="PL"] <- dat2$SPEND[dat2$COUNTRY=="PL"]*2
>
> Best regards,
> Martijn
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Wed Mar 14 09:05:27 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Mar 2012 09:05:27 +0100
Subject: [R-sig-Geo] One lot <-> several owners : how to duplicate
	geometries?
Message-ID: <CAGfc75knaqvk_juaeSB_Eq2kyk_dbt+7FcwH7wnAak_iB2kgGg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/d156ce92/attachment.pl>

From tomte.tumetot at gmx.ch  Wed Mar 14 11:47:25 2012
From: tomte.tumetot at gmx.ch (Thomas Hoffmann)
Date: Wed, 14 Mar 2012 11:47:25 +0100
Subject: [R-sig-Geo] Plot variogramm in multi figure environment
Message-ID: <20120314104725.159040@gmx.net>

Dear all,


I calculated  variogramms and tried to plot them in a multi-figure environment. However, only the last plot appears in a single plot: 

cd30.vario = variogram(c30~1, gw.cal)
cd30.v.fit = fit.variogram(cd30.vario, vgm(0.01,"Sph",800,0.1))

cc30.vario = variogram(toc30~1, gw.cal)
cc30.v.fit = fit.variogram(cc30.vario, vgm(0.1,"Sph",1000,0.6))


par(mfrow=c(2,2))
plot(cc30.vario,cc30.v.fit)
abline(h=0.1,v=800)
plot(cf30.vario,cf30.v.fit)

Does anbody no way, and how to solve the problem

Kind regards
Thomas

-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From tom.gottfried at tum.de  Wed Mar 14 12:18:59 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 14 Mar 2012 12:18:59 +0100
Subject: [R-sig-Geo] Plot variogramm in multi figure environment
In-Reply-To: <20120314104725.159040@gmx.net>
References: <20120314104725.159040@gmx.net>
Message-ID: <4F607EA3.3000804@tum.de>

Hi,

the plot method for gstatVariogram is build on lattice, which is not compatible with base graphics 
functionality such as `par(mfrow=c(2,2))'.

I think you could use `print(plot(cd30.vario))' and with some extra arguments to print you should be 
able to set up a multi figure environment as with `par(mfrow=c(2,2))'. Have a look at ?print.trellis.

HTH,
Tom

Am 14.03.2012 11:47, schrieb Thomas Hoffmann:
> Dear all,
>
>
> I calculated  variogramms and tried to plot them in a multi-figure environment. However, only the last plot appears in a single plot:
>
> cd30.vario = variogram(c30~1, gw.cal)
> cd30.v.fit = fit.variogram(cd30.vario, vgm(0.01,"Sph",800,0.1))
>
> cc30.vario = variogram(toc30~1, gw.cal)
> cc30.v.fit = fit.variogram(cc30.vario, vgm(0.1,"Sph",1000,0.6))
>
>
> par(mfrow=c(2,2))
> plot(cc30.vario,cc30.v.fit)
> abline(h=0.1,v=800)
> plot(cf30.vario,cf30.v.fit)
>
> Does anbody no way, and how to solve the problem
>
> Kind regards
> Thomas
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From mathieu.rajerison at gmail.com  Wed Mar 14 15:38:44 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Mar 2012 15:38:44 +0100
Subject: [R-sig-Geo] One lot <-> several owners : how to duplicate
	geometries?
In-Reply-To: <CAGfc75knaqvk_juaeSB_Eq2kyk_dbt+7FcwH7wnAak_iB2kgGg@mail.gmail.com>
References: <CAGfc75knaqvk_juaeSB_Eq2kyk_dbt+7FcwH7wnAak_iB2kgGg@mail.gmail.com>
Message-ID: <CAGfc75m3YViB-_HmK6xzq7UB3_Z1rWyhgaDAc5ECeNexgnNi0Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/b6e8e1fc/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Mar 14 16:55:33 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Mar 2012 16:55:33 +0100
Subject: [R-sig-Geo] One lot <-> several owners : how to duplicate
	geometries?
In-Reply-To: <CAGfc75m3YViB-_HmK6xzq7UB3_Z1rWyhgaDAc5ECeNexgnNi0Q@mail.gmail.com>
References: <CAGfc75knaqvk_juaeSB_Eq2kyk_dbt+7FcwH7wnAak_iB2kgGg@mail.gmail.com>
	<CAGfc75m3YViB-_HmK6xzq7UB3_Z1rWyhgaDAc5ECeNexgnNi0Q@mail.gmail.com>
Message-ID: <CAGfc75=aLxCAfMz=-SzPhQv29CCTC7tBr2Paz8LpFiCqUDXgAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/b6186071/attachment.pl>

From a.mosnier at gmail.com  Wed Mar 14 17:14:58 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 14 Mar 2012 12:14:58 -0400
Subject: [R-sig-Geo] Convert netcdf file to a raster ...
Message-ID: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/4cd2ec1c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Mar 14 20:10:01 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 14 Mar 2012 19:10:01 +0000
Subject: [R-sig-Geo] Convert netcdf file to a raster ...
In-Reply-To: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>
References: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>
Message-ID: <CANVKczOpdrvzKdKqM2FJ+uoWo-GC7cgGLzscLDrk5pUKU+=YUQ@mail.gmail.com>

On Wed, Mar 14, 2012 at 4:14 PM, Arnaud Mosnier <a.mosnier at gmail.com> wrote:
> Hi all,
>
> I am trying to open a netCDF file (
> ftp://globcolour_data:fgh678 at ftp.acri.fr/GLOB_4KM/RAN/CHL1/MERGED/GSM/2007/DAILY/L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc.gz
> ).
>
> However, when I use the raster package to load it as a raster ...
>
> library(raster)
> test<-raster("D:\\temp\\testAQUATERRA\\rawtif\\L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc",
> varnam= "CHL1_mean")
>
> Error in .rasterObjectFromCDF(x, type = objecttype, band = band, ...) :
> ?CHL1_mean only has a single dimension; I cannot make a RasterLayer from
> this
>
>
> Here is the structure of the file ...
> Variable "CHL1_mean is linked to a bin, not XY coordinates
>
> library(ncdf)
> test<-open.ncdf("D:\\temp\\L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc")
> test
>
> [1] "file D:\\temp\\L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc has 2
> dimensions:"
> [1] "bin ? Size: 3308394"
> [1] "row ? Size: 3121"
> [1] "------------------------"
> [1] "file D:\\temp\\L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc has 8
> variables:"
> [1] "short col[bin] ?Longname:Longitudinal index of the bins stored in the
> product, zero based and beginning at west Missval:NA"
> [1] "float center_lat[row] ?Longname:Center latitude for each useful row
> Missval:1e+30"
> [1] "float center_lon[row] ?Longname:Center longitude of the first left bin
> (the first bin in the global ISIN grid, not the first valid bin) for each
> useful row Missval:1e+30"
> [1] "float lon_step[row] ?Longname:Longitude step for each useful row
> Missval:1e+30"
> [1] "float CHL1_mean[bin] ?Longname:Chlorophyll-a concentration. Case 1
> water - Mean of the binned pixels Missval:1e+30"
> [1] "short CHL1_count[bin] ?Longname:Chlorophyll-a concentration. Case 1
> water - Total number of binned pixels Missval:NA"
> [1] "short CHL1_flags[bin] ?Longname:Chlorophyll-a concentration. Case 1
> water - Flags Missval:NA"
> [1] "short CHL1_error[bin] ?Longname:Chlorophyll-a concentration. Case 1
> water - Error estimation Missval:NA"
>
> Is there a simple way to open this file directly as a raster ?

 There's nothing in it that is explicitly two-dimensional.  The list
of variables printed are all one-dimensional.

 The file has two 'dimensions': "bin" which is 3308394 long, and 'row'
which is 3121 long. Every other variable is one of those lengths long,
and one-dimensional.

 If there was a 2d grid in there you'd see something like:

[1] "file /data/rowlings/MapLibrary/World/Climate/CRUTEM3.nc has 4 dimensions:"
[1] "longitude   Size: 72"
[1] "latitude   Size: 36"
[1] "unspecified   Size: 1"
[1] "t   Size: 1925"
[1] "------------------------"
[1] "file /data/rowlings/MapLibrary/World/Climate/CRUTEM3.nc has 1 variables:"
[1] "float temp[longitude,latitude,unspecified,t]
Longname:Temperature T Missval:2.00000004008175e+20"

which is defining a 36x72x1x1925 grid (lon x lat x 1 x t).

 So I'm guessing that maybe some of those vectors are actually
unwrapped grids? Quite what their dimension is I don't know, since
3121 doesn't go into 3308394 exactly.

 You'll have to use the ncdf package to have a look at the variables
and see if you can make sense of them:

 > L = open.ncdf("L3b_20070615__GLOB_4_GSM-MERMODSWF_CHL1_DAY_00.nc")

 > get.var.ncdf(L,"lon_step",1,10)
 [1] 0.06079027 0.06073899 0.06069803 0.06064690 0.06059586 0.06055509
 [7] 0.06050420 0.06046356 0.06041282 0.06037230

Barry


From r.hijmans at gmail.com  Wed Mar 14 20:42:23 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Mar 2012 12:42:23 -0700
Subject: [R-sig-Geo] Convert netcdf file to a raster ...
In-Reply-To: <CANVKczOpdrvzKdKqM2FJ+uoWo-GC7cgGLzscLDrk5pUKU+=YUQ@mail.gmail.com>
References: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>
	<CANVKczOpdrvzKdKqM2FJ+uoWo-GC7cgGLzscLDrk5pUKU+=YUQ@mail.gmail.com>
Message-ID: <CANtt_hxSyW4H_kuBp1hYWmX4Bwhkgkj-dKuBYBKyEiGz=LkNNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/aed11761/attachment.pl>

From a.mosnier at gmail.com  Wed Mar 14 20:51:29 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 14 Mar 2012 15:51:29 -0400
Subject: [R-sig-Geo] Convert netcdf file to a raster ...
In-Reply-To: <CANtt_hxSyW4H_kuBp1hYWmX4Bwhkgkj-dKuBYBKyEiGz=LkNNg@mail.gmail.com>
References: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>
	<CANVKczOpdrvzKdKqM2FJ+uoWo-GC7cgGLzscLDrk5pUKU+=YUQ@mail.gmail.com>
	<CANtt_hxSyW4H_kuBp1hYWmX4Bwhkgkj-dKuBYBKyEiGz=LkNNg@mail.gmail.com>
Message-ID: <CANkFkEfZCc6UBgksyDR9bNna5xoDWBQZGacj_4-4jOpofKTG+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/88777674/attachment.pl>

From a.mosnier at gmail.com  Wed Mar 14 20:56:11 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 14 Mar 2012 15:56:11 -0400
Subject: [R-sig-Geo] Convert netcdf file to a raster ...
In-Reply-To: <CANtt_hxSyW4H_kuBp1hYWmX4Bwhkgkj-dKuBYBKyEiGz=LkNNg@mail.gmail.com>
References: <CANkFkEeESzCt53fbr+dOaVSP=egh4=-ux+UBAVcP42z6QT6H3A@mail.gmail.com>
	<CANVKczOpdrvzKdKqM2FJ+uoWo-GC7cgGLzscLDrk5pUKU+=YUQ@mail.gmail.com>
	<CANtt_hxSyW4H_kuBp1hYWmX4Bwhkgkj-dKuBYBKyEiGz=LkNNg@mail.gmail.com>
Message-ID: <CANkFkEdouQ6evW1HqEOCKR2e0c34NjQ4kxivP9xK=uD=CjnxgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/5a77e237/attachment.pl>

From r.hijmans at gmail.com  Wed Mar 14 20:57:52 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Mar 2012 12:57:52 -0700
Subject: [R-sig-Geo] Convert a Matrix into a SpatialGridDataFrame
In-Reply-To: <1331638865286-7368191.post@n2.nabble.com>
References: <1331635336363-7368054.post@n2.nabble.com>
	<1331638865286-7368191.post@n2.nabble.com>
Message-ID: <CANtt_hyQF19UancGtWOsMiBHJnHTWwH5dbTJdeOHYzbbQYSNQw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120314/c15d9a55/attachment.pl>

From Roger.Bivand at nhh.no  Wed Mar 14 21:42:44 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2012 21:42:44 +0100 (CET)
Subject: [R-sig-Geo] Predict leads to 'non-conformable arguments'
In-Reply-To: <alpine.LRH.2.02.1203140735570.6255@reclus.nhh.no>
References: <FBA2943645E7EA43A9ED44966DBAB9E508FDDAA4@PEXMB001A.vu.local>
	<alpine.LRH.2.02.1203140735570.6255@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1203142140090.8059@reclus.nhh.no>

On Wed, 14 Mar 2012, Roger Bivand wrote:

> On Tue, 13 Mar 2012, Smit, M.J. wrote:
>
>> Dear list,
>> 
>> I'm trying to do a scenario analysis by changing a few values in the 
>> dataset, and running 'predict' from spdep both before and after. However, I 
>> get 'non-comformable arguments', even when I just add the old dataset as 
>> 'newdata='. What is happening?
>
> Please do provide reproducible cases. This isn't, as you neither use built in 
> data, nor a link to your own data.
>
> Also always name arguments to functions as this disambiguates the calls, and 
> avoids helpers having to look the arguments up.

This may or may not be the case in question:

library(spdep)
data(boston)
gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + I(RM^2)
  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT) + TOWN,
  data=boston.c, nb2listw(boston.soi), method="eigen", tol.solve=1e-12)
p2 <- predict(gp2, newdata=boston.c, listw=nb2listw(boston.soi))
# Error in X %*% B : non-conformable arguments
summary(gp2) # NA coefficients

because predict() assumed that the user checked the model fit for 
aliasing. A fix for predict() will be in the next spdep, but users really 
should check that fitted coefficients are not aliased by colinearity.

Roger


>
> Roger
>
>> 
>> My lagsarlm runs fine; so does the first prediction ("pred1"). It is the 
>> second one that fails.
>> A sample of my code:
>> dat2 <- data.frame(NUTS_ID,COUNTRY,SPEND,<and 20 other variables> )
>> wgdist2 <- mat2listw(matgdist,dat2$NUTS_ID)
>> durbland <- lagsarlm(form_land,dat2,wgdist2,type="mixed")
>> summary(durbland)
>> pred1 <- predict(durbland,NULL,wgdist2,zero.policy=TRUE)
>> pred2 <- predict(durbland,dat2,wgdist2,zero.policy=TRUE) # Note this fails, 
>> although the data is identical.
>> 
>> ... and the last command always gets me
>> Error in X %*% B : non-conformable arguments
>> 
>> even before I get to executing
>> dat2$SPEND[dat2$COUNTRY=="PL"] <- dat2$SPEND[dat2$COUNTRY=="PL"]*2
>> 
>> Best regards,
>> Martijn
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From thi_veloso at yahoo.com.br  Thu Mar 15 03:34:08 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 14 Mar 2012 19:34:08 -0700
Subject: [R-sig-Geo] Displaying temporal variation of raster data
Message-ID: <1331778848.6690.YahooMailClassic@web161401.mail.bf1.yahoo.com>

 Dear R colleagues,

 I have a netcdf file containing ten time slices, where each slice corresponds to yearly deforestation rates over the Amazon forest. Values range from 0 (no deforest) to 1 (maximum deforest). Please take a look in a sample of the data: http://imageshack.us/photo/my-images/23/deforestamazon.png/

 My objective is to show the temporal variation of this data. How can I produce categorical histograms for each one of the ten years? What I have in mind is something like the lower panel of this figure: http://www.crwr.utexas.edu/gis/gishydro05/Time/DHI_Temporal_Analyst/TemporalAnalystForArcGIS.htm, but plotting bars relative to three or four classes of deforesting rates instead of lines.

 Is it possible to produce such a figure using any SIG-related R package?

 Many thanks in advance,
 Thiago.



From ashenkin at ufl.edu  Thu Mar 15 06:08:44 2012
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Thu, 15 Mar 2012 01:08:44 -0400
Subject: [R-sig-Geo] Which points fall in which polygons?
Message-ID: <4F61795C.7080107@ufl.edu>

Hello folks,

I have two data sources: an ESRI shapefile (UTM/WGS84 projection) of
numerous polygons, each of which have one of two values (burned [=1] and
unburned [=2]); and a set of X/Y distances from the corner of the
polygon that represent tree locations.  I'd like to tag each X/Y point
in the set with the value of the polygon within which it falls (i.e.
whether that tree burned or not).

I've read the polygons in with rgdal, but I'm not sure where to go from
there.  I'm not sure which functions from which packages apply to rgdal
objects, etc.  I've looked at the rgdal manual, but I don't understand
how to manipulate the objects once i have them in R (e.g. how to perform
intersections and the like).  Any help would be greatly appreciated!

Thanks,
Alex


From j.m.signer at gmail.com  Thu Mar 15 06:19:54 2012
From: j.m.signer at gmail.com (Johannes Signer)
Date: Thu, 15 Mar 2012 06:19:54 +0100
Subject: [R-sig-Geo] Which points fall in which polygons?
In-Reply-To: <4F61795C.7080107@ufl.edu>
References: <4F61795C.7080107@ufl.edu>
Message-ID: <CAC8qavudk3RWFgAStv_mG0k51bn+MNvvV8cJW5tjx4FnUS+Smw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/08eb9d58/attachment.pl>

From ashenkin at ufl.edu  Thu Mar 15 06:32:43 2012
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Thu, 15 Mar 2012 01:32:43 -0400
Subject: [R-sig-Geo] Which points fall in which polygons?
In-Reply-To: <CAC8qavudk3RWFgAStv_mG0k51bn+MNvvV8cJW5tjx4FnUS+Smw@mail.gmail.com>
References: <4F61795C.7080107@ufl.edu>
	<CAC8qavudk3RWFgAStv_mG0k51bn+MNvvV8cJW5tjx4FnUS+Smw@mail.gmail.com>
Message-ID: <4F617EFB.6030500@ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/ae79311a/attachment.pl>

From j.m.signer at gmail.com  Thu Mar 15 06:56:22 2012
From: j.m.signer at gmail.com (Johannes Signer)
Date: Thu, 15 Mar 2012 06:56:22 +0100
Subject: [R-sig-Geo] Which points fall in which polygons?
In-Reply-To: <4F617EFB.6030500@ufl.edu>
References: <4F61795C.7080107@ufl.edu>
	<CAC8qavudk3RWFgAStv_mG0k51bn+MNvvV8cJW5tjx4FnUS+Smw@mail.gmail.com>
	<4F617EFB.6030500@ufl.edu>
Message-ID: <CAC8qavvoCUx-FMnvidVesw6CbRmSyyFyiuYE5feExzzCnZrXLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/6ba3da0e/attachment.pl>

From janverbesselt at gmail.com  Thu Mar 15 09:03:01 2012
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Thu, 15 Mar 2012 09:03:01 +0100
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331778848.6690.YahooMailClassic@web161401.mail.bf1.yahoo.com>
References: <1331778848.6690.YahooMailClassic@web161401.mail.bf1.yahoo.com>
Message-ID: <6CAF17F7-5B05-495D-981C-B7EB24BD3E1F@gmail.com>

Hi Thiago,

yes, certainly. Without an R script or data is it not so easy to help you. Here are some tips and packages which might be helpful:

- raster package; reading netcdf files
- use getValues() from the raster package to extract the data
- ggplot2 package for creating great graphs
- see http://had.co.nz/ggplot2/geom_bar.html for categorical histogram examples.
- maybe melt() of the ggplot2 package might be handy to prepare your data set.

A very simple example:
library(raster) 
library(ggplot2)
m <- matrix(1:100, nr=10)
n <- matrix(c(rep(1,30),rep(2,70)), nr=10)
r <- raster(m, xmn=167620, xmx=171745, ymn=443660, ymx=448110) 
deforest <- raster(n, xmn=167620, xmx=171745, ymn=443660, ymx=448110)
df <- data.frame(rate=getValues(r), class=getValues(deforest))
ggplot(df, aes(x=factor(class), fill=factor(class))) + geom_bar()


Cheers,
Jan

On 15/03/2012, at 3:34 AM, Thiago Veloso wrote:

> Dear R colleagues,
> 
> I have a netcdf file containing ten time slices, where each slice corresponds to yearly deforestation rates over the Amazon forest. Values range from 0 (no deforest) to 1 (maximum deforest). Please take a look in a sample of the data: http://imageshack.us/photo/my-images/23/deforestamazon.png/
> 
> My objective is to show the temporal variation of this data. How can I produce categorical histograms for each one of the ten years? What I have in mind is something like the lower panel of this figure: http://www.crwr.utexas.edu/gis/gishydro05/Time/DHI_Temporal_Analyst/TemporalAnalystForArcGIS.htm, but plotting bars relative to three or four classes of deforesting rates instead of lines.
> 
> Is it possible to produce such a figure using any SIG-related R package?
> 
> Many thanks in advance,
> Thiago.
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.m.krug at gmail.com  Thu Mar 15 09:41:01 2012
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Thu, 15 Mar 2012 09:41:01 +0100
Subject: [R-sig-Geo] Convert a Matrix into a SpatialGridDataFrame
In-Reply-To: <1331635336363-7368054.post@n2.nabble.com>
References: <1331635336363-7368054.post@n2.nabble.com>
Message-ID: <4F61AB1D.4050309@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/03/12 11:42, jjcabrera20 wrote:
> Hello everybody there!! Maybe a silly question but for doing some manipulation on values of a 
> SpatialGridDataFrame I transformed it into a matrix like this *Matrix<-
> as.matrix(SpatialGridDataFrame)* now I want to go back and turn the matrix again into
> SpatialGridDataFrame, but I can't find the way. The matrix is still the same (number of rows
> and columns, grid size, projection) as the original.

Try the following:
# sgdf: SpatialGridDataFrame with one layer

mtr <- as.matrix(sgdf)

# do something with mtr

sgdf at data[[2]] <- as.vector(mtr)

then

the second layer in sgdf is your matrix

Cheers,

Rainer

> 
> Thanks
> 
> Jorge
> 
> -- View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Convert-a-Matrix-into-a-SpatialGridDataFrame-tp7368054p7368054.html
>
> 
Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________ R-sig-Geo mailing list R-sig-Geo at r-project.org 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys.
(Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk9hqx0ACgkQoYgNqgF2egpitgCfWTFeZvPC5Bp+lev+yWJXm/vL
gb8An2x8lbh/Fg0sjkQxsxh8t56eEiJF
=V4nu
-----END PGP SIGNATURE-----


From b.rowlingson at lancaster.ac.uk  Thu Mar 15 09:56:00 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 15 Mar 2012 08:56:00 +0000
Subject: [R-sig-Geo] Which points fall in which polygons?
In-Reply-To: <4F61795C.7080107@ufl.edu>
References: <4F61795C.7080107@ufl.edu>
Message-ID: <CANVKczM6Dmo6M66HBvVCeibksRbDKSk7Y4nUHq2Qn6vBZ2XNBQ@mail.gmail.com>

On Thu, Mar 15, 2012 at 5:08 AM, Alexander Shenkin <ashenkin at ufl.edu> wrote:
> Hello folks,

> I've read the polygons in with rgdal, but I'm not sure where to go from
> there. ?I'm not sure which functions from which packages apply to rgdal
> objects, etc. ?I've looked at the rgdal manual, but I don't understand
> how to manipulate the objects once i have them in R (e.g. how to perform
> intersections and the like). ?Any help would be greatly appreciated!
>

 You might also want to get the rgeos package which does all those
wonderful classic GIS operations like buffering and intersection.
Point-in-polygon overlay is done by over(), but rgeos also has an
implementation and far more.

 Read the R Spatial Task View for more. Shameless link to my funky
TaskView index page:
http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/

Barry


From oscar.perpinan at upm.es  Thu Mar 15 11:56:14 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 15 Mar 2012 11:56:14 +0100
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331778848.6690.YahooMailClassic@web161401.mail.bf1.yahoo.com>
	(Thiago Veloso's message of "Wed, 14 Mar 2012 19:34:08 -0700")
References: <1331778848.6690.YahooMailClassic@web161401.mail.bf1.yahoo.com>
Message-ID: <87aa3i2kvl.fsf@upm.es>

Thiago Veloso <thi_veloso at yahoo.com.br> writes:

>  Dear R colleagues,
>
>  I have a netcdf file containing ten time slices, where each slice corresponds to yearly deforestation rates over the Amazon forest. Values range from 0 (no deforest) to 1 (maximum deforest). Please take a look in a sample of the data: http://imageshack.us/photo/my-images/23/deforestamazon.png/
>
>  My objective is to show the temporal variation of this data. How can I produce categorical histograms for each one of the ten years? What I have in mind is something like the lower panel of this figure: http://www.crwr.utexas.edu/gis/gishydro05/Time/DHI_Temporal_Analyst/TemporalAnalystForArcGIS.htm, but plotting bars relative to three or four classes of deforesting rates instead of lines.
>
>  Is it possible to produce such a figure using any SIG-related R package?
Hello,

The combination of 'setZ' from raster with 'histogram' (or 'densityplot') from
rasterVis is a suitable solution:

library(raster)
library(rasterVis)

r <- raster(ncol=10, nrow=10)
s <- stack(lapply(1:12, function(x)setValues(r, runif(ncell(r)))))
idx <- seq(as.Date('2000-01-15'), length.out=12, by='month')
s <- setZ(s, idx)
layerNames(s) <- format(idx, '%b') 
s

histogram(s)
densityplot(s)

And if you use 'zoo':

library(zoo)
histogram(s, FUN=as.yearqtr)
densityplot(s, FUN=as.yearqtr)

Best,

Oscar.

-- 
Oscar Perpi??n Lamigueiro
Dpto. de Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From lm609 at york.ac.uk  Thu Mar 15 14:56:18 2012
From: lm609 at york.ac.uk (Louise Mair)
Date: Thu, 15 Mar 2012 13:56:18 +0000
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
Message-ID: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/8a6fec92/attachment.pl>

From basille at ase-research.org  Thu Mar 15 15:11:37 2012
From: basille at ase-research.org (Mathieu Basille)
Date: Thu, 15 Mar 2012 10:11:37 -0400
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
In-Reply-To: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
Message-ID: <4F61F899.20001@ase-research.org>

Dear Louise,

I think there is a couple of possibilities. You might be interested in 
clusthr, LoCoH.* and CharHull, also in the package adehabitatHR. Please 
check the vignette of the package, section 6:

vignette("adehabitatHR")

In addition, a new estimator could be useful to you as well: the PPA home 
range [1]. A R function based on ltraj objects (adehabitatLT) is available 
here: http://www.geog.uvic.ca/spar/PPAHomeRange/index.html

Hope this helps,
Mathieu.


[1] Jed A. Long and Trisalyn A. Nelson. 2012. Time geography and wildlife 
home range delineation.  The Journal of Wildlife Management, 76: 407?413. 
DOI: 10.1002/jwmg.259
http://onlinelibrary.wiley.com/doi/10.1002/jwmg.259/abstract



Le 15/03/2012 09:56, Louise Mair a ?crit :
> Hello,
>
> I have a distribution dataset for species consisting of xy coordinates at
> the 1km resolution, with only presence data. So a simplified example of a
> species distribution might be:
>
> y<- rbind(as.integer(rnorm(100,50,20)), as.integer(rnorm(200,100,30)),
> as.integer(rnorm(100,180,15)))
> x<- rbind(as.integer(rnorm(200,50,20)), as.integer(rnorm(200,100,20)),
> as.integer(rnorm(100,200,15)))
> plot(y~x)
>
> I would like to create polygons for each species distribution, where if an
> island is present (as I have tried to show in the example), it would be a
> seperate polygon, and the jagged edges where species distributions meet
> coastlines etc are maintained. I have tried functions such as mcp in the
> package adehabitat, but this produces a very coarse polygon, which doesn't
> provide the detailed distribution edges that I need. Other functions I've
> tried require the data already to be in the format where the only xy
> coordinates present are the outline of the polygon.
>
> Can anyone please recommend a function I can use here, or suggest a way of
> extracting the outline points? I have tried this manually but cannot seem
> to write a code that will effectively take account of jagged edges and
> islands.
>
> Thanks very much for your help,
>
> Louise.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From camille.leclerc at ymail.com  Thu Mar 15 16:27:39 2012
From: camille.leclerc at ymail.com (Camille Leclerc)
Date: Thu, 15 Mar 2012 08:27:39 -0700 (PDT)
Subject: [R-sig-Geo] Problem with rasterFromXYZ
Message-ID: <1331825259157-7375920.post@n2.nabble.com>

Hi everybody,

I have a problem with the function "rasterFromXYZ". I have a matrix which
contain, on each rows, x/y coordinates and a z value (for me it's called
DM). And so I used "rasterFromXYZ" function to create a RasterLayer but when
I used this function I had an error message : "y cell size are not regular".
I don't understand my mistake because I've used this function and everything
was OK.

Thank you very much for all help,
Camille

An excerpt from my script :
My matrix (whc.global.obj) which contain x,y,z data

dfbiocfid	dfbiocfy	dfbiocfx      DM
1	        -10.75000  142.5833    204.00917
2	        -10.91667  142.4167    192.94587
3	        -10.91667  142.5833    195.98638
4               -11.08333 132.5833    50.87249
5               -11.08333 142.2500    164.30234
6                ...

xyz<-cbind(whc.global.obj[,3],whc.global.obj[,2],whc.global.obj[,4])
whc<-rasterFromXYZ(xyz)

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Problem-with-rasterFromXYZ-tp7375920p7375920.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From camille.leclerc at ymail.com  Thu Mar 15 16:33:59 2012
From: camille.leclerc at ymail.com (Camille Leclerc)
Date: Thu, 15 Mar 2012 15:33:59 +0000 (GMT)
Subject: [R-sig-Geo] Problem with rasterFromXYZ
Message-ID: <1331825639.86937.YahooMailNeo@web132104.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/3251fc88/attachment.pl>

From afischbach at usgs.gov  Thu Mar 15 16:40:58 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Thu, 15 Mar 2012 08:40:58 -0700 (PDT)
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
In-Reply-To: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
Message-ID: <1331826058815-7375974.post@n2.nabble.com>

Generalizing animal distributions adjacent to habitat boundaries is
problematic.
You may wish to consider functions available in adehabitatHR for the biased
random bridge and classic kernel utilization distribution algorithms that
offer an elegant solution to this problem.  I have found these appealing,
yet not applicable to my study species due to coastline compexities (islands
that are small relative to the kernel smoothing factor and coastal
segmements that form angles too accute for the functions to handle).  I
resorted to excluding non-habitat from the utilization distribution.  Here
is the post thread 
http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6497315.html
...adehabitatHR: class estUDm exclusion of non-habitat pixels...  whereby
r-sig-geo contributors provided a solution for this exclusion.  

HTH -

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Extracting-minimum-convex-polygons-of-species-distributions-tp7375692p7375974.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jaimebg27 at gmail.com  Thu Mar 15 16:56:45 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Thu, 15 Mar 2012 10:56:45 -0500
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
In-Reply-To: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
Message-ID: <CADiqS85fL-PNqp6o6fEp7jg_W9T=YVZG0w_m0Bi2a7pSiLTw5Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/1f0e00b7/attachment.pl>

From jaimebg27 at gmail.com  Thu Mar 15 16:58:44 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Thu, 15 Mar 2012 10:58:44 -0500
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
In-Reply-To: <CADiqS85fL-PNqp6o6fEp7jg_W9T=YVZG0w_m0Bi2a7pSiLTw5Q@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
	<CADiqS85fL-PNqp6o6fEp7jg_W9T=YVZG0w_m0Bi2a7pSiLTw5Q@mail.gmail.com>
Message-ID: <CADiqS86TDYtwsiZKq58yt9HtoY=NHBZxAxg20Rab2fweZ=zvWg@mail.gmail.com>

The script....

2012/3/15 Jaime Burbano Gir?n <jaimebg27 at gmail.com>

> Hi Louise, I have calculated minimum convex polygons with "calc_mcp"
> function from package "aspace", but I think this function is not longer
> available, so I attach my script using it, where the function is written.
>
> An other tool that I have used is the Hawth's Analysis Tools extension for
> ArcGIS: http://www.spatialecology.com/htools/tooldesc.php
>
> Cheers...
>
>
> On Thu, Mar 15, 2012 at 8:56 AM, Louise Mair <lm609 at york.ac.uk> wrote:
>
>> Hello,
>>
>> I have a distribution dataset for species consisting of xy coordinates at
>> the 1km resolution, with only presence data. So a simplified example of a
>> species distribution might be:
>>
>> y <- rbind(as.integer(rnorm(100,50,20)), as.integer(rnorm(200,100,30)),
>> as.integer(rnorm(100,180,15)))
>> x <- rbind(as.integer(rnorm(200,50,20)), as.integer(rnorm(200,100,20)),
>> as.integer(rnorm(100,200,15)))
>> plot(y~x)
>>
>> I would like to create polygons for each species distribution, where if an
>> island is present (as I have tried to show in the example), it would be a
>> seperate polygon, and the jagged edges where species distributions meet
>> coastlines etc are maintained. I have tried functions such as mcp in the
>> package adehabitat, but this produces a very coarse polygon, which doesn't
>> provide the detailed distribution edges that I need. Other functions I've
>> tried require the data already to be in the format where the only xy
>> coordinates present are the outline of the polygon.
>>
>> Can anyone please recommend a function I can use here, or suggest a way of
>> extracting the outline points? I have tried this manually but cannot seem
>> to write a code that will effectively take account of jagged edges and
>> islands.
>>
>> Thanks very much for your help,
>>
>> Louise.
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Jaime Burbano Gir?n
> Maestr?a en Ciencias Biol?gicas - Ecolog?a
> Universidad Nacional de Colombia
> Bogot? - Colombia
> (57) 3168573713
>



-- 
Jaime Burbano Gir?n
Maestr?a en Ciencias Biol?gicas - Ecolog?a
Universidad Nacional de Colombia
Bogot? - Colombia
(57) 3168573713
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/97e675f8/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: EOO.r
Type: application/octet-stream
Size: 3038 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/97e675f8/attachment.obj>

From thi_veloso at yahoo.com.br  Thu Mar 15 17:45:10 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 15 Mar 2012 09:45:10 -0700
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <6CAF17F7-5B05-495D-981C-B7EB24BD3E1F@gmail.com>
Message-ID: <1331829910.8325.YahooMailClassic@web161403.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/e4ef3385/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Mar 15 18:58:35 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 15 Mar 2012 17:58:35 +0000
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331829910.8325.YahooMailClassic@web161403.mail.bf1.yahoo.com>
References: <6CAF17F7-5B05-495D-981C-B7EB24BD3E1F@gmail.com>
	<1331829910.8325.YahooMailClassic@web161403.mail.bf1.yahoo.com>
Message-ID: <CANVKczNb=E7WenP5poR03S0ehK8wPcCvw+40tJ69mqyRSQc4OQ@mail.gmail.com>

On Thu, Mar 15, 2012 at 4:45 PM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
> ?Dear Jan (cc Oscar, who also gave a tip),
> ?Thanks for your input. Sorry for not stating my problem concisely. This time I have shared a simplified sample of my data: http://db.tt/XXDtRee1.
> ?Notice that this netcdf file contains three time dimensions - corresponding to years 2000 to 2002 (entire dataset contains ten). Also notice that values range from 0 to 1. As we can see in the file, each year is marked by different degrees of deforestation rates.
> ?Below is the code I am using to load the multi-band file:
>> library (raster)> deforest<-brick("/home/thiago/Dropbox/defor-3-years.nc"

 From there, I can go:

 > meltR=melt(as.array(deforest))
 > meltR$class=cut(meltR$value,c(0,0.3,0.6,1))
 > p = ggplot(meltR,aes(x=class))
 > p + geom_histogram(aes(fill=class))+facet_grid(~X3)

 And get a very pretty set of histograms. You need the ggplot package.

 You might want to get rid of the NA values - note that one of the
values in your data is greater than 1, contrary to what you said!

 > range(meltR$value,na.rm=TRUE)
 [1] 0.000006 1.000662

Barry


From thi_veloso at yahoo.com.br  Thu Mar 15 21:08:53 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 15 Mar 2012 13:08:53 -0700
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <CANVKczNb=E7WenP5poR03S0ehK8wPcCvw+40tJ69mqyRSQc4OQ@mail.gmail.com>
Message-ID: <1331842133.28182.YahooMailClassic@web161402.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/ffb278fc/attachment.pl>

From oscar.perpinan at upm.es  Thu Mar 15 21:23:54 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 15 Mar 2012 21:23:54 +0100
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <CANVKczNb=E7WenP5poR03S0ehK8wPcCvw+40tJ69mqyRSQc4OQ@mail.gmail.com>
	(Barry Rowlingson's message of "Thu, 15 Mar 2012 17:58:35 +0000")
References: <6CAF17F7-5B05-495D-981C-B7EB24BD3E1F@gmail.com>
	<1331829910.8325.YahooMailClassic@web161403.mail.bf1.yahoo.com>
	<CANVKczNb=E7WenP5poR03S0ehK8wPcCvw+40tJ69mqyRSQc4OQ@mail.gmail.com>
Message-ID: <87zkbhzk85.fsf@upm.es>

Barry Rowlingson <b.rowlingson at lancaster.ac.uk> writes:

> On Thu, Mar 15, 2012 at 4:45 PM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
>> ?Dear Jan (cc Oscar, who also gave a tip),
>> ?Thanks for your input. Sorry for not stating my problem concisely. This time I have shared a simplified sample of my data: http://db.tt/XXDtRee1.
>> ?Notice that this netcdf file contains three time dimensions - corresponding to years 2000 to 2002 (entire dataset contains ten). Also notice that values range from 0 to 1. As we can see in the file, each year is marked by different degrees of deforestation rates.
>> ?Below is the code I am using to load the multi-band file:
>>> library (raster)> deforest<-brick("/home/thiago/Dropbox/defor-3-years.nc"
>
>  From there, I can go:
>
>  > meltR=melt(as.array(deforest))
>  > meltR$class=cut(meltR$value,c(0,0.3,0.6,1))
>  > p = ggplot(meltR,aes(x=class))
>  > p + geom_histogram(aes(fill=class))+facet_grid(~X3)
>
>  And get a very pretty set of histograms. You need the ggplot package.

And for completeness, the lattice way ;-):

layerNames(deforest) <- as.character(2000:2002)

dat <- as.data.frame(deforest)
datLong <- stack(dat) ##wide to long

datLong$class <- cut(datLong$values, c(0, 0.3, 0.6, 1))
tt <- table(datLong$ind, datLong$class)

library(lattice)
barchart(tt, auto.key=list(space='right'), horizontal=FALSE, stack=FALSE)

You can even use the 'cut' method for 'Raster*':

defClass <- cut(deforest, c(0, 0.3, 0.6, 1))
dat <- stack(as.data.frame(defClass))
tt <- table(dat$ind, dat$values)
barchart(tt, auto.key=list(space='right'), horizontal=FALSE, stack=FALSE)

Best,

Oscar.
-- 
Oscar Perpi??n Lamigueiro
Dpto. de Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From rundel at gmail.com  Thu Mar 15 21:32:35 2012
From: rundel at gmail.com (Colin Rundel)
Date: Thu, 15 Mar 2012 16:32:35 -0400
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
	distributions
In-Reply-To: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
Message-ID: <ECD49860-D8C0-48A3-B9C7-F04EF5483C1D@gmail.com>

While I think it is somewhat simplistic for modeling a species' distribution you can use a convex hull to get a convex bounding polygon for your presence locations. This will not take into account islands but you can remove non-terristrial areas by getting an intersection of the bounding polygon with a coast line shapefile. You can look into gConvexHull and gIntersection in the rgeos package for implementations of these two operations.

I'm not sure what scale you're working with for the final boundaries but since the presence data is for 1 km grid cells you can take this into account using the raster package's rasterToPolygons function to create polygons which are then used to construct the convex hull.

-Colin


On Mar 15, 2012, at 9:56 AM, Louise Mair wrote:

> Hello,
> 
> I have a distribution dataset for species consisting of xy coordinates at
> the 1km resolution, with only presence data. So a simplified example of a
> species distribution might be:
> 
> y <- rbind(as.integer(rnorm(100,50,20)), as.integer(rnorm(200,100,30)),
> as.integer(rnorm(100,180,15)))
> x <- rbind(as.integer(rnorm(200,50,20)), as.integer(rnorm(200,100,20)),
> as.integer(rnorm(100,200,15)))
> plot(y~x)
> 
> I would like to create polygons for each species distribution, where if an
> island is present (as I have tried to show in the example), it would be a
> seperate polygon, and the jagged edges where species distributions meet
> coastlines etc are maintained. I have tried functions such as mcp in the
> package adehabitat, but this produces a very coarse polygon, which doesn't
> provide the detailed distribution edges that I need. Other functions I've
> tried require the data already to be in the format where the only xy
> coordinates present are the outline of the polygon.
> 
> Can anyone please recommend a function I can use here, or suggest a way of
> extracting the outline points? I have tried this manually but cannot seem
> to write a code that will effectively take account of jagged edges and
> islands.
> 
> Thanks very much for your help,
> 
> Louise.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From janverbesselt at gmail.com  Thu Mar 15 22:36:18 2012
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Thu, 15 Mar 2012 22:36:18 +0100
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331842133.28182.YahooMailClassic@web161402.mail.bf1.yahoo.com>
References: <CANVKczNb=E7WenP5poR03S0ehK8wPcCvw+40tJ69mqyRSQc4OQ@mail.gmail.com>
	<1331842133.28182.YahooMailClassic@web161402.mail.bf1.yahoo.com>
Message-ID: <CAHKDjo6CPRDFoPuvPr+EeC+uP-pU9ZOTs3u77usTct_tBV7vmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/7698efeb/attachment.pl>

From jonathan at mazamascience.com  Fri Mar 16 01:15:32 2012
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Thu, 15 Mar 2012 17:15:32 -0700
Subject: [R-sig-Geo] map projections with sp data
Message-ID: <CAPjNR=QBTJzV=xm1FfBT74DTsJLB4+fLho=yqb1RvqbYexYvWg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/cde9a3f9/attachment.pl>

From mdsumner at gmail.com  Fri Mar 16 01:28:27 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 16 Mar 2012 11:28:27 +1100
Subject: [R-sig-Geo] map projections with sp data
In-Reply-To: <CAPjNR=QBTJzV=xm1FfBT74DTsJLB4+fLho=yqb1RvqbYexYvWg@mail.gmail.com>
References: <CAPjNR=QBTJzV=xm1FfBT74DTsJLB4+fLho=yqb1RvqbYexYvWg@mail.gmail.com>
Message-ID: <CAAcGz9916p_UDv_A+Hxcm47JvZbGPusT2uu+c8L_ZNH1BYE0TQ@mail.gmail.com>

spTransform in the rgdal package will do this very simply. You just
need the source metadata set on the original object, and spTransform
handles the rest.

>From the help page:

require(rgdal)
scot_BNG <- readOGR(system.file("vectors", package = "rgdal")[1], "scot_BNG")
     scot_LL <- spTransform(scot_BNG, CRS("+proj=longlat +datum=WGS84"))

## metadata is already correctly set
proj4string(scot_BNG)
## [1] " +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000
+y_0=-100000 +datum=OSGB36 +units=m +no_defs +ellps=airy
+towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894"


class(scot_BNG)  ## "SpatialPolygonsDataFrame"

## transform (from whatever the current CRS is to any other supported
PROJ.4 CRS)
scot_LL <- spTransform(scot_BNG, CRS("+proj=longlat +datum=WGS84"))

mapproject (in package mapproj I assume) is a much more raw interface
for transforming from long/lat, and you might as well use ?project
from rgdal which also can do the inverse. If you cannot install rgdal
that's another story, but it's trivial on Windows (because of work by
the maintainers and the R Core Team), and well documented for other
platforms.

Cheers, Mike.


On Fri, Mar 16, 2012 at 11:15 AM, Jonathan Callahan
<jonathan at mazamascience.com> wrote:
> I am looking for a way to reproject data that exists in a
> SpatialPolygonsDataFrame. (I think it's the same data as in the rworldmap
> package.)
>
> I am quite familiar with mapproject() which works well the maps and mapdata
> packages and am hoping there is an equivalent to mapproject() that could
> work with SpatialPolygons data.
>
> Or is there a simple way to get the x an y data arrays out of the
> SpatialPolygons?
>
> Thanks in advance,
>
> Jon
>
> --
> Jonathan Callahan, PhD
> Mazama Science
> 206-708-5028
> mazamascience.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From jonathan at mazamascience.com  Fri Mar 16 03:29:28 2012
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Thu, 15 Mar 2012 19:29:28 -0700
Subject: [R-sig-Geo] map projections with sp data
In-Reply-To: <CAAcGz9916p_UDv_A+Hxcm47JvZbGPusT2uu+c8L_ZNH1BYE0TQ@mail.gmail.com>
References: <CAPjNR=QBTJzV=xm1FfBT74DTsJLB4+fLho=yqb1RvqbYexYvWg@mail.gmail.com>
	<CAAcGz9916p_UDv_A+Hxcm47JvZbGPusT2uu+c8L_ZNH1BYE0TQ@mail.gmail.com>
Message-ID: <CAPjNR=R1CAGQnomjEGm5D-1ARBOyBMhZ2dKS+h1qk5y35D-cQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/f04a2e4b/attachment.pl>

From tech_dev at wildintellect.com  Fri Mar 16 04:04:37 2012
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Thu, 15 Mar 2012 20:04:37 -0700
Subject: [R-sig-Geo] map projections with sp data
In-Reply-To: <CAPjNR=R1CAGQnomjEGm5D-1ARBOyBMhZ2dKS+h1qk5y35D-cQQ@mail.gmail.com>
References: <CAPjNR=QBTJzV=xm1FfBT74DTsJLB4+fLho=yqb1RvqbYexYvWg@mail.gmail.com>	<CAAcGz9916p_UDv_A+Hxcm47JvZbGPusT2uu+c8L_ZNH1BYE0TQ@mail.gmail.com>
	<CAPjNR=R1CAGQnomjEGm5D-1ARBOyBMhZ2dKS+h1qk5y35D-cQQ@mail.gmail.com>
Message-ID: <4F62ADC5.7090408@wildintellect.com>

http://spatialreference.org/ is a great resource for looking up proj
strings for existing defined projections.

Enjoy,
Alex


On 03/15/2012 07:29 PM, Jonathan Callahan wrote:
> Thanks for the helpful suggestion Michael.
> 
> I have done this kind of conversion from shapefile to lon-lat projection
> before.
> 
> My problem now is that I would like to take lon-lat data and transform it
> into a lambert conformal projection with particular parameters. What I'm
> failing on is how to specify the destination projection I want. Where is
> there a description of all the projection strings for things like Lambert
> conformal?
> 
> ...
> 
> Aha ... I found what I wanted: the PROJ strings are specified in the users
> manual
> 
> ftp://ftp.remotesensing.org/proj/OF90-284.pdf
> 
> In my case I wanted Lambert conformal conic:
> 
> +proj=lcc +lon 0=90w +lat 1=20n +lat 2=60n
> 
> 
> 
> 
> On Thu, Mar 15, 2012 at 5:28 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> 
>> spTransform in the rgdal package will do this very simply. You just
>> need the source metadata set on the original object, and spTransform
>> handles the rest.
>>
>> From the help page:
>>
>> require(rgdal)
>> scot_BNG <- readOGR(system.file("vectors", package = "rgdal")[1],
>> "scot_BNG")
>>     scot_LL <- spTransform(scot_BNG, CRS("+proj=longlat +datum=WGS84"))
>>
>> ## metadata is already correctly set
>> proj4string(scot_BNG)
>> ## [1] " +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000
>> +y_0=-100000 +datum=OSGB36 +units=m +no_defs +ellps=airy
>> +towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894"
>>
>>
>> class(scot_BNG)  ## "SpatialPolygonsDataFrame"
>>
>> ## transform (from whatever the current CRS is to any other supported
>> PROJ.4 CRS)
>> scot_LL <- spTransform(scot_BNG, CRS("+proj=longlat +datum=WGS84"))
>>
>> mapproject (in package mapproj I assume) is a much more raw interface
>> for transforming from long/lat, and you might as well use ?project
>> from rgdal which also can do the inverse. If you cannot install rgdal
>> that's another story, but it's trivial on Windows (because of work by
>> the maintainers and the R Core Team), and well documented for other
>> platforms.
>>
>> Cheers, Mike.
>>
>>
>> On Fri, Mar 16, 2012 at 11:15 AM, Jonathan Callahan
>> <jonathan at mazamascience.com> wrote:
>>> I am looking for a way to reproject data that exists in a
>>> SpatialPolygonsDataFrame. (I think it's the same data as in the rworldmap
>>> package.)
>>>
>>> I am quite familiar with mapproject() which works well the maps and
>> mapdata
>>> packages and am hoping there is an equivalent to mapproject() that could
>>> work with SpatialPolygons data.
>>>
>>> Or is there a simple way to get the x an y data arrays out of the
>>> SpatialPolygons?
>>>
>>> Thanks in advance,
>>>
>>> Jon
>>>
>>> --
>>> Jonathan Callahan, PhD
>>> Mazama Science
>>> 206-708-5028
>>> mazamascience.com
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>>
> 
>


From l.cattarino at uq.edu.au  Fri Mar 16 05:23:52 2012
From: l.cattarino at uq.edu.au (Lorenzo Cattarino)
Date: Fri, 16 Mar 2012 04:23:52 +0000
Subject: [R-sig-Geo] extract matrix values using circular window
Message-ID: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/8b349037/attachment.pl>

From ssubra at yahoo.com  Fri Mar 16 06:35:51 2012
From: ssubra at yahoo.com (Subramanian Swaminathan)
Date: Thu, 15 Mar 2012 22:35:51 -0700 (PDT)
Subject: [R-sig-Geo] Fw: impuating non-zero values for 'zeros' in OpenBugs
In-Reply-To: <1331629995.83373.YahooMailNeo@web163104.mail.bf1.yahoo.com>
References: <1331629995.83373.YahooMailNeo@web163104.mail.bf1.yahoo.com>
Message-ID: <1331876151.94430.YahooMailNeo@web163103.mail.bf1.yahoo.com>

Dear?listers,

Apologies for sending this mail again. Hope this time I would get?response?from?the listers.??

I am trying to fit a Bayes Gaussian model on the log-odds of prevalence (as there is no denominator for binomial model) with imputed values for observed 'zero' prevalence. For this purpose I used the following OpenBugs code: 

model {
for( i in 1 : N ) {
r[i]~ dunif(0.001,100)
Y[i]r(k in 1:sumNumNeigh) {
weights[k] pha0 ~ dflat()
p.alpha0-step(alpha1)
alpha1 ~ dnorm(0.01, 1.0E-5)
tau ~ dgamma(0.001,0.001)
sigma anum(b[])
}

While compiling, I get an error message that there are multiple definitions for Y[5]. As I am newbie I am unable to resolve this error. Could you kindly help me out from this hurdle. Thanking you in advance

yours sincerely
subramanian
----


From pascaltitle at gmail.com  Fri Mar 16 07:18:15 2012
From: pascaltitle at gmail.com (Pascal Title)
Date: Thu, 15 Mar 2012 23:18:15 -0700
Subject: [R-sig-Geo] environmental heterogeneity
Message-ID: <CAPSA=ycH2gUgW4LQQ=9dyoPxLKzUdHHgJsx7M4kHS3yhzPnw5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120315/88368f04/attachment.pl>

From r.turner at auckland.ac.nz  Fri Mar 16 07:44:45 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 16 Mar 2012 19:44:45 +1300
Subject: [R-sig-Geo] extract matrix values using circular window
In-Reply-To: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
References: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
Message-ID: <4F62E15D.7000806@auckland.ac.nz>

On 16/03/12 17:23, Lorenzo Cattarino wrote:
> Hi,
>
> I am trying to extract the values of the following matrix
>
> my.mat<- matrix(sample(c(1,0),100,replace=T),ncol=10)
>
> using a circular window/mask. I would like to be able to choose coordinates of window centre and circle radius. I looked into the raster and spatstat packages, and specifically the function disc(), but I could not get them to work properly.
>
> Any help is really appreciated.

Your question makes no sense at all to me.   WTF  has your 10 x 10 matrix of
random zeroes and ones got to do with a circular window?

If you could actually explain what you are trying to do, I could 
probably tell you how
to do it.

     cheers,

         Rolf Turner


From l.cattarino at uq.edu.au  Fri Mar 16 07:48:46 2012
From: l.cattarino at uq.edu.au (Lorenzo Cattarino)
Date: Fri, 16 Mar 2012 06:48:46 +0000
Subject: [R-sig-Geo] extract matrix values using circular window
In-Reply-To: <4F62E15D.7000806@auckland.ac.nz>
References: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
	<4F62E15D.7000806@auckland.ac.nz>
Message-ID: <23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>

I wanna know how many cells with values of one (1) are within a circular neighbourhood with radius r and centre in x0 y0.

-----Original Message-----
From: Rolf Turner [mailto:r.turner at auckland.ac.nz] 
Sent: Friday, 16 March 2012 4:45 PM
To: Lorenzo Cattarino
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] extract matrix values using circular window

On 16/03/12 17:23, Lorenzo Cattarino wrote:
> Hi,
>
> I am trying to extract the values of the following matrix
>
> my.mat<- matrix(sample(c(1,0),100,replace=T),ncol=10)
>
> using a circular window/mask. I would like to be able to choose coordinates of window centre and circle radius. I looked into the raster and spatstat packages, and specifically the function disc(), but I could not get them to work properly.
>
> Any help is really appreciated.

Your question makes no sense at all to me.   WTF  has your 10 x 10 matrix of
random zeroes and ones got to do with a circular window?

If you could actually explain what you are trying to do, I could probably tell you how to do it.

     cheers,

         Rolf Turner


From bart at njn.nl  Fri Mar 16 08:14:50 2012
From: bart at njn.nl (Bart)
Date: Fri, 16 Mar 2012 08:14:50 +0100
Subject: [R-sig-Geo] extract matrix values using circular window
In-Reply-To: <23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>
References: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
	<4F62E15D.7000806@auckland.ac.nz>
	<23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>
Message-ID: <4F62E86A.2000904@njn.nl>

You could have a look the buffer argument of the extract function in raster

Bart

On 03/16/2012 07:48 AM, Lorenzo Cattarino wrote:
> I wanna know how many cells with values of one (1) are within a circular neighbourhood with radius r and centre in x0 y0.
>
> -----Original Message-----
> From: Rolf Turner [mailto:r.turner at auckland.ac.nz]
> Sent: Friday, 16 March 2012 4:45 PM
> To: Lorenzo Cattarino
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] extract matrix values using circular window
>
> On 16/03/12 17:23, Lorenzo Cattarino wrote:
>> Hi,
>>
>> I am trying to extract the values of the following matrix
>>
>> my.mat<- matrix(sample(c(1,0),100,replace=T),ncol=10)
>>
>> using a circular window/mask. I would like to be able to choose coordinates of window centre and circle radius. I looked into the raster and spatstat packages, and specifically the function disc(), but I could not get them to work properly.
>>
>> Any help is really appreciated.
> Your question makes no sense at all to me.   WTF  has your 10 x 10 matrix of
> random zeroes and ones got to do with a circular window?
>
> If you could actually explain what you are trying to do, I could probably tell you how to do it.
>
>       cheers,
>
>           Rolf Turner
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.turner at auckland.ac.nz  Fri Mar 16 09:16:36 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 16 Mar 2012 21:16:36 +1300
Subject: [R-sig-Geo] extract matrix values using circular window
In-Reply-To: <23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>
References: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
	<4F62E15D.7000806@auckland.ac.nz>
	<23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>
Message-ID: <4F62F6E4.5090207@auckland.ac.nz>

On 16/03/12 19:48, Lorenzo Cattarino wrote:
> I wanna know how many cells with values of one (1) are within a circular neighbourhood with radius r and centre in x0 y0.

This might get you going:

require(spatstat)
# Build an example image of 0's and 1's:
M <- im(matrix(sample(0:1,500*500,TRUE),nrow=500),xcol=seq(0,10,length=500),
               yrow=seq(0,10,length=500))

# Take a disc which lies inside this image.
d <- disc(centre=c(3,5),radius=1)

# Plot the image and the disc.
plot(M)
plot(d,add=TRUE)

# Find the part of the image inside the disc:
Md <- M[d,drop=FALSE]
plot(Md)

# Find the number of 1's in Md:
summary(eval.im(Md==1))

# Or:
table(Md$v)

# Another approach:
i <- inside.owin(rasterx.im(M),rastery.im(M),d)
table(M[i])

HTH

     cheers,

         Rolf Turner


From sarah.goslee at gmail.com  Fri Mar 16 11:47:04 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Fri, 16 Mar 2012 06:47:04 -0400
Subject: [R-sig-Geo] Fw: impuating non-zero values for 'zeros' in
	OpenBugs
In-Reply-To: <1331876151.94430.YahooMailNeo@web163103.mail.bf1.yahoo.com>
References: <1331629995.83373.YahooMailNeo@web163104.mail.bf1.yahoo.com>
	<1331876151.94430.YahooMailNeo@web163103.mail.bf1.yahoo.com>
Message-ID: <CAM_vjumbgT4sO-Kpiq8FF1ycp1HXgAaYsr6qN1n0Xc6Yc9Leew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/3ce490ea/attachment.pl>

From l.cattarino at uq.edu.au  Fri Mar 16 12:09:21 2012
From: l.cattarino at uq.edu.au (Lorenzo Cattarino)
Date: Fri, 16 Mar 2012 11:09:21 +0000
Subject: [R-sig-Geo] R:  extract matrix values using circular window
In-Reply-To: <4F62F6E4.5090207@auckland.ac.nz>
References: <23582DCD2EF0CA4EA89366505DDB692806A772@UQEXMDA8.soe.uq.edu.au>
	<4F62E15D.7000806@auckland.ac.nz>
	<23582DCD2EF0CA4EA89366505DDB692806A7B5@UQEXMDA8.soe.uq.edu.au>,
	<4F62F6E4.5090207@auckland.ac.nz>
Message-ID: <23582DCD2EF0CA4EA89366505DDB692806A859@UQEXMDA8.soe.uq.edu.au>

this is a very detailed answer. It helped a lot.
thank you.
Lorenzo
________________________________________
Inizio: Rolf Turner [r.turner at auckland.ac.nz]
Inviato: venerd? 16 marzo 2012 18.16
Fine: Lorenzo Cattarino
Cc: r-sig-geo at r-project.org
Oggetto: Re: [R-sig-Geo] extract matrix values using circular window

On 16/03/12 19:48, Lorenzo Cattarino wrote:
> I wanna know how many cells with values of one (1) are within a circular neighbourhood with radius r and centre in x0 y0.

This might get you going:

require(spatstat)
# Build an example image of 0's and 1's:
M <- im(matrix(sample(0:1,500*500,TRUE),nrow=500),xcol=seq(0,10,length=500),
               yrow=seq(0,10,length=500))

# Take a disc which lies inside this image.
d <- disc(centre=c(3,5),radius=1)

# Plot the image and the disc.
plot(M)
plot(d,add=TRUE)

# Find the part of the image inside the disc:
Md <- M[d,drop=FALSE]
plot(Md)

# Find the number of 1's in Md:
summary(eval.im(Md==1))

# Or:
table(Md$v)

# Another approach:
i <- inside.owin(rasterx.im(M),rastery.im(M),d)
table(M[i])

HTH

     cheers,

         Rolf Turner




From a.ghisla at gmail.com  Fri Mar 16 12:13:09 2012
From: a.ghisla at gmail.com (Anne Ghisla)
Date: Fri, 16 Mar 2012 12:13:09 +0100
Subject: [R-sig-Geo] Extracting minimum convex polygons of species
 distributions
In-Reply-To: <CADiqS85fL-PNqp6o6fEp7jg_W9T=YVZG0w_m0Bi2a7pSiLTw5Q@mail.gmail.com>
References: <CAMkzT56g6WTPqSo5MZYa6rD=nXNf+p0miaL1ixhNDJVdzeA6UA@mail.gmail.com>
	<CADiqS85fL-PNqp6o6fEp7jg_W9T=YVZG0w_m0Bi2a7pSiLTw5Q@mail.gmail.com>
Message-ID: <20120316121309.5c87cba0@galadriel.localdomain>

On Thu, 15 Mar 2012 10:56:45 -0500
Jaime Burbano Gir?n <jaimebg27 at gmail.com> wrote:

> Hi Louise, I have calculated minimum convex polygons with "calc_mcp"
> function from package "aspace", but I think this function is not
> longer available, so I attach my script using it, where the function
> is written.
> 
> An other tool that I have used is the Hawth's Analysis Tools
> extension for ArcGIS:
> http://www.spatialecology.com/htools/tooldesc.php

Hawth's tools page states: 

"[Dec 09] HawthsTools is now formally discontinued. The new software
that replaces and improves upon Hawthstools is called the Geospatial
Modelling Environment (http://www.spatialecology.com/gme/index.htm) "

GME uses R in the background but is not (yet) under a open license.

Best,
Anne

> Cheers...
> 
> On Thu, Mar 15, 2012 at 8:56 AM, Louise Mair <lm609 at york.ac.uk> wrote:
> 
> > Hello,
> >
> > I have a distribution dataset for species consisting of xy
> > coordinates at the 1km resolution, with only presence data. So a
> > simplified example of a species distribution might be:
> >
> > y <- rbind(as.integer(rnorm(100,50,20)),
> > as.integer(rnorm(200,100,30)), as.integer(rnorm(100,180,15)))
> > x <- rbind(as.integer(rnorm(200,50,20)),
> > as.integer(rnorm(200,100,20)), as.integer(rnorm(100,200,15)))
> > plot(y~x)
> >
> > I would like to create polygons for each species distribution,
> > where if an island is present (as I have tried to show in the
> > example), it would be a seperate polygon, and the jagged edges
> > where species distributions meet coastlines etc are maintained. I
> > have tried functions such as mcp in the package adehabitat, but
> > this produces a very coarse polygon, which doesn't provide the
> > detailed distribution edges that I need. Other functions I've tried
> > require the data already to be in the format where the only xy
> > coordinates present are the outline of the polygon.
> >
> > Can anyone please recommend a function I can use here, or suggest a
> > way of extracting the outline points? I have tried this manually
> > but cannot seem to write a code that will effectively take account
> > of jagged edges and islands.
> >
> > Thanks very much for your help,
> >
> > Louise.
> >
> >        [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 



-- 
http://gis.cri.fmach.it/ghisla/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/32fba696/attachment.bin>

From andrew.hartley at metoffice.gov.uk  Fri Mar 16 12:14:32 2012
From: andrew.hartley at metoffice.gov.uk (Andy Hartley)
Date: Fri, 16 Mar 2012 04:14:32 -0700 (PDT)
Subject: [R-sig-Geo] environmental heterogeneity
In-Reply-To: <CAPSA=ycH2gUgW4LQQ=9dyoPxLKzUdHHgJsx7M4kHS3yhzPnw5w@mail.gmail.com>
References: <CAPSA=ycH2gUgW4LQQ=9dyoPxLKzUdHHgJsx7M4kHS3yhzPnw5w@mail.gmail.com>
Message-ID: <E40ECC4BCBB70543AB323A3492ACB34606830480@EXXMAIL01.desktop.frd.metoffice.com>

Dear Pascal,
 
I did something similar using Mahalanobis Distance in order to assess
similarity of habitat within protected areas to that of the surrounding
area, in Africa. We used elevation, aridity, NDVI, NDWI, etc, so it
appears to match with your needs. The advantage of using mahalanobis
distance (as opposed to euclidean distance) is that it accounts for
covariance between your input variables. You can read more in our report
-
http://bioval.jrc.ec.europa.eu/APAAT/AssessmentOfAfricanProtectedAreas_E
UR22780.pdf or on the webpage - http://bioval.jrc.ec.europa.eu/APAAT/
(click a protected area on the map, and scroll down to the habitat
irreplaceability indicator)
 
Kind regards,
 
Andy
 
-- 
Andrew Hartley Climate Impacts Scientist
Met Office FitzRoy Road Exeter EX1 3PB United Kingdom
Tel: +44 (0)1392 885720 Fax: +44 (0)1392 885681
E-mail: andrew.hartley at metoffice.gov.uk http://www.metoffice.gov.uk
<blocked::http://www.metoffice.gov.uk/> 

Join us in celebrating 150 years of forecasting for the nation and enter
our photo competition
http://www.metoffice.gov.uk/about-us/who/our-history
<blocked::http://www.metoffice.gov.uk/about-us/who/our-history>  
 

________________________________

From: Pascal Title [via R-sig-geo]
[mailto:ml-node+s2731867n7378021h27 at n2.nabble.com] 
Sent: 16 March 2012 06:19
To: Hartley, Andrew
Subject: environmental heterogeneity


Hello all, 

I don't have a question about a specific function, so much as I'm
wondering 
if a specific type of function exists in R. 
I have multiple continuous-variable rasters (elevation, temperature, 
precipitation) and I would like to obtain some kind of measure of 
environmental heterogeneity based on these variables across a landscape 
(that would be defined by a bounding polygon). I know such methods exist

for categorical variables (for example in the SDMTools package with the 
PatchStat function), but I can't seem to find anything that would work
with 
continuous data. 

Any suggestions or advice would be greatly appreciated. Thanks for your 
time! 

-Pascal 

-- 
Pascal Title 

Graduate Student 
Burns Lab 
http://kevinburnslab.com/
Department of Evolutionary Biology 
San Diego State University 
5500 Campanile Drive 
San Diego, CA 92182-4614 

        [[alternative HTML version deleted]] 

_______________________________________________ 
R-sig-Geo mailing list 
[hidden email] 
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



________________________________

If you reply to this email, your message will be added to the discussion
below:
http://r-sig-geo.2731867.n2.nabble.com/environmental-heterogeneity-tp737
8021p7378021.html 
To start a new topic under R-sig-geo, email
ml-node+s2731867n2731867h53 at n2.nabble.com 
To unsubscribe from R-sig-geo, click here
<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=u
nsubscribe_by_code&node=2731867&code=YW5kcmV3LmhhcnRsZXlAbWV0b2ZmaWNlLmd
vdi51a3wyNzMxODY3fC0xNTc1OTEyMTQw> .
NAML
<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=m
acro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.names
paces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.vie
w.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Ae
mail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabb
le%3Aemail.naml>  


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/environmental-heterogeneity-tp7378021p7378646.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.m.krug at gmail.com  Fri Mar 16 12:57:12 2012
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 16 Mar 2012 12:57:12 +0100
Subject: [R-sig-Geo] environmental heterogeneity
In-Reply-To: <E40ECC4BCBB70543AB323A3492ACB34606830480@EXXMAIL01.desktop.frd.metoffice.com>
References: <CAPSA=ycH2gUgW4LQQ=9dyoPxLKzUdHHgJsx7M4kHS3yhzPnw5w@mail.gmail.com>
	<E40ECC4BCBB70543AB323A3492ACB34606830480@EXXMAIL01.desktop.frd.metoffice.com>
Message-ID: <4F632A98.7090907@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 16/03/12 12:14, Andy Hartley wrote:
> Dear Pascal,
> 
> I did something similar using Mahalanobis Distance in order to assess similarity of habitat
> within protected areas to that of the surrounding

As you state, the Mahalanobis Distance measures the distance (i.e. dis-similarity) between two 2D
areas - another measure for this is the earth movers distance (one package on cran, one on r-forge
( http://r-forge.r-project.org/projects/earthmovdist/ )

But I think the OP was looking fior a measure of "environmental heterogeneity", which could not be
done with these distance measures easily. I would be interested in the answers.

> area, in Africa. We used elevation, aridity, NDVI, NDWI, etc, so it appears to match with your
> needs. The advantage of using mahalanobis distance (as opposed to euclidean distance) is that
> it accounts for covariance between your input variables. You can read more in our report

I'll look into it, as I used the earth movers distance for a paper.

?Roura-Pascual, N. et al., 2010. Spatially-explicit sensitivity analysis for conservation
management: exploring the influence of decisions in invasive alien plant management. Diversity and
Distributions, 16, pp.426-438. Available at: http://www.sciencemag.org/content/312/5781/1715
[Accessed October 14, 2011].

If you can not get hold of the pdf, please contact me off-list.

Cheers,

Rainer


> - http://bioval.jrc.ec.europa.eu/APAAT/AssessmentOfAfricanProtectedAreas_E UR22780.pdf or on
> the webpage - http://bioval.jrc.ec.europa.eu/APAAT/ (click a protected area on the map, and
> scroll down to the habitat irreplaceability indicator)
> 
> Kind regards,
> 
> Andy
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys.
(Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk9jKpgACgkQoYgNqgF2ego2AQCcCiDM+ePUzjkqGuH+pAs29KK0
QkcAnRNFf6GgJctH8Q/RTWXFoAFhezh7
=VZja
-----END PGP SIGNATURE-----


From tom.gottfried at tum.de  Fri Mar 16 14:53:30 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Fri, 16 Mar 2012 14:53:30 +0100
Subject: [R-sig-Geo] distances reported by gstat when cokriging
Message-ID: <4F6345DA.2070801@tum.de>

Dear list(en)ers,

I wonder what the "dist" is, which is in the output of predict.gstat() 
with debug.level=16. I expect it to be the distance between the 
coordinate pair given in the same line and the prediction location. I 
verified this for the coordinates and distances given for "data id: 0" 
in the below example (and its true), but for "data id: 1" it's always 
"dist: 0". Is there a way to get the distances for the second covariate? 
I see it's simple in the example, because data are colocated, but the 
problem arose in a case with non-colocated covariates.
Here's the example:

library(gstat)
data(meuse)
coordinates(meuse) <- ~x+y
variog <- variogram(zinc~1, meuse)
varmod <- fit.variogram(variog, vgm(150000, "Exp", 1000))
data(meuse.grid)
coordinates(meuse.grid) <- ~x+y
g <- gstat(NULL, "z", zinc~1, meuse, model=varmod, nmax=10)
g <- gstat(g, "dist", I(dist*1000)~1, meuse, nmax=10)
variog.g <- variogram(g)
g <- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
meuse.point <- meuse.grid[sample(1:nrow(meuse.grid), 1),]
predict(g, newdata=meuse.point, debug.level=16)

Thanks!
Tom

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From edzer.pebesma at uni-muenster.de  Fri Mar 16 15:12:42 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 16 Mar 2012 15:12:42 +0100
Subject: [R-sig-Geo] distances reported by gstat when cokriging
In-Reply-To: <4F6345DA.2070801@tum.de>
References: <4F6345DA.2070801@tum.de>
Message-ID: <4F634A5A.5060302@uni-muenster.de>

Tom, right, it is. If you specify nmax=9 for the second variable, you
see the dist values for the second as well. They are indeed not computed
in your case, as the selection can be copied. Apparently these things
mattered when I wrote the code 20 years ago!

When you say, "Is there a way to get the distances for the second
covariate?", do you mean, as R object?

On 03/16/2012 02:53 PM, Tom Gottfried wrote:
> Dear list(en)ers,
> 
> I wonder what the "dist" is, which is in the output of predict.gstat()
> with debug.level=16. I expect it to be the distance between the
> coordinate pair given in the same line and the prediction location. I
> verified this for the coordinates and distances given for "data id: 0"
> in the below example (and its true), but for "data id: 1" it's always
> "dist: 0". Is there a way to get the distances for the second covariate?
> I see it's simple in the example, because data are colocated, but the
> problem arose in a case with non-colocated covariates.
> Here's the example:
> 
> library(gstat)
> data(meuse)
> coordinates(meuse) <- ~x+y
> variog <- variogram(zinc~1, meuse)
> varmod <- fit.variogram(variog, vgm(150000, "Exp", 1000))
> data(meuse.grid)
> coordinates(meuse.grid) <- ~x+y
> g <- gstat(NULL, "z", zinc~1, meuse, model=varmod, nmax=10)
> g <- gstat(g, "dist", I(dist*1000)~1, meuse, nmax=10)
> variog.g <- variogram(g)
> g <- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
> meuse.point <- meuse.grid[sample(1:nrow(meuse.grid), 1),]
> predict(g, newdata=meuse.point, debug.level=16)
> 
> Thanks!
> Tom
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at tum.de  Fri Mar 16 15:57:56 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Fri, 16 Mar 2012 15:57:56 +0100
Subject: [R-sig-Geo] distances reported by gstat when cokriging
In-Reply-To: <4F634A5A.5060302@uni-muenster.de>
References: <4F6345DA.2070801@tum.de> <4F634A5A.5060302@uni-muenster.de>
Message-ID: <4F6354F4.5090008@tum.de>

Dear Edzer,

Am 16.03.2012 15:12, schrieb Edzer Pebesma:
> Tom, right, it is. If you specify nmax=9 for the second variable, you
> see the dist values for the second as well. They are indeed not computed
> in your case, as the selection can be copied. Apparently these things
> mattered when I wrote the code 20 years ago!

the following modified example gives "dist: 0" for "data id: 0", which 
is non-colocated with the second covariate. As far as I understand the 
selection cannot be copied here:

library(gstat)
data(meuse)
coordinates(meuse) <- ~x+y
data(meuse.grid)
coordinates(meuse.grid) <- ~x+y

i <- sample(1:nrow(meuse), 1)
g <- gstat(NULL, "z", zinc~1, meuse[-i,], model=varmod)
g <- gstat(g, "dist", I(dist*1000)~1, meuse[-i,])
variog.g <- variogram(g)
g <- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
varmod.dist <- g$model$dist
g <- gstat(g, "dist", I(dist*1000)~1, data=meuse.grid,
            model=varmod.dist, maxdist=100)
meuse.point <- meuse[i,]
predict(g, newdata=meuse.point, debug.level=16)

> When you say, "Is there a way to get the distances for the second
> covariate?", do you mean, as R object?

Well, that would be luxurious. Currently I copy-paste those data into 
Calc for further analysis. Of course I can compute the distances somehow 
outside from gstat, but is there a way to get gstat doing this?

Thanks!
Tom

>
> On 03/16/2012 02:53 PM, Tom Gottfried wrote:
>> Dear list(en)ers,
>>
>> I wonder what the "dist" is, which is in the output of predict.gstat()
>> with debug.level=16. I expect it to be the distance between the
>> coordinate pair given in the same line and the prediction location. I
>> verified this for the coordinates and distances given for "data id: 0"
>> in the below example (and its true), but for "data id: 1" it's always
>> "dist: 0". Is there a way to get the distances for the second covariate?
>> I see it's simple in the example, because data are colocated, but the
>> problem arose in a case with non-colocated covariates.
>> Here's the example:
>>
>> library(gstat)
>> data(meuse)
>> coordinates(meuse)<- ~x+y
>> variog<- variogram(zinc~1, meuse)
>> varmod<- fit.variogram(variog, vgm(150000, "Exp", 1000))
>> data(meuse.grid)
>> coordinates(meuse.grid)<- ~x+y
>> g<- gstat(NULL, "z", zinc~1, meuse, model=varmod, nmax=10)
>> g<- gstat(g, "dist", I(dist*1000)~1, meuse, nmax=10)
>> variog.g<- variogram(g)
>> g<- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
>> meuse.point<- meuse.grid[sample(1:nrow(meuse.grid), 1),]
>> predict(g, newdata=meuse.point, debug.level=16)
>>
>> Thanks!
>> Tom
>>
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From edzer.pebesma at uni-muenster.de  Fri Mar 16 16:13:59 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 16 Mar 2012 16:13:59 +0100
Subject: [R-sig-Geo] distances reported by gstat when cokriging
In-Reply-To: <4F6354F4.5090008@tum.de>
References: <4F6345DA.2070801@tum.de> <4F634A5A.5060302@uni-muenster.de>
	<4F6354F4.5090008@tum.de>
Message-ID: <4F6358B7.20406@uni-muenster.de>



On 03/16/2012 03:57 PM, Tom Gottfried wrote:
> Dear Edzer,
> 
> Am 16.03.2012 15:12, schrieb Edzer Pebesma:
>> Tom, right, it is. If you specify nmax=9 for the second variable, you
>> see the dist values for the second as well. They are indeed not computed
>> in your case, as the selection can be copied. Apparently these things
>> mattered when I wrote the code 20 years ago!
> 
> the following modified example gives "dist: 0" for "data id: 0", which
> is non-colocated with the second covariate. As far as I understand the
> selection cannot be copied here:

Distances are only computed when needed. In this case, you use a global
neighbourhood, so they are not needed for neighbourhood selection.

> 
> library(gstat)
> data(meuse)
> coordinates(meuse) <- ~x+y
> data(meuse.grid)
> coordinates(meuse.grid) <- ~x+y
> 
> i <- sample(1:nrow(meuse), 1)
> g <- gstat(NULL, "z", zinc~1, meuse[-i,], model=varmod)
> g <- gstat(g, "dist", I(dist*1000)~1, meuse[-i,])
> variog.g <- variogram(g)
> g <- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
> varmod.dist <- g$model$dist
> g <- gstat(g, "dist", I(dist*1000)~1, data=meuse.grid,
>            model=varmod.dist, maxdist=100)
> meuse.point <- meuse[i,]
> predict(g, newdata=meuse.point, debug.level=16)
> 
>> When you say, "Is there a way to get the distances for the second
>> covariate?", do you mean, as R object?
> 
> Well, that would be luxurious. Currently I copy-paste those data into
> Calc for further analysis. Of course I can compute the distances somehow
> outside from gstat, but is there a way to get gstat doing this?

Of course there is (modifying the c code) but my advice would be to take
a shorter path -- sp::spDists? rgeos::gDistance?

> 
> Thanks!
> Tom
> 
>>
>> On 03/16/2012 02:53 PM, Tom Gottfried wrote:
>>> Dear list(en)ers,
>>>
>>> I wonder what the "dist" is, which is in the output of predict.gstat()
>>> with debug.level=16. I expect it to be the distance between the
>>> coordinate pair given in the same line and the prediction location. I
>>> verified this for the coordinates and distances given for "data id: 0"
>>> in the below example (and its true), but for "data id: 1" it's always
>>> "dist: 0". Is there a way to get the distances for the second covariate?
>>> I see it's simple in the example, because data are colocated, but the
>>> problem arose in a case with non-colocated covariates.
>>> Here's the example:
>>>
>>> library(gstat)
>>> data(meuse)
>>> coordinates(meuse)<- ~x+y
>>> variog<- variogram(zinc~1, meuse)
>>> varmod<- fit.variogram(variog, vgm(150000, "Exp", 1000))
>>> data(meuse.grid)
>>> coordinates(meuse.grid)<- ~x+y
>>> g<- gstat(NULL, "z", zinc~1, meuse, model=varmod, nmax=10)
>>> g<- gstat(g, "dist", I(dist*1000)~1, meuse, nmax=10)
>>> variog.g<- variogram(g)
>>> g<- fit.lmc(variog.g, g, vgm(100000, "Exp", 500, 1000))
>>> meuse.point<- meuse.grid[sample(1:nrow(meuse.grid), 1),]
>>> predict(g, newdata=meuse.point, debug.level=16)
>>>
>>> Thanks!
>>> Tom
>>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From dhaulsee at udel.edu  Fri Mar 16 19:36:12 2012
From: dhaulsee at udel.edu (Danielle Haulsee)
Date: Fri, 16 Mar 2012 14:36:12 -0400
Subject: [R-sig-Geo] multiple destination points in shortestPath() function
Message-ID: <CAOPy_rm8AMMLOVmYR=T0-2AAvUOzen7A9JkBjRcwxKEy=gg-9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/87e84c4b/attachment.pl>

From dprosser at usgs.gov  Fri Mar 16 20:02:27 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Fri, 16 Mar 2012 12:02:27 -0700 (PDT)
Subject: [R-sig-Geo] Error in writeRaster?
Message-ID: <1331924547732-7379982.post@n2.nabble.com>

Hi all,

I'm running the latest version of R (info below) with the raster and rgdal
libraries loaded.
I get the following error when trying to write to a raster (one I have not
seen before with previous runs of this code):

> rRisk_mn <- writeRaster(risk_mn, 'risk_mn.tif', format=raster,
> overwrite=TRUE)  # for ArcGIS
*Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "writeRaster", for
signature "matrix", "character"*

More code is supplied below in case it's helpful. Thanks for any help in
fixing this error.

Kind regards,
Diann
________________________________________________________________
bits from sessionInfo():
R version 2.14.2 (2012-02-29)
Platform: x86_64-pc-mingw32/x64 (64-bit)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.7-8      raster_1.9-70    sp_0.9-97        mc2d_0.1-12     
[5] mvtnorm_0.9-9992

loaded via a namespace (and not attached):
[1] grid_2.14.2    lattice_0.20-0 tools_2.14.2  
_________________________________________________________________

#building final array (4 simulations on 4848x4053 cells)
risk <- array(risk, dim=c(ny,nx,nsimu))

#mean for each location
risk_mn<- apply(risk,c(1,2),mean)

setwd("C:/Trisk/Output")
rRisk_mn <- writeRaster(risk_mn, 'risk_mn.tif'see, format=raster,
overwrite=TRUE)  # for ArcGIS

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-writeRaster-tp7379982p7379982.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Fri Mar 16 20:03:25 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Fri, 16 Mar 2012 20:03:25 +0100
Subject: [R-sig-Geo] gstat fails with valid (?) LMC
Message-ID: <4F638E7D.4010205@tum.de>

Dear list(en)ers,

by the way I discovered the following behaviour: fitting the LMC as in 
the example below and then using it for prediction raises an error 
telling the coefficient matrix is not positive definite. However, 
cauchy-schwartz inequalities are met (which should suffice for the 2 by 
2 coefficient matrix [1]). Sorry if this is only due to me having not 
done my homework, but isn't positive *semi*-definiteness of the 
coefficient matrix a sufficient condition for a valid LMC? Setting 
nocheck=1 does not end up with negative prediction variances in this 
example, too.

Thanks for any hint that can adjust me on this topic!
Tom

library(gstat)
data(meuse)
coordinates(meuse) <- ~x+y
data(meuse.grid)
coordinates(meuse.grid) <- ~x+y

g <- gstat(NULL, "z", zinc~1, meuse)
g <- gstat(g, "dist", I(dist*1000)~1, meuse)
variog.g <- variogram(g)
g <- fit.lmc(variog.g, g, vgm(100000, "Gau", 500, 1000))

predict(g, newdata=meuse.grid)
   # raises error ("coefficient matrix not positive definite") but ...

all(abs(g$model$z.dist$psill)<=sqrt(g$model$z$psill*g$model$dist$psill))
   # ... shows that cauchy-schwartz inequalities are met ...
all(abs(g$model$z.dist$psill)<sqrt(g$model$z$psill*g$model$dist$psill))
   # though the coefficient matrix seems to be "only" positive
   #semi-definite, no negative variances occur:
g <- gstat(NULL, "z", zinc~1, meuse, set=list(nocheck=1))
g <- gstat(g, "dist", I(dist*1000)~1, meuse)
variog.g <- variogram(g)
g <- fit.lmc(variog.g, g, vgm(100000, "Gau", 500, 1000))
pred <- predict(g, newdata=meuse.grid)
any(c(pred$z.var, pred$dist.var)<0)

[1]
@article{goovaerts_controversial_1994,
	title = {On a controversial method for modeling a coregionalization},
	volume = {26},
	doi = {10.1007/BF02082763},
	number = {2},
	journal = {Mathematical Geology},
	author = {Goovaerts, P.},
	year = {1994},
	pages = {197--204}
}

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From etiennebr at gmail.com  Fri Mar 16 22:07:00 2012
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 16 Mar 2012 14:07:00 -0700
Subject: [R-sig-Geo] Error in writeRaster?
In-Reply-To: <1331924547732-7379982.post@n2.nabble.com>
References: <1331924547732-7379982.post@n2.nabble.com>
Message-ID: <CALjAYt69cTCVUqh+T6ACbOLq7NESr34yR0EUZohS3KMpAVkcwQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/fe896139/attachment.pl>

From thi_veloso at yahoo.com.br  Sat Mar 17 00:29:28 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Fri, 16 Mar 2012 16:29:28 -0700
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <CAHKDjo6CPRDFoPuvPr+EeC+uP-pU9ZOTs3u77usTct_tBV7vmg@mail.gmail.com>
Message-ID: <1331940568.40964.YahooMailClassic@web161406.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/5429890c/attachment.pl>

From dprosser at usgs.gov  Sat Mar 17 00:44:33 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Fri, 16 Mar 2012 16:44:33 -0700 (PDT)
Subject: [R-sig-Geo] Error in writeRaster?
In-Reply-To: <1331924547732-7379982.post@n2.nabble.com>
References: <1331924547732-7379982.post@n2.nabble.com>
Message-ID: <1331941473517-7380569.post@n2.nabble.com>

That was exactly it. Thank you, Etienne.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-writeRaster-tp7379982p7380569.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From thi_veloso at yahoo.com.br  Sat Mar 17 01:19:26 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Fri, 16 Mar 2012 17:19:26 -0700
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331940568.40964.YahooMailClassic@web161406.mail.bf1.yahoo.com>
Message-ID: <1331943566.76355.YahooMailClassic@web161404.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120316/c64d3c71/attachment.pl>

From tom.gottfried at tum.de  Sat Mar 17 09:01:37 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Sat, 17 Mar 2012 09:01:37 +0100
Subject: [R-sig-Geo] distances reported by gstat when cokriging
In-Reply-To: <4F6358B7.20406@uni-muenster.de>
References: <4F6345DA.2070801@tum.de> <4F634A5A.5060302@uni-muenster.de>
	<4F6354F4.5090008@tum.de> <4F6358B7.20406@uni-muenster.de>
Message-ID: <4F6444E1.2050801@tum.de>

Am 16.03.2012 16:13, schrieb Edzer Pebesma:
>>
>>> When you say, "Is there a way to get the distances for the second
>>> covariate?", do you mean, as R object?
>>
>> Well, that would be luxurious. Currently I copy-paste those data into
>> Calc for further analysis. Of course I can compute the distances somehow
>> outside from gstat, but is there a way to get gstat doing this?
>
> Of course there is (modifying the c code) but my advice would be to take
> a shorter path -- sp::spDists? rgeos::gDistance?

The original goal of my dilettantish copy-pasting was to compare kriging 
weights vs. distance. I think I can solve that more elegantly with your 
code from `demo(weights)' and e.g. spDists.

Thanks!
Tom

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From sidney86_115 at hotmail.com  Sun Mar 18 04:38:46 2012
From: sidney86_115 at hotmail.com (Sidney Bernal)
Date: Sat, 17 Mar 2012 22:38:46 -0500
Subject: [R-sig-Geo] Problems installing R-project
Message-ID: <SNT117-W54E21667E5617CB285D337A75D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120317/06b46dcf/attachment.pl>

From agus.camacho at gmail.com  Mon Mar 19 04:50:54 2012
From: agus.camacho at gmail.com (Agus Camacho)
Date: Mon, 19 Mar 2012 00:50:54 -0300
Subject: [R-sig-Geo] Generating a precise map from coordinates.
Message-ID: <CALsJ7pR6t_kQihLAuc1qbiRkcFRHDMDnPNsGLuFtO-M8=iBopw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/e592365e/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Mon Mar 19 09:10:52 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Mon, 19 Mar 2012 09:10:52 +0100
Subject: [R-sig-Geo] Generating a precise map from coordinates.
In-Reply-To: <CALsJ7pR6t_kQihLAuc1qbiRkcFRHDMDnPNsGLuFtO-M8=iBopw@mail.gmail.com>
References: <CALsJ7pR6t_kQihLAuc1qbiRkcFRHDMDnPNsGLuFtO-M8=iBopw@mail.gmail.com>
Message-ID: <4F66EA0C.1020409@jrc.ec.europa.eu>

On 19/03/12 04:50, Agus Camacho wrote:
> Hello all,
>
> I am still new to plot maps in R and trying to plot the object (wrld_simpl)
> from maptools. However found it difficult to plot a map with precise
> coordinates.
>
> The following series of plots shows what I am talking about:
> The margins of the plot are those specified only in some cases but others
> not. Anybody could give me a hint to generate maps from coordinates without
> having to be fishing a set of coordinates that looks good?

Did you look at :

http://r-spatial.sourceforge.net/gallery/
http://cran.r-project.org/web/views/Spatial.html

?

IHTH,

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), Italy
webinfo    : http://floods.jrc.ec.europa.eu/
work-phone : (+39)-(0332)-789588
work-fax   : (+39)-(0332)-786653
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"If Columbus had turned back, no one would have blamed him.
Of course, no one would have remembered him either."
(Source Unknown)


>
> plot(wrld_simpl, xlim=c(100,160), ylim=c(-45,10), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(100,160), ylim=c(-40,-10), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(100,160), ylim=c(-40,-15), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(100,160), ylim=c(-40,-20), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(100,160), ylim=c(-40,-25), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(115,160), ylim=c(-40,-25), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(115,155), ylim=c(-40,-25), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(115,155), ylim=c(-40,-20), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(115,155), ylim=c(-40,-15), axes=TRUE,col='light
> yellow')
> plot(wrld_simpl, xlim=c(115,155), ylim=c(-40,-14), axes=TRUE,col='light
> yellow')
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Mar 19 09:23:18 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 19 Mar 2012 09:23:18 +0100 (CET)
Subject: [R-sig-Geo] Generating a precise map from coordinates.
In-Reply-To: <4F66EA0C.1020409@jrc.ec.europa.eu>
References: <CALsJ7pR6t_kQihLAuc1qbiRkcFRHDMDnPNsGLuFtO-M8=iBopw@mail.gmail.com>
	<4F66EA0C.1020409@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.02.1203190919280.27676@reclus.nhh.no>

On Mon, 19 Mar 2012, Mauricio Zambrano-Bigiarini wrote:

> On 19/03/12 04:50, Agus Camacho wrote:
>> Hello all,
>> 
>> I am still new to plot maps in R and trying to plot the object (wrld_simpl)
>> from maptools. However found it difficult to plot a map with precise
>> coordinates.
>> 
>> The following series of plots shows what I am talking about:
>> The margins of the plot are those specified only in some cases but others
>> not. Anybody could give me a hint to generate maps from coordinates without
>> having to be fishing a set of coordinates that looks good?
>
> Did you look at :
>
> http://r-spatial.sourceforge.net/gallery/
> http://cran.r-project.org/web/views/Spatial.html

I think that this is a repeat of:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-February/014183.html

and recommend reading that thread - it has to do with the default device 
usually being "square", and asp= being set to 1 (or to a 
latitude-corrected value if the coordinates are known not to be 
projected).

Roger

>
> ?
>
> IHTH,
>
> Mauricio Zambrano-Bigiarini
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From daisy.duursma at gmail.com  Mon Mar 19 11:53:05 2012
From: daisy.duursma at gmail.com (Daisy Englert Duursma)
Date: Mon, 19 Mar 2012 21:53:05 +1100
Subject: [R-sig-Geo] select cells in a raster and change the values to 1
Message-ID: <CAFf2dDGygv6PETRnv81nR4eMtEacWs6fFoWJ_dSYYQmiimiE_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/7a2776b4/attachment.pl>

From a.mosnier at gmail.com  Mon Mar 19 13:28:21 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 19 Mar 2012 08:28:21 -0400
Subject: [R-sig-Geo] select cells in a raster and change the values to 1
Message-ID: <CANkFkEdZ3-RZk6rA5M9eeBJ5vcgzSPDjukg-0YbfJb2NcLUTJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/81c031e4/attachment.pl>

From a.mosnier at gmail.com  Mon Mar 19 13:32:51 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 19 Mar 2012 08:32:51 -0400
Subject: [R-sig-Geo] select cells in a raster and change the values to 1
Message-ID: <CANkFkEdJ1iiPHVA+usW15wSqbzASKRp4woyOXWVhKVvUHdLnWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/b194bb6f/attachment.pl>

From virgilio.gomez at uclm.es  Mon Mar 19 16:31:13 2012
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Mon, 19 Mar 2012 16:31:13 +0100
Subject: [R-sig-Geo] Google Summer of Code
Message-ID: <1332171073.12150.12.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Once again, R has been accepted as an organization for the Google Summer of Code (2012).
We invite students interested in this program to learn more about it. A good starting
point is http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012. The Google
GSOC home page is http://www.google-melange.com/gsoc/homepage/google/gsoc2012

Workers who could mentor projects are also needed. We aim to have at least two mentors per
student project, based on experiences reported in an article (starting page 64) in the
recent issue of the R-Journal
http://journal.r-project.org/archive/2011-2/RJournal_2011-2.pdf

Those interested in either student or mentor participation should join our Google list
gsoc-r at googlegroups.com as this is how we are communicating. Please provide a 1 sentence
intro to yourself as we have had attempts by spammers to join the group.

Note that GSOC is about CODING. It is not intended to fund research, but many activities
with R require code to advance our work, so the program can be very helpful to improving R.

For information, the admins this year are Toby Dylan Hocking and John Nash, with backups
Brian Peterson and Virgilio Gomez.

Happy coding,

John Nash


From jedrzej.bojanowski at jrc.ec.europa.eu  Mon Mar 19 16:40:37 2012
From: jedrzej.bojanowski at jrc.ec.europa.eu (Jedrzej Bojanowski)
Date: Mon, 19 Mar 2012 16:40:37 +0100
Subject: [R-sig-Geo] select cells in a raster and change the values to 1
In-Reply-To: <CAFf2dDGygv6PETRnv81nR4eMtEacWs6fFoWJ_dSYYQmiimiE_w@mail.gmail.com>
References: <CAFf2dDGygv6PETRnv81nR4eMtEacWs6fFoWJ_dSYYQmiimiE_w@mail.gmail.com>
Message-ID: <008701cd05e6$a19bed60$e4d3c820$%bojanowski@jrc.ec.europa.eu>

If I got your question well,

for the raster
r <- raster(matrix(rep(c(1:10),10),10,10))
and vector
v <- c(1:3)

You can change to 1 all the values of raster equal to the elements of vector
v with:

r[r%in%c(1,2,3)] <- 1

and then, everything else to NA with:

r[!r%in%c(1)] <- NA

HTH,

jed

_______________________________

Jedrzej Stanislaw BOJANOWSKI



European Commission
Joint Research Centre 
Institute for Environment and Sustainability
Monitoring Agricultural Resources Unit - H04
Crop Production Forecast and Climate Change Impact

Via Fermi 2749,
I-21027 ISPRA (VA), ITALY
+39.0332.78.5030 
jedrzej.bojanowski at jrc.ec.europa.eu
http://mars.jrc.ec.europa.eu/mars
jbojanowski.pl


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Daisy Englert Duursma
> Sent: 19 March, 2012 11:53 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] select cells in a raster and change the values to
> 1
> 
> Greetings,
> 
> I have a vector of values and I want to select cells in a raster that
> have these values, change these cells so they have a value of 1 and the
> rest of the raster will have a NA value.
> 
> library(raster)
> 
> #my example raster
> r <- raster(ncol=3, nrow=3)
> r[] <- 1:ncell(r)
> #a vector of cells I want to select
> vals<-c(2,4,6)
> 
> #I want to select cells with the values 2,4,6 a silly way to do it:
> r1<-r==2
> r2<-r==4
> r3<-r==6
> #make the final desired raster
> r4<-r1+r2+r3
> plot(r4)
> 
> #I have played around with a lot of differnt things but I think I want
> to use the funcion sub ######this does not work###### df =
> data.frame(id=c(2,4,6), v=c(1,1,1)) x = subs(r, df)
> 
> 
> 
> Is there a better way to do this? There must be a better way. What have
> I missed? I need to be able to select raster cells from a vector.
> 
> Thank you for your time and help,
> Daisy
> 
> 
> --
> Daisy Englert Duursma
> Department of Biological Sciences
> Room E8C156
> Macquarie University, North Ryde, NSW 2109 Australia
> 
> Tel +61 2 9850 9256
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From roosbeh.nowrouzian at gmail.com  Mon Mar 19 22:47:13 2012
From: roosbeh.nowrouzian at gmail.com (Roosbeh Nowrouzian)
Date: Mon, 19 Mar 2012 17:47:13 -0400
Subject: [R-sig-Geo] Estimating extended SDM (different weight matrix for
 independent and dependent variables)
Message-ID: <CAJw-hPYoFSUqgi_b=2gBdzw++JRYXaB89zbcHEQwq844Rpp8_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/8ac48b22/attachment.pl>

From apcar at deakin.edu.au  Tue Mar 20 03:32:02 2012
From: apcar at deakin.edu.au (ADAM PETER CARDILINI)
Date: Tue, 20 Mar 2012 02:32:02 +0000
Subject: [R-sig-Geo] Daisy- select cells in a raster and change the
	values to 1
Message-ID: <11DC569BD7493645998AD27DA1F01E273A85A7B3@mbox-b-2.du.deakin.edu.au>

G'day Daisy,

My first time replying to a question, so I hope I don't give you the wrong info.

You could try:

library(raster)
r <- raster(ncol=3, nrow=3)
r[] <- 1:ncell(r)

#the first set of numbers is a list of your values, the second set is what you want those values to become.
isBecomes<-cbind(c(1,2,3,4,5,6,7,8,9),c(NA,1,NA,1,NA,1,NA,NA,NA))
r2 <- reclass(r, rcl=isBecomes)

I hope this is what you are looking for. Good luck with it.

Cheers,
Adam


Greetings,

I have a vector of values and I want to select cells in a raster that have
these values, change these cells so they have a value of 1 and the rest of
the raster will have a NA value.

library(raster)

#my example raster
r <- raster(ncol=3, nrow=3)
r[] <- 1:ncell(r)
#a vector of cells I want to select
vals<-c(2,4,6)

#I want to select cells with the values 2,4,6 a silly way to do it:
r1<-r==2
r2<-r==4
r3<-r==6
#make the final desired raster
r4<-r1+r2+r3
plot(r4)

#I have played around with a lot of differnt things but I think I want to
use the funcion sub
######this does not work######
df = data.frame(id=c(2,4,6), v=c(1,1,1))
x = subs(r, df)



Is there a better way to do this? There must be a better way. What have I
missed? I need to be able to select raster cells from a vector.

Thank you for your time and help,
Daisy


-- 
Daisy Englert Duursma
Department of Biological Sciences
Room E8C156
Macquarie University, North Ryde, NSW 2109
Australia

Tel +61 2 9850 9256

	[[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 103, Issue 19


From r.hijmans at gmail.com  Tue Mar 20 03:49:25 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 19 Mar 2012 19:49:25 -0700
Subject: [R-sig-Geo] select cells in a raster and change the values to 1
In-Reply-To: <CAFf2dDGygv6PETRnv81nR4eMtEacWs6fFoWJ_dSYYQmiimiE_w@mail.gmail.com>
References: <CAFf2dDGygv6PETRnv81nR4eMtEacWs6fFoWJ_dSYYQmiimiE_w@mail.gmail.com>
Message-ID: <CANtt_hz0+1XM3B-nJ=Y6GEzbd-SPibaaCqUk768xTdtZK-_K8A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120319/f5cf6b5a/attachment.pl>

From apcar at deakin.edu.au  Tue Mar 20 07:42:01 2012
From: apcar at deakin.edu.au (ADAM PETER CARDILINI)
Date: Tue, 20 Mar 2012 06:42:01 +0000
Subject: [R-sig-Geo] PatchStat error when working with RasterLayer
Message-ID: <11DC569BD7493645998AD27DA1F01E273A85AA48@mbox-b-2.du.deakin.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/87979da2/attachment.pl>

From csilva at ipimar.pt  Tue Mar 20 12:10:42 2012
From: csilva at ipimar.pt (Cristina Silva)
Date: Tue, 20 Mar 2012 11:10:42 +0000
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a ESRI
	file
Message-ID: <4F6865B2.2090900@ipimar.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/bf5c804f/attachment.pl>

From aslantas at metu.edu.tr  Tue Mar 20 12:36:24 2012
From: aslantas at metu.edu.tr (=?iso-8859-9?Q?P=FDnar_Aslantas_Bostan?=)
Date: Tue, 20 Mar 2012 13:36:24 +0200
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI	file
In-Reply-To: <4F6865B2.2090900@ipimar.pt>
References: <4F6865B2.2090900@ipimar.pt>
Message-ID: <004801cd068d$aece1830$0c6a4890$@edu.tr>

Dear Cristina,

For this purpose I use "write.table" function.

my code is this;

write.table(dem, file="D:\\Data\\dem_outputs.txt", quote = TRUE, dec = ".",
qmethod = c("escape", "double"))

# "dem" is SpatialPixelsDataFrame in my study.

then you can add your data as txt file in ArcGis.

I hope this helps.

Best wishes,
Pinar


-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Cristina Silva
Sent: Tuesday, March 20, 2012 1:11 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a ESRI
file

Dear all,

I need to export a SpatialPolygonsDataFrame to a shapefile to  be read by
ArcGIS. I have used several packages and functions to do this with different
results.

1) with maptools, function writePolyShape: The file .prj is not created

2) with spsurvey, function sp2shape: Doesn't work, gives the following
message "Error: Opening .prj file in C function writeShapeFilePolygon"

3) with rgdal, function writeOGR:

  * with data projected (transforming longlat into utm) or not (longlat:
    the file is read by ArcGIS. However, when I try to open the
    Attributes table, it gives the message that could not load the data
    from the data source, suggests to refresh (which is not possible)
    and opens an empty table, although having the number of columns and
    lines of the data. Looking for the info of each polygon in the map,
    the data are displayed for each individual record. So, the data
    exist but are not acessible from the Attributes Table.
  * To display the Attributes Table, I had to convert the .dbf file in
    .csv and export again as a .dbf.

Is there any better way to make this conversion?

Cristina

--
------------------------------------------
Cristina Silva
INRB/L-IPIMAR
Unidade de Recursos Marinhos e Sustentabilidade Av. de Brasmlia, 1449-006
Lisboa Portugal
Tel.: 351 21 3027096
Fax: 351 21 3015948
csilva at ipimar.pt


	[[alternative HTML version deleted]]


From csilva at ipimar.pt  Tue Mar 20 13:37:20 2012
From: csilva at ipimar.pt (Cristina Silva)
Date: Tue, 20 Mar 2012 12:37:20 +0000
Subject: [R-sig-Geo] Fwd: Re: Conversion of a SpatialPolygonsDataFrame into
 a ESRI file
In-Reply-To: <4F6874F2.70500@ipimar.pt>
References: <4F6874F2.70500@ipimar.pt>
Message-ID: <4F687A00.9080209@ipimar.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/e7f67013/attachment.pl>

From kpijnenburg at diw.de  Tue Mar 20 13:37:55 2012
From: kpijnenburg at diw.de (katharina pijnenburg)
Date: Tue, 20 Mar 2012 05:37:55 -0700 (PDT)
Subject: [R-sig-Geo] gwr.sel: Plot CV score with bandwidth
Message-ID: <1332247075098-7388982.post@n2.nabble.com>

Hi,
I would like to plot the cv score for each bandwidth (up to 5000km in my
example), like in Fotheringham et al., p. 60.
I tried to manipulate the gwr.cv.f function, but I couldn't manage it.

Thank you very much foor your help!
Best,
Katharina


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gwr-sel-Plot-CV-score-with-bandwidth-tp7388982p7388982.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From joona.lehtomaki at cs.helsinki.fi  Tue Mar 20 14:00:09 2012
From: joona.lehtomaki at cs.helsinki.fi (=?ISO-8859-1?Q?Joona_Lehtom=E4ki?=)
Date: Tue, 20 Mar 2012 15:00:09 +0200
Subject: [R-sig-Geo] Fwd: Re: Conversion of a SpatialPolygonsDataFrame
 into a ESRI file
In-Reply-To: <4F687A00.9080209@ipimar.pt>
References: <4F6874F2.70500@ipimar.pt> <4F687A00.9080209@ipimar.pt>
Message-ID: <4F687F59.90104@cs.helsinki.fi>

Hi Cristina,

Which version of ArcGIS are you using? The dbf-format is notorious for 
mangling the field names longer than 10 characters. I can't imagine how 
this might prevent the attribute table from showing, but you never know.

In ArcGIS, you could just try exporting the shapefile into a new file 
(shapefile or geodatabase feature layer) and see if the new file behaves 
better.

Joona

On 03/20/2012 02:37 PM, Cristina Silva wrote:
> Sorry, I didn't reply for the list.
>
> Cristina
>
> -------- Original Message --------
> Subject: 	Re: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into
> a ESRI file
> Date: 	Tue, 20 Mar 2012 12:15:46 +0000
> From: 	Cristina Silva<csilva at ipimar.pt>
> To: 	P?nar Aslantas Bostan<aslantas at metu.edu.tr>
>
>
> Hi Pinar,
>
> The problem is not to get the data, this can be done directly with
> write.csv or write.table. I was looking for a package/function to export
> the whole spatial object to a ESRI shapefile with all the files needed
> (.shp, .shx, .prj and .dbf). With writeOGR I can do this but the
> resulting .dbf file is not read properly, although the data are there.
>
> Thanks anyway.
>
> Cristina
>
> On 20/03/2012 11:36, P?nar Aslantas Bostan wrote:
>>   Dear Cristina,
>>
>>   For this purpose I use "write.table" function.
>>
>>   my code is this;
>>
>>   write.table(dem, file="D:\\Data\\dem_outputs.txt", quote = TRUE, dec = ".",
>>   qmethod = c("escape", "double"))
>>
>>   # "dem" is SpatialPixelsDataFrame in my study.
>>
>>   then you can add your data as txt file in ArcGis.
>>
>>   I hope this helps.
>>
>>   Best wishes,
>>   Pinar
>>
>>
>>   -----Original Message-----
>>   From: r-sig-geo-bounces at r-project.org
>>   [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Cristina Silva
>>   Sent: Tuesday, March 20, 2012 1:11 PM
>>   To: r-sig-geo at r-project.org
>>   Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a ESRI
>>   file
>>
>>   Dear all,
>>
>>   I need to export a SpatialPolygonsDataFrame to a shapefile to  be read by
>>   ArcGIS. I have used several packages and functions to do this with different
>>   results.
>>
>>   1) with maptools, function writePolyShape: The file .prj is not created
>>
>>   2) with spsurvey, function sp2shape: Doesn't work, gives the following
>>   message "Error: Opening .prj file in C function writeShapeFilePolygon"
>>
>>   3) with rgdal, function writeOGR:
>>
>>      * with data projected (transforming longlat into utm) or not (longlat:
>>        the file is read by ArcGIS. However, when I try to open the
>>        Attributes table, it gives the message that could not load the data
>>        from the data source, suggests to refresh (which is not possible)
>>        and opens an empty table, although having the number of columns and
>>        lines of the data. Looking for the info of each polygon in the map,
>>        the data are displayed for each individual record. So, the data
>>        exist but are not acessible from the Attributes Table.
>>      * To display the Attributes Table, I had to convert the .dbf file in
>>        .csv and export again as a .dbf.
>>
>>   Is there any better way to make this conversion?
>>
>>   Cristina
>>
>>   --
>>   ------------------------------------------
>>   Cristina Silva
>>   INRB/L-IPIMAR
>>   Unidade de Recursos Marinhos e Sustentabilidade Av. de Brasmlia, 1449-006
>>   Lisboa Portugal
>>   Tel.: 351 21 3027096
>>   Fax: 351 21 3015948
>>   csilva at ipimar.pt
>>
>>
>>   	[[alternative HTML version deleted]]
>>
>>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From momadou at yahoo.fr  Tue Mar 20 17:47:05 2012
From: momadou at yahoo.fr (Komine)
Date: Tue, 20 Mar 2012 09:47:05 -0700 (PDT)
Subject: [R-sig-Geo] Grid of raster: increase resolution
Message-ID: <1332262025789-7389731.post@n2.nabble.com>

HI,
I had in a excel file a data matrix: X Y Z. I created a raster with Arcgis
then I opened it with R.
I want to increase the resolution of my raster in order to see difference
between
pixel by their colors. I suppose the pixels that have the same values in the
column Z, must have the same color. 
But When I used my code, I have error message:Erreur in is.function(FUN) :
'FUN' is not found  

>library(raster)
>myobject <-raster("C:\\Users\\Desktop\\Test_R\\Freq1.tif") 
>test1<-plot(myobject) 
>test2 <- aggregate(test1, fact=2, fun=mean)

Can you help me to resolve it. 
Thank you in advance 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grid-of-raster-increase-resolution-tp7389731p7389731.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue Mar 20 18:15:05 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 20 Mar 2012 10:15:05 -0700
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <1332262025789-7389731.post@n2.nabble.com>
References: <1332262025789-7389731.post@n2.nabble.com>
Message-ID: <CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/e437403c/attachment.pl>

From fabriciovasselai at gmail.com  Tue Mar 20 19:59:57 2012
From: fabriciovasselai at gmail.com (Fabricio Vasselai)
Date: Tue, 20 Mar 2012 15:59:57 -0300
Subject: [R-sig-Geo] How to generate/use inverse distance matrices with
	spdep?
Message-ID: <CAEkXS9+KubDDUM=F50r51rfNmaqj6o0R5gy9XAeeSSch5N2a-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/198f1367/attachment.pl>

From Roger.Bivand at nhh.no  Tue Mar 20 20:19:59 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Mar 2012 20:19:59 +0100 (CET)
Subject: [R-sig-Geo] gwr.sel: Plot CV score with bandwidth
In-Reply-To: <1332247075098-7388982.post@n2.nabble.com>
References: <1332247075098-7388982.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1203202017310.2458@reclus.nhh.no>

On Tue, 20 Mar 2012, katharina pijnenburg wrote:

> Hi,
> I would like to plot the cv score for each bandwidth (up to 5000km in my
> example), like in Fotheringham et al., p. 60.
> I tried to manipulate the gwr.cv.f function, but I couldn't manage it.

library(spgwr)
data(columbus)
out <- capture.output(bw <- gwr.sel(crime ~ income + housing,
   data=columbus, coords=cbind(columbus$x, columbus$y)))
df <- read.table(textConnection(out), header=FALSE)
plot(V5 ~ V2, data=df[order(df$V2),], xlab="Bandwidth", ylab="CV score",
   type="l")

library(fortunes)
fortune("Yoda")

Roger


>
> Thank you very much foor your help!
> Best,
> Katharina
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gwr-sel-Plot-CV-score-with-bandwidth-tp7388982p7388982.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Mar 20 20:29:29 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Mar 2012 20:29:29 +0100 (CET)
Subject: [R-sig-Geo] Estimating extended SDM (different weight matrix
 for independent and dependent variables)
In-Reply-To: <CAJw-hPYoFSUqgi_b=2gBdzw++JRYXaB89zbcHEQwq844Rpp8_g@mail.gmail.com>
References: <CAJw-hPYoFSUqgi_b=2gBdzw++JRYXaB89zbcHEQwq844Rpp8_g@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203202021180.2458@reclus.nhh.no>

On Mon, 19 Mar 2012, Roosbeh Nowrouzian wrote:

> Hello:
> I an trying  fit a different version of Spatial Durbin Model (SDM) model in
> R. My question is is it possible to define 2 different weighting matrix in
> models specification of SDM. So in the model specification instead of y =
> ?Wy + ?? + X ? + W X ? + ?, we specify model as  * **y = ?W1y + ?? + X ? +
> W2 X ? + ?*  . Is there a way to estimate such a model in R?
>

Yes, by fitting a lag model on the covariates and their manually 
constructed lags - use the lag method for listw objects ?lag.listw to 
apply the W2 listw object to your X variables, usually omitting the 
intercept.

The impact methods may however need attention, so you would have to 
re-read LeSage & Pace (2009) very carefully before trying to interpret any 
results.

Hope this helps,

Roger
>
>
> Thanks in advance for your help and consideration.
>
> Roosbeh Nowrouzian
>
> PhD student
>
> Department of Civil and Coastal Engineering
>
> University of Florida
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From aslez at princeton.edu  Tue Mar 20 20:34:57 2012
From: aslez at princeton.edu (Adam Slez)
Date: Tue, 20 Mar 2012 14:34:57 -0500
Subject: [R-sig-Geo] bad degrees of freedom in bptest.sarlm
In-Reply-To: <9092bfc3d2db42b59793b0d1e08bbfcb@CSGHUB209W.pu.win.princeton.edu>
References: <CA+9dHA8eZDdSeK7nZrfXsGJt73wet-Ge218JuXNsYzQvcGcYRg@mail.gmail.com>
	<9092bfc3d2db42b59793b0d1e08bbfcb@CSGHUB209W.pu.win.princeton.edu>
Message-ID: <CA+9dHA9xFQfeLwoyZ1mhhfj2841OjeO5UiB-bFWUhVtV7cN2xw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/dd259752/attachment.pl>

From Roger.Bivand at nhh.no  Tue Mar 20 20:39:53 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Mar 2012 20:39:53 +0100 (CET)
Subject: [R-sig-Geo] bad degrees of freedom in bptest.sarlm
In-Reply-To: <CA+9dHA9xFQfeLwoyZ1mhhfj2841OjeO5UiB-bFWUhVtV7cN2xw@mail.gmail.com>
References: <CA+9dHA8eZDdSeK7nZrfXsGJt73wet-Ge218JuXNsYzQvcGcYRg@mail.gmail.com>
	<9092bfc3d2db42b59793b0d1e08bbfcb@CSGHUB209W.pu.win.princeton.edu>
	<CA+9dHA9xFQfeLwoyZ1mhhfj2841OjeO5UiB-bFWUhVtV7cN2xw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203202036130.2458@reclus.nhh.no>

On Tue, 20 Mar 2012, Adam Slez wrote:

> Roger,
>
> Out of curiosity, did you ever reach a final word on this?

Please check in 0.5-45, released at the weekend and on CRAN as a source 
and Windows binary package. The changelog lists the commit as February 24.

Roger

>
> Adam
>
> On Fri, Feb 24, 2012 at 7:18 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 24 Feb 2012, Adam Slez wrote:
>>
>>> Am I correct in thinking that the degrees of freedom associated with the
>>> bptest.sarlm, much like the bptest code from which it came, should be
>>> driven by the number of parameters in the auxiliary regression NOT the
>>> model used to generate the residuals?  The way the code for bptest.sarlm
>> is
>>> written, the degrees of freedom are calculated from the original
>>> regression, as opposed to the auxiliary model.  The easiest way to see
>> this
>>> is to do something like this:
>>>
>>> library(spdep)
>>> data(columbus)
>>> wgts<-nb2listw(col.gal.nb)
>>> model1<-lagsarlm(CRIME~INC, data = columbus, listw = wgts)
>>> model2<-lagsarlm(CRIME~INC+HOVAL, data = columbus, listw = wgts)
>>> bp1<-bptest.sarlm(model1, ~EW, data = columbus, studentize = F)
>>> bp2<-bptest.sarlm(model2, ~EW, data = columbus, studentize = F)
>>> bp3<-bptest.sarlm(model2, ~EW+CP+NSA, data = columbus, studentize = F)
>>>
>>> All I'm doing here is running spatially adjusted BP tests on two
>> different
>>> spatial lag models.  In the first two cases, I'm just testing for
>> groupwise
>>> heteroskedasticity with regimes defined in terms of the EW variable.  If
>> I
>>> understand the logic of the BP test, the degrees of freedom associated
>> with
>>> bp1 and bp2 should be the same, while the number of degrees of freedom
>>> associated with bp2 and bp3 should differ.  This doesn't seem to be the
>>> case.
>>>
>>> If we repeat this exercise for non-spatial models and tests, changes in
>> the
>>> degrees of freedom work as expected (recognizing of course that the
>> actual
>>> degrees of freedom for a non-spatial BP tests differs from the degrees of
>>> freedom for a spatially-adjusted BP test):
>>>
>>> library(lmtest)
>>> model3<-lm(CRIME~INC, data = columbus)
>>> model4<-lm(CRIME~INC+HOVAL, data = columbus)
>>> bp4<-bptest(model3, ~EW, data = columbus, studentize = F)
>>> bp5<-bptest(model4, ~EW, data = columbus, studentize = F)
>>> bp6<-bptest(model4, ~EW+CP+NSA, data = columbus, studentize = F)
>>>
>>> The bptest.sarlm routine is cribbed directly from the bptest code.  If we
>>> take a look a the first part of the bptest.sarlm code, we can see the
>>> problem (I'm using ... to denote skipped code):
>>>
>>> function (object, varformula = NULL, studentize = TRUE, data = list()) {
>>>    if (!inherits(object, "sarlm"))
>>>        stop("not sarlm object")
>>>    Z <- object$tarX
>>>    k <- ncol(Z)
>>>    n <- nrow(Z)
>>>    if (!is.null(varformula))
>>>        Z <- model.matrix(varformula, data = data)
>>
>> Thanks, k and n should be set after the if(), not before, I think. I'll
>> check and release if this seems correct.
>>
>> Roger
>>
>>>   ...
>>>    df <- k - 1
>>>   ...
>>> }
>>>
>>> It is pretty clear that df is driven by k which is unaffected by Z <-
>>> model.matrix(varformula, data = data), even when varformula is not null.
>>  I
>>> can't see any reason why the degrees of freedom for a spatially-adjusted
>> BP
>>> test would follow from the regression producing the residuals as opposed
>> to
>>> the auxiliary regression.  Any help would be much appreciated.
>>>
>>> Adam
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tephilippi at gmail.com  Tue Mar 20 20:44:15 2012
From: tephilippi at gmail.com (Tom Philippi)
Date: Tue, 20 Mar 2012 12:44:15 -0700
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
References: <1332262025789-7389731.post@n2.nabble.com>
	<CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
Message-ID: <CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>

Also, I believe that the argument to aggregate is FUN= and not fun=,
which appears to be what the error message is referencing.

Tom 2



On Tue, Mar 20, 2012 at 10:15 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Komine,
>
> You should have checked what kind of object "test1" is (it is NULL; that is
> what plot returns in this case). ?You can do
>
> test2 <- aggregate( myobject , fact=2, fun=mean)
>
> (By the way, for xyz to raster see "rasterFromXYZ" for a regular point
> pattern or "rasterize" for an irregular point pattern)
>
> Robert
>
> On Tue, Mar 20, 2012 at 9:47 AM, Komine <momadou at yahoo.fr> wrote:
>
>> HI,
>> I had in a excel file a data matrix: X Y Z. I created a raster with Arcgis
>> then I opened it with R.
>> I want to increase the resolution of my raster in order to see difference
>> between
>> pixel by their colors. I suppose the pixels that have the same values in
>> the
>> column Z, must have the same color.
>> But When I used my code, I have error message:Erreur in is.function(FUN) :
>> 'FUN' is not found
>>
>> >library(raster)
>> >myobject <-raster("C:\\Users\\Desktop\\Test_R\\Freq1.tif")
>> >test1<-plot(myobject)
>> >test2 <- aggregate(test1, fact=2, fun=mean)
>>
>> Can you help me to resolve it.
>> Thank you in advance
>>
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/Grid-of-raster-increase-resolution-tp7389731p7389731.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mspinola10 at gmail.com  Tue Mar 20 22:41:32 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Tue, 20 Mar 2012 15:41:32 -0600
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and gplot
	from rasterVis package
Message-ID: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/7d1991dd/attachment.pl>

From roman.lustrik at gmail.com  Tue Mar 20 22:44:05 2012
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 20 Mar 2012 22:44:05 +0100
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
Message-ID: <CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/c7898ce8/attachment.pl>

From mspinola10 at gmail.com  Tue Mar 20 22:57:10 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Tue, 20 Mar 2012 15:57:10 -0600
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
	<CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
Message-ID: <CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/d739ec62/attachment.pl>

From roman.lustrik at gmail.com  Tue Mar 20 23:00:09 2012
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 20 Mar 2012 23:00:09 +0100
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
	<CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
	<CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
Message-ID: <CAHT1vpiHDYu6Ai56JmKjVBjnd0dp8XtLE2rBxoKa9hD9onRWjw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/ecc1a576/attachment.pl>

From baptiste.auguie at googlemail.com  Tue Mar 20 23:09:09 2012
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Wed, 21 Mar 2012 11:09:09 +1300
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
	<CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
	<CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
Message-ID: <CANLFJPrSSiiDk+O1JQoRD+mKesnE+ay_ZZXinBhc4v1zr78fjQ@mail.gmail.com>

Hi,

Have you tried geom_raster and panel.levelplot.raster respectively, if
your image has regular tiles? "grid lines" artefacts are often
reported as a bug from pdf viewers when the image is made of multiple
rectGrobs.

HTH,

baptiste

On 21 March 2012 10:57, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Thank you Roman,
>
> I used ggsave, but the quality of the plot is not good. I got a "grid" all
> over the map and some of the background.
>
> Best,
>
> Manuel
>
> 2012/3/20 Roman Lu?trik <roman.lustrik at gmail.com>
>
>> For lattice and ggplot2 graphics, you need to wrap the ggplot/qplot into a
>> print call. Or, you can use ggsave.
>>
>> Cheers,
>> Roman
>>
>>
>>
>> On Tue, Mar 20, 2012 at 10:41 PM, Manuel Sp?nola <mspinola10 at gmail.com>wrote:
>>
>>> Dear list members,
>>>
>>> How can I save a map on pdf plotted with the functions levelplot or gplot
>>> from the rasterVis package without loosing quality of the map.
>>>
>>> > class(maparaster)
>>> [1] "RasterLayer"
>>> attr(,"package")
>>> [1] "raster"
>>>
>>>
>>> pdf("mp.pdf")
>>> levelplot(maparaster)
>>> dev.off()
>>>
>>> and
>>>
>>> pdf("mpgplot.pdf")
>>> gplot(maparaster) + geom_tile(aes(fill = value))
>>> dev.off()
>>>
>>>
>>> Best,
>>>
>>> Manuel
>>>
>>> --
>>> *Manuel Sp?nola, Ph.D.*
>>>
>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>> Universidad Nacional
>>> Apartado 1350-3000
>>> Heredia
>>> COSTA RICA
>>> mspinola at una.ac.cr
>>> mspinola10 at gmail.com
>>> Tel?fono: (506) 2277-3598
>>> Fax: (506) 2237-7036
>>> Personal website: Lobito de r?o <
>>> https://sites.google.com/site/lobitoderio/>
>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mspinola10 at gmail.com  Tue Mar 20 23:23:03 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Tue, 20 Mar 2012 16:23:03 -0600
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CANLFJPrSSiiDk+O1JQoRD+mKesnE+ay_ZZXinBhc4v1zr78fjQ@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
	<CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
	<CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
	<CANLFJPrSSiiDk+O1JQoRD+mKesnE+ay_ZZXinBhc4v1zr78fjQ@mail.gmail.com>
Message-ID: <CABkCotRs3GKK5NFAUGRpCvkhOnkovtK2Et8ENCpW_D-cDsBx=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120320/f75348a8/attachment.pl>

From pazurrobert at gmail.com  Wed Mar 21 00:01:08 2012
From: pazurrobert at gmail.com (Robert Pazur)
Date: Wed, 21 Mar 2012 00:01:08 +0100
Subject: [R-sig-Geo] rare events logistic regression with ASCII files
Message-ID: <CAJP9LR4-0AXbV2KO8XyNrrfuPoOZ+Xs9PKpc1EcQdt0BAtuBfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120321/bf8c5d7b/attachment.pl>

From janverbesselt at gmail.com  Wed Mar 21 10:43:34 2012
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Wed, 21 Mar 2012 10:43:34 +0100
Subject: [R-sig-Geo] Displaying temporal variation of raster data
In-Reply-To: <1331943566.76355.YahooMailClassic@web161404.mail.bf1.yahoo.com>
References: <1331940568.40964.YahooMailClassic@web161406.mail.bf1.yahoo.com>
	<1331943566.76355.YahooMailClassic@web161404.mail.bf1.yahoo.com>
Message-ID: <CAHKDjo4D6r2LQ4QqgSReor0pSVw-xjDE0MY+9dBCpZ8zB=15gA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120321/fdcdd9a4/attachment.pl>

From Roger.Bivand at nhh.no  Wed Mar 21 11:12:24 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2012 11:12:24 +0100 (CET)
Subject: [R-sig-Geo] rare events logistic regression with ASCII files
In-Reply-To: <CAJP9LR4-0AXbV2KO8XyNrrfuPoOZ+Xs9PKpc1EcQdt0BAtuBfA@mail.gmail.com>
References: <CAJP9LR4-0AXbV2KO8XyNrrfuPoOZ+Xs9PKpc1EcQdt0BAtuBfA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203211055070.11514@reclus.nhh.no>

On Wed, 21 Mar 2012, Robert Pazur wrote:

> Dear all,
>
> i would like to perform rare events logistic regression with ASCII Grid
> files.
> For this purpose selected the *relogit* function from Zelig package.
>
> I imported data into the R>
>
> library(maptools)
> landcover <- data.frame(readAsciiGrid("
> http://www.geography.sav.sk/personal/pazur/data/ab.asc"))
> temperature <- data.frame(readAsciiGrid("
> http://www.geography.sav.sk/personal/pazur/data/tem.asc"))
> precipitation <- data.frame(readAsciiGrid("
> http://www.geography.sav.sk/personal/pazur/data/zr.asc"))

Your problem is not reading the documentation: ?readAsciiGrid says that it 
returns a SpatialGridDataFrame. You cannot use data.frame() to coerce this 
object to a data frame with just the data, as it takes care to return the 
coordinates as well. Isn't it simpler to do:

library(maptools)
site <- "http://www.geography.sav.sk/personal/pazur/data/"
landcover <- readAsciiGrid(paste(site, "ab.asc", sep=""))
temperature <- readAsciiGrid(paste(site, "tem.asc", sep=""))
precipitation <- readAsciiGrid(paste(site, "zr.asc", sep=""))
SGDF <- cbind(landcover, temperature, precipitation)
summary(SGDF)

form <- formula(ab.asc ~ tem.asc + zr.asc)
l.out <- glm(form, data=SGDF, family=binomial(link = "logit"))
summary(l.out)
SGDF$lfit <- fitted(l.out)
library(Zelig)
z.out <- zelig(form, data=SGDF, model="relogit")
summary(z.out)
SGDF$zfit <- c(fitted(z.out))
spplot(SGDF, c("lfit", "zfit"), col.regions=bpy.colors(20))

because the SpatialGridDataFrame object behaves just like a data.frame?

Hope this clarifies,

Roger

>
> But it seems that this package (Zelig) cant handle spatial data. Is there
> some straight way for transformation?
>
> Thanks in advance,
> Kind regards,
>
> Robert Pazur
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From oscar.perpinan at upm.es  Wed Mar 21 11:29:18 2012
From: oscar.perpinan at upm.es (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 21 Mar 2012 11:29:18 +0100
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
	gplot from rasterVis package
In-Reply-To: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
	("Manuel =?utf-8?Q?Sp=C3=ADnola=22's?= message of "Tue, 20 Mar 2012
	15:41:32 -0600")
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>
Message-ID: <878viumem9.fsf@upm.es>

Manuel Sp?nola <mspinola10 at gmail.com> writes:

> Dear list members,
>
> How can I save a map on pdf plotted with the functions levelplot or gplot
> from the rasterVis package without loosing quality of the map.
>
>> class(maparaster)
> [1] "RasterLayer"
> attr(,"package")
> [1] "raster"
>
>
> pdf("mp.pdf")
> levelplot(maparaster)
> dev.off()

Hello,

You should use trellis.device with lattice objects:

f <- system.file("external/test.grd", package="raster")
r <- raster(f)

##default
trellis.device(pdf, file='mp.pdf')
levelplot(r)
dev.off()


##smaller file
trellis.device(pdf, file='mpRaster.pdf')
levelplot(r, panel=panel.levelplot.raster)
dev.off()

##smaller file and interpolate
trellis.device(pdf, file='mpInterpolate.pdf')
levelplot(r, panel=panel.levelplot.raster, interpolate=TRUE)
dev.off()

Best,

Oscar.
-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com


From pazurrobert at gmail.com  Wed Mar 21 11:29:13 2012
From: pazurrobert at gmail.com (Robert Pazur)
Date: Wed, 21 Mar 2012 11:29:13 +0100
Subject: [R-sig-Geo] rare events logistic regression with ASCII files
In-Reply-To: <alpine.LRH.2.02.1203211055070.11514@reclus.nhh.no>
References: <CAJP9LR4-0AXbV2KO8XyNrrfuPoOZ+Xs9PKpc1EcQdt0BAtuBfA@mail.gmail.com>
	<alpine.LRH.2.02.1203211055070.11514@reclus.nhh.no>
Message-ID: <CAJP9LR6=K=L9cWea1mdiO1gJhtXf05am9_Nspx0uzBMgxCN5yw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120321/25bb3e4d/attachment.pl>

From momadou at yahoo.fr  Wed Mar 21 12:34:03 2012
From: momadou at yahoo.fr (Komine)
Date: Wed, 21 Mar 2012 04:34:03 -0700 (PDT)
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>
References: <1332262025789-7389731.post@n2.nabble.com>
	<CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
	<CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>
Message-ID: <1332329643243-7391985.post@n2.nabble.com>

Hi,
Thank Robert and Tom2 for your help,
I did what I wanted with rasterFromXYZ.
Now I open my shapefile to put the contours of my raster, but the raster
disappears. I used this code:

# Open raster
>Image<-read.table("C:\\Users\\Documents\\Nouveau\\Frequence.txt",sep="",dec=",",header=TRUE)    
>testo<-rasterFromXYZ(Image)  
>plot(testo)
>testo2 <- aggregate(testo,fact=10, fun=mean) 
>plot(testo2)
# open shapefiles= boundary 
>library (rgdal)
>test1<-readOGR(dsn="C:\\Users\\Documents\\DISC D\\Nouveau",layer="pays")
>plot(test1)

How to open the raster and the boundary in the same window.
Thank you in advance 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grid-of-raster-increase-resolution-tp7389731p7391985.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Wed Mar 21 13:05:27 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Wed, 21 Mar 2012 08:05:27 -0400
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>

I Cristina,

I personally had success with the writeOGR of the rgdal package to export shape to ESRI.  I initially had the same error as you, which is not being able to get the dbf to display the data properly.  As Joona said, the problem was related to the field names.  In my case, if I recall well, I had dots in my fields names.  You should investigate that and try to get the simplest field names possible; short, no dots or other special characters, etc.

Good luck,

Bastien


Subject: Re: [R-sig-Geo] Fwd: Re: Conversion of a
        SpatialPolygonsDataFrame into a ESRI file
Message-ID: <4F687F59.90104 at cs.helsinki.fi>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi Cristina,

Which version of ArcGIS are you using? The dbf-format is notorious for
mangling the field names longer than 10 characters. I can't imagine how
this might prevent the attribute table from showing, but you never know.

In ArcGIS, you could just try exporting the shapefile into a new file
(shapefile or geodatabase feature layer) and see if the new file behaves
better.

Joona

On 03/20/2012 02:37 PM, Cristina Silva wrote:
> Sorry, I didn't reply for the list.
>
> Cristina
>
> -------- Original Message --------
> Subject:      Re: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into
> a ESRI file
> Date:         Tue, 20 Mar 2012 12:15:46 +0000
> From:         Cristina Silva<csilva at ipimar.pt>
> To:   P?nar Aslantas Bostan<aslantas at metu.edu.tr>
>
>
> Hi Pinar,
>
> The problem is not to get the data, this can be done directly with
> write.csv or write.table. I was looking for a package/function to
> export the whole spatial object to a ESRI shapefile with all the files
> needed (.shp, .shx, .prj and .dbf). With writeOGR I can do this but
> the resulting .dbf file is not read properly, although the data are
> there.
>
> Thanks anyway.
>
> Cristina
>
> On 20/03/2012 11:36, P?nar Aslantas Bostan wrote:
>>   Dear Cristina,
>>
>>   For this purpose I use "write.table" function.
>>
>>   my code is this;
>>
>>   write.table(dem, file="D:\\Data\\dem_outputs.txt", quote = TRUE, dec = ".",
>>   qmethod = c("escape", "double"))
>>
>>   # "dem" is SpatialPixelsDataFrame in my study.
>>
>>   then you can add your data as txt file in ArcGis.
>>
>>   I hope this helps.
>>
>>   Best wishes,
>>   Pinar
>>
>>
>>   -----Original Message-----
>>   From: r-sig-geo-bounces at r-project.org
>>   [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Cristina Silva
>>   Sent: Tuesday, March 20, 2012 1:11 PM
>>   To: r-sig-geo at r-project.org
>>   Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a ESRI
>>   file
>>
>>   Dear all,
>>
>>   I need to export a SpatialPolygonsDataFrame to a shapefile to  be read by
>>   ArcGIS. I have used several packages and functions to do this with different
>>   results.
>>
>>   1) with maptools, function writePolyShape: The file .prj is not
>> created
>>
>>   2) with spsurvey, function sp2shape: Doesn't work, gives the following
>>   message "Error: Opening .prj file in C function
>> writeShapeFilePolygon"
>>
>>   3) with rgdal, function writeOGR:
>>
>>      * with data projected (transforming longlat into utm) or not (longlat:
>>        the file is read by ArcGIS. However, when I try to open the
>>        Attributes table, it gives the message that could not load the data
>>        from the data source, suggests to refresh (which is not possible)
>>        and opens an empty table, although having the number of columns and
>>        lines of the data. Looking for the info of each polygon in the map,
>>        the data are displayed for each individual record. So, the data
>>        exist but are not acessible from the Attributes Table.
>>      * To display the Attributes Table, I had to convert the .dbf file in
>>        .csv and export again as a .dbf.
>>
>>   Is there any better way to make this conversion?
>>
>>   Cristina
>>
>>   --
>>   ------------------------------------------
>>   Cristina Silva
>>   INRB/L-IPIMAR
>>   Unidade de Recursos Marinhos e Sustentabilidade Av. de Brasmlia, 1449-006
>>   Lisboa Portugal
>>   Tel.: 351 21 3027096
>>   Fax: 351 21 3015948
>>   csilva at ipimar.pt
>>
>>
>>      [[alternative HTML version deleted]]
>>
>>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From csilva at ipimar.pt  Wed Mar 21 15:47:51 2012
From: csilva at ipimar.pt (Cristina Silva)
Date: Wed, 21 Mar 2012 14:47:51 +0000
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
In-Reply-To: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
Message-ID: <4F69EA17.9000609@ipimar.pt>

Thanks Joona and Bastien for your contribution. In fact, the problem was 
that I also had a dot in a variable name. After changing this, 
everything was OK.

Regards,

Cristina

On 21/03/2012 12:05, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:
> I Cristina,
>
> I personally had success with the writeOGR of the rgdal package to export shape to ESRI.  I initially had the same error as you, which is not being able to get the dbf to display the data properly.  As Joona said, the problem was related to the field names.  In my case, if I recall well, I had dots in my fields names.  You should investigate that and try to get the simplest field names possible; short, no dots or other special characters, etc.
>
> Good luck,
>
> Bastien
>
>
> Subject: Re: [R-sig-Geo] Fwd: Re: Conversion of a
>          SpatialPolygonsDataFrame into a ESRI file
> Message-ID:<4F687F59.90104 at cs.helsinki.fi>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> Hi Cristina,
>
> Which version of ArcGIS are you using? The dbf-format is notorious for
> mangling the field names longer than 10 characters. I can't imagine how
> this might prevent the attribute table from showing, but you never know.
>
> In ArcGIS, you could just try exporting the shapefile into a new file
> (shapefile or geodatabase feature layer) and see if the new file behaves
> better.
>
> Joona
>
> On 03/20/2012 02:37 PM, Cristina Silva wrote:
>> Sorry, I didn't reply for the list.
>>
>> Cristina
>>
>> -------- Original Message --------
>> Subject:      Re: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into
>> a ESRI file
>> Date:         Tue, 20 Mar 2012 12:15:46 +0000
>> From:         Cristina Silva<csilva at ipimar.pt>
>> To:   P?nar Aslantas Bostan<aslantas at metu.edu.tr>
>>
>>
>> Hi Pinar,
>>
>> The problem is not to get the data, this can be done directly with
>> write.csv or write.table. I was looking for a package/function to
>> export the whole spatial object to a ESRI shapefile with all the files
>> needed (.shp, .shx, .prj and .dbf). With writeOGR I can do this but
>> the resulting .dbf file is not read properly, although the data are
>> there.
>>
>> Thanks anyway.
>>
>> Cristina
>>
>> On 20/03/2012 11:36, P?nar Aslantas Bostan wrote:
>>>    Dear Cristina,
>>>
>>>    For this purpose I use "write.table" function.
>>>
>>>    my code is this;
>>>
>>>    write.table(dem, file="D:\\Data\\dem_outputs.txt", quote = TRUE, dec = ".",
>>>    qmethod = c("escape", "double"))
>>>
>>>    # "dem" is SpatialPixelsDataFrame in my study.
>>>
>>>    then you can add your data as txt file in ArcGis.
>>>
>>>    I hope this helps.
>>>
>>>    Best wishes,
>>>    Pinar
>>>
>>>
>>>    -----Original Message-----
>>>    From: r-sig-geo-bounces at r-project.org
>>>    [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Cristina Silva
>>>    Sent: Tuesday, March 20, 2012 1:11 PM
>>>    To: r-sig-geo at r-project.org
>>>    Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a ESRI
>>>    file
>>>
>>>    Dear all,
>>>
>>>    I need to export a SpatialPolygonsDataFrame to a shapefile to  be read by
>>>    ArcGIS. I have used several packages and functions to do this with different
>>>    results.
>>>
>>>    1) with maptools, function writePolyShape: The file .prj is not
>>> created
>>>
>>>    2) with spsurvey, function sp2shape: Doesn't work, gives the following
>>>    message "Error: Opening .prj file in C function
>>> writeShapeFilePolygon"
>>>
>>>    3) with rgdal, function writeOGR:
>>>
>>>       * with data projected (transforming longlat into utm) or not (longlat:
>>>         the file is read by ArcGIS. However, when I try to open the
>>>         Attributes table, it gives the message that could not load the data
>>>         from the data source, suggests to refresh (which is not possible)
>>>         and opens an empty table, although having the number of columns and
>>>         lines of the data. Looking for the info of each polygon in the map,
>>>         the data are displayed for each individual record. So, the data
>>>         exist but are not acessible from the Attributes Table.
>>>       * To display the Attributes Table, I had to convert the .dbf file in
>>>         .csv and export again as a .dbf.
>>>
>>>    Is there any better way to make this conversion?
>>>
>>>    Cristina
>>>
>>>    --
>>>    ------------------------------------------
>>>    Cristina Silva
>>>    INRB/L-IPIMAR
>>>    Unidade de Recursos Marinhos e Sustentabilidade Av. de Brasmlia, 1449-006
>>>    Lisboa Portugal
>>>    Tel.: 351 21 3027096
>>>    Fax: 351 21 3015948
>>>    csilva at ipimar.pt
>>>
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>>
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>


-- 
------------------------------------------
Cristina Silva
INRB/L-IPIMAR
Unidade de Recursos Marinhos e Sustentabilidade
Av. de Bras?lia, 1449-006 Lisboa
Portugal
Tel.: 351 21 3027096
Fax: 351 21 3015948
csilva at ipimar.pt


From pierluigi.derosa at gmail.com  Wed Mar 21 17:55:34 2012
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Wed, 21 Mar 2012 17:55:34 +0100
Subject: [R-sig-Geo] readVECT6 errors
Message-ID: <CAAgsrZhsWGzD22Df7m=GqjsOtrRy3vdCrNBf9LzYtveiCh_p3w@mail.gmail.com>

Dear all
I'm using spgrass6 library to import GRASS vector into R.

I have a simple vector (line geometry with attribute table) called
tratti_del_castellone_parametri
so if I run:

vector=readVECT6("tratti_del_castellone_parametri")
I have:
Errore in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding
= input_field_name_encoding) :
  Cannot open layer

with the others vector file in the same mapset I have any problem to import it
where I'm wrong?
thanks


-- 
Ing. Pierluigi De Rosa (PhD)
tel: 075 791 0278 / fax: 075 7823038
cel: 3497558268
skype: pierluigi.derosa


From Roger.Bivand at nhh.no  Wed Mar 21 19:46:14 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2012 19:46:14 +0100 (CET)
Subject: [R-sig-Geo] readVECT6 errors
In-Reply-To: <CAAgsrZhsWGzD22Df7m=GqjsOtrRy3vdCrNBf9LzYtveiCh_p3w@mail.gmail.com>
References: <CAAgsrZhsWGzD22Df7m=GqjsOtrRy3vdCrNBf9LzYtveiCh_p3w@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203211943170.11514@reclus.nhh.no>

On Wed, 21 Mar 2012, pierluigi de rosa wrote:

> Dear all
> I'm using spgrass6 library to import GRASS vector into R.
>
> I have a simple vector (line geometry with attribute table) called
> tratti_del_castellone_parametri
> so if I run:
>
> vector=readVECT6("tratti_del_castellone_parametri")
> I have:
> Errore in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding
> = input_field_name_encoding) :
>  Cannot open layer
>
> with the others vector file in the same mapset I have any problem to 
> import it where I'm wrong? thanks

Please consider the statgrass list for this kind of question. Can you 
export the vector from GRASS with v.out.ogr? What versions of R, rgdal, 
GDAL, GRASS, and which OS are you using? There is a difference between 
this vector and the others, which needs to be found. What does v.info say?

Roger


>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From fairyland118 at gmail.com  Wed Mar 21 21:16:49 2012
From: fairyland118 at gmail.com (anny peng)
Date: Wed, 21 Mar 2012 16:16:49 -0400
Subject: [R-sig-Geo] "txt" to "listw"
In-Reply-To: <CANZYGDepmi1C4MEnWDbLedHpZzgAwzvm7B39+3W3LQnb+fRGxw@mail.gmail.com>
References: <CANZYGDepmi1C4MEnWDbLedHpZzgAwzvm7B39+3W3LQnb+fRGxw@mail.gmail.com>
Message-ID: <CANZYGDf9Sp=L=HhhUkM=7n5U3cVfeEcGywrASOca_qrhPYOZ9Q@mail.gmail.com>

Dear R users,

Thank Dr. Divand for creating spdep, and thank everyone for your attention.

I attach a 30*30 matrix, which consists of 0 and 1.  The matrix is  a
"txt" file.  I would like to change this matrix into a ".listw" file
so that I can estimate spatial auto-correlation.

As a new user, I have difficulties in reading "txt" file and use the
function "mat2listw".

Below are my errors.


data1= read.fwf("30_30.txt", widths=1)


coords <- coordinates(data1)
col005 <- dnearneigh(points, 0, 1, attr(col.gal.nb, row.names = IDs))
summary(col005)
col005.w.mat <- nb2mat(col005, zero.policy=TRUE)
col005.w.b <- mat2listw(col005.w.mat)

......



Best regard
Zz
-------------- next part --------------
							1	1													1								
			1																						1			1	
															1						1	1							
	1																								1				
																		1											1
																	1										1		
																	1												
1								1																					
1							1																						
																							1		1				
											1	1		1								1							
										1				1					1										
										1										1		1		1					
																						1		1					
										1	1											1							
		1																			1								
																										1			
					1	1																							
				1																						1			1
											1																		
												1																	
1		1													1														
		1								1		1	1	1										1					
									1																				
												1	1									1							
	1		1						1																				
																1		1											
					1																								1
	1																												
				1														1									1		

From fairyland118 at gmail.com  Wed Mar 21 21:47:37 2012
From: fairyland118 at gmail.com (anny peng)
Date: Wed, 21 Mar 2012 16:47:37 -0400
Subject: [R-sig-Geo] "txt" to "listw"
Message-ID: <CANZYGDdts5rP9XmBbvXS4H_Lh88wpRkhtYmAqO=mYSi_rdZMnw@mail.gmail.com>

Dear R users,

Thank Dr. Divand for creating spdep, and thank everyone for your attention.

I attach a 30*30 matrix, which consists of 0 and 1.  The matrix is  a
"txt" file.  I would like to change this matrix into a ".listw" file
so that I can estimate spatial auto-correlation.

As a new user, I have difficulties in reading "txt" file and use the
function "mat2listw".

Below are my errors.


data1= read.fwf("30_30.txt", widths=1)


coords <- coordinates(data1)
col005 <- dnearneigh(points, 0, 1, attr(col.gal.nb, row.names = IDs))
summary(col005)
col005.w.mat <- nb2mat(col005, zero.policy=TRUE)
col005.w.b <- mat2listw(col005.w.mat)

......



Best regard
Zz
-------------- next part --------------
							1	1													1								
			1																						1			1	
															1						1	1							
	1																								1				
																		1											1
																	1										1		
																	1												
1								1																					
1							1																						
																							1		1				
											1	1		1								1							
										1				1					1										
										1										1		1		1					
																						1		1					
										1	1											1							
		1																			1								
																										1			
					1	1																							
				1																						1			1
											1																		
												1																	
1		1													1														
		1								1		1	1	1										1					
									1																				
												1	1									1							
	1		1						1																				
																1		1											
					1																								1
	1																												
				1														1									1		

From fairyland118 at gmail.com  Wed Mar 21 21:53:59 2012
From: fairyland118 at gmail.com (Zz)
Date: Wed, 21 Mar 2012 16:53:59 -0400
Subject: [R-sig-Geo] "read.fwf" and "mat2listw".
Message-ID: <CANZYGDd1ptPB7QAJokdAduSiXFFK2f65MR5Evpx==VmsLGkuhw@mail.gmail.com>

Dear R users,

Thank Dr. Divand for creating spdep, and thank everyone for your attention.

I attach a 30*30 matrix, which consists of 0 and 1.  The matrix is  a
"txt" file.  I would like to change this matrix into a ".listw" file
so that I can estimate spatial auto-correlation. As a new user, I have
difficulties in using "read.fwf" and "mat2listw".  Below are my
errors.


data1= read.fwf("30_30.txt", widths=1)


coords <- coordinates(data1)
col005 <- dnearneigh(points, 0, 1, attr(col.gal.nb, row.names = IDs))
summary(col005)
col005.w.mat <- nb2mat(col005, zero.policy=TRUE)
col005.w.b <- mat2listw(col005.w.mat)

......

Thank you

 Zz
-------------- next part --------------
							1	1													1								
			1																						1			1	
															1						1	1							
	1																								1				
																		1											1
																	1										1		
																	1												
1								1																					
1							1																						
																							1		1				
											1	1		1								1							
										1				1					1										
										1										1		1		1					
																						1		1					
										1	1											1							
		1																			1								
																										1			
					1	1																							
				1																						1			1
											1																		
												1																	
1		1													1														
		1								1		1	1	1										1					
									1																				
												1	1									1							
	1		1						1																				
																1		1											
					1																								1
	1																												
				1														1									1		

From fmarkham at gmail.com  Wed Mar 21 23:29:14 2012
From: fmarkham at gmail.com (Francis Markham)
Date: Thu, 22 Mar 2012 09:29:14 +1100
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
In-Reply-To: <4F69EA17.9000609@ipimar.pt>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
	<4F69EA17.9000609@ipimar.pt>
Message-ID: <CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120322/a04a7e1d/attachment.pl>

From HodgessE at uhd.edu  Wed Mar 21 23:32:13 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 21 Mar 2012 17:32:13 -0500
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into aESRI
	file
In-Reply-To: <CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv><4F69EA17.9000609@ipimar.pt>
	<CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA20106D4058@BALI.uhd.campus>

I've run into the same thing...am somewhat relieved to hear that it's not the dreaded "just me".


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Francis Markham
Sent: Wednesday, March 21, 2012 5:29 PM
To: Cristina Silva
Cc: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into aESRI file

I've experienced the same problem. How would one go about submitting a bug report to rgdal on this?

-F

On 22 March 2012 01:47, Cristina Silva <csilva at ipimar.pt> wrote:

> Thanks Joona and Bastien for your contribution. In fact, the problem 
> was that I also had a dot in a variable name. After changing this, 
> everything was OK.
>
> Regards,
>
> Cristina
>
>
> On 21/03/2012 12:05, Bastien.Ferland-Raymond at mrnf.**gouv.qc.ca<Bastien.Ferland-Raymond at mrnf.gouv.qc.ca>wrote:
>
>> I Cristina,
>>
>> I personally had success with the writeOGR of the rgdal package to 
>> export shape to ESRI.  I initially had the same error as you, which 
>> is not being able to get the dbf to display the data properly.  As 
>> Joona said, the problem was related to the field names.  In my case, 
>> if I recall well, I had dots in my fields names.  You should 
>> investigate that and try to get the simplest field names possible; 
>> short, no dots or other special characters, etc.
>>
>> Good luck,
>>
>> Bastien
>>
>>
>> Subject: Re: [R-sig-Geo] Fwd: Re: Conversion of a
>>         SpatialPolygonsDataFrame into a ESRI file 
>> Message-ID:<4F687F59.90104 at cs.**helsinki.fi<4F687F59.90104 at cs.helsink
>> i.fi>
>> >
>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>
>> Hi Cristina,
>>
>> Which version of ArcGIS are you using? The dbf-format is notorious 
>> for mangling the field names longer than 10 characters. I can't 
>> imagine how this might prevent the attribute table from showing, but you never know.
>>
>> In ArcGIS, you could just try exporting the shapefile into a new file 
>> (shapefile or geodatabase feature layer) and see if the new file 
>> behaves better.
>>
>> Joona
>>
>> On 03/20/2012 02:37 PM, Cristina Silva wrote:
>>
>>> Sorry, I didn't reply for the list.
>>>
>>> Cristina
>>>
>>> -------- Original Message --------
>>> Subject:      Re: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame
>>> into
>>> a ESRI file
>>> Date:         Tue, 20 Mar 2012 12:15:46 +0000
>>> From:         Cristina Silva<csilva at ipimar.pt>
>>> To:   P?nar Aslantas Bostan<aslantas at metu.edu.tr>
>>>
>>>
>>> Hi Pinar,
>>>
>>> The problem is not to get the data, this can be done directly with 
>>> write.csv or write.table. I was looking for a package/function to 
>>> export the whole spatial object to a ESRI shapefile with all the 
>>> files needed (.shp, .shx, .prj and .dbf). With writeOGR I can do 
>>> this but the resulting .dbf file is not read properly, although the 
>>> data are there.
>>>
>>> Thanks anyway.
>>>
>>> Cristina
>>>
>>> On 20/03/2012 11:36, P?nar Aslantas Bostan wrote:
>>>
>>>>   Dear Cristina,
>>>>
>>>>   For this purpose I use "write.table" function.
>>>>
>>>>   my code is this;
>>>>
>>>>   write.table(dem, file="D:\\Data\\dem_outputs.**txt", quote = 
>>>> TRUE, dec = ".",
>>>>   qmethod = c("escape", "double"))
>>>>
>>>>   # "dem" is SpatialPixelsDataFrame in my study.
>>>>
>>>>   then you can add your data as txt file in ArcGis.
>>>>
>>>>   I hope this helps.
>>>>
>>>>   Best wishes,
>>>>   Pinar
>>>>
>>>>
>>>>   -----Original Message-----
>>>>   From: r-sig-geo-bounces at r-project.**org<r-sig-geo-bounces at r-project.org>
>>>>   
>>>> [mailto:r-sig-geo-bounces at r-**project.org<r-sig-geo-bounces at r-proje
>>>> ct.org>]
>>>> On Behalf Of Cristina Silva
>>>>   Sent: Tuesday, March 20, 2012 1:11 PM
>>>>   To: r-sig-geo at r-project.org
>>>>   Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame 
>>>> into a ESRI
>>>>   file
>>>>
>>>>   Dear all,
>>>>
>>>>   I need to export a SpatialPolygonsDataFrame to a shapefile to  be 
>>>> read by
>>>>   ArcGIS. I have used several packages and functions to do this 
>>>> with different
>>>>   results.
>>>>
>>>>   1) with maptools, function writePolyShape: The file .prj is not 
>>>> created
>>>>
>>>>   2) with spsurvey, function sp2shape: Doesn't work, gives the following
>>>>   message "Error: Opening .prj file in C function 
>>>> writeShapeFilePolygon"
>>>>
>>>>   3) with rgdal, function writeOGR:
>>>>
>>>>      * with data projected (transforming longlat into utm) or not
>>>> (longlat:
>>>>        the file is read by ArcGIS. However, when I try to open the
>>>>        Attributes table, it gives the message that could not load 
>>>> the data
>>>>        from the data source, suggests to refresh (which is not possible)
>>>>        and opens an empty table, although having the number of 
>>>> columns and
>>>>        lines of the data. Looking for the info of each polygon in 
>>>> the map,
>>>>        the data are displayed for each individual record. So, the data
>>>>        exist but are not acessible from the Attributes Table.
>>>>      * To display the Attributes Table, I had to convert the .dbf 
>>>> file in
>>>>        .csv and export again as a .dbf.
>>>>
>>>>   Is there any better way to make this conversion?
>>>>
>>>>   Cristina
>>>>
>>>>   --
>>>>   ------------------------------**------------
>>>>   Cristina Silva
>>>>   INRB/L-IPIMAR
>>>>   Unidade de Recursos Marinhos e Sustentabilidade Av. de Brasmlia,
>>>> 1449-006
>>>>   Lisboa Portugal
>>>>   Tel.: 351 21 3027096
>>>>   Fax: 351 21 3015948
>>>>   csilva at ipimar.pt
>>>>
>>>>
>>>>      [[alternative HTML version deleted]]
>>>>
>>>>
>>>>
>>>
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.
>>> ch/mailman/listinfo/r-sig-geo>
>>>
>>
>>
>>
>>
>>
>
> --
> ------------------------------**------------
> Cristina Silva
> INRB/L-IPIMAR
> Unidade de Recursos Marinhos e Sustentabilidade Av. de Bras?lia, 
> 1449-006 Lisboa
>
> Portugal
> Tel.: 351 21 3027096
> Fax: 351 21 3015948
> csilva at ipimar.pt
>
> ______________________________**_________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch
> /mailman/listinfo/r-sig-geo>
>

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Thu Mar 22 00:57:53 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 21 Mar 2012 23:57:53 +0000
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
In-Reply-To: <CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
	<4F69EA17.9000609@ipimar.pt>
	<CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
Message-ID: <CANVKczNq0Nn5FYCVeJ8QQRQcwADP60eZnA1GvZ5HDGjXavHS_w@mail.gmail.com>

On Wed, Mar 21, 2012 at 10:29 PM, Francis Markham <fmarkham at gmail.com> wrote:
> I've experienced the same problem. How would one go about submitting a bug
> report to rgdal on this?

 How is it a bug with rgdal? I've just had a look for the spec of
dBase files, and the only one I can find:

http://www.dbase.com/Knowledgebase/INT/db7_file_fmt.htm

 says the field name is "32 bytes 	Field name in ASCII (zero-filled)."
I just tried R with rgdal and it could write and read quite happily a
SpatialPointsDataFrame with dots in the field names. Try this:

library(sp)
library(rgdal)
df = data.frame(x=runif(10),y=runif(10),zz=runif(10))
coordinates(df)=~x+y
writeOGR(df,".","junk","ESRI Shapefile")

names(df)="z.z"
writeOGR(df,".","junk2","ESRI Shapefile")

 - both work for me, and QGIS can read them in, and R can read them
back into fresh sessions. If anything its a bug in ArcGIS, but without
a good description of the failing shapefile (exact item names for
starters) we're guessing.

 It might be *non-ascii* field names, which aren't covered by the spec
I just read but might be by some other extension. You can handle this
in R by setting the Encoding of the field names explicitly.

Barry


From fmarkham at gmail.com  Thu Mar 22 01:21:07 2012
From: fmarkham at gmail.com (Francis Markham)
Date: Thu, 22 Mar 2012 11:21:07 +1100
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
In-Reply-To: <CANVKczNq0Nn5FYCVeJ8QQRQcwADP60eZnA1GvZ5HDGjXavHS_w@mail.gmail.com>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
	<4F69EA17.9000609@ipimar.pt>
	<CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
	<CANVKczNq0Nn5FYCVeJ8QQRQcwADP60eZnA1GvZ5HDGjXavHS_w@mail.gmail.com>
Message-ID: <CACsciEgAaxMLvk5495Zg358CG2wrH6tLTTvBLn0s1Htw4xyuyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120322/64f834b4/attachment.pl>

From adamhsparks at gmail.com  Thu Mar 22 01:56:41 2012
From: adamhsparks at gmail.com (Adam Sparks)
Date: Thu, 22 Mar 2012 08:56:41 +0800
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <1332329643243-7391985.post@n2.nabble.com>
References: <1332262025789-7389731.post@n2.nabble.com>
	<CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
	<CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>
	<1332329643243-7391985.post@n2.nabble.com>
Message-ID: <CAJmQPwGbmy2QLkt1DDMpJ7PVTnDgy-suRsOPibJUg09Ov3RvHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120322/f48fbae3/attachment.pl>

From zhyj830515 at 126.com  Thu Mar 22 07:05:03 2012
From: zhyj830515 at 126.com (Jessie Zhang)
Date: Wed, 21 Mar 2012 23:05:03 -0700 (PDT)
Subject: [R-sig-Geo] how to choose best parameters of variogram model in
	gstat
Message-ID: <1332396303210-7394459.post@n2.nabble.com>

Dear all,

I?m very confused about kriging interpolation using package ?gstat?. As I
know, there are two steps to do kriging interpolation. Firstly, define the
variogram structure of the sample data and choose the best parameters (Sill,
nugget and range). Secondly, predict the values of the unknown locations. I
want to interpolate the daily concentration of PM10 using Kriging with 27
observed stations for three years (1109 days). 

My questions as follow:
1.  How to choose the best parameters of model, by visual fit or statistical
fit? I attached my program and results for visual fit. Where was I wrong?
For statistical fit, what should I do?

##visual fit##
data<-read.csv("pm.csv",header=T)
http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/pm.csv pm.csv 
coordinates(data)<-~x+y
d<-variogram(pm10~1,data)
plot(d)##Figure 1##
http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_1.png 

## as display in the figure, I choose the parameters like b##
b<-vgm(2500,"Sph",0.2,100)
plot(d,model=b)##Figure 2
http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_2.png 
 
2.  As the variogram structure is very different for each day, I think it?s
better to define the parameters day by day. I need to do it for 1109 times.
Is it possible to do it automatically?

Thanks a lot for everyone.

Jessie zhang


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7394459.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Thu Mar 22 07:34:39 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Thu, 22 Mar 2012 07:34:39 +0100
Subject: [R-sig-Geo] how to choose best parameters of variogram model
 in	gstat
In-Reply-To: <1332396303210-7394459.post@n2.nabble.com>
References: <1332396303210-7394459.post@n2.nabble.com>
Message-ID: <4F6AC7FF.5030405@tum.de>

Jessie,

Am 22.03.2012 07:05, schrieb Jessie Zhang:
> Dear all,
>
> I?m very confused about kriging interpolation using package ?gstat?. As I
> know, there are two steps to do kriging interpolation. Firstly, define the
> variogram structure of the sample data and choose the best parameters (Sill,
> nugget and range). Secondly, predict the values of the unknown locations. I
> want to interpolate the daily concentration of PM10 using Kriging with 27
> observed stations for three years (1109 days).
>
> My questions as follow:
> 1.  How to choose the best parameters of model, by visual fit or statistical
> fit? I attached my program and results for visual fit. Where was I wrong?
> For statistical fit, what should I do?

?fit.variogram

> ##visual fit##
> data<-read.csv("pm.csv",header=T)
> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/pm.csv pm.csv
> coordinates(data)<-~x+y
> d<-variogram(pm10~1,data)
> plot(d)##Figure 1##
> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_1.png
>
> ## as display in the figure, I choose the parameters like b##
> b<-vgm(2500,"Sph",0.2,100)
> plot(d,model=b)##Figure 2
> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_2.png
>
> 2.  As the variogram structure is very different for each day, I think it?s
> better to define the parameters day by day. I need to do it for 1109 times.
> Is it possible to do it automatically?

E.g. in a loop (?for) ...

varmods <- list()
for (i in 1:1109) varmods[[i]] <- fit.variogram(d, b)

...or by means of lapply and the like. Maybe your interested in the 
package automap too.

Tom

> Thanks a lot for everyone.
>
> Jessie zhang
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7394459.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From edzer.pebesma at uni-muenster.de  Thu Mar 22 08:42:01 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 22 Mar 2012 08:42:01 +0100
Subject: [R-sig-Geo] how to choose best parameters of variogram model
 in	gstat
In-Reply-To: <4F6AC7FF.5030405@tum.de>
References: <1332396303210-7394459.post@n2.nabble.com>
	<4F6AC7FF.5030405@tum.de>
Message-ID: <4F6AD7C9.70709@uni-muenster.de>

You also may want to look at R package automap.

On 03/22/2012 07:34 AM, Tom Gottfried wrote:
> Jessie,
> 
> Am 22.03.2012 07:05, schrieb Jessie Zhang:
>> Dear all,
>>
>> I?m very confused about kriging interpolation using package ?gstat?. As I
>> know, there are two steps to do kriging interpolation. Firstly, define
>> the
>> variogram structure of the sample data and choose the best parameters
>> (Sill,
>> nugget and range). Secondly, predict the values of the unknown
>> locations. I
>> want to interpolate the daily concentration of PM10 using Kriging with 27
>> observed stations for three years (1109 days).
>>
>> My questions as follow:
>> 1.  How to choose the best parameters of model, by visual fit or
>> statistical
>> fit? I attached my program and results for visual fit. Where was I wrong?
>> For statistical fit, what should I do?
> 
> ?fit.variogram
> 
>> ##visual fit##
>> data<-read.csv("pm.csv",header=T)
>> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/pm.csv pm.csv
>> coordinates(data)<-~x+y
>> d<-variogram(pm10~1,data)
>> plot(d)##Figure 1##
>> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_1.png
>>
>> ## as display in the figure, I choose the parameters like b##
>> b<-vgm(2500,"Sph",0.2,100)
>> plot(d,model=b)##Figure 2
>> http://r-sig-geo.2731867.n2.nabble.com/file/n7394459/Figure_2.png
>>
>> 2.  As the variogram structure is very different for each day, I think
>> it?s
>> better to define the parameters day by day. I need to do it for 1109
>> times.
>> Is it possible to do it automatically?
> 
> E.g. in a loop (?for) ...
> 
> varmods <- list()
> for (i in 1:1109) varmods[[i]] <- fit.variogram(d, b)
> 
> ...or by means of lapply and the like. Maybe your interested in the
> package automap too.
> 
> Tom
> 
>> Thanks a lot for everyone.
>>
>> Jessie zhang
>>
>>
>> -- 
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7394459.html
>>
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hengl at spatial-analyst.net  Thu Mar 22 09:34:06 2012
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 22 Mar 2012 09:34:06 +0100
Subject: [R-sig-Geo] Vacancy: Database/Programming specialist at ISRIC
Message-ID: <4F6AE3FE.5010601@spatial-analyst.net>


Vacancy number: ESG ISR-0009
Department: ISRIC / Wageningen University
Function type: IT
Scientific field: Agriculture and Natural Environment
Contract duration: 2 years, with possibility for extension
Closing date for applications: 2 April 2012
URL for more info: http://www.wur.nl/UK/work/Vacancies+New/

ISRIC is seeking a dedicated database specialist with extensive and 
proven programming skills.

Requirements:
--------------------
A minimum of 5 years' experience in:
- Managing and developing database- driven applications in a LINUX 
environment;
- Keeping track of new developments in relevant knowledge fields
supporting and maintaining PostgresSQL / PostGIS or similar database system;

A minimum of 5 years' experience in programming
- Development of procedures in Python, PHP, JavaScript, and/or Java
- Development of web applications / graphical user interfaces, 
preferably in Django
- Minimum two-year degree in information technology, computer science, 
or related field
- Familiar with Open Source Geoinformatics software.
- Knowledge of environmental/soil science issues, and information 
analysis and data modelling.
- proficiency in writing procedure manuals, instructions and 
presentations; proven track record, demonstrated by examples of output.
- Good interpersonal and communication skills, both in English and Dutch.

We offer
--------------------
Scale 10 with maximum salary of 3755.00 (Euro?s gross per month) Social 
benefits including holiday and ?end of year? allowances
Contract duration: 2 years, with possibility for extension
Maximum working hours per week: 38

Major duties:
--------------------
- Responsible for the implementation, maintenance and daily operations 
of ISRIC?s spatially-enabled World Soil Information System (WOSIS) 
including development and testing of new procedures for the registration 
and inclusion of newly acquired data, quality assessment/control and 
versioning.
- Development of web-based services with respect to ISRIC?s function as 
the ICSU-designated World Data Centre for Soil (includes user interfaces 
for data export and data import using Web2.0 techniques, Web Mapping 
Services, Web Feature Services, Web Processing Services)
- Maintenance and development of UML schema for XML data exchange in the 
soil domain
- Provide support to the ISRIC staff with respect to specific 
computational issues

We are
--------------------
ISRIC ? World Soil Information has a leading role in several large 
international projects aimed at developing a new soil map of the world 
(see www.isric.org), being one of the prime objectives of ISRIC.
Awareness on the importance of soils in global developments has 
increased in the policy arena and society and it is now widely realized 
that soils play a key role in food production, climate change, 
maintenance of biodiversity, production of energy crops and the 
management of soil water.

Wageningen University and Research centre
Delivering a substantial contribution to the quality of life. That's our 
focus ? each and every day. Within our domain, healthy food and living 
environment, we search for answers to issues affecting society ? such as 
sustainable food production, climate change and alternative energy. Of 
course, we don?t do this alone. Every day, 6,500 people work on ?the 
quality of life?, turning ideas into reality, on a global scale.

Could you be one of these people? We give you the space you need.

For further information about working at Wageningen UR, take a look at 
www.jobsat.wur.nl.


From b.rowlingson at lancaster.ac.uk  Thu Mar 22 09:38:00 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 22 Mar 2012 08:38:00 +0000
Subject: [R-sig-Geo] Conversion of a SpatialPolygonsDataFrame into a
	ESRI file
In-Reply-To: <CACsciEgAaxMLvk5495Zg358CG2wrH6tLTTvBLn0s1Htw4xyuyA@mail.gmail.com>
References: <161DC602615F6943A19BAEA3DBF2E4B90186A5C2F66F@HARFANG.intranet.mrn.gouv>
	<4F69EA17.9000609@ipimar.pt>
	<CACsciEiVG-Jhe88yw-k1YgKJf1F0NMrF5gZAAK0UD501HngSdA@mail.gmail.com>
	<CANVKczNq0Nn5FYCVeJ8QQRQcwADP60eZnA1GvZ5HDGjXavHS_w@mail.gmail.com>
	<CACsciEgAaxMLvk5495Zg358CG2wrH6tLTTvBLn0s1Htw4xyuyA@mail.gmail.com>
Message-ID: <CANVKczN8_YaEFBqOkWF2k2qd3-ccb2QT_x31syBsZDaBCQQ2tg@mail.gmail.com>

On Thu, Mar 22, 2012 at 12:21 AM, Francis Markham <fmarkham at gmail.com> wrote:
> Hi Barry,
>
> I agree this is not a bug in R but a well known bug in ArcGIS. I guess
> misphrased my question - I would like to make a feature request for rgdal to
> have a parameter that makes field names (and contents) "safe" for ArcGIS, as
> I suspect I am not alone in producing shapefiles in R for consumption by
> ArcGIS users.

 Careful now, or I'll get into a rant about how much you pay for
ArcGIS and whether you are getting value for money if bugs become
'well-known'!

 Bugs in R tend to be either 'obscure' or 'fixed' :)

Barry


From momadou at yahoo.fr  Thu Mar 22 09:57:21 2012
From: momadou at yahoo.fr (Komine)
Date: Thu, 22 Mar 2012 01:57:21 -0700 (PDT)
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <CAJmQPwGbmy2QLkt1DDMpJ7PVTnDgy-suRsOPibJUg09Ov3RvHw@mail.gmail.com>
References: <1332262025789-7389731.post@n2.nabble.com>
	<CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
	<CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>
	<1332329643243-7391985.post@n2.nabble.com>
	<CAJmQPwGbmy2QLkt1DDMpJ7PVTnDgy-suRsOPibJUg09Ov3RvHw@mail.gmail.com>
Message-ID: <1332406641940-7394744.post@n2.nabble.com>

Hi, 
Thank Adam,
 I resolved the problem with "add = TRUE". Thank again.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grid-of-raster-increase-resolution-tp7389731p7394744.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From paul.hiemstra at knmi.nl  Thu Mar 22 10:58:35 2012
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 22 Mar 2012 09:58:35 +0000
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
References: <CABkCotRhbhFNUx_s5BWgyVYitDf6ipG+CKc4v3txTEWNfLj+jQ@mail.gmail.com>	<CAHT1vphJyHwXyE6iCXzjc5S25tL-FDkZuVgP9o5xOkD9AW594Q@mail.gmail.com>
	<CABkCotQx8GmqKnqXJRu43hRn72bYanoYPA=jz=1RfOdG=tCtAg@mail.gmail.com>
Message-ID: <4F6AF7CB.7090903@knmi.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120322/085063f6/attachment.pl>

From momadou at yahoo.fr  Thu Mar 22 13:46:27 2012
From: momadou at yahoo.fr (Komine)
Date: Thu, 22 Mar 2012 05:46:27 -0700 (PDT)
Subject: [R-sig-Geo] Grid of raster: increase resolution
In-Reply-To: <1332406641940-7394744.post@n2.nabble.com>
References: <1332262025789-7389731.post@n2.nabble.com>
	<CANtt_hzt1iVNKj+RA1pbMWRD7hiRx4L954rhKrTeUpzejRsTLA@mail.gmail.com>
	<CALyPt8yW+cRuZZD5gNv2tBBuhrQmdWMa_dq3Pg_02pKvPot+-g@mail.gmail.com>
	<1332329643243-7391985.post@n2.nabble.com>
	<CAJmQPwGbmy2QLkt1DDMpJ7PVTnDgy-suRsOPibJUg09Ov3RvHw@mail.gmail.com>
	<1332406641940-7394744.post@n2.nabble.com>
Message-ID: <1332420387388-7395381.post@n2.nabble.com>

Hi,
When I overlay both layers (raster and its boundary),a part of my boundary
does not display. 
It is possible to resolve this problem by reducing the resolution of my
raster, 
but I don't want to do it. I want to increase the box size of my boundary.
How to increase the extent of my boundary?
I used this code:

# Open raster
>library(raster)   
>test1<-rasterFromXYZ(Image)  
>plot(test1)
>test2<- aggregate(test2,fact=15, fun=mean) 
>plot(test2,axes=FALSE,box=FALSE)                               
# Open Boundary                                           
>library (rgdal) 
>test3<-readOGR(dsn="C",layer="Boundary")
>plot(test3,add=TRUE) 

Thank you in advance

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grid-of-raster-increase-resolution-tp7389731p7395381.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Thu Mar 22 17:11:56 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 22 Mar 2012 10:11:56 -0600
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and gplot
	from rasterVis package
Message-ID: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120322/77ad06b9/attachment.pl>

From sas0025 at auburn.edu  Fri Mar 23 02:14:21 2012
From: sas0025 at auburn.edu (Stephen Sefick)
Date: Thu, 22 Mar 2012 20:14:21 -0500
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
References: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
Message-ID: <4F6BCE6D.1070208@auburn.edu>

ggplot and lattice require that you print the output.

 pdf("mpgplot.pdf")
a <- gplot(maparaster) + geom_tile(aes(fill = value))
print(a)
dev.off()

HTH

Stephen

On Thu 22 Mar 2012 11:11:56 AM CDT, Manuel Sp?nola wrote:
> Thank you very much Paul,
>
> My problem now is with the output from gplot (rasterVis, ggplot2), the
> problem with levelplot was solved by the suggestion from Oscar Perpi??n.
>
> The map is at:
> https://docs.google.com/open?id=0B5pDw_grXll8a21uQzB5ZlRULWl3ZWZxdU44b2Nvdw
>
> mapa = read.asc("Ectophylla_alba.asc" ,gz=FALSE)
> image(mapa)
>
> write.asc(mapa, "mapar")
>
> maparaster = raster("mapar.asc")
>
> pdf("mpgplot.pdf")
> gplot(maparaster) + geom_tile(aes(fill = value))
> dev.off()
>
> Also, using ggsave (ggplot2) did not solve the problem.
>
> Best,
>
> Manuel
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
Stephen Sefick
**************************************************
Auburn University
Biological Sciences
331 Funchess Hall
Auburn, Alabama
36849
**************************************************
sas0025 at auburn.edu
http://www.auburn.edu/~sas0025
**************************************************

Let's not spend our time and resources thinking about things that are 
so little or so large that all they really do for us is puff us up and 
make us feel like gods.  We are mammals, and have not exhausted the 
annoying little problems of being mammals.

                                -K. Mullis

"A big computer, a complex algorithm and a long time does not equal 
science."

                              -Robert Gentleman


From zhyj830515 at 126.com  Fri Mar 23 03:29:45 2012
From: zhyj830515 at 126.com (Jessie Zhang)
Date: Thu, 22 Mar 2012 19:29:45 -0700 (PDT)
Subject: [R-sig-Geo] how to choose best parameters of variogram model
	in	gstat
In-Reply-To: <4F6AC7FF.5030405@tum.de>
References: <1332396303210-7394459.post@n2.nabble.com>
	<4F6AC7FF.5030405@tum.de>
Message-ID: <1332469785054-7397509.post@n2.nabble.com>

Tom,

Thank you very much. I am dealing with the package "automap". I have writen
a loop program, but it dosen't work. I attached the dataset of sample
http://r-sig-geo.2731867.n2.nabble.com/file/n7397509/sampledata.csv
sampledata.csv  and predict locations
http://r-sig-geo.2731867.n2.nabble.com/file/n7397509/bj.csv bj.csv . Would
you help me to find out what's wrong with my program?

Thank you again.

The program:

library(gstat)
library(automap)

data<-read.csv("sampledata.csv",header=T)
pred.basis<-read.csv("bj.csv",header=T)
data$date<-as.Date(data$date)
day<-unique(data$date)
length<-length(day)

pred.data<-matrix(NA, nrow = length(pred.basis[,1]), ncol=length,
byrow=TRUE,
               dimnames = list(pred.basis$id,day))
reshape.data<- reshape(data, v.names="pm10", idvar="station",
                timevar="date", direction="wide")

### write a loop to model data
for (k in 4:13){
## compute missing data
for(i in 1: 27){
if (is.na(reshape.data[,k][i]))
reshape.data[,k][i]=mean(reshape.data[,k],na.rm=T)
}
coordinates(reshape.data)<-~x+y
model.auto<-autoKrige(reshape.data[,k],pred.basis)
}

The error information is:
Error in eval(expr, envir, enclos) : object 'pm10.2008' not found


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7397509.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zhyj830515 at 126.com  Fri Mar 23 03:39:20 2012
From: zhyj830515 at 126.com (Jessie Zhang)
Date: Thu, 22 Mar 2012 19:39:20 -0700 (PDT)
Subject: [R-sig-Geo] how to choose best parameters of variogram model
	in	gstat
In-Reply-To: <4F6AD7C9.70709@uni-muenster.de>
References: <1332396303210-7394459.post@n2.nabble.com>
	<4F6AC7FF.5030405@tum.de> <4F6AD7C9.70709@uni-muenster.de>
Message-ID: <1332470360780-7397519.post@n2.nabble.com>

Edzer, 

Thank you very much. I searched three papers of yours related to automation.
I learned some theoretic knowledge about automatic interpolation. However, I
still confused how to do it in the program.

Now,I am dealing with the package "automap". I have writen a loop program,
but it dosen't work. I attached the dataset of samples
http://r-sig-geo.2731867.n2.nabble.com/file/n7397519/sampledata.csv
sampledata.csv  and predict locations
http://r-sig-geo.2731867.n2.nabble.com/file/n7397519/bj.csv bj.csv . Would
you help me to find out what's wrong with my program? 

Thank you again. 

The program: 

library(gstat) 
library(automap) 

data<-read.csv("sampledata.csv",header=T) 
pred.basis<-read.csv("bj.csv",header=T) 
data$date<-as.Date(data$date) 
day<-unique(data$date) 
length<-length(day) 

pred.data<-matrix(NA, nrow = length(pred.basis[,1]), ncol=length,
byrow=TRUE, 
               dimnames = list(pred.basis$id,day)) 
reshape.data<- reshape(data, v.names="pm10", idvar="station", 
                timevar="date", direction="wide") 

### write a loop to model data 
for (k in 4:13){ 
## compute missing data 
for(i in 1: 27){ 
if (is.na(reshape.data[,k][i]))
reshape.data[,k][i]=mean(reshape.data[,k],na.rm=T) 
} 
coordinates(reshape.data)<-~x+y 
model.auto<-autoKrige(reshape.data[,k],pred.basis) 
} 

The error information is: 
Error in eval(expr, envir, enclos) : object 'pm10.2008' not found 


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7397519.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From baptiste.auguie at googlemail.com  Fri Mar 23 03:46:22 2012
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Fri, 23 Mar 2012 15:46:22 +1300
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
References: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
Message-ID: <CANLFJPo5FZhuaUdvgsMhSFq5W5zvRZxyFVC7CAe3+DUYWU3MNA@mail.gmail.com>

My initial suggestion was to try panel.levelplot.raster with lattice,
and correspondingly geom_raster with ggplot2. Did you try it?

b.

On 23 March 2012 05:11, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Thank you very much Paul,
>
> My problem now is with the output from gplot (rasterVis, ggplot2), the
> problem with levelplot was solved by the suggestion from Oscar Perpi??n.
>
> The map is at:
> https://docs.google.com/open?id=0B5pDw_grXll8a21uQzB5ZlRULWl3ZWZxdU44b2Nvdw
>
> mapa = read.asc("Ectophylla_alba.asc" ,gz=FALSE)
> image(mapa)
>
> write.asc(mapa, "mapar")
>
> maparaster = raster("mapar.asc")
>
> pdf("mpgplot.pdf")
> gplot(maparaster) + geom_tile(aes(fill = value))
> dev.off()
>
> Also, using ggsave (ggplot2) did not solve the problem.
>
> Best,
>
> Manuel
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Fri Mar 23 09:22:02 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 23 Mar 2012 09:22:02 +0100
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <4F6BCE6D.1070208@auburn.edu>
References: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
	<4F6BCE6D.1070208@auburn.edu>
Message-ID: <4F6C32AA.7000301@uni-muenster.de>

No:

require(lattice)
pdf("x.pdf")
xyplot(1~1)
dev.off()

produces the pdf with the plot I expected.

Calling print() on trellis objects is needed when this is not the
default action, for instance in a loop or a { } block where the plot is
not the return value. I guess that this is the same for gplot.

On 03/23/2012 02:14 AM, Stephen Sefick wrote:
> ggplot and lattice require that you print the output.
> 
> pdf("mpgplot.pdf")
> a <- gplot(maparaster) + geom_tile(aes(fill = value))
> print(a)
> dev.off()
> 
> HTH
> 
> Stephen
> 
> On Thu 22 Mar 2012 11:11:56 AM CDT, Manuel Sp?nola wrote:
>> Thank you very much Paul,
>>
>> My problem now is with the output from gplot (rasterVis, ggplot2), the
>> problem with levelplot was solved by the suggestion from Oscar Perpi??n.
>>
>> The map is at:
>> https://docs.google.com/open?id=0B5pDw_grXll8a21uQzB5ZlRULWl3ZWZxdU44b2Nvdw
>>
>>
>> mapa = read.asc("Ectophylla_alba.asc" ,gz=FALSE)
>> image(mapa)
>>
>> write.asc(mapa, "mapar")
>>
>> maparaster = raster("mapar.asc")
>>
>> pdf("mpgplot.pdf")
>> gplot(maparaster) + geom_tile(aes(fill = value))
>> dev.off()
>>
>> Also, using ggsave (ggplot2) did not solve the problem.
>>
>> Best,
>>
>> Manuel
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Stephen Sefick
> **************************************************
> Auburn University
> Biological Sciences
> 331 Funchess Hall
> Auburn, Alabama
> 36849
> **************************************************
> sas0025 at auburn.edu
> http://www.auburn.edu/~sas0025
> **************************************************
> 
> Let's not spend our time and resources thinking about things that are so
> little or so large that all they really do for us is puff us up and make
> us feel like gods.  We are mammals, and have not exhausted the annoying
> little problems of being mammals.
> 
>                                -K. Mullis
> 
> "A big computer, a complex algorithm and a long time does not equal
> science."
> 
>                              -Robert Gentleman
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gottiannamaria at virgilio.it  Fri Mar 23 12:02:47 2012
From: gottiannamaria at virgilio.it (gottiannamaria at virgilio.it)
Date: Fri, 23 Mar 2012 12:02:47 +0100 (CET)
Subject: [R-sig-Geo] bubble maps for Italian cities
Message-ID: <1363f3916a5.gottiannamaria@virgilio.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120323/3707c8c0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Mar 23 13:10:01 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 23 Mar 2012 13:10:01 +0100
Subject: [R-sig-Geo] bubble maps for Italian cities
In-Reply-To: <1363f3916a5.gottiannamaria@virgilio.it>
References: <1363f3916a5.gottiannamaria@virgilio.it>
Message-ID: <4F6C6819.5030202@uni-muenster.de>

Annamaria,

library(sp)
xy =
SpatialPointsDataFrame(SpatialPoints(expand.grid(x=1:10,y=1:10)),data.frame(z=1:100))
plot(xy, cex = xy$z/mean(xy$z), col = grey(.8*xy$z/max(xy$z)), pch=16)

#or

spplot(xy, cex = xy$z/mean(xy$z), col.regions = grey(.8*xy$z/max(xy$z)))

both plot bubbles (filled circles) with different size and different colour.

On 03/23/2012 12:02 PM, gottiannamaria at virgilio.it wrote:
> Dear List,
> 
> I should prepare a series of thematic maps of Italy with some cities highlighted with bubble of different colors (to indicate different types) and others with bubble of different sizes (to indicate different amounts). I searched around a solution but to no avail. I would be very grateful if someone could give me some pointers on steps to be done. Thank you very much,
> 
> Annamaria
>   
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Mar 23 13:24:58 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Mar 2012 13:24:58 +0100 (CET)
Subject: [R-sig-Geo] "txt" to "listw"
In-Reply-To: <CANZYGDdts5rP9XmBbvXS4H_Lh88wpRkhtYmAqO=mYSi_rdZMnw@mail.gmail.com>
References: <CANZYGDdts5rP9XmBbvXS4H_Lh88wpRkhtYmAqO=mYSi_rdZMnw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203231314150.25313@reclus.nhh.no>

On Wed, 21 Mar 2012, anny peng wrote:

> Dear R users,
>
> Thank Dr. Divand for creating spdep, and thank everyone for your attention.
>
> I attach a 30*30 matrix, which consists of 0 and 1.  The matrix is  a
> "txt" file.  I would like to change this matrix into a ".listw" file
> so that I can estimate spatial auto-correlation.
>
> As a new user, I have difficulties in reading "txt" file and use the
> function "mat2listw".
>
> Below are my errors.
>
>
> data1= read.fwf("30_30.txt", widths=1)

The problem was resolved off-list. The main issue was about reading the 
tab-separated file into a matrix for use in mat2listw():

mat0 <- read.table("30_30.txt", header=FALSE, sep="\t", fill=TRUE)

and converted into a matrix with:

mat <- as.matrix(mat0)
dim(mat)

However, it has NAs, not 0, where there are no neighbours, so this must be
repaired:

summary(c(mat))
mat[is.na(mat)] <- 0
summary(c(mat))

Reading the R Data Import/Export manual would have helped, together with 
the use of CSV as the spreadsheet output format - the fields here are not 
of fixed width, although they look like that; tabs are used as field 
separators, but fields with 1s in have a width of 2, while empty fields 
have a width of 1.

Finally:

lw <- mat2listw(mat, style="B")
summary(lw)

Roger

>
>
> coords <- coordinates(data1)
> col005 <- dnearneigh(points, 0, 1, attr(col.gal.nb, row.names = IDs))
> summary(col005)
> col005.w.mat <- nb2mat(col005, zero.policy=TRUE)
> col005.w.b <- mat2listw(col005.w.mat)
>
> ......
>
>
>
> Best regard
> Zz
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mspinola10 at gmail.com  Fri Mar 23 16:08:01 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 23 Mar 2012 09:08:01 -0600
Subject: [R-sig-Geo] Saving plot as PDF from functions levelplot and
 gplot from rasterVis package
In-Reply-To: <CANLFJPo5FZhuaUdvgsMhSFq5W5zvRZxyFVC7CAe3+DUYWU3MNA@mail.gmail.com>
References: <CABkCotRExLEnzx_2ptYJoJg2zWiZqYkr5_b09uXLm4k8Rv6v6Q@mail.gmail.com>
	<CANLFJPo5FZhuaUdvgsMhSFq5W5zvRZxyFVC7CAe3+DUYWU3MNA@mail.gmail.com>
Message-ID: <CABkCotR_esjNc+m8U93W_S_Fj6AuCPJDrJGj=M=x+qt1DQtzCw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120323/e22f800b/attachment.pl>

From jstruve at ufl.edu  Fri Mar 23 18:44:23 2012
From: jstruve at ufl.edu (Struve,Juliane)
Date: Fri, 23 Mar 2012 17:44:23 +0000
Subject: [R-sig-Geo] Creating a spatial boundary using Lines() and
	SpatialLines()
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A02A637B0@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120323/0616adf2/attachment.pl>

From Roger.Bivand at nhh.no  Fri Mar 23 18:50:15 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Mar 2012 18:50:15 +0100 (CET)
Subject: [R-sig-Geo] Creating a spatial boundary using Lines() and
 SpatialLines()
In-Reply-To: <BFCE57D0BE7CBB42A581347DE375AF9A02A637B0@UFEXCH-MBXN02.ad.ufl.edu>
References: <BFCE57D0BE7CBB42A581347DE375AF9A02A637B0@UFEXCH-MBXN02.ad.ufl.edu>
Message-ID: <alpine.LRH.2.02.1203231849021.25313@reclus.nhh.no>

On Fri, 23 Mar 2012, Struve,Juliane wrote:

> Dear list,
>
> I would like to create a spatial line to be used as a boundary in 
> KernelUD(). But my code yields an error message.
>
> bound <- cbind(c(-40,-40,-30,-30,-20,0,20,30,50,100),c(-40,-20,-10,0,10,20,30,30,50,50))
> Slo1 <- Line(bound)
> Sli1 <- Lines(list(Slo1, ID="coastline"))

Sli1 <- Lines(list(Slo1), ID="coastline")

> coastline <- SpatialLines(list(Sli1),ID="coastline")

coastline <- SpatialLines(list(Sli1))
class(coastline)

OK?

Roger

> Sli1
> An object of class "Lines"...
>
> Error in Lines(list(Slo1, ID = "coastline")) : slinelist not a list of Line objects
>
> Would someone be able tell me why this does not work ?
>
> Thanks a lot for your time,
>
> Juliane
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From fairyland118 at gmail.com  Sat Mar 24 14:50:26 2012
From: fairyland118 at gmail.com (Zz)
Date: Sat, 24 Mar 2012 09:50:26 -0400
Subject: [R-sig-Geo] "txt" to "listw"
In-Reply-To: <alpine.LRH.2.02.1203231314150.25313@reclus.nhh.no>
References: <CANZYGDdts5rP9XmBbvXS4H_Lh88wpRkhtYmAqO=mYSi_rdZMnw@mail.gmail.com>
	<alpine.LRH.2.02.1203231314150.25313@reclus.nhh.no>
Message-ID: <CANZYGDeft7xWKZ5yha3BdLDtEmK5=gyodGa90x-1--Hjxtum8A@mail.gmail.com>

I appreciate the instant answers from Dr. Bivand and Dr. Kawalerowicz.
Your R commands help me solve a tough problem.



Wishing everyone a relaxing weekend
Zz




On 3/23/12, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 21 Mar 2012, anny peng wrote:
>
>> Dear R users,
>>
>> Thank Dr. Divand for creating spdep, and thank everyone for your
>> attention.
>>
>> I attach a 30*30 matrix, which consists of 0 and 1.  The matrix is  a
>> "txt" file.  I would like to change this matrix into a ".listw" file
>> so that I can estimate spatial auto-correlation.
>>
>> As a new user, I have difficulties in reading "txt" file and use the
>> function "mat2listw".
>>
>> Below are my errors.
>>
>>
>> data1= read.fwf("30_30.txt", widths=1)
>
> The problem was resolved off-list. The main issue was about reading the
> tab-separated file into a matrix for use in mat2listw():
>
> mat0 <- read.table("30_30.txt", header=FALSE, sep="\t", fill=TRUE)
>
> and converted into a matrix with:
>
> mat <- as.matrix(mat0)
> dim(mat)
>
> However, it has NAs, not 0, where there are no neighbours, so this must be
> repaired:
>
> summary(c(mat))
> mat[is.na(mat)] <- 0
> summary(c(mat))
>
> Reading the R Data Import/Export manual would have helped, together with
> the use of CSV as the spreadsheet output format - the fields here are not
> of fixed width, although they look like that; tabs are used as field
> separators, but fields with 1s in have a width of 2, while empty fields
> have a width of 1.
>
> Finally:
>
> lw <- mat2listw(mat, style="B")
> summary(lw)
>
> Roger
>
>>
>>
>> coords <- coordinates(data1)
>> col005 <- dnearneigh(points, 0, 1, attr(col.gal.nb, row.names = IDs))
>> summary(col005)
>> col005.w.mat <- nb2mat(col005, zero.policy=TRUE)
>> col005.w.b <- mat2listw(col005.w.mat)
>>
>> ......
>>
>>
>>
>> Best regard
>> Zz
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


From calamita_giuseppe at yahoo.it  Sat Mar 24 15:45:53 2012
From: calamita_giuseppe at yahoo.it (Giuseppe Calamita)
Date: Sat, 24 Mar 2012 07:45:53 -0700 (PDT)
Subject: [R-sig-Geo] how to choose best parameters of variogram model
	in	gstat
In-Reply-To: <1332470360780-7397519.post@n2.nabble.com>
References: <1332396303210-7394459.post@n2.nabble.com>
	<4F6AC7FF.5030405@tum.de> <4F6AD7C9.70709@uni-muenster.de>
	<1332470360780-7397519.post@n2.nabble.com>
Message-ID: <1332600353725-7401439.post@n2.nabble.com>

Hi Jessie Zhang,
I modified your code and the following works ... it will not be the most
elegant solution for sure :) (but I'm not a programmer , just a simply
useR).

# this part was ok
########################################################
library(gstat)
library(automap)
rm(list=ls())
data<-read.csv("sampledata.csv",header=T)
pred.basis<-read.csv("bj.csv",header=T)
data$date<-as.Date(data$date)
day<-unique(data$date)
length<-length(day)
pred.data<-matrix(NA, nrow = length(pred.basis[,1]), ncol=length,
byrow=TRUE,
                  dimnames = list(pred.basis$id,day))
reshape.data<- reshape(data, v.names="pm10", idvar="station",
                       timevar="date", direction="wide")
#########################################################

# I first checked and substituted NAs with the means of the data.frame
coloumn
for(k in 4: 13) {
  for(i in 1:27)   {
  if (is.na(reshape.data[,k][i])) reshape.data[,k][i]=
mean(reshape.data[,k],na.rm=T)
                       }
                    }


#explicit data objects
coordinates(reshape.data)<- ~x+y
coordinates(pred.basis)  <- ~x+y # you forgot to do this in your code


#I guess there were some problems with the names of the variables, so I
decided to use simpler and shorter names without dots

names(reshape.data) #check names
new_names<- NULL  # prepare a vector for storing new names
for(i in 1:10) new_names[i] <- paste("z",i, sep="") #create new names
names(reshape.data)[-1]<- new_names   #assign them to reshape data


#for convenience, I decided to eliminate the station col from the
reshape.data 
stations <- reshape.data at data$station #save stations separately
reshape.data at data$station <- NULL    #erase station coloumn


model.auto <- vector("list", 10) #prepare a list for storing the autokrige
output
for (i in 1:10)  model.auto[[i]]<- autoKrige(reshape.data[,i], pred.basis)

Cheers 

Giuseppe Calamita


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7401439.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From calamita_giuseppe at yahoo.it  Sat Mar 24 15:45:52 2012
From: calamita_giuseppe at yahoo.it (Giuseppe Calamita)
Date: Sat, 24 Mar 2012 07:45:52 -0700 (PDT)
Subject: [R-sig-Geo] how to choose best parameters of variogram model
	in	gstat
In-Reply-To: <1332470360780-7397519.post@n2.nabble.com>
References: <1332396303210-7394459.post@n2.nabble.com>
	<4F6AC7FF.5030405@tum.de> <4F6AD7C9.70709@uni-muenster.de>
	<1332470360780-7397519.post@n2.nabble.com>
Message-ID: <1332600352046-7401438.post@n2.nabble.com>

Hi Jessie Zhang,
I modified your code and the following works ... it will not be the most
elegant solution for sure :) (but I'm not a programmer , just a simply
useR).

# this part was ok
########################################################
library(gstat)
library(automap)
rm(list=ls())
data<-read.csv("sampledata.csv",header=T)
pred.basis<-read.csv("bj.csv",header=T)
data$date<-as.Date(data$date)
day<-unique(data$date)
length<-length(day)
pred.data<-matrix(NA, nrow = length(pred.basis[,1]), ncol=length,
byrow=TRUE,
                  dimnames = list(pred.basis$id,day))
reshape.data<- reshape(data, v.names="pm10", idvar="station",
                       timevar="date", direction="wide")
#########################################################

# I first checked and substituted NAs with the means of the data.frame
coloumn
for(k in 4: 13) {
  for(i in 1:27)   {
  if (is.na(reshape.data[,k][i])) reshape.data[,k][i]=
mean(reshape.data[,k],na.rm=T)
                       }
                    }


#explicit data objects
coordinates(reshape.data)<- ~x+y
coordinates(pred.basis)  <- ~x+y # you forgot to do this in your code


#I guess there were some problems with the names of the variables, so I
decided to use simpler and shorter names without dots

names(reshape.data) #check names
new_names<- NULL  # prepare a vector for storing new names
for(i in 1:10) new_names[i] <- paste("z",i, sep="") #create new names
names(reshape.data)[-1]<- new_names   #assign them to reshape data


#for convenience, I decided to eliminate the station col from the
reshape.data 
stations <- reshape.data at data$station #save stations separately
reshape.data at data$station <- NULL    #erase station coloumn


model.auto <- vector("list", 10) #prepare a list for storing the autokrige
output
for (i in 1:10)  model.auto[[i]]<- autoKrige(reshape.data[,i], pred.basis)

Cheers 

Giuseppe Calamita


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7401438.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zhyj830515 at 126.com  Sat Mar 24 15:52:48 2012
From: zhyj830515 at 126.com (Jessie Zhang)
Date: Sat, 24 Mar 2012 07:52:48 -0700 (PDT)
Subject: [R-sig-Geo] =?utf-8?b?5Zue5aSNOlJlOiBob3cgdG8gY2hvb3NlIGJlc3Qg?=
 =?utf-8?q?parameters_of_variogram_model_in=09gstat?=
Message-ID: <705a6424.22d05.1364531a0c8.Coremail.zhyj830515@126.com>

Hi Giuseppe Calamita ,
 
Thank you so much. I will try it soon.
 
Best regards
 
Jessie Zhang


--

 
Dept. of Occupational and Environmental Health
Peking University School of Public Health
38 Xue Yuan Road, Beijing 100191, P.R. China
Tel: +86-10-82805130
Mobile: +86-15210892212


At 2012-03-24 22:45:53,"Giuseppe Calamita [via R-sig-geo]" <ml-node+s2731867n7401439h96 at n2.nabble.com> wrote:
Hi Jessie Zhang,
I modified your code and the following works ... it will not be the most elegant solution for sure :) (but I'm not a programmer , just a simply useR).

# this part was ok
########################################################
library(gstat)
library(automap)
rm(list=ls())
data<-read.csv("sampledata.csv",header=T)
pred.basis<-read.csv("bj.csv",header=T)
data$date<-as.Date(data$date)
day<-unique(data$date)
length<-length(day)
pred.data<-matrix(NA, nrow = length(pred.basis[,1]), ncol=length, byrow=TRUE,
                  dimnames = list(pred.basis$id,day))
reshape.data<- reshape(data, v.names="pm10", idvar="station",
                       timevar="date", direction="wide")
#########################################################

# I first checked and substituted NAs with the means of the data.frame coloumn
for(k in 4: 13) {
  for(i in 1:27)   {
  if (is.na(reshape.data[,k][i])) reshape.data[,k][i]= mean(reshape.data[,k],na.rm=T)
                       }
                    }


#explicit data objects
coordinates(reshape.data)<- ~x+y
coordinates(pred.basis)  <- ~x+y # you forgot to do this in your code


#I guess there were some problems with the names of the variables, so I decided to use simpler and shorter names without dots

names(reshape.data) #check names
new_names<- NULL  # prepare a vector for storing new names
for(i in 1:10) new_names[i] <- paste("z",i, sep="") #create new names
names(reshape.data)[-1]<- new_names   #assign them to reshape data


#for convenience, I decided to eliminate the station col from the reshape.data
stations <- reshape.data at data$station #save stations separately
reshape.data at data$station <- NULL    #erase station coloumn


model.auto <- vector("list", 10) #prepare a list for storing the autokrige output
for (i in 1:10)  model.auto[[i]]<- autoKrige(reshape.data[,i], pred.basis)

Cheers

Giuseppe Calamita



If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7394459p7401439.html
To unsubscribe from how to choose best parameters of variogram model in gstat, click here.
NAML

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Re-how-to-choose-best-parameters-of-variogram-model-in-gstat-tp7401447p7401447.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From dprosser at usgs.gov  Sun Mar 25 00:15:07 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Sat, 24 Mar 2012 16:15:07 -0700 (PDT)
Subject: [R-sig-Geo] temp files in raster
Message-ID: <1332630907344-7402174.post@n2.nabble.com>

Hi R geo gurus-

I am using the raster package to run functions on large spatial datasets
(>19million cells * many iterations thereby producing large arrays or
brickrasters). 

The system has written my function to a temporary file because it is too
large to be held in memory. *Can only 1 temporary file be used? If I try to
run a subsequent function, I get an error (see below) that my temporary grid
already exists and that I should allow OVERWRITE (which I don't want). 

Is it a problem to use temporary files in this manner* *(i.e., should I
already be manually saving them to disk)?*

Thanks for any advice you might have.

the error:
> system.time(stBSte1 <- calc(s3, FUNstBSte1))
Error in .startRasterWriting(x, filename, format = filetype, ...) : 
  C:/Users/Diann/AppData/Local/Temp/R_raster_tmp/raster_tmp_9271340493.grd
exists. use 'overwrite=TRUE' if you want to overwrite it
Timing stopped at: 0.19 0 0.18 

some other info:
> showTmpFiles()
raster_tmp_5942113574 raster_tmp_67775104885 raster_tmp_9271340493 
> rasterTmpFile()
[1]
"C:/Users/Diann/AppData/Local/Temp/R_raster_tmp/raster_tmp_5652878174.grd"


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/temp-files-in-raster-tp7402174p7402174.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mspinola10 at gmail.com  Sun Mar 25 05:10:20 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 24 Mar 2012 21:10:20 -0600
Subject: [R-sig-Geo] Plotting a projected map in UTM coordinates
Message-ID: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120324/63d96428/attachment.pl>

From tom.gottfried at tum.de  Sun Mar 25 08:33:11 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Sun, 25 Mar 2012 08:33:11 +0200
Subject: [R-sig-Geo] Plotting a projected map in UTM coordinates
In-Reply-To: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>
References: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>
Message-ID: <4F6EBC27.5080406@tum.de>

Manuel,

you actually don't project your map to UTM. You just assign another CRS. 
Use spTransform() for projection.

HTH,
Tom

Am 25.03.2012 05:10, schrieb Manuel Sp?nola:
> Dear list members,
>
> I am projecting a map to UTM but when I plot the map the axes display
> geographic coordinates, do you know why?
>
>> cr =
> readOGR(dsn="/Users/manuelspinola/Documents/ProyectosRespacial/EvalHab_reporte",
> layer="Cr_wgs84_meso")
> OGR data source with driver: ESRI Shapefile
> Source:
> "/Users/manuelspinola/Documents/ProyectosRespacial/EvalHab_reporte", layer:
> "Cr_wgs84_meso"
> with 1 features and 6 fields
> Feature type: wkbPolygon with 2 dimensions
>> summary(cr)
> Object of class SpatialPolygonsDataFrame
> Coordinates:
>           min       max
> x -85.951890 -82.55642
> y   8.043422  11.22162
> Is projected: FALSE
> proj4string :
> [+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0]
> Data attributes:
>        AREA         PERIMETER       LIMITES_PA    LIMITES__1        ID
>   Min.   :4.211   Min.   :20.71   Min.   :520   Min.   :519   Min.   :2
>   1st Qu.:4.211   1st Qu.:20.71   1st Qu.:520   1st Qu.:519   1st Qu.:2
>   Median :4.211   Median :20.71   Median :520   Median :519   Median :2
>   Mean   :4.211   Mean   :20.71   Mean   :520   Mean   :519   Mean   :2
>   3rd Qu.:4.211   3rd Qu.:20.71   3rd Qu.:520   3rd Qu.:519   3rd Qu.:2
>   Max.   :4.211   Max.   :20.71   Max.   :520   Max.   :519   Max.   :2
>           PAIS
>   COSTA RICA:1
>
> proj4string(cr)<-CRS("+proj=tmerc +lon_0=-84 +lat_0=0 +x_0=500000 +k=0.9999
> +datum=WGS84")
>
>> summary(cr)
> Object of class SpatialPolygonsDataFrame
> Coordinates:
>           min       max
> x -85.951890 -82.55642
> y   8.043422  11.22162
> Is projected: TRUE
> proj4string :
> [+proj=tmerc +lon_0=-84 +lat_0=0 +x_0=500000 +k=0.9999 +datum=WGS84
> +ellps=WGS84 +towgs84=0,0,0]
> Data attributes:
>        AREA         PERIMETER       LIMITES_PA    LIMITES__1        ID
>   Min.   :4.211   Min.   :20.71   Min.   :520   Min.   :519   Min.   :2
>   1st Qu.:4.211   1st Qu.:20.71   1st Qu.:520   1st Qu.:519   1st Qu.:2
>   Median :4.211   Median :20.71   Median :520   Median :519   Median :2
>   Mean   :4.211   Mean   :20.71   Mean   :520   Mean   :519   Mean   :2
>   3rd Qu.:4.211   3rd Qu.:20.71   3rd Qu.:520   3rd Qu.:519   3rd Qu.:2
>   Max.   :4.211   Max.   :20.71   Max.   :520   Max.   :519   Max.   :2
>           PAIS
>   COSTA RICA:1
>
> Best,
>
> Manuel
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From mspinola10 at gmail.com  Sun Mar 25 15:55:04 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 25 Mar 2012 07:55:04 -0600
Subject: [R-sig-Geo] Plotting a projected map in UTM coordinates
In-Reply-To: <4F6EBC27.5080406@tum.de>
References: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>
	<4F6EBC27.5080406@tum.de>
Message-ID: <CABkCotQuN6edDeE8kPMv=Tmb8rF6POBWmRn9gnCBjO2F1WgOsQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120325/8ad750f7/attachment.pl>

From gottiannamaria at virgilio.it  Sun Mar 25 17:50:51 2012
From: gottiannamaria at virgilio.it (gottiannamaria at virgilio.it)
Date: Sun, 25 Mar 2012 17:50:51 +0200 (CEST)
Subject: [R-sig-Geo] R: Re: R: Re:  bubble maps for Italian cities
Message-ID: <1364a8d8a01.gottiannamaria@virgilio.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120325/fc16fef0/attachment.pl>

From mspinola10 at gmail.com  Sun Mar 25 19:13:45 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 25 Mar 2012 11:13:45 -0600
Subject: [R-sig-Geo] Plotting a projected map in UTM coordinates
In-Reply-To: <4F6EBC27.5080406@tum.de>
References: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>
	<4F6EBC27.5080406@tum.de>
Message-ID: <CABkCotQSLwgB1QhACXh5wSddaCa0GaEHdEX_UyfSfn2CRtMpZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120325/6d051118/attachment.pl>

From r.hijmans at gmail.com  Sun Mar 25 19:56:38 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 25 Mar 2012 10:56:38 -0700
Subject: [R-sig-Geo] temp files in raster
In-Reply-To: <1332630907344-7402174.post@n2.nabble.com>
References: <1332630907344-7402174.post@n2.nabble.com>
Message-ID: <CANtt_hxcvFnQ5hOkeea4cWuMQHZ0_3N=5X1uvhY3Ws+KoB6Xug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120325/95c61154/attachment.pl>

From dprosser at usgs.gov  Sun Mar 25 20:34:10 2012
From: dprosser at usgs.gov (Diann Prosser)
Date: Sun, 25 Mar 2012 11:34:10 -0700 (PDT)
Subject: [R-sig-Geo] temp files in raster
In-Reply-To: <1332630907344-7402174.post@n2.nabble.com>
References: <1332630907344-7402174.post@n2.nabble.com>
Message-ID: <1332700450109-7404001.post@n2.nabble.com>

Thanks for the info and workaround, Robert.
(set.seed was used)

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/temp-files-in-raster-tp7402174p7404001.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From piero.campa at gmail.com  Mon Mar 26 13:10:11 2012
From: piero.campa at gmail.com (piero campa)
Date: Mon, 26 Mar 2012 04:10:11 -0700 (PDT)
Subject: [R-sig-Geo] Variable point size with spplot
Message-ID: <1332760210994-7405527.post@n2.nabble.com>

Dear list,
I used to plot points of variable size with "spplot" this way:

library(RColorBrewer)
data(meuse)
coordinates(meuse) <- ~x+y
spplot(meuse, zcol="om",
        col.regions=colorRampPalette(brewer.pal(7, "PuBu")[-(1:1)])(20), 
        scales=list(draw=TRUE), 
        cex=.4*(1:5)
)

but now, after R upgrade, this is not working properly anymore.
As you can see from the attached image, colors are not well linked to points
size.

Any hint?

-Piero

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Variable-point-size-with-spplot-tp7405527p7405527.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From apbc2 at cam.ac.uk  Mon Mar 26 13:43:11 2012
From: apbc2 at cam.ac.uk (A.P.B. Carneiro)
Date: 26 Mar 2012 12:43:11 +0100
Subject: [R-sig-Geo] great circle distances
Message-ID: <Prayer.1.3.4.1203261243110.19293@hermes-2.csi.cam.ac.uk>

Hi

I need to calculate the average nearest neighbor distance between nests 
coordinates (lat/long). However, I would like to use the great circle 
distances in spite or Euclidian distances. Is it possible to do this in 
ArcGis 10?

Thank you for your attention,

Ana

-- 

PhD student
Evolutionary Ecology Group
Department of Zoology
University of Cambridge


From edzer.pebesma at uni-muenster.de  Mon Mar 26 14:04:18 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 Mar 2012 14:04:18 +0200
Subject: [R-sig-Geo] Variable point size with spplot
In-Reply-To: <1332760210994-7405527.post@n2.nabble.com>
References: <1332760210994-7405527.post@n2.nabble.com>
Message-ID: <4F705B42.4050909@uni-muenster.de>



On 03/26/2012 01:10 PM, piero campa wrote:
> Dear list,
> I used to plot points of variable size with "spplot" this way:
> 
> library(RColorBrewer)
> data(meuse)
> coordinates(meuse) <- ~x+y
> spplot(meuse, zcol="om",
>         col.regions=colorRampPalette(brewer.pal(7, "PuBu")[-(1:1)])(20), 
>         scales=list(draw=TRUE), 
>         cex=.4*(1:5)
> )
> 
> but now, after R upgrade, this is not working properly anymore.
> As you can see from the attached image, colors are not well linked to points
> size.
> 
> Any hint?

Please read this thread to understand the change:
https://stat.ethz.ch/pipermail/r-sig-geo/2012-March/014399.html

cx = (meuse$om/max(meuse$om,na.rm=T)) * 5
spplot(meuse, zcol="om",col.regions=colorRampPalette(brewer.pal(7,
"PuBu")[-(1:1)])(20),scales=list(draw=TRUE), cex=.4 * cx)

seems to give you the right bubble sizes, but not the right sizes in the
legend.

I added an argument to spplot (committed in svn), called key.cex so that
in the above call cex.key=1:5 would give sizes 1:5 in the legend. The
responsibility to match key size in plot and legend then lies with the
user, this is no longer automatic. This is a bit of a hack, but the
automatic solution needs a bit more thinking. Note that in the old
behaviour, you had 5 bubble sizes, in the example above you have
continuously varying bubble size.

> 
> -Piero
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Variable-point-size-with-spplot-tp7405527p7405527.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sarah.goslee at gmail.com  Mon Mar 26 15:36:37 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Mon, 26 Mar 2012 09:36:37 -0400
Subject: [R-sig-Geo] great circle distances
In-Reply-To: <Prayer.1.3.4.1203261243110.19293@hermes-2.csi.cam.ac.uk>
References: <Prayer.1.3.4.1203261243110.19293@hermes-2.csi.cam.ac.uk>
Message-ID: <CAM_vjukZOOEOrQBj8uEkV_XhwFsPFWnpEMtofiz4wqrT_qNenw@mail.gmail.com>

Hi,

On Mon, Mar 26, 2012 at 7:43 AM, A.P.B. Carneiro <apbc2 at cam.ac.uk> wrote:
> Hi
>
> I need to calculate the average nearest neighbor distance between nests
> coordinates (lat/long). However, I would like to use the great circle
> distances in spite or Euclidian distances. Is it possible to do this in
> ArcGis 10?

Probably, but you're more likely to find out the answer if you ask on
an ArcGIS list instead of an R list.

Just for completeness, here's a nice answer for R:
http://www.r-bloggers.com/great-circle-distance-calculations-in-r/

I don't use ArcGis, but googling "great circle distance ArcGIS" turns
up a lot of potentially-helpful answers.

I think StackOverflow probably has an ArcGIS discussion board you
could try for more concrete answers.

Sarah

-- 
Sarah Goslee
http://www.functionaldiversity.org


From jstruve at ufl.edu  Mon Mar 26 19:14:15 2012
From: jstruve at ufl.edu (Struve,Juliane)
Date: Mon, 26 Mar 2012 17:14:15 +0000
Subject: [R-sig-Geo] Creating a spatial boundary using Lines() and
 SpatialLines()
In-Reply-To: <alpine.LRH.2.02.1203231849021.25313@reclus.nhh.no>
References: <BFCE57D0BE7CBB42A581347DE375AF9A02A637B0@UFEXCH-MBXN02.ad.ufl.edu>
	<alpine.LRH.2.02.1203231849021.25313@reclus.nhh.no>
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A02A639FC@UFEXCH-MBXN02.ad.ufl.edu>

Dear Roger,

Thank you for this helpful comment. The spatial boundary now works. However, when I submit it to KernelUD() using 
kernelUD(Movement_Spatial,h="href",grid=Raster_map,boundary=coastline)
I get an error message
"Error in 3 * h : non-numeric argument to binary operator"
The boundary is simple and far away from the locations used for the Kernel estimation. The smoothing parameter href is 5.5 and the boundary seems to satisfy the conditions  required to use it in KernelUD(). What does this message refer to ? 

Thank you again for your time,

Juliane 



Dr. Juliane Struve
Fisheries and Aquatic Sciences
7922 NW 71st Street, Gainesville, FL 32653
352-273-3632 (tel)
352-392-3672 (fax)
email: jstruve at ufl.edu



-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Friday, March 23, 2012 1:50 PM
To: Struve,Juliane
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Creating a spatial boundary using Lines() and SpatialLines()

On Fri, 23 Mar 2012, Struve,Juliane wrote:

> Dear list,
>
> I would like to create a spatial line to be used as a boundary in 
> KernelUD(). But my code yields an error message.
>
> bound <- cbind(c(-40,-40,-30,-30,-20,0,20,30,50,100),c(-40,-20,-10,0,10,20,30,30,50,50))
> Slo1 <- Line(bound)
> Sli1 <- Lines(list(Slo1, ID="coastline"))

Sli1 <- Lines(list(Slo1), ID="coastline")

> coastline <- SpatialLines(list(Sli1),ID="coastline")

coastline <- SpatialLines(list(Sli1))
class(coastline)

OK?

Roger

> Sli1
> An object of class "Lines"...
>
> Error in Lines(list(Slo1, ID = "coastline")) : slinelist not a list of Line objects
>
> Would someone be able tell me why this does not work ?
>
> Thanks a lot for your time,
>
> Juliane
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Mar 26 19:28:11 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Mar 2012 19:28:11 +0200 (CEST)
Subject: [R-sig-Geo] Creating a spatial boundary using Lines() and
 SpatialLines()
In-Reply-To: <BFCE57D0BE7CBB42A581347DE375AF9A02A639FC@UFEXCH-MBXN02.ad.ufl.edu>
References: <BFCE57D0BE7CBB42A581347DE375AF9A02A637B0@UFEXCH-MBXN02.ad.ufl.edu>
	<alpine.LRH.2.02.1203231849021.25313@reclus.nhh.no>
	<BFCE57D0BE7CBB42A581347DE375AF9A02A639FC@UFEXCH-MBXN02.ad.ufl.edu>
Message-ID: <alpine.LRH.2.02.1203261926100.32716@reclus.nhh.no>

No idea. Can users of kernelUD() reply? Please also read the manual page, 
"href" is said to be an ad hoc method to find a suitable value, but maybe 
it doesn't suit your data?

Roger


On Mon, 26 Mar 2012, Struve,Juliane wrote:

> Dear Roger,
>
> Thank you for this helpful comment. The spatial boundary now works. 
> However, when I submit it to KernelUD() using
> kernelUD(Movement_Spatial,h="href",grid=Raster_map,boundary=coastline)
> I get an error message
> "Error in 3 * h : non-numeric argument to binary operator"
> The boundary is simple and far away from the locations used for the 
> Kernel estimation. The smoothing parameter href is 5.5 and the boundary 
> seems to satisfy the conditions required to use it in KernelUD(). What 
> does this message refer to ?
>
> Thank you again for your time,
>
> Juliane
>
>
>
> Dr. Juliane Struve
> Fisheries and Aquatic Sciences
> 7922 NW 71st Street, Gainesville, FL 32653
> 352-273-3632 (tel)
> 352-392-3672 (fax)
> email: jstruve at ufl.edu
>
>
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Friday, March 23, 2012 1:50 PM
> To: Struve,Juliane
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Creating a spatial boundary using Lines() and SpatialLines()
>
> On Fri, 23 Mar 2012, Struve,Juliane wrote:
>
>> Dear list,
>>
>> I would like to create a spatial line to be used as a boundary in
>> KernelUD(). But my code yields an error message.
>>
>> bound <- cbind(c(-40,-40,-30,-30,-20,0,20,30,50,100),c(-40,-20,-10,0,10,20,30,30,50,50))
>> Slo1 <- Line(bound)
>> Sli1 <- Lines(list(Slo1, ID="coastline"))
>
> Sli1 <- Lines(list(Slo1), ID="coastline")
>
>> coastline <- SpatialLines(list(Sli1),ID="coastline")
>
> coastline <- SpatialLines(list(Sli1))
> class(coastline)
>
> OK?
>
> Roger
>
>> Sli1
>> An object of class "Lines"...
>>
>> Error in Lines(list(Slo1, ID = "coastline")) : slinelist not a list of Line objects
>>
>> Would someone be able tell me why this does not work ?
>>
>> Thanks a lot for your time,
>>
>> Juliane
>>
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From fmarkham at gmail.com  Tue Mar 27 01:29:13 2012
From: fmarkham at gmail.com (Francis Markham)
Date: Tue, 27 Mar 2012 10:29:13 +1100
Subject: [R-sig-Geo] great circle distances
In-Reply-To: <CAM_vjukZOOEOrQBj8uEkV_XhwFsPFWnpEMtofiz4wqrT_qNenw@mail.gmail.com>
References: <Prayer.1.3.4.1203261243110.19293@hermes-2.csi.cam.ac.uk>
	<CAM_vjukZOOEOrQBj8uEkV_XhwFsPFWnpEMtofiz4wqrT_qNenw@mail.gmail.com>
Message-ID: <CACsciEggzuP-NOUy6MMytzMKxSAK_YKgo9+98yzxXNXXU97qdA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120327/6e72c4e8/attachment.pl>

From les_ecol at yahoo.com  Tue Mar 27 09:34:41 2012
From: les_ecol at yahoo.com (Laura S)
Date: Tue, 27 Mar 2012 00:34:41 -0700 (PDT)
Subject: [R-sig-Geo] Running R in GRASS directly Re: Trouble with Grass
	6.4.2 and R 2.14.1 interface
In-Reply-To: <alpine.LRH.2.00.1201140955490.12646@reclus.nhh.no>
References: <1326509300.2716.YahooMailNeo@web140319.mail.bf1.yahoo.com>
	<alpine.LRH.2.00.1201140955490.12646@reclus.nhh.no>
Message-ID: <1332833681.26338.YahooMailNeo@web140315.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120327/a267edc9/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Mar 27 13:30:30 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 27 Mar 2012 13:30:30 +0200
Subject: [R-sig-Geo] Variable point size with spplot
In-Reply-To: <1332760210994-7405527.post@n2.nabble.com>
References: <1332760210994-7405527.post@n2.nabble.com>
Message-ID: <4F71A4D6.2020204@uni-muenster.de>

This issue should have been solved now, with sp_0.9-98 released
(propagating through CRAN).

On 03/26/2012 01:10 PM, piero campa wrote:
> Dear list,
> I used to plot points of variable size with "spplot" this way:
> 
> library(RColorBrewer)
> data(meuse)
> coordinates(meuse) <- ~x+y
> spplot(meuse, zcol="om",
>         col.regions=colorRampPalette(brewer.pal(7, "PuBu")[-(1:1)])(20), 
>         scales=list(draw=TRUE), 
>         cex=.4*(1:5)
> )
> 
> but now, after R upgrade, this is not working properly anymore.
> As you can see from the attached image, colors are not well linked to points
> size.
> 
> Any hint?
> 
> -Piero
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Variable-point-size-with-spplot-tp7405527p7405527.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From senator at ecotoxicology.de  Tue Mar 27 13:46:08 2012
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Tue, 27 Mar 2012 13:46:08 +0200
Subject: [R-sig-Geo] Change coordinates of a shapefile
Message-ID: <3292217C-839A-4B13-AAAB-4E893DDB6B3D@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120327/63c0f2ff/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Mar 27 14:05:34 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 27 Mar 2012 13:05:34 +0100
Subject: [R-sig-Geo] Change coordinates of a shapefile
In-Reply-To: <3292217C-839A-4B13-AAAB-4E893DDB6B3D@ecotoxicology.de>
References: <3292217C-839A-4B13-AAAB-4E893DDB6B3D@ecotoxicology.de>
Message-ID: <CANVKczNiq=1oBcjU7Br-aCZuDVHXUf=DYivRJNU1xYUxdf22qQ@mail.gmail.com>

On Tue, Mar 27, 2012 at 12:46 PM, Ralf Sch?fer <senator at ecotoxicology.de> wrote:
> Dear list,
>
> I have a shapefile where the zone number of UTM has been placed as first digits of the x-values. So the bounding box is:
> ?min ? ? ?max
> x 33085892 33475738
> y ?5801128 ?6059362
>
> I want to get rid of the 33 and thus extracted the coordinates from the SpatialLinesDataFrame and substracted the value:
> coordinates(data) -> coords
> length(coords) -> num_list
> for(i in 1:num_list){coords[i][[1]][[1]][,1] -33000000 -> ? coords[i][[1]][[1]][,1] }
> coordinates(data) <- coords
> Unfortunately, I get an error when trying to write back.
>
> Any ideas how to accomplish this - may be there are also easier ways to change the coordinate system?!

 The 'elide' function in package:maptools has a 'shift' argument that
should let you subtract 33000000 from all coordinates...

Barry


From senator at ecotoxicology.de  Tue Mar 27 14:14:24 2012
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Tue, 27 Mar 2012 14:14:24 +0200
Subject: [R-sig-Geo] Change coordinates of a shapefile
In-Reply-To: <CANVKczNiq=1oBcjU7Br-aCZuDVHXUf=DYivRJNU1xYUxdf22qQ@mail.gmail.com>
References: <3292217C-839A-4B13-AAAB-4E893DDB6B3D@ecotoxicology.de>
	<CANVKczNiq=1oBcjU7Br-aCZuDVHXUf=DYivRJNU1xYUxdf22qQ@mail.gmail.com>
Message-ID: <D3D1D426-388C-4C3F-BF19-202C57709C34@ecotoxicology.de>

Too easy!
Thanks a lot, much appreciated
Ralf

Am 27.03.2012 um 14:05 schrieb Barry Rowlingson:

> On Tue, Mar 27, 2012 at 12:46 PM, Ralf Sch?fer <senator at ecotoxicology.de> wrote:
>> Dear list,
>> 
>> I have a shapefile where the zone number of UTM has been placed as first digits of the x-values. So the bounding box is:
>>  min      max
>> x 33085892 33475738
>> y  5801128  6059362
>> 
>> I want to get rid of the 33 and thus extracted the coordinates from the SpatialLinesDataFrame and substracted the value:
>> coordinates(data) -> coords
>> length(coords) -> num_list
>> for(i in 1:num_list){coords[i][[1]][[1]][,1] -33000000 ->   coords[i][[1]][[1]][,1] }
>> coordinates(data) <- coords
>> Unfortunately, I get an error when trying to write back.
>> 
>> Any ideas how to accomplish this - may be there are also easier ways to change the coordinate system?!
> 
> The 'elide' function in package:maptools has a 'shift' argument that
> should let you subtract 33000000 from all coordinates...
> 
> Barry


From folmedo at mendoza.inta.gov.ar  Tue Mar 27 15:47:20 2012
From: folmedo at mendoza.inta.gov.ar (Guillermo Olmedo)
Date: Tue, 27 Mar 2012 10:47:20 -0300
Subject: [R-sig-Geo] Import BIL files in R, without the hdr file
Message-ID: <4F71C4E8.1040701@mendoza.inta.gov.ar>

Hi list!

I'm trying to import a BIL binary file into R. I've obtained the file 
running a soft called TIMESAT[1] but i only have the BIL file, not the 
HDR. Because i know how timesat generates the files I've the number of 
cols ands rows. Also i know the file its a 16 bit signed integer and 
little endian. I've followed the procedure here [2] and the info i know 
from the file to write my own hdr. But still doesnt work. Without the 
hdr file i still can import the bil file into ERDAS using import binary 
and it works flawlessly, but i don't want to use ERDAS.

This is my hdr file:
BYTEORDER      I
LAYOUT         BIL
NROWS          79
NCOLS          107
NBANDS         1
NBITS          16
BANDROWBYTES   80
TOTALROWBYTES  80
PIXELTYPE      INTEGER
ULXMAP         0
ULYMAP         0
XDIM           107
YDIM           79

Maybe Bandrowbytes and totalrowbytes are wrong. At this moment the 
spatial location doesnt matters so i left ulxmap and ulymap as 0.

My code is:
BIL <- raster("amplitud.bil", native=T)
dataType(bio) <- 'INT2S'
plot(BIL)

And the same result with:
BIL <- raster(ncols=107, nrows= 79)
BIN <- readBin("amplitud.bil", what="integer", n=8453, endian="little", 
signed=TRUE, size=2)
BIL <- setValues(BIL, BIN)
plot(BIL)


With the img generated in ERDAS i can compare with the R result and 
clearly its not working good.

Also, here you can have a copy of my files: 
http://ubuntuone.com/116tXWeA7rrwOc9SWsp6Wl (63kb)

Anyone have a better recipe?

Thanks in advance, regards!


[1] http://www.nateko.lu.se/TIMESAT/timesat.asp
[2] http://r.789695.n4.nabble.com/importing-bil-files-td1677546.html

-- 
Ing. Agr. Guillermo Federico OLMEDO
Laboratorio de Geom?tica
?rea de Recursos Naturales
EEA INTA Mendoza

Oficina: San Mart?n 3853. Mayor. Drummond.
Luj?n de Cuyo. Mendoza.
ARGENTINA (M5507EVY)
Tel: +54 (261) 496 3020 int. 252 / Cel. 261 6779074
http://www.inta.gov.ar/mendoza/invest/Gr_RecursosNaturales.htm


From jgrn at illinois.edu  Tue Mar 27 16:55:03 2012
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 27 Mar 2012 09:55:03 -0500
Subject: [R-sig-Geo] raster parallelization
Message-ID: <CABG0rfuO30v40iFgEgK4J4KvGJvLTH3y5433ZjZ6NB31SpAraA@mail.gmail.com>

Robert and R-sig-geo'ers:

I was wondering if there is documentation stating which raster
functions have been parallelized thus far?  Specifically, has focal()
been adapted to work with snow/snowfall?  Cheers!

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Department of Geography
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
http://www.geog.illinois.edu/people/JonathanGreenberg.html


From jgrn at illinois.edu  Tue Mar 27 17:02:37 2012
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 27 Mar 2012 10:02:37 -0500
Subject: [R-sig-Geo] focal() questions
Message-ID: <CABG0rft6=9EaD6vDr2k=n=bxXoBUfCya3mDmh-9BcO6PoyiX1Q@mail.gmail.com>

Robert and r-sig-geo'ers:

When working with raster's focal() function, I had a few questions:

1) How do I send non-spatial parameters to the function (e.g. similar
to the mapply "MoreArgs" parameter)?
2) Is it possible to have a non-raster return from the focal function?
 For instance: I'm trying to code up a local maxima function that
returns the x,y position of all local maxima in an image (I want a
vector of these positions).  I can do this in two steps by first
creating a raster of local maxima (e.g. placing "0" where a pixel is
not a local maxima), and then running through this raster and pull out
all pixels that are not 0.  This, however, has to read two rasters and
write one.  If I could identify a pixel as a local maxima within a
focal() function, and have it return the value as either a
SpatialPoints object or just an x,y coordinate, this would require
reading the image only once, and only writing where there are maxima.
Thoughts?
3) Can focal() be used with a rasterStack or rasterBrick, where the
filter and function is applied to multiple bands, rather than one at a
time?  The "w" parameter would perhaps need to be an array or a list
of matrices.  In this case, the function would be one that requires
all of the bands in the local neighborhood to operate.

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Department of Geography
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
http://www.geog.illinois.edu/people/JonathanGreenberg.html


From jstruve at ufl.edu  Tue Mar 27 17:35:25 2012
From: jstruve at ufl.edu (Struve,Juliane)
Date: Tue, 27 Mar 2012 15:35:25 +0000
Subject: [R-sig-Geo] KernelUD() with a spatial boundary
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A02A63B42@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120327/26687383/attachment.pl>

From mdsumner at gmail.com  Wed Mar 28 02:53:31 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 28 Mar 2012 11:53:31 +1100
Subject: [R-sig-Geo] Import BIL files in R, without the hdr file
In-Reply-To: <4F71C4E8.1040701@mendoza.inta.gov.ar>
References: <4F71C4E8.1040701@mendoza.inta.gov.ar>
Message-ID: <CAAcGz98EyTVO2opysKqk4UZy=U6KCKpgDF0qRXqjjogTwQhhWQ@mail.gmail.com>

I think BANDROWBYTES and TOTALROWBYTES should both be 214 (107 * 2)
which is the number of columns times the 2 bytes for 16 NBITS.

You can infer what should happen from another example, which you can
do by something like this:

f <- system.file("pictures/erdas_spnad83.tif", package = "rgdal")[1]
g <- readGDAL(f)

## write out to EHdr format and read in the text
writeGDAL(g, "a.bil", "EHdr")
readLines("a.hdr")

Otherwise, refer to the GDAL page for this driver:
http://www.gdal.org/frmt_various.html#EHdr

Cheers, Mike.


On Wed, Mar 28, 2012 at 12:47 AM, Guillermo Olmedo
<folmedo at mendoza.inta.gov.ar> wrote:
> Hi list!
>
> I'm trying to import a BIL binary file into R. I've obtained the file
> running a soft called TIMESAT[1] but i only have the BIL file, not the HDR.
> Because i know how timesat generates the files I've the number of cols ands
> rows. Also i know the file its a 16 bit signed integer and little endian.
> I've followed the procedure here [2] and the info i know from the file to
> write my own hdr. But still doesnt work. Without the hdr file i still can
> import the bil file into ERDAS using import binary and it works flawlessly,
> but i don't want to use ERDAS.
>
> This is my hdr file:
> BYTEORDER ? ? ?I
> LAYOUT ? ? ? ? BIL
> NROWS ? ? ? ? ?79
> NCOLS ? ? ? ? ?107
> NBANDS ? ? ? ? 1
> NBITS ? ? ? ? ?16
> BANDROWBYTES ? 80
> TOTALROWBYTES ?80
> PIXELTYPE ? ? ?INTEGER
> ULXMAP ? ? ? ? 0
> ULYMAP ? ? ? ? 0
> XDIM ? ? ? ? ? 107
> YDIM ? ? ? ? ? 79
>
> Maybe Bandrowbytes and totalrowbytes are wrong. At this moment the spatial
> location doesnt matters so i left ulxmap and ulymap as 0.
>
> My code is:
> BIL <- raster("amplitud.bil", native=T)
> dataType(bio) <- 'INT2S'
> plot(BIL)
>
> And the same result with:
> BIL <- raster(ncols=107, nrows= 79)
> BIN <- readBin("amplitud.bil", what="integer", n=8453, endian="little",
> signed=TRUE, size=2)
> BIL <- setValues(BIL, BIN)
> plot(BIL)
>
>
> With the img generated in ERDAS i can compare with the R result and clearly
> its not working good.
>
> Also, here you can have a copy of my files:
> http://ubuntuone.com/116tXWeA7rrwOc9SWsp6Wl (63kb)
>
> Anyone have a better recipe?
>
> Thanks in advance, regards!
>
>
> [1] http://www.nateko.lu.se/TIMESAT/timesat.asp
> [2] http://r.789695.n4.nabble.com/importing-bil-files-td1677546.html
>
> --
> Ing. Agr. Guillermo Federico OLMEDO
> Laboratorio de Geom?tica
> ?rea de Recursos Naturales
> EEA INTA Mendoza
>
> Oficina: San Mart?n 3853. Mayor. Drummond.
> Luj?n de Cuyo. Mendoza.
> ARGENTINA (M5507EVY)
> Tel: +54 (261) 496 3020 int. 252 / Cel. 261 6779074
> http://www.inta.gov.ar/mendoza/invest/Gr_RecursosNaturales.htm
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.hijmans at gmail.com  Wed Mar 28 05:14:29 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 27 Mar 2012 20:14:29 -0700
Subject: [R-sig-Geo] raster parallelization
In-Reply-To: <CABG0rfuO30v40iFgEgK4J4KvGJvLTH3y5433ZjZ6NB31SpAraA@mail.gmail.com>
References: <CABG0rfuO30v40iFgEgK4J4KvGJvLTH3y5433ZjZ6NB31SpAraA@mail.gmail.com>
Message-ID: <CANtt_hw0KM0kAL0_Vi2=0OOUj8rE3+GYLHR9Q2B6VO9UYS2kUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120327/027b7795/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Mar 28 13:01:17 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 28 Mar 2012 13:01:17 +0200
Subject: [R-sig-Geo] Plotting a projected map in UTM coordinates;
 modifying CRS
In-Reply-To: <CABkCotQuN6edDeE8kPMv=Tmb8rF6POBWmRn9gnCBjO2F1WgOsQ@mail.gmail.com>
References: <CABkCotTeUqgEOXoB3_4yqjQ7vmG9C4A+ZQ0mOAwWap19iBj9hw@mail.gmail.com>
	<4F6EBC27.5080406@tum.de>
	<CABkCotQuN6edDeE8kPMv=Tmb8rF6POBWmRn9gnCBjO2F1WgOsQ@mail.gmail.com>
Message-ID: <4F72EF7D.60601@uni-muenster.de>

Attempts to change a projection of spatial data by modifying the
proj4string, such as in:

On 03/25/2012 03:55 PM, Manuel Sp?nola wrote:
...
>> Am 25.03.2012 05:10, schrieb Manuel Sp?nola:
>>
>>> Dear list members,
>>>
>>> I am projecting a map to UTM but when I plot the map the axes display
>>> geographic coordinates, do you know why?
>>>
>>>  cr =
>>>>
>>> readOGR(dsn="/Users/**manuelspinola/Documents/**
>>> ProyectosRespacial/EvalHab_**reporte",
>>> layer="Cr_wgs84_meso")
...

>>> proj4string(cr)<-CRS("+proj=**tmerc +lon_0=-84 +lat_0=0 +x_0=500000
>>> +k=0.9999
>>> +datum=WGS84")

and up to now did not generate a warning. This will change; Roger
committed a change to sp with which such attempts now result in a
warning, and a pointer to rgdal::spTransform; see

http://lists.r-forge.r-project.org/pipermail/rspatial-devel/2012-March/000064.html

This warning can be turned off, but is on by default. I think this is an
improvement, but am open to hear other opinions.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From naimi at itc.nl  Wed Mar 28 14:34:59 2012
From: naimi at itc.nl (Babak Naimi)
Date: Wed, 28 Mar 2012 14:34:59 +0200
Subject: [R-sig-Geo] groupping contiguous identical raster cells
Message-ID: <021F462EDC7F2B42A7038E9F9D4782612697A17732@itcnt27.itc.nl>

Dear Robert and list,

I wrote a function, named 'group', to find the spatially contiguous groups of identical valued pixels in a raster layer and assign them unique integer identifiers (same as the GROUP function in Idrisi). I used the Rasterlayer object in the function to get and set values in the grouping procedure. Unfortunately the procedure is not efficient. When I converted the raster into matrix (in 'group2' function), the efficiency is incredibly improved but I think it still has problem with bigger rasters. It is not also a memory-safe function!

I was wondering if anyone can help to modify the function and enhance the efficiency. Following I show the results of some experiments on these functions (the source of the functions is attached at the end).

r1 <- c(rep(1,100),rep(2,100),sample(c(3,4),200,replace=T))
r1 <- raster(matrix(r1,nc=20,nr=20,byrow=T))

system.time(
  g1 <- group(r1)
  )

   user  system elapsed 
   2.56    0.00    2.59

system.time(
  g2 <- group2(r1)
  )

  user  system elapsed 
   0.06    0.00    0.06


# bigger raster:
r2 <- c(rep(1,10000),rep(2,10000),sample(c(3,4),20000,replace=T))
r2 <- raster(matrix(r2,nc=200,nr=200,byrow=T))

system.time(
  g3 <- group(r2)
  )

   user  system elapsed 
1488.39    3.54 1547.00

system.time(
  g4 <- group2(r2)
  )
  user  system elapsed 
 230.47    0.52  237.54

#--------------------
# The source of functions:
cellNeighbors<-function(cell,nr,nc,type="queen") {
  row <- trunc((cell-1)/nc) + 1
  col <- cell - ((row-1) * nc)
  
  if (type == "rook") {
    r <- c(-1,0,1,0)
    c <- c(0,1,0,-1)
  } else {
    r <- c(-1,-1,-1,0,1,1,1,0)
    c <- c(-1,0,1,1,1,0,-1,-1)
  }
  row <- row - r
  col <- col - c
  row[row < 1 | row > nr] <- NA
  col[col < 1 | col > nc] <- NA
  rc <- cbind(row, col)
  v <- (rc[,1]-1) * nc + rc[,2]
  w <- which(is.na(v)) 
  if (length(w) > 0) v <- v[-w]
  v
}
#---------
group <- function(x,type="queen") {
  g <- raster(x)
  nc <- x at ncols
  nr <- x at nrows
  cells <- 1:ncell(x)
  w <- which(is.na(x[cells]))
  if (length(w) > 0) cells <- cells[-w]
  groupID <- 0
  Neigh.cells <- c()
  while (length(cells) > 0) {
    groupID <- groupID + 1
    cell <- cells[1]
    g[cell] <- groupID
    cells <- cells[-1]
    cell.n <- cellNeighbors(cell,nr,nc,type=type)
    w <- which(x[cell.n] == x[cell])
    if (length(w) > 0) Neigh.cells <- c(Neigh.cells,cell.n[w])
    while (length(Neigh.cells) > 0) {
      cell <- Neigh.cells[1]
      Neigh.cells <- Neigh.cells[-1]
      w <- which(cells == cell)
      if (length(w) > 0) {
        cells <- cells[-w]
        g[cell] <- groupID
        cell.n <- cellNeighbors(cell,nr,nc,type=type)
        ww <- which(x[cell.n] == x[cell])
        if (length(ww) > 0) Neigh.cells <- c(Neigh.cells,cell.n[ww])
      }
    }
  }
  g
}

#--------
group2 <- function(x,type="queen") {
  gr <- raster(x)
  nc <- x at ncols
  nr <- x at nrows
  cells <- 1:ncell(x)
  x <- t(as.matrix(x))
  g <- x
  g[] <- NA
  w <- which(is.na(x[cells]))
  if (length(w) > 0) cells <- cells[-w]
  groupID <- 0
  Neigh.cells <- c()
  while (length(cells) > 0) {
    groupID <- groupID + 1
    cell <- cells[1]
    g[cell] <- groupID
    cells <- cells[-1]
    cell.n <- cellNeighbors(cell,nr,nc,type=type)
    w <- which(x[cell.n] == x[cell])
    if (length(w) > 0) Neigh.cells <- c(Neigh.cells,cell.n[w])
    while (length(Neigh.cells) > 0) {
      cell <- Neigh.cells[1]
      Neigh.cells <- Neigh.cells[-1]
      w <- which(cells == cell)
      if (length(w) > 0) {
        cells <- cells[-w]
        g[cell] <- groupID
        cell.n <- cellNeighbors(cell,nr,nc,type=type)
        ww <- which(x[cell.n] == x[cell])
        if (length(ww) > 0) Neigh.cells <- c(Neigh.cells,cell.n[ww])
      }
    }
  }
  gr[] <- t(g)
  gr
}
#---------------------

Best regards,
Babak

Babak Naimi
PhD Candidate, Natural Resources Department,
Faculty of Geo-Information Science and Earth Observations (ITC), University of Twente, 
P.O. Box 217, 7500 AE Enschede, The Netherlands
Tel: +31 53 4874212


From paul.hiemstra at knmi.nl  Wed Mar 28 14:54:49 2012
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Wed, 28 Mar 2012 12:54:49 +0000
Subject: [R-sig-Geo] Variable point size with spplot
In-Reply-To: <1332760210994-7405527.post@n2.nabble.com>
References: <1332760210994-7405527.post@n2.nabble.com>
Message-ID: <4F730A19.3050107@knmi.nl>

On 03/26/2012 11:10 AM, piero campa wrote:
> Dear list,
> I used to plot points of variable size with "spplot" this way:
>
> library(RColorBrewer)
> data(meuse)
> coordinates(meuse) <- ~x+y
> spplot(meuse, zcol="om",
>         col.regions=colorRampPalette(brewer.pal(7, "PuBu")[-(1:1)])(20), 
>         scales=list(draw=TRUE), 
>         cex=.4*(1:5)
> )
>
> but now, after R upgrade, this is not working properly anymore.
> As you can see from the attached image, colors are not well linked to points
> size.
>
> Any hint?
>
> -Piero
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Variable-point-size-with-spplot-tp7405527p7405527.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Hi,

Not really an answer to your question directly, but I use ggplot2 to
make these kinds of plots. I find it more intuitive and flexible than
lattice, which is used by spplot. An example using the meuse dataset:

library(ggplot2)
data(meuse)
# Note: No coordinates is needed, ggplot2
# works with data.frames.

gg = ggplot(aes(x = x, y = y, size = om), data = meuse) + geom_point()

# A basic example:
print(gg)

# One that mimics the layout of spplot
theme_set(theme_bw())
print(gg + coord_equal() + scale_x_continuous("", breaks = NULL) +
                 scale_y_continuous("", breaks = NULL))

# ...and couple the color to the ffreq:
gg = ggplot(aes(x = x, y = y, size = om, color = ffreq), data = meuse) +
geom_point()
print(gg + coord_equal() + scale_x_continuous("", breaks = NULL) +
                 scale_y_continuous("", breaks = NULL))

cheers,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From j.m.signer at gmail.com  Wed Mar 28 15:01:07 2012
From: j.m.signer at gmail.com (Johannes Signer)
Date: Wed, 28 Mar 2012 15:01:07 +0200
Subject: [R-sig-Geo] Connection between R and PostGIS
Message-ID: <CAC8qavsu-_=JBwO20hOO1S=yTXC__t2-id_RR5zTDbjkhBy0Ag@mail.gmail.com>

Dear All,

I have been trying to connect R and PostGIS. My approach so far is:

## load libraries
library(RODBC)
library(rgeos)

## Connect to db
con <- odbcConnect("gisdb")

## query
sql <- "SELECT ST_AsText(the_geom) from gis_data.gadm2 where name_2='Berlin'"

## execute query
d <- readWKT(sqlQuery(con, sql, stringsAsFactors=F)[1,1])

This works well for small polygons.

My questions are:

1.) Is there a more straightforward approach to access data stored
PostGIS from R?
2.) While my approach described above worked ok for small polygons, it
failed for larger ones. My guess is that the strings to be stored are
long. Does anyone has a workaround for that?

Thanks in advance for any comments
Johannes


From edzer.pebesma at uni-muenster.de  Wed Mar 28 15:14:34 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 28 Mar 2012 15:14:34 +0200
Subject: [R-sig-Geo] Connection between R and PostGIS
In-Reply-To: <CAC8qavsu-_=JBwO20hOO1S=yTXC__t2-id_RR5zTDbjkhBy0Ag@mail.gmail.com>
References: <CAC8qavsu-_=JBwO20hOO1S=yTXC__t2-id_RR5zTDbjkhBy0Ag@mail.gmail.com>
Message-ID: <4F730EBA.3050509@uni-muenster.de>

see

http://wiki.intamap.org/index.php/PostGIS

(which, to my surprise, has been accessed nearly 30000 times).

On 03/28/2012 03:01 PM, Johannes Signer wrote:
> Dear All,
> 
> I have been trying to connect R and PostGIS. My approach so far is:
> 
> ## load libraries
> library(RODBC)
> library(rgeos)
> 
> ## Connect to db
> con <- odbcConnect("gisdb")
> 
> ## query
> sql <- "SELECT ST_AsText(the_geom) from gis_data.gadm2 where name_2='Berlin'"
> 
> ## execute query
> d <- readWKT(sqlQuery(con, sql, stringsAsFactors=F)[1,1])
> 
> This works well for small polygons.
> 
> My questions are:
> 
> 1.) Is there a more straightforward approach to access data stored
> PostGIS from R?
> 2.) While my approach described above worked ok for small polygons, it
> failed for larger ones. My guess is that the strings to be stored are
> long. Does anyone has a workaround for that?
> 
> Thanks in advance for any comments
> Johannes
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tech_dev at wildintellect.com  Wed Mar 28 18:26:32 2012
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Wed, 28 Mar 2012 09:26:32 -0700
Subject: [R-sig-Geo] Connection between R and PostGIS
In-Reply-To: <4F730EBA.3050509@uni-muenster.de>
References: <CAC8qavsu-_=JBwO20hOO1S=yTXC__t2-id_RR5zTDbjkhBy0Ag@mail.gmail.com>
	<4F730EBA.3050509@uni-muenster.de>
Message-ID: <4F733BB8.4000308@wildintellect.com>

I personally prefer RPostgreSQL over RODBC.

This has a decent discussion of the current limitations and alternate ideas
http://code.google.com/p/rpostgresql/issues/detail?id=22

The other way I can think to do it, is the ManageR plugin in QGIS.

Thanks,
Alex

On 03/28/2012 06:14 AM, Edzer Pebesma wrote:
> see
> 
> http://wiki.intamap.org/index.php/PostGIS
> 
> (which, to my surprise, has been accessed nearly 30000 times).
> 
> On 03/28/2012 03:01 PM, Johannes Signer wrote:
>> Dear All,
>>
>> I have been trying to connect R and PostGIS. My approach so far is:
>>
>> ## load libraries
>> library(RODBC)
>> library(rgeos)
>>
>> ## Connect to db
>> con <- odbcConnect("gisdb")
>>
>> ## query
>> sql <- "SELECT ST_AsText(the_geom) from gis_data.gadm2 where name_2='Berlin'"
>>
>> ## execute query
>> d <- readWKT(sqlQuery(con, sql, stringsAsFactors=F)[1,1])
>>
>> This works well for small polygons.
>>
>> My questions are:
>>
>> 1.) Is there a more straightforward approach to access data stored
>> PostGIS from R?
>> 2.) While my approach described above worked ok for small polygons, it
>> failed for larger ones. My guess is that the strings to be stored are
>> long. Does anyone has a workaround for that?
>>
>> Thanks in advance for any comments
>> Johannes
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From E.Thomas at CGIAR.ORG  Thu Mar 29 00:23:20 2012
From: E.Thomas at CGIAR.ORG (Thomas, Evert (Bioversity-Colombia))
Date: Wed, 28 Mar 2012 22:23:20 +0000
Subject: [R-sig-Geo] control over resolution KML in Raster package?
Message-ID: <BAD0F95A023D904C8DAA193192ECE14031CB47@CIATMB1.CIAT.CGIARAD.ORG>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120328/39e18f5c/attachment.pl>

From roosbeh.nowrouzian at gmail.com  Thu Mar 29 01:08:37 2012
From: roosbeh.nowrouzian at gmail.com (Roosbeh Nowrouzian)
Date: Wed, 28 Mar 2012 19:08:37 -0400
Subject: [R-sig-Geo] Defining neighbors base on same location
Message-ID: <CAJw-hPbhrf3KaFbgSP-DjF9OQB7piZYsT9ceC5+gNF1RRtxfug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120328/6cde4a7c/attachment.pl>

From tom.gottfried at tum.de  Thu Mar 29 07:35:21 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Thu, 29 Mar 2012 07:35:21 +0200
Subject: [R-sig-Geo] Defining neighbors base on same location
In-Reply-To: <CAJw-hPbhrf3KaFbgSP-DjF9OQB7piZYsT9ceC5+gNF1RRtxfug@mail.gmail.com>
References: <CAJw-hPbhrf3KaFbgSP-DjF9OQB7piZYsT9ceC5+gNF1RRtxfug@mail.gmail.com>
Message-ID: <4F73F499.3070100@tum.de>

Hi,

Am 29.03.2012 01:08, schrieb Roosbeh Nowrouzian:
> Hi list members:
>
> Is there any way to define neighbors in R as any other observation
> with distance to the corresponding point equal to 0.
>
> I am trying to define neighbors base on the same location ( the same
> Household members are linked to each other). I tried defining
>
> weights base on  fixed distance bounds:
> neighbordistance.nb<- dnearneigh ( coords, d1=0, d2=0.00001, row.names=IDs
> )
> But this function does not define other Household members (distance=0) as
> the neighbor.
>
> When trying fixed number of neighbors:
> neighbor3.knn<- knearneigh ( x=coords , k=3, longlat= FALSE, RANN=TRUE )
> This function defines other Household members(distance =0) as neighbor but
> the problem with this function is that each Household has different
> Household number so different number of neighbors is required for each
> Household.

neighbor3.knn <-
    mapply(function(n, coord) knearneigh(x=coord,
                                         k=n, longlat=FALSE,RANN=TRUE),
           ns, lapply(1:nrow(coords), function(i) coords[i,]))

Assuming you have a vector 'ns' with the number of household members per 
household, this should give you a list with each element defining the 
neighbours you desire. I hope I didn't misunderstand your question.

HTH,
Tom

> It would be kind of you letting me know if there is a way to define
> neighbors base on  zero distance with the corresponding point.
> Appreciate it.
>
> Roosbeh Nowrouzian
> PhD student
> Department of Civil Engineering
> University of Florida
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From jaalonson at indra.es  Thu Mar 29 09:18:19 2012
From: jaalonson at indra.es (=?iso-8859-1?Q?Alonso_Nanclares=2C_Jes=FAs_Alberto?=)
Date: Thu, 29 Mar 2012 09:18:19 +0200
Subject: [R-sig-Geo] Multiple polygons in kml with non-zero altitude
Message-ID: <DA5EEE32BFD3494C9E333862FF7A38930324DE92FD@MADARRMAILBOX07.indra.es>

Dear list members,

I have been trying to export a KML file from R with some variables containing information referring to censal sections in the city of Madrid. I am interested in representing polygons which base would be the coordinates of the corresponding censal section and which altitude would be the value of a variable of interest. My question is if an object class representing polygons with altitude exists, as the classes present in the "sp" package (the ones I know) only allow for bidimensional polygons.

I would also thank a hint in which function I should use to export the polygons into a KML file. I have tried to use "kmlPolygon" in the "maptools" package, but I would like to represent several polygons on the same layer.

Thanks a lot,

Jes?s Alberto Alonso Nanclares
Consultor Junior
Business Intelligence

C/ Anabel Segura 7
28108 Alcobendas (Madrid)
Espa?a

T +34 914 807 877
jaalonson at indra.es
www.indracompany.com<http://www.indracompany.com>

[cid:image001.jpg at 01CD0D89.DE6F9E30]


________________________________
Este correo electr?nico y, en su caso, cualquier fichero anexo al mismo, contiene informaci?n de car?cter confidencial exclusivamente dirigida a su destinatario o destinatarios. Si no es vd. el destinatario indicado, queda notificado que la lectura, utilizaci?n, divulgaci?n y/o copia sin autorizaci?n est? prohibida en virtud de la legislaci?n vigente. En el caso de haber recibido este correo electr?nico por error, se ruega notificar inmediatamente esta circunstancia mediante reenv?o a la direcci?n electr?nica del remitente.
Evite imprimir este mensaje si no es estrictamente necesario.

This email and any file attached to it (when applicable) contain(s) confidential information that is exclusively addressed to its recipient(s). If you are not the indicated recipient, you are informed that reading, using, disseminating and/or copying it without authorisation is forbidden in accordance with the legislation in effect. If you have received this email by mistake, please immediately notify the sender of the situation by resending it to their email address.
Avoid printing this message if it is not absolutely necessary.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120329/cc06e052/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1907 bytes
Desc: image001.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120329/cc06e052/attachment.jpg>

From raffaele.morelli at gmail.com  Thu Mar 29 11:40:22 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Thu, 29 Mar 2012 11:40:22 +0200
Subject: [R-sig-Geo] Splancs and polymap
Message-ID: <CAD4guxNqSCqU93uXfOvZUzZJ9vGP5K+y9hoVLR1NkHsJ6jAMig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120329/cc50cb4b/attachment.pl>

From Roger.Bivand at nhh.no  Thu Mar 29 18:46:01 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Mar 2012 18:46:01 +0200 (CEST)
Subject: [R-sig-Geo] Splancs and polymap
In-Reply-To: <CAD4guxNqSCqU93uXfOvZUzZJ9vGP5K+y9hoVLR1NkHsJ6jAMig@mail.gmail.com>
References: <CAD4guxNqSCqU93uXfOvZUzZJ9vGP5K+y9hoVLR1NkHsJ6jAMig@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1203291833260.15311@reclus.nhh.no>

On Thu, 29 Mar 2012, Raffaele Morelli wrote:

> Hi,
>
> I am working on a simple kernel2d analisys and would like to create a
> polymap from a SpatialPolygonsDataFrame, let's stay US states.
> how can I accomplish this task? can you point me to the right direction?

Why? Please include sample code. I assume that you realise that the poly= 
argument in this function requires a single polygon ring, so you would 
first have to define your window and go from there.

Roger

>
> regards
> -r
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From HodgessE at uhd.edu  Fri Mar 30 00:19:12 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 29 Mar 2012 17:19:12 -0500
Subject: [R-sig-Geo] a world type mapping question
Message-ID: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120329/fddf712f/attachment.pl>

From sarah.goslee at gmail.com  Fri Mar 30 00:26:40 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 29 Mar 2012 18:26:40 -0400
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
Message-ID: <CAM_vjumNrn4ceV7BgfFtrad8hiNV7VfBmxKnhvT-oBga01mHSg@mail.gmail.com>

Unsurprisingly, the maps package would be a good place to start.

There have been a number of fairly recent discussions on this list and
the r-help list about how to color entities according to some scheme.

Sarah

On Thu, Mar 29, 2012 at 6:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear People:
>
>
>
> I have a data set with rankings for 18 different countries on several
> different concepts. ?I would like to produce a world map with colors on
> the ones with rankings and perhaps grays on the NA countries.
>
>
>
> Is there a data frame/set with a list of countries available, please?
>
>
>
> Thanks,
>
> Erin
>
>
>
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From HodgessE at uhd.edu  Fri Mar 30 00:27:38 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 29 Mar 2012 17:27:38 -0500
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <CAM_vjumNrn4ceV7BgfFtrad8hiNV7VfBmxKnhvT-oBga01mHSg@mail.gmail.com>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
	<CAM_vjumNrn4ceV7BgfFtrad8hiNV7VfBmxKnhvT-oBga01mHSg@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA2010B00394@BALI.uhd.campus>

I'm looking there and in mapproj and tried to look at mapdata but am having trouble downloading that one.

Thanks
Erin


-----Original Message-----
From: Sarah Goslee [mailto:sarah.goslee at gmail.com] 
Sent: Thursday, March 29, 2012 5:27 PM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] a world type mapping question

Unsurprisingly, the maps package would be a good place to start.

There have been a number of fairly recent discussions on this list and the r-help list about how to color entities according to some scheme.

Sarah

On Thu, Mar 29, 2012 at 6:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear People:
>
>
>
> I have a data set with rankings for 18 different countries on several 
> different concepts. ?I would like to produce a world map with colors 
> on the ones with rankings and perhaps grays on the NA countries.
>
>
>
> Is there a data frame/set with a list of countries available, please?
>
>
>
> Thanks,
>
> Erin
>
>
>
>


--
Sarah Goslee
http://www.functionaldiversity.org


From carson.farmer at gmail.com  Fri Mar 30 00:29:29 2012
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 29 Mar 2012 23:29:29 +0100
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
Message-ID: <CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com>

Hi Erin (apologies for sending this to you twice, forgot to include
list the first time),

Have a look at rworldmap:
http://cran.r-project.org/web/packages/rworldmap/index.html

Carson

On Thu, Mar 29, 2012 at 11:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear People:
>
>
>
> I have a data set with rankings for 18 different countries on several
> different concepts. ?I would like to produce a world map with colors on
> the ones with rankings and perhaps grays on the NA countries.
>
>
>
> Is there a data frame/set with a list of countries available, please?
>
>
>
> Thanks,
>
> Erin
>
>
>
>
>
>
>
> Erin M. Hodgess, Ph.D.
>
> Associate Professor
>
> Department of Computer and Mathematical Sciences
>
> University of Houston - Downtown
>
> mailto: hodgesse at uhd.edu
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Dr. Carson J. Q. Farmer
Centre for GeoInformatics (CGI)
School of Geography and Geosciences
Irvine Building, University of St Andrews
St Andrews, Fife, KY16 9AL
Scotland, UK


From HodgessE at uhd.edu  Fri Mar 30 00:31:15 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 29 Mar 2012 17:31:15 -0500
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
	<CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA2010B0039F@BALI.uhd.campus>

Perfect...rworldmapExamples has everything.

Thanks,
Erin


-----Original Message-----
From: Carson Farmer [mailto:carson.farmer at gmail.com] 
Sent: Thursday, March 29, 2012 5:29 PM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] a world type mapping question

Hi Erin (apologies for sending this to you twice, forgot to include list the first time),

Have a look at rworldmap:
http://cran.r-project.org/web/packages/rworldmap/index.html

Carson

On Thu, Mar 29, 2012 at 11:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear People:
>
>
>
> I have a data set with rankings for 18 different countries on several 
> different concepts. ?I would like to produce a world map with colors 
> on the ones with rankings and perhaps grays on the NA countries.
>
>
>
> Is there a data frame/set with a list of countries available, please?
>
>
>
> Thanks,
>
> Erin
>
>
>
>
>
>
>
> Erin M. Hodgess, Ph.D.
>
> Associate Professor
>
> Department of Computer and Mathematical Sciences
>
> University of Houston - Downtown
>
> mailto: hodgesse at uhd.edu
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Dr. Carson J. Q. Farmer
Centre for GeoInformatics (CGI)
School of Geography and Geosciences
Irvine Building, University of St Andrews St Andrews, Fife, KY16 9AL Scotland, UK


From raffaele.morelli at gmail.com  Fri Mar 30 11:06:11 2012
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Fri, 30 Mar 2012 11:06:11 +0200
Subject: [R-sig-Geo] Splancs and polymap
In-Reply-To: <alpine.LRH.2.02.1203291833260.15311@reclus.nhh.no>
References: <CAD4guxNqSCqU93uXfOvZUzZJ9vGP5K+y9hoVLR1NkHsJ6jAMig@mail.gmail.com>
	<alpine.LRH.2.02.1203291833260.15311@reclus.nhh.no>
Message-ID: <CAD4guxMA9OsZ+imOJtrJ_NvCm=0K3yt6UGCve=82EOgL60jyfw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/e47a4d4b/attachment.pl>

From educheyne at avia-gis.be  Fri Mar 30 13:58:35 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 30 Mar 2012 13:58:35 +0200
Subject: [R-sig-Geo] Spatial Join - over and weighted mean
Message-ID: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>

Dear R-SIG-GEO list

I want to aggregate the mean value of points in a polygon using the over function. 
#Read the shapefile with the measurements
shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
names(slot(point.shapefile,'data')) <- c("ID",shortNameIndicator)


#aggregate per polygon by mean and save as shapefile
aggregate.data<-over(studyzone,point.shapefile,fn=mean)
row.names(aggregate.data) <- row.names(aggregate.data)
outPolDF <- SpatialPolygonsDataFrame(studyzone,aggregate.data,match.ID=T)
writePolyShape(outPolDF,paste(shapefiledir,shortNameIndicator,"_poly_",production.date,".shp",sep=""))


While this works using the mean function I am unsure how to proceed for a weighted mean - does anyone have a suggestion?

Many thanks
Els


From edzer.pebesma at uni-muenster.de  Fri Mar 30 14:17:00 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 30 Mar 2012 14:17:00 +0200
Subject: [R-sig-Geo] Spatial Join - over and weighted mean
In-Reply-To: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>
References: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>
Message-ID: <4F75A43C.2090108@uni-muenster.de>

Els, what being weighted by what exactly? Any chance you can illustrate
your problem by something we can reproduce?

On 03/30/2012 01:58 PM, Els Ducheyne wrote:
> Dear R-SIG-GEO list
> 
> I want to aggregate the mean value of points in a polygon using the over function. 
> #Read the shapefile with the measurements
> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
> names(slot(point.shapefile,'data')) <- c("ID",shortNameIndicator)
> 
> 
> #aggregate per polygon by mean and save as shapefile
> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
> row.names(aggregate.data) <- row.names(aggregate.data)
> outPolDF <- SpatialPolygonsDataFrame(studyzone,aggregate.data,match.ID=T)
> writePolyShape(outPolDF,paste(shapefiledir,shortNameIndicator,"_poly_",production.date,".shp",sep=""))
> 
> 
> While this works using the mean function I am unsure how to proceed for a weighted mean - does anyone have a suggestion?
> 
> Many thanks
> Els
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From educheyne at avia-gis.be  Fri Mar 30 14:29:18 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 30 Mar 2012 14:29:18 +0200
Subject: [R-sig-Geo] Spatial Join - over and weighted mean
In-Reply-To: <4F75A43C.2090108@uni-muenster.de>
References: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>
	<4F75A43C.2090108@uni-muenster.de>
Message-ID: <1195496A-1D99-4225-BBEF-464B2EEBAC02@avia-gis.be>

Dear Edzer
I have a point shapefile containing values of vaccination coverage (Z) estimated via a sample (SampleSize)
The aim is to obtain a weighted mean of vaccination coverage per admin unit

Below sample code

> studyzone <- readShapePoly(paste(backgroundfilesdir,"GDAM_studyzone.shp",sep=""))
> slot(studyzone,'data') <- as.data.frame(slot(studyzone,"data")$OBJECTID)
> names(slot(studyzone,'data')) <- c("OBJECTID")
> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
> summary(point.shapefile)
Object of class SpatialPointsDataFrame
Coordinates:
            min   max
coords.x1   0.0 41.96
coords.x2 -11.1 16.73
Is projected: NA 
proj4string : [NA]
Number of points: 76
Data attributes:
       Id              Z            SampleSize    
 Min.   : 1.00   Min.   :0.0400   Min.   : 388.0  
 1st Qu.:19.75   1st Qu.:0.2200   1st Qu.: 549.2  
 Median :38.50   Median :0.4300   Median : 659.0  
 Mean   :38.50   Mean   :0.5437   Mean   :1562.1  
 3rd Qu.:57.25   3rd Qu.:0.7450   3rd Qu.:2480.8  
 Max.   :76.00   Max.   :2.4000   Max.   :6487.0  
                                  NA's   :   2.0  


For the moment I've used the following function to obtain the normal mean
aggregate.data<-over(studyzone,point.shapefile,fn=mean)

I know I should define the weighted.mean by weighted.mean(slot(point.shapefile,'data')$Z,slot(point.shapefile,'data')$SampleSize,na.rm=T) but how to include this in the over function is not clear to me

Thanks for your help
Els

On 30 Mar 2012, at 14:17, Edzer Pebesma wrote:

> Els, what being weighted by what exactly? Any chance you can illustrate
> your problem by something we can reproduce?
> 
> On 03/30/2012 01:58 PM, Els Ducheyne wrote:
>> Dear R-SIG-GEO list
>> 
>> I want to aggregate the mean value of points in a polygon using the over function. 
>> #Read the shapefile with the measurements
>> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
>> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
>> names(slot(point.shapefile,'data')) <- c("ID",shortNameIndicator)
>> 
>> 
>> #aggregate per polygon by mean and save as shapefile
>> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
>> row.names(aggregate.data) <- row.names(aggregate.data)
>> outPolDF <- SpatialPolygonsDataFrame(studyzone,aggregate.data,match.ID=T)
>> writePolyShape(outPolDF,paste(shapefiledir,shortNameIndicator,"_poly_",production.date,".shp",sep=""))
>> 
>> 
>> While this works using the mean function I am unsure how to proceed for a weighted mean - does anyone have a suggestion?
>> 
>> Many thanks
>> Els
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Fri Mar 30 15:10:17 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 30 Mar 2012 15:10:17 +0200
Subject: [R-sig-Geo] Spatial Join - over and weighted mean
In-Reply-To: <1195496A-1D99-4225-BBEF-464B2EEBAC02@avia-gis.be>
References: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>
	<4F75A43C.2090108@uni-muenster.de>
	<1195496A-1D99-4225-BBEF-464B2EEBAC02@avia-gis.be>
Message-ID: <4F75B0B9.20901@uni-muenster.de>



On 03/30/2012 02:29 PM, Els Ducheyne wrote:
> Dear Edzer
> I have a point shapefile containing values of vaccination coverage (Z) estimated via a sample (SampleSize)
> The aim is to obtain a weighted mean of vaccination coverage per admin unit
> 
> Below sample code
> 
>> studyzone <- readShapePoly(paste(backgroundfilesdir,"GDAM_studyzone.shp",sep=""))
>> slot(studyzone,'data') <- as.data.frame(slot(studyzone,"data")$OBJECTID)
>> names(slot(studyzone,'data')) <- c("OBJECTID")
>> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
>> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
>> summary(point.shapefile)
> Object of class SpatialPointsDataFrame
> Coordinates:
>             min   max
> coords.x1   0.0 41.96
> coords.x2 -11.1 16.73
> Is projected: NA 
> proj4string : [NA]
> Number of points: 76
> Data attributes:
>        Id              Z            SampleSize    
>  Min.   : 1.00   Min.   :0.0400   Min.   : 388.0  
>  1st Qu.:19.75   1st Qu.:0.2200   1st Qu.: 549.2  
>  Median :38.50   Median :0.4300   Median : 659.0  
>  Mean   :38.50   Mean   :0.5437   Mean   :1562.1  
>  3rd Qu.:57.25   3rd Qu.:0.7450   3rd Qu.:2480.8  
>  Max.   :76.00   Max.   :2.4000   Max.   :6487.0  
>                                   NA's   :   2.0  
> 
> 
> For the moment I've used the following function to obtain the normal mean
> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
> 
> I know I should define the weighted.mean by weighted.mean(slot(point.shapefile,'data')$Z,slot(point.shapefile,'data')$SampleSize,na.rm=T) but how to include this in the over function is not clear to me

I don't think you can, as it takes two arguments that are both data
columns. over() essentially applies fun() to each of the columns in the
data.frame slot, but cannot combine two columns in a single function call.

You can pre-weight your values though, so that mean() results in the
weighted mean you want.

To access slot(point.shapefile,'data')$Z it is recommended to use
point.shapefile$Z

> 
> Thanks for your help
> Els
> 
> On 30 Mar 2012, at 14:17, Edzer Pebesma wrote:
> 
>> Els, what being weighted by what exactly? Any chance you can illustrate
>> your problem by something we can reproduce?
>>
>> On 03/30/2012 01:58 PM, Els Ducheyne wrote:
>>> Dear R-SIG-GEO list
>>>
>>> I want to aggregate the mean value of points in a polygon using the over function. 
>>> #Read the shapefile with the measurements
>>> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
>>> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
>>> names(slot(point.shapefile,'data')) <- c("ID",shortNameIndicator)
>>>
>>>
>>> #aggregate per polygon by mean and save as shapefile
>>> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
>>> row.names(aggregate.data) <- row.names(aggregate.data)
>>> outPolDF <- SpatialPolygonsDataFrame(studyzone,aggregate.data,match.ID=T)
>>> writePolyShape(outPolDF,paste(shapefiledir,shortNameIndicator,"_poly_",production.date,".shp",sep=""))
>>>
>>>
>>> While this works using the mean function I am unsure how to proceed for a weighted mean - does anyone have a suggestion?
>>>
>>> Many thanks
>>> Els
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From paulobrando at gmail.com  Fri Mar 30 15:18:14 2012
From: paulobrando at gmail.com (Paulo Brando)
Date: Fri, 30 Mar 2012 10:18:14 -0300
Subject: [R-sig-Geo] error writeRaster
Message-ID: <CAMkjBVXfaZiMDZ4vE4r8Bc02=5pSggGMX7bD=_j81hLDEG7zuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/4e77e79e/attachment.pl>

From educheyne at avia-gis.be  Fri Mar 30 15:28:30 2012
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 30 Mar 2012 15:28:30 +0200
Subject: [R-sig-Geo] Spatial Join - over and weighted mean
In-Reply-To: <4F75B0B9.20901@uni-muenster.de>
References: <0B7F8A51-B7DF-410E-BB62-838C481BAEE8@avia-gis.be>
	<4F75A43C.2090108@uni-muenster.de>
	<1195496A-1D99-4225-BBEF-464B2EEBAC02@avia-gis.be>
	<4F75B0B9.20901@uni-muenster.de>
Message-ID: <23786547-C992-4030-B382-9EBB6E10784C@avia-gis.be>

Dear Edze
Thanks for your help
Best regards

On 30 Mar 2012, at 15:10, Edzer Pebesma wrote:

> 
> 
> On 03/30/2012 02:29 PM, Els Ducheyne wrote:
>> Dear Edzer
>> I have a point shapefile containing values of vaccination coverage (Z) estimated via a sample (SampleSize)
>> The aim is to obtain a weighted mean of vaccination coverage per admin unit
>> 
>> Below sample code
>> 
>>> studyzone <- readShapePoly(paste(backgroundfilesdir,"GDAM_studyzone.shp",sep=""))
>>> slot(studyzone,'data') <- as.data.frame(slot(studyzone,"data")$OBJECTID)
>>> names(slot(studyzone,'data')) <- c("OBJECTID")
>>> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
>>> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
>>> summary(point.shapefile)
>> Object of class SpatialPointsDataFrame
>> Coordinates:
>>            min   max
>> coords.x1   0.0 41.96
>> coords.x2 -11.1 16.73
>> Is projected: NA 
>> proj4string : [NA]
>> Number of points: 76
>> Data attributes:
>>       Id              Z            SampleSize    
>> Min.   : 1.00   Min.   :0.0400   Min.   : 388.0  
>> 1st Qu.:19.75   1st Qu.:0.2200   1st Qu.: 549.2  
>> Median :38.50   Median :0.4300   Median : 659.0  
>> Mean   :38.50   Mean   :0.5437   Mean   :1562.1  
>> 3rd Qu.:57.25   3rd Qu.:0.7450   3rd Qu.:2480.8  
>> Max.   :76.00   Max.   :2.4000   Max.   :6487.0  
>>                                  NA's   :   2.0  
>> 
>> 
>> For the moment I've used the following function to obtain the normal mean
>> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
>> 
>> I know I should define the weighted.mean by weighted.mean(slot(point.shapefile,'data')$Z,slot(point.shapefile,'data')$SampleSize,na.rm=T) but how to include this in the over function is not clear to me
> 
> I don't think you can, as it takes two arguments that are both data
> columns. over() essentially applies fun() to each of the columns in the
> data.frame slot, but cannot combine two columns in a single function call.
> 
> You can pre-weight your values though, so that mean() results in the
> weighted mean you want.
> 
> To access slot(point.shapefile,'data')$Z it is recommended to use
> point.shapefile$Z
> 
>> 
>> Thanks for your help
>> Els
>> 
>> On 30 Mar 2012, at 14:17, Edzer Pebesma wrote:
>> 
>>> Els, what being weighted by what exactly? Any chance you can illustrate
>>> your problem by something we can reproduce?
>>> 
>>> On 03/30/2012 01:58 PM, Els Ducheyne wrote:
>>>> Dear R-SIG-GEO list
>>>> 
>>>> I want to aggregate the mean value of points in a polygon using the over function. 
>>>> #Read the shapefile with the measurements
>>>> shapefilename <- paste(shapefiledir,shortNameIndicator,"_",production.date,sep="")
>>>> point.shapefile <- readShapePoints(paste(shapefilename,".shp",sep=""))
>>>> names(slot(point.shapefile,'data')) <- c("ID",shortNameIndicator)
>>>> 
>>>> 
>>>> #aggregate per polygon by mean and save as shapefile
>>>> aggregate.data<-over(studyzone,point.shapefile,fn=mean)
>>>> row.names(aggregate.data) <- row.names(aggregate.data)
>>>> outPolDF <- SpatialPolygonsDataFrame(studyzone,aggregate.data,match.ID=T)
>>>> writePolyShape(outPolDF,paste(shapefiledir,shortNameIndicator,"_poly_",production.date,".shp",sep=""))
>>>> 
>>>> 
>>>> While this works using the mean function I am unsure how to proceed for a weighted mean - does anyone have a suggestion?
>>>> 
>>>> Many thanks
>>>> Els
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> -- 
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de


From ashenkin at ufl.edu  Fri Mar 30 16:15:42 2012
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Fri, 30 Mar 2012 09:15:42 -0500
Subject: [R-sig-Geo] Closing readOGR handles
Message-ID: <4F75C00E.5010400@ufl.edu>

Hi folks,

I'm opening some ESRI shapefiles with readOGR.  R seems to keep open
file handles on the files opened.  Is there any way to close those
handles without quitting R?  I don't see a read-only option on readOGR,
nor do I see any close methods.  I've tried GDAL.close(x), but I get
errors saying there's no "handle" slot.

Thanks,
Allie


From martijn.smit at vu.nl  Fri Mar 30 16:23:40 2012
From: martijn.smit at vu.nl (Smit, M.J.)
Date: Fri, 30 Mar 2012 14:23:40 +0000
Subject: [R-sig-Geo] Predict
Message-ID: <FBA2943645E7EA43A9ED44966DBAB9E508FF9F76@PEXMB001A.vu.local>

Dear list members,

I want to do a scenario analysis: run a regression on the real data, then make some changes to that, and do a prediction based on the changed data. There is a predict command under sarlm for this, and it works. However, I have two questions.

- predict(model,newdata=NULL,weights) uses not only trend (the non-spatial terms) and signal (the spatial "smooth") but also noise (the residuals from the original regression). Is it true I can avoid this by explicitly inserting my old dataset into newdata=? The predictions differ, so something has happened.
- predict then gives me a list object, and I'm at a loss how to get the results from this. I've named the objects pred1 and pred2, and vainly tried pred1$trend and pred1[[1]], which gives the first observation from the $trend subvariable, but doesn't allow access to the other subvariables. Is there a way to get this into as.data.frame?

Best regards,
Martijn


From b.rowlingson at lancaster.ac.uk  Fri Mar 30 16:42:50 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 30 Mar 2012 15:42:50 +0100
Subject: [R-sig-Geo] Closing readOGR handles
In-Reply-To: <4F75C00E.5010400@ufl.edu>
References: <4F75C00E.5010400@ufl.edu>
Message-ID: <CANVKczNiwWneSS5bwOJAMG0nJXAy137_Pd6U9RKqm-tnAX3Meg@mail.gmail.com>

On Fri, Mar 30, 2012 at 3:15 PM, Alexander Shenkin <ashenkin at ufl.edu> wrote:
> Hi folks,
>
> I'm opening some ESRI shapefiles with readOGR. ?R seems to keep open
> file handles on the files opened. ?Is there any way to close those
> handles without quitting R? ?I don't see a read-only option on readOGR,
> nor do I see any close methods. ?I've tried GDAL.close(x), but I get
> errors saying there's no "handle" slot.

 I don't see that happening. What OS are you on? How are you detecting
open file handles?

 On my Linux box if I use "lsof" before and after reading a shapefile
(with readOGR) I don't see any new file handles left open.

 If I open a file connection with "file" and "open" I do see a new
file handle, so if readOGR was leaving it open then I think I would
see it.

> packageDescription("rgdal")
Package: rgdal
Title: Bindings for the Geospatial Data Abstraction Library
Version: 0.7-5
Date: 2011-11-16

 would be useful...

Barry


From jmolina9 at jhu.edu  Fri Mar 30 17:37:10 2012
From: jmolina9 at jhu.edu (Jose M Molina)
Date: Fri, 30 Mar 2012 11:37:10 -0400
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA2010B0039F@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
	<CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com>
	<586A4828D7AAA04CA9B258C50A28DA2010B0039F@BALI.uhd.campus>
Message-ID: <4F75D326.4050402@jhu.edu>

Hi R-Sig-Geo  friends,

I have climatic data sets generated with R, and As Erin, I also need to 
plot spatial attributes (e.g. monthly rainfall), but at a country-level.
In addition, I need also to plot spatial variability (e.g. isolines of 
mean annual precipitation) in the specified country.
I am exploring now {rworldmap}, but it seems this is not possible. 
{PlotGoogleMaps} offers a very nice option, although I am struggling 
still with generating spatial interpolation for the isolines.

I appreciate tour comments/suggestions.

Jose


On 3/29/2012 6:31 PM, Hodgess, Erin wrote:
> Perfect...rworldmapExamples has everything.
>
> Thanks,
> Erin
>
>
> -----Original Message-----
> From: Carson Farmer [mailto:carson.farmer at gmail.com]
> Sent: Thursday, March 29, 2012 5:29 PM
> To: Hodgess, Erin
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] a world type mapping question
>
> Hi Erin (apologies for sending this to you twice, forgot to include list the first time),
>
> Have a look at rworldmap:
> http://cran.r-project.org/web/packages/rworldmap/index.html
>
> Carson
>
> On Thu, Mar 29, 2012 at 11:19 PM, Hodgess, Erin<HodgessE at uhd.edu>  wrote:
>> Dear People:
>>
>>
>>
>> I have a data set with rankings for 18 different countries on several
>> different concepts.  I would like to produce a world map with colors
>> on the ones with rankings and perhaps grays on the NA countries.
>>
>>
>>
>> Is there a data frame/set with a list of countries available, please?
>>
>>
>>
>> Thanks,
>>
>> Erin
>>
>>
>>
>>
>>
>>
>>
>> Erin M. Hodgess, Ph.D.
>>
>> Associate Professor
>>
>> Department of Computer and Mathematical Sciences
>>
>> University of Houston - Downtown
>>
>> mailto: hodgesse at uhd.edu
>>
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> --
> Dr. Carson J. Q. Farmer
> Centre for GeoInformatics (CGI)
> School of Geography and Geosciences
> Irvine Building, University of St Andrews St Andrews, Fife, KY16 9AL Scotland, UK
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Jose M Molina
Department of Earth and Planetary Sciences
Johns Hopkins University
3400 N. Charles Street
Baltimore, MD 21218


From HodgessE at uhd.edu  Fri Mar 30 17:39:58 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 30 Mar 2012 10:39:58 -0500
Subject: [R-sig-Geo] a world type mapping question
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus><CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com><586A4828D7AAA04CA9B258C50A28DA2010B0039F@BALI.uhd.campus>
	<4F75D326.4050402@jhu.edu>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58FD4@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/ce30eca8/attachment.pl>

From ashenkin at ufl.edu  Fri Mar 30 18:12:06 2012
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Fri, 30 Mar 2012 11:12:06 -0500
Subject: [R-sig-Geo] Closing readOGR handles
In-Reply-To: <CANVKczNiwWneSS5bwOJAMG0nJXAy137_Pd6U9RKqm-tnAX3Meg@mail.gmail.com>
References: <4F75C00E.5010400@ufl.edu>
	<CANVKczNiwWneSS5bwOJAMG0nJXAy137_Pd6U9RKqm-tnAX3Meg@mail.gmail.com>
Message-ID: <4F75DB56.2050609@ufl.edu>

Hmm, I restarted R, and can't reproduce the issue.  I'll post back if
and when it happens again and I can narrow it down.

I'm on Win 7 Pro x64, running R 2.14.2 and RStudio 0.95.263.  I saw the
open filehandles by doing a search in Process Explorer.

> packageDescription("rgdal")
Package: rgdal
Title: Bindings for the Geospatial Data Abstraction Library
Version: 0.7-8
Date: 2012-01-18

thanks,
allie

On 3/30/2012 9:42 AM, Barry Rowlingson wrote:
> On Fri, Mar 30, 2012 at 3:15 PM, Alexander Shenkin <ashenkin at ufl.edu> wrote:
>> Hi folks,
>>
>> I'm opening some ESRI shapefiles with readOGR.  R seems to keep open
>> file handles on the files opened.  Is there any way to close those
>> handles without quitting R?  I don't see a read-only option on readOGR,
>> nor do I see any close methods.  I've tried GDAL.close(x), but I get
>> errors saying there's no "handle" slot.
> 
>  I don't see that happening. What OS are you on? How are you detecting
> open file handles?
> 
>  On my Linux box if I use "lsof" before and after reading a shapefile
> (with readOGR) I don't see any new file handles left open.
> 
>  If I open a file connection with "file" and "open" I do see a new
> file handle, so if readOGR was leaving it open then I think I would
> see it.
> 
>> packageDescription("rgdal")
> Package: rgdal
> Title: Bindings for the Geospatial Data Abstraction Library
> Version: 0.7-5
> Date: 2011-11-16
> 
>  would be useful...
> 
> Barry


From jmolina9 at jhu.edu  Fri Mar 30 18:51:44 2012
From: jmolina9 at jhu.edu (Jose M Molina)
Date: Fri, 30 Mar 2012 12:51:44 -0400
Subject: [R-sig-Geo] a world type mapping question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58FD4@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA2010B0037B@BALI.uhd.campus>
	<CADB6tZu89vG_vHUsTtkJ8foJz-AO0uj=eyAHbM6S4pTMNSwinA@mail.gmail.com>
	<586A4828D7AAA04CA9B258C50A28DA2010B0039F@BALI.uhd.campus>
	<4F75D326.4050402@jhu.edu>
	<586A4828D7AAA04CA9B258C50A28DA200BF58FD4@BALI.uhd.campus>
Message-ID: <4F75E4A0.1050808@jhu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/13680be0/attachment.pl>

From r.hijmans at gmail.com  Fri Mar 30 19:39:14 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 30 Mar 2012 10:39:14 -0700
Subject: [R-sig-Geo] error writeRaster
In-Reply-To: <CAMkjBVXfaZiMDZ4vE4r8Bc02=5pSggGMX7bD=_j81hLDEG7zuQ@mail.gmail.com>
References: <CAMkjBVXfaZiMDZ4vE4r8Bc02=5pSggGMX7bD=_j81hLDEG7zuQ@mail.gmail.com>
Message-ID: <CANtt_hxCxrtAbYxCRCfw4msCHMkTGEY=EfjHA+Gnv6FZHFFNww@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/57bd05f9/attachment.pl>

From lyndon.estes at gmail.com  Fri Mar 30 20:13:25 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Fri, 30 Mar 2012 14:13:25 -0400
Subject: [R-sig-Geo] Change color of NA region in plotRGB?
Message-ID: <CALuVVaajBby-z_4WMw9j99jr65fSwph_Xb-SeERRqO7bR9-bKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/59f07e56/attachment.pl>

From oliveirajc at ufv.br  Fri Mar 30 20:14:34 2012
From: oliveirajc at ufv.br (julio cesar oliveira)
Date: Fri, 30 Mar 2012 15:14:34 -0300
Subject: [R-sig-Geo] upgrade plot
Message-ID: <CAG+u5gqb_jfOURP_ZDdF6QwPqzzgAr7HZJPHt3Rksf67HH2K0w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/162ff6a9/attachment.pl>

From r.hijmans at gmail.com  Fri Mar 30 21:02:31 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 30 Mar 2012 12:02:31 -0700
Subject: [R-sig-Geo] Change color of NA region in plotRGB?
In-Reply-To: <CALuVVaajBby-z_4WMw9j99jr65fSwph_Xb-SeERRqO7bR9-bKQ@mail.gmail.com>
References: <CALuVVaajBby-z_4WMw9j99jr65fSwph_Xb-SeERRqO7bR9-bKQ@mail.gmail.com>
Message-ID: <CANtt_hyOTazSky8BbgiJ+HogyQ4hC1MjYuN6m9XUOFFAT5uOaA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/d0d3c552/attachment.pl>

From r.hijmans at gmail.com  Fri Mar 30 21:02:58 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 30 Mar 2012 12:02:58 -0700
Subject: [R-sig-Geo] error writeRaster
In-Reply-To: <647FC90DB0B64DAC8556E475A5FC915C@gmail.com>
References: <CAMkjBVXfaZiMDZ4vE4r8Bc02=5pSggGMX7bD=_j81hLDEG7zuQ@mail.gmail.com>
	<CANtt_hxCxrtAbYxCRCfw4msCHMkTGEY=EfjHA+Gnv6FZHFFNww@mail.gmail.com>
	<647FC90DB0B64DAC8556E475A5FC915C@gmail.com>
Message-ID: <CANtt_hyFe=GT47GbPymyCCPLT7doWzovesZsUo-Y+f_TK_Fprw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/b1ddd0e8/attachment.pl>

From lyndon.estes at gmail.com  Fri Mar 30 21:10:59 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Fri, 30 Mar 2012 15:10:59 -0400
Subject: [R-sig-Geo] Change color of NA region in plotRGB?
In-Reply-To: <CANtt_hyOTazSky8BbgiJ+HogyQ4hC1MjYuN6m9XUOFFAT5uOaA@mail.gmail.com>
References: <CALuVVaajBby-z_4WMw9j99jr65fSwph_Xb-SeERRqO7bR9-bKQ@mail.gmail.com>
	<CANtt_hyOTazSky8BbgiJ+HogyQ4hC1MjYuN6m9XUOFFAT5uOaA@mail.gmail.com>
Message-ID: <CALuVVaYcUjfHvEYpQjSZhMhNoNMHMA=u_5sZCM67ViJv+3P8Ag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120330/8f3d12e2/attachment.pl>

From Roger.Bivand at nhh.no  Sat Mar 31 10:36:05 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 31 Mar 2012 10:36:05 +0200 (CEST)
Subject: [R-sig-Geo] Predict
In-Reply-To: <FBA2943645E7EA43A9ED44966DBAB9E508FF9F76@PEXMB001A.vu.local>
References: <FBA2943645E7EA43A9ED44966DBAB9E508FF9F76@PEXMB001A.vu.local>
Message-ID: <alpine.LRH.2.02.1203301958280.10660@reclus.nhh.no>

On Fri, 30 Mar 2012, Smit, M.J. wrote:

> Dear list members,
>
> I want to do a scenario analysis: run a regression on the real data, then make some changes to that, and do a prediction based on the changed data. There is a predict command under sarlm for this, and it works. However, I have two questions.
>
> - predict(model,newdata=NULL,weights) uses not only trend (the 
> non-spatial terms) and signal (the spatial "smooth") but also noise (the 
> residuals from the original regression). Is it true I can avoid this by 
> explicitly inserting my old dataset into newdata=? The predictions 
> differ, so something has happened.

Yes, this is what is happening. In the newdata=NULL case, the response is 
known, so the signal is defined in terms of the response. If newdata is 
given, it is defined in terms of the data generation process.

> - predict then gives me a list object, and I'm at a loss how to get the 
> results from this. I've named the objects pred1 and pred2, and vainly 
> tried pred1$trend and pred1[[1]], which gives the first observation from 
> the $trend subvariable, but doesn't allow access to the other 
> subvariables. Is there a way to get this into as.data.frame?

I'll add an S3 method to do this. For now, assign the result of the print 
method to an object:

goAway <- capture.output(predsDataFrame <- print(<sarlm.predObject>))

with capture.output() to prevent it printing to screen. The 
as.data.frame() method is in revision 430 on R-forge.

Roger

>
> Best regards,
> Martijn
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


