From oscar.perpinan at gmail.com  Wed May  1 01:20:19 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 01 May 2013 01:20:19 +0200
Subject: [R-sig-Geo] How can I plot categorical raster (using
	levelplot?)	with a proper legend?
In-Reply-To: <9q0vc74gew5.fsf@gmx.us>
References: <9q0vc74gew5.fsf@gmx.us>
Message-ID: <87fvy74nd8.fsf@gmail.com>

Hello,

The levelplot method in the current version of rasterVis is not able to
work with RATs with more than one variable. I have just uploaded to
R-Forge a fix to solve this problem. Besides, levelplot has gained a new
argument (att) to choose which variable you need. Maybe tomorrow this
new version will be built and available to install. Meanwhile you can
build it on your own or use a RAT with only one attribute (for example,
drop the column "class").

Best,

Oscar.

Mikhail Titov <mlt at gmx.us> writes:

> Hi, all!
>
> I have a raster exported from ArcMap that I'm trying to plot (for now)
> with raster/rasterVis. But the problem is that levelplot fails to plot
> raster as is. When I deratify it first, it plots, but the legend is
> incorrect :( The manual for rasterVis says to use ratify for categorical
> data, but calling ratify makes no difference for me.
>
> I feel like I'm missing something... Here is the code I was using.
>
> ,----[ loading data ]
> | library(raster)
> | library(rasterVis)
> | library(foreign)
> | fname <- "too-big-to-attach.img"
> | benefits.rast <- raster(fname)
> | rat <- read.dbf(paste(fname, ".vat.dbf", sep=""))
> | names(rat)[1] <- "ID"                   # rename Value to ID
> | levels(benefits.rast) <- rat
> | levels(benefits.rast)
> `----
>
> This yields in my case
>
> ,----[ levels(benefits.rast) ]
> | [[1]]
> |   ID Count class
> | 1  0  3616     D
> | 2  1  2476     R
> | 3  2 11584     C
> | 4  3   305    NB
> | 5  4    60    D-
> | 6  5  1912     B
> | 7  6    57    SA
> | 8  7   151     A
> `----
>
> At this point if I call levelplot(benefits.rast), nothing is being
> plotted and I get the following error.
>
> ,----[ Error from levelplot(benefits.rast) ]
> | Error in from:to : result would be too long a vector
> | In addition: Warning messages:
> | 1: In min(x) : no non-missing arguments to min; returning Inf
> | 2: In max(x) : no non-missing arguments to max; returning -Inf
> | 3: In min(x) : no non-missing arguments to min; returning Inf
> | 4: In max(x) : no non-missing arguments to max; returning -Inf
> `----
>
> However the following code does produce a plot but with messed up legend
> items. Here is how it looks http://i.troll.ws/55d45652.png . Something
> yellowish that looks like a road should be 'R'.
>
> ,----[ The following results in a messed up legend ]
> | benefits.cat <- deratify(benefits.rast, "class")
> | levelplot(benefits.cat)                 # from rasterVis
> `----
>
> ,----[ The following results in a proper plot but with IDs ]
> | benefits.cat <- deratify(benefits.rast, "ID")
> | levelplot(benefits.cat)                 # from rasterVis
> `----
>
> An here is an experiment with ratify
>
> ,----[ try ratify ]
> | benefits.cat <- ratify(benefits.rast)
> | levelplot(benefits.cat)                 # from rasterVis
> `----
>
> That gives me
>
> ,----
> | Error in .checkLevels(levels(x)[[1]], value) : 
> |   the number of columns in the raster attributes (factors) data.frame should be > 1
> `----


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From mlt at gmx.us  Wed May  1 01:47:45 2013
From: mlt at gmx.us (Mikhail Titov)
Date: Tue, 30 Apr 2013 18:47:45 -0500
Subject: [R-sig-Geo] How can I plot categorical raster (using
	levelplot?) with a proper legend?
In-Reply-To: <87fvy74nd8.fsf@gmail.com> ("Oscar =?iso-8859-1?Q?Perpi=F1=E1?=
	=?iso-8859-1?Q?n?= Lamigueiro"'s message
	of "Wed, 01 May 2013 01:20:19 +0200")
References: <9q0vc74gew5.fsf@gmx.us> <87fvy74nd8.fsf@gmail.com>
Message-ID: <9q0r4hrh97i.fsf_-_@gmx.us>

On Tue, Apr 30, 2013 at  6:20 PM, Oscar Perpi??n Lamigueiro <oscar.perpinan at gmail.com> wrote:
> The levelplot method in the current version of rasterVis is not able to
> work with RATs with more than one variable. I have just uploaded to
> R-Forge a fix to solve this problem. Besides, levelplot has gained a new
> argument (att) to choose which variable you need. Maybe tomorrow this
> new version will be built and available to install. Meanwhile you can
> build it on your own or use a RAT with only one attribute (for example,
> drop the column "class").

Thanks a lot! Dropping "Count" did the trick. I did not think about
dropping a column though I was wondering if it was expected to handle
"Count" in a smart way on its own.

-- 
Mikhail


From marianamv at utexas.edu  Wed May  1 05:43:41 2013
From: marianamv at utexas.edu (Mariana Vasconcellos)
Date: Tue, 30 Apr 2013 22:43:41 -0500
Subject: [R-sig-Geo] Extrapolating SDM with random forest to past climatic
	scenarios
Message-ID: <48360AD0-10DD-430D-9125-37773AA5B55D@utexas.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/7c1e16de/attachment.pl>

From r.hijmans at gmail.com  Wed May  1 18:43:02 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 1 May 2013 09:43:02 -0700
Subject: [R-sig-Geo] Extrapolating SDM with random forest to past
	climatic scenarios
In-Reply-To: <48360AD0-10DD-430D-9125-37773AA5B55D@utexas.edu>
References: <48360AD0-10DD-430D-9125-37773AA5B55D@utexas.edu>
Message-ID: <CANtt_hxTTYO4p26OWxk9XKYW5jUzgUOsPtx_Ph+2KgRnfdgPig@mail.gmail.com>

Mariana,

predict is the function to use. Please provide the exact error message
you are getting, preceded by the lines of the script that caused it.
Also include the result of  traceback( ) when run just after the error
occurs, and, as always, your sessionInfo(). I am guessing that the
problem is that the variable names do not match those of your model.
See names(predictors_6k) and change them if necessary.

By the way, it is odd (to put it mildly) to use elevation in a model
of climate change effects. And you probably meant to do filename =
"6k_results.asc" (but using ascii files is not recommended for their
sluggish performance).

Robert

On Tue, Apr 30, 2013 at 8:43 PM, Mariana Vasconcellos
<marianamv at utexas.edu> wrote:
> Hi all,
> I am trying to extrapolate my species distribution model generated using randomForest to past and future climate scenarios. Using the predict function is not working for a raster stack that was NOT used to fit the model. It gives me an error message saying that my raster stack and my variables are not of the same size. I think the predict function might not be the best way to extrapolate my model, but I don't know which function I would use for extrapolating my model in time.
>
> My script looks more or less like this:
>
> # fitting Random Forest SDM model with current climate data
>
> files <- list.files(path="./WorldClim/0k", pattern='asc', full.names=TRUE)
> predictors <-stack(files)
> pres <- read.csv('pres_H_lundii.csv')
> backgr <- randomPoints(predictors, 500)
> presclim <- extract(predictors, pres)
> absclim <- extract(predictors, backgr)
> presabs <- c(rep(1, nrow(presclim)), rep(0, nrow(absclim)))
> sdm_data <- data.frame(cbind(presabs, rbind(presclim, absclim)))
> model <- factor(presabs) ~ alt + bio3 + bio4 + bio7 + bio10 + bio11 + bio14 + bio15 + bio16 + bio17
> RF <- randomForest(model, data=sdm_data)
>
> # extrapolating to past scenario 6kya
>
> files_6k <- list.files(path="./WorldClim/6k", pattern='asc', full.names=TRUE)
> predictors_6k <-stack(files_6k)
> pred <- predict(predictors_6k, RF, type="response", filename = "0k_results.asc", format = "ascii",
> + progress='window', overwrite=TRUE)
>
>
> Any help on this would be much appreciated!
> Thanks,
>
> ----------------------
> Mariana Vasconcellos
> The University of Texas at Austin
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From milansharma2012 at yahoo.com  Wed May  1 18:58:15 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 1 May 2013 09:58:15 -0700 (PDT)
Subject: [R-sig-Geo] ZIP for spatial data in R
Message-ID: <1367427495.77189.YahooMailNeo@web162101.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130501/d1e5a347/attachment.pl>

From mathieu.rajerison at gmail.com  Thu May  2 12:03:10 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 2 May 2013 12:03:10 +0200
Subject: [R-sig-Geo] drawing ellipses to display uncertainty around
 estimates of animal locations
In-Reply-To: <A9861AB2E33A7D43BB8566F0BEF89DD7012E1D14@PDLEXCH.uac.pt>
References: <A9861AB2E33A7D43BB8566F0BEF89DD7012E1D14@PDLEXCH.uac.pt>
Message-ID: <CAGfc75m9J=jdznWv0=HggZknsOKSxxuB5_SYTGFmUS608gNK_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/92a22788/attachment.pl>

From mathieu.rajerison at gmail.com  Thu May  2 12:04:09 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 2 May 2013 12:04:09 +0200
Subject: [R-sig-Geo] Distance converted in koordinates
In-Reply-To: <CACje6_ZWqg-24s+rgNAzRWCuYGFwTJraXEb4xZ7brxeSe8_g8g@mail.gmail.com>
References: <CACje6_ZWqg-24s+rgNAzRWCuYGFwTJraXEb4xZ7brxeSe8_g8g@mail.gmail.com>
Message-ID: <CAGfc75=hvYCkDUN8w4bbzuuqtpPpxgR_jo82HTi+_MRo+-A4mg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/a18ea65b/attachment.pl>

From mathieu.rajerison at gmail.com  Thu May  2 12:17:35 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 2 May 2013 12:17:35 +0200
Subject: [R-sig-Geo] what's new in asdar latest edition?
Message-ID: <CAGfc75nQ2Evf763dEr9ACNMk_5vSnO4YwRME8m6_rQLEx6QYLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/8ffbad2c/attachment.pl>

From onmikula at gmail.com  Thu May  2 14:39:12 2013
From: onmikula at gmail.com (=?ISO-8859-2?Q?Ond=F8ej_Mikula?=)
Date: Thu, 2 May 2013 14:39:12 +0200
Subject: [R-sig-Geo] suppress color palette scale in raster plot
Message-ID: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/b0bf269e/attachment.pl>

From kridox at ymail.com  Thu May  2 14:48:17 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Thu, 02 May 2013 21:48:17 +0900
Subject: [R-sig-Geo] suppress color palette scale in raster plot
In-Reply-To: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>
References: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>
Message-ID: <51826091.6070805@ymail.com>

Hi,

It took about 1 min to find the answer using a web search engine...

require(raster)
r <- raster(nrows=10, ncols=10)
r <- setValues(r, 1:ncell(r))
plot(r, legend=FALSE)

Regards,
Pascal


On 05/02/2013 09:39 PM, Ond?ej Mikula wrote:
> Dear list,
> I use the raster package to plot some relief maps and it works fine but I
> need to suppress color palette scale in my figures. Would anybody be so
> kind and give me a hint how to proceed?
> Thanks in advance
> Ond?ej
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tim.appelhans at gmail.com  Thu May  2 14:51:09 2013
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Thu, 02 May 2013 14:51:09 +0200
Subject: [R-sig-Geo] suppress color palette scale in raster plot
In-Reply-To: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>
References: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>
Message-ID: <5182613D.6050505@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/60c2fa52/attachment.pl>

From onmikula at gmail.com  Thu May  2 14:59:53 2013
From: onmikula at gmail.com (=?ISO-8859-2?Q?Ond=F8ej_Mikula?=)
Date: Thu, 2 May 2013 14:59:53 +0200
Subject: [R-sig-Geo] suppress color palette scale in raster plot
In-Reply-To: <5182613D.6050505@gmail.com>
References: <CAPJtSLMJpJFOCkdgnVn8CJwDY-Bu3rTQ8cm_sX8XH41EgJVX5g@mail.gmail.com>
	<5182613D.6050505@gmail.com>
Message-ID: <CAPJtSLP3otgiPmRN7YXOPbHrBsd68R3F+NDQBmOFkYVrhSmCQg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/b65b894a/attachment.pl>

From sarah.goslee at gmail.com  Thu May  2 15:36:48 2013
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 2 May 2013 09:36:48 -0400
Subject: [R-sig-Geo] Distance converted in koordinates
In-Reply-To: <CACje6_ZWqg-24s+rgNAzRWCuYGFwTJraXEb4xZ7brxeSe8_g8g@mail.gmail.com>
References: <CACje6_ZWqg-24s+rgNAzRWCuYGFwTJraXEb4xZ7brxeSe8_g8g@mail.gmail.com>
Message-ID: <CAM_vjuk4TtGqu7qDyRjqtJv+s-hOxyp0Z5+7bX5-0X3UMX-KBA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/dad4185d/attachment.pl>

From catalinroibu at gmail.com  Thu May  2 16:55:34 2013
From: catalinroibu at gmail.com (catalin roibu)
Date: Thu, 2 May 2013 17:55:34 +0300
Subject: [R-sig-Geo] ads packages
Message-ID: <CAEW+BD+w4cqsXEdUmqaDx2unr94ZY1Dg+1FMMWrMCoiZmkUfzw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/6c4b0f98/attachment.pl>

From roman.lustrik at gmail.com  Thu May  2 17:04:24 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 2 May 2013 17:04:24 +0200
Subject: [R-sig-Geo] ads packages
In-Reply-To: <CAEW+BD+w4cqsXEdUmqaDx2unr94ZY1Dg+1FMMWrMCoiZmkUfzw@mail.gmail.com>
References: <CAEW+BD+w4cqsXEdUmqaDx2unr94ZY1Dg+1FMMWrMCoiZmkUfzw@mail.gmail.com>
Message-ID: <CAHT1vpgNpg2PTTANB=yPr6JCrxEBUi1nLp_worRRMh5oVkNk_w@mail.gmail.com>

`ads` package is available on CRAN to install (except for windows). If
you need this package on a windows platform, you will need to compile
it by hand (you'll need the appropriate toolchain).


Cheers,
Roman

On Thu, May 2, 2013 at 4:55 PM, catalin roibu <catalinroibu at gmail.com> wrote:
>
> hello all!
> Is there a possibility to install the ads packages on R 3.0?
>
> thank you!
>
>
> --
> ---
> Catalin-Constantin ROIBU
> Lecturer PhD, Forestry engineer
> Forestry Faculty of Suceava
> Str. Universitatii no. 13, Suceava, 720229, Romania
> office phone     +4 0230 52 29 78, ext. 531
> mobile phone   +4 0745 53 18 01
>                        +4 0766 71 76 58
> FAX:                +4 0230 52 16 64
> silvic.usv.ro
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo




--
In God we trust, all others bring data.


From janice.jlsh at gmail.com  Thu May  2 18:20:14 2013
From: janice.jlsh at gmail.com (Janice Lee)
Date: Thu, 2 May 2013 18:20:14 +0200
Subject: [R-sig-Geo] Mapping cells from dataframe constructed in raster
Message-ID: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130502/98f79731/attachment.pl>

From subbu_843 at yahoo.co.in  Thu May  2 18:30:16 2013
From: subbu_843 at yahoo.co.in (subash)
Date: Thu, 2 May 2013 09:30:16 -0700 (PDT)
Subject: [R-sig-Geo] sill not reaching 1 in a climatological variogram
Message-ID: <1367512216726-7583465.post@n2.nabble.com>

Hi All,

I constructed a climatological variogram using 'gstat' package in R at daily
scale using 2 monsoon(JJAS) data. The *exponential* model was with variogram
parameters  

nugget - 0.04243
psill - 0.96633
Range - 16.88 Km

<http://r-sig-geo.2731867.n2.nabble.com/file/n7583465/climat_vario.png> 

I have couple of questions:

(1) Why is the psill not reaching 1, when the each day rain has been
normalized?
(2) Why is there a dip in the variogram at 50Km?

Your help will be highly appreciated.

Thanks & Regards
Subash







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/sill-not-reaching-1-in-a-climatological-variogram-tp7583465.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From abdoulayesar at gmail.com  Thu May  2 21:21:20 2013
From: abdoulayesar at gmail.com (Abdoulaye SARR)
Date: Thu, 2 May 2013 19:21:20 +0000
Subject: [R-sig-Geo] wavelets
Message-ID: <3BD13965-0252-44EA-86EA-56587FB85762@gmail.com>

Is  there a wavelets package macos for version 3?


From edzer.pebesma at uni-muenster.de  Fri May  3 08:15:47 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 03 May 2013 08:15:47 +0200
Subject: [R-sig-Geo] sill not reaching 1 in a climatological variogram
In-Reply-To: <1367512216726-7583465.post@n2.nabble.com>
References: <1367512216726-7583465.post@n2.nabble.com>
Message-ID: <51835613.6050604@uni-muenster.de>



On 05/02/2013 06:30 PM, subash wrote:
> Hi All,
> 
> I constructed a climatological variogram using 'gstat' package in R at daily
> scale using 2 monsoon(JJAS) data. The *exponential* model was with variogram
> parameters  
> 
> nugget - 0.04243
> psill - 0.96633
> Range - 16.88 Km
> 
> <http://r-sig-geo.2731867.n2.nabble.com/file/n7583465/climat_vario.png> 
> 
> I have couple of questions:
> 
> (1) Why is the psill not reaching 1, when the each day rain has been
> normalized?

total sill, i.e. psill + nugget are supposed to approach the variance of
the field; they seem to do so. I also believe that this only holds for
the ergodic case, where you would make your spatial domain infinite.

> (2) Why is there a dip in the variogram at 50Km?

I wouldn't see this as a structural property; consecutive sample
variogram estimates are dependent as they share the same observations
when forming pairs.

> 
> Your help will be highly appreciated.
> 
> Thanks & Regards
> Subash
> 
> 
> 
> 
> 
> 
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/sill-not-reaching-1-in-a-climatological-variogram-tp7583465.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From Roger.Bivand at nhh.no  Fri May  3 08:42:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 3 May 2013 08:42:41 +0200
Subject: [R-sig-Geo] Changes in spgrass6 0.8-1
Message-ID: <alpine.LRH.2.03.1305030837120.21490@reclus.nhh.no>

The new release of spgrass6, the package interfacing R and GRASS 6 and 7, 
includes changes in the way commands are handled. Users should continue to 
use their scripts unchanged, but internally on "unix" platforms (all but 
Windows), GRASS error messages are now trapped in R and will issue stop() 
or warning() calls, rather than simply being printed to console and not 
being "seen" by the R process. This involved substituting system2() for 
system() in the package code in a number of places. Please report directly 
to the maintainer if problems arise.

Thanks to Rainer Krug for ideas and help testing.

Roger

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From loic.dutrieux at wur.nl  Fri May  3 10:54:14 2013
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Fri, 3 May 2013 08:54:14 +0000
Subject: [R-sig-Geo] raster package. raster() function scales data when
	reading from HDF
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB70E221278@SCOMP0937.wurnet.nl>

Dear all,

I've noticed some unexpected behavior while loading HDF4 data with the raster() function. See the example below.

# In the terminal
mkdir ~/MODIS_test
cd ~/MODIS_test/
wget ftp://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf # 7MB

# R
library(raster)
library(MODIS)
sds = getSds('~/MODIS_test/MOD13A2.A2003065.h10v10.005.2008301134056.hdf')
a = raster(sds$SDS4gdal[1])
summary(a)

Returns the following results:
MOD13A2.A2003065.h10v10.005.2008301134056.hdf..MODIS_Grid_16DAY_1km_VI.1_km_16_days_NDVI
Min.                                                                                   -19580000
1st Qu.                                                                                 20930000
Median                                                                                  43820000
3rd Qu.                                                                                 63740000
Max.                                                                                    99650000
NA's                                                                                           0

Which is outside of the valid range by a factor of 10000.

My first guess is that it has to do with the version of GDAL intalled; this started after upgrading from gdal1.7.3. to gdal1.9.2.

Any idea?

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] MODIS_0.6-4   bitops_1.0-5  rgdal_0.8-6   raster_2.1-25 sp_1.0-8     

loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.20-15 tools_2.15.2   


Thanks in advance
Best regards,

--
Lo?c Dutrieux
Laboratory of Geo-Information Science and Remote Sensing
Wageningen University
The Netherlands


From abdoulayesar at gmail.com  Fri May  3 11:14:45 2013
From: abdoulayesar at gmail.com (Abdoulaye Sarr)
Date: Fri, 3 May 2013 09:14:45 +0000
Subject: [R-sig-Geo] wavelets
Message-ID: <CAN=6O0+ecDDT_a82RfNFM4PjUxbhMNE6jz5rgVAY2sV174a4ZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/89bb2f42/attachment.pl>

From abdoulayesar at gmail.com  Fri May  3 11:56:00 2013
From: abdoulayesar at gmail.com (Abdoulaye Sarr)
Date: Fri, 3 May 2013 09:56:00 +0000
Subject: [R-sig-Geo] wavelets
Message-ID: <CAN=6O0+vtarT6CQ_+8TjSiUAjMUR0GFg2AMMrtP8q7hh0iKM-w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/f295000a/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Fri May  3 12:01:55 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Fri, 3 May 2013 12:01:55 +0200
Subject: [R-sig-Geo] raster package. raster() function scales data when
 reading from HDF
In-Reply-To: <A83620D4CC4762448EFB789FD6E9BBB70E221278@SCOMP0937.wurnet.nl>
References: <A83620D4CC4762448EFB789FD6E9BBB70E221278@SCOMP0937.wurnet.nl>
Message-ID: <5183A7330200002700019BF5@gwia2.boku.ac.at>

Dear Loic,
I don't know why this happens, but I'm not so sure if it depends
directly on your GDAL installation. By running your code I get the same
results, but converting the file to geotiff (using internally a direct
call to gdal GDAL 1.9.2, released 2012/10/08) the values seam to be
correct (except NA that should be -3000 and not 0 but that's not a
raster package related problem!).
I hope this helps a little bit further...
Matteo


# downloading and converting
> library(MODIS)
>
runGdal(product="MOD13A2",begin="2003065",end="2003065",tileH=10,tileV=10,SDSstring=1,outDirPath="~/MODIS_test",job="test")


pixelSize        =  asIn 
resamplingType   =  near 
outProj          = +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs 
Output Directory = ~/MODIS_test/test 


Getting file from: LPDAAC 
############################
--2013-05-03 11:33:46-- 
http://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf
Resolving e4ftl01.cr.usgs.gov (e4ftl01.cr.usgs.gov)... 152.61.133.5,
2001:49c8:4000:121d::5
Connecting to e4ftl01.cr.usgs.gov
(e4ftl01.cr.usgs.gov)|152.61.133.5|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7314533 (7.0M) [application/x-hdf]
Saving to: `gdalinfo
/home/matteo/MODIS_test/test/MOD13A2.A2003065.1_km_16_days_NDVI.tif'


100%[===========================================================================================================================================================================>]
7,314,533   1.77M/s   in 5.3s    


2013-05-03 11:33:52 (1.31 MB/s) -
`/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf'
saved [7314533/7314533]


Downloaded by the first try!


Creating output file that is 1200P x 1200L.
Processing input file
HDF4_EOS:EOS_GRID:/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf:MODIS_Grid_16DAY_1km_VI:1
km 16 days NDVI.
Using internal nodata values (eg. -3000) for image
HDF4_EOS:EOS_GRID:/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf:MODIS_Grid_16DAY_1km_VI:1
km 16 days NDVI.
0...10...20...30...40...50...60...70...80...90...100 - done.


> a <-
raster('~/MODIS_test/test/MOD13A2.A2003065.1_km_16_days_NDVI.tif') 
> summary(a)
        MOD13A2.A2003065.1_km_16_days_NDVI
Min.                                 -1760
1st Qu.                                  0
Median                                   0
3rd Qu.                                865
Max.                                  9965
NA's                                     0




> sessionInfo()
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)


locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       


attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    



other attached packages:
[1] XML_3.96-1.1   RCurl_1.95-4.1 rgeos_0.2-16   rgdal_0.8-8   
MODIS_0.8-08  
[6] bitops_1.0-5   raster_2.1-25  sp_1.0-9      


loaded via a namespace (and not attached):
[1] grid_2.15.3     lattice_0.20-15 tools_2.15.3   




>>> "Dutrieux, Loic" <loic.dutrieux at wur.nl> 05/03/13 10:55 AM >>>
Dear all,

I've noticed some unexpected behavior while loading HDF4 data with the
raster() function. See the example below.

# In the terminal
mkdir ~/MODIS_test
cd ~/MODIS_test/
wget
ftp://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf
# 7MB

# R
library(raster)
library(MODIS)
sds =
getSds('~/MODIS_test/MOD13A2.A2003065.h10v10.005.2008301134056.hdf')
a = raster(sds$SDS4gdal[1])
summary(a)

Returns tMin.                                                                    
              -19580000
1st Qu.                                                                 
               20930000
Median                                                                  
               43820000
3rd Qu.                                                                 
               63740000
Max.                                                                    
               99650000
NA's                                                                    
                      0

Which is outside of the valid range by a factor of 10000.

My first guess is that it has to do with the version of GDAL intalled;
this started after upgrading from gdal1.7.3. to gdal1.9.2.

Any idea?

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C   
             LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    


other attached packages:
[1] MODIS_0.6-4   bitops_1.0-5  rgdal_0.8-6   raster_2.1-25 sp_1.0-8    


loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.20-15 tools_2.15.2   


Thanks in advance
Best regards,

--
Lo?c Dutrieux
Laboratory of Geo-Information Science and Remote Sensing
Wageningen University
The Netherlands

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Fri May  3 14:35:50 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 3 May 2013 14:35:50 +0200
Subject: [R-sig-Geo] colors (and other issues) in rasterVis()
Message-ID: <CAG4NRe+zGLyPC9Ae7W=zHQ7VO1JtHocTo+LVtU-5GjuaLLsx0Q@mail.gmail.com>

Hi!
I do not get to plot a set of 8 raster layers from a brick the way I
want with rasterVis()
I do:
require(rasterVis)
levelplot(adlsEMNFVIS[[1:8]],axes=FALSE,colorkey=FALSE,col.region=gray.colors(128,gamma=0.5))

I want to:
1. Do not plot the names of the layers or plot a different text. i.e.
paste("MNF-",1:8,sep="")
2. Do not plot the axes or at least the axes text (the numbers).
3. Use a grey scale.

I've gone through the man page and I think that I should use
par.settings=, but the help page
links to another page and that one to another... and finally get lost.

Any help appreciated!

Thanks


From swagathnavin82 at gmail.com  Fri May  3 14:41:59 2013
From: swagathnavin82 at gmail.com (Swagath Navin)
Date: Fri, 03 May 2013 14:41:59 +0200
Subject: [R-sig-Geo] TIF with 3 bands to data frame
Message-ID: <5183B097.3030506@gmail.com>

Hello all,

I am new to rgdal. I downloaded a tif file from 
'http://mrdata.usgs.gov/radiometric/data/NArad_U_geog83.tif' which i 
would like to convert into a regular data frame so that i can plot it 
using ggplot2.

when i tried to read the file using readGDAL i get a warning message

NArad_U_geog83.tif has GDAL driver GTiff
and has 2432 rows and 5868 columns
Warning message:
In readGDAL("NArad_U_geog83.tif") : GeoTransform values not available

What does it mean?

Here s the summary of the file:

Object of class SpatialGridDataFrame
Coordinates:
   min  max
x   0 5868
y   0 2432
Is projected: NA
proj4string : [NA]
Grid attributes:
   cellcentre.offset cellsize cells.dim
x               0.5        1      5868
y               0.5        1      2432
Data attributes:
      band1           band2           band3
  Min.   :  0.0   Min.   :  0.0   Min.   :  0
  1st Qu.:255.0   1st Qu.:255.0   1st Qu.:255
  Median :255.0   Median :255.0   Median :255
  Mean   :222.4   Mean   :231.1   Mean   :226
  3rd Qu.:255.0   3rd Qu.:255.0   3rd Qu.:255
  Max.   :255.0   Max.   :255.0   Max.   :255

Can anyone please tell me which packages i should look into for 
converting it into a data frame so that i can plot it using ggplot2.

Thanks,
Swagath


From loic.dutrieux at wur.nl  Fri May  3 15:19:45 2013
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Fri, 3 May 2013 13:19:45 +0000
Subject: [R-sig-Geo] raster package. raster() function scales data when
 reading from HDF
In-Reply-To: <5183A7330200002700019BF5@gwia2.boku.ac.at>
References: <A83620D4CC4762448EFB789FD6E9BBB70E221278@SCOMP0937.wurnet.nl>,
	<5183A7330200002700019BF5@gwia2.boku.ac.at>
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB70E2212D9@SCOMP0937.wurnet.nl>

Thanks Matteo,

I dug the problem a bit, and found out where it may come from. There is a as.is argument in the getRasterData function (rgdal) that if set to FALSE applies a scaling factor fetched from the metadata to the data. The argument default to FALSE. When set to TRUE, no scaling is applied.

# Get sds from data previously downloaded
sds = getSds('~/MODIS_test/MOD13A2.A2003065.h10v10.005.2008301134056.hdf')

# Read the data first using defaults
a = readGDAL(sds$SDS4gdal[1])
summary(a)

Data attributes:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's 
-19790000  20790000  43840000  43680000  63740000  99860000   1043545 

# With as.is=TRUE
a = readGDAL(sds$SDS4gdal[1], as.is=TRUE)
summary(a)

Data attributes:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  -1979    2079    4384    4368    6374    9986 1043545 

I'm not convinced that automatically scaling data is such a good default setting. 
Unfortunately the raster() function does not seem to take the as.is argument and therefore uses the default settings of getRasterData(). Any way we could get more control of that?

Cheers,
Lo?c


________________________________________
From: Matteo Mattiuzzi [matteo.mattiuzzi at boku.ac.at]
Sent: Friday, May 03, 2013 12:01 PM
To: R-sig-Geo at stat.math.ethz.ch; Dutrieux, Loic
Subject: Re: [R-sig-Geo] raster package. raster() function scales data when reading from HDF

Dear Loic,
I don't know why this happens, but I'm not so sure if it depends
directly on your GDAL installation. By running your code I get the same
results, but converting the file to geotiff (using internally a direct
call to gdal GDAL 1.9.2, released 2012/10/08) the values seam to be
correct (except NA that should be -3000 and not 0 but that's not a
raster package related problem!).
I hope this helps a little bit further...
Matteo


# downloading and converting
> library(MODIS)
>
runGdal(product="MOD13A2",begin="2003065",end="2003065",tileH=10,tileV=10,SDSstring=1,outDirPath="~/MODIS_test",job="test")


pixelSize        =  asIn
resamplingType   =  near
outProj          = +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs
Output Directory = ~/MODIS_test/test


Getting file from: LPDAAC
############################
--2013-05-03 11:33:46--
http://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf
Resolving e4ftl01.cr.usgs.gov (e4ftl01.cr.usgs.gov)... 152.61.133.5,
2001:49c8:4000:121d::5
Connecting to e4ftl01.cr.usgs.gov
(e4ftl01.cr.usgs.gov)|152.61.133.5|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7314533 (7.0M) [application/x-hdf]
Saving to: `gdalinfo
/home/matteo/MODIS_test/test/MOD13A2.A2003065.1_km_16_days_NDVI.tif'


100%[===========================================================================================================================================================================>]
7,314,533   1.77M/s   in 5.3s


2013-05-03 11:33:52 (1.31 MB/s) -
`/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf'
saved [7314533/7314533]


Downloaded by the first try!


Creating output file that is 1200P x 1200L.
Processing input file
HDF4_EOS:EOS_GRID:/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf:MODIS_Grid_16DAY_1km_VI:1
km 16 days NDVI.
Using internal nodata values (eg. -3000) for image
HDF4_EOS:EOS_GRID:/home/matteo/MODIS_ARC/MODIS/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf:MODIS_Grid_16DAY_1km_VI:1
km 16 days NDVI.
0...10...20...30...40...50...60...70...80...90...100 - done.


> a <-
raster('~/MODIS_test/test/MOD13A2.A2003065.1_km_16_days_NDVI.tif')
> summary(a)
        MOD13A2.A2003065.1_km_16_days_NDVI
Min.                                 -1760
1st Qu.                                  0
Median                                   0
3rd Qu.                                865
Max.                                  9965
NA's                                     0




> sessionInfo()
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)


locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=C                 LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C


attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base



other attached packages:
[1] XML_3.96-1.1   RCurl_1.95-4.1 rgeos_0.2-16   rgdal_0.8-8
MODIS_0.8-08
[6] bitops_1.0-5   raster_2.1-25  sp_1.0-9


loaded via a namespace (and not attached):
[1] grid_2.15.3     lattice_0.20-15 tools_2.15.3




>>> "Dutrieux, Loic" <loic.dutrieux at wur.nl> 05/03/13 10:55 AM >>>
Dear all,

I've noticed some unexpected behavior while loading HDF4 data with the
raster() function. See the example below.

# In the terminal
mkdir ~/MODIS_test
cd ~/MODIS_test/
wget
ftp://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2003.03.06/MOD13A2.A2003065.h10v10.005.2008301134056.hdf
# 7MB

# R
library(raster)
library(MODIS)
sds =
getSds('~/MODIS_test/MOD13A2.A2003065.h10v10.005.2008301134056.hdf')
a = raster(sds$SDS4gdal[1])
summary(a)

Returns tMin.
              -19580000
1st Qu.
               20930000
Median
               43820000
3rd Qu.
               63740000
Max.
               99650000
NA's
                      0

Which is outside of the valid range by a factor of 10000.

My first guess is that it has to do with the version of GDAL intalled;
this started after upgrading from gdal1.7.3. to gdal1.9.2.

Any idea?

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C
             LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


other attached packages:
[1] MODIS_0.6-4   bitops_1.0-5  rgdal_0.8-6   raster_2.1-25 sp_1.0-8


loaded via a namespace (and not attached):
[1] grid_2.15.2     lattice_0.20-15 tools_2.15.2


Thanks in advance
Best regards,

--
Lo?c Dutrieux
Laboratory of Geo-Information Science and Remote Sensing
Wageningen University
The Netherlands

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo





From oscar.perpinan at gmail.com  Fri May  3 15:59:44 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Fri, 03 May 2013 15:59:44 +0200
Subject: [R-sig-Geo] colors (and other issues) in rasterVis()
In-Reply-To: <CAG4NRe+zGLyPC9Ae7W=zHQ7VO1JtHocTo+LVtU-5GjuaLLsx0Q@mail.gmail.com>
References: <CAG4NRe+zGLyPC9Ae7W=zHQ7VO1JtHocTo+LVtU-5GjuaLLsx0Q@mail.gmail.com>
Message-ID: <87r4hob1v3.fsf@gmail.com>

Hello,

1.- Use names.attr to define the labels of each panel if they are
different from the layers names.

2.- The axes can be customized with scales. To suppress them completely
use scales=list(draw=FALSE).

3.- The colors are defined with col.regions (you were using col.region)
or par.settings. There are some examples with par.settings and
predefined themes here: http://rastervis.r-forge.r-project.org/#themes.
I will improve the documentation to clarify this point.

This code should work for your three requirements:

r <- raster(nrow=10, ncol=10)
r[] <- runif(100)
s <- stack(lapply(1:8, function(i)r))

levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
          col.regions=gray.colors(128,gamma=0.5),
          names.attr=paste0('MNF-', 1:8))

myTheme <- rasterTheme(region=gray.colors(128,gamma=0.5))
levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
          par.settings=myTheme,
          names.attr=paste0('MNF-', 1:8))

levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
          par.settings=GrTheme(),
          names.attr=paste0('MNF-', 1:8))

Best,

Oscar.
Agustin Lobo <alobolistas at gmail.com> writes:

> Hi!
> I do not get to plot a set of 8 raster layers from a brick the way I
> want with rasterVis()
> I do:
> require(rasterVis)
> levelplot(adlsEMNFVIS[[1:8]],axes=FALSE,colorkey=FALSE,col.region=gray.colors(128,gamma=0.5))
>
> I want to:
> 1. Do not plot the names of the layers or plot a different text. i.e.
> paste("MNF-",1:8,sep="")
> 2. Do not plot the axes or at least the axes text (the numbers).
> 3. Use a grey scale.
>
> I've gone through the man page and I think that I should use
> par.settings=, but the help page
> links to another page and that one to another... and finally get lost.
>
> Any help appreciated!
>
> Thanks
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From pyang at ccny.cuny.edu  Fri May  3 16:50:00 2013
From: pyang at ccny.cuny.edu (Ping Yang)
Date: Fri, 3 May 2013 10:50:00 -0400
Subject: [R-sig-Geo] Spatial Variability Analyses on gridded climate data
Message-ID: <CAK8gSG9bbRTpzKhJNEpUGEEdNwzd6kXhzh8PHXrhe41xvCv-7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/ab6b7e0c/attachment.pl>

From subbu_843 at yahoo.co.in  Fri May  3 17:38:33 2013
From: subbu_843 at yahoo.co.in (subash)
Date: Fri, 3 May 2013 08:38:33 -0700 (PDT)
Subject: [R-sig-Geo] sill not reaching 1 in a climatological variogram
In-Reply-To: <51835613.6050604@uni-muenster.de>
References: <1367512216726-7583465.post@n2.nabble.com>
	<51835613.6050604@uni-muenster.de>
Message-ID: <1367595513312-7583478.post@n2.nabble.com>

Thanks Edzer  for the prompt reply.

Can you please elaborate on the answer two my 2 question. I could understand
"consecutive sample variogram estimates are dependent as they share the same
observations when forming pairs." I am aware that the same observation are
used when forming pairs but how that would lead to the dip in the variogram.


Regards,
Subash



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/sill-not-reaching-1-in-a-climatological-variogram-tp7583465p7583478.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From virgilio.gomez at uclm.es  Fri May  3 18:58:54 2013
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Fri, 03 May 2013 18:58:54 +0200
Subject: [R-sig-Geo] ZIP for spatial data in R
In-Reply-To: <1367427495.77189.YahooMailNeo@web162101.mail.bf1.yahoo.com>
References: <1367427495.77189.YahooMailNeo@web162101.mail.bf1.yahoo.com>
Message-ID: <1367600334.2944.82.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Dear Milan,

You may want to check DClusterm for this:

https://r-forge.r-project.org/projects/dclusterm/

There is a vignette where ZIP models are used for disease mapping. Check
also the references therein.

You can fit ZIP models with R-INLA (http://www.r-inla.org) as well. This
is probably the easiest way with R right now.

Best wishes,

Virgilio


From vitale232 at gmail.com  Fri May  3 19:28:13 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 3 May 2013 10:28:13 -0700
Subject: [R-sig-Geo] Mapping cells from dataframe constructed in raster
In-Reply-To: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
References: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
Message-ID: <CAFTcopcHjhxA9cw9tv9i=hvLdt10FYsn8g4=V9Pvajr6nZHUQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/773dac2d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri May  3 20:04:51 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 03 May 2013 20:04:51 +0200
Subject: [R-sig-Geo] sill not reaching 1 in a climatological variogram
In-Reply-To: <1367595513312-7583478.post@n2.nabble.com>
References: <1367512216726-7583465.post@n2.nabble.com>
	<51835613.6050604@uni-muenster.de>
	<1367595513312-7583478.post@n2.nabble.com>
Message-ID: <5183FC43.9030505@uni-muenster.de>

Subash,

We would only expect the sample variogram to be on the variogram model
line when (a) we had an infinite number of observations, taken over (b)
an infinitely large domain.

As we don't have this in practice, sample variogram points vary around
the theoretical line. As these sample variogram points are correlated,
their fluctuation often does not look like random fluctuation -- you
described this as "a dip [...] at 50 km" in your original mail.

On 05/03/2013 05:38 PM, subash wrote:
> Thanks Edzer  for the prompt reply.
> 
> Can you please elaborate on the answer two my 2 question. I could understand
> "consecutive sample variogram estimates are dependent as they share the same
> observations when forming pairs." I am aware that the same observation are
> used when forming pairs but how that would lead to the dip in the variogram.
> 
> 
> Regards,
> Subash
> 
> 
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/sill-not-reaching-1-in-a-climatological-variogram-tp7583465p7583478.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From alobolistas at gmail.com  Fri May  3 20:09:18 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 3 May 2013 20:09:18 +0200
Subject: [R-sig-Geo] colors (and other issues) in rasterVis()
In-Reply-To: <87r4hob1v3.fsf@gmail.com>
References: <CAG4NRe+zGLyPC9Ae7W=zHQ7VO1JtHocTo+LVtU-5GjuaLLsx0Q@mail.gmail.com>
	<87r4hob1v3.fsf@gmail.com>
Message-ID: <CAG4NRe+UwF9Z2kmmLUq69xQ9vskyro+PMauJN+qZgNWaxMER0A@mail.gmail.com>

Thanks Oscar, almost there.
But cannot find the way of customizing the distribution of the grid,
i.e., a 4 rows x 2 cols plot.
A (minor) problem in the man page is that the links to i.e. levelplot
are circular, they point to
rasterVis::levelplot and I understand they should point to
lattice::levelplot. A major problem
is that once in the appropriate page I still cannot find what I'm looking for.
Expanding the doc in the rasterVis page for levelplot would be great,
but I understand this is
not easy (and not fun). Perhaps adding this case to the current
examples in the page could be a working solution.

Agus

On Fri, May 3, 2013 at 3:59 PM, Oscar Perpi??n Lamigueiro
<oscar.perpinan at gmail.com> wrote:
> Hello,
>
> 1.- Use names.attr to define the labels of each panel if they are
> different from the layers names.
>
> 2.- The axes can be customized with scales. To suppress them completely
> use scales=list(draw=FALSE).
>
> 3.- The colors are defined with col.regions (you were using col.region)
> or par.settings. There are some examples with par.settings and
> predefined themes here: http://rastervis.r-forge.r-project.org/#themes.
> I will improve the documentation to clarify this point.
>
> This code should work for your three requirements:
>
> r <- raster(nrow=10, ncol=10)
> r[] <- runif(100)
> s <- stack(lapply(1:8, function(i)r))
>
> levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
>           col.regions=gray.colors(128,gamma=0.5),
>           names.attr=paste0('MNF-', 1:8))
>
> myTheme <- rasterTheme(region=gray.colors(128,gamma=0.5))
> levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
>           par.settings=myTheme,
>           names.attr=paste0('MNF-', 1:8))
>
> levelplot(s, scales=list(draw=FALSE), colorkey=FALSE,
>           par.settings=GrTheme(),
>           names.attr=paste0('MNF-', 1:8))
>
> Best,
>
> Oscar.
> Agustin Lobo <alobolistas at gmail.com> writes:
>
>> Hi!
>> I do not get to plot a set of 8 raster layers from a brick the way I
>> want with rasterVis()
>> I do:
>> require(rasterVis)
>> levelplot(adlsEMNFVIS[[1:8]],axes=FALSE,colorkey=FALSE,col.region=gray.colors(128,gamma=0.5))
>>
>> I want to:
>> 1. Do not plot the names of the layers or plot a different text. i.e.
>> paste("MNF-",1:8,sep="")
>> 2. Do not plot the axes or at least the axes text (the numbers).
>> 3. Use a grey scale.
>>
>> I've gone through the man page and I think that I should use
>> par.settings=, but the help page
>> links to another page and that one to another... and finally get lost.
>>
>> Any help appreciated!
>>
>> Thanks
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> --
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From janice.jlsh at gmail.com  Fri May  3 21:54:56 2013
From: janice.jlsh at gmail.com (Janice Lee)
Date: Fri, 3 May 2013 21:54:56 +0200
Subject: [R-sig-Geo] Mapping cells from dataframe constructed in raster
In-Reply-To: <CAFTcopcHjhxA9cw9tv9i=hvLdt10FYsn8g4=V9Pvajr6nZHUQA@mail.gmail.com>
References: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
	<CAFTcopcHjhxA9cw9tv9i=hvLdt10FYsn8g4=V9Pvajr6nZHUQA@mail.gmail.com>
Message-ID: <CACCqpPW=qn7iSZCZnjaAUoqfq94SwUqpGDj3y6yh1a+_v+gOXA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/4ca28a32/attachment.pl>

From r.hijmans at gmail.com  Fri May  3 22:25:26 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 3 May 2013 13:25:26 -0700
Subject: [R-sig-Geo] Mapping cells from dataframe constructed in raster
In-Reply-To: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
References: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
Message-ID: <CANtt_hz++OiYgSqhkbPFNFGf2t0f5RW_9AEqnCTSyNvDN12vJQ@mail.gmail.com>

Hi Janice,

That works but seems much more complicated than need be. I think you
should read the vignette that comes with the raster package:
http://cran.r-project.org/web/packages/raster/vignettes/Raster.pdf

Here is a simpler approach

library(raster)
s <- stack(system.file("external/rlogo.grd", package="raster"))
# create a matrix
m <- as.matrix(s)

# add a column with the cell numbers
m <- cbind(cell=1:ncell(s), m)

# it seems that in your case this is not needed because you used
# write.csv (which adds the cellsnumbers (rows in matrix) and then
read.csv to accomplish
# the same

# for this example, I take a random sample of 100 cells
set.seed(0)
x <- sample(m[,1], 100)

# create a RasterLayer template from the RasterStack
r <- raster(s)

# assign values to cells 'x'
r[x] <- 1:length(x)
plot(r)


Next time you ask a question provide a self-contained example like
Andrew's or  this one, which makes it much easier to answer.

Robert


On Thu, May 2, 2013 at 9:20 AM, Janice Lee <janice.jlsh at gmail.com> wrote:
> Dear all,
>
> I would appreciate anyone's help on this.
> I constructed a dataframe from several raster layers and compiled these
> layers using the 'stack' and 'brick' function in 'raster' package
>
> s <- stack(r1,r2,r3,r4,r5)
> b <- brick(s)
>
> I converted this into a matrix and stored this as a dataframe:
>
> mb <- as.matrix(b)
> write.csv(mb,"C:/Source/mb.csv")
>
> This new dataframe (mb) lists all the cells as rows and all the attributes
> in my raster layers (r1-r5) as columns
> The first column in mb also provides a number to each cell which I assume
> acts as a form of identification number to every grid cell
> I used mb in an R-coded model which simulates land cover change, in which I
> selected the most suitable cells for land use conversion
> My final dataframe (df) has a lower number of rows compared to mb but has
> preserved the identification number of each grid cell.
>
> My question is: Can I map out the cells in df by tracing its identification
> number back to the original dataframe mb?
> I have been trying to figure this out and will appreciate any suggestions.
>
> Many thanks and best regards,
> Janice Lee
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From janice.jlsh at gmail.com  Fri May  3 23:07:13 2013
From: janice.jlsh at gmail.com (Janice Lee)
Date: Fri, 3 May 2013 23:07:13 +0200
Subject: [R-sig-Geo] Mapping cells from dataframe constructed in raster
In-Reply-To: <CANtt_hz++OiYgSqhkbPFNFGf2t0f5RW_9AEqnCTSyNvDN12vJQ@mail.gmail.com>
References: <CACCqpPUE-7FsheaQgwz+Eyjr=+YFBoSunzKLzcfS53L9dyA6LQ@mail.gmail.com>
	<CANtt_hz++OiYgSqhkbPFNFGf2t0f5RW_9AEqnCTSyNvDN12vJQ@mail.gmail.com>
Message-ID: <CACCqpPVWqzarwgNEZWuimbR4h9p=Lo-TCsMmwtb+NgN8JfrStw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130503/7af01ae8/attachment.pl>

From oscar.perpinan at gmail.com  Sat May  4 16:42:58 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sat, 4 May 2013 16:42:58 +0200
Subject: [R-sig-Geo] colors (and other issues) in rasterVis()
In-Reply-To: <CAG4NRe+UwF9Z2kmmLUq69xQ9vskyro+PMauJN+qZgNWaxMER0A@mail.gmail.com>
References: <CAG4NRe+zGLyPC9Ae7W=zHQ7VO1JtHocTo+LVtU-5GjuaLLsx0Q@mail.gmail.com>
	<87r4hob1v3.fsf@gmail.com>
	<CAG4NRe+UwF9Z2kmmLUq69xQ9vskyro+PMauJN+qZgNWaxMER0A@mail.gmail.com>
Message-ID: <CAMLL7bk9ZM3EtGFOxSrEDZkbCBh_u+Qtck9XEzS4a3jx2c9hHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130504/76ad7c1a/attachment.pl>

From thi_veloso at yahoo.com.br  Sat May  4 23:15:58 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Sat, 4 May 2013 14:15:58 -0700 (PDT)
Subject: [R-sig-Geo] rasterVis - Plot subset of data
Message-ID: <1367702158.12611.YahooMailNeo@web121903.mail.ne1.yahoo.com>

Hello everyone,

Is there any way to plot a geographical subset of a raster using the plot techniques of rasterVis??Here's an example of the rasterVis manual:

## Categorical data
require(raster)
require(rasterVis)
r <- raster(nrow=10, ncol=10)
r[] = 1
r[51:100] = 3
r[3:6, 1:5] = 5
r <- ratify(r)
rat <- levels(r)[[1]]
rat$landcover <- c('Pine', 'Oak', 'Meadow')
levels(r) <- rat
levelplot(r, col.regions=c('palegreen', 'midnightblue', 'indianred1'))


How could I plot only, say, latitude -50 to 50 and longitude -100 to 100?

Thanks in advance,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898?


From oscar.perpinan at gmail.com  Sun May  5 08:11:21 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sun, 5 May 2013 08:11:21 +0200
Subject: [R-sig-Geo] rasterVis - Plot subset of data
In-Reply-To: <1367702158.12611.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <1367702158.12611.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <CAMLL7b=tBNHL0jj_hK9huAEhe2WvZT+7_rC1mbUwXR=-Rbd8YA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/c3ec91df/attachment.pl>

From potts.a at gmail.com  Sun May  5 13:58:12 2013
From: potts.a at gmail.com (Alastair Potts)
Date: Sun, 5 May 2013 13:58:12 +0200
Subject: [R-sig-Geo] Determining the shared boundaries between
	polygons/polyshapes
Message-ID: <CAG_8N1Y47zX_KUUQtii-KN3p7pV+TDQRAaK-d8qboPbsfnbE0w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/ed61619d/attachment.pl>

From mspinola10 at gmail.com  Sun May  5 16:38:21 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 5 May 2013 08:38:21 -0600
Subject: [R-sig-Geo] raster and rsterVis availability for R 3.0.0
Message-ID: <CABkCotRmJVqLu8TbU1Njz0FQc-Y_1+M7290typNfU2K3TfFc5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/30b428d1/attachment.pl>

From oscar.perpinan at gmail.com  Sun May  5 17:52:23 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sun, 5 May 2013 17:52:23 +0200
Subject: [R-sig-Geo] raster and rsterVis availability for R 3.0.0
In-Reply-To: <CABkCotRmJVqLu8TbU1Njz0FQc-Y_1+M7290typNfU2K3TfFc5w@mail.gmail.com>
References: <CABkCotRmJVqLu8TbU1Njz0FQc-Y_1+M7290typNfU2K3TfFc5w@mail.gmail.com>
Message-ID: <CAMLL7bkVOL-Cwev_wVQFS+oCzckzv+_3n3k=N3_d7SAAqLBfqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/6bd2d8f4/attachment.pl>

From mspinola10 at gmail.com  Sun May  5 18:13:20 2013
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 5 May 2013 10:13:20 -0600
Subject: [R-sig-Geo] raster and rsterVis availability for R 3.0.0
In-Reply-To: <CAMLL7bkVOL-Cwev_wVQFS+oCzckzv+_3n3k=N3_d7SAAqLBfqA@mail.gmail.com>
References: <CABkCotRmJVqLu8TbU1Njz0FQc-Y_1+M7290typNfU2K3TfFc5w@mail.gmail.com>
	<CAMLL7bkVOL-Cwev_wVQFS+oCzckzv+_3n3k=N3_d7SAAqLBfqA@mail.gmail.com>
Message-ID: <CABkCotQjNgNxaY8+D920KXEC1hiiB=1ixorL8HwCOo_sEQbehQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/72a410a5/attachment.pl>

From abdoulayesar at gmail.com  Sun May  5 21:13:36 2013
From: abdoulayesar at gmail.com (Abdoulaye Sarr)
Date: Sun, 5 May 2013 19:13:36 +0000
Subject: [R-sig-Geo] trend package
Message-ID: <CAN=6O0J26t59ibQPhvVoChpbrZ1+dmk1B=eSFcCqiS5a6bEe6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130505/75220893/attachment.pl>

From abdoulayesar at gmail.com  Sun May  5 21:19:21 2013
From: abdoulayesar at gmail.com (Abdoulaye SARR)
Date: Sun, 5 May 2013 19:19:21 +0000
Subject: [R-sig-Geo] trend of time series
Message-ID: <69C14029-E90B-4F16-BD31-0B91208A7080@gmail.com>

Dear list,

I want to compute and plot the trend (like decadal trend of annual precipitin) and wondering if it is possible to do it in R.


Thanks

From mathieu.rajerison at gmail.com  Mon May  6 15:45:54 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 6 May 2013 15:45:54 +0200
Subject: [R-sig-Geo] Determining the shared boundaries between
	polygons/polyshapes
In-Reply-To: <CAG_8N1Y47zX_KUUQtii-KN3p7pV+TDQRAaK-d8qboPbsfnbE0w@mail.gmail.com>
References: <CAG_8N1Y47zX_KUUQtii-KN3p7pV+TDQRAaK-d8qboPbsfnbE0w@mail.gmail.com>
Message-ID: <CAGfc75mvam=MOvbnzK_MMG-rAdnJgc=mN5CMuBuEnMiZTmjiog@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/228b2450/attachment.pl>

From Andy.Bunn at wwu.edu  Mon May  6 18:33:20 2013
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 6 May 2013 16:33:20 +0000
Subject: [R-sig-Geo] Very basic map making plea
Message-ID: <CDAD2964.890F%andy.bunn@wwu.edu>

Hello geo folk.

It has been a long time since I last looked into making a pretty map with
R. And since I last tried map making in R it looks like there has been a
proliferation of packages for mapping.Wow. Folks have been very busy. It's
amazing but I confess to being a bit lost. Can somebody advise me on how
to do the following:

1. Make a map of the political boundary of Russia in an Albers equal-area
conic projection. Color it light grey.
2. Color the oceans and large water bodies light blue
3. Add a graticule around all four edges of the map giving lat/long labels
every 20 degrees
4. Add a grid giving lat/long labels every 20 degrees
5. Add some points from SpatialPointsDataFrame

If somebody can advise which is the best package to get going on and a
sketch of that I can get learning again!

Many thanks, Andy


From paul.feichtinger at tum.de  Mon May  6 19:58:26 2013
From: paul.feichtinger at tum.de (Feichtinger, Paul)
Date: Mon, 6 May 2013 17:58:26 +0000
Subject: [R-sig-Geo] Endogenous explanatory variables in sphet
Message-ID: <CCD7DE7E72D4B341896DB1CE20AEB805373F0BAF@BADWLRZ-SWMBX11.ads.mwn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/7a583d52/attachment.pl>

From tea3rd at gmail.com  Mon May  6 20:01:02 2013
From: tea3rd at gmail.com (Thomas Adams)
Date: Mon, 6 May 2013 14:01:02 -0400
Subject: [R-sig-Geo] Very basic map making plea
In-Reply-To: <CDAD2964.890F%andy.bunn@wwu.edu>
References: <CDAD2964.890F%andy.bunn@wwu.edu>
Message-ID: <CAGxgkWg2KXM6y09EkqJek_jJXT0JUg_RGucNSJYAyVXLTG6BLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/7a754572/attachment.pl>

From Roger.Bivand at nhh.no  Mon May  6 20:14:20 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 6 May 2013 20:14:20 +0200
Subject: [R-sig-Geo] Endogenous explanatory variables in sphet
In-Reply-To: <CCD7DE7E72D4B341896DB1CE20AEB805373F0BAF@BADWLRZ-SWMBX11.ads.mwn.de>
References: <CCD7DE7E72D4B341896DB1CE20AEB805373F0BAF@BADWLRZ-SWMBX11.ads.mwn.de>
Message-ID: <alpine.LRH.2.03.1305062004380.17931@reclus.nhh.no>

On Mon, 6 May 2013, Feichtinger, Paul wrote:

> Dear list members,
>
> I was wondering if someone could help me out. Estimating a general 
> spatial model (gstslshet) our model is likely to suffer from endogeneity 
> not only introduced by the spatial lag but also from other explanatory 
> variables. Is there any possibility to explicitly account for this 
> endogeneity (by using specific instruments)? Is it covered/dealt with in 
> some kind? Obviously I do not understand equation 4 in Piras (2010). I

I suggest that you install the development version of sphet from R-forge:

install.packages("sphet", repos="http://R-Forge.R-project.org")

and look for spreg(), which is a wrapper function for the model-fitting 
functions. You should look for the endog= and instruments= arguments, 
where:

spreg(formula = CRIME ~ HOVAL, data = columbus, listw = listw,
     endog = "INC", instruments = "DISCBD")

is an example of usage.

Hope this helps,

Roger

> read Anselin, Amaral and Arribas-Bel (2012) where they compare different 
> GMM implementations among others also with an endogenous explanatory 
> variable, but cannot reproduce the results in R sphet (problem is knitr, 
> sweave,... I never use that), which is the only spatial econometrics 
> software I use as I am a beginner. I would be really glad I someone 
> could explain me this issue.
>
> Best regards,
>
> Paul
> ---
> Technische Universit?t M?nchen - TUM
> Paul Feichtinger
> Lehrstuhl f?r Volkswirtschaftslehre, Umwelt?konomie und Agrarpolitik
>
> Alte Akademie 14
> 85354 Freising
> Tel: +49.8161.71.3574
> Fax: +49.8161.71.3408
> e-mail: Paul.Feichtinger at tum.de
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From juantomas.sayago at gmail.com  Mon May  6 20:26:30 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Mon, 6 May 2013 14:26:30 -0400
Subject: [R-sig-Geo] Endogenous explanatory variables in sphet
In-Reply-To: <alpine.LRH.2.03.1305062004380.17931@reclus.nhh.no>
References: <CCD7DE7E72D4B341896DB1CE20AEB805373F0BAF@BADWLRZ-SWMBX11.ads.mwn.de>
	<alpine.LRH.2.03.1305062004380.17931@reclus.nhh.no>
Message-ID: <CAEOXpNB2ft2bjQT=OUSCTX=0GK3n0xCO+U2nH_TCE2pxasWvRQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/364295cd/attachment.pl>

From landis at isciences.com  Mon May  6 20:44:38 2013
From: landis at isciences.com (Matt Landis)
Date: Mon, 6 May 2013 14:44:38 -0400
Subject: [R-sig-Geo] Very basic map making plea
In-Reply-To: <CDAD2964.890F%andy.bunn@wwu.edu>
References: <CDAD2964.890F%andy.bunn@wwu.edu>
Message-ID: <CAE-RneJH8T=OfeszW5wFxo+zwdfQyBhXZqdWkicZvrmEyxrK+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/fad2cc6f/attachment.pl>

From etiennebr at gmail.com  Mon May  6 20:54:04 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 6 May 2013 14:54:04 -0400
Subject: [R-sig-Geo] TIF with 3 bands to data frame
In-Reply-To: <5183B097.3030506@gmail.com>
References: <5183B097.3030506@gmail.com>
Message-ID: <CALjAYt5oZwEoFhOQedxnnuX+PHKcCF9u5H6dL02uWFpFAHBpvA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/0c9bfb82/attachment.pl>

From macqueen1 at llnl.gov  Mon May  6 21:11:14 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 6 May 2013 19:11:14 +0000
Subject: [R-sig-Geo] TIF with 3 bands to data frame
In-Reply-To: <5183B097.3030506@gmail.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>

I don't really know, exactly, but I'm going to guess.

The warning message refers to missing "GeoTransform" values. I find that
suggestive of information about the coordinate system. The website also
has a link to download a "TFW", which I believe contains coordinate system
information. This is supported by the absence of proj4string info in your
summary info. Try downloading the TFW file, putting it in the same
directory as the tif, and then try reading again with rgdal.

Instead, you might consider reading the file using the raster package;
conversion to a suitable data frame might be simpler from that point.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 5/3/13 5:41 AM, "Swagath Navin" <swagathnavin82 at gmail.com> wrote:

>Hello all,
>
>I am new to rgdal. I downloaded a tif file from
>'http://mrdata.usgs.gov/radiometric/data/NArad_U_geog83.tif' which i
>would like to convert into a regular data frame so that i can plot it
>using ggplot2.
>
>when i tried to read the file using readGDAL i get a warning message
>
>NArad_U_geog83.tif has GDAL driver GTiff
>and has 2432 rows and 5868 columns
>Warning message:
>In readGDAL("NArad_U_geog83.tif") : GeoTransform values not available
>
>What does it mean?
>
>Here s the summary of the file:
>
>Object of class SpatialGridDataFrame
>Coordinates:
>   min  max
>x   0 5868
>y   0 2432
>Is projected: NA
>proj4string : [NA]
>Grid attributes:
>   cellcentre.offset cellsize cells.dim
>x               0.5        1      5868
>y               0.5        1      2432
>Data attributes:
>      band1           band2           band3
>  Min.   :  0.0   Min.   :  0.0   Min.   :  0
>  1st Qu.:255.0   1st Qu.:255.0   1st Qu.:255
>  Median :255.0   Median :255.0   Median :255
>  Mean   :222.4   Mean   :231.1   Mean   :226
>  3rd Qu.:255.0   3rd Qu.:255.0   3rd Qu.:255
>  Max.   :255.0   Max.   :255.0   Max.   :255
>
>Can anyone please tell me which packages i should look into for
>converting it into a data frame so that i can plot it using ggplot2.
>
>Thanks,
>Swagath
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vitale232 at gmail.com  Mon May  6 21:27:13 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Mon, 6 May 2013 12:27:13 -0700
Subject: [R-sig-Geo] TIF with 3 bands to data frame
In-Reply-To: <5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>
References: <5183B097.3030506@gmail.com>
	<5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>
Message-ID: <CAFTcopeEaUOU=atCQ81FOHSLZV-NGF6YzDK06NTX6gSccXC5GA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130506/6a3ef78d/attachment.pl>

From Roger.Bivand at nhh.no  Mon May  6 22:06:59 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 6 May 2013 22:06:59 +0200
Subject: [R-sig-Geo] TIF with 3 bands to data frame
In-Reply-To: <5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>
References: <5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>
Message-ID: <alpine.LRH.2.03.1305062202040.17931@reclus.nhh.no>

On Mon, 6 May 2013, MacQueen, Don wrote:

> I don't really know, exactly, but I'm going to guess.

The message says that:

In readGDAL("NArad_U_geog83.tif") : GeoTransform values not available

which is confirmed by running:

$ file NArad_U_geog83.tif
NArad_U_geog83.tif: TIFF image data, little-endian
$ gdalinfo NArad_U_geog83.tif
Driver: GTiff/GeoTIFF
Files: NArad_U_geog83.tif
Size is 5868, 2432
Coordinate System is `'
Metadata:
   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
   TIFFTAG_XRESOLUTION=671
   TIFFTAG_YRESOLUTION=671
Image Structure Metadata:
   INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 2432.0)
Upper Right ( 5868.0,    0.0)
Lower Right ( 5868.0, 2432.0)
Center      ( 2934.0, 1216.0)
Band 1 Block=5868x16 Type=Byte, ColorInterp=Red
Band 2 Block=5868x16 Type=Byte, ColorInterp=Green
Band 3 Block=5868x16 Type=Byte, ColorInterp=Blue

so the file is just a Tiff image, not a GTiff file. It has no information 
on its placing in space or dimensions. The table at:

http://mrdata.usgs.gov/radiometric/

actually says that it is a Tiff file, matched by Geosoft Grid files, 
discussed in a thread resolved by Barry Rowlingson:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/018157.html

apparently by the same person who is puzzled now. The resolution is 
probably the same, so I'm not sure why the question is being repeated.

Roger


>
> The warning message refers to missing "GeoTransform" values. I find that
> suggestive of information about the coordinate system. The website also
> has a link to download a "TFW", which I believe contains coordinate system
> information. This is supported by the absence of proj4string info in your
> summary info. Try downloading the TFW file, putting it in the same
> directory as the tif, and then try reading again with rgdal.
>
> Instead, you might consider reading the file using the raster package;
> conversion to a suitable data frame might be simpler from that point.
>
> -Don
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From swagathnavin82 at gmail.com  Mon May  6 22:18:41 2013
From: swagathnavin82 at gmail.com (Swagath)
Date: Mon, 06 May 2013 22:18:41 +0200
Subject: [R-sig-Geo] TIF with 3 bands to data frame
In-Reply-To: <alpine.LRH.2.03.1305062202040.17931@reclus.nhh.no>
References: <5E1B812FAC2C4A49B3D99593B5A521913FCA08@PRDEXMBX-08.the-lab.llnl.gov>
	<alpine.LRH.2.03.1305062202040.17931@reclus.nhh.no>
Message-ID: <51881021.3060209@gmail.com>

Hi Roger,

Thanks for your reply. You are correct, its more similar to my previous 
post. Thanks to help from Barry, i was able to convert the '.grd' file. 
Since there is also a tif file available, i was trying to skip the part 
of downloading the software and use R directly to convert into a data 
frame.

Thanks,
Swagath

On 5/6/13 10:06 PM, Roger Bivand wrote:
> On Mon, 6 May 2013, MacQueen, Don wrote:
>
>> I don't really know, exactly, but I'm going to guess.
>
> The message says that:
>
> In readGDAL("NArad_U_geog83.tif") : GeoTransform values not available
>
> which is confirmed by running:
>
> $ file NArad_U_geog83.tif
> NArad_U_geog83.tif: TIFF image data, little-endian
> $ gdalinfo NArad_U_geog83.tif
> Driver: GTiff/GeoTIFF
> Files: NArad_U_geog83.tif
> Size is 5868, 2432
> Coordinate System is `'
> Metadata:
>    TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>    TIFFTAG_XRESOLUTION=671
>    TIFFTAG_YRESOLUTION=671
> Image Structure Metadata:
>    INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 2432.0)
> Upper Right ( 5868.0,    0.0)
> Lower Right ( 5868.0, 2432.0)
> Center      ( 2934.0, 1216.0)
> Band 1 Block=5868x16 Type=Byte, ColorInterp=Red
> Band 2 Block=5868x16 Type=Byte, ColorInterp=Green
> Band 3 Block=5868x16 Type=Byte, ColorInterp=Blue
>
> so the file is just a Tiff image, not a GTiff file. It has no
> information on its placing in space or dimensions. The table at:
>
> http://mrdata.usgs.gov/radiometric/
>
> actually says that it is a Tiff file, matched by Geosoft Grid files,
> discussed in a thread resolved by Barry Rowlingson:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/018157.html
>
> apparently by the same person who is puzzled now. The resolution is
> probably the same, so I'm not sure why the question is being repeated.
>
> Roger
>
>
>>
>> The warning message refers to missing "GeoTransform" values. I find that
>> suggestive of information about the coordinate system. The website also
>> has a link to download a "TFW", which I believe contains coordinate
>> system
>> information. This is supported by the absence of proj4string info in your
>> summary info. Try downloading the TFW file, putting it in the same
>> directory as the tif, and then try reading again with rgdal.
>>
>> Instead, you might consider reading the file using the raster package;
>> conversion to a suitable data frame might be simpler from that point.
>>
>> -Don
>>
>>
>


From Danielle.rappaport at yale.edu  Tue May  7 05:17:38 2013
From: Danielle.rappaport at yale.edu (Danielle Rappaport)
Date: Tue, 7 May 2013 00:17:38 -0300
Subject: [R-sig-Geo] Error in reading .shp
Message-ID: <CAA65LJpn_NC+xr=N-m0PEP2mP0c6xcbi7+g1P_sOLHdfSUN+Qw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130507/03aa89d9/attachment.pl>

From mdsumner at gmail.com  Tue May  7 07:52:37 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 7 May 2013 15:52:37 +1000
Subject: [R-sig-Geo] colortables in raster
Message-ID: <CAAcGz9-00d5bvge9zwf9yqjsCMzobosnvYEtGT_ES=BC3+PdSw@mail.gmail.com>

Hello, I would like to use the @legend feature of raster to somehow
provide an absolute pallete across different objects. I thought
originally that I could just set the @legend at values and
@legend at colortable:


r <- raster(volcano)
r at legend@values <- seq(min(volcano), max(volcano), length = 125)
r at legend@colortable <- heat.colors(124)

## but, this doesn't work right since the getValues(r) should be
indices into r at legend@colortable
plot(r)

## we can recompute the values as indices, so it works
vs <- getValues(r)

r <- setValues(r, 1 + (124 * (vs - min(vs))/diff(range(vs))))
plot(r)

But, I would like to use the embedded legend like this in order to
keep the original range of getValues(r), but have the plotting build
the appropriate (absolute) colour map
from the @legend object. I'd also like it show the drawn legend when
the plot is done (like in .plotraster), rather than it being dropped
(as in .plotCT).

Is there any way to do this currently, other than to explicitly
provide the "col" and "breaks" arguments for plotting?  I appreciate
that I'm probably missing something obvious hacking around here.

Cheers, Mike.




--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Roger.Bivand at nhh.no  Tue May  7 10:02:39 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 7 May 2013 10:02:39 +0200
Subject: [R-sig-Geo] Error in reading .shp
In-Reply-To: <CAA65LJpn_NC+xr=N-m0PEP2mP0c6xcbi7+g1P_sOLHdfSUN+Qw@mail.gmail.com>
References: <CAA65LJpn_NC+xr=N-m0PEP2mP0c6xcbi7+g1P_sOLHdfSUN+Qw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305070903060.21884@reclus.nhh.no>

On Tue, 7 May 2013, Danielle Rappaport wrote:

> Hi there:
>
> I am trying to have R read a shapefile of a simple landscape classification
> (posted here <http://temp-share.com/show/3YgF8Kd4x>) and am getting an
> error message, which I'm not sure how to resolve:
>
>> Shape2 <-readShapePoly("JustForest_BahiaSul_1990.shp")
>
> Error in Polygon(coords = crds) : ring not closed
>
>
> I also tried specifying force_ring=TRUE, which does not seem to help:
>
>> shape3 <-readShapePoly("JustForest_BahiaSul_1990_Test.shp", force_ring=TRUE, delete_null_obj=TRUE)Error in Polygon(coords = crds) : ring not closed
>
> The same error results when I try with rgdal as an alternative:
>
>> shape1 <-readOGR("JustForest_BahiaSul_1990_Test.shp", layer="JustForest_BahiaSul_1990_Test")OGR data source with driver: ESRI Shapefile
> Source: "JustForest_BahiaSul_1990_Test.shp", layer:
> "JustForest_BahiaSul_1990_Test"
> with 19122 features and 6 fields
> Feature type: wkbPolygon with 2 dimensionsError in
> stopifnot(is.list(srl)) : ring not closed

Thanks for making the data available for reproduction, makes debugging 
much easier! The same happens in GRASS:

Counting polygons for 19122 features...
Importing map 19122 features...
  100%
-----------------------------------------------------
Building topology for vector map <test_tmp>...
Registering primitives...
v.in.ogr: index.c:159: RTreeInsertRect1: Assertion `r->boundary[i] <= 
r->boundary[3 + i]' failed.

So the shapefile is broken, and the problem is in the software used by 
your collaborator. The specific problem is that all of the x-coordinates 
in entity 15755, first ring are NaN, not finite.

If you are able to install sp and rgdal from R-forge from source checked 
out from SVN, you can get the corrected error message:

> Shape2 <-readOGR(".", "JustForest_BahiaSul_1990", useC=TRUE)
OGR data source with driver: ESRI Shapefile
Source: ".", layer: "JustForest_BahiaSul_1990"
with 19122 features and 6 fields
Feature type: wkbPolygon with 2 dimensions
Error in stopifnot(is.list(srl)) : non-finite x coordinate

and now by setting useC=FALSE, retrieve the entity number for errors. 
readOGR() will actually correct non-closed rings automatically, so the 
error message as it stood was misleading.

So your collaborator has to create a new file with finite coordinates.

Hope this clarifies,

Roger


>
>
> If it's of any use in troubleshooting, here is another shapefile
> (posted here <http://temp-share.com/show/KdPfyYg6h>) that was
> generated by the same collaborator of the same landscape just
> classified at another point in time, which R is reading without any
> problem.  I can't seem to figure out why
> "JustForest_BahiaSul_2007.shp" is being read successfully, and
> "JustForest_BahiaSul_1990.shp" is not.
>
> Many thanks in advance for offering your time and sage R-dom.
>
> Best, Danielle
>
>
> sessionInfo()
>
>
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets
> [7] methods   base
>
> other attached packages:
> [1] rgdal_0.8-8     maptools_0.8-23 lattice_0.20-13
> [4] sp_1.0-9        foreign_0.8-52
>
> loaded via a namespace (and not attached):
> [1] tools_2.15.3
>
>
>
>
> Danielle Ivonne Rappaport
> Master of Forestry 2012, Yale University
> Skype | Danielle_Rappaport
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From frzambra at gmail.com  Tue May  7 16:35:00 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Tue, 7 May 2013 10:35:00 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster data
	file (MOD13Q1, 2000-2012)
Message-ID: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130507/cdace58d/attachment.pl>

From janverbesselt at gmail.com  Tue May  7 16:42:14 2013
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Tue, 7 May 2013 16:42:14 +0200
Subject: [R-sig-Geo] How to write functions with mutiple large raster
 data file (MOD13Q1, 2000-2012)
In-Reply-To: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
Message-ID: <CAHKDjo56KLNXNJvaFfYQ6nHfimcKcuXuG9m5jYHOE7TCsA0qUQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130507/8914d520/attachment.pl>

From subbu_843 at yahoo.co.in  Tue May  7 18:41:37 2013
From: subbu_843 at yahoo.co.in (subash)
Date: Tue, 7 May 2013 09:41:37 -0700 (PDT)
Subject: [R-sig-Geo] sill not reaching 1 in a climatological variogram
In-Reply-To: <5183FC43.9030505@uni-muenster.de>
References: <1367512216726-7583465.post@n2.nabble.com>
	<51835613.6050604@uni-muenster.de>
	<1367595513312-7583478.post@n2.nabble.com>
	<5183FC43.9030505@uni-muenster.de>
Message-ID: <1367944897459-7583512.post@n2.nabble.com>

Thanks Edzer.

That makes sense.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/sill-not-reaching-1-in-a-climatological-variogram-tp7583465p7583512.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From darribas at unizar.es  Wed May  8 07:09:08 2013
From: darribas at unizar.es (Daniel Arribas-Bel)
Date: Wed, 8 May 2013 07:09:08 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 117, Issue 7
In-Reply-To: <mailman.9.1367920803.21285.r-sig-geo@r-project.org>
References: <mailman.9.1367920803.21285.r-sig-geo@r-project.org>
Message-ID: <CAKrCUaV+vALTSPWexSHxuu_-1Wt_ykL1ZQm0032wT=Mc2N_bEQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/b9b6ae56/attachment.pl>

From michela.giusti at isprambiente.it  Wed May  8 12:33:53 2013
From: michela.giusti at isprambiente.it (Michela Giusti)
Date: Wed, 08 May 2013 12:33:53 +0200
Subject: [R-sig-Geo] species presence table weight
Message-ID: <518A2A11.9000800@isprambiente.it>

Hello everybody,

I have a question for you regarding the species presence table that I 
have to use for my ENFA analysis (sample attached).

For my analysis I have to use _numbers of colonies for square meter_. 
How can I assign a "weight" to it ??

Thank you very much for you help.
Bye,
Michela

-- 
*****************************************************************
Dr. Michela Giusti
ISPRA
Istituto Superiore per la Protezione e la Ricerca Ambientale
Via Brancati, 60
00144 Roma
Tel. +390650074746
michela.giusti at isprambiente.it
*****************************************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/32b95d85/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: colonies.xlsx
Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Size: 9557 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/32b95d85/attachment.bin>

From nnagle at utk.edu  Wed May  8 13:20:25 2013
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Wed, 8 May 2013 11:20:25 +0000
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
Message-ID: <8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>

Dear Francisco,

I am working with the same time series of MOD09 data, but I leave it as a stack, rather than create the brick.  
Why do you need it as a brick?  The problem with brick is that it needs the data to be in one file.  That's a big file in this instance (Tb scale?).  And, since you didn't specify a filename, R is going to try and do this in memory, and will need to create virtual memory for this.  11 hours doesn't sound unreasonable for this.

Why not just leave it as a stack?  I've found it to work pretty well.  Otherwise, be sure to specify the filename so that R doesn't try to to this in memory.  But that still might take time, and is probably a needless recopy of a large amount of data.

Nicholas



Nicholas Nagle, Assistant Professor
Department of Geography
Burchfiel Geography Building 307
University of Tennessee
Knoxville, TN 37996


> Date: Tue, 7 May 2013 10:35:00 -0400
> From: Francisco Zambrano <frzambra at gmail.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] How to write functions with mutiple large raster
> 	data	file (MOD13Q1, 2000-2012)
> Message-ID:
> 	<CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA at mail.gmail.com>
> Content-Type: text/plain
> 
> Hi everybody,
> 
> I'm working with MODIS data MOD13Q1 and the NDVI index between 2000- today.
> I have been trying to do a function, but I have a problem when stack the
> 310 files and then I tried to use the writeStart function. I had an error
> because the startFuction work with rasterLayer or RasterBrick. But, when I
> tried to make the brick with the rasterStack (>brick(rasterStack)) the
> operation took too much time (11 hours)
> 
> My question, is what is the most efficiently way to make a rasterBrick from
> multiple raster (geoTIFF) files?
> 
> save the rasterStack and then open it with brick?
> 
> My code is something like:
> 
>> out<-stack(list.files(pattern=*..tif$))
>> out<-brick(mod) #too much time (11 hours appox)
> 
>> out<-writeStart(out,filename,overwrite=TRUE)
>> bs<-blockSize(out)
>> pb<-pbCreate(bs$n)
>> for (i in 1:bs$n){
>    v<-getValues(out,row=bs$row[i],nrows=bs$nrows[i])
>    s<-t(sapply(apply(v,1,lowess,f=7/n,iter=10),"[[","y"))
>    out<-writeValues(out,s,bs$row[i])
>   pbStep(pb,i)
>  }
> 
> Kind Regards
> 
> Francisco Zambrano Bigiarini
> 
> from Chile, latin america


From paul.feichtinger at tum.de  Wed May  8 15:21:51 2013
From: paul.feichtinger at tum.de (Feichtinger, Paul)
Date: Wed, 8 May 2013 13:21:51 +0000
Subject: [R-sig-Geo] WG: Endogenous explanatory variables in sphet
Message-ID: <CCD7DE7E72D4B341896DB1CE20AEB805373F157C@BADWLRZ-SWMBX11.ads.mwn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/da40a3ed/attachment.pl>

From frzambra at gmail.com  Wed May  8 15:23:35 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Wed, 8 May 2013 09:23:35 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
Message-ID: <CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/f2876883/attachment.pl>

From nnagle at utk.edu  Wed May  8 15:47:28 2013
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Wed, 8 May 2013 13:47:28 +0000
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
	<CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
Message-ID: <8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/b3b4b07f/attachment.pl>

From frzambra at gmail.com  Wed May  8 17:07:02 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Wed, 8 May 2013 11:07:02 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
	<CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
	<8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>
Message-ID: <CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/3526893a/attachment.pl>

From janverbesselt at gmail.com  Wed May  8 17:28:30 2013
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Wed, 8 May 2013 17:28:30 +0200
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
	<CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
	<8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>
	<CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>
Message-ID: <CAHKDjo7-mMe3r09D63WSMmfRkqUUqGkvwqGYa2aS8WR8AA3Exw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/c93ffdae/attachment.pl>

From r.hijmans at gmail.com  Wed May  8 17:40:32 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 8 May 2013 08:40:32 -0700
Subject: [R-sig-Geo] How to write functions with mutiple large raster
 data file (MOD13Q1, 2000-2012)
In-Reply-To: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
Message-ID: <CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>

Francisco,

I think what you want to do can be accomplished with 'calc' (as was
pointed out in another thread).

library(raster)
in <- stack(list.files(pattern=*..tif$))
out <- calc(in, fun=function(x) lowess(x,f=7/n,iter=10)$y)


But to answer your question, I think you could do:

in <- stack(list.files(pattern=*..tif$))
# and, here is the trick
out <- brick(in, values=FALSE)

Also, in your loop you could do:

getValues(in, ...
writeValues(out, ....


Best, Robert

On Tue, May 7, 2013 at 7:35 AM, Francisco Zambrano <frzambra at gmail.com> wrote:
> Hi everybody,
>
> I'm working with MODIS data MOD13Q1 and the NDVI index between 2000- today.
> I have been trying to do a function, but I have a problem when stack the
> 310 files and then I tried to use the writeStart function. I had an error
> because the startFuction work with rasterLayer or RasterBrick. But, when I
> tried to make the brick with the rasterStack (>brick(rasterStack)) the
> operation took too much time (11 hours)
>
> My question, is what is the most efficiently way to make a rasterBrick from
> multiple raster (geoTIFF) files?
>
> save the rasterStack and then open it with brick?
>
> My code is something like:
>
>>out<-stack(list.files(pattern=*..tif$))
>>out<-brick(mod) #too much time (11 hours appox)
>
>   >out<-writeStart(out,filename,overwrite=TRUE)
>   >bs<-blockSize(out)
>   >pb<-pbCreate(bs$n)
>   >for (i in 1:bs$n){
>     v<-getValues(out,row=bs$row[i],nrows=bs$nrows[i])
>     s<-t(sapply(apply(v,1,lowess,f=7/n,iter=10),"[[","y"))
>     out<-writeValues(out,s,bs$row[i])
>    pbStep(pb,i)
>   }
>
> Kind Regards
>
> Francisco Zambrano Bigiarini
>
> from Chile, latin america
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From frzambra at gmail.com  Wed May  8 17:45:09 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Wed, 8 May 2013 11:45:09 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <CAHKDjo7-mMe3r09D63WSMmfRkqUUqGkvwqGYa2aS8WR8AA3Exw@mail.gmail.com>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
	<CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
	<8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>
	<CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>
	<CAHKDjo7-mMe3r09D63WSMmfRkqUUqGkvwqGYa2aS8WR8AA3Exw@mail.gmail.com>
Message-ID: <CANE=RDPjgB-mXbS_nrqtLpAZQPg+GtY9x_68W+MgvgvW8ndGpQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/a5d94225/attachment.pl>

From nnagle at utk.edu  Wed May  8 18:03:06 2013
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Wed, 8 May 2013 16:03:06 +0000
Subject: [R-sig-Geo] How to write functions with mutiple large raster
In-Reply-To: <CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>
References: <mailman.11.1368007204.6636.r-sig-geo@r-project.org>
	<8AD9F0413AD09C4191033D03DC940BB11287CDF5@kmbx2.utk.tennessee.edu>
	<CANE=RDM=GMon_h9k_MFSxTiPb+XVJ3-nn-qW7uUQEX1zBvH6iA@mail.gmail.com>
	<8AD9F0413AD09C4191033D03DC940BB11287D20D@kmbx2.utk.tennessee.edu>
	<CANE=RDM+dcewyyuC8PV1ymkMQHfLYGc6tFy8yHUuGt_Exrbutg@mail.gmail.com>
Message-ID: <8AD9F0413AD09C4191033D03DC940BB11287D6A0@kmbx2.utk.tennessee.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/fa0712a4/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed May  8 18:06:13 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 8 May 2013 17:06:13 +0100
Subject: [R-sig-Geo] FOSS4G Conference programme announced
Message-ID: <CANVKczNb6Z42g6jfkUO6E2LKNTCG_ZFQ7GG=OrxktLtr9paY=g@mail.gmail.com>

Readers of r-sig-geo might be interested in the conference programme
for FOSS4G (Free/Open Source Software for Geospatial) 2013 in
Nottingham later this year. The provisional list of talks is online
now:

http://2013.foss4g.org/provisional/index.html

and there's also a bunch of workshops on things like PostGIS, QGis,
web mapping and so on:

http://2013.foss4g.org/provisional/workshops.html

There's a couple of talks that involve R (I have to write mine) and
plenty of other stuff to get your geo-teeth into.

Early-bird registration lasts until the end of the month. Will be
great to meet up with a few R-sig-geo people there!

Barry


From frzambra at gmail.com  Wed May  8 18:42:39 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Wed, 8 May 2013 12:42:39 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster
 data file (MOD13Q1, 2000-2012)
In-Reply-To: <CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
	<CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
Message-ID: <CANE=RDMbB_jYZwXcwTDv8-89Qd8mgDvzX5HafVTRPdMhnVKMBw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/880271e7/attachment.pl>

From viton.1 at osu.edu  Wed May  8 17:50:51 2013
From: viton.1 at osu.edu (Philip A. Viton)
Date: Wed, 08 May 2013 12:50:51 -0300
Subject: [R-sig-Geo] SPML : help with sphtest?
Message-ID: <201305081650.r48GoqED022182@defang10.it.ohio-state.edu>

I'm having trouble getting the spatial Hausman test (function 
sphtest) in splm to work for the case where we supply a formula and 
the method is ML. (The example in the manual, with method=GM works 
fine). I keep getting a reference to a parameter spatial.error which 
does not seem to be covered in the Usage of this function. Can anyone 
see what's going wrong?

library(splm) # version 1.0-00 under MS-Win
data("Produc", package="Ecdat")
data(usaww)
usalw<-mat2listw(usaww)
fm<-log(gsp)~log(pcap)+log(pc)+log(emp)+unemp

# this seems to correspond to the Usage of sphtest
sphtest(fm,data=Produc,listw=usalw,spatial.model="lag",method="ML",errors="BSK")
   Error in match.arg(spatial.error) :
   'arg' must be NULL or a character vector

I tried a bunch of other formulations, all of which
resulted in the error concerning parameter spatial.error/

Any help gratefully received!


------------------------
Philip A. Viton
City Planning, Ohio State University
275 West Woodruff Avenue, Columbus OH 43210
viton.1 at osu.edu


From frzambra at gmail.com  Wed May  8 21:45:20 2013
From: frzambra at gmail.com (Francisco Zambrano)
Date: Wed, 8 May 2013 15:45:20 -0400
Subject: [R-sig-Geo] How to write functions with mutiple large raster
 data file (MOD13Q1, 2000-2012)
In-Reply-To: <CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
	<CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
Message-ID: <CANE=RDOtpWzeOeXL898tsJ4iJQ57SD1oDaL2HGQq10hVFViE-A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/f243e390/attachment.pl>

From haaszoology at gmail.com  Thu May  9 01:34:54 2013
From: haaszoology at gmail.com (Sarah Haas)
Date: Wed, 8 May 2013 17:34:54 -0600
Subject: [R-sig-Geo] Combined projections
Message-ID: <CAHQ5qVci1LDT0ntKLyz1FTwsXSh2zM9JYk2iRsEYMLkhAcG3BA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130508/9fdb6534/attachment.pl>

From renaud.lancelot at cirad.fr  Thu May  9 02:07:03 2013
From: renaud.lancelot at cirad.fr (lancelot)
Date: Thu, 09 May 2013 02:07:03 +0200
Subject: [R-sig-Geo] Modis tiles with different resolutions
In-Reply-To: <CANE=RDOtpWzeOeXL898tsJ4iJQ57SD1oDaL2HGQq10hVFViE-A@mail.gmail.com>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
	<CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
	<CANE=RDOtpWzeOeXL898tsJ4iJQ57SD1oDaL2HGQq10hVFViE-A@mail.gmail.com>
Message-ID: <518AE8A7.8060708@cirad.fr>

Dear all,

I am processing large sets of MODIS data that come to me in sinusoidal 
projection and .lan (ERDAS 7.5) format. I have to mosaic different tiles 
and here comes the problem I meet: resolutions are not the same.

Basically I'm looping through these steps:

library(raster)
library(sp)
wgs84 <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
sinu <- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 
+units=m +no_defs"
## MA (h22v10) tile extent in longlat
e <- extent(c(40.6187, 53.2072, -20, -10))
## transform to sinusoidal
e <- as.data.frame(t(bbox(e)))
coordinates(e) <- ~ s1 + s2
projection(e) <- wgs84
e <- spTransform(e, CRS(sinu))
e <- coordinates(e)
e <- extent(c(e[,1], e[,2]))
## First raster
r <- raster("c:/Temp/RtmpyQ3t4R/MA050107.lan")
projection(r) <- sinu
extent(r) <- e

at the end of the process:

 > ## tile MA (h22v10)
 > MAdlst[[1]]
class       : RasterLayer
dimensions  : 1200, 1200, 1440000  (nrow, ncol, ncell)
resolution  : 1318.567, 926.6254  (x, y)
extent      : 4244214, 5826494, -2223901, -1111951  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 
+b=6371007.181 +units=m +no_defs
data source : c:\Temp\RtmpyQ3t4R\MA050107.lan
names       : MA050107
values      : -32768, 32767  (min, max)

 > ## tile MB (h22v11)
 > MBdlst[[1]]
class       : RasterLayer
dimensions  : 1200, 1200, 1440000  (nrow, ncol, ncell)
resolution  : 1611.032, 926.6254  (x, y)
extent      : 4099193, 6032431, -3335852, -2223901  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 
+b=6371007.181 +units=m +no_defs
data source : c:\Temp\RtmpyQ3t4R\MB050107.lan
names       : MB050107
values      : -32768, 32767  (min, max)


Am I doing something wrong, and how can I mosaic these rasters with 
different resolutions?

All the best,

Renaud


 > sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252 
LC_MONETARY=French_France.1252 LC_NUMERIC=C
[5] LC_TIME=French_France.1252

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods 
   base

other attached packages:
[1] rgdal_0.8-9     maptools_0.8-23 foreign_0.8-53  lattice_0.20-15 
mapdata_2.2-2   maps_2.3-2      raster_2.1-25
[8] sp_1.0-9

loaded via a namespace (and not attached):
[1] compiler_3.0.0 fortunes_1.5-1 tools_3.0.0








Le 08/05/2013 21:45, Francisco Zambrano a ?crit :
> Robert,
>
> Sorry, now I realize that calc works in chunk if is needed. And I imagine
> that calc is more efficient than do it the chunks by myself.
>
> Thanks,
>
> Francisco
>
>
> 2013/5/8 Robert J. Hijmans<r.hijmans at gmail.com>
>
>> Francisco,
>>
>> I think what you want to do can be accomplished with 'calc' (as was
>> pointed out in another thread).
>>
>> library(raster)
>> in<- stack(list.files(pattern=*..tif$))
>> out<- calc(in, fun=function(x) lowess(x,f=7/n,iter=10)$y)
>>
>>
>> But to answer your question, I think you could do:
>>
>> in<- stack(list.files(pattern=*..tif$))
>> # and, here is the trick
>> out<- brick(in, values=FALSE)
>>
>> Also, in your loop you could do:
>>
>> getValues(in, ...
>> writeValues(out, ....
>>
>>
>> Best, Robert
>>
>> On Tue, May 7, 2013 at 7:35 AM, Francisco Zambrano<frzambra at gmail.com>
>> wrote:
>>> Hi everybody,
>>>
>>> I'm working with MODIS data MOD13Q1 and the NDVI index between 2000-
>> today.
>>> I have been trying to do a function, but I have a problem when stack the
>>> 310 files and then I tried to use the writeStart function. I had an error
>>> because the startFuction work with rasterLayer or RasterBrick. But, when
>> I
>>> tried to make the brick with the rasterStack (>brick(rasterStack)) the
>>> operation took too much time (11 hours)
>>>
>>> My question, is what is the most efficiently way to make a rasterBrick
>> from
>>> multiple raster (geoTIFF) files?
>>>
>>> save the rasterStack and then open it with brick?
>>>
>>> My code is something like:
>>>
>>>> out<-stack(list.files(pattern=*..tif$))
>>>> out<-brick(mod) #too much time (11 hours appox)
>>>
>>>    >out<-writeStart(out,filename,overwrite=TRUE)
>>>    >bs<-blockSize(out)
>>>    >pb<-pbCreate(bs$n)
>>>    >for (i in 1:bs$n){
>>>      v<-getValues(out,row=bs$row[i],nrows=bs$nrows[i])
>>>      s<-t(sapply(apply(v,1,lowess,f=7/n,iter=10),"[[","y"))
>>>      out<-writeValues(out,s,bs$row[i])
>>>     pbStep(pb,i)
>>>    }
>>>
>>> Kind Regards
>>>
>>> Francisco Zambrano Bigiarini
>>>
>>> from Chile, latin america
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Renaud Lancelot
Directeur adjoint / Deputy director
CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier

EDENext Project, coordinator: http://www.edenext.eu/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From milan.kili11 at gmail.com  Thu May  9 11:12:43 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Thu, 9 May 2013 11:12:43 +0200
Subject: [R-sig-Geo] plotGoogleMaps : no colours?
In-Reply-To: <CANahzyGYJbNi2sninNf0+XGte4LfL36vmNxVSxr3N1fYnSPX_Q@mail.gmail.com>
References: <CANahzyGYJbNi2sninNf0+XGte4LfL36vmNxVSxr3N1fYnSPX_Q@mail.gmail.com>
Message-ID: <CAPSaU--sS2x_OmiuqNyvfhR6zkvSyCAtvrzk07jJgiC2shfA=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130509/a3acc047/attachment.pl>

From milan.kili11 at gmail.com  Thu May  9 12:06:10 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Thu, 9 May 2013 12:06:10 +0200
Subject: [R-sig-Geo] Fwd: Possible to attach photos with interactive maps? +
	video
In-Reply-To: <CAPSaU-9pcGE7OLq1tsL1zi5OLjD09xXhmscbggM8ZN2Czp_mnw@mail.gmail.com>
References: <CAPSaU-9pcGE7OLq1tsL1zi5OLjD09xXhmscbggM8ZN2Czp_mnw@mail.gmail.com>
Message-ID: <CAPSaU--=cE3x3cstk6AcDrxkpzUcTj4F7-mz101SuOCFDCXtZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130509/9c949be4/attachment.pl>

From stagis0 at gmail.com  Thu May  9 21:52:55 2013
From: stagis0 at gmail.com (p m)
Date: Thu, 9 May 2013 21:52:55 +0200
Subject: [R-sig-Geo] Raster comparrison
Message-ID: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130509/814adf58/attachment.pl>

From babuawara at gmail.com  Fri May 10 07:16:32 2013
From: babuawara at gmail.com (vikram ranga)
Date: Fri, 10 May 2013 10:46:32 +0530
Subject: [R-sig-Geo] auto.key=FALSE does not work: spplot without legends
Message-ID: <CAL-ALVEGoaDSyY6XeRLqGHN18t6jf7aB22TVwZd0trAL+Q_THw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/d7a2093f/attachment.pl>

From ubuntero.9161 at gmail.com  Fri May 10 10:04:38 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Fri, 10 May 2013 11:04:38 +0300
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
Message-ID: <CAAVnHstNPkurJKWzVM4uxZgcwx-Gc3-ZFwF1ttASLnpm35BB6A@mail.gmail.com>

On Thu, May 9, 2013 at 10:52 PM, p m <stagis0 at gmail.com> wrote:
> Dear all,
>
> I'm looking for a test to identify significant differences
> (p-value) between 2 raster maps.
>
> Can you suggest me a way to solve this problem?
>
>
> Thank you in advance.
>
> Paul

Paul,

you might have a look at the KappaV package (http://vincentbonhomme.fr/kappav/).

Cheers,
Ivailo
--
UBUNTU: a person is a person through other persons.


From carotenuto_francesco at yahoo.it  Fri May 10 12:17:22 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Fri, 10 May 2013 11:17:22 +0100 (BST)
Subject: [R-sig-Geo] gdistance
Message-ID: <1368181042.29880.YahooMailNeo@web133002.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/16480964/attachment.pl>

From l.hilger at ku.de  Fri May 10 14:05:14 2013
From: l.hilger at ku.de (Ludwig Hilger)
Date: Fri, 10 May 2013 05:05:14 -0700 (PDT)
Subject: [R-sig-Geo] Too many points for deldir()
Message-ID: <1368187514142-7583537.post@n2.nabble.com>

Hello everybody,

I am trying to construct Thiessenpolygons from a very large dataset (ca. 1.3
mio points) and get the following error:

thiessen <- deldir(normv$X, normv$Y)
[...]
Fehler: lange Vektoren (Argument 7) nicht unterst?tzt in  .C (~= long
vectors (argument 7) not supported in .C)

I am wondering if this comes from the number of points and if yes, if there
is a way to split the dataset into blocks and putting the result back
together afterwards? I suspect that there will be problems at the
borderlines of blocks!?

Thank you very much and best regards,
Ludwig

R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_1.0-9      deldir_0.0-22

loaded via a namespace (and not attached):
[1] grid_3.0.0      lattice_0.20-15



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Too-many-points-for-deldir-tp7583537.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From acocac at gmail.com  Fri May 10 14:13:59 2013
From: acocac at gmail.com (acocac)
Date: Fri, 10 May 2013 05:13:59 -0700 (PDT)
Subject: [R-sig-Geo] Isolate polygons unionSpatialPolygons / single polygon
 instead of multipart polygon
Message-ID: <1368188039534-7583538.post@n2.nabble.com>

Hi all, i used the function unionSpatialPolygons to dissolve polygons
according to an ID value. However, the results were not that i was
expecting. It created a SpatialPolygon and it grouped the objects according
to the ID value. i.e. one polygon had about 3 subpolygons with the same
value. How is the best way to create a new  SpatialPolygons with all
subpolygon as polygon and preserve their ID,

I share a screen shot where i selected one object and then i show the other
objects with the same ID value,

<http://r-sig-geo.2731867.n2.nabble.com/file/n7583538/pol.png> 

Also, i found a forum topic which has a similar issue,

http://r-sig-geo.2731867.n2.nabble.com/unionSpatialPolygons-single-polygon-instead-of-multipart-polygon-tc2765492.html#a2765496

Thanks,



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Isolate-polygons-unionSpatialPolygons-single-polygon-instead-of-multipart-polygon-tp7583538.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From acocac at gmail.com  Fri May 10 14:15:26 2013
From: acocac at gmail.com (Alejandro Coca Castro)
Date: Fri, 10 May 2013 07:15:26 -0500
Subject: [R-sig-Geo] Isolate polygons unionSpatialPolygons / single polygon
 instead of multipart polygon
Message-ID: <CAOFM_V177LHswPXFsk=vky_3k0b_bKsqe3cFwdGtCNti3a5=kA@mail.gmail.com>

Hi all, i used the function unionSpatialPolygons to dissolve polygons
according to an ID value. However, the results were not that i was
expecting. It created a SpatialPolygon and it grouped the objects according
to the ID value. i.e. one polygon had about 3 subpolygons with the same
value. How is the best way to create a new  SpatialPolygons with all
subpolygon as polygon and preserve their ID,

I share a screen shot where i selected one object and then i show the other
objects with the same ID value,

Also, i found a forum topic which has a similar issue,

http://r-sig-geo.2731867.n2.nabble.com/unionSpatialPolygons-single-polygon-instead-of-multipart-polygon-tc2765492.html#a2765496

Thanks,

-- 
*Alejandro Coca Castro***** ****
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/72c34efd/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: descarga.png
Type: image/png
Size: 26405 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/72c34efd/attachment.png>

From camille.leclerc at ymail.com  Fri May 10 15:06:42 2013
From: camille.leclerc at ymail.com (Camille Leclerc)
Date: Fri, 10 May 2013 06:06:42 -0700 (PDT)
Subject: [R-sig-Geo] =?utf-8?q?How_select_the_=E2=80=9Ccontour=E2=80=9D_ce?=
	=?utf-8?q?lls_of_a_raster_file?=
Message-ID: <1368191202275-7583540.post@n2.nabble.com>

Dear all,

I will expose my issue with an example: I have a temperature raster at world
scale and I want select or identify the ?contour? cells of this raster. More
clearly, I define ?contour? cells as cells which are adjacent to ocean. The
issue is that my raster file contains only terrestrial data and no ocean
data. I looked the functions of the raster package like clump() but it
doesn?t resolve my issue.
I have no idea how resolve this? Must I create an ocean raster or a simple
function exists?

Best, 
Camille
--
Camille Leclerc
Post-Master student
Lab ESE, UMR CNRS 8079
Univ Paris-Sud
Bat 362




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-select-the-contour-cells-of-a-raster-file-tp7583540.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From renaud.lancelot at cirad.fr  Fri May 10 20:57:02 2013
From: renaud.lancelot at cirad.fr (lancelot)
Date: Fri, 10 May 2013 20:57:02 +0200
Subject: [R-sig-Geo] problem with writeRaster and GeoTIFF format
Message-ID: <518D42FE.1090605@cirad.fr>

Dear all,

I have a raster

 > r
class       : RasterLayer
dimensions  : 1639, 821, 1345619  (nrow, ncol, ncell)
resolution  : 0.00887, 0.00833  (x, y)
extent      : 43.21786, 50.50013, -25.60209, -11.94922  (xmin, xmax, 
ymin, ymax)
coord. ref. : +proj=longlat +ellps=WGS84
data source : in memory
names       : layer
values      : 15.3815, 38.32809  (min, max)

I cannot write it to a GeoTIFF file:

 > writeRaster(r, filename = "r.tif")
Error in .local(.Object, ...) : Unable to create dataset

The same thing happens after converting the raster to 
SpatialGridDataFrame and using writeGDAL

 > r.sgdf <- as(r, Class = "SpatialGridDataFrame")
 > writeGDAL(dataset = r.sgdf, fname = "r.tif", drivername = "GTiff")
Error in .local(.Object, ...) : Unable to create dataset

I can write the raster to other formats (e.g. ESRI .hdr labelled). I can 
also reproduce the .tif example in ?writeRaster.

Any hint?

Best wishes,

Renaud

 > sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252 
LC_MONETARY=French_France.1252 LC_NUMERIC=C
[5] LC_TIME=French_France.1252

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods 
   base

other attached packages:
[1] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53  mapdata_2.2-2 
maps_2.3-2      raster_2.1-25   rgdal_0.8-9
[8] sp_1.0-9

loaded via a namespace (and not attached):
[1] compiler_3.0.0 fortunes_1.5-1 tools_3.0.0
 >


-- 
Renaud Lancelot
Directeur adjoint / Deputy director
CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier

EDENext Project, coordinator: http://www.edenext.eu/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From jgrn at illinois.edu  Fri May 10 21:41:23 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 10 May 2013 14:41:23 -0500
Subject: [R-sig-Geo] Using raster to import headerless ASCIIs?
Message-ID: <CABG0rftcGWeKZ6n8uzJ3Ja3gCgwq_UQazV0nopqZJrUQKDk5Mw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/6327a617/attachment.pl>

From etiennebr at gmail.com  Fri May 10 22:03:37 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 10 May 2013 16:03:37 -0400
Subject: [R-sig-Geo] Using raster to import headerless ASCIIs?
In-Reply-To: <CABG0rftcGWeKZ6n8uzJ3Ja3gCgwq_UQazV0nopqZJrUQKDk5Mw@mail.gmail.com>
References: <CABG0rftcGWeKZ6n8uzJ3Ja3gCgwq_UQazV0nopqZJrUQKDk5Mw@mail.gmail.com>
Message-ID: <CALjAYt6CKicLGc9f=ZzptSRF3cm_ng1rENuc6B4mRJk2wLaUrA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/0f924247/attachment.pl>

From thi_veloso at yahoo.com.br  Fri May 10 23:17:04 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Fri, 10 May 2013 14:17:04 -0700 (PDT)
Subject: [R-sig-Geo] problem with writeRaster and GeoTIFF format
In-Reply-To: <518D42FE.1090605@cirad.fr>
References: <518D42FE.1090605@cirad.fr>
Message-ID: <1368220624.76817.YahooMailNeo@web121903.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130510/8e024ef4/attachment.pl>

From tech_dev at wildintellect.com  Sat May 11 01:04:18 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Fri, 10 May 2013 16:04:18 -0700
Subject: [R-sig-Geo] Combined projections
In-Reply-To: <CAHQ5qVci1LDT0ntKLyz1FTwsXSh2zM9JYk2iRsEYMLkhAcG3BA@mail.gmail.com>
References: <CAHQ5qVci1LDT0ntKLyz1FTwsXSh2zM9JYk2iRsEYMLkhAcG3BA@mail.gmail.com>
Message-ID: <518D7CF2.90003@wildintellect.com>

On 05/08/2013 04:34 PM, Sarah Haas wrote:
> Previously using ESRI's ArcMap, I projected both shapefiles and rasters
> into NAD27.  Now I do not have access to ESRI and am using various R
> packages instead. When I read both types of files into R, the shapefile
> shows, "proj4string : [+proj=aea +lat_1=34 +lat_2=40.5 +lat_0=0 +lon_0=-120
> +x_0=0 +y_0=-4000000 +datum=NAD27 +units=m +no_defs +ellps=clrk66
> +nadgrids=@conus, at alaska, @ntv2_0.gsb, @ntv1_can.dat]".  Likewise, the
> raster files states, "coord. ref. : +proj=aea +lat_1=34 +lat_2=40.5
> +lat_0=0 +lon_0=-120 +x_0=0 +y_0=-4000000 +datum=NAD27 +units=m +no_defs
> +ellps=clrk66 +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat".
> <http://webpages.uncc.edu/~shaas1/index.htm>
> 
> Do you know why it appears that I have "combined" projections?  Could this
> be due to the fact that I "projected" them in ArcMap at a previous time and
> the previous/new information is being carried over? Is this cause for
> concern?
> 
> Thank you for your time.
> 
> --Sarah <http://webpages.uncc.edu/%7Eshaas1/index.htm>

What part of that seems combined?
I see Albers Equal Area in NAD27.

Are you referring to:
+nadgrids=@conus, at alaska, @ntv2_0.gsb, @ntv1_can.dat


My understanding is that parameter defines the transformation used to
get from WGS84 or to be used to go back.

Here's the docs on what that means
http://trac.osgeo.org/proj/wiki/GenParms#nadgrids-GridBasedDatumAdjustments

Thanks,
Alex


From renaud.lancelot at cirad.fr  Sat May 11 01:45:35 2013
From: renaud.lancelot at cirad.fr (lancelot)
Date: Sat, 11 May 2013 01:45:35 +0200
Subject: [R-sig-Geo] problem with writeRaster and GeoTIFF format
In-Reply-To: <1368220624.76817.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <518D42FE.1090605@cirad.fr>
	<1368220624.76817.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <518D869F.50108@cirad.fr>

Thank you very much, Thiago. That did the trick.

All the best,

Renaud

Le 10/05/2013 23:17, Thiago V. dos Santos a ?crit :
> Hi,
>
> I had the same issue in the past and I managed to solve it by:
>
> a) removing rgdal
> b) reinstalling gdal and libtiff libraries
> c) reinstalling rgdal
>
> Hope it helps.
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>
> ----- Original Message -----
> From: lancelot <renaud.lancelot at cirad.fr>
> To: r-sig-geo <r-sig-geo at r-project.org>
> Cc:
> Sent: Friday, May 10, 2013 1:57 PM
> Subject: [R-sig-Geo] problem with writeRaster and GeoTIFF format
>
> Dear all,
>
> I have a raster
>
>  > r
> class : RasterLayer
> dimensions : 1639, 821, 1345619 (nrow, ncol, ncell)
> resolution : 0.00887, 0.00833 (x, y)
> extent : 43.21786, 50.50013, -25.60209, -11.94922 (xmin, xmax,
> ymin, ymax)
> coord. ref. : +proj=longlat +ellps=WGS84
> data source : in memory
> names : layer
> values : 15.3815, 38.32809 (min, max)
>
> I cannot write it to a GeoTIFF file:
>
>  > writeRaster(r, filename = "r.tif")
> Error in .local(.Object, ...) : Unable to create dataset
>
> The same thing happens after converting the raster to
> SpatialGridDataFrame and using writeGDAL
>
>  > r.sgdf <- as(r, Class = "SpatialGridDataFrame")
>  > writeGDAL(dataset = r.sgdf, fname = "r.tif", drivername = "GTiff")
> Error in .local(.Object, ...) : Unable to create dataset
>
> I can write the raster to other formats (e.g. ESRI .hdr labelled). I can
> also reproduce the .tif example in ?writeRaster.
>
> Any hint?
>
> Best wishes,
>
> Renaud
>
>  > sessionInfo()
> R version 3.0.0 (2013-04-03)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
> LC_MONETARY=French_France.1252 LC_NUMERIC=C
> [5] LC_TIME=French_France.1252
>
> attached base packages:
> [1] grid stats graphics grDevices utils datasets methods
> base
>
> other attached packages:
> [1] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 mapdata_2.2-2
> maps_2.3-2 raster_2.1-25 rgdal_0.8-9
> [8] sp_1.0-9
>
> loaded via a namespace (and not attached):
> [1] compiler_3.0.0 fortunes_1.5-1 tools_3.0.0
>  >
>
>
> --
> Renaud Lancelot
> Directeur adjoint / Deputy director
> CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
> F34398 Montpellier
>
> EDENext Project, coordinator: http://www.edenext.eu/
>
> Tel. +33 4 67 59 37 17 - Fax +33 4 67 59 37 98
> Secr. +33 4 67 59 37 37 - Cell. +33 6 77 52 08 69
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Renaud Lancelot
Directeur adjoint / Deputy director
CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier

EDENext Project, coordinator: http://www.edenext.eu/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From thi_veloso at yahoo.com.br  Sat May 11 18:00:35 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Sat, 11 May 2013 09:00:35 -0700 (PDT)
Subject: [R-sig-Geo] rasterVis - Plot subset of data
In-Reply-To: <CAMLL7b=tBNHL0jj_hK9huAEhe2WvZT+7_rC1mbUwXR=-Rbd8YA@mail.gmail.com>
References: <1367702158.12611.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<CAMLL7b=tBNHL0jj_hK9huAEhe2WvZT+7_rC1mbUwXR=-Rbd8YA@mail.gmail.com>
Message-ID: <1368288035.74321.YahooMailNeo@web121905.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130511/95cd6e21/attachment.pl>

From jgrn at illinois.edu  Sat May 11 19:45:12 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 11 May 2013 12:45:12 -0500
Subject: [R-sig-Geo] Using raster to import headerless ASCIIs?
In-Reply-To: <4e66d14c855748c2acd388739f190b71@CHIHT3.ad.uillinois.edu>
References: <CABG0rftcGWeKZ6n8uzJ3Ja3gCgwq_UQazV0nopqZJrUQKDk5Mw@mail.gmail.com>
	<4e66d14c855748c2acd388739f190b71@CHIHT3.ad.uillinois.edu>
Message-ID: <CABG0rftTd3cG05-hCCfBDGgsbg40qLgvKi7dAObqPx-M8e_JZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130511/ca4073e6/attachment.pl>

From r.hijmans at gmail.com  Sat May 11 20:26:12 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 11 May 2013 11:26:12 -0700
Subject: [R-sig-Geo] Using raster to import headerless ASCIIs?
In-Reply-To: <CABG0rftTd3cG05-hCCfBDGgsbg40qLgvKi7dAObqPx-M8e_JZw@mail.gmail.com>
References: <CABG0rftcGWeKZ6n8uzJ3Ja3gCgwq_UQazV0nopqZJrUQKDk5Mw@mail.gmail.com>
	<4e66d14c855748c2acd388739f190b71@CHIHT3.ad.uillinois.edu>
	<CABG0rftTd3cG05-hCCfBDGgsbg40qLgvKi7dAObqPx-M8e_JZw@mail.gmail.com>
Message-ID: <CANtt_hzCj9kEX44o9vaVUVL+5GWb6Bi0BFRpw8O9oqZLTuoLWg@mail.gmail.com>

Jonathan,
A little shorter:

library(raster)

s <- read.fwf("soilwhc.dat", widths=rep(5,36))
r <- raster(ncol=720, nrow=360, xmn=0, xmx=360)
values(r) <- as.vector(t(as.matrix(s)))
r <- rotate(flip(r, 'y'))

plot(r)

Robert

On Sat, May 11, 2013 at 10:45 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> I was trying to solve this entirely within R -- this was my solution:
>
> # The file is fixed width format, each number has a width of 5,
> # with 36 numbers to a line:
> soilwhc_dunne_raw_df <- read.fwf("soilwhc.dat",widths=rep(5,36))
> soilwhc_dunne_raw_vector <- c(t(data.matrix(soilwhc_dunne_raw_df)))
> soilwhc_dunne_raw_matrix <-
> matrix(soilwhc_dunne_raw_vector,ncol=360,nrow=720)
> # The image comes out flipped along the y axis:
> soilwhc_dunne_raw <- flip(raster(t(soilwhc_dunne_raw_matrix)),"y")
> extent(soilwhc_dunne_raw) <- extent(0,360,-90,90)
> projection(soilwhc_dunne_raw) <- CRS("+proj=longlat +datum=WGS84")
> # We'll also rotate it:
> soilwhc_dunne_raw_rotate <- rotate(soilwhc_dunne_raw)
>
> I was curious if there was a more elegant solution to this?  Either way,
> thanks for the response!
>
> --j
>
>
> On Fri, May 10, 2013 at 3:03 PM, Etienne B. Racine <etiennebr at gmail.com>wrote:
>
>>   Jonathan,
>>
>>  You should set an header in the first file. Dunne_soil.dat is recognized
>> as an Ascii Grid by GDAL because it has an header :
>> ncols         720
>> nrows         360
>> xllcorner     -180
>> yllcorner     -90
>> cellsize      0.5
>> NODATA_value  -9999
>>
>>  soilwhc.dat has no header. Also NA is coded with no space (-99.0-99.0).
>> Maybe if you search and replace -99.0 by -9999[space] this would make it
>> more standard. The lines are also rather short (36), but very long (7200).
>> I guess each row is indeed 10 lines. It would share the same header than
>> dunne_soil.dat. So you have some reformatting to get it working.
>>
>>  Etienne
>>
>>
>> 2013/5/10 Jonathan Greenberg <jgrn at illinois.edu>
>>
>>> r-sig-geo'ers:
>>>
>>> I'm trying some random hacks, but was wondering if there is a more
>>> efficient way to import the following file:
>>> ftp://ftp.daac.ornl.gov/data/global_soil/Dunne/data/soilwhc.dat
>>>
>>> as a raster().  The file is a fixed width file (width=5) of floating point
>>> values, but had the Arc header stripped off.  A reference file that DOES
>>> work with raster is:
>>>
>>> ftp://ftp.daac.ornl.gov/data/global_soil/Dunne/data/dunne_soil.dat
>>> reference_raster <- raster(dunne_soil.dat)
>>> # This has the same number of rows and columns and resolution as
>>> # the file above.
>>>
>>> Thoughts on the most efficient way to convert the first file to a workable
>>> raster?
>>>
>>> --j
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 607 South Mathews Avenue, MC 150
>>> Urbana, IL 61801
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 607 South Mathews Avenue, MC 150
> Urbana, IL 61801
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From s6lihert at uni-bonn.de  Sat May 11 21:32:25 2013
From: s6lihert at uni-bonn.de (Lionel)
Date: Sat, 11 May 2013 21:32:25 +0200
Subject: [R-sig-Geo] Drawing lines in raster cells
Message-ID: <518E9CC9.3060308@uni-bonn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130511/d7771812/attachment.pl>

From oscar.perpinan at gmail.com  Sun May 12 16:23:45 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Sun, 12 May 2013 16:23:45 +0200
Subject: [R-sig-Geo] Drawing lines in raster cells
In-Reply-To: <518E9CC9.3060308@uni-bonn.de>
References: <518E9CC9.3060308@uni-bonn.de>
Message-ID: <87y5bkz37y.fsf@gmail.com>

Hi Lionel,

With this code you will draw lines connecting raster cells with a
certain value. I am not sure if you also need to build a SpatialLines
object with them (which you won't get with my code):

library(raster)
library(latticeExtra) ## to use +.trellis and layer()

r1<-raster(ncols=10,nrows=10)
r1[]<-sample(0:1,100,replace=TRUE)

## extract coordinates of those cells with a condition
myCells <- Which(r1==1, cells=TRUE)
xy <- xyFromCell(r1, myCells)

## border and border.lwd are only needed to highlight the cells boundaries
spplot(r1, at=c(0, 0.5, 1), border='black', border.lwd=0.3) +
    layer(llines(xy, type='b', col='black'))


Best,

Oscar.

Lionel <s6lihert at uni-bonn.de> writes:

> Dear List,
>
> I would like to draw lines in raster cells with a certain values, I can 
> work around this with a for loop but as always this solution only works 
> for small datasets (which is not my case), I would therefore like to 
> have your opinion on this;
>
> #the code
> library(maptools) #to use spRbind
> out<-NULL
> r1<-raster(ncols=10,nrows=10)
> r1[]<-sample(0:1,100,replace=TRUE)
> for(i in 1:ncell(r1)){
>    if(r1[i]==1){
> lines<-SpatialLines(list(Lines(list(Line(matrix(c(xyFromCell(r1,i)+(res(r1)/2),xyFromCell(r1,i)-(res(r1)/2)),ncol=2,byrow=TRUE))),ID=as.character(i))))
>      if(is.null(out)){
>        out<-lines }
>         else {out<-spRbind(out,lines)}
>      }
>    print(i)
> }
>
> Thank you in advance,


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From s6lihert at uni-bonn.de  Sun May 12 17:49:44 2013
From: s6lihert at uni-bonn.de (Lionel)
Date: Sun, 12 May 2013 17:49:44 +0200
Subject: [R-sig-Geo] Drawing lines in raster cells
In-Reply-To: <87y5bkz37y.fsf@gmail.com>
References: <518E9CC9.3060308@uni-bonn.de> <87y5bkz37y.fsf@gmail.com>
Message-ID: <518FBA18.70205@uni-bonn.de>

Hi Oscar,

Thanks for your help, what I would like to get is something similar to this:
http://www.google.fr/imgres?q=species+range+shift&start=280&um=1&sa=N&hl=fr&biw=1366&bih=647&tbm=isch&tbnid=MdhZVMKVLMSH3M:&imgrefurl=http://www.scielo.sa.cr/scielo.php%3Fscript%3Dsci_arttext%26pid%3DS0034-77442008000200028&docid=9u3QDKVd0hdQqM&imgurl=http://www.scielo.sa.cr/img/revistas/rbt/v56n2/art28i2.jpg&w=363&h=432&ei=cbiPUe_4BqO80QX-hoCIBw&zoom=1&iact=hc&vpx=588&vpy=170&dur=342&hovh=180&hovw=152&tx=83&ty=124&page=10&tbnh=159&tbnw=134&ndsp=30&ved=1t:429,r:84,s:200,i:256

Where each raster cells with a certain values (say 1) get crossed by a 
diagonal line.

Your code is achieving something different, concerning the object 
created the best would be a Spatial* object, however I think I could be 
able to find a way around using ggmap.

Thanks again,
Lionel

On 12/05/2013 16:23, Oscar Perpi??n Lamigueiro wrote:
> Hi Lionel,
>
> With this code you will draw lines connecting raster cells with a
> certain value. I am not sure if you also need to build a SpatialLines
> object with them (which you won't get with my code):
>
> library(raster)
> library(latticeExtra) ## to use +.trellis and layer()
>
> r1<-raster(ncols=10,nrows=10)
> r1[]<-sample(0:1,100,replace=TRUE)
>
> ## extract coordinates of those cells with a condition
> myCells <- Which(r1==1, cells=TRUE)
> xy <- xyFromCell(r1, myCells)
>
> ## border and border.lwd are only needed to highlight the cells boundaries
> spplot(r1, at=c(0, 0.5, 1), border='black', border.lwd=0.3) +
>      layer(llines(xy, type='b', col='black'))
>
>
> Best,
>
> Oscar.
>
> Lionel <s6lihert at uni-bonn.de> writes:
>
>> Dear List,
>>
>> I would like to draw lines in raster cells with a certain values, I can
>> work around this with a for loop but as always this solution only works
>> for small datasets (which is not my case), I would therefore like to
>> have your opinion on this;
>>
>> #the code
>> library(maptools) #to use spRbind
>> out<-NULL
>> r1<-raster(ncols=10,nrows=10)
>> r1[]<-sample(0:1,100,replace=TRUE)
>> for(i in 1:ncell(r1)){
>>     if(r1[i]==1){
>> lines<-SpatialLines(list(Lines(list(Line(matrix(c(xyFromCell(r1,i)+(res(r1)/2),xyFromCell(r1,i)-(res(r1)/2)),ncol=2,byrow=TRUE))),ID=as.character(i))))
>>       if(is.null(out)){
>>         out<-lines }
>>          else {out<-spRbind(out,lines)}
>>       }
>>     print(i)
>> }
>>
>> Thank you in advance,
>
>


From r.turner at auckland.ac.nz  Mon May 13 00:19:13 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 13 May 2013 10:19:13 +1200
Subject: [R-sig-Geo] Too many points for deldir()
In-Reply-To: <1368187514142-7583537.post@n2.nabble.com>
References: <1368187514142-7583537.post@n2.nabble.com>
Message-ID: <51901561.70106@auckland.ac.nz>


I had a similar query about a month ago, and it appears that the
limitation is intrinsic to R and there's nothing that can be done about
it through modifying deldir.

You are quite right to say that "there will be problems at the
borderlines of blocks".  I would guess that doing such an amalgamation
of triangulations would be a very difficult problem.  It is possible that
there is something about it in the literature; I wouldn't know.

There is another package for doing triangulation on CRAN.  It's called
"tripack".  This package presumably uses a different algorithm from
deldir so it is *possible* that it does not bump up against the same
limitation.  You might want to give it a try.  There is other software
(not written in R) out there for doing triangulation and it is possible
that one of these implementations might alleviate your problem. There
is a "sweepline algorithm" due to Steve Fortune about which I have
seen laudatory comments.

Finally, let me just say that it is mysterious to me what one could
discover from a triangulation/tessellation of 1.3 million points. It seems
to me that any potential information would be lost in a blur of noise.
Why are you doing this?

     cheers,

         Rolf Turner

On 11/05/13 00:05, Ludwig Hilger wrote:
> Hello everybody,
>
> I am trying to construct Thiessenpolygons from a very large dataset (ca. 1.3
> mio points) and get the following error:
>
> thiessen <- deldir(normv$X, normv$Y)
> [...]
> Fehler: lange Vektoren (Argument 7) nicht unterst?tzt in  .C (~= long
> vectors (argument 7) not supported in .C)
>
> I am wondering if this comes from the number of points and if yes, if there
> is a way to split the dataset into blocks and putting the result back
> together afterwards? I suspect that there will be problems at the
> borderlines of blocks!?


From j.m.signer at gmail.com  Mon May 13 08:25:08 2013
From: j.m.signer at gmail.com (Johannes Signer)
Date: Mon, 13 May 2013 08:25:08 +0200
Subject: [R-sig-Geo] Drawing lines in raster cells
In-Reply-To: <518FBA18.70205@uni-bonn.de>
References: <518E9CC9.3060308@uni-bonn.de> <87y5bkz37y.fsf@gmail.com>
	<518FBA18.70205@uni-bonn.de>
Message-ID: <CAC8qavuuW2NAAmTVcOJtDKYttdJKg3hqgwD9hD=ajZB-sx2oPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/1b901f2e/attachment.pl>

From mathieu.rajerison at gmail.com  Mon May 13 09:16:14 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 13 May 2013 09:16:14 +0200
Subject: [R-sig-Geo] Modis tiles with different resolutions
In-Reply-To: <518AE8A7.8060708@cirad.fr>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
	<CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
	<CANE=RDOtpWzeOeXL898tsJ4iJQ57SD1oDaL2HGQq10hVFViE-A@mail.gmail.com>
	<518AE8A7.8060708@cirad.fr>
Message-ID: <CAGfc75nGfHk-FTecgKLEAV3_0sHiDsaVvPq-fiHJ4_g1D8Qrkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/525a844c/attachment.pl>

From Rainer at krugs.de  Mon May 13 09:51:32 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Mon, 13 May 2013 09:51:32 +0200
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	(p. m.'s message of "Thu, 9 May 2013 21:52:55 +0200")
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
Message-ID: <8738trnwqj.fsf@krugs.de>


p m <stagis0 at gmail.com> writes:

> Dear all,
>
> I'm looking for a test to identify significant differences
> (p-value) between 2 raster maps.
>
> Can you suggest me a way to solve this problem?

Hi

Based on my understanding, you *can not* get a p value for the
difference between two entities - to ask if the two maps are
significantly different, is like asking if the two numbers 1 and two are
significantly different.

You can only answer that question if you know the underlying
distributions and can compare these.

What you can do is quantifying the difference between the two maps. One
approach I used is the Earth Movers Distance, implemented in two
packages:

http://www.rforge.net/doc/packages/emdist/emd.html 
(implemented by myself and Dirk Eddelbuettel and used in some projects) and

http://cran.r-project.org/web/packages/emdist/emdist.pdf

by Simon Urbanek (haven't used it).

But there are many other distance measures to quantify the difference
between two raster maps. Which one you choose, depends on your question.

Cheers,

Rainer

>
>
> Thank you in advance.
>
> Paul
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 489 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/b898d4aa/attachment.bin>

From matteo.mattiuzzi at boku.ac.at  Mon May 13 12:42:57 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Mon, 13 May 2013 12:42:57 +0200
Subject: [R-sig-Geo] Modis tiles with different resolutions
In-Reply-To: <518AE8A7.8060708@cirad.fr>
References: <CANE=RDO9N-WmnjKTbqnzkeFN=TSfoGxWwyKQo5Jrx4EJSMgfEA@mail.gmail.com>
	<CANtt_hzOPFV3+BPsU_9s8PLUK466=CksCni5Cqy0b_0YpnhyzQ@mail.gmail.com>
	<CANE=RDOtpWzeOeXL898tsJ4iJQ57SD1oDaL2HGQq10hVFViE-A@mail.gmail.com>
	<518AE8A7.8060708@cirad.fr>
Message-ID: <5190DFD10200002700019E58@gwia2.boku.ac.at>

Lancelot,
The way you have formulated your question and the code you have provided
does not give enough information to help in an easy and appropriate way.
Please make sure that the code you provide is enough to reproduce the
example or, if not possible, that any information is included.


I think you have mixed up something with your extent or better with its
re-projection! 
An easier way to re-project the extent of a raster* object is:
#############
library(raster)
e <- raster(xmn=40.6187, xmx=53.2072, ymn=-20, ymx=-10)
e <- projectExtent(e,"+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs")
e # this 'e' is right and not the same as yours!


# Have you tested to load your results in a GIS? You will see that it
isn't just a resolution problem but the two images are not on the right
place! 
# Find bellow the extent of the two tiles using the MODIS package in an
example run (in your case probably not usable as you are working with
already available '.lan' files).
############
> library(MODIS)


# TILE h22v11
> runGdal(product="MOD11A2", begin="2010001", end="2010007", tileH=22,
tileV=11, SDSstring=1, job="LST")
pixelSize        =  asIn 
resamplingType   =  near 
outProj          = +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs 
Output Directory = ~/MODIS_PROCESSED/LST 


> raster('~/MODIS_PROCESSED/LST/MOD11A2.A2010001.LST_Day_1km.tif' )
class       : RasterLayer 
dimensions  : 1200, 1200, 1440000  (nrow, ncol, ncell)
resolution  : 926.6254, 926.6254  (x, y)
extent      : 4447802, 5559753, -3335852, -2223901  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs 
data source : ~/MODIS_PROCESSED/LST/MOD11A2.A2010001.LST_Day_1km.tif 
names       : MOD11A2.A2010001.LST_Day_1km 
values      : 0, 65535  (min, max)


# TILE h22v10
> runGdal(product="MOD11A2", begin="2010001", end="2010007", tileH=22,
tileV=10, SDSstring=1, job="LST2")
pixelSize        =  asIn 
resamplingType   =  near 
outProj          = +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs 
Output Directory = ~/MODIS_PROCESSED/LST2 


>raster('~/MODIS_PROCESSED/LST2/MOD11A2.A2010001.LST_Day_1km.tif' )
class       : RasterLayer 
dimensions  : 1200, 1200, 1440000  (nrow, ncol, ncell)
resolution  : 926.6254, 926.6254  (x, y)
extent      : 4447802, 5559753, -2223901, -1111951  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181
+b=6371007.181 +units=m +no_defs 
data source : ~/MODIS_PROCESSED/LST2/MOD11A2.A2010001.LST_Day_1km.tif 
names       : MOD11A2.A2010001.LST_Day_1km 
values      : 0, 65535  (min, max)


# IHTH
# Matteo



# PS:
# both TILES + mosaicked:
> runGdal(product="MOD11A2", begin="2010001", end="2010007", tileH=22,
tileV=10:11, SDSstring=1, job="LST3")


# entire Madagascar:
> runGdal(product="MOD11A2", begin="2010001", end="2010007",
extent="Madagascar", SDSstring=1, job="LST4")




>>> lancelot  05/09/13 2:07 AM >>>
Dear all,

I am processing large sets of MODIS data that come to me in sinusoidal 
projection and .lan (ERDAS 7.5) format. I have to mosaic different tiles

and here comes the problem I meet: resolutions are not the same.

Basically I'm looping through these steps:

library(raster)
library(sp)
wgs84 <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
sinu <- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181

+units=m +no_defs"
## MA (h22v10) tile extent in longlat
e <- extent(c(40.6187, 53.2072, -20, -10))
## transform to sinusoidal
e <- as.data.frame(t(bbox(e)))
coordinates(e) <- ~ s1 + s2
projection(e) <- wgs84
e <- spTransform(e, CRS(sinu))
e <- coordinates(e)
e <- extent(c(e[,1], e[,2]))
## First raster
r <- raster("c:/Temp/RtmpyQ3t4R/MA050107.lan")
projection(r) <- sinu
extent(r) <- e

at the end of the process:

 > ## tile MA (h22v10)
 > MAdlst[[1]]
class       : RasterLayer
dimensions  : 12extent      : 4244214, 5826494, -2223901, -1111951  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 
+b=6371007.181 +units=m +no_defs
data source : c:\Temp\RtmpyQ3t4R\MA050107.lan
names       : MA050107
values      : -32768, 32767  (min, max)

 > ## tile MB (h22v11)
 > MBdlst[[1]]
class       : RasterLayer
dimensions  : 1200, 1200, 1440000  (nrow, ncol, ncell)
resolution  : 1611.032, 926.6254  (x, y)
extent      : 4099193, 6032431, -3335852, -2223901  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 
+b=6371007.181 +units=m +no_defs
data source : c:\Temp\RtmpyQ3t4R\MB050107.lan
names       : MB050107
values      : -32768, 32767  (min, max)


Am I doing something wrong, and how can I mosaic these rasters with 
different resolutions?

All the best,

Renaud


 > sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252 
LC_MONETARY=French_France.1252 LC_NUMERIC=C
[5] LC_TIME=French_France.1252

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods 
   base

other attached packages:
[1] rgdal_0.8-9     maptools_0.8-23 foreign_0.8-53  lattice_0.20-15 
mapdata_2.2-2   maps_2.3-2      raster_2.1-25
[8] sp_1.0-9

loaded via a namespace (and not attached):
[1] compiler_3.0.0 fortunes_1.5-1 tools_3.0.0








Le 08/05/2013 21:45, Francisco Zambrano a ?crit :
> Robert,
>
> Sorry, now I realize that calc works in chunk if is needed. And I
imagine
> that calc is more efficient than do it the chunks by myself.
>
> Thanks,
>
> Francisco
>
>
> 2013/5/8 Robert J. Hijmans
>
>> Francisco,
>>
>> I think what you want to do can be accomplished with 'calc' (as was
>> pointed out in another thread).
>>
>> library(raster)
>> in<- stack(list.files(pattern=*..tif$))
>> out<- calc(in, fun=function(x) lowess(x,f=7/n,iter=10)$y)
>>
>>
>> But to answer your question, I think you could do:
>>
>> in<- stack(list.files(pattern=*..tif$))
>> # and, here is the trick
>> out<- brick(in, values=FALSE)
>>
>> Also, in your loop you could do:
>>
>> getValues(in, ...
>> writeValues(out, ....
>>
>>
>> Best, Robert
>>
>> On Tue, May 7, 2013 at 7:35 AM, Francisco Zambrano
>> wrote:
>>> Hi everybody,
>>>
>>> I'm working with MODIS data MOD13Q1 and the NDVI index between 2000-
>> today.
>>> I have been trying to do a function, but I have a problem when stack
the
>>> 310 files and then I tried to use the writeStart function. I had an
error
>>> because the startFuction work with rasterLayer or RasterBrick. But,
when
>> I
>>> tried to make the brick with the rasterStack (>brick(rasterStack))
the
>>> operation took too much time (11 hours)
>>>
>>> My question, is what is the most efficiently way to make a
rasterBrick
>> from
>>> multiple raster (geoTIFF) files?
>>>
>>> save the rasterStack and then open it with brick?
>>>
>>> My code is something like:
>>>
>>>> out<-stack(list.files(pattern=*..tif$))
>>>> out<-brick(mod) #too much time (11 hours appox)
>>>
>>>    >out<-writeStart(out,filename,overwrite=TRUE)
>>>    >bs<-blockSize(out)
>>>    >pb<-pbCreate(bs$n)
>>>    >for (i in 1:bs$n){
>>>      v<-getValues(out,row=bs$row[i],nrows=bs$nrows[i])
>>>      s<-t(sapply(apply(v,1,lowess,f=7/n,iter=10),"[[","y"))
>>>      out<-writeValues(out,s,bs$row[i])
>>>     pbStep(pb,i)
>>>    }
>>>
>>> Kind Regards
>>>
>>> Francisco Zambrano Bigiarini
>>>
>>> from Chile, latin america
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Renaud Lancelot
Directeur adjoint / Deputy diTel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From l.hilger at ku.de  Mon May 13 18:18:36 2013
From: l.hilger at ku.de (Ludwig Hilger)
Date: Mon, 13 May 2013 09:18:36 -0700 (PDT)
Subject: [R-sig-Geo] Too many points for deldir()
In-Reply-To: <51901561.70106@auckland.ac.nz>
References: <1368187514142-7583537.post@n2.nabble.com>
	<51901561.70106@auckland.ac.nz>
Message-ID: <1368461916417-7583558.post@n2.nabble.com>

Dear Mr. Turner,

first of all: Thank you very much for you comments and hints! I will give
tripack a try but I am also already working on the problem with other
software. I am trying to use Thiessen polygons to assign areas of uniform
change to very high-density Lidar measurement points, so the change distance
measured at a point would be thought of being representative of the change
within its Thiessen polygon, which will be one way of getting to Cut and
Fill-Volumes.

best regards and thank you again,

Ludwig Hilger 



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Too-many-points-for-deldir-tp7583537p7583558.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From saramartino at yahoo.com  Mon May 13 18:20:13 2013
From: saramartino at yahoo.com (sara martino)
Date: Mon, 13 May 2013 09:20:13 -0700 (PDT)
Subject: [R-sig-Geo] good evening
Message-ID: <1368462013.65532.YahooMailNeo@web140901.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/3e27e09d/attachment.pl>

From r.hijmans at gmail.com  Mon May 13 18:42:32 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 13 May 2013 09:42:32 -0700
Subject: [R-sig-Geo] Drawing lines in raster cells
In-Reply-To: <518FBA18.70205@uni-bonn.de>
References: <518E9CC9.3060308@uni-bonn.de> <87y5bkz37y.fsf@gmail.com>
	<518FBA18.70205@uni-bonn.de>
Message-ID: <CANtt_hwAPZYK_LZufr-vBLsDg5NerQxuac15osRhROQ0tjnXfQ@mail.gmail.com>

Lionel, perhaps this is what you are after. Robert

library(raster)
library(rgeos)

r <- raster(ncols=10,nrows=10)
set.seed(0)
r[] <- sample(0:1,100,replace=TRUE)

p <- rasterToPolygons(r, fun=function(x){x==1}, dissolve=TRUE)

plot(r)
plot(p, add=T, density=4)



On Sun, May 12, 2013 at 8:49 AM, Lionel <s6lihert at uni-bonn.de> wrote:
> Hi Oscar,
>
> Thanks for your help, what I would like to get is something similar to this:
> http://www.google.fr/imgres?q=species+range+shift&start=280&um=1&sa=N&hl=fr&biw=1366&bih=647&tbm=isch&tbnid=MdhZVMKVLMSH3M:&imgrefurl=http://www.scielo.sa.cr/scielo.php%3Fscript%3Dsci_arttext%26pid%3DS0034-77442008000200028&docid=9u3QDKVd0hdQqM&imgurl=http://www.scielo.sa.cr/img/revistas/rbt/v56n2/art28i2.jpg&w=363&h=432&ei=cbiPUe_4BqO80QX-hoCIBw&zoom=1&iact=hc&vpx=588&vpy=170&dur=342&hovh=180&hovw=152&tx=83&ty=124&page=10&tbnh=159&tbnw=134&ndsp=30&ved=1t:429,r:84,s:200,i:256
>
> Where each raster cells with a certain values (say 1) get crossed by a
> diagonal line.
>
> Your code is achieving something different, concerning the object created
> the best would be a Spatial* object, however I think I could be able to find
> a way around using ggmap.
>
> Thanks again,
> Lionel
>
>
> On 12/05/2013 16:23, Oscar Perpi??n Lamigueiro wrote:
>>
>> Hi Lionel,
>>
>> With this code you will draw lines connecting raster cells with a
>> certain value. I am not sure if you also need to build a SpatialLines
>> object with them (which you won't get with my code):
>>
>> library(raster)
>> library(latticeExtra) ## to use +.trellis and layer()
>>
>> r1<-raster(ncols=10,nrows=10)
>> r1[]<-sample(0:1,100,replace=TRUE)
>>
>> ## extract coordinates of those cells with a condition
>> myCells <- Which(r1==1, cells=TRUE)
>> xy <- xyFromCell(r1, myCells)
>>
>> ## border and border.lwd are only needed to highlight the cells boundaries
>> spplot(r1, at=c(0, 0.5, 1), border='black', border.lwd=0.3) +
>>      layer(llines(xy, type='b', col='black'))
>>
>>
>> Best,
>>
>> Oscar.
>>
>> Lionel <s6lihert at uni-bonn.de> writes:
>>
>>> Dear List,
>>>
>>> I would like to draw lines in raster cells with a certain values, I can
>>> work around this with a for loop but as always this solution only works
>>> for small datasets (which is not my case), I would therefore like to
>>> have your opinion on this;
>>>
>>> #the code
>>> library(maptools) #to use spRbind
>>> out<-NULL
>>> r1<-raster(ncols=10,nrows=10)
>>> r1[]<-sample(0:1,100,replace=TRUE)
>>> for(i in 1:ncell(r1)){
>>>     if(r1[i]==1){
>>>
>>> lines<-SpatialLines(list(Lines(list(Line(matrix(c(xyFromCell(r1,i)+(res(r1)/2),xyFromCell(r1,i)-(res(r1)/2)),ncol=2,byrow=TRUE))),ID=as.character(i))))
>>>       if(is.null(out)){
>>>         out<-lines }
>>>          else {out<-spRbind(out,lines)}
>>>       }
>>>     print(i)
>>> }
>>>
>>> Thank you in advance,
>>
>>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pingyang.whu at gmail.com  Mon May 13 19:13:09 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 13 May 2013 13:13:09 -0400
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <8738trnwqj.fsf@krugs.de>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
Message-ID: <CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/ea216e56/attachment.pl>

From ubuntero.9161 at gmail.com  Mon May 13 22:16:03 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Mon, 13 May 2013 23:16:03 +0300
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
Message-ID: <CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>

On Mon, May 13, 2013 at 8:13 PM, ping yang <pingyang.whu at gmail.com> wrote:
> Dear Ivailo,
>
> Is this method can be used to quantify the spatial variability of two
> raster grids? Or Is there other measurement will be better to do this?

Dear Ping,

according to the author of the KappaV package (Vincent Bonhomme),
rasterizing the vectorial mosaics would be "neither elegant nor exact"
and that's why he implemented the calculation of the confusion matrix
(i.e. the matrix quantifying the mismatches in different regions of
the mosaic)  directly from the vector maps.

> Previously I posted a topic on how to compare two grids regarding to see
> the difference on spatial variabilities(e.g. two temperature grids). I am
> still wondering how to do it.

I am not aware of any R code to do such a comparison on raster
objects, and Cohen?s Kappa just quantifies the degree of agreement
between the two mosaics of interest. While writing this post I found a
software package at http://www.riks.nl/mck/ called the "Map Comparison
Kit" that might lead you further in your efforts.

HTH,
Ivailo
--
UBUNTU: a person is a person through other persons.


From s6lihert at uni-bonn.de  Mon May 13 22:16:25 2013
From: s6lihert at uni-bonn.de (Lionel)
Date: Mon, 13 May 2013 22:16:25 +0200
Subject: [R-sig-Geo] Drawing lines in raster cells
In-Reply-To: <CANtt_hwAPZYK_LZufr-vBLsDg5NerQxuac15osRhROQ0tjnXfQ@mail.gmail.com>
References: <518E9CC9.3060308@uni-bonn.de> <87y5bkz37y.fsf@gmail.com>
	<518FBA18.70205@uni-bonn.de>
	<CANtt_hwAPZYK_LZufr-vBLsDg5NerQxuac15osRhROQ0tjnXfQ@mail.gmail.com>
Message-ID: <51914A19.3020604@uni-bonn.de>

Yes, this is it, thank you very much for your help.
Lionel

On 13/05/2013 18:42, Robert J. Hijmans wrote:
> Lionel, perhaps this is what you are after. Robert
>
> library(raster)
> library(rgeos)
>
> r <- raster(ncols=10,nrows=10)
> set.seed(0)
> r[] <- sample(0:1,100,replace=TRUE)
>
> p <- rasterToPolygons(r, fun=function(x){x==1}, dissolve=TRUE)
>
> plot(r)
> plot(p, add=T, density=4)
>
>
>
> On Sun, May 12, 2013 at 8:49 AM, Lionel <s6lihert at uni-bonn.de> wrote:
>> Hi Oscar,
>>
>> Thanks for your help, what I would like to get is something similar to this:
>> http://www.google.fr/imgres?q=species+range+shift&start=280&um=1&sa=N&hl=fr&biw=1366&bih=647&tbm=isch&tbnid=MdhZVMKVLMSH3M:&imgrefurl=http://www.scielo.sa.cr/scielo.php%3Fscript%3Dsci_arttext%26pid%3DS0034-77442008000200028&docid=9u3QDKVd0hdQqM&imgurl=http://www.scielo.sa.cr/img/revistas/rbt/v56n2/art28i2.jpg&w=363&h=432&ei=cbiPUe_4BqO80QX-hoCIBw&zoom=1&iact=hc&vpx=588&vpy=170&dur=342&hovh=180&hovw=152&tx=83&ty=124&page=10&tbnh=159&tbnw=134&ndsp=30&ved=1t:429,r:84,s:200,i:256
>>
>> Where each raster cells with a certain values (say 1) get crossed by a
>> diagonal line.
>>
>> Your code is achieving something different, concerning the object created
>> the best would be a Spatial* object, however I think I could be able to find
>> a way around using ggmap.
>>
>> Thanks again,
>> Lionel
>>
>>
>> On 12/05/2013 16:23, Oscar Perpi??n Lamigueiro wrote:
>>>
>>> Hi Lionel,
>>>
>>> With this code you will draw lines connecting raster cells with a
>>> certain value. I am not sure if you also need to build a SpatialLines
>>> object with them (which you won't get with my code):
>>>
>>> library(raster)
>>> library(latticeExtra) ## to use +.trellis and layer()
>>>
>>> r1<-raster(ncols=10,nrows=10)
>>> r1[]<-sample(0:1,100,replace=TRUE)
>>>
>>> ## extract coordinates of those cells with a condition
>>> myCells <- Which(r1==1, cells=TRUE)
>>> xy <- xyFromCell(r1, myCells)
>>>
>>> ## border and border.lwd are only needed to highlight the cells boundaries
>>> spplot(r1, at=c(0, 0.5, 1), border='black', border.lwd=0.3) +
>>>       layer(llines(xy, type='b', col='black'))
>>>
>>>
>>> Best,
>>>
>>> Oscar.
>>>
>>> Lionel <s6lihert at uni-bonn.de> writes:
>>>
>>>> Dear List,
>>>>
>>>> I would like to draw lines in raster cells with a certain values, I can
>>>> work around this with a for loop but as always this solution only works
>>>> for small datasets (which is not my case), I would therefore like to
>>>> have your opinion on this;
>>>>
>>>> #the code
>>>> library(maptools) #to use spRbind
>>>> out<-NULL
>>>> r1<-raster(ncols=10,nrows=10)
>>>> r1[]<-sample(0:1,100,replace=TRUE)
>>>> for(i in 1:ncell(r1)){
>>>>      if(r1[i]==1){
>>>>
>>>> lines<-SpatialLines(list(Lines(list(Line(matrix(c(xyFromCell(r1,i)+(res(r1)/2),xyFromCell(r1,i)-(res(r1)/2)),ncol=2,byrow=TRUE))),ID=as.character(i))))
>>>>        if(is.null(out)){
>>>>          out<-lines }
>>>>           else {out<-spRbind(out,lines)}
>>>>        }
>>>>      print(i)
>>>> }
>>>>
>>>> Thank you in advance,
>>>
>>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From sjmyers3142 at gmail.com  Mon May 13 22:47:40 2013
From: sjmyers3142 at gmail.com (Seth Myers)
Date: Mon, 13 May 2013 16:47:40 -0400
Subject: [R-sig-Geo] calculating join count expectation and variance when
 edge effect are of interest?
Message-ID: <CAO-WCxdTztOHRdyRvLW4Lc6c6zs5QOaewcjzS5bUq0GeLDRPrg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130513/6fbf1c4b/attachment.pl>

From r.hijmans at gmail.com  Tue May 14 07:36:35 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 13 May 2013 22:36:35 -0700
Subject: [R-sig-Geo] colortables in raster
In-Reply-To: <CAAcGz9-00d5bvge9zwf9yqjsCMzobosnvYEtGT_ES=BC3+PdSw@mail.gmail.com>
References: <CAAcGz9-00d5bvge9zwf9yqjsCMzobosnvYEtGT_ES=BC3+PdSw@mail.gmail.com>
Message-ID: <CANtt_hxNLyb0qMggOgZaCVb6L1=zcrb6a4CW=arQya_v-sXzfQ@mail.gmail.com>

Mike, The legend slot exist for that kind of applications but the code
to use it has not yet been written (at least not by me); In the raster
package it is currently only used for color tables. Robert

On Mon, May 6, 2013 at 10:52 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> Hello, I would like to use the @legend feature of raster to somehow
> provide an absolute pallete across different objects. I thought
> originally that I could just set the @legend at values and
> @legend at colortable:
>
>
> r <- raster(volcano)
> r at legend@values <- seq(min(volcano), max(volcano), length = 125)
> r at legend@colortable <- heat.colors(124)
>
> ## but, this doesn't work right since the getValues(r) should be
> indices into r at legend@colortable
> plot(r)
>
> ## we can recompute the values as indices, so it works
> vs <- getValues(r)
>
> r <- setValues(r, 1 + (124 * (vs - min(vs))/diff(range(vs))))
> plot(r)
>
> But, I would like to use the embedded legend like this in order to
> keep the original range of getValues(r), but have the plotting build
> the appropriate (absolute) colour map
> from the @legend object. I'd also like it show the drawn legend when
> the plot is done (like in .plotraster), rather than it being dropped
> (as in .plotCT).
>
> Is there any way to do this currently, other than to explicitly
> provide the "col" and "breaks" arguments for plotting?  I appreciate
> that I'm probably missing something obvious hacking around here.
>
> Cheers, Mike.
>
>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Tue May 14 07:37:25 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 13 May 2013 22:37:25 -0700
Subject: [R-sig-Geo]
	=?windows-1252?q?How_select_the_=93contour=94_cells_o?=
	=?windows-1252?q?f_a_raster_file?=
In-Reply-To: <1368191202275-7583540.post@n2.nabble.com>
References: <1368191202275-7583540.post@n2.nabble.com>
Message-ID: <CANtt_hxgRjfN+SsmcKh-KvdqrjKQsJ-bXTUQ3bsmekygGKg_mw@mail.gmail.com>

Camille, see ?edge
Robert

On Fri, May 10, 2013 at 6:06 AM, Camille Leclerc
<camille.leclerc at ymail.com> wrote:
> Dear all,
>
> I will expose my issue with an example: I have a temperature raster at world
> scale and I want select or identify the ?contour? cells of this raster. More
> clearly, I define ?contour? cells as cells which are adjacent to ocean. The
> issue is that my raster file contains only terrestrial data and no ocean
> data. I looked the functions of the raster package like clump() but it
> doesn?t resolve my issue.
> I have no idea how resolve this? Must I create an ocean raster or a simple
> function exists?
>
> Best,
> Camille
> --
> Camille Leclerc
> Post-Master student
> Lab ESE, UMR CNRS 8079
> Univ Paris-Sud
> Bat 362
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-select-the-contour-cells-of-a-raster-file-tp7583540.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Rainer at krugs.de  Tue May 14 09:57:51 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 14 May 2013 09:57:51 +0200
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
	(Ivailo's message of "Mon, 13 May 2013 23:16:03 +0300")
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
	<CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
Message-ID: <87ppwuvvr4.fsf@krugs.de>

Ivailo <ubuntero.9161 at gmail.com> writes:

> On Mon, May 13, 2013 at 8:13 PM, ping yang <pingyang.whu at gmail.com> wrote:
>> Dear Ivailo,
>>
>> Is this method can be used to quantify the spatial variability of two
>> raster grids? Or Is there other measurement will be better to do this?

The earth movers distance might be one option to quantify *differences*
between maps. It is not clear to me, what you mean by "spatial
variability of two raster maps" - do you want to determine the spatial
variability of each raster map and then compare the two afterwards?  

Earth mover distance and e.g. mallow distance are implemented in R -
please see precious email for links to emd implementations in R.

Cheers,

Rainer

>
> Dear Ping,
>
> according to the author of the KappaV package (Vincent Bonhomme),
> rasterizing the vectorial mosaics would be "neither elegant nor exact"
> and that's why he implemented the calculation of the confusion matrix
> (i.e. the matrix quantifying the mismatches in different regions of
> the mosaic)  directly from the vector maps.
>
>> Previously I posted a topic on how to compare two grids regarding to see
>> the difference on spatial variabilities(e.g. two temperature grids). I am
>> still wondering how to do it.
>
> I am not aware of any R code to do such a comparison on raster
> objects, and Cohen?s Kappa just quantifies the degree of agreement
> between the two mosaics of interest. While writing this post I found a
> software package at http://www.riks.nl/mck/ called the "Map Comparison
> Kit" that might lead you further in your efforts.
>
> HTH,
> Ivailo
> --
> UBUNTU: a person is a person through other persons.


-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From Roger.Bivand at nhh.no  Tue May 14 10:47:33 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 May 2013 10:47:33 +0200
Subject: [R-sig-Geo] calculating join count expectation and variance
 when edge effect are of interest?
In-Reply-To: <CAO-WCxdTztOHRdyRvLW4Lc6c6zs5QOaewcjzS5bUq0GeLDRPrg@mail.gmail.com>
References: <CAO-WCxdTztOHRdyRvLW4Lc6c6zs5QOaewcjzS5bUq0GeLDRPrg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305141037590.21615@reclus.nhh.no>

On Mon, 13 May 2013, Seth Myers wrote:

> Question: Any suggestions on calculating the expectation and variance of BW
> joins on a raster/matrix where edge effects are not treated as a nuisance
> but rather are included in the calculation?

Interesting question! My feeling would be that your shortest route to a 
resolution is to use Monte Carlo simulation instead of analytical 
variances.

However, you may need to work out how to model the actual memory process 
over time, which would lead to a parametric bootstrap, or possibly a 
Bayesian model.

This feels somewhat like state-space modelling, where you are interested 
in the probability of a raster cell changing category, conditional on its 
neighbours' status and change history. There was a JSS special number on 
state space modelling recently (but I may be barking up the wrong tree!).

Hope this helps,

Roger

>
> Background:
>
> Let's say I have a raster (or matrix) that is NxN cells. The cells take on
> values of 0 or 1 (W or B).
>
> The outer edge of this raster (cell[ ,1] or cell [ ,N] or cell [1, ] or
> cell [N, ]) can be 0s or 1s.  Let's say for argument that the edge as
> defined is composed of all 1 values and this is known a prior and does not
> change.
>
> Now, the interior of the raster (all cells not part of edge) take on values
> of 0 or 1 with a certain probability(cell=1)=[whatever value is most
> appropriate in the context].
>
> I would like to know the expected value for 1-0 (or BW) joins over the
> entire NxN raster given that the edge is set and joins with the edges
> "count" toward the final tally of BW joins but the interior cells are 1s
> (or black) with a certain probability.  Also, I would like to know the
> variance of BW joins over the entire NxN raster given these same conditions.
>
> I am interested because the "edge" in this analysis represents a previous
> landscape and I would like to know what the future can hold given previous
> conditions (the "memory" or "hysteresis" of the landscape going into the
> future).
>
> I am flexible on whether free sampling or non-free sampling is assumed,
> with a guess that free sampling will be more tractable.  Also, for
> simplicity, I would stick with rook case joins and only first neighbors
> (directly adjacent cells).
>
> I have searched for a function that computes join counts while taking into
> account edge effects, but have come up empty handed.
>
> I have looked at how expectations of BW joins and the variances are
> computed, and I believe another day of work will result in code where I can
> get the expectation under free sampling while taking into account the edge.
> That is because the expectation calculation is rather straightforward.
> However, I do not understand the variance calculation well enough to know
> how to proceed on it.
>
> Any input is appreciated.
>
> Seth Myers
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rossahmed at googlemail.com  Tue May 14 13:22:48 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Tue, 14 May 2013 12:22:48 +0100
Subject: [R-sig-Geo] spTransform error
Message-ID: <CDB7DD18.4C88%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130514/696dbaed/attachment.pl>

From rossahmed at googlemail.com  Tue May 14 16:08:27 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Tue, 14 May 2013 15:08:27 +0100
Subject: [R-sig-Geo] gArea() units
Message-ID: <CDB803EB.4C9B%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130514/4c80dc65/attachment.pl>

From j.m.signer at gmail.com  Tue May 14 16:20:20 2013
From: j.m.signer at gmail.com (Johannes Signer)
Date: Tue, 14 May 2013 16:20:20 +0200
Subject: [R-sig-Geo] gArea() units
In-Reply-To: <CDB803EB.4C9B%rossahmed@gmail.com>
References: <CDB803EB.4C9B%rossahmed@gmail.com>
Message-ID: <CAC8qavvqrCiz1vYXWP1gDQLECgLT_q3NWmLcOAZbUsJ3UHRvWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130514/aa285a56/attachment.pl>

From pingyang.whu at gmail.com  Tue May 14 19:02:16 2013
From: pingyang.whu at gmail.com (Ping Yang)
Date: Tue, 14 May 2013 13:02:16 -0400
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <87ppwuvvr4.fsf@krugs.de>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
	<CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
	<87ppwuvvr4.fsf@krugs.de>
Message-ID: <3D18D0DF-862D-4281-B72A-50DE6C95E8DA@gmail.com>

What I planned to do is do generate a spatial variability map of each raster and then compare them to get the difference between them. 

Or. Any comments when comparing two tasters to find out the differences and similarity between them .

Thanks,

Ping 




On May 14, 2013, at 3:57 AM, Rainer at krugs.de (Rainer M. Krug) wrote:

> Ivailo <ubuntero.9161 at gmail.com> writes:
> 
>> On Mon, May 13, 2013 at 8:13 PM, ping yang <pingyang.whu at gmail.com> wrote:
>>> Dear Ivailo,
>>> 
>>> Is this method can be used to quantify the spatial variability of two
>>> raster grids? Or Is there other measurement will be better to do this?
> 
> The earth movers distance might be one option to quantify *differences*
> between maps. It is not clear to me, what you mean by "spatial
> variability of two raster maps" - do you want to determine the spatial
> variability of each raster map and then compare the two afterwards?  
> 
> Earth mover distance and e.g. mallow distance are implemented in R -
> please see precious email for links to emd implementations in R.
> 
> Cheers,
> 
> Rainer
> 
>> 
>> Dear Ping,
>> 
>> according to the author of the KappaV package (Vincent Bonhomme),
>> rasterizing the vectorial mosaics would be "neither elegant nor exact"
>> and that's why he implemented the calculation of the confusion matrix
>> (i.e. the matrix quantifying the mismatches in different regions of
>> the mosaic)  directly from the vector maps.
>> 
>>> Previously I posted a topic on how to compare two grids regarding to see
>>> the difference on spatial variabilities(e.g. two temperature grids). I am
>>> still wondering how to do it.
>> 
>> I am not aware of any R code to do such a comparison on raster
>> objects, and Cohen?s Kappa just quantifies the degree of agreement
>> between the two mosaics of interest. While writing this post I found a
>> software package at http://www.riks.nl/mck/ called the "Map Comparison
>> Kit" that might lead you further in your efforts.
>> 
>> HTH,
>> Ivailo
>> --
>> UBUNTU: a person is a person through other persons.
> 
> 
> -- 
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)
> 
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
> 
> Tel :       +33 - (0)9 53 10 27 44
> Cell:       +33 - (0)6 85 62 59 98
> Fax :       +33 - (0)9 58 10 27 44
> 
> Fax (D):    +49 - (0)3 21 21 25 22 44
> 
> email:      Rainer at krugs.de
> 
> Skype:      RMkrug


From thi_veloso at yahoo.com.br  Tue May 14 19:40:14 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Tue, 14 May 2013 10:40:14 -0700 (PDT)
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <3D18D0DF-862D-4281-B72A-50DE6C95E8DA@gmail.com>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
	<CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
	<87ppwuvvr4.fsf@krugs.de>
	<3D18D0DF-862D-4281-B72A-50DE6C95E8DA@gmail.com>
Message-ID: <1368553214.87257.YahooMailNeo@web121903.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130514/a11288dd/attachment.pl>

From Roger.Bivand at nhh.no  Tue May 14 23:33:17 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 May 2013 23:33:17 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <CDB7DD18.4C88%rossahmed@gmail.com>
References: <CDB7DD18.4C88%rossahmed@gmail.com>
Message-ID: <alpine.LRH.2.03.1305142330130.23291@reclus.nhh.no>

On Tue, 14 May 2013, Ross Ahmed wrote:

> I get the following error when running SpTransform, and error is occurring
> not matter what object I try to transform:
>
> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>  error in evaluating the argument 'CRSobj' in selecting a method for
> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") : no
> system list, errno: 2
>

You must include all of the important information: all of sessionInfo() 
output, all of the startup messages given by rgdal on loading, and a 
reasonable example (this one isn't, the actual projection is unknown). I 
think you have installed rgdal from source on a system without the 
necessary extra files, but without knowledge of how you installed rgdal, 
it is not possible to tell.

Roger

>
>
> I?ve tried to replicate my code using the columbus SpatialPolygonsDataFrame
> from maptools package:
>
> setwd(system.file("shapes", package="maptools"))
> columbus <- readShapeSpatial(?columbus.shp?)
> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
> +towgs84=0,0,0")
> spTransform(columbus, CRS("+init=epsg:4326?))
>
> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>  error in evaluating the argument 'CRSobj' in selecting a method for
> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") : no
> system list, errno: 2
>
>
>
> I?m using R 3.0.0
>
> Ross
>
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue May 14 23:38:47 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 May 2013 23:38:47 +0200
Subject: [R-sig-Geo] gArea() units
In-Reply-To: <CDB803EB.4C9B%rossahmed@gmail.com>
References: <CDB803EB.4C9B%rossahmed@gmail.com>
Message-ID: <alpine.LRH.2.03.1305142333400.23291@reclus.nhh.no>

On Tue, 14 May 2013, Ross Ahmed wrote:

> Hi all
>
> The documentation for gArea() says the units of area are based on the
> current projection. The polygon below is in longlat, and in my primative
> understanding, the units should be square metres. The output is  0.000828375
> but I know the approximate area of this polygon is 4.45 square kilometres.
> Using gArea(), how can I calculate the area of the polygon below in units of
> square kilometres?

You cannot, GEOS only works on planar, that is projected, geometries. 
There are alternatives, either project, or use areaPolygon in geosphere.

Roger

>
> library(sp); library(rgeos)
> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
> p = Polygon(polygonCoords)
> myPolygon = Polygons(list(p),1)
> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>
> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
> +ellps=WGS84 +towgs84=0,0,0")
>
> gArea(myPolygonSpatial)
> # output is [1] 0.000828375
> # area in square kilometres is circa 4.45 square kilometres
>
>
> Thanks
> Ross
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Tue May 14 23:51:19 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 15 May 2013 07:51:19 +1000
Subject: [R-sig-Geo] gArea() units
In-Reply-To: <CAC8qavvqrCiz1vYXWP1gDQLECgLT_q3NWmLcOAZbUsJ3UHRvWQ@mail.gmail.com>
References: <CDB803EB.4C9B%rossahmed@gmail.com>
	<CAC8qavvqrCiz1vYXWP1gDQLECgLT_q3NWmLcOAZbUsJ3UHRvWQ@mail.gmail.com>
Message-ID: <CAAcGz99gaHNaa8yJ-dWeQKnwKc1d1M+whyEE0LPhYAmRRz-P1g@mail.gmail.com>

I would strongly advise against using EPSG:32640 for any region that
is not nearby to longitude 57E (where "nearby" means within about 6
degrees of longitude (but I'm very wary of providing advice here it's
something I'm not expert in).

Projection choice is really important, and UTM is simply not
appropriate for many applications (in the same way that no projection
is appropriate for all applications). It's certainly not appropriate
to use a UTM zone that is far from the region of study.

Look at the numbers that come out:

## my best-guess
gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92 +
+lat_0=55.7 +datum=WGS84")))/1e6
[1] 5.796854

## UTM that is for a region 56 zones away(!)
gArea(spTransform(myPolygonSpatial, CRS("+init=epsg:32640")))/1e6
[1] 7.475327

A better choice if you must use UTM, would be the right zone:

gArea(spTransform(myPolygonSpatial, CRS("+init=epsg:32631")))/1e6
[1] 5.805833

As Roger points out there is areaPolygon() in geosphere, a good way to
do a check on whether we are in the right ball-park:

areaPolygon(myPolygonSpatial)/1e6
[1] 5.782704

Another thing to worry about if you are reprojecting to get the
calculation properties that you need is the amount of "segmentation"
in the geometry. A "straight-line" in one projection defined by only
two end points can be a rather curved shape in another projection, and
so the shape itself can only be preserved by inserting extra
"redundant" points first. That's not a problem in this particular
example for such a small area on the Earth, though the wrong UTM zone
really is a problem.  (Sometimes itt just depends on the specifics to
an example. . . )


I don't want to get into advising about projections without doing a
lot more work of my own to ensure my advice is sound, but please be
aware that this is something that needs quite a lot of thought by the
user, or alternatively---expert local advice.


Cheers, Mike.

On Wed, May 15, 2013 at 12:20 AM, Johannes Signer <j.m.signer at gmail.com> wrote:
> Hi Ross,
>
> you result is in square degrees, you will need to project your data to
> planar coordinates.
>
> You could do for example:
>
> library(rgeos)
> library(rgdal)
> library(sp)
>
> myPoly <- spTransform(myPolygonSpatial, CRS("+init=epsg:32640"))
>
> # the area in m2
>  gArea(myPoly)
>
> # or in km2
> gArea(myPoly) / 1e6
>
> HTH
>
> Johannes
>
>
>
>
> On Tue, May 14, 2013 at 4:08 PM, Ross Ahmed <rossahmed at googlemail.com>wrote:
>
>> Hi all
>>
>> The documentation for gArea() says the units of area are based on the
>> current projection. The polygon below is in longlat, and in my primative
>> understanding, the units should be square metres. The output is
>>  0.000828375
>> but I know the approximate area of this polygon is 4.45 square kilometres.
>> Using gArea(), how can I calculate the area of the polygon below in units
>> of
>> square kilometres?
>>
>> library(sp); library(rgeos)
>> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
>> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
>> p = Polygon(polygonCoords)
>> myPolygon = Polygons(list(p),1)
>> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>>
>> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
>> +ellps=WGS84 +towgs84=0,0,0")
>>
>> gArea(myPolygonSpatial)
>> # output is [1] 0.000828375
>> # area in square kilometres is circa 4.45 square kilometres
>>
>>
>> Thanks
>> Ross
>>
>>
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
>
> ## ## Contact:
> ## Johannes Signer, MSc
> ## PhD-Candidate -- Wildlife Management
> ## Dept. of Forest Zoology & Forest Conservation
> ## University of Goettingen
> ## Buesgenweg 3 (room 85)
> ## 37077 Goettingen, Germany
> ## e: jmsigner at gmail.com
> ## p: +49 (0)551 39 3583
> ## m: +49 (0)176 61 962856
> ## skype: j.m.signer
> ## ##
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Andy.Bunn at wwu.edu  Wed May 15 00:42:46 2013
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Tue, 14 May 2013 22:42:46 +0000
Subject: [R-sig-Geo] netcdf library on OS X
In-Reply-To: <CDB7F30B.9586%andy.bunn@wwu.edu>
Message-ID: <CDB80BA7.9590%andy.bunn@wwu.edu>

R-Sig_Geo people:

I was a former user of RNetCDF under Windows. I've switched to Mac and all is well. Almost all. RNetCDF (reasonably) would like to have netcdf and udunits from unidata installed on the machine prior to using the RNetCDF. Correct? And, unless I am missing something basic it appears that I have to install those tools from src and not from a prebuilt binary. Is that correct? I am willing to do so but think it's unlikely that's the way most folks do it. Not to be a luddite, but isn't there a DMG with netcdf and udunits for Os X out there?

If I do install from source, looking at the docs it appears I would try something like:
tar -xzvf netcdf-4.3.0.tar.gz
cd netcdf-4.3.0
./configure --disable-netcdf-4 --enable-shared
make check install


Does that seem right?

-Andy


From distem at rpi.edu  Wed May 15 01:11:39 2013
From: distem at rpi.edu (Massimo Di Stefano)
Date: Tue, 14 May 2013 19:11:39 -0400
Subject: [R-sig-Geo] problem installing GSIF on mac osx - object spTransform
	is not exported by namespace:sp
Message-ID: <56EFC254-B469-4D22-A33D-959A00B695CC@rpi.edu>

Hi All,

Hi All,

i was trying to install GSIF  on osx 10.8 but i can't figure out the following error :

Error : object ?spTransform? is not exported by 'namespace:sp'

do you have any idea on how to debug the problem ?

thanks for any advice!

Massimo.


this the full log (i've the same log trying to use R CMD INSTALL GSIF.tar.gz,  from command line):


provo con l'URL 'http://cran.fhcrc.org/src/contrib/GSIF_0.3-2.tar.gz'
Content type 'application/x-gzip' length 894194 bytes (873 Kb)
URL aperto
==================================================
downloaded 873 Kb

* installing *source* package ?GSIF? ...
** package ?GSIF? successfully unpacked and MD5 sums checked
** R
** data
** inst
** preparing package for lazy loading
Error : object ?spTransform? is not exported by 'namespace:sp'
ERROR: lazy loading failed for package ?GSIF?
* removing ?/usr/local/Cellar/r/3.0.0/R.framework/Versions/3.0/Resources/library/GSIF?

The downloaded source packages are in
	?/private/var/folders/b6/0rr0qlhs5cg0svl13bhz8htw0000gn/T/RtmpJzfXUX/downloaded_packages?
> sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-apple-darwin12.3.0 (64-bit)

locale:
[1] it_IT.UTF-8/it_IT.UTF-8/it_IT.UTF-8/C/it_IT.UTF-8/it_IT.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_3.0.0
Warning message:
In install.packages(c("GSIF"), lib = "/Library/Frameworks/R.framework/Resources/library/",  :
  installation of package ?GSIF? had non-zero exit status
> 

From chris.waigl at gi.alaska.edu  Wed May 15 01:21:43 2013
From: chris.waigl at gi.alaska.edu (Chris Waigl)
Date: Tue, 14 May 2013 15:21:43 -0800
Subject: [R-sig-Geo] netcdf library on OS X
In-Reply-To: <CDB80BA7.9590%andy.bunn@wwu.edu>
References: <CDB80BA7.9590%andy.bunn@wwu.edu>
Message-ID: <791543C7-CCA0-4A5C-BD11-033BC6180C5D@gi.alaska.edu>


On May 14, 2013, at 2:42 PM, Andy Bunn wrote:

> I was a former user of RNetCDF under Windows. I've switched to Mac and all is well. Almost all. RNetCDF (reasonably) would like to have netcdf and udunits from unidata installed on the machine prior to using the RNetCDF. Correct? And, unless I am missing something basic it appears that I have to install those tools from src and not from a prebuilt binary. Is that correct? I am willing to do so but think it's unlikely that's the way most folks do it. Not to be a luddite, but isn't there a DMG with netcdf and udunits for Os X out there?
> 
> If I do install from source, looking at the docs it appears I would try something like:
> tar -xzvf netcdf-4.3.0.tar.gz
> cd netcdf-4.3.0
> ./configure --disable-netcdf-4 --enable-shared
> make check install

I have had good experience following the instructions to install NetCDF from source as described here: http://www.unidata.ucar.edu/software/netcdf/docs/building.html (both Fortran and C libraries for my own use case). This was once on OS X and multiple times on GNU/Linux. This is if you REALLY want to go the install-from-source route. 

HOWEVER. On OS X I have made very good experience with using the homebrew package management system http://mxcl.github.io/homebrew/ (or https://blog.engineyard.com/2010/homebrew-os-xs-missing-package-manager), including for NetCDF and udunits. This is currently the case on both my main environments where I call the libraries from R and from Python (plus use the NCO tools, NCView etc.).

Chris Waigl

From distem at rpi.edu  Wed May 15 01:32:22 2013
From: distem at rpi.edu (Massimo Di Stefano)
Date: Tue, 14 May 2013 19:32:22 -0400
Subject: [R-sig-Geo] problem installing GSIF on mac osx - object
	spTransform is not exported by namespace:sp
In-Reply-To: <56EFC254-B469-4D22-A33D-959A00B695CC@rpi.edu>
References: <56EFC254-B469-4D22-A33D-959A00B695CC@rpi.edu>
Message-ID: <DE4DA307-1CDA-4224-AA18-507904DC9659@rpi.edu>

Answering myself (apologize for the noise)
i had to "update" my packages with :   

update.packages()  # installing from source with dependencies True 

then SGIF installed correctly without errors.

thanks

Massimo.

Il giorno 14/mag/2013, alle ore 19:11, Massimo Di Stefano <distem at rpi.edu> ha scritto:

> Hi All,
> 
> Hi All,
> 
> i was trying to install GSIF  on osx 10.8 but i can't figure out the following error :
> 
> Error : object ?spTransform? is not exported by 'namespace:sp'
> 
> do you have any idea on how to debug the problem ?
> 
> thanks for any advice!
> 
> Massimo.
> 
> 
> this the full log (i've the same log trying to use R CMD INSTALL GSIF.tar.gz,  from command line):
> 
> 
> provo con l'URL 'http://cran.fhcrc.org/src/contrib/GSIF_0.3-2.tar.gz'
> Content type 'application/x-gzip' length 894194 bytes (873 Kb)
> URL aperto
> ==================================================
> downloaded 873 Kb
> 
> * installing *source* package ?GSIF? ...
> ** package ?GSIF? successfully unpacked and MD5 sums checked
> ** R
> ** data
> ** inst
> ** preparing package for lazy loading
> Error : object ?spTransform? is not exported by 'namespace:sp'
> ERROR: lazy loading failed for package ?GSIF?
> * removing ?/usr/local/Cellar/r/3.0.0/R.framework/Versions/3.0/Resources/library/GSIF?
> 
> The downloaded source packages are in
> 	?/private/var/folders/b6/0rr0qlhs5cg0svl13bhz8htw0000gn/T/RtmpJzfXUX/downloaded_packages?
>> sessionInfo()
> R version 3.0.0 (2013-04-03)
> Platform: x86_64-apple-darwin12.3.0 (64-bit)
> 
> locale:
> [1] it_IT.UTF-8/it_IT.UTF-8/it_IT.UTF-8/C/it_IT.UTF-8/it_IT.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> loaded via a namespace (and not attached):
> [1] tools_3.0.0
> Warning message:
> In install.packages(c("GSIF"), lib = "/Library/Frameworks/R.framework/Resources/library/",  :
>  installation of package ?GSIF? had non-zero exit status


From sjmyers3142 at gmail.com  Wed May 15 07:08:27 2013
From: sjmyers3142 at gmail.com (Seth Myers)
Date: Wed, 15 May 2013 01:08:27 -0400
Subject: [R-sig-Geo] calculating join count expectation and variance
 when edge effect are of interest?
In-Reply-To: <alpine.LRH.2.03.1305141037590.21615@reclus.nhh.no>
References: <CAO-WCxdTztOHRdyRvLW4Lc6c6zs5QOaewcjzS5bUq0GeLDRPrg@mail.gmail.com>
	<alpine.LRH.2.03.1305141037590.21615@reclus.nhh.no>
Message-ID: <CAO-WCxd_P40Laq_rNZgz_6fBSsDJc1_SztUhokJ+pd5+4PtENg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130515/76b933c9/attachment.pl>

From rossahmed at googlemail.com  Wed May 15 08:34:19 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Wed, 15 May 2013 07:34:19 +0100
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <alpine.LRH.2.03.1305142330130.23291@reclus.nhh.no>
Message-ID: <CDB8EAF2.4CDF%rossahmed@gmail.com>

I?ve recently reinstalled QGIS - might this have anything to do with it?


# spTransform() works fine in the other example I posted to the group
yesterday:

library(sp); library(rgeos); library(rgdal)
polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
p = Polygon(polygonCoords)
myPolygon = Polygons(list(p),1)
myPolygonSpatial = SpatialPolygons(list(myPolygon))
proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
+ellps=WGS84 +towgs84=0,0,0")
gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
+lat_0=55.7 +datum=WGS84")))/1e6
#[1] 5.796854




# But spTransform() fails in all other instances, for example:

Library(maptools)
data(wrld_simpl)
spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
# Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
# error in evaluating the argument 'CRSobj' in selecting a method for
function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
errno: 2








# rgdal() start up message

library(rgdal)
Loading required package: sp
rgdal: version: 0.8-9, (SVN revision 470)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files:
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)






# sessionInfo() output

sessionInfo()

R version 3.0.0 (2013-04-03)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] tcltk stats4 splines grid stats graphics grDevices utils datasets
methods
[11] base

other attached packages:
[1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
[5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
[9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
[13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
[17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
[21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
[25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
[29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
[33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
[37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
[41] rgeos_0.2-17 sp_1.0-9

loaded via a namespace (and not attached):
[1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
evaluate_0.4.3
[6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
[11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
[16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
tools_3.0.0






On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

>On Tue, 14 May 2013, Ross Ahmed wrote:
>
>> I get the following error when running SpTransform, and error is
>>occurring
>> not matter what object I try to transform:
>>
>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>  error in evaluating the argument 'CRSobj' in selecting a method for
>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>no
>> system list, errno: 2
>>
>
>You must include all of the important information: all of sessionInfo()
>output, all of the startup messages given by rgdal on loading, and a
>reasonable example (this one isn't, the actual projection is unknown). I
>think you have installed rgdal from source on a system without the
>necessary extra files, but without knowledge of how you installed rgdal,
>it is not possible to tell.
>
>Roger
>
>>
>>
>> I?ve tried to replicate my code using the columbus
>>SpatialPolygonsDataFrame
>> from maptools package:
>>
>> setwd(system.file("shapes", package="maptools"))
>> columbus <- readShapeSpatial(?columbus.shp?)
>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>> +towgs84=0,0,0")
>> spTransform(columbus, CRS("+init=epsg:4326?))
>>
>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>  error in evaluating the argument 'CRSobj' in selecting a method for
>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>no
>> system list, errno: 2
>>
>>
>>
>> I?m using R 3.0.0
>>
>> Ross
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>>
>
>-- 
>Roger Bivand
>Department of Economics, NHH Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no
>


From marion.jacquot at univ-fcomte.fr  Wed May 15 08:43:57 2013
From: marion.jacquot at univ-fcomte.fr (Marion Jacquot)
Date: Wed, 15 May 2013 08:43:57 +0200
Subject: [R-sig-Geo] strange variogram envelop
Message-ID: <51932EAD.8060203@univ-fcomte.fr>

I computed a variogram (function variog, geoR) on the residuals of a

linear model (myvariog). I computed the envelop by permutation of the
data values on the spatial locations (function variog.mc.env;  nsim=999).

  >  myvariog$n
[1]   37 1577   97  116   53 2053  342  550   30  460  248


For the largest distance class, I have got 248 pairs of points and the
envelop does not enlarge but converges to zero (see the attached
figure). Could anybody give me any hint about the process explaining
this convergence?
I suppose, giving the aspect of the variogram, that I could not modelise
it in order to take into account spatial autocorrelation in my linear
model (thanks argument correlation). What do you think about it?

Thanks for your help,
Regards,

Marion.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: variogram lm.pdf
Type: application/pdf
Size: 1993 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130515/716b125e/attachment.pdf>

From kridox at ymail.com  Wed May 15 09:43:24 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 15 May 2013 16:43:24 +0900
Subject: [R-sig-Geo] ggplot2, arrows and polar coordinates
Message-ID: <51933C9C.70802@ymail.com>

Dear R users,

This message was previously posted on r-help 
(https://stat.ethz.ch/pipermail/r-help/2013-March/349539.html). I 
re-post this message here, as it is probably more appropriate.

The following issue has been already documented, but, if I am not 
mistaken, not yet solved.

This issue appears while trying to plot arrows with "geom_segment" 
(package ggplot2), with polar coordinates ("coord_polar"). The direction 
of some arrows is wrong (red rectangle). Please find herewith an example.

Does someone know how to deal with that issue?

Best Regards,
Pascal Oettli


#----------------------------------------------------------------------------------
# Example adapted from the help page of "geom_segment"

library(ggplot2)
library(grid)

d <- data.frame(x1=-135.3, x2=-158.3, y1=37.2, y2=45.2)

p <- ggplot(seals, aes(x = long, y = lat))

p1 <-
   ggplot() +
   coord_cartesian() +
   geom_rect(data=d, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), 
fill="red", color="red", alpha=0.5) +
   geom_segment(data=seals, aes(x = long, y = lat, xend = long + 
delta_long, yend = lat + delta_lat), arrow = arrow(length = unit(0.2,"cm")))

p2 <-
   ggplot() +
   coord_polar() +
   geom_rect(data=d, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), 
fill="red", color="red", alpha=0.5) +
   geom_segment(data=seals, aes(x = long, y = lat, xend = long + 
delta_long, yend = lat + delta_lat), arrow = arrow(length = unit(0.2,"cm")))

grid.newpage()
pushViewport(viewport(layout = grid.layout(3, 2, heights = unit(c(0.5, 
0.5, 5), "null"))))
grid.text("Example taken from '?geom_segment'", vp = 
viewport(layout.pos.row = 1, layout.pos.col = 1:2))
grid.text("Cartesian coordinates", vp = viewport(layout.pos.row = 2, 
layout.pos.col = 1))
grid.text("Polar coordinates", vp = viewport(layout.pos.row = 2, 
layout.pos.col = 2))
print(p1, vp = viewport(layout.pos.row = 3, layout.pos.col = 1))
print(p2, vp = viewport(layout.pos.row = 3, layout.pos.col = 2))


From pingyang.whu at gmail.com  Wed May 15 19:38:17 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Wed, 15 May 2013 13:38:17 -0400
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <87ppwuvvr4.fsf@krugs.de>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
	<CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
	<87ppwuvvr4.fsf@krugs.de>
Message-ID: <CAK8gSG-K9WAgVrjTY-JC5yv6MMFSNh2bfJWpnjSjPTnoQ4BSUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130515/28f565f3/attachment.pl>

From Andy.Bunn at wwu.edu  Wed May 15 20:17:04 2013
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Wed, 15 May 2013 18:17:04 +0000
Subject: [R-sig-Geo] netcdf library on OS X
In-Reply-To: <791543C7-CCA0-4A5C-BD11-033BC6180C5D@gi.alaska.edu>
Message-ID: <CDB91EB9.95FF%andy.bunn@wwu.edu>



On 5/14/13 4:21 PM, "Chris Waigl" <chris.waigl at gi.alaska.edu> wrote:

>
>On May 14, 2013, at 2:42 PM, Andy Bunn wrote:
>
>> I was a former user of RNetCDF under Windows. I've switched to Mac and
>>all is well. Almost all. RNetCDF (reasonably) would like to have netcdf
>>and udunits from unidata installed on the machine prior to using the
>>RNetCDF. Correct? And, unless I am missing something basic it appears
>>that I have to install those tools from src and not from a prebuilt
>>binary. Is that correct? I am willing to do so but think it's unlikely
>>that's the way most folks do it. Not to be a luddite, but isn't there a
>>DMG with netcdf and udunits for Os X out there?
>> 
>> If I do install from source, looking at the docs it appears I would try
>>something like:
>> tar -xzvf netcdf-4.3.0.tar.gz
>> cd netcdf-4.3.0
>> ./configure --disable-netcdf-4 --enable-shared
>> make check install
>
>I have had good experience following the instructions to install NetCDF
>from source as described here:
>http://www.unidata.ucar.edu/software/netcdf/docs/building.html (both
>Fortran and C libraries for my own use case). This was once on OS X and
>multiple times on GNU/Linux. This is if you REALLY want to go the
>install-from-source route.
>
>HOWEVER. On OS X I have made very good experience with using the homebrew
>package management system http://mxcl.github.io/homebrew/ (or
>https://blog.engineyard.com/2010/homebrew-os-xs-missing-package-manager),
>including for NetCDF and udunits. This is currently the case on both my
>main environments where I call the libraries from R and from Python (plus
>use the NCO tools, NCView etc.).


Homebrew was wonderful. Thanks! It's all good to go now.

This was it:
ruby -e "$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)"
brew doctor
brew install netcdf
brew install udunits

Very slick. Thanks.





>
>Chris Waigl


From r.m.krug at gmail.com  Wed May 15 21:33:48 2013
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Wed, 15 May 2013 21:33:48 +0200
Subject: [R-sig-Geo] Raster comparrison
In-Reply-To: <CAGhLh6Eq8cjZAzyr4dRbmYWb4nO_zXMoTZV4OOsY87wCq2QyrA@mail.gmail.com>
References: <CAD-8SiMZLYKdJir0ZAR0d19_WV1Qfb-z4o_KKuZ3XCNTKC2YmQ@mail.gmail.com>
	<8738trnwqj.fsf@krugs.de>
	<CAK8gSG-aLsOK8AXgGy922OoZPCCb0yS3E4YDBHyj1H+L0B_+XA@mail.gmail.com>
	<CAAVnHsuSLVN=cbVUFNg1nAzhVLYNECatv33bGUVdwf52XKX84A@mail.gmail.com>
	<87ppwuvvr4.fsf@krugs.de>
	<CAK8gSG-K9WAgVrjTY-JC5yv6MMFSNh2bfJWpnjSjPTnoQ4BSUg@mail.gmail.com>
	<CAGhLh6Eq8cjZAzyr4dRbmYWb4nO_zXMoTZV4OOsY87wCq2QyrA@mail.gmail.com>
Message-ID: <CAGhLh6G24UZfgw_8-hyFD+zUzanf4GLTrcqKhH-yJ5ht9uN=CQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130515/c431b531/attachment.pl>

From Roger.Bivand at nhh.no  Wed May 15 22:23:14 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 May 2013 22:23:14 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <CDB8EAF2.4CDF%rossahmed@gmail.com>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
Message-ID: <alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>

On Wed, 15 May 2013, Ross Ahmed wrote:

> I?ve recently reinstalled QGIS - might this have anything to do with it?

Probably not.

>
>
> # spTransform() works fine in the other example I posted to the group
> yesterday:
>
> library(sp); library(rgeos); library(rgdal)
> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
> p = Polygon(polygonCoords)
> myPolygon = Polygons(list(p),1)
> myPolygonSpatial = SpatialPolygons(list(myPolygon))
> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
> +ellps=WGS84 +towgs84=0,0,0")
> gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
> +lat_0=55.7 +datum=WGS84")))/1e6
> #[1] 5.796854
>
>
>
>
> # But spTransform() fails in all other instances, for example:
>
> Library(maptools)
> data(wrld_simpl)
> spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
> # Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
> # error in evaluating the argument 'CRSobj' in selecting a method for
> function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
> errno: 2
>
>

The failure is caused by no proj (or gdal) data files being available.

>
>
>
>
>
>
> # rgdal() start up message
>
> library(rgdal)
> Loading required package: sp
> rgdal: version: 0.8-9, (SVN revision 470)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files:
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>

These are the clues:

Path to GDAL shared files:
Path to PROJ.4 shared files: (autodetected)

which should not look like this if you are on:

Platform: x86_64-apple-darwin10.8.0 (64-bit)

and installed rgdal as an OSX binary from CRAN. The current OSX binary is 
packaged without the proj/ and gdal/ subdirectories. I'll try to get them 
reinstated.

Roger

>
>
>
>
>
> # sessionInfo() output
>
> sessionInfo()
>
> R version 3.0.0 (2013-04-03)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] tcltk stats4 splines grid stats graphics grDevices utils datasets
> methods
> [11] base
>
> other attached packages:
> [1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
> [5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
> [9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
> [13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
> [17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
> [21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
> [25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
> [29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
> [33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
> [37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
> [41] rgeos_0.2-17 sp_1.0-9
>
> loaded via a namespace (and not attached):
> [1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
> evaluate_0.4.3
> [6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
> [11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
> [16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
> tools_3.0.0
>
>
>
>
>
>
> On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 14 May 2013, Ross Ahmed wrote:
>>
>>> I get the following error when running SpTransform, and error is
>>> occurring
>>> not matter what object I try to transform:
>>>
>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>> no
>>> system list, errno: 2
>>>
>>
>> You must include all of the important information: all of sessionInfo()
>> output, all of the startup messages given by rgdal on loading, and a
>> reasonable example (this one isn't, the actual projection is unknown). I
>> think you have installed rgdal from source on a system without the
>> necessary extra files, but without knowledge of how you installed rgdal,
>> it is not possible to tell.
>>
>> Roger
>>
>>>
>>>
>>> I?ve tried to replicate my code using the columbus
>>> SpatialPolygonsDataFrame
>>> from maptools package:
>>>
>>> setwd(system.file("shapes", package="maptools"))
>>> columbus <- readShapeSpatial(?columbus.shp?)
>>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>>> +towgs84=0,0,0")
>>> spTransform(columbus, CRS("+init=epsg:4326?))
>>>
>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>> no
>>> system list, errno: 2
>>>
>>>
>>>
>>> I?m using R 3.0.0
>>>
>>> Ross
>>>
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hughsturrock at hotmail.com  Thu May 16 02:07:41 2013
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Thu, 16 May 2013 01:07:41 +0100
Subject: [R-sig-Geo] Spatially autocorrelated random effects in logistic
	regression.
Message-ID: <DUB116-W3414EE6B601E68C60BB108C8A30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/88bd690b/attachment.pl>

From finleya at msu.edu  Thu May 16 04:12:02 2013
From: finleya at msu.edu (Andrew Finley)
Date: Wed, 15 May 2013 22:12:02 -0400
Subject: [R-sig-Geo] Spatially autocorrelated random effects in logistic
 regression.
In-Reply-To: <DUB116-W3414EE6B601E68C60BB108C8A30@phx.gbl>
References: <DUB116-W3414EE6B601E68C60BB108C8A30@phx.gbl>
Message-ID: <20130515221202.11814j24zd3zsprm@mail.msu.edu>

Hi Hugh,
Check out spGLM in the spBayes package. This should do what you need.  
Please let me know if you have any questions.
-Andy


Quoting Hugh Sturrock <hughsturrock at hotmail.com>:

> Hi all,
> I am trying to model binomial data (infection status) of people  
> living in households. I have run a logistic regression with a  
> household level random effect to account for correlation between  
> individuals within households. When I look at the value of the
random
> effect (intercept) at each household there appears to be residual  
> spatial autocorrelation (using Moran's I and semivariograms) between

> households. I would like to repeat the analyses accounting for this  
> spatial autocorrelation between households, i.e. between random  
> effects. I'm not a mathematician? but having done some reading it  
> seems as if this can't be done using the command glmmPQL in MASS,
but
> perhaps can be done using the geoRglm package. BUT, having read  
> through the geoRglm vignette, I'm still pretty clueless as to how to

> code such a model. If anyone could give me an example I would be  
> MASSIVELY appreciative.
> Thanks!Hugh
>
>
> ? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From alemu.tadesse at gmail.com  Thu May 16 07:53:00 2013
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Wed, 15 May 2013 23:53:00 -0600
Subject: [R-sig-Geo] adding maps to spplot
Message-ID: <CACGkHRPTwM5eL7NTLJhZ=LGn2jtkdY=VdfPDd1nuB7hZu0AOmQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130515/ad91ba9d/attachment.pl>

From raffaele.morelli at gmail.com  Thu May 16 08:06:21 2013
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Thu, 16 May 2013 08:06:21 +0200
Subject: [R-sig-Geo] adding maps to spplot
In-Reply-To: <CACGkHRPTwM5eL7NTLJhZ=LGn2jtkdY=VdfPDd1nuB7hZu0AOmQ@mail.gmail.com>
References: <CACGkHRPTwM5eL7NTLJhZ=LGn2jtkdY=VdfPDd1nuB7hZu0AOmQ@mail.gmail.com>
Message-ID: <CAD4guxMMZ0LVY4gvZq_B0+2QADhdJ4Bxak9HKr7H=NaNnRQX7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/ac9ac910/attachment.pl>

From rossahmed at googlemail.com  Thu May 16 15:16:03 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Thu, 16 May 2013 14:16:03 +0100
Subject: [R-sig-Geo] nearest neighbour using distance in metres
Message-ID: <CDBA9AA3.4D2F%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/84267b1d/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Thu May 16 15:55:59 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Thu, 16 May 2013 15:55:59 +0200
Subject: [R-sig-Geo] nearest neighbour using distance in metres
In-Reply-To: <CDBA9AA3.4D2F%rossahmed@gmail.com>
References: <CDBA9AA3.4D2F%rossahmed@gmail.com>
Message-ID: <5195018F020000270001A04D@gwia2.boku.ac.at>

Dear Ross,

Euclidean Distance is not an units, it is a type of distance measurement an it is always in input units!
The Euclidean Distance is the length of a rope between your hands that you hold strained, but see here: http://en.wikipedia.org/wiki/Euclidean_distance


nndist(xySpatialTransformed at coords)


and maybe it is not very meaningful to calculate nndist with something else than a planar coordinate system... or even equidistant coordinate system! (but I'm not a cartographer)


Matteo




>>> Ross Ahmed  05/16/13 3:14 PM >>>
Hi all,

Following code computes Euclidian distance from each point to it nearest
neighbour:

library(spatstat)
y <- rnorm(30, 55.65, .008)
x <- rnorm(30, -1.82, .01)
xy <- cbind(x, y)
nndist(xy)

Is it possible to use distance in metres, not Euclidian distances? Here are
same points projected:

xySpatial <- SpatialPoints(xy, proj4string= CRS("+proj=longlat +datum=WGS84
+ellps=WGS84 +towgs84=0,0,0"))
xySpatialTransformed <- spTransform(xySpatial, CRS("+proj=laea +lon_0=-1.92
+lat_0=55.7 +datum=WGS84"))

Thanks
Ross



    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From sjmyers3142 at gmail.com  Thu May 16 16:47:45 2013
From: sjmyers3142 at gmail.com (Seth Myers)
Date: Thu, 16 May 2013 10:47:45 -0400
Subject: [R-sig-Geo] hand rolled spatial correlation in gnls and how to
 extract conditioned residuals?
Message-ID: <CAO-WCxdfrUy+OO7N6qU6SdfHDGRtXa_Y0jz+ix6eO=Lvx+SmGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/f15a2a0c/attachment.pl>

From hughsturrock at hotmail.com  Thu May 16 17:03:25 2013
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Thu, 16 May 2013 16:03:25 +0100
Subject: [R-sig-Geo] nearest neighbour using distance in metres
In-Reply-To: <CDBA9AA3.4D2F%rossahmed@gmail.com>
References: <CDBA9AA3.4D2F%rossahmed@gmail.com>
Message-ID: <DUB116-W134C0C08B133D4FACFA17D1C8A30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/5d019b49/attachment.pl>

From hughsturrock at hotmail.com  Thu May 16 22:24:40 2013
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Thu, 16 May 2013 21:24:40 +0100
Subject: [R-sig-Geo] Spatially autocorrelated random effects in logistic
 regression.
In-Reply-To: <CAO-WCxdOszb+w=OEOqbR9DDorMrp5D7F0S06f_FsWDm_dTWD+g@mail.gmail.com>
References: <CAO-WCxcD-ZFFR=0ntwv6T51XzbHz=nO8pafOAsUjSCwisQsAfQ@mail.gmail.com>,
	<DUB116-W11686EB57268A72BEAFA9D4C8A30@phx.gbl>,
	<CAO-WCxdGzvGhK-q815kDRLLShoZeroMQ09qzK_eqm3i_Bo-7qw@mail.gmail.com>,
	<DUB116-W318E1AEAA62C73C43C893EC8A30@phx.gbl>,
	<CAO-WCxdOszb+w=OEOqbR9DDorMrp5D7F0S06f_FsWDm_dTWD+g@mail.gmail.com>
Message-ID: <DUB116-W44DA838ED7A341787F0C1EC8A30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130516/5a6ea1e6/attachment.pl>

From jlong at uvic.ca  Thu May 16 23:39:37 2013
From: jlong at uvic.ca (JLong)
Date: Thu, 16 May 2013 14:39:37 -0700 (PDT)
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
	<CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
	<CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>
Message-ID: <1368740377860-7583598.post@n2.nabble.com>

Hey Mathieu and Greg, 

Great ideas, and thanks for the code Mathieu. 
I can't imagine a polygon shape where the 2nd step would ever by necessary?
Can you elaborate on why that might be. 

FYI, Mathieu I'm attempting to compute the same shape/linearity metric as
you.

Cheers,
Jed




-----
Jed Long
PhD Candidate
SPAR Lab, Dept. of Geography
University of Victoria, Canada
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Finding-the-Circumscribing-Circle-of-a-polygon-tp7582372p7583598.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Thu May 16 23:55:37 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 17 May 2013 07:55:37 +1000
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <1368740377860-7583598.post@n2.nabble.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
	<CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
	<CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>
	<1368740377860-7583598.post@n2.nabble.com>
Message-ID: <CAAcGz99jHF5a-mSr4SGn=tvwmAqFQteKSve6jZ716nLtS+tnqQ@mail.gmail.com>

Just FYI, there is  tripack::circumcircle, here's an example with data
in the maptools package.

library(maptools)

data(wrld_simpl)

poly <- wrld_simpl[wrld_simpl$NAME == "Australia", ]

## use coercion to get raw vertices (long winded, but avoids @ usage)
coords <- coordinates(as(as(poly, "SpatialLines"), "SpatialPoints"))


library(tripack)
cc<- circumcircle(coords[,1], coords[,2], plot = TRUE)
plot(poly, add = TRUE, col = "grey")


On Fri, May 17, 2013 at 7:39 AM, JLong <jlong at uvic.ca> wrote:
> Hey Mathieu and Greg,
>
> Great ideas, and thanks for the code Mathieu.
> I can't imagine a polygon shape where the 2nd step would ever by necessary?
> Can you elaborate on why that might be.
>
> FYI, Mathieu I'm attempting to compute the same shape/linearity metric as
> you.
>
> Cheers,
> Jed
>
>
>
>
> -----
> Jed Long
> PhD Candidate
> SPAR Lab, Dept. of Geography
> University of Victoria, Canada
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Finding-the-Circumscribing-Circle-of-a-polygon-tp7582372p7583598.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From mathieu.rajerison at gmail.com  Fri May 17 08:32:40 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 17 May 2013 08:32:40 +0200
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAAcGz99jHF5a-mSr4SGn=tvwmAqFQteKSve6jZ716nLtS+tnqQ@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
	<CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
	<CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>
	<1368740377860-7583598.post@n2.nabble.com>
	<CAAcGz99jHF5a-mSr4SGn=tvwmAqFQteKSve6jZ716nLtS+tnqQ@mail.gmail.com>
Message-ID: <CAGfc75noK9BfQxnYPxRGFp7z5ZmA=kFWbwkWPPoJXnHzLmscfQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130517/30ef90a5/attachment.pl>

From mdsumner at gmail.com  Fri May 17 09:17:40 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 17 May 2013 17:17:40 +1000
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAGfc75noK9BfQxnYPxRGFp7z5ZmA=kFWbwkWPPoJXnHzLmscfQ@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
	<CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
	<CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>
	<1368740377860-7583598.post@n2.nabble.com>
	<CAAcGz99jHF5a-mSr4SGn=tvwmAqFQteKSve6jZ716nLtS+tnqQ@mail.gmail.com>
	<CAGfc75noK9BfQxnYPxRGFp7z5ZmA=kFWbwkWPPoJXnHzLmscfQ@mail.gmail.com>
Message-ID: <CAAcGz9_nkqGApW3Gs+N2LK1hgmn9DTX15i1B-2S2EgW_xROtMw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130517/581207c4/attachment.pl>

From mathieu.rajerison at gmail.com  Fri May 17 14:47:36 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 17 May 2013 14:47:36 +0200
Subject: [R-sig-Geo] Skeletonization Process - Eliminating Adjacent Segments
Message-ID: <CAGfc75mDpLU-HHr-_MEQxOJ+LR-ZqsaWvYq5PT+NY8U+uhihMA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130517/1bcbb790/attachment.pl>

From tech_dev at wildintellect.com  Fri May 17 19:26:19 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Fri, 17 May 2013 10:26:19 -0700
Subject: [R-sig-Geo] spatialite from R
In-Reply-To: <CAJUQvdxdWe+VveyAGHeBaeto9+hWqnF6QK4BDogvAuHTOSs6Uw@mail.gmail.com>
References: <CAJUQvdxdWe+VveyAGHeBaeto9+hWqnF6QK4BDogvAuHTOSs6Uw@mail.gmail.com>
Message-ID: <5196683B.1070005@wildintellect.com>

On 05/17/2013 04:04 AM, Gilles San Martin wrote:
> Hello
>
> Sorry for contacting you directly but I've been searching the web for a
> while now about connections between R and spatialite without success and I
> have seen you name comming back regularly (r-help, spatialite,... mailing
> lists). So I was wondering if you have some new ways to deal with that
> problem as the last messages I saw were from 1-2 years ago ?
>
> I just would like to be able to execute a SQL query on a spatialite
> database from R.
> I have noted that rgdal now supports importing tables from spatialite but I
> need an approach that would work also for huge tables (too big probably to
> be imported in R directly, before the query).
>
> The idea would be probably to create a view (from R, not from a spatialite
> interface) and then access to it via rgdal (readOGR).
> If there is no way to do it in R, I was wondering if it would be possible
> to use the system() function to execute a command as if you were at the
> command line (I don't see how however).
>
> I would like something without configuration, in a way that would allow me
> to provide script and data to colleagues that they could run it without
> additional configuration needs.
>
> NB : I don't know spatialite. I'm just exploring the possibilities to
> decide which tool (spatialite, psotgis, something else ?) will match my
> needs the best to decide which one to learn.
> I'm attracted by spatialite but I'm a little bit afraid by its lack of
> support/indifference in R and the fact that it seems to be developped
> outside OSgeo or big structure like that (what about durability?) .
>
> Best regards
> Gilles
>

These questions are fine for either R-sig-geo or Spatialite mailing 
lists (I've copied them on this email). Since you're most interested in 
R, maybe start with R-sig-geo

I haven't done this in a while but here are my notes:
library(RSQLite)
m <- dbDriver("SQLite")
con <- dbConnect(m, dbname = "test.db",loadable.extensions = TRUE)
sql <- "SELECT load_extension('libspatialite.so')"
rs <- dbGetQuery(con, sql)

Once you've done that you can run any query you want, the only tricky 
part is that you can't retrieve spatial blobs in any sensible way via 
this method. However if you have made a view, I believe that readOGR can 
then pull that whole view over as an sp object.

The code above is linux specific since an .so is a .dll on Windows. Also 
you'll need the RSQLite, RGDAL and Spatialite installed on the system 
thats going to use it. If you can't rely on your users to be able to 
install those things you might want to find a different way.

Thanks,
Alex


From hi_ono2001 at ybb.ne.jp  Sat May 18 06:50:11 2013
From: hi_ono2001 at ybb.ne.jp (hi_ono2001 at ybb.ne.jp)
Date: Sat, 18 May 2013 13:50:11 +0900
Subject: [R-sig-Geo] spatialite from R
In-Reply-To: <5196683B.1070005@wildintellect.com>
Message-ID: <46263.2109.qm@web200209.mail.kks.yahoo.co.jp>

Hello.

 SQLiteMap(Wrapper to spatialite functions) is still available from http://cran.cermin.lipi.go.id/web/packages/SQLiteMap/index.html.


 Regards.

--- On Sat, 2013/5/18, Alex Mandel <tech_dev at wildintellect.com> wrote:

> On 05/17/2013 04:04 AM, Gilles San Martin wrote:
> > Hello
> > 
> > Sorry for contacting you directly but I've been searching the web for a
> > while now about connections between R and spatialite without success and I
> > have seen you name comming back regularly (r-help, spatialite,... mailing
> > lists). So I was wondering if you have some new ways to deal with that
> > problem as the last messages I saw were from 1-2 years ago ?
> > 
> > I just would like to be able to execute a SQL query on a spatialite
> > database from R.
> > I have noted that rgdal now supports importing tables from spatialite but I
> > need an approach that would work also for huge tables (too big probably to
> > be imported in R directly, before the query).
> > 
> > The idea would be probably to create a view (from R, not from a spatialite
> > interface) and then access to it via rgdal (readOGR).
> > If there is no way to do it in R, I was wondering if it would be possible
> > to use the system() function to execute a command as if you were at the
> > command line (I don't see how however).
> > 
> > I would like something without configuration, in a way that would allow me
> > to provide script and data to colleagues that they could run it without
> > additional configuration needs.
> > 
> > NB : I don't know spatialite. I'm just exploring the possibilities to
> > decide which tool (spatialite, psotgis, something else ?) will match my
> > needs the best to decide which one to learn.
> > I'm attracted by spatialite but I'm a little bit afraid by its lack of
> > support/indifference in R and the fact that it seems to be developped
> > outside OSgeo or big structure like that (what about durability?) .
> > 
> > Best regards
> > Gilles
> > 
> 
> These questions are fine for either R-sig-geo or Spatialite mailing lists (I've copied them on this email). Since you're most interested in R, maybe start with R-sig-geo
> 
> I haven't done this in a while but here are my notes:
> library(RSQLite)
> m <- dbDriver("SQLite")
> con <- dbConnect(m, dbname = "test.db",loadable.extensions = TRUE)
> sql <- "SELECT load_extension('libspatialite.so')"
> rs <- dbGetQuery(con, sql)
> 
> Once you've done that you can run any query you want, the only tricky part is that you can't retrieve spatial blobs in any sensible way via this method. However if you have made a view, I believe that readOGR can then pull that whole view over as an sp object.
> 
> The code above is linux specific since an .so is a .dll on Windows. Also you'll need the RSQLite, RGDAL and Spatialite installed on the system thats going to use it. If you can't rely on your users to be able to install those things you might want to find a different way.
> 
> Thanks,
> Alex
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mestre.frederico at gmail.com  Sun May 19 03:13:18 2013
From: mestre.frederico at gmail.com (Frederico Mestre)
Date: Sun, 19 May 2013 02:13:18 +0100
Subject: [R-sig-Geo] Random points defining mean distance
Message-ID: <000c01ce542e$0cf366b0$26da3410$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130519/ec61c252/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sun May 19 09:27:12 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 19 May 2013 08:27:12 +0100
Subject: [R-sig-Geo] Random points defining mean distance
In-Reply-To: <a2472fdc00234baa844071f5ef7114bb@EX-1-HT0.lancs.local>
References: <a2472fdc00234baa844071f5ef7114bb@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPdJ5=4eEeHVjLJfzUSSrpLR=1FZ49sqH2M4=Z3oqo9_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130519/6eaed923/attachment.pl>

From mestre.frederico at gmail.com  Sun May 19 10:52:32 2013
From: mestre.frederico at gmail.com (Frederico Mestre)
Date: Sun, 19 May 2013 09:52:32 +0100
Subject: [R-sig-Geo] Random points defining mean distance
In-Reply-To: <CANVKczPdJ5=4eEeHVjLJfzUSSrpLR=1FZ49sqH2M4=Z3oqo9_g@mail.gmail.com>
References: <a2472fdc00234baa844071f5ef7114bb@EX-1-HT0.lancs.local>
	<CANVKczPdJ5=4eEeHVjLJfzUSSrpLR=1FZ49sqH2M4=Z3oqo9_g@mail.gmail.com>
Message-ID: <003401ce546e$349922f0$9dcb68d0$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130519/583aaf61/attachment.pl>

From mestre.frederico at gmail.com  Mon May 20 11:37:52 2013
From: mestre.frederico at gmail.com (Frederico Mestre)
Date: Mon, 20 May 2013 10:37:52 +0100
Subject: [R-sig-Geo] random points with specified mean distance and std.
	dev.
In-Reply-To: <CAO-WCxeKsYaEhic_bwKZ9t1HQaZdbD5t-OrMst0j63fCHA=m7A@mail.gmail.com>
References: <CAO-WCxeraSbGoLKHcxBKKjQ9HTaLsdPrDqjVzFMHubQEa7HSMQ@mail.gmail.com>
	<001b01ce5533$7142a850$53c7f8f0$@gmail.com>
	<CAO-WCxeKsYaEhic_bwKZ9t1HQaZdbD5t-OrMst0j63fCHA=m7A@mail.gmail.com>
Message-ID: <004301ce553d$b3f0ecc0$1bd2c640$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130520/f83fdd18/attachment.pl>

From p.vanbreugel at gmail.com  Mon May 20 17:34:22 2013
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Mon, 20 May 2013 17:34:22 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command an
	R object.
Message-ID: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130520/6ea64c8d/attachment.pl>

From cebulmer at telus.net  Mon May 20 18:46:14 2013
From: cebulmer at telus.net (Chuck Bulmer)
Date: Mon, 20 May 2013 09:46:14 -0700 (PDT)
Subject: [R-sig-Geo] saga grid format TOPTOBOTTOM
Message-ID: <1369068374127-7583610.post@n2.nabble.com>

Hi all.

I am using package raster to crop some saga grids with a shapefile.

The original inut sgrd file looks like this:

NAME	= ELEV_1HA
DESCRIPTION	= 
UNIT	= 
DATAFILE_OFFSET	= 0
DATAFORMAT	= FLOAT
BYTEORDER_BIG	= FALSE
POSITION_XMIN	= 321888.3470000000
POSITION_YMIN	= 376291.6470000000
CELLCOUNT_X	= 15358
CELLCOUNT_Y	= 13473
CELLSIZE	= 100.0000000000
Z_FACTOR	= 1.000000
NODATA_VALUE	= -9999.000000
TOPTOBOTTOM	= FALSE

After using the (below) code, the output sgrd file looks like this:

NAME	= ELEV_1HA 
DESCRIPTION	= 
UNIT	= 
DATAFORMAT	= FLOAT 
DATAFILE_OFFSET	= 0
BYTEORDER_BIG	= FALSE 
POSITION_XMIN	=  1427688.347 
POSITION_YMIN	=  486091.647 
CELLCOUNT_Y	=  1685 
CELLCOUNT_X	=  784 
CELLSIZE	=  100 
Z_FACTOR	= 1.000000
NODATA_VALUE	= -3.4e+38 
TOPTOBOTTOM	= TRUE 

The resulting files are read by SAGA-GIS with no problem and they look good,
but I want to use Quantum GIS as my map viewer and when I try to load the
result file into QGIS it provides me with the following error:
"..ELEV_1HA is not a supported data source. Currently the Saga Binary Grid
driver does not support Saga Grids written TOPTOBOTTOM"

If I load and resave the grid with SAGA, TOPTOBOTTOM reverts back to FALSE,
and the grid can be read by QGIS, but I'd like to avoid this extra step.

Is there a way to add a setting to the crop function? raster? gdal? to write
as TOPTOBOTTOM=FALSE, which would save me the extra step of loading and
resaving each grod.

Thanks for any help you can provide

Chuck

Here's the code ... (Windows 7x64)

s <- raster("D:\\BC_DSM\\ELEV_1HA.sdat")
t<- shapefile("D:\\BC_DSM\\ecodistrict_bdy_b10k.shp")
crop(s,t,filename="D:\\BC_DSM\\Results\\ELEV_1HA.sdat")





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/saga-grid-format-TOPTOBOTTOM-tp7583610.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tan.afreebird at gmail.com  Mon May 20 19:30:59 2013
From: tan.afreebird at gmail.com (ToNoY)
Date: Mon, 20 May 2013 10:30:59 -0700 (PDT)
Subject: [R-sig-Geo] Cross-validaton with "geoR" for ordinary least squares
	fit
Message-ID: <1369071059856-7583611.post@n2.nabble.com>

I've fitted a model using "geoR" package of 'R' as follows:

#ordinary least squares fit
ini.vals <- expand.grid(seq(20000,50000,l=5), seq(0.01,0.1,l=5))
ols = variofit(vario.mydata, ini=ini.vals, fix.nug=F, wei="equal")
summary(ols)
vario.mydata=variog(mydata, max.dist=0.123)
plot(vario.mydata,main="OLS")
lines(ols,lty=2,col=3, lw=2)

The summary/plot of the model is fine. But when I want to cross-validate my
model, 'R' throws me the following error which I know not beans about.

Error in if (length(data) != n) stop(paste("incompatible sizes: coords (", 
:    argument is of length zero

Any suggestions/idea why?




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Cross-validaton-with-geoR-for-ordinary-least-squares-fit-tp7583611.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Mon May 20 19:38:47 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 May 2013 19:38:47 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command
 an R object.
In-Reply-To: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
References: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>

On Mon, 20 May 2013, Paulo van Breugel wrote:

> Hi
>
> In older version of the execGRASS function of spgrass6, setting the option
> intern=TRUE would make the output of the grass command a R object.
>
> Now, when I run execGRASS with the intern=TRUE, like the statement below,
> the output is not written to the R object.
>
> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
> intern=TRUE)

With GRASS 6.4.2:

a <- execGRASS("r.univar", flags = "g", map = "elevation.dem", intern = 
TRUE)

works as before. Adding the fs= parameter causes the failure. You are 
using GRASS 7, in which fs= is separator=. In:

raster/r.univar/r.univar_main.c

only \\t, tab, space, and comma are defined as such, others seem to be 
accepted, but ";" is not. I think that the parameter is unused anyway in 
script-style output, but setting fs=";" certainly causes trouble.

Try without that parameter. Your observed difference in behaviour is not 
intended from the R side, and is caused by odd behaviour and interaction 
between parameters on the GRASS side in this GRASS module for your 
parameter settings. Other GRASS modules, and r.univar with different fs= 
settings, work as expected on Unix platforms, but under Windows, legacy 
execution is enforced anyway.

Hope this clarifies,

Roger

>
> The object 'a' is created, but it is empty (character(0)). However, when I
> set legacyExec=TRUE (like below), the object 'a' is created with the grass
> r.univar output.
>
> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
> legacyExec=TRUE, intern=TRUE)
>
> Is this the intended behaviour (i.e., did I miss something in the help
> file)?
>
> I am running R version 3.0.1 (2013-05-16), on Ubuntu 13.04 64-bit
>
> Paulo
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From manos.kalomenopoulos at wur.nl  Mon May 20 20:25:50 2013
From: manos.kalomenopoulos at wur.nl (Kalomenopoulos, Manos)
Date: Mon, 20 May 2013 18:25:50 +0000
Subject: [R-sig-Geo] Problem with extract {raster} function
In-Reply-To: <22F4D0EDF68494479BC955CFF9F011BB16BC53@SCOMP0936.wurnet.nl>
References: <22F4D0EDF68494479BC955CFF9F011BB16BC53@SCOMP0936.wurnet.nl>
Message-ID: <22F4D0EDF68494479BC955CFF9F011BB16BC66@SCOMP0936.wurnet.nl>

Hi everybody,
I am experiencing a problem with the extract{raster} function, specifically the 'weights' argument.

I have a raster and a polygon shapefile with 5 polygons (land cover classes).
I am using extract to obtain cellnumbers and the weights (percentage of cover of each class per raster cell). 
The sum of the five weights per cell should sum to 100% (except for those cells not completely inside my AOI). 
However, there is an considerable amount of cells were that is not the case.
I have been trying to track down the error, but can't understand it so far.

I localized the erroneous cells in one example site (10x10km) and clipped the original shapefile to a smaller area containing these cells.
The script below does the extraction once for the 10x10km sample and once for a smaller testsite containing 10 erroneous cells.
Surprisingly, doing the extraction with the smaller testsite ALL weights sum up to 100%, even though the polygon data is exactly the same.... 
Any ideas why and/or suggestions how to make it work properly for the bigger extent?

Here my script:


library(raster)
library(reshape)

# raster of AOI
 r <- raster('1site.tif')
# polygon shapefile of AOI with 5 different classes
  s1pol <- shapefile('1site.shp')

# polygon shapefile of test area with observed errors (clipped from s1pol)
  s2pol <- shapefile('test.shp')
# extract class names
  classes <- s1pol$class
########################################################################
# Extraction for complete AOI
  df1 <- extract(r,s1pol, df=TRUE, weights=TRUE, cellnumbers=TRUE)
    names(df1) <- c('ID','cell', 'r', 'weight1') # Extraction for test area
  
# Extraction for smaller site
  df2 <- extract(r,s2pol, df=TRUE, weights=TRUE, cellnumbers=TRUE)
    names(df2) <- c('ID','cell', 'r', 'weight2') ###########################################################################################
### Compairing

# Reshape df's keeping only ID, cell and weight
  df1new<-cast(df1[,c(1,2,4)],cell~ID)
    names(df1new) <- c('cell',classes)
  
  df2new<-cast(df2[,c(1,2,4)],cell~ID)
    names(df2new) <- c('cell',classes)
# Calculate class totals      
  df1new$totals <- mapply(df1new[,2], df1new[,3], df1new[,4],df1new[,5],df1new[,6], FUN=function(v,w,x,y,z) sum(c(v,w,x,y,z),na.rm=TRUE))
       
  df2new$totals <- mapply(df2new[,2], df2new[,3], df2new[,4],df2new[,5],df2new[,6], FUN=function(v,w,x,y,z) sum(c(v,w,x,y,z),na.rm=TRUE))

# Merge the two dataframes and select only rows with differnt totals
  df <- as.data.frame(merge(df1new,df2new,by='cell'))
    
    dfe <- subset(df, totals.x-totals.y !=0)
      dfe$error <- dfe$totals.x-dfe$totals.y

head(dfe)

Link to the files needed to run this script: 
https://www.dropbox.com/s/n283rwew1ypxghv/extractProblem.7z


Thanks in advance!
-------------------------------------------------------
Manos Kalomenopoulos
Lab. of Geo-Information Science and Remote Sensing, Center for Geo-Information - Wageningen University Department for Biogeochemical Integration, Max-Planck-Institute for Biogeochemistry, Jena


From p.vanbreugel at gmail.com  Mon May 20 23:55:14 2013
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Mon, 20 May 2013 23:55:14 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command
 an R object.
In-Reply-To: <alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>
References: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
	<alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>
Message-ID: <CAGrkfcL55LHzcPZLJrnhvdWQ244qDiHsPmELc8kfj4VAnXcdYg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130520/162b0a38/attachment.pl>

From dong-liang at uiowa.edu  Tue May 21 04:19:45 2013
From: dong-liang at uiowa.edu (Dong Liang)
Date: Mon, 20 May 2013 21:19:45 -0500
Subject: [R-sig-Geo] spatiotemporal simulation
Message-ID: <CAFX+d0mY9TRDa3H5LobuE0+KBktA_AoNqB7ETc=w60M5mc7sDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130520/3dcd0382/attachment.pl>

From mathieu.rajerison at gmail.com  Tue May 21 08:45:21 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 21 May 2013 08:45:21 +0200
Subject: [R-sig-Geo] Skeletonization Process - Eliminating Adjacent
	Segments
In-Reply-To: <CAGfc75mDpLU-HHr-_MEQxOJ+LR-ZqsaWvYq5PT+NY8U+uhihMA@mail.gmail.com>
References: <CAGfc75mDpLU-HHr-_MEQxOJ+LR-ZqsaWvYq5PT+NY8U+uhihMA@mail.gmail.com>
Message-ID: <CAGfc75nMf8SUakVNaNHYetzCLOqpPn+8wgCN5AOUYQCDiAVEqw@mail.gmail.com>

Hi,

Finally, I inspired myself from a code by Barry Rownlingson intially
dedicated to calculate the shortest path.
But in my cas, it consisted in calculating the longest one.

Here is the final code with an image as attached file. In the image, you
see the initial shape, the voronoi lines in rainbow colors and the
simplified median Line in bold black.

library(rgdal)
library(spatstat)
library(rgeos)
library(maptools)
library(igraph)

setwd("F:/METHODES/1305_SKELETON/")

pol <- readOGR("IN/polygone.shp", "polygone")

# FUNCTION

findMedianLine <- function(pol, eps, tol) {

  l <- as(as(pol, "SpatialLines"), "psp")

  pts <- pointsOnLines(l, eps=eps)

  vor <- dirichlet(pts)


  # LINES EXTRACTION

  vor.l <- as(as(vor, "SpatialPolygons"), "SpatialLines")

  vor.l <- gIntersection(vor.l, vor.l)@lines[[1]]@Lines

  vor.split <- SpatialLines(lapply(1:length(vor.l), function(x)
Lines(list(vor.l[[x]]), ID=as.character(x))))

  vor.l.in <- vor.l.split[gContains(pol, vor.split, byid=T), ]


  # GRAPH CONSTRUCTION

  edges = do.call(rbind,lapply(vor.l.in at lines
,function(ls){as.vector(t(ls at Lines[[1]]@coords))}))
  lengths = sqrt((edges[,1]-edges[,3])^2+(edges[,2]-edges[,4])^2)

  froms = paste(edges[,1],edges[,2])
  tos = paste(edges[,3],edges[,4])

  g = graph.edgelist(cbind(froms,tos),directed=FALSE)
  E(g)$weight=lengths


  # LONGEST PATH

  sel <- get.diameter(g)

  vor.sel <- vor.l.in at lines[sel-1]

  spine <- SpatialLines(vor.sel)

  spine.spl <- gSimplify(gLineMerge(spine), tol=tol)

  return(spine.spl)
}


myMedianLine <- findMedianLine(pol, eps=1000, tol=1000)


2013/5/17 Mathieu Rajerison <mathieu.rajerison at gmail.com>

> Hi,
>
>
> I've written a code to skeletonize an area shape.
>
> The example could be a watershed from which we'd like to compute the
> "guessed" stream, or find the median axis of a shape.
>
> I can find my median line but there are some adjacent segments connected
> to it. The length criteria is not appropriate to deal with these adjacent
> segments as some tiny ones could be part of to the median line.
>
> Has anyone idea to deal with that?
>
> I apoplogize in advance if it doesn't work in all cases (holes, rings,
> etc...).
>
> library(rgdal)
> library(spatstat)
> library(rgeos)
> library(maptools)
>
> setwd("F:/METHODES/1305_SKELETON/")
>
> pol <- readOGR("IN/polygone.shp", "polygone")
>
> # FUNCTION
>
> findMedianLine <- function(pol, tol) {
>
>   l <- as(as(pol, "SpatialLines"), "psp")
>
>   pts <- pointsOnLines(l, eps=10000)
>
>   vor <- dirichlet(pts)
>
>   vor.l <- as(as(vor, "SpatialPolygons"), "SpatialLines")
>
>   vor.lines <- gIntersection(vor.l, vor.l)@lines[[1]]@Lines
>
>   vor.l.split <- SpatialLines(lapply(1:length(vor.lines), function(x)
> Lines(list(vor.lines[[x]]), ID=as.character(x))))
>
>   medianLine <- gLineMerge(vor.l.split[gContains(pol, vor.l.split,
> byid=T), ])
>
>   medianLine.spl <- gSimplify(medianLine, tol=tol); plot(medianLine.spl)
>
>   return(medianLine.spl)
> }
>
>
> myMedianLine <- findMedianLine(pol, tol=1000)
>
> plot(pol); plot(myMedianLine, add=T)
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/a814264c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rplot01.png
Type: image/png
Size: 10392 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/a814264c/attachment.png>

From Roger.Bivand at nhh.no  Tue May 21 09:07:09 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 May 2013 09:07:09 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command
 an R object.
In-Reply-To: <CAGrkfcL55LHzcPZLJrnhvdWQ244qDiHsPmELc8kfj4VAnXcdYg@mail.gmail.com>
References: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
	<alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>
	<CAGrkfcL55LHzcPZLJrnhvdWQ244qDiHsPmELc8kfj4VAnXcdYg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305210901580.12468@reclus.nhh.no>

On Mon, 20 May 2013, Paulo van Breugel wrote:

> Great, this is really helpful. You are right, and I should have seen from
> the help file, that the semicolon is not one of the supported separators.
> The odd thing is it works when running r.univar from grass directly if I
> use the table flag (-t instead of -g). But now I know I shouldn't.

With GRASS 7:

a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
  separator="; ", intern = TRUE)

works, but:

a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
   separator=";", intern = TRUE)

does not. The problem is that the trailing ";" on the command line to 
GRASS is also the shell line terminator, so must be protected by quoting:

a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
   separator="';'", intern = TRUE)

or:

a <- execGRASS("r.univar", flags = "t", map = "elevation.dem", 
separator=shQuote(";"), intern = TRUE)

both work.

Roger


>
> Thanks for helping out, much appreciated!
>
> Paulo
>
>
>
>
>
> On Mon, May 20, 2013 at 7:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Mon, 20 May 2013, Paulo van Breugel wrote:
>>
>>  Hi
>>>
>>> In older version of the execGRASS function of spgrass6, setting the option
>>> intern=TRUE would make the output of the grass command a R object.
>>>
>>> Now, when I run execGRASS with the intern=TRUE, like the statement below,
>>> the output is not written to the R object.
>>>
>>> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
>>> intern=TRUE)
>>>
>>
>> With GRASS 6.4.2:
>>
>> a <- execGRASS("r.univar", flags = "g", map = "elevation.dem", intern =
>> TRUE)
>>
>> works as before. Adding the fs= parameter causes the failure. You are
>> using GRASS 7, in which fs= is separator=. In:
>>
>> raster/r.univar/r.univar_main.**c
>>
>> only \\t, tab, space, and comma are defined as such, others seem to be
>> accepted, but ";" is not. I think that the parameter is unused anyway in
>> script-style output, but setting fs=";" certainly causes trouble.
>>
>> Try without that parameter. Your observed difference in behaviour is not
>> intended from the R side, and is caused by odd behaviour and interaction
>> between parameters on the GRASS side in this GRASS module for your
>> parameter settings. Other GRASS modules, and r.univar with different fs=
>> settings, work as expected on Unix platforms, but under Windows, legacy
>> execution is enforced anyway.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>
>>> The object 'a' is created, but it is empty (character(0)). However, when I
>>> set legacyExec=TRUE (like below), the object 'a' is created with the grass
>>> r.univar output.
>>>
>>> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
>>> legacyExec=TRUE, intern=TRUE)
>>>
>>> Is this the intended behaviour (i.e., did I miss something in the help
>>> file)?
>>>
>>> I am running R version 3.0.1 (2013-05-16), on Ubuntu 13.04 64-bit
>>>
>>> Paulo
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Rainer at krugs.de  Tue May 21 10:17:22 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 21 May 2013 10:17:22 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command
	an R object.
In-Reply-To: <alpine.LRH.2.03.1305210901580.12468@reclus.nhh.no> (Roger
	Bivand's message of "Tue, 21 May 2013 09:07:09 +0200")
References: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
	<alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>
	<CAGrkfcL55LHzcPZLJrnhvdWQ244qDiHsPmELc8kfj4VAnXcdYg@mail.gmail.com>
	<alpine.LRH.2.03.1305210901580.12468@reclus.nhh.no>
Message-ID: <87sj1g7nn1.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Mon, 20 May 2013, Paulo van Breugel wrote:
>
>> Great, this is really helpful. You are right, and I should have seen from
>> the help file, that the semicolon is not one of the supported separators.
>> The odd thing is it works when running r.univar from grass directly if I
>> use the table flag (-t instead of -g). But now I know I shouldn't.
>
> With GRASS 7:
>
> a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
>  separator="; ", intern = TRUE)
>
> works, but:
>
> a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
>   separator=";", intern = TRUE)
>
> does not. The problem is that the trailing ";" on the command line to
> GRASS is also the shell line terminator, so must be protected by
> quoting:
>
> a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
>   separator="';'", intern = TRUE)
>
> or:
>
> a <- execGRASS("r.univar", flags = "t", map = "elevation.dem",
> separator=shQuote(";"), intern = TRUE)

Following the escaping: I can not think about any problems, if all
arguments for grass are quoted (OK - I am speaking from the Linux side
without enough Windows experience with R to know if it works there as
well). Escaping *all* arguments *automatically* should make
execGRASS even more stable?

Rainer

>
> both work.
>
> Roger
>
>
>>
>> Thanks for helping out, much appreciated!
>>
>> Paulo
>>
>>
>>
>>
>>
>> On Mon, May 20, 2013 at 7:38 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> On Mon, 20 May 2013, Paulo van Breugel wrote:
>>>
>>>  Hi
>>>>
>>>> In older version of the execGRASS function of spgrass6, setting the option
>>>> intern=TRUE would make the output of the grass command a R object.
>>>>
>>>> Now, when I run execGRASS with the intern=TRUE, like the statement below,
>>>> the output is not written to the R object.
>>>>
>>>> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
>>>> intern=TRUE)
>>>>
>>>
>>> With GRASS 6.4.2:
>>>
>>> a <- execGRASS("r.univar", flags = "g", map = "elevation.dem", intern =
>>> TRUE)
>>>
>>> works as before. Adding the fs= parameter causes the failure. You are
>>> using GRASS 7, in which fs= is separator=. In:
>>>
>>> raster/r.univar/r.univar_main.**c
>>>
>>> only \\t, tab, space, and comma are defined as such, others seem to be
>>> accepted, but ";" is not. I think that the parameter is unused anyway in
>>> script-style output, but setting fs=";" certainly causes trouble.
>>>
>>> Try without that parameter. Your observed difference in behaviour is not
>>> intended from the R side, and is caused by odd behaviour and interaction
>>> between parameters on the GRASS side in this GRASS module for your
>>> parameter settings. Other GRASS modules, and r.univar with different fs=
>>> settings, work as expected on Unix platforms, but under Windows, legacy
>>> execution is enforced anyway.
>>>
>>> Hope this clarifies,
>>>
>>> Roger
>>>
>>>
>>>> The object 'a' is created, but it is empty (character(0)). However, when I
>>>> set legacyExec=TRUE (like below), the object 'a' is created with the grass
>>>> r.univar output.
>>>>
>>>> a <- execGRASS("r.univar", flags="g", map=distmod, separator=";",
>>>> legacyExec=TRUE, intern=TRUE)
>>>>
>>>> Is this the intended behaviour (i.e., did I miss something in the help
>>>> file)?
>>>>
>>>> I am running R version 3.0.1 (2013-05-16), on Ubuntu 13.04 64-bit
>>>>
>>>> Paulo
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________**_________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
<#secure method=pgpmime mode=sign>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From p.vanbreugel at gmail.com  Tue May 21 11:13:24 2013
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Tue, 21 May 2013 11:13:24 +0200
Subject: [R-sig-Geo] spgrass6: execGRASS: make the output of the command
 an R object.
In-Reply-To: <87sj1g7nn1.fsf@krugs.de>
References: <CAGrkfc+pnTfuFrO-hkwx1RSy1roeOVuGifKXDsn4+WuqtZNEXg@mail.gmail.com>
	<alpine.LRH.2.03.1305201920070.9588@reclus.nhh.no>
	<CAGrkfcL55LHzcPZLJrnhvdWQ244qDiHsPmELc8kfj4VAnXcdYg@mail.gmail.com>
	<alpine.LRH.2.03.1305210901580.12468@reclus.nhh.no>
	<87sj1g7nn1.fsf@krugs.de>
Message-ID: <CAGrkfcKBii0DuYWoYyAAUoRrLEeoUnModYGnxBHy_RMzRgnOpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/1b549140/attachment.pl>

From mathieu.rajerison at gmail.com  Tue May 21 11:22:44 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 21 May 2013 11:22:44 +0200
Subject: [R-sig-Geo] SpatialLines to Graph object - computing the longest
	path - misconstruction
Message-ID: <CAGfc75kUKsY111R8FAu=M-dbERXPOy=mK3sxJv76ayQEvPSEgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/eb7a71e4/attachment.pl>

From mathieu.rajerison at gmail.com  Tue May 21 11:23:38 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 21 May 2013 11:23:38 +0200
Subject: [R-sig-Geo] SpatialLines to Graph object - computing the
	longest path - misconstruction
In-Reply-To: <CAGfc75kUKsY111R8FAu=M-dbERXPOy=mK3sxJv76ayQEvPSEgQ@mail.gmail.com>
References: <CAGfc75kUKsY111R8FAu=M-dbERXPOy=mK3sxJv76ayQEvPSEgQ@mail.gmail.com>
Message-ID: <CAGfc75mFfOTAS3rU_MW9y1zsa0fczLBkGC4LtSqixO_MN9VL1w@mail.gmail.com>

Sorry, I forgot the attached files.


2013/5/21 Mathieu Rajerison <mathieu.rajerison at gmail.com>

> Hello,
>
>
> I have a lines shapefile that I converted to a graph object, following the
> method in
> http://www.mail-archive.com/r-sig-geo at r-project.org/msg05836.html
>
> I have determined the farthest nodes of the graph.
>
> Then, I tried to determine the diameter's path  but the result is odd as
> the attached file shows.
>
> The problem may come from the SpatialLines to graph conversion..But I
> can't see where the problem is...
>
> Any help would be greatly appreciated...
>
> I've put the example data I used if you want to give it a try
>
> Here is the code:
>
> # READ
> l <- readOGR("IN/testline.shp", "testline")
> l.break <- gIntersection(l, l)
> l.split <- SpatialLines(lapply(1:length(l.break at lines[[1]]@Lines),
> function(x) Lines(list(l.break at lines[[1]]@Lines[[x]]),
> ID=as.character(x))))
>
> #GRAPH
> edges =
> do.call(rbind,lapply(1:length(l.split),function(x){as.vector(t(l.split at lines
> [[x]]@Lines[[1]]@coords))}))
> lengths = sqrt((edges[,1]-edges[,3])^2+(edges[,2]-edges[,4])^2)
>
> froms = paste(edges[,1],edges[,2])
> tos = paste(edges[,3],edges[,4])
> g = graph.edgelist(cbind(froms,tos),directed=FALSE)
> E(g)$weight=lengths
>
> # DIAMETER
> sel <- get.diameter(g)
> diam <- l.split[sel-1]
> plot(diam)
>
>
> Mathieu
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/c1e0ea03/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rplot02.png
Type: image/png
Size: 2169 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/c1e0ea03/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: testline.zip
Type: application/zip
Size: 1832 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/c1e0ea03/attachment.zip>

From botero18 at hotmail.com  Tue May 21 23:56:23 2013
From: botero18 at hotmail.com (=?iso-8859-1?B?c2ViYXN0aWFuIGJvdGVybyBjYfFvbGE=?=)
Date: Tue, 21 May 2013 21:56:23 +0000
Subject: [R-sig-Geo] How to create a STFDF object from various rasters
Message-ID: <BLU177-W46CB14D64DE60CC3DC14F2C7A80@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130521/f68c0f1d/attachment.pl>

From oscar.perpinan at gmail.com  Wed May 22 07:42:39 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Wed, 22 May 2013 07:42:39 +0200
Subject: [R-sig-Geo] How to create a STFDF object from various rasters
In-Reply-To: <BLU177-W46CB14D64DE60CC3DC14F2C7A80@phx.gbl>
References: <BLU177-W46CB14D64DE60CC3DC14F2C7A80@phx.gbl>
Message-ID: <CAMLL7bnZbQuVw9LSQZcvXopEA8FKq6OfGi8ArxA22zQOQMGjtg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130522/c858290a/attachment.pl>

From eddieatr at gmail.com  Wed May 22 11:37:35 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Wed, 22 May 2013 10:37:35 +0100
Subject: [R-sig-Geo] Space-time interpolation
Message-ID: <CABaJH79sUW+3wdFESQoK1SmhLiTe_Z2P5qF-bpMWceucgrg0yA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130522/9c531f92/attachment.pl>

From kat.emidio at gmail.com  Wed May 22 15:53:44 2013
From: kat.emidio at gmail.com (=?ISO-8859-1?Q?K=E1tia_Emidio?=)
Date: Wed, 22 May 2013 09:53:44 -0400
Subject: [R-sig-Geo] basic question
Message-ID: <CABFLJO=Xf3s+dQqqO0uPDMbQsS2u6JFA4+zSAsAVGAnzctV6mA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130522/8f1dceb6/attachment.pl>

From ashton at msu.edu  Wed May 22 16:12:55 2013
From: ashton at msu.edu (Ashton Shortridge)
Date: Wed, 22 May 2013 10:12:55 -0400
Subject: [R-sig-Geo] basic question
In-Reply-To: <CABFLJO=Xf3s+dQqqO0uPDMbQsS2u6JFA4+zSAsAVGAnzctV6mA@mail.gmail.com>
References: <CABFLJO=Xf3s+dQqqO0uPDMbQsS2u6JFA4+zSAsAVGAnzctV6mA@mail.gmail.com>
Message-ID: <201305221012.55873.ashton@msu.edu>

Hi K?tia,

this isn't really a spatial question, but here goes with an answer.

Your solution lies in the help documentation for the sample function. At the 
command prompt, type ?sample   for one way to access help. The basic 
command is this:
sample(x, size, replace = FALSE, prob = NULL)

For R beginners and experts alike, often the most helpful part of help is the 
usage section at the bottom of the documentation. You can run the example 
usage code at the command prompt to see what happens.

In your specific question, you can see that you simply do this:
x <- 1:12
sample(x, 5, replace=TRUE)  # probably duplicates; what you want, right?

so for your example, this should work:
h<-dados[sample(1:357,20, replace=TRUE),]


Yours,

Ashton

On 05/22/13, K?tia Emidio, wrote:
> does anyone could help me with do a sample from dataframe, using
> replacement equal True? I am a very beginner at R.
> 
>  without replacement, my script works...
> 
> h<-dados[sample(1:357,20),]# this is ok. from 357 rows, I take 20 ones,
> with all columms... How puts the replace=T ?
> thanks
> katia


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From alobolistas at gmail.com  Wed May 22 21:24:09 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 22 May 2013 21:24:09 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
	<alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
Message-ID: <CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>

Just got the very same problem on osx:
CRS("+init=epsg:3857")
Error in CRS("+init=epsg:3857") : no system list, errno: 2

I've reinstalled rgdal (using RStudio) but the error persists.
I also have the autodetected in the path:
> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.8-9, (SVN revision 470)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files:
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

Is there anything I can do or should I wait for a newer version of
rgdal to be on cran?
Not a big problem if have to wait, can use a linux machine.

Thanks

Agus

> sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.1-16 rgdal_0.8-9   sp_1.0-9

loaded via a namespace (and not attached):
[1] grid_3.0.0      lattice_0.20-15 tools_3.0.0

On Wed, May 15, 2013 at 10:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 15 May 2013, Ross Ahmed wrote:
>
>> I?ve recently reinstalled QGIS - might this have anything to do with it?
>
>
> Probably not.
>
>
>>
>>
>> # spTransform() works fine in the other example I posted to the group
>> yesterday:
>>
>> library(sp); library(rgeos); library(rgdal)
>> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
>> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
>> p = Polygon(polygonCoords)
>> myPolygon = Polygons(list(p),1)
>> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
>> +ellps=WGS84 +towgs84=0,0,0")
>> gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
>> +lat_0=55.7 +datum=WGS84")))/1e6
>> #[1] 5.796854
>>
>>
>>
>>
>> # But spTransform() fails in all other instances, for example:
>>
>> Library(maptools)
>> data(wrld_simpl)
>> spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
>> # Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
>> # error in evaluating the argument 'CRSobj' in selecting a method for
>> function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
>> errno: 2
>>
>>
>
> The failure is caused by no proj (or gdal) data files being available.
>
>
>>
>>
>>
>>
>>
>>
>> # rgdal() start up message
>>
>> library(rgdal)
>> Loading required package: sp
>> rgdal: version: 0.8-9, (SVN revision 470)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> Path to GDAL shared files:
>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> Path to PROJ.4 shared files: (autodetected)
>>
>
> These are the clues:
>
>
> Path to GDAL shared files:
> Path to PROJ.4 shared files: (autodetected)
>
> which should not look like this if you are on:
>
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> and installed rgdal as an OSX binary from CRAN. The current OSX binary is
> packaged without the proj/ and gdal/ subdirectories. I'll try to get them
> reinstated.
>
> Roger
>
>
>>
>>
>>
>>
>>
>> # sessionInfo() output
>>
>> sessionInfo()
>>
>> R version 3.0.0 (2013-04-03)
>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>
>> locale:
>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>
>> attached base packages:
>> [1] tcltk stats4 splines grid stats graphics grDevices utils datasets
>> methods
>> [11] base
>>
>> other attached packages:
>> [1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
>> [5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
>> [9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
>> [13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
>> [17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
>> [21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
>> [25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
>> [29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
>> [33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
>> [37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
>> [41] rgeos_0.2-17 sp_1.0-9
>>
>> loaded via a namespace (and not attached):
>> [1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
>> evaluate_0.4.3
>> [6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
>> [11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
>> [16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
>> tools_3.0.0
>>
>>
>>
>>
>>
>>
>> On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>
>>> On Tue, 14 May 2013, Ross Ahmed wrote:
>>>
>>>> I get the following error when running SpTransform, and error is
>>>> occurring
>>>> not matter what object I try to transform:
>>>>
>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>> no
>>>> system list, errno: 2
>>>>
>>>
>>> You must include all of the important information: all of sessionInfo()
>>> output, all of the startup messages given by rgdal on loading, and a
>>> reasonable example (this one isn't, the actual projection is unknown). I
>>> think you have installed rgdal from source on a system without the
>>> necessary extra files, but without knowledge of how you installed rgdal,
>>> it is not possible to tell.
>>>
>>> Roger
>>>
>>>>
>>>>
>>>> I?ve tried to replicate my code using the columbus
>>>> SpatialPolygonsDataFrame
>>>> from maptools package:
>>>>
>>>> setwd(system.file("shapes", package="maptools"))
>>>> columbus <- readShapeSpatial(?columbus.shp?)
>>>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>>>> +towgs84=0,0,0")
>>>> spTransform(columbus, CRS("+init=epsg:4326?))
>>>>
>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>> no
>>>> system list, errno: 2
>>>>
>>>>
>>>>
>>>> I?m using R 3.0.0
>>>>
>>>> Ross
>>>>
>>>>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Wed May 22 21:34:27 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 May 2013 21:34:27 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
	<alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
	<CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305222125270.4326@reclus.nhh.no>

On Wed, 22 May 2013, Agustin Lobo wrote:

> Just got the very same problem on osx:
> CRS("+init=epsg:3857")
> Error in CRS("+init=epsg:3857") : no system list, errno: 2

I have given the diagnosis in detail - the OSX CRAN rgdal binary has been 
built without the required configure argument --with-data-copy=yes. I am 
awaiting a response from the OSX maintainer (of all of R, not just rgdal). 
When he gets back to me, we'll know more about when the binary package can 
be rebuilt. While waiting, consider other OS, or consider installing 
William Kyngesburye's framework-based rgdal 0.8-8 for R 3.0 with GDAL 1.10 
(64-bit only).

Roger

>
> I've reinstalled rgdal (using RStudio) but the error persists.
> I also have the autodetected in the path:
>> require(rgdal)
> Loading required package: rgdal
> Loading required package: sp
> rgdal: version: 0.8-9, (SVN revision 470)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files:
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>
> Is there anything I can do or should I wait for a newer version of
> rgdal to be on cran?
> Not a big problem if have to wait, can use a linux machine.
>
> Thanks
>
> Agus
>
>> sessionInfo()
> R version 3.0.0 (2013-04-03)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.1-16 rgdal_0.8-9   sp_1.0-9
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.0      lattice_0.20-15 tools_3.0.0
>
> On Wed, May 15, 2013 at 10:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Wed, 15 May 2013, Ross Ahmed wrote:
>>
>>> I?ve recently reinstalled QGIS - might this have anything to do with it?
>>
>>
>> Probably not.
>>
>>
>>>
>>>
>>> # spTransform() works fine in the other example I posted to the group
>>> yesterday:
>>>
>>> library(sp); library(rgeos); library(rgdal)
>>> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
>>> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
>>> p = Polygon(polygonCoords)
>>> myPolygon = Polygons(list(p),1)
>>> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>>> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
>>> +ellps=WGS84 +towgs84=0,0,0")
>>> gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
>>> +lat_0=55.7 +datum=WGS84")))/1e6
>>> #[1] 5.796854
>>>
>>>
>>>
>>>
>>> # But spTransform() fails in all other instances, for example:
>>>
>>> Library(maptools)
>>> data(wrld_simpl)
>>> spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
>>> # Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
>>> # error in evaluating the argument 'CRSobj' in selecting a method for
>>> function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
>>> errno: 2
>>>
>>>
>>
>> The failure is caused by no proj (or gdal) data files being available.
>>
>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> # rgdal() start up message
>>>
>>> library(rgdal)
>>> Loading required package: sp
>>> rgdal: version: 0.8-9, (SVN revision 470)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>> Path to GDAL shared files:
>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>> Path to PROJ.4 shared files: (autodetected)
>>>
>>
>> These are the clues:
>>
>>
>> Path to GDAL shared files:
>> Path to PROJ.4 shared files: (autodetected)
>>
>> which should not look like this if you are on:
>>
>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>
>> and installed rgdal as an OSX binary from CRAN. The current OSX binary is
>> packaged without the proj/ and gdal/ subdirectories. I'll try to get them
>> reinstated.
>>
>> Roger
>>
>>
>>>
>>>
>>>
>>>
>>>
>>> # sessionInfo() output
>>>
>>> sessionInfo()
>>>
>>> R version 3.0.0 (2013-04-03)
>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>
>>> locale:
>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>
>>> attached base packages:
>>> [1] tcltk stats4 splines grid stats graphics grDevices utils datasets
>>> methods
>>> [11] base
>>>
>>> other attached packages:
>>> [1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
>>> [5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
>>> [9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
>>> [13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
>>> [17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
>>> [21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
>>> [25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
>>> [29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
>>> [33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
>>> [37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
>>> [41] rgeos_0.2-17 sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
>>> evaluate_0.4.3
>>> [6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
>>> [11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
>>> [16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
>>> tools_3.0.0
>>>
>>>
>>>
>>>
>>>
>>>
>>> On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Tue, 14 May 2013, Ross Ahmed wrote:
>>>>
>>>>> I get the following error when running SpTransform, and error is
>>>>> occurring
>>>>> not matter what object I try to transform:
>>>>>
>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>> no
>>>>> system list, errno: 2
>>>>>
>>>>
>>>> You must include all of the important information: all of sessionInfo()
>>>> output, all of the startup messages given by rgdal on loading, and a
>>>> reasonable example (this one isn't, the actual projection is unknown). I
>>>> think you have installed rgdal from source on a system without the
>>>> necessary extra files, but without knowledge of how you installed rgdal,
>>>> it is not possible to tell.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>>
>>>>> I?ve tried to replicate my code using the columbus
>>>>> SpatialPolygonsDataFrame
>>>>> from maptools package:
>>>>>
>>>>> setwd(system.file("shapes", package="maptools"))
>>>>> columbus <- readShapeSpatial(?columbus.shp?)
>>>>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>>>>> +towgs84=0,0,0")
>>>>> spTransform(columbus, CRS("+init=epsg:4326?))
>>>>>
>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>  error in evaluating the argument 'CRSobj' in selecting a method for
>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>> no
>>>>> system list, errno: 2
>>>>>
>>>>>
>>>>>
>>>>> I?m using R 3.0.0
>>>>>
>>>>> Ross
>>>>>
>>>>>
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From kevin.barnett at umconnect.umt.edu  Thu May 23 00:20:28 2013
From: kevin.barnett at umconnect.umt.edu (Kevin Barnett)
Date: Wed, 22 May 2013 15:20:28 -0700 (PDT)
Subject: [R-sig-Geo] split/divide SpatialLines (sp) into n segments
In-Reply-To: <alpine.LRH.2.03.1304101005220.8232@reclus.nhh.no>
References: <1365484162.62235.YahooMailNeo@web164902.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1304101005220.8232@reclus.nhh.no>
Message-ID: <1369261228681-7583629.post@n2.nabble.com>

I've been working on a problem related to the contents of this thread. 
Suppose I have a SpatialLines object representing the boundary of a study
area, and I would like to split/segment the line at sample points equally
spaced along the line.  I can connect the sample points with straight lines,
but I haven't figured out how to include the vertices of the SpatialLines
object between a given pair of sample points.  An example is below:  

library(sp)
Sl = SpatialLines(list(Lines(list(Line(cbind(c(1,2,2,1,1),c(1,1,2,2,1)))),
  ID="a")))

set.seed(123)
sample.points <- spsample(Sl, 10, type="regular")
plot(Sl)
plot(sample.points, pch=1, col="red", add=T)

cc <- coordinates(sample.points)
cc <- rbind(cc, cc[1,])

outputlist = list()
i <- 1
while(i < (nrow(cc))){
  coords1 <- cc[i,]
  coords2 <- cc[i+1,]
  bind <- rbind(coords1, coords2)
  outputlist[[i]] <- Lines(list(Line(bind)), as.character(i))
  i <- i+1
  }

out <- SpatialLines(outputlist)
plot(out, lty=2, col="green", add=T)

In this example, simply connecting the sample points with a straight line
would effectively cut off the corners of the original SpatialLines object. 
I can't seem to find an efficient solution that can be transferred to my
highly irregular SpatialLines object with thousands of sample points.

Thanks for any insight, 
Kevin       



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/split-divide-SpatialLines-sp-into-n-segments-tp7583234p7583629.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rossahmed at googlemail.com  Thu May 23 09:39:34 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Thu, 23 May 2013 08:39:34 +0100
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <alpine.LRH.2.03.1305222125270.4326@reclus.nhh.no>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
	<alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
	<CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>
	<alpine.LRH.2.03.1305222125270.4326@reclus.nhh.no>
Message-ID: <BB24DE1A-665D-419E-8053-3FE6A0040E76@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130523/8b06efa1/attachment.pl>

From Roger.Bivand at nhh.no  Thu May 23 11:12:01 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 May 2013 11:12:01 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <BB24DE1A-665D-419E-8053-3FE6A0040E76@gmail.com>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
	<alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
	<CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>
	<alpine.LRH.2.03.1305222125270.4326@reclus.nhh.no>
	<BB24DE1A-665D-419E-8053-3FE6A0040E76@gmail.com>
Message-ID: <alpine.LRH.2.03.1305231056020.6512@reclus.nhh.no>

On Thu, 23 May 2013, Ross Ahmed wrote:

> Just an update from me. I've tried following the installation guidelines 
> here, but following this, spTrasform is still giving the same error: 
> https://sites.google.com/site/eospansite/rspatial_gis/rgdalmac

As Agus notes at the head of the page (he wrote it some years ago), it 
isn't needed (and the NOTE 20110011 is also out of date and does not 
work).

>
> In addition, I've posted on r-sig-mac for help on how to solve the 
> problem, but have not had a response as yet: 
> https://stat.ethz.ch/pipermail/r-sig-mac/2013-May/010115.html

Thanks - next time only post plain text, as the contents of your posting 
are only linked to the archive, rather than being visible. Simon Urbanek 
replied to a posting on R-sig-Mac yesterday, but I'm sure he has plenty to 
do, and will get to this when he can.

As an emergency work-around for the brave, I've bundled the two missing 
directories with contents from my Linux machine as:

http://spatial.nhh.no/misc/rgdal-proj-gdal.tar.gz

which someone could unpack within the installed rgdal/ package directory. 
The owner and permissions of the files in the archive may need attention.

If someone tries this, please report back in-thread.

Roger

>
> Ross
>
> On 22 May 2013, at 20:34, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 22 May 2013, Agustin Lobo wrote:
>>
>>> Just got the very same problem on osx:
>>> CRS("+init=epsg:3857")
>>> Error in CRS("+init=epsg:3857") : no system list, errno: 2
>>
>> I have given the diagnosis in detail - the OSX CRAN rgdal binary has been built without the required configure argument --with-data-copy=yes. I am awaiting a response from the OSX maintainer (of all of R, not just rgdal). When he gets back to me, we'll know more about when the binary package can be rebuilt. While waiting, consider other OS, or consider installing William Kyngesburye's framework-based rgdal 0.8-8 for R 3.0 with GDAL 1.10 (64-bit only).
>>
>> Roger
>>
>>>
>>> I've reinstalled rgdal (using RStudio) but the error persists.
>>> I also have the autodetected in the path:
>>>> require(rgdal)
>>> Loading required package: rgdal
>>> Loading required package: sp
>>> rgdal: version: 0.8-9, (SVN revision 470)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>> Path to GDAL shared files:
>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>> Path to PROJ.4 shared files: (autodetected)
>>>
>>> Is there anything I can do or should I wait for a newer version of
>>> rgdal to be on cran?
>>> Not a big problem if have to wait, can use a linux machine.
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>>> sessionInfo()
>>> R version 3.0.0 (2013-04-03)
>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] raster_2.1-16 rgdal_0.8-9   sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.0      lattice_0.20-15 tools_3.0.0
>>>
>>> On Wed, May 15, 2013 at 10:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>> On Wed, 15 May 2013, Ross Ahmed wrote:
>>>>
>>>>> I?ve recently reinstalled QGIS - might this have anything to do with it?
>>>>
>>>>
>>>> Probably not.
>>>>
>>>>
>>>>>
>>>>>
>>>>> # spTransform() works fine in the other example I posted to the group
>>>>> yesterday:
>>>>>
>>>>> library(sp); library(rgeos); library(rgdal)
>>>>> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
>>>>> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
>>>>> p = Polygon(polygonCoords)
>>>>> myPolygon = Polygons(list(p),1)
>>>>> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>>>>> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
>>>>> +ellps=WGS84 +towgs84=0,0,0")
>>>>> gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
>>>>> +lat_0=55.7 +datum=WGS84")))/1e6
>>>>> #[1] 5.796854
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # But spTransform() fails in all other instances, for example:
>>>>>
>>>>> Library(maptools)
>>>>> data(wrld_simpl)
>>>>> spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
>>>>> # Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
>>>>> # error in evaluating the argument 'CRSobj' in selecting a method for
>>>>> function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
>>>>> errno: 2
>>>>
>>>> The failure is caused by no proj (or gdal) data files being available.
>>>>
>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # rgdal() start up message
>>>>>
>>>>> library(rgdal)
>>>>> Loading required package: sp
>>>>> rgdal: version: 0.8-9, (SVN revision 470)
>>>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>>>> Path to GDAL shared files:
>>>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>>>> Path to PROJ.4 shared files: (autodetected)
>>>>
>>>> These are the clues:
>>>>
>>>>
>>>> Path to GDAL shared files:
>>>> Path to PROJ.4 shared files: (autodetected)
>>>>
>>>> which should not look like this if you are on:
>>>>
>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>
>>>> and installed rgdal as an OSX binary from CRAN. The current OSX binary is
>>>> packaged without the proj/ and gdal/ subdirectories. I'll try to get them
>>>> reinstated.
>>>>
>>>> Roger
>>>>
>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # sessionInfo() output
>>>>>
>>>>> sessionInfo()
>>>>>
>>>>> R version 3.0.0 (2013-04-03)
>>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> [1] tcltk stats4 splines grid stats graphics grDevices utils datasets
>>>>> methods
>>>>> [11] base
>>>>>
>>>>> other attached packages:
>>>>> [1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
>>>>> [5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
>>>>> [9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
>>>>> [13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
>>>>> [17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
>>>>> [21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
>>>>> [25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
>>>>> [29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
>>>>> [33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
>>>>> [37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
>>>>> [41] rgeos_0.2-17 sp_1.0-9
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
>>>>> evaluate_0.4.3
>>>>> [6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
>>>>> [11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
>>>>> [16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
>>>>> tools_3.0.0
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>>>>
>>>>>> On Tue, 14 May 2013, Ross Ahmed wrote:
>>>>>>
>>>>>>> I get the following error when running SpTransform, and error is
>>>>>>> occurring
>>>>>>> not matter what object I try to transform:
>>>>>>>
>>>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>>> error in evaluating the argument 'CRSobj' in selecting a method for
>>>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>>>> no
>>>>>>> system list, errno: 2
>>>>>>
>>>>>> You must include all of the important information: all of sessionInfo()
>>>>>> output, all of the startup messages given by rgdal on loading, and a
>>>>>> reasonable example (this one isn't, the actual projection is unknown). I
>>>>>> think you have installed rgdal from source on a system without the
>>>>>> necessary extra files, but without knowledge of how you installed rgdal,
>>>>>> it is not possible to tell.
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> I?ve tried to replicate my code using the columbus
>>>>>>> SpatialPolygonsDataFrame
>>>>>>> from maptools package:
>>>>>>>
>>>>>>> setwd(system.file("shapes", package="maptools"))
>>>>>>> columbus <- readShapeSpatial(?columbus.shp?)
>>>>>>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>>>>>>> +towgs84=0,0,0")
>>>>>>> spTransform(columbus, CRS("+init=epsg:4326?))
>>>>>>>
>>>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>>> error in evaluating the argument 'CRSobj' in selecting a method for
>>>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>>>> no
>>>>>>> system list, errno: 2
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> I?m using R 3.0.0
>>>>>>>
>>>>>>> Ross
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>        [[alternative HTML version deleted]]
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alobolistas at gmail.com  Thu May 23 12:17:32 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 23 May 2013 12:17:32 +0200
Subject: [R-sig-Geo] spTransform error
In-Reply-To: <BB24DE1A-665D-419E-8053-3FE6A0040E76@gmail.com>
References: <CDB8EAF2.4CDF%rossahmed@gmail.com>
	<alpine.LRH.2.03.1305152219340.26621@reclus.nhh.no>
	<CAG4NReJA=NKeSxhTpnEAcY0zFY8AFSQuRy8msKrYZ-stBNubng@mail.gmail.com>
	<alpine.LRH.2.03.1305222125270.4326@reclus.nhh.no>
	<BB24DE1A-665D-419E-8053-3FE6A0040E76@gmail.com>
Message-ID: <CAG4NReKmLeiW=hHCCweG8XYEZT_AFLbhaQhaqs3vP=yap_E-+Q@mail.gmail.com>

Ross,

On Thu, May 23, 2013 at 9:39 AM, Ross Ahmed <rossahmed at googlemail.com> wrote:
> Just an update from me. I've tried following the installation guidelines here, but following this, spTrasform is still giving the same error: https://sites.google.com/site/eospansite/rspatial_gis/rgdalmac
Actually that page is very outdated and it is not the one you access
from the menu.
Nevertheless
https://sites.google.com/site/eospansite/rspatial_gis/rgdalmac2
is also outdated, I've included a note now. I apologize for not having
updated them. I use to write these pages before a course, and somebody
else took care of
the mac installations in the last one, so I did not and the pages are
really old now.
I'll probably will just remove that page, as installing rgdal on
macosx is now just as installing any other package.
The problems we are experiencing now will last few days only, as far
as I understand.
Meanwhile, installing rgdal from
http://www.kyngchaos.com/software/frameworks
should not be a problem, have you tried? Probably you must install
gdal1.10 (in the same page). I'm sorry I cannot help with this right
now.

Agus

> In addition, I've posted on r-sig-mac for help on how to solve the problem, but have not had a response as yet: https://stat.ethz.ch/pipermail/r-sig-mac/2013-May/010115.html
> Ross
>
> On 22 May 2013, at 20:34, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 22 May 2013, Agustin Lobo wrote:
>>
>>> Just got the very same problem on osx:
>>> CRS("+init=epsg:3857")
>>> Error in CRS("+init=epsg:3857") : no system list, errno: 2
>>
>> I have given the diagnosis in detail - the OSX CRAN rgdal binary has been built without the required configure argument --with-data-copy=yes. I am awaiting a response from the OSX maintainer (of all of R, not just rgdal). When he gets back to me, we'll know more about when the binary package can be rebuilt. While waiting, consider other OS, or consider installing William Kyngesburye's framework-based rgdal 0.8-8 for R 3.0 with GDAL 1.10 (64-bit only).
>>
>> Roger
>>
>>>
>>> I've reinstalled rgdal (using RStudio) but the error persists.
>>> I also have the autodetected in the path:
>>>> require(rgdal)
>>> Loading required package: rgdal
>>> Loading required package: sp
>>> rgdal: version: 0.8-9, (SVN revision 470)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>> Path to GDAL shared files:
>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>> Path to PROJ.4 shared files: (autodetected)
>>>
>>> Is there anything I can do or should I wait for a newer version of
>>> rgdal to be on cran?
>>> Not a big problem if have to wait, can use a linux machine.
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>>> sessionInfo()
>>> R version 3.0.0 (2013-04-03)
>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] raster_2.1-16 rgdal_0.8-9   sp_1.0-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.0      lattice_0.20-15 tools_3.0.0
>>>
>>> On Wed, May 15, 2013 at 10:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>> On Wed, 15 May 2013, Ross Ahmed wrote:
>>>>
>>>>> I?ve recently reinstalled QGIS - might this have anything to do with it?
>>>>
>>>>
>>>> Probably not.
>>>>
>>>>
>>>>>
>>>>>
>>>>> # spTransform() works fine in the other example I posted to the group
>>>>> yesterday:
>>>>>
>>>>> library(sp); library(rgeos); library(rgdal)
>>>>> polygonCoords <- matrix(c(-1.9450, -1.9075, -1.9075, -1.9450, -1.9450,
>>>>> 55.72476, 55.72476, 55.70267, 55.70267, 55.72476), ncol=2)
>>>>> p = Polygon(polygonCoords)
>>>>> myPolygon = Polygons(list(p),1)
>>>>> myPolygonSpatial = SpatialPolygons(list(myPolygon))
>>>>> proj4string(myPolygonSpatial) <- CRS("+proj=longlat +datum=WGS84
>>>>> +ellps=WGS84 +towgs84=0,0,0")
>>>>> gArea(spTransform(myPolygonSpatial, CRS("+proj=laea +lon_0=-1.92
>>>>> +lat_0=55.7 +datum=WGS84")))/1e6
>>>>> #[1] 5.796854
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # But spTransform() fails in all other instances, for example:
>>>>>
>>>>> Library(maptools)
>>>>> data(wrld_simpl)
>>>>> spTransform(wrld_simpl[1,], CRS("+init=epsg:4326"))
>>>>> # Error in spTransform(wrld_simpl[1, ], CRS("+init=epsg:4326")) :
>>>>> # error in evaluating the argument 'CRSobj' in selecting a method for
>>>>> function 'spTransform': Error in CRS("+init=epsg:4326") : no system list,
>>>>> errno: 2
>>>>
>>>> The failure is caused by no proj (or gdal) data files being available.
>>>>
>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # rgdal() start up message
>>>>>
>>>>> library(rgdal)
>>>>> Loading required package: sp
>>>>> rgdal: version: 0.8-9, (SVN revision 470)
>>>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>>>> Path to GDAL shared files:
>>>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>>>> Path to PROJ.4 shared files: (autodetected)
>>>>
>>>> These are the clues:
>>>>
>>>>
>>>> Path to GDAL shared files:
>>>> Path to PROJ.4 shared files: (autodetected)
>>>>
>>>> which should not look like this if you are on:
>>>>
>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>
>>>> and installed rgdal as an OSX binary from CRAN. The current OSX binary is
>>>> packaged without the proj/ and gdal/ subdirectories. I'll try to get them
>>>> reinstated.
>>>>
>>>> Roger
>>>>
>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> # sessionInfo() output
>>>>>
>>>>> sessionInfo()
>>>>>
>>>>> R version 3.0.0 (2013-04-03)
>>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> [1] tcltk stats4 splines grid stats graphics grDevices utils datasets
>>>>> methods
>>>>> [11] base
>>>>>
>>>>> other attached packages:
>>>>> [1] Hmisc_3.10-1.1 adehabitat_1.8.12 shapefiles_0.7 tkrplot_0.0-23
>>>>> [5] ggmap_2.3 formatR_0.7 lme4_0.999999-2 Matrix_1.0-12
>>>>> [9] adehabitatHR_0.4.7 adehabitatLT_0.3.11 CircStats_0.2-4 MASS_7.3-26
>>>>> [13] adehabitatMA_0.3.6 ade4_1.5-2 spatialsegregation_2.38 dismo_0.8-11
>>>>> [17] raster_2.1-25 geosphere_1.2-28 knitr_1.2 lubridate_1.3.0
>>>>> [21] stringr_0.6.2 boot_1.3-9 coin_1.0-22 modeltools_0.2-19
>>>>> [25] mvtnorm_0.9-9994 survival_2.37-4 gmodels_2.15.4 ggplot2_0.9.3.1
>>>>> [29] spatstat_1.31-2 deldir_0.0-22 mgcv_1.7-22 bibtex_0.3-5
>>>>> [33] plyr_1.8 reshape2_1.2.2 ProjectTemplate_0.4-2 testthat_0.7.1
>>>>> [37] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53 rgdal_0.8-9
>>>>> [41] rgeos_0.2-17 sp_1.0-9
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] cluster_1.14.4 colorspace_1.2-2 dichromat_2.0-0 digest_0.6.3
>>>>> evaluate_0.4.3
>>>>> [6] gdata_2.12.0.2 gtable_0.1.2 gtools_2.7.1 labeling_0.1 mapproj_1.2-1
>>>>> [11] maps_2.3-2 munsell_0.4 nlme_3.1-109 png_0.1-4 proto_0.3-10
>>>>> [16] RColorBrewer_1.0-5 RgoogleMaps_1.2.0.3 rjson_0.2.12 scales_0.2.3
>>>>> tools_3.0.0
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On 14/05/2013 22:33, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>>>>
>>>>>> On Tue, 14 May 2013, Ross Ahmed wrote:
>>>>>>
>>>>>>> I get the following error when running SpTransform, and error is
>>>>>>> occurring
>>>>>>> not matter what object I try to transform:
>>>>>>>
>>>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>>> error in evaluating the argument 'CRSobj' in selecting a method for
>>>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>>>> no
>>>>>>> system list, errno: 2
>>>>>>
>>>>>> You must include all of the important information: all of sessionInfo()
>>>>>> output, all of the startup messages given by rgdal on loading, and a
>>>>>> reasonable example (this one isn't, the actual projection is unknown). I
>>>>>> think you have installed rgdal from source on a system without the
>>>>>> necessary extra files, but without knowledge of how you installed rgdal,
>>>>>> it is not possible to tell.
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> I?ve tried to replicate my code using the columbus
>>>>>>> SpatialPolygonsDataFrame
>>>>>>> from maptools package:
>>>>>>>
>>>>>>> setwd(system.file("shapes", package="maptools"))
>>>>>>> columbus <- readShapeSpatial(?columbus.shp?)
>>>>>>> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
>>>>>>> +towgs84=0,0,0")
>>>>>>> spTransform(columbus, CRS("+init=epsg:4326?))
>>>>>>>
>>>>>>> Error in spTransform(columbus, CRS("+init=epsg:27700 +datum=WGS84")) :
>>>>>>> error in evaluating the argument 'CRSobj' in selecting a method for
>>>>>>> function 'spTransform': Error in CRS("+init=epsg:27700 +datum=WGS84") :
>>>>>>> no
>>>>>>> system list, errno: 2
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> I?m using R 3.0.0
>>>>>>>
>>>>>>> Ross
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>        [[alternative HTML version deleted]]
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Craig.Mundy at utas.edu.au  Thu May 23 15:42:24 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Thu, 23 May 2013 06:42:24 -0700 (PDT)
Subject: [R-sig-Geo] Bug in writeOGR MSSQLSpatial driver?
Message-ID: <1369316544847-7583633.post@n2.nabble.com>

Hi All,

Trying to run a well used script over the last few days has shown up an
error when writing a SpatialPolygonDataFrame to SQL SERVER using writeOGR.
This script worked 4 weeks ago, so I assume it is do with updates in the
latest version of rgdal.

The write attempt creates a new table in SQL SERVER, inserts a single row,
then exits with the following error.

> writeOGR(polyunion90df, dsn=dsn, layer=lyrout90, driver="MSSQLSpatial",
> layer_options=c("SRID=28355"))
Error in writeOGR(polyunion90df, dsn = dsnAbTrack_Analysis_SBY, layer =
lyrout90,  : 
  Failed to create feature

The single feature written to SQL Server appears normal, except the ogr_fid
field contains the following value "-2147483648".

The write attempt seems to update the geometry_column table successfully.

Using writeOGR with the ESRI shapefile driver successfully writes the SPDF
to a shapefile, which imports normally to a GIS.

writeOGR works normally if I run R 2.15.3 with rgdal 0.8-6.

quizzing the SQL SERVER spatial feature returns the following

ogrInfo returns the following

> ogrInfo(dsnAbTrack_Analysis_SBY, 'kud2012_test')
Source: "MSSQL:server=MyServer;database=MyDatabase;trusted_connection=yes",
layer: "kud2012_test"
Driver: MSSQLSpatial number of rows 1 
Feature type: wkbMultiPolygon with 2 dimensions
Extent: (608073.9 5543662) - (608322.9 5544055)
CRS: +proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
+no_defs  
Number of fields: 19 
            name type length typeName
1          names    4      0   String
2         diveid    4      0   String
3        dropnum    0     10  Integer
4        dvstart    4      0   String
5          dvend    4      0   String
6        avgdpth    2      0     Real
7        avgtemp    2      0     Real
8      catchblkg    2      0     Real
9      catchglkg    2      0     Real
10 blip_gps_cpue    2      0     Real
11  blip_qd_cpue    2      0     Real
12 glip_gps_cpue    2      0     Real
13  glip_qd_cpue    2      0     Real
14      duration    2      0     Real
15       numpoly    0     10  Integer
16       maxdist    2      0     Real
17         parea    2      0     Real
18         haphr    2      0     Real
19         lmphr    2      0     Real


ogrFid info provides the following

> ogrFIDs(dsnAbTrack_Analysis_SBY, 'kud2012_test')
[1] NA
attr(,"nf")
[1] 1
attr(,"i")
[1] 1

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_Australia.1252 
[2] LC_CTYPE=English_Australia.1252   
[3] LC_MONETARY=English_Australia.1252
[4] LC_NUMERIC=C                      
[5] LC_TIME=English_Australia.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods  
[7] base     

loaded via a namespace (and not attached):
[1] tools_3.0.1
> library(rgdal)
Loading required package: sp
rgdal: version: 0.8-9, (SVN revision 470)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
GDAL does not use iconv for recoding strings.
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: C:/Program Files/R/R-3.0.1/library/rgdal/proj


Hoping the developers can help?

Thanks

Craig




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bug-in-writeOGR-MSSQLSpatial-driver-tp7583633.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu May 23 16:10:35 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 May 2013 16:10:35 +0200
Subject: [R-sig-Geo] Bug in writeOGR MSSQLSpatial driver?
In-Reply-To: <1369316544847-7583633.post@n2.nabble.com>
References: <1369316544847-7583633.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1305231553560.6512@reclus.nhh.no>

On Thu, 23 May 2013, cmundy wrote:

> Hi All,
>
> Trying to run a well used script over the last few days has shown up an
> error when writing a SpatialPolygonDataFrame to SQL SERVER using writeOGR.
> This script worked 4 weeks ago, so I assume it is do with updates in the
> latest version of rgdal.

This can be seen by comparing SVN revisions in the R-forge rgdal project:

https://r-forge.r-project.org/scm/viewvc.php/pkg/R/ogr_write.R?root=rgdal&r1=408&r2=468

As you can see, writeOGR() takes the row.names of the object, coerces them 
to integer (because OGR only uses long integer FIDs), and if any are NA, 
should replace them with default integer. You'll see the typo in line 135. 
These are then inserted using the C code.

https://r-forge.r-project.org/scm/viewvc.php/pkg/src/OGR_write.cpp?root=rgdal&r1=394&r2=468

I've committed the fix to R-forge (revision 473), but for now as a 
work-around that should avoid the bug, assign character row names that 
converts to integer without NA to:

row.names(polyunion90df) # shows the input value
row.names(polyunion90df) <- "<integers as strings>" # one for each row
row.names(polyunion90df) # check that it got assigned
as.integer(row.names(polyunion90df)) # check that it isn't NA but integer

Hope this helps,

Roger


>
> The write attempt creates a new table in SQL SERVER, inserts a single row,
> then exits with the following error.
>
>> writeOGR(polyunion90df, dsn=dsn, layer=lyrout90, driver="MSSQLSpatial",
>> layer_options=c("SRID=28355"))
> Error in writeOGR(polyunion90df, dsn = dsnAbTrack_Analysis_SBY, layer =
> lyrout90,  :
>  Failed to create feature
>
> The single feature written to SQL Server appears normal, except the ogr_fid
> field contains the following value "-2147483648".
>
> The write attempt seems to update the geometry_column table successfully.
>
> Using writeOGR with the ESRI shapefile driver successfully writes the SPDF
> to a shapefile, which imports normally to a GIS.
>
> writeOGR works normally if I run R 2.15.3 with rgdal 0.8-6.
>
> quizzing the SQL SERVER spatial feature returns the following
>
> ogrInfo returns the following
>
>> ogrInfo(dsnAbTrack_Analysis_SBY, 'kud2012_test')
> Source: "MSSQL:server=MyServer;database=MyDatabase;trusted_connection=yes",
> layer: "kud2012_test"
> Driver: MSSQLSpatial number of rows 1
> Feature type: wkbMultiPolygon with 2 dimensions
> Extent: (608073.9 5543662) - (608322.9 5544055)
> CRS: +proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
> Number of fields: 19
>            name type length typeName
> 1          names    4      0   String
> 2         diveid    4      0   String
> 3        dropnum    0     10  Integer
> 4        dvstart    4      0   String
> 5          dvend    4      0   String
> 6        avgdpth    2      0     Real
> 7        avgtemp    2      0     Real
> 8      catchblkg    2      0     Real
> 9      catchglkg    2      0     Real
> 10 blip_gps_cpue    2      0     Real
> 11  blip_qd_cpue    2      0     Real
> 12 glip_gps_cpue    2      0     Real
> 13  glip_qd_cpue    2      0     Real
> 14      duration    2      0     Real
> 15       numpoly    0     10  Integer
> 16       maxdist    2      0     Real
> 17         parea    2      0     Real
> 18         haphr    2      0     Real
> 19         lmphr    2      0     Real
>
>
> ogrFid info provides the following
>
>> ogrFIDs(dsnAbTrack_Analysis_SBY, 'kud2012_test')
> [1] NA
> attr(,"nf")
> [1] 1
> attr(,"i")
> [1] 1
>
>> sessionInfo()
> R version 3.0.1 (2013-05-16)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_Australia.1252
> [2] LC_CTYPE=English_Australia.1252
> [3] LC_MONETARY=English_Australia.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_Australia.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods
> [7] base
>
> loaded via a namespace (and not attached):
> [1] tools_3.0.1
>> library(rgdal)
> Loading required package: sp
> rgdal: version: 0.8-9, (SVN revision 470)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
> GDAL does not use iconv for recoding strings.
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> Path to PROJ.4 shared files: C:/Program Files/R/R-3.0.1/library/rgdal/proj
>
>
> Hoping the developers can help?
>
> Thanks
>
> Craig
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bug-in-writeOGR-MSSQLSpatial-driver-tp7583633.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kgfisher at alumni.unc.edu  Thu May 23 17:00:54 2013
From: kgfisher at alumni.unc.edu (karengrace84)
Date: Thu, 23 May 2013 08:00:54 -0700 (PDT)
Subject: [R-sig-Geo] point.in.polygon() or over() help?
Message-ID: <1369321254094-7583635.post@n2.nabble.com>

I am new to mapping with R and having some trouble. Here is what I am trying
to accomplish. I am looking at fish tagging data. I have gps coordinates of
where each fish was tagged and released, and I have a map of 10 coastal
basins of the state of Louisiana. I am trying to determine which basin each
fish was tagged in, so that I can perform further analysis from there.

I've used the sp and rgdal packages to input my shp files of the coastal
basins, and I have my list of gps coordinates where the fish were tagged.
I've tried using the point.in.polygon() function and the over() function
from the sp package unsuccessfully. Can someone please tell me how to use
one of these functions correctly, or if there is a better way to reach my
goal?

For the point.in.polygon() function, I am unsure of how to get my data in
the correct format for the function. The generic form of the function is as
follows: 

point.in.polygon(point.x, point.y, pol.x, pol.y, mode.checked=FALSE) 

I have no problem with the point.x and point.y inputs. My problem is with
the pol.x and pol.y input. My polygon is currently in the form of a
SpatialPolygonsDataFrame. How do I get a numerical array of the x- and
y-coordinates from my polygon that will go into the point.in.polygon
function?

Or for the over() function (x %over% y), with x as my SpatialPoints (the gps
coordinates) and y as my SpatialPolygonsDataFrame (the basin), I receive the
following error message, Error: identicalCRS(x, y) is not TRUE.

Thanks for any suggestions.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/point-in-polygon-or-over-help-tp7583635.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zaholdenfs at gmail.com  Thu May 23 17:07:41 2013
From: zaholdenfs at gmail.com (Zack Holden)
Date: Thu, 23 May 2013 09:07:41 -0600
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <1369321254094-7583635.post@n2.nabble.com>
References: <1369321254094-7583635.post@n2.nabble.com>
Message-ID: <CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130523/741c9b7a/attachment.pl>

From Roger.Bivand at nhh.no  Thu May 23 17:17:39 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 May 2013 17:17:39 +0200
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>

On Thu, 23 May 2013, Zack Holden wrote:

> Karen,
> you could try converting your polygons to raster using rasterize() in the
> raster library, and then use the extract() function to retrieve the cell
> values corresponding to your XY locations. I've used this workaround for
> similar problems in the past.

No, not a good idea. The error message from over() was given for a reason, 
that if the points and the polygon are not known to be in the same 
projection, then the outcome may be misleading. So my guess would be that 
the GPS are geographical coordinates and the coastal basins in State Plane 
appropriate for the location. Look at proj4string() of each object, and if 
they differ in predictable ways, use spTransform() to convert points to 
the polygons' projection, or vice-versa. over() does know what it is 
doing.

Hope this clarifies,

Roger

>
> Zack
>
>
>
> On Thu, May 23, 2013 at 9:00 AM, karengrace84 <kgfisher at alumni.unc.edu>wrote:
>
>> I am new to mapping with R and having some trouble. Here is what I am
>> trying
>> to accomplish. I am looking at fish tagging data. I have gps coordinates of
>> where each fish was tagged and released, and I have a map of 10 coastal
>> basins of the state of Louisiana. I am trying to determine which basin each
>> fish was tagged in, so that I can perform further analysis from there.
>>
>> I've used the sp and rgdal packages to input my shp files of the coastal
>> basins, and I have my list of gps coordinates where the fish were tagged.
>> I've tried using the point.in.polygon() function and the over() function
>> from the sp package unsuccessfully. Can someone please tell me how to use
>> one of these functions correctly, or if there is a better way to reach my
>> goal?
>>
>> For the point.in.polygon() function, I am unsure of how to get my data in
>> the correct format for the function. The generic form of the function is as
>> follows:
>>
>> point.in.polygon(point.x, point.y, pol.x, pol.y, mode.checked=FALSE)
>>
>> I have no problem with the point.x and point.y inputs. My problem is with
>> the pol.x and pol.y input. My polygon is currently in the form of a
>> SpatialPolygonsDataFrame. How do I get a numerical array of the x- and
>> y-coordinates from my polygon that will go into the point.in.polygon
>> function?
>>
>> Or for the over() function (x %over% y), with x as my SpatialPoints (the
>> gps
>> coordinates) and y as my SpatialPolygonsDataFrame (the basin), I receive
>> the
>> following error message, Error: identicalCRS(x, y) is not TRUE.
>>
>> Thanks for any suggestions.
>>
>>
>>
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/point-in-polygon-or-over-help-tp7583635.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kgfisher at alumni.unc.edu  Thu May 23 17:40:16 2013
From: kgfisher at alumni.unc.edu (karengrace84)
Date: Thu, 23 May 2013 08:40:16 -0700 (PDT)
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
	<alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
Message-ID: <1369323616574-7583638.post@n2.nabble.com>

Hi Roger- Getting closer to fixing the problem. You were correct with the
proj4string differing. The fish capture coordinates are "NA" and the Basins
are "+proj=longlat +ellps=WGS84." So now I am trying to convert the points.
Here is the code I input:

cap.coords.sp<-spTransform(cap.coords.sp,CRS("+proj=longlat"))

But I am getting the error message "No transformation possible from NA
reference system."

Any tips?



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/point-in-polygon-or-over-help-tp7583635p7583638.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From chris.waigl at gi.alaska.edu  Thu May 23 19:08:42 2013
From: chris.waigl at gi.alaska.edu (Chris Waigl)
Date: Thu, 23 May 2013 09:08:42 -0800
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <1369323616574-7583638.post@n2.nabble.com>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
	<alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
	<1369323616574-7583638.post@n2.nabble.com>
Message-ID: <E5283EEF-185E-4BC2-9FBF-1022C700872C@gi.alaska.edu>


> 
> Hi Roger- Getting closer to fixing the problem. You were correct with the
> proj4string differing. The fish capture coordinates are "NA" and the Basins
> are "+proj=longlat +ellps=WGS84." So now I am trying to convert the points.
> Here is the code I input:
> 
> cap.coords.sp<-spTransform(cap.coords.sp,CRS("+proj=longlat"))

Would this work:

proj4string(cap.coords.sp) <- "+proj=longlat +datum=WGS84"

(Or maybe "+proj=longlat +ellps=WGS84" -- not sure why I use +datum and you use +ellps.)

Best regards,

Chris Waigl

From edzer.pebesma at uni-muenster.de  Thu May 23 21:30:53 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 23 May 2013 21:30:53 +0200
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <E5283EEF-185E-4BC2-9FBF-1022C700872C@gi.alaska.edu>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
	<alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
	<1369323616574-7583638.post@n2.nabble.com>
	<E5283EEF-185E-4BC2-9FBF-1022C700872C@gi.alaska.edu>
Message-ID: <519E6E6D.1030802@uni-muenster.de>



On 05/23/2013 07:08 PM, Chris Waigl wrote:
> 
>>
>> Hi Roger- Getting closer to fixing the problem. You were correct with the
>> proj4string differing. The fish capture coordinates are "NA" and the Basins
>> are "+proj=longlat +ellps=WGS84." So now I am trying to convert the points.
>> Here is the code I input:
>>
>> cap.coords.sp<-spTransform(cap.coords.sp,CRS("+proj=longlat"))
> 
> Would this work:
> 
> proj4string(cap.coords.sp) <- "+proj=longlat +datum=WGS84"

this will only change the proj4string, but not reproject (and warn about
this fact).

You have to use spTransform with the string containing the datum.

> 
> (Or maybe "+proj=longlat +ellps=WGS84" -- not sure why I use +datum and you use +ellps.)
> 
> Best regards,
> 
> Chris Waigl
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From tephilippi at gmail.com  Thu May 23 21:50:22 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Thu, 23 May 2013 12:50:22 -0700
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <519E6E6D.1030802@uni-muenster.de>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
	<alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
	<1369323616574-7583638.post@n2.nabble.com>
	<E5283EEF-185E-4BC2-9FBF-1022C700872C@gi.alaska.edu>
	<519E6E6D.1030802@uni-muenster.de>
Message-ID: <CALyPt8wRWbWPqCEuVY6JOMY+-qQb3jNqBN+kFTfa9srpCrXa9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130523/499bb40b/attachment.pl>

From tephilippi at gmail.com  Thu May 23 21:57:58 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Thu, 23 May 2013 12:57:58 -0700
Subject: [R-sig-Geo] point.in.polygon() or over() help?
In-Reply-To: <CALyPt8wRWbWPqCEuVY6JOMY+-qQb3jNqBN+kFTfa9srpCrXa9A@mail.gmail.com>
References: <1369321254094-7583635.post@n2.nabble.com>
	<CAGC_mZRV2-XPtbr68-kPxd=fWKsMyP5h4e9s4oyRBOfjbQVRBA@mail.gmail.com>
	<alpine.LRH.2.03.1305231713200.6512@reclus.nhh.no>
	<1369323616574-7583638.post@n2.nabble.com>
	<E5283EEF-185E-4BC2-9FBF-1022C700872C@gi.alaska.edu>
	<519E6E6D.1030802@uni-muenster.de>
	<CALyPt8wRWbWPqCEuVY6JOMY+-qQb3jNqBN+kFTfa9srpCrXa9A@mail.gmail.com>
Message-ID: <CALyPt8xsXCQ61nG40GAgPx3Lx6wYjz=dyTaw6Y78MOKaAAu7GA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130523/fac7afb6/attachment.pl>

From samanmonfared1 at gmail.com  Thu May 23 22:02:02 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Fri, 24 May 2013 00:32:02 +0430
Subject: [R-sig-Geo] fit.variogram.reml
Message-ID: <CAOytA4ZetcNdio3hKW6WjsaqHtaWk-gvd8jBdfR5tZsbrMHkVg@mail.gmail.com>

Hi,
In gstat and  package the fit.variogram.reml function provided for
RMLE method to  estimation of variogram parameters. This function only
estimate nugget and sill and range parameter is fix.

for example:

v.rml<-fit.variogram.reml(rate~1,data,model =vgm(200000,"Sph",95241.99,0))
v.rml
  model     psill    range
1   Nug -1711.462     0.00
2   Sph  3431.108 95241.99

How can I set the best range value?
If  exist a way to estimate range like( fit.ranges = TRUE) in
fit.variogram function?

Best,

-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From edzer.pebesma at uni-muenster.de  Thu May 23 22:20:43 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 23 May 2013 22:20:43 +0200
Subject: [R-sig-Geo] fit.variogram.reml
In-Reply-To: <CAOytA4ZetcNdio3hKW6WjsaqHtaWk-gvd8jBdfR5tZsbrMHkVg@mail.gmail.com>
References: <CAOytA4ZetcNdio3hKW6WjsaqHtaWk-gvd8jBdfR5tZsbrMHkVg@mail.gmail.com>
Message-ID: <519E7A1B.4000207@uni-muenster.de>

Saman, package geoR contains functions for (RE)ML fitting that also fit
the range parameter.

Please note that in your output below the nugget is negative, which
can't be the case -- one could argue that this is a software error.

On 05/23/2013 10:02 PM, Saman Monfared wrote:
> Hi,
> In gstat and  package the fit.variogram.reml function provided for
> RMLE method to  estimation of variogram parameters. This function only
> estimate nugget and sill and range parameter is fix.
> 
> for example:
> 
> v.rml<-fit.variogram.reml(rate~1,data,model =vgm(200000,"Sph",95241.99,0))
> v.rml
>   model     psill    range
> 1   Nug -1711.462     0.00
> 2   Sph  3431.108 95241.99
> 
> How can I set the best range value?
> If  exist a way to estimate range like( fit.ranges = TRUE) in
> fit.variogram function?
> 
> Best,
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From zaholdenfs at gmail.com  Fri May 24 00:41:17 2013
From: zaholdenfs at gmail.com (Zack Holden)
Date: Thu, 23 May 2013 16:41:17 -0600
Subject: [R-sig-Geo] raster/ncdf4 error: too many open files
Message-ID: <CAGC_mZQkA58G1AqO4fEM0Q+F=COFz8cksP8QGx1J7oGkEYKfjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130523/4bfbf6f6/attachment.pl>

From mohglimoor at gmail.com  Fri May 24 00:55:02 2013
From: mohglimoor at gmail.com (mohglimoor at gmail.com)
Date: Fri, 24 May 2013 00:55:02 +0200
Subject: [R-sig-Geo] Problem Raster Overlay
Message-ID: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/69e6958a/attachment.pl>

From paulojus at c3sl.ufpr.br  Fri May 24 04:14:11 2013
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Thu, 23 May 2013 23:14:11 -0300 (BRT)
Subject: [R-sig-Geo] fit.variogram.reml
In-Reply-To: <519E7A1B.4000207@uni-muenster.de>
References: <CAOytA4ZetcNdio3hKW6WjsaqHtaWk-gvd8jBdfR5tZsbrMHkVg@mail.gmail.com>
	<519E7A1B.4000207@uni-muenster.de>
Message-ID: <alpine.DEB.2.02.1305232311490.25030@macalan.c3sl.ufpr.br>

I'm unsure the REML's in gstat and geoR reffer to the same method.
In the former the REML is based on the sample variogram
whereas for the latter the REML is applied to the assumed
(Gaussian) distribution of the data, in a modification of
the original likelihood function.



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Thu, 23 May 2013, Edzer Pebesma wrote:

> Saman, package geoR contains functions for (RE)ML fitting that also fit
> the range parameter.
>
> Please note that in your output below the nugget is negative, which
> can't be the case -- one could argue that this is a software error.
>
> On 05/23/2013 10:02 PM, Saman Monfared wrote:
>> Hi,
>> In gstat and  package the fit.variogram.reml function provided for
>> RMLE method to  estimation of variogram parameters. This function only
>> estimate nugget and sill and range parameter is fix.
>>
>> for example:
>>
>> v.rml<-fit.variogram.reml(rate~1,data,model =vgm(200000,"Sph",95241.99,0))
>> v.rml
>>   model     psill    range
>> 1   Nug -1711.462     0.00
>> 2   Sph  3431.108 95241.99
>>
>> How can I set the best range value?
>> If  exist a way to estimate range like( fit.ranges = TRUE) in
>> fit.variogram function?
>>
>> Best,
>>
>
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From Craig.Mundy at utas.edu.au  Fri May 24 07:34:57 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Thu, 23 May 2013 22:34:57 -0700 (PDT)
Subject: [R-sig-Geo] Bug in writeOGR MSSQLSpatial driver?
In-Reply-To: <alpine.LRH.2.03.1305231553560.6512@reclus.nhh.no>
References: <1369316544847-7583633.post@n2.nabble.com>
	<alpine.LRH.2.03.1305231553560.6512@reclus.nhh.no>
Message-ID: <1369373697832-7583649.post@n2.nabble.com>

Thanks Roger

This didn't quite work

> row.names(polyunion90df) <- "<integers as strings>" # one for each row
Error in spChFIDs(SP, x) : lengths differ

But this did,

row.names(polyunion90df) <- as.character(1:nrow(polyunion90df))

I suspect part of the problem was my use of an ID variable for the FID that
includes numeric and character info.  That flowed from using spCbind to
match up some additional metadata to each feature. 

Many thanks

Craig

Craig



Roger Bivand wrote
> On Thu, 23 May 2013, cmundy wrote:
> 
>> Hi All,
>>
>> Trying to run a well used script over the last few days has shown up an
>> error when writing a SpatialPolygonDataFrame to SQL SERVER using
>> writeOGR.
>> This script worked 4 weeks ago, so I assume it is do with updates in the
>> latest version of rgdal.
> 
> This can be seen by comparing SVN revisions in the R-forge rgdal project:
> 
> https://r-forge.r-project.org/scm/viewvc.php/pkg/R/ogr_write.R?root=rgdal&r1=408&r2=468
> 
> As you can see, writeOGR() takes the row.names of the object, coerces them 
> to integer (because OGR only uses long integer FIDs), and if any are NA, 
> should replace them with default integer. You'll see the typo in line 135. 
> These are then inserted using the C code.
> 
> https://r-forge.r-project.org/scm/viewvc.php/pkg/src/OGR_write.cpp?root=rgdal&r1=394&r2=468
> 
> I've committed the fix to R-forge (revision 473), but for now as a 
> work-around that should avoid the bug, assign character row names that 
> converts to integer without NA to:
> 
> row.names(polyunion90df) # shows the input value
> row.names(polyunion90df) <- "
> <integers as strings>
> " # one for each row
> row.names(polyunion90df) # check that it got assigned
> as.integer(row.names(polyunion90df)) # check that it isn't NA but integer
> 
> Hope this helps,
> 
> Roger
> 
> 
>>
>> The write attempt creates a new table in SQL SERVER, inserts a single
>> row,
>> then exits with the following error.
>>
>>> writeOGR(polyunion90df, dsn=dsn, layer=lyrout90, driver="MSSQLSpatial",
>>> layer_options=c("SRID=28355"))
>> Error in writeOGR(polyunion90df, dsn = dsnAbTrack_Analysis_SBY, layer =
>> lyrout90,  :
>>  Failed to create feature
>>
>> The single feature written to SQL Server appears normal, except the
>> ogr_fid
>> field contains the following value "-2147483648".
>>
>> The write attempt seems to update the geometry_column table successfully.
>>
>> Using writeOGR with the ESRI shapefile driver successfully writes the
>> SPDF
>> to a shapefile, which imports normally to a GIS.
>>
>> writeOGR works normally if I run R 2.15.3 with rgdal 0.8-6.
>>
>> quizzing the SQL SERVER spatial feature returns the following
>>
>> ogrInfo returns the following
>>
>>> ogrInfo(dsnAbTrack_Analysis_SBY, 'kud2012_test')
>> Source:
>> "MSSQL:server=MyServer;database=MyDatabase;trusted_connection=yes",
>> layer: "kud2012_test"
>> Driver: MSSQLSpatial number of rows 1
>> Feature type: wkbMultiPolygon with 2 dimensions
>> Extent: (608073.9 5543662) - (608322.9 5544055)
>> CRS: +proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> +units=m
>> +no_defs
>> Number of fields: 19
>>            name type length typeName
>> 1          names    4      0   String
>> 2         diveid    4      0   String
>> 3        dropnum    0     10  Integer
>> 4        dvstart    4      0   String
>> 5          dvend    4      0   String
>> 6        avgdpth    2      0     Real
>> 7        avgtemp    2      0     Real
>> 8      catchblkg    2      0     Real
>> 9      catchglkg    2      0     Real
>> 10 blip_gps_cpue    2      0     Real
>> 11  blip_qd_cpue    2      0     Real
>> 12 glip_gps_cpue    2      0     Real
>> 13  glip_qd_cpue    2      0     Real
>> 14      duration    2      0     Real
>> 15       numpoly    0     10  Integer
>> 16       maxdist    2      0     Real
>> 17         parea    2      0     Real
>> 18         haphr    2      0     Real
>> 19         lmphr    2      0     Real
>>
>>
>> ogrFid info provides the following
>>
>>> ogrFIDs(dsnAbTrack_Analysis_SBY, 'kud2012_test')
>> [1] NA
>> attr(,"nf")
>> [1] 1
>> attr(,"i")
>> [1] 1
>>
>>> sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_Australia.1252
>> [2] LC_CTYPE=English_Australia.1252
>> [3] LC_MONETARY=English_Australia.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_Australia.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods
>> [7] base
>>
>> loaded via a namespace (and not attached):
>> [1] tools_3.0.1
>>> library(rgdal)
>> Loading required package: sp
>> rgdal: version: 0.8-9, (SVN revision 470)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
>> GDAL does not use iconv for recoding strings.
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: C:/Program
>> Files/R/R-3.0.1/library/rgdal/proj
>>
>>
>> Hoping the developers can help?
>>
>> Thanks
>>
>> Craig
>>
>>
>>
>>
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/Bug-in-writeOGR-MSSQLSpatial-driver-tp7583633.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> 

> R-sig-Geo@

>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: 

> Roger.Bivand@

> 
> _______________________________________________
> R-sig-Geo mailing list

> R-sig-Geo@

> https://stat.ethz.ch/mailman/listinfo/r-sig-geo





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Bug-in-writeOGR-MSSQLSpatial-driver-tp7583633p7583649.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From s6lihert at uni-bonn.de  Fri May 24 08:40:24 2013
From: s6lihert at uni-bonn.de (Lionel Hertzog)
Date: Fri, 24 May 2013 08:40:24 +0200
Subject: [R-sig-Geo] Problem Raster Overlay
In-Reply-To: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>
References: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>
Message-ID: <519F0B58.6050805@uni-bonn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/9a7870c3/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri May 24 09:30:28 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 24 May 2013 09:30:28 +0200
Subject: [R-sig-Geo] fit.variogram.reml
In-Reply-To: <alpine.DEB.2.02.1305232311490.25030@macalan.c3sl.ufpr.br>
References: <CAOytA4ZetcNdio3hKW6WjsaqHtaWk-gvd8jBdfR5tZsbrMHkVg@mail.gmail.com>
	<519E7A1B.4000207@uni-muenster.de>
	<alpine.DEB.2.02.1305232311490.25030@macalan.c3sl.ufpr.br>
Message-ID: <519F1714.10800@uni-muenster.de>

Paulo, they do refer to the same method. gstat::fit.variogram.reml only
fits sill parameters (nugget, partial sill), but doesn't compute nor use
sample variograms.

On 05/24/2013 04:14 AM, Paulo Justiniano Ribeiro Jr wrote:
> I'm unsure the REML's in gstat and geoR reffer to the same method.
> In the former the REML is based on the sample variogram
> whereas for the latter the REML is applied to the assumed
> (Gaussian) distribution of the data, in a modification of
> the original likelihood function.
> 
> 
> 
> Paulo Justiniano Ribeiro Jr
> LEG (Laboratorio de Estatistica e Geoinformacao)
> Universidade Federal do Parana
> Caixa Postal 19.081
> CEP 81.531-990
> Curitiba, PR  -  Brasil
> Tel: (+55) 41 3361 3573
> VOIP: (+55) (41) (3361 3600) 1053 1066
> Fax: (+55) 41 3361 3141
> e-mail: paulojus AT  ufpr  br
> http://www.leg.ufpr.br/~paulojus
> 
> On Thu, 23 May 2013, Edzer Pebesma wrote:
> 
>> Saman, package geoR contains functions for (RE)ML fitting that also fit
>> the range parameter.
>>
>> Please note that in your output below the nugget is negative, which
>> can't be the case -- one could argue that this is a software error.
>>
>> On 05/23/2013 10:02 PM, Saman Monfared wrote:
>>> Hi,
>>> In gstat and  package the fit.variogram.reml function provided for
>>> RMLE method to  estimation of variogram parameters. This function only
>>> estimate nugget and sill and range parameter is fix.
>>>
>>> for example:
>>>
>>> v.rml<-fit.variogram.reml(rate~1,data,model
>>> =vgm(200000,"Sph",95241.99,0))
>>> v.rml
>>>   model     psill    range
>>> 1   Nug -1711.462     0.00
>>> 2   Sph  3431.108 95241.99
>>>
>>> How can I set the best range value?
>>> If  exist a way to estimate range like( fit.ranges = TRUE) in
>>> fit.variogram function?
>>>
>>> Best,
>>>
>>
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From mbock at environcorp.com  Fri May 24 17:21:16 2013
From: mbock at environcorp.com (Mike Bock)
Date: Fri, 24 May 2013 15:21:16 +0000
Subject: [R-sig-Geo] FW: ggmap, hexbin and length distortion in Lat/long
Message-ID: <A71CC7349FBF9C4488086401DF01BFDA37471716@MWEXS2.ENVIRONCORP.INT>

It was suggested that r-sig-geo may be the appropriate venue for this question so I am reposting here, thanks


-----Original Message-----
From: Mike Bock
Sent: Friday, May 24, 2013 9:52 AM
To: 'r-help at r-project.org'
Subject: ggmap, hexbin and length distortion in Lat/long

I am working with spatial data in ggmap, generally with great success. I have a huge data set with the coordinates in NAD 83 UTM Zone 11 (meters).  To map the data the coordinates were converted to Lat Long in GIS prior to use in R and ggmap/ggplot. I am using hexagonal binning to aggregate the data :
#create bins and calculate stats

hb<-hexbin(DF$lon,DF$lat,xbins=80,IDs=TRUE)
hb.avg<-hexTapply(hb,DF$Res,mean,na.rm=TRUE)
hb.mx<-hexTapply(hb,DF$Res,max,na.rm=TRUE)
hb.p80<-hexTapply(hb,DF$Res,quantile,prob=0.80,na.rm=TRUE)
#create df for ggplot
hx_dat <- data.frame(hcell2xy(hb), count = hb at count,
    xo = hb at xcm, yo = hb at ycm, Mean=hb.avg,Max=hb.mx,
    p80=hb.p80)

#Base Map
#BBox is the bounding box
Base<-get_map(BBox,source='google')
m_hx<-ggmap(Base,legend = "bottom", base_layer=ggplot(aes(x=x,y=y),data=hx_dat))
#Map of means
a<-0.55
hc<-'grey60'

m_hx+geom_hex(aes(x = x, y = y, fill = Mean),
  color = hc, ,alpha=a,stat = "identity") +
  scale_fill_gradientn("Mean",colours=rev(rainbow(4)),trans='sqrt')

...and so on for other stats
I can also run statistical analyses on hx_dat.
By creating hexbins based on lat/long it seems there will be distortion due to the differences in length of a degree at different locations on the earth's surface. What is the most efficient way to eliminate this distortion? Should I run hexbin in NAD83 and convert the x/y coordinates to Lat Long? Can I get ggmap to convert the baselayer to NAD84 and just do everything in NAD(my preferred option)?
I have tried converting Lat Long to NAD84 and back but the coordinates are coming up in the eastern Pacific and not in California, so I am missing something and I am not sure that is the best way to solve the problem anyway. Thanks in advance, any help is greatly appreciated Mike

Michael J. Bock, PhD | Senior Manager
mbock at environcorp.com






________________________________
This message contains information that may be confidenti...{{dropped:8}}


From jgrn at illinois.edu  Fri May 24 18:47:59 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 24 May 2013 11:47:59 -0500
Subject: [R-sig-Geo] raster/ncdf4 error: too many open files
In-Reply-To: <a8525f37f3fa499c8d11dad72c129305@CHIHT4.ad.uillinois.edu>
References: <a8525f37f3fa499c8d11dad72c129305@CHIHT4.ad.uillinois.edu>
Message-ID: <CABG0rftE0KSgoyKsfDvAe2svYbD-tVSuJOYMzgHc3k-OJd9Eug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/30a40f5f/attachment.pl>

From jgrn at illinois.edu  Fri May 24 21:10:27 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 24 May 2013 14:10:27 -0500
Subject: [R-sig-Geo] (no subject)
Message-ID: <CABG0rfvgbYe_UED_JgYJjFHNHkd8vOcT-5pdQ-7jwmFqeDgzKw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/d97c56c1/attachment.pl>

From jemiller31 at gmail.com  Fri May 24 21:22:38 2013
From: jemiller31 at gmail.com (Joseph Miller)
Date: Fri, 24 May 2013 14:22:38 -0500
Subject: [R-sig-Geo] reading and reformatting hdf files within raster
Message-ID: <CAE+tLNBzY+Rx+yPEcWJ=czuDMyMVtQjyyM0QcyOFFdX_iHH+Bg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/49ecf4e9/attachment.pl>

From vitale232 at gmail.com  Fri May 24 22:26:21 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 24 May 2013 13:26:21 -0700
Subject: [R-sig-Geo] reading and reformatting hdf files within raster
In-Reply-To: <CAE+tLNBzY+Rx+yPEcWJ=czuDMyMVtQjyyM0QcyOFFdX_iHH+Bg@mail.gmail.com>
References: <CAE+tLNBzY+Rx+yPEcWJ=czuDMyMVtQjyyM0QcyOFFdX_iHH+Bg@mail.gmail.com>
Message-ID: <CAFTcopdW2nfVmYpEAuYjS=esUsMo0vsQU9p+f+BiWTg+zfObLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130524/d6606e84/attachment.pl>

From jgrn at illinois.edu  Sat May 25 15:17:22 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 25 May 2013 08:17:22 -0500
Subject: [R-sig-Geo] reading and reformatting hdf files within raster
In-Reply-To: <1127ebccef9c45daab1ba84f8966ff73@CHIHT3.ad.uillinois.edu>
References: <1127ebccef9c45daab1ba84f8966ff73@CHIHT3.ad.uillinois.edu>
Message-ID: <CABG0rftU2vrG5n7irMyO=qu7BKyX=5gpK76wd3UjHUUx5qUTeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130525/dfb4482d/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat May 25 17:10:02 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 25 May 2013 16:10:02 +0100
Subject: [R-sig-Geo] reading and reformatting hdf files within raster
In-Reply-To: <028833fd990e4346aaf4c908d5cac554@EX-0-HT0.lancs.local>
References: <1127ebccef9c45daab1ba84f8966ff73@CHIHT3.ad.uillinois.edu>
	<028833fd990e4346aaf4c908d5cac554@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMmYPphGM9p=cpw44fRAOgzNXcPmKe5BXQB2e0kkJ=wzw@mail.gmail.com>

On Sat, May 25, 2013 at 2:17 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Is it is possible to read a MODIS HDF "layer" directly with a raster()
> statement?

 Have you tried searching for HDF on CRAN?

http://cran.r-project.org/web/packages/h5r/index.html

I don't fancy downloading a 196MB MODIS file to find out...

Barry


From loic.dutrieux at wur.nl  Sat May 25 17:40:17 2013
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Sat, 25 May 2013 15:40:17 +0000
Subject: [R-sig-Geo] reading and reformatting hdf files within raster
In-Reply-To: <CANVKczMmYPphGM9p=cpw44fRAOgzNXcPmKe5BXQB2e0kkJ=wzw@mail.gmail.com>
References: <1127ebccef9c45daab1ba84f8966ff73@CHIHT3.ad.uillinois.edu>
	<028833fd990e4346aaf4c908d5cac554@EX-0-HT0.lancs.local>,
	<CANVKczMmYPphGM9p=cpw44fRAOgzNXcPmKe5BXQB2e0kkJ=wzw@mail.gmail.com>
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB70E23B6D8@SCOMP0937.wurnet.nl>

Hi Joseph,

There is a MODIS package that has many useful utilities for downloading, reading, reprojecting, ... MODIS (HDF4) data.

library(raster)
library(MODIS)
sds <- getSds('filename.hdf') # Make sure to use full path
evi <- raster(sds$SDS4gdal[2]) # REad SDS 2 of the hdf file (EVI)

# Or eventually
evi <- raster(readGDAL(sds$SDS4gdal[2], as.is = TRUE))

The second option allows to have control over the otherwise by default scaling of the data. It can be useful when the scaling factor provided by the metadata is incorrect, which I think is the case for this particular MODIS product.

Cheers,

--
Lo?c Dutrieux
Laboratory of Geo Information Science and Remote Sensing
Wageningen University
The Netherlands


________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
Sent: Saturday, May 25, 2013 5:10 PM
To: Jonathan Greenberg
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] reading and reformatting hdf files within raster

On Sat, May 25, 2013 at 2:17 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Is it is possible to read a MODIS HDF "layer" directly with a raster()
> statement?

 Have you tried searching for HDF on CRAN?

http://cran.r-project.org/web/packages/h5r/index.html

I don't fancy downloading a 196MB MODIS file to find out...

Barry

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From jgrn at illinois.edu  Sat May 25 23:52:22 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 25 May 2013 16:52:22 -0500
Subject: [R-sig-Geo] Small bug in raster reading a NetCDF?
Message-ID: <CABG0rfuZtfWUKgwV7Ldenyn4YJ9PadRD9zzsLWJydr93FWFTAQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130525/70be302d/attachment.pl>

From jgrn at illinois.edu  Sun May 26 00:13:08 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 25 May 2013 17:13:08 -0500
Subject: [R-sig-Geo] Small bug in raster reading a NetCDF?
In-Reply-To: <89aed9f76a5c42928941adf8bb9d7e7d@CITESHT1.ad.uillinois.edu>
References: <89aed9f76a5c42928941adf8bb9d7e7d@CITESHT1.ad.uillinois.edu>
Message-ID: <CABG0rfv89AyAXh48LTjVFPi6nMdO_9jY3b8Q4d-80AXp3D6yLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130525/add5866f/attachment.pl>

From pingyang.whu at gmail.com  Sun May 26 01:25:43 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Sat, 25 May 2013 19:25:43 -0400
Subject: [R-sig-Geo] Small bug in raster reading a NetCDF?
In-Reply-To: <CABG0rfv89AyAXh48LTjVFPi6nMdO_9jY3b8Q4d-80AXp3D6yLw@mail.gmail.com>
References: <89aed9f76a5c42928941adf8bb9d7e7d@CITESHT1.ad.uillinois.edu>
	<CABG0rfv89AyAXh48LTjVFPi6nMdO_9jY3b8Q4d-80AXp3D6yLw@mail.gmail.com>
Message-ID: <CAK8gSG8BU6gXfpLVU_bEb6UzzHeVxkHYT1T6_G4n3+e6yMEsMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130525/d2b84d44/attachment.pl>

From kridox at ymail.com  Mon May 27 08:53:04 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Mon, 27 May 2013 15:53:04 +0900
Subject: [R-sig-Geo] Small bug in raster reading a NetCDF?
In-Reply-To: <CABG0rfv89AyAXh48LTjVFPi6nMdO_9jY3b8Q4d-80AXp3D6yLw@mail.gmail.com>
References: <89aed9f76a5c42928941adf8bb9d7e7d@CITESHT1.ad.uillinois.edu>
	<CABG0rfv89AyAXh48LTjVFPi6nMdO_9jY3b8Q4d-80AXp3D6yLw@mail.gmail.com>
Message-ID: <51A302D0.30008@ymail.com>

Hello,

Extent and length of latitudes are correct.

In NCEP/NCAR reanalysis, coordinates are the centers of grid cells. 
Thus, for North Pole, the grid extents (+---+), centers (o) and Earth 
"limits" (____) are:


91.25 +-------+-------+-------+-------+
       |               |               | 1.25
       |               |               |
__90__+_______o_______|_______o_______|______
       |               |               |
       |               |               | 1.25
88.75 +-------+-------+-------+-------+
       |               |               | 1.25
       |               |               |
  87.5 +       o       +       o       +
       |               |               |
       |               |               | 1.25
86.25 +-------+-------+-------+-------+
     -1.25     0      1.25    2.5     3.75


180 = 73 x 2.5 - (2 x 1.25)
                       ^
             |91.25-90| + |-91.25+90|

Regards,
Pascal


On 05/26/2013 07:13 AM, Jonathan Greenberg wrote:
> Curiouser and curiouser -- I feel like I'm missing some obvious point here
> -- the NCEP grid can't fit into its specified extent, pixel size, and
> number of pixels -- the y-axis seems to have one pixel too many (e.g. it
> has an nrow of 73, but 73 x 2.5 degrees =  182.5 degrees, which can't be
> true (the specified pixel size from NOAA,
> http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis.surface.html).
>   Does anyone have any idea whether this is an "extra row", or if the pixel
> sizes are not set properly, or some other point I'm failing to understand?
>
> --j
>
>
> On Sat, May 25, 2013 at 4:52 PM, Greenberg, Jonathan <jgrn at illinois.edu>wrote:
>
>> Robert et al:
>>
>> I think there may be a small bug in raster reading an NCEP NetCDF file.  I
>> think the NetCDF file is supplying the upper left coordinates of each cell,
>> but raster is assuming these coordinates are the center of the cell:
>>
>> # Given:
>> require("ncdf")
>> require("raster")
>> # Sample global netCDF from NCEP Reanalysis, about a 30mb download:
>> download.file("
>> ftp://ftp.cdc.noaa.gov/Datasets/ncep.reanalysis/surface/air.sig995.1948.nc
>> ","air.sig995.1948.nc",mode="wb")
>> # Create a brick:
>> myncdf <- brick("air.sig995.1948.nc")
>> myncdf
>> # Notice the extent has impossible coordinates:
>> class       : RasterBrick
>> dimensions  : 73, 144, 10512, 1464  (nrow, ncol, ncell, nlayers)
>> resolution  : 2.5, 2.5  (x, y)
>> extent      : -1.25, 358.75, -91.25, 91.25  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=longlat +datum=WGS84
>> data source : /Users/jgrn307/air.sig995.1948.nc
>> names       : X1948.01.03.00.00.00, X1948.01.03.06.00.00,
>> X1948.01.03.12.00.00, X1948.01.03.18.00.00, X1948.01.04.00.00.00,
>> X1948.01.04.06.00.00, X1948.01.04.12.00.00, X1948.01.04.18.00.00,
>> X1948.01.05.00.00.00, X1948.01.05.06.00.00, X1948.01.05.12.00.00,
>> X1948.01.05.18.00.00, X1948.01.06.00.00.00, X1948.01.06.06.00.00,
>> X1948.01.06.12.00.00, ...
>> Date/time   : 1948-01-03 00:00:00, 1949-01-02 18:00:00 (min, max)
>> varname     : air
>>
>> # Opening the NetCDF directly:
>> myncdf_con <- open.ncdf("air.sig995.1948.nc")
>> get.var.ncdf(myncdf_con,"lon")
>>
>> # Output:
>>    [1]   0.0   2.5   5.0   7.5  10.0  12.5  15.0  17.5  20.0  22.5  25.0
>>   27.5  30.0  32.5  35.0  37.5  40.0  42.5  45.0  47.5  50.0  52.5
>>   [23]  55.0  57.5  60.0  62.5  65.0  67.5  70.0  72.5  75.0  77.5  80.0
>>   82.5  85.0  87.5  90.0  92.5  95.0  97.5 100.0 102.5 105.0 107.5
>>   [45] 110.0 112.5 115.0 117.5 120.0 122.5 125.0 127.5 130.0 132.5 135.0
>> 137.5 140.0 142.5 145.0 147.5 150.0 152.5 155.0 157.5 160.0 162.5
>>   [67] 165.0 167.5 170.0 172.5 175.0 177.5 180.0 182.5 185.0 187.5 190.0
>> 192.5 195.0 197.5 200.0 202.5 205.0 207.5 210.0 212.5 215.0 217.5
>>   [89] 220.0 222.5 225.0 227.5 230.0 232.5 235.0 237.5 240.0 242.5 245.0
>> 247.5 250.0 252.5 255.0 257.5 260.0 262.5 265.0 267.5 270.0 272.5
>> [111] 275.0 277.5 280.0 282.5 285.0 287.5 290.0 292.5 295.0 297.5 300.0
>> 302.5 305.0 307.5 310.0 312.5 315.0 317.5 320.0 322.5 325.0 327.5
>> [133] 330.0 332.5 335.0 337.5 340.0 342.5 345.0 347.5 350.0 352.5 355.0
>> 357.5
>>
>> get.var.ncdf(myncdf_con,"lat")
>> # Output:
>>   [1]  90.0  87.5  85.0  82.5  80.0  77.5  75.0  72.5  70.0  67.5  65.0
>>   62.5  60.0  57.5  55.0  52.5  50.0  47.5  45.0  42.5  40.0  37.5
>> [23]  35.0  32.5  30.0  27.5  25.0  22.5  20.0  17.5  15.0  12.5  10.0
>> 7.5   5.0   2.5   0.0  -2.5  -5.0  -7.5 -10.0 -12.5 -15.0 -17.5
>> [45] -20.0 -22.5 -25.0 -27.5 -30.0 -32.5 -35.0 -37.5 -40.0 -42.5 -45.0
>> -47.5 -50.0 -52.5 -55.0 -57.5 -60.0 -62.5 -65.0 -67.5 -70.0 -72.5
>> [67] -75.0 -77.5 -80.0 -82.5 -85.0 -87.5 -90.0
>>
>> # Don't forget to close the connection:
>> close.ncdf(myncdf_con)
>>
>> Thoughts?
>>
>> --j
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 607 South Mathews Avenue, MC 150
>> Urbana, IL 61801
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>


From thi_veloso at yahoo.com.br  Mon May 27 15:06:46 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 27 May 2013 06:06:46 -0700 (PDT)
Subject: [R-sig-Geo] Issue when producing bubble plot (sp)
Message-ID: <1369660006.8017.YahooMailNeo@web121904.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130527/676e03be/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon May 27 16:38:28 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 27 May 2013 16:38:28 +0200
Subject: [R-sig-Geo] Issue when producing bubble plot (sp)
In-Reply-To: <1369660006.8017.YahooMailNeo@web121904.mail.ne1.yahoo.com>
References: <1369660006.8017.YahooMailNeo@web121904.mail.ne1.yahoo.com>
Message-ID: <51A36FE4.9070403@uni-muenster.de>



On 05/27/2013 03:06 PM, Thiago V. dos Santos wrote:
>  Dear R-siggers,
> 
> I'm trying to produce a bubble plot using the sp package. The plot is ok, but there are two issues I would like to improve. To see them, please reproduce the code below:
> 
> ----------------------------------------
> 
> require(sp)
> require(rgdal)
> 
> # Read PR shapefile
> download.file('https://dl.dropboxusercontent.com/u/27700634/PR.zip', 'PR.zip')
> unzip('PR.zip')
> pr <- readOGR('.', 'PR')
> 
> # Read plot data
> dcoef <- read.csv('https://dl.dropboxusercontent.com/u/27700634/data.csv',sep=';', header=T)
> 
> coordinates(dcoef) <- c('Longitude','Latitude')
> 
> # Coerce the polygon outlines to a SpatialLines object 
> spl <- list('sp.lines', as(pr, 'SpatialLines'))
> 
> # basic bubble plot
> bubble(dcoef, 'pvalue', main = 'P-values', key.entries = seq(0.2, 1, by=0.2), sp.layout=spl)
> ----------------------------------------
> 
> Here is the first issue: how can I "zoom out" the plot to show the entire shapefile contour, and not focus only on the dots domain?
> 

bb = bbox(pr)
bubble(dcoef, 'pvalue', main = 'P-values', key.entries = seq(0.2, 1,
by=0.2), sp.layout=spl, xlim = bb[1,], ylim = bb[2,])


> Now, going ahead with the code:
> 
> ----------------------------------------
> 
> # More sophisticated plot
> rv = list('sp.polygons', pr, fill = 'lightgrey') # 
> arrow = list('SpatialPolygonsRescale', 
>              layout.north.arrow(), 
>              offset=c(-51, -24), 
>              scale = 0.5, which = 2)
> 
> bubble(dcoef, 'pvalue',                   # data.frame and column to be plotted
>        main = 'P-values',                 # title
>        col='red',                         # color of bubbles
>        key.entries = seq(0.2, 1, by=0.2), # legend
>        scales=list(draw = TRUE),          # degrees in axes
>        sp.layout=list(rv, arrow))         # include additional items
> ----------------------------------------
> 
> 
> Here are two issues: 
> i) same as below: how can I show the entire shapefile contour, and not focus only on the dots domain?

same as above, I'd guess.

> 
> ii) why does the north arrow insist in not appearing?

remove the 'which = 2' when defining arrow -- this tells spplot to plot
the arrow in the second panel; your plot has only one.

> 
> Thanks in advance for any suggestion.
> 
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From drmbongo at gmail.com  Mon May 27 16:50:34 2013
From: drmbongo at gmail.com (Jeroen Steenbeek)
Date: Mon, 27 May 2013 11:50:34 -0300
Subject: [R-sig-Geo] Kriging and datum shifts
Message-ID: <51A372BA.8090308@gmail.com>

Dear list,

I am converting NetCDF data, placed on a global grid with irregular 
latitude values, to a regular WGS84 grid using IDW. It works, but I have 
one remaining issue for which I can use advice.

The original data is oriented -280, +80 longitude, and it needs to be 
interpolated to -180, 180 longitude. How do I do this with the Spatial* 
classes? I can do this either before interpolation on the original 
SpatialPointsDataFrame that is read from the NetCDF files, or I can 
perform this shift on the SpatialGridDataFrame resulting from the IDW 
operation. But how to do this in R? spCBind sounds like a good 
candidate, but will this correctly handle the georeferencing?

Thanks in advance,
Jeroen


From thi_veloso at yahoo.com.br  Mon May 27 21:46:52 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 27 May 2013 12:46:52 -0700 (PDT)
Subject: [R-sig-Geo] Issue when producing bubble plot (sp)
In-Reply-To: <51A36FE4.9070403@uni-muenster.de>
References: <1369660006.8017.YahooMailNeo@web121904.mail.ne1.yahoo.com>
	<51A36FE4.9070403@uni-muenster.de>
Message-ID: <1369684012.43948.YahooMailNeo@web121901.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130527/545b52cb/attachment.pl>

From mdsumner at gmail.com  Mon May 27 23:03:46 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 28 May 2013 07:03:46 +1000
Subject: [R-sig-Geo] Kriging and datum shifts
In-Reply-To: <51A372BA.8090308@gmail.com>
References: <51A372BA.8090308@gmail.com>
Message-ID: <CAAcGz990JUSiAnRfJgH=VELtywQh0WJGNWR6to0p2eByi4r2KQ@mail.gmail.com>

For a simple approach I would just do on the raw coordinates in the
SPDF. You could operate on the NetCDF file itself by reading from it
directly as a matrix with vectors, but since you mention the SPDF why
not just do this:

x <- as.data.frame(spdf)
## figure out what "longitude" and "latitude" are called here
lon <- x$longitude
x$longitude <- ifelse(lon < -180, lon + (-180 - -280), lon)

## reconstruct, also with what "longitude" and "latitude" are named
xr <- SpatialPointsDataFrame(x[, c("longitude", "latitude")], x,
proj4string = CRS(proj4string(spdf)))

(Though I doubt you have a valid CRS string in your original object
already, the above will work. To give it one replace the proj4string
call with "+proj=longlat +datum=WGS84").

Now proceed with xr instead.

There is rotate() in the raster package, though it's only for one
special case. You can easily crop and re-merge the two parts as
rasters with that package too, and you can do the same with and
subsetting and recombining in sp, but in this case I would go as far
back to the source first. R has excellent tools for dealing with data
that need some kind of pre-preparation before they are ready for these
spatial tools.  As an example, sp will baulk at this

 SpatialPointsDataFrame(cbind(c(-280, -100), c(-40, -60)),
data.frame(x = 1:2), proj4string = CRS("+proj=longlat"))


Since you are reading data from NetCDF and they are on an irregular
grid I would also spend time becoming familiar with that by reading
from it with generic tools like ncdf or ncdf4 or RNetCDF, R's image()
list structure will handle irregular coordinates in one or two
dimensions and sometimes that can save you from confusion or pain.


Also, sometimes NetCDF data are using some underlying map projection
and if you can discover that rather than work in the irregular lon/lat
you'll be able to cast more directly to these rigid grid/raster
objects. Mercator is commonly used for global grids and provides
irregular latitudes for example. Can you point to one of these files?

Cheers, Mike.



On Tue, May 28, 2013 at 12:50 AM, Jeroen Steenbeek <drmbongo at gmail.com> wrote:
> Dear list,
>
> I am converting NetCDF data, placed on a global grid with irregular latitude
> values, to a regular WGS84 grid using IDW. It works, but I have one
> remaining issue for which I can use advice.
>
> The original data is oriented -280, +80 longitude, and it needs to be
> interpolated to -180, 180 longitude. How do I do this with the Spatial*
> classes? I can do this either before interpolation on the original
> SpatialPointsDataFrame that is read from the NetCDF files, or I can perform
> this shift on the SpatialGridDataFrame resulting from the IDW operation. But
> how to do this in R? spCBind sounds like a good candidate, but will this
> correctly handle the georeferencing?
>
> Thanks in advance,
> Jeroen
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.hijmans at gmail.com  Tue May 28 02:06:01 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 27 May 2013 17:06:01 -0700
Subject: [R-sig-Geo] Problem Raster Overlay
In-Reply-To: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>
References: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>
Message-ID: <CANtt_hx_fHZ17GNaTpu_mOe-jgoOtXiUfZRc2brzjw2HNM4ZKQ@mail.gmail.com>

Mohgli,
This should fix it:

library(raster)
r <- raster(FileNm)
r <- rotate(r)

Robert

On Thu, May 23, 2013 at 3:55 PM,  <mohglimoor at gmail.com> wrote:
> Dear all
>
> I am plotting a raster dataset derived through a netCDF file and want to
> overlay with a shapfile. Although I specify the extent of the raster
> xmin=-180 to xmax=180 it puts the x values to 0 to 360. When I then do the
> overlay with a shapefile the shapefiles are shifted since the has an extent
> from -180 to 180.
>
> <ncid <- open.ncdf(FileNm)
> <
> <NetCDFRaster<-raster(FileNm, xmn=-180, xmx=180, ymn=-90, ymx=90,
> ncols=1440, nrows=400)
> <
> <plot(NetCDFRaster)
> <
> <testint <- mask(NetCDFRaster, Worldshapes)
>
> How can I adjust the raster extent to match the extent of the shapefile?
>
> Thanks for any support.
> Best regards,
> Mohgli
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Tue May 28 02:16:28 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 27 May 2013 17:16:28 -0700
Subject: [R-sig-Geo] saga grid format TOPTOBOTTOM
In-Reply-To: <1369068374127-7583610.post@n2.nabble.com>
References: <1369068374127-7583610.post@n2.nabble.com>
Message-ID: <CANtt_hwugsxCdyzu5oCmWsF51GCo+hjA0ENHjjHsqyrzFTF3Gw@mail.gmail.com>

Chuck,

raster can read both  TOPTOBOTTOM=FALSE and  TOPTOBOTTOM=TRUE SAGA
files. However, it only writes TOPTOBOTTOM=TRUE.

GDAL can read and write TOPTOBOTTOM=TRUE only. Apparently QGIS has a
native driver for SAGA that can only do  TOPTOBOTTOM=FALSE, which is
odd (as it not the common approach). Can't you force QGIS to use GDAL
to read SAGA files? Another approach would be to use e.g. GTiff.

If you are desperate you could also write a function to create the
type QGIS needs using flip(r, 'y') and that then changes the SAGA
header file to TOPTOBOTTOM=FALSE.

Robert

On Mon, May 20, 2013 at 9:46 AM, Chuck Bulmer <cebulmer at telus.net> wrote:
> Hi all.
>
> I am using package raster to crop some saga grids with a shapefile.
>
> The original inut sgrd file looks like this:
>
> NAME    = ELEV_1HA
> DESCRIPTION     =
> UNIT    =
> DATAFILE_OFFSET = 0
> DATAFORMAT      = FLOAT
> BYTEORDER_BIG   = FALSE
> POSITION_XMIN   = 321888.3470000000
> POSITION_YMIN   = 376291.6470000000
> CELLCOUNT_X     = 15358
> CELLCOUNT_Y     = 13473
> CELLSIZE        = 100.0000000000
> Z_FACTOR        = 1.000000
> NODATA_VALUE    = -9999.000000
> TOPTOBOTTOM     = FALSE
>
> After using the (below) code, the output sgrd file looks like this:
>
> NAME    = ELEV_1HA
> DESCRIPTION     =
> UNIT    =
> DATAFORMAT      = FLOAT
> DATAFILE_OFFSET = 0
> BYTEORDER_BIG   = FALSE
> POSITION_XMIN   =  1427688.347
> POSITION_YMIN   =  486091.647
> CELLCOUNT_Y     =  1685
> CELLCOUNT_X     =  784
> CELLSIZE        =  100
> Z_FACTOR        = 1.000000
> NODATA_VALUE    = -3.4e+38
> TOPTOBOTTOM     = TRUE
>
> The resulting files are read by SAGA-GIS with no problem and they look good,
> but I want to use Quantum GIS as my map viewer and when I try to load the
> result file into QGIS it provides me with the following error:
> "..ELEV_1HA is not a supported data source. Currently the Saga Binary Grid
> driver does not support Saga Grids written TOPTOBOTTOM"
>
> If I load and resave the grid with SAGA, TOPTOBOTTOM reverts back to FALSE,
> and the grid can be read by QGIS, but I'd like to avoid this extra step.
>
> Is there a way to add a setting to the crop function? raster? gdal? to write
> as TOPTOBOTTOM=FALSE, which would save me the extra step of loading and
> resaving each grod.
>
> Thanks for any help you can provide
>
> Chuck
>
> Here's the code ... (Windows 7x64)
>
> s <- raster("D:\\BC_DSM\\ELEV_1HA.sdat")
> t<- shapefile("D:\\BC_DSM\\ecodistrict_bdy_b10k.shp")
> crop(s,t,filename="D:\\BC_DSM\\Results\\ELEV_1HA.sdat")
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/saga-grid-format-TOPTOBOTTOM-tp7583610.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Tue May 28 03:14:55 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 27 May 2013 18:14:55 -0700
Subject: [R-sig-Geo] Problem with extract {raster} function
In-Reply-To: <22F4D0EDF68494479BC955CFF9F011BB16BC66@SCOMP0936.wurnet.nl>
References: <22F4D0EDF68494479BC955CFF9F011BB16BC53@SCOMP0936.wurnet.nl>
	<22F4D0EDF68494479BC955CFF9F011BB16BC66@SCOMP0936.wurnet.nl>
Message-ID: <CANtt_hxN9nEhf7z4f3uNd6DUU3HZyrEHv33-=ck7U1th5s1O4g@mail.gmail.com>

Manos,

I think this happens because s1pol is invalid (self-intersecting).
s2pol also has that problem but it works anyway. I have cleaned your
shapefile and will send it to you via a separate email. With the
cleaned shp file the problem does not occur. The script below shows
the test for validity and the difference between the two data sources.

Robert

library(raster)
s1pol <- shapefile('1site.shp')
s2 <- shapefile('cln.shp')
library(rgeos)
gIsValid(s1pol)
# [1] FALSE
# Warning message:
# In RGEOSUnaryPredFunc(spgeom, byid, "rgeos_isvalid") :
#   Ring Self-intersection at or near point -4997474.25179449 -227339.61631866
gIsValid(s2)
#  [1] TRUE

# see the difference

r <- raster('1site.tif')
df1 <- extract(r,s1pol, df=TRUE, weights=TRUE, cellnumbers=TRUE)
names(df1) <- c('ID','cell', 'r', 'weight') # Extraction for test area
a <- tapply(df1$weight, df1$cell, sum)
r1 <- raster(r)
r1[as.integer(names(a))] = a

df2 <- extract(r, s2, df=TRUE, weights=TRUE, cellnumbers=TRUE)
names(df2) <- c('ID','cell', 'r', 'weight') # Extraction for test area
b <- tapply(df2$weight, df2$cell, sum)
r2 <- raster(r)
r2[as.integer(names(b))] <- b

s <- stack(r1, r2)
names(s) <- c('original', 'cleaned')
plot(s)


On Mon, May 20, 2013 at 11:25 AM, Kalomenopoulos, Manos
<manos.kalomenopoulos at wur.nl> wrote:
> Hi everybody,
> I am experiencing a problem with the extract{raster} function, specifically the 'weights' argument.
>
> I have a raster and a polygon shapefile with 5 polygons (land cover classes).
> I am using extract to obtain cellnumbers and the weights (percentage of cover of each class per raster cell).
> The sum of the five weights per cell should sum to 100% (except for those cells not completely inside my AOI).
> However, there is an considerable amount of cells were that is not the case.
> I have been trying to track down the error, but can't understand it so far.
>
> I localized the erroneous cells in one example site (10x10km) and clipped the original shapefile to a smaller area containing these cells.
> The script below does the extraction once for the 10x10km sample and once for a smaller testsite containing 10 erroneous cells.
> Surprisingly, doing the extraction with the smaller testsite ALL weights sum up to 100%, even though the polygon data is exactly the same....
> Any ideas why and/or suggestions how to make it work properly for the bigger extent?
>
> Here my script:
>
>
> library(raster)
> library(reshape)
>
> # raster of AOI
>  r <- raster('1site.tif')
> # polygon shapefile of AOI with 5 different classes
>   s1pol <- shapefile('1site.shp')
>
> # polygon shapefile of test area with observed errors (clipped from s1pol)
>   s2pol <- shapefile('test.shp')
> # extract class names
>   classes <- s1pol$class
> ########################################################################
> # Extraction for complete AOI
>   df1 <- extract(r,s1pol, df=TRUE, weights=TRUE, cellnumbers=TRUE)
>     names(df1) <- c('ID','cell', 'r', 'weight1') # Extraction for test area
>
> # Extraction for smaller site
>   df2 <- extract(r,s2pol, df=TRUE, weights=TRUE, cellnumbers=TRUE)
>     names(df2) <- c('ID','cell', 'r', 'weight2') ###########################################################################################
> ### Compairing
>
> # Reshape df's keeping only ID, cell and weight
>   df1new<-cast(df1[,c(1,2,4)],cell~ID)
>     names(df1new) <- c('cell',classes)
>
>   df2new<-cast(df2[,c(1,2,4)],cell~ID)
>     names(df2new) <- c('cell',classes)
> # Calculate class totals
>   df1new$totals <- mapply(df1new[,2], df1new[,3], df1new[,4],df1new[,5],df1new[,6], FUN=function(v,w,x,y,z) sum(c(v,w,x,y,z),na.rm=TRUE))
>
>   df2new$totals <- mapply(df2new[,2], df2new[,3], df2new[,4],df2new[,5],df2new[,6], FUN=function(v,w,x,y,z) sum(c(v,w,x,y,z),na.rm=TRUE))
>
> # Merge the two dataframes and select only rows with differnt totals
>   df <- as.data.frame(merge(df1new,df2new,by='cell'))
>
>     dfe <- subset(df, totals.x-totals.y !=0)
>       dfe$error <- dfe$totals.x-dfe$totals.y
>
> head(dfe)
>
> Link to the files needed to run this script:
> https://www.dropbox.com/s/n283rwew1ypxghv/extractProblem.7z
>
>
> Thanks in advance!
> -------------------------------------------------------
> Manos Kalomenopoulos
> Lab. of Geo-Information Science and Remote Sensing, Center for Geo-Information - Wageningen University Department for Biogeochemical Integration, Max-Planck-Institute for Biogeochemistry, Jena
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From thi_veloso at yahoo.com.br  Tue May 28 06:09:40 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 27 May 2013 21:09:40 -0700 (PDT)
Subject: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
Message-ID: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130527/4a54109e/attachment.pl>

From r.hijmans at gmail.com  Tue May 28 06:54:25 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 27 May 2013 21:54:25 -0700
Subject: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
In-Reply-To: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>
References: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>
Message-ID: <CANtt_hyMP1p4MxukEwE5ZCcaH8AOCW5ZGYCPQFqBDiZs-Vyecg@mail.gmail.com>

Thiago, you could of course do

mx <- max( cellStats(r, stat='max', na.rm=TRUE) )

but this is faster:

mx <- maxValue(max(r))

for writing to ncdf you can use writeRaster (or a filename argument in
cut, as long as the extension is ".nc".

Robert


On Mon, May 27, 2013 at 9:09 PM, Thiago V. dos Santos
<thi_veloso at yahoo.com.br> wrote:
> Dear all,
>
> I'm working on land use transition data that comes as netcdf. I would like to reclassify each one of these files in 15 classes, based on the min and max values of the entire series.
>
> Although I know this specific dataset ranges from 0 to 0.0680, I'd rather obtain it dinamically, via R. It seems to be a low value, but it makes sense since the unit is fraction of grid, which is relatively coarse (0.5 degree).
>
> So, the criteria to reclassify the files would be (max-min)/15. For example, the class 1 would range from 0 to 0.0045, class 2 from 0.0046 to 0.0090 and so on.
>
>
> However, I'm not sure on the better approach. I wrote a code that stacks all the 106 files and attempts to extract the extreme values, but cellStats returns me a value per layer, instead of a single value.
>
> Here is the fully reproducible code I have so far:
>
> -----------------------------------------
> require(raster) # raster operations
> require(ncdf4)  # write updated netcdf files
>
> # Download, unzip, list and stack files
> # Warning: 9Mb download and 106 files unzipped
> download.file('http://dl.dropboxusercontent.com/u/27700634/transition.zip', 'transition.zip')
> unzip('transition.zip')
> files <- list.files('.', pattern = 'nc', full.names=T)
> r <- stack (files)
>
> # retrieve min and max values of the series
> # there are NA's, so na.rm=T is required
> min <- cellStats(r, stat='min', na.rm=T)
> max <- cellStats(r, stat='max', na.rm=T)
>
> # Define classes, breaks and reclassify raster
> classes <- 15
> brk = c(min, max, by = classes)
> brk = seq(min, max, by = classes)
> rc <- cut(r, breaks=brk)
>
> # Then, write each layer as a netcdf using ncdf4 - in progress
> -----------------------------------------
>
>
> Does anyone have another one/a better ideia to do this?
>
> Thanks in advance,
>
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From drmbongo at gmail.com  Tue May 28 15:47:36 2013
From: drmbongo at gmail.com (Jeroen Steenbeek)
Date: Tue, 28 May 2013 10:47:36 -0300
Subject: [R-sig-Geo] Kriging and datum shifts
In-Reply-To: <CAAcGz990JUSiAnRfJgH=VELtywQh0WJGNWR6to0p2eByi4r2KQ@mail.gmail.com>
References: <51A372BA.8090308@gmail.com>
	<CAAcGz990JUSiAnRfJgH=VELtywQh0WJGNWR6to0p2eByi4r2KQ@mail.gmail.com>
Message-ID: <51A4B578.5080608@gmail.com>

Thank you Mike,

I have indeed all the info that I need in the SPDF: lat, lon, CRS. The 
irregular distribution of data is not projection-related, but is 
prohibitive to using simple rasterization operations because source data 
and target cells do not always overlap. Hence the need for kriging (or 
some other form or interpolation). Rasterization would have made life so 
much easier... I will find a way, your suggestions are helpful.

As a though: I am just surprised to find that the sp package does not 
seem to notice that two global datasets with different longitude offsets 
entirely overlap. In my case, kriging the point dataset from -280 to +80 
lon to a raster from -180 to 180 lon leaves the raster data +80 and 
onward blank, while in fact the point dataset has provided data for the 
entire raster range - just at a different lon offset. It is an 
understandable but unfortunate shortcoming shared by many (GIS) toolkits.

I can work around this by modifying the longitude of the SPDF points:
     lon <- (lon + 180) %% 360 - 180
That is valid but rather hack.... Helmet time.

This leads me to a second issue: I suspect that when operating idw on a 
global dataset, interpolation is also not properly executed around the 
wrapping longitude boundary (e.g., I suspect that kriging is not applied 
to the boundary line at +180 for a raster that spans -180 to 180 
longitude, creating noticeable artifacts)

Best,
Jeroen

On 2013-05-27 6:03 PM, Michael Sumner wrote:
> For a simple approach I would just do on the raw coordinates in the
> SPDF. You could operate on the NetCDF file itself by reading from it
> directly as a matrix with vectors, but since you mention the SPDF why
> not just do this:
>
> x <- as.data.frame(spdf)
> ## figure out what "longitude" and "latitude" are called here
> lon <- x$longitude
> x$longitude <- ifelse(lon < -180, lon + (-180 - -280), lon)
>
> ## reconstruct, also with what "longitude" and "latitude" are named
> xr <- SpatialPointsDataFrame(x[, c("longitude", "latitude")], x,
> proj4string = CRS(proj4string(spdf)))
>
> (Though I doubt you have a valid CRS string in your original object
> already, the above will work. To give it one replace the proj4string
> call with "+proj=longlat +datum=WGS84").
>
> Now proceed with xr instead.
>
> There is rotate() in the raster package, though it's only for one
> special case. You can easily crop and re-merge the two parts as
> rasters with that package too, and you can do the same with and
> subsetting and recombining in sp, but in this case I would go as far
> back to the source first. R has excellent tools for dealing with data
> that need some kind of pre-preparation before they are ready for these
> spatial tools.  As an example, sp will baulk at this
>
>   SpatialPointsDataFrame(cbind(c(-280, -100), c(-40, -60)),
> data.frame(x = 1:2), proj4string = CRS("+proj=longlat"))
>
>
> Since you are reading data from NetCDF and they are on an irregular
> grid I would also spend time becoming familiar with that by reading
> from it with generic tools like ncdf or ncdf4 or RNetCDF, R's image()
> list structure will handle irregular coordinates in one or two
> dimensions and sometimes that can save you from confusion or pain.
>
>
> Also, sometimes NetCDF data are using some underlying map projection
> and if you can discover that rather than work in the irregular lon/lat
> you'll be able to cast more directly to these rigid grid/raster
> objects. Mercator is commonly used for global grids and provides
> irregular latitudes for example. Can you point to one of these files?
>
> Cheers, Mike.
>
>
>
> On Tue, May 28, 2013 at 12:50 AM, Jeroen Steenbeek <drmbongo at gmail.com> wrote:
>> Dear list,
>>
>> I am converting NetCDF data, placed on a global grid with irregular latitude
>> values, to a regular WGS84 grid using IDW. It works, but I have one
>> remaining issue for which I can use advice.
>>
>> The original data is oriented -280, +80 longitude, and it needs to be
>> interpolated to -180, 180 longitude. How do I do this with the Spatial*
>> classes? I can do this either before interpolation on the original
>> SpatialPointsDataFrame that is read from the NetCDF files, or I can perform
>> this shift on the SpatialGridDataFrame resulting from the IDW operation. But
>> how to do this in R? spCBind sounds like a good candidate, but will this
>> correctly handle the georeferencing?
>>
>> Thanks in advance,
>> Jeroen
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From antonio.bubbico at gmail.com  Tue May 28 16:44:32 2013
From: antonio.bubbico at gmail.com (Antonio Bubbico)
Date: Tue, 28 May 2013 15:44:32 +0100
Subject: [R-sig-Geo] LAGSARLM: interaction between lagged dep and indep var
Message-ID: <CABW+3tAxYoaYeqMq+nop_oz9mZ1rdn6Uo3a4hVfcZbjiaSs22g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130528/df3d1efe/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue May 28 17:15:41 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 28 May 2013 17:15:41 +0200
Subject: [R-sig-Geo] Kriging and datum shifts
In-Reply-To: <51A4B578.5080608@gmail.com>
References: <51A372BA.8090308@gmail.com>
	<CAAcGz990JUSiAnRfJgH=VELtywQh0WJGNWR6to0p2eByi4r2KQ@mail.gmail.com>
	<51A4B578.5080608@gmail.com>
Message-ID: <51A4CA1D.6050506@uni-muenster.de>

Jeroen, sp does not have anything to do with kriging, so your comment is
confusing.

sp does create spatial objects from data.frame's, and may do some sanity
checks on coordinates in case they are longlat -- you have to specify
they are longlat, though.

If they are specified as longlat, and e.g. gstat::idw is used for
interpolation, it should use great circle distances as opposed to
Euclidian distances to figure out interpolation weights. If this is not
the case, I'd like to look at a simple, reproducible example. Kriging on
spherical data is done at your own risk, there are no checks that the
variogram model can be applied sanely on a sphere, as reported before.

On 05/28/2013 03:47 PM, Jeroen Steenbeek wrote:
> Thank you Mike,
> 
> I have indeed all the info that I need in the SPDF: lat, lon, CRS. The
> irregular distribution of data is not projection-related, but is
> prohibitive to using simple rasterization operations because source data
> and target cells do not always overlap. Hence the need for kriging (or
> some other form or interpolation). Rasterization would have made life so
> much easier... I will find a way, your suggestions are helpful.
> 
> As a though: I am just surprised to find that the sp package does not
> seem to notice that two global datasets with different longitude offsets
> entirely overlap. In my case, kriging the point dataset from -280 to +80
> lon to a raster from -180 to 180 lon leaves the raster data +80 and
> onward blank, while in fact the point dataset has provided data for the
> entire raster range - just at a different lon offset. It is an
> understandable but unfortunate shortcoming shared by many (GIS) toolkits.
> 
> I can work around this by modifying the longitude of the SPDF points:
>     lon <- (lon + 180) %% 360 - 180
> That is valid but rather hack.... Helmet time.
> 
> This leads me to a second issue: I suspect that when operating idw on a
> global dataset, interpolation is also not properly executed around the
> wrapping longitude boundary (e.g., I suspect that kriging is not applied
> to the boundary line at +180 for a raster that spans -180 to 180
> longitude, creating noticeable artifacts)
> 
> Best,
> Jeroen
> 
> On 2013-05-27 6:03 PM, Michael Sumner wrote:
>> For a simple approach I would just do on the raw coordinates in the
>> SPDF. You could operate on the NetCDF file itself by reading from it
>> directly as a matrix with vectors, but since you mention the SPDF why
>> not just do this:
>>
>> x <- as.data.frame(spdf)
>> ## figure out what "longitude" and "latitude" are called here
>> lon <- x$longitude
>> x$longitude <- ifelse(lon < -180, lon + (-180 - -280), lon)
>>
>> ## reconstruct, also with what "longitude" and "latitude" are named
>> xr <- SpatialPointsDataFrame(x[, c("longitude", "latitude")], x,
>> proj4string = CRS(proj4string(spdf)))
>>
>> (Though I doubt you have a valid CRS string in your original object
>> already, the above will work. To give it one replace the proj4string
>> call with "+proj=longlat +datum=WGS84").
>>
>> Now proceed with xr instead.
>>
>> There is rotate() in the raster package, though it's only for one
>> special case. You can easily crop and re-merge the two parts as
>> rasters with that package too, and you can do the same with and
>> subsetting and recombining in sp, but in this case I would go as far
>> back to the source first. R has excellent tools for dealing with data
>> that need some kind of pre-preparation before they are ready for these
>> spatial tools.  As an example, sp will baulk at this
>>
>>   SpatialPointsDataFrame(cbind(c(-280, -100), c(-40, -60)),
>> data.frame(x = 1:2), proj4string = CRS("+proj=longlat"))
>>
>>
>> Since you are reading data from NetCDF and they are on an irregular
>> grid I would also spend time becoming familiar with that by reading
>> from it with generic tools like ncdf or ncdf4 or RNetCDF, R's image()
>> list structure will handle irregular coordinates in one or two
>> dimensions and sometimes that can save you from confusion or pain.
>>
>>
>> Also, sometimes NetCDF data are using some underlying map projection
>> and if you can discover that rather than work in the irregular lon/lat
>> you'll be able to cast more directly to these rigid grid/raster
>> objects. Mercator is commonly used for global grids and provides
>> irregular latitudes for example. Can you point to one of these files?
>>
>> Cheers, Mike.
>>
>>
>>
>> On Tue, May 28, 2013 at 12:50 AM, Jeroen Steenbeek
>> <drmbongo at gmail.com> wrote:
>>> Dear list,
>>>
>>> I am converting NetCDF data, placed on a global grid with irregular
>>> latitude
>>> values, to a regular WGS84 grid using IDW. It works, but I have one
>>> remaining issue for which I can use advice.
>>>
>>> The original data is oriented -280, +80 longitude, and it needs to be
>>> interpolated to -180, 180 longitude. How do I do this with the Spatial*
>>> classes? I can do this either before interpolation on the original
>>> SpatialPointsDataFrame that is read from the NetCDF files, or I can
>>> perform
>>> this shift on the SpatialGridDataFrame resulting from the IDW
>>> operation. But
>>> how to do this in R? spCBind sounds like a good candidate, but will this
>>> correctly handle the georeferencing?
>>>
>>> Thanks in advance,
>>> Jeroen
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
83 33081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de


From mohglimoor at gmail.com  Tue May 28 19:38:13 2013
From: mohglimoor at gmail.com (mohglimoor at gmail.com)
Date: Tue, 28 May 2013 19:38:13 +0200
Subject: [R-sig-Geo] Problem Raster Overlay
In-Reply-To: <CANtt_hx_fHZ17GNaTpu_mOe-jgoOtXiUfZRc2brzjw2HNM4ZKQ@mail.gmail.com>
References: <CAJTWYB3V+d0k-_rd98nONpDzfbd_5c=rbZP5o6P2EfBictXA-Q@mail.gmail.com>
	<CANtt_hx_fHZ17GNaTpu_mOe-jgoOtXiUfZRc2brzjw2HNM4ZKQ@mail.gmail.com>
Message-ID: <CAJTWYB0e=HvDMJ6BWZYSc2m2zhLNBZB9h9XiukbnfHMB63a95A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130528/e06a081f/attachment.pl>

From thi_veloso at yahoo.com.br  Wed May 29 05:32:44 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Tue, 28 May 2013 20:32:44 -0700 (PDT)
Subject: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
In-Reply-To: <CANtt_hyMP1p4MxukEwE5ZCcaH8AOCW5ZGYCPQFqBDiZs-Vyecg@mail.gmail.com>
References: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CANtt_hyMP1p4MxukEwE5ZCcaH8AOCW5ZGYCPQFqBDiZs-Vyecg@mail.gmail.com>
Message-ID: <1369798364.68984.YahooMailNeo@web121904.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130528/cb7ddff5/attachment.pl>

From carotenuto_francesco at yahoo.it  Wed May 29 09:58:14 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Wed, 29 May 2013 08:58:14 +0100 (BST)
Subject: [R-sig-Geo] Automatic geographical projection parameters setting
Message-ID: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130529/1847abb1/attachment.pl>

From villers.alexandre at gmail.com  Wed May 29 10:12:37 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Wed, 29 May 2013 11:12:37 +0300
Subject: [R-sig-Geo] Automatic geographical projection parameters setting
In-Reply-To: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>
References: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>
Message-ID: <51A5B875.1030401@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130529/bd6e4bca/attachment.pl>

From kridox at ymail.com  Wed May 29 10:15:30 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 29 May 2013 17:15:30 +0900
Subject: [R-sig-Geo] Automatic geographical projection parameters setting
In-Reply-To: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>
References: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>
Message-ID: <51A5B922.6030606@ymail.com>

Hello,

Something like that?

 > LONG <- 20
 > LAT <- 5

 > crs.args <- paste("+proj=laea +lat_0=",LAT," +lon_0=",LONG," +x_0=0 
+y_0=0 +ellps=WGS84 +units=m +no_defs",sep="")

 > CRS("+proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84 
+units=m +no_defs")
CRS arguments:
  +proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84 +units=m 
+no_defs

 > CRS(crs.args)
CRS arguments:
  +proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84 +units=m 
+no_defs

Regards,
Pascal


On 05/29/2013 04:58 PM, Francesco Carotenuto wrote:
> Hi
> to all,
> I
> need to automatically set the geographical coordinates of the projection?s
> centre to project different polygons in different territories. My problem is the
> following.
> By
> using spTransform(xy, CRS("+proj=laea +lat_0=LAT +lon_0=LONG +x_0=0 +y_0=0
> +ellps=WGS84 +units=m +no_defs")),  I would like to set  +lat_0 and +long_0 as objects (here ?LAT? and
> ?LONG?) that I automatically generated. Unfortunately, this function doesn?t
> read objects (even if ?as.numeric?) but only numerical values set manually. Is
> there a way to set these coordinates as objects?
> Many
> thanks.
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From kridox at ymail.com  Wed May 29 11:39:44 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 29 May 2013 18:39:44 +0900
Subject: [R-sig-Geo] Automatic geographical projection parameters setting
In-Reply-To: <1369819589.52441.YahooMailNeo@web133001.mail.ir2.yahoo.com>
References: <1369814294.11060.YahooMailNeo@web133006.mail.ir2.yahoo.com>
	<51A5B922.6030606@ymail.com>
	<1369819589.52441.YahooMailNeo@web133001.mail.ir2.yahoo.com>
Message-ID: <51A5CCE0.6020007@ymail.com>

Hello,

Please reply to the list, not only to me.

Example taken from rgdal::spTransform:


 > crds <- matrix(data=c(9.05, 48.52), ncol=2)
 > spPoint <- SpatialPoints(coords=crds,
+                          proj4string=CRS("+proj=longlat +ellps=sphere 
+no_defs"))
 > a <- spTransform(spPoint, CRS(paste("+proj=ob_tran +o_proj=longlat",
+                                     "+o_lon_p=-162 +o_lat_p=39.25 
+lon_0=180 +ellps=sphere +no_defs")), use_ob_tran=TRUE)
 > a
SpatialPoints:
      coords.x1 coords.x2
[1,] -5.917698  -1.87195
Coordinate Reference System (CRS) arguments: +proj=ob_tran 
+o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere
+no_defs
 >
 > lon_0 <- 180
 > o_lon_p <- -162
 > o_lat_p <- 39.25
 >
 > crs.args <- paste("+o_lon_p=",o_lon_p," +o_lat_p=",o_lat_p," 
+lon_0=",lon_0," +ellps=sphere +no_defs", sep='')
 > b <- spTransform(spPoint, CRS(paste("+proj=ob_tran 
+o_proj=longlat",crs.args)), use_ob_tran=TRUE)
 > b
SpatialPoints:
      coords.x1 coords.x2
[1,] -5.917698  -1.87195
Coordinate Reference System (CRS) arguments: +proj=ob_tran 
+o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere
+no_defs


Regards,
Pascal


On 05/29/2013 06:26 PM, Francesco Carotenuto wrote:
> Thank you for the reply but in my post I've already explained that the
> function doesn't "read" any object.
>
> ------------------------------------------------------------------------
> *Da:* Pascal Oettli <kridox at ymail.com>
> *A:* Francesco Carotenuto <carotenuto_francesco at yahoo.it>
> *Cc:* "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> *Inviato:* Mercoled? 29 Maggio 2013 10:15
> *Oggetto:* Re: [R-sig-Geo] Automatic geographical projection parameters
> setting
>
> Hello,
>
> Something like that?
>
>  > LONG <- 20
>  > LAT <- 5
>
>  > crs.args <- paste("+proj=laea +lat_0=",LAT," +lon_0=",LONG," +x_0=0
> +y_0=0 +ellps=WGS84 +units=m +no_defs",sep="")
>
>  > CRS("+proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84
> +units=m +no_defs")
> CRS arguments:
>    +proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84 +units=m
> +no_defs
>
>  > CRS(crs.args)
> CRS arguments:
>    +proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +ellps=WGS84 +units=m
> +no_defs
>
> Regards,
> Pascal
>
>
> On 05/29/2013 04:58 PM, Francesco Carotenuto wrote:
>  > Hi
>  > to all,
>  > I
>  > need to automatically set the geographical coordinates of the
> projection?s
>  > centre to project different polygons in different territories. My
> problem is the
>  > following.
>  > By
>  > using spTransform(xy, CRS("+proj=laea +lat_0=LAT +lon_0=LONG +x_0=0
> +y_0=0
>  > +ellps=WGS84 +units=m +no_defs")),  I would like to set  +lat_0 and
> +long_0 as objects (here ?LAT? and
>  > ?LONG?) that I automatically generated. Unfortunately, this function
> doesn?t
>  > read objects (even if ?as.numeric?) but only numerical values set
> manually. Is
>  > there a way to set these coordinates as objects?
>  > Many
>  > thanks.
>  >     [[alternative HTML version deleted]]
>  >
>  >
>  >
>  > _______________________________________________
>  > R-sig-Geo mailing list
>  > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  >
>
>


From jgrn at illinois.edu  Wed May 29 18:23:39 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 29 May 2013 11:23:39 -0500
Subject: [R-sig-Geo] RCurl: using ls instead of NLST
Message-ID: <CABG0rfsTdcpxPihqBHqWgNW7KPPCQHfpEZApJYoZys41aPdC-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130529/74875295/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Wed May 29 19:44:37 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 29 May 2013 19:44:37 +0200
Subject: [R-sig-Geo] Antw:  RCurl: using ls instead of NLST
In-Reply-To: <CABG0rfsTdcpxPihqBHqWgNW7KPPCQHfpEZApJYoZys41aPdC-g@mail.gmail.com>
References: <CABG0rfsTdcpxPihqBHqWgNW7KPPCQHfpEZApJYoZys41aPdC-g@mail.gmail.com>
Message-ID: <51A65AA5020000270001A5DE@gwia2.boku.ac.at>

Dear Jonathan,in the MODIS package I use the following function to list files within a http or a ftp folder. I'm not really practical in XML stuff but I got it working somehow.
The LP DAAC has changed from FTP to HTTP, I'm not sure if it is good idea to use the ftp protocol anymore. I also had a lot of problems with the ftplistonly=T option so I decided to use the saver version FALSE and split it by my own.
Matteo


MODIS:::filesUrl


filesUrl <- function(url)
{
    require(RCurl)


    if (substr(url,nchar(url),nchar(url))!="/")
    {
       url <- paste0(url,"/") 
    }
    
    iw   <- options()$warn 
    options(warn=-1)
    on.exit(options(warn=iw))


    try(co <- getURLContent(url),silent=TRUE)
    
    if (!exists("co")) {return(FALSE)}
    
    if (substring(url,1,4)=="http")
    {
        if(!require(XML))
        {
            stop("You need to install the 'XML' package from 'Omegahat' repository")
        }
             
        co     <- htmlTreeParse(co)
        co     <- co$children[[1]][[2]][[2]]
        co     <- sapply(co$children, function(el) xmlGetAttr(el, "href"))
        co     <- as.character(unlist(co))
        co     <- co[!co %in% c("?C=N;O=D", "?C=M;O=A", "?C=S;O=A", "?C=D;O=A")]
        fnames <- co[-1] 
         
     } else 
     {
        co <- strsplit(co, if(.Platform$OS.type=="unix"){"\n"} else{"\r\n"})[[1]]
       
        co <- strsplit(co," ")
        elim    <- grep(co,pattern="total")
        if(length(elim)==1)
        {
            co <- co[-elim]
        }
        fnames <- basename(sapply(co,function(x){x[length(x)]}))
     }
     fnames <- gsub(fnames,pattern="/",replacement="")


    return(fnames)
}





>>> Jonathan Greenberg  29.05.13 18.25 Uhr >>>
R-helpers:

I'm trying to retrieve the contents of a directory from an ftp site
(ideally, the file/folder names as a character vector):
"ftp://e4ftl01.cr.usgs.gov/MOTA/MCD12C1.005/"
# (MODIS data)

Where I get the following error via RCurl:
require("RCurl")
url <- "ftp://e4ftl01.cr.usgs.gov/MOTA/MCD12C1.005/"
filenames = getURL(url,ftp.use.epsv=FALSE,ftplistonly=TRUE)
> Error in function (type, msg, asError = TRUE)  : RETR response: 550

Through some sleuthing, it turns out the ftp site does not support NLST
(which RCurl is using), but will use "ls" to list the directory contents --
is there any way to use "ls" remotely on this site?  Thanks!

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007

    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jgrn at illinois.edu  Wed May 29 20:19:01 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 29 May 2013 13:19:01 -0500
Subject: [R-sig-Geo] Redirect rgdal to point to alternative GDAL install?
Message-ID: <CABG0rfuwb2fDoo5BWRJCdOpXxSZzWXyg6Re_rkB-wtmi8tC_XA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130529/8c71d6e0/attachment.pl>

From zaholdenfs at gmail.com  Wed May 29 20:36:19 2013
From: zaholdenfs at gmail.com (Zack Holden)
Date: Wed, 29 May 2013 12:36:19 -0600
Subject: [R-sig-Geo] raster/ncdf4 error: too many open files
In-Reply-To: <CABG0rftE0KSgoyKsfDvAe2svYbD-tVSuJOYMzgHc3k-OJd9Eug@mail.gmail.com>
References: <a8525f37f3fa499c8d11dad72c129305@CHIHT4.ad.uillinois.edu>
	<CABG0rftE0KSgoyKsfDvAe2svYbD-tVSuJOYMzgHc3k-OJd9Eug@mail.gmail.com>
Message-ID: <CAGC_mZTUB5JFHUMjB4S9H6u8Z_zQGVhziBKqOL81kqEd9AYOSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130529/ee543de9/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Wed May 29 20:45:56 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 29 May 2013 20:45:56 +0200
Subject: [R-sig-Geo] Antw: Redirect rgdal to point to alternative GDAL
 install?
In-Reply-To: <CABG0rfuwb2fDoo5BWRJCdOpXxSZzWXyg6Re_rkB-wtmi8tC_XA@mail.gmail.com>
References: <CABG0rfuwb2fDoo5BWRJCdOpXxSZzWXyg6Re_rkB-wtmi8tC_XA@mail.gmail.com>
Message-ID: <51A66904020000270001A5EF@gwia2.boku.ac.at>

Jonathan,
I don't know but this would interest me also. Have you checked the functionalities in the MODIS package? I think you intend to do things that probably are already implemented, and if not it would be great to get some help over here!
The MODIS package uses the alternative installations FWTools or OSGeos4W but through simple system() calls.


Cheers, Matteo


 

>>> Jonathan Greenberg  29.05.13 20.20 Uhr >>>
R-sig-geo'ers:

Is there a way to have rgdal use a different install of GDAL (specifically,
on Windows), e.g. OsGEO4w or FWTools or one of the other various installs
noted at http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries , rather
than the binary it comes with?  Cheers!

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007

    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed May 29 20:52:59 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 29 May 2013 20:52:59 +0200
Subject: [R-sig-Geo] Redirect rgdal to point to alternative GDAL install?
In-Reply-To: <CABG0rfuwb2fDoo5BWRJCdOpXxSZzWXyg6Re_rkB-wtmi8tC_XA@mail.gmail.com>
References: <CABG0rfuwb2fDoo5BWRJCdOpXxSZzWXyg6Re_rkB-wtmi8tC_XA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1305292052200.32741@reclus.nhh.no>

On Wed, 29 May 2013, Jonathan Greenberg wrote:

> R-sig-geo'ers:
>
> Is there a way to have rgdal use a different install of GDAL (specifically,
> on Windows), e.g. OsGEO4w or FWTools or one of the other various installs
> noted at http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries , rather
> than the binary it comes with?  Cheers!

file.show(system.file("README.windows", package="rgdal"))

but last checked several years ago. YMMA.

Roger

>
> --j
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From nwagenbrenner at gmail.com  Wed May 29 21:47:33 2013
From: nwagenbrenner at gmail.com (Natalie Wagenbrenner)
Date: Wed, 29 May 2013 13:47:33 -0600
Subject: [R-sig-Geo] gplot error in rasterVis
Message-ID: <CAHZeCqEuQHqJSJ=+MktVkkuZEckmzPreaPxzw0KRP8xsBk36QA@mail.gmail.com>

I'm trying to use gplot() in rasterVis to plot a RasterLayer object
using ggplot2
graphics, but I keep getting an error.  Here is a reproducible
example:

library(raster)
library(rasterVis)

r <- raster(ncol=10, nrow=10)
values(r) <- 1:ncell(r)
gplot(r)

The following `from` values were not present in `x`: col, color, pch,
cex, lty, lwd, srt, adj, bg, fg, min, max
Error: No layers in plot

I see the following warning when I load rasterVis:

Loading required package: ggplot2

Attaching package: ?ggplot2?

The following object(s) are masked from ?package:latticeExtra?:

    layer

Perhaps this is part of the problem? Or I am misunderstanding the
gplot() methods somehow? Thanks for any suggestions.

Natalie

Session info:

R version 2.14.1 (2011-12-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
LC_TIME=en_CA.UTF-8
 [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
LC_MESSAGES=en_CA.UTF-8
 [7] LC_PAPER=C                 LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
 [1] ggmap_2.3           RgoogleMaps_1.2.0.3 png_0.1-4
maps_2.3-2          rasterVis_0.20-07
 [6] hexbin_1.26.2       latticeExtra_0.6-24 RColorBrewer_1.0-5
lattice_0.20-0      ggplot2_0.9.3.1
[11] rgdal_0.8-9         raster_2.1-25       sp_1.0-9
ncdf_1.6.6          vimcom_0.9-8
[16] setwidth_1.0-3      colorout_1.0-0

loaded via a namespace (and not attached):
 [1] colorspace_1.2-2 dichromat_2.0-0  digest_0.6.3     gtable_0.1.2
  labeling_0.1     mapproj_1.2-1
 [7] MASS_7.3-16      munsell_0.4      plyr_1.8         proto_0.3-10
  reshape2_1.2.2   rjson_0.2.12
[13] scales_0.2.3     stringr_0.6.2    zoo_1.7-9


From damien.georges2 at gmail.com  Thu May 30 14:30:51 2013
From: damien.georges2 at gmail.com (Damien Georges)
Date: Thu, 30 May 2013 14:30:51 +0200
Subject: [R-sig-Geo] factorial models predictions with raster
Message-ID: <51A7467B.70306@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130530/efb9673f/attachment.pl>

From by-beiyao at hotmail.com  Thu May 30 14:53:33 2013
From: by-beiyao at hotmail.com (yaobei)
Date: Thu, 30 May 2013 12:53:33 +0000
Subject: [R-sig-Geo] Questions of O-ring statistic
Message-ID: <BLU169-W116BA464F94A16876B3BDF0E0910@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130530/c878843c/attachment.pl>

From oscar.perpinan at gmail.com  Thu May 30 15:52:09 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 30 May 2013 15:52:09 +0200
Subject: [R-sig-Geo] gplot error in rasterVis
In-Reply-To: <CAHZeCqEuQHqJSJ=+MktVkkuZEckmzPreaPxzw0KRP8xsBk36QA@mail.gmail.com>
References: <CAHZeCqEuQHqJSJ=+MktVkkuZEckmzPreaPxzw0KRP8xsBk36QA@mail.gmail.com>
Message-ID: <87vc60mv7a.fsf@gmail.com>

Hi,

With the current definition of gplot you have to add the layers you need
to plot (that's why you get the error "No layers to plot"). Take a look
at the example of the help page. With your example:

gplot(r) + geom_tile(aes(fill=value)) + coord_equal()

On the other hand, the warning when you use gplot is because both
latticeExtra and ggplot2 define the function layer. If ggplot2 is loaded
after rasterVis, the layer definition from latticeExtra becomes
masked. If you plan to use latticeExtra (for example, to add layers over
the result of a levelplot call) you should load ggplot2 before
rasterVis.

Best,

Oscar.

Natalie Wagenbrenner <nwagenbrenner at gmail.com> writes:

> I'm trying to use gplot() in rasterVis to plot a RasterLayer object
> using ggplot2
> graphics, but I keep getting an error.  Here is a reproducible
> example:
>
> library(raster)
> library(rasterVis)
>
> r <- raster(ncol=10, nrow=10)
> values(r) <- 1:ncell(r)
> gplot(r)
>
> The following `from` values were not present in `x`: col, color, pch,
> cex, lty, lwd, srt, adj, bg, fg, min, max
> Error: No layers in plot
>
> I see the following warning when I load rasterVis:
>
> Loading required package: ggplot2
>
> Attaching package: ?ggplot2?
>
> The following object(s) are masked from ?package:latticeExtra?:
>
>     layer
>
> Perhaps this is part of the problem? Or I am misunderstanding the
> gplot() methods somehow? Thanks for any suggestions.
>
> Natalie
>
> Session info:
>
> R version 2.14.1 (2011-12-22)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
> LC_TIME=en_CA.UTF-8
>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
> LC_MESSAGES=en_CA.UTF-8
>  [7] LC_PAPER=C                 LC_NAME=C
> LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets
> methods   base
>
> other attached packages:
>  [1] ggmap_2.3           RgoogleMaps_1.2.0.3 png_0.1-4
> maps_2.3-2          rasterVis_0.20-07
>  [6] hexbin_1.26.2       latticeExtra_0.6-24 RColorBrewer_1.0-5
> lattice_0.20-0      ggplot2_0.9.3.1
> [11] rgdal_0.8-9         raster_2.1-25       sp_1.0-9
> ncdf_1.6.6          vimcom_0.9-8
> [16] setwidth_1.0-3      colorout_1.0-0
>
> loaded via a namespace (and not attached):
>  [1] colorspace_1.2-2 dichromat_2.0-0  digest_0.6.3     gtable_0.1.2
>   labeling_0.1     mapproj_1.2-1
>  [7] MASS_7.3-16      munsell_0.4      plyr_1.8         proto_0.3-10
>   reshape2_1.2.2   rjson_0.2.12
> [13] scales_0.2.3     stringr_0.6.2    zoo_1.7-9
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From drmbongo at gmail.com  Thu May 30 15:52:55 2013
From: drmbongo at gmail.com (Jeroen Steenbeek)
Date: Thu, 30 May 2013 10:52:55 -0300
Subject: [R-sig-Geo] Kriging and datum shifts
In-Reply-To: <51A4CA1D.6050506@uni-muenster.de>
References: <51A372BA.8090308@gmail.com>
	<CAAcGz990JUSiAnRfJgH=VELtywQh0WJGNWR6to0p2eByi4r2KQ@mail.gmail.com>
	<51A4B578.5080608@gmail.com> <51A4CA1D.6050506@uni-muenster.de>
Message-ID: <51A759B7.5030202@gmail.com>

Yes Edzer, I was not using terminology accurately. Apologies, R is new 
to me.
Let me dig deeper if this simple example is needed. I will make sure if 
gstat kriging methods correctly use great circle distances correctly.
Jeroen

On 2013-05-28 12:15 PM, Edzer Pebesma wrote:
> Jeroen, sp does not have anything to do with kriging, so your comment is
> confusing.
>
> sp does create spatial objects from data.frame's, and may do some sanity
> checks on coordinates in case they are longlat -- you have to specify
> they are longlat, though.
>
> If they are specified as longlat, and e.g. gstat::idw is used for
> interpolation, it should use great circle distances as opposed to
> Euclidian distances to figure out interpolation weights. If this is not
> the case, I'd like to look at a simple, reproducible example. Kriging on
> spherical data is done at your own risk, there are no checks that the
> variogram model can be applied sanely on a sphere, as reported before.
>
>


From r.hijmans at gmail.com  Thu May 30 17:52:48 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 30 May 2013 08:52:48 -0700
Subject: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
In-Reply-To: <1369798364.68984.YahooMailNeo@web121904.mail.ne1.yahoo.com>
References: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CANtt_hyMP1p4MxukEwE5ZCcaH8AOCW5ZGYCPQFqBDiZs-Vyecg@mail.gmail.com>
	<1369798364.68984.YahooMailNeo@web121904.mail.ne1.yahoo.com>
Message-ID: <CANtt_hz_okJw7YG1eVSw=0ROhNn1ueDLu3h_u86paV4QwPBgrQ@mail.gmail.com>

I suppose you are saying that the lowest values of your breaks (zero)
are converted to NA. That is because that value is considered to be
outside of the range. See the help file about how to change this (use
argument "include.lowest=TRUE"). You can, of course, also change the
lowest value of your breaks to a somewhat lower value. Robert

On Tue, May 28, 2013 at 8:32 PM, Thiago V. dos Santos
<thi_veloso at yahoo.com.br> wrote:
> Robert,
>
> Thanks, your tip worked. However, the NA's are allocated to the first class.
> Is there a way to keep the NA's as NA's?
>
> Adding na.rm=T in the cut command doesn't work.
>
> Here is the working code:
> --------------------------------------------
> library(raster)
>
> # Download, unzip, list and stack files
> # Warning: 9Mb download and 106 files unzipped
> download.file('http://dl.dropboxusercontent.com/u/27700634/transition.zip',
> 'transition.zip')
> unzip('transition.zip')
>
> # List all files in directory with ".nc" in the name
> files <- list.files('.', pattern = 'nc', full.names=T)
>
> # Read all files and retrieve spooled data range
> s <- stack (files)
> min <- minValue(min(s)) # retrieve min values of the series
> max <- maxValue(max(s)) # ditto, for max
>
> # Define classes, breaks (class increments) and reclassify raster
> # Change this values if other number of classes is needed.
> classes <- 15
> brk = seq(min, max, by = (max-min)/classes)
> sc <- cut(s, breaks=brk)
> --------------------------------------------
>
> Thanks,
>
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
> ________________________________
> From: Robert J. Hijmans <r.hijmans at gmail.com>
> To: Thiago V. dos Santos <thi_veloso at yahoo.com.br>
> Cc: R-SIG list <r-sig-geo at r-project.org>
> Sent: Monday, May 27, 2013 11:54 PM
> Subject: Re: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
>
> Thiago, you could of course do
>
> mx <- max( cellStats(r, stat='max', na.rm=TRUE) )
>
> but this is faster:
>
> mx <- maxValue(max(r))
>
> for writing to ncdf you can use writeRaster (or a filename argument in
> cut, as long as the extension is ".nc".
>
> Robert
>
>
> On Mon, May 27, 2013 at 9:09 PM, Thiago V. dos Santos
> <thi_veloso at yahoo.com.br> wrote:
>> Dear all,
>>
>> I'm working on land use transition data that comes as netcdf. I would like
>> to reclassify each one of these files in 15 classes, based on the min and
>> max values of the entire series.
>>
>> Although I know this specific dataset ranges from 0 to 0.0680, I'd rather
>> obtain it dinamically, via R. It seems to be a low value, but it makes sense
>> since the unit is fraction of grid, which is relatively coarse (0.5 degree).
>>
>> So, the criteria to reclassify the files would be (max-min)/15. For
>> example, the class 1 would range from 0 to 0.0045, class 2 from 0.0046 to
>> 0.0090 and so on.
>>
>>
>> However, I'm not sure on the better approach. I wrote a code that stacks
>> all the 106 files and attempts to extract the extreme values, but cellStats
>> returns me a value per layer, instead of a single value.
>>
>> Here is the fully reproducible code I have so far:
>>
>> -----------------------------------------
>> require(raster) # raster operations
>> require(ncdf4)  # write updated netcdf files
>>
>> # Download, unzip, list and stack files
>> # Warning: 9Mb download and 106 files unzipped
>>
>> download.file('http://dl.dropboxusercontent.com/u/27700634/transition.zip',
>> 'transition.zip')
>> unzip('transition.zip')
>> files <- list.files('.', pattern = 'nc', full.names=T)
>> r <- stack (files)
>>
>> # retrieve min and max values of the series
>> # there are NA's, so na.rm=T is required
>> min <- cellStats(r, stat='min', na.rm=T)
>> max <- cellStats(r, stat='max', na.rm=T)
>>
>> # Define classes, breaks and reclassify raster
>> classes <- 15
>> brk = c(min, max, by = classes)
>> brk = seq(min, max, by = classes)
>> rc <- cut(r, breaks=brk)
>>
>> # Then, write each layer as a netcdf using ncdf4 - in progress
>> -----------------------------------------
>>
>>
>> Does anyone have another one/a better ideia to do this?
>>
>> Thanks in advance,
>>
>> Greetings,
>> --
>> Thiago V. dos Santos
>> PhD student
>> Land and Atmospheric Science
>> University of Minnesota
>>
>> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
>> Phone: (612) 323 9898
>>        [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


From rossahmed at googlemail.com  Thu May 30 20:43:55 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Thu, 30 May 2013 19:43:55 +0100
Subject: [R-sig-Geo] remove segments of lines
Message-ID: <CDCD5C7B.4E88%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130530/ab0c9c98/attachment.pl>

From nwagenbrenner at gmail.com  Thu May 30 23:51:16 2013
From: nwagenbrenner at gmail.com (Natalie Wagenbrenner)
Date: Thu, 30 May 2013 14:51:16 -0700
Subject: [R-sig-Geo] gplot error in rasterVis
In-Reply-To: <87vc60mv7a.fsf@gmail.com>
References: <CAHZeCqEuQHqJSJ=+MktVkkuZEckmzPreaPxzw0KRP8xsBk36QA@mail.gmail.com>
	<87vc60mv7a.fsf@gmail.com>
Message-ID: <CAHZeCqGTgV+evyPtV6mxEppsQWKy-eiAQSXc75a=Hmm7R2QDgQ@mail.gmail.com>

Thanks for the quick reply. Yes, this works for me now.

One more follow-up question -- I'm trying to plot a raster on top of a
static google map image. I can do this:

library(RgoogleMaps)
library(raster)
library(maps)
library(ggmap)

r <- raster(ncol=10, nrow=10)
values(r) <- 1:ncell(r)
extent(r)<-c(-113.5732, -112.4852, 43.04848, 43.81728)

#not ideal-> no legend, raster not transparent
bsbMap<-get_map(location = c(lon = -113.027724, lat = 43.402726), zoom
= 8, maptype = 'terrain')
m <- ggmap(bsbMap)+ inset_raster(r, xmin(r), xmax(r), ymin(r), ymax(r))

but is there a way to control plotting of the raster (e.g., to set the
transparency or color scheme) and add a legend? I was hoping to do
this with geom_raster rather than inset_raster, but it looks like
ggmap doesn't work with geom_raster. I have used geom_raster to make a
similar map with state/county boundaries:

#would like to create this sort of overlay on a static google map
rdf <- rasterToPoints(r)
rdf <- data.frame(rdf)
colnames(rdf)<-c("lon","lat","T")

states<-map_data("state", region=c("idaho", "montana", "utah", "wyoming"))
counties<-map_data("county", region=c("idaho"))

g <- ggplot( data=rdf) + geom_raster(aes(x=lon, y=lat, fill=T) )
g<-g + scale_fill_gradient(name="T (C)", low="blue", high="orange")
g<-g + theme_bw() + xlim(c(-115.5,-110.5)) + ylim(c(41.5,45))
g<-g + geom_path(data=states, aes(x=long,y=lat,group=group),
colour="black", alpha=0.5)
g<-g + geom_path(data=counties, aes(x=long,y=lat,group=group),
colour="black", alpha=0.5)

Any suggestions for the most efficient way to create this sort of
raster overlay on a google map?

Thanks,
Natalie

On Thu, May 30, 2013 at 6:52 AM, Oscar Perpi??n Lamigueiro
<oscar.perpinan at gmail.com> wrote:
> Hi,
>
> With the current definition of gplot you have to add the layers you need
> to plot (that's why you get the error "No layers to plot"). Take a look
> at the example of the help page. With your example:
>
> gplot(r) + geom_tile(aes(fill=value)) + coord_equal()
>
> On the other hand, the warning when you use gplot is because both
> latticeExtra and ggplot2 define the function layer. If ggplot2 is loaded
> after rasterVis, the layer definition from latticeExtra becomes
> masked. If you plan to use latticeExtra (for example, to add layers over
> the result of a levelplot call) you should load ggplot2 before
> rasterVis.
>
> Best,
>
> Oscar.
>
> Natalie Wagenbrenner <nwagenbrenner at gmail.com> writes:
>
>> I'm trying to use gplot() in rasterVis to plot a RasterLayer object
>> using ggplot2
>> graphics, but I keep getting an error.  Here is a reproducible
>> example:
>>
>> library(raster)
>> library(rasterVis)
>>
>> r <- raster(ncol=10, nrow=10)
>> values(r) <- 1:ncell(r)
>> gplot(r)
>>
>> The following `from` values were not present in `x`: col, color, pch,
>> cex, lty, lwd, srt, adj, bg, fg, min, max
>> Error: No layers in plot
>>
>> I see the following warning when I load rasterVis:
>>
>> Loading required package: ggplot2
>>
>> Attaching package: ?ggplot2?
>>
>> The following object(s) are masked from ?package:latticeExtra?:
>>
>>     layer
>>
>> Perhaps this is part of the problem? Or I am misunderstanding the
>> gplot() methods somehow? Thanks for any suggestions.
>>
>> Natalie
>>
>> Session info:
>>
>> R version 2.14.1 (2011-12-22)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>> LC_TIME=en_CA.UTF-8
>>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
>> LC_MESSAGES=en_CA.UTF-8
>>  [7] LC_PAPER=C                 LC_NAME=C
>> LC_ADDRESS=C
>> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
>> LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] grid      stats     graphics  grDevices utils     datasets
>> methods   base
>>
>> other attached packages:
>>  [1] ggmap_2.3           RgoogleMaps_1.2.0.3 png_0.1-4
>> maps_2.3-2          rasterVis_0.20-07
>>  [6] hexbin_1.26.2       latticeExtra_0.6-24 RColorBrewer_1.0-5
>> lattice_0.20-0      ggplot2_0.9.3.1
>> [11] rgdal_0.8-9         raster_2.1-25       sp_1.0-9
>> ncdf_1.6.6          vimcom_0.9-8
>> [16] setwidth_1.0-3      colorout_1.0-0
>>
>> loaded via a namespace (and not attached):
>>  [1] colorspace_1.2-2 dichromat_2.0-0  digest_0.6.3     gtable_0.1.2
>>   labeling_0.1     mapproj_1.2-1
>>  [7] MASS_7.3-16      munsell_0.4      plyr_1.8         proto_0.3-10
>>   reshape2_1.2.2   rjson_0.2.12
>> [13] scales_0.2.3     stringr_0.6.2    zoo_1.7-9
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> --
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (EUITI-UPM)
> URL: http://procomun.wordpress.com
> Twitter: @oscarperpinan


From r.hijmans at gmail.com  Fri May 31 01:55:52 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 30 May 2013 16:55:52 -0700
Subject: [R-sig-Geo] gplot error in rasterVis
In-Reply-To: <CAHZeCqGTgV+evyPtV6mxEppsQWKy-eiAQSXc75a=Hmm7R2QDgQ@mail.gmail.com>
References: <CAHZeCqEuQHqJSJ=+MktVkkuZEckmzPreaPxzw0KRP8xsBk36QA@mail.gmail.com>
	<87vc60mv7a.fsf@gmail.com>
	<CAHZeCqGTgV+evyPtV6mxEppsQWKy-eiAQSXc75a=Hmm7R2QDgQ@mail.gmail.com>
Message-ID: <CANtt_hzeGd2K18QCDvV1+yP9T5RUQObuzxNkcitmmBK599FNNQ@mail.gmail.com>

Here a simple alternative approach:

library(dismo)

r <- raster(ncol=10, nrow=10)
values(r) <- 1:ncell(r)
extent(r)<-c(-113.5732, -112.4852, 43.04848, 43.81728)

# get map
g <- gmap(r, lonlat=TRUE)
gg <- crop(g, r)

# simple, no legend
plot(gg)
image(r, col=terrain.colors(25, alpha=.25), add=TRUE)

# with some tricks to get legend:
plot(r, col=terrain.colors(25, alpha=.25))
plot(gg, add=TRUE)
image(r, col=terrain.colors(25, alpha=.25), add=TRUE)



On Thu, May 30, 2013 at 2:51 PM, Natalie Wagenbrenner
<nwagenbrenner at gmail.com> wrote:
> Thanks for the quick reply. Yes, this works for me now.
>
> One more follow-up question -- I'm trying to plot a raster on top of a
> static google map image. I can do this:
>
> library(RgoogleMaps)
> library(raster)
> library(maps)
> library(ggmap)
>
> r <- raster(ncol=10, nrow=10)
> values(r) <- 1:ncell(r)
> extent(r)<-c(-113.5732, -112.4852, 43.04848, 43.81728)
>
> #not ideal-> no legend, raster not transparent
> bsbMap<-get_map(location = c(lon = -113.027724, lat = 43.402726), zoom
> = 8, maptype = 'terrain')
> m <- ggmap(bsbMap)+ inset_raster(r, xmin(r), xmax(r), ymin(r), ymax(r))
>
> but is there a way to control plotting of the raster (e.g., to set the
> transparency or color scheme) and add a legend? I was hoping to do
> this with geom_raster rather than inset_raster, but it looks like
> ggmap doesn't work with geom_raster. I have used geom_raster to make a
> similar map with state/county boundaries:
>
> #would like to create this sort of overlay on a static google map
> rdf <- rasterToPoints(r)
> rdf <- data.frame(rdf)
> colnames(rdf)<-c("lon","lat","T")
>
> states<-map_data("state", region=c("idaho", "montana", "utah", "wyoming"))
> counties<-map_data("county", region=c("idaho"))
>
> g <- ggplot( data=rdf) + geom_raster(aes(x=lon, y=lat, fill=T) )
> g<-g + scale_fill_gradient(name="T (C)", low="blue", high="orange")
> g<-g + theme_bw() + xlim(c(-115.5,-110.5)) + ylim(c(41.5,45))
> g<-g + geom_path(data=states, aes(x=long,y=lat,group=group),
> colour="black", alpha=0.5)
> g<-g + geom_path(data=counties, aes(x=long,y=lat,group=group),
> colour="black", alpha=0.5)
>
> Any suggestions for the most efficient way to create this sort of
> raster overlay on a google map?
>
> Thanks,
> Natalie
>
> On Thu, May 30, 2013 at 6:52 AM, Oscar Perpi??n Lamigueiro
> <oscar.perpinan at gmail.com> wrote:
>> Hi,
>>
>> With the current definition of gplot you have to add the layers you need
>> to plot (that's why you get the error "No layers to plot"). Take a look
>> at the example of the help page. With your example:
>>
>> gplot(r) + geom_tile(aes(fill=value)) + coord_equal()
>>
>> On the other hand, the warning when you use gplot is because both
>> latticeExtra and ggplot2 define the function layer. If ggplot2 is loaded
>> after rasterVis, the layer definition from latticeExtra becomes
>> masked. If you plan to use latticeExtra (for example, to add layers over
>> the result of a levelplot call) you should load ggplot2 before
>> rasterVis.
>>
>> Best,
>>
>> Oscar.
>>
>> Natalie Wagenbrenner <nwagenbrenner at gmail.com> writes:
>>
>>> I'm trying to use gplot() in rasterVis to plot a RasterLayer object
>>> using ggplot2
>>> graphics, but I keep getting an error.  Here is a reproducible
>>> example:
>>>
>>> library(raster)
>>> library(rasterVis)
>>>
>>> r <- raster(ncol=10, nrow=10)
>>> values(r) <- 1:ncell(r)
>>> gplot(r)
>>>
>>> The following `from` values were not present in `x`: col, color, pch,
>>> cex, lty, lwd, srt, adj, bg, fg, min, max
>>> Error: No layers in plot
>>>
>>> I see the following warning when I load rasterVis:
>>>
>>> Loading required package: ggplot2
>>>
>>> Attaching package: ?ggplot2?
>>>
>>> The following object(s) are masked from ?package:latticeExtra?:
>>>
>>>     layer
>>>
>>> Perhaps this is part of the problem? Or I am misunderstanding the
>>> gplot() methods somehow? Thanks for any suggestions.
>>>
>>> Natalie
>>>
>>> Session info:
>>>
>>> R version 2.14.1 (2011-12-22)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>> LC_TIME=en_CA.UTF-8
>>>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
>>> LC_MESSAGES=en_CA.UTF-8
>>>  [7] LC_PAPER=C                 LC_NAME=C
>>> LC_ADDRESS=C
>>> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
>>> LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] grid      stats     graphics  grDevices utils     datasets
>>> methods   base
>>>
>>> other attached packages:
>>>  [1] ggmap_2.3           RgoogleMaps_1.2.0.3 png_0.1-4
>>> maps_2.3-2          rasterVis_0.20-07
>>>  [6] hexbin_1.26.2       latticeExtra_0.6-24 RColorBrewer_1.0-5
>>> lattice_0.20-0      ggplot2_0.9.3.1
>>> [11] rgdal_0.8-9         raster_2.1-25       sp_1.0-9
>>> ncdf_1.6.6          vimcom_0.9-8
>>> [16] setwidth_1.0-3      colorout_1.0-0
>>>
>>> loaded via a namespace (and not attached):
>>>  [1] colorspace_1.2-2 dichromat_2.0-0  digest_0.6.3     gtable_0.1.2
>>>   labeling_0.1     mapproj_1.2-1
>>>  [7] MASS_7.3-16      munsell_0.4      plyr_1.8         proto_0.3-10
>>>   reshape2_1.2.2   rjson_0.2.12
>>> [13] scales_0.2.3     stringr_0.6.2    zoo_1.7-9
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> --
>> Oscar Perpi??n Lamigueiro
>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>> Dpto. Ingenier?a El?ctrica (EUITI-UPM)
>> URL: http://procomun.wordpress.com
>> Twitter: @oscarperpinan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.turner at auckland.ac.nz  Fri May 31 04:35:36 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 31 May 2013 14:35:36 +1200
Subject: [R-sig-Geo] Questions of O-ring statistic
In-Reply-To: <BLU169-W116BA464F94A16876B3BDF0E0910@phx.gbl>
References: <BLU169-W116BA464F94A16876B3BDF0E0910@phx.gbl>
Message-ID: <51A80C78.3010908@auckland.ac.nz>


This appears to be, essentially, a question about the spatstat package
and thus would be best directed to the maintainer of that package,
Adrian Baddeley.

Unfortunately I haven't sufficient knowledge or insight to address your 
question.
Adrian, who has sufficient knowledge and insight, is travelling at the 
moment
and thus may not read his cc of this email for a while.

When he does read it, I'm sure that he will be able to give you some useful
advice.

     cheers,

On 31/05/13 00:53, yaobei wrote:
> Dear all,I confused about O-ring in inhomogeneous version. I don't know how to do that when we consider inhomogeneity. I have written the code for O-ring,  is it right? Please give me some suggestions!data(lansing)
>
> X  <-
> unmark(split(lansing)$maple)
>
> #
> inhomogeneous O-ring
>
> #Estimate
> the inhomogeneous pair-correlation function: pcfinhom()
>
> g.inhom=pcfinhom(X)
>
>   
>
> #O-ring
> statistic
>
> lambda=summary(X)$intensity
>
> K.inhom=Kinhom(X)
>
> O.inhom
> = eval.fv(lambda*g.inhom)
>
> plot(O.inhom,
> ylab="Oring(r)")


From lukaslehnert at googlemail.com  Fri May 31 16:19:42 2013
From: lukaslehnert at googlemail.com (Lukas Lehnert)
Date: Fri, 31 May 2013 16:19:42 +0200
Subject: [R-sig-Geo] Create raster data set using rgdal
Message-ID: <5710375.iedZSTBDOG@kobold>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130531/8349f637/attachment.pl>

From thi_veloso at yahoo.com.br  Fri May 31 18:00:48 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Fri, 31 May 2013 09:00:48 -0700 (PDT)
Subject: [R-sig-Geo] Classify 106 netcdf's based on their spooled range
In-Reply-To: <CANtt_hz_okJw7YG1eVSw=0ROhNn1ueDLu3h_u86paV4QwPBgrQ@mail.gmail.com>
References: <1369714180.38314.YahooMailNeo@web121901.mail.ne1.yahoo.com>
	<CANtt_hyMP1p4MxukEwE5ZCcaH8AOCW5ZGYCPQFqBDiZs-Vyecg@mail.gmail.com>
	<1369798364.68984.YahooMailNeo@web121904.mail.ne1.yahoo.com>
	<CANtt_hz_okJw7YG1eVSw=0ROhNn1ueDLu3h_u86paV4QwPBgrQ@mail.gmail.com>
Message-ID: <1370016048.20610.YahooMailNeo@web121903.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130531/f08cf645/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri May 31 18:29:55 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 31 May 2013 17:29:55 +0100
Subject: [R-sig-Geo] Create raster data set using rgdal
In-Reply-To: <85b4abbb5599452499264e860b8d4508@EX-0-HT0.lancs.local>
References: <85b4abbb5599452499264e860b8d4508@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMm3Yj-54Ots35hNAER0EXXAc6_xEFRwRLUccj=i6hw3A@mail.gmail.com>

On Fri, May 31, 2013 at 3:19 PM, Lukas Lehnert
<lukaslehnert at googlemail.com> wrote:
> Dear all,
>
> is there any recommended way to create a new raster file (if possible of Envi-
> format) using rgdal by simply omitting the number of bands, columns, rows and
> the datatype? How can I fill that file with new data?

 Did you mean "omitting" (leaving out)? Or did you mean "specifying"?
Hard to know what's left if you omit all that information!

 I'd use the raster package. rgdal and raster don't really let you
"fill in" existing files, you have to read them in and write them out
into R objects.

Here's how to create an empty raster object with an extent, number of
rows and columns, then put some random numbers in it and plot. See
?writeRaster for how to create your Envi output file.

 > r = raster(nrows=180, ncols=360, xmn=-180, xmx=180, ymn=-90, ymx=90)
 > r
class       : RasterLayer
dimensions  : 180, 360, 64800  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84

 > r[]=runif(64800)
 > plot(r)
 > ?writeRaster

Barry


