From emason at uark.edu  Tue Apr  3 02:05:27 2007
From: emason at uark.edu (emason)
Date: Mon, 02 Apr 2007 19:05:27 -0500
Subject: [R-sig-Geo] quadrat.test()
Message-ID: <20070402190527.yschkvot8gkkos80@uamail.uark.edu>

Hello,  I stumbled upon an respones you write regarding the quadrat()  
function in R.  I have been manhandling it all day and I still cannot  
get quadrat() or quadrat.test() to work for me.  I keep getting this  
errror:

Error in quadrat.count.engine(X$x, X$y, b$xbreaks, b$ybreaks) :
         xbreaks do not span the actual range of x coordinates in data

Does this mean anything to you?  I am at a total loss.

Thank You,

Erin K.



From e.pebesma at geo.uu.nl  Tue Apr  3 10:17:45 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 03 Apr 2007 10:17:45 +0200
Subject: [R-sig-Geo] R - PostGIS connectivity
Message-ID: <46120DA9.7030406@geo.uu.nl>

Dear list members,

I've been exploring a bit the possibilities of PostGIS, and accessing 
its functionality (the GEOS geometry library really) from R. I used 
writeOGR and readOGR from rgdal to move sp objects in and out the data 
base, and used sqlQuery from RODBC to do a spatial query on the data 
base. Preliminary results can be found on 
http://wiki.intamap.org/index.php/PostGIS

The next step could be to wrap these kind of steps in functions that 
hide the fact that there's an RDBMS and some SQL involved. The full set 
of OpenGIS functions 
(http://postgis.refractions.net/docs/ch06.html#id2852098 ) and PostGIS 
extensions is, however, rather large, and installing PostgreSQL+PostGIS 
besides R is straightforward, but has some overhead too -- I guess we 
can't wrap that in an install.package("rpostgis") call.

I welcome any suggestions or discussion.
--
Edzer



From rob.robinson at bto.org  Tue Apr  3 16:32:08 2007
From: rob.robinson at bto.org (Rob Robinson)
Date: Tue, 3 Apr 2007 15:32:08 +0100
Subject: [R-sig-Geo] Manipulating SpatialPolygonsDataFrames
Message-ID: <002801c775fc$dbcb2340$5285c3c1@btodomain.bto.org>

Dear All,
 I am trying to combine various layers of data into a single image. The last
layer is a sea mask to blank out some extraneous kernel areas. I have a map
(read in from an ESRI shapefile using readShapePoly) as a
SpatialPolygonsDataFrame, which obviously has all the countries as
'foreground', does anyone know of an easy to invert this, so the sea becomes
forground? I can see in principle you might be able to do something with the
RingDir slot (to turn polygons into holes and vice versa), but can't figure
out how to access it to try.
 Any hints gratefully received!
Cheers
rob

*** Want to know about Britain's birds? Try  www.bto.org/birdfacts ***

Dr Rob Robinson, Senior Population Biologist
British Trust for Ornithology, The Nunnery, Thetford, Norfolk, IP24 2PU
Ph: +44 (0)1842 750050         E: rob.robinson at bto.org
Fx: +44 (0)1842 750030         W: http://www.bto.org
eSafe scanned this email for viruses, vandals and malicious content (!)

==== "How can anyone be enlightened, when truth is so poorly lit" =====



From Roger.Bivand at nhh.no  Tue Apr  3 21:00:27 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 3 Apr 2007 21:00:27 +0200 (CEST)
Subject: [R-sig-Geo] Manipulating SpatialPolygonsDataFrames
In-Reply-To: <002801c775fc$dbcb2340$5285c3c1@btodomain.bto.org>
Message-ID: <Pine.LNX.4.44.0704032054020.31591-100000@reclus.nhh.no>

On Tue, 3 Apr 2007, Rob Robinson wrote:

> Dear All,
>  I am trying to combine various layers of data into a single image. The last
> layer is a sea mask to blank out some extraneous kernel areas. I have a map
> (read in from an ESRI shapefile using readShapePoly) as a
> SpatialPolygonsDataFrame, which obviously has all the countries as
> 'foreground', does anyone know of an easy to invert this, so the sea becomes
> forground? I can see in principle you might be able to do something with the
> RingDir slot (to turn polygons into holes and vice versa), but can't figure
> out how to access it to try.

It isn't that easy, unfortunately. You'll need not only to create an outer 
rectangle, but also to link up all of the internal holes so that the first 
fill of the mask doesn't flood the holes. That is, polygons are drawn from 
largest to smallest, so your initial graphic will be covered by the 
external mask first. 

Could the kernel points/rasters be overlay()ed over the land first, and
then select (as say SpatialPixels) the ones to image() if falling on land?

Roger

>  Any hints gratefully received!
> Cheers
> rob
> 
> *** Want to know about Britain's birds? Try  www.bto.org/birdfacts ***
> 
> Dr Rob Robinson, Senior Population Biologist
> British Trust for Ornithology, The Nunnery, Thetford, Norfolk, IP24 2PU
> Ph: +44 (0)1842 750050         E: rob.robinson at bto.org
> Fx: +44 (0)1842 750030         W: http://www.bto.org
> eSafe scanned this email for viruses, vandals and malicious content (!)
> 
> ==== "How can anyone be enlightened, when truth is so poorly lit" =====
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kissling at uni-mainz.de  Wed Apr  4 08:49:19 2007
From: kissling at uni-mainz.de (W. Daniel Kissling)
Date: Wed, 04 Apr 2007 08:49:19 +0200
Subject: [R-sig-Geo] Duttileul's method
Message-ID: <4613668F.22766.2B54B6@localhost>

Hi all,

I am currently looking for a possibility to calculate the geographically effective 
degrees of freedom of a (non-spatial ordinary least squares) regression model in the 
presence of spatial autocorrelation within a gridded dataset. My regression model has 
spatial autocorrelation in the residuals (indicated by Moran's I values) but I do not 
want to use a spatial model (e.g. errorsarlm in package spdep). Instead, I would like 
to calculate the significance tests of my (non-spatial) regression model using the 
reduced degrees of freedom. I know that there is the Duttileul's method (Duttileul 
1993) in other software packages which does exactly this. Is there anything 
comparable in R? Is there a function in the spdep (or any other) package which 
allows this to be computed?

I am very happy to get feedback.

Best regards
Daniel

--------------------------------------------------------------------
W. Daniel Kissling
Community & Macroecology Group
Institut f?r Zoologie, Abteilung ?kologie
Johannes Gutenberg-Universit?t Mainz
D-55099 Mainz, Germany

Tel. +49 (0)6131 3925200  
Fax +49 (0)6131 3923731 
E-mail: kissling at uni-mainz.de

Personal: http://www.danielkissling.de/
Research Group: http://www.oekologie.biologie.uni-mainz.de/commecol/main.html
Virtual Institute Macroecology: http://www.ufz.de/index.php?en=6302
Centre of Macroecology: http://www.macroecology.ku.dk/



From Roger.Bivand at nhh.no  Wed Apr  4 13:22:54 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 4 Apr 2007 13:22:54 +0200 (CEST)
Subject: [R-sig-Geo] Duttileul's method
In-Reply-To: <4613668F.22766.2B54B6@localhost>
Message-ID: <Pine.LNX.4.44.0704040958320.32306-100000@reclus.nhh.no>

On Wed, 4 Apr 2007, W. Daniel Kissling wrote:

> Hi all,
> 
> I am currently looking for a possibility to calculate the geographically
> effective degrees of freedom of a (non-spatial ordinary least squares)
> regression model in the presence of spatial autocorrelation within a
> gridded dataset. My regression model has spatial autocorrelation in the
> residuals (indicated by Moran's I values) but I do not want to use a
> spatial model (e.g. errorsarlm in package spdep). Instead, I would like
> to calculate the significance tests of my (non-spatial) regression model
> using the reduced degrees of freedom. I know that there is the
> Duttileul's method (Duttileul 1993) in other software packages which
> does exactly this. Is there anything comparable in R? Is there a
> function in the spdep (or any other) package which allows this to be
> computed?

There is no implementation of degrees of freedom adjustment in contributed 
packages that I am aware of, and RSiteSearch() also gives no hits, so this 
seems to be correct. Essentially, to adjust the df you may need to fit the 
spatial model anyway, to get an estimate of the loss of df caused by 
autocorrelation. There is also a recent paper by Griffith in AAAG, 
December 2005, pp. 740-760.

Roger

> 
> I am very happy to get feedback.
> 
> Best regards
> Daniel
> 
> --------------------------------------------------------------------
> W. Daniel Kissling
> Community & Macroecology Group
> Institut f?r Zoologie, Abteilung ?kologie
> Johannes Gutenberg-Universit?t Mainz
> D-55099 Mainz, Germany
> 
> Tel. +49 (0)6131 3925200  
> Fax +49 (0)6131 3923731 
> E-mail: kissling at uni-mainz.de
> 
> Personal: http://www.danielkissling.de/
> Research Group: http://www.oekologie.biologie.uni-mainz.de/commecol/main.html
> Virtual Institute Macroecology: http://www.ufz.de/index.php?en=6302
> Centre of Macroecology: http://www.macroecology.ku.dk/
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Wed Apr  4 21:17:39 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Wed, 4 Apr 2007 14:17:39 -0500
Subject: [R-sig-Geo] Good projection for N/S America?
Message-ID: <6262c54c0704041217u49052fb6w588763fd641ffa31@mail.gmail.com>

Anyone know of a particularly good map projection for showing all of
North and South America without too much distortion?

THK

-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From White.Denis at epamail.epa.gov  Wed Apr  4 22:20:55 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Wed, 4 Apr 2007 13:20:55 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <6262c54c0704041217u49052fb6w588763fd641ffa31@mail.gmail.com>
Message-ID: <OFEFBC45A6.6EC1E9D3-ON882572B3.006E84F0-882572B3.006FC78A@epamail.epa.gov>

Tim,

It depends on which kind of distortion is of most concern.  For many
types of extensive data, especially counts, for example, the equal area
property is desirable.  We used the Lambert cylindrical equal area
projection with standard parallels of +/- 30 degrees for some western
hemispherical work, see reference below.  (The center longitude could be
-80 west, but that is less important than the choice of parallels.)

Before falling back on the Lambert as an easy to use projection, I tried
to get several ESRI products to implement an interrupted projection
using the sinusoidal projection, in part for reasons given in the second
reference.  I used a separate center longitude for north and south of
the equator and the appearance is certainly more satisfactory than the
Lambert in my opinion.  I'll attach a PDF of an illustration of this
approach generated in R that I hope you will get but not the rest of the
list unfortunately.  I can send PDFs of the references also if needed.

Denis

Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
climate-induced range shifts: model differences and model reliability.
Global Change Biology 12:1568-1584.

White D.  2006.  Display of pixel loss and replication in reprojecting
raster data from the sinusoidal projection.  Geocarto International
21(2):19-22.

(See attached file: whemi.sinus.pdf)

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04 12:17:39:

> Anyone know of a particularly good map projection for showing all of
> North and South America without too much distortion?
>
> THK
>
> --
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.sinus.pdf
Type: application/pdf
Size: 145041 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070404/b1399279/attachment.pdf>

From temiz at deprem.gov.tr  Thu Apr  5 17:02:56 2007
From: temiz at deprem.gov.tr (temiz)
Date: Thu, 05 Apr 2007 11:02:56 -0400
Subject: [R-sig-Geo] error in SpatialGridDataFrame
Message-ID: <46150FA0.5090505@deprem.gov.tr>

hello

when I followed the steps of  ORDINARY KRIGING IN R WITH GRASS6 DATA in 
GRASS 6 Tutorial.

I encountered this error:

 > mask_SG <- 
SpatialGridDataFrame(grd,data=list(k=rep(1,G$cols3*G$rows3)),proj4string=CRS(G$proj4))
Error in validObject(.Object) : invalid class "SpatialGridDataFrame" 
object: invalid object for slot "data" in class "SpatialGridDataFrame": 
got class "list", should be or extend class "data.frame"


can you tell me why ?

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From e.pebesma at geo.uu.nl  Thu Apr  5 11:10:19 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 05 Apr 2007 11:10:19 +0200
Subject: [R-sig-Geo] error in SpatialGridDataFrame
In-Reply-To: <46150FA0.5090505@deprem.gov.tr>
References: <46150FA0.5090505@deprem.gov.tr>
Message-ID: <4614BCFB.9070305@geo.uu.nl>

temiz wrote:
> hello
>
> when I followed the steps of  ORDINARY KRIGING IN R WITH GRASS6 DATA in 
> GRASS 6 Tutorial.
>
> I encountered this error:
>
>  > mask_SG <- 
> SpatialGridDataFrame(grd,data=list(k=rep(1,G$cols3*G$rows3)),proj4string=CRS(G$proj4))
> Error in validObject(.Object) : invalid class "SpatialGridDataFrame" 
> object: invalid object for slot "data" in class "SpatialGridDataFrame": 
> got class "list", should be or extend class "data.frame"
>
>
> can you tell me why ?
>   
Yes. The data slot changed from list to data.frame, at some stage, for 
good reasons.

Replace list(... with data.frame(... and you're fine.
--
Edzer



From Roger.Bivand at nhh.no  Thu Apr  5 13:32:44 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Apr 2007 13:32:44 +0200 (CEST)
Subject: [R-sig-Geo] quadrat.test()
In-Reply-To: <20070402190527.yschkvot8gkkos80@uamail.uark.edu>
Message-ID: <Pine.LNX.4.44.0704051324560.1188-100000@reclus.nhh.no>

On Mon, 2 Apr 2007, emason wrote:

> Hello,  I stumbled upon an respones you write regarding the quadrat()  
> function in R.  I have been manhandling it all day and I still cannot  
> get quadrat() or quadrat.test() to work for me.  I keep getting this  
> errror:
> 
> Error in quadrat.count.engine(X$x, X$y, b$xbreaks, b$ybreaks) :
>          xbreaks do not span the actual range of x coordinates in data
> 
> Does this mean anything to you?  I am at a total loss.

Please always include the command giving the error message in your 
posting, otherwise we have to guess.

Looking at the code and ?quadrat.test, and trying:

data(simdat)
simdat
quadrat.test(simdat)

works, but if xbreaks= is set outside x's range:

quadrat.test(simdat, xbreaks=seq(-10,0,1))

your error appears. So you are setting an inappropriate xbreaks= argument, 
or possibly have an inappropriate window in your ppp object.

> 
> Thank You,
> 
> Erin K.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Apr  5 13:53:26 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Apr 2007 13:53:26 +0200 (CEST)
Subject: [R-sig-Geo] [Moved from R-help] Re: [R] confine a dataframe with a
	polygon
In-Reply-To: <46139BBC.2050704@deprem.gov.tr>
Message-ID: <Pine.LNX.4.44.0704051341550.1188-100000@reclus.nhh.no>

On Wed, 4 Apr 2007, temiz wrote:

> Roger Bivand wrote:
> > On Tue, 3 Apr 2007, temiz wrote:
> >
> >   
> >> hello
> >>
> >> how can I confine a dataframe with a known polygon that is part of whole 
> >> data ?
> >>     
> >
> > Could I suggest following up this question on the R-sig-geo list? It is 
> > not clear what you want to do - are the rows in the data frame points 
> > which may lie inside or outside a polygon? If so, the overlay() methods in 
> > the sp package may be suitable.
> >
> >   
> >> regards
> >>
> >>
> >>     
> >
> >   
> thank you for your reply
> 
> I have not been aware of  that list (R-sig-geo list)
> My data is elevation point data in a text file.
> I want to create DEMs with different interpolation
> methods for comparision.
> Actually I created DEM in GRASS using spline tension.
> Then I want to create DEM in R with different techniques to compare.
> But my data seems so huge for GSTAT-kriging and FIELDS-krig.
> So I decided to select smaller interpolation area within whole data.
> 
> How can I define a subregion in which I do interpolation ?

In R-GRASS, use system("g.region ...") to set the subregion before 
readRAST6().

For interpolation, you have two data sets, the point data for which you 
know z, and the newdata points, often a raster, to which you want to 
interpolate. I guess that you want to define the prediction model based on 
all the data, then predict for tiles of newdata locations for export with 
writeRAST6(). They can be put together in GRASS with system("r.patch 
..."), or a more detailed process taking care of possible overlaps.

> 
> I found locator and chull function that may serve this.
> 
> I will regard your recommendations.
> 
> PS : Thinking facing a memory problem, I refrained from GRASS-R interface.
> 

Use system("g.region ...") to choose a small enough region.

If your observed data are also large volume (a big DEM, for example), you 
will need to be careful how you do things, possibly either using the GDAL 
GRASS plugin and rgdal, or r.out.gdal for say geotiff, and then subset the 
amount of data read in in readGDAL. Users report success with very large 
data sets and rgdal, you just need to do things in sensible subsets.

> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From temiz at deprem.gov.tr  Thu Apr  5 20:32:02 2007
From: temiz at deprem.gov.tr (temiz)
Date: Thu, 05 Apr 2007 14:32:02 -0400
Subject: [R-sig-Geo] error in krig interpolation
Message-ID: <461540A2.3090101@deprem.gov.tr>

when does this error occur ?

 > zz <- krige(formula = log(el1$z) ~ 1, locations = ~x+y , data = el1 
,newdata = mask_SG , model = efitted) Error in function (classes, fdef, 
mtable)  :
        unable to find an inherited method for function "coordinates<-", 
for signature "SpatialPointsDataFrame"


str(el1) gives:

Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 24051 obs. of  4 variables:
  .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
  .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
  .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
  .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
  ..@ coords.nrs : num(0)
  ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 449276 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
+no_defs"



regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From e.pebesma at geo.uu.nl  Thu Apr  5 14:30:33 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 05 Apr 2007 14:30:33 +0200
Subject: [R-sig-Geo] error in krig interpolation
In-Reply-To: <461540A2.3090101@deprem.gov.tr>
References: <461540A2.3090101@deprem.gov.tr>
Message-ID: <4614EBE9.8040001@geo.uu.nl>

el1 is already a SpatialPointsDataFrame, so omit the locations argument.

You may try something as simple as

zz <- krige(log(z) ~ 1, el1, mask_SG, efitted) 

--
Edzer

temiz wrote:
> when does this error occur ?
>
>  > zz <- krige(formula = log(el1$z) ~ 1, locations = ~x+y , data = el1 
> ,newdata = mask_SG , model = efitted) Error in function (classes, fdef, 
> mtable)  :
>         unable to find an inherited method for function "coordinates<-", 
> for signature "SpatialPointsDataFrame"
>
>
> str(el1) gives:
>
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>   ..@ data       :'data.frame': 24051 obs. of  4 variables:
>   .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
>   .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
>   .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
>   .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
>   ..@ coords.nrs : num(0)
>   ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 449276 ...
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : NULL
>   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>   ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>   .. .. ..$ : chr [1:2] "min" "max"
>   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>   .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
> +no_defs"
>
>
>
> regards
>
>



From temiz at deprem.gov.tr  Thu Apr  5 20:48:45 2007
From: temiz at deprem.gov.tr (temiz)
Date: Thu, 05 Apr 2007 14:48:45 -0400
Subject: [R-sig-Geo] problem in krige function
Message-ID: <4615448D.5050705@deprem.gov.tr>


following the topic GRASS and R kriging interpolation from grass6 tutorial

I came here without problems

But here:

zz <- krige(z ~ 1, locations = el1 , newdata = mask_SG , model = efitted)
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
        var1 : data item in gstat object and newdata have different 
coordinate reference systems

how can I solve this problem ?

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From Roger.Bivand at nhh.no  Thu Apr  5 14:54:05 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Apr 2007 14:54:05 +0200 (CEST)
Subject: [R-sig-Geo] error in krig interpolation
In-Reply-To: <4614EBE9.8040001@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0704051436310.1188-100000@reclus.nhh.no>

On Thu, 5 Apr 2007, Edzer J. Pebesma wrote:

> el1 is already a SpatialPointsDataFrame, so omit the locations argument.
> 
> You may try something as simple as
> 
> zz <- krige(log(z) ~ 1, el1, mask_SG, efitted) 

The real problem is that "ORDINARY KRIGING IN R WITH GRASS6 DATA" is on a 
wiki with no responsible owner or maintainer, and no automatic way of 
synchronising it with current code:

http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation

The original is not signed, with no attached data sets or location, so we
can't ask anyone to keep it working.  I've added:

(WARNING!! Most of the code quoted here is very out of date, and simply 
does not work for current R/sp/gstat/spgrass6. Untried suggestions 
have been edited in, but without a test location, there is no 
guarantee that they will work! Roger Bivand, 5 April 2007)

at the top of the section, and tried to indicate the worst inaccuracies.

Roger

> 
> --
> Edzer
> 
> temiz wrote:
> > when does this error occur ?
> >
> >  > zz <- krige(formula = log(el1$z) ~ 1, locations = ~x+y , data = el1 
> > ,newdata = mask_SG , model = efitted) Error in function (classes, fdef, 
> > mtable)  :
> >         unable to find an inherited method for function "coordinates<-", 
> > for signature "SpatialPointsDataFrame"
> >
> >
> > str(el1) gives:
> >
> > Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
> >   ..@ data       :'data.frame': 24051 obs. of  4 variables:
> >   .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
> >   .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
> >   .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
> >   .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
> >   ..@ coords.nrs : num(0)
> >   ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 449276 ...
> >   .. ..- attr(*, "dimnames")=List of 2
> >   .. .. ..$ : NULL
> >   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
> >   ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
> >   .. ..- attr(*, "dimnames")=List of 2
> >   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
> >   .. .. ..$ : chr [1:2] "min" "max"
> >   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
> >   .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
> > +no_defs"
> >
> >
> >
> > regards
> >
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Thu Apr  5 14:51:49 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 05 Apr 2007 14:51:49 +0200
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <4615448D.5050705@deprem.gov.tr>
References: <4615448D.5050705@deprem.gov.tr>
Message-ID: <4614F0E5.5050005@geo.uu.nl>

temiz wrote:
> following the topic GRASS and R kriging interpolation from grass6 tutorial
>
> I came here without problems
>
> But here:
>
> zz <- krige(z ~ 1, locations = el1 , newdata = mask_SG , model = efitted)
> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
>         var1 : data item in gstat object and newdata have different 
> coordinate reference systems
>
> how can I solve this problem ?
>   

How about making sure they are equal? If you know they are equal, do

proj4string(el1) = CRS(proj4string(mask_SG))

else use spTransform from rgdal to re-project.

gstat checks that the projection strings are exactly equal; this is a 
check too strong, and should be replaced by some check that they 
represent exactly the same projection. Does anyone know how to perform 
this check?
--
Edzer



From Roger.Bivand at nhh.no  Thu Apr  5 15:08:31 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Apr 2007 15:08:31 +0200 (CEST)
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <4615448D.5050705@deprem.gov.tr>
Message-ID: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>

On Thu, 5 Apr 2007, temiz wrote:

> 
> following the topic GRASS and R kriging interpolation from grass6 tutorial
> 
> I came here without problems
> 
> But here:
> 
> zz <- krige(z ~ 1, locations = el1 , newdata = mask_SG , model = efitted)
> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
>         var1 : data item in gstat object and newdata have different 
> coordinate reference systems

If:

proj4string(el1)
proj4string(mask_SG)

differ, the function will stop you predicting from data declared to be in 
one projection to newdata points in a different projection. You can set 
them by:

proj4string(mask_SG) <- CRS(proj4string(el1))

(untried). If this does not work, post the commands you used to create the 
objects.

Roger

> 
> how can I solve this problem ?
> 
> regards
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Apr  5 15:11:25 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Apr 2007 15:11:25 +0200 (CEST)
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <4614F0E5.5050005@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0704051508531.1188-100000@reclus.nhh.no>

On Thu, 5 Apr 2007, Edzer J. Pebesma wrote:

> temiz wrote:
> > following the topic GRASS and R kriging interpolation from grass6 tutorial
> >
> > I came here without problems
> >
> > But here:
> >
> > zz <- krige(z ~ 1, locations = el1 , newdata = mask_SG , model = efitted)
> > Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
> >         var1 : data item in gstat object and newdata have different 
> > coordinate reference systems
> >
> > how can I solve this problem ?
> >   
> 
> How about making sure they are equal? If you know they are equal, do
> 
> proj4string(el1) = CRS(proj4string(mask_SG))

or better:

proj4string(mask_SG) = CRS(proj4string(el1))

> 
> else use spTransform from rgdal to re-project.
> 
> gstat checks that the projection strings are exactly equal; this is a 
> check too strong, and should be replaced by some check that they 
> represent exactly the same projection. Does anyone know how to perform 
> this check?

No, OGR/PROJ.4 use ellipse names, GRASS tends to break them out as a=, b=, 
arguments. The solution if you know that they should be the same is as you 
give it - the problem is only with the R/GRASS interface.

Roger

> --
> Edzer
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Thu Apr  5 19:00:19 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 5 Apr 2007 12:00:19 -0500
Subject: [R-sig-Geo] spplot
Message-ID: <6262c54c0704051000y6d384725q27dd454a8a3a581@mail.gmail.com>

> spplot(beta, "1")
Error in `[.data.frame`(as(obj, "data.frame"), zcol) :
        undefined columns selected

I can't seem to fix this. Version:       0.9-10


THK


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From e.pebesma at geo.uu.nl  Thu Apr  5 19:44:56 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 05 Apr 2007 19:44:56 +0200
Subject: [R-sig-Geo] spplot
In-Reply-To: <6262c54c0704051000y6d384725q27dd454a8a3a581@mail.gmail.com>
References: <6262c54c0704051000y6d384725q27dd454a8a3a581@mail.gmail.com>
Message-ID: <46153598.8010806@geo.uu.nl>

Tim Keitt wrote:

>>spplot(beta, "1")
>>    
>>
>Error in `[.data.frame`(as(obj, "data.frame"), zcol) :
>        undefined columns selected
>
>I can't seem to fix this. Version:       0.9-10
>
>  
>
Thought I fixed this -- how about sp 0.9-11 current CRAN version?
--
Edzer



From tkeitt at gmail.com  Thu Apr  5 19:47:50 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 5 Apr 2007 12:47:50 -0500
Subject: [R-sig-Geo] spplot
In-Reply-To: <46153598.8010806@geo.uu.nl>
References: <6262c54c0704051000y6d384725q27dd454a8a3a581@mail.gmail.com>
	<46153598.8010806@geo.uu.nl>
Message-ID: <6262c54c0704051047j22c6ab20pfed1cf71f8f6268c@mail.gmail.com>

Should have thought of that -- updating now.

THK

On 4/5/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> Tim Keitt wrote:
>
> >>spplot(beta, "1")
> >>
> >>
> >Error in `[.data.frame`(as(obj, "data.frame"), zcol) :
> >        undefined columns selected
> >
> >I can't seem to fix this. Version:       0.9-10
> >
> >
> >
> Thought I fixed this -- how about sp 0.9-11 current CRAN version?
> --
> Edzer
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From tkeitt at gmail.com  Thu Apr  5 19:56:09 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 5 Apr 2007 12:56:09 -0500
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OFEFBC45A6.6EC1E9D3-ON882572B3.006E84F0-882572B3.006FC78A@epamail.epa.gov>
References: <6262c54c0704041217u49052fb6w588763fd641ffa31@mail.gmail.com>
	<OFEFBC45A6.6EC1E9D3-ON882572B3.006E84F0-882572B3.006FC78A@epamail.epa.gov>
Message-ID: <6262c54c0704051056w76e7a5a7wf5e32239c4bff34b@mail.gmail.com>

Thanks. My application is not that demanding. Really, I just want it
to look reasonable. My plan is to lay out the postings in the
projected coordinates and then back transform into geographic
coordinates for analysis. I tried lots of projections and found
Lamberts Azimuthal Equal Area to be quite good. I like the look of the
Azimuthal Equidistant better, but figured equal area was a good
choice.

THK

On 4/4/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov> wrote:
> Tim,
>
> It depends on which kind of distortion is of most concern.  For many
> types of extensive data, especially counts, for example, the equal area
> property is desirable.  We used the Lambert cylindrical equal area
> projection with standard parallels of +/- 30 degrees for some western
> hemispherical work, see reference below.  (The center longitude could be
> -80 west, but that is less important than the choice of parallels.)
>
> Before falling back on the Lambert as an easy to use projection, I tried
> to get several ESRI products to implement an interrupted projection
> using the sinusoidal projection, in part for reasons given in the second
> reference.  I used a separate center longitude for north and south of
> the equator and the appearance is certainly more satisfactory than the
> Lambert in my opinion.  I'll attach a PDF of an illustration of this
> approach generated in R that I hope you will get but not the rest of the
> list unfortunately.  I can send PDFs of the references also if needed.
>
> Denis
>
> Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
> climate-induced range shifts: model differences and model reliability.
> Global Change Biology 12:1568-1584.
>
> White D.  2006.  Display of pixel loss and replication in reprojecting
> raster data from the sinusoidal projection.  Geocarto International
> 21(2):19-22.
>
> (See attached file: whemi.sinus.pdf)
>
> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04 12:17:39:
>
> > Anyone know of a particularly good map projection for showing all of
> > North and South America without too much distortion?
> >
> > THK
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From lsmithingm at gmail.com  Fri Apr  6 00:43:44 2007
From: lsmithingm at gmail.com (Linda Smith)
Date: Thu, 5 Apr 2007 15:43:44 -0700
Subject: [R-sig-Geo] [R] how to image.plot a XY grid file into a lat-lon
	map
In-Reply-To: <Pine.LNX.4.44.0704051422380.1188-100000@reclus.nhh.no>
References: <9852612.post@talk.nabble.com>
	<Pine.LNX.4.44.0704051422380.1188-100000@reclus.nhh.no>
Message-ID: <f22a33d30704051543m2ffd1492j3d6a1823914d62ff@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070405/87f8226c/attachment.pl>

From temiz at deprem.gov.tr  Fri Apr  6 15:21:01 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 06 Apr 2007 09:21:01 -0400
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
Message-ID: <4616493D.4030401@deprem.gov.tr>

Roger Bivand wrote:
> On Thu, 5 Apr 2007, temiz wrote:
>
>   
>> following the topic GRASS and R kriging interpolation from grass6 tutorial
>>
>> I came here without problems
>>
>> But here:
>>
>> zz <- krige(z ~ 1, locations = el1 , newdata = mask_SG , model = efitted)
>> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
>>         var1 : data item in gstat object and newdata have different 
>> coordinate reference systems
>>     
>
> If:
>
> proj4string(el1)
> proj4string(mask_SG)
>
> differ, the function will stop you predicting from data declared to be in 
> one projection to newdata points in a different projection. You can set 
> them by:
>
> proj4string(mask_SG) <- CRS(proj4string(el1))
>
> (untried). If this does not work, post the commands you used to create the 
> objects.
>
> Roger
>
>   
>> how can I solve this problem ?
>>
>> regards
>>
>>
>>     
>
>   
Thank you

I regarded some modifications in 
http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation

I encountered a new problem :
 > OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, model=efitted)
[using ordinary kriging]

"memory.c", line 57: can't allocate memory in function m_get()
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
        m_get



Why does this problem arise ?

I selected a great deal smaller area in R than I did in grass and 
carried out with spline tension without any problem.

is the data too dense or grid size too small ?

regards



-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From e.pebesma at geo.uu.nl  Fri Apr  6 09:29:19 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 06 Apr 2007 09:29:19 +0200
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <4616493D.4030401@deprem.gov.tr>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
	<4616493D.4030401@deprem.gov.tr>
Message-ID: <4615F6CF.7040601@geo.uu.nl>

temiz wrote:
> ...
> I regarded some modifications in 
> http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation
>
> I encountered a new problem :
>  > OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, model=efitted)
> [using ordinary kriging]
>
> "memory.c", line 57: can't allocate memory in function m_get()
> Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
>         m_get
>
>
>
> Why does this problem arise ?
>
> I selected a great deal smaller area in R than I did in grass and 
> carried out with spline tension without any problem.
>
> is the data too dense or grid size too small ?
>
>   
Hard to tell without knowing the dimensions from el3 and mask_SG. 
Kriging involves solving a system as large as the full covariance matrix 
of the data, if you don't constrain it to looking at local search 
neighbourhoods only. So, if el3 has 10.000 points, you're trying to form 
a covariance matrix of 800 Mb.

I'd suggest you look into setting the nmax or maxdist arguments to 
krige() if this seems the case.

And yes, if mask_SG is massively large, than that may be the cause and 
you may want to split up the problem in a batch of smaller ones.
--
Edzer



From e.pebesma at geo.uu.nl  Fri Apr  6 09:31:24 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 06 Apr 2007 09:31:24 +0200
Subject: [R-sig-Geo] [R] how to image.plot a XY grid file into a lat-lon
 map
In-Reply-To: <f22a33d30704051543m2ffd1492j3d6a1823914d62ff@mail.gmail.com>
References: <9852612.post@talk.nabble.com>	<Pine.LNX.4.44.0704051422380.1188-100000@reclus.nhh.no>
	<f22a33d30704051543m2ffd1492j3d6a1823914d62ff@mail.gmail.com>
Message-ID: <4615F74C.9000300@geo.uu.nl>

May I suggest you take a look at the Spatial Task View?

r-project.org -> CRAN -> Select Mirror -> Task Views -> Spatial.
--
Edzer

Linda Smith wrote:
> Could you please let me know more details about rgval package? I have never
> used it before. I only tried image.plot() where if you have regular lat and
> lon, a map() function can be used later to overlay state map onto it.
>
> On 4/5/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>   
>> On Thu, 5 Apr 2007, Vladimir Eremeev wrote:
>>
>>     
>>> If your country or state borders are polygons or polylines, you could
>>> convert them to desired projection using the function project from the
>>> package rgdal.
>>>
>>> Latitude-longitude grid also could be added by generating desired
>>> polylines in lat-lon and converting them to the desired projection using
>>> project.
>>>
>>>       
>> Yes, the route would be to plot the image in its native projection, and
>> project the vector data (shorelines, countries) to the same projection.
>> Similar topics have been discussed on the R-sig-geo list, including the
>> reading of netcdf files (which are a bit picky) with functions in the
>> rgdal package which import the coordinate reference system directly.
>>
>> Please follow this up on R-sig-geo if you need more help.
>>
>>     
>>> Linda Smith wrote:
>>>       
>>>> I have a netcdf gridded file with LCC projection. I can easily use
>>>> image.plot to visualize it. However, as the axises are in X,Y, not Lat
>>>>         
>> and
>>     
>>>> Lon, I could not add state or country maps onto it (or lat lon
>>>> information).
>>>> I do have a grid2d file that describes the lat and lon for each (X,Y)
>>>> grid,
>>>> but the lat and lon are not regularly spaced, so I could not use
>>>> image.plot.
>>>>
>>>> Does anyone know how to plot this type of gridded data so that country
>>>>         
>> or
>>     
>>>> state borders can be easily added? Thanks a lot!
>>>>
>>>>         
>>> What do you mean by "grid2d file that describes the lat and lon for each
>>> (X,Y) grid"?
>>> If this are two rasters of the same size having corresponding latitude
>>>       
>> and
>>     
>>> longitude values in each raster cell, then you could use contourLines to
>>>       
>> get
>>     
>>> lat-lon grid. However, you, probably, will want to smooth it.
>>>
>>>       
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> ______________________________________________
>> R-help at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>>     
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From temiz at deprem.gov.tr  Fri Apr  6 16:19:29 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 06 Apr 2007 10:19:29 -0400
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <4615F6CF.7040601@geo.uu.nl>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
	<4616493D.4030401@deprem.gov.tr> <4615F6CF.7040601@geo.uu.nl>
Message-ID: <461656F1.5000603@deprem.gov.tr>

Edzer J. Pebesma wrote:
> temiz wrote:
>> ...
>> I regarded some modifications in 
>> http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation 
>>
>>
>> I encountered a new problem :
>>  > OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, model=efitted)
>> [using ordinary kriging]
>>
>> "memory.c", line 57: can't allocate memory in function m_get()
>> Error in predict.gstat(g, newdata = newdata, block = block, nsim = 
>> nsim,  :
>>         m_get
>>
>>
>>
>> Why does this problem arise ?
>>
>> I selected a great deal smaller area in R than I did in grass and 
>> carried out with spline tension without any problem.
>>
>> is the data too dense or grid size too small ?
>>
>>   
> Hard to tell without knowing the dimensions from el3 and mask_SG. 
> Kriging involves solving a system as large as the full covariance 
> matrix of the data, if you don't constrain it to looking at local 
> search neighbourhoods only. So, if el3 has 10.000 points, you're 
> trying to form a covariance matrix of 800 Mb.
>
> I'd suggest you look into setting the nmax or maxdist arguments to 
> krige() if this seems the case.
>
> And yes, if mask_SG is massively large, than that may be the cause and 
> you may want to split up the problem in a batch of smaller ones.
> -- 
> Edzer
>
>
thank you ?


here is my data profile:

 > str(mask_SG)
Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
  ..@ data       :'data.frame': 549792 obs. of  1 variable:
  .. ..$ k: num [1:549792] 1 1 1 1 1 1 1 1 1 1 ...
  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
  .. .. ..@ cellcentre.offset: num [1:2]  449088 4584535
  .. .. ..@ cellsize         : num [1:2] 10 10
  .. .. ..@ cells.dim        : int [1:2] 747 736
  ..@ grid.index : int(0)
  ..@ coords     : num [1:2, 1:2]  449088  456548 4584535 4591886
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  ..@ bbox       : num [1:2, 1:2]  449083 4584530  456553 4591891
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
+no_defs"

~~~~~~~~~~~~

 > str(el3)
Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 24051 obs. of  4 variables:
  .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
  .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
  .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
  .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
  ..@ coords.nrs : num(0)
  ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 449276 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
+no_defs"


I tried different maxdist,nmin,and nmax values as
OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, 
model=efitted,maxdist=100,nmin=2,nmax=5)

now, it gives:

"chfactor.c", line 130: singular matrix in function LDLfactor()
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
        LDLfactor


what happens if real data and predicted data overlap ?


-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From e.pebesma at geo.uu.nl  Fri Apr  6 10:56:43 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 06 Apr 2007 10:56:43 +0200
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <461656F1.5000603@deprem.gov.tr>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
	<4616493D.4030401@deprem.gov.tr> <4615F6CF.7040601@geo.uu.nl>
	<461656F1.5000603@deprem.gov.tr>
Message-ID: <46160B4B.7040609@geo.uu.nl>

Most probably you have duplicate points in your observations.

You may try to use zerodist() to find them, or remove.duplicates() to 
remove them but this may currently run out of memory as the current 
implementation forms the full distance matrix. In that case you'd have 
to go through it in parts.
--
Edzer

temiz wrote:
> Edzer J. Pebesma wrote:
>> temiz wrote:
>>> ...
>>> I regarded some modifications in 
>>> http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation 
>>>
>>>
>>> I encountered a new problem :
>>>  > OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, model=efitted)
>>> [using ordinary kriging]
>>>
>>> "memory.c", line 57: can't allocate memory in function m_get()
>>> Error in predict.gstat(g, newdata = newdata, block = block, nsim = 
>>> nsim,  :
>>>         m_get
>>>
>>>
>>>
>>> Why does this problem arise ?
>>>
>>> I selected a great deal smaller area in R than I did in grass and 
>>> carried out with spline tension without any problem.
>>>
>>> is the data too dense or grid size too small ?
>>>
>>>   
>> Hard to tell without knowing the dimensions from el3 and mask_SG. 
>> Kriging involves solving a system as large as the full covariance 
>> matrix of the data, if you don't constrain it to looking at local 
>> search neighbourhoods only. So, if el3 has 10.000 points, you're 
>> trying to form a covariance matrix of 800 Mb.
>>
>> I'd suggest you look into setting the nmax or maxdist arguments to 
>> krige() if this seems the case.
>>
>> And yes, if mask_SG is massively large, than that may be the cause 
>> and you may want to split up the problem in a batch of smaller ones.
>> -- 
>> Edzer
>>
>>
> thank you ?
>
>
> here is my data profile:
>
> > str(mask_SG)
> Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
>  ..@ data       :'data.frame': 549792 obs. of  1 variable:
>  .. ..$ k: num [1:549792] 1 1 1 1 1 1 1 1 1 1 ...
>  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>  .. .. ..@ cellcentre.offset: num [1:2]  449088 4584535
>  .. .. ..@ cellsize         : num [1:2] 10 10
>  .. .. ..@ cells.dim        : int [1:2] 747 736
>  ..@ grid.index : int(0)
>  ..@ coords     : num [1:2, 1:2]  449088  456548 4584535 4591886
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : NULL
>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>  ..@ bbox       : num [1:2, 1:2]  449083 4584530  456553 4591891
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>  .. .. ..$ : chr [1:2] "min" "max"
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
> +no_defs"
>
> ~~~~~~~~~~~~
>
> > str(el3)
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>  ..@ data       :'data.frame': 24051 obs. of  4 variables:
>  .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
>  .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
>  .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
>  .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
>  ..@ coords.nrs : num(0)
>  ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 
> 449276 ...
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : NULL
>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>  ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>  .. .. ..$ : chr [1:2] "min" "max"
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
> +no_defs"
>
>
> I tried different maxdist,nmin,and nmax values as
> OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, 
> model=efitted,maxdist=100,nmin=2,nmax=5)
>
> now, it gives:
>
> "chfactor.c", line 130: singular matrix in function LDLfactor()
> Error in predict.gstat(g, newdata = newdata, block = block, nsim = 
> nsim,  :
>        LDLfactor
>
>
> what happens if real data and predicted data overlap ?
>
>



From temiz at deprem.gov.tr  Fri Apr  6 19:29:37 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 06 Apr 2007 13:29:37 -0400
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <46160B4B.7040609@geo.uu.nl>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
	<4616493D.4030401@deprem.gov.tr> <4615F6CF.7040601@geo.uu.nl>
	<461656F1.5000603@deprem.gov.tr> <46160B4B.7040609@geo.uu.nl>
Message-ID: <46168381.60905@deprem.gov.tr>

Edzer J. Pebesma wrote:
> Most probably you have duplicate points in your observations.
>
> You may try to use zerodist() to find them, or remove.duplicates() to 
> remove them but this may currently run out of memory as the current 
> implementation forms the full distance matrix. In that case you'd have 
> to go through it in parts.
> -- 
> Edzer
>
> temiz wrote:
>> Edzer J. Pebesma wrote:
>>> temiz wrote:
>>>> ...
>>>> I regarded some modifications in 
>>>> http://grass.gdf-hannover.de/wiki/GRASS_6_Tutorial#GRASS_and_R_kriging_interpolation 
>>>>
>>>>
>>>> I encountered a new problem :
>>>>  > OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, model=efitted)
>>>> [using ordinary kriging]
>>>>
>>>> "memory.c", line 57: can't allocate memory in function m_get()
>>>> Error in predict.gstat(g, newdata = newdata, block = block, nsim = 
>>>> nsim,  :
>>>>         m_get
>>>>
>>>>
>>>>
>>>> Why does this problem arise ?
>>>>
>>>> I selected a great deal smaller area in R than I did in grass and 
>>>> carried out with spline tension without any problem.
>>>>
>>>> is the data too dense or grid size too small ?
>>>>
>>>>   
>>> Hard to tell without knowing the dimensions from el3 and mask_SG. 
>>> Kriging involves solving a system as large as the full covariance 
>>> matrix of the data, if you don't constrain it to looking at local 
>>> search neighbourhoods only. So, if el3 has 10.000 points, you're 
>>> trying to form a covariance matrix of 800 Mb.
>>>
>>> I'd suggest you look into setting the nmax or maxdist arguments to 
>>> krige() if this seems the case.
>>>
>>> And yes, if mask_SG is massively large, than that may be the cause 
>>> and you may want to split up the problem in a batch of smaller ones.
>>> -- 
>>> Edzer
>>>
>>>
>> thank you ?
>>
>>
>> here is my data profile:
>>
>> > str(mask_SG)
>> Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
>>  ..@ data       :'data.frame': 549792 obs. of  1 variable:
>>  .. ..$ k: num [1:549792] 1 1 1 1 1 1 1 1 1 1 ...
>>  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>>  .. .. ..@ cellcentre.offset: num [1:2]  449088 4584535
>>  .. .. ..@ cellsize         : num [1:2] 10 10
>>  .. .. ..@ cells.dim        : int [1:2] 747 736
>>  ..@ grid.index : int(0)
>>  ..@ coords     : num [1:2, 1:2]  449088  456548 4584535 4591886
>>  .. ..- attr(*, "dimnames")=List of 2
>>  .. .. ..$ : NULL
>>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>>  ..@ bbox       : num [1:2, 1:2]  449083 4584530  456553 4591891
>>  .. ..- attr(*, "dimnames")=List of 2
>>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>>  .. .. ..$ : chr [1:2] "min" "max"
>>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>>  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
>> +no_defs"
>>
>> ~~~~~~~~~~~~
>>
>> > str(el3)
>> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>>  ..@ data       :'data.frame': 24051 obs. of  4 variables:
>>  .. ..$ cat: num [1:24051] 1 2 3 4 5 6 7 8 9 10 ...
>>  .. ..$ x  : num [1:24051] 449114 449204 449262 449263 449276 ...
>>  .. ..$ y  : num [1:24051] 4590406 4590375 4590117 4590304 4590214 ...
>>  .. ..$ z  : num [1:24051] 110 110 110 110 110 110 110 110 110 110 ...
>>  ..@ coords.nrs : num(0)
>>  ..@ coords     : num [1:24051, 1:2] 449114 449204 449262 449263 
>> 449276 ...
>>  .. ..- attr(*, "dimnames")=List of 2
>>  .. .. ..$ : NULL
>>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>>  ..@ bbox       : num [1:2, 1:2]  449083 4584531  456552 4591890
>>  .. ..- attr(*, "dimnames")=List of 2
>>  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>>  .. .. ..$ : chr [1:2] "min" "max"
>>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>>  .. .. ..@ projargs: chr " +proj=utm +zone=36 +ellps=intl +units=m 
>> +no_defs"
>>
>>
>> I tried different maxdist,nmin,and nmax values as
>> OK_pred <- krige(z ~ 1, el3, newdata=mask_SG, 
>> model=efitted,maxdist=100,nmin=2,nmax=5)
>>
>> now, it gives:
>>
>> "chfactor.c", line 130: singular matrix in function LDLfactor()
>> Error in predict.gstat(g, newdata = newdata, block = block, nsim = 
>> nsim,  :
>>        LDLfactor
>>
>>
>> what happens if real data and predicted data overlap ?
>>
>>
>
>
I tried :

 > zerodist(el3$x, el3$y,el3$z, zero = 0.0)
Error in zerodist(el3$x, el3$y, el3$z, zero = 0) :
        unused argument(s) (c(4590405.661827, 4590374.745888, 
4590116.746993, 4590303.944226, 4590213.551664, 4590021.100459, 
4589924.277879, 4589828.612158, 4589739.33, 4589526.363336, 
4589123.641052, 4589214.602309, 4589127.09066, 4589307.025734, 
4589488.585501, 4589394.940462, 4589185.586814, 4589256.657301, 
4589349.740632, 4589739.33, 4589446.095212, 4589642.691654, 
4589544.436132, 4590464.7, 4590464.7, 4590432.214366, 4590356.815318, 
4589884.257655, 4589980.37416, 4590076.599159, 4590271.149476, 
4589788.818878, 4589403.306827,


 > remove.duplicates(el3, zero = 0.0, remove.second = TRUE)
Error: cannot allocate vector of size 2259572 Kb

Is there another way rather  than choosing smaller region ?

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From White.Denis at epamail.epa.gov  Thu Apr  5 22:29:21 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Thu, 5 Apr 2007 13:29:21 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <6262c54c0704051056w76e7a5a7wf5e32239c4bff34b@mail.gmail.com>
Message-ID: <OFC3190AE8.D7D7EA7B-ON882572B4.006D8F7D-882572B4.00708D46@epamail.epa.gov>

Yes, for many uses that is my choice also.  For the conterminous US for
example, the Lambert azimuthal has lower mean distortion than the
commonly used standard projection, the Albers conical equal area,
although Albers was chosen by USGS as a standard because of lower
extreme distortion than many other possible projections.

For our hemispherical application, because we were gridding the data, we
wanted parallels of latitude to be parallel in the projected coordinate
space, which we wouldn't get with the Lambert azimuthal.

(See attached file: whemi.projs.pdf)

Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:

> Thanks. My application is not that demanding. Really, I just want it
> to look reasonable. My plan is to lay out the postings in the
> projected coordinates and then back transform into geographic
> coordinates for analysis. I tried lots of projections and found
> Lamberts Azimuthal Equal Area to be quite good. I like the look of the
> Azimuthal Equidistant better, but figured equal area was a good
> choice.
>
> THK
>
> On 4/4/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov>
wrote:
> > Tim,
> >
> > It depends on which kind of distortion is of most concern.  For many
> > types of extensive data, especially counts, for example, the equal
area
> > property is desirable.  We used the Lambert cylindrical equal area
> > projection with standard parallels of +/- 30 degrees for some
western
> > hemispherical work, see reference below.  (The center longitude
could be
> > -80 west, but that is less important than the choice of parallels.)
> >
> > Before falling back on the Lambert as an easy to use projection, I
tried
> > to get several ESRI products to implement an interrupted projection
> > using the sinusoidal projection, in part for reasons given in the
second
> > reference.  I used a separate center longitude for north and south
of
> > the equator and the appearance is certainly more satisfactory than
the
> > Lambert in my opinion.  I'll attach a PDF of an illustration of this
> > approach generated in R that I hope you will get but not the rest of
the
> > list unfortunately.  I can send PDFs of the references also if
needed.
> >
> > Denis
> >
> > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
> > climate-induced range shifts: model differences and model
reliability.
> > Global Change Biology 12:1568-1584.
> >
> > White D.  2006.  Display of pixel loss and replication in
reprojecting
> > raster data from the sinusoidal projection.  Geocarto International
> > 21(2):19-22.
> >
> > (See attached file: whemi.sinus.pdf)
> >
> > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04 12:17:39:
> >
> > > Anyone know of a particularly good map projection for showing all
of
> > > North and South America without too much distortion?
> > >
> > > THK
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.projs.pdf
Type: application/pdf
Size: 447058 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070405/bf76284c/attachment.pdf>

From Roger.Bivand at nhh.no  Fri Apr  6 13:51:53 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 6 Apr 2007 13:51:53 +0200 (CEST)
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OFC3190AE8.D7D7EA7B-ON882572B4.006D8F7D-882572B4.00708D46@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0704061349160.5204-100000@reclus.nhh.no>

Since this topic is of general interest, I've made an exception and 
allowed (this once!) a posting of more than 200K. In general, if graphics 
are big, please consider either an alternative device (png is often OK), 
or posting just a URL to the real file.

With apologies to list members on dial-up connections in the field,

Roger


On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:

> Yes, for many uses that is my choice also.  For the conterminous US for
> example, the Lambert azimuthal has lower mean distortion than the
> commonly used standard projection, the Albers conical equal area,
> although Albers was chosen by USGS as a standard because of lower
> extreme distortion than many other possible projections.
> 
> For our hemispherical application, because we were gridding the data, we
> wanted parallels of latitude to be parallel in the projected coordinate
> space, which we wouldn't get with the Lambert azimuthal.
> 
> (See attached file: whemi.projs.pdf)
> 
> Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> 
> > Thanks. My application is not that demanding. Really, I just want it
> > to look reasonable. My plan is to lay out the postings in the
> > projected coordinates and then back transform into geographic
> > coordinates for analysis. I tried lots of projections and found
> > Lamberts Azimuthal Equal Area to be quite good. I like the look of the
> > Azimuthal Equidistant better, but figured equal area was a good
> > choice.
> >
> > THK
> >
> > On 4/4/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov>
> wrote:
> > > Tim,
> > >
> > > It depends on which kind of distortion is of most concern.  For many
> > > types of extensive data, especially counts, for example, the equal
> area
> > > property is desirable.  We used the Lambert cylindrical equal area
> > > projection with standard parallels of +/- 30 degrees for some
> western
> > > hemispherical work, see reference below.  (The center longitude
> could be
> > > -80 west, but that is less important than the choice of parallels.)
> > >
> > > Before falling back on the Lambert as an easy to use projection, I
> tried
> > > to get several ESRI products to implement an interrupted projection
> > > using the sinusoidal projection, in part for reasons given in the
> second
> > > reference.  I used a separate center longitude for north and south
> of
> > > the equator and the appearance is certainly more satisfactory than
> the
> > > Lambert in my opinion.  I'll attach a PDF of an illustration of this
> > > approach generated in R that I hope you will get but not the rest of
> the
> > > list unfortunately.  I can send PDFs of the references also if
> needed.
> > >
> > > Denis
> > >
> > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
> > > climate-induced range shifts: model differences and model
> reliability.
> > > Global Change Biology 12:1568-1584.
> > >
> > > White D.  2006.  Display of pixel loss and replication in
> reprojecting
> > > raster data from the sinusoidal projection.  Geocarto International
> > > 21(2):19-22.
> > >
> > > (See attached file: whemi.sinus.pdf)
> > >
> > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04 12:17:39:
> > >
> > > > Anyone know of a particularly good map projection for showing all
> of
> > > > North and South America without too much distortion?
> > > >
> > > > THK
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Fri Apr  6 13:55:35 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 06 Apr 2007 13:55:35 +0200
Subject: [R-sig-Geo] problem in krige function
In-Reply-To: <46168381.60905@deprem.gov.tr>
References: <Pine.LNX.4.44.0704051456530.1188-100000@reclus.nhh.no>
	<4616493D.4030401@deprem.gov.tr> <4615F6CF.7040601@geo.uu.nl>
	<461656F1.5000603@deprem.gov.tr> <46160B4B.7040609@geo.uu.nl>
	<46168381.60905@deprem.gov.tr>
Message-ID: <46163537.3020009@geo.uu.nl>

temiz wrote:
>
> > remove.duplicates(el3, zero = 0.0, remove.second = TRUE)
> Error: cannot allocate vector of size 2259572 Kb
>
> Is there another way rather  than choosing smaller region ?
>
Yes, wait for sp 0.9-12, which is "on its way to CRAN", where zerodist 
should work without a large memory footprint -- I moved the zerodist 
code from R to C. (I needed it myself for a 30.000 point data set this 
morning.)
--
Edzer

-------------- next part --------------
An embedded message was scrubbed...
From: Kurt Hornik <Kurt.Hornik at wu-wien.ac.at>
Subject: Re: sp_0.9-12.tar.gz
Date: Fri, 6 Apr 2007 13:39:31 +0200
Size: 2545
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070406/eb39ac30/attachment.mht>

From White.Denis at epamail.epa.gov  Fri Apr  6 18:39:12 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Fri, 6 Apr 2007 09:39:12 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <Pine.LNX.4.44.0704061349160.5204-100000@reclus.nhh.no>
Message-ID: <OF86D70E22.A6B743AA-ON882572B5.005A5B85-882572B5.005B7C1D@epamail.epa.gov>

Thanks, Roger.  There was a request to see the R code for these figures.
Attached is the script for the second PDF file plus the input boundary
file I used for the hemisphere.  The three projection functions are for
simple spherical, rather than ellipsoidal, models of the earth.  The
graticule generating function could be more elegant.  I'm not yet up to
speed with sp and the many new spatial capabilities in R so please
excuse the old style "lines()" format encoding and graphics.

Tim, I don't know whether proj4 could do the interrupted sinusoidal.

(See attached file: whemi.projs.r)(See attached file: whemi.lin)

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06 04:51:53:

> Since this topic is of general interest, I've made an exception and
> allowed (this once!) a posting of more than 200K. In general, if
graphics
> are big, please consider either an alternative device (png is often
OK),
> or posting just a URL to the real file.
>
> With apologies to list members on dial-up connections in the field,
>
> Roger
>
>
> On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
>
> > Yes, for many uses that is my choice also.  For the conterminous US
for
> > example, the Lambert azimuthal has lower mean distortion than the
> > commonly used standard projection, the Albers conical equal area,
> > although Albers was chosen by USGS as a standard because of lower
> > extreme distortion than many other possible projections.
> >
> > For our hemispherical application, because we were gridding the
data, we
> > wanted parallels of latitude to be parallel in the projected
coordinate
> > space, which we wouldn't get with the Lambert azimuthal.
> >
> > (See attached file: whemi.projs.pdf)
> >
> > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> >
> > > Thanks. My application is not that demanding. Really, I just want
it
> > > to look reasonable. My plan is to lay out the postings in the
> > > projected coordinates and then back transform into geographic
> > > coordinates for analysis. I tried lots of projections and found
> > > Lamberts Azimuthal Equal Area to be quite good. I like the look of
the
> > > Azimuthal Equidistant better, but figured equal area was a good
> > > choice.
> > >
> > > THK
> > >
> > > On 4/4/07, White.Denis at epamail.epa.gov
<White.Denis at epamail.epa.gov>
> > wrote:
> > > > Tim,
> > > >
> > > > It depends on which kind of distortion is of most concern.  For
many
> > > > types of extensive data, especially counts, for example, the
equal
> > area
> > > > property is desirable.  We used the Lambert cylindrical equal
area
> > > > projection with standard parallels of +/- 30 degrees for some
> > western
> > > > hemispherical work, see reference below.  (The center longitude
> > could be
> > > > -80 west, but that is less important than the choice of
parallels.)
> > > >
> > > > Before falling back on the Lambert as an easy to use projection,
I
> > tried
> > > > to get several ESRI products to implement an interrupted
projection
> > > > using the sinusoidal projection, in part for reasons given in
the
> > second
> > > > reference.  I used a separate center longitude for north and
south
> > of
> > > > the equator and the appearance is certainly more satisfactory
than
> > the
> > > > Lambert in my opinion.  I'll attach a PDF of an illustration of
this
> > > > approach generated in R that I hope you will get but not the
rest of
> > the
> > > > list unfortunately.  I can send PDFs of the references also if
> > needed.
> > > >
> > > > Denis
> > > >
> > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
> > > > climate-induced range shifts: model differences and model
> > reliability.
> > > > Global Change Biology 12:1568-1584.
> > > >
> > > > White D.  2006.  Display of pixel loss and replication in
> > reprojecting
> > > > raster data from the sinusoidal projection.  Geocarto
International
> > > > 21(2):19-22.
> > > >
> > > > (See attached file: whemi.sinus.pdf)
> > > >
> > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04
12:17:39:
> > > >
> > > > > Anyone know of a particularly good map projection for showing
all
> > of
> > > > > North and South America without too much distortion?
> > > > >
> > > > > THK
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School
of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.projs.r
Type: application/octet-stream
Size: 3891 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070406/6b3963f4/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.lin
Type: application/octet-stream
Size: 143578 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070406/6b3963f4/attachment-0001.obj>

From tkeitt at gmail.com  Sun Apr  8 16:56:03 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Sun, 8 Apr 2007 09:56:03 -0500
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OF86D70E22.A6B743AA-ON882572B5.005A5B85-882572B5.005B7C1D@epamail.epa.gov>
References: <Pine.LNX.4.44.0704061349160.5204-100000@reclus.nhh.no>
	<OF86D70E22.A6B743AA-ON882572B5.005A5B85-882572B5.005B7C1D@epamail.epa.gov>
Message-ID: <6262c54c0704080756w2faeabc0j3f8e2dd557afb0dc@mail.gmail.com>

Denis,

That's really useful. It occurs to me that we only really need a
half-dozen basic projections to cover 90% of user cases. Perhaps these
could be incorporated into the 'sp' group somewhere and relieve the
dependence on proj4. (It could be packaged separately for R  for the
other 10% of cases where its needed.)

THK

On 4/6/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov> wrote:
> Thanks, Roger.  There was a request to see the R code for these figures.
> Attached is the script for the second PDF file plus the input boundary
> file I used for the hemisphere.  The three projection functions are for
> simple spherical, rather than ellipsoidal, models of the earth.  The
> graticule generating function could be more elegant.  I'm not yet up to
> speed with sp and the many new spatial capabilities in R so please
> excuse the old style "lines()" format encoding and graphics.
>
> Tim, I don't know whether proj4 could do the interrupted sinusoidal.
>
> (See attached file: whemi.projs.r)(See attached file: whemi.lin)
>
> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06 04:51:53:
>
> > Since this topic is of general interest, I've made an exception and
> > allowed (this once!) a posting of more than 200K. In general, if
> graphics
> > are big, please consider either an alternative device (png is often
> OK),
> > or posting just a URL to the real file.
> >
> > With apologies to list members on dial-up connections in the field,
> >
> > Roger
> >
> >
> > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> >
> > > Yes, for many uses that is my choice also.  For the conterminous US
> for
> > > example, the Lambert azimuthal has lower mean distortion than the
> > > commonly used standard projection, the Albers conical equal area,
> > > although Albers was chosen by USGS as a standard because of lower
> > > extreme distortion than many other possible projections.
> > >
> > > For our hemispherical application, because we were gridding the
> data, we
> > > wanted parallels of latitude to be parallel in the projected
> coordinate
> > > space, which we wouldn't get with the Lambert azimuthal.
> > >
> > > (See attached file: whemi.projs.pdf)
> > >
> > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > >
> > > > Thanks. My application is not that demanding. Really, I just want
> it
> > > > to look reasonable. My plan is to lay out the postings in the
> > > > projected coordinates and then back transform into geographic
> > > > coordinates for analysis. I tried lots of projections and found
> > > > Lamberts Azimuthal Equal Area to be quite good. I like the look of
> the
> > > > Azimuthal Equidistant better, but figured equal area was a good
> > > > choice.
> > > >
> > > > THK
> > > >
> > > > On 4/4/07, White.Denis at epamail.epa.gov
> <White.Denis at epamail.epa.gov>
> > > wrote:
> > > > > Tim,
> > > > >
> > > > > It depends on which kind of distortion is of most concern.  For
> many
> > > > > types of extensive data, especially counts, for example, the
> equal
> > > area
> > > > > property is desirable.  We used the Lambert cylindrical equal
> area
> > > > > projection with standard parallels of +/- 30 degrees for some
> > > western
> > > > > hemispherical work, see reference below.  (The center longitude
> > > could be
> > > > > -80 west, but that is less important than the choice of
> parallels.)
> > > > >
> > > > > Before falling back on the Lambert as an easy to use projection,
> I
> > > tried
> > > > > to get several ESRI products to implement an interrupted
> projection
> > > > > using the sinusoidal projection, in part for reasons given in
> the
> > > second
> > > > > reference.  I used a separate center longitude for north and
> south
> > > of
> > > > > the equator and the appearance is certainly more satisfactory
> than
> > > the
> > > > > Lambert in my opinion.  I'll attach a PDF of an illustration of
> this
> > > > > approach generated in R that I hope you will get but not the
> rest of
> > > the
> > > > > list unfortunately.  I can send PDFs of the references also if
> > > needed.
> > > > >
> > > > > Denis
> > > > >
> > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.  Predicting
> > > > > climate-induced range shifts: model differences and model
> > > reliability.
> > > > > Global Change Biology 12:1568-1584.
> > > > >
> > > > > White D.  2006.  Display of pixel loss and replication in
> > > reprojecting
> > > > > raster data from the sinusoidal projection.  Geocarto
> International
> > > > > 21(2):19-22.
> > > > >
> > > > > (See attached file: whemi.sinus.pdf)
> > > > >
> > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04
> 12:17:39:
> > > > >
> > > > > > Anyone know of a particularly good map projection for showing
> all
> > > of
> > > > > > North and South America without too much distortion?
> > > > > >
> > > > > > THK
> > > > > >
> > > > > > --
> > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School
> of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From temiz at deprem.gov.tr  Mon Apr  9 16:40:19 2007
From: temiz at deprem.gov.tr (temiz)
Date: Mon, 09 Apr 2007 10:40:19 -0400
Subject: [R-sig-Geo] variogram interpretation
Message-ID: <461A5053.7040304@deprem.gov.tr>

hello

I want to learn about how I  can interpret a variogram and its values 
(sill, nugget, etc)

can you supply me any links and addresses in which these subjects are 
explained ?

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From temiz at deprem.gov.tr  Mon Apr  9 21:48:33 2007
From: temiz at deprem.gov.tr (temiz)
Date: Mon, 09 Apr 2007 15:48:33 -0400
Subject: [R-sig-Geo] levelplot gives an error
Message-ID: <461A9891.5030903@deprem.gov.tr>

hello

why does levelplot function give an error

OK_pred <- krige(z~1,el4, newdata=mask_SG, model=efitted)
levelplot(var1.pred ~ x + y , OK_pred , aspect = mapasp(OK_pred), main = 
"ordinary kriging predictions")
Error in eval(expr, envir, enclos) : invalid 'envir' argument

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From White.Denis at epamail.epa.gov  Mon Apr  9 18:00:35 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Mon, 9 Apr 2007 09:00:35 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <6262c54c0704080756w2faeabc0j3f8e2dd557afb0dc@mail.gmail.com>
Message-ID: <OFA6AFDD2C.69FA38F9-ON882572B8.005732CC-882572B8.0057F387@epamail.epa.gov>

For preview graphics and for large areas such as continents, large
countries, hemispheres, or the whole earth, spherical projections are
often adequate.  I can provide some of the ones I have used.  For
detailed work at sites and small areas, ellipsoidal projections such as
UTM are usually used, and then the coding gets more complicated with
choices of datums and so forth.

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08 07:56:03:

> Denis,
>
> That's really useful. It occurs to me that we only really need a
> half-dozen basic projections to cover 90% of user cases. Perhaps these
> could be incorporated into the 'sp' group somewhere and relieve the
> dependence on proj4. (It could be packaged separately for R  for the
> other 10% of cases where its needed.)
>
> THK
>
> On 4/6/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov>
wrote:
> > Thanks, Roger.  There was a request to see the R code for these
figures.
> > Attached is the script for the second PDF file plus the input
boundary
> > file I used for the hemisphere.  The three projection functions are
for
> > simple spherical, rather than ellipsoidal, models of the earth.  The
> > graticule generating function could be more elegant.  I'm not yet up
to
> > speed with sp and the many new spatial capabilities in R so please
> > excuse the old style "lines()" format encoding and graphics.
> >
> > Tim, I don't know whether proj4 could do the interrupted sinusoidal.
> >
> > (See attached file: whemi.projs.r)(See attached file: whemi.lin)
> >
> > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06 04:51:53:
> >
> > > Since this topic is of general interest, I've made an exception
and
> > > allowed (this once!) a posting of more than 200K. In general, if
> > graphics
> > > are big, please consider either an alternative device (png is
often
> > OK),
> > > or posting just a URL to the real file.
> > >
> > > With apologies to list members on dial-up connections in the
field,
> > >
> > > Roger
> > >
> > >
> > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > >
> > > > Yes, for many uses that is my choice also.  For the conterminous
US
> > for
> > > > example, the Lambert azimuthal has lower mean distortion than
the
> > > > commonly used standard projection, the Albers conical equal
area,
> > > > although Albers was chosen by USGS as a standard because of
lower
> > > > extreme distortion than many other possible projections.
> > > >
> > > > For our hemispherical application, because we were gridding the
> > data, we
> > > > wanted parallels of latitude to be parallel in the projected
> > coordinate
> > > > space, which we wouldn't get with the Lambert azimuthal.
> > > >
> > > > (See attached file: whemi.projs.pdf)
> > > >
> > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > > >
> > > > > Thanks. My application is not that demanding. Really, I just
want
> > it
> > > > > to look reasonable. My plan is to lay out the postings in the
> > > > > projected coordinates and then back transform into geographic
> > > > > coordinates for analysis. I tried lots of projections and
found
> > > > > Lamberts Azimuthal Equal Area to be quite good. I like the
look of
> > the
> > > > > Azimuthal Equidistant better, but figured equal area was a
good
> > > > > choice.
> > > > >
> > > > > THK
> > > > >
> > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > <White.Denis at epamail.epa.gov>
> > > > wrote:
> > > > > > Tim,
> > > > > >
> > > > > > It depends on which kind of distortion is of most concern.
For
> > many
> > > > > > types of extensive data, especially counts, for example, the
> > equal
> > > > area
> > > > > > property is desirable.  We used the Lambert cylindrical
equal
> > area
> > > > > > projection with standard parallels of +/- 30 degrees for
some
> > > > western
> > > > > > hemispherical work, see reference below.  (The center
longitude
> > > > could be
> > > > > > -80 west, but that is less important than the choice of
> > parallels.)
> > > > > >
> > > > > > Before falling back on the Lambert as an easy to use
projection,
> > I
> > > > tried
> > > > > > to get several ESRI products to implement an interrupted
> > projection
> > > > > > using the sinusoidal projection, in part for reasons given
in
> > the
> > > > second
> > > > > > reference.  I used a separate center longitude for north and
> > south
> > > > of
> > > > > > the equator and the appearance is certainly more
satisfactory
> > than
> > > > the
> > > > > > Lambert in my opinion.  I'll attach a PDF of an illustration
of
> > this
> > > > > > approach generated in R that I hope you will get but not the
> > rest of
> > > > the
> > > > > > list unfortunately.  I can send PDFs of the references also
if
> > > > needed.
> > > > > >
> > > > > > Denis
> > > > > >
> > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.
Predicting
> > > > > > climate-induced range shifts: model differences and model
> > > > reliability.
> > > > > > Global Change Biology 12:1568-1584.
> > > > > >
> > > > > > White D.  2006.  Display of pixel loss and replication in
> > > > reprojecting
> > > > > > raster data from the sinusoidal projection.  Geocarto
> > International
> > > > > > 21(2):19-22.
> > > > > >
> > > > > > (See attached file: whemi.sinus.pdf)
> > > > > >
> > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04
> > 12:17:39:
> > > > > >
> > > > > > > Anyone know of a particularly good map projection for
showing
> > all
> > > > of
> > > > > > > North and South America without too much distortion?
> > > > > > >
> > > > > > > THK
> > > > > > >
> > > > > > > --
> > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > Contact info and schedule at
http://www.keittlab.org/tkeitt/
> > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > >
> > > > > > > _______________________________________________
> > > > > > > R-sig-Geo mailing list
> > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > >
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian
School
> > of
> > > Economics and Business Administration, Helleveien 30, N-5045
Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From e.pebesma at geo.uu.nl  Mon Apr  9 21:23:05 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Mon, 09 Apr 2007 21:23:05 +0200
Subject: [R-sig-Geo] levelplot gives an error
In-Reply-To: <461A9891.5030903@deprem.gov.tr>
References: <461A9891.5030903@deprem.gov.tr>
Message-ID: <461A9299.4000002@geo.uu.nl>

perhaps use

spplot(OK_pred[1], ...)

which would be more or less short for

levelplot(var1.pred~x+y, as.data.frame(OK_pred), aspect = "iso", ...)
--
Edzer


temiz wrote:

>hello
>
>why does levelplot function give an error
>
>OK_pred <- krige(z~1,el4, newdata=mask_SG, model=efitted)
>levelplot(var1.pred ~ x + y , OK_pred , aspect = mapasp(OK_pred), main = 
>"ordinary kriging predictions")
>Error in eval(expr, envir, enclos) : invalid 'envir' argument
>
>regards
>
>  
>



From Roger.Bivand at nhh.no  Mon Apr  9 22:28:49 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 9 Apr 2007 22:28:49 +0200 (CEST)
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OFA6AFDD2C.69FA38F9-ON882572B8.005732CC-882572B8.0057F387@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0704092158470.1661-200001@reclus.nhh.no>

On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:

> For preview graphics and for large areas such as continents, large
> countries, hemispheres, or the whole earth, spherical projections are
> often adequate.  I can provide some of the ones I have used.  For
> detailed work at sites and small areas, ellipsoidal projections such as
> UTM are usually used, and then the coding gets more complicated with
> choices of datums and so forth.
> 

The attached script shows how to do the interrupted sinusoidal projection 
using spTransform in rgdal, for the whemi.lin data posted with the 
free-standing functions by Denis White a couple of days ago. Once the 
lines are converted into SpatialLines objects, the rest is robust and 
simple, as is the use of gridlines() in sp. The one catch is calculating 
the offset, here in an x_0= offset along the Equator in metres between the 
two central longitude values. The output is attached as a PNG image. The 
point about the sp objects is that they contain enough metadata (here a 
PROJ.4 projection description) to let them be moved to other R packages or 
external software. 

The half-dozen basic projections are easy to specify in PROJ.4, for 
example from the geotiff list:

http://www.remotesensing.org/geotiff/proj_list/

which is what I used here. The other projections mentioned are:

Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"

Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"

while the Northern hemisphere sinusoidal is:

Sinusoidal "+proj=sinu +lon_0=-100"

So I'd argue that PROJ.4 projection descriptions are not difficult to use, 
and with sp objects, do stay stuck to the data (has anyone else ever 
forgotten what projection was used when revisiting data, not just me?).

Using the maptools map2SpatialLines() interface function, or the Rgshhs() 
interface to GSHHS shorelines, even getting the lines is quite easy, 
qualified by clipping and bounding box issues in extremities for 
projection from geographical coordinates.

Of course, it would help to have MacOS X and selected Linux binaries of 
rgdal, we're very lucky that Uwe Ligges is so helpful with the Windows 
binaries.

Roger

> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08 07:56:03:
> 
> > Denis,
> >
> > That's really useful. It occurs to me that we only really need a
> > half-dozen basic projections to cover 90% of user cases. Perhaps these
> > could be incorporated into the 'sp' group somewhere and relieve the
> > dependence on proj4. (It could be packaged separately for R  for the
> > other 10% of cases where its needed.)
> >
> > THK
> >
> > On 4/6/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov>
> wrote:
> > > Thanks, Roger.  There was a request to see the R code for these
> figures.
> > > Attached is the script for the second PDF file plus the input
> boundary
> > > file I used for the hemisphere.  The three projection functions are
> for
> > > simple spherical, rather than ellipsoidal, models of the earth.  The
> > > graticule generating function could be more elegant.  I'm not yet up
> to
> > > speed with sp and the many new spatial capabilities in R so please
> > > excuse the old style "lines()" format encoding and graphics.
> > >
> > > Tim, I don't know whether proj4 could do the interrupted sinusoidal.
> > >
> > > (See attached file: whemi.projs.r)(See attached file: whemi.lin)
> > >
> > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06 04:51:53:
> > >
> > > > Since this topic is of general interest, I've made an exception
> and
> > > > allowed (this once!) a posting of more than 200K. In general, if
> > > graphics
> > > > are big, please consider either an alternative device (png is
> often
> > > OK),
> > > > or posting just a URL to the real file.
> > > >
> > > > With apologies to list members on dial-up connections in the
> field,
> > > >
> > > > Roger
> > > >
> > > >
> > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > >
> > > > > Yes, for many uses that is my choice also.  For the conterminous
> US
> > > for
> > > > > example, the Lambert azimuthal has lower mean distortion than
> the
> > > > > commonly used standard projection, the Albers conical equal
> area,
> > > > > although Albers was chosen by USGS as a standard because of
> lower
> > > > > extreme distortion than many other possible projections.
> > > > >
> > > > > For our hemispherical application, because we were gridding the
> > > data, we
> > > > > wanted parallels of latitude to be parallel in the projected
> > > coordinate
> > > > > space, which we wouldn't get with the Lambert azimuthal.
> > > > >
> > > > > (See attached file: whemi.projs.pdf)
> > > > >
> > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > > > >
> > > > > > Thanks. My application is not that demanding. Really, I just
> want
> > > it
> > > > > > to look reasonable. My plan is to lay out the postings in the
> > > > > > projected coordinates and then back transform into geographic
> > > > > > coordinates for analysis. I tried lots of projections and
> found
> > > > > > Lamberts Azimuthal Equal Area to be quite good. I like the
> look of
> > > the
> > > > > > Azimuthal Equidistant better, but figured equal area was a
> good
> > > > > > choice.
> > > > > >
> > > > > > THK
> > > > > >
> > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > <White.Denis at epamail.epa.gov>
> > > > > wrote:
> > > > > > > Tim,
> > > > > > >
> > > > > > > It depends on which kind of distortion is of most concern.
> For
> > > many
> > > > > > > types of extensive data, especially counts, for example, the
> > > equal
> > > > > area
> > > > > > > property is desirable.  We used the Lambert cylindrical
> equal
> > > area
> > > > > > > projection with standard parallels of +/- 30 degrees for
> some
> > > > > western
> > > > > > > hemispherical work, see reference below.  (The center
> longitude
> > > > > could be
> > > > > > > -80 west, but that is less important than the choice of
> > > parallels.)
> > > > > > >
> > > > > > > Before falling back on the Lambert as an easy to use
> projection,
> > > I
> > > > > tried
> > > > > > > to get several ESRI products to implement an interrupted
> > > projection
> > > > > > > using the sinusoidal projection, in part for reasons given
> in
> > > the
> > > > > second
> > > > > > > reference.  I used a separate center longitude for north and
> > > south
> > > > > of
> > > > > > > the equator and the appearance is certainly more
> satisfactory
> > > than
> > > > > the
> > > > > > > Lambert in my opinion.  I'll attach a PDF of an illustration
> of
> > > this
> > > > > > > approach generated in R that I hope you will get but not the
> > > rest of
> > > > > the
> > > > > > > list unfortunately.  I can send PDFs of the references also
> if
> > > > > needed.
> > > > > > >
> > > > > > > Denis
> > > > > > >
> > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.
> Predicting
> > > > > > > climate-induced range shifts: model differences and model
> > > > > reliability.
> > > > > > > Global Change Biology 12:1568-1584.
> > > > > > >
> > > > > > > White D.  2006.  Display of pixel loss and replication in
> > > > > reprojecting
> > > > > > > raster data from the sinusoidal projection.  Geocarto
> > > International
> > > > > > > 21(2):19-22.
> > > > > > >
> > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > >
> > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04
> > > 12:17:39:
> > > > > > >
> > > > > > > > Anyone know of a particularly good map projection for
> showing
> > > all
> > > > > of
> > > > > > > > North and South America without too much distortion?
> > > > > > > >
> > > > > > > > THK
> > > > > > > >
> > > > > > > > --
> > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > Contact info and schedule at
> http://www.keittlab.org/tkeitt/
> > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > >
> > > > > > > > _______________________________________________
> > > > > > > > R-sig-Geo mailing list
> > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > >
> > > > > >
> > > > > >
> > > > > > --
> > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > ODF attachment? See http://www.openoffice.org/
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics, Norwegian
> School
> > > of
> > > > Economics and Business Administration, Helleveien 30, N-5045
> Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

-------------- next part --------------
whemi <- read.table ("whemi.lin", header=TRUE)
# make the input object into two lists of lines split at Equator
whemiNA <- is.na(whemi$x) | is.na(whemi$y)
whemiCS <- cumsum(whemiNA)
whemi1 <- cbind(whemi, whemiCS)
whemi2 <- whemi1[!whemiNA,]
whemiL <- split(whemi2, whemi2$whemiCS)
whemiL_NS <- sapply(whemiL, function(x) { r <- range(x$y) ;
    (r[1] >= 0 && r[2] <= 0) || (r[1] <= 0 && r[2] >=0) })
whemiL1 <- whemiL[!whemiL_NS]
whemiL2 <- whemiL[whemiL_NS]
whemiL2a <- vector(mode="list", length=length(whemiL2)*2)
ii <- 1
for (i in seq(along=whemiL2)) {
    cy <- which(whemiL2[[i]]$y == 0.0)
    n <- length(whemiL2[[i]]$y)
    whemiL2a[[ii]] <- whemiL2[[i]][1:cy,]
    ii <- ii+1
    whemiL2a[[ii]] <- whemiL2[[i]][cy:n,]
    ii <- ii+1
}
whemiL3 <- c(whemiL1, whemiL2a)
whemiNorth <- sapply(whemiL3, function(x) any(x$y > 0))
whemiN <- whemiL3[whemiNorth]
whemiS <- whemiL3[!whemiNorth]
# convert N and S line lists into SpatialLines objects
library(sp)
whemiNLs <- lapply(whemiN, function(x) Lines(list(Line(cbind(x$x, x$y))),
    ID=as.character(x$whemiCS[1])))
whemiSLs <- lapply(whemiS, function(x) Lines(list(Line(cbind(x$x, x$y))),
    ID=as.character(x$whemiCS[1])))
whemiN_SL <- SpatialLines(whemiNLs,
    proj4string=CRS("+proj=longlat +datum=WGS84"))
whemiS_SL <- SpatialLines(whemiSLs,
    proj4string=CRS("+proj=longlat +datum=WGS84"))
# add grids as SpatialLines objects
grdN <- gridlines(whemiN_SL, easts=seq(-170,-30,10), norths=seq(0,80,10),
    ndiscr=500)
grdS <- gridlines(whemiS_SL, easts=seq(-170,-30,10), norths=seq(-50,0,10),
    ndiscr=500)
library(rgdal)
# compute offset for interrupted sinusoidal projection
onept <- matrix(c(-80,0), nrow=1)
oneSP <- SpatialPoints(onept, proj4string=CRS("+proj=longlat +datum=WGS84"))
oneSPN <- spTransform(oneSP, CRS("+proj=sinu +lon_0=-100"))
oneSPS <- spTransform(oneSP, CRS("+proj=sinu +lon_0=-60"))
offset <- coordinates(oneSPN)[,1] - coordinates(oneSPS)[,1]
# project south SpatialLines objects with offset
grdS.sinus <- spTransform(grdS, CRS(paste("+proj=sinu +lon_0=-60 +x_0=",
    offset, sep="")))
whemiS.sinus <- spTransform(whemiS_SL,
    CRS(paste("+proj=sinu +lon_0=-60 +x_0=", offset, sep="")))
# and north SpatialLines objects without
grdN.sinus <- spTransform(grdN, CRS("+proj=sinu +lon_0=-100"))
whemiN.sinus <- spTransform(whemiN_SL, CRS("+proj=sinu +lon_0=-100"))
# assemble the joint bounding box
bb_all <- t(apply(cbind(bbox(whemiS.sinus), bbox(whemiN.sinus)), 1, range))
plot(whemiN.sinus, xlim=bb_all[1,], ylim=bb_all[2,])
plot(whemiS.sinus, add=TRUE)
plot(grdS.sinus, add=TRUE, col="red", lty=2)
plot(grdN.sinus, add=TRUE, col="red", lty=2)


-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.png
Type: image/png
Size: 7708 bytes
Desc: 
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070409/70e46ad2/attachment.png>

From tkeitt at gmail.com  Mon Apr  9 22:36:27 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Mon, 9 Apr 2007 15:36:27 -0500
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <Pine.LNX.4.44.0704092158470.1661-200001@reclus.nhh.no>
References: <OFA6AFDD2C.69FA38F9-ON882572B8.005732CC-882572B8.0057F387@epamail.epa.gov>
	<Pine.LNX.4.44.0704092158470.1661-200001@reclus.nhh.no>
Message-ID: <6262c54c0704091336i71887254j527caa206bf8eccb@mail.gmail.com>

On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
>
> > For preview graphics and for large areas such as continents, large
> > countries, hemispheres, or the whole earth, spherical projections are
> > often adequate.  I can provide some of the ones I have used.  For
> > detailed work at sites and small areas, ellipsoidal projections such as
> > UTM are usually used, and then the coding gets more complicated with
> > choices of datums and so forth.
> >
>
> The attached script shows how to do the interrupted sinusoidal projection
> using spTransform in rgdal, for the whemi.lin data posted with the
> free-standing functions by Denis White a couple of days ago. Once the
> lines are converted into SpatialLines objects, the rest is robust and
> simple, as is the use of gridlines() in sp. The one catch is calculating
> the offset, here in an x_0= offset along the Equator in metres between the
> two central longitude values. The output is attached as a PNG image. The
> point about the sp objects is that they contain enough metadata (here a
> PROJ.4 projection description) to let them be moved to other R packages or
> external software.
>
> The half-dozen basic projections are easy to specify in PROJ.4, for
> example from the geotiff list:
>
> http://www.remotesensing.org/geotiff/proj_list/
>
> which is what I used here. The other projections mentioned are:
>
> Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
>
> Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
>
> while the Northern hemisphere sinusoidal is:
>
> Sinusoidal "+proj=sinu +lon_0=-100"
>
> So I'd argue that PROJ.4 projection descriptions are not difficult to use,
> and with sp objects, do stay stuck to the data (has anyone else ever
> forgotten what projection was used when revisiting data, not just me?).

Yes, that's brilliant (keeping the proj4string). My point was not that
proj is hard to use -- its simple -- rather that depending on proj
means more build time dependencies. On the other hand, if its not
broke....

THK

-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From tkeitt at gmail.com  Mon Apr  9 22:38:33 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Mon, 9 Apr 2007 15:38:33 -0500
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <Pine.LNX.4.44.0704092158470.1661-200001@reclus.nhh.no>
References: <OFA6AFDD2C.69FA38F9-ON882572B8.005732CC-882572B8.0057F387@epamail.epa.gov>
	<Pine.LNX.4.44.0704092158470.1661-200001@reclus.nhh.no>
Message-ID: <6262c54c0704091338y71de35d6m5145649113fe87a6@mail.gmail.com>

Canada looks pinched in this projection. S. Am is perfect.

THK

On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
>
> > For preview graphics and for large areas such as continents, large
> > countries, hemispheres, or the whole earth, spherical projections are
> > often adequate.  I can provide some of the ones I have used.  For
> > detailed work at sites and small areas, ellipsoidal projections such as
> > UTM are usually used, and then the coding gets more complicated with
> > choices of datums and so forth.
> >
>
> The attached script shows how to do the interrupted sinusoidal projection
> using spTransform in rgdal, for the whemi.lin data posted with the
> free-standing functions by Denis White a couple of days ago. Once the
> lines are converted into SpatialLines objects, the rest is robust and
> simple, as is the use of gridlines() in sp. The one catch is calculating
> the offset, here in an x_0= offset along the Equator in metres between the
> two central longitude values. The output is attached as a PNG image. The
> point about the sp objects is that they contain enough metadata (here a
> PROJ.4 projection description) to let them be moved to other R packages or
> external software.
>
> The half-dozen basic projections are easy to specify in PROJ.4, for
> example from the geotiff list:
>
> http://www.remotesensing.org/geotiff/proj_list/
>
> which is what I used here. The other projections mentioned are:
>
> Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
>
> Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
>
> while the Northern hemisphere sinusoidal is:
>
> Sinusoidal "+proj=sinu +lon_0=-100"
>
> So I'd argue that PROJ.4 projection descriptions are not difficult to use,
> and with sp objects, do stay stuck to the data (has anyone else ever
> forgotten what projection was used when revisiting data, not just me?).
>
> Using the maptools map2SpatialLines() interface function, or the Rgshhs()
> interface to GSHHS shorelines, even getting the lines is quite easy,
> qualified by clipping and bounding box issues in extremities for
> projection from geographical coordinates.
>
> Of course, it would help to have MacOS X and selected Linux binaries of
> rgdal, we're very lucky that Uwe Ligges is so helpful with the Windows
> binaries.
>
> Roger
>
> > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08 07:56:03:
> >
> > > Denis,
> > >
> > > That's really useful. It occurs to me that we only really need a
> > > half-dozen basic projections to cover 90% of user cases. Perhaps these
> > > could be incorporated into the 'sp' group somewhere and relieve the
> > > dependence on proj4. (It could be packaged separately for R  for the
> > > other 10% of cases where its needed.)
> > >
> > > THK
> > >
> > > On 4/6/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov>
> > wrote:
> > > > Thanks, Roger.  There was a request to see the R code for these
> > figures.
> > > > Attached is the script for the second PDF file plus the input
> > boundary
> > > > file I used for the hemisphere.  The three projection functions are
> > for
> > > > simple spherical, rather than ellipsoidal, models of the earth.  The
> > > > graticule generating function could be more elegant.  I'm not yet up
> > to
> > > > speed with sp and the many new spatial capabilities in R so please
> > > > excuse the old style "lines()" format encoding and graphics.
> > > >
> > > > Tim, I don't know whether proj4 could do the interrupted sinusoidal.
> > > >
> > > > (See attached file: whemi.projs.r)(See attached file: whemi.lin)
> > > >
> > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06 04:51:53:
> > > >
> > > > > Since this topic is of general interest, I've made an exception
> > and
> > > > > allowed (this once!) a posting of more than 200K. In general, if
> > > > graphics
> > > > > are big, please consider either an alternative device (png is
> > often
> > > > OK),
> > > > > or posting just a URL to the real file.
> > > > >
> > > > > With apologies to list members on dial-up connections in the
> > field,
> > > > >
> > > > > Roger
> > > > >
> > > > >
> > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > >
> > > > > > Yes, for many uses that is my choice also.  For the conterminous
> > US
> > > > for
> > > > > > example, the Lambert azimuthal has lower mean distortion than
> > the
> > > > > > commonly used standard projection, the Albers conical equal
> > area,
> > > > > > although Albers was chosen by USGS as a standard because of
> > lower
> > > > > > extreme distortion than many other possible projections.
> > > > > >
> > > > > > For our hemispherical application, because we were gridding the
> > > > data, we
> > > > > > wanted parallels of latitude to be parallel in the projected
> > > > coordinate
> > > > > > space, which we wouldn't get with the Lambert azimuthal.
> > > > > >
> > > > > > (See attached file: whemi.projs.pdf)
> > > > > >
> > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > > > > >
> > > > > > > Thanks. My application is not that demanding. Really, I just
> > want
> > > > it
> > > > > > > to look reasonable. My plan is to lay out the postings in the
> > > > > > > projected coordinates and then back transform into geographic
> > > > > > > coordinates for analysis. I tried lots of projections and
> > found
> > > > > > > Lamberts Azimuthal Equal Area to be quite good. I like the
> > look of
> > > > the
> > > > > > > Azimuthal Equidistant better, but figured equal area was a
> > good
> > > > > > > choice.
> > > > > > >
> > > > > > > THK
> > > > > > >
> > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > <White.Denis at epamail.epa.gov>
> > > > > > wrote:
> > > > > > > > Tim,
> > > > > > > >
> > > > > > > > It depends on which kind of distortion is of most concern.
> > For
> > > > many
> > > > > > > > types of extensive data, especially counts, for example, the
> > > > equal
> > > > > > area
> > > > > > > > property is desirable.  We used the Lambert cylindrical
> > equal
> > > > area
> > > > > > > > projection with standard parallels of +/- 30 degrees for
> > some
> > > > > > western
> > > > > > > > hemispherical work, see reference below.  (The center
> > longitude
> > > > > > could be
> > > > > > > > -80 west, but that is less important than the choice of
> > > > parallels.)
> > > > > > > >
> > > > > > > > Before falling back on the Lambert as an easy to use
> > projection,
> > > > I
> > > > > > tried
> > > > > > > > to get several ESRI products to implement an interrupted
> > > > projection
> > > > > > > > using the sinusoidal projection, in part for reasons given
> > in
> > > > the
> > > > > > second
> > > > > > > > reference.  I used a separate center longitude for north and
> > > > south
> > > > > > of
> > > > > > > > the equator and the appearance is certainly more
> > satisfactory
> > > > than
> > > > > > the
> > > > > > > > Lambert in my opinion.  I'll attach a PDF of an illustration
> > of
> > > > this
> > > > > > > > approach generated in R that I hope you will get but not the
> > > > rest of
> > > > > > the
> > > > > > > > list unfortunately.  I can send PDFs of the references also
> > if
> > > > > > needed.
> > > > > > > >
> > > > > > > > Denis
> > > > > > > >
> > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.
> > Predicting
> > > > > > > > climate-induced range shifts: model differences and model
> > > > > > reliability.
> > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > >
> > > > > > > > White D.  2006.  Display of pixel loss and replication in
> > > > > > reprojecting
> > > > > > > > raster data from the sinusoidal projection.  Geocarto
> > > > International
> > > > > > > > 21(2):19-22.
> > > > > > > >
> > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > >
> > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-04
> > > > 12:17:39:
> > > > > > > >
> > > > > > > > > Anyone know of a particularly good map projection for
> > showing
> > > > all
> > > > > > of
> > > > > > > > > North and South America without too much distortion?
> > > > > > > > >
> > > > > > > > > THK
> > > > > > > > >
> > > > > > > > > --
> > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > Contact info and schedule at
> > http://www.keittlab.org/tkeitt/
> > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > >
> > > > > > > > > _______________________________________________
> > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > >
> > > > > > >
> > > > > > >
> > > > > > > --
> > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > > --
> > > > > Roger Bivand
> > > > > Economic Geography Section, Department of Economics, Norwegian
> > School
> > > > of
> > > > > Economics and Business Administration, Helleveien 30, N-5045
> > Bergen,
> > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > e-mail: Roger.Bivand at nhh.no
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From White.Denis at epamail.epa.gov  Mon Apr  9 22:47:43 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Mon, 9 Apr 2007 13:47:43 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <6262c54c0704091338y71de35d6m5145649113fe87a6@mail.gmail.com>
Message-ID: <OF3F47B9FD.BD236397-ON882572B8.0071BE00-882572B8.00723BA1@epamail.epa.gov>

Roger's solution makes sense to me.

The sinusoidal does have the appearance of pinching poleward, a
consequence of allocating equal area by spacing equally in both x and y.
Also the Lambert cylindrical sent in before should have had standard
parallels set to +/- 30, i.e.,

(See attached file: whemi.projs.png)

Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-09 13:38:33:

> Canada looks pinched in this projection. S. Am is perfect.
>
> THK
>
> On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> >
> > > For preview graphics and for large areas such as continents, large
> > > countries, hemispheres, or the whole earth, spherical projections
are
> > > often adequate.  I can provide some of the ones I have used.  For
> > > detailed work at sites and small areas, ellipsoidal projections
such as
> > > UTM are usually used, and then the coding gets more complicated
with
> > > choices of datums and so forth.
> > >
> >
> > The attached script shows how to do the interrupted sinusoidal
projection
> > using spTransform in rgdal, for the whemi.lin data posted with the
> > free-standing functions by Denis White a couple of days ago. Once
the
> > lines are converted into SpatialLines objects, the rest is robust
and
> > simple, as is the use of gridlines() in sp. The one catch is
calculating
> > the offset, here in an x_0= offset along the Equator in metres
between the
> > two central longitude values. The output is attached as a PNG image.
The
> > point about the sp objects is that they contain enough metadata
(here a
> > PROJ.4 projection description) to let them be moved to other R
packages or
> > external software.
> >
> > The half-dozen basic projections are easy to specify in PROJ.4, for
> > example from the geotiff list:
> >
> > http://www.remotesensing.org/geotiff/proj_list/
> >
> > which is what I used here. The other projections mentioned are:
> >
> > Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
> >
> > Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
> >
> > while the Northern hemisphere sinusoidal is:
> >
> > Sinusoidal "+proj=sinu +lon_0=-100"
> >
> > So I'd argue that PROJ.4 projection descriptions are not difficult
to use,
> > and with sp objects, do stay stuck to the data (has anyone else ever
> > forgotten what projection was used when revisiting data, not just
me?).
> >
> > Using the maptools map2SpatialLines() interface function, or the
Rgshhs()
> > interface to GSHHS shorelines, even getting the lines is quite easy,
> > qualified by clipping and bounding box issues in extremities for
> > projection from geographical coordinates.
> >
> > Of course, it would help to have MacOS X and selected Linux binaries
of
> > rgdal, we're very lucky that Uwe Ligges is so helpful with the
Windows
> > binaries.
> >
> > Roger
> >
> > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08 07:56:03:
> > >
> > > > Denis,
> > > >
> > > > That's really useful. It occurs to me that we only really need a
> > > > half-dozen basic projections to cover 90% of user cases. Perhaps
these
> > > > could be incorporated into the 'sp' group somewhere and relieve
the
> > > > dependence on proj4. (It could be packaged separately for R  for
the
> > > > other 10% of cases where its needed.)
> > > >
> > > > THK
> > > >
> > > > On 4/6/07, White.Denis at epamail.epa.gov
<White.Denis at epamail.epa.gov>
> > > wrote:
> > > > > Thanks, Roger.  There was a request to see the R code for
these
> > > figures.
> > > > > Attached is the script for the second PDF file plus the input
> > > boundary
> > > > > file I used for the hemisphere.  The three projection
functions are
> > > for
> > > > > simple spherical, rather than ellipsoidal, models of the
earth.  The
> > > > > graticule generating function could be more elegant.  I'm not
yet up
> > > to
> > > > > speed with sp and the many new spatial capabilities in R so
please
> > > > > excuse the old style "lines()" format encoding and graphics.
> > > > >
> > > > > Tim, I don't know whether proj4 could do the interrupted
sinusoidal.
> > > > >
> > > > > (See attached file: whemi.projs.r)(See attached file:
whemi.lin)
> > > > >
> > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06
04:51:53:
> > > > >
> > > > > > Since this topic is of general interest, I've made an
exception
> > > and
> > > > > > allowed (this once!) a posting of more than 200K. In
general, if
> > > > > graphics
> > > > > > are big, please consider either an alternative device (png
is
> > > often
> > > > > OK),
> > > > > > or posting just a URL to the real file.
> > > > > >
> > > > > > With apologies to list members on dial-up connections in the
> > > field,
> > > > > >
> > > > > > Roger
> > > > > >
> > > > > >
> > > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > >
> > > > > > > Yes, for many uses that is my choice also.  For the
conterminous
> > > US
> > > > > for
> > > > > > > example, the Lambert azimuthal has lower mean distortion
than
> > > the
> > > > > > > commonly used standard projection, the Albers conical
equal
> > > area,
> > > > > > > although Albers was chosen by USGS as a standard because
of
> > > lower
> > > > > > > extreme distortion than many other possible projections.
> > > > > > >
> > > > > > > For our hemispherical application, because we were
gridding the
> > > > > data, we
> > > > > > > wanted parallels of latitude to be parallel in the
projected
> > > > > coordinate
> > > > > > > space, which we wouldn't get with the Lambert azimuthal.
> > > > > > >
> > > > > > > (See attached file: whemi.projs.pdf)
> > > > > > >
> > > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > > > > > >
> > > > > > > > Thanks. My application is not that demanding. Really, I
just
> > > want
> > > > > it
> > > > > > > > to look reasonable. My plan is to lay out the postings
in the
> > > > > > > > projected coordinates and then back transform into
geographic
> > > > > > > > coordinates for analysis. I tried lots of projections
and
> > > found
> > > > > > > > Lamberts Azimuthal Equal Area to be quite good. I like
the
> > > look of
> > > > > the
> > > > > > > > Azimuthal Equidistant better, but figured equal area was
a
> > > good
> > > > > > > > choice.
> > > > > > > >
> > > > > > > > THK
> > > > > > > >
> > > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > > <White.Denis at epamail.epa.gov>
> > > > > > > wrote:
> > > > > > > > > Tim,
> > > > > > > > >
> > > > > > > > > It depends on which kind of distortion is of most
concern.
> > > For
> > > > > many
> > > > > > > > > types of extensive data, especially counts, for
example, the
> > > > > equal
> > > > > > > area
> > > > > > > > > property is desirable.  We used the Lambert
cylindrical
> > > equal
> > > > > area
> > > > > > > > > projection with standard parallels of +/- 30 degrees
for
> > > some
> > > > > > > western
> > > > > > > > > hemispherical work, see reference below.  (The center
> > > longitude
> > > > > > > could be
> > > > > > > > > -80 west, but that is less important than the choice
of
> > > > > parallels.)
> > > > > > > > >
> > > > > > > > > Before falling back on the Lambert as an easy to use
> > > projection,
> > > > > I
> > > > > > > tried
> > > > > > > > > to get several ESRI products to implement an
interrupted
> > > > > projection
> > > > > > > > > using the sinusoidal projection, in part for reasons
given
> > > in
> > > > > the
> > > > > > > second
> > > > > > > > > reference.  I used a separate center longitude for
north and
> > > > > south
> > > > > > > of
> > > > > > > > > the equator and the appearance is certainly more
> > > satisfactory
> > > > > than
> > > > > > > the
> > > > > > > > > Lambert in my opinion.  I'll attach a PDF of an
illustration
> > > of
> > > > > this
> > > > > > > > > approach generated in R that I hope you will get but
not the
> > > > > rest of
> > > > > > > the
> > > > > > > > > list unfortunately.  I can send PDFs of the references
also
> > > if
> > > > > > > needed.
> > > > > > > > >
> > > > > > > > > Denis
> > > > > > > > >
> > > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.
> > > Predicting
> > > > > > > > > climate-induced range shifts: model differences and
model
> > > > > > > reliability.
> > > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > > >
> > > > > > > > > White D.  2006.  Display of pixel loss and replication
in
> > > > > > > reprojecting
> > > > > > > > > raster data from the sinusoidal projection.  Geocarto
> > > > > International
> > > > > > > > > 21(2):19-22.
> > > > > > > > >
> > > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > > >
> > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on
2007-04-04
> > > > > 12:17:39:
> > > > > > > > >
> > > > > > > > > > Anyone know of a particularly good map projection
for
> > > showing
> > > > > all
> > > > > > > of
> > > > > > > > > > North and South America without too much distortion?
> > > > > > > > > >
> > > > > > > > > > THK
> > > > > > > > > >
> > > > > > > > > > --
> > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > Contact info and schedule at
> > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > >
> > > > > > > > > > _______________________________________________
> > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > > --
> > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > Contact info and schedule at
http://www.keittlab.org/tkeitt/
> > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > >
> > > > > > --
> > > > > > Roger Bivand
> > > > > > Economic Geography Section, Department of Economics,
Norwegian
> > > School
> > > > > of
> > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > > Bergen,
> > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian
School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> >
>
>
> --
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi.projs.png
Type: image/png
Size: 12126 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070409/e8d0621f/attachment.png>

From Roger.Bivand at nhh.no  Mon Apr  9 22:52:45 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 9 Apr 2007 22:52:45 +0200 (CEST)
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OF3F47B9FD.BD236397-ON882572B8.0071BE00-882572B8.00723BA1@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0704092250090.1661-100000@reclus.nhh.no>

On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:

> Roger's solution makes sense to me.
> 
> The sinusoidal does have the appearance of pinching poleward, a
> consequence of allocating equal area by spacing equally in both x and y.

Both Canada and Norway - especially including Spitzbergen - suffer from 
this, but good compromises are hard to find if one needs Patagonia too. 

I can see that getting rgdal binaries for popular platforms is a real 
issue, any suggestions?

Roger

> Also the Lambert cylindrical sent in before should have had standard
> parallels set to +/- 30, i.e.,
> 
> (See attached file: whemi.projs.png)
> 
> Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-09 13:38:33:
> 
> > Canada looks pinched in this projection. S. Am is perfect.
> >
> > THK
> >
> > On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > >
> > > > For preview graphics and for large areas such as continents, large
> > > > countries, hemispheres, or the whole earth, spherical projections
> are
> > > > often adequate.  I can provide some of the ones I have used.  For
> > > > detailed work at sites and small areas, ellipsoidal projections
> such as
> > > > UTM are usually used, and then the coding gets more complicated
> with
> > > > choices of datums and so forth.
> > > >
> > >
> > > The attached script shows how to do the interrupted sinusoidal
> projection
> > > using spTransform in rgdal, for the whemi.lin data posted with the
> > > free-standing functions by Denis White a couple of days ago. Once
> the
> > > lines are converted into SpatialLines objects, the rest is robust
> and
> > > simple, as is the use of gridlines() in sp. The one catch is
> calculating
> > > the offset, here in an x_0= offset along the Equator in metres
> between the
> > > two central longitude values. The output is attached as a PNG image.
> The
> > > point about the sp objects is that they contain enough metadata
> (here a
> > > PROJ.4 projection description) to let them be moved to other R
> packages or
> > > external software.
> > >
> > > The half-dozen basic projections are easy to specify in PROJ.4, for
> > > example from the geotiff list:
> > >
> > > http://www.remotesensing.org/geotiff/proj_list/
> > >
> > > which is what I used here. The other projections mentioned are:
> > >
> > > Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
> > >
> > > Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
> > >
> > > while the Northern hemisphere sinusoidal is:
> > >
> > > Sinusoidal "+proj=sinu +lon_0=-100"
> > >
> > > So I'd argue that PROJ.4 projection descriptions are not difficult
> to use,
> > > and with sp objects, do stay stuck to the data (has anyone else ever
> > > forgotten what projection was used when revisiting data, not just
> me?).
> > >
> > > Using the maptools map2SpatialLines() interface function, or the
> Rgshhs()
> > > interface to GSHHS shorelines, even getting the lines is quite easy,
> > > qualified by clipping and bounding box issues in extremities for
> > > projection from geographical coordinates.
> > >
> > > Of course, it would help to have MacOS X and selected Linux binaries
> of
> > > rgdal, we're very lucky that Uwe Ligges is so helpful with the
> Windows
> > > binaries.
> > >
> > > Roger
> > >
> > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08 07:56:03:
> > > >
> > > > > Denis,
> > > > >
> > > > > That's really useful. It occurs to me that we only really need a
> > > > > half-dozen basic projections to cover 90% of user cases. Perhaps
> these
> > > > > could be incorporated into the 'sp' group somewhere and relieve
> the
> > > > > dependence on proj4. (It could be packaged separately for R  for
> the
> > > > > other 10% of cases where its needed.)
> > > > >
> > > > > THK
> > > > >
> > > > > On 4/6/07, White.Denis at epamail.epa.gov
> <White.Denis at epamail.epa.gov>
> > > > wrote:
> > > > > > Thanks, Roger.  There was a request to see the R code for
> these
> > > > figures.
> > > > > > Attached is the script for the second PDF file plus the input
> > > > boundary
> > > > > > file I used for the hemisphere.  The three projection
> functions are
> > > > for
> > > > > > simple spherical, rather than ellipsoidal, models of the
> earth.  The
> > > > > > graticule generating function could be more elegant.  I'm not
> yet up
> > > > to
> > > > > > speed with sp and the many new spatial capabilities in R so
> please
> > > > > > excuse the old style "lines()" format encoding and graphics.
> > > > > >
> > > > > > Tim, I don't know whether proj4 could do the interrupted
> sinusoidal.
> > > > > >
> > > > > > (See attached file: whemi.projs.r)(See attached file:
> whemi.lin)
> > > > > >
> > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06
> 04:51:53:
> > > > > >
> > > > > > > Since this topic is of general interest, I've made an
> exception
> > > > and
> > > > > > > allowed (this once!) a posting of more than 200K. In
> general, if
> > > > > > graphics
> > > > > > > are big, please consider either an alternative device (png
> is
> > > > often
> > > > > > OK),
> > > > > > > or posting just a URL to the real file.
> > > > > > >
> > > > > > > With apologies to list members on dial-up connections in the
> > > > field,
> > > > > > >
> > > > > > > Roger
> > > > > > >
> > > > > > >
> > > > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > > >
> > > > > > > > Yes, for many uses that is my choice also.  For the
> conterminous
> > > > US
> > > > > > for
> > > > > > > > example, the Lambert azimuthal has lower mean distortion
> than
> > > > the
> > > > > > > > commonly used standard projection, the Albers conical
> equal
> > > > area,
> > > > > > > > although Albers was chosen by USGS as a standard because
> of
> > > > lower
> > > > > > > > extreme distortion than many other possible projections.
> > > > > > > >
> > > > > > > > For our hemispherical application, because we were
> gridding the
> > > > > > data, we
> > > > > > > > wanted parallels of latitude to be parallel in the
> projected
> > > > > > coordinate
> > > > > > > > space, which we wouldn't get with the Lambert azimuthal.
> > > > > > > >
> > > > > > > > (See attached file: whemi.projs.pdf)
> > > > > > > >
> > > > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05 10:56:09:
> > > > > > > >
> > > > > > > > > Thanks. My application is not that demanding. Really, I
> just
> > > > want
> > > > > > it
> > > > > > > > > to look reasonable. My plan is to lay out the postings
> in the
> > > > > > > > > projected coordinates and then back transform into
> geographic
> > > > > > > > > coordinates for analysis. I tried lots of projections
> and
> > > > found
> > > > > > > > > Lamberts Azimuthal Equal Area to be quite good. I like
> the
> > > > look of
> > > > > > the
> > > > > > > > > Azimuthal Equidistant better, but figured equal area was
> a
> > > > good
> > > > > > > > > choice.
> > > > > > > > >
> > > > > > > > > THK
> > > > > > > > >
> > > > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > > > <White.Denis at epamail.epa.gov>
> > > > > > > > wrote:
> > > > > > > > > > Tim,
> > > > > > > > > >
> > > > > > > > > > It depends on which kind of distortion is of most
> concern.
> > > > For
> > > > > > many
> > > > > > > > > > types of extensive data, especially counts, for
> example, the
> > > > > > equal
> > > > > > > > area
> > > > > > > > > > property is desirable.  We used the Lambert
> cylindrical
> > > > equal
> > > > > > area
> > > > > > > > > > projection with standard parallels of +/- 30 degrees
> for
> > > > some
> > > > > > > > western
> > > > > > > > > > hemispherical work, see reference below.  (The center
> > > > longitude
> > > > > > > > could be
> > > > > > > > > > -80 west, but that is less important than the choice
> of
> > > > > > parallels.)
> > > > > > > > > >
> > > > > > > > > > Before falling back on the Lambert as an easy to use
> > > > projection,
> > > > > > I
> > > > > > > > tried
> > > > > > > > > > to get several ESRI products to implement an
> interrupted
> > > > > > projection
> > > > > > > > > > using the sinusoidal projection, in part for reasons
> given
> > > > in
> > > > > > the
> > > > > > > > second
> > > > > > > > > > reference.  I used a separate center longitude for
> north and
> > > > > > south
> > > > > > > > of
> > > > > > > > > > the equator and the appearance is certainly more
> > > > satisfactory
> > > > > > than
> > > > > > > > the
> > > > > > > > > > Lambert in my opinion.  I'll attach a PDF of an
> illustration
> > > > of
> > > > > > this
> > > > > > > > > > approach generated in R that I hope you will get but
> not the
> > > > > > rest of
> > > > > > > > the
> > > > > > > > > > list unfortunately.  I can send PDFs of the references
> also
> > > > if
> > > > > > > > needed.
> > > > > > > > > >
> > > > > > > > > > Denis
> > > > > > > > > >
> > > > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.  2006.
> > > > Predicting
> > > > > > > > > > climate-induced range shifts: model differences and
> model
> > > > > > > > reliability.
> > > > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > > > >
> > > > > > > > > > White D.  2006.  Display of pixel loss and replication
> in
> > > > > > > > reprojecting
> > > > > > > > > > raster data from the sinusoidal projection.  Geocarto
> > > > > > International
> > > > > > > > > > 21(2):19-22.
> > > > > > > > > >
> > > > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > > > >
> > > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on
> 2007-04-04
> > > > > > 12:17:39:
> > > > > > > > > >
> > > > > > > > > > > Anyone know of a particularly good map projection
> for
> > > > showing
> > > > > > all
> > > > > > > > of
> > > > > > > > > > > North and South America without too much distortion?
> > > > > > > > > > >
> > > > > > > > > > > THK
> > > > > > > > > > >
> > > > > > > > > > > --
> > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > Contact info and schedule at
> > > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > > >
> > > > > > > > > > > _______________________________________________
> > > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > > >
> > > > > > > > >
> > > > > > > > >
> > > > > > > > > --
> > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > Contact info and schedule at
> http://www.keittlab.org/tkeitt/
> > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > >
> > > > > > > --
> > > > > > > Roger Bivand
> > > > > > > Economic Geography Section, Department of Economics,
> Norwegian
> > > > School
> > > > > > of
> > > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > > > Bergen,
> > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > >
> > > > > > > _______________________________________________
> > > > > > > R-sig-Geo mailing list
> > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > >
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian
> School of
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > >
> > >
> >
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From White.Denis at epamail.epa.gov  Mon Apr  9 23:05:29 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Mon, 9 Apr 2007 14:05:29 -0700
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <Pine.LNX.4.44.0704092250090.1661-100000@reclus.nhh.no>
Message-ID: <OF0A444FC5.76D4A69B-ON882572B8.007302B6-882572B8.0073DBC2@epamail.epa.gov>

Roger Bivand <Roger.Bivand at nhh.no> wrote on 2007-04-09 13:52:45:

> On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
>
> > Roger's solution makes sense to me.
> >
> > The sinusoidal does have the appearance of pinching poleward, a
> > consequence of allocating equal area by spacing equally in both x
and y.
>
> Both Canada and Norway - especially including Spitzbergen - suffer
from
> this, but good compromises are hard to find if one needs Patagonia
too.

Goode's Homolosine is one.  USGS distributes (or did) some of their
global land cover data in that projection, see
http://landcover.usgs.gov/globallandcover.php.  Not only is it
interrupted, but it combines the sinusoidal from -40 to +40 and the
Mollweide poleward of +/- 40.  (I don't see it on the geotiff list.)

> I can see that getting rgdal binaries for popular platforms is a real
> issue, any suggestions?
>
> Roger
>
> > Also the Lambert cylindrical sent in before should have had standard
> > parallels set to +/- 30, i.e.,
> >
> > (See attached file: whemi.projs.png)
> >
> > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-09 13:38:33:
> >
> > > Canada looks pinched in this projection. S. Am is perfect.
> > >
> > > THK
> > >
> > > On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > >
> > > > > For preview graphics and for large areas such as continents,
large
> > > > > countries, hemispheres, or the whole earth, spherical
projections
> > are
> > > > > often adequate.  I can provide some of the ones I have used.
For
> > > > > detailed work at sites and small areas, ellipsoidal
projections
> > such as
> > > > > UTM are usually used, and then the coding gets more
complicated
> > with
> > > > > choices of datums and so forth.
> > > > >
> > > >
> > > > The attached script shows how to do the interrupted sinusoidal
> > projection
> > > > using spTransform in rgdal, for the whemi.lin data posted with
the
> > > > free-standing functions by Denis White a couple of days ago.
Once
> > the
> > > > lines are converted into SpatialLines objects, the rest is
robust
> > and
> > > > simple, as is the use of gridlines() in sp. The one catch is
> > calculating
> > > > the offset, here in an x_0= offset along the Equator in metres
> > between the
> > > > two central longitude values. The output is attached as a PNG
image.
> > The
> > > > point about the sp objects is that they contain enough metadata
> > (here a
> > > > PROJ.4 projection description) to let them be moved to other R
> > packages or
> > > > external software.
> > > >
> > > > The half-dozen basic projections are easy to specify in PROJ.4,
for
> > > > example from the geotiff list:
> > > >
> > > > http://www.remotesensing.org/geotiff/proj_list/
> > > >
> > > > which is what I used here. The other projections mentioned are:
> > > >
> > > > Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
> > > >
> > > > Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
> > > >
> > > > while the Northern hemisphere sinusoidal is:
> > > >
> > > > Sinusoidal "+proj=sinu +lon_0=-100"
> > > >
> > > > So I'd argue that PROJ.4 projection descriptions are not
difficult
> > to use,
> > > > and with sp objects, do stay stuck to the data (has anyone else
ever
> > > > forgotten what projection was used when revisiting data, not
just
> > me?).
> > > >
> > > > Using the maptools map2SpatialLines() interface function, or the
> > Rgshhs()
> > > > interface to GSHHS shorelines, even getting the lines is quite
easy,
> > > > qualified by clipping and bounding box issues in extremities for
> > > > projection from geographical coordinates.
> > > >
> > > > Of course, it would help to have MacOS X and selected Linux
binaries
> > of
> > > > rgdal, we're very lucky that Uwe Ligges is so helpful with the
> > Windows
> > > > binaries.
> > > >
> > > > Roger
> > > >
> > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08
07:56:03:
> > > > >
> > > > > > Denis,
> > > > > >
> > > > > > That's really useful. It occurs to me that we only really
need a
> > > > > > half-dozen basic projections to cover 90% of user cases.
Perhaps
> > these
> > > > > > could be incorporated into the 'sp' group somewhere and
relieve
> > the
> > > > > > dependence on proj4. (It could be packaged separately for R
for
> > the
> > > > > > other 10% of cases where its needed.)
> > > > > >
> > > > > > THK
> > > > > >
> > > > > > On 4/6/07, White.Denis at epamail.epa.gov
> > <White.Denis at epamail.epa.gov>
> > > > > wrote:
> > > > > > > Thanks, Roger.  There was a request to see the R code for
> > these
> > > > > figures.
> > > > > > > Attached is the script for the second PDF file plus the
input
> > > > > boundary
> > > > > > > file I used for the hemisphere.  The three projection
> > functions are
> > > > > for
> > > > > > > simple spherical, rather than ellipsoidal, models of the
> > earth.  The
> > > > > > > graticule generating function could be more elegant.  I'm
not
> > yet up
> > > > > to
> > > > > > > speed with sp and the many new spatial capabilities in R
so
> > please
> > > > > > > excuse the old style "lines()" format encoding and
graphics.
> > > > > > >
> > > > > > > Tim, I don't know whether proj4 could do the interrupted
> > sinusoidal.
> > > > > > >
> > > > > > > (See attached file: whemi.projs.r)(See attached file:
> > whemi.lin)
> > > > > > >
> > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06
> > 04:51:53:
> > > > > > >
> > > > > > > > Since this topic is of general interest, I've made an
> > exception
> > > > > and
> > > > > > > > allowed (this once!) a posting of more than 200K. In
> > general, if
> > > > > > > graphics
> > > > > > > > are big, please consider either an alternative device
(png
> > is
> > > > > often
> > > > > > > OK),
> > > > > > > > or posting just a URL to the real file.
> > > > > > > >
> > > > > > > > With apologies to list members on dial-up connections in
the
> > > > > field,
> > > > > > > >
> > > > > > > > Roger
> > > > > > > >
> > > > > > > >
> > > > > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > > > >
> > > > > > > > > Yes, for many uses that is my choice also.  For the
> > conterminous
> > > > > US
> > > > > > > for
> > > > > > > > > example, the Lambert azimuthal has lower mean
distortion
> > than
> > > > > the
> > > > > > > > > commonly used standard projection, the Albers conical
> > equal
> > > > > area,
> > > > > > > > > although Albers was chosen by USGS as a standard
because
> > of
> > > > > lower
> > > > > > > > > extreme distortion than many other possible
projections.
> > > > > > > > >
> > > > > > > > > For our hemispherical application, because we were
> > gridding the
> > > > > > > data, we
> > > > > > > > > wanted parallels of latitude to be parallel in the
> > projected
> > > > > > > coordinate
> > > > > > > > > space, which we wouldn't get with the Lambert
azimuthal.
> > > > > > > > >
> > > > > > > > > (See attached file: whemi.projs.pdf)
> > > > > > > > >
> > > > > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05
10:56:09:
> > > > > > > > >
> > > > > > > > > > Thanks. My application is not that demanding.
Really, I
> > just
> > > > > want
> > > > > > > it
> > > > > > > > > > to look reasonable. My plan is to lay out the
postings
> > in the
> > > > > > > > > > projected coordinates and then back transform into
> > geographic
> > > > > > > > > > coordinates for analysis. I tried lots of
projections
> > and
> > > > > found
> > > > > > > > > > Lamberts Azimuthal Equal Area to be quite good. I
like
> > the
> > > > > look of
> > > > > > > the
> > > > > > > > > > Azimuthal Equidistant better, but figured equal area
was
> > a
> > > > > good
> > > > > > > > > > choice.
> > > > > > > > > >
> > > > > > > > > > THK
> > > > > > > > > >
> > > > > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > > > > <White.Denis at epamail.epa.gov>
> > > > > > > > > wrote:
> > > > > > > > > > > Tim,
> > > > > > > > > > >
> > > > > > > > > > > It depends on which kind of distortion is of most
> > concern.
> > > > > For
> > > > > > > many
> > > > > > > > > > > types of extensive data, especially counts, for
> > example, the
> > > > > > > equal
> > > > > > > > > area
> > > > > > > > > > > property is desirable.  We used the Lambert
> > cylindrical
> > > > > equal
> > > > > > > area
> > > > > > > > > > > projection with standard parallels of +/- 30
degrees
> > for
> > > > > some
> > > > > > > > > western
> > > > > > > > > > > hemispherical work, see reference below.  (The
center
> > > > > longitude
> > > > > > > > > could be
> > > > > > > > > > > -80 west, but that is less important than the
choice
> > of
> > > > > > > parallels.)
> > > > > > > > > > >
> > > > > > > > > > > Before falling back on the Lambert as an easy to
use
> > > > > projection,
> > > > > > > I
> > > > > > > > > tried
> > > > > > > > > > > to get several ESRI products to implement an
> > interrupted
> > > > > > > projection
> > > > > > > > > > > using the sinusoidal projection, in part for
reasons
> > given
> > > > > in
> > > > > > > the
> > > > > > > > > second
> > > > > > > > > > > reference.  I used a separate center longitude for
> > north and
> > > > > > > south
> > > > > > > > > of
> > > > > > > > > > > the equator and the appearance is certainly more
> > > > > satisfactory
> > > > > > > than
> > > > > > > > > the
> > > > > > > > > > > Lambert in my opinion.  I'll attach a PDF of an
> > illustration
> > > > > of
> > > > > > > this
> > > > > > > > > > > approach generated in R that I hope you will get
but
> > not the
> > > > > > > rest of
> > > > > > > > > the
> > > > > > > > > > > list unfortunately.  I can send PDFs of the
references
> > also
> > > > > if
> > > > > > > > > needed.
> > > > > > > > > > >
> > > > > > > > > > > Denis
> > > > > > > > > > >
> > > > > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.
2006.
> > > > > Predicting
> > > > > > > > > > > climate-induced range shifts: model differences
and
> > model
> > > > > > > > > reliability.
> > > > > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > > > > >
> > > > > > > > > > > White D.  2006.  Display of pixel loss and
replication
> > in
> > > > > > > > > reprojecting
> > > > > > > > > > > raster data from the sinusoidal projection.
Geocarto
> > > > > > > International
> > > > > > > > > > > 21(2):19-22.
> > > > > > > > > > >
> > > > > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > > > > >
> > > > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on
> > 2007-04-04
> > > > > > > 12:17:39:
> > > > > > > > > > >
> > > > > > > > > > > > Anyone know of a particularly good map
projection
> > for
> > > > > showing
> > > > > > > all
> > > > > > > > > of
> > > > > > > > > > > > North and South America without too much
distortion?
> > > > > > > > > > > >
> > > > > > > > > > > > THK
> > > > > > > > > > > >
> > > > > > > > > > > > --
> > > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > > Contact info and schedule at
> > > > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > > Reprints at
http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > > > >
> > > > > > > > > > > > _______________________________________________
> > > > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > --
> > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > Contact info and schedule at
> > http://www.keittlab.org/tkeitt/
> > > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > >
> > > > > > > > --
> > > > > > > > Roger Bivand
> > > > > > > > Economic Geography Section, Department of Economics,
> > Norwegian
> > > > > School
> > > > > > > of
> > > > > > > > Economics and Business Administration, Helleveien 30,
N-5045
> > > > > Bergen,
> > > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > > >
> > > > > > > > _______________________________________________
> > > > > > > > R-sig-Geo mailing list
> > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > >
> > > > > >
> > > > > >
> > > > > > --
> > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics, Norwegian
> > School of
> > > > Economics and Business Administration, Helleveien 30, N-5045
Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > >
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School
of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>



From Roger.Bivand at nhh.no  Tue Apr 10 09:17:02 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 10 Apr 2007 09:17:02 +0200 (CEST)
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <OF0A444FC5.76D4A69B-ON882572B8.007302B6-882572B8.0073DBC2@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0704100850360.2368-100001@reclus.nhh.no>

On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:

> Roger Bivand <Roger.Bivand at nhh.no> wrote on 2007-04-09 13:52:45:
> 
> > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> >
> > > Roger's solution makes sense to me.
> > >
> > > The sinusoidal does have the appearance of pinching poleward, a
> > > consequence of allocating equal area by spacing equally in both x
> and y.
> >
> > Both Canada and Norway - especially including Spitzbergen - suffer
> from
> > this, but good compromises are hard to find if one needs Patagonia
> too.
> 
> Goode's Homolosine is one.  USGS distributes (or did) some of their
> global land cover data in that projection, see
> http://landcover.usgs.gov/globallandcover.php.  Not only is it
> interrupted, but it combines the sinusoidal from -40 to +40 and the
> Mollweide poleward of +/- 40.  (I don't see it on the geotiff list.)

projInfo() in rgdal gives a list of supported projections, here:

+proj=goode +lon_0=-80

and a PNG is attached. However, in rgdal on one platform I'm seeing an
EDOM (trig/math function out of domain) that I don't see running proj
through system(). The grid is OK, so there may be a weakness in the
project/transform interface in this case - I'm looking into it. Like the
PROJ.4 sinusoidal, it disregards the ellipsoid anyway, just spherical.

I haven't checked whether the same offset approach can be used to split
the Northern and Southern hemispheres, but I don't see why not, given 
that this is mostly sinusoidal.

Roger

> 
> > I can see that getting rgdal binaries for popular platforms is a real
> > issue, any suggestions?
> >
> > Roger
> >
> > > Also the Lambert cylindrical sent in before should have had standard
> > > parallels set to +/- 30, i.e.,
> > >
> > > (See attached file: whemi.projs.png)
> > >
> > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-09 13:38:33:
> > >
> > > > Canada looks pinched in this projection. S. Am is perfect.
> > > >
> > > > THK
> > > >
> > > > On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > > > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > >
> > > > > > For preview graphics and for large areas such as continents,
> large
> > > > > > countries, hemispheres, or the whole earth, spherical
> projections
> > > are
> > > > > > often adequate.  I can provide some of the ones I have used.
> For
> > > > > > detailed work at sites and small areas, ellipsoidal
> projections
> > > such as
> > > > > > UTM are usually used, and then the coding gets more
> complicated
> > > with
> > > > > > choices of datums and so forth.
> > > > > >
> > > > >
> > > > > The attached script shows how to do the interrupted sinusoidal
> > > projection
> > > > > using spTransform in rgdal, for the whemi.lin data posted with
> the
> > > > > free-standing functions by Denis White a couple of days ago.
> Once
> > > the
> > > > > lines are converted into SpatialLines objects, the rest is
> robust
> > > and
> > > > > simple, as is the use of gridlines() in sp. The one catch is
> > > calculating
> > > > > the offset, here in an x_0= offset along the Equator in metres
> > > between the
> > > > > two central longitude values. The output is attached as a PNG
> image.
> > > The
> > > > > point about the sp objects is that they contain enough metadata
> > > (here a
> > > > > PROJ.4 projection description) to let them be moved to other R
> > > packages or
> > > > > external software.
> > > > >
> > > > > The half-dozen basic projections are easy to specify in PROJ.4,
> for
> > > > > example from the geotiff list:
> > > > >
> > > > > http://www.remotesensing.org/geotiff/proj_list/
> > > > >
> > > > > which is what I used here. The other projections mentioned are:
> > > > >
> > > > > Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
> > > > >
> > > > > Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
> > > > >
> > > > > while the Northern hemisphere sinusoidal is:
> > > > >
> > > > > Sinusoidal "+proj=sinu +lon_0=-100"
> > > > >
> > > > > So I'd argue that PROJ.4 projection descriptions are not
> difficult
> > > to use,
> > > > > and with sp objects, do stay stuck to the data (has anyone else
> ever
> > > > > forgotten what projection was used when revisiting data, not
> just
> > > me?).
> > > > >
> > > > > Using the maptools map2SpatialLines() interface function, or the
> > > Rgshhs()
> > > > > interface to GSHHS shorelines, even getting the lines is quite
> easy,
> > > > > qualified by clipping and bounding box issues in extremities for
> > > > > projection from geographical coordinates.
> > > > >
> > > > > Of course, it would help to have MacOS X and selected Linux
> binaries
> > > of
> > > > > rgdal, we're very lucky that Uwe Ligges is so helpful with the
> > > Windows
> > > > > binaries.
> > > > >
> > > > > Roger
> > > > >
> > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08
> 07:56:03:
> > > > > >
> > > > > > > Denis,
> > > > > > >
> > > > > > > That's really useful. It occurs to me that we only really
> need a
> > > > > > > half-dozen basic projections to cover 90% of user cases.
> Perhaps
> > > these
> > > > > > > could be incorporated into the 'sp' group somewhere and
> relieve
> > > the
> > > > > > > dependence on proj4. (It could be packaged separately for R
> for
> > > the
> > > > > > > other 10% of cases where its needed.)
> > > > > > >
> > > > > > > THK
> > > > > > >
> > > > > > > On 4/6/07, White.Denis at epamail.epa.gov
> > > <White.Denis at epamail.epa.gov>
> > > > > > wrote:
> > > > > > > > Thanks, Roger.  There was a request to see the R code for
> > > these
> > > > > > figures.
> > > > > > > > Attached is the script for the second PDF file plus the
> input
> > > > > > boundary
> > > > > > > > file I used for the hemisphere.  The three projection
> > > functions are
> > > > > > for
> > > > > > > > simple spherical, rather than ellipsoidal, models of the
> > > earth.  The
> > > > > > > > graticule generating function could be more elegant.  I'm
> not
> > > yet up
> > > > > > to
> > > > > > > > speed with sp and the many new spatial capabilities in R
> so
> > > please
> > > > > > > > excuse the old style "lines()" format encoding and
> graphics.
> > > > > > > >
> > > > > > > > Tim, I don't know whether proj4 could do the interrupted
> > > sinusoidal.
> > > > > > > >
> > > > > > > > (See attached file: whemi.projs.r)(See attached file:
> > > whemi.lin)
> > > > > > > >
> > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06
> > > 04:51:53:
> > > > > > > >
> > > > > > > > > Since this topic is of general interest, I've made an
> > > exception
> > > > > > and
> > > > > > > > > allowed (this once!) a posting of more than 200K. In
> > > general, if
> > > > > > > > graphics
> > > > > > > > > are big, please consider either an alternative device
> (png
> > > is
> > > > > > often
> > > > > > > > OK),
> > > > > > > > > or posting just a URL to the real file.
> > > > > > > > >
> > > > > > > > > With apologies to list members on dial-up connections in
> the
> > > > > > field,
> > > > > > > > >
> > > > > > > > > Roger
> > > > > > > > >
> > > > > > > > >
> > > > > > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > > > > >
> > > > > > > > > > Yes, for many uses that is my choice also.  For the
> > > conterminous
> > > > > > US
> > > > > > > > for
> > > > > > > > > > example, the Lambert azimuthal has lower mean
> distortion
> > > than
> > > > > > the
> > > > > > > > > > commonly used standard projection, the Albers conical
> > > equal
> > > > > > area,
> > > > > > > > > > although Albers was chosen by USGS as a standard
> because
> > > of
> > > > > > lower
> > > > > > > > > > extreme distortion than many other possible
> projections.
> > > > > > > > > >
> > > > > > > > > > For our hemispherical application, because we were
> > > gridding the
> > > > > > > > data, we
> > > > > > > > > > wanted parallels of latitude to be parallel in the
> > > projected
> > > > > > > > coordinate
> > > > > > > > > > space, which we wouldn't get with the Lambert
> azimuthal.
> > > > > > > > > >
> > > > > > > > > > (See attached file: whemi.projs.pdf)
> > > > > > > > > >
> > > > > > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05
> 10:56:09:
> > > > > > > > > >
> > > > > > > > > > > Thanks. My application is not that demanding.
> Really, I
> > > just
> > > > > > want
> > > > > > > > it
> > > > > > > > > > > to look reasonable. My plan is to lay out the
> postings
> > > in the
> > > > > > > > > > > projected coordinates and then back transform into
> > > geographic
> > > > > > > > > > > coordinates for analysis. I tried lots of
> projections
> > > and
> > > > > > found
> > > > > > > > > > > Lamberts Azimuthal Equal Area to be quite good. I
> like
> > > the
> > > > > > look of
> > > > > > > > the
> > > > > > > > > > > Azimuthal Equidistant better, but figured equal area
> was
> > > a
> > > > > > good
> > > > > > > > > > > choice.
> > > > > > > > > > >
> > > > > > > > > > > THK
> > > > > > > > > > >
> > > > > > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > > > > > <White.Denis at epamail.epa.gov>
> > > > > > > > > > wrote:
> > > > > > > > > > > > Tim,
> > > > > > > > > > > >
> > > > > > > > > > > > It depends on which kind of distortion is of most
> > > concern.
> > > > > > For
> > > > > > > > many
> > > > > > > > > > > > types of extensive data, especially counts, for
> > > example, the
> > > > > > > > equal
> > > > > > > > > > area
> > > > > > > > > > > > property is desirable.  We used the Lambert
> > > cylindrical
> > > > > > equal
> > > > > > > > area
> > > > > > > > > > > > projection with standard parallels of +/- 30
> degrees
> > > for
> > > > > > some
> > > > > > > > > > western
> > > > > > > > > > > > hemispherical work, see reference below.  (The
> center
> > > > > > longitude
> > > > > > > > > > could be
> > > > > > > > > > > > -80 west, but that is less important than the
> choice
> > > of
> > > > > > > > parallels.)
> > > > > > > > > > > >
> > > > > > > > > > > > Before falling back on the Lambert as an easy to
> use
> > > > > > projection,
> > > > > > > > I
> > > > > > > > > > tried
> > > > > > > > > > > > to get several ESRI products to implement an
> > > interrupted
> > > > > > > > projection
> > > > > > > > > > > > using the sinusoidal projection, in part for
> reasons
> > > given
> > > > > > in
> > > > > > > > the
> > > > > > > > > > second
> > > > > > > > > > > > reference.  I used a separate center longitude for
> > > north and
> > > > > > > > south
> > > > > > > > > > of
> > > > > > > > > > > > the equator and the appearance is certainly more
> > > > > > satisfactory
> > > > > > > > than
> > > > > > > > > > the
> > > > > > > > > > > > Lambert in my opinion.  I'll attach a PDF of an
> > > illustration
> > > > > > of
> > > > > > > > this
> > > > > > > > > > > > approach generated in R that I hope you will get
> but
> > > not the
> > > > > > > > rest of
> > > > > > > > > > the
> > > > > > > > > > > > list unfortunately.  I can send PDFs of the
> references
> > > also
> > > > > > if
> > > > > > > > > > needed.
> > > > > > > > > > > >
> > > > > > > > > > > > Denis
> > > > > > > > > > > >
> > > > > > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.
> 2006.
> > > > > > Predicting
> > > > > > > > > > > > climate-induced range shifts: model differences
> and
> > > model
> > > > > > > > > > reliability.
> > > > > > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > > > > > >
> > > > > > > > > > > > White D.  2006.  Display of pixel loss and
> replication
> > > in
> > > > > > > > > > reprojecting
> > > > > > > > > > > > raster data from the sinusoidal projection.
> Geocarto
> > > > > > > > International
> > > > > > > > > > > > 21(2):19-22.
> > > > > > > > > > > >
> > > > > > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > > > > > >
> > > > > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on
> > > 2007-04-04
> > > > > > > > 12:17:39:
> > > > > > > > > > > >
> > > > > > > > > > > > > Anyone know of a particularly good map
> projection
> > > for
> > > > > > showing
> > > > > > > > all
> > > > > > > > > > of
> > > > > > > > > > > > > North and South America without too much
> distortion?
> > > > > > > > > > > > >
> > > > > > > > > > > > > THK
> > > > > > > > > > > > >
> > > > > > > > > > > > > --
> > > > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > > > Contact info and schedule at
> > > > > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > > > Reprints at
> http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > > > > >
> > > > > > > > > > > > > _______________________________________________
> > > > > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > > > --
> > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > Contact info and schedule at
> > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > >
> > > > > > > > > --
> > > > > > > > > Roger Bivand
> > > > > > > > > Economic Geography Section, Department of Economics,
> > > Norwegian
> > > > > > School
> > > > > > > > of
> > > > > > > > > Economics and Business Administration, Helleveien 30,
> N-5045
> > > > > > Bergen,
> > > > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > > > >
> > > > > > > > > _______________________________________________
> > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > >
> > > > > > >
> > > > > > >
> > > > > > > --
> > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > >
> > > > > > > _______________________________________________
> > > > > > > R-sig-Geo mailing list
> > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > >
> > > > > --
> > > > > Roger Bivand
> > > > > Economic Geography Section, Department of Economics, Norwegian
> > > School of
> > > > > Economics and Business Administration, Helleveien 30, N-5045
> Bergen,
> > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > e-mail: Roger.Bivand at nhh.no
> > > > >
> > > > >
> > > > >
> > > >
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School
> of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

-------------- next part --------------
A non-text attachment was scrubbed...
Name: whemi_goode.png
Type: image/png
Size: 8860 bytes
Desc: 
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070410/3c05407d/attachment.png>

From temiz at deprem.gov.tr  Tue Apr 10 19:39:33 2007
From: temiz at deprem.gov.tr (temiz)
Date: Tue, 10 Apr 2007 13:39:33 -0400
Subject: [R-sig-Geo] levelplot gives an error
In-Reply-To: <461A9299.4000002@geo.uu.nl>
References: <461A9891.5030903@deprem.gov.tr> <461A9299.4000002@geo.uu.nl>
Message-ID: <461BCBD5.8040301@deprem.gov.tr>

Edzer J. Pebesma wrote:
> perhaps use
>
> spplot(OK_pred[1], ...)
>
> which would be more or less short for
>
> levelplot(var1.pred~x+y, as.data.frame(OK_pred), aspect = "iso", ...)
> -- 
> Edzer
>
>
> temiz wrote:
>
>> hello
>>
>> why does levelplot function give an error
>>
>> OK_pred <- krige(z~1,el4, newdata=mask_SG, model=efitted)
>> levelplot(var1.pred ~ x + y , OK_pred , aspect = mapasp(OK_pred), 
>> main = "ordinary kriging predictions")
>> Error in eval(expr, envir, enclos) : invalid 'envir' argument
>>
>> regards
>>
>>  
>>
>
>
thank you

spplot(OK_pred[1],main="Ordinary Kriging - 5") is very good

How can I overlay original contour on this plot ?

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From Thierry.ONKELINX at inbo.be  Tue Apr 10 15:39:08 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 10 Apr 2007 15:39:08 +0200
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
Message-ID: <2E9C414912813E4EB981326983E0A10402D1380F@inboexch.inbo.be>

Dear listers,

When fitting a trend surface I noticed that surf.ls() generates other
values for the model parameters than an ordinary lm(). Since both fit,
in my opinion, the same model to the same data. So I would suppect that
both would generate the same parameter values. Or am I missing
something?

Some sample code.

library("gstat")
data(jura)
library("spatial")
surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y =
prediction.dat$Yloc, z = prediction.dat$Ni)
surface.lm <- lm(Ni ~ Xloc + Yloc, data = prediction.dat)
surface.surf$beta

[1] 18.828803  4.823595 -2.375896

surface.lm$coef

(Intercept)        Xloc        Yloc 
 15.5140337   2.2466673  -0.9299007 

Thanks,

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney



From ggrothendieck at gmail.com  Tue Apr 10 15:59:23 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 10 Apr 2007 09:59:23 -0400
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
In-Reply-To: <2E9C414912813E4EB981326983E0A10402D1380F@inboexch.inbo.be>
References: <2E9C414912813E4EB981326983E0A10402D1380F@inboexch.inbo.be>
Message-ID: <971536df0704100659wf06e756j41273c1223767180@mail.gmail.com>

They are using different coefficient parameterizations but the models
are otherwise
the same.  For example, they give the same fitted values:

> all.equal(fitted(surface.surf), as.vector(fitted(surface.lm)))
[1] TRUE


On 4/10/07, ONKELINX, Thierry <Thierry.ONKELINX at inbo.be> wrote:
> Dear listers,
>
> When fitting a trend surface I noticed that surf.ls() generates other
> values for the model parameters than an ordinary lm(). Since both fit,
> in my opinion, the same model to the same data. So I would suppect that
> both would generate the same parameter values. Or am I missing
> something?
>
> Some sample code.
>
> library("gstat")
> data(jura)
> library("spatial")
> surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y =
> prediction.dat$Yloc, z = prediction.dat$Ni)
> surface.lm <- lm(Ni ~ Xloc + Yloc, data = prediction.dat)
> surface.surf$beta
>
> [1] 18.828803  4.823595 -2.375896
>
> surface.lm$coef
>
> (Intercept)        Xloc        Yloc
>  15.5140337   2.2466673  -0.9299007
>
> Thanks,
>
> Thierry
>
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ripley at stats.ox.ac.uk  Tue Apr 10 16:19:56 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 10 Apr 2007 15:19:56 +0100 (BST)
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
In-Reply-To: <2E9C414912813E4EB981326983E0A10402D1380F@inboexch.inbo.be>
References: <2E9C414912813E4EB981326983E0A10402D1380F@inboexch.inbo.be>
Message-ID: <Pine.LNX.4.64.0704101454340.7288@gannet.stats.ox.ac.uk>

On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:

> Dear listers,
>
> When fitting a trend surface I noticed that surf.ls() generates other
> values for the model parameters than an ordinary lm(). Since both fit,
> in my opinion, the same model to the same data. So I would suppect that
> both would generate the same parameter values. Or am I missing
> something?

You are missing a great deal, including the posting guide.  Who said the 
...$beta were the parameters of the least-squares surface in the raw 
coordinates?  Certainly not the help page, and this is explained in the 
book this software supports which the posting guide asked you to consult.


> Some sample code.
>
> library("gstat")
> data(jura)
> library("spatial")
> surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y =
> prediction.dat$Yloc, z = prediction.dat$Ni)
> surface.lm <- lm(Ni ~ Xloc + Yloc, data = prediction.dat)
> surface.surf$beta
>
> [1] 18.828803  4.823595 -2.375896
>
> surface.lm$coef
>
> (Intercept)        Xloc        Yloc
> 15.5140337   2.2466673  -0.9299007
>
> Thanks,
>
> Thierry
>
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From Thierry.ONKELINX at inbo.be  Tue Apr 10 17:43:58 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 10 Apr 2007 17:43:58 +0200
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
In-Reply-To: <Pine.LNX.4.64.0704101454340.7288@gannet.stats.ox.ac.uk>
Message-ID: <2E9C414912813E4EB981326983E0A10402D138AC@inboexch.inbo.be>

> -----Oorspronkelijk bericht-----
> Van: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
> Verzonden: dinsdag 10 april 2007 16:20
> Aan: ONKELINX, Thierry
> CC: r-sig-geo at stat.math.ethz.ch
> Onderwerp: Re: Bug in surf.ls (spatial package)?
> 
> On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:
> 
> > Dear listers,
> >
> > When fitting a trend surface I noticed that surf.ls() 
> generates other 
> > values for the model parameters than an ordinary lm(). 
> Since both fit, 
> > in my opinion, the same model to the same data. So I would suppect 
> > that both would generate the same parameter values. Or am I missing 
> > something?
> 
> You are missing a great deal, including the posting guide.  
> Who said the ...$beta were the parameters of the 
> least-squares surface in the raw coordinates?  Certainly not 
> the help page, and this is explained in the book this 
> software supports which the posting guide asked you to consult.

First of all, I'd like to apologize for not having every book or paper
mentioned in the packages I use. We have a lot of books and papers, but
not all...

Secondly, ?surf.ls says that "beta: the coefficients". ?lm gives
"coefficients: a named vector of coefficients". Neither says that they
are the parameters for the raw data. But those for lm() are. So I,
wrongly, presumed those for surf.ls() where for the raw data too.

> 
> 
> > Some sample code.
> >
> > library("gstat")
> > data(jura)
> > library("spatial")
> > surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y = 
> > prediction.dat$Yloc, z = prediction.dat$Ni) surface.lm <- 
> lm(Ni ~ Xloc 
> > + Yloc, data = prediction.dat) surface.surf$beta
> >
> > [1] 18.828803  4.823595 -2.375896
> >
> > surface.lm$coef
> >
> > (Intercept)        Xloc        Yloc
> > 15.5140337   2.2466673  -0.9299007
> >
> > Thanks,
> >
> > Thierry
> >
> > 
> ----------------------------------------------------------------------
> > --
> > ----
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Reseach Institute 
> for Nature 
> > and Forest Cel biometrie, methodologie en kwaliteitszorg / Section 
> > biometrics, methodology and quality assurance Gaverstraat 4 9500 
> > Geraardsbergen Belgium tel. + 32 54/436 185 
> Thierry.Onkelinx at inbo.be 
> > www.inbo.be
> >
> > Do not put your faith in what statistics say until you have 
> carefully 
> > considered what they do not say.  ~William W. Watt A statistical 
> > analysis, properly conducted, is a delicate dissection of 
> > uncertainties, a surgery of suppositions. ~M.J.Moroney
> >
> >
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>



From Roger.Bivand at nhh.no  Tue Apr 10 20:29:13 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 10 Apr 2007 20:29:13 +0200 (CEST)
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
In-Reply-To: <2E9C414912813E4EB981326983E0A10402D138AC@inboexch.inbo.be>
Message-ID: <Pine.LNX.4.44.0704102016160.22891-100000@reclus.nhh.no>

On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:

> > -----Oorspronkelijk bericht-----
> > Van: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
> > Verzonden: dinsdag 10 april 2007 16:20
> > Aan: ONKELINX, Thierry
> > CC: r-sig-geo at stat.math.ethz.ch
> > Onderwerp: Re: Bug in surf.ls (spatial package)?
> > 
> > On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:
> > 
> > > Dear listers,
> > >
> > > When fitting a trend surface I noticed that surf.ls() 
> > generates other 
> > > values for the model parameters than an ordinary lm(). 
> > Since both fit, 
> > > in my opinion, the same model to the same data. So I would suppect 
> > > that both would generate the same parameter values. Or am I missing 
> > > something?
> > 
> > You are missing a great deal, including the posting guide.  
> > Who said the ...$beta were the parameters of the 
> > least-squares surface in the raw coordinates?  Certainly not 
> > the help page, and this is explained in the book this 
> > software supports which the posting guide asked you to consult.
> 
> First of all, I'd like to apologize for not having every book or paper
> mentioned in the packages I use. We have a lot of books and papers, but
> not all...
> 
> Secondly, ?surf.ls says that "beta: the coefficients". ?lm gives
> "coefficients: a named vector of coefficients". Neither says that they
> are the parameters for the raw data. But those for lm() are. So I,
> wrongly, presumed those for surf.ls() where for the raw data too.
> 

Please do consult the book reference. In both surf.ls() in spatial and
equivalent functions in gstat, the coordinates are first rescaled to
[-1,1] (p. 420 in the fourth edition of MASS), because at higher orders,
powers of at least the latitude term become very large. For smallish study
areas, a computer cannot distinguish between I(y^3) and I(y^4) when y is
in meters north or south of the Equator. If you try this, you'll see that
lm() drops the coefficients for terms that become indistinguishable, but
surf.ls() handles this numerical problem by rescaling.

> > 
> > 
> > > Some sample code.
> > >
> > > library("gstat")
> > > data(jura)
> > > library("spatial")
> > > surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y = 
> > > prediction.dat$Yloc, z = prediction.dat$Ni) surface.lm <- 
> > lm(Ni ~ Xloc 
> > > + Yloc, data = prediction.dat) surface.surf$beta
> > >
> > > [1] 18.828803  4.823595 -2.375896
> > >
> > > surface.lm$coef
> > >
> > > (Intercept)        Xloc        Yloc
> > > 15.5140337   2.2466673  -0.9299007
> > >
> > > Thanks,
> > >
> > > Thierry
> > >
> > > 
> > ----------------------------------------------------------------------
> > > --
> > > ----
> > > ir. Thierry Onkelinx
> > > Instituut voor natuur- en bosonderzoek / Reseach Institute 
> > for Nature 
> > > and Forest Cel biometrie, methodologie en kwaliteitszorg / Section 
> > > biometrics, methodology and quality assurance Gaverstraat 4 9500 
> > > Geraardsbergen Belgium tel. + 32 54/436 185 
> > Thierry.Onkelinx at inbo.be 
> > > www.inbo.be
> > >
> > > Do not put your faith in what statistics say until you have 
> > carefully 
> > > considered what they do not say.  ~William W. Watt A statistical 
> > > analysis, properly conducted, is a delicate dissection of 
> > > uncertainties, a surgery of suppositions. ~M.J.Moroney
> > >
> > >
> > 
> > -- 
> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Thierry.ONKELINX at inbo.be  Tue Apr 10 22:36:16 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 10 Apr 2007 22:36:16 +0200
Subject: [R-sig-Geo] Bug in surf.ls (spatial package)?
References: <Pine.LNX.4.44.0704102016160.22891-100000@reclus.nhh.no>
Message-ID: <2E9C414912813E4EB981326983E0A1042E49C7@inboexch.inbo.be>

Dear Roger,

Thank you for this clarification. I was planning to ask our librarian to buy the book anyway.

Thierry

-----Oorspronkelijk bericht-----
Van: Roger Bivand [mailto:Roger.Bivand at nhh.no]
Verzonden: di 10-4-2007 20:29
Aan: ONKELINX, Thierry
CC: Prof Brian Ripley; r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] Bug in surf.ls (spatial package)?
 
On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:

> > -----Oorspronkelijk bericht-----
> > Van: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
> > Verzonden: dinsdag 10 april 2007 16:20
> > Aan: ONKELINX, Thierry
> > CC: r-sig-geo at stat.math.ethz.ch
> > Onderwerp: Re: Bug in surf.ls (spatial package)?
> > 
> > On Tue, 10 Apr 2007, ONKELINX, Thierry wrote:
> > 
> > > Dear listers,
> > >
> > > When fitting a trend surface I noticed that surf.ls() 
> > generates other 
> > > values for the model parameters than an ordinary lm(). 
> > Since both fit, 
> > > in my opinion, the same model to the same data. So I would suppect 
> > > that both would generate the same parameter values. Or am I missing 
> > > something?
> > 
> > You are missing a great deal, including the posting guide.  
> > Who said the ...$beta were the parameters of the 
> > least-squares surface in the raw coordinates?  Certainly not 
> > the help page, and this is explained in the book this 
> > software supports which the posting guide asked you to consult.
> 
> First of all, I'd like to apologize for not having every book or paper
> mentioned in the packages I use. We have a lot of books and papers, but
> not all...
> 
> Secondly, ?surf.ls says that "beta: the coefficients". ?lm gives
> "coefficients: a named vector of coefficients". Neither says that they
> are the parameters for the raw data. But those for lm() are. So I,
> wrongly, presumed those for surf.ls() where for the raw data too.
> 

Please do consult the book reference. In both surf.ls() in spatial and
equivalent functions in gstat, the coordinates are first rescaled to
[-1,1] (p. 420 in the fourth edition of MASS), because at higher orders,
powers of at least the latitude term become very large. For smallish study
areas, a computer cannot distinguish between I(y^3) and I(y^4) when y is
in meters north or south of the Equator. If you try this, you'll see that
lm() drops the coefficients for terms that become indistinguishable, but
surf.ls() handles this numerical problem by rescaling.

> > 
> > 
> > > Some sample code.
> > >
> > > library("gstat")
> > > data(jura)
> > > library("spatial")
> > > surface.surf <- surf.ls(np = 1, x = prediction.dat$Xloc, y = 
> > > prediction.dat$Yloc, z = prediction.dat$Ni) surface.lm <- 
> > lm(Ni ~ Xloc 
> > > + Yloc, data = prediction.dat) surface.surf$beta
> > >
> > > [1] 18.828803  4.823595 -2.375896
> > >
> > > surface.lm$coef
> > >
> > > (Intercept)        Xloc        Yloc
> > > 15.5140337   2.2466673  -0.9299007
> > >
> > > Thanks,
> > >
> > > Thierry
> > >
> > > 
> > ----------------------------------------------------------------------
> > > --
> > > ----
> > > ir. Thierry Onkelinx
> > > Instituut voor natuur- en bosonderzoek / Reseach Institute 
> > for Nature 
> > > and Forest Cel biometrie, methodologie en kwaliteitszorg / Section 
> > > biometrics, methodology and quality assurance Gaverstraat 4 9500 
> > > Geraardsbergen Belgium tel. + 32 54/436 185 
> > Thierry.Onkelinx at inbo.be 
> > > www.inbo.be
> > >
> > > Do not put your faith in what statistics say until you have 
> > carefully 
> > > considered what they do not say.  ~William W. Watt A statistical 
> > > analysis, properly conducted, is a delicate dissection of 
> > > uncertainties, a surgery of suppositions. ~M.J.Moroney
> > >
> > >
> > 
> > -- 
> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Wed Apr 11 11:25:17 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 11 Apr 2007 11:25:17 +0200 (CEST)
Subject: [R-sig-Geo] Good projection for N/S America?
In-Reply-To: <Pine.LNX.4.44.0704100850360.2368-100001@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0704111057480.27281-100000@reclus.nhh.no>

On Tue, 10 Apr 2007, Roger Bivand wrote:

> On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> 
> > Roger Bivand <Roger.Bivand at nhh.no> wrote on 2007-04-09 13:52:45:
> > 
> > > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > >
> > > > Roger's solution makes sense to me.
> > > >
> > > > The sinusoidal does have the appearance of pinching poleward, a
> > > > consequence of allocating equal area by spacing equally in both x
> > and y.
> > >
> > > Both Canada and Norway - especially including Spitzbergen - suffer
> > from
> > > this, but good compromises are hard to find if one needs Patagonia
> > too.
> > 
> > Goode's Homolosine is one.  USGS distributes (or did) some of their
> > global land cover data in that projection, see
> > http://landcover.usgs.gov/globallandcover.php.  Not only is it
> > interrupted, but it combines the sinusoidal from -40 to +40 and the
> > Mollweide poleward of +/- 40.  (I don't see it on the geotiff list.)
> 
> projInfo() in rgdal gives a list of supported projections, here:
> 
> +proj=goode +lon_0=-80
> 
> and a PNG is attached. However, in rgdal on one platform I'm seeing an
> EDOM (trig/math function out of domain) that I don't see running proj
> through system(). The grid is OK, so there may be a weakness in the
> project/transform interface in this case - I'm looking into it. Like the
> PROJ.4 sinusoidal, it disregards the ellipsoid anyway, just spherical.

Following this problem up, I have improved error handling in project() and
spTransform() in rgdal, but there is a problem with "+proj=goode" on some
platforms (not the current Windows binary), which seems to get muddled
when switching across +/- 40d44m (in proj source file pj_goode.c) or
40d44m12s (Snyder p. 249). Running "+proj=moll" or "+proj=sinu" on the
same data is not a problem on the affected platform(s). My suspicions are 
that there are differences in compiler headers between the proj library 
and the rgdal/R binaries, which may be platform dependent - my affected 
platforms are RHEL 4.

Roger

> 
> I haven't checked whether the same offset approach can be used to split
> the Northern and Southern hemispheres, but I don't see why not, given 
> that this is mostly sinusoidal.
> 
> Roger
> 
> > 
> > > I can see that getting rgdal binaries for popular platforms is a real
> > > issue, any suggestions?
> > >
> > > Roger
> > >
> > > > Also the Lambert cylindrical sent in before should have had standard
> > > > parallels set to +/- 30, i.e.,
> > > >
> > > > (See attached file: whemi.projs.png)
> > > >
> > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-09 13:38:33:
> > > >
> > > > > Canada looks pinched in this projection. S. Am is perfect.
> > > > >
> > > > > THK
> > > > >
> > > > > On 4/9/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > > > > On Mon, 9 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > >
> > > > > > > For preview graphics and for large areas such as continents,
> > large
> > > > > > > countries, hemispheres, or the whole earth, spherical
> > projections
> > > > are
> > > > > > > often adequate.  I can provide some of the ones I have used.
> > For
> > > > > > > detailed work at sites and small areas, ellipsoidal
> > projections
> > > > such as
> > > > > > > UTM are usually used, and then the coding gets more
> > complicated
> > > > with
> > > > > > > choices of datums and so forth.
> > > > > > >
> > > > > >
> > > > > > The attached script shows how to do the interrupted sinusoidal
> > > > projection
> > > > > > using spTransform in rgdal, for the whemi.lin data posted with
> > the
> > > > > > free-standing functions by Denis White a couple of days ago.
> > Once
> > > > the
> > > > > > lines are converted into SpatialLines objects, the rest is
> > robust
> > > > and
> > > > > > simple, as is the use of gridlines() in sp. The one catch is
> > > > calculating
> > > > > > the offset, here in an x_0= offset along the Equator in metres
> > > > between the
> > > > > > two central longitude values. The output is attached as a PNG
> > image.
> > > > The
> > > > > > point about the sp objects is that they contain enough metadata
> > > > (here a
> > > > > > PROJ.4 projection description) to let them be moved to other R
> > > > packages or
> > > > > > external software.
> > > > > >
> > > > > > The half-dozen basic projections are easy to specify in PROJ.4,
> > for
> > > > > > example from the geotiff list:
> > > > > >
> > > > > > http://www.remotesensing.org/geotiff/proj_list/
> > > > > >
> > > > > > which is what I used here. The other projections mentioned are:
> > > > > >
> > > > > > Lambert Cylindrical Equal Area "+proj=cea +lon_0=-80"
> > > > > >
> > > > > > Lambert Azimuthal Equal Area "+proj=laea +lat_0=0 +lon_0=-80"
> > > > > >
> > > > > > while the Northern hemisphere sinusoidal is:
> > > > > >
> > > > > > Sinusoidal "+proj=sinu +lon_0=-100"
> > > > > >
> > > > > > So I'd argue that PROJ.4 projection descriptions are not
> > difficult
> > > > to use,
> > > > > > and with sp objects, do stay stuck to the data (has anyone else
> > ever
> > > > > > forgotten what projection was used when revisiting data, not
> > just
> > > > me?).
> > > > > >
> > > > > > Using the maptools map2SpatialLines() interface function, or the
> > > > Rgshhs()
> > > > > > interface to GSHHS shorelines, even getting the lines is quite
> > easy,
> > > > > > qualified by clipping and bounding box issues in extremities for
> > > > > > projection from geographical coordinates.
> > > > > >
> > > > > > Of course, it would help to have MacOS X and selected Linux
> > binaries
> > > > of
> > > > > > rgdal, we're very lucky that Uwe Ligges is so helpful with the
> > > > Windows
> > > > > > binaries.
> > > > > >
> > > > > > Roger
> > > > > >
> > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-08
> > 07:56:03:
> > > > > > >
> > > > > > > > Denis,
> > > > > > > >
> > > > > > > > That's really useful. It occurs to me that we only really
> > need a
> > > > > > > > half-dozen basic projections to cover 90% of user cases.
> > Perhaps
> > > > these
> > > > > > > > could be incorporated into the 'sp' group somewhere and
> > relieve
> > > > the
> > > > > > > > dependence on proj4. (It could be packaged separately for R
> > for
> > > > the
> > > > > > > > other 10% of cases where its needed.)
> > > > > > > >
> > > > > > > > THK
> > > > > > > >
> > > > > > > > On 4/6/07, White.Denis at epamail.epa.gov
> > > > <White.Denis at epamail.epa.gov>
> > > > > > > wrote:
> > > > > > > > > Thanks, Roger.  There was a request to see the R code for
> > > > these
> > > > > > > figures.
> > > > > > > > > Attached is the script for the second PDF file plus the
> > input
> > > > > > > boundary
> > > > > > > > > file I used for the hemisphere.  The three projection
> > > > functions are
> > > > > > > for
> > > > > > > > > simple spherical, rather than ellipsoidal, models of the
> > > > earth.  The
> > > > > > > > > graticule generating function could be more elegant.  I'm
> > not
> > > > yet up
> > > > > > > to
> > > > > > > > > speed with sp and the many new spatial capabilities in R
> > so
> > > > please
> > > > > > > > > excuse the old style "lines()" format encoding and
> > graphics.
> > > > > > > > >
> > > > > > > > > Tim, I don't know whether proj4 could do the interrupted
> > > > sinusoidal.
> > > > > > > > >
> > > > > > > > > (See attached file: whemi.projs.r)(See attached file:
> > > > whemi.lin)
> > > > > > > > >
> > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-04-06
> > > > 04:51:53:
> > > > > > > > >
> > > > > > > > > > Since this topic is of general interest, I've made an
> > > > exception
> > > > > > > and
> > > > > > > > > > allowed (this once!) a posting of more than 200K. In
> > > > general, if
> > > > > > > > > graphics
> > > > > > > > > > are big, please consider either an alternative device
> > (png
> > > > is
> > > > > > > often
> > > > > > > > > OK),
> > > > > > > > > > or posting just a URL to the real file.
> > > > > > > > > >
> > > > > > > > > > With apologies to list members on dial-up connections in
> > the
> > > > > > > field,
> > > > > > > > > >
> > > > > > > > > > Roger
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > On Thu, 5 Apr 2007 White.Denis at epamail.epa.gov wrote:
> > > > > > > > > >
> > > > > > > > > > > Yes, for many uses that is my choice also.  For the
> > > > conterminous
> > > > > > > US
> > > > > > > > > for
> > > > > > > > > > > example, the Lambert azimuthal has lower mean
> > distortion
> > > > than
> > > > > > > the
> > > > > > > > > > > commonly used standard projection, the Albers conical
> > > > equal
> > > > > > > area,
> > > > > > > > > > > although Albers was chosen by USGS as a standard
> > because
> > > > of
> > > > > > > lower
> > > > > > > > > > > extreme distortion than many other possible
> > projections.
> > > > > > > > > > >
> > > > > > > > > > > For our hemispherical application, because we were
> > > > gridding the
> > > > > > > > > data, we
> > > > > > > > > > > wanted parallels of latitude to be parallel in the
> > > > projected
> > > > > > > > > coordinate
> > > > > > > > > > > space, which we wouldn't get with the Lambert
> > azimuthal.
> > > > > > > > > > >
> > > > > > > > > > > (See attached file: whemi.projs.pdf)
> > > > > > > > > > >
> > > > > > > > > > > Tim Keitt <tkeitt at gmail.com> wrote on 2007-04-05
> > 10:56:09:
> > > > > > > > > > >
> > > > > > > > > > > > Thanks. My application is not that demanding.
> > Really, I
> > > > just
> > > > > > > want
> > > > > > > > > it
> > > > > > > > > > > > to look reasonable. My plan is to lay out the
> > postings
> > > > in the
> > > > > > > > > > > > projected coordinates and then back transform into
> > > > geographic
> > > > > > > > > > > > coordinates for analysis. I tried lots of
> > projections
> > > > and
> > > > > > > found
> > > > > > > > > > > > Lamberts Azimuthal Equal Area to be quite good. I
> > like
> > > > the
> > > > > > > look of
> > > > > > > > > the
> > > > > > > > > > > > Azimuthal Equidistant better, but figured equal area
> > was
> > > > a
> > > > > > > good
> > > > > > > > > > > > choice.
> > > > > > > > > > > >
> > > > > > > > > > > > THK
> > > > > > > > > > > >
> > > > > > > > > > > > On 4/4/07, White.Denis at epamail.epa.gov
> > > > > > > > > <White.Denis at epamail.epa.gov>
> > > > > > > > > > > wrote:
> > > > > > > > > > > > > Tim,
> > > > > > > > > > > > >
> > > > > > > > > > > > > It depends on which kind of distortion is of most
> > > > concern.
> > > > > > > For
> > > > > > > > > many
> > > > > > > > > > > > > types of extensive data, especially counts, for
> > > > example, the
> > > > > > > > > equal
> > > > > > > > > > > area
> > > > > > > > > > > > > property is desirable.  We used the Lambert
> > > > cylindrical
> > > > > > > equal
> > > > > > > > > area
> > > > > > > > > > > > > projection with standard parallels of +/- 30
> > degrees
> > > > for
> > > > > > > some
> > > > > > > > > > > western
> > > > > > > > > > > > > hemispherical work, see reference below.  (The
> > center
> > > > > > > longitude
> > > > > > > > > > > could be
> > > > > > > > > > > > > -80 west, but that is less important than the
> > choice
> > > > of
> > > > > > > > > parallels.)
> > > > > > > > > > > > >
> > > > > > > > > > > > > Before falling back on the Lambert as an easy to
> > use
> > > > > > > projection,
> > > > > > > > > I
> > > > > > > > > > > tried
> > > > > > > > > > > > > to get several ESRI products to implement an
> > > > interrupted
> > > > > > > > > projection
> > > > > > > > > > > > > using the sinusoidal projection, in part for
> > reasons
> > > > given
> > > > > > > in
> > > > > > > > > the
> > > > > > > > > > > second
> > > > > > > > > > > > > reference.  I used a separate center longitude for
> > > > north and
> > > > > > > > > south
> > > > > > > > > > > of
> > > > > > > > > > > > > the equator and the appearance is certainly more
> > > > > > > satisfactory
> > > > > > > > > than
> > > > > > > > > > > the
> > > > > > > > > > > > > Lambert in my opinion.  I'll attach a PDF of an
> > > > illustration
> > > > > > > of
> > > > > > > > > this
> > > > > > > > > > > > > approach generated in R that I hope you will get
> > but
> > > > not the
> > > > > > > > > rest of
> > > > > > > > > > > the
> > > > > > > > > > > > > list unfortunately.  I can send PDFs of the
> > references
> > > > also
> > > > > > > if
> > > > > > > > > > > needed.
> > > > > > > > > > > > >
> > > > > > > > > > > > > Denis
> > > > > > > > > > > > >
> > > > > > > > > > > > > Lawler JJ, White D, Neilson RP, Blaustein AR.
> > 2006.
> > > > > > > Predicting
> > > > > > > > > > > > > climate-induced range shifts: model differences
> > and
> > > > model
> > > > > > > > > > > reliability.
> > > > > > > > > > > > > Global Change Biology 12:1568-1584.
> > > > > > > > > > > > >
> > > > > > > > > > > > > White D.  2006.  Display of pixel loss and
> > replication
> > > > in
> > > > > > > > > > > reprojecting
> > > > > > > > > > > > > raster data from the sinusoidal projection.
> > Geocarto
> > > > > > > > > International
> > > > > > > > > > > > > 21(2):19-22.
> > > > > > > > > > > > >
> > > > > > > > > > > > > (See attached file: whemi.sinus.pdf)
> > > > > > > > > > > > >
> > > > > > > > > > > > > r-sig-geo-bounces at stat.math.ethz.ch wrote on
> > > > 2007-04-04
> > > > > > > > > 12:17:39:
> > > > > > > > > > > > >
> > > > > > > > > > > > > > Anyone know of a particularly good map
> > projection
> > > > for
> > > > > > > showing
> > > > > > > > > all
> > > > > > > > > > > of
> > > > > > > > > > > > > > North and South America without too much
> > distortion?
> > > > > > > > > > > > > >
> > > > > > > > > > > > > > THK
> > > > > > > > > > > > > >
> > > > > > > > > > > > > > --
> > > > > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > > > > Contact info and schedule at
> > > > > > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > > > > Reprints at
> > http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > > > > > >
> > > > > > > > > > > > > > _______________________________________________
> > > > > > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > > > > > >
> > > > > > > > > > > >
> > > > > > > > > > > >
> > > > > > > > > > > > --
> > > > > > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > > > > > Contact info and schedule at
> > > > http://www.keittlab.org/tkeitt/
> > > > > > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > > > >
> > > > > > > > > > --
> > > > > > > > > > Roger Bivand
> > > > > > > > > > Economic Geography Section, Department of Economics,
> > > > Norwegian
> > > > > > > School
> > > > > > > > > of
> > > > > > > > > > Economics and Business Administration, Helleveien 30,
> > N-5045
> > > > > > > Bergen,
> > > > > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > > > > >
> > > > > > > > > > _______________________________________________
> > > > > > > > > > R-sig-Geo mailing list
> > > > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > > --
> > > > > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > > > > ODF attachment? See http://www.openoffice.org/
> > > > > > > >
> > > > > > > > _______________________________________________
> > > > > > > > R-sig-Geo mailing list
> > > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > >
> > > > > > > _______________________________________________
> > > > > > > R-sig-Geo mailing list
> > > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > > >
> > > > > >
> > > > > > --
> > > > > > Roger Bivand
> > > > > > Economic Geography Section, Department of Economics, Norwegian
> > > > School of
> > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > Bergen,
> > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > >
> > > > > >
> > > > > >
> > > > >
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School
> > of
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From temiz at deprem.gov.tr  Wed Apr 11 18:07:59 2007
From: temiz at deprem.gov.tr (temiz)
Date: Wed, 11 Apr 2007 12:07:59 -0400
Subject: [R-sig-Geo] trend surface with gstat
Message-ID: <461D07DF.400@deprem.gov.tr>

hello

I wonder  how I can create  trend surface with gstat?

can you supply an example ?

regards



-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From Roger.Bivand at nhh.no  Wed Apr 11 12:24:56 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 11 Apr 2007 12:24:56 +0200 (CEST)
Subject: [R-sig-Geo] trend surface with gstat
In-Reply-To: <461D07DF.400@deprem.gov.tr>
Message-ID: <Pine.LNX.4.44.0704111217000.27281-100000@reclus.nhh.no>

On Wed, 11 Apr 2007, temiz wrote:

> hello
> 
> I wonder  how I can create  trend surface with gstat?
> 
> can you supply an example ?

?gstat
x <- gstat(..., degree=2)

predict(x, newdata=...)

for a quadratic surface.

library(gstat)
data(meuse)
coordinates(meuse) <- c("x", "y")
data(meuse.grid)
coordinates(meuse.grid) <- c("x", "y")
gridded(meuse.grid) <- TRUE
x <- gstat(formula=zinc ~ 1, data=meuse, degree=2)
res <- predict(x, newdata=meuse.grid)
spplot(res, "var1.pred")

Roger

> 
> regards
> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Wed Apr 11 13:23:24 2007
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Wed, 11 Apr 2007 13:23:24 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <6404EF02-215C-44E1-A153-F1E0B4FC707D@wanadoo.fr>

Merci de me d?sabonner de cette liste

Cordialement

Jacques Vernin



From Roger.Bivand at nhh.no  Wed Apr 11 13:50:26 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 11 Apr 2007 13:50:26 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <6404EF02-215C-44E1-A153-F1E0B4FC707D@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0704111342480.27281-100000@reclus.nhh.no>

On Wed, 11 Apr 2007, pir2.jv wrote:

> Merci de me d?sabonner de cette liste

Please *do* use the unsubscribe instructions given in the link at 
the foot of each message - scroll to the foot of the page:

https://stat.ethz.ch/mailman/listinfo/r-sig-geo

It's not hard to do, and gives the maintainer time to do more interesting 
things. You are subscribed from your current email address, so please just 
do what is expected. The only reason for contacting the maintainer (never 
the whole list) is if you have totally forgotten your subscribed email 
address (and in any case your subscription would then be cancelled after 
crossing a bounce threshold if your account was stopped).

> 
> Cordialement
> 
> Jacques Vernin
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From yong.li at unimelb.edu.au  Thu Apr 12 09:33:54 2007
From: yong.li at unimelb.edu.au (Yong Li)
Date: Thu, 12 Apr 2007 17:33:54 +1000
Subject: [R-sig-Geo] How to randomly select points in a polygon
In-Reply-To: <mailman.17.1176285608.28080.r-sig-geo@stat.math.ethz.ch>
References: <mailman.17.1176285608.28080.r-sig-geo@stat.math.ethz.ch>
Message-ID: <6.2.5.6.2.20070412173017.038b6eb0@unimelb.edu.au>

I want to overlay points with a polygon, get the points in the 
polygon and then try to just select a point randomly from them.
I have tried using overlay, but it did not give me what I really 
want. Any help will be appreciated.

Yong



From e.pebesma at geo.uu.nl  Thu Apr 12 09:41:54 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 12 Apr 2007 09:41:54 +0200
Subject: [R-sig-Geo] How to randomly select points in a polygon
In-Reply-To: <6.2.5.6.2.20070412173017.038b6eb0@unimelb.edu.au>
References: <mailman.17.1176285608.28080.r-sig-geo@stat.math.ethz.ch>
	<6.2.5.6.2.20070412173017.038b6eb0@unimelb.edu.au>
Message-ID: <461DE2C2.9050705@geo.uu.nl>

You may want to use spsample, or, if you selected the points in the 
polygon with overlay and want to sample from them, use function sample.

It is hard for us to see what you're trying and cannot get without 
(reproducible) example code.
--
Edzer

Yong Li wrote:
> I want to overlay points with a polygon, get the points in the 
> polygon and then try to just select a point randomly from them.
> I have tried using overlay, but it did not give me what I really 
> want. Any help will be appreciated.
>
> Yong
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From yong.li at unimelb.edu.au  Thu Apr 12 14:46:13 2007
From: yong.li at unimelb.edu.au (Yong Li)
Date: Thu, 12 Apr 2007 22:46:13 +1000 (EST)
Subject: [R-sig-Geo] (no subject)
Message-ID: <1631.220.237.155.60.1176381973.squirrel@webmail.unimelb.edu.au>

require(maptools)

#read in shape file
pts   <- readShapePoints(system.file("shapes/baltim.shp",
package="maptools")[1])

#define the dimension of grids
x.min <- summary(pts)$bbox[1]
y.min <- summary(pts)$bbox[2]
x.max <- summary(pts)$bbox[3]
y.max <- summary(pts)$bbox[4]
cellsize <- 20
x.n   <- round((x.max-x.min)/cellsize)+1
y.n   <- round((y.max-y.min)/cellsize)+1

#produce polygons from grids
grd   <- GridTopology(c(x.min,y.min), c(cellsize,cellsize), c(x.n,y.n))
polys <- as.SpatialPolygons.GridTopology(grd)
plot(polys)
plot(pts, col="blue", add=TRUE )

index <- overlay(pts, polys[11])

#Then a. get the selected points in No.11 polygon,
      b. randomly just choose one point from above selected points,
      c. do the same for other polygons (rectangles), and
      d. put the finally selected points in another shape file.

The output would be that there is only one point in each rectangle. The
purpose of
doing this is to resample the points at different scales for
geo-statistics analysis.

Cheers

Yong



From e.pebesma at geo.uu.nl  Thu Apr 12 16:02:56 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 12 Apr 2007 16:02:56 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <1631.220.237.155.60.1176381973.squirrel@webmail.unimelb.edu.au>
References: <1631.220.237.155.60.1176381973.squirrel@webmail.unimelb.edu.au>
Message-ID: <461E3C10.6070207@geo.uu.nl>

Yong Li wrote:
> require(maptools)
>
> #read in shape file
> pts   <- readShapePoints(system.file("shapes/baltim.shp",
> package="maptools")[1])
>
> #define the dimension of grids
> x.min <- summary(pts)$bbox[1]
> y.min <- summary(pts)$bbox[2]
> x.max <- summary(pts)$bbox[3]
> y.max <- summary(pts)$bbox[4]
> cellsize <- 20
> x.n   <- round((x.max-x.min)/cellsize)+1
> y.n   <- round((y.max-y.min)/cellsize)+1
>
> #produce polygons from grids
> grd   <- GridTopology(c(x.min,y.min), c(cellsize,cellsize), c(x.n,y.n))
> polys <- as.SpatialPolygons.GridTopology(grd)
> plot(polys)
> plot(pts, col="blue", add=TRUE )
>
> index <- overlay(pts, polys[11])
>   
This should give you the indices of pts that fall in poly[11].
You can randomly sample this by
one.index = sample(index, 1)
and select the point by
pts[c(one.index,two.index),]
etc.

HTH,
--
Edzer
> #Then a. get the selected points in No.11 polygon,
>       b. randomly just choose one point from above selected points,
>       c. do the same for other polygons (rectangles), and
>       d. put the finally selected points in another shape file.
>
> The output would be that there is only one point in each rectangle. The
> purpose of
> doing this is to resample the points at different scales for
> geo-statistics analysis.
>
> Cheers
>
> Yong
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From temiz at deprem.gov.tr  Fri Apr 13 14:19:58 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 13 Apr 2007 08:19:58 -0400
Subject: [R-sig-Geo] which  variogram's  sill , nugget  and  range
Message-ID: <461F756E.8020909@deprem.gov.tr>

hello

when I create a directional variogram,  it  usually gives  different 
shaped variograms according to its direction.
(like this cvgm <- variogram(z ~1, data=el4 ,boundaries = seq(0,2000, by 
= 50), alpha=c(0,45,90,135,180,225,270))  )

In these cases,  which  variogram's  sill , nugget  and  range are 
picked up for krig estimation ?

regards


-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From temiz at deprem.gov.tr  Fri Apr 13 14:45:53 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 13 Apr 2007 08:45:53 -0400
Subject: [R-sig-Geo] universal kriging gives error
Message-ID: <461F7B81.6060107@deprem.gov.tr>

hello

when I try universal kriging, it gives this error:

 > v.trend <- variogram(z~x+y,el4)
 > new.fit <- fit.variogram(v.trend, vgm(1,"Exp",300,1))
 > krige(el4$z~el4$x+el4$y,el4, model=new.fit, newdata=mask_SG)
Error in gstat.formula.predict(d$formula, newdata, na.action = na.action) :
        NROW(locs) != NROW(X): this should not occur
In addition: Warning messages:
1: 'newdata' had 42705 rows but variable(s) found have 7998 rows
2: 'newdata' had 42705 rows but variable(s) found have 7998 rows

regards

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From e.pebesma at geo.uu.nl  Fri Apr 13 09:19:53 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 13 Apr 2007 09:19:53 +0200
Subject: [R-sig-Geo] universal kriging gives error
In-Reply-To: <461F7B81.6060107@deprem.gov.tr>
References: <461F7B81.6060107@deprem.gov.tr>
Message-ID: <461F2F19.3060702@geo.uu.nl>

temiz wrote:
> hello
>
> when I try universal kriging, it gives this error:
>
>  > v.trend <- variogram(z~x+y,el4)
>  > new.fit <- fit.variogram(v.trend, vgm(1,"Exp",300,1))
>  > krige(el4$z~el4$x+el4$y,el4, model=new.fit, newdata=mask_SG)
> Error in gstat.formula.predict(d$formula, newdata, na.action = na.action) :
>         NROW(locs) != NROW(X): this should not occur
> In addition: Warning messages:
> 1: 'newdata' had 42705 rows but variable(s) found have 7998 rows
> 2: 'newdata' had 42705 rows but variable(s) found have 7998 rows
>
> regards
>
>   
Please use the form

krige(z~x+y, el4, mask_SG, new.fit)

as x+y need to be resolved from both el4 and mask_SG -- how to get 
coordinates named el4$x from mask_SG otherwise?
--
Edzer



From e.pebesma at geo.uu.nl  Fri Apr 13 09:20:51 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 13 Apr 2007 09:20:51 +0200
Subject: [R-sig-Geo] which  variogram's  sill , nugget  and  range
In-Reply-To: <461F756E.8020909@deprem.gov.tr>
References: <461F756E.8020909@deprem.gov.tr>
Message-ID: <461F2F53.7050607@geo.uu.nl>

temiz wrote:
> hello
>
> when I create a directional variogram,  it  usually gives  different 
> shaped variograms according to its direction.
> (like this cvgm <- variogram(z ~1, data=el4 ,boundaries = seq(0,2000, by 
> = 50), alpha=c(0,45,90,135,180,225,270))  )
>
> In these cases,  which  variogram's  sill , nugget  and  range are 
> picked up for krig estimation ?
>
> regards
>
>
>   
I guess you found out by now -- sill nugget and range are derived from 
the variogram model (output of vgm) rather than from the sample 
variogram (output of variogram()).
--
Edzer



From temiz at deprem.gov.tr  Fri Apr 13 15:46:01 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 13 Apr 2007 09:46:01 -0400
Subject: [R-sig-Geo] universal kriging gives error
In-Reply-To: <461F2F19.3060702@geo.uu.nl>
References: <461F7B81.6060107@deprem.gov.tr> <461F2F19.3060702@geo.uu.nl>
Message-ID: <461F8999.2060909@deprem.gov.tr>

Edzer J. Pebesma wrote:
> temiz wrote:
>> hello
>>
>> when I try universal kriging, it gives this error:
>>
>>  > v.trend <- variogram(z~x+y,el4)
>>  > new.fit <- fit.variogram(v.trend, vgm(1,"Exp",300,1))
>>  > krige(el4$z~el4$x+el4$y,el4, model=new.fit, newdata=mask_SG)
>> Error in gstat.formula.predict(d$formula, newdata, na.action = 
>> na.action) :
>>         NROW(locs) != NROW(X): this should not occur
>> In addition: Warning messages:
>> 1: 'newdata' had 42705 rows but variable(s) found have 7998 rows
>> 2: 'newdata' had 42705 rows but variable(s) found have 7998 rows
>>
>> regards
>>
>>   
> Please use the form
>
> krige(z~x+y, el4, mask_SG, new.fit)
>
> as x+y need to be resolved from both el4 and mask_SG -- how to get 
> coordinates named el4$x from mask_SG otherwise?
> -- 
> Edzer
>
when I do it, it does not recognize x and y.

 > k1 = krige(z~x+y, el4, mask_SG, new.fit)
Error in eval(expr, envir, enclos) : object "x" not found

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From temiz at deprem.gov.tr  Fri Apr 13 15:48:30 2007
From: temiz at deprem.gov.tr (temiz)
Date: Fri, 13 Apr 2007 09:48:30 -0400
Subject: [R-sig-Geo] which  variogram's  sill , nugget  and  range
In-Reply-To: <461F2F53.7050607@geo.uu.nl>
References: <461F756E.8020909@deprem.gov.tr> <461F2F53.7050607@geo.uu.nl>
Message-ID: <461F8A2E.7090703@deprem.gov.tr>

Edzer J. Pebesma wrote:
> temiz wrote:
>> hello
>>
>> when I create a directional variogram,  it  usually gives  different 
>> shaped variograms according to its direction.
>> (like this cvgm <- variogram(z ~1, data=el4 ,boundaries = seq(0,2000, 
>> by = 50), alpha=c(0,45,90,135,180,225,270))  )
>>
>> In these cases,  which  variogram's  sill , nugget  and  range are 
>> picked up for krig estimation ?
>>
>> regards
>>
>>
>>   
> I guess you found out by now -- sill nugget and range are derived from 
> the variogram model (output of vgm) rather than from the sample 
> variogram (output of variogram()).
> -- 
> Edzer
>
thank you
(sorry for double message. I had skipped to hit reply all)

I get those values from plot(cvgm).
Is this wrong ?

-- 
Ahmet Temiz


-- 
This message has been scanned for viruses and\ dangerous con...{{dropped}}



From massimodisasha at yahoo.it  Mon Apr 16 23:19:02 2007
From: massimodisasha at yahoo.it (Massimo Di Stefano)
Date: Mon, 16 Apr 2007 23:19:02 +0200
Subject: [R-sig-Geo] cluster update
Message-ID: <3C08E9E3-743E-410E-985C-BAE2BFF9F06C@yahoo.it>

hi,

to day after the packages update, i tried to load the cluster package...
but it give me this error :

 > library(cluster)
Errore in lazyLoadDBfetch(key, datafile, compressed, envhook) :
	errore interno in R_decompress1
Errore: caricamento pacchetto/namespace fallito per 'cluster'
 >

i've also tried to reinstall itr but without succes.

i'm on osx using the latest R binbary version.
thanks for any suggestion!



From epiesasha at yahoo.it  Mon Apr 16 23:29:24 2007
From: epiesasha at yahoo.it (epifanio)
Date: Mon, 16 Apr 2007 23:29:24 +0200
Subject: [R-sig-Geo] cluster update
In-Reply-To: <3C08E9E3-743E-410E-985C-BAE2BFF9F06C@yahoo.it>
References: <3C08E9E3-743E-410E-985C-BAE2BFF9F06C@yahoo.it>
Message-ID: <381B85DB-E508-4F38-9CFF-7F76ED2B5104@yahoo.it>

i fix it,

strange question....
simpli i  reboot ... and it now works !


Il giorno 16/apr/07, alle ore 23:19, Massimo Di Stefano ha scritto:

> hi,
>
> to day after the packages update, i tried to load the cluster  
> package...
> but it give me this error :
>
> > library(cluster)
> Errore in lazyLoadDBfetch(key, datafile, compressed, envhook) :
> 	errore interno in R_decompress1
> Errore: caricamento pacchetto/namespace fallito per 'cluster'
> >
>
> i've also tried to reinstall itr but without succes.
>
> i'm on osx using the latest R binbary version.
> thanks for any suggestion!



From ramos.grad.student at gmail.com  Tue Apr 17 22:20:49 2007
From: ramos.grad.student at gmail.com (Antonio Ramos)
Date: Tue, 17 Apr 2007 17:20:49 -0300
Subject: [R-sig-Geo] problems with read.gwt2nb function
Message-ID: <191577b80704171320m1de2a494n7ecdc5519de1004f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070417/d21d3a0b/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 18 06:22:30 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 Apr 2007 06:22:30 +0200 (CEST)
Subject: [R-sig-Geo] problems with read.gwt2nb function
In-Reply-To: <191577b80704171320m1de2a494n7ecdc5519de1004f@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0704180612300.10740-100000@reclus.nhh.no>

On Tue, 17 Apr 2007, Antonio Ramos wrote:

> Hi everybody,
> 
> 
> 
> I'm using Geoda and R in order to calculate Moran I test for my data. I use
> GeoDa to create my spatial weight and then R to run a code that allows me
> calculate several Moran I test for different attributes of my data at once,
> avoiding  tedious repetition. However it seems that the very same code that
> worked pretty good for .gal files is not working for .gwt files. In fact,
> there is a warning message after the read.gwt2nb command, but I cannot
> figure it out. Does anybody can shed any light?

I believe that you should pay attention to the warning. Please run the 
example for the function. If you do not see the same issues there, you 
will need to look carefully at your GWT file, which may not be what you 
think. It is a text file, so is easy to examine. Please also try to 
provide access to the GWT file, if you think that it does contain what you 
think. At least some regions seem to have no neighbours.

Roger

> 
> > library(spdep)
> > #write de zero's matrix where the final results will be written.
> > ba.gwt.results <- matrix(0,nrow=39,ncol=5)
> > n <- nrow(ba.gwt.results)
> > ba <- read.csv(file = "d:/BrasilDep2006/BA BASE PRONTA/ba_base_toda.csv",
> header=T)
> > ba.gwt.nb <- (file = "d:/BrasilDep2006/BA BASE PRONTA/ba.gwt")
> > ba.gwt.nb <- read.gwt2nb(ba.gwt.nb)
> Warning messages:
> 1: region.id not named ID_ in: read.gwt2nb(ba.gwt.nb)
> 
> 2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
> 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58,
> 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
> 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96,
> 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112,
> 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
> 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
> 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,
> 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
> 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187,
> 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202,
> 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217,
> 218, 219, 220, 221, 22 in: read.gwt2nb(ba.gwt.nb)
> 
> 3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
> 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58,
> 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
> 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96,
> 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112,
> 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
> 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
> 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,
> 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
> 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187,
> 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202,
> 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217,
> 218, 219, 220, 221, 22 in: read.gwt2nb(ba.gwt.nb)
> 
> >
> 
> >
> 
> > #Alternatively, one may use the funcion "read.gwt2nb",
> 
> > # from the same library (spdep) to read .gwt objects.
> 
> >
> 
> > #Create my weight?s matrix:
> 
> > ba.gwt.listw <- nb2listw(ba.gwt.nb, style="W")
> 
> Error in nb2listw(ba.gwt.nb, style = "W") :
> 
>         Empty neighbour sets found
> 
> >
> 
> > for(i in 1:n)
> 
> + {
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$statistic->ba.gwt.results[i,1]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[1]->ba.gwt.results[i,2]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[2]->ba.gwt.results[i,3]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[3]->ba.gwt.results[i,4]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$p.value->ba.gwt.results[i,5]
> 
> + }
> 
> Error in inherits(listw, "listw") : object "ba.gwt.listw" not found
> 
> >
> 
> 
> 
> Thank you very much,
> 
> 
> 
> Antonio Pedro Ramos.
> 
> 	[[alternative HTML version deleted]]
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ramos.grad.student at gmail.com  Wed Apr 18 16:42:32 2007
From: ramos.grad.student at gmail.com (Antonio Ramos)
Date: Wed, 18 Apr 2007 11:42:32 -0300
Subject: [R-sig-Geo] problems with read.gwt2nb function
In-Reply-To: <Pine.LNX.4.44.0704180612300.10740-100000@reclus.nhh.no>
References: <191577b80704171320m1de2a494n7ecdc5519de1004f@mail.gmail.com>
	<Pine.LNX.4.44.0704180612300.10740-100000@reclus.nhh.no>
Message-ID: <191577b80704180742x7b27938as490b00839bd6595@mail.gmail.com>

Hi Roger,


I believe that you should pay attention to the warning. Please run the
> example for the function.


I already did it but it seems there is similar problems:

> ?read.gwt2nb
> data(baltimore)
> STATION <- baltimore$STATION
> gwt1 <- read.gwt2nb(system.file("etc/weights/baltk4.GWT",
package="spdep")[1],
+  STATION)
Warning message:
102, 115, 208 are not destinations in:
read.gwt2nb(system.file("etc/weights/baltk4.GWT",
package = "spdep")[1],
> cat(paste("Neighbours list symmetry;", is.symmetric.nb(gwt1, FALSE, TRUE),
+  "\n"))
Neighbours list symmetry; FALSE
> listw1 <- nb2listw(gwt1, style="B", glist=attr(gwt1, "GeoDa")$dist)
> tmpGWT <- tempfile()
> write.sn2gwt(listw2sn(listw1), tmpGWT)
> gwt2 <- read.gwt2nb(tmpGWT, STATION)
Warning message:
102, 115, 208 are not destinations in: read.gwt2nb(tmpGWT, STATION)
> cat(paste("Neighbours list symmetry;", is.symmetric.nb(gwt2, FALSE, TRUE),
+  "\n"))
Neighbours list symmetry; FALSE
> diffnb(gwt1, gwt2)
Neighbour list object:
Number of regions: 211
Number of nonzero links: 0
Percentage nonzero weights: 0
Average number of links: 0
211 regions with no links:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53
54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78
79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102
103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121
122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140
141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159
160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178
179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
198 199 200 201 202 203 204 205 206 207 208 209 210 211
> data(oldcol)
> tmpMAT <- tempfile()



If you do not see the same issues there, you
> will need to look carefully at your GWT file, which may not be what you
> think.It is a text file, so is easy to examine. Please also try to
> provide access to the GWT file, if you think that it does contain what you
> think.

I also did it but I see no problem with my gwt file (made via Geoda):

0 417 ba_base_toda ID_
291110 290320         1.14838787
291110 292620         1.20007809
291110 292840         1.26206315
291110 291955         1.39205921
291110 290140         1.54464659
291110 292045          1.7405391
291110 290740         1.81707945
291110 290940         1.83009167
290320 292620        0.466408625
290320 291955        0.650969045
290320 290140        0.757652243
290320 290740        0.890575291
290320 292890        0.912077132

 Attached to this email there is the whole file.

At least some regions seem to have no neighbours.


Since I use the option k-nearest neighbors in GeoDa, it is impossible there
is regions without neighbours in this .gwt file.

Any second thoughts?

Help and advice really appreciated,

Antonio.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070418/f635846a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ba.GWT
Type: application/octet-stream
Size: 113447 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070418/f635846a/attachment.obj>

From Roger.Bivand at nhh.no  Wed Apr 18 21:18:59 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 Apr 2007 21:18:59 +0200 (CEST)
Subject: [R-sig-Geo] problems with read.gwt2nb function
In-Reply-To: <191577b80704180742x7b27938as490b00839bd6595@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0704182114490.10920-100000@reclus.nhh.no>

On Wed, 18 Apr 2007, Antonio Ramos wrote:

> Hi Roger,
> 
> 
> I believe that you should pay attention to the warning. Please run the
> > example for the function.

I think this gets you there - you have to give the IDs as the region.id=
argument, otherwise the function is looking for a sequence 1:417:

ba0 <- read.table("ba.GWT", header=FALSE, skip=1)
str(ba0)
ID_ <- unique(ba0$V1)
ba <- read.gwt2nb("ba.GWT", region.id=ID_)
ba

Roger

> 
> 
> I already did it but it seems there is similar problems:
> 
> > ?read.gwt2nb
> > data(baltimore)
> > STATION <- baltimore$STATION
> > gwt1 <- read.gwt2nb(system.file("etc/weights/baltk4.GWT",
> package="spdep")[1],
> +  STATION)
> Warning message:
> 102, 115, 208 are not destinations in:
> read.gwt2nb(system.file("etc/weights/baltk4.GWT",
> package = "spdep")[1],
> > cat(paste("Neighbours list symmetry;", is.symmetric.nb(gwt1, FALSE, TRUE),
> +  "\n"))
> Neighbours list symmetry; FALSE
> > listw1 <- nb2listw(gwt1, style="B", glist=attr(gwt1, "GeoDa")$dist)
> > tmpGWT <- tempfile()
> > write.sn2gwt(listw2sn(listw1), tmpGWT)
> > gwt2 <- read.gwt2nb(tmpGWT, STATION)
> Warning message:
> 102, 115, 208 are not destinations in: read.gwt2nb(tmpGWT, STATION)
> > cat(paste("Neighbours list symmetry;", is.symmetric.nb(gwt2, FALSE, TRUE),
> +  "\n"))
> Neighbours list symmetry; FALSE
> > diffnb(gwt1, gwt2)
> Neighbour list object:
> Number of regions: 211
> Number of nonzero links: 0
> Percentage nonzero weights: 0
> Average number of links: 0
> 211 regions with no links:
> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
> 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53
> 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78
> 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102
> 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121
> 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140
> 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159
> 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178
> 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
> 198 199 200 201 202 203 204 205 206 207 208 209 210 211
> > data(oldcol)
> > tmpMAT <- tempfile()
> 
> 
> 
> If you do not see the same issues there, you
> > will need to look carefully at your GWT file, which may not be what you
> > think.It is a text file, so is easy to examine. Please also try to
> > provide access to the GWT file, if you think that it does contain what you
> > think.
> 
> I also did it but I see no problem with my gwt file (made via Geoda):
> 
> 0 417 ba_base_toda ID_
> 291110 290320         1.14838787
> 291110 292620         1.20007809
> 291110 292840         1.26206315
> 291110 291955         1.39205921
> 291110 290140         1.54464659
> 291110 292045          1.7405391
> 291110 290740         1.81707945
> 291110 290940         1.83009167
> 290320 292620        0.466408625
> 290320 291955        0.650969045
> 290320 290140        0.757652243
> 290320 290740        0.890575291
> 290320 292890        0.912077132
> 
>  Attached to this email there is the whole file.
> 
> At least some regions seem to have no neighbours.
> 
> 
> Since I use the option k-nearest neighbors in GeoDa, it is impossible there
> is regions without neighbours in this .gwt file.
> 
> Any second thoughts?
> 
> Help and advice really appreciated,
> 
> Antonio.
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From wl at eimb.ru  Thu Apr 19 11:50:55 2007
From: wl at eimb.ru (Vladimir Eremeev)
Date: Thu, 19 Apr 2007 13:50:55 +0400
Subject: [R-sig-Geo] is it possible to resample a raster image?
Message-ID: <1171976780.20070419135055@eimb.ru>

Dear all,

I am studying new knowledge areas now.

I am curious, if it is possible to transform a projected raster image
to another geographic projection using R packages.

For example, I have a matrix (representing an image)
It has 304 columns by 448 rows.
Initially it is stored in a file, having 2 bytes per pixel.
Lots of such images can be found here
ftp://sidads.colorado.edu/pub/DATASETS/brightness-temperatures/polar-stereo/ssmi/north/2006/

I import one of them in R:

tb.mtx<-matrix(readBin("ftp://sidads.colorado.edu/pub/DATASETS/brightness-temperatures/polar-stereo/ssmi/north/2006/tb_f13_20060101_v2_n19h.bin",
                       "integer",n=304*448,size=2),
               ncol=304,byrow=TRUE)

Then I create the SpatialGridDataFrame:

egrid<-cbind(expand.grid(x=seq(-3850000.0000000,3725000.0000000,by=25000),
                         y=seq(-5350000.0000000,5825000,by=25000)),
             as.vector(t(tb.mtx)[,448:1]))

coordinates(egrid)<-c("x","y")
gridded(egrid)<-TRUE
proj4string(egrid)<-CRS("+proj=stere +lat_0=90 +lat_ts=70 +lon_0=-45 +ellps=clrk66")

I have worked with these data using other tools for a long time
already, therefore, I know about their projection and dimensions.
These are documented in the web and also in `readme` files.

Now I would like to *use R-spatial packages* to transform egrid to another projection,
and export the result into an external flat binary file, similar to
the one, I have imported with readBin.

I can easily do it using other tool sets, however, now I am exploring
R.
Is it possible?

I tried the following, however, got errors.
> egtr<-spTransform(egrid,CRS("+proj=latlong"))
> gridded(egtr)<-TRUE

Error in if (any(outside)) { : missing value where TRUE/FALSE needed
In addition: Warning messages:
1: grid has empty column/rows in dimension 1 in: points2grid(points, tolerance) 
2: NAs introduced by coercion 
3: grid has empty column/rows in dimension 2 in: points2grid(points, tolerance) 
4: NAs introduced by coercion 

> fullgrid(egtr)<-TRUE
Error in `fullgrid<-`(`*tmp*`, value = TRUE) : 
        fullgrid<- only works on objects of class or extending SpatialPixels


Thank you!


---
Best regards,
Vladimir                mailto:wl at eimb.ru



--SevinMail--



From Roger.Bivand at nhh.no  Thu Apr 19 13:27:45 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 19 Apr 2007 13:27:45 +0200 (CEST)
Subject: [R-sig-Geo] is it possible to resample a raster image?
In-Reply-To: <1171976780.20070419135055@eimb.ru>
Message-ID: <Pine.LNX.4.44.0704191312320.13025-100000@reclus.nhh.no>

On Thu, 19 Apr 2007, Vladimir Eremeev wrote:

> Dear all,
> 
> I am studying new knowledge areas now.
> 
> I am curious, if it is possible to transform a projected raster image
> to another geographic projection using R packages.

There is no warping functionality as such, so as you see below, the output
data is not in a regular grid. You need to make your "+proj=longlat" (not
"latlong" - that may reverse the understanding of the coordinates)  
SpatialGrid first, extract its coordinates(), spTransform() them to the
input projection - now a SpatialPoints object. Next, interpolate from the
input grid to the new points, and finally either project back to "longlat"
- which will be a rectangular grid, or just insert the interpolated values
as the data= argument into a SpatialGridDataFrame using the "longlat"  
GridTopology created earlier.

Using GridTopology() and coordinates(), you could get round the 
expand.grid() step. For interpolation, IDW in gstat with a tight 
neighbourhood, or maybe splines in interp or field ought to be OK, or some 
other resampling trick (k=1 nearest neighbour for categorical variables?).

Hope this helps,

Roger

> 
> For example, I have a matrix (representing an image)
> It has 304 columns by 448 rows.
> Initially it is stored in a file, having 2 bytes per pixel.
> Lots of such images can be found here
> ftp://sidads.colorado.edu/pub/DATASETS/brightness-temperatures/
> polar-stereo/ssmi/north/2006/
> 
> I import one of them in R:
> 
> tb.mtx<-matrix(readBin("ftp://sidads.colorado.edu/pub/DATASETS/brightness-temperatures/polar-stereo/ssmi/north/2006/tb_f13_20060101_v2_n19h.bin",
>                        "integer",n=304*448,size=2),
>                ncol=304,byrow=TRUE)
> 
> Then I create the SpatialGridDataFrame:
> 
> egrid<-cbind(expand.grid(x=seq(-3850000.0000000,3725000.0000000,by=25000),
>                          y=seq(-5350000.0000000,5825000,by=25000)),
>              as.vector(t(tb.mtx)[,448:1]))
> 
> coordinates(egrid)<-c("x","y")
> gridded(egrid)<-TRUE
> proj4string(egrid)<-CRS("+proj=stere +lat_0=90 +lat_ts=70 +lon_0=-45 +ellps=clrk66")
> 
> I have worked with these data using other tools for a long time
> already, therefore, I know about their projection and dimensions.
> These are documented in the web and also in `readme` files.
> 
> Now I would like to *use R-spatial packages* to transform egrid to another projection,
> and export the result into an external flat binary file, similar to
> the one, I have imported with readBin.
> 
> I can easily do it using other tool sets, however, now I am exploring
> R.
> Is it possible?
> 
> I tried the following, however, got errors.
> > egtr<-spTransform(egrid,CRS("+proj=latlong"))
> > gridded(egtr)<-TRUE
> 
> Error in if (any(outside)) { : missing value where TRUE/FALSE needed
> In addition: Warning messages:
> 1: grid has empty column/rows in dimension 1 in: points2grid(points, tolerance) 
> 2: NAs introduced by coercion 
> 3: grid has empty column/rows in dimension 2 in: points2grid(points, tolerance) 
> 4: NAs introduced by coercion 
> 
> > fullgrid(egtr)<-TRUE
> Error in `fullgrid<-`(`*tmp*`, value = TRUE) : 
>         fullgrid<- only works on objects of class or extending SpatialPixels
> 
> 
> Thank you!
> 
> 
> ---
> Best regards,
> Vladimir                mailto:wl at eimb.ru
> 
> 
> 
> --SevinMail--
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkobayas at indiana.edu  Fri Apr 20 07:07:45 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Fri, 20 Apr 2007 01:07:45 -0400
Subject: [R-sig-Geo] Map projectin for Europe...
Message-ID: <46284AA1.9090005@indiana.edu>

Hi,

I has a meteorology project in which I have to map average wind speeds 
over EU, as well as European countries' boundary. I have been looking 
online for free European maps like the one I can find on US Census for 
N. America. But it seems like google doesn't hit anything useful. I 
wonder if some Rusers from Europe might know where I could find free EU 
map with each country's boundary.

Just a few quick questions:

About the best or appropriate projection for Europe, I am thinking to 
use lambert conformal conic or lambert azimuthal equal area. Are these 
good for Europe? My colleague uses the latter lambert for N. America 
mapping.

About plotting a map boundary, if I do not rely on mapproj and shapefile 
library, simply using plot() or xyplot() gave me a disatrerous map, 
where points are not sequentially connected at all.. I believe I would 
have to add some kinds of flags to the boundary dataset.

Could anyone kindly give me advice on these problems although I have 
never changed map projections in R, but I will look into mapproj library 
as a start?

Thanks in advance.

taka



From dujuan at stt.msu.edu  Fri Apr 20 06:06:06 2007
From: dujuan at stt.msu.edu (Juan Du)
Date: Fri, 20 Apr 2007 00:06:06 -0400
Subject: [R-sig-Geo] Kernel smoothing for multivariate observations
Message-ID: <B130A91CAE960240AD7FA52EB156C82E01D1D93070@exchange.sttwin.stt.msu.edu>

Hello,

May I ask if there is a R-code to generate the kernel density estimates in fields?  I need to estimate the surface with "epanechnikov" kernel for multidimensional data, but all I can find is the intensity estimation for point pattern which is different. Your answer are highly appreciated!

Thanks!

Sincerely yours,

Juan



From Roger.Bivand at nhh.no  Fri Apr 20 06:21:14 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Apr 2007 06:21:14 +0200 (CEST)
Subject: [R-sig-Geo] Map projectin for Europe...
In-Reply-To: <46284AA1.9090005@indiana.edu>
Message-ID: <Pine.LNX.4.44.0704200534140.13673-100000@reclus.nhh.no>

On Fri, 20 Apr 2007, Takatsugu Kobayashi wrote:

> Hi,
> 
> I has a meteorology project in which I have to map average wind speeds 
> over EU, as well as European countries' boundary. I have been looking 
> online for free European maps like the one I can find on US Census for 
> N. America. But it seems like google doesn't hit anything useful. I 
> wonder if some Rusers from Europe might know where I could find free EU 
> map with each country's boundary.
> 

Here is a link to the world map with country boundaries which was 
discussed on the list in September last year, updated for R >= 2.4.

http://spatial.nhh.no/R/etc/world_countries_24.rda

load("world_countries_24.rda")

You'll need to subset the object to choose the countries of Europe that 
you require, then use the spTransform() method in rgdal to go to the 
standard EU Lambert AEA:

CRS("+init=epsg:3035")

Hope this helps,

Roger


> Just a few quick questions:
> 
> About the best or appropriate projection for Europe, I am thinking to 
> use lambert conformal conic or lambert azimuthal equal area. Are these 
> good for Europe? My colleague uses the latter lambert for N. America 
> mapping.
> 
> About plotting a map boundary, if I do not rely on mapproj and shapefile 
> library, simply using plot() or xyplot() gave me a disatrerous map, 
> where points are not sequentially connected at all.. I believe I would 
> have to add some kinds of flags to the boundary dataset.
> 
> Could anyone kindly give me advice on these problems although I have 
> never changed map projections in R, but I will look into mapproj library 
> as a start?
> 
> Thanks in advance.
> 
> taka
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Apr 20 09:16:58 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Apr 2007 08:16:58 +0100
Subject: [R-sig-Geo] [Openspace] Re:  problems with read.gwt2nb function
In-Reply-To: <191577b80704171320m1de2a494n7ecdc5519de1004f@mail.gmail.com>
Message-ID: <006a01c7831b$e21c4e50$0210a8c0@Geofutures.local>

On Tue, 17 Apr 2007, Antonio Ramos wrote:

> Hi everybody,
> 
> 
> 
> I'm using Geoda and R in order to calculate Moran I test for my data. I use
> GeoDa to create my spatial weight and then R to run a code that allows me
> calculate several Moran I test for different attributes of my data at once,
> avoiding  tedious repetition. However it seems that the very same code that
> worked pretty good for .gal files is not working for .gwt files. In fact,
> there is a warning message after the read.gwt2nb command, but I cannot
> figure it out. Does anybody can shed any light?

I believe that you should pay attention to the warning. Please run the 
example for the function. If you do not see the same issues there, you 
will need to look carefully at your GWT file, which may not be what you 
think. It is a text file, so is easy to examine. Please also try to 
provide access to the GWT file, if you think that it does contain what you 
think. At least some regions seem to have no neighbours.

Roger

> 
> > library(spdep)
> > #write de zero's matrix where the final results will be written.
> > ba.gwt.results <- matrix(0,nrow=39,ncol=5)
> > n <- nrow(ba.gwt.results)
> > ba <- read.csv(file = "d:/BrasilDep2006/BA BASE PRONTA/ba_base_toda.csv",
> header=T)
> > ba.gwt.nb <- (file = "d:/BrasilDep2006/BA BASE PRONTA/ba.gwt")
> > ba.gwt.nb <- read.gwt2nb(ba.gwt.nb)
> Warning messages:
> 1: region.id not named ID_ in: read.gwt2nb(ba.gwt.nb)
> 
> 2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
> 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58,
> 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
> 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96,
> 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112,
> 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
> 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
> 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,
> 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
> 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187,
> 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202,
> 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217,
> 218, 219, 220, 221, 22 in: read.gwt2nb(ba.gwt.nb)
> 
> 3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
> 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58,
> 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
> 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96,
> 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112,
> 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
> 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
> 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,
> 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
> 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187,
> 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202,
> 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217,
> 218, 219, 220, 221, 22 in: read.gwt2nb(ba.gwt.nb)
> 
> >
> 
> >
> 
> > #Alternatively, one may use the funcion "read.gwt2nb",
> 
> > # from the same library (spdep) to read .gwt objects.
> 
> >
> 
> > #Create my weight?s matrix:
> 
> > ba.gwt.listw <- nb2listw(ba.gwt.nb, style="W")
> 
> Error in nb2listw(ba.gwt.nb, style = "W") :
> 
>         Empty neighbour sets found
> 
> >
> 
> > for(i in 1:n)
> 
> + {
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$statistic->ba.gwt.results[i,1]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[1]->ba.gwt.results[i,2]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[2]->ba.gwt.results[i,3]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$estimate[3]->ba.gwt.results[i,4]
> 
> + moran.test(ba[,i+2],ba.gwt.listw)$p.value->ba.gwt.results[i,5]
> 
> + }
> 
> Error in inherits(listw, "listw") : object "ba.gwt.listw" not found
> 
> >
> 
> 
> 
> Thank you very much,
> 
> 
> 
> Antonio Pedro Ramos.
> 
> 	[[alternative HTML version deleted]]
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
Openspace mailing list
Openspace at sal.uiuc.edu
http://sal.uiuc.edu/mailman/listinfo/openspace



From mreisman at wu-wien.ac.at  Fri Apr 20 13:10:47 2007
From: mreisman at wu-wien.ac.at (mreisman at wu-wien.ac.at)
Date: Fri, 20 Apr 2007 13:10:47 +0200
Subject: [R-sig-Geo] spdep: From matrix to listw
Message-ID: <1177067447.46289fb765106@webmail.wu-wien.ac.at>

Dear colleagues,

Is there any quick way for converting from R-matrix to listw-object of style 'W'
(row-standardized)? 
I tried mat2listw but the result is style 'M' (which is not what I need).
I also wrote my own GAL-file writer and went through read.gal and nb2listw
(much to slow).

Any suggestions?

Regards,
Martin Reismann

-- 
Martin Reismann
c/o
Institut fuer Wirtschaftsgeographie und Geoinformatik
Wirtschaftsuniversitaet Wien
Nordbergstrasse 15, 4. Stock, Kern A
A-1090 Wien

EMail: Martin.Reismann at wu-wien.ac.at
Tel +43-(0)-1-31336-5720
Fax +43-(0)-1-31336-703



From Roger.Bivand at nhh.no  Fri Apr 20 15:47:59 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Apr 2007 15:47:59 +0200 (CEST)
Subject: [R-sig-Geo] spdep: From matrix to listw
In-Reply-To: <1177067447.46289fb765106@webmail.wu-wien.ac.at>
Message-ID: <Pine.LNX.4.44.0704201535510.13804-100000@reclus.nhh.no>

On Fri, 20 Apr 2007 mreisman at wu-wien.ac.at wrote:

> Dear colleagues,
> 
> Is there any quick way for converting from R-matrix to listw-object of style 'W'
> (row-standardized)? 

What is your R-matrix? mat2listw() assigns style "M" because it does not 
know what the user has put in the input matrix. If you know that the row 
sums are all unity, you could just overwite the object's style:

library(spdep)
data(columbus)
lw <- nb2listw(col.gal.nb, style="W")
lw$style
all(sapply(lw$weights, sum) == 1)
m <- listw2mat(lw)
all(apply(m, 1, sum) == 1)
lw1 <- mat2listw(m)
lw1$style
all(sapply(lw1$weights, sum) == 1)
lw1$style <- "W"

Roger

> I tried mat2listw but the result is style 'M' (which is not what I need).
> I also wrote my own GAL-file writer and went through read.gal and nb2listw
> (much to slow).
> 
> Any suggestions?
> 
> Regards,
> Martin Reismann
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkobayas at indiana.edu  Fri Apr 20 22:43:50 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Fri, 20 Apr 2007 16:43:50 -0400
Subject: [R-sig-Geo] Map projectin for Europe...
In-Reply-To: <Pine.LNX.4.44.0704200534140.13673-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0704200534140.13673-100000@reclus.nhh.no>
Message-ID: <46292606.6030703@indiana.edu>

Dr. Bivand:

For clipping the countries I need for my project, I am not very familiar 
with class/object structure in R... So I borrowed "S programming" from 
the school library and started to read it to know more about it.

Eventually I would like to export the resulting European map into .shp. 
To do that,

# import world map into R
wmap<-load("world_countries_24.rda")

# clip the European countries I need one by one
spain<-wmap[[64]]
....
....

Then, as I mentioned previously, I am at a loss at this moment for not knowing how to clip countries under class/object structure...

Sorry for this R-geo newbie question....

Thank you very much while you must be busy at AAG.

Best regards,

Taka

Roger Bivand wrote:
> On Fri, 20 Apr 2007, Takatsugu Kobayashi wrote:
>
>   
>> Hi,
>>
>> I has a meteorology project in which I have to map average wind speeds 
>> over EU, as well as European countries' boundary. I have been looking 
>> online for free European maps like the one I can find on US Census for 
>> N. America. But it seems like google doesn't hit anything useful. I 
>> wonder if some Rusers from Europe might know where I could find free EU 
>> map with each country's boundary.
>>
>>     
>
> Here is a link to the world map with country boundaries which was 
> discussed on the list in September last year, updated for R >= 2.4.
>
> http://spatial.nhh.no/R/etc/world_countries_24.rda
>
> load("world_countries_24.rda")
>
> You'll need to subset the object to choose the countries of Europe that 
> you require, then use the spTransform() method in rgdal to go to the 
> standard EU Lambert AEA:
>
> CRS("+init=epsg:3035")
>
> Hope this helps,
>
> Roger
>
>
>   
>> Just a few quick questions:
>>
>> About the best or appropriate projection for Europe, I am thinking to 
>> use lambert conformal conic or lambert azimuthal equal area. Are these 
>> good for Europe? My colleague uses the latter lambert for N. America 
>> mapping.
>>
>> About plotting a map boundary, if I do not rely on mapproj and shapefile 
>> library, simply using plot() or xyplot() gave me a disatrerous map, 
>> where points are not sequentially connected at all.. I believe I would 
>> have to add some kinds of flags to the boundary dataset.
>>
>> Could anyone kindly give me advice on these problems although I have 
>> never changed map projections in R, but I will look into mapproj library 
>> as a start?
>>
>> Thanks in advance.
>>
>> taka
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>



From Roger.Bivand at nhh.no  Sat Apr 21 02:26:11 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 21 Apr 2007 02:26:11 +0200 (CEST)
Subject: [R-sig-Geo] Map projectin for Europe...
In-Reply-To: <46292606.6030703@indiana.edu>
Message-ID: <Pine.LNX.4.44.0704210213070.13910-100000@reclus.nhh.no>

On Fri, 20 Apr 2007, Takatsugu Kobayashi wrote:

> Dr. Bivand:
> 
> For clipping the countries I need for my project, I am not very familiar 
> with class/object structure in R... So I borrowed "S programming" from 
> the school library and started to read it to know more about it.
> 
> Eventually I would like to export the resulting European map into .shp. 
> To do that,
> 
> # import world map into R
> wmap<-load("world_countries_24.rda")

load("world_countries_24.rda")

loads the object world_countries, your wmap just contains its name as a 
text string.

> 
> # clip the European countries I need one by one
> spain<-wmap[[64]]

library(rgdal)
names(world_countries)
world_countries$names
spain <- world_countries[world_countries$names == "SPAIN", ]
plot(spain)
writeOGR(spain, dsn=".", layer="spain", driver="ESRI Shapefile")

should get you there - since the "[[" operator has a slightly different 
meaning. The spatial objects were described in a note written with Edzer 
Pebesma in R News in 2005, so now a little dated. Getting just mainland 
Spain is also possible.

Roger

> ....
> ....
> 
> Then, as I mentioned previously, I am at a loss at this moment for not knowing how to clip countries under class/object structure...
> 
> Sorry for this R-geo newbie question....
> 
> Thank you very much while you must be busy at AAG.
> 
> Best regards,
> 
> Taka
> 
> Roger Bivand wrote:
> > On Fri, 20 Apr 2007, Takatsugu Kobayashi wrote:
> >
> >   
> >> Hi,
> >>
> >> I has a meteorology project in which I have to map average wind speeds 
> >> over EU, as well as European countries' boundary. I have been looking 
> >> online for free European maps like the one I can find on US Census for 
> >> N. America. But it seems like google doesn't hit anything useful. I 
> >> wonder if some Rusers from Europe might know where I could find free EU 
> >> map with each country's boundary.
> >>
> >>     
> >
> > Here is a link to the world map with country boundaries which was 
> > discussed on the list in September last year, updated for R >= 2.4.
> >
> > http://spatial.nhh.no/R/etc/world_countries_24.rda
> >
> > load("world_countries_24.rda")
> >
> > You'll need to subset the object to choose the countries of Europe that 
> > you require, then use the spTransform() method in rgdal to go to the 
> > standard EU Lambert AEA:
> >
> > CRS("+init=epsg:3035")
> >
> > Hope this helps,
> >
> > Roger
> >
> >
> >   
> >> Just a few quick questions:
> >>
> >> About the best or appropriate projection for Europe, I am thinking to 
> >> use lambert conformal conic or lambert azimuthal equal area. Are these 
> >> good for Europe? My colleague uses the latter lambert for N. America 
> >> mapping.
> >>
> >> About plotting a map boundary, if I do not rely on mapproj and shapefile 
> >> library, simply using plot() or xyplot() gave me a disatrerous map, 
> >> where points are not sequentially connected at all.. I believe I would 
> >> have to add some kinds of flags to the boundary dataset.
> >>
> >> Could anyone kindly give me advice on these problems although I have 
> >> never changed map projections in R, but I will look into mapproj library 
> >> as a start?
> >>
> >> Thanks in advance.
> >>
> >> taka
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>     
> >
> >   
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkobayas at indiana.edu  Sun Apr 22 07:43:45 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Sun, 22 Apr 2007 14:43:45 +0900
Subject: [R-sig-Geo] re; Any good book for R spatial stats?
Message-ID: <462AF611.30500@indiana.edu>

Hi

I wonder if there are nice books for spatial analysis in R, in addition
to reading R news, Journal of Computers and Geosciences, and Gnu
manuals, etc. Eventually I would like to be capable of doing research
using R-spatial packages and R-GRASS. My PC platform is RHEL Client 5.
ArcGis is still sometimes resource-intensive althought I use dual core
AMD and 4GB RAM...... I assume that R-GRASS uses less resources.....

Thanks for book suggestions in advance.

Taka



From yong.li at unimelb.edu.au  Tue Apr 24 06:44:27 2007
From: yong.li at unimelb.edu.au (Yong Li)
Date: Tue, 24 Apr 2007 14:44:27 +1000
Subject: [R-sig-Geo] How to remove the second order trend in gstat?
Message-ID: <6.2.5.6.2.20070424144144.038d2430@unimelb.edu.au>

Dear all,

I can remove the linear trend by using ~x+y in gstat, but have no 
idea to cope with the second order trend. Any help will be appreciated.

Cheers,

Yong Li



From Thierry.ONKELINX at inbo.be  Tue Apr 24 12:22:33 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 24 Apr 2007 12:22:33 +0200
Subject: [R-sig-Geo] How to remove the second order trend in gstat?
In-Reply-To: <6.2.5.6.2.20070424144144.038d2430@unimelb.edu.au>
Message-ID: <2E9C414912813E4EB981326983E0A10402DE8D81@inboexch.inbo.be>

Have you tried the option "degree = 2" in gstat? ?gstat reads "degree:
order of trend surface in the location, between 0 and 3"

Cheers,

Thierry

PS A working sample of your code makes it be easier to give you
feedback.

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney

 

> -----Oorspronkelijk bericht-----
> Van: Yong Li [mailto:yong.li at unimelb.edu.au] 
> Verzonden: dinsdag 24 april 2007 6:44
> Aan: r-sig-geo at stat.math.ethz.ch
> Onderwerp: [R-sig-Geo] How to remove the second order trend in gstat?
> 
> Dear all,
> 
> I can remove the linear trend by using ~x+y in gstat, but 
> have no idea to cope with the second order trend. Any help 
> will be appreciated.
> 
> Cheers,
> 
> Yong Li
> 
> 
>



From Thierry.ONKELINX at inbo.be  Wed Apr 25 14:54:05 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 25 Apr 2007 14:54:05 +0200
Subject: [R-sig-Geo] Problem with variocloudmap (GeoXp)
Message-ID: <2E9C414912813E4EB981326983E0A10402E52331@inboexch.inbo.be>

Dear listeRs,

I have some trouble with this code.

library("gstat")
data(jura)
library("GeoXp")
outlier.pairs <- variocloudmap(prediction.dat$Xloc, prediction.dat$Yloc,
prediction.dat$Ni)

The strange thing is that it runs fine of my laptop with R 2.4.1. But it
does not work on R 2.5.0. Then I get this message. A colleague gets the
same error with R 2.4.0

Error in dim(data) <- dim : attempt to set an attribute on NULL
> traceback()
4: array(x, c(length(x), 1), if (!is.null(names(x))) list(names(x), 
       NULL) else NULL)
3: as.matrix.default(listvar)
2: as.matrix(listvar)
1: variocloudmap(prediction.dat$Xloc, prediction.dat$Yloc,
prediction.dat$Ni)


Any idea's on what's going wrong?

Thanks,

Thierry





sessionInfo()

R version 2.4.1 (2006-12-18) 
i386-pc-mingw32 

locale:
LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "tcltk"

[7] "methods"   "base"     

other attached packages:
     GeoXp KernSmooth    splancs     fields   maptools    foreign
gstat 
     "1.0"  "2.22-19"  "2.01-22"    "3.3.1"   "0.6-11"   "0.8-18"
"0.9-38" 
        sp       svIO     R2HTML     svMisc   svSocket      svIDE 
  "0.9-13"    "0.9-5"     "1.58"    "0.9-5"    "0.9-5"    "0.9-5"



R version 2.5.0 (2007-04-23) 
i386-pc-mingw32 

locale:
LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252

attached base packages:
[1] "tcltk"     "stats"     "graphics"  "grDevices" "utils"
"datasets" 
[7] "methods"   "base"     

other attached packages:
     GeoXp KernSmooth    splancs     fields   maptools    foreign
gstat 
     "1.0"  "2.22-20"  "2.01-22"    "3.3.1"   "0.6-11"   "0.8-20"
"0.9-38" 
        sp 
  "0.9-13" 



------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney



From borghor at yahoo.ca  Thu Apr 26 22:33:51 2007
From: borghor at yahoo.ca (bertrand toupin)
Date: Thu, 26 Apr 2007 16:33:51 -0400 (EDT)
Subject: [R-sig-Geo] Finding nearest point
In-Reply-To: <45ED61CD.4030307@geo.uu.nl>
Message-ID: <832902.73844.qm@web42201.mail.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070426/928fd391/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 26 22:50:44 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 26 Apr 2007 22:50:44 +0200 (CEST)
Subject: [R-sig-Geo] Finding nearest point
In-Reply-To: <832902.73844.qm@web42201.mail.yahoo.com>
Message-ID: <Pine.LNX.4.44.0704262241200.15509-100000@reclus.nhh.no>

On Thu, 26 Apr 2007, bertrand toupin wrote:

> Hi, I have 2 sets of data points. One is a grid, consisting of 87
> points.  The other is 300 meteorological stations.
> 
> I'd like to chose 10 of the grid points and I'd like to have the nearest
> station for each of my 10 grid-points.

If you have the coordinates of the chosen grid points (10 by 2 matrix) 
then something like lapply(1:10, function(i) spDistsN1(met_coords, 
grd[i,])) will return a 10-long list of 300-long vectors. Then 
sapply(res, function(x) order(x, ...)[1:10]) would get the distances and a 
more complex throw-away function using which() would say which they are. 
These are not checked, but look at the spDistsN1 help page in the sp 
package. It supports geographical coordinates too.

Roger

> 
> Is there a function that does it?
> 
> I have R 2.4.0, with gstat and rgdal installed.
> 
> Thanks a lot!
> 
>        
> ---------------------------------
> 
> ---------------------------------
> Get a sneak peak at messages with a handy reading pane.
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dujuan at stt.msu.edu  Thu Apr 26 23:41:29 2007
From: dujuan at stt.msu.edu (Juan Du)
Date: Thu, 26 Apr 2007 17:41:29 -0400
Subject: [R-sig-Geo] nkreg in the "fields"
Message-ID: <B130A91CAE960240AD7FA52EB156C82E01D1D93072@exchange.sttwin.stt.msu.edu>


Dear R-helpers,

I appreciate it if someone can tell me how to activate tool "nkreg" which seems to be in package "fields". Actually I was not able to see such command in "fields" but find the help page on line
http://www.stat.ucl.ac.be/ISdidactique/Rhelp/library/fields/html/nkreg.html.

I don't know how this discrepancy happens?

Thanks very much for your answer!

Sincerely yours,

Juan






____________________________________
From: r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of r-sig-geo-request at stat.math.ethz.ch [r-sig-geo-request at stat.math.ethz.ch]
Sent: Thursday, April 26, 2007 6:00 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: R-sig-Geo Digest, Vol 44, Issue 19

Send R-sig-Geo mailing list submissions to
        r-sig-geo at stat.math.ethz.ch

To subscribe or unsubscribe via the World Wide Web, visit
        https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
        r-sig-geo-request at stat.math.ethz.ch

You can reach the person managing the list at
        r-sig-geo-owner at stat.math.ethz.ch

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Problem with variocloudmap (GeoXp) (ONKELINX, Thierry)


----------------------------------------------------------------------

Message: 1
Date: Wed, 25 Apr 2007 14:54:05 +0200
From: "ONKELINX, Thierry" <Thierry.ONKELINX at inbo.be>
Subject: [R-sig-Geo] Problem with variocloudmap (GeoXp)
To: <r-sig-geo at stat.math.ethz.ch>
Message-ID:
        <2E9C414912813E4EB981326983E0A10402E52331 at inboexch.inbo.be>
Content-Type: text/plain;       charset="us-ascii"

Dear listeRs,

I have some trouble with this code.

library("gstat")
data(jura)
library("GeoXp")
outlier.pairs <- variocloudmap(prediction.dat$Xloc, prediction.dat$Yloc,
prediction.dat$Ni)

The strange thing is that it runs fine of my laptop with R 2.4.1. But it
does not work on R 2.5.0. Then I get this message. A colleague gets the
same error with R 2.4.0

Error in dim(data) <- dim : attempt to set an attribute on NULL
> traceback()
4: array(x, c(length(x), 1), if (!is.null(names(x))) list(names(x),
       NULL) else NULL)
3: as.matrix.default(listvar)
2: as.matrix(listvar)
1: variocloudmap(prediction.dat$Xloc, prediction.dat$Yloc,
prediction.dat$Ni)


Any idea's on what's going wrong?

Thanks,

Thierry





sessionInfo()

R version 2.4.1 (2006-12-18)
i386-pc-mingw32

locale:
LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "tcltk"

[7] "methods"   "base"

other attached packages:
     GeoXp KernSmooth    splancs     fields   maptools    foreign
gstat
     "1.0"  "2.22-19"  "2.01-22"    "3.3.1"   "0.6-11"   "0.8-18"
"0.9-38"
        sp       svIO     R2HTML     svMisc   svSocket      svIDE
  "0.9-13"    "0.9-5"     "1.58"    "0.9-5"    "0.9-5"    "0.9-5"



R version 2.5.0 (2007-04-23)
i386-pc-mingw32

locale:
LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252

attached base packages:
[1] "tcltk"     "stats"     "graphics"  "grDevices" "utils"
"datasets"
[7] "methods"   "base"

other attached packages:
     GeoXp KernSmooth    splancs     fields   maptools    foreign
gstat
     "1.0"  "2.22-20"  "2.01-22"    "3.3.1"   "0.6-11"   "0.8-20"
"0.9-38"
        sp
  "0.9-13"



------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 44, Issue 19



From e.pebesma at geo.uu.nl  Fri Apr 27 09:12:59 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 27 Apr 2007 09:12:59 +0200
Subject: [R-sig-Geo] nkreg in the "fields"
In-Reply-To: <B130A91CAE960240AD7FA52EB156C82E01D1D93072@exchange.sttwin.stt.msu.edu>
References: <B130A91CAE960240AD7FA52EB156C82E01D1D93072@exchange.sttwin.stt.msu.edu>
Message-ID: <4631A27B.1050401@geo.uu.nl>

Please use the on-line documentation that comes with downloaded package; 
the documentation you used may very well be out of sync with the package 
fields. If you have questions about the docs in the package, you might 
want to ask the package developer.
--
Edzer

Juan Du wrote:
> Dear R-helpers,
>
> I appreciate it if someone can tell me how to activate tool "nkreg" which seems to be in package "fields". Actually I was not able to see such command in "fields" but find the help page on line
> http://www.stat.ucl.ac.be/ISdidactique/Rhelp/library/fields/html/nkreg.html.
>
> I don't know how this discrepancy happens?
>
> Thanks very much for your answer!
>
> Sincerely yours,
>
> Juan
>
>



From Thierry.ONKELINX at inbo.be  Fri Apr 27 10:28:30 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 27 Apr 2007 10:28:30 +0200
Subject: [R-sig-Geo] Reading jpeg and tiff
Message-ID: <2E9C414912813E4EB981326983E0A10402E528E6@inboexch.inbo.be>

Dear useRs,

I'm trying to read jpeg and GeoTiff with readGDAL() (rgdal package). The
jpeg is about 5.6 MB in size, has 3063 rows and 4870 columns and has 3
bands. The tiff is 3.7 MB, has 15750 rows and 12600 colums and 1 band. I
can't import neither of them in R due to a lack of memory. Although I've
set the memory limit to the max (memory.limit(size =
round(memory.limit()/1048576.0, 2))). I'm running R 2.4.1 on a Win Xp
machine with 2 GB RAM.

So far I managed to read in the data but a lower resolution, which I
don't want. Any suggestions on a more efficient way to import these
files. Solutions based on Spatial-classes are prefered.

Here is the code I'm using now.

library(rgdal)
memory.limit(size = round(memory.limit()/1048576.0, 2))
info <- GDALinfo("d://ferraris0894.jpg")
readGDAL("d://ferraris0894.jpg", output.dim = round(c(info[["rows"]],
info[["columns"]]) / 2))


sessionInfo()
R version 2.4.1 (2006-12-18) 
i386-pc-mingw32 

locale:
LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "tcltk"

[7] "methods"   "base"     

other attached packages:
   rgdal       sp     svIO   R2HTML   svMisc svSocket    svIDE 
 "0.5-8" "0.9-13"  "0.9-5"   "1.58"  "0.9-5"  "0.9-5"  "0.9-5"


Thanks,

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney



From Roger.Bivand at nhh.no  Fri Apr 27 12:31:46 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 Apr 2007 12:31:46 +0200 (CEST)
Subject: [R-sig-Geo] Reading jpeg and tiff
In-Reply-To: <2E9C414912813E4EB981326983E0A10402E528E6@inboexch.inbo.be>
Message-ID: <Pine.LNX.4.44.0704271222380.16144-100000@reclus.nhh.no>

On Fri, 27 Apr 2007, ONKELINX, Thierry wrote:

> Dear useRs,
> 
> I'm trying to read jpeg and GeoTiff with readGDAL() (rgdal package). The
> jpeg is about 5.6 MB in size, has 3063 rows and 4870 columns and has 3
> bands. The tiff is 3.7 MB, has 15750 rows and 12600 colums and 1 band. I
> can't import neither of them in R due to a lack of memory. Although I've
> set the memory limit to the max (memory.limit(size =
> round(memory.limit()/1048576.0, 2))). I'm running R 2.4.1 on a Win Xp
> machine with 2 GB RAM.
> 
> So far I managed to read in the data but a lower resolution, which I
> don't want. Any suggestions on a more efficient way to import these
> files. Solutions based on Spatial-classes are prefered.
> 
> Here is the code I'm using now.
> 
> library(rgdal)
> memory.limit(size = round(memory.limit()/1048576.0, 2))
> info <- GDALinfo("d://ferraris0894.jpg")
> readGDAL("d://ferraris0894.jpg", output.dim = round(c(info[["rows"]],
> info[["columns"]]) / 2))
> 

The usual way to handle things is in tiles, using GDALopen() and then 
accessing subsets in turn from the handle. The same can be done with 
readGDAL(). Remember that tiffs and jpegs are highly compressed, your tiff 
will be 800MB for integer or 1.6GB for double mode, while the underlying 
data are almost certainly 0-255 byte values. If you would like to look, 
the code in gdal-bindings.cpp pre-dates R's raw classes, but since raw 
doesn't really have operators, you'd end up casting at least to integer. 
The real question is what you want to do with the data, and whether you 
can tile it or adapt the flow of analysis.

Roger

> 
> sessionInfo()
> R version 2.4.1 (2006-12-18) 
> i386-pc-mingw32 
> 
> locale:
> LC_COLLATE=Dutch_Belgium.1252;LC_CTYPE=Dutch_Belgium.1252;LC_MONETARY=Du
> tch_Belgium.1252;LC_NUMERIC=C;LC_TIME=Dutch_Belgium.1252
> 
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "tcltk"
> 
> [7] "methods"   "base"     
> 
> other attached packages:
>    rgdal       sp     svIO   R2HTML   svMisc svSocket    svIDE 
>  "0.5-8" "0.9-13"  "0.9-5"   "1.58"  "0.9-5"  "0.9-5"  "0.9-5"
> 
> 
> Thanks,
> 
> Thierry
> 
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be 
> 
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From andrew.niccolai at yale.edu  Sun Apr 29 03:44:27 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Sat, 28 Apr 2007 21:44:27 -0400
Subject: [R-sig-Geo] Simulating raster or spatialgriddataframe images
In-Reply-To: <Pine.LNX.4.44.0704271222380.16144-100000@reclus.nhh.no>
References: <2E9C414912813E4EB981326983E0A10402E528E6@inboexch.inbo.be>
	<Pine.LNX.4.44.0704271222380.16144-100000@reclus.nhh.no>
Message-ID: <000001c789ff$ecbd4040$0302a8c0@D3K86YB1>

Greetings,

At the risk of being ridiculed for such a general question, can anyone offer
suggestions or decent code to simulate grid images with specific patterns?
I have been reading R Graphics and I am not sure if a grob will suffice, but
I would like to create a "controlled" circular or rectangular image in which
I can insert a star pattern or a pattern of high valued clumps evenly
distributed around the image.  I am interested in creating these controlled
or simulated images in order to better understand the ability of gstar and
local moran's I statistics in discriminating among image objects with
different internal patterns but that share similar overall averages and
standard deviations.  Can anyone suggest code or techniques inside of R that
will allow me to create a series of SGDF objects that have a specific set of
internal patterns associated with them.

Thanks in advance and I apologize for the "vagueness" of the query.

Andrew Niccolai
Doctoral Candidate
Yale School of Forestry



From mgallay01 at Queens-Belfast.AC.UK  Sun Apr 29 13:09:59 2007
From: mgallay01 at Queens-Belfast.AC.UK (Michal Gallay)
Date: 29 Apr 2007 12:09:59 +0100
Subject: [R-sig-Geo] Several gstat variograms on a single page
Message-ID: <Prayer.1.0.12.0704291209590.20146@localhost.localdomain>

Dear R Users,

I'd like to ask you for help. I am R beginner, tackling R for about three 
months. I'd like to produce variograms with 0, 1st, 2nd order detrending 
for 30 ascii grid files containing elevation data.

I've got problem with a simple thing but as it seems to me not as easy one 
as I thought. I hope I just can't see because of my eyes.

I'd like to plot three gstat variograms in one row on one page, to give 
them a main title (just single one for all three of the plots), and for 
each of the plots a subtitle, controlling the fontsize.

At first I used following approach:

#Calculation of the variogram and store it in a variable var...
g <- gstat(id = "xyz.values", 
		formula=z~1, 
		locations = ~x+y, 
		data = xyz.values,
		set = list(fraction = 0.33, width = 2)) 
var.0ot <- variogram(g)

g <- gstat(id = "xyz.values", 
		formula=z~x+y, 
		locations = ~x+y, 
		data = xyz.values,
		set = list(fraction = 0.33, width = 2)) 
var.1ot <- variogram(g)

g <- gstat(id = "xyz.values", 
		formula= z~x + y + I(x*y) + I(x^2) + I(y^2), 
		locations = ~x+y, 
		data = xyz.values,
		set = list(fraction = 0.33, width = 2))
var.2ot <- variogram(g)

#Store the plot it in a variable plot.var...

plot.var.0ot <- plot(var.0ot, pch=3, cex=0.5, col="red", 
			main="No trend removed")
plot.var.1ot <- plot(var.1ot, pch=3, cex=0.5, col="red", 
                main="1st order trend removed")
plot.var.2ot <- plot(var.2ot, pch=3, cex=0.5, col="red", 
		      main="2st order trend removed")

#Print the variograms into regions as specified 

print(plot.var.0ot, split=c(1,1,3,1), more=T)
print(plot.var.1ot, split=c(2,1,3,1), more=T)
print(plot.var.2ot, split=c(3,1,3,1), more=F)

The variograms were plotted OK, however, via that approach I couldn't 
figure out how to change the font size of the subtitles of each graph 
(specified by main="No trend" etc.)'par'or 'title' didn't work or I didn't 
use them right way. Further, I wasn't able to plot the main title 
positioned above the three subtitles and graphs.

So I thought the problem will be sorted if I use 'grid' package as 
plot.gstat Variogram function obeys 'lattice'.

I've created a viewport of 3 by 3 grid layout (after Paul Murrell 
http://www.stat.auckland.ac.nz/~paul/grid/grid.html#docs) and viewport 
tree. First row accommodates main title. This works fine. The second row 
and first column includes just the subtitle 1, second column subtitle 2, 
third column subtitle 3.

Third row is dedicated to the variogram plots. However, they are not 
plotted into the viewports plot1, plot2, plot3, but on the whole page.

The approach was as follows:

top.vp <- viewport(layout = grid.layout(3,3,widths=unit(c(1,1,1), c("null", 
"null", "null")), heights=unit(c(1,1,1), c("lines", "lines", "null"))))

vp.main.title <- viewport(layout.pos.col=c(1:3),layout.pos.row=1, 
name="vp.main.title") vp.subtitle1 <- 
viewport(layout.pos.col=1,layout.pos.row=2, name="vp.subtitle1") 
vp.subtitle2 <- viewport(layout.pos.col=2,layout.pos.row=2, 
name="vp.subtitle2") vp.subtitle3 <- 
viewport(layout.pos.col=3,layout.pos.row=2, name="vp.subtitle3") vp.plot1 
<- viewport(layout.pos.col=1,layout.pos.row=3, name="vp.plot1") vp.plot2 <- 
viewport(layout.pos.col=2,layout.pos.row=3, name="vp.plot2") vp.plot3 <- 
viewport(layout.pos.col=3,layout.pos.row=3, name="vp.plot3")

splot <- vpTree(top.vp, vpList(vp.main.title, vp.subtitle1, vp.subtitle2, 
vp.subtitle3,vp.plot1, vp.plot2, vp.plot3))

pushViewport(splot)

seekViewport("vp.main.title")
grid.text("main title", gp=gpar(cex=1.2))
seekViewport("vp.subtitle1")
grid.text("subtitle 1", gp=gpar(cex=0.8))
seekViewport("vp.plot1")
plot(var.0ot, pch=3, cex=0.5, col="red")

I much appreciate any suggestions and criticism.
Thank you very much in advance.

Michal

-- 
Michal Gallay

Postgraduate Research Student
School of Geography, Archaeology and Palaeoecology
Queen's University
Belfast BT7 1NN
Northern Ireland

Tel: +44(0)2890 273929
Fax: +44(0)2890 973212
email: mgallay01 at qub.ac.uk
www: www.qub.ac.uk/geog



From christoph.hofer at env.ethz.ch  Mon Apr 30 15:19:24 2007
From: christoph.hofer at env.ethz.ch (Christoph Hofer)
Date: Mon, 30 Apr 2007 15:19:24 +0200
Subject: [R-sig-Geo] Numerical simulation of elliptical random distribution
	in 2D
Message-ID: <3976C4B0-EA23-4BAF-A9F6-AEF062BEC5DA@env.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070430/e25d8fde/attachment.pl>

