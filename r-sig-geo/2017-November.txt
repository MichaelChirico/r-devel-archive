From edzer.pebesma at uni-muenster.de  Wed Nov  1 10:41:34 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 1 Nov 2017 10:41:34 +0100
Subject: [R-sig-Geo] split lines at vertices with sf
In-Reply-To: <CABsRJgZN9a9KeBYFqpohTTiaOnpb4cmvirvSxgRg5E69jhCvWA@mail.gmail.com>
References: <CABsRJgZN9a9KeBYFqpohTTiaOnpb4cmvirvSxgRg5E69jhCvWA@mail.gmail.com>
Message-ID: <d8b2a42e-d5d3-69e3-39a3-b1f6c91464af@uni-muenster.de>

Hi Sergio,

this blog: http://r-spatial.org/r/2017/08/28/nest.html does not exactly
do that, but comes pretty close.

Best regards,

On 10/29/2017 09:55 PM, Sergio Ibarra wrote:
> Dear list members,
> 
> How to split lines at vertices with sf?
> 
> Best,
> 
> [image: photo]
> *Sergio Ibarra Espinosa*
> MSc Environment, PhD Meteorology, Departamento de Ci?ncias Atmosf?ricas,
> Universidade de S?o Paulo
> + 55 11 3091-4731 | +55 11 974 253 791 | sergio.ibarra at usp.br |
> www.sergioibarra.blogspot.com | Skype: sergio_ibarra1 <#> | Rua do Mat?o,
> 1226 - Cidade Universit?ria S?o Paulo-SP - Brasil - 05508-090
> <http://github.com/ibarraespinosa> <http://us.linkedin.com/in/sibarra>
> <http://wiseintro.co/sergioibarra> <http://blogger.com/profile/sergioibarra>
> Get your own email signature
> <https://wisestamp.com/email-install?utm_source=promotion&utm_medium=signature&utm_campaign=get_your_own>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From zergioibarra at gmail.com  Wed Nov  1 14:25:08 2017
From: zergioibarra at gmail.com (Sergio Ibarra)
Date: Wed, 01 Nov 2017 13:25:08 +0000
Subject: [R-sig-Geo] split lines at vertices with sf
In-Reply-To: <d8b2a42e-d5d3-69e3-39a3-b1f6c91464af@uni-muenster.de>
References: <CABsRJgZN9a9KeBYFqpohTTiaOnpb4cmvirvSxgRg5E69jhCvWA@mail.gmail.com>
 <d8b2a42e-d5d3-69e3-39a3-b1f6c91464af@uni-muenster.de>
Message-ID: <CABsRJgZntO6qKWg_482+Fkvk5oX9BXrGeBqSjvsZPjC=WAPyrQ@mail.gmail.com>

Thanks Edzer, i will read the post.

Em qua, 1 de nov de 2017 ?s 07:41, Edzer Pebesma <
edzer.pebesma at uni-muenster.de> escreveu:

> Hi Sergio,
>
> this blog: http://r-spatial.org/r/2017/08/28/nest.html does not exactly
> do that, but comes pretty close.
>
> Best regards,
>
> On 10/29/2017 09:55 PM, Sergio Ibarra wrote:
> > Dear list members,
> >
> > How to split lines at vertices with sf?
> >
> > Best,
> >
> > [image: photo]
> > *Sergio Ibarra Espinosa*
> > MSc Environment, PhD Meteorology, Departamento de Ci?ncias Atmosf?ricas,
> > Universidade de S?o Paulo
> > + 55 11 3091-4731 <(11)%203091-4731> | +55 11 974 253 791 |
> sergio.ibarra at usp.br |
> > www.sergioibarra.blogspot.com | Skype: sergio_ibarra1 <#> | Rua do
> Mat?o,
> > 1226 - Cidade Universit?ria S?o Paulo-SP - Brasil - 05508-090
> > <http://github.com/ibarraespinosa> <http://us.linkedin.com/in/sibarra>
> > <http://wiseintro.co/sergioibarra> <
> http://blogger.com/profile/sergioibarra>
> > Get your own email signature
> > <
> https://wisestamp.com/email-install?utm_source=promotion&utm_medium=signature&utm_campaign=get_your_own
> >
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081 <+49%20251%208333081>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
?Sergio Ibarra Espinosa
Doutorando em Meteorologia
Instituto de Astronomia, Geof?sica e Ci?ncias Atmosf?ricas
Universidade de S?o Paulo
Rua do Mat?o, 1226
Cidade Universit?ria
S?o Paulo-SP - Brasil -
05508-090
+55-11-3091-2833
+55-11-97425-3791
Skype: sergio_ibarra1
Blog: www.sergioibarra.blogspot.com


[image: photo]
*Sergio Ibarra Espinosa*
MSc, Departamento de Ci?ncias Atmosf?ricas, Universidade de S?o Paulo
+ 55 11 3091-4731 <+%2055%2011%203091-4731> | +55 11 974 253 791
<+55%2011%20974%20253%20791> | sergio.ibarra at iag.usp.br |
www.sergioibarra.blogspot.com | Skype: sergio_ibarra1 <#> | Rua do Mat?o,
1226 - Cidade Universit?ria S?o Paulo-SP - Brasil - 05508-090
<http://us.linkedin.com/in/sibarra>  <http://twitter.com/sergio_ibarra>
<http://plus.google.com/+SergioIbarraEspinosa>  <http://github.com/xhie>
<http://wiseintro.co/sergioibarra>
Get a signature like this: Click here!
<http://ws-promos.appspot.com/r?rdata=eyJydXJsIjogImh0dHA6Ly93d3cud2lzZXN0YW1wLmNvbS9lbWFpbC1pbnN0YWxsP3dzX25jaWQ9NjcyMjk0MDA4JnV0bV9zb3VyY2U9ZXh0ZW5zaW9uJnV0bV9tZWRpdW09ZW1haWwmdXRtX2NhbXBhaWduPXByb21vXzU3MzI1Njg1NDg3Njk3OTIiLCAiZSI6ICI1NzMyNTY4NTQ4NzY5NzkyIn0=&u=651454521820988>

	[[alternative HTML version deleted]]


From maksoylar14 at ku.edu.tr  Thu Nov  2 13:36:57 2017
From: maksoylar14 at ku.edu.tr (MERVE AKSOYLAR)
Date: Thu, 2 Nov 2017 14:36:57 +0200
Subject: [R-sig-Geo] estimation of spatial panels with endogenous weighting
	matrices
Message-ID: <CAHytzUSaKXevpSo_AXtVs_xFJPW8cB4LARbCZr0g2_JViowgaw@mail.gmail.com>

Dear all,

I'm doing my thesis on some empirical work on spatial panel data.
I already use some geographical weighting matrices (using spdep and splm
packages).

But now I'm planning to use some endogenous weighting matrices, which are
time variant.

Could you please help me for this estimation procedure? Do you suggest any
packages for endogenous W, or is it possible to send me some codes for this
kind of estimation?

Thanks a lot,
Merve Aksoylar

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Thu Nov  2 14:13:04 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 2 Nov 2017 14:13:04 +0100
Subject: [R-sig-Geo] estimation of spatial panels with endogenous
 weighting matrices
In-Reply-To: <CAHytzUSaKXevpSo_AXtVs_xFJPW8cB4LARbCZr0g2_JViowgaw@mail.gmail.com>
References: <CAHytzUSaKXevpSo_AXtVs_xFJPW8cB4LARbCZr0g2_JViowgaw@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1711021406080.10968@reclus.nhh.no>

On Thu, 2 Nov 2017, MERVE AKSOYLAR wrote:

> Dear all,
>
> I'm doing my thesis on some empirical work on spatial panel data.
> I already use some geographical weighting matrices (using spdep and splm
> packages).
>
> But now I'm planning to use some endogenous weighting matrices, which are
> time variant.

Please provide a working example if possible (time invariant, error or 
lag, fixed or random effects?), or at least references to published 
methods articles. Why might time variant endogenous weighting matrices 
(size T x NxN x T with many 0 by definition) be interesting? You are 
thinking of a different Kronecker product than that in splm, but with what 
motivation (theoretical and empirical)? How are you thinking of proceeding 
- GMM, ML, or Bayesian? Could you use INLA in a non-separable setting? 
This doesn't get you to endogenous weights, though.

Roger

>
> Could you please help me for this estimation procedure? Do you suggest any
> packages for endogenous W, or is it possible to send me some codes for this
> kind of estimation?
>
> Thanks a lot,
> Merve Aksoylar
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From maksoylar14 at ku.edu.tr  Thu Nov  2 14:31:23 2017
From: maksoylar14 at ku.edu.tr (MERVE AKSOYLAR)
Date: Thu, 2 Nov 2017 15:31:23 +0200
Subject: [R-sig-Geo] estimation of spatial panels with endogenous
 weighting matrices
In-Reply-To: <alpine.LFD.2.21.1711021406080.10968@reclus.nhh.no>
References: <CAHytzUSaKXevpSo_AXtVs_xFJPW8cB4LARbCZr0g2_JViowgaw@mail.gmail.com>
 <alpine.LFD.2.21.1711021406080.10968@reclus.nhh.no>
Message-ID: <CAHytzUQfa5-awiy0mh0n+9tsC6B+JF+MVb8KHdE9h8uBH_A+-g@mail.gmail.com>

Actually my research is on economic growth theory, and I'm doing some
empirical work on Emerging Market Economies (24 countries) between
1991-2016 period.

For searching the growth spillovers, I've used the geographical distance
weighting matrix (exogenous) to estimate my growth regression. (SAR with FE)
But I decided to change the definition of space for Emerging Markets,
because they don't have exact similarities on geographical basis. Therefore
I'm planning to create an institutional weighting matrix for my estimation
and it is time variant, which makes also an endogeneity problem too.
Do you suggest me any estimation method? I was planning to do it again on
ML estimation, but maybe Bayesian will work better? But I don't know how to
do it. Could you please help me.

Thanks,
Merve Aksoylar

On Thu, Nov 2, 2017 at 3:13 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Thu, 2 Nov 2017, MERVE AKSOYLAR wrote:
>
> Dear all,
>>
>> I'm doing my thesis on some empirical work on spatial panel data.
>> I already use some geographical weighting matrices (using spdep and splm
>> packages).
>>
>> But now I'm planning to use some endogenous weighting matrices, which are
>> time variant.
>>
>
> Please provide a working example if possible (time invariant, error or
> lag, fixed or random effects?), or at least references to published methods
> articles. Why might time variant endogenous weighting matrices (size T x
> NxN x T with many 0 by definition) be interesting? You are thinking of a
> different Kronecker product than that in splm, but with what motivation
> (theoretical and empirical)? How are you thinking of proceeding - GMM, ML,
> or Bayesian? Could you use INLA in a non-separable setting? This doesn't
> get you to endogenous weights, though.
>
> Roger
>
>
>> Could you please help me for this estimation procedure? Do you suggest any
>> packages for endogenous W, or is it possible to send me some codes for
>> this
>> kind of estimation?
>>
>> Thanks a lot,
>> Merve Aksoylar
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian Sc
> <https://maps.google.com/?q=Norwegian+Sc&entry=gmail&source=g>hool of
> Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From eliaskrainski at gmail.com  Mon Nov  6 12:22:31 2017
From: eliaskrainski at gmail.com (Elias T Krainski)
Date: Mon, 6 Nov 2017 14:22:31 +0300
Subject: [R-sig-Geo] world map problem with Mollweide projection
Message-ID: <de016252-0212-1e3b-8448-3ca0214999b5@gmail.com>

Dear all,

Anybody knows a easy way how to get rid of those east-west lines at the 
north in the following plot:

library(maps)
map('world',, projection='mollweide')

best regards,

Elias


From Roger.Bivand at nhh.no  Mon Nov  6 12:47:47 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 6 Nov 2017 12:47:47 +0100
Subject: [R-sig-Geo] world map problem with Mollweide projection
In-Reply-To: <de016252-0212-1e3b-8448-3ca0214999b5@gmail.com>
References: <de016252-0212-1e3b-8448-3ca0214999b5@gmail.com>
Message-ID: <alpine.LFD.2.21.1711061244240.3199@reclus.nhh.no>

On Mon, 6 Nov 2017, Elias T Krainski wrote:

> Dear all,
>
> Anybody knows a easy way how to get rid of those east-west lines at the north 
> in the following plot:
>
> library(maps)
> map('world',, projection='mollweide')

In sp (can be done in sf too, I think):

wrld <- map("world", fill=TRUE, plot=FALSE)
library(sp)
library(maptools)
ID <- sapply(strsplit(wrld$names, ":"), "[", 1L)
wrld_sp <- map2SpatialPolygons(wrld, ID=ID)
proj4string(wrld_sp) <- "+proj=longlat +datum=WGS84"
wrld_sp1 <- nowrapSpatialPolygons(wrld_sp, offset=180)
library(rgdal)
wrld_moll <- spTransform(wrld_sp1, CRS("+proj=moll"))
plot(wrld_moll)

The lines or polygons crossing 180 degrees need to be broken into two 
parts at 180 +/- eps; that isn't easy in the maps package.

Roger

>
> best regards,
>
> Elias
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From eliaskrainski at gmail.com  Mon Nov  6 13:45:37 2017
From: eliaskrainski at gmail.com (Elias T Krainski)
Date: Mon, 6 Nov 2017 15:45:37 +0300
Subject: [R-sig-Geo] world map problem with Mollweide projection
In-Reply-To: <alpine.LFD.2.21.1711061244240.3199@reclus.nhh.no>
References: <de016252-0212-1e3b-8448-3ca0214999b5@gmail.com>
 <alpine.LFD.2.21.1711061244240.3199@reclus.nhh.no>
Message-ID: <2c64fa37-28dc-ed11-704a-aad3010e4b94@gmail.com>

It works. Thank you!

best wishes,

Elias


From Roger.Bivand at nhh.no  Mon Nov  6 15:46:31 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 6 Nov 2017 15:46:31 +0100
Subject: [R-sig-Geo] world map problem with Mollweide projection
In-Reply-To: <2c64fa37-28dc-ed11-704a-aad3010e4b94@gmail.com>
References: <de016252-0212-1e3b-8448-3ca0214999b5@gmail.com>
 <alpine.LFD.2.21.1711061244240.3199@reclus.nhh.no>
 <2c64fa37-28dc-ed11-704a-aad3010e4b94@gmail.com>
Message-ID: <alpine.LFD.2.21.1711061542480.3199@reclus.nhh.no>

And the sf version (using the development master from github):

library(maps)
library(sf)
wrld <- st_as_sf(maps::map("world", fill=TRUE, plot=FALSE))
wrld_wrap <- st_wrap_dateline(wrld, options =
   c("WRAPDATELINE=YES", "DATELINEOFFSET=180"), quiet = TRUE)
wrld_moll <- st_transform(wrld_wrap, "+proj=moll")
plot(st_geometry(wrld_moll), col="transparent")

See: https://github.com/r-spatial/sf/issues/541

Roger


On Mon, 6 Nov 2017, Elias T Krainski wrote:

> It works. Thank you!
>
> best wishes,
>
> Elias
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From shruti.tripathi at nipfp.org.in  Tue Nov  7 14:27:30 2017
From: shruti.tripathi at nipfp.org.in (Shruti Tripathi)
Date: Tue, 7 Nov 2017 18:57:30 +0530
Subject: [R-sig-Geo] help needed regarding package OSRM
Message-ID: <CAAMejQwpCTqyZL_VFCKraUbx6J0f-8mJi5fi_Lhqn9c2uYfRpQ@mail.gmail.com>

Hi,

We want to compute the distances between two matrices of  points in (long,
lat)
This is how, as per the manual distance is calculated between two points:

route <- osrmRoute(src = com[1, c("comm_id", "lon","lat")],
dst = com[15, c("comm_id", "lon","lat")])

How would I compute the same for a matrix of source and destination, for
example

route <- osrmRoute(src = com[1:10, c("comm_id", "lon","lat")],
dst = com[11:20, c("comm_id", "lon","lat")])

how do i do this???

Regards
Shruti

	[[alternative HTML version deleted]]


From mel at mbacou.com  Tue Nov  7 22:41:39 2017
From: mel at mbacou.com (Bacou, Melanie)
Date: Tue, 7 Nov 2017 16:41:39 -0500
Subject: [R-sig-Geo] help needed regarding package OSRM
In-Reply-To: <CAAMejQwpCTqyZL_VFCKraUbx6J0f-8mJi5fi_Lhqn9c2uYfRpQ@mail.gmail.com>
References: <CAAMejQwpCTqyZL_VFCKraUbx6J0f-8mJi5fi_Lhqn9c2uYfRpQ@mail.gmail.com>
Message-ID: <9e6baeb9-aa58-c86b-64a3-67dc104ac7b5@mbacou.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20171107/ee3b3075/attachment.html>

From gerard.heuvelink at wur.nl  Wed Nov  8 09:26:00 2017
From: gerard.heuvelink at wur.nl (Heuvelink, Gerard)
Date: Wed, 8 Nov 2017 08:26:00 +0000
Subject: [R-sig-Geo] call for nominations for the James L. Smith medal
Message-ID: <36219278445d48cd908b2c6431703d36@scomp5296.wurnet.nl>

Dear colleagues,
The International Spatial Accuracy Research Association (ISARA) is accepting nominations for the James L. Smith Medal for junior scientists. More information is available at http://spatial-accuracy.org/Medals. The awarding of this medal recognizes one or more outstanding contributions, with considerable potential for future such contributions, by an early career scientist (i.e., a scholar not beyond seven years, by the close of the nomination period, of the awarding of her/his graduate degree-except in exceptional circumstances, a doctorate is preferable) to the thematic area of the International Symposia on Spatial Accuracy Assessment in Natural Resources and Environmental Sciences, namely how to measure, model and manage uncertainty and error in spatial natural resources and environmental data.
Any living member of the academic community (including education/research, government, and industry) may be nominated who has not held a doctoral degree for more than seven years by the close of the nomination period. A nomination must take the form of a written letter (the body of which may have no more than 750 words) from a scholar who is thoroughly acquainted with the nominee's work, stating in a well-structured, well-argued and convincing manner why the nominee deserves the medal. The letter must be signed by a total of three scholars, one of whom must have attended at least one of the Spatial Accuracy symposia (preferably one of the preceding three; this individual must identify which symposium s/he attended).
Nominations should be sent in digital format before January 31, 2018, to the Panel of Judges chair, Gerard Heuvelink (gerard.heuvelink at wur.nl<mailto:gerard.heuvelink at wur.nl>).
The James L. Smith medal will be awarded during the next Spatial Accuracy symposium, 21-24 May 2018, Beijing. See https://www.spatialaccuracy2018.org/ for more information about the symposium and the call for abstracts and workshop proposals.
Kind regards, Gerard Heuvelink

	[[alternative HTML version deleted]]


From timothee.giraud at cnrs.fr  Wed Nov  8 14:13:38 2017
From: timothee.giraud at cnrs.fr (=?UTF-8?Q?Timoth=c3=a9e_Giraud?=)
Date: Wed, 8 Nov 2017 14:13:38 +0100
Subject: [R-sig-Geo] help needed regarding package OSRM
Message-ID: <71819b67-d61c-1fd8-4d95-5f41529d2563@cnrs.fr>

Hi,

osrmRoute() requests a route between 2 points, it can return a 
SpatialLinesDataFrame of the route with travel time (minutes) and travel 
distance (kilometers) in its data slot.

osrmTable() requests a travel time matrix between a set of points, it 
can return a matrix in minutes between sources and destinations.

The OSRM server cannot return a travel distance matrix (in km).

Thus, the only solution I see for now is to use a loop (or apply or 
whatever) with osrmRoute() :

devtools::install_github("rCarto/osrm")

library(osrm)
data("com")
mat <- data.frame(i = character(), j = character (),
 ????????????????? time = numeric(), distance = numeric(),
 ????????????????? stringsAsFactors = F)
k = 1
for (i in 1:2){
 ? for (j in 6:8){
 ??? rout <- osrmRoute(src = com[i, c("comm_id", "lon","lat")],
 ????????????????????? dst = com[j, c("comm_id", "lon","lat")], sp = T)
 ??? mat[k, ] <- as.vector(rout at data[1,])
 ??? k <- k + 1
 ??? Sys.sleep(0.5)
 ? }
}
mat

Note that I use the github version of the package. This version is 
adapted to last changes made on the demo server.

Note also that I use a Sys.sleep(0.5)instruction in the loop to be 
gentle with the public OSRM demo server.

If you use your own OSRM server, the CRAN version will work and the 
Sys.sleep() instruction is useless.


Timoth?e Giraud


From mdsumner at gmail.com  Wed Nov  8 20:42:33 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 08 Nov 2017 19:42:33 +0000
Subject: [R-sig-Geo] Is the raster package still receiving updates?
In-Reply-To: <CANtt_hzwEf5B4+qwKw00EhjnWQn=8VwiDzfi54ftM8GV=ieDAA@mail.gmail.com>
References: <1520364990.1033649.1508511658722.ref@mail.yahoo.com>
 <1520364990.1033649.1508511658722@mail.yahoo.com>
 <CAAcGz98p=378aWyX=hb7Ro6Myjg9iFp5dtM=jvprFXimJ7JLUg@mail.gmail.com>
 <1508551128926.11865@uhd.edu>
 <CAAcGz9_-qUYEpwDMQU=qmTnqVemGvSq63tEyJGf=8ApkTG+_ZQ@mail.gmail.com>
 <E7824B12CF1B784E.e319c03c-61a4-4b29-b62c-31fe5bfe31de@mail.outlook.com>
 <f458d17f-f923-e7bb-5243-7ec0a83af0e1@uni-marburg.de>
 <E7824B12CF1B784E.03827277-398b-4e71-ba14-e87242a4897e@mail.outlook.com>
 <6912309e-7558-0ffe-41f7-dd289dd34dfe@uni-muenster.de>
 <CAKkiGbvmgSxHA1vKCZomNab-uAFFJ3wWJJEe-nG4ytHjZaE8cg@mail.gmail.com>
 <CAAp_v851BWU57sa0eEsgLWLo10Rpy8NEHOedA6ojnqOiCYfpRg@mail.gmail.com>
 <CANVKczOBF1LVyAiOfspKa7Gwv1wrAK=n0MSc8RrxU5yXj_+xMg@mail.gmail.com>
 <CANtt_hzwEf5B4+qwKw00EhjnWQn=8VwiDzfi54ftM8GV=ieDAA@mail.gmail.com>
Message-ID: <CAAcGz98L5CRzQsqqrwcCTTqT8hk1g9zLo=ACN1LDJhf-EQOZkA@mail.gmail.com>

On Mon, 23 Oct 2017 at 17:51 Robert J. Hijmans <r.hijmans at gmail.com> wrote:

> For a variety of reasons, I have not been able to do much work on raster
> for the past year. And most of my thinking about it, and some work, has
> been around a next generation replacement that is simpler in use and much
> faster.
> But for now, over the coming months, I will make sure that it gets updated
> and bugs get fixed.
>
> Best, Robert
>
>
Excellent, thanks Robert!   So I had somewhere to collect issues I made a
(now stale) fork of the R-forge repo here:

https://github.com/mdsumner/raster-rforge

I plan to review each issue mentioned and summarize them, but for now it's
a reasonable place to keep the notes. Should we simply email you details of
issues, or use the systems on r-forge, or do you perhaps plan to migrate to
Github?  If the plan is to stay where it is I'll just use my repo to share
ideas and planned updates.

On Github I think the potential for collective contribution from the
comunity is far greater. I'd also love to see raster converted to roxygen2
(I'm happy to do that, just need to know if it's a welcome change) and to
have a suite of automated tests in the package as well.

If SVN/r-forge is going to the be the system used that's fine, but I really
think we need a more accessible forum for sharing issues, and I'm quite
sure that most people will ignore anything that anyone else sets up unless
you approve it.

Cheers, Mike




>
> On Sunday, October 22, 2017, Barry Rowlingson <
> b.rowlingson at lancaster.ac.uk
> <javascript:_e(%7B%7D,'cvml','b.rowlingson at lancaster.ac.uk');>> wrote:
>
> > Here's what I think should happen:
> >
> >  Robert Hijmans lets us know what his vision of raster is, and how he
> plans
> > to support it.
> >
> >  He should say if he wishes to carry on as maintainer or not. If not, we
> > need a new maintainer and then we can think about moving development to
> > gitlab, or whatever.
> >
> > Barry
> >
> >
> >
> >
> >
> > On Sun, Oct 22, 2017 at 1:16 AM, Alexander Brown <a.brown at ieee.org>
> wrote:
> >
> > > I too expect to rely on the raster package for years, and would be
> > willing
> > > to help to the extent of my ability and resources.
> > >
> > > Alex Brown (a.brown at ieee.org)
> > > http://faculty.uml.edu/abrown  -->
> > > https://sites.google.com/site/alexbrownuml
> > >
> > >
> > > On Sat, Oct 21, 2017 at 12:54 PM, Vijay Lulla <vijaylulla at gmail.com>
> > > wrote:
> > >
> > > > Just like Mike I too will rely on raster for many years still and I
> > will
> > > be
> > > > very happy to support efforts on this or whatever else the community
> > > > leaders (Edzer, Roger, and others) decide is the best way for us to
> > move
> > > > forward.
> > > >
> > > > Thanks,
> > > > Vijay.
> > > >
> > > > On Sat, Oct 21, 2017 at 5:32 AM, Edzer Pebesma <
> > > > edzer.pebesma at uni-muenster.de> wrote:
> > > >
> > > > > The the NOTEs on CRAN and the issues raised on Mike's raster-rforge
> > GH
> > > > > repo to me suggest that raster has, for a while now, reached a
> mature
> > > > > state. Of course, you'd wish that raster development, in terms of
> > > > > extending its power and features, would continue the pace it did 10
> > > > > years ago, but that's a different issue. Mike has write access to
> the
> > > > > raster r-forge sources, it shouldn't be hard to support Robert with
> > > > > current issues.
> > > > >
> > > > > Right after rstudio::conf (Feb 4/5) I'm meeting with Robert Hijmans
> > and
> > > > > Etienne Racine, to discuss, and work on raster future and
> integration
> > > of
> > > > > rasters and stars. Anyone interested, feel free to join.
> > > > >
> > > > > Stars has the ambition to jump over raster, in the sense that it
> > > doesn't
> > > > > want to have the local hard drive as a limitation. That calls for
> > > > > rethinking quite a few things. So far, things are still all in main
> > > > > memory but it already integrates with sf:
> > > > >
> > > > > https://gist.github.com/edzer/381dac079ddcd5174be31209675b3822
> > > > >
> > > > > and handles time stacks of different attributes in single objects.
> > Feed
> > > > > back welcome as always; will write up the first blog in a few
> weeks.
> > > > >
> > > > >
> > > > > On 10/21/2017 10:41 AM, Roger Bivand wrote:
> > > > > > Yes, this sounds fruitful. For now, I suggest that those wishing
> to
> > > > > enhance raster do so in an additional package enhancing raster and
> > > > > depending on it. Immediately, we should help Robert resolve the
> notes
> > > in
> > > > > the tests, they do not affect functionality now, but deserve
> > attention
> > > to
> > > > > bring the package into full CRAN compliance. I can help with this.
> > > > > >
> > > > > > Roger
> > > > > >
> > > > > > Roger Bivand
> > > > > > Norwegian School of Economics
> > > > > > Bergen, Norway
> > > > > >
> > > > > >
> > > > > >
> > > > > > Fra: Chris Reudenbach
> > > > > > Sendt: l?rdag 21. oktober, 09.01
> > > > > > Emne: Re: [R-sig-Geo] Is the raster package still receiving
> > updates?
> > > > > > Til: r-sig-geo at r-project.org
> > > > > >
> > > > > >
> > > > > > Many of us rely on the raster package as a crucial basis for
> their
> > > > work.
> > > > > Big thank to Robert.  Nevertheless to contribute needs to focus
> needs
> > > and
> > > > > ressources.  Maybe an information exchange/discussion with Robert
> > about
> > > > > options such as if/how the interested community can support would
> be
> > > more
> > > > > productive. cheers Chris Am 21.10.2017 um 06:52 schrieb Roger
> > Bivand: >
> > > > The
> > > > > CRAN raster package has not been abandoned, if it had, it would
> have
> > > been
> > > > > reclassified as orphaned. Its test results have notes but no
> warnings
> > > or
> > > > > errors. It would be orphaned if the maintainer did not respond to
> > CRAN
> > > > > requests to resolve test errors. Consequently, you are suggesting a
> > > fork,
> > > > > and should rename any package. Only the maintainer may update
> > existing
> > > > CRAN
> > > > > packages. I would not think that forking an existing CRAN package
> is
> > > the
> > > > > most productive way of contributing to the community. The package
> has
> > > > many
> > > > > reverse dependencies, so setting up a test framework to find
> > backwards
> > > > > incompatibilities would be crucial. > > Of course, all
> contributions
> > > are
> > > > > welcome. > > Roger > > Roger Bivand > Norwegian School of
> Economics >
> > > > > Bergen, Norway > > > > Fra: Michael Sumner > Sendt: l?rdag 21.
> > oktober,
> > > > > 06.28 > Emne: Re: [R-sig-Geo] Is the raster package still receiving
> > > > > updates? > Til: Hodgess, Erin > Kopi: R-sig-geo Mailing List > > >
> > > Great!
> > > > > I'm keen, but haven't done the work needed to flesh this out
> > properly:
> > > > > https://github.com/mdsumner/raster-rforge/issues I have not
> checked
> > if
> > > > > there's been any commits to r-forge since I cloned this. Cheers,
> Mike
> > > On
> > > > > Sat, 21 Oct 2017, 12:58 Hodgess, Erin, wrote: > I could take a swat
> > at
> > > > it,
> > > > > if you wish. Please do send me the list of > fixes. I could start
> in
> > > > about
> > > > > a week, if that would work. > Sincerely, > Erin > > > Erin M.
> > Hodgess >
> > > > > Associate Professor > Department of Mathematics and Statistics >
> > > > University
> > > > > of Houston - Downtown > mailto: hodgesse at uhd.edu > >
> > > > > ________________________________________ > From: R-sig-Geo on
> behalf
> > > of
> > > > > Michael > Sumner > Sent: Friday, October 20, 2017 8:05 PM > To:
> > Thiago
> > > V.
> > > > > dos Santos > Cc: R-sig-geo Mailing List > Subject: Re: [R-sig-Geo]
> Is
> > > the
> > > > > raster package still receiving updates? > > No, it's effectively
> > > > abandoned.
> > > > > No concrete plans known. > > I'm interested to keep it going and
> have
> > > > kept
> > > > > a list of fixes needed, but > not sure when or if I'll get to it.
> > >
> > > I'd
> > > > > support any efforts in this, I'll rely on raster for many years
> > still.
> > > >
> > > > >
> > > > > Cheers, Mike > > On Sat, 21 Oct 2017, 02:05 Thiago V. dos Santos
> via
> > > > > R-sig-Geo, < > r-sig-geo at r-project.org> wrote: > > > Dear list, >
> >
> > >
> > > >
> > > > I
> > > > > realized that the latest version of the raster package was released
> > on
> > > >
> > > > >
> > > > > CRAN over a year ago. > > > > I also noticed th
> <https://maps.google.com/?q=%3E+%3E+CRAN+over+a+year+ago.+%3E+%3E+%3E+%3E+I+also+noticed+th&entry=gmail&source=g>at
> Robert's
> > > participation
> > > > in
> > > > > this list has become rather > > scarce. > > > > I was just
> wondering
> > > > > whether the raster package is still receiving > updates? > > > >
> > > > Greetings,
> > > > > > > -- Thiago V. dos Santos > > > > Postdoctoral Research Fellow >
> >
> > > > > Department of Climate and Space Science and Engineering > >
> > University
> > > of
> > > > > Michigan > > > > _______________________________________________ >
> >
> > > > > R-sig-Geo mailing list > > R-sig-Geo at r-project.org > >
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > > > -- > Dr.
> > Michael
> > > > > Sumner > Software and Database Engineer > Australian Antarctic
> > > Division >
> > > > > 203 Channel Highway > Kingston Tasmania 7050 Australia > >
> > > [[alternative
> > > > > HTML version deleted]] > > ____ > ______________________________
> > > > _____________
> > > > > > R-sig-Geo mailing list > R-sig-Geo at r-project.org >
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo > -- Dr. Michael
> > > Sumner
> > > > > Software and Database Engineer Australian Antarctic Division 203
> > > Channel
> > > > > Highway Kingston Tasmania 7050 Australia [[alternative HTML version
> > > > > deleted]] _______________________________________________ R-sig-Geo
> > > > > mailing list R-sig-Geo at r-project.org https://stat.ethz.ch/mailman/
> > > > > listinfo/r-sig-geo > > > [[alternative HTML version deleted]] > >
> > > > > _______________________________________________ > R-sig-Geo mailing
> > > list
> > > > > > R-sig-Geo at r-project.org > https://stat.ethz.ch/mailman/
> > > > > listinfo/r-sig-geo > -- Dr Christoph Reudenbach,
> Philipps-University
> > of
> > > > > Marburg, Faculty of Geography, GIS and Environmental Modeling,
> > > > > Deutschhausstr. 10, D-35032 Marburg, fon: ++49.(0)6421.2824296
> <+49%206421%202824296>, fax:
> > > > > ++49.(0)6421.2828950 <+49%206421%202828950>, web: gis-ma.org,
> giswerk.org,
> > > > > moc.environmentalinformatics-marburg.de
> > ______________________________
> > > > _________________
> > > > > R-sig-Geo mailing list R-sig-Geo at r-project.org
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > > >
> > > > > >       [[alternative HTML version deleted]]
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at r-project.org
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > >
> > > > > --
> > > > > Edzer Pebesma
> > > > > Institute for Geoinformatics
> > > > > Heisenbergstrasse 2, 48151 Muenster, Germany
> > > > > Phone: +49 251 8333081 <+49%20251%208333081>
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at r-project.org
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > >
> > > >
> > > > --
> > > > Vijay Lulla, Ph.D.
> > > >
> > > > Assistant Professor,
> > > > Dept. of Geography,
> > > > Indiana University Purdue University Indianapolis (IUPUI)
> > > > 425 University Blvd, CA-207C.
> > > > Indianapolis, IN-46202
> > > > vlulla at iupui.edu
> > > >
> > > > <http://vijaylulla.com>
> > > > http://vijaylulla.com
> > > >
> > > >         [[alternative HTML version deleted]]
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From facundo.munoz at cirad.fr  Thu Nov  9 12:08:03 2017
From: facundo.munoz at cirad.fr (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Thu, 9 Nov 2017 12:08:03 +0100
Subject: [R-sig-Geo] spacetime: creating STIDF objects
Message-ID: <5ef47936-2e92-9203-21f9-1fe57305d452@cirad.fr>

Dear all, I have just posted an issue [1] in the GitHub repository for
the "spacetime" package that I reproduce here:

I have a "long" table with irregular data (observations for some
municipalities at specific months) that I would like to store together
with the administrative map of the region (SpatialPolygons). I tried
unsuccessfully to directly create the STIDF object using both
`stConstruct()` and `STIDF`.

In all the related examples in the package you first create a STFDF
which is later coerced to STIDF. But my dataset is very sparse.

Here is a reproducible example adapted from the examples in the package.
If I use the complete table it leads to a STFDF object as expected and
it works fine. However if the table is not complete it should switch to
a STIDF representation (as far as I understand from the JSS paper).

``` r

library(spacetime)
library(sp)
sp = cbind(x = c(0,0,1), y = c(0,1,1))
row.names(sp) = paste0("point", 1:nrow(sp))
sp = SpatialPoints(sp)
time = as.POSIXct("2010-08-05")+3600*(10:13)
m = c(10,20,30) # means for each of the 3 point locations
mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))

mydata = data.frame(
? space = rep(row.names(sp), 4),
? time? = rep(time, each = 3),
? values = signif(mydata,3)
)

mystfdf <- stConstruct(mydata, "space", "time", sp)? # This works OK

mystidf <- stConstruct(mydata[-1,], "space", "time", sp)
#> Error: nrow(object at time) == length(object at sp) is not TRUE
```


Thank you in advance.

?acu.-


[1] https://github.com/edzer/spacetime/issues/30

-- 
Cirad <https://umr-astre.cirad.fr/>
*Facundo Mu?oz*
/Biostatistician/
Bios - UMR ASTRE
Bureau E-203 - TA A-117 / E
Campus international de Baillarguet
34398 Montpellier Cedex 5
France
+33 467 593 868
@famuvie


From rolandh at uni-muenster.de  Thu Nov  9 15:15:12 2017
From: rolandh at uni-muenster.de (Roland Harhoff)
Date: Thu, 9 Nov 2017 15:15:12 +0100
Subject: [R-sig-Geo] spacetime: creating STIDF objects
In-Reply-To: <5ef47936-2e92-9203-21f9-1fe57305d452@cirad.fr>
Message-ID: <permail-20171109141512bb604cee00004236-rolandh@message-id.uni-muenster.de>

Hey Facundo,

I'm not sure about the stConstruct issue (yet) ...
but you can create a STIDF object from your example data by

mystidf <- STIDF(rbind(sp,sp,sp,sp), mydata$time, mydata[ , "values", drop = F])

See also the documentation ...

?spacetime::STIDF

HTH!

Best wishes ...

Roland


Facundo Mu?oz schrieb am 2017-11-09:
> Dear all, I have just posted an issue [1] in the GitHub repository for
> the "spacetime" package that I reproduce here:

> I have a "long" table with irregular data (observations for some
> municipalities at specific months) that I would like to store together
> with the administrative map of the region (SpatialPolygons). I tried
> unsuccessfully to directly create the STIDF object using both
> `stConstruct()` and `STIDF`.

> In all the related examples in the package you first create a STFDF
> which is later coerced to STIDF. But my dataset is very sparse.

> Here is a reproducible example adapted from the examples in the package.
> If I use the complete table it leads to a STFDF object as expected and
> it works fine. However if the table is not complete it should switch to
> a STIDF representation (as far as I understand from the JSS paper).

> ``` r

> library(spacetime)
> library(sp)
> sp = cbind(x = c(0,0,1), y = c(0,1,1))
> row.names(sp) = paste0("point", 1:nrow(sp))
> sp = SpatialPoints(sp)
> time = as.POSIXct("2010-08-05")+3600*(10:13)
> m = c(10,20,30) # means for each of the 3 point locations
> mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))

> mydata = data.frame(
> ? space = rep(row.names(sp), 4),
> ? time? = rep(time, each = 3),
> ? values = signif(mydata,3)
> )

> mystfdf <- stConstruct(mydata, "space", "time", sp)? # This works OK

> mystidf <- stConstruct(mydata[-1,], "space", "time", sp)
> #> Error: nrow(object at time) == length(object at sp) is not TRUE
> ```


> Thank you in advance.

> ?acu.-


> [1] https://github.com/edzer/spacetime/issues/30

> --
> Cirad <https://umr-astre.cirad.fr/>
> *Facundo Mu?oz*
> /Biostatistician/
> Bios - UMR ASTRE
> Bureau E-203 - TA A-117 / E
> Campus international de Baillarguet
> 34398 Montpellier Cedex 5
> France
> +33 467 593 868
> @famuvie

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From facundo.munoz at cirad.fr  Thu Nov  9 15:32:45 2017
From: facundo.munoz at cirad.fr (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Thu, 9 Nov 2017 15:32:45 +0100
Subject: [R-sig-Geo] spacetime: creating STIDF objects
In-Reply-To: <permail-201711091410108218e1ae000037c5-rolandh@message-id.uni-muenster.de>
References: <permail-201711091410108218e1ae000037c5-rolandh@message-id.uni-muenster.de>
Message-ID: <d1f80925-edec-3934-2b19-192817dfa323@cirad.fr>

Hi Roland, thanks for your answer.

However, this solution does not work when sp is a SpatialPolygons (which
is my case, of course):

> rbind(sp, sp)

Error in validObject(res) :
? invalid class ?SpatialPolygons? object: non-unique Polygons ID slot values


I'm sorry that my toy example didn't reproduce exactly my situation.

Thanks in any case.

?acu.-


On 11/09/2017 03:10 PM, Roland Harhoff wrote:
> Hey Facundo,
>
> I'm not sure about the stConstruct issue (yet) ...
> but you can create a STIDF object from your example data by
>
> mystidf <- STIDF(rbind(sp,sp,sp,sp), mydata$time, mydata[ , "values", drop = F])
>
> See also the documentation ...
>
> ?spacetime::STIDF
>
> HTH so far ...!
>
> Best wishes ...
>
> Roland
>
>
> Facundo Mu?oz schrieb am 2017-11-09:
>> Dear all, I have just posted an issue [1] in the GitHub repository for
>> the "spacetime" package that I reproduce here:
>> I have a "long" table with irregular data (observations for some
>> municipalities at specific months) that I would like to store together
>> with the administrative map of the region (SpatialPolygons). I tried
>> unsuccessfully to directly create the STIDF object using both
>> `stConstruct()` and `STIDF`.
>> In all the related examples in the package you first create a STFDF
>> which is later coerced to STIDF. But my dataset is very sparse.
>> Here is a reproducible example adapted from the examples in the package.
>> If I use the complete table it leads to a STFDF object as expected and
>> it works fine. However if the table is not complete it should switch to
>> a STIDF representation (as far as I understand from the JSS paper).
>> ``` r
>> library(spacetime)
>> library(sp)
>> sp = cbind(x = c(0,0,1), y = c(0,1,1))
>> row.names(sp) = paste0("point", 1:nrow(sp))
>> sp = SpatialPoints(sp)
>> time = as.POSIXct("2010-08-05")+3600*(10:13)
>> m = c(10,20,30) # means for each of the 3 point locations
>> mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))
>> mydata = data.frame(
>> ? space = rep(row.names(sp), 4),
>> ? time? = rep(time, each = 3),
>> ? values = signif(mydata,3)
>> )
>> mystfdf <- stConstruct(mydata, "space", "time", sp)? # This works OK
>> mystidf <- stConstruct(mydata[-1,], "space", "time", sp)
>> #> Error: nrow(object at time) == length(object at sp) is not TRUE
>> ```
>
>> Thank you in advance.
>> ?acu.-
>
>> [1] https://github.com/edzer/spacetime/issues/30
>> --
>> Cirad <https://umr-astre.cirad.fr/>
>> *Facundo Mu?oz*
>> /Biostatistician/
>> Bios - UMR ASTRE
>> Bureau E-203 - TA A-117 / E
>> Campus international de Baillarguet
>> 34398 Montpellier Cedex 5
>> France
>> +33 467 593 868
>> @famuvie
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Thu Nov  9 15:52:21 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 9 Nov 2017 15:52:21 +0100
Subject: [R-sig-Geo] spacetime: creating STIDF objects
In-Reply-To: <d1f80925-edec-3934-2b19-192817dfa323@cirad.fr>
References: <permail-201711091410108218e1ae000037c5-rolandh@message-id.uni-muenster.de>
 <d1f80925-edec-3934-2b19-192817dfa323@cirad.fr>
Message-ID: <4185a8dc-a2f6-8693-f5fb-f6890fd8e750@uni-muenster.de>



On 11/09/2017 03:32 PM, Facundo Mu?oz wrote:
> Hi Roland, thanks for your answer.
> 
> However, this solution does not work when sp is a SpatialPolygons (which
> is my case, of course):
> 
>> rbind(sp, sp)
> 
> Error in validObject(res) :
> ? invalid class ?SpatialPolygons? object: non-unique Polygons ID slot values
> 

rbind(sp, sp, makeUniqueIDs = TRUE)

> 
> I'm sorry that my toy example didn't reproduce exactly my situation.
> 
> Thanks in any case.
> 
> ?acu.-
> 
> 
> On 11/09/2017 03:10 PM, Roland Harhoff wrote:
>> Hey Facundo,
>>
>> I'm not sure about the stConstruct issue (yet) ...
>> but you can create a STIDF object from your example data by
>>
>> mystidf <- STIDF(rbind(sp,sp,sp,sp), mydata$time, mydata[ , "values", drop = F])
>>
>> See also the documentation ...
>>
>> ?spacetime::STIDF
>>
>> HTH so far ...!
>>
>> Best wishes ...
>>
>> Roland
>>
>>
>> Facundo Mu?oz schrieb am 2017-11-09:
>>> Dear all, I have just posted an issue [1] in the GitHub repository for
>>> the "spacetime" package that I reproduce here:
>>> I have a "long" table with irregular data (observations for some
>>> municipalities at specific months) that I would like to store together
>>> with the administrative map of the region (SpatialPolygons). I tried
>>> unsuccessfully to directly create the STIDF object using both
>>> `stConstruct()` and `STIDF`.
>>> In all the related examples in the package you first create a STFDF
>>> which is later coerced to STIDF. But my dataset is very sparse.
>>> Here is a reproducible example adapted from the examples in the package.
>>> If I use the complete table it leads to a STFDF object as expected and
>>> it works fine. However if the table is not complete it should switch to
>>> a STIDF representation (as far as I understand from the JSS paper).
>>> ``` r
>>> library(spacetime)
>>> library(sp)
>>> sp = cbind(x = c(0,0,1), y = c(0,1,1))
>>> row.names(sp) = paste0("point", 1:nrow(sp))
>>> sp = SpatialPoints(sp)
>>> time = as.POSIXct("2010-08-05")+3600*(10:13)
>>> m = c(10,20,30) # means for each of the 3 point locations
>>> mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))
>>> mydata = data.frame(
>>> ? space = rep(row.names(sp), 4),
>>> ? time? = rep(time, each = 3),
>>> ? values = signif(mydata,3)
>>> )
>>> mystfdf <- stConstruct(mydata, "space", "time", sp)? # This works OK
>>> mystidf <- stConstruct(mydata[-1,], "space", "time", sp)
>>> #> Error: nrow(object at time) == length(object at sp) is not TRUE
>>> ```
>>
>>> Thank you in advance.
>>> ?acu.-
>>
>>> [1] https://github.com/edzer/spacetime/issues/30
>>> --
>>> Cirad <https://umr-astre.cirad.fr/>
>>> *Facundo Mu?oz*
>>> /Biostatistician/
>>> Bios - UMR ASTRE
>>> Bureau E-203 - TA A-117 / E
>>> Campus international de Baillarguet
>>> 34398 Montpellier Cedex 5
>>> France
>>> +33 467 593 868
>>> @famuvie
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From himalayanhari at gmail.com  Fri Nov 10 03:21:24 2017
From: himalayanhari at gmail.com (Hari Sharma)
Date: Fri, 10 Nov 2017 10:21:24 +0800
Subject: [R-sig-Geo] Problem
Message-ID: <C0F9AB83-A209-4C7B-8A1B-FD57AAAD8A37@gmail.com>

Hi, 
While running Glmer in R, I got some bugs in some variables. I have 10 variables and run the model with the combination of these variables.  Response variable is binomial. got  following problem.

m743	<-glmer(Fecalpellet~	Abgherbcover +	Aspect +	Avgshrubcover	+	fallenlogno	+ slope	+ stumpnumber	+	waterdistance	+ (1|Year), data=df, family=binomial)
Warning message:
In checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv,  :
  Model failed to converge with max|grad| = 0.0430099 (tol = 0.001, component 1)

Could you please suggest any idea to solve this problem?

Hari Sharma
Taiwan


From r.turner at auckland.ac.nz  Fri Nov 10 03:59:54 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 15:59:54 +1300
Subject: [R-sig-Geo] [FORGED]  Problem
In-Reply-To: <C0F9AB83-A209-4C7B-8A1B-FD57AAAD8A37@gmail.com>
References: <C0F9AB83-A209-4C7B-8A1B-FD57AAAD8A37@gmail.com>
Message-ID: <c9163e6c-58c3-aa7c-1635-9b489c6b8743@auckland.ac.nz>

On 10/11/17 15:21, Hari Sharma wrote:
> Hi,
> While running Glmer in R, I got some bugs in some variables. I have 10 variables and run the model with the combination of these variables.  Response variable is binomial. got  following problem.
> 
> m743	<-glmer(Fecalpellet~	Abgherbcover +	Aspect +	Avgshrubcover	+	fallenlogno	+ slope	+ stumpnumber	+	waterdistance	+ (1|Year), data=df, family=binomial)
> Warning message:
> In checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv,  :
>    Model failed to converge with max|grad| = 0.0430099 (tol = 0.001, component 1)
> 
> Could you please suggest any idea to solve this problem?

This question is not appropriate for R-sig-Geo.  You should have sent it 
to R-sig-mixed-models.

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From spencer.graves at prodsyse.com  Fri Nov 10 09:23:48 2017
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Fri, 10 Nov 2017 02:23:48 -0600
Subject: [R-sig-Geo] land area of New Spain / Mexico 1790-present?
Message-ID: <3307f1ab-a49c-5e9d-52ae-b87f405bc06f@prodsyse.com>

 ????? Where might I find historical data on the land area claimed by 
New Spain / Mexico vs. the United States, say, 1790 - present?


 ????? I found a table of land area of the US for each census 1790 - 
2000 at "http://www.u-s-history.com/pages/h986.html", and I found maps 
at 
"https://commons.wikimedia.org/wiki/File:Non-Native-American-Nations-Territorial-Claims-over-NAFTA-countries-1750-2008.gif" 
with narrative at 
"https://en.wikipedia.org/wiki/Territorial_evolution_of_North_America_since_1763" 
and 
"https://en.wikipedia.org/wiki/New_Spain#/media/File:Map_of_the_Viceroyalty_of_New_Spain.svg". 



 ????? If I understand correctly, Mexico today is just under 2 million 
km^2.? With independence in 1821, it lost just over 500,000 km^2 in 
Central America.? Before that, as New Spain, it lost 2.1 million km^2 in 
the Napoleonic Wars eventually to the US in 1803. If this is correct, it 
was roughly 4.6 million km^2 prior to the Napoleonic Wars.? This does 
not count the loss of Florida and islands in the Pacific and the 
Caribbean, which I think are smaller than these other territories.


 ????? Thanks,
 ????? Spencer Graves


From julleeyaw at yahoo.ca  Fri Nov 10 21:33:14 2017
From: julleeyaw at yahoo.ca (Julie Lee-Yaw)
Date: Fri, 10 Nov 2017 20:33:14 +0000 (UTC)
Subject: [R-sig-Geo] question about rgeos "gDistance" parameters
References: <767893074.467719.1510345994378.ref@mail.yahoo.com>
Message-ID: <767893074.467719.1510345994378@mail.yahoo.com>

Can someone better explain what the byid parameter does in the gDistance command? The help for the command states:
"Logical vector determining if the function should be applied across ids (TRUE) or the entire object (FALSE) for spgeom1 and spgeom2"

If spgeom1 is a spatial points objects and spgeom2 is a shapefile with multiple polygons, will byid=FALSE return a single value and byid=TRUE return a matrix of the distances between every point and every polygon? If I'm correct, what does that single value represent (e.g. which distance) when byid=TRUE?
Thanks
	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Fri Nov 10 21:50:15 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 10 Nov 2017 21:50:15 +0100
Subject: [R-sig-Geo] question about rgeos "gDistance" parameters
In-Reply-To: <767893074.467719.1510345994378@mail.yahoo.com>
References: <767893074.467719.1510345994378.ref@mail.yahoo.com>
 <767893074.467719.1510345994378@mail.yahoo.com>
Message-ID: <alpine.LFD.2.21.1711102142280.9229@reclus.nhh.no>

Please post plain text only - since you didn't provide an example, your 
code wasn't deformed by HTML formatting, but had you provided an example 
it would have been. Did you look at the examples on the help page?

library(rgeos)
pt1 = readWKT("POINT(0.5 0.5)")
pt2 = readWKT("POINT(2 2)")

p1 = readWKT("POLYGON((0 0,1 0,1 1,0 1,0 0))")
p2 = readWKT("POLYGON((2 0,3 1,4 0,2 0))")

gDistance(pt1,pt2)
gDistance(p1,pt1)
gDistance(p1,pt2)
gDistance(p1,p2)

Modifying this:

pt3 <- rbind(pt1, pt2)
row.names(p2) <- "2"
p3 <- rbind(p1, p2)
gDistance(pt3, p3)
gDistance(pt3, p3, byid=c(TRUE, TRUE))
gDistance(pt3, p3, byid=c(TRUE, FALSE))
gDistance(pt3, p3, byid=c(FALSE, TRUE))

Hope this clarifies,

Roger

On Fri, 10 Nov 2017, Julie Lee-Yaw via R-sig-Geo wrote:

> Can someone better explain what the byid parameter does in the gDistance 
> command? The help for the command states: "Logical vector determining if 
> the function should be applied across ids (TRUE) or the entire object 
> (FALSE) for spgeom1 and spgeom2"
>
> If spgeom1 is a spatial points objects and spgeom2 is a shapefile with 
> multiple polygons, will byid=FALSE return a single value and byid=TRUE 
> return a matrix of the distances between every point and every polygon? 
> If I'm correct, what does that single value represent (e.g. which 
> distance) when byid=TRUE? Thanks
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From bayat194 at yahoo.com  Mon Nov 13 12:01:26 2017
From: bayat194 at yahoo.com (Javad Bayat)
Date: Mon, 13 Nov 2017 11:01:26 +0000 (UTC)
Subject: [R-sig-Geo] Converting polylines to polygon
In-Reply-To: <1431859255.865124.1510569952879@mail.yahoo.com>
References: <1431859255.865124.1510569952879.ref@mail.yahoo.com>
 <1431859255.865124.1510569952879@mail.yahoo.com>
Message-ID: <1471661584.871376.1510570886343@mail.yahoo.com>

I have a shape file as poly line and I want to convert it to polygon.Is it possible to do that in R?
lake <-readShapeLines("./lake_main_utm.shp")proj4string(lake) <- CRS("+proj=utm +zone=39 +datum=WGS84")

Sincerely.

Best Regards Javad Bayat Alternative Mail: j.bayat194 at gmail.com  
	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Nov 13 12:59:14 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 13 Nov 2017 12:59:14 +0100
Subject: [R-sig-Geo] Converting polylines to polygon
In-Reply-To: <1471661584.871376.1510570886343@mail.yahoo.com>
References: <1431859255.865124.1510569952879.ref@mail.yahoo.com>
 <1431859255.865124.1510569952879@mail.yahoo.com>
 <1471661584.871376.1510570886343@mail.yahoo.com>
Message-ID: <alpine.LFD.2.21.1711131257050.3473@reclus.nhh.no>

On r-help, you were asked to post only plain text - please do do. Please 
provide a reproducible example. Please read ?gPolygonize in the rgeos 
package or ?st_polygonize in the sf package.

On Mon, 13 Nov 2017, Javad Bayat via R-sig-Geo wrote:

> I have a shape file as poly line and I want to convert it to polygon.Is it possible to do that in R?
> lake <-readShapeLines("./lake_main_utm.shp")proj4string(lake) <- CRS("+proj=utm +zone=39 +datum=WGS84")
>
> Sincerely.
>
> Best Regards Javad Bayat Alternative Mail: j.bayat194 at gmail.com
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From facundo.munoz at cirad.fr  Mon Nov 13 16:33:19 2017
From: facundo.munoz at cirad.fr (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Mon, 13 Nov 2017 16:33:19 +0100
Subject: [R-sig-Geo] spacetime: creating STIDF objects
In-Reply-To: <4185a8dc-a2f6-8693-f5fb-f6890fd8e750@uni-muenster.de>
References: <permail-201711091410108218e1ae000037c5-rolandh@message-id.uni-muenster.de>
 <d1f80925-edec-3934-2b19-192817dfa323@cirad.fr>
 <4185a8dc-a2f6-8693-f5fb-f6890fd8e750@uni-muenster.de>
Message-ID: <7b128469-074a-b31d-5988-ac3bd0d4dfab@cirad.fr>

Dear Edzer,

thanks for your response. That's cool, but still it does not solve the
problem.

rbind can be useful for a full grid of observations in space-time, but
mine is sparse. So I really need the subset method `[` for
SpatialPolygons, which does not have this argument makeUniqueIDs.

However, you pointed me to the right direction, and from the code of
rbind I could manage to manually perform the subset and building a
replicated spatial object with unique IDs. The code reproducing the
example is in the GitHub issue [1].

In conclusion:

- It would be good to allow for makeUniqueIDs in the method `[`
for the class SpatialPolygons. That would avoid the manual crafting
of the replicated Spatial object

- I think stConstruct() should perform the subsetting internally for
consistency. So that the argument SpatialObj doesn't have a different
meaning dependind of whether x is a full grid or not.

- There is something else going on with |stplot()|, but the object is
correctly created.



[1] https://github.com/edzer/spacetime/issues/30


On 11/09/2017 03:52 PM, Edzer Pebesma wrote:
>
> On 11/09/2017 03:32 PM, Facundo Mu?oz wrote:
>> Hi Roland, thanks for your answer.
>>
>> However, this solution does not work when sp is a SpatialPolygons (which
>> is my case, of course):
>>
>>> rbind(sp, sp)
>> Error in validObject(res) :
>> ? invalid class ?SpatialPolygons? object: non-unique Polygons ID slot values
>>
> rbind(sp, sp, makeUniqueIDs = TRUE)
>
>> I'm sorry that my toy example didn't reproduce exactly my situation.
>>
>> Thanks in any case.
>>
>> ?acu.-
>>
>>
>> On 11/09/2017 03:10 PM, Roland Harhoff wrote:
>>> Hey Facundo,
>>>
>>> I'm not sure about the stConstruct issue (yet) ...
>>> but you can create a STIDF object from your example data by
>>>
>>> mystidf <- STIDF(rbind(sp,sp,sp,sp), mydata$time, mydata[ , "values", drop = F])
>>>
>>> See also the documentation ...
>>>
>>> ?spacetime::STIDF
>>>
>>> HTH so far ...!
>>>
>>> Best wishes ...
>>>
>>> Roland
>>>
>>>
>>> Facundo Mu?oz schrieb am 2017-11-09:
>>>> Dear all, I have just posted an issue [1] in the GitHub repository for
>>>> the "spacetime" package that I reproduce here:
>>>> I have a "long" table with irregular data (observations for some
>>>> municipalities at specific months) that I would like to store together
>>>> with the administrative map of the region (SpatialPolygons). I tried
>>>> unsuccessfully to directly create the STIDF object using both
>>>> `stConstruct()` and `STIDF`.
>>>> In all the related examples in the package you first create a STFDF
>>>> which is later coerced to STIDF. But my dataset is very sparse.
>>>> Here is a reproducible example adapted from the examples in the package.
>>>> If I use the complete table it leads to a STFDF object as expected and
>>>> it works fine. However if the table is not complete it should switch to
>>>> a STIDF representation (as far as I understand from the JSS paper).
>>>> ``` r
>>>> library(spacetime)
>>>> library(sp)
>>>> sp = cbind(x = c(0,0,1), y = c(0,1,1))
>>>> row.names(sp) = paste0("point", 1:nrow(sp))
>>>> sp = SpatialPoints(sp)
>>>> time = as.POSIXct("2010-08-05")+3600*(10:13)
>>>> m = c(10,20,30) # means for each of the 3 point locations
>>>> mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))
>>>> mydata = data.frame(
>>>> ? space = rep(row.names(sp), 4),
>>>> ? time? = rep(time, each = 3),
>>>> ? values = signif(mydata,3)
>>>> )
>>>> mystfdf <- stConstruct(mydata, "space", "time", sp)? # This works OK
>>>> mystidf <- stConstruct(mydata[-1,], "space", "time", sp)
>>>> #> Error: nrow(object at time) == length(object at sp) is not TRUE
>>>> ```
>>>> Thank you in advance.
>>>> ?acu.-
>>>> [1] https://github.com/edzer/spacetime/issues/30
>>>> --
>>>> Cirad <https://umr-astre.cirad.fr/>
>>>> *Facundo Mu?oz*
>>>> /Biostatistician/
>>>> Bios - UMR ASTRE
>>>> Bureau E-203 - TA A-117 / E
>>>> Campus international de Baillarguet
>>>> 34398 Montpellier Cedex 5
>>>> France
>>>> +33 467 593 868
>>>> @famuvie
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


From Andy.Bunn at wwu.edu  Mon Nov 13 20:40:10 2017
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 13 Nov 2017 19:40:10 +0000
Subject: [R-sig-Geo] aligning tick maks with coord_map and ggplot
Message-ID: <C8C79640-641A-4E8D-8A3F-C3FBE1955B98@wwu.edu>

Hi all, given the map below is there an easy way to align the tick marks and text with the graticule? Many thanks, Andy

p1 <- ggplot() + borders("world", colour="gray50", fill="gray50")
p1 <- p1 + coord_map("ortho", orientation = c(40, -110, 0),
                     xlim=c(-133,-96),ylim=c(17,54))
p1



From zuzulaz at gmail.com  Tue Nov 14 11:44:51 2017
From: zuzulaz at gmail.com (zuzana zajkova)
Date: Tue, 14 Nov 2017 11:44:51 +0100
Subject: [R-sig-Geo] aligning tick maks with coord_map and ggplot
In-Reply-To: <C8C79640-641A-4E8D-8A3F-C3FBE1955B98@wwu.edu>
References: <C8C79640-641A-4E8D-8A3F-C3FBE1955B98@wwu.edu>
Message-ID: <CADQCJLA6TGC+WYzJ540Vk-rambakfWnRKHbbE8fM+P7f0AHspw@mail.gmail.com>

Hi Andy,

try the geom_sf (not sure now but probably you would need the dev. version
of ggplot2).
Check http://ggplot2.tidyverse.org/reference/ggsf.html

library(maps)
world1 <- sf::st_as_sf(map('world', plot = FALSE, fill = TRUE))
ggplot() + geom_sf(data = world1)

Projected:
ggplot() +
  geom_sf(data = world1, colour="gray50", fill="gray50") +
  coord_sf(crs="+proj=ortho +y_0=0 +lon_0=-110 +lat_0=40", xlim=c(-2000000,
500000), ylim=c(-1800000, 2000000)) +
  scale_x_continuous(breaks=seq(-140, -100, 10)) +
  scale_y_continuous(breaks=seq(10, 60, 10))

Best,

Zuzana

________________________________________

*Zuzana Zajkov?*
PhD. student
Department of Evolutionary Biology, Ecology and Environmental Sciences |
Vertebrates
Faculty of Biology | University of Barcelona
Av. Diagonal 643, 08028  Barcelona, Spain
Email: zuzulaz at gmail.com

On 13 November 2017 at 20:40, Andy Bunn <Andy.Bunn at wwu.edu> wrote:

> Hi all, given the map below is there an easy way to align the tick marks
> and text with the graticule? Many thanks, Andy
>
> p1 <- ggplot() + borders("world", colour="gray50", fill="gray50")
> p1 <- p1 + coord_map("ortho", orientation = c(40, -110, 0),
>                      xlim=c(-133,-96),ylim=c(17,54))
> p1
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From s.falangabolognesi at gmail.com  Tue Nov 14 15:34:07 2017
From: s.falangabolognesi at gmail.com (Salvatore Falanga Bolognesi)
Date: Tue, 14 Nov 2017 15:34:07 +0100
Subject: [R-sig-Geo] Harmonized Surface Reflectance Product
Message-ID: <CAAfFO-mqxm=t1GjZ0=G4Y4FUNXEt+EEgkodptJH3ChhEoRxLPQ@mail.gmail.com>

I Have HLS products (for example go to see
https://hls.gsfc.nasa.gov/data/v1.3/sites/BE/S30/2017/31UDS/

HLS data are stored in Hierarchical Data Format (HDF)-4 compressed format.
Each HDF data file is
associated with an ENVI header file containing georeference information.
(
https://hls.gsfc.nasa.gov/wp-content/uploads/2017/08/HLS.v1.3.UserGuide_v2.pdf
)
I want to convert this data in to GeoTiff format.
Is it possible to do that in R?
Sincerely.
Salvatore

	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Tue Nov 14 21:55:08 2017
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Tue, 14 Nov 2017 21:55:08 +0100
Subject: [R-sig-Geo] GEOSTAT Summer School for PhD students August 19 - 26
 2018 | IBOT Prague, Czech Republic --- registrations are now open
Message-ID: <dabceec8-f4e7-5603-6b2c-a66d4a6b4d08@gmail.com>


The IBOT, Prague 2018 Summer School is the 13th in a series of summer 
schools organized by R and Open Source (OS) GIS developers and 
enthusiasts. GEOSTAT aims at PhD students and researchers in a range of 
environmental and GIS sciences, especially those focusing on analyzing 
spatial and spatio-temporal gridded data in R and OS GIS. The main idea 
of GEOSTAT is to promote various aspects of statistical analysis of 
spatial and spatio-temporal data using Open Source / free GIS languages 
and tools: R, Python, GRASS GIS, QGIS, SAGA GIS and similar. For more 
info see:

https://geostat-course.org/

The registrations are now open. In the case there are >60 registrations, 
we will rank regs based on the standard 4 criteria (read more at 
https://geostat-course.org/). After the registration close, selected 
applicants will be invited individually with detailed instructions 
(travel, accommodation, registration fees and similar).

The registrations fees are expected to be about 420 EUR (invoice will be 
sent after registrations). Registration fees cover costs of using 
facilities, lunch and coffee breaks and costs of travel and 
accommodation for lecturers. Participants from ODA countries (employed 
by an organization or company in ODA-listed country) and full-time 
students typically receive a subsidized price of 290 EUR for the 
registration costs.

Lecturers / topics (unsorted):

- Edzer Pebesma (IfGI University of Muenster, Muenster Germany):
?Simple features for R?,
?Tidy spatial data analysis with R?,
?Scalable raster data analysis in the cloud with R?,

- Roger Bivand (Department of Economics, Norwegian School of Economics, 
Bergen, Norway)
?A practical history of R (where things came from)?,
?Spatial processes and support (multi-level models)?,
?Applied spatial econometrics?,

- Markus Neteler (Mundialis, Bonn, Germany):
?Analysing environmental data with GRASS GIS?

- Barry Rowlingson (Lancaster Medical School, Lancaster, UK):
?Spatial analysis in epidemiology?
?Combining R and Python for spatial analysis?

- Tim Appelhans (GfK Geomarketing, Germany):
?Using mapview and mapedit to visualise and edit geo-spatial data 
interactively in R?,

- Robin Lovelace (University of Leeds, UK):
?Geocomputation with R?,
?Integrating spatial data in dplyr workflows: pitfalls and potential?,
?Modelling transport data with R?

- Jannes M?nchow (Geographic Information Science, Friedrich Schiller 
University Jena, Jena, Germany)
?R-GIS bridges: the examples of RQGIS and RSAGA?,
?Spatial modeling using frequentist models, e.g., modeling species 
richness, single species and/or landslides (RQGIS, RSAGA and rgrass7 
tutorials)?
?The importance of spatial cross-validation in predictive modeling?

- Jakub Nowosad (Space Informatics Lab, University of Cincinnati, Ohio USA):
?GeoPAT 2.0 - analysis of spatial and temporal patterns?

- Tomislav Hengl (Wageningen, the Netherlands):
?Mapping biomes and tree species using Machine Learning?
?Computing with large rasters in R: tiling, parallelization, optimization?

The GEOSTAT 2018 Summer School will be hosted by the Institute of Botany 
(IBOT) which is part of the Czech largest national research institution 
- The Czech academy of Sciences. IBOT seat in village near Prague, in 
Pruhonice in ancient castle with huge park. Pruhonice castle and park 
are listed by UNESCO.


From mli11 at unb.ca  Wed Nov 15 02:46:16 2017
From: mli11 at unb.ca (Mingke Li)
Date: Wed, 15 Nov 2017 01:46:16 +0000
Subject: [R-sig-Geo] Autologistic regression in R
Message-ID: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>

Hi,

I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.

I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model to analyze which factors or combinations of factors have effects on the presence/absence of the insect (1 or 0).

I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?

Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?

Many Thanks.

Erin


	[[alternative HTML version deleted]]


From eliaskrainski at gmail.com  Wed Nov 15 07:04:27 2017
From: eliaskrainski at gmail.com (Elias T Krainski)
Date: Wed, 15 Nov 2017 09:04:27 +0300
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <9f3727f9-229c-c211-12c5-e85e099e1ace@gmail.com>

Hi,

Have you tried http://leg.ufpr.br/Rcitrus ?

Elias

On 15/11/17 04:46, Mingke Li wrote:
> Hi,
>
> I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.
>
> I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model to analyze which factors or combinations of factors have effects on the presence/absence of the insect (1 or 0).
>
> I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?
>
> Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?
>
> Many Thanks.
>
> Erin
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From bfalevlist at gmail.com  Wed Nov 15 07:49:43 2017
From: bfalevlist at gmail.com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Wed, 15 Nov 2017 07:49:43 +0100
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <9f3727f9-229c-c211-12c5-e85e099e1ace@gmail.com>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
 <9f3727f9-229c-c211-12c5-e85e099e1ace@gmail.com>
Message-ID: <4b83c6a6-7200-b00b-bcee-b7668ad4d81e@gmail.com>

Hi Erin,

Although I'm not familiar with autologistic regression, the task you 
outlined seems to be a Species Distribution Modeling (SDM) problem for 
which several methods are available in R. So I'm not sure if you need 
only and exclusively autologistic regression. The SDM methods can solve 
the equation /pres = f(env1, env2, ...)/, where /pres /is 
presence/absence of the species and/envN/s are environmental predictors. 
See packages "/dismo/" and "/biomod2/", and also /vignette("sdm")/. Some 
of the methods need data.frame or SpatialPointsDataFrame, other ones 
need Raster* objects as input.

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences

2017.11.15. 7:04 keltez?ssel, Elias T Krainski ?rta:
> Hi,
>
> Have you tried http://leg.ufpr.br/Rcitrus ?
>
> Elias
>
> On 15/11/17 04:46, Mingke Li wrote:
>> Hi,
>>
>> I am new to autologistic regression and R. I do have questions when 
>> starting a project in which I believe autologistic regression (spdep 
>> package) is needed.
>>
>> I have a point layer whose attribute table stores the values of the 
>> dependent variable (population of a kind of insect), all the 
>> independent variables (environmental factors), and the associated 
>> latitude and longitude. I hope to to fit an autologistic model to 
>> analyze which factors or combinations of factors have effects on the 
>> presence/absence of the insect (1 or 0).
>>
>> I found other papers which applied autologistic regression in their 
>> study almost used a grid system and defined their window sizes. So, 
>> my question is do I have to convert my point layer into a grid system 
>> if I want to do this analysis with R?
>>
>> Also, what should I consider when I generate the grid system? How to 
>> determine a proper cell size? How about the searching window 
>> (neighbourhood) size?
>>
>> Many Thanks.
>>
>> Erin
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


	[[alternative HTML version deleted]]


From nivdemalach at gmail.com  Wed Nov 15 11:19:36 2017
From: nivdemalach at gmail.com (niv de malach)
Date: Wed, 15 Nov 2017 12:19:36 +0200
Subject: [R-sig-Geo] Why PCNM (MEM) approach cannot remove spatial
	autocorrelation in the residuals?
Message-ID: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>

Hi,
I am trying to include spatial eigenvectors ( in my regression using *dbmem
*command from *adespatial* package) in order to account for spatial
correlation. The problem is that even after including all the positive
eigenvectors there is still a positive significant spatial autocorrelation
in the residuals (based on Moran's I test). The magnitude of this problem
is affected by the styles I use for the spatial weight (using the styles
"U","W" "B" "C" of the function *nb2list* from *spdep*) but in all styles
Moran's I is still significantly positive.

Interestingly this problem doesn't occur when I use a SAR models (
*errorsarlm* command from *spdep* package).

So, does it make sense to use PCNM approach when it removes only a portion
the spatial autocorrelation?

Thanks
Niv

?

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Nov 15 11:24:46 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Nov 2017 11:24:46 +0100
Subject: [R-sig-Geo] Why PCNM (MEM) approach cannot remove spatial
 autocorrelation in the residuals?
In-Reply-To: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>
References: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1711151121150.15169@reclus.nhh.no>

On Wed, 15 Nov 2017, niv de malach wrote:

> Hi,
> I am trying to include spatial eigenvectors ( in my regression using *dbmem
> *command from *adespatial* package) in order to account for spatial
> correlation. The problem is that even after including all the positive
> eigenvectors there is still a positive significant spatial autocorrelation
> in the residuals (based on Moran's I test). The magnitude of this problem
> is affected by the styles I use for the spatial weight (using the styles
> "U","W" "B" "C" of the function *nb2list* from *spdep*) but in all styles
> Moran's I is still significantly positive.

Maybe there is negative residual autocorrelation, and only choosing 
eigenvectors matching positive eigenvalues is enhancing pattern jumble 
(oversmoothing the model leaving jumble in the residuals)? Do you have an 
example you could share (link to offline downloadable code+data if need 
be)?

Roger

>
> Interestingly this problem doesn't occur when I use a SAR models (
> *errorsarlm* command from *spdep* package).
>
> So, does it make sense to use PCNM approach when it removes only a portion
> the spatial autocorrelation?
>
> Thanks
> Niv
>
> ?
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From nivdemalach at gmail.com  Wed Nov 15 12:01:41 2017
From: nivdemalach at gmail.com (niv de malach)
Date: Wed, 15 Nov 2017 13:01:41 +0200
Subject: [R-sig-Geo] Why PCNM (MEM) approach cannot remove spatial
 autocorrelation in the residuals?
In-Reply-To: <alpine.LFD.2.21.1711151121150.15169@reclus.nhh.no>
References: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>
 <alpine.LFD.2.21.1711151121150.15169@reclus.nhh.no>
Message-ID: <CAHxNAtkquoVck59yd+q_BV7k1Lix_m_xkMd7PSxGLX4e+BOfBg@mail.gmail.com>

Attaching the code and the dataset:


# code
library(spdep)
library(adespatial)
mydata=read.csv("example_data.csv",header=TRUE)
attach(mydata)


# creating neighbors map from the coordinates
xy=SpatialPoints(as.matrix(mydata[,c(5,6)]))
myneighbors=dnearneigh(as.matrix(mydata[,c(5,6)]), 0, 1000, row.names =
NULL, longlat = TRUE)# 1000 kilometer distance
myweight=nb2listw(myneighbors,style="W") # style W
# creating PCNM
spatial_eigenvectors=dbmem(as.matrix(mydata[,c(5,6)]),MEM.autocor="positive")

# simple regression model
alpha_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover) #
summary(alpha_lm)
moran.test(alpha_lm$residuals,myweight) # significant spatial autocorelation


# regression model with all positive eigenvectors
PCNM_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover+

 spatial_eigenvectors[,1]+spatial_eigenvectors[,2]+spatial_eigenvectors[,3]+

 spatial_eigenvectors[,4]+spatial_eigenvectors[,5]+spatial_eigenvectors[,6]+

 spatial_eigenvectors[,7]+spatial_eigenvectors[,8]+spatial_eigenvectors[,9]+

 spatial_eigenvectors[,10]+spatial_eigenvectors[,11]+spatial_eigenvectors[,12])

summary(PCNM_lm)
moran.test(PCNM_lm$residuals,myweight) # significant spatial autocorelation


# SAR error regression model
sar_alpha=errorsarlm(alpha~evenness+I_A+gamma+herb_cover+woody_cover,data=mydata,myweight)
summary(sar_alpha)
moran.test(sar_alpha$residuals,myweight) # no spatial autocorelation






On Wed, Nov 15, 2017 at 12:24 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 15 Nov 2017, niv de malach wrote:
>
> Hi,
>> I am trying to include spatial eigenvectors ( in my regression using
>> *dbmem
>> *command from *adespatial* package) in order to account for spatial
>> correlation. The problem is that even after including all the positive
>> eigenvectors there is still a positive significant spatial autocorrelation
>> in the residuals (based on Moran's I test). The magnitude of this problem
>> is affected by the styles I use for the spatial weight (using the styles
>> "U","W" "B" "C" of the function *nb2list* from *spdep*) but in all styles
>> Moran's I is still significantly positive.
>>
>
> Maybe there is negative residual autocorrelation, and only choosing
> eigenvectors matching positive eigenvalues is enhancing pattern jumble
> (oversmoothing the model leaving jumble in the residuals)? Do you have an
> example you could share (link to offline downloadable code+data if need be)?
>
> Roger
>
>
>> Interestingly this problem doesn't occur when I use a SAR models (
>> *errorsarlm* command from *spdep* package).
>>
>> So, does it make sense to use PCNM approach when it removes only a portion
>> the spatial autocorrelation?
>>
>> Thanks
>> Niv
>>
>> ?
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, No
> <https://maps.google.com/?q=Economics,+No&entry=gmail&source=g>rwegian
> School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20171115/7150e96d/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example_data.csv
Type: text/csv
Size: 22231 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20171115/7150e96d/attachment.csv>

From Roger.Bivand at nhh.no  Wed Nov 15 12:59:27 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Nov 2017 12:59:27 +0100
Subject: [R-sig-Geo] Why PCNM (MEM) approach cannot remove spatial
 autocorrelation in the residuals?
In-Reply-To: <CAHxNAtkquoVck59yd+q_BV7k1Lix_m_xkMd7PSxGLX4e+BOfBg@mail.gmail.com>
References: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>
 <alpine.LFD.2.21.1711151121150.15169@reclus.nhh.no>
 <CAHxNAtkquoVck59yd+q_BV7k1Lix_m_xkMd7PSxGLX4e+BOfBg@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1711151230090.15169@reclus.nhh.no>

On Wed, 15 Nov 2017, niv de malach wrote:

> Attaching the code and the dataset:
>

Thanks for the example, very helpful:

>
> # code
> library(spdep)
> library(adespatial)
> mydata=read.csv("example_data.csv",header=TRUE)
> attach(mydata)
>

Don't use attach, in modelling use data=.

>
> # creating neighbors map from the coordinates
> xy=SpatialPoints(as.matrix(mydata[,c(5,6)]))
> myneighbors=dnearneigh(as.matrix(mydata[,c(5,6)]), 0, 1000, row.names =
> NULL, longlat = TRUE)# 1000 kilometer distance
> myweight=nb2listw(myneighbors,style="W") # style W
> # creating PCNM
> spatial_eigenvectors=dbmem(as.matrix(mydata[,c(5,6)]),MEM.autocor="positive")

The body is buried here ^^^

adespatial::dbmem constructs a completely different weights matrix 
internally from your coordinates. I see:

> attr(spatial_eigenvectors, "listw")
Characteristics of weights list object:
Neighbour list object:
Number of regions: 233
Number of nonzero links: 25604
Percentage nonzero weights: 47.16241
Average number of links: 109.8884

Weights style: B
Weights constants summary:
     n    nn       S0       S1       S2
B 233 54289 25169.11 49501.47 12272171

retreived by setting store.listw=TRUE - this does not respect longlat 
either, I believe, so the eigenvectors are taken from this. Your weights 
are:

> myweight
Characteristics of weights list object:
Neighbour list object:
Number of regions: 233
Number of nonzero links: 8260
Percentage nonzero weights: 15.21487
Average number of links: 35.45064

Weights style: W
Weights constants summary:
     n    nn  S0       S1       S2
W 233 54289 233 34.27034 939.7534

Using the correct lm.morantest():

> lm.morantest(PCNM_lm, attr(spatial_eigenvectors, "listw"), 
alternative="two.sided") # significant spatial autocorelation

 	Global Moran I for regression residuals

data:
model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
woody_cover + spatial_eigenvectors[, 1] + spatial_eigenvectors[, 2] +
spatial_eigenvectors[, 3] + spatial_eigenvectors[, 4] +
spatial_eigenvectors[, 5] + spatial_eigenvectors[, 6] +
spatial_eigenvectors[, 7] + spatial_eigenvectors[, 8] +
spatial_eigenvectors[, 9] + spatial_eigenvectors[, 10] +
spatial_eigenvectors[, 11] + spatial_eigenvectors[, 12], data = mydata)
weights: attr(spatial_eigenvectors, "listw")

Moran I statistic standard deviate = -9.7467, p-value < 2.2e-16
alternative hypothesis: two.sided
sample estimates:
Observed Moran I      Expectation         Variance
    -2.481095e-02    -1.159734e-02     1.837913e-06

> lm.morantest(PCNM_lm, myweight, alternative="two.sided")
 	Global Moran I for regression residuals

data:
model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
woody_cover + spatial_eigenvectors[, 1] + spatial_eigenvectors[, 2] +
spatial_eigenvectors[, 3] + spatial_eigenvectors[, 4] +
spatial_eigenvectors[, 5] + spatial_eigenvectors[, 6] +
spatial_eigenvectors[, 7] + spatial_eigenvectors[, 8] +
spatial_eigenvectors[, 9] + spatial_eigenvectors[, 10] +
spatial_eigenvectors[, 11] + spatial_eigenvectors[, 12], data = mydata)
weights: myweight

Moran I statistic standard deviate = 7.1459, p-value = 8.943e-13
alternative hypothesis: two.sided
sample estimates:
Observed Moran I      Expectation         Variance
     0.0900654150    -0.0350231024     0.0003064253

The actual weights used in dbmem show significant negative residual 
autocorrelation, using your weights, you see positive, because the weights 
were not the same. Using spdep::SpatialFiltering() - see reference there - 
the eigenvectors are chosen by brute force search to remove 
autocorrelation from the residuals:

> SF <- SpatialFiltering(alpha ~ evenness + I_A + gamma + herb_cover + 
woody_cover, data = mydata, nb=myneighbors, style="W", ExactEV=TRUE)

> SF_fit <- lm(alpha ~ evenness + I_A + gamma + herb_cover + woody_cover + 
fitted(SF), data = mydata)
> lm.morantest(SF_fit, myweight)

 	Global Moran I for regression residuals

data:
model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
woody_cover + fitted(SF), data = mydata)
weights: myweight

Moran I statistic standard deviate = 0.19667, p-value = 0.422
alternative hypothesis: greater
sample estimates:
Observed Moran I      Expectation         Variance
    -0.0333289800    -0.0370711350     0.0003620337
> lm.morantest(SF_fit, attr(spatial_eigenvectors, "listw"))

 	Global Moran I for regression residuals

data:
model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
woody_cover + fitted(SF), data = mydata)
weights: attr(spatial_eigenvectors, "listw")

Moran I statistic standard deviate = 1.371, p-value = 0.08519
alternative hypothesis: greater
sample estimates:
Observed Moran I      Expectation         Variance
    -5.700770e-03    -8.090576e-03     3.038630e-06

Choosing eigenvectors from the listw object returned by dbmem is rather 
time-consuming, suggesting that dbmem should pass through longlat= to be 
used internally by spdep::dnearneigh() and spdep::nbdists() used 
internally; you could then use the threshold argument. Do use 
spdep::lm.morantest() on regression residuals; note 
that there is no proper test for residual autocorrelation for fitted 
spatial regression models.

Hope this clarifies,

Roger

>
> # simple regression model
> alpha_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover) #
> summary(alpha_lm)
> moran.test(alpha_lm$residuals,myweight) # significant spatial autocorelation
>
>
> # regression model with all positive eigenvectors
> PCNM_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover+
>
> spatial_eigenvectors[,1]+spatial_eigenvectors[,2]+spatial_eigenvectors[,3]+
>
> spatial_eigenvectors[,4]+spatial_eigenvectors[,5]+spatial_eigenvectors[,6]+
>
> spatial_eigenvectors[,7]+spatial_eigenvectors[,8]+spatial_eigenvectors[,9]+
>
> spatial_eigenvectors[,10]+spatial_eigenvectors[,11]+spatial_eigenvectors[,12])
>
> summary(PCNM_lm)
> moran.test(PCNM_lm$residuals,myweight) # significant spatial autocorelation
>
>
> # SAR error regression model
> sar_alpha=errorsarlm(alpha~evenness+I_A+gamma+herb_cover+woody_cover,data=mydata,myweight)
> summary(sar_alpha)
> moran.test(sar_alpha$residuals,myweight) # no spatial autocorelation
>
>
>
>
>
>
> On Wed, Nov 15, 2017 at 12:24 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 15 Nov 2017, niv de malach wrote:
>>
>> Hi,
>>> I am trying to include spatial eigenvectors ( in my regression using
>>> *dbmem
>>> *command from *adespatial* package) in order to account for spatial
>>> correlation. The problem is that even after including all the positive
>>> eigenvectors there is still a positive significant spatial autocorrelation
>>> in the residuals (based on Moran's I test). The magnitude of this problem
>>> is affected by the styles I use for the spatial weight (using the styles
>>> "U","W" "B" "C" of the function *nb2list* from *spdep*) but in all styles
>>> Moran's I is still significantly positive.
>>>
>>
>> Maybe there is negative residual autocorrelation, and only choosing
>> eigenvectors matching positive eigenvalues is enhancing pattern jumble
>> (oversmoothing the model leaving jumble in the residuals)? Do you have an
>> example you could share (link to offline downloadable code+data if need be)?
>>
>> Roger
>>
>>
>>> Interestingly this problem doesn't occur when I use a SAR models (
>>> *errorsarlm* command from *spdep* package).
>>>
>>> So, does it make sense to use PCNM approach when it removes only a portion
>>> the spatial autocorrelation?
>>>
>>> Thanks
>>> Niv
>>>
>>> ?
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, No
>> <https://maps.google.com/?q=Economics,+No&entry=gmail&source=g>rwegian
>> School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
>> http://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
>
> ?
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From rubak at math.aau.dk  Wed Nov 15 15:59:05 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Wed, 15 Nov 2017 15:59:05 +0100
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <bbb14eb8-bff3-d7aa-1170-76d3a5d92671@math.aau.dk>

Hi Erin,

It is not quite clear to me what your data is. From your text I 
understand that you have a number of locations where you have measured 
the population of a specific insect (count variable?) together with 
independent/explanatory variables at these same locations. Is the 
"population" sometimes zero? Is it even restricted to be binary (0/1), 
which I guess would be required for logistic regression to make sense?

Cheers,
Ege

On 11/15/2017 02:46 AM, Mingke Li wrote:
> Hi,
> 
> I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.
> 
> I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model to analyze which factors or combinations of factors have effects on the presence/absence of the insect (1 or 0).
> 
> I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?
> 
> Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?
> 
> Many Thanks.
> 
> Erin
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From nivdemalach at gmail.com  Wed Nov 15 16:31:14 2017
From: nivdemalach at gmail.com (niv de malach)
Date: Wed, 15 Nov 2017 17:31:14 +0200
Subject: [R-sig-Geo] Why PCNM (MEM) approach cannot remove spatial
 autocorrelation in the residuals?
In-Reply-To: <alpine.LFD.2.21.1711151230090.15169@reclus.nhh.no>
References: <CAHxNAtnaR2qNHbvU_+dGOSor6Jj7Ng4gJUHOak+Nn1cAsYfCkA@mail.gmail.com>
 <alpine.LFD.2.21.1711151121150.15169@reclus.nhh.no>
 <CAHxNAtkquoVck59yd+q_BV7k1Lix_m_xkMd7PSxGLX4e+BOfBg@mail.gmail.com>
 <alpine.LFD.2.21.1711151230090.15169@reclus.nhh.no>
Message-ID: <CAHxNAtmZ2=tNcXbgkk4bcEfOTazSXQTvY01aoLR3jRkv0MGi5g@mail.gmail.com>

Now everything is clear.
Thanks a lot,
Niv
?

On Wed, Nov 15, 2017 at 1:59 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 15 Nov 2017, niv de malach wrote:
>
> Attaching the code and the dataset:
>>
>>
> Thanks for the example, very helpful:
>
>
>> # code
>> library(spdep)
>> library(adespatial)
>> mydata=read.csv("example_data.csv",header=TRUE)
>> attach(mydata)
>>
>>
> Don't use attach, in modelling use data=.
>
>
>> # creating neighbors map from the coordinates
>> xy=SpatialPoints(as.matrix(mydata[,c(5,6)]))
>> myneighbors=dnearneigh(as.matrix(mydata[,c(5,6)]), 0, 1000, row.names =
>> NULL, longlat = TRUE)# 1000 kilometer distance
>> myweight=nb2listw(myneighbors,style="W") # style W
>> # creating PCNM
>> spatial_eigenvectors=dbmem(as.matrix(mydata[,c(5,6)]),MEM.au
>> tocor="positive")
>>
>
> The body is buried here ^^^
>
> adespatial::dbmem constructs a completely different weights matrix
> internally from your coordinates. I see:
>
> attr(spatial_eigenvectors, "listw")
>>
> Characteristics of weights list object:
> Neighbour list object:
> Number of regions: 233
> Number of nonzero links: 25604
> Percentage nonzero weights: 47.16241
> Average number of links: 109.8884
>
> Weights style: B
> Weights constants summary:
>     n    nn       S0       S1       S2
> B 233 54289 25169.11 49501.47 12272171
>
> retreived by setting store.listw=TRUE - this does not respect longlat
> either, I believe, so the eigenvectors are taken from this. Your weights
> are:
>
> myweight
>>
> Characteristics of weights list object:
> Neighbour list object:
> Number of regions: 233
> Number of nonzero links: 8260
> Percentage nonzero weights: 15.21487
> Average number of links: 35.45064
>
> Weights style: W
> Weights constants summary:
>     n    nn  S0       S1       S2
> W 233 54289 233 34.27034 939.7534
>
> Using the correct lm.morantest():
>
> lm.morantest(PCNM_lm, attr(spatial_eigenvectors, "listw"),
>>
> alternative="two.sided") # significant spatial autocorelation
>
>         Global Moran I for regression residuals
>
> data:
> model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
> woody_cover + spatial_eigenvectors[, 1] + spatial_eigenvectors[, 2] +
> spatial_eigenvectors[, 3] + spatial_eigenvectors[, 4] +
> spatial_eigenvectors[, 5] + spatial_eigenvectors[, 6] +
> spatial_eigenvectors[, 7] + spatial_eigenvectors[, 8] +
> spatial_eigenvectors[, 9] + spatial_eigenvectors[, 10] +
> spatial_eigenvectors[, 11] + spatial_eigenvectors[, 12], data = mydata)
> weights: attr(spatial_eigenvectors, "listw")
>
> Moran I statistic standard deviate = -9.7467, p-value < 2.2e-16
> alternative hypothesis: two.sided
> sample estimates:
> Observed Moran I      Expectation         Variance
>    -2.481095e-02    -1.159734e-02     1.837913e-06
>
> lm.morantest(PCNM_lm, myweight, alternative="two.sided")
>>
>         Global Moran I for regression residuals
>
> data:
> model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
> woody_cover + spatial_eigenvectors[, 1] + spatial_eigenvectors[, 2] +
> spatial_eigenvectors[, 3] + spatial_eigenvectors[, 4] +
> spatial_eigenvectors[, 5] + spatial_eigenvectors[, 6] +
> spatial_eigenvectors[, 7] + spatial_eigenvectors[, 8] +
> spatial_eigenvectors[, 9] + spatial_eigenvectors[, 10] +
> spatial_eigenvectors[, 11] + spatial_eigenvectors[, 12], data = mydata)
> weights: myweight
>
> Moran I statistic standard deviate = 7.1459, p-value = 8.943e-13
> alternative hypothesis: two.sided
> sample estimates:
> Observed Moran I      Expectation         Variance
>     0.0900654150    -0.0350231024     0.0003064253
>
> The actual weights used in dbmem show significant negative residual
> autocorrelation, using your weights, you see positive, because the weights
> were not the same. Using spdep::SpatialFiltering() - see reference there -
> the eigenvectors are chosen by brute force search to remove autocorrelation
> from the residuals:
>
> SF <- SpatialFiltering(alpha ~ evenness + I_A + gamma + herb_cover +
>>
> woody_cover, data = mydata, nb=myneighbors, style="W", ExactEV=TRUE)
>
> SF_fit <- lm(alpha ~ evenness + I_A + gamma + herb_cover + woody_cover +
>>
> fitted(SF), data = mydata)
>
>> lm.morantest(SF_fit, myweight)
>>
>
>         Global Moran I for regression residuals
>
> data:
> model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
> woody_cover + fitted(SF), data = mydata)
> weights: myweight
>
> Moran I statistic standard deviate = 0.19667, p-value = 0.422
> alternative hypothesis: greater
> sample estimates:
> Observed Moran I      Expectation         Variance
>    -0.0333289800    -0.0370711350     0.0003620337
>
>> lm.morantest(SF_fit, attr(spatial_eigenvectors, "listw"))
>>
>
>         Global Moran I for regression residuals
>
> data:
> model: lm(formula = alpha ~ evenness + I_A + gamma + herb_cover +
> woody_cover + fitted(SF), data = mydata)
> weights: attr(spatial_eigenvectors, "listw")
>
> Moran I statistic standard deviate = 1.371, p-value = 0.08519
> alternative hypothesis: greater
> sample estimates:
> Observed Moran I      Expectation         Variance
>    -5.700770e-03    -8.090576e-03     3.038630e-06
>
> Choosing eigenvectors from the listw object returned by dbmem is rather
> time-consuming, suggesting that dbmem should pass through longlat= to be
> used internally by spdep::dnearneigh() and spdep::nbdists() used
> internally; you could then use the threshold argument. Do use
> spdep::lm.morantest() on regression residuals; note that there is no proper
> test for residual autocorrelation for fitted spatial regression models.
>
> Hope this clarifies,
>
> Roger
>
>
>> # simple regression model
>> alpha_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover) #
>> summary(alpha_lm)
>> moran.test(alpha_lm$residuals,myweight) # significant spatial
>> autocorelation
>>
>>
>> # regression model with all positive eigenvectors
>> PCNM_lm=lm(alpha~evenness+I_A+gamma+herb_cover+woody_cover+
>>
>> spatial_eigenvectors[,1]+spatial_eigenvectors[,2]+spatial_
>> eigenvectors[,3]+
>>
>> spatial_eigenvectors[,4]+spatial_eigenvectors[,5]+spatial_
>> eigenvectors[,6]+
>>
>> spatial_eigenvectors[,7]+spatial_eigenvectors[,8]+spatial_
>> eigenvectors[,9]+
>>
>> spatial_eigenvectors[,10]+spatial_eigenvectors[,11]+spatial_
>> eigenvectors[,12])
>>
>> summary(PCNM_lm)
>> moran.test(PCNM_lm$residuals,myweight) # significant spatial
>> autocorelation
>>
>>
>> # SAR error regression model
>> sar_alpha=errorsarlm(alpha~evenness+I_A+gamma+herb_cover+woo
>> dy_cover,data=mydata,myweight)
>> summary(sar_alpha)
>> moran.test(sar_alpha$residuals,myweight) # no spatial autocorelation
>>
>>
>>
>>
>>
>>
>> On Wed, Nov 15, 2017 at 12:24 PM, Roger Bivand <Roger.Bivand at nhh.no>
>> wrote:
>>
>> On Wed, 15 Nov 2017, niv de malach wrote:
>>>
>>> Hi,
>>>
>>>> I am trying to include spatial eigenvectors ( in my regression using
>>>> *dbmem
>>>> *command from *adespatial* package) in order to account for spatial
>>>> correlation. The problem is that even after including all the positive
>>>> eigenvectors there is still a positive significant spatial
>>>> autocorrelation
>>>> in the residuals (based on Moran's I test). The magnitude of this
>>>> problem
>>>> is affected by the styles I use for the spatial weight (using the styles
>>>> "U","W" "B" "C" of the function *nb2list* from *spdep*) but in all
>>>> styles
>>>> Moran's I is still significantly positive.
>>>>
>>>>
>>> Maybe there is negative residual autocorrelation, and only choosing
>>> eigenvectors matching positive eigenvalues is enhancing pattern jumble
>>> (oversmoothing the model leaving jumble in the residuals)? Do you have an
>>> example you could share (link to offline downloadable code+data if need
>>> be)?
>>>
>>> Roger
>>>
>>>
>>> Interestingly this problem doesn't occur when I use a SAR models (
>>>> *errorsarlm* command from *spdep* package).
>>>>
>>>> So, does it make sense to use PCNM approach when it removes only a
>>>> portion
>>>> the spatial autocorrelation?
>>>>
>>>> Thanks
>>>> Niv
>>>>
>>>> ?
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, No
>>> <https://maps.google.com/?q=Economics,+No&entry=gmail&source=g>rwegian
>>> School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>> Editor-in-Chief of The R Journal, https://journal.r-project.org/
>>> index.html
>>> http://orcid.org/0000-0003-2392-6140
>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>
>>
>>
>> ?
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
> http://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From mli11 at unb.ca  Wed Nov 15 16:44:03 2017
From: mli11 at unb.ca (Mingke Li)
Date: Wed, 15 Nov 2017 15:44:03 +0000
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <bbb14eb8-bff3-d7aa-1170-76d3a5d92671@math.aau.dk>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>,
 <bbb14eb8-bff3-d7aa-1170-76d3a5d92671@math.aau.dk>
Message-ID: <YQBPR0101MB18432CFF2B029F5878B96688C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>

Hi Ege,


Thanks for replying. Sorry for not clearfying the data.


The raw response data is the actural population counted at the specific sample points. Because my study object is spruce budworm which would cause forest defoliation, what we are interested in are those sample points where spruce budworm population is greater than 7 per brunch. Some of the sample points have zero population, and some have population fewer than 7 per brunch, but these samples don't attract us because spruce budworm are always there; fewer than 7 per brunch is not a problem for forests.


So what I understand is to set 7 as a threshold to transform the raw response data to 0 (population<7) and 1(population>=7). Also some papers point out the significance of encountering the spatial autocorrelation when dealing these species distribution problem, that is why I come across the autologistic regression.


This approach is so new to me, so I may have some misunderstanding. Thanks again.


Erin

________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Ege Rubak <rubak at math.aau.dk>
Sent: November 15, 2017 10:59:05 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Autologistic regression in R

Hi Erin,

It is not quite clear to me what your data is. From your text I
understand that you have a number of locations where you have measured
the population of a specific insect (count variable?) together with
independent/explanatory variables at these same locations. Is the
"population" sometimes zero? Is it even restricted to be binary (0/1),
which I guess would be required for logistic regression to make sense?

Cheers,
Ege

On 11/15/2017 02:46 AM, Mingke Li wrote:
> Hi,
>
> I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.
>
> I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model to analyze which factors or combinations of factors have effects on the presence/absence of the insect (1 or 0).
>
> I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?
>
> Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?
>
> Many Thanks.
>
> Erin
>
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From rubak at math.aau.dk  Wed Nov 15 18:25:06 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Wed, 15 Nov 2017 18:25:06 +0100
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <YQBPR0101MB18432CFF2B029F5878B96688C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
 <bbb14eb8-bff3-d7aa-1170-76d3a5d92671@math.aau.dk>
 <YQBPR0101MB18432CFF2B029F5878B96688C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <dcb25702-f46d-4a64-7cce-0ab745e3a7d1@math.aau.dk>

OK. At least that helps people understand the basic properties of the data.
The sampling design could also be important for the choice of method. 
You should probably make this part a bit more clear and answer questions 
like:
- Did you make a sparse random sample of locations in a big area?
- Or did you sample a predefined small area extensively?
- Etc...
I can't really offer any specific help, but I would advise you to add a 
bit more detail in case it rings a bell for a helpful soul out there.
/Ege

On 11/15/2017 04:44 PM, Mingke Li wrote:
> Hi Ege,
> 
> 
> Thanks for replying. Sorry for not clearfying the data.
> 
> 
> The raw response data is the actural population counted at the specific 
> sample points. Because my study object is spruce budworm which would 
> cause forest defoliation, what we are interested in are those sample 
> points where spruce budworm population is greater than 7 per brunch. 
> Some of the sample points have zero population, and some have population 
> fewer than 7 per brunch, but these samples don't attract us because 
> spruce budworm are always there; fewer than 7 per brunch?is not a 
> problem for forests.
> 
> 
> So what I understand is to set 7 as a threshold to transform the raw 
> response data to 0 (population<7) and 1(population>=7). Also some papers 
> point out the significance of encountering?the?spatial autocorrelation 
> when dealing these species distribution problem, that is why I come 
> across the autologistic regression.
> 
> 
> This approach is so new to me, so I may have some misunderstanding. 
> Thanks again.
> 
> 
> Erin
> 
> ------------------------------------------------------------------------
> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Ege 
> Rubak <rubak at math.aau.dk>
> *Sent:* November 15, 2017 10:59:05 AM
> *To:* r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Autologistic regression in R
> Hi Erin,
> 
> It is not quite clear to me what your data is. From your text I
> understand that you have a number of locations where you have measured
> the population of a specific insect (count variable?) together with
> independent/explanatory variables at these same locations. Is the
> "population" sometimes zero? Is it even restricted to be binary (0/1),
> which I guess would be required for logistic regression to make sense?
> 
> Cheers,
> Ege
> 
> On 11/15/2017 02:46 AM, Mingke Li wrote:
>> Hi,
>> 
>> I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.
>> 
>> I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model  to analyze which factors or combinations of factors have effects on 
> the presence/absence of the insect (1 or 0).
>> 
>> I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?
>> 
>> Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?
>> 
>> Many Thanks.
>> 
>> Erin
>> 
>> 
>>??????? [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From marcelino.delacruz at urjc.es  Wed Nov 15 18:47:52 2017
From: marcelino.delacruz at urjc.es (Marcelino de la Cruz Rot)
Date: Wed, 15 Nov 2017 18:47:52 +0100
Subject: [R-sig-Geo] Autologistic regression in R
In-Reply-To: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
References: <YQBPR0101MB1843034E66E366E960C609C9C7290@YQBPR0101MB1843.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <16c6e999-03eb-5f91-9091-a9088f7ffe15@urjc.es>

Hi Mingke Li,

Dorman et al. (2007) review different methods to account for spatial 
dependence in linear models, including the use of autocovariables, and 
provide R code for them.

HTH,

Marcelino

Dormann, et al. 2007. Methods to account for spatial autocorrelation in 
the analysis of species distributional data: a review. ? Ecography 30: 
609?628.

http://www.ecography.org/appendix/e5171



El 15/11/2017 a las 2:46, Mingke Li escribi?:
> Hi,
>
> I am new to autologistic regression and R. I do have questions when starting a project in which I believe autologistic regression (spdep package) is needed.
>
> I have a point layer whose attribute table stores the values of the dependent variable (population of a kind of insect), all the independent variables (environmental factors), and the associated latitude and longitude. I hope to to fit an autologistic model to analyze which factors or combinations of factors have effects on the presence/absence of the insect (1 or 0).
>
> I found other papers which applied autologistic regression in their study almost used a grid system and defined their window sizes. So, my question is do I have to convert my point layer into a grid system if I want to do this analysis with R?
>
> Also, what should I consider when I generate the grid system? How to determine a proper cell size? How about the searching window (neighbourhood) size?
>
> Many Thanks.
>
> Erin
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> .
>

-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a y Geolog?a
F?sica y Qu?mica Inorg?nica
Universidad Rey Juan Carlos
M?stoles Espa?a


From juanarango87 at gmail.com  Wed Nov 15 19:55:28 2017
From: juanarango87 at gmail.com (Juan Arango)
Date: Wed, 15 Nov 2017 12:55:28 -0600
Subject: [R-sig-Geo] Linear Model Methodology - Inputs
Message-ID: <CAKdQ83BB9RzXSSEuFkb0uq50fwQwq5YUVwCniTi5zy+EyR49EQ@mail.gmail.com>

All,



I will like to get your input in a project that I am working on. In
advanced thank you so much for all your comments.



So, I am trying to develop some linear models that explain some water
quality parameters, using the input from different remote sensing
satellites, in a lagoon that approximately has surface area of
approximately 19000 m2.  For that purpose, I collected some in-situ
measurements at 12 randomly selected locations inside the lagoon. I did
some ordinary kriging to calculate what is happening inside the pond (given
the fact that I only collected data at 12 points inside the pond). Now I am
at the stage where I can start developing those linear models.



Based on that, my question is the following - Should the linear models be
constructed using only the collected data, or should I develop those models
also considering the interpolated data. If the last scenario is the most
preferable option, should I perform a point value extraction using the
centroid of a grid?



Here is some (not all) of the literature that I been reading to complete
this project.

Giardino, C., Pepe, M., Brivio, P.A., Ghezzi, P., and Zilioli, E.,
?Detecting Chlorophyll, Secchi Disk Depth and Surface Temperature in a
Sub-Alpine Lake Using Landsat Imagery?, The Science of the Total
Environment, Vol. 268, 2001, pp. 19-29.

Kloiber, S.M., Brezonik, P.L., Olmanson, L.G., and Bauer, M.E., ?A
Procedure for Regional Lake Water Clarity Assessment Using Landsat
Multispectral Data?, Remote Sensing of Environment, Vol. 82, 2002a, pp.
38?47.

Kloiber, S.T., Brezonik, P.L., and Bauerc, M.E., ?Application of Landsat
Imagery to Regional-Scale Assessments of Lake Clarity?, Water Research,
Vol. 36, 2002b, pp.4330-4340.

Thank you so much for all your input.

Cheers

Juan

	[[alternative HTML version deleted]]


From Andy.Bunn at wwu.edu  Wed Nov 15 20:58:33 2017
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Wed, 15 Nov 2017 19:58:33 +0000
Subject: [R-sig-Geo] aligning tick maks with coord_map and ggplot
In-Reply-To: <CADQCJLA6TGC+WYzJ540Vk-rambakfWnRKHbbE8fM+P7f0AHspw@mail.gmail.com>
References: <C8C79640-641A-4E8D-8A3F-C3FBE1955B98@wwu.edu>
 <CADQCJLA6TGC+WYzJ540Vk-rambakfWnRKHbbE8fM+P7f0AHspw@mail.gmail.com>
Message-ID: <EB813707-7350-4B0B-9549-B61DC187DDC7@wwu.edu>

Wonderful thanks!

From: zuzana zajkova <zuzulaz at gmail.com>
Date: Tuesday, November 14, 2017 at 2:45 AM
To: Andy Bunn <Andy.Bunn at wwu.edu>
Cc: R-sig-Geo <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] aligning tick maks with coord_map and ggplot

library(maps)
world1 <- sf::st_as_sf(map('world', plot = FALSE, fill = TRUE))
ggplot() + geom_sf(data = world1)

Projected:
ggplot() +
  geom_sf(data = world1, colour="gray50", fill="gray50") +
  coord_sf(crs="+proj=ortho +y_0=0 +lon_0=-110 +lat_0=40", xlim=c(-2000000, 500000), ylim=c(-1800000, 2000000)) +
  scale_x_continuous(breaks=seq(-140, -100, 10)) +
  scale_y_continuous(breaks=seq(10, 60, 10))

	[[alternative HTML version deleted]]


From asafaneh at yahoo.com  Thu Nov 16 10:04:38 2017
From: asafaneh at yahoo.com (Ashraf Afana)
Date: Thu, 16 Nov 2017 09:04:38 +0000 (UTC)
Subject: [R-sig-Geo] Rasterize function with maximum in R
References: <1047841829.1489284.1510823078948.ref@mail.yahoo.com>
Message-ID: <1047841829.1489284.1510823078948@mail.yahoo.com>


Hi all,

I have some concerns regarding the rasterize option in R and I would like to know if the fun=max in rasterize in R provides similar results to the one achieved by using "Polygon to Raster using maximum-combined-area" in ArcGIS?

I'm trying to rasterize a habitat layer to a raster of 10m spatial resolution using the function 'max' (e.g. r <- rasterize(ht, r, "Priority", fun = 'max') and I would like to assign the habitat of the largest overlapping area, which is similar to the ?maximum-combined-area?. My original layer contains the habitat information as a character string values (e.g. K1, K2, I1, I2, I3, etc.) of 20 classes. Before resterizing, I have converted these classes to numeric (e.g. in my case 1 to 20).
I have my doubts about the validity and type of maximums generated by this code. From what I can see, I?m not sure if the use of fun= ?max? in Rasterize in R implies the use of the absolute maximum or the combined maximum area. My point is if I convert the original character string values of Priority to numeric, the maximum for the numeric values will have nothing to do with the maximum combined area under cover. For example, if we have a pixel which is covered by 90% of habitat 1 and 10% of habitat 15, the value of the pixel will be assigned to the habitat 15. Does that make any sense? Any suggestion or clarification would be appreciated.Regards
?Ashraf,?


	[[alternative HTML version deleted]]


From mahsasameti1384 at gmail.com  Mon Nov 20 03:33:10 2017
From: mahsasameti1384 at gmail.com (Mahsa Sameti)
Date: Mon, 20 Nov 2017 06:03:10 +0330
Subject: [R-sig-Geo] assigning lower , upper and control arguments
Message-ID: <CADN=v_x-Vpn-Ftf0eqB22hrkkLZRrOX=WTPeYO0KyQ-5-uy4Cw@mail.gmail.com>

Dear all

I have a question about assigning control, lower and upper bounds
arguments  in fit.stvariogram function.
How we should choose them for different covariance models(like separable,
metric,...).

Thanks alot.

	[[alternative HTML version deleted]]


From dw2116 at outlook.com  Mon Nov 20 18:37:29 2017
From: dw2116 at outlook.com (David Wang)
Date: Mon, 20 Nov 2017 17:37:29 +0000
Subject: [R-sig-Geo] Find the subset of a raster that best matches another
	raster
Message-ID: <BLUPR11MB0675809C1216AF6DB18051C7CB220@BLUPR11MB0675.namprd11.prod.outlook.com>

Hello,


I have two raster objects of identical resolution but different sizes. And I need to find a subset of raster B that is most similar to raster A by for example a simple correlation measure. This subset of course needs to have the same size as A. Now I could loop through the dimensions of A and crop all possible subsets of size dim(A) and locate the one that has the highest correlation with A. However, I wonder if there are any more efficient algorithms to solve the problem.


library(raster)
b <- brick(system.file("external/rlogo.grd", package="raster"))
A <- crop(b[[1]], extent(b[[1]], 20, 60, 25, 75))

B <- b[[2]]

	[[alternative HTML version deleted]]


From dncgst at gnewarchaeology.it  Tue Nov 21 19:02:21 2017
From: dncgst at gnewarchaeology.it (Domenico Giusti)
Date: Tue, 21 Nov 2017 19:02:21 +0100
Subject: [R-sig-Geo] Anisotropic point processes are inhomogeneous?
Message-ID: <1a573a39-2a71-2019-4ef0-e55e64d97714@gnewarchaeology.it>

Dear all,

I have an anisotropic point pattern, analyzed by means of directional 
correlograms, wavelets and Ksector functions.

I wonder if anisotropy prevents the use of inhomogeneous K-functions.

Thank you in advance,

-- 
Domenico Giusti <dncgst at gnewarchaeology.it>
GPG keyID: 2048R/A3AB7054F6E5D778


From rubak at math.aau.dk  Tue Nov 21 22:41:32 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Tue, 21 Nov 2017 22:41:32 +0100
Subject: [R-sig-Geo] Anisotropic point processes are inhomogeneous?
In-Reply-To: <1a573a39-2a71-2019-4ef0-e55e64d97714@gnewarchaeology.it>
References: <1a573a39-2a71-2019-4ef0-e55e64d97714@gnewarchaeology.it>
Message-ID: <323312bf-fd52-fad7-a471-25e391116c85@math.aau.dk>

At least the typical definition of an inhomogeneous K-function uses a 
disc as the structure element and can't capture anisotropy as far as I 
can see. It only depends on distance between points and not the vector 
difference.
Btw. if you do not assume stationarity of your process I would think 
that the results from something like Ksector can be misleading. In 
general it seems like a difficult problem to separate inhomogeneity and 
anisotropy from each other, but it might be that I just don't know the 
right tools.
Sorry for not being more helpful.
Cheers,
Ege

On 11/21/2017 07:02 PM, Domenico Giusti wrote:
> Dear all,
> 
> I have an anisotropic point pattern, analyzed by means of directional 
> correlograms, wavelets and Ksector functions.
> 
> I wonder if anisotropy prevents the use of inhomogeneous K-functions.
> 
> Thank you in advance,
>


From chino_tones at hotmail.com  Wed Nov 22 00:09:59 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Tue, 21 Nov 2017 23:09:59 +0000
Subject: [R-sig-Geo] Why is the covariance in Universal Kriging modeled this
 way in lectures by Prof. Edzer Pebesma?
Message-ID: <YTXPR0101MB1149BA555ACBFB88134DA18B90230@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Greetings,

There is code for Universal Kriging from Prof. Edzer Pebesma in GitHub<https://github.com/edzer/mstp/blob/master/lec7.Rmd>.

The covariance function is defined as follows:

cov = function(h) exp(-h)

And defined without any variogram modeling/generation to produce partial sill, range or nugget parameters for defining the covariance matrix.

If  I want to include a regularization term to account for singularity effects caused due to close spatial points, how do I modify the matrix computation for computing the 'beta' coefficients ?

I know there are standard formulae for different models (e.g. Matern, Exp,etc). But I would like to retain the simple cov function defined above and possibly use a regularizer (like ridge regression) to account for a nugget-like effect.

thanks,

Chris

	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 01:08:22 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 00:08:22 +0000
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
	Univ. Kriging?
In-Reply-To: <YTXPR0101MB1149066C29D40921DA09654090200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <YTXPR0101MB1149066C29D40921DA09654090200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <YTXPR0101MB11494A982822BF53323FBBBE90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets
Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,]
Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
m <- vgm("Exp")
m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively
training_prediction_error_term <- Training_sample$zinc - prediction_training_data
holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error
mae <- function(error)
{
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 01:33:12 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 00:33:12 +0000
Subject: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive
 difference forUniv. Kriging? [SEC=UNCLASSIFIED]
Message-ID: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>

Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.


From chino_tones at hotmail.com  Wed Nov 22 01:55:31 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 00:55:31 +0000
Subject: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive
 difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Hi Jin,


thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.


In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?


thanks

Chris


________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 02:07:24 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 01:07:24 +0000
Subject: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive
 difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>

They are not yet.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris

________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 02:12:43 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 01:12:43 +0000
Subject: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive
 difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 02:21:42 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 01:21:42 +0000
Subject: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive
 difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 02:36:47 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 01:36:47 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>
Message-ID: <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>

BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.


From chino_tones at hotmail.com  Wed Nov 22 02:49:28 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 01:49:28 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>,
 <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

thanks Jin. The reason I am very surprised by the MAE_train and MAE_holdOut differences is due to my comparison of the KED (i.e., Univ krig. code in my initial message post) with Linear Regression.


Please see below for the Linear Regression code where the MAE_training_set = 90.1 and the MAE_holdOut_set = 97.4

On the other hand, KED  gave me MAE_training_set = 1 and the MAE_holdOut_set = 76.5.


Given that KED is a linear model (i.e. Linear Reg + Ord Krig.) I am surprised by these differences. Any insight from your end is appreciated.


cat("\014")
rm(list=ls())
cls <- function() cat(rep("\n",100))
cls()
graphics.off()
setwd("C:/Users/Ravi Persad/Desktop/OwenSound_Region25_UR010")
options(scipen = 999)
graphics.off()



library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets
Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,]
Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
m <- vgm("Exp")
m <- fit.variogram(m1, m)


# Apply Linear regression to Training dataset
train_model <- lm(log(zinc)~lead+copper+elev+dist, Training_sample)
prediction_training_data <- expm1(predict(train_model,newdata =Training_sample ))

# Apply Linear Regression to Hold Out dataset
prediction_holdout_data <- expm1(predict(train_model,newdata =Hold_out_sample ))

# Computing Predictive errors for Training and Hold Out samples respectively
training_prediction_error_term <- Training_sample$zinc - prediction_training_data
holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data

# Function that returns Mean Absolute Error
mae <- function(error)
{
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set



________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 21, 2017 6:36 PM
To: Li Jin; Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 03:00:05 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 02:00:05 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>,
 <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
 <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <853bf908404d4f8a83f5cd5c7a5eb430@win-exch-prod02.prod.lan>

For both models, the MAE for holdout is larger than that for the training. That is expected.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:49 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


thanks Jin. The reason I am very surprised by the MAE_train and MAE_holdOut differences is due to my comparison of the KED (i.e., Univ krig. code in my initial message post) with Linear Regression.



Please see below for the Linear Regression code where the MAE_training_set = 90.1 and the MAE_holdOut_set = 97.4

On the other hand, KED  gave me MAE_training_set = 1 and the MAE_holdOut_set = 76.5.



Given that KED is a linear model (i.e. Linear Reg + Ord Krig.) I am surprised by these differences. Any insight from your end is appreciated.


cat("\014")
rm(list=ls())
cls <- function() cat(rep("\n",100))
cls()
graphics.off()
setwd("C:/Users/Ravi Persad/Desktop/OwenSound_Region25_UR010")
options(scipen = 999)
graphics.off()



library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets
Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,]
Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
m <- vgm("Exp")
m <- fit.variogram(m1, m)


# Apply Linear regression to Training dataset
train_model <- lm(log(zinc)~lead+copper+elev+dist, Training_sample)
prediction_training_data <- expm1(predict(train_model,newdata =Training_sample ))

# Apply Linear Regression to Hold Out dataset
prediction_holdout_data <- expm1(predict(train_model,newdata =Hold_out_sample ))

# Computing Predictive errors for Training and Hold Out samples respectively
training_prediction_error_term <- Training_sample$zinc - prediction_training_data
holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data

# Function that returns Mean Absolute Error
mae <- function(error)
{
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:36 PM
To: Li Jin; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org%3cmailto:R-sig-Geo at r-project.org>>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 07:37:36 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 06:37:36 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <853bf908404d4f8a83f5cd5c7a5eb430@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>,
 <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
 <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <853bf908404d4f8a83f5cd5c7a5eb430@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB114941A86489BC86CBDF778390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Jin,


do you think there is potential evidence of overfitting for KED given the large difference in MAE betwen the train and holdout sets?


________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 21, 2017 7:00 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


For both models, the MAE for holdout is larger than that for the training. That is expected.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:49 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



thanks Jin. The reason I am very surprised by the MAE_train and MAE_holdOut differences is due to my comparison of the KED (i.e., Univ krig. code in my initial message post) with Linear Regression.



Please see below for the Linear Regression code where the MAE_training_set = 90.1 and the MAE_holdOut_set = 97.4

On the other hand, KED  gave me MAE_training_set = 1 and the MAE_holdOut_set = 76.5.



Given that KED is a linear model (i.e. Linear Reg + Ord Krig.) I am surprised by these differences. Any insight from your end is appreciated.



cat("\014")

rm(list=ls())

cls <- function() cat(rep("\n",100))

cls()

graphics.off()

setwd("C:/Users/Ravi Persad/Desktop/OwenSound_Region25_UR010")

options(scipen = 999)

graphics.off()







library(sp)

library(gstat)

data(meuse)

dataset= meuse

set.seed(999)



# Split Meuse Dataset into Training and HoldOut Sample datasets

Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))



Training_sample = dataset[Training_ids,]

Holdout_sample_allvars = dataset[-Training_ids,]



holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])

Hold_out_sample = holdoutvars_df[-Training_ids,]



coordinates(Training_sample) <- c('x','y')

coordinates(Hold_out_sample) <- c('x','y')



# Semivariogram modeling

m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)

m <- vgm("Exp")

m <- fit.variogram(m1, m)





# Apply Linear regression to Training dataset

train_model <- lm(log(zinc)~lead+copper+elev+dist, Training_sample)

prediction_training_data <- expm1(predict(train_model,newdata =Training_sample ))



# Apply Linear Regression to Hold Out dataset

prediction_holdout_data <- expm1(predict(train_model,newdata =Hold_out_sample ))



# Computing Predictive errors for Training and Hold Out samples respectively

training_prediction_error_term <- Training_sample$zinc - prediction_training_data

holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error

mae <- function(error)

{

  mean(abs(error))

}



# Mean Absolute Error metric :

# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set

print(mae(training_prediction_error_term)) #Error for Training sample set

print(mae(holdout_prediction_error_term)) #Error for Hold out sample set





________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:36 PM
To: Li Jin; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org%3cmailto:R-sig-Geo at r-project.org>>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Wed Nov 22 11:58:17 2017
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Wed, 22 Nov 2017 11:58:17 +0100
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
Message-ID: <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>


Hi Chris,

First of all, I think your back-transformation is not correct since you 
need to add half the prediction variance to values as indicated in the 
Diggle and Ribeiro (2007) P-61 
(https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png). 
Otherwise you underpredict the values and hence the cross-validation 
error will be high.

I also do not see much point in using lead and copper as covariates 
since they are only available at sampling locations.

For log-normal or not-normal variables I advise using geoR package that 
does all the transformations for you (it would be interesting to see if 
gstat and geoR give exactly the same numbers if the same transformations 
and back-transformations are applied):

R> library(geoR)
--------------------------------------------------------------
   Analysis of Geostatistical Data
   For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
   geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
--------------------------------------------------------------

R> demo(meuse, echo=FALSE)
R> set.seed(999)
R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
R> meuse = meuse[sel.d,]
R> meuse.geo <- as.geodata(meuse["zinc"])
R> ## add covariates:
R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
R> trend = ~ lead+copper+elev+dist
R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend, 
ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
           arguments for the maximisation function.
          For further details see documentation for optim.
likfit: It is highly advisable to run this function several
          times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
R> zinc.vgm
likfit: estimated model parameters:
       beta0      beta1      beta2      beta3      beta4      tausq 
sigmasq        phi       psiA
"  6.0853" "  0.0033" "  0.0053" " -0.0810" " -0.9805" "  0.0210" " 
0.0717" "799.9942" "  0.2619"
        psiR
"  3.9731"
Practical Range with cor=0.05 for asymptotic range: 2396.568

likfit: maximised log-likelihood = -883.4
R> locs2 = meuse at coords
R> KC = krige.control(trend.d = trend, trend.l = ~ 
meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
krige.conv: model with mean defined by covariates provided by the user
krige.conv: anisotropy correction performed
krige.conv: performing the Box-Cox data transformation
krige.conv: back-transforming the predicted mean and variance
krige.conv: Kriging performed using global neighbourhood

HTH,

Tom Hengl
http://orcid.org/0000-0002-9921-5129


On 2017-11-22 01:08, Joelle k. Akram wrote:
> 
> 
> 
> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
> 
> 
> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.
> 
> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.
> 
> library(sp)
> library(gstat)
> data(meuse)
> dataset= meuse
> set.seed(999)
> 
> # Split Meuse Dataset into Training and HoldOut Sample datasets
> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
> 
> Training_sample = dataset[Training_ids,]
> Holdout_sample_allvars = dataset[-Training_ids,]
> 
> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
> Hold_out_sample = holdoutvars_df[-Training_ids,]
> 
> coordinates(Training_sample) <- c('x','y')
> coordinates(Hold_out_sample) <- c('x','y')
> 
> # Semivariogram modeling
> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
> m <- vgm("Exp")
> m <- fit.variogram(m1, m)
> 
> 
> # Apply Univ Krig to Training dataset
> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
> prediction_training_data <- expm1(prediction_training_data$var1.pred)
> 
> # Apply Univ Krig to Hold Out dataset
> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
> 
> # Computing Predictive errors for Training and Hold Out samples respectively
> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
> 
> 
> 
> # Function that returns Mean Absolute Error
> mae <- function(error)
> {
>    mean(abs(error))
> }
> 
> # Mean Absolute Error metric :
> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
> print(mae(training_prediction_error_term)) #Error for Training sample set
> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
> 
> 
> cheers,
> 
> Kristopher (Chris)
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Wed Nov 22 12:44:02 2017
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Nov 2017 12:44:02 +0100
Subject: [R-sig-Geo] spdep 0.7-4 on CRAN
Message-ID: <alpine.LFD.2.21.1711221225280.3161@reclus.nhh.no>

A new version of spdep is now on CRAN. This version has off-loaded most of 
the built-in data sets to the spData package, version >= 0.2.6.0 
(currently at 0.2.6.4 on CRAN), and switched the reading of vector 
data files from the deprecated maptools::readShapeSpatial() to 
rgdal::readOGR().

Further, a new vignette shows how nb - neighbour - objects can be created 
from sf objects:

https://cran.r-project.org/web/packages/spdep/vignettes/nb_sf.html

and consequently that tests for spatial autocoorelation and spatial 
regression models can be used with sf objects once the neighbours and 
spatial weights have been created.

Finally, the development repository for spdep has migrated to github:

https://github.com/r-spatial/spdep/

Please let me know if there are negative outcomes of these changes.

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
Editor-in-Chief of The R Journal, https://journal.r-project.org/index.html
http://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From chino_tones at hotmail.com  Wed Nov 22 13:11:00 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 12:11:00 +0000
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>,
 <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
Message-ID: <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>


Thank you Tom. A couple questions.
1) In your code, you used log1p for computing  zinc.vgm. But log1p is not used when defining trend.l for the krige.control 'KC'. Do we need log1p for the zinc response (dependent) variable when defining trend.l?

2) The exponent back-transform is not applied anywhere after applying log1p for computing the  zinc.vgm variable. Do we need exp anywhere or is it done internally?

3) Do we add half the prediction variance to the 'zinc.uk' variable or does geoR do this internally?

4) Is it more advisable to use likfit instead of variofit and why?

5) A value of 800 is used to initialize likfit. Where is value determined?

appreciated,
Chris

________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Tomislav Hengl <tom.hengl at gmail.com>
Sent: November 22, 2017 3:58 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Hi Chris,

First of all, I think your back-transformation is not correct since you
need to add half the prediction variance to values as indicated in the
Diggle and Ribeiro (2007) P-61
(https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png

).
Otherwise you underpredict the values and hence the cross-validation
error will be high.

I also do not see much point in using lead and copper as covariates
since they are only available at sampling locations.

For log-normal or not-normal variables I advise using geoR package that
does all the transformations for you (it would be interesting to see if
gstat and geoR give exactly the same numbers if the same transformations
and back-transformations are applied):

R> library(geoR)
--------------------------------------------------------------
   Analysis of Geostatistical Data
   For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
The geoR package - LEG-UFPR<http://www.leg.ufpr.br/geoR>
www.leg.ufpr.br
geoR is a free and open-source package for geostatistical analysis to be used as a add-on to the R system



   geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
--------------------------------------------------------------

R> demo(meuse, echo=FALSE)
R> set.seed(999)
R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
R> meuse = meuse[sel.d,]
R> meuse.geo <- as.geodata(meuse["zinc"])
R> ## add covariates:
R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
R> trend = ~ lead+copper+elev+dist
R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend,
ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
           arguments for the maximisation function.
          For further details see documentation for optim.
likfit: It is highly advisable to run this function several
          times with different initial values for the parameters.
[[elided Hotmail spam]]
---------------------------------------------------------------
likfit: end of numerical maximisation.
R> zinc.vgm
likfit: estimated model parameters:
       beta0      beta1      beta2      beta3      beta4      tausq
sigmasq        phi       psiA
"  6.0853" "  0.0033" "  0.0053" " -0.0810" " -0.9805" "  0.0210" "
0.0717" "799.9942" "  0.2619"
        psiR
"  3.9731"
Practical Range with cor=0.05 for asymptotic range: 2396.568

likfit: maximised log-likelihood = -883.4
R> locs2 = meuse at coords
R> KC = krige.control(trend.d = trend, trend.l = ~
meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
krige.conv: model with mean defined by covariates provided by the user
krige.conv: anisotropy correction performed
krige.conv: performing the Box-Cox data transformation
krige.conv: back-transforming the predicted mean and variance
krige.conv: Kriging performed using global neighbourhood

HTH,

Tom Hengl
http://orcid.org/0000-0002-9921-5129
Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...<http://orcid.org/0000-0002-9921-5129>
orcid.org
Your use of the Registry and the results of your search are subject to ORCID's Terms and Conditions of Use





On 2017-11-22 01:08, Joelle k. Akram wrote:
>
>
>
> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
[https://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon at 2.png?v=73d79a89bded]<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>

Why is Predictive error large for Universal Kriging?<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
stackoverflow.com
I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The...



>
>
> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.
>
> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.
>
> library(sp)
> library(gstat)
> data(meuse)
> dataset= meuse
> set.seed(999)
>
> # Split Meuse Dataset into Training and HoldOut Sample datasets
> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
>
> Training_sample = dataset[Training_ids,]
> Holdout_sample_allvars = dataset[-Training_ids,]
>
> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
> Hold_out_sample = holdoutvars_df[-Training_ids,]
>
> coordinates(Training_sample) <- c('x','y')
> coordinates(Hold_out_sample) <- c('x','y')
>
> # Semivariogram modeling
> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
> m <- vgm("Exp")
> m <- fit.variogram(m1, m)
>
>
> # Apply Univ Krig to Training dataset
> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
> prediction_training_data <- expm1(prediction_training_data$var1.pred)
>
> # Apply Univ Krig to Hold Out dataset
> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
>
> # Computing Predictive errors for Training and Hold Out samples respectively
> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
>
>
>
> # Function that returns Mean Absolute Error
> mae <- function(error)
> {
>    mean(abs(error))
> }
>
> # Mean Absolute Error metric :
> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
> print(mae(training_prediction_error_term)) #Error for Training sample set
> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>
>
> cheers,
>
> Kristopher (Chris)
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
stat.ethz.ch
A mailing list for discussing the development and use of R functions and packages for handling and analysis of spatial, and particularly geographical, data.



>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
stat.ethz.ch
A mailing list for discussing the development and use of R functions and packages for handling and analysis of spatial, and particularly geographical, data.




	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Nov 22 14:16:56 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 22 Nov 2017 14:16:56 +0100
Subject: [R-sig-Geo] Why is the covariance in Universal Kriging modeled
 this way in lectures by Prof. Edzer Pebesma?
In-Reply-To: <YTXPR0101MB1149BA555ACBFB88134DA18B90230@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <YTXPR0101MB1149BA555ACBFB88134DA18B90230@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <9fca0070-f9ad-1c68-cd81-cf77c265f338@uni-muenster.de>



On 11/22/2017 12:09 AM, Joelle k. Akram wrote:
> Greetings,
> 
> There is code for Universal Kriging from Prof. Edzer Pebesma in GitHub<https://github.com/edzer/mstp/blob/master/lec7.Rmd>.

https://edzer.github.io/mstp/lec7.html

gives you the rendered version.

> 
> The covariance function is defined as follows:
> 
> cov = function(h) exp(-h)
> 
> And defined without any variogram modeling/generation to produce partial sill, range or nugget parameters for defining the covariance matrix.

Well, it implies nugget=0, sill=1 and range parameter=1, it was the
shortest covariance function I could think of.

> 
> If  I want to include a regularization term to account for singularity effects caused due to close spatial points, how do I modify the matrix computation for computing the 'beta' coefficients ?

Add a nugget (i.e. add a constant to the diagonal of V)?

> 
> I know there are standard formulae for different models (e.g. Matern, Exp,etc). But I would like to retain the simple cov function defined above and possibly use a regularizer (like ridge regression) to account for a nugget-like effect.
> 
> thanks,
> 
> Chris
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From tom.hengl at gmail.com  Wed Nov 22 16:17:50 2017
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Wed, 22 Nov 2017 16:17:50 +0100
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
 <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
 <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <973043e4-94bf-47d3-f0f8-4f1585318c6f@gmail.com>


On 2017-11-22 13:11, Joelle k. Akram wrote:
> 
> Thank you Tom. A?couple questions.
> 1) In your code, you used log1p for computing ?zinc.vgm. But log1p is 
> not used when defining?trend.l for the krige.control 'KC'. Do we need 
> log1p for the zinc response (dependent) variable when defining trend.l?

Log-transformation in linkfit is defined by setting "lambda=0". I know 
it is a very cryptic package but it has all you need - transformation, 
back-transformation, REML fitting of variograms, trend components etc etc.

> 
> 2) The?exponent back-transform is not?applied anywhere after 
> applying?log1p for computing?the? zinc.vgm variable. Do we need exp 
> anywhere or is it done internally?

It is done internally.

> 
> 3) Do we add half the prediction variance to the 'zinc.uk' variable or 
> does geoR do this internally?

It is done internally see:
"krige.conv: performing the Box-Cox data transformation
krige.conv: back-transforming the predicted mean and variance"

> 
> 4) Is it more advisable to use likfit instead of variofit and why?

likfit has probably more options for variogram modelling (these could 
get quite computational and I think fitting vgms with >>1000 geoR is not 
recommended, while in gstat it is still doable), but it could be a 
matter of taste.

> 
> 5) A value of 800 is used to initialize likfit. Where is value determined?

Arbitrary initial parameter. It does not have to be very accurate.

> 
> appreciated,
> Chris
> 
> ------------------------------------------------------------------------
> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of 
> Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 3:58 AM
> *To:* r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive 
> difference for Univ. Kriging?
> 
> Hi Chris,
> 
> First of all, I think your back-transformation is not correct since you
> need to add half the prediction variance to values as indicated in the
> Diggle and Ribeiro (2007) P-61
> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png 
> 
> 
> ).
> Otherwise you underpredict the values and hence the cross-validation
> error will be high.
> 
> I also do not see much point in using lead and copper as covariates
> since they are only available at sampling locations.
> 
> For log-normal or not-normal variables I advise using geoR package that
> does all the transformations for you (it would be interesting to see if
> gstat and geoR give exactly the same numbers if the same transformations
> and back-transformations are applied):
> 
> R> library(geoR)
> --------------------------------------------------------------
>  ?? Analysis of Geostatistical Data
>  ?? For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
> The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
> www.leg.ufpr.br
> geoR is a free and open-source package for geostatistical analysis to be 
> used as a add-on to the R system
> 
> 
> 
>  ?? geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
> --------------------------------------------------------------
> 
> R> demo(meuse, echo=FALSE)
> R> set.seed(999)
> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
> R> meuse = meuse[sel.d,]
> R> meuse.geo <- as.geodata(meuse["zinc"])
> R> ## add covariates:
> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
> R> trend = ~ lead+copper+elev+dist
> R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend,
> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
> ---------------------------------------------------------------
> likfit: likelihood maximisation using the function optim.
> likfit: Use control() to pass additional
>  ?????????? arguments for the maximisation function.
>  ????????? For further details see documentation for optim.
> likfit: It is highly advisable to run this function several
>  ????????? times with different initial values for the parameters.
> likfit: WARNING: This step can be time demanding!
> ---------------------------------------------------------------
> likfit: end of numerical maximisation.
> R> zinc.vgm
> likfit: estimated model parameters:
>  ?????? beta0????? beta1????? beta2????? beta3????? beta4????? tausq
> sigmasq??????? phi?????? psiA
> "? 6.0853" "? 0.0033" "? 0.0053" " -0.0810" " -0.9805" "? 0.0210" "
> 0.0717" "799.9942" "? 0.2619"
>  ??????? psiR
> "? 3.9731"
> Practical Range with cor=0.05 for asymptotic range: 2396.568
> 
> likfit: maximised log-likelihood = -883.4
> R> locs2 = meuse at coords
> R> KC = krige.control(trend.d = trend, trend.l = ~
> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
> krige.conv: model with mean defined by covariates provided by the user
> krige.conv: anisotropy correction performed
> krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance
> krige.conv: Kriging performed using global neighbourhood
> 
> HTH,
> 
> Tom Hengl
> http://orcid.org/0000-0002-9921-5129
> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ... 
> <http://orcid.org/0000-0002-9921-5129>
> orcid.org
> Your use of the Registry and the results of your search are subject to 
> ORCID's Terms and Conditions of Use
> 
> 
> 
> 
> 
> On 2017-11-22 01:08, Joelle k. Akram wrote:
>> 
>> 
>> 
>> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#> 
> 
> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
> 	
> Why is Predictive error large for Universal Kriging? 
> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
> stackoverflow.com
> I am using the Meuse dataset for universal kriging (UK) via the gstat 
> library in R. I am following a strategy used in Machine Learning where 
> data is partioned into a Train set and Hold out set. The...
> 
> 
> 
>> 
>> 
>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining  the semivariogram.
>> 
>> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would  expect them to be similar or at least closer. So far I have 
> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and 
> advice is welcome.
>> 
>> library(sp)
>> library(gstat)
>> data(meuse)
>> dataset= meuse
>> set.seed(999)
>> 
>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
>> 
>> Training_sample = dataset[Training_ids,]
>> Holdout_sample_allvars = dataset[-Training_ids,]
>> 
>> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>> 
>> coordinates(Training_sample) <- c('x','y')
>> coordinates(Hold_out_sample) <- c('x','y')
>> 
>> # Semivariogram modeling
>> m1? <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
>> m <- vgm("Exp")
>> m <- fit.variogram(m1, m)
>> 
>> 
>> # Apply Univ Krig to Training dataset
>> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
>> prediction_training_data <- expm1(prediction_training_data$var1.pred)
>> 
>> # Apply Univ Krig to Hold Out dataset
>> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
>> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
>> 
>> # Computing Predictive errors for Training and Hold Out samples respectively
>> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
>> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
>> 
>> 
>> 
>> # Function that returns Mean Absolute Error
>> mae <- function(error)
>> {
>>??? mean(abs(error))
>> }
>> 
>> # Mean Absolute Error metric :
>> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
>> print(mae(training_prediction_error_term)) #Error for Training sample set
>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>> 
>> 
>> cheers,
>> 
>> Kristopher (Chris)
>> 
>>??????? [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> stat.ethz.ch
> A mailing list for discussing the development and use of R functions and 
> packages for handling and analysis of spatial, and particularly 
> geographical, data.
> 
> 
> 
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> stat.ethz.ch
> A mailing list for discussing the development and use of R functions and 
> packages for handling and analysis of spatial, and particularly 
> geographical, data.
> 
> 
>


From chino_tones at hotmail.com  Wed Nov 22 21:34:29 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 20:34:29 +0000
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <973043e4-94bf-47d3-f0f8-4f1585318c6f@gmail.com>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
 <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
 <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <973043e4-94bf-47d3-f0f8-4f1585318c6f@gmail.com>
Message-ID: <YTXPR0101MB1149374886ACFD8B34D95BBC90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Hi Tom,


I tried splitting the data into 'training' set and a 'holdout' sample set as in my original post. I seem to be getting consistent results, i.e., a large predictive difference in terms of MAE between both sets. The MAE_train =0.0000000000001165816  and MAE_holdOut = 85.91126. In my opinion, this significant difference is an indication of over-fitting on the training sample set for the semi-variogram modeling. The code is below.  Any of your insights are welcome.




demo(meuse, echo=FALSE)
 set.seed(999)
 sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
 meuse = meuse[sel.d,]


 Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7* nrow(meuse)))
 Training_sample = meuse[Training_ids,]
 Holdout_sample = meuse[-Training_ids,]

 # Generate VGM using Training set
 Training_sample.geo <- as.geodata(Training_sample["zinc"])
 ## add covariates:
 Training_sample.geo$covariate = Training_sample at data[,c("lead","copper","elev", "dist")]
trend = ~ lead+copper+elev+dist
 zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
                      ini=c(var(log1p(Training_sample.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)

# do prediction for locations in Training set
 locs2 = Training_sample at coords
 KC = krige.control(trend.d = trend, trend.l = ~
                      Training_sample$lead+Training_sample$copper+
                      Training_sample$elev+Training_sample$dist, obj.model = zinc.vgm)
 zinc_train <- krige.conv(Training_sample.geo, locations=locs2, krige=KC)

 # do prediction for new locations in Hold-Out sample set
 newlocs2 = Holdout_sample at coords
 KC2 = krige.control(trend.d = trend, trend.l = ~
                      Holdout_sample$lead+Holdout_sample$copper+
                     Holdout_sample$elev+Holdout_sample$dist, obj.model = zinc.vgm)
 zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2, krige=KC2)



 # Computing Predictive errors for Training and Hold Out samples respectively
 training_prediction_error_term <- Training_sample$zinc - zinc_train$predict
 holdout_prediction_error_term <- Holdout_sample$zinc - zinc_holdout$predict

 # Function that returns Mean Absolute Error
 mae <- function(error)
 {
   mean(abs(error))
 }

 # Mean Absolute Error metric :
 # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
 print(mae(training_prediction_error_term)) #Error for Training sample set
 print(mae(holdout_prediction_error_term)) #Error for Hold out sample set















________________________________
From: Tomislav Hengl <tom.hengl at gmail.com>
Sent: November 22, 2017 8:17 AM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


On 2017-11-22 13:11, Joelle k. Akram wrote:
>
> Thank you Tom. A couple questions.
> 1) In your code, you used log1p for computing  zinc.vgm. But log1p is
> not used when defining trend.l for the krige.control 'KC'. Do we need
> log1p for the zinc response (dependent) variable when defining trend.l?

Log-transformation in linkfit is defined by setting "lambda=0". I know
it is a very cryptic package but it has all you need - transformation,
back-transformation, REML fitting of variograms, trend components etc etc.

>
> 2) The exponent back-transform is not applied anywhere after
> applying log1p for computing the  zinc.vgm variable. Do we need exp
> anywhere or is it done internally?

It is done internally.

>
> 3) Do we add half the prediction variance to the 'zinc.uk' variable or
> does geoR do this internally?

It is done internally see:
"krige.conv: performing the Box-Cox data transformation
krige.conv: back-transforming the predicted mean and variance"

>
> 4) Is it more advisable to use likfit instead of variofit and why?

likfit has probably more options for variogram modelling (these could
get quite computational and I think fitting vgms with >>1000 geoR is not
recommended, while in gstat it is still doable), but it could be a
matter of taste.

>
> 5) A value of 800 is used to initialize likfit. Where is value determined?

Arbitrary initial parameter. It does not have to be very accurate.

>
> appreciated,
> Chris
>
> ------------------------------------------------------------------------
> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
> Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 3:58 AM
> *To:* r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
> difference for Univ. Kriging?
>
> Hi Chris,
>
> First of all, I think your back-transformation is not correct since you
> need to add half the prediction variance to values as indicated in the
> Diggle and Ribeiro (2007) P-61
> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png
>
>
> ).
> Otherwise you underpredict the values and hence the cross-validation
> error will be high.
>
> I also do not see much point in using lead and copper as covariates
> since they are only available at sampling locations.
>
> For log-normal or not-normal variables I advise using geoR package that
> does all the transformations for you (it would be interesting to see if
> gstat and geoR give exactly the same numbers if the same transformations
> and back-transformations are applied):
>
> R> library(geoR)
> --------------------------------------------------------------
>     Analysis of Geostatistical Data
>     For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
> The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
> www.leg.ufpr.br<http://www.leg.ufpr.br>
> geoR is a free and open-source package for geostatistical analysis to be
> used as a add-on to the R system
>
>
>
>     geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
> --------------------------------------------------------------
>
> R> demo(meuse, echo=FALSE)
> R> set.seed(999)
> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
> R> meuse = meuse[sel.d,]
> R> meuse.geo <- as.geodata(meuse["zinc"])
> R> ## add covariates:
> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
> R> trend = ~ lead+copper+elev+dist
> R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend,
> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
> ---------------------------------------------------------------
> likfit: likelihood maximisation using the function optim.
> likfit: Use control() to pass additional
>             arguments for the maximisation function.
>            For further details see documentation for optim.
> likfit: It is highly advisable to run this function several
>            times with different initial values for the parameters.
[[elided Hotmail spam]]
> ---------------------------------------------------------------
> likfit: end of numerical maximisation.
> R> zinc.vgm
> likfit: estimated model parameters:
>         beta0      beta1      beta2      beta3      beta4      tausq
> sigmasq        phi       psiA
> "  6.0853" "  0.0033" "  0.0053" " -0.0810" " -0.9805" "  0.0210" "
> 0.0717" "799.9942" "  0.2619"
>          psiR
> "  3.9731"
> Practical Range with cor=0.05 for asymptotic range: 2396.568
>
> likfit: maximised log-likelihood = -883.4
> R> locs2 = meuse at coords
> R> KC = krige.control(trend.d = trend, trend.l = ~
> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
> krige.conv: model with mean defined by covariates provided by the user
> krige.conv: anisotropy correction performed
> krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance
> krige.conv: Kriging performed using global neighbourhood
>
> HTH,
>
> Tom Hengl
> http://orcid.org/0000-0002-9921-5129
> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...
> <http://orcid.org/0000-0002-9921-5129>
> orcid.org
> Your use of the Registry and the results of your search are subject to
> ORCID's Terms and Conditions of Use
>
>
>
>
>
> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>
>>
>>
>> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>
> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>
> Why is Predictive error large for Universal Kriging?
> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
> stackoverflow.com
> I am using the Meuse dataset for universal kriging (UK) via the gstat
> library in R. I am following a strategy used in Machine Learning where
> data is partioned into a Train set and Hold out set. The...
>
>
>
>>
>>
>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining  the semivariogram.
>>
>> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would  expect them to be similar or at least closer. So far I have
> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and
> advice is welcome.
>>
>> library(sp)
>> library(gstat)
>> data(meuse)
>> dataset= meuse
>> set.seed(999)
>>
>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
>>
>> Training_sample = dataset[Training_ids,]
>> Holdout_sample_allvars = dataset[-Training_ids,]
>>
>> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>
>> coordinates(Training_sample) <- c('x','y')
>> coordinates(Hold_out_sample) <- c('x','y')
>>
>> # Semivariogram modeling
>> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
>> m <- vgm("Exp")
>> m <- fit.variogram(m1, m)
>>
>>
>> # Apply Univ Krig to Training dataset
>> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
>> prediction_training_data <- expm1(prediction_training_data$var1.pred)
>>
>> # Apply Univ Krig to Hold Out dataset
>> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
>> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
>>
>> # Computing Predictive errors for Training and Hold Out samples respectively
>> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
>> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
>>
>>
>>
>> # Function that returns Mean Absolute Error
>> mae <- function(error)
>> {
>>    mean(abs(error))
>> }
>>
>> # Mean Absolute Error metric :
>> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
>> print(mae(training_prediction_error_term)) #Error for Training sample set
>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>>
>>
>> cheers,
>>
>> Kristopher (Chris)
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> stat.ethz.ch
> A mailing list for discussing the development and use of R functions and
> packages for handling and analysis of spatial, and particularly
> geographical, data.
>
>
>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> stat.ethz.ch
> A mailing list for discussing the development and use of R functions and
> packages for handling and analysis of spatial, and particularly
> geographical, data.
>
>
>

	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 22:23:39 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 21:23:39 +0000
Subject: [R-sig-Geo] Why is the covariance in Universal Kriging modeled
 this way in lectures by Prof. Edzer Pebesma?
In-Reply-To: <9fca0070-f9ad-1c68-cd81-cf77c265f338@uni-muenster.de>
References: <YTXPR0101MB1149BA555ACBFB88134DA18B90230@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <9fca0070-f9ad-1c68-cd81-cf77c265f338@uni-muenster.de>
Message-ID: <YTXPR0101MB11490478EF8EB27A738C1BA490200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

thank you for clarifying Prof. Pebesma. I have a couple more question for you regarding the inclusion of a

nugget to the diagonals of V. As we know,there are 2 covariances, V and v; one for the existing coordinates (i.e., V) and the other for the distances between these existing coordinates and other new locations (i.e., v).


I) Assuming unscaled coordinates in latitude/longitude; should the Nugget theoretically be a small value (lets say typically less than <1) or does it depend on other the dataset's spatial distribution,etc?


2) When computing Beta coefficients as in you lecture 7 in github, do we have to add the nugget term to both V and v or only one of them?


thank you,

Chris Akram




________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Sent: November 22, 2017 6:16 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Why is the covariance in Universal Kriging modeled this way in lectures by Prof. Edzer Pebesma?



On 11/22/2017 12:09 AM, Joelle k. Akram wrote:
> Greetings,
>
> There is code for Universal Kriging from Prof. Edzer Pebesma in GitHub<https://github.com/edzer/mstp/blob/master/lec7.Rmd>.

edzer/mstp<https://github.com/edzer/mstp/blob/master/lec7.Rmd>
github.com
mstp - Course slides: modelling spatio-temporal processes




https://edzer.github.io/mstp/lec7.html

gives you the rendered version.

>
> The covariance function is defined as follows:
>
> cov = function(h) exp(-h)
>
> And defined without any variogram modeling/generation to produce partial sill, range or nugget parameters for defining the covariance matrix.

Well, it implies nugget=0, sill=1 and range parameter=1, it was the
shortest covariance function I could think of.

>
> If  I want to include a regularization term to account for singularity effects caused due to close spatial points, how do I modify the matrix computation for computing the 'beta' coefficients ?

Add a nugget (i.e. add a constant to the diagonal of V)?

>
> I know there are standard formulae for different models (e.g. Matern, Exp,etc). But I would like to retain the simple cov function defined above and possibly use a regularizer (like ridge regression) to account for a nugget-like effect.
>
> thanks,
>
> Chris
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From tom.hengl at gmail.com  Wed Nov 22 22:41:44 2017
From: tom.hengl at gmail.com (Tomislav Hengl)
Date: Wed, 22 Nov 2017 22:41:44 +0100
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <YTXPR0101MB1149374886ACFD8B34D95BBC90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
 <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
 <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <973043e4-94bf-47d3-f0f8-4f1585318c6f@gmail.com>
 <YTXPR0101MB1149374886ACFD8B34D95BBC90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <af062fd9-1ba1-c375-c1fe-0db910aaa755@gmail.com>


Any type of kriging is a convex predictor which means that predictions 
at sampling locations will exactly match measured numbers. That is why 
you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad 
considering that the range of values is: 113-1839. If your repeat the CV 
process e.g. 10 times you will get a more stable estimate of MAE. Even 
more interesting is the simple mean error (ME) which tells you whether 
there are over-estimation or under-estimation problem. Also plotting 
observed vs predicted (as in 
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla) 
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
> 
> 
> I tried splitting the data into 'training' set?and a 'holdout' sample 
> set as in my original post. I seem to be getting consistent results, 
> i.e., a?large predictive difference in terms of MAE between both sets. 
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my 
> opinion, this significant difference is an indication of over-fitting?on 
> the training sample set for the semi-variogram modeling. The code is 
> below.? Any of your insights are?welcome.
> 
> 
> demo(meuse, echo=FALSE)
>  ?set.seed(999)
>  ?sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
>  ?meuse = meuse[sel.d,]
>  ?Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7* nrow(meuse)))
>  ?Training_sample = meuse[Training_ids,]
>  ?Holdout_sample = meuse[-Training_ids,]
>  ?# Generate VGM using Training set
>  ?Training_sample.geo <- as.geodata(Training_sample["zinc"])
>  ?## add covariates:
>  ?Training_sample.geo$covariate = 
> Training_sample at data[,c("lead","copper","elev", "dist")]
> trend = ~ lead+copper+elev+dist
>  ?zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>  ? ? ? ? ? ? ? ? ? ? ? ini=c(var(log1p(Training_sample.geo$data)),800), 
> fix.psiA = FALSE, fix.psiR = FALSE)
> 
> # do prediction for locations in Training set
>  ?locs2 = Training_sample at coords
>  ?KC = krige.control(trend.d = trend, trend.l = ~
>  ? ? ? ? ? ? ? ? ? ? ? Training_sample$lead+Training_sample$copper+
>  ? ? ? ? ? ? ? ? ? ? ? Training_sample$elev+Training_sample$dist, 
> obj.model = zinc.vgm)
>  ?zinc_train <- krige.conv(Training_sample.geo, locations=locs2, krige=KC)
>  ?# do prediction for new locations in Hold-Out sample set
>  ?newlocs2 = Holdout_sample at coords
>  ?KC2 = krige.control(trend.d = trend, trend.l = ~
>  ? ? ? ? ? ? ? ? ? ? ? Holdout_sample$lead+Holdout_sample$copper+
>  ? ? ? ? ? ? ? ? ? ? ?Holdout_sample$elev+Holdout_sample$dist, obj.model 
> = zinc.vgm)
>  ?zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2, 
> krige=KC2)
>  ?# Computing Predictive errors for Training and Hold Out samples 
> respectively
>  ?training_prediction_error_term <- Training_sample$zinc - 
> zinc_train$predict
>  ?holdout_prediction_error_term <- Holdout_sample$zinc - 
> zinc_holdout$predict
> 
>  ?# Function that returns Mean Absolute Error
>  ?mae <- function(error)
>  ?{
>  ? ?mean(abs(error))
>  ?}
>  ?# Mean Absolute Error metric :
>  ?# UK Predictive errors for Training sample set , and UK Predictive 
> Errors for HoldOut sample set
>  ?print(mae(training_prediction_error_term)) #Error for Training sample set
>  ?print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
> 
> 
> 
> 
> ------------------------------------------------------------------------
> *From:* Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive 
> difference for Univ. Kriging?
> 
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>> 
>> Thank you Tom. A?couple questions.
>> 1) In your code, you used log1p for computing ?zinc.vgm. But log1p is 
>> not used when defining?trend.l for the krige.control 'KC'. Do we need 
>> log1p for the zinc response (dependent) variable when defining trend.l?
> 
> Log-transformation in linkfit is defined by setting "lambda=0". I know
> it is a very cryptic package but it has all you need - transformation,
> back-transformation, REML fitting of variograms, trend components etc etc.
> 
>> 
>> 2) The?exponent back-transform is not?applied anywhere after 
>> applying?log1p for computing?the? zinc.vgm variable. Do we need exp 
>> anywhere or is it done internally?
> 
> It is done internally.
> 
>> 
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable or 
>> does geoR do this internally?
> 
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
> 
>> 
>> 4) Is it more advisable to use likfit instead of variofit and why?
> 
> likfit has probably more options for variogram modelling (these could
> get quite computational and I think fitting vgms with >>1000 geoR is not
> recommended, while in gstat it is still doable), but it could be a
> matter of taste.
> 
>> 
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
> 
> Arbitrary initial parameter. It does not have to be very accurate.
> 
>> 
>> appreciated,
>> Chris
>> 
>> ------------------------------------------------------------------------
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of 
>> Tomislav Hengl <tom.hengl at gmail.com>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive 
>> difference for Univ. Kriging?
>> 
>> Hi Chris,
>> 
>> First of all, I think your back-transformation is not correct since you
>> need to add half the prediction variance to values as indicated in the
>> Diggle and Ribeiro (2007) P-61
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png 
> 
>> 
>> 
>> ).
>> Otherwise you underpredict the values and hence the cross-validation
>> error will be high.
>> 
>> I also do not see much point in using lead and copper as covariates
>> since they are only available at sampling locations.
>> 
>> For log-normal or not-normal variables I advise using geoR package that
>> does all the transformations for you (it would be interesting to see if
>> gstat and geoR give exactly the same numbers if the same transformations
>> and back-transformations are applied):
>> 
>> R> library(geoR)
>> --------------------------------------------------------------
>>? ?? Analysis of Geostatistical Data
>>? ?? For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
>> The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
>> www.leg.ufpr.br <http://www.leg.ufpr.br>
>> geoR is a free and open-source package for geostatistical analysis to be 
>> used as a add-on to the R system
>> 
>> 
>> 
>>? ?? geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>> 
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
>> R> meuse = meuse[sel.d,]
>> R> meuse.geo <- as.geodata(meuse["zinc"])
>> R> ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
>> R> trend = ~ lead+copper+elev+dist
>> R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>? ?????????? arguments for the maximisation function.
>>? ????????? For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>? ????????? times with different initial values for the parameters.
>> likfit: WARNING: This step can be time demanding!
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>? ?????? beta0????? beta1????? beta2????? beta3????? beta4????? tausq
>> sigmasq??????? phi?????? psiA
>> "? 6.0853" "? 0.0033" "? 0.0053" " -0.0810" " -0.9805" "? 0.0210" "
>> 0.0717" "799.9942" "? 0.2619"
>>? ??????? psiR
>> "? 3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>> 
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>> 
>> HTH,
>> 
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ... 
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject to 
>> ORCID's Terms and Conditions of Use
>> 
>> 
>> 
>> 
>> 
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>> 
>>> 
>>> 
>>> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#> 
> 
>> 
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>>        
>> Why is Predictive error large for Universal Kriging? 
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat 
>> library in R. I am following a strategy used in Machine Learning where 
>> data is partioned into a Train set and Hold out set. The...
>> 
>> 
>> 
>>> 
>>> 
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining? the semivariogram.
>>> 
>>> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and 
>> advice is welcome.
>>> 
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>> 
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
>>> 
>>> Training_sample = dataset[Training_ids,]
>>> Holdout_sample_allvars = dataset[-Training_ids,]
>>> 
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>> 
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>> 
>>> # Semivariogram modeling
>>> m1? <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
>>> m <- vgm("Exp")
>>> m <- fit.variogram(m1, m)
>>> 
>>> 
>>> # Apply Univ Krig to Training dataset
>>> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
>>> prediction_training_data <- expm1(prediction_training_data$var1.pred)
>>> 
>>> # Apply Univ Krig to Hold Out dataset
>>> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
>>> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
>>> 
>>> # Computing Predictive errors for Training and Hold Out samples respectively
>>> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
>>> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
>>> 
>>> 
>>> 
>>> # Function that returns Mean Absolute Error
>>> mae <- function(error)
>>> {
>>>??? mean(abs(error))
>>> }
>>> 
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>>> 
>>> 
>>> cheers,
>>> 
>>> Kristopher (Chris)
>>> 
>>>??????? [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions and 
>> packages for handling and analysis of spatial, and particularly 
>> geographical, data.
>> 
>> 
>> 
>>>
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions and 
>> packages for handling and analysis of spatial, and particularly 
>> geographical, data.
>> 
>> 
>>


From edzer.pebesma at uni-muenster.de  Wed Nov 22 22:55:02 2017
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 22 Nov 2017 22:55:02 +0100
Subject: [R-sig-Geo] Why is the covariance in Universal Kriging modeled
 this way in lectures by Prof. Edzer Pebesma?
In-Reply-To: <YTXPR0101MB11490478EF8EB27A738C1BA490200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <YTXPR0101MB1149BA555ACBFB88134DA18B90230@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <9fca0070-f9ad-1c68-cd81-cf77c265f338@uni-muenster.de>
 <YTXPR0101MB11490478EF8EB27A738C1BA490200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <4f96f149-5096-9c42-ecfe-1d7b3386b760@uni-muenster.de>



On 11/22/2017 10:23 PM, Joelle k. Akram wrote:
> thank you for clarifying Prof. Pebesma. I have a couple more question
> for you regarding the inclusion of a
> 
> nugget to the diagonals of V. As we know,there are 2 covariances, V and
> v;?one for the existing coordinates (i.e., V)?and the other for the
> distances between these existing coordinates and other new locations
> (i.e., v).
> 
> 
> I) Assuming unscaled coordinates in latitude/longitude; should the
> Nugget theoretically be a small value (lets say typically less than <1)
> or does it depend on other the dataset's spatial distribution,etc?
> 

I would say it should depend on the data.

> 
> 2) When computing Beta coefficients as in you lecture 7 in github, do we
> have to add the nugget term to both V and v or only one of them?

For a nugget, by definition to each of them; if you'd only add it to V
you no longer obtain an exact interpolator (i.e., you no longer predict
the data value at data locations); if your measured process is subject
to a measurement error, this may however be preferred.

> 
> 
> thank you,
> 
> Chris Akram
> 
> 
> 
> 
> ------------------------------------------------------------------------
> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Edzer
> Pebesma <edzer.pebesma at uni-muenster.de>
> *Sent:* November 22, 2017 6:16 AM
> *To:* r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Why is the covariance in Universal Kriging
> modeled this way in lectures by Prof. Edzer Pebesma?
> ?
> 
> 
> On 11/22/2017 12:09 AM, Joelle k. Akram wrote:
>> Greetings,
>> 
>> There is code for Universal Kriging from Prof. Edzer Pebesma in GitHub<https://github.com/edzer/mstp/blob/master/lec7.Rmd>.
> 
> edzer/mstp <https://github.com/edzer/mstp/blob/master/lec7.Rmd>
> github.com
> mstp - Course slides: modelling spatio-temporal processes
> 
> 
> 
> 
> https://edzer.github.io/mstp/lec7.html
> 
> gives you the rendered version.
> 
>> 
>> The covariance function is defined as follows:
>> 
>> cov = function(h) exp(-h)
>> 
>> And defined without any variogram modeling/generation to produce partial sill, range or nugget parameters for defining the covariance matrix.
> 
> Well, it implies nugget=0, sill=1 and range parameter=1, it was the
> shortest covariance function I could think of.
> 
>> 
>> If? I want to include a regularization term to account for singularity effects caused due to close spatial points, how do I modify the matrix computation for computing the 'beta' coefficients ?
> 
> Add a nugget (i.e. add a constant to the diagonal of V)?
> 
>> 
>> I know there are standard formulae for different models (e.g. Matern, Exp,etc). But I would like to retain the simple cov function defined above and possibly use a regularizer (like ridge regression) to account for a nugget-like effect.
>> 
>> thanks,
>> 
>> Chris
>> 
>>??????? [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From Jin.Li at ga.gov.au  Wed Nov 22 23:05:33 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 22:05:33 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <YTXPR0101MB114941A86489BC86CBDF778390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>,
 <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
 <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <853bf908404d4f8a83f5cd5c7a5eb430@win-exch-prod02.prod.lan>
 <YTXPR0101MB114941A86489BC86CBDF778390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <d0852fe0e8894f9190361c7f9a4d8abf@win-exch-prod02.prod.lan>

Now I guess you need to understand how KED works. This paper https://doi.org/10.1016/j.envsoft.2013.12.008 may give you some clue. Theoretically, the mae of KED for the training dataset should be 0 due to its nature (hint: exactness).

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 5:38 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


Jin,



do you think there is potential evidence of overfitting for KED given the large difference in MAE betwen the train and holdout sets?

________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 7:00 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


For both models, the MAE for holdout is larger than that for the training. That is expected.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:49 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



thanks Jin. The reason I am very surprised by the MAE_train and MAE_holdOut differences is due to my comparison of the KED (i.e., Univ krig. code in my initial message post) with Linear Regression.



Please see below for the Linear Regression code where the MAE_training_set = 90.1 and the MAE_holdOut_set = 97.4

On the other hand, KED  gave me MAE_training_set = 1 and the MAE_holdOut_set = 76.5.



Given that KED is a linear model (i.e. Linear Reg + Ord Krig.) I am surprised by these differences. Any insight from your end is appreciated.



cat("\014")

rm(list=ls())

cls <- function() cat(rep("\n",100))

cls()

graphics.off()

setwd("C:/Users/Ravi Persad/Desktop/OwenSound_Region25_UR010")

options(scipen = 999)

graphics.off()







library(sp)

library(gstat)

data(meuse)

dataset= meuse

set.seed(999)



# Split Meuse Dataset into Training and HoldOut Sample datasets

Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))



Training_sample = dataset[Training_ids,]

Holdout_sample_allvars = dataset[-Training_ids,]



holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])

Hold_out_sample = holdoutvars_df[-Training_ids,]



coordinates(Training_sample) <- c('x','y')

coordinates(Hold_out_sample) <- c('x','y')



# Semivariogram modeling

m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)

m <- vgm("Exp")

m <- fit.variogram(m1, m)





# Apply Linear regression to Training dataset

train_model <- lm(log(zinc)~lead+copper+elev+dist, Training_sample)

prediction_training_data <- expm1(predict(train_model,newdata =Training_sample ))



# Apply Linear Regression to Hold Out dataset

prediction_holdout_data <- expm1(predict(train_model,newdata =Hold_out_sample ))



# Computing Predictive errors for Training and Hold Out samples respectively

training_prediction_error_term <- Training_sample$zinc - prediction_training_data

holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error

mae <- function(error)

{

  mean(abs(error))

}



# Mean Absolute Error metric :

# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set

print(mae(training_prediction_error_term)) #Error for Training sample set

print(mae(holdout_prediction_error_term)) #Error for Hold out sample set





________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:36 PM
To: Li Jin; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org%3cmailto:R-sig-Geo at r-project.org>>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 23:06:57 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 22:06:57 +0000
Subject: [R-sig-Geo] Fw: Why is there a large predictive difference for
 Univ. Kriging?
In-Reply-To: <af062fd9-1ba1-c375-c1fe-0db910aaa755@gmail.com>
References: <3746b2cd-bb3f-636a-9212-28865382fbb1@gmail.com>
 <7bd1b8ce-8354-2180-163f-192b44687af9@gmail.com>
 <YTXPR0101MB1149B4973C33D72696D4FA6A90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <973043e4-94bf-47d3-f0f8-4f1585318c6f@gmail.com>
 <YTXPR0101MB1149374886ACFD8B34D95BBC90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <af062fd9-1ba1-c375-c1fe-0db910aaa755@gmail.com>
Message-ID: <YTXPR0101MB1149AF9D9BB8A1577472691790200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Thanks Tom. In terms of over-estimation/under-estimation issues, are there any known ways they are treated

for kriging or is it simply experimenting with different variogram functions and paramters (e.g., Circular, Exp,etc)?


cheers

Chris


________________________________
From: Tomislav Hengl <tom.hengl at gmail.com>
Sent: November 22, 2017 2:41 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Any type of kriging is a convex predictor which means that predictions
at sampling locations will exactly match measured numbers. That is why
you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad
considering that the range of values is: 113-1839. If your repeat the CV
process e.g. 10 times you will get a more stable estimate of MAE. Even
more interesting is the simple mean error (ME) which tells you whether
there are over-estimation or under-estimation problem. Also plotting
observed vs predicted (as in
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla)
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
>
>
> I tried splitting the data into 'training' set and a 'holdout' sample
> set as in my original post. I seem to be getting consistent results,
> i.e., a large predictive difference in terms of MAE between both sets.
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my
> opinion, this significant difference is an indication of over-fitting on
> the training sample set for the semi-variogram modeling. The code is
> below.  Any of your insights are welcome.
>
>
> demo(meuse, echo=FALSE)
>   set.seed(999)
>   sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
>   meuse = meuse[sel.d,]
>   Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7* nrow(meuse)))
>   Training_sample = meuse[Training_ids,]
>   Holdout_sample = meuse[-Training_ids,]
>   # Generate VGM using Training set
>   Training_sample.geo <- as.geodata(Training_sample["zinc"])
>   ## add covariates:
>   Training_sample.geo$covariate =
> Training_sample at data[,c("lead","copper","elev", "dist")]
> trend = ~ lead+copper+elev+dist
>   zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>                        ini=c(var(log1p(Training_sample.geo$data)),800),
> fix.psiA = FALSE, fix.psiR = FALSE)
>
> # do prediction for locations in Training set
>   locs2 = Training_sample at coords
>   KC = krige.control(trend.d = trend, trend.l = ~
>                        Training_sample$lead+Training_sample$copper+
>                        Training_sample$elev+Training_sample$dist,
> obj.model = zinc.vgm)
>   zinc_train <- krige.conv(Training_sample.geo, locations=locs2, krige=KC)
>   # do prediction for new locations in Hold-Out sample set
>   newlocs2 = Holdout_sample at coords
>   KC2 = krige.control(trend.d = trend, trend.l = ~
>                        Holdout_sample$lead+Holdout_sample$copper+
>                       Holdout_sample$elev+Holdout_sample$dist, obj.model
> = zinc.vgm)
>   zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2,
> krige=KC2)
>   # Computing Predictive errors for Training and Hold Out samples
> respectively
>   training_prediction_error_term <- Training_sample$zinc -
> zinc_train$predict
>   holdout_prediction_error_term <- Holdout_sample$zinc -
> zinc_holdout$predict
>
>   # Function that returns Mean Absolute Error
>   mae <- function(error)
>   {
>     mean(abs(error))
>   }
>   # Mean Absolute Error metric :
>   # UK Predictive errors for Training sample set , and UK Predictive
> Errors for HoldOut sample set
>   print(mae(training_prediction_error_term)) #Error for Training sample set
>   print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>
>
>
>
> ------------------------------------------------------------------------
> *From:* Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
> difference for Univ. Kriging?
>
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>>
>> Thank you Tom. A couple questions.
>> 1) In your code, you used log1p for computing  zinc.vgm. But log1p is
>> not used when defining trend.l for the krige.control 'KC'. Do we need
>> log1p for the zinc response (dependent) variable when defining trend.l?
>
> Log-transformation in linkfit is defined by setting "lambda=0". I know
> it is a very cryptic package but it has all you need - transformation,
> back-transformation, REML fitting of variograms, trend components etc etc.
>
>>
>> 2) The exponent back-transform is not applied anywhere after
>> applying log1p for computing the  zinc.vgm variable. Do we need exp
>> anywhere or is it done internally?
>
> It is done internally.
>
>>
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable or
>> does geoR do this internally?
>
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
>
>>
>> 4) Is it more advisable to use likfit instead of variofit and why?
>
> likfit has probably more options for variogram modelling (these could
> get quite computational and I think fitting vgms with >>1000 geoR is not
> recommended, while in gstat it is still doable), but it could be a
> matter of taste.
>
>>
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
>
> Arbitrary initial parameter. It does not have to be very accurate.
>
>>
>> appreciated,
>> Chris
>>
>> ------------------------------------------------------------------------
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
>> Tomislav Hengl <tom.hengl at gmail.com>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
>> difference for Univ. Kriging?
>>
>> Hi Chris,
>>
>> First of all, I think your back-transformation is not correct since you
>> need to add half the prediction variance to values as indicated in the
>> Diggle and Ribeiro (2007) P-61
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ribeiro_2007_P61.png
>
>>
>>
>> ).
>> Otherwise you underpredict the values and hence the cross-validation
>> error will be high.
>>
>> I also do not see much point in using lead and copper as covariates
>> since they are only available at sampling locations.
>>
>> For log-normal or not-normal variables I advise using geoR package that
>> does all the transformations for you (it would be interesting to see if
>> gstat and geoR give exactly the same numbers if the same transformations
>> and back-transformations are applied):
>>
>> R> library(geoR)
>> --------------------------------------------------------------
>>     Analysis of Geostatistical Data
>>     For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
>> The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
>> www.leg.ufpr.br<http://www.leg.ufpr.br> <http://www.leg.ufpr.br>
>> geoR is a free and open-source package for geostatistical analysis to be
>> used as a add-on to the R system
>>
>>
>>
>>     geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>>
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", "dist")])
>> R> meuse = meuse[sel.d,]
>> R> meuse.geo <- as.geodata(meuse["zinc"])
>> R> ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", "dist")]
>> R> trend = ~ lead+copper+elev+dist
>> R> zinc.vgm <- likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>             arguments for the maximisation function.
>>            For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>            times with different initial values for the parameters.
[[elided Hotmail spam]]
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>         beta0      beta1      beta2      beta3      beta4      tausq
>> sigmasq        phi       psiA
>> "  6.0853" "  0.0033" "  0.0053" " -0.0810" " -0.9805" "  0.0210" "
>> 0.0717" "799.9942" "  0.2619"
>>          psiR
>> "  3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>>
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>>
>> HTH,
>>
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject to
>> ORCID's Terms and Conditions of Use
>>
>>
>>
>>
>>
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>>
>>>
>>>
>>> down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>
>>
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>>
>> Why is Predictive error large for Universal Kriging?
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat
>> library in R. I am following a strategy used in Machine Learning where
>> data is partioned into a Train set and Hold out set. The...
>>
>>
>>
>>>
>>>
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining  the semivariogram.
>>>
>>> I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and
>> advice is welcome.
>>>
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>>
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))
>>>
>>> Training_sample = dataset[Training_ids,]
>>> Holdout_sample_allvars = dataset[-Training_ids,]
>>>
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>>
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>>
>>> # Semivariogram modeling
>>> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)
>>> m <- vgm("Exp")
>>> m <- fit.variogram(m1, m)
>>>
>>>
>>> # Apply Univ Krig to Training dataset
>>> prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m)
>>> prediction_training_data <- expm1(prediction_training_data$var1.pred)
>>>
>>> # Apply Univ Krig to Hold Out dataset
>>> prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m)
>>> prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)
>>>
>>> # Computing Predictive errors for Training and Hold Out samples respectively
>>> training_prediction_error_term <- Training_sample$zinc - prediction_training_data
>>> holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data
>>>
>>>
>>>
>>> # Function that returns Mean Absolute Error
>>> mae <- function(error)
>>> {
>>>    mean(abs(error))
>>> }
>>>
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample set
>>>
>>>
>>> cheers,
>>>
>>> Kristopher (Chris)
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions and
>> packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions and
>> packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>

	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Wed Nov 22 23:22:43 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 22:22:43 +0000
Subject: [R-sig-Geo] [DKIM] Re: [DKIM] Fw: Why is there a large
 predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <d0852fe0e8894f9190361c7f9a4d8abf@win-exch-prod02.prod.lan>
References: <06a97e99415d407d981d88d975aac751@win-exch-prod02.prod.lan>
 <6318_1511312162_5A14CB18_6318_12291_1_YTXPR0101MB11492C73FF3718F4C9B35CB990200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <c7ccd74247194c1398ab436e27c25cbc@win-exch-prod02.prod.lan>
 <YTXPR0101MB114965FFA543804B4FF634A390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
 <3505_1511313740_5A14D14C_3505_9778_1_70828f8c0d004e50a8519354fffd90a4@win-exch-prod02.prod.lan>,
 <439eb3105f504f718acba44a72fa13f3@win-exch-prod02.prod.lan>
 <YTXPR0101MB1149906C73E54EE03A0AD95690200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <853bf908404d4f8a83f5cd5c7a5eb430@win-exch-prod02.prod.lan>
 <YTXPR0101MB114941A86489BC86CBDF778390200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <d0852fe0e8894f9190361c7f9a4d8abf@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB114928B91BA03019B3EB779B90200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

thanks Jin.


________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 22, 2017 3:05 PM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


Now I guess you need to understand how KED works. This paper https://doi.org/10.1016/j.envsoft.2013.12.008 may give you some clue. Theoretically, the mae of KED for the training dataset should be 0 due to its nature (hint: exactness).



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 5:38 PM
To: Li Jin; r-sig-geo at r-project.org
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Jin,



do you think there is potential evidence of overfitting for KED given the large difference in MAE betwen the train and holdout sets?



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 7:00 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



For both models, the MAE for holdout is larger than that for the training. That is expected.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:49 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



thanks Jin. The reason I am very surprised by the MAE_train and MAE_holdOut differences is due to my comparison of the KED (i.e., Univ krig. code in my initial message post) with Linear Regression.



Please see below for the Linear Regression code where the MAE_training_set = 90.1 and the MAE_holdOut_set = 97.4

On the other hand, KED  gave me MAE_training_set = 1 and the MAE_holdOut_set = 76.5.



Given that KED is a linear model (i.e. Linear Reg + Ord Krig.) I am surprised by these differences. Any insight from your end is appreciated.



cat("\014")

rm(list=ls())

cls <- function() cat(rep("\n",100))

cls()

graphics.off()

setwd("C:/Users/Ravi Persad/Desktop/OwenSound_Region25_UR010")

options(scipen = 999)

graphics.off()







library(sp)

library(gstat)

data(meuse)

dataset= meuse

set.seed(999)



# Split Meuse Dataset into Training and HoldOut Sample datasets

Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))



Training_sample = dataset[Training_ids,]

Holdout_sample_allvars = dataset[-Training_ids,]



holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])

Hold_out_sample = holdoutvars_df[-Training_ids,]



coordinates(Training_sample) <- c('x','y')

coordinates(Hold_out_sample) <- c('x','y')



# Semivariogram modeling

m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample)

m <- vgm("Exp")

m <- fit.variogram(m1, m)





# Apply Linear regression to Training dataset

train_model <- lm(log(zinc)~lead+copper+elev+dist, Training_sample)

prediction_training_data <- expm1(predict(train_model,newdata =Training_sample ))



# Apply Linear Regression to Hold Out dataset

prediction_holdout_data <- expm1(predict(train_model,newdata =Hold_out_sample ))



# Computing Predictive errors for Training and Hold Out samples respectively

training_prediction_error_term <- Training_sample$zinc - prediction_training_data

holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error

mae <- function(error)

{

  mean(abs(error))

}



# Mean Absolute Error metric :

# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set

print(mae(training_prediction_error_term)) #Error for Training sample set

print(mae(holdout_prediction_error_term)) #Error for Hold out sample set





________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 21, 2017 6:36 PM
To: Li Jin; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



BTW, to your question, the first MAE is measuring the goodness of fit, the second measuring the predictive accuracy. The second paper below has partially address this.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Li Jin
Sent: Wednesday, 22 November 2017 12:22 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] [DKIM] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]

Although regression models are transparent, their predictive accuracy is poor in many cases, especially in environmental modelling, because of non-linear relationships and interactions. If your modelling purpose is to generate spatial predictions, I would suggest try spm first.
As to the assessment of predictive models, MAE has its limitations and you may be interested in https://doi.org/10.1016/j.envsoft.2016.02.004 and https://doi.org/10.1371/journal.pone.0183250.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 12:13 PM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


no problem Jin. I am looking a for regression model that is transparent, i.e., where I can obtain the regression fitting coefficients (beta) for each covariate. Do you recommend any in spm to use?

Also which you do think from your experience, will have a similar predictive performance (MAE) for both the training sample set, as well as, the hold-out sample test set?

cheers,
Chris
________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 6:07 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]


They are not yet.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Wednesday, 22 November 2017 11:56 AM
To: Li Jin; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] Re: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Jin,



thank you for sharing. I was having a read of your paper:"Application of machine learning methods to spatial interpolation of environmental variables " of which the spm package is based.



In Table 1 from the paper you compare many algorithms. I was interested in assessing RKglm, RKgls, RKlm. Are these available in spm?



thanks

Chris



________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au%3cmailto:Jin.Li at ga.gov.au>>>
Sent: November 21, 2017 5:33 PM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: RE: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging? [SEC=UNCLASSIFIED]



Hi Chris,
The UK used here is usually called kriging with an external drift (KED). It, in fact, is a linear model plus kriging, which assumes linear relationship that is usually not true. It has been tested in several studies and was outperformed by machine learning methods like RF, RFOK, RFIDW etc. I have release an R package, spm, to introduce these methods. It is easy to use as demonstrated in vignette('spm').
Hope this helps.
Regards,
Jin

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Joelle k. Akram
Sent: Wednesday, 22 November 2017 11:08 AM
To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org%3cmailto:r-sig-geo at r-project.org>>
Subject: [DKIM] [R-sig-Geo] Fw: Why is there a large predictive difference forUniv. Kriging?




down votefavorite<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging#<https://stackoverflow.com/questions/47424740/why-is-predictive-error-large-for-universal-kriging>>


I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and defining the semivariogram.

I employ UK to predict on both the Train sample set, as well as the Hold Out sample set. However, there mean absolute error (MAE) from the predictions of the response variable (i.e., zinc for the Meuse dataset) and actual values are very different. I would expect them to be similar or at least closer. So far I have MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and advice is welcome.

library(sp)
library(gstat)
data(meuse)
dataset= meuse
set.seed(999)

# Split Meuse Dataset into Training and HoldOut Sample datasets Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* nrow(dataset)))

Training_sample = dataset[Training_ids,] Holdout_sample_allvars = dataset[-Training_ids,]

holdoutvars_df <-(dataset[,which(names(dataset) %in% c("x","y","lead","copper","elev","dist"))])
Hold_out_sample = holdoutvars_df[-Training_ids,]

coordinates(Training_sample) <- c('x','y')
coordinates(Hold_out_sample) <- c('x','y')

# Semivariogram modeling
m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m <- vgm("Exp") m <- fit.variogram(m1, m)


# Apply Univ Krig to Training dataset
prediction_training_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Training_sample, model = m) prediction_training_data <- expm1(prediction_training_data$var1.pred)

# Apply Univ Krig to Hold Out dataset
prediction_holdout_data <- krige(log(zinc)~lead+copper+elev+dist, Training_sample, Hold_out_sample, model = m) prediction_holdout_data <- expm1(prediction_holdout_data$var1.pred)

# Computing Predictive errors for Training and Hold Out samples respectively training_prediction_error_term <- Training_sample$zinc - prediction_training_data holdout_prediction_error_term <- Holdout_sample_allvars$zinc - prediction_holdout_data



# Function that returns Mean Absolute Error mae <- function(error) {
  mean(abs(error))
}

# Mean Absolute Error metric :
# UK Predictive errors for Training sample set , and UK Predictive Errors for HoldOut sample set
print(mae(training_prediction_error_term)) #Error for Training sample set
print(mae(holdout_prediction_error_term)) #Error for Hold out sample set


cheers,

Kristopher (Chris)

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org%3cmailto:R-sig-Geo at r-project.org>>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Wed Nov 22 23:28:04 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 22:28:04 +0000
Subject: [R-sig-Geo] [DKIM] Re: Fw: Why is there a large predictive
 difference for Univ. Kriging? [SEC=UNCLASSIFIED]
Message-ID: <002515c5e2ad4669b365f02f4f4b694c@win-exch-prod02.prod.lan>

Let try spm and see what we can achieve. All these scripts were directly modified from examples in spm.
> library(spm)
> library(sp)
> library(gstat)
> data(meuse)

> set.seed(999)
> rfcv1 <- RFcv(meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL") # I used the same predictors in the same order as in your model for comparison purpose.
> rfcv1$mae
[1] 53.54404 # This much lower than that for KED

> set.seed(999)
> rfcv1 <- rfokcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.22274 # This one further improved the accuracy in comparison with that for RF

> set.seed(999)
> rfcv1 <- rfidwcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL") 
> rfcv1$mae
[1] 42.60406 # This one is similar to RFOK

You may try rfcv1$vecv for each method and see how accurate the models are.

I guess the results speak loudly what should be used.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Tomislav Hengl
Sent: Thursday, 23 November 2017 8:42 AM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Any type of kriging is a convex predictor which means that predictions at sampling locations will exactly match measured numbers. That is why you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad considering that the range of values is: 113-1839. If your repeat the CV process e.g. 10 times you will get a more stable estimate of MAE. Even more interesting is the simple mean error (ME) which tells you whether there are over-estimation or under-estimation problem. Also plotting observed vs predicted (as in
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla)
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
> 
> 
> I tried splitting the data into 'training' set?and a 'holdout' sample 
> set as in my original post. I seem to be getting consistent results, 
> i.e., a?large predictive difference in terms of MAE between both sets.
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my 
> opinion, this significant difference is an indication of over-fitting?
> on the training sample set for the semi-variogram modeling. The code 
> is below.? Any of your insights are?welcome.
> 
> 
> demo(meuse, echo=FALSE)
>  ?set.seed(999)
>  ?sel.d = complete.cases(meuse at data[,c("lead","copper","elev", 
> "dist")])
>  ?meuse = meuse[sel.d,]
>  ?Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7* 
> nrow(meuse)))
>  ?Training_sample = meuse[Training_ids,]
>  ?Holdout_sample = meuse[-Training_ids,]
>  ?# Generate VGM using Training set
>  ?Training_sample.geo <- as.geodata(Training_sample["zinc"])
>  ?## add covariates:
>  ?Training_sample.geo$covariate =
> Training_sample at data[,c("lead","copper","elev", "dist")] trend = ~ 
> lead+copper+elev+dist
>  ?zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>  ? ? ? ? ? ? ? ? ? ? ? 
> ini=c(var(log1p(Training_sample.geo$data)),800),
> fix.psiA = FALSE, fix.psiR = FALSE)
> 
> # do prediction for locations in Training set
>  ?locs2 = Training_sample at coords
>  ?KC = krige.control(trend.d = trend, trend.l = ~
>  ? ? ? ? ? ? ? ? ? ? ? Training_sample$lead+Training_sample$copper+
>  ? ? ? ? ? ? ? ? ? ? ? Training_sample$elev+Training_sample$dist,
> obj.model = zinc.vgm)
>  ?zinc_train <- krige.conv(Training_sample.geo, locations=locs2, 
> krige=KC)
>  ?# do prediction for new locations in Hold-Out sample set
>  ?newlocs2 = Holdout_sample at coords
>  ?KC2 = krige.control(trend.d = trend, trend.l = ~
>  ? ? ? ? ? ? ? ? ? ? ? Holdout_sample$lead+Holdout_sample$copper+
>  ? ? ? ? ? ? ? ? ? ? ?Holdout_sample$elev+Holdout_sample$dist, 
> obj.model = zinc.vgm)
>  ?zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2,
> krige=KC2)
>  ?# Computing Predictive errors for Training and Hold Out samples 
> respectively
>  ?training_prediction_error_term <- Training_sample$zinc - 
> zinc_train$predict
>  ?holdout_prediction_error_term <- Holdout_sample$zinc - 
> zinc_holdout$predict
> 
>  ?# Function that returns Mean Absolute Error
>  ?mae <- function(error)
>  ?{
>  ? ?mean(abs(error))
>  ?}
>  ?# Mean Absolute Error metric :
>  ?# UK Predictive errors for Training sample set , and UK Predictive 
> Errors for HoldOut sample set
>  ?print(mae(training_prediction_error_term)) #Error for Training 
> sample set
>  ?print(mae(holdout_prediction_error_term)) #Error for Hold out sample 
> set
> 
> 
> 
> 
> ----------------------------------------------------------------------
> --
> *From:* Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive 
> difference for Univ. Kriging?
> 
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>> 
>> Thank you Tom. A?couple questions.
>> 1) In your code, you used log1p for computing ?zinc.vgm. But log1p is 
>> not used when defining?trend.l for the krige.control 'KC'. Do we need 
>> log1p for the zinc response (dependent) variable when defining trend.l?
> 
> Log-transformation in linkfit is defined by setting "lambda=0". I know 
> it is a very cryptic package but it has all you need - transformation, 
> back-transformation, REML fitting of variograms, trend components etc etc.
> 
>> 
>> 2) The?exponent back-transform is not?applied anywhere after applying?
>> log1p for computing?the? zinc.vgm variable. Do we need exp anywhere 
>> or is it done internally?
> 
> It is done internally.
> 
>> 
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable 
>> or does geoR do this internally?
> 
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
> 
>> 
>> 4) Is it more advisable to use likfit instead of variofit and why?
> 
> likfit has probably more options for variogram modelling (these could 
> get quite computational and I think fitting vgms with >>1000 geoR is 
> not recommended, while in gstat it is still doable), but it could be a 
> matter of taste.
> 
>> 
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
> 
> Arbitrary initial parameter. It does not have to be very accurate.
> 
>> 
>> appreciated,
>> Chris
>> 
>> ---------------------------------------------------------------------
>> ---
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of 
>> Tomislav Hengl <tom.hengl at gmail.com>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive 
>> difference for Univ. Kriging?
>> 
>> Hi Chris,
>> 
>> First of all, I think your back-transformation is not correct since 
>> you need to add half the prediction variance to values as indicated 
>> in the Diggle and Ribeiro (2007) P-61 
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ri
>> beiro_2007_P61.png
> 
>> 
>> 
>> ).
>> Otherwise you underpredict the values and hence the cross-validation 
>> error will be high.
>> 
>> I also do not see much point in using lead and copper as covariates 
>> since they are only available at sampling locations.
>> 
>> For log-normal or not-normal variables I advise using geoR package 
>> that does all the transformations for you (it would be interesting to 
>> see if gstat and geoR give exactly the same numbers if the same 
>> transformations and back-transformations are applied):
>> 
>> R> library(geoR)
>> --------------------------------------------------------------
>>? ?? Analysis of Geostatistical Data
>>? ?? For an Introduction to geoR go to http://www.leg.ufpr.br/geoR  
>>The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>  
>>www.leg.ufpr.br <http://www.leg.ufpr.br>  geoR is a free and 
>>open-source package for geostatistical analysis to be  used as a 
>>add-on to the R system
>> 
>> 
>> 
>>? ?? geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>> 
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev", 
>> R> "dist")]) meuse = meuse[sel.d,] meuse.geo <- 
>> R> as.geodata(meuse["zinc"]) ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev", 
>> R> "dist")] trend = ~ lead+copper+elev+dist zinc.vgm <- 
>> R> likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR = 
>>FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>? ?????????? arguments for the maximisation function.
>>? ????????? For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>? ????????? times with different initial values for the parameters.
>> likfit: WARNING: This step can be time demanding!
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>? ?????? beta0????? beta1????? beta2????? beta3????? beta4????? tausq  
>>sigmasq??????? phi?????? psiA  "? 6.0853" "? 0.0033" "? 0.0053" " 
>>-0.0810" " -0.9805" "? 0.0210" "
>> 0.0717" "799.9942" "? 0.2619"
>>? ??????? psiR
>> "? 3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>> 
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the 
>> user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>> 
>> HTH,
>> 
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ... 
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject 
>> to ORCID's Terms and Conditions of Use
>> 
>> 
>> 
>> 
>> 
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>> 
>>> 
>>> 
>>> down 
>>> votefavorite<https://stackoverflow.com/questions/47424740/why-is-pre
>>> dictive-error-large-for-universal-kriging#>
> 
>> 
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
>> -large-for-universal-kriging#>
>>        
>> Why is Predictive error large for Universal Kriging? 
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
>> -large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat 
>> library in R. I am following a strategy used in Machine Learning 
>> where data is partioned into a Train set and Hold out set. The...
>> 
>> 
>> 
>>> 
>>> 
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining? the semivariogram.
>>> 
>>> I employ UK to predict on both the Train sample set, as well as the 
>>> Hold Out sample set. However, there mean absolute error (MAE) from 
>>> the predictions of the response variable (i.e., zinc for the Meuse 
>>> dataset) and actual values are very different. I would expect them 
>>> to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and 
>> advice is welcome.
>>> 
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>> 
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets 
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7* 
>>> nrow(dataset)))
>>> 
>>> Training_sample = dataset[Training_ids,] Holdout_sample_allvars = 
>>> dataset[-Training_ids,]
>>> 
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in% 
>>> c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>> 
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>> 
>>> # Semivariogram modeling
>>> m1? <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m 
>>> <- vgm("Exp") m <- fit.variogram(m1, m)
>>> 
>>> 
>>> # Apply Univ Krig to Training dataset prediction_training_data <- 
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample, 
>>> Training_sample, model = m) prediction_training_data <- 
>>> expm1(prediction_training_data$var1.pred)
>>> 
>>> # Apply Univ Krig to Hold Out dataset prediction_holdout_data <- 
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample, 
>>> Hold_out_sample, model = m) prediction_holdout_data <- 
>>> expm1(prediction_holdout_data$var1.pred)
>>> 
>>> # Computing Predictive errors for Training and Hold Out samples 
>>> respectively training_prediction_error_term <- Training_sample$zinc 
>>> - prediction_training_data holdout_prediction_error_term <- 
>>> Holdout_sample_allvars$zinc - prediction_holdout_data
>>> 
>>> 
>>> 
>>> # Function that returns Mean Absolute Error  mae <- function(error)  
>>>{
>>>??? mean(abs(error))
>>> }
>>> 
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive 
>>> Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training 
>>> sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample 
>>> set
>>> 
>>> 
>>> cheers,
>>> 
>>> Kristopher (Chris)
>>> 
>>>??????? [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions 
>> and packages for handling and analysis of spatial, and particularly 
>> geographical, data.
>> 
>> 
>> 
>>>
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ... 
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions 
>> and packages for handling and analysis of spatial, and particularly 
>> geographical, data.
>> 
>> 
>>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


From chino_tones at hotmail.com  Thu Nov 23 00:00:52 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Wed, 22 Nov 2017 23:00:52 +0000
Subject: [R-sig-Geo] [DKIM] Re: Fw: Why is there a large predictive
 difference for Univ. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <002515c5e2ad4669b365f02f4f4b694c@win-exch-prod02.prod.lan>
References: <002515c5e2ad4669b365f02f4f4b694c@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB1149A8794EF13BE682FD75E790200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Jin,

Is there any to get the variances of the predictions in spm?



________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 22, 2017 3:28 PM
To: Tomislav Hengl; Joelle k. Akram; r-sig-geo at r-project.org
Subject: RE: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]

Let try spm and see what we can achieve. All these scripts were directly modified from examples in spm.
> library(spm)
> library(sp)
> library(gstat)
> data(meuse)

> set.seed(999)
> rfcv1 <- RFcv(meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL") # I used the same predictors in the same order as in your model for comparison purpose.
> rfcv1$mae
[1] 53.54404 # This much lower than that for KED

> set.seed(999)
> rfcv1 <- rfokcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.22274 # This one further improved the accuracy in comparison with that for RF

> set.seed(999)
> rfcv1 <- rfidwcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.60406 # This one is similar to RFOK

You may try rfcv1$vecv for each method and see how accurate the models are.

I guess the results speak loudly what should be used.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Tomislav Hengl
Sent: Thursday, 23 November 2017 8:42 AM
To: Joelle k. Akram; r-sig-geo at r-project.org
Subject: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Any type of kriging is a convex predictor which means that predictions at sampling locations will exactly match measured numbers. That is why you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad considering that the range of values is: 113-1839. If your repeat the CV process e.g. 10 times you will get a more stable estimate of MAE. Even more interesting is the simple mean error (ME) which tells you whether there are over-estimation or under-estimation problem. Also plotting observed vs predicted (as in
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla)
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
>
>
> I tried splitting the data into 'training' set and a 'holdout' sample
> set as in my original post. I seem to be getting consistent results,
> i.e., a large predictive difference in terms of MAE between both sets.
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my
> opinion, this significant difference is an indication of over-fitting
> on the training sample set for the semi-variogram modeling. The code
> is below.  Any of your insights are welcome.
>
>
> demo(meuse, echo=FALSE)
>   set.seed(999)
>   sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
> "dist")])
>   meuse = meuse[sel.d,]
>   Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7*
> nrow(meuse)))
>   Training_sample = meuse[Training_ids,]
>   Holdout_sample = meuse[-Training_ids,]
>   # Generate VGM using Training set
>   Training_sample.geo <- as.geodata(Training_sample["zinc"])
>   ## add covariates:
>   Training_sample.geo$covariate =
> Training_sample at data[,c("lead","copper","elev", "dist")] trend = ~
> lead+copper+elev+dist
>   zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>
> ini=c(var(log1p(Training_sample.geo$data)),800),
> fix.psiA = FALSE, fix.psiR = FALSE)
>
> # do prediction for locations in Training set
>   locs2 = Training_sample at coords
>   KC = krige.control(trend.d = trend, trend.l = ~
>                        Training_sample$lead+Training_sample$copper+
>                        Training_sample$elev+Training_sample$dist,
> obj.model = zinc.vgm)
>   zinc_train <- krige.conv(Training_sample.geo, locations=locs2,
> krige=KC)
>   # do prediction for new locations in Hold-Out sample set
>   newlocs2 = Holdout_sample at coords
>   KC2 = krige.control(trend.d = trend, trend.l = ~
>                        Holdout_sample$lead+Holdout_sample$copper+
>                       Holdout_sample$elev+Holdout_sample$dist,
> obj.model = zinc.vgm)
>   zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2,
> krige=KC2)
>   # Computing Predictive errors for Training and Hold Out samples
> respectively
>   training_prediction_error_term <- Training_sample$zinc -
> zinc_train$predict
>   holdout_prediction_error_term <- Holdout_sample$zinc -
> zinc_holdout$predict
>
>   # Function that returns Mean Absolute Error
>   mae <- function(error)
>   {
>     mean(abs(error))
>   }
>   # Mean Absolute Error metric :
>   # UK Predictive errors for Training sample set , and UK Predictive
> Errors for HoldOut sample set
>   print(mae(training_prediction_error_term)) #Error for Training
> sample set
>   print(mae(holdout_prediction_error_term)) #Error for Hold out sample
> set
>
>
>
>
> ----------------------------------------------------------------------
> --
> *From:* Tomislav Hengl <tom.hengl at gmail.com>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
> difference for Univ. Kriging?
>
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>>
>> Thank you Tom. A couple questions.
>> 1) In your code, you used log1p for computing  zinc.vgm. But log1p is
>> not used when defining trend.l for the krige.control 'KC'. Do we need
>> log1p for the zinc response (dependent) variable when defining trend.l?
>
> Log-transformation in linkfit is defined by setting "lambda=0". I know
> it is a very cryptic package but it has all you need - transformation,
> back-transformation, REML fitting of variograms, trend components etc etc.
>
>>
>> 2) The exponent back-transform is not applied anywhere after applying
>> log1p for computing the  zinc.vgm variable. Do we need exp anywhere
>> or is it done internally?
>
> It is done internally.
>
>>
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable
>> or does geoR do this internally?
>
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
>
>>
>> 4) Is it more advisable to use likfit instead of variofit and why?
>
> likfit has probably more options for variogram modelling (these could
> get quite computational and I think fitting vgms with >>1000 geoR is
> not recommended, while in gstat it is still doable), but it could be a
> matter of taste.
>
>>
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
>
> Arbitrary initial parameter. It does not have to be very accurate.
>
>>
>> appreciated,
>> Chris
>>
>> ---------------------------------------------------------------------
>> ---
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of
>> Tomislav Hengl <tom.hengl at gmail.com>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
>> difference for Univ. Kriging?
>>
>> Hi Chris,
>>
>> First of all, I think your back-transformation is not correct since
>> you need to add half the prediction variance to values as indicated
>> in the Diggle and Ribeiro (2007) P-61
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ri
>> beiro_2007_P61.png
>
>>
>>
>> ).
>> Otherwise you underpredict the values and hence the cross-validation
>> error will be high.
>>
>> I also do not see much point in using lead and copper as covariates
>> since they are only available at sampling locations.
>>
>> For log-normal or not-normal variables I advise using geoR package
>> that does all the transformations for you (it would be interesting to
>> see if gstat and geoR give exactly the same numbers if the same
>> transformations and back-transformations are applied):
>>
>> R> library(geoR)
>> --------------------------------------------------------------
>>     Analysis of Geostatistical Data
>>     For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
>>The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
>>www.leg.ufpr.br<http://www.leg.ufpr.br> <http://www.leg.ufpr.br>  geoR is a free and
>>open-source package for geostatistical analysis to be  used as a
>>add-on to the R system
>>
>>
>>
>>     geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>>
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
>> R> "dist")]) meuse = meuse[sel.d,] meuse.geo <-
>> R> as.geodata(meuse["zinc"]) ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev",
>> R> "dist")] trend = ~ lead+copper+elev+dist zinc.vgm <-
>> R> likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR =
>>FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>             arguments for the maximisation function.
>>            For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>            times with different initial values for the parameters.
[[elided Hotmail spam]]
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>         beta0      beta1      beta2      beta3      beta4      tausq
>>sigmasq        phi       psiA  "  6.0853" "  0.0033" "  0.0053" "
>>-0.0810" " -0.9805" "  0.0210" "
>> 0.0717" "799.9942" "  0.2619"
>>          psiR
>> "  3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>>
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the
>> user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>>
>> HTH,
>>
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject
>> to ORCID's Terms and Conditions of Use
>>
>>
>>
>>
>>
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>>
>>>
>>>
>>> down
>>> votefavorite<https://stackoverflow.com/questions/47424740/why-is-pre
>>> dictive-error-large-for-universal-kriging#>
>
>>
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
>> -large-for-universal-kriging#>
>>
>> Why is Predictive error large for Universal Kriging?
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
>> -large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat
>> library in R. I am following a strategy used in Machine Learning
>> where data is partioned into a Train set and Hold out set. The...
>>
>>
>>
>>>
>>>
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining  the semivariogram.
>>>
>>> I employ UK to predict on both the Train sample set, as well as the
>>> Hold Out sample set. However, there mean absolute error (MAE) from
>>> the predictions of the response variable (i.e., zinc for the Meuse
>>> dataset) and actual values are very different. I would expect them
>>> to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and
>> advice is welcome.
>>>
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>>
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7*
>>> nrow(dataset)))
>>>
>>> Training_sample = dataset[Training_ids,] Holdout_sample_allvars =
>>> dataset[-Training_ids,]
>>>
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in%
>>> c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>>
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>>
>>> # Semivariogram modeling
>>> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m
>>> <- vgm("Exp") m <- fit.variogram(m1, m)
>>>
>>>
>>> # Apply Univ Krig to Training dataset prediction_training_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Training_sample, model = m) prediction_training_data <-
>>> expm1(prediction_training_data$var1.pred)
>>>
>>> # Apply Univ Krig to Hold Out dataset prediction_holdout_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Hold_out_sample, model = m) prediction_holdout_data <-
>>> expm1(prediction_holdout_data$var1.pred)
>>>
>>> # Computing Predictive errors for Training and Hold Out samples
>>> respectively training_prediction_error_term <- Training_sample$zinc
>>> - prediction_training_data holdout_prediction_error_term <-
>>> Holdout_sample_allvars$zinc - prediction_holdout_data
>>>
>>>
>>>
>>> # Function that returns Mean Absolute Error  mae <- function(error)
>>>{
>>>    mean(abs(error))
>>> }
>>>
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive
>>> Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training
>>> sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample
>>> set
>>>
>>>
>>> cheers,
>>>
>>> Kristopher (Chris)
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From Jin.Li at ga.gov.au  Thu Nov 23 00:30:44 2017
From: Jin.Li at ga.gov.au (Li Jin)
Date: Wed, 22 Nov 2017 23:30:44 +0000
Subject: [R-sig-Geo] [DKIM] Re: Fw: Why is there a large predictive
 difference for Univ. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <32252_1511391758_5A160204_32252_4299_1_YTXPR0101MB1149A8794EF13BE682FD75E790200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
References: <002515c5e2ad4669b365f02f4f4b694c@win-exch-prod02.prod.lan>
 <32252_1511391758_5A160204_32252_4299_1_YTXPR0101MB1149A8794EF13BE682FD75E790200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <ac47ad1bbab84c71a6f1d525656c384e@win-exch-prod02.prod.lan>

That is something I am still working on.

Variances of the predictions by spatial predictive models are not well defined yet, and they are many ways to do this but none of them is satisfactory. Although people may argue that kriging methods can produce such variance, kriging variance in fact does not reflect the uncertainty expected. Please see Goovaerts 1997 'Geostatistics for Natural Resources Evaluation' for details, or simply see my review 'A Review of Spatial Interpolation Methods for Environmental Scientists' for a short explanation.

From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Thursday, 23 November 2017 10:01 AM
To: Li Jin; Tomislav Hengl; r-sig-geo at r-project.org
Subject: [DKIM] Re: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]


Jin,

Is there any to get the variances of the predictions in spm?



________________________________
From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 22, 2017 3:28 PM
To: Tomislav Hengl; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]

Let try spm and see what we can achieve. All these scripts were directly modified from examples in spm.
> library(spm)
> library(sp)
> library(gstat)
> data(meuse)

> set.seed(999)
> rfcv1 <- RFcv(meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL") # I used the same predictors in the same order as in your model for comparison purpose.
> rfcv1$mae
[1] 53.54404 # This much lower than that for KED

> set.seed(999)
> rfcv1 <- rfokcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.22274 # This one further improved the accuracy in comparison with that for RF

> set.seed(999)
> rfcv1 <- rfidwcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.60406 # This one is similar to RFOK

You may try rfcv1$vecv for each method and see how accurate the models are.

I guess the results speak loudly what should be used.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Tomislav Hengl
Sent: Thursday, 23 November 2017 8:42 AM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Any type of kriging is a convex predictor which means that predictions at sampling locations will exactly match measured numbers. That is why you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad considering that the range of values is: 113-1839. If your repeat the CV process e.g. 10 times you will get a more stable estimate of MAE. Even more interesting is the simple mean error (ME) which tells you whether there are over-estimation or under-estimation problem. Also plotting observed vs predicted (as in
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla)
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
>
>
> I tried splitting the data into 'training' set and a 'holdout' sample
> set as in my original post. I seem to be getting consistent results,
> i.e., a large predictive difference in terms of MAE between both sets.
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my
> opinion, this significant difference is an indication of over-fitting
> on the training sample set for the semi-variogram modeling. The code
> is below.  Any of your insights are welcome.
>
>
> demo(meuse, echo=FALSE)
>   set.seed(999)
>   sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
> "dist")])
>   meuse = meuse[sel.d,]
>   Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7*
> nrow(meuse)))
>   Training_sample = meuse[Training_ids,]
>   Holdout_sample = meuse[-Training_ids,]
>   # Generate VGM using Training set
>   Training_sample.geo <- as.geodata(Training_sample["zinc"])
>   ## add covariates:
>   Training_sample.geo$covariate =
> Training_sample at data[,c("lead","copper","elev", "dist")] trend = ~
> lead+copper+elev+dist
>   zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>
> ini=c(var(log1p(Training_sample.geo$data)),800),
> fix.psiA = FALSE, fix.psiR = FALSE)
>
> # do prediction for locations in Training set
>   locs2 = Training_sample at coords
>   KC = krige.control(trend.d = trend, trend.l = ~
>                        Training_sample$lead+Training_sample$copper+
>                        Training_sample$elev+Training_sample$dist,
> obj.model = zinc.vgm)
>   zinc_train <- krige.conv(Training_sample.geo, locations=locs2,
> krige=KC)
>   # do prediction for new locations in Hold-Out sample set
>   newlocs2 = Holdout_sample at coords
>   KC2 = krige.control(trend.d = trend, trend.l = ~
>                        Holdout_sample$lead+Holdout_sample$copper+
>                       Holdout_sample$elev+Holdout_sample$dist,
> obj.model = zinc.vgm)
>   zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2,
> krige=KC2)
>   # Computing Predictive errors for Training and Hold Out samples
> respectively
>   training_prediction_error_term <- Training_sample$zinc -
> zinc_train$predict
>   holdout_prediction_error_term <- Holdout_sample$zinc -
> zinc_holdout$predict
>
>   # Function that returns Mean Absolute Error
>   mae <- function(error)
>   {
>     mean(abs(error))
>   }
>   # Mean Absolute Error metric :
>   # UK Predictive errors for Training sample set , and UK Predictive
> Errors for HoldOut sample set
>   print(mae(training_prediction_error_term)) #Error for Training
> sample set
>   print(mae(holdout_prediction_error_term)) #Error for Hold out sample
> set
>
>
>
>
> ----------------------------------------------------------------------
> --
> *From:* Tomislav Hengl <tom.hengl at gmail.com<mailto:tom.hengl at gmail.com>>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
> difference for Univ. Kriging?
>
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>>
>> Thank you Tom. A couple questions.
>> 1) In your code, you used log1p for computing  zinc.vgm. But log1p is
>> not used when defining trend.l for the krige.control 'KC'. Do we need
>> log1p for the zinc response (dependent) variable when defining trend.l?
>
> Log-transformation in linkfit is defined by setting "lambda=0". I know
> it is a very cryptic package but it has all you need - transformation,
> back-transformation, REML fitting of variograms, trend components etc etc.
>
>>
>> 2) The exponent back-transform is not applied anywhere after applying
>> log1p for computing the  zinc.vgm variable. Do we need exp anywhere
>> or is it done internally?
>
> It is done internally.
>
>>
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable
>> or does geoR do this internally?
>
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
>
>>
>> 4) Is it more advisable to use likfit instead of variofit and why?
>
> likfit has probably more options for variogram modelling (these could
> get quite computational and I think fitting vgms with >>1000 geoR is
> not recommended, while in gstat it is still doable), but it could be a
> matter of taste.
>
>>
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
>
> Arbitrary initial parameter. It does not have to be very accurate.
>
>>
>> appreciated,
>> Chris
>>
>> ---------------------------------------------------------------------
>> ---
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>> on behalf of
>> Tomislav Hengl <tom.hengl at gmail.com<mailto:tom.hengl at gmail.com>>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
>> difference for Univ. Kriging?
>>
>> Hi Chris,
>>
>> First of all, I think your back-transformation is not correct since
>> you need to add half the prediction variance to values as indicated
>> in the Diggle and Ribeiro (2007) P-61
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ri
>> beiro_2007_P61.png
>
>>
>>
>> ).
>> Otherwise you underpredict the values and hence the cross-validation
>> error will be high.
>>
>> I also do not see much point in using lead and copper as covariates
>> since they are only available at sampling locations.
>>
>> For log-normal or not-normal variables I advise using geoR package
>> that does all the transformations for you (it would be interesting to
>> see if gstat and geoR give exactly the same numbers if the same
>> transformations and back-transformations are applied):
>>
>> R> library(geoR)
>> --------------------------------------------------------------
>>     Analysis of Geostatistical Data
>>     For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
>>The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
>>www.leg.ufpr.br<http://www.leg.ufpr.br> <http://www.leg.ufpr.br>  geoR is a free and
>>open-source package for geostatistical analysis to be  used as a
>>add-on to the R system
>>
>>
>>
>>     geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>>
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
>> R> "dist")]) meuse = meuse[sel.d,] meuse.geo <-
>> R> as.geodata(meuse["zinc"]) ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev",
>> R> "dist")] trend = ~ lead+copper+elev+dist zinc.vgm <-
>> R> likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR =
>>FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>             arguments for the maximisation function.
>>            For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>            times with different initial values for the parameters.
>> likfit: WARNING: This step can be time demanding!
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>         beta0      beta1      beta2      beta3      beta4      tausq
>>sigmasq        phi       psiA  "  6.0853" "  0.0033" "  0.0053" "
>>-0.0810" " -0.9805" "  0.0210" "
>> 0.0717" "799.9942" "  0.2619"
>>          psiR
>> "  3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>>
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the
>> user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>>
>> HTH,
>>
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject
>> to ORCID's Terms and Conditions of Use
>>
>>
>>
>>
>>
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>>
>>>
>>>
>>> down
>>> votefavorite<https://stackoverflow.com/questions/47424740/why-is-pre
<https://stackoverflow.com/questions/47424740/why-is-pre%0b>>>> dictive-error-large-for-universal-kriging#>
>
>>
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
<https://stackoverflow.com/questions/47424740/why-is-predictive-error%0b>>> -large-for-universal-kriging#>
>>
>> Why is Predictive error large for Universal Kriging?
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
<https://stackoverflow.com/questions/47424740/why-is-predictive-error%0b>>> -large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat
>> library in R. I am following a strategy used in Machine Learning
>> where data is partioned into a Train set and Hold out set. The...
>>
>>
>>
>>>
>>>
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining  the semivariogram.
>>>
>>> I employ UK to predict on both the Train sample set, as well as the
>>> Hold Out sample set. However, there mean absolute error (MAE) from
>>> the predictions of the response variable (i.e., zinc for the Meuse
>>> dataset) and actual values are very different. I would expect them
>>> to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and
>> advice is welcome.
>>>
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>>
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7*
>>> nrow(dataset)))
>>>
>>> Training_sample = dataset[Training_ids,] Holdout_sample_allvars =
>>> dataset[-Training_ids,]
>>>
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in%
>>> c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>>
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>>
>>> # Semivariogram modeling
>>> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m
>>> <- vgm("Exp") m <- fit.variogram(m1, m)
>>>
>>>
>>> # Apply Univ Krig to Training dataset prediction_training_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Training_sample, model = m) prediction_training_data <-
>>> expm1(prediction_training_data$var1.pred)
>>>
>>> # Apply Univ Krig to Hold Out dataset prediction_holdout_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Hold_out_sample, model = m) prediction_holdout_data <-
>>> expm1(prediction_holdout_data$var1.pred)
>>>
>>> # Computing Predictive errors for Training and Hold Out samples
>>> respectively training_prediction_error_term <- Training_sample$zinc
>>> - prediction_training_data holdout_prediction_error_term <-
>>> Holdout_sample_allvars$zinc - prediction_holdout_data
>>>
>>>
>>>
>>> # Function that returns Mean Absolute Error  mae <- function(error)
>>>{
>>>    mean(abs(error))
>>> }
>>>
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive
>>> Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training
>>> sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample
>>> set
>>>
>>>
>>> cheers,
>>>
>>> Kristopher (Chris)
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS - Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS - Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From chino_tones at hotmail.com  Thu Nov 23 02:04:27 2017
From: chino_tones at hotmail.com (Joelle k. Akram)
Date: Thu, 23 Nov 2017 01:04:27 +0000
Subject: [R-sig-Geo] [DKIM] Re: Fw: Why is there a large predictive
 difference for Univ. Kriging? [SEC=UNCLASSIFIED]
In-Reply-To: <ac47ad1bbab84c71a6f1d525656c384e@win-exch-prod02.prod.lan>
References: <002515c5e2ad4669b365f02f4f4b694c@win-exch-prod02.prod.lan>
 <32252_1511391758_5A160204_32252_4299_1_YTXPR0101MB1149A8794EF13BE682FD75E790200@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>,
 <ac47ad1bbab84c71a6f1d525656c384e@win-exch-prod02.prod.lan>
Message-ID: <YTXPR0101MB1149A205A01299CC4CBA345190210@YTXPR0101MB1149.CANPRD01.PROD.OUTLOOK.COM>

Lin,


Your review paper on SIM is very comprehensive and a good read. You touched on Irregular versus Regular System (section 3.1.7  in the paper). I do not have access to the Burrough and McDonnell book but from your experience; are there any tips you can suggest when handling irregular spatial points for kriging and in particular KED (such as in terms of modeling semivariograms, etc) ?


thanks,

Chris



________________________________
From: Li Jin <Jin.Li at ga.gov.au>
Sent: November 22, 2017 4:30 PM
To: Joelle k. Akram; Tomislav Hengl; r-sig-geo at r-project.org
Subject: RE: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]


That is something I am still working on.



Variances of the predictions by spatial predictive models are not well defined yet, and they are many ways to do this but none of them is satisfactory. Although people may argue that kriging methods can produce such variance, kriging variance in fact does not reflect the uncertainty expected. Please see Goovaerts 1997 ?Geostatistics for Natural Resources Evaluation? for details, or simply see my review ?A Review of Spatial Interpolation Methods for Environmental Scientists? for a short explanation.



From: Joelle k. Akram [mailto:chino_tones at hotmail.com]
Sent: Thursday, 23 November 2017 10:01 AM
To: Li Jin; Tomislav Hengl; r-sig-geo at r-project.org
Subject: [DKIM] Re: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]



Jin,

Is there any to get the variances of the predictions in spm?





________________________________

From: Li Jin <Jin.Li at ga.gov.au<mailto:Jin.Li at ga.gov.au>>
Sent: November 22, 2017 3:28 PM
To: Tomislav Hengl; Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: RE: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging? [SEC=UNCLASSIFIED]



Let try spm and see what we can achieve. All these scripts were directly modified from examples in spm.
> library(spm)
> library(sp)
> library(gstat)
> data(meuse)

> set.seed(999)
> rfcv1 <- RFcv(meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL") # I used the same predictors in the same order as in your model for comparison purpose.
> rfcv1$mae
[1] 53.54404 # This much lower than that for KED

> set.seed(999)
> rfcv1 <- rfokcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.22274 # This one further improved the accuracy in comparison with that for RF

> set.seed(999)
> rfcv1 <- rfidwcv(meuse[, c(1,2)], meuse[, c(5,4,7,8)], meuse[, 6], predacc = "ALL")
> rfcv1$mae
[1] 42.60406 # This one is similar to RFOK

You may try rfcv1$vecv for each method and see how accurate the models are.

I guess the results speak loudly what should be used.

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Tomislav Hengl
Sent: Thursday, 23 November 2017 8:42 AM
To: Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: [DKIM] Re: [R-sig-Geo] Fw: Why is there a large predictive difference for Univ. Kriging?


Any type of kriging is a convex predictor which means that predictions at sampling locations will exactly match measured numbers. That is why you get MAE_train = 0.

The actual MAE of your predictions is 85.9. This is not that bad considering that the range of values is: 113-1839. If your repeat the CV process e.g. 10 times you will get a more stable estimate of MAE. Even more interesting is the simple mean error (ME) which tells you whether there are over-estimation or under-estimation problem. Also plotting observed vs predicted (as in
http://gsif.isric.org/lib/exe/detail.php/wiki:xyplot_predicted_vs_observerd_edgeroi.png?id=wiki%3Asoilmapping_using_mla)
gives you graphical idea if there are any problems with your model.

HTH

Tom Hengl



On 2017-11-22 21:34, Joelle k. Akram wrote:
> Hi Tom,
>
>
> I tried splitting the data into 'training' set and a 'holdout' sample
> set as in my original post. I seem to be getting consistent results,
> i.e., a large predictive difference in terms of MAE between both sets.
> The MAE_train =0.0000000000001165816 and MAE_holdOut = 85.91126. In my
> opinion, this significant difference is an indication of over-fitting
> on the training sample set for the semi-variogram modeling. The code
> is below.  Any of your insights are welcome.
>
>
> demo(meuse, echo=FALSE)
>   set.seed(999)
>   sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
> "dist")])
>   meuse = meuse[sel.d,]
>   Training_ids <- sample(seq_len(nrow(meuse)), size = (0.7*
> nrow(meuse)))
>   Training_sample = meuse[Training_ids,]
>   Holdout_sample = meuse[-Training_ids,]
>   # Generate VGM using Training set
>   Training_sample.geo <- as.geodata(Training_sample["zinc"])
>   ## add covariates:
>   Training_sample.geo$covariate =
> Training_sample at data[,c("lead","copper","elev", "dist")] trend = ~
> lead+copper+elev+dist
>   zinc.vgm <- likfit(Training_sample.geo, lambda=0, trend = trend,
>
> ini=c(var(log1p(Training_sample.geo$data)),800),
> fix.psiA = FALSE, fix.psiR = FALSE)
>
> # do prediction for locations in Training set
>   locs2 = Training_sample at coords
>   KC = krige.control(trend.d = trend, trend.l = ~
>                        Training_sample$lead+Training_sample$copper+
>                        Training_sample$elev+Training_sample$dist,
> obj.model = zinc.vgm)
>   zinc_train <- krige.conv(Training_sample.geo, locations=locs2,
> krige=KC)
>   # do prediction for new locations in Hold-Out sample set
>   newlocs2 = Holdout_sample at coords
>   KC2 = krige.control(trend.d = trend, trend.l = ~
>                        Holdout_sample$lead+Holdout_sample$copper+
>                       Holdout_sample$elev+Holdout_sample$dist,
> obj.model = zinc.vgm)
>   zinc_holdout <- krige.conv(Training_sample.geo, locations=newlocs2,
> krige=KC2)
>   # Computing Predictive errors for Training and Hold Out samples
> respectively
>   training_prediction_error_term <- Training_sample$zinc -
> zinc_train$predict
>   holdout_prediction_error_term <- Holdout_sample$zinc -
> zinc_holdout$predict
>
>   # Function that returns Mean Absolute Error
>   mae <- function(error)
>   {
>     mean(abs(error))
>   }
>   # Mean Absolute Error metric :
>   # UK Predictive errors for Training sample set , and UK Predictive
> Errors for HoldOut sample set
>   print(mae(training_prediction_error_term)) #Error for Training
> sample set
>   print(mae(holdout_prediction_error_term)) #Error for Hold out sample
> set
>
>
>
>
> ----------------------------------------------------------------------
> --
> *From:* Tomislav Hengl <tom.hengl at gmail.com<mailto:tom.hengl at gmail.com>>
> *Sent:* November 22, 2017 8:17 AM
> *To:* Joelle k. Akram; r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
> difference for Univ. Kriging?
>
> On 2017-11-22 13:11, Joelle k. Akram wrote:
>>
>> Thank you Tom. A couple questions.
>> 1) In your code, you used log1p for computing  zinc.vgm. But log1p is
>> not used when defining trend.l for the krige.control 'KC'. Do we need
>> log1p for the zinc response (dependent) variable when defining trend.l?
>
> Log-transformation in linkfit is defined by setting "lambda=0". I know
> it is a very cryptic package but it has all you need - transformation,
> back-transformation, REML fitting of variograms, trend components etc etc.
>
>>
>> 2) The exponent back-transform is not applied anywhere after applying
>> log1p for computing the  zinc.vgm variable. Do we need exp anywhere
>> or is it done internally?
>
> It is done internally.
>
>>
>> 3) Do we add half the prediction variance to the 'zinc.uk' variable
>> or does geoR do this internally?
>
> It is done internally see:
> "krige.conv: performing the Box-Cox data transformation
> krige.conv: back-transforming the predicted mean and variance"
>
>>
>> 4) Is it more advisable to use likfit instead of variofit and why?
>
> likfit has probably more options for variogram modelling (these could
> get quite computational and I think fitting vgms with >>1000 geoR is
> not recommended, while in gstat it is still doable), but it could be a
> matter of taste.
>
>>
>> 5) A value of 800 is used to initialize likfit. Where is value determined?
>
> Arbitrary initial parameter. It does not have to be very accurate.
>
>>
>> appreciated,
>> Chris
>>
>> ---------------------------------------------------------------------
>> ---
>> *From:* R-sig-Geo <r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>> on behalf of
>> Tomislav Hengl <tom.hengl at gmail.com<mailto:tom.hengl at gmail.com>>
>> *Sent:* November 22, 2017 3:58 AM
>> *To:* r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
>> *Subject:* Re: [R-sig-Geo] Fw: Why is there a large predictive
>> difference for Univ. Kriging?
>>
>> Hi Chris,
>>
>> First of all, I think your back-transformation is not correct since
>> you need to add half the prediction variance to values as indicated
>> in the Diggle and Ribeiro (2007) P-61
>> (https://github.com/thengl/GeoMLA/blob/master/RF_vs_kriging/Diggle_Ri
>> beiro_2007_P61.png
>
>>
>>
>> ).
>> Otherwise you underpredict the values and hence the cross-validation
>> error will be high.
>>
>> I also do not see much point in using lead and copper as covariates
>> since they are only available at sampling locations.
>>
>> For log-normal or not-normal variables I advise using geoR package
>> that does all the transformations for you (it would be interesting to
>> see if gstat and geoR give exactly the same numbers if the same
>> transformations and back-transformations are applied):
>>
>> R> library(geoR)
>> --------------------------------------------------------------
>>     Analysis of Geostatistical Data
>>     For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
>>The geoR package - LEG-UFPR <http://www.leg.ufpr.br/geoR>
>>www.leg.ufpr.br<http://www.leg.ufpr.br> <http://www.leg.ufpr.br>  geoR is a free and
>>open-source package for geostatistical analysis to be  used as a
>>add-on to the R system
>>
>>
>>
>>     geoR version 1.7-5.2 (built on 2016-05-02) is now loaded
>> --------------------------------------------------------------
>>
>> R> demo(meuse, echo=FALSE)
>> R> set.seed(999)
>> R> sel.d = complete.cases(meuse at data[,c("lead","copper","elev",
>> R> "dist")]) meuse = meuse[sel.d,] meuse.geo <-
>> R> as.geodata(meuse["zinc"]) ## add covariates:
>> R> meuse.geo$covariate = meuse at data[,c("lead","copper","elev",
>> R> "dist")] trend = ~ lead+copper+elev+dist zinc.vgm <-
>> R> likfit(meuse.geo, lambda=0, trend = trend,
>> ini=c(var(log1p(meuse.geo$data)),800), fix.psiA = FALSE, fix.psiR =
>>FALSE)
>> ---------------------------------------------------------------
>> likfit: likelihood maximisation using the function optim.
>> likfit: Use control() to pass additional
>>             arguments for the maximisation function.
>>            For further details see documentation for optim.
>> likfit: It is highly advisable to run this function several
>>            times with different initial values for the parameters.
[[elided Hotmail spam]]
>> ---------------------------------------------------------------
>> likfit: end of numerical maximisation.
>> R> zinc.vgm
>> likfit: estimated model parameters:
>>         beta0      beta1      beta2      beta3      beta4      tausq
>>sigmasq        phi       psiA  "  6.0853" "  0.0033" "  0.0053" "
>>-0.0810" " -0.9805" "  0.0210" "
>> 0.0717" "799.9942" "  0.2619"
>>          psiR
>> "  3.9731"
>> Practical Range with cor=0.05 for asymptotic range: 2396.568
>>
>> likfit: maximised log-likelihood = -883.4
>> R> locs2 = meuse at coords
>> R> KC = krige.control(trend.d = trend, trend.l = ~
>> meuse$lead+meuse$copper+meuse$elev+meuse$dist, obj.model = zinc.vgm)
>> R> zinc.uk <- krige.conv(meuse.geo, locations=locs2, krige=KC)
>> krige.conv: model with mean defined by covariates provided by the
>> user
>> krige.conv: anisotropy correction performed
>> krige.conv: performing the Box-Cox data transformation
>> krige.conv: back-transforming the predicted mean and variance
>> krige.conv: Kriging performed using global neighbourhood
>>
>> HTH,
>>
>> Tom Hengl
>> http://orcid.org/0000-0002-9921-5129
>> Tomislav Hengl (0000-0002-9921-5129) - ORCID | Connecting ...
>> <http://orcid.org/0000-0002-9921-5129>
>> orcid.org
>> Your use of the Registry and the results of your search are subject
>> to ORCID's Terms and Conditions of Use
>>
>>
>>
>>
>>
>> On 2017-11-22 01:08, Joelle k. Akram wrote:
>>>
>>>
>>>
>>> down
>>> votefavorite<https://stackoverflow.com/questions/47424740/why-is-pre
<https://stackoverflow.com/questions/47424740/why-is-pre%0b>>>> dictive-error-large-for-universal-kriging#>
>
>>
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
<https://stackoverflow.com/questions/47424740/why-is-predictive-error%0b>>> -large-for-universal-kriging#>
>>
>> Why is Predictive error large for Universal Kriging?
>> <https://stackoverflow.com/questions/47424740/why-is-predictive-error
<https://stackoverflow.com/questions/47424740/why-is-predictive-error%0b>>> -large-for-universal-kriging#>
>> stackoverflow.com
>> I am using the Meuse dataset for universal kriging (UK) via the gstat
>> library in R. I am following a strategy used in Machine Learning
>> where data is partioned into a Train set and Hold out set. The...
>>
>>
>>
>>>
>>>
>>> I am using the Meuse dataset for universal kriging (UK) via the gstat library in R. I am following a strategy used in Machine Learning where data is partioned into a Train set and Hold out set. The Train set is used for defining the regressive model and  defining  the semivariogram.
>>>
>>> I employ UK to predict on both the Train sample set, as well as the
>>> Hold Out sample set. However, there mean absolute error (MAE) from
>>> the predictions of the response variable (i.e., zinc for the Meuse
>>> dataset) and actual values are very different. I would expect them
>>> to be similar or at least closer. So far I have
>> MAE_training_set = 1 and MAE_holdOut_set = 76.5. My code is below and
>> advice is welcome.
>>>
>>> library(sp)
>>> library(gstat)
>>> data(meuse)
>>> dataset= meuse
>>> set.seed(999)
>>>
>>> # Split Meuse Dataset into Training and HoldOut Sample datasets
>>> Training_ids <- sample(seq_len(nrow(dataset)), size = (0.7*
>>> nrow(dataset)))
>>>
>>> Training_sample = dataset[Training_ids,] Holdout_sample_allvars =
>>> dataset[-Training_ids,]
>>>
>>> holdoutvars_df <-(dataset[,which(names(dataset) %in%
>>> c("x","y","lead","copper","elev","dist"))])
>>> Hold_out_sample = holdoutvars_df[-Training_ids,]
>>>
>>> coordinates(Training_sample) <- c('x','y')
>>> coordinates(Hold_out_sample) <- c('x','y')
>>>
>>> # Semivariogram modeling
>>> m1  <- variogram(log(zinc)~lead+copper+elev+dist, Training_sample) m
>>> <- vgm("Exp") m <- fit.variogram(m1, m)
>>>
>>>
>>> # Apply Univ Krig to Training dataset prediction_training_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Training_sample, model = m) prediction_training_data <-
>>> expm1(prediction_training_data$var1.pred)
>>>
>>> # Apply Univ Krig to Hold Out dataset prediction_holdout_data <-
>>> krige(log(zinc)~lead+copper+elev+dist, Training_sample,
>>> Hold_out_sample, model = m) prediction_holdout_data <-
>>> expm1(prediction_holdout_data$var1.pred)
>>>
>>> # Computing Predictive errors for Training and Hold Out samples
>>> respectively training_prediction_error_term <- Training_sample$zinc
>>> - prediction_training_data holdout_prediction_error_term <-
>>> Holdout_sample_allvars$zinc - prediction_holdout_data
>>>
>>>
>>>
>>> # Function that returns Mean Absolute Error  mae <- function(error)
>>>{
>>>    mean(abs(error))
>>> }
>>>
>>> # Mean Absolute Error metric :
>>> # UK Predictive errors for Training sample set , and UK Predictive
>>> Errors for HoldOut sample set
>>> print(mae(training_prediction_error_term)) #Error for Training
>>> sample set
>>> print(mae(holdout_prediction_error_term)) #Error for Hold out sample
>>> set
>>>
>>>
>>> cheers,
>>>
>>> Kristopher (Chris)
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> R-sig-Geo Info Page - SfS ? Seminar for Statistics | ETH ...
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>> stat.ethz.ch
>> A mailing list for discussing the development and use of R functions
>> and packages for handling and analysis of spatial, and particularly
>> geographical, data.
>>
>>
>>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

Geoscience Australia Disclaimer: This e-mail (and files transmitted with it) is intended only for the person or entity to which it is addressed. If you are not the intended recipient, then you have received this e-mail by mistake and any use, dissemination, forwarding, printing or copying of this e-mail and its file attachments is prohibited. The security of emails transmitted cannot be guaranteed; by forwarding or replying to this email, you acknowledge and accept these risks.
-------------------------------------------------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From cicoz at anadolu.edu.tr  Thu Nov 23 21:10:53 2017
From: cicoz at anadolu.edu.tr (=?iso-8859-9?B?Q2VuayDdx9Za?=)
Date: Thu, 23 Nov 2017 20:10:53 +0000
Subject: [R-sig-Geo] ETAS package help
Message-ID: <C2AF35551EE58A4487CC3151707449ADCC2D6C99@mb05.porsuk.anadolu.edu.tr>

Dear all,

I am trying to fit an earthquake catalog but I am newbie to spatio-temporal epidemic type aftershock model.
I found ETAS package on R however I could not fit my catalog. There are examples of initial parameter set in package documentation for given data-sets. However I do not have any idea how to determine this initial parameter set and it is not explained.
How to determine this parameter set? Algorithm of minimizing the negative log likelihood diverges or gave erroneous results while given no parameter set or irrevelant parameter set.
Are there any other packages to fit st ETAS model with using likelihood function as an alternative?


Thanks in advance.
Cenk


________________________________

Bu elektronik posta ve onunla iletilen b?t?n dosyalar sadece yukar?da isimleri belirtilen ki?iler aras?nda ?zel haberle?me amac?n? ta??makta olup g?nderici taraf?ndan al?nmas? ama?lanan yetkili ger?ek ya da t?zel ki?inin kullan?m?na aittir. E?er bu elektronik posta size yanl??l?kla ula?m??sa, elektronik postan?n i?eri?ini a??klaman?z, kopyalaman?z, y?nlendirmeniz ve kullanman?z kesinlikle yasakt?r. Bu durumda, l?tfen mesaj? geri g?nderiniz ve sisteminizden siliniz. Anadolu ?niversitesi bu mesaj?n i?erdi?i bilgilerin do?rulu?u veya eksiksiz oldu?u konusunda herhangi bir garanti vermemektedir. Bu nedenle bu bilgilerin ne ?ekilde olursa olsun i?eri?inden, iletilmesinden, al?nmas?ndan ve saklanmas?ndan sorumlu de?ildir. Bu mesajdaki g?r??ler yaln?zca g?nderen ki?iye aittir ve Anadolu ?niversitesinin g?r??lerini yans?tmayabilir.

This electronic mail and any files transmitted with it are intended for the private use of the people named above. If you are not the intended recipient and received this message in error, forwarding, copying or use of any of the information is strictly prohibited. Any dissemination or use of this information by a person other than the intended recipient is unauthorized and may be illegal. In this case, please immediately notify the sender and delete it from your system. Anadolu University does not guarantee the accuracy or completeness of any information included in this message. Therefore, by any means Anadolu University is not responsible for the content of the message, and the transmission, reception, storage, and use of the information. The opinions expressed in this message only belong to the sender of it and may not reflect the opinions of Anadolu University.

	[[alternative HTML version deleted]]


From dncgst at gnewarchaeology.it  Tue Nov 28 12:06:08 2017
From: dncgst at gnewarchaeology.it (Domenico Giusti)
Date: Tue, 28 Nov 2017 12:06:08 +0100
Subject: [R-sig-Geo] Anisotropic point processes are inhomogeneous?
In-Reply-To: <323312bf-fd52-fad7-a471-25e391116c85@math.aau.dk>
References: <1a573a39-2a71-2019-4ef0-e55e64d97714@gnewarchaeology.it>
 <323312bf-fd52-fad7-a471-25e391116c85@math.aau.dk>
Message-ID: <b747b326-4636-685c-a4d3-439f162f30d5@gnewarchaeology.it>

Thank you Ege for your reply,

> In general it seems like a difficult problem to separate inhomogeneity and anisotropy from each other

this point is indeed not very clear to me.

If the homogeneous Poisson point process is defined by the properties of 
i) homogeneity, ii) independence and iii) Poisson distribution; the 
inhomogeneous Poisson process is a modification of the former with i) 
intensity function, ii) independence and iii) Poisson distribution.

An anisotropic point process, defined as directional dependent process, 
could be seen as inhomogeneous process having an oriented intensity 
function, or violates the assumption of independence in both homogeneous 
and inhomogeneous processes?

Similarly, is anisotropy violating the assumptions of independent 
labels/components in inhomogeneous multitype point processes?

Thanks,

On 11/21/2017 10:41 PM, Ege Rubak wrote:
> stationarity of your process I would think that the results from 
> something like Ksector can be misleading.


From mashranga at yahoo.com  Tue Nov 28 16:37:27 2017
From: mashranga at yahoo.com (Mohammad Tanvir Ahamed)
Date: Tue, 28 Nov 2017 15:37:27 +0000 (UTC)
Subject: [R-sig-Geo] Extract all point in a quadrats by spatstat package
In-Reply-To: <2091818519.3635313.1511883279421@mail.yahoo.com>
References: <1670911523.3535972.1511872364204.ref@mail.yahoo.com>
 <1670911523.3535972.1511872364204@mail.yahoo.com>
 <2091818519.3635313.1511883279421@mail.yahoo.com>
Message-ID: <10102769.3642886.1511883447399@mail.yahoo.com>

Hi,

With the following code i can divides window into quadrats and counts the numbers of points in each quadrat.

library(spatstat)
X <- runifpoint(50)
quadratcount(X)
quadratcount(X, 4, 5)
quadratcount(X, xbreaks=c(0, 0.3, 1), ybreaks=c(0, 0.4, 0.8, 1))
qX <-? quadratcount(X, 4, 5)
plot(X)
plot(qX, add=TRUE)

But I want to mark each? quadrats? and select/ extract only those points by selecting quadrats id .?
Can anyone plese help me regarding this issue ?
Thanks in advance .



Regards.............
Tanvir Ahamed 
Stockholm, Sweden???? |??mashranga at yahoo.com   
	[[alternative HTML version deleted]]


From marcelino.delacruz at urjc.es  Tue Nov 28 17:49:18 2017
From: marcelino.delacruz at urjc.es (Marcelino de la Cruz Rot)
Date: Tue, 28 Nov 2017 17:49:18 +0100
Subject: [R-sig-Geo] Extract all point in a quadrats by spatstat package
In-Reply-To: <10102769.3642886.1511883447399@mail.yahoo.com>
References: <1670911523.3535972.1511872364204.ref@mail.yahoo.com>
 <1670911523.3535972.1511872364204@mail.yahoo.com>
 <2091818519.3635313.1511883279421@mail.yahoo.com>
 <10102769.3642886.1511883447399@mail.yahoo.com>
Message-ID: <bd01bf85-694e-bda1-9d57-d3f1589d39d2@urjc.es>

Maybe

cut(X, as.tess(qX))

or

split.ppp(X, as.tess(qX))

?
Cheers,

Marcelino



El 28/11/2017 a las 16:37, Mohammad Tanvir Ahamed via R-sig-Geo escribi?:
> Hi,
>
> With the following code i can divides window into quadrats and counts the numbers of points in each quadrat.
>
> library(spatstat)
> X <- runifpoint(50)
> quadratcount(X)
> quadratcount(X, 4, 5)
> quadratcount(X, xbreaks=c(0, 0.3, 1), ybreaks=c(0, 0.4, 0.8, 1))
> qX <-? quadratcount(X, 4, 5)
> plot(X)
> plot(qX, add=TRUE)
>
> But I want to mark each? quadrats? and select/ extract only those points by selecting quadrats id .
> Can anyone plese help me regarding this issue ?
> Thanks in advance .
>
>
>
> Regards.............
> Tanvir Ahamed
> Stockholm, Sweden???? |??mashranga at yahoo.com
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a y Geolog?a
F?sica y Qu?mica Inorg?nica
Universidad Rey Juan Carlos
M?stoles Espa?a


From aolinto.lst at gmail.com  Thu Nov 30 20:14:32 2017
From: aolinto.lst at gmail.com (Antonio Silva)
Date: Thu, 30 Nov 2017 17:14:32 -0200
Subject: [R-sig-Geo] make a raster from Aquarius files
Message-ID: <CAE8g1gPGRAy6HNeMR2gXiUF_d90E0sQ8wq-qEzEdmH=kjVEAyg@mail.gmail.com>

Hello

Some time ago I prepared scripts to extract temperature data from Modis
Aqua files. It can be found at https://gist.github.com/aolinto

HDF files can be downloaded at https://oceancolor.gsfc.nasa.gov/cgi/l3

I got the Aquarius sea surface salinity smoothed file from June 2015.

I could open and read the file:

library(ncdf4)
library(raster)

nc.data<-nc_open("Q20151522015181.L3m_MO_SCISM_V5.0_SSS_1deg")
print(nc.data)
dim(ncvar_get(nc.data,"l3m_data"))
ncvar_get(nc.data,"l3m_data")[c(110:160),c(110:117)]

But I could not prepare a raster from it. I tryed many things as:

rst.data <-
raster("Q20151522015181.L3m_MO_SCISM_V5.0_SSS_1deg",varname="l3m_data")
Error in .local(.Object, ...) :
  `AQUARIUS/Q20151522015181.L3m_MO_SCISM_V5.0_SSS_1deg' not recognised as a
supported file format.

Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",
:
  Cannot create a RasterLayer object from this file.

and variations with band and layer.

I would greatly appreciate any suggestions to solve this issue.

Thanks

-- 
Ant?nio Olinto ?vila da Silva
Fisheries Institute
S?o Paulo, Brasil

	[[alternative HTML version deleted]]


